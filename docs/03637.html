<html>
<head>
<title>Long Time Tracking by detecting Pedestrians</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过检测行人进行长时间跟踪</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/long-time-tracking-by-detecting-pedestrians-e8a0123941c8?source=collection_archive---------22-----------------------#2020-02-11">https://medium.com/analytics-vidhya/long-time-tracking-by-detecting-pedestrians-e8a0123941c8?source=collection_archive---------22-----------------------#2020-02-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="19ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用哈尔级联的全身检测是一种基于机器学习的方法，其中用一组输入数据训练级联函数。OpenCV已经包含了许多预先训练好的人脸、眼睛、微笑等分类器..今天我们将使用全身分类器。</p><p id="ace7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">OpenCV附带了一个预训练的HOG描述符+线性SVM模型，可用于在图像和视频流中执行行人检测。OpenCV实现了一种非常快速的人体检测方法，称为HOG(梯度方向直方图)。这种方法被训练来检测行人，行人是大部分站着的人，并且完全可见。</p><h1 id="aa1c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">阶段-</h1><ol class=""><li id="6a7a" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated"><strong class="ih hj">从HOG描述符检测</strong></li><li id="6ce4" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated"><strong class="ih hj">长时间跟踪</strong></li></ol><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/5bdd7e47e5a2354b543345ec30c197ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2nuJUMAEnt7sMol6KveC4g.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">行人检测</figcaption></figure><h1 id="12ff" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">1)什么是特征描述符？</h1><p id="19ce" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">特征描述符是图像或图像补片的表示，它通过提取有用信息和丢弃无关信息来简化图像。通常，特征描述符将大小为宽x高x 3(通道)的图像转换为长度为n的特征向量/数组。在HOG特征描述符的情况下，输入图像的大小为64 x 128 x 3，输出特征向量的长度为3780。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lk"><img src="../Images/7a3f00ff46872ac76a995fab92ca59dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vmn_HMgEuZBxi8NrCX4qFw.jpeg"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated"><strong class="bd jf">预处理</strong></figcaption></figure><p id="d07c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">猪人检测器</strong></p><p id="f049" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前最流行和最成功的“人探测器”之一是SVM方法。HOG代表方向梯度直方图。HOG是一种“特征描述符”。特征描述符的目的是以这样一种方式概括对象，当在不同条件下观察时，相同的对象(在这种情况下是人)产生尽可能接近相同的特征描述符。这使得分类任务更加容易。</p><p id="a2cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种方法的创造者训练了一种支持向量机(一种用于分类的机器学习算法)，或“SVM”，以识别人的HOG描述符。</p><p id="64c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中一个主要原因是，它使用“全局”特征来描述一个人，而不是“局部”特征的集合。这意味着整个人由单个特征向量来表示，而不是由许多特征向量来表示人的较小部分。</p><p id="8b4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">猪人检测器使用滑动检测窗口，该窗口在图像周围移动。在检测器窗口的每个位置，为检测窗口计算HOG描述符。这个描述符然后被馈送给经过训练的SVM，后者将其分类为“人”或“不是人”。</p><p id="6c39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了识别不同尺度的人，图像被二次抽样成多种尺寸。搜索这些二次抽样图像中的每一个。</p><h1 id="bd57" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">2)长时间跟踪</h1><p id="5ad4" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">一旦检测到人，模型就能够在整个身体周围制作边界框，并开始跟踪时间。如果此人退出画面，用于跟踪实时时间的时钟将停止，该时间将保存在数据库中。</p><p id="67c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，在检测到行人中的每个人之后，与每个人相关联的时间与他们的id一起被保存。</p><p id="2f69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当时钟达到已经设定的阈值后，管理员的屏幕上会出现一个“警报”信号。</p><p id="bd2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ll">在Python中实现- </em> </strong></p><h2 id="f3cb" class="lm je hi bd jf ln lo lp jj lq lr ls jn iq lt lu jr iu lv lw jv iy lx ly jz lz bi translated"><span class="l ma mb mc bm md me mf mg mh di"> S </span> tep-1:导入必要的库(NumPy和OpenCV)。</h2><pre class="ks kt ku kv fd mi mj mk ml aw mm bi"><span id="4a32" class="lm je hi mj b fi mn mo l mp mq">import numpy as np<br/>import cv2<br/>import imutils<br/>import datetime</span></pre><h2 id="a6e7" class="lm je hi bd jf ln lo lp jj lq lr ls jn iq lt lu jr iu lv lw jv iy lx ly jz lz bi translated">第二步:相机打开。</h2><pre class="ks kt ku kv fd mi mj mk ml aw mm bi"><span id="e190" class="lm je hi mj b fi mn mo l mp mq">body_classifier = cv2.CascadeClassifier(‘haarcascade_fullbody.xml’)<br/>cap = cv2.VideoCapture(0)</span><span id="859d" class="lm je hi mj b fi mr mo l mp mq">ds_factor=0.6</span><span id="1a53" class="lm je hi mj b fi mr mo l mp mq"># Loop once video is successfully loaded<br/>while cap.isOpened():</span><span id="5e8a" class="lm je hi mj b fi mr mo l mp mq"># Reading the each frame of the video <br/> ret, frame = cap.read()</span><span id="ffe1" class="lm je hi mj b fi mr mo l mp mq"># here we are resizing the frame, to half of its size, we are doing to speed up the classification<br/> # as larger images have lot more windows to slide over, so in overall we reducing the resolution<br/>#of video by half that’s what 0.5 indicate, and we are also using quicker interpolation method that is #interlinear</span></pre><h2 id="7f46" class="lm je hi bd jf ln lo lp jj lq lr ls jn iq lt lu jr iu lv lw jv iy lx ly jz lz bi translated">步骤3:一旦在视频流中检测到身体，时钟定时器启动，并在检测到的身体退出帧时停止。如果时间计数器达到已经设定的阈值,“报警”信号表示。</h2><pre class="ks kt ku kv fd mi mj mk ml aw mm bi"><span id="50a5" class="lm je hi mj b fi mn mo l mp mq"><br/> frame=cv2.resize(frame,None,fx=ds_factor,fy=ds_factor,interpolation=cv2.INTER_AREA)<br/> gray=cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)<br/> # Pass frame to our body classifier<br/> bodies = body_classifier.detectMultiScale(gray, 1.2, 3)<br/> <br/> b=np.array(bodies)<br/> print(b)</span><span id="3e4f" class="lm je hi mj b fi mr mo l mp mq"># Extract bounding boxes for any bodies identified<br/> for (x,y,w,h) in bodies:<br/> cv2.rectangle(frame, (x, y), (x+w, y+h), (0, 255, 255), 2)<br/> cv2.imshow(‘Pedestrians’, frame)<br/> <br/> if len(bodies)&gt;0:<br/> body_exist=True<br/> <br/> key = cv2.waitKey(1) &amp; 0xFF<br/> <br/>if body_exist:<br/> cv2.putText(frame, datetime.datetime.now().strftime(“%A %d %B %Y %I:%M:%S%p”),<br/> (10, frame.shape[0] — 10), cv2.FONT_HERSHEY_SIMPLEX, 0.35, (0, 0, 255), 1)<br/> <br/>else:<br/> print(NO_BODY_DETECTION)<br/> <br/>cap.release()<br/>cv2.destroyAllWindows()</span></pre><p id="95ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">现实生活中的应用:</strong></p><p id="b277" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">长时间跟踪可用于安全和监视领域(ATM室、超市等内部)。</p><p id="e26c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下节课再见！</p><p id="6551" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢你，</p><p id="5abd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿努什卡</p></div></div>    
</body>
</html>