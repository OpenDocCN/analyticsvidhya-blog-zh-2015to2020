<html>
<head>
<title>Improving geographic data using the Brazilian National Census</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用巴西全国人口普查改进地理数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/improving-geographic-data-using-the-brazilian-national-census-495c8107a3e0?source=collection_archive---------21-----------------------#2020-03-24">https://medium.com/analytics-vidhya/improving-geographic-data-using-the-brazilian-national-census-495c8107a3e0?source=collection_archive---------21-----------------------#2020-03-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/188dfd618667bcf569099f27bf1dd677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0G_IWnUNM3JZOzbE"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@adolfofelix?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿道夫·费利克斯</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="2b6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">地理定位是不同领域中的一个重要主题。递送服务、保险公司和特许经销商都对深入了解一个地区非常感兴趣。</p><p id="5402" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于Creditas提供房屋净值贷款，位置是一个重要因素，直接影响抵押品的价值，从而影响可以借出的金额。</p><p id="35d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在数据科学的背景下，知道邮政编码、社区、城市和州是不够的。最重要的是找到其他更通用的信息，传达指定位置的特征。</p><p id="359c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设使用一个功能来训练机器学习模型，该功能仅从仅包含圣保罗州内的示例的数据集中接收邻域名称。如果该模型接收来自里约热内卢的客户端作为输入进行预测，它将不知道如何处理邻域值“Ipanema ”,并可能导致错误或错误的预测。</p><p id="acc3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另一方面，如果模型接收来自同一社区的18至60岁之间的居民人数，这将概括地理位置因素，因为许多其他地方可能会有该人数。</p><p id="fa06" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，例如，总是尽量使用诸如<code class="du jt ju jv jw b">average_income_per_capita</code>或<code class="du jt ju jv jw b">thefts_per_100_inhabitants</code>之类的特征，而不是街区或城市的名称。</p><p id="02bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“但是从哪里获得这些数据呢？”你扪心自问。有一些开放的数据源，如圣保罗市的Geosampa，但在全国范围内，最好使用的是巴西地理统计局的全国人口普查。根据你关注的地理位置，你获取这些信息的地方可能会有所不同；然而，这就是我为巴西所做的。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="21ee" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">关于巴西地理统计局的全国人口普查</h1><p id="9ba5" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">每10年，巴西地理统计局的全国人口普查是对巴西人口进行的主要统计研究，最近一次是在2010年。在里面，你可以找到识字率、年龄、城市基础设施等信息。</p><p id="56bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">收集的数据是基于最小的领土单位，称为<strong class="ix hj">人口普查部门</strong>。在巴西2010年的人口普查中，大约有314，000个普查部门。每个人口普查部门都有一个格式为<code class="du jt ju jv jw b">&lt;UF&gt;&lt;MMMMM&gt;&lt;DD&gt;&lt;SD&gt;&lt;SSSS</code>的唯一id，其中:</p><pre class="lh li lj lk fd ll jw lm ln aw lo bi"><span id="96a9" class="lp kf hi jw b fi lq lr l ls lt">UF – Unidade da Federação (Federation Unit)<br/>MMMMM – Município (Municipality)<br/>DD – Distrito (District)<br/>SD – Subdistrito (Subdistrict)<br/>SSSS – Setor (Sector)</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/4478b005340dd723d77a3852916136eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/0*bYfixcNM2HtyMMNg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">圣保罗市Itaim Bibi(浅蓝色)的普查部门组织示例。深蓝色的线作为每个扇区之间的边界。来自https://censo2010.ibge.gov.br/sinopseporsetores/(葡萄牙语)</figcaption></figure><p id="5ee0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2010年巴西地理统计局编制的数据库可通过以下路径在<a class="ae iu" href="https://www.ibge.gov.br/estatisticas-novoportal/downloads-estatisticas.html" rel="noopener ugc nofollow" target="_blank">此处</a>找到:</p><pre class="lh li lj lk fd ll jw lm ln aw lo bi"><span id="a47b" class="lp kf hi jw b fi lq lr l ls lt">Censos<br/>  ├── Censo_Demografico_2010<br/>       ├── Resultados_do_Universo<br/>            ├── Agregados_por_Setores_Censitarios<br/>                  ├── &lt;bases_de_dados&gt;</span></pre><p id="7863" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据文件有<code class="du jt ju jv jw b">iso8859_15</code>编码和用作分隔符的<code class="du jt ju jv jw b">;</code>。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="b127" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">说得够多了，让我们言归正传</h1><p id="1613" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">事不宜迟，让我们看一个关于Creditas地址的例子:</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">上述数据帧的格式化示例</figcaption></figure><p id="12a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的目标是将人口普查变量提取到这个地址。当您打开人口普查数据库时，您会看到类似于下表的内容:</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="768b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du jt ju jv jw b">Cod_setor</code>是普查部门的代码，<code class="du jt ju jv jw b">V001</code>、<code class="du jt ju jv jw b">V002</code>和<code class="du jt ju jv jw b">V003</code>是遇到的变量的例子。他们的解释可以在人口普查文件(葡萄牙语)以及数据库链接中找到。</p><p id="1e55" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，挑战将是把地址字符串转换成<code class="du jt ju jv jw b">355030835000017</code>代码来提取变量。这两者之间的连接将使用一个名为Shapefile ( <code class="du jt ju jv jw b">.shp</code>)的地理空间文件来完成，这是一个包含地理特征的数据框，其格式如下:</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="5f90" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对我们很重要的两列是<code class="du jt ju jv jw b">CD_GEOCODI</code>和<code class="du jt ju jv jw b">geometry</code>，前者是人口普查代码，后者包含一个<code class="du jt ju jv jw b">POLYGON</code>对象，该对象具有被映射扇区的地理坐标(分别是经度和纬度)。</p><p id="a20f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个过程的总体思路是将地址转换成经度和纬度，以便使用Shapefile得到码扇区。</p><p id="c055" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">人口普查形状文件。shp文件可通过以下链接获得:</p><div class="lx ly ez fb lz ma"><a href="http://geoftp.ibge.gov.br/organizacao_do_territorio/malhas_territoriais/malhas_de_setores_censitarios__divisoes_intramunicipais/censo_2010/setores_censitarios_shp/" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hj fi z dy mf ea eb mg ed ef hh bi translated">的索引</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">编辑描述</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">geoftp.ibge.gov.br</p></div></div></div></a></div></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="7ec6" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">将地址转换为经度和纬度</h1><p id="92e5" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">有各种各样的服务允许将地址转换成纬度和经度。在这个例子中，我们将结合使用Google Maps API、<a class="ae iu" href="https://developers.google.com/maps/documentation/geocoding/intro" rel="noopener ugc nofollow" target="_blank">地理编码</a>和<code class="du jt ju jv jw b"><a class="ae iu" href="https://github.com/googlemaps/google-maps-services-python" rel="noopener ugc nofollow" target="_blank">googlemaps</a></code>库。</p><p id="3f49" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要使用这个API，需要一个认证密钥。你可以在这里免费得到一个。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="8f6d" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">使用地址码获取普查部门的代码</h1><p id="b6a3" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">现在我们已经有了坐标位置，我们需要找出它位于哪个人口普查部门。下一步是将坐标字符串转换为Point对象，以便Shapefile理解它正在处理地理位置。我们将使用Python的<code class="du jt ju jv jw b">shapely</code>库来完成这项工作。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="9327" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，使用<code class="du jt ju jv jw b">geopandas</code>库上传人口普查部门的Shapefile，将位置与部门的多边形匹配起来。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="ed1c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，最后一步是将我们的数据集与包含人口普查变量的数据集合并。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="d88e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后一步看起来像这样:</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="d98e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">提醒:<code class="du jt ju jv jw b">V001</code>、<code class="du jt ju jv jw b">V002</code>和<code class="du jt ju jv jw b">V003</code>变量的含义可在人口普查的<a class="ae iu" href="https://www.ibge.gov.br/estatisticas/downloads-estatisticas.html" rel="noopener ugc nofollow" target="_blank">文档中找到(葡萄牙语)。</a></p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><p id="5502" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很好！您刚刚用更多有趣的地址特征丰富了您的数据库。请记住，您可以随时搜索其他数据源并应用相同的概念，这样，利用地理因素，您可以在任何地方执行分析和预测=D</p><p id="27f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有兴趣与我们合作吗？我们一直在寻找热爱技术的人加入我们的团队！你可以在这里查看我们的<a class="ae iu" href="https://boards.greenhouse.io/creditas?utm_campaign=Tripula%C3%A7%C3%A3o%20Creditas%20&amp;utm_source=hs_email&amp;utm_medium=email&amp;utm_content=82174845&amp;_hsenc=p2ANqtz-9-OYzs0SUjlA6UZmlUBnP51GM3Cc1GMrFiTlor6yRw1DAajjYhJyiAuXBTdT7NBZI4xXjuRSkLnff6kH-T4m4G84jj55eFBq12j2FNEvnsZ3C4rG0&amp;_hsmi=82174845" rel="noopener ugc nofollow" target="_blank"><em class="mj"/></a><em class="mj">。</em></p></div></div>    
</body>
</html>