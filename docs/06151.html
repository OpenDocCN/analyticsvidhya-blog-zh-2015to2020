<html>
<head>
<title>Automate Chrome Dino Game using Python | pyautogui and PIL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python | pyautogui和PIL自动化Chrome Dino游戏</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automate-chrome-dino-game-using-python-pyautogui-and-pil-eeb839005ccf?source=collection_archive---------0-----------------------#2020-05-13">https://medium.com/analytics-vidhya/automate-chrome-dino-game-using-python-pyautogui-and-pil-eeb839005ccf?source=collection_archive---------0-----------------------#2020-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4e50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嘿，伙计们，今天我们要做一件非常有趣的事情。我们将使用Python实现谷歌Chrome Dino游戏的自动化。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/8816502cb6d0f4263ef90328203d2bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*kUaj2XZF0R75duI7Lskt2w.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">chrome-dino-游戏-自动化-python</figcaption></figure><p id="2e0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是谷歌Chrome Dino游戏？</strong></p><p id="f074" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌Chrome Dino游戏是免费的离线/在线游戏，当没有互联网连接时，你可以在你的Chrome浏览器中看到。</p><p id="da6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这个游戏有多少个角色？</strong></p><p id="fe3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里主要有三个角色。</p><ol class=""><li id="b559" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">李灿</li><li id="1c38" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">仙人掌</li><li id="a830" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">鸟</li></ol><p id="2d24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">游戏怎么玩？</strong></p><p id="f952" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">玩这个游戏有两种方法。</p><ol class=""><li id="51ff" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">脱机的</li><li id="af7e" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">在线的</li></ol><p id="a8c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">离线:</strong></p><p id="215e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你的笔记本电脑没有互联网连接时，你将重定向到这个游戏，点击进入按钮游戏将开始。在这个游戏中，仙人掌和鸟随机靠近恐龙，恐龙需要通过跳跃或闪避来避免仙人掌和鸟的碰撞。根据你的表现，你会得到你的分数。</p><p id="57b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">在线:</strong></p><p id="5e9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想玩在线游戏，那么你可以访问<a class="ae kd" href="https://chromedino.com/" rel="noopener ugc nofollow" target="_blank">https://chromedino.com/</a>并像在离线时一样开始游戏。</p><h1 id="221a" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">如何使用python实现chrome dino游戏的自动化</strong></h1><p id="0b61" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">我假设你已经在你的系统中安装了<code class="du lh li lj lk b">Python3</code>。如果没有，请从<a class="ae kd" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank">这里</a>下载。之后，为了自动化的过程，我们将需要两个python包。</p><ol class=""><li id="ffad" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">pyautogui</li><li id="8088" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">PIL</li></ol><p id="4dda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以首先我们需要使用给定的命令将<code class="du lh li lj lk b">pyautogui</code>和<code class="du lh li lj lk b">PIL</code>安装到我们的系统中。</p><blockquote class="ll lm ln"><p id="bd4d" class="if ig lo ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><code class="du lh li lj lk b">pip3 install pyautogui<br/> pip3 install pillow</code></p></blockquote><p id="590f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，做完这个我们就有pyautogui和枕头了。pyautogui将帮助我们自动按下笔记本电脑的按键。</p><p id="fbfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想采取什么步骤来做到这一点？</p><p id="b0e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们将采取什么步骤来实现这一点。</p><ol class=""><li id="8105" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">首先，我需要在灰度上捕捉chrome dino游戏屏幕的截图。(黑白，因为图像处理在灰度上更好)。</li><li id="4fa8" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">然后，我只是想在这个图像上为cactus添加某种矩形，这样，当我在dino附近获得矩形的那些像素时，我就可以相应地编写逻辑来跳转dino(通过按up键)。</li><li id="c170" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">同样的道理也适用于鸟类，会形成一个矩形，但比仙人掌矩形要轻一点。(区分两个矩形)当我发现这个矩形靠近恐龙时，我将按下向下键来避开恐龙。</li><li id="d4a1" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">就是这样，在这之后，你会看到你的chrome dino游戏是使用python自动完成的。</li></ol><p id="7f18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们开始编写代码来实现我们的算法，看看它是如何工作的。</p><p id="89f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要创建一个文件，比如说<code class="du lh li lj lk b">game.py</code>。在这个文件中，首先你需要导入两个包和时间。</p><pre class="je jf jg jh fd ls lk lt lu aw lv bi"><span id="d254" class="lw kf hi lk b fi lx ly l lz ma">import pyautogui <br/>from PIL import Image, ImageGrab <br/>import time</span></pre><p id="747a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后要做一个可以给你按键的功能。</p><pre class="je jf jg jh fd ls lk lt lu aw lv bi"><span id="1f36" class="lw kf hi lk b fi lx ly l lz ma">def click(key):<br/>   pyautogui.keyDown(key)<br/>   return</span></pre><p id="1dd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在在主界面，你需要按向上键开始游戏</p><pre class="je jf jg jh fd ls lk lt lu aw lv bi"><span id="5105" class="lw kf hi lk b fi lx ly l lz ma">if __name__ == "__main__":<br/>    time.sleep(5)<br/>    click('up')</span></pre><p id="3650" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你所看到的，我们有5秒钟的延迟，这样在运行程序后，我们可以有一些时间进入chrome浏览器页面，之后，我们只需调用click函数按下up键，然后我们的游戏就开始了。</p><p id="f891" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要不断地用灰度拍摄截图。为此，我们需要使用</p><pre class="je jf jg jh fd ls lk lt lu aw lv bi"><span id="5d40" class="lw kf hi lk b fi lx ly l lz ma">while True:  # for infinity loop<br/>      # capture image in black &amp; white format<br/>      image = ImageGrab.grab().convert('L')   <br/>      data = image.load()</span></pre><p id="2af3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我们需要为仙人掌画一个长方形。</p><pre class="je jf jg jh fd ls lk lt lu aw lv bi"><span id="40db" class="lw kf hi lk b fi lx ly l lz ma"># Draw the rectangle for cactus<br/>         for i in range(530, 610):<br/>             for j in range(130, 160):<br/>                  data[i, j] = 0<br/>  image.show()<br/>  break</span></pre><p id="62fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这段代码将在捕获的图像上绘制一个矩形并返回给你。但是你需要根据你的台式机或笔记本电脑在for循环中使用x，y坐标。这个坐标适用于我的笔记本电脑屏幕尺寸，也许对你来说会有所不同。所以你的矩形应该是这样的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/3991132cebf9ac67c270dea756af8310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*akNG1A8sp3ooxzDHjrkENA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">仙人掌图像中的黑色矩形</figcaption></figure><p id="c676" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，你需要为鸟画一个矩形。</p><pre class="je jf jg jh fd ls lk lt lu aw lv bi"><span id="b55b" class="lw kf hi lk b fi lx ly l lz ma"># Draw the rectangle for birds<br/>        for i in range(530, 560):<br/>            for j in range(100, 125):<br/>                data[i, j] = 171</span></pre><p id="c519" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你的屏幕应该看起来像这样，因为你可以看到一个灰色的矩形是鸟。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mg"><img src="../Images/4b66a73494b0fbbcd7dcebd7e4a94b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bi7QqCOpmU9yIDAiZHbSJA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">鸟的灰色矩形</figcaption></figure><p id="a95e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，现在一旦你完成了矩形在图像中的位置，下一个任务是检查与恐龙的碰撞。如果你仔细观察，那么在这个游戏中，当仙人掌和鸟靠近恐龙时，恐龙并没有向前移动。因此，让我们看看我们将如何做到这一点。我们将在内部创建iscollision函数，我们将检查矩形和恐龙的碰撞。</p><pre class="je jf jg jh fd ls lk lt lu aw lv bi"><span id="bce9" class="lw kf hi lk b fi lx ly l lz ma">def isCollision(data):<br/># Check colison for birds<br/>    for i in range(530,560):<br/>        for j in range(80, 127):<br/>            if data[i, j] &lt; 171:<br/>                click("down")<br/>                return<br/> # Check colison for cactus<br/>    for i in range(530, 620):<br/>        for j in range(130, 160):<br/>            if data[i, j] &lt; 100:<br/>                click("up")<br/>                return<br/>    return</span></pre><p id="c0f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在在主函数中，在while循环中，我们将调用这个函数并注释为rectangle编写的代码，同时注释break。因为现在我们不需要他们了。</p><p id="9570" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成上述所有步骤后，您的文件将如下所示</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="9e86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在准备在终端上使用给定的命令来运行这个程序。</p><blockquote class="ll lm ln"><p id="2f08" class="if ig lo ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated">python3 game.py</p></blockquote><p id="28e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后转到chrome浏览器游戏，你会看到你的恐龙在自动运行。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mj mi l"/></div></figure><p id="96a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以从<a class="ae kd" href="https://github.com/ayushgemini/automate-chrome-dino-game-python.git" rel="noopener ugc nofollow" target="_blank"> Github </a>下载源代码。</p><p id="44b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐编码。</p><p id="f9e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一个故事再见。敬请期待！</p><p id="fd32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">可以在</strong><a class="ae kd" href="https://www.linkedin.com/in/ayush-gemini/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">LinkedIn</strong></a><strong class="ih hj">&amp;</strong><a class="ae kd" href="https://github.com/ayushgemini" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">Github</strong></a><strong class="ih hj">上联系我。</strong></p></div></div>    
</body>
</html>