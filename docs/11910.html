<html>
<head>
<title>Loss Functions — Multiclass SVM Loss and Cross Entropy Loss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">损失函数——多类SVM损失和交叉熵损失</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/loss-functions-multiclass-svm-loss-and-cross-entropy-loss-9190c68f13e0?source=collection_archive---------4-----------------------#2020-12-23">https://medium.com/analytics-vidhya/loss-functions-multiclass-svm-loss-and-cross-entropy-loss-9190c68f13e0?source=collection_archive---------4-----------------------#2020-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cf13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么损失函数在机器学习应用中更重要？在我的上一篇文章中，我们讨论了<a class="ae jd" rel="noopener" href="/analytics-vidhya/parameterized-learning-91f701f9cabb">参数化学习</a>，这种类型的学习将把一些数据作为输入和类别标签。实际上，通过定义一些参数，如权重和偏差，可以学习一个函数来将输入映射到预测的类别标签。</p><p id="e3cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，在进入SVM和交叉熵损失函数之前，我们将会看到一条损失曲线是怎样的，并有所了解。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/94aaae6a20b200acfa21deed0497aa23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OAVukRFC2JbkpKfm0QzNzA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">损失曲线</figcaption></figure><p id="6a79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图是在CIFAR-10数据集上训练的两个不同模型的损失曲线。从图上的这两条线我们可以观察到什么？</p><ol class=""><li id="39b4" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">模型1(红线)——随着模型训练时间的延长，损耗下降</li><li id="b2ea" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">模型2(蓝线)—损耗最初开始下降，但在10个时期后，它停止下降。</li></ol><p id="0792" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更好的分类器模型将具有更低的损失。(但并不总是“过拟合”是另一个概念，我们可以在后面讨论)。</p><blockquote class="ki kj kk"><p id="d03c" class="if ig kl ih b ii ij ik il im in io ip km ir is it kn iv iw ix ko iz ja jb jc hb bi translated">我一直在说“损失之上”,有些人可能理解，有些人可能不理解，但对于那些没有经历过这个术语的人来说。损失是根据你的真实类别标签和预测类别标签计算的分数。假设你已经训练了一个模型来对狗和猫的图像进行分类，模型将以0.97的概率预测你的输入图像为猫，0.03的概率为猫，你的真实标签和预测概率之间的差异只不过是一个损失。</p></blockquote><p id="329b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，该模型将根据您的损失进行训练，并更新/优化参数(权重和偏差)，以更好地预测数据。</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="9487" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">多级SVM损耗</h1><p id="3a11" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">多类SVM损失(顾名思义)受(线性)支持向量机(SVMs)的启发，它使用评分函数f将我们的数据点映射到每个类别标签的数值分数。</p><p id="51b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们用一个例子来理解多类SVM。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/08fffbeaf38cbb177ccf6fa009788598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j3uAS8z_S7RFCHS-ukzCKg.png"/></div></div></figure><p id="6ad0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，你有三张图片狗，猫和熊猫，每张图片分为三类，每张图片有三个值。</p><blockquote class="ki kj kk"><p id="6edf" class="if ig kl ih b ii ij ik il im in io ip km ir is it kn iv iw ix ko iz ja jb jc hb bi translated">公式:损失=最大值(0，预测-原始+1)</p></blockquote><p id="89f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于第一个图像，真实标签是狗，其预测值为狗4.26，猫1.33，熊猫-1.01。</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="9b9c" class="mf kx hi mb b fi mg mh l mi mj">image_1 = max(0, 1.33–4.26 + 1) + max(0, -1.01–4.26 + 1)</span></pre><p id="44cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，计算所有图像的损失，并将所有输入图像的计算值相加。损耗值的平均值只不过是SVM损耗(铰链损耗)</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="0e11" class="mf kx hi mb b fi mg mh l mi mj">image_2 =max(0, 3.76 — (-1.20) + 1) + max(0, -3.81 — (-1.20) + 1)</span><span id="8695" class="mf kx hi mb b fi mk mh l mi mj">image_3 =max(0, -2.37 — (-2.27) + 1) + max(0, 1.03 — (-2.27) + 1)</span><span id="6130" class="mf kx hi mb b fi mk mh l mi mj">loss = (image_1 + image_2 + image_3) / 3.0</span></pre></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="a02b" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">交叉熵损失</h1><div class="jf jg jh ji fd ab cb"><figure class="ml jj mm mn mo mp mq paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/df279e77ac75798231b85f595b4d111c.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*zYFd4rf14DGusIDHYHkLQw.png"/></div></figure><figure class="ml jj mr mn mo mp mq paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/d03286057fc41e8d4105d72df4cfdc94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1542/format:webp/1*qJ3vl37Szagq5Ntwn2oTvg.png"/></div></figure></div><p id="4b99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的目标是将输入图像(熊猫)分类为狗、猫或熊猫。这涉及三个步骤。</p><p id="5828" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第1步—我们将根据使用的函数获得三个类别中每个类别的得分值，就像我们在多类别SVM中获得的一样。</p><p id="da9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤2-对评分函数的结果求幂，以获得非标准化概率</p><p id="bc72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤3-计算未标准化概率的总和，并将每个值除以总和以获得标准化概率(Softmax图层)</p><p id="73b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤4-从步骤3中，我们实际上获得了输入图像所属的类，但是为了评估我们的值有多好，我们需要对归一化概率应用负自然对数。</p><p id="95cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们可以对训练集中的所有图像重复这一过程，取平均值，并获得训练集的总体交叉熵损失。这个过程允许我们量化一组参数在我们的训练集上表现的好坏。</p><p id="6608" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将通过一个实际例子阐明如何计算多类和交叉熵损失。我希望这有所帮助。</p><p id="7bfb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">继续读！！！</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="8395" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">参考:</h1><p id="3098" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">Adrian Rosebrock用Python实现计算机视觉的深度学习(入门包)</p></div></div>    
</body>
</html>