<html>
<head>
<title>Yet another ML categorical variables encoding post</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">又一个ML分类变量编码post</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/yet-another-ml-categorical-variables-encoding-post-2ef5c0651991?source=collection_archive---------5-----------------------#2020-12-11">https://medium.com/analytics-vidhya/yet-another-ml-categorical-variables-encoding-post-2ef5c0651991?source=collection_archive---------5-----------------------#2020-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cfa2" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">…和一个“强大的”scikit-learn标签编码器</h2></div><h2 id="997a" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">1.介绍</h2><p id="ee58" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">机器学习算法/模型通过将数值特征作为输入来工作，这里我们可以考虑一些现实世界的应用示例，如年龄、收入、自上次交易以来的天数等。</p><blockquote class="ko kp kq"><p id="fceb" class="jv jw kr jx b jy ks ij ka kb kt im kd ku kv kf kg kw kx ki kj ky kz kl km kn hb bi translated"><strong class="jx hj"> <em class="hi">为什么我们需要分类值编码？<br/> </em> </strong>逻辑回归和神经网络是简单或复杂的嵌套<strong class="jx hj">数值函数</strong>，随机森林和GBM通过基于<strong class="jx hj">数值范围扫描</strong>以“贪婪”方式为下一次分割找到“最佳”特征/值对，等等。</p></blockquote><p id="d883" class="pw-post-body-paragraph jv jw hi jx b jy ks ij ka kb kt im kd ji kv kf kg jm kx ki kj jq kz kl km kn hb bi translated">像性别和邮政编码这样的分类值特征呢？在这种情况下，我们需要将这些特性的值编码成数字，正如我们将看到的，有几种方法可以实现这一点。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es la"><img src="../Images/c5e6aecdc238038c6f3400c3dc634d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zWVE_Klimol00QNA"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated"><a class="ae lq" href="https://unsplash.com/@kasiape?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Katarzyna Pe </a>在<a class="ae lq" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="c66f" class="pw-post-body-paragraph jv jw hi jx b jy ks ij ka kb kt im kd ji kv kf kg jm kx ki kj jq kz kl km kn hb bi translated"><strong class="jx hj"> <em class="kr"> * </em> </strong>有些库，比如<a class="ae lq" href="https://github.com/microsoft/LightGBM" rel="noopener ugc nofollow" target="_blank"> LightGBM </a>使用内置分区技术来处理分类特性，你可以在这里找到更多信息:<a class="ae lq" href="https://lightgbm.readthedocs.io/en/latest/Features.html#optimal-split-for-categorical-features" rel="noopener ugc nofollow" target="_blank">https://light GBM . readthe docs . io/en/latest/features . html # optimal-split-for-categorial-features</a></p><h2 id="791a" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">2.分类特征编码器</h2><p id="c664" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">尽管有许多方法来编码分类变量，在这篇文章中我们将看到一些最流行的方法:标签编码和一键编码。</p><p id="adcd" class="pw-post-body-paragraph jv jw hi jx b jy ks ij ka kb kt im kd ji kv kf kg jm kx ki kj jq kz kl km kn hb bi translated"><strong class="jx hj"> <em class="kr">标签编码</em> </strong> <br/>在标签编码中，我们将每个分类特征值映射到一个从0到基数-1的整数，其中基数是特征的不同值的计数。你可以点击查看scikit-learn实现<a class="ae lq" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6d27" class="pw-post-body-paragraph jv jw hi jx b jy ks ij ka kb kt im kd ji kv kf kg jm kx ki kj jq kz kl km kn hb bi translated"><strong class="jx hj"> <em class="kr">一键编码</em> </strong> <br/>在一键编码中，我们将特征的每个值映射到不同的二进制“虚拟”特征，例如，如果我们的特征<em class="kr">性别</em>的值为“男性”和“女性”，那么我们将一个特征<em class="kr">性别</em>替换为两个新特征<em class="kr">is _男性</em>和<em class="kr">is _女性</em>，它们可以取值0或1。请注意，如果基数足够大，那么我们将不得不用更多的特性来替换一个特性，这可能会导致内存消耗爆炸。<br/> Scikit-learn One-Hot编码器可在此<a class="ae lq" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" rel="noopener ugc nofollow" target="_blank">链接</a>中找到。</p><h2 id="5608" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">3.利弊</h2><p id="7746" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">在下表中，我们可以看到两种分类值编码方法的优缺点:</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lr"><img src="../Images/f59541c8a2fdedfb1a7057c9a61663b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FSC7oDBlhgLFbldx1kkoEg.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">标签编码和一次性编码的优缺点。</figcaption></figure><h2 id="6e0c" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">4.处理未来输入数据</h2><p id="15f3" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">现实世界/企业级ML模型的一个最重要的方面是能够处理未来的输入数据，包括泛化能力(即保持与训练数据集中相同的预测质量)和执行能力。特别是对于第二种情况，假设已经对您的模型进行了训练和评估，因此您已经准备好部署到生产中了。<br/>假设您的模型中有一个名为“postal_code”的分类特性，在您的训练数据集中有150个不同的值(基数),并且您已经应用了上述两种编码技术中的一种。</p><blockquote class="ko kp kq"><p id="38c7" class="jv jw kr jx b jy ks ij ka kb kt im kd ku kv kf kg kw kx ki kj ky kz kl km kn hb bi translated">如果一个新的预测示例的邮政编码值不同于训练数据集中的150个值，会发生什么情况？</p></blockquote><ul class=""><li id="beb7" class="ls lt hi jx b jy ks kb kt ji lu jm lv jq lw kn lx ly lz ma bi translated">scikit-learn标签编码器将失败，因为它不是通过使用这个新值来拟合的，给出以下错误:<br/> <em class="kr"> "ValueError: y包含以前未见过的标签:['new_value']" </em></li><li id="b927" class="ls lt hi jx b jy mb kb mc ji md jm me jq mf kn lx ly lz ma bi translated">更糟糕的是，一键编码器将不得不创建新的“虚拟”二进制特征“邮政编码新值”，从而导致预测特征空间的不同维度(增加1)。您的ML模型将无法处理这种情况并生成预测，除非您为训练和评分阶段显式定义预测器特征。</li></ul><p id="8f93" class="pw-post-body-paragraph jv jw hi jx b jy ks ij ka kb kt im kd ji kv kf kg jm kx ki kj jq kz kl km kn hb bi translated">在下一节中，我们将看到如何在scikit-learn标签编码器的情况下克服这个问题。</p><h2 id="8dac" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">5.一个“健壮的”scikit-lean标签编码器</h2><p id="47b3" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">您可以在下面找到所需的代码修改，以便拥有能够处理不可见输入值的scikit-learn标签编码器版本。</p><figure class="lb lc ld le fd lf"><div class="bz dy l di"><div class="mg mh l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">一个“健壮的”scikit-learn标签编码器</figcaption></figure><h2 id="b4c6" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">6.参考</h2><p id="8f02" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">[1] Scikit-learn预处理:<a class="ae lq" href="https://scikit-learn.org/stable/modules/preprocessing.html#" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/modules/preprocessing.html</a></p></div></div>    
</body>
</html>