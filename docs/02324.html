<html>
<head>
<title>Text classifier on Java with WEKA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于WEKA的Java文本分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/debit-and-credit-classifier-based-on-java-or-how-non-flying-bird-weka-helps-to-solve-the-problem-428204e5a6d2?source=collection_archive---------9-----------------------#2019-12-11">https://medium.com/analytics-vidhya/debit-and-credit-classifier-based-on-java-or-how-non-flying-bird-weka-helps-to-solve-the-problem-428204e5a6d2?source=collection_archive---------9-----------------------#2019-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c6af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">确定金融服务交易方向的主题已经得到了充分的研究，但是还有新的方法和工具可以在不同的层面上解决这个问题。本文主要研究基于Java中WEKA框架的事务文本分类器。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a29fada00aaa7ccf8bf31368ff5d2967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCYsg1v4GWuSBIbmGRQ_iw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">亚历克斯·蒂托夫版权所有</figcaption></figure><p id="c42e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的几十年里，金融服务发展迅速。现代金融包括银行、贷款、税收、投资管理、转账和支付。所有这些组件几乎全部迁移到了虚拟空间。在线办公室和移动客户端为用户提供了对服务的持续访问。这些资源方便实用，提供个人和企业级别的服务，以及持续运行的客户服务系统。这些工具允许进行各种类型的货币交易。电子服务在不断发展，自动化，变得“更智能”</p><p id="7858" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">电子金融最基本的技术目标之一是确定物质资源(支出/收入)的流向。如何确定一笔银行交易在某个时间是流入还是流出？</p><p id="79a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在澳大利亚工具<a class="ae jt" href="https://www.cs.waikato.ac.nz/ml/weka/" rel="noopener ugc nofollow" target="_blank"> WEKA </a>的帮助下，这些和其他类似的任务很容易实现自动化。该工具提供了数据分析和机器学习的方法，包括金融文本的处理。</p><p id="5bc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">韦卡是一种不会飞的鸟，属于T4秧鸡科，是纽西兰特有的鸟类。在新西兰怀卡托大学用Java编写并在GNU GPL许可下发布的自由软件的作者和开发者选择了这只鸟作为“核心”,并教给了它很多东西。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/3aca97f1d47c98bb25460ee1731bd625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*mJKyxc_OUpUMbDdANSr0wg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">版权来自https://deeplearning.cms.waikato.ac.nz/</figcaption></figure><p id="c5c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管它的名字奇怪而有趣，但WEKA是一种能够解决复杂金融任务的工具。</p><p id="4700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们来看看用关键词对一笔金钱交易进行分类的问题。这个目标非常类似于垃圾邮件分类器:如果二进制垃圾邮件分类器被适当地修改，它可能变成借贷分类器。</p><p id="a953" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以在朴素贝叶斯分类器上开发二元分类器，朴素贝叶斯分类器基于贝叶斯定理及其关于测试独立性的严格(“朴素”)假设。因此，WEKA为贝叶斯分类器提供了一个强有力的工具。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jv jw l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Java和Weka工具导入</figcaption></figure><p id="80f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个名为DebitCreditWekaClassifier.java的类，该类准备数据集并训练分类器的模型。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="116e" class="kc kd hi jy b fi ke kf l kg kh">public class DebitCreditWekaClassifier {...}</span></pre><p id="ab2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入受保护的类变量，即不能从外部访问的类变量。在这种情况下，我们有FilteredClassifier过滤器的对象和logger类的Logger。FilteredClassifier对象是分类器的对象。分类器基于数据通过的过滤器(具有权重或系数的结构)。滤波器的结构及其系数仅基于训练数据集。测试数据将由滤波器处理，而不改变其系数，并且在某些情况下不改变结构。如果在训练后出现不相等的权重或分类错误，则重新处理数据的实例或属性。通常，使用来自原始训练数据集的替代样本。所以所有的过滤器权重在它们被传送到最终的分类器之前被指定(重新配置)。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jv jw l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">记录器和其他私有变量</figcaption></figure><p id="1cd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据<em class="ki"> trainData。</em> txt将包含一组实例和标签。</p><p id="5385" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">属性类是wekaAttributes。属性一旦创建，就不能更改。可能有以下类型的属性:数字、字符串、日期、关系和名义。最后一种类型是一组固定的标称值。更多关于WEKA属性的信息，点击<a class="ae jt" href="https://weka.sourceforge.io/doc.dev/weka/core/Attribute.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="08dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们继续描述基本的类方法。首先，我们将看一下<em class="ki">的DebitCreditWekaClassifie </em> r类构造函数。看起来是这样的:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jv jw l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">类的构造函数</figcaption></figure><p id="8359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该方法包含分类器<em class="ki">分类器</em>的未训练实例。要确定分类算法，请设置多项式朴素贝叶斯分类器NaiveBayesMultinomial()(有关详细信息，请参阅)。在<em class="ki"> wekaAttributes </em>中定义模型属性。第一个属性是<em class="ki"> attributeText </em>。此处将放置培训的标记文本；该模型将处理文本数据。将定型数据的类标签添加到classAttribute容器中；在我们的例子中，有两种类型的标签:<strong class="ih hj">借方</strong>和<strong class="ih hj">贷方</strong>。至此，构造函数的形成完成。</p><p id="c03c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们必须将数据转换成所需的ARFF ( <a class="ae jt" href="https://www.cs.waikato.ac.nz/ml/weka/arff.html" rel="noopener ugc nofollow" target="_blank">属性关系文件格式</a>)格式。上传并保存ARFF格式的数据。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jv jw l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">加载训练数据</figcaption></figure><p id="a970" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们必须创建<strong class="ih hj">一个过滤器，将字典转换成<em class="ki">stringtowordpvector</em><em class="ki">过滤器</em>的属性矢量</strong>。属性向量是表示特定对象的数字参数的n维向量。</p><p id="c297" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了获得一组基于文本数据的向量，有必要将训练样本分割成短语。为此，添加一个标记器，将数据分成短语或N元语法。N-gram通常是一个单词范围。对于这个实验，短语的大小被设置为只有一个单词<em class="ki">tokenizer . setngramminsize(1)</em>。作为分隔符，让我们指定任何非字母数字字符“\\W”。看起来是这样的:<em class="ki">tokenizer . set delimiters(" \ \ W ")</em>。将指定的标记器应用于filter.setTokenizer(标记器)。以下是过滤器功能中包含的标准过程—转换为小写<em class="ki">filter . setlowercasetokens(true)</em>。然后，我们将新配置的过滤器应用于<em class="ki"> classifier.setFilter(filter)。</em></p><p id="2e8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们继续对准备好的数据进行分类器的训练。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jv jw l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">构建模型的分类器</figcaption></figure><p id="a145" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">培训在没有错误和记录的情况下进行。之后，必须创建并保存MODEL = " MODEL/debit _ credit _ MODEL . dat "模型。</p><p id="288c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行测试以分析获得的模型，并将结果写入记录器。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="cb6c" class="kc kd hi jy b fi ke kf l kg kh">LOGGER.info("Evaluation Result: \n"+wt.evaluate());<br/>....<br/>Analysis result</span><span id="1f6b" class="kc kd hi jy b fi kj kf l kg kh">Correctly Classified Instances           8              100      %<br/>Incorrectly Classified Instances         0                0      %<br/>Kappa statistic                          1     <br/>Mean absolute error                      0.2334<br/>Root mean squared error                  0.2456<br/>Relative absolute error                 46.6838 %<br/>Root relative squared error             49.1217 %<br/>Total Number of Instances                8</span></pre><p id="728b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于测试样本较短，相对和绝对分类误差相当高，需要扩大测试数据集。值得注意的是，所有的测试示例都没有出现错误。因此，我们有一个最小可行的产品(<a class="ae jt" href="https://steelkiwi.com/blog/what-mvp-and-why-it-necessary/" rel="noopener ugc nofollow" target="_blank"> MVP </a>)的交易分类器，它可以成为任何金融服务的核心，用于确定交易的方向。</p><p id="74dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参见项目<a class="ae jt" href="https://github.com/AlexTitovWork/testWekaClassify" rel="noopener ugc nofollow" target="_blank">https://github.com/AlexTitovWork/testWekaClassify</a>网站上的完整代码。</p><p id="9a88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">祝福你，亚历克斯！</p><p id="69f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/AlexTitovWork" rel="noopener ugc nofollow" target="_blank">https://github.com/AlexTitovWork</a></p></div></div>    
</body>
</html>