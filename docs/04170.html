<html>
<head>
<title>Python packaging and dependency management using poetry</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用诗歌的Python打包和依赖性管理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-packaging-and-dependency-management-using-poetry-b7a7b3dd8e60?source=collection_archive---------5-----------------------#2020-03-08">https://medium.com/analytics-vidhya/python-packaging-and-dependency-management-using-poetry-b7a7b3dd8e60?source=collection_archive---------5-----------------------#2020-03-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="8133" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="4ad4" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi kb translated">依赖关系管理是一种以自动化方式声明、解析和使用项目所需依赖关系的技术。有几种不同的方法来处理Python中的依赖关系。在本文中，我将向您展示如何使用<strong class="jf hj">诗歌</strong>来管理项目的依赖关系。<strong class="jf hj">poems</strong>是Python中进行依赖管理和打包的工具。它允许您声明项目的依赖项，并为您管理它们。</p><h1 id="c473" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">先决条件</h1><p id="cb10" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">诗词</strong>要求<a class="ae kk" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python </a> 2.7或3.4+。它是多平台的，目标是让它在不同的操作系统上都能很好地工作。</p><h1 id="9f2f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">装置</h1><p id="ebd0" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">poems</strong>提供了一个定制的安装程序，它将通过出售诗歌的依赖项来安装与系统其余部分隔离的诗歌。这是推荐的装诗方式。或者，您可以使用<strong class="jf hj"> <em class="kl"> pip install </em> </strong>命令将它安装在您现有的python之上。</p><h2 id="5760" class="km ig hi bd ih kn ko kp il kq kr ks ip jo kt ku it js kv kw ix jw kx ky jb kz bi translated">在Linux/macOS上</h2><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="35f8" class="km ig hi lf b fi lj lk l ll lm">curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py | python</span></pre><h2 id="1ee5" class="km ig hi bd ih kn ko kp il kq kr ks ip jo kt ku it js kv kw ix jw kx ky jb kz bi translated">在windows上(PowerShell)</h2><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="d1bf" class="km ig hi lf b fi lj lk l ll lm">(Invoke-WebRequest -Uri https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py -UseBasicParsing).Content | python</span></pre><p id="6814" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">安装程序将<code class="du ls lt lu lf b">poetry</code>工具安装到poems的<code class="du ls lt lu lf b">bin</code>目录中。在Unix上，它位于<code class="du ls lt lu lf b">$HOME/.poetry/bin</code>，在Windows上，它位于<code class="du ls lt lu lf b">%USERPROFILE%\.poetry\bin</code>，在任一操作系统上，您都应该看到以下输出:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="5be8" class="km ig hi lf b fi lj lk l ll lm">Retrieving Poetry metadata</span><span id="d182" class="km ig hi lf b fi lv lk l ll lm"># Welcome to Poetry!</span><span id="ed2f" class="km ig hi lf b fi lv lk l ll lm">This will download and install the latest version of Poetry,<br/>a dependency and package manager for Python.</span><span id="a871" class="km ig hi lf b fi lv lk l ll lm">It will add the `poetry` command to Poetry’s bin directory, located at:</span><span id="b077" class="km ig hi lf b fi lv lk l ll lm">$HOME/.poetry/bin</span><span id="1280" class="km ig hi lf b fi lv lk l ll lm">This path will then be added to your `PATH` environment variable by<br/>modifying the profile file located at:</span><span id="13bc" class="km ig hi lf b fi lv lk l ll lm">$HOME/.profile</span><span id="9c5d" class="km ig hi lf b fi lv lk l ll lm">You can uninstall at any time by executing this script with the — uninstall option,<br/>and these changes will be reverted.</span><span id="3358" class="km ig hi lf b fi lv lk l ll lm">Installing version: 1.0.5<br/> — Downloading poetry-1.0.5-linux.tar.gz (23.00MB)</span><span id="140b" class="km ig hi lf b fi lv lk l ll lm">Poetry (1.0.5) is installed now. Great!</span><span id="349c" class="km ig hi lf b fi lv lk l ll lm">To get started you need Poetry's bin directory ($HOME/.poetry/bin) in your `PATH`<br/>environment variable. Next time you log in this will be done<br/>automatically.</span><span id="c4c1" class="km ig hi lf b fi lv lk l ll lm">To configure your current shell run `source $HOME/.poetry/env`</span></pre><p id="fb79" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">使用<code class="du ls lt lu lf b">poetry --version</code>查看安装是否成功。您应该会看到类似于<code class="du ls lt lu lf b">Poetry 1.0.5</code>的结果。</p><h1 id="f7f0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">使用</h1><p id="4c13" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">poem帮助您声明、管理和安装Python项目的依赖项，确保您在任何地方都有正确的堆栈。</p><h2 id="9ff3" class="km ig hi bd ih kn ko kp il kq kr ks ip jo kt ku it js kv kw ix jw kx ky jb kz bi translated">安装依赖项并创建虚拟环境</h2><p id="b4df" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">poems只使用一个文件(<code class="du ls lt lu lf b">pyproject.toml</code>)来管理你的项目依赖关系。换句话说，诗用<code class="du ls lt lu lf b">pyproject.toml</code>代替<code class="du ls lt lu lf b">setup.py</code>、<code class="du ls lt lu lf b">requirements.txt</code>、<code class="du ls lt lu lf b">setup.cfg</code>、<code class="du ls lt lu lf b">MANIFEST.in</code>、<code class="du ls lt lu lf b">Pipfile</code>。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4762" class="km ig hi lf b fi lj lk l ll lm">[<em class="kl">tool</em>.<em class="kl">poetry</em>]</span><span id="6f46" class="km ig hi lf b fi lv lk l ll lm">name = "test-package"</span><span id="c951" class="km ig hi lf b fi lv lk l ll lm">version = "0.1.0"</span><span id="e440" class="km ig hi lf b fi lv lk l ll lm">description = "The description of the package goes here"</span><span id="b85c" class="km ig hi lf b fi lv lk l ll lm">license = "MIT"</span><span id="44db" class="km ig hi lf b fi lv lk l ll lm">authors = [</span><span id="3ff8" class="km ig hi lf b fi lv lk l ll lm">"MehrdadEP &lt;mehrdadep@outlook.com&gt;"</span><span id="f010" class="km ig hi lf b fi lv lk l ll lm">]</span><span id="5a50" class="km ig hi lf b fi lv lk l ll lm">readme = 'README.md'  # Markdown files are supported</span><span id="610c" class="km ig hi lf b fi lv lk l ll lm">repository = "https://github.com/python-poetry/poetry"</span><span id="8b15" class="km ig hi lf b fi lv lk l ll lm">homepage = "https://github.com/python-poetry/poetry"</span><span id="9b50" class="km ig hi lf b fi lv lk l ll lm">keywords = ['packaging', 'poetry']<br/></span><span id="e67d" class="km ig hi lf b fi lv lk l ll lm">[<em class="kl">tool</em>.<em class="kl">poetry</em>.<em class="kl">dependencies</em>]</span><span id="f86a" class="km ig hi lf b fi lv lk l ll lm">python = "~2.7 || ^3.2"  # Compatible python versions must be declared here</span><span id="8448" class="km ig hi lf b fi lv lk l ll lm"># Dependencies with extras</span><span id="77b1" class="km ig hi lf b fi lv lk l ll lm">requests = { version = "^2.13", extras = [ "security" ] }</span><span id="b924" class="km ig hi lf b fi lv lk l ll lm"># Python specific dependencies with prereleases allowed</span><span id="6a94" class="km ig hi lf b fi lv lk l ll lm">pathlib2 = { version = "^2.2", python = "~2.7", allow-prereleases = true }</span><span id="221d" class="km ig hi lf b fi lv lk l ll lm"># Git dependencies</span><span id="8375" class="km ig hi lf b fi lv lk l ll lm">cleo = { git = "https://github.com/sdispater/cleo.git", branch = "master" }<br/></span><span id="d25b" class="km ig hi lf b fi lv lk l ll lm"># Optional dependencies (extras)</span><span id="66ca" class="km ig hi lf b fi lv lk l ll lm">pendulum = { version = "^1.4", optional = true }<br/></span><span id="2521" class="km ig hi lf b fi lv lk l ll lm">[<em class="kl">tool</em>.<em class="kl">poetry</em>.<em class="kl">dev-dependencies</em>]</span><span id="e578" class="km ig hi lf b fi lv lk l ll lm">pytest = "^3.0"</span><span id="669b" class="km ig hi lf b fi lv lk l ll lm">pytest-cov = "^2.4"</span></pre><p id="57a6" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">第一次使用<strong class="jf hj"> <em class="kl"> install </em> </strong>命令创建虚拟环境并安装所有依赖项</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b9f6" class="km ig hi lf b fi lj lk l ll lm">poetry install</span></pre><h2 id="6048" class="km ig hi bd ih kn ko kp il kq kr ks ip jo kt ku it js kv kw ix jw kx ky jb kz bi translated">其他有用的命令</h2><ol class=""><li id="5611" class="lw lx hi jf b jg jh jk jl jo ly js lz jw ma ka mb mc md me bi translated">使用<strong class="jf hj"> <em class="kl"> add </em> </strong>命令向现有环境添加一个新的依赖项</li></ol><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="8ffe" class="km ig hi lf b fi lj lk l ll lm">poetry add pendulum</span></pre><p id="f029" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">2.使用<strong class="jf hj"> <em class="kl"> build </em> </strong>命令从您的项目中构建一个包</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="f58b" class="km ig hi lf b fi lj lk l ll lm">poetry build</span></pre><p id="0f71" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">3.使用<strong class="jf hj"> <em class="kl">发布</em> </strong>命令将您的项目发布到PyPI</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="6a73" class="km ig hi lf b fi lj lk l ll lm">poetry publish</span></pre><p id="3d6a" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">4.使用<strong class="jf hj"> <em class="kl"> show </em> </strong>命令跟踪项目的依赖项并洞察它们</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b06c" class="km ig hi lf b fi lj lk l ll lm">poetry show --tree<br/>poetry show --latest</span></pre><p id="88a8" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">5.使用<strong class="jf hj"> <em class="kl">新建</em> </strong>命令创建一个带有诗歌的Python项目(该命令创建一个空项目和所需文件)</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="820e" class="km ig hi lf b fi lj lk l ll lm">poetry new test-project</span></pre><p id="319f" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">6.使用项目根目录中的<strong class="jf hj"> <em class="kl"> shell </em> </strong>命令激活一个现有的虚拟环境</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="c22e" class="km ig hi lf b fi lj lk l ll lm">poetry shell</span></pre><h1 id="ac00" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">卸载诗歌</h1><p id="1019" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果您认为诗歌不适合您，您可以通过使用<code class="du ls lt lu lf b">--uninstall</code>选项再次运行安装程序，或者在执行安装程序之前设置<code class="du ls lt lu lf b">POETRY_UNINSTALL</code>环境变量，将它从您的系统中完全删除。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4e64" class="km ig hi lf b fi lj lk l ll lm">python get-poetry.py --uninstall<br/>POETRY_UNINSTALL=1 python get-poetry.py</span></pre></div></div>    
</body>
</html>