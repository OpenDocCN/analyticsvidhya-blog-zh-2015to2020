<html>
<head>
<title>Convolutional Neural Networks to diagnose Malaria</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卷积神经网络诊断疟疾</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/convolutional-neural-network-to-diagnose-malaria-80062c5683d1?source=collection_archive---------21-----------------------#2019-09-04">https://medium.com/analytics-vidhya/convolutional-neural-network-to-diagnose-malaria-80062c5683d1?source=collection_archive---------21-----------------------#2019-09-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9e4f78dfa8854213c6d035c2da0545cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ppl28a2aO-aG5ROg"/></div></div></figure><p id="86fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">疟疾导致许多人死亡，受疟疾影响最大的年龄组在5岁以下。它是由受感染的雌性按蚊传播的疟原虫寄生虫引起的。有几种技术用于疟疾的血液测试，但它们需要专家来检查病人的血液样本。在这里，我们将创建一个深度学习模型来完成这项由专家执行的任务。</p><p id="eb7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，您将看到深度学习在图像数据上的表现。本文中提到的任务可以由任何初学者来完成，因为这是CNN的一个简单应用，没有什么特别的</p><h2 id="9512" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated"><strong class="ak">数据集</strong></h2><p id="6e67" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">这里我们有一组染色血液样本的显微镜图像和每个图像的注释文件。我们需要从这些给定的数据中提取补丁，这样我们就可以用它来训练我们的模型。下面是示例图像。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/a23032fd778d7d4b840ddfb8932fc2fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*KfRVRMjX9LZYRufkOkHqTQ.jpeg"/></div></figure><p id="29a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注释文件只是包含图像中疟原虫寄生虫的x和y坐标的XML文件。我们已经使用注释文件从两种类型的图像中提取了补丁。</p><p id="53e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是一些摘录的补丁。这里的补丁大小是50X50。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/35a1245fda7eef85d20e5b3784a85622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*4GjHv4YtCBBBQiVJ"/></div></figure><p id="3510" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们已经从图像中提取了需要将其转换为数据框的补丁。RGB图像是像素值的集合，像素值是介于0到255之间的数值，有三个通道。因此，由于我们有三个通道的50×50的面片，数据帧中的总列数将是50*50*3 = 7500，从0到7499开始。下面是熊猫数据框的像素值及其标注。这里标签1表示寄生虫存在，0表示寄生虫不存在。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f70fb3bfe2ba30dc005852e58258986c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D5f3oyNtER8qkzHE"/></div></div></figure><p id="b9f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于我们不希望我们的模型偏向任何特定的标签，我们从两个类中选择了相同数量的数据点。</p><h2 id="6190" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated"><strong class="ak">将数据分成训练集和测试集</strong></h2><p id="2f40" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">将数据拆分为训练集和测试集，将数据整形为模型的输入形状。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/59e9c026e18f1f5e54dbd3a33658605f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KjfsMn9aInDy8N4a"/></div></div></figure><h2 id="954a" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated"><strong class="ak">型号</strong></h2><p id="ad50" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">当我们准备好数据后，让我们创建一个CNN模型。我创建了一个10层的模型，包括Conv2D，MaxPooling2D，Flatten和Dropout。人们可以随意试验模型的架构和其他参数，看看模型的性能如何变化。</p><ul class=""><li id="278b" class="ku kv hi is b it iu ix iy jb kw jf kx jj ky jn kz la lb lc bi translated">Conv2D:卷积将一个函数与另一个函数混合，以减少数据空间，同时保留信息。使用激活函数生成特征图。</li><li id="68c3" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn kz la lb lc bi translated">MaxPooling2D:它通过应用最大过滤器对图像进行下采样。</li><li id="59fd" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn kz la lb lc bi translated">展平:它将前一层的输入转换为1D矢量，并输入到致密层</li><li id="1b01" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn kz la lb lc bi translated">退出:这是一种防止CNN过度拟合的正则化技术</li></ul><p id="3999" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是模型架构。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/48800af1cebf753c87c200248a6d6b74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_mFXP4Ymsi-HzB27"/></div></div></figure><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2118efeff14190b8b9b8f183870dc3df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HEwjJijVZXrRFTA2"/></div></div></figure><p id="c55d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经创建了模型，是时候训练模型了。训练后保存模型，以便我们以后使用。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c3323a883b247707f2b53fd6f19cc391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mqUE6NYIwZWOCmKC"/></div></div></figure><p id="0d44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们绘制模型损耗随时期的变化。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ca1f9b196ea90309db22607463b34167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xKq3yr91k4R6gLwY"/></div></div></figure><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/21881b64bddf3fde5f767afdbdf79b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/0*jnEUZvVWAxSIwhyx"/></div></figure><p id="95d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图显示训练和验证损失之间的差异并不大，我们可以说模型既没有过拟合也没有欠拟合。训练之后，是时候评估我们的模型，并在测试数据上检查它的性能了。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e728f34da640f62a52dafe850259343b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BSYaiX3LHwM_-QTt"/></div></div></figure><p id="c414" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里model.evaluate()返回模型的损失值和精度的列表。该模型在测试数据集上的损失为0.1959，准确率为94%。这个经过训练的模型可以用来预测未来看不见的图像。</p><p id="7329" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/be3d20e5c6cce4618fc72b6f953e46d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:160/0*njMJCdsdgzTaR2lZ"/></div></figure><p id="553d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">人工智能和机器学习爱好者。<a class="ae ll" href="https://csvankhede.wordpress.com/author/csvankhede/" rel="noopener ugc nofollow" target="_blank">查看csvankhede的所有帖子</a></p><p id="abf2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">发表</strong></p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><p id="3f4a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lt">原载于2019年9月4日</em><a class="ae ll" href="https://csvankhede.wordpress.com/2019/09/04/convolutional-neural-network-to-diagnose-malaria/" rel="noopener ugc nofollow" target="_blank"><em class="lt">http://csvankhede.wordpress.com</em></a><em class="lt">。</em></p></div></div>    
</body>
</html>