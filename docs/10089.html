<html>
<head>
<title>Improving Ad Targeting with Starbucks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用星巴克改善广告定位</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/improving-starbucks-ad-targeting-91833dff3e94?source=collection_archive---------13-----------------------#2020-10-04">https://medium.com/analytics-vidhya/improving-starbucks-ad-targeting-91833dff3e94?source=collection_archive---------13-----------------------#2020-10-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0877" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">发现星巴克移动应用用户对优惠的反应</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/c87e523e9a331ec653ddbb7c46d6216b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*45G4mtNY_aPp0Ljf"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">汉斯·维维克在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="afc3" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">一.导言</h1><h2 id="87b7" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">1.背景</h2><p id="3b53" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">作为消费者，从电子邮件到社交媒体，我们在数字生活的每个渠道都不断受到广告的轰炸。正如你可能已经注意到的，这些优惠中有很多与我们高度相关，而其他的则完全没有。公司每年在广告上花费数百万美元，而这些失误并没有有效地利用这些钱。</p><p id="c6c4" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">这是一个广告定位的客户细分问题。由于客户对不同类型的优惠有不同的反应，所以没有一种优惠类型对所有客户都是最好的。</p><p id="c415" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">在本文中，我们将分析星巴克的移动应用数据，以发现用户对不同优惠的反应，并相应地对他们进行细分。有了对顾客行为的更好理解，星巴克将能够改进向顾客发送广告的方式。</p><h2 id="beb4" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">2.概观</h2><p id="e441" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">这里的目的是改善广告定位，所以我提出一个两部分的解决方案:</p><ol class=""><li id="30dd" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp ma mb mc md bi translated"><strong class="kz hj">根据人口统计数据和移动应用程序上的行为对客户进行细分— </strong>这些细分将让我们直观地了解对优惠有反应或无反应的客户</li><li id="6564" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><strong class="kz hj">构建一个分类器，预测用户是否会对某个要约做出回应— </strong>这个分类器将帮助我们确定是否应该向特定用户发送要约</li></ol><p id="8bed" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">您可以跟随我的<a class="ae jn" href="https://github.com/tri-bui/starbucks-segmentation" rel="noopener ugc nofollow" target="_blank"> Github库</a>中的Jupyter笔记本。考虑到解决方案，我们的工作流程顺序如下:</p><ol class=""><li id="03f2" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp ma mb mc md bi translated"><strong class="kz hj">探索性数据分析</strong> —预处理原始数据，探索数据中不同的优惠和用户</li><li id="92c1" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><strong class="kz hj">客户细分</strong>—使用分位数分析和k均值聚类</li><li id="09c7" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><strong class="kz hj">预测建模</strong> —采用逻辑回归、k近邻(KNN)、支持向量机(SVM)、决策树、随机森林和光照梯度推进机(LightGBM)</li></ol><p id="64c5" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">这是一个二元分类器，预测用户是否会完成某个要约。基于预测准确性和F1分数来评估模型。我们的最终分类器将是具有最佳性能的模型。</p><h2 id="bcda" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">3.数据</h2><p id="6467" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">我们正在查看的数据集包含1个月的模拟数据，模拟了星巴克奖励移动应用程序上的客户行为。这是真实星巴克应用程序的简化版本，因为底层模拟器只有一种产品，而星巴克实际上销售几十种产品。</p><p id="ec5e" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">每隔几天，星巴克就会向手机应用用户发出优惠信息。某些用户在某些周内可能收不到任何优惠，并且并非所有用户都收到相同的优惠。有3种类型的优惠:</p><ul class=""><li id="adf1" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp mj mb mc md bi translated"><code class="du mk ml mm mn b">BOGO</code>(买一送一)——在优惠到期前消费<em class="mo">一次</em>的<code class="du mk ml mm mn b">A</code>金额，获得与<code class="du mk ml mm mn b">A</code>等值的<code class="du mk ml mm mn b">R</code></li><li id="f977" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated"><code class="du mk ml mm mn b">Discount</code> —在优惠到期前，在<em class="mo">中消费金额<code class="du mk ml mm mn b">A</code>一次或多次</em>购买，即可获得与<code class="du mk ml mm mn b">A</code>等值或更低的折扣<code class="du mk ml mm mn b">D</code>(有效期内的所有购买累计达到所需金额<code class="du mk ml mm mn b">A</code>)</li><li id="aa25" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated"><code class="du mk ml mm mn b">Informational</code> —仅提供产品信息</li></ul><p id="1e00" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">对于折扣和BOGO优惠，所需的消费金额、奖励和有效期各不相同。至于信息优惠，没有规定消费金额，也没有奖励，但还是有有效期的。在这些情况下，假设客户在此期间感受到了优惠的影响。</p><p id="e4f4" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">顾客不会选择他们收到的报价。换句话说，用户可以收到要约，但实际上从未查看过要约，仍然可以完成要约。虽然这些报价被记录为已完成，但它们实际上对客户没有影响，因为它们没有被查看。</p><p id="ac23" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">有3个相关的数据集:</p><ol class=""><li id="7edc" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp ma mb mc md bi translated"><code class="du mk ml mm mn b"><strong class="kz hj">Porfolio</strong></code> (10个报价x 6个字段)—每个报价的元数据</li></ol><blockquote class="mp mq mr"><p id="aac3" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated"><code class="du mk ml mm mn b">id</code> —优惠ID <br/> <code class="du mk ml mm mn b">offer_type</code> — BOGO、折扣或信息性<br/> <code class="du mk ml mm mn b">difficulty</code> —完成优惠所需的消费金额<br/> <code class="du mk ml mm mn b">reward</code> —完成优惠的奖励<br/> <code class="du mk ml mm mn b">duration</code> —以天为单位的有效期(优惠在此期限后到期)<br/> <code class="du mk ml mm mn b">channels</code> —网络、电子邮件、手机、社交</p></blockquote><p id="4474" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">2.<code class="du mk ml mm mn b"><strong class="kz hj">Profile</strong></code> (17，000个用户x 5个字段)—每个用户的人口统计数据</p><blockquote class="mp mq mr"><p id="6593" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated"><code class="du mk ml mm mn b">age</code> —缺失值编码为118 <br/> <code class="du mk ml mm mn b">became_member_on</code> —客户开户日期<br/><code class="du mk ml mm mn b">gender</code>—“M”代表男性，“F”代表女性，“O”代表其他<br/> <code class="du mk ml mm mn b">id</code> —客户ID <br/> <code class="du mk ml mm mn b">income</code> —客户年收入</p></blockquote><p id="1472" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">3.<code class="du mk ml mm mn b"><strong class="kz hj">Transcript</strong></code> (306，534个事件x 4个字段)—该月发生的事件的记录</p><blockquote class="mp mq mr"><p id="f18a" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated"><code class="du mk ml mm mn b">event</code> —交易、已收到报价、已查看报价或已完成报价<br/> <code class="du mk ml mm mn b">person</code> —客户ID <br/> <code class="du mk ml mm mn b">time</code> —测试开始后的小时数(从时间t=0开始)<br/> <code class="du mk ml mm mn b">value</code> —事件详情(报价相关事件的报价元数据和交易金额)</p></blockquote><p id="83f8" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">现在你已经理解了手头的问题和我们将要使用的数据，让我们开始吧！</p></div><div class="ab cl mv mw gp mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hb hc hd he hf"><h1 id="7470" class="jo jp hi bd jq jr nc jt ju jv nd jx jy io ne ip ka ir nf is kc iu ng iv ke kf bi translated">二。探索性数据分析</h1><h2 id="a816" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">1.数据预处理</h2><p id="9e6a" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">在执行任何分析之前，我们必须确保数据是可用的格式。首先，这是原始数据的样子。</p><div class="iy iz ja jb fd ab cb"><figure class="nh jc ni nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/bd9da142f949a10c3b888f173f2ff515.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*BjKk9zWqalkuN8Hl4rQyYw.png"/></div></figure><figure class="nh jc nn nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/93231bf54ca98b184fc89d6ff3120cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*dofUmvINt8cME812XaSziQ.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx no di np nq translated"><strong class="bd jq">图1 </strong> : ( <strong class="bd jq"> A </strong>)左边设置的<strong class="bd jq"> `profile` </strong>包含了17000个用户的人口统计数据。(<strong class="bd jq"> B </strong>)右边设置的<strong class="bd jq">`抄本`</strong>包含该月发生的事件的306，534条记录。</figcaption></figure></div><p id="9988" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">这里有几件事情需要解决:</p><ol class=""><li id="4213" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp ma mb mc md bi translated">2，175名用户在<code class="du mk ml mm mn b"><strong class="kz hj">profile</strong></code>集合中遗漏了所有人口统计信息。由于人口统计是我们想要分析的很大一部分，这些用户和他们的所有活动都被删除了。</li><li id="48c7" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated">在<code class="du mk ml mm mn b"><strong class="kz hj">transcript</strong></code>集合中有374个重复事件，所有这些事件都被丢弃了。</li><li id="3457" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><code class="du mk ml mm mn b"><strong class="kz hj">portfolio</strong></code>集合的<code class="du mk ml mm mn b">channels</code>特征(<strong class="kz hj">图2A </strong>)被扩展为3个二进制特征，指示要约是否通过该渠道发送— <code class="du mk ml mm mn b">web</code>、<code class="du mk ml mm mn b">mobile</code>和<code class="du mk ml mm mn b">social</code>。</li><li id="f489" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><code class="du mk ml mm mn b"><strong class="kz hj">transcript</strong></code>集合的<code class="du mk ml mm mn b">value</code>特征(<strong class="kz hj">图1B </strong>)也被扩展成3个附加特征——报价相关事件的<code class="du mk ml mm mn b">offer_id</code>和<code class="du mk ml mm mn b">reward</code>以及交易事件的<code class="du mk ml mm mn b">amount</code>。</li><li id="ddfe" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated">优惠id和客户id被存储为长而无意义的散列字符串，所以让我们通过将它们映射到整数来简化我们的生活:<br/> -客户id按照它们出现的顺序被映射到整数<br/> -优惠按照整体难度的顺序被映射到整数(<strong class="kz hj">图2B </strong>)</li></ol><div class="iy iz ja jb fd ab cb"><figure class="nh jc nr nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/880732dbad8e8a8cf369ef293c5204b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*WpXvyvFCfWAYxmdUq3Py5g.png"/></div></figure><figure class="nh jc ns nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/3d962a8153c2d9ffe50e0ee0d24b1c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*WI5yCNJeGDGGs20ciU28Tg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx nt di nu nq translated"><strong class="bd jq">图2 </strong> : ( <strong class="bd jq"> A </strong>)左侧的原始<strong class="bd jq"> `portfolio` </strong>集合包含该月发出的10个不同报价。(<strong class="bd jq"> B </strong>)右边设置的转换后的`<strong class="bd jq"> portfolio` </strong>显示了整体难度的顺序，从信息到折扣再到BOGO优惠。在每种类型中，报价按照“难度”递增和“持续时间”递减的顺序排列。</figcaption></figure></div><h2 id="809a" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">2.探索优惠</h2><blockquote class="nv"><p id="aef0" class="nw nx hi bd ny nz oa ob oc od oe lp dx translated">A.查看和/或完成了多少报价？</p></blockquote><p id="6501" class="pw-post-body-paragraph kx ky hi kz b la of ij lc ld og im lf kn oh lh li kq oi lk ll kt oj ln lo lp hb bi translated">在第1天、第8天、第15天、第18天、第22天和第25天，共发出了66，501份要约，总数略多于11，000份。10个不同的报价中，每个报价的数量相对平衡，从6576到6726不等。</p><p id="bdd4" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">当客户收到报价时，有4种可能性，我们将用它们对报价进行分组(<strong class="kz hj">图3 </strong>):</p><ol class=""><li id="c302" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp ma mb mc md bi translated"><strong class="kz hj">第1组</strong> (9，296份报价)—既未查看也未完成的报价</li><li id="6860" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><strong class="kz hj">第2组</strong> (17，866份报价)—已查看但未完成的报价</li><li id="d647" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><strong class="kz hj">第3组</strong> (11，497项优惠)—完成后查看或根本未查看的优惠(无论哪种情况，客户都不知道该优惠，但还是进行了购买)</li><li id="a787" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp ma mb mc md bi translated"><strong class="kz hj">第4组</strong> (27，842个报价)—已查看并完成的报价</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ok"><img src="../Images/50fa5908df8ee57eeca6a0fbf33344b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yjxpCoK-suRwey4sAsu7tw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图3 </strong>:优惠组1(下)和3(上)为蓝色。优惠组2(底部)和4(顶部)为红色。</figcaption></figure><p id="e4ca" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">在发出去的66k报价中，我们可以看到差不多完成了40k(<strong class="kz hj">图3 </strong>)，还不错。但我们也看到，那些已完成的优惠(第3组)中有11k被浪费在了那些甚至不知道有优惠并不管不顾地花了钱的客户身上。</p><blockquote class="nv"><p id="38b2" class="nw nx hi bd ny nz oa ob oc od oe lp dx translated">B.<!-- -->每个报价完成了多少？</p></blockquote><p id="706d" class="pw-post-body-paragraph kx ky hi kz b la of ij lc ld og im lf kn oh lh li kq oi lk ll kt oj ln lo lp hb bi translated">暂时将第3组报价放在一边，让我们来分解报价完成情况。折扣优惠的完成率最高和最低(<strong class="kz hj">图4 </strong>)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ol"><img src="../Images/219449404195013be9a855dafaa6dd26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j55bPayrWHHHIrJLUI_pJA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图4 </strong>:全部10个offers的完成率。请注意，收到的报价数量在10个报价中各不相同，因为第3组报价已被忽略。</figcaption></figure><p id="77d8" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">在预测客户是否会完成报价时，<code class="du mk ml mm mn b">reward</code>似乎不是像<code class="du mk ml mm mn b">difficulty</code>或<code class="du mk ml mm mn b">duration</code>那样重要的因素。</p><p id="e695" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">您可能还注意到，前2个折扣优惠在<code class="du mk ml mm mn b">duration</code>中的天数与在<code class="du mk ml mm mn b">difficulty</code>中的金额相同，而后2个折扣优惠的天数较少。你可能会说，给客户1天的时间来完成折扣优惠是公平的。</p><h2 id="5e82" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated"><strong class="ak"> 3。探索用户</strong></h2><blockquote class="nv"><p id="8788" class="nw nx hi bd ny nz oa ob oc od oe lp dx translated">A.已完成和未完成优惠的用户统计数据</p></blockquote><figure class="on oo op oq or jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es om"><img src="../Images/cc6d296461f98450f29989874409e44d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ey6oa4yqJu2K2HWfHHmNuA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图5 </strong>:已完成优惠(第3组和第4组)的用户统计数据为绿色，未完成优惠(第1组和第2组)的用户统计数据为红色。</figcaption></figure><p id="6daa" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">这里有一些不同之处(<strong class="kz hj">图5 </strong>):</p><ul class=""><li id="a4ac" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp mj mb mc md bi translated">不完整报价的男性顾客是女性顾客的两倍，而完整报价的男性顾客与女性顾客几乎相等。女性顾客更有可能完成报价吗？</li><li id="f5da" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated">40岁以下的<code class="du mk ml mm mn b">age</code>用户中，不完全优惠的用户比完全优惠的用户多。年轻客户完成报价的可能性低吗？</li><li id="b030" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated">在不完全优惠的情况下，低收入者的数量更多，高收入者的数量更少，这是有道理的，因为<code class="du mk ml mm mn b">income</code>与支出正相关。</li><li id="9bff" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated">对于完整的报价，从2017年到2018年，注册人数急剧下降，但不完整报价的情况并非如此。这可能是因为2018年的用户是该应用的新用户，所以他们不太倾向于在不熟悉的领域花钱。</li></ul><blockquote class="nv"><p id="1a95" class="nw nx hi bd ny nz os ot ou ov ow lp dx translated">B.用户消费模式</p></blockquote><p id="c23b" class="pw-post-body-paragraph kx ky hi kz b la of ij lc ld og im lf kn oh lh li kq oi lk ll kt oj ln lo lp hb bi translated"><code class="du mk ml mm mn b">Age</code>和<code class="du mk ml mm mn b">income</code>都被分组为5个分位数，以显示它们与消费习惯的关系。分位数1最低，5最高。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ol"><img src="../Images/3c846fbe6d256751274bbedb285c0a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7439YuIxFPWFTHGPcYXDw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图6 </strong>:左侧为按年龄划分的消费总额，右侧为按收入划分的消费总额。两者都显示了性别之间的差异。组1是底部分位数，组5是顶部分位数。</figcaption></figure><p id="b706" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">支出随着<code class="du mk ml mm mn b">income</code>的增加而增加，但有趣的是，支出只增加到<code class="du mk ml mm mn b">age</code>第3组(大约50岁)，然后与第4组和第5组保持不变(<strong class="kz hj">图6 </strong>)。</p><p id="d8b2" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">另一件事是，在每个年龄组和五分之四的收入组中，女性顾客比男性顾客花费更多的钱。这可能解释了为什么我们看到完成报价的女性用户比例高于未完成报价的女性用户比例(<strong class="kz hj">图5 </strong>)。</p></div><div class="ab cl mv mw gp mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hb hc hd he hf"><h1 id="1301" class="jo jp hi bd jq jr nc jt ju jv nd jx jy io ne ip ka ir nf is kc iu ng iv ke kf bi translated">三。客户细分</h1><p id="5c4b" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">现在，我们将尝试使用两种不同的方法对客户进行细分，以帮助我们更好地了解客户对优惠的反应。</p><h2 id="565f" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">1.分位数分析-频率、货币价值、保有权(FMT)</h2><p id="014e" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">这是对流行的RFM ( <code class="du mk ml mm mn b">recency</code>、<code class="du mk ml mm mn b">frequency</code>、<code class="du mk ml mm mn b">monetary</code>值)的一种分析。但是因为我们只查看1个月的数据，<code class="du mk ml mm mn b">recency</code>没有用，所以我们将查看<code class="du mk ml mm mn b">tenure</code>。对于每个客户，我们将计算:</p><p id="d0d7" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">- <code class="du mk ml mm mn b">Frequency</code> —用户进行交易的频率<br/> - <code class="du mk ml mm mn b">Monetary</code>值——用户花了多少钱<br/> - <code class="du mk ml mm mn b">Tenure</code> —用户使用该应用的时间</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ox oy l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="ak">片段1 </strong>:使用`<code class="du mk ml mm mn b"><strong class="ak">transcript</strong></code> <strong class="ak"> ` </strong>和`<code class="du mk ml mm mn b"><strong class="ak">profile</strong></code> <strong class="ak"> ` </strong>集合创建FMT片段的代码。</figcaption></figure><p id="1ee8" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated"><code class="du mk ml mm mn b">Frequency</code>被分组为6个分位数，<code class="du mk ml mm mn b">monetary</code>值8个分位数，<code class="du mk ml mm mn b">tenure</code> 3个分位数(<strong class="kz hj">片段1 </strong>)。这类似于任意分配特征权重，但其思想是<code class="du mk ml mm mn b">monetary</code>值是最重要的，其次是<code class="du mk ml mm mn b">frequency</code>和<code class="du mk ml mm mn b">tenure</code>。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oz"><img src="../Images/d4764c7019b39d6495b17307c1ac7740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AVRp9aIJGtc6-eGqpiZMSw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图7</strong>:FMT细分的客户层级。</figcaption></figure><p id="bbcb" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">这3个特征都有一个分位数“分数”，将所有3个特征相加将得到客户的总分。然后，根据总得分将客户分为三类(<strong class="kz hj">图7 </strong>):</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es pa"><img src="../Images/2c3d88d5ecca8e65b32a68d23a129573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ro5LN-kzGsRZHgC_kOrNDg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图8 </strong>:按客户层级划分的每个报价的完成率。</figcaption></figure><p id="5cfc" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">1.<code class="du mk ml mm mn b">Bronze</code>等级—总分在3和7之间<br/> 2。<code class="du mk ml mm mn b">Silver</code> tier —总分在8和12之间<br/> 3。<code class="du mk ml mm mn b">Gold</code>等级—总分在13和17之间</p><p id="be3f" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">不出所料，<code class="du mk ml mm mn b">bronze</code>客户完成的报价不多，<code class="du mk ml mm mn b">gold</code>客户完成的报价最多(<strong class="kz hj">图8 </strong>)。即使是最简单的优惠(折扣优惠3和4) <code class="du mk ml mm mn b">bronze</code> tier的完成率低于40%,而<code class="du mk ml mm mn b">gold</code> tier的完成率高达97%!</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ol"><img src="../Images/ddad1f496ac35b06f6cc68b5a5d7f351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*awGfyaAY14jTywxSHklHHQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图9 </strong>:每个客户层的用户统计数据。</figcaption></figure><p id="d047" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">从<code class="du mk ml mm mn b">bronze</code>到<code class="du mk ml mm mn b">silver</code>再到<code class="du mk ml mm mn b">gold</code>，我们可以看到女性用户的比例增加，40岁以下的用户数量减少，低收入者减少，高收入者增加。</p><h2 id="2f27" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">2.k均值聚类</h2><p id="25c5" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">在本节中，我们将使用用户的<code class="du mk ml mm mn b">gender</code>、<code class="du mk ml mm mn b">age</code>、<code class="du mk ml mm mn b">income</code>、<code class="du mk ml mm mn b">frequency</code>、<code class="du mk ml mm mn b">monetary</code>值和<code class="du mk ml mm mn b">tenure</code>使用k均值聚类对客户进行细分。以前的方法只考虑了应用程序上的用户行为，但现在我们将人口统计学融入其中。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ox oy l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="ak">片段2 </strong>:使用之前创建的FMT数据创建集群段的代码。</figcaption></figure><p id="dd53" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">我把<code class="du mk ml mm mn b">gender</code>简化成一个二元特征，表示用户是否是<code class="du mk ml mm mn b">male</code>。换句话说，女性和其他性别的用户被分组在一起，因为<code class="du mk ml mm mn b">male</code>是数据中的大多数性别。</p><p id="e527" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">由于这在技术上仍然是一个分类特征，我们将使用PCA(主成分分析)来创建连续成分，以捕捉数据中的方差。这确实使分析更难解释，但我们可以通过查看特征系数来了解每个组件是如何构建的(<strong class="kz hj">图10A </strong>)。</p><div class="iy iz ja jb fd ab cb"><figure class="nh jc pb nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/2e796ab4d460bd11808da8c04a28319a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*bOEaW1cbms9I7vvjv4hMbA.png"/></div></figure><figure class="nh jc pc nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/ce2d8f14869fd79741e2d7ef4a13680b.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*0C5g3DJyKE583OvZFOYn6g.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx pd di pe nq translated"><strong class="bd jq">图10</strong>:(<strong class="bd jq">A</strong>)5个PCA组件的特征加载见左侧。(<strong class="bd jq"> B </strong>)右图显示了与前2个PCA成分相关的4个聚类的分离。</figcaption></figure></div><p id="c6b3" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">虽然降维不是我的本意，但我只创建了5个组件，这仍然解释了6个原始特征中几乎95%的变化。这些组件随后被用于创建4个集群(<strong class="kz hj">图10B </strong>)。如前所述，主成分分析确实使解释聚类变得更加复杂，所以让我们检查每个聚类的6个原始特征。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es pf"><img src="../Images/92968b451c60d8acdd534592bcd47ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0w_GGEWAqpmaTDW4VQ-tcQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图11 </strong>:蛇图参考实际平均值聚类汇总。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es pg"><img src="../Images/852c40e1edce7494817bc3e79ae0da51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7UehkYL5pN8ekYJwGkytOg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图12 </strong>:蛇形图显示了每个聚类的人口统计学和FMT特征的标准化平均值。</figcaption></figure><p id="1485" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">平均值(<strong class="kz hj">图11 </strong>)可能不能代表整个集群，但我们可以用它来给出每个集群的一般描述:</p><ul class=""><li id="a934" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp mj mb mc md bi translated"><code class="du mk ml mm mn b"><strong class="kz hj">Cluster 1</strong></code>客户完全是<code class="du mk ml mm mn b">male</code>，低于平均水平<code class="du mk ml mm mn b">age</code>和<code class="du mk ml mm mn b">income</code>。他们是最新的用户，花钱最少。</li><li id="21f6" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated"><code class="du mk ml mm mn b"><strong class="kz hj">Cluster 2</strong></code>顾客几乎都是女性，也有少数其他性别的(无<code class="du mk ml mm mn b">male</code>)。他们的<code class="du mk ml mm mn b">age</code>和<code class="du mk ml mm mn b">income</code>都高于平均水平，但他们的花费也相对较少。</li><li id="716f" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated"><code class="du mk ml mm mn b"><strong class="kz hj">Cluster 3</strong></code>客户在很大程度上是最年轻的群体，但使用该应用程序的时间最长。这就是有趣的地方。他们有最低的<code class="du mk ml mm mn b">income</code>，然而最高的支出<code class="du mk ml mm mn b">frequency</code>和平均支出<code class="du mk ml mm mn b">amount</code>，这意味着他们可能经常购买小额商品。</li><li id="ff1d" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated"><code class="du mk ml mm mn b"><strong class="kz hj">Cluster 4</strong></code>顾客是最大的支出者，差距很大(在<code class="du mk ml mm mn b">amount</code>，而不是<code class="du mk ml mm mn b">frequency</code>)。这个细分市场的女性顾客比<code class="du mk ml mm mn b">male</code>多。他们的<code class="du mk ml mm mn b">age</code>和<code class="du mk ml mm mn b">income</code>都远高于平均水平。</li></ul><p id="49e4" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">让我们来看看每个集群是如何响应报价的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ph"><img src="../Images/dca04392cf43eb3b15c594d30a4539f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQE5wm16srSI1f9dTR7ARQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图13 </strong>:集群每次报价完成率。对于大多数产品，完成率随着我们按顺序浏览集群而增加。</figcaption></figure><p id="f8c5" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">因为聚类是按照平均支出的升序排列的，所以我们可以推断，客户的支出习惯是我们预测目标中最重要的因素之一。</p><h2 id="23c0" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated"><strong class="ak"> 3。建议</strong></h2><p id="4986" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">由于来自两种细分方法的细分市场共享相似的要约-完成概况，因此可以为每一对相似的细分市场提供建议:</p><p id="27b0" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">- <code class="du mk ml mm mn b">Bronze</code>层和集群1 <br/> - <code class="du mk ml mm mn b">Silver</code>层和集群2/3 <br/> - <code class="du mk ml mm mn b">Gold</code>层和集群4</p><blockquote class="mp mq mr"><p id="9675" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">由于用户不会花很多钱，他们不太可能对报价做出回应，所以停止向他们发送报价或者只向他们发送容易完成的报价将是一个好主意。</p><p id="a521" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">用户确实比<code class="du mk ml mm mn b">bronze</code>用户花费更多，所以向他们发送优惠信息是值得的。他们完成了折扣优惠3和4的很大一部分，因此专注于较容易的优惠或降低较难的优惠的难度可能会增加他们完成优惠的比率。</p><p id="93f5" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated"><code class="du mk ml mm mn b">Gold</code>用户的要约完成率一直很高，因此增加向这些用户发送要约的难度实际上对星巴克有利。由于他们极有可能对报价做出回应，因此更高的难度可能会增加这些客户的消费金额。</p></blockquote><p id="5b60" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">同样，这些建议是针对FMT层细分市场的，但同样适用于其集群对应部分。</p></div><div class="ab cl mv mw gp mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hb hc hd he hf"><h1 id="b7e5" class="jo jp hi bd jq jr nc jt ju jv nd jx jy io ne ip ka ir nf is kc iu ng iv ke kf bi translated">四。预测建模</h1><p id="0761" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">现在，我们将构建一个分类器来预测用户是否会对要约做出回应。这个分类器将帮助我们决定是否应该给用户发送一个特定的报价。</p><p id="225f" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">该分类器的输入包括要约的元数据和用户的人口统计和行为特征。它将产生一个二进制输出，预测用户是否会完成要约。</p><h2 id="118f" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">1.预处理</h2><p id="4e9d" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">在创建任何模型之前，还有一点预处理要做。我们首先提取将进入模型的数据:从<code class="du mk ml mm mn b"><strong class="kz hj">transcript</strong></code>集合中收到的66，501个报价。</p><p id="9921" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">接下来，我们使用一键编码将分类特征<code class="du mk ml mm mn b">offer_type</code>扩展成3个二进制数字特征— <code class="du mk ml mm mn b">info_offer</code>、<code class="du mk ml mm mn b">disc_offer</code>和<code class="du mk ml mm mn b">bogo_offer</code>。然后，我们按照定义创建二进制目标标签:<code class="du mk ml mm mn b">1</code>如果报价被查看并完成，否则为<code class="du mk ml mm mn b">0</code>。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es pi"><img src="../Images/3278b1cbe50c6121871b27e7f9368986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-4lJ4bJfZq_SizXtVqhcQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图14 </strong>:特征间的皮尔逊相关性。</figcaption></figure><p id="ba6c" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">我们最终的特征集中有15个特征:<code class="du mk ml mm mn b">reward</code>、<code class="du mk ml mm mn b">difficulty</code>、<code class="du mk ml mm mn b">duration</code>、<code class="du mk ml mm mn b">mobile</code>、<code class="du mk ml mm mn b">social</code>、<code class="du mk ml mm mn b">web</code>、<code class="du mk ml mm mn b">age</code>、<code class="du mk ml mm mn b">income</code>、<code class="du mk ml mm mn b">frequency</code>、<code class="du mk ml mm mn b">monetary</code>、<code class="du mk ml mm mn b">tenure</code>、<code class="du mk ml mm mn b">info_offer</code>、<code class="du mk ml mm mn b">disc_offer</code>、<code class="du mk ml mm mn b">bogo_offer</code>、<code class="du mk ml mm mn b">male</code></p><p id="ecfe" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">如相关热图所示(<strong class="kz hj">图14 </strong>)，存在高度多重共线性，特征如下:<code class="du mk ml mm mn b">duration</code>、<code class="du mk ml mm mn b">mobile</code>、<code class="du mk ml mm mn b">info_offer</code>、<code class="du mk ml mm mn b">disc_offer</code>、<code class="du mk ml mm mn b">bogo_offer</code>。</p><p id="4805" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">由于线性模型具有非多重共线性的假设，因此在运行逻辑回归时，我们将从特征集中删除这5个。</p><p id="add7" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">最后，我们对训练集、验证集和测试集进行了60–20–20数据分割，并对所有3个集中的特征进行了标准化。现在我们准备开始构建模型了！</p><h2 id="f09e" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">2.建模</h2><p id="dd0e" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">为了给出一个概述，我训练了6种不同的机器学习模型——逻辑回归、k近邻(KNN)、支持向量机(SVM)、决策树、随机森林和LightGBM。</p><p id="90e8" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">前5个模型的超参数使用网格搜索进行调整。由于LightGBM有更多的超参数需要优化，执行网格搜索是不可行的，所以我选择了Optuna，它使用贝叶斯优化来优化超参数。</p><p id="0255" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">机器学习算法和超参数调优过程的细节不在本文的范围之内，但是如果你感兴趣，我会在我的<a class="ae jn" href="https://github.com/tri-bui/starbucks-segmentation" rel="noopener ugc nofollow" target="_blank"> Github资源库</a>的上一个笔记本中详细讨论。</p><blockquote class="nv"><p id="6a86" class="nw nx hi bd ny nz oa ob oc od oe lp dx translated">逻辑回归、k-最近邻和支持向量机</p></blockquote><figure class="on oo op oq or jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es pj"><img src="../Images/b16bbf446dff8f349cb6b77a404ed0c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNGA2vsz4S506NbSzXHifA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图15 </strong>:验证集上逻辑回归的分类报告。</figcaption></figure><p id="6fee" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">逻辑回归将是我们预测性能的基线模型。在网格搜索之后，我们得到了一个逻辑回归模型，它对F1值为0.70的验证集进行了预测(<strong class="kz hj">图15 </strong>)。</p><p id="67f3" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">如果我们检查系数，<code class="du mk ml mm mn b">monetary</code>价值、<code class="du mk ml mm mn b">frequency</code>支出和<code class="du mk ml mm mn b">social</code>媒体(表明要约是否通过社交媒体发送)在逻辑回归中具有最大的预测能力。我们还没有研究渠道在其中如何发挥作用，但也许客户对通过社交媒体发送的报价反应更大。</p><p id="8154" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">基线建立后，让我们看看是否可以用k近邻(KNN)和支持向量机(SVM)做得更好。</p><div class="iy iz ja jb fd ab cb"><figure class="nh jc pk nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/462d3f41fa3af92aabc0d87b697e1be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*0m4CGfg1lI-o3df1gXScyQ.png"/></div></figure><figure class="nh jc pk nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/87f165b39d2e45aeed5a5d5f6810d539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*c0-RCT1JMUR6q87oJQfMGg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx pl di pm nq translated"><strong class="bd jq">图16 </strong> : ( <strong class="bd jq"> A </strong>)左侧为KNN的分类报告。SVM的分类报告在右边。</figcaption></figure></div><p id="9be5" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">KNN和SVM的表现都比逻辑回归要好几个百分点。但是我们可以看到SVM的预测是不平衡的。让我们仔细看看这些预测。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es pn"><img src="../Images/e8a60038b1ac0c1f0275807c7a7341ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bvWC8Cur2zywZ0c1-lgSjQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jq">图17</strong>:SVM对训练集(左)和验证集(右)预测的混淆矩阵。</figcaption></figure><p id="2f99" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">假阳性以大约3比2的比例超过假阴性(<strong class="kz hj">图17 </strong>)。</p><p id="64ab" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">在这种情况下，偏向积极类是可以容忍的，因为(1)这不是一个巨大的差异，以及(2)我们宁愿向不响应的客户发送报价，也不愿错过向响应的客户发送报价。</p><blockquote class="nv"><p id="cdd8" class="nw nx hi bd ny nz oa ob oc od oe lp dx translated">基于树的分类器</p></blockquote><p id="5322" class="pw-post-body-paragraph kx ky hi kz b la of ij lc ld og im lf kn oh lh li kq oi lk ll kt oj ln lo lp hb bi translated">接下来，我们将查看决策树和LightGBM的结果。</p><div class="iy iz ja jb fd ab cb"><figure class="nh jc pk nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/3de6d6624a734bbb77f8c02a8e89415c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*aW_s0dqFTD736CQyRHz1iA.png"/></div></figure><figure class="nh jc pk nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/8b6ce2ec7a30d0d57e9a23f185db04c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*PPaTwt0T-I1fTEBS-PfRbg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx pl di pm nq translated"><strong class="bd jq">图18 </strong> : ( <strong class="bd jq"> A </strong>)左侧为决策树分类报告。(<strong class="bd jq">B</strong>)light bgm的分类报告在右边。</figcaption></figure></div><p id="4be9" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">LightGBM是唯一一个使用Optuna来调整其超参数的，但令人惊讶的是，尽管在超参数调整过程中进行了贝叶斯优化，并且在算法本身中进行了梯度提升优化，但它实际上比决策树做得更差。</p><p id="8b2a" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">不幸的是，无论是决策树还是LightGBM都不能比SVM做得更好。所以让我们来讨论一下有哪些更好的预测。</p><h2 id="0461" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">3.最终分类器</h2><p id="b3fb" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">我们最后的分类器是…随机森林。最终的参数(<strong class="kz hj">片段3 </strong>)是网格搜索大量试错的结果。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ox oy l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="ak">片段3 </strong>:最终随机森林分类器。</figcaption></figure><p id="8e42" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">随机森林分类器对F1值为0.74的验证集和F1值为0.75的测试集进行预测(<strong class="kz hj">图19A </strong>)。</p><div class="iy iz ja jb fd ab cb"><figure class="nh jc po nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/5cbce0997c9bcc13a70a7f26667a19ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*5xR1lP5i91Vd8oml-0v98Q.png"/></div></figure><figure class="nh jc pp nj nk nl nm paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/50901bae6e99297094ef36cd70f262b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*SfLZWo--PXpFJE1qjGWMgA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx pq di pr nq translated"><strong class="bd jq">图19 </strong> : ( <strong class="bd jq"> A </strong>)左边，验证集上的随机森林预测分类报告在上面，测试集在下面。(<strong class="bd jq"> B </strong>)在右边，验证集上随机森林预测的混淆矩阵在左边，测试集在右边。</figcaption></figure></div><p id="e41d" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">兰登森林在预测类别中也有类似的不平衡，如SVM ( <strong class="kz hj">图19B </strong>)，但没有那么明显。如前所述，在这种情况下，稍微偏向积极的一类并不是一件坏事。</p><p id="033e" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">查看特征重要性，我们发现与逻辑回归中相同的前3个特征— <code class="du mk ml mm mn b">monetary</code>、<code class="du mk ml mm mn b">frequency</code>和<code class="du mk ml mm mn b">social</code>。因此，我们可以得出结论，客户的消费习惯和发送要约的渠道是预测客户是否会完成要约的最重要因素。</p><h1 id="1d12" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">动词 （verb的缩写）结论</h1><h2 id="87c8" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated">1.摘要</h2><p id="bdc2" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">在本文中，我们对星巴克的模拟移动应用数据进行了深入分析，以发现客户对不同优惠的反应。</p><p id="3a25" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">我们的目标是(1)根据人口统计和行为对客户进行细分，以及(2)建立一个分类器，预测用户是否会对报价做出反应。我们成功地完成了这两项工作，在此过程中，我们发现了一些关于数据的关键见解:</p><blockquote class="mp mq mr"><p id="d537" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">-通过社交媒体发送的优惠信息得到了客户更好的回应</p><p id="3e78" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">-用户使用该应用的时间越长，他们花钱就越放心</p><p id="d412" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">-女性顾客往往比男性顾客花更多的钱，因为她们属于同一个<code class="du mk ml mm mn b">age</code>组或<code class="du mk ml mm mn b">income</code>组</p><p id="cdf0" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">-年轻客户倾向于频繁进行小额交易</p><p id="c9fb" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">-随着<code class="du mk ml mm mn b">age</code>的增加，两个<code class="du mk ml mm mn b">genders</code>的平均<code class="du mk ml mm mn b">income</code>和平均支出显示出非常相似的模式:增加到大约<code class="du mk ml mm mn b">age</code> 50，然后高年龄组没有变化</p><p id="9cbc" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">-随着<code class="du mk ml mm mn b">income</code>的增加，支出也会增加</p><p id="9f84" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">-顾客消费越多，就越有可能对优惠做出反应</p></blockquote><p id="2805" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">通过细分分析，我们发现通常有3类客户——下层、中层和上层客户，我分别称之为<code class="du mk ml mm mn b">bronze</code>、<code class="du mk ml mm mn b">silver</code>和<code class="du mk ml mm mn b">gold</code>客户。重申我对改进广告定位的建议:</p><blockquote class="mp mq mr"><p id="1341" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">- <code class="du mk ml mm mn b">Bronze</code>用户不太可能对报价做出回应，因此停止向他们发送报价或只向他们发送易于完成的报价将是一个好主意。</p><p id="52df" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">- <code class="du mk ml mm mn b">Silver</code>用户完成了许多较容易的报价，因此关注较容易的报价或降低较难报价的难度可能会改善他们的反应。</p><p id="5522" class="kx ky mo kz b la lq ij lc ld lr im lf ms ls lh li mt lt lk ll mu lu ln lo lp hb bi translated">- <code class="du mk ml mm mn b">Gold</code>用户的要约完成率一直很高，因此增加向这些用户发送要约的难度实际上会让星巴克受益。</p></blockquote><h2 id="4c7e" class="kg jp hi bd jq kh ki kj ju kk kl km jy kn ko kp ka kq kr ks kc kt ku kv ke kw bi translated"><strong class="ak"> 2。扩展项目</strong></h2><p id="9ca2" class="pw-post-body-paragraph kx ky hi kz b la lb ij lc ld le im lf kn lg lh li kq lj lk ll kt lm ln lo lp hb bi translated">虽然这是一个非常深入的分析，但仍有很大的改进空间。如果你想进一步挖掘数据，这里有一些想法:</p><ul class=""><li id="32dd" class="lv lw hi kz b la lq ld lr kn lx kq ly kt lz lp mj mb mc md bi translated">探索渠道—了解不同的渠道如何影响客户对优惠的回应方式，以及在特定渠道做出回应的客户的人口统计数据。</li><li id="b402" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated">分析尝试的报价——有很多情况下，客户在收到报价后查看了报价并进行购买，但最终未能完成报价。这些案例可以让我们更深入地了解如何重新定位或重组优惠。</li><li id="ec29" class="lv lw hi kz b la me ld mf kn mg kq mh kt mi lp mj mb mc md bi translated">训练不同的分类器——XG boost或神经网络可能会给出更好的结果。</li></ul><p id="9ed2" class="pw-post-body-paragraph kx ky hi kz b la lq ij lc ld lr im lf kn ls lh li kq lt lk ll kt lu ln lo lp hb bi translated">你可以在我的<a class="ae jn" href="https://github.com/tri-bui/starbucks-segmentation" rel="noopener ugc nofollow" target="_blank"> Github库</a>找到完整的代码。我希望这是一个有见地的阅读！</p></div></div>    
</body>
</html>