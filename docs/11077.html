<html>
<head>
<title>Balancing The Imbalanced Datasets (SMOTE)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">平衡不平衡的数据集(SMOTE)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/impact-of-smote-on-accuracy-22b49855d08?source=collection_archive---------23-----------------------#2020-11-16">https://medium.com/analytics-vidhya/impact-of-smote-on-accuracy-22b49855d08?source=collection_archive---------23-----------------------#2020-11-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6d41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不平衡数据集在现实世界中很常见。处理这些失衡是一项具有挑战性的任务。例如，在贷款偿还预测中，100个案例中的违约者可能不到20个。当这些数据通过任何模型来预测违约者时，准确性将非常低，因为数据偏向于非违约者。</p><p id="4ccd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了处理这种情况，我们可以使用重采样技术。以下是几种类型的重采样技术:</p><ul class=""><li id="64e4" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">过采样:</strong>少数类值增加以匹配多数类的计数。</li><li id="18ea" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">欠采样:</strong>多数类值减少，以匹配少数类的计数。</li><li id="823e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">过采样和欠采样的组合:</strong>多数类值减少，少数类值同时增加。</li></ul><p id="bc52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述增量或减量还可以使用不同的方式来完成。请浏览<a class="ae jr" href="https://imbalanced-learn.readthedocs.io/en/stable/api.html" rel="noopener ugc nofollow" target="_blank">这篇</a>文档，了解更多关于不同技术的信息。</p><p id="0a53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将尝试使用<strong class="ih hj">kmeansmote</strong>来理解过采样对这个样本数据<a class="ae jr" href="https://www.kaggle.com/zhijinzhai/loandata" rel="noopener ugc nofollow" target="_blank">贷款数据</a>的影响</p><p id="92dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请浏览这个<a class="ae jr" href="https://www.kaggle.com/shivacharanpabba/loandata-analysis-prediction/notebook" rel="noopener ugc nofollow" target="_blank"> kaggle笔记本</a>，我在那里进行了基本的EDA和模型构建。</p><p id="5974" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了贷款状态数据的分布(本例中为类)</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/c00a0e3ec07e20cc90da3ab28046d489.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*gSxxVQXhS24d6hHy5LkGsA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><strong class="bd ke">班级以3:1:1的比例分布</strong></figcaption></figure><p id="dc4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当对给定数据应用逻辑回归和决策树时，F1值分别为<strong class="ih hj"> 0.26 </strong>和<strong class="ih hj"> 0.28 </strong>。让我们尝试应用抽样方法来克服这个问题。</p><p id="5287" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要执行过采样技术，需要安装以下库。</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="df73" class="kk kl hi kg b fi km kn l ko kp">pip install imbalanced-learn==0.6.2</span></pre><p id="ff74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这个库中，我们可以导入KMeansSmote，如下所示:</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="0b7b" class="kk kl hi kg b fi km kn l ko kp">from imblearn.over_sampling import KMeansSMOTE</span></pre><p id="a707" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以应用KMeansSmote，如下所示:</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="8766" class="kk kl hi kg b fi km kn l ko kp">#X is the entire dataset except the class(i.e. loan_status)<br/>#y is the class column (loan_status)<br/>X = df_model.drop([‘loan_status’],axis=1)<br/>y = df_model[‘loan_status’]</span><span id="43d3" class="kk kl hi kg b fi kq kn l ko kp">smote = KMeansSMOTE(sampling_strategy='auto')</span><span id="ce9f" class="kk kl hi kg b fi kq kn l ko kp">#X_sm and y_sm is the resampled data<br/>X_sm, y_sm = smote.fit_sample(X, y)</span></pre><p id="fe45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当逻辑回归和决策树应用于重采样数据时，F1得分分别增加到<strong class="ih hj"> 0.72 </strong>和<strong class="ih hj"> 0.74 </strong>。</p><p id="0335" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这可能有助于您对过采样技术的影响有一个基本的了解。我们仍然可以通过超参数调整来提高精度。</p><p id="b945" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请在这里找到笔记本做参考— <a class="ae jr" href="https://www.kaggle.com/shivacharanpabba/loandata-analysis-prediction/notebook" rel="noopener ugc nofollow" target="_blank"> kaggle笔记本</a></p><p id="3308" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">欢迎在下面评论。</p><p id="b713" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢:)</p></div></div>    
</body>
</html>