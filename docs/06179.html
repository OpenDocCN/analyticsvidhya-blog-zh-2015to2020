<html>
<head>
<title>Unit Testing in Python for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的Python单元测试</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/unit-testing-with-python-101-e3eb0e7c1170?source=collection_archive---------28-----------------------#2020-05-13">https://medium.com/analytics-vidhya/unit-testing-with-python-101-e3eb0e7c1170?source=collection_archive---------28-----------------------#2020-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/51086728a478f2503e033eb7862ac593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phCIK-_fFISzgvwOArvadw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">戴维·特拉维斯在<a class="ae iu" href="https://unsplash.com/@dtravisphd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4134" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在大多数组织中，数据科学团队和软件工程团队之间争论的一个经常性来源是围绕在将代码投入生产之前对其进行适当的测试，因为出于某种原因，大多数数据科学家在从数据中获得洞察力时往往会忽略测试。</p><p id="49f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">毫无疑问，问题是真实的。未经测试的代码可能会加载错误、错误的编码、偏见等。这反过来会导致一系列后果，如结果的高度可变性、生产环境中的崩溃等等。因此，建议每个人都进行适当的测试来简化工作流程。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/b705e855d7049078bd96a003ba62e815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wJig1rhnCZlM0j4h"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="d1b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在软件开发生命周期中，有一个很长的测试技术类型列表，每种技术都用于一个特定的阶段。然而，我将从最基本的类型开始，即单元测试。</p><p id="94b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">单元测试是为代码中提供某些功能(称为单元)的独立部分设计的测试，例如，代码中的一个功能。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="cce9" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">Python中的测试工具</h1><p id="e255" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">Pytest: 一个功能全面、易于使用的测试工具，具有不需要样板代码的策略、出色的可读性，等等。很明显，开始的最佳选择。</p><blockquote class="li lj lk"><p id="c850" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="ix hj">安装:</strong> pip安装-U pytest</p></blockquote><p id="dd34" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="ll">用法举例:</em> </strong></p><p id="8d27" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">考虑一个函数，它在名为factors.py的文件中返回给定数字的因子列表:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/4dfd5af443a1d93ffc9e4cb63c3b3795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*dMQHHBNZ_KR89O8DKq_sjQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">因子. py</figcaption></figure><p id="5b36" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们将在名为<strong class="ix hj"> test_factors.py </strong>的文件中编写一些测试，该文件与名为<strong class="ix hj"> factors.py </strong>的单元代码文件位于同一目录下，以找到一个缺陷:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/9659889082fc609d8d17076b4643afd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*OBNslliIR1ge7XVUAZU7kw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">test _ factors.py</figcaption></figure><p id="3477" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">断言</strong>语句只是检查条件&amp;如果为假则抛出<strong class="ix hj">断言错误</strong>。我使用了<strong class="ix hj"> set () </strong>函数，因为set是一个无序的数据结构，所以factors列表中元素的顺序不会使测试失败。</p><blockquote class="li lj lk"><p id="fd3c" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="ix hj">注意:</strong> pytest的默认配置是以“test_”开始命名测试文件，并且，该文件中的所有测试函数都应该以“test_”开始命名，如上图所示。</p></blockquote><p id="ac9d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们完事了。</p><p id="d03b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要运行测试，在包含单元代码文件和测试脚本的目录中，在命令行中键入<strong class="ix hj"> pytest o </strong>。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/a3f4e586fc395a7703103a56590299e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yFYJXYBxxT5isO0DiTbMnA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">结果</figcaption></figure><blockquote class="li lj lk"><p id="231c" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">这里你会注意到一行:<strong class="ix hj">。F </strong></p><p id="8e78" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">test_factors.py后面的每个<strong class="ix hj">点</strong>表示测试成功&amp;<strong class="ix hj">F</strong>表示测试失败，详细信息如下。在我们的例子中，第二个测试失败了，因为代码被设计成只输出正整数的因子，而我们的第二个测试输入是一个负整数(参见test_factors.py)。</p></blockquote><p id="bd74" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更新代码(factors.py)以处理负数后:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/07ac2a78828f32d146f02ef3ad530b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*4vV0_KFHXz7g1em3Z27GtQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">更新因子. py</figcaption></figure><p id="f19c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在使用<strong class="ix hj"> pytest </strong>命令运行测试时:宾果！</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/2f2e39ce0060343f4049ba94b894a817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mLqUpMCnszNe2_cnCR-LdQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">测试通过</figcaption></figure><p id="b5da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">Unittest:</strong>python中现成的测试库，与JUnit等其他语言中的测试框架有相似之处。一些可用的关键特性，比如测试自动化，可以执行独立的测试，等等。</p><blockquote class="li lj lk"><p id="8034" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="ix hj">安装:</strong>因为是python中的标准库，所以不需要显式安装。</p></blockquote><p id="1f50" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="ll">用法举例:</em> </strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/73d525ce2474c2f7bc73c159289db587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xod29JeXDggWwWASW0NUg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">用单元测试更新了测试因子</figcaption></figure><p id="47d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于使用unittest库的测试，应该使用这个标准样板代码。这里，测试被定义为测试模块的方法，assertEqual()类似于之前pytest中使用的assert()函数。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/519c52b43058a0e017fb31ed47df8128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8Ntofw4OlomFYcC2nY4WQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">单元测试结果</figcaption></figure><blockquote class="li lj lk"><p id="9647" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">要一次运行所有测试，请使用以下命令格式:</p><p id="f0a7" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="ix hj">python-m unittest-v test _ script</strong></p></blockquote><p id="54a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里的<strong class="ix hj"> -v </strong>标签用于详细说明，即提供测试运行的细节。</p><blockquote class="li lj lk"><p id="3d2b" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">若要运行单独的测试，请使用以下命令:</p><p id="86b6" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="ix hj">python-m unittest-v test _ script . test _ class . test _ method</strong></p></blockquote></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="7acd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，这个帖子到此为止。在我即将发布的帖子中，我会涉及一些其他的测试主题。敬请关注。</p></div></div>    
</body>
</html>