<html>
<head>
<title>Interactive Visualization with Plotly and Dash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Plotly和Dash的交互式可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/interactive-visualization-with-plotly-and-dash-f3f840b786fa?source=collection_archive---------5-----------------------#2020-01-22">https://medium.com/analytics-vidhya/interactive-visualization-with-plotly-and-dash-f3f840b786fa?source=collection_archive---------5-----------------------#2020-01-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ff9d1608ffe8977b0b91bc26d4f9ab2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gxGOpg_cdhFLUWS68eNsXQ.png"/></div></div></figure><p id="515e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我使用matplotlib进行可视化的大约3年时间里，大约2个月前，在我同事的建议下，我尝试了plotly和dash。这个库给我留下了深刻的印象，我已经在我的YouTube频道“当数学遇到编码”上发布了关于这些库的教程。今天我将分享我在这些库上的经验，这可能会激励其他人去尝试Plotly和Dash。</p><h1 id="00af" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">查看Plotly和Dash的完整视频教程</h1><figure class="km kn ko kp fd ij"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="44e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当谈到交互性时，Plotly比matplotlib有明显的优势，原因很简单，它是用plotly.js编写的，而plot ly . js是用d3.js构建的，编辑或修改情节就像编写CSS代码一样简单。Plotly with Dash是一个完整的python可视化封装解决方案。在plotly和dash的帮助下，您可以使用python中的单页脚本开发一个完整的可视化应用程序。</p><p id="4287" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Dash是另一个内置flask应用程序的开源库，允许您在提供的网址或IP上托管您的地块。</p><p id="1f82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有的代码和文章都可以在GitHub上找到。在对这样的库有了基本的了解之后，它的最佳实践是在底层库的帮助下解决一些问题。在本文中，我将尝试给出plotly和dash组件的基本介绍，然后尝试制作一个简单的仪表板。</p><p id="2e39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的想法是创建一个具有交互式下拉菜单与以下步骤的仪表板</p><ol class=""><li id="ad39" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated">用numpy和熊猫创建一个随机数据生成器</li><li id="9c5e" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">创建带有下拉菜单的仪表板布局</li><li id="39df" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">在随机数据集中创建一个类别列，内置三个类别“好”、“坏”和“最差”，现在将这些类别放在下拉列表中</li><li id="4697" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">用户从下拉列表中选择任何类别后，在数据框中应用该类别的过滤器，并在仪表板中绘制过滤后的数据</li></ol><h1 id="49a4" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">让我们通过编码来理解这些组件</h1><p id="8996" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">安装依赖项</p><pre class="km kn ko kp fd ll lm ln lo aw lp bi"><span id="0fff" class="lq jp hi lm b fi lr ls l lt lu">pip install plotly<br/>pip install dash</span></pre><p id="ef97" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导入所有必需的库</p><pre class="km kn ko kp fd ll lm ln lo aw lp bi"><span id="f7b3" class="lq jp hi lm b fi lr ls l lt lu"><strong class="lm hj">import</strong> <strong class="lm hj">plotly</strong>  <br/><strong class="lm hj">import</strong> <strong class="lm hj">dash</strong> <br/><strong class="lm hj">import</strong> <strong class="lm hj">plotly.offline</strong> <strong class="lm hj">as</strong> <strong class="lm hj">pyo</strong> <br/><strong class="lm hj">import</strong> <strong class="lm hj">plotly.graph_objs</strong> <strong class="lm hj">as</strong> <strong class="lm hj">go</strong> <br/><strong class="lm hj">import</strong> <strong class="lm hj">numpy</strong> <strong class="lm hj">as</strong> <strong class="lm hj">np</strong> <br/><strong class="lm hj">import</strong> <strong class="lm hj">dash_html_components</strong> <strong class="lm hj">as</strong> <strong class="lm hj">html</strong> <br/><strong class="lm hj">import</strong> <strong class="lm hj">dash_core_components</strong> <strong class="lm hj">as</strong> <strong class="lm hj">dcc</strong> <br/><strong class="lm hj">from</strong> <strong class="lm hj">dash.dependencies</strong> <strong class="lm hj">import</strong> State, Input, Output <br/><strong class="lm hj">import</strong> <strong class="lm hj">pandas</strong> <strong class="lm hj">as</strong> <strong class="lm hj">pd</strong></span></pre><h1 id="f059" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">随机数据生成函数</h1><p id="5504" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">编写一个随机数据帧生成函数，其数据用于创建仪表板</p><pre class="km kn ko kp fd ll lm ln lo aw lp bi"><span id="f3d2" class="lq jp hi lm b fi lr ls l lt lu"><strong class="lm hj">global</strong> cat_g ,sample_type<br/>cat_g = ["good","bad","worst"] <br/><br/><strong class="lm hj">def</strong> datagen():<br/>    my_sample_data = np.random.random_sample([100,3])<br/>    sample_Cat = [cat_g[np.random.randint(0,3)] <strong class="lm hj">for</strong> i <strong class="lm hj">in</strong> range(100)]<br/>    Base_Data = pd.DataFrame(my_sample_data,columns=["val_1","val_2","val_3"])<br/>    Base_Data["sample_Cat"] = sample_Cat<br/>    <strong class="lm hj">return</strong>(Base_Data)</span></pre><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/38f08cd68c8b1b89ed8a19ace3f15e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*i6Ch-BWXLs1y5ECfc_NiUg.png"/></div><figcaption class="lw lx et er es ly lz bd b be z dx translated"><strong class="bd jq">函数</strong>生成的数据帧</figcaption></figure><p id="0dec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">我们的目标是开发一个类似这样的仪表板</strong></p><figure class="km kn ko kp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/ce53c06850b8d1bb23d199ca8f2035a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xxty5TWaWihPjCWJ4G1icA.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">dash托管的最终脚本结果仪表板</figcaption></figure><p id="20c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">仪表板核心部件</strong></p><p id="6a59" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Dash核心组件有d <a class="ae mb" href="https://dash.plot.ly/dash-core-components/dropdown" rel="noopener ugc nofollow" target="_blank">下拉</a>、<a class="ae mb" href="https://dash.plot.ly/dash-core-components/slider" rel="noopener ugc nofollow" target="_blank">滑块</a>、<a class="ae mb" href="https://dash.plot.ly/dash-core-components/rangeslider" rel="noopener ugc nofollow" target="_blank">范围滑块</a>等，你可以把所有这些组件和小脚本放在一起</p><div class="mc md ez fb me mf"><a href="https://dash.plot.ly/dash-core-components" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">概观</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">Dash核心组件库包含一组高级组件，如滑块、图表、下拉列表、表格和…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">dash.plot.ly</p></div></div></div></a></div><p id="080a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">数值和标签</strong></p><p id="4ffd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您需要创建值和标签字典来使用dash核心组件，标签将出现在用户界面上，值将被转发给用户与仪表板交互的函数。这可以如下完成。</p><pre class="km kn ko kp fd ll lm ln lo aw lp bi"><span id="8fdb" class="lq jp hi lm b fi lr ls l lt lu">cat_g = ["good","bad","worst"]</span><span id="6c73" class="lq jp hi lm b fi mo ls l lt lu">## Creating values and labels for drop-down<br/>options_list = []<br/>for i in cat_g:<br/>    options_list.append({'label': i, 'value': i})</span></pre><p id="1b9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里,“好的”、“坏的”和“最差的”将显示在仪表板上，并传递给图形生成函数。</p><p id="5ec5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">图生成器功能</strong></p><p id="64c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你需要写一个函数，它将根据给定的过滤数据生成图形，这里是它的示例代码</p><pre class="km kn ko kp fd ll lm ln lo aw lp bi"><span id="1cd5" class="lq jp hi lm b fi lr ls l lt lu">def fig_generator(sample_data):<br/>    sample_data = sample_data.reset_index(drop=True)<br/>    sample_data.head()<br/>    plot_data =[]</span><span id="f95c" class="lq jp hi lm b fi mo ls l lt lu">for i in range(1,4):<br/>        plot_data.append(go.Scatter(x=sample_data.index, y=sample_data['val_'+ str(i)], name = 'val_'+ str(i) ))<br/>    plot_layout = go.Layout(title = " This plot is generated using plotly  ")</span><span id="cc8f" class="lq jp hi lm b fi mo ls l lt lu">fig = go.Figure( data = plot_data ,layout = plot_layout)</span><span id="5b9f" class="lq jp hi lm b fi mo ls l lt lu">return(fig.data,fig.layout)</span></pre><p id="6357" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">破折号Html组件</strong></p><p id="dabd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了创建一个基于网络的应用程序，你需要html组件。Dash提供了这些html组件，如Div标签头。关于Dash Html组件的更多信息，请查看下面的链接</p><div class="mc md ez fb me mf"><a href="https://dash.plot.ly/dash-html-components" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">概观</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">Dash提供了所有可用的HTML标签作为用户友好的Python类。本章解释了这是如何工作的，并…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">dash.plot.ly</p></div></div></div></a></div><p id="5919" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">定义仪表板布局</strong></p><p id="2fb4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您需要为dash定义一个布局，在这个布局中，您可以为css组件提供样式，不要忘记为所有html组件提供id。Id是这些占位符的引用，要更改占位符中的任何内容，您需要创建一个回调函数，然后给出引用id。</p><figure class="km kn ko kp fd ij"><div class="bz dy l di"><div class="mp kr l"/></div></figure><p id="ba72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">仪表板中的回调函数</strong></p><p id="064c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于基于下拉列表中用户输入的任何更改，您需要创建一个回调函数所有输入和输出组件的id，您需要提供回调函数的参数，这里是我们代码中使用的回调函数。</p><pre class="km kn ko kp fd ll lm ln lo aw lp bi"><span id="87dc" class="lq jp hi lm b fi lr ls l lt lu"><a class="ae mb" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(Output("plot_area", 'figure'),<br/>              [Input("drop_down_1", "value")])<br/>def updateplot(input_cat):<br/>    df= datagen()<br/>    sample_data = df[df["sample_Cat"] == input_cat ]<br/>    trace,layout = fig_generator(sample_data)<br/>    return {<br/>        'data': trace,<br/>        'layout':layout<br/>    }<br/>if __name__=='__main__':<br/>    app.run_server()</span></pre><p id="10a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">完成脚本</strong></p><p id="26e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是完整的脚本，可以用来在python中生成这样的仪表板。</p><figure class="km kn ko kp fd ij"><div class="bz dy l di"><div class="mp kr l"/></div></figure></div></div>    
</body>
</html>