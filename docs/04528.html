<html>
<head>
<title>Pickling and Unpickling in python Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">python中的酸洗和反酸洗解释</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pickling-and-unpickling-in-python-explained-be546e604aae?source=collection_archive---------4-----------------------#2020-03-23">https://medium.com/analytics-vidhya/pickling-and-unpickling-in-python-explained-be546e604aae?source=collection_archive---------4-----------------------#2020-03-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5749be8dc9db4f357682eca64e9e7c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_MO-0EKkLiMlEPbGrqUyog.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@maxcodes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">麦克斯韦·纳尔逊</a>在<a class="ae iu" href="https://unsplash.com/s/photos/python?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="e7e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Pickling允许您序列化和反序列化Python对象结构。简而言之，Pickling是一种将python对象转换成字符流的方法，这样这个字符流就包含了在另一个python脚本中重建对象所需的所有信息。</p><p id="3748" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了成功地重建对象，标记的字节流包含给拆包器的指令，以重建原始对象结构以及指令操作数，这有助于填充对象结构。</p><h1 id="ea69" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Pickle协议:</h1><p id="555a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">目前有6种不同的方案可用于酸洗。使用的协议越高，读取产生的Pickle所需的Python版本就越新。了解更多关于<a class="ae iu" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank"> Pickle协议</a>的信息。</p><p id="aaca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">泡菜主要有两种方法。第一个是<code class="du kw kx ky kz b">dump</code>，它将一个对象转储到一个文件对象，第二个是<code class="du kw kx ky kz b">load</code>，它从一个文件对象加载一个对象。</p><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="fe2b" class="li ju hi kz b fi lj lk l ll lm">pickle.dump(object, file_obj, protocol)</span></pre><p id="8d8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个函数有三个参数-</p><ol class=""><li id="9431" class="ln lo hi ix b iy iz jc jd jg lp jk lq jo lr js ls lt lu lv bi translated">要序列化的Python对象。</li><li id="67c2" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated">必须在其中存储序列化python对象的文件对象。</li><li id="0430" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated">协议(如果未指定协议，则使用协议0。如果协议被指定为负值或<code class="du kw kx ky kz b">HIGHEST_PROTOCOL</code>，将使用可用的最高协议版本。)</li></ol><p id="e3fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以让我们继续就事论事:</p><ul class=""><li id="1fb3" class="ln lo hi ix b iy iz jc jd jg lp jk lq jo lr js mb lt lu lv bi translated">首先，我们必须通过以下命令导入它:</li></ul><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="fe67" class="li ju hi kz b fi lj lk l ll lm">import pickle</span></pre><p id="b44e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是酸洗和拆线的例子-</p><h1 id="5501" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">酸洗</h1><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="3537" class="li ju hi kz b fi lj lk l ll lm">import pickle</span><span id="27a5" class="li ju hi kz b fi mc lk l ll lm">def pickle_data():<br/>    data = {<br/>                'name': 'Prashant',<br/>                'profession': 'Software Engineer',<br/>                'country': 'India'<br/>        }<br/>    filename = 'PersonalInfo'<br/>    outfile = open(filename, 'wb')<br/>    pickle.dump(data,outfile)<br/>    outfile.close()</span><span id="1003" class="li ju hi kz b fi mc lk l ll lm">pickle_data()</span></pre><p id="4377" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用<code class="du kw kx ky kz b">open</code>函数打开文件，第一个参数应该是你的文件名，第二个参数是<code class="du kw kx ky kz b">wb</code>，<code class="du kw kx ky kz b">wb</code>是指以二进制方式编写。这意味着数据将以字节对象的形式写入。</p><h1 id="fa9c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">拆线</h1><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="8787" class="li ju hi kz b fi lj lk l ll lm">import pickle</span><span id="7e75" class="li ju hi kz b fi mc lk l ll lm">def unpickling_data():<br/>    file = open(filename,'rb')<br/>    new_data = pickle.load(file)<br/>    file.close()<br/>    return new_data<br/></span><span id="bf1a" class="li ju hi kz b fi mc lk l ll lm">print(unpickling_data())</span></pre><p id="76ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里<code class="du kw kx ky kz b">r</code>代表读取模式，<code class="du kw kx ky kz b">b</code>代表二进制模式。你将会读到一个二进制文件。<br/>拆包功能的输出与我们腌制的相同。</p><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="46c6" class="li ju hi kz b fi lj lk l ll lm">{'name': 'Prashant', 'profession': 'Software Engineer', 'country': 'India'}</span></pre><h1 id="540b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">有什么可以腌制的？</h1><p id="e722" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">可以对以下数据类型进行酸洗:</p><ul class=""><li id="096d" class="ln lo hi ix b iy iz jc jd jg lp jk lq jo lr js mb lt lu lv bi translated">布尔人，</li><li id="1803" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">整数，</li><li id="0cf6" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">浮动，</li><li id="bcf8" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">复数，</li><li id="e376" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">(普通和Unicode)字符串，</li><li id="873f" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">元组，</li><li id="108d" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">列表，</li><li id="5e53" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">包含可拾取对象的集合和字典。</li><li id="2fd7" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">在模块顶层定义的内置函数</li><li id="6b97" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">在模块顶层定义的类</li></ul><h1 id="9db4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">酸洗的常用案例</h1><ol class=""><li id="19a4" class="ln lo hi ix b iy kr jc ks jg md jk me jo mf js ls lt lu lv bi translated">将程序的状态数据保存到磁盘上，这样当重新启动时，它可以从停止的地方继续运行(持久化)</li><li id="67c3" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated">在多核或分布式系统中通过TCP连接发送Python数据(编组)</li><li id="f8b7" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated">将Python对象存储在数据库中</li></ol><h1 id="8def" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">酸洗的危险</h1><p id="1b83" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Pickle模块的文档说明:</p><blockquote class="mg mh mi"><p id="3d34" class="iv iw mj ix b iy iz ja jb jc jd je jf mk jh ji jj ml jl jm jn mm jp jq jr js hb bi translated">Pickle模块无法抵御错误或恶意构建的数据。不要从不受信任或未经验证的来源提取数据。</p></blockquote><h1 id="b5e6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">泡菜的安全实施</h1><ul class=""><li id="2c2a" class="ln lo hi ix b iy kr jc ks jg md jk me jo mf js mb lt lu lv bi translated">泡菜不应该在陌生人之间使用。</li><li id="4714" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">确保交换Pickle的各方具有加密的网络连接。</li><li id="872e" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js mb lt lu lv bi translated">在不安全连接的情况下，Pickle中的任何更改都可以通过使用加密签名来验证。Pickle可以在传输之前进行签名，它的签名可以在加载到接收端之前进行验证。</li></ul><p id="063f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望您现在对python中的酸洗/反酸洗有了一个相当好的理解。</p><p id="f40f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你有什么建议，请在评论中告诉我。</p><h1 id="9484" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><div class="mn mo ez fb mp mq"><a href="https://docs.python.org/3.8/library/pickle.html" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab dw"><div class="ms ab mt cl cj mu"><h2 class="bd hj fi z dy mv ea eb mw ed ef hh bi translated">pickle - Python对象序列化- Python 3.9.1文档</h2><div class="mx l"><h3 class="bd b fi z dy mv ea eb mw ed ef dx translated">编辑描述</h3></div><div class="my l"><p class="bd b fp z dy mv ea eb mw ed ef dx translated">docs.python.org</p></div></div></div></a></div><div class="mn mo ez fb mp mq"><a href="https://stackoverflow.com/questions/7501947/understanding-pickling-in-python" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab dw"><div class="ms ab mt cl cj mu"><h2 class="bd hj fi z dy mv ea eb mw ed ef hh bi translated">理解Python中的Pickling</h2><div class="mx l"><h3 class="bd b fi z dy mv ea eb mw ed ef dx translated">我最近接到一个任务，需要把一个字典(其中每个键都指向一个列表)以腌泡的形式…</h3></div><div class="my l"><p class="bd b fp z dy mv ea eb mw ed ef dx translated">stackoverflow.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne io mq"/></div></div></a></div></div></div>    
</body>
</html>