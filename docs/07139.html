<html>
<head>
<title>Linear Regression in Python with Scikit-Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的线性回归与Scikit-Learn</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-in-python-with-scikit-learn-e1bb8a059cd2?source=collection_archive---------1-----------------------#2020-06-15">https://medium.com/analytics-vidhya/linear-regression-in-python-with-scikit-learn-e1bb8a059cd2?source=collection_archive---------1-----------------------#2020-06-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1d97" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">用线性回归预测房价</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/5fd2fde613e73de06270e261cbcffc8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x_YCnjw2XvYxfXUO"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@xavi_cabrera?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">哈维·卡夫雷拉</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="81ff" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="c79f" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在监督机器学习中，有两种算法:回归算法和分类算法。比如预测房价是回归问题，预测房子能不能卖出去是分类问题。</p><blockquote class="lc ld le"><p id="af46" class="kg kh lf ki b kj lg ij kl km lh im ko li lj kr ks lk ll kv kw lm ln kz la lb hb bi translated">代数中的“线性”一词是指两个或多个变量之间的线性关系。</p></blockquote><p id="7ec7" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">在本文讨论的简单线性回归中，如果在二维空间中画出这种关系，就会得到一条直线。</p><p id="6f92" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">让我们考虑一个场景，我们想要确定房子平方英尺和房子售价之间的线性关系。当我们给定一所房子的平方英尺时，我们能估计能卖多少钱吗？</p><p id="a476" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">我们知道一条回归线的公式基本上是:<strong class="ki hj"> <em class="lf"> y = mx + b </em> </strong></p><p id="ddd1" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">其中<strong class="ki hj"> <em class="lf"> y </em> </strong>为预测目标标号，<strong class="ki hj"> <em class="lf"> m </em> </strong>为直线斜率，<strong class="ki hj"> <em class="lf"> b </em> </strong>为<strong class="ki hj"> <em class="lf"> y </em> </strong>截距。</p><p id="1258" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">如果我们将自变量(平方英尺)标在x轴上，将因变量(销售价格)标在y轴上，线性回归会给出一条最符合数据点的直线，如下图所示。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lo"><img src="../Images/6198a86e03457ac80f19b97c5d66d531.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*a6wu4TSq8Hp1gzx2n5BgLA.png"/></div></figure><h1 id="16c3" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">Python中的线性回归与Scikit-Learn</h1><p id="af74" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在本节中，我们将学习如何使用Python Scikit-Learn库进行机器学习来实现回归函数。我们将从涉及两个变量的简单线性回归开始。在这个回归任务中，我们将根据房子的平方英尺来预测销售价格。这是一个简单的线性回归任务，因为它只涉及两个变量。</p><h1 id="38de" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">密码</h1><ol class=""><li id="3de0" class="lp lq hi ki b kj kk km kn kp lr kt ls kx lt lb lu lv lw lx bi translated"><strong class="ki hj">导入库</strong></li></ol><p id="1f61" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">要为此任务导入必要的库，请执行以下导入语句:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ly"><img src="../Images/f592e10ad64d3583c242eaa501023d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yk3FS3U7gxljzGbtwCfzGg.png"/></div></div></figure><p id="d8ca" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj"> 2。导入数据集</strong></p><p id="f6eb" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">以下命令通过pandas导入CSV数据集:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/e007f6cfdd6b0ef122a7aa0cf285e218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e78Zv8UeZ5B7NqMmpIog-g.png"/></div></div></figure><p id="6747" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj"> 3。了解数据</strong></p><p id="042b" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">现在让我们来探索数据集。执行以下脚本:<code class="du ma mb mc md b">df.shape</code>。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ly"><img src="../Images/0084b1dbbbbbc96b2080cb56e6f0dc32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KmcPCvqS07SjktFdTQ2WOw.png"/></div></div></figure><p id="dab7" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">之后，您应该会看到下面的输出。数据集包含1，460行和2列。让我们看看我们的数据集实际上是什么样子。输入<code class="du ma mb mc md b">df.head()</code>,它将从我们的数据集中检索前5条记录。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/a6941c6fb2b7ca24da9f0efe27bfea8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_okERVeGjRAE9ymDqYs6gA.png"/></div></div></figure><p id="77ed" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">要查看数据集的统计细节，我们可以使用<code class="du ma mb mc md b">df.describe()</code>:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es me"><img src="../Images/859f950f795b3d839f790dd831ab1d7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4jMKpKrQ6c6iHMZf62LUQ.png"/></div></div></figure><p id="620e" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">最后，我们可以在二维图形上绘制数据点，以关注数据集，看看我们是否可以手动找到数据之间的任何关系。我们使用pandas dataframe的<code class="du ma mb mc md b">df.plot()</code>函数，并传递给它x坐标和y坐标的列名，分别是“SquareFeet”和“SalesPrice”。我们可以使用下面的脚本来创建图形:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/03a8657743299e93590b7eb9d7ed7dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gTk4-psYNHU-NtQ2bkffQ.png"/></div></div></figure><p id="dcb5" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">从上面的图表中，我们可以清楚地看到，房子的平方英尺和房子的销售价格之间存在着正的线性关系。</p><p id="90ee" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj"> 4。准备数据</strong></p><p id="40b7" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">现在我们对数据统计的细节有了想法。下一步是将数据分为“属性”和“目标标签”。属性是自变量，目标标签是因变量，其值是要预测的。在我们的数据集中，我们只有两列。我们想根据房子的平方英尺来预测销售价格。因此，我们的属性集将由“平方英尺”列组成，标签将是“销售价格”列。要提取属性和标签，请执行以下脚本:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ly"><img src="../Images/99bda7e0fa04b562d7a8d668fa4f74f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YkMCAm-2Ffxplh-6xb-wVg.png"/></div></div></figure><p id="d0f6" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">属性存储在X变量中。我们指定“-1”作为列的范围，因为我们希望属性集包含除最后一列“SalesPrice”之外的所有列。类似地，y变量包含标签。我们为label列指定了1，因为“SalesPrice”列的索引是1。请记住，列索引从0开始，1是第二列。</p><p id="efa3" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">既然我们有了自己的属性和标签，下一步就是将这些数据分成训练集和测试集。我们将通过使用Scikit-Learn内置的<code class="du ma mb mc md b">train_test_split()</code>方法来实现这一点:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mg"><img src="../Images/1712ca505fc34cdb170c93db2335c122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfkHxlJmj246TiUn3z5y-g.png"/></div></div></figure><p id="82ae" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">上面的脚本将80%的数据分割成训练集，而将20%的数据分割成测试集。<code class="du ma mb mc md b">test_size</code>变量是我们实际指定测试集比例的地方。</p><p id="0c3c" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj"> 5。建模</strong></p><p id="5f42" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">我们已经将数据分为训练集和测试集，现在终于到了训练模型的时候了。执行以下脚本:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/9e5ad1325735a77b8f6c77999e757c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tmWwQQqlkwD3AIJs2yMeA.png"/></div></div></figure><p id="45b5" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">使用Scikit-Learn实现线性回归模型非常简单，因为您真正需要做的只是导入linear regression类，实例化它，并调用fit()方法以及我们的训练数据。这就像使用机器学习库对数据进行训练一样简单。</p><p id="21ba" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">在理论部分，我们说过线性回归模型基本上可以找到截距和斜率的最佳值，从而得到最符合数据的直线。要查看由线性回归算法为数据集计算的截距和斜率的值，请执行以下脚本来检索截距:。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/7d75e1c4ea99b80b791721956db46416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j-T3UAK9JpWcv-N2h7zbCQ.png"/></div></div></figure><p id="942f" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">您看到的结果值应该大约为:13330.26。然后执行以下脚本来检索斜率(系数x):</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/2b1fb10cf2e2e52413e2dbdaeb702d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITHmXbON6YXDvtxrL3f7eQ.png"/></div></div></figure><p id="3d06" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">结果应该大约是:110.26。</p><p id="c4f8" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">这意味着每单位平方英尺的变化，销售价格的变化约为110.26英镑。</p><p id="b781" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj"> 6。预测</strong></p><p id="9786" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">现在我们已经训练了我们的算法，是时候做一些预测了。为此，我们将使用我们的测试数据，看看我们的算法预测百分比分数的准确性如何。要对测试数据进行预测，请执行以下脚本:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/a41efe66856b796d16caed1e9b99ffcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iCy0ify_A9OeEwwXuamQQA.png"/></div></div></figure><p id="400b" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">y_pred是一个numpy数组，包含X_test系列中输入值的所有预测值。</p><p id="3e1b" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">要将X_test的实际输出值与预测值进行比较，请执行以下脚本，输出如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/1fedfe64cde9960f558638cf51f9cd1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tbilY8VNq6rOUV_8ASMbxg.png"/></div></div></figure><p id="278c" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">虽然我们的模型不是很精确，但是预测值接近实际值。</p><p id="e659" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj"> 7。评估</strong></p><p id="a25e" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">最后一步是评估算法的性能。这一步对于在特定数据集上比较不同算法的性能特别重要。对于回归算法，通常使用三个评估指标:</p><ol class=""><li id="a0cc" class="lp lq hi ki b kj lg km lh kp ml kt mm kx mn lb lu lv lw lx bi translated">平均绝对误差(MAE)是误差绝对值的平均值。</li><li id="bff5" class="lp lq hi ki b kj mo km mp kp mq kt mr kx ms lb lu lv lw lx bi translated">均方误差(MSE)是平方误差的平均值。</li><li id="2a8e" class="lp lq hi ki b kj mo km mp kp mq kt mr kx ms lb lu lv lw lx bi translated">均方根误差(RMSE)是平方误差平均值的平方根</li></ol><p id="7ac0" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">Scikit-Learn库预先构建了可用于为我们找出这些值的函数。让我们使用测试数据找出这些指标的值。执行以下脚本:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/7a7e2c0e82a0b461cc8d434737eec6a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vNdzi2qOE7roKezIfpdaQg.png"/></div></div></figure><p id="14ad" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">您可以看到均方根误差值为62560.28，大于销售价格平均值的10%，即180921.2。这意味着我们的算法只是一般。</p><p id="a851" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">造成这种不准确性的因素有很多，下面列出了其中一些:</p><ol class=""><li id="6890" class="lp lq hi ki b kj lg km lh kp ml kt mm kx mn lb lu lv lw lx bi translated">我们使用的特征可能与我们试图预测的值没有足够高的相关性。</li><li id="158a" class="lp lq hi ki b kj mo km mp kp mq kt mr kx ms lb lu lv lw lx bi translated">我们假设这个数据是线性关系，但事实并非如此。视觉数据可以帮助你确定。</li></ol><h1 id="41d2" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">然后</h1><p id="bced" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">为了改进模型，我们需要使用更多的自变量并尝试差分模型，如SVR、Lasso和ElasticNet。</p></div><div class="ab cl mt mu gp mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hb hc hd he hf"><p id="bf84" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">感谢阅读！如果你喜欢这篇文章，请通过鼓掌来感谢你的支持(👏🏼)按钮，或者通过共享这篇文章让其他人可以找到它。</p><p id="d921" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">最后，我希望你能学会如何使用简单的线性回归技术。你也可以在<a class="ae jn" href="https://github.com/kindersham/100DaysDS/tree/master/Housing%20Prices%20-%20Linear%20Regression" rel="noopener ugc nofollow" target="_blank"> GitHub </a>库上找到完整的项目。</p></div></div>    
</body>
</html>