<html>
<head>
<title>Rasa Advanced Deployment: Part 2(Scaling pods and Cluster requirements)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rasa高级部署:第2部分(扩展单元和集群需求)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/rasa-advanced-deployment-part-2-scaling-pods-and-cluster-requirements-e1bc507aa333?source=collection_archive---------13-----------------------#2020-12-20">https://medium.com/analytics-vidhya/rasa-advanced-deployment-part-2-scaling-pods-and-cluster-requirements-e1bc507aa333?source=collection_archive---------13-----------------------#2020-12-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2b8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在之前的博客中，我们在虚拟机中安装了rasa。我们的应用程序中运行的每个部署只需要一个Pod就可以完成安装。当流量增加时，我们将需要扩展应用程序以满足用户需求。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e63b806fc41d5010d045248d96cc595a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*81ux4-QbP3ZH6DcyKCCSQg.png"/></div></div></figure><h2 id="c237" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">秤豆荚</h2><p id="9350" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated"><strong class="ih hj">扩展</strong>是通过改变部署中副本的数量来实现的。</p><p id="96c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">方法1:</p><p id="5cd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在虚拟机上，发出以下命令来检查我们的部署有多少pod:</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="ea06" class="jp jq hi kq b fi ku kv l kw kx">kubectl -n my-namespace get deployment</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/a94d8a6bce17544b467a439bb5b5b8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DKdLn2KJitOCAr55ca46eQ.png"/></div></div></figure><p id="c1a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们准备了1/1，这意味着我们有1个pod用于该部署。</p><p id="accd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在虚拟机上，发出以下命令来扩展单元:</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="e2db" class="jp jq hi kq b fi ku kv l kw kx">kubectl -n my-namespace scale deployment my-release-rasa-production --replicas=2</span></pre><ul class=""><li id="32c5" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">-n my-namespace:安装rasa的名称空间的名称</li><li id="d486" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">my-release-rasa-production:您要扩展的部署的名称您可以在上面给出的图像中看到该名称。</li><li id="4729" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">— replicas=2:这意味着我们需要2个pod用于my-release-rasa-production部署。</li></ul><p id="919a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们再次检查豆荚是有规模的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/92a491d9b15a5510234fabfe7693caa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rHVSBNfOb3VxD2U5Fa23aQ.png"/></div></div></figure><p id="9b98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在我的发布-rasa-production中看到，现在我们有2个pod准备好了。</p><p id="6e85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要缩小它，请发出以下命令</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="ded9" class="jp jq hi kq b fi ku kv l kw kx">kubectl -n my-namespace scale deployment my-release-rasa-production --replicas=1</span></pre><p id="abb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:</p><p id="dce5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您也可以使用此命令重启任何pod。</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="469f" class="jp jq hi kq b fi ku kv l kw kx">kubectl -n my-namespace scale deployment my-release-rasa-production --replicas=0</span></pre><p id="26e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它将删除该单元，现在您可以再次初始化新单元。</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="e6fe" class="jp jq hi kq b fi ku kv l kw kx">kubectl -n my-namespace scale deployment my-release-rasa-production --replicas=1</span></pre><p id="e89e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它将重启我的释放-拉沙-生产舱。</p><p id="20eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">方法二:掌舵</p><p id="3573" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在“values.yml”中定义replicaCount</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="f035" class="jp jq hi kq b fi ku kv l kw kx"># rasa: Settings common for all Rasa containers<br/>rasa:<br/>    versions:<br/>       # rasaProduction is the container which serves the production environment<br/>       rasaProduction:<br/>           # replicaCount of the Rasa Production container<br/>           replicaCount: 2</span></pre><p id="096b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在在虚拟机上发出这个命令</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="fa8e" class="jp jq hi kq b fi ku kv l kw kx">helm --namespace my-namespace upgrade --values values.yml my-release rasa-x/rasa-x</span></pre><p id="5254" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它的工作方式与命令行方式相同。但是，这里我们可以跟踪values.yml文件中定义的所有值。</p><h2 id="ed53" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">集群要求</h2><p id="2a3f" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们可以在helm图表的values.yml中指定容器需要或允许使用的每种资源的数量，例如，对于rasa生产容器，如果我们需要2vcpu和2GB ram，那么我们可以如下定义它。</p><ul class=""><li id="2e81" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">编辑Values.yml文件</li></ul><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="5a88" class="jp jq hi kq b fi ku kv l kw kx">rasa:<br/> versions:<br/>   rasaProduction:<br/>     # resources which rasaProduction is required / allowed to use<br/>     resources:<br/>       requests:<br/>         cpu: "2000m"<br/>         memory: "2Gi"</span></pre><ul class=""><li id="806e" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">升级安装</li></ul><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="8b14" class="jp jq hi kq b fi ku kv l kw kx">helm --namespace my-namespace  upgrade --values values.yml my-release rasa-x/rasa-x</span></pre><p id="2811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将按照我们在values.yml中描述的那样分配资源。</p><p id="aec7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Rasa聊天机器人的预先部署系列今天就到这里。持续关注这个博客的系列。到那时，快乐的编码！！！</p><p id="2f76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考资料:</p><div class="ln lo ez fb lp lq"><a href="https://rasa.com/docs/rasa-x/" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">Rasa X简介</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">Rasa X是一个对话驱动开发(CDD)的工具，这是一个倾听你的用户并使用他们的过程</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">rasa.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jn lq"/></div></div></a></div><div class="ln lo ez fb lp lq"><a href="https://info.rasa.com/advanced-deployment-workshop" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">Rasa高级部署研讨会</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">通过部署高级认证，开始您的Rasa之旅。这个为期两天的认证…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">info.rasa.com</p></div></div><div class="lz l"><div class="mf l mb mc md lz me jn lq"/></div></div></a></div><p id="334b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章，点击给我买杯咖啡！感谢阅读。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://www.payumoney.com/paybypayumoney/#/147695053B73CAB82672E715A52F9AA5"><div class="er es mg"><img src="../Images/d1500c2f9e74d7f54553250f9445e8fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*RPDyXqHjKKbesbJgLZ96mQ.png"/></div></a></figure><p id="d47f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你的每一个小小的贡献都会鼓励我创造更多这样的内容。</p></div></div>    
</body>
</html>