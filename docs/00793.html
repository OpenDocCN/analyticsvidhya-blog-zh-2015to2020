<html>
<head>
<title>One-stop Guide to Data Manipulation in PySpark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PySpark中数据操作的一站式指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/one-stop-guide-to-data-manipulation-in-pyspark-22b0c4f0d843?source=collection_archive---------2-----------------------#2019-09-07">https://medium.com/analytics-vidhya/one-stop-guide-to-data-manipulation-in-pyspark-22b0c4f0d843?source=collection_archive---------2-----------------------#2019-09-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9af8174fd6f2f2862972f58d7675af92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JOufdOKJR3HpjedYWCyS8Q.png"/></div></div></figure><p id="4c4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Apache Spark是用Scala编程语言编写的。PySpark的发布是为了支持Apache Spark和Python的协作，它实际上是一个用于Spark的Python API。此外，PySpark可以帮助您与Apache Spark和Python编程语言中的弹性分布式数据集(rdd)进行交互(来源:Databricks)</p><p id="9d89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本教程中，您将学习-</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/e20c527936a69ae65a4c653e9d30e4b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jW0Z9SX9TU8txe2BgB7lgA.png"/></div></div></figure><h1 id="477b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第一部分</h1><h2 id="d172" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.1 —计数()</h2><p id="4a8c" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">返回数据集中的行数</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/6fc17817d788c9d2884d7582a4d58cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FVjYgBC-Zcxdc51MGPMMIg.png"/></div></div></figure><h2 id="9bcc" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.2 — printSchema()</h2><p id="b762" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">我们拥有的数据类型</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/1152fe829acc9da10b61ebfa91548891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXRrolkORZrbi9y63UCafg.png"/></div></div></figure><h2 id="f0f4" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.3 —显示(..)</h2><p id="7ece" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">允许我们将数据打印到控制台。</p><p id="98cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">n:打印到控制台的记录数，默认为20。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/a469169c1994f5d85b9dfd2fb43d102e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8TVtaVS3VZoKjy3WzNcajw.png"/></div></div></figure><h2 id="ee89" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.4 —显示(..)</h2><p id="9a12" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">稍微优雅一点的选择</p><ol class=""><li id="70b4" class="ln lo hi is b it iu ix iy jb lp jf lq jj lr jn ls lt lu lv bi translated">显示(..)很丑——显示器(..)挺好看的。</li><li id="54cc" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">显示(..)具有截断列和行的参数—显示(..)没有。</li><li id="ac98" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">显示(..)是DataFrame/Dataset类的函数— display(..)与许多不同的对象一起工作</li></ol><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/87642f9f157b83b7a6a37eb49ab9fdce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e2nEx4CxHZ0eeWv2ETdzDQ.png"/></div></div></figure><h2 id="4c96" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.5 —极限值(..)</h2><p id="facb" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">如果您能回忆起，请展示(..)有一个参数来控制打印多少条记录，但是，显示(..)没有。</p><p id="f78a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以用我们第一个变换limit(..)</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/7877ab2aa2ca967232f5784134e13e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*66GULPZ14QVU1aCEeIvXfg.png"/></div></div></figure><h2 id="190b" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.6 —选择(..)</h2><p id="0a1d" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">通过计算每个元素的给定列表达式，返回新的数据集</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/4bd4225075637d21b60d7d8dfc3563c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFGuLcGMu7kULrenPaR1pg.png"/></div></div></figure><h2 id="3750" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.7 —下降(..)</h2><p id="2064" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">返回删除了一列的新数据集</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/ea0706eef83fb22dec33dded8657d07a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25x8QtHusoyC9zPbHL3CVw.png"/></div></div></figure><h2 id="0558" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">1.8 —独特()</h2><p id="3683" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">返回一个新的数据集，该数据集仅包含数据集中的唯一行</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/1fe0e000127d716c038e3526dd02be33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4j41V9dLumyaW0neaRWh7w.png"/></div></div></figure><h1 id="245b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第二部分</h1><h2 id="83f6" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">2.1 —排序依据(..)</h2><p id="ee79" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">返回按给定表达式排序的新数据集。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/55d1a5238fa5acdc4f409a9ac79c78fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2bGOfXlpVSA1O53xcXBLA.png"/></div></div></figure><h2 id="0942" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">2.2 — desc()</h2><p id="6019" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">Column类是一个对象，它不仅包含列的名称，还包含列级别的转换，比如按降序排序。</p><p id="13b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">返回按降序排序的新数据集</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/c3f02190d9fcd6fc2bb886de47d7d22e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGTzX0zO3FWVe0IDvNhyzQ.png"/></div></div></figure><h2 id="6024" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">2.3 —过滤器(..)</h2><p id="ef72" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">使用给定条件筛选行</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/b9491787bdd5b054ac9fff2d490d55c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oUlpWVm6GOyx58qSksjffg.png"/></div></div></figure><h2 id="0754" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">2.4 —第一个()</h2><p id="aa91" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">返回第一行</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/4b448006e3bd1dfc4023b02797af58c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kD0niAXoN8R2e73TU8BceQ.png"/></div></div></figure><h1 id="6a6b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第三部分</h1><h2 id="a86c" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">3.1 —重命名列:别名()</h2><p id="08ba" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">as()或alias()方法可以附加到调用链中</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/cd50542b8e07662e2c89b6f7c36d4cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RVSvNSmtN34xgnsCHX-BJg.png"/></div></div></figure><h2 id="e501" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">3.2 —重命名列:withColumnRenamed()</h2><p id="4700" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">with列(..)重命名列(第一个参数),并接受我们转换所需的表达式作为第二个参数</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/bc6fb2187bcc75539f06d7fe10ca6b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kvrrd1wX4wcC7w_seakgpg.png"/></div></div></figure><h2 id="e305" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">3.3.重命名列— toDF()</h2><p id="4e10" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">我们可以把这个又大又丑的名字明确地重新命名。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/0fc2e0137c99ff9179ae9f945ff5bb25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xh1ZiD4Yg7zeYs_Sh12okQ.png"/></div></div></figure><h2 id="67c0" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">3.4.groupBy()</h2><p id="4aeb" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">使用指定的列对数据集进行分组，以便我们可以对它们运行聚合</p><ol class=""><li id="c3de" class="ln lo hi is b it iu ix iy jb lp jf lq jj lr jn ls lt lu lv bi translated">平均(..):计算每个组的每个数字列的平均值。</li><li id="0d9d" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">计数(..):计算每组的行数。</li><li id="e210" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">总和(..):计算每个组的每个数字列的总和。</li><li id="0d0a" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">最小(..):计算每个组的每个数值列的最小值。</li><li id="09cb" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">最大(..):计算每个组的每个数字列的最大值。</li><li id="cdd4" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">平均(..):计算每个组的每个数值列的平均值。</li><li id="453f" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">聚集(..):通过指定一系列聚合列来计算聚合。</li><li id="88a0" class="ln lo hi is b it lw ix lx jb ly jf lz jj ma jn ls lt lu lv bi translated">枢轴(..):透视当前DataFrame的一列并执行指定的聚合。</li></ol><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/2eb46c443e807fbfd547a945a8d7f517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5iHkxMASRV71G9QoJAyBzw.png"/></div></div></figure><h1 id="fc47" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第四部分</h1><h2 id="c747" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">4.1.加入(..)</h2><p id="20f9" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">如果您熟悉SQL连接，那么DataFrame.join(..)应该是相当直截了当的。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/c9d137594f4b94996dae9dd0b6e138cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xqc-Pcn7aFtax0nzFS_-uA.png"/></div></div></figure><h2 id="f50c" class="kr ju hi bd jv ks kt ku jz kv kw kx kd jb ky kz kh jf la lb kl jj lc ld kp le bi translated">4.2.how= "左"</h2><p id="7be7" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">例如</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/08380394ce83696e184aec404895e1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Tf4qB-hOzjPl_cbWZUh_w.png"/></div></div></figure></div></div>    
</body>
</html>