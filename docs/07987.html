<html>
<head>
<title>What would you recommend?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你会推荐什么？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-would-you-recommend-80c7ab6dab78?source=collection_archive---------30-----------------------#2020-07-13">https://medium.com/analytics-vidhya/what-would-you-recommend-80c7ab6dab78?source=collection_archive---------30-----------------------#2020-07-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c2876ed868fd9b27f90cade2c2a1a574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRoZX4JjM_89FuIjf93Tew.png"/></div></div></figure><p id="7092" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这篇帖子的标题是我们去一家新餐馆时常用的一句话。当我们有多种选择时，我们倾向于寻求意见或请人推荐我们，并期望我们会喜欢它。但是如果我们不喜欢这个建议会怎么样呢？那是一家餐厅或者任何一个平台都承受不起的。因此，了解顾客/用户，了解他/她的品味/选择，对于推荐产品至关重要。只有在这之后，我们才能提出相关的推荐，以确保用户喜欢它并再次访问！尽管说起来容易做起来难。当你的客户群很大，而且他们的喜好很广的时候，会发生什么？不要担心，数据科学就在这里。推荐系统是数据科学的一个非常酷的应用，其中的输入是客户/用户的原始数据，他们对内容/产品的喜欢和评级，基于此，我们为他们提供非常适合他们的推荐，从而让他们满意。这适用于购物、音乐、电影和任何有多种选择的地方。</p><p id="4204" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将使用MovieLens提供的电影数据集，并开发一个电影推荐系统。</p><p id="2c34" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">先决条件:</p><ul class=""><li id="19f4" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">应用统计学(余弦相似性)</li><li id="d804" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">Numpy</li><li id="7860" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">熊猫</li><li id="2479" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">Python(初级、中级)</li></ul><h2 id="5847" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">即使你不精通以上所有的方法，也不要担心。看完这些代码后，你就会明白。</h2><h2 id="48fc" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">步骤1:数据采集</h2><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/0fdbb6005c5a5dc935d9006ca2789211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8BZ44HUh4kxkjDv64Sagg.png"/></div></div></figure><p id="7ca7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据采集就是导入数据，阅读和理解给定的数据。在这个例子中，它将是关于阅读所有的专栏，对于我们建立推荐系统来说什么是必要的，什么是不必要的。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/59b504daa2be85c0716a78a7c2ce8b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CoKoF8i3eB4J8iOOb0QPRQ.png"/></div></div></figure><h2 id="99c7" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">步骤2:创建特征</h2><p id="d8f4" class="pw-post-body-paragraph iq ir hi is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hb bi translated">来自MovieLens数据集的实际数据有45466行。行数越多，数据就越大，这意味着需要更多的内存。因此，对于4–8gb的系统，高效地对数据进行采样是明智之举。在这个例子中，我随机采样了10000行，几乎是实际数据集的四分之一。在这种情况下，这是可以接受的，因为这是为了实践，但实际上，在生产中，这将是一个巨大的错误，因为每个<strong class="is hj">数据点都是相关的。现在，在所有这些列中，我们将选择“vote_average”和“vote_count”来计算所谓的<strong class="is hj"> <em class="li">加权评分</em> </strong> <em class="li">。</em></strong></p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es et"><img src="../Images/04d33d3f4158098ba32284a02652221a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iBMn_QSzcvlHtud6eY4rvQ.jpeg"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">礼貌:wikihow.com</figcaption></figure><p id="1ce7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">著名的IMDB使用这个加权评级公式:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/c722cb6395ccc912afefaab3e581a8ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*fGziZl2Do-VyQXSCPq_Y2Q.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">礼貌:trailerpark.weebly.com</figcaption></figure><p id="2e63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将创建一个函数来计算加权评分，并为每部电影创建一个名为“分数”的变量。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/03b2dae976c2474330f64de9a8bd3f3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pC7JzXdqjwSpWGZcm0tmvA.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">注意:小心地将括号放在<strong class="bd ke">回车</strong>行中，因为它会改变“分数”的值</figcaption></figure><p id="256b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为什么要考虑“投票计数”？想象一部只有少量收视率的电影，或者假设只有3个用户收视率，并且都是10/10。因此，该电影的“vote_average”将是10。这将导致扭曲的结果。因此，有必要考虑有大量用户评分的电影，这样我们的推荐更接近完美，也不会偏向某一特定类型。</p><h2 id="f5f1" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">第三步:推荐者</h2><p id="b4a4" class="pw-post-body-paragraph iq ir hi is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hb bi translated">粗略地说，推荐基于两个基本概念:</p><ol class=""><li id="f8e0" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn lp ju jv jw bi translated">基于内容的过滤:用户评价一部他们喜欢的电影(例如:9/10 ),来自该特定类型的电影将被推荐给他们。《钢铁侠电影情人》将会和续集、《复仇者联盟》等一起被推荐。</li><li id="1eb2" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lp ju jv jw bi translated">协作过滤:这是一种广泛的方法。顾名思义，它会找到两个意思相似的用户，并把他们聚集在一起。</li></ol><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/36ff315051bb8accf0a99ccaba34d6da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JhBTtEcqBrgcLhJWDHMboA.png"/></div></div></figure><p id="2684" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的例子中，考虑了2个单独的用户评级。用户1和2对电影有相似的爱好。正如我们所看到的，用户2还没有看电影C。因此，我们的推荐器将学习找到这样的相似用户，并理解这些评级，然后提供推荐，在这种情况下，电影C应该被推荐给用户2。</p><p id="832f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将看看基于内容的过滤。首先，我们必须创建一个理解类型的函数。对于人类来说，这很容易理解，但对于一个系统来说，我们需要找到一种方法来理解电影的情节，并将其归类到正确的类型。为了做到这一点，我们将考虑电影的概述。(概述是一种总结性的情节)</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/f07c4de4178d094d6908c344950680ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFmfdVn-KByDXqhLwJIDnA.png"/></div></div></figure><p id="fbc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">TF-IDF代表词频-逆词频，用于从文档(在这种情况下是概述)中进行信息检索，以给出旨在反映某个词在特定语料库中有多重要的数字统计。scikit库<strong class="is hj">tfidf矢量器</strong>形成这些重要单词的矢量并创建一个矩阵。随后，我们从语料库中移除停用词(the、an等)，这些停用词是数据(语料库)中的<em class="li">噪声</em>。一旦这些矩阵形成，我们需要找到“相似的”指示相同类型的矩阵。如前所述，TfidfVectorizer形成向量矩阵，因此为了找到相似性，我们需要找到相似向量之间的距离。这就是先决条件1出现的原因。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/31de0c96686327edc6be8e6be1322e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*CHTUjtaensX3H8pxh9lYLQ.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">en.wikipedia.org</figcaption></figure><p id="1b83" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以上公式是针对<em class="li">余弦相似度的。</em>相似的电影，属于同一个流派，余弦相似度得分会很高。为了计算相似性得分，我们将使用sklearn的<strong class="is hj"> linear_kernel()。</strong></p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/3f4fca9dbc935cf74bc34336a2bf8cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ncMUukwj9b7ZGx4P_hl5fA.png"/></div></div></figure><p id="f8a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用这些分数，我们将创建一个函数，该函数将遍历数据集并给出输出—前10个建议。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/0b61d96baabf78c09a936f14e355f9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nwc9bbdn3s3adKUCFXd8oA.png"/></div></div></figure><p id="44f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">瞧。</p><h2 id="4283" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">结论:</h2><p id="36a2" class="pw-post-body-paragraph iq ir hi is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hb bi translated">需要注意的是，使用的最终数据集是实际数据集的样本。当使用实际数据集时，可以实现更好的推荐。此外，这是<strong class="is hj">基于内容的过滤</strong>，这是一种有点幼稚的方法。如前所述,<strong class="is hj">协同过滤</strong>更加广泛，据说能提供更好的推荐，因为它的逻辑比简单的基于内容的过滤先进得多。除了余弦相似性，人的相关或欧几里德距离也可以尝试，我鼓励你们自己去做。很有趣。这个酷项目的完整方法是<a class="ae lu" href="https://github.com/ramakrishnasonakam/Recommender" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="ebd3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你还和我在一起，我希望你能学到一些东西，我也能增长见识。谢谢你。</p></div></div>    
</body>
</html>