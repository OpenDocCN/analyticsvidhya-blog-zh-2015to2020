<html>
<head>
<title>Time Series Forecasting using TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åŸºäºå¼ é‡æµçš„æ—¶é—´åºåˆ—é¢„æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/time-series-forecasting-using-tensorflow-rkt109-ea858d8e49c6?source=collection_archive---------0-----------------------#2020-04-03">https://medium.com/analytics-vidhya/time-series-forecasting-using-tensorflow-rkt109-ea858d8e49c6?source=collection_archive---------0-----------------------#2020-04-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/36d2cd01d5ea1aa2fd1bbf3a29c86189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2Wvxenw5Q5PCugHcInuDA.png"/></div></div></figure><p id="a656" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">æ—¶é—´åºåˆ—</strong>è¡¨ç¤ºå®ä½“éšæ—¶é—´çš„å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½å¬è¯´è¿‡å¤©æ°”é¢„æŠ¥ï¼Œæˆ‘ä»¬è¯•å›¾é¢„æµ‹æœªæ¥æŸä¸ªç‰¹å®šæ—¶é—´çš„å¤©æ°”çŠ¶å†µï¼Œå¯èƒ½æ˜¯ä¸€å¤©ä¸­çš„æŸä¸ªç‰¹å®šæ—¶é—´ã€‚æ—¶é—´åºåˆ—çš„å…¶ä»–ä¾‹å­æœ‰å…¬å¸è‚¡ç¥¨çš„æ¯æ—¥æ”¶ç›˜ä»·ã€æœˆé™é›¨é‡æ•°æ®å’Œå¹´é”€å”®é¢ç­‰ã€‚</p><p id="6f38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘æä¾›äº†æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„ä»£ç çš„GitHubåº“çš„é“¾æ¥ã€‚https://github.com/aryan109/Sunspot_Prediction<a class="ae jo" href="https://github.com/aryan109/Sunspot_Prediction" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="1f9b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">æ—¶é—´åºåˆ—çš„ç»„æˆéƒ¨åˆ†</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/7bbec240ed5b9ac827681484ad03ab04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/0*B5-pzc68sqNPRpQj.png"/></div></figure><h2 id="7e36" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">è¶‹åŠ¿</h2><p id="4bf9" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">è¶‹åŠ¿æ˜¾ç¤ºäº†æ•°æ®åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…å¢åŠ æˆ–å‡å°‘çš„æ€»ä½“è¶‹åŠ¿ã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/5523fcf00b4093ae64f109bd7e482bc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1CGcdS7DF4mdwT2P.png"/></div></div></figure><h2 id="4e6e" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">å‘¨æœŸæ€§æ³¢åŠ¨</h2><p id="8f64" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">æ—¶é—´åºåˆ—ä¸­æœ‰ä¸€äº›æˆåˆ†ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…é‡å¤å‡ºç°ã€‚ä»–ä»¬ä»¥ä¸€ç§æœ‰è§„å¾‹çš„é—´æ­‡æ€§æ–¹å¼è¡ŒåŠ¨ã€‚è¿™äº›å˜åŒ–æœ‰ä¸¤ç§ç±»å‹:- <br/> <strong class="is hj"> a)å­£èŠ‚æ€§å˜åŒ–:</strong>è¿™äº›æ˜¯èŠ‚å¥åŠ›ï¼Œåœ¨ä¸åˆ°ä¸€å¹´çš„æ—¶é—´å†…ä»¥è§„åˆ™å’Œå‘¨æœŸæ€§çš„æ–¹å¼èµ·ä½œç”¨ã€‚<br/> <strong class="is hj"> b)å‘¨æœŸæ€§å˜åŒ–:</strong>æ—¶é—´åºåˆ—ä¸­è‡ªèº«è¿è¡Œæ—¶é—´è·¨åº¦è¶…è¿‡ä¸€å¹´çš„å˜åŒ–ä¸ºå‘¨æœŸæ€§å˜åŒ–ã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/04800cfbc006c96d7d53557956193d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fol4pzVPAAWcocqw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">æœ‰ä¸Šå‡è¶‹åŠ¿çš„å‘¨æœŸæ€§æ³¢åŠ¨</figcaption></figure><h2 id="b69a" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">éšæœºæˆ–ä¸è§„åˆ™è¿åŠ¨(å™ªéŸ³)</h2><p id="067a" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">è¿™äº›éšæœºæˆ–ä¸è§„åˆ™çš„å˜åŒ–æ˜¯ä¸å¯é¢„è§çš„ã€ä¸å¯æ§çš„ã€ä¸å¯é¢„æµ‹çš„å’Œä¸ç¨³å®šçš„ã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/3992ea67973e6638df7f5e8848d95c0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zxqe8SBU8V8yUUqR.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">å™ªå£°æ³¢å½¢</figcaption></figure><blockquote class="ls lt lu"><p id="eb8c" class="iq ir lv is b it iu iv iw ix iy iz ja lw jc jd je lx jg jh ji ly jk jl jm jn hb bi translated">ä¸€èˆ¬æ¥è¯´ï¼Œç°å®ä¸–ç•Œä¸­çš„æ—¶é—´åºåˆ—æ—¢æœ‰è¶‹åŠ¿æ€§åˆæœ‰å­£èŠ‚æ€§ï¼Œè¿˜å¸¦æœ‰ä¸€äº›ç™½å™ªå£°ã€‚</p></blockquote><h2 id="a570" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åšå¤ªé˜³é»‘å­é¢„æµ‹ã€‚</h2><p id="8e1c" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">ä½ å¯èƒ½åœ¨æƒ³â€œä»€ä¹ˆï¼å­™ä¹Ÿå¾—äº†æ–‘ï¼Ÿï¼Ÿ?"</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/7f8b6aa30d0e4ccf7462ccfbf3ea7159.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/0*EDcTJGORoXaqPHhY"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">å›¾åƒæ˜¾ç¤ºä¸€ä¸ªçœŸæ­£çš„å¤ªé˜³é»‘å­ã€‚</figcaption></figure><p id="e145" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">å¤ªé˜³é»‘å­</strong>æ˜¯å¤ªé˜³è¡¨é¢å‘ˆç°é»‘è‰²çš„åŒºåŸŸã€‚å®ƒä»¬çœ‹èµ·æ¥å¾ˆæš—ï¼Œå› ä¸ºå®ƒä»¬æ¯”å¤ªé˜³è¡¨é¢çš„å…¶ä»–éƒ¨åˆ†æ›´å†·ã€‚ç„¶è€Œï¼Œå¤ªé˜³é»‘å­çš„æ¸©åº¦ä»ç„¶å¾ˆé«˜â€”â€”å¤§çº¦6500åæ°åº¦ï¼å¤ªé˜³é»‘å­è¢«ç”¨æ¥è®°å½•å¤ªé˜³å‘¨æœŸã€‚<strong class="is hj">å¤ªé˜³å‘¨æœŸ</strong>æ˜¯å¤ªé˜³ç£åœºå¤§çº¦æ¯11å¹´ç»å†çš„å‘¨æœŸã€‚</p><h1 id="94d3" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">æˆ‘ä»¬å¼€å§‹å§</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/be5d528a3c626474f95f4ae521d4bc6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g9tNb-mSLKfQI2e6"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">ç”±<a class="ae jo" href="https://unsplash.com/@max_duz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Max Duzij </a>åœ¨<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="32e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½æˆ‘ä»¬çš„æ—¶é—´åºåˆ—æ•°æ®ã€‚ä¸‹é¢æ˜¯ä»¥CSVæ ¼å¼ä¸‹è½½æ•°æ®çš„ä»£ç ã€‚</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="1f4f" class="ks jq hi mc b fi mg mh l mi mj">!wget â€” no-check-certificate \<br/> <a class="ae jo" href="https://storage.googleapis.com/laurencemoroney-blog.appspot.com/Sunspots.csv" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/laurencemoroney-blog.appspot.com/Sunspots.csv</a> \<br/> -O /tmp/sunspots.csv</span></pre><p id="82f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸‹è½½çš„CSVæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤º:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/d81eb213af508b7ff7d5898b3ce70afa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4T_-eH2OstpohZOzUTrSVQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">é»‘å­. csv</figcaption></figure><p id="c73c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¦‚æ‚¨æ‰€è§ï¼Œè¯¥æ–‡ä»¶æ€»å…±åŒ…å«3åˆ—ï¼Œæˆ‘ä»¬å°†æŠŠç¬¬1åˆ—å’Œç¬¬3åˆ—æå–åˆ°ä¸€ä¸ªNumPyæ•°ç»„ä¸­ã€‚æˆ‘ä»¬å·²ç»é€‰æ‹©äº†ç´¢å¼•åˆ—ï¼Œè¿™å°†å¾ˆå®¹æ˜“ä½œå‡ºé¢„æµ‹ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦ç»™ç´¢å¼•ã€‚</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="7cd4" class="ks jq hi mc b fi mg mh l mi mj">import csv<br/>time_step = []<br/>sunspots = []</span><span id="13ff" class="ks jq hi mc b fi ml mh l mi mj">with open(â€˜/tmp/sunspots.csvâ€™) as csvfile:<br/> reader = csv.reader(csvfile, delimiter=â€™,â€™)<br/> next(reader)<br/> for row in reader:<br/> sunspots.append(float(row[2]))<br/> time_step.append(int(row[0]))</span><span id="f19e" class="ks jq hi mc b fi ml mh l mi mj">series = np.array(sunspots)<br/>time = np.array(time_step)<br/>print(â€˜series: {}â€™.format(series[:5]))<br/>print(â€˜time: {}â€™.format(time[:5]))</span></pre><p id="d8f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®©æˆ‘ä»¬ç”»å‡ºè¿™ä¸ªç³»åˆ—ï¼Œçœ‹çœ‹å®ƒæœ‰ä»€ä¹ˆã€‚</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="ef37" class="ks jq hi mc b fi mg mh l mi mj">plt.figure(figsize=(10, 6))<br/>plot_series(time, series)</span></pre><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/749fbdfe9859eab12c42f3439459099e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amYRjhBEf2Svzj1WL4laow.png"/></div></div></figure><h1 id="0e13" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">æ­£åœ¨å‡†å¤‡æ•°æ®é›†</h1><p id="0f4a" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">æˆ‘ä»¬å¿…é¡»å°†æˆ‘ä»¬çš„æ—¶é—´åºåˆ—åˆ†æˆè®­ç»ƒæœŸå’ŒéªŒè¯æœŸã€‚</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="f854" class="ks jq hi mc b fi mg mh l mi mj">split_time = 3000<br/>time_train = time[:split_time]<br/>x_train = series[:split_time]<br/>time_valid = time[split_time:]<br/>x_valid = series[split_time:]</span></pre><p id="49c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åˆ†å‰²æ—¶é—´ä¸º3000æ„å‘³ç€ä»0åˆ°3000å°†ç”¨äºè®­ç»ƒï¼Œ3000åˆ°æœ€åç”¨äºéªŒè¯ã€‚</p><p id="3614" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªçª—å£æ•°æ®é›†ã€‚åœ¨ä¸€ä¸ª<strong class="is hj">çª—å£æ•°æ®é›†ä¸­ï¼Œ</strong>å‰nä¸ªå€¼å¯ä»¥è¢«è§†ä¸º<strong class="is hj">è¾“å…¥ç‰¹å¾</strong>ã€‚è€Œå¸¦æœ‰ä»»æ„æ—¶é—´æˆ³çš„å½“å‰å€¼å°±æ˜¯<strong class="is hj">è¾“å‡ºæ ‡ç­¾</strong>ã€‚çª—å£æ•°æ®é›†ç”±å›ºå®šçš„<strong class="is hj">çª—å£å¤§å°</strong>ç»„æˆã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/0df1dc4508e347df653c9e58789e4087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5LxXIM9-S0OclvDRQTiWw.png"/></div></div></figure><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="b1e4" class="ks jq hi mc b fi mg mh l mi mj">def windowed_dataset(series, window_size, batch_size, shuffle_buffer):<br/> series = tf.expand_dims(series, axis=-1)<br/> ds = tf.data.Dataset.from_tensor_slices(series)<br/> ds = ds.window(window_size + 1, shift=1, drop_remainder=True)<br/> ds = ds.flat_map(lambda w: w.batch(window_size + 1))<br/> ds = ds.shuffle(shuffle_buffer)<br/> ds = ds.map(lambda w: (w[:-1], w[1:]))<br/> return ds.batch(batch_size).prefetch(1)</span></pre><p id="8d4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨<strong class="is hj"> windowed_dataset </strong>å‡½æ•°åˆ›å»ºè®­ç»ƒæ•°æ®é›†</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="5d56" class="ks jq hi mc b fi mg mh l mi mj">tf.keras.backend.clear_session()<br/>tf.random.set_seed(51)<br/>np.random.seed(51)<br/>shuffle_buffer_size = 1000<br/>window_size = 64<br/>batch_size = 256<br/>train_set = windowed_dataset(x_train, window_size, batch_size, shuffle_buffer_size)<br/>print(x_train.shape)</span></pre><h1 id="674f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">åˆ›å»ºæ¨¡å‹</h1><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="2af2" class="ks jq hi mc b fi mg mh l mi mj">tf.keras.backend.clear_session()<br/>model = tf.keras.models.Sequential([<br/> tf.keras.layers.Conv1D(filters=60, kernel_size=5,<br/> strides=1, padding=â€causalâ€,<br/> activation=â€reluâ€,<br/> input_shape=[None, 1]),<br/> tf.keras.layers.LSTM(60, return_sequences=True),<br/> tf.keras.layers.LSTM(60, return_sequences=True),<br/> tf.keras.layers.Dense(30, activation=â€reluâ€),<br/> tf.keras.layers.Dense(10, activation=â€reluâ€),<br/> tf.keras.layers.Dense(1),<br/> tf.keras.layers.Lambda(lambda x: x * 400)<br/>])<br/>model.summary()</span></pre><p id="7570" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¯¥æ¨¡å‹çš„æ‘˜è¦å¦‚ä¸‹æ‰€ç¤º:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/7ccb1b0021b1fc4255209fb4b764db86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYLSqEeT5A71WbU9Ro5Xuw.png"/></div></div></figure><p id="feab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¿™ä¸ªæ¨¡å‹ç”±<strong class="is hj">å·ç§¯å±‚ã€LSTMå±‚</strong>å’Œ<strong class="is hj">è‡´å¯†å±‚</strong>ç»„æˆã€‚å¦‚æœä½ ä¸çŸ¥é“è¿™äº›å±‚åˆ°åº•æ˜¯åšä»€ä¹ˆçš„ï¼Œä¸è¦æ‹…å¿ƒï¼Œå¾ˆå¿«æˆ‘ä¼šå†™ä¸€ç¯‡æ–‡ç« æè¿°æ‰€æœ‰ä¸åŒç±»å‹å±‚çš„åŠŸèƒ½ã€‚</p><h1 id="f1da" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">ç°åœ¨è®©æˆ‘ä»¬ç¼–è¯‘å’Œè®­ç»ƒæ¨¡å‹</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/978eb294a4171db164c00ccf7248c4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jFAhR2rwA7P56YUl"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae jo" href="https://unsplash.com/@roozbeheslami?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Roozbeh Eslami </a>åœ¨<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="a1f9" class="ks jq hi mc b fi mg mh l mi mj">optimizer = tf.keras.optimizers.SGD(lr=1e-5, momentum=0.9)<br/>model.compile(loss=tf.keras.losses.Huber(),<br/> optimizer=optimizer,<br/> metrics=[â€œmaeâ€])<br/>history = model.fit(train_set,epochs=500)</span></pre><p id="b2a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®­ç»ƒå¼€å§‹äº†â€¦..</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/91435df45ee48a2ea632de1005e13956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LqMZm1_0D_QGZC4Hs76PFw.png"/></div></div></figure><p id="4201" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®­ç»ƒéœ€è¦æ—¶é—´ï¼Œæ‰€ä»¥è¯·æ”¾æ¾ã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/4a66bb792ab1f7ae81a1fc7df7c47a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a2iOvcZpfs2DasoN"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">Max van den Oetelaar åœ¨<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><h1 id="1cc6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">è¯„ä¼°æ¨¡å‹</h1><p id="b5d5" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†é€šè¿‡è§‚å¯Ÿè®­ç»ƒæŸå¤±æ¥äº†è§£æˆ‘ä»¬çš„æ¨¡å‹æœ‰å¤šå¥½</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="9114" class="ks jq hi mc b fi mg mh l mi mj"># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -<br/># Retrieve a list of list results on training and test data<br/># sets for each training epoch<br/># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -<br/>loss=history.history[â€˜lossâ€™]<br/>epochs=range(len(loss)) # Get number of epochs<br/># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/># Plot training and validation loss per epoch<br/># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/>plt.plot(epochs, loss, â€˜râ€™)<br/>plt.title(â€˜Training lossâ€™)<br/>plt.xlabel(â€œEpochsâ€)<br/>plt.ylabel(â€œLossâ€)<br/>plt.legend([â€œLossâ€])<br/>plt.figure()</span><span id="acd3" class="ks jq hi mc b fi ml mh l mi mj">zoomed_loss = loss[200:]<br/>zoomed_epochs = range(200,500)<br/># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/># Plot training and validation loss per epoch<br/># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/>plt.plot(zoomed_epochs, zoomed_loss, â€˜râ€™)<br/>plt.title(â€˜Training lossâ€™)<br/>plt.xlabel(â€œEpochsâ€)<br/>plt.ylabel(â€œLossâ€)<br/>plt.legend([â€œLossâ€])</span><span id="c6a3" class="ks jq hi mc b fi ml mh l mi mj">plt.figure()</span></pre><p id="5643" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å›¾è¡¨åº”è¯¥ä¸æ­¤ç±»ä¼¼ã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/02614fb7f8cfda0defcc771a766c5370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*HybwRD8Y5gQC2WzGzKzTdQ.png"/></div></figure><p id="0993" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç¬¬äºŒä¸ªå›¾åªæ˜¯æ”¾å¤§äº†ç¬¬ä¸€ä¸ªå›¾çš„æœ€åä¸€éƒ¨åˆ†ã€‚é€šè¿‡è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°äº†è§£è¿‡å»300å¹´çš„è®­ç»ƒçŠ¶å†µã€‚</p><h1 id="a11e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">è®©æˆ‘ä»¬é¢„æµ‹ä¸€ä¸‹</h1><p id="0bd4" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">ç°åœ¨ï¼Œéšç€ä½ çš„æ¨¡å‹è¢«è®­ç»ƒï¼Œå‡†å¤‡å¥½çœ‹åˆ°æœªæ¥ã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/9714b4085742ccc9087773250534eb7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ogu0s-4sIyhmYorV"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae jo" href="https://unsplash.com/@lenneek?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Elena Koycheva </a>åœ¨<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure><p id="f10d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥å¸®åŠ©æˆ‘ä»¬åšé¢„æµ‹ã€‚</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="92d2" class="ks jq hi mc b fi mg mh l mi mj">def model_forecast(model, series, window_size):<br/> ds = tf.data.Dataset.from_tensor_slices(series)<br/> ds = ds.window(window_size, shift=1, drop_remainder=True)<br/> ds = ds.flat_map(lambda w: w.batch(window_size))<br/> ds = ds.batch(32).prefetch(1)<br/> forecast = model.predict(ds)<br/> return forecast</span></pre><p id="7213" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åšé¢„æµ‹ã€‚</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="697d" class="ks jq hi mc b fi mg mh l mi mj">rnn_forecast = model_forecast(model, series[â€¦, np.newaxis], window_size)<br/>rnn_forecast = rnn_forecast[split_time â€” window_size:-1, -1, 0]<br/>plt.figure(figsize=(10, 6))<br/>plot_series(time_valid, x_valid)<br/>plot_series(time_valid, rnn_forecast)</span></pre><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/219e26a92d8230b5ebe7e3b16fe1ebc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WK9dM64wz58u-diRRpcSVQ.png"/></div></div></figure><p id="6459" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è“è‰²æ˜¯åŸå§‹ç³»åˆ—ï¼Œæ©™è‰²æ˜¯é¢„æµ‹ç³»åˆ—ï¼Œç»“æœçœ‹èµ·æ¥ç›¸å½“ä¸é”™ğŸ˜ƒã€‚</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/dc08000aa2f548a44fc372d177ce5f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CX9pKNrObDfYAz2u9aRqSQ.jpeg"/></div></div></figure><p id="56fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¸Œæœ›ä½ æ˜ç™½å¦‚ä½•ç”¨TensorFlowåšæ—¶é—´åºåˆ—é¢„æµ‹ã€‚</p><p id="300e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¯·ç»™å‡ºæ‚¨çš„åé¦ˆæˆ–å»ºè®®ã€‚è°¢è°¢ä½ ğŸ™‚</p></div></div>    
</body>
</html>