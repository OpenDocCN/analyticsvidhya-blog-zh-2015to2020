<html>
<head>
<title>Complement your Table with Soft-delete</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用软删除来补充你的表</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/complement-your-table-with-soft-delete-fb6456a7601b?source=collection_archive---------13-----------------------#2019-11-17">https://medium.com/analytics-vidhya/complement-your-table-with-soft-delete-fb6456a7601b?source=collection_archive---------13-----------------------#2019-11-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b8da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多风格来来去去，每个开发人员在处理数据库中的数据时都会有麻烦。像我在将数据存储到postgresql或mysql之类的数据库中时，我通常会添加一些列，如“created_at”、“created_by”、“updated_at”、“updated_by”、“archived_at”和“archived_by ”,以补充我想要制作的表格。它名字已经描述了它的功能，比如何时谁创建了这个字段，何时谁更新了这个字段，以及何时谁删除了这个行。</p><p id="9fe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许你们中的一些人会问，</p><blockquote class="jd je jf"><p id="435e" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">我们为什么要这么做？太多了，没法储存！！我们真的需要存档栏吗？？？？</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jk"><img src="../Images/4f4b5c3ae5eb56118844cfe348dd5d3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*_9YjATPi_gPNVhFqCUB5Aw.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">创建表书的示例脚本</figcaption></figure><p id="5fab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，大概没有对错之分。我同意，因为存储太多的数据也会降低查询速度，并影响应用程序的性能。我相信你的股东不希望它发生，当它发生时，你的生活将毁于一旦。</p><p id="f821" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但它是，现在有了当前版本，数据库可以通过使用索引或尝试重新评估您选择它的方式来解决这个问题。由于误用索引或查询，在生产中可能会发生一些意外。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jw"><img src="../Images/a71bed27230872102ca7bea46e75ab09.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*0zJbS2m2gAugG9TgTc1gIg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">列名和列说明的索引</figcaption></figure><p id="abda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回到我为什么使用‘archived _ at’等列，原因很简单。数据很重要，它的历史也很重要。在删除它之前，我们需要把它看得和我们拥有的一样重要。也许在未来，我们会需要或要求这些数据，这样我们就不必费力去寻找了。</p><blockquote class="jd je jf"><p id="84ec" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">数据很重要，它的历史也很重要。</p></blockquote><p id="4c3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您想要删除该行时，只需将它的时间戳更新到它的“archived_at”列，这样我们就知道它是何时归档的。人们会称之为<strong class="ih hj">软删除</strong>情况，意思是我们实际上并没有删除数据，我们仍然可以在表上清楚地看到它。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es jx"><img src="../Images/a89564ad00e79a89b53b7f6d9606914e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P6vn0nGP6Bq-IZ-d2LldFg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">包含陈旧的数据</figcaption></figure><p id="2e22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于查询本身，只需添加where条件‘archived _ at is null’来查找活动数据。从这里，我们可以区分哪些数据仍然是活动的和陈旧的。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kc"><img src="../Images/478d412aea93260962305c406dde3cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*GqFp2y5Bsl2RbTZrXcUZWQ.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">查询以查找活动数据</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kd"><img src="../Images/f17a42758b9e9e79a4c9f1a67c2513c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*hWanvmjnuLyai8yVIj19Hw.png"/></div></figure><p id="56ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，就是这样。要不要用你自己看着办。这也取决于你的需求。但是，我个人会推荐用这个。最后，我之前使用的脚本是基于postgresql的。:)</p></div></div>    
</body>
</html>