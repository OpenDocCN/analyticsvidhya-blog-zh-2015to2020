<html>
<head>
<title>Modern Portfolio Theory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代投资组合理论</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/modern-portfolio-theory-fa0706d40e5c?source=collection_archive---------16-----------------------#2020-10-25">https://medium.com/analytics-vidhya/modern-portfolio-theory-fa0706d40e5c?source=collection_archive---------16-----------------------#2020-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="171f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我对金融的兴趣始于2019年下半年。我和一个朋友聊天，他告诉我金融市场，告诉我人们如何从中赚钱，从那时起，我开始了自己的学习，买书，看大型对冲基金经理在youtube或电视上的演讲，并在youtube和他自己的网站上观看Damodaran在线课程。(他的网站链接在这个故事里面)</p><p id="af20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实上，我创建了一个twitter来关注一些金融人士，我们称之为“fintwit”(很多人发表他们的观点，有时解释一些有趣的东西)，有一天，这个被<a class="jd je ge" href="https://medium.com/u/96eefece1b3f?source=post_page-----fa0706d40e5c--------------------------------" rel="noopener" target="_blank"> femisapien </a>称为的用户回答了一些人的以下研究:</p><p id="706d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jf" href="https://towardsdatascience.com/efficient-frontier-portfolio-optimisation-in-python-e7844051e7f" rel="noopener" target="_blank">用Python实现高效前沿投资组合优化</a>作者Ben Kim</p><p id="a06a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实上，我发现这项研究非常有趣，并且对创建投资组合非常有用，因为我喜欢挑战自己，而且我在第一学期实际上过Python课，我决定尝试看看我是否能应用我所学的知识，所以我开始编写程序。</p><h2 id="f4be" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">现代投资组合理论定义</h2><p id="8908" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">现代投资组合理论是Harry Markowitz在他的论文《投资组合选择》中提出的理论。这是一种关于风险厌恶型投资者如何构建期望回报最大化的投资组合的理论。所以基本上它表明，投资者可以建立一个多种资产的投资组合，最大化他的预期收益，或者给定一定的风险水平，他如何建立风险最小的投资组合。</p><h2 id="aec6" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">理解风险和回顾问题</h2><p id="f1c9" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">Aswath Damodaran教授展示了一个中文单词，它实际上意味着危机，但对我来说它很好地描述了风险的定义</p><p id="dc02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi"><strong class="ih hj">“风险”</strong> it means danger and opportunity.</p><p id="65b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">做我们将要做的事情是有问题的。问题是我们在比较过去，而我们的风险与未来相关。</p><h2 id="f6ae" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">构建代码</h2><ul class=""><li id="970d" class="kg kh hi ih b ii kb im kc iq ki iu kj iy kk jc kl km kn ko bi translated">首先让我们导入一些库:</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="7f01" class="jg jh hi ku b fi ky kz l la lb">import yfinance as yf<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><p id="d47c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将从雅虎财经中为我们的股票提取数据。我使用了6只在巴西B3上市的股票。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="7172" class="jg jh hi ku b fi ky kz l la lb">data = yf.download(“FLRY3.SA EGIE3.SA ITSA4.SA ENBR3.SA KLBN4.SA BBDC4.SA ”, start=”2018–01–01", end=”2019–01–01)<br/>returns = data['Adj Close'].pct_change()</span></pre><p id="75ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的研究中，我们只需要每只股票的收盘价。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="c58c" class="jg jh hi ku b fi ky kz l la lb">data[‘Adj Close’]</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div class="er es lc"><img src="../Images/2e0095951d5ccca8e8509134084e38fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*Uf0fN1Q1x6qjmVp7a__2BA.png"/></div></figure><h2 id="cb15" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">无风险折现率</h2><p id="7c0b" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">衡量一些国家的无风险利率实际上并不容易，因为他们实际上没有无风险债券。如果该国没有无违约实体，估算无风险的一种方法是使用长期债券减去<em class="lg"> cds </em>(信用违约利差)。由于我无法访问更复杂的平台，我正在使用一个名为trading economics的网站来获得我的10y债券，对于我的<em class="lg"> cds </em>，由于巴西拥有Baa2评级，我正在使用Damodaran教授的网站来选择他发现的默认利差。以下是他的网站链接:</p><p id="2b7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jf" href="http://pages.stern.nyu.edu/~adamodar/" rel="noopener ugc nofollow" target="_blank">http://pages.stern.nyu.edu/~adamodar/</a></p><p id="2ec1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">10年期债券= 7.60%</p><p id="0d33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">信用违约互换= 3.53%</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="db33" class="jg jh hi ku b fi ky kz l la lb">rf = 0.0407</span></pre><h2 id="068d" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">蒙特卡罗法</h2><p id="caa0" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">蒙特卡罗方法是任何一种基于大量随机样本的统计方法。在<em class="lg">现代投资组合理论</em>中，我们将模拟5万个不同权重的投资组合，看看哪一个具有最好的夏普比率和最低的波动性。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="1cf6" class="jg jh hi ku b fi ky kz l la lb">num_portfolios = 50000</span><span id="163a" class="jg jh hi ku b fi lh kz l la lb">#WR (Weights record)<br/>WR = []<br/>for i in range(0,(num_portfolios)):<br/> weights = np.random.random(6)<br/> weights /= np.sum(weights)<br/> WR.append(weights)</span></pre><h2 id="3c44" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">夏普比率</h2><p id="7d89" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">夏普比率(Sharpe Ratio)是由威廉·夏普(William F. Sharpe)提出的，用于衡量一项投资相对于其风险的回报。它的公式如下:</p><figure class="kp kq kr ks fd ld er es paragraph-image"><div class="er es li"><img src="../Images/49c24621640b6f5ff517d033ac115c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*v1JS_kGPE2aa6S1di378Pw.png"/></div></figure><p id="e31b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更容易理解，我举一个例子:</p><p id="8c59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设你有两个投资组合A和B，回报率都是20%，但是A的波动率是10%，B是15%。想象一下5%的无风险率(此处纯属想象)。根据夏普比率，A的夏普比率为1.5，B的夏普比率为1，这意味着投资组合A的回报更好地取决于其风险。</p><h2 id="9053" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">如何衡量投资组合的波动性</h2><p id="bb40" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">投资组合中的波动性可以由每项资产的标准差、它们的权重以及资产之间的相关性来给出。在我的代码中，我需要将它放入一个矩阵结构中，所以我找到了一篇文章，名为:</p><p id="b007" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jf" rel="noopener" href="/python-data/assessing-risks-and-return-with-probabilities-of-events-with-python-c564d9be4db4">用python中的事件概率评估风险和回报</a></p><p id="cc93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，他实际上展示了我们如何将投资组合的波动性写成矩阵结构。可以这样写:</p><blockquote class="lj lk ll"><p id="a39d" class="if ig lg ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated"><em class="hi">权重转置*(协方差矩阵*权重)</em></p></blockquote><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="221f" class="jg jh hi ku b fi ky kz l la lb">mean_returns = returns.mean()</span><span id="0eb3" class="jg jh hi ku b fi lh kz l la lb">cov_matrix = returns.cov()</span></pre><h2 id="a043" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">创建一个空列表并填充它</h2><p id="d1f7" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">对于我们的代码，我们将使用列表，所以我们将创建一个有3行和5万行的空列表。我们使用一个简单的for来完成这项工作:</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="7048" class="jg jh hi ku b fi ky kz l la lb">portfolio = np.zeros((3, num_portfolios))<br/>#vol (volatility)<br/>#PER (Portfolio expected return)<br/>for i in range(num_portfolios):<br/>    vol = np.sqrt(np.dot(WR[i].T, (np.dot(cov_matrix,WR[i]))))*np.sqrt(245)<br/>    PER = np.dot(mean_returns, WR[i])*245<br/>    sharpe =  (PER-rf)/vol<br/>    portfolio[0][i] = vol<br/>    portfolio[1][i] = PER<br/>    portfolio[2][i] = sharpe</span></pre><ul class=""><li id="4cb8" class="kg kh hi ih b ii ij im in iq lp iu lq iy lr jc kl km kn ko bi translated">投资组合的预期回报是由一年的平均回报给出的，对于年化平均回报，我们乘以245(或多或少是市场开放的日子)，我们做同样的事情来获得年化波动率。</li></ul><h2 id="95f9" class="jg jh hi bd ji jj jk jl jm jn jo jp jq iq jr js jt iu ju jv jw iy jx jy jz ka bi translated">回到代码</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="5e9b" class="jg jh hi ku b fi ky kz l la lb">min_vol_indice = np.argmin(portfolio[0])</span><span id="e42f" class="jg jh hi ku b fi lh kz l la lb">VOLXmin, PERYmin = portfolio[0][min_vol_indice], portfolio[1][min_vol_indice]</span><span id="5d31" class="jg jh hi ku b fi lh kz l la lb">max_sharpe_indice = np.argmax(portfolio[2])</span><span id="63a3" class="jg jh hi ku b fi lh kz l la lb">VOLX, PERY = portfolio[0][max_sharpe_indice], portfolio[1][max_sharpe_indice]</span><span id="f77e" class="jg jh hi ku b fi lh kz l la lb">plt.figure(figsize=(15, 7))<br/>plt.scatter(portfolio[0,],portfolio[1,],c=portfolio[2,:],cmap='YlGnBu',marker='o', s=15, alpha=0.4)<br/>plt.scatter(VOLX,PERY,marker='*',color='y',s=500, label='Maximum Sharpe ratio')<br/>plt.scatter(VOLXmin,PERYmin,marker='*',color='r',s=500, label='Minimum Volatility')<br/>plt.legend(labelspacing=0.8, fontsize= 15)<br/>plt.ylabel('annualised return', fontsize=12)<br/>plt.xlabel('annualised volatility', fontsize=12)</span><span id="7961" class="jg jh hi ku b fi lh kz l la lb">maxsharpeallocation = WR[max_sharpe_indice]<br/>minvolallocation = WR[min_vol_indice]<br/>print("-"*100)<br/>print(" ")<br/>print("Weights for the Maximum Sharpe Ratio")<br/>print("FLRY3.SA =", "{:.2f}".format(maxsharpeallocation[0]*100),'%')<br/>print("EGIE3.SA =", "{:.2f}".format(maxsharpeallocation[1]*100),'%')<br/>print("ITSA4.SA =", "{:.2f}".format(maxsharpeallocation[2]*100),'%')<br/>print("ENBR3.SA =", "{:.2f}".format(maxsharpeallocation[3]*100),'%')<br/>print("KLBN4.SA =", "{:.2f}".format(maxsharpeallocation[4]*100),'%')<br/>print("BBDC4.SA =", "{:.2f}".format(maxsharpeallocation[5]*100),'%')</span><span id="a3e3" class="jg jh hi ku b fi lh kz l la lb">print("Sharpe Ratio=","{:.2f}".format(portfolio[2][np.argmax(portfolio[2])]))</span><span id="ddac" class="jg jh hi ku b fi lh kz l la lb">print(" ")<br/>print("-"*100)<br/>print("")<br/>print("Weights for the Minimum Volatility")<br/>print("FLRY3.SA =", "{:.2f}".format(minvolallocation[0]*100),'%')<br/>print("EGIE3.SA =", "{:.2f}".format(minvolallocation[1]*100),'%')<br/>print("ITSA4.SA =", "{:.2f}".format(minvolallocation[2]*100),'%')<br/>print("ENBR3.SA =", "{:.2f}".format(minvolallocation[3]*100),'%')<br/>print("KLBN4.SA =", "{:.2f}".format(minvolallocation[4]*100),'%')<br/>print("BBDC4.SA =", "{:.2f}".format(minvolallocation[5]*100),'%')<br/>print("Sharpe Ratio=","{:.2f}".format(portfolio[2][np.argmin(portfolio[0])]))<br/>print(" ")<br/>print("")</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ls"><img src="../Images/39b2d9b2d45ef5a3b5d4db8fd21c6a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qoy4BqNiviukNsZZyTnUFQ.png"/></div></div></figure><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es lx"><img src="../Images/9571ace31eab7358de867841aa777f52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*geTB4SK4GyDOk1NwM9KqWQ.png"/></div></div></figure><p id="1a8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！如果你想要代码或者有任何问题，请留下你的评论。</p></div></div>    
</body>
</html>