<html>
<head>
<title>Hive Installation on ubuntu 18.04 | MySQL Metastore</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ubuntu 18.04 | MySQL Metastore上的配置单元安装</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hive-installation-on-ubuntu-18-04-b3362dcadfb8?source=collection_archive---------0-----------------------#2020-04-17">https://medium.com/analytics-vidhya/hive-installation-on-ubuntu-18-04-b3362dcadfb8?source=collection_archive---------0-----------------------#2020-04-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3fd260db2770bd18e986bfee77d1fdab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMNH1D9pEXeR33xYy6pXsA.png"/></div></div></figure><blockquote class="iq ir is"><p id="3289" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Apache Hive是一个数据仓库基础设施，它有助于查询和管理驻留在分布式存储系统中的大型数据集。它是基于Hadoop开发的。Hive有自己的类似SQL的查询语言，叫做<strong class="iw hj">Hive QL</strong>(Hive Query Language)。</p><p id="b33a" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Hive查询语言类似于SQL，它支持子查询。使用Hive查询语言，可以跨Hive表进行MapReduce连接。</p></blockquote></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><blockquote class="iq ir is"><p id="2e22" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">既然，Hive是建立在Hadoop之上的，<strong class="iw hj"> Java </strong>和<strong class="iw hj"> Hadoop </strong>需要安装在你的系统中。如果您的系统上没有配置Hadoop，可以按照<a class="ae jz" rel="noopener" href="/@adarshms1997/hadoop-single-node-cluster-setup-b11b957681f2?sk=6bcd2f534d70f8d7c34e86241f43f16e">https://medium . com/@ adarshms 1997/Hadoop-single-node-cluster-setup-b11b 957681 f 2？sk = 6 BC D2 f 534d 70 f 8d 7 c 34 e 86241 f 43 f 16 e</a></p><p id="5a28" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在安装配置单元之前，请确保您的Hadoop安装正常，并且Hadoop的所有核心服务都已启动并运行。<br/> <em class="hi">本次设置使用的环境为</em> <strong class="iw hj"> <em class="hi"> ubuntu 18.04，hive版本为3.1.2 </em> </strong> <em class="hi">。</em></p></blockquote></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="ed35" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="iv">注意:</em> </strong> <em class="iv">更喜欢java 8，因为较新版本不再有运行hive所需的URLClassLoader。</em></p><h1 id="87cb" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Hive 3.x安装</h1><p id="af9b" class="pw-post-body-paragraph it iu hi iw b ix lb iz ja jb lc jd je ka ld jh ji kb le jl jm kc lf jp jq jr hb bi translated">现在。让我们从<em class="iv">(</em><a class="ae jz" href="http://apachemirror.wuchna.com/hive/hive-3.1.2/" rel="noopener ugc nofollow" target="_blank">【http://apachemirror.wuchna.com/hive/hive-3.1.2/】</a><em class="iv">)，</em>下载最新的stables版本，开始hive的安装过程，旧版本<em class="iv"> </em>请访问<em class="iv">(</em><a class="ae jz" href="http://apachemirror.wuchna.com/hive/" rel="noopener ugc nofollow" target="_blank"/><em class="iv">)。</em></p><p id="b249" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">要下载您选择的版本，请使用以下命令。<em class="iv">(根据个人喜好更改目录和下载链接)。</em></p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="0f6d" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">cd /usr/local<br/>sudo wget </em><a class="ae jz" href="http://apachemirror.wuchna.com/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz" rel="noopener ugc nofollow" target="_blank">http://apachemirror.wuchna.com/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz</a></span></pre><p id="90b8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">提取相同位置的配置单元文件。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="4fa5" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo tar xvzf </em>apache-hive-3.1.2-bin.tar.gz</span></pre><p id="9184" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">重命名提取的文件夹</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="7cbd" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo mv </em>apache-hive-3.1.2-bin<em class="iv"> hive</em></span></pre><h2 id="100a" class="lp ke hi bd kf lu lv lw kj lx ly lz kn ka ma mb kr kb mc md kv kc me mf kz mg bi translated">添加配置单元环境变量</h2><p id="652a" class="pw-post-body-paragraph it iu hi iw b ix lb iz ja jb lc jd je ka ld jh ji kb le jl jm kc lf jp jq jr hb bi translated">将配置单元路径添加到环境中是必要的，否则您将不得不移动到配置单元目录来运行命令。</p><p id="50fe" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">通过运行打开<em class="iv"> bashrc </em>文件</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5930" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo nano ~/.bashrc</em></span></pre><p id="5d27" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">将以下几行添加到<em class="iv"> bashrc </em>文件的末尾</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="b13f" class="lp ke hi ll b fi lq lr l ls lt"># Set HIVE_HOME <br/>export HIVE_HOME=/usr/local/hive <br/>export PATH=$PATH:$HIVE_HOME/bin</span></pre><p id="9b2f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">现在，通过运行以下命令加载配置单元环境变量</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="3317" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">source ~/.bashrc</em></span></pre><p id="0d2b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated"><strong class="iw hj">创建目录… <br/> </strong>现在我们需要在<strong class="iw hj"> HDFS </strong>中创建<strong class="iw hj"> Hive </strong>目录。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="85c9" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">hdfs dfs -mkdir /bigdata/tmp</em></span></pre><p id="0f4d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">现在，为了让hive保存表或其他杂项数据，我们需要创建另一个目录。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="aa01" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">hdfs dfs -mkdir -p /bigdata/hive/warehouse</em></span></pre><p id="4ddd" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated"><strong class="iw hj">添加权限… </strong></p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="3464" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">hdfs dfs -chmod g+w /bigdata/tmp<br/>hdfs dfs -chmod g+w /bigdata/hive/warehouse</em></span></pre><h2 id="6858" class="lp ke hi bd kf lu lv lw kj lx ly lz kn ka ma mb kr kb mc md kv kc me mf kz mg bi translated">正在配置配置单元…</h2><p id="ed69" class="pw-post-body-paragraph it iu hi iw b ix lb iz ja jb lc jd je ka ld jh ji kb le jl jm kc lf jp jq jr hb bi translated">将工作目录更改为配置单元配置位置</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="08ed" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">cd /usr/local/hive/conf</em></span></pre><ul class=""><li id="cce7" class="mh mi hi iw b ix iy jb jc ka mj kb mk kc ml jr mm mn mo mp bi translated"><strong class="iw hj"> hive-env.sh <br/> </strong>通过运行以下命令打开hive-env文件</li></ul><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="56eb" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo nano hive-env.sh</em></span></pre><p id="8586" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">将以下配置添加到文件的末尾<em class="iv">(根据您的设置更改路径)</em></p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c593" class="lp ke hi ll b fi lq lr l ls lt"># Set HADOOP_HOME to point to a specific hadoop install directory<br/>HADOOP_HOME=/usr/local/hadoop</span><span id="7bce" class="lp ke hi ll b fi mq lr l ls lt"># Hive Configuration Directory can be controlled by: <br/>export HIVE_CONF_DIR=/usr/local/hive/conf</span><span id="0b8b" class="lp ke hi ll b fi mq lr l ls lt"># Java Home <br/>export JAVA_HOME=/usr</span></pre><h2 id="9956" class="lp ke hi bd kf lu lv lw kj lx ly lz kn ka ma mb kr kb mc md kv kc me mf kz mg bi translated">Metastore配置</h2><p id="394b" class="pw-post-body-paragraph it iu hi iw b ix lb iz ja jb lc jd je ka ld jh ji kb le jl jm kc lf jp jq jr hb bi translated">Metastore是Apache Hive元数据的中央存储库。它在关系数据库中存储Hive表的元数据(如它们的模式和位置)和<strong class="iw hj"> </strong> <em class="iv">分区</em> <strong class="iw hj"> </strong>。</p><p id="9f8b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">所有Hive实现都需要一个metastore服务，它在其中存储元数据。默认情况下，Hive使用内置的Derby SQL服务器。也可以选择<strong class="iw hj"> <em class="iv"> MySQL、Postgres、Oracle、MS SQL Server </em> </strong>作为Hive Metastore。</p><p id="0688" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">对于这种配置，我们将使用MySQL。Metastore配置需要在<em class="iv"> hive-site.xml </em>文件中指定。</p><blockquote class="iq ir is"><p id="0c47" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，让我们使用aptitude安装最新的mysql版本。如果系统安装了mysql，可以跳过这一步。</p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="f7c6" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo apt-get update<br/>sudo apt-get install mysql-server</em></span></pre><blockquote class="iq ir is"><p id="3aa4" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果安全安装实用程序在安装完成后没有自动启动，请输入以下命令:</p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="911b" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo mysql_secure_installation utility</em></span></pre><blockquote class="iq ir is"><p id="b9bc" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">该实用程序提示您定义mysql root密码和其他与安全相关的选项，包括删除对root用户的远程访问和设置root密码。</p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="25f2" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo systemctl start mysql</em></span></pre><blockquote class="iq ir is"><p id="3c82" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这个命令启动mysql服务</p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="ff20" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo systemctl enable mysql</em></span></pre><blockquote class="iq ir is"><p id="01aa" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">该命令确保数据库服务器在重新启动后启动</p></blockquote><p id="e9e9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">现在成功安装mysql服务器后，我们需要安装<strong class="iw hj"> <em class="iv"> mysql java连接器。</em> </strong>运行以下命令安装连接器。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8472" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo apt-get install libmysql-java</em></span></pre><p id="e5f2" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">为了让hive访问mysql连接器，需要在hive lib文件夹中为连接器创建一个软链接，或者将jar文件复制到hive lib文件夹中。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="67a5" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo ln -s /usr/share/java/mysql-connector-java.jar $HIVE_HOME/lib/mysql-connector-java.jar</em></span></pre><p id="bde3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">使用位于<strong class="iw hj">$ hive _ HOME/scripts/metastore/upgrade/MySQL</strong>目录中的<strong class="iw hj">Hive-schema-3 . 1 . 0 . MySQL . SQL</strong>文件(或与您安装的Hive版本相对应的文件)创建初始数据库模式。</p><blockquote class="iq ir is"><p id="a086" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">登录到mysql shell</p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="1883" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">mysql -u root -p</em></span></pre><blockquote class="iq ir is"><p id="d463" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为metastore创建数据库</p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="d9fe" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">CREATE DATABASE metastore;</em></span><span id="a6b6" class="lp ke hi ll b fi mq lr l ls lt"><em class="iv">USE metastore;</em></span><span id="8f5d" class="lp ke hi ll b fi mq lr l ls lt"><em class="iv">SOURCE /usr/local/hive/scripts/metastore/upgrade/mysql/hive-schema-3.1.0.mysql.sql;</em></span></pre><blockquote class="iq ir is"><p id="044b" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了让Hive访问metastore，需要创建一个MySQL用户帐户。防止该用户帐户创建或更改metastore数据库模式中的表非常重要。<strong class="iw hj">(别忘了引号)</strong></p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c1ce" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">CREATE USER 'hiveuser'@'%' IDENTIFIED BY 'hivepassword';</em></span><span id="8e62" class="lp ke hi ll b fi mq lr l ls lt"><em class="iv">GRANT all on *.* to 'hiveuser'@localhost identified by 'hivepassword';</em></span><span id="c4b7" class="lp ke hi ll b fi mq lr l ls lt"><em class="iv">flush privileges;</em></span></pre><blockquote class="iq ir is"><p id="922e" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们已经在mysql中创建了metastore和hive用户。让我们在<em class="hi"> hive-site.xml. </em>中定义metastore配置</p></blockquote><ul class=""><li id="2a9a" class="mh mi hi iw b ix iy jb jc ka mj kb mk kc ml jr mm mn mo mp bi translated"><strong class="iw hj"> hive-site.xml <br/> </strong>通过运行以下命令打开hive-site文件</li></ul><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="39b3" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">cd /usr/local/hive/conf<br/>sudo nano hive-site.xml</em></span></pre><p id="be19" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">添加以下配置</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="de90" class="lp ke hi ll b fi lq lr l ls lt">&lt;configuration&gt; <br/>   &lt;property&gt; <br/>      &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; <br/>      &lt;value&gt;jdbc:mysql://localhost/metastore?createDatabaseIfNotExist=true&lt;/value&gt; <br/>      &lt;description&gt;metadata is stored in a MySQL server&lt;/description&gt; <br/>   &lt;/property&gt; <br/>   &lt;property&gt; <br/>      &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; <br/>      &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; <br/>      &lt;description&gt;MySQL JDBC driver class&lt;/description&gt; <br/>   &lt;/property&gt; <br/>   &lt;property&gt; <br/>      &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; <br/>      &lt;value&gt;hiveuser&lt;/value&gt; <br/>      &lt;description&gt;user name for connecting to mysql server&lt;/description&gt; <br/>   &lt;/property&gt; <br/>   &lt;property&gt; <br/>      &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; <br/>      &lt;value&gt;hivepassword&lt;/value&gt; <br/>      &lt;description&gt;hivepassword for connecting to mysql server&lt;/description&gt; <br/>   &lt;/property&gt;<br/>   &lt;property&gt; <br/>        &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; <br/>        &lt;value&gt;/bigdata/hive/warehouse&lt;/value&gt; <br/>        &lt;description&gt;location of default database for the warehouse&lt;/description&gt; <br/>    &lt;/property&gt; <br/>    &lt;property&gt; <br/>        &lt;name&gt;hive.metastore.uris&lt;/name&gt; <br/>        &lt;value&gt;thrift://localhost:9083&lt;/value&gt; <br/>        &lt;description&gt;Thrift URI for the remote metastore.&lt;/description&gt; <br/>    &lt;/property&gt; <br/>    &lt;property&gt; <br/>        &lt;name&gt;hive.server2.enable.doAs&lt;/name&gt; <br/>        &lt;value&gt;false&lt;/value&gt; <br/>    &lt;/property&gt;<br/>&lt;/configuration&gt;</span></pre><p id="9ed9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">一切就绪…现在让我们进入蜂巢控制台。在您的终端中键入以下命令，然后点击enter  </p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="9b95" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">hive</em></span></pre><p id="62f0" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">如果您看到任何与找不到jdbc驱动程序相关的错误，请检查您是否已成功将驱动程序链接或复制到hive lib文件夹。</p><h2 id="2700" class="lp ke hi bd kf lu lv lw kj lx ly lz kn ka ma mb kr kb mc md kv kc me mf kz mg bi translated">正在启动配置单元metastore…</h2><p id="e3c9" class="pw-post-body-paragraph it iu hi iw b ix lb iz ja jb lc jd je ka ld jh ji kb le jl jm kc lf jp jq jr hb bi translated">现在，让我们启动metastore服务，在您的终端中运行以下命令，</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="e00c" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">hive --service metastore</em></span></pre><p id="ec88" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">如果您遇到任何错误，请验证您的metastore配置。<br/>检查您的<em class="iv"> hive-site.xml </em>配置，并检查在mysql中配置的metastore db和user。对于与thrift相关的错误，请检查您的<em class="iv"> hive.metastore.uris </em>属性中使用的端口的可用性。</p><blockquote class="iq ir is"><p id="f99b" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">注意:</strong>如果您想将hive metastore作为系统服务运行，请执行以下步骤。</p></blockquote><p id="7863" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">首先，让我们创建一个服务文件来启动我们的hive metastore</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8734" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo nano /etc/systemd/system/hive-meta.service</em></span></pre><p id="ef5b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">将下列行添加到服务文件中</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="51f0" class="lp ke hi ll b fi lq lr l ls lt">[Unit] <br/>Description=Hive metastore <br/>After=network.target <br/> <br/>[Service] <br/>User=ubuntu <br/>Group=www-data <br/>ExecStart=/usr/local/hive/bin/hive --service metastore <br/> <br/>[Install] <br/>WantedBy=multi-user.target</span></pre><p id="38b3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">现在让我们通过运行以下命令来启动我们的hive-meta服务</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="1ec5" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo systemctl start hive-meta</em></span></pre><blockquote class="iq ir is"><p id="4586" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果需要在系统引导时启动配置单元metastore，请使用以下命令创建一个符号链接</p></blockquote><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c754" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">sudo systemctl enable hive-meta</em></span></pre></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h2 id="5306" class="lp ke hi bd kf lu lv lw kj lx ly lz kn ka ma mb kr kb mc md kv kc me mf kz mg bi translated"><strong class="ak">临时演员… </strong></h2><p id="351b" class="pw-post-body-paragraph it iu hi iw b ix lb iz ja jb lc jd je ka ld jh ji kb le jl jm kc lf jp jq jr hb bi translated">如果您能够正确无误地进入配置单元控制台，您可以通过执行以下步骤来验证您的metastore配置。</p><p id="9c92" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">在配置单元中创建一个表。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="fe06" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">create table test(id int, name string);</em></span></pre><p id="c8d1" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">现在从配置单元控制台退出<em class="iv">(键入exit并点击enter) </em></p><p id="5add" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">让我们看看这个表是否成功地添加到了我们的metastore中。<strong class="iw hj"> <em class="iv">使用hive用户凭证登录mysql控制台。</em> </strong></p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="84a5" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">mysql -u root -p</em></span></pre><p id="f9cb" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">更改数据库和视图表。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="fcf3" class="lp ke hi ll b fi lq lr l ls lt"><em class="iv">use metastore;</em></span><span id="222d" class="lp ke hi ll b fi mq lr l ls lt"><em class="iv">select * from TBLS;</em></span></pre><p id="21bc" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ka jg jh ji kb jk jl jm kc jo jp jq jr hb bi translated">如果您看到TBLS表中列出的<strong class="iw hj"> <em class="iv">测试</em> </strong>表，那么您的安装是成功的。如果没有，请检查mysql数据库和hive metastore的用户配置。</p></div></div>    
</body>
</html>