<html>
<head>
<title>What About a 6-Week Machine Learning Project? Beginners Friendly Cat vs Dog Classification Problem.(Week 5)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为期 6 周的机器学习项目怎么样？初学者友好的猫 vs 狗分类问题。(第五周)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-about-a-6-week-machine-learning-project-fd947e46c4a2?source=collection_archive---------31-----------------------#2020-08-25">https://medium.com/analytics-vidhya/what-about-a-6-week-machine-learning-project-fd947e46c4a2?source=collection_archive---------31-----------------------#2020-08-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/68bf867b2617aeee6be37de0d6d5948b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3uApB0pouwaybWS-jg6xxQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">狗的全数据集模型拟合。</figcaption></figure><p id="8e17" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，我为期 6 周的 ML 项目又过去了一周。现在，我们完成了最重要和最激动人心的任务。是的，我的意思是用完整的数据集训练我们的模型。</p><p id="2017" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在前几周，我们做了大量工作，包括:</p><ol class=""><li id="5d59" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">收集数据集。</li><li id="bd4b" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">寻找图像和标签。</li><li id="34a1" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">创建验证集。</li><li id="0bd2" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">数据成批。(<a class="ae kg" rel="noopener" href="/analytics-vidhya/what-about-a-6-week-machine-learning-project-f1091a5b712a">第一周</a>)。</li><li id="c7be" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">为分类问题建立模型。</li><li id="ce6b" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">创建回调。(<a class="ae kg" rel="noopener" href="/analytics-vidhya/what-about-a-6-week-machine-learning-project-e16033dd32f4?source=friends_link&amp;sk=c87e6984e75ef2487ec4ea67eb941eed">第二周</a>)</li><li id="00c9" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">根据数据子集训练我们的模型。</li><li id="c077" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">做出并评估预测。(<a class="ae kg" rel="noopener" href="/analytics-vidhya/what-about-a-6-week-machine-learning-project-4e328365f165">第三周</a>)。</li></ol><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/033c0482f3e6600b31b217bc758bd11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FTYSiX1sfjYj2HTd6iJm2A.jpeg"/></div></div></figure><p id="754d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后利用完整的数据集对模型进行训练。</p><h1 id="e8ca" class="km kn hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">第四周</h1><p id="0711" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated">我们在数据子集上训练我们的模型，我们找出预测概率，进行评估，将结果与我们预测的图像一起可视化，等等。</p><p id="6f3f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">即使在所有这些工作之后，我们还没有幸运地遇到任何严重的错误，并且可以继续我们的下一项工作，即在完整的数据集上训练我们的模型。</p><p id="628d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们用手中的全部数据集创建数据批次，我们对猫和狗都这样做。</p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="72f4" class="lu kn hi lq b fi lv lw l lx ly">full_data_cat = create_data_batches(X_cat, y_cat)<br/>full_data_dog = create_data_batches(X_dog, y_dog)</span><span id="2ed4" class="lu kn hi lq b fi lz lw l lx ly">creating training data batches....<br/>creating training data batches....</span></pre><p id="b8b0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们必须建立模型，借助<code class="du ma mb mc lq b">create_our_model()</code>函数，我们可以轻松完成。</p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="6a77" class="lu kn hi lq b fi lv lw l lx ly">full_cat_model = create_our_model()<br/>full_dog_model = create_our_model()</span></pre><p id="cb55" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">正如我们在上周所做的，如果没有进一步的训练要做，我们也可以利用早期停止回调来停止训练，只需调用我们方便的函数<code class="du ma mb mc lq b">create_callback()</code>和<code class="du ma mb mc lq b">tf.keras.callbacks.EarlyStopping()</code>就可以了。</p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="4239" class="lu kn hi lq b fi lv lw l lx ly">full_model_tensorboard = create_callback()<br/>full_model_early_stopping = tf.keras.callbacks.EarlyStopping(monitor='accuracy', patience=3)</span></pre><p id="37cb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们已经创建了数据批次，创建了各自的模型并设置了回调。</p><p id="5aff" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">是时候让我们用完整的数据集来拟合和训练我们的模型了。</p><p id="283e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">猫</strong></p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="f8bf" class="lu kn hi lq b fi lv lw l lx ly">full_cat_model.fit(x=full_data_cat,<br/>                   epochs=NUM_EPOCHS,<br/>                   callbacks=[full_model_tensorboard, full_model_early_stopping])</span><span id="272a" class="lu kn hi lq b fi lz lw l lx ly">Epoch 1/100<br/>  1/125 [..............................] - ETA: 0s - loss: 0.2057 - accuracy: 0.9688<br/>WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/summary_ops_v2.py:1277: stop (from tensorflow.python.eager.profiler) is deprecated and will be removed after 2020-07-01.<br/>Instructions for updating:<br/>use `tf.profiler.experimental.stop` instead.</span><span id="cecd" class="lu kn hi lq b fi lz lw l lx ly">125/125 [==============================] - 1755s 14s/step - loss: 0.0064 - accuracy: 0.9990<br/>Epoch 2/100<br/>125/125 [==============================] - 20s 161ms/step - loss: 4.9371e-04 - accuracy: 1.0000<br/>Epoch 3/100<br/>125/125 [==============================] - 20s 162ms/step - loss: 2.3928e-04 - accuracy: 1.0000<br/>Epoch 4/100<br/>125/125 [==============================] - 20s 163ms/step - loss: 1.4022e-04 - accuracy: 1.0000<br/>Epoch 5/100<br/>125/125 [==============================] - 21s 165ms/step - loss: 9.4611e-05 - accuracy: 1.0000</span></pre><p id="3d38" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">狗</strong></p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="49fe" class="lu kn hi lq b fi lv lw l lx ly">full_dog_model.fit(x=full_data_dog,<br/>                   epochs=NUM_EPOCHS,<br/>                   callbacks=[full_model_tensorboard, full_model_early_stopping])</span><span id="d5aa" class="lu kn hi lq b fi lz lw l lx ly">Epoch 1/100<br/>126/126 [==============================] - 1808s 14s/step - loss: 0.0382 - accuracy: 0.9940<br/>Epoch 2/100<br/>126/126 [==============================] - 20s 158ms/step - loss: 0.0045 - accuracy: 0.9998<br/>Epoch 3/100<br/>126/126 [==============================] - 20s 159ms/step - loss: 0.0022 - accuracy: 1.0000<br/>Epoch 4/100<br/>126/126 [==============================] - 20s 161ms/step - loss: 0.0013 - accuracy: 1.0000<br/>Epoch 5/100<br/>126/126 [==============================] - 19s 154ms/step - loss: 8.2162e-04 - accuracy: 1.0000<br/>Epoch 6/100<br/>126/126 [==============================] - 19s 154ms/step - loss: 5.9812e-04 - accuracy: 1.0000</span></pre><p id="768b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们可以看到，模型已经适应了完整的数据集，是时候保存我们的模型了。</p><p id="d7f7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们保存我们的模型，它总是非常有用的，因为不需要一次又一次地进行训练。我们可以保存模型，然后在需要的时候加载它。</p><h2 id="4767" class="lu kn hi bd ko md me mf ks mg mh mi kw jf mj mk la jj ml mm le jn mn mo li mp bi translated">保存并加载模型</h2><p id="ef4f" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated"><strong class="iw hj">卡特彼勒</strong></p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="0210" class="lu kn hi lq b fi lv lw l lx ly"><em class="mq"># Save our cat model</em><br/>save_model(full_cat_model, suffix="full-cat_image-set-mobilenetv2-Adam")</span></pre><p id="e7cc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">狗</strong></p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="ea7e" class="lu kn hi lq b fi lv lw l lx ly"><em class="mq"># Save our dog model</em><br/>save_model(full_dog_model, suffix="full-dog_image-set-mobilenetv2-Adam")</span></pre><p id="ccfc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们已经保存了我们的模型，我们可以通过使用我们的函数<code class="du ma mb mc lq b">load_model()</code>轻松地加载它。</p><pre class="ki kj kk kl fd lp lq lr ls aw lt bi"><span id="1503" class="lu kn hi lq b fi lv lw l lx ly"><em class="mq"># Load our full dog model</em><br/>loaded_full_dog_model = load_model("drive/My Drive/CatVsDog/models/20200818-05141597727686-full-dog_image-set-mobilenetv2-Adam.h5")</span><span id="c146" class="lu kn hi lq b fi lz lw l lx ly">Loading saved model from drive/My Drive/CatVsDog/models/20200818-05141597727686-full-dog_image-set-mobilenetv2-Adam.h5....</span><span id="a878" class="lu kn hi lq b fi lz lw l lx ly"><em class="mq"># Load our full cat model</em><br/>loaded_full_cat_model = load_model("drive/My Drive/CatVsDog/models/20200818-04411597725679-full-cat_image-set-mobilenetv2-Adam.h5")</span><span id="ece8" class="lu kn hi lq b fi lz lw l lx ly">Loading saved model from drive/My Drive/CatVsDog/models/20200818-04411597725679-full-cat_image-set-mobilenetv2-Adam.h5....</span></pre><p id="2cec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我的 Github 回购:<a class="ae kg" href="https://github.com/Rohithv07/6WeekPro/blob/master/Cat_Vs_Dog.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a></p><h1 id="d52e" class="km kn hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">下一步是什么</h1><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/4ab473ce1dcb40f286065527a6650b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7IXndNwSomAI_gfJVYc4w.jpeg"/></div></div></figure><p id="cb5a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来要做的是对测试数据和一些随机或定制的图像进行预测，看看我们的模型是否也能准确预测。</p><p id="4b69" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我现在感觉非常激动，因为我已经接近完成这个项目了，它在很多事情上帮助了我，比如通读许多文档，发现错误，纠正错误，每当我有疑问时就运行代码，在互联网上搜索并在一些特殊情况下遵循他人的代码。就我而言，这绝对没有浪费时间和精力，在整个过程中，我只获得了许多有价值的信息。我渴望看到我的猫和狗的项目成真，很快。</p></div></div>    
</body>
</html>