<html>
<head>
<title>Talking Data User Demographics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对话数据用户人口统计</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/talking-data-user-demographics-3fa17702ad9f?source=collection_archive---------8-----------------------#2020-04-11">https://medium.com/analytics-vidhya/talking-data-user-demographics-3fa17702ad9f?source=collection_archive---------8-----------------------#2020-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/0fb9a3afec6860a24b531f57b5274901.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*_46p_swU8s3BHUumf2DY0A.jpeg"/></div></figure><h1 id="6dce" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">目录</h1><ol class=""><li id="dadc" class="jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">介绍</li><li id="f230" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">数据概述</li><li id="2373" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">估价</li><li id="8258" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">探索性数据分析</li><li id="8c9a" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">我的方法</li><li id="d443" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">特征抽出</li><li id="05c2" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">性别分类模型</li><li id="9db9" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">年龄回归模型</li><li id="fb1a" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">最终分类模型</li><li id="53f8" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">集成建模</li><li id="c563" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">进一步的改进</li><li id="37cc" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">参考</li></ol><h1 id="595e" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">1.介绍</h1><p id="dccc" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated"><em class="kw">来源:</em> <a class="ae kx" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/" rel="noopener ugc nofollow" target="_blank"> <em class="kw"> Kaggle比赛页面</em> </a></p><p id="7cbc" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><a class="ae kx" href="https://www.talkingdata.com/" rel="noopener ugc nofollow" target="_blank">中国最大的第三方移动数据平台TalkingData </a>明白，日常的选择和行为描绘了我们是谁，我们重视什么。目前，腾云天下正在寻求利用中国每天活跃的5亿移动设备中超过70%的行为数据，帮助其客户更好地了解他们的受众并与之互动。</p><p id="a86b" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">在这场比赛中，Kagglers面临的挑战是建立一个模型，根据用户的应用程序使用、地理位置和移动设备属性来预测用户的人口统计特征。这样做将有助于全球数百万开发者和品牌广告商追求数据驱动的营销努力，这些努力与他们的用户相关并迎合他们的偏好。</p><h1 id="5f0c" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">2.数据概述</h1><ul class=""><li id="8167" class="jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx ld jz ka kb bi translated"><strong class="jm hj"> gender_age_train.csv，gender_age_test.csv </strong> —训练和测试集</li><li id="795b" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx ld jz ka kb bi translated"><strong class="jm hj">组:</strong>这是您要预测的目标变量</li><li id="2050" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx ld jz ka kb bi translated"><strong class="jm hj"> events.csv，app_events.csv </strong> —当用户使用TalkingData SDK时，事件被记录在该数据中。每个事件都有一个事件id，位置(纬度/经度)，事件对应app_events中的一个应用列表。</li><li id="135c" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx ld jz ka kb bi translated"><strong class="jm hj">时间戳:</strong>当用户使用带有TalkingData SDK的应用时</li><li id="68ed" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx ld jz ka kb bi translated"><strong class="jm hj"> app_labels.csv </strong> —应用程序及其标签，label_id可用于连接label_categories</li><li id="e2a3" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx ld jz ka kb bi translated"><strong class="jm hj"> label_categories.csv </strong> —文本形式的应用程序标签及其类别</li><li id="5580" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx ld jz ka kb bi translated"><strong class="jm hj">phone _ brand _ device _ model . CSV</strong>—设备id、品牌和型号</li></ul><h1 id="7391" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">3.估价</h1><p id="42ac" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">使用多级对数损失对提交的内容进行评估。每个设备都标有一个真实的类别。对于每种设备，你必须提交一套预测概率(每类一套)。公式是，</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es le"><img src="../Images/443892a0f2db42e1338d6d2c3b7e4573.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*wOz6kjpFq1DTfoheErumNg.png"/></div></figure><p id="2f34" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">其中，N是测试集中设备的数量，M是类别标签的数量，log是自然对数，如果设备I属于类别j，yij是1，否则是0，pij是观测值I属于类别j的预测概率。</p><p id="1b2d" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">给定设备的提交概率不要求总和为1，因为它们在评分之前被重新缩放(每行除以行总和)，但它们需要在[0，1]的范围内。</p><p id="61db" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><strong class="jm hj"> 3.1。将真实世界问题映射到机器学习问题:</strong></p><ol class=""><li id="a84a" class="jk jl hi jm b jn ky jp kz jr lj jt lk jv ll jx jy jz ka kb bi translated">这是一个多类分类问题。</li><li id="353b" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">要预测的12个类别是:F23-，F24–26，F27–28，F29–32，F33–42，F43+，M22-，M23–26，M27–28，M29–31，M32–38和M39+。</li></ol><p id="7c3c" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><strong class="jm hj"> 3.2。目标:</strong></p><p id="fc40" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">预测每个数据点属于12个类别的概率。</p><p id="3f62" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><strong class="jm hj"> 3.3。约束条件:</strong></p><ul class=""><li id="99a2" class="jk jl hi jm b jn ky jp kz jr lj jt lk jv ll jx ld jz ka kb bi translated">需要类别概率。</li><li id="387a" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx ld jz ka kb bi translated">没有延迟限制。</li></ul><h1 id="b73c" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">4.探索性数据分析</h1><p id="c93c" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">首先，让我们检查数据是否平衡。从gender_age_train.csv文件中的group列可以观察到数据是不平衡的。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/1ca85ecb6f51a763345fcb013588304f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*eDJ7SCHnPWlZTp5VmyQRrA.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">组列的计数图</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/e42ca400587fd4e2720a15d4f7ef04ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*GMcHN9ANs1XQxP5XQp369g.jpeg"/></div></figure><p id="44e9" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">此外，让我们将数据分为两组，即男性和女性，并检查这些组的计数之间的差异。男性的数量比女性多得多。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ls"><img src="../Images/d43b6a5bce49e2d64960d9eae4c246f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*fpzifnnSKWeo4dOfry0rqA.png"/></div></div></figure><p id="d42f" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">在训练数据中，有四列指定了用户的设备id、性别、年龄和组。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/57b7167f01311c7876bf64010a2c30da.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*t1DskKNoRqttF4RwYWyz_w.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">训练数据列</figcaption></figure><p id="9f6f" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">在测试数据中，只有一列，即我们必须预测其年龄组的device_id。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/18b945c823df81d865bd957a1072142e.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*ICjhswNpEWMEG-4WsfdvJQ.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">测试数据</figcaption></figure><p id="3e57" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，我们评估人们使用的手机品牌。因为这个数据是基于中国的人口，所以大部分手机品牌都是中国的。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/e5bffb5b5dda9c4b49a4846593f86112.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*GSb-zdJ3yKFIU62Yp9Eg4g.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">电话_数据</figcaption></figure><p id="c4ec" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">电话数据由三列组成，即设备id、电话品牌和设备型号。它指定了特定用户使用的电话品牌和型号。</p><p id="797e" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，我们来分析一下手机品牌。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/5b9d133acaef5025e7e1165dd5ae83df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*TayHbs-OqMOvFvkxUqUVGA.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">十大手机品牌柱状图</figcaption></figure><p id="f6e0" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">小米、三星和华为这三大品牌占据了总设备的60%以上。数据中总共有73个手机品牌。</p><p id="d4a0" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，我们将检查年龄和手机品牌之间是否存在相关性。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mb"><img src="../Images/3c4092d5ac37fae5f83bab92b0f1fd4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0mEZrIP7qfsRMCoOO-VgIQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">代表年龄和手机品牌相关性的方框图。</figcaption></figure><p id="a48c" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">红线代表所有用户的年龄特征的中间值。可以观察到，三星、联想、华为等品牌被老年人群使用，Vivo、魅族等品牌被年轻人群使用。</p><p id="6f39" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">我们接下来要分析的是人们使用的设备型号。总体使用的整个数据中共有1599个设备型号。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/5c4bd47ad5f5a03fba14bf1dc67155a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*rs11alkYd9YarI62XYSnWQ.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">前15个设备型号的条形图</figcaption></figure><p id="182b" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">红米Note、米3、米2S、Galaxy Note 3是用户首选的顶级设备型号。排名前15位的设备型号仅占总市场的25%左右。</p><p id="133c" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，让我们检查年龄组和设备型号之间的相关性。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es md"><img src="../Images/aa8d46c1f51da5a29581ac8a01f04700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*koXlhUT9zFj3ryP-CqKe3A.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">用于查找年龄和设备型号之间相关性的箱线图</figcaption></figure><p id="143b" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">从上面的方框图可以观察到，Mate 7、Galaxy Note 3、Galaxy Note 2、Honor Play 4x、Galaxy S3都是老用户在用。其他设备如Redmi NOTE，MI 2S在年轻一代中很受欢迎。</p><p id="4da8" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，让我们检查一下与其相关的app_labels和事件。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es me"><img src="../Images/3085ea6b9aec57148e6f1f04043e70aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3wosZINhFUpoiLEA6UATQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">前20个应用标签的条形图</figcaption></figure><p id="442a" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">总共有473个应用类别。总应用类别中排名前10的应用类别约占总应用的68.116%。排名靠前的app类别有行业标签、自定义标签、腾讯App、游戏账号、物业行业等。腾讯控股有限公司是一家中国跨国集团控股公司，其子公司在中国和全球专注于各种互联网相关服务和产品、娱乐、人工智能和技术。</p><p id="87f9" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，让我们看看为特定设备记录的事件。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/577587e00822b6dc9887e94f30b30a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*1irvtyI53SrKIdbOKb_uhg.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">列车数据中有和没有事件的设备的饼图</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mg"><img src="../Images/46f735a9addcc94230460756f4d1fead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_UBhpaf922YQxR7cWc1Vsw.png"/></div></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/b95c1d7d3108b62345c263c35c153793.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*I6xQyZK35Brz11U_mrtj8w.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">测试数据中有和没有事件的设备的饼图</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mi"><img src="../Images/f124d81ff4da2eb25f6afcd962dd82b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xgk1IOinhcOt83Y9Omik2w.png"/></div></div></figure><p id="e5c1" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">在训练和测试数据中，大约2/3的设备没有记录任何事件。这些设备的唯一信息是手机品牌和设备型号。</p><h2 id="0b0b" class="mj in hi bd io mk ml mm is mn mo mp iw jr mq mr ja jt ms mt je jv mu mv ji mw bi translated">来自数据分析的见解</h2><ol class=""><li id="dd60" class="jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">数据不平衡。</li><li id="ffab" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">所有的功能工程只在31%的设备上完成，因为它们有事件记录。对于没有事件的设备，唯一可以使用的功能是电话品牌和设备型号。</li><li id="28c5" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">手机品牌和设备型号因年龄组而异。</li><li id="8106" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">可用于带有事件的设备的其他功能有app_id、app_labels、事件小时、事件日和应用活动状态。</li></ol><h1 id="b007" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">5.我的方法</h1><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mx"><img src="../Images/f395894b8c453da1d025fe15bc37cbb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eFozs6Sn16Z4cQEuhbjWg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">工艺流程图</figcaption></figure><p id="50db" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">首先，我们将从数据中提取所有特征。将要使用的功能有手机品牌、设备型号、应用id、应用标签、应用活动、活动小时和活动日。一个热编码和TF-IDF矢量器用于特征提取。</p><p id="3816" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">因为我们有分别指定确切年龄和性别的列，所以我们可以利用这些数据构建单独的模型，首先预测性别和年龄，然后将这些模型的输出作为最终模型的特征。</p><p id="a0ff" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，我们将分别使用手机品牌、设备型号、应用id、应用标签和活跃应用等特征来预测性别。这个分类模型的输出将给出用户是男性还是女性的概率。该输出将作为最终模型的一个特征。</p><p id="c770" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">然后，我们将使用回归模型来预测用户的年龄，使用的功能包括手机品牌、设备型号、应用id、应用标签和应用活动以及活动时间。由于不同年龄组记录事件的时间不同，因此还将包括“事件时间”功能来预测年龄。</p><h1 id="9307" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">6.特征抽出</h1><p id="3d9d" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">我们将使用一个热编码来提取手机品牌、设备型号、App_id和App_Label等特征。</p><h2 id="0266" class="mj in hi bd io mk ml mm is mn mo mp iw jr mq mr ja jt ms mt je jv mu mv ji mw bi translated">6.1.什么是热门编码？</h2><p id="5f99" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">在机器学习中，不可能直接处理分类数据。一种热编码将分类特征转换为更适合分类和回归算法的格式。一种热编码是将分类变量转换成一种形式的过程，这种形式可以提供给ML算法，以便在预测中做得更好。一种热编码是向量表示，其中向量的所有元素都是0，只有一个元素的值是1。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es my"><img src="../Images/acfcaf3f9888732068820e72fca7b0b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G38rxK75lAk_Jxsryx4Rjg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">一个热点编码示例源— <a class="ae kx" href="https://www.kaggle.com/dansbecker/using-categorical-data-with-one-hot-encoding" rel="noopener ugc nofollow" target="_blank"> Kaggle Page </a></figcaption></figure><p id="8ed6" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">对于手机品牌和设备型号，我们可以直接构建一个CSR矩阵，其中1对应于设备的品牌，其余的0和设备型号相同。</p><p id="57e6" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">但是对于app_id，对于每台设备，我们都要标注它安装了哪些应用。因此，我们将获得与不同应用程序一样多的功能栏。</p><p id="0a35" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">应用通过事件链接到设备。因此，要获得一个应用包，其中有一个1对应于设备中安装的所有应用，其余应用有零，我们可以遵循以下步骤:</p><ol class=""><li id="44ad" class="jk jl hi jm b jn ky jp kz jr lj jt lk jv ll jx jy jz ka kb bi translated">合并事件和app_events中的设备id。</li><li id="f6fc" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">按设备id和应用程序对结果数据帧进行分组并聚合。</li><li id="25ba" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">合并训练行和测试行列，以了解将每个器件放在特性矩阵的哪一行。</li></ol><p id="4685" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">合并后，我们将得到这样的数据帧:</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/b6c0f7d7bed34a6b586a5a32578b6e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*YoWIb4g8eKAbM4zrQHnfGA.png"/></div></figure><p id="e70c" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">然后，我们可以构建一个CSR矩阵，其中1对应于设备中安装的应用程序，0对应于未安装的应用程序。</p><p id="ba84" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">app_labels的特征提取以类似的方式完成。</p><p id="405a" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，对于apps_active、events hour和events day，我们将使用TF-IDF矢量器进行特征提取。</p><h2 id="da75" class="mj in hi bd io mk ml mm is mn mo mp iw jr mq mr ja jt ms mt je jv mu mv ji mw bi translated">6.2.什么是TF-IDF矢量器？</h2><p id="5d43" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">TF-IDF是术语Frequency-Inverse Document Frequency的缩写，是将文本转换为有意义的数字表示的一种非常常见的算法。该技术被广泛用于在各种NLP应用中提取特征。</p><p id="a3fb" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><strong class="jm hj"> TF-IDF </strong>是词频和逆文档频的乘积。它可以表示为:</p><p id="4237" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><strong class="jm hj"> Tf-idf(字)</strong> = <strong class="jm hj"> tf(字)*idf(字)</strong>其中</p><p id="d823" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><strong class="jm hj">TF(word)</strong>= document . count(word)/文档中的总字数和</p><p id="6043" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated"><strong class="jm hj"> idf(word) </strong> = log(文档总数/包含word的文档数)(Source- <a class="ae kx" href="https://www.commonlounge.com/discussion/99e86c9c15bb4d23a30b111b23e7b7b1" rel="noopener ugc nofollow" target="_blank"> Page </a>)</p><p id="c0d2" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">首先，我们将提取记录特定事件的时间和日期。然后，我们将结合每个设备记录事件的所有时间，并对其使用TF-IDF矢量器。对于事件发生的日子，我们将遵循类似的方法。</p><p id="086a" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">对于apps_active，我们首先获得每个应用程序的活动状态字符串(作为布尔值),当一个事件被记录为特定设备的所有事件时。然后我们使用TF-IDF矢量器进行特征提取。</p><h1 id="d92e" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">7.性别分类模型</h1><p id="a1be" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">首先，我们将把我们用来预测性别的5个特征叠加在一起。目标变量是train_data.gender，我们必须首先使用LabelEncoder对其进行编码。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es na"><img src="../Images/4821b67629109b04c122e4a0166e7768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*8Jx_pfIuNx9izs2-Ue3vFQ.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">用于性别分类模型的特征</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es na"><img src="../Images/e1be3d75f0ecfaeed8a8a6a83bb25d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*itKl0BmLPhwXXgNTFE4K5w.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">性别分类模型的目标变量</figcaption></figure><p id="3b5c" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">现在，我们建立一个逻辑回归模型。让我们先做一些超参数调优。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nb"><img src="../Images/28a15bd4a2a8ddd78a6c65b80447650b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*98G8KvCOamigMh4AQfbC0Q.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">逻辑回归模型的超参数调整</figcaption></figure><p id="e109" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">我们从这个模型中得到0.59394的验证对数损失。让我们构建一个混淆矩阵，以可视化最佳alpha(即0.001)的性能</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/af46618a5f8fe7d3b17ba964146c1120.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*EvlZRSHAYAK9xxelDWXjTQ.png"/></div></figure><p id="c34e" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">正确分类的女性人数为963人，正确分类的男性人数为9183人。</p><p id="3c20" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">让我们尝试建立一个神经网络，看看我们是否可以改善这些结果。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nd"><img src="../Images/9724d04a9c52848b2e6243ae8492e92e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*thUK65E1H7hCFpOqfDMbZQ.png"/></div></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/4968e4f2cfc50a891c66e9b46021fb35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*JSjrg7AOmBgNXFZ9WfG27g.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">神经网络综述</figcaption></figure><p id="941e" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">使用该神经网络，我们得到0.58815的验证对数损失。让我们使用混淆矩阵来可视化结果。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nf"><img src="../Images/d6d013b6da81ee45580b7b835cc638d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*pfrPuZXeSKKlAbmrf99xtQ.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">预测性别的神经网络模型的混淆矩阵</figcaption></figure><p id="0c2e" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">我们可以看到，虽然男性的正确预测数量有所减少，但女性的正确预测数量却显著增加。</p><p id="2088" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">因此，我们可以使用这个神经网络的结果作为最终分类模型的特征。</p><h1 id="ddab" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">8.年龄回归模型</h1><p id="9cd9" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">现在，我们将用于回归模型的6个特征堆叠在一起。将要使用的目标变量是train_data.age。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ng"><img src="../Images/8b91f7cc12fe4660d4b3a507c2d4243d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZcZqCmfywY9BuZ5WN_nlw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">用于回归的特征</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nh"><img src="../Images/c7dd0b5ae7b2467c89a8d4e33dae18fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*7jV6O7EZInnseeuBcDcCJg.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">回归模型的目标变量</figcaption></figure><p id="48b9" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">利用这些特征，现在我们建立一个线性回归模型。该模型的输出使用最小最大缩放器进行预处理，并用作最终分类模型的特征。</p><h2 id="9f3c" class="mj in hi bd io mk ml mm is mn mo mp iw jr mq mr ja jt ms mt je jv mu mv ji mw bi translated">8.1.什么是MinMaxScaler？</h2><p id="ab02" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">最小最大缩放器重新缩放数据集，使得所有特征值都在范围[0，1]内。最小-最大缩放通常通过以下等式完成:</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ni"><img src="../Images/e82319e606914775b2c817c17cecd8d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*cSmd76A5REjY3ZQ8Fw1FrQ.png"/></div></figure><h1 id="6d66" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">9.最终分类模型</h1><p id="f43b" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">我们将建立两个神经网络来预测群体，然后在集成建模中结合这些神经网络的结果。<strong class="jm hj">集合模型</strong>集合每个基础模型的预测，并对未知数据产生一次最终预测。</p><p id="af00" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">首先，我们将迄今为止设计的所有特性进行堆叠。来自数据和两个模型的预测的7个特征。因此，我们总共有9个特征，目标变量是train_data.group。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nj"><img src="../Images/572f8d325c2555571e9c08650ad1a65d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*P7saZP-dhJ-cNsgwrLQLPw.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">用于最终分类模型的特征</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nk"><img src="../Images/5729766ef9d22ab80c7050340e99dac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*VDudVCDTUlqhayQzgxDm1w.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">最终分类模型的目标变量</figcaption></figure><h2 id="b267" class="mj in hi bd io mk ml mm is mn mo mp iw jr mq mr ja jt ms mt je jv mu mv ji mw bi translated">9.1.神经网络1</h2><p id="53b2" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">这个神经网络来自<a class="ae kx" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank"> Kaggle讨论页面</a></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nl"><img src="../Images/53f4fd248ce127591568f330060549e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5lZvg-Z_f1FD19ugxHna2g.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">神经网络代码</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nm"><img src="../Images/2d58043d8d0cddc621c73cec998ee43e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*dSyHpi5rzSREg-GfZ1PGqQ.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">神经网络1摘要</figcaption></figure><p id="24d9" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">通过在sklearn的train_test_split()中使用不同的随机种子对训练数据进行多次拆分，我们使用多个模型进行训练，得到的平均验证损失为2.23947。</p><p id="8563" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">验证预测可以使用以下混淆矩阵进行可视化:</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nn"><img src="../Images/acd0ed8f2795615b0797bb2e7a2cd1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UGUIh4nsjHY4utJchb9L4Q.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">使用神经网络1进行验证预测的混淆矩阵</figcaption></figure><p id="6151" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">我们可以观察到，正确预测数量最多的是M23–26类，其次是M32–38、M39+等。</p><h2 id="3375" class="mj in hi bd io mk ml mm is mn mo mp iw jr mq mr ja jt ms mt je jv mu mv ji mw bi translated">9.2.神经网络2</h2><p id="f1d2" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">这个架构也是从<a class="ae kx" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank"> Kaggle讨论页面</a>中引用的。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es no"><img src="../Images/3c3dacbeae86f294ad59c7039e6b29b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgS8ZZLPdODbFOcG7KELiw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">神经网络2架构</figcaption></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es nm"><img src="../Images/fa61acebc6f5e3d2caea0aca456b7ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*Uzyd45Zvp7g2kq5YR7vSRg.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">神经网络2摘要</figcaption></figure><p id="e022" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">像神经网络1一样，我们将训练数据分成几个训练和验证集，得到平均验证损失为2.24441。</p><p id="6016" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">让我们设想一下神经网络2的验证预测。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es np"><img src="../Images/66d2a46552f9be5bf7cd0642ef510b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovRMA5jH_39hY59fwgeQXw.png"/></div></div></figure><p id="9f25" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">该模型的正确预测数量减少。</p><h1 id="4fe0" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">10.集成建模</h1><p id="877e" class="pw-post-body-paragraph kh ki hi jm b jn jo kj kk jp jq kl km jr kn ko kp jt kq kr ks jv kt ku kv jx hb bi translated">集成建模是运行两个或更多相关但不同的分析模型，然后将结果合成为单个分数或分布，以提高预测分析的准确性的过程。</p><p id="f12e" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">在预测建模和其他类型的数据分析中，基于一个数据样本的单一模型可能会有偏差、高度可变性或完全不准确，从而影响其分析结果的可靠性。(来源— <a class="ae kx" href="https://searchbusinessanalytics.techtarget.com/definition/Ensemble-modeling" rel="noopener ugc nofollow" target="_blank">页面</a>)</p><p id="2c83" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">通过实验，我们可以找到正确的权重，以找到神经网络1和神经网络2的预测的加权平均值。</p><p id="181c" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">测试数据的最佳得分是当神经网络1被赋予0.1的权重而神经网络2被赋予0.9的权重时</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nq"><img src="../Images/8e6bb153113216a86b3744f414b2add0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHQN-rO3eXwjZ6F7yCxnYA.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">预测的加权平均值</figcaption></figure><p id="8c8e" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">最后的预测是</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nr"><img src="../Images/88fe64710e40d783bbeebfbad60a9d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LWrLMyewNc0ZcHiWCBzVJA.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">最终预测数据框架</figcaption></figure><p id="1f00" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">提交完submissions_final.csv文件后，我得到了以下分数。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ns"><img src="../Images/22462e64cb1e11827c25873c41808cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*ROo7JzsthVaVM4LKORQNtw.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">KAggle分数</figcaption></figure><h1 id="98d0" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">11.进一步的改进</h1><ol class=""><li id="d5e4" class="jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">这是我尝试过的一种方法，通过它我得到了很好的结果。我也尝试了其他方法，但无法获得良好的效果。另一个可以尝试的方法来自这个<a class="ae kx" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/22367" rel="noopener ugc nofollow" target="_blank"> Kaggle讨论页面</a>。</li><li id="824f" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">我还上传了Jupyter笔记本，上面记录了我试图在我的<a class="ae kx" href="https://github.com/yashmarathe21/TalkingDataUserDemographics" rel="noopener ugc nofollow" target="_blank"> Github库</a>中寻找解决方案的不同方法。请随意尝试改进这些方法。</li><li id="69ed" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">不同的神经网络结构可用于进一步降低测井曲线损失。</li><li id="5839" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">在集合模拟中使用权重的实验。</li></ol></div><div class="ab cl nt nu gp nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="hb hc hd he hf"><p id="aa13" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">这是我第一篇关于数据科学问题的中型文章。对于这个难题，已经有很多解决方案了。我尝试使用一种新的方法，这种方法在Kaggle讨论或Github解决方案中没有提到。你可以在我的<a class="ae kx" href="https://github.com/yashmarathe21/TalkingDataUserDemographics" rel="noopener ugc nofollow" target="_blank"> Github知识库</a>中找到我的完整解决方案，如果你有任何建议，请评论或通过<a class="ae kx" href="https://www.linkedin.com/in/yash-marathe-a3658917b/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我</p><p id="c4ef" class="pw-post-body-paragraph kh ki hi jm b jn ky kj kk jp kz kl km jr la ko kp jt lb kr ks jv lc ku kv jx hb bi translated">感谢您的阅读！！</p><h1 id="dcf1" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">12.参考</h1><ol class=""><li id="0cef" class="jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><a class="ae kx" rel="noopener" href="/analytics-vidhya/talking-data-user-demographics-19e3d15627b5">https://medium . com/analytics-vid hya/talking-data-user-demographics-19e 3d 15627 b5</a></li><li id="775c" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated"><a class="ae kx" href="https://github.com/AbhishekAnand18/Talking_Data_User_Demographics" rel="noopener ugc nofollow" target="_blank">https://github . com/abhishekand 18/Talking _ Data _ User _ Demographics</a></li><li id="cffa" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated"><a class="ae kx" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/talking data-mobile-user-demographics/discussion/23424</a></li><li id="abe1" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated"><a class="ae kx" href="https://github.com/yiqingyang75/kaggle-TalkingData-Mobile-User-Demographics" rel="noopener ugc nofollow" target="_blank">https://github . com/Yiqing yang 75/ka ggle-talking data-Mobile-User-Demographics</a></li><li id="4c70" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated"><a class="ae kx" href="https://github.com/jonasca/TalkingData" rel="noopener ugc nofollow" target="_blank">https://github.com/jonasca/TalkingData</a></li></ol></div></div>    
</body>
</html>