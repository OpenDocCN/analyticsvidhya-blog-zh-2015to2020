<html>
<head>
<title>Spark CSV Deep Dive-part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">火花CSV深潜-第二部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/spark-csv-deep-dive-part-ii-6d3389904f71?source=collection_archive---------9-----------------------#2019-11-30">https://medium.com/analytics-vidhya/spark-csv-deep-dive-part-ii-6d3389904f71?source=collection_archive---------9-----------------------#2019-11-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f62b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我上一篇文章的延续</p><div class="jd je ez fb jf jg"><a rel="noopener follow" target="_blank" href="/@somanathsankaran/pyspark-csv-reader-deep-dive-6096cb2c2880"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">pyspark csv阅读器深度潜水</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">大家好，spark是大数据世界中的一个伟大框架。</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">medium.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><p id="1c13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章包括处理</p><p id="055b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.清洗日期和时间戳</p><p id="53e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.压缩选项</p><p id="a53a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将处理日期格式和时间格式</p><p id="849a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我准备了一个适合我们所有用例的坏数据集</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es jw"><img src="../Images/1188e188efd4d9018a22d42545206e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*deBDhVuWbWorLHwe6YCBWw.png"/></div></figure><p id="ad96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将尝试导入更容易的数据库样式的模式，并使用Dtypes验证模式</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/8a56988947f353cf4ab137cab31a9120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_MSMM6mH6gPts8t3032vQ.png"/></div></div></figure><p id="9306" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看模式数据</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es ki"><img src="../Images/70df02f2045dfc4c1e7bcdfda68cd7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*d5Dccf3l4fPt2aL5uG1sRQ.png"/></div></div></figure><p id="867c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:。清洗日期和时间戳</strong></p><p id="4cc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所示，由于发布日期和时间戳格式，所有内容都为空。默认情况下，spark会以` ` yyyy-MM-dd'T'HH:mm:ss格式显示时间戳或日期。SSSXXX '</p><p id="e14e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在spark中，我们可以选择在加载数据时使用dateFormat="dd-MM-YYYY "，timestampFormat="dd/MM/YY HH:mm "来指定日期格式和时间戳格式</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kj"><img src="../Images/26f97cc8da1097fccf791815fb62cfa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZyGlgvE_UHgkIeNUDT_tA.png"/></div></div></figure><p id="32f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以看到日期和时间戳列已经修复</p><p id="e2a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:压缩选项</strong></p><p id="b47f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">火花csv阅读器有能力阅读以下压缩文件</p><pre class="jx jy jz ka fd kk kl km kn aw ko bi"><span id="fe92" class="kp kq hi kl b fi kr ks l kt ku">bzip2, deflate, uncompressed, lz4, gzip, snappy</span></pre><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kv"><img src="../Images/41c1ad616cfe79499cc796ae697bae94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YXtzNden6XfVeiqX20_KaA.png"/></div></div></figure><p id="7a49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但问题是所有的数据将作为一个单一的任务加载，所以请微调执行器的内存来容纳所有的数据</p><p id="914b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第四步:探索其他选择</p><p id="8b5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们对scala语法有一些基本的了解，我们都可以探索其他选项</p><h1 id="768e" class="kw kq hi bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">CSVOptions.scala</h1><p id="dee0" class="pw-post-body-paragraph if ig hi ih b ii lt ik il im lu io ip iq lv is it iu lw iw ix iy lx ja jb jc hb bi translated">下一个教程:<a class="ae ly" rel="noopener" href="/@somanathsankaran/spark-select-and-select-expr-deep-dive-d63ef5e04c87">https://medium . com/@ somanathsankaran/spark-select-and-select-expr-deep-dive-d 63 ef 5 e 04 c 87</a></p><p id="843f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Github链接:Github链接:<a class="ae ly" href="https://github.com/SomanathSankaran/spark_medium/tree/master/spark_csv" rel="noopener ugc nofollow" target="_blank">https://Github . com/SomanathSankaran/spark _ medium/tree/master/spark _ CSV</a></p><p id="8d82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"/></p><p id="5092" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">学习并让别人学习！！</strong></p></div></div>    
</body>
</html>