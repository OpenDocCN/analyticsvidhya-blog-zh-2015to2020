<html>
<head>
<title>Image Augmentation using Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Keras的图像增强</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-augmentation-using-keras-99072b490c72?source=collection_archive---------5-----------------------#2020-11-09">https://medium.com/analytics-vidhya/image-augmentation-using-keras-99072b490c72?source=collection_archive---------5-----------------------#2020-11-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7c5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用神经网络和深度学习模型时，需要进行数据准备。在更复杂的目标识别任务中也越来越需要数据扩充。</p><p id="0eeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据扩充意味着增加数据量。换句话说，拥有更大的数据集意味着更健壮的模型。但是获取更多的数据并不总是那么容易，而且可能存在存储数据并将其输入模型的问题。</p><p id="0c5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了缓解这个问题，我们可以通过做一些更改来手动增加数据，或者我们可以利用Keras图像预处理类之一，只需几行代码就可以做到这一点。</p><p id="81ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本帖中，我们将了解在使用Python和Keras开发和评估深度学习模型时，如何使用图像数据集进行数据准备和数据扩充。</p><p id="cedc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看完这篇帖子，你会了解到:</p><ol class=""><li id="cf2a" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">关于Keras提供的图像增强API以及如何在你的模型中使用它。如何进行特征标准化？</li><li id="ac0f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如何执行你的图像ZCA白化？</li><li id="484f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如何用随机旋转、移位和翻转来扩充数据？</li><li id="0a35" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如何将增强的图像数据保存到磁盘。</li></ol><p id="ada4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Keras图像增强API: ImageDataGenerator </strong></p><p id="c3ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它从原始批次生成批量的扩充数据。它获取图像，对其应用一些随机变换，并产生新的一批用于训练。</p><p id="0c73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong> <em class="jr">这里需要注意的一点是，ImageDataGenerator并不返回原始图像，而是返回批量的扩充数据，这是对原始数据进行一些转换的结果。</em></p><p id="a870" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">加载数据集</strong></p><p id="68bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用MNIST手写数字识别进行数据扩充。执行以下代码将从<em class="jr"> keras.datasets </em>加载MNIST数据集</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/e565d08f55f0e4f6365b96ed9380c46e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*eGMHqko55LM6ZnwAGNEkNg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">将数据分成训练和测试</figcaption></figure><h2 id="98d9" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak">标准化功能</strong></h2><p id="8132" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">像素标准化在两个层面上得到支持:或者是每个图像(称为样本方式)或者是每个数据集(称为特征方式)。具体而言，标准化像素值所需的平均值和/或平均值和标准偏差统计可仅从每个图像中的像素值(样本方面)或跨整个训练数据集(特征方面)来计算。</p><p id="8cdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过在ImageDataGenerator类上设置featurewise_center和featurewise_std_normalization参数来执行功能标准化。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/a5736e70a596cbed629662cd3fce7f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Bk_UoZLNMOtXhgOdEy0RA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">跨数据集标准化图像，平均值=0，标准偏差=1</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lj"><img src="../Images/e5d9df177d9199d767e33a7e2ecc9f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*0yJfkBivgHzSRjSDEBlQZQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><strong class="bd kg">输出图像:</strong>标准化特征</figcaption></figure><p id="c736" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行这个例子，你可以看到效果是不同的，似乎变暗和变亮不同的数字。</p><h2 id="b560" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak"> ZCA美白</strong></h2><p id="4a7c" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">图像的白化变换是减少像素图像矩阵中冗余的线性代数运算。通常，使用主成分分析(PCA)技术来执行图像白化。最近，一种称为ZCA的替代方法显示了更好的结果，并且在变换后的图像中保持了所有的原始尺寸，并且与PCA不同，得到的变换后的图像看起来仍然像它们的原始图像。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lk"><img src="../Images/cb9c7793a2b219711276977160557ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*-9GD0wT-xyo10DXs79hLuw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">ZCA美白</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ll"><img src="../Images/6e9816f878b2539b08f9114a4024e7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*IZWpSrJxDd7jI6OP8FqrLw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><strong class="bd kg">输出图像:</strong> ZCA</figcaption></figure><p id="f227" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行这个例子，你可以看到效果是不同的，似乎变暗和变亮不同的数字。</p><h2 id="5596" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak">随机旋转</strong></h2><p id="89cd" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">通过在训练过程中人工随机旋转数据集中的图像，可以训练模型更好地处理图像的旋转。下面的示例通过设置rotation_range参数来创建MNIST位数的90度随机旋转。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lm"><img src="../Images/78bfa301ee1285582c870d99819f1189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*p3K9OcBnupFJCML26VDbjg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">旋转90度</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ln"><img src="../Images/5dcc00924ac6218a427c5e98c3e32f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*nrF_3ldQ-_rGnc97FPcWIQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><strong class="bd kg">输出图像:</strong>随机旋转</figcaption></figure><p id="4500" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以看到图像被左右旋转了90度。这在这个问题上没有帮助，因为MNIST数字具有归一化的方向，但是当从物体可能具有不同方向的照片中学习时，这种变换可能是有帮助的。</p><h2 id="2993" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak">随机移位</strong></h2><p id="4529" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">图像中的对象可能不在框架的中心。它们可能以各种不同的方式偏离中心。你可以通过人工创建训练数据的移位版本，来训练你的深度学习网络预期和当前处理偏离中心的对象。Keras支持通过width_shift_range和height_shift_range参数对训练数据进行单独的水平和垂直随机移动。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lo"><img src="../Images/dc062c35310a77c7024fca59813046cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*de4mxNt7u06oAtEts8OdoA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">移动宽度和高度</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lp"><img src="../Images/94745857173ecbed7e7054748819b14e.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*Y88WUDrELAhdzwpRx25bng.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><strong class="bd kg">输出图像:</strong>随机偏移</figcaption></figure><p id="3087" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，这对于MNIST来说不是必需的，因为手写数字已经居中，但是您可以看到这对于更复杂的问题域是如何有用的。</p><h2 id="02e6" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak">随机翻转</strong></h2><p id="c0ce" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">对图像数据的另一个增强是在训练数据中创建图像的随机翻转，这可以提高处理大型复杂问题的性能。Keras使用vertical_flip和horizontal_flip参数支持沿垂直轴和水平轴的随机翻转。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lq"><img src="../Images/2e858a85658ed8dfbe10883a2bfae711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BabNyzsNExIPNu2x3J0iRg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">水平和垂直翻转</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ll"><img src="../Images/6fdb9433520eb7016047bb8eec87036b.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*L7ZSpvliA-1HK5gCDAg2kA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><strong class="bd kg">输出图像:</strong>随机翻转</figcaption></figure><p id="d748" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">翻转手指没有用，因为它们总是具有正确的左右方向，但是对于场景中可能具有不同方向的对象照片的问题，这可能是有用的。</p><p id="e652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jr">你可以在这里找到代码:</em> <a class="ae lr" href="https://github.com/Prachi-Gopalani13/Image-Augmentation-Using-Keras" rel="noopener ugc nofollow" target="_blank"> <em class="jr"> Github链接</em> </a></p><p id="0808" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">感谢阅读！</strong></p><p id="0fba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">干杯！</strong></p></div></div>    
</body>
</html>