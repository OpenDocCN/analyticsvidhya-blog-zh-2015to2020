<html>
<head>
<title>Linear Regression using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-using-python-ce21aa90ade6?source=collection_archive---------0-----------------------#2018-09-04">https://medium.com/analytics-vidhya/linear-regression-using-python-ce21aa90ade6?source=collection_archive---------0-----------------------#2018-09-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/f9ea654176ecd8f169ccae2428b63767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LMnOtbhwVJGZuhHv"/></div></div></figure><h1 id="2569" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">回归的意义</h1><p id="72f7" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">回归试图预测一个因变量(通常用Y表示)和一系列其他变化的变量(称为自变量，通常用X表示)。</p><h1 id="9a49" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">线性回归</h1><p id="3f26" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">线性回归是一种根据单个预测变量X预测响应Y的方法。假设X和Y之间近似呈线性关系。从数学上讲，我们可以将这种关系表示为:</p><p id="b027" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">y≈ɒ+x+ℇ</p><p id="dade" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">其中，ɒ和是两个未知常数，代表线性模型中的截距和斜率项，ℇ是估计中的误差。</p><h2 id="e979" class="kz iz hi bd ja la lb lc je ld le lf ji kh lg lh jm kl li lj jq kp lk ll ju lm bi translated">例子</h2><p id="8783" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">让我们举一个最简单的例子。仅用两个数据点计算回归。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es ln"><img src="../Images/f1b8187f1fd8dfc3fe4c7851d84d348a.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*k1Z38KQIi7uCkVnokaU91g.png"/></div></figure><p id="5c8f" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">这里我们有两个数据点，用两个黑点表示。当我们计算回归线时，我们要做的就是画一条尽可能接近每一点的线。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es lo"><img src="../Images/8912495e7eee234ecace3e31e945b4a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*jWPqE9sfBIA6xi_FrITtUw.png"/></div></figure><p id="2bb0" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">这里，我们有一条完美拟合的线，因为我们只有两个点。现在，我们必须考虑有2个以上数据点的情况。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es lp"><img src="../Images/b1114b682f454d7f1e630638a10ad0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*Fqr_rsUkpKoggwAoySBVEQ.png"/></div></figure><p id="73e2" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">通过应用线性回归，我们可以获得多个X值，并预测相应的Y值。如下图所示:</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es lq"><img src="../Images/a46174284d1a35f3c3c1aafde03a552d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*Zy-MLGX3G4qMwojhABtdgg.png"/></div></figure><p id="2171" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">我们线性回归的目标是最小化所有数据点和我们的直线之间的垂直距离。</p><p id="b9ea" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">现在我想，你已经对线性回归的目标有了一个基本的概念。</p><h1 id="4b29" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">Python代码</h1><p id="bfbc" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">首先，让我们导入库:</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="b555" class="kz iz hi ls b fi lw lx l ly lz">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt   #Data visualisation libraries <br/>import seaborn as sns<br/>%matplotlib inline</span></pre><p id="b5db" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">下一步是导入和检出数据。</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="d5ff" class="kz iz hi ls b fi lw lx l ly lz">USAhousing = pd.read_csv('USA_Housing.csv')<br/>USAhousing.head()<br/>USAhousing.info()<br/>USAhousing.describe()<br/>USAhousing.columns</span></pre><p id="01bb" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">这里，我使用USA_Housing.csv作为示例数据集。探索数据集总是一个好的做法。尝试使用您自己的文件并运行上面的代码来获取关于数据集的所有可能的信息。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es ma"><img src="../Images/97a2cc4c6527255ed2ee82a29412ff2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NPacEnK1MBcc3NAkZGUYA.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">我的数据集的前五条记录的快照</figcaption></figure><p id="3523" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">在这里，我认为价格是因变量，其余的是自变量。这意味着我必须预测给定独立变量的价格。</p><p id="8fbd" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">现在是处理数据和创建一些可视化的时候了。</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="e125" class="kz iz hi ls b fi lw lx l ly lz">sns.pairplot(USAhousing)</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mf"><img src="../Images/35c1c56735073539fa2fec5c5f70dbbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yl7D2V4sV5oBE3nR4etBJg.png"/></div></div></figure><p id="afbd" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">pairs图基于两个基本图形，直方图和散点图。对角线上的直方图允许我们看到单个变量的分布，而上下三角形上的散点图显示了两个变量之间的关系(或缺乏关系)。</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="023e" class="kz iz hi ls b fi lw lx l ly lz">sns.distplot(USAhousing['Price'])</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mg"><img src="../Images/22711659258ae9ef75030cc3b09b6e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*7YDyYNHiwrV_tvY26642nw.png"/></div></figure><p id="d690" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">开始研究单个变量的一个很好的方法是使用直方图。直方图将变量划分为多个区间，对每个区间中的数据点进行计数，并在x轴上显示区间，在y轴上显示计数。</p><h2 id="6b21" class="kz iz hi bd ja la lb lc je ld le lf ji kh lg lh jm kl li lj jq kp lk ll ju lm bi translated">相互关系</h2><p id="f39e" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">相关系数，或简称为相关性，是一个范围从-1到1的指数。当值接近零时，不存在线性关系。随着相关性越来越接近正负1，这种关系就越来越强。值为1(或负1)表示两个变量之间存在完美的线性关系。</p><p id="f6eb" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">让我们找出数据集中变量之间的相关性。</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="243f" class="kz iz hi ls b fi lw lx l ly lz">USAhousing.corr()</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mh"><img src="../Images/2bd27bacf89dfbc4668eb27b0a1c9e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G6EBXspYE8ct-t26l330VA.png"/></div></div></figure><p id="16de" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">现在，让我们使用热图来绘制相关性:</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mi"><img src="../Images/88fc4707348ea57c828a37480d1224cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*bjXMJKpyNKa1CNVRF8r7tQ.png"/></div></figure><p id="c352" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">黑色代表两个变量之间没有线性关系。较浅的阴影表示变量之间的关系更加线性。</p><h1 id="63fa" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">决定系数</h1><p id="15da" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">决定系数<strong class="jy hj"> </strong> R2是可由预测变量x解释的响应变量Y变化的分数(百分比)。其范围在0(不可预测性)到1(或100%)之间，表示完全可预测性。高R2表明能够以较小的误差预测响应变量。</p><h1 id="8cd8" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">训练线性回归模型</h1><p id="9391" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">让我们现在开始训练回归模型！我们需要首先将数据分成一个X数组和一个y数组，X数组包含要训练的特性，y数组包含目标变量，在本例中是Price列。我们将丢弃地址列，因为它只有线性回归模型无法使用的文本信息。</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="1212" class="kz iz hi ls b fi lw lx l ly lz">X = USAhousing[['Avg. Area Income', 'Avg. Area House Age', 'Avg. Area Number of Rooms',<br/>               'Avg. Area Number of Bedrooms', 'Area Population']]<br/>y = USAhousing['Price']</span></pre><h1 id="64e4" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">列车测试分离</h1><p id="ea0e" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">我们的目标是创建一个能很好地概括新数据的模型。我们的测试集充当新数据的代理。训练数据是我们应用线性回归算法的数据。最后，我们在测试数据上测试该算法。拆分的代码如下:</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="6759" class="kz iz hi ls b fi lw lx l ly lz">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.4, random_state=101)</span></pre><p id="7e6e" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">从上面的代码片段中，我们可以推断出40%的数据进入了测试数据，其余的保留在训练集中。</p><h1 id="5ab8" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">创建和训练模型</h1><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="2ff1" class="kz iz hi ls b fi lw lx l ly lz">from sklearn.linear_model import LinearRegression<br/>lm = LinearRegression()<br/>lm.fit(X_train,y_train)</span></pre><p id="52fd" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">上面的代码符合训练数据的线性回归模型。</p><h1 id="912c" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">我们模型的预测</h1><p id="0259" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">让我们从测试集中抓取预测，看看它做得有多好！</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="e272" class="kz iz hi ls b fi lw lx l ly lz">predictions = lm.predict(X_test)</span></pre><p id="ad8e" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">让我们想象一下这个预测</p><pre class="in io ip iq fd lr ls lt lu aw lv bi"><span id="bd45" class="kz iz hi ls b fi lw lx l ly lz">plt.scatter(y_test,predictions)</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mj"><img src="../Images/39fd4b808121c48a1e91708fb52e01e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*kMXhgrUwMHa9IqQqiC_DzQ.png"/></div></figure><p id="1735" class="pw-post-body-paragraph jw jx hi jy b jz ku kb kc kd kv kf kg kh kw kj kk kl kx kn ko kp ky kr ks kt hb bi translated">一个相当好的工作已经完成，一个线性模型已经获得！</p></div></div>    
</body>
</html>