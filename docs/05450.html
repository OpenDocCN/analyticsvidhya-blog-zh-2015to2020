<html>
<head>
<title>Chatbot for Covid19 cases in india and hosting it in the website and getting real time information</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">聊天机器人在印度的Covid19案件，并在网站上托管它，并获得实时信息</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/chatbot-for-covid19-cases-in-india-and-hosting-it-in-the-website-angetting-real-time-information-1513a951e357?source=collection_archive---------18-----------------------#2020-04-21">https://medium.com/analytics-vidhya/chatbot-for-covid19-cases-in-india-and-hosting-it-in-the-website-angetting-real-time-information-1513a951e357?source=collection_archive---------18-----------------------#2020-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="66ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个聊天机器人将有助于获得印度各邦的covid19病例信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/4369dcb9561ec3bfdb2455a888e956af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8Qn5PLk92j2D0AN8pKJMA.jpeg"/></div></div></figure><p id="3885" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Rasa框架用于开发聊天机器人，该机器人将提供有关印度各邦covid 19病例的信息。Rasa是一个开源的机器学习框架，帮助我们开发人工智能特色的聊天机器人。</p><p id="afd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Rasa的架构:它是如何处理消息和回复的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/3c81b278b9391edfc18152b6d10f61a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ToEt40v8VIZ_47g5yvfX4Q.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">Rasa消息处理框架</figcaption></figure><ol class=""><li id="213c" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">用户通过消息与聊天机器人交流，消息被接收并传递给解释器，解释器将其转换为字典并包括原始消息和意图。这是由NLU处理的。该文件位于chatbot项目文件夹中的NLU.md。</li></ol><p id="c673" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">示例:显示卡纳塔克邦的covid19病例</p><p id="4dc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此消息中，意图是显示，实体是covid19和卡纳塔克邦。这将被NLU翻译成词典。</p><p id="605d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.跟踪器是跟踪来自用户的消息的对象。</p><p id="e191" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.策略接收跟踪器的当前状态，并决定下一步采取什么行动。</p><p id="2f74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.现在采取什么行动取决于用户的问题</p><p id="ee45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.跟踪器跟踪所采取的行动。</p><p id="185c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.将响应发送给用户。</p><p id="76b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">启动项目的步骤:</p><p id="5406" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">先决条件:Rasa应该安装在系统中。</p><p id="99f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">初始化项目文件夹中的Rasa，命令是<rasa init="">，它将初始化项目文件夹中的初始聊天机器人。项目文件夹将包含所有必需的文件。</rasa></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/c1c846690123097a2d74da995e9c6972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XX_lcVUhW0s8-hiT50YG_A.png"/></div></div></figure><p id="162a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">项目目录结构将需要开发聊天机器人的文件。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/7cc01ecc79b211227a8142826cf870a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*izCTiVnEMwlpj30ad8sOvw.png"/></div></figure><p id="837b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开发环境的设置已经完成。现在将开始编写获取COVID19 statewise信息的意图和实体。Data foldet包含nlu.md文件，将打开该文件并开始编写与covid19搜索相关的意图。训练模型需要这些数据。</p><p id="1c8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">nlu.md文件快照:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/45b1827e9c2a5b8710aab8a9143e1350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXBfbzRqPM9MYjjQX_jGOA.png"/></div></div></figure><p id="1009" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是在stories.md文件中为covid_state意图创建故事。故事不过是它将如何跟随对话路径的路径。covid_sate意图必须存在于stories.md文件中，因为这是定义对话路径所必需的。它应该与nlu.md文件中定义的名称相同。</p><p id="1774" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">故事路径:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kg"><img src="../Images/60dc156f6a3e1bfbc45db8b97ffa438a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_5umxUkBKdqlEvau2yKsA.png"/></div></div></figure><p id="82ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">stories.md文件中存在相同的意图“covid_state”。bot一旦发现意图会如何响应，路径是通过定义“atction _ state”来定义的。这个“action_state”必须存在于domain.yml文件和action.py文件中。</p><p id="6c2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，将打开domain.yml文件，在实体块中定义实体，在动作块中定义action_state。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/d40c1664849bd3a4cc236edbbad3e464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mLWDRkSpFygrADXhZd3evA.png"/></div></div></figure><p id="7c46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步将是决定用户的动作或响应或消息。响应写在action.py文件中。</p><p id="b385" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">action.py文件可以调用数据库或文件，从中获取印度州的covid相关数据。</p><p id="02d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个问题的答案在action.py文件下。</p><p id="a491" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用户向聊天机器人提出的问题:</p><p id="8bc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卡纳塔克邦的covid病例？</p><p id="c061" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">聊天机器人应该能够实时给出这个查询的响应。但是问题是聊天机器人如何获得这些数据来回复用户。有提供实时数据的开放api。将使用该api为机器人获取数据。</p><p id="1fbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">json数据api托管在下面的链接中，我们的聊天机器人模型将使用这个链接。</p><p id="0c29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ki" href="https://api.covid19india.org/data.json" rel="noopener ugc nofollow" target="_blank">https://api.covid19india.org/data.json</a></p><p id="7f62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">action.py文件将对用户查询的响应进行组织。在action.py中将导入requests包，该包将用于从上述api获取json数据请求。该方法向json api请求covid数据，并将其过滤出来以获得适当的查询响应。该方法的代码快照如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kj"><img src="../Images/1d7ff4c0d8583b9100e8a48227809fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldcDynTf3mebkuxGexuEng.png"/></div></div></figure><p id="2965" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">聊天机器人差不多准备好了，将修改enpoints.yml文件并训练模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/7e2ab22d9d460c169e4efc0917047438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZR5GGfUCi4DK8gNvaWpwA.png"/></div></div></figure><p id="ab6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编码部分完成后，就该训练模型了。</p><p id="8dbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练模型的命令是<rasa train="">，这将在模型文件夹下创建新的训练模型。</rasa></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/2014f4231c0dcb659d077006a3977fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*nvqi8y5_vd-D9V7tG5T7Qg.png"/></div></figure><p id="4fd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练模型需要几分钟，同时运行动作<rasa run="" action=""/></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es km"><img src="../Images/aa54e8ffe09dfd9c344f6aae000256f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y3EoEmy_13Zad26J5vKdJA.png"/></div></div></figure><p id="0509" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦模型被训练，将开始与聊天机器人相关的covid19案件明智的在印度。</p><p id="b712" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开始与聊天机器人交谈:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kn"><img src="../Images/73c4a9f41a2eb0121f776f7c75e386ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4u2zvqLkk__kFQB_bPF6w.png"/></div></div></figure><p id="6eb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是定期更新的实时数据。</p><p id="9de3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将此聊天机器人与网站集成:</p><p id="7b7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在网站中托管聊天机器人，credentials.yml将被修改以添加socketio，打开credentials.yml文件并添加以下行:</p><p id="50f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">socket io:<br/>user _ message _ evt:user _ outleted<br/>bot _ message _ evt:bot _ outleted<br/>session _ persistence:true</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/a32aa188f04b3d1db71fc995e2630a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tgDk_mzcIiqW2yglxz8Ocg.png"/></div></div></figure><p id="1f3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是创建一个运行这个机器人的html页面，并将这些脚本添加到html文件的body标签中。</p><p id="7362" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><div id="”webchat”/"> <br/> &lt;脚本src = "<a class="ae ki" href="https://storage.googleapis.com/mrbot-cdn/webchat-latest.js" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/mrbot-cdn/webchat-latest.js</a>"&gt;&lt;/脚本&gt; <br/> //或者你可以用特定版本替换最新<br/> &lt;脚本&gt;<br/>webchat . default . init({<br/>选择器:" #webchat "，<br/> initPayload: "/get_started "，<br/>custom data:{ " language ":" en " }，//任意自定义数据。保持最小化，因为这将被添加到socket<br/>socket URL:"<a class="ae ki" href="http://localhost:5005" rel="noopener ugc nofollow" target="_blank">http://localhost:5</a>000 "，<br/> socketPath: "/socket.io/"，<br/> title: "Rasa bot demo "，<br/> subtitle: "Subtitle "，<br/> }) <br/> &lt; /script &gt;</div></p><p id="dd7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来是运行模型并在html页面的脚本中修改端口号。</p><p id="3b2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">rasa run -m型号—启用-api — cors "*" —调试</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/5bd46979542ded9b8def4952479accc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfhywyGISeQtVKVxi0HBeQ.png"/></div></div></figure><p id="57a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据上面的输出修改html文件的端口号。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kq"><img src="../Images/a82ff005063838a47ab7dce3b3654972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nvYIZMiyB-axJmc7SYJZdw.png"/></div></div></figure><p id="13c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一切就绪，请确认以下事项:</p><ol class=""><li id="526c" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">验证操作正在运行，如果没有运行<rasa run="" action=""/></li><li id="f569" class="ju jv hi ih b ii kr im ks iq kt iu ku iy kv jc jz ka kb kc bi translated">验证命令正在运行，并将端口与此命令输出和html文件匹配，如果不匹配，请修改html文件端口。</li></ol><p id="d5c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">rasa run -m型号—启用-api — cors "*" —调试</p><p id="ee15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候和机器人聊天，获取印度各邦covid 19的信息了。</p><p id="ab9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转到项目文件夹，在chrome浏览器中打开index.html文件，开始与bot对话。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/832cd4ae57d717578cc88d926cbeeb06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-uU5Xerd14_PE6f7-NBYw.png"/></div></div></figure><p id="7d5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请点击github链接获取完整源代码:</p><p id="9757" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ki" href="https://github.com/rikesh-DS/indiacovid19bot.git" rel="noopener ugc nofollow" target="_blank">https://github.com/rikesh-DS/indiacovid19bot.git</a></p></div></div>    
</body>
</html>