<html>
<head>
<title>A Bayesian View on COVID-19 Outbreak</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从贝叶斯角度看新冠肺炎疫情</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-bayesian-view-on-covid-19-outbreak-4250dbcda6e7?source=collection_archive---------40-----------------------#2020-05-11">https://medium.com/analytics-vidhya/a-bayesian-view-on-covid-19-outbreak-4250dbcda6e7?source=collection_archive---------40-----------------------#2020-05-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="76f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">茂物通勤线上的研究案例和估计新冠肺炎感染率的贝叶斯方法</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/149f4dcc1be38ee82128afe35765170f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*ByRwp8g4tYhGwJVS03NuHA.jpeg"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">资料来源:LACOL.net</figcaption></figure><h1 id="3cd1" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">茂物通勤线上的新冠肺炎测试</h1><p id="0cc7" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">通勤线路在当地被称为<em class="jd"> Kereta Rel Listrik </em> (KRL)，是Jabodetabek最繁忙的交通方式之一。它每天运送近141，330名乘客，即使是在物理距离遥远的“PSBB”。周一(2020年5月11日)，茂物区政府对<strong class="ih hj"> 200名KRL乘客</strong>的样本进行快速拭子检测。根据检测，他们发现<strong class="ih hj"> 1人</strong>被检测为新冠肺炎阳性。大致可以估算出，每200名乘客中，就会有1人检测为阳性(感染率0.5%)。然而，仅通过将这两个数字相除来估计感染率可能是不切实际的。</p><h1 id="3279" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">估计传染率的贝叶斯定理</h1><p id="f03d" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">贝叶斯定理在数学上表述为以下等式:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/5c84c641aa628dad9bb8ce0f415b125c.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*CO1ilsZOPrtZI2_qqNQ98A.png"/></div></div></figure><p id="e5fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以“H”为假设，以“E”为证据，我们可以利用上面的等式来估计茂物KRL的感染率，给定周一的测试结果。我们的假设是:<br/> <em class="jd">感染率将是检测呈阳性的人与可用总人数的比例，用r表示</em> <br/>有证据显示，从接受检测的200名乘客中，只有1人新冠肺炎检测呈阳性。<br/>假设假设为真，该证据出现的概率将表示为二项分布PDF，如下所示</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ky"><img src="../Images/6cdb67ffe85e2ed97d3547334f152d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*Mgrj1ZsFQyWupfK3re8T_Q.png"/></div></figure><p id="9025" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用二项式模型和贝塔分布作为先验，我们可以通过使用贝叶斯定理找到后验。将上面的等式乘以β分布PDF后，我们知道后验概率也将是β分布，但具有更新的超参数(α= 1+1且β= 1+200–1的β分布)。</p><p id="4cb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为后验概率与先验概率属于同一个分布族，所以二项式模型的共轭先验概率就是贝塔分布。因此，后验分布将是β(2，200 ),表示为以下表达式</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kz"><img src="../Images/652b43f8554437e4ba45c278ce747455.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*G-Fv9ZhYhbj6RlyY7Mtmaw.png"/></div></figure><p id="1d8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过使用“for”循环或r中的sapply()函数迭代r的每个可能值来生成Beta分布图。</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="c09d" class="lf jr hi lb b fi lg lh l li lj">#define function for P(E|H)<br/>beta&lt;-function(r){<br/>  return(200*r*(1-r)^(199))<br/>}<br/>#possible values of r<br/>r&lt;-seq(from=0,to=5/100,by=0.1/100)<br/>#for loop<br/>p&lt;-c()<br/>for(i in 1:length(r)){<br/>  p[i]&lt;-print(beta(r[i]))<br/>}</span></pre><p id="7dfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者，我们也可以使用dbinom()函数或dbeta()函数直接生成beta分布图，两个函数将返回相同的图。</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="78b4" class="lf jr hi lb b fi lg lh l li lj">library(ggplot2)<br/>r&lt;-seq(from=0,to=5/100,by=0.1/100)<br/>#density plot<br/>dat&lt;-data.frame(r,dbinom(1,200,r))<br/>plot&lt;-ggplot(dat,aes(r,dbinom(1,200,r)))+<br/>  geom_point()+<br/>  geom_line(col='darkblue')<br/>plot</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lk"><img src="../Images/8bbd687e3907edf920c167889a04383c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jYekc0PP85E5b4WTPAp1fA.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">使用ggplot2包生成的图</figcaption></figure><p id="a196" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以贝塔分布为后验PDF，95%置信区间，通过寻找贝塔分布曲线下产生面积为0.95的上下界，我们可以说感染率的区间将为0.00121到0.02741 ( <strong class="ih hj"> 0.121%到2.741% </strong>)。</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="36c2" class="lf jr hi lb b fi lg lh l li lj">#lower bound (95% CI, two-tailed)<br/>qbeta(0.025,2,200)</span><span id="01e2" class="lf jr hi lb b fi ll lh l li lj">#upper bound (95% CI, two-tailed)<br/>qbeta(0.975,2,200)</span></pre><p id="c161" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，假设KRL列车内有1000人，大约有<strong class="ih hj"> 1人，直到27人</strong>新冠肺炎检测呈阳性。</p><h1 id="ccac" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="2872" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">除了SIR模型，这是一种估计新冠肺炎行为的确定性方法，我们还可以使用贝叶斯定理作为一种不同的方法来估计感染人数。使用这种方法的主要思想是考虑到病毒行为的随机性和不确定性。这个研究案例只是新冠肺炎在KRL乘客身上传播的一个简单例子。这种方法确实可以成为决策者在KRL的火车、车站甚至更大范围内确定预防措施的一种方式。</p></div></div>    
</body>
</html>