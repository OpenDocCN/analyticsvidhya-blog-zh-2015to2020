<html>
<head>
<title>Deno- JavaScript and TypeScript Runtime</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Deno- JavaScript和TypeScript运行时</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deno-javascript-and-typescript-runtime-557483bf7f22?source=collection_archive---------16-----------------------#2020-08-13">https://medium.com/analytics-vidhya/deno-javascript-and-typescript-runtime-557483bf7f22?source=collection_archive---------16-----------------------#2020-08-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8b6c9da63486942b7347c888de290b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNfIeo693HJnVwPGz1cRww.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">【图片来源:】<a class="ae iv" href="https://pexels.com/" rel="noopener ugc nofollow" target="_blank"><em class="iu">【https://pexels.com】</em></a></figcaption></figure><h2 id="696f" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">介绍</h2><p id="8d21" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated">大约两年前，Node.js的创始人Ryan Dahl 谈到了他对Node.js感到遗憾的十件事。同时，他介绍了DENO，这是一种新的、安全第一、无npm的JavaScript和typescript运行时的原型。最近<a class="ae iv" href="https://deno.land/" rel="noopener ugc nofollow" target="_blank"> DENO 1.0 </a>发布。</p><h2 id="6191" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">为什么是德诺？</h2><p id="3a36" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated">我们知道javascript是经过战场考验的web动态语言，我们无法想象没有JavaScript的web行业。通过像ECMA国际这样的标准组织，这种语言每天都在发展。很容易解释为什么是动态语言工具的自然选择，无论是在浏览器环境中还是作为独立的进程。</p><p id="b141" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">NodeJS:开源、跨平台、JavaScript运行时环境，由同一作者在大约十年前发明。人们发现它对web开发、工具、创建服务器和许多其他用例都很有用。在演示中，我们将详细讨论10件令人遗憾的事情。</p><p id="296f" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">现在，不断变化的JavaScript世界，以及像TypeScript这样的新补充，构建节点项目可能会成为一项有问题的工作，涉及管理构建系统和另一种剥夺动态语言脚本乐趣的重型工具。此外，链接到外部库的机制基本上是通过NPM库集中的，这不符合网络的理想。</p><h2 id="6e34" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">德诺</h2><p id="b918" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated">Deno是一个新的运行时，用于在web浏览器之外执行JavaScript和TypeScript。Deno试图为快速编写复杂功能的脚本提供一个完整的解决方案。[代码]</p><h2 id="e7d5" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">会取代NodeJS吗？</h2><p id="4a5d" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated">NodeJs是一个经过战场考验的平台，并且得到了令人难以置信的良好支持，它将每天都在发展。</p><h2 id="f11d" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">类型脚本支持</h2><p id="eee3" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated">在引擎盖下，deno基于V8、Rust和Tokio构建。<code class="du ku kv kw kx b">rusty_v8</code>箱为<code class="du ku kv kw kx b">V8's C++ API</code>提供高质量的防锈绑定。因此，很容易解释用特定的类型脚本编写意味着我们获得了类型脚本的许多好处，即使我们可能选择用普通的JavaScript编写代码。所以deno不需要typescript编译设置，deno会自动完成。</p><h2 id="40aa" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">Node与Deno</h2><p id="cc6e" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated">两者都是基于chrome V8引擎开发的，非常适合用JavaScript开发服务器端。Node用C++写，deno用Rust和typescript写。Node有正式的包管理器称为npm，而deno没有包管理器，代替包管理器deno从URL调用ES模块。Node使用CommonJS语法导入包，deno使用es模块。Deno在其所有API和标准库中使用现代ECMA脚本特性，而nodejs使用基于回调的标准库。Deno通过权限提供了一个安全层。Node.js程序可以访问用户可以访问的任何内容。</p><h2 id="c2a4" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">安装Deno</h2><p id="41bf" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated"><em class="ky">使用自制软件(macOS): </em></p><p id="043f" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated"><code class="du ku kv kw kx b">brew install deno</code></p><p id="3d5e" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated"><em class="ky">使用Powershell </em></p><p id="91e4" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated"><code class="du ku kv kw kx b">iwr https://deno.land/x/install/install.ps1 -useb | iex</code></p><p id="7619" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">通过<code class="du ku kv kw kx b">deno --version</code>测试您的安装，使用<code class="du ku kv kw kx b">deno -help</code>了解帮助文本，并使用<code class="du ku kv kw kx b">deno upgrade</code>升级先前安装的deno。</p><pre class="kz la lb lc fd ld kx le lf aw lg bi"><span id="b59c" class="iw ix hi kx b fi lh li l lj lk">deno 1.0.0<br/>    A secure JavaScript and TypeScript runtime<br/>    <br/>    Docs: <a class="ae iv" href="https://deno.land/std/manual.md" rel="noopener ugc nofollow" target="_blank">https://deno.land/std/manual.md</a><br/>    Modules: <a class="ae iv" href="https://deno.land/std/" rel="noopener ugc nofollow" target="_blank">https://deno.land/std/</a> <a class="ae iv" href="https://deno.land/x/" rel="noopener ugc nofollow" target="_blank">https://deno.land/x/</a><br/>    Bugs: <a class="ae iv" href="https://github.com/denoland/deno/issues" rel="noopener ugc nofollow" target="_blank">https://github.com/denoland/deno/issues</a><br/>    <br/>    To start the REPL:<br/>      deno<br/>    <br/>    To execute a script:<br/>      deno run <a class="ae iv" href="https://deno.land/std/examples/welcome.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std/examples/welcome.ts</a><br/>    <br/>    To evaluate code in the shell:<br/>      deno eval "console.log(30933 + 404)"<br/>    <br/>    USAGE:<br/>        deno [OPTIONS] [SUBCOMMAND]<br/>    <br/>    OPTIONS:<br/>        -h, --help                     Prints help information<br/>        -L, --log-level &lt;log-level&gt;    Set log level [possible values: debug, info]<br/>        -q, --quiet                    Suppress diagnostic output<br/>        -V, --version                  Prints version information<br/>    <br/>    SUBCOMMANDS:<br/>        bundle         Bundle module and dependencies into single file<br/>        cache          Cache the dependencies<br/>        completions    Generate shell completions<br/>        doc            Show documentation for a module<br/>        eval           Eval script<br/>        fmt            Format source files<br/>        help           Prints this message or the help of the given subcommand(s)<br/>        info           Show info about cache or info related to source file<br/>        install        Install script as an executable<br/>        repl           Read Eval Print Loop<br/>        run            Run a program given a filename or url to the module<br/>        test           Run tests<br/>        types          Print runtime TypeScript declarations<br/>        upgrade        Upgrade deno executable to given version<br/>    <br/>    ENVIRONMENT VARIABLES:<br/>        DENO_DIR             Set deno's base directory (defaults to $HOME/.deno)<br/>        DENO_INSTALL_ROOT    Set deno install's output directory<br/>                             (defaults to $HOME/.deno/bin)<br/>        NO_COLOR             Set to disable color<br/>        HTTP_PROXY           Proxy address for HTTP requests<br/>                             (module downloads, fetch)<br/>        HTTPS_PROXY          Same but for HTTPS</span></pre><h2 id="7c87" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">你的第一个Deno应用</h2><p id="48d1" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko hb bi translated">你好世界</p><p id="7f5a" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">这是一个简单的例子来教你关于deno的基础知识</p><p id="45d8" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated"><code class="du ku kv kw kx b">deno run <a class="ae iv" href="https://deno.land/std/examples/welcome.ts" rel="noopener ugc nofollow" target="_blank">https://deno.land/std/examples/welcome.ts</a></code></p><p id="2c74" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">发出HTTP请求</p><pre class="kz la lb lc fd ld kx le lf aw lg bi"><span id="fc1b" class="iw ix hi kx b fi lh li l lj lk">const url = Deno.args[0];<br/>const res = await fetch(url);<br/>const body = new Uint8Array(await res.arrayBuffer());<br/>await Deno.stdout.write(body);</span></pre><p id="e53a" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">让我们来看看这个应用程序做了什么:</p><ul class=""><li id="82e0" class="ll lm hi jw b jx kp kb kq jh ln jl lo jp lp ko lq lr ls lt bi translated">这里，我们将第一个参数传递给应用程序，并将其存储在变量URL中。</li><li id="65f9" class="ll lm hi jw b jx lu kb lv jh lw jl lx jp ly ko lq lr ls lt bi translated">然后，我们向指定的URL发出请求，等待响应，并将其存储在名为res的变量中。</li><li id="1550" class="ll lm hi jw b jx lu kb lv jh lw jl lx jp ly ko lq lr ls lt bi translated">然后我们将响应体解析为ArrayBuffer，等待响应，将其转换为Uint8Array，并存储在变量体中。</li><li id="b648" class="ll lm hi jw b jx lu kb lv jh lw jl lx jp ly ko lq lr ls lt bi translated">我们将主体变量的内容写入stdout。</li></ul><p id="c436" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">试试下面这个例子<code class="du ku kv kw kx b">deno run https://deno.land/std/examples/curl.ts https://example.com</code>你会看到一个关于网络访问的错误。那么是什么问题呢？我们知道Deno是一个默认安全的运行时。这意味着我们必须明确地给程序许可去做某些特权行为，比如网络访问。</p><p id="954e" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">再次选拔赛<code class="du ku kv kw kx b">deno run --allow-net=example.com https://deno.land/std/examples/curl.ts <a class="ae iv" href="https://example.com" rel="noopener ugc nofollow" target="_blank">https://example.com</a></code></p><p id="bf5c" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">简单TCP服务器这是一个简单服务器的例子，它接受端口8080上的连接，并向客户端返回它发送的任何信息。</p><pre class="kz la lb lc fd ld kx le lf aw lg bi"><span id="f517" class="iw ix hi kx b fi lh li l lj lk">const listener = Deno.listen({ port: 8080 });<br/>console.log("listening on 0.0.0.0:8080");<br/>for await (const conn of listener) {<br/>  Deno.copy(conn, conn);<br/>}</span></pre><p id="f1a1" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">出于安全原因，Deno不允许程序在没有明确许可的情况下访问网络。要允许访问网络，请使用命令行标志:</p><p id="b2e7" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated"><code class="du ku kv kw kx b">deno run --allow-net https://deno.land/std/examples/echo_server.ts </code>要测试它，请尝试使用netcat向它发送数据:</p><pre class="kz la lb lc fd ld kx le lf aw lg bi"><span id="a983" class="iw ix hi kx b fi lh li l lj lk">$ nc localhost 8080<br/>   hello world<br/>   hello world</span></pre><p id="fa37" class="pw-post-body-paragraph ju jv hi jw b jx kp jz ka kb kq kd ke jh kr kg kh jl ks kj kk jp kt km kn ko hb bi translated">与<code class="du ku kv kw kx b">cat.ts</code>示例一样，这里的<code class="du ku kv kw kx b">copy()</code>函数也不会进行不必要的内存复制。它从内核接收一个包并发送回来，没有进一步的复杂性。</p><h2 id="0321" class="iw ix hi bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">资源</h2><ul class=""><li id="64ff" class="ll lm hi jw b jx jy kb kc jh lz jl ma jp mb ko lq lr ls lt bi translated"><a class="ae iv" href="https://denoweekly.com/" rel="noopener ugc nofollow" target="_blank">德诺周刊</a></li><li id="bab0" class="ll lm hi jw b jx lu kb lv jh lw jl lx jp ly ko lq lr ls lt bi translated"><a class="ae iv" href="https://deno.land/manual" rel="noopener ugc nofollow" target="_blank">官方文件</a></li><li id="4cf3" class="ll lm hi jw b jx lu kb lv jh lw jl lx jp ly ko lq lr ls lt bi translated"><a class="ae iv" href="https://discord.gg/deno" rel="noopener ugc nofollow" target="_blank">社区不和组</a></li></ul></div></div>    
</body>
</html>