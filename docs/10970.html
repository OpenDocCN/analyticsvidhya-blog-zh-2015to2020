<html>
<head>
<title>Chinese Digit MNIST</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">中文数字 MNIST</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/chinese-digit-mnist-1b46f51e8f75?source=collection_archive---------3-----------------------#2020-11-11">https://medium.com/analytics-vidhya/chinese-digit-mnist-1b46f51e8f75?source=collection_archive---------3-----------------------#2020-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="172e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> MNIST 手写数字</strong>分类问题是计算机视觉和深度学习中使用的标准数据集。但是，如果数字是汉字呢？介绍中国数字 MNIST。ka ggle 页面链接:<a class="ae jd" href="https://www.kaggle.com/gpreda/chinese-mnist" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/gpreda/chinese-mnist</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/afaae79603fe6bf4a6453242d14a36e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PnAlCqalPm9HuvnbYiSvIA.png"/></div></div></figure></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="9756" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">中国数字概论</h1><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="9486" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上表显示了其对应的汉字值。现在，有了所有的基础，让我们跳上车吧！</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="640d" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">数据集</h1><p id="61ef" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">了解我们正在处理的数据总是好的。数据集有 15000 张图片，但是每张图片有多少张呢？因为我们有 15 个不同的字符，所以每个字符应该是 1000，但是让我们检查一下。<em class="lc">注意笔记本是在 Kaggle 上运行的。</em></p><ol class=""><li id="3344" class="ld le hi ih b ii ij im in iq lf iu lg iy lh jc li lj lk ll bi translated">数据分布</li></ol><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">获取数据分布的代码</figcaption></figure><p id="ad12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码将返回以下内容，即每个字符 1000 个图像！</p><pre class="jf jg jh ji fd lq lr ls lt aw lu bi"><span id="0617" class="lv jy hi lr b fi lw lx l ly lz">value      character<br/>0          零            1000<br/>1          一            1000<br/>2          二            1000<br/>3          三            1000<br/>4          四            1000<br/>5          五            1000<br/>6          六            1000<br/>7          七            1000<br/>8          八            1000<br/>9          九            1000<br/>10         十            1000<br/>100        百            1000<br/>1000       千            1000<br/>10000      万            1000<br/>100000000  亿            1000<br/>dtype: int64</span></pre><p id="2a55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.缺失数据？</p><p id="d1c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查是否有任何丢失的数据。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">用于评估缺失数据的代码</figcaption></figure><p id="3c9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码返回 0，表示数据集完全正常！安全总比后悔好！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ma"><img src="../Images/16c9c3503e82889fe897d54b49180b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*cQ6qyb_8n8DD4S0ESrszsA.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">缺失数据的结果</figcaption></figure><p id="15e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.缺失图像？</p><p id="1e79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查一下目录中是否有 15000 张图片。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><pre class="jf jg jh ji fd lq lr ls lt aw lu bi"><span id="8056" class="lv jy hi lr b fi lw lx l ly lz">Number of image files: 15000</span></pre><p id="ae74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">没错。我们可以走了！</p><blockquote class="mb mc md"><p id="13f1" class="if ig lc ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated"><em class="hi">注意图片在</em> <code class="du mh mi mj lr b">data/data</code> <em class="hi">的子目录里面。</em></p></blockquote><p id="bc33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.将图像属性附加到数据帧</p><p id="c1bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于输入图像的命名约定为“<code class="du mh mi mj lr b">input_[siote_id]_[sample_id]_[code].jpg</code>”，因此我们应该在 dataframe 中再添加一列，以便将来处理。此外，我们还应该指定图像的宽度和高度！</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="c7aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的代码向 dataframe 添加了三个新列，分别是“<code class="du mh mi mj lr b">file</code>”、“<code class="du mh mi mj lr b">w</code>”和“<code class="du mh mi mj lr b">h</code>”。我们的数据帧应该是这样的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mk"><img src="../Images/ef721fd450ad0b8aa9ee70c17994d4b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6s0hyiSz_8gegtwiKnaoA.png"/></div></div></figure><p id="3e71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lc">请注意，该数据有 100 个套件，每个套件有 10 个样本。</em></p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="2653" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">让游戏开始吧！</h1><p id="819f" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">我们需要首先将数据分成<strong class="ih hj">测试、验证</strong>和<strong class="ih hj">训练</strong>。<strong class="ih hj"> train </strong>数据集，你猜对了，是用来训练模型的，而<strong class="ih hj"> test </strong>数据集是用来评估模型性能的，是新鲜的，在<strong class="ih hj"> train </strong>数据集中找不到。另一方面，<strong class="ih hj">验证</strong>数据集是为了测量模型在训练时的拟合程度，以及模型的泛化程度。这有助于理解模型的偏差和方差。</p><p id="0bee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用 80:20 吧，其中 80%的<strong class="ih hj">考</strong>，20%的<strong class="ih hj">练</strong>。然后在<strong class="ih hj">测试</strong>数据集上进行另一个 80:20 的划分，其中 80%的<strong class="ih hj">测试</strong>和 20%的<strong class="ih hj">验证。</strong></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="1f6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们有以下数据集。</p><pre class="jf jg jh ji fd lq lr ls lt aw lu bi"><span id="60d3" class="lv jy hi lr b fi lw lx l ly lz">Train set: 9600<br/>Test set: 3000<br/>Validation set: 2400</span></pre><p id="96eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们需要重塑和规范化的图像。我们需要一个函数，可以读取图像和缩放到 64×64×1 的图像。然后，我们还需要创建一个函数，该函数创建一个对应于分类目标变量的变量。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="88a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们开始训练吧！</p><p id="b621" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我要一个类似 VGG 的模型。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="a788" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们训练 10 个纪元，这应该很快。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="5c5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看结果。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><pre class="jf jg jh ji fd lq lr ls lt aw lu bi"><span id="0a3f" class="lv jy hi lr b fi lw lx l ly lz">[0.14375902712345123, 0.971666693687439]</span></pre><p id="8a12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相当可观！个人报告怎么样？</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><pre class="jf jg jh ji fd lq lr ls lt aw lu bi"><span id="8564" class="lv jy hi lr b fi lw lx l ly lz">precision    recall  f1-score   support<br/><br/>           一       0.98      0.98      0.98       200<br/>           七       0.98      0.97      0.98       200<br/>           万       0.95      0.98      0.97       200<br/>           三       0.95      0.96      0.96       200<br/>           九       0.99      0.94      0.96       200<br/>           二       0.94      0.94      0.94       200<br/>           五       0.99      0.99      0.99       200<br/>           亿       0.92      0.99      0.96       200<br/>           八       1.00      0.99      1.00       200<br/>           六       0.99      1.00      1.00       200<br/>           十       0.99      0.94      0.96       200<br/>           千       0.95      0.98      0.96       200<br/>           四       0.99      0.97      0.98       200<br/>           百       0.97      0.92      0.94       200<br/>           零       1.00      1.00      1.00       200<br/><br/>    accuracy                           0.97      3000<br/>   macro avg       0.97      0.97      0.97      3000<br/>weighted avg       0.97      0.97      0.97      3000</span></pre></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="0a90" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">恭喜你！</h1><blockquote class="ml"><p id="8551" class="mm mn hi bd mo mp mq mr ms mt mu jc dx translated">你已经建立了一个 CNN 来分类中文数字！你可以通过 Kaggle 笔记本<a class="ae jd" href="https://www.kaggle.com/koayhongvin/vgg-like-model-no-dense-model-a-review" rel="noopener ugc nofollow" target="_blank">在这里</a>搞定。</p></blockquote></div></div>    
</body>
</html>