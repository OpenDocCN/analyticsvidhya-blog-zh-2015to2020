<html>
<head>
<title>Create and Deploy your Meme Detector from scratch : A step-by-step guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始创建和部署你的迷因探测器:一步一步的指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-and-deploy-your-meme-detector-from-scratch-a-step-by-step-guide-3f5a96f22099?source=collection_archive---------17-----------------------#2020-01-09">https://medium.com/analytics-vidhya/create-and-deploy-your-meme-detector-from-scratch-a-step-by-step-guide-3f5a96f22099?source=collection_archive---------17-----------------------#2020-01-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="ca64" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/c3678f43399cf62c08f3f1a2650ab450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01o5C0a2YKKKdygBKTG8Hw.jpeg"/></div></div></figure><p id="8587" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">在本教程中，你将学习如何像<a class="ae kn" href="https://meme-detector.onrender.com/" rel="noopener ugc nofollow" target="_blank">这个</a>一样从头开始构建自己的迷因检测器。本教程结束时，您将能够:</p><ul class=""><li id="fa2f" class="ko kp hi jr b js jt jw jx ka kq ke kr ki ks km kt ku kv kw bi translated">使用谷歌图像创建自己的数据集。</li><li id="1f54" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">选择并重新训练CNN架构的密集层。</li><li id="5020" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">将您的模型作为web应用程序部署到Render.com<a class="ae kn" href="https://render.com/" rel="noopener ugc nofollow" target="_blank"/></li></ul><h1 id="2489" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">库和主要依赖项</h1><ol class=""><li id="d484" class="ko kp hi jr b js lc jw ld ka le ke lf ki lg km lh ku kv kw bi translated">用于GPU的Google Colab</li><li id="324d" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km lh ku kv kw bi translated">Fastai v 1.0.52</li><li id="8b76" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km lh ku kv kw bi translated">PyTorch v1</li></ol><p id="35cd" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">Fastai是一个建立在PyTorch之上的令人惊叹的库，它使深度学习更加直观，并使它需要更少的代码行。想了解更多信息，你应该去他们的文档网站:【https://docs.fast.ai/ T4】</p><h1 id="0710" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">1.获取数据</h1><p id="d955" class="pw-post-body-paragraph jp jq hi jr b js lc ju jv jw ld jy jz ka li kc kd ke lj kg kh ki lk kk kl km hb bi translated">在开始数据收集过程之前，让我们先来定义什么是模因。根据维基百科，模因的定义如下:</p><blockquote class="ll lm ln"><p id="e7f1" class="jp jq lo jr b js jt ju jv jw jx jy jz lp kb kc kd lq kf kg kh lr kj kk kl km hb bi translated">一个<strong class="jr hj">互联网迷因</strong>，通常被简单地称为<strong class="jr hj">迷因</strong>(<a class="ae kn" href="https://en.wikipedia.org/wiki/Help:IPA/English" rel="noopener ugc nofollow" target="_blank">/miːm/</a><a class="ae kn" href="https://en.wikipedia.org/wiki/Help:Pronunciation_respelling_key" rel="noopener ugc nofollow" target="_blank"><em class="hi">meem</em></a>)是一种<a class="ae kn" href="https://en.wikipedia.org/wiki/Meme" rel="noopener ugc nofollow" target="_blank">迷因</a>，一种媒体，传统上但不排他地将图像宏与一个概念或流行语相结合，通过<a class="ae kn" href="https://en.wikipedia.org/wiki/Social_media_platforms" rel="noopener ugc nofollow" target="_blank">社交媒体平台</a>经由<a class="ae kn" href="https://en.wikipedia.org/wiki/Internet" rel="noopener ugc nofollow" target="_blank">互联网</a>传播。</p></blockquote><p id="c236" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">所以基本上，网络迷因是伴随着有趣文字的图片。</p><p id="7ee3" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">在做任何事情之前，您需要设置google Colab环境:</p><ul class=""><li id="d6e1" class="ko kp hi jr b js jt jw jx ka kq ke kr ki ks km kt ku kv kw bi translated">安装Fastai及其依赖项</li></ul><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="09e1" class="lx ig hi lt b fi ly lz l ma mb">!curl -s <a class="ae kn" href="https://course.fast.ai/setup/colab" rel="noopener ugc nofollow" target="_blank">https://course.fast.ai/setup/colab</a> | bash</span></pre><ul class=""><li id="f1a2" class="ko kp hi jr b js jt jw jx ka kq ke kr ki ks km kt ku kv kw bi translated">安装google drive</li></ul><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="e13c" class="lx ig hi lt b fi ly lz l ma mb">from google.colab import drive<br/>drive.mount('/content/gdrive', force_remount=True)</span></pre><ul class=""><li id="7d87" class="ko kp hi jr b js jt jw jx ka kq ke kr ki ks km kt ku kv kw bi translated">创建工作目录</li></ul><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="1127" class="lx ig hi lt b fi ly lz l ma mb">root_dir = "/content/gdrive/My Drive/"<br/>base_dir = root_dir + 'fastai-v3/data/MEMES/'</span><span id="a276" class="lx ig hi lt b fi mc lz l ma mb">from fastai.vision import *<br/>path = Path(base_dir)<br/>path.mkdir(parents=True, exist_ok=True)</span></pre><p id="d087" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在一切都设置好了，你将建立你的迷因图像数据集</p><p id="35e0" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">收集模因</strong></p><p id="760d" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">进入谷歌图片，搜索关键词“<strong class="jr hj"> meme </strong>”，向下滚动，直到你看到“显示更多结果”按钮。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es md"><img src="../Images/7039a0aef8220b8fb30c23e38df6027d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDoeO32lApF33y0I44XTgA.png"/></div></div></figure><p id="64bd" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在，您必须在浏览器中运行一些Javascript代码，它将为我们的数据集保存您想要的所有图像的URL。</p><p id="45df" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">根据浏览器/操作系统的不同，有不同的快捷方式将你带到控制台:在谷歌Chrome中，在Windows/Linux上按CtrlShiftj，在macOS上按CmdOptj，会出现一个javascript“控制台”的小窗口。在Firefox中，在Windows/Linux上按CtrlShiftk，在macOS上按CmdOptk。这是您粘贴JavaScript命令的地方。</p><p id="93ca" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">在运行以下命令之前，您应该禁用广告拦截扩展(uBlock、AdBlockPlus等)。)在Chrome中。</p><p id="fecc" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">之后，在控制台中运行以下命令</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="ab08" class="lx ig hi lt b fi ly lz l ma mb">urls=Array.from(document.querySelectorAll('.rg_i')).map(el=&gt; el.hasAttribute('data-src')?el.getAttribute('data-src'):el.getAttribute('data-iurl'));<br/>window.open('data:text/csv;charset=utf-8,' + escape(urls.join('\n')));</span></pre><p id="35de" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这将创建一个文本文件，其中包含搜索结果中图像的URL列表。</p><p id="ae9d" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">你可能想用相关的关键词重复这个过程，比如“<strong class="jr hj">动漫迷因</strong>”、“<strong class="jr hj">世界大战迷因</strong>”、“<strong class="jr hj">黑白迷因</strong>”……并且将链接添加到同一个最终列表中。</p><p id="1e17" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">你将把它命名为“url_memes.txt”。</p><p id="b134" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在，为了下载图像，您将首先为名为<em class="lo"> meme的<strong class="jr hj"> meme </strong>类创建一个文件夹。</em>然后您将使用名为<code class="du me mf mg lt b">download_images</code>的Fastai内置函数从URL下载图像。</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="1ca5" class="lx ig hi lt b fi ly lz l ma mb">folder = 'meme'<br/>file = 'url_memes.txt'<br/>path = Path(base_dir)<br/>dest = path/folder<br/>dest.mkdir(parents=True, exist_ok=True)<br/>download_images(path/file, dest, max_pics=300)</span></pre><p id="89ed" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">创建非迷因集</strong></p><p id="78ff" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">使用以下关键字对<strong class="jr hj"> not meme </strong>类重复相同的谷歌搜索过程:<strong class="jr hj">图片、图像、自拍、脸、照片、壁纸……</strong></p><p id="e331" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">最终的URL列表存储在一个名为“url_not_memes.txt”的文件中</p><p id="40a2" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在，您应该运行以下脚本</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="904f" class="lx ig hi lt b fi ly lz l ma mb">folder = 'not_meme'<br/>file = 'url_not_memes.txt'<br/>path = Path(base_dir)<br/>dest = path/folder<br/>dest.mkdir(parents=True, exist_ok=True)<br/>download_images(path/file, dest, max_pics=300)</span></pre><p id="e5e2" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">它将创建not_meme文件夹并为您下载图像。</p><p id="db0d" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">恭喜你！！您创建了您的第一个图像数据集，这是巨大的！你应该为自己感到骄傲。</p><h1 id="81ec" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak"> 2。训练模型</strong></h1><p id="7b0c" class="pw-post-body-paragraph jp jq hi jr b js lc ju jv jw ld jy jz ka li kc kd ke lj kg kh ki lk kk kl km hb bi translated">您应该可以使用内置的fastai <code class="du me mf mg lt b">ImageDataBunch</code>来处理您的数据:</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="353f" class="lx ig hi lt b fi ly lz l ma mb">np.random.seed(42)<br/>data = ImageDataBunch.from_folder(path, train=".", valid_pct=0.2, ds_tfms=get_transforms(), size=224, num_workers=4).normalize(imagenet_stats)</span></pre><p id="3f74" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">基本上，<code class="du me mf mg lt b">from_folder</code>方法采用以下参数:</p><ul class=""><li id="c845" class="ko kp hi jr b js jt jw jx ka kq ke kr ki ks km kt ku kv kw bi translated">路径:图像数据集的路径</li><li id="b1a9" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">ds_tfms:应用于图像以扩充数据集的转换</li><li id="ec09" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">尺寸:图像尺寸/选择值:224 x224像素</li><li id="7553" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">valid_pct : 0.2(即数据集的20%将用于验证，因为定型集和验证集没有特定的文件夹。</li></ul><p id="21a4" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">使用<code class="du me mf mg lt b">data.classes</code>,你会发现数据加载器将每个文件夹视为一个类。<code class="du me mf mg lt b">data.show_batch</code>将帮助您可视化数据样本，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/250253041455088aeabc9b3f312df55d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*4Vn2_TdMVBsYf0QyYnZaZQ.png"/></div></figure><p id="f512" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">使用<code class="du me mf mg lt b">cnn_learner</code>功能，一个内置的fastai功能加载一个预训练的Resnet34</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="b19c" class="lx ig hi lt b fi ly lz l ma mb">learn = cnn_learner(data, models.resnet34, metrics=error_rate)</span></pre><p id="ba74" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">基本上，该函数需要以下三个参数:</p><ul class=""><li id="678f" class="ko kp hi jr b js jt jw jx ka kq ke kr ki ks km kt ku kv kw bi translated">数据中心</li><li id="cc42" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">要下载和训练的模型的规格。</li><li id="7069" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">和指标(我在这里选择了error_rate)</li></ul><p id="5ecb" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">您将在4个时期内进行培训</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="6f2b" class="lx ig hi lt b fi ly lz l ma mb">learn.fit_one_cycle(4)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mi"><img src="../Images/074cdb73a075eb1df2f7871b3d354f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*Mh3NwGNetd_19ciiRVypMw.png"/></div></figure><p id="ccf5" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在您已经重新训练了最后一层，您应该解冻模型以将其作为一个整体重新训练:</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="7cf9" class="lx ig hi lt b fi ly lz l ma mb">learn.unfreeze()</span></pre><p id="5757" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">为了选择好的学习率，可以使用内置的fastai函数<code class="du me mf mg lt b">learn.lr_find()</code>。这个方法可以帮助你找到一个最佳的学习速度。它使用了2015年论文<a class="ae kn" href="http://arxiv.org/abs/1506.01186" rel="noopener ugc nofollow" target="_blank">中开发的技术，用于训练神经网络</a>的循环学习率，我们只是从一个非常小的值开始增加学习率，直到损失停止下降。我们可以绘制不同批次的学习率，看看这是什么样子。</p><p id="5426" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">如果您使用<code class="du me mf mg lt b">learn.recorder.plot()</code>，它应该会产生类似下面的图</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mj"><img src="../Images/1eb888323e9013e1c71fbac19fbe413c.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*il9IX7xKdQIbQWGGppXmhw.png"/></div></figure><p id="8126" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在，您应该使用学习率值再运行2个时期的训练，学习率值属于损失下降非常陡峭的区间:即(3e-05和3e-04)</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="4be4" class="lx ig hi lt b fi ly lz l ma mb">learn.fit_one_cycle(2, max_lr=slice(3e-5,3e-4))</span></pre><p id="cf1b" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj"> <em class="lo"> max_lr=slice(start，end) </em> </strong>，会告诉你的模型用<code class="du me mf mg lt b">start</code>的lr训练第一层；<code class="du me mf mg lt b">end</code>的最后一层LR；对于剩余的层，将LR分布在整个范围内<code class="du me mf mg lt b">(start, end)</code>。</p><p id="aeee" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">给你。您应该会得到更好的结果(我得到的错误率为<strong class="jr hj"> 4% </strong>)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/8481fc1acd75fec80511d2bb7fd6273b.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*9xFnorLvm-yo7ObCvfxwpg.png"/></div></figure><p id="3827" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">您可以按如下方式绘制混淆矩阵:</p><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="68db" class="lx ig hi lt b fi ly lz l ma mb">interp = ClassificationInterpretation.from_learner(learn)<br/>interp.plot_confusion_matrix()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ml"><img src="../Images/ed67f9ca935137aabf3a644840c40911.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*OLdt371dYIs9qCCmKUPYEw.png"/></div></figure><p id="7d7e" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">恭喜你！你已经建立了你的迷因分类器！现在您要部署它了！</p><h1 id="f963" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">3.在Render.com部署应用程序</h1><p id="4de7" class="pw-post-body-paragraph jp jq hi jr b js lc ju jv jw ld jy jz ka li kc kd ke lj kg kh ki lk kk kl km hb bi translated">在这一步中，你将能够像我在这里所做的那样，将你的meme探测器部署到网络上:</p><p id="b799" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">【https://meme-detector.onrender.com/】</p><p id="db10" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">叉本github回购:</strong></p><div class="mm mn ez fb mo mp"><a href="https://github.com/render-examples/fastai-v3" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">render-examples/fastai-v3</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">这个repo可以作为在Render上部署fast.ai模型的起点。这里描述的示例应用程序位于…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jn mp"/></div></div></a></div><p id="a836" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">在</strong><a class="ae kn" href="http://render.com" rel="noopener ugc nofollow" target="_blank"><strong class="jr hj">Render.com</strong></a>上开户</p><p id="3d03" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">将使用<code class="du me mf mg lt b">learner.export</code> ( <code class="du me mf mg lt b">export.pkl</code>)创建的训练好的模型文件上传到Google Drive或Dropbox等云服务。复制文件的下载链接。</p><h2 id="4c73" class="lx ig hi bd ih ne nf ng il nh ni nj ip ka nk nl it ke nm nn ix ki no np jb nq bi translated">为您的模型定制应用程序</h2><ol class=""><li id="42f1" class="ko kp hi jr b js lc jw ld ka le ke lf ki lg km lh ku kv kw bi translated">编辑<code class="du me mf mg lt b">app</code>目录中的文件<code class="du me mf mg lt b">server.py</code>，并用上面复制的URL更新<code class="du me mf mg lt b">export_file_url</code>变量。</li><li id="239c" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km lh ku kv kw bi translated">在同一个文件中，用类<code class="du me mf mg lt b">['meme', 'not_meme']</code>更新行<code class="du me mf mg lt b">classes = ['black', 'grizzly', 'teddys']</code>。</li><li id="874c" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km lh ku kv kw bi translated">您还应该编辑<code class="du me mf mg lt b">index.html</code>,其中包含您想要为您的应用程序显示的文本。</li><li id="9e41" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km lh ku kv kw bi translated">在docker文件中，您应该在<code class="du me mf mg lt b">RUN pip install --upgrade -r requirements.txt</code>之后添加以下内容</li></ol><pre class="je jf jg jh fd ls lt lu lv aw lw bi"><span id="3329" class="lx ig hi lt b fi ly lz l ma mb">RUN pip uninstall — yes Pillow<br/>RUN pip install ‘Pillow==6.1’</span></pre><p id="4063" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">将您的更改提交并推送到GitHub。请确保您在上面创建的GitHub repo是最新的。Render与您的GitHub repo集成，并在您每次推送更改时自动构建和部署更改。</p><h2 id="bc67" class="lx ig hi bd ih ne nf ng il nh ni nj ip ka nk nl it ke nm nn ix ki no np jb nq bi translated">部署</h2><ol class=""><li id="2112" class="ko kp hi jr b js lc jw ld ka le ke lf ki lg km lh ku kv kw bi translated">在Render上创建一个新的<strong class="jr hj"> Web服务</strong>，并使用上面创建的repo。在这一步中，您需要授予Render权限来访问您的repo。</li><li id="8e9a" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km lh ku kv kw bi translated">在部署屏幕上，为您的服务选择一个名称，并为环境使用<code class="du me mf mg lt b">Docker</code>。将使用此服务名称创建URL。如有必要，可以更改服务名称，但不能编辑最初创建的URL。</li><li id="e6b5" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km lh ku kv kw bi translated">点击<strong class="jr hj">保存Web服务</strong>。就是这样！您的服务将开始构建，并应在几分钟后在渲染仪表板中显示的URL处上线。您可以在部署日志中跟踪它的进度。</li></ol><h2 id="24c2" class="lx ig hi bd ih ne nf ng il nh ni nj ip ka nk nl it ke nm nn ix ki no np jb nq bi translated">测试</h2><p id="7036" class="pw-post-body-paragraph jp jq hi jr b js lc ju jv jw ld jy jz ka li kc kd ke lj kg kh ki lk kk kl km hb bi translated">你的应用程序的网址将看起来像<code class="du me mf mg lt b">https://service-name.onrender.com</code>。您还可以在测试应用程序时监控服务日志。</p><h1 id="872b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><p id="aa6f" class="pw-post-body-paragraph jp jq hi jr b js lc ju jv jw ld jy jz ka li kc kd ke lj kg kh ki lk kk kl km hb bi translated">在本教程中，您学习了以下技能:</p><ul class=""><li id="28c0" class="ko kp hi jr b js jt jw jx ka kq ke kr ki ks km kt ku kv kw bi translated">使用google image创建自己的图像数据集的简单方法。</li><li id="371a" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">训练一个resnet34并选择正确的学习率区间。</li><li id="5527" class="ko kp hi jr b js kx jw ky ka kz ke la ki lb km kt ku kv kw bi translated">导出模型并将其部署为web应用程序。</li></ul><p id="1532" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">特别感谢<a class="ae kn" href="https://twitter.com/jeremyphoward" rel="noopener ugc nofollow" target="_blank"><em class="lo">Jeremy</em></a><em class="lo"/>和<em class="lo"/><a class="ae kn" href="https://twitter.com/math_rachel" rel="noopener ugc nofollow" target="_blank"><em class="lo">Rachel</em></a><em class="lo"/>为他们惊艳fastai深度学习课堂。</p></div></div>    
</body>
</html>