<html>
<head>
<title>How to do Image Classification on custom Dataset using TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨TensorFlowå¯¹è‡ªå®šä¹‰æ•°æ®é›†è¿›è¡Œå½±åƒåˆ†ç±»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/how-to-do-image-classification-on-custom-dataset-using-tensorflow-52309666498e?source=collection_archive---------0-----------------------#2020-04-01">https://medium.com/analytics-vidhya/how-to-do-image-classification-on-custom-dataset-using-tensorflow-52309666498e?source=collection_archive---------0-----------------------#2020-04-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/845615a503e5f22b6c433748086607a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*gBWLTUuqhNy3U9J-ZWQwjA.jpeg"/></div></figure><p id="249d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å›¾åƒåˆ†ç±»åŸºæœ¬ä¸Šæ˜¯ç»™ç³»ç»Ÿä¸€äº›å±äºä¸€ç»„å›ºå®šç±»åˆ«çš„å›¾åƒï¼Œç„¶åæœŸæœ›ç³»ç»Ÿå°†è¿™äº›å›¾åƒæ”¾å…¥å®ƒä»¬å„è‡ªçš„ç±»åˆ«ã€‚</p><p id="24c1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">åœ¨æˆ‘ä»¥å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘å·²ç»å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•ä»å›¾åƒåˆ†ç±»å¼€å§‹ã€‚æ‰€ä»¥å¦‚æœä½ è¿˜æ²¡æœ‰è¯»è¿‡ï¼Œä½ åº”è¯¥çœ‹çœ‹:<a class="ae jk" rel="noopener" href="/@rkt10952/new-abcd-of-machine-learning-c5bf9eba75bf">https://medium . com/@ rkt 10952/new-ABCD-of-machine-learning-C5 BF 9 EBA 75 BF</a></p><p id="938a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„æ•°æ®é›†è¿›è¡Œå›¾åƒåˆ†ç±»ã€‚æˆ‘å°†ä¸ºæ‚¨æä¾›æœ¬æ–‡ä¸­ä½¿ç”¨çš„å®Œæ•´ä»£ç å’Œå…¶ä»–æ‰€éœ€æ–‡ä»¶ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥äº²è‡ªåŠ¨æ‰‹æ“ä½œã€‚<br/> GitHubé“¾æ¥:<a class="ae jk" href="https://github.com/aryan109/medium/tree/master/Custom_Image_Classification" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/aryan 109/medium/tree/master/Custom _ Image _ class ification</a></p><p id="f5a0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘è¯·æ±‚æ‚¨åœ¨æ‰§è¡Œä»£ç æ—¶é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ç†è§£ä»£ç çš„æ¯ä¸€è¡Œã€‚</p><h1 id="6417" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">æ­£åœ¨å‡†å¤‡æ•°æ®é›†</h1><p id="5282" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">æˆ‘ä»¬ä»å‡†å¤‡æ•°æ®é›†å¼€å§‹ï¼Œå› ä¸ºè¿™æ˜¯è§£å†³ä»»ä½•æœºå™¨å­¦ä¹ é—®é¢˜çš„ç¬¬ä¸€æ­¥ï¼Œä½ åº”è¯¥æ­£ç¡®åœ°åšå®ƒã€‚<br/>æˆ‘ä»¬å°†ä½¿ç”¨Kerasä¸­<strong class="io hj"> ImageDataGenerator </strong>ç±»ä¸­çš„<em class="ko"> flow_from_directory </em>æ–¹æ³•ã€‚ä¸ºäº†ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„æ•°æ®æ”¾åœ¨é¢„å®šä¹‰çš„ç›®å½•ç»“æ„ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kp"><img src="../Images/80ff6c330612781dca2d8991698583a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wl6rLXC0wNL27fnd.png"/></div></div></figure><p id="22d8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘ä»¬åªéœ€è¦æŠŠå›¾ç‰‡æ”¾åˆ°å„è‡ªçš„æ–‡ä»¶å¤¹ä¸­ï¼Œå°±å¯ä»¥å¼€å§‹äº†ã€‚</p><h1 id="69ee" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">æ­£åœ¨åŠ è½½æ•°æ®é›†</h1><p id="af8a" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">å½“æˆ‘ä»¬å‡†å¤‡æ•°æ®é›†æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½å®ƒã€‚å› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ååŒå®éªŒå®¤ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æ•°æ®åŠ è½½åˆ°ååŒå®éªŒå®¤å·¥ä½œåŒºã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦å°†æ•°æ®æ–‡ä»¶å¤¹ä¸Šä¼ åˆ°Google Driveã€‚ç„¶åï¼Œæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„å·¥ä½œåŒºä¸­å®‰è£…é©±åŠ¨å™¨ï¼Œä¸ºæ­¤æˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ä»£ç :</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="3c4e" class="ld jm hi kz b fi le lf l lg lh">from google.colab import drive</span><span id="df29" class="ld jm hi kz b fi li lf l lg lh">drive.mount(â€˜/content/driveâ€™)</span></pre><p id="ed5d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å½“æˆ‘ä»¬æ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œå¹¶ä¼šå‡ºç°ä¸€ä¸ªè¦æ±‚éªŒè¯ç çš„æ¡†ï¼ï¼ï¼ã€‚ç°åœ¨ï¼Œè¯¥åšä»€ä¹ˆâ€¦ï¼Ÿ</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lj"><img src="../Images/897c7f44a6b91b1cf2e3b9c5589271df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XdGS4u66wU7RZRoC"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">å¸ƒé²æ–¯Â·é©¬å°”æ–¯åœ¨<a class="ae jk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="3d5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ä¸è¦æ‹…å¿ƒï¼Œåªè¦ç‚¹å‡»è®¤è¯æ¡†ä¸Šæ–¹çš„é“¾æ¥ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé¡µé¢ï¼Œç™»å½•åˆ°æ‚¨çš„è°·æ­Œå¸æˆ·ã€‚å½“æ‚¨è¾“å…¥å‡­æ®å¹¶ç™»å½•æ—¶ã€‚å…è®¸Google Driveæ–‡ä»¶æµè®¿é—®æ‚¨çš„å¸æˆ·ï¼Œç„¶åå°†ç”ŸæˆéªŒè¯ç ï¼Œåªéœ€å¤åˆ¶è¯¥ä»£ç å¹¶ç²˜è´´åˆ°æ¡†ä¸­ã€‚</p><p id="cb0f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æ­å–œğŸ‰ä½ å·²ç»å®Œæˆäº†æœ€éš¾çš„éƒ¨åˆ†ï¼Œæ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ã€‚</p><p id="1bea" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨ï¼Œå°±åƒè¿™æ ·è¿›å…¥ä¸Šä¼ çš„æ•°æ®é›†æ–‡ä»¶å¤¹:-</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/c8193ca2acabc34e92cc5acaecc81c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*SenFsxSVx0fWKnWTFQTc9g.png"/></div></figure><p id="ab33" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç„¶åå³é”®å•å‡»æ–‡ä»¶å¤¹ï¼Œå¹¶å•å‡»å¤åˆ¶è·¯å¾„ã€‚</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/5aa0ce3a99e0aceb84e7759ec3add5ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*sxBL9ZiyRGidthhrxSr2gQ.png"/></div></figure><p id="3208" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨å°†æ•°æ®æ ¹è®¾ç½®ä¸ºå¤åˆ¶çš„è·¯å¾„ã€‚</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="c7d7" class="ld jm hi kz b fi le lf l lg lh">data_root = (â€œ&lt;Copied path&gt;â€)</span></pre><p id="173a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å®ƒçœ‹èµ·æ¥ä¼šåƒ</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/36f8c20158ced3dfac208dd3907a5840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*EB6319VtqS3p4Yl95bYRfA.png"/></div></figure><p id="ad25" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æ‰§è¡Œæ­¤å•å…ƒæ ¼ã€‚</p><h1 id="4d10" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">åˆ›å»ºåŸ¹è®­å’ŒéªŒè¯æ•°æ®</h1><p id="a856" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">æ­£å¦‚æˆ‘ä¹‹å‰å‘Šè¯‰ä½ çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong class="io hj"> ImageDataGenerator </strong>å°†æ•°æ®åŠ è½½åˆ°æ¨¡å‹ä¸­ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åšã€‚</p><p id="4fcf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç¬¬ä¸€ç»„å›¾åƒå½¢çŠ¶</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="cab1" class="ld jm hi kz b fi le lf l lg lh">IMAGE_SHAPE = (224, 224) # (height, width) in no. of pixels</span></pre><p id="d89a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è®¾ç½®åŸ¹è®­æ•°æ®ç›®å½•</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="fc76" class="ld jm hi kz b fi le lf l lg lh">TRAINING_DATA_DIR = str(data_root)</span></pre><p id="7498" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">é‡æ–°ç¼©æ”¾å›¾åƒå¹¶å°†æ•°æ®åˆ†æˆè®­ç»ƒå’ŒéªŒè¯ã€‚</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="6e3e" class="ld jm hi kz b fi le lf l lg lh">datagen_kwargs = dict(rescale=1./255, validation_split=.20)</span></pre><p id="f17c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">åˆ›å»ºåˆ—è½¦_å‘ç”µæœºå’Œæœ‰æ•ˆ_å‘ç”µæœº</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="7312" class="ld jm hi kz b fi le lf l lg lh">valid_datagen = tf.keras.preprocessing.image.ImageDataGenerator(**datagen_kwargs)</span><span id="8083" class="ld jm hi kz b fi li lf l lg lh">valid_generator = valid_datagen.flow_from_directory(</span><span id="a088" class="ld jm hi kz b fi li lf l lg lh">TRAINING_DATA_DIR,</span><span id="0c31" class="ld jm hi kz b fi li lf l lg lh">subset=â€validationâ€,</span><span id="b453" class="ld jm hi kz b fi li lf l lg lh">shuffle=True,</span><span id="e62b" class="ld jm hi kz b fi li lf l lg lh">target_size=IMAGE_SHAPE</span><span id="7d08" class="ld jm hi kz b fi li lf l lg lh">)</span><span id="b567" class="ld jm hi kz b fi li lf l lg lh">train_datagen = tf.keras.preprocessing.image.ImageDataGenerator(**datagen_kwargs)</span><span id="58c9" class="ld jm hi kz b fi li lf l lg lh">train_generator = train_datagen.flow_from_directory(</span><span id="0d5c" class="ld jm hi kz b fi li lf l lg lh">TRAINING_DATA_DIR,</span><span id="2e0f" class="ld jm hi kz b fi li lf l lg lh">subset=â€trainingâ€,</span><span id="845f" class="ld jm hi kz b fi li lf l lg lh">shuffle=True,</span><span id="139f" class="ld jm hi kz b fi li lf l lg lh">target_size=IMAGE_SHAPE)</span></pre><p id="b915" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å½“æ‚¨æ‰§è¡Œå•å…ƒæ ¼æ—¶ï¼Œå®ƒå°†æ˜¾ç¤ºå¦‚ä¸‹è¾“å‡º</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/44457002029aa5e3ef8e1cd90ebabb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*_nSmu4g8YP0vX-bi1qGE-A.png"/></div></figure><p id="81e7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç¬¬ä¸€è¡Œæ˜¯éªŒè¯æ•°æ®ï¼Œç¬¬äºŒè¡Œæ˜¯è®­ç»ƒæ•°æ®ã€‚</p><h1 id="1bdf" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">å¯è§†åŒ–æ•°æ®</h1><p id="1a33" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">è®©æˆ‘ä»¬æµè§ˆä¸€ä¸‹train_generatorä¸­çš„å›¾åƒå’Œæ ‡ç­¾</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/666c02604423e35ace1239b726c61042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*Gk0TwJz8yHzf88RP40sLgQ.png"/></div></figure><p id="9fb0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">é»˜è®¤çš„æ‰¹é‡å¤§å°æ˜¯32ï¼Œè¿™åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯åˆé€‚çš„ã€‚</p><p id="76fd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">(32ï¼Œ244ï¼Œ244ï¼Œ3)è¡¨ç¤ºåœ¨ä¸€æ‰¹å›¾åƒä¸­åŒ…æ‹¬32ä¸ªå›¾åƒï¼Œ244ï¼Œ244æ˜¯å›¾åƒçš„é«˜åº¦å’Œå®½åº¦ï¼Œ3æ˜¯RGBä¸‰ä¸ªé¢œè‰²é€šé“ã€‚</p><p id="12df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">label_batch shape is (32ï¼Œ4)è¡¨ç¤ºæœ‰32ä¸ªæ ‡ç­¾å’Œ4ä¸ªï¼Œå› ä¸ºæ ‡ç­¾æ˜¯ä¸€ç§çƒ­ç¼–ç æ ¼å¼ã€‚</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/09cfce7aa352f7a032e52ea33f6f77dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*EwdqaiOjDPdP9fTo6ejgfA.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">label_batchä¸­çš„å‰5ä¸ªå…ƒç´ </figcaption></figure><p id="df51" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹å“ªäº›æŒ‡æ•°ä»£è¡¨å“ªäº›æ ‡ç­¾</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="82c9" class="ld jm hi kz b fi le lf l lg lh">print (train_generator.class_indices)</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lu"><img src="../Images/65112e07752937e4207e548b1556785f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FUMQ-N2M-FnsnIaxri6w4A.png"/></div></div></figure><p id="7f91" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰æ ‡ç­¾å†™å…¥ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="0101" class="ld jm hi kz b fi le lf l lg lh">labels = â€˜\nâ€™.join(sorted(train_generator.class_indices.keys()))<br/>with open(â€˜labels.txtâ€™, â€˜wâ€™) as f:<br/> f.write(labels)<br/>!cat labels.txt</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lv"><img src="../Images/c227023e3cb87c3d6abd1ddbbfb3a904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m9CvV2_grJcXF0sxgzeMnw.png"/></div></div></figure><h1 id="4af5" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">åˆ›å»ºåˆ†ç±»æ¨¡å‹</h1><p id="2625" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºè¿ç§»å­¦ä¹ çš„ä¸€ç¥ï¼Œä¸è¦æ‹…å¿ƒï¼Œæˆ‘å°†ä¸ºè¿ç§»å­¦ä¹ åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æ•™ç¨‹ã€‚</p><p id="58fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘ä»¬å°†ä½¿ç”¨<strong class="io hj"> TensorFlow hub </strong>æ¥åŠ è½½é¢„è®­ç»ƒçš„æ¨¡å‹ã€‚</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="5559" class="ld jm hi kz b fi le lf l lg lh">model = tf.keras.Sequential([<br/> hub.KerasLayer(â€œ<a class="ae jk" href="https://tfhub.dev/google/tf2-preview/mobilenet_v2/feature_vector/4" rel="noopener ugc nofollow" target="_blank">https://tfhub.dev/google/tf2-preview/mobilenet_v2/feature_vector/4</a>", <br/> output_shape=[1280],<br/> trainable=False),<br/> tf.keras.layers.Dropout(0.4),<br/> tf.keras.layers.Dense(train_generator.num_classes, activation=â€™softmaxâ€™)<br/>])<br/>model.build([None, 224, 224, 3])</span><span id="a907" class="ld jm hi kz b fi li lf l lg lh">model.summary()</span></pre><p id="01a2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿™ä¸ªæ¨¡å‹æœ‰å®ƒè‡ªå·±çš„ä¸€äº›ç‹¬ç‰¹çš„ç‰¹æ€§ï¼Œ<br/> 1)å³ä½¿ä½ çš„æ•°æ®é›†æœ‰ä¸åŒæ•°é‡çš„ç±»ï¼Œè¿™ä¸ªä»£ç ä¹Ÿèƒ½å·¥ä½œã€‚<br/> 2)ç”±äºæˆ‘ä»¬ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼Œå³ä½¿ä½ çš„æ•°æ®é›†å¾ˆå°ï¼Œå®ƒä¹Ÿä¼šäº§ç”Ÿå¾ˆå¥½çš„ç»“æœã€‚<br/> 3)è¿™ç§æ¨¡å¼æ˜“äºåœ¨ç§»åŠ¨è®¾å¤‡æˆ–ç±»ä¼¼Raspberry piçš„è®¾å¤‡ä¸Šéƒ¨ç½²ã€‚(è¯·ä¸è¦æ‹…å¿ƒï¼Œæˆ‘å°†åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­å•ç‹¬ä»‹ç»è¿™ä¸€ç‚¹ï¼Œæ•¬è¯·å…³æ³¨ğŸ˜‰).</p><p id="5a7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿™æ®µä»£ç çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lw"><img src="../Images/9e4ed8fc176d5ad48aeb3af221d29682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qErCnQNk10j2mqXXPBwVGQ.png"/></div></div></figure><h1 id="e7bd" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">ç«è½¦æ¨¡å‹</h1><p id="7d38" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">åœ¨è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¼–è¯‘æ¨¡å‹ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®©æˆ‘ä»¬ç¼–è¯‘</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="9662" class="ld jm hi kz b fi le lf l lg lh">optimizer = tf.keras.optimizers.Adam(lr=1e-3)<br/>model.compile(<br/> optimizer=optimizer,<br/> loss=â€™categorical_crossentropyâ€™,<br/> metrics=[â€˜accâ€™])</span></pre><p id="13c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥è®­ç»ƒäº†</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lx"><img src="../Images/a64b457181406c068dfc1ee662279a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nfK9wSKcxcJCu-rT"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">å¸ƒè±æ©Â·è‹æ›¼åœ¨Unsplashçš„ç…§ç‰‡</figcaption></figure><p id="91b2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¼€ç©ç¬‘çš„ğŸ˜‚è®©æˆ‘ä»¬è¿›è¡ŒçœŸæ­£çš„è®­ç»ƒ</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="c862" class="ld jm hi kz b fi le lf l lg lh">steps_per_epoch = np.ceil(train_generator.samples/train_generator.batch_size)<br/>val_steps_per_epoch = np.ceil(valid_generator.samples/valid_generator.batch_size)</span><span id="bdf7" class="ld jm hi kz b fi li lf l lg lh">hist = model.fit(<br/> train_generator, <br/> epochs=100,<br/> verbose=1,<br/> steps_per_epoch=steps_per_epoch,<br/> validation_data=valid_generator,<br/> validation_steps=val_steps_per_epoch).history</span></pre><blockquote class="ly lz ma"><p id="0490" class="im in ko io b ip iq ir is it iu iv iw mb iy iz ja mc jc jd je md jg jh ji jj hb bi translated">è¿™æ®µä»£ç å°†ä¸ºæ¨¡å‹è®­ç»ƒ100ä¸ªæ—¶æœŸã€‚<br/> <strong class="io hj">è­¦å‘Š</strong>:è®­ç»ƒéœ€è¦æ—¶é—´ï¼Œæ‰€ä»¥è¦æœ‰è€å¿ƒ..</p></blockquote><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es me"><img src="../Images/f38a3039c14fa50995a05fb675ff83c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eZ7sEsim6iyY851b"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated"><a class="ae jk" href="https://unsplash.com/@fachymarin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">æ³•å¸ŒÂ·é©¬æ—</a>åœ¨<a class="ae jk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><h2 id="a6b9" class="ld jm hi bd jn mf mg mh jr mi mj mk jv ix ml mm jz jb mn mo kd jf mp mq kh mr bi translated">æ­å–œğŸ™Œæ‚¨å·²ç»æˆåŠŸè®­ç»ƒäº†æ‚¨çš„æ¨¡å‹</h2><p id="3c41" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„æ¨¡å‹æœ‰å¤šå¥½ã€‚</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="6711" class="ld jm hi kz b fi le lf l lg lh">final_loss, final_accuracy = model.evaluate(valid_generator, steps = val_steps_per_epoch)<br/>print(â€œFinal loss: {:.2f}â€.format(final_loss))<br/>print(â€œFinal accuracy: {:.2f}%â€.format(final_accuracy * 100))</span></pre><p id="457f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¥½çœ‹å—ï¼Ÿå¦‚æœä¸èƒ½å°è¯•è®­ç»ƒæ›´å¤šçš„çºªå…ƒï¼Œé‚£å°±çœ‹çœ‹ç¥å¥‡çš„ğŸ§â€â™€ï¸.å§</p><h1 id="4cd4" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">ç»˜åˆ¶ä¸€äº›å›¾è¡¨</h1><p id="4933" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">è¿™äº›å›¾è¡¨å°†å¸®åŠ©ä½ äº†è§£è®­ç»ƒåšå¾—æœ‰å¤šå¥½ã€‚</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="25c7" class="ld jm hi kz b fi le lf l lg lh">plt.figure()<br/>plt.ylabel(â€œLoss (training and validation)â€)<br/>plt.xlabel(â€œTraining Stepsâ€)<br/>plt.ylim([0,50])<br/>plt.plot(hist[â€œlossâ€])<br/>plt.plot(hist[â€œval_lossâ€])</span><span id="f8c1" class="ld jm hi kz b fi li lf l lg lh">plt.figure()<br/>plt.ylabel(â€œAccuracy (training and validation)â€)<br/>plt.xlabel(â€œTraining Stepsâ€)<br/>plt.ylim([0,1])<br/>plt.plot(hist[â€œaccâ€])<br/>plt.plot(hist[â€œval_accâ€])</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/6fe9c36d5e917cc6a311a38f4057a91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*VYXd-zO3Ow8DP4-JgBbwDQ.png"/></div></figure><p id="086b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¯¥å›¾çœ‹èµ·æ¥ä¼šåƒè¿™æ ·ï¼Œæ©™è‰²çº¿è¡¨ç¤ºéªŒè¯å‡†ç¡®æ€§ï¼Œè“è‰²çº¿è¡¨ç¤ºè®­ç»ƒå‡†ç¡®æ€§ã€‚</p><h1 id="fce6" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">æ£€æŸ¥æ¨¡å‹çš„æ€§èƒ½</h1><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="8fcf" class="ld jm hi kz b fi le lf l lg lh">tf_model_predictions = model.predict(val_image_batch)<br/>print(â€œPrediction results shape:â€, tf_model_predictions.shape)</span><span id="1cbb" class="ld jm hi kz b fi li lf l lg lh">plt.figure(figsize=(10,9))<br/>plt.subplots_adjust(hspace=0.5)<br/>for n in range((len(predicted_labels)-2)):<br/> plt.subplot(6,5,n+1)<br/> plt.imshow(val_image_batch[n])<br/> color = â€œgreenâ€ if predicted_ids[n] == true_label_ids[n] else â€œredâ€<br/> plt.title(predicted_labels[n].title(), color=color)<br/> plt.axis(â€˜offâ€™)<br/>_ = plt.suptitle(â€œModel predictions (green: correct, red: incorrect)â€)</span></pre><p id="4a6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å°†é€šè¿‡é¢„æµ‹å‘æ‚¨å±•ç¤ºæ¨¡å‹çš„è®­ç»ƒæ•ˆæœã€‚</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mt"><img src="../Images/a071a792f43a9cf9c5ce7e2000b51f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ix5ApDHadbJx-myP5NS0wg.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">ç”±æ¨¡å‹å®Œæˆçš„é¢„æµ‹</figcaption></figure><blockquote class="ly lz ma"><p id="93b9" class="im in ko io b ip iq ir is it iu iv iw mb iy iz ja mc jc jd je md jg jh ji jj hb bi translated">è°¢è°¢ä½ çš„è€å¿ƒå’Œé˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚è¯·åˆ†äº«æ‚¨çš„åé¦ˆå’Œå»ºè®®ã€‚æˆ‘ä¿è¯å¾ˆå¿«ä¼šæœ‰æ›´å¤šçš„æ–‡ç« ï¼Œå¸Œæœ›ä½ ä¼šå–œæ¬¢ã€‚</p></blockquote><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mu"><img src="../Images/26363de1e25a4aa3fd38b99fff24db4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AEuSyYtX1RsAzP5R"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">ç”±<a class="ae jk" href="https://unsplash.com/@howier?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">éœåå¾·Â·é‡Œæ˜é¡¿</a>åœ¨<a class="ae jk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure></div></div>    
</body>
</html>