<html>
<head>
<title>Getting started with Pandas!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫入门！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/getting-started-with-pandas-45c7639cd5ae?source=collection_archive---------16-----------------------#2020-05-19">https://medium.com/analytics-vidhya/getting-started-with-pandas-45c7639cd5ae?source=collection_archive---------16-----------------------#2020-05-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/acea7030210e2087f89d3487c9c28640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EznD7NA3fgZW4QE-"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">锡德·巴拉钱德朗在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f988" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Pandas是一个Python包，广泛用于处理结构化数据。</p><p id="df36" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个博客中，我们将讨论Pandas中一些非常有用的方法，用于分析、转换和生成数据的基本统计数据。我们将使用来自Kaggle的数据集，名为<a class="ae iu" href="https://www.kaggle.com/utkarshakathayat/insurance-dataset" rel="noopener ugc nofollow" target="_blank">保险_数据集</a>。</p><p id="7fb8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从导入熊猫库开始。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="02e8" class="kc kd hi jy b fi ke kf l kg kh">import pandas as pd</span></pre><h2 id="f34e" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated"><strong class="ak">读取数据</strong></h2><p id="8137" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">现在，让我们将数据集读入熊猫数据帧。</p><p id="b648" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Pandas dataframe是带有标签轴(行和列)的表格形式的数据。</p><p id="a00b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> read_csv() </strong>方法用于将一个<em class="lg">逗号分隔的</em>文件读入Pandas。如果数据不是用逗号分隔，而是用任何其他字符(比如用|)分隔，那么这个字符应该作为分隔符传递给read_csv()函数。</p><p id="2bb8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如read_csv("insurance.csv "，delimiter = "| ")</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="8163" class="kc kd hi jy b fi ke kf l kg kh">insurance = pd.read_csv("insurance.csv")</span></pre><p id="ea99" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lg">数据太多，无法浏览？</em></p><p id="630b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">分别使用<strong class="ix hj"> head() </strong>或<strong class="ix hj"> tail() </strong>方法检查前5行或后5行。您还可以将希望看到的行数“n”传递给这两个函数。默认行数为5。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="3af1" class="kc kd hi jy b fi ke kf l kg kh">insurance.head()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/eac3de82ef3af7cdbd4fd75c0467d015.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*i3t2VvTPQxvXD4CNfLUM0w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="c574" class="kc kd hi jy b fi ke kf l kg kh">insurance.head(n = 10)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es li"><img src="../Images/c61a36660e101b90f912dec1186b06e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*aL8xl_VxmqSV_z0I4A05Pg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="c491" class="kc kd hi jy b fi ke kf l kg kh">insurance.tail()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/a6e331714397e04ea9b0b808da0c233c.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*coB8JieEwWtyyd0jGFJW7A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="055c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用<strong class="ix hj"> dtypes </strong>属性可以找到数据帧中每一列的数据类型。</p><p id="0336" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">python中默认的数据类型是float64、int64、object、bool、category、timedelta64、datetime64。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="350a" class="kc kd hi jy b fi ke kf l kg kh">insurance.dtypes</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/a2df61e7cb5ca8b3e4db126b388166a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*BoEBHTJr4UMXSxVAzxqrdQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="0a21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用<strong class="ix hj"> select_dtypes() </strong>只查看您想要的数据类型的列。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="2f71" class="kc kd hi jy b fi ke kf l kg kh">insurance.select_dtypes(include = ['float64', 'int64'])</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/98c1e359a0888508efaab44339cee878.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*Ca1tVBRw7g56sSb3JdAWug.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><h2 id="aab7" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated">数据帧摘要</h2><p id="475f" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">让我们检查数据帧中的行数和列数。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="addb" class="kc kd hi jy b fi ke kf l kg kh">insurance.shape</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/d7ae4be3eb98448b3876d6a09feb0d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*fVBj6j1me73ZzQn04dx9Jg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="752c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以这个数据帧由1338行和7列组成。</p><p id="fa03" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Pandas <strong class="ix hj"> describe() </strong>是<strong class="ix hj"> </strong>用来查看一些基本的统计细节，如均值、中位数、标准差等。一个数据帧。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="dc2d" class="kc kd hi jy b fi ke kf l kg kh">insurance.describe()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/1dc14a0772f3d0d0b0a229c1cf7ec241.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*4H8v_GkT3H7zyPgcVCeiTA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><h2 id="070a" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated"><strong class="ak">复制数据帧</strong></h2><p id="be84" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">为了避免对原始数据帧进行修改，最好使用<strong class="ix hj"> copy() </strong>方法创建一个副本并对其进行处理。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="d1cd" class="kc kd hi jy b fi ke kf l kg kh">df = insurance.copy()</span></pre><p id="5dfa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，如果我们改变第4行的性别和第2行的区域:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="1803" class="kc kd hi jy b fi ke kf l kg kh">df.loc[3, ‘sex’] = ‘female’<br/>df.loc[1, ‘region’] == ‘northwest’</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/b77bbadbf1a08c148bf2cc73c164e07d.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*02cZ1R40XjBz8HvkyQHdOQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="81c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它不会影响原始数据帧。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="76f6" class="kc kd hi jy b fi ke kf l kg kh">insurance.head()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/1ee3c8d2e1e0072ed7cb40f5f982d3cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*kctA_nhCWYbJNhJqBiVAvA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><h2 id="a335" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated"><strong class="ak">缺失值</strong></h2><p id="37db" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">让我们检查每一列中null值的数量。</p><p id="f679" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">方法<strong class="ix hj"> isnull() </strong>告诉我们数据帧中的值是否为空或缺失，方法<strong class="ix hj"> sum() </strong>计算一列中此类值的数量。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6d33" class="kc kd hi jy b fi ke kf l kg kh">print(df.isnull().sum())</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/8e44edf9f787746f05bb222d90193578.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*bIey12VB27aQmh2Boo39Kg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="8042" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到数据帧中没有空值或缺失值。但是如果有的话，我们可以使用<strong class="ix hj"> dropna() </strong>方法删除空值，或者使用<strong class="ix hj"> fillna() </strong>方法将它们替换为所需的值。</p><h2 id="8678" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated">删除不需要的列</h2><p id="9d09" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated"><em class="lg">如果在分析中有一个对你没有用的栏目怎么办？</em></p><p id="8847" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用<strong class="ix hj"> drop() </strong>方法删除这些列。</p><p id="c07b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，让我们删除区域列。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="7562" class="kc kd hi jy b fi ke kf l kg kh">df.drop(“region”, axis = 1, inplace = True)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/5236c6d7c52a2f3d3acf59f73e484b25.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*TrVuiDAVyKXtPusyWbOiAA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="b622" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">inplace参数用于使数据帧中的更改永久化。</p><h2 id="ba4b" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated">过滤和汇总数据</h2><p id="dc2e" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated"><em class="lg">吸烟和不吸烟的男女人数是多少？</em></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9d68" class="kc kd hi jy b fi ke kf l kg kh">df.groupby(['sex'])['smoker'].value_counts()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/4fb9f249d857c9e27bec5d4a5fee0e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*en-13A5rcNek8i6mT-QTGw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="7cbc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> groupby()是最有用的熊猫方法之一。</strong></p><p id="f61b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> value_counts() </strong>统计应用该值的列中每个值的条目数。</p><p id="e825" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们来看看这些人的平均保险费用，根据性别和是否吸烟来分类。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6776" class="kc kd hi jy b fi ke kf l kg kh">df.groupby(['sex', 'smoker'])['charges'].mean()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/c0964b8f1ac64a695fdfed03e7362b57.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*tuUdXCSMwSbq9ljxTt8ekQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="acd7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lg">哪个群体的低bmi人群最多？</em></p><p id="51e0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们对数据进行过滤，只包括那些低bmi的人(将其视为低于19)。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="26e1" class="kc kd hi jy b fi ke kf l kg kh">low_bmi = df[df['bmi'] &lt;= 19]<br/>low_bmi.head()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/12c76e050c511b83cd75bef940d73ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*-lFOzOtk3KtqhPptVG8mIw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="0366" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，索引没有按顺序排列。为了解决这个问题，我们可以使用<strong class="ix hj"> reset_index() </strong>方法。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="2fe8" class="kc kd hi jy b fi ke kf l kg kh">low_bmi.reset_index(drop = True)<br/>low_bmi.head()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/2cd296be5b8f6524eb9ff9f239a42be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*ujEGvGPQ66KKgZUm5Vt4UA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="d07c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在将检查哪个年龄组和性别患有低bmi。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="b15b" class="kc kd hi jy b fi ke kf l kg kh">low_bmi.groupby(['sex'])['age'].value_counts().idxmax()</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/06090cfcb366efa6ce6376ce2ae66727.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*gtUfJ48Zbp-6esO-wibSxw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><p id="e910" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> idxmax() </strong>是另一个非常有用的函数，可以帮助我们确定出现频率最高的类别，即最大计数。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="e531" class="kc kd hi jy b fi ke kf l kg kh">print(df['bmi'].min())<br/>print(df['bmi'].max())<br/>print(df['bmi'].mean())<br/>print(df['bmi'].std())</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/a4facada89e6571a7c54b6f6bbe8d519.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*AAtX2AgGN2iYESLFV9Zonw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:作者</figcaption></figure><h2 id="0c66" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated">保存到新文件</h2><p id="6869" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">最后，如果你想把对数据帧的修改保存到一个单独的文件中，可以使用<strong class="ix hj"> to_csv() </strong>方法来完成。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="4007" class="kc kd hi jy b fi ke kf l kg kh">df.to_csv("new_insurance.csv")</span></pre><p id="c29a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lg">感谢阅读！希望这篇帖子对你有帮助！</em></p><p id="2bb9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lg">领英:</em><a class="ae iu" href="https://www.linkedin.com/in/akshada-gaonkar-9b8886189/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/akshada-gaonkar-9b8886189/</a></p></div></div>    
</body>
</html>