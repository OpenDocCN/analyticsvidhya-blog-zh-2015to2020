<html>
<head>
<title>Deploying pyramid, flask or django application on Google Cloud Compute Engine Instance using Apache2 + mod_wsgi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Apache2 + mod_wsgi在Google云计算引擎实例上部署pyramid、flask或django应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploy-pyramid-flask-or-django-application-on-google-cloud-compute-engine-instance-using-apache2-a7c6e277670e?source=collection_archive---------17-----------------------#2020-07-06">https://medium.com/analytics-vidhya/deploy-pyramid-flask-or-django-application-on-google-cloud-compute-engine-instance-using-apache2-a7c6e277670e?source=collection_archive---------17-----------------------#2020-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/fafe93cf60666f38d7cfed99e070202f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*lc5sc66TJCcnyLY0TbY_Ww.png"/></div></figure><p id="c62f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本教程中，我们将学习如何使用Apache2和mod_wsgi在Google云计算引擎实例上部署WSGI应用程序。</p><p id="4485" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">WSGI代表web服务器网关接口，它是web服务器和web应用程序或框架之间的一个与实现无关的接口，以促进可移植Web应用程序开发的共同点。</p><p id="fb86" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这一类别中值得注意的python web框架是Flask、Django和Pyramid。</p><p id="9fea" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本教程中，我们将使用pyramid作为示例应用程序，但是我们将介绍如何从这三个框架部署应用程序。</p><p id="ab88" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要开始，注册谷歌云服务。如果这是你的第一次，谷歌会给你300美元的免费积分在这个平台上使用。</p><p id="2209" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">注意，在本教程中，我们不打算使用docker或bash启动脚本。我们将手动完成所有工作。</strong></p><h1 id="a3c6" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">设置计算引擎实例</h1><p id="4159" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">在谷歌云和<a class="ae kn" href="https://cloud.google.com/apis/docs/getting-started#creating_a_google_project" rel="noopener ugc nofollow" target="_blank">创建项目</a>后，导航到API服务和<a class="ae kn" href="https://console.cloud.google.com/apis/library/compute.googleapis.com" rel="noopener ugc nofollow" target="_blank">启用计算引擎API </a>。返回计算引擎，按照这些步骤创建一个实例。</p><p id="9248" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在实例创建表单上，在<strong class="io hj">引导盘</strong>部分，点击更改并选择<strong class="io hj"> ubuntu </strong>作为操作系统，然后选择<strong class="io hj"> ubuntu 18.04 LTS </strong>作为版本。</p><p id="e2a3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您的网站是一个小型网站，您可能希望为<strong class="io hj">机器类型</strong>选择<strong class="io hj"> g1-small </strong>。使用g1-small将为您节省一些钱。</p><p id="f78d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">还要确保勾选允许HTTP &amp; HTTPS流量。</p><p id="3530" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">以上是本教程中使用的实例的配置。你可以改变它，重要的是了解整个事情是如何运作的。</p><h1 id="2bbf" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">为部署准备已创建的映像实例</strong></h1><p id="940f" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">在创建的实例上，单击SSH以连接到该实例。一旦您的控制台准备就绪，我们就必须安装并准备部署环境。</p><p id="a67c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，我们将创建一个新用户来运行我们的应用程序。与我们登录时使用的用户(我们的电子邮件)不同的用户。这是一个很好的安全措施。</p><p id="dd3f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用以下命令切换到root</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="a946" class="kx jl hi kt b fi ky kz l la lb">sudo -i</span></pre><p id="76a9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在根目录下，使用此命令创建一个新用户。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="0455" class="kx jl hi kt b fi ky kz l la lb">adduser pythonapp</span></pre><p id="837f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">回答下面的问题，您的新用户就创建好了，在本例中，<em class="lc"> pythonapp </em>是新用户。我们的新用户需要是一个<em class="lc">苏多尔</em>。使用此命令将用户添加到<em class="lc"> sudo </em>组，并更改为用户</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="1f38" class="kx jl hi kt b fi ky kz l la lb">usermod -aG sudo pythonapp</span><span id="67e8" class="kx jl hi kt b fi ld kz l la lb">su - pythonapp</span></pre><p id="ff0e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们准备开始安装。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9ac2" class="kx jl hi kt b fi ky kz l la lb">sudo apt update &amp;&amp; sudo apt upgrade</span><span id="3c09" class="kx jl hi kt b fi ld kz l la lb">sudo apt install apache2 </span><span id="ca4f" class="kx jl hi kt b fi ld kz l la lb">sudo apt install apache2-dev python3-dev python3-pip python3-venv</span></pre><p id="d6b8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">完成上述安装后，我们需要安装mod_wsgi。我们将手动安装，而不是从<em class="lc"> apt </em>包管理器安装。这是为了将其配置为与python 3一起工作。你可以在库<a class="ae kn" href="https://github.com/GrahamDumpleton/mod_wsgi/releases" rel="noopener ugc nofollow" target="_blank">这里</a>获得mod_wsgi最新发布版本的链接。对于本教程，我们正在安装版本4.7.1。输入以下命令</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="34bf" class="kx jl hi kt b fi ky kz l la lb">wget <a class="ae kn" href="https://github.com/GrahamDumpleton/mod_wsgi/archive/4.7.1.tar.gz" rel="noopener ugc nofollow" target="_blank">https://github.com/GrahamDumpleton/mod_wsgi/archive/4.7.1.tar.gz</a></span></pre><p id="c725" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8f17" class="kx jl hi kt b fi ky kz l la lb">tar xvfz 4.7.1.tar.gz</span><span id="50ec" class="kx jl hi kt b fi ld kz l la lb">cd mod_wsgi-4.7.1</span><span id="c0dd" class="kx jl hi kt b fi ld kz l la lb">sudo ./configure --with-python=/usr/bin/python3</span><span id="5b4c" class="kx jl hi kt b fi ld kz l la lb">sudo make</span><span id="e357" class="kx jl hi kt b fi ld kz l la lb">sudo make install</span></pre><p id="bf2e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们需要将<em class="lc"> mod_wsgi.so </em>模块加载到Apache中。在我们这里的例子中，<em class="lc"> make </em>将这个模块复制到<em class="lc">/usr/lib/Apache 2/modules/</em>。您可能需要检查它在您的案例中是从哪里复制的。你可能应该先检查一下<em class="lc">/usr/lib/Apache 2/modules/</em>。</p><p id="387a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用vim或nano打开/etc/Apache 2/<em class="lc">Apache 2 . conf</em>，并在<em class="lc"> Include ports.conf </em>后添加以下几行</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="97c4" class="kx jl hi kt b fi ky kz l la lb"># Load mod_wsgi<br/>LoadModule wsgi_module /usr/lib/apache2/modules/mod_wsgi.so</span></pre><p id="5289" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">重启Apache</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="ebac" class="kx jl hi kt b fi ky kz l la lb">sudo apachectl restart</span></pre><p id="63a5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果一切正常，您应该会看到表单中的一行</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="7836" class="kx jl hi kt b fi ky kz l la lb">Apache/2.4.29 (Ubuntu) mod_wsgi/4.7.1 Python/3.6 configured -- resuming normal operations</span></pre><p id="455e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在位于<em class="lc"> /var/log/apache/error.log的Apache错误日志中。用命令打开它</em></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="dd81" class="kx jl hi kt b fi ky kz l la lb">sudo nano /var/log/apache/error.log</span><span id="0cbf" class="kx jl hi kt b fi ld kz l la lb"># If all is Ok, clean the build with this command:<br/>sudo make clean</span></pre><p id="71c3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">转到您的计算引擎实例，复制外部IP。现在访问<a class="ae kn" href="http://YOUR_IP" rel="noopener ugc nofollow" target="_blank"><em class="lc">http://YOUR _ IP</em></a><em class="lc"/>查看默认的ubuntu网站。如果看不到，首先确定一下，你是在<em class="lc"> http </em>而不是<em class="lc"> https上访问的。</em>如果还是看不出来，不妨从头再来一遍教程。删除该实例并重新开始。</p><h2 id="fb70" class="kx jl hi bd jm le lf lg jq lh li lj ju ix lk ll jy jb lm ln kc jf lo lp kg lq bi translated">上传您的应用程序并创建一个虚拟环境</h2><p id="3970" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">我们将在<a class="ae kn" href="https://github.com/ephraimbuddy/wsgi-tutorial" rel="noopener ugc nofollow" target="_blank"><em class="lc">https://github.com/ephraimbuddy/wsgi-tutorial</em></a><em class="lc">使用金字塔应用。然而，你可以使用django或flask应用程序。</em></p><p id="6314" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们将我们的应用程序上传到服务器中的<em class="lc"> pythonapp </em>主文件夹。记得登录到我们之前创建的pythonapp用户。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="0fb7" class="kx jl hi kt b fi ky kz l la lb">git clone <a class="ae kn" href="https://github.com/ephraimbuddy/pythonappp.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ephraimbuddy/wsgi-tutorial.git</a></span><span id="273b" class="kx jl hi kt b fi ld kz l la lb">cd wsgi-tutorial</span><span id="db29" class="kx jl hi kt b fi ld kz l la lb">#Now create a virtual environment here:<br/>python3 -m venv env</span><span id="ce1e" class="kx jl hi kt b fi ld kz l la lb">#Activate it:<br/>source env/bin/activate</span><span id="d79f" class="kx jl hi kt b fi ld kz l la lb"># Install your application:<br/>pip install -e .</span><span id="6bd2" class="kx jl hi kt b fi ld kz l la lb"># for django, install from your requirement file<br/>pip install -r requirements.txt</span></pre><h1 id="da3c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创造。MOD_wsgi和APACHE的WSGI模块，用于加载应用程序</h1><p id="1f93" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">Django已经有了wsgi.py文件。但是，如果您在服务器上托管多个应用程序，您需要更改此行</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="291d" class="kx jl hi kt b fi ky kz l la lb">os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'wsgi-tutorial.settings')</span></pre><p id="1438" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">到</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8ffa" class="kx jl hi kt b fi ky kz l la lb">os.environ['DJANGO_SETTINGS_MODULE']= 'wsgi-tutorial.settings'</span></pre><p id="90c8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">金字塔应用用途<em class="lc">。ini </em>设置，因此，我们将创建一个名为<em class="lc"> wsgi-tutorial.wsgi </em>的模块，并将其放在/var/www/wsgi-scripts/。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="66c4" class="kx jl hi kt b fi ky kz l la lb"># change working directory to /var/www<br/>cd /var/www</span><span id="ce13" class="kx jl hi kt b fi ld kz l la lb"># create wsgi-scripts directory<br/>sudo mkdir wsgi-scripts</span><span id="c6fc" class="kx jl hi kt b fi ld kz l la lb"># create the module:<br/>sudo vim wsgi-scripts/wsgi-tutorial.wsgi</span></pre><p id="47ef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的最后一个命令应该会打开<em class="lc"> wsgi-tutorial.wsgi。</em>打开时，按键盘键<em class="lc"> i </em>进入插入模式。将以下内容粘贴到打开的文件中</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9419" class="kx jl hi kt b fi ky kz l la lb">from pyramid.paster import get_app, setup_logging<br/>ini_path = '/home/pythonapp/wsgi-tutorial/production.ini'<br/>setup_logging(ini_path)<br/>application = get_app(ini_path, 'main')</span></pre><p id="bfb8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">按下<em class="lc"> esc </em>键，然后按下命令，关闭文件</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8a4b" class="kx jl hi kt b fi ky kz l la lb">:wq</span></pre><p id="0cb9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">烧瓶很简单。Mod_wsgi需要将<em class="lc">应用</em>实例<em class="lc"> </em>命名为<em class="lc">应用</em>而不仅仅是<em class="lc"> app。</em>然而，如果您使用一个名为<em class="lc"> create_app </em>的工厂函数创建了您的应用程序，那么您应该创建一个<em class="lc">。wsgi </em>文件，就像我们为pyramid做的那样，但是这次，内容应该是</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="7870" class="kx jl hi kt b fi ky kz l la lb">from yourapplication import create_app<br/>application = create_app()</span></pre><h1 id="3f26" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创建APACHE配置文件来服务您的应用程序</h1><p id="1977" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">导航到站点-可用目录</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="f62a" class="kx jl hi kt b fi ky kz l la lb">cd /etc/apache2/sites-available</span></pre><p id="7702" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建一个名为<em class="lc"> wsgi-tutorial.conf </em>的配置文件</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9575" class="kx jl hi kt b fi ky kz l la lb">sudo vim wsgi-tutorial.conf</span></pre><p id="d551" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将以下内容粘贴到打开的文件<strong class="io hj">(金字塔)</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="5fe6" class="kx jl hi kt b fi ky kz l la lb">&lt;VirtualHost *:80&gt;<br/>    ServerName example.com<br/>    ServerAlias <a class="ae kn" href="http://www.example.com" rel="noopener ugc nofollow" target="_blank">www.example.com</a><br/>    ServerAdmin webmaster@example.com<br/>        <br/>    DocumentRoot /var/www/wsgi-tutorial/<br/>        <br/>    Alias /static/ /var/www/wsgi-tutorial/static/<br/>   <br/>    &lt;Directory /var/www/wsgi-tutorial&gt;<br/>    Require all granted<br/>    &lt;/Directory&gt;</span><span id="a60e" class="kx jl hi kt b fi ld kz l la lb">    WSGIDaemonProcess example.com display-name=%{GROUP} python-path=/home/pythonapp/wsgi-tutorial/env/lib/python3.6/site-packages</span><span id="2e8d" class="kx jl hi kt b fi ld kz l la lb">    WSGIProcessGroup %{GLOBAL}<br/>    WSGIPassAuthorization On</span><span id="03f9" class="kx jl hi kt b fi ld kz l la lb">    WSGIScriptAlias / /var/www/wsgi-scripts/wsgi-tutorial.wsgi</span><span id="39b1" class="kx jl hi kt b fi ld kz l la lb">    &lt;Directory /var/www/wsgi-scripts&gt;<br/>    WSGIProcessGroup example.com<br/>    &lt;/Directory&gt;</span><span id="ca9d" class="kx jl hi kt b fi ld kz l la lb">&lt;/VirtualHost&gt;</span></pre><p id="d2d3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">照常保存并关闭它。如果你看，我们将<em class="lc"> DocumentRoot </em>设置为<em class="lc"> wsgi-tutorial </em>还不存在。让我们创建它</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="36d3" class="kx jl hi kt b fi ky kz l la lb">sudo mkdir /var/www/wsgi-tutorial</span></pre><p id="d96b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">类似的配置应该可以用于flask app。建议不要将您的主目录设置为DocumentRoot。</p><p id="d3d8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于Django，WSGIScriptAlias应该指向项目的wsgi.py文件。WSGIScriptAlias之后的目录应该从<em class="lc"> /var/www/wsgi-scripts </em>更改为<em class="lc">/home/python app/project _ name/project _ name/</em>。它应该指向wsgi.py文件所在的模块</p><p id="fe32" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">完成后，检查您的配置中是否有错误，如果有，就修复它</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="37c1" class="kx jl hi kt b fi ky kz l la lb">sudo apachectl configtest</span></pre><p id="7ded" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果没有错误，停用默认的apache站点并激活您的站点</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="3e94" class="kx jl hi kt b fi ky kz l la lb"># to deactivate enter command below<br/>sudo a2dissite 000-default.conf</span><span id="d790" class="kx jl hi kt b fi ld kz l la lb">#Activate your site <br/>sudo a2ensite wsgi-tutorial.conf</span></pre><h1 id="2238" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">提供静态文件</h1><p id="f51b" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">静态文件设置应该是从DocumentRoot到静态文件位置的符号链接。在我们的例子中，静态文件目录位于<em class="lc">/home/python app/wsgi-tutorial/wsgi _ tutorial/static。</em>创建符号链接，如下所示</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="c3d4" class="kx jl hi kt b fi ky kz l la lb">#navigate to DocumentRoot<br/>cd /var/www/wsgi-tutorial</span><span id="5cfd" class="kx jl hi kt b fi ld kz l la lb"># Add the symlink<br/>sudo ln -s /home/pythonapp/wsgi-tutorial/wsgi_tutorial/static static</span></pre><h2 id="3965" class="kx jl hi bd jm le lf lg jq lh li lj ju ix lk ll jy jb lm ln kc jf lo lp kg lq bi translated">文件权限</h2><p id="9cc6" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">建议使用以下文件权限</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="b003" class="kx jl hi kt b fi ky kz l la lb"># Give Apache group ownership and pythonapp user ownership<br/>sudo chown -R pythonapp:www-data /home/pythonapp/wsgi-tutorial</span><span id="4c8f" class="kx jl hi kt b fi ld kz l la lb"># Change permission to 750<br/>sudo chmod 750 -R /home/pythonapp/wsgi-tutorial</span><span id="4d01" class="kx jl hi kt b fi ld kz l la lb"># Cascade the permissions for new files<br/>sudo chmod g+s -R /home/pythonapp/wsgi-tutorial</span><span id="0251" class="kx jl hi kt b fi ld kz l la lb"># if you have an upload field give www-data write permission<br/>sudo chmod g+w -R /home/pythonapp/wsgi-tutorial/upload</span></pre><h1 id="d22c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">重新加载Apache</h1><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="517d" class="kx jl hi kt b fi ky kz l la lb">sudo systemctl reload apache2</span><span id="0169" class="kx jl hi kt b fi ld kz l la lb"># check status<br/>sudo systemctl status apache2</span></pre><p id="aa94" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">转到计算引擎，并点击您的实例外部IP，您的网站应该了。确保它是<em class="lc"> http </em>而不是<em class="lc"> https </em></p><p id="5e5b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">#结束。</strong></p></div></div>    
</body>
</html>