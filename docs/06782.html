<html>
<head>
<title>Snorkel: Build ML Models without Labeled Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通气管:构建没有标记数据的ML模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/snorkel-build-ml-models-without-labeled-data-21aa38b9d7a9?source=collection_archive---------12-----------------------#2020-06-02">https://medium.com/analytics-vidhya/snorkel-build-ml-models-without-labeled-data-21aa38b9d7a9?source=collection_archive---------12-----------------------#2020-06-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d4972eb5a1c3d2faadb8b9c80041df6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8chgbK6eoz_9AJaNSDIcA.jpeg"/></div></div></figure><p id="a1a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了大量的实践工具，对数据科学家来说，在有标签的数据上建立模型已经是一件容易的事情。然而，在现实世界中，许多任务都不是格式良好的监督学习问题:标记数据可能很昂贵，甚至不可能获得。另一种方法是利用廉价和低质量的数据来实现监管，这就是本文的主题:<strong class="is hj">弱监管</strong></p><p id="efe8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在接下来的部分中，我将介绍弱监管的概念。我还会介绍一个叫<a class="ae jo" href="https://www.snorkel.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">通气管</strong> </a>的工具，是斯坦福开发的。最后，我将向您展示HK01如何使用浮潜捕捉脸书的趋势话题，从而增强我们的推荐引擎。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="c8f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果没有大量高质量的人工标记的训练数据，有几种算法范例来补救这种情况。如下图所示，如果您没有足够的数据，您必须找到另一个知识来源，以实现与传统监管相当的监管水平。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jw"><img src="../Images/a5529df7204e2113f3841b8d4fa85bef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*i8Jzw4jiv22-HfHK.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">来源:<a class="ae jo" href="http://ai.stanford.edu/blog/weak-supervision/" rel="noopener ugc nofollow" target="_blank">http://ai.stanford.edu/blog/weak-supervision/</a></figcaption></figure><p id="5b3c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这些范例中选择一个是相当棘手的。这取决于你手上有什么。迁移学习对于在类似任务中具有训练有素的模型的任务非常有用，比如用自己的类别微调ImageNet模型；虽然您可能对拓扑结构有一些假设，例如簇的形状，但您可能更喜欢半监督学习。</p><p id="4e0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">那么，什么样的情况最适合弱监管呢？</strong></p><p id="b24b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">看了弱监管的定义你可能会有一些想法。是的，<em class="kf">如果你有大量的领域专家但缺乏数据，监管不力是你的选择</em>。</p><p id="fd44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">背后的原因在定义中透露出来:监管不力使得从低质量、嘈杂的标签中学习成为可能。换句话说，你仍然可以找到模式，就像监督学习所做的那样，除非你应该为每个训练样本补充多个有噪声的标签，以便模型可以从中归纳知识。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/172ded89c828d76aba1d7b25cc5aa900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nka5pMJ5iAWoxhC096jFvQ.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">弱监管使得多个嘈杂标签的监管成为可能</figcaption></figure><p id="98ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">监管不力的理由是，有噪声的数据通常比高质量的数据更容易获得，也更便宜。想象一下，你在一家保险公司工作，你的老板要求一个全新产品线的推荐引擎，当然，你没有数据。在销售专家的帮助下，我们可以制定一些“基本正确”的规则，比如新产品对老年人更有吸引力。这些规则并不完全正确；但是，它们足以为你的模型提供集体智慧。最重要的是，这些规则比完全手工标注的数据更容易获得。</p><p id="e920" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么，下一个问题是:<strong class="is hj">我们如何将这些规则注入到我们的ML模型中？</strong>答案是浮潜。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="e217" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">潜泳是一个由斯坦福大学开发的系统，它允许你将规则编程到ML模型中。该方法的核心思想是建立生成模型，表示真实标签和噪声标签之间的因果关系。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/ed55cd1729b904c440e77e256e8e5dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_D9vxDznuRJS-M94qfrGA.png"/></div></div></figure><p id="850d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图的左侧是表示从真实标签到有噪标签的生成过程的概率模型。虽然真实的标签是不可观测的，但我们仍然可以通过不同噪声标签的一致性和不一致性来学习准确性和相关性。因此，我们可以估计每个噪声标签的P(L|y ),这本质上是质量的指标。通过聚集噪声标签，我们获得估计的真实标签，并使用它来训练我们的模型。</p><p id="366a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在通气管中，噪音标签被编程为<strong class="is hj">标签功能</strong>。标签函数基本上是一个python函数，它硬编码一个规则来确定标签。例如，如果您正在编写一个程序来确定哪封电子邮件是垃圾邮件，该程序应该类似于:</p><pre class="jx jy jz ka fd ki kj kk kl aw km bi"><span id="1ea4" class="kn ko hi kj b fi kp kq l kr ks">from snorkel.labeling import labeling_function</span><span id="f7e2" class="kn ko hi kj b fi kt kq l kr ks">SPAM = 1<br/>NORMAL = 0<br/>ABSTAIN = -1</span><span id="4ed0" class="kn ko hi kj b fi kt kq l kr ks">@labeling_function()<br/>def contain_hyperlink(x):<br/>    if 'http' in x:<br/>        return SPAM <br/>    else:<br/>        return NORMAL</span><span id="2c19" class="kn ko hi kj b fi kt kq l kr ks">@labeling_function()<br/>def contain_foul_language(x):<br/>    for each in x:<br/>        if each in foul_language:<br/>            return SPAM<br/>        else:<br/>            return NORMAL</span></pre><p id="0967" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个玩具例子中，你可以看到浮潜的基本要素。</p><ul class=""><li id="c9c4" class="ku kv hi is b it iu ix iy jb kw jf kx jj ky jn kz la lb lc bi translated">定义标签。在这个例子中，标签是垃圾邮件、正常和弃权。absent是在无法确定标签时使用的标签。</li><li id="11f5" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn kz la lb lc bi translated">定义标签功能。添加一个decorator <code class="du li lj lk kj b">@labeling_function()</code>来声明。</li></ul><p id="2efd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">定义标注和标注函数后，可以将标注函数应用于数据集并估计最佳标注:</p><pre class="jx jy jz ka fd ki kj kk kl aw km bi"><span id="7556" class="kn ko hi kj b fi kp kq l kr ks">from snorkel.labeling import PandasLFApplier, LabelModel</span><span id="0b69" class="kn ko hi kj b fi kt kq l kr ks">lfs = [contain_hyperlink, contain_foul_language]</span><span id="0dcf" class="kn ko hi kj b fi kt kq l kr ks">applier = PandasLFApplier(lfs=lfs)<br/>overall_result = applier.apply(df=dataset, progress_bar=False)</span><span id="95c1" class="kn ko hi kj b fi kt kq l kr ks">label_model = LabelModel(cardinality=2, verbose=True)<br/>label_model.fit(L_train=overall_result, n_epochs=100, lr=0.001, log_freq=100, seed=123)</span><span id="579e" class="kn ko hi kj b fi kt kq l kr ks">score = label_model.predict_proba(overall_result)</span></pre><ul class=""><li id="374b" class="ku kv hi is b it iu ix iy jb kw jf kx jj ky jn kz la lb lc bi translated">声明一个标签函数列表<code class="du li lj lk kj b">lfs</code></li><li id="9ed3" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn kz la lb lc bi translated">创建一个应用程序，将标注函数应用到你的数据集，以获得噪声标注<code class="du li lj lk kj b">overall_result</code></li><li id="3626" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn kz la lb lc bi translated">创建一个创成式模型<code class="du li lj lk kj b">label_model</code>来解决嘈杂标签之间的冲突</li><li id="0ccb" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn kz la lb lc bi translated">得到训练样本的预测概率<code class="du li lj lk kj b">score</code></li></ul><p id="0f81" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，<code class="du li lj lk kj b">score</code>可以作为训练你的模型的估计标签。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="7074" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在HK01中，我们的任务之一是捕捉社会媒体中的热门话题。这项任务的成功可以提高我们建议的质量。此外，它还为我们提供了有关新闻重要性的额外信息。</p><p id="3046" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">挑战之一是将热门话题与我们现有的新闻进行匹配。显然，手工标注匹配是非常低效的，因为我们必须为每个主题浏览成千上万的文章。然而，有经验的编辑可以运用他们的领域知识来过滤无关的文章。</p><p id="e75c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还应用机器学习和自然语言处理算法来构建标注函数。例如，我们使用命名实体识别和标记化来快速识别关键词，以便我们可以计算趋势主题和现有文章之间的距离。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="964c" class="kn ko hi bd ll lm ln lo lp lq lr ls lt jb lu lv lw jf lx ly lz jj ma mb mc md bi translated">参考</h2><ol class=""><li id="e4cf" class="ku kv hi is b it me ix mf jb mg jf mh jj mi jn mj la lb lc bi translated"><a class="ae jo" href="http://ai.stanford.edu/blog/weak-supervision/" rel="noopener ugc nofollow" target="_blank">http://ai.stanford.edu/blog/weak-supervision/</a></li><li id="3241" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn mj la lb lc bi translated">【https://www.snorkel.org/ T2】号</li><li id="6adf" class="ku kv hi is b it ld ix le jb lf jf lg jj lh jn mj la lb lc bi translated">【https://arxiv.org/pdf/1711.10160.pdf T4】</li></ol></div></div>    
</body>
</html>