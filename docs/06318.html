<html>
<head>
<title>Deep Learning tutorial with Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Keras深度学习教程</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deep-learning-tutorial-with-keras-7a34a1a322cd?source=collection_archive---------4-----------------------#2020-05-18">https://medium.com/analytics-vidhya/deep-learning-tutorial-with-keras-7a34a1a322cd?source=collection_archive---------4-----------------------#2020-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/822f414a96878e853fe6f91ddaaa97ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*DKu_54iqz6C-p6ndo7rO3g.png"/></div></figure><p id="afe9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">深度学习是一种机器学习方法，研究具有许多层的网络。在本教程中，您将使用Keras构建一个神经网络。</p><h1 id="dc82" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">目标</h1><ol class=""><li id="a70a" class="ki kj hi io b ip kk it kl ix km jb kn jf ko jj kp kq kr ks bi translated">Keras简介</li><li id="32b2" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj kp kq kr ks bi translated">张量流、Keras和Theano之间的关系</li><li id="058a" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj kp kq kr ks bi translated">使用Keras的优势以及它如何让一切变得简单</li><li id="d509" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj kp kq kr ks bi translated">用Keras训练神经网络</li></ol><h1 id="00d5" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">先决条件</h1><p id="8935" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">在继续之前，您应该对以下技术有所了解</p><ul class=""><li id="f80f" class="ki kj hi io b ip iq it iu ix lb jb lc jf ld jj le kq kr ks bi translated">机器学习</li><li id="8aa1" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">计算机编程语言</li></ul><h1 id="2a5b" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">要求</h1><p id="dc85" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">下列库是必需的，因此请确保您已经安装了它们:</p><ul class=""><li id="d46b" class="ki kj hi io b ip iq it iu ix lb jb lc jf ld jj le kq kr ks bi translated">张量流</li><li id="c637" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">克拉斯</li></ul><p id="07da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">安装Keras </strong></p><p id="6852" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要安装Keras，请使用pip包，如下所示:</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h1 id="df42" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">Keras简介</h1><p id="5a21" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">Keras是一个高级神经网络。它使得以快速有效的方式实现深度学习模型成为可能。Keras中最简单的模型被称为序列模型，定义如下。</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h1 id="ef28" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">TensorFlow，Keras，Theano。</h1><p id="02a3" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">Keras是一个用于构建深度神经网络的高级库。当你谈到高级，它意味着简单和人类可读。你不会深入研究神经网络的所有数学概念，但你只会专注于构建深度学习网络。</p><p id="483a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Keras利用张量流(谷歌)或Theano后端(蒙特利尔的Theano)赋予它计算能力；这意味着Keras库可以在张量流和Theano框架上运行。选择使用哪种框架取决于您的喜好。然而，在本教程中，你将使用张量流作为我们的后端。</p><h1 id="7e29" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">为什么是Keras？</h1><p id="1402" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">Keras这些年来越来越受欢迎，因为它利用了张量流和Theano。其他优势包括:</p><ul class=""><li id="5d1c" class="ki kj hi io b ip iq it iu ix lb jb lc jf ld jj le kq kr ks bi translated">它利用了python，这是非常容易学习和使用。</li><li id="c9ca" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">这是初学者友好的。</li><li id="4843" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">易于构建网络——与其他框架相比，您只需几行代码就可以在Keras中快速构建一个简单或深度的网络。</li><li id="878f" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">Keras还提供对GPU和CPU的支持。</li></ul><h1 id="4001" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">韵律学</h1><p id="313c" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">指标是用于判断模型性能的函数。度量极大地影响深度学习算法的性能；因此，选择正确的指标以确保您的模型按预期执行是至关重要的。</p><p id="4989" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Keras中提供的一些指标包括:</p><ul class=""><li id="7475" class="ki kj hi io b ip iq it iu ix lb jb lc jf ld jj le kq kr ks bi translated">二进制精度</li><li id="be35" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">分类准确性</li><li id="918a" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">稀疏分类准确性</li><li id="f6ea" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">top _ k _ categorical _ accuracy</li><li id="6e70" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">sparse _ top _ k _ categorical _ accuracy</li><li id="1eee" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">自定义指标</li></ul><p id="4425" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">不同的模型在用不同的指标评估时会给出不同的结果。例如，只有当您的训练集具有属于每个类的相同数量的样本时，像“准确性”这样的度量才会表现得更好。</p><p id="b344" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，仅仅用一种度量标准来真正判断你的模型是不够的。</p><h1 id="0adc" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">训练/测试分割</h1><p id="aedf" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">训练/测试拆分是一个概念，涉及在训练集和测试集之间拆分数据，然后在训练数据上拟合模型。拟合模型以对测试数据进行预测，然后评估这些预测的技巧。</p><p id="8fb7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">训练/测试分割主要用于避免过度拟合。</p><p id="6eb3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当训练模型给出的精度几乎太接近训练数据集时，就会发生过度拟合。尽管我们的目标始终是获得一个好的预测，但当它开始对新数据进行训练时，过度拟合将导致不准确的指示。</p><h1 id="c595" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">imdb数据集</h1><p id="9aeb" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">根据该网站</p><p id="e038" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">“来自IMDB的25，000个电影评论的数据集，由情绪(正面/负面)标记。评论已经过预处理，每个评论都被编码成一个单词索引(整数)序列。为方便起见，单词按数据集中的总频率进行索引，例如，整数“3”编码数据中第三个最频繁出现的单词。这允许快速过滤操作，例如:“仅考虑前10，000个最常用的单词，但排除前20个最常用的单词”。</p><p id="fa48" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">按照惯例，“0”不代表特定的单词，而是用于编码任何未知的单词。</p><p id="dc05" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">imdb数据集将构成我们在本教程中讨论的基础，您将使用它来构建神经网络并使用它进行预测。</p><h2 id="eaa2" class="ll jl hi bd jm lm ln lo jq lp lq lr ju ix ls lt jy jb lu lv kc jf lw lx kg ly bi translated">建立并训练一个神经网络</h2><p id="0f76" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">您将执行以下操作:</p><ul class=""><li id="5b07" class="ki kj hi io b ip iq it iu ix lb jb lc jf ld jj le kq kr ks bi translated">导入imdb数据集。</li><li id="9272" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">准备数据集进行处理。</li><li id="5693" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">创建模型。</li><li id="8c4e" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">培训。</li><li id="6d0c" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">评价。</li><li id="f8ff" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">预测。</li></ul><h2 id="2646" class="ll jl hi bd jm lm ln lo jq lp lq lr ju ix ls lt jy jb lu lv kc jf lw lx kg ly bi translated">1.导入imdb数据集</h2><p id="c6c7" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">继续导入数据集。</p><p id="7a8e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数据是预先打包的，每个整数代表字典中的一个特定单词。</p><p id="cee6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">https://gist.github.com/c28614e24aee74bf94ed91fc6ad58abf</p><p id="0118" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后加载评论，如下所示:</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="4c80" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过查看数据集的形状，可以确认每组数据集包含25，000条电影评论。</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="04d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Keras要求所有评论长度相同，所以你需要让它们长度相同。在这种情况下，您可以选择最长的评论作为默认长度，也可以选择标准长度。这意味着比标准长度更长的评论将被截断。</p><p id="e16a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您将使用标准长度100:</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="6ae5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们通过将结果打印到控制台来查看填充的结果:</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="9b21" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如您所见，数组长度相等。</p><h2 id="e873" class="ll jl hi bd jm lm ln lo jq lp lq lr ju ix ls lt jy jb lu lv kc jf lw lx kg ly bi translated">2.创建模型。</h2><p id="1108" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">现在数据已经准备好了，您可以继续构建我们的模型了。模型是Keras的核心数据结构，也是Keras中各层的组织方式。最简单的模型类型是顺序模型，其定义如下:</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h2 id="76a0" class="ll jl hi bd jm lm ln lo jq lp lq lr ju ix ls lt jy jb lu lv kc jf lw lx kg ly bi translated">3.添加层</h2><p id="a583" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">神经网络主要包括三种类型的层，即输入层、隐藏层和输出层。输入层用于向网络提供原始数据，然后将数据传递给隐藏层进行处理。</p><p id="1940" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">隐藏层将通过学习数据的不同方面来处理数据。当处理数据时，数据可以被分解成更小的单元，以便像人脑那样更容易处理数据的不同组成部分。输出图层是您获得结果的地方。</p><p id="6ea9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有不同类型的层，最常用的层有:</p><ul class=""><li id="c05c" class="ki kj hi io b ip iq it iu ix lb jb lc jf ld jj le kq kr ks bi translated">致密层</li><li id="6177" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">循环层</li><li id="8371" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">标准化图层</li><li id="b4cb" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">卷积层</li><li id="6e69" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated">其他人</li></ul><p id="966d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">不同的层对数据执行不同的转换，有些层比其他层更适合某些任务。例如，卷积层最适合包含图像的数据，而嵌入层最适合包含文本的数据。</p><p id="c9d3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们开始堆积层。</p><p id="8d84" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一层将是嵌入层，它将每个单词转换为单词向量。</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="4ede" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，添加在<strong class="io hj"><em class="lz">keras . layers . lstm</em></strong>中找到的LSTM图层。首选LSTM图层，因为它们可以了解数据的长期相关性，从而做出准确的预测。LSTM将把向量序列转换成单个向量。</p><p id="a959" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们继续添加LSTM层。</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="34ae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，您将从keras.layers.Dense添加一个简单的密集图层。密集图层是一种将图层中的每个输入连接到每个输出的图层。</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h2 id="05d6" class="ll jl hi bd jm lm ln lo jq lp lq lr ju ix ls lt jy jb lu lv kc jf lw lx kg ly bi translated">4.编译模型</h2><p id="d96c" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">在编译模型时，您必须定义一些决定模型性能的指标。这里，您将损失(成本函数)设置为binary_crossentrophy，将度量设置为accuracy。这意味着最大限度地提高算法的准确性。</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h2 id="72ac" class="ll jl hi bd jm lm ln lo jq lp lq lr ju ix ls lt jy jb lu lv kc jf lw lx kg ly bi translated">5.培养</h2><p id="602b" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">现在您已经准备好训练模型了。在模型上调用fit函数并传递附加参数，即</p><ul class=""><li id="4976" class="ki kj hi io b ip iq it iu ix lb jb lc jf ld jj le kq kr ks bi translated"><strong class="io hj">纪元</strong> —代表你在训练集中完成的循环次数。</li><li id="23bb" class="ki kj hi io b ip kt it ku ix kv jb kw jf kx jj le kq kr ks bi translated"><strong class="io hj">batch _ size</strong>-表示在网络学习过程中用于训练网络的训练样本的大小。</li></ul><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="44f8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">结果如下所示。模型执行准确率83%，损耗0.4，这是好事。</p><p id="a59e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">模型精度</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h1 id="9bae" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">结论</h1><p id="ba43" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix ky iz ja jb kz jd je jf la jh ji jj hb bi translated">如您所见，Keras提供了一种简单有效的方法来构建神经网络，而没有其他低级库带来的所有瓶颈。</p></div></div>    
</body>
</html>