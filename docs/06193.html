<html>
<head>
<title>Pydrive to download from Google Drive to a remote machine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pydrive从Google Drive下载到远程机器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pydrive-to-download-from-google-drive-to-a-remote-machine-14c2d086e84e?source=collection_archive---------2-----------------------#2020-05-14">https://medium.com/analytics-vidhya/pydrive-to-download-from-google-drive-to-a-remote-machine-14c2d086e84e?source=collection_archive---------2-----------------------#2020-05-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><ol class=""><li id="adc9" class="if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw bi translated"><strong class="ih hj">安装PYDRIVE </strong></li></ol><p id="9cc2" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">在您想要从Google drive下载文件的远程机器上，使用pip命令安装PyDrive</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="f036" class="jv jw hi jr b fi jx jy l jz ka">$ pip3 install PyDrive</span></pre><p id="edf5" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated"><strong class="ih hj"> 2。OAuth验证:正在下载client_secrets.json文件。</strong></p><p id="0a42" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">驱动器API需要OAuth2.0进行身份验证。转到<a class="ae kb" href="https://console.developers.google.com/iam-admin/projects" rel="noopener ugc nofollow" target="_blank">API控制台</a>并创建您的项目。当你点击链接时，你将被带到你的谷歌云开发者控制台。单击“创建项目”创建一个新项目。在项目仪表板中搜索“Google Drive API ”,选择条目，然后单击“启用”。</p><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kc"><img src="../Images/4b5c7d783f040964e2ff5d21a9ce9ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iaGMWDmJwsYjpA7s8tS2HA.png"/></div></div></figure><p id="7cdb" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">从左侧菜单中选择“凭据”，单击“创建凭据”。点击配置同意屏幕。</p><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kk"><img src="../Images/35c292ad57fb7cca6a7c84bccf34bd5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYmkCeDbQUPagKI9GdZUcA.png"/></div></div></figure><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kl"><img src="../Images/e6e0cd8f17f2802ab349c42ef528aee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TGmMed25_cjHjm2OWjEqpA.png"/></div></div></figure><p id="58ff" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">如下所示配置OAuth同意。</p><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es km"><img src="../Images/3641156423e3ad8e3d7882f5b3b575b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOD8ZZfEom99yk74VgupGA.png"/></div></div></figure><p id="8bc3" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">完成OAuth同意后，单击OAuth客户端ID。</p><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kn"><img src="../Images/e1ad1b982e4af9d5679fa995a3725155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L5lg8qSenFKVhgzFEyrT2Q.png"/></div></div></figure><p id="7c33" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">为“应用程序类型”选择“其他”,并为OAuth客户机ID命名，然后单击“创建”。</p><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es ko"><img src="../Images/f36d6715203425bc6d3659f9345eeda1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTYDMvBXlmIb3zIJC2-VtA.png"/></div></div></figure><p id="ef41" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">一旦创建了OAuth客户端ID，您就可以下载“client_*************”。json。这个json文件包含应用程序的所有身份验证信息。将文件重命名为“client_secrets.json ”,并将其放在您的工作目录中。</p><p id="bae0" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated"><strong class="ih hj"> 3。对远程机器</strong>使用CommanLineAuth()</p><p id="0a35" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">使用下面的代码，在与client_secrets.json文件相同的文件夹中创建<em class="kp"> quickstart.py </em>文件。我们使用CommandLineAuth()，因为<a class="ae kb" href="https://pythonhosted.org/PyDrive/pydrive.html#pydrive.auth.GoogleAuth.CommandLineAuth" rel="noopener ugc nofollow" target="_blank"> CommandLineAuth() </a>从用户的命令行获取代码。在quickstart.py中键入以下命令</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="b206" class="jv jw hi jr b fi jx jy l jz ka">from pydrive.auth import GoogleAuth</span><span id="051a" class="jv jw hi jr b fi kq jy l jz ka">from pydrive.drive import GoogleDrive</span><span id="05e9" class="jv jw hi jr b fi kq jy l jz ka">gauth = GoogleAuth()</span><span id="59bf" class="jv jw hi jr b fi kq jy l jz ka">gauth.CommandLineAuth()</span><span id="47dd" class="jv jw hi jr b fi kq jy l jz ka">drive = GoogleDrive(gauth)</span></pre><p id="fae0" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">当您运行quickstart.py时，您将获得链接以获取验证码，如下所示。将链接复制到浏览器，从浏览器获取验证码并粘贴。</p><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kr"><img src="../Images/0be5386097884d29726535f3bc837b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BxpaVuroXkqdGm-AsREfw.png"/></div></div></figure><p id="69d6" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">一旦你输入验证码-你会得到'认证成功'。</p><p id="101c" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">要获得驱动器中所有文件的列表，请将此代码添加到quickstart.py中</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="78df" class="jv jw hi jr b fi jx jy l jz ka">file_list = drive.ListFile({‘q’: “‘root’ in parents and trashed=false”}).GetList()</span><span id="2af9" class="jv jw hi jr b fi kq jy l jz ka">for file in file_list:<br/>    print(‘title: %s, id: %s’ % (file[‘title’], file[‘id’]))</span></pre><p id="645e" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">这将列出根目录中所有文件的标题和id。</p><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es ks"><img src="../Images/7a014e8855fe2fdb42475f03e6cbf45d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nny2mm33xM4iZ-LvevXM4w.png"/></div></div></figure><p id="c1e0" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">要下载特定目录中的所有文件，请获取该目录的id，并使用GetContentFile()下载所有文件。</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="a75c" class="jv jw hi jr b fi jx jy l jz ka">file_list = drive.ListFile({‘q’: “‘*******-4GVR2j****RdPSGquB-***’ in parents and trashed=false”}).GetList()</span><span id="99fd" class="jv jw hi jr b fi kq jy l jz ka">for file in file_list:<br/>    print(‘title: %s, id: %s’ % (file[‘title’],file[‘id’]))<br/>    file.GetContentFile(file[‘title’])</span></pre><p id="2022" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">每次运行quickstart.py时，都会要求您输入验证码。为了自动化验证，您可以将settings.yaml文件添加到您的文件夹中。将以下代码添加到settings.yaml文件中。对于client_config下的' client_id '和' client_secret ',从client_secrets.json文件中复制它们。另外，使用vim在文件夹中创建一个名为creds.json的空文件。</p><p id="d66c" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">注意— creds.json将在您第一次运行quickstart.py时自动获取所有凭据。所以这里一开始就是空的。</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="6598" class="jv jw hi jr b fi jx jy l jz ka">client_config_backend: ‘settings’<br/>client_config:<br/>   client_id: “{client_id from client_secrets.json}”<br/>   client_secret: “{client_secret from client_secrets.json}”<br/>save_credentials: True<br/>save_credentials_backend: ‘file'<br/>save_credentials_file: ‘creds.json’<br/>oauth_scope:<br/>- “https://www.googleapis.com/auth/drive"</span></pre><p id="7113" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">基本上，当前工作文件夹应该包含以下所有文件。</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="fdc1" class="jv jw hi jr b fi jx jy l jz ka">quickstart.py<br/>creds.json<br/>settings.yaml<br/>client_secrets.json</span></pre><p id="da95" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">添加settings.yaml文件后，第一次运行quickstart.py时，会提示输入验证码。一旦第一次成功通过身份验证，您的登录凭证就会保存到creds.json文件中。当您稍后运行quickstart.py时，身份验证会自动进行。</p><p id="a2de" class="pw-post-body-paragraph ix iy hi ih b ii ij iz ja ik il jb jc im jd je jf io jg jh ji iq jj jk jl is hb bi translated">代码可从<a class="ae kb" href="https://github.com/bhuvanakundumani/pydrive_4_remotemachine.git" rel="noopener ugc nofollow" target="_blank">https://github . com/bhuvanakundumani/py drive _ 4 _ remote machine . git</a>获得</p></div></div>    
</body>
</html>