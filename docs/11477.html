<html>
<head>
<title>Scrape data from Wikipedia using Python BeautifulSoup and Pandas library in few steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python BeautifulSoup 和 Pandas 库只需几个步骤就可以从维基百科中抓取数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/scrape-data-from-wikipedia-using-python-beautifulsoup-and-pandas-library-in-few-steps-5cda49e4dfc1?source=collection_archive---------3-----------------------#2020-12-05">https://medium.com/analytics-vidhya/scrape-data-from-wikipedia-using-python-beautifulsoup-and-pandas-library-in-few-steps-5cda49e4dfc1?source=collection_archive---------3-----------------------#2020-12-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7675" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你是否曾经非常需要维基百科表格或其他网站上的数据，以至于你希望有一种方法可以复制这些数据并随时更新？此外，您知道数据可能会发生变化，保持报告和分析更新的唯一方法是自动连接到数据。</p><p id="0dfc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我打赌你和我一样也经历过这种情况。我要向你们展示的是我使用的一个简单的救生步骤。这种方法适用于你在不同网站上看到的大多数表格，例如<a class="ae jd" href="https://en.wikipedia.org/" rel="noopener ugc nofollow" target="_blank">维基百科</a>，<a class="ae jd" href="https://www.worldometers.info/" rel="noopener ugc nofollow" target="_blank">世界人口统计</a>，<a class="ae jd" href="https://worldpopulationreview.com/" rel="noopener ugc nofollow" target="_blank">世界人口评论</a>等等</p><p id="e596" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，我们开始吧。</p><p id="bda9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用 python 和 jupyter notebook 来完成这个任务，我们将使用下面的 python 库</p><ol class=""><li id="5e9f" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">熊猫</li><li id="6f47" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">请求</li><li id="9283" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">美丽的声音</li><li id="f3cc" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">铼</li></ol><p id="8d0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在尝试从任何网站搜集数据之前，我喜欢遵循以下步骤:</p><ol class=""><li id="8942" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">定义我的目标</li><li id="edb8" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">检查网站 HTML 标签并识别适当的表格标签</li><li id="1228" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">将我的代码付诸实践</li></ol><h2 id="0092" class="js jt hi bd ju jv jw jx jy jz ka kb kc iq kd ke kf iu kg kh ki iy kj kk kl km bi translated">定义我的目标</h2><p id="68ca" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我这个任务的目标是从维基百科上刮出由国际货币基金组织估算的名义 GDP 的国家名单</p><p id="834b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我需要的数据可以在这里找到<a class="ae jd" href="https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)" rel="noopener ugc nofollow" target="_blank">以及其他国际机构的类似表格，但我的主要目标是从国际货币基金组织获得数据</a></p><h2 id="980e" class="js jt hi bd ju jv jw jx jy jz ka kb kc iq kd ke kf iu kg kh ki iy kj kk kl km bi translated">检查网站 HTML 标签并识别适当的表格标签</h2><p id="6f5c" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">下一步是打开网站，检查网站的 HTML 并找到适当的表格。</p><p id="7689" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你右击网页上的任何地方，你会看到一个检查网站 HTML 代码的选项(或者使用 CTRL + Shift +I)。我正在使用谷歌浏览器进行演示，下面是我检查桌子时看到的截图。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ks"><img src="../Images/81001dfbbc0ed7836aa8d99a88ee93bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xR115Ex6e2DkLO65ZepUcA.png"/></div></div></figure><p id="238f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您将光标切换到 HTML 元素上，您的浏览器将突出显示 HTML 所代表的表格或网站的部分。切换，直到您可以获得包含感兴趣的表的表标记。在我的例子中，我正在寻找的 table 标签有下面的类<em class="le">“wiki table sortable jquery-table sorter”(稍后将详细介绍)</em></p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lf"><img src="../Images/8b8592e0fd771197cab7290fcfbc43a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v4O5KcjH5EaiOQ4kKnLOcA.png"/></div></div></figure><p id="91e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经找到了感兴趣的表格，是时候进入下一步了</p><h2 id="0508" class="js jt hi bd ju jv jw jx jy jz ka kb kc iq kd ke kf iu kg kh ki iy kj kk kl km bi translated">将我的代码付诸实践</h2><p id="a549" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我将从导入上面列出的所有库开始。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lg"><img src="../Images/a08cff418de359327d1a732a3bd6df56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJc2iPZCHxEAfOZX7NjsUQ.png"/></div></div></figure><p id="e96d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将使用 get()函数将请求库付诸实施。请参见下面的示例代码。打印响应以查看输出，并记住添加<em class="le">。text </em>以纯文本形式查看响应<em class="le">，</em>如果没有响应，您将看到的是<em class="le"> </em> <strong class="ih hj"> &lt;响应【200】&gt;</strong>(两者都可以，但我们需要文本来进行下一步)</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lh"><img src="../Images/e5fba4e1d94fd6a3751a464923becbbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S38zvPtBdn4FjvvdiVWFwg.png"/></div></div></figure><p id="aac2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将使用 BeautifulSoup 库解析使用<em class="le"> re.get() </em>函数返回的响应，并使用 pandas 创建一个 DataFrame。<strong class="ih hj"> <em class="le">记下我传给我的汤下面的类</em> </strong></p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es li"><img src="../Images/02698655ce2c755a3146ab671aa26f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sekZidzyQaovUgY2AEdxJA.png"/></div></div></figure><blockquote class="lj lk ll"><p id="0a82" class="if ig le ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">您会注意到我传递到表中的类与我们在检查上面的 HTML 时识别的不同。在一些网站上获取 table 类很容易，而在另一些网站上，你需要聪明地找到正确的 table 标签。</p><p id="b4b8" class="if ig le ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">从 Wikipedia 获取 HTML 后，类名变成了“wikitable sorttable ”,如果不识别正确的标签，我们就无法轻松地获取该表。</p><p id="7bb3" class="if ig le ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">聪明的做法是使用浏览器搜索在您的回复文本中找到该表。我通常做的是从表中复制一个值，并在浏览器中搜索它，然后追溯到表类(我在 IMF 表上复制了世界人口，并使用浏览器搜索— 83，844，988)。见下图</p></blockquote><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lp"><img src="../Images/1039de650027aeb8089e7a91ee5053f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-R-vU3pasrF-REJwH0huA.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">搜索浏览器以查找表类</figcaption></figure><p id="e0da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就这样，你成功地刮出了你的维基百科表格</p><p id="de8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很少需要清理，查看国家列，您会看到一些国家的名称后面附加了<em class="le">【N2】【n3】</em>，叙利亚的数据没有报告(您可以决定删除或更改 GDP 数据为零)。您可以使用以下代码清理您的数据框</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lu"><img src="../Images/f47b9fecc693cac91e83799fa2219f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Yf1DsaNihZdySDUMq-OyQ.png"/></div></div></figure><h2 id="da1a" class="js jt hi bd ju jv jw jx jy jz ka kb kc iq kd ke kf iu kg kh ki iy kj kk kl km bi translated"><strong class="ak">完成</strong></h2><p id="6f7a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">你可以在<a class="ae jd" href="https://github.com/raymonbell01/Scrape_Wikipedia_Table/edit/main/README.md" rel="noopener ugc nofollow" target="_blank"> Github </a>上访问代码</p></div></div>    
</body>
</html>