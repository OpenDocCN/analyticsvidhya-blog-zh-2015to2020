<html>
<head>
<title>Hands on Data Pre-Processing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动手进行数据预处理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hands-on-data-pre-processing-55c9f72df968?source=collection_archive---------15-----------------------#2020-10-21">https://medium.com/analytics-vidhya/hands-on-data-pre-processing-55c9f72df968?source=collection_archive---------15-----------------------#2020-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e7c474b120f266436f30b83730bb05eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*v0ADjUDAAr2H14fP.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片由<a class="ae iu" href="https://www.google.com/search?q=mountain++imags&amp;tbm=isch&amp;ved=2ahUKEwjU29yL3sXsAhX-zHMBHW0HDLIQ2-cCegQIABAA&amp;oq=mountain++imags&amp;gs_lcp=CgNpbWcQAzIGCAAQChAYOgQIIxAnOgQIABBDOgcIABCxAxBDOgIIADoFCAAQsQNQ0x1Ylk9ggFJoAnAAeACAAbIBiAGKEJIBBDAuMTWYAQCgAQGqAQtnd3Mtd2l6LWltZ8ABAQ&amp;sclient=img&amp;ei=ETCQX5SPH_6Zz7sP7Y6wkAs&amp;bih=657&amp;biw=1366#imgrc=5YrD9vkMctSspM" rel="noopener ugc nofollow" target="_blank"> ThoughtCo </a>提供</figcaption></figure><blockquote class="iv iw ix"><p id="17e2" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jb hj">什么是数据预处理？</strong></p></blockquote><p id="1ada" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">原始数据集不会以机器可读的格式提供。通过<strong class="jb hj">清理</strong>、<strong class="jb hj">操作、标准化、编码、组织</strong>等操作来转换原始数据集以使其可被机器读取的过程称为数据预处理。</p><p id="9101" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在这篇博客中，我们将对<strong class="jb hj">黑色星期五数据集进行数据预处理。</strong></p><h2 id="a5fc" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated"><strong class="ak">第一步:导入有用的库</strong></h2><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="819b" class="ka kb hi la b fi le lf l lg lh">import numpy as np<br/>import pandas as pd<br/>from sklearn.preprocessing import StandardScaler<br/>from sklearn.model_selection import train_test_split</span></pre><h2 id="e4f3" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated"><strong class="ak">步骤 2:采集数据集</strong></h2><p id="e1e7" class="pw-post-body-paragraph iy iz hi jb b jc li je jf jg lj ji jj jx lk jm jn jy ll jq jr jz lm ju jv jw hb bi translated">现在我们将从这里获取 csv 格式的<a class="ae iu" href="https://www.kaggle.com/sdolezel/black-friday" rel="noopener ugc nofollow" target="_blank"> <strong class="jb hj">黑色星期五数据集</strong> </a> <strong class="jb hj"> </strong>进行进一步操作。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="d943" class="ka kb hi la b fi le lf l lg lh">df_train=pd.read_csv("blackFriday_train.csv")<br/>df_test=pd.read_csv("blackFriday_test.csv")<br/>df_train.head()   #Viewing 1st five rows of train dataset<br/>df_test.head()    ##Viewing 1st five rows of test dataset</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/a1ca024d5abe00637beaaeb0541401d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*or52SXAL3qVw_0b-GFzBQg.png"/></div></div></figure><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="16e6" class="ka kb hi la b fi le lf l lg lh"># Checking shape of df_train and df_test<br/>&gt;&gt; df_train.shape<br/>[out]&gt;&gt; (550068, 12)</span><span id="b84e" class="ka kb hi la b fi lo lf l lg lh">&gt;&gt; df_test.shape<br/>[out]&gt;&gt;(233599, 11)</span></pre><p id="c434" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我们将组合<strong class="jb hj">训练</strong>和<strong class="jb hj">测试</strong>数据集，因为我们不喜欢两次进行相同的<strong class="jb hj">数据操作、清理、编码等</strong>操作。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="739c" class="ka kb hi la b fi le lf l lg lh">#Combining df_train and df_test<br/>df=df_train.append(df_test)<br/>df.shape<br/>[out]&gt;&gt; (783667, 12)</span></pre><h2 id="661c" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated"><strong class="ak">第三步:了解数据集</strong></h2><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b39a" class="ka kb hi la b fi le lf l lg lh"><strong class="la hj"> &gt;&gt; df.columns</strong> # print all the column present in dataset</span><span id="98ee" class="ka kb hi la b fi lo lf l lg lh">[out]&gt;&gt; Index(['Product_ID', 'Gender', 'Age', 'Occupation', 'City_Category','Stay_In_Current_City_Years', 'Marital_Status', 'Product_Category_1','Product_Category_2', 'Product_Category_3', 'Purchase'],dtype='object')</span></pre><p id="9e29" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我们将检查每列包含哪种数据类型。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9fbc" class="ka kb hi la b fi le lf l lg lh"><strong class="la hj">&gt;&gt; df.dtypes</strong></span><span id="8485" class="ka kb hi la b fi lo lf l lg lh">[out]&gt;&gt; User_ID                         int64<br/>        Product_ID                     object<br/>        Gender                         object<br/>        Age                            object<br/>        Occupation                      int64<br/>        City_Category                  object<br/>        Stay_In_Current_City_Years     object<br/>        Marital_Status                  int64<br/>        Product_Category_1              int64<br/>        Product_Category_2            float64<br/>        Product_Category_3            float64<br/>        Purchase                      float64<br/>        dtype: object</span></pre><p id="f2e2" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在这里，我们将检查数据集中是否存在任何<strong class="jb hj">空值</strong>，如果是，那么我们将对<strong class="jb hj">空值</strong>进行计数。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="67ba" class="ka kb hi la b fi le lf l lg lh"><strong class="la hj">&gt;&gt; df.isnull().sum()</strong></span><span id="c861" class="ka kb hi la b fi lo lf l lg lh">[out]&gt;&gt; User_ID                            0<br/>        Product_ID                         0<br/>        Gender                             0<br/>        Age                                0<br/>        Occupation                         0<br/>        City_Category                      0<br/>        Stay_In_Current_City_Years         0<br/>        Marital_Status                     0<br/>        Product_Category_1                 0<br/>        Product_Category_2            245982<br/>        Product_Category_3            545809<br/>        Purchase                      233599<br/>        dtype: int64</span></pre><h2 id="72b8" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated">步骤 4:删除空值</h2><p id="9c84" class="pw-post-body-paragraph iy iz hi jb b jc li je jf jg lj ji jj jx lk jm jn jy ll jq jr jz lm ju jv jw hb bi translated">如果给定的数据集中有空值，那么我们的下一个任务应该是用机器可读的适当数据填充这些空值。这里我将通过该列的<strong class="jb hj">平均值</strong>对空值进行<strong class="jb hj">填充。</strong></p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="bc87" class="ka kb hi la b fi le lf l lg lh">&gt;&gt;<strong class="la hj">df["Product_Category_2"]=df["Product_Category_2"].fillna(value=df["Product_Category_2"].mean())</strong></span><span id="ed59" class="ka kb hi la b fi lo lf l lg lh">&gt;<strong class="la hj">&gt;df["Product_Category_3"]=df["Product_Category_3"].fillna(value=df["Product_Category_3"].mean())</strong></span><span id="fbcb" class="ka kb hi la b fi lo lf l lg lh"><strong class="la hj">&gt;&gt; df["Purchase"]=df["Purchase"].fillna(value=df["Purchase"].mean())</strong></span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/a8c90a00fb43887c3a23848ae5bd672e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ffwl1MjR7S9szIDOgO8VeQ.png"/></div></div></figure><p id="404c" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jb hj">检查是否有空值的列</strong></p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="81dc" class="ka kb hi la b fi le lf l lg lh"><strong class="la hj">&gt;&gt; df.isnull().sum()<br/> <br/>[out] &gt;&gt; </strong>User_ID                       0<br/>         Product_ID                    0<br/>         Gender                        0<br/>         Age                           0<br/>         Occupation                    0<br/>         City_Category                 0<br/>         Stay_In_Current_City_Years    0<br/>         Marital_Status                0<br/>         Cat1                          0<br/>         Cat2                          0<br/>         Cat3                          0<br/>         Purchase                      0<br/>         dtype: int64</span><span id="f21d" class="ka kb hi la b fi lo lf l lg lh">#Now we can conclude  that there is no any null value is present</span></pre><h2 id="068b" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated">步骤 5:重命名特征</h2><p id="fe0f" class="pw-post-body-paragraph iy iz hi jb b jc li je jf jg lj ji jj jx lk jm jn jy ll jq jr jz lm ju jv jw hb bi translated">如果我们看到数据集有很多列空间被“产品 _ 类别 _1”、“产品 _ 类别 _2”、“产品 _ 类别 _3”占用。所以我想把给定的列重命名为。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="5f71" class="ka kb hi la b fi le lf l lg lh">&gt;&gt; df.rename(columns={"Product_Category_1":"Cat1",   "Product_Category_2":"Cat2 ,"Product_Category_3":"Cat3"})<br/>&gt;&gt; df.tail()  # It will print last 5 rows of given dataset</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/ac0934bebe93161129a253439a008593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x9a6zULLv-L3xc0qMNYMkg.png"/></div></div></figure><h2 id="05d1" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated">步骤 6:数据集的统计描述</h2><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3490" class="ka kb hi la b fi le lf l lg lh">&gt;&gt; df.describe() #It will give statistical description of dataset</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/df599672cad9314fec3c539eb324a1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QX6WmNNL5iaqQ5AOz9yeJQ.png"/></div></div></figure><p id="117c" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">如果我们将看到描述，描述“User_Id”是不可理解的，所以我们的下一个任务将是删除这些不需要的列。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="0800" class="ka kb hi la b fi le lf l lg lh"> &gt;&gt; df.drop("User_ID",axis=1,inplace=True) </span></pre><h2 id="3b56" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated">步骤 7:将分类变量映射成数值变量</h2><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2832" class="ka kb hi la b fi le lf l lg lh">df.head()   #printing first five rows</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/35cac762b31fa5477b4bb876a005cd46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ql0cXt6yoNItEmz_SqbqMw.png"/></div></div></figure><ol class=""><li id="2d7c" class="lt lu hi jb b jc jd jg jh jx lv jy lw jz lx jw ly lz ma mb bi translated">现在我们的任务是将性别(最初是一个<strong class="jb hj">分类</strong>变量)映射成<strong class="jb hj">数字</strong>变量。</li></ol><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b9e2" class="ka kb hi la b fi le lf l lg lh">df["Gender"]=df["Gender"].map({"F":0,"M":1})<br/>df["Gender"].head()</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/fc1ac97598c79cd5ff3a892b394d473b.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*xJyb37y9jcqqxgJBLDoTLw.png"/></div></figure><p id="735b" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">2.在“年龄”栏中，我们得到了<strong class="jb hj">年龄范围</strong>，我们还需要将这些值映射成数字变量。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7017" class="ka kb hi la b fi le lf l lg lh">df["Age"]=df["Age"].map({'0-17':0, '55+':1, '26-35':2, '46-50':3, '51-55':4, '36-45':5, '18-25':6})<br/>df["Age"].head()</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es md"><img src="../Images/84037932e58cf0b699d6b34e619024b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*U8iflFTsfSOihDqrv0CtPg.png"/></div></figure><p id="2e2f" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">3.在“停留在当前城市年份”一栏中有各种城市名称，即:- <strong class="jb hj"> A、B </strong>和<strong class="jb hj"> C </strong>我们的主要目的是将这些分类城市转换成数字城市。为此，我们将使用<strong class="jb hj"> get_dummies。</strong></p><p id="7eba" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jb hj"> get_dummies </strong>将数据转换成<strong class="jb hj">虚拟变量</strong>。取值<strong class="jb hj"> 0 或 1 </strong>表示给定分类数据的存在和不存在。如果你想了解更多关于虚拟变量的信息，点击<a class="ae iu" href="https://www.geeksforgeeks.org/python-pandas-series-str-get_dummies/" rel="noopener ugc nofollow" target="_blank"> <strong class="jb hj">这里</strong> </a> <strong class="jb hj"> </strong>。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3f2e" class="ka kb hi la b fi le lf l lg lh">city=pd.get_dummies(df["City_Category"],drop_first=True)<br/>#Converting categorical dataset into numerical dataset by dropping #first column(or converting dataset into (k-1) dimension from k dim)</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es me"><img src="../Images/dc6817d2d03e92f499279281196d0771.png" data-original-src="https://miro.medium.com/v2/resize:fit:142/format:webp/1*qdjJrTcN60LNptUW7F_5xA.png"/></div></figure><p id="1ba5" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jb hj">“City _ Category”</strong>已被修改为列<strong class="jb hj"> A 和 B(带有机器可读数据点)</strong>现在它将是一个无效列，因此在本节中，我们将删除<strong class="jb hj">“City _ Category”</strong>并将<strong class="jb hj"> city </strong>数据帧与原始数据帧<strong class="jb hj"> df 连接起来。</strong></p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="57d8" class="ka kb hi la b fi le lf l lg lh">df.drop("City_Category",axis=1,inplace=True)<br/>df=df.append(city)</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/f3c7b4bf9bc0a9752a906200c711860c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gd1L-GDIfw49_9KSubUkOA.png"/></div></div></figure><p id="b59f" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">4.如果我们看到<strong class="jb hj">“停留当前城市年数”</strong>，一些数据点<strong class="jb hj"> 4+ </strong>无法被机器读取，因此我们需要更换<strong class="jb hj"> + </strong>符号。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="bb9b" class="ka kb hi la b fi le lf l lg lh">df[“Stay_In _Current_City_Years”]=df[“Stay_In _Current_City_Years”] .str.replace("+"," ")     <br/>#replacing plus sign with space</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/a9b95e1c86c41fb3162135ea33dcd84a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LzkKBw6ikXWAdlkzMZBT7g.png"/></div></div></figure><p id="5f5f" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我们可以看到<strong class="jb hj"> 4+ </strong>已经被<strong class="jb hj"> 4 取代。</strong></p><p id="cae3" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我们已经完成了将数据转换为机器可读格式的所有操作，但在继续之前，我们将确认所有数据是否都是数字(机器可读)的。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="5e53" class="ka kb hi la b fi le lf l lg lh">&gt;&gt; df.dtypes</span><span id="65b8" class="ka kb hi la b fi lo lf l lg lh">[out]&gt;&gt; Product_ID               object<br/>        Gender                          int64<br/>        Age                             int64<br/>        Occupation                      int64<br/>        Stay_In_Current_City_Years     object<br/>        Marital_Status                  int64<br/>        Cat1                            int64<br/>        Cat2                          float64<br/>        Cat3                          float64<br/>        Purchase                      float64<br/>        B                               uint8<br/>        C                               uint8<br/>        dtype: object</span></pre><p id="a30d" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这里我们将删除不必要的列<strong class="jb hj">“Product _ ID”</strong>，并将所有剩余的列转换为<strong class="jb hj"> int </strong>数据类型。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ceff" class="ka kb hi la b fi le lf l lg lh">&gt;&gt; df.drop("Product_ID",axis=1,inplace=True)</span><span id="c1a9" class="ka kb hi la b fi lo lf l lg lh">&gt;&gt;df["Stay_In_Current_City_Years"]=df["Stay_In_Current_City_Years"]. astype(int)</span><span id="7c42" class="ka kb hi la b fi lo lf l lg lh">&gt;&gt;df["B"]=df["B"].astype(int)</span><span id="0cff" class="ka kb hi la b fi lo lf l lg lh">&gt;&gt;df["C"]=df["C"].astype(int)</span></pre><p id="3481" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在所有的列都被转换成机器可读的数字数据。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="21ce" class="ka kb hi la b fi le lf l lg lh">&gt;&gt; df.dtypes</span><span id="3767" class="ka kb hi la b fi lo lf l lg lh">[out]&gt;&gt;</span><span id="b31d" class="ka kb hi la b fi lo lf l lg lh">Product_ID                     object<br/>Gender                          int64<br/>Age                             int64<br/>Occupation                      int64<br/>Stay_In_Current_City_Years      int32<br/>Marital_Status                  int64<br/>Cat1                            int64<br/>Cat2                          float64<br/>Cat3                          float64<br/>Purchase                      float64<br/>B                               int32<br/>C                               int32<br/>dtype: object</span></pre><h2 id="ee49" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated">步骤 8:预建模步骤</h2><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e3870d70afb79593764f8e11e808e64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZChh83ZTmyiaf7ig.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来自<a class="ae iu" href="https://www.google.com/search?q=task+quickly+done&amp;sxsrf=ALeKk03CBKscFcJWcUiwnjqP6yzlD0U1dA:1603305521584&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=2ahUKEwjo99HAqsbsAhWDyDgGHTM-DlsQ_AUoAXoECB8QAw&amp;biw=1366&amp;bih=657#imgrc=e6nQU79EMXYkyM" rel="noopener ugc nofollow" target="_blank">lifehack.org</a></figcaption></figure><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="de0b" class="ka kb hi la b fi le lf l lg lh">target=df.Purchase   #Making it label for modeling<br/>features=df.drop("Purchase",axis=1) # Making feature for modeling <br/>#which won't have target variable</span></pre><p id="cd90" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在我们将制作训练和测试数据集；</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9ca9" class="ka kb hi la b fi le lf l lg lh">X_train,X_test,Y_train,Y_test=train_test_split(feature,target,test_size=0.25,random_state=12)<br/></span></pre><p id="c144" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这里的<code class="du mh mi mj la b">test_size=0.25</code>表示我们已经将 75%的数据用于训练，25%的数据用于测试。<code class="du mh mi mj la b">random_state=int</code>意味着我们每次运行代码都会得到相同的数据点，如果<code class="du mh mi mj la b">random_state!=int</code>意味着我们每次运行相同的代码都会得到不同的数据点。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1cec" class="ka kb hi la b fi le lf l lg lh">#now we will standardize the data so that all the column will be at same scale<br/>sc=StandardScaler()<br/>X_train=sc.fit_tranform(X_train)<br/>X_test=sc.transform(X_test)</span></pre><p id="124e" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">打印 X_train 和 X _ test</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2eed" class="ka kb hi la b fi le lf l lg lh">&gt;&gt; X_train</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/67b52b1bac21ebb28fc048be6aea1746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*e2s0FlPYtE8hTgAsM7d7GA.png"/></div></figure><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2f22" class="ka kb hi la b fi le lf l lg lh">&gt;&gt; X_test</span></pre><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/8fafd9e417f3f4cb64f7b5a5ed3ef593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*UfWZXZGYfqiKlW5StTb4NQ.png"/></div></figure><p id="e7cf" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">训练和测试数据集的特征都已被转换成数据帧，并可用于机器学习建模。</p></div><div class="ab cl mm mn gp mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="hb hc hd he hf"><h2 id="9b54" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jx kl km kn jy ko kp kq jz kr ks kt ku bi translated">结论:</h2><p id="1ef8" class="pw-post-body-paragraph iy iz hi jb b jc li je jf jg lj ji jj jx lk jm jn jy ll jq jr jz lm ju jv jw hb bi translated">这些都是我的观点，如果你认为这个博客应该进一步改进，请提出你的宝贵意见</p></div></div>    
</body>
</html>