<html>
<head>
<title>Understanding Transfer Learning &amp; Image Augmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç†è§£è¿ç§»å­¦ä¹ å’Œå›¾åƒå¢å¼º</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/understanding-transfer-learning-image-augmentation-8456855eccb9?source=collection_archive---------12-----------------------#2020-10-29">https://medium.com/analytics-vidhya/understanding-transfer-learning-image-augmentation-8456855eccb9?source=collection_archive---------12-----------------------#2020-10-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3ac5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ æœ‰æ²¡æœ‰å‚åŠ è¿‡å›¾åƒåˆ†ç±»æ¯”èµ›ï¼Œè§‰å¾—è‡ªå·±çš„æ¨¡å‹ä¸å¦‚ä¸Šé¢çš„äººï¼Ÿé‚£æˆ‘è§‰å¾—è¿™ä¸ªåšå®¢æ˜¯ç»™ä½ çš„ã€‚</p><h1 id="824b" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ç›®å½•</h1><ul class=""><li id="c189" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated">ä»€ä¹ˆæ˜¯è¿ç§»å­¦ä¹ ï¼Ÿ</li><li id="6602" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">é¢„å¤„ç†</li><li id="4b5a" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">å›¾åƒå¢å¼º</li><li id="2c75" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">ä½¿ç”¨ResNet101è¿ç§»å­¦ä¹ </li><li id="759a" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">ä¼°ä»·</li><li id="c4f2" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">ç»“æŸæ³¨é‡Š</li></ul><h1 id="0413" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ä»€ä¹ˆæ˜¯è¿ç§»å­¦ä¹ ï¼Ÿ</h1><p id="0744" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">è¿ç§»å­¦ä¹ æ˜¯ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹æ¥è§£å†³æ–°é—®é¢˜æˆ–åˆ›å»ºæ–°æ¨¡å‹ã€‚</p><h1 id="179c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">é¢„å¤„ç†</strong></h1><p id="d643" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå›¾åƒç›®å½•ï¼Œå¹¶å°†æ•°æ®è§£å‹ç¼©åˆ°å…¶ä¸­ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="a3cc" class="ld je hi kz b fi le lf l lg lh">!mkdir images<br/>!unzip code_warriors_game_of_data_ai_challenge-dataset.zip -d images/</span></pre><p id="cd4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åº“ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="1d8f" class="ld je hi kz b fi le lf l lg lh">import os, shutil<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>import pandas as pd<br/>from keras.preprocessing import image<br/>from keras.applications.resnet import ResNet101<br/>from keras.layers import Dense<br/>from keras.models import Model, Sequential</span></pre><p id="c780" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠå›¾åƒåˆ†æˆè®­ç»ƒå›¾åƒå’ŒéªŒè¯å›¾åƒã€‚</p><p id="fb9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç¬¬ä¸€æ­¥</strong>:åˆ›å»ºä¸€ä¸ªval_imagesç›®å½•æ¥ä¼ è¾“å›¾åƒã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="48de" class="ld je hi kz b fi le lf l lg lh">if not os.path.isdir("val_images"):<br/>  os.mkdir("val_images")</span></pre><p id="ebc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç¬¬äºŒæ­¥</strong>:åˆ›å»ºæ•°æ®å¯ä»¥åˆ†ç±»çš„ç±»åˆ«åˆ—è¡¨ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="4c0b" class="ld je hi kz b fi le lf l lg lh">classes = ['Bread','Dairy product','Dessert','Egg','Fried food','Meat','Noodles-Pasta','Rice','Seafood','Soup','Vegetable-Fruit']</span></pre><p id="243b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç¬¬ä¸‰æ­¥:æˆ‘ä»¬å°†åˆ›å»ºå­ç›®å½•æ¥å­˜å‚¨ç‰¹å®šç±»åˆ«çš„å›¾ç‰‡ã€‚ä¸‹é¢çš„ä»£ç éå†äº†åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¸ºè¿™ä¸ªç±»åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="23d4" class="ld je hi kz b fi le lf l lg lh">for c in classes:<br/>  if not os.path.isdir("val_images/" + c):<br/>    os.mkdir("val_images/" + c)</span></pre><p id="06b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç¬¬å››æ­¥:è¿™ä¸€æ­¥å¯èƒ½æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚</p><p id="4db2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†å˜é‡splitèµ‹å€¼ä¸º0.9ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›ä»¥90:10çš„æ¯”ç‡æ‹†åˆ†æ•°æ®(train : validate)ã€‚åœ¨ä¸‹ä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬éå†trainæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å­æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸ºå…¶åˆ›å»ºä¸€ä¸ªpathå˜é‡ã€‚os.listdir()å°†è¿”å›ç‰¹å®šæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶åã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨len()å‡½æ•°è·å¾—å›¾åƒçš„æ•°é‡ï¼Œå¹¶é€šè¿‡å°†å…¶ä¹˜ä»¥åˆ†å‰²å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—åˆ†å‰²å¤§å°ï¼Œå³æˆ‘ä»¬éœ€è¦çš„è®­ç»ƒå›¾åƒçš„æ•°é‡ã€‚</p><p id="218d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸‹é¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå˜é‡files_to_moveï¼Œå¹¶æå–ä»split_sizeå¼€å§‹ç´¢å¼•åˆ°æœ«å°¾(å³10%çš„æ•°æ®)çš„æ–‡ä»¶åã€‚æœ€åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨join()å‡½æ•°åˆ›å»ºæºè·¯å¾„å’Œç›®æ ‡è·¯å¾„ï¼Œå¹¶ä½¿ç”¨shutilçš„move()å‡½æ•°ç§»åŠ¨å®ƒä»¬ã€‚</p><p id="8194" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å»ºè®®:</strong>å¦‚æœä½ æ„Ÿåˆ°å›°æƒ‘ï¼Œåœ¨ä»»ä½•æ­¥éª¤ä½¿ç”¨print(variable)å¯èƒ½ä¼šå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="25c6" class="ld je hi kz b fi le lf l lg lh">split = 0.9<br/>for dirc in os.listdir("/content/images/train"):<br/>  path = "/content/images/train/" + dirc<br/>  images = os.listdir(path)<br/>  split_size = int(len(images)*split)</span><span id="530d" class="ld je hi kz b fi li lf l lg lh">  files_to_move = images[split_size:]<br/>  print(files_to_move)<br/>  print()<br/>  for f in files_to_move:<br/>    src = os.path.join(path,f) #path+file<br/>    dest = os.path.join("val_images/",dirc)<br/>    shutil.move(src,dest)</span></pre><p id="6f3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºäº†æ£€æŸ¥æˆ‘ä»¬ä¸Šé¢çš„å°è¯•æ˜¯å¦å·²ç»å®Œæˆï¼Œæˆ‘ä»¬å°†æ£€æŸ¥ç›®å½•çš„å†…å®¹ã€‚</p><p id="71b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†å¾ªç¯éå†è®­ç»ƒç›®å½•ä¸­çš„æ¯ä¸ªé¡¹ç›®ï¼Œå¹¶æ‰“å°æ¯ä¸ªç±»åˆ«çš„å›¾åƒæ•°é‡ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="0204" class="ld je hi kz b fi le lf l lg lh">for dirc in os.listdir("/content/images/train"):<br/>  path = "/content/images/train/" + dirc<br/>  img = os.listdir(path)<br/>  print(dirc, len(img))</span></pre><p id="6932" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†å¾ªç¯éå†val_imagesç›®å½•ä¸­çš„æ¯ä¸€é¡¹ï¼Œå¹¶æ‰“å°æ¯ä¸€ç±»åˆ«çš„å›¾åƒæ•°é‡ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="b374" class="ld je hi kz b fi le lf l lg lh">for dirc in os.listdir("val_images/"):<br/>  path = "val_images/" + dirc\ <br/>  img = os.listdir(path)<br/>  print(dirc, len(img))</span></pre><h1 id="505a" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">å›¾åƒå¢å¼º</h1><p id="ed3e" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">å›¾åƒå¢å¼ºæ˜¯ä¸€ç§é€šè¿‡åˆ›å»ºä¿®æ”¹ç‰ˆæœ¬æ¥å¢åŠ æˆ‘ä»¬å·²ç»æ‹¥æœ‰çš„æ•°æ®çš„æ–¹æ³•ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œä½ å¯ä»¥ä»ä¸€å¼ çŒ«çš„å›¾ç‰‡ä¸­çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜å®½åº¦ã€é«˜åº¦ã€ç¼©æ”¾ã€å‰ªåˆ‡ç­‰æ¥åˆ›å»ºå¤šå¼ å›¾ç‰‡ã€‚</p><figure class="ku kv kw kx fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/a8796597f0ede5cdc3c4d60aaa6f593e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P0SyKFj_lZQGeh3FE9nPnA.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">å›¾åƒå¢å¼º</figcaption></figure><p id="2b43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å› æ­¤ï¼Œä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä¸ºè®­ç»ƒæ•°æ®åˆ›å»ºä¸€ä¸ªImageDataGeneratorå¯¹è±¡ï¼Œå¹¶æ·»åŠ å±æ€§ï¼ŒåŸºäºè¿™äº›å±æ€§å°†åˆ›å»ºæ–°å›¾åƒï¼Œå¦‚rotation_rangeã€width_shift_rangeã€height_shift_rangeã€shear_rangeã€zoom_rangeã€horizontal flipã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="db5a" class="ld je hi kz b fi le lf l lg lh">train_gen = image.ImageDataGenerator(rotation_range=25,<br/>                                     width_shift_range = 0.3,<br/>                                     height_shift_range = 0.25,<br/>                                     shear_range = 0.2,<br/>                                     zoom_range = 0.3,<br/>                                     horizontal_flip = True<br/>                                     )</span></pre><p id="8ed1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬è¿˜å°†ä¸ºéªŒè¯æ•°æ®åˆ›å»ºä¸€ä¸ªImageDataGeneratorå¯¹è±¡ï¼Œä½†æˆ‘ä»¬ä¸ä¼šä¼ é€’ä»»ä½•å±æ€§ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æƒ³åŸºäºå®ƒç”Ÿæˆå›¾åƒï¼Œå› ä¸ºå®ƒåªç”¨äºéªŒè¯ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="72ac" class="ld je hi kz b fi le lf l lg lh">val_datagen = image.ImageDataGenerator()</span></pre><p id="4905" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°†ä»åˆšåˆšåˆ›å»ºçš„å¯¹è±¡åˆ›å»ºæ–°çš„å›¾åƒã€‚æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨flow_from_directoryï¼Œæ‚¨ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨flow_from_dataframeã€‚æˆ‘ä»¬å°†ä¼ é€’åŒ…å«è®­ç»ƒå›¾åƒçš„ç›®å½•ã€‚ç›®æ ‡å¤§å°è¢«æŒ‡å®šä¸º(224ï¼Œ224)ï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨åœ¨ç›¸åŒå¤§å°çš„å›¾åƒä¸Šè®­ç»ƒçš„ResNetæ¨¡å‹ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="bc00" class="ld je hi kz b fi le lf l lg lh">train_generator = train_gen.flow_from_directory(<br/>                                      "/content/images/train",                                                                                      <br/>                                      target_size = (224,224), <br/>                                      class_mode = "categorical",<br/>                                      shuffle = True,<br/>                                      batch_size = 32<br/>                                      )</span></pre><p id="1ba8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬è¿˜å°†ä½¿ç”¨val_datagenå¯¹è±¡æ ¹æ®éœ€è¦å¤„ç†å›¾åƒã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="39ea" class="ld je hi kz b fi le lf l lg lh">val_generator = val_datagen.flow_from_directory("val_images/",<br/>                                         target_size = (224,224),<br/>                                         class_mode = 'categorical',<br/>                                         batch_size=32)</span></pre><h1 id="3eea" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ä½¿ç”¨ResNet101è¿ç§»å­¦ä¹ </h1><p id="4a92" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">æˆ‘ä»¬ç°åœ¨å°†åˆ›å»ºä¸€ä¸ªResNet101å¯¹è±¡ï¼Œinclude_topä¸ºTrueï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æœ€ç»ˆçš„å¯†é›†å±‚ï¼Œæƒé‡å‚æ•°è®¾ç½®ä¸ºimagenetï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è·å¾—é¢„è®­ç»ƒçš„æƒé‡ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="13c1" class="ld je hi kz b fi le lf l lg lh">resnet = ResNet101(include_top= True, weights= "imagenet")</span></pre><p id="85a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°†æå–é¡¶éƒ¨çš„n-2ä¸ªresnetå±‚ï¼Œå¹¶åœ¨æœ€åæ·»åŠ ä¸€ä¸ªå¯†é›†å±‚ã€‚æ¿€æ´»è¢«è®¾ç½®ä¸ºsoftmaxï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œåˆ†ç±»ï¼Œå¹¶ä¸”å‚æ•°11è¢«æŒ‡å®šï¼Œå› ä¸ºæˆ‘ä»¬æœ‰11ä¸ªç±»ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="83d0" class="ld je hi kz b fi le lf l lg lh">#get top n-2 layers<br/>x = resnet.layers[-2].output<br/>fun = Dense(11, activation = "softmax")(x)</span></pre><p id="2a82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæˆ‘ä»¬çš„æ¨¡å‹ï¼Œå®ƒå…·æœ‰resnetæ¨¡å‹çš„è¾“å…¥å’Œæˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„è¾“å‡ºfunã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="e3e9" class="ld je hi kz b fi le lf l lg lh">model = Model(inputs=resnet.input, outputs = fun)</span></pre><p id="4ba6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†å†»ç»“é™¤æœ€å30å±‚ä¹‹å¤–çš„æ‰€æœ‰å±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†ä½¿å¯è®­ç»ƒå‚æ•°ä¸ºå‡ï¼Œä»¥ä¾¿å­¦ä¹ çš„æƒé‡ä¸ä¼šæ”¹å˜ã€‚æˆ‘ä»¬æ­£åœ¨è®­ç»ƒæœ€å30å±‚ï¼Œå› ä¸ºResNet101æ¨¡å‹æ˜¯åœ¨ä¸€èˆ¬æ•°æ®(å³ImageNet)ä¸Šè®­ç»ƒçš„ï¼Œè€Œæˆ‘ä»¬æœ‰é£Ÿç‰©æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬çš„æ¨¡å‹éœ€è¦ç›¸åº”åœ°å­¦ä¹ ã€‚</p><p id="3f8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">model.compileæ–¹æ³•ç”¨äºåœ¨è®­ç»ƒä¹‹å‰ç¼–è¯‘æ¨¡å‹ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨sgdï¼Œå³éšæœºæ¢¯åº¦ä¸‹é™ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨Adamä¼˜åŒ–å™¨æˆ–ä»»ä½•å…¶ä»–ä¼˜åŒ–å™¨ã€‚æˆ‘ä»¬å·²ç»å°†æŸå¤±ä½œä¸ºåˆ†ç±»äº¤å‰ç†µï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦é‡‡ç”¨ä»»ä½•å…¶ä»–æŸå¤±å‡½æ•°ã€‚æˆ‘ä»¬å°†ä½¿ç”¨çš„è¡¡é‡æ ‡å‡†æ˜¯å‡†ç¡®æ€§ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="9959" class="ld je hi kz b fi le lf l lg lh"># Freeze layers<br/>for l in model.layers[:-30]:<br/>  l.trainable = False</span><span id="3fad" class="ld je hi kz b fi li lf l lg lh">model.compile(optimizer="sgd", loss = "categorical_crossentropy",            <br/>  metrics=["accuracy"])</span></pre><p id="71e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">model.summary()æ–¹æ³•ç”¨äºæŸ¥çœ‹æ‰€æœ‰å±‚ã€‚ä½ å¯ä»¥å°è¯•ä¸€ä¸‹ï¼Œæˆ‘æƒ³èƒ½å¤Ÿæ˜¾ç¤ºå®ƒä½œä¸ºä¸€ä¸ªå›¾åƒã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="208b" class="ld je hi kz b fi le lf l lg lh">model.summary()</span></pre><p id="634e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¥ä¸‹æ¥æ˜¯è®­ç»ƒéƒ¨åˆ†ï¼Œä½¿ç”¨æ‹Ÿåˆçš„æ–¹æ³•æ¥è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚æˆ‘ä»¬å°†é€šè¿‡train_generatorè¿›è¡Œè®­ç»ƒï¼Œsteps_per_epochå¯ä»¥è®¡ç®—ä¸ºâ€œè®­ç»ƒå›¾åƒçš„æ•°é‡/æ‰¹é‡å¤§å°â€, validation_stepså¯ä»¥è®¡ç®—ä¸ºâ€œéªŒè¯å›¾åƒçš„æ•°é‡/æ‰¹é‡å¤§å°â€ã€‚æˆ‘ä»¬å°†é€šè¿‡validation_dataä¸­çš„val_generatorè¿›è¡ŒéªŒè¯ã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="a07c" class="ld je hi kz b fi le lf l lg lh">hist = model.fit(train_generator,<br/>                 steps_per_epoch=3937//32,<br/>                 epochs=50,<br/>                 validation_data=val_generator,<br/>                 validation_steps=497//32)</span></pre><figure class="ku kv kw kx fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lv"><img src="../Images/bacecbb84396f67e485000ea304808ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*llrXJFlnbrxpg5vhGAQbdA.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">è¾“å‡º</figcaption></figure><h1 id="e18e" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ä¼°ä»·</h1><p id="a290" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">æˆ‘ä»¬å°†ä½¿ç”¨ã€‚evaluate()æ–¹æ³•æ¥è·å¾—æˆ‘ä»¬çš„æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚æˆ‘å»ºè®®ä½ è¯•è¯•è¶…å‚æ•°ï¼ŒæŠŠå‡†ç¡®ç‡æé«˜åˆ°90%ä»¥ä¸Šã€‚</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="47e3" class="ld je hi kz b fi le lf l lg lh">model.evaluate(val_generator)</span></pre><figure class="ku kv kw kx fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lw"><img src="../Images/0a2f3f802427c529a898a2357a3be95c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xjZWM0-6ZMdJTPYv0jxL-A.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">å‡†ç¡®(æ€§)</figcaption></figure><h1 id="542c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ç»“æŸæ³¨é‡Š</h1><p id="5c49" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨ResNet101çš„è¿ç§»å­¦ä¹ ï¼Œæˆ‘å»ºè®®ä½ å°è¯•ä¸åŒçš„æ¨¡å¼ï¼Œå¦‚VGGï¼ŒDenseNetï¼ŒXceptionï¼ŒMobileNetï¼Œä»¥åŠè®¸å¤šå…¶ä»–æ¨¡å¼ã€‚</p><p id="fb53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºæœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦çš„åšå®¢ï¼Œè¯·å…³æ³¨æˆ‘ï¼Œå¹¶å‘Šè¯‰æˆ‘ä½ æƒ³äº†è§£çš„è¯é¢˜ã€‚</p><p id="7bbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å˜¿ï¼Œè¯»è€…ä»¬ï¼Œæ„Ÿè°¢ä½ ä»¬çš„æ—¶é—´ã€‚å¦‚æœä½ å–œæ¬¢è¿™ä¸ªåšå®¢ï¼Œåˆ«å¿˜äº†é¼“æŒæ¬£èµå®ƒğŸ‘å¦‚æœä½ å–œæ¬¢â¤ï¼Œä½ å¯ä»¥ç»™50è‹±é•‘ğŸ‘</p><p id="ff13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lx">æ•°æ®ç§‘å­¦çˆ±å¥½è€…| MLçˆ±å¥½è€…| TCS CA |ç¼–ç å—CA | Blogger |ç¤¾åŒºæˆå‘˜|å…¬å…±æ¼”è®²è€…</em></p><p id="e803" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼Œè¯·éšæ—¶è”ç³»æˆ‘</p><p id="3f9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">https://twitter.com/shah_naivedh<a class="ae ly" href="https://twitter.com/shah_naivedh" rel="noopener ugc nofollow" target="_blank"/></p><p id="6925" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ã€https://www.linkedin.com/in/naivedh-shah/ T4ã€‘</p></div></div>    
</body>
</html>