<html>
<head>
<title>Automated XML File creation using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python自动创建XML文件</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automated-xml-file-creation-using-python-877c24feba66?source=collection_archive---------5-----------------------#2020-09-29">https://medium.com/analytics-vidhya/automated-xml-file-creation-using-python-877c24feba66?source=collection_archive---------5-----------------------#2020-09-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="20c9" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><em class="hi">作者</em> <a class="ae jh" rel="noopener" href="/@itsdeb82"> <strong class="il hj"> <em class="hi">德巴斯</em></strong></a><em class="hi">&amp;</em><a class="ae jh" rel="noopener" href="/@priyankamishra1"><strong class="il hj"><em class="hi">普里扬卡·米什拉</em></strong></a><em class="hi">—2020年9月28日</em></p></blockquote><p id="a47c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">可扩展标记语言或XML是一种标记语言，就像HTML一样。它用于存储更少的数据，而不需要类似SQL的结构。它是万维网联盟推荐使用的开放标准。</p><p id="55c4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">Python标准库有几个非常有助于处理XML文件的包。要使用它，你必须对XML文件有相当多的了解，对所需的Python包以及如何使用它们有广泛的了解。</p><p id="73c5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">研究如何使用各种软件包会消耗大量的时间和资源，并且还需要技术知识。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/064f4218ad29d58a5fa8b65c34dafca6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GbyrHUSXmmcR9nNd.png"/></div></div></figure><p id="c30e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><strong class="il hj">解决方案</strong></p><p id="ebdc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">在本文中，我们将介绍一个创建XML文件的端到端解决方案，只需很少的Python知识，使用源作为Teradata(可以修改连接以从任何数据库获取)和一个配置文件(即excel文件)。</p><p id="5ff1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">配置文件将提供详细信息，例如:</p><p id="2d37" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">XML的结构</p><p id="f12f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">绑定/未绑定节点/标签</p><p id="045e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">用于数据提取的SQL</p><p id="21cb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">让我们深入了解一下所使用的解决方案:</p><p id="fd77" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><strong class="il hj">配置文件</strong>:这是一个excel文件，包含2个选项卡。文件的内容也可以放在一个表中，数据也可以从这个表中获取，但是出于我的研究目的，我将内容保存在一个excel中。</p><p id="12ed" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">Tab1包含需要执行的查询的详细信息，以便为文件中的标签提供数据。以下是选项卡中的列:</p><p id="b6f4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">1.Type —这是行的唯一标识符，在包含标记详细信息的Tab2中再次引用。</p><p id="1690" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">2.Sql —这包含为XML提取数据所需执行的Sql。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jx"><img src="../Images/d44cab53c795301ef19a239e0e1d0c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cFe2ZuZlk1uBUpH6.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">表1的快照</figcaption></figure><p id="850c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">表2包含XML的详细结构和以下各列:</p><p id="c82e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">1.row _ seq——顾名思义，这就是行的顺序或次序。这对建议标签的顺序很重要。</p><p id="3c87" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">2.XML_File —这是可选的，simple表示输出文件的名称。如果excel需要维护多个XML的数据。</p><p id="206b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">3.类型—此列是指表1中的类型列。这将使用Tab1中的query提取的数据映射到Tab2中的标记名</p><p id="2088" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">4.路径—这是节点的路径。它提供了每个节点的排列结构。在父节点被定义为unbounded的情况下，所有子节点都应该有路径，无界列的唯一标识符在括号中，就在无界字段之后。</p><p id="035e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">5.col _ tag——以XML的形式给出列的节点名</p><p id="0444" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">6.Col_Unbound —这是一个可空字段，表示该结构是否需要重复。即特定节点是否可以有多个值。只需要为父节点提及这一点，而不需要为子节点下的每个子节点提及这一点。</p><p id="ccfa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">7.Col_Data —这将使用所执行的查询中的确切列来映射节点。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/3874a1b7a29ecf8053ae871828818e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LSNZ-J0TyTUT7LE6.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">选项卡2的快照</figcaption></figure><p id="2d29" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><strong class="il hj">代码</strong>:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kc"><img src="../Images/03fca0fab70e5c6410b21d9a33a2d467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YsiLRAtbnYFd5xAW.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">工艺流程</figcaption></figure><p id="2c6c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><em class="ik">摘录</em></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/eb19da39b71d114f19a180c7ded60ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bl8qO5xU_zTo0gNj.png"/></div></div></figure><p id="2d7e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><em class="ik">映射</em></p><p id="f384" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">提取XML结构</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/acd75d029ddd9676cedf77d4c9fc49eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vT_C1ZCnzccjkesK.png"/></div></div></figure><p id="b21a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">用于XML创建的函数</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/308d33866fc63d43241670ac4c71d677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kAWpZEKSnQcJNFpB.png"/></div></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/447f6e067e38532a8dd89e3a8a93f153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t_FYo8Zi-mfsCKoq.png"/></div></div></figure><p id="8900" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">主代码和函数调用</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/df5d395252435a462c6b4451ab078bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RtUy8SwaBykovnlK.png"/></div></div></figure><p id="0b39" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><em class="ik">格式化</em></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/758b2f7c1163a9f69ddf326c640c2280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EidjkPadFZZ5WFGQ.png"/></div></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/c654b73cd951cc374c8b1f1d73295f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RdEbpEhULlg28L9r.png"/></div></div></figure><p id="5036" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><strong class="il hj">最终文件</strong></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/67b05b2bd3ef037ffbe42e98dbce74d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rvWFuWZYRorBFfOq.png"/></div></div></figure><p id="b045" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><strong class="il hj">总结</strong></p><p id="df9c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">上述解决方案用于自动创建符合法规要求的XML文件，例如SAF-T(标准税务审计文件)。XML文件结构已经被经济合作与发展组织标准化了。</p><p id="9bb8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">该代码被开发成通用的，即使是对Python了解很少的非技术用户也可以使用。</p></div></div>    
</body>
</html>