<html>
<head>
<title>Exploratory Data Analysis: IMDb Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索性数据分析:IMDb数据集</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploratory-data-analysis-imdb-dataset-cff0c3991ad5?source=collection_archive---------1-----------------------#2020-04-07">https://medium.com/analytics-vidhya/exploratory-data-analysis-imdb-dataset-cff0c3991ad5?source=collection_archive---------1-----------------------#2020-04-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d69c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这本笔记本中，我们将探索IMDb的数据集，该数据集可在线获得，并且每天更新。</p><p id="16a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">https://www.imdb.com/interfaces/<a class="ae jd" href="https://www.imdb.com/interfaces/" rel="noopener ugc nofollow" target="_blank"/></p><p id="e150" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">七个gzipped文件(制表符分隔值)可以从网站上下载。文件有:</p><ul class=""><li id="99c3" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">title.akas.tsv.gz</li><li id="cf21" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">title.basics.tsv.gz</li><li id="b22f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">title.crew.tsv.gz</li><li id="dc0a" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">title.episode.tsv.gz</li><li id="f713" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">title.principals.tsv.gz</li><li id="6d54" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">title.ratings.tsv.gz</li><li id="3167" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">name.basics.tsv.gz</li></ul><p id="482e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了“title.episode.tsv.gz”之外，我们将逐一浏览它们，因为我们只对笔记本中的电影感兴趣，对电视剧不感兴趣。</p><p id="7641" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从Python库的必要导入开始:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="255c" class="kb kc hi jx b fi kd ke l kf kg"><strong class="jx hj">import</strong> <strong class="jx hj">pandas</strong> <strong class="jx hj">as</strong> <strong class="jx hj">pd</strong><br/><strong class="jx hj">import</strong> <strong class="jx hj">numpy</strong> <strong class="jx hj">as</strong> <strong class="jx hj">np</strong><br/><strong class="jx hj">import</strong> <strong class="jx hj">seaborn</strong> <strong class="jx hj">as</strong> <strong class="jx hj">sns</strong><br/><strong class="jx hj">import</strong> <strong class="jx hj">matplotlib.pyplot</strong> <strong class="jx hj">as</strong> <strong class="jx hj">plt</strong><br/>sns.set(style="darkgrid")<br/>plt.style.use("seaborn-pastel")</span></pre><p id="9045" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将IMDb数据集中的大型表加载到我们的笔记本需要一些时间；因此，我们将执行一次，并将它们保存在。Python的pickle库所允许的sav格式，这将加速数据加载过程</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="6e57" class="kb kc hi jx b fi kd ke l kf kg">import pickle<br/># import glob</span><span id="fba1" class="kb kc hi jx b fi kh ke l kf kg"># save all tables one by one into separate sav files<br/># tsv_files = glob.glob("*.tsv")</span><span id="3553" class="kb kc hi jx b fi kh ke l kf kg"># for file in tsv_files:<br/>#     print(file)<br/>#     pickle.dump(pd.read_table(file,sep="\t",low_memory=False, na_values=["\\N","nan"]),<br/>#                 open(file[:-4]+".sav","wb"))</span></pre><p id="d562" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们逐个检查表格。我们会不时地在笔记本中加入表格来做额外的分析</p><h1 id="a05c" class="ki kc hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">评级表</h1><p id="bed1" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">title.ratings.tsv.gz—包含标题的IMDb评分和投票信息</p><ul class=""><li id="e243" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> tconst </strong>(字符串)—标题的字母数字唯一标识符</li><li id="10b0" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">平均</strong> —所有个人用户评分的加权平均值</li><li id="54ee" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> numVotes </strong> —标题获得的票数</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="85ac" class="kb kc hi jx b fi kd ke l kf kg">df_ratings = pickle.load(open("title.ratings.sav","rb"))<br/>df_ratings.head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es lk"><img src="../Images/3c7616f9c9a8dad37d5ea44f4ddc442d.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*BPhlr_g5fPhPWt6h3yT6Jw.png"/></div></figure><p id="a560" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分级</strong>表包含超过一百万个电影分级条目</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="f9c8" class="kb kc hi jx b fi kd ke l kf kg">df_ratings.info()</span><span id="df44" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 1020911 entries, 0 to 1020910<br/>Data columns (total 3 columns):<br/> #   Column         Non-Null Count    Dtype  <br/>---  ------         --------------    -----  <br/> 0   tconst         1020911 non-null  object <br/> 1   averageRating  1020911 non-null  float64<br/> 2   numVotes       1020911 non-null  int64  <br/>dtypes: float64(1), int64(1), object(1)<br/>memory usage: 23.4+ MB</span></pre><p id="c30f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均评分为6.89(平均值)，与中值(7.1)不同，我们将进一步研究这一点。每部电影的平均投票数接近1000(平均值)，这次的中位数(20)与平均值有很大不同</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="d6d8" class="kb kc hi jx b fi kd ke l kf kg">df_ratings.describe()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es lo"><img src="../Images/4fadf8f204ee69975b26a5051413df1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*s8wSYtsNesNAGkHYe7XSmg.png"/></div></figure><p id="9302" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均评分分布显示了典型的<strong class="ih hj">负偏态</strong>分布，其中中值大于平均值。投票数分布主要集中在小数值上(0-1000票)。因此，我们需要做一些额外的工作来可视化这个打包的分布</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="12ad" class="kb kc hi jx b fi kd ke l kf kg">ratings = dict(mean=df_ratings.averageRating.mean(),<br/>              median=df_ratings.averageRating.median())<br/>votes = dict(mean=df_ratings.numVotes.mean(),<br/>              median=df_ratings.numVotes.median())</span><span id="6a6d" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(15,5))</span><span id="fe78" class="kb kc hi jx b fi kh ke l kf kg">plt.subplot(1,2,1)<br/>ax1 = sns.distplot(df_ratings.averageRating,kde_kws=dict(bw=0.2))<br/>ax1.axvline(x=ratings["mean"],c=sns.color_palette("Set2")[1],label=f"mean={ratings['mean'].round(2)}")<br/>ax1.axvline(x=ratings["median"],c=sns.color_palette("Set2")[2],label=f"median={ratings['median'].round(2)}")<br/>plt.legend()</span><span id="588a" class="kb kc hi jx b fi kh ke l kf kg">plt.subplot(1,2,2)<br/>ax2 = sns.distplot(df_ratings.numVotes,kde_kws=dict(bw=0.2))<br/>ax2.axvline(x=votes["mean"],c=sns.color_palette("Set2")[1],label=f"mean={votes['mean'].round(2)}")<br/>ax2.axvline(x=votes["median"],c=sns.color_palette("Set2")[2],label=f"median={votes['median'].round(2)}")<br/>plt.legend()</span><span id="a1e3" class="kb kc hi jx b fi kh ke l kf kg">plt.tight_layout()<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lp"><img src="../Images/a7468a3896b6fe6f5952bf67826c221c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VyQTT4n0oS_aCQQFSGqDaQ.png"/></div></div></figure><p id="e90c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们尝试使用pandas.qcut函数，该函数基于秩或基于样本分位数将变量离散化为大小相等的桶。让我们将数据分成20个时段，并想象:</p><ul class=""><li id="2efa" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">超过140，000个样本(超过10%)只计算了5张选票</li><li id="f12f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">超过1095票的电影在情节中用大约50K的单个条形表示(这些是我们最感兴趣的重要/流行电影)</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="d60b" class="kb kc hi jx b fi kd ke l kf kg">buckets = 20<br/>plt.figure(figsize=(15,6))<br/>bins = pd.qcut(df_ratings.numVotes,buckets,duplicates="drop").value_counts()<br/>sns.barplot(x=bins.values,y=bins.index,orient="h")<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lu"><img src="../Images/68989ac23efd97059791886a3785071a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XA1zevKlS59ia9zoToTITw.png"/></div></div></figure><p id="f98c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我们可以考虑用对数标度来绘制分布图，这样可以揭示更多信息。因为它是一个计数变量，所以看起来更像泊松分布</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="0215" class="kb kc hi jx b fi kd ke l kf kg">plt.figure(figsize=(15,6))<br/>ax=sns.distplot(df_ratings.numVotes,kde=False)<br/>ax.set_ylabel("Count")<br/>ax.set_yscale("log")</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lv"><img src="../Images/f07e8f94c04289d6f8cf68dfe243e44e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4waLfnp9t29Nb82VHvsmtw.png"/></div></div></figure><h1 id="2311" class="ki kc hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">标题基础表</h1><p id="e4ca" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">title.basics.tsv.gz—包含以下标题信息:</p><ul class=""><li id="0d67" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> tconst </strong>(字符串)—标题的字母数字唯一标识符</li><li id="7fea" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">标题类型</strong>(字符串)——标题的类型/格式(如电影、短片、电视连续剧、电视剧集、视频等)</li><li id="c780" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> primaryTitle </strong>(字符串)—更受欢迎的标题/电影制作人在发行时在宣传材料上使用的标题</li><li id="5890" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">原标题</strong>(字符串)——原标题，原文</li><li id="2f43" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> isAdult </strong> (boolean) — 0:非成人称谓；1:成人标题</li><li id="694f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">start year</strong>(YYYY)——代表一个标题的发布年份。就电视连续剧而言，这是连续剧开始的年份</li><li id="8562" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">岁末</strong>(YYYY)——电视剧岁末。\N '对于所有其他标题类型</li><li id="22bc" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">运行时间分钟</strong> —标题的主要运行时间，以分钟为单位</li><li id="a269" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">流派</strong>(字符串数组)——包括最多三个与标题相关的流派</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="a4ce" class="kb kc hi jx b fi kd ke l kf kg">df_title_basics = pickle.load(open("title.basics.sav","rb"))<br/>df_title_basics.head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lw"><img src="../Images/215fc11f817afc8f27bcd446dbf72686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*42TaSV4JFV1EuS8veKAFTQ.png"/></div></div></figure><p id="c97b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">标题基本信息表比收视率表大得多，有超过<strong class="ih hj">600万</strong>个条目，每个条目都描述了视频标题的基本信息。我用了“视频”这个词，因为它不仅包括电影，还包括电视剧、短片(短片和音乐剪辑)，甚至视频游戏</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="6ff6" class="kb kc hi jx b fi kd ke l kf kg">df_title_basics.info()</span><span id="f8a6" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 6682995 entries, 0 to 6682994<br/>Data columns (total 9 columns):<br/> #   Column          Dtype  <br/>---  ------          -----  <br/> 0   tconst          object <br/> 1   titleType       object <br/> 2   primaryTitle    object <br/> 3   originalTitle   object <br/> 4   isAdult         int64  <br/> 5   startYear       float64<br/> 6   endYear         float64<br/> 7   runtimeMinutes  object <br/> 8   genres          object <br/>dtypes: float64(2), int64(1), object(6)<br/>memory usage: 458.9+ MB</span></pre><p id="dea6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们一个接一个地探索专栏。职称类型分布如下:</p><ul class=""><li id="1dc1" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">大多数标题是电视剧集(71%)</li><li id="b327" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">电影(包括电视电影)只覆盖了数据集的10%</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="b92f" class="kb kc hi jx b fi kd ke l kf kg">df_title_basics.titleType.value_counts().plot.pie(autopct="%.0f%%",figsize=(6,6),pctdistance=0.8,<br/>                                                 wedgeprops=dict(width=0.4))<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es lx"><img src="../Images/db14c769afe24934081fab7b53405503.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*XhMtX3h86tmoV5afBEbaww.png"/></div></figure><p id="45d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们修剪数据集，因为我们只对电影感兴趣。经过修整后，现在大部分的标题是电影(82%)，剩下的12万个标题是电视电影</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="4bde" class="kb kc hi jx b fi kd ke l kf kg">df_title_basics = df_title_basics[df_title_basics.isAdult == 0]<br/>df_title_basics.drop(["isAdult","endYear"],axis=1,inplace=True)<br/>df_title_basics = df_title_basics[(df_title_basics.titleType == "movie") | (df_title_basics.titleType == "tvMovie")]</span><span id="3961" class="kb kc hi jx b fi kh ke l kf kg">df_title_basics.titleType.value_counts().plot.pie(autopct="%.0f%%",figsize=(6,6),pctdistance=0.8,<br/>                                                 wedgeprops=dict(width=0.4))<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es ly"><img src="../Images/8d579774f52bfb0b0a51f462647cacf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*6AyTq51mrB3wuCR_Bp5HgA.png"/></div></figure><p id="9463" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">流派</strong>分布如何，下面的饼状图看起来不迷人吧？这是因为电影有多种类型，所以我们下面看到的是各种类型的组合，每种类型都代表了馅饼中的一块</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="f872" class="kb kc hi jx b fi kd ke l kf kg">df_title_basics.genres.value_counts().plot.pie(autopct="%.0f%%",figsize=(6,6),pctdistance=0.8,<br/>                                              wedgeprops=dict(width=0.4))<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es lz"><img src="../Images/a0c73b76cd060bd1abec447f3e60c27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*z2EPzM4LdItfewmWYfJgeg.png"/></div></figure><p id="c24a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了克服这一点，我们可以使用Scikit-Learn的<strong class="ih hj">计数矢量器</strong>特征提取技术来检测和计数每个独特的流派(例如，戏剧、喜剧等)。我们将为每个独特的类型标题创建一个新的列，它将判断电影是否具有该类型</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="cd6c" class="kb kc hi jx b fi kd ke l kf kg">from sklearn.feature_extraction.text import CountVectorizer</span><span id="1036" class="kb kc hi jx b fi kh ke l kf kg">temp = df_title_basics.genres.dropna()<br/>vec = CountVectorizer(token_pattern='(?u)\\b[\\w-]+\\b', analyzer='word').fit(temp)<br/>bag_of_genres = vec.transform(temp)<br/>unique_genres =  vec.get_feature_names()<br/>np.array(unique_genres)</span></pre><p id="40bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">独特的流派:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="9dbf" class="kb kc hi jx b fi kd ke l kf kg">array(['action', 'adult', 'adventure', 'animation', 'biography', 'comedy', 'crime', 'documentary', 'drama', 'family', 'fantasy', 'film-noir', 'game-show', 'history', 'horror', 'music', 'musical', 'mystery', 'news', 'reality-tv', 'romance', 'sci-fi', 'sport', 'talk-show', 'thriller', 'war', 'western'], dtype='&lt;U11')</span></pre><p id="e9de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它通过发现独特的流派并对其进行计数，表现非常出色。请注意，在下面的条形图中，由于一部电影可能同时有多个流派，因此它们的数量不会是100%</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="0354" class="kb kc hi jx b fi kd ke l kf kg">genres = pd.DataFrame(bag_of_genres.todense(),columns=unique_genres,index=temp.index)<br/>sorted_genres_perc = 100*pd.Series(genres.sum()).sort_values(ascending=False)/genres.shape[0]</span><span id="d5e1" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(15,8))<br/>sns.barplot(x=sorted_genres_perc.values,y=sorted_genres_perc.index,orient="h")<br/>plt.xlabel("Percentage of Films (%)")<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es ma"><img src="../Images/a78f30e660c0cf2c3e1e42d358db2b64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEHmDdNAGqP8w32ldVFajg.png"/></div></div></figure><p id="71dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每年的<strong class="ih hj">投票人数和每年/每部电影</strong>的<strong class="ih hj">投票人数的趋势如何？</strong></p><p id="f085" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图包含两条副曲线，前者给出了每年制作的电影总数，后者给出了相应年份制作的电影的投票总数，该数字在2013年<strong class="ih hj">达到峰值</strong>(2013年上映的电影的投票总数为3700万)，随后该数字急剧下降。这就是事情变得有趣的地方。在2017年<strong class="ih hj">之前，每年制作的电影数量都在增加，但为什么人们不再投票给最近的电影呢？是因为电影质量越来越差吗？还是IMDb网站失去了人气？然而，显而易见的是，IMDb仍然主导着在线电影评级行业，其令人兴奋的月访问量达到了2.5亿。</strong></p><p id="218f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">【<em class="mb">阅读更多:</em><a class="ae jd" href="https://www.businesswire.com/news/home/20180222005150/en/IMDb-Launches-First-Ever-Skill-Amazon-Alexa" rel="noopener ugc nofollow" target="_blank"><em class="mb">https://www . business wire . com/news/home/20180222005150/en/IMDb-launchs-First-Ever-Skill-Amazon-Alexa</em></a>】</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="f46e" class="kb kc hi jx b fi kd ke l kf kg">merged_temp = pd.merge(df_ratings,df_title_basics,on="tconst",how="left")<br/>merged_temp = merged_temp[(merged_temp.startYear.notnull())&amp;(merged_temp.startYear&lt;2020)]<br/>counts_yearly = merged_temp.groupby("startYear").agg({"averageRating":[np.median],<br/>                                                     "numVotes":[np.sum,np.size,lambda x: np.sum(x)/np.size(x)]})</span><span id="5f36" class="kb kc hi jx b fi kh ke l kf kg">max_count_year = counts_yearly[("numVotes","sum")].idxmax().astype(int)<br/>max_year = counts_yearly[("numVotes","size")].idxmax().astype(int)</span><span id="576d" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(15,5))</span><span id="4d0a" class="kb kc hi jx b fi kh ke l kf kg">plt.subplot(1,2,1)<br/>ax =counts_yearly[("numVotes","size")].plot()<br/>ax.annotate(max_year,xy=(max_year,counts_yearly[("numVotes","size")].max()),<br/>            xytext=(1980,10000), arrowprops=dict(color="sandybrown",shrink=0.05,width=1))<br/>ax.annotate("WW I",xy=(1914,counts_yearly[("numVotes","size")].loc[1914]), xytext=(1900,2000), <br/>            arrowprops=dict(color="sandybrown",shrink=0.05,width=1))<br/>ax.annotate("WW II",xy=(1939,counts_yearly[("numVotes","size")].loc[1939]), xytext=(1950,4000), <br/>            arrowprops=dict(color="sandybrown",shrink=0.05,width=1))<br/>plt.title("Total Number Films per Year",fontweight="bold")</span><span id="4507" class="kb kc hi jx b fi kh ke l kf kg">plt.subplot(1,2,2)<br/>ax =counts_yearly[("numVotes","sum")].plot()<br/>ax.annotate(max_count_year,xy=(max_count_year,counts_yearly[("numVotes","sum")].max()),<br/>            xytext=(1960,3e7),arrowprops=dict(shrink=0.05,color="sandybrown",width=2))<br/>plt.title("Total Number of Voters per Year",fontweight="bold")</span><span id="ae01" class="kb kc hi jx b fi kh ke l kf kg">plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mc"><img src="../Images/a4f7b5f81a8b370dfcbf57ca5c47b1c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b7vrUDxU44_jduc7TEaRNg.png"/></div></div></figure><p id="dd97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可能是另一个研究点，让我们继续在数据中寻找更多有趣的点。</p><p id="6952" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图又有两个支线剧情。前者给出每年电影的平均评分，而后者显示每年每部电影的平均投票人数。自20世纪20年代以来，电影的平均收视率趋于波动，但并没有显示出单调的上升/下降趋势。</p><p id="4c64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">后一个图表在20世纪90年代和21世纪初达到顶峰，从那以后急剧下降。回想一下，每年的选民总数在2013年达到峰值，而不是90年代。这意味着<strong class="ih hj">90年代的电影最受用户关注</strong>。这可能与IMDb选民年龄组的优势有关。由于我们没有这方面的信息，我们可以猜测主要年龄组肯定在30至50岁之间。90年代的电影都是他们童年或少年时代的电影，你印象最深的一部电影是吧？可能还有其他因素，比如90年代的电影更好等等。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="c190" class="kb kc hi jx b fi kd ke l kf kg">max_count_year_per_film = counts_yearly[("numVotes","&lt;lambda_0&gt;")].idxmax().astype(int)</span><span id="3e10" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(15,5))</span><span id="68c4" class="kb kc hi jx b fi kh ke l kf kg">plt.subplot(1,2,1)<br/>ax =counts_yearly[("averageRating","median")].plot()<br/>plt.title("Average Rating per Year",fontweight="bold")</span><span id="4462" class="kb kc hi jx b fi kh ke l kf kg">plt.subplot(1,2,2)<br/>ax = counts_yearly[("numVotes","&lt;lambda_0&gt;")].plot()<br/>ax.annotate(max_count_year_per_film,xy=(max_count_year_per_film,counts_yearly[("numVotes","&lt;lambda_0&gt;")].max()),<br/>            xytext=(1960,5200),arrowprops=dict(shrink=0.05,color="sandybrown",width=2))<br/>plt.title("Average Number of Voters per Year per Film",fontweight="bold")</span><span id="22d4" class="kb kc hi jx b fi kh ke l kf kg">plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es md"><img src="../Images/93d03a826f4930a89d0b8b75231acbe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scR_E0v2FPBwGws7UVtsgA.png"/></div></div></figure><p id="5ade" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们以分钟为单位来可视化电影<strong class="ih hj">运行时间</strong>的分布。下面的单个条形表示有一些运行时间超过50000分钟的<strong class="ih hj">异常影片</strong></p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="150d" class="kb kc hi jx b fi kd ke l kf kg">sns.distplot(df_title_basics.runtimeMinutes.dropna().astype(int),bins=50)<br/>plt.gca().annotate("857\nhours of\nruntime?",xy=(51000,0.00005),xytext=(40000,0.0004),<br/>                   fontsize=20, ha="center",<br/>                   arrowprops=dict(color="sandybrown",width=1))<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es me"><img src="../Images/f20d301552efddc6ee1cfa0d68a3d921.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*2lKvN0exp6lsM1aSzrVw0w.png"/></div></figure><p id="052b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">35天(<strong class="ih hj"> 857小时</strong>)长片？让我们找出是哪部电影</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="0a5c" class="kb kc hi jx b fi kd ke l kf kg">import warnings<br/>warnings.filterwarnings("ignore")</span><span id="d3bf" class="kb kc hi jx b fi kh ke l kf kg">use = df_title_basics[df_title_basics.runtimeMinutes.notnull()]<br/>use["runtimeMinutes"] = use.runtimeMinutes.astype(int)<br/>use[use.runtimeMinutes&gt;50000]</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es mf"><img src="../Images/f99e95f5370dff02e8f629aa5a68590f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Uhs1hRqvARn8h1EwK2QBGQ.png"/></div></figure><p id="6a2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是<strong class="ih hj">物流(2012) </strong>，有史以来最长的纪录片。在下面的YouTube链接中可以看到一段72分钟长的剪辑:</p><p id="1dbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://www.youtube.com/watch?v=QYFG0xP12yE" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=QYFG0xP12yE</a></p><p id="9e37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多人可能不认为这是一种艺术形式，而是一架放置在集装箱船顶部并连续拍摄35天的相机。同样，《北京2003》和《摩登时代》也是出于同样的目的拍摄的</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="8110" class="kb kc hi jx b fi kd ke l kf kg">use.sort_values(by<strong class="jx hj">=</strong>"runtimeMinutes",ascending<strong class="jx hj">=False</strong>).head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mg"><img src="../Images/b214faca8ae054734aaaa93d346acd7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AZn_rG7ImScKiGpFdLno9w.png"/></div></div></figure><p id="4881" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了看到“电影”的清晰分布，我们需要从数据中剔除这些异常值，并绘制出其余部分。我们将只关注运行时间不超过300分钟的电影:</p><ul class=""><li id="aeb2" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">现在它看起来像一个以90分钟为中心的正态分布</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="3d1b" class="kb kc hi jx b fi kd ke l kf kg">rt = use.runtimeMinutes[use.runtimeMinutes&lt;300]<br/>mean_rt,median_rt,mode_rt = rt.mean(),rt.median(),rt.mode()[0]</span><span id="3868" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(15,5))<br/>sns.distplot(rt,kde_kws=dict(bw=10))<br/>plt.gca().axvline(mean_rt,label="mean",color=sns.color_palette("Set2")[1],ymax=0.1)<br/>plt.gca().axvline(median_rt,label="median",color=sns.color_palette("Set2")[2],ymax=0.2)<br/>plt.gca().axvline(mode_rt,label="mode",color=sns.color_palette("Set2")[3],ymax=0.3)<br/>plt.text(mean_rt+2,0.0025,f"Mean: {int(mean_rt)}")<br/>plt.text(median_rt+2,0.006,f"Median: {int(median_rt)}")<br/>plt.text(mode_rt+2,0.0085,f"Mode: {int(mode_rt)}")<br/>plt.legend()<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mh"><img src="../Images/5935d188b107fa98b6cb0dd03839be5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eiYRFnvkjhHKLq2FUt_drw.png"/></div></div></figure><p id="0f93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在列出投票数最高的<strong class="ih hj">前20部电影</strong>，首先我们需要合并df_ratings和df_title_basics表，并根据投票数对表进行排序:</p><ul class=""><li id="8e0f" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">《搏击俱乐部》、《黑客帝国》、《指环王》三部曲等热门电影如预期一样榜上有名</li><li id="5bba" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">除了《教父》,前20部投票电影都是从90年代到现在的</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="c802" class="kb kc hi jx b fi kd ke l kf kg">merged = pd.merge(df_ratings,df_title_basics,on="tconst",how="right").sort_values(by="numVotes",ascending=False)<br/>merged[["numVotes","primaryTitle","startYear"]].iloc[:20,:]</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es mi"><img src="../Images/543c868a54d00ad7865bdd16320d1d52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*fAgGPpphfHVbuWI8HZkbYQ.png"/></div></figure><p id="8e65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们找出<strong class="ih hj">收视率最高的20部电影</strong>，我们将再次使用合并后的表格，只需对其进行平均化排序。像IMDb网站的Top250顶级电影一样，我们将设置一个前提条件，以避免列出“未知”的高评级电影。因此，我们将只考虑至少有<strong class="ih hj"> 25000名用户</strong>评分的电影:</p><ul class=""><li id="b934" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">这和IMDb网站的前250名还是不一样，因为一部名为《哈巴姆·西尼菲》的土耳其电影以9.4的平均评分高居榜首</li><li id="538b" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">这是因为他们的前250名名单是按照一个公式排列的，这个公式包括每部电影从用户那里得到的评分数，以及从普通用户那里得到的评分值</li><li id="a184" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">因为我们没有常规的用户信息，所以我们不能过滤他们</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="61a4" class="kb kc hi jx b fi kd ke l kf kg">merged[merged.numVotes<strong class="jx hj">&gt;</strong>25000].sort_values(by<strong class="jx hj">=</strong>"averageRating",ascending<strong class="jx hj">=False</strong>).head(20)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mj"><img src="../Images/97951e7e62b430a2958abce38c491122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J6ZH30iKyKGHWEG5L-XdnA.png"/></div></div></figure><p id="c7a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们列出最差的20部电影:</p><ul class=""><li id="471c" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">又有三部土耳其电影高居榜首，土耳其用户很活跃吧？</li><li id="9a2e" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">看过的烂片有<strong class="ih hj">灾难片</strong>、<strong class="ih hj">超级英雄</strong>、<strong class="ih hj">史诗片</strong>、<strong class="ih hj">遇见斯巴达人、</strong>等。</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="c505" class="kb kc hi jx b fi kd ke l kf kg">merged[merged.numVotes<strong class="jx hj">&gt;</strong>25000].sort_values(by<strong class="jx hj">=</strong>"averageRating",ascending<strong class="jx hj">=True</strong>).head(20)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mk"><img src="../Images/7acbad5ca8963f23bdb599ae95f5925a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJDSIW0x_yrk4uuXZ-iA8w.png"/></div></div></figure><p id="f761" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看电影类型的平均评分(中位数)。我们将使用与上面相同的计数器:</p><ul class=""><li id="bb2c" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">纪录片和新闻类(都是政治类)平均收视率最高</li><li id="bfa4" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">恐怖片和科幻片排在名单的最后(可能是因为这两部电影都有太多无聊的例子)</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="78a7" class="kb kc hi jx b fi kd ke l kf kg">merged_temp = merged[merged.genres.notnull()]<br/>vec = CountVectorizer(token_pattern='(?u)\\b[\\w-]+\\b', analyzer='word').fit(merged_temp.genres)<br/>bag_of_genres = pd.DataFrame(vec.transform(merged_temp.genres).todense(),<br/>                             columns=vec.get_feature_names(),index=merged_temp.index)<br/>merged_temp = pd.concat([merged_temp,bag_of_genres],axis=1)</span><span id="b66d" class="kb kc hi jx b fi kh ke l kf kg">rating_counts_means = pd.DataFrame([[merged_temp.averageRating[merged_temp[i]==1].median(),merged_temp[i].sum()] <br/> for i in vec.get_feature_names()],columns=["median","count"],index=vec.get_feature_names()).sort_values("median",ascending=False)</span><span id="6c9a" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(7,8))<br/>sns.barplot(y=rating_counts_means.index,x=rating_counts_means["median"],orient="h")<br/>for i,counts in enumerate(rating_counts_means["count"]):<br/>    plt.text(0.5,i+0.25,f"{counts:&gt;5} films")<br/>    plt.text(rating_counts_means["median"][i],i+0.25,rating_counts_means["median"][i])<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es ml"><img src="../Images/6722468e55ccfbdf3ab72cbe46d5fdc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*DACAhVLTjqbL1EgpMAIzPw.png"/></div></figure><p id="0854" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用户是否倾向于对播放时间较长的电影给予更高的评价？让我们来看看:</p><ul class=""><li id="2dc1" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">使用pandas的qcut对电影的运行时间进行分组(qcut会自动选择箱，以便为每个组分配相同数量的样本)</li><li id="d01d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">异常值薄膜在箱线图中不可见</li><li id="b767" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">箱线图中值(每个箱中的垂直线)显示，当电影运行时间增加时<strong class="ih hj">平均评级趋于增加</strong></li><li id="8172" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">84m及以下的电影例外的原因可能是这个群体包含了很多高收视率的<strong class="ih hj">动画电影</strong></li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="4cac" class="kb kc hi jx b fi kd ke l kf kg">use = merged_temp[merged_temp.numVotes&gt;1000]<br/>use["runtimeMinutes"] = pd.to_numeric(use.runtimeMinutes)<br/>[groups,edges] = pd.qcut(use.runtimeMinutes,10,precision=0,retbins=True)<br/>ratings_avg = use.groupby(groups).agg({"averageRating":np.median})<br/>sns.boxplot(y=groups,x="averageRating",data=use,orient="h",showfliers=False)<br/>for i,rate in enumerate(ratings_avg["averageRating"]):<br/>    plt.text(rate+0.1,i+0.2,rate)<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es mm"><img src="../Images/40f80ae9fb7211fd873d08369d1ae059.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*A6ZAfAykdHn2AYDCMqIy8g.png"/></div></figure><h1 id="4c3b" class="ki kc hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">名称基本信息表</h1><p id="94e4" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">name.basics.tsv.gz—包含以下名称信息:</p><ul class=""><li id="fd4d" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> nconst </strong>(字符串)—姓名/人员的字母数字唯一标识符</li><li id="cf56" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> primaryName </strong>(字符串)–人们最常使用的名字</li><li id="6c73" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">出生年份</strong>—YYYY格式</li><li id="257f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">死亡年份</strong> —如果适用，以YYYY格式，否则' \N '</li><li id="e4f9" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">主要职业</strong>(字符串数组)——一个人的前三大职业</li><li id="752d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">known titles</strong>(t consts数组)——此人的知名头衔</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="e764" class="kb kc hi jx b fi kd ke l kf kg">df_name_basics = pickle.load(open("name.basics.sav","rb"))<br/>df_name_basics.head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mn"><img src="../Images/2fc3002f3ebe9a5bef9ac7df6fc5f476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uyG1wys8Gr34P0uj7JaJTg.png"/></div></div></figure><p id="b758" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这份名单有将近1000万个名字，来自不同的职业，如男演员、女演员、导演、作家等。它包含了他们的出生和死亡年份信息以及他们最著名的艺术作品</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="2830" class="kb kc hi jx b fi kd ke l kf kg">df_name_basics.info()</span><span id="b0ee" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 9991422 entries, 0 to 9991421<br/>Data columns (total 6 columns):<br/> #   Column             Dtype  <br/>---  ------             -----  <br/> 0   nconst             object <br/> 1   primaryName        object <br/> 2   birthYear          float64<br/> 3   deathYear          float64<br/> 4   primaryProfession  object <br/> 5   knownForTitles     object <br/>dtypes: float64(2), object(4)<br/>memory usage: 457.4+ MB</span></pre><p id="4a93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集中人员的出生年份分布如下所示。该数据集甚至包含了公元4年的古代作家</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="796f" class="kb kc hi jx b fi kd ke l kf kg">sns.distplot(df_name_basics.birthYear.dropna(),kde=False)<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es mo"><img src="../Images/a04fae6bd972b65d659f6b8059d78a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*JIq8ORfKknPXOiOzP_g8Tg.png"/></div></figure><p id="44be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集中<strong class="ih hj">排名前10位的古人</strong>:</p><ul class=""><li id="a326" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">卢西奥·阿诺·塞内卡出生于公元4年，是数据集中最古老的人</li><li id="3f21" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">一些条目有错误的出生/死亡年份信息，如负寿命或极端寿命(如乔治桑格出生23日，死亡1911年)</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="4f0c" class="kb kc hi jx b fi kd ke l kf kg">df_name_basics.sort_values("birthYear").head(10)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mp"><img src="../Images/cd9fc393f5195e79a01d59d6129217bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JxfeBlGYAsa-RMHr0-vx2w.png"/></div></div></figure><p id="f49b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集中人的寿命分布:</p><ul class=""><li id="107b" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">显示了一个负偏态，其中众数&gt;中位数&gt;平均值，这是显示死亡年龄的分布的预期值</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="3b1a" class="kb kc hi jx b fi kd ke l kf kg">use = df_name_basics[["birthYear","deathYear","primaryName"]].dropna()<br/>use["lifespan"] = use.deathYear - use.birthYear<br/>use["lifespan"][(use.lifespan&gt;200)|(use.lifespan&lt;0)]=use.lifespan.median()</span><span id="3349" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(12,5))<br/>ax = sns.distplot(use.lifespan)<br/>ax.axvline(use.lifespan.mode()[0],label=f"mode age: {int(use.lifespan.mode()[0])}",color="forestgreen")<br/>ax.axvline(use.lifespan.median(),label=f"median age: {int(use.lifespan.median())}",color="sandybrown")<br/>ax.axvline(use.lifespan.mean(),label=f"mean age: {int(use.lifespan.mean())}",color="fuchsia")<br/>plt.legend()<br/>plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mq"><img src="../Images/7680ebe7e9045d045f374f87eab2e852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iw488kV6i3EkFFMNAB-JFg.png"/></div></div></figure><p id="da03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在数据集中找出<strong class="ih hj">寿命最长的前10个人</strong>:</p><ul class=""><li id="5d37" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">https://en.wikipedia.org/wiki/Jeanne_Calment去世，享年122岁，是历史上被证实寿命最长的人</li><li id="8702" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">尽管她没有参与任何电影，但她出现在了一部关于她的纪录片中，这就是为什么她在我们的数据集中</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="408b" class="kb kc hi jx b fi kd ke l kf kg">use.sort_values("lifespan",ascending<strong class="jx hj">=False</strong>).head(10)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es mr"><img src="../Images/63c3f4edd3a9813f4531780850700755.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*zA_mNFBFTe7GSrFlq-rKrg.png"/></div></figure><h1 id="f035" class="ki kc hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">标题船员表</h1><p id="9799" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">title.crew.tsv.gz—包含IMDb所有电影的导演和编剧信息。字段包括:</p><ul class=""><li id="afc7" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> tconst </strong>(字符串)—标题的字母数字唯一标识符</li><li id="56f6" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">导演</strong>(nconst数组)—给定标题的导演</li><li id="fea7" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">作家(nconst数组)——给定标题的作家</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="e05c" class="kb kc hi jx b fi kd ke l kf kg">df_title_crew = pickle.load(open("title.crew.sav","rb"))<br/>df_title_crew.head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es ms"><img src="../Images/7b79d5c46f31e9e58d84e19280cb2fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*2lcwqoY_9TN7Mh1LR0jFcg.png"/></div></figure><p id="d8e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该表包含660万个条目</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="8fd1" class="kb kc hi jx b fi kd ke l kf kg">df_title_crew.info()</span><span id="ffcf" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 6682995 entries, 0 to 6682994<br/>Data columns (total 3 columns):<br/> #   Column     Dtype <br/>---  ------     ----- <br/> 0   tconst     object<br/> 1   directors  object<br/> 2   writers    object<br/>dtypes: object(3)<br/>memory usage: 153.0+ MB</span></pre><p id="48cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有些电影有大量的编剧和导演。为了分析它，我们需要结合三个表(标题评级，标题船员，标题基础)</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="2c02" class="kb kc hi jx b fi kd ke l kf kg">merged = pd.merge(pd.merge(df_title_basics,df_title_crew,on="tconst",how="left"),df_ratings,on="tconst",how="left")<br/>merged.head(10)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mt"><img src="../Images/0de79d318737ff107ea9ad5b7fdedd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBvGspH7wOcFseoO0hbJmw.png"/></div></div></figure><p id="21df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将能够为他们的导演分析591K部电影，为他们的编剧分析492K部电影，因为合并的表具有那些非空的行数</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="2338" class="kb kc hi jx b fi kd ke l kf kg">merged.info()</span><span id="0643" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 658608 entries, 0 to 658607<br/>Data columns (total 11 columns):<br/> #   Column          Non-Null Count   Dtype  <br/>---  ------          --------------   -----  <br/> 0   tconst          658608 non-null  object <br/> 1   titleType       658608 non-null  object <br/> 2   primaryTitle    658608 non-null  object <br/> 3   originalTitle   658608 non-null  object <br/> 4   startYear       592644 non-null  float64<br/> 5   runtimeMinutes  419983 non-null  object <br/> 6   genres          251408 non-null  object <br/> 7   directors       591101 non-null  object <br/> 8   writers         492270 non-null  object <br/> 9   averageRating   285470 non-null  float64<br/> 10  numVotes        285470 non-null  float64<br/>dtypes: float64(3), object(8)<br/>memory usage: 60.3+ MB</span></pre><ul class=""><li id="082e" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">下面的饼状图显示，一部电影有多个导演(8%)的情况不如有多个编剧(44%)的情况普遍</li><li id="4a6a" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">绝大多数电影(92%)只有一个导演，几乎1/3的电影有两个编剧</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="39b4" class="kb kc hi jx b fi kd ke l kf kg">writer_counts = merged.writers.dropna().apply(lambda x: len(x.split(",")))<br/>writer_counts[writer_counts&gt;4] = "5+"<br/>director_counts = merged.directors.dropna().apply(lambda x: len(x.split(",")))<br/>director_counts[director_counts&gt;2] = "3+"</span><span id="2d34" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(12,6))<br/>plt.subplot(1,2,1)<br/>writer_counts.value_counts().plot.pie(autopct="%.0f%%",pctdistance=0.8,<br/>                                     wedgeprops=dict(width=0.4))<br/>plt.title("Number of Writers",fontweight="bold")<br/>plt.ylabel(None)</span><span id="30e0" class="kb kc hi jx b fi kh ke l kf kg">plt.subplot(1,2,2)<br/>director_counts.value_counts().plot.pie(autopct="%.0f%%",pctdistance=0.8,<br/>                                     wedgeprops=dict(width=0.4))<br/>plt.title("Number of Directors",fontweight="bold")<br/>plt.ylabel(None)</span><span id="65dd" class="kb kc hi jx b fi kh ke l kf kg">plt.show()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es mu"><img src="../Images/5bad223757948832f8420ba56e548032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*uZEVYrlk84STH-UNEAoQWQ.png"/></div></figure><p id="3e4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一部电影的编剧数量有些极端:</p><ul class=""><li id="5aab" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">泰德·邦迪有了儿子有了<strong class="ih hj"> 62作家</strong></li><li id="524d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">《50个吻》制片人用下面的口号来宣传这部电影:“50个作家。50个电影制作人。一张图。”</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="8e33" class="kb kc hi jx b fi kd ke l kf kg">writer_counts = merged.writers.dropna().apply(lambda x: len(x.split(",")))<br/>temp = merged[["startYear","primaryTitle","writers"]].loc[writer_counts.nlargest(5).index]<br/>temp["Writer Count"] = writer_counts.nlargest(5)<br/>temp</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mv"><img src="../Images/4fc4660af7d115853be09650340a2139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bC-Yah4X_aPm73DIvRIOjQ.png"/></div></div></figure><p id="7442" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也是拥有众多导演的顶级电影:</p><ul class=""><li id="a055" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj">泰德·邦迪有个儿子</strong>凭借惊人的<strong class="ih hj"> 88位导演</strong>再次成为现在的顶级电影</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="3498" class="kb kc hi jx b fi kd ke l kf kg">director_counts = merged.directors.dropna().apply(lambda x: len(x.split(",")))<br/>temp = merged[["startYear","primaryTitle","directors"]].loc[director_counts.nlargest(5).index]<br/>temp["Director Count"] = director_counts.nlargest(5)<br/>del merged, merged_temp<br/>temp</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mw"><img src="../Images/e5fef667116cddfd13b211b8a49bfbd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cB2qa5tcNRLG75hXAXadOA.png"/></div></div></figure><p id="6617" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们来分析一下导演的成功。我们首先需要制定自己的成功标准。我想到的第一个标准是导演的平均评分。同样，我们需要设置一些门槛来排除不知名的本地董事。阈值:</p><ul class=""><li id="9d9a" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">只有25000票及以上的电影才被接受</li><li id="fa2f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">只接受导演有3部或更多电影的作品</li><li id="2392" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">仅接受投票人数中位数为10万的董事</li></ul><p id="bd3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在寻找具有国际影响力的成功导演。要做到这一点，我们需要将我们到目前为止检查过的所有四个表结合起来。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="3006" class="kb kc hi jx b fi kd ke l kf kg">director_temp = df_title_crew.drop("writers",axis=1)<br/>director_temp.columns = ["tconst","nconst"]<br/>director_temp.nconst = director_temp.nconst.dropna().apply(lambda x: x.split(",")[0])</span><span id="acf2" class="kb kc hi jx b fi kh ke l kf kg">directors = pd.merge(pd.merge(pd.merge(df_title_basics,df_ratings,on="tconst"),<br/>                          director_temp,on="tconst"),<br/>                 df_name_basics[["nconst","primaryName"]],on="nconst")<br/>del director_temp<br/>directors.head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mx"><img src="../Images/c0b293fa7e955e6b5056ef3322372b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHSkQthGsLwb10qIusIMTA.png"/></div></div></figure><p id="9ebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">表被连接起来(内部),新表的样本大小变成了280K行。它包含了28万部电影及其导演信息</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="37e5" class="kb kc hi jx b fi kd ke l kf kg">directors.info()</span><span id="fb83" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 280191 entries, 0 to 280190<br/>Data columns (total 11 columns):<br/> #   Column          Non-Null Count   Dtype  <br/>---  ------          --------------   -----  <br/> 0   tconst          280191 non-null  object <br/> 1   titleType       280191 non-null  object <br/> 2   primaryTitle    280191 non-null  object <br/> 3   originalTitle   280191 non-null  object <br/> 4   startYear       280182 non-null  float64<br/> 5   runtimeMinutes  248302 non-null  object <br/> 6   genres          116922 non-null  object <br/> 7   averageRating   280191 non-null  float64<br/> 8   numVotes        280191 non-null  int64  <br/> 9   nconst          280191 non-null  object <br/> 10  primaryName     280191 non-null  object <br/>dtypes: float64(2), int64(1), object(8)<br/>memory usage: 25.7+ MB</span></pre><p id="5734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们将他们分组，并应用我们的阈值来揭示最成功的10位导演:</p><ul class=""><li id="7d72" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">该表列出了前10名导演，按照他们的电影评分中位数排序。此外，每部电影的平均投票数以及导演的电影数都在最后一栏中给出</li><li id="8e71" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">克里斯托弗·诺兰当之无愧地名列榜首，也是我一直以来最喜欢的导演</li><li id="011d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">名单上全是知名的成功导演，没有本地人:)</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="efc3" class="kb kc hi jx b fi kd ke l kf kg">director_success = directors[directors.numVotes&gt;25000].groupby("primaryName").\<br/>agg({"averageRating":[np.median],"numVotes":[np.median],"nconst":[np.size]}).\<br/>sort_values(("averageRating","median"),ascending=False)</span><span id="5698" class="kb kc hi jx b fi kh ke l kf kg">director_success[(director_success[("numVotes","median")]&gt;100000)&amp;(director_success[("nconst","size")]&gt;3)].\<br/>sort_values(("averageRating","median"),ascending=False).head(10)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es my"><img src="../Images/40ae3d59540f4a801b2177b635e41f97.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*LBygb1EW-fUGx9bDGVY72A.png"/></div></figure><p id="9816" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在散点图中用我们的标准来想象导演:</p><ul class=""><li id="23f5" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">导演的字体和颜色与他们的平均评分成正比</li><li id="6ece" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">导演的圆直径与他们的电影总数成正比</li><li id="4c81" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">x轴以对数刻度显示，以避免密集的点</li><li id="a347" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">位于y轴顶端的导演拥有更高的平均评分，而位于图表右侧的导演拥有更受欢迎的电影</li><li id="3524" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">克里斯托弗·诺兰坐在图表的右上方，可以说他的电影既受欢迎又高质量</li><li id="948c" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">查理·卓别林坐在左上方。这是因为他的电影平均收视率最高，但不受欢迎。我想这又是由于选民年龄组的优势</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="414f" class="kb kc hi jx b fi kd ke l kf kg">directors_successful = director_success[(director_success[("numVotes","median")]&gt;150000)&amp;\<br/>                (director_success[("nconst","size")]&gt;4)].sort_values(("averageRating","median"),ascending=False)</span><span id="ee5c" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(17,15))<br/>sns.scatterplot(y=directors_successful[("averageRating","median")],x=directors_successful[("numVotes","median")],<br/>               s=directors_successful[("nconst","size")]*25,hue=directors_successful.index, legend=False,<br/>               )<br/>plt.xlabel("Average Number of Votes of Director's Films")<br/>plt.ylabel("Average Rating of Director's Films")<br/>plt.gca().set_xscale("log")</span><span id="071f" class="kb kc hi jx b fi kh ke l kf kg">for names in directors_successful.T:<br/>    plt.text(directors_successful.T[names][("numVotes","median")],<br/>            directors_successful.T[names][("averageRating","median")],<br/>             names,rotation=np.random.randint(0,45), rotation_mode="anchor",<br/>             fontsize=directors_successful.T[names][("averageRating","median")]**1.3)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es mz"><img src="../Images/567a56baa888f4b10414f5d83aa34267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1CAXDAmYRTEvT2VFxAy3w.png"/></div></div></figure><p id="082b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作家怎么样？让我们对他们做同样的分析:</p><ul class=""><li id="4eaa" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">现在，克里斯托弗·诺兰的弟弟乔纳森·诺兰担任主角，因为他是他哥哥的许多电影的联合编剧</li><li id="c17c" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">克里斯托弗·马库斯写了许多最近的超级英雄电影，这就是为什么他发现自己的位置更受欢迎(右)</li><li id="c7ab" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">安德鲁·斯坦顿还创作了许多成功的动画系列，如海底总动员，瓦力，玩具总动员系列</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="6f87" class="kb kc hi jx b fi kd ke l kf kg">writer_temp = df_title_crew.drop("directors",axis=1)<br/>writer_temp.columns = ["tconst","nconst"]<br/>writer_temp.nconst = writer_temp.nconst.dropna().apply(lambda x: x.split(",")[0])</span><span id="f59c" class="kb kc hi jx b fi kh ke l kf kg">writers = pd.merge(pd.merge(pd.merge(df_title_basics,df_ratings,on="tconst"),<br/>                          writer_temp,on="tconst"),<br/>                 df_name_basics[["nconst","primaryName"]],on="nconst")</span><span id="f076" class="kb kc hi jx b fi kh ke l kf kg">writer_success = writers[writers.numVotes&gt;25000].groupby("primaryName").\<br/>agg({"averageRating":[np.median],"numVotes":[np.median],"nconst":[np.size]}).\<br/>sort_values(("averageRating","median"),ascending=False)</span><span id="df8b" class="kb kc hi jx b fi kh ke l kf kg">writers_successful = writer_success[(writer_success[("numVotes","median")]&gt;150000)&amp;\<br/>                (writer_success[("nconst","size")]&gt;=4)].sort_values(("averageRating","median"),ascending=False)</span><span id="94a2" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(17,15))<br/>sns.scatterplot(y=writers_successful[("averageRating","median")],x=writers_successful[("numVotes","median")],<br/>               s=writers_successful[("nconst","size")]*25,hue=writers_successful.index, legend=False,<br/>               )<br/>plt.xlabel("Average Number of Votes of Writer's Films")<br/>plt.ylabel("Average Rating of Writer's Films")<br/>plt.gca().set_xscale("log")</span><span id="9eec" class="kb kc hi jx b fi kh ke l kf kg">for names in writers_successful.T:<br/>    plt.text(writers_successful.T[names][("numVotes","median")],<br/>            writers_successful.T[names][("averageRating","median")],<br/>             names,rotation=np.random.randint(0,45), rotation_mode="anchor",<br/>             fontsize=writers_successful.T[names][("averageRating","median")]**1.3)</span><span id="3382" class="kb kc hi jx b fi kh ke l kf kg">del writer_temp</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es na"><img src="../Images/9a2bf5910034c5e4ac3e9a42e15e0675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1nA-UmnQ7mtHbiu3B_ygg.png"/></div></div></figure><h1 id="bd2c" class="ki kc hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">标题主体表</h1><p id="c6d1" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">title.principals.tsv.gz—包含片头的主要演员/工作人员</p><ul class=""><li id="253d" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> tconst </strong>(字符串)—标题的字母数字唯一标识符</li><li id="0e42" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">排序</strong>(整数)—唯一标识给定titleId的行的数字</li><li id="ca47" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> nconst </strong>(字符串)—姓名/人员的字母数字唯一标识符</li><li id="1af8" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">类别</strong>(字符串)—该人员的工作类别</li><li id="4684" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">职务(字符串)</strong> —具体的职务名称(如果适用)，否则' \N '</li><li id="3b78" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">字符</strong>(字符串)—如果适用，游戏角色的名称，否则' \N '</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="eb69" class="kb kc hi jx b fi kd ke l kf kg">df_title_principals = pickle.load(open("title.principals.sav","rb"))<br/>df_title_principals.head(10)</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es nb"><img src="../Images/1d915c254fc13daf6380040655dffa88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*ht5ceBZA2-lTHiwsdDpoZQ.png"/></div></figure><p id="281d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是其他IMDb表中最大的一张，大小接近2GB。它包含超过3800万<strong class="ih hj">主要演员/工作人员，如演员、作家、导演、制片人、编辑等。其与每部电影相关联。</strong></p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="b5ec" class="kb kc hi jx b fi kd ke l kf kg">df_title_principals.category.value_counts().plot.pie(autopct="%.0f%%", pctdistance=0.8, figsize=(7,7),<br/>                                                          wedgeprops=dict(width=0.4))</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es nc"><img src="../Images/61e677f7b092081e337eb514cfc40706.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*dCuCGBfBHCGQOkKAU0KT0A.png"/></div></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="ef5a" class="kb kc hi jx b fi kd ke l kf kg">df_title_principals.info()</span><span id="b7e6" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 38588696 entries, 0 to 38588695<br/>Data columns (total 6 columns):<br/> #   Column      Dtype <br/>---  ------      ----- <br/> 0   tconst      object<br/> 1   ordering    int64 <br/> 2   nconst      object<br/> 3   category    object<br/> 4   job         object<br/> 5   characters  object<br/>dtypes: int64(1), object(5)<br/>memory usage: 1.7+ GB</span></pre><p id="aef8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看谁是电影界最忙的人:</p><ul class=""><li id="5b3a" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">Ilaiyaraaja和<strong class="ih hj">威廉·莎士比亚</strong>是人数最多的贡献者</li><li id="cf93" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">作为一名演员，婆罗门·安达姆参演了一千多部电影</li><li id="ba2b" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">除了莎士比亚，那里没什么名人</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="df76" class="kb kc hi jx b fi kd ke l kf kg">inxs = df_title_principals.tconst.isin(df_title_basics.tconst)<br/>use = df_title_principals[inxs]</span><span id="34f0" class="kb kc hi jx b fi kh ke l kf kg">top_names = use.nconst.value_counts().head(20)<br/>top_names = pd.DataFrame(list(zip(top_names.index,top_names.values)),columns=["nconst","count"])<br/>top_names = pd.merge(top_names,df_name_basics[["nconst","primaryName"]],on="nconst")</span><span id="1ab2" class="kb kc hi jx b fi kh ke l kf kg">top_names["job_type"] = [use[use["nconst"] == i].category.value_counts().index[0] for i in top_names.nconst]<br/>top_names</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div class="er es nd"><img src="../Images/8962ba2e7001aa933dc4d47c5090bb51.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*OZtS7xTeoATZCVv_hutl8A.png"/></div></figure><h1 id="8ce1" class="ki kc hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">标题Akas表</h1><p id="e232" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">title.akas.tsv.gz—包含以下标题信息:</p><ul class=""><li id="8a20" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> titleId </strong>(字符串)tconst，标题的字母数字唯一标识符</li><li id="b53d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">排序</strong>(整数)—唯一标识给定titleId的行的数字</li><li id="9099" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">标题</strong>(字符串)—本地化的标题</li><li id="e3f8" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">region</strong>(string)——本版本标题的区域</li><li id="a8ef" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">语言</strong>(字符串)——标题的语言</li><li id="778d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">类型</strong>(数组)—该备选标题的枚举属性集。以下一项或多项:“替代”、“dvd”、“节日”、“电视”、“视频”、“工作”、“原创”、“imdbDisplay”。将来可能会在没有警告的情况下添加新值</li><li id="d61d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">属性</strong>(数组)——描述此备选标题的附加术语，未列举</li><li id="8324" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">is original title</strong>(boolean)—0:非原标题；1:原标题</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="295c" class="kb kc hi jx b fi kd ke l kf kg">df_title_akas = pickle.load(open("title.akas.sav","rb"))<br/>df_title_akas.columns = ['tconst', 'ordering', 'title', 'region', 'language', 'types',<br/>       'attributes', 'isOriginalTitle']<br/>df_title_akas.head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es ne"><img src="../Images/3e90748f60eba91d26085a94ee2c988f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zTIhq0RQUvEmwAi_pINoQ.png"/></div></div></figure><p id="ce23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该表包括标题的也被称为(AKA)的信息，如标题在不同国家的变化。表中有<strong class="ih hj">2100万</strong>行。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="77c8" class="kb kc hi jx b fi kd ke l kf kg">df_title_akas.info()</span><span id="897b" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 21116454 entries, 0 to 21116453<br/>Data columns (total 8 columns):<br/> #   Column           Dtype  <br/>---  ------           -----  <br/> 0   tconst           object <br/> 1   ordering         int64  <br/> 2   title            object <br/> 3   region           object <br/> 4   language         object <br/> 5   types            object <br/> 6   attributes       object <br/> 7   isOriginalTitle  float64<br/>dtypes: float64(1), int64(1), object(6)<br/>memory usage: 1.3+ GB</span></pre><p id="92a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们只对电影感兴趣，因此AKAs表与<strong class="ih hj">标题基础知识</strong>表内部连接</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="43d0" class="kb kc hi jx b fi kd ke l kf kg">df_title_akas = pd.merge(df_title_akas,df_title_basics,on="tconst")<br/>df_title_akas.info()</span><span id="380f" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 1971524 entries, 0 to 1971523<br/>Data columns (total 14 columns):<br/> #   Column           Dtype  <br/>---  ------           -----  <br/> 0   tconst           object <br/> 1   ordering         int64  <br/> 2   title            object <br/> 3   region           object <br/> 4   language         object <br/> 5   types            object <br/> 6   attributes       object <br/> 7   isOriginalTitle  float64<br/> 8   titleType        object <br/> 9   primaryTitle     object <br/> 10  originalTitle    object <br/> 11  startYear        float64<br/> 12  runtimeMinutes   object <br/> 13  genres           object <br/>dtypes: float64(2), int64(1), object(11)<br/>memory usage: 225.6+ MB</span></pre><p id="c803" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们先将地区代码转换成国家名称。然后数一数，想象出前20名:</p><ul class=""><li id="b0ec" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">这一统计并没有给出电影院或电影票的总数，而是给出了该国电影院放映了多少部不同的电影(数字越大，放映的电影种类越多)</li><li id="ddd6" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">美国显然赢得了这场竞争</li><li id="bea7" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">有趣的是，希腊和匈牙利发现自己处于中间位置，比我想象的要好</li></ul><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="afb0" class="kb kc hi jx b fi kd ke l kf kg">import pycountry<br/>country_counts = df_title_akas.region.value_counts()<br/>country_names = [pycountry.countries.get(alpha_2=coun).name for coun in country_counts.drop(["XWW","XWG"]).index[:20]]<br/>counts = country_counts.drop(["XWW","XWG"]).values[:20]</span><span id="8c46" class="kb kc hi jx b fi kh ke l kf kg">plt.figure(figsize=(12,5.5))<br/>sns.barplot(x=counts,y=country_names,orient="h")<br/>plt.xlabel("Total Number of Different Films Shown in Cinemas")</span><span id="2309" class="kb kc hi jx b fi kh ke l kf kg">for i,count in enumerate(counts):<br/>    plt.text(100,i,count,va="center")</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es nf"><img src="../Images/89e3ed34031fb9ac933994698fd1ae72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wHx3S3XR3Ot2Rg3YrsSMHA.png"/></div></div></figure><h1 id="e203" class="ki kc hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">合并所有表格(仅适用于电影)</h1><p id="6d71" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">现在让我们通过只选择电影标题来合并所有表格。通过这种方式，我们将减少数据集的大小，并保存它以供将来使用。加载和玩决赛桌会快得多:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="1181" class="kb kc hi jx b fi kd ke l kf kg">df_movies = pd.merge(pd.merge(pd.merge(pd.merge(df_title_basics,df_ratings,on="tconst"),<br/>                          df_title_crew,on="tconst"),<br/>                     df_title_principals,on="tconst"),<br/>                 df_name_basics,on="nconst")<br/>df_movies.head()</span></pre><figure class="js jt ju jv fd ll er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es ng"><img src="../Images/bfcad7a4fac33e8427c8246327b5673d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MZr5HoWjjiLr6C4_pZI2Cg.png"/></div></div></figure><p id="aabb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个名为“df_movies.csv”的文件，并将最终表格保存在。逗号分隔值（csv）文件格式</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="cf7a" class="kb kc hi jx b fi kd ke l kf kg">df_movies.to_csv("df_movies.csv")</span></pre><p id="df2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的表格有250万行，21列</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="1e29" class="kb kc hi jx b fi kd ke l kf kg">df_movies.info()</span><span id="fc1a" class="kb kc hi jx b fi kh ke l kf kg">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 2549460 entries, 0 to 2549459<br/>Data columns (total 21 columns):<br/> #   Column             Dtype  <br/>---  ------             -----  <br/> 0   tconst             object <br/> 1   titleType          object <br/> 2   primaryTitle       object <br/> 3   originalTitle      object <br/> 4   startYear          float64<br/> 5   runtimeMinutes     object <br/> 6   genres             object <br/> 7   averageRating      float64<br/> 8   numVotes           int64  <br/> 9   directors          object <br/> 10  writers            object <br/> 11  ordering           int64  <br/> 12  nconst             object <br/> 13  category           object <br/> 14  job                object <br/> 15  characters         object <br/> 16  primaryName        object <br/> 17  birthYear          float64<br/> 18  deathYear          float64<br/> 19  primaryProfession  object <br/> 20  knownForTitles     object <br/>dtypes: float64(4), int64(2), object(15)<br/>memory usage: 427.9+ MB</span></pre><p id="20fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在WeTransfer上上传了数据文件(560MB)，可以从下面的链接下载(WeTransfer在7天内删除上传，您可以在2020年4月14日之前下载数据):</p><p id="c938" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://we.tl/t-cQJVvEjZgv" rel="noopener ugc nofollow" target="_blank">https://we.tl/t-cQJVvEjZgv</a></p><p id="00f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以用这些数据做上面所有的分析，也可以实现你自己的想法。</p><p id="033a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯！</p></div></div>    
</body>
</html>