<html>
<head>
<title>How to Create a Basic Interactive GUI and running Deep Learning NLP Model using Flask | Step-by-Step</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Flask创建一个基本的交互式GUI并运行深度学习NLP模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-create-a-basic-interactive-gui-and-running-deep-learning-nlp-model-using-flask-a9b77eb52682?source=collection_archive---------4-----------------------#2019-11-23">https://medium.com/analytics-vidhya/how-to-create-a-basic-interactive-gui-and-running-deep-learning-nlp-model-using-flask-a9b77eb52682?source=collection_archive---------4-----------------------#2019-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e50a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">烧瓶API，IMDB分类器</h2></div><blockquote class="ix iy iz"><p id="1190" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">作者:Dhaiwat Kabaria | Utsav Jethva</p></blockquote></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ke"><img src="../Images/17bbd0cf2106aeb7f000943289b698fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u8Uw3eu5sV5bcTiL"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">马克·戴恩斯在<a class="ae ku" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="fc5a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">现在做一个机器学习模型已经变得非常容易了。您可以在几分钟内创建您的ML模型。深度学习也变得越来越受欢迎，谷歌允许用户通过谷歌Colab的云免费使用GPU。但是您创建的模型是离线创建的。想知道聊天机器人是如何在网站上操作的吗？科技巨头如何实时使用他们的ML模型？</p><p id="9fe9" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">互联网上有很多关于如何构建和优化ML模型的内容，但他们没有教授如何实时部署它们。</p><p id="a521" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">建立一个模型和实际上让人们在他们的产品和服务中使用它是有很大区别的。</p><p id="4512" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">在这篇博客中，我们将首先创建一个文本分类器，使用深度学习NLP模型来预测IMDB电影评论的情感。然后使用Flask在线部署它。</p><p id="872a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">Flask是用于构建web应用程序的Python微框架。这个API允许我们通过HTTP请求利用预测能力。</p><p id="3bea" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">这有两个主要部分:</p><p id="4d60" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">1)利用被标记为正面或负面的IMBD电影评论来离线训练深度学习分类器。</p><p id="ee53" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">2)将经过训练的模型部署为服务用户的服务</p><h1 id="e15c" class="ky kz hi bd la lb lc ld le lf lg lh li io lj ip lk ir ll is lm iu ln iv lo lp bi translated">制作python代码</h1><p id="2869" class="pw-post-body-paragraph ja jb hi jd b je lq ij jg jh lr im jj kv ls jm jn kw lt jq jr kx lu ju jv jw hb bi translated">我们将使用IMDB评论的inbuild Keras数据集对电影评论进行情感分析。我们将创建一个简单的MLP深度学习模型。数据集和模型的细节在这个<a class="ae ku" href="https://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/" rel="noopener ugc nofollow" target="_blank">博客</a>中给出。</p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="9187" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">为了了解我们的模型在训练期间是如何学习的，我们现在将在测试数据集上对它进行评估。</p><pre class="kf kg kh ki fd lx ly lz ma aw mb bi"><span id="f74a" class="mc kz hi ly b fi md me l mf mg"># Final evaluation of the model</span><span id="dbe6" class="mc kz hi ly b fi mh me l mf mg">scores = model.evaluate(X_test, y_test, verbose=0)</span><span id="5aad" class="mc kz hi ly b fi mh me l mf mg">print("Accuracy: %.2f%%" % (scores[1]*100))</span></pre><p id="73c0" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">训练完模型后，我们将保存我们的模型，以便以后使用。我们必须将我们的模型架构保存为. json文件，并将它在训练过程中学习到的模型权重保存为. h5文件。</p><pre class="kf kg kh ki fd lx ly lz ma aw mb bi"><span id="2782" class="mc kz hi ly b fi md me l mf mg">model.save_weights('model_weights.h5')</span><span id="a032" class="mc kz hi ly b fi mh me l mf mg">json_string = model.to_json()</span><span id="6a4c" class="mc kz hi ly b fi mh me l mf mg">f = open("model_architecture.json",'w')</span><span id="2d64" class="mc kz hi ly b fi mh me l mf mg">f.write(json_string)</span><span id="03bd" class="mc kz hi ly b fi mh me l mf mg">f.close()</span></pre><p id="2a5d" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">我们可以使用下面几行代码加载并使用保存的模型:</p><pre class="kf kg kh ki fd lx ly lz ma aw mb bi"><span id="0ce5" class="mc kz hi ly b fi md me l mf mg">f = open("model_architecture.json",'r+')</span><span id="9442" class="mc kz hi ly b fi mh me l mf mg">json_string = f.read()</span><span id="8f5f" class="mc kz hi ly b fi mh me l mf mg">f.close()</span><span id="b67f" class="mc kz hi ly b fi mh me l mf mg">model = model_from_json(json_string)</span><span id="5c1f" class="mc kz hi ly b fi mh me l mf mg">model.load_weights('model_weights.h5')</span><span id="7f48" class="mc kz hi ly b fi mh me l mf mg">model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])</span></pre><p id="d34d" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">现在，我们将创建一个python后端文件，在部署期间与flask一起运行。</p><p id="ac28" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">我们将创建一个名为predict的函数，它将从网页中获取输入，并在网页上再次显示其输出。在函数中，我们将使用先前保存的文件构建训练好的模型，并对其进行编译。然后将我们的输入转换成我们的模型接受的形式，然后预测情绪。</p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div></figure></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="67d6" class="ky kz hi bd la lb mi ld le lf mj lh li io mk ip lk ir ml is lm iu mm iv lo lp bi translated">将模型转化为Web应用程序</h1><p id="dffb" class="pw-post-body-paragraph ja jb hi jd b je lq ij jg jh lr im jj kv ls jm jn kw lt jq jr kx lu ju jv jw hb bi translated">在前一节中已经准备好了模型 的代码，我们将开发一个web应用程序，它由一个简单的web页面和一个允许我们输入消息的表单字段组成。在将消息提交给web应用程序后，它将在一个新页面上呈现它，这给我们一个垃圾邮件或非垃圾邮件的结果。</p><p id="fff7" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">首先，我们使用以下命令安装依赖项，即“flask ”:</p><pre class="kf kg kh ki fd lx ly lz ma aw mb bi"><span id="2781" class="mc kz hi ly b fi md me l mf mg">pip install Flask</span></pre><p id="8804" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">一旦我们安装了Flask，我们就创建了一个文件夹；在本例中，我们将其命名为IMDB Classifier，这是文件夹中的目录树。我们将一边进行一边解释每个基本文件。</p><pre class="kf kg kh ki fd lx ly lz ma aw mb bi"><span id="c71a" class="mc kz hi ly b fi md me l mf mg">app.py<br/>imdb_classifer.py<br/>model_architecture.json<br/>model_weights.h5<br/>templates/<br/>        home.html<br/>        layout.html<br/>        code.html<br/>        outputs/<br/>                Positive.html<br/>                Negative.html<br/>        includes/<br/>                _form.html<br/>                _navbar.html<br/>static/<br/>        css/<br/>                style.css<br/>                pic1.jpg<br/>        pic/<br/>                logow.png</span></pre><h2 id="2349" class="mc kz hi bd la mn mo mp le mq mr ms li kv mt mu lk kw mv mw lm kx mx my lo mz bi translated">app.py</h2><p id="d784" class="pw-post-body-paragraph ja jb hi jd b je lq ij jg jh lr im jj kv ls jm jn kw lt jq jr kx lu ju jv jw hb bi translated">现在，我们需要创建一个基本的python文件(<code class="du na nb nc ly b">app.py</code>)，其中包含将由Python解释器执行以运行Flask web应用程序的主要代码:</p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">app.py</figcaption></figure><p id="fc40" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">注意，我们需要导入python文件并调用我们需要在后端运行的run函数。这段代码接受表单中的输入，然后将用户重定向到相应的输出页面。</p><p id="e442" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated"><strong class="jd hj">layout.html</strong></p><p id="9483" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">一旦基本的python文件准备好了，我们需要制作HTML网页。我们使用一个<code class="du na nb nc ly b">layout.html</code>文件，这样我们就不必一遍又一遍地重复代码的相同部分:</p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">layout.html</figcaption></figure><p id="10a1" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated"><strong class="jd hj">home.html</strong></p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">home.html</figcaption></figure><p id="a5ec" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated"><strong class="jd hj">code.html</strong></p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">code.html</figcaption></figure><p id="0921" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated"><strong class="jd hj"> style.css </strong></p><p id="76aa" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">在layout.html的头段，我们加载了<code class="du na nb nc ly b">style.css</code>一个文件。CSS决定了HTML文档的外观和感觉。<code class="du na nb nc ly b">style.css</code>必须保存在一个名为static的子目录中，这是默认目录，Flask在其中查找静态文件，如CSS:</p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">style.css</figcaption></figure><p id="2c26" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">“包含”文件用于向网页添加额外的元素，如导航栏。它们是在其他网页中调用的部分代码:</p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">_navbar.html</figcaption></figure><p id="0328" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">输出文件是根据python代码的输出调用的文件。这里我们使用两个输出文件，一个用于“正”，另一个用于“负”:</p><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">Positive.html</figcaption></figure><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">Negative.html</figcaption></figure><p id="2b3c" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">嗯，这是一个很大的代码，但我们几乎在那里！我们已经创建了所有需要的文件，现在让我们测试它。</p><p id="a3c9" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">完成以上所有操作后，您可以通过双击<code class="du na nb nc ly b">app.py</code>或从终端执行命令来开始运行API:</p><pre class="kf kg kh ki fd lx ly lz ma aw mb bi"><span id="bc11" class="mc kz hi ly b fi md me l mf mg">cd IMDB Classifier<br/>python app.py</span></pre><p id="118f" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">您应该得到以下输出:</p><pre class="kf kg kh ki fd lx ly lz ma aw mb bi"><span id="7961" class="mc kz hi ly b fi md me l mf mg">Using TensorFlow backend.<br/> * Serving Flask app "app" (lazy loading)<br/> * Environment: production<br/> * Debug mode: on<br/> * Running on <a class="ae ku" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:5000/</a> (Press CTRL+C to quit)</span></pre><p id="917a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">现在，您可以打开网络浏览器并导航至<a class="ae ku" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>。我们应该看到一个简单的网站，内容如下:</p><div class="kf kg kh ki fd ab cb"><figure class="nd kj ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/476e5ee75b29af611bdd0e0f54c0fde2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*gjD9rbtxvpKqRL5YAACMzg.png"/></div></figure><figure class="nd kj ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/2ae1bb79255133602ac6de1294295efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*f0abaqfzeMOMbdlDhDqU-g.png"/></div></figure></div><div class="ab cb"><figure class="nd kj ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/aa5d964bc9a28119e69a01a66283ea08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*DgcApCVUJIDWp34hjsweJQ.png"/></div></figure><figure class="nd kj ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/ba6b3438d51253df5eaf7605261dba65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*xeDVohbb0Pa4GWGF3v7iTw.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx nj di nk nl translated">输出图像</figcaption></figure></div><p id="2985" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">恭喜你！我们现在已经创建了一个基本的交互式GUI，并使用Flask零成本运行深度学习NLP模型。如果你回头看，整个过程一点也不复杂。只要有一点点耐心和学习的欲望，任何人都可以做到。所有的开源工具让一切成为可能。</p><p id="e4b7" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">项目的所有文件都可以在这里找到<a class="ae ku" href="https://drive.google.com/drive/folders/1QlSEIUR-bpGcLDUITV7-kR6fJ44bh_kJ?usp=sharing" rel="noopener ugc nofollow" target="_blank">。祝您愉快！</a></p><p id="bf2b" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated">参考:</p><p id="a69c" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj kv jl jm jn kw jp jq jr kx jt ju jv jw hb bi translated"><a class="ae ku" href="https://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/predict-情操-电影-评论-使用-深度学习/ </a></p><div class="nm nn ez fb no np"><a href="https://towardsdatascience.com/develop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776" rel="noopener follow" target="_blank"><div class="nq ab dw"><div class="nr ab ns cl cj nt"><h2 class="bd hj fi z dy nu ea eb nv ed ef hh bi translated">用Python开发一个NLP模型&amp;用Flask逐步部署它</h2><div class="nw l"><h3 class="bd b fi z dy nu ea eb nv ed ef dx translated">Flask API，文档分类，垃圾邮件过滤器</h3></div><div class="nx l"><p class="bd b fp z dy nu ea eb nv ed ef dx translated">towardsdatascience.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od ko np"/></div></div></a></div></div></div>    
</body>
</html>