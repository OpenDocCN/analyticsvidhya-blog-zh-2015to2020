<html>
<head>
<title>Build a Django RESTful API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个Django RESTful API</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-a-django-restful-api-b7f4633d01bc?source=collection_archive---------14-----------------------#2019-11-10">https://medium.com/analytics-vidhya/build-a-django-restful-api-b7f4633d01bc?source=collection_archive---------14-----------------------#2019-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/dcf8f163b55d69974a06792d05e842c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6oZAheCwiQiKHAHeJDK5w.png"/></div></figure><h1 id="9a7a" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">部分概述</h1><ul class=""><li id="8364" class="jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">设置。</li><li id="d815" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">创建django项目和应用程序。</li><li id="7569" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">模型和数据库。</li><li id="8354" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">对数据的访问。</li><li id="4542" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">结论。</li></ul><p id="875e" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">我们将一起为“待办事项”应用程序构建后端。我们编写并部署一个RESTful API服务。API允许您创建、读取、更新和删除(CRUD)任务。任务存储在数据库中，我们使用Django ORM(对象关系映射)来处理数据库管理。</p><h1 id="4eff" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">第1部分—设置</h1><p id="7b4a" class="pw-post-body-paragraph kh ki hi jm b jn jo kk kl jp jq kn ko jr ky kq kr jt kz kt ku jv la kw kx jx hb bi translated">创建一个Python 3虚拟环境。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="9c12" class="lk in hi lg b fi ll lm l ln lo">$ mkdir todoapp<br/>$ cd todoapp<br/>$ python3 -m venv .venv<br/>$ source .venv/bin/activate</span></pre><p id="7022" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">安装依赖项。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="4dbb" class="lk in hi lg b fi ll lm l ln lo">(.venv)$ pip install djangorestframework django</span></pre><p id="b91f" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">DRF(Django REST框架)是一个创建RESTful CRUD APIs并提供有用特性的框架。</p><h1 id="b24d" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">第2部分—创建Django项目和应用程序</h1><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="9313" class="lk in hi lg b fi ll lm l ln lo">$ django-admin startproject todo_app</span></pre><p id="553f" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">在project中创建应用程序。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="d2c5" class="lk in hi lg b fi ll lm l ln lo">$ cd todo_app<br/>$ django-admin startapp todo</span></pre><p id="86e9" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">让我们将<code class="du lq lr ls lg b">rest_framework</code>和todo添加到项目的<code class="du lq lr ls lg b">settings.py</code>中的<code class="du lq lr ls lg b">INSTALL_APPS</code>列表中。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="633f" class="lk in hi lg b fi ll lm l ln lo">todoapp/todo_app/settings.py</span><span id="006f" class="lk in hi lg b fi lt lm l ln lo">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',<br/>    'rest_framework',<br/>    'todo',<br/>]</span></pre><h1 id="3e0d" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">第3部分—模型和数据库</h1><p id="aade" class="pw-post-body-paragraph kh ki hi jm b jn jo kk kl jp jq kn ko jr ky kq kr jt kz kt ku jv la kw kx jx hb bi translated">默认情况下，Django使用SQLite数据库管理系统。</p><p id="27d8" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated"><code class="du lq lr ls lg b">todo_app/todo/models.py:</code></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="d507" class="lk in hi lg b fi ll lm l ln lo">from django.db import models</span><span id="31ce" class="lk in hi lg b fi lt lm l ln lo">class Task(models.Model):<br/>    STATES = (('todo', 'To Do'), ('in progress', 'In Progress'), ('done', 'Done'))<br/>    title = models.CharField(max_length=255, blank=False, unique=True)<br/>    description = models.TextField()<br/>    status = models.CharField(max_length=4, choices=STATES, default='todo')</span></pre><p id="4cac" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">现在创建数据库迁移脚本，Django用它来更新数据库。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="b063" class="lk in hi lg b fi ll lm l ln lo">python manage.py makemigrations</span></pre><p id="b603" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">然后，您可以将迁移应用到数据库。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="f1d8" class="lk in hi lg b fi ll lm l ln lo">python manage.py migrate</span></pre><h1 id="8f21" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">第4节—数据访问</h1><h2 id="29f8" class="lk in hi bd io lu lv lw is lx ly lz iw jr ma mb ja jt mc md je jv me mf ji mg bi translated">第4.1节—创建序列化程序</h2><p id="dd55" class="pw-post-body-paragraph kh ki hi jm b jn jo kk kl jp jq kn ko jr ky kq kr jt kz kt ku jv la kw kx jx hb bi translated">序列化器用于将JSON或其他内容类型反序列化为模型中定义的数据结构。</p><p id="264a" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">让我们通过在项目<code class="du lq lr ls lg b">todo_app/todo/serializers.py:</code>中创建一个新文件来添加我们的TaskSerializer对象</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="d364" class="lk in hi lg b fi ll lm l ln lo">from rest_framework.serializers import ModelSerializer<br/>from todo.models import Task<br/></span><span id="d5ae" class="lk in hi lg b fi lt lm l ln lo">class TaskSerializer(ModelSerializer):<br/>    class Meta:<br/>        model = Task<br/>        fields = '__all__'</span></pre><p id="47d1" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">我们使用来自DRF的通用ModelSerializer，用对应于我们的任务模型的字段自动创建一个序列化程序。</p><h2 id="3112" class="lk in hi bd io lu lv lw is lx ly lz iw jr ma mb ja jt mc md je jv me mf ji mg bi translated">第4.2节—创建视图</h2><p id="9b50" class="pw-post-body-paragraph kh ki hi jm b jn jo kk kl jp jq kn ko jr ky kq kr jt kz kt ku jv la kw kx jx hb bi translated">ModelViewSet在数据模型上提供了以下操作:列出、检索、创建、更新、部分更新和销毁。</p><p id="ab5f" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">让我们将我们的观点添加到<code class="du lq lr ls lg b">todo_app/todo/views.py</code>:</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="c3d0" class="lk in hi lg b fi ll lm l ln lo">from rest_framework.viewsets import ModelViewSet</span><span id="8d75" class="lk in hi lg b fi lt lm l ln lo">from .models import Task<br/>from .serializers import TaskSerializer</span><span id="0289" class="lk in hi lg b fi lt lm l ln lo">class TaskViewSet(ModelViewSet):<br/>    queryset = Task.objects.all()<br/>    serializer_class = TaskSerializer</span></pre><h2 id="2e86" class="lk in hi bd io lu lv lw is lx ly lz iw jr ma mb ja jt mc md je jv me mf ji mg bi translated">第4.3节—创建路由器</h2><p id="7bee" class="pw-post-body-paragraph kh ki hi jm b jn jo kk kl jp jq kn ko jr ky kq kr jt kz kt ku jv la kw kx jx hb bi translated">DRF <code class="du lq lr ls lg b">DefaultRouter</code>负责将动作映射到HTTP方法和URL。将以下内容添加到<code class="du lq lr ls lg b">todo_app/urls.py:</code></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="7fa8" class="lk in hi lg b fi ll lm l ln lo">from django.conf.urls import include, url<br/>from django.contrib import admin</span><span id="0136" class="lk in hi lg b fi lt lm l ln lo">from rest_framework.routers import DefaultRouter<br/>from todo.views import TaskViewSet</span><span id="a922" class="lk in hi lg b fi lt lm l ln lo">router = DefaultRouter()<br/>router.register(r'todo', TaskViewSet)</span><span id="27c9" class="lk in hi lg b fi lt lm l ln lo">urlpatterns = [<br/>    url(r'admin/', admin.site.urls),<br/>    url(r'^api/', include((router.urls, 'todo'))),<br/>]</span></pre><p id="411a" class="pw-post-body-paragraph kh ki hi jm b jn kj kk kl jp km kn ko jr kp kq kr jt ks kt ku jv kv kw kx jx hb bi translated">我们将所有路由器URL映射到/api端点。DRF负责映射URL和HTTP方法(列表、检索、创建、更新、销毁)。</p><h2 id="bb34" class="lk in hi bd io lu lv lw is lx ly lz iw jr ma mb ja jt mc md je jv me mf ji mg bi translated">第4.4节—运行应用程序</h2><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="a50a" class="lk in hi lg b fi ll lm l ln lo">python manage.py runserver</span></pre><ul class=""><li id="10ed" class="jk jl hi jm b jn kj jp km jr mh jt mi jv mj jx jy jz ka kb bi translated">现在，我们可以通过以下URL访问该应用程序:<code class="du lq lr ls lg b"><a class="ae lp" href="http://127.0.0.1:8000/api/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/api/</a></code></li><li id="1bfd" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">使用以下URL列出或创建任务:<code class="du lq lr ls lg b"><a class="ae lp" href="http://127.0.0.1:8000/api/todo" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/api/todo</a></code></li><li id="f032" class="jk jl hi jm b jn kc jp kd jr ke jt kf jv kg jx jy jz ka kb bi translated">使用此URL更新/删除现有任务:<code class="du lq lr ls lg b"><a class="ae lp" href="http://127.0.0.1:8000/api/todo/1" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/api/todo/1</a></code></li></ul><h1 id="e70b" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">第5节—结论</h1><p id="707e" class="pw-post-body-paragraph kh ki hi jm b jn jo kk kl jp jq kn ko jr ky kq kr jt kz kt ku jv la kw kx jx hb bi translated">在本文中，您已经学习了如何使用Django REST框架创建一个基本的RESTful API。</p></div></div>    
</body>
</html>