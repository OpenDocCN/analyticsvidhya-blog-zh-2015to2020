<html>
<head>
<title>ARIMA Model from Scratch in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中从头开始的ARIMA模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/arima-model-from-scratch-in-python-489e961603ce?source=collection_archive---------2-----------------------#2020-06-18">https://medium.com/analytics-vidhya/arima-model-from-scratch-in-python-489e961603ce?source=collection_archive---------2-----------------------#2020-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="ac27" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在搜索了很多之后，我意识到人们更喜欢直接使用图书馆进行ARIMA和预测。为了更好地理解，我决定用numpy和pandas从头开始写这个东西。如果你也有同感，继续读:)</p><p id="38cf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ARIMA是一种用于时间序列预测的模型。它有三个主要部分:使数据平稳，AR(自回归)和MA(移动平均)。我们将从对数据求差开始，然后使用AR估计数据，对产生的误差使用MA，对数据求差并检查结果。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/5243d81c4bc4546ac9fca4edcee64195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8vw5tlWE_5IZJjeI"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">凯西·霍纳在<a class="ae ka" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="91ce" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">以下文章包含的内容:</strong>模型的代码和每个步骤的解释。</p><p id="57a2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae ka" href="https://github.com/jinit24/ARIMA-Model/" rel="noopener ugc nofollow" target="_blank">链接获取代码和数据集。</a></p><p id="ab33" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你可以从上面的链接下载数据集。该数据集包含日常银行交易的详细信息。我们将按月对金额进行分组，并开始分析。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kb kc l"/></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kd"><img src="../Images/5e8584eb8d7ced832395ffea6888aada.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*IaC2ZNjxiWvV-919UPzBig.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">每月交易总额</figcaption></figure><p id="63a1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以清楚地看到，价值(趋势)具有递增性和季节性。从总趋势的增加或减少可以看出年复一年地重复自己。比如每年5月到6月都有大幅增长。</p><p id="a26b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第1部分:使数据稳定</strong></p><p id="f4f7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了使数据稳定，存在许多转换。我在这里使用了对数和差分。减去前一个值并没有使它稳定，因为它有季节性趋势。因此，我将数据移动了12，然后再次减去它。例如，对于1998年6月，我们将减去1998年5月的值和1997年6月的值。你可以尝试不同的组合，以确保你得到想要的结果。我使用ADF测试来确保数据是稳定的。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="5b6e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二部分:自回归模型</strong></p><p id="5b45" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于时间t的值，我们假设它线性依赖于先前的p个滞后值，并且存在与之相关的误差项。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ke"><img src="../Images/e4c703ac06181e3e138e7dc9cc6e477d.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*WdjvvqnWHLG2hqGEGROkzA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">阿肯色州</figcaption></figure><p id="9812" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它类似于线性回归，其中X是p滞后值，y是时间t时的值。这里可以使用ACF和PACF图选择顺序<strong class="io hj"> p </strong>，或者如果您有足够的数据，只需将其视为超参数。我不会进入选择p值的细节。在这里，我将数据集分为80%–20%的训练和测试数据集。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="e22a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第三部分:移动平均线</strong></p><p id="bae3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们已经生成了系数和截距，我们可以得到我们的预测。实际值和预测值之间的误差差将形成我们的残差。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="fd91" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">类似于p，这里用q来表示滞后观测值的数量。同样，也可以认为是线性回归，q滞后误差为X，误差为y。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="1dee" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们现在把AR和MA两个模型结合起来得到我们的预测</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kf"><img src="../Images/61da3a593d3471cc9e731fc3a5aaa983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0cyEcrGfG2fXqKOY.png"/></div></div></figure><p id="df5a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第4部分:对数据进行去差分</strong></p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kb kc l"/></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kg"><img src="../Images/d51a1d6b8f025f14aefd9fb2e7748788.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*b1OvlNxVHXj_yIY8UIpsaA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">最终预测</figcaption></figure><p id="9c97" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以，这就对了。如果你发现任何错误，请让我知道。完整的代码，请使用上面的链接。如果你的纯粹主义者不满意，你也可以自己实现线性回归。</p></div></div>    
</body>
</html>