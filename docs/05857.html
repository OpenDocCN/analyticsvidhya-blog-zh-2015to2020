<html>
<head>
<title>Django Rest Framework — Views, Generic Views &amp; ViewSets Simplified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django Rest框架——简化的视图、通用视图和视图集</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/django-rest-framework-views-generic-views-viewsets-simplified-ff997ea3205f?source=collection_archive---------4-----------------------#2020-05-04">https://medium.com/analytics-vidhya/django-rest-framework-views-generic-views-viewsets-simplified-ff997ea3205f?source=collection_archive---------4-----------------------#2020-05-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e3ada1098288c2889a338efdea280c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uYohS0TApEgTXoPH"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Django REST框架</figcaption></figure><h1 id="cbf8" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">介绍</h1><p id="3606" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">如果您是从DRF (Django REST框架)开始的，那么掌握视图、通用视图和视图集的概念以及所有可能使用和滥用它们的不同方式可能会有点难。本教程是为DRF的初学者编写的，帮助他们浏览视图的一般概念，并详细介绍每个视图的一些潜在用例。</p><p id="81bf" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">整篇文章分为3个部分— <strong class="ju hj">概念</strong>(概述)<strong class="ju hj">实现</strong>(代码)&amp; <strong class="ju hj">结论</strong>(参考)，这些不必按顺序阅读。你可以直接跳到任何一个看起来对你有用的章节，从那里继续！建议对REST APIs和Django视图&amp; url配置有一个基本的了解。</p><p id="9293" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><em class="kv">免责声明:我并不自称是Django的专家。这个指南基本上是一些帮助我构建更好的API的概念，我希望它在某些方面对你也有用。</em></p></div><div class="ab cl kw kx gp ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hb hc hd he hf"><h1 id="87a9" class="iu iv hi bd iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn lh jp jq jr bi translated">概念</h1><h2 id="72d4" class="li iv hi bd iw lj lk ll ja lm ln lo je kd lp lq ji kh lr ls jm kl lt lu jq lv bi translated">视图</h2><p id="588c" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这些是最基本的请求处理形式:</p><ul class=""><li id="b066" class="lw lx hi ju b jv kq jz kr kd ly kh lz kl ma kp mb mc md me bi translated">基于类的视图—继承了<code class="du mf mg mh mi b">APIView</code>类</li><li id="fd28" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated">基于函数的视图——使用<code class="du mf mg mh mi b">@api_view</code>装饰器</li></ul><p id="ec34" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这两种视图都有不同的方式来指定它们将如何执行某些任务，如身份验证、处理请求(例如<code class="du mf mg mh mi b">get</code>、<code class="du mf mg mh mi b">post</code>)、检查权限，但它们都可以处理视图的大多数用例。这里的缺点是你需要更多的代码。</p><h2 id="52c1" class="li iv hi bd iw lj lk ll ja lm ln lo je kd lp lq ji kh lr ls jm kl lt lu jq lv bi translated">通用视图</h2><blockquote class="mo mp mq"><p id="5425" class="js jt kv ju b jv kq jx jy jz kr kb kc mr ks kf kg ms kt kj kk mt ku kn ko kp hb bi translated">Django的通用视图……是作为通用使用模式的捷径开发的……它们采用了视图开发中的某些通用习惯用法和模式，并对它们进行了抽象，这样您就可以快速编写数据的通用视图，而无需重复。</p></blockquote><p id="6628" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这直接来自Django文档，我认为这是一个很好的解释了通用视图！这里的主要目标是避免编写常见的用例(例如，列表、删除、更新资源)，而是使用类和混合，这让您可以继承这些开箱即用的功能。你只需要设置一些职业属性——<code class="du mf mg mh mi b">queryset</code>，<code class="du mf mg mh mi b">serializer_class</code>——来定义你想要的资源，然后你就可以开始了！</p><h2 id="7a6d" class="li iv hi bd iw lj lk ll ja lm ln lo je kd lp lq ji kh lr ls jm kl lt lu jq lv bi translated">视图集</h2><p id="cfb9" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated"><code class="du mf mg mh mi b">ViewSet</code>与<code class="du mf mg mh mi b">Router</code>结合使用，主要目的是制作一套一致的URL配置，并确保<a class="ae mu" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" rel="noopener ugc nofollow" target="_blank">不会影响</a>。这基本上给了你一组动作，如<code class="du mf mg mh mi b">list</code>、<code class="du mf mg mh mi b">update</code>，而不是处理程序，如<code class="du mf mg mh mi b">get</code>、<code class="du mf mg mh mi b">post</code>，<code class="du mf mg mh mi b">Router</code>自动为所有动作创建URL。你可以自己定义这些动作(<code class="du mf mg mh mi b">GenericViewSet</code>)或者使用一些现成的东西来实现普通的读&amp;写动作(<code class="du mf mg mh mi b">ModelViewSet</code>)。</p></div><div class="ab cl kw kx gp ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hb hc hd he hf"><h1 id="e93b" class="iu iv hi bd iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn lh jp jq jr bi translated">履行</h1><p id="37d7" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">考虑以下模型</p><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="16dd" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">和相应的序列化程序(由请求/响应用作中介来读取/写入数据库中的数据)</p><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><h2 id="d4fb" class="li iv hi bd iw lj lk ll ja lm ln lo je kd lp lq ji kh lr ls jm kl lt lu jq lv bi translated">现在让我们来看看风景吧！</h2><p id="45a1" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">基本视图类和函数定义如下</p><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><h2 id="6107" class="li iv hi bd iw lj lk ll ja lm ln lo je kd lp lq ji kh lr ls jm kl lt lu jq lv bi translated">现在用更少的代码做同样的事情(使用通用视图)！</h2><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="19b1" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">就是这样！</p><p id="7937" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">一些带有示例的常见用例(考虑一组资源—书籍):</p><ul class=""><li id="808c" class="lw lx hi ju b jv kq jz kr kd ly kh lz kl ma kp mb mc md me bi translated">(GET /books/)-列出一些/所有书籍的信息</li><li id="11db" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated"><code class="du mf mg mh mi b">create</code> (POST /books/) -添加一本新书的信息</li><li id="967a" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated"><code class="du mf mg mh mi b">retrieve</code> (GET /books/{pk}) -获取关于某本书的信息</li><li id="1986" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated"><code class="du mf mg mh mi b">update </code> (PUT /books/{pk}) -更新某本书的信息</li><li id="09e1" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated"><code class="du mf mg mh mi b">partial_update</code> (PATCH /books/{pk}) -更新关于特定图书的信息(不验证所有字段)</li><li id="97c5" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated"><code class="du mf mg mh mi b">destroy</code> (DELETE /books/{pk}) -删除某本书的信息</li></ul><p id="f68a" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">从上面的例子来看，<code class="du mf mg mh mi b">ListCreateAPIView</code>通过简单地继承<code class="du mf mg mh mi b">ListModelMixin</code> &amp; <code class="du mf mg mh mi b">CreateModelMixin</code>将两个功能<code class="du mf mg mh mi b">list</code> &amp; <code class="du mf mg mh mi b">create</code>结合在一起。所有通用视图都继承自<code class="du mf mg mh mi b">GenericAPIView</code>。</p><p id="0565" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">所有这些功能也可以被覆盖:</p><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><h1 id="b38d" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">现在添加更多的功能(引入视图集)！</h1><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="984e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这就产生了上面提到的所有6种常见的读写操作！</p><p id="08df" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">一次为<code class="du mf mg mh mi b">ViewSet</code>注册所有URL配置的简单方法是使用一个<code class="du mf mg mh mi b">Router</code>:</p><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="4bc6" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">您也可以添加其他操作:</p><figure class="mv mw mx my fd ij"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="e35d" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这将打开一个允许附加功能的<code class="du mf mg mh mi b">person/{pk}/some_action/</code>端点。</p></div><div class="ab cl kw kx gp ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hb hc hd he hf"><h1 id="32ad" class="iu iv hi bd iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn lh jp jq jr bi translated">结论</h1><blockquote class="mo mp mq"><p id="585e" class="js jt kv ju b jv kq jx jy jz kr kb kc mr ks kf kg ms kt kj kk mt ku kn ko kp hb bi translated">如果编写一个视图就像建造一把椅子，那么使用<strong class="ju hj"> API视图</strong>就像自己建造椅子的每一个组件，使用<strong class="ju hj">通用视图</strong>就是把已经做好的组件组装成一把椅子，而<strong class="ju hj">视图集</strong>是一个框架，你可以在上面构建以确保你的椅子总是一致的。</p></blockquote><p id="af08" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">根据我的个人经验，我收集到:</p><ul class=""><li id="b5ea" class="lw lx hi ju b jv kq jz kr kd ly kh lz kl ma kp mb mc md me bi translated">创建视图的主要权衡是<em class="kv">速度和可扩展性</em>。您可以使用<strong class="ju hj"> <em class="kv">视图集&amp;路由器</em> </strong>来实现更快更可读的实现，或者使用简单的<strong class="ju hj"> <em class="kv">视图&amp; URL配置</em> </strong>来提供更具可扩展性的手工编码实现。</li><li id="b7aa" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated">一般规则是，如果您开始项目，使用视图集，因为它提供了大量现成的功能，只涉及很少的代码，并开始覆盖方法，以允许更专业的功能。当您的需求扩展时，开始覆盖标准的视图集函数以逐渐满足您的需求。</li><li id="7504" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated">将视图用于非常具体的用例，或者在必要时构建一些快速端点。</li><li id="c5fb" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated">当您需要一些开箱即用的特性，但不想实现视图集提供的所有操作时，请使用通用视图和混合视图</li></ul><p id="7008" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><em class="kv"> **这些并不是您必须遵守的硬性规则，而是一些您可以轻松实施的常见用例的指南。我还想说，官方文档(链接如下)绝对是最好的资源，你应该读一读，以便更深入地理解上面简要解释的概念。</em></p><p id="f703" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">参考文献</strong>:</p><ul class=""><li id="2214" class="lw lx hi ju b jv kq jz kr kd ly kh lz kl ma kp mb mc md me bi translated">经典的Django REST框架 —一个可浏览的参考</li><li id="84e4" class="lw lx hi ju b jv mj jz mk kd ml kh mm kl mn kp mb mc md me bi translated"><a class="ae mu" href="https://www.django-rest-framework.org/api-guide/views/" rel="noopener ugc nofollow" target="_blank">视图</a>、<a class="ae mu" href="https://www.django-rest-framework.org/api-guide/generic-views/" rel="noopener ugc nofollow" target="_blank">通用视图</a>、<a class="ae mu" href="https://www.django-rest-framework.org/api-guide/viewsets/" rel="noopener ugc nofollow" target="_blank">视图集</a>、<a class="ae mu" href="https://www.django-rest-framework.org/api-guide/routers/" rel="noopener ugc nofollow" target="_blank">路由器</a> —官方文档</li></ul><p id="074e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><em class="kv">如果您对本指南有任何疑问，或者有任何其他问题，请随时联系我，电话:</em><strong class="ju hj"><em class="kv">tahmeedtarek@gmail.com</em></strong><em class="kv">。感谢您的宝贵时间！</em></p></div></div>    
</body>
</html>