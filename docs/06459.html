<html>
<head>
<title>Confusion Matrix in a Nutshell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简而言之，混淆矩阵</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-z-of-confusion-matrix-under-5-mins-147c1b4467ab?source=collection_archive---------14-----------------------#2020-05-23">https://medium.com/analytics-vidhya/a-z-of-confusion-matrix-under-5-mins-147c1b4467ab?source=collection_archive---------14-----------------------#2020-05-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/337e8b593e29ac16b5de5a4438c670ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cWkQidw5YnU0Ifl2jkYGVA.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">从迷茫到清晰！(图片来自<a class="ae hv" href="https://pixabay.com/photos/lens-camera-lens-focus-focusing-1209823/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>)</figcaption></figure><div class=""/><p id="72b8" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当一个模型被创建时，为了部署它并基于这个模型做出业务决策，我们需要知道这个模型执行得有多好。这个问题涉及到性能指标。</p><p id="bf92" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个简单的衡量标准是<strong class="ix hz"><em class="jt"/></strong>。准确性就是模型正确预测的点数与性能测量数据集中的总点数之比。</p><p id="f384" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么<strong class="ix hz"> <em class="jt">为什么不准确呢？</em>T9】</strong></p><p id="66e6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">准确性有它自己的缺点。一个这样的缺点是，对于不平衡的数据，当模型预测每个点属于多数类标签时，精度会很高。但是，这个模型并不准确。在现实世界中，数据通常是不平衡的。</p><p id="2530" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们需要另一个能够处理不平衡数据的指标。<strong class="ix hz"> <em class="jt">混淆矩阵</em> </strong>来了。</p><p id="6e8f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">在这篇博客中，我们将讨论混淆矩阵和基于混淆矩阵的各种度量标准；以及如何使用玩具数据集计算这些值。</strong></p><p id="9b10" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">内容:</em></p><ol class=""><li id="c7a9" class="ju jv hy ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated">混淆矩阵</li><li id="564a" class="ju jv hy ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">精确度、召回率、F1分数</li><li id="75fc" class="ju jv hy ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">使用示例计算每个</li><li id="5454" class="ju jv hy ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">使用Python实现计算代码</li></ol></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="a3c2" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">什么是<strong class="ix hz"> <em class="jt">混乱矩阵</em> </strong>？</p><p id="67eb" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">混淆矩阵可用于我们已经知道实际目标变量的数据。这有助于我们可视化模型的性能。</p><blockquote class="kp"><p id="8233" class="kq kr hy bd ks kt ku kv kw kx ky js dx translated">混淆矩阵是特定表格布局中预测结果的总结，其允许对二分类问题(2类)或多分类问题(多于2类)的机器学习模型的性能测量进行可视化</p></blockquote><p id="ce2f" class="pw-post-body-paragraph iv iw hy ix b iy kz ja jb jc la je jf jg lb ji jj jk lc jm jn jo ld jq jr js hb bi translated">让我们使用二进制分类来理解混淆矩阵，比如说，二进制分类的类标签是0(或负)和1(或正)。</p><p id="4725" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">混淆矩阵中的每一列将代表类别标签的实际值，每一行将代表类别标签的预测值。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es le"><img src="../Images/446bddcf72ef8e2462816408ccfd9b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*PvRfdjuqMz9fPe99kVcnhw.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">二元分类问题的混淆矩阵</figcaption></figure><p id="da49" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TP表示<strong class="ix hz">真正</strong>。它可以被解释为模型预测的正类并且是真实的。</p><p id="7fd1" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">FP表示<strong class="ix hz">假阳性</strong>。它可以被解释为模型预测的正类，但它是假的。</p><p id="5a43" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">FN表示<strong class="ix hz">假阴性</strong>。它可以被解释为模型预测的负类，但它是假的。</p><p id="f7ac" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TN表示<strong class="ix hz">真负</strong>。它可以被解释为模型预测的负类并且是真实的。</p><p id="2200" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要记住的一个小技巧是每个单元格(比如TP)的标签是:单元格中的第<em class="jt">项</em>是<em class="jt">预测的类名</em>(就像TP中的P，正数)，单元格中的<em class="jt">第一项</em>是预测的正确性<em class="jt">即真或假(T，真表示TP中的实际和预测的类标签匹配)</em></p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="3203" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">找到混淆矩阵有助于我们找到各种性能指标，如<strong class="ix hz">精确度、召回率和F1分数。</strong></p><p id="af0e" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz"> <em class="jt">精度</em> </strong>是一个度量标准，它告诉我们，在模型预测为阳性的所有点中，有多少实际上是阳性的。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lj"><img src="../Images/3b6d30de74bce1526e2334fe1572bac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*JQBkVs7Fb1hrAofFzwPTXw.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">精度的数学公式</figcaption></figure><p id="bc89" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz"> <em class="jt">回忆</em> </strong>是一个指标，它告诉我们，在数据集中的所有阳性点中，模型正确预测了多少。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lk"><img src="../Images/860d145c1f745656cef046d8a4571196.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*xx2cCm-ydzgpF5mnTp8WYQ.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">回忆的数学公式</figcaption></figure><p id="e2f4" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们想要比较两个模型时，基于精确度和召回率的比较变得复杂。所以我们使用<em class="jt">一个基于精度和召回率的单一分数</em>来代替这些值本身。这个单值就是<strong class="ix hz"> <em class="jt"> F1的分数</em> </strong>。<br/> <strong class="ix hz"> <em class="jt"> F1得分</em> </strong>简单来说就是召回率和精确度的调和平均值。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es ll"><img src="../Images/b540486849a2d80f7694711e97427945.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*BiPHGOd7H3h3Bt8zoumz8w.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">F1分数的数学公式</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="52a6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们以一个<strong class="ix hz">二元类分类问题</strong>为例，计算混淆矩阵、精度、召回率、F1评分。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lm"><img src="../Images/900cdfa3648967d24c8ed28c54c5d01b.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*bvibcWaPdOJU457hCgqIKw.png"/></div></figure><p id="172a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，点的总数是7，类标签为0的点是3，类标签为1的点是4。在7个点中，模型预测3个点为0级，4个点为1级。</p><p id="4011" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们来找TP(真正)。有4个点被预测为1(检查'<em class="jt"> y预测'</em>)，并且在这4个点中，只有2个点实际上属于类别1(检查'<em class="jt"> y' </em>)。所以TP是2。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es ln"><img src="../Images/6fa79effbeba180dca2aec00891b44ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*ma7vmqYBRUS98LG02Q0qxQ.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">插入TP后的混淆矩阵</figcaption></figure><p id="85d4" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">而被分类为类1(检查'<em class="jt"> y预测'</em>)的剩余2个点实际上是类0(检查'<em class="jt"> y' </em>)。因此FP是2。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lo"><img src="../Images/a47caa6e1edf22a92d25beec52e79e5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*sVwWXxfXjqErs9XUhsdD1A.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">插入TP，FP后的混淆矩阵</figcaption></figure><p id="7f93" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于有3个点被分类为0级(检查'<em class="jt"> y预测'</em>)，因此只有1个点实际上属于0级(检查'<em class="jt"> y' </em>)。因此TN是1。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lp"><img src="../Images/59363caf4569fba57dca314a6cd74897.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*BqOjPOH5puUt4JDRS9E03w.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">插入TP，FP，TN后的混淆矩阵</figcaption></figure><p id="9d68" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以及被分类为类0(check ' <em class="jt"> y pred' </em>)但实际上属于类1(check ' <em class="jt"> y' </em>)的剩余2个点。因此FN是2。</p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lq"><img src="../Images/68d035066b0aeba8d6071105a2268805.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*S1zYXwNN2j7S3XohlxgBKA.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">插入TP，FP，TN，FN后的混淆矩阵</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="c376" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，计算<em class="jt">精度，召回，F1分数:</em></p><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lr"><img src="../Images/2c5cd195ea889fd6032b58dc077f4460.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*V6U_-GiwR3y1JKKxdgqORQ.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">计算精度</figcaption></figure><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es ls"><img src="../Images/aee7d43d923dddf1d123fdc0870fd620.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*OlIIEvGIasZT3a1Sc9zu9Q.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">计算召回</figcaption></figure><figure class="lf lg lh li fd hk er es paragraph-image"><div class="er es lt"><img src="../Images/2d2bc4ffaf24e332f87b8a05479b3336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*eWivF-UQYAexmrpjQ-vW-g.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">计算F1分数</figcaption></figure><p id="3a86" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">精确度、召回率、F1分数范围在0和1之间。</p><blockquote class="kp"><p id="e26c" class="kq kr hy bd ks kt ku kv kw kx ky js dx translated">F1分数越高，模型越好。</p></blockquote></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="17e8" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们了解如何使用Python一步完成所有这些，即使是海量数据。</p><pre class="lf lg lh li fd lu lv lw lx aw ly bi"><span id="9868" class="lz ma hy lv b fi mb mc l md me">y_actual = [0,1,0,1,1,0,1]<br/>y_pred =[0,0,1,1,0,1,1]</span></pre><p id="c23b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在列表类型中使用上述数据。</p><p id="cb14" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">实现一个<strong class="ix hz">精确度分数</strong>，</p><pre class="lf lg lh li fd lu lv lw lx aw ly bi"><span id="f535" class="lz ma hy lv b fi mb mc l md me">from sklearn.metrics import accuracy_score<br/>print("Accuracy score ", accuracy_score(y_actual,y_pred))</span></pre><p id="4d1f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:准确度分数0.42857142855</p><p id="bece" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样的，让我们实现<strong class="ix hz">混淆矩阵</strong>，</p><pre class="lf lg lh li fd lu lv lw lx aw ly bi"><span id="b573" class="lz ma hy lv b fi mb mc l md me">from sklearn.metrics import confusion_matrix <br/>print("Confusion matrix ")<br/>confusion_matrix(y_actual,y_pred)</span></pre><p id="b31f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:混淆矩阵<br/>数组([[1，2]，<br/> [2，2]]，dtype=int64)</p><p id="b6b0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，让我们在一行代码中实现计算精度、回忆和f1分数。</p><pre class="lf lg lh li fd lu lv lw lx aw ly bi"><span id="c988" class="lz ma hy lv b fi mb mc l md me">from sklearn.metrics import classification_report<br/>print(classification_report(y_actual,y_pred))</span></pre><p id="4711" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:</p><pre class="lf lg lh li fd lu lv lw lx aw ly bi"><span id="a92c" class="lz ma hy lv b fi mb mc l md me">               precision    recall  f1-score   support<br/><br/>           0       0.33      0.33      0.33         3<br/>           1       0.50      0.50      0.50         4</span></pre><p id="7739" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是的，不管数据大小如何，只要一行代码就可以使用sklearn。感谢<a class="ae hv" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> sckit-learn </a>！</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="f7f6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谢谢你的阅读。以后我会写更多初学者友好的帖子。请在<a class="ae hv" rel="noopener" href="/@ramyavidiyala">媒体</a>上关注我，以便了解他们。我欢迎反馈，可以通过Twitter <a class="ae hv" href="https://twitter.com/ramya_vidiyala" rel="noopener ugc nofollow" target="_blank"> ramya_vidiyala </a>和LinkedIn <a class="ae hv" href="https://www.linkedin.com/in/ramya-vidiyala-308ba6139/" rel="noopener ugc nofollow" target="_blank"> RamyaVidiyala </a>联系我。快乐学习！</p></div></div>    
</body>
</html>