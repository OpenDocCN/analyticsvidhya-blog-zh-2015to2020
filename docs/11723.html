<html>
<head>
<title>Trading Dashboard with Yfinance &amp; Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Yfinance &amp; Pythonçš„äº¤æ˜“ä»ªè¡¨æ¿ã€‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/trading-dashboard-with-yfinance-python-56fa471f881d?source=collection_archive---------0-----------------------#2020-12-16">https://medium.com/analytics-vidhya/trading-dashboard-with-yfinance-python-56fa471f881d?source=collection_archive---------0-----------------------#2020-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d94b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é«˜çº§æŠ€æœ¯çš„åˆçº§ç¼–ç ã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/df960da186c1ac196e279781a01b26f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6pThOJ4VUwBdyS5bJNTCQ.png"/></div></div></figure><p id="64d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç›®å½•:</strong></p><ul class=""><li id="a896" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">ä½¿ç”¨Yfinance Apiæå–æ•°æ®</li><li id="f758" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">è®¾ç½®çŸ­çª—å£å’Œé•¿çª—å£(SMA)</li><li id="9d3f" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">ç”Ÿæˆäº¤æ˜“ä¿¡å·</li><li id="f9e1" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">åœ°å—å…¥å£/å‡ºå£ç‚¹</li><li id="a9ac" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">å›æº¯æµ‹è¯•</li><li id="e34c" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">åˆ†ææŠ•èµ„ç»„åˆæŒ‡æ ‡</li><li id="74ae" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">æœåŠ¡ä»ªè¡¨æ¿</li></ul><h1 id="7220" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">ç®€ä»‹</strong></h1><p id="a143" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å…ˆç†è§£è¿™ç¯‡æ–‡ç« çš„ç›®æ ‡ï¼Œå®ƒæ˜¯ä¸ºæ™®é€šæ•£æˆ·æŠ•èµ„è€…æä¾›ä¸€ç§å¿«é€Ÿç®€å•çš„æ–¹æ³•æ¥è·å–å®æ—¶æ•°æ®ï¼Œä½¿ç”¨è¿™äº›æ•°æ®æ¥çªå‡ºå…³é”®æŒ‡æ ‡ï¼Œå¹¶åœ¨æŠ•èµ„ç‰¹å®šå…¬å¸ä¹‹å‰åˆ›å»ºä¸€ä¸ªæ¸…æ™°æ˜“è¯»çš„è¡¨æ ¼ã€‚</p><p id="0311" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™ä¸ªè¿‡ç¨‹å°†å¸®åŠ©ä½ æ¶ˆé™¤æƒ…ç»ªï¼Œç»™ä½ è¶³å¤Ÿçš„ä¿¡æ¯æ¥åšå‡ºæ˜æ™ºçš„å†³å®šã€‚</p><p id="3f4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">åœ¨ä»£ç å—çš„åº•éƒ¨æ›¿æ¢æ‚¨æƒ³è¦çš„ä»»ä½•è‚¡ç¥¨ä»£ç :</em></p><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="990a" class="lm kf hi li b fi ln lo l lp lq"># Import libraries and dependencies<br/>import numpy as np<br/>import pandas as pd<br/>import hvplot.pandas<br/>from pathlib import Path<br/>import yfinance as yf</span><span id="a38a" class="lm kf hi li b fi lr lo l lp lq">#Cloudflare<br/>net = yf.Ticker(â€œnetâ€)<br/>net</span><span id="6972" class="lm kf hi li b fi lr lo l lp lq"># Set the timeframe you are interested in viewing.</span><span id="501e" class="lm kf hi li b fi lr lo l lp lq">net_historical = net.history(start="2018-01-2", end="2020-12-11", interval="1d")</span><span id="7a55" class="lm kf hi li b fi lr lo l lp lq"># Create a new DataFrame called signals, keeping only the 'Date' &amp; 'Close' columns.</span><span id="481e" class="lm kf hi li b fi lr lo l lp lq">signals_df = net_historical.drop(columns=['Open', 'High', 'Low', 'Volume','Dividends', 'Stock Splits'])<br/></span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ls"><img src="../Images/c0ca5d00965e4e0adb71846d03f00a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnbS2X9TI-hxAskezJ2Azw.png"/></div></div></figure><p id="a4f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç§»åŠ¨å¹³å‡çº¿:</strong></p><p id="07b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦ä¸ºçŸ­çª—å£å’Œé•¿çª—å£åˆ›å»ºåˆ—ï¼Œä¹Ÿç§°ä¸ºç®€å•ç§»åŠ¨å¹³å‡çº¿ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨50å¤©å’Œ100å¤©çš„å¹³å‡å€¼ã€‚</p><p id="cce0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†äº¤æ˜“ä¿¡å·è®¾ç½®ä¸º0æˆ–1ã€‚è¿™å°†å‘Šè¯‰pythonæˆ‘ä»¬åº”è¯¥åœ¨å“ªä¸ªç‚¹ä¹°å…¥æˆ–å–å‡ºå¤´å¯¸ã€‚</p><ul class=""><li id="224b" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated"><em class="jd">è¯·è®°ä½ï¼Œå½“SMA50è¶Šè¿‡SMA100æˆ–é˜»åŠ›ä½æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªçœ‹æ¶¨çš„çªç ´ä¿¡å·ã€‚</em></li></ul><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="db70" class="lm kf hi li b fi ln lo l lp lq"># Set the short window and long windows<br/>short_window = 50<br/>long_window = 100</span><span id="2f09" class="lm kf hi li b fi lr lo l lp lq"># Generate the short and long moving averages (50 and 100 days, respectively)<br/>signals_df['SMA50'] = signals_df['Close'].rolling(window=short_window).mean()<br/>signals_df['SMA100'] = signals_df['Close'].rolling(window=long_window).mean()<br/>signals_df['Signal'] = 0.0</span><span id="5f2d" class="lm kf hi li b fi lr lo l lp lq"># Generate the trading signal 0 or 1,<br/># where 0 is when the SMA50 is under the SMA100, and<br/># where 1 is when the SMA50 is higher (or crosses over) the SMA100<br/>signals_df['Signal'][short_window:] = np.where(<br/>    signals_df['SMA50'][short_window:] &gt; signals_df['SMA100'][short_window:], 1.0, 0.0<br/>)</span><span id="dbbd" class="lm kf hi li b fi lr lo l lp lq"># Calculate the points in time at which a position should be taken, 1 or -1<br/>signals_df['Entry/Exit'] = signals_df['Signal'].diff()</span><span id="5217" class="lm kf hi li b fi lr lo l lp lq"># Print the DataFrame<br/>signals_df.tail(10)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lt"><img src="../Images/c6298f5d1966716fdb22dc3436354982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oHYoaaSzpI4asSonLb61Tg.png"/></div></div></figure><p id="82b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ„å»ºä»ªè¡¨æ¿çš„ç¬¬ä¸‰æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªå›¾è¡¨ï¼Œç”¨ç»¿è‰²å’Œçº¢è‰²çš„ä¿¡å·æ ‡è®°è¡¨ç¤ºè¿›/å‡ºæŒ‡ç¤ºå™¨ã€‚</p><p id="ef33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç”¨HvPlotç»˜åˆ¶ç§»åŠ¨å¹³å‡çº¿:</strong></p><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="3f3e" class="lm kf hi li b fi ln lo l lp lq"># Visualize exit position relative to close price</span><span id="c837" class="lm kf hi li b fi lr lo l lp lq">exit = signals_df[signals_df['Entry/Exit'] == -1.0]['Close'].hvplot.scatter(<br/>    color='red',<br/>    legend=False,<br/>    ylabel='Price in $',<br/>    width=1000,<br/>    height=400<br/>)</span><span id="8212" class="lm kf hi li b fi lr lo l lp lq"># Visualize entry position relative to close price</span><span id="f687" class="lm kf hi li b fi lr lo l lp lq">entry = signals_df[signals_df['Entry/Exit'] == 1.0]['Close'].hvplot.scatter(<br/>    color='green',<br/>    legend=False,<br/>    ylabel='Price in $',<br/>    width=1000,<br/>    height=400<br/>)</span><span id="89fb" class="lm kf hi li b fi lr lo l lp lq"># Visualize close price for the investment</span><span id="49d1" class="lm kf hi li b fi lr lo l lp lq">security_close = signals_df[['Close']].hvplot(<br/>    line_color='lightgray',<br/>    ylabel='Price in $',<br/>    width=1000,<br/>    height=400<br/>)</span><span id="2219" class="lm kf hi li b fi lr lo l lp lq"># Visualize moving averages</span><span id="8e94" class="lm kf hi li b fi lr lo l lp lq">moving_avgs = signals_df[['SMA50', 'SMA100']].hvplot(<br/>    ylabel='Price in $',<br/>    width=1000,<br/>    height=400<br/>)</span><span id="5f6b" class="lm kf hi li b fi lr lo l lp lq"># Overlay plots<br/>entry_exit_plot = security_close * moving_avgs * entry * exit<br/>entry_exit_plot.opts(xaxis=None)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lu"><img src="../Images/3470d42a6faa21fe2f3faaaa41e62174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzbkzNDJh6sRdYDDv78gUg.png"/></div></div></figure><p id="f6cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è®¾å®šèµ„æœ¬çš„åˆå§‹æŠ•èµ„è‚¡ä»½ï¼Œå¹¶è®¾å®šè‚¡ä»½æ•°é‡ã€‚å¯¹äºæœ¬ä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è´­ä¹°500è‚¡Cloudflareã€‚</p><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="33e7" class="lm kf hi li b fi ln lo l lp lq"># Set initial capital<br/>initial_capital = float(100000)</span><span id="86e1" class="lm kf hi li b fi lr lo l lp lq"># Set the share size<br/>share_size = 500</span><span id="b2c0" class="lm kf hi li b fi lr lo l lp lq"># Take a 500 share position where the dual moving average crossover is 1 (SMA50 is greater than SMA100)<br/>signals_df['Position'] = share_size * signals_df['Signal']</span><span id="d6ba" class="lm kf hi li b fi lr lo l lp lq"># Find the points in time where a 500 share position is bought or sold<br/>signals_df['Entry/Exit Position'] = signals_df['Position'].diff()</span><span id="3797" class="lm kf hi li b fi lr lo l lp lq"># Multiply share price by entry/exit positions and get the cumulatively sum<br/>signals_df['Portfolio Holdings'] = signals_df['Close'] * signals_df['Entry/Exit Position'].cumsum()</span><span id="1c72" class="lm kf hi li b fi lr lo l lp lq"># Subtract the initial capital by the portfolio holdings to get the amount of liquid cash in the portfolio<br/>signals_df['Portfolio Cash'] = initial_capital - (signals_df['Close'] * signals_df['Entry/Exit Position']).cumsum()</span><span id="6001" class="lm kf hi li b fi lr lo l lp lq"># Get the total portfolio value by adding the cash amount by the portfolio holdings (or investments)<br/>signals_df['Portfolio Total'] = signals_df['Portfolio Cash'] + signals_df['Portfolio Holdings']</span><span id="0149" class="lm kf hi li b fi lr lo l lp lq"># Calculate the portfolio daily returns<br/>signals_df['Portfolio Daily Returns'] = signals_df['Portfolio Total'].pct_change()</span><span id="ce77" class="lm kf hi li b fi lr lo l lp lq"># Calculate the cumulative returns<br/>signals_df['Portfolio Cumulative Returns'] = (1 + signals_df['Portfolio Daily Returns']).cumprod() - 1</span><span id="cad9" class="lm kf hi li b fi lr lo l lp lq"># Print the DataFrame<br/>signals_df.tail(10)</span></pre><p id="63b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">æƒ³è±¡ç›¸å¯¹äºæˆ‘ä»¬æŠ•èµ„ç»„åˆçš„é€€å‡ºå¤´å¯¸:</strong></p><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="9456" class="lm kf hi li b fi ln lo l lp lq"># Visualize exit position relative to total portfolio value<br/>exit = signals_df[signals_df['Entry/Exit'] == -1.0]['Portfolio Total'].hvplot.scatter(<br/>    color='red',<br/>    legend=False,<br/>    ylabel='Total Portfolio Value',<br/>    width=1000,<br/>    height=400<br/>)</span><span id="33a8" class="lm kf hi li b fi lr lo l lp lq"># Visualize entry position relative to total portfolio value<br/>entry = signals_df[signals_df['Entry/Exit'] == 1.0]['Portfolio Total'].hvplot.scatter(<br/>    color='green',<br/>    legend=False,<br/>    ylabel='Total Portfolio Value',<br/>    width=1000,<br/>    height=400<br/>)</span><span id="58e6" class="lm kf hi li b fi lr lo l lp lq"># Visualize total portoflio value for the investment<br/>total_portfolio_value = signals_df[['Portfolio Total']].hvplot(<br/>    line_color='lightgray',<br/>    ylabel='Total Portfolio Value',<br/>    width=1000,<br/>    height=400<br/>)</span><span id="9e58" class="lm kf hi li b fi lr lo l lp lq"># Overlay plots<br/>portfolio_entry_exit_plot = total_portfolio_value * entry * exit<br/>portfolio_entry_exit_plot.opts(xaxis=None)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/c5c66fbf7c067423e1ced9bad4b47dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A2AvOaC3R0Mb89n_nwTYZA.png"/></div></div></figure><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="f18e" class="lm kf hi li b fi ln lo l lp lq"># Prepare DataFrame for metrics<br/>metrics = [<br/>    'Annual Return',<br/>    'Cumulative Returns',<br/>    'Annual Volatility',<br/>    'Sharpe Ratio',<br/>    'Sortino Ratio']</span><span id="6b6c" class="lm kf hi li b fi lr lo l lp lq">columns = ['Backtest']</span><span id="bbea" class="lm kf hi li b fi lr lo l lp lq"># Initialize the DataFrame with index set to evaluation metrics and column as `Backtest` (just like PyFolio)<br/>portfolio_evaluation_df = pd.DataFrame(index=metrics, columns=columns)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lw"><img src="../Images/38140012fc94324c71a696dd05471eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*radilKYtDB-0jiHWqBovCw.png"/></div></figure><p id="388a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">æ‰§è¡Œå›æº¯æµ‹è¯•:</strong></p><p id="0acf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»ğŸ–ğŸ¼æŒ‡æ ‡ã€‚</p><ul class=""><li id="5cfc" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">1.ç´¯è®¡å›æŠ¥â€” <strong class="ih hj">æ€»æŠ•èµ„çš„å›æŠ¥</strong>ã€‚</li><li id="4f86" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">2.å¹´åº¦å›æŠ¥â€”â€”å½“å¹´æ”¶åˆ°çš„æŠ•èµ„çš„å›æŠ¥ã€‚</li><li id="b39d" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">3.å¹´æ³¢åŠ¨ç‡â€”â€”æ—¥æ³¢åŠ¨ç‡ä¹˜ä»¥252ä¸ªäº¤æ˜“æ—¥çš„å¹³æ–¹æ ¹ã€‚</li><li id="8bbd" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">4.å¤æ™®æ¯”ç‡â€”è¡¡é‡åœ¨è°ƒæ•´é£é™©åï¼ŒæŠ•èµ„ç›¸å¯¹äºæ— é£é™©èµ„äº§çš„è¡¨ç°ã€‚</li><li id="fd55" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">5.sortino ratioâ€”â€”é€šè¿‡ä½¿ç”¨è´ŸæŠ•èµ„ç»„åˆå›æŠ¥çš„èµ„äº§æ ‡å‡†åå·®ã€ä¸‹è¡Œåå·®ï¼Œè€Œä¸æ˜¯æŠ•èµ„ç»„åˆå›æŠ¥çš„æ€»æ ‡å‡†åå·®ï¼Œæ¥åŒºåˆ†æœ‰å®³æ³¢åŠ¨å’Œæ€»æ³¢åŠ¨ã€‚</li></ul><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="fb29" class="lm kf hi li b fi ln lo l lp lq"># Calculate cumulative return<br/>portfolio_evaluation_df.loc['Cumulative Returns'] = signals_df['Portfolio Cumulative Returns'][-1]</span><span id="f54c" class="lm kf hi li b fi lr lo l lp lq"># Calculate annualized return<br/>portfolio_evaluation_df.loc['Annual Return'] = (<br/>    signals_df['Portfolio Daily Returns'].mean() * 252<br/>)</span><span id="8134" class="lm kf hi li b fi lr lo l lp lq"># Calculate annual volatility</span><span id="ea98" class="lm kf hi li b fi lr lo l lp lq">portfolio_evaluation_df.loc['Annual Volatility'] = (<br/>    signals_df['Portfolio Daily Returns'].std() * np.sqrt(252)<br/>)</span><span id="8601" class="lm kf hi li b fi lr lo l lp lq"># Calculate Sharpe Ratio</span><span id="b5a3" class="lm kf hi li b fi lr lo l lp lq">portfolio_evaluation_df.loc['Sharpe Ratio'] = (<br/>    signals_df['Portfolio Daily Returns'].mean() * 252) / (<br/>    signals_df['Portfolio Daily Returns'].std() * np.sqrt(252)<br/>)</span><span id="d5c2" class="lm kf hi li b fi lr lo l lp lq"># Calculate Downside Return</span><span id="9961" class="lm kf hi li b fi lr lo l lp lq">sortino_ratio_df = signals_df[['Portfolio Daily Returns']].copy()<br/>sortino_ratio_df.loc[:,'Downside Returns'] = 0</span><span id="f0ba" class="lm kf hi li b fi lr lo l lp lq">target = 0<br/>mask = sortino_ratio_df['Portfolio Daily Returns'] &lt; target<br/>sortino_ratio_df.loc[mask, 'Downside Returns'] = sortino_ratio_df['Portfolio Daily Returns']**2<br/>portfolio_evaluation_df</span><span id="9dd7" class="lm kf hi li b fi lr lo l lp lq"># Calculate Sortino Ratio</span><span id="4ad9" class="lm kf hi li b fi lr lo l lp lq">down_stdev = np.sqrt(sortino_ratio_df['Downside Returns'].mean()) * np.sqrt(252)<br/>expected_return = sortino_ratio_df['Portfolio Daily Returns'].mean() * 252<br/>sortino_ratio = expected_return/down_stdev</span><span id="f9d4" class="lm kf hi li b fi lr lo l lp lq">portfolio_evaluation_df.loc['Sortino Ratio'] = sortino_ratio<br/>portfolio_evaluation_df.head()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lx"><img src="../Images/ab590a4b4b8db815dd6af877356d4331.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*0eIWGyu76LkILCNX4tb2Wg.png"/></div></figure><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="9865" class="lm kf hi li b fi ln lo l lp lq"># Initialize trade evaluation DataFrame with columns.</span><span id="96b7" class="lm kf hi li b fi lr lo l lp lq">trade_evaluation_df = pd.DataFrame(<br/>    columns=[<br/>        'Stock', <br/>        'Entry Date', <br/>        'Exit Date', <br/>        'Shares', <br/>        'Entry Share Price', <br/>        'Exit Share Price', <br/>        'Entry Portfolio Holding', <br/>        'Exit Portfolio Holding', <br/>        'Profit/Loss']<br/>)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ly"><img src="../Images/fb85b102d9b0f7901ace6559d6d779bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ynYjLLohQIcl_xzs2uLxpg.png"/></div></div></figure><ul class=""><li id="7baa" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">é€šè¿‡æ•°æ®æ¡†æ¶å¾ªç¯ï¼Œå¦‚æœâ€œè¿›åœº/å‡ºåœºâ€äº¤æ˜“ä¸º1ï¼Œè®¾ç½®è¿›åœºäº¤æ˜“æŒ‡æ ‡ã€‚</li><li id="d842" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">å¦‚æœâ€œè¿›åœº/å‡ºåœºâ€ä¸º-1ï¼Œè®¾ç½®å‡ºåœºäº¤æ˜“æŒ‡æ ‡å¹¶è®¡ç®—åˆ©æ¶¦ã€‚</li><li id="459b" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">å°†è®°å½•é™„åŠ åˆ°äº¤æ˜“è¯„ä¼°æ•°æ®æ¡†æ¶ã€‚</li></ul><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="2cd3" class="lm kf hi li b fi ln lo l lp lq"># Initialize iterative variables<br/>entry_date = ''<br/>exit_date = ''<br/>entry_portfolio_holding = 0<br/>exit_portfolio_holding = 0<br/>share_size = 0<br/>entry_share_price = 0<br/>exit_share_price = 0</span><span id="6d24" class="lm kf hi li b fi lr lo l lp lq"><br/>for index, row in signals_df.iterrows():<br/>    if row['Entry/Exit'] == 1:<br/>        entry_date = index<br/>        entry_portfolio_holding = abs(row['Portfolio Holdings'])<br/>        share_size = row['Entry/Exit Position']<br/>        entry_share_price = row['Close']</span><span id="0f8a" class="lm kf hi li b fi lr lo l lp lq">elif row['Entry/Exit'] == -1:<br/>        exit_date = index<br/>        exit_portfolio_holding = abs(row['Close'] * row['Entry/Exit Position'])<br/>        exit_share_price = row['Close']<br/>        profit_loss =  entry_portfolio_holding - exit_portfolio_holding<br/>        trade_evaluation_df = trade_evaluation_df.append(<br/>            {<br/>                'Stock': 'NET',<br/>                'Entry Date': entry_date,<br/>                'Exit Date': exit_date,<br/>                'Shares': share_size,<br/>                'Entry Share Price': entry_share_price,<br/>                'Exit Share Price': exit_share_price,<br/>                'Entry Portfolio Holding': entry_portfolio_holding,<br/>                'Exit Portfolio Holding': exit_portfolio_holding,<br/>                'Profit/Loss': profit_loss<br/>            },<br/>            ignore_index=True)</span></pre><p id="0466" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç»˜å›¾ç»“æœ:</strong></p><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="0763" class="lm kf hi li b fi ln lo l lp lq">price_df = signals_df[['Close', 'SMA50', 'SMA100']]<br/>price_chart = price_df.hvplot.line()<br/>price_chart.opts(title='Cloudflare', xaxis=None)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/fa146c817523a0359de5509e0bcbcf2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zIRBM8MLoDl9gvDVwIRFw.png"/></div></div></figure><p id="c9cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æœ€åä¸€æ­¥:æ‰“å°ä»ªè¡¨æ¿</p><pre class="jf jg jh ji fd lh li lj lk aw ll bi"><span id="6e1a" class="lm kf hi li b fi ln lo l lp lq">portfolio_evaluation_df.reset_index(inplace=True)<br/>portfolio_evaluation_table = portfolio_evaluation_df.hvplot.table()<br/>portfolio_evaluation_table</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ma"><img src="../Images/c4ff2c0c03ecee97ea6943406e3c23cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MQRv8Wx2vDLg9-i78nKWbQ.png"/></div></div></figure><p id="15df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">æ„Ÿè°¢é˜…è¯»ï¼</strong></p><p id="643f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œæ¬¢è¿åœ¨</em> <a class="ae mb" href="https://github.com/scottandersen23/Medium_Blog/tree/main/Articles" rel="noopener ugc nofollow" target="_blank"> <em class="jd"> GitHub </em> </a> <em class="jd">ä¸Šä¸‹è½½æˆ‘çš„ä¸ªäººä»£ç ã€‚ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨scottandersen23@gmail.comç»™æˆ‘å‘é‚®ä»¶ï¼Œåœ¨</em><a class="ae mb" href="https://www.linkedin.com/in/scott-andersen-3208897b/" rel="noopener ugc nofollow" target="_blank"><em class="jd">LinkedIn</em></a><em class="jd">ä¸Šæ‰¾åˆ°æˆ‘ã€‚æœ‰å…´è¶£äº†è§£æ›´å¤šå…³äºæ•°æ®åˆ†æã€æ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ åº”ç”¨çš„ä¿¡æ¯å—ï¼Ÿè·Ÿæˆ‘ä¸Š</em> <a class="ae mb" rel="noopener" href="/@scottandersen23"> <em class="jd">ä¸­</em> </a> <em class="jd">ã€‚</em></p></div></div>    
</body>
</html>