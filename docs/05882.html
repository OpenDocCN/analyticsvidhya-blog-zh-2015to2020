<html>
<head>
<title>Mighty P of Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的强大力量</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mighty-p-of-machine-learning-4a2c44ae8a2?source=collection_archive---------29-----------------------#2020-05-04">https://medium.com/analytics-vidhya/mighty-p-of-machine-learning-4a2c44ae8a2?source=collection_archive---------29-----------------------#2020-05-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fd11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">p值在机器学习中的意义。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/defba37c251470e0445c444013ad6797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oK22FtpIqvCxGpp6"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">弗兰基·查马基在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2ef8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是非常愉快的一天。带着在你的机器学习旅程中学习新东西的目的，你开始学习多元线性回归。但是在你开始之前，你会碰到这个叫做<strong class="ih hj"> p值</strong>的谜。这个术语会让你经历高中数学，甚至在相当长的时间后，你也不会理解它的意思。但这是一个非常重要的概念，涉及到训练你的模型。</p><p id="96ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">几天前我也遇到过同样的情况。但是在看了不同的例子后，我在某种程度上理解了它的意思。让我们通过<strong class="ih hj">著名的抛硬币例子</strong>来了解这个奥秘。</p><h1 id="04c8" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">掷硬币的例子</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/7e22df49925541036de153a8b0970d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Li6C3C7AbbVdRBWZ"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@rupixen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">rupixen.com</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="628c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一天，一个朋友来你家给你表演一个魔术。他带了一枚硬币。在魔术开始之前，你认为硬币是公平的(头和尾都存在)。这就变成了无效假设。</p><p id="7234" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们试图证明零假设是错误的。我们的另一个假设是硬币是不公平的(2个正面或2个反面)。现在你的朋友开始变魔术了。</p><p id="3f8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一次折腾</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/92538aefe06cb7521ef1c375f87299f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*PxP7cFHL0pOUYMN9ttfdtQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">第一次投掷的可能结果</figcaption></figure><p id="8ef6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">他第一次扔硬币，硬币落在头上。这并不是一个令人惊讶的结果，因为如果零假设为真，这种情况发生的概率是50 % (0.5)。</p><p id="30d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二次投掷</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/3d9d88c0f80c95950b33864cbab3cb03.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*eSgds0tnK9QOfBvKi2_gWA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">第二次投掷的可能结果</figcaption></figure><p id="50ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">他第二次扔硬币，它又落到了头上。这种情况仍有相当大的可能性(25 %或0.25%)。到目前为止，我们的零假设是正确的，我们没有疑问。</p><p id="f871" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三次折腾</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/1874440b92509414489aabb720257646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BNYAfN_pgyLY8EPpRhTGjA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">第三次投掷的可能结果</figcaption></figure><p id="475b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是第三次，它落到了头上。你对零假设的信心开始下降，因为如果硬币是公平的，连续3个头的可能性非常低(~12 %或0.12)。你不相信他，因为他是你的朋友</p><p id="bba3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第四次折腾</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/1b106b68e1a7d625d8f4a423a49b3f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*ugrMTIBzNlbqqqVDbHW6ZQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">第四次投掷的可能结果</figcaption></figure><p id="3056" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第四次折腾会让你怀疑你的朋友。这一次，硬币也落在了头上。你开始怀疑硬币可能是魔法商店硬币，因为这种情况发生的可能性很低(~6%或0.0625)。下一次投掷将决定你是否拒绝你的无效假设。</p><p id="5de9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五次投掷</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/631311458523886cd4822a3c54b2581b.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*BXThpA2BC9zFkQZ8qxZHfw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">第五次投掷的可能结果</figcaption></figure><p id="d320" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第五次投掷结果是正面，你现在拒绝了硬币是公平的零假设，因为这种情况发生的可能性非常低(~3%或0.03125)。你决定采用硬币不平衡的另一种假设。结果发现这枚硬币是从一家魔法商店买的。</p><p id="584e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">p值是零假设为真的概率吗？数量</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ky"><img src="../Images/8787e51a59a9fcab1a493e49e34c8790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*QBzIvLhRw4yESlrw6FQXBA.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:推特</figcaption></figure><p id="7dc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它是在假设零假设为真的情况下，通过<strong class="ih hj">得到与之前计算结果相似的结果的概率。即使p值更小，零假设也可能是真的。这取决于你考虑的数据。</strong></p><h1 id="e221" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">p值在机器学习中有什么意义？</strong></h1><p id="4c1b" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">让我们将上述理论应用于一个数据集。考虑一个具有不同独立变量(特征)的数据集，例如小时数、出勤率和学生的性别(0代表男性，1代表女性)。基于这三个特征，我们必须预测输出，即学生获得的分数。</p><p id="4b54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多元线性回归的等式如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es le"><img src="../Images/f4ea47770cbd926b546af422a99d0a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*bwFDlxcFcqXsHZDcjISubQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">多元线性回归方程</figcaption></figure><blockquote class="lf lg lh"><p id="5187" class="if ig li ih b ii ij ik il im in io ip lj ir is it lk iv iw ix ll iz ja jb jc hb bi translated">零假设表示一个假设中的两个变量之间没有显著的关系。</p></blockquote><p id="9bdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们的<strong class="ih hj">无效假设是特征和输出</strong>之间没有关系。这意味着，如果更改特性的值，对输出没有任何影响。然后是我们的<strong class="ih hj">替代假设(在一个或多个特征和输出之间有一些关系)</strong>描述了一个不同于我们的零假设的场景。正如我们在抛硬币问题中所做的那样，我们需要分析不同特征的p值，以便我们可以拒绝或接受零假设。</p><p id="e64f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">p值决定多元线性回归方程中存在的系数的值。根据零假设，特征和输出之间没有关系，这意味着系数将为0。p值将决定这是真是假。</p><p id="4bcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但在此之前，我们需要设置p值的显著性水平。我们用通常的值P = 0.05吧。该值表示任何p值小于0.05的要素都将证明零假设是错误的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/ed53fc030a39385a43e8ace8208e9ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*ug0YH4JkIMFzbc4Ed13fxA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">p值</figcaption></figure><p id="22d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以上数值表示小时数和出勤率的p值低于显著水平(0.05)。但性别的p值大于显著水平(0.05)。这证明了我们的零假设是错误的，并且在特征(小时数和出勤率)和输出(总分)之间存在关系。它还表明，学生的性别遵循零假设(学生的性别和他们的分数之间没有关系(这是真的))。这意味着<strong class="ih hj">小时数和</strong>出勤率的变化会触发<strong class="ih hj">总分(产出)</strong>的显著变化。</p><h1 id="c714" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">如何用python实现这整个过程？</h1><p id="849a" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">有许多可能的方法来执行特征选择。但是<strong class="ih hj"> SciKit-Learn </strong>库提供了一个名为<strong class="ih hj"> LinearRegression </strong>的类。该类自动为您的数据使用最有效的要素选择策略，并相应地拟合您的数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/0f810af487b2fd9ef93e0c7e1529c9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJ8vaiDbqSqCIhOzt3yCZQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">训练多元线性回归模型</figcaption></figure><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="ee72" class="lt jv hi lp b fi lu lv l lw lx">from sklearn.linear_model import LinearRegression</span><span id="3ab1" class="lt jv hi lp b fi ly lv l lw lx">regressor = LinearRegression()</span><span id="aa68" class="lt jv hi lp b fi ly lv l lw lx">regressor.fit(X_train, Y_train)</span></pre><p id="84d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述代码可用于在python中训练多元线性回归模型。这里X_train和Y_train分别是训练集中的特征和输出。</p><p id="483b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">定型模型后，它可用于预测值，如下所示。这里X_test包含测试集的自变量(特征)。模型对X_test的预测存储在Y_pred中。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/e5fe9a808065658e52d50a17b35a09c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNLRg4YJfCWIlIGY3ZGTLg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">预测产量</figcaption></figure><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="4eb3" class="lt jv hi lp b fi lu lv l lw lx">Y_pred = regressor.predict(X_test)</span></pre><p id="7ea4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，线性回归类使用最有效的策略自动执行要素选择。因此，我们不必通过查看它们的p值来手动选择特征。</p><p id="0b69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这个关于p值的解释能对你的机器学习之旅有所帮助。</p></div></div>    
</body>
</html>