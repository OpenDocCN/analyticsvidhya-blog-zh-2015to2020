<html>
<head>
<title>How to deploy Machine Learning and Deep Learning Models in Google App Engine using Flask API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Flask API在Google App Engine中部署机器学习和深度学习模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deployment-ml-and-dl-models-in-google-app-engine-using-flask-api-c4cd40a4c679?source=collection_archive---------9-----------------------#2020-01-28">https://medium.com/analytics-vidhya/deployment-ml-and-dl-models-in-google-app-engine-using-flask-api-c4cd40a4c679?source=collection_archive---------9-----------------------#2020-01-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/44f3ef3a1af8721f9c7dbfdc3f9c97f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VvARYnu8wpmCAscR"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="428a" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj"> <em class="ka">注意:在本文中，我将只展示您的Flask API在Google App Engine中的部署，以了解如何在GCP创建项目和启用计费。您可以前往此</em> </strong> <a class="ae iu" href="https://cloud.google.com/appengine/docs/standard/nodejs/building-app/creating-project" rel="noopener ugc nofollow" target="_blank"> <strong class="je hj"> <em class="ka">文档</em> </strong> </a> <strong class="je hj"> <em class="ka">。</em> </strong></p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="5468" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第一步:去GCP控制台，去任何项目或选择一个现有的项目，你会看到如下图。我选择了<strong class="je hj"> flaskapi </strong>命名项目。</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/cd15ad23ea32e252b966a97826389529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXkWHx8iuI_jmzKjUvshzg.png"/></div></div></figure><p id="63d2" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第二步:现在去导航栏，选择谷歌应用引擎仪表板计算部分。</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/6c7c743753fb17e52e612dd0f19e6f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*El-GEOOPgihsTzx_5dBtyQ.png"/></div></div></figure><p id="bc7a" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第三步:现在，点击<strong class="je hj">云壳</strong>选项。</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/e4b3c89b5240ee57c74686df7c0dbbf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUDlq_mHkXjvMkX5Oc2AEQ.png"/></div></div></figure><p id="36b3" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第四步:点击<strong class="je hj">启动编辑器</strong>选项。</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/a7810123eda65afb43f11e1d528b8b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PppCQdsXgw56iXTr2G5sZQ.png"/></div></div></figure><p id="951d" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们将得到新的标签，看起来像下面的图片。你可以看到四个项目已经是他们的名字0，1，2，3我会上传新的项目。</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/bd2a34d4569f5ebc87a4b95213afc720.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_QRgvwe7xIpSBFCTZQENvw.png"/></div></div></figure><p id="6b33" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">步骤5:现在我们将上传我们已经在本地主机上使用flask API测试过的压缩项目文件夹。请记住，我们必须在项目中创建requirements.txt文件，这样app engine才能安装软件包。 </p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/1ec672c098f92b315c88115b2a41713f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m5rnjiQXteF7GzRba9IsqQ.png"/></div></div></figure><p id="1a57" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第六步:我们将解压<strong class="je hj">云壳中输入以下命令的文件夹。</strong></p><pre class="kc kd ke kf fd kl km kn ko aw kp bi"><span id="3ffe" class="kq kr hi km b fi ks kt l ku kv">unzip &lt;zip file name&gt;</span></pre><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/66a43ad0130b6a7c355294f9c5c40170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hi6MOYNLH2xaJ7wBwz2iWg.png"/></div></div></figure><p id="153a" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们可以在侧边栏看到解压后的文件夹。在这个文件夹中，我已经创建了必要的文件，比如用于预测的<strong class="je hj"> requirements.txt、predictor.py和用于加载模型的load.py。</strong></p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/7f49e555ed85671d868e6e870c33ccd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_MIyYf48FAmsPlG_QPAiw.png"/></div></div></figure><p id="6b08" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第7步:现在我们将创建一个新的文件<a class="ae iu" href="https://cloud.google.com/appengine/docs/standard/python/config/appref" rel="noopener ugc nofollow" target="_blank"><strong class="je hj">app . YAML</strong></a><strong class="je hj"/>，其中保存了我们的<strong class="je hj">main . py</strong>fille<strong class="je hj">。</strong>这个文件帮助我们设置应用引擎的配置，比如我们需要多少内存，我们应该使用哪个版本的python等等。</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/71f491f225765491529f1a75c9d26ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*7RxQDY-qmmgVt0baVzLmpg.png"/></div></figure><p id="ffe7" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">步骤8:现在，对于google app engine标准版本中的基本部署，我们将键入以下命令并保存它。要添加更多配置，你可以去<a class="ae iu" href="https://cloud.google.com/appengine/docs/standard/python3/config/appref" rel="noopener ugc nofollow" target="_blank">谷歌YAML文档</a>。</p><pre class="kc kd ke kf fd kl km kn ko aw kp bi"><span id="cdb6" class="kq kr hi km b fi ks kt l ku kv"># How we launch our file<br/>entrypoint: gunicorn -b :$PORT main:app</span><span id="42c7" class="kq kr hi km b fi kz kt l ku kv"># Which runtime we will used i have used python 3.7<br/>runtime: python37</span><span id="4234" class="kq kr hi km b fi kz kt l ku kv"># These setting are for Deep Learning Models<br/># cpu for our processor<br/># memory_gb for our ram<br/>instance_class: F4<br/>  resources:<br/>  cpu: 2<br/>  memory_gb: 4</span></pre><figure class="kc kd ke kf fd ij er es paragraph-image"><div class="er es la"><img src="../Images/5176a4a38242f71491e2346859dc7479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*M3dmtjq6FFz63WAt-Grutg.png"/></div></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="7a9d" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj"> <em class="ka">注意:如果使用机器学习模型，您可以对实例类、资源、CPU和memory_gb进行注释，因为设置越高，消耗的资金就越多。</em>T3】</strong></p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="3e91" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">步骤10:我们将转到控制台，键入命令来选择要在哪个项目下部署我们的API。</p><pre class="kc kd ke kf fd kl km kn ko aw kp bi"><span id="d18d" class="kq kr hi km b fi ks kt l ku kv"># You can get your project id on your project dashboard.<br/>gcloud config set project [PROJECT ID]</span></pre><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/79b17001599a0dae9dafda3ca393c20f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wB4UYPFX6ec0mNdxxFCb5Q.png"/></div></div></figure><p id="8de9" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我的项目id是<strong class="je hj"> flaskapi-266011 </strong>你的可以不同。</p><p id="7b5d" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第11步:现在从控制台，我们将进入文件夹，并键入以下命令。</p><pre class="kc kd ke kf fd kl km kn ko aw kp bi"><span id="6216" class="kq kr hi km b fi ks kt l ku kv"># app means our app.yaml file <br/># --version [number]<br/>gcloud app deploy --version 1</span></pre><p id="b55c" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">它会告诉我们选择我选择的服务器<strong class="je hj">美国中部。</strong>然后它会向我们展示部署过程，如下图所示。</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/e098399d75c53145f2cb0c0b8786a704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3q7up0MlqmfMIs1LRVhiA.png"/></div></div></figure><p id="0bb1" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们将输入<strong class="je hj"> Y </strong>，我们可以在<strong class="je hj">目标url中看到我们的API。</strong>然后，我们将等待我们的部署流程。</p></div></div>    
</body>
</html>