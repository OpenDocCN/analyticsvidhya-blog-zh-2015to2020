<html>
<head>
<title>Introduction to SQL Using Python: Using JOIN Statements to Merge Multiple Tables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的SQL简介:使用JOIN语句合并多个表</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/introduction-to-sql-using-python-using-join-statements-to-merge-multiple-tables-3b3513fe2c98?source=collection_archive---------2-----------------------#2019-11-10">https://medium.com/analytics-vidhya/introduction-to-sql-using-python-using-join-statements-to-merge-multiple-tables-3b3513fe2c98?source=collection_archive---------2-----------------------#2019-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1aa2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇博客是关于如何从SQL的多个表中提取数据的教程。在我以前的博客教程中，一次只能从一个表中查询数据。本教程将介绍<strong class="ih hj"> JOIN </strong>语句。使用<strong class="ih hj"> JOIN </strong>语句，可以在一个查询中返回多个表中的数据。</p><p id="5fd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本博客将讨论以下内容:</p><ul class=""><li id="1942" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">极限声明</strong></li><li id="2019" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">返回多个没有连接语句的表</strong></li><li id="777e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">连接语句</strong></li><li id="e58e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">使用连接语句返回特定的列</strong></li><li id="8099" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">过滤&amp;多表聚合</strong></li><li id="5b84" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">内部连接</strong></li><li id="dd17" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">左连接</strong></li><li id="4be6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">右连接</strong></li><li id="0162" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">全外连接</strong></li><li id="4aa8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">工会声明</li></ul><p id="1dd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用我以前的教程中使用的数据库，可以在这里下载<a class="ae jr" href="https://www.kaggle.com/laudanum/footballdelphi" rel="noopener ugc nofollow" target="_blank"/>。如果你没有看过我以前的教程，现在是预览足球Delphi数据库中的数据表的好时机。你可以阅读我的前两篇SQL教程，链接如下:</p><ul class=""><li id="c35e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><a class="ae jr" rel="noopener" href="/analytics-vidhya/introduction-to-sql-using-python-filtering-data-with-the-where-statement-80d89688f39e">使用Python的SQL简介:使用WHERE语句过滤数据</a></li><li id="7aeb" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><a class="ae jr" rel="noopener" href="/analytics-vidhya/introduction-to-sql-using-python-computing-statistics-aggregating-data-c2861186b79f">使用Python的SQL简介:计算统计数据&amp;聚合数据</a></li></ul><p id="d5f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将下载必要的库，<strong class="ih hj"> sqlite3 </strong>和<strong class="ih hj"> pandas </strong>。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/2fc1f17459201b6e3ff289a6eb8b0ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fz2Jo-0-wShTCCksIlW_kw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">导入必要的库</figcaption></figure><p id="cca3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您需要连接到数据库并创建一个游标对象。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ki"><img src="../Images/19a9fd870bbbfcc412507c06543fc38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3Gavxd-5oeFPqEBSQW-Fg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">连接到数据库并创建光标对象</figcaption></figure><p id="6c2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是我们在Python中运行SQL查询时将使用的格式。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kj"><img src="../Images/464673849cb23728d1a48e63ec67a162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gu5lDA8QXNE4lUF9-Xt7pQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">Python中SQL查询的格式</figcaption></figure><h1 id="8818" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">极限语句</h1><p id="9baf" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated"><strong class="ih hj"> LIMIT </strong>语句将限制SQL查询中返回的行数。它写在SQL查询的末尾，也是SQL操作顺序中要执行的最后一条语句。要查看如何使用<strong class="ih hj">限制</strong>语句，请预览以下查询:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ln"><img src="../Images/4deed7d90f3fe3fed31162806b3b9ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*djSr0TosifhVVlASxxh2OQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Teams_in_Matches限制10</figcaption></figure><p id="cc51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述查询从<strong class="ih hj"> Teams_in_Matches </strong>表中返回前十行。为了练习使用<strong class="ih hj"> LIMIT </strong>语句，编写一个从<strong class="ih hj"> Unique_Teams </strong>数据集中返回前十行的查询，并将您的查询与下面的查询进行比较:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lo"><img src="../Images/836ef3a93285c7fd9abdbc3ed346f970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHK_QrlQ54X76-AT9kiIXg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Unique_Teams限制10</figcaption></figure><h1 id="8e0b" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">不使用JOIN语句返回多个表</h1><p id="0dbd" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated"><strong class="ih hj"> Teams_in_Matches </strong>数据集有两列，<strong class="ih hj"> Match_ID </strong>和<strong class="ih hj"> Unique_Team_ID </strong>。由于我们不熟悉每个团队的<strong class="ih hj"> Unique_Team_ID </strong>，如果我们能在<strong class="ih hj"> Team_in_Matches </strong>数据表中的列旁边看到团队的名称，将更容易识别每个团队。<strong class="ih hj"> Unique_Teams </strong>数据表有两列，<strong class="ih hj"> Team_Name </strong>和<strong class="ih hj"> Unique_Team_ID </strong>。如果我们一起返回这两个表，我们可以在来自<strong class="ih hj"> Teams_in_Matches </strong>数据集的<strong class="ih hj"> Match_ID </strong>和<strong class="ih hj"> Unique_Team_ID </strong>列旁边看到每个球队的名称。以下查询返回两个表中的数据:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lp"><img src="../Images/3e40678128a4c8cffead2b91799a6d84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4XFYlRZSEMvU6rQJqVEtA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Teams_in_Matches，Unique_Teams</figcaption></figure><p id="d75e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然<strong class="ih hj"> Teams_in_Matches </strong>表只有49，148行，而<strong class="ih hj"> Unique_Teams </strong>表只有128行，但该查询返回了6，290，944行。您可能认为查询最多会返回49，148行。实际情况是，SQL从<strong class="ih hj"> Teams_in_Matches </strong>表中取出每一行，并将其与<strong class="ih hj"> Unique_Teams </strong>表中的每一行进行匹配，因此查询返回49，148 * 128 = 6，290，944行。我们现在返回的数据没有用，而且太大了。如果我们希望SQL返回<strong class="ih hj"> Match_ID </strong>和<strong class="ih hj"> Unique_Team_ID </strong>以及相应的<strong class="ih hj"> Team_Name </strong>，我们必须告诉SQL如何返回结果。由于<strong class="ih hj"> Unique_Team_ID </strong>是两个表中的列名，我们可以使用下面的查询来获得正确的结果:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lq"><img src="../Images/0cfe45b14b14173920d91238cd74f653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2jAOg442GdqdLVq8TdH3w.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Teams_in_Matches，Unique _ Teams WHERE Teams _ in _ Matches。唯一团队ID =唯一团队。唯一团队标识</figcaption></figure><p id="14fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们添加了一个<strong class="ih hj"> WHERE </strong>语句，并告诉SQL <strong class="ih hj">如何/什么列</strong>将两个表<strong class="ih hj"> WHERE Teams_in_Matches连接在一起。唯一团队ID =唯一团队。唯一团队ID </strong>。返回的结果只显示来自<strong class="ih hj"> Teams_in_Matches </strong>表的<strong class="ih hj"> Unique_Team_ID </strong>与来自<strong class="ih hj"> Unique_Teams </strong>数据表的<strong class="ih hj"> Unique_Team_ID </strong>值相匹配的行。当处理多个表时，您必须弄清楚每个列来自哪个表，尤其是当列名同名时。在<strong class="ih hj"> WHERE </strong>语句中，我们写下了表名，后跟一个句点，然后是列名，即<strong class="ih hj"> Teams_in_Matches。唯一团队ID </strong>。</p><h1 id="0cde" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">JOIN语句</h1><p id="e2d5" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">我们将运行刚才使用的相同查询，但是我们将使用一个<strong class="ih hj">连接</strong>语句，而不是使用一个<strong class="ih hj"> WHERE </strong>语句。要了解这一点，请查看下面的查询:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lr"><img src="../Images/2593cfb858c88b43fb2f0260300fec45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OOnwogaRn1nnHD5nfD8RNQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Teams _ in _ Matches JOIN Unique _ Teams ON Teams _ in _ Matches。唯一团队ID =唯一团队。唯一团队标识</figcaption></figure><p id="f052" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们没有列出我们想在<strong class="ih hj"> FROM </strong>语句中使用的表，而是首先列出表<strong class="ih hj"> Teams_in_Matches </strong>，然后添加一个<strong class="ih hj"> JOIN </strong>语句。我们告诉SQL，我们希望将来自<strong class="ih hj"> Teams_in_Matches </strong>表的数据与来自<strong class="ih hj"> Unique_Teams </strong>表的数据连接在一起。我们还包含了一个<strong class="ih hj"> ON </strong>语句，它告诉SQL如何将数据连接在一起。</p><p id="fae4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">团队</strong>表不包括每个团队的<strong class="ih hj"> Unique_Team_ID </strong>。通过编写将<strong class="ih hj"> Unique_Teams </strong>数据表和<strong class="ih hj"> Teams </strong>表连接在一起的查询，练习使用<strong class="ih hj"> JOIN </strong>语句，只返回前10行。将您的查询与下面的查询进行比较:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ls"><img src="../Images/d0d81062dc649c845bda0897d12bcdcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fzsJh8JPjiKUmHY9eewUbQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Unique_Teams加入Unique_Teams上的团队。团队名称=团队。团队名称限制10；</figcaption></figure><h1 id="98bb" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">用JOIN语句返回特定的列</h1><p id="a216" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">如果我们回过头来查看我们将<strong class="ih hj"> Teams_in_Matches </strong>表和<strong class="ih hj"> Unique_Teams </strong>表连接在一起的查询，您会看到<strong class="ih hj"> Unique_Team_ID </strong>列被列出了两次。通过在<strong class="ih hj"> SELECT </strong>语句中指定我们想要返回的列，我们可以消除这种冗余。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lt"><img src="../Images/5adfb6fd4917603f6c299d9f622aecfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qYXctDpbecaK02N971jJLg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">选择比赛中的球队。Match_ID，Teams_in_Matches。唯一团队标识，唯一团队。Teams_in_Matches中的TeamName加入Teams_in_Matches中的Unique_Teams。唯一团队ID =唯一团队。Unique_Team_ID限制5</figcaption></figure><p id="a43e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，因为我们是从多个表中查询数据，所以我们通过在表名后面加上一个句点，然后加上列名(<strong class="ih hj"> Unique_Teams)来指定每个列来自哪个表。团队名称</strong>)。通过编写显示来自<strong class="ih hj"> Unique_Teams </strong>表的<strong class="ih hj"> Unique_Team_ID </strong>和<strong class="ih hj"> TeamName </strong>以及来自<strong class="ih hj"> Teams </strong>表的<strong class="ih hj"> AvgAgeHome </strong>、<strong class="ih hj"> Season </strong>和<strong class="ih hj"> ForeignPlayersHome </strong>的查询，练习在处理多个表时选择特定的列。只返回前五行。将您的查询与下面的查询进行比较:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lu"><img src="../Images/d885e43e69f25b39352b99fa4dd077a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iKFnklKNBGKuXpsWkDOtRg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">选择唯一团队。唯一团队标识，唯一团队。团队名称，团队。AvgAgeHome各队。赛季，团队。来自Unique_Teams的外国玩家加入Unique_Teams的团队。团队名称=团队。团队名称限制5</figcaption></figure><p id="b775" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然在查询多个表时，将表名写在列名之前是一个好习惯，但是只有当存在重复的列名时才需要这样做。以下查询将产生与上述查询相同的结果:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lo"><img src="../Images/fabdbeb79a5cb34ac5d1ef5a2116c2c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cHl_tdaDaFZ_eIC1_-mJMQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT唯一团队标识，唯一团队。TeamName，AvgAgeHome，Season，foreign players home FROM Unique_Teams加入Unique _ Teams上的球队。团队名称=团队。团队名称限制5；</figcaption></figure><h1 id="ad88" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">用多个表过滤和聚集</h1><p id="676c" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">在处理多个表时，我们仍然可以使用我以前的博客中讨论过的相同的过滤方法和聚合方法。在最后一个查询中，我们看到每个赛季都返回拜仁慕尼黑的数据。以下查询按每支球队对数据进行分组，并显示2000赛季后所有赛季中每支球队球员的平均年龄和外籍球员的最大数量。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lv"><img src="../Images/7e6709be5064845ae6a5aef7441aaf76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z73CA2pCKwp09E2AwSBr2g.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT唯一团队标识，唯一团队。TeamName，AVG(AvgAgeHome) AS Average_Age，MAX(Foreign Players home)AS MAX _ Foreign _来自Unique_Teams的玩家加入Unique_Teams的队伍。团队名称=团队。团队名称，其中赛季&gt; 2000，分组依据Unique_Team_ID，Unique_Teams。团队名称限制5；</figcaption></figure><p id="cf8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的查询有点复杂，但最好记住，我以前的博客和这篇博客中讨论的所有技术都可以一起用来创建查询。现在编写一个查询，显示以“y”或“r”结尾的每个团队的最高<strong class="ih hj"> Match_ID </strong>。随着最大<strong class="ih hj">匹配ID </strong>，显示来自<strong class="ih hj">团队匹配表</strong>的<strong class="ih hj">唯一团队ID </strong>和来自<strong class="ih hj">唯一团队表</strong>的<strong class="ih hj">团队名称</strong>。将您的查询与下面的查询进行比较:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lw"><img src="../Images/a3a6053f60d3c696418d1605d0cbeefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nu5woQlHYY5FuwdFx5bZrg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT MAX(Match_ID)，Teams_in_Matches。来自Teams_in_Matches的Unique_Team_ID，TeamName加入Teams_in_Matches上的Unique_Teams。唯一团队ID =唯一团队。unique _ Team _ ID WHERE(Team name LIKE ' % y ')或(Team name LIKE ' % r ')GROUP BY Teams _ in _ Matches。Unique_Team_ID，团队名称；</figcaption></figure><h1 id="e603" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">内部连接</h1><p id="9f4c" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">到目前为止，我们一直使用的<strong class="ih hj">连接</strong>语句也被称为<strong class="ih hj">内部连接</strong>。一个<strong class="ih hj">内部连接</strong>通常是<strong class="ih hj">连接</strong>语句的默认类型。我们之前已经看到了下面的查询，但是这一次，我们没有写<strong class="ih hj">连接</strong>，而是写<strong class="ih hj">内部连接</strong>。两个查询的结果是相同的。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lx"><img src="../Images/479740f5de323de8f3ee5fa5deebe6af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9_oFc9a0Ii4LwG1VPhlVuQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">选择比赛中的球队。Match_ID，Teams_in_Matches。唯一团队标识，唯一团队。Teams_in_Matches内部联接Unique_Teams ON Teams_in_Matches中的TeamName。唯一团队ID =唯一团队。Unique_Team_ID限制5</figcaption></figure><p id="a1e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只要两个指定的列匹配，内部联接就从两个表中取出所有的行。如果一个<strong class="ih hj"> Match_ID </strong>没有被分配一个<strong class="ih hj"> Unique_Team_ID </strong>，那么<strong class="ih hj"> Match_ID </strong>将不会出现在结果中，反之亦然，如果一个<strong class="ih hj"> TeamName </strong>没有被分配一个<strong class="ih hj"> Unique_Team_ID </strong>，那么那个<strong class="ih hj"> TeamName </strong>将不会出现在结果中。</p><h1 id="1209" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">左连接</h1><p id="9aec" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">为了让下一个例子更容易理解，我们将修改<strong class="ih hj"> Unique_Teams </strong>数据表。运行以下查询:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ly"><img src="../Images/339893d370c9c50b70bad0588fa44add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpxF6EB77f5qpqzAOgHe5g.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">从Unique_Teams中删除，其中TeamName如“O%”或TeamName如“F%”</figcaption></figure><p id="cf68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了<strong class="ih hj">内连接</strong>之外，还有各种类型的<strong class="ih hj">连接</strong>。我们现在将讨论<strong class="ih hj">左连接</strong>。一个<strong class="ih hj"> LEFT_JOIN </strong>将返回查询中列出的左表/第一个表中的所有行，以及查询中列出的右表/第二个表中的任何匹配行。如果不匹配，则仍将显示左侧表格中的数据，右侧表格中的数据将显示为<strong class="ih hj"> NaN </strong>。要查看<strong class="ih hj">左连接</strong>是如何工作的，请查看下面的查询:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lz"><img src="../Images/c1a4dcf1c5046497f024bfe09cd68ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iRywKe_C6iBOm8NqCVygtA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT HomeTeam，FTHG作为主场进球，FTAG作为客场进球，FTR作为结果，Unique _ Team _ ID FROM Matches LEFT JOIN Unique _ Teams ON Matches。HomeTeam = Unique_Teams。团队名称限制10</figcaption></figure><p id="9407" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个表<strong class="ih hj">与</strong>匹配，它是左侧的表，因此包含了该表中的所有行。第二个表<strong class="ih hj"> Unique_Team </strong>是右边的表，只有当有匹配的行时，才会包含该表中的数据。例如，在<strong class="ih hj"> Unique_Teams </strong>数据表中没有对应的行，其中<strong class="ih hj"> TeamName </strong>为<strong class="ih hj"> Oberhausen </strong>或<strong class="ih hj">法兰克福FSV </strong>，因此<strong class="ih hj"> Unique_Team_ID </strong>在这些行中显示为<strong class="ih hj"> NaN </strong>。在下一个例子之前运行下面的代码，帮助使<strong class="ih hj">左连接</strong>更容易理解。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ma"><img src="../Images/250858ddc3562c6f890dbcce9e8904d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EKTNQzWnQens14ZLZKGSQA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">从Teams_in_Matches中删除，其中Unique_Team_ID介于EN 20和30之间；</figcaption></figure><p id="094a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了练习使用<strong class="ih hj">左连接</strong>，返回<strong class="ih hj">匹配</strong>表中的所有行，如果比赛中的主队有<strong class="ih hj"> Unique_Team_ID </strong>显示<strong class="ih hj"> Teams_in_Matches </strong>表中的数据。只返回前10行。将您的查询与下面的查询进行比较:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lx"><img src="../Images/917f98938b076cbe3f5359d56606e724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4NLREOXckbbEFbJyTiuWA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Matches LEFT JOIN Teams _ in _ Matches ON Matches。Match_ID = Teams_in_Matches。Match_ID限制10；</figcaption></figure><p id="456d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这次我们看到的是<strong class="ih hj"> Match_ID </strong>为7、8、9的行，第二个<strong class="ih hj"> Match_ID </strong>列和<strong class="ih hj"> Unique_Team_ID </strong>列为<strong class="ih hj"> NaN </strong>。这意味着<strong class="ih hj"> Match_ID </strong>中没有来自<strong class="ih hj"> Teams_in_Matches </strong>数据表的7、8或9行。</p><h1 id="6901" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">右连接</h1><p id="61d3" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">在继续之前，运行以下代码:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mb"><img src="../Images/9de10cd443e90992d66f4a27097adbd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bxQlqDRjdEb35yEya0pODw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">从主队为“H%”或“W%”的比赛中删除；</figcaption></figure><p id="ff1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">右接头</strong>与<strong class="ih hj">左接头</strong>相似。一个<strong class="ih hj">右连接</strong>返回右表/列出的第二个表中的所有行，以及左表/列出的第一个表中的所有匹配行。要了解其工作原理，请查看下面的查询:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mc"><img src="../Images/b9db2f9968a822d5b4923f6d744fabba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ORnxAMcjjqyc7XwOBczglA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT TeamName，Unique_Team_ID，Match_ID，Date，FTHG AS home goals FROM Matches RIGHT JOIN Unique _ Teams ON Unique _ Teams。团队名称=匹配。HomeTeam其中赛季= 2016限制10；</figcaption></figure><p id="bee9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您使用Jupyter Notebook，上面的查询将不会运行，因为目前不支持<strong class="ih hj">右连接</strong>。你可以去<a class="ae jr" href="https://www.w3schools.com/sql/sql_join_right.asp" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/sql/sql_join_right.asp</a>了解更多关于<strong class="ih hj">右合</strong>和练习。上面的查询应该返回来自<strong class="ih hj"> Unique_Teams </strong>表的所有行，并且只返回来自matches表的匹配行。这基本上与<strong class="ih hj">左连接</strong>和<strong class="ih hj">相反，左连接</strong>比<strong class="ih hj">右连接</strong>更常用。</p><h1 id="10f8" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">完全外部连接</h1><p id="21c1" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated"><strong class="ih hj">完全外部连接</strong>返回左表和右表中的所有行，并在匹配时合并这些行。当没有匹配时，它也将返回行。有点像<strong class="ih hj">左连接</strong>和<strong class="ih hj">右连接</strong>的组合。下面的查询应该返回来自<strong class="ih hj"> Matches </strong>表和<strong class="ih hj"> Unique_Teams </strong>表的所有行。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es md"><img src="../Images/aecac016087f3f1604cc7abb2dec7004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqrdKOJhtGpQJ3Ph1ohaVA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT * FROM Matches完全外部联接Unique_Teams ON Unique_Teams。团队名称=匹配。HomeTeam限制10；</figcaption></figure><p id="9bef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你使用Jupyter Notebook，上面的查询将不会运行，但是你可以在这里阅读更多关于<strong class="ih hj">全外连接</strong>，<a class="ae jr" href="https://www.w3schools.com/sql/sql_join_full.asp" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/sql/sql_join_full.asp</a>。</p><p id="61f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图是<strong class="ih hj">内接合</strong>、<strong class="ih hj">左接合</strong>、<strong class="ih hj">右接合</strong>和<strong class="ih hj">全外接合</strong>的直观表示。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es me"><img src="../Images/bc8866ac2a688d22b308da0f59b8e799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ZU-U1xkeXobAKSy_WyWww.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">图片via:<a class="ae jr" href="https://www.w3schools.com/sql/sql_join.asp" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/sql/sql_join.asp</a></figcaption></figure><h1 id="c960" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">工会声明</h1><p id="cd10" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated"><strong class="ih hj"> UNION </strong>语句不是<strong class="ih hj"> JOIN </strong>语句，但它是组合多个表的一种方式。<strong class="ih hj"> UNION </strong>语句组合两个表的结果。这两个表必须具有相同的列数和相同的数据类型。此时，我们已经从<strong class="ih hj"> Matches </strong>数据表中删除了一些团队，并从<strong class="ih hj"> Unique_Teams </strong>表中删除了一些团队。我们可以使用一个<strong class="ih hj"> UNION </strong>语句来获取所有团队的列表。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mf"><img src="../Images/e71f7958fd7711df2faeafd3b8573db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F9dMhmq8mzstlR3gkgHHqQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">SELECT home team FROM Matches UNION SELECT team name FROM Unique _ Teams；</figcaption></figure><p id="8700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以上结果结合了来自<strong class="ih hj">从匹配项中选择主团队</strong>和<strong class="ih hj">从唯一团队中选择团队名称</strong>的两个结果。重复的不包括在内，但是如果你希望包括重复的，你可以写<strong class="ih hj"> UNION ALL </strong>而不是<strong class="ih hj"> UNION </strong>。</p><p id="e362" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您已经到达本教程的结尾。讨论了以下项目:</p><ul class=""><li id="6ac0" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">极限语句</li><li id="74a3" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">不使用JOIN语句返回多个表</li><li id="944d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">JOIN语句</li><li id="766f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">用JOIN语句返回特定的列</li><li id="1ee3" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">用多个表过滤和聚集</li><li id="54cd" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">内部连接</li><li id="d0ac" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">左连接</li><li id="7b83" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">右连接</li><li id="cad4" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">完全外部连接</li><li id="1fbf" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">工会声明</li></ul><p id="b2df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我鼓励你不断练习使用上述方法，以更深入地了解它们是如何工作的。</p></div></div>    
</body>
</html>