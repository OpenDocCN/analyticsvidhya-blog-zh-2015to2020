<html>
<head>
<title>Getting Started with Apache Drill and MongoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache Drill和MongoDB入门</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/getting-started-with-apache-drill-and-mongodb-edb856395c24?source=collection_archive---------7-----------------------#2019-09-23">https://medium.com/analytics-vidhya/getting-started-with-apache-drill-and-mongodb-edb856395c24?source=collection_archive---------7-----------------------#2019-09-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="e0d9" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">原文发布于此:<a class="ae jh" href="https://blog.contactsunny.com/tech/getting-started-with-apache-drill-and-mongodb" rel="noopener ugc nofollow" target="_blank">https://blog . contact sunny . com/tech/getting-started-with-Apache-drill-and-MongoDB</a></p></blockquote><p id="3fec" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">听说过阿帕奇演习的人不多。这是因为Drill迎合了非常特定的用例，它非常适合。但是在使用时，它会对您与数据的交互方式产生重大影响。首先，让我们看看什么是Apache Drill，然后我们如何连接我们的MongoDB数据源来钻取和轻松查询数据。</p><h1 id="4187" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">什么是阿帕奇演习？</h1><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es kj"><img src="../Images/1cfbec7fd14daf6a7e5d1fc9e83c74b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6beeUrjFo9s4GZcOVHGvhw.png"/></div></div></figure><p id="d297" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">根据他们的网站，Apache Drill是“用于Hadoop、NoSQL和云存储的无模式SQL查询引擎”这是不言自明的。所以，Drill是一个查询Hadoop、MongoDB和其他NoSQL数据库的工具。您可以编写对存储在其他数据库中的数据运行的简单SQL查询，并以行列格式获得结果。最棒的是，你甚至可以用它来查询Apache Kafka和AWS S3的数据。</p><p id="1310" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">让我们看看如何连接到MongoDB并查询一些数据。</p><h1 id="ed31" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">下载Apache Drill</h1><p id="c9f1" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it ji kx iw ix jj ky ja jb jk kz je jf jg hb bi translated">要在您的本地机器上测试Apache Drill，您只需要下载压缩文件，提取它，并运行一个shell脚本。你已经准备好了。你可以从<a class="ae jh" href="https://drill.apache.org/download/" rel="noopener ugc nofollow" target="_blank">这里</a>下载阿帕奇演习。</p><h1 id="545a" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">将Apache Drill连接到MongoDB</h1><p id="80f2" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it ji kx iw ix jj ky ja jb jk kz je jf jg hb bi translated">将刚刚下载的文件<em class="ik"> cd </em>解压到<em class="ik"> bin </em>目录，然后运行以下命令来运行嵌入式Drill服务:</p><pre class="kk kl km kn fd la lb lc ld aw le bi"><span id="85fb" class="lf jm hi lb b fi lg lh l li lj">./drill-embedded</span></pre><p id="0011" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">您将得到类似以下内容的提示:</p><pre class="kk kl km kn fd la lb lc ld aw le bi"><span id="ecb9" class="lf jm hi lb b fi lg lh l li lj">apache drill&gt;</span></pre><p id="d8d6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">您现在在本地机器上运行Apache Drill。现在让我们将它连接到本地MongoDB实例。打开你的网络浏览器，进入<a class="ae jh" href="http://localhost:8047/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8047 </a>。这是Apache Drill web UI。从这里，您可以配置存储(连接)、运行SQL查询和更改配置。</p><p id="581b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">现在，前往<em class="ik">存储</em>标签。在这里，你会发现两个列表。左侧的第一个列表包含已启用的存储插件或连接。在右边，你会看到被禁用的插件。你会看到MongoDB在右边，在禁用列表中。启用MongoDB插件，它将被添加到左侧列表中。页面看起来应该是这样的:</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es lk"><img src="../Images/b38e1c18ddf45e37219b130229dd84ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V2_utlxb4HvJcgGQldvM8A.png"/></div></div></figure><p id="d8a9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">如果您没有使用默认端口或者想要连接到远程MongoDB实例，您可以在这里编辑MongoDB连接字符串。启用这个插件后，我们将切换回命令行界面来运行一些示例查询。</p><p id="e6fc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">在我们开始之前，如果您还没有任何样本数据，您可以使用我编写的Java工具轻松生成数千条记录。Github 上这里的代码是<a class="ae jh" href="https://github.com/contactsunny/MongoDB_Sample_Data_Loader" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="3294" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">在Apache Drill shell中运行查询</h1><p id="e9be" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it ji kx iw ix jj ky ja jb jk kz je jf jg hb bi translated">在我们开始使用Drill查询MongoDB之前，让我们看一下我们的样本数据集。我用随机值生成了20，000个文档，这些数据的子集在这里:</p><pre class="kk kl km kn fd la lb lc ld aw le bi"><span id="14a3" class="lf jm hi lb b fi lg lh l li lj">{<br/>   "_id": "5d8860652182cc411d5b0335",<br/>   "string1": "GQRTUGDeWL",<br/>   "string2": "QALDs5gU0BI3pbPJaQB1",<br/>   "double1": 95.15978134497485,<br/>   "double2": 149.3989427846131<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b0336",<br/>   "string1": "o7jpgRBDis",<br/>   "string2": "nUfLFnYrPn3kM2gX7Tpx",<br/>   "double1": 59.50691775921538,<br/>   "double2": 121.2028465590032<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b0337",<br/>   "string1": "tmDNupDis4",<br/>   "string2": "plFBuQFKcjsfOsrYghX5",<br/>   "double1": 72.08319169219718,<br/>   "double2": 353.94233296797006<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b0338",<br/>   "string1": "tb3pmNzjR0",<br/>   "string2": "UxVAnBfl7Ae3Wuk45muy",<br/>   "double1": 6.925084784225322,<br/>   "double2": 422.1762689036945<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b0339",<br/>   "string1": "ZQsKvrKmCD",<br/>   "string2": "FCkhOsXZHIPKWxuVyMEy",<br/>   "double1": 50.42262251682428,<br/>   "double2": 624.9267615790717<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b033a",<br/>   "string1": "qaFGn8Y3JZ",<br/>   "string2": "QGNBG0G5ZGsWqiVUfjeb",<br/>   "double1": 79.24223653522965,<br/>   "double2": 891.9847982687945<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b033b",<br/>   "string1": "6DMhppDzpI",<br/>   "string2": "P5kSHZHv99U6E9YER9q6",<br/>   "double1": 73.49960928692676,<br/>   "double2": 816.4658357031391<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b033c",<br/>   "string1": "uI4Mvq6rG6",<br/>   "string2": "elRK44zAP8BPvnyON78v",<br/>   "double1": 50.182529571564665,<br/>   "double2": 813.6155673555375<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b033d",<br/>   "string1": "NBWDHVoLeJ",<br/>   "string2": "g3bJAEidJJWyT6EeaoEP",<br/>   "double1": 21.82373793200345,<br/>   "double2": 801.8655464012288<br/> },<br/> {<br/>   "_id": "5d8860652182cc411d5b033e",<br/>   "string1": "GVa48x6nzY",<br/>   "string2": "ebhsF5OyxcTq5955Wmuf",<br/>   "double1": 81.42379198684046,<br/>   "double2": 911.1387851805042<br/> }</span></pre><p id="8080" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">如你所见，这些数据毫无意义。</p><p id="8148" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">现在，使用Apache Drill从MongoDB获取相同的数据集就像最基本的SQL查询一样简单:</p><pre class="kk kl km kn fd la lb lc ld aw le bi"><span id="2486" class="lf jm hi lb b fi lg lh l li lj">select * from sampleData;</span></pre><p id="f780" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">但在此之前，我们先来看看其他几个查询。</p><p id="a6f0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">运行以下查询，列出您有权访问的所有数据库。请注意，您不仅限于MongoDB数据库，而是来自当前启用的所有存储插件的数据库。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es ll"><img src="../Images/6f6fd363d9a96d0f9212a097b01f1b74.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*OL6ng7LLHCO28_pIEfOdag.png"/></div></figure><p id="c299" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">我将样本数据加载到“mongo.dill”数据库的集合中。让我们利用这一点:</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es lm"><img src="../Images/8349fed88b328204317188a2c9bfc072.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*UW_BhENVmQLWrLOIAfxpZg.png"/></div></figure><p id="f29e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">现在让我们看看这个数据库中有哪些表:</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es ln"><img src="../Images/84bbb9ba9552020a36b241c7fe40515b.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*TZTHXkFCkNG4wxDgyyz2Cg.png"/></div></figure><p id="af0c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">现在，我们运行<em class="ik">选择</em>查询来列出我们的数据:</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es lo"><img src="../Images/fdc356aa87ca19c5189897383bc862ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iRGrp905jQpAt7asXLfG5g.png"/></div></div></figure><p id="7289" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">差不多就是这样。现在，您可以开始用现有的数据进行更复杂的查询实验。</p></div></div>    
</body>
</html>