<html>
<head>
<title>Build OpenCV from source with CUDA for GPU access on Windows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 CUDA 从源代码构建 OpenCV，以便在 Windows 上访问 GPU</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-opencv-from-source-with-cuda-for-gpu-access-on-windows-5cd0ce2b9b37?source=collection_archive---------0-----------------------#2020-10-04">https://medium.com/analytics-vidhya/build-opencv-from-source-with-cuda-for-gpu-access-on-windows-5cd0ce2b9b37?source=collection_archive---------0-----------------------#2020-10-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2e5da79afcf14fefa99ba1bd423f5fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWYZhSsfa_UxFIGPtD8ZMQ.jpeg"/></div></div></figure><h1 id="b6cc" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="ce70" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Opencv 是计算机视觉中非常有用的库。python 程序员面对 Opencv 模块的一个常见问题是，如果我们用“<strong class="jq hj"> pip </strong>”或“<strong class="jq hj"> conda </strong>”直接安装它，它会使用 CPU 进行推理。Opencv 有深度学习模块“<strong class="jq hj"> DNN </strong>”，默认使用 CPU 进行计算。<br/>具有 GPU 访问功能的 Opencv 将根据 GPU 的能力将性能提高数倍。为了实现这一点，我们必须使用 Nvidia <strong class="jq hj"> GPU </strong>、<strong class="jq hj"> CUDA </strong>和<strong class="jq hj"> cuDNN </strong>编译 Opencv 的源代码，使用的工具包括<strong class="jq hj"> CMake </strong>和<strong class="jq hj"> Visual Studio </strong>，后者使用 c++的 GCC 编译器。<br/>我写这篇博客的主要原因是它耗费了大量的时间来搜索安装，而且我发现没有适合我的文档。在 Linux 机器上安装 Opencv 很容易，但在 Windows 上很难。<br/>用于在 Linux 机器上安装 Opencv:<br/><a class="ae km" href="https://www.pyimagesearch.com/2016/07/11/compiling-opencv-with-cuda-support/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2016/07/11/compilating-Opencv-with-cuda-support/</a><br/>本博客用于在 Windows 机器上从源代码构建 Opencv</p><h2 id="ad71" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">我们实例的规格</h2><p id="b117" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">仅供参考，我正在用一个 Windows AMI 实例在一个<aws-ec2-g4.xlarge>中构建 OpenCV，该实例带有一个容量为 16gb 的特斯拉 T4 GPU 和 4 核 CPU。我从本地 Linux 机器通过 RDP(远程桌面协议)连接访问这个实例。<br/>反正这个博客就是关心一个有好 GPU 的 Windows 机器</aws-ec2-g4.xlarge></p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="f273" class="iq ir hi bd is it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn bi translated">抽象层次的步骤(仅供参考)</h1><p id="c567" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">您可以点击这些子链接直接跳转到该步骤</strong></p><blockquote class="ln lo lp"><p id="a053" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated">1.<a class="ae km" href="#8a14" rel="noopener ugc nofollow">下载并安装 Visual Studio 19 </a> <br/> 2。<a class="ae km" href="#604a" rel="noopener ugc nofollow">下载安装 CMake</a>T5】3。<a class="ae km" href="#8061" rel="noopener ugc nofollow">根据你的 GPU </a> <br/> 4 安装 CUDA 和 cuDNN。<a class="ae km" href="#3860" rel="noopener ugc nofollow">卸载 anaconda，为所有用户安装 python</a><br/>5。<a class="ae km" href="#ba8b" rel="noopener ugc nofollow">从 Github </a> <br/> 6 下载并解压 Opencv-4.4。<a class="ae km" href="#0c44" rel="noopener ugc nofollow">从 Github </a> <br/> 7 下载并解压 Opencv-contrib-4.4。<a class="ae km" href="#d463" rel="noopener ugc nofollow">安装“numpy”，卸载“opencv-python”，“opencv-contrib-python”</a><br/>8。<a class="ae km" href="#fa5d" rel="noopener ugc nofollow">制作一个【构建】文件夹</a>9<br/>。<a class="ae km" href="#30e9" rel="noopener ugc nofollow">对 opencv 的 CMake 文件“opencvdetectpython . CMake”</a><br/>进行修改 10。<a class="ae km" href="#7d83" rel="noopener ugc nofollow">使用 Cmake</a>T29】11 配置 Opencv 和 Opencv-contrib。<a class="ae km" href="#e123" rel="noopener ugc nofollow">用 Visual Studio </a> <br/> 12 构建 Cmake 创建的项目。<a class="ae km" href="#8b43" rel="noopener ugc nofollow">确认安装是否正确</a></p></blockquote></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="a980" class="iq ir hi bd is it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn bi translated">步伐</h1><p id="db35" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">这里的主要思想是从源代码下载 opencv 和 opencv-contrib 包。然后通过 CMake 和 visual studio 在一个名为“build”的文件夹中配置和编译(构建)包。</p><h2 id="8a14" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">1.下载并安装 Visual Studio 19</h2><blockquote class="ln lo lp"><p id="d5d9" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">1.1<em class="hi">。</em> </strong> <em class="hi">下载 Visual Studio 最新社区版，我的情况是 VS19:</em><a class="ae km" href="https://visualstudio.microsoft.com/downloads/" rel="noopener ugc nofollow" target="_blank">【https://visualstudio.microsoft.com/downloads/】</a><em class="hi"><br/></em><strong class="jq hj"><em class="hi">1.2。</em> </strong> <em class="hi">用 C++点击桌面开发，继续默认安装</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/076c8f9133a94159a184cec5c049291e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytR0ThGIY8vuaVa4585zvw.png"/></div></div></figure><h2 id="604a" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">2.下载并安装 CMake(我的版本 3.18.3)</h2><blockquote class="ln lo lp"><p id="e872" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><em class="hi"> 2.1 点击此链接:</em><a class="ae km" href="https://cmake.org/download/" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://cmake.org/download/</em></a></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/38fae61d6801be70fe9ffd8f6d75afaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JETXCdwxg-vl2Y-b8yJ02A.png"/></div></div></figure><h2 id="8061" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">3.根据你的 GPU 安装 CUDA 和 cuDNN</h2><blockquote class="ln lo lp"><p id="0419" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj"> <em class="hi"> 3.1。</em> </strong> <em class="hi">点击我的另一个链接:-</em><a class="ae km" rel="noopener" href="/@ankitkumar60323/installing-cuda-and-cudnn-on-windows-d44b8e9876b5">https://medium . com/@ ankitkumar 60323/installing-cuda-and-cud nn-on-windows-d 44 b 8 e 9876 b5</a><em class="hi"><br/></em><strong class="jq hj"><em class="hi">3.2 .</em> </strong> <em class="hi">按照这个维基百科页面获取你的 gpu 的架构二进制<br/></em><a class="ae km" href="https://en.wikipedia.org/wiki/CUDA" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://en.wikipedia.org/wiki/CUDA</em></a><em class="hi"><br/>在我的例子中架构二进制是 7.5。CUDA 版本为 10.1，cuDNN 版本为 7.6.5。</em></p></blockquote><h2 id="3860" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">4.卸载 Anaconda 并为所有用户安装 python</h2><blockquote class="ln lo lp"><p id="4f59" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated">如果我们不遵循本部分<br/> <strong class="jq hj"> <em class="hi"> 4.1，将会出现路径问题。</em></strong><em class="hi">Goto</em><strong class="jq hj"><em class="hi">安装程序</em> </strong> <em class="hi">并卸载 anaconda 和 python <br/> </em> <strong class="jq hj"> <em class="hi"> 4.2。</em> </strong> <em class="hi">检查</em> <strong class="jq hj"> <em class="hi">系统环境变量</em> </strong> <em class="hi">并移除蟒蛇和蟒蛇形成的路径</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/bf2e125dd85b06e62e2dba9bdaed6bed.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*LcvoerF1GOvWwL32TasSsg.png"/></div></figure><blockquote class="ln lo lp"><p id="ba93" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">4.3<em class="hi">。</em> </strong> <em class="hi">现在安装 python 并使用所有用户权限继续“自定义安装”</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/7e35191c5fb8fb5dde086f2bc0aa9ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*rmtxDfuH2T1B4NkBMeHWRQ.png"/></div></figure><blockquote class="ln lo lp"><p id="2766" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">4.4<em class="hi">。</em> </strong> <em class="hi">在命令提示符下检查是否检测到“python ”,如果没有，则在“系统环境变量”中给出 python 可执行文件的路径</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/4b724665e1eb69e5089e18a01530d8ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4xPnOkebiTWcy2sM8BsCg.png"/></div></div></figure><h2 id="ba8b" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">5.从 Github 下载并解压 Opencv-4.4</h2><blockquote class="ln lo lp"><p id="a45a" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated">这是 opencv 代码所在的源代码<br/> <strong class="jq hj"> <em class="hi"> 5.1。</em> </strong> <em class="hi">跟着这个链接:-</em><a class="ae km" href="https://opencv.org/releases/" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://opencv.org/releases/</em></a></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/de1fad9a658b0776fbf4b4dabe4afaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jszFGNgydq0jac3jc3oAFw.png"/></div></div></figure><blockquote class="ln lo lp"><p id="145e" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">5.2<em class="hi">。</em> </strong> <em class="hi">点击来源<br/> </em> <strong class="jq hj"> <em class="hi"> 5.3。</em> </strong> <em class="hi">解压下载的文件夹</em></p></blockquote><h2 id="0c44" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">6.从 github 下载并解压 Opencv-contrib-4.4</h2><blockquote class="ln lo lp"><p id="94e4" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><em class="hi">这是与 opencv <br/> </em> <strong class="jq hj"> <em class="hi"> 6.1 一起使用的额外模块包。</em> </strong> <em class="hi"> Goto 链接</em><a class="ae km" href="https://github.com/opencv/opencv_contrib/tree/4.4.0" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://github.com/opencv/opencv_contrib/tree/4.4.0</em></a><em class="hi">并下载 zip <br/> </em> <strong class="jq hj"> <em class="hi"> 6.2。</em> </strong> <em class="hi">提取下载的文件夹</em></p></blockquote><h2 id="d463" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">7.安装 numpy，卸载 opencv-python，opencv-contrib-python</h2><blockquote class="ln lo lp"><p id="8279" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated">在编译之前，确保安装了“numpy”。确保“opencv-python”和“opencv-contrib-python”被卸载，并且 <strong class="jq hj"> <em class="hi">将永远不会在此环境中使用“pip”再次安装<br/></em></strong><em class="hi"/><strong class="jq hj"><em class="hi">7.1。</em> </strong> <em class="hi"> pip 安装编号<br/> </em> <strong class="jq hj"> <em class="hi"> 7.2。</em> </strong> <em class="hi"> pip 卸载 opencv-python opencv-contrib-python<br/></em><strong class="jq hj"><em class="hi">7.3。</em> </strong> <em class="hi">在我的例子中，cmake 需要这些 python 路径:</em></p></blockquote><pre class="ma mb mc md fd mj mk ml mm aw mn bi"><span id="aad1" class="kn ir hi mk b fi mo mp l mq mr">PYTHON3_EXECUTABLE= C:/program files/python38/python.exe<br/>PYTHON3_INCLUDE_DIR= C:/program files/python38/include<br/>PYTHON3_LIBRARY= C:/program files/python38/libs/python38.lib<br/>PYTHON3_NUMPY_INCLUDE_DIRS= C:/program files/python38/Lib/site-packages/numpy/core/include<br/>PYTHON3_PACKAGES_PATH= C:/program files/python38/Lib/site-packages</span></pre><h2 id="fa5d" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">8.创建一个“构建”文件夹</h2><blockquote class="ln lo lp"><p id="1af1" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><em class="hi">这是我们将编译并保存目标代码<br/> </em> <strong class="jq hj"> <em class="hi"> 8.1 的文件夹。我们需要创建编译 Opencv 的文件夹</em></strong></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/6f6385a8f68e575035c4057495b89bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5g0KGs0-ZC3S-0Y-4LlpDQ.png"/></div></div></figure><h2 id="30e9" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">9.在 opencv 的 cmake 文件“OpenCVDetectPython.cmake”中进行更改</h2><blockquote class="ln lo lp"><p id="0553" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated">当我们用 cmake 构建时，默认情况下它会搜索 python2。我们需要更改代码，使其在默认情况下检测 python3，并在名为“opencv-4 . 4 . 0”<br/><strong class="jq hj"><em class="hi">9.1 的解压缩文件夹中使用 python2 作为后备<br/>。</em> </strong> <em class="hi">打开文件【opencv-4 . 4 . 0 \ opencv-4 . 4 . 0 \ cmake \ opencvdetectpython . cmake】<br/></em><strong class="jq hj"><em class="hi">9.2。</em> </strong> <em class="hi">编辑文件的最后一段代码，将代码替换为以下代码:<br/>替换此部分:- </em></p></blockquote><pre class="ma mb mc md fd mj mk ml mm aw mn bi"><span id="b694" class="kn ir hi mk b fi mo mp l mq mr">if(PYTHON_DEFAULT_EXECUTABLE)<br/> set(PYTHON_DEFAULT_AVAILABLE “TRUE”)<br/> elseif(PYTHON2INTERP_FOUND) <br/> # Use Python 2 as default Python interpreter<br/> set(PYTHON_DEFAULT_AVAILABLE “TRUE”)<br/> set(PYTHON_DEFAULT_EXECUTABLE “${PYTHON2_EXECUTABLE}”)<br/> elseif(PYTHON3INTERP_FOUND) <br/> # Use Python 3 as fallback Python interpreter (if there is no Python 2)<br/> set(PYTHON_DEFAULT_AVAILABLE “TRUE”)<br/> set(PYTHON_DEFAULT_EXECUTABLE “${PYTHON3_EXECUTABLE}”)<br/> endif()</span></pre><blockquote class="ln lo lp"><p id="8bce" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><em class="hi">用这个代码:- </em></p></blockquote><pre class="ma mb mc md fd mj mk ml mm aw mn bi"><span id="75d8" class="kn ir hi mk b fi mo mp l mq mr">if(PYTHON_DEFAULT_EXECUTABLE)<br/>    set(PYTHON_DEFAULT_AVAILABLE "TRUE")<br/>elseif(PYTHON3INTERP_FOUND) <br/> # Use Python 3 as default Python interpreter<br/>    set(PYTHON_DEFAULT_AVAILABLE "TRUE")<br/>    set(PYTHON_DEFAULT_EXECUTABLE "${PYTHON3_EXECUTABLE}")<br/>elseif(PYTHON2INTERP_FOUND) <br/>    # Use Python 2 as fallback Python interpreter (if there is no Python 3)<br/>    set(PYTHON_DEFAULT_AVAILABLE "TRUE")<br/>    set(PYTHON_DEFAULT_EXECUTABLE "${PYTHON2_EXECUTABLE}")<br/>endif()</span></pre><h2 id="7d83" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">10.使用 Cmake 配置 Opencv 和 Opencv-contrib</h2><blockquote class="ln lo lp"><p id="0e6d" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><em class="hi">现在我们将根据我们的机器配置来配置 Opencv，如 CUDA、cuDNN、GPU 架构等<br/> </em> <strong class="jq hj"> <em class="hi"> 10.1 的路径。</em> </strong> <em class="hi">打开我们之前安装的 cmake-gui app(步骤 2) <br/> </em> <strong class="jq hj"> <em class="hi"> 10.2。</em> </strong> <em class="hi">在我的例子中，给出源代码的路径和二进制文件的“build”文件夹的路径:-<br/>C:/Users/Administrator/Downloads/opencv-4 . 4 . 0/opencv-4 . 4 . 0<br/>C:/Users/Administrator/Downloads/build</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/9a18da6a90c21c11aa0fa7ce2c796bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R2177aJxhpINS0PkDbUd2Q.png"/></div></div></figure><blockquote class="ln lo lp"><p id="fa16" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">10.3<em class="hi">。</em> </strong> <em class="hi">点击配置<br/> </em> <strong class="jq hj"> <em class="hi"> 10.4。</em> </strong> <em class="hi">选择可选平台 x64，点击完成</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/741231071e5bcff9710ce0745a6c5614.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*GSWql2o2oVHqiOktE91-dQ.png"/></div></figure><blockquote class="ln lo lp"><p id="9e2f" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">10.5<em class="hi">。</em> </strong> <em class="hi">在输出部分下面配置按钮 goto 部分命名为“</em> <strong class="jq hj"> <em class="hi"> OpenCV 模块</em> </strong> <em class="hi">”。在那段看值的</em> <strong class="jq hj"> <em class="hi">要建</em> </strong> <em class="hi">，那里的</em> <strong class="jq hj"> <em class="hi">应该是 python3 某处的</em> </strong> <em class="hi">。确保(第 7.3 节)中描述的路径得到良好检查</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/1202a02fe8fd8917034b96883dab2bd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_C4zpAEFtxeBQJo1_YERw.png"/></div></div></figure><blockquote class="ln lo lp"><p id="744f" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj"> <em class="hi"> 10.6。</em> </strong> <em class="hi">如果对 10.5 不满意，则存在路径问题，您需要首先解决它</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/d40519ce4d7ee5ac8a1f52c3a756d937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hKMtDRJTPqlvwiYvgqeqxA.png"/></div></div></figure><blockquote class="ln lo lp"><p id="11a9" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj"> <em class="hi"> 10.7。</em> </strong> <em class="hi">现在，如果上述部分没有问题，那么通过在搜索选项卡中搜索 cmake 中的变量来配置该变量:</em></p></blockquote><pre class="ma mb mc md fd mj mk ml mm aw mn bi"><span id="4292" class="kn ir hi mk b fi mo mp l mq mr">WITH_CUDA — Checked<br/>OPENCV_DNN_CUDA — Checked<br/>ENABLE_FAST_MATH — Checked<br/>OPENCV_EXTRA_MODULES_PATH — “Give path to “opencv-contrib-4.4.0” directory(see section 6) by pointng at “modules” directory(in my case: C:\Users\Administrator\Downloads\opncv-contrib-4.4.0\opencv-contrib-4.4.0\modules) “</span></pre><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/3987bd7d324874670a2cc983dee4af68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*43nWrBofCUyV_J9npg37GQ.png"/></div></div></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/5c56d21c884508470ce4002982402254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0_dGBSJW6ZgWSq0m5ss1CQ.png"/></div></div></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/bbfdea56832ce55e3e4d41e087de8b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_GRQPWiB3ANnOsGYPrvPQ.png"/></div></div></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/a9074c35c12c1bbcbb02e7685a590cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kL20BAk1RRlHL3bpdyG3jg.png"/></div></div></figure><blockquote class="ln lo lp"><p id="7bb0" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj"> <em class="hi"> 10.8。</em> </strong> <em class="hi">再次点击配置按钮，等待“配置完成”输出<br/> </em> <strong class="jq hj"> <em class="hi"> 10.9。</em> </strong> <em class="hi">现在我们再将</em><strong class="jq hj"><em class="hi"/></strong><em class="hi">多配置一些变量，我们可以说第二轮配置</em></p></blockquote><pre class="ma mb mc md fd mj mk ml mm aw mn bi"><span id="4177" class="kn ir hi mk b fi mo mp l mq mr">CUDA_FAST_MATH — Checked<br/>CUDA_ARCH_BIN — 7.5 (This is strictly for my case)</span></pre><blockquote class="ln lo lp"><p id="d980" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><em class="hi">如果你想知道你的 GPU 的 arch_bin 跟随</em> <strong class="jq hj"> <em class="hi">维基</em> </strong> <em class="hi">链接:</em><a class="ae km" href="https://en.wikipedia.org/wiki/CUDA" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://en.wikipedia.org/wiki/CUDA</em></a><em class="hi">并查找</em> <strong class="jq hj"> <em class="hi">表</em> </strong> <em class="hi">并根据你的 GPU 型号名称选择二进制</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/ae10a111c926143912658479f16b3548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bTkAZCIIXVXMy9U_yN2ljg.png"/></div></div></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/8f51ffc91ee8fa7797fd20d35b1151a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*l_fiysuq1vSu-5y4JLOKZQ.png"/></div></figure><blockquote class="ln lo lp"><p id="306c" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">10.10<em class="hi">。</em> </strong> <em class="hi">再次点击配置，等待“配置完成”输出<br/> </em> <strong class="jq hj"> <em class="hi"> 10.11。</em> </strong> <em class="hi">点击生成按钮，等待“生成完成”输出</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es nd"><img src="../Images/712ad0820e6d9d9eea03cf5ae741e432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*klfBLrQKajBPhrYPag0X-g.png"/></div></figure><blockquote class="ln lo lp"><p id="46d3" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">10.12<em class="hi">。</em> </strong> <em class="hi">你的配置和代码的生成都完成了。现在您可以关闭 cmake-gui 应用程序</em></p></blockquote><h2 id="e132" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated">11.用 Visual Studio 编译 Cmake 创建的项目</h2><blockquote class="ln lo lp"><p id="a295" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><em class="hi">现在我们将编译和构建由 cmake 编写和配置的代码，放在名为“build”<br/></em><strong class="jq hj"><em class="hi">11.1 的文件夹中。</em> </strong> <em class="hi">使用命令提示符<br/> </em> <strong class="jq hj"> <em class="hi">转到“构建”文件夹 11.2。</em> </strong> <em class="hi">键入 OpenCV.sln 并按回车键。之后，它会为我们打开 Visual Studio</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/59cc21f0098f4110645bdc0bb087e52a.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*IFuZP3gdrGJqIhn1HRbFcA.png"/></div></figure><blockquote class="ln lo lp"><p id="32db" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">11.3<em class="hi">。</em> </strong> <em class="hi">如果 Visual Studio 打开时带有错误标签，那么只需执行以下操作:- </em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es nf"><img src="../Images/f840bd6731e92dd021655ba9e8631b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*qoO8v718EFRHt-EIhly6og.png"/></div></figure><blockquote class="ln lo lp"><p id="03b5" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">11 . 3 . 1<em class="hi">。</em> </strong> <em class="hi">在 VS goto </em> <strong class="jq hj"> <em class="hi">工具&gt;选项</em></strong><em class="hi"><br/></em><strong class="jq hj"><em class="hi">11 . 3 . 2。</em> </strong> <em class="hi">在选项面板中导航到</em> <strong class="jq hj"> <em class="hi">【项目和解决方案】&gt; Web 项目</em></strong><em class="hi"><br/></em><strong class="jq hj"><em class="hi">11 . 3 . 3。</em> </strong> <em class="hi">取消选中该选项卡的最后一个选项</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ng"><img src="../Images/e7f4ec79f649588e981462b42c35d647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i7bZqrjBNwR_AHEhcQ-nvQ.png"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx">11.3.3</figcaption></figure><blockquote class="ln lo lp"><p id="9b6e" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">T125】11 . 3 . 4。 </strong> <em class="hi">点击 ok，按步骤 11.1 和 11.2 重新启动 Visual Studio</em></p><p id="7115" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj"> <em class="hi"> 11.4。</em> </strong> <em class="hi">在 VS 时</em> <strong class="jq hj"> <em class="hi">调试</em> </strong> <em class="hi">“模式到”</em> <strong class="jq hj"> <em class="hi">释放</em> </strong> <em class="hi">“模式到”</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es nl"><img src="../Images/dc5160fa41ac9066ed16d892531c102a.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*KsPtvrA25S5P4gpq_J7zIg.png"/></div></figure><blockquote class="ln lo lp"><p id="3e15" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj"> <em class="hi"> 11.5。</em> </strong> <em class="hi">在 VS 右侧展开【cmake targets】<br/></em><strong class="jq hj"><em class="hi">11.6。</em> </strong> <em class="hi">右键点击“ALL_BUILD”，点击 BUILD。这大约需要 30 分钟。<br/> </em> <strong class="jq hj"> <em class="hi"> 11.7。</em></strong><em class="hi">11.6 之后，右键“安装”，打 build。这将很快完成。</em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es nm"><img src="../Images/a8786bfc49a45c5fc045aee8aa6bbcd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*0AUOmlFmFdatEX_1-EejDQ.png"/></div></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es nn"><img src="../Images/611dc90174377361ca38ac8f866757aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*FohYUNH0T421io-BRa120Q.png"/></div><figcaption class="nh ni et er es nj nk bd b be z dx translated">步骤 11.6</figcaption></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es no"><img src="../Images/6ef22079f89038c20a4c78f9d1e93f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HzTGUalqi4feumxI436ZXA.png"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx translated">所有生成的输出</figcaption></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es np"><img src="../Images/71abf0717273295dfc6af67f74a061fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WPiI5BZYZCb6ZhDgTc3AQ.png"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx translated">安装输出</figcaption></figure><blockquote class="ln lo lp"><p id="6453" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">11.8<em class="hi">。</em> </strong> <em class="hi">确保 11.6 和 11.7 中没有错误。如果是这样，确保你点击了释放模式(第 11.4 节)<br/> </em> <strong class="jq hj"> <em class="hi"> 11.9。</em> </strong> <em class="hi">最后你用 CUDA、cuDNN、GPU access<br/></em><strong class="jq hj"><em class="hi">11.10 构建编译了 opencv。</em></strong>T56】关闭 Visual Studio </p></blockquote><h2 id="8b43" class="kn ir hi bd is ko kp kq iw kr ks kt ja jz ku kv je kd kw kx ji kh ky kz jm la bi translated"><strong class="ak"> 12。</strong>确认安装是否正确</h2><blockquote class="ln lo lp"><p id="9fc3" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">12.1<em class="hi">。</em> </strong> <em class="hi">打开命令提示符，打 python <br/> </em> <strong class="jq hj"> <em class="hi"> 12.2。</em> </strong> <em class="hi">键入以下内容:- </em></p></blockquote><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nq"><img src="../Images/2018a970f7bb0e2b6f387542cf71d291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xl-mygqiBRvSWSkjXlXIuA.png"/></div></div></figure><blockquote class="ln lo lp"><p id="12a3" class="jo jp lq jq b jr lr jt ju jv ls jx jy lt lu kb kc lv lw kf kg lx ly kj kk kl hb bi translated"><strong class="jq hj">12.3<em class="hi">。</em> </strong> <em class="hi">如果 12.2。如果是这样，那么你已经成功地安装了 OpenCV 和 GPU。恭喜</em></p></blockquote></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="dc39" class="iq ir hi bd is it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn bi translated">结论</h1><p id="0983" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">这是我们经历的一个漫长而又紧张的过程。OpenCV 应该内置 GPU 检测过程，这可能会简化为新环境反复构建它的过程。</p><h1 id="6451" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">参考</h1><ul class=""><li id="f1f6" class="nr ns hi jq b jr js jv jw jz nt kd nu kh nv kl nw nx ny nz bi translated">C++语言 OpenCV 安装:<a class="ae km" href="https://docs.opencv.org/master/d3/d52/tutorial_windows_install.html" rel="noopener ugc nofollow" target="_blank">https://docs . OpenCV . org/master/D3/d52/tutorial _ windows _ install . html</a></li><li id="726e" class="nr ns hi jq b jr oa jv ob jz oc kd od kh oe kl nw nx ny nz bi translated">主要错误:<a class="ae km" href="https://answers.opencv.org/question/235491/error-importing-cv2-after-compiling-opencv-from-source-python/" rel="noopener ugc nofollow" target="_blank">https://answers . opencv . org/question/235491/Error-importing-cv2-after-compilating-opencv-from-source-python/</a></li><li id="1d1c" class="nr ns hi jq b jr oa jv ob jz oc kd od kh oe kl nw nx ny nz bi translated">这很有帮助，但对我不起作用:<a class="ae km" href="https://jamesbowley.co.uk/accelerate-opencv-4-4-0-build-with-cuda-and-python-bindings/#visual_studio_cmake_cmd" rel="noopener ugc nofollow" target="_blank">https://jamesbowley . co . uk/accelerate-opencv-4-4-0-build-with-cuda-and-python-bindings/# visual _ studio _ cmake _ cmd</a></li><li id="a023" class="nr ns hi jq b jr oa jv ob jz oc kd od kh oe kl nw nx ny nz bi translated">这个 Youtube 视频真的帮了大忙:<a class="ae km" href="https://www.youtube.com/watch?v=tjXkW0-4gME&amp;t=461s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=tjXkW0-4gME&amp;t = 461s</a></li><li id="498c" class="nr ns hi jq b jr oa jv ob jz oc kd od kh oe kl nw nx ny nz bi translated">维基百科页面为 CUDA:<a class="ae km" href="https://en.wikipedia.org/wiki/CUDA" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/CUDA</a></li><li id="492e" class="nr ns hi jq b jr oa jv ob jz oc kd od kh oe kl nw nx ny nz bi translated">对于 CUDA 和 cuDNN 安装:<a class="ae km" rel="noopener" href="/@ankitkumar60323/installing-cuda-and-cudnn-on-windows-d44b8e9876b5">https://medium . com/@ ankitkumar 60323/installing-CUDA-and-cud nn-on-windows-d 44 b 8 e 9876 b 5</a></li></ul></div></div>    
</body>
</html>