<html>
<head>
<title>Heart Disease Prediction with Auto ML(pycaret)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Auto ML(pycaret)预测心脏病</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/heart-disease-prediction-with-auto-ml-pycaret-f30ab8b5e4a8?source=collection_archive---------17-----------------------#2020-06-14">https://medium.com/analytics-vidhya/heart-disease-prediction-with-auto-ml-pycaret-f30ab8b5e4a8?source=collection_archive---------17-----------------------#2020-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b0032c2096f1881153d5d68272806c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fiw_hq3j-lYhDbMfwyWerw.jpeg"/></div></div></figure><blockquote class="iq ir is"><p id="c829" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你可以在这里找到完整的代码和数据集。</p></blockquote><h1 id="9a85" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.介绍</h1><p id="8023" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">这与你将看到的通常的Kaggle作品有些不同，其中大多数都是使用原始方法或可以说是传统方法来建立模型。这种方法的主要问题是在数据预处理、特征选择、模型选择、超参数调整等方面浪费了大量时间。但是现在有许多自动Ml可以很容易地安装，并可以有效地使用。许多耗时的工作可以用几行代码轻松完成。在大多数情况下，模型精度会高于传统方法制作的模型。</p><p id="f672" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">关于我们正在使用的数据集。</strong></p><p id="81b6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">该数据库包含76个属性，但所有发表的实验都提到使用其中14个属性的子集。特别是，克利夫兰数据库是迄今为止唯一被ML研究人员使用的数据库。“目标”字段是指患者是否存在心脏病。它是从0(不存在)到4的整数值。</p><p id="f24d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">一般来说，该数据集给出了许多变量以及是否患有心脏病的目标条件</strong></p><blockquote class="iq ir is"><p id="6576" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="hi">这是为那些需要高度精确、完美模型的人准备的，不太令人头疼。</em>T9】</strong></p><p id="253e" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这并不适合那些试图研究模型、深入研究每种机器学习算法的人。</p></blockquote><h1 id="6b74" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2.安装必要的软件包</h1><p id="d206" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">在我们进入编码部分之前，首先导入必要的包。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="7884" class="li ju hi le b fi lj lk l ll lm">!pip install pycaret</span><span id="b6c7" class="li ju hi le b fi ln lk l ll lm">import numpy as np <em class="iv"># linear algebra</em><br/>import pandas as pd <em class="iv"># data processing, CSV file I/O (e.g. pd.read_csv)</em><br/>import matplotlib.pyplot as plt <em class="iv">#Data visualization </em><br/>import seaborn as sns <em class="iv">#Data visualization</em></span></pre><p id="8af0" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> pycaret </strong> : <em class="iv">我们这里使用的AutoML是pycaret </em></p><p id="a866" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> numpy </strong>:用于线性代数的库</p><p id="6fa1" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> pandas </strong>:用于<em class="iv">数据处理的库，CSV文件I/O(如pd.read_csv </em></p><p id="7afd" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">matplotlib :用于数据可视化的库。</p><p id="7ef0" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> seaborn </strong>:用于数据可视化的库。</p><h1 id="ba82" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">3.获取数据</h1><p id="7320" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">我们可以使用熊猫图书馆获得数据集。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="e077" class="li ju hi le b fi lj lk l ll lm"><em class="iv"># Getting the datasets to "datasets" variable</em><br/>dataset = pd.read_csv("../input/heart-disease-uci/heart.csv")</span><span id="ca1f" class="li ju hi le b fi ln lk l ll lm"><em class="iv"># Showing first 5 rows.</em><br/>dataset.head()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/3cbb6e75e2979f464a82f086776f08a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kh1aXbaEeQeKB_Oi87xPKA.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">数据集的前5行</figcaption></figure><h1 id="bcd2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">4.属性信息</h1><p id="c294" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">这是一组清晰易懂的数据。然而，一些列标题的含义并不明显。他们的意思是，</p><p id="48cb" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">年龄:</strong>以年为单位的人的年龄</p><p id="51c3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">性别:</strong>人的性别(1 =男性，0 =女性)</p><p id="b0b3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> cp: </strong>所经历的胸痛(值1:典型心绞痛，值2:非典型心绞痛，值3:非心绞痛性疼痛，值4:无症状)</p><p id="96a7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> trestbps </strong>:患者的静息血压(入院时为毫米汞柱)</p><p id="c3cb" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">胆固醇:</strong>人的胆固醇测量值，单位为毫克/分升</p><p id="2c95" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> fbs: </strong>人的空腹血糖(&gt; 120 mg/dl，1 =真；0 =假)</p><p id="d14a" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">静息心电图:</strong>静息心电图测量(0 =正常，1 = ST-T波异常，2 =根据Estes标准显示可能或明确的左心室肥大)</p><p id="f951" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> thalach: </strong>人的最大心率达到</p><p id="4dde" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> exang: </strong>运动诱发心绞痛(1 =是；0 =否)</p><p id="f9d5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> oldpeak: </strong>运动相对于休息诱发的ST段压低(‘ST’与心电图图上的位置有关。点击此处查看更多)</p><p id="3dc5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">斜率:</strong>峰值运动ST段的斜率(值1:向上倾斜，值2:平坦，值3:向下倾斜)</p><p id="b4a3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj"> ca: </strong>主要血管数量(0-3)</p><p id="7237" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">地中海贫血:</strong>一种叫做地中海贫血的血液疾病(3 =正常；6 =修复缺陷；7 =可逆缺陷)</p><p id="4658" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">目标:</strong>心脏病(0 =否，1 =是)</p><h1 id="23ca" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">检查数据是否平衡</h1><h2 id="2bb8" class="li ju hi bd jv lt lu lv jz lw lx ly kd kt lz ma kh kv mb mc kl kx md me kp mf bi translated">正如我们所看到的，45%和54%是一个平衡的数据。</h2><p id="2b14" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">这是最重要的一步，但大多数初学者都忘记了。如果我们拥有的数据集是不平衡的，我们就不能使用准确度分数作为决定ML模型质量的最终因素。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="b503" class="li ju hi le b fi lj lk l ll lm">countNoDisease = len(dataset[dataset.target == 0])<br/>countHaveDisease = len(dataset[dataset.target == 1])<br/>print("Percentage of Patients Haven't Heart Disease: <strong class="le hj">{:.2f}</strong>%".format((countNoDisease / (len(dataset.target))*100)))<br/>print("Percentage of Patients Have Heart Disease: <strong class="le hj">{:.2f}</strong>%".format((countHaveDisease / (len(dataset.target))*100)))</span><span id="cd34" class="li ju hi le b fi ln lk l ll lm">Percentage of Patients Haven't Heart Disease: 45.54%<br/>Percentage of Patients Have Heart Disease: 54.46%</span></pre><h1 id="fe59" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">5.可视化数据集(这样我们可以更好地了解数据集)</h1><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="e79f" class="li ju hi le b fi lj lk l ll lm">sns.countplot(x="target", data=dataset, palette="bwr")<br/>plt.show()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/4762ff6660946bd23ec7f53031f99a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*9af4LrU6S1sIc3Kvb75Ufw.png"/></div></figure><p id="247e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">心脏病患者和非心脏病患者的比较。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="9c99" class="li ju hi le b fi lj lk l ll lm">sns.countplot(x='sex', data=dataset, palette="mako_r")<br/>plt.xlabel("Sex (0 = female, 1= male)")<br/>plt.show()<br/></span></pre><p id="a85b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">这张图表显示了我们数据集中男性和女性的数量。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/a2a3addc8ba5eb05d558bb6b2cdb5783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*U-Uwn_WcLvIzi3klWWvjBA.png"/></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="30b7" class="li ju hi le b fi lj lk l ll lm"><em class="iv">countFemale </em>= len(dataset[dataset.sex == 0])<br/>countMale = len(dataset[dataset.sex == 1])<br/>print("Percentage of Female Patients: <strong class="le hj">{:.2f}</strong>%".format((countFemale / (len(dataset.sex))*100)))<br/>print("Percentage of Male Patients: <strong class="le hj">{:.2f}</strong>%".format((countMale / (len(dataset.sex))*100)))</span><span id="8599" class="li ju hi le b fi ln lk l ll lm">Percentage of Female Patients: 31.68%<br/>Percentage of Male Patients: 68.32%</span></pre><p id="e865" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">只是检查男性和女性患者的比例</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="82c2" class="li ju hi le b fi lj lk l ll lm">pd.crosstab(dataset.age,dataset.target).plot(kind="bar",figsize=(30,15))<br/>plt.title('Heart Disease Frequency for Ages')<br/>plt.xlabel('Age')<br/>plt.ylabel('Frequency')<br/>plt.savefig('heartDiseaseAndAges.png')<br/>plt.show()</span></pre><p id="12d4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">这张图表向我们展示了心脏病随年龄增长的频率。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/688bbc0a70dc7f12de94df75577739e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-kha3b1NwyccNfgBXSC2w.png"/></div></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="2939" class="li ju hi le b fi lj lk l ll lm">pd.crosstab(dataset.sex,dataset.target).plot(kind="bar",figsize=(15,6),color=['#1CA53B','#AA1111' ])<br/>plt.title('Heart Disease Frequency for Sex')<br/>plt.xlabel('Sex (0 = Female, 1 = Male)')<br/>plt.xticks(rotation=0)<br/>plt.legend(["Haven't Disease", "Have Disease"])<br/>plt.ylabel('Frequency')<br/>plt.show()</span></pre><p id="ddb6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">男女对比，有无心脏问题。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/80e6d513de0638a2e47394dd5b552183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*evAcyefPX5Rurt81G16Spw.png"/></div></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="a1ca" class="li ju hi le b fi lj lk l ll lm">plt.scatter(x=dataset.age[dataset.target==1], y=dataset.thalach[(dataset.target==1)], c="red")<br/>plt.scatter(x=dataset.age[dataset.target==0], y=dataset.thalach[(dataset.target==0)])<br/>plt.legend(["Disease", "Not Disease"])<br/>plt.xlabel("Age")<br/>plt.ylabel("Maximum Heart Rate")<br/>plt.show()</span></pre><p id="82e7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">显示不同年龄组的人患病和未患病的散点图。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/b14c2c5ec0e3c69f314af87ae94930b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*bNN-UV319ZNrNwz0Zki1kw.png"/></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="46ab" class="li ju hi le b fi lj lk l ll lm">pd.crosstab(dataset.slope,dataset.target).plot(kind="bar",figsize=(15,6),color=['#DAF7A6','#FF5733' ])<br/>plt.title('Heart Disease Frequency for Slope')<br/>plt.xlabel('The Slope of The Peak Exercise ST Segment ')<br/>plt.xticks(rotation = 0)<br/>plt.ylabel('Frequency')<br/>plt.show()</span></pre><p id="5e37" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">与运动ST段峰值斜率的比较。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/fc7567d0ba1ba4984d4b135a92acde83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gh7A4dNVw-eUJm5L8dNRYw.png"/></div></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="d0aa" class="li ju hi le b fi lj lk l ll lm">pd.crosstab(dataset.fbs,dataset.target).plot(kind="bar",figsize=(15,6),color=['#FFC300','#581845' ])<br/>plt.title('Heart Disease Frequency According To FBS')<br/>plt.xlabel('FBS - (Fasting Blood Sugar &gt; 120 mg/dl) (1 = true; 0 = false)')<br/>plt.xticks(rotation = 0)<br/>plt.legend(["Haven't Disease", "Have Disease"])<br/>plt.ylabel('Frequency of Disease or Not')<br/>plt.show()</span></pre><p id="7895" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">与‘FBS—(空腹血糖&gt; 120 mg/dl)的比较(1 =真；0 =假)</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/279c9341af3590dc373f80de77a07d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R7eVsHDWgMEH-hBlAI8F6A.png"/></div></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="9f37" class="li ju hi le b fi lj lk l ll lm">pd.crosstab(dataset.cp,dataset.target).plot(kind="bar",figsize=(15,6),color=['#11A5AA','#AA1190' ])<br/>plt.title('Heart Disease Frequency According To Chest Pain Type')<br/>plt.xlabel('Chest Pain Type')<br/>plt.xticks(rotation = 0)<br/>plt.ylabel('Frequency of Disease or Not')<br/>plt.show()</span></pre><p id="3ffd" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">与胸痛类型的比较</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/6ca1cfd2b4285e3325c1b20c99e995f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EjHPu_GkD4mbuBghwLZGKQ.png"/></div></div></figure><h1 id="097a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">6.为模型选择准备数据</h1><p id="db1e" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">在这一步中，我们将数据集一分为二。第一部分包含用于训练和测试的95%的数据。剩余的5%被存储起来，并用于测试我们部署的最终模型(该数据被命名为unseen data)。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="11b3" class="li ju hi le b fi lj lk l ll lm">data = dataset.sample(frac=0.95, random_state=786).reset_index(drop=True)<br/>data_unseen = dataset.drop(data.index).reset_index(drop=True)<br/><br/>print('Data for Modeling: ' + str(data.shape))<br/>print('Unseen Data For Predictions ' + str(data_unseen.shape))</span><span id="26bc" class="li ju hi le b fi ln lk l ll lm">Data for Modeling: (288, 14)<br/>Unseen Data For Predictions (15, 14)</span></pre><h1 id="afac" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">7.导入pycaret分类方法</h1><p id="53a7" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">我们在这里使用的自动Ml是pycaret。它的工作非常简单，因为我们想给数据集作为数据，我们的目标列作为目标。我们还可以设置一些其他功能，如下所示。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="21c0" class="li ju hi le b fi lj lk l ll lm"><em class="iv"># Importing pycaret classification method</em><br/>from pycaret.classification import *<br/><br/><em class="iv"># This is the first step of model selection</em><br/><em class="iv"># Here the data is our datasets, target is the labeled column(dependent variable), section is is random number for future identification.</em><br/>exp = setup(data = data, target = 'target', session_id=1,<br/>                  normalize = True, <br/>                  transformation = True, <br/>                  ignore_low_variance = True,<br/>                  remove_multicollinearity = True, multicollinearity_threshold = 0.95 )<br/><br/></span></pre><blockquote class="iq ir is"><p id="9dde" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="hi">在这之后，我们将得到一个列及其类型的列表，只需确认它们是相同的。然后按回车键。</em></p></blockquote><h1 id="daf1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">8.比较模型</h1><p id="51c8" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">在确认了列类型之后，现在我们可以用两个ML算法来运行数据集，并且我们可以比较性能。如下图。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="1b4c" class="li ju hi le b fi lj lk l ll lm"><em class="iv">#This command is used to compare different models with our datasets.</em><br/><em class="iv">#The accuracy,F1 etc of each model is listed in a table.</em><br/><em class="iv">#Choose which model you want</em><br/>compare_models()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/e87edb8d864b878a3f5be948a46f3fba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bDHBTxIpIJrKWk_jDVZFsA.png"/></div></div></figure><p id="ac18" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">在上表中，我们可以看到许多具有良好精确度的模型。</p><blockquote class="iq ir is"><p id="db02" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们应该决定使用哪种算法，并复制它的代码。</p></blockquote><p id="feac" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated"><strong class="iw hj">不同型号的代码如下。</strong></p><p id="9efe" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">逻辑回归<strong class="iw hj">‘lr’</strong></p><p id="2db4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">k最近邻<strong class="iw hj">‘KNN’</strong></p><p id="409b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">天真的贝叶斯<strong class="iw hj">‘nb’</strong></p><p id="7340" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">决策树<strong class="iw hj">‘dt’</strong></p><p id="f77d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">SVM(线性)<strong class="iw hj">‘支持向量机’</strong></p><p id="849e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">SVM(径向基函数)<strong class="iw hj">‘径向基函数支持向量机’</strong></p><p id="99ab" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">高斯过程<strong class="iw hj">‘GPC’</strong></p><p id="5754" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">多级感知器<strong class="iw hj">‘MLP’</strong></p><p id="8f2c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">山脊分类器<strong class="iw hj">‘山脊’</strong></p><p id="0a44" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">随机森林<strong class="iw hj">‘RF’</strong></p><p id="107b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">二次圆盘。分析<strong class="iw hj">‘qda’</strong></p><p id="f080" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">阿达布<strong class="iw hj">‘阿达’</strong></p><p id="f0c6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">梯度推进分类器<strong class="iw hj"> 'gbc' </strong></p><p id="19c4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">线性圆盘。分析<strong class="iw hj">‘LDA’</strong></p><p id="cb7f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">额外的树分类器<strong class="iw hj">等</strong></p><p id="0695" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">极端梯度推进<strong class="iw hj"> 'xgboost' </strong></p><p id="2184" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">光梯度增强<strong class="iw hj">‘light GBM’</strong></p><p id="eaf9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">催化增强分类器<strong class="iw hj">‘催化增强’</strong></p><h1 id="c337" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">9.创建模型</h1><p id="9949" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">现在我们可以创建模型了。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="4324" class="li ju hi le b fi lj lk l ll lm"><em class="iv"># With this command we are creating a </em>Linear Disc. Analysis<em class="iv"> model</em><br/><br/><em class="iv"># fold is the number of fold you want</em><br/>lda_model = create_model('lda', fold = 10)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/80749227689c2c675eb2169ecc0d5943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*Qy307Tv1iotC8ixdXjv7XQ.png"/></div></figure><p id="e1c4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">该表显示了所有10次折叠的精度和其他读数。</p><p id="aab2" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">现在我们正在调整超参数。</p><blockquote class="iq ir is"><p id="e315" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">调整超级参数对于提高精确度和其他功能非常有用。</p></blockquote><h2 id="da65" class="li ju hi bd jv lt lu lv jz lw lx ly kd kt lz ma kh kv mb mc kl kx md me kp mf bi translated">对于不平衡的数据集，我们主要看F1分数，因为我们的数据集是平衡的，我们可以使用精确度。</h2><h1 id="0ed5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">10.调整超参数</h1><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="5d61" class="li ju hi le b fi lj lk l ll lm">tuned_lda = tune_model('lda', optimize='F1')</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/abe035e40ab7e42a93980a6107117734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*IkTO_8xDK8-KpatnDOCrcg.png"/></div></figure><h1 id="b64c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">11.绘制ROC曲线</h1><p id="4bc6" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">随着雕刻向x、y轴移动，性能会提高。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="6b9b" class="li ju hi le b fi lj lk l ll lm">plot_model(tuned_lda, plot = 'auc')</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/189942102fe4c285158963abbddce2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*04gv6AyrVU2-S9PXUxtddg.png"/></div></figure><h1 id="4222" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">12.混淆矩阵</h1><p id="9a1c" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">随着真阳性的数量增加，模型的性能也增加。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="4f47" class="li ju hi le b fi lj lk l ll lm">plot_model(tuned_lda, plot = 'confusion_matrix')</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/5d91edec02e50065b2e461e932d2c23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*5OtAsxXl5dZ0IOckgrqu_A.png"/></div></figure><h1 id="6b00" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">13.使用测试数据集预测准确性</h1><p id="01c0" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">我们得到0.8506的准确度和0.8632的F1分数</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="535f" class="li ju hi le b fi lj lk l ll lm">predict_model(tuned_lda);</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/aaf74da1d506b60fb7dfd3253e77c678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WuhHrB8WQy50z-hiDgnImw.png"/></div></div></figure><h1 id="65d9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">14.用看不见的数据检查</h1><p id="e97c" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">最初，我们将一部分数据集分离为看不见的数据集，用于检查最终部署的模型。下面我们正在检查这个。结果是具有标签和分数(最后两列)数据框。其中标签是预测的标签，分数是机器认为该人患有心脏病的百分比。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="421e" class="li ju hi le b fi lj lk l ll lm">new_prediction = predict_model(tuned_lda, data=data_unseen)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/2de413d0115343a12dc8bff99cf51893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uAfQX4mY4hnimaO7rxlGTw.png"/></div></div></figure><h1 id="db27" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">15.摘要</h1><p id="6052" class="pw-post-body-paragraph it iu hi iw b ix kr iz ja jb ks jd je kt ku jh ji kv kw jl jm kx ky jp jq jr hb bi translated">正如我们在上面看到的，我们得到了一个86%精度的高精度模型，没有过度拟合。Auto Ml更受欢迎，因为它节省了大量时间，并提供了非常好的结果。对于缺乏经验的人来说，超参数调整并不容易，但是超参数调整对模型的性能产生了巨大的影响。</p><p id="70f0" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kt jg jh ji kv jk jl jm kx jo jp jq jr hb bi translated">没有十全十美的，如果有人发现任何错误或建议，请在下面不吝赐教。</p></div></div>    
</body>
</html>