<html>
<head>
<title>Heart Disease Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">心脏病分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/heart-disease-classifier-922495b8cf7b?source=collection_archive---------10-----------------------#2020-02-20">https://medium.com/analytics-vidhya/heart-disease-classifier-922495b8cf7b?source=collection_archive---------10-----------------------#2020-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2615" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">心脏病是健康领域的常见疾病，它影响着一个人的生活，在这篇文章中，我们希望预测患者是否患有心脏病。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="087b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们开始这个项目的步骤之前，我们需要确定我们有什么问题。我们的问题是一个二元分类，我们需要对心脏病患者和非心脏病患者进行分类，这种情况非常严重。所以，基于我们的问题特点，我选择了两个机器学习模型(Logistic回归和LinearSVC)进行分类。我决定用三个指标来评估这些模型的性能，它们是精确度、召回率和混淆矩阵。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="8380" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有五个步骤来构建这个项目，如下所示:</p><p id="2856" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.数据收集和加载</p><p id="cf22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.数据探索</p><p id="bbbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.数据清理和预处理</p><p id="6e72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.构建ML模型</p><p id="0604" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.结果</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="29d9" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">1.数据收集和加载</h1><p id="9833" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">我使用了来自Kaggle的心脏病数据集，你可以通过这个<a class="ae kn" href="https://www.kaggle.com/ronitf/heart-disease-uci" rel="noopener ugc nofollow" target="_blank">链接</a>来访问它。</p><p id="201c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集有14列，如年龄、性别、胸痛类型、目标患者是否患有心脏病等。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ko"><img src="../Images/29924c992f057496288a2723f9d6717e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P_SQpGVzEHFTkvMw-UO4Xw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图1:加载数据集</figcaption></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="c426" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">2.数据探索</h1><p id="2d6e" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在这一步中，我发现了数据集并获得了关于它的更多信息。</p><p id="002d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">发现对我们分类病人很重要的目标变量。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es le"><img src="../Images/1ef31e05508d328c3f48541a1e759e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8IsdLqh6LNFdV0-mA05jng.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图2:每类患者的百分比</figcaption></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es lf"><img src="../Images/f85c9f473d7f7159161667ecff47f485.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*63uSDqB4-4ydFxi4gsljSg.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图3:每个班级的病人数量</figcaption></figure><p id="d49c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所示，我们有不平衡的数据，我们有54%的输入(患者)有心脏病，45%的输入没有。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="fd49" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">3.数据清理和预处理</h1><p id="26b8" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在这一步，我检查数据是否有缺失值，是否有重复值，找出变量之间的相关性，在这一过程的最后一步，我将分类变量转换为虚拟变量。</p><p id="68cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3.1。检查我们是否有丢失的值</strong></p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lg"><img src="../Images/9f3968e3210b0b6f0ae31c9aa46ba7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5dZwnzP56avo-xhzwit-w.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图4:显示每一列缺失值的数量</figcaption></figure><p id="53fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所示，我们没有任何缺失值，因此我们将进入下一步。</p><p id="dcb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3.2。检查我们是否有重复的值</strong></p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lh"><img src="../Images/ba978c7bf97293d4ca452e39815337e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vL8Qv0mYP8bHR-eQFRFHOA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图5:显示重复值的数量并删除它</figcaption></figure><p id="9786" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有一行重复，我决定删除它。</p><p id="9a2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.3 .可视化变量之间的相关性</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es li"><img src="../Images/58f8e1962aa70f5adce91f84b049d079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5i8JnPRDqRxWoS9crIepPA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图6:特性热图</figcaption></figure><p id="22eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们关心的重要列是目标列，根据热图，目标列与slop、thalach和cp呈强正相关，与ca、exang、thal和oldpeak呈强负相关。因此，我将选择这些变量来构建我们的模型。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lj"><img src="../Images/82c51639827e812eada4e56589c1c17c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vu8x2_K0dCJAUgKIIgizJw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图7:特性选择</figcaption></figure><h2 id="b3b6" class="lk jl hi bd jm ll lm ln jq lo lp lq ju iq lr ls jy iu lt lu kc iy lv lw kg lx bi translated">3.4 .将分类变量转换为虚拟变量</h2><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ly"><img src="../Images/7e7ea3a3c1e5281dbd4a802a3e054b7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTWd1cb2YXkzjdGNSyZ6Tw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图8:将分类变量转换成虚拟变量</figcaption></figure><p id="89e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有三个分类变量，我们需要在建立模型之前转换它，我们注意到我们有一系列变化很大的值，我们需要缩放它。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="bc64" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak"> 4。构建ML模型</strong></h1><p id="6dba" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在这一步中，我决定使用网格搜索技术运行两个模型(LogisticRegression和LinearSVC)来优化超参数。</p><p id="db0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在每个管道中，我们需要使用StandardScaler来缩放功能，我决定采用两个参数，我们需要使用网格搜索技术来调整模型。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lz"><img src="../Images/a1e2b2a66e95227edfe674ccc2a22379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0RpxspeMl5O_BdQ36CILVQ.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图9:物流回收管道</figcaption></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ma"><img src="../Images/26a805b78e28a0f580b816dadf31d2b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uCaN8VQziqbHYBz175gt3A.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图10: LinearSVC管道</figcaption></figure><p id="20d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们建立了两条管道之后，我们就可以训练模型了。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mb"><img src="../Images/23f7c09731cab7f2cae889d17848f5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_xDa5Tv9dt-aPe8IMbs-Q.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图11:训练模型</figcaption></figure><p id="db79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，使用精度和召回来评估模型</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mc"><img src="../Images/fb3b9a79fbfb87023252a222b20a66e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKaW_o06Hnp82eHzbiGdIA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图12:评估模型</figcaption></figure><p id="a745" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，运行管道并返回训练好的模型。</p><p id="a560" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一步中，我将新数据集分为训练集和测试集，然后训练模型，评估它，并返回训练好的模型。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es md"><img src="../Images/cf3073d88d0d1240e4e125bf2b30f60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8PSWkRmpJrIwUhCEFprng.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图13:运行管道</figcaption></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="4669" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">5.结果</h1><p id="9f98" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在此步骤中，运行管道并显示每个模型的精度和召回分数，然后返回带有测试数据集的已训练模型。最后，绘制每个模型的混淆矩阵。</p><p id="9a84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5.1 </strong>精度和召回分数</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es me"><img src="../Images/de7f28b5bbfdbd7f07506031b5a51e0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBrZ7jmNDOicUBdiz-kPBg.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图14:使用精确度和召回分数评估两个模型</figcaption></figure><p id="34de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们注意到LinearSVC模型中最高的精确度和召回分数。</p><p id="2b0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5.2 .混淆矩阵</strong></p><p id="f946" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5.2.1 .逻辑回归模型的混淆矩阵</strong></p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lj"><img src="../Images/688d2e899d404b557ef0b0b59eb3aef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3g4eHLjZaVhibMne9uwjeA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图15:逻辑回归模型的混淆矩阵</figcaption></figure><p id="0f36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5.2.2 .线性SVC模型的混淆矩阵</strong></p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mf"><img src="../Images/a8837335a479c9a43b7c566df782ebb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vv8JTLmv8DzubRnjS3Fq9g.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图16:线性SVC模型的混淆矩阵</figcaption></figure><p id="70a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们注意到，LinearSVC模型的真阳性率约为88%，相比之下，逻辑回归的真阳性率为84%，而LinearSVC的假阴性率约为12%，相比之下，逻辑回归的假阴性率为16%。</p><p id="2425" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5.3选择最佳型号和参数</strong></p><p id="da76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我决定选择LinearSVC模型，因为我们获得了最佳的精确度和回忆分数，特别是对于这个问题(心脏病)，我们专注于患有疾病的患者，而分类器将其分类为没有患病。我们注意到，LinearSVC的混淆矩阵有12%的假负值，而LogisticRegression的假负值是16%。因此，我们可以使用LinearSVC作为这个问题的分类器。</p><p id="0db8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以显示具有最佳参数的最佳模型。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mg"><img src="../Images/1679fca10efa1e8da23554ddb656a155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SUyem03FuOiUGnL-vP9rSw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">图17:显示最佳模型</figcaption></figure><h1 id="b7e7" class="jk jl hi bd jm jn mh jp jq jr mi jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh bi translated">结论</h1><p id="d591" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在这篇文章中，我们建立了一个心脏病分类器。我们经历了数据科学过程的几个步骤，我们使用了来自Kaggle的心脏病数据集，包括我们需要它进行分类的14列，我们探索了数据集、数据清洗和预处理，以准备我们的数据集来训练模型，然后我们使用两个ML模型并用适当的指标对其进行评估，并基于它选择最佳模型。</p><p id="df18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">处理小数据集非常具有挑战性，因为它会影响模型的性能，我试图选择相关的特征以避免过度拟合，从而获得最佳性能。</p><p id="8245" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我有一些建议来提高这个模型的性能，例如检测异常值，使用技术来处理不平衡的数据集，如过采样技术。</p></div></div>    
</body>
</html>