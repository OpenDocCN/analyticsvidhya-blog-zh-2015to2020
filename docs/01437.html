<html>
<head>
<title>Chatbot Development using Deep Learning &amp; NLP implementing Seq2Seq Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习和NLP实现Seq2Seq模型的聊天机器人开发</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/chatbot-development-using-deep-learning-nlp-implementing-seq2seq-model-eb1114903523?source=collection_archive---------5-----------------------#2019-10-22">https://medium.com/analytics-vidhya/chatbot-development-using-deep-learning-nlp-implementing-seq2seq-model-eb1114903523?source=collection_archive---------5-----------------------#2019-10-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/be93567fca266b2bdb4b0dcca4fa0515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*wgm2U8XJ_iYmatpyC4betg.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">全矢量创建的横幅矢量—<a class="ae iq" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">www.freepik.com</a></figcaption></figure><blockquote class="ir is it"><p id="7d5e" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:在这篇文章中，我将只总结构建聊天机器人的步骤。与这个项目相关的所有文件和完整的代码已经上传到我的github个人资料中，下面给出了链接，要查看完整的代码，你可以克隆或下载这个库。<strong class="ix hj"> chatbot.py </strong>文件包含大量解释代码内容和原因的注释。因此，你不会真的有任何困难理解它。任何其他疑问都将得到解答。</p><p id="9988" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">【https://github.com/adi2381/ai-chatbot T4】</p></blockquote><p id="b86c" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">在我们开始这篇文章之前，我们需要用简单的语言了解一些事情，比如:</p><ul class=""><li id="2306" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated">什么是聊天机器人？</li></ul><p id="d4f3" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">聊天机器人可以被定义为一种人工智能的应用，它通过听觉或文本或手段与人类进行对话。听觉聊天机器人的例子可以是三星Bixby或苹果的Siri，文本聊天机器人可以是telegram或messenger聊天机器人。</p><ul class=""><li id="bcdd" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated">为什么要使用聊天机器人？</li></ul><p id="7366" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">我们举个例子来解释一下。</p><p id="9269" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">假设您在一家电子商务公司的客户支持部门工作，您与一位客户聊天，他问了一个简单的问题，比如“我的订单在哪里？”，现在您可以在系统上手动检查，然后回复给用户。这只是一个例子。然而，客户支持主管不得不在一天中面对同样的问题一百万次，一遍又一遍地回答同样的事情似乎是多余的，就像得到一个查询、在数据库中查找并回复用户一样。如果你想一想，聊天机器人也可以很容易地做到这一点，它可以接收查询，查看数据库并回复，因此人力资源可以被分配到其他更有用的地方。因此，在这种情况下通过聊天机器人实现自动化是有益的。</p><ul class=""><li id="89c4" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated"><strong class="ix hj">它们用在哪里？</strong></li></ul><p id="60e6" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">它们主要用于各种目的的对话系统中，例如提供客户服务或获取信息。聊天机器人可以为任何特定领域开发和实现，例如在电子商务中，你会看到它主要提供订单、支付等方面的支持。</p><ul class=""><li id="28f9" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated"><strong class="ix hj">聊天机器人的问题空间是什么？</strong></li></ul><p id="f2ce" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">聊天机器人的主要任务是为它从用户那里收到的任何查询或消息确定最佳响应。最佳对策应该如下:</p><ol class=""><li id="447e" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kf kc kd ke bi translated">直接准确地回答用户的问题</li></ol><p id="7902" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">2.提供与查询相关的相关信息</p><p id="40ef" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">3.如果问题不明确，询问后续问题，以便更深入地了解问题，从而得出最佳答案</p><ul class=""><li id="7183" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated"><strong class="ix hj">我们的方法是什么？</strong></li></ul><p id="f170" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">我们使用了深度学习，除此之外，还使用了NLP(自然语言处理)、RNN(递归神经网络)和LSTM(长短期记忆)的概念，并最终利用seq2seq模型架构来实现聊天机器人。</p><h1 id="e554" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">入门:Anaconda</h1><ol class=""><li id="eb58" class="jw jx hi ix b iy le jc lf jt lg ju lh jv li js kf kc kd ke bi translated">安装Anaconda</li></ol><div class="lj lk ez fb ll lm"><a href="https://www.anaconda.com/distribution/" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab dw"><div class="lo ab lp cl cj lq"><h2 class="bd hj fi z dy lr ea eb ls ed ef hh bi translated">Anaconda Python/R发行版—免费下载</h2><div class="lt l"><h3 class="bd b fi z dy lr ea eb ls ed ef dx translated">开源的Anaconda发行版是在…上执行Python/R数据科学和机器学习的最简单的方法</h3></div><div class="lu l"><p class="bd b fp z dy lr ea eb ls ed ef dx translated">www.anaconda.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma ik lm"/></div></div></a></div><p id="a49e" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">2.使用Anaconda Shell安装虚拟环境</p><ul class=""><li id="442a" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated">转到开始&gt; Anaconda3 &gt; Anaconda提示符</li><li id="4473" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kb kc kd ke bi translated">运行以下代码行创建一个虚拟环境。-n用于定义虚拟env的名称，并且安装了python 3.5，所以确保安装相同的版本以避免任何问题。</li></ul><pre class="mg mh mi mj fd mk ml mm mn aw mo bi"><span id="dc03" class="mp kh hi ml b fi mq mr l ms mt">conda create -n chatbot python=3.5 anaconda</span></pre><p id="c714" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">3.激活虚拟环境并安装Tensorflow</p><ul class=""><li id="e98c" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated">在Anaconda Navigator中，转到您可以在左侧栏中找到的环境</li><li id="66ca" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kb kc kd ke bi translated">您将在那里找到您的虚拟环境以及属于Anaconda的根虚拟环境，单击您的环境&gt;右键单击&gt;用python终端打开并执行以下代码</li></ul><pre class="mg mh mi mj fd mk ml mm mn aw mo bi"><span id="3b01" class="mp kh hi ml b fi mq mr l ms mt">Activate nameofyourvirtualenvironment</span></pre><ul class=""><li id="3a4e" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated">一旦激活了虚拟env，请严格安装tensor flow 1 . 0 . 0版，因为tf.reset_default_graph等特定函数在以后的版本中已被弃用。</li></ul><pre class="mg mh mi mj fd mk ml mm mn aw mo bi"><span id="17d7" class="mp kh hi ml b fi mq mr l ms mt">pip install tensorflow==1.0.0</span></pre><p id="9f61" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">4.下载康奈尔电影对话语料库数据集</p><div class="lj lk ez fb ll lm"><a href="http://www.cs.cornell.edu/~cristian/Cornell_Movie-Dialogs_Corpus.html" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab dw"><div class="lo ab lp cl cj lq"><h2 class="bd hj fi z dy lr ea eb ls ed ef hh bi translated">康奈尔电影对话语料库</h2><div class="lt l"><h3 class="bd b fi z dy lr ea eb ls ed ef dx translated">这个语料库包含了从原始电影剧本中提取的大量元数据丰富的虚构对话:…</h3></div><div class="lu l"><p class="bd b fp z dy lr ea eb ls ed ef dx translated">www.cs.cornell.edu</p></div></div></div></a></div><h1 id="0b91" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">入门:Spyder</h1><ol class=""><li id="a497" class="jw jx hi ix b iy le jc lf jt lg ju lh jv li js kf kc kd ke bi translated">通过Anaconda导航器启动Spyder IDE</li><li id="924a" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kf kc kd ke bi translated">无论你在哪里下载了数据集，我假设你在桌面上创建了一个名为chatbot的文件夹，所以将数据集文件夹复制到chatbot，然后从数据集文件夹中取出<strong class="ix hj">Movie _ lines</strong>&amp;<strong class="ix hj">Movie _ conversations</strong>文本文件，并将其粘贴到chatbot文件夹中。</li><li id="b4f8" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kf kc kd ke bi translated">通过，spyder IDE通过右上角的资源管理器窗口导航到您的目录，您会发现其他选项，如变量资源管理器等。另外，将python文件保存到这个chatbot目录中。</li></ol><h1 id="e910" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">构建聊天机器人</h1><p id="6295" class="pw-post-body-paragraph iu iv hi ix b iy le ja jb jc lf je jf jt mu ji jj ju mv jm jn jv mw jq jr js hb bi translated"><strong class="ix hj">第一阶段</strong>包括导入必要的库、导入数据集以及为模型的训练阶段预处理数据集。以下是进行数据预处理的步骤:</p><pre class="mg mh mi mj fd mk ml mm mn aw mo bi"><span id="463f" class="mp kh hi ml b fi mq mr l ms mt">### Phase 1: Data Preprocessing ###</span><span id="7bae" class="mp kh hi ml b fi mx mr l ms mt">  # Importing Dataset<br/>  # Creating a dictionary that maps each line with its id<br/>  # Creating a list of all of the conversations<br/>  # Getting questions and answers seperately<br/>  # Simplifying and cleaning the text using Regular Expressions<br/>  # Cleaning questions<br/>  # Cleaning answers<br/>  # Filtering out the questions and answers that are too short or too long<br/>  # Creating a dictionary that maps each word to its number of occurrences<br/>  # Creating two dictionaries that map the words in the questions and the answers to a unique integer<br/>  # Adding the last tokens to above two dictionaries<br/>  # Creating the inverse dictionary of the answers_words_to_int dictionary<br/>  # Adding the &lt;EOS&gt; token to the end of every answer<br/>  # Translating all the questions and the answers into int &amp;    replacing all the words that were filtered out by &lt;OUT&gt; token<br/>  # Sorting questions and answers by the length of questions</span></pre><p id="8d45" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">第二阶段包括构建seq2seq模型来实现我们的聊天机器人。此阶段使用了以下概念:</p><ul class=""><li id="20ba" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated">递归神经网络</li><li id="ec66" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kb kc kd ke bi translated">LSTM(长短期记忆)</li><li id="7105" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kb kc kd ke bi translated">Seq2Seq模型</li><li id="e249" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kb kc kd ke bi translated">优化技术——波束搜索解码器和注意机制</li></ul><pre class="mg mh mi mj fd mk ml mm mn aw mo bi"><span id="b5c3" class="mp kh hi ml b fi mq mr l ms mt">### Phase 2: Building SEQ2SEQ Model ###</span><span id="4a83" class="mp kh hi ml b fi mx mr l ms mt">  # Creating placeholders for the inputs and the targets<br/>  # Preprocessing the targets<br/>  # Creating the Encoder RNN<br/>  # Decoding the training set<br/>  # Decoding the test/validation set<br/>  # Creating the Decoder RNN<br/>  # Building the seq2seq model</span></pre><p id="5255" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated"><strong class="ix hj">第三阶段</strong>包括训练我们在前一阶段构建的seq2seq模型。此阶段使用了以下概念:</p><ul class=""><li id="7415" class="jw jx hi ix b iy iz jc jd jt jy ju jz jv ka js kb kc kd ke bi translated">超参数</li><li id="5a0b" class="jw jx hi ix b iy mb jc mc jt md ju me jv mf js kb kc kd ke bi translated">优化技术— ADAM优化器</li></ul><pre class="mg mh mi mj fd mk ml mm mn aw mo bi"><span id="3368" class="mp kh hi ml b fi mq mr l ms mt">### Phase 3: Training the SEQ2SEQ Model ###</span><span id="8f8e" class="mp kh hi ml b fi mx mr l ms mt">  # Setting the Hyperparameters<br/>  # Defining a session<br/>  # Loading the model inputs<br/>  # Setting the sequence length<br/>  # Getting the shape of the inputs tensor<br/>  # Getting the training and test predictions<br/>  # Setting up the Loss Error, the Optimizer and Gradient Clipping<br/>  # Padding the sequences with the &lt;PAD&gt; token<br/>  # Splitting the data into batches of questions and answers<br/>  # Splitting the questions and answers into training and validation sets<br/>  # Training</span></pre><p id="f95a" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated"><strong class="ix hj">第四阶段</strong>包括建立聊天机器人，然后是培训阶段。</p><pre class="mg mh mi mj fd mk ml mm mn aw mo bi"><span id="f29d" class="mp kh hi ml b fi mq mr l ms mt">### Phase 4: Testing The Seq2Seq Model ###<br/>  <br/>  # Loading the weights and Running the session<br/>  # Converting the questions from strings to lists of encoding integers<br/>  # Setting up the chat</span></pre><h1 id="af21" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结果</h1><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es my"><img src="../Images/a2fd0e20e426f50c99960b5c2c64d55a.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*xNrzvmWFx7rKTXFXu5V4Aw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">我和聊天机器人的第一次对话</figcaption></figure><p id="8a6e" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">如你所见，回复是不恰当的。原因是缺乏训练。我们将4200个示例的数据集分成100个一批，因此，完成一个时期需要42次迭代。所以，我训练了15个时期的模型，结果就在你面前，这还不够。也许，训练阶段可以通过进一步微调超参数或简单地为更多的时期进行训练来改进。</p><p id="7f46" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated">为了训练模型，我使用了谷歌Colab，因为它为你提供了一个Nvidia Tesla K80以及12GB的RAM，在虚拟环境中最多可以免费使用12个小时。关于如何在google colab中训练你的模型，我已经在我的GitHub repo中提供了步骤。</p><div class="lj lk ez fb ll lm"><a href="https://github.com/adi2381/ai-chatbot" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab dw"><div class="lo ab lp cl cj lq"><h2 class="bd hj fi z dy lr ea eb ls ed ef hh bi translated">ADI 2381/ai-聊天机器人</h2><div class="lt l"><h3 class="bd b fi z dy lr ea eb ls ed ef dx translated">这是一个使用Seq2Seq模型构建聊天机器人的尝试。该模型基于两个LSTM层。Seq2Seq主要是…</h3></div><div class="lu l"><p class="bd b fp z dy lr ea eb ls ed ef dx translated">github.com</p></div></div></div></a></div><h1 id="1a64" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="15cf" class="pw-post-body-paragraph iu iv hi ix b iy le ja jb jc lf je jf jt mu ji jj ju mv jm jn jv mw jq jr js hb bi translated">聊天机器人是人工智能的一个重要应用，聊天机器人行业目前正在蓬勃发展，顶级公司在其最新设备中使用聊天机器人，如亚马逊的Alexa或三星的Bixby。聊天机器人领域仍然具有挑战性，例如如何改进答案，以及选择最佳模型，根据查询生成最合适的答案等等。在这篇文章中，我们只尝试了seq2seq架构的一种变体，并结合特定的优化技术来构建我们的聊天机器人。我希望你喜欢这篇文章，它激起了你对聊天机器人的兴趣。</p><h1 id="20d8" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">大声喊出来</h1><p id="2fb8" class="pw-post-body-paragraph iu iv hi ix b iy le ja jb jc lf je jf jt mu ji jj ju mv jm jn jv mw jq jr js hb bi translated">这一部分致力于互联网上关于聊天机器人开发的令人惊叹的教程和文章，它们对我构建聊天机器人帮助很大。我特别遵循了这些:</p><p id="3af2" class="pw-post-body-paragraph iu iv hi ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hb bi translated"><strong class="ix hj"> * </strong>为你的聊天机器人利用NLP &amp;机器学习的终极指南—斯特凡·科茹哈罗夫<br/>(<a class="ae iq" href="https://chatbotslife.com/ultimate-guide-to-leveraging-nlp-machine-learning-for-you-chatbot-531ff2dd870c" rel="noopener ugc nofollow" target="_blank">https://chatbotslife . com/Ultimate-Guide-to-leveling-NLP-Machine-Learning-for-you-Chatbot-531 ff 2 DD 870 c</a>)<br/><strong class="ix hj">*</strong>seq 2 seq机器学习模型—马尼·瓦德瓦(GeeksforGeeks)<br/>(<a class="ae iq" href="https://www.geeksforgeeks.org/seq2seq-model-in-machine-learning/" rel="noopener ugc nofollow" target="_blank">https://1</a></p></div></div>    
</body>
</html>