<html>
<head>
<title>Understanding Regression Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解回归模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-regression-models-c9ac4f2184dc?source=collection_archive---------9-----------------------#2020-11-26">https://medium.com/analytics-vidhya/understanding-regression-models-c9ac4f2184dc?source=collection_archive---------9-----------------------#2020-11-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c0a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用 SKlearn 创建线性，岭，套索回归模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ce04e8dfa370748fc96739779120aeaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*79ZrT0ws1pRBgkcP"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">马库斯·温克勒在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="b7bb" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">什么是线性回归？</h1><p id="7274" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">线性回归来自一条直线的方程，y=mx+c，其中 y 是因变量，它随 x 而变化，x 是自变量。c 是 y 轴截距，m 是斜率。在 ML 术语中，系数 x 是权重，y 是截距或 c 是偏差。“m”和“c”是我们的机器将尝试学习的变量。</p><p id="3225" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将看到如何使用 scikit-learn 来执行不同类型的回归，如线性、脊形、套索等。为了开始，让我们首先导入所需的库。</p><h1 id="3267" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">导入所需的库</h1><p id="ddfb" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将从导入 pandas 来加载我们需要的数据集开始，我们将使用 matplotlib 和 seaborn 进行可视化，类似地，我们将在需要时从 scikit-learn 导入回归模型。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="9d0b" class="lc jv hi ky b fi ld le l lf lg">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span></pre><h1 id="9376" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">正在加载所需的数据集</h1><p id="9ed7" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们这里要使用的数据集是波士顿数据集，可以很容易地从 Kaggle 下载。该数据集包含房价的中值以及房价所依赖的所有要素。让我们加载数据集，看看它有哪些不同的列。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="b012" class="lc jv hi ky b fi ld le l lf lg">df = pd.read_csv("C:/Users/DELL/boston.csv")<br/>df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/959a5235ebc1fe7140e96731214283ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PF7WjWmsZ-ueaj4G7euogw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">波士顿数据集(来源:作者)</figcaption></figure><h1 id="3c8a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">执行数据分析</h1><p id="c6af" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了准备机器学习的数据集，我们需要对数据集执行一些基本的数据分析。我们将开始删除任何不必要的列，如“未命名:0 ”,正如我们在上面的图像中看到的。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="f137" class="lc jv hi ky b fi ld le l lf lg">df.drop('Unnamed: 0', axis=1,inplace=True)</span></pre><p id="61b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们使用数据框的描述功能来查看数据集的一些统计属性。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="1dbb" class="lc jv hi ky b fi ld le l lf lg">df.describe()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/83746bbcb7f326a9bb6f0f5977dde93a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7kOqT9vSYgY5yebeCmP8Wg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">统计属性(来源:作者)</figcaption></figure><p id="1406" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们想象一下我们的目标变量“MEDV”与所有其他特征变量之间的关系。为此，我们将使用 matplotlib 和 seaborn。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="c750" class="lc jv hi ky b fi ld le l lf lg">plt.figure(figsize=(15,30))<br/>cnt=1<br/>for i in df.columns[:-1]:<br/>    plt.subplot(10,3,cnt)<br/>    sns.regplot(x=df[i],y=df['medv'], color = 'green')<br/>    cnt=cnt+1<br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lj"><img src="../Images/41e8a2c2883f35e051843a45d76ca3ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bSiWIRGqpgNaMhZpMHW84w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">回归图可视化(来源:作者)</figcaption></figure><p id="e05c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分析完所有这些之后，我们可以开始建模过程了。为此，我们需要将数据集分为测试数据集和训练数据集，还需要从 sklearn 导入模型。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="f739" class="lc jv hi ky b fi ld le l lf lg">from sklearn.model_selection import train_test_split</span><span id="db44" class="lc jv hi ky b fi lk le l lf lg"><br/>#Splitting the dataset<br/>X_train, X_test, y_train, y_test =  train_test_split(df[['crim','zn','indus','chas', 'nox','rm','age','dis','rad','tax','ptratio','black','lstat']], df['medv'], test_size=0.3, random_state=109)</span><span id="7c3b" class="lc jv hi ky b fi lk le l lf lg">#Importing Regression Models<br/>from sklearn.linear_model import LinearRegression, Ridge, Lasso</span></pre><h1 id="80ac" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">线性回归模型</h1><p id="766b" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将首先创建一个线性回归模型，并将数据拟合到其中。为了知道我们的模型有多精确，我们将找到测试数据的模型分数。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="86ec" class="lc jv hi ky b fi ld le l lf lg">linreg = LinearRegression()<br/>linreg.fit(X_train, y_train)<br/>print("Coefficients: ", linreg.coef_)<br/>print("Intercept: ", linreg.intercept_) #y intercept</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/42ed3c705f58ac2b9e15b54c02d669af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9EjqlsrmisHGXRC8RY3fHA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">模型系数(来源:作者)</figcaption></figure><p id="7d01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们使用模型得分来检查模型的准确性。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="a4ea" class="lc jv hi ky b fi ld le l lf lg">print("Accuracy score for training Data", linreg.score(X_train, y_train))<br/>print("Accuracy score for testing Data", linreg.score(X_test, y_test))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/7cf8d01d77d06ee4265faf42598ebde6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*c14NQE1_LVZi5TWgFoevuA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">准确性(来源:作者)</figcaption></figure><p id="4e55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，我们也可以使用脊和套索模型进行回归。</p><h1 id="d618" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">套索和岭回归</h1><p id="2a6e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在线性回归中，如果我们有大量的预测变量，并且这些预测变量彼此高度相关，那么我们可以说我们的模型遇到了较大的方差，使得模型不可靠。</p><p id="7b02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了克服这个问题，我们使用正则化技术。岭回归是一种旨在使用 l2 罚分(系数的平方和)减小系数大小的技术，而 Lasso 回归使用 l1 罚分(系数的绝对值)。</p><h1 id="bc18" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">创建 Lasso 回归模型</h1><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="767d" class="lc jv hi ky b fi ld le l lf lg">lassoreg = Lasso()<br/>lassoreg.fit(X_train, y_train)<br/>print("Accuracy score for training data", lassoreg.score(X_train,y_train))<br/>print("Accuracy score for test Data", lassoreg.score(X_test,y_test))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ln"><img src="../Images/40924fb5e8422c1d86ff92d73e1b98de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*MZOpVmSy-ztRVi29OlFE4Q.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">准确性(来源:作者)</figcaption></figure><h1 id="9e82" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">创建岭回归模型</h1><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="97b0" class="lc jv hi ky b fi ld le l lf lg">ridgereg = Ridge()<br/>ridgereg.fit(X_train, y_train)<br/>print("Accuracy score for training data", ridgereg.score(X_train,y_train))<br/>print("Accuracy score for test Data", ridgereg.score(X_test,y_test))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lo"><img src="../Images/3f60b9ef8b567b3ab413230040a6673c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*I6yX5YQ4gOBQ_t-072P5Yg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">准确性(来源:作者)</figcaption></figure><p id="264e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们看到了如何创建不同的回归模型，并使用模型得分检查它们的准确性。继续尝试，如果你发现任何困难，请在回复部分告诉我。</p><h1 id="8c9b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">在你走之前</h1><p id="cc46" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><strong class="ih hj"> <em class="lp">感谢</em> </strong> <em class="lp">的阅读！如果你想与我取得联系，请随时通过 ipsitashee4@gmail.com 联系我或我的</em> <a class="ae jt" href="http://www.linkedin.com/in/ipsita-shee-764220191" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="lp"> LinkedIn 个人资料</em> </strong> </a> <em class="lp">。可以查看我的</em><a class="ae jt" href="https://github.com/Ipsita-Shee/Regression-Analysis" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="lp">Github</em></strong></a><em class="lp">简介不同的数据科学项目和包教程。</em></p></div></div>    
</body>
</html>