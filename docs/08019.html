<html>
<head>
<title>How to create a stock correlation matrix in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在python中创建股票相关性矩阵</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-create-a-stock-correlation-matrix-in-python-4f32f8cb5b50?source=collection_archive---------1-----------------------#2020-07-15">https://medium.com/analytics-vidhya/how-to-create-a-stock-correlation-matrix-in-python-4f32f8cb5b50?source=collection_archive---------1-----------------------#2020-07-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="30c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我将带你通过一个简单的方法来相互关联各种股票。我们将使用python获取所选股票的价格，将它们放入一个干净的数据框架中，运行相关性，并可视化我们的结果。</p><ol class=""><li id="3d1a" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">导入库</strong></li></ol><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="6151" class="jv jw hi jr b fi jx jy l jz ka">import numpy as np <br/>import pandas as pd <br/># Used to grab the stock prices, with yahoo <br/>import pandas_datareader as web <br/>from datetime import datetime <br/># To visualize the results <br/>import matplotlib.pyplot as plt import seaborn</span></pre><p id="2f32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。选择报价机列表并选择日期范围</strong></p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="d07c" class="jv jw hi jr b fi jx jy l jz ka">start = datetime(2017, 1, 1)<br/>symbols_list = ['AAPL', 'F', 'TWTR', 'FB', 'AAL', 'AMZN', 'GOOGL', 'GE', 'TSLA', 'IBM', 'PYPL']</span><span id="34ad" class="jv jw hi jr b fi kb jy l jz ka">#array to store prices<br/>symbols=[]</span></pre><p id="224a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。拉动股价，推进干净的数据框架</strong></p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="ed55" class="jv jw hi jr b fi jx jy l jz ka">#array to store prices<br/>symbols=[]<br/>for ticker in symbols_list:     <br/>    r = web.DataReader(ticker, 'yahoo', start)   <br/>    # add a symbol column   <br/>    r['Symbol'] = ticker    <br/>    symbols.append(r)</span><span id="1773" class="jv jw hi jr b fi kb jy l jz ka"># concatenate into df<br/>df = pd.concat(symbols)<br/>df = df.reset_index()<br/>df = df[['Date', 'Close', 'Symbol']]<br/>df.head()<br/>df_pivot=df.pivot('Date','Symbol','Close').reset_index()<br/>df_pivot.head()</span></pre><p id="ed0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。现在，我们可以进行关联。使用熊猫的“corr”函数计算每对股票之间的皮尔逊相关系数</strong></p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="e94a" class="jv jw hi jr b fi jx jy l jz ka">corr_df = df_pivot.corr(method='pearson')<br/>#reset symbol as index (rather than 0-X)<br/>corr_df.head().reset_index()<br/>#del corr_df.index.name<br/>corr_df.head(10)</span></pre><p id="c38c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。最后，我们可以绘制相关性的热图(使用Seaborn和Matplotlib)来更好地可视化结果:</strong></p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="185e" class="jv jw hi jr b fi jx jy l jz ka">plt.figure(figsize=(13, 8))<br/>seaborn.heatmap(corr_df, annot=True, cmap=’RdYlGn’)<br/>plt.figure()</span></pre><figure class="jm jn jo jp fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kc"><img src="../Images/7b81418f23cc05a1cb56074fc5331bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6eVH52Cp2RZ-z2AxhxH74w.png"/></div></div></figure></div></div>    
</body>
</html>