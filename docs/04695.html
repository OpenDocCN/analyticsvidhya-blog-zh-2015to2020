<html>
<head>
<title>Build a Flask web app by scraping a website &amp; display the data using Chart.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过抓取网站构建Flask web应用程序，并使用Chart.js显示数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-a-flask-web-app-by-scraping-a-website-display-the-data-using-chart-js-bd0c97397967?source=collection_archive---------8-----------------------#2020-03-29">https://medium.com/analytics-vidhya/build-a-flask-web-app-by-scraping-a-website-display-the-data-using-chart-js-bd0c97397967?source=collection_archive---------8-----------------------#2020-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="09b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我如何使用Flask用Python创建了一个web应用程序，该应用程序抓取<a class="ae jd" href="https://www.mohfw.gov.in/" rel="noopener ugc nofollow" target="_blank">卫生部&amp;家庭福利</a>网站，并显示印度各州冠状病毒的统计数据。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/46ca9fbeae2bf830774f89da0dae8a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9cMZF58LNrX_xE1yXe0ANw.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">在<a class="ae jd" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae jd" href="https://unsplash.com/@visuals?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">视觉效果</a>拍摄的照片</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="6ec4" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">介绍</h1><p id="8ff4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">由于整个世界都受到冠状病毒的控制，让我们自己了解最新的统计数据是相当重要的。考虑到这一点，我决定使用<strong class="ih hj"> Python，Flask &amp; Chart.js </strong>构建一个网络应用程序，它将从卫生部&amp;家庭福利网站&amp;提取数据，并以丰富多彩的交互式图表形式显示这些信息。在这篇文章中，我将向你展示我是如何构建这个应用程序的。</p><p id="94c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以从我的GitHub库中获取完整的代码。</p><div class="le lf ez fb lg lh"><a href="https://github.com/shashank-ssriva/India-COVID-19-Stats" rel="noopener  ugc nofollow" target="_blank"><div class="li ab dw"><div class="lj ab lk cl cj ll"><h2 class="bd hj fi z dy lm ea eb ln ed ef hh bi translated">沙尚-斯里瓦/印度-新冠肺炎-统计</h2><div class="lo l"><h3 class="bd b fi z dy lm ea eb ln ed ef dx translated">在GitHub上创建一个帐户，为shasha NK-ss Riva/India-新冠肺炎-Stats的发展做出贡献。</h3></div><div class="lp l"><p class="bd b fp z dy lm ea eb ln ed ef dx translated">github.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv jo lh"/></div></div></a></div><p id="b758" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经Dockerised &amp;然后部署到Heroku的应用程序。请访问下面的URL查看实时应用程序。</p><h2 id="b3e3" class="lw kc hi bd kd lx ly lz kh ma mb mc kl iq md me kp iu mf mg kt iy mh mi kx mj bi translated"><a class="ae jd" href="https://india-covid-stats.herokuapp.com/#" rel="noopener ugc nofollow" target="_blank">https://india-covid-stats.herokuapp.com/</a></h2><blockquote class="mk ml mm"><p id="4578" class="if ig mn ih b ii ij ik il im in io ip mo ir is it mp iv iw ix mq iz ja jb jc hb bi translated">在我接下来的文章中，我将向你展示如何在Heroku上建立一个Flask web应用程序并部署它。</p></blockquote></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="8f0b" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">使用的工具/技术</h1><ol class=""><li id="390e" class="mr ms hi ih b ii kz im la iq mt iu mu iy mv jc mw mx my mz bi translated"><strong class="ih hj">Python</strong>3 . 7 . 6——Web-app的后端。</li><li id="2fe3" class="mr ms hi ih b ii na im nb iq nc iu nd iy ne jc mw mx my mz bi translated"><strong class="ih hj"> BeautifulSoup </strong> —从网站上抓取信息。</li><li id="cd43" class="mr ms hi ih b ii na im nb iq nc iu nd iy ne jc mw mx my mz bi translated">Python的网络开发框架</li><li id="bedb" class="mr ms hi ih b ii na im nb iq nc iu nd iy ne jc mw mx my mz bi translated"><strong class="ih hj"> Chart.js </strong> —将信息显示为漂亮、丰富多彩的交互式图表。</li></ol><h1 id="b4ac" class="kb kc hi bd kd ke nf kg kh ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky bi translated">网络应用截图</h1><p id="cbae" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">下面是完成后的web应用程序的样子(<em class="mn">这是一个全屏截图</em>)。如上所述，你可以在<a class="ae jd" href="https://india-covid-stats.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://india-covid-stats.herokuapp.com/</a>观看应用直播。这些图表是交互式的&amp;您可以将光标悬停在图表上以获取更多信息。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es nk"><img src="../Images/ef748f2458c13d9c6c2524e1e43b5541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FwGiev8rX_oxbpE3jpIKRQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><a class="ae jd" href="https://india-covid-stats.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://india-covid-stats.herokuapp.com/</a></figcaption></figure><h1 id="e5fe" class="kb kc hi bd kd ke nf kg kh ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky bi translated">项目结构</h1><p id="78d4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">由于这是一个Flask项目，我们需要为我们的应用程序维护一个特定的目录结构。下面是项目框架。</p><p id="9f14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我正在<em class="mn">排除</em>非重要文件&amp;目录。</p><pre class="jf jg jh ji fd nl nm nn no aw np bi"><span id="59dc" class="lw kc hi nm b fi nq nr l ns nt">root@shashank-mbp /U/a/D/CoronaVirus-Status-India# ls -lh<br/>-rw-r--r--   1 root  staff   2.6K Mar 29 11:42 app.py<br/>-rw-r--r--   1 root  staff   121B Mar 27 19:12 requirements.txt<br/>drwxr-xr-x   5 root  staff   160B Mar 27 09:26 static<br/>drwxr-xr-x   3 root  staff    96B Mar 28 22:52 templates</span><span id="6fdf" class="lw kc hi nm b fi nu nr l ns nt">root@shashank-mbp /U/a/D/CoronaVirus-Status-India# tree static templates<br/>static<br/>├── css<br/>│   ├── dashboard.css<br/>│   ├── uikit-rtl.css<br/>│   ├── uikit-rtl.min.css<br/>│   ├── uikit.css<br/>│   └── uikit.min.css<br/>├── img<br/>│   └── shashank-srivastava.jpeg<br/>└── js<br/>    ├── chartScripts.js<br/>    ├── uikit-icons.js<br/>    ├── uikit-icons.min.js<br/>    ├── uikit.js<br/>    └── uikit.min.js<br/>templates<br/>└── index.html</span></pre><h1 id="2106" class="kb kc hi bd kd ke nf kg kh ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky bi translated">执行的步骤</h1><h2 id="22fd" class="lw kc hi bd kd lx ly lz kh ma mb mc kl iq md me kp iu mf mg kt iy mh mi kx mj bi translated"><strong class="ak"> 1。安装了</strong>所需的Python模块</h2><p id="6bc7" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">为此，我用下面的内容&amp;创建了一个<code class="du nv nw nx nm b">requirements.txt</code>文件，并用<code class="du nv nw nx nm b">pip</code>执行它。</p><pre class="jf jg jh ji fd nl nm nn no aw np bi"><span id="7ed2" class="lw kc hi nm b fi nq nr l ns nt">pytest<br/>flake8<br/>python-dateutil<br/>coverage<br/>bs4<br/>click<br/>coverage<br/>Flask<br/>itsdangerous<br/>Jinja2<br/>MarkupSafe<br/>requests<br/>Werkzeug<br/>selenium</span></pre><p id="cb2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du nv nw nx nm b">pip</code>在行动。</p><pre class="jf jg jh ji fd nl nm nn no aw np bi"><span id="e9b7" class="lw kc hi nm b fi nq nr l ns nt">root@shashank-mbp /U/a/D/CoronaVirus-Status-India# pip install -r requirements.txt</span></pre><h2 id="39df" class="lw kc hi bd kd lx ly lz kh ma mb mc kl iq md me kp iu mf mg kt iy mh mi kx mj bi translated">2.<strong class="ak">刮过</strong>卫生部&amp;家庭福利的网站获取数据。</h2><p id="b5c4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">然后，我创建了各种Python列表来获取我需要的值。为此，我创建了一个名为<code class="du nv nw nx nm b">app.py</code>的文件。</p><pre class="jf jg jh ji fd nl nm nn no aw np bi"><span id="a8da" class="lw kc hi nm b fi nq nr l ns nt"><a class="ae jd" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/', methods=['POST', 'GET'])<br/>def main():<br/>    def extract_contents(row): return [x.text.replace('\n', '') for x in row]<br/>    URL = '<a class="ae jd" href="https://www.mohfw.gov.in/'" rel="noopener ugc nofollow" target="_blank">https://www.mohfw.gov.in/'</a><br/>    response = requests.get(URL).content<br/>    soup = BeautifulSoup(response, 'html.parser')<br/>    table = soup.find('div', {'id': 'cases'})<br/>    state_wise_stats = []<br/>    all_rows = table.find_all('tr')<br/>    for row in all_rows:<br/>        stat = extract_contents(row.find_all('td'))<br/>        if stat:<br/>            if len(stat) == 5:<br/>                # last row<br/>                stat = ['', *stat]<br/>                state_wise_stats.append(stat)<br/>            elif len(stat) == 6:<br/>                state_wise_stats.append(stat)</span></pre><blockquote class="mk ml mm"><p id="5ae9" class="if ig mn ih b ii ij ik il im in io ip mo ir is it mp iv iw ix mq iz ja jb jc hb bi translated">由于这篇文章不是向你展示代码是如何工作的，我将跳过这一部分。我在这里的目的是告诉我如何写网络应用程序。您可以检查代码，看看我是如何获得要在图表中使用的值的。</p></blockquote><h2 id="24c2" class="lw kc hi bd kd lx ly lz kh ma mb mc kl iq md me kp iu mf mg kt iy mh mi kx mj bi translated">3.<strong class="ak">使用Chart.js创建了</strong>图表</h2><p id="6842" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Chart.js是一个很棒的图表库，它有漂亮的图表，而且创建起来没有什么困难。</p><p id="37e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我提取了所有的值，比如印度确诊的冠状病毒病例数，我就在我的T4页面中用这些值绘制了图表。</p><p id="8353" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个如何使用Chart.js创建饼图的例子。</p><pre class="jf jg jh ji fd nl nm nn no aw np bi"><span id="1bca" class="lw kc hi nm b fi nq nr l ns nt">&lt;!-- panel --&gt;<br/>    &lt;div class="uk-width-1-1"&gt;<br/>    &lt;div class="uk-card-body"&gt;<br/>    &lt;div class="chart-container"&gt;<br/>     &lt;canvas id="pie-chart" width="1200" height="600" style="display: block; height: 300px; width: 600px;"&gt;&lt;/canvas&gt;<br/>     &lt;script&gt;<br/>     var chartData = {<br/>      labels: ['Confirmed cases', 'Deaths', 'Cured/Discharged'],<br/>       datasets: [{<br/>        label: 'Pie chart',<br/>        data: [{{ total_cases }}, {{ total_casualties }}, {{ num_people_cured }}],<br/>         spanGaps: false,<br/>         backgroundColor: ['orange', 'red', '#90EE90' ],<br/>        }]<br/>       }<br/>       // get chart canvas<br/>       var ctx = document.getElementById("pie-chart").getContext("2d");<br/>       // create the chart using the chart canvas<br/>       var myChart = new Chart(ctx, {<br/>        type: 'pie',<br/>        data: chartData,<br/>        options: {<br/>         title: {<br/>          display: true,<br/>          text: 'Data at a glance',<br/>         }<br/>        }<br/>       });<br/>       &lt;/script&gt;<br/>      &lt;/div&gt;<br/>     &lt;/div&gt;<br/>    <br/>   &lt;/div&gt;<br/>&lt;!-- /panel --&gt;</span></pre><h2 id="72b6" class="lw kc hi bd kd lx ly lz kh ma mb mc kl iq md me kp iu mf mg kt iy mh mi kx mj bi translated">4.把这些放在一起。</h2><p id="86e1" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">一旦我的代码准备好了，我只需要执行下面的命令来启动我的web应用程序。请去我的GitHub库获取完整的代码。</p><pre class="jf jg jh ji fd nl nm nn no aw np bi"><span id="032f" class="lw kc hi nm b fi nq nr l ns nt">root@shashank-mbp /U/a/D/CoronaVirus-Status-India# python3 app.py<br/> * Running on <a class="ae jd" href="http://0.0.0.0:5002/" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:5002/</a> (Press CTRL+C to quit)</span></pre></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="61ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这标志着这篇文章的结束。我希望它能增长见识。</p></div></div>    
</body>
</html>