<html>
<head>
<title>Hello World COVID-19 live Visualization using COVID19 API and Geographic Choropleth Maps in Python Using Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用COVID19 API的Hello World新冠肺炎直播可视化和使用Plotly的Python地理Choropleth地图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hello-world-covid19-visualization-eb6736e1dec?source=collection_archive---------12-----------------------#2020-04-17">https://medium.com/analytics-vidhya/hello-world-covid19-visualization-eb6736e1dec?source=collection_archive---------12-----------------------#2020-04-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f3ce" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">想象新冠肺炎的爆发</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/e9babf68754b16a6c4f7743b4c3ae0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*qEc_eDLXlSHekXimGiW_8Q.gif"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><strong class="bd jj">新冠肺炎确诊病例总数</strong></figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/b57c7057c27c59b16359063ba191e8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*jnmIzbukkbbSBZI-tffPdg.gif"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><strong class="bd jj">新冠肺炎死亡总数</strong></figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/7ca990583ef0a5429b8940998b164ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*1G61V2T08MuYFoqU8Ue6Bw.gif"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><strong class="bd jj">新冠肺炎完全康复</strong></figcaption></figure><h2 id="ae2f" class="jk jl hi bd jj jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated"><strong class="ak">简介:</strong></h2><p id="afe8" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">我是一名数据科学和机器学习爱好者。希望我没有在这里写意大利面条代码…！</p><p id="88eb" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">这里我们可以通过plotly交互式地可视化新冠肺炎疫情。只有通过数据可视化，才能更好地吸收信息。因此，可视化在数据表示中是最重要的。</p><p id="2113" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">让我们进入主题…..</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h2 id="71ca" class="jk jl hi bd jj jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">进口:</h2><p id="f8ca" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">我们将从导入创建可视化所需的所有模块开始。</p><p id="5d80" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">此处，数据收集通过API完成，因此'<em class="lm"> urllib3，请求'</em>'被导入，对于绘图' plotly '导入是必需的，对于数据存储和访问' csv '和' pandas '被导入。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="0126" class="jk jl hi lo b fi ls lt l lu lv">import urllib3<br/>import csv<br/>import requests<br/>import plotly as py<br/>import plotly.graph_objs as go<br/>from plotly.offline import download_plotlyjs,init_notebook_mode, plot, iplot<br/>init_notebook_mode(connected=True)<br/>import pandas as pd</span></pre></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lw"><img src="../Images/e83cefa6145167f8724b747c4a68bcdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*chLk5-PujzZmirhz.png"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">你不必重新发明轮子。</figcaption></figure><p id="337c" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">获取数据的方式有很多，我们可以通过<strong class="kj hj"> web抓取、</strong><a class="ae lx" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"><strong class="kj hj">ka ggle</strong></a><strong class="kj hj">、API的</strong>来获取。但是这里我们通过一个API ( <a class="ae lx" href="https://api.covid19api.com/summary" rel="noopener ugc nofollow" target="_blank">这里</a>)。首先，我通过kaggle数据集构建了这个，而不是我朋友建议的API。为什么呢..自己去发现😜…为什么？因为如果我们使用数据集，我们不必重新发明轮子，我们需要每次都更新数据集，而不是我们可以使用API，通过API我们可以获得实时更新的数据。</p><h2 id="e848" class="jk jl hi bd jj jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">要从API获取数据:</h2><p id="4384" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">用<strong class="kj hj">请求</strong>发出请求，<strong class="kj hj"> r </strong>是我们的响应对象。我们可以从这个物体中得到我们需要的所有信息。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="45ea" class="jk jl hi lo b fi ls lt l lu lv">href = "<a class="ae lx" href="https://api.covid19api.com/summary" rel="noopener ugc nofollow" target="_blank">https://api.covid19api.com/summary</a>"<br/>r = requests.get(href)<br/>json_data = r.json()</span></pre><p id="5530" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">JSON数据看起来像</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ly"><img src="../Images/f71800ad9b38a9153fef882bda4fd553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zag2tkkjL9yN6VWB6w110g.jpeg"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">通过API的JSON数据</figcaption></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><p id="0b57" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">这里我们将json复制到csv文件，因为它易于操作和使用。writerow模块用于写入行，我们迭代通过<strong class="kj hj"><em class="lm">JSON _ data[' Countries ']</em></strong>来获取<em class="lm"> Country，CountryCode，NewConfirmed，TotalConfirmed，NewDeaths，TotalDeaths，NewRecovered，TotalRecovered，Date。</em></p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="391f" class="jk jl hi lo b fi ls lt l lu lv">fname = "output.csv"</span><span id="5724" class="jk jl hi lo b fi md lt l lu lv">with open(fname,"w") as file:<br/>    csv_file = csv.writer(file)<br/>    csv_file.writerow(["Country","CountryCode","NewConfirmed","TotalConfirmed"<br/>                       ,"NewDeaths","TotalDeaths","NewRecovered","TotalRecovered","Date"])<br/>    for item in json_data['Countries']:<br/>        csv_file.writerow([item['Country'],item['CountryCode'],                           <br/>                           item['NewConfirmed'],item['TotalConfirmed'],<br/>                           item['NewDeaths'],item['TotalDeaths'],item['NewRecovered'],<br/>                   item['TotalRecovered'],item['Date']])</span><span id="6fe0" class="jk jl hi lo b fi md lt l lu lv">df= pd.read_csv("outputbyJSON.csv",encoding='ISO-8859-1')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es me"><img src="../Images/c17071ea014f1488344937cfdcbb05f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9o95ao6jFSPXwNIV1_WUuw.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">资料组</figcaption></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="af84" class="mf jl hi bd jj mg mh mi jp mj mk ml jt io mm ip jx ir mn is kb iu mo iv kf mp bi translated"><strong class="ak">地理绘图</strong></h1><p id="bcfc" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">地图是使用我们导入的Plotly的graph_objs模块绘制的。它需要两个必须作为参数传递的重要参数，即数据和布局。这些参数中的每一个都包含一个参数和自变量的字典。</p><h2 id="526c" class="jk jl hi bd jj jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">初始化数据变量。</h2><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="cdf0" class="jk jl hi lo b fi ls lt l lu lv"><br/>data = dict(type = 'choropleth',<br/>           locations = df['Country'],<br/>            locationmode = 'country names',<br/>            z = df['TotalConfirmed'],<br/>            text = df['Country'],<br/>            colorscale= 'agsunset',<br/>            reversescale = False,<br/>            marker = dict(line = dict(color='white',width=1)),<br/>            <br/>            colorbar = {'title':'members'}<br/>           )</span></pre><blockquote class="mq mr ms"><p id="523d" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">类型:“choropleth”指定我们正在绘制choropleth地图。</p><p id="83f6" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">位置:我们要绘制的国家的名称。</p><p id="0f53" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">locationmode:它指定绘图级别是国家级的。该值可以是以下三个值之一:“ISO-3”、“美国-州”、“国家名称”。</p><p id="4d23" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">colorscale:用于绘制地图的颜色集。可用的色标有“灰色”、“YlGnBu”、“绿色”、“YlOrRd”、“蓝色”、“RdBu”、“红色”、“蓝色”、“野餐”、“彩虹”、“波特兰”、“喷气机”、“热”、“黑体”、“地球”、“电”、“绿色”、“公民”</p><p id="7565" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">text:悬停时需要为每个国家显示的文本信息。</p><p id="a3df" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">z:用于区分国家/地区的值或因子。色标使用这些值。</p><p id="202d" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">colorbar:用于定制colorbar显示的参数和自变量的字典。用于控制颜色条的属性，如长度、标题、轴等。</p></blockquote><h2 id="83d6" class="jk jl hi bd jj jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">初始化布局变量。</h2><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="0b7d" class="jk jl hi lo b fi ls lt l lu lv">layout = dict(title = 'World wide #TotalConfirmed# covid19 cases',<br/>             geo = dict(showframe = False,<br/>                       projection = {'type':"miller"})<br/>             )</span></pre><blockquote class="mq mr ms"><p id="d821" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">geo:该参数设置地图布局的属性。scope参数设置地图的范围。范围可以有7个值中的任何一个-"世界" | "美国" | "欧洲" | "亚洲" | "非洲" | "北美" | "南美"。</p><p id="d380" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated"><strong class="kj hj">使用的投影类型:</strong></p><p id="76c7" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">完全确认— →“自然地球”</p><p id="2437" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">总死亡数— →“正投影”</p><p id="164c" class="kh ki lm kj b kk la ij km kn lb im kp mt lc kr ks mu ld ku kv mv le kx ky kz hb bi translated">对于完全恢复—→“moll weide”</p></blockquote><h2 id="09cd" class="jk jl hi bd jj jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">通过将数据和布局作为参数传递来初始化Figure对象。</h2><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="c731" class="jk jl hi lo b fi ls lt l lu lv">choromap = go.Figure(data=[data],layout=layout)</span></pre><h2 id="6686" class="jk jl hi bd jj jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">绘制地图。</h2><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="4e62" class="jk jl hi lo b fi ls lt l lu lv">#to plot inline<br/>iplot(choromap)<br/></span><span id="98e0" class="jk jl hi lo b fi md lt l lu lv">#to generate a output file<br/>plot(choromap,validate=False,filename='TotalConfirmed.html')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/280c7c67193701eb675175e9d1e0b33f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*0ZgfAfRX1R7X7oEa4A237w.gif"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">新冠肺炎确诊病例总数</figcaption></figure><p id="871c" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我们需要更改数据对象中的“<strong class="kj hj"> Z </strong>”因子，以获得总死亡数和总恢复数，图表显示在顶部。</p><h1 id="e0fe" class="mf jl hi bd jj mg mw mi jp mj mx ml jt io my ip jx ir mz is kb iu na iv kf mp bi translated">您可以从以下网址获得来源</h1><p id="c733" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">GitHub—→<a class="ae lx" href="https://github.com/Mogileeswaran/COVID19-Visualization-using-Geographic-Choropleth-Maps-in-Python-Using-Plotly.git" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Mogileeswaran/covid 19-Visualization-Using-Geographic-Choropleth-Maps-in-Python-Using-plotly . git</a></p><h1 id="0644" class="mf jl hi bd jj mg mw mi jp mj mx ml jt io my ip jx ir mz is kb iu na iv kf mp bi translated">联系人:</h1><p id="6041" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">insta gram—→<a class="ae lx" href="https://www.instagram.com/mogileeswaran_m/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/mogileeswar_rockzz/</a></p><p id="2e50" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">GitHub—→<a class="ae lx" href="https://github.com/Mogileeswaran" rel="noopener ugc nofollow" target="_blank">https://github.com/Mogileeswaran</a></p><p id="b7ef" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">推特—→<a class="ae lx" href="https://twitter.com/mogileeswaran_m" rel="noopener ugc nofollow" target="_blank">https://twitter.com/mogileeswaran_m</a></p><p id="26d6" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">https://www.facebook.com/MOGILEESWARAN.M的脸书— → <a class="ae lx" href="https://www.facebook.com/MOGILEESWARAN.M" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="6c9e" class="mf jl hi bd jj mg mw mi jp mj mx ml jt io my ip jx ir mz is kb iu na iv kf mp bi translated">参考资料:</h1><div class="nb nc ez fb nd ne"><a href="https://plotly.com/python/choropleth-maps/" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab dw"><div class="ng ab nh cl cj ni"><h2 class="bd hj fi z dy nj ea eb nk ed ef hh bi translated">Choropleth地图</h2><div class="nl l"><h3 class="bd b fi z dy nj ea eb nk ed ef dx translated">如何用Plotly在Python中制作choropleth地图？</h3></div><div class="nm l"><p class="bd b fp z dy nj ea eb nk ed ef dx translated">plotly.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns jd ne"/></div></div></a></div><div class="nb nc ez fb nd ne"><a href="https://analyticsindiamag.com/beginners_guide_geographical_plotting_with_plotly/" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab dw"><div class="ng ab nh cl cj ni"><h2 class="bd hj fi z dy nj ea eb nk ed ef hh bi translated">Plotly地理绘图初学者指南</h2><div class="nl l"><h3 class="bd b fi z dy nj ea eb nk ed ef dx translated">数据科学最酷和最有创意的事情之一是可视化。这是我们运用专业技能的地方…</h3></div><div class="nm l"><p class="bd b fp z dy nj ea eb nk ed ef dx translated">analyticsindiamag.com</p></div></div><div class="nn l"><div class="nt l np nq nr nn ns jd ne"/></div></div></a></div><div class="nb nc ez fb nd ne"><a href="https://covid19api.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab dw"><div class="ng ab nh cl cj ni"><h2 class="bd hj fi z dy nj ea eb nk ed ef hh bi translated">冠状病毒COVID19 API</h2><div class="nl l"><h3 class="bd b fi z dy nj ea eb nk ed ef dx translated">通过简单的API免费访问COVID19上的数据。构建仪表板、移动应用程序或集成到其他…</h3></div><div class="nm l"><p class="bd b fp z dy nj ea eb nk ed ef dx translated">covid19api.com</p></div></div><div class="nn l"><div class="nu l np nq nr nn ns jd ne"/></div></div></a></div><div class="nb nc ez fb nd ne"><a href="https://www.powercms.in/blog/how-get-json-data-remote-url-python-script" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab dw"><div class="ng ab nh cl cj ni"><h2 class="bd hj fi z dy nj ea eb nk ed ef hh bi translated">如何将json数据从远程url获取到Python脚本中</h2><div class="nl l"><h3 class="bd b fi z dy nj ea eb nk ed ef dx translated">要从远程或本地网站获取json输出数据，方法1从URL获取数据，然后调用json.loads，例如…</h3></div><div class="nm l"><p class="bd b fp z dy nj ea eb nk ed ef dx translated">www.powercms.in</p></div></div></div></a></div></div></div>    
</body>
</html>