<html>
<head>
<title>An Introduction to Continuous Integration &amp; GitHub Actions for Julia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Julia的持续集成和GitHub动作介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/an-introduction-to-continuous-integration-github-actions-for-julia-1a5a1a6e64d6?source=collection_archive---------6-----------------------#2020-01-27">https://medium.com/analytics-vidhya/an-introduction-to-continuous-integration-github-actions-for-julia-1a5a1a6e64d6?source=collection_archive---------6-----------------------#2020-01-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3539b2b9f0558fdb2450f6390bedfda3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ET1tJQpZNu9NuYr5ZdGIg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">露丝·齐默曼在<a class="ae iu" href="https://unsplash.com/s/photos/statistics?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="90af" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">问题是</h1><p id="c3a8" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在开源开发中，由于开发人员正在创建他们自己工作的并行分支，并且只在完成时才合并它们，所以未合并的复制分支上的代码将越来越不同于原始主分支上的代码。分支之间迫在眉睫的差异会给我们带来许多挑战，即引入错误，产生合并冲突，甚至使整个代码库完全停止，使开发和发布软件的整个过程变得极具挑战性。</p><p id="1b69" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">开发人员需要测试这些提交，以确保它们正确有效地工作，没有任何错误，不破坏任何包，并且它们运行该项目全面支持的每一个平台。因此，这很可能需要很长的时间，变得非常乏味，并且不是项目的所有方面都被测试，给我们一个非常低的测试覆盖率，并且还可能导致协作中的问题。</p><p id="30b0" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">随后，开发人员之间的同步将很快脱离轨道。因此，为了以更有效和一致的方式开发它，开发人员创造了一些策略来使集成变得非常简单和可重复。</p><h1 id="03d2" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">什么是CI，为什么</h1><p id="364a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">持续集成(Continuous Integration，简称CI)是一种工作流策略，它确保在开源开发中，一个团队中的所有开发人员非常频繁地将所有修改与主分支的最新版本合并。提供CI的服务的一个例子是GitHub，每个开发人员可以创建一个存储库的fork(一个独立的副本),发出Pull请求，要求他们的工作(提交)被合并，用评论和建议进行评审，或者被关闭。这不仅使每个人更容易在过程的早期调试bug，降低合并冲突的可能性(Git无法解决的代码中的竞争变更)，而且还增强了开发人员之间解决问题的沟通。在这里，我们鼓励每个开发人员更频繁地将他们的代码与主分支集成在一起，而不是在集成之前长时间孤立地处理某些功能。本质上，这允许每个人以更频繁的时间间隔获得项目的最新版本，并因此减少冲突的机会和它被评审所花费的时间。此外，对每个人来说，测试他们所做的每一个小的改变都是有益的，以降低错误的风险，并在早期捕捉潜在的错误，以便它不会影响到后来所做的分支，以及跨多个平台进行自动测试，以捕捉早期未测试的平台上的意外问题，并为特定平台创建指令，通过自动化来增加测试覆盖率，其中一些可能会被手动测试遗漏， 并消除每次都必须手动测试编程的麻烦，这是通过持续部署来整理的。 每一个变化都会向团队发送一个通知，让其他开发人员可以很容易地交叉检查他们是否想留下评论或建议。</p><p id="0953" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在大多数情况下，Cl是由一个团队使用一个专用的服务器或CI服务与自动化测试同时进行的。在这里，代码将由服务器自动构建和测试，以检查它是否既能工作又能与主分支的代码集成。然后，服务器将给出一个包含构建结果的输出，其中包含关于分支是否通过了集成到主开发分支的所有需求的所有细节。</p><h1 id="71b5" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">CI/CD管窥</h1><p id="c69c" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">由于CI为我们提供了关于在每个分支上进行的每个提交的构建和测试信息的所有细节，它帮助我们适应所谓的连续交付，即以这样一种方式开发软件的实践，即您可以在任何时候发布它。持续部署是持续交付的扩展，允许您放心地将新开发的功能部署到生产中。GitHub Actions是一个可以免费学习更多CD知识的地方，它有交互式课程，任何人都可以学习更多关于GitHub存储库的工作流和测试自动化的知识，从中可以构建、测试和部署您的代码。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/1704ead8c28a917602a3cd41e704d073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A6VxqbmrKgNQ9R58"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1:维基共享资源；根据CC A-SA 3.0获得许可，未转让</figcaption></figure><h1 id="967f" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">GitHub上的CI！</h1><p id="dc00" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">开发人员为集成所做的是，他们在本地进行更改，并将这些更改推送到GitHub，称为commits，CI在这里的角色是使用自动化测试来确定他们是否将与最新的主分支集成。首先，当一个活动发生时(例如，当有人打开一个pull请求时)，CI服务器将解析GitHub上Webhooks发送的消息，并获取分支的最新副本，这样它就可以构建它并运行测试。完成后，GitHub使用从CI服务器发回的信息来显示pull请求中的检查信息，以及一些链接，您可以单击这些链接返回查看更多详细信息，如下图所示:</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/4b33d0a7f3a0e02dba186fc87f200ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mGgpAWOZ9RsYqp0e.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图GitHub上FluxML/Flux.jl上的Pull请求#977的截图</figcaption></figure><p id="1c73" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这使得每个人，无论他们是一个存储库的贡献者、成员或者所有者，对于哪些变更可以集成到主分支，哪些不可以(或者需要更多的变更)有一个更清晰的想法。在基本的CI/CD设置中，我们可以创建一个系统，允许CI提供者将主分支上的每个新提交部署到主分支上，例如GitHub操作。查看更多:<a class="ae iu" href="https://lab.github.com/github/hello-github-actions!" rel="noopener ugc nofollow" target="_blank">https://lab.github.com/github/hello-github-actions!</a></p><h1 id="2f05" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">为什么CI/CD对Julia很重要</h1><p id="024d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">既然我们都知道持续集成是每个人管理一个项目的工作流程的好方法，这个项目涉及多个同时在不同方面工作的人，我们可以谈谈为什么这对Julia <a class="ae iu" href="https://pkg.julialang.org/docs/" rel="noopener ugc nofollow" target="_blank"> package </a>开发者来说是一件大事。当涉及到在Julia <a class="ae iu" href="https://github.com/JuliaLang" rel="noopener ugc nofollow" target="_blank">生态系统</a>中开发包时，这变得特别方便。您可能会发现，与其他编程语言相比，CI/CD可能更经常被Julia包开发人员使用，因为Julia有非常广泛的包集合，因此它使得每次管理、测试和审查如此大量的被合并到生态系统中的包变得非常困难。事实上，Julia中的大多数包都有大量代码被重用和组合，除此之外，还存在代码冲突的风险，因此可能会破坏相关的包，或者更糟，破坏整个项目！由于这是用Julia编程语言开发包的一个如此重要的方面，开发人员已经创建了机器人来帮助自动化这个过程，并使测试更容易。这方面的一个例子是<a class="ae iu" href="https://github.com/JuliaComputing/NewPkgEval.jl" rel="noopener ugc nofollow" target="_blank"> NewPkgEval.jl </a>，它评估包以确定对Julia的提交是否会破坏生态系统本身。还有一个名为<a class="ae iu" href="https://github.com/JuliaRegistries/Registrator.jl" rel="noopener ugc nofollow" target="_blank"> Registrator.jl </a>的机器人，它自动创建julia包向通用注册中心的注册请求。</p><h1 id="6bea" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">使用GitHub操作为Julia repo设置基本配置项脚本</h1><p id="cb91" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">假设您有一个包含您想要运行的Julia程序的存储库，您可以使用GitHub操作(如前所述)来帮助自动化您的CI工作流，并直接从GitHub部署代码。今天，我们不会深入探讨太多的细节，而是简单介绍一下让您入门和运行的基础知识。在julia中拥有CI工作流或流程的要素之一是这个名为<a class="ae iu" href="https://github.com/marketplace/actions/setup-julia-environment" rel="noopener ugc nofollow" target="_blank"> "setup-julia" </a>的GitHub操作，它通过下载特定版本的Julia并将其添加到PATH中来帮助设置在操作中使用的Julia环境，这样只需调用<code class="du lc ld le lf b">julia</code>就可以轻松运行脚本。</p><p id="6dff" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果你去你的回购，你应该可以看到一个标签，称为“行动”。点击并选择右边的“自己设置工作流程”选项。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/e0a80e7c358a9338c1aaed400e62a0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Qbr_iZQjrlZyVt0B.png"/></div></div></figure><p id="5453" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">它的作用是在<code class="du lc ld le lf b">.github</code>文件夹内的<code class="du lc ld le lf b">workflows</code>文件夹内创建一个<code class="du lc ld le lf b">.yml</code>文件。默认情况下，它被称为<code class="du lc ld le lf b">main.yml</code>，但是您可以随意更改它的名称，同时保留最后的<code class="du lc ld le lf b">.yml</code>扩展名。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/93723c42a7aea232e08d1668f9d8da92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kA3BUtL58UFkgBMp.png"/></div></div></figure><p id="42b8" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">完成后，您可以创建另一个名为<code class="du lc ld le lf b">src</code>的文件夹，将repo中的所有内容(不包括新的<code class="du lc ld le lf b">.github</code>文件夹)放入其中。没有必要这样做，但这可能会使回购更有条理，尤其是如果你有很多。</p><p id="be98" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">你现在可以返回到编辑<code class="du lc ld le lf b">.yml</code>文件。首先，您可以将<code class="du lc ld le lf b">name:</code>部分更改为您希望调用脚本的名称。之后，我们可以设置部署时间表。用以下代码替换<code class="du lc ld le lf b">on:</code>部分:</p><pre class="kx ky kz la fd lh lf li lj aw lk bi"><span id="6cbf" class="ll iw hi lf b fi lm ln l lo lp">on:<br/>  schedule:<br/>  - cron: "*/8 * * * *"</span></pre><p id="509c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">上面显示的示例允许文件每8分钟运行一次。请随意将该数字更改为任意数字。点击<a class="ae iu" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/events-that-trigger-workflows#scheduled-events-schedule" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多关于如何定制<code class="du lc ld le lf b">cron:</code>的信息。</p><p id="78b1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">现在让我们继续并修改用于运行代码的<code class="du lc ld le lf b">jobs</code>部分。将以下代码粘贴为模板，我们将在以后对其进行修改:</p><pre class="kx ky kz la fd lh lf li lj aw lk bi"><span id="88e2" class="ll iw hi lf b fi lm ln l lo lp">jobs:<br/>  build:</span><span id="bc34" class="ll iw hi lf b fi lq ln l lo lp">    runs-on: ubuntu-latest<br/>    <br/>    steps:<br/>    - uses: actions/checkout@v1<br/>    - uses: julia-actions/setup-julia@v1<br/>      with:<br/>          version: '1.0.4'<br/>    - uses: julia-actions/julia-buildpkg@master<br/>    - run: julia --project file.jl</span></pre><p id="d7cd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这里的<code class="du lc ld le lf b">runs-on</code>值指定了操作将在哪个操作系统上运行。在本例中，使用了<code class="du lc ld le lf b">ubuntu-latest</code>。可以将runner换成Windows、macOS等其他操作系统。点击<a class="ae iu" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/virtual-environments-for-github-hosted-runners#supported-runners-and-hardware-resources" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多信息。然后，您可以通过将<code class="du lc ld le lf b">'1.0.4'</code>更改为您想要使用的版本来更改您的Julia版本，例如<code class="du lc ld le lf b">'1.2.1'</code>。最后，记得将<code class="du lc ld le lf b">file.jl</code>更改为启动该工作流的程序的路径。一个例子可能是<code class="du lc ld le lf b">main.jl</code>或<code class="du lc ld le lf b">src/main.jl</code>，如果你创建了一个<code class="du lc ld le lf b">src</code>文件。</p><p id="5d35" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们将使用的机器上的Julia不会安装所有的包。因此，请将下面两行添加到程序顶部的<code class="du lc ld le lf b">using &lt;Package&gt;</code>上方，以安装我们需要的包(如果没有使用包，请随意跳过！):</p><pre class="kx ky kz la fd lh lf li lj aw lk bi"><span id="16f1" class="ll iw hi lf b fi lm ln l lo lp">import Pkg<br/>Pkg.add(["package1", "package2", "package3"]) #list of package names</span></pre><p id="3146" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这里有一个例子:</p><pre class="kx ky kz la fd lh lf li lj aw lk bi"><span id="0ee6" class="ll iw hi lf b fi lm ln l lo lp">import Pkg<br/>Pkg.add(["OAuth", "HTTP", "JSON"])<br/>using OAuth, HTTP, JSON</span></pre><p id="9fec" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">干得好！我们已经成功地为我们的程序创建了自动化！随意看看这个例子，看看这是怎么做的。</p><h1 id="0b1b" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">在你离开之前…</h1><p id="6045" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我只想说，我强烈推荐任何想加入软件开发行业的人来看看CI/CD是如何工作的，如果你还没有这样做的话。这实际上并不是一个非常复杂的想法:你只需要把你的头转过去。我知道乍一看不得不一天合并几次提交听起来有多烦人，也许是因为你不想被打扰，或者认为你的时间可以更有效地用于项目本身，但是试一试:这也是项目的一部分！它将立即改变工作环境，成为一个非常富有成效的。感谢阅读！</p><h1 id="fd55" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">参考资料:</h1><p id="79fb" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">亚特兰蒂斯人。(未注明)。什么是持续集成。检索自<a class="ae iu" href="https://www.atlassian.com/continuous-delivery/continuous-integration" rel="noopener ugc nofollow" target="_blank">https://www . atlassian . com/continuous-delivery/continuous-integration</a><br/>cloud bees Inc .(未注明)。持续集成:什么是CI？测试，软件&amp;过程教程。检索自<a class="ae iu" href="https://codeship.com/continuous-integration-essentials" rel="noopener ugc nofollow" target="_blank">https://codeship.com/continuous-integration-essentials</a>T5】数字海洋。(2019年9月18日)。持续集成、交付和部署的介绍。检索自<a class="ae iu" href="https://www.digitalocean.com/community/tutorials/an-introduction-to-continuous-integration-delivery-and-deployment" rel="noopener ugc nofollow" target="_blank">https://www . digital ocean . com/community/tutorials/an-introduction-to-Continuous-Integration-delivery-and-deployment</a><br/>你应该使用持续集成的7个理由。(2015年2月3日)。检索自<a class="ae iu" href="https://about.gitlab.com/blog/2015/02/03/7-reasons-why-you-should-be-using-ci/" rel="noopener ugc nofollow" target="_blank">https://about . git lab . com/blog/2015/02/03/7-reasons-why-you-should-be-use-ci/</a><br/>持续集成。(未注明)。检索自<a class="ae iu" href="https://www.thoughtworks.com/continuous-integration" rel="noopener ugc nofollow" target="_blank">https://www.thoughtworks.com/continuous-integration</a><br/>菲洛，w .(2016 . 8 . 7)。为什么持续集成如此重要？检索自<a class="ae iu" rel="noopener" href="/the-making-of-whereby/why-continuous-integration-is-so-important-7bb63ba5dc57">https://medium . com/the-making-of-why-Continuous-Integration-Is-so-important-7 bb 63 ba 5d c 57</a><br/>什么是持续集成，如何从中受益？(未注明)。检索自<a class="ae iu" href="https://nevercode.io/blog/what-is-continuous-integration-and-how-to-benefit-from-it/" rel="noopener ugc nofollow" target="_blank">https://never code . io/blog/what-is-continuous-integration-and-how-to-benefit/</a><br/>关于合并冲突。(未注明)。检索自<a class="ae iu" href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-merge-conflicts" rel="noopener ugc nofollow" target="_blank">https://help . github . com/en/github/collaboration-with-issues-and-pull-requests/about-merge-conflicts</a><br/>专业指南:持续集成持续交付。(未注明)。从<a class="ae iu" href="https://www.youtube.com/watch?v=xSv_m3KhUO8" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=xSv_m3KhUO8</a><br/>GitHub主办的跑步者虚拟环境中检索。(未注明)。检索自<a class="ae iu" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/virtual-environments-for-github-hosted-runners" rel="noopener ugc nofollow" target="_blank">https://help . github . com/en/actions/automating-your-workflow-with-github-actions/virtual-environments-for-github-hosted-runners</a><br/>触发工作流的事件。(未注明)。检索自<a class="ae iu" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/events-that-trigger-workflows" rel="noopener ugc nofollow" target="_blank">https://help . github . com/en/actions/automating-your-workflow-with-github-actions/events-that-trigger-workflows</a><br/>setup-Julia Action。(未注明)。从<a class="ae iu" href="https://github.com/marketplace/actions/setup-julia-environment" rel="noopener ugc nofollow" target="_blank">https://github . com/market place/actions/setup-Julia-environment</a>中检索</p></div></div>    
</body>
</html>