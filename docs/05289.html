<html>
<head>
<title>How to build a simple bot using python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用python构建一个简单的机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-build-a-simple-bot-using-python-133e813eed70?source=collection_archive---------13-----------------------#2020-04-16">https://medium.com/analytics-vidhya/how-to-build-a-simple-bot-using-python-133e813eed70?source=collection_archive---------13-----------------------#2020-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d2607dd47d8a5a53465bbd356f8bb766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RXEDFVThZhVfOmvSpG5LXw.jpeg"/></div></div></figure><p id="a047" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在有一些小的机器人(简单的软件)正在运行，它们会通过处理响应并发回响应来完成一个动作(例如Slack Bot，Messenger Bot)。为了构建这种简单的机器人，我创建了一个名为<a class="ae jo" href="https://pypi.org/project/iaBot/" rel="noopener ugc nofollow" target="_blank"> iaBot的框架。</a></p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="0448" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">iaBot是一个Python库，用于创建简单的机器人，并为其提供不同的可用服务器。</p><h2 id="2544" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">系统需求</h2><p id="d409" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">使用python3.7+的系统是创建一个bot并满足请求的最低要求。</p><h2 id="22a1" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">如何创建一个机器人？</h2><p id="72ab" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">使用python包管理器pip并在您的系统上安装iaBot包。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4d09" class="jw jx hi lb b fi lf lg l lh li">pip install iaBot</span></pre><p id="0922" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个框架设计有两个主要的东西来驱动机器人。一个是处理者，一个是动作。处理程序是一组操作。您可以创建任意多的处理程序，并向机器人注册。若要创建自定义处理程序，请确保您继承了BaseHandler。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e547" class="jw jx hi lb b fi lf lg l lh li">from iabot.handlers import BaseHandler</span><span id="5414" class="jw jx hi lb b fi lj lg l lh li">class DoorHandler(BaseHandler):<br/>    handle = 'door'<br/>    <br/>    def open(self, *args, **kwargs):<br/>      """<br/>      You will write code to open your door by connecting<br/>      with the hardware<br/>      """<br/>      return {"status": "OK"}</span></pre><p id="21bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">门把手内部的打开功能称为动作。在一个处理程序中可以有多个动作，比如关闭、锁定、解锁等。现在我们需要将这个处理程序注册到一个机器人。</p><p id="b031" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">机器人知道在处理程序中调用哪个动作来处理请求。它根据通过请求发送的消息选择处理程序和动作。bot只能理解request_data中的句柄、动作、数据。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4f80" class="jw jx hi lb b fi lf lg l lh li">{<br/> "handle": "door",<br/> "action": "open",<br/> "data": {}<br/>}</span></pre><p id="bbe3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要创建一个机器人，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="bcff" class="jw jx hi lb b fi lf lg l lh li">from iabot import CreateBot</span><span id="af67" class="jw jx hi lb b fi lj lg l lh li">handlers_register = [<br/> DoorHandler<br/>]</span><span id="03c0" class="jw jx hi lb b fi lj lg l lh li">bot = CreateBot(handlers=handlers_register)</span></pre><p id="08e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到目前为止，您已经成功创建了一个机器人。bot应该连接到一个介质来接收请求，并在处理请求后发回响应。这里这些媒介被称为服务器。服务器可以是HTTPServer、WebSocket或RPCServer。在当前版本(0.0.4)中，iaBot只支持HTTPServer。要创建HTTPServer，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="81a2" class="jw jx hi lb b fi lf lg l lh li">from iabot.servers import HTTPServer</span><span id="5b9f" class="jw jx hi lb b fi lj lg l lh li">server = HTTPServer(bot=bot)<br/>server.run()</span></pre><p id="077b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请记住，您需要在初始化HTTP服务器时传递您的bot。一旦你做了server.run()你的bot将开始监听端口8080。您可以使用任何可用工具中的post方法将消息发送到您的bot。您还可以更改服务器监听的端口，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="a3c8" class="jw jx hi lb b fi lf lg l lh li">server = HTTPServer(bot=bot, port=&lt;any_port&gt;)</span></pre><p id="f5f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目前，我们只有HTTPServer。该版本的未来版本中将会添加更多的服务器。</p><p id="477d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，您的代码看起来像这样，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="9b67" class="jw jx hi lb b fi lf lg l lh li">from iabot import CreateBot<br/>from iabot.handlers import BaseHandler<br/>from iabot.servers import HTTPServer<br/></span><span id="aab2" class="jw jx hi lb b fi lj lg l lh li">class DoorHandler(BaseHandler):<br/>    handle = 'door'<br/>    <br/>    def open(self, *args, **kwargs):<br/>      """<br/>      You will write code to open your door by connecting<br/>      with the hardware<br/>      """<br/>      return {"status": "OK"}</span><span id="cab6" class="jw jx hi lb b fi lj lg l lh li">handlers_register = [<br/>    DoorHandler<br/>]</span><span id="f29e" class="jw jx hi lb b fi lj lg l lh li">bot = CreateBot(handlers=handlers_register)<br/>server = HTTPServer(bot=bot)<br/>server.run()</span></pre><p id="3356" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">享受添加更多的处理程序到你的机器人。您也可以在<a class="ae jo" href="https://github.com/satheesh1997/iaBot" rel="noopener ugc nofollow" target="_blank"> Github </a>上给我们投稿。</p><p id="8d13" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">尝试这个例子来更好地理解，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4f88" class="jw jx hi lb b fi lf lg l lh li">from iabot import CreateBot<br/>from iabot.handlers import SystemInformationHandler<br/>from iabot.servers import HttpServer<br/><br/>handlers = [<br/>   SystemInformationHandler<br/>]<br/>bot = CreateBot(<br/>   handlers=handlers<br/>)<br/>bot_server = HttpServer(bot)<br/>bot_server.run()</span></pre><p id="b46e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，HTTP服务器将监听localhost:8000，使用postman或alternate发送一个包含以下数据的HTTP post请求。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="0dc7" class="jw jx hi lb b fi lf lg l lh li">{<br/>  "handler": "system",<br/>  "action": "time"<br/>}</span></pre><p id="d975" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望您在响应中获得了系统时间。快乐编码:)</p></div></div>    
</body>
</html>