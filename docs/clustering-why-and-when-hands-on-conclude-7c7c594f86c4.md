# èšç±»| |åŸå› å’Œæ—¶é—´| |åŠ¨æ‰‹| |æ€»ç»“

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/clustering-why-and-when-hands-on-conclude-7c7c594f86c4?source=collection_archive---------13----------------------->

*å»ºè®¾æ€§çš„ã€æœ‰æ•ˆçš„ã€æœ‰ç›Šçš„ã€ç»“è®ºæ€§çš„ã€æ˜ç¡®çš„ã€*ç­‰ã€‚è¿™æ ·çš„å•è¯æ˜¯å•è¯**çš„åŒä¹‰è¯**ã€‚ç°åœ¨å¦‚æœæœ‰äººè®©ä½ æŠŠè¿™äº›å•è¯æ”¾åœ¨å…¶ä¸­ä¸€ä¸ªè¢‹å­é‡Œ(**æ­£é¢æˆ–åé¢**ï¼Œä½ ä¼šé€‰æ‹©å“ªä¸ªï¼Ÿ

æ­£å³ï¼ã€‚ä½ ä¼šæŠŠå†™æœ‰è¿™äº›å­—çš„åŒ…å«ä»€ä¹ˆï¼Ÿ**å•è¯ç¾¤**ä¸ ***é‡è¦æ€§ç›¸åŒ/è¯æ ¹ç›¸åŒ/ç”šè‡³æ¥æºç›¸åŒï¼Œ*** è¿™å°±æ˜¯æˆ‘ä»¬æœ‰èšç±»æ¦‚å¿µå’Œå½¢æˆèšç±»çš„åœ°æ–¹ã€‚ã€‚

å¦‚æœä¸Šé¢çš„è§£é‡Šä¸æ¸…æ¥šï¼Œè®©æˆ‘è¯´å¾—æ›´å¤©çœŸ/æ­£å¼äº›:**å°†åŠ¨ä½œç”µå½±ç»„åˆåœ¨ä¸€ä¸ªæ’­æ”¾åˆ—è¡¨ä¸­ï¼Œå°†æ‰€æœ‰ä¸åŒç±»å‹çš„ç‰™è†æ”¾åœ¨ä¸€ä¸ªéƒ¨åˆ†ï¼Œç„¶åæ ¹æ®ä»·æ ¼/å¤§å°å°†å®ƒä»¬åˆ†å¼€ï¼Œå°†ä¸åŒç±»å‹çš„åŠ¨ç‰©å½’ä¸ºä¸€ä¸ªç§ç±»**(ä¾‹å¦‚çŒ«å®¶æ—)ã€‚

![](img/dd1e411e244dbb4a1c57aa44c73edd02.png)

çŒ«ç§‘åŠ¨ç‰©

> èšç±»çš„ä»»åŠ¡æ˜¯å°†äººç¾¤æˆ–æ•°æ®ç‚¹åˆ†æˆä¸åŒæ•°é‡çš„ç»„ï¼Œä½¿å¾—åŒä¸€ç»„ä¸­çš„**æ•°æ®ç‚¹æ¯”å…¶ä»–ç»„ä¸­çš„æ•°æ®ç‚¹æ›´ç±»ä¼¼äºåŒä¸€ç»„ä¸­çš„å…¶ä»–æ•°æ®ç‚¹ã€‚**ç®€è€Œè¨€ä¹‹ï¼Œ ***ç›®çš„æ˜¯å°†å…·æœ‰ç›¸ä¼¼ç‰¹å¾çš„ç¾¤ä½“åˆ†ç¦»å‡ºæ¥ï¼Œå¹¶åˆ†é…åˆ°èšç±»ä¸­ã€‚*** *èšç±»çš„åº”ç”¨:*

*   å®¢æˆ·ç»†åˆ†
*   æ•°æ®åˆ†æ
*   å¯ç”¨ä½œ**é™ç»´æŠ€æœ¯**
*   ç¦»ç¾¤ç‚¹æ£€æµ‹
*   æœç´¢å¼•æ“å’Œåˆ†å‰²å›¾åƒã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»ä¸šåŠ¡è§’åº¦æ¥ç†è§£é›†ç¾¤ã€‚

åœ¨**å•†ä¸šæ™ºèƒ½**ä¸­ï¼Œ*èšç±»å¯ä»¥ç”¨æ¥å°†å¤§é‡çš„å®¢æˆ·ç»„ç»‡æˆç»„ï¼Œå…¶ä¸­ä¸€ä¸ªç»„å†…çš„å®¢æˆ·å…·æœ‰å¾ˆå¼ºçš„ç›¸ä¼¼ç‰¹å¾ã€‚*è¿™æœ‰åŠ©äºåŠ å¼ºå®¢æˆ·å…³ç³»ç®¡ç†çš„ä¸šåŠ¡æˆ˜ç•¥çš„å‘å±•ã€‚è€Œä¸”ï¼Œè€ƒè™‘ä¸€ä¸ªæœ‰å¤§é‡é¡¹ç›®çš„é¡¾é—®å…¬å¸ã€‚ä¸ºäº†æ”¹è¿›é¡¹ç›®ç®¡ç†ï¼Œå¯ä»¥åº”ç”¨èšç±»æ¥æ ¹æ®ç›¸ä¼¼æ€§å°†é¡¹ç›®åˆ’åˆ†ä¸ºä¸åŒçš„ç±»åˆ«ï¼Œä»¥ä¾¿å¯ä»¥æœ‰æ•ˆåœ°è¿›è¡Œé¡¹ç›®å®¡è®¡å’Œè¯Šæ–­(ä»¥æ”¹è¿›é¡¹ç›®äº¤ä»˜å’Œæˆæœ)ã€‚

# èšç±»çš„ç±»å‹

ä¸ºäº†ç†è§£èšç±»çš„ç±»å‹ï¼Œç†è§£æˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªèšç±»æ˜¯åˆé€‚çš„æ˜¯å¾ˆé‡è¦çš„ã€‚

*   é«˜ ***ç±»å†…*** ç›¸ä¼¼åº¦
*   â—***ç±»é—´*** ç›¸ä¼¼åº¦

è¿™æ„å‘³ç€ï¼Œä¸ºäº†è·å¾—è‰¯å¥½çš„èšç±»ç»“æœï¼Œ**ç±»å†…è·ç¦»å¿…é¡»é«˜ï¼Œç±»é—´è·ç¦»å¿…é¡»ä½ã€‚**

***ç±»å†…*** :

èšç±»å†…è¢«å®šä¹‰ä¸ºåŒä¸€èšç±»ä¸­çš„æ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚

***è¯¾é—´:***

ç±»é—´æ˜¯å±äºä¸¤ä¸ªä¸åŒèšç±»çš„æ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚

![](img/00c8db50ef1ac042ba274fd80eea16d9.png)

å™è¿°

1.  *è½¯èšç±»*:æ•°æ®ç‚¹å¯ä»¥å…±äº«/å±äº**ä¸€ä¸ªæˆ–å¤šä¸ªèšç±»**çš„æŠ€æœ¯ã€‚
2.  *ç¡¬èšç±»*:æ¯ä¸€ä¸ªæ•°æ®ç‚¹/å¯¹è±¡åªå±äº**ä¸€ä¸ªèšç±»**çš„æŠ€æœ¯ã€‚å°†æ¯ä¸ªå®ä¾‹åˆ†é…ç»™ä¸€ä¸ªé›†ç¾¤ã€‚

![](img/b76a86013ebf4be21421ba9e7601c1ea.png)

ç¡¬é›†ç¾¤ä¸è½¯é›†ç¾¤

3.*å±‚æ¬¡èšç±»*:ä½¿ç”¨ **k-means èšç±»**çš„ä¸€ä¸ªä¸»è¦è€ƒè™‘æ˜¯é¢„å…ˆé€šè¿‡**å‰ªå½±è¯„åˆ†æˆ–è‚˜æ›²çº¿æ³•**å†³å®š k çš„å€¼ã€‚å±‚æ¬¡èšç±»æ²¡æœ‰è¿™ç§é™åˆ¶ã€‚è¿™é‡Œä½¿ç”¨**é“¾æ¥**çš„æ¦‚å¿µå°†å¤šä¸ªå­èšç±»åˆå¹¶æˆä¸€ä¸ªèšç±»ï¼Œç›´åˆ°æ‰€æœ‰ç‚¹éƒ½æˆä¸ºä¸€ä¸ªèšç±»çš„ä¸€éƒ¨åˆ†ã€‚æœ‰ä¸¤ç§ç±»å‹/æ–¹æ³•å¯ä»¥æ‰§è¡Œå±‚æ¬¡èšç±» ***å‡èš(è‡ªä¸‹è€Œä¸Š)å’Œåˆ†è£‚(è‡ªä¸Šè€Œä¸‹)ã€‚***

![](img/9d15a4203db9a43bbef9d882f1f20ba5.png)

å‡èšå±‚æ¬¡èšç±»

# è®©æˆ‘ä»¬æ¥è°ˆè°ˆå‰ªå½±å¾—åˆ†ï¼Œè‚˜éƒ¨æ›²çº¿ï¼ŒK-Means å’Œæˆ‘ä»¬å°†è¦åšçš„åŠ¨æ‰‹æ“ä½œï¼

éšä¾¿çœ‹çœ‹ä¸‹é¢ï¼Œ**æ— ç›‘ç£èšç±»ç®—æ³•**æœ‰å¤šå°‘ç§ä¸åŒçš„ç±»å‹å’Œæ–¹æ³•ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™ä½¿ç”¨åœºæ™¯:

![](img/00c248d7f2dac19d75303902f182e8b4.png)

é›†ç¾¤è·¯çº¿å›¾ï¼

**å‰ªå½±å¾—åˆ†**:å‰ªå½±åˆ†ææˆ–å‰ªå½±ç³»æ•°æ˜¯ä¸€ä¸ªæ•°æ®ç‚¹ä¸è‡ªèº«èšç±»(*)ç›¸æ¯”ä¸å…¶ä»–èšç±»(*)ç›¸ä¼¼ç¨‹åº¦çš„åº¦é‡ã€‚æ‰€ä»¥ä¸ºäº†è®¡ç®—*è½®å»“åº¦é‡*ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒä¸¤ä¸ªåº¦é‡ï¼Œå³ *a(i)* å’Œ *b(i)* ï¼Œå…¶ä¸­**

*   ****a(I)æ˜¯ç¦»è‡ªå·±æ˜Ÿå›¢çš„å¹³å‡è·ç¦»(****)******
*   *******(I)****b æ˜¯ç¦»æœ€è¿‘é‚»ç°‡çš„å¹³å‡è·ç¦»(***)******

******ç°åœ¨å¯¹äºæ¯ä¸€ä¸ª**æ•°æ®ç‚¹(i)** ï¼Œ *a(i)* **åº”è¯¥å°½å¯èƒ½å°**ï¼Œ *b(i)* **åº”è¯¥å°½å¯èƒ½å¤§ã€‚********

******![](img/5b72cc710c1be95ce342a9fee57c5ca7.png)******

******å‰ªå½±å…¬å¼******

*   ******è½®å»“åˆ†æ•°èŒƒå›´çš„å€¼åœ¨ **-1 åˆ°+1 ä¹‹é—´ã€‚********
*   ********æ¥è¿‘+1 çš„åˆ†æ•°è¡¨ç¤ºè¯¥æ•°æ®ç‚¹ä¸èšç±»ä¸­çš„å…¶ä»–æ•°æ®ç‚¹éå¸¸ç›¸ä¼¼ã€‚********
*   ********åˆ†æ•°è¶Šæ¥è¿‘-1 è¡¨ç¤ºè¯¥æ•°æ®ç‚¹ä¸å…¶èšç±»ä¸­çš„æ•°æ®ç‚¹ä¸ç›¸ä¼¼ã€‚********

********è‚˜å½¢æ›²çº¿:**æ±‚æ ·æœ¬è·å„è‡ªèšç±»ä¸­å¿ƒè·ç¦»çš„å¹³æ–¹å’Œ**ã€‚è¦ä» Elbow-Method ä¸­é€‰æ‹©æœ€ä½³èšç±»æ•°:********

*   ******é’ˆå¯¹ä¸åŒçš„ k å€¼è®¡ç®—èšç±»ç®—æ³•(ä¾‹å¦‚ï¼Œk å‡å€¼èšç±»)ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å°† k ä» 1 å˜åŒ–åˆ° 10 ä¸ªèšç±»ã€‚******
*   ******å¯¹äºæ¯ä¸ª kï¼Œè®¡ç®—æ€»çš„ç±»å†…å¹³æ–¹å’Œ(wss)ã€‚******
*   ******æ ¹æ®ç°‡æ•° k ç»˜åˆ¶ wss æ›²çº¿ã€‚******
*   ******å›¾ä¸­å¼¯æ›²(æ‹ç‚¹)çš„ä½ç½®é€šå¸¸è¢«è®¤ä¸ºæ˜¯é€‚å½“èšç±»æ•°çš„æŒ‡ç¤ºã€‚******

******å—¯ï¼Œä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½æ˜¯ç”¨äº**åœ¨ *K-MEANS èšç±»ç®—æ³•ä¸­é€‰æ‹©èƒ½å¤Ÿå½¢æˆçš„æœ€ä½³ç°‡æ•°ï¼*********

******å¥½äº†ï¼Œåˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ï¼Œ******

*   ******ä»€ä¹ˆæ˜¯èšç±»ï¼Œä»€ä¹ˆæ—¶å€™åº”è¯¥è¿›è¡Œèšç±»ï¼******
*   ******ä¸åŒç±»å‹çš„èšç±»ã€‚******
*   ******å¦‚ä½•æ‰èƒ½é€‰æ‹©**æœ€ä¼˜èšç±»æ•°**è¿›è¡Œèšç±»ã€‚******

******ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹**èšç±»æ–¹æ³•**ä¸­çš„ä¸€ç§ï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•ç»§ç»­å®ç°å®ƒã€‚******

********K-Means èšç±»:**ç®—æ³•éœ€è¦æ‰¾åˆ°å€¼å½¼æ­¤ç›¸ä¼¼çš„æ•°æ®ç‚¹ï¼Œå› æ­¤è¿™äº›ç‚¹å°†å±äºåŒä¸€ä¸ªèšç±»ã€‚******

> ******ä»»ä½•èšç±»ç®—æ³•éƒ½æ˜¯é€šè¿‡ä¸€ç§å«åš ***ã€è·ç¦»åº¦é‡ã€‘*** çš„æ–¹æ³•æ¥å®ç°çš„ã€‚åœ¨ **K-Means** èšç±»ä¸­ä½¿ç”¨çš„è·ç¦»åº¦é‡è¢«ç§°ä¸º ***â€œæ¬§æ°è·ç¦»åº¦é‡â€ã€‚*********

******![](img/282e87eebd076b084bb54854acad1ed4.png)******

********d** æ˜¯ä¸¤ç‚¹ä¹‹é—´çš„**æ¬§æ°è·ç¦»********

******å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œèšç±»æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰æ ‡ç­¾å’Œè´¨å¿ƒã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•è¿›è¡Œå‘¢ï¼Ÿ******

1.  ******æˆ‘ä»¬ä»éšæœºæ”¾ç½®**è´¨å¿ƒ**å¼€å§‹ã€‚******
2.  ******ç„¶åæ ¹æ®**æ¬§æ°è·ç¦»**å°†å®ä¾‹æ ‡è®°åˆ°ä¸€ä¸ªç°‡ä¸­ï¼Œå¹¶æ›´æ–°è´¨å¿ƒï¼Œ**æ ‡è®°å®ä¾‹ï¼Œæ›´æ–°è´¨å¿ƒï¼Œæ ‡è®°å®ä¾‹ï¼Œæ›´æ–°è´¨å¿ƒ**ï¼Œç›´åˆ°è´¨å¿ƒåœæ­¢ç§»åŠ¨ï¼Œå³åœæ­¢è·å¾—æ–°çš„åæ ‡ã€‚******

******è¯¥ç®—æ³•ä¿è¯åœ¨æœ‰é™æ­¥å†…æ”¶æ•›ã€‚å°±æ˜¯è¿™æ ·ï¼Œåœ¨ä»…ä»…ä¸¤æ­¥**åˆ†é…å’Œä¼˜åŒ–**ä¸­ï¼Œç®—æ³•è¿­ä»£æ”¶æ•›ã€‚ç®—æ³•çš„å†…éƒ¨å¾ªç¯è¿­ä»£ 2 ä¸ªæ­¥éª¤:******

*   ******å°†æ¯ä¸ªè§‚å¯Ÿå€¼ **X(i)** åˆ†é…åˆ°æœ€è¿‘çš„ç¾¤é›†è´¨å¿ƒã€‚******
*   ******å°†æ¯ä¸ªè´¨å¿ƒæ›´æ–°ä¸ºåˆ†é…ç»™å®ƒçš„ç‚¹çš„å¹³å‡å€¼ã€‚******

******æ¯”è¾ƒæ¯ç°‡çš„**å¹³æ–¹å’Œå¹¶æ˜¾ç¤º**ç°‡å½¢æˆçš„ Gif è¡¨ç¤ºï¼**********

******å¦‚æœä»æœ‰ä»»ä½•ç–‘é—®ï¼Œå¯ä»¥å‚è€ƒ Stat-Quest [é›†ç¾¤è§†é¢‘](https://www.youtube.com/watch?v=4b5d3muPQmA&feature=youtu.be)ï¼Œä»¥è·å¾—æ›´å¥½çš„ç†è§£å’Œæ›´å¤šçš„æ¸…æ™°åº¦ã€‚è¿™å®¶ä¼™çœŸçš„è§£é‡Šå¾—å¾ˆå¥½ï¼Œå”±å¾—ä¹Ÿå¾ˆå¥½ï¼ğŸ˜›è€Œå¦‚æœä½ æƒ³ç© **k-means** ï¼Œ[è¿™ä¸ª](https://www.naftaliharris.com/blog/visualizing-k-means-clustering/)å¯ä»¥å¸®åˆ°ä½ ï¼******

******ç»ˆäºï¼Œæˆ‘ä»¬åˆ°äº†ï¼Œæˆ‘ä¹Ÿæ¸´æœ›åˆ°è¾¾çš„åœ°æ–¹ï¼ã€‚******

# ******æŠŠæ‰‹ä¸¾èµ·æ¥ã€‚******

******é—®é¢˜é™ˆè¿°: ***ä½¿ç”¨èšç±»æ–¹æ³•è®ºè¿›è¡Œè¯è¯­èšç±»*** ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰äº†**æ–°é—»æ¨æ–‡çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬éœ€è¦èšç±»å‡ºç›¸ä¼¼çš„è¯**ã€‚*æˆ‘ä»¬å¦‚ä½•ç»§ç»­è¿™æ ·åšï¼Ÿ*******

******è®©æˆ‘å¼•ç”¨ä¸€äº›å…³äºæ•°æ®é›†å’Œæ–¹æ³•çš„äº‹æƒ…:******

*   ******å®ƒçš„åŠŸèƒ½åŒ…æ‹¬: **tweet_idã€tweet çš„æ—¥æœŸå’Œæ—¶é—´ä»¥åŠ tweet_text** ã€‚è¿™äº›æ–°é—»æ¨æ–‡æ˜¯ä» UCI çš„ BBC å¥åº·æ¨æ–‡ä¸­è·å¾—çš„ã€‚æ€»å…±æœ‰å¤§çº¦ **3929** æ¡æ¨æ–‡ï¼Œæˆ‘ä»¬ä¸ä¼šä»æ•´ä¸ªæ•°æ®ä¸­ä¸¢å¤±ä»»ä½•å€¼ã€‚******
*   ******ç°åœ¨ï¼Œç”±äºæˆ‘ä»¬å°†å¯¹ç‰¹å¾ **tweet_text** è¿›è¡Œèšç±»ï¼Œæˆ‘ä»¬åˆ é™¤äº†ç‰¹å¾**æ—¥æœŸå’Œæ—¶é—´|| tweet_id** ã€‚******
*   ******æ¥ä¸‹æ¥ï¼Œç”±äºè¿™æ˜¯åˆ—ä¸­çš„æ–‡æœ¬æ•°æ®ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä¸€äº›åŸºæœ¬çš„**æ–‡æœ¬æ¸…ç†å’Œæ–‡æœ¬å¤„ç†**æ­¥éª¤ã€‚******
*   ******ç„¶åç»è¿‡æ¸…æ´—å’Œå¤„ç†ï¼Œæˆ‘ä»¬å°†ä» **tweet_text** ç‰¹å¾ä¸­å½¢æˆä¸€ä¸ªçƒ­ç¼–ç è¯çš„ **tf-idf è¯æ±‡è¡¨**ã€‚å› ä¸ºèšç±»æ˜¯åœ¨æ•°å€¼ä¸Šæ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ªå•è¯è¯æ±‡è¡¨å¹¶è½¬æ¢å®ƒä»¬ã€‚******
*   ******ç„¶åä½¿ç”¨**è‚˜æ›²çº¿æ³•**å¹¶åœ¨**é»„ç –**åº“çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å°†æ‰¾å‡º**ç°‡**çš„æœ€ä½³æ•°ç›®ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™æœ€ç»ˆçš„èšç±»æ¨¡å‹ã€‚**é»„ç –**åº“å¸®åŠ©æˆ‘ä»¬åœ¨æ¯æ¬¡ç¼–è¯‘æ¨¡å‹/è„šæœ¬æ—¶ä¼ é€’æœ€ä¼˜çš„ ***k*** ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦ç¡¬ç¼–ç è¯¥å€¼ã€‚******

******æœ€ç»ˆçš„ç»“æœä¸æ˜¯å¾ˆç²¾ç¡®ï¼Œå› ä¸ºå®ƒæ˜¯æ— ç›‘ç£çš„å­¦ä¹ ï¼Œå¹¶ä¸”æˆ‘ä»¬åœ¨**èŒƒå›´ 2 åˆ° 10** ä¹‹é—´å¯»æ‰¾èšç±»ï¼Œå¦åˆ™ï¼Œç”±äºå¥å­çš„è¯­è¨€å±æ€§ï¼Œç›¸åŒçš„å•è¯å¯èƒ½å‡ºç°åœ¨ 2 ä¸ªä¸åŒçš„èšç±»ä¸­ã€‚******

## ******é˜…è¯»æ•°æ®é›†å¹¶æ¢ç´¢ä¸€ä¸‹:******

```
******data = pd.read_csv('Health-Tweets/bbchealth.txt', sep="|", header=None)
data.columns = ["tweet_id", "date_time", "tweet_text"]
data.head()******
```

******![](img/58c5de2ff87523d48e9424b0f025ff1d.png)******

```
******data.info() # Checking columns and number of entries
print('-------------------------')
print(round(data.isnull().sum()/len(data),2)) # Checking for any null values******
```

******![](img/f43e0787db77ec813473a4177c91eb7b.png)******

******è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº†è¡Œå’Œåˆ—åçš„æ€»æ•°ã€‚æ­¤å¤–ï¼Œä¸æåˆ°çš„ç‰¹å¾/åˆ—ç›¸å¯¹åº”çš„è¡Œéƒ½ä¸æ˜¯ç©ºçš„ã€‚æ¥ä¸‹æ¥ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦**çš„ tweet_text** ï¼Œæˆ‘ä»¬åˆ é™¤å‰©ä½™çš„ 2 åˆ—ï¼******

```
******X_train = data.drop(columns=['tweet_id','date_time']).reset_index(drop=True)
X_train.head()
print(X_train.shape) #(3929, 1)******
```

## ******ç°åœ¨ï¼Œå¤„ç†æˆ‘ä»¬åŠŸèƒ½ä¸­çš„æ–‡æœ¬:******

******é¦–å…ˆï¼Œæˆ‘ä»¬åªæ˜¯åšä¸€ä¸ªæ™®é€šçš„æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨æ¥åˆ é™¤æˆ‘ä»¬ tweets ä¸­å­˜åœ¨çš„æ‰€æœ‰ href é“¾æ¥ï¼Œç„¶åæˆ‘ä»¬å»ºç«‹ä¸€ä¸ª T2 å‡½æ•°ï¼Œå½“æˆ‘ä»¬å¼€å§‹å½¢æˆ tf-idf è¯æ±‡è¡¨æ—¶ï¼Œå®ƒè¢«ç”¨ä½œ T4 åˆ†æå™¨ã€‚è¿™æœ‰åŠ©äºé€å¥åº”ç”¨åŠŸèƒ½**ã€‚********

> ******æˆ‘ä»¬çš„å‡½æ•°**æ¥å—ä¸€ä¸ªæ–‡æœ¬å­—ç¬¦ä¸²ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹æ“ä½œ:**
> 1ã€‚åˆ é™¤æ‰€æœ‰æ ‡ç‚¹ç¬¦å·
> 2ã€‚ç§»é™¤æ‰€æœ‰åœç”¨å­—
> 3ã€‚å°†æ¸…é™¤çš„æ–‡æœ¬ä½œä¸ºå•è¯åˆ—è¡¨è¿”å›
> 4ã€‚åˆ é™¤å•è¯******

```
******X_train['tweet_text'] = X_train['tweet_text'].apply(lambda x: re.split('https:\/\/.*', str(x))[0])
X_train['tweet_text'] = X_train['tweet_text'].apply(lambda x: re.split('http:\/\/.*', str(x))[0])# Our analyser function:
def text_process(text):
    '''
    Takes in a string of text, then performs the following:
    1\. Remove all punctuation
    2\. Remove all stopwords
    3\. Return the cleaned text as a list of words
    4\. Remove words
    '''
    stemmer = WordNetLemmatizer()
    nopunc = [char for char in text if char not in string.punctuation]
    nopunc = ''.join([i for i in nopunc if not i.isdigit()])
    nopunc =  [word.lower() for word in nopunc.split() if word not in stopwords.words('english')]
    return [stemmer.lemmatize(word) for word in nopunc]******
```

******çŸ¢é‡åŒ–æ— éæ˜¯åˆ›å»ºä¸€ä¸ªç§°ä¸ºè¯æ±‡çš„å•è¯å‘é‡ã€‚
***TFIDF çŸ¢é‡å™¨ç”¨äºåˆ›å»ºä¸€ä¸ªè¯æ±‡è¡¨ã€‚TFIDF æ˜¯ä¸€ä¸ªå•è¯åœ¨æ–‡æ¡£ä¸­çš„å‡ºç°é¢‘ç‡ä¹˜ä»¥è¯¥å•è¯åœ¨æ•´ä¸ªè¯­æ–™åº“ä¸­çš„ç‹¬ç‰¹æ€§ã€‚ngram_range å‚æ•°:è¿™å°†æœ‰åŠ©äºæ ¹æ®éœ€æ±‚åˆ›å»ºä¸€ä¸ªã€ä¸¤ä¸ªæˆ–æ›´å¤šå•è¯è¯æ±‡è¡¨ã€‚*********

```
******tfidfconvert = TfidfVectorizer(analyzer=text_process,ngram_range=(1,3)).fit(X_train.tweet_text)X_transformed=tfidfconvert.transform(X_train.tweet_text)# Checking the length of the Vocabulary Created!
len(tfidfconvert.vocabulary_) # 3933******
```

## ******ä½¿ç”¨è‚˜å½¢æ›²çº¿å†³å®šèšç±»æ•°ï¼ï¼š******

```
******Sum_of_squared_distances = []
K = range(1,20)
for k in K:
    km = KMeans(n_clusters=k)
    km = km.fit(X_transformed)
    Sum_of_squared_distances.append(km.inertia_)import matplotlib.pyplot as pltplt.plot(K, Sum_of_squared_distances, 'bx-')
plt.xlabel('k')
plt.ylabel('Sum_of_squared_distances')
plt.title('Elbow Method For Optimal k')
plt.show()******
```

******![](img/c3124bec8ab5ae458cfb6d68966327ff.png)******

******æ­£å¸¸è‚˜æ›²çº¿æ³•******

******ä½†æ˜¯ï¼Œè®©æˆ‘ç»™ä½ å±•ç¤ºä¸€ä¸‹**é»„ç –åº“çš„é­”æ³•:********

```
******from yellowbrick.cluster import KElbowVisualizer
from yellowbrick.cluster.elbow import kelbow_visualizer
model = KMeans()
visualizer = KElbowVisualizer(model, k=(1,20))
# visualizer = kelbow_visualizer(KMeans(random_state=4), X_transformed, k=(2,50))
visualizer.fit(X_transformed)        # Fit the data to the visualizer
visualizer.show();        # Finalize and render the figure******
```

******![](img/f65aca2ec1bd4eb6762266f98c073597.png)******

******é»„ç –å¼¯å¤´æ›²çº¿å›¾******

******åªè¦çœ‹çœ‹å®ƒï¼Œå¤šä¹ˆæ¼‚äº®ï¼Œå®ƒçœ‹èµ·æ¥ï¼æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€é™„çš„åˆ†æ•°å’Œ k å¤„çš„**å¼¯å¤´**å€¼ã€‚å¯¹äºæ¯ä¸ªé›†ç¾¤è®¡ç®—ï¼Œå®ƒç”šè‡³è¿˜æœ‰æ—¶é—´è½´**å’Œæ—¶é—´è½´**ï¼æ¥ä¸‹æ¥ï¼Œäº‹æƒ…æ˜¯:******

```
******optimal_k = visualizer.elbow_value_
print('Optimal K found is:', optimal_k) # 9****** 
```

******ä½¿ç”¨ yellowbrick å®ç°ä¸­çš„ **elbow_value_** æ–¹æ³•ï¼Œ**æˆ‘ä»¬å¯ä»¥è‡ªåŠ¨ç›´æ¥è·å–æœ€ä½³ k å€¼**ï¼Œè¿™å°†ç”¨äºæœ€ç»ˆå»ºæ¨¡ã€‚******

## ******å»ºæ¨¡:******

******ç°åœ¨ï¼Œæ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘ä»¬å¾—åˆ°çš„æœ€ä½³é›†ç¾¤æ•°æ˜¯ç¬¬ 9 è½®ï¼Œå› æ­¤åŒæ ·çš„é›†ç¾¤æ•°å°†è¢«å‘å‰ä¼ é€’ã€‚******

```
******# Clustering the training sentences with K-means techniquemodelkmeans = KMeans(n_clusters=optimal_k, init='k-means++', n_init=100)
modelkmeans.fit(X_transformed)******
```

******åœ¨æˆ‘ä»¬å½¢æˆæ¨¡å‹åï¼Œæˆ‘ä»¬ä¹Ÿå°†å¯è§†åŒ–ä¸€äº›æ•°æ®ç‚¹æ¥è·å¾—ç›¸åŒçš„æ„Ÿè§‰ã€‚******

```
******pca = PCA(n_components=2, random_state=42)
reduced_features = pca.fit_transform(X_transformed.toarray())# reduce the cluster centers to 2D
reduced_cluster_centers = pca.transform(modelkmeans.cluster_centers_)plt.scatter(reduced_features[:,0], reduced_features[:,1], c=modelkmeans.predict(X_transformed));
plt.scatter(reduced_cluster_centers[:, 0], reduced_cluster_centers[:,1], marker='x', s=150, c='b');******
```

******![](img/afb2f1a7e58156adeb70f95f1512d099.png)******

******åå­—æ˜¯æ¨¡å‹é€‰æ‹©çš„**å½¢å¿ƒ**ã€‚æœ€ç»ˆçš„èšç±»å½¢çŠ¶æ˜¯é«˜åº¦**ä¸å‡åŒ€çš„**ï¼Œå› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©æ›´å¤šæ•°é‡çš„èšç±»ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°æ›´å¤š**å‡åŒ€çš„èšç±»**ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŒ‰ç…§æˆ‘ä»¬çš„ ***æ•°æ®ç§‘å­¦é¡¹ç›®*** æ–¹æ³•ï¼Œåœ¨åŒä¸€æ•°æ®é›†ä¸Šä¹Ÿå°è¯•äº† **MiniBatch KMEANS** ç®—æ³•ï¼******

## ******å°æ‰¹é‡æ„å‘³ç€:******

******ç°åœ¨ï¼Œ *Mini Batch KMEANS* åªæ˜¯å¯¹ä¼ ç»Ÿ KMEANS ç®—æ³•çš„æ”¹è¿›ã€‚è¿™é‡Œï¼Œç®—æ³•èƒ½å¤Ÿä½¿ç”¨ ***å°æ‰¹é‡*** ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡è¿­ä»£ä¸­ä½¿ç”¨å®Œæ•´çš„æ•°æ®é›†ï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­ç¨å¾®ç§»åŠ¨è´¨å¿ƒã€‚******

******è¿™å°†ç®—æ³•çš„é€Ÿåº¦æé«˜äº† 3 åˆ° 4 å€ï¼Œä½¿å¾—å¯¹ä¸é€‚åˆå†…å­˜çš„å¤§æ•°æ®é›†è¿›è¡Œèšç±»æˆä¸ºå¯èƒ½ã€‚ä½œä¸ºæˆ‘ä»¬å®éªŒçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ‰“ç®—ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•å¹¶è§‚å¯Ÿæœ€ç»ˆçš„èšç±»ç»“æœã€‚******

```
******clusters = MiniBatchKMeans(n_clusters=optimal_k, init_size=1024, batch_size=2048, random_state=20).fit_predict(X_transformed)# Looking at the Words Clustered out finally
def get_top_keywords(data, clusters, labels, n_terms):
    df = pd.DataFrame(data.todense()).groupby(clusters).mean()
    final_df = pd.DataFrame(columns=['Cluster','Cluster Words'])
    for i,r in df.iterrows():
        print('\nCluster {}'.format(i))
        print(','.join([labels[t] for t in np.argsort(r)[-n_terms:]]))
        x = i
        y = [labels[t] for t in np.argsort(r)[-n_terms:]]
        final_df = final_df.append({'Cluster' : x , 'Cluster Words' : y} , ignore_index=True)
    return final_df# print the top words
final_df = get_top_keywords(X_transformed, clusters, tfidfconvert.get_feature_names(), 15)******
```

******![](img/03e2ae8e2d33653d0331bfa0babf3bd6.png)******

******ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªç»“æœç´¯ç§¯åˆ°ä¸€ä¸ªæ•°æ®å¸§ä¸­:******

```
******pd.set_option("max_colwidth", None)
final_df.head(20)******
```

******![](img/c232b19e56845df94b1a193b27fbdd7c.png)******

## ******ç»“è®º:******

*   ******å› æ­¤ï¼Œæˆ‘ä»¬ç ”ç©¶äº†èšç±»ç®—æ³•çš„éœ€æ±‚åŸºç¡€ã€‚******
*   ******ä¸åŒç±»å‹çš„èšç±»æŠ€æœ¯ä»¥åŠ **K å‡å€¼å’Œå°æ‰¹é‡ K å‡å€¼**çš„å®ç°ã€‚******
*   ******æˆ‘ä»¬ç”šè‡³æ¢ç´¢äº†ä¸€äº›**æ–‡æœ¬å¤„ç†/æ¸…ç†**æ­¥éª¤ï¼Œè¿™äº›æ­¥éª¤å¯ä»¥å¸®åŠ©ä»»ä½•éœ€è¦**æ¸…ç†/å¤„ç†**æ–‡æœ¬æ•°æ®çš„é—®é¢˜é™ˆè¿°ã€‚******
*   ******æœ€åï¼Œæ‚¨å¯ä»¥è‡ªå·±æ¢ç´¢æ›´å¤šçš„èšç±»ç®—æ³•ï¼Œå¦‚: **DBSCANã€BIRCHã€Mean-Shiftã€Agglomerativeã€Affinityã€Gaussian Mixture** æ¨¡å‹ã€‚******

******æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹è¯»è€…æœ‰æ‰€å¸®åŠ©ã€‚æ›´å¤šçš„è¯é¢˜è¿˜åœ¨è·¯ä¸Šï¼Œå¦‚æœæœ‰ä»€ä¹ˆç‰¹åˆ«çš„è¯é¢˜ï¼Œè¯·åœ¨è¯„è®ºåŒºå‘Šè¯‰æˆ‘ï¼Œä¸€å¦‚æ—¢å¾€åœ°â€¦â€¦ **å¿«ä¹å­¦ä¹ ï¼********

******è¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘:******

*   ******[é¢†è‹±](https://www.linkedin.com/in/atul-mishra-5001/)******
*   ******[Github](https://github.com/mishra-atul5001)******
*   ******é‚®ä»¶:**atul.mishra5001@gmail.com********