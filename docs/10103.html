<html>
<head>
<title>Agriculture Project From Scratch To Deployment Using Deep Learning Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习架构从零开始到部署的农业项目</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/agriculture-project-from-scratch-to-deployment-using-deep-learning-architecture-fca767be094f?source=collection_archive---------5-----------------------#2020-10-05">https://medium.com/analytics-vidhya/agriculture-project-from-scratch-to-deployment-using-deep-learning-architecture-fca767be094f?source=collection_archive---------5-----------------------#2020-10-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5ff7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你只需要知道机器学习在现实世界中有多有用</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://www.youtube.com/watch?v=-CjfDjfmOU0" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=-CjfDjfmOU0</a></figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jp"><img src="../Images/57fe25a873b359a74f07e3501669b71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PUJdDkIFSwlrKRTA"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://unsplash.com/@outimarjaana?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">欧提·梅南</a>在<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="ba5d" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">目录:</h2><p id="fecc" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">(一)问题陈述</p><p id="e33a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈡动机</p><p id="a24a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈢数据处理</p><p id="effe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈣数据扩充</p><p id="3d44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈤有线电视新闻网从零开始</p><p id="078b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈥概念 3</p><p id="cfc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(七)用烧瓶展开</p><p id="8cef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈧结论</p><p id="2520" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈨未来的范围</p><p id="babc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈩参考资料</p><h2 id="42cb" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">(一)问题陈述:</h2><p id="d05e" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我们的问题陈述是给定的棉花植物或棉花叶片是患病的还是新鲜的进行分类</p><h2 id="4288" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">㈡动机:</h2><p id="3c1e" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">印度是世界上最大的棉花生产国。美国农业部(USDA)预计印度 2019-20 季节的棉花产量为 2900 万包，而前一年为 2600 万包。</p><p id="2513" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名机器学习爱好者，我想应用我的机器学习知识来提高印度棉花作物的生产力。</p><p id="421a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我的模型对一个农民有用，那对我来说也意味着很多，这个想法驱使我做这个项目。</p><h2 id="b5d8" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">㈢数据处理:</h2><p id="3545" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">为了做这个项目，我使用谷歌 Colab</p><p id="dcef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有棉花植物和棉花叶子的图像</p><p id="1645" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据分为 4 类</p><p id="109e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">患病的棉花植物</p><p id="0d34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(二)新鲜棉花植物</p><p id="7f60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(三)病棉叶</p><p id="5e66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(四)新鲜棉花叶</p><p id="bcbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我把我的数据集上传到 google drive</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kw"><img src="../Images/755646f5666d5da89cad411a1a3e64da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SkNsamt7jVxAVcDnNz7VQ.png"/></div></div></figure><p id="cd84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的数据集中，我们有 3 个文件夹</p><p id="7b26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练 _，值 _，测试 _</p><p id="091a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">train_:它包含 4 类图像，这些图像用于训练模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kx"><img src="../Images/64655d6828ccf8e589cde606dffe72a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xi5_4EP7R3gSDrO32SrDCQ.png"/></div></div></figure><p id="30e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">val_:它包含 4 类图像，这些图像用于验证训练的模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ky"><img src="../Images/510c96e6c54c3ab8334379371e6575e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4lmUIxIRpRyXK0XIHMZVw.png"/></div></div></figure><p id="5711" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">test_:它包含 4 类图像，这些图像用于测试训练好的模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kz"><img src="../Images/2c9f38e7c4e50c2f8a64f914bf6ba1c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPXB9O-2toR60VRSSfkOsA.png"/></div></div></figure><h2 id="dd6b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">㈢数据整理:</h2><p id="2392" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">数据扩充是一种从现有训练数据中人工创建新训练数据的技术。这是通过将特定于领域的技术应用于来自训练数据的示例来实现的，这些示例创建新的不同的训练示例。</p><p id="6164" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么是数据增强？</p><p id="56c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们不知道我们在生产中从用户那里得到的是哪种类型的图像，它可能是带标题的、放大的、拉伸的或翻转的，所以为了有效地对任何类型的图像进行分类，我们还需要在培训课程上进行数据扩充。</p><p id="930a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用 ImageDataGenerator 模块进行数据扩充</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es la"><img src="../Images/051066d5d44c5762d3ed4906d5b9e8be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*trio56VcsUolPDJAEbbnnw.png"/></div></div></figure><p id="e535" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我对培训类图像应用旋转、宽度移动、高度移动、剪切、缩放、翻转</p><p id="6678" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">flow_from_directory()方法允许您直接从目录中读取图像，并在神经网络模型学习训练数据时对其进行扩充</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lb"><img src="../Images/a04c4289cf7b181003f697bb52ed9d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JJC2Nen7oVV4xIqBiE3nEg.png"/></div></div></figure><p id="14b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有 1951 张图片来训练这个模型</p><p id="835f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望输入图像大小为 224 x 224，这就是我给 traget_size (224，224)的原因</p><p id="3ed9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集包含彩色图像，彩色图像用 RGB 表示</p><p id="d150" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">train _ a mented _ set[0][0][0]返回包含[R，G，B]值的 3dim 数组</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lc"><img src="../Images/566e5cdc69b76b444d0479c2cec704dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CuWnrtmL070YKsyXb6bjpA.png"/></div></div></figure><p id="656f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我写了一个函数返回增强的图像</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ld"><img src="../Images/f140497eb81a1fa3e01980c334b5bc73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3DKgcTMweOJLJ1jUFKospw.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es le"><img src="../Images/a0382dec72b92b2328ddac8b9c318d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8QOupKNw8zWPJmMB4rrrTA.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lf"><img src="../Images/749d757c7ba36ae4b5a56a7d973404b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krddE-P39Ym3xs_cTzWcGQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">增强图像</figcaption></figure><p id="1bc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们没有在 val_ class 图像上应用任何数据增强，因为它们用于验证训练的模型，如果我们增强它们，那么我们的模型会过拟合。</p><p id="cd92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们只是重新缩放 val_ class 图像</p><p id="4ebd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">val _ a gument = imagedata generator(rescale = 1。/255)</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lg"><img src="../Images/6aff262115f678783658d8369ede2bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_vW7e9-9vcZjWsC4s9Qfw.png"/></div></div></figure><p id="e8bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在验证数据集中有 324 幅图像</p><p id="0bfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型的类别</p><p id="6144" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">0:病棉叶</p><p id="52e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1:患病的棉花植株</p><p id="223a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2:新鲜棉花叶</p><p id="cadb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3:新鲜棉花植株</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lh"><img src="../Images/13d96b4ed9b1fe95be4073fec6819f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*QB_gB2JMu82piVKCixEimA.png"/></div></div></figure><h1 id="c30c" class="li jx hi bd jy lj lk ll kc lm ln lo kg lp lq lr kj ls lt lu km lv lw lx kp ly bi translated">㈣从零开始建立有线电视新闻网:</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lz"><img src="../Images/20e871a558152f4a4ec7132da81bcdbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5aNn32sff_K-F4ePzlgjEA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">图片来源:<a class="ae jo" href="https://vinodsblog.com/2018/10/15/everything-you-need-to-know-about-convolutional-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://vinodsblog . com/2018/10/15/everything-you-neural-networks/</a></figcaption></figure><p id="8fcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本 CNN 都有</p><p id="faa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积图层、最大化、完全连接、缺失、批量归一化、展平图层、输出(softmax/sigmoid)图层</p><p id="dbd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">辍学+批量正规化工作作为正规化</p><p id="5547" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的输入图像大小= (224，224)</p><p id="9a45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型架构</p><p id="42e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">con2D(内核数:3 x 3，内核数的个数= 32)</p><p id="489c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最大池 2D( 2 x 2)</p><p id="ec87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">con2D(内核数:3 x 3，内核数的个数= 64)</p><p id="d8b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最大池 2D( 2 x 2)</p><p id="8479" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">con2D(内核数:3 x 3，内核数的个数= 128)</p><p id="b5b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最大池 2D( 2 x 2)</p><p id="b7a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">con2D(内核:3 x 3，内核数量= 256)</p><p id="3797" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最大池 2D( 2 x 2)</p><p id="074e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">脱落层(脱落率=0.5)</p><p id="4353" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">展平图层</p><p id="6204" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">密集层(单位=128，激活=relu)</p><p id="96d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">脱落层(脱落率=0.1)</p><p id="dcbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">密集层(单位=256，激活=relu)</p><p id="46db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">脱落层(脱落率=0.25)</p><p id="6e9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">密集图层(units=no_of_classes(4)，activation =softmax) == &gt;输出图层</p><p id="8e54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的问题陈述属于多类分类，这就是为什么输出层激活是 Softmax</p><p id="74ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用的库:带有后端 Tensorflow 的 Keras</p><p id="fe45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入必要的模块</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ma"><img src="../Images/6ca907430b806d17b94d3a859c4d6692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*968dCwmAHSwgpCmtujEEoA.png"/></div></div></figure><p id="9e5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 Keras 中建立<strong class="ih hj"> g 卷积神经网络的步骤</strong></p><p id="01b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(一)建筑模型:定义建筑</p><p id="cb41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(ii)编译:给出元数据(如丢失、优化器等)</p><p id="b303" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈢符合模型</p><p id="f9a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤 1:构建模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mb"><img src="../Images/f27f3eca1b553cf6190cdf4d280dfa1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nmn_1cFjY4nil7Y4df6Ohg.png"/></div></div></figure><p id="54a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二步:编译</p><p id="a015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用 optimizer =Adam(lr=0.0001)，loss = ' categorical _ crossentropy '，metrics='accuracy '</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mc"><img src="../Images/9e8c7cc96693033f41ada13f0c262d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vqNblhXxxc7763udHiEMyA.png"/></div></div></figure><p id="456a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第三步:拟合模型</p><p id="8065" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我为 50 个时代建立了模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es md"><img src="../Images/7e8a05174d485fe43cbe7eda05978295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9hpfvEtENGDT5isErPWgRg.png"/></div></div></figure><p id="4e7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第 50 个纪元结束时</p><p id="afa8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练 _ 数据 _ 设置 _ 准确度= 0.88</p><p id="0d9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">validation _ data _ set _ accuracy = 0.85</p><p id="99d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">新纪元 vs 失落:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es me"><img src="../Images/404479e84fb63159695374450d106c09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqfIK_USU9dqRsjUIwQFjg.png"/></div></div></figure><p id="9a73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">历元对精度</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mf"><img src="../Images/e46deb1cf706feaaef0bd2574b667ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rq2LpSP44OhTcAWUz7JA3A.png"/></div></div></figure><p id="a826" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型评估:</strong></p><p id="ebf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了评估训练的模型，我们使用验证数据集类图像</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mg"><img src="../Images/1d81d147ecf4a75b834d64d76ef28388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cj5Yvy4s77VummGVoJQDBw.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mh"><img src="../Images/f8f1ffbb8ab8252c26baf4feba834bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*ozCmyuRIvgaQZyDCUycYNA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">验证数据集的类别</figcaption></figure><h2 id="b2dc" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">预测验证数据集图像的类别</h2><p id="1447" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在验证数据集中，我们有 324 幅图像</p><p id="1bee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">利用训练好的 CNN 模型预测个人图像的类别</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es me"><img src="../Images/6cf002d64aeac0d1bc62d0cade68a1aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-9pa7o9iVtHYYD8Q0U2oUQ.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mi"><img src="../Images/49fd95a2c1ec975610d2dca96202b9cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Zg4KHdPG57v2VfS7ORRsg.png"/></div></div></figure><p id="db52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用测试数据集图像测试训练模型</strong></p><p id="aab8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在测试之前，我们需要保存训练好的模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mj"><img src="../Images/c6bf775bedd6e6697408bc44bea966e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXIiB6Qro4CEiZQihrKY7g.png"/></div></div></figure><p id="15fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正在加载保存的模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mk"><img src="../Images/e5a93004f28639960dfbc081b868c59f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*liy-lclzQTg6mG5CKyaY3Q.png"/></div></div></figure><p id="f689" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我从 test_ data 集中获取新图像来测试训练好的模型。</p><p id="2a87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Test_ data set 图像是模型中的新图像。</p><p id="20eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果模型正确地预测了图像类别，那么我们训练的模型被认为是一般化模型。</p><p id="1d16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入必要的模块</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ml"><img src="../Images/978e7db341c58c9a5dd5eceaafe8cd63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ecK_R4N3PfXpoYfYycACQ.png"/></div></div></figure><p id="9db5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从测试数据集中加载图像</p><p id="4d18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我拍了一张患病棉花叶子的照片</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mm"><img src="../Images/774d8488910aa6d7b1cd4ba38e46d965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0b0EzdifSHbyAkVSL0kmbg.png"/></div></div></figure><p id="c3f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将加载的图像转换成数组</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mn"><img src="../Images/0444e4379e2d9e5d602350f87feed463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*dCsAGB7dnzhpgf-lfHMOoQ.png"/></div></figure><p id="c80e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以[R，G，B]的形式将加载的图像转换为 3dim 数组</p><p id="f0f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要归一化[R，G，B]值</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mo"><img src="../Images/b2cbc17e17fdaad188995f0e5ee3f66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*5W-5BvPwV-PopBK7Nsza7w.png"/></div></figure><p id="9f46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">预测加载图像的类别</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mp"><img src="../Images/a19bc262b689bf437d0ba54a8b4f9ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8SBE1bSgP6HYEP5hUMfkaw.png"/></div></div></figure><p id="f928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样，我们就可以将训练好的模型归纳为泛化模型</p><h1 id="67bf" class="li jx hi bd jy lj lk ll kc lm ln lo kg lp lq lr kj ls lt lu km lv lw lx kp ly bi translated">㈥迁移学习:</h1><p id="8c01" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">迁移学习是在新问题上重新使用预先训练好的模型。它目前在深度学习中非常流行，因为它可以用相对较少的数据训练深度神经网络。</p><p id="4640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">著名预训练模特</strong></p><p id="533f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈠resnet 50:25 636 712 个参数</p><p id="1e31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈡resnet 152 v2:60，380，648 个参数</p><p id="96fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈢第三项:23 851 784 个参数</p><p id="3493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我选择 InceptionV3 是因为与其他模型相比，它的参数更少，参数越少，响应时间越短</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mq"><img src="../Images/7c3fb9c71c90792d1e20e86f9bfeb814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x54zQUOu3P6RVlKoxK16kQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">图片鸣谢:<a class="ae jo" href="https://www.analyticsvidhya.com/blog/2020/08/top-4-pre-trained-models-for-image-classification-with-python-code/inceptionv3/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2020/08/top-4-pre-trained-models-for-image-class ification-with-python-code/inceptionv3/</a></figcaption></figure><p id="9cbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Inceptionv3 </strong>由两部分组成:(一)特征提取(二)卷积神经网络。</p><p id="7b4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用 imagenet 权重</p><p id="444c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们不训练提取特征</p><p id="7c63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们只训练最后几层</p><p id="9971" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入必要的模块</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mr"><img src="../Images/248e6bc2cdfdc6748d92afa7f9f0b646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhtrH_jhgH4vkk_Dz3neXw.png"/></div></div></figure><p id="02f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于 InceptionV3 型号，默认输入图像大小= [224，224]</p><p id="795a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的输入图像是彩色图像。</p><p id="1689" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们需要给输入的 image_size 加上+ 3</p><p id="85cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用 imagenet 权重加载初始模型，并排除最后几层</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ms"><img src="../Images/f38eebe0a228e34735518f1a439095d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IzeOm-L364xh507e8D9tmQ.png"/></div></div></figure><p id="9b86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们不想从头开始训练完整的模型。所以我们不为 imagenet 权重训练我们的模型。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mt"><img src="../Images/87d03ebb0776527f1e008a898caef5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ttFw2_GlK3k3TA1zPNDWNA.png"/></div></div></figure><p id="61b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据集中的类别数</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mu"><img src="../Images/5b8a6608f795994a6de39736c311b33e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qn9DC99k_z4YWv8ECK3Phw.png"/></div></div></figure><p id="1940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有 4 节课</p><p id="d639" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要展平 InceptionV3 模型输出</p><p id="de99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过展平 inceptionV3 模型，我们得到瓶颈层输出</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mv"><img src="../Images/6ee9a364d3ab9fd3246713d6f3cf6984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efnghGrvTMyRW4Ud1rPNDA.png"/></div></div></figure><p id="6d41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要添加层到瓶颈层输出。</p><p id="9d67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以添加任意数量的层</p><p id="8a61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我只添加了一个密集层(units=no_of_classes，activation=softmax)</p><p id="f716" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有 4 个类，所以我们在密集层需要 4 个单位，激活是 softmax</p><p id="8d72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将 softmax 激活应用于瓶颈层输出</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mw"><img src="../Images/e0eb5c952c8c4d432311cf21da789faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-kqkfm2onZn2hVMXqKTag.png"/></div></div></figure><p id="3df1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步:模型构建</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mx"><img src="../Images/bf538e5afd48a9564a6391293b1bc114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gTzr_zCMRMu_Gm0XC9jMjQ.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es my"><img src="../Images/d7292360f3261eb3b401867ebf0a61e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sndVj6TYLqOJecfp3Fu1ew.png"/></div></div></figure><p id="5e1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型的总参数=22，007，588</p><p id="3c72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是只有 204，804 个参数是可训练的</p><p id="5bd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二步:编译</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mz"><img src="../Images/a4f7816650d3d04f9ce79e347327c168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lw_XTQkFHGSSSCNst1j49w.png"/></div></div></figure><p id="df2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第三步:拟合模型</p><p id="d26f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我为 50 个时代建立了模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es na"><img src="../Images/8dacd9f8b2e874864e64c49bac58ac5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYfnxzffLKUFd5iHy0SVhg.png"/></div></div></figure><p id="e8e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第 50 个纪元结束时</p><p id="dc59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练精度= 0.93</p><p id="48e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">验证准确度= 0.94</p><h2 id="406d" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">时代 vs 损失</h2><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nb"><img src="../Images/817d72eb1f9d2f3b8a89d93e21046dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gl46FV28GG38RGhmzsekcw.png"/></div></div></figure><h2 id="7ce8" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">纪元与精确度</h2><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nc"><img src="../Images/dc3c0f72db31e8e0e8bcb2300d0b93a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9yM_fM5aGY-r4X9XQ9b0Xw.png"/></div></div></figure><h2 id="c713" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated"><strong class="ak">转移已学模型评估</strong></h2><p id="c6c3" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">使用验证数据集图像评估 inceptiov3 模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nd"><img src="../Images/b5de8041bd8e92b6042fc1afb91cdcfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LLnbtymfizEjDNRRWEzA9g.png"/></div></div></figure><p id="7851" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单独预测验证数据集图像的类别</p><p id="79b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在验证数据集中有 324 幅图像</p><p id="da56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们单独预测每一类图像</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ne"><img src="../Images/ac076b9c19db86ad9d9567ce429f3ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kjgtaSlemyLKSsLRx_Zog.png"/></div></div></figure><h2 id="3226" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">用测试数据集图像测试迁移学习模型</h2><p id="f137" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在测试之前，我们需要保存迁移学习模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es my"><img src="../Images/10e8b31bf26aeef3572a39f642ce8c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DW1uq90Gec0j1VldurSEmQ.png"/></div></div></figure><p id="20e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正在加载保存的模型</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nf"><img src="../Images/7a7c81a0fb227c85610aa6cb91dd867f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3Xnvr1t6fOmUhmnVAa5og.png"/></div></div></figure><p id="e679" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我从 test_ data 集中取了一张图片来测试训练好的迁移学习模型。</p><p id="1703" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我特意拍了一张患病棉花叶子的照片</p><p id="2d45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要测试我们是否得到了相同的类</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ng"><img src="../Images/02fe809423265fcbd76a5e52eed231f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*39bgSuXY_uqvYFv7B-DNtw.png"/></div></div></figure><p id="6866" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从测试数据集中加载图像</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nh"><img src="../Images/03b82cc8ea751ce38dfe0aa591d1aea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfu2MUQfE7kEIuS7Uj5jyg.png"/></div></div></figure><p id="6186" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要将图像转换成一个数组</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ni"><img src="../Images/e26148fb91fd8500c10eccff8e92eb22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-9HPNXKYCsGAUIBgBfxug.png"/></div></div></figure><p id="e630" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的输入图像是彩色图像</p><p id="7705" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以数组的形式是[R，G，B]</p><p id="4ee5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要归一化[R，G，B]值</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nj"><img src="../Images/88fe0d400b02d11e7bd2f00341602e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSx8XkDH86OXRR_8dZ_fwA.png"/></div></div></figure><p id="d744" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">预测图像类别</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nk"><img src="../Images/d0bd5b4417d14cc3f9f1f33a0530e9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--ebCU5Gn2zaAcEvTtQ5TA.png"/></div></div></figure><p id="8937" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">拍摄的图像是患病的棉花叶子</p><h1 id="416c" class="li jx hi bd jy lj lk ll kc lm ln lo kg lp lq lr kj ls lt lu km lv lw lx kp ly bi translated">(七)用烧瓶展开:</h1><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nl jj l"/></div></figure><h1 id="c937" class="li jx hi bd jy lj lk ll kc lm ln lo kg lp lq lr kj ls lt lu km lv lw lx kp ly bi translated">㈧结论:</h1><h2 id="50f4" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">CNN 模型</h2><p id="ba0a" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">参数:5141188</p><p id="3831" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">纪元=50</p><p id="09a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第 50 个历元时，Val_accuracy=0.85，accuracy=0.87</p><h2 id="879f" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">InceptionV3 模型</h2><p id="559f" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">总参数:22，007，588</p><p id="79dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">纪元=50</p><p id="4892" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第 50 个时期，训练精度= 0.93，验证精度= 0.94</p><p id="5e6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用迁移学习模型总是更好，因为它可以用更少的数据训练深度神经网络，并且与 CNN 相比，它还可以从头开始提供良好的准确性。</p><h1 id="9121" class="li jx hi bd jy lj lk ll kc lm ln lo kg lp lq lr kj ls lt lu km lv lw lx kp ly bi translated">㈨未来的范围:</h1><ul class=""><li id="0b85" class="nm nn hi ih b ii kr im ks iq no iu np iy nq jc nr ns nt nu bi translated">尝试更多迁移学习模式</li><li id="5571" class="nm nn hi ih b ii nv im nw iq nx iu ny iy nz jc nr ns nt nu bi translated">使用 Keras-tuner 微调 CNN 模型</li></ul><h1 id="c93b" class="li jx hi bd jy lj lk ll kc lm ln lo kg lp lq lr kj ls lt lu km lv lw lx kp ly bi translated">㈩参考资料:</h1><p id="3985" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">谷歌(一些定义)</p><p id="9059" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Krish naik youtube 频道(用户界面部分)</p><p id="a658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">印度 ai 制作 youtube 频道(数据部分)</p></div></div>    
</body>
</html>