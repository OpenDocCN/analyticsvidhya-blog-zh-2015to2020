<html>
<head>
<title>Machine Translation(Encoder-Decoder Model)!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器翻译(编码器-解码器模型)！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-translation-encoder-decoder-model-7e4867377161?source=collection_archive---------0-----------------------#2019-10-31">https://medium.com/analytics-vidhya/machine-translation-encoder-decoder-model-7e4867377161?source=collection_archive---------0-----------------------#2019-10-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="eb30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">理解和建立一个简单的模型，将英语翻译成印地语的指南。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/774b474c27bbf14694e99d57a2848adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kikfIfg6HtR8q3_ZTOp-1g.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae jt" href="https://www.microsoft.com/en-us/translator/blog/2018/03/14/human-parity-for-chinese-to-english-translations/" rel="noopener ugc nofollow" target="_blank">https://www . Microsoft . com/en-us/translator/blog/2018/03/14/human-parity-for-Chinese-to-English-translations/</a></figcaption></figure><h1 id="5aa3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">内容-</h1><p id="3504" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">1-引言。</p><p id="30ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2-先验知识。</p><p id="2724" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3-编码器-解码器的体系结构。</p><p id="6def" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4-了解模型的编码器部分。</p><p id="de79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5-在训练阶段理解模型的解码器部分。</p><p id="2ed6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6-在测试阶段理解模型的解码器部分。</p><p id="5ffa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7码</p><p id="0a02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8-结果。</p><p id="874e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9-参考文献。</p><h1 id="39de" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">简介-</h1><p id="de83" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">编码器-解码器模型是使用递归神经网络解决序列间预测问题的一种方式。</p><p id="cc1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它最初是为机器翻译问题开发的，尽管它已经被证明在相关的序列到序列预测问题上是成功的，例如文本摘要和问题回答。</p><p id="f7ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该方法涉及两个递归神经网络，一个用于编码输入序列，称为编码器，另一个用于将编码的输入序列解码为目标序列，称为解码器。</p><p id="77ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是序列在序列模型中的一些应用</p><ul class=""><li id="2b9e" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">聊天机器人</li><li id="2d70" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">机器翻译</li><li id="e897" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">文本摘要</li><li id="8857" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">图像字幕</li></ul><h1 id="0898" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">先验知识-</h1><ul class=""><li id="6974" class="kx ky hi ih b ii ks im kt iq ll iu lm iy ln jc lc ld le lf bi translated">RNN / LSTM /GRU的概念，以及LSTM在喀拉斯的工作需要理解这个职位。</li></ul><h1 id="346d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">编码器-解码器的架构</h1><p id="0b3d" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">常用的序列对序列模型(编码器-解码器)的总体结构如下所示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/bef0df1f0236b3e340393c4cde3093c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zq1G3mPSuy-KoMlBldohww.png"/></div></div></figure><p id="ecbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它由3部分组成:<strong class="ih hj"> <em class="lp">编码器、中间矢量和解码器。</em> </strong></p><p id="ec4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lp">编码器- </em> </strong>它在每个时间步接受输入序列的单个元素，对其进行处理，收集该元素的信息并将其向前传播。</p><p id="d873" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lp">中间向量</em> </strong> -这是从模型的编码器部分产生的最终内部状态。它包含关于整个输入序列的信息，以帮助解码器做出准确的预测。</p><p id="c1cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lp">解码器- </em> </strong>给定整个句子，它预测每个时间步的输出。</p><h1 id="4e59" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">理解模型的编码器部分-</h1><ul class=""><li id="2328" class="kx ky hi ih b ii ks im kt iq ll iu lm iy ln jc lc ld le lf bi translated">编码器基本上是LSTM/GRU单元。</li><li id="cade" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">编码器接收输入序列，并将信息封装为内部状态向量。</li><li id="e7bc" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">编码器的输出被拒绝，仅使用内部状态。</li></ul><p id="0067" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来理解模型的编码器部分是如何工作的-</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/8f78a611d9a8f9974948e06d47f019d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gXq4KeN_EDuRh8H2I35Fsg.png"/></div></div></figure><p id="b417" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">LSTM一次只取一个元素，所以如果输入序列的长度为m，那么LSTM需要m个时间步长来读取整个序列。</p><ul class=""><li id="4644" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">Xt是时间步长t的输入。</li><li id="2a1d" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">ht和ct是LSTM在时间步长t的内部状态，而对于GRU，只有一个内部状态ht。</li><li id="bed1" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">Yt是时间步长t的输出。</li></ul><p id="0267" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们考虑一个英语到印地语翻译的例子</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/2740dd1ba4bbdfd6aaffb288dcb31fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Eg7wH4N8fFQJfepEiz80g.png"/></div></div></figure><p id="2821" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lp">编码器的输入Xt- </em> </strong></p><p id="a940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想想英语句子——印度是个美丽的国家。这个序列可以认为是一个包含4个单词(印度，是，美丽，国家)的句子。所以在这里</p><p id="d28d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">X1 = '印度'</p><p id="0607" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">X2= '是'</p><p id="ec6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">X3=“漂亮”</p><p id="1ba5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">X4= '国家'。</p><p id="aa2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，LSTM将在如下4个时间步骤中逐字读出该序列</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/a6ddd81ebba6bb66276ccc8437abfe6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-pyxBbWWT3gDJp74o_kUw.png"/></div></div></figure><p id="88cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，每个Xt(每个单词)使用单词嵌入表示为一个向量，它将每个单词转换为一个固定长度的向量。</p><p id="2383" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lp">现在即将进入内部状态(ht，CT)——</em></strong></p><ul class=""><li id="da47" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">它学习LSTM已经阅读了什么，直到时间步t。例如，当t=2时，它记得LSTM已经阅读了'<em class="lp"> India is '。</em></li><li id="4930" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">初始状态h0、c0(两者都是向量)被随机初始化或初始化为零。</li><li id="1e93" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">记住，ho，co的量纲，等于LSTM晶胞中的单位数。</li><li id="239d" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">最终状态h4，c4包含了整个输入序列I的症结<em class="lp"> ndia是美丽的国家。</em></li></ul><p id="53cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lp">编码器的输出Yt- </em> </strong></p><p id="9596" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个时间步的Yt是每个时间步的LSTM的预测值。在机器翻译问题中，我们在阅读了整个输入序列后生成输出。所以在编码器的每个时间步，Yt是没有用的，所以我们丢弃它。</p><p id="b486" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lp">所以总结一下模型的编码器部分——</em></p><p id="999f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编码器将一个字一个字地读取英语句子，并存储在最后一个时间步长之后生成的LSTM的最终内部状态(称为中间向量),并且由于一旦读取了整个序列就将生成输出，因此丢弃编码器在每个时间步长的输出(Yt)。</p><h1 id="60b1" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">在训练阶段理解模型的解码器部分-</h1><p id="ec11" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">解码器的工作在训练和测试阶段是不同的，不像模型的编码器部分在训练和测试阶段以相同的方式工作。</p><p id="aa2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们了解一下训练阶段解码器的工作原理</p><p id="256b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以翻译<strong class="ih hj"> <em class="lp">印度是美丽的国家</em> </strong> <em class="lp"> </em>为例，就像编码器一样，解码器也逐字生成输出句子。</p><p id="44bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们要生成输出—<strong class="ih hj"><em class="lp"/></strong></p><p id="9d4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了让解码器识别序列的开始和结束，我们将在输出序列的开头添加START_并在输出序列的结尾添加_END。</p><p id="1369" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们输出的句子会是<strong class="ih hj"><em class="lp">start_भारतखूबसूरतदेशहै_ end</em></strong></p><p id="d457" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从视觉上理解工作--</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/1ff68903932b89a64885d27711dbeb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mBnKJGJWAbj45ZGW_w3Q0g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">训练中的解码器LSTM</figcaption></figure><ul class=""><li id="42c8" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">解码器的初始状态(h0，c0)被设置为编码器的最终状态。可以认为解码器被训练成基于编码器收集的信息来生成输出。</li><li id="03d7" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">首先，我们输入START_以便解码器开始产生下一个字。在印地语句子的最后一个单词之后，我们让解码器学会预测结尾。</li><li id="92ab" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">这里我们使用教师强制技术，其中每个时间步的输入是实际输出，而不是最后一个时间步的预测输出。</li><li id="2733" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">最后，根据每个时间步的预测输出计算损失，误差随时间反向传播以更新模型的参数。</li><li id="bc97" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">当我们得到输出时，解码器的最终状态被丢弃，因此它是无用的。</li></ul><p id="b9a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lp">直观总结编解码- </em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/ecfbe3277aadff8a4cf5d3ae4bab2d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R8c4QECLVCQ8uYhZxP7mAQ.png"/></div></div></figure><h1 id="86e6" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">在测试阶段理解模型的解码器部分-</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/0141642ff9765e39d9fb495e43a99d8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y3fNvBFJibYF7sVz4FRE0Q.png"/></div></div></figure><p id="147e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">测试期间解码器的处理-</p><ul class=""><li id="816f" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">解码器的初始状态被设置为编码器的最终状态。</li><li id="fee7" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">解码器中的LSTM在每个时间步长处理单个单词。</li><li id="8a23" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">解码器的输入总是从START_开始。</li><li id="c50d" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">每个时间步长后产生的内部状态作为下一个时间步长的初始状态。例如，在t=1时，输入START_后产生的内部状态作为t=2时的初始状态。</li><li id="cd7c" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">每个时间步产生的输出作为下一个时间步的输入。</li><li id="0f1e" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">当解码器预测结束时，我们就知道序列的结束。</li></ul><h1 id="e343" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">代码-</h1><p id="e9bf" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在我们已经了解了编码器-解码器模型是如何工作的，让我们看看将英语翻译成印地语的代码。</p><ul class=""><li id="5b43" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">加载数据并查看一些数据点。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/212ee30b230e9d6dc1e4fcfaf2ca3691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4TGcYf4Z5Tm5Pf98hMUvIg.png"/></div></div></figure><ul class=""><li id="fe19" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">第二步是预处理数据，使其干净并易于处理。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/a0e280f1b0461033c97c5de357d23b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxTIVLTHOXBcxGaQnu7MsA.png"/></div></div></figure><ul class=""><li id="b84c" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">预处理后，将START_ and _END添加到印地语句子中，创建所有独特的英语和印地语单词的词汇，并计算英语和印地语的词汇大小和最大句子长度</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/e7a5cf4774a0fc8825d4ac84ac240783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R477T0KG8hT8z0CdV8TXsg.png"/></div></div></figure><ul class=""><li id="d2e7" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">接下来，我们创建4个Python字典，将给定的单词转换成整数索引，反之亦然。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/372b14786aa99d1548546332bf17a515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mEuOCk8D-hl9KyZrc8P73A.png"/></div></div></figure><ul class=""><li id="d4f3" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">现在，我们将把数据分为训练和测试，并定义一个函数来批量生成训练和测试数据。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/0afcadb83ffb46129f4e60c03bec072e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w9Gbqm2E9pyqidadhTF86A.png"/></div></div></figure><ul class=""><li id="a020" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">下一步是定义编码器-解码器架构。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/d7202d7f193828aca39649d5930104ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5DgqnG3pj9cvuJ7sxusLWg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">编码器</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/b239a766a583ef8e68d6114091782908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-XtIH1fCr6FuV35olmvwAA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">解码器</figcaption></figure><ul class=""><li id="2ff6" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">将模型训练100个纪元。训练结束后，就该对测试数据进行预测了。</li><li id="1240" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">因此，我们将设置测试模式如下-</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/6d8848e2f6500b028721bbffbd3ed1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfhqQhXTWGRloMb9lpjNnA.png"/></div></div></figure><ul class=""><li id="347a" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">最后，我们将通过定义下面的函数并稍后调用它来生成输出。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/4d52330abdfa72926b8cfc6bd52c1ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t5FaD1IS6YYsy5b_YZS7dQ.png"/></div></div></figure><h1 id="b31d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结果-</h1><ul class=""><li id="1b8d" class="kx ky hi ih b ii ks im kt iq ll iu lm iy ln jc lc ld le lf bi translated">训练数据的结果——下图显示我们的模型在训练数据上表现良好。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/9b10a393fdf68a5484e5e570f42da6cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*Pj_vl1lztaNsR8FJdz_lBA.png"/></div></figure><ul class=""><li id="6db4" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">测试数据的结果——如下所示，测试数据的结果不是很好，但还可以，因为首先它不是一个最先进的模型，而是一个非常简单的模型；其次，这里使用的数据集太小，无法产生令人满意的结果。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/ffce73d463efd361100e41d9dac63697.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*p5DE3aWouMUtzXrAf79xiw.png"/></div></figure><h1 id="9b62" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">参考文献-</h1><ol class=""><li id="f24a" class="kx ky hi ih b ii ks im kt iq ll iu lm iy ln jc mc ld le lf bi translated">ht<a class="ae jt" href="https://arxiv.org/pdf/1409.3215.pdf" rel="noopener ugc nofollow" target="_blank">TPS://arxiv . org/pdf/1409.3215 . pdf</a></li><li id="ecca" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc mc ld le lf bi translated"><a class="ae jt" href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html" rel="noopener ugc nofollow" target="_blank">https://blog . keras . io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras . html</a></li><li id="61bd" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc mc ld le lf bi translated"><a class="ae jt" href="https://www.kaggle.com/aiswaryaramachandran/english-to-hindi-neural-machine-translation" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/aiswaryaramachandran/英语到印地语的神经机器翻译</a></li><li id="8811" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc mc ld le lf bi translated"><a class="ae jt" href="https://towardsdatascience.com/word-level-english-to-marathi-neural-machine-translation-using-seq2seq-encoder-decoder-lstm-model-1a913f2dc4a7" rel="noopener" target="_blank">https://towards data science . com/word-level-English-to-Marathi-neural-machine-translation-using-seq 2 seq-encoder-decoder-lstm-model-1a 913 F2 DC 4a 7</a></li><li id="7218" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc mc ld le lf bi translated">AAIC</li></ol><p id="d25f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lp">感谢您阅读到最后！！</em></p></div></div>    
</body>
</html>