<html>
<head>
<title>Create your Own Coronavirus in 3D</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建自己的3D冠状病毒</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-your-own-coronavirus-in-3d-37d1ac5a5437?source=collection_archive---------11-----------------------#2020-03-21">https://medium.com/analytics-vidhya/create-your-own-coronavirus-in-3d-37d1ac5a5437?source=collection_archive---------11-----------------------#2020-03-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5c50" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">用20行代码缩放和旋转您自己的新冠肺炎。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/61c9ef712b118e29814eb0011d8eb955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ny3WEPeSxQxCPeyfoUYezA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">应用程序截图</figcaption></figure><blockquote class="jn jo jp"><p id="db15" class="jq jr js jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这个简短的故事是关于你如何能够容易地可视化冠状病毒的3D模型。由此产生的<strong class="jt hj">微型网络应用</strong>允许你通过鼠标与“病毒”互动。</p></blockquote><p id="15d1" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated"><em class="js">在冠状病毒危机中，我们得到了许多病例数的更新、研究和预测。因为一级防范禁闭，我有很多时间可以自由支配。上周末，我创建了两个网络应用程序来下载和可视化新冠肺炎案件的数字(见中帖:</em><a class="ae kq" href="https://towardsdatascience.com/visualise-covid-19-case-data-using-python-dash-and-plotly-e58feb34f70f" rel="noopener" target="_blank"><em class="js">Python-Dash</em></a><em class="js">、</em><a class="ae kq" href="https://towardsdatascience.com/create-a-coronavirus-app-using-r-shiny-and-plotly-6a6abf66091d" rel="noopener" target="_blank"><em class="js">R-Shiny</em></a><em class="js">)。现在我花了一些时间在更有趣的事情上:3D可视化。</em></p><p id="e4dd" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">这个应用程序的实现将使用R来完成。<a class="ae kq" href="https://www.r-project.org/about.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jt hj"> R语言</strong> </a>主要由统计学家和数据科学家使用，但它也有一个非常好的包来处理使用OpenGL的3D可视化(<strong class="jt hj">包“</strong><a class="ae kq" href="https://cran.r-project.org/web/packages/rgl/vignettes/rgl.html" rel="noopener ugc nofollow" target="_blank"><strong class="jt hj">Rgl</strong></a><strong class="jt hj">“</strong>)。</p><p id="d820" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">这个故事将展示如何解决这个任务，分为两个部分:</p><ol class=""><li id="891e" class="kr ks hi jt b ju jv jx jy kn kt ko ku kp kv km kw kx ky kz bi translated"><strong class="jt hj">让它运行</strong> : 101让应用程序运行<strong class="jt hj">。</strong></li><li id="538c" class="kr ks hi jt b ju la jx lb kn lc ko ld kp le km kw kx ky kz bi translated"><strong class="jt hj">工作原理</strong>:代码理解。</li></ol></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="d1c8" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">让它跑起来</h1><h2 id="b08b" class="me ln hi bd lo mf mg mh ls mi mj mk lw kn ml mm ly ko mn mo ma kp mp mq mc mr bi translated">下载3D模型</h2><p id="90c6" class="pw-post-body-paragraph jq jr hi jt b ju ms ij jw jx mt im jz kn mu kc kd ko mv kg kh kp mw kk kl km hb bi translated">首先让我们以我们理解的格式下载一个免费的3D模型。我在<a class="ae kq" href="https://sketchfab.com/3d-models/coronavirus-covid-19-virus-991102145c294fe4b633faecc23f3799" rel="noopener ugc nofollow" target="_blank"> Sketchfab </a>上发现了一个85k顶点的模型(CC授权，Evan Pachon)。下载并以原始格式(obj)保存文件。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="afdc" class="me ln hi bd lo mf mg mh ls mi mj mk lw kn ml mm ly ko mn mo ma kp mp mq mc mr bi translated">设置开发环境</h2><p id="9ef9" class="pw-post-body-paragraph jq jr hi jt b ju ms ij jw jx mt im jz kn mu kc kd ko mv kg kh kp mw kk kl km hb bi translated">如果你的PC上没有安装R，那么按照我的<a class="ae kq" href="https://towardsdatascience.com/visualise-covid-19-case-data-using-python-dash-and-plotly-e58feb34f70f" rel="noopener" target="_blank">上一篇文章</a>中描述的“步骤1”打开RStudio。将软件包安装代码替换为:</p><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="faf2" class="me ln hi na b fi ne nf l ng nh">&gt; packages = c("shiny", "rgl", "shinycssloaders", "readobj")<br/>&gt; install.packages(packages)</span></pre><p id="6c5f" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">我们稍后会看到这些包的用途。现在创建一个新的空白闪亮项目。同样，如果你是R的新手，只需按照上面提到的文章中的“步骤2”去做。但是，不要删除文件"<em class="js"> app。R" </em>，因为我们将使用它作为我们的主要应用程序文件。将上一节中获得的OBJ文件移动到该文件夹中。</p><h2 id="e547" class="me ln hi bd lo mf mg mh ls mi mj mk lw kn ml mm ly ko mn mo ma kp mp mq mc mr bi translated">“小”编码</h2><p id="2470" class="pw-post-body-paragraph jq jr hi jt b ju ms ij jw jx mt im jz kn mu kc kd ko mv kg kh kp mw kk kl km hb bi translated">您所需要的只是下面的小代码块。替换现有的<em class="js"> app内容。R </em>"用这几行。</p><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="e15b" class="me ln hi na b fi ne nf l ng nh">library(shiny)<br/>library(rgl)<br/>library(shinycssloaders)<br/>library(readobj)</span><span id="770a" class="me ln hi na b fi ni nf l ng nh">ui = fluidPage(<br/>  titlePanel("Coronavirus / COVID-19 in 3D"),<br/>  fluidRow(<br/>    rglwidgetOutput("rglWidget", width="100%") %&gt;% withSpinner()<br/>  )<br/>)</span><span id="78e2" class="me ln hi na b fi ni nf l ng nh">server = function(input, output, session) {<br/>  <br/>  output$rglWidget = renderRglwidget({<br/>    model = read.obj("coronavirus.obj", convert.rgl=TRUE)<br/>    open3d()<br/>    shade3d(model$Layer_1, color="darkgray")<br/>    shade3d(model$Layer_2, color="red")<br/>    bg3d(gray(level=0.95))<br/>    rglwidget(reuse=TRUE)<br/>  })<br/>}</span><span id="d8ec" class="me ln hi na b fi ni nf l ng nh">shinyApp(ui=ui, server=server)</span></pre><p id="23d0" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">就是这样。你可以<strong class="jt hj">按下<em class="js">运行App </em>按钮启动app </strong>:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/87322b86e396f289f057351c02ef7299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uT4ng0U48Rv4gl3otCKj7A.png"/></div></div></figure><p id="0fbf" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">通过点击“<em class="js">运行应用程序</em>”按钮，还会出现一些附加选项。勾选<em class="js">运行外部</em>选项，重新运行应用，应用将<strong class="jt hj">在默认浏览器</strong>中启动。</p><p id="bf0f" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated"><em class="js">顺便说一句，如果你在Mac上，你可能需要下载并安装</em><a class="ae kq" href="https://www.xquartz.org/" rel="noopener ugc nofollow" target="_blank"><em class="js">XQuartz</em></a><em class="js">才能正常工作。</em></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nk"><img src="../Images/935d0247f4d2994db08c551ab8a911a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZduDNcGY5ZkzyZkV"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae kq" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Markus Spiske </a>在<a class="ae kq" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="2cac" class="lm ln hi bd lo lp nl lr ls lt nm lv lw io nn ip ly ir no is ma iu np iv mc md bi translated">它是如何工作的</h1><p id="73ab" class="pw-post-body-paragraph jq jr hi jt b ju ms ij jw jx mt im jz kn mu kc kd ko mv kg kh kp mw kk kl km hb bi translated">一个闪亮的应用程序分为两部分:用户界面(ui)和服务器。</p><p id="2025" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">我们的UI由所谓的<strong class="jt hj">流体布局</strong>组成，它由行和列组装而成。我们只需要一个标题行和一个包含GL小部件的附加流体行。函数<em class="js"> rglwidgetOutput </em>是<a class="ae kq" href="https://cran.r-project.org/web/packages/rgl/vignettes/rgl.html" rel="noopener ugc nofollow" target="_blank"> <em class="js"> rgl </em>包</a>的一部分，为渲染模型创建占位符。它将在服务器代码中被其<em class="js">outputId</em>("<em class="js">rglWidget</em>")引用。</p><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="d036" class="me ln hi na b fi ne nf l ng nh">ui = fluidPage(<br/>  titlePanel("Coronavirus / COVID-19 in 3D"),<br/>  fluidRow(<br/>    rglwidgetOutput("rglWidget", width="100%") %&gt;% withSpinner()<br/>  )<br/>)</span></pre><p id="1c4d" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">在模型加载时，管道操作符("<em class="js"> % &gt; % </em>")用<strong class="jt hj">动画微调器</strong>替换小部件后，方法调用"<em class="js"> withSpinner() </em>"(包<em class="js"> shinycssloaders </em>)，这可能需要几秒钟。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><p id="2dbe" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated"><strong class="jt hj">服务器代码</strong>实现<strong class="jt hj">逻辑来加载和渲染3D模型</strong>。"<em class="js"> read.obj(…)" </em>从包<em class="js"> readobj </em>读取obj文件，并将其转换为rgl理解的格式。然后“<em class="js"> open3d </em>”打开一个新的图形窗口。函数“<em class="js"> shade3d </em>”用于添加具有指定颜色(红色和深灰色)的3d模型的两层。最后，“<em class="js"> bg3d </em>”设置背景颜色。</p><p id="95f4" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">需要“rglWidget”来生成场景的<strong class="jt hj"> WebGL版本，可以进行渲染。</strong></p><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="89df" class="me ln hi na b fi ne nf l ng nh">server = function(input, output, session) {<br/>  <br/>  output$rglWidget = renderRglwidget({<br/>    model = read.obj("coronavirus.obj", convert.rgl=TRUE)<br/>    open3d()<br/>    shade3d(model$Layer_1, color="darkgray")<br/>    shade3d(model$Layer_2, color="red")<br/>    bg3d(gray(level=0.95))<br/>    rglwidget(reuse=TRUE)<br/>  })<br/>}</span></pre><p id="4307" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">最后，这最后一行代码<strong class="jt hj">创建了闪亮的应用</strong>本身。</p><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="4294" class="me ln hi na b fi ne nf l ng nh">shinyApp(ui=ui, server=server)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nq"><img src="../Images/a53e6dd1dd284de3d488c4cbe2d98f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jdvuarm0T8DaL4CX"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae kq" href="https://unsplash.com/@mybibimbaplife?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰西卡·诺尔登</a>在<a class="ae kq" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="76fa" class="lm ln hi bd lo lp nl lr ls lt nm lv lw io nn ip ly ir no is ma iu np iv mc md bi translated">最后的话</h1><p id="44aa" class="pw-post-body-paragraph jq jr hi jt b ju ms ij jw jx mt im jz kn mu kc kd ko mv kg kh kp mw kk kl km hb bi translated">显然，这是一个小小的展示，展示了我们如何使用<em class="js"> R </em>和<em class="js"> rgl </em>来轻松地可视化3D模型。</p><p id="5128" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">但是<strong class="jt hj"> <em class="js"> rgl </em>提供的</strong> : <br/>灯光、材质、纹理、动画、回调等等。</p><p id="cc03" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kn kb kc kd ko kf kg kh kp kj kk kl km hb bi translated">此外，<strong class="jt hj">OBJ或STL等格式的3D模型</strong>允许使用R、Python或任何其他语言进行简单的<strong class="jt hj">特征提取和模型改变</strong>。对于我最近参与的一个更大的项目，我们额外将我们的R-Shiny应用程序连接到Python <a class="ae kq" href="https://wiki.freecadweb.org/Python_scripting_tutorial" rel="noopener ugc nofollow" target="_blank"> Freecad API </a>来添加额外的开箱即用功能。</p><blockquote class="jn jo jp"><p id="0adc" class="jq jr js jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">如你所见，没有上限。</p></blockquote></div></div>    
</body>
</html>