<html>
<head>
<title>Accessing the Twitter API with Tweepy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Tweepy访问Twitter API</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/accessing-the-twitter-api-with-tweepy-8421329afc5c?source=collection_archive---------17-----------------------#2020-02-14">https://medium.com/analytics-vidhya/accessing-the-twitter-api-with-tweepy-8421329afc5c?source=collection_archive---------17-----------------------#2020-02-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="98b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Twitter每天收集12tb的数据，每年大约4.3，这是一个很大的数据量。事实上，每分钟有45.6万条推文。并非所有这些数据都对公众开放，但事实证明，数量惊人。有几种不同的方法可以访问这些数据，但是我发现对我来说最简单的方法是使用包<a class="ae jd" href="http://docs.tweepy.org/en/v3.5.0/api.html" rel="noopener ugc nofollow" target="_blank"> Tweepy </a>访问Twitter API。</p><p id="1b6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过这个包，可以很容易地访问用户数据或特定的tweet数据，并将其引入python以便于分析。这篇文章将引导你完成访问Twitter API的步骤。</p><h2 id="691b" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><strong class="ak"> 1。申请访问Twitter API &amp;入门</strong></h2><p id="c604" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">在使用Twitter API之前，您需要获得访问权限。遵循这些步骤。</p><ol class=""><li id="a278" class="ke kf hi ih b ii ij im in iq kg iu kh iy ki jc kj kk kl km bi translated">创建一个<a class="ae jd" href="https://twitter.com/home" rel="noopener ugc nofollow" target="_blank"> Twitter </a>账户(如果你还没有的话)。</li><li id="0001" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">前往开发者推特网站申请一个开发者账户。Twitter花了大约一天半的时间批准了我的申请。</li><li id="3d4c" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">一旦获得批准，您将不得不建立自己的开发环境，然后您将能够开始访问API。</li></ol><h2 id="20cb" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">2.获取令牌和密钥/在Python中访问它们</h2><p id="9f10" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">为了访问API，您将需要4个不同的令牌/密钥，您可以在开发环境的“密钥和令牌”选项卡中找到它们。</p><p id="3a76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过导入必要的库来看看这一点。我将令牌保存在我电脑上的JSON文件中，以便隐藏它们。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="e179" class="je jf hi kx b fi lb lc l ld le">import json </span><span id="b265" class="je jf hi kx b fi lf lc l ld le"># Define a function to open the json<br/>def get_keys(path):<br/>    with open(path) as f:<br/>        return json.load(f)</span><span id="197e" class="je jf hi kx b fi lf lc l ld le"># Using the function to open and load all keys in that file <br/>access_token_get = get_keys("/home/twitter_access_token.json")<br/>access_secret_get = get_keys("/home/twitter_secret_access_token.json")<br/>consumer_key_get = get_keys("/home/twitter_api_consumer_key.json")<br/>consumer_secret_get = get_keys("/home/twitter_api_secret_consumer_key.json")</span><span id="bbe7" class="je jf hi kx b fi lf lc l ld le"># Setting tokens/keys as variables<br/>ACCESS_TOKEN = list(access_token_get.values())[0]<br/>ACCESS_SECRET = list(access_secret_get.values())[0]<br/>CONSUMER_KEY = list(consumer_key_get.values())[0]<br/>CONSUMER_SECRET = list(consumer_secret_get.values())[0]</span></pre><p id="d8c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，每个令牌/密钥都存储在变量中。我们现在准备开始使用<a class="ae jd" href="http://docs.tweepy.org/en/v3.5.0/api.html" rel="noopener ugc nofollow" target="_blank"> Tweepy </a>来获取一些数据。</p><h2 id="e1ce" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">3.使用Tweepy抓取数据</h2><p id="62da" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">Tweepy是一个免费的Twitter库，提供对整个twitter RESTful API方法的访问。我强烈建议查阅文档，因为不同的方法访问不同类型的数据，并且根据您的需要，一种方法可能比另一种更好。出于今天的目的，我将演示如何使用“get_user”方法获取特定用户的数据。具体来说，我们来看看唐纳德·特朗普的推特取乐。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="881c" class="je jf hi kx b fi lb lc l ld le">#Tweepy Package<br/>import tweepy</span><span id="05f4" class="je jf hi kx b fi lf lc l ld le">#Connecting to the API<br/>auth = tweepy.OAuthHandler(CONSUMER_KEY, CONSUMER_SECRET)<br/>auth.set_access_token(ACCESS_TOKEN, ACCESS_SECRET)<br/>api = tweepy.API(auth)</span><span id="0f30" class="je jf hi kx b fi lf lc l ld le">#Accessing my account information<br/>user = api.get_user(screen_name = 'realDonaldTrump')<br/>print(user)</span></pre><figure class="ks kt ku kv fd lh er es paragraph-image"><div class="er es lg"><img src="../Images/9f00e55bd7d0aac3639acc43e05955cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*mcXbjPDSvb7SpCXBX7VSnA.png"/></div></figure><p id="3afc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在短短几行代码中，你就有了相当多的用户数据。上面是使用“get_user”方法时捕获的一些用户数据的示例。现在让我们解析数据的几个部分。Tweepy使得在这个API中获取特定数据变得非常容易——让我们看几个例子:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="253d" class="je jf hi kx b fi lb lc l ld le">print('Total # of Statuses by this User:', user.statuses_count)<br/>print("User's Bio:", user.description)<br/>print("Date Account Created:", user.created_at)</span></pre><figure class="ks kt ku kv fd lh er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lk"><img src="../Images/d6758af8c70d9926c3548bf71391b5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8uAPyKx7n6-m6hSQDDj8qA.png"/></div></div></figure><p id="8297" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很好，但现在让我们看看如何使用“user_timeline”方法获取用户的实际tweet数据。为此，您只需要两个参数，用户和您想要的tweets数量。让我们来看看特朗普最近的10条推文:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="70d7" class="je jf hi kx b fi lb lc l ld le">user_tweets = api.user_timeline(screen_name = 'realDonaldTrump', count = 10)</span><span id="36bb" class="je jf hi kx b fi lf lc l ld le">#Print the 5th tweet<br/>print('Tweet 5:', user_tweets[5].text)</span></pre><figure class="ks kt ku kv fd lh er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lp"><img src="../Images/75a4ace63a5370dcdd0b661363f4a88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yrxS37bdprcb7O4M9u40Nw.png"/></div></div></figure><p id="9f27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是了。现在，您应该能够访问Twitter用户数据以及用户的特定推文。为了让这些数据容易地进入eval方法，你将不得不做一些循环，但是总的来说，这至少可以帮助你使用Tweepy包访问Twitter数据。</p></div></div>    
</body>
</html>