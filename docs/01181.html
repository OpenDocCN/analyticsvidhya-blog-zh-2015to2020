<html>
<head>
<title>Journey through NLP and Time Series to Predict Gold Price</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过NLP和时间序列预测黄金价格</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/journey-through-nlp-and-time-series-to-predict-gold-price-a14e34edb19c?source=collection_archive---------0-----------------------#2019-10-07">https://medium.com/analytics-vidhya/journey-through-nlp-and-time-series-to-predict-gold-price-a14e34edb19c?source=collection_archive---------0-----------------------#2019-10-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4d9778b9e1d7a9b13d436f71d4a5b812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5MvCDVQ27YupxOkQyAmCvA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片由<a class="ae iu" href="https://pixabay.com/users/hamiltonleen-5703179/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2430051" rel="noopener ugc nofollow" target="_blank">琳达·汉密尔顿</a>来自<a class="ae iu" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2430051" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></figcaption></figure><p id="af6c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">预测金融资产变动的能力是如此有利可图，以至于许多组织都在投资研究，通过采用最先进的技术和技巧来获得这种优势。有了这种兴趣，也就不足为奇了，也有许多关于预测股票市场价格的研究论文。尝试范围从特征工程、事件驱动的方法、具有分层注意机制的新闻序列、主题和情感学习等等。出于对金融市场的浓厚兴趣，我决定将预测黄金价格作为我的第四个Metis训练营项目。</p><p id="3bb9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个数据科学项目旨在利用市场信息，包括分析信息和技术信息，来预测给定时期内随机的黄金价格波动。分析信息是利用黄金或商品市场相关的金融新闻获取的。技术特征是多种资产的历史价格，包括标准普尔500指数、道琼斯指数、原油等等。</p><p id="0c33" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我使用Event Registry API从多个主要新闻提供商处获取黄金相关新闻，包括彭博商业、华尔街日报、路透社、金融时报、雅虎财经。由于Event Registry存档了2014年以来的新闻，所以我选择了同期的金融数据。</p><p id="113c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我将介绍项目的工作流程，从数据探索、数据预处理、机器学习模型，以及我在这个过程中的学习。如果你对递归神经网络和卷积神经网络的工作原理感兴趣，请阅读本文末尾。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="b9c0" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">数据探索</h1><p id="914f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">每个数据科学项目都需要数据。我收集了哪些数据？</p><ul class=""><li id="ae9c" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated">2014年1月至2019年8月1900+条新闻</li><li id="c049" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">同期选择的六个资产类别中的每一个都有1400多个价格点</li></ul><p id="f647" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了准备预处理，我将文章从JSON格式转换到Pandas数据框架。然后对于我的目标，我计算一个交易日之间的金价波动。我将两个数据框合并，使新闻与价格一致。</p><h1 id="bdd6" class="ka kb hi bd kc kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx bi translated">数据洞察</h1><p id="130f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">当我处理这两种类型的数据时，我发现了一些有趣的点。</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/b71367f2af2852cc86a99d98873dce52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*8B0Fj2Bylzju9ANmfdJyAA.png"/></div></figure><p id="b980" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从所有新闻的文字云里，我做三点观察。</p><ul class=""><li id="7c1f" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated">关键在于谁说了什么。</li><li id="dea2" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">央行是老大。</li><li id="270c" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">“看不见的手”:市场力量同样重要。</li></ul><p id="9c42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">而且金价分布和消息量也有一定的关系。当消息量较低时，金价波动也相对较小，这意味着2月至11月期间，消息量与金价波动之间存在正相关关系。唯一的例外是在12月至1月期间，此时消息量达到峰值，但黄金价格波动没有8月那么高。</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/4d1e0eb9a866159fbe7d09c689a5d06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlEXBzZdH7BnGrQ4MWWEIQ.png"/></div></div></figure><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/483b12510ad6d4cdc3a2ccc54ffee2b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ROEAYq6vAd5Sd5jn5nztNw.png"/></div></div></figure><p id="f47a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以上是我，一个人类的观察。那么机器能告诉我们什么呢？</p><h1 id="c315" class="ka kb hi bd kc kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx bi translated">数据预处理</h1><p id="6e34" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在这个阶段，我正在处理三组数据:新闻、资产价格和我的目标。</p><ul class=""><li id="8a9f" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated">新闻:在词汇化之前，我删除了数字、标点符号、末尾的空格和停用词，并将所有文本都改为小写。在查看了所有文档的长度后，我选择用零填充所有语料库，使其长度统一为24100个单词。选择这个截止值是因为1900个文档中只有5个超出了这个长度。</li><li id="d9f6" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">资产价格:当我合并两个数据框架时，非交易日的新闻没有相应的价格。因此，我用前一个交易日的价格填充nan单元格。</li><li id="5cb9" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">目标:基于一个交易日的波动，我将绝对1%以内的变化划分为“保持”，1%以上为“上升”，1%以下为“下降”。对于未来的工作，我可能会将“停留”带宽缩小到绝对的0.5%，以创建更平衡的类。</li></ul><h1 id="b3a6" class="ka kb hi bd kc kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx bi translated">深度学习模型</h1><p id="13a7" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在深入研究我使用的深度学习模型之前，我想分享一下我使用多输入神经网络模型的决策过程。我最初的计划是在两种方法中选择一种。一种是使用多输入神经网络模型。另一种方法是对文本使用递归神经网络，对金融数据使用多变量时间序列，然后将结果与特定规则相结合。我首先尝试第二种方法。由于使用时间序列VAR模型的结果并不令人印象深刻，我求助于更复杂的替代方法。</p><p id="1052" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在训练模型之前还有几个步骤:对金融数据进行标准缩放，对目标进行一次热编码，对文本进行标记，使用Stanford GloVe.6B.100d准备嵌入矩阵，最后训练、验证、测试数据分割。</p><p id="a884" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">多输入神经网络的结构如下所示。我比较了卷积神经网络(CNN)和序列到序列递归神经网络(编码器-解码器RNN)在文本输入方面的性能，同时保持了时间序列金融价格的LSTM模型结构。</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/0066894f7f791999c2f4fa8d84d96bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8yCEBKlrwPER69bzoURwYg.png"/></div></div></figure><p id="31a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">模特表演:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/b052916fc540a7f86e20be24bbc05458.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-7_wRXGVd2pizse0XyBFg.png"/></div></div></figure><p id="1705" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">CNN模型每个历元只需要20秒来训练，比RNN模型少20倍。此外，RNN模型的准确性和F1分数在第一个时期后很快达到平稳，这导致对测试数据的较差分类性能，因为它将一切都分类到多数类。</p><p id="223e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是CNN模型对测试数据的归一化混淆矩阵。</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/3fae0e9f1e063194d0bae71ef984cebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ja5--i79PG7r6zut7HXUg.png"/></div></div></figure><h1 id="331e" class="ka kb hi bd kc kd lr kf kg kh ls kj kk kl lt kn ko kp lu kr ks kt lv kv kw kx bi translated">我的旅程</h1><p id="bf5c" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">鉴于我的初步结果，有许多潜在的改进。然而，鉴于这是我第一次尝试定制的多输入深度学习模型，再加上我只有三周的时间，我觉得这段旅程既具有挑战性，又非常有意义。我计划进一步探索这个主题，一旦我做到了，我会发布一个更新。</p><p id="da48" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来源:</p><ul class=""><li id="5eba" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated">使用NLP和深度学习预测股价走势:<a class="ae iu" href="https://towardsdatascience.com/using-nlp-and-deep-learning-to-predict-the-stock-market-64eb9229e102" rel="noopener" target="_blank">https://towards data science . com/using-NLP-and-Deep-Learning-to-Predict-the-Stock-market-64eb 9229 e 102</a></li><li id="467d" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">论文本分析对股价预测的重要性:【https://nlp.stanford.edu/pubs/lrec2014-stock.pdf】T2</li><li id="7518" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">张量流-多维-lstm &amp; Keras注意机制:【https://github.com/philipperemy? T4】after = y 3 vyc 29 yonyyopk 5 mjaxos 0 wmy 0 wofqwntownzowmcswodowmm 4c i2v&amp;tab = repositories</li><li id="27f3" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">斯坦福NLP/Glove:<a class="ae iu" href="https://github.com/stanfordnlp/GloVe" rel="noopener ugc nofollow" target="_blank">https://github.com/stanfordnlp/GloVe</a></li><li id="b318" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">使用Keras了解Python中的有状态LSTM递归神经网络:<a class="ae iu" href="https://machinelearningmastery.com/understanding-stateful-lstm-recurrent-neural-networks-python-keras/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/understanding-Stateful-lstm-Recurrent-Neural-Networks-Python-Keras/</a></li><li id="b26b" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">Keras中序列对序列学习的十分钟介绍:<a class="ae iu" href="https://blog.keras.io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-keras.html" rel="noopener ugc nofollow" target="_blank">https://blog . Keras . io/a-ten-minute-introduction-to-sequence-to-sequence-learning-in-Keras . html</a></li><li id="effc" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">如何开发时间序列预测的LSTM模型:<a class="ae iu" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/how-to-develop-lstm-models-for-time-series-forecasting/</a></li><li id="6a5d" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">Keras:多输入多输出:<a class="ae iu" href="https://keras.io/getting-started/functional-api-guide/" rel="noopener ugc nofollow" target="_blank">https://keras.io/getting-started/functional-api-guide/</a></li></ul></div></div>    
</body>
</html>