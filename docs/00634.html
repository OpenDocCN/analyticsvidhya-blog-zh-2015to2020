<html>
<head>
<title>Math Behind Logistic Regression Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归算法背后的数学</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-b35d2801a29c?source=collection_archive---------0-----------------------#2019-08-20">https://medium.com/analytics-vidhya/logistic-regression-b35d2801a29c?source=collection_archive---------0-----------------------#2019-08-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5d1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人们经常处理现实生活中在不同的事物中进行选择的问题。比如客户是否要买某个产品，客户要订阅哪个套餐。所有这些都属于分类的策略，预测特定数据点属于哪个集合。</p><p id="5776" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性分类是基于线性预测函数进行分类的方法，将权重与因变量的值相结合。在这个过程中可能涉及非线性操作。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/90b869c73b8272c13e8ba5d39e39ab51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wFOWSUKXt95qoBfv97HAkg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">逻辑回归流</figcaption></figure><p id="feac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上述两个等式中，等式1将每个特征与权重相关联。我们之所以称logistic回归为广义线性模型之一。随后使用链接函数(将在下面提供解释),该函数转换在(0，1)范围内提供的数据。这里是等式2。是连接函数，它是一个sigmoid函数，z是一个值，它给出了一个事件发生的概率。</p><h2 id="71d2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated"><strong class="ak">逻辑回归过程</strong></h2><p id="d2c4" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">给定数据(X，Y)，X是具有m个示例和n个特征的值的矩阵，Y是具有m个示例的向量。目标是训练模型来预测未来值属于哪一类。首先，我们创建一个随机初始化的权重矩阵。然后我们乘以特征。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/3069692b1e6b2471bbe954546bdeff85.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/1*zgHJk04MnT-KHseMx5UplA.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Eq 1。</figcaption></figure><p id="d8b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们传递从等式1获得的输出。链接函数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/733a08f0c4a382b9b408e5dce146ec79.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/1*W-eV7ojoYq8FKTHrDyxKEw.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">链接功能</figcaption></figure><p id="8e79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随后计算该迭代的成本，其公式为</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/bf2cda13a90d94cd1f335067a78958b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/1*oWzox2Raoi-HkqEAkdgJuA.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">价值函数</figcaption></figure><p id="59db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算该成本的导数，然后更新权重。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/a7d317e7bd44ab76e95073db74750b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/1*fBcG0OClMcbvR704jynxfQ.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">梯度</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/a84d7f4fa7cb8cf117870b4d3b810fde.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/1*zbGFw_u7ay1UagAPkE6PMw.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">更新</figcaption></figure><p id="239e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归的完整python代码如下</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/0b69fffd08669a12d03070533cf4a6a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5d-8qvUzF60PoaZ8XlDLw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从零开始的逻辑回归</figcaption></figure><p id="1b6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">逻辑回归背后的数学和直觉</strong></p><p id="3206" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归算法的目标是创建一个线性决策边界，将两个类彼此分开。这个决策边界是由条件概率给出的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kz"><img src="../Images/435464320701b504b4ffc7023496989e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*zwJSij87fzcsbT6-pT4SQw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">中间的线是决策边界，上下有两个类。</figcaption></figure><p id="6992" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设黑线(判定边界)以上的类，即<em class="la"> '+' </em>被分类为<em class="la"> '1' </em>，判定边界<em class="la">' 0 '</em>以下的类被定义为<em class="la">' 0’。逻辑回归的作用是计算条件概率，即</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/bedbcbed0939eebdcc9259380e591462.png" data-original-src="https://miro.medium.com/v2/resize:fit:218/1*FU0Nigzvpemy3MJUlxGUqw.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">类别“1”的概率</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/d36dcaf397fe932d76f11c8878293c5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:218/1*qqKpGBJkxelSyExgOUFgew.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">类别“0”的概率</figcaption></figure><p id="645b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归计算属于这两类中任何一类的一组特定数据点的概率，给定值为<em class="la"> x </em>和<em class="la"> w. </em>逻辑是这样的，我们有一组基于线性模型从负无穷大到正无穷大获得的值，我们需要将其缩小到0到1之间的分数，因为概率总是在该范围内，逻辑回归讨论的是概率。链接函数，sigmoid函数负责这项工作。</p><p id="9c7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在sigmoid函数中使用指数是合理的，因为概率总是大于零，并且指数的性质考虑了这一方面。然后，我们需要担心如何限制小于1的值，这是通过将分子中的值除以大于它的值来实现的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lc"><img src="../Images/ea96df7697b29093141d2f9b59693ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/1*jQuR6pcfDoBfgnC0EM9nOA.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">概率大于0</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ld"><img src="../Images/ed227840aaf2e4bcc617417fd45d131f.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/1*Iet19xnD9S5E5xv863CimQ.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">概率大于0小于1</figcaption></figure><p id="6301" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，为了得到交替类的概率，我们只需将上面得到的值减去1。当我们将上述方程除以分子项时，我们得到sigmoid连接函数</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es le"><img src="../Images/d049da9e5cd8251b797e3cf6e03d2f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/1*ZqLdj1Uohg0AykU03IuKXA.gif"/></div></figure><p id="bd02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">赔率比</strong></p><p id="2c14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们从周围的许多人那里听到“一个团队获胜的几率有多大”这个术语。赔率基本上是一个事件发生的概率与一个事件不发生的概率之比。在逻辑回归中，事件发生的几率可以由公式给出</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lf"><img src="../Images/27aed981f9ac1818e3dbfac64bdcf59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/1*hWQGnNaeVX4TgV1g6-C8bA.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">事件发生的几率</figcaption></figure><p id="0fcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事件的对数概率或对数似然性由上述等式的对数给出。由于概率在范围(0，1)内，所以比值比被对数转换以移除受限范围。对数变换将它更改为从负无穷大到正无穷大的值。第二个原因是对数值更容易解释。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/3bbc2317cc7af80c63909334bc8d1dce.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/1*fANFmXlXhvcP8bXalhx8Sw.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">日志(赔率)</figcaption></figure><p id="a76a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们考虑得到输出P(y = 1 | x；w)等于sigmoid函数，p(y = 0 | x；w)= 1-p(y = 0 | x；w)并且如果假设我们的样本具有伯努利分布，则逻辑回归模型的成本函数由下式导出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/d3150e7f56ae9086714d604c0cf165b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/1*u3HtNCoEiG7Z2yFr6uYOsQ.gif"/></div></figure><p id="c57d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">取log这个等式可以转换成上面的成本函数。函数开头出现负号是为了确保我们尝试最小化负的可能性，而不是最大化值，因为梯度下降会最小化误差。</p><p id="aa47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归的Scikit-learn实现如下所示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/b444c235a69fadb7bde4f9519f6dda53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwQsln1aUCCJKm--tU7DSA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Sklearn实现</figcaption></figure><blockquote class="lj lk ll"><p id="8293" class="if ig la ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">如果你发现任何不一致的地方，一定要评论。</p><p id="18d0" class="if ig la ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">github到笔记本的链接是<a class="ae lp" href="https://github.com/sidsekhar/Regression-Basics/blob/master/Logistic%20Regression.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/sidsekhar/Regression-Basics/blob/master/Logistic % 20 Regression . ipynb</a><br/>与分类相关的指标将作为单独的文字处理。</p></blockquote></div></div>    
</body>
</html>