<html>
<head>
<title>My First Machine Learning Hackathon — Attempts for finishing in Top 17%</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的第一次机器学习黑客马拉松——试图进入前17%</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/my-first-machine-learning-hackathon-attempts-for-finishing-in-top-17-1202fdafda06?source=collection_archive---------11-----------------------#2019-12-02">https://medium.com/analytics-vidhya/my-first-machine-learning-hackathon-attempts-for-finishing-in-top-17-1202fdafda06?source=collection_archive---------11-----------------------#2019-12-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c6d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个博客包含了这个ML项目使用的详细方法，以及为尝试排名前17%而进行的实验</p><h1 id="7ca9" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">目录</h1><p id="a6c7" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated"><em class="kg"> ( </em> <strong class="ih hj"> <em class="kg">注</em></strong><em class="kg">——</em><strong class="ih hj"><em class="kg">这篇博文可能会有点长——因此我在下面附上了目录——如果你喜欢</em> </strong> <em class="kg"> ) </em></p><p id="d264" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#e59a" rel="noopener ugc nofollow"> <strong class="ih hj"> 1。我的排行榜排名</strong> </a></p><p id="f817" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#a5a3" rel="noopener ugc nofollow">②<strong class="ih hj">。代码链接— (Github简介)</strong> </a></p><p id="aa76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#4184" rel="noopener ugc nofollow"> <strong class="ih hj"> 3。最终决定解决一个黑客马拉松，尽管仍然对自己的技能充满信心</strong> </a></p><p id="9e0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#a142" rel="noopener ugc nofollow"> <strong class="ih hj"> 4。</strong>项目目标</a></p><p id="fabd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#51d5" rel="noopener ugc nofollow"> <strong class="ih hj"> 5。测试数据评估度量= (1- RMSLE) </strong> </a></p><p id="4895" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#ad75" rel="noopener ugc nofollow">6<strong class="ih hj">。</strong>数据概述</a></p><p id="2393" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#6860" rel="noopener ugc nofollow"> <strong class="ih hj"> 7。</strong>和</a>基本EDA功能概述</p><p id="37e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#2f67" rel="noopener ugc nofollow">T43】8。用于本项目的机器学习工作流程 </a></p><p id="7fbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#2bd0" rel="noopener ugc nofollow">9<strong class="ih hj">。处理缺失值的重要性</strong> </a></p><p id="fcd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#c860" rel="noopener ugc nofollow">10<strong class="ih hj">。文本特征提取</strong> </a></p><p id="fcb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#4949" rel="noopener ugc nofollow">11<strong class="ih hj">。需要规范化的数字特征</strong> </a></p><p id="5b69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#518f" rel="noopener ugc nofollow">12<strong class="ih hj">。编码分类特征</strong> </a></p><p id="132d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#d4f4" rel="noopener ugc nofollow"> <strong class="ih hj"> 13。处理异常值</strong> </a></p><p id="58a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#9470" rel="noopener ugc nofollow">14<strong class="ih hj">。检查特征多重共线性</strong> </a></p><p id="ad44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#e8ae" rel="noopener ugc nofollow">15<strong class="ih hj">。特征选择实验</strong> </a></p><p id="62f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#0d81" rel="noopener ugc nofollow">16<strong class="ih hj">。</strong>使用的回归模型</a></p><p id="50cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#c804" rel="noopener ugc nofollow">17<strong class="ih hj">。超参数调整和交叉验证</strong> </a></p><p id="aeb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="#06b1" rel="noopener ugc nofollow"> <strong class="ih hj"> 18。结束注释、学习和结论</strong> </a></p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es kp"><img src="../Images/d6ae5af45b3a0d47f94e356affc67f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNhcrMT2OC3FBm5PwcXeGg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">img ref—<a class="ae kh" href="https://sarahleibz.co.za/2018/01/22/run-to-win/" rel="noopener ugc nofollow" target="_blank">https://sarahleibz.co.za/2018/01/22/run-to-win/</a></figcaption></figure><h1 id="e59a" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">1.我的排行榜排名</h1><p id="38f2" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目前排名第72位(在418个参与者提交的内容中)——<a class="ae kh" href="https://www.machinehack.com/course/predicting-the-costs-of-used-cars-hackathon-by-imarticus/leaderboard" rel="noopener ugc nofollow" target="_blank">https://www . machine hack . com/course/predicting-the-costs-of-used-cars-hackathon-by-imarticus/leader board</a></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lf"><img src="../Images/82023c0180c7c7ac06a61114c4f88a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BfK1rpQ4y2DePdJGsHt8Hg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">排行榜排名(2011年11月30日)</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="a5a3" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">2.代码链接— (Github配置文件)</h1><p id="1507" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我已经用<strong class="ih hj"> Python </strong>解决了这个项目(<strong class="ih hj"> jupyter笔记本</strong>)。</p><p id="922b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="https://github.com/debayanmitra1993-data/Predict-Prices-of-Used-Cars" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">https://github . com/debayamitra 1993-data/Predict-Prices-of-二手车</strong> </a></p><p id="12ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前，我已经将代码库设为私有(因为这是hackathon :P的一部分)。它包含了我用来解决这个项目的一系列3个ipynb/html笔记本。本博客中的ML工作流部分将涵盖。ipynb文件。如果您想获得代码或代码片段以供参考，请直接通过<strong class="ih hj">debayanmitra1993@gmail.com联系我。</strong></p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="4184" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated"><strong class="ak"> 3。最终决定解决一个黑客马拉松，尽管对我的技能仍然信心不足</strong></h1><p id="e709" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">过了很长时间，我终于决定尝试我的第一个端到端数据科学项目——我总是推迟这个步骤，因为我觉得我从来没有足够的知识/技能来完成这个项目。但是我觉得很有竞争力，因为这是我第一个完全自我尝试的ML项目。坦率地说，即使当我开始尝试黑客马拉松时，我对自己在机器学习概念方面的知识水平也没有绝对的信心。我也没有受过这方面的正规教育。尽管如此，许多人告诉我，学习有很大的广度和深度——所以我永远不会感到足够的自信，除非我去尝试。所以我决定继续。我要感谢https://www.appliedaicourse.com/<a class="ae kh" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a>的团队。我已经学习这门人工智能课程一年多了，我的大部分理论和实践都来自这里。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="a142" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">4.项目目标</h1><p id="2f33" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我所选项目的目标是一个<strong class="ih hj">回归建模</strong>任务——我们必须<strong class="ih hj">预测一辆二手车的“价格”</strong>(给定一辆车的属性，如品牌、年龄、发动机规格、使用公里数等。)我选择了这个问题陈述，因为它与我工作的公司非常相关，甚至这家公司也从事废旧汽车的估价业务。我从<a class="ae kh" href="https://www.machinehack.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">machine hack</strong></a><strong class="ih hj"/>中挑选了这个项目——这是一个在印度举办ML竞赛的平台——<a class="ae kh" href="https://www.machinehack.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">https://www.machinehack.com/</strong></a><strong class="ih hj">。</strong>这是一场与Imarticus Learning合作举办的比赛，更多信息请点击此处—<a class="ae kh" href="https://www.machinehack.com/course/predicting-the-costs-of-used-cars-hackathon-by-imarticus/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">https://www . machine hack . com/course/predicting-the-costs-the-used-cars-hackathon-by-Imarticus/</strong></a></p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="51d5" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated"><em class="ll"> 5。测试数据评估度量= (1 — RMSLE) </em></h1><blockquote class="lm ln lo"><p id="85f6" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><em class="hi"> ( </em> <strong class="ih hj"> <em class="hi">注——这不是RMSE。正是RMSLE </em> </strong> <em class="hi"> ) </em></p></blockquote><p id="1703" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">比赛使用的评估标准基本上是一个分数。<strong class="ih hj"> RMSLE </strong>代表<strong class="ih hj">均方根对数误差</strong>。这是我发现的一篇漂亮的博文，它解释了RMSE和RMSLE之间的差异，以及在什么情况下RMSLE更适合用作回归任务的评估指标—<a class="ae kh" rel="noopener" href="/analytics-vidhya/root-mean-square-log-error-rmse-vs-rmlse-935c6cc1802a"><strong class="ih hj">https://medium . com/analytics-vid hya/root-mean-square-log-error-RMSE-vs-RM LSE-935 c6cc 1802 a</strong></a></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es ls"><img src="../Images/e68fa43224d5625f8cfc02652ab2fe9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*8-Gj-Ng80xbE4pIzMPU4ZQ.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><em class="ll">来源——towardsdatascience.com</em></figcaption></figure><p id="fa93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总结一下这篇博文中关于为什么在这里使用RMSLE作为衡量标准的几点</p><p id="41d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。当你低估而不是高估时，RMSLE的惩罚更多— </strong>换句话说，RMSLE用于这个项目，它是说，如果你高估某些汽车的价格，这是可以的，但如果你低估，这是不可接受的。如果你预测不足，RMSLE将显著增加，你的分数将急剧下降。</p><p id="ac57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。RMSLE可以缓冲数据中异常值的影响</strong> —如果您在RMSE评估，数据集中某些具有非常高“价格”值的豪华品牌汽车实际上会扭曲您的模型，因为RMSE的平方误差惩罚，而RMSLE只会对高价值汽车产生比低价值汽车稍高的惩罚，因为RMSLE在度量中有一个对数项来缓冲这种影响。(这就是对数的妙处:)。下面是一个图表描述，它告诉了我想说的—</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lt"><img src="../Images/158f42c3ab7f67373f599c5b4975a40a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*88zQ3qdpT5gAH-Y-lbHE_Q.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><em class="ll">谷歌图——x和log(x)图的对比</em></figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="ad75" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated"><em class="ll"> 6。数据概述</em></h1><p id="3b59" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这里要预测的目标特征是一个数字特征—‘T6’价格。这是该特征在“训练”数据集中的分布。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lu"><img src="../Images/417ab9a9789fd784d051789784279e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LzCrfUtgFM5xsSfkKFi5Ew.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><em class="ll">价格分布</em></figcaption></figure><p id="1f49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均值为9.4，而中位数约为5。分布看起来相当倾斜——现在我明白了为什么他们选择RMSLE而不是RMSE作为衡量标准。让我们对这个特性<strong class="ih hj"> </strong>应用<strong class="ih hj"> Log-Transformation </strong>并检查Log(价格)的分布。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lv"><img src="../Images/d60964bdf2e65a83a3b1edae4019054a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8k8fDVO4EKZCLvmIkYp5AQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><em class="ll">价格对数—直方图</em></figcaption></figure><p id="6dbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很好，看起来很正态分布——尽管不完全正态。似乎非常接近于<strong class="ih hj">对数正态分布。</strong>这就是为什么在下一节中——我们将在<strong class="ih hj">日志(价格)</strong>上可视化所有特征，而不仅仅是<strong class="ih hj">价格</strong>。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="6860" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">7.特性和基本EDA概述</h1><p id="1784" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">好的，关于每个特性的一些信息</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lw"><img src="../Images/1bec99a103f84b3569fd2819dc22ad3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*anm4hFMb5w_9Plifeq061Q.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">训练数据—(数据帧视图，python -pandas)</figcaption></figure><blockquote class="lm ln lo"><p id="f786" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">汽车名称</strong>(文本句子)——这是我们试图预测其价格的汽车的实际名称。以下是数据中一些排名靠前的汽车名称:</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es lx"><img src="../Images/122cc2cffb23bff8265413d2c2fc1ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*l_ZnI2lcxA1c8NGHqE-DBg.png"/></div></figure><blockquote class="lm ln lo"><p id="c20a" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">位置(</strong>分类<strong class="ih hj"> ) — </strong>主要包括印度的大都市—【孟买、海德拉巴、加尔各答、钦奈】等。看看下面的<strong class="ih hj">小提琴剧情</strong>。</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ly"><img src="../Images/724e4199b89a6be0be52d7f0b30a4d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSmq19ACN7jbO3Z-9ygWcg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">条形图—计数(位置)</figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lz"><img src="../Images/6b076067ce0f604be29cdb908b73894b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRF1pz2wzE9IMgmZz3uiog.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">小提琴图—日志(价格)与位置</figcaption></figure><blockquote class="lm ln lo"><p id="7b96" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">年份</strong> — (YYYY格式)—汽车制造年份。我提取了一个特征叫做'<strong class="ih hj">年龄</strong> ' = 2019 —年。我将年龄视为一个数字特征(尽管许多人会争论为什么这可以用作分类特征)。</p></blockquote><p id="5125" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是因为您可能希望使该模型对年龄值为小数的预测具有鲁棒性。但是，训练数据足够丰富，只有离散的整数年龄。因此，绘制了“年龄”与“对数(价格)”的散点图</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ma"><img src="../Images/33295ff90157c5a51963bdb8b44d4256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B19RmbotI8vZtBZnsohysw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">散点图—对数(价格)与年龄</figcaption></figure><blockquote class="lm ln lo"><p id="0f32" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">燃料类型</strong>(分类)——柴油、汽油、压缩天然气、电动等中的一种。绘制下面的<strong class="ih hj">方框图</strong>。</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mb"><img src="../Images/c2e5a90e3b3b1e231bdcaca3ef88a583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vr-EWhPybafpFvXxWfo-OA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">箱线图—对数(价格)与“燃料类型”</figcaption></figure><blockquote class="lm ln lo"><p id="5555" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">变速器</strong> —自动/手动之一</p><p id="6532" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">车主_类型</strong>——第一、第二、第三、第四——(基本上是一手、二手、三手车等)之一。)</p><p id="eb06" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">里程</strong> —包含汽车的里程。格式为“26.7 kmpl”-从该字符串中提取出数字。在数据中找到大约20个里程为“0”的值—(没有意义)—已将这些值视为缺失值。下面的散点图—(注意—检查“0”值—这些基本上是缺失值)。如果里程数为0，人们就不会买车。:P</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mc"><img src="../Images/68512da1d65822915bf7b3e9108db673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vbXsmYM8b9Jiwus8bNBsLg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">日志(价格)与里程</figcaption></figure><blockquote class="lm ln lo"><p id="c92b" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">引擎</strong> —包含汽车的‘CC’值。格式为‘1000 cc’—已经从该字符串中提取出数值。在数据中找到大约40个具有“0”引擎的值—(没有意义)—已将这些值视为缺失值。</p><p id="055c" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">动力</strong> —包含汽车的bhp。格式为‘60 BHP’—从该字符串中提取数值。在数据中找到大约40个具有“0”幂的值—(没有意义)—已将这些值视为缺失值。</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es md"><img src="../Images/e90bfa6a26182e35387460634d1e5cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Barlypo90wPrOEt9DXRjmw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">缺失值插补前</figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es me"><img src="../Images/038b6c7b984341fc11de15863889533b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_jHOUlth5RQEnAKNbJq1_Q.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">缺失值插补后</figcaption></figure><blockquote class="lm ln lo"><p id="25b3" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">座位— </strong>包含[1，2，3，4，5] —基本上就是汽车的座位值。注意——这些应该被视为分类变量而不是数字——为什么？(因为这是离散特征而不是连续特征)。该功能的<strong class="ih hj">模式</strong>为“<strong class="ih hj"> 5 </strong></p><p id="c2a1" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj">行驶公里数</strong> —包含汽车行驶的总距离。数字特征。看看下面这些淘气的小离群点的情节。此外，检查移除异常值前后的图中的差异。</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mf"><img src="../Images/38ceb41aadf59f61faf631b14c892dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhGaLPzy67XWSObEJh4Ejw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">在移除异常值之前</figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mg"><img src="../Images/f7b57e5650ae1481f8cd5cc8d79a2d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJq4-tjQ8nXKNnSZJz8A8Q.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">移除异常值后</figcaption></figure><p id="73b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查特征集的<strong class="ih hj">相关矩阵</strong>以及与预测变量的相关性。如果您检查最后一列，我们可以看到<strong class="ih hj">预处理名称</strong>是最相关的预测器，其次是<strong class="ih hj">引擎</strong>和<strong class="ih hj">功率</strong>。已经根据<strong class="ih hj">皮尔逊系数</strong>(数字-数字)、<strong class="ih hj">不确定系数</strong>(分类-分类)、<strong class="ih hj">相关比率</strong>(数字-分类)特征计算了相关关系。已将本博客作为参考生成特征关联—<a class="ae kh" href="https://towardsdatascience.com/the-search-for-categorical-correlation-a1cf7f1888c9" rel="noopener" target="_blank"><strong class="ih hj">https://towardsdatascience . com/the-search-for-categorial-correlation-a1 cf 7 f 1888 c 9</strong></a></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mh"><img src="../Images/bfd7bec3c788848a8b034e8600222838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o1CqeWBYzKfLIo3v1tR1tA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">共线性矩阵-热点图</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="2f67" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">8.用于此项目的机器学习工作流</h1><p id="a2c6" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我不太擅长画流程图——但我还是画了一些流程图，对我在项目中使用的整个数据处理和ML管道进行了粗略的描述。需要注意的一点是——在我的模型训练过程中，我尽可能多次使用<strong class="ih hj">交叉验证</strong>来选择最佳的一组<strong class="ih hj">超参数</strong>。</p><p id="559e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我主要学到的是，建立正确的模型需要在多次迭代、实验、大量交叉验证等方面付出大量努力。在这个项目中，我已经尽了最大努力。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mi"><img src="../Images/7c3edf0a2e2c5ab5d43f2265cb0c4351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CnblFM05Jmd32-c8QC4aGw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">使用的ML工作流</figcaption></figure><p id="0f23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个图表非常简单明了，我相信它是解决任何一种ML任务的标准方法。不过，我还是想澄清一下我在这里使用的一些术语和概念。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="2bd0" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">9.处理缺失值的重要性</h1><p id="80e4" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">引擎，里程数，功率，座位有丢失的价值，如前文中所述。我已经使用了<strong class="ih hj">交叉验证</strong>，通过<strong class="ih hj">简单插补</strong>和<strong class="ih hj">预测插补得到缺失值。</strong>简单插补涉及用均值/中值/众数替换数据集中缺失的值。</p><p id="84f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，预测插补涉及将缺失特征作为输出变量处理，将非缺失特征作为输入变量处理，构建预测变量，然后使用“价格”作为测试RMSE，在单个特征模型上使用交叉验证选择最佳“缺失值”。为此分享一个样本表摘要。</p><p id="571e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如我们所见，<strong class="ih hj"> GB树</strong>模型与均值/中值插补相比，最能预测缺失值。此外，在缺失值插补前后，查看下图<strong class="ih hj">。显然，RMSE的减少表明估算缺失值是多么重要。</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mj"><img src="../Images/ee38db6b594d4a1739016b5e8cfa8e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPhjLUKOxPNmAoYjvCIJYg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">缺失值(交叉验证)模型</figcaption></figure><blockquote class="lm ln lo"><p id="6687" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated">缺失值插补前—</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mk"><img src="../Images/68e6945725f47904a34feab81b89db83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I99jQ6Dv6NuyOYVXVfleCA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">缺失值插补前(里程功能)</figcaption></figure><blockquote class="lm ln lo"><p id="57a3" class="if ig kg ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated">缺失值插补后—</p></blockquote><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ml"><img src="../Images/4dc07da9f598dfe3e70de76e754d2506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*itFADfVLMEDXq5MVWcoenA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">缺失值插补后(里程功能)</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="c860" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">10.从特征中提取文本特征—(汽车名称)</h1><p id="6df4" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在一些基本的文本预处理之后——比如<strong class="ih hj">停用词去除</strong>、<strong class="ih hj">去收缩</strong>、<strong class="ih hj">特殊字符去除</strong>使用<strong class="ih hj">正则表达式</strong>——我还没有使用<strong class="ih hj">词汇化、词干化</strong>等等。因为这些是汽车名称，不会带有相关的同义词和音节。</p><p id="1501" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我试验过<strong class="ih hj">包字</strong>、<strong class="ih hj"> TF-IDF </strong>特征化，也试过<strong class="ih hj"> N-gram </strong>范围(1，4)。当尝试使用此特征构建单特征模型时，与<strong class="ih hj"> TF-IDF </strong>特征化相比，<strong class="ih hj">使用ngram(1，4) </strong>的BOW性能最佳，RMSE最低。</p><p id="d4a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用<strong class="ih hj"> sklearn.pipeline </strong>函数构建一个管道，并执行超参数调整，确定哪些特性参数最适合<strong class="ih hj"> CountVectorizer()。你也可以试试Word2Vec模型，看看是否能得到更好的结果。下面是示例python代码:-</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mm"><img src="../Images/cf096021aa3babf6857e9cb225e0ef66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlSif7euRQaERcT73YGgSg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">参数调整(交叉验证)以提取最佳文本特征</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="4949" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">11.对数字特征进行规范化的需要</h1><p id="8159" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">对于为什么需要这样做，我不是一个专家统计学家。大量的实证研究表明，在对数据中的数字特征进行建模之前，这是一个必要的步骤。我假设这主要是在特征不是正态分布时完成的(这是大多数真实世界特征的情况)。理想情况下，ML模型最适合正态分布的特征——因此有此需要。您可以正常化<strong class="ih hj">公里、发动机、里程、功率</strong>特征。您需要做的只是计算该功能的z值:</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es mn"><img src="../Images/ae3ddc0c73ddeeae003fb0e9e0876e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*MYSq1g8Pii1AuP26J936fg.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">列标准化</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="518f" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">12.编码分类特征</h1><p id="fbb7" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">处理分类数据最流行的方法之一是<strong class="ih hj">一个热编码(OHE) </strong>。这就是我所做的文字功能(鞠躬也是OHE的一种形式)。燃油、变速器、座椅特征可以转换为OHE特征。你可以理解下图它试图做什么:</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mo"><img src="../Images/18990acdd20a539f57797ab81cf2389a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJ5XoWvS3LRR8vYJUAUifA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">参考—<a class="ae kh" href="https://hackernoon.com/what-is-one-hot-encoding-why-and-when-do-you-have-to-use-it-e3c6186d008f" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/what-one-hot-encoding-why-and-when-do-you-have-use-it-e3c 6186d 008 f</a></figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="d4f4" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">13.处理异常值</h1><p id="0c12" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">千米驱动要素包含异常值。我们需要处理这个问题，以消除训练模型中的任何偏见。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ca"><img src="../Images/08b814fde84a4c76cee9f5e4a412184a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w2R0rvcuAaNhU0uaxuHBfA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">检测到异常值</figcaption></figure><p id="90bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用百分位值的<strong class="ih hj">拐点法</strong>或最常见的<strong class="ih hj">拐点法</strong>处理了这些数值特征异常值。正如你在下面看到的，在99.9百分位之后，数值急剧增加。kms_driven值大约为<strong class="ih hj"> 300，000 — ( </strong>这似乎在逻辑上也是合理的)—因为大多数印度汽车在使用3 lac公里后就会报废。我们可以去掉上面的值。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mp"><img src="../Images/9ee785c695a170e1cb2100a1416b3bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJnWKVD5ty1sNkOBof-rVQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">离群点去除</figcaption></figure><p id="2058" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们检查kms_driven的散点图。图表看起来很漂亮，并显示了轻微的下降趋势(如预期的那样)。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mq"><img src="../Images/b3ff7b611590665d16373bcaeac871e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Smdx9VNqLofhn-CerVaBiw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">移除异常值后</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="9470" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">14.检查要素多重共线性</h1><p id="7104" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">当您的要素相互关联时，会出现多重共线性。这会推高ML模型的<strong class="ih hj">方差</strong>(偏差-方差)并导致其过度拟合。因此，小心使用这些功能非常重要。让我们使用相互关系矩阵来检查功能相互关系:-</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mr"><img src="../Images/929146899dc7eaf83aed6bb644918a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*biZafUzKGlla01M3vHdOPQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">Co关系矩阵热图</figcaption></figure><p id="544e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以观察到<strong class="ih hj"> 0.87 </strong>、<strong class="ih hj"> 0.99 </strong>等的(座位—车名)之间的一些高度相关性。理想情况下，我们应该在建模前移除这些特征。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="e8ae" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">15.特征选择实验</h1><p id="eb4c" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">ML建模最重要的一个方面是将正确的特征集输入到ML系统中。有一些算法可以去除不想要的特征(或)增强相关的特征。我做了一些实验，总结了下面的结果。我已经使用<strong class="ih hj">回归树</strong>在这里建立模型:-</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ms"><img src="../Images/9e6facce51a81dcf5caa1eea68a5e5c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r3W39pFYHp8E5kkubzoP-A.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">未来选择实验——总结</figcaption></figure><h2 id="2b53" class="mt je hi bd jf mu mv mw jj mx my mz jn iq na nb jr iu nc nd jv iy ne nf jz ng bi translated"><em class="ll">实验1 —选择最佳相关特征作为目标</em></h2><p id="4c38" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这包括<strong class="ih hj">所有特征</strong>不包括特征移除，所有特征被简单地连接以构建模型。在实验2中，我去掉了<strong class="ih hj"> enigne </strong>，因为它与功耗高度相关，我们可以看到模型性能有所提高。</p><h2 id="0b35" class="mt je hi bd jf mu mv mw jj mx my mz jn iq na nb jr iu nc nd jv iy ne nf jz ng bi translated"><em class="ll">实验3、4、5——使用交叉验证选择“k”个最佳特征</em></h2><p id="6743" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在这种情况下，我通过只选择最相关的特征(与输出高度相关)完成了<strong class="ih hj">特征子集选择</strong>——<strong class="ih hj">sk learn . feature _ selection。SelectKBest </strong>功能实现了这一点。您可以使用“K”来选择您想要子集化的num(features ),并将其用作超参数，并使用交叉验证来获得最佳“K”。正如我们在下面看到的，<strong class="ih hj"> k = 5500 </strong>给出了比使用所有特征更好的交叉验证RMSE。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es nh"><img src="../Images/3ac31ca51a7419e12cfcf919fa3d02ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*wzfVQ1YsikWwbn723UA0zw.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">选择测试的代码</figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ni"><img src="../Images/a3b8bb1b8cf4e6dfc2843abe5e0bebb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLg08rP0-YYkW9WF6tVcZw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">使用交叉值选择最佳</figcaption></figure><h2 id="b7ec" class="mt je hi bd jf mu mv mw jj mx my mz jn iq na nb jr iu nc nd jv iy ne nf jz ng bi translated">实验6 —截断奇异值分解(T-SVD)</h2><p id="0aec" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这涉及到<strong class="ih hj">截断SVD — </strong>，它基本上做一些与<strong class="ih hj"> PCA非常相似的事情。</strong>基本上是将特征转换到低维空间，同时保证其<strong class="ih hj">保持方差</strong>。在这里，我们能够将6000维特征转换为1000维特征，并且还保留了95%的方差。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es nj"><img src="../Images/98a8dce027126f00b34e980d147d0a87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z1nlVERyRtPIoJ57Fn2xYQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">参考—<a class="ae kh" href="https://www.researchgate.net/figure/Diagram-of-SVD-and-truncated-SVD-for-feature-transformation_fig3_3457515" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/figure/Diagram-of-SVD-and-truncated-SVD-for-feature-transformation _ fig 3 _ 3457515</a></figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es nk"><img src="../Images/1942b7e2d6cfa1f2ace04bea6f405508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VxvVaJo1lHJOR89in4mxcQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">(应用人工智能course.com)TSVD的代码片段</figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es nl"><img src="../Images/e27d15deb108f8052e15071de5d7ebee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3TmCUsJ_AAlx-xzIQQrKhw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">截断的SVD(组件数)</figcaption></figure><p id="f9bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您在上面看到的，6000个特征中的1000个在变换后能够保留95%的方差。因此，它通过降维执行特征变换，同时保留95%的方差。</p><h2 id="318d" class="mt je hi bd jf mu mv mw jj mx my mz jn iq na nb jr iu nc nd jv iy ne nf jz ng bi translated">实验7 —(递归特征消除)</h2><p id="9185" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这涉及到<strong class="ih hj">递归特征消除</strong>，这基本上是一种贪婪的特征选择算法——它基本上从所有特征开始，并递归地从模型中删除不相关的特征，以防整体模型性能提高。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es nm"><img src="../Images/28add5f14d5ca350b6d689305713a8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CMiH5tTZvhq_ggEOwOL4hQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">参考—<a class="ae kh" href="https://topepo.github.io/caret/recursive-feature-elimination.html" rel="noopener ugc nofollow" target="_blank">https://top EPO . github . io/caret/recursive-feature-elimination . html</a></figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es nn"><img src="../Images/c3f8b711009f3cdd5cf2d94895a728f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wtetpj3SYZHSaOCwTcL2_Q.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">使用递归选择特征</figcaption></figure><p id="f6aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们在上面看到的，有了2000个特性，我们获得了最佳的模型性能。</p><h2 id="cea8" class="mt je hi bd jf mu mv mw jj mx my mz jn iq na nb jr iu nc nd jv iy ne nf jz ng bi translated"><strong class="ak"> <em class="ll">实验8 —(套索特征消除)</em> </strong></h2><p id="df9a" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这涉及基于套索的要素消除(L1-正则化)，它通过在要素权重中创建稀疏度来实现。使用这种方法，我们获得了4.98的RMSE，表明这是一种用于特征选择的好方法。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es no"><img src="../Images/b75e782c6e529b7d6ebf5d7661276e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*HfrOPEWpd-juAhwO5OPfQA.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">代码片段实验8</figcaption></figure><h2 id="3f15" class="mt je hi bd jf mu mv mw jj mx my mz jn iq na nb jr iu nc nd jv iy ne nf jz ng bi translated">实验9—(基于树的特征选择)</h2><p id="b83e" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这涉及到使用<strong class="ih hj">特征重要性</strong>，我们使用随机森林、决策树等获得这些特征重要性。这里我使用了<strong class="ih hj">额外的树分类器</strong>来得到这个。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es np"><img src="../Images/2ee99e6cc7086e4eb4b840dc9ded8ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*U-Y6Q-yK8MX7DQIFC9nKsQ.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">代码片段实验9</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="0d81" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">16.使用的回归模型</h1><p id="81a5" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我使用了L2线性回归——正则化、回归树、随机森林回归器、梯度推进回归器、XGBoost回归器来训练我的模型。<strong class="ih hj"> XGBoost回归器给出了3.3 </strong>的最佳RMSE，GBM回归器给出了<strong class="ih hj"> 3.5 </strong>，RF回归器给出了<strong class="ih hj"> 3.8 </strong> RMSE，线性回归器给出了<strong class="ih hj"> 4.1 </strong>。XGBoost —永远是赢家:)</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="c804" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">17.超参数调整和交叉验证</h1><p id="4b5d" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">使用<strong class="ih hj">网格搜索CV </strong>对上述ML模型进行了广泛调整，以找到最佳的超参数集—(最大深度、子样本、正则化-λ、num(估计量))。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es nq"><img src="../Images/78432d71a0d6abda18589f4c94d84a5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Og6Het8Io5Yavxje7Rfgpg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">带有xgboost参数调整的gridsearchcv的代码片段</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="06b1" class="jd je hi bd jf jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka bi translated">18.结束注释、学习和结论</h1><p id="d407" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">1.<strong class="ih hj">缺失值插补非常重要</strong>，尤其是当特征与预测变量高度相关时</p><p id="eddf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">异常值去除非常必要</strong>，否则不处理异常值会使ML模型偏向更高的数值。</p><p id="86bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.在开始构建ML模型之前，在单特征模型中构建一个<strong class="ih hj">基准模型</strong> ( <strong class="ih hj">基准RMSE</strong>)——这将为你提供一个基准，来衡量你的ML模型与其他简单模型相比有多好。</p><p id="4f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.<strong class="ih hj">交叉验证</strong>永远是赢家。总是交叉验证你的假设，尝试多种实验来为项目获得最好的特性和方法</p><p id="e334" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.这只是一个ML任务的非常初步的版本。现实世界的问题包括多次迭代，实验。所以一直<strong class="ih hj">保持学习</strong>:)</p></div></div>    
</body>
</html>