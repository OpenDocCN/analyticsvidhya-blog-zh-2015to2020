<html>
<head>
<title>The K-Nearest Neighbor (kNN) Machine Learning algorithm-Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">K-最近邻(kNN)机器学习算法-第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-k-nearest-neighbor-knn-machine-learning-algorithm-part-1-49c52b00079d?source=collection_archive---------12-----------------------#2020-12-28">https://medium.com/analytics-vidhya/the-k-nearest-neighbor-knn-machine-learning-algorithm-part-1-49c52b00079d?source=collection_archive---------12-----------------------#2020-12-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/ff3d0822d6bdea9acbd7a3fabbe68b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eMEh80ugdJ_rgfg24o8EOA.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">“当你有最强的邻居时，恐惧就不在边缘”kNN算法</figcaption></figure><div class=""/></div><div class="ab cl iu iv go iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="ha hb hc hd he"><h2 id="8645" class="jb jc hw bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated"><strong class="ak">简介</strong></h2><p id="f8fd" class="pw-post-body-paragraph jz ka hw kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt ha bi translated"><em class="ku"> k- </em> NN被认为是一种非参数的基于实例的监督懒惰算法，该算法假设最近邻居之间的<strong class="kb hx">多数投票</strong>来生成类别标签。通常，这就足够了，因为它做出的<strong class="kb hx">假设</strong>是<em class="ku">相似的点具有相似的类标签</em>，因此最接近的点应该同意多数标签为真实标签。</p><p id="2079" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated"><em class="ku">关键思路:只存储所有训练样本(，易)。</em></p><p id="1dd8" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">进行查询时，根据最近(最相似)点的值计算新实例的值。</p><p id="a1f3" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">议程:</p><ol class=""><li id="114b" class="la lb hw kb b kc kv kg kw jm lc jq ld ju le kt lf lg lh li bi translated">距离函数</li><li id="56b2" class="la lb hw kb b kc lj kg lk jm ll jq lm ju ln kt lf lg lh li bi translated">最佳K值是多少？</li><li id="7c8b" class="la lb hw kb b kc lj kg lk jm ll jq lm ju ln kt lf lg lh li bi translated">决策面</li><li id="58cf" class="la lb hw kb b kc lj kg lk jm ll jq lm ju ln kt lf lg lh li bi translated"><em class="ku"> k </em> NN的变体</li></ol><h2 id="fc5f" class="jb jc hw bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated"><strong class="ak">距离功能</strong></h2><p id="26cb" class="pw-post-body-paragraph jz ka hw kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt ha bi translated">距离度量的选择在<em class="ku"> k </em> NN中很重要！</p><p id="b569" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">距离函数需要满足某些特性，即，</p><blockquote class="lo lp lq"><p id="8566" class="jz ka ku kb b kc kv ke kf kg kw ki kj lr kx kl km ls ky ko kp lt kz kr ks kt ha bi translated">对称d(x，x′)= d(x′，x)</p><p id="9e1d" class="jz ka ku kb b kc kv ke kf kg kw ki kj lr kx kl km ls ky ko kp lt kz kr ks kt ha bi translated">定d(x，x′)= 0当且仅当x = x′</p><p id="70f5" class="jz ka ku kb b kc kv ke kf kg kw ki kj lr kx kl km ls ky ko kp lt kz kr ks kt ha bi translated">三角形不等式d(a，b) ≤ d(a，c) + d(b，c)</p></blockquote><p id="f83a" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">距离函数有一个一般形式</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es lu"><img src="../Images/fe4a6f4c017914f5ada3dcfcd1117977.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*yXjGgjoHZ2d9N0w-K8U4mA.jpeg"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">kNN中距离函数的一般形式</figcaption></figure><p id="edee" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">当p=2时，对于欧几里德距离</p><p id="bff9" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">p=1，代表曼哈顿距离</p><p id="99dc" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">p =无穷大，表示切比雪夫距离</p><p id="86ac" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">其他距离函数包括:</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es lz"><img src="../Images/aeed97f2ac934caaee5006b32e07777d.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*ABjz7RZwM_lORp4dV3QBxQ.jpeg"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">加权欧几里德距离</figcaption></figure><p id="9e83" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated"><em class="ku">注:连距离也可以学习。</em></p><p id="2164" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">距离度量通常是特定于域的</p><p id="ea57" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">例如生物信息学中的字符串编辑距离</p><p id="da10" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">例如行走数据的时间序列模型中的轨迹距离。</p><h2 id="91e5" class="jb jc hw bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated"><strong class="ak">最佳K值</strong></h2><p id="8c52" class="pw-post-body-paragraph jz ka hw kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt ha bi translated">k控制平滑度，是超参数。首先什么是<strong class="kb hx">超参数</strong>？从技术上来说，<em class="ku">数据之外的一种配置，其价值无法从数据中估计出来。用外行人的话来说，当你做咖喱时，你会加入一些蔬菜、香料，然后加盐。这种盐是你的超参数，所以根据每个人的口味要求，你必须放最佳的，也取决于你放的蔬菜数量，也取决于水的数量。保持简单！🙂</em></p><figure class="lv lw lx ly fd hj"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="0649" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">让我用简单的话来说，给出三张图，图中有一组相同的点，你喜欢哪个分区？</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/2c8c85d120ac861cbbb31f05e6288344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkplXyBjZBRXk2sVcqoGpA.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">明智地选择超参数<em class="it"> k </em></figcaption></figure><p id="1eb3" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">1NN过拟合，31NN欠拟合。最适合的是3NN。</p><p id="3487" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">如果k低会怎样？</p><ul class=""><li id="0dfe" class="la lb hw kb b kc kv kg kw jm lc jq ld ju le kt md lg lh li bi translated">非常非线性的函数可以近似，但我们也会捕捉数据中的噪声。</li><li id="a9c4" class="la lb hw kb b kc lj kg lk jm ll jq lm ju ln kt md lg lh li bi translated">偏差低，方差高。</li></ul><p id="cb93" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">如果k高会怎样？</p><ul class=""><li id="25b7" class="la lb hw kb b kc kv kg kw jm lc jq ld ju le kt md lg lh li bi translated">输出更加平滑，对数据变化不太敏感。</li><li id="6b78" class="la lb hw kb b kc lj kg lk jm ll jq lm ju ln kt md lg lh li bi translated">高偏差，低方差。</li></ul><p id="f188" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">K允许我们在过拟合(小K)和欠拟合(大K)之间进行权衡。</p><p id="6bf0" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">那么我们如何选择最佳的k值呢？</p><p id="1a2e" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">我们将数据集分为训练集、测试集和验证集，在训练集上训练<em class="ku"> k </em> NN，在测试集上评估准确性，在用于挑选最佳<em class="ku">k</em>的验证集上运行交叉验证</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es me"><img src="../Images/0a2b950e677f091cb097e92c1d394dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*5bVEIpizMcqQu_-BSXBF8Q.jpeg"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">演职员表:摘自伊迪丝·劳的幻灯片</figcaption></figure><h2 id="f9bb" class="jb jc hw bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated"><strong class="ak">决定表面</strong></h2><p id="b091" class="pw-post-body-paragraph jz ka hw kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt ha bi translated">它定义了将示例分为不同类别的区域。这也是将所学模型的复杂性可视化的一种方式。一个决策边界参差不齐的学习模型是复杂的，并且容易<em class="ku">过度拟合</em>。决策边界非常简单的学习模型可能<em class="ku">不适合</em>。</p><p id="e5b7" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">最近邻不会显式计算决策边界。</p><p id="e20a" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">在2D，输入空间被划分成<strong class="kb hx"> Voronoi单元</strong>，每个单元由它包含的训练示例的类别来标记。每个决策边界是两个相反类别的点之间等距的线段。</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es mf"><img src="../Images/87d479cbdcb99e1f39be74a857d2a169.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*GtH_AZnrQVIdUKYRQbztuQ.jpeg"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">由Voronoi图产生的2D判定边界</figcaption></figure><p id="dbf0" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">在3D中，决策边界类似于晶体的<strong class="kb hx">表面。</strong></p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es mg"><img src="../Images/76f3090b43021ebc56a5f84c1a27f162.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*lilDCwfglK8jGipMO5-oIA.jpeg"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">三维决策边界</figcaption></figure><h2 id="bb50" class="jb jc hw bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated"><strong class="ak">kNN的变体</strong></h2><p id="4554" class="pw-post-body-paragraph jz ka hw kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt ha bi translated">我们不是采用多数票，而是基于每个邻居xi与测试点x的距离来计算其权重。此外，它引入了一个称为<em class="ku">目标不平衡问题</em>的问题。从这个意义上说，这种模式更倾向于向多数群体学习，因为与少数群体相比，多数群体占主导地位。</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es mh"><img src="../Images/3fb59263b21c159a6a8802216f0aeeed.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*X-ZmKJ0DcGaP7epbuNi1xQ.jpeg"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">距离加权函数</figcaption></figure><p id="538e" class="pw-post-body-paragraph jz ka hw kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt ha bi translated">这个想法是，我们把规则的距离函数作为一个权函数的函数来传递，我们试着预测输出yi。其思想是降低离查询点较远的邻居的权重，从而最小化添加/移除邻居的影响。</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mi"><img src="../Images/cfb23b9f268702733430aaf97c17042b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPdEvmaYKKYixofKz-hicQ.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">其他各种加权函数(来源:摘自伊迪丝·劳的幻灯片)</figcaption></figure></div><div class="ab cl iu iv go iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="ha hb hc hd he"><blockquote class="lo lp lq"><p id="c9a0" class="jz ka ku kb b kc kv ke kf kg kw ki kj lr kx kl km ls ky ko kp lt kz kr ks kt ha bi translated">感谢你花时间留在这个页面上阅读我的作品！这是我第一次在medium上写文章，我需要你们的支持来做进一步的工作！第二部分将会很快发布。<em class="hw">🙂</em></p></blockquote></div></div>    
</body>
</html>