<html>
<head>
<title>Installing TensorFlow, CUDA, cuDNN for NVIDIA GeForce GTX 1650 Ti on Window 10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Window 10 上为 NVIDIA GeForce GTX 1650 Ti 安装 TensorFlow、CUDA、cuDNN</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/installing-tensorflow-cuda-cudnn-for-nvidia-geforce-gtx-1650-ti-onwindow-10-99ca25020d6c?source=collection_archive---------0-----------------------#2020-08-13">https://medium.com/analytics-vidhya/installing-tensorflow-cuda-cudnn-for-nvidia-geforce-gtx-1650-ti-onwindow-10-99ca25020d6c?source=collection_archive---------0-----------------------#2020-08-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="8758" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">GPU vs CPU，训练 MNIST 数据集。</h2></div><h1 id="284c" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">1 条蟒蛇</h1><p id="aecc" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">在我们开始之前，我想和你分享一下蟒蛇。如果你熟悉，请跳过这一部分。如果你需要在你的电脑上运行不同的演示，就需要设置不同的虚拟环境。因为每次运行不同的演示时都要更改 TensorFlow 或其他库的版本是不现实的。</p><p id="4e90" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">最简单的方法之一是使用<a class="ae kq" href="https://www.anaconda.com/products/individual" rel="noopener ugc nofollow" target="_blank"> anaconda </a>。你可以先下载你的电脑系统版本(Window、MacOS 或 Linux)并安装。接下来，使用 conda 创建一个虚拟环境。在这一步中，您还可以指定 python 版本。在这种情况下，我使用 python 3.7。您可以打开终端并键入:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4203" class="la iy hi kw b fi lb lc l ld le">conda create -n demoEnv python=3.7</span></pre><h1 id="f8e0" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">2 张量流</h1><p id="242c" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">创建虚拟环境后，您应该首先激活它。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="cb9e" class="la iy hi kw b fi lb lc l ld le">activate demoEnv</span></pre><p id="3233" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">现在，您处于名为 demoEnv 的虚拟环境中。您可以在此环境中安装软件包。我们现在可以安装<a class="ae kq" href="https://www.tensorflow.org/install/pip#windows_1" rel="noopener ugc nofollow" target="_blank">张量流</a>。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="98de" class="la iy hi kw b fi lb lc l ld le">pip3 install --upgrade tensorflow==1.15</span></pre><h1 id="d771" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">3 CUDA</h1><p id="e113" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">你可以在<a class="ae kq" href="https://www.tensorflow.org/install/source_windows" rel="noopener ugc nofollow" target="_blank"> TensorFlow 网站</a>找到相应版本的 CUDA 和 cuDNN 来支持 TensorFlow 的版本。</p><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lf"><img src="../Images/3abf4a0dcced393e3715defc48411e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L3doclWBSca2wuse4y8loA.png"/></div></div></figure><p id="07ef" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">在这个演示中，我的 TensorFlow 是 1.15。所以我应该下载 CUDA 10.0 和 cuDNN 7.4。</p><p id="fd84" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">CUDA 10.0 可以在这个<a class="ae kq" href="https://developer.nvidia.com/cuda-downloads?target_os=Windows&amp;target_arch=x86_64" rel="noopener ugc nofollow" target="_blank">网站</a>下载，点击旧版即可。</p><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es ln"><img src="../Images/c998b2c043854afe6c3b4601908f4a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i1ff2meUR0v8rdSJNXLqGw.png"/></div></div></figure><p id="0a35" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">找到 CUDA Toolkit 10.0 并选择您的系统和版本 10.0。</p><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lo"><img src="../Images/f31bf8189d8e3c65d53b743ed997fa06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ti5JquEPb0DKrP55itYIXA.png"/></div></div></figure><p id="13bc" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">下载 CUDA 10.0 后，通过运行 exe 一步一步安装。</p><h1 id="99d2" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">4 cuDNN</h1><p id="297b" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">最后一步是安装 cuDNN。我们需要 cuDNN 7.4。你可以在这个<a class="ae kq" href="https://developer.nvidia.com/rdp/cudnn-archive" rel="noopener ugc nofollow" target="_blank">网站</a>下载。NVIDIA 需要你先注册。</p><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lp"><img src="../Images/c7bc6d43dc1faf8b11f6b6718c241673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7KR0x2AQPxF2SzmN--LoHw.png"/></div></div></figure><p id="4290" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">cuDNN 实际上是一个包含 bin、include、lib 文件的文件夹。找到您的 CUDA 计算工具包的路径。它可能在下面的路径中:</p><p id="ae8c" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated"><em class="lq"> C:\Program Files\NVIDIA GPU 计算工具包\CUDA\v10.0 </em></p><p id="93c3" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">将 cuDNN 的 bin、include、lib 文件粘贴到 CUDA 10.0 的相应位置。这个<a class="ae kq" href="https://docs.nvidia.com/deeplearning/cudnn/install-guide/index.html#installdriver-windows" rel="noopener ugc nofollow" target="_blank">网站</a>也可以参考这个步骤。</p><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lr"><img src="../Images/eb36dcf7e31d53e92c38841473b55da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LE4H4Z2ht9BdvsWlbNLjhQ.png"/></div></div></figure><h1 id="2e4e" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">5 环境路径</h1><p id="69b2" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在您已经完成了 TensorFlow、CUDA 和 cuDNN 的安装。为了保证 TensorFlow 能找到 CUDA，你要去<em class="lq">系统环境</em>添加 CUDA 路径。在我的系统中，我将这两个目录添加到<strong class="jr hj"> <em class="lq">路径</em> </strong>中。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4418" class="la iy hi kw b fi lb lc l ld le">C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\bin</span><span id="720a" class="la iy hi kw b fi ls lc l ld le">C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\libnvvp</span></pre><h1 id="ac6c" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">6 用你的 GPU 训练一个 CNN 模型</h1><p id="8f58" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在我们可以使用 GPU 来训练模型。如果你使用 PyCharm，你可以进入<em class="lq">设置</em>，在 demoEnv 下用 python.exe 添加项目解释器。</p><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lt"><img src="../Images/e65a5e08803948d347c8d6312a7ca1f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yDxhkrP_4-mqRrXN3UJgGg.png"/></div></div></figure><p id="17bd" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">我们可以通过用卷积神经网络训练一个 MNIST 教程来比较 GPU 和 CPU 的速度。众所周知，GPU 做卷积比 CPU 快很多。所以训练 CNN 应该会快很多。在我们刚刚创建的虚拟环境中运行如下脚本。它会用 GPU 训练。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ba7a" class="la iy hi kw b fi lb lc l ld le">import numpy as np<br/>from tensorflow import keras<br/>from tensorflow.keras import layers<br/>num_classes = 10<br/>input_shape = (28, 28, 1)<br/><br/># the data, split between train and test sets<br/>(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()<br/><br/># Scale images to the [0, 1] range<br/>x_train = x_train.astype("float32") / 255<br/>x_test = x_test.astype("float32") / 255<br/># Make sure images have shape (28, 28, 1)<br/>x_train = np.expand_dims(x_train, -1)<br/>x_test = np.expand_dims(x_test, -1)<br/>print("x_train shape:", x_train.shape)<br/>print(x_train.shape[0], "train samples")<br/>print(x_test.shape[0], "test samples")<br/><br/><br/># convert class vectors to binary class matrices<br/>y_train = keras.utils.to_categorical(y_train, num_classes)<br/>y_test = keras.utils.to_categorical(y_test, num_classes)<br/>model = keras.Sequential(<br/>    [<br/>        keras.Input(shape=input_shape),<br/>        layers.Conv2D(32, kernel_size=(3, 3), activation="relu"),<br/>        layers.MaxPooling2D(pool_size=(2, 2)),<br/>        layers.Conv2D(64, kernel_size=(3, 3), activation="relu"),<br/>        layers.MaxPooling2D(pool_size=(2, 2)),<br/>        layers.Flatten(),<br/>        layers.Dropout(0.5),<br/>        layers.Dense(num_classes, activation="softmax"),<br/>    ]<br/>)<br/><br/>model.summary()<br/>batch_size = 128<br/>epochs = 5<br/><br/>model.compile(loss="categorical_crossentropy", optimizer="adam", metrics=["accuracy"])<br/><br/>model.fit(x_train, y_train, batch_size=batch_size, epochs=epochs, validation_split=0.1)</span></pre><p id="0c2a" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">在 MNIST 数据集上完成 5 个历元的模型训练需要约 13 秒，验证准确率约为 98.97%。</p><figure class="kr ks kt ku fd lg"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="85ef" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">我也用 CPU i7 运行相同的脚本。在如下 5 个时期中完成 MNIST 数据集的训练花费了大约 1 分 30 秒。验证准确率为 99.05%，非常接近 GPU 的结果。</p><figure class="kr ks kt ku fd lg"><div class="bz dy l di"><div class="lu lv l"/></div></figure><h1 id="59f7" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">7 结论</h1><p id="eec7" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">大家可以看到，训练 CNN 的时候 GPU 比 CPU 快很多，13s 比 90s。综上所述，我用 Python 3.7，CUDA 10.0，cuDNN 7.4 成功设置了 TensorFlow 1.15。</p><p id="fbba" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">而且我还创建了另一个虚拟环境，在这个 GPU GeForce GTX 1650 Ti 中成功安装了 TensorFlow 2.3 与 Python 3.6/3.8、CUDA 10.1 和 cuDNN 7.6。它看起来像下面这样，</p><figure class="kr ks kt ku fd lg"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="e46b" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">主要问题是当我试图安装 Tensorflow 2.3 时，我无法根据从源代码构建的<a class="ae kq" href="https://www.tensorflow.org/install/source_windows" rel="noopener ugc nofollow" target="_blank">找到 cuDNN 7.4。所以我试着用 cuDNN 7.6，效果不错。如果你有任何问题，请在下面留言。谢了。</a></p><p id="b655" class="pw-post-body-paragraph jp jq hi jr b js kl ij ju jv km im jx jy kn ka kb kc ko ke kf kg kp ki kj kk hb bi translated">更多提示:</p><ol class=""><li id="cfbe" class="lw lx hi jr b js kl jv km jy ly kc lz kg ma kk mb mc md me bi translated">我的另一款 GPU GeForce GTX 1060 6GB，我用的是 Tensorflow 1.15，Python 3.7，CUDA 10.0，但是 cuDNN 的版本是 7.6(针对 CUDA 10.0)，跟<a class="ae kq" href="https://www.tensorflow.org/install/source_windows" rel="noopener ugc nofollow" target="_blank"> Tensorflow 网站</a>不一样。并且我成功的用 GPU 训练了模型。</li><li id="4920" class="lw lx hi jr b js mf jv mg jy mh kc mi kg mj kk mb mc md me bi translated">我还在上面的 PC 上创建了一个新的虚拟环境，用的是 GeForce GTX 1060 6GB。我用的是 Tensorflow 2.2.0，Python 3.6，CUDA 10.1，cuDNN 7.6(针对 CUDA 10.1)，用 GPU 训练模型也可以。</li></ol></div></div>    
</body>
</html>