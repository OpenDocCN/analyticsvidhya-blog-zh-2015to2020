<html>
<head>
<title>Interacting with webcam and video file and some drawing with OPEN CV — PART-II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与网络摄像头、视频文件和一些打开简历的绘图互动—第二部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/interacting-with-webcam-and-video-file-and-some-drawing-with-open-cv-part-ii-a38b68196a19?source=collection_archive---------13-----------------------#2020-01-28">https://medium.com/analytics-vidhya/interacting-with-webcam-and-video-file-and-some-drawing-with-open-cv-part-ii-a38b68196a19?source=collection_archive---------13-----------------------#2020-01-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/84e2d84a1d2483a4c5f9df2e22c3d7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7NyiWSdA1K42P3JpIapzA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">公开简历(第二部分)</figcaption></figure><p id="1b51" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你可以在这里阅读第一部分</p><p id="af82" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在第1部分中，我们学习了<strong class="iw hj"> imread() </strong>方法、<strong class="iw hj"> imshow() </strong>方法，以及在窗口中显示图像并通过按任意键来破坏它，所以在这一部分中，我将不解释这些行。让我们开始— —</p><p id="08f3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们将看到如何绘制一些形状或如何从打开简历的图像上写文本。如你所知，我们首先导入库来做相关的事情，所以我不会在每一部分都告诉你，但是当导入新库时，我会向你解释。</p><p id="d54a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是代码—</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/f6168e3d58bc59c747d4cb303b185409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*AvovnGFTS4ptfDWX8iA7ng.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">cat.png(我的形象)</figcaption></figure><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="bf6d" class="kd ke hi jz b fi kf kg l kh ki">image=cv2.imread(<strong class="jz hj">'cat.png'</strong>,cv2.IMREAD_COLOR)<br/><br/>cv2.line(image,(50,50),(350,50),(255,255,255),5,cv2.LINE_AA)<br/><br/>cv2.rectangle(image,(250,250),(400,400),(0,250,125),5)<br/><br/>cv2.circle(image,(200,203),100,(0,0,255),1)<br/><br/>points=np.array([[4,5],[100,150],[230,67],[203,190]],np.int32)<br/>cv2.polylines(image,[points],<strong class="jz hj">True</strong>,(255,255,0),1)<br/><br/>font=cv2.FONT_HERSHEY_COMPLEX_SMALL<br/>cv2.putText(image,<strong class="jz hj">'opencv part2'</strong>,(0,130),font,1,(200,234,123),2,cv2.LINE_8)<br/><br/>cv2.imshow(<strong class="jz hj">'image'</strong>,image)<br/><br/>cv2.waitKey(0)<br/>cv2.destroyAllWindows()</span></pre><p id="7f02" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我会一行一行地解释上面的代码-</p><blockquote class="kj kk kl"><p id="6af9" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">第1行—使用cv2读取图像。第一个参数是图像文件，第二个参数是图像的颜色，我们用<strong class="iw hj"> cv2拍摄彩色图像。IMREAD_COLOR。</strong></p><p id="70b4" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">第2行——在第2行中，我们用方法<strong class="iw hj"> cv2.line() </strong>在图像上制作直线。在该方法中，我们给出类似于图像的参数，线的原点、线的终点、颜色(BGR格式)、线的粗细和线的类型(通过<strong class="iw hj"> cv2)。LINE_AA </strong>)。你可以选择更多的线型(当你在pycharm中输入第一个字母L时，它会在下拉列表中显示类似的内容，然后你可以从中选择)。</p><p id="159a" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">第3行——在第3行中，我们用方法<strong class="iw hj"> cv2.rectangle() </strong>在图像上制作矩形。在这个方法中，我们给出类似图像的参数，矩形的左上角点，矩形的右下角点，颜色(BGR格式)，矩形的厚度，你也可以给出矩形的线型(通过<strong class="iw hj"> cv2。LINE_AA </strong>)。</p><p id="47bd" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">第4行——在第4行中，我们用方法<strong class="iw hj"> cv2.circle() </strong>在图像上画圆。在这种方法中，我们同样给出参数图像、圆心、圆的半径、颜色(BGR格式)、圆的厚度，你也可以给出圆的线型(通过<strong class="iw hj"> cv2。LINE_AA </strong>)。</p><p id="e7c2" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">第5行和第6行——在第5行和第6行，我们用方法<strong class="iw hj">cv2 . polysis()</strong>在图像上制作多边形。首先我们将制作<strong class="iw hj"> numpy数组</strong>中的点(多边形的点)，然后在<strong class="iw hj">cv2 . polysis()</strong>方法中我们同样给出参数image，points(点的数组)，多边形是否闭合(真与假)，颜色(以BGR格式)，多边形的粗细以及你也可以给出圆的线型(通过<strong class="iw hj"> cv2)。LINE_AA </strong>)。</p><p id="657c" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">第7 &amp; 8行——在第7 &amp; 8行中，我们用方法<strong class="iw hj"> cv2.putText() </strong>将文本放在图像上。首先我们将使字体的<strong class="iw hj">变量</strong>存储字体的值(这里<strong class="iw hj">我们用</strong> <strong class="iw hj"> cv2给出cv2字体)。FONT_HERSHEY_COMPLEX_SMALL </strong>，然后在<strong class="iw hj"> cv2.putText() </strong>方法中我们同样给出参数image，Text(ex — opencv part2)，text的起点，FONT，fontscale，color(BGR格式)，text thickness，你也可以给出文本的线型(通过<strong class="iw hj"> cv2)。LINE_AA </strong>)。</p><p id="29bb" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">之后，我们展示图像并摧毁它(我在第一部分解释过)。</p></blockquote><p id="426d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">结果是——</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/c6e0985b6b6d9a597b816cc0f2ac61b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*19A62hTopq9trvLHwBZ8PQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">绘图后的图像</figcaption></figure><p id="f0fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们将看到一些更有趣的事情。</p><p id="1014" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当我说我们可以剪切图像的一部分，并将其设置在图像的另一部分时，有多少人会感到惊讶？是的，这可以通过打开cv来实现，通过打开cv，你可以改变图像中任何像素的颜色。</p><blockquote class="kj kk kl"><p id="af1d" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">print(image[400，400])#输出:某种BGR格式的颜色((###，##，##))</p><p id="ea12" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">image[400，400]=(255，255，0)</p><p id="8d0f" class="iu iv km iw b ix iy iz ja jb jc jd je kn jg jh ji ko jk jl jm kp jo jp jq jr hb bi translated">print(image[400，400]) #output: (255，255，0)</p></blockquote><p id="eb4d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">image[400，400]表示您正在选择图像的(400，400)点，当您打印它时，它将为您提供该点的颜色(以BGR格式)，当您通过“image[400，400]=(255，255，0)”更改颜色图像时，它将为您提供(255，255，0)的颜色。</p><p id="057f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你也可以改变图像中大片区域的颜色—</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="b237" class="kd ke hi jz b fi kf kg l kh ki">#image[x1:x2,y1:y2]<br/>image[250:300,250:300]=[255,255,255]</span></pre><p id="b84a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里250:300是x轴上从250到300的x范围，250:300是y轴上从250到300的范围，因此这些点覆盖的区域变为白色([255，255，255])。</p><p id="0b7b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们把图像的一部分放到另一部分—</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="95be" class="kd ke hi jz b fi kf kg l kh ki">cat_face=image[80:200,280:400]<br/>image[0:120,0:120]=cat_face</span></pre><p id="7618" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们将图像部分存储在cat_face变量中，cat_face的大小为[200–80，400–280]，这就是为什么您只能将此图像放入该大小的空间中。也就是说，我们将猫脸放在图像[0:120，0:120]中(这些数字可以是任何数字，但差异应该与猫脸大小相同，例如图像[300:420，100:220])。</p><p id="0413" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你自己去理解吧，这太容易理解了。</p><p id="844f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">结果图像是—</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/7f5f34ea68c1818ca3c1c5ae2dd9e508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*QnyBvHRUGzOO0Sz_zT5l1w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">猫的最终形象</figcaption></figure><h1 id="a056" class="ks ke hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated"><strong class="ak">现在是时候介绍一些关于网络摄像头和视频文件的知识了</strong></h1><p id="fed4" class="pw-post-body-paragraph iu iv hi iw b ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn lt jp jq jr hb bi translated">图像和视频没有太大的区别，我们可以说视频是图像帧的集合。所以我们将尝试通过opencv来理解这一点。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="c0a0" class="kd ke hi jz b fi kf kg l kh ki">image_capture=cv2.VideoCapture(0)<br/><strong class="jz hj">while True</strong>:<br/>    ret,frame=image_capture.read()<br/>    cv2.imshow(<strong class="jz hj">'frames'</strong>,frame)<br/>    <strong class="jz hj">if </strong>cv2.waitKey(1) &amp; 0xFF == ord(<strong class="jz hj">'m'</strong>):<br/>        <strong class="jz hj">break<br/></strong>image_capture.release()<br/>cv2.destroyAllWindows()</span></pre><p id="f039" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在第一行中，我们通过cv2创建了image_capture对象。VedioCapture(0)，我给参数0，因为我还没有使用摄像机(假设你正在制作视频，在那个时候你运行代码，所以你给参数1)。之后，我们运行while循环进行无限循环，在while循环中，我们连续读取图像帧(<strong class="iw hj"> image_capture.read() </strong>)有两个变量ret和frame，ret是布尔值，如果您的相机给出当前时间的图像，那么它是真的，但当出现问题时，那么值是假的。帧是您相机的当前图像。之后，我们在名为frames的窗口中连续显示帧(<strong class="iw hj"> cv2.imshow('frames '，frame) </strong>)。这个while条件将使循环无限循环，所以我们将不得不在某处停止它，因为我们将使用if条件，这样当我们按下m按钮时，它就可以中断while循环。它会给你一个每时每刻的图像，你会认为那是视频。所以在中断while循环之后，我们必须释放视频捕获进程(image_capture.release())。</p><p id="3513" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">你还可以改变视频的背景主题</strong>，比如你可以把它变成灰色。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="3894" class="kd ke hi jz b fi kf kg l kh ki">#you have to put this code in while loop<br/>gray=cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)<br/>cv2.imshow(<strong class="jz hj">'gray'</strong>,gray)</span></pre><p id="77a3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上面的代码中，我们转换每一帧的颜色(通过<strong class="iw hj"> cvtColor() </strong>方法)并在另一个名为gray的窗口中显示。</p><p id="f96c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以运行后，我们可以看到两个窗口，第一个是自然视频，第二个是灰色视频</p><p id="bf25" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">你也可以通过写一些代码来保存这些视频— - </strong></p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="4556" class="kd ke hi jz b fi kf kg l kh ki">image_capture=cv2.VideoCapture(0)<br/>folder=cv2.VideoWriter_fourcc(*<strong class="jz hj">'XVID'</strong>)<br/>out=cv2.VideoWriter(<strong class="jz hj">'output.mp4'</strong>,folder,20.0,(640,480))<br/><strong class="jz hj">while True</strong>:<br/>    ret,frame=image_capture.read()<br/>    out.write(frame)<br/>    cv2.imshow(<strong class="jz hj">'frame'</strong>,frame)<br/>    <strong class="jz hj">if </strong>cv2.waitKey(1) &amp; 0xFF == ord(<strong class="jz hj">'p'</strong>):<br/>        <strong class="jz hj">break<br/></strong>image_capture.release()<br/>out.release()<br/>cv2.destroyAllWindows()</span></pre><p id="10ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上面的代码中，你知道的最多，所以我只解释几行。在第二行，我通过<strong class="iw hj"> VideoWriter_fourcc(*'XVID ')对我的视频进行编码(编码是XVID)。</strong>在<strong class="iw hj"> </strong>第三行我们给出了关于视频文件<strong class="iw hj"> (cv2)的信息。VideoWriter('output.mp4 '，folder，20.0，(640，480)) </strong>)第一个参数是视频文件的名称，第二个是编解码器，第三个与视频的速度有关(当您增加值时，视频速度也会增加)。之后，在while循环中，我们必须制作每一帧的视频，并将其保存在该文件中(<strong class="iw hj"> out.write(frame) </strong>)。</p><p id="8f01" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你看到你当前的工作目录中会有一个以你名字命名的视频。</p><p id="250f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这部分到此为止。</p><p id="19c7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在第三部分，我们将阅读更多关于公开简历的内容。</p><p id="f2d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">谢了。</p></div></div>    
</body>
</html>