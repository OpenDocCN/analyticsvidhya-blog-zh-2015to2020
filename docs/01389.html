<html>
<head>
<title>Time Series: Decomposition (Part I) — Trend Cycle Computation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列:分解(第一部分)——趋势周期计算</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-decomposition-part-i-trend-cycle-computation-29fac227896a?source=collection_archive---------6-----------------------#2019-10-19">https://medium.com/analytics-vidhya/time-series-decomposition-part-i-trend-cycle-computation-29fac227896a?source=collection_archive---------6-----------------------#2019-10-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="28c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经在之前的博客中讨论过趋势、季节性和周期性模式。任何时间序列都可以分解成3个部分:趋势周期、季节性和残差。由于很难分别估计趋势和周期分量，我们将趋势和周期合并成一个趋势-周期分量。</p><p id="c726" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们从时间序列数据中提取成分，以便我们可以更好地理解潜在的模式，并且这些成分可以用于改进预测。</p><p id="ed8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有两种方法可以分解时间序列:</p><ol class=""><li id="3f37" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">乘法</strong> : <em class="jm"> y(t) = T(t) * S(t) * R(t) </em></li><li id="c5a0" class="jd je hi ih b ii jn im jo iq jp iu jq iy jr jc ji jj jk jl bi translated"><strong class="ih hj">加法</strong> : <em class="jm"> y(t) = T(t) + S(t) + R(t) </em></li></ol><p id="59bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中y(t)是原始序列，T(t)是时间T的趋势周期分量，S(t)是时间T的季节性分量，R(t)是时间T的残差分量。</p><p id="4742" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当季节变化与趋势无关时，通常使用加法分解，而当季节变化与趋势成比例时，则使用乘法分解。</p><p id="79ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们试着想象使用乘法和加法分解的场景。</p><p id="bfec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">场景1:乘法分解</strong></p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/560555c176dcff28e42a787af8d52713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F6hY0wRXBp_dXm-pDSTmyw.png"/></div></div></figure><p id="d01f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的图中(A10数据集，Rob J Hyndman)，我们可以看到季节性变化与趋势成比例地持续增加。在这种情况下，我们更喜欢乘法分解。</p><p id="16d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">场景2:加法分解</strong></p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/4cbc8a043544b9a9ab9691b098229a68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XC7V0K-FQt8p7Gs8qcACiA.png"/></div></div></figure><p id="56bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上图中，我们可以看到季节变化不受趋势的影响，并且始终几乎相同，在这种情况下，建议使用加法分解。</p><p id="4e3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们知道了加法分解和乘法分解的区别，让我们试着找出第一个分量，趋势周期分量。对于两种分解方法(加法和乘法)，计算趋势周期分量的算法是相同的。</p><p id="598b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">趋势周期计算</strong></p><p id="ba6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了提取趋势周期成分T(t ),许多组织(例如:加拿大统计局<a class="ae ke" href="https://www.statcan.gc.ca/eng/dai/btd/trend-cycle" rel="noopener ugc nofollow" target="_blank">仍然使用经典m-移动平均(m-MA)方法的一些变体。</a></p><p id="1f21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们来讨论一下m-MA(m-移动平均线)算法，</p><p id="329b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用数学术语来说，趋势分量可以写成:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kf"><img src="../Images/cc12458e48d56d0ab32ac58b435eb69b.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/1*FPsV_SPRE9x3n0B_mMb9ZA.gif"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">经典分解的趋势方程</figcaption></figure><p id="0ae2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在哪里，</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kk"><img src="../Images/80fe9a8a4ad664b6d0243c6fb78901be.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/1*cdeSGpKDnIT8aq2m4daaZQ.gif"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">k和m之间的关系。</figcaption></figure><p id="a3c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，我们可以说时间t的时间序列的趋势分量是k个窗口内所有点的平均值，包括该点。</p><p id="2510" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们尝试使用a10数据集来更好地理解这一点(Rob J Hyndman fpp CRAN)，</p><p id="e058" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个数据集a10(Rob J . hynd man)，澳大利亚1990年至2008年的抗糖尿病药物月需求量为百万。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kl"><img src="../Images/a95a097188713b260101b4b2ffbcf4bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*0-SWixgwOSzR1A_Z1NLSWA.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">图:a10数据集的快照</figcaption></figure><p id="a5f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用下面的python代码来查找该数据集的5毫安、7毫安、9毫安、11毫安和13毫安。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="0545" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们尝试改变上述函数的m，并查看前几行:</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ko"><img src="../Images/37946ab3921679de03fdf6472f2ffb95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GfQFe3pDdVnlYPA5UyCqzA.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">澳大利亚抗糖尿病月度需求数据中5 MA、7 MA、8 MA、11 MA和13 MA成分的值。</figcaption></figure><p id="e0f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，每个m移动平均分量的前k行没有值。这是因为这些行没有足够的点数来计算移动平均分量。我们可以使用像cut和normalize方法这样的方法来处理这些值，但是为了保持博客简单，我们在这里不讨论它。</p><p id="859a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看m的不同值的曲线图。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/e72f9ef95a17f45ec78e5aa628b77aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AI_BnpvSursJuKAyZtrA3w.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">澳大利亚每月抗糖尿病药物需求数据的5 MA成分。</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/e8012af400577633e0914fcd34a18f9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yzEbvbCUelSsq9ErKDH2VQ.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">澳大利亚每月抗糖尿病药物需求数据的7毫安组成部分。</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/b19f291df86aabd23cd68d55d9209a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySYHO7PFW0uezaED5n9QOA.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">澳大利亚每月抗糖尿病药物需求数据的9毫安组成部分。</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/92c1850166c4cfe0f4cc0edc8856f465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UzIAJo8LEThSxK_yBwGLiw.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">澳大利亚每月抗糖尿病药物需求数据的11毫安组成部分。</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/89e99552d97f4fc680469955acd0779a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7BO7DVELg7Q52hOVCpnUA.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">澳大利亚每月抗糖尿病药物需求数据的13毫安组成部分。</figcaption></figure><p id="4f12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，随着m的增加，趋势分量变得更加平滑。</p><p id="271d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们只取了m的奇数值{5，7，9，11，13}。当m是奇数时，例如在每周数据中(m = 7)，这是有帮助的，但是在m是偶数的情况下，例如每个月记录的数据(m=12)，我们使用2*m MA方法。(也称为中心移动平均线)。</p><p id="a146" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们一直使用的a20数据集是按月记录的，因此集中移动平均线非常适合这里。</p><p id="872f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，我们找到数据的12毫安，然后对从12毫安方法获得的序列应用2毫安。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kq"><img src="../Images/400d89845d1d414dde5274ea48c4c21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHi4tGaMyyGPpZiNwXP1Ug.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">月度需求数据中12毫安和2 X 12毫安分量的值。</figcaption></figure><p id="fad6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们想象一下2*12毫安的元件。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/58c4a7414d3a25083a9ee3589239fece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RgosRMt06l06lcv4TicqlA.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">澳大利亚抗糖尿病月度需求数据的2X12毫安组成部分。</figcaption></figure><p id="5da9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以清楚地看到，2 X 12 MA趋势分量比其他m MA趋势分量(5，7，9，11，13)平滑得多。</p><p id="f544" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开发人员不需要从头开始编写代码来寻找趋势组件。在实践中，我们使用内置的python stats模块来查找趋势组件。</p><p id="e0fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用内置的python stats模块，并将我们的2 X 12 MA分量(趋势周期分量)与使用python stats模块获得的趋势分量进行比较。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="2912" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在stats模块的帮助下，只需两行代码(一个import语句后跟一个函数调用)就可以找到趋势组件。😃</p><p id="9ce3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们比较一下从内置python stats模块获得的趋势和从m_moving_average()函数获得的(2 X 12 MA)趋势。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kr"><img src="../Images/b9877a496ce8e966326b653df7b6ffe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*heatxmAHvsWzyKdnjuaAXA.jpeg"/></div></div></figure><p id="f530" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们可以看到，通过自己计算提取的趋势分量与从内置的stats模块中获得的趋势分量相似。</p><p id="3845" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm"> 2 X m </em>移动平均法相当于(m+1)阶的加权移动平均法。上述2 X 12 MA分解可以表示为13阶移动平均。13个月的权重分别为<em class="jm"> 1/24、</em>1/12、<em class="jm"> 1/12 </em>、<em class="jm"> 1/12 </em>、<em class="jm"> 1/12 </em>、<em class="jm"> 1/12 </em>、<em class="jm"> 1/12 </em>、<em class="jm"> 1/12 </em>、<em class="jm"> 1/12 </em>、<em class="jm"> 1/12 </em>、<em class="jm">因此，2 X m模型的第一个和最后一个元素的权重为1/2m，所有其他元素的权重为1/m。</em></p><p id="697f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，加权移动平均法表示为</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ks"><img src="../Images/604fd5c609c47c6b47708b40c6973853.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/1*t7rIuMn4-wzk5tvzYW4mMA.gif"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">加权m-MA方程。</figcaption></figure><p id="6943" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中权重之和是1，并且权重应该是对称的，即</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kt"><img src="../Images/d82cade3f20629b93fd6422edfdeeec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/1*peHddAGo4LcWFGrg0LEwTA.gif"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">权重之和为一。</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ku"><img src="../Images/04b4fce9f13ccb5b241f6ba070ff7802.png" data-original-src="https://miro.medium.com/v2/resize:fit:254/1*SI253xFf8olP4BeGsCIfJA.gif"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">对称权重</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kv"><img src="../Images/9b333d6860cc1cf74ed8be44b422e4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/1*s5Oy84EWBJX2pkQL1kMs4w.gif"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">k和m之间的关系。</figcaption></figure><p id="36b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">加权移动平均线给出了趋势周期成分的平滑估计。</p><p id="fac2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们知道如何使用m-MA和2*m-MA方法找到趋势分量。在下一篇博客中，我们将使用经典分解找出季节和剩余成分。</p><p id="5e38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考资料:</p><div class="kw kx ez fb ky kz"><a href="https://www.statcan.gc.ca/eng/dai/btd/trend-cycle" rel="noopener  ugc nofollow" target="_blank"><div class="la ab dw"><div class="lb ab lc cl cj ld"><h2 class="bd hj fi z dy le ea eb lf ed ef hh bi translated">加拿大统计局趋势周期估计的计算细节</h2><div class="lg l"><h3 class="bd b fi z dy le ea eb lf ed ef dx translated">本文件详细说明了加拿大统计局计算趋势周期估计值的方法。它旨在作为一个技术…</h3></div><div class="lh l"><p class="bd b fp z dy le ea eb lf ed ef dx translated">www.statcan.gc.ca</p></div></div></div></a></div><div class="kw kx ez fb ky kz"><a href="https://otexts.com/fpp2/decomposition.html" rel="noopener  ugc nofollow" target="_blank"><div class="la ab dw"><div class="lb ab lc cl cj ld"><h2 class="bd hj fi z dy le ea eb lf ed ef hh bi translated">第6章时间序列分解|预测:原理与实践</h2><div class="lg l"><h3 class="bd b fi z dy le ea eb lf ed ef dx translated">时间序列数据可以表现出各种各样的模式，将一个时间序列分割成几个…</h3></div><div class="lh l"><p class="bd b fp z dy le ea eb lf ed ef dx translated">otexts.com</p></div></div></div></a></div></div></div>    
</body>
</html>