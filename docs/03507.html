<html>
<head>
<title>Basic of Correlations and Using Pandas and SciPy for calculating correlations.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">相关性基础和使用Pandas和SciPy计算相关性。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basic-of-correlations-and-using-pandas-and-scipy-for-calculating-correlations-2d16c2bd6af0?source=collection_archive---------4-----------------------#2020-02-05">https://medium.com/analytics-vidhya/basic-of-correlations-and-using-pandas-and-scipy-for-calculating-correlations-2d16c2bd6af0?source=collection_archive---------4-----------------------#2020-02-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c57a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好，</p><p id="e3ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天我将解释python中的相关性和使用的基础。我认为在处理简单和多元线性回归时，了解相关性的概念是很重要的。</p><p id="3ccb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">相关性</strong>是衡量两个变量相互关联程度的指标。最常见的相关性度量是<strong class="ih hj">皮尔逊相关系数</strong>，对于两组配对数据<em class="jd"> 𝑥𝑖 </em>和<em class="jd"> 𝑦𝑖 </em>，其定义为</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/ebd8e7e3725eadf9fc66bfe26cfbb445.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*JIY_hEhVglqoHEk2iYFHUw.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">相关公式</figcaption></figure><p id="ddc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里<em class="jd"> 𝑟 </em>是1到-1之间的数，<em class="jd">𝑟</em>t46】0表示正相关(<em class="jd"> 𝑥 </em>和<em class="jd"> 𝑦 </em>一起增加，<em class="jd"> 𝑟 </em> &lt; 0表示负相关(<em class="jd"> 𝑥 </em>增加，<em class="jd"> 𝑦 </em>减少)。当| <em class="jd"> 𝑟 </em> |=1时，存在完美的<em class="jd">线性</em>关系，而如果<em class="jd">𝑟</em>= 0则不存在<em class="jd">线性</em>关系(<em class="jd"> 𝑟 </em>可能无法捕捉非线性关系)。实际上，<em class="jd"> 𝑟 </em>永远不会正好为0，所以量值小的<em class="jd"> 𝑟 </em>就是“不相关”的同义词。| <em class="jd"> 𝑟 </em> |=1确实会发生，通常是当两个变量有效地描述同一现象时(例如，以米为单位的高度与以厘米为单位的高度，或者杂货账单和销售税)。</p><p id="7f1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在使用波士顿房价数据集。-波士顿房价数据集作为“玩具”数据集包含在<strong class="ih hj"> sklearn </strong>中(用于试验统计和机器学习方法)。它包括对波士顿各个地区的房价进行调查的结果，还包括一些变量，如某个地区的犯罪率、房主的年龄以及其他变量。虽然许多应用程序侧重于根据这些变量预测房价，但我只对这些变量之间的相关性感兴趣(也许这将在后面提出一个模型)。</p><p id="354e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面我加载数据集并从中创建一只熊猫<code class="du jq jr js jt b">DataFrame</code>。</p><pre class="jf jg jh ji fd ju jt jv jw aw jx bi"><span id="7e6b" class="jy jz hi jt b fi ka kb l kc kd">from sklearn.datasets import load_boston<br/>import pandas as pd<br/>from pandas import DataFrame<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="5006" class="jy jz hi jt b fi ke kb l kc kd">boston = load_boston()<br/>print(boston.DESCR)<br/>boston.data<br/>boston.feature_names<br/>boston.target<br/># adding all the features to data frame<br/>temp = DataFrame(boston.data,columns=pd.Index(boston.feature_names))<br/>boston = temp.join(DataFrame(boston.target, columns=["PRICE"]))<br/>boston # final data in dataframe formate</span></pre><p id="22c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">两个变量之间的相关性</strong></p><p id="375d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们想要两个变量之间的相关性，比如说，本地犯罪率(CRIM)和房价(price ),我们可以使用NumPy的<code class="du jq jr js jt b">corrcoef()</code>函数</p><pre class="jf jg jh ji fd ju jt jv jw aw jx bi"><span id="ac69" class="jy jz hi jt b fi ka kb l kc kd">from numpy import corrcoef</span><span id="004b" class="jy jz hi jt b fi ke kb l kc kd">boston.CRIM.as_matrix()    # As a NumPy array</span><span id="3597" class="jy jz hi jt b fi ke kb l kc kd">corrcoef(boston.CRIM.as_matrix(), boston.PRICE.as_matrix())</span><span id="7ceb" class="jy jz hi jt b fi ke kb l kc kd">output:<br/>array([[ 1.        , -0.38583169],        <br/>      [-0.38583169,  1.        ]])</span></pre><p id="13b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">非对角线条目中的数字对应于两个变量之间的相关性。在这种情况下，存在一种负相关关系，这是有道理的(更多的犯罪与更低的价格相关联)，但这种相关性只是适度的。</p><p id="5910" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">计算相关矩阵</strong></p><p id="f12e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们有几个变量时，我们可能想看看它们之间有什么相关性。我们可以计算一个<strong class="ih hj">相关矩阵</strong>，它包括数据集中不同变量之间的相关性。</p><p id="8cf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当载入一个熊猫<code class="du jq jr js jt b">DataFrame</code>时，我们可以用<code class="du jq jr js jt b">corr()</code>的方法得到相关矩阵。</p><pre class="jf jg jh ji fd ju jt jv jw aw jx bi"><span id="c9c2" class="jy jz hi jt b fi ka kb l kc kd">boston.corr()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kf"><img src="../Images/3867d59a6524c92784210359402d275e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_64uk9-yXjnpUfM2ZqJRfw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">bostan.corr()的输出</figcaption></figure><p id="1401" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然这有很多数据，但不容易阅读。让我们用热图来形象化地展示这种相关性。</p><pre class="jf jg jh ji fd ju jt jv jw aw jx bi"><span id="40f3" class="jy jz hi jt b fi ka kb l kc kd">import seaborn as sns    # Allows for easy plotting of heatmaps</span><span id="2af7" class="jy jz hi jt b fi ke kb l kc kd">sns.heatmap(boston.corr(), annot=True)<br/>plt.show()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kk"><img src="../Images/2e6a6aa264bb3adfc65c7dc7eae4d87b.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*3WbLfDw2bNwqFM3vK-EmZg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">变量间相关性热图。</figcaption></figure><p id="921f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">热图揭示了一些有趣的模式。我们可以看到</p><ul class=""><li id="97ed" class="kl km hi ih b ii ij im in iq kn iu ko iy kp jc kq kr ks kt bi translated">房价与该地区住宅的平均房间数(RM)之间有很强的正相关关系</li><li id="371e" class="kl km hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">住房价格和低收入人口比例之间存在强烈的负相关关系</li><li id="23e1" class="kl km hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">放射状高速公路(RAD)的可达性与财产税(TAX)之间存在很强的正相关关系</li><li id="b14c" class="kl km hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">波士顿氮氧化物浓度(NOX)与到主要就业区的距离成负相关</li><li id="afc7" class="kl km hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">查尔斯河变量(CHAS)和任何其他变量之间没有关系</li></ul><p id="b9ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">相关性统计检验</strong></p><p id="1107" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将了解相关性的统计检验。假设我们想要额外的保证两个变量是相关的。我们可以进行一个统计测试</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kz"><img src="../Images/5214c1c08b899271aa30b1b6547bf6d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:274/format:webp/1*_zX1mSp1ibRRN4jPmsrqLA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">相关性假设检验。</figcaption></figure><p id="f07f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(其中<em class="jd"> 𝜌 </em>是总体或“真实”相关性。)SciPy中提供了该测试。</p><pre class="jf jg jh ji fd ju jt jv jw aw jx bi"><span id="b428" class="jy jz hi jt b fi ka kb l kc kd">from scipy.stats import pearsonr</span><span id="4522" class="jy jz hi jt b fi ke kb l kc kd"># Test to see if crime rate and house prices are correlated<br/>pearsonr(boston.CRIM, boston.PRICE)</span><span id="f025" class="jy jz hi jt b fi ke kb l kc kd">OUTPUT:<br/>(-0.38583168988399053, 2.0835501108141935e-19)</span></pre><p id="bc48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">返回的元组中的第一个数字是计算的样本相关系数<em class="jd"> 𝑟 </em>，第二个数字是测试的p值。在这种情况下，存在任何非零相关性的证据是强有力的。也就是说，仅仅因为我们可以得出相关性不为零的结论，并不意味着相关性是有意义的。</p><p id="bb9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是相关性。</p><p id="b7ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你真的喜欢这篇文章——请在下面留下你的反馈和建议。</p><p id="cbe4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>