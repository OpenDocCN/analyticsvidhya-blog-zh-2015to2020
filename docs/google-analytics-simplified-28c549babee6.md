# 谷歌分析——简化！

> 原文：<https://medium.com/analytics-vidhya/google-analytics-simplified-28c549babee6?source=collection_archive---------19----------------------->

![](img/fc74e3955c06e246f509d847b91d08fa.png)

在你继续阅读之前，深呼吸，微笑！

> 由[库马尔·乌德巴夫](https://www.linkedin.com/in/kumar-udbhav-0034a2b0/)、[阿波夫·梅赫罗特拉](https://www.linkedin.com/in/apoorv-m/)、[安希卡·阿胡贾](https://www.linkedin.com/in/anshika-ahuja/)和[帕拉赫·古普塔](https://www.linkedin.com/in/palakh-gupta/)

关于数字平台上的谷歌分析已经说了很多。那为什么是这个新博客？嗯，主要是因为即使有网上的帮助，我们还是要花几周的时间来获取数据。我们意识到，博客仍有一些空间，可以“去神秘化”谷歌分析的一些内容——什么是付费的，什么是免费的，以及如何使用它来跟踪你的业务。从我们的经验中，我们试图帮助您使用模块化的代码块([可从我们的 git 这里获得](https://github.com/apoorv2210/TSE_Project))来帮助您使用 web 流量数据快速建立您的分析平台。

## 获取数据

如果你知道如何使用 google APIs，访问 GA 数据是非常简单的。如果你是一个新手或者你没有时间去学习这些代码是如何运行的，我们在这里帮助你！你所需要的只是一个 JSON 文件(来自你的网站)和我们的 ga_connect.py ( [来自我们的 git 库](https://github.com/apoorv2210/TSE_Project/tree/master/abc/packages/Service))以及一些简单的步骤

*   创建您的密钥文件“client_secret.json ”,它可以帮助您连接到 google 的核心报告 API。请点击此链接，它将引导您为您的网站生成“client_secret.json”文件。您需要有一个链接到您的网站的服务帐户。[此链接](https://developers.google.com/analytics/devguides/reporting/core/v3/quickstart/service-py)将引导您完成设置服务账户所需的步骤
*   将 client secret，ga_connect.py 与您的 Jupyter 笔记本放在同一文件夹中
*   使用这段代码建立连接并访问 GA 数据

![](img/29f9459a1e33c25727e08b678ae649bf.png)

Google 允许您下载您在 GA 仪表板上看到的任何内容。但是有一个问题！可访问数据的粒度取决于您是高级帐户持有者还是非高级帐户持有者。GA 提供高级会员资格，可以访问用户事件级别的信息，并向谷歌支付 15 万美元的年费。但是，即使对于非高级帐户，我们也几乎可以访问我们在控制面板上看到的任何内容，我们需要定义的只是时间范围、指标和维度。探索' [metrics 和 dimension explorer](https://ga-dev-tools.appspot.com/dimensions-metrics-explorer/#ga:referralPath) '以了解它。使用 get_df 函数将下载的数据直接导入到 pandas 数据框中。

![](img/4aa61ad1faf775ebf26b04147f132441.png)

## 设置您的分析平台

Google Analytics 拥有各种指标和维度的数据。我们为一个进入新市场的客户工作，他们使用他们的网站来销售他们的产品。

任何企业都可以受益于知道他们未来会有多少客户。我们再怎么强调了解这个数字所带来的好处也不为过。根据业务的类型，它可以帮助减少不同部分的不确定性，并回答诸如“我应该保持多少库存？”或者“我如何分配我的资源”——在我们的例子中是 salesforce。

虽然在我们的案例中，知道网站明天的访问者数量可能不会有太大帮助(因为网站已经启动并运行，旨在处理中等流量)，但知道未来将“注册”服务的人数可以帮助我们预测我们的需求(和许多其他事情)，从而可以回答许多重要的问题。

## 使用遗传算法预测转化率

我们致力于创建一个“**自学习时间序列预测模型**，来预测未来的入学人数。整个模型由两个独立的模型组成——季节性 ARIMA 模型和动态回归模型，后者基于季节性 ARIMA 模型来预测未来的入学人数。对于 web 流量数据，很有可能观察到用户流量的季节性(每周、每月、每年等),因此我们决定使用季节性 ARIMA 模型作为预测的第一步。我们通过**自动调整**季节性 ARIMA 模型的超参数，构建了一个“自我学习”的萨里玛模型。下面这段代码显示了如何使用我们的代码定义超参数网格来配置季节性 ARIMA 模型。

![](img/f1b5bc3d2a789e268dbe659519651713.png)

参考此[链接](https://machinelearningmastery.com/how-to-grid-search-sarima-model-hyperparameters-for-time-series-forecasting-in-python/)了解更多关于如何超调季节性 ARIMA 模型的详细信息

季节性 ARIMA 模型由需要正确配置的参数组成，以捕捉数据中的顺序、季节性和趋势。我们在网格搜索中包括了要探索的 8 个 SARIMA 参数的似是而非的值，代码返回了基于 RMSE 的最佳 3 个模型，使用了一种向前行走的验证方法。

对于时间序列预测模型，一些变量并不直接依赖于模型，但它们会以某种方式影响模型。例如，一个网站可能在工作日比周末吸引更多的流量。类似地，在一个月的开始和结束的日子里，可能会更频繁地访问一个网站——想象一个需要在每个月的开始进行支付的网站。在我们的动态回归模型中，除了上一步中的“最佳”SARIMA 模型，我们还包括了这些“外生”变量，这些变量有助于更好地预测未来的用户注册。

![](img/54795ab6a0b6e4c5e6257f0f910a63c9.png)

模型中使用的“外生”变量

![](img/e90861db40ae774e00b988472cd4aa74.png)

建立动态回归模型并生成预测

上面的代码可以用来预测任何时间序列数据。对于 SARIMA 自动调整—定义网格并以 pandas 系列对象的形式传递要预测的时间序列。外部变量的列表可以基于执行预测的环境而改变。

一旦我们知道了对未来需求的预测，了解是什么驱动了需求是非常有价值的，特别是对于一个新生的公司。GA 跟踪用户的各种属性——他们通过的渠道、年龄、性别、使用的设备等。

我们使用这些“维度”来评估不同用户属性的有效性，以回答诸如“订阅的女性多还是男性多？”或者“哪个营销活动推动了更多的转化？”，或者更广泛地说“什么对我们有用？我们的典型客户是什么样的？”。如果我们能够回答这些问题，我们就可以尝试锁定“长相相似”的潜在客户，他们更有可能注册，从而使我们的营销工作更加有效。

为了评估这些维度的重要性，我们建立了一个模型，其中我们的响应变量是一个派生指标— **、【通过率】、** (PTR)，我们使用特定日期按不同**维度划分的**、**的数量作为回归量(请参考 GA 仪表板的“受众”选项卡)—这是我们使用免费版 GA** 可以实现的**最大粒度级别。我们将 PTR 定义为当天完成注册的百分比。“良好会话”是指没有被弹开的会话数——GA 定义了一个用户根本没有与网站互动的弹性会话，而**弹回率**是弹性会话占当天总会话数的比率。对于每个维度拆分，我们将每日级别的“良好会话”数量定义为*session _ count *(1-跳出率)。*更多详情，请[点击此处查看我们的 Jupyter 笔记本。](https://github.com/apoorv2210/TSE_Project/blob/master/Dimensional%20analysis-goodSessions-21st_Nov.ipynb)**

在将所有这些放在一个模型中之前，我们以 PTR 作为目标变量为每个维度建立单独的模型，并使用 LASSO 正则化进行特征选择以减少回归变量的数量。LASSO 凭借其可解释性和收缩性，通过将非重要变量的贝塔系数驱动至 0，有助于确定显著影响响应变量和非重要变量的特征。在单个维度级别模型上运行 LASSO 帮助我们获得了一个指标列表，这些指标本身对于解释我们的 PTR 非常重要。

![](img/17a8d1e503c7335243d402862a8b0ba4.png)

每个重要活动的优秀会议示例

尽管 LASSO 有助于选择要素，但使用 RandomForest regressor 可以更好地确定交互空间中跨维度的要素重要性。参考这个[视频](https://www.youtube.com/watch?v=J4Wdy0Wc_xQ)和这个[链接](https://www.displayr.com/how-is-variable-importance-calculated-for-a-random-forest/)了解 RandomForest 是如何工作的，变量重要性是如何计算的。由于我们的指标是一天级别的 web 流量汇总，我们在报告变量重要性之前，通过处理 PTR 的滞后效应，分别考虑了数据中的自相关性。

![](img/042c1ad098f55f9cc1a8271cb59bb12a.png)

变量重要性对于不同的变量，颜色传达了对目标变量的积极或消极影响。*由于数据保密，姓名被隐藏

总之，这个简单的分析可以帮助网站所有者获得可操作的见解。通过查看我们模型中最重要的变量，可以非常容易地得出商业见解，例如，通过美国电话电报公司网络、苹果设备、任何电视/广播/印刷媒体营销活动或数字社交脸书活动获得的良好会话对我们的 PTR 产生了最积极的影响，而年龄在 35-44 岁之间的访客对我们的 PTR 产生了显著的负面影响。从这里开始，我们可以改进我们的营销工作，以**提高效果，改善问题！**

完成这个练习后，我们感觉到这些想法是多么美好地交织在一起——我们今天能够影响的，只是我们想要改善的一部分。但是，如果我们今天学会如何识别和改善这一部分，我们就能直接或间接地影响明天的整体。

我们希望你觉得这个博客有用！如果你有任何困难，请留下你的意见，我们会尽力帮助你。

干杯！