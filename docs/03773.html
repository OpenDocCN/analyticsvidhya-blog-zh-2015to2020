<html>
<head>
<title>Breaking down Network Dissection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分解网络剖析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/breaking-down-network-dissection-b4e3a6e9d5f2?source=collection_archive---------10-----------------------#2020-02-18">https://medium.com/analytics-vidhya/breaking-down-network-dissection-b4e3a6e9d5f2?source=collection_archive---------10-----------------------#2020-02-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="759b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">从麻省理工学院CSAIL有趣的论文中提炼思想:“网络剖析:量化深度视觉表征的可解释性”。</h2></div><p id="5c7e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“<a class="ae jt" href="http://netdissect.csail.mit.edu/final-network-dissection.pdf" rel="noopener ugc nofollow" target="_blank">网络剖析:量化深度视觉表征的可解释性</a>”是我最喜欢的可解释人工智能论文之一。我已经将内容浓缩成一篇简短的博文，这可能会帮助你快速理解文章中的观点。</p><h1 id="9730" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated"><strong class="ak">动机</strong></h1><p id="5fe5" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">深度学习通过在许多具有挑战性的任务中实现最先进的性能，彻底改变了计算机视觉、自然语言处理和强化学习。深层网络的一个主要缺点是它们的“黑箱”性质；很难理解这些网络是如何得到它们的输出的。麻省理工学院CSAIL的研究人员提出了一种称为“网络解剖”的技术，它提供了一个框架来描述CNN中各个卷积滤波器关注的是什么功能。</p><h1 id="d1f6" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated"><strong class="ak">网络解剖</strong></h1><p id="a878" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">要执行网络剖析，有3个步骤:</p><p id="e7d6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">第一步:识别一系列人类标记的视觉概念</strong></p><p id="a0c2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了识别一组人类标记的视觉概念，作者构建了宽密标记数据集(Broden)数据集。Broden数据集结合了几个密集标记的图像数据集:ADE [43]、开放表面[4]、Pascal-Context [19]、Pascal-Part [6]和可描述纹理数据集[7]。数据集中的每个图像都包含一个视觉概念，该视觉概念在图像内用逐像素的二进制分割图来标记。例如，如果被标记的视觉概念是汽车，那么包含汽车的所有像素被标记为1，其余的像素被标记为0。Broden数据集有63，305幅图像，包含1197个视觉概念。有6类概念:纹理、颜色、材料、零件、物体和场景。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/5fdfe91283ba37646aacfbe2f1fead6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRKTL1EtOVE2Ci1JwhGi7A.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">来自Broden数据集的示例。概念所在的像素被突出显示。图来自Bau &amp; Zhou等人2017(<a class="ae jt" href="http://netdissect.csail.mit.edu/final-network-dissection.pdf" rel="noopener ugc nofollow" target="_blank">http://net dissection . csail . MIT . edu/final-network-dissection . pdf</a>)。</figcaption></figure><p id="697c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 2。收集卷积滤波器对已知概念的响应</strong></p><p id="968b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这一步的目标是为每个卷积滤波器获得一个逐像素的二进制分割图，它告诉我们图像的哪些部分高度激活了卷积滤波器。在上一步中，所有的“已知概念”都包含在Broden数据集中。为了收集卷积滤波器对已知概念的响应，来自Broden数据集的图像被馈送到正在被剖析的CNN，并且执行向前传递。然后存储每个卷积滤波器的激活图。给定网络的输入图像，卷积滤波器的激活图就是卷积滤波器的输出。</p><p id="526d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通常，过滤器越深入CNN，激活图的尺寸越小。由于我们想要输入图像的二进制分割图，作者使用双线性插值将激活图上采样为与输入图像相同的大小。</p><p id="5167" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">激活图是实值的，但是必须转换成步骤3的二进制图。设单元k的激活图为a_k。对于每个单元k，确定最高分位数水平T_k，使得在数据集中激活图的每个空间位置上P(a_k &gt; T_k) = 0.005。为了获得二值图，激活图中值大于T_k的所有像素被标记为1，其余像素被标记为0。结果是一个二进制图，对于高度激活卷积滤波器的输入图像部分，该二进制图被标记为1。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lh"><img src="../Images/6a5329b45cf02dfa119d39965e3062ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*ED1qox7v0ckNg4Rtpv5SzA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">图来自Bau &amp; Zhou等人2017(<a class="ae jt" href="http://netdissect.csail.mit.edu/final-network-dissection.pdf" rel="noopener ugc nofollow" target="_blank">http://net dissection . csail . MIT . edu/final-network-dissection . pdf</a>)。</figcaption></figure><p id="67f0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 3。量化隐藏变量-概念对的一致性</strong></p><p id="6156" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们有了一个二进制图，它告诉我们人类标记的概念在哪里(来自步骤1)，还有一个二进制图，它告诉我们卷积滤波器在哪里被高度激活(来自步骤2)。如果卷积滤波器对于包含人类标记概念的图像区域是高度激活的，那么也许我们可以说滤波器正在“寻找”那个概念。为了量化两个二元图之间的比对，使用并集上的交集(IoU)。</p><p id="ca33" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">IoU =(二进制图都为1的像素数)/(在两个二进制图中标记为1的唯一像素数)</p><p id="528a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果二进制概念图和二进制激活图的IoU超过0.04，那么作者将产生激活图的卷积滤波器标记为标记概念的检测器。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es li"><img src="../Images/829ddead657ba016db7c53f49e626f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y9S9yn7XDg3JCJ0O0Atarw.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">图来自Bau &amp; Zhou等人2017(<a class="ae jt" href="http://netdissect.csail.mit.edu/final-network-dissection.pdf" rel="noopener ugc nofollow" target="_blank">http://net dissection . csail . MIT . edu/final-network-dissection . pdf</a>)。</figcaption></figure><p id="88ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">网络剖析和可解释性</strong></p><p id="939e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">越多的卷积过滤器与你的数据集中人类标记的概念一致，CNN就越“可解释”。这种可解释性的定义取决于有一个全面的概念数据集来比较卷积滤波器。由于Broden数据集只有1197个不同的概念，因此有许多人类可以理解的视觉概念在数据集中不存在。如果卷积过滤器与数据集中不存在的人类可理解的概念高度一致，则网络剖析的框架会将该过滤器称为不可解释的。</p><h1 id="d686" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated"><strong class="ak">实验</strong></h1><p id="9219" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">现在我们有了一个框架，可以用来将卷积过滤器标记为数据集中概念的检测器，让我们来看一些实验，看看网络剖析可以告诉我们什么。</p><p id="5138" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">量化深度视觉表征的可解释性</strong></p><p id="a9db" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本实验在ImageNet上训练的AlexNet和Places205上训练的AlexNet上进行网络解剖。对于网络的每个卷积层，绘制了通过网络剖析为6个概念类别中的每一个识别的检测器的数量。对象和纹理检测器的数量增加到更深的卷积层。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lj"><img src="../Images/2057606c3fe09b3e40d6a4f9763aa913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9B68GOg8mn4NpW7sgv8RLQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">图来自Bau &amp; Zhou等人2017(<a class="ae jt" href="http://netdissect.csail.mit.edu/final-network-dissection.pdf" rel="noopener ugc nofollow" target="_blank">http://net dissection . csail . MIT . edu/final-network-dissection . pdf</a>)。</figcaption></figure><p id="4582" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">正则化对可解释性的影响</strong></p><p id="a0a7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作者调查了随机初始化、退出或批量标准化是否对CNN的可解释性(通过网络剖析识别的检测器数量)有任何影响。随机初始化似乎不影响可解释性。没有辍学的网络，有更多的纹理检测器，但对象检测器较少。批量标准化似乎大大降低了网络的可解释性。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lk"><img src="../Images/db7de09b404d90ef9f6bf093a97aca98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UMxTknJzzZRt6xEjGHHtQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">图来自Bau &amp; Zhou等人2017(<a class="ae jt" href="http://netdissect.csail.mit.edu/final-network-dissection.pdf" rel="noopener ugc nofollow" target="_blank">http://net dissection . csail . MIT . edu/final-network-dissection . pdf</a>)。</figcaption></figure><p id="0548" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">探测器数量与历元</strong></p><p id="95c9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在该实验中，针对不同的训练迭代绘制了检测器的数量。随着训练过程的继续，探测器的数量大幅度增加。在下图中，在红色虚线之后，随着网络开始过度拟合，可解释性下降。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lk"><img src="../Images/945ca3e35f5ae39a008db69c3f827cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XQZaNBurZxAHOCDRwTix5g.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">图来自Bau &amp; Zhou等人2017(<a class="ae jt" href="http://netdissect.csail.mit.edu/final-network-dissection.pdf" rel="noopener ugc nofollow" target="_blank">http://net dissection . csail . MIT . edu/final-network-dissection . pdf</a>)。</figcaption></figure><h1 id="5a2d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated"><strong class="ak">结论</strong></h1><p id="cf4b" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">网络剖析是一个有用的框架，可以自动量化CNN的可解释性。我希望这篇文章已经帮助您理解了网络剖析是如何工作的。感谢阅读！</p></div></div>    
</body>
</html>