<html>
<head>
<title>Recognizing over 50 Candlestick Patterns with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python识别50多种烛台图案</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/recognizing-over-50-candlestick-patterns-with-python-4f02a1822cb5?source=collection_archive---------0-----------------------#2020-02-11">https://medium.com/analytics-vidhya/recognizing-over-50-candlestick-patterns-with-python-4f02a1822cb5?source=collection_archive---------0-----------------------#2020-02-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="59f4" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一个易于遵循的指南，为ML利用烛台模式</h2></div><p id="270d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现场实施可在<a class="ae jt" href="http://www.cryptodashapp.com" rel="noopener ugc nofollow" target="_blank">www.cryptodashapp.com</a>找到</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/43ba05abaea88077605c5903f88227ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hT02y5LBTnqzz7FFdpNwTQ.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated"><a class="ae jt" href="http://www.distel.co" rel="noopener ugc nofollow" target="_blank">形象信用</a>。照片由<a class="ae jt" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">奥斯汀·迪斯特尔</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="715b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi kk translated">在做交易决策时，我们可以利用几种不同的信息来源进行技术分析。其中一个来源是OHLC(开盘、盘高、盘低、收盘)数据。可以绘制蜡烛图，从任何可交易工具的OHLC数据中提取模式。</p><blockquote class="kt ku kv"><p id="7e6e" class="ix iy kw iz b ja jb ij jc jd je im jf kx jh ji jj ky jl jm jn kz jp jq jr js hb bi translated">烛台模式是一种在烛台图表上显示的价格运动，一些人认为它可以预测特定的市场运动。</p></blockquote><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es la"><img src="../Images/8c2436be7cffe5028f9b4e1ab1231077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2F_NRcXgAuSUXhDZ1bEwg.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated"><a class="ae jt" href="https://www.ig.com/au/trading-strategies/candlestick-trading-explained-181218" rel="noopener ugc nofollow" target="_blank">图像信用</a></figcaption></figure><p id="80db" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">简单和复杂的烛台图案的完整列表以及视觉示例可以在这篇维基百科文章中找到。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="0057" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">烛台模式是训练机器学习模型以试图预测未来价格的绝佳候选模式。<strong class="iz hj">在本文中，我们将回顾使用烛台模式创建预测器的特征工程步骤，然后可视化我们的结果。</strong>我们将使用python、TA-Lib模块和来自<a class="ae jt" href="http://www.thepatternsite.com" rel="noopener ugc nofollow" target="_blank">www.thepatternsite.com</a>的性能排名</p><p id="92b0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该过程的三个步骤是:</p><ol class=""><li id="280d" class="li lj hi iz b ja jb jd je jg lk jk ll jo lm js ln lo lp lq bi translated"><em class="kw">使用TA-Lib提取模式</em></li><li id="c949" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated"><em class="kw">使用</em> <a class="ae jt" href="www.thepatternsite.com" rel="noopener ugc nofollow" target="_blank"> <em class="kw">模式站点</em> </a>中的“总体绩效等级”对模式进行分级</li><li id="bf32" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated"><em class="kw">挑选最佳性能蜡烛</em></li></ol></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h2 id="edb3" class="lw lx hi bd ly lz ma mb mc md me mf mg jg mh mi mj jk mk ml mm jo mn mo mp mq bi translated"><em class="mr">使用TA-Lib提取模式</em></h2><p id="6fbd" class="pw-post-body-paragraph ix iy hi iz b ja ms ij jc jd mt im jf jg mu ji jj jk mv jm jn jo mw jq jr js hb bi translated">有了TA-Lib，提取模式超级简单。我们可以从安装来自https://github.com/mrjbq7/ta-lib的模块开始。该存储库包含易于遵循的安装过程说明。</p><p id="1f06" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">安装完成后，我们开始导入模块:</p><pre class="jv jw jx jy fd mx my mz na aw nb bi"><span id="8a4e" class="lw lx hi my b fi nc nd l ne nf">import talib</span></pre><p id="2c0f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们通过运行以下命令获得可用模式的列表:</p><pre class="jv jw jx jy fd mx my mz na aw nb bi"><span id="cfe8" class="lw lx hi my b fi nc nd l ne nf">candle_names = talib.get_function_groups()['Pattern Recognition']</span></pre><p id="dea2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“candle_names”列表应该如下所示:</p><pre class="jv jw jx jy fd mx my mz na aw nb bi"><span id="f1d1" class="lw lx hi my b fi nc nd l ne nf">candle_names = [<br/>    'CDL2CROWS',<br/>    'CDL3BLACKCROWS',<br/>    'CDL3INSIDE',<br/>    'CDL3LINESTRIKE',<br/>    .<br/>    .<br/>    .<br/>]</span></pre><p id="d8cc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们准备提取蜡烛！我们只需要一个带有<em class="kw">开盘、盘高、盘低、收盘</em>值的样本数据集。</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="ng nh l"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">样本比特币数据集准备</figcaption></figure><p id="29bb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">瞧啊。比特币数据集准备好了。让我们提取OHLC数据并创建模式列。</p><pre class="jv jw jx jy fd mx my mz na aw nb bi"><span id="3615" class="lw lx hi my b fi nc nd l ne nf"># extract OHLC <br/>op = df['open']<br/>hi = df['high']<br/>lo = df['low']<br/>cl = df['close']</span><span id="df28" class="lw lx hi my b fi ni nd l ne nf"># create columns for each pattern<br/>for candle in candle_names:<br/>    # below is same as;<br/>    # df["CDL3LINESTRIKE"] = talib.CDL3LINESTRIKE(op, hi, lo, cl)<br/>    df[candle] = getattr(talib, candle)(op, hi, lo, cl)</span></pre><blockquote class="kt ku kv"><p id="c3ef" class="ix iy kw iz b ja jb ij jc jd je im jf kx jh ji jj ky jl jm jn kz jp jq jr js hb bi translated">TA-Lib为每个模式创建单独的列。0表示没有形态，正值表示看涨形态，负值表示看跌形态。</p></blockquote><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es nj"><img src="../Images/4055339f28a08345a464dc74afdfe3c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*biwiFYyuQOLGVpEZVp8Zug.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">比特币数据中发现的烛台图案</figcaption></figure><p id="489b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">恭喜你！我们刚刚获得了第一个包含算法提取模式的数据集。</p><h2 id="bff4" class="lw lx hi bd ly lz ma mb mc md me mf mg jg mh mi mj jk mk ml mm jo mn mo mp mq bi translated"><em class="mr">排列模式</em></h2><p id="e9d0" class="pw-post-body-paragraph ix iy hi iz b ja ms ij jc jd mt im jf jg mu ji jj jk mv jm jn jo mw jq jr js hb bi translated">我们使用TA-Lib成功地提取了烛台模式。通过几行代码，我们可以将这种稀疏的信息压缩到一个带有模式标签的列中。但是首先，我们需要处理对于给定的蜡烛发现多个模式的情况。为此，我们需要一个性能指标来比较模式。我们将使用 <a class="ae jt" href="http://thepatternsite.com/" rel="noopener ugc nofollow" target="_blank">模式站点</a>中的<em class="kw">“总体绩效等级”。</em></p><pre class="jv jw jx jy fd mx my mz na aw nb bi"><span id="bd83" class="lw lx hi my b fi nc nd l ne nf">candle_rankings = {<br/>    "CDL3LINESTRIKE_Bull": 1,<br/>    "CDL3LINESTRIKE_Bear": 2,<br/>    "CDL3BLACKCROWS_Bull": 3,<br/>    "CDL3BLACKCROWS_Bear": 3,<br/>    "CDLEVENINGSTAR_Bull": 4,<br/>    "CDLEVENINGSTAR_Bear": 4,<br/>    "CDLTASUKIGAP_Bull": 5,<br/>    "CDLTASUKIGAP_Bear": 5,<br/>    .<br/>    .<br/>    .<br/>    .<br/>}</span></pre><p id="435a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">经过一些手工抓取后，这些模式被组合在“candle_rankings”字典中。当存在多个模式时，我们将使用上述字典中的值来决定最佳性能模式。模式的完整字典以及命名和排序决定的解释可以在<a class="ae jt" href="https://github.com/CanerIrfanoglu/medium/blob/master/candle_stick_recognition/candle_rankings.py" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="fda4" class="lw lx hi bd ly lz ma mb mc md me mf mg jg mh mi mj jk mk ml mm jo mn mo mp mq bi translated">挑选性能最佳的蜡烛</h2><p id="035e" class="pw-post-body-paragraph ix iy hi iz b ja ms ij jc jd mt im jf jg mu ji jj jk mv jm jn jo mw jq jr js hb bi translated">有趣的部分来了。我们将编写创建标签的逻辑代码。我们基本上有三个案例。</p><ul class=""><li id="c3f5" class="li lj hi iz b ja jb jd je jg lk jk ll jo lm js nk lo lp lq bi translated"><strong class="iz hj">无模式</strong>:用“无模式”填充单元格</li><li id="dd74" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js nk lo lp lq bi translated"><strong class="iz hj">单一图案</strong>:用图案名称填充单元格</li><li id="4c82" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js nk lo lp lq bi translated"><strong class="iz hj">多模式</strong>:用排名最低(最好)的模式名填充单元格</li></ul><p id="f03c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是创建模式标签和发现模式计数的代码。</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="ng nh l"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">为每根蜡烛挑选最佳模式的逻辑</figcaption></figure><h2 id="5236" class="lw lx hi bd ly lz ma mb mc md me mf mg jg mh mi mj jk mk ml mm jo mn mo mp mq bi translated">可视化和验证结果</h2><p id="4076" class="pw-post-body-paragraph ix iy hi iz b ja ms ij jc jd mt im jf jg mu ji jj jk mv jm jn jo mw jq jr js hb bi translated">到目前为止，我们使用TA-Lib提取了许多烛台模式(截至2020年2月支持61种模式)。我们根据<em class="kw">“总体性能等级”</em>对它们进行了分级，并为每根蜡烛选择了最佳性能模式。接下来，我们可以通过绘制蜡烛来验证我们的结果，并根据找到的模式进行视觉检查。下面是一个使用Plotly可视化数据的示例脚本。数据集和图可以并排比较，通过匹配索引可以轻松验证模式。</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="ng nh l"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">代码plotly可视化烛台</figcaption></figure><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es nl"><img src="../Images/47141e2e0025a19950617cb9a7955f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EuVg2xyFo8Z3982eQc2LJw.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">使用plotly的比特币数据蜡烛图</figcaption></figure><p id="e565" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可能会发现这个<a class="ae jt" href="https://public.tableau.com/profile/caner.irfanoglu#!/vizhome/BtcCandlestickPatterns/Sheet1" rel="noopener ugc nofollow" target="_blank">表格(即</a>表格)更便于快速检查带有注释的图案。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es nm"><img src="../Images/7d5190d4d300dfbaabd4fc79174cef50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SuRgvMvaNzyo1hBAooXEEA.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">比特币数据的<a class="ae jt" href="https://public.tableau.com/profile/caner.irfanoglu#!/vizhome/BtcCandlestickPatterns/Sheet1" rel="noopener ugc nofollow" target="_blank"> Tableau即</a></figcaption></figure><p id="f494" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当在我们的数据集上找到的模式与实际模式进行比较时，结果看起来是一致的。作为未来工作的一部分，我们可以在更大的数据集上进行测试。此外，由于一些模式只有一个版本，因此可以从其中删除“牛”和“熊”标签。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="b920" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本帖所有脚本和内容，包括<em class="kw">识别_烛台</em>功能，均可在【https://github.com/CanerIrfanoglu/medium】的<a class="ae jt" href="https://github.com/CanerIrfanoglu/medium" rel="noopener ugc nofollow" target="_blank">找到。</a></p><p id="cbf6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在https://youtu.be/HS3gAmtET9k?t=121<a class="ae jt" href="https://youtu.be/HS3gAmtET9k?t=121" rel="noopener ugc nofollow" target="_blank"/>您还可以看到烛台识别作为加密货币技术分析仪表板“加密仪表板”的一部分。</p><p id="dd6e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里的内容主要基于TA-Lib模块的创建者的工作和Thomas Bulkowsi对烛台模式的长期研究。我要感谢他们公开他们的作品。</p><p id="edd5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你喜欢或发现我的工作有价值，请确保保持同步，并随时在<a class="ae jt" href="https://www.linkedin.com/in/caner-irfanoglu-6868b077/" rel="noopener ugc nofollow" target="_blank"> linkedin </a>上联系。我很高兴听到你的意见和建议。干杯！</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h2 id="4273" class="lw lx hi bd ly lz ma mb mc md me mf mg jg mh mi mj jk mk ml mm jo mn mo mp mq bi translated">参考</h2><p id="849c" class="pw-post-body-paragraph ix iy hi iz b ja ms ij jc jd mt im jf jg mu ji jj jk mv jm jn jo mw jq jr js hb bi translated">[1]烛台图案。(未注明)。在<em class="kw">维基百科</em>里。2020年2月11日从https://en.wikipedia.org/wiki/Candlestick_pattern<a class="ae jt" href="https://en.wikipedia.org/wiki/Candlestick_pattern" rel="noopener ugc nofollow" target="_blank">检索</a></p></div></div>    
</body>
</html>