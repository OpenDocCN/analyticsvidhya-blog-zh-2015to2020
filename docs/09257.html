<html>
<head>
<title>Characterising companies based on financial metrics during covid19</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">covid19期间根据财务指标描述公司特征</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/characterising-companies-based-on-financial-metrics-during-covid19-1a6ce9cc4ada?source=collection_archive---------14-----------------------#2020-08-30">https://medium.com/analytics-vidhya/characterising-companies-based-on-financial-metrics-during-covid19-1a6ce9cc4ada?source=collection_archive---------14-----------------------#2020-08-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/f413427f674a4c11d75421f28ad2e64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKpPLqiIu7cCt1GRDdImow.png"/></div></div></figure><div class=""/><blockquote class="iq ir is"><p id="6a78" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">注:所有代码均可在回购中获得:<a class="ae js" href="https://quanp.readthedocs.io/en/latest/tutorials.html" rel="noopener ugc nofollow" target="_blank">https://quanp.readthedocs.io/en/latest/tutorials.html</a></p></blockquote><p id="6610" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">2020年8月，作者开始演示在商业和金融界采用单细胞基因组分析(SCGA)。SCGA具有大量的特征(高达56k基因/特征),并且通常已知在高背景中具有低信号。在这里，作者试图根据基本财务指标描述covid19期间标准普尔500公司的特征。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="4970" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我们知道<strong class="iw hu">标准&amp;普尔500 </strong>，或者简称为<strong class="iw hu">S&amp;p500</strong>，是一个<strong class="iw hu"> <em class="iv">股市指数</em> </strong>，衡量在美国<strong class="iw hu">证券交易所</strong>上市的<em class="iv"/>500家大公司<strong class="iw hu">的股票表现。它是最受关注的股票指数之一，许多人认为它是美国股票市场的最佳代表之一。这也使得一个合理的好的和充分的股票宇宙挑选一些好的公司来形成一个基于我们定义的<a class="ae js" href="https://www.investopedia.com/articles/investing/092115/alpha-and-beta-beginners.asp#:~:text=Alpha%2C%20one%20of%20the%20most,%25%2C%20the%20alpha%20is%2015." rel="noopener ugc nofollow" target="_blank"> Alpha </a>的投资组合。</strong></p><blockquote class="kd"><p id="fb35" class="ke kf ht bd kg kh ki kj kk kl km jr dx translated"><strong class="ak">在新冠肺炎封锁期</strong>，我们了解到<strong class="ak">拥有强大自由现金流和低短期债务(即&lt; 1年期债务)的公司将有可能在</strong>度过疫情封锁期。<a class="ae js" href="https://www.investopedia.com/terms/f/freecashflow.asp" rel="noopener ugc nofollow" target="_blank"><strong class="ak"/></a><strong class="ak">【FCF】</strong>自由现金流量通常被定义为净经营现金流量减去资本支出。另一方面，流动比率和/或速动比率是评估公司短期债务的良好指标。</p></blockquote></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="f263" class="kn ko ht bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">1.下载数据</h1><p id="fbb3" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">在这里，我们获得了维基百科上列出的505家S&amp;P500成员公司&amp;从TD Ameritrade API获得了每家公司的基本指标列表(所有函数都可以从<a class="ae js" href="https://github.com/hkailee/quanp" rel="noopener ugc nofollow" target="_blank"> quanp </a>工具中获得)。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lq"><img src="../Images/a057fabe79b63eb48af5968afe981d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jWRUvKf3SSsNwGhmrkWVOg.png"/></div></div></figure><p id="62cd" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">潜在有用的基础/特性列表如下:-</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lv"><img src="../Images/a0316c12418f3ea6c408a87550913fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N32OrgUd5muLYqTzDSqXkg.png"/></div></div></figure><h1 id="0274" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">2.简单特征预处理</h1><p id="c656" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">因子分析/主成分分析的变量分布无效。然而，如果变量呈正态分布，分析结果通常会得到增强(Tabachnick &amp; Fidell，2013)。这里，我们只做2个简单和标准的预处理，log(x+1)变换，然后是<a class="ae js" href="https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/" rel="noopener ugc nofollow" target="_blank">标准化</a>缩放。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mb"><img src="../Images/b8f614a3fe73c792c8df0129b23fca5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLUA5Uuv0V1lll5w1pLfsA.png"/></div></div></figure><h1 id="8aa4" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">3.使用主成分分析进行降维</h1><p id="bf62" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">我们通过运行主成分分析来降低数据的维度，它揭示了变化的主轴并对数据进行降噪。在这里，我们使用前两个主成分(PCs)坐标绘制散点图，并尝试查看这两个主成分是否可以很好地区分公司的GICS部门。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mc"><img src="../Images/111c2e87320f2d9c358d50b5a72c1ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVhdT-qSIgv9njtIsv42qw.png"/></div></div></figure><p id="1e4d" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">例如，信息技术、金融和能源部门的公司似乎可以从低到高的PC1中分离出来。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es md"><img src="../Images/1fd187ec2f412993c96292d3d98d5c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yffvc_9GV_ahxyIeROSvWg.png"/></div></div></figure><p id="c520" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在，让我们检查单台电脑对数据总方差的贡献。这为我们提供了关于我们应该考虑多少个PC以计算单元的邻域关系的信息，例如在聚类函数<code class="du me mf mg mh b">qp.tl.leiden()</code>、<code class="du me mf mg mh b">qp.tl.louvain()</code>或<code class="du me mf mg mh b">tSNE qp.tl.tsne()</code>中使用的信息。根据我们的经验，通常粗略估计一下电脑的数量就可以了。“肘”点似乎表明，至少高达PC5将是有用的公司特征。我们将在后面的前8个的基础上做进一步的降维。稍后，我们将在单独的教程笔记本<a class="ae js" href="https://link.medium.com/aV5mepSA09" rel="noopener">中进行因素分析，以检查构成这些电脑的潜在特性。</a></p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mi"><img src="../Images/8f4f2a39c91dd5ed0704d0d6f8c0bac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAKkxhClrOp4T3lhPkopYw.png"/></div></div><figcaption class="mj mk et er es ml mm bd b be z dx translated">肘点出现在前5根之间。</figcaption></figure><h1 id="071e" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">4.计算邻域图</h1><p id="4e93" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">在我们查看带有部门注释的tSNE图之前，让我们使用数据矩阵的PCA表示来计算公司的邻域图。这将增加每个公司之间的距离和联系。这里，我们考虑10个最近的邻居，其中8个来自PCA。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mn"><img src="../Images/a50847a8cd482d9a8ac790136683989c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nSHw7LESNxoxOaSwXcouDA.png"/></div></div></figure><h1 id="348f" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">5.聚类邻域图</h1><p id="6766" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">这里，我们使用Traag <em class="iv">等人</em> (2018)的莱顿图聚类方法(基于优化模块性的社区检测)对公司的邻域图进行聚类，我们已经在上一节中计算过了。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/7f346c4fcb2114e4d86b6a33cc13679b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BCWwyqphbPJ-fxHFhs4RA.png"/></div></div></figure><h1 id="751e" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">6.基于T分布随机近邻嵌入的进一步降维</h1><p id="5dba" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">让我们使用实施为<code class="du me mf mg mh b">qp.tl.tsne(adata, n_pcs=8)</code>的tSNE工具，进一步将以上确定的8个可能重要的PC的维度降低到2维。我们现在可以在tsne图上绘制和查看莱顿聚类、GICS部门或任何财务指标/特征的注释。我们看到莱顿集团3似乎很好地符合金融部门，它的特点是低电流。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lv"><img src="../Images/36bdfa91bdf27f0a8c2dc3e51b964a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MLaumFrtUvW1oX10rzrDA.png"/></div></div></figure><h1 id="ea1f" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">7.使用均匀流形近似和投影(UMAP)的进一步备选降维</h1><p id="2778" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">我们还可以使用UMAP(麦金尼斯等人，2018年)将邻域图嵌入到二维中，见下文。它可能比tSNE更忠实于流形的全局连通性。在运行UMAP之前，我们计算集群之间的相关性作为UMAP的初始位置。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/c0896aee578f8d14a894e18b70ea0c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*waW824CnjBxmh_SYxcteiQ.png"/></div></div></figure><p id="6f0d" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我们现在可以在UMAP图上绘制和查看莱顿聚类、GICS部门或任何财务指标/特征的注释。我们看到，莱顿集团3似乎对应良好的金融部门，主要特点是高周转率和速动比率。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mq"><img src="../Images/bc9ec5883125571ab77e45fdfbcac93e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gMyiA9vp1XAy6oVVhIfAmg.png"/></div></div></figure><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mr"><img src="../Images/0c6dca189d3707a026d1f16cac92b095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emKAIN0J8ghs8x_hHj-67Q.png"/></div></div></figure><h1 id="a114" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">8.分层聚类</h1><p id="9112" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">我们可以运行<code class="du me mf mg mh b">qp.tl.dendrogram</code>来计算所有识别出的集群的层次聚类。这里使用了默认的距离方法—欧几里德距离。多个可视化，然后可以包括一个树状图:<code class="du me mf mg mh b">qp.pl.matrixplot</code>、<code class="du me mf mg mh b">qp.pl.heatmap</code>、<code class="du me mf mg mh b">qp.pl.dotplot</code>和<code class="du me mf mg mh b">qp.pl.stacked_violin</code>。这里显示了热图和矩阵图的示例。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ms"><img src="../Images/b6bb5a7a95c7e19cbf4e13c194469d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J2orUW1R60wHOGGz9_C4XA.png"/></div></div><figcaption class="mj mk et er es ml mm bd b be z dx translated">热图图</figcaption></figure><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mt"><img src="../Images/991d373b97a29e0cf880fbaf9129e71d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L4K8jdRSdLDUiRba-BYJhw.png"/></div></div><figcaption class="mj mk et er es ml mm bd b be z dx translated">矩阵图</figcaption></figure><h1 id="186a" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">9.对定义每个集群的重要特征进行排序和可视化</h1><p id="117c" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">我们可以识别不同地表征每个聚类的特征/度量，而不是像以前那样查看聚类的所有特征。例如，我们可以看到聚类3(主要由金融公司组成，如下所示)与较高的股息收益率、operatingMarginTTM、netProfitMarginTTM、epsTTM和netProfitMarginMRQ显著相关。但较低的grossMarginTTM、grossMarginMRQ、currentRatio、quickRatio、totalCapitalToDebt等。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mu"><img src="../Images/d423aae3afc32c8b46d8bfee41875f02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LD1JKbAu227nnQDT4X-OkQ.png"/></div></div></figure><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mv"><img src="../Images/c34ca5d34f9bc4de2eddd47a79e3702a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4f7X134xKHi5peaajOE6HA.png"/></div></div></figure><h1 id="ce49" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">10.使用matrixplot可视化5大积极特征</h1><p id="cf42" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">结合上面的特征排名图，我们发现与集群1公司相关的前5个积极特征是currentRatio、quickRatio、returnOnEquity、dividendYield和pbRatio。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mw"><img src="../Images/b57a136505c66e0a24e98472e334a4d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwdc6kfSAK681x6id1yQKw.png"/></div></div></figure><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/f413427f674a4c11d75421f28ad2e64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKpPLqiIu7cCt1GRDdImow.png"/></div></div></figure><p id="c7f6" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">最后，我们可以交叉列表的莱顿和GICS _部门，以检查部门和莱顿定义之间的相关性。在这里，我们发现集群3的公司与金融行业的公司高度相关，集群6主要是房地产行业的公司。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mx"><img src="../Images/a1ce11239898e83fd6d69df6a7fb16fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LqNwX78829WBVxjXsqBDw.png"/></div></div></figure><h1 id="fb62" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">结论:-</h1><p id="b0b8" class="pw-post-body-paragraph it iu ht iw b ix ll iz ja jb lm jd je jt ln jh ji ju lo jl jm jv lp jp jq jr hb bi translated">在本教程中，我们发现聚类3(主要由金融行业公司组成)与较高的股息收益率、operatingMarginTTM、netProfitMarginTTM、epsTTM和netProfitMarginMRQ显著相关。但较低的grossMarginTTM、grossMarginMRQ、currentRatio、quickRatio、totalCapitalToDebt等。另一方面，第1类公司与高流动比率、速动比率、回报率、股息收益率和pbRatio相关。</p><p id="0b42" class="pw-post-body-paragraph it iu ht iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">但是，应该注意的是，在此COVID19期间，当金融公司等公司的流动/速动比率较低时，它们可能不会像材料/工业公司那样脆弱。当比较行业内的公司时，具有高流动/速动比率的公司——尤其是那些列在第1类的公司——可能具有更高的生存优势。</p><h1 id="ced6" class="kn ko ht bd kp kq lw ks kt ku lx kw kx ky ly la lb lc lz le lf lg ma li lj lk bi translated">参考资料:</h1><blockquote class="iq ir is"><p id="8e00" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://quanp.readthedocs.io/en/latest/tutorials.html" rel="noopener ugc nofollow" target="_blank">https://quanp.readthedocs.io/en/latest/tutorials.html</a></p></blockquote></div></div>    
</body>
</html>