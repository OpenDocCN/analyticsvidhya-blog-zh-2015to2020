# 重塑 P 值(第 1 部分)

> 原文：<https://medium.com/analytics-vidhya/reinventing-p-values-part-1-8ea13348aa57?source=collection_archive---------18----------------------->

## 为什么以及如何发明 p 值。

P 值在已发表的研究中被广泛使用，但是很少有人，包括专家，正确理解什么是 P 值。由于缺乏对 p 值的理解，实验结果经常被曲解。不仅如此，对 p 值的过度依赖还被用来捏造实验，以夸大实验结果的惊人程度，这就是所谓的 p 黑客行为。

*在这篇文章中，我们将会看到 p 值并不是那么难以理解，相反，是缺乏好的解释让它们看起来如此。事实上，我们将使用像频率和机会这样的简单概念来重新发明 p 值。*

**为了理解 p 值，我们需要理解分布的概念，为了理解分布，我们需要理解直方图。不过，理解直方图只需要小学教授的基本计数。让我们从直方图开始。**

> **注:**如果您已经熟悉不同类型的直方图:**频率、频率密度、概率和概率密度**，请随意阅读介绍 P 值的章节**和回顾 P 值的章节**。****

## ****计数和直方图****

**直方图用于维护一些数量的计数。例如，假设你去了一个街区，数了每所房子的卧室数量。最初，你对卧室的数量一无所知。假设你去的第一所房子有两间卧室，你记下**【2】**。下一栋房子可能有 4 间卧室，现在你的条目应该是**【2，4】**。由于大多数房子只有少量的卧室，当你调查完所有的房子后，你会有一个长长的单子，上面有很多小数字..】。这个列表可能会很长，但它并不能告诉你房间的数量。**

**总结这个列表最简单的方法是计算列表中数字的出现次数。假设您这样做了，发现数字 **1** 出现了 38 次， **2** 出现了 566 次，依此类推，您可以将此摘要记录在如下表格中:**

**![](img/3ff88e67ef2e9817046e0c1024b5bb33.png)**

**房间数量汇总**

**当绘制时，该摘要成为直方图。**

**![](img/92dfba9a5e40528092f59fc8cf01e56b.png)**

**房间数量的典型直方图**

**在这种情况下，数量是一所房子中卧室的数量，绘制在 ***x-*** 轴上。 ***y-*** 轴代表有那么多卧室的房子数量，这是我们统计的。**

**直方图提供的第一个有用信息是房间数量的跨度。在这种情况下，每个房子有 1 到 7 个房间。我们怎么知道？因为它们的数量很小，但不为零，但少于一间卧室的房屋数量为零，多于七间卧室的房屋数量也为零。**

**第二位信息是计数。因此，大约 2000 栋房子有 3 间卧室，而只有 400 栋房子有 5 间卧室。统计学家喜欢将这些计数称为*，这是有道理的，因为 ***y* -** 轴告诉你遇到一居室、两居室或 k 居室房子的频率。从直方图来看，三居室的房屋比五居室的房屋多 5 倍(2000/400)。***

***第三位信息是计数的总和，等于被调查房屋的总数。***

> ***频率的总和就是房屋的总数。***

## ***机会和概率***

***因为三居室的房子是最常见的，如果一个人随意挑选一个房子，它更有可能是一个三居室的房子，而不是一个两居室的房子。任意选择的房子有 3 个卧室的概率可以通过 3 个卧室的房子的频率与所有频率之和的比值来计算，结果是 2032/(38+566+2032+1531+353+61+14)= 2032/4595，大约是 0.442。任意一栋房子是 5 居室的概率可以计算为 353/4595 = 0.077。这些比率被称为 ***概率。******

***下表包含了与之前计算的频率相对应的所有概率。注意，最大频率对应最大概率，第二大频率对应第二大概率，依此类推。这是必然会发生的，因为分母或频率之和在所有比率中都是相同的，所以分子，即频率，决定了比率的大小。***

***![](img/5973194c07277b47af01db17dae768e6.png)***

> ***概率总和为 1。你能看出为什么吗？这是一个很好的属性，我们以后会用到。***

***我们现在可以用 y 轴*-上的概率绘制一个新的直方图，而 x 轴*-保持不变。*****

*****![](img/a0f3110e8bbc79944e849c8be5e74dd2.png)*****

*****为什么我们需要概率？为什么我们不用频率呢？因为概率让我们比较机会。如果我们调查另一个社区，它有 1200 套三居室的房子，我们如何确定在这两个社区中哪一个三居室公寓更常见？如果另一个社区有 5000 栋房子，我们可以比较新社区有 3 间卧室的房子的概率(=1200/5000)和这个社区有 3 间卧室的房子的概率(=2032/4595)*****

## *****没有直方图能在与现实世界的接触中幸存*****

*****好吧，让我们想想现实世界。除非你有一大群人在调查房屋，或者你唯一的生活目标是绘制 4595 栋房屋的直方图，或者有人已经收集了数据，否则调查所有房屋并构建第一个直方图是一项任务，其中**频率**在 ***y-*** 轴上。您仍然可以构建第二个直方图，y 轴上是**概率**。你可以这样做的估计。下面是评估的工作原理:*****

*   ****根据你的时间和预算，你可以决定调查多少房子。让我们假设一个像 130 这样的小数字。****
*   ****你**随机**选择，也许是在地图上，那 130 栋房子。这在统计学上叫做**抽样**。****

****我们之所以要随机，是为了消除数据中的任何模式。例如，如果你只选择了离你最近的 130 套房子，而你生活在一个以两居室公寓为主的住宅社区，你很可能**错误地**报告说两居室公寓是整个社区中最常见的。有许多随机抽样的方法，但我们不想在这里深入讨论这些细节。****

> ****随机抽样确保样本能够代表被抽样的数据。****

****使用采样进行估计将无法为您提供实际的频率。如果你正在做的事情需要那些实际的频率，除了收集所有的数据没有别的选择。然而，需要找到实际频率的任务很少，通常由有能力这样做的组织或机构来完成。例如，世界各国政府进行的人口普查。幸运的是，许多任务需要可以从样本中很好估计的概率，因为一个好的样本将保持实际频率的比例。****

> ****虽然样本不包含与整个数据相同的频率，但一个好的样本会以大致相同的因子缩小每个频率，因此频率的比例保持大致相同。****

## ****通过采样构建直方图****

****假设你根据 130 所房子的随机样本绘制了卧室数量的直方图。下面是它可能的样子:****

****![](img/65c0e82ed5ece9b3300f6d39311262b5.png)****

****130 间房屋样本的卧室直方图****

****请注意，房屋的数量 130 大约比实际房屋数量小 35(=4595/130)倍，因此频率都是按相同的比率进行**粗略**缩放的。例如，三居室的数量在 60 左右，大约小 34(=2032/60)倍，非常接近我们预期的 35 倍。现在让我们画出根据样本计算出的概率直方图。为了比较这个直方图，我们把它画在原始直方图旁边。****

****![](img/300ce263637ca9707e676bea4e279009.png)********![](img/7b3bb748a9acf27ec81c16dc06fb1340.png)****

****左图:原始概率直方图。右图:基于样本大小为 130 的概率直方图****

****概率看起来非常相似，似乎我们可以使用新的直方图来代替完整的直方图，但有一个问题！我们新的柱状图中没有 7 间卧室的房子。我们知道它们只有 14 个，在一个 35 倍的小样本中，尽管是随机选择的，也可能没有一个被包括在内。在下一节中，我们将看到如何处理丢失的卧室！****

## ****处理丢失的卧室(数据)！****

****那么，我们如何处理缺失数据，例如，我们从一个小样本构建的直方图中的 7 居室公寓？在现实世界中，我们永远无法获得更大的数据来告诉我们 7 间卧室的房子也存在。我们如何“校正”从采样数据中构建的概率直方图？在我们谈论它之前，请注意，虽然在这种情况下，丢失的数据在最右边，但不一定总是这样。如果五居室房屋的出现频率很小，我们可能最终也会丢失五居室房屋的数据。****

****我们不会深究如何修复丢失数据的细节，但简单来说，丢失的数据可以通过一点欺骗来填充。我们将现有数据的概率减少一点，分配给 0 房和 7 房的房子。下面是典型的“校正”直方图的样子:****

****![](img/7b3bb748a9acf27ec81c16dc06fb1340.png)********![](img/ce83ec472c247d9513a5afc8c0d49ade.png)****

****左图:根据 130 栋房屋的样本构建的直方图。右图:0 号和 7 号卧室数据“校正”后的直方图相同。请注意，y 轴刻度不同。****

****请注意，现有数据的概率有所降低，有些不均衡，被盗的概率被分配给了新数据。这里不讨论重新分配的本质，但可以说分配是基于趋势的。因此，0 卧室的房子应该比 1 卧室的房子获得的概率低，7 卧室的公寓应该比 6 卧室的公寓获得的概率低，因为我们知道概率在两端都变小了。****

****如果您想知道通过引入未知数据(0，7 间卧室的房子)来故意扭曲直方图是否是一个好主意，请考虑这样一种情况:有人问您找到 7 间卧室的房子的概率，而您无法回答他们，因为您的样本没有 7 间卧室的房子。有可能实际上在附近没有 7 间卧室的房子，但是也有可能除了你的房子之外有这样的房子****

****但是为什么只停留在 0 和 7 卧室呢？没有少于 0 间卧室的房子，但是有 8 间或更多的卧室呢？请记住，我们只能访问样本，我们不知道整个数据是否会有这些类型的房子。我们可以把概率涂掉一些，以包括更多的卧室数量，但新的概率也必须保持更小。所以我们可能会给一个有 10 间卧室的房子分配一个 0.0001 的概率，这个概率非常小，如果我们愿意，我们可以用 0 来代替它，或者我们可以一直这样下去。****

> ****无论我们如何“校正”直方图，概率总和必须为 1。****

## ****引入 P 值****

****根据你对直方图的了解，如果你信任的人告诉你，他们在附近发现了一套有十间卧室的公寓，你将能够查找直方图，并判断这种可能性有多大。假设直方图显示概率是 0.00002，你会非常惊讶。这就是 P 值的意义所在。它根据观察结果及其概率的直方图，告诉你观察结果有多令人惊讶。****

## ****处理分数卧室(连续数据)****

****哦，那是什么意思？一个房子不能有 1.15 个房间。没错，但许多其他量会。例如，房子的面积可以是任何正数。让我们看看如何为这些数据构建直方图。我们现在会更加现实。因此，假设我们从一个社区的 4595 栋房子中随机选择了 130 栋房子来收集数据。数据可能是这样的:[620，650，670，850，910，920，940，970，990，1010，1040，…，3740，3760，3950，4260，4410，4600]。这些数字代表以平方英尺为单位的居住面积。****

****为简单起见，假设数据已经排序。所以最小的房子是 620 平方英尺。最大的一个有 4600 平方英尺。还有很多中间值。很明显，大多数数字都是独一无二的。如果每个数字似乎只出现一次，你如何用直方图来总结这些数字？记录每个数字的计数的天真方法失败了。使用这种方法，汇总可能会与数字列表一样长，绘制时，直方图看起来会像下图一样，缺少大量数据。****

****![](img/5bccd372c32fc51ba0a56f01a6fc380c.png)****

****横跨 130 栋房屋的居住面积直方图(由于空间较小，在 1000 平方英尺后被截断)****

****这是非常无用的。但是我们可以通过 ***【宁滨】*** 这个量(居住面积)得到一些有用的东西。为此，我们将客厅分成 500 平方英尺的空间。因此，第一个箱用于面积在 620 平方英尺和 1120 平方英尺之间的房屋，第二个箱用于 1120 平方英尺到 1620 平方英尺的房屋，依此类推。现在，我们可以浏览列表，并为每个数字(居住面积)找到正确的容器，并增加容器的计数，从而得到下面的摘要。请注意，**到面积**栏是每个箱子的上限，箱子中的房屋面积将严格小于该上限。因此，居住面积为 1120 平方英尺的房屋将被计入第二个箱(1120 平方英尺-1620 平方英尺)，因为第一个箱适用于面积不超过 1120 平方英尺的房屋。****

****![](img/19a9c5570b52cb4dcefc31b49ff229e1.png)****

****按居住面积汇总房屋数量(装入 500 平方英尺大小的箱子中。)****

****现在绘制直方图很简单:****

****![](img/47e2351c127fde25a9fd278e0ce456ea.png)****

****使用 500 平方英尺垃圾箱建造的 130 栋房屋的居住面积直方图****

****然而，在这个直方图能回答什么样的问题上有一个微妙的变化。有了长长的 130 个数字，如果有人问你“**居住面积 620 平方英尺的房子出现的频率是多少？**”，你将扫描整个列表，计算 620 出现的次数(在我们的例子中只有一次)并报告计数。但是一旦你用 bin 汇总数据，你就不能再回答这个问题了。你现在可以回答的问题是“**居住面积在 620sqft 之间的房子出现的频率是多少？和 1120 平方英尺。？**”。****

> ****在使用宁滨进行汇总的过程中，生活区域的每个值的准确频率被丢弃，但这使我们能够首先汇总数据。****

****您可能想知道为什么我们不能检索面积为 620 平方英尺的房屋的准确频率。从直方图来看。毕竟可以到 ***x-*** 轴上对应 620sqft 的点。然后读取 ***y-*** 轴上对应的值，也就是 13。这似乎是完全可行的，直到你试图找到居住面积的其他值落入同一垃圾桶的频率，例如，635 平方英尺。因为我们有一个面元直方图，并且这个值落在同一个面元中，所以您从 ***y-*** 轴读取的频率将再次是 13。****

****尽管面元宽度为 500，但落入此面元的房屋数量是无限的。例如，面积为 620.1 平方英尺、620.523 平方英尺和 652.9 平方英尺的房屋都属于同一个箱，如果您要查询它们的数量，每次都会得到 13。但是我们不，这是不正确的。从汇总表中，我们知道 bin 中的房屋总数仅为 13。之所以如此，是因为并不是生活区域的所有值都出现在数据中。例如，只有一所房子的居住面积为 620 平方英尺，但没有居住面积大于 620 平方英尺和小于 650 平方英尺的房子。这就是为什么我们不能检索或报告单个频率。我们如何解决这个问题？这就是我们在下一节要做的。****

## ****救援频率密度****

****解决这个问题的一个方法是用每个条形的频率，也就是它的高度，除以它的宽度。这将频率转换成所谓的*频率密度。因此，在我们的例子中，第一个容器的频率 13 除以容器宽度 500，就变成了频率密度 0.026。类似地，第二个箱将具有 21/500 或 0.042 的频率密度。*****

*****![](img/30db90683a5c4a4ff8bee2de5b63a63e.png)**********![](img/f6cb33a800ef45764f4e3efdc53ecf90.png)*****

*****130 户家庭居住区的频率(左)与频率密度(右)，被放入 500 平方英尺的箱子中*****

> *****用直方图条的高度(频率)除以条的宽度(仓宽)得到频率密度。*****
> 
> *****将直方图条的高度(频率)除以所有条的高度(频率)之和，得到概率。*****

*****在 ***y-*** 轴上有**频率密度**值的情况下，频率的计算需要将密度乘以箱宽度。例如，为了**计算**居住面积在 620 平方英尺和 1120 平方英尺之间的房屋的频率，这对应于直方图中的第一个柱。简单地将它的**频率密度** (0.026)乘以它的仓宽度(500)得到 13。*****

****我们还可以**估计**一个仓内较小范围的频率。例如，居住面积在 700 平方英尺和 900 平方英尺之间(箱宽= 900–700 = 200)的房屋的**估算频率**将为 0.026*200 或 5.20，可向下舍入为 5。这个估计很糟糕，因为实际数字只有 1(850 平方英尺)。如果面元更窄，我们可以得到更好的估计，但是我们也不能使面元太薄，否则我们会失去汇总的好处。****

****我们甚至可以**估计跨仓边界的**频率。比如居住面积在 1100 平方英尺到 1200 平方英尺之间的房子的**预估频率**可以计算为(1120–1100)* 0.026+(1200–1120)* 0.042 = 3.9，四舍五入为 4。****

****一个确切的生活区域的频率如何，比如 759.25 平方英尺？我们无法计算，因为 bin 宽度为 0。****

> ****对于**频率密度**直方图，频率和仓宽乘积之和给出总计数。****

## ****概率密度****

****我们已经看到为什么概率是有用的，以及如何从频率中计算它们。然而，当使用箱时，计算的概率总和不等于 1。同样，解决方法是计算密度，类似于我们计算频率密度的方法。为了计算 ***概率密度*** ，每个箱的概率除以其宽度。让我们看看这是如何工作的。****

****考虑跨度为 620 平方英尺到 1120 平方英尺的第一个箱。它的频率是 13。所有频率之和为 130(总房屋数)。所以第一箱的概率正好是 0.10。对于第二个箱，频率是 21，所以概率是 21/130=0.16。下面中间的直方图显示了这些概率。为了计算每个箱的**概率密度**，我们除以箱宽度，500。所以 0.10/500 = 0.0002 和 0.16/500 = 0.00032 等等。这在右侧的第三个直方图中有所描述。****

****![](img/617aef6afed59bc3d6b1bc92744a1e24.png)********![](img/b78e20ab60faff6d120434e4a73a9e43.png)********![](img/bcfc1eef31e6c3f28c17f94cee5691ea.png)****

****130 所房屋的频率(L)、概率(C)和概率密度(R)直方图(箱宽= 500)****

****使用概率密度直方图，可以计算出**概率**、**频率**或**频率密度**。例如，从 620 平方英尺到 1120 平方英尺的条柱的概率密度是 0.0002，因此条柱的概率可以通过反向计算来计算，即乘以条柱宽度(500)，得到 0.10。****

****为了计算频率，我们可以乘以所有频率的总和，130，得到 13。为了找到频率密度，我们可以再除以仓宽度得到 0.026。****

****请注意，我们是如何乘以仓宽从概率密度到概率，然后乘以频率之和得到频率，再除以仓宽得到频率密度的。第一步和第三步正好相反，所以我们可以通过乘以频率之和，从概率密度得到频率密度。例如，概率密度 0.002 乘以 130 得到频率密度 0.26。****

****这也是有意义的，因为对于装箱的数据，我们感兴趣的是概率密度和频率密度。****

****![](img/3eb7e110896c0d74b5c748e092ddf0c7.png)****

****不同类型直方图之间的转换****

> ****对于**概率密度**直方图，频率和面元宽度乘积之和给出总概率，即 1。****

## ****重新审视 p 值****

****让我们回到 P 值，只是这次我们将使用概率密度直方图。让我们考虑一下 130 栋房屋居住面积直方图的连续例子。这是(概率密度)直方图:****

****![](img/5cb3dd25072ed13e21b8325376cf6fdb.png)****

****请注意，该直方图尚未“校正”,因此最后一个面元(4620 平方英尺-5120 平方英尺)右侧和第一个面元(620 平方英尺-1120 平方英尺)左侧的概率密度突然变为零。位于中心的面元密度较高，因此概率较高，而靠近末端的面元概率较低。****

****假设有人报告说找到了一栋 4200 平方英尺的房子。为了测试这有多令人惊讶，你需要确定居住面积为 4200 平方英尺的房屋的概率。你不能用一个分箱的直方图做到这一点。你需要一个区域的范围，而不仅仅是一个精确的值。****

****在这种情况下，诀窍是不仅要找出这个值有多令人惊讶，还要找出这个值或更大的值有多令人惊讶。因此，我们想确定居住面积为 4200 平方英尺或更大的房子的概率。由于直方图只覆盖了 4620 平方英尺以内的房屋，我们想估计房屋面积在 4200 平方英尺和 4620 平方英尺之间的概率(箱宽= 380)。这两个值都位于最后一个箱(4120 平方英尺-4620 平方英尺)中，因此计算概率很简单。宽度为 380 平方英尺，概率密度约为 0.00005 (3/130/500)。所以估计的概率是 0.018，或者说是 1.8%，非常小。由于概率如此之小，观察结果(4200 平方英尺的房子)相当令人惊讶。****

****另一方面，如果有人报告了一栋居住面积为 630 平方英尺的房子，而我们想要量化发现这样一栋房子有多令人惊讶，我们将不仅发现这个值有多令人惊讶，而且发现**这个值或更小的值有多令人惊讶**。我们数据中最小的房子是 620 平方英尺，所以我们想估计居住面积在 620 平方英尺和 630 平方英尺之间的房子的概率(箱宽= 10)。同样，两个值都落在相同的条柱(620 平方英尺-1120 平方英尺)中，因此可以根据条柱的概率密度 0.0002 和条柱宽度 0.0002*10 或 0.002 或 0.2%来估计概率。这是很小的，因此观察(630 平方英尺的房子)再次非常令人惊讶。****

****我们在这两种情况下计算的概率是 **p 值**。请注意，根据我们在直方图的哪一端，我们必须包括所有大于观察值的值(右端)或所有小于观察值的值(左端)。这两种情况一般通过称之为“更极端的值”而合二为一。****

****最后，如果我们想更真实，我们会涂抹直方图一点点，以“校正”样本中看不见的值。这可以通过在直方图两端的右侧和左侧引入更多的箱，并为这些新的箱逐渐分配更小的概率密度，同时确保所有箱组合的概率保持为 1 来实现。****

> ****给定直方图，p 值越小，观察结果越令人惊讶。****

****现在我们已经了解了 p 值，在下一部分中，我们将尝试了解什么是概率密度分布，如何根据这些分布计算 p 值，以及为什么 p 值会被误解和误用，以及如何正确解释它们。****