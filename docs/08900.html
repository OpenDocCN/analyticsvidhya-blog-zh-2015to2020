<html>
<head>
<title>Applying Darwinian Evolution to feature selection with Kydavra GeneticAlgorithmSelector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Kydavra 遗传算法选择器将达尔文进化应用于特征选择</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/applying-darwinian-evolution-to-feature-selection-with-kydavra-geneticalgorithmselector-6ca8341cd2f9?source=collection_archive---------30-----------------------#2020-08-17">https://medium.com/analytics-vidhya/applying-darwinian-evolution-to-feature-selection-with-kydavra-geneticalgorithmselector-6ca8341cd2f9?source=collection_archive---------30-----------------------#2020-08-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/392eab7c3d033e519cc5968c65b5aa26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CdOd_w9hK7yhgnOu_C8OPg.png"/></div></div></figure><p id="5112" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">机器学习的发展蕴含了大量的数学知识。但有时在特征选择阶段，数学有时不能给出准确的答案(因为数据的结构、来源和许多其他原因)。然后游戏内进入编程招数，多为蛮力方法:)。</p><p id="5b30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">遗传算法是一系列受生物进化启发的算法，基本上使用循环——交叉、变异、尝试，根据评分标准开发最佳状态组合。所以，让我们来看看代码。</p><h2 id="f0fb" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">使用 Kydavra 库中的 GeneticAlgorithmSelector。</h2><p id="f007" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">要安装 kydavra，只需在终端中写入以下命令:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="6e1a" class="jo jp hi kt b fi kx ky l kz la">pip install kydavra</span></pre><p id="a1b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您可以导入选择器并将其应用于数据集，如下所示:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="a750" class="jo jp hi kt b fi kx ky l kz la">from kydavra import GeneticAlgorithmSelector</span><span id="497a" class="jo jp hi kt b fi lb ky l kz la">selector = GeneticAlgorithmSelector()</span><span id="c8af" class="jo jp hi kt b fi lb ky l kz la">new_columns = selector.select(model, df, ‘target’)</span></pre><p id="b321" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就像所有的 Kydavra 选择器一样。现在让我们在 Hearth disease 数据集上尝试一下。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="e522" class="jo jp hi kt b fi kx ky l kz la">import pandas as pd</span><span id="a3af" class="jo jp hi kt b fi lb ky l kz la">df = pd.read_csv(‘cleaned.csv’)</span></pre><p id="a6bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我强烈建议您在应用选择器之前对数据集进行洗牌，因为它使用了度量标准(目前 cross_val_score 还没有在这个选择器中实现)。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="3338" class="jo jp hi kt b fi kx ky l kz la">df = df.sample(frac=1).reset_index(drop=True)</span></pre><p id="a9e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们可以应用我们的选择器。提到它有一些参数:</p><ul class=""><li id="b397" class="lc ld hi is b it iu ix iy jb le jf lf jj lg jn lh li lj lk bi translated"><strong class="is hj"> nb_children </strong> (int，default = 4)算法将为下一代选择的最佳子代的数量。</li><li id="70ce" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><strong class="is hj"> nb_generation </strong> (int，default = 200)将要创建的代数，技术上讲就是迭代次数。</li><li id="b372" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><strong class="is hj">scoring _ metric</strong>(sk learn scoring metric，默认= accuracy_score)用于选择最佳特征组合的度量分数。</li><li id="0859" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><strong class="is hj"> max </strong> (boolean，default=True)如果设置为 True，算法将选择得分最高的组合，如果设置为 False，将选择得分最低的组合。</li></ul><p id="607a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是现在，我们将使用除 scoring_metric 之外的基本设置，因为我们有一个疾病诊断的问题，所以最好使用 Precision 而不是 accuracy。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="b43d" class="jo jp hi kt b fi kx ky l kz la">from kydavra import GeneticAlgorithmSelector</span><span id="0785" class="jo jp hi kt b fi lb ky l kz la">from sklearn.metrics import precision_score</span><span id="f81d" class="jo jp hi kt b fi lb ky l kz la">from sklearn.ensemble import RandomForestClassifier</span><span id="8c7b" class="jo jp hi kt b fi lb ky l kz la">selector = GeneticAlgorithmSelector(scoring_metric=precision_score)</span><span id="a2c4" class="jo jp hi kt b fi lb ky l kz la">model = RandomForestClassifier()</span></pre><p id="b90f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以现在让我们找到最好的特性。GAS(genetical gorithm selector 的简称)在选择特征、数据框本身以及目标列的名称的过程中需要一个 sklearn 模型进行训练:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9615" class="jo jp hi kt b fi kx ky l kz la">selected_cols = selector.select(model, df, 'target')</span></pre><p id="f870" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们来评估结果。在特征选择之前，随机森林的精度分数是-0.805。气体选择以下特性:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8279" class="jo jp hi kt b fi kx ky l kz la">['age', 'sex', 'cp', 'fbs', 'restecg', 'exang', 'slope', 'thal']</span></pre><p id="655e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这给出了下面的精度分数——0.823。这是一个好结果，要知道在大多数情况下很难提高评分标准。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/20f73cb96e2fa41d8d3ff82eaee5bd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*UEuA3iIXXDXC-QuXwD_MhA.gif"/></div></figure><p id="d896" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想了解更多关于遗传算法的信息，文章底部有一些有用的链接。如果您尝试了 Kydavra，并且有一些问题或反馈，请通过 medium 与我联系，或者请填写此<a class="ae lr" href="https://vpapaluta.typeform.com/to/g1EXxlSf" rel="noopener ugc nofollow" target="_blank">表格</a>。</p><p id="bb62" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由西格蒙德用❤制成</p><p id="156e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有用的链接:</p><ul class=""><li id="b981" class="lc ld hi is b it iu ix iy jb le jf lf jj lg jn lh li lj lk bi translated"><a class="ae lr" href="https://towardsdatascience.com/the-most-important-part-in-artifical-intesystems-development-243f04f73fcd" rel="noopener" target="_blank">https://towards data science . com/the-most-important-part-in-artificial-intesystems-development-243 f 04 f 73 fcd</a></li></ul></div></div>    
</body>
</html>