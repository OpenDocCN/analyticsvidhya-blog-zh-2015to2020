<html>
<head>
<title>Multiple Linear Regression — 8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元线性回归— 8</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multiple-linear-regression-2f28ad463e68?source=collection_archive---------13-----------------------#2019-12-12">https://medium.com/analytics-vidhya/multiple-linear-regression-2f28ad463e68?source=collection_archive---------13-----------------------#2019-12-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="6516" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">如果您还没有阅读R数据分析系列的第7部分，请仔细阅读下面的文章，其中我们讨论了<a class="ae jh" rel="noopener" href="/analytics-vidhya/simple-linear-regression-7-655537eee4c5"> <em class="hi">简单线性回归— </em> </a> <em class="hi"> 7 </em>。</p><p id="6d04" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这篇文章的内容是我在IIM-B时代得到介绍的几本书的要点。</p><p id="af93" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">人人为我——贾里德·p·兰德</p><p id="3937" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">实用数据科学与R — Nina Zumel和John Mount</p><p id="86eb" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">文中讨论的所有代码块都以R markdown的形式出现在<a class="ae jh" href="https://github.com/viveksrinivasanss/Data_Science_Using_R" rel="noopener ugc nofollow" target="_blank"> Github链接</a>中。</p><p id="0de7" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">要查看我写的所有文章，请使用链接<a class="ae jh" rel="noopener" href="/@viveksrinivasan"> Vivek Srinivasan </a>。</p></blockquote><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ji"><img src="../Images/af80b76f9758bc2efff1163a86eb80c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MAoBZse6YrnV2mtAkAdTww.jpeg"/></div></div></figure><p id="2e68" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi jx translated"><span class="l jy jz ka bm kb kc kd ke kf di">T</span><code class="du kg kh ki kj b">simple linear regression</code>的逻辑扩展是<code class="du kg kh ki kj b">multiple regression</code>，它允许多个预测器。想法还是一样的；我们仍在对反应进行预测或推断，但我们现在有了更多的多种预测形式的信息。数学需要一些矩阵代数，但幸运的是，<code class="du kg kh ki kj b">lm </code>函数的使用非常简单。</p><p id="c4e9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">在这种情况下，响应和<code class="du kg kh ki kj b">p</code>预测值(P1预测值和截距)之间的关系建模为</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es kk"><img src="../Images/b462ee1762e14774fee83242c27ae343.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*91gps0SyQ2lVtYEdvlz-Hw.png"/></div></figure><p id="d262" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">其中<code class="du kg kh ki kj b">Y</code>是<code class="du kg kh ki kj b">nx1</code>响应向量。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es kl"><img src="../Images/a212234719fdfe378f2e1f02708bd19b.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*C_9smEIhdBvj0mVLP77ilg.png"/></div></figure><p id="19d4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">x是<code class="du kg kh ki kj b">nxp</code>矩阵(n行和P1预测值加上截距)</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es km"><img src="../Images/40ed50227a01796f2c7d596be95cdb6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*EL2jiJJ2HDCuV6EPsq5eYQ.png"/></div></figure><p id="1f73" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">β是系数的px1向量(每个预测值和截距一个)</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es kn"><img src="../Images/7848fef93d5b4d5c026e8365531e4ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:328/format:webp/1*bVuSI3rEv8tm-KbwLOtK8A.png"/></div></figure><p id="c030" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">ε是正态分布误差的nx1向量。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es ko"><img src="../Images/503d1630b5a90ef4b9237595c20b2792.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*FbrfNGhmqJAnfN4LtCAxDQ.png"/></div></figure><p id="8d3b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">随着</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es kp"><img src="../Images/0e3629e184e2100fb75b2b8b0f614154.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*Tm5qmT_0W1Mi-NtXkDNSrA.png"/></div></figure><p id="2eeb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">这看起来比简单的回归更复杂，但代数实际上变得更简单。系数的解简单地写成</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es kq"><img src="../Images/bb3e9cb56bc208977491cdaaa88c37d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*g2wESwZkG2rwQIdvUjScOA.png"/></div></figure><p id="92ae" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">为了看到这一点，我们使用了纽约市2011-2012财年的公寓评估，通过纽约市公开数据获得。纽约市开放数据是纽约市的一项倡议，旨在使政府更加透明，工作更好。原始数据按区分开，曼哈顿、布鲁克林、皇后区、布朗克斯和斯塔滕岛各有一个文件，包含我们不会使用的额外信息。</p><p id="f04a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">于是我们把五个文件合并成一个，清理了栏目名称，发布在<a class="ae jh" href="https://github.com/viveksrinivasanss/Data_Science_Using_R/blob/master/data/housing.csv" rel="noopener ugc nofollow" target="_blank"> <em class="ik"> housing.csv </em> </a>。要访问数据，要么从那个URL下载并在现在的本地文件上使用<code class="du kg kh ki kj b">read.table</code>，要么直接从<code class="du kg kh ki kj b">URL</code>中读取。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="29a2" class="kv kw hi kj b fi kx ky l kz la">housing &lt;- read.table("../data/housing.csv",<br/>                      sep = ",", header = TRUE,<br/>                      stringsAsFactors = FALSE)</span></pre><p id="c85b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">关于这段代码的一些提醒:sep指定使用逗号来分隔列；header表示第一行包含列名；并且<code class="du kg kh ki kj b">stringsAsFactors </code>保持字符列不变，不将它们转换成<code class="du kg kh ki kj b">factors</code>，这加快了加载时间，也使它们更容易操作。查看数据，我们看到有许多列和一些错误的名称，因此我们应该对它们进行重命名</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="9df2" class="kv kw hi kj b fi kx ky l kz la">names(housing) &lt;- c("Neighborhood", "Class", "Units", "YearBuilt",<br/>                    "SqFt", "Income", "IncomePerSqFt", "Expense",<br/>                    "ExpensePerSqFt", "NetIncome", "Value",<br/>                    "ValuePerSqFt", "Boro")<br/>head(housing)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lb"><img src="../Images/f44e441459f081e298ce6e799978a69b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mbzxa4QhFColybTgV0Qvcw.png"/></div></div></figure><p id="ff8a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">对于这些数据，响应是每平方英尺的值，预测是其他一切。然而，我们忽略了收入和支出变量，因为它们实际上只是基于一个晦涩难懂的要求的估计，即为了估价的目的，要将公寓与租金进行比较。第一步是在一些探索性的数据分析中将数据可视化。自然的起点是<code class="du kg kh ki kj b">ValuePerSqFt</code>的<code class="du kg kh ki kj b">histogram </code>。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="b584" class="kv kw hi kj b fi kx ky l kz la">require(ggplot2)<br/>ggplot(housing, aes(x=ValuePerSqFt)) + geom_histogram(binwidth=10) + labs(x="Value per Square Foot")</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lc"><img src="../Images/f3445383ac98b4acd5d4e6a9d7b01425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNrIy3XYgdIyKTQejyfHlw.png"/></div></div></figure><p id="af43" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated"><code class="du kg kh ki kj b">histogram </code>的<code class="du kg kh ki kj b">bimodal </code>本质意味着还有一些东西有待探索。将颜色映射到Boro并在Boro上刻面显示，布鲁克林和皇后区构成了一种模式，曼哈顿构成了另一种模式，而布朗克斯和斯塔滕岛没有太多数据。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="b91f" class="kv kw hi kj b fi kx ky l kz la">require(gridExtra)<br/>p1 &lt;- ggplot(housing, aes(x=ValuePerSqFt, fill=Boro)) +<br/>        geom_histogram(binwidth=10) + <br/>        labs(x="Value per Square Foot") + <br/>        theme(axis.text.x = element_text(angle = 90))<br/>p2 &lt;- ggplot(housing, aes(x=ValuePerSqFt, fill=Boro)) +<br/>        geom_histogram(binwidth=10) + <br/>        labs (x="Value per Square Foot") +      <br/>        facet_wrap(~Boro) + <br/>        theme(axis.text.x = element_text(angle = 90))<br/>grid.arrange(p1, p2, nrow = 1,widths=c(3, 5))</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ld"><img src="../Images/9744d67b6bb509d193ffccd0664aa0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x2KHciyblN1qY5PjNStu9g.png"/></div></div></figure><h2 id="e784" class="kv kw hi bd le lf lg lh li lj lk ll lm ju ln lo lp jv lq lr ls jw lt lu lv lw bi translated">异常值分析</h2><p id="7e43" class="pw-post-body-paragraph ii ij hi il b im lx io ip iq ly is it ju lz iw ix jv ma ja jb jw mb je jf jg hb bi translated">现在让我们试着想象另外两个重要的预测值ValueperSquareFoot和units，看看是否有任何可能影响我们回归分析的异常点。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="9991" class="kv kw hi kj b fi kx ky l kz la">p3 &lt;- ggplot(housing, aes(x=SqFt)) + geom_histogram()<br/>p4 &lt;- ggplot(housing, aes(x=Units)) + geom_histogram()<br/>grid.arrange(p3, p4, nrow = 1)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es mc"><img src="../Images/66b31165a8fe62cc81d1ebe60edbe09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUTkKix2yZgj_OP4nagA0w.png"/></div></div></figure><p id="0292" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">从上图可以看出，有不少建筑的单元数和平方英尺面积都令人难以置信。它们可能是潜在的异常值，让我们用箱线图来证实这一点。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="8890" class="kv kw hi kj b fi kx ky l kz la">p5 &lt;- ggplot(housing, aes(y=SqFt,x=1)) + geom_boxplot()<br/>p6 &lt;- ggplot(housing, aes(y=Units,x=1)) + geom_boxplot()<br/>grid.arrange(p5, p6, nrow = 1)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es md"><img src="../Images/05fb74b2a75e2e1eb79351df0ebb3909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O20qOZgP9BKr9lugkkh4GA.png"/></div></div></figure><p id="caec" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">所以从<code class="du kg kh ki kj b">boxplots </code>可以很明显的看到，有相当多的点有极值。在我们的回归分析中有这些点可能会<code class="du kg kh ki kj b">skew </code>我们的回归估计，并将导致较差的预测能力。毕竟，回归只是数据的一个<code class="du kg kh ki kj b">mean estimate</code>，如果我们的数据中有极值，它就会受到影响。因此，我们将会看到我们可能需要删除多少这样的点，以使<code class="du kg kh ki kj b">regression </code>分析更好。从表中我们可以看到有6行数据具有极值<code class="du kg kh ki kj b">Units </code>和<code class="du kg kh ki kj b">SqFt </code>值。因此，我们将这些数据点，并继续我们的分析。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="55e6" class="kv kw hi kj b fi kx ky l kz la">housing[housing$Units &gt; 1000, ]</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es me"><img src="../Images/07f1af6b05f902f7dbb262270d9fd4d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bFHm-tNCFZXathRzpNV-ew.png"/></div></div></figure><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="aa66" class="kv kw hi kj b fi kx ky l kz la">housing &lt;- housing[housing$Units &lt;   1000, ]</span></pre><p id="1500" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">既然我们已经以几种不同的方式查看了数据，那么是时候开始建模了。我们已经从<code class="du kg kh ki kj b">histograms </code>中看到，考虑不同的行政区很重要，随后的<code class="du kg kh ki kj b">histograms </code>和<code class="du kg kh ki kj b">boxplots </code>表明<code class="du kg kh ki kj b">Units </code>和<code class="du kg kh ki kj b">SqFt </code>也很重要。</p><p id="b265" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">拟合模型使用<code class="du kg kh ki kj b">lm</code>中的公式界面。既然有多个<code class="du kg kh ki kj b">predictors</code>，我们在公式的右边用加号<code class="du kg kh ki kj b">(+)</code>将它们分开。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="3e72" class="kv kw hi kj b fi kx ky l kz la">house1 &lt;- lm(ValuePerSqFt ~ Units + SqFt + Boro, data=housing)<br/>summary(house1)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es mf"><img src="../Images/2ee920b280cc69fcd6b1eb65c8c73eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VljjG9y0klD5XqKPtp49pQ.png"/></div></div></figure><p id="ac1c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">首先要注意的是，在某些版本的<code class="du kg kh ki kj b">R</code>中，有一条消息警告我们<code class="du kg kh ki kj b">Boro </code>被转换为因子。这是因为<code class="du kg kh ki kj b">Boro </code>被存储为<code class="du kg kh ki kj b">character</code>，并且为了建模的目的<code class="du kg kh ki kj b">character </code>数据必须使用指示器变量来表示，这就是<code class="du kg kh ki kj b">factors </code>在建模函数中被处理的方式。</p><h2 id="44f6" class="kv kw hi bd le lf lg lh li lj lk ll lm ju ln lo lp jv lq lr ls jw lt lu lv lw bi translated">模型总结和解释</h2><p id="fbfb" class="pw-post-body-paragraph ii ij hi il b im lx io ip iq ly is it ju lz iw ix jv ma ja jb jw mb je jf jg hb bi translated"><code class="du kg kh ki kj b">summary </code>函数打印出关于模型的信息，包括函数如何被调用，每个变量的<code class="du kg kh ki kj b">quantiles for the residuals</code>、<code class="du kg kh ki kj b">coefficient estimates</code>、<code class="du kg kh ki kj b">standard errors</code>和<code class="du kg kh ki kj b">p-values</code>，以及模型的<code class="du kg kh ki kj b">degrees of freedom</code>、<code class="du kg kh ki kj b">p-value</code>和<code class="du kg kh ki kj b">F-statistic</code>。<code class="du kg kh ki kj b">Bronx </code>没有系数，因为它是<code class="du kg kh ki kj b">Boro</code>的基线水平，所有其他<code class="du kg kh ki kj b">Boro </code>系数都与该基线相关。</p><p id="0111" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated"><code class="du kg kh ki kj b">coefficients </code>表示<code class="du kg kh ki kj b">predictors </code>对<code class="du kg kh ki kj b">response </code>的影响，而<code class="du kg kh ki kj b">standard errors</code>是系数估计中的不确定性。系数的<code class="du kg kh ki kj b">t value</code> (t-statistic)和<code class="du kg kh ki kj b">p-value</code>是具有统计显著性的数值度量，尽管应谨慎看待，因为大多数现代数据科学家不喜欢查看单个系数的统计显著性，而是从整体上判断模型。</p><p id="0bba" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">模型<code class="du kg kh ki kj b">p-value</code>和<code class="du kg kh ki kj b">F-statistic</code>是其拟合优度的度量。回归的<code class="du kg kh ki kj b">degrees of freedom</code>计算为观察值的数量减去系数的数量。在这个例子中，有<code class="du kg kh ki kj b">nrow(housing) − length(coef(house1)) = 2613</code>个自由度。</p><p id="6919" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">我们在上一篇文章中详细解释了t值和F值的重要性。</p><p id="afb3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated"><a class="ae jh" rel="noopener" href="/analytics-vidhya/simple-linear-regression-7-655537eee4c5"> <em class="ik">简单线性回归— </em> </a> <em class="ik"> 7 </em></p><p id="4a51" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">简而言之,<code class="du kg kh ki kj b"> t-value</code>测量单个变量的显著性，另一方面F统计测量模型的总体显著性。由于<code class="du kg kh ki kj b">t-statistics</code>和<code class="du kg kh ki kj b">F-Score</code>的<code class="du kg kh ki kj b">p-value</code>小于5 %(一般经验法则),我们可以有把握地得出结论，我们建立的模型是好的，模型中使用的<code class="du kg kh ki kj b">predictors </code>足够显著。此外，在我们的回归分析中，我们有相当不错的<code class="du kg kh ki kj b">0.6034 </code>的<code class="du kg kh ki kj b">R-Square</code>值，这表明我们的总方差的<code class="du kg kh ki kj b">60 percent</code>是由模型解释的。</p><h2 id="bb3d" class="kv kw hi bd le lf lg lh li lj lk ll lm ju ln lo lp jv lq lr ls jw lt lu lv lw bi translated">系数分析</h2><p id="986d" class="pw-post-body-paragraph ii ij hi il b im lx io ip iq ly is it ju lz iw ix jv ma ja jb jw mb je jf jg hb bi translated">从模型中获取系数的一个快速方法是使用<code class="du kg kh ki kj b">coef </code>函数，或者使用模型对象上的<code class="du kg kh ki kj b">$</code>操作符从模型中获取系数。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="9edc" class="kv kw hi kj b fi kx ky l kz la">coef(house1)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es mg"><img src="../Images/d07d38b02a0604cf6793acce333841b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8LGAitLyVy51cTN3ic1_g.png"/></div></div></figure><p id="3db2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">比起信息表，我们更喜欢可视化，可视化回归结果的一个好方法是系数图。我们没有从头开始构建，而是使用方便的<code class="du kg kh ki kj b">coefplot </code>包，其中每个系数被绘制为一个点，粗线代表<code class="du kg kh ki kj b">one standard error </code>置信区间，细线代表<code class="du kg kh ki kj b">two standard error </code>置信区间。有一条垂直线表示0。</p><p id="21e6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">一般来说，一个好的经验法则是，如果两个标准误差的置信区间不包含0，则它在统计上是显著的。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="352e" class="kv kw hi kj b fi kx ky l kz la">library(coefplot)<br/>coefplot(house1)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es mh"><img src="../Images/e1f8b2a90c7f90bbb8cae6ca9fee5474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaclFEod0rwcWIpG2BI-tw.png"/></div></div></figure><p id="cb3c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">不出所料，位于<code class="du kg kh ki kj b">Manhattan </code>对<code class="du kg kh ki kj b">value per square foot</code>的影响最大。令人惊讶的是，建筑中的单元数或平方英尺数对价值几乎没有影响。这是一个带有纯加法项的模型。变量之间的相互作用同样强大。</p><h2 id="1ef8" class="kv kw hi bd le lf lg lh li lj lk ll lm ju ln lo lp jv lq lr ls jw lt lu lv lw bi translated">带有交互项的模型</h2><p id="57d9" class="pw-post-body-paragraph ii ij hi il b im lx io ip iq ly is it ju lz iw ix jv ma ja jb jw mb je jf jg hb bi translated">要在公式中输入它们，用<code class="du kg kh ki kj b"> *</code>而不是<code class="du kg kh ki kj b">+</code>分隔所需变量。这样做的结果是单个变量加上相互作用项被包含在模型中。为了只包括交互项，而不包括单个变量，使用<code class="du kg kh ki kj b">: </code>代替。<code class="du kg kh ki kj b">Units </code>和<code class="du kg kh ki kj b">SqFt </code>交互的结果是</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="f604" class="kv kw hi kj b fi kx ky l kz la">house2 &lt;- lm(ValuePerSqFt ~ Units * SqFt + Boro, data=housing)<br/>house3 &lt;- lm(ValuePerSqFt ~  Units : SqFt + Boro, data=housing)</span></pre><p id="080e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">我们已经拟合了许多模型，我们需要从中挑选“最好”的一个。模型选择和模型诊断是完全不同的主题，将在我们的下一篇文章中讨论。</p><p id="b2b4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated"><em class="ik">模型诊断和模型选择— 8 </em></p><p id="fef5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">同时，我们将使用<code class="du kg kh ki kj b">coefplot </code>包中方便的<code class="du kg kh ki kj b">multiplot </code>函数可视化多个模型的系数。下图显示了型号house1、house2和house3的系数图。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="7520" class="kv kw hi kj b fi kx ky l kz la">multiplot(house1, house2, house3)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es mi"><img src="../Images/e887c2b2182d2d1eb28fe4dc8ea78a7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6Mxt9q7DL-tOi1SKLlkYw.png"/></div></div></figure><h2 id="e157" class="kv kw hi bd le lf lg lh li lj lk ll lm ju ln lo lp jv lq lr ls jw lt lu lv lw bi translated">预言</h2><p id="92d5" class="pw-post-body-paragraph ii ij hi il b im lx io ip iq ly is it ju lz iw ix jv ma ja jb jw mb je jf jg hb bi translated">回归通常用于预测，在R中是通过<code class="du kg kh ki kj b">predict </code>函数实现的。我们有多个模型，我们的第一步是在使用它进行预测之前，找出哪个模型最适合数据。如前所述，我们将在下一篇文章中看到更多关于<code class="du kg kh ki kj b">model diagnostics </code>和<code class="du kg kh ki kj b">model selection</code>的步骤。现在，我们将后退一步，使用我们的<code class="du kg kh ki kj b">house1 </code>回归模型预测<code class="du kg kh ki kj b">ValueperSquareFoot</code>我们在<a class="ae jh" href="https://github.com/viveksrinivasanss/Data_Science_Using_R/blob/master/data/housingNew.csv" rel="noopener ugc nofollow" target="_blank"><em class="ik">housing new . CSV</em></a><em class="ik"/>获得的测试数据。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="06ac" class="kv kw hi kj b fi kx ky l kz la">housingNew &lt;- read.table("../data/housingNew.csv", sep=",",<br/>              header=TRUE, stringsAsFactors=FALSE)</span></pre><p id="817f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">进行预测可以像调用<code class="du kg kh ki kj b">predict</code>一样简单，尽管在处理因子预测器时必须小心谨慎，以确保它们具有与构建模型时使用的水平相同的水平。</p><pre class="jj jk jl jm fd kr kj ks kt aw ku bi"><span id="73d7" class="kv kw hi kj b fi kx ky l kz la">housePredict &lt;- predict(house1, newdata=housingNew,<br/>         se.fit=TRUE,interval="prediction", level=.95)</span><span id="5e79" class="kv kw hi kj b fi mj ky l kz la">#Predictions with upper and lower bounds based on standard errors<br/>head(housePredict$fit)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div class="er es mk"><img src="../Images/2de6c4d32bcc833f8bdab04c951d6e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*5k7SEPJaz-hH6KRI6WBPFg.png"/></div></figure><p id="f9dc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">在本文中，我们讨论了如何用多个<code class="du kg kh ki kj b">predictor </code>变量来拟合<code class="du kg kh ki kj b">regression </code>模型。我们还可视化了我们的<code class="du kg kh ki kj b">response </code>和<code class="du kg kh ki kj b">predictor </code>变量，以便更好地理解它。我们在模型构建过程中添加了一些交互项，并讨论了它如何影响我们的模型。最后，我们使用我们的基本模型，并对新数据集进行预测。</p><p id="5c0d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ju iv iw ix jv iz ja jb jw jd je jf jg hb bi translated">虽然我们的<code class="du kg kh ki kj b"> F-score </code>和<code class="du kg kh ki kj b">R-Square</code>表明该模型的总体意义是好的。仅仅得出我们建立的模型是健壮和完整的结论是不够的。还有其他几种方法来测试我们的模型性能和健壮性，这将在我们的下一篇文章中讨论。</p><blockquote class="if ig ih"><p id="a224" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><a class="ae jh" rel="noopener" href="/@viveksrinivasan/model-diagnostics-and-selection-9-7a79c4d70a24">模型诊断和模型选择— 9 </a></p><p id="ff62" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">一定要通过评论和分享文章来分享你的想法和支持。</p></blockquote></div></div>    
</body>
</html>