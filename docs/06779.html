<html>
<head>
<title>How Pytorch has made GANs training super easy!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pytorch如何让GANs的训练变得超级简单！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-pytorch-has-made-gans-training-super-easy-971f91c666ce?source=collection_archive---------9-----------------------#2020-06-02">https://medium.com/analytics-vidhya/how-pytorch-has-made-gans-training-super-easy-971f91c666ce?source=collection_archive---------9-----------------------#2020-06-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b3d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">当我一头扎进机器学习领域时，世代对抗网络总是让我感到惊讶。gan是可以想象新事物的机器学习模型。<a class="ae jm" href="https://ddcolrs.wordpress.com/2017/07/03/generative-adversarial-networks-gan/" rel="noopener ugc nofollow" target="_blank">生成对抗网络(GAN </a> s)于2014年首次引入，这是机器学习领域的一个普遍新概念。引入GANs的目的是生成与真实图像样本截然不同且无法区分的人工样本或图像。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jn"><img src="../Images/242d6df5b9cc79905a8f37a373c7a20d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOpU4ycGFdh1Elgsm0sgUw.jpeg"/></div></div></figure><h1 id="fcef" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">甘是什么？</h1><p id="9e1f" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">GANs通过生成给定输入样本序列的最可能结果来进行预测。例如，生成模型可以基于先前提供的样本帧生成下一个可能的设计。记住这个概念，我们现在就可以处理GANs。该模型是一种新的无监督神经网络结构，优于传统网络。更准确地说，一种训练神经网络的新方法是GANs。GANs包含两个独立的网络，这两个网络工作截然不同，但又互为对手</p><p id="e7d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1- <em class="lc">发生器</em> </strong>将随机噪声作为输入，然后这些噪声通过一个可微函数来转换噪声并将其重新整形为可识别的结构。输出是逼真的图像。输入噪声的选择决定了发生器网络将输出哪个镜像。</p><p id="3985" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lc"> 2-鉴别器</em> </strong>是必须经过训练的神经网络，在此之后，它充当分类器，可以区分真实(数据集中的图像)和虚假(生成器生成的图像)。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ld"><img src="../Images/df98d70296ff533881d149f284a9de29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqah2ZrxS2eFQ0r5HLdwFA.png"/></div></div></figure><h2 id="93b7" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">我们能拿GANS怎么办？</h2><p id="1090" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">随着时间的推移，我意识到甘斯有超级酷的应用。在过去的几年里，Gans已经产生了大量的超级有趣的结果。游戏开发和动画制作费用昂贵，需要雇佣许多制作艺术家来完成相对常规的任务。GAN可以自动生成动画角色并为其上色。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ls"><img src="../Images/216266e0cc2131e14d82ed336713dd63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xp8yXq3zBXBM4HC_iFPYdQ.png"/></div></div></figure><p id="5404" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">StackGANs模型可以将对鸟类的文字描述转换成高分辨率的鸟类图像。Pix2Pix GANs将粗糙的草图转换成逼真的图像。可以在无人监督的任务中训练图像到图像的翻译。甘斯可以把一张脸部的照片转换成脸部的漫画。这是我最喜欢的一款GANs，可以生成高分辨率的图像。看看这个视频。</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lt lu l"/></div></figure><h2 id="b4f7" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">为什么是Pytorch？</h2><p id="d6f7" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">2017年初，PyTorch发布，并在深度学习社区产生了相当大的影响。脸书人工智能研究团队将其开发为一个开源项目。一段时间后，它被工业界和学术界的团队所采用。以我的经验来看，这是学习深度学习的最佳框架，总体来说是一种乐趣。到本文结束时，您将学会如何训练自己的GAN。是不是很酷？</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lv"><img src="../Images/8d147acef7ff1827990d47149cb09a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*yNVbFXvweP-zWgazdDVsQA.png"/></div></figure><h1 id="0070" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">用Pytorch打造时尚MNIST甘</h1><p id="9bfe" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">让我们动手编程吧。在这篇文章中，我将建立一个在时尚MNIST数据集上训练的生成对抗网络(GAN ),这篇文章是为GAN的初学者准备的。从这一点上，我们将能够产生一个新的时尚项目！</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lw"><img src="../Images/edeb11cd6f5fb353b5f5c337d4e8afac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWuJl5e7gv_zf0PXt4Yctw.png"/></div></div></figure><p id="26d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图表显示了GANS的总体结构，使用时尚MNIST图片作为数据。潜在样本是生成器用来构建其假图像的随机向量。这通常被称为<strong class="ih hj">* *潜在向量** </strong>，而那个向量空间被称为<strong class="ih hj">* *潜在空间** </strong>。随着生成器的训练，它会想出如何将潜在向量映射到可识别的图像，从而骗过鉴别器。</p><p id="a471" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章的灵感来自于<a class="lx ly ge" href="https://medium.com/u/2929690a28fb?source=post_page-----971f91c666ce--------------------------------" rel="noopener" target="_blank"> Udacity </a>的Nanodegree项目中的GANs课程，但我将该模型应用于时尚数据集，并进行了一些修改。</p><h2 id="fb31" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">步骤# 01-导入必要的库并加载MNIST数据集</h2><p id="6c68" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">开始之前，我们需要安装Pytorch。如果您安装了Python &gt;= 3.5和Jupyter，您可以在本地运行它。或者，你可以在Google Colab中运行(如果你有Google帐户的话)。开始之前，我们做所有必要的进口</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><p id="9884" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将定义用于数据加载的子流程的数量。要加载的每批样品，理想的批量范围为32至128。将数据转换为torch.FloatTensor。稍后获取训练数据集。准备数据加载器，帮助加载上述批量的数据。</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><h2 id="1162" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">步骤#02 —可视化数据集</h2><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><h2 id="fa73" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">步骤# 03—定义我们模型的鉴别器</h2><p id="b1b4" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">鉴别器网络将会是一个非常典型的线性分类器。为了使这个网络成为通用函数逼近器，我们至少需要一个隐藏层，这些隐藏层应该有一个关键属性:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ma"><img src="../Images/e5af8e1e20d430e38942740e29933b35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xjP1HP1a0RZt4B0kGexoxQ.png"/></div></div></figure><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><h1 id="d2b5" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">步骤# 04-定义我们模型的生成器</h1><p id="7e42" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">发生器网络将与鉴别器网络几乎完全相同，除了我们将一个<a class="ae jm" href="https://pytorch.org/docs/stable/nn.html#tanh" rel="noopener ugc nofollow" target="_blank">双曲正切激活函数</a>应用到我们的输出层。</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><h1 id="ac6a" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">步骤#05定义模型的超参数并构建完整的网络</h1><p id="0392" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">在这种情况下，超参数将是输入层的大小、生成器和鉴别器的隐藏层以及输出大小。</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><p id="e32e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们从上面定义的类中实例化鉴别器和生成器。确保您已经传入了正确的输入参数。</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><p id="2462" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打印发生器和鉴别器的详细描述。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es mb"><img src="../Images/a93b0a203043fdd1d16ff5ef9ae80d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*6ytxJ8R3EAM_4uGItw5jww.png"/></div></div></figure><h1 id="6ac4" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">步骤#06定义鉴频器和发电机损耗</h1><h2 id="b712" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">鉴频器损耗</h2><ul class=""><li id="ba0c" class="mc md hi ih b ii kx im ky iq me iu mf iy mg jc mh mi mj mk bi translated">对于鉴别器，总损失是真实和伪造图像的损失之和，<code class="du ml mm mn mo b">d_loss = d_real_loss + d_fake_loss</code>。</li><li id="c8f5" class="mc md hi ih b ii mp im mq iq mr iu ms iy mt jc mh mi mj mk bi translated">请记住，我们希望鉴频器为真实图像输出1，为虚假图像输出0，因此我们需要设置损耗来反映这一点。</li></ul><h2 id="af5a" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">发电机损耗</h2><p id="4438" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">只有在标签翻转的情况下，发电机损耗才会看起来相似。生成器的目标是得到<code class="du ml mm mn mo b">D(fake_images) = 1</code>。在这种情况下，标签被<strong class="ih hj">翻转</strong>来表示生成器试图欺骗鉴别器，让它认为生成的图像(赝品)是真的！</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><h1 id="0c8c" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">步骤#07优化和培训</h1><p id="1743" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">我们希望分别更新生成器和鉴别器变量。因此，我们将定义两个独立的Adam优化器。</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><blockquote class="mu mv mw"><p id="3bf4" class="if ig lc ih b ii ij ik il im in io ip mx ir is it my iv iw ix mz iz ja jb jc hb bi translated">训练将包括交替训练鉴别器和发生器。我们将使用函数<code class="du ml mm mn mo b">real_loss</code>和<code class="du ml mm mn mo b">fake_loss</code>来帮助我们计算以下所有情况下的鉴频器损耗。</p></blockquote><h2 id="dfbd" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">甄别训练</h2><ol class=""><li id="c109" class="mc md hi ih b ii kx im ky iq me iu mf iy mg jc na mi mj mk bi translated">计算真实训练图像上的鉴别器损耗</li><li id="ec20" class="mc md hi ih b ii mp im mq iq mr iu ms iy mt jc na mi mj mk bi translated">生成假图像</li><li id="c3cc" class="mc md hi ih b ii mp im mq iq mr iu ms iy mt jc na mi mj mk bi translated">计算伪生成图像的鉴别器损耗</li><li id="6edc" class="mc md hi ih b ii mp im mq iq mr iu ms iy mt jc na mi mj mk bi translated">把真假损失加起来</li><li id="b0de" class="mc md hi ih b ii mp im mq iq mr iu ms iy mt jc na mi mj mk bi translated">执行反向传播+优化步骤来更新鉴别器的权重</li></ol><h2 id="cb16" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">发电机培训</h2><ol class=""><li id="9d45" class="mc md hi ih b ii kx im ky iq me iu mf iy mg jc na mi mj mk bi translated">生成假图像</li><li id="a15f" class="mc md hi ih b ii mp im mq iq mr iu ms iy mt jc na mi mj mk bi translated">使用<strong class="ih hj">翻转</strong>标签计算假图像的鉴别器损失！</li><li id="cca0" class="mc md hi ih b ii mp im mq iq mr iu ms iy mt jc na mi mj mk bi translated">执行反向传播+优化步骤来更新生成器的权重</li></ol><h2 id="4040" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">保存样本</h2><p id="55e5" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">在我们训练时，我们还会打印出一些损失统计数据，并保存一些生成的“假”样本。</p><figure class="jo jp jq jr fd js"><div class="bz dy l di"><div class="lz lu l"/></div></figure><h2 id="a7fa" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">培训损失</h2><p id="1e1e" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">这里我们将绘制发生器和鉴别器的训练损耗，在每个时期后记录。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es nb"><img src="../Images/b3907af5714a3c0b6285bba34d756d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*k_-G5yjKEGy6DUHN8zUG0g.png"/></div></figure><p id="1e78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">生成的样本</strong></p><p id="d745" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我训练了200个纪元，得到了这些结果。这些是最后一次训练的样本。你可以看到生成器能够再现像鞋子、衬衫、帽子、裙子这样的图像，因为这只是一个样本，它并不能代表这个生成器可以生成的全部图像。为了获得更好的结果，您可以调整参数，比如增加历元数，或者尝试和测试不同的优化器。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es nc"><img src="../Images/39960cb7dfa5f8834cf9df03fee3f2b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*LskZS_c-rMVGbv219aOAow.png"/></div></figure><p id="a0b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这不是结束，我发现甘斯更多。Insha Allah将很快写更多关于不同GANs架构的文章。敬请期待！</p><h2 id="b5b1" class="le ka hi bd kb lf lg lh kf li lj lk kj iq ll lm kn iu ln lo kr iy lp lq kv lr bi translated">参考资料:</h2><p id="0b6c" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">推荐大家参考我的<a class="ae jm" rel="noopener" href="/@mahamshafiq98/machine-learning-basics-524e63c8238">https://medium . com/@ mahamshafiq 98/machine-learning-basics-524 e63c 8238</a>文章作为补充资源。<a class="lx ly ge" href="https://medium.com/u/2929690a28fb?source=post_page-----971f91c666ce--------------------------------" rel="noopener" target="_blank"> Udacity </a>深度学习Nanodegree在我之前提到过的时候简要地讨论过这个话题，所以请去看看吧！</p></div></div>    
</body>
</html>