<html>
<head>
<title>Naive Bayes algorithm explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">朴素贝叶斯算法讲解</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/naive-bayes-algorithm-explained-52608add8c17?source=collection_archive---------12-----------------------#2020-04-16">https://medium.com/analytics-vidhya/naive-bayes-algorithm-explained-52608add8c17?source=collection_archive---------12-----------------------#2020-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6b10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">贝叶斯定理:</strong></p><p id="ec7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在机器学习中，我们通常对给定数据(d)选择最佳假设(h)感兴趣。在分类问题中，我们的假设(h)可能是分配给新数据实例(d)的类别。给定我们所拥有的可以用作我们关于问题的先验知识的数据，选择最可能的假设的最简单方法之一。贝叶斯定理提供了一种方法，在已知先验知识的情况下，我们可以计算假设的概率。贝叶斯定理表述为:</p><p id="d36f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中:</p><p id="9178" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> P(h|d) </strong>是假设h给定数据d的概率，这叫做后验概率。</p><p id="e1b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> P(d|h) </strong>是假设假设h为真，数据d的概率。</p><p id="cb29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> P(h) </strong>是假设h为真的概率(不考虑数据)。这叫做h的先验概率。</p><p id="8caa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> P(d) </strong>是数据的概率(不考虑假设)。</p><p id="1726" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在计算了许多diﬀerent假设的后验概率后，可以选择概率最高的假设。这是最大可能假设，可以正式称为最大后验概率(<strong class="ih hj">图</strong>)假设。这可以写成:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/9ad1db871bcf006816d4745e15c7058d.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*jvd9Qw-JEyLZEtmPfdcUVg.png"/></div></figure><p id="fbf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">朴素贝叶斯分类器</strong></p><p id="a918" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朴素贝叶斯是一种用于二元(两类)和多类分类问题的分类算法。当使用二进制或分类输入值进行描述时，该技术最容易理解。它被称为朴素贝叶斯或白痴贝叶斯，因为每个假设的概率计算都被简化了，使它们的计算易于处理。不是试图计算每个属性值P(d1，d2，d3|h)的值，而是假设它们在给定目标值的情况下是有条件独立的，并计算为P(d1|h)×P(d2|h)等等。这是一个非常强有力的假设，但在真实数据中却不太可能，也就是说，属性不会相互影响。然而，该方法在该假设不成立的数据上表现得令人惊讶地好。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/38b6de5bc56009301bab3bb631ea1f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Am5b82Ho-uPGXdlGWqGXOA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">资料组</figcaption></figure><p id="b7c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以把这个转换成数字。每个输入只有两个值，输出类变量有两个值。我们可以将每个变量转换为二进制，如下所示:</p><p id="3249" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> </em> </strong>天气:晴天= 1，雨天= 0</p><p id="1fdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">汽车:工作= 1，损坏= 0</p><p id="4180" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类别:外出= 1，留在家中= 0</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jv"><img src="../Images/f575ff7c920b0c8ede989af2539d0173.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8fuXyFYI0SYdPmfw_kIYw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">来自关于数据集的二进制数据集</figcaption></figure><p id="33e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于朴素贝叶斯模型，需要从数据集计算两种类型的量:</p><p id="f61e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类别概率。</p><p id="06c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">条件概率。</p><p id="f5d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">计算类别概率:</strong></p><p id="2c64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集是0类和1类的两类概率。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jw"><img src="../Images/f6f955b24344c214604e6f716118660d.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*5hnNqN3SCxFyFLUjZUO1tg.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">类别概率</figcaption></figure><p id="4980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">0类和1类的概率是0.5。</p><p id="b6d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算条件概率:</p><p id="8a81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">条件概率是给定每个类值时每个输入值的概率。数据集的条件概率可以计算如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jx"><img src="../Images/559fd294a64db1c1c176ff7218000e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SCfQz4zBcfe53KkMgrKfqA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">天气输入变量的条件概率</figcaption></figure><p id="59f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">天气=晴朗|班级=外出</strong> ) = 0.8</p><p id="7407" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">天气=下雨|班级=外出</strong> ) = 0.2</p><p id="8783" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">天气=晴|班=宅</strong> ) = 0.4</p><p id="1587" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">天气=下雨|班级=待在家里</strong> ) = 0.6</p><p id="8450" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样的，</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jy"><img src="../Images/9141bb9016528366523faf018fea3ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WD_sGCrf-MVPJO4l5_u1PA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">汽车输入变量的条件概率</figcaption></figure><p id="1c90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">车=工作|班=外出</strong> ) = 0.8</p><p id="50ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">车=坏|班=出门</strong> ) = 0.2</p><p id="a484" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">汽车=工作|阶级=居家</strong> ) = 0.2</p><p id="e898" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P( <strong class="ih hj">车=坏|班=宅</strong> ) = 0.8</p><p id="28c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用朴素贝叶斯进行预测</strong></p><p id="f1e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从数据集中取出第一条记录，并使用我们学习的模型来预测它属于哪个类。</p><p id="c6d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">一审:天气=晴朗，汽车=工作</strong></p><p id="b372" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">出门 = P(天气= <strong class="ih hj">晴</strong>|班= <strong class="ih hj">出门</strong>×)</p><p id="202e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(车= <strong class="ih hj">工作</strong>|班= <strong class="ih hj">出门</strong> ) × P(班= <strong class="ih hj">出门</strong>)</p><p id="5385" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">= 0.8 × 0.8 × 0.5</p><p id="73da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">= 0.32</p><p id="9079" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不出门的，不出门的</p><p id="b479" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(车= <strong class="ih hj">工作</strong>|班= <strong class="ih hj">留守</strong> ) × P(班= <strong class="ih hj">留守</strong>)</p><p id="316b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">= 0.4 × 0.2 × 0.5</p><p id="33e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">= 0.04</p><p id="6ebe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到概率0.32 &gt; 0.04，因此对于这种情况，预测是<strong class="ih hj">输出</strong>，这是正确分类。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jv"><img src="../Images/324c816180458eddae5b475d04db7fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cwu4uYjQfrvwJdKF4xMNhQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/6251a46f44dbf845f4c2b14284c6226f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*xdgq-3xxwMjPFefW-BSPiA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">准确(性)</figcaption></figure><p id="022b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用朴素贝叶斯算法获得了80%的准确率。</p></div></div>    
</body>
</html>