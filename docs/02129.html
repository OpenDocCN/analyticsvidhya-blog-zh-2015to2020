<html>
<head>
<title>Basic Architecture of Any Machine Learning/Deep Learning Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">任何机器学习/深度学习项目的基本架构</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basic-architecture-of-any-machine-learning-deep-learning-project-21e687250f22?source=collection_archive---------9-----------------------#2019-12-02">https://medium.com/analytics-vidhya/basic-architecture-of-any-machine-learning-deep-learning-project-21e687250f22?source=collection_archive---------9-----------------------#2019-12-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="14c6" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">深度学习的祈祷:第二部分</h2><div class=""/><div class=""><h2 id="761a" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">机器学习/深度学习项目管道介绍</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/10d2aea9bc81d9709cceb9a66ae59aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Vg0NSeyqLqP5_IxVXz4DQ.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">深度学习封面图片的祈祷</figcaption></figure><p id="a738" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">为了更好地理解深度学习，我们应该熟悉一些概念，如张量、张量运算、梯度下降、微分等等。我们将逐一分解这些概念。但在进入这些概念之前，让我们快速刷新一下任何深度学习/机器学习项目的总体架构。这也被称为机器学习/深度学习项目的管道。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ks"><img src="../Images/523a7a73e66733829e2c9567806bdb29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B3qb3290hvevOLjMso5k6Q.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">机器学习|深度学习管道</figcaption></figure><h2 id="2f30" class="kt ku hi bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ho bi translated">取数据</h2><p id="aa71" class="pw-post-body-paragraph jw jx hi jy b jz ln is kb kc lo iv ke kf lp kh ki kj lq kl km kn lr kp kq kr hb bi translated">获取数据仅仅意味着收集所需的数据。要收集的数据类型取决于我们参与的项目。例如，如果我们正在处理一家公司的销售预测，那么我们收集与该公司相关的历史销售数据，在这种情况下，数据将主要是文本数据。另一方面，如果你试图做一些图像分类，那么数据将是图像。</p><h2 id="0e7b" class="kt ku hi bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ho bi translated">清理/准备数据—数据预处理</h2><p id="bb02" class="pw-post-body-paragraph jw jx hi jy b jz ln is kb kc lo iv ke kf lp kh ki kj lq kl km kn lr kp kq kr hb bi translated">数据预处理是将原始数据转换为某种其他表示形式的过程，以便数据科学家和分析师可以通过机器学习/深度学习算法来运行它，以揭示见解或做出预测。</p><p id="0abb" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">现在让我们快速探索一下数据预处理的步骤。</p><p id="82db" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated"><strong class="jy hs">处理空值</strong></p><p id="a1ed" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在现实世界的数据中，会有一些由于各种原因导致数据缺失的情况。这可能是由于数据损坏、数据无效或无法加载数据等原因造成的。处理这种丢失的值是一个重要的挑战，因为机器学习模型的质量取决于我们如何处理这些损坏的数据。</p><p id="47d8" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">有各种方法来处理这个问题。最简单的方法是删除包含空值的行。</p><p id="8b48" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated"><em class="ls">用于演示该示例的数据集取自</em><a class="ae lt" href="https://www.geeksforgeeks.org/ml-handling-missing-values/" rel="noopener ugc nofollow" target="_blank"><em class="ls">【geeksforgeeks.org】</em></a></p><div class="jh ji jj jk fd ab cb"><figure class="lu jl lv lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/e5775b58428d896c648bc693d1777159.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*awUGl8Syejxas5KHd2XkXA.png"/></div></figure><figure class="lu jl ma lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/8a244ed515c1690d6a24578f001a3e26.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*PJq0hNTsJZ81Wr9VKiscwg.png"/></div></figure><figure class="lu jl mb lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/dc55f1be7b032fea0906c0cbe9c55386.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*EhDJecD4cD79p9gPNq7e3Q.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx mc di md me translated"><strong class="bd kv">图1 </strong>:导入数据| <strong class="bd kv">图2 </strong> : isnull() —返回一个布尔矩阵，如果值为NaN，则返回True，否则返回False | <strong class="bd kv">图3 </strong> : dropna() —删除所有包含空值的行</figcaption></figure></div><p id="7f5d" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">图3 —我们使用dropna()删除空值行。</p><p id="547a" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我们还可以使用带有各种参数的dropna()来删除包含空值的列，删除列和行，或者删除特定的阈值，等等。更多信息请参考链接:<a class="ae lt" href="https://www.geeksforgeeks.org/python-pandas-dataframe-dropna/#:~:targetText=Pandas%20dropna()%20method%20allows,Null%20values%20in%20different%20ways.&amp;targetText=Parameters%3A,or%20'columns'%20for%20String." rel="noopener ugc nofollow" target="_blank"> dropna()用法</a></p><p id="d318" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">删除空值似乎很容易，但这不是最佳选择，因为删除行和列会导致重要信息的丢失。所以处理这个问题的另一种方法是用一些方法来替代丢失的值。这个替代缺失值的过程称为<strong class="jy hs">插补。</strong></p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mf"><img src="../Images/79c48f9cb2d9d13a11d357a9b7a2d995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*F7-li-nUtwgTpc90t_nWwA.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd kv">图4: </strong>估算器用法|缺失值由列值的平均值替代。</figcaption></figure><h2 id="a8e3" class="kt ku hi bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ho bi translated">标准化</h2><p id="b9ea" class="pw-post-body-paragraph jw jx hi jy b jz ln is kb kc lo iv ke kf lp kh ki kj lq kl km kn lr kp kq kr hb bi translated">标准化是重新调整一个或多个属性的过程，使平均值为0，标准差为1。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mg"><img src="../Images/91f743b43e5e1ab0d37b436ed87c4c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*BxUvof8Wv1B9zn8qwCS9Ew.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd kv">图5 </strong></figcaption></figure><p id="e978" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在图5中，让我们考虑列<em class="ls">年龄</em>和S <em class="ls">薪水</em>因为它们不在同一个刻度上，并且<em class="ls">薪水</em>总是大于年龄<strong class="jy hs">，机器学习算法给予<em class="ls">薪水</em>更多的重要性。这可能会产生问题，因为年龄也是一个重要因素</strong>。因此，为了解决这个问题，我们使用标准化。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mh"><img src="../Images/1d428641cbce9eb0d992b427384221d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*81CkWO_ptmBjWwdLNco-zg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd kv">图6: </strong>标准化公式</figcaption></figure><p id="3682" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">为了标准化变量，我们计算变量的平均值和标准差。然后，对于变量的每个观察值，我们减去平均值并除以标准差。</p><pre class="jh ji jj jk fd mi mj mk ml aw mm bi"><span id="7685" class="kt ku hi mj b fi mn mo l mp mq">from sklearn.preprocessing import StandardScalerfrom sklearn.model_selection import train_test_split<br/>import pandas as pd</span><span id="8c70" class="kt ku hi mj b fi mr mo l mp mq">data_sets = pd.read_csv(‘Data.csv’)</span><span id="099d" class="kt ku hi mj b fi mr mo l mp mq">data_sets = data_sets.values</span><span id="dbe0" class="kt ku hi mj b fi mr mo l mp mq">std = StandardScaler()<br/>X = data_sets[:, 0:3]<br/>y = data_sets[:, 3:]</span><span id="5d71" class="kt ku hi mj b fi mr mo l mp mq">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)</span><span id="c4f4" class="kt ku hi mj b fi mr mo l mp mq">X_train[:,1:3] = std.fit_transform(X_train[:,1:3])<br/>X_test[:,1:3] = std.transform(X_test[:,1:3])</span><span id="3171" class="kt ku hi mj b fi mr mo l mp mq">print(X_train)<br/>print()<br/>print(X_test)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es ms"><img src="../Images/846a62cae461a7004ee809c73dc71cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*PKSm04bR5gZV9t47TecbSQ.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd kv">图7 </strong>:上述代码片段的输出</figcaption></figure><blockquote class="mt mu mv"><p id="2edb" class="jw jx ls jy b jz ka is kb kc kd iv ke mw kg kh ki mx kk kl km my ko kp kq kr hb bi translated"><strong class="jy hs">注</strong></p><p id="fe0e" class="jw jx ls jy b jz ka is kb kc kd iv ke mw kg kh ki mx kk kl km my ko kp kq kr hb bi translated"><strong class="jy hs">来源:</strong><a class="ae lt" href="https://datascience.stackexchange.com/questions/12321/difference-between-fit-and-fit-transform-in-scikit-learn-models#:~:targetText=In%20summary%2C%20fit%20performs%20the,in%20one%20possibly%20optimized%20step." rel="noopener ugc nofollow" target="_blank">https://datascience.stackexchange.com/</a></p><p id="2a4b" class="jw jx ls jy b jz ka is kb kc kd iv ke mw kg kh ki mx kk kl km my ko kp kq kr hb bi translated"><strong class="jy hs">scikit _ learn模型中fit和fit_transform的区别？</strong></p><p id="1b9b" class="jw jx ls jy b jz ka is kb kc kd iv ke mw kg kh ki mx kk kl km my ko kp kq kr hb bi translated">为了使数据居中(使其具有零平均值和单位标准误差)，您减去平均值，然后将结果除以标准偏差。</p><p id="0854" class="jw jx ls jy b jz ka is kb kc kd iv ke mw kg kh ki mx kk kl km my ko kp kq kr hb bi translated">你可以在训练数据集上这样做。但是之后你必须将同样的转换应用到你的测试集(例如，在交叉验证中)，或者在预测之前应用到新获得的例子。但是您必须使用用于对训练集进行居中的相同的两个参数μμ和σσ(值)。</p><p id="aad7" class="jw jx ls jy b jz ka is kb kc kd iv ke mw kg kh ki mx kk kl km my ko kp kq kr hb bi translated">因此，每个sklearn的变换<code class="du mz na nb mj b"><em class="hi">fit()</em></code>只是计算参数(例如在<a class="ae lt" href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html" rel="noopener ugc nofollow" target="_blank">标准缩放器</a>的情况下的μμ和σσ)并将它们保存为内部对象状态。之后，您可以调用它的<code class="du mz na nb mj b"><em class="hi">transform()</em></code>方法来将转换应用到一组特定的例子中。<code class="du mz na nb mj b"><em class="hi">fit_transform()</em></code>将这两个步骤结合起来，用于训练集xx上参数的初始拟合，但它也返回一个变换后的x′x′。在内部，它只是对相同的数据先调用<code class="du mz na nb mj b"><em class="hi">fit()</em></code>，然后调用<code class="du mz na nb mj b"><em class="hi">transform()</em></code>。</p></blockquote><h2 id="8cae" class="kt ku hi bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ho bi translated">一键编码</h2><p id="6357" class="pw-post-body-paragraph jw jx hi jy b jz ln is kb kc lo iv ke kf lp kh ki kj lq kl km kn lr kp kq kr hb bi translated">一种热编码是将分类变量转换成一种形式的过程，这种形式可以提供给ML算法，以便在预测中做得更好。</p><div class="jh ji jj jk fd ab cb"><figure class="lu jl nc lw lx ly lz paragraph-image"><img src="../Images/62ca695c4550a453a865c1d65e19a416.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*yw1WukgSLG9dMO6suKhVSQ.png"/></figure><figure class="lu jl nd lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/f3700ad280b478d11f9b3a3e13817b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*h0qI7VQSVmD7Yyt-o81JXg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx ne di nf me translated"><strong class="bd kv">图8 |图9 </strong></figcaption></figure></div><p id="ee06" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">图8 —假设我们的数据集包含一列<em class="ls"> Company。</em>在该列中，列出了不同公司的名称，这是分类数据。我们的机器学习算法不理解这些类型的分类数据。因此，解决这个问题的一个方法是将公司名称编码成如图9所示的值。但是这种编码方式产生了另一个问题。考虑上述情况，<strong class="jy hs">由于<em class="ls">小米</em>是用更高的值编码的，这意味着机器学习算法给予该类别</strong>更大的重要性。这个问题的解决方案是一个热编码。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ng"><img src="../Images/b679fa89b8ff47edd5f306ca78b68ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PyJUEjPPQ1SsNUlz6tz_Gw.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd kv">图10: </strong>一个热编码表示</figcaption></figure><p id="2253" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">如图10所示，我们将每个类别值转换成列，每当需要该类别时，我们给值1，如果不需要，给值0。我们将在另一篇文章中讨论这样做的实际方法。</p><h2 id="3ffd" class="kt ku hi bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ho bi translated">培训模型/评估模型/部署模型</h2><p id="7d2c" class="pw-post-body-paragraph jw jx hi jy b jz ln is kb kc lo iv ke kf lp kh ki kj lq kl km kn lr kp kq kr hb bi translated">训练模型是将获得的数据应用于机器学习/深度学习算法并从中生成推理的过程。一旦我们训练了模型，这些模型将被评估，以确保我们的模型正确地学习了东西。最后，如果模型按预期执行，那么我们就部署模型。</p><p id="20ff" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">让我们结束这篇文章。在本文的下一部分，我们将更多地讨论深度学习的基本构建模块。</p><h2 id="addc" class="kt ku hi bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ho bi translated">参考</h2><ol class=""><li id="dfa6" class="nh ni hi jy b jz ln kc lo kf nj kj nk kn nl kr nm nn no np bi translated"><a class="ae lt" href="https://www.datarobot.com/wiki/data-preparation/" rel="noopener ugc nofollow" target="_blank">什么是机器学习的数据准备？</a></li><li id="bd1b" class="nh ni hi jy b jz nq kc nr kf ns kj nt kn nu kr nm nn no np bi translated"><a class="ae lt" href="https://www.geeksforgeeks.org/data-preprocessing-machine-learning-python/" rel="noopener ugc nofollow" target="_blank">Python中机器学习的数据预处理</a></li><li id="ec11" class="nh ni hi jy b jz nq kc nr kf ns kj nt kn nu kr nm nn no np bi translated"><a class="ae lt" href="https://www.geeksforgeeks.org/ml-handling-missing-values/" rel="noopener ugc nofollow" target="_blank">处理缺失值</a></li><li id="78ae" class="nh ni hi jy b jz nq kc nr kf ns kj nt kn nu kr nm nn no np bi translated"><a class="ae lt" href="https://www.geeksforgeeks.org/python-pandas-dataframe-dropna/#:~:targetText=Pandas%20dropna()%20method%20allows,Null%20values%20in%20different%20ways.&amp;targetText=Parameters%3A,or%20'columns'%20for%20String." rel="noopener ugc nofollow" target="_blank">python-熊猫-数据框-dropna </a></li><li id="7e87" class="nh ni hi jy b jz nq kc nr kf ns kj nt kn nu kr nm nn no np bi translated"><a class="ae lt" href="https://www.ritchieng.com/machinelearning-one-hot-encoding/" rel="noopener ugc nofollow" target="_blank">sci kit-Learn中的一个热门编码</a></li><li id="ddb7" class="nh ni hi jy b jz nq kc nr kf ns kj nt kn nu kr nm nn no np bi translated"><a class="ae lt" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" rel="noopener ugc nofollow" target="_blank"> OneHotEncoder-Sklearn </a></li><li id="e8d0" class="nh ni hi jy b jz nq kc nr kf ns kj nt kn nu kr nm nn no np bi translated"><a class="ae lt" href="https://www.geeksforgeeks.org/ml-one-hot-encoding-of-datasets-in-python/" rel="noopener ugc nofollow" target="_blank">在python中对数据集进行ml-one-hot-encoding</a></li></ol></div></div>    
</body>
</html>