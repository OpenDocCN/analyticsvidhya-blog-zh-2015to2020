# 模拟人生 4 现代 Python 改造:第二部分——Hello World

> 原文：<https://medium.com/analytics-vidhya/the-sims-4-modern-python-modding-part-2-hello-world-77c5bfd3ce4e?source=collection_archive---------0----------------------->

在这一部分中，我们将创建一个 mod，将 Hello World 打印到控制台。这可以让你熟悉编写代码并将其转换成可以在游戏中运行的 mod 的过程。它还让您熟悉了我们在第 1 部分中反编译过的 Sims 4 python 库，我简单地谈了一下。

这部分假设你已经完成了第 1 部分，如果没有，你需要通读并浏览[第 1 部分](/@junebug12851/the-sims-4-modern-python-modding-part-1-setup-83d1a100c5f6)。

## 我们能做的最简单的程序

让我们做一个过于普通的只有 6 行的“Hello World”程序。当你输入一个命令的时候，这个程序会向作弊控制台输出单词“Hello World”。

## 模拟人生 4 mods 的 python 脚本的残酷现实

注意上一段的几个关键词——“输出”、“欺骗控制台”、“命令”。为了制作一个 mod，你需要知道制作什么，并阅读 e a 给你的官方文档和代码注释…除了 EA 是极少数决定不给你任何帮助、注释、文档或代码来使用他们的 mod 系统的公司之一，所以你只能在晦涩难懂的文件和代码中搜寻，你能做的只有文件的名称，并浏览复杂晦涩的内容来尝试弄清楚它是如何工作的。

知道这一点很重要，因为这是模拟人生 4 的全部 python 脚本。你完全靠自己，除了在论坛上四处询问并希望得到一个好的答案或根本没有答案，你没有任何事情可做，做最简单的事情可能需要几个小时来挖掘晦涩的文件和数百行代码，试图弄清楚事情的意义。

## 找到 Hello World mod 的各个部分

谢天谢地，我可以引导你通过最初的水域找到你需要的信息，并把这个模块。我们想做的第一件事是允许我们通过作弊控制台与我们的脚本进行交互，所以这是一个起点。

在我在第 1 部分提到的 3 个文件夹中，您认为哪个会存放这样的代码。

*   **会不会是基地？**不，记得 base 里有数百个类似于写 4 页纸的让你的朋友递给你一个苹果的小说明。对于基本文件夹来说，使用作弊控制台可能是一项太大的工作。但是不要排除这种可能性，总有可能你猜错了。
*   **会不会是地核？可能不会，它包含了更大的东西，但它们通常都是通用的，与游戏性没有特别的联系。**
*   **会不会是仿真？这是我的第一个猜测。一个作弊控制台是专门与游戏和模拟房子游戏特定的代码，所以我们可能应该看看那里。**

更好的是，因为我们确切地知道我们在寻找什么。让我们搜索所有的文件夹和文件来节省时间。浏览文件对探索和获得想法很有帮助，但在其他情况下，搜索可以节省很多时间。

![](img/9207d9f2b3a89dd5c7706473604cda1f.png)

所以我发现了一些有趣的东西。有很多情况下，看起来像是分散的代码注册欺骗代码。你看到了吗

`@ sims4.commands.Command(‘…’, …`

这是散落在整个模拟人生 4 代码库，显然这是你如何注册一个作弊代码。这很令人兴奋，因为我们想做的第一步看起来很简单，不像我想象的那么复杂。

让我们跟随`sims4.commands.Command`回到它的原始文件。这将是我们需要去的地方，或者至少是一个好的起点。

![](img/5e6495f04df11a75ef9ddf0ef9b57cd2.png)

所以事情发生了有趣的转变。当我们在上面猜测时，我们已经排除了“核心”，但它实际上在“核心”之下。虽然不了解细节，也可能无法得知，但一个理论是先装“基”后装“芯”，再装“仿真”。如果是这样的话,“欺骗能力”在“核心”中是有意义的，因为“模拟”依赖于它。只是猜测而已。

更重要的是，这就是为什么如果你在寻找某样特定的东西，总是去寻找它。这使我们免于查看错误的文件夹。

因此，在这个文件中，我们看到了我们来这里的目的

`def Command(*aliases, command_type=CommandType.DebugOnly, …`

我们有`aliases` ,这是作弊名称，我们在作弊控制台中键入什么，命令类型，我们可以推测这可能是什么，只是需要四处查看才能弄清楚这些东西。

为了加快速度，我将分享我从阅读这篇文章和阅读其他人发表的文章中学到的东西。

## 将这一切结合在一起

```
import sims4.commands

@sims4.commands.Command('hellow', command_type=sims4.commands.CommandType.Live)
def sayhello(_connection=None):
    output = sims4.commands.CheatOutput(_connection)
    output('Hello World')
```

让我们一步步来

```
import sims4.commands
```

这将导入我们在上面发现的文件，允许我们注册一个新命令。

```
@sims4.commands.Command('hellow', command_type=sims4.commands.CommandType.Live)
def sayhello(_connection=None):
```

上面写着“注册一个名为‘hellow’的命令来运行下面的代码”。我们还说这个命令是“Live”类型的(您可以在文件的顶部找到不同的命令类型)。我不完全确定细节，但我相信这意味着它可以在现场模式下运行，不需要测试作弊。我需要进一步研究代码来寻找答案。

`_connection=None`当玩家输入作弊代码时，游戏会运行你的作弊代码。它传递玩家在那之后输入的任何额外信息和一个数字。`_connection`是那个数字。知道数字是什么并不重要，但重要的是拥有那个数字，这样它就可以用来向作弊控制台写入文本，这正是我们下面要做的。

我们默认`_connection`到`None`，你可能知道`None`不是一个数字，那么我们为什么要这样做呢？因为我们希望你的 mod 在没有给出数字的情况下崩溃？为什么？因为如果没有给出一个数字，那么某个地方就真的出问题了。那里应该总是有一个数字，所以即使我们编造了一个数字而不是`None`，你的 mod 仍然会崩溃，因为一个有效的数字从未被给出。如果它崩溃是因为`_connection`是`None`而不是一个虚构的数字，那么当你查看崩溃报告时，你可以确切地看到发生了什么，或者更具体地说，什么没有发生。它让您知道从哪里开始调试。每次调用你的作弊软件时都应该是一个数字。

```
output = sims4.commands.CheatOutput(_connection)
```

我们想在作弊控制台上打印一条消息，在深入研究了同一个文件之后，我们可以看到有一种方法可以通过一个名为`CheatOutput`的代码来实现。调用它会返回一个函数，我们可以调用这个函数来完成这个任务。

```
output('Hello World')
```

最后，我们到达我们的目标，并打印“Hello World”到控制台。

## 你怎么知道这些的？

好吧，这并不容易，大部分都要归咎于 EA 处理其改装平台的方式。正如我上面所说的，你要么在社区中四处打听，要么在你反编译的库代码中挖掘。最终你可能会也可能不会找到答案。

不要催促自己，也不要承担太大的项目。从小处着手，一步一步来。这是非常复杂和庞大的，你输入了一个巨大的代码库，没有文档或代码注释，在线信息也很少。承担太大的任务只会让你不知所措。

## 我们怎么把这个放进游戏里？

这出奇的简单，然而网上关于这方面的信息却很少。

我在这里写了一个关于它的教程[但是本质上你可以做两个选项中的一个:](/@junebug12851/the-sims-4-modern-python-modding-ultimate-loading-guide-77ce1b68f1e7)

*   使用 3.7 版本编译 python 文件，并将`py`和`pyc`文件打包在一个 zip 文件夹中，例如`Mods/HelloWorld.zip`。你也可以将`zip`重命名为`ts4script`，因为这是同样的事情，大多数玩家都希望看到一个`ts4script`文件`Mods/HelloWorld.ts4script`
*   或者在`Mods`下创建一个 mods 文件夹，在这个文件夹下有一个`Scripts`文件夹，你可以把你的`py`文件放在里面进行测试，就像这样`Mods/HelloWorld/Scripts/main.py`

如上所述，所有这些在上面的链接中都有解释。让我们选择编译它，我们将把它保存为一个 zip 文件，因为它实际上并没有被发布，所以它将节省我们一个步骤。

## 你是怎么编译的？

1.  跑`py_compile <mod name>.py`。因为我没有使用 Windows 路径，所以我使用了`C:\python37\python.exe -m py_compile <mod name>.py`。如上所述，确保您使用的是 Python 3.7。
2.  运行之后，python 将它编译成位于 __pycache__ 内的一个`pyc`文件。

![](img/07a4cced7c7b96809014fd8b280a7766.png)

3.将编译后的文件复制到 __pycache__ 中。它应该以`cpython-37.pyc`结尾，确保它确实以此结尾。

![](img/d7fd767085470451f286d6f4a9da8e7f.png)

4.你可以重新命名它，去掉`cpython-37`部分，删除文件夹，虽然把它留在那里会更快，因为它不会伤害任何东西。

![](img/c5f0e8739323cfb00e67a0dca9555c37.png)

5.压缩`py`和`pyc`文件

![](img/7ad796821859f9b80c4d2170bb396697.png)

6.现在只需将它复制到你游戏的 mods 文件夹中，如上所述，你可以将`zip`重命名为`ts4script`，但这只是增加了一个额外的步骤，在开发中是不必要的。

![](img/17d2a1fe10a09fc6234494e655b7a145.png)

7.启动游戏，在实时模式下输入一个模拟人生，并测试它(不小心在快照 lol 中输入了两次，忽略重复的行，因为这不是编程的错误。)

![](img/a8b47970368b859a9ec0ea161b872eb7.png)

## 其他提示:

1.  不要检查游戏设置来看你的 mod 是否列在那里，作为一种手段来看你的 mod 是否制作正确。你可以在那里放一个名为`EmptyMod.zip`的空 zip 文件，它将在游戏中显示为`EmptyMod`，看起来完全有效，即使它里面没有文件，所以它不可能是正确或有效的。

![](img/ac9730f6182bfc1fac1b4b59fe9c3c66.png)

2.你的 mod 可能只在有一个家庭在上面玩的时候才起作用，试图在城镇/城市屏幕上测试 mod 以使测试更快可能不起作用，这可能是原因，而不总是你的 mod 的错。

![](img/df3b446077743f2afa526a7e8e448a7d.png)

3.没有调试，测试是痛苦的。如果有一个在开发中经常发生的错误，你唯一的选择就是把它记录在作弊控制台中。如果这不起作用，那么你就需要找出原因。据我所知，没有调试，每次你想测试一个变化，你必须退出游戏，重新编译，重新压缩，重新放置在游戏中，重新开始游戏，也重新进入模拟人生。这很痛苦，但这是过程的一部分。你当然可以用脚本在一定程度上实现自动化，但这仍然是一个大问题。

编辑:现在 Sigma1202 发现了调试，他们在这里发布了一个[视频](https://www.youtube.com/watch?v=RBnS8m0174U)。如果你正在使用它，我在我的样板模板中自动处理了它，并在这里发布了一个关于它的[教程](/swlh/the-sims-4-modern-python-modding-debugging-3736b37dbd9f)。唯一已知的方法是通过 PyCharm Pro，不幸的是，这是要花钱的。在所有其他情况下，我们没有办法在 PyCharm Pro 之外调试 mod。

## 第 2 部分结束

我知道这些超级简单，但这一切都相当复杂，你需要慢慢来，以确保你理解一切。

我们已经完成了所有的要点，用你目前所知道的来玩，游手好闲，因为这是最好的学习方式。浏览文件，通读代码，尝试脑海中出现的随机想法。阅读任何人在网上写的东西都会对你有很大的帮助，但是你是唯一一个可以从教程走向独立并对修改充满信心的人。

## 我建议建立一个工作流程

我真的建议现在设置一个工作流，我们将进入本系列的其他教程，所以继续使用 PowerShell 等可能不太方便。如果你对我的项目模板感兴趣，现在将是一个更好的时间来使用它，因为你知道如何自己做事情的基础。项目模板可以与任何编辑器一起工作，而不仅仅是 PyCharm，它包含了许多脚本来使事情变得更加简单和高效。

关于它的教程是[这里](/@junebug12851/the-sims-4-modern-python-modding-part-5-project-template-c9ffee48ab4e)。

如果你对我的项目模板不感兴趣，那么我建议你使用别人的或者设计你自己的模板，只是为了让事情简单、直接和容易。

## 进入下一部分？

请务必访问下一部分，[第 3 部分](/@junebug12851/the-sims-4-modern-python-modding-project-1-random-pitch-2371b79c0bcc)，它将教你如何完全替换现有代码。一个简单但有用的技能，可以真正拓宽你的改装能力。