<html>
<head>
<title>Deploying a Machine Learning Model as a Flask App on Heroku -Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Heroku上部署机器学习模型作为Flask应用程序-第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploying-a-machine-learning-model-as-a-flask-app-on-heroku-part-1-b5e194fed16d?source=collection_archive---------10-----------------------#2020-02-25">https://medium.com/analytics-vidhya/deploying-a-machine-learning-model-as-a-flask-app-on-heroku-part-1-b5e194fed16d?source=collection_archive---------10-----------------------#2020-02-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1ece3247cfc3afcae4f1b8cc0f428bc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B132bADMyb_SJaJ8"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@codytdavis?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">戴维斯科</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="3e04" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为一名数据科学家，我确信你一定在某个时候想过将你的模型的结果传达给其他人。好吧，如果还没有，你就在正确的地方，因为本教程会给你关于这样做的知识。作为一名数据科学家，向您的主管或技术人员传达您的结果以进行评估可能不成问题，因为这非常简单——您只需将模型保存到磁盘或与他人共享您的Jupyter笔记本。</p><p id="c7c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你不得不把你的成果分享给一个很少或没有专业技能的人，也许是一个你认为可能会对你的工作印象深刻的朋友或同事。你如何着手做这件事？。当然，考虑到这一点，我们需要某种接口在它们和你的工作或某种网络应用之间进行交流。这个听起来还不错吧:)？</p><p id="a82b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">本教程将分为两部分:</strong></p><ol class=""><li id="7d2e" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">开发一个可以部署的简单模型，用户可以使用Flask(python中的一个微web框架)创建web应用程序，与它进行交互以获得预测。</li><li id="f7af" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">在Heroku平台上部署我们最终的web应用程序。</li></ol><p id="b55d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">网上有一些教程也是为了同样的目的，为了让学习者尽可能的直接，我会尽量把你需要知道的每一个重要细节都写得简短。</p><p id="ee31" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将部署的模型基于sci-kit的学习葡萄酒质量数据集。我们的模型将根据每种葡萄酒的给定化学指标来预测葡萄酒的质量。然而，您可以部署任何您喜欢的模型。</p><h1 id="6328" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="ak">要求</strong></h1><p id="435e" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">安装以下软件。简单地安装它们</p><ul class=""><li id="e828" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js lk jz ka kb bi translated">Python 3.6</li><li id="1f6d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js lk jz ka kb bi translated">瓶</li><li id="0e3c" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js lk jz ka kb bi translated">熊猫</li><li id="d252" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js lk jz ka kb bi translated">Sklearn</li></ul><p id="f15c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最终web应用程序的源代码可以在https://github.com/oluakintoye/wine-qual.git的Github上找到</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h1 id="a86e" class="kh ki hi bd kj kk ls km kn ko lt kq kr ks lu ku kv kw lv ky kz la lw lc ld le bi translated">创建部署模型</h1><p id="ca1d" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">在您首选的IDE上:</p><p id="e4b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将从sci-kit学习库中加载葡萄酒数据</p><p id="062c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在[1]中:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="6f9d" class="mg ki hi mc b fi mh mi l mj mk"><strong class="mc hj">import </strong>pandas <strong class="mc hj">as </strong>pd<br/><strong class="mc hj">import </strong>numpy <strong class="mc hj">as </strong>np<br/><strong class="mc hj">from </strong>sklearn.datasets <strong class="mc hj">import </strong>load_wine<br/><br/>wine = load_wine()<br/><br/>data = pd.DataFrame(data= np.c_[wine[<strong class="mc hj">'data'</strong>], wine[<strong class="mc hj">'target'</strong>]],<br/>                     columns= wine[<strong class="mc hj">'feature_names'</strong>] + [<strong class="mc hj">'target'</strong>])<br/>data.head()</span></pre><p id="6a48" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Out[1]:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/5d9f0819ea7628417627c14279e2b9a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*3JmxWv4z6nOfwetS7wGkHQ.jpeg"/></div></figure><h2 id="1360" class="mg ki hi bd kj mm mn mo kn mp mq mr kr jg ms mt kv jk mu mv kz jo mw mx ld my bi translated"><strong class="ak">数据统计和预处理:</strong></h2><p id="6d12" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我们将观察数据的细节，并对其进行检查，以了解预处理数据的正确步骤。我们想要预测的变量是目标(葡萄酒质量),我们将使用这些特征来实现。</p><p id="c352" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在[2]中:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="e323" class="mg ki hi mc b fi mh mi l mj mk">data.info()</span></pre><p id="38d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Out[2]:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/88c8dcb65b4bf0c8e6b4f9721549abce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*KsVpVZyLI2WNnx1h5HBJbg.jpeg"/></div></figure><p id="d8dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在[3]中:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="cebf" class="mg ki hi mc b fi mh mi l mj mk">data.describe()</span></pre><p id="66f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Out[3]:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/78242f061f361ba11b7185fa7a898b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SnOkDCigYHOANKn5ND5kQw.jpeg"/></div></div></figure><p id="992f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们观察上面输出中显示的各种统计数据，这些数据没有足够数据类型的空值，并且足够规范化以执行我们的预测。</p><h2 id="4f41" class="mg ki hi bd kj mm mn mo kn mp mq mr kr jg ms mt kv jk mu mv kz jo mw mx ld my bi translated"><strong class="ak">训练模型:</strong></h2><p id="e6bc" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">在[4]中:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="faa2" class="mg ki hi mc b fi mh mi l mj mk"><strong class="mc hj">from </strong>sklearn.linear_model <strong class="mc hj">import </strong>LogisticRegression<br/><strong class="mc hj">from </strong>sklearn.model_selection <strong class="mc hj">import </strong>train_test_split<br/><br/>X = data.iloc[:, :-1]<br/>y = data.iloc[:, -1]<br/><br/><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=0)<br/><br/><br/>clf = LogisticRegression()<br/>clf = clf.fit(X_train,y_train)<br/><br/>clf</span></pre><p id="2d95" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Out[4]:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/28e64387df44042a7c8fe4997e32970b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*Qb90eTqcmcDkyUUY6ImPiQ.jpeg"/></div></figure><p id="85e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将通过查看准确性来快速评估训练好的模型</p><p id="d4f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在[5]中:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="d78f" class="mg ki hi mc b fi mh mi l mj mk"><strong class="mc hj">from </strong>sklearn.metrics <strong class="mc hj">import </strong>accuracy_score<br/><br/>y_pred = clf.predict(X_test)<br/><br/>print(<strong class="mc hj">"accuracy_score: %.2f" </strong>% accuracy_score(y_test, y_pred))</span></pre><p id="a78f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Out[5]:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/1930cc1e9ed26458401c332d70dea255.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*DTLSiNaK8MFxEM3jcbcowA.jpeg"/></div></figure><h2 id="ee14" class="mg ki hi bd kj mm mn mo kn mp mq mr kr jg ms mt kv jk mu mv kz jo mw mx ld my bi translated"><strong class="ak">设置我们的模型准备部署</strong></h2><p id="d6a0" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我们将使用Pickle保存我们的模型，以便在以后需要进行预测时重新加载。点击阅读更多关于泡菜<a class="ae iu" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="3c56" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在[6]中:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="9a4a" class="mg ki hi mc b fi mh mi l mj mk">import pickle</span><span id="e486" class="mg ki hi mc b fi nd mi l mj mk">path=<strong class="mc hj">'./lib/models/LogisticRegression.pkl'<br/><br/>with </strong>open(path, <strong class="mc hj">'wb'</strong>) <strong class="mc hj">as </strong>file:<br/>    pickle.dump(clf, file)</span></pre><h1 id="9e00" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">用Flask创建web应用程序</h1><p id="56d3" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">Flask是一个用python编写的microweb框架，它允许你非常快速和容易地构建web应用程序和网站。它是轻量级的，因为它不需要太多的样板代码来设置它。如果你是flask的新手，你可以上tutorialspoint <a class="ae iu" href="https://www.tutorialspoint.com/flask/index.htm" rel="noopener ugc nofollow" target="_blank">这里</a>上的快速flask教程。我们将需要以下内容来设置web应用程序，例如:</p><ul class=""><li id="f37f" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js lk jz ka kb bi translated">flask将呈现的HTML或web模板。这允许用户输入他们自己的数据并显示结果</li><li id="ba3b" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js lk jz ka kb bi translated">python脚本将加载我们的模型，并从web表单获取用户输入，进行预测并返回结果。</li></ul><p id="8746" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">应用程序目录的结构如下:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/a9eb39f159c1bf136d079dc0b5f76f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*vWLJWEz2_kkadgGiKB7-Kw.jpeg"/></div></figure><h2 id="539a" class="mg ki hi bd kj mm mn mo kn mp mq mr kr jg ms mt kv jk mu mv kz jo mw mx ld my bi translated">app.py</h2><p id="a993" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">这是我们web应用程序的核心。这里的代码包含用于捕获和处理用户输入、运行flask development web服务器、渲染模板的信息，也是在Heroku服务器上运行的内容。</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="7240" class="mg ki hi mc b fi mh mi l mj mk"><strong class="mc hj">from </strong>flask <strong class="mc hj">import </strong>Flask, render_template<br/><br/>app = Flask(__name__)<br/><br/>@app.route(<strong class="mc hj">'/'</strong>)<br/><strong class="mc hj">def </strong>main():<br/>    <strong class="mc hj">return</strong>(render_template(<strong class="mc hj">'main.html'</strong>))<br/><br/><br/><strong class="mc hj">if </strong>__name__ == <strong class="mc hj">'__main__'</strong>:<br/>    app.run()</span></pre><p id="0104" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在flask中，根据您定义的路由，URL被路由到不同的函数。</p><p id="33af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们运行这个脚本，我们将看到转到我们的基本URL( http://127.0.0.1:5000/)将触发main函数，我们的main.html页面将会显示出来。现在我们的main.html页面是空的，所以让我们尝试用一些东西填充主体，然后再次运行我们的app.py脚本来看看结果。</p><h2 id="eb8a" class="mg ki hi bd kj mm mn mo kn mp mq mr kr jg ms mt kv jk mu mv kz jo mw mx ld my bi translated"><strong class="ak">main.html</strong></h2><p id="4e9d" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我们将在html文件的主体中添加一个标签来显示欢迎消息</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="35b9" class="mg ki hi mc b fi mh mi l mj mk">&lt;!DOCTYPE <strong class="mc hj">html</strong>&gt;<br/>&lt;<strong class="mc hj">html lang="en"</strong>&gt;<br/>&lt;<strong class="mc hj">head</strong>&gt;<br/>    &lt;<strong class="mc hj">meta charset="UTF-8"</strong>&gt;<br/>    &lt;<strong class="mc hj">title</strong>&gt;&lt;/<strong class="mc hj">title</strong>&gt;<br/>&lt;/<strong class="mc hj">head</strong>&gt;<br/>&lt;<strong class="mc hj">body</strong>&gt;<br/>    &lt;<strong class="mc hj">h1</strong>&gt;Welcome!!!&lt;/<strong class="mc hj">h1</strong>&gt;<br/>&lt;/<strong class="mc hj">body</strong>&gt;<br/>&lt;/<strong class="mc hj">html</strong>&gt;</span></pre><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es nf"><img src="../Images/94fc48c7cd02f067ff2e1038ef3e985b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*h3n0BSMmcQ1zRPVBqY1qCQ.jpeg"/></div></figure><p id="09cc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们的模板正在渲染，让我们做以下事情:</p><ol class=""><li id="f47e" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">编辑我们的app.py脚本来加载模型、捕获和处理输入以给出预测</li><li id="77bd" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">编辑main.html有一个表单，获得我们需要的用户输入，并提交显示适当的预测</li></ol><p id="793b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">值得注意的是，对flask web框架的良好了解对于理解代码非常重要，如果需要，请参考<a class="ae iu" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank"> flask文档</a>。</p><h2 id="421a" class="mg ki hi bd kj mm mn mo kn mp mq mr kr jg ms mt kv jk mu mv kz jo mw mx ld my bi translated">编辑app.py</h2><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="14e3" class="mg ki hi mc b fi mh mi l mj mk"><strong class="mc hj">from </strong>flask <strong class="mc hj">import </strong>Flask, render_template, request<br/><strong class="mc hj">import </strong>pandas <strong class="mc hj">as </strong>pd<br/><strong class="mc hj">import </strong>pickle<br/><br/>app = Flask(__name__)</span><span id="c680" class="mg ki hi mc b fi nd mi l mj mk"># Loading the Pre-trained model using Pickle<br/><strong class="mc hj">with </strong>open(<strong class="mc hj">'./lib/models/LogisticRegression.pkl'</strong>, <strong class="mc hj">'rb'</strong>) <strong class="mc hj">as </strong>file:<br/>    model = pickle.load(file)<br/><br/>@app.route(<strong class="mc hj">'/'</strong>, methods=[<strong class="mc hj">'GET'</strong>, <strong class="mc hj">'POST'</strong>])<br/><strong class="mc hj">def </strong>main():<br/>    <strong class="mc hj">if </strong>request.method == <strong class="mc hj">'GET'</strong>:<br/>        <strong class="mc hj">return</strong>(render_template(<strong class="mc hj">'main.html'</strong>))</span><span id="5622" class="mg ki hi mc b fi nd mi l mj mk">    #Getting Form Input<br/>    <strong class="mc hj">if </strong>request.method == <strong class="mc hj">'POST'</strong>:<br/>        alcohol =  request.form[<strong class="mc hj">'alcohol'</strong>]<br/>        malic_acid =  request.form[<strong class="mc hj">'malic_acid'</strong>]<br/>        ash =  request.form[<strong class="mc hj">'ash'</strong>]<br/>        alcalinity_of_ash = request.form[<strong class="mc hj">'alcalinity_of_ash'</strong>]<br/>        magnesium =  request.form[<strong class="mc hj">'magnesium'</strong>]<br/>        total_phenols   =  request.form[<strong class="mc hj">'total_phenols'</strong>]<br/>        flavanoids      =  request.form[<strong class="mc hj">'flavanoids'</strong>]<br/>        nonflavanoid_phenols =  request.form[<strong class="mc hj">'nonflavanoid_phenols'</strong>]<br/>        proanthocyanins      =  request.form[<strong class="mc hj">'proanthocyanins'</strong>]<br/>        color_intensity     =  request.form[<strong class="mc hj">'color_intensity'</strong>]<br/>        hue                  =  request.form[<strong class="mc hj">'hue'</strong>]<br/>        od280_od315_of_diluted_wines   =  request.form[<strong class="mc hj">'od280_od315_of_diluted_wines'</strong>]<br/>        proline  =  request.form[<strong class="mc hj">'proline'</strong>]</span><span id="4243" class="mg ki hi mc b fi nd mi l mj mk">        #Putting Form input in a data frame </span><span id="dc33" class="mg ki hi mc b fi nd mi l mj mk">        input_variables = pd.DataFrame([[alcohol, malic_acid, ash,                alcalinity_of_ash, magnesium, total_phenols,flavanoids, nonflavanoid_phenols,proanthocyanins, color_intensity, hue,<br/>od280_od315_of_diluted_wines, proline]],<br/>columns=[<strong class="mc hj">'alcohol'</strong>, <strong class="mc hj">'malic_acid'</strong>, <strong class="mc hj">'ash'</strong>, <strong class="mc hj">'alcalinity_of_ash'</strong>, <strong class="mc hj">'magnesium'</strong>,<strong class="mc hj">'total_phenols'</strong>, <strong class="mc hj">'flavanoids'</strong>, <strong class="mc hj">'nonflavanoid_phenols'</strong>,<br/> <strong class="mc hj">'proanthocyanins'</strong>, <strong class="mc hj">'color_intensity'</strong>, <strong class="mc hj">'hue'</strong>,                                 <strong class="mc hj">'od280/od315_of_diluted_wines'</strong>, <strong class="mc hj">'proline'</strong>], dtype=float)<br/><br/><br/>        # Predicting the Wine Quality using the loaded model<br/>        prediction = model.predict(input_variables)[0]<br/>        <strong class="mc hj">if </strong>prediction == 0.0:<br/>            prediction = <strong class="mc hj">"Poor Wine Quality"<br/>        elif </strong>prediction == 1.0:<br/>            prediction = <strong class="mc hj">"Good Wine Quality"<br/>        else</strong>:<br/>            prediction = <strong class="mc hj">"Fine Wine Quality"<br/><br/>        return </strong>render_template(<strong class="mc hj">'main.html'</strong>, result=prediction)<br/><br/><br/><br/><strong class="mc hj">if </strong>__name__ == <strong class="mc hj">'__main__'</strong>:<br/>    app.run()</span></pre><h2 id="843c" class="mg ki hi bd kj mm mn mo kn mp mq mr kr jg ms mt kv jk mu mv kz jo mw mx ld my bi translated">编辑main.html</h2><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="7c93" class="mg ki hi mc b fi mh mi l mj mk">&lt;!DOCTYPE <strong class="mc hj">html</strong>&gt;<br/>&lt;<strong class="mc hj">html lang="en"</strong>&gt;<br/>&lt;<strong class="mc hj">head</strong>&gt;<br/>    &lt;<strong class="mc hj">meta charset="UTF-8"</strong>&gt;<br/>    &lt;<strong class="mc hj">title</strong>&gt;&lt;/<strong class="mc hj">title</strong>&gt;<br/>&lt;/<strong class="mc hj">head</strong>&gt;<br/>&lt;<strong class="mc hj">body</strong>&gt;<br/>    &lt;<strong class="mc hj">form action="{{ url_for('main') }}" method="POST"</strong>&gt;<br/>    &lt;<strong class="mc hj">fieldset</strong>&gt;<br/>        &lt;<strong class="mc hj">legend</strong>&gt;Input values:&lt;/<strong class="mc hj">legend</strong>&gt;<br/>        Alcohol:<br/>        &lt;<strong class="mc hj">input name="alcohol" type="float" value="14.23" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Malic Acid:<br/>        &lt;<strong class="mc hj">input name="malic_acid" type="float" value="1.71" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Ash:<br/>        &lt;<strong class="mc hj">input name="ash" type="float" value="2.43" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        Alcalinity of ash:<br/>        &lt;<strong class="mc hj">input name="alcalinity_of_ash" type="float" value="15.6" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Magnesium:<br/>        &lt;<strong class="mc hj">input name="magnesium" type="float" value="127.0" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Total Phenols:<br/>        &lt;<strong class="mc hj">input name="total_phenols" type="float" value="2.80" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        Flavanoids:<br/>        &lt;<strong class="mc hj">input name="flavanoids" type="float" value="3.06" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Non-Flavanoid Phenols:<br/>        &lt;<strong class="mc hj">input name="nonflavanoid_phenols" type="float" value="0.28" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Proanthocyanis:<br/>        &lt;<strong class="mc hj">input name="proanthocyanins" type="float" value="2.29" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        Color Intensity:<br/>        &lt;<strong class="mc hj">input name="color_intensity" type="float"  value="5.64" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Hue:<br/>        &lt;<strong class="mc hj">input name="hue" type="float" value="1.04" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Diluted wines:<br/>        &lt;<strong class="mc hj">input name="od280_od315_of_diluted_wines" type="float" value="3.92" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt; Proline:<br/>        &lt;<strong class="mc hj">input name="proline" type="float" value="1065.0" required</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">br</strong>&gt;<br/>        &lt;<strong class="mc hj">input type="submit"</strong>&gt;<br/>    &lt;/<strong class="mc hj">fieldset</strong>&gt;<br/>&lt;/<strong class="mc hj">form</strong>&gt;<br/>&lt;<strong class="mc hj">br</strong>&gt;<br/>&lt;<strong class="mc hj">div class="result" align="center"</strong>&gt;<br/>    {% if result %}<br/>        &lt;<strong class="mc hj">br</strong>&gt; Predicted Quality of Wine:<br/>           &lt;<strong class="mc hj">p style="</strong>font-size:50px<strong class="mc hj">"</strong>&gt;{{ result }}&lt;/<strong class="mc hj">p</strong>&gt;<br/>    {% endif %}<br/>&lt;/<strong class="mc hj">div</strong>&gt;<br/>&lt;/<strong class="mc hj">body</strong>&gt;<br/>&lt;/<strong class="mc hj">html</strong>&gt;</span></pre><p id="97d8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在编辑了我们的app.py和main.html脚本之后，重新运行app.py并访问您的本地主机(http://127.0.0.1:5000/)来呈现html模板。填写适当的输入，并提交您应该有这样的东西:</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es ng"><img src="../Images/9301f609d7f1afc44e6ac571e19509ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*tND_GVmU3hmZEU20NumODw.jpeg"/></div></figure><p id="36e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这种情况下，根据我们对葡萄酒化学物质的输入，我们对葡萄酒质量的预测是“一款好酒”。尝试您的输入并获得您的预测:)。应该注意的是，这里构建的模型并不完美，但旨在演示如何将模型部署到web应用程序中。您可以微调模型或构建任何您选择的模型。</p><p id="8b12" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，我们将了解如何在云服务Heroku上部署我们的应用程序。</p><p id="c40a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请务必查看本教程的第<a class="ae iu" rel="noopener" href="/@oluakintoye/deploying-a-machine-learning-model-as-a-flask-app-on-heroku-part-2-9d8366eb784c">部分第2 </a>部分，了解如何将web应用程序部署到云中。</p><p id="265f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你有任何反馈，请与我分享。也可以在<a class="ae iu" href="https://www.linkedin.com/in/oluakintoye/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我或与我联系。感谢阅读。</p></div></div>    
</body>
</html>