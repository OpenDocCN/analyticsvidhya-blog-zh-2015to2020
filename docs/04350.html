<html>
<head>
<title>Fast Customer Care Response with Deep Learning(NLP) and Twitter Bot.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用深度学习(NLP)和Twitter Bot实现快速客户服务响应。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/fast-customer-care-response-with-deep-learning-and-twitter-bot-9d7e4a2ec390?source=collection_archive---------17-----------------------#2020-03-15">https://medium.com/analytics-vidhya/fast-customer-care-response-with-deep-learning-and-twitter-bot-9d7e4a2ec390?source=collection_archive---------17-----------------------#2020-03-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/06855cb50092cf13c59f129cdab53c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r9ummdlYB7jSZoKs"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Clem Onojeghuo 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="333f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于使用一些机构服务而产生的挫折感，确实导致迫切需要专门从事这种服务的人的注意。最令人沮丧的服务之一确实来自于像银行这样的金融机构，并且大多数这样的银行具有较差的客户服务来提供客户所需要的即时响应，这因此导致更沮丧的客户，他们可能最终不再使用这些服务。</p><p id="5723" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但有时我们不能因为没有快速响应而责怪客户服务没有做好他们的工作，有时许多客户同时需要关注，这并不是需要如此紧急响应的全部。由于这种情况，当正确的人在正确的时间被忽略时，客户服务可能会响应错误的人，这可能会导致重大损失。</p><p id="93a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">与上面的陈述一致，它表明有必要提供一种学习过滤消息的系统，从而减少噪音并因此帮助改善客户服务。</p><p id="af75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我们将汇集来自twitter的数据，并创建一个twitter机器人。这遵循了之前的<a class="ae iu" href="https://towardsdatascience.com/twitter-bot-for-data-scientists-8f4242c4d876" rel="noopener" target="_blank"> <strong class="ix hj"> <em class="jt">帖子</em> </strong> </a> <strong class="ix hj"> <em class="jt"> </em> </strong>关于如何为数据科学家创建一个twitter机器人。</p><p id="eeef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为什么使用twitter？Twitter必须成为人们倾诉心声和分享信息的主要平台之一。由于这些组织中的大多数都有一个twitter账户来回应客户，因此，它可以很容易地收集银行客户的数据，以解决他们的问题。</p><p id="8504" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这篇文章是关于什么的？它是关于使用深度学习融合Twitter机器人，通过减少噪音，从而提高响应率，让每个组织的客户服务更好。这里的想法可以扩展到其他形式。</p><p id="32df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将努力实现的目标是:</p><ol class=""><li id="3c38" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated">如何从twitter中提取数据</li><li id="61cf" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">如何清理我们的数据</li><li id="0573" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">如何标记我们的数据</li><li id="0bee" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">如何选择合适的型号</li><li id="a6aa" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">如何给这个模型注入Twitter机器人</li><li id="5a60" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">如何将bot部署到aws。</li></ol><p id="b916" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如何从twitter获取数据</strong></p><p id="d779" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于我们的数据将基于银行客户的推文，我们将收集尼日利亚几乎所有银行的用户名(因为那是我的所在地)。这个用户名将被存储在一个列表中，然后这个列表将被遍历以让他们客户在Twitter上抱怨。</p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="3de7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用<code class="du ko kp kq kr b">api.Cursor</code>遍历由<code class="du ko kp kq kr b">api.search</code>返回的每个页面，这有助于获取列表中包含银行的每个tweet。<code class="du ko kp kq kr b">-filter:retweets</code>用于过滤掉所有的转发，只包括客户直接发至银行twitter账户的推文。之后，为每个银行提取的推文创建一个csv文件。</p><p id="71c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如何清理我们的数据</strong></p><p id="173d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一些推文可能包含表情符号、嵌入式URL、@ sign等，我们最好将这些从推文文本中删除，以便只在纯文本上训练我们的模型。对每个银行的csv文件执行此过程，然后将csv文件连接成一个文件。</p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="136b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如何标注数据</strong></p><p id="414c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标注数据是最关键也是最繁琐的部分，因为它决定了我们模型的可信度，而且确实要花很多无聊的时间。这就是我们将推文分为正面或负面的原因。但是注意；我们对负面或正面的感觉取决于我们认为最需要关注的推文(紧急情况)，因此给推文贴上标签意味着它需要紧急关注。因此，从不同的角度来看，不同的人对什么需要关注的定义可能是不同的，因此，这方面的权威应该能够界定哪个是哪个。</p><p id="970b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了使标注更快，用javascript构建了一个UI，它提供了简单的导航和临时存储，这有助于在累的时候记下你在哪里停止标注。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ks"><img src="../Images/b3036a6782d0af6933530b600e82ef7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVm3A9TQdvYqWA8kYqSX4w.png"/></div></div></figure><p id="a6a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如何选择合适的型号</strong></p><p id="7e07" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个项目使用的模型可能是由一些库提供的任何NLP文本分类算法，例如Text blob。但在这个项目中，我使用了ULMFIT，这是NLP深度学习的一种新的先进的迁移学习，由杰瑞米·霍华德和塞巴斯蒂安·鲁德提出。</p><p id="7142" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择它的主要原因是:</p><ol class=""><li id="706a" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated">数据中的一些文本被截断，我们希望能够建立一个语言模型，通过预测下一个可能出现的单词来重建一些被截断的文本。</li><li id="fb0e" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">一些需要紧急关注的客户投诉有时确实先包含令人愉快的陈述(正面陈述)，然后是他们的投诉。有些时候一些文本分类算法会分类，这有时是中性的。</li></ol><p id="8ef3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ULMFIT是如何工作的；</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/20d8d5cc7c493c3ffabc0a71b2016b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qS9SQY1qR5ZO7DHM8Cgxuw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://www.novetta.com/2019/03/odsc19_text_classification_ulmfit/?__cf_chl_captcha_tk__=88807726d0c0a6a50ca29dd26f7b883a909ccb92-1577299063-0-ATrnrEthBvZlMnHqfU-6sil7vmig0aTzpJDtgBn2U9zfqQ_TCLssrdA-DOm8UPaheDE3L9wRWeG_xrS0RFeCEWaYWACY0VywRX3Ve-AJE5MODCAw4OXvl_tXR8q83qgzXRQ81iMbQq-D-YibXbwmJN4f8ElCku-D1dy7VU8puD3n589esuXypss4_n3oZVduar6ehumHBz2dwD5eDe8nUUYfHXYO1kddkPZ7KthLgM6fRJl5xcI5CUJbP0UoqvhTw0rMZsSfckQUJeqz31VsmY5gsHgeXZE7londpZe0l8z7PmVI6ZLJuSleDOq8KoWXzPw5_-7q7T_mjr80RsBkrkRgA38F2fv3EwWaAEyNSvjh" rel="noopener ugc nofollow" target="_blank">诺韦塔</a></figcaption></figure><p id="0136" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们在wiki text 103上训练一个语言模型，然后这个语言模型在我们银行的tweet数据上进行微调，为它创建一个语言模型，之后使用语言模型的预训练权重训练一个分类器，以提高性能。</p><p id="a59d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代码完全基于Fastai的课程v3的教训，可以看视频<a class="ae iu" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwiqkeTQutHmAhUgTxUIHehODNIQwqsBMAF6BAgKEAQ&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dqqt3aMPB81c&amp;usg=AOvVaw3NlTqSyhiXLuFDgL7NF4Qh" rel="noopener ugc nofollow" target="_blank">这里</a></p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="ad07" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如何给模型注入Twitter bot </strong></p><p id="baf1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在训练完模型后，我们尽量节省可以在推理期间导入的权重。快速人工智能提供了一种简化推理的方法，不需要下载预训练的AWD LSTM，也不需要导入上面代码中显示的数据pickle文件。通过使用<code class="du ko kp kq kr b">leaner.export()</code>创建一个<code class="du ko kp kq kr b">export.pkl </code>文件，它可以灵活地进行推理，只需调用<code class="du ko kp kq kr b">load_learner(path</code>就可以导入所有必要的数据和重量。</p><p id="809d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要创建twitter机器人，请查看我之前的帖子。</p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="daa7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du ko kp kq kr b">make_model()</code>帮助创建推理模型</p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="0765" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该机器人的主要目标是查看是否有任何传入的推文被分类为负面，然后它会向客户服务提供的电子邮件发送一封紧急电子邮件，其中包括推文URL，以便正确查看推文。</p><p id="4abc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要发送电子邮件，最好使用SendGrid帐户而不是使用Gmail API，创建一个SendGrid帐户来获取API令牌检查<a class="ae iu" href="https://sendgrid.com/" rel="noopener ugc nofollow" target="_blank">此处</a></p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="1635" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这有助于发送主题为Emergency status的邮件，邮件内容包括tweet status的链接。</p><p id="ee6a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如何将bot部署到AWS </strong></p><p id="f106" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们创建一个docker文件来封装bot，这将使它更容易部署在AWS上，而没有代码库环境问题。</p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="3285" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后构建一个镜像将在终端中运行这个；</p><pre class="ki kj kk kl fd ku kr kv kw aw kx bi"><span id="753f" class="ky kz hi kr b fi la lb l lc ld">$ docker build . -t cus-bot</span></pre><p id="295a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们测试正在创建的docker映像；</p><pre class="ki kj kk kl fd ku kr kv kw aw kx bi"><span id="debd" class="ky kz hi kr b fi la lb l lc ld">docker run -it -e CONSUMER_KEY="AFEFFEF2103Y80Y8" \<br/>-e CONSUMER_SECRET="ASW34134FEFEFMNLN8YH8Y8" \<br/>-e ACCESS_TOKEN="qqww23d43od94djdi3dj" \<br/>-e ACCESS_TOKEN_SECRET="AASWD03993322" \<br/>cus-bot</span></pre><p id="1fcc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将启动twitter机器人，因此，如果它工作，然后我们就可以开始了，然后我们需要将图像转换为一个. tar文件，使其易于与AWS集成。</p><pre class="ki kj kk kl fd ku kr kv kw aw kx bi"><span id="708e" class="ky kz hi kr b fi la lb l lc ld">$ docker image save cus-bot -o cus-bot.tar<br/>$ gzip cus-bot.tar</span></pre><p id="3156" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">压缩图像后，我们可以继续在aws EC2上创建一个实例，我们生成EC2密钥inform of <code class="du ko kp kq kr b">yourkey.pem</code>，docker将安装在您的实例上。要获得完整的要点和快速的解释，请查看<a class="ae iu" href="https://realpython.com/twitter-bot-python-tweepy/" rel="noopener ugc nofollow" target="_blank">realpython.com</a>，它会一步一步地给你讲解AWS上的部署。</p><p id="d249" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">挑战</strong></p><p id="f11c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个过程中遇到的唯一挑战是，为机器人生成的docker图像的大小约为2.0 gig，而我的AWS EC2 am使用的免费trier只能为我选择的Ubuntu 18.04提供1gig。虽然docker图像已经过测试，工作正常，例如，我twitted这个；</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es le"><img src="../Images/b2f7af2909b75fef260dfbd6d2f7832b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*xkQuk4vE8Xi2W1kbsL-udQ.png"/></div></figure><p id="176b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就像一个客户抱怨并在推文中引用我的名字。机器人捕捉这条推文，并通过我们的模型处理它，看看它是否是负面的。如果是的话，我会收到一封紧急邮件，里面有我收到的tweet状态的链接；</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/cf146c72b27e9ec0e71dc837f998f9d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d3FwtUaYQzhHRuf0hXhCQw.png"/></div></div></figure><p id="a939" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要使用我使用的相同模型并创建完全相同的机器人，请检查代码<a class="ae iu" href="https://github.com/steveoni/customer_servicebot" rel="noopener ugc nofollow" target="_blank">这里</a>并下载权重<a class="ae iu" href="https://drive.google.com/open?id=1nk6egK4zquW3qP4-C8D4N9LTHf67S7bO" rel="noopener ugc nofollow" target="_blank">这里</a>，训练模型的代码(包括用于分类的UI)可以从<a class="ae iu" href="https://github.com/steveoni/Bank_UserTweet" rel="noopener ugc nofollow" target="_blank"> github </a>获得</p><p id="20b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，本次培训使用的数据集来自<a class="lg lh ge" href="https://medium.com/u/7c590e569dd4?source=post_page-----9d7e4a2ec390--------------------------------" rel="noopener" target="_blank">尼日利亚数据科学</a>的一项研究工作</p></div></div>    
</body>
</html>