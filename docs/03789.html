<html>
<head>
<title>How to Share Data explicitly between Threads vs. Processes in Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中如何在线程和进程之间显式共享数据？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-tips-multithreading-vs-multiprocessing-data-sharing-tutorial-52743ed48825?source=collection_archive---------0-----------------------#2020-02-19">https://medium.com/analytics-vidhya/python-tips-multithreading-vs-multiprocessing-data-sharing-tutorial-52743ed48825?source=collection_archive---------0-----------------------#2020-02-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="56bc" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">Python技巧教程</h2><div class=""/><div class=""><h2 id="11ec" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">指南:抛弃复杂细节，快速开始使用数据共享。</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/ebcb40a25c5ac7560597a214c819a205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dqg0QFtqgOwoK_pZhGDEGQ.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><a class="ae jw" href="https://unsplash.com/photos/CyFBmFEsytU" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/CyFBmFEsytU</a></figcaption></figure><p id="6c3f" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">作为多线程和多处理的新手，并行工作的动机是推动代码执行。然而，一旦你让任务变得更复杂，你就会陷入困境。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h1 id="0bb9" class="la lb hi bd lc ld le lf lg lh li lj lk ix ll iy lm ja ln jb lo jd lp je lq lr bi translated">从哪里开始？</h1><blockquote class="ls lt lu"><p id="bc98" class="jx jy lv jz b ka kb is kc kd ke iv kf lw kh ki kj lx kl km kn ly kp kq kr ks hb bi translated">这篇文章的重点是“快速入门”，而不是完整的解释，但我保证这将使你在深入真正扎实的知识之前更容易理解。</p></blockquote><p id="33bc" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">最常见的挑战是<strong class="jz hs">多线程和多处理</strong>之间的数据共享，与此主题相关的大量资源已经存在。看看人们是如何用不同的方式解释同一个问题的。这些是我学习时读过的最好的文章。</p><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/@bfortuner/python-multithreading-vs-multiprocessing-73072ce5600b"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hs fi z dy mh ea eb mi ed ef hr bi translated">Python中的线程和进程简介</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">并行编程初学者指南</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq jq mc"/></div></div></a></div><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/multiprocessing-for-data-scientists-in-python-427b2ff93af1"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hs fi z dy mh ea eb mi ed ef hr bi translated">Python中数据科学家的多重处理</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如果不能全部使用，为什么还要花钱买一个强大的CPU呢？</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mr l mn mo mp ml mq jq mc"/></div></div></a></div><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/better-programming/python-memory-and-multiprocessing-ed517b8db8fd"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hs fi z dy mh ea eb mi ed ef hr bi translated">Python内存和多重处理</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">以下是如何提高CPU密集型程序的速度</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="ms l mn mo mp ml mq jq mc"/></div></div></a></div><div class="lz ma ez fb mb mc"><a href="https://www.pythonforthelab.com/blog/handling-and-sharing-data-between-threads/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hs fi z dy mh ea eb mi ed ef hr bi translated">在线程之间处理和共享数据</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">在Python中使用线程时，您会发现能够在不同的任务之间共享数据非常有用。其中一个…</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">www.pythonforthelab.com</p></div></div><div class="ml l"><div class="mt l mn mo mp ml mq jq mc"/></div></div></a></div><p id="175a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">但为了简单起见，我将重点放在如何让你开始，所以如果你想快速获得它，记住这两种方法以获得完整的想法:</p><ol class=""><li id="4500" class="mu mv hi jz b ka kb kd ke kg mw kk mx ko my ks mz na nb nc bi translated">线程间共享数据:可变对象。</li><li id="657e" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks mz na nb nc bi translated">进程间共享数据:进程间通信。</li></ol><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ni"><img src="../Images/e5030fd723161b80421c9f20ab423f01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DggUM1r93Tgcj0zrLb3bSQ.jpeg"/></div></div></figure></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h1 id="a3d1" class="la lb hi bd lc ld le lf lg lh li lj lk ix ll iy lm ja ln jb lo jd lp je lq lr bi translated">可变对象</h1><p id="4744" class="pw-post-body-paragraph jx jy hi jz b ka nj is kc kd nk iv kf kg nl ki kj kk nm km kn ko nn kq kr ks hb bi translated">当您在全局范围内创建一个可变对象(如列表或字典)时，只要您将它用作线程参数，它就会共享相同的内存地址，这在C或C++等低级语言中称为“指针”。因此，无论何时调用变量，我们都可以很容易地更改数据。</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="no np l"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">粘贴并执行我！！！</figcaption></figure><p id="e70a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">输出应该是两个相同的ID号，全局列表也被更改。这个很简单，你也可以把列表形式转换成字典，你可能会得到同样的结果。</p><p id="0fc6" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">事实上，python中没有指针，使用可变对象是模拟概念最简单的方法。您也可以使用:</p><ul class=""><li id="72c4" class="mu mv hi jz b ka kb kd ke kg mw kk mx ko my ks nq na nb nc bi translated">自定义类:使用<code class="du nr ns nt nu b">@property</code>decorator来扩展dictionary的思想。</li><li id="cbc8" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks nq na nb nc bi translated"><code class="du nr ns nt nu b">ctypes</code>模块:一个内置的标准库，用来创建真正的C风格指针。</li></ul><p id="24b2" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">关于指针以及如何使用自定义类和<code class="du nr ns nt nu b">ctypes</code>模块的更多细节。点击下面的文字。</p><div class="lz ma ez fb mb mc"><a href="https://realpython.com/pointers-in-python/#simulating-pointers-in-python" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hs fi z dy mh ea eb mi ed ef hr bi translated">Python中的指针:有什么意义？-真正的蟒蛇</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如果你曾经使用过像C或C++这样的低级语言，那么你可能听说过指针。指针允许…</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">realpython.com</p></div></div><div class="ml l"><div class="nv l mn mo mp ml mq jq mc"/></div></div></a></div><h1 id="690a" class="la lb hi bd lc ld nw lf lg lh nx lj lk ix ny iy lm ja nz jb lo jd oa je lq lr bi translated">进程间通信</h1><blockquote class="ls lt lu"><p id="c79b" class="jx jy lv jz b ka kb is kc kd ke iv kf lw kh ki kj lx kl km kn ly kp kq kr ks hb bi translated">为什么不像线程那样使用指针来共享数据呢？</p></blockquote><p id="901a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">问题是进程间禁止“指针”。否则，任何人都可以在其他正在运行的应用程序中修改数据。</p><p id="7322" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">尽管如此，在两个进程之间使用“共享内存”是可能的，但它将由不同的指针表示，这被称为线程间通信。</p><p id="0b00" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">最简单的方法是在<code class="du nr ns nt nu b">multiprocess</code>模块中使用<code class="du nr ns nt nu b">Array</code>创建共享对象，共享对象可以被子进程继承。</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="no np l"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">粘贴并执行我！！！</figcaption></figure><p id="9f26" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">遗憾的是，<code class="du nr ns nt nu b">concurrent</code>模块不支持进程间共享内存，<code class="du nr ns nt nu b">multiprocessing</code>模块更好学，更好实现。</p><p id="c412" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这里有一些你可以使用的高级模块。<a class="ae jw" href="https://docs.python.org/3/library/ipc.html" rel="noopener ugc nofollow" target="_blank">点击我</a>。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="6a4b" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这些是分享数据的最基本的用法，还有很多你最好熟悉的关键词，可以在网上搜索:</p><ol class=""><li id="cee1" class="mu mv hi jz b ka kb kd ke kg mw kk mx ko my ks mz na nb nc bi translated">多线程队列</li><li id="59bc" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks mz na nb nc bi translated">多线程锁</li><li id="3bbb" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks mz na nb nc bi translated">多重处理队列</li><li id="ded9" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks mz na nb nc bi translated">多重处理管道</li><li id="0570" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks mz na nb nc bi translated">蟒蛇GIL</li></ol><p id="49e5" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">举几个例子，但是简单使用就足够了。我希望你能得到一些关于如何开始类似话题的想法。</p></div></div>    
</body>
</html>