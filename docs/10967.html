<html>
<head>
<title>Text Analysis on the reviews data of Indian products in Amazon</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊印度产品评论数据的文本分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/text-analysis-on-the-reviews-data-of-indian-products-in-amazon-a9c21709c4d8?source=collection_archive---------0-----------------------#2020-11-11">https://medium.com/analytics-vidhya/text-analysis-on-the-reviews-data-of-indian-products-in-amazon-a9c21709c4d8?source=collection_archive---------0-----------------------#2020-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7532981bef1442afe9bd17e42daa07cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qidxxDFQLGoX985lIHn0yA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">凯尔·格伦在<a class="ae iu" href="https://unsplash.com/s/photos/free?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="afe6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文的目的是利用不同的自然语言处理方法，如 NLTK 和 Spacy，探索和分析亚马逊上印度产品的评论数据集。也可以用 NLTK Vader 和 TextBlob 进行情感分析。</p><p id="b664" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">情感分析量化文本中单词和短语的情感强度。情感分析工具会处理一个单位的文本，输出量化的分数来表示+ve/-ve。NLTK VADER 情感分析工具为给定的输入生成+ve、-ve 和中性情感分数。情感分析对于企业评估客户反应至关重要。</p><p id="b828" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">文本数据是非结构化数据集，借助各种 Python 库，深入探索和分析并提取对业务决策有意义的见解变得非常有效。</p><p id="dba3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据集在 ka ggle<a class="ae iu" href="https://www.kaggle.com/nehaprabhavalkar/indian-products-on-amazon" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/nehaprabhavalkar/Indian-products-on-Amazon</a></p><p id="dd33" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为 NLP 分析过程的一部分，典型的流水线是记号化=== &gt;清理数据=== &gt;移除停用词===&gt; BoW=== &gt;分类模型训练</p><p id="b2a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为第一步，我们加载所有需要的 python 库。接下来，我们将数据集读入系统:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/0105e05b4157d8c6572db64997db7fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uMcxYew0z1NBEr_FgQysRg.png"/></div></div></figure><p id="a67c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有五个栏目，名字，日期，评分，评论。将检查 dataframe 和 null 列的维度。我们可以看到 4 行的 review 列有空值，因此我们删除这 4 行并重置索引:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/4bf8777be17c0e8ba24f1254160b5252.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1nLI-onsPXU9FwAH4BzXQ.png"/></div></div></figure><p id="332b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为预处理步骤的一部分，我们删除了 review 字段中所有不是数字或字符的字符。</p><blockquote class="jz ka kb"><p id="a0db" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated"># remove all characters not number or characters<br/>def clean text(input _ string):<br/>modified _ string = re.sub('[^a-za-z0–9]+'，' '，input _ string)<br/>return(modified _ string)<br/>reviews _ df[' review ']= reviews _ df . review . apply(clean text)<br/>reviews _ df[' review '][150]</p><p id="2f29" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">输出:</p><p id="b965" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">“我在使用它大约 20 天后写下这篇评论，它看起来非常自然，不含化学物质，对皮肤非常温和，但它能正确清洁皮肤。它含有茶树，这是我最喜欢的护肤成分之一。试试看，它肯定比所有其他含化学物质的洗面奶都好，而且与市场上其他天然品牌相比，它甚至还很实惠。”</p></blockquote><p id="5a28" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从名称字段中，我们可以提取品牌名称。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/422dd96b2dfee6df83e35faaa9a0b467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eFaJiZvhAyjcAKre7x2Mfg.png"/></div></div></figure><blockquote class="jz ka kb"><p id="78cd" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">reviews _ df[' brand name ']= reviews _ df[' brand name ']. str . title()<br/>reviews _ df . brand name . unique()</p><p id="8a0e" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">数组([' mama aerth '，' Godrej '，' Titan '，' Maaza '，' Paper '，' Indiana '，[T1 '，' Coca '，' Natural '，' Maggi '，' Glucon '，' Amul '，' Patanjali '，' T2 '，' Dettol '，' Savlon '，' Cinthol '，' Britannia '，' Nutrichoice '，[T3 '，' Streax '，' Himalaya '，' Society '，' Tata '，' Fastrack '，' Reflex '，[T4 '，' Mysore']，dtype=object)</p></blockquote><p id="19fe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">评级栏的分布。我们可以看到最高评论数对应于评分 5。</p><p id="c503" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">`#评分分布<br/> sns.countplot(x='rating '，data=reviews_df)</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/31f44f35b12e4749a13298b6a1d5fde7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*sk4SuuRlArQAlwnzRgLvQw.png"/></div></figure><p id="29aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">查看计数和品牌</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/824d8c6abeca679ac70e9be06a782a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d69oyfhU85DIGYeA6Z7Iag.png"/></div></div></figure><h2 id="b1bf" class="kj kk hi bd kl km kn ko kp kq kr ks kt jg ku kv kw jk kx ky kz jo la lb lc ld bi translated">将使用 NLTK 和 Vader 情感分析器进行文本分析。</h2><p id="a6b8" class="pw-post-body-paragraph iv iw hi ix b iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">给出一个情感强度分数来评论句子。<code class="du lj lk ll lm b">polarity_scores</code>的结果给出了消极、中立和积极情绪的数值。复合值反映了从-1 非常负面到+1 非常正面的整体情绪。</p><blockquote class="jz ka kb"><p id="7a76" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">文本预处理</p><p id="dbfc" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">#转换为小写<br/>reviews _ df[' clean _ review _ text ']= reviews _ df[' review ']. str . lower()</p><p id="ed5a" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">#删除标点符号<br/>reviews _ df[' clean _ review _ text ']= reviews _ df[' clean _ review _ text ']. str . translate(str . make trans('，''，string.punctuation))</p><p id="ca7e" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">stop words = stop words . words(' English ')+[' the '，' a '，' an '，' I '，' he '，' she '，' to '，' of '，' it '，' from ']<br/>def remove stop words(stop words，rvw_txt): <br/> newtxt = ' '。join([word for word in rvw _ txt . split()if word not in stop words])<br/>return new txt<br/>reviews _ df[' clean _ review _ text ']=[remove stop words(stop words，x)for x in reviews _ df[' clean _ review _ text ']]</p></blockquote><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/951f8b54d65197581853b94b1b5fae54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zUf-ibjHKhGqUQfHA6aJQ.png"/></div></div></figure><blockquote class="jz ka kb"><p id="f40f" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">nltk . download(' Vader _ lexicon ')<br/>SentimentIntensityAnalyzer()<br/>sentiment _ scores =[]<br/>sentiment _ score _ flag =[]<br/>for text in reviews _ df[' clean _ review _ text ']:<br/>sentiment results = sentiment _ model . polarity _ scores(text)<br/>sentiment _ score = sentiment results[" compound "]<br/># print(sentiment results)<br/>#复合值反映了从-到-的整体情绪<br/>情绪 _ 分数.追加(情绪 _ 分数)<br/> #将情绪标记为积极、消极和中性<br/>if sensition results['复合'] &gt; = 0.05 : <br/>情绪 _ 分数 _ 标志.追加('积极')<br/>elif sensition results['复合'] &lt; = — 0.05 : <br/>情绪 _ 分数 _ 标志.追加('消极')<br/> else : <br/>情绪 _ 分数 _ 标志.追加('中性')</p><p id="9c83" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">reviews_df.head()</p></blockquote><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/3a9715c90bf840172ca79c38a0630357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sEot5cvegUVvOexIWXHl7w.png"/></div></div></figure><p id="3d2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Wordcloud 显示评论中的热门词汇，如头发、油、产品、健康等</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/0c28e65b7bd35b3729ace81b131c7e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NNQ55U6QamY2u8hbfh-rlQ.png"/></div></div></figure><p id="c9ac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正面评论的 Wordcloud 显示了诸如最好的、令人宽慰的、好的等词</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/a9af25a546e335fd4095de26a5e0fd9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Nr7RyNkLaDX5-10DZ_hQg.png"/></div></div></figure><p id="4603" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">负面评论的文字云显示最差、假、差等词</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/5d89c9b095479e04d5b692db3f3ae24e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cr7SJqCB0EsRcTlQwbf2Qg.png"/></div></div></figure><p id="3860" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">品牌方面的正面和负面评论。只有印第安纳这个品牌没有负面评价。</p><p id="d5db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对“印第安纳”品牌的 6 个评价如下，我们认为它们是正面的。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/2997b30efb0518ad4c5ae7e29e251752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*fy4AzAUwO7_3eHtA-D3Nwg.png"/></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/a3ce4b6ec1057cd6edb8ae481a21364d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*NEDM23YJ29cYAmVCPocRtg.png"/></div></figure><h2 id="3d26" class="kj kk hi bd kl km kn ko kp kq kr ks kt jg ku kv kw jk kx ky kz jo la lb lc ld bi translated">TF 和 TF-IDF 和单词袋</h2><p id="c0e1" class="pw-post-body-paragraph iv iw hi ix b iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">对于机器学习模型，输入必须是数字，因此用数字表示我们的文本，我们有单词袋模型，如 TF，TFIDF</p><p id="f5af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TF-IDF 旨在量化给定单词相对于文档和语料库中其他单词的重要性。</p><p id="e6a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以用来做这件事的一个工具叫做单词袋。BoW 是一种经典的文本表示技术。所考虑的文本是单词的集合，而忽略了顺序和上下文。BoW 将文本转换成给定文档中单词出现的矩阵。它关注给定的单词是否出现在文档中，并生成一个矩阵，我们可能会看到它被称为 BoW 矩阵或文档术语矩阵。</p><p id="cbd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标记化是文本分析的第一步。将一个文本段落分解成更小的块，如单词或句子的过程称为标记化。标记是一个单独的实体，它是句子或段落的组成部分。</p><p id="84e5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">词干是将单词规范化为其词根形式。</p><p id="4342" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">词汇化类似于词干化，我们获取单词的基本形式或词根形式。</p><p id="6e47" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">词性标注是将单词按词性分类并相应标注的过程，称为<strong class="ix hj">词性标注或词性</strong> - <strong class="ix hj">标注</strong>。</p><p id="812c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">CountVectorizer 通过将文本文档集合转换成令牌计数矩阵来使用 BoW。“fit”将对训练数据应用 CountVectorizer，将文本文档的集合转换成令牌计数的矩阵。</p><p id="41c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">features = count vectorizer()<br/>features . fit(reviews _ df[" clean _ review _ text "])</p><pre class="ju jv jw jx fd lu lm lv lw aw lx bi"><span id="1998" class="kj kk hi lm b fi ly lz l ma mb">{'bought': 615, 'hair': 1916, 'oil': 2879, 'viewing': 4476, 'many': 2541, 'good': 1842, 'comments': 917, 'product': 3235, 'enough': 1454, 'first': 1645, 'expensive': 1521, 'second': 3650, 'thing': 4207, 'amount': 322, 'low': 2479, 'half': 1925, 'bottle': 611, 'yes': 4671, 'completely': 946,</span></pre><p id="e300" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“转换”将把输入文档转换成给出 BoW 表示的文档术语矩阵。每行是一个文档，每列是训练词汇表中的一个单词。</p><p id="1e6e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">bagofWords = features . transform(reviews _ df[" clean _ review _ text "])</p><pre class="ju jv jw jx fd lu lm lv lw aw lx bi"><span id="7252" class="kj kk hi lm b fi ly lz l ma mb">(0, 322)	1<br/>  (0, 611)	2<br/>  (0, 615)	1<br/>  (0, 626)	2<br/>  (0, 698)	1<br/>  (0, 805)	1<br/>  (0, 917)	1</span></pre><p id="a0b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">print(bagofWords.toarray())</p><pre class="ju jv jw jx fd lu lm lv lw aw lx bi"><span id="fbb2" class="kj kk hi lm b fi ly lz l ma mb">[[0 0 0 ... 0 0 0]<br/> [0 0 0 ... 0 0 0]<br/> [0 0 0 ... 0 0 0]<br/> ...</span></pre><p id="0837" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">print(features . get _ feature _ names())</p><pre class="ju jv jw jx fd lu lm lv lw aw lx bi"><span id="8243" class="kj kk hi lm b fi ly lz l ma mb">'aamras', 'abandon', 'abck', 'able', 'abroad', 'absence', 'absolute', 'absolutely', 'absorbed', 'absorbing', 'abt', 'accept', 'accepted', 'access', 'accessibility', 'accompanied', 'accompaniment', 'according', 'account', 'accounts', 'accurate', 'accustomed', 'acetate', 'acid', 'acidic', 'acne', 'acnei', 'acnes', 'across', 'action', 'actions', 'active', 'actives', 'actual', 'actually', 'ad', 'add', 'added', 'addicted', 'adding', 'addition', 'additional', 'additives', 'address', 'adds', 'adequate', 'adjust', 'admit', 'adrak', 'adult', 'adulterated', 'adulteration', 'adultery', 'adults', 'advantage', 'adverse', 'adversely', 'advertised'</span></pre><p id="64b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过组合所有正行和所有负行来构建训练和测试数据。用于训练分类模型的逻辑回归。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/9183a4a2e5cc9961f1aad4dc5c2e81fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GAPdMx8cAfezhRiLbfhwZQ.png"/></div></div></figure><p id="7bd2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">训练好的模型如何处理新数据。好的和坏的预测是正确的，但模型错误地预测了“糟糕”和“不好”</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/5075506ba365f851f897d95a70e92a6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VIeQTPGJ3VVKutWgU6bGPA.png"/></div></div></figure><p id="df0c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">顶级标志，如产品、好、不错等</p><blockquote class="jz ka kb"><p id="71e6" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">token ized _ word = word _ token ize((reviews _ df[' clean _ review _ text '))。to _ string())<br/>#频率分布<br/>fdist = freq dist(token ized _ word)<br/>#频率分布 Plot <br/> fdist.plot(30，cumulative=False) <br/> plt.show()</p></blockquote><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es me"><img src="../Images/eb87e0531b5c9caa128d545e17bc0490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*P1hyS63Cd3ApjGs1i0XRlg.png"/></div></figure><h2 id="debc" class="kj kk hi bd kl km kn ko kp kq kr ks kt jg ku kv kw jk kx ky kz jo la lb lc ld bi translated">接下来用<strong class="ak"> spacy </strong>库做复习文本分析。</h2><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/331a1096a20a8d0e385e127f1d0e49cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZpJ1gBBN6tH0f8WxQ945Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@malvestida?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Malvestida 杂志</a>在<a class="ae iu" href="https://unsplash.com/s/photos/product?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9634" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对文本进行标记</p><p id="f4b1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标记化是将文本分成称为标记的片段，并忽略标点符号(，)等字符的过程。“’”和空格。spaCy 的记号赋予器接受 unicode 文本形式的输入，并输出一系列记号对象。</p><p id="c747" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导入空间及其英语语言模型。将审阅文本字符串分配给文本。使用 nlp(文本)，将在 spaCy 中处理该文本，并将结果赋给一个名为 doc 的变量。spaCy 将标记化的文本存储为文档。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/19d19db6f032ccf08a4c48af0a676d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y3SINCtKbM7bdxf0EMROqg.png"/></div></div></figure><blockquote class="jz ka kb"><p id="4d4d" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">#停用字词<br/>停用字词=spacy.lang.en.stop_words。STOP_WORDS <br/> stopWords = list(停用词)<br/> len(停用词)</p><p id="b73c" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">for token in doc:<br/>if token . is _ stop = = False:<br/>print(token)</p><p id="8330" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">油性<br/>粉刺<br/>易发<br/>皮肤<br/>产品<br/>天数<br/>粉刺<br/>干燥<br/>显著<br/>改善<br/>暗沉<br/>斑点<br/>芳香<br/>温和<br/>灿烂</p></blockquote><p id="a82d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">词汇化</p><p id="a8b4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用空间变元法寻找所有单词的词根。</p><p id="6800" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">显示</strong>。<strong class="ix hj">渲染</strong>方法渲染一棵依赖解析树或命名实体可视化。带有空间的 NER 可以通过 doc 对象的 ent 属性来完成。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/4f85bf99fe1382faecd0bf2a2bc184f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CHcfFlHolkqy239wbtt2aQ.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/307cd312f8d10c4ee90409ba4753aa60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2PGxTw06S9BLCyJALE3IA.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/f963c26cfa6706707e6a222b905153d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxoAV5eLeXqQ_DvurfEfyg.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/bce81dcfb2cb9d19d459a0122b6d9c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHvgINocrZflRo0nfg9OAA.png"/></div></div></figure><p id="cdf2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下载了大型预训练模型</p><blockquote class="jz ka kb"><p id="af5c" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">导入 en _ core _ web _ LG<br/>NLP = en _ core _ web _ LG . load()<br/>doc = NLP(text)<br/>for token in doc:<br/>print(token . text，'— →'，token.has_vector)</p><p id="57ee" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">我-&gt;真<br/>有- &gt;真<br/>油- &gt;真<br/>粉刺- &gt;真<br/>俯卧- &gt;真<br/>皮肤- &gt;真<br/>和- &gt;真<br/>有- &gt;真<br/>去过- &gt;真<br/>使用- &gt;真<br/>这- &gt;真【T37</p></blockquote><p id="075f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">相似性得分</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/24f992b68cfc6d150a904a53cfef0446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*KZPZUjpwAdi4tSCKfIzedw.png"/></div></figure><p id="095e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">组合正数据集和负数据集以构建用于训练分类模型的训练数据</p><blockquote class="jz ka kb"><p id="4961" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">df = PD . concat([positive reviews _ df，negative reviews _ df])<br/>df = df[[" clean _ review _ text "，" score status "]]<br/>df[' score status ']=(df[' score status ']= ' positive ')* 1</p><p id="1bca" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">#Tokenization <br/> punct = string .标点符号<br/>print(punct)<br/>def clean text(sent):<br/>doc = NLP(sent)<br/>tokens =[]<br/>for token in doc:<br/>if token . lemma！= "-PRON-":<br/>tokens . append(token . lemma _。降低()。strip())<br/>else:<br/>tokens . append(token . lemma _)<br/><br/>cleanTokens =[]<br/>for tokens 中的 token:<br/>如果 token 不在停用词中且 token 不在点中:<br/>clean tokens . append(token)<br/>返回 clean tokens</p><p id="a1e7" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated"># TFIDF<br/>TFIDF = TFIDF vectorizer(tokenizer = clean text)<br/>classifier = linear SVC()<br/>X = df[" clean _ review _ text "]<br/>y = df[" score status "]<br/>X _ train，X_test，y_train，y_test = train_test_split(X，y，test_size=0.3，random_state=0)</p></blockquote><p id="c89e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用 SVM 训练模型</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/a468225f99d260a2328ac427d583886f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZIw2Td_3SHQ0A2SHHnSX7A.png"/></div></div></figure><h2 id="4ed4" class="kj kk hi bd kl km kn ko kp kq kr ks kt jg ku kv kw jk kx ky kz jo la lb lc ld bi translated">使用 TextBlob 分析</h2><p id="0add" class="pw-post-body-paragraph iv iw hi ix b iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">极性从-1(负)到+1(正)不等</p><p id="f431" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">主观性从 0 到 1 不等</p><p id="d606" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">pol = lambda x: TextBlob(x).情操.极性<br/> sub = lambda x: TextBlob(x).情操.主观性<br/>reviews _ df[" polarity "]= reviews _ df[" review "]。apply(pol) <br/> reviews_df[“主观性”] = reviews_df[“评论”]。应用(子)</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/70e37d9ea8b5dc2d83ef51159a4b5ca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-znfhXuzz22k-9CQxmLprw.png"/></div></div></figure><blockquote class="jz ka kb"><p id="bd10" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">print("负面评论")<br/>most _ negative = reviews _ df[reviews _ df . polarity = =-1]. review . head()<br/>print(most _ negative)<br/>print("正面评论")<br/>most _ positive = reviews _ df[reviews _ df . polarity = = 1). review . head()<br/>print(most _ positive)</p><p id="e738" class="iv iw kc ix b iy iz ja jb jc jd je jf kd jh ji jj ke jl jm jn kf jp jq jr js hb bi translated">差评<br/> 346 最差产品产品 10d 后不工作...<br/> 356 最差产品产品在 10d 后不工作...<br/> 1566 味道很差<br/> 1572 味道很差<br/>名称:评论，dtype:对象<br/>正面评论<br/> 384 这些价位段的最佳产品<br/> 394 这些价位段的最佳产品<br/> 402 使用 1 周后看起来很完美 10 10 对于 lo...使用一周之后，407 简直棒极了，412 对 lo 来说简直太完美了...<br/>名称:审核，数据类型:对象</p></blockquote><h2 id="9e65" class="kj kk hi bd kl km kn ko kp kq kr ks kt jg ku kv kw jk kx ky kz jo la lb lc ld bi translated">用 gensim 和 word2vec 进行文本分析</h2><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/93f8670803642f167d71b7508997515d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OmSICioDbjfhZmmmQKqvQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@abillionveg?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> abillionveg </a>在<a class="ae iu" href="https://unsplash.com/s/photos/review?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d4cb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Word2Vec</p><p id="e250" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Word2Vec 实际上获取单词的语义以及它们与其他单词之间的关系。它学习单词之间的所有内部关系。它以密集的向量形式表示单词。</p><p id="d22b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">句子= reviews _ df[' review _ tokens '][1:10]<br/>句子</p><pre class="ju jv jw jx fd lu lm lv lw aw lx bi"><span id="3a26" class="kj kk hi lm b fi ly lz l ma mb">1    [used, mama, earth, newly, launched, onion, oi...<br/>2    [bad, product, hair, falling, increase, much, ...<br/>3    [product, smells, similar, navarathna, hair, o...<br/>4    [trying, different, onion, oil, hair, hair, he...<br/>5    [using, product, time, roommate, planning, ord...<br/>6    [purchased, oil, shampoo, watching, fake, yout...<br/>7    [good, product, mamaearth, oil, gives, hair, f...<br/>8    [showing, onion, oil, benefits, ad, ate, givin...<br/>9    [used, one, time, say, hairfall, control, stop...<br/>Name: review_tokens, dtype: object</span></pre><p id="0a89" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用 Gensim 的库，我们有 Word2Vec，它采用 min_count = 1 这样的参数，只考虑单词在整个数据中重复 1 次以上的情况。</p><p id="0cef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"># train model<br/>model = word 2 vec(sentences，min_count=1) <br/> print(model)</p><pre class="ju jv jw jx fd lu lm lv lw aw lx bi"><span id="6648" class="kj kk hi lm b fi ly lz l ma mb">Word2Vec(vocab=229, size=100, alpha=0.025)</span></pre><p id="0fb3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"># vocab<br/>words = list(model . wv . vocab)<br/>print(words)</p><pre class="ju jv jw jx fd lu lm lv lw aw lx bi"><span id="67a5" class="kj kk hi lm b fi ly lz l ma mb">'used', 'mama', 'earth', 'newly', 'launched', 'onion', 'oil', 'twice', 'must', 'say', 'im', 'already', 'impressed', 'results', 'prevents', 'hair', 'loss', 'helps', 'control', 'premature', 'greying', 'dryness', 'dandruff', 'scalp', 'eruptions', 'many', 'problems', 'regular', 'use', 'avoid', 'dry', 'frizzy', 'make', 'sure', 'hairs', 'week', 'oiling', 'provides', 'essential', 'nutrients', 'also', 'strengthens', 'roots', 'mamaearth', 'works', 'best', 'seasons', 'bad', 'product', 'falling', 'increase', 'much', 'order', 'shampoo', 'mask', 'nothing', 'stop', 'hairfallafter', '3', '4', 'wash', 'badly', 'smells', 'similar', 'navarathna', 'strong', 'sticky', 'applying', 'three', 'drops', 'review', 'usage', '2', 'months1', 'worst', 'product2', 'fall', 'increased', 'lot3', 'brought', 'watching', 'youtube', 'influencer', 'mumbaiker', 'nikhil4', 'totally', 'misguided', 'never', 'take', 'suggestions', 'influencers', '5', 'using', 'since', 'months', 'result', 'losing', 'hair6', 'wasted', 'money', 'well', 'damaged', 'hair7', 'better', 'provide',</span></pre><p id="3aad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">reviews text = reviews _ df . clean _ review _ text . values<br/>reviews vec =[nltk . word _ token ize(review)for reviews text]<br/>len(reviews vec)</p><p id="6877" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">2778</p><p id="efe9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">利用训练好的模型寻找某个词的相似度。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/64c6fa2adfd1550ee47a097fcb0afd7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uZoV7okzyjpiGVjr0z-E2A.png"/></div></div></figure><h2 id="596d" class="kj kk hi bd kl km kn ko kp kq kr ks kt jg ku kv kw jk kx ky kz jo la lb lc ld bi translated">结论</h2><p id="fdbb" class="pw-post-body-paragraph iv iw hi ix b iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">我们经历了将文本数据编码成数字向量和训练分类模型的不同技术。但是哪种技术适合我们的机器学习模型取决于数据的结构和业务问题。</p></div></div>    
</body>
</html>