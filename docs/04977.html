<html>
<head>
<title>Pandas time machine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫时光机</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-time-machine-38fcb2e77dd3?source=collection_archive---------45-----------------------#2020-04-06">https://medium.com/analytics-vidhya/pandas-time-machine-38fcb2e77dd3?source=collection_archive---------45-----------------------#2020-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ab54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">pandas中的Datetime格式并使用matplotlib绘制图表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/6095856ae6de0acf070923cab51f1976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HLaEpjbotifvZitg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">乔尔·穆尼斯在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2163" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的<a class="ae jt" rel="noopener" href="/@tomcat_iv/fly-to-jupyter-notebook-3c0b90f6825b">上一篇文章</a>中，我开始学习如何使用Jupyter notebook，从REST API加载数据并解析JSON。</p><p id="7d2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我继续学习如何与Jupyter和熊猫一起工作。</p><h2 id="66d4" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">任务:通过这个参数找到一个最小次数并比较一个团队中的飞行员。</h2><p id="a67e" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在Pandas中添加一个最小列非常简单:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="157b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们创建一个新列“最小时间”(results_df['最小时间'])，并分配Q1、Q2和Q3的最小值:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/4d9b14ce3be6697905471e876bd6724d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*IeWJ0WPtbGhAdGD8fMjt2w.png"/></div></figure><p id="9858" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们为每个团队创建一个数据集:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="28a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要创建具有搜索标准的数据集，我们需要将该标准放在数据集的方括号中。例如，对于梅赛德斯来说，它看起来像:</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="4daf" class="ju jv hi ky b fi lc ld l le lf">results_mercedes = results_df[results_df[‘Team’] == ‘Mercedes’]</span></pre><p id="baef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许可以动态地创建这些数据集，但这是一次性的工作，所以这样做就足够了。</p><p id="0658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们要把每轮的第一名和第二名分开。让我们试着用奔驰的数据集来做。</p><p id="c6d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为之前我们的数据集是按<strong class="ih hj"> Round+Position </strong>排序的，所以这种排序在新的数据集中是相同的。这意味着所有奇数位置是第一位，所有偶数位置是第二位。</p><p id="85cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了创建一个仅具有奇数位置的新数据集，我们需要使用Python构造<strong class="ih hj">【first:last:step】</strong>来获得看起来如下的概率:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="ff8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[::2]表示—从零(参数[first:last:1]的默认值)开始，以步长等于2结束。<strong class="ih hj"> iloc </strong>是一个pandas方法，它返回一个具有给定索引的向量。</p><p id="4d3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果看起来像这样:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/e3acff4331e3c0f4cadf40caf6902e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*LvHJfeOLTTXOYrl84o1h0g.png"/></div></figure><p id="8b63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看起来不错。现在是第二个位置，所有的矢量都是偶数行。</p><p id="2538" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应该差不多，只是从元素1开始而不是从零开始。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="35a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果是:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/2b569b6a4434eb3d969e8d093bb8dea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*jLY7YRtDQdOxe9t1FG8RfA.png"/></div></figure><p id="5b61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，为了找出差异，我们需要创建另一个数据集，将两个驱动因素放在一个向量中。数据集列将如下所示:</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="6d8f" class="ju jv hi ky b fi lc ld l le lf">[“Round”, “Country”, “First Driver”, “Second Driver”, “First min_time”, “Second min_time”]</span></pre><p id="ce5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用for循环来创建它:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/bc7ab33f81a165a3393742fb62bda947.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*84S_oTCzaOavoP9cRQDZMA.png"/></div></figure><p id="3d4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一眼看上去不错。但是这里有一个问题—字符串格式的时间，所以我们不能仅仅将它们作为时间来比较，我们需要将类型改为datetime。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="4a19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将“第一分钟时间”和“第二分钟时间”转换为日期时间格式<strong class="ih hj"> format='%M:%S.%f' </strong>，这意味着<strong class="ih hj">分:秒.毫秒</strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/4700eb0b9d93d10799f8f66513dd7e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*Izx3qM8ELNPQVEzhAUtA-Q.png"/></div></figure><p id="86f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，我知道，这些“1900-01-01 ..”看起来不酷，但现在我看到它是一种日期时间格式，可以找到秒的差异:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lk"><img src="../Images/d17d68256c546618db316bfef7e1a043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*W8QiGW2c-rjvtHgIxTuMqQ.png"/></div></figure><p id="0a13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很好，又快又简单。“差异”栏的格式为<strong class="ih hj"> timedelta </strong>。</p><p id="1ca2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们画一张图:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ll"><img src="../Images/56d6a018b8990dc9f2975b4d05b65a60.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*K13CuovpOk8kMEu9rOzrhw.png"/></div></figure><p id="d907" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看起来不错，但还可以更好。</p><p id="a95c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想看看谁是第一名，以及每一列的确切差异。</p><p id="aad8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此我们可以使用matplotlib库。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="1a4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们创建一个地块，设置标题“2019年梅赛德斯最佳时间的差异”，初始化轴，刻度，标签和图例。</p><p id="6f2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并在每列上创建一个带有值的标签:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/853cd637b784f099ee0db855ce47c770.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*VuZr7rsGCJ6cQyz0MRODEQ.png"/></div></figure><p id="2818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看起来不错！</p><p id="9342" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论:</strong>在本文中，我们将学习如何使用tome和timedelta值，以及如何使用matplotlib绘制图表。</p></div></div>    
</body>
</html>