<html>
<head>
<title>Stationarity for Timeseries Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列分析的平稳性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/stationarity-for-timeseries-analysis-51b1f5d9749e?source=collection_archive---------10-----------------------#2020-11-20">https://medium.com/analytics-vidhya/stationarity-for-timeseries-analysis-51b1f5d9749e?source=collection_archive---------10-----------------------#2020-11-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="146d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果时间序列没有趋势或任何季节效应，那么它就是平稳的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/e10f3953c12544eeaa23e0ac62a1ab14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_nhrlAfPE85z6oWSOJ67Bg.gif"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><a class="ae jq" href="https://moyhu.blogspot.com/2011/06/time-series-plots-using-animation.html" rel="noopener ugc nofollow" target="_blank">图片由</a>提供</figcaption></figure><p id="2dce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平稳性是执行时间序列分析或时间序列预测的基本构件之一。</p><blockquote class="jr js jt"><p id="1f28" class="if ig jd ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated">为什么我们这么在意时间序列是否平稳？</p></blockquote><p id="ea94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为统计建模方法假设或要求时间序列是平稳的才有效。因此，为了有效地使用任何统计建模技术，必须检查其中是否存在任何趋势或季节性。</p><blockquote class="jr js jt"><p id="b7c2" class="if ig jd ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated">我们如何用统计学术语定义平稳性？</p></blockquote><p id="f348" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平稳时间序列的汇总统计数据将保持不变或随时间变化很小。例如均值和方差。</p><blockquote class="jr js jt"><p id="a2cf" class="if ig jd ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated">检验数列平稳性的方法有哪些？</p></blockquote><ol class=""><li id="f814" class="jx jy hi ih b ii ij im in iq jz iu ka iy kb jc kc kd ke kf bi translated">视觉上——最简单</li><li id="ca7f" class="jx jy hi ih b ii kg im kh iq ki iu kj iy kk jc kc kd ke kf bi translated">统计测量——平均值、方差等。</li><li id="170a" class="jx jy hi ih b ii kg im kh iq ki iu kj iy kk jc kc kd ke kf bi translated">统计测试-被认为是最有效的。</li></ol><p id="32bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们用两个非常流行的数据集来深入研究它们。数据集的链接将在文章末尾提供。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="b41c" class="kx ky hi kt b fi kz la l lb lc"><strong class="kt hj">#DATA 1: <br/>import </strong>pandas <strong class="kt hj">as </strong>pd<br/><strong class="kt hj">import </strong>numpy <strong class="kt hj">as </strong>np<br/><strong class="kt hj">import </strong>matplotlib.pyplot <strong class="kt hj">as </strong>plt<br/>data = pd.read_csv(<strong class="kt hj">"daily-total-female-births.csv"</strong>)</span><span id="947f" class="kx ky hi kt b fi ld la l lb lc">data.plot(color=<strong class="kt hj">"yellowgreen"</strong>)<br/>data.hist(color=<strong class="kt hj">"yellowgreen"</strong>)<br/>plt.show()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es le"><img src="../Images/e1a790cb0a7427903fe6006da25b0d69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*nomQuph5jEG5Vru2TMI46A.png"/></div></figure><p id="daa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目测:</strong>没有上升和下降的趋势。因此，它是静止的。</p><p id="7d65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">统计度量:</strong>均值和方差只有在数据符合高斯分布的情况下才有意义。直方图显示数据遵循正态分布，右侧几乎没有偏斜。</p><p id="53cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将数据分成三份(连续序列),并比较它们的均值和方差。然后，如果每次分割的均值和方差大致保持不变，则时间序列是平稳的。</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="6a45" class="kx ky hi kt b fi kz la l lb lc"><em class="jd">#split the data into three<br/></em>split = round(len(data) / 3)<br/>data1, data2, data3 = data[0:split], data[split:(2 *split)], data[(2 *split):]<br/>mean1,mean2,mean3 = data1[<strong class="kt hj">"Births"</strong>].mean(), data2[<strong class="kt hj">"Births"</strong>].mean(),data3[<strong class="kt hj">"Births"</strong>].mean()<br/>var1, var2,var3 =  data1[<strong class="kt hj">"Births"</strong>].var(), data2[<strong class="kt hj">"Births"</strong>].var(),data3[<strong class="kt hj">"Births"</strong>].var()</span><span id="f245" class="kx ky hi kt b fi ld la l lb lc">print(<strong class="kt hj">"The means are :"</strong>, str(round(mean1,2))+<strong class="kt hj">","</strong>,str(round(mean2,2))+<strong class="kt hj">","</strong>,round(mean3,2))<br/>print(<strong class="kt hj">"The variances are :"</strong>, str(round(var1,2))+<strong class="kt hj">","</strong>,str(round(var2,2))+<strong class="kt hj">","</strong>,round(var3,2))</span></pre><p id="a451" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果是:均值和方差不同，但非常接近。</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="59fb" class="kx ky hi kt b fi kz la l lb lc">The means are : 39.68, 41.33, 44.96<br/>The variances are : 54.35, 38.75, 55.16</span></pre><p id="8dd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们用另一个数据集来尝试一下:</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="6128" class="kx ky hi kt b fi kz la l lb lc"><strong class="kt hj">#DATA 2</strong><em class="jd"><br/></em><strong class="kt hj">import </strong>pandas <strong class="kt hj">as </strong>pd<br/><strong class="kt hj">import </strong>matplotlib.pyplot <strong class="kt hj">as </strong>plt<br/>data = pd.read_csv(<strong class="kt hj">"airline-passengers.csv"</strong>)</span><span id="d30d" class="kx ky hi kt b fi ld la l lb lc">data.plot(color=<strong class="kt hj">"sandybrown"</strong>)<br/>data.hist(color =<strong class="kt hj">"sandybrown"</strong>)<br/>plt.show()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lf"><img src="../Images/615689c162753fcaf622866d60cec945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*TPjTGoEVDjkFW6-N-Q03nQ.png"/></div></figure><p id="ddb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目测:</strong>明显的上升趋势。因此，它是不稳定的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lg"><img src="../Images/43cf98c5353b82a7320b108c4d8cd276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LqdDtkWDaoJ1lCTWKfHCxA.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">直方图突出显示了对数变换后的分布变化</figcaption></figure><p id="687d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">统计测量:</strong>直方图清楚地显示数据没有遵循高斯趋势。但是，如果我们尝试一些转换，使数据遵循高斯分布呢？一种流行的方法是使用<strong class="ih hj"> log </strong>转换。</p><p id="4372" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们像以前一样尝试计算平均值和方差。</p><p id="54e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据2的结果将是:</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="62db" class="kx ky hi kt b fi kz la l lb lc">Without log transformation</span><span id="4dd6" class="kx ky hi kt b fi ld la l lb lc">The means are : 158.38, 269.04, 413.48<br/>The variances are : 1094.66, 3106.0, 6162.0</span><span id="598a" class="kx ky hi kt b fi ld la l lb lc">With log transformation</span><span id="1417" class="kx ky hi kt b fi ld la l lb lc">The means are : 5.04, 5.57, 6.01<br/>The variances are : 0.04, 0.04, 0.03</span></pre><p id="500b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，均值和方差都差不多。这可能表明，变换后的序列遵循平稳性，这必须从线图明显。所以，我们来画一下。</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="fb46" class="kx ky hi kt b fi kz la l lb lc">np.log(data[<strong class="kt hj">"Passengers"</strong>]).plot(color =<strong class="kt hj">"sandybrown"</strong>)<br/>plt.show()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es ll"><img src="../Images/e46c6344aa80def658f5f4b82c3e4985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VK2SHwK3totpkJ0F23IQOA.png"/></div></div></figure><p id="7d4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哇哦。刚刚发生了什么？线条图似乎完全不遵循平稳性。因此，仅仅依靠均值和方差进行平稳性检查是不够的。我们需要一个更强大的方法来检查。</p><p id="ddbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是另一个统计测试发挥作用的方式，通常被称为<strong class="ih hj">增强的Dickey-Fuller测试</strong>。</p><blockquote class="jr js jt"><p id="b0c3" class="if ig jd ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated">什么是<strong class="ih hj">增强迪基-富勒测试？</strong></p></blockquote><p id="b42c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它也被称为ADF测试，一种单位根测试。单位根是非平稳性背后的原因。根据单位根，我们可以将平稳时间序列定义为:</p><p id="0a8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">时间序列是平稳的，如果时间上的单个移动不改变时间序列的统计特性，在这种情况下单位根不存在。</em></p><p id="88b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">扩充的Dickey-Fuller检验的无效假设和替代假设定义如下:</p><p id="2d19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">零假设</strong> =非平稳(单位根存在)<br/> <strong class="ih hj">交替假设</strong> =平稳</p><p id="c202" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们编写一个执行测试的类，这样将来测试一个时间序列就更容易了。</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="e790" class="kx ky hi kt b fi kz la l lb lc"><strong class="kt hj">class </strong>StationaryCheck:<br/>    <strong class="kt hj">def </strong>__init__(self, significance=0.05):<br/>        self.SignificanceLevel = significance<br/>        self.pvalue = <strong class="kt hj">None<br/>        </strong>self.isStationary = <strong class="kt hj">None</strong></span><span id="3c08" class="kx ky hi kt b fi ld la l lb lc"><strong class="kt hj">    def </strong>ADF(self, data):<br/>        <em class="jd"># Do the test<br/>        </em>adf = adfuller(data, autolag=<strong class="kt hj">'AIC'</strong>)</span><span id="cba7" class="kx ky hi kt b fi ld la l lb lc">        <em class="jd"># format the result<br/>        </em>adf_result = pd.Series(adf[0:4], index=[<strong class="kt hj">'ADF Test Statistic'</strong>, <strong class="kt hj">'P-Value'</strong>, <strong class="kt hj">'# Lags Used'</strong>, <strong class="kt hj">'# Observations Used'</strong>])</span><span id="4824" class="kx ky hi kt b fi ld la l lb lc">        <em class="jd"># also add critical values<br/>        </em><strong class="kt hj">for </strong>key, value <strong class="kt hj">in </strong>adf[4].items():<br/>            adf_result[<strong class="kt hj">"Critical Value (%s)" </strong>% key] = value</span><span id="795e" class="kx ky hi kt b fi ld la l lb lc">        print(adf_result)</span></pre><p id="4ea1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过将它应用于我们的非平稳数据来测试这一点。</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="c77b" class="kx ky hi kt b fi kz la l lb lc">test = StationaryCheck()<br/>print(<strong class="kt hj">"Result Check : "</strong>)<br/>print(<strong class="kt hj">""</strong>)<br/>test.ADF(data[<strong class="kt hj">"Passengers"</strong>].values)</span></pre><p id="be9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果是:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lm"><img src="../Images/694818632f4dcee08b2c0ef5b206e08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*LzECX0hSFufsoQAPgk_qXQ.png"/></div></figure><p id="0b50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，很容易看出数列不是平稳的。p值0.99大于我们5%的显著性水平，因此我们<strong class="ih hj">无法拒绝</strong>单位根确实存在的无效假设。</p><p id="ff20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以，测试这一个随机产生的新潮数据:</p><pre class="jf jg jh ji fd ks kt ku kv aw kw bi"><span id="d045" class="kx ky hi kt b fi kz la l lb lc"><em class="jd">#Not statiopnary<br/></em><strong class="kt hj">from </strong>random <strong class="kt hj">import </strong>random<br/><strong class="kt hj">import </strong>pandas <strong class="kt hj">as </strong>pd<br/><strong class="kt hj">import </strong>matplotlib.pyplot <strong class="kt hj">as </strong>plt</span><span id="408b" class="kx ky hi kt b fi ld la l lb lc">random_walk = list()<br/>random_walk.append(-1 <strong class="kt hj">if </strong>random() &lt; 0.5 <strong class="kt hj">else </strong>1)<br/><strong class="kt hj">for </strong>i <strong class="kt hj">in </strong>range(1, 1000):<br/>    movement = -1 <strong class="kt hj">if </strong>random() &lt; 0.5 <strong class="kt hj">else </strong>1<br/>    value = random_walk[i-1] + movement<br/>    random_walk.append(value)<br/>pd.Series(random_walk).plot(color = <strong class="kt hj">"green"</strong>)<br/>plt.show()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ln"><img src="../Images/4b504d6bd38779570a39c608ab167a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*5bh-U0meD0MVFQWiVNcxXw.png"/></div></figure><p id="2c90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">即使在这里，级数也不是静止的。p值0.99大于我们5%的显著性水平，因此我们<strong class="ih hj">无法拒绝</strong>单位根确实存在的无效假设。</p><p id="2a92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，如果我们对静态数据进行同样的测试，结果将是:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lo"><img src="../Images/55fdd9119abcd40f571e34eb5d7c6fb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*TbC30UbPLCOc2TUlwVv4_Q.png"/></div></figure><p id="ab65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，数列是平稳的。p值0.000052小于我们的5%显著性水平，因此我们<strong class="ih hj">拒绝</strong>单位根存在的无效假设。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="adb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你喜欢这篇文章。感谢您抽出时间阅读这篇文章。请留下反馈或任何您想分享的与时间序列或平稳性特别相关的内容。</p><p id="206f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">参考文献</em>:</p><ol class=""><li id="afe2" class="jx jy hi ih b ii ij im in iq jz iu ka iy kb jc kc kd ke kf bi translated"><a class="ae jq" href="https://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/" rel="noopener ugc nofollow" target="_blank"><em class="jd">https://machinelingmastery . com/gentle-introduction-random-walk-times-series-forecasting-python/</em></a></li><li id="c1b7" class="jx jy hi ih b ii kg im kh iq ki iu kj iy kk jc kc kd ke kf bi translated"><a class="ae jq" href="https://www.hackdeploy.com/augmented-dickey-fuller-test-in-python/" rel="noopener ugc nofollow" target="_blank"><em class="jd">https://www . hack deploy . com/augmented-dickey-fuller-test-in-python/</em></a></li><li id="7ddd" class="jx jy hi ih b ii kg im kh iq ki iu kj iy kk jc kc kd ke kf bi translated"><a class="ae jq" rel="noopener" href="/@kangeugine/time-series-check-stationarity-1bee9085da05"><em class="jd">https://medium . com/@ kang eugine/time-series-check-stationary-1 bee 9085 da 05</em></a></li></ol><p id="b1cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">数据集:</em></p><p id="cd34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">数据1: </em></p><p id="e4cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jq" href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/daily-total-female-births.csv" rel="noopener ugc nofollow" target="_blank"><em class="jd">https://raw . githubusercontent . com/jbrownlee/Datasets/master/daily-total-female-births . CSV</em></a></p><p id="440f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">数据二:</em></p><p id="5d04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jq" href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/airline-passengers.csv" rel="noopener ugc nofollow" target="_blank"><em class="jd">https://raw . githubusercontent . com/jbrownlee/Datasets/master/airline-passengers . CSV</em></a>时间序列分析的平稳性</p></div></div>    
</body>
</html>