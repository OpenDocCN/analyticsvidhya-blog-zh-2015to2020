<html>
<head>
<title>How to create Coronavirus Dashboard with Python and Dash?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python和Dash创建冠状病毒Dashboard？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-create-coronavirus-dashboard-with-python-and-dash-cbbfe95ce5d5?source=collection_archive---------18-----------------------#2020-03-21">https://medium.com/analytics-vidhya/how-to-create-coronavirus-dashboard-with-python-and-dash-cbbfe95ce5d5?source=collection_archive---------18-----------------------#2020-03-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c4ea7de7261bcf617a715b0c6474f650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TAXT0rSTgmZFz1nFMWsotw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">案例数量与天数</figcaption></figure><p id="aaa6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">冠状病毒传播是现在每个人都在谈论的话题。第一个病例出现在中国，现在它已经传播到全世界186个国家。不同国家的病例增长率不同。虽然像新加坡这样的国家很好地抗击了这种病毒，并保持了较低的病例数，但在像意大利这样的一些国家，病例数呈指数增长。为了比较每个国家如何对抗病毒，我用python创建了一个使用pandas和dash库的仪表板。在这个故事中，我将告诉你我是如何做到的。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es js"><img src="../Images/45d8add5b857abca1ed8cc43cdc57152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byL8af_IzEINSaXwJY_G-Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">约翰·霍普斯金大学创建的仪表板</figcaption></figure><p id="84a3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我将使用约翰霍普金斯大学github repo的数据。他们每天都在更新病例和死亡人数。</p><p id="3eb7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在让我们做一些编码。</p><p id="d639" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们需要导入库来获取数据和绘制仪表板。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="7ee6" class="kc kd hi jy b fi ke kf l kg kh">import dash<br/>import dash_core_components as dcc<br/>import dash_html_components as html<br/>import plotly.graph_objs as go<br/>import pandas as pd</span></pre><p id="3b85" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您可以通过提供熊猫数据帧的url来读取数据，如下所示:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="e4aa" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">url=”</strong><a class="ae ki" href="https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv" rel="noopener ugc nofollow" target="_blank"><strong class="jy hj">https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv</strong></a><strong class="jy hj">"</strong></span><span id="db3d" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">df = pd.read_csv(url)</strong></span></pre><p id="0a7f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此后，我们可以在以后很长一段时间内去掉列，因为我们的工作不需要它们。此外，我们将按国家对我们的数据进行分组。之后，我们将转置数据，使每个国家将是一列，日期将行。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="1fc1" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df = pd.read_csv(url)<br/>df_cntry=df.groupby(“Country/Region”).sum()<br/>df_cntry = df_cntry.drop([‘Lat’,’Long’], 1)<br/>df_cntry=df_cntry.T <br/>df_cntry.reset_index(inplace=True)<br/>df_cntry[‘index’]=df_cntry[‘index’].apply(pd.to_datetime)</strong></span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/a4e00a6987e0742eb4edb73c2c78e506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6jM-lhuFWxKEFGhGs5KSsw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">删除last、long并转置数据帧后，数据帧如下所示。</figcaption></figure><p id="d2d0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们需要检查发现病例的第一天。</p><p id="a3fb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">新冠肺炎病例首次在以下国家出现的日期如下:</p><p id="3849" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">意大利:2010年1月31日，伊朗:2010年2月18日，德国:2010年1月26日，土耳其:2010年3月13日，美国:2010年2月23日</p><p id="52b8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们将在字典中定义这些日期:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="1379" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">firstday_cntry={‘Italy’:”2/19/20",’Iran’:”2/18/20",’Germany’:”2/18/20",’Turkey’:”3/13/20",’US’:”2/23/20"}<br/>cntry_names=firstday_cntry.keys()</strong></span></pre><p id="9e66" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们将得到一个国家第一次约会后的病例数。为此，我们将在下面创建一个名为“df_new”的新数据帧。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9fd5" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">numbers=[]</strong></span><span id="a7a9" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">for i in range(45):<br/>    numbers.append(i)</strong></span><span id="df38" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">new_numbers=[]</strong></span><span id="8447" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">for k,v in firstday_cntry.items():<br/>    new_numbers.append(df_cntry[df_cntry[‘index’]&gt;v][k].tolist())</strong></span><span id="2150" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">df_new = pd.DataFrame(new_numbers)<br/>df_new = df_new.T<br/>df_new.columns = cntry_names<br/>df_new[‘Day’] = pd.Series(numbers)</strong></span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kl"><img src="../Images/298b2ab43877d17b5b4f34082518109c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A8W6b8zhTxC28np9sxVylQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">这些数字显示了自第一例病例以来每个国家的病例数。例如，土耳其在7天前发现了第一例，因此第7行后的值将为“nan”。</figcaption></figure><p id="2039" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在是时候创建dashbord了。为了创建dashboard，我们将使用for循环创建两个名为labels和traces的字典。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9b1e" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">external_stylesheets = [‘</strong><a class="ae ki" href="https://codepen.io/chriddyp/pen/bWLwgP.css'" rel="noopener ugc nofollow" target="_blank"><strong class="jy hj">https://codepen.io/chriddyp/pen/bWLwgP.css'</strong></a><strong class="jy hj">]</strong></span><span id="ba5b" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">app = dash.Dash(__name__, external_stylesheets=external_stylesheets)</strong></span><span id="76ae" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">traces = []<br/>labels=[]</strong></span><span id="b867" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">for i in cntry_names:<br/>    traces.append(dict(<br/>    x = df_new[‘Day’],<br/>    y = df_new[i],<br/>    text = i,<br/>    opacity=0.7,<br/>    name=i<br/> ))<br/> <br/> labels.append(dict({ ‘label’ : i, ‘value’ : i} ))</strong></span></pre><p id="88b1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们准备启动我们的仪表板。使用下面的代码，我们可以启动它。在您的浏览器上进入“<a class="ae ki" href="http://127.0.0.1:8050/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8050/ </a>”，您将看到仪表盘。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="ffd9" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">app.layout = html.Div([<br/> html.Div(</strong></span><span id="1612" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">dcc.Graph(id=”barplot”,</strong><br/><strong class="jy hj"> figure={<br/> “data”: traces,<br/> “layout”: go.Layout(<br/> title=”Covid-19",<br/>)}<br/>)),<br/>html.Div(<br/>dcc.Dropdown(<br/> options=labels<br/>)<br/>)])</strong></span><span id="7da1" class="kc kd hi jy b fi kj kf l kg kh"><strong class="jy hj">if __name__ == “__main__”:<br/> app.run_server()</strong></span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c4ea7de7261bcf617a715b0c6474f650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TAXT0rSTgmZFz1nFMWsotw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">最终仪表板</figcaption></figure><p id="b789" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们可以看到，第6天的病例数如下:</p><p id="fb1c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">意大利:453人，土耳其:359人，伊朗:95人，美国:74人，德国:17人</p><p id="5c62" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作为结论，如果不采取其它预防措施，到第9天，土耳其将有超过1000个病例。我们可以看到，与其他国家相比，我国抗击冠状病毒的能力有多强。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/db497805ba40e8de9b2cd549ba8ace47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vIEAhKk9PoYEXeyJ1Ln1Eg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">第九天</figcaption></figure></div></div>    
</body>
</html>