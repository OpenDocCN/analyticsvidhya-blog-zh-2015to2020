# Python ä¸­å¯å˜çš„é»˜è®¤å‚æ•° Mess

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/the-mutable-default-argument-mess-in-python-c0692c3032de?source=collection_archive---------32----------------------->

![](img/aa820996364ba03cfd800d177a1fb84c.png)

è§è§å‡¯æ–‡ï¼ŒğŸ™‹â€â™‚ï¸Â·å‡¯æ–‡æ­£åœ¨å­¦ä¹  Pythonã€‚ä¸€å¤©ï¼Œä»–è¢«è¦æ±‚è§£å†³å¦‚ä¸‹é—®é¢˜:

> è®¾è®¡ä¸€ä¸ªå‡½æ•°ï¼Œå°†' # 'è¿½åŠ åˆ°ä½œä¸ºå‚æ•°æä¾›çš„åˆ—è¡¨ä¸­ï¼Œç„¶åæ‰“å°å‡ºæ¥ã€‚å¦‚æœæ²¡æœ‰æä¾›å‚æ•°ï¼Œé‚£ä¹ˆå‡½æ•°åº”è¯¥ä½¿ç”¨ä¸€ä¸ªç©ºåˆ—è¡¨ä½œä¸ºç¼ºçœå€¼ã€‚

å‡¯æ–‡å¾ˆå¿«æƒ³å‡ºäº†ä»¥ä¸‹è§£å†³æ–¹æ¡ˆ:

```
def append(l = []):
    l.append('#')
    print(l)
```

çœ‹èµ·æ¥ä¸é”™ï¼Œè¯¥æµ‹è¯•è§£å†³æ–¹æ¡ˆäº†:

```
append([1, 2, 3])
# OUTPUT: [1, 2, 3, '#'] | OKappend()
# OUTPUT: ['#']    | OKappend()
# OUTPUT: ['#', '#']  | Strange!!
```

*   å¯¹`append`çš„ç¬¬ä¸€æ¬¡è°ƒç”¨è¿è¡Œè‰¯å¥½ã€‚å®ƒå°†#æ·»åŠ åˆ°åˆ—è¡¨`[1, 2, 3]`ä¸­ï¼Œç„¶åæ‰“å°å®ƒã€‚
*   ç¬¬äºŒä¸ªä¹Ÿåƒé¢„æœŸçš„é‚£æ ·èµ·ä½œç”¨ã€‚è¿™ä¸€æ¬¡æ²¡æœ‰æä¾›åˆ—è¡¨ä½œä¸ºå‚æ•°ï¼Œæ‰€ä»¥å®ƒä½¿ç”¨é»˜è®¤çš„ç©ºåˆ—è¡¨å¹¶é™„åŠ äº†ä¸€ä¸ª#å·ã€‚
*   ç°åœ¨ï¼Œç¬¬ä¸‰ä¸ªç”µè¯å¯¼è‡´äº†æ„æƒ³ä¸åˆ°çš„äº‹æƒ…ã€‚
*   å½“æˆ‘ä»¬å†æ¬¡æ— äº‰è®ºåœ°è°ƒç”¨`append`æ—¶ï¼Œå®ƒæ‰“å°å‡º`['#', '#']`è€Œä¸æ˜¯æˆ‘ä»¬åœ¨ä¸Šé¢çš„è°ƒç”¨ä¸­å¾—åˆ°çš„`['#']`ã€‚

# ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ

å‘ç”Ÿè¿™ç§æƒ…å†µçš„åŸå› æ˜¯ Python åªåœ¨ç¬¬ä¸€æ¬¡å®šä¹‰å‡½æ•°æ—¶å®šä¹‰äº†ä¸€æ¬¡é»˜è®¤å‚æ•°*ã€‚*

è¿™æ˜¯å› ä¸º python æ˜¯é€è¡Œè§£æçš„ï¼Œå½“è§£æå™¨é‡åˆ°`def`æ—¶ï¼Œå®ƒä¼šå°†é»˜è®¤å‚æ•°è®¾ç½®ä¸ºä¸€ä¸ªå€¼ï¼Œè¯¥å€¼å°†åœ¨ä»¥åçš„æ¯æ¬¡è°ƒç”¨ä¸­ä½¿ç”¨ã€‚

å½“é»˜è®¤å‚æ•°æ˜¯**å¯å˜çš„**æ—¶ï¼ŒPython çš„è¿™ç§è¡Œä¸ºå°±å˜å¾—ç‰¹åˆ«å€¼å¾—å…³æ³¨ã€‚

ç”±äº **immutables** çš„å€¼ä¸å¯æ›´æ”¹ï¼Œå¦‚æœæ‚¨æ›´æ–°å‡½æ•°ä¸­çš„è‡ªå˜é‡å˜é‡ï¼Œå®ƒå°†åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å¹¶å¼€å§‹æŒ‡å‘è¯¥å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ›´æ”¹åŸæ¥çš„é»˜è®¤å¯¹è±¡ã€‚

ä½†æ˜¯åœ¨å¯å˜é»˜è®¤å‚æ•°çš„æƒ…å†µä¸‹ï¼Œè§£æå‡½æ•°æ—¶åˆ›å»ºçš„å¯¹è±¡è¢«æ›´æ–°ï¼Œè€Œä¸æ˜¯ä¸ºè¯¥å‡½æ•°è°ƒç”¨åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚

# è§£å†³åŠæ³•

è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä¸å¯å˜çš„é»˜è®¤å‚æ•°ï¼Œè€Œä¸æ˜¯å¯å˜çš„ã€‚é¦–é€‰æ˜¯`None`(å°½ç®¡æ‚¨å¯ä»¥é€‰æ‹©ä»»ä½•ä¸å¯å˜çš„å€¼)ã€‚

```
def append(l = None):
    if l is None:
        l = []
    l.append('#')
    print(l)
```

è®©æˆ‘ä»¬æµ‹è¯•è¿™ä¸ªè§£å†³æ–¹æ¡ˆ-

```
append([1, 2, 3])
# OUTPUT: [1, 2, 3, '#']    | OKappend()
# OUTPUT: ['#']     | OKappend()
# OUTPUT: ['#']        | Works fine!
```

å¤ªå¥½äº†ï¼è¿™ä¸ªè§£å†³æ–¹æ¡ˆå¦‚é¢„æœŸçš„é‚£æ ·æœ‰æ•ˆã€‚

ä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹é‡Œé¢ã€‚

# ä¸ºä»€ä¹ˆè¯¥è§£å†³æ–¹æ¡ˆæœ‰æ•ˆï¼Ÿ

è§‚çœ‹æ­¤è§†é¢‘ï¼Œäº†è§£é”™è¯¯ç‰ˆæœ¬çš„ä»£ç ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ-

è§£å†³æ–¹æ¡ˆç¬¬ä¸€ç‰ˆçš„å·¥ä½œ

å¦‚æ‚¨æ‰€è§ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸå§‹çš„`l`è¢«ä¿®æ”¹ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªå‡½æ•°è°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°çš„`l`ï¼Œå› ä¸º`list`æ˜¯ä¸€ä¸ªå¯å˜å€¼ã€‚

ç°åœ¨ï¼Œçœ‹çœ‹ä»£ç çš„æ­£ç¡®ç‰ˆæœ¬-

è§£å†³æ–¹æ¡ˆç¬¬äºŒç‰ˆçš„å·¥ä½œ

è¿™é‡Œå› ä¸º`None`æ˜¯ä¸€ä¸ªä¸å¯å˜çš„å€¼ï¼Œæ‰€ä»¥å®ƒä¸èƒ½è¢«æ”¹å˜ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªå‡½æ•°è°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨å¯¹è±¡ã€‚

> æ³¨æ„:é»˜è®¤å‚æ•°æ˜¯å‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå› æ­¤ï¼Œæœ€åˆå®ƒå¯¹æ‰€æœ‰å‡½æ•°è°ƒç”¨éƒ½æ˜¯ä¸€æ ·çš„ã€‚

# æ„Ÿè°¢é˜…è¯»ğŸ˜Š

å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµå¹¶åˆ†äº«ï¼æ¬¢è¿åœ¨è¯„è®ºä¸­åé¦ˆæ„è§ã€‚

## æ‚¨å¯èƒ½è¿˜å–œæ¬¢:

*   [ç°ä»£ C++ç‰¹æ€§](https://blog.yuvv.xyz/modern-cpp-features)
*   [å½“ä½ è¿è¡Œä¸€ä¸ªè®¡ç®—æœºç¨‹åºæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ](https://blog.yuvv.xyz/what-happens-when-you-run-a-computer-program)
*   [Python ä¸­çš„ç†è§£:è§£é‡Š](https://blog.yuvv.xyz/comprehensions-in-python-explained)
*   [Linux å‘½ä»¤å‚è€ƒç¤ºä¾‹](https://blog.yuvv.xyz/linux-commands-reference-with-examples)

è¿™ç¯‡æ–‡ç« æœ€åˆå‘è¡¨åœ¨ [Yuvraj çš„ CS åšå®¢](https://blog.yuvv.xyz/the-mutable-default-argument-mess-in-python)

åœ¨ [Twitter](https://twitter.com/yuvraajsj18) ã€ [GitHub](https://github.com/yuvraajsj18) å’Œ [LinkedIn](https://www.linkedin.com/in/yuvraajsj18/) ä¸Šä¸æˆ‘è”ç³»ã€‚