<html>
<head>
<title>Email Extraction using Python with some filters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和一些过滤器提取电子邮件</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/email-extraction-using-python-with-some-filters-233ae451f011?source=collection_archive---------7-----------------------#2020-09-14">https://medium.com/analytics-vidhya/email-extraction-using-python-with-some-filters-233ae451f011?source=collection_archive---------7-----------------------#2020-09-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7ada" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文介绍了如何通过提供用户名和密码从给定的gmail中提取电子邮件的概念。现在，该脚本从gmail服务器提取邮件，但是您可以通过访问此处的查看imap提供的其他邮件服务器来推广该脚本。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/d9ab712d6a6bff5c5c896d9610c5eb41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*H2Wfwn9axtIQZogB3T6RCg.png"/></div></figure><p id="1a0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用以下库:</p><ol class=""><li id="9561" class="jm jn hi ih b ii ij im in iq jo iu jp iy jq jc jr js jt ju bi translated">imaplib</li><li id="626a" class="jm jn hi ih b ii jv im jw iq jx iu jy iy jz jc jr js jt ju bi translated">电子邮件</li><li id="2d53" class="jm jn hi ih b ii jv im jw iq jx iu jy iy jz jc jr js jt ju bi translated">操作系统（Operating System）</li><li id="21bf" class="jm jn hi ih b ii jv im jw iq jx iu jy iy jz jc jr js jt ju bi translated">日期时间</li></ol><p id="c23e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">确保通过检查此处的<a class="ae jd" href="https://myaccount.google.com/lesssecureapps?pli=1" rel="noopener ugc nofollow" target="_blank"/>来允许不太安全的应用程序。</p><p id="74a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我介绍了4种过滤器，即:</p><ol class=""><li id="5c7f" class="jm jn hi ih b ii ij im in iq jo iu jp iy jq jc jr js jt ju bi translated">getInfoAll —这将保存指定文件夹中的所有信息(在我们的例子中是“收件箱”)。</li><li id="5f52" class="jm jn hi ih b ii jv im jw iq jx iu jy iy jz jc jr js jt ju bi translated">getinfoter——这将从我们指定的日期开始保存指定文件夹(在我们的例子中是“收件箱”)中的所有信息。</li></ol><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ka"><img src="../Images/3e15be1b0dbd70986f7945a1e97cec54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k2XJGPDEPKgzMWY5ZMhObg.png"/></div></div></figure><p id="0ff7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.getInfoFrom——这将保存来自我们指定的发件人gmail的指定文件夹(在我们的例子中是“收件箱”)中的所有信息。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kf"><img src="../Images/c54bba5813ffaeb83e2ccf092f67c7f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9v4gbhVyE4gcf_38sIXEww.png"/></div></div></figure><p id="b96b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.getinfodatasender——这将保存指定文件夹(在我们的例子中是“收件箱”)中来自发件人gmail和我们指定日期的所有信息。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kg"><img src="../Images/da0a0aeea250322a65ffa5d0827692e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sWtYFO_P371N7EDR-3Vl-Q.png"/></div></div></figure><p id="9206" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请随意添加更多。这里我们使用imap从邮件服务器中检索信息。Content_disposition帮助我们决定邮件是否有附件。Content_type用于了解邮件的内容类型，如text/plain或html。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kh"><img src="../Images/8b845a164aa1c26357213c1e221da73f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*72sJNHEFIYMRmYQgr1vAwA.png"/></div></div></figure><p id="cec3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了理解这一点，我强烈建议在gmail的“显示原始选项”中打开带有附件的邮件。os.getcwd()用于返回当前工作目录，或者您可以指定您选择的特定目录。我正在创建“超过+计数器”作为目录的名称，如果主题长度超过30，你可以用任何其他方法。我已经为所有邮件定义了“textfile.txt”来下载除邮件附件之外的所有信息。在每个文本文件中，我都保存了以下信息—[收件人、发件人、日期、主题、正文]。您可以根据需要添加更多信息。</p><p id="b819" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了访问提取文件夹而不是“收件箱”，请使用mail.list()浏览其他文件夹。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ki"><img src="../Images/ba6253032ac031aa732869df826b5344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g6kLKG2-PPLswqEj14PLug.png"/></div></div></figure><p id="08b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#注意:当使用邮件的主题名称作为目录来下载信息时，一定要检查路径的长度，因为windows对路径长度有一些限制。</p><p id="2ba6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#注意:确保检查您系统支持的编码类型，并相应地进行修改。</p><p id="e317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#UPDATE:通过使用mimetype模块，您还可以只允许下载某些特定的文件格式。下面我们只允许pdf，jpg，png和doc文件。您可以根据自己的要求进行修改。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kj"><img src="../Images/81d8ad6e8524f8c45a74b31a7f5adb18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rUXOhL2t1E1fypC6-acDQg.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated">只允许下载特定的格式</figcaption></figure><p id="c7a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有关代码详情，请访问<a class="ae jd" href="https://github.com/jainyk/Email-extraction-along-with-some-filters-using-python" rel="noopener ugc nofollow" target="_blank">此处</a>。对于任何建议和改进，请在下面提出请求或评论。</p></div></div>    
</body>
</html>