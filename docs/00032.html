<html>
<head>
<title>What is GloVe?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是手套？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/word-vectorization-using-glove-76919685ee0b?source=collection_archive---------0-----------------------#2018-04-24">https://medium.com/analytics-vidhya/word-vectorization-using-glove-76919685ee0b?source=collection_archive---------0-----------------------#2018-04-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/f13b516a4bc976cbd4c510c579e42a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*HqoY7idcr6NL2ACA.png"/></div></figure><div class=""/><p id="2cf6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">GloVe代表单词表示的全局向量。它是由斯坦福大学开发的一种无监督学习算法，用于通过从语料库聚集全局单词-单词共现矩阵来生成单词嵌入。由此产生的嵌入显示了向量空间中单词的有趣的线性子结构。</p><p id="2bfa" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">线性子结构的例子有:</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/da242f9b140100f711ae2325f6128615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*b0XASlPfQmCJHLd1.jpg"/></div></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/8ffc16a13f53d6061931fd8da8723780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*B-LgyHJddn9wX8T4.jpg"/></div></figure><p id="603d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这些结果令人印象深刻。这种类型的表示在许多机器学习算法中非常有用。</p><p id="8a6c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要阅读更多关于单词矢量化的内容，你可以阅读我的另一篇文章。</p><p id="df09" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇博文中，我们将学习python中GloVe的实现。那么，我们开始吧。</p><h1 id="a68a" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">让我们创建嵌入</h1><h1 id="91ae" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">安装Glove-Python</h1><p id="f0b5" class="pw-post-body-paragraph im in hp io b ip kn ir is it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj hb bi translated">GloVe是用python实现的，可以在库<strong class="io hq"> glove-python中找到。</strong></p><pre class="jk jl jm jn fd ks kt ku kv aw kw bi"><span id="21e3" class="kx jq hp kt b fi ky kz l la lb">pip install glove_python</span></pre><h1 id="1a5d" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">文本预处理</h1><p id="5614" class="pw-post-body-paragraph im in hp io b ip kn ir is it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj hb bi translated">在这一步中，我们将对文本进行预处理，如删除停用词、对词进行词条归类等。</p><blockquote class="lc ld le"><p id="1a5a" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated">您可以根据自己的需求执行不同的步骤。</p></blockquote><p id="6f6a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我将使用nltk停用词语料库来移除停用词，并使用nltk词词条化来查找词条。</p><p id="d10e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了使用nltk语料库，您需要使用以下命令下载它。</p><h1 id="208e" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">下载语料库</h1><blockquote class="lc ld le"><p id="5812" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated">import nltk nltk . download()#这将打开一个GUI，您可以从中下载语料库</p></blockquote><h1 id="ef23" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">输入初始化</h1><blockquote class="lc ld le"><p id="ed4a" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated">#要矢量化的句子列表lines=[“你好，这是一个如何将单词转换为整数格式的教程”，“这是美好的一天”，“杰克要去办公室了”]</p></blockquote><h1 id="2318" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">删除停用词</h1><blockquote class="lc ld le"><p id="339b" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated">from nltk . corpus import stop words stop _ words = set(stop words . words(' English '))lines _ without _ stop words =[]# stop words包含line in lines:temp _ line =[]for word in lines:if word not in stop _ words:temp _ line . append(word)string = ' ' lines _ without _ stop words . append(string . join(temp _ line))lines = lines _ without _ stop words</p></blockquote><h1 id="9d85" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">词汇化</h1><blockquote class="lc ld le"><p id="dc80" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated"># import WordNet lemma tizer from nltk from nltk . stem import WordNet lemma tizer WordNet _ lemma tizer = WordNet lemma tizer()lines _ with _ lemmas =[]# stop words包含行中行的停用词集合:temp _ line =[]for word in lines:temp _ line . append(WordNet _ lemma tizer . lemma tize(word))string = ' ' lines _ with _ lemmas . append(string . join(temp _ line))lines = lines _ with _ lemmas</p></blockquote><p id="b669" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们已经完成了文本的基本预处理。任何其他预处理工作都可以类似地完成。</p><h1 id="4ce3" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">准备输入</h1><p id="a381" class="pw-post-body-paragraph im in hp io b ip kn ir is it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj hb bi translated">我们有一个行数组形式的输入。为了让模型处理数据，我们需要将输入转换为单词数组(:\)。</p><h1 id="a1a2" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我们的投入</h1><blockquote class="lc ld le"><p id="4f52" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated">lines=[“你好，这是一个关于如何将单词转换成整数格式的教程”，“这是美好的一天”，“杰克要去办公室了”]</p></blockquote><h1 id="fff6" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">新输入</h1><blockquote class="lc ld le"><p id="30de" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated">lines =[' Hello '，' this '，' tutorial '，' on '，' how '，' convert '，' word '，' integer '，' format']，['this '，' beautiful '，' day']，['Jack '，' going '，' office']</p><p id="3498" class="im in lf io b ip iq ir is it iu iv iw lg iy iz ja lh jc jd je li jg jh ji jj hb bi translated">对于行中的行，new _ lines =[]:new _ lines = line . split(' ')# new lines具有新格式lines=new_lines</p></blockquote><h1 id="8d0e" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">构建手套模型</h1><pre class="jk jl jm jn fd ks kt ku kv aw kw bi"><span id="8e24" class="kx jq hp kt b fi ky kz l la lb">#importing the glove library<br/>from glove import Corpus, Glove</span><span id="257f" class="kx jq hp kt b fi lj kz l la lb"># creating a corpus object<br/>corpus = Corpus() </span><span id="db59" class="kx jq hp kt b fi lj kz l la lb">#training the corpus to generate the co occurence matrix which is used in GloVe<br/>corpus.fit(lines, window=10)</span><span id="bcbc" class="kx jq hp kt b fi lj kz l la lb">#creating a Glove object which will use the matrix created in the above lines to create embeddings<br/>#We can set the learning rate as it uses Gradient Descent and number of components</span><span id="38e1" class="kx jq hp kt b fi lj kz l la lb">glove = Glove(no_components=5, learning_rate=0.05)<br/> <br/>glove.fit(corpus.matrix, epochs=30, no_threads=4, verbose=True)<br/>glove.add_dictionary(corpus.dictionary)<br/>glove.save('glove.model')</span></pre><p id="28ac" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建手套模型使用语料库对象生成的共现矩阵来创建嵌入。</p><p id="49ad" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq"> corpus.fit </strong>有两个参数:</p><ul class=""><li id="900c" class="lk ll hp io b ip iq it iu ix lm jb ln jf lo jj lp lq lr ls bi translated">线条——这是我们在预处理后创建的2D数组</li><li id="1665" class="lk ll hp io b ip lt it lu ix lv jb lw jf lx jj lp lq lr ls bi translated">窗口—这是两个单词之间的距离，algo应该考虑在这两个单词之间找到某种关系</li></ul><p id="60d6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">手套参数:</p><ul class=""><li id="dd45" class="lk ll hp io b ip iq it iu ix lm jb ln jf lo jj lp lq lr ls bi translated">组件数量—这是手套生成的输出向量的尺寸</li><li id="b99c" class="lk ll hp io b ip lt it lu ix lv jb lw jf lx jj lp lq lr ls bi translated">learning _ rate算法使用梯度下降，因此学习速率定义算法达到最小值的速率(速率越低，学习所需的时间越长，但达到最小值的时间越长)</li></ul><p id="4c91" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">glove.fit参数:</p><ul class=""><li id="4b72" class="lk ll hp io b ip iq it iu ix lm jb ln jf lo jj lp lq lr ls bi translated">共现矩阵:词-词共现矩阵</li><li id="503f" class="lk ll hp io b ip lt it lu ix lv jb lw jf lx jj lp lq lr ls bi translated">时期:这定义了算法通过数据集的次数</li><li id="b31a" class="lk ll hp io b ip lt it lu ix lv jb lw jf lx jj lp lq lr ls bi translated">线程数:算法运行时使用的线程数</li></ul><p id="fa5d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在训练手套对象有了我们提供的单词向量之后。但是字典仍然驻留在语料库对象中。我们需要将字典添加到glove对象中以使其完整。</p><pre class="jk jl jm jn fd ks kt ku kv aw kw bi"><span id="2089" class="kx jq hp kt b fi ky kz l la lb">glove.add_dictionary(corpus.dictionary)</span></pre><p id="2e29" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这一行在glove对象中做字典添加。之后，对象就可以为您提供嵌入了。</p><pre class="jk jl jm jn fd ks kt ku kv aw kw bi"><span id="eda2" class="kx jq hp kt b fi ky kz l la lb">print glove.word_vectors[glove.dictionary['samsung']]<br/>OUTPUT:</span><span id="7a66" class="kx jq hp kt b fi lj kz l la lb">[ 0.04521741  0.02455266 -0.06374787 -0.07107575  0.04608054]</span></pre><p id="e2b0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将打印单词“samsung”的嵌入内容。</p><h1 id="6dd4" class="jp jq hp bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结束注释</h1><p id="3428" class="pw-post-body-paragraph im in hp io b ip kn ir is it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj hb bi translated">我们已经学习了如何为文本数据生成向量，这对创建许多机器学习模型和技术非常有用，如SVM、KNN、K-Means、逻辑分类器、情感分析、文档分类等。</p><p id="b847" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">可以在斯坦福大学的<a class="ae jo" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">网站</a>上了解更多关于这款手套的信息。</p><p id="8dd8" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">关注我的频道，了解Python和技术世界的最新动态</p><figure class="jk jl jm jn fd hk"><div class="bz dy l di"><div class="ly lz l"/></div></figure></div></div>    
</body>
</html>