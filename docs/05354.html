<html>
<head>
<title>Detailed Explanation and math behind the building of Decision trees(learners at Medium level)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">决策树构建背后的详细解释和数学(中等水平的学习者)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/detailed-explanation-and-math-behind-the-building-of-decision-trees-learners-at-medium-level-2f6779a6fd3a?source=collection_archive---------26-----------------------#2020-04-18">https://medium.com/analytics-vidhya/detailed-explanation-and-math-behind-the-building-of-decision-trees-learners-at-medium-level-2f6779a6fd3a?source=collection_archive---------26-----------------------#2020-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6425" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在进入决策树之前，您应该熟悉两件事:</p><ol class=""><li id="a958" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">什么是分类？</li><li id="c935" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">什么是回归？</li></ol><p id="ebc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了熟悉这两件事，只需浏览一下<a class="ae jr" rel="noopener" href="/@iamvishnu.varapally/a-brief-introduction-to-machine-learning-learners-at-medium-level-4a3d91200b60">我以前的帖子</a>。</p><p id="2603" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么是决策树？</p><p id="dac2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">决策树是一种受监督的机器学习算法，遵循树状结构，可用于分类和回归问题…</p><p id="7055" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我希望你知道决策树属于哪一类，它是什么…</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/4430c1cb02532f989096fc2c0cc2ce1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*UtNgeZ3E7YLln25VS5mwxg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">决策树的结构</figcaption></figure><p id="82b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上图所示，最顶层的节点是根节点。决策节点也称为内部节点或简称为“节点”。终端节点也称为叶节点。</p><p id="af53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何决策树都将基于ID3算法构建。根据这个算法，任何决策树的建立都是基于熵的减少和信息增益的增加(我会解释它是什么)。</p><p id="ddc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是在这里，我不是从信息增益的角度(用人工智能的公式)来解释，也不是从CHAID树的角度来解释(关于CHAID树的更多细节，可以通过<a class="ae jr" href="https://sefiks.com/2020/03/18/a-step-by-step-chaid-decision-tree-example/" rel="noopener ugc nofollow" target="_blank">这个东西</a>)。</p><p id="2c2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:——从这里开始，实际的事情就要开始了。把一张纸放在一边，按照我解释的每一步，把它写在纸上。如果不是，那么你从这篇文章中得不到任何用处。彻底遵循每一个步骤，不要错过任何东西。我再说一次，如果你只是在纸上算出来，你会得到这个决策树。在这篇文章中，我只做了少量的数学计算，我把大量的数学实现留给你在纸上完成。当你解数学题时要集中注意力。</p><p id="2566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们开始实施:</p><p id="14da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我将用一个例子来解释它，让我们考虑有4个分类特征(我解释这个只是为了让你理解这个概念，这就是为什么我只考虑容易理解的分类特征。然而，在现实世界中，您不会遇到只有分类要素的数据集。因此，我将在以后的文章中解释如何处理混合了分类和数字特征的数据集，它可以预测一个人是否能获得银行贷款。</p><p id="89b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看一些特征，比如受教育程度、性别、已婚、个体经营…</p><p id="a547" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以为了理解，只要记住这些事情:</p><p id="ad1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">信息增益:- </strong>信息增益对于一个特性来说应该是很高的，以便在构建决策树时保持它在节点的顶部。</p><p id="71a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以为了实现，让我们考虑一下-</p><ol class=""><li id="9f33" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">受过教育(班级是，否)</li><li id="10eb" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">已婚(班级分为是、否)</li><li id="f244" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">自由职业者(课程分为是、否)</li><li id="44b0" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">性别(班级为男性、女性)</li><li id="bbac" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">将获得贷款与否(类是，否)(<strong class="ih hj">我们的输出</strong>)</li></ol><p id="dc71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在从训练数据中，对特征的每个特征类(是(或)否，男性(或)女性)进行划分，多少人将获得贷款，多少人没有获得贷款。</p><p id="cc63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">举例</strong> :-</p><p id="e489" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想想看，受过教育有六个是和六个不是。对于受过教育的人来说，有6个“是”,考虑一下获得贷款的人有4个“是”和2个“否”。对于受过教育的人来说，有6个“否”,考虑一下获得贷款的人有3个“是”和3个“否”。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ke"><img src="../Images/c8d8f623e0d5360681461b6a33941a37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*aORAZ_1jFjJdGHn5DcfuNw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">像这样</figcaption></figure><p id="ddf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像这样，划分每一个特征(受教育、已婚、自营职业、性别),也划分与所选特征(受教育、已婚、自营职业、性别)相关的产出(是否获得贷款)。</p><p id="82f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们这样做时，我们将得到4个东西(受教育的输出、结婚的输出、自雇的输出、性别的输出)，即每个特征的分离，以及关于特征的输出。</p><p id="f11e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们需要判断在上述4件事情中，哪个特征将是最佳特征，对于该最佳特征，信息增益将非常高(熵将非常低)。</p><p id="6ac3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里要测量的是<strong class="ih hj">杂质</strong>。</p><p id="7865" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，为了判断这些事情，我们有3个衡量标准:</p><ol class=""><li id="f2c8" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">基尼系数。</li><li id="a704" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">熵。</li><li id="65e8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">卡方检验。(它用于CHAID决策树)</li></ol><p id="27a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将使用一种流行的衡量标准来衡量，即<strong class="ih hj">基尼</strong></p><p id="5b10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将下面的公式应用于两片树叶的<strong class="ih hj">受教育输出</strong>图..</p><p id="ea26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基尼杂质公式为= 1 -(是'的概率)(否'的概率)。</p><p id="46ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，你知道<strong class="ih hj">是</strong>和<strong class="ih hj">否</strong>属于贷款与否。</p><p id="cbdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，如果我们计算:</p><p id="693c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于左边的叶子，</p><p id="0739" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基尼= 1(4/(4+2))——(2/(4+2))</p><p id="0981" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也为右叶计算..</p><p id="fa93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，计算两片叶子杂质的加权平均值</p><p id="2bd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">W.A = (yes的/ (yes的+ no的))*(左叶的杂质)+ (no的/ (yes的+ no的))*(右叶的杂质)</p><p id="e92f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以你会得到教育产出的W.A值。</p><p id="2f59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对其余的线对也执行相同的步骤(先执行)。</p><p id="7045" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于哪一对杂质将是低的(信息增益是高的)，这是构建决策树的根节点。</p><p id="9f3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们想象一下，你受过教育，但产出比其他人低。</p><p id="14f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，构建决策树的根节点已经完成</p><p id="8e9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你知道受过教育一栏有6个是和6个不是</p><p id="d4e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着在构建决策树时，左叶(是)有6个，右叶(否)有6个。</p><p id="c6e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从进行配对(受教育输出、结婚输出、自雇输出、性别输出)到此，对根节点(受教育)的左右叶的剩余配对进行相同的上述程序，直到与分割后的杂质相比，杂质较低…</p><p id="4694" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是构建决策树的过程。</p><p id="5df9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">决策树的代码片段:-</p><p id="b02c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如引言中所说，决策树既可以作为分类器，也可以作为回归器。我给出了如何在训练和测试数据上应用决策树的代码片段。</p><p id="92b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对于分类</strong> :- <br/>从sklearn.tree导入决策树分类器<br/>分类器=决策树分类器()<br/>分类器. fit(X_train，Y_train) <br/> y_pred =分类.预测(X_test)</p><p id="d727" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">For Regression</strong>:-<br/>from sk learn . tree import DecisionTreeRegressor<br/>regressor = DecisionTreeRegressor()<br/>regressor . fit(X _ train，y _ train)<br/>y _ pred = class ification . predict(X _ test)</p><p id="8842" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你理解了构建决策树的核心概念。</p><p id="8139" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将在以后的文章中解释混合了<strong class="ih hj">分类</strong>和<strong class="ih hj">数字</strong>特征的决策树的应用。</p><p id="33eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">__________________________________________________________________</p><p id="035f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐阅读！✌✌</p></div></div>    
</body>
</html>