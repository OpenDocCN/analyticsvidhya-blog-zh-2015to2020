<html>
<head>
<title>Want to Save and Reuse a model later?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">想要保存并在以后重用模型吗？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/want-to-save-and-reuse-a-model-later-d48398584695?source=collection_archive---------11-----------------------#2020-06-27">https://medium.com/analytics-vidhya/want-to-save-and-reuse-a-model-later-d48398584695?source=collection_archive---------11-----------------------#2020-06-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/7235b4568c9a41e8f6c4956beea0236a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*je7sGxsu4j2JLOeWvYf9MA.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">Olia Gozha在Unsplash上拍摄的照片</figcaption></figure><div class=""/><p id="1647" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在机器学习中，训练一个模型，测试它，绝对不是目的。我们应该运行这个训练的源代码，再次调整一切来做未来的预测吗？不需要！！！</p><p id="badb" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有一些很酷的方法可以保存模型，并在以后加载它以供使用。</p><p id="119a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有一些包可以将你的机器学习模型保存到文件系统中，并在你想要重用它的时候加载它！。</p><blockquote class="js jt ju"><p id="40cc" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr hb bi translated">使用Pickle包</p><p id="9087" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr hb bi translated">从sklearn.externals使用joblib</p></blockquote><h1 id="309e" class="jz ka hx bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">操作步骤:</strong></h1><ol class=""><li id="d2dd" class="kx ky hx iw b ix kz jb la jf lb jj lc jn ld jr le lf lg lh bi translated">将模型保存为文件</li><li id="53cc" class="kx ky hx iw b ix li jb lj jf lk jj ll jn lm jr le lf lg lh bi translated">从保存的文件中加载模型</li><li id="c325" class="kx ky hx iw b ix li jb lj jf lk jj ll jn lm jr le lf lg lh bi translated">使用加载的模型进行预测</li></ol><h1 id="78cc" class="jz ka hx bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">使用Pickle将其保存为文件:</strong></h1><p id="3ede" class="pw-post-body-paragraph iu iv hx iw b ix kz iz ja jb la jd je jf ln jh ji jj lo jl jm jn lp jp jq jr hb bi translated">导入所需的包</p><pre class="lq lr ls lt fd lu lv lw lx aw ly bi"><span id="2020" class="lz ka hx lv b fi ma mb l mc md"><strong class="lv hy">import</strong> <strong class="lv hy">pickle</strong> <strong class="lv hy">as</strong> <strong class="lv hy">pkl</strong></span></pre><p id="09fd" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你可以在注释中找到解释</p><pre class="lq lr ls lt fd lu lv lw lx aw ly bi"><span id="8abc" class="lz ka hx lv b fi ma mb l mc md">filenm = 'LR_AdmissionPrediction.pickle'<br/><strong class="lv hy"><em class="jv">#Step 1: Create or open a file with write-binary mode and save the model to it</em></strong><br/>pickle = pkl.dump(lr, open(filenm, 'wb'))</span><span id="fa53" class="lz ka hx lv b fi me mb l mc md"><strong class="lv hy"><em class="jv">#Step 2: Open the saved file with read-binary mode</em></strong><br/>lr_pickle = pkl.load(open(filenm, 'rb'))</span><span id="c3f3" class="lz ka hx lv b fi me mb l mc md"><strong class="lv hy"><em class="jv">#Step 3: Use the loaded model to make predictions </em></strong><br/>lr_pickle.predict([[300,85,5,5,5,8,1]])</span></pre><p id="472f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出:</p><pre class="lq lr ls lt fd lu lv lw lx aw ly bi"><span id="0cc1" class="lz ka hx lv b fi ma mb l mc md">array([0.61745881])</span></pre><p id="a28f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上面的代码中，我们创建/打开了一个名为“LR_AdmissionPrediction.pickle”的文件。</p><p id="101d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您可以在您的文件系统中找到这个文件。这将是一个非常小的文件。</p><p id="b754" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">大小:此文件保存模型，而不是用于训练或测试模型的数据。因此，该文件的大小并不反映用于训练/测试模型的数据的大小。</p><p id="0a30" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">wb，rb:我们用写二进制打开文件来创建pickle文件，然后用读二进制加载它。</p><p id="1407" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里，我们已经序列化了我们的模型，并将其保存在文件系统中。</p><p id="8457" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">要知道lr从何而来，请查看<a class="ae mf" rel="noopener" href="/analytics-vidhya/linear-regression-part-iv-chance-of-admission-prediction-978540555c29">线性回归——第四部分——录取几率预测</a>。</p><p id="20a6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这不是唯一的方法。还有一种方法可以让你把它保存在一个字符串中，并把它加载到同一个项目中字符串范围可用的任何地方。下面是源代码。</p><pre class="lq lr ls lt fd lu lv lw lx aw ly bi"><span id="a0bb" class="lz ka hx lv b fi ma mb l mc md"><strong class="lv hy"><em class="jv">#Step 1: Save the model as a pickle string.</em></strong><em class="jv"> </em><br/>saved_model = pkl.dumps(lr) <br/>  <br/><strong class="lv hy"><em class="jv">#Step 2: Load the saved model </em></strong><br/>lr_from_pickle = pkl.loads(saved_model) <br/>  <br/><strong class="lv hy"><em class="jv">#Step 3: Use the loaded model to make predictions </em></strong><br/>lr_from_pickle.predict([[300,85,5,5,5,8,1]])</span></pre><p id="bbf7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出:</p><pre class="lq lr ls lt fd lu lv lw lx aw ly bi"><span id="0030" class="lz ka hx lv b fi ma mb l mc md">array([0.61745881])</span></pre><h1 id="90fb" class="jz ka hx bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">使用joblib将其保存为文件:</h1><pre class="lq lr ls lt fd lu lv lw lx aw ly bi"><span id="abc3" class="lz ka hx lv b fi ma mb l mc md"><strong class="lv hy">from</strong> <strong class="lv hy">sklearn.externals</strong> <strong class="lv hy">import</strong> <strong class="lv hy">joblib </strong><br/>  <br/><em class="jv">#</em><strong class="lv hy"><em class="jv">Step 1: </em></strong><em class="jv">Save the model as a pickle in a file </em><br/>joblib.dump(lr, 'filename.pkl') <br/>  <br/><em class="jv">#</em><strong class="lv hy"><em class="jv">Step 2: </em></strong><em class="jv">Load the model from the file </em><br/>lr_from_joblib = joblib.load('filename.pkl')  <br/>  <br/><em class="jv">#</em><strong class="lv hy"><em class="jv">Step 3:</em></strong><em class="jv"> Use the loaded model to make predictions </em><br/>lr_from_joblib.predict([[300,85,5,5,5,8,1]])</span></pre><p id="5cd4" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出:</p><pre class="lq lr ls lt fd lu lv lw lx aw ly bi"><span id="2136" class="lz ka hx lv b fi ma mb l mc md">array([0.61745881])</span></pre><h1 id="51fc" class="jz ka hx bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">结论:</strong></h1><p id="21ee" class="pw-post-body-paragraph iu iv hx iw b ix kz iz ja jb la jd je jf ln jh ji jj lo jl jm jn lp jp jq jr hb bi translated">在以上三种方法中，对于相同的输入，预测值是相同的。这意味着您可以使用任何方法来重用模型。</p><p id="d4f0" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你发现任何其他类似的很酷的东西，或者如果你发现任何更正，我真的很感激，请在评论中添加它。</p><p id="0758" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">谢谢大家！</p><p id="6508" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">喜欢支持？只要点击拍手图标就可以了。</p><p id="f03f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">编程快乐！</p></div></div>    
</body>
</html>