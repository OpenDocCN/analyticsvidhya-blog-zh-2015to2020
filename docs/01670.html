<html>
<head>
<title>Simple Steps to Improve Machine Learning Model’s Performance Progressively</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逐步提高机器学习模型性能的简单步骤</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-steps-to-improve-machine-learning-models-performance-progressively-822445304a99?source=collection_archive---------10-----------------------#2019-11-07">https://medium.com/analytics-vidhya/simple-steps-to-improve-machine-learning-models-performance-progressively-822445304a99?source=collection_archive---------10-----------------------#2019-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4332ecc1fd834ae18c85bc214b7707a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fyZN_f8yqxUw-T3A"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Jukan Tateisi 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="ba3b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，你已经建立了你的第一个学习模型，比方说在给定的数据集上把一幅图像分类为狗或猫。但是它的性能远不能让你满意。您的下一个常见步骤将是操作扩充数据集或立即切换到其他分类模型，而无需花费进一步的努力来深入诊断当前模型的能力。</p><p id="9d88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，另一种可能是，你错过了对现有模型进行微调以最佳适应数据集的巨大机会。我们应该避免在没有完全探索现有模型的学习能力的情况下就匆忙决定在模型之间进行切换。</p><p id="778a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我想提出一个直观而有效的关于延期交货的案例研究来说明上面强调的观点。</p><h2 id="a6f0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">什么是延期交货？</h2><p id="68e9" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated"><em class="kt">延期交货</em>是暂时缺货的产品，但是客户可以根据未来的库存下订单。延期交货通常表示客户对产品或服务的需求超过了公司的供应能力。延期交货有好有坏。强劲的需求可以推迟订单，但次优的计划也可以。</p><p id="5793" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">典型的延期交货受多种因素影响，典型的数据属性如下所示:</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="c15f" class="jt ju hi kz b fi ld le l lf lg">sku - Random ID for the product<br/><br/>national_inv - Current inventory level for the part<br/><br/>lead_time - Transit time for product (if available)<br/><br/>in_transit_qty - Amount of product in transit from source<br/><br/>forecast_3_month - Forecast sales for the next 3 months<br/><br/>forecast_6_month - Forecast sales for the next 6 months<br/><br/>forecast_9_month - Forecast sales for the next 9 months<br/><br/>sales_1_month - Sales quantity for the prior 1 month time period<br/><br/>sales_3_month - Sales quantity for the prior 3 month time period<br/><br/>sales_6_month - Sales quantity for the prior 6 month time period<br/><br/>sales_9_month - Sales quantity for the prior 9 month time period<br/><br/>min_bank - Minimum recommend amount to stock<br/><br/>potential_issue - Source issue for part identified<br/><br/>pieces_past_due - Parts overdue from source<br/><br/>perf_6_month_avg - Source performance for prior 6 month period<br/><br/>perf_12_month_avg - Source performance for prior 12 month period<br/><br/>local_bo_qty - Amount of stock orders overdue<br/><br/>deck_risk - Part risk flag<br/><br/>oe_constraint - Part risk flag<br/><br/>ppap_risk - Part risk flag<br/><br/>stop_auto_buy - Part risk flag<br/><br/>rev_stop - Part risk flag<br/><br/>went_on_backorder - Product actually went on backorder. This is the target value.<br/><br/>     Yes or 1 : Product backordered<br/><br/>     No or 0  : Product not backordered</span></pre><p id="0c6d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们将实现众所周知的常规步骤，在建模之前探索、清理和分割数据。</p><ol class=""><li id="2308" class="lh li hi ix b iy iz jc jd jg lj jk lk jo ll js lm ln lo lp bi translated">加载所需的库和数据。</li></ol><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/b8e3fa3face9fe6c01a27ed287d4969b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0C803lCs66uFQSi7VYcqiA.png"/></div></div></figure><p id="e9b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.为模型性能评估确定正确的误差度量。我们选择了召回率作为我们的性能评价指标。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/f44fd316b09fcc559d76c348f6a78870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LaBxBBtI-fGE2w98nfnDBw.png"/></div></div></figure><p id="9fdd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.通过可视化进行探索性数据分析，以便更好地理解数据。</p><p id="5f06" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.将所有属性转换为适当的数据类型。</p><p id="b922" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">5.处理缺失数据。</p><p id="d671" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">6.将数据分为训练集和测试集。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/2a95e91ff7ad7a769c72532e1ecc4f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7EIC3M4DmpkQFmwYusQuQ.png"/></div></div></figure><p id="615e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">7.使用<em class="kt"> LabelEncoder </em>将分类目标属性转换为数字。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/fc27f07c214200ae6193e037291cef37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AqhZNDVx0UXPdupGcJGK-g.png"/></div></div></figure><p id="b989" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">8.使用<em class="kt"> StandardScaler </em>到<em class="kt">T11】标准化数值属性。</em></p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/61eeeda053b6a736ae886c8e85adc9a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZUYhMGAaSSJW15ZEptteXw.png"/></div></div></figure><p id="3c04" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">9.使用<em class="kt"> OneHotEncoder </em>到<em class="kt"> </em>将分类属性转换为数字属性。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/6f25aa3162f70cc7867c103c5fb81f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiJh32OPryd7yJMGW2n8qQ.png"/></div></div></figure><h2 id="bf60" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">模型构建策略</h2><p id="5b3d" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">因为我们要满足一个分类任务，所以使用逻辑回归作为我们增强的基础模型是我们的第一特权。然后，我们将根据观察结果采取渐进的决定性行动。</p><p id="803e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">步骤1:(简单逻辑回归)</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/123ee06797e1a09c253ba89f1b4b8961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OTN4VlpQvJjh1N0obBplng.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">逻辑回归模型性能</figcaption></figure><p id="9f26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以看出，回忆是非常低和差的。这主要是由于分类不平衡的典型情况，即81%的记录不是延期交货记录。</p><p id="9a36" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">步骤2:(类权重平衡的逻辑回归)</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/7c0e2f32113bac57a8376ebb036e1fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHYDFjka3RWt-IUF0Hbpyg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">逻辑回归中的类权重平衡</figcaption></figure><p id="1057" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">重量平衡后，召回率有所提高，但它极大地影响了模型的准确性。准确性和召回率并不是完全独立的，我们需要进行一定的权衡来有效地管理它们。</p><p id="6bee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">步骤3:(带上采样的逻辑回归)</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/f909edad9c9995360d9a92a4009596ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rHveYRw6IsUQqyc8qsKVow.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">逻辑回归中的上采样</figcaption></figure><p id="1369" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个阶段，回忆在准确性没有变化的情况下有所提高。对于给定的数据集，我们已经达到了逻辑回归的极限。此外，我们需要切换到其他分类模型以获得更好的性能。</p><p id="eab2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第四步:(决策树)</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/c8b92300bd48a4423567458505fa1c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ZmRv_7X4IwqnyCiUbIKBA.png"/></div></div></figure><p id="34f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这似乎是一个可以接受的结果，或者它可以作为GridSearchCV与决策树相结合的一个经验步骤进行进一步的尝试。</p><h2 id="d958" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">结论</h2><p id="8513" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">上述案例研究强调了采取简单而有效的步骤以渐进方式提高机器学习模型性能的重要性。</p><p id="7a6b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我真诚地希望所有狂热的数据科学和机器学习爱好者会发现它非常有趣，并有动力亲自尝试一下。案例研究中使用的数据集可以从这里的<a class="ae iu" href="https://drive.google.com/open?id=1BrCi7U-GZ5COV_uNI_-civCsgLQJzIel" rel="noopener ugc nofollow" target="_blank">获得</a>。</p></div></div>    
</body>
</html>