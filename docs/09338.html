<html>
<head>
<title>How to make a Smile Detection Flutter app using ML Kit.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用ML Kit做一个微笑检测颤振app？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-make-a-flutter-app-using-ml-kit-which-detects-smile-5259033a97b3?source=collection_archive---------7-----------------------#2020-09-02">https://medium.com/analytics-vidhya/how-to-make-a-flutter-app-using-ml-kit-which-detects-smile-5259033a97b3?source=collection_archive---------7-----------------------#2020-09-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="75fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当今世界正在关注机器学习，许多东西都在使用机器学习进行开发，从自动驾驶汽车到全脸识别软件。因此，跟上技术的发展趋势很重要，这样我们才不会落后。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="7b61" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇文章中，我将告诉你如何使用Firebase ML工具包来制作一个Android Flutter应用程序，它可以检测微笑。</p><p id="5840" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先你需要建立一个Firebase账户。所以去Firebase控制台开始吧！</p><div class="jk jl ez fb jm jn"><a href="https://firebase.google.com/" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">重火力点</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">Firebase为您提供了分析、数据库、消息传递和崩溃报告等功能，因此您可以快速移动并…</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">firebase.google.com</p></div></div><div class="jw l"><div class="jx l jy jz ka jw kb kc jn"/></div></div></a></div><p id="20d2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，添加一个新项目，给它起任何名字</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kd"><img src="../Images/7f9c1ee9ed268b15518b3101fc2c22e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7Uf21cH7XHGTBhqk_ObWg.png"/></div></div></figure><p id="1eb7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，选择firebase的默认帐户，如下所示，并单击“创建项目”:</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ko"><img src="../Images/8fbdfc4611212a448d353824f7f4774c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPwjYrv-aXHhe5RgMEmARA.png"/></div></div></figure><p id="2f81" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一切准备就绪后，点击继续。很容易不是吗？</p><p id="4b9d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">到达firebase控制台后，点击android图标，开始在Android应用程序中设置Firebase</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kp"><img src="../Images/885a44b1bf2cbfaaccc18ee03bc3908c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwj773W9bqGDeC-nHDGEyg.png"/></div></div></figure><p id="a85a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来屏幕上会要求你输入包名，如果你不知道可以在Android/app/src/main/Android manifest . XML中找到包名。点击注册应用程序</p><p id="62c3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后下载json文件，粘贴到Android app级根目录。</p><p id="64d5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后确保在您的项目级build.gradle文件中有以下内容</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="d282" class="kv kw hi kr b fi kx ky l kz la"><strong class="kr hj">Project-level build.gradle (</strong><strong class="kr hj">&lt;project&gt;/build.gradle</strong><strong class="kr hj">)</strong></span><span id="7747" class="kv kw hi kr b fi lb ky l kz la">buildscript {<br/>  repositories {<br/>    // Check that you have the following line (if not, add it):<br/>    google()  // Google's Maven repository<br/>  }<br/>  dependencies {<br/>    ...<br/>    // Add this line<br/>    classpath 'com.google.gms:google-services:4.3.3'<br/>  }<br/>}<br/><br/>allprojects {<br/>  ...<br/>  repositories {<br/>    // Check that you have the following line (if not, add it):<br/>    google()  // Google's Maven repository<br/>    ...<br/>  }<br/>}</span></pre><p id="959e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">和应用级构建。gradle:-</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="9da0" class="kv kw hi kr b fi kx ky l kz la"><strong class="kr hj">App-level build.gradle (</strong><strong class="kr hj">&lt;project&gt;/&lt;app-module&gt;/build.gradle</strong><strong class="kr hj">):</strong></span><span id="7f59" class="kv kw hi kr b fi lb ky l kz la">apply plugin: 'com.android.application'<br/>// Add this line<br/>apply plugin: 'com.google.gms.google-services'<br/><br/>dependencies {<br/>  // add the Firebase SDK for Google Analytics<br/>  implementation 'com.google.firebase:firebase-analytics:17.5.0'<br/>  // add SDKs for any other desired Firebase products<br/>  // https://firebase.google.com/docs/android/setup#available-libraries<br/>}</span></pre><p id="20d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在点击下一步，恭喜你已经为你的应用程序设置了firebase！</p><p id="c11e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">安装包:- </strong></p><p id="6bc7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在下一步中，您需要两个依赖项来使用ML工具包，第一个是<code class="du lc ld le kr b">Image Picker</code>，另一个是<code class="du lc ld le kr b">Firebase ML Vision</code>。</p><div class="jk jl ez fb jm jn"><a href="https://pub.dev/packages/image_picker" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">图像拾取器| Flutter包</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">一个适用于iOS和Android的Flutter插件，用于从图像库中拾取图像，并使用…</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">公共开发</p></div></div><div class="jw l"><div class="lf l jy jz ka jw kb kc jn"/></div></div></a></div><div class="jk jl ez fb jm jn"><a href="https://pub.dev/packages/firebase_ml_vision" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">firebase_ml_vision | Flutter包</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">一个使用Firebase ML功能的Flutter插件，包括Firebase所有基于云的ML特性，以及…</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">公共开发</p></div></div><div class="jw l"><div class="lg l jy jz ka jw kb kc jn"/></div></div></a></div><p id="0ae2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在pubspec.yaml文件中包含依赖项，并运行get packages命令。</p><p id="8936" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来打开你的应用程序级gradle文件，包括以下内容:</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="977b" class="kv kw hi kr b fi kx ky l kz la">apply plugin: 'com.google.gms.google-services'</span><span id="b10e" class="kv kw hi kr b fi lb ky l kz la">android{<br/>/.../<br/>    dependencies {</span><span id="593e" class="kv kw hi kr b fi lb ky l kz la">           api 'com.google.firebase:firebase-ml-vision-image-label-model:19.0.2'</span><span id="18d7" class="kv kw hi kr b fi lb ky l kz la">           api 'com.google.firebase:firebase-ml-vision-face-model:17.0.2'</span><span id="2340" class="kv kw hi kr b fi lb ky l kz la">     }<br/>/.../</span><span id="ed0a" class="kv kw hi kr b fi lb ky l kz la">}</span></pre><p id="8e08" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在打开您的项目级build.gradle文件，并包含以下内容:</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="9e78" class="kv kw hi kr b fi kx ky l kz la">buildscript {</span><span id="35e0" class="kv kw hi kr b fi lb ky l kz la">/.../</span><span id="9132" class="kv kw hi kr b fi lb ky l kz la">       dependencies {<br/>             /.../</span><span id="835e" class="kv kw hi kr b fi lb ky l kz la">             classpath 'com.google.gms:google-services:4.3.3'</span><span id="3c36" class="kv kw hi kr b fi lb ky l kz la">             /.../</span><span id="58d3" class="kv kw hi kr b fi lb ky l kz la">      }</span><span id="a228" class="kv kw hi kr b fi lb ky l kz la">}</span></pre><p id="09ba" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将以下内容添加到您的Android清单文件中。这是为了让ML模型自动从play store安装到您的设备上。</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="d115" class="kv kw hi kr b fi kx ky l kz la">&lt;application ...&gt;<br/>  ...<br/>  &lt;meta-data<br/>    android:name="com.google.firebase.ml.vision.DEPENDENCIES"<br/>    android:value="face" /&gt;<br/>  <em class="lh">&lt;!-- To use multiple models: android:value="ocr,label,barcode,face" --&gt;</em><br/>&lt;/application&gt;</span></pre><p id="141c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">好了，现在设置完成了。让我们开始编码部分！</p><p id="c8da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要获取图像，您可以指定从相机或画廊。我会在镜头前做。为此，您需要一个图像拾取器对象:</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="6a92" class="kv kw hi kr b fi kx ky l kz la">var image = await <em class="lh">ImagePicker</em>.pickImage(source: <em class="lh">ImageSource</em>.camera);</span></pre><p id="b170" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从你的图像中创建一个<code class="du lc ld le kr b">FirebaseVisionImage</code>物体。</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="461f" class="kv kw hi kr b fi kx ky l kz la">var visionImage = <em class="lh">FirebaseVisionImage</em>.fromFile(image);</span></pre><p id="6e69" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在创建一个检测器的实例，并在其中指定FaceDetector选项以获得enableClassification。利用这一点，我们将有可能检测到图像中的微笑。</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="874a" class="kv kw hi kr b fi kx ky l kz la">var faceDetection =</span><span id="3c5a" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">FirebaseVision</em>.instance.faceDetector(<em class="lh">FaceDetectorOptions</em>(</span><span id="7256" class="kv kw hi kr b fi lb ky l kz la">enableClassification: true,</span><span id="4b0a" class="kv kw hi kr b fi lb ky l kz la">enableLandmarks: true,</span><span id="892d" class="kv kw hi kr b fi lb ky l kz la">));</span></pre><p id="0795" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在你需要用FaceDetector的processImage方法处理图像。</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="8cef" class="kv kw hi kr b fi kx ky l kz la"><em class="lh">List</em>&lt;<em class="lh">Face</em>&gt; faces = await faceDetection.processImage(visionImage);</span></pre><p id="db20" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们循环faces列表，将边界框添加到Rect类型的列表中</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="9610" class="kv kw hi kr b fi kx ky l kz la">for (<em class="lh">Face</em> f in faces) {</span><span id="3cf9" class="kv kw hi kr b fi lb ky l kz la">rect.add(f.boundingBox);</span><span id="948f" class="kv kw hi kr b fi lb ky l kz la">smileProb = f.smilingProbability; // this will give the smiling probability of the image.</span><span id="4540" class="kv kw hi kr b fi lb ky l kz la">}</span></pre><p id="a683" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们将使用这个<code class="du lc ld le kr b">smilingProbability</code>值来设置不同类型的微笑特征。</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="f09a" class="kv kw hi kr b fi kx ky l kz la"><em class="lh">String</em> detectSmile() {</span><span id="e42f" class="kv kw hi kr b fi lb ky l kz la">if (smileProb &gt; 0.86) {</span><span id="f801" class="kv kw hi kr b fi lb ky l kz la">return 'Big smile with teeth';</span><span id="65b1" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="d0e2" class="kv kw hi kr b fi lb ky l kz la">else if (smileProb &gt; 0.8) {</span><span id="78cb" class="kv kw hi kr b fi lb ky l kz la">return 'Big Smile';</span><span id="1dee" class="kv kw hi kr b fi lb ky l kz la">} else if (smileProb &gt; 0.3) {</span><span id="f386" class="kv kw hi kr b fi lb ky l kz la">return 'Smile';</span><span id="dfdf" class="kv kw hi kr b fi lb ky l kz la">} else</span><span id="032d" class="kv kw hi kr b fi lb ky l kz la">return 'Sad';</span><span id="b3d4" class="kv kw hi kr b fi lb ky l kz la">}</span></pre><p id="ba03" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以在做了所有这些之后，我们的代码应该是这样的:</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="8032" class="kv kw hi kr b fi kx ky l kz la">class <em class="lh">_FaceDetectionState</em> extends <em class="lh">State</em>&lt;<em class="lh">FaceDetection</em>&gt; {</span><span id="6a40" class="kv kw hi kr b fi lb ky l kz la">ui.<em class="lh">Image</em> image;</span><span id="e359" class="kv kw hi kr b fi lb ky l kz la">var smileProb;</span><span id="a98a" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">List</em>&lt;<em class="lh">Rect</em>&gt; rect = <em class="lh">List</em>&lt;<em class="lh">Rect</em>&gt;();</span><span id="8ff6" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">Future</em> getImage() async {</span><span id="a2c6" class="kv kw hi kr b fi lb ky l kz la">var image = await <em class="lh">ImagePicker</em>.pickImage(source: <em class="lh">ImageSource</em>.camera);</span><span id="1f6c" class="kv kw hi kr b fi lb ky l kz la">var visionImage = <em class="lh">FirebaseVisionImage</em>.fromFile(image);</span><span id="a915" class="kv kw hi kr b fi lb ky l kz la">setState(() {</span><span id="884b" class="kv kw hi kr b fi lb ky l kz la">rect = <em class="lh">List</em>&lt;<em class="lh">Rect</em>&gt;();</span><span id="44ca" class="kv kw hi kr b fi lb ky l kz la">});<br/></span><span id="5fb2" class="kv kw hi kr b fi lb ky l kz la">var faceDetection =</span><span id="847f" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">FirebaseVision</em>.instance.faceDetector(<em class="lh">FaceDetectorOptions</em>(</span><span id="56c9" class="kv kw hi kr b fi lb ky l kz la">enableClassification: true,</span><span id="ef6e" class="kv kw hi kr b fi lb ky l kz la">enableLandmarks: true,</span><span id="c1b6" class="kv kw hi kr b fi lb ky l kz la">));</span><span id="b2b2" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">List</em>&lt;<em class="lh">Face</em>&gt; faces = await faceDetection.processImage(visionImage);</span><span id="c142" class="kv kw hi kr b fi lb ky l kz la">for (<em class="lh">Face</em> f in faces) {</span><span id="0d41" class="kv kw hi kr b fi lb ky l kz la">rect.add(f.boundingBox);</span><span id="ace8" class="kv kw hi kr b fi lb ky l kz la">smileProb = f.smilingProbability;</span><span id="fa42" class="kv kw hi kr b fi lb ky l kz la">print('============================================');</span><span id="edc0" class="kv kw hi kr b fi lb ky l kz la">print(smileProb);</span><span id="4de6" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="13b4" class="kv kw hi kr b fi lb ky l kz la">loadImage(image).then((img) {</span><span id="ae8f" class="kv kw hi kr b fi lb ky l kz la">setState(() {</span><span id="1e93" class="kv kw hi kr b fi lb ky l kz la">this.image = img;</span><span id="06e6" class="kv kw hi kr b fi lb ky l kz la">});</span><span id="3ce3" class="kv kw hi kr b fi lb ky l kz la">});</span><span id="91ff" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="8d82" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">Future</em>&lt;ui.<em class="lh">Image</em>&gt; loadImage(<em class="lh">File</em> image) async {</span><span id="45be" class="kv kw hi kr b fi lb ky l kz la">var img = await image.readAsBytes();</span><span id="0605" class="kv kw hi kr b fi lb ky l kz la">return decodeImageFromList(img);</span><span id="6709" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="1862" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">String</em> detectSmile() {</span><span id="7ff6" class="kv kw hi kr b fi lb ky l kz la">if (smileProb &gt; 0.86) {</span><span id="a9d6" class="kv kw hi kr b fi lb ky l kz la">return 'Big smile with teeth';</span><span id="7279" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="832d" class="kv kw hi kr b fi lb ky l kz la">else if (smileProb &gt; 0.8) {</span><span id="a4fd" class="kv kw hi kr b fi lb ky l kz la">return 'Big Smile';</span><span id="0d47" class="kv kw hi kr b fi lb ky l kz la">} else if (smileProb &gt; 0.3) {</span><span id="92e6" class="kv kw hi kr b fi lb ky l kz la">return 'Smile';</span><span id="a7ac" class="kv kw hi kr b fi lb ky l kz la">} else</span><span id="7918" class="kv kw hi kr b fi lb ky l kz la">return 'Sad';</span><span id="53b0" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="3a1f" class="kv kw hi kr b fi lb ky l kz la">/.../<br/>Widget build<br/>/.../</span><span id="d2aa" class="kv kw hi kr b fi lb ky l kz la">}</span></pre><p id="a89b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在主要部分已经完成，剩下的就是在检测到的人脸上绘制矩形。我们将使用CustomPainter在图像上使用canvas.drawImage绘制矩形</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="f836" class="kv kw hi kr b fi kx ky l kz la">class <em class="lh">Painter</em> extends <em class="lh">CustomPainter</em> {</span><span id="a92a" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">    List</em>&lt;<em class="lh">Rect</em>&gt; rect;</span><span id="a9c4" class="kv kw hi kr b fi lb ky l kz la">    ui.<em class="lh">Image</em> image;</span><span id="a644" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">    Painter</em>({@required this.rect, @required this.image});</span><span id="9cf0" class="kv kw hi kr b fi lb ky l kz la">   @override<br/>   void paint(ui.<em class="lh">Canvas</em> canvas, ui.<em class="lh">Size</em> size) {</span><span id="fffc" class="kv kw hi kr b fi lb ky l kz la">   canvas.drawImage(image, <em class="lh">Offset</em>.zero, <em class="lh">Paint</em>());<br/>   <br/>   if (rect != null) {<br/>      for (<em class="lh">Rect</em> rect in this.rect) {</span><span id="39fb" class="kv kw hi kr b fi lb ky l kz la">        canvas.drawRect(<br/>        rect,<br/>        <em class="lh">Paint</em>()<br/>        ..color = <em class="lh">Colors</em>.red<br/>        ..strokeWidth = 5.0<br/>        ..style = <em class="lh">PaintingStyle</em>.stroke);</span><span id="ca63" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="bbd6" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="ebd9" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="247a" class="kv kw hi kr b fi lb ky l kz la">@override</span><span id="8ea5" class="kv kw hi kr b fi lb ky l kz la"><em class="lh">bool</em> shouldRepaint(<em class="lh">CustomPainter</em> oldDelegate) {</span><span id="6ee9" class="kv kw hi kr b fi lb ky l kz la">return true;</span><span id="cf55" class="kv kw hi kr b fi lb ky l kz la">}</span><span id="3872" class="kv kw hi kr b fi lb ky l kz la">}</span></pre><p id="4205" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这样就完成了脸上矩形的绘制。这样我们就可以走了。现在要在屏幕上显示图像，您需要使用CustomPaint小部件</p><pre class="ke kf kg kh fd kq kr ks kt aw ku bi"><span id="c0a6" class="kv kw hi kr b fi kx ky l kz la"><em class="lh">FittedBox</em>(</span><span id="aeea" class="kv kw hi kr b fi lb ky l kz la">child: <em class="lh">SizedBox</em>(</span><span id="41f8" class="kv kw hi kr b fi lb ky l kz la">width: image != null ? image.width.toDouble() : 500.0,</span><span id="2623" class="kv kw hi kr b fi lb ky l kz la">height: image != null ? image.height.toDouble() : 500.0,</span><span id="ccc3" class="kv kw hi kr b fi lb ky l kz la">child: <em class="lh">CustomPaint</em>(</span><span id="7216" class="kv kw hi kr b fi lb ky l kz la">painter: <em class="lh">Painter</em>(rect: rect, image: image),</span><span id="7938" class="kv kw hi kr b fi lb ky l kz la">),</span><span id="3255" class="kv kw hi kr b fi lb ky l kz la">),</span><span id="e6b2" class="kv kw hi kr b fi lb ky l kz la">),</span></pre><p id="6529" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">仅此而已。你准备从头开始做一个人脸检测app。如果您发现任何问题，您可以参考以下链接中的源代码:</p><div class="jk jl ez fb jm jn"><a href="https://github.com/ug2454/FaceDetectionFlutter" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">ug2454/FaceDetectionFlutter</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">一个用Firebase ML工具包制作的人脸检测抖动项目。ML Kit是一个移动SDK，带来了谷歌的机器…</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">github.com</p></div></div><div class="jw l"><div class="li l jy jz ka jw kb kc jn"/></div></div></a></div></div></div>    
</body>
</html>