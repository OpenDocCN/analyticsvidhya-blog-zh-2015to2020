<html>
<head>
<title>Classification of False Positive Security Alerts in SOC environment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SOC环境中误报安全警报的分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/classification-of-false-positive-security-alerts-in-soc-environment-5b6fa97ac2ef?source=collection_archive---------12-----------------------#2019-11-12">https://medium.com/analytics-vidhya/classification-of-false-positive-security-alerts-in-soc-environment-5b6fa97ac2ef?source=collection_archive---------12-----------------------#2019-11-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/53ead1aab17d3c33d1a724bb2ef870d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SKD9vq4V7b45ZZu4Ib6fBw.jpeg"/></div></div></figure><h1 id="3dc4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak"> SOC简介</strong></h1><p id="69c0" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">SOC代表安全运营中心，是网络安全事件监控和事件响应的集中单元。SOC通过采用高级威胁搜寻功能，负责检测、分析和报告<br/>未经授权或恶意的网络活动。<br/>以下是SOC功能的一长串列表。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/dd97c33c44113c66d983887d6da2845a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y0uAMWJZT5E-wWbZtmdkyQ.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">图片来源—<a class="ae kv" href="https://expel.io/" rel="noopener ugc nofollow" target="_blank">https://exclude . io</a></figcaption></figure><p id="2d2a" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">要在任何组织的SOC中实现这些功能，成本可能从几百万美元到十亿美元不等。根据组织的规模，构建SOC需要在流程、人员和技术方面进行投资。</p><p id="302a" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">任何SOC的关键部分都是响应警报和事件的流程。警报是通过网络上的各种设备生成的，它们被送到第一级分析师那里进行初步审查。如果第一层无法解决事件，则会升级到下一层，下一层的人员拥有更高级的知识和事件响应工具。</p><p id="22f9" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">很多时候，在SOC团队的第一层分析中，需要花费时间来确定警报是真阳性还是假阴性。如果警报是真的，那么SOC团队将进行下一级警报分析，否则他们将丢弃该警报。这里需要机器学习来将警报分类为真肯定或假否定。通过考虑机器学习方法，可以节省大量SOC操作时间。</p><p id="7dea" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">让我们看看如何做到这一点…</p><h1 id="ec13" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">数据收集和再处理</strong></h1><p id="905e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我使用Spyder Python框架来分析数据。让我们导入必要的python库。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/f68b5f1aa3e93b0f26bbd9498392c319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AqapyOHEHjuaKibZqsHvag.jpeg"/></div></div></figure><p id="a4e3" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">SOC团队提供了2个数据集csv文件。我需要将这两个文件合并成一个，但在此之前，我们需要了解它们的字符编码。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/e5af46779715356c95821a7fc7b1b936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovAPiLi5blnJPEt68_Vb-g.jpeg"/></div></div></figure><p id="50e5" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">第一个False_Positive.csv文件采用ascii编码，其他文件采用ISO-8859–1编码。使用这些编码格式，可以读取csv文件并创建数据帧。</p><p id="792b" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">创建新列并为其分配二进制值，以指示警报的类型。确保两个数据框中的列名正确且有序。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/5d1fd2a48e1960838f465c1e799cc2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uTPS8GvVBnu-NjfUfyrkOw.jpeg"/></div></div></figure><p id="a538" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">让我们合并两个数据帧。第二个数据帧被附加到第一个数据帧，但是它需要对数据进行混洗，以便很好地混合两种类型的警报。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es le"><img src="../Images/1ddbaffe16da3ba20c3f58053792e5b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*jS5Vv1i60EGSBOcALTzx9Q.jpeg"/></div></figure><p id="43cd" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">现在我们有935个警报，有39个属性。</p><p id="a138" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated"><strong class="jq hj">处理NaN值</strong></p><p id="4e9c" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">39个属性中有更多的属性具有NaN值。下面的代码片段有助于查找值为null且百分比大于50的属性。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/d5d6bad2554b7260315ec1367b65c653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUc1LOyiiCMzbbDGQ8cWrA.jpeg"/></div></div></figure><p id="aec3" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">创建一个新的数据框，保留值为空且百分比大于50的属性。我将删除“结束时间”,因为这些值是唯一的，不会给分析增加任何值。新的数据框有13个属性，包含大量用于分析的信息。尽管如此，它仍有价值，需要适当的对待。在此之前，混洗数据，并分配给新的数据框new_dataset_shuffled。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/f55e4ebb5a7c95deb63acbd92218ced6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vjhe4pDCLfPX2jEv8F-rQg.jpeg"/></div></div></figure><p id="2823" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">现在，下一步是以80:20的比例将数据集分为训练和测试。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/2855e46836a00697c9e70c4edf848341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rzeoe_2Wds9b0oaF-3M7Nw.jpeg"/></div></div></figure><p id="b27f" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">除预警类型属性外，其他属性均为非数值类型。因此，我将应用<strong class="jq hj"> one hot和哈希编码技术</strong>将数据转换为数字数据。</p><h1 id="b345" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">编码、建模和评估</h1><p id="25a8" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">让我创建一个助手函数来拟合一个模型，评估测试集并返回分数。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/220cd6e18b4fffe57a574cc61398b1f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ElKztIKOuN7JPEU3KYnkkg.jpeg"/></div></div></figure><p id="68a4" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">创建逻辑回归和随机森林分类模型的对象。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/28897146aba41cda941dee2d783ad395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*iOyhBupmWDfh-0ffgKcV-Q.jpeg"/></div></figure><p id="fc18" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated"><strong class="jq hj">现在我将按照下面的步骤对每一种编码技术进行操作。</strong></p><ol class=""><li id="3a56" class="lk ll hi jq b jr kw jv kx jz lm kd ln kh lo kl lp lq lr ls bi translated">将编码技术应用于训练和测试数据集</li><li id="0a94" class="lk ll hi jq b jr lt jv lu jz lv kd lw kh lx kl lp lq lr ls bi translated">用编码的训练数据集训练模型</li><li id="b467" class="lk ll hi jq b jr lt jv lu jz lv kd lw kh lx kl lp lq lr ls bi translated">为编码的测试数据集测试模型</li></ol><p id="b7af" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated"><strong class="jq hj">带一个热编码</strong></p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/270ffd636e33676eda1e3617dad8cd0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxjcAK6zwiCihBYLybXd-g.jpeg"/></div></div></figure><p id="13a8" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">具有一个热门编码的逻辑回归得分:0.9799516908212561 <br/>具有一个热门编码的随机森林得分:0.996060607</p><p id="3b15" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated"><strong class="jq hj">采用哈希编码</strong></p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/8eb7240b419792a5f6fed01bf11cd6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U9OFPJg7FLNyqWpm5S5yNA.jpeg"/></div></div></figure><p id="2474" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">使用哈希编码的逻辑回归得分:0.9794685990338163 <br/>使用哈希编码的随机森林得分:0.9799000001</p><h1 id="f1cf" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="0154" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">从结果中，我们可以得出结论，具有一个热编码的逻辑回归表现更好，为97.99%</p><p id="fafb" class="pw-post-body-paragraph jo jp hi jq b jr kw jt ju jv kx jx jy jz ky kb kc kd kz kf kg kh la kj kk kl hb bi translated">git hub中提供了源代码。</p><div class="ma mb ez fb mc md"><a href="https://github.com/teggi2481/case_studies" rel="noopener  ugc nofollow" target="_blank"><div class="me ab dw"><div class="mf ab mg cl cj mh"><h2 class="bd hj fi z dy mi ea eb mj ed ef hh bi translated">teggi 2481/案例研究</h2><div class="mk l"><h3 class="bd b fi z dy mi ea eb mj ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ml l"><p class="bd b fp z dy mi ea eb mj ed ef dx translated">github.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr io md"/></div></div></a></div></div></div>    
</body>
</html>