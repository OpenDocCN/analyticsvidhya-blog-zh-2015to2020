<html>
<head>
<title>An interesting use case for the ML clustering algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ML聚类算法的一个有趣的用例</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/an-interesting-use-case-for-the-ml-clustering-algorithm-7901278164e7?source=collection_archive---------2-----------------------#2019-03-22">https://medium.com/analytics-vidhya/an-interesting-use-case-for-the-ml-clustering-algorithm-7901278164e7?source=collection_archive---------2-----------------------#2019-03-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/47b70b33241442360595444c7b033f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76jov9x12aseTuOFjBV5IA.jpeg"/></div></div></figure><div class=""/><p id="4937" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">机器学习中的聚类算法是一种无监督算法，用于理解非结构化数据集。例如，它用于文档分类、客户细分等。除此之外，聚类还可以用于检测异常或离群值，以及用于监督学习的其他基本预处理步骤。</p><p id="7512" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些是集群的一些常见应用。该算法的另一个有趣的用例是查找图像的主色或调色板。让我们理解如何做到这一点。</p><h2 id="9768" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">寻找图像的调色板</h2><p id="391e" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">通常，图像会有数百万种颜色，但它们遵循调色板或配色方案。因此，使用聚类，相似的颜色(按像素值排序，RGB)将被聚类在一起。之后，只需找到聚类中心，并将该颜色值应用于聚类的其余部分。</p><p id="4388" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我使用了K-Means聚类算法来进行聚类。要处理图像并找到聚类质心，首先将图像加载到一个Numpy数组中，然后通过除以255来展平范围从0到255的颜色值。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="0a20" class="jo jp ht kt b fi kx ky l kz la">im = cv2.imread("test_image.jpeg")<br/>im_flat = np.divide(im, 255)</span></pre><p id="58cc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经将图像加载到一个形状为(3204，4271，3)的Numpy数组中，我们需要通过整形将它转换为一个更小的数组，因为我们担心的是像素颜色值，而不是像素的位置。整形后数组变成(13684284，3)。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8e51" class="jo jp ht kt b fi kx ky l kz la">X = im_flat.reshape(-1, 3)</span></pre><p id="e965" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，对输入数组运行聚类算法应该可以得到所需的聚类中心。这里使用了Scikit-learn中的K-Means聚类API。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="befd" class="jo jp ht kt b fi kx ky l kz la">K = 8<br/><br/>kmeans = KMeans(n_clusters=K, random_state=0, verbose=0, max_iter=5).fit(X)</span></pre><p id="1c4d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下，簇的数量被选择为8。在运行该算法之后，属于一个聚类的像素值被赋予位于聚类中心的像素值。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="3bf1" class="jo jp ht kt b fi kx ky l kz la">X_recovered = kmeans.cluster_centers_[kmeans.labels_ , :].reshape(im.shape)</span><span id="d9fb" class="jo jp ht kt b fi lb ky l kz la">X_recovered = X_recovered * 255</span></pre><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lc"><img src="../Images/747a874fdc6705f57e907a32a41a0b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ru3axySGHpi4AStdm9X_Ug.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">生成的图像与原始图像并排绘制，以显示差异。</figcaption></figure><p id="f127" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我最近发现的聚类算法的一个有趣的用法。它可以用来寻找主色或找到调色板，并用它来着色其他图像。</p><p id="359a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我试用的Jupyter笔记本在这里有售<a class="ae lh" href="https://github.com/johnymephisto/Machine-Learning-and-Deep-Learning-Experiments/tree/master/Color%20Quantization%20using%20K-Means" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="bbe0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谢谢你。</p></div></div>    
</body>
</html>