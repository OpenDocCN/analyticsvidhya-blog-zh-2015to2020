<html>
<head>
<title>Machine learning and multiprocessing. How to speed up correlation calculation.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习和多重处理。如何加快相关计算？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-and-multiprocessing-4c24f4bfe568?source=collection_archive---------9-----------------------#2020-02-04">https://medium.com/analytics-vidhya/machine-learning-and-multiprocessing-4c24f4bfe568?source=collection_archive---------9-----------------------#2020-02-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1a207524d1f851b4f54572c6e5a8eec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2TUnJuwpwYbBasig"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">弗兰基·查马基在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4094" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">机器学习、数据科学和相关性共生共存，Python是在这一领域工作的便捷工具。</strong>数据集由包含多个变量的观察值组成，相关系数衡量这些变量之间的关联。在下面的例子中，我们看三个不同的特征(贷款数量、平均工资收入、平均税收收入)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/87935dc89ac5810303e5a9cc61ecc191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4q1pzmrnH0vC3nDJK7Pmg.png"/></div></div></figure><p id="803e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们选择最终模型的特征时，我们通常希望去除相关的特征，因此通常的做法是计算数据集的相关矩阵。解决方法之一是使用速度非常快的<em class="jy"> numpy.corroef </em>方法。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="dfe0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但它会在所有情况下都有效吗？</p><h1 id="c81d" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">具有NaN和INF的变量的相关性<strong class="ak">计算</strong></h1><p id="5968" class="pw-post-body-paragraph iv iw hi ix b iy kz ja jb jc la je jf jg lb ji jj jk lc jm jn jo ld jq jr js hb bi translated">假设我们开发了一个新的、非常有用的特性，即平均税额和平均工资额之间的比率。不幸的是，有些观察没有税务交易，有些没有工资交易。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/3256c591931ab6c8a7a24c0b20e61090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dg_nZOMYKBDRoD3mRfzLFw.png"/></div></div></figure><p id="6860" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们以四个结果结束:</p><ul class=""><li id="9d49" class="lf lg hi ix b iy iz jc jd jg lh jk li jo lj js lk ll lm ln bi translated"><strong class="ix hj"> -0.2 </strong>正常浮动数:-800 / 4000</li><li id="333e" class="lf lg hi ix b iy lo jc lp jg lq jk lr jo ls js lk ll lm ln bi translated"><strong class="ix hj"> inf </strong>平均工资金额为0，平均税为正(纳税申报):100 / 0</li><li id="cb85" class="lf lg hi ix b iy lo jc lp jg lq jk lr jo ls js lk ll lm ln bi translated"><strong class="ix hj"> -inf </strong>平均税为负，没有工资:200 / 0</li><li id="673e" class="lf lg hi ix b iy lo jc lp jg lq jk lr jo ls js lk ll lm ln bi translated"><strong class="ix hj">南</strong>无税无薪交易:0 / 0</li></ul><p id="fd88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">姑且称之为<strong class="ix hj"> NaN </strong>、<strong class="ix hj"> inf </strong>和<strong class="ix hj"> -inf </strong> <em class="jy">特殊浮点值。</em></p><p id="7f14" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们仍然希望将这些变量与特殊的浮点值关联起来，但是默认的方式(使用numpy)不起作用，因为它只返回nan作为结果。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="34f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在<em class="jy"> pandas </em>库中有一个名为<em class="jy"> corr </em>的方法，用于计算观察值与<em class="jy">特殊浮点值</em>的相关性，缺点是它只是单线程的，因此对于大表来说很慢。对于一个有5000个观察值和5000个变量的表来说<em class="jy"> corr </em>需要15分钟。</p><h1 id="ab88" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">用特殊浮点值加速计算关联</h1><p id="da95" class="pw-post-body-paragraph iv iw hi ix b iy kz ja jb jc la je jf jg lb ji jj jk lc jm jn jo ld jq jr js hb bi translated">在Kontomatik，我们关心的是缩短我们分析的反馈回路，所以我们希望加速计算与特殊浮点值的相关性，所以我的想法是使用多个内核进行计算。我们开发了一个名为<em class="jy"> NaNCorrMp </em> ( <em class="jy"> NaN </em>表示<em class="jy">特殊浮点值之一</em>，<em class="jy"> Corr </em>表示相关性，而<em class="jy"> Mp </em>表示多处理，听起来像《星球大战》中的Rancor)，它使用多处理器架构来执行那些类型的相关性计算。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="9a17" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于一个有5000个观察值和5000个变量的表，<em class="jy"> pandas </em>方法需要15分钟。使用<em class="jy"> NaNCorrMp.calculate </em>和4核时，需要4.5分钟。利用Kontomatik中的数据科学问题，可以在几个小时内而不是几天内计算出带有<em class="jy">特殊浮点值</em>的数万个观测值的相关表。这对于允许我们使用16或32个处理器的云来说尤其方便。</p><p id="5aea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">NaNCorrMp可以简单地通过pip安装:</p><pre class="ju jv jw jx fd lt lu lv lw aw lx bi"><span id="e6bf" class="ly kc hi lu b fi lz ma l mb mc">pip install nancorrmp</span></pre><p id="2c94" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">或者从存储库中克隆:</p><pre class="ju jv jw jx fd lt lu lv lw aw lx bi"><span id="5065" class="ly kc hi lu b fi lz ma l mb mc">git clone git@github.com:bukson/nancorrmp.git</span></pre><p id="097d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们Kontomatik非常清楚开源是软件开发的基石，只有每个人都支持社区，开源才会存在。当我们偶然发现一些似乎还没有解决的问题，并且我们解决了，我们很乐意分享。因此，当我们开发了用于计算具有NaN和infs的变量的多个过程的相关性的模块时，我们正在与数据科学社区共享。</p><p id="9b65" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所有细节和代码都可以在这里找到:</p><p id="f7da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://github.com/bukson/nancorrmp" rel="noopener ugc nofollow" target="_blank">https://github.com/bukson/nancorrmp</a></p><p id="c3df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您对Kontomatik如何使用机器学习进行财务数据分析并提高评分模型准确性的更多知识感兴趣，请查看Kontomatik网站。</p></div></div>    
</body>
</html>