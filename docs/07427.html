<html>
<head>
<title>A basic example of a machine learning prediction: Predicting contraceptive use in rural Nigeria</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习预测的一个基本示例:预测尼日利亚农村的避孕药具使用情况</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basic-example-of-a-machine-learning-model-prediction-predicting-modern-contraceptive-use-in-rural-c5e35e8aa877?source=collection_archive---------12-----------------------#2020-06-25">https://medium.com/analytics-vidhya/basic-example-of-a-machine-learning-model-prediction-predicting-modern-contraceptive-use-in-rural-c5e35e8aa877?source=collection_archive---------12-----------------------#2020-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/60fec71ac4384adfdc166f674193d605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S3VUeDIzq8yy0A2B"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Arif Riyanto 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1e79" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我们使用尼日利亚人口和健康调查的真实示例数据来开发一个机器学习模型，该模型将使用逻辑回归分类模型来预测尼日利亚农村地区的现代避孕药具使用情况。</p><p id="1ae4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文将包含以下几个部分:</p><blockquote class="jt ju jv"><p id="b3b0" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">分析概述及数据来源</strong></p><p id="0cd2" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">将数据加载到python中</strong></p><p id="ce15" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">数据和特性描述</strong></p><p id="27d4" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">从整个数据框架中挑选出农村受访者样本</strong></p><p id="f2a8" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">单变量(单特征)探索性数据分析</strong></p><p id="f2f7" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">特征工程</strong></p><p id="ad97" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">双变量(两个特征)探索性数据分析和关联性检验</strong></p><p id="36e7" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">检查缺失值的特征</strong></p><p id="9bf6" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">虚拟编码特征</strong></p><p id="c60f" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">类别不平衡校正和训练/测试数据分割</strong></p><p id="a011" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">用于建模的特征选择</strong></p><p id="5784" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">数据建模</strong></p><p id="47d0" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">车型性能评估</strong></p><p id="6f6c" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">模型特征重要性</strong></p><p id="50e9" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj"> k倍交叉验证</strong></p><p id="f1d1" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">保存模型以备将来使用</strong></p></blockquote><h2 id="1878" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">分析和数据源概述</h2><p id="a77a" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">这篇文章将利用最新的免费二手数据来源的人口和健康调查(DHS)为尼日利亚，所谓的NDHS 2018。它是在2018年进行的，因此得名。DHS是在发展中国家进行的一项具有全国代表性的调查。如需从DHS计划获取任何国家级免费数据，请访问<a class="ae iu" href="https://dhsprogram.com/data/dataset_admin/login_main.cfm?CFID=6656492&amp;CFTOKEN=ce6ca5b288d60002-2AFF6515-C723-702A-D46EDCBB32A8BDBD" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> DHS计划</strong> </a>，注册并申请。</p><p id="2e13" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个分析中，我们将利用python库来实现研究的不同部分。具体来说，我们将使用:</p><p id="ca0c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">a . Pandas</strong>——将我们的数据集读入python并进行操作，以便进行分析；</p><p id="d7fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> b. Matplotlib和Seaborn</strong>——进行所有可视化；</p><p id="f0e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">c. Numpy和Scipy——执行所有科学、数学和统计计算；</p><p id="fea6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">f. Sklearn  —提供建模所需的算法；</p><p id="f411" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> g. Eli5 </strong> —确定模型中特征的重要性顺序；和</p><p id="174a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> h. Joblib </strong> —保存模型以备将来使用和部署。</p><p id="4dcc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这一分析的总体目标是开发一个二元逻辑模型，通过观察尼日利亚农村地区的育龄妇女(15-49岁)的社会人口特征和近似特征，即年龄、工作状况、婚姻状况、宗教、居住地区、产次、教育程度、财富指数和性活跃程度，确定该妇女目前是否使用现代避孕方法。</p><p id="ad0f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">二元逻辑模型，顾名思义，是一种机器学习分类模型，适用于预测只有两个响应类别的分类目标特征，其中一个响应类别在数字上编码为1，另一个编码为0。在任何时候，预测1或0的结果将由一组识别、选择和合格的预测器特征来确定。在选择预测特征时，必须以领域知识为指导。</p><h2 id="9f28" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">将数据加载到python</h2><p id="33fc" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">正如DHS项目所提供的，NDHS 2018年奥运会的数据集有不同的格式。csv，。sav，。dta，。xls等)。在这个分析中，我们将使用。dta (STATA扩展)格式。</p><p id="1686" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们将首先导入该分析所需的所有python库。注意:我们使用来自anaconda的jupyter笔记本作为本次分析的集成开发环境(IDE)。</p><p id="cda6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将把NDHS数据集导入熊猫。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="50ac" class="ka kb hi lf b fi lj lk l ll lm">path=r"B:\NGIR7ADT\NGIR7AFL.dta"<br/>DHS=pd.read_stata(path)<br/>Variables_needed=['v024', 'v130', 'v502', 'v025', 'v106', 'v190', 'v201', 'v313', 'v536', 'v013', 'v714']<br/>Total_Sample=DHS[Variables_needed]</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/10615ebc8d7f080a470c06ecb91e4aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jcZWOHVNWGZFJqgOrKwm6Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1</figcaption></figure><p id="1ae7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总样本是41821(全部受访者的数据)，从NDHS数据集导入到pandas进行分析的总特征是11。(注:NDHS 2018数据集共有5394个特征/变量)。</p><p id="8636" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">熊猫数据框架中NDHS 2018数据集的数据结构如下所示:</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/2b5882bb990b11bab521c65e33cac0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHYM5aJcCDpVQ7RDLxEDRw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图2</figcaption></figure><h2 id="e05a" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">数据和功能描述</h2><p id="9283" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">下表显示了将在此分析中使用的特性/变量及其特征:</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/357ade23985674face99b8a61931ab73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8p874yECyR1hhCkNtPy63A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd kc">此分析中使用的特性列表</strong></figcaption></figure><p id="00f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">从属或目标特征/变量</strong></p><p id="d1a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在此分析中，特征v313是从属或目标特征。它有回应类别:无方法、现代方法、传统方法和民俗方法。由于我们将在此分析中使用逻辑回归模型，它将被特征工程重新编码，从四个响应类别特征重新编码为两个。</p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/6ec1a9ffd41da52ab804340cd2d6f455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*TrfDyKbLgw7WlpWfQ3iuhg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3</figcaption></figure><p id="392a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将把这四个响应类别分为编码为1 的<strong class="ix hj">“使用现代避孕药”和编码为0的<strong class="ix hj">“不使用现代避孕药”。</strong></strong></p><p id="9bd5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">预测器特性</strong></p><p id="3e5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在该分析中，预测值或独立特征是v024、v106、v130、v190、v013、v201、v714、v502、v536。特征v025将用于选择农村样本，并从数据帧中删除城市样本。将v025用于该功能后，我们将从数据框的功能列表中删除它。</p><h2 id="26ed" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">从整个数据框架中选择农村受访者样本</h2><p id="b4be" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">为了从整个数据(41，821)中获得所需的农村受访者样本，我们将使用v025特征。以下是v025特性的响应类别和频率分布:</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/ae02af9f5691afb7c1c15d3d1d485046.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8lbF-ayj-in04OCyKnJiQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4</figcaption></figure><p id="44f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将从数据集中删除城市受访者的数据。因此只有农村受访者的数据会出现在数据框架中。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="9b46" class="ka kb hi lf b fi lj lk l ll lm">Rural_data_only=Total_Sample.drop(Total_Sample[Total_Sample['v025']=='urban'].index)</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/c2ffa70cba4f29421545f41b22e3f059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R7TJXUTjKg7nJNABMZ0waA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5</figcaption></figure><p id="e4bc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还可以检查Rural_data_only要素信息，以查看v025要素是否仍在要素中。</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/12f955b13f8e83605d642193e9773c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEqN2ZL5jL-a9cr8Py4_iA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图6</figcaption></figure><h2 id="c1f1" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">单变量(单一特征)探索性数据分析(EDA)</h2><p id="fa1d" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">在本节中，我们将尝试使用频率分布、百分比分布和可视化来理解单变量(单个特征)的特征分布。</p><p id="ab31" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将首先尝试理解我们的目标功能，即v313。评估频率和百分比分布可以指导和建议任何所需的特性工程。</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/93b0eed5802dd89fa0d3487852bcc064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZrFVSRZ18ToohkuUJt0wjg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图7</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/575f8943966f135e17d0e5f4572cd9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ByIIbdQCA8guNCz4jkE6g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图8</figcaption></figure><p id="ef3c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如上所示，正如前面所讨论的，我们的预测特征有四个响应类别，我们需要将这个类别分成两个，以便可以满足逻辑回归模型的使用条件。我们将在这里解决这个问题。</p><p id="9e8b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，我们观察到使用现代方法的农村妇女比例仅为8%；这意味着现代避孕药具使用者与非避孕药具使用者的比例约为1:9。这表明存在不平衡分类问题。我们将在班级不平衡修正部分解决这个问题。</p><p id="fbde" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是对其余特征的单变量探索性分析:</p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/883584830f73f8d44a2c2251e0c61e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*URPVLhpqAsl23JHJf8OBpw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图9</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/335e407e987afa124db91bbca3298e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*KI39dznWdfjwFf6Etx43UQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图10</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/a0b25a120b2386a27ff0f07f6fd94a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*dgMK-yCQqUUQg5ryPnlguA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图11</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/136aa8feeba45eaa789deee81e82971a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*il43H3SSYvN8oEppHpy9xQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图12</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/3590ac78aa28413c8987b1da87451031.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*0ziTvY6B8pzMR4igjEXphQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图13</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/dfc683b98f51a4dbb73d800a998fa3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*l9GWZLxKzUqsL9nE4bCmTA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图14</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/0fc0ddb83f94079e688f53d57a9253a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*mgjA-Cag9Wus-yHSFkTQFQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图15</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es md"><img src="../Images/87432f05f069fe35f39e82c00df7d504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*n-MYYzLznrieRBTOVp5L8Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图16</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es md"><img src="../Images/4fc83fee6fb051f9cbcdaf926409f798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*vznoSTESEy4fyiay17UOjw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图17</figcaption></figure><p id="a495" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基于上面的单变量探索性分析和领域知识，我们需要重新编码一些特性的响应类别。我们将在特征工程部分做这件事。</p><h2 id="c28e" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">特征工程</h2><p id="9322" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">在本节中，我们将根据单变量探索性分析，对一些特征的反应类别进行重新编码和分组。在进行双变量探索性分析之前，这是很重要的。</p><p id="52e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们需要对以下特征的反应类别进行分组:避孕药具使用(v313)、宗教(v130)、教育(v106)、财富指数(v190)、产次(v201)、性活跃程度(v536)，也就是说，对于这些选定的特征中的每一个，我们需要将它们的一些反应类别折叠起来。</p><p id="f439" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为一个例子，对于宗教(130节)，我们可以把“其他基督徒”和“天主教徒”归为“基督徒”一类。此外，我们会将“传统主义者”和“其他人”合并成一个类别作为“其他人”，这样，宗教特性(130节)现在将有三个响应类别，即:穆斯林、基督徒和其他人。</p><p id="4abc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是所需的每个功能的工程设计:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="e453" class="ka kb hi lf b fi lj lk l ll lm">Independent_recode_v130 =  {"v130":<br/>                            <br/>                            {"other christian": 'christians',  <br/>                             "catholic": 'christian',  <br/>                             "other": 'others',  <br/>                             "traditionalist": 'others',  <br/>                             "islam": 'muslim'}<br/>                           }</span><span id="69d0" class="ka kb hi lf b fi me lk l ll lm">Rural_data_only.replace(Independent_recode_v130, inplace=True)</span><span id="7bf4" class="ka kb hi lf b fi me lk l ll lm">Rural_data_only['v130'].value_counts(normalize=True) * 100</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/d54e709d8e5ff32c1d305b577b960f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LrHxh45dliYZBs4QjsNIpQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图18</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/d0fcff03f7fb56b4dcc207e1a817f725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*wIc1gg22mi4H5JAEjljwgQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图19</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/6cfc16ae5fa417073c1b5a78fbf06765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amejYt07CaLhwAsq5Ds69A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图20</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/afb62984abb982c70fbdd2e668a12c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*jHbOVwleHW4SIItZrZcopA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图21</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/a5dc21c9591e249baaa64bd918691dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrWAdamgHvhzBqoqApXdow.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图22</figcaption></figure><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b1ae" class="ka kb hi lf b fi lj lk l ll lm">Independent_v201 = {<br/>                "v201": {0: '0',  1: '1-5',  2: '1-5',  3:'1-5',  <br/>                         4: '1-5', 5: '1-5', 6: '6', 7: '7+',  <br/>                         8: '7+',  9: '7+',  10: '7+',  11: '7+',  <br/>                         12: '7+',  13: '7+',  14: '7+',  15: '7+',  <br/>                         16: '7+', 17: '7+'}<br/>                    }<br/>Rural_data_only.replace(Independent_v201, inplace=True)<br/>Rural_data_only['v201'].value_counts(normalize=True) * 100</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/c03eb6c925fcbe7b7b981d4e1b49280c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*loUKduKkMewc211F0p2nOA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图23</figcaption></figure><h2 id="9ed1" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">双变量(两个特征)探索性数据分析(EDA)和关联性检验</h2><p id="32e8" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">现在，我们将通过数据可视化在每个预测特征和从属或目标特征之间进行双变量探索性分析，以了解每个独立特征的反应类别中从属特征的分布模式。</p><p id="be88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">婚姻状况和现代避孕药具使用情况</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/2118fd56346f556098a970ecc225adc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*aWc_9NgiJfOy4BMjxq9t3w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图24</figcaption></figure><p id="fba6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的分析来看，已婚(以前或现在)的受访者似乎比未婚者使用现代避孕方法。这表明婚姻状况可以很好地预测现代避孕药的使用。两个特征之间关联的卡方统计检验表明相同(χ2 = 33.657，p值= 0.000)</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="01f4" class="ka kb hi lf b fi lj lk l ll lm">tab1=pd.crosstab(index=Rural_data_only.v502, columns=Rural_data_only.v313)<br/>print('The two-way table between marital status and modern contraceptive use status is: \n' , tab1)</span><span id="f7b5" class="ka kb hi lf b fi me lk l ll lm">chi2, p, dof, expected=chi2_contingency(tab1.values)<br/>print('Chi-square statistic is %0.3f,  p_value is %0.3f' %(chi2,p))</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/72bad0df5e4a5ba47f322f604cd708fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R9CKpFygTgppbw7iO1EowA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图25</figcaption></figure><p id="0269" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">宗教和现代避孕药的使用</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/1be4f5fd18c9eec57e6ee27568267096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*Kjw_sRheL9D8zK4CLEf8dQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图26</figcaption></figure><p id="570b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的分析来看，似乎基督徒回答者使用现代避孕药具，比穆斯林多三倍，这可能意味着宗教可能是现代避孕药具使用的一个强有力的预测因素。统计检验也显示了同样的结果——χ2 = 795.017，p值= 0.000</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/489a669d6570942af654fe65d9487808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5mo8Op5VjWoYqu0euVBgQ.png"/></div></div></figure><p id="5990" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">财富指数和现代避孕药具的使用</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/0b3737525a98f0b86dfa86eab5d1f1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*7qsCYzJiHdf-PZ3B1SXpfA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图27</figcaption></figure><p id="5466" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据上述分析，富人(数据集中的富人和普通受访者)与穷人受访者之间的比较表明，前者比后者更多地使用现代避孕方法。卡方统计检验也显示了同样的结果——χ2 = 374.002，p值= 0.000。</p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/cfb4e3eea97a888c992c23d316b20327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*3cf8UTvjD6eFCS7AydIXGg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图28</figcaption></figure><p id="0f68" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">工作状态和现代避孕方法的使用</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/9196e805edc282358b86f776a192f96d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*W2a7haN4Sz6XT42PlDlXPA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图29</figcaption></figure><p id="dfe6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据上述分析，目前有工作的受访者似乎比没有工作的受访者更多地使用现代避孕药具。这可能意味着工作状态可能是现代避孕药使用的一个重要预测因素。这是关联的卡方检验— χ2 = 186.850，P值= 0.000</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/4a41f3a283ed12e8acc6a1ea792c3744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WouAImCrCQvTzSIlhuFQtg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图30</figcaption></figure><p id="3c8d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">年龄和现代避孕方法的使用</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/430dabfadf91b454b68e01b2e9797d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*DZ6vfWmmFewdab1xLFBhnw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图31</figcaption></figure><p id="a5fa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上述分析来看，随着年龄的增长，现代避孕药具的使用似乎有所增加。这似乎在25-39岁的受访者群体中达到顶峰，然后开始下降。这表明年龄可能是现代避孕药使用的一个重要预测因素。相关的卡方统计检验也显示了相同的结果(χ2 = 365.577，p值= 0.000)，如下所示</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/d71f6f55897ab6c4878f0fc48f03f809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2DuelXXTG7kKEbuILjeVWg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图32</figcaption></figure><p id="52ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">胎次(曾经生育的孩子数量)和现代避孕方法的使用</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/cd5fed306c3cc7be8f43ce73dc530777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RFoTqCFPwuC2EhIR_cwKg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图33</figcaption></figure><p id="bef6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据上述分析，似乎从未生育过的受访者不使用现代避孕药具，而生育过1至5次的受访者更多地使用现代避孕药具，生育过6次或6次以上的受访者使用现代避孕药具的比例明显低于生育过1至5次的受访者。这表明，产次可能是现代避孕药具使用的一个重要预测指标。关联的卡方检验也表明了这一点——χ2 = 177.454，P值= 0.000，如下所示</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/2f3aca2e068e3f67db8e735cd5379f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*9y_-p-DpFX1axyntLQhKqw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图34</figcaption></figure><p id="4a76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">性活跃和现代避孕方法的使用</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/059c526e3b238517feb3c241107ad84c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*K6pTgXlLlUtLLXYWsDTkXg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图35</figcaption></figure><p id="52a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上述分析中可以看出，只有曾经有过性行为的受访者才是现代避孕药具的主要使用者。此外，那些最近活跃的人比那些最近不活跃的人使用更多的避孕药具。这表明性活跃与现代避孕药具的使用密切相关。卡方统计还表明，性活跃程度和现代避孕药具的使用之间存在关联。</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/e7254ce57b26641a3e30947114a39cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oeIY9OJf4yivypo0v832AA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图36</figcaption></figure><p id="e4ac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">居住地区和现代避孕药具使用情况</strong></p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/c89c8a56b88d891fe3716efaf72b1201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*g3LxdQdmqtfM5I_MWX33xw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图37</figcaption></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/82c1d1d1c20840425b74266412b43b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_w0G79vXZgcWgMIc_4syw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图38</figcaption></figure><h2 id="4e26" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">检查要素是否有缺失值</h2><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/e7dbd1f9060583f0f51c6b6d923d68d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXY5K1DZZDEHjSWxq9cHZg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图39</figcaption></figure><p id="f4d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Rural_data_only数据框架中的所有要素都没有任何缺失值</p><h2 id="2de1" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">特征的虚拟编码</h2><p id="dd1d" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">机器学习监督模型仅依赖数字数据，否则它们将无法正常运行。这意味着，如果我们用当前的分类特征来填充模型，我们的模型可能无法运行。为了确保此分析中的模型运行，我们需要将我们的分类特征转换为虚拟特征。这包括将每个特性的每个响应类别转换为一个新列(特性),并赋予值1 0r 0。现在，我们将从数据框中的10个特征中的每一个创建一个虚拟特征。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="bd3e" class="ka kb hi lf b fi lj lk l ll lm">Create_dummies=pd.get_dummies(Rural_data_only)<br/>Create_dummies.columns.values<br/>Concat_Rural_data_only=pd.concat([Rural_data_only, Create_dummies], sort=False)<br/>Concat_Rural_data_only.columns.values</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/8a9518df941579ac9a471bd3d200f01e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2xAdRZL6N6p0-lInP5mtwQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图40</figcaption></figure><p id="23b4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，原始分类要素以及新创建的虚拟要素仍在Rural_data_only数据中。我们需要删除原始特征(因为它们是分类的和非数字的)，这样我们就只有虚拟特征(因为它们是数字的)</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="8cfa" class="ka kb hi lf b fi lj lk l ll lm">Concat_Rural_data_only=Concat_Rural_data_only.drop(['v130', 'v502', 'v024', 'v106', 'v190', 'v201', 'v536', 'v013', 'v714', 'v313', 'v313_Not using modern method'], axis=1)</span><span id="ca1a" class="ka kb hi lf b fi me lk l ll lm">Concat_Rural_data_only.fillna<br/>Concat_Rural_data_only = Concat_Rural_data_only.dropna()<br/>Concat_Rural_data_only.dtypes<br/>Concat_Rural_data_only=Concat_Rural_data_only.astype(int)<br/>Concat_Rural_data_only.dtypes<br/>Concat_Rural_data_only.columns.values</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/4c7dfe8f4f3922868867bee0082a37c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDwmQQ7ZpPZ4tYanZsquzA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图41</figcaption></figure><p id="176c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在虚拟编码之后，我们将独立或预测特征的列表表示为X，而目标或相关特征的列表表示为y:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="3a7f" class="ka kb hi lf b fi lj lk l ll lm">X=Concat_Rural_data_only.drop('v313_Using modern method',axis=1)<br/>y=Concat_Rural_data_only['v313_Using modern method']<br/>y=y.to_frame()</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/0c080ce406d1b1e17d617de76204cb83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O3NUj2aluy8TjmXkXGHm9Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图42</figcaption></figure><h2 id="2162" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">类别不平衡校正和训练/测试数据分割</h2><p id="a858" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">回想一下，我们的从属特征有一个不平衡的分类问题，即使用现代避孕药具的受访者比例明显低于不使用的受访者。我们将在建模前解决这种不平衡。标准建模要求，当进行比较时，从属特征的响应类别的比例必须接近相等(45:55)，如果不相等(50:50)。我们将使用SMOTE(合成少数过采样技术)算法来解决这个问题。SMOTE将有助于平衡这两个等级。</p><p id="4439" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，请注意，我们已经将数据分成了训练和测试数据集；训练数据集占全部数据的70%，测试数据占30%。我们将使用训练数据来训练我们的模型，并使用测试数据来测试已训练的模型，以进行准确性和精确度评估。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="04bc" class="ka kb hi lf b fi lj lk l ll lm">os = SMOTE(random_state=0, ratio='auto')<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)<br/>columns = X_train.columns<br/>X_train.columns.values<br/>y_train.columns.values<br/>os_data_X,os_data_y=os.fit_sample(X_train,y_train.values.ravel())<br/>os_data_X = pd.DataFrame(data=os_data_X,columns=columns )<br/>os_data_y= pd.DataFrame(data=os_data_y,columns=['y'])</span><span id="1477" class="ka kb hi lf b fi me lk l ll lm">print("length of oversampled data is ",len(os_data_X))<br/>print("Number of non modern contraceptive users in oversampled data",len(os_data_y[os_data_y['y']==0]))<br/>print("Number of modern contraceptive users in the oversampled data",len(os_data_y[os_data_y['y']==1]))<br/>print("Proportion of non modern contraceptive users data in oversampled data is ",len(os_data_y[os_data_y['y']==0])/len(os_data_X))<br/>print("Proportion of modern contraceptive users data in oversampled data is ",len(os_data_y[os_data_y['y']==1])/len(os_data_X))</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/feab265bb83da29c855e183666f65095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GS36RCVtEAmL5yAbR6g9sw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图43</figcaption></figure><p id="d71b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的输出可以看出，从属特征响应类别现在达到了平衡。此外，SMOTE算法仅在训练数据上执行。这是为了确保测试数据中没有观测值被用于创建合成观测值，因为这会对模型预测准确度和精度产生负面影响。</p><h2 id="b1af" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">建模的特征选择</h2><p id="00a1" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">在这一部分中，我们将检查并选择最适合用于预测模型的特征。我们将使用递归特征消除(RFE)技术。RFE采用模拟重复模型预测过程来识别和指出我们的建模中应包含的合适和不合适的特征。它将合适的特征表示为<strong class="ix hj">真或1 </strong>，而被识别为不合适的特征表示为<strong class="ix hj">假或&gt; 1值。</strong></p><p id="3f60" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:特征数组中特征的顺序与其在布尔和数字列表中的RFE分数相同。例如，从下面的代码输出中，功能“v024_north central”是功能列表中的第一个(从顶部开始)，并在布尔和编号列表中取值“False”和“6”。此外，特征“v714_no”是特征列表中倒数第二个特征，它在布尔和数字列表中的位置相同。它在布尔和数字列表上接受“真”和“1”值。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="466a" class="ka kb hi lf b fi lj lk l ll lm">from sklearn.feature_selection import RFE<br/>from sklearn.linear_model import LogisticRegression<br/>logreg = LogisticRegression(solver='lbfgs', max_iter=1000, class_weight='balanced')<br/>rfe = RFE(logreg, 20)<br/>rfe = rfe.fit(os_data_X, os_data_y.values.ravel())<br/>print(rfe.support_)<br/>print(rfe.ranking_)<br/>X.columns.values</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/0a7dc4e8d6d3cf29bcfe04c398e080b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZ62q2DbznaqkSU-0tynMQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图44</figcaption></figure><p id="2757" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基于RFE评估，我们将从建模中排除布尔列表上具有“假”值以及数字列表上大于一(&gt; 1)值的特征。只有布尔值为“真”且数值为“1”的要素才会包含在模型预测中。</p><p id="17c8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下图中带有布尔值和数值的特征汇总:</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/978898ff5a97453b510a5c40c6e5752c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGLEu1_2TwQplS25wjmzcA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图45</figcaption></figure><p id="7a15" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基于这些标准，将在模型预测实现中排除的独立特征是:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="c488" class="ka kb hi lf b fi lj lk l ll lm">X=X.drop(<strong class="lf hj">['v024_north central', 'v024_north east', 'v024_north west','v024_south east', 'v024_south south', 'v024_south west', 'v130_christians', 'v130_muslim', 'v130_others','v502_never in union', 'v502_currently in union/living with a man','v502_formerly in union/living with a man','v536_active in last 4 weeks', 'v536_not active in last 4 weeks']</strong>, axis=1)</span><span id="4f26" class="ka kb hi lf b fi me lk l ll lm">X.columns.values<br/>X=X.columns</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/63901ec27c96ffe03decee8505f60723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7tPodRkS1WZPWQ726lhYg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图46</figcaption></figure><h2 id="aa3e" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">数据建模</h2><p id="6661" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">现在我们有了X和y的值。我们会用训练数据来填充我们的逻辑回归模型:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="dd57" class="ka kb hi lf b fi lj lk l ll lm">X=os_data_X[X]<br/>y=os_data_y['y']</span><span id="a01c" class="ka kb hi lf b fi me lk l ll lm">import statsmodels.api as sm<br/>logit_model=sm.Logit(y,X)<br/>result=logit_model.fit()<br/>print(result.summary2())</span></pre><p id="f32c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">建模的结果如下所示:</p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es ng"><img src="../Images/b0a18b86ab0db63b24506e6a1cdaf6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*1HwqzI_erPsZr0QnQWzPsg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图47</figcaption></figure><p id="12f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上表中可以看出，特征v106_primary、v201_0和v201_6的p值大于0.05，因此不是现代避孕药使用的重要预测因素(它们被认为不重要，因为它们的“p&gt;|z|”大于0.05)。因此，它们将作为预测器从模型中移除。此外，在这一点上，我们的模型使用我们的测试数据的预测精度是79%。这可以从下面看出:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="0dea" class="ka kb hi lf b fi lj lk l ll lm">from sklearn.linear_model import LogisticRegression<br/>from sklearn import metrics<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)<br/>logreg = LogisticRegression(solver='lbfgs', max_iter=1000, class_weight='balanced')<br/>logreg.fit(X_train, y_train)</span><span id="36c1" class="ka kb hi lf b fi me lk l ll lm">y_pred = logreg.predict(X_test)<br/>print('Accuracy of logistic regression classifier on test set: {:.2f}'.format(logreg.score(X_test, y_test)))</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nh"><img src="../Images/54df37984a188b6a43a2a441cc6027f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NI0nvxQDDK4B3F7-x6z0cA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图48</figcaption></figure><p id="a00b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将从X中删除3个特征，并再次运行模型，然后检查准确性和精确度。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="3ece" class="ka kb hi lf b fi lj lk l ll lm">X=['v106_no education', 'v106_secondary/higher',<br/>       'v190_Average', 'v190_poor', 'v190_rich', 'v201_1-5',<br/>       'v201_7+', 'v536_never had sex', 'v013_15-19',<br/>       'v013_20-24', 'v013_25-29', 'v013_30-34', 'v013_35-39',<br/>       'v013_40-44', 'v013_45-49', 'v714_no', 'v714_yes']</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ni"><img src="../Images/87ede1328ad481fa97221f0a7bd88bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OOU4i6dvLyG9eFGKM7dpGg.png"/></div></div></figure><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/2adaaf9d69abb20875819035b1ffffa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*7SqklxxuO4BfPo_oYnhR2Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图49</figcaption></figure><p id="9963" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所有包含的特征都是显著的(具有p值&lt; 0.05) in the new model. The prediction accuracy of this model is now 77%</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/c94805829cd7f4d076652e4763d40f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Xo0Zyjk9PWIZqqs9X4RIQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Figure 50</figcaption></figure><h2 id="e403" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">Model performance evaluation</h2><p id="ba8d" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated"><strong class="ix hj">混淆矩阵</strong></p><p id="6e0f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以评估混淆矩阵来查看正确和错误预测的分布</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="0f7d" class="ka kb hi lf b fi lj lk l ll lm">from sklearn.metrics import confusion_matrix<br/>confusion_matrix = confusion_matrix(y_test, y_pred)<br/>print(confusion_matrix)</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nj"><img src="../Images/1da03d07103e19db32e9f2a35b7ab1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t61MdPN_4jZ4LBefkBougw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图51</figcaption></figure><p id="8569" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">混淆矩阵的左对角线(3425，3948)上的元素是由模型正确预测的元素:</strong></p><p id="7dcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一行和第一列的第一个元素(3425-模型预测的使用现代避孕方法和正在使用的人数)以及第二行和第二列的元素(3948-模型预测的不使用现代避孕方法和正在使用的人数)由模型正确预测。总的来说，它们构成了模型77%的准确预测。</p><p id="2982" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">混淆矩阵右对角线(1330，908)上的元素是那些预测错误的:</strong></p><p id="c080" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一行第二列的第二个元素(1330-模型预测为使用现代避孕药但没有使用的人数)和第二行第一列的元素(908-模型预测为没有使用现代避孕药但正在使用的人数)被模型错误地预测。总体而言，它们构成了该模型23%的不准确预测。</p><p id="7a16" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">接收机工作特性曲线</strong></p><p id="7c27" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，我们将使用受试者工作特征曲线(ROC)来评估我们的模型的可靠性和强度，以准确预测。一个模型的好的ROC曲线是在平面的左上侧，即一个好的分类器模型具有远离左侧红色虚线的ROC曲线(蓝线)。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="14a0" class="ka kb hi lf b fi lj lk l ll lm">from sklearn.metrics import classification_report<br/>print(classification_report(y_test, y_pred))<br/>from sklearn.metrics import roc_auc_score<br/>from sklearn.metrics import roc_curve<br/>logit_roc_auc = roc_auc_score(y_test, logreg.predict(X_test))<br/>fpr, tpr, thresholds = roc_curve(y_test, logreg.predict_proba(X_test)[:,1])<br/>plt.figure()<br/>plt.plot(fpr, tpr, label='Logistic Regression (area = %0.2f)' % logit_roc_auc)<br/>plt.plot([0, 1], [0, 1],'r--')<br/>plt.xlim([0.0, 1.0])<br/>plt.ylim([0.0, 1.05])<br/>plt.xlabel('False Positive Rate')<br/>plt.ylabel('True Positive Rate')<br/>plt.title('Receiver operating characteristic')<br/>plt.legend(loc="lower right")<br/>plt.savefig('Log_ROC')<br/>plt.show()</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/4a534b6daeae6f760a1336e9fbe51bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*h2QuqRZqQD8-FqVy4UF9bQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图52</figcaption></figure><p id="a0d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ROC的结果如下所示:</p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es nk"><img src="../Images/ce3dee06328ffd841115514bc7072e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*bL_kB1Nmlm_AkZ9EXz91ig.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图53</figcaption></figure><p id="25b2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面可以看出，物流回归曲线(蓝色曲线)在ROC曲线的左上方。精确度和f1分数也凸显了我们车型的性能和优势。目前使用现代避孕药的f1值为78%,目前未使用的为75%。整体平均为77%。我们的模型预测目前使用现代避孕方法的精确度为75%,预测目前不使用任何方法的精确度为79%,总平均值为77%。</p><h2 id="9342" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">模型特征重要性</h2><p id="bdf9" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">因为我们现在已经有了一系列特征，这些特征是现代避孕药具使用的重要预测因素；重要的是要评估每个重要的特征水平，以预测模型中其他人使用现代避孕药具的重要性。</p><p id="c864" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用eli5库来评估特性的重要性，使用它的排列重要性技术。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="55ff" class="ka kb hi lf b fi lj lk l ll lm">perm = PermutationImportance(logreg, random_state=0).fit(X_test, y_test)<br/>eli5.show_weights(perm, feature_names = X_test.columns.tolist())</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es nl"><img src="../Images/e41326fc5ef7de9d03b13dcf65c8a243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*cfQ_ufudMhxBXbJhSTMfsA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图54</figcaption></figure><p id="a586" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从表格来看，重要性的顺序是从上到下。</p><p id="7b55" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，每一行中的第一个数字表示在模型中删除和重新排列特征时模型性能的降低程度。第二个数字是当特征在模型中被重组时模型性能的变化水平的度量。可以看出，如果混洗，贫穷(v190_poor)对模型性能具有最大的效应值可变性，并且对模型性能也具有最高的效应值。</p><p id="0b66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以说‘v190 _ poor’是预测现代避孕药使用的最重要特征。这意味着将受访者评定为贫困或其他是他们使用现代避孕药具的最强有力的决定因素。</p><h2 id="a66e" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">k倍交叉验证</h2><p id="fb0b" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">仅依赖模型的一次性精度值不是标准做法。训练模型和评估精度的过程最好重复几次。此后，取重复测量的平均值和标准差作为模型的最终精度值。这可以通过使用k倍交叉验证的概念来实现。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="c716" class="ka kb hi lf b fi lj lk l ll lm">from sklearn import model_selection<br/>from sklearn.linear_model import LogisticRegression</span><span id="2879" class="ka kb hi lf b fi me lk l ll lm">for scoring in["accuracy", "roc_auc"]:<br/>    seed = 0<br/>    kfold = model_selection.KFold(n_splits=10, random_state=0)<br/>    logreg = LogisticRegression(solver='lbfgs', max_iter=1000, class_weight='balanced')<br/>    results = model_selection.cross_val_score(logreg, X_test, y_test, cv=kfold, scoring=scoring)<br/>    print("Model", scoring, " mean=", results.mean() , "stddev=", results.std())</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nm"><img src="../Images/c65246d48fdb6979ee64003f5253bbe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzNUEJ20JhevFA4U70QEeA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图55</figcaption></figure><p id="80be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从k倍交叉验证来看，模型的平均准确率为77%，标准差为0.9。</p><h2 id="d0a5" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">保存模型以备将来使用</h2><p id="a86e" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">我们现在将保存模型，以备将来使用和部署</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4a5a" class="ka kb hi lf b fi lj lk l ll lm">from sklearn.externals import joblib <br/>  <br/># Save the model as a pickle file <br/>joblib.dump(logreg, 'ModernContraceptiveUsePredictorModel.pkl')</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nn"><img src="../Images/cbc2085efad04a17cd27a2843c7b6eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVkPX1D5yhSThp6ZFNJtUA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图56</figcaption></figure><p id="43df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用于此分析的Jupyter笔记本可在<a class="ae iu" href="https://github.com/ayobamiakiode/FirstProject/blob/master/Contraceptive_use_in_rural_Nigeria.ipynb" rel="noopener ugc nofollow" target="_blank">此处</a>获得</p><p id="a5e0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">这就对了。</strong>希望这对您有用？请放下你的评论，在LinkedIn上关注我，地址是<a class="ae iu" href="https://www.linkedin.com/in/ayobami-akiode-38528839/" rel="noopener ugc nofollow" target="_blank"> Ayobami Akiode LinkedIn </a></p></div></div>    
</body>
</html>