<html>
<head>
<title>Cleaning Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中清理数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cleaning-data-in-python-edfe6395ef77?source=collection_archive---------8-----------------------#2019-11-03">https://medium.com/analytics-vidhya/cleaning-data-in-python-edfe6395ef77?source=collection_archive---------8-----------------------#2019-11-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="febe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将利用Python的Pandas和NumPy库来清理数据。清理数据时有多种情况，以下是其中一些情况:</p><ul class=""><li id="494f" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">不一致的列名</li><li id="7bc6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">缺失数据</li><li id="5738" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">极端值</li><li id="1aad" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">重复行</li><li id="c9fb" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">懒散的</li><li id="9477" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">需要处理列</li><li id="8e23" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">列类型发出意外值的信号</li></ul><h1 id="0288" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak"> <em class="kp">使用数据框时的基本步骤:</em> </strong></h1><p id="93fb" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">读取csv文件并加载到数据帧df : <code class="du kv kw kx ky b">df=pd.read_csv(“”)</code></p><p id="5ca0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目测第一个和最后5个数据帧:<code class="du kv kw kx ky b"> df.head(),df.tail()</code></p><p id="818e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">df.columns</code>:返回列的索引。</p><p id="951a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">df.shape</code>:返回数据的行数和列数。</p><p id="a111" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">df.info(<em class="kz">)</em></code>:获取数据帧的附加信息。</p><p id="56b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">列值的频率计数:<code class="du kv kw kx ky b">df.columnname.value_counts(dropna=False)</code></p><h1 id="7e84" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">整理数据含义:</strong></h1><p id="ee1e" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">形式化我们描述数据形状的方式。</p><p id="388b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当格式化我们的数据时，它给我们一个目标。</p><p id="b91c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数据集中组织数据值的标准方式。</p><p id="744f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">整理数据的原则:</strong></p><p id="b822" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该列表示一个单独的变量。</p><p id="eda4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一行代表单独的观察。</p><p id="5f89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">观察单元形成表格。</p><p id="b474" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kz">数据问题我们正在修复</em>:包含值而不是变量的列。</p><p id="12a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kz">解决方案</em> : <code class="du kv kw kx ky b">pd.melt()</code></p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es la"><img src="../Images/65ceb7c674bc2d9d75d7921f7523ad22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NVc7AgZnQzk6MK5_1P1dA.png"/></div></div></figure><p id="ce11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据旋转</strong>:</p><p id="2d45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不熔化:与熔化相反。</p><p id="b63b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在融化中，我们把列变成了行。</p><p id="225e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">旋转-将唯一值转换成单独的列。</p><p id="fa0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分析友好数据形状以报告友好数据形状。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lm"><img src="../Images/c6168dde708cb1b5321d086f665b01a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrmXsnDzi_u8pE8G7lolTw.png"/></div></div></figure><p id="3a5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当存在重复条目时，在旋转时，我们会得到一个错误，所以我们需要使用pivot_table来代替它。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es la"><img src="../Images/a62425176fe1945fe1bd376cec479990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RWNOuqoV8qb4TavhLXW41g.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es ln"><img src="../Images/c477327628ecd1ae2542fd874f8f61a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LuBvbZSzaIzZFm4S5xI7dA.png"/></div></div></figure><h1 id="3dbc" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">连接数据:</strong></h1><p id="ec7e" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">数据可能不总是以大文件的形式出现，更容易存储和共享。</p><p id="87a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重要的是结合，然后清洁。</p><p id="31ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">result_dataframe=pd.concat([dataframe1,dataframe2])</code></p><p id="d225" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">result_dataframe将在concat后保留两个数据帧的原始索引，因此它将包含重复项。要解决此问题，我们需要使用以下命令重置索引。</p><p id="d0f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">result_dataframe=pd.concat([dataframe1,dataframe2],ignore_index=True)</code></p><p id="158b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，它将按行连接数据帧，用于按列连接数据帧添加参数axis=1。</p><p id="1ac3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kz">问题:</em>数据集少的话可以单独加载，但是数据集成千上万怎么办？</p><p id="5321" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kz">解决方案:</em> glob函数根据模式查找文件。</p><p id="bf45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="kz"/></strong>-文件名的模式匹配</p><ul class=""><li id="50a3" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">通配符:*？任何csv文件= *。csv，任意单个字符=file_？。战斗支援车</li><li id="ce7e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">返回文件名列表。</li><li id="5ac9" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">我们可以使用这个列表加载到一个单独的数据帧中。</li></ul><p id="a524" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kz">导入全球</em></p><pre class="lb lc ld le fd lo ky lp lq aw lr bi"><span id="8f45" class="ls js hi ky b fi lt lu l lv lw">csv_files=glob.glob(‘*.csv’)</span><span id="c06a" class="ls js hi ky b fi lx lu l lv lw">list_data=[]</span><span id="3288" class="ls js hi ky b fi lx lu l lv lw">for filename in csv_files:</span><span id="c69f" class="ls js hi ky b fi lx lu l lv lw">data=pd.read_csv(filename)</span><span id="5f81" class="ls js hi ky b fi lx lu l lv lw">list_data.append(data)</span></pre><h1 id="3aec" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">合并数据:</strong></h1><p id="0e26" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">类似于SQL中的连接表。</p><p id="2daf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于公共列组合不同的数据集。</p><pre class="lb lc ld le fd lo ky lp lq aw lr bi"><span id="1434" class="ls js hi ky b fi lt lu l lv lw">Merged_frame=pd.merge(left=left_dataframe,right=right_dataframe,on=None,left_on=’left_df_columnname’,right_on=’right_df_columnname’)</span></pre><p id="e525" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kz">合并类型:</em> </strong></p><p id="ca43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一对一</p><p id="05f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多对一</p><p id="1456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多对多</p><h1 id="1f0a" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">数据类型:</strong></h1><p id="86c6" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><em class="kz">命令是</em> <code class="du kv kw kx ky b">print(df.dtypes)</code></p><p id="0525" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有时我们可能想从一种类型转换到另一种类型。</p><p id="685e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">df[‘column_name’]=df[‘column_name’].astype(str)</code></p><p id="ecd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kz">分类数据:</em> </strong></p><p id="a8b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将分类数据转换为“类别”数据类型。</p><p id="ff91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它可以使数据帧在内存中变小。</p><p id="b34a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他python库可以利用它进行分析。</p><h1 id="bd83" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">清理字符串的正则表达式:</strong></h1><p id="1b3d" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><em class="kz">字符串操作:</em></p><p id="f8e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多内置和外部库。</p><p id="2b32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正则表达式的re' library。</p><p id="e069" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kz">模式匹配:</em></p><p id="a331" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kz">例子:</em></p><p id="0c54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数字-&gt;正则表达式</p><p id="10cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">17--&gt; \ d *</p><p id="952b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">$ 17--&gt; \ $ \ d *</p><p id="d2e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">$17.00 -&gt; \$\d*\。\d*</p><p id="d814" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">$ 17.89--&gt; \ $ \ d * \。\d{2}</p><h1 id="882f" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">重复数据:</strong></h1><p id="272e" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">会扭曲结果。</p><p id="1ecb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用' drop_duplicates()方法删除重复数据。</p><p id="50dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">dataframe=dataframe.drop_duplicates()</code></p><h1 id="987d" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">缺失数据:</strong></h1><p id="20a6" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">允许的操作- 1)保持原样2)删除它们3)填充缺少的值</p><p id="aa3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">删除缺少的值-在dataframe上使用dropna()方法。</p><p id="2666" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">dataframe=dataframe.dropna()</code></p><p id="6f64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">填充缺少的值-使用fillna()方法来填充值。</p><p id="02eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1)用提供的值填充</p><p id="209f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">dataframe[‘col_name’]=dataframe[‘col_name’],fillna(‘Value’)</code></p><p id="271f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2)使用汇总统计</p><p id="9564" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">mean_val=dataframe[‘col_name’].mean()</code></p><p id="7eda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kv kw kx ky b">dataframe[‘col_name’]=dataframe[‘col_name’].fillna(mean_val)</code></p><p id="869e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kz">谢谢，下篇见！！</em> </strong></p></div></div>    
</body>
</html>