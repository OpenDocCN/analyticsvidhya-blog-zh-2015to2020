<html>
<head>
<title>How to Deploy a Logistic Regression Model in GCP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在GCP部署逻辑回归模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/insiders-view-on-logistic-regression-and-how-do-we-deploy-regression-model-in-gcp-as-batch-c62a64563210?source=collection_archive---------2-----------------------#2019-08-05">https://medium.com/analytics-vidhya/insiders-view-on-logistic-regression-and-how-do-we-deploy-regression-model-in-gcp-as-batch-c62a64563210?source=collection_archive---------2-----------------------#2019-08-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="335f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">业内人士对逻辑回归的看法以及我们如何在GCP部署逻辑回归模型作为批量预测…</h2></div><p id="9391" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在过去的二十年里，机器学习已经成为信息技术的支柱之一，并随之成为我们生活中相当重要的一部分，尽管通常是隐藏的。随着越来越多的数据变得可用，有充分的理由相信智能数据分析作为技术进步的必要因素将变得更加普遍。这篇文章将深入探讨逻辑回归和大多数企业面临的一个问题:<strong class="iz hj">预测客户违约</strong>。</p><h1 id="5b56" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated"><strong class="ak">简介</strong></h1><p id="82c1" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">逻辑回归是一种回归技术，用于研究因变量为<strong class="iz hj">分类变量时，因变量与一个或多个自变量之间的关系。</strong>与所有回归分析一样，逻辑回归是一种预测分析。逻辑回归用于描述数据，并解释一个因变量与一个或多个名义变量、序数变量、区间变量或比率水平自变量之间的关系。</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kq"><img src="../Images/ea62be2495a0008b753e81392252603e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HS0bPOWIlci3z2_jogZMwg.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">s形或逻辑曲线</figcaption></figure><p id="450a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> Logistic </strong> <strong class="iz hj">回归方程</strong></p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lg"><img src="../Images/6d203f1abca11b71bcf75a1fd124d9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NdYsmT9ygeASFDo60rjmjg.png"/></div></div></figure></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><p id="d88e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">逻辑回归的类型</strong></p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lo"><img src="../Images/663e56a6ed994f5865417499dde2d437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g08eZkys_dNAAv1rB_4slA.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated"><strong class="bd jv">二元和多项式</strong></figcaption></figure><h1 id="2d1b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated"><strong class="ak">为什么是逻辑回归？</strong></h1><blockquote class="lp lq lr"><p id="0ea8" class="ix iy ls iz b ja jb ij jc jd je im jf lt jh ji jj lu jl jm jn lv jp jq jr js hb bi translated">为什么不能用OLS线性回归技术来建模一个二元因变量？</p><p id="5380" class="ix iy ls iz b ja jb ij jc jd je im jf lt jh ji jj lu jl jm jn lv jp jq jr js hb bi translated">线性概率模型定义为:</p><p id="13d8" class="ix iy ls iz b ja jb ij jc jd je im jf lt jh ji jj lu jl jm jn lv jp jq jr js hb bi translated">pi =β0 +β1Xi</p><p id="f373" class="ix iy ls iz b ja jb ij jc jd je im jf lt jh ji jj lu jl jm jn lv jp jq jr js hb bi translated">其中pi =事件发生的概率</p></blockquote><h2 id="3f3b" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">OLS线性回归不适用于二元目标的两个主要原因是:</h2><ol class=""><li id="158b" class="mk ml hi iz b ja kl jd km jg mm jk mn jo mo js mp mq mr ms bi translated"><strong class="iz hj">技术问题:违反假设<em class="ls"> — </em> </strong>线性回归模型中的二元(即二分)因变量违反以下假设:</li></ol><p id="2d17" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">—同质性</p><p id="1b9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">—误差项的正态性</p><p id="0ccc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.<strong class="iz hj">基本问题:有限概率— </strong></p><p id="9a2f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">线性概率模型由下式给出:pi = β0 +β1Xi</p><p id="b1b2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">—如果X没有上界或下界，那么对于β的任何值，都存在pi &gt; 1或pi &lt; 0</p><p id="6544" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">— This is contradictory, as the true values of probabilities should lie within the (0,1) interval</p><p id="d9aa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> <em class="ls">的X值。我们如何解决有界概率的问题？</em>T25】</strong></p><p id="a960" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 2.a)使用赔率而非事件概率— </strong>赔率定义为:</p><p id="ff88" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">赔率</strong>=<strong class="iz hj">pi/1pi</strong>=<strong class="iz hj">事件概率/非事件概率</strong></p><ul class=""><li id="c2ae" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">由于事件的概率范围从0到1，赔率范围从0到</li><li id="1e1d" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">将概率转换为赔率会移除上限</li></ul><p id="fce7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 2.b)取赔率的自然对数</strong></p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nc"><img src="../Images/3463169ba9a1ba1d4e55dd7e85908387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i24Xza8kpGbm4x4TBnxT5g.png"/></div></div></figure><h1 id="d38a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated">需要记住的一些关键要素:</h1><p id="bf21" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated"><strong class="iz hj">1)s形函数</strong></p><p id="53fe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.1)逻辑回归模型:</p><p id="06f8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">Z = log(p/1p)=β0+β1X1+β2 x2…βkXk</strong></p><p id="a343" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.2)因此，通过以下转换，从logit(“模型得分”)估计事件概率:</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nd"><img src="../Images/eb634e6f6cf2b2d53e6bc0d03a32da02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SejHY3z7LlezudaJE4ubUg.png"/></div></div></figure><p id="3d0b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 2)估计方法:MLE </strong></p><p id="3241" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.1)构造似然函数，表示所有<em class="ls"> n </em>个观测值的因变量Y的观测值的似然性</p><p id="8fb9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.2)创建对数似然函数以简化方程</p><p id="4cfc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.3)选择β值以最大化对数似然函数</p><p id="1ea2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 3)逻辑回归:一些关键假设</strong></p><p id="c88e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.1)因变量必须是分类变量(二元逻辑回归的二分变量)</p><p id="e757" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.2) P(Y=1)是事件发生的概率</p><ul class=""><li id="de84" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">因变量将被相应地编码</li><li id="ee6b" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">对于二元逻辑回归，第1类因变量应该代表期望的结果</li></ul><p id="e4a1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.3)误差项需要独立。逻辑回归要求每个观察都是独立的。</p><p id="d681" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.4)模型应该很少或没有多重共线性。</p><p id="035f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.5)逻辑回归假设独立变量和对数优势呈线性。</p><p id="abdf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.6)样本量要足够大。</p><p id="5b81" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 4)优势比</strong></p><p id="cceb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">预测值的优势比定义为结果优势增加(优势比&gt; 1)或减少(优势比&lt; 1) when the value of the predictor variable is increased by 1 unit.</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ne"><img src="../Images/8254f21e81e9ae91f5d059ca07ccb59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vKhes9OvKq3GQ6-ozBQ6rQ.png"/></div></div></figure><p id="c30c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 4.1)的相对量解释</strong></p><p id="226f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">比值比的解释取决于预测因子的类型:二元或连续</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nf"><img src="../Images/aafdec8dab1eefd4d6ce61ce059b13fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YlarHQgOOkxVKTHoNknJxQ.png"/></div></div></figure><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nf"><img src="../Images/f08233f23e8c132f98beafe8b33a731b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZOvuIMqMEu8gLw-2qcSpA.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">让步比</figcaption></figure><p id="97b2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5)模型验证的专有技术</strong></p><p id="31d6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在模型建立的过程中，建模者必须时刻关注模型如何反映系统定义。确定统计软件生成的模型(基于输入数据)在多大程度上是真实世界的准确表示的过程。</p><p id="390d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为什么需要验证？</p><p id="4b5d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5.1.1)概括</strong></p><p id="91fb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以确定来自模型的预测值是否可能准确预测未来受试者或未用于开发模型的受试者的反应。</p><p id="70e2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5.1.2)稳定性检查</strong></p><p id="415d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">测试模型在一段时间内的持续表现。</p><p id="bea0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5.1.3)鲁棒性检查</strong></p><p id="bda3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">测试该模型是否是真实世界的适当表示，以及该模型对于其预期用途是否可接受。</p><p id="9428" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5.2)模型验证的组件</strong></p><p id="2733" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5.2.1)采样策略</strong></p><ul class=""><li id="a679" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">抽样策略旨在解决使用经验数据进行测试时可能出现的不确定性。</li><li id="775a" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">示例:交叉验证、引导、样本外</li></ul><p id="69bf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5.2.2)功率测试</strong></p><ul class=""><li id="081f" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">功效测试技术旨在测量模型的拟合优度。</li><li id="f139" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">示例:分类表、K-S统计量、AUC和分类模型的索引</li></ul><p id="6cb6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 5.2.3)校准</strong></p><ul class=""><li id="7fde" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">校准技术旨在评估模型预测与实际(即观察到的)值的匹配程度。</li><li id="70dd" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">示例:分类模型的霍斯默-莱梅休检验</li></ul><h1 id="f35c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated"><strong class="ak">不同类型的验证方法</strong></h1><h2 id="e36d" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">1.分类表(混淆矩阵)</h2><ul class=""><li id="9e08" class="mk ml hi iz b ja kl jd km jg mm jk mn jo mo js mw mq mr ms bi translated">实际类别和预测类别的2x2矩阵</li><li id="ad62" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">也称为混淆矩阵或列联表</li><li id="a324" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">主对角线之和(TP + TN)越大，分类准确度越高。</li></ul><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ng"><img src="../Images/c520fcc13b556127bd0ad2d14fc4102a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U5vCqoT5eiRr3Z0awcQUFg.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">分类/混淆矩阵</figcaption></figure><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es nh"><img src="../Images/4ec2665b5b2d0754a9269374e4ebd03d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*FSC00Y-mbduB8Y7shsd3WQ.png"/></div></figure><h2 id="bbea" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">2)和谐与不和谐</h2><ul class=""><li id="e44d" class="mk ml hi iz b ja kl jd km jg mm jk mn jo mo js mw mq mr ms bi translated"><strong class="iz hj">一致:</strong>如果事件观察比非事件观察具有更高的预测事件概率，则称一对事件和非事件为一致对。</li><li id="0b18" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated"><strong class="iz hj">不协调:</strong>如果事件观察比非事件观察具有更低的预测事件概率，则一对事件和非事件被称为不协调对。</li><li id="45f4" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated"><strong class="iz hj">并列:</strong>如果事件和非事件观测值的预测事件概率完全相同，则称一对事件和非事件为并列对。</li></ul><h2 id="6628" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">3)接收机工作特性(ROC)</h2><p id="7fe5" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">ROC图是一个二维图，其中:</p><ul class=""><li id="6663" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">真阳性率绘制在Y轴上。</li><li id="1da8" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">假阳性率绘制在X轴上。</li></ul><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ni"><img src="../Images/ed9a6a7c5b726146976434b89a376d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s2Jl64GbPS5xkhpSUuppBw.png"/></div></div></figure><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es nj"><img src="../Images/44fd3c28794a4a795618eadfabe3be76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*hYjoWXIvSgxT0Ltil9KJfw.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">受试者工作特征曲线</figcaption></figure><h2 id="aab5" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">4)基尼系数</h2><p id="1a6e" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">基尼系数是衡量商品(非事件)和商品(事件)之间区别程度的一个尺度。</p><ul class=""><li id="bf04" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">基尼系数是ROC曲线和45条随机平等线之间面积的两倍</li><li id="fc2a" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">基尼系数在0和1之间变化</li></ul><p id="53d8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基尼= 0意味着没有歧视</p><p id="345a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基尼= 1意味着完全歧视</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es nk"><img src="../Images/5dba5357a2bdc43bf5619a4156eee9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*Oh-m3H6LZjiX9cTcjwpX4w.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">基尼系数</figcaption></figure><h2 id="cd7f" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">5) Kolmogorov-Smirnov统计量</h2><p id="a6cf" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">K-S统计是事件(货物)的累积上升曲线和非事件(货物)的累积上升曲线之间的最大垂直差异。</p><p id="cb7a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">KS曲线如下所示。它是通过绘制人口的累积百分比来绘制的。KS越好，模型越好。</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es nl"><img src="../Images/c40615503d01b8ce6ec3a83acaad2671.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*nQTds7bygA7N3cze9D4bfg.png"/></div></figure><p id="2d02" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">小心:</strong> — K-S基于好的和坏的分布上的单个点——累积分布最不同的点。在没有仔细查看发行版的情况下，不应该依赖它。</p><h2 id="e235" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">6)十分位数事件率图表</h2><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es nm"><img src="../Images/818a8378bc2aa3961f69a92367fa1a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*xs05ly_GDCXxSO6ysUcnQA.png"/></div></figure><p id="c9a8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">绘制了一个十分位数事件发生率图表，以衡量事件发生率等级是否有序。</p><ul class=""><li id="54d7" class="mk ml hi iz b ja jb jd je jg mt jk mu jo mv js mw mq mr ms bi translated">从十分位数1向下移动到十分位数10，目标平均值(即事件发生率)应该理想地单调下降。</li><li id="1e2a" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">从十分位数1向下移动到十分位数10，目标平均值(即事件发生率)应该理想地单调下降。</li></ul><h2 id="0837" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated">7)霍斯默-莱梅休试验</h2><ul class=""><li id="1633" class="mk ml hi iz b ja kl jd km jg mm jk mn jo mo js mw mq mr ms bi translated">Hosmer - Lemeshow检验是对二元目标变量的拟合优度检验。</li><li id="23d1" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">与许多其他拟合优度度量不同，它并不侧重于衡量模型的区分能力，而是旨在判断观察值和预测值的匹配程度。</li></ul><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nn"><img src="../Images/b09e91e0dcb2d83007f7fe08d598297e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EObdEIJszF5obDWicvUb7A.png"/></div></div></figure></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="c44e" class="jt ju hi bd jv jw no jy jz ka np kc kd io nq ip kf ir nr is kh iu ns iv kj kk bi translated"><strong class="ak">实际实施</strong></h1><p id="3809" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">到目前为止，您已经了解了业内最常见、最广泛使用的ML算法。现在，让我们将ML模型应用于银行客户的样本数据集，并在<strong class="iz hj">谷歌人工智能平台</strong>中构建一个端到端的管道。</p><h2 id="7af1" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated"><strong class="ak">用例:</strong></h2><p id="7566" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">目标是根据专门向无银行账户人群提供的信贷额度(贷款)的贷款服务来预测违约概率。预测客户是否会偿还贷款或有困难。</p><blockquote class="lp lq lr"><p id="db34" class="ix iy ls iz b ja jb ij jc jd je im jf lt jh ji jj lu jl jm jn lv jp jq jr js hb bi translated"><strong class="iz hj"> <em class="hi">围绕数据理解、清理、验证、特征工程、模型拟合的活动已分别执行。文章的这一部分更具体地针对云中的模型部署。</em>T9】</strong></p></blockquote><h2 id="8ec4" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated"><strong class="ak">关于数据:</strong></h2><ul class=""><li id="d11c" class="mk ml hi iz b ja kl jd km jg mm jk mn jo mo js mw mq mr ms bi translated"><strong class="iz hj"> SK_ID_CURR —客户ID </strong></li><li id="da68" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated"><strong class="iz hj">目标—是否支付</strong></li><li id="87d6" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated"><strong class="iz hj"> CNT_CHILDREN —子女数</strong></li><li id="05f5" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated"><strong class="iz hj">金额_收入_合计—总收入</strong></li><li id="a9ef" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated"><strong class="iz hj">金额_贷记—每月贷记金额</strong></li><li id="4d7f" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mw mq mr ms bi translated">和收入来源的其他特征。</li></ul><h2 id="d9e5" class="lw ju hi bd jv lx ly lz jz ma mb mc kd jg md me kf jk mf mg kh jo mh mi kj mj bi translated"><strong class="ak">程序:</strong></h2><ol class=""><li id="f0f3" class="mk ml hi iz b ja kl jd km jg mm jk mn jo mo js mp mq mr ms bi translated">数据清理:数据集非常整洁，几乎不需要修改。</li><li id="1ef8" class="mk ml hi iz b ja mx jd my jg mz jk na jo nb js mp mq mr ms bi translated">EDA:通过查看列名，我注意到有些列的名称非常相似，这意味着可能存在潜在的多重共线性问题。因此，我绘制了一些具有相似名称的特征图，这些图显示了彼此之间的强相关性，这表明需要进行特征选择，因为我打算使用的模型是回归。这里有一个情节:</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nt"><img src="../Images/b0172fe2969d326f3e51a7306e0fa459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJBnPWcfbRz9SpuohtmA9Q.png"/></div></div></figure><p id="eada" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.特征工程:在拟合我的模型之前，我需要做两件事:移除或合并特征，以及对我的分类特征进行标签编码。</p><p id="ca34" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.一旦模型完成了所有必要的验证，并且我们已经根据训练、测试和验证数据集检查了它的性能。现在是时候部署在<strong class="iz hj"> GCP人工智能平台作为批量预测</strong>。</p><h1 id="287b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated"><strong class="ak">程序</strong></h1><ol class=""><li id="ca6f" class="mk ml hi iz b ja kl jd km jg mm jk mn jo mo js mp mq mr ms bi translated">将数据集连同SQL脚本一起上传到GCP桶中。这个sql脚本将有助于在云Sql中创建表，云Sql充当构建模型的数据源。对新数据集的预测也将作为输出存储在云sql中。请找到下面的屏幕截图。</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nu"><img src="../Images/7ba50c76d99da01c21cdddec6857aa64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VhrSBT_Ibv5V19cyl1ZL5g.png"/></div></div></figure><p id="13e7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.一旦我们在云SQL中创建了数据库，我们的Sql脚本就会创建表。</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nv"><img src="../Images/5a976b4827aafaa316d932c17631aced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k97em0MLo-YagcPXjzrpgA.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">信用风险是我们的数据库</figcaption></figure><p id="0281" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.现在我们首先运行我们的模型开发脚本并生成一个pickle文件。即Model_development.py</p><blockquote class="lp lq lr"><p id="c892" class="ix iy ls iz b ja jb ij jc jd je im jf lt jh ji jj lu jl jm jn lv jp jq jr js hb bi translated"><strong class="iz hj">完整的脚本在</strong> GitHub <strong class="iz hj">请参考文章底部的链接。</strong></p></blockquote><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nw"><img src="../Images/37a18cd19d53dc9c54b3fc64754f8362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQjGMM2nPOnJ0U5f4QqcOQ.png"/></div></div></figure><p id="9c2a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.现在我们在AI平台生成pickle文件的镜像，创建模型版本。为此我们将使用<strong class="iz hj"> Bash命令(参考GitHub)。</strong></p><p id="c601" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在创建模型版本时，确保在GCP存储桶中指定了model.joblib文件所在的目录。</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nx"><img src="../Images/38a7b9ec975547f7cc3b8b9ba561b3c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8WqJNGpVWxRtefaJI6r0ig.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">模型(Pickle)图像已创建</figcaption></figure><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ny"><img src="../Images/844c6eeb97d68a0f60b4dad09d7fe9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tluXpmeqO3xq1QH3RolqXA.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">模型版本</figcaption></figure><p id="697d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">5.一旦我们的模型被部署并准备好使用，我们将得到下面的成功消息。</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nz"><img src="../Images/c6bb47477572bec67cb384c43c975be9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GW9WEn5u6pbEIWOQt5qQqg.png"/></div></div></figure><p id="5b48" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">6.我们的最后一步是运行部署脚本。这将摄取新数据，使用来自AI平台的模型图像进行预测，并将输出存储在云Sql中，如下所示。这就是我们如何在GCP平台内获得批量预测。</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es oa"><img src="../Images/c43d8011644b95346be8622ade838a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-MQPLI2AzfTZdbNOUda15w.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">部署脚本</figcaption></figure><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ob"><img src="../Images/c1a1ed18b96d5e50b182cc9b0a8db034.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhSjKw6KJ-EIYTFc1NWdnw.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">云控制台中的输出</figcaption></figure><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es oc"><img src="../Images/841a13f67c9592fd8afa93fede19cfb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHMuNCzD-5YL83BeCZbFdQ.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">云Sql中的示例输出</figcaption></figure><p id="d829" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们已经建立了模型，并将其部署到GCP，我们可以运行它，并保证我们的用户数据是安全的。</p><p id="9295" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请随意即兴发挥这种方法。建议总是受欢迎。</p><p id="a05f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完整代码:-<a class="ae od" href="https://github.com/himswamy/GCP_Batch_Prediction.git" rel="noopener ugc nofollow" target="_blank">https://github.com/himswamy/GCP_Batch_Prediction.git</a></p><p id="7493" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">链接到GitHub:-【https://github.com/himswamy/GCP_Batch_Prediction T2】</p><h1 id="668e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated">快乐学习！！</h1></div></div>    
</body>
</html>