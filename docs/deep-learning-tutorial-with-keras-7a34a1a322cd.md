# Keras 深度学习教程

> 原文：<https://medium.com/analytics-vidhya/deep-learning-tutorial-with-keras-7a34a1a322cd?source=collection_archive---------4----------------------->

![](img/822f414a96878e853fe6f91ddaaa97ed.png)

深度学习是一种机器学习方法，研究具有许多层的网络。在本教程中，您将使用 Keras 构建一个神经网络。

# 目标

1.  Keras 简介
2.  张量流、Keras 和 Theano 之间的关系
3.  使用 Keras 的优势以及它如何让一切变得简单
4.  用 Keras 训练神经网络

# 先决条件

在继续之前，您应该对以下技术有所了解

*   机器学习
*   计算机编程语言

# 要求

下列库是必需的，因此请确保您已经安装了它们:

*   张量流
*   克拉斯

**安装 Keras**

要安装 Keras，请使用 pip 包，如下所示:

# Keras 简介

Keras 是一个高级神经网络。它使得以快速有效的方式实现深度学习模型成为可能。Keras 中最简单的模型被称为序列模型，定义如下。

# TensorFlow，Keras，Theano。

Keras 是一个用于构建深度神经网络的高级库。当你谈到高级，它意味着简单和人类可读。你不会深入研究神经网络的所有数学概念，但你只会专注于构建深度学习网络。

Keras 利用张量流(谷歌)或 Theano 后端(蒙特利尔的 Theano)赋予它计算能力；这意味着 Keras 库可以在张量流和 Theano 框架上运行。选择使用哪种框架取决于您的喜好。然而，在本教程中，你将使用张量流作为我们的后端。

# 为什么是 Keras？

Keras 这些年来越来越受欢迎，因为它利用了张量流和 Theano。其他优势包括:

*   它利用了 python，这是非常容易学习和使用。
*   这是初学者友好的。
*   易于构建网络——与其他框架相比，您只需几行代码就可以在 Keras 中快速构建一个简单或深度的网络。
*   Keras 还提供对 GPU 和 CPU 的支持。

# 韵律学

指标是用于判断模型性能的函数。度量极大地影响深度学习算法的性能；因此，选择正确的指标以确保您的模型按预期执行是至关重要的。

Keras 中提供的一些指标包括:

*   二进制精度
*   分类准确性
*   稀疏分类准确性
*   top _ k _ categorical _ accuracy
*   sparse _ top _ k _ categorical _ accuracy
*   自定义指标

不同的模型在用不同的指标评估时会给出不同的结果。例如，只有当您的训练集具有属于每个类的相同数量的样本时，像“准确性”这样的度量才会表现得更好。

因此，仅仅用一种度量标准来真正判断你的模型是不够的。

# 训练/测试分割

训练/测试拆分是一个概念，涉及在训练集和测试集之间拆分数据，然后在训练数据上拟合模型。拟合模型以对测试数据进行预测，然后评估这些预测的技巧。

训练/测试分割主要用于避免过度拟合。

当训练模型给出的精度几乎太接近训练数据集时，就会发生过度拟合。尽管我们的目标始终是获得一个好的预测，但当它开始对新数据进行训练时，过度拟合将导致不准确的指示。

# imdb 数据集

根据该网站

“来自 IMDB 的 25，000 个电影评论的数据集，由情绪(正面/负面)标记。评论已经过预处理，每个评论都被编码成一个单词索引(整数)序列。为方便起见，单词按数据集中的总频率进行索引，例如，整数“3”编码数据中第三个最频繁出现的单词。这允许快速过滤操作，例如:“仅考虑前 10，000 个最常用的单词，但排除前 20 个最常用的单词”。

按照惯例，“0”不代表特定的单词，而是用于编码任何未知的单词。

imdb 数据集将构成我们在本教程中讨论的基础，您将使用它来构建神经网络并使用它进行预测。

## 建立并训练一个神经网络

您将执行以下操作:

*   导入 imdb 数据集。
*   准备数据集进行处理。
*   创建模型。
*   培训。
*   评价。
*   预测。

## 1.导入 imdb 数据集

继续导入数据集。

数据是预先打包的，每个整数代表字典中的一个特定单词。

https://gist.github.com/c28614e24aee74bf94ed91fc6ad58abf

然后加载评论，如下所示:

通过查看数据集的形状，可以确认每组数据集包含 25，000 条电影评论。

Keras 要求所有评论长度相同，所以你需要让它们长度相同。在这种情况下，您可以选择最长的评论作为默认长度，也可以选择标准长度。这意味着比标准长度更长的评论将被截断。

您将使用标准长度 100:

让我们通过将结果打印到控制台来查看填充的结果:

如您所见，数组长度相等。

## 2.创建模型。

现在数据已经准备好了，您可以继续构建我们的模型了。模型是 Keras 的核心数据结构，也是 Keras 中各层的组织方式。最简单的模型类型是顺序模型，其定义如下:

## 3.添加层

神经网络主要包括三种类型的层，即输入层、隐藏层和输出层。输入层用于向网络提供原始数据，然后将数据传递给隐藏层进行处理。

隐藏层将通过学习数据的不同方面来处理数据。当处理数据时，数据可以被分解成更小的单元，以便像人脑那样更容易处理数据的不同组成部分。输出图层是您获得结果的地方。

有不同类型的层，最常用的层有:

*   致密层
*   循环层
*   标准化图层
*   卷积层
*   其他人

不同的层对数据执行不同的转换，有些层比其他层更适合某些任务。例如，卷积层最适合包含图像的数据，而嵌入层最适合包含文本的数据。

让我们开始堆积层。

第一层将是嵌入层，它将每个单词转换为单词向量。

接下来，添加在***keras . layers . lstm***中找到的 LSTM 图层。首选 LSTM 图层，因为它们可以了解数据的长期相关性，从而做出准确的预测。LSTM 将把向量序列转换成单个向量。

让我们继续添加 LSTM 层。

最后，您将从 keras.layers.Dense 添加一个简单的密集图层。密集图层是一种将图层中的每个输入连接到每个输出的图层。

## 4.编译模型

在编译模型时，您必须定义一些决定模型性能的指标。这里，您将损失(成本函数)设置为 binary_crossentrophy，将度量设置为 accuracy。这意味着最大限度地提高算法的准确性。

## 5.培养

现在您已经准备好训练模型了。在模型上调用 fit 函数并传递附加参数，即

*   **纪元** —代表你在训练集中完成的循环次数。
*   **batch _ size**-表示在网络学习过程中用于训练网络的训练样本的大小。

结果如下所示。模型执行准确率 83%，损耗 0.4，这是好事。

模型精度

# 结论

如您所见，Keras 提供了一种简单有效的方法来构建神经网络，而没有其他低级库带来的所有瓶颈。