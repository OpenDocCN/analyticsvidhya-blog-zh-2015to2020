<html>
<head>
<title>Generating a labeled data-set of images from a video for Convolutional Neural Networks Part 2 : Automated Labeling using SIFT-OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为卷积神经网络从视频生成图像的标记数据集第2部分:使用SIFT-OpenCV的自动标记</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/generating-a-labeled-data-set-of-images-from-a-video-for-convolutional-neural-networks-part-2-859cc4337568?source=collection_archive---------27-----------------------#2020-05-11">https://medium.com/analytics-vidhya/generating-a-labeled-data-set-of-images-from-a-video-for-convolutional-neural-networks-part-2-859cc4337568?source=collection_archive---------27-----------------------#2020-05-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e4d02c24f45ad188f4f70003efd5335a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cb1HvpKrq8YaSdmLxGJ5lA.png"/></div></div></figure><h1 id="7391" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="9669" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在我之前的帖子中，我们看到了如何使用ffmpeg裁剪视频并从中提取图像，然后手动添加标签。然而，有时没有足够的时间来手动检查和标记所有生成的图像，或者甚至在第一时间等待从视频生成图像。</p><p id="a186" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果我们愿意为我们的模型牺牲一些精度点，我们可以使用OpenCV库中的尺度不变特征变换(SIFT)算法来自动化整个数据生成过程。SIFT所做的是，它获取应该在图像中找到的对象的模板，并扫描给定的图像，以便定位该对象的位置。</p><p id="bdf3" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">SIFT是一种机器学习算法，工作起来可能会很慢。然而，它在从视频或图像中检测相对静态或轻微变形的对象时非常精确。在本教程中，我们将看到如何使用SIFT为我们的学习模型生成数据集。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="dbb7" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">到代码上</h1><p id="6229" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我假设您已经下载了Anaconda并安装了OpenCV，因为在这里我们将直接进入代码。我会给你一步一步的方法解释每个代码片段做什么。</p><p id="2320" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">首先，我们导入必要的包。请使用OpenCV的3.4.2.16版本，以便给定的模板匹配代码正常工作，因为无论出于什么原因，我们代码的某些元素在这个版本之后的版本中不受支持。</p><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="17b2" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，我们将输入模板图像并初始化SIFT。这是我们将要使用的模板图像。警告:这是游戏《辐射4》中的怪物。不要惊慌。还有，强烈推荐游戏！</p><figure class="ld le lf lg fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/903d843631f23afc166ab43cdd7270d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*tnmTu7qrzfhKg3QmTmcxRw.jpeg"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">我们漂亮的模板</figcaption></figure><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="e139" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在，我们已经加载了模板图像，可以开始使用了。接下来，我们加载我们的视频，我们想要逐帧扫描来寻找模板。如果需要的话，我们还可以获得视频的外观尺寸以备将来使用。</p><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="89f4" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在我们要定义一个函数来完成整个模板匹配。本质上，我们将使用一种叫做“特征匹配和单应性”的东西来检查模板图像中值得注意的特征，并试图找到这些特征在视频帧中出现的位置。</p><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="5c82" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我对《辐射4》游戏视频片段执行了这段代码，它生成了一组图像。这是其中一个的样子。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/74b288e9c3584823012680e8bc66b223.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jYUZSNKTy2CoPe1MEST3_w.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">检测到模板</figcaption></figure><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/5b0752a05775098ee07577a53ce483c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AgM7gJN5Cfrz-4E6zmaWQw.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">一系列生成的图像</figcaption></figure><p id="c893" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在我们已经有了模板匹配，我们可以开始生成标签了。在大多数情况下，标签需要图像中检测矩形的(左上x，左上y)和(右下x，右下y)坐标。这最终是SIFT算法的主要目的——让我们知道找到模板匹配的图像区域的坐标。</p><p id="1620" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在剩下的就是编写代码，将坐标写入与相应图像同名的文本文件。</p><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="988a" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这里是所有相应的生成标签:-</p><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/94370f3e2cb645e5a4d2d5986ea27efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLZS1s6-tIyCMB6D0CAxtQ.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">图像和标签</figcaption></figure><p id="c308" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">每个标签文件都有这样的内容:-</p><figure class="ld le lf lg fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/814fd8bcf223329e5396951e5a9d79bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*mR_Ks4uPJm2xKFfNolpKPQ.jpeg"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">一个生成的标签</figcaption></figure><p id="b340" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在你知道了！一个完全自动化的方法来生成图像和标签，同时输入到您的CNN。</p></div></div>    
</body>
</html>