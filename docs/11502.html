<html>
<head>
<title>Upper Confidence Bound for Multi-Armed Bandits Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多武装匪徒问题的置信上限</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/upper-confidence-bound-for-multi-armed-bandits-problem-ea5d7bc840ff?source=collection_archive---------11-----------------------#2020-12-06">https://medium.com/analytics-vidhya/upper-confidence-bound-for-multi-armed-bandits-problem-ea5d7bc840ff?source=collection_archive---------11-----------------------#2020-12-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/f89e6edf9a0f46c7f12a21d4d86e088a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BTe9MZkFPaqXcumERMqsQw.jpeg"/></div></div></figure><div class=""/><p id="f637" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文将讨论置信上限及其算法步骤。</p><p id="5129" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们在<a class="ae jo" rel="noopener" href="/analytics-vidhya/the-multi-armed-bandit-problem-in-reinforcement-learning-cf46adc6d269">多股武装匪徒问题</a>文章中看到的，我们有 5 个或更多的老虎机，我们以这样一种方式下注，使我们的利润最大化。</p><p id="844c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每台机器都有自己的分配，你的利润是根据它来决定的。我们以平衡的方式结合使用勘探和开采技术，以增加我们的利润。我们不能只有探索或剥削，因为它们可能不会给我们提供解决问题的最佳方案。</p><blockquote class="jp jq jr"><p id="efba" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated"><strong class="is hu"> <em class="ht">置信上限<br/> </em> </strong> UCB 是一种用于强化学习的确定性算法，该算法基于算法在每轮探索中分配给每台机器的置信边界，专注于探索和利用。当一台机器比其他机器使用得更多时，这些边界会减小。</p></blockquote><p id="ecf8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">置信上限遵循的步骤</strong></p><ol class=""><li id="35c1" class="jw jx ht is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated"><em class="js">在每一轮</em> <strong class="is hu"> <em class="js"> n </em> </strong> <em class="js">中，我们考虑机器 m 的两个数字。<br/> - &gt; </em> Nₘ(n) =机器 m 被选择到第 n 轮的次数。<br/> - &gt; Rₘ(n) =机器 m 到第 n 轮的奖励次数</li><li id="bd9b" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn kb kc kd ke bi translated"><em class="js">从这两个数字我们要计算，<br/> a. </em>机器的平均报酬 m 到回合 n，rₘ(n) = Rₘ(n) / Nₘ(n).<br/> <em class="js"> b. </em>置信区间[rₘ(n)—δₘ(n)，rₘ(n)+δₘ(n)]在第 n 轮用，δₘ(n)= sqrt(1.5 * log(n)/nₘ(n))</li><li id="a171" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn kb kc kd ke bi translated"><em class="js">我们选择具有最大 UCB 的机器</em> <strong class="is hu"> <em class="js"> m </em> </strong> <em class="js">，</em>(<em class="js"/>【rₘ(n)+δₘ(n))</li></ol><p id="e718" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我知道这非常数学化，但是让我们通过例子来理解它:</p><p id="a5cb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设您有 5 台老虎机，每台机器都有一定数量的相关分发。如果任何人事先知道这些分配，就可以很容易地使利润最大化。假设我们知道所有这些机器的先验分布，例如机器 M1 的分布是 D1，M2 的分布是 D2，M3 的分布是 D3，M4 的分布是 D4，M5 的分布是 D5。</p><figure class="kl km kn ko fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/62602e231f99e1de504efead176168e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-AzTfhIGQarUR8CvTZrWEQ.png"/></div></div></figure><p id="0b33" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以清楚地看到，机器 3 具有最高的分布。但是在现实生活中，你不会事先知道分布，所以我们假设所有机器的分布都是相同的。</p><figure class="kl km kn ko fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/bee5d431dc825e9aa016eeeebbcbf70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWGus010vX4tysH8R6CZ6A.png"/></div></div></figure><p id="90e2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">算法中的公式创建了一个置信界限，并假设该置信界限包含实际分布。</p><figure class="kl km kn ko fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/e16821ca926a39b58a325eaa57abc8d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*klD_2uX35wrHPonZOfvOzw.png"/></div></div></figure><p id="eaba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些置信界限在上图中表示为矩形。现在，它们都有相同的置信界限，所以我们选择分布为 1 的机器 1。现在，在应用 UCB 算法后的第一轮中，它的置信界限变得稍微更低。</p><figure class="kl km kn ko fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/5bba3b2f68f9619f1645eb2e292d951c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nG5IPgixfLWbmO-8vJL7vg.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">在将 UCB 应用于 D1 之后</figcaption></figure><p id="2a3d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们将再次遍历所有的机器，并找出哪一个具有更高的置信界限。除了 D1，其他所有分布都有相同的置信区间，并且都大于 D1。因此，在这种情况下，我们可以选择除 M1 以外的任何机器。这就是这个算法的妙处。即使其中一台机器的性能优于其他机器，算法也不会只利用那台机器。它也提供了探索其他机器的机会。</p><p id="f179" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设在第二轮你得到了这样的置信区间，</p><figure class="kl km kn ko fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/701f646e38c652ecae96feae646e5c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMWbWCp9H12vvPwisN9OYg.png"/></div></div></figure><p id="4837" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第五轮之后，假设置信界限是这样的，</p><figure class="kl km kn ko fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/00045dc90f7238d902a5aa5519216da2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDjTScH7VhnM6A7yhVkk_w.png"/></div></div></figure><p id="b1e0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在每一轮之后，被选择的机器的置信界限将缩短，从而避免偏向一台机器，从而给其他机器机会。最后，能够给出更大利润的机器(在这种情况下是机器 3)将总是比其他机器具有更高的置信界限，从而利用它来获得最大回报。</p><figure class="kl km kn ko fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/e3c5bf1fc492eb933a18f4537516a606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBvGH55ws459OP9I4uPSUg.png"/></div></div></figure><p id="c9f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是置信上限算法的工作原理。它开始探索所有具有最高置信度的机器，从而在一些探索之后找到最好的机器，然后开始收获利益以使利润最大化。</p><p id="d798" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="js">参考文献:</em></p><ol class=""><li id="8d3f" class="jw jx ht is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated"><a class="ae jo" href="https://www.udemy.com/course/machinelearning/learn/lecture/6456832#questions" rel="noopener ugc nofollow" target="_blank">https://www . udemy . com/course/machine learning/learn/lecture/6456832 #问题</a></li><li id="c42a" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn kb kc kd ke bi translated"><a class="ae jo" href="https://analyticsindiamag.com/reinforcement-learning-the-concept-behind-ucb-explained-with-code/" rel="noopener ugc nofollow" target="_blank">https://analyticsindiamag . com/reinforcement-learning-the-concept-behind-UCB-explained-with-code/</a></li></ol></div></div>    
</body>
</html>