<html>
<head>
<title>A walk through python List Comprehension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">python列表理解概述</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-walk-through-python-list-comprehension-845f02f95436?source=collection_archive---------1-----------------------#2019-05-13">https://medium.com/analytics-vidhya/a-walk-through-python-list-comprehension-845f02f95436?source=collection_archive---------1-----------------------#2019-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a217" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">创建列表的简洁方法</strong></h2></div><p id="8b7d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">列表理解允许从另一个序列或iterable创建一个新的列表。</p><p id="1fcc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Python中的列表理解构造如下:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="c9b7" class="kc kd hi jy b fi ke kf l kg kh">list_variable = [x for x in iterable one_or_more_condition]</span></pre><p id="ad31" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">列表理解由以下部分组成:</p><ul class=""><li id="2758" class="ki kj hi iz b ja jb jd je jg kk jk kl jo km js kn ko kp kq bi translated">一个输入序列。</li><li id="4e51" class="ki kj hi iz b ja kr jd ks jg kt jk ku jo kv js kn ko kp kq bi translated">代表输入序列成员的变量。</li><li id="6679" class="ki kj hi iz b ja kr jd ks jg kt jk ku jo kv js kn ko kp kq bi translated">可选的谓词表达式。</li><li id="3d6c" class="ki kj hi iz b ja kr jd ks jg kt jk ku jo kv js kn ko kp kq bi translated">从满足谓词的输入序列成员中产生输出列表元素的输出表达式。</li></ul><p id="44b5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设，我们需要找到一个给定列表的所有<code class="du kw kx ky jy b">even</code>整数的平方。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="bb7d" class="kc kd hi jy b fi ke kf l kg kh">a_list = [1, 4, 6, 5]</span><span id="e745" class="kc kd hi jy b fi kz kf l kg kh">squared_list = [ i**2 for i in a_list if i%2 == 0 ]</span><span id="c53a" class="kc kd hi jy b fi kz kf l kg kh">print(squared_list)<br/>output: [16, 36]</span></pre><p id="db0c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，方括号表示输出是一个<strong class="iz hj"> <em class="la">列表。</em>T12】</strong></p><figure class="jt ju jv jw fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es et"><img src="../Images/c34c7d9a2cabdacb87b4b327e6318d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jTumdE1G0CSvX1kOu8ygJg.png"/></div></div></figure><ul class=""><li id="5e56" class="ki kj hi iz b ja jb jd je jg kk jk kl jo km js kn ko kp kq bi translated">迭代器部分遍历输入序列<strong class="iz hj"> a_list </strong>的每个成员<strong class="iz hj"> i </strong>。</li><li id="9551" class="ki kj hi iz b ja kr jd ks jg kt jk ku jo kv js kn ko kp kq bi translated">谓词检查成员是否是一个<code class="du kw kx ky jy b">even</code>数字。</li><li id="e91c" class="ki kj hi iz b ja kr jd ks jg kt jk ku jo kv js kn ko kp kq bi translated">如果成员是一个<code class="du kw kx ky jy b">even</code>数，那么它被传递到输出表达式，平方，成为输出列表的成员。</li></ul><p id="4712" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用<code class="du kw kx ky jy b">for</code>循环可以获得相同的结果</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="2dbe" class="kc kd hi jy b fi ke kf l kg kh">a_list = [1,4,6,5]<br/>output_list<!-- --> = []</span><span id="21c7" class="kc kd hi jy b fi kz kf l kg kh">for i in a_list:<br/>    if i%2 ==0:<br/>        output_list.append(i**2)<br/>print("Output List using for loop:", output_list)</span><span id="5b2b" class="kc kd hi jy b fi kz kf l kg kh">output: [16, 36]</span></pre></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><blockquote class="lp"><p id="156f" class="lq lr hi bd ls lt lu lv lw lx ly js dx translated"><strong class="ak">从循环到理解</strong></p></blockquote><p id="4885" class="pw-post-body-paragraph ix iy hi iz b ja lz ij jc jd ma im jf jg mb ji jj jk mc jm jn jo md jq jr js hb bi translated"><strong class="iz hj">每一个列表理解都可以重写为一个</strong> <code class="du kw kx ky jy b"><strong class="iz hj">for</strong></code> <strong class="iz hj">循环，但不是每一个</strong> <code class="du kw kx ky jy b"><strong class="iz hj">for</strong></code> <strong class="iz hj">循环都可以重写为一个列表理解。</strong></p><p id="0536" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来源<a class="ae me" href="https://treyhunner.com/2015/12/python-list-comprehensions-now-in-color/" rel="noopener ugc nofollow" target="_blank">https://trey hunner . com/2015/12/python-list-comprehensions-now-in-color/</a></p><p id="9771" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">使用</strong> <code class="du kw kx ky jy b"><strong class="iz hj">for</strong></code> <strong class="iz hj">循环从两个列表中找出公共数字:</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="4c24" class="kc kd hi jy b fi ke kf l kg kh">first_list = [1, 2, 7, 0]<br/>second_list = [2, 3, 4, 5]</span><span id="abae" class="kc kd hi jy b fi kz kf l kg kh">common_numbers=[]<br/>for i in first_list:<br/>    for j in second_list:<br/>        if i == j:<br/>            common_numbers.append(i)<br/>print(common_numbers)</span><span id="075d" class="kc kd hi jy b fi kz kf l kg kh">output: [2]</span></pre><p id="70fd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">使用列表理解从两个列表中找出公共数字</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9892" class="kc kd hi jy b fi ke kf l kg kh">first_list = [1, 2, 7, 0]<br/>second_list = [2, 3, 4, 5]</span><span id="b8da" class="kc kd hi jy b fi kz kf l kg kh">common_numbers = [i for i in first_list for j in second_list if i==j]</span><span id="3e33" class="kc kd hi jy b fi kz kf l kg kh">print(common_numbers)</span><span id="b7c8" class="kc kd hi jy b fi kz kf l kg kh">output: [2]</span></pre></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><blockquote class="lp"><p id="4a17" class="lq lr hi bd ls lt lu lv lw lx ly js dx translated"><strong class="ak">使用列表理解操作字符串</strong></p></blockquote><p id="826c" class="pw-post-body-paragraph ix iy hi iz b ja lz ij jc jd ma im jf jg mb ji jj jk mc jm jn jo md jq jr js hb bi translated">列表理解也可以用于迭代字符串:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9169" class="kc kd hi jy b fi ke kf l kg kh">new_string = "Hello World In Python"<br/><br/>lower_case_string = [i.lower() for i in new_string.split(' ')]</span><span id="b058" class="kc kd hi jy b fi kz kf l kg kh">print(lower_case_string)</span><span id="3535" class="kc kd hi jy b fi kz kf l kg kh">output: ['hello', 'world', 'in', 'python']</span></pre><p id="b5a2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">使用列表理解从字符串中提取所有数字:</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="94c2" class="kc kd hi jy b fi ke kf l kg kh">my_string = "Hello 12345 Python"<br/>numbers = [x for x in my_string if x.isdigit()]<br/>print(numbers)</span><span id="c3cf" class="kc kd hi jy b fi kz kf l kg kh">output = ['1', '2', '3', '4', '5']</span></pre></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><blockquote class="lp"><p id="8b09" class="lq lr hi bd ls lt lu lv lw lx ly js dx translated">嵌套列表理解</p></blockquote><p id="80c5" class="pw-post-body-paragraph ix iy hi iz b ja lz ij jc jd ma im jf jg mb ji jj jk mc jm jn jo md jq jr js hb bi translated">除了条件句，你还可以通过将它们嵌套在其他列表理解中来调整你的列表理解。当你想处理列表时，这是很有用的:生成列表列表，置换列表列表或将列表列表展平为常规列表。</p><p id="922a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">使用列表理解生成列表列表:</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="774f" class="kc kd hi jy b fi ke kf l kg kh">new_list = [2, 5, 3]</span><span id="098b" class="kc kd hi jy b fi kz kf l kg kh">squared_list = [(i, i**2) for i in new_list]<br/>print(squared_list)</span><span id="d09c" class="kc kd hi jy b fi kz kf l kg kh">output: [(2, 4), (5, 25), (3, 9)]</span></pre><p id="603a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们使用<code class="du kw kx ky jy b">new_list</code> <em class="la"> </em>创建<code class="du kw kx ky jy b">squared_list</code> <em class="la"> </em>，这是一个Python中的列表的<em class="la">列表，包含来自<code class="du kw kx ky jy b">new_list</code>的数字的方块和自身</em></p><p id="7a71" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">再比如:</strong></p><p id="052b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">展平</strong>一个矩阵:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="47f0" class="kc kd hi jy b fi ke kf l kg kh">list_of_list = [[1,2,3],[4,5,6],[7,8]]</span><span id="ac61" class="kc kd hi jy b fi kz kf l kg kh">flatten_list_of_list = [j for i in list_of_list for j in i]</span><span id="b990" class="kc kd hi jy b fi kz kf l kg kh">print(flatten_list_of_list)</span><span id="72cf" class="kc kd hi jy b fi kz kf l kg kh">output: [1, 2, 3, 4, 5, 6, 7, 8]</span></pre><p id="beb3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里实际发生的是，您获取<code class="du kw kx ky jy b">list_of_list</code>中嵌套列表(<code class="du kw kx ky jy b">i</code>)的列表元素(<code class="du kw kx ky jy b">j</code>，并返回包含在<code class="du kw kx ky jy b">i</code>中的列表元素<code class="du kw kx ky jy b">j</code>的列表。</p><p id="ed23" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您会发现嵌套列表理解示例中使用的大多数关键字和元素与简单列表理解示例中使用的相似:</p><ul class=""><li id="18ef" class="ki kj hi iz b ja jb jd je jg kk jk kl jo km js kn ko kp kq bi translated">方括号</li><li id="a2a8" class="ki kj hi iz b ja kr jd ks jg kt jk ku jo kv js kn ko kp kq bi translated">两个<code class="du kw kx ky jy b">for</code>关键字，后跟一个变量，该变量表示列表列表的一个项目(<code class="du kw kx ky jy b">i</code>)和嵌套列表的一个列表项目(<code class="du kw kx ky jy b">j</code>)；和</li><li id="ca0e" class="ki kj hi iz b ja kr jd ks jg kt jk ku jo kv js kn ko kp kq bi translated">两个<code class="du kw kx ky jy b">in</code>关键字，后跟一个列表列表(<code class="du kw kx ky jy b">list_of_list</code>)和一个列表项(<code class="du kw kx ky jy b">i</code>)。</li></ul><p id="26f6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们考虑另一个<strong class="iz hj">转置</strong>矩阵的例子:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="7b70" class="kc kd hi jy b fi ke kf l kg kh">matrix = [[1,2,3],[4,5,6],[7,8,9]]</span><span id="1018" class="kc kd hi jy b fi kz kf l kg kh">transposed_matrix = [[row[i] for row in matrix] for i in range(3)]</span><span id="0bdd" class="kc kd hi jy b fi kz kf l kg kh">print(transposed_matrix)</span><span id="48ad" class="kc kd hi jy b fi kz kf l kg kh">output: [[1, 4, 7], [2, 5, 8], [3, 6, 9]]</span></pre><blockquote class="mf mg mh"><p id="41c0" class="ix iy la iz b ja jb ij jc jd je im jf mi jh ji jj mj jl jm jn mk jp jq jr js hb bi translated"><strong class="iz hj">注:</strong>一个矩阵的<strong class="iz hj">转置</strong>是一个新矩阵，它的行是原矩阵的列。这使得新矩阵的列成为原始矩阵的行。</p></blockquote><p id="f500" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在使用嵌套的for循环重写代码:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6670" class="kc kd hi jy b fi ke kf l kg kh">matrix = [[1,2,3],[4,5,6],[7,8,9]]</span><span id="3d41" class="kc kd hi jy b fi kz kf l kg kh">transposed_matrix = []<br/>transposed_row = []</span><span id="30fa" class="kc kd hi jy b fi kz kf l kg kh">for i in range(3):<br/>    for row in matrix:<br/>        transposed_row.append(row[i])<br/>    transposed_matrix.append(transposed_row)</span><span id="9395" class="kc kd hi jy b fi kz kf l kg kh">output: [[1, 4, 7], [2, 5, 8], [3, 6, 9]]</span></pre><p id="d28b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当你需要创建一个实际上是一个矩阵的列表时，你也可以使用嵌套列表理解。看看下面的例子:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="51a5" class="kc kd hi jy b fi ke kf l kg kh">matrix = [[0 for col in range(4)] for row in range(3)]</span><span id="c388" class="kc kd hi jy b fi kz kf l kg kh">print(matrix)</span><span id="ee7f" class="kc kd hi jy b fi kz kf l kg kh">output: [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]</span></pre><p id="6b6c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将上面的代码块重写为嵌套的for循环:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="66c7" class="kc kd hi jy b fi ke kf l kg kh">matrix=[]</span><span id="2170" class="kc kd hi jy b fi kz kf l kg kh">for x in range(3):<br/>    nested = []<br/>    matrix.append(nested)<br/>    for row in range(4):<br/>        nested.append(0)<br/>print(matrix)</span><span id="8968" class="kc kd hi jy b fi kz kf l kg kh">output: [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]</span></pre><p id="c8a4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">单位矩阵</strong></p><p id="a0c0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大小为n的单位矩阵是一个n乘n的方阵，主对角线上有1，其他地方有0。一个3乘3的单位矩阵是:</p><p id="7b60" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[ [ 1，0，0 ]，T32，[ 0，1，0 ]，T33，[ 0，0，1 ] ]</p><p id="464f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上述矩阵可以通过以下理解生成:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="bfcc" class="kc kd hi jy b fi ke kf l kg kh">identity_matrix = [[ 1 if item_idx == row_idx else 0 for item_idx in range(0, 3) ] for row_idx in range(0, 3) ]</span><span id="fd3b" class="kc kd hi jy b fi kz kf l kg kh">print(identity_matrix)<br/>output: [1, 0, 0], [0, 1, 0], [0, 0, 1]]</span></pre></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><p id="e2ff" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！</p></div></div>    
</body>
</html>