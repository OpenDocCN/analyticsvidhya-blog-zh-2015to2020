<html>
<head>
<title>SQL Join | Inner | Left | Right | Outer | Self | Cross Join 2019 — Sagar Jaybhay</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL Join | Inner | Left | Right | Outer | Self | Cross Join 2019—Sagar Jaybhay</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sql-join-inner-left-right-outer-self-cross-join-2019-sagar-jaybhay-c7b1214fcf70?source=collection_archive---------8-----------------------#2019-12-09">https://medium.com/analytics-vidhya/sql-join-inner-left-right-outer-self-cross-join-2019-sagar-jaybhay-c7b1214fcf70?source=collection_archive---------8-----------------------#2019-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0738" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Join语句用于组合来自多个<a class="ae jd" href="https://sagarjaybhay.com/about-tables-in-database-by-sagar-jaybhay/" rel="noopener ugc nofollow" target="_blank">表</a>的数据或行，这些数据或行基于它们之间的公共字段。一般来说，2个<a class="ae jd" href="https://sagarjaybhay.com/about-tables-in-database-by-sagar-jaybhay/" rel="noopener ugc nofollow" target="_blank">表</a>通过使用外键约束相互关联。</p><p id="6766" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">有不同类型的连接</strong> <a class="ae jd" href="https://docs.microsoft.com/en-us/sql/relational-databases/performance/joins" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">在此外连接分为3个子连接</strong>。</a></p><ol class=""><li id="cf31" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">左连接或左外连接</li><li id="a9f8" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">右外部联接或右联接</li><li id="39ed" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">完全联接或完全外部联接。</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/18a0d3a9dfef8ca7614f105825d89134.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtGoNw-2YqVxDmzJQNZmvQ.png"/></div></div></figure><p id="515f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如下图所示，我们使用这两个表作为连接示例。在这两个表中，我们有<strong class="ih hj"> departmentid </strong>是公共字段或列。</p><h1 id="ff71" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">内部连接</h1><p id="91c8" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">Inner Join将只返回两个表中匹配的行，其中一个条件是匹配的，不匹配的行将被删除。返回在两个表中都有匹配值的记录。仅选择两个表之间匹配的行。</p><p id="290a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">通用语法</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="6b6b" class="lm kf hi li b fi ln lo l lp lq">SELECT table1.column1,table1.column2,table2.column1,.... FROM table1 INNER JOIN table2 ON table1.matching_column = table2.matching_column;</span></pre><p id="b760" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际查询</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="a1d2" class="lm kf hi li b fi ln lo l lp lq">select * from Employee inner join Department on Employee.DepartmentID=Department.DepartmentID;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lr"><img src="../Images/422be3dc5e3b0486fd89d2f30a22213f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*npXXXeKQsFdtYUM4icDfug.png"/></div></div></figure><p id="7116" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果id不在department表中，或者反之亦然，则这些行不会填充到内部连接查询的结果中。</p><p id="ac4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">内部连接的最终含义只是给出这两个表之间的匹配行。</strong></p><h1 id="4574" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">左外部联接或左联接</h1><p id="42a7" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">左连接返回左表中所有匹配的行+不匹配的行。在右侧没有匹配行的行中，结果集将包含null。左连接也称为左外连接。</p><p id="347c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，我们得到一个完整的左表，只有右表中的匹配行。</p><p id="3a0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">左连接的一般语法:</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="a4fa" class="lm kf hi li b fi ln lo l lp lq">SELECT table1.column1,table1.column2,table2.column1,.... FROM table1 LEFT JOIN table2 ON table1.matching_column = table2.matching_column;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ls"><img src="../Images/ee549bf66dfa7e0b9e317a9cf6345058.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*8Q_Nn2HEM03ShsxWJ6-1SQ.png"/></div></figure><p id="3fb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际查询</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="20d2" class="lm kf hi li b fi ln lo l lp lq">select * from Employee as e left join Department on e.DepartmentID=Department.DepartmentID;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lt"><img src="../Images/104b7b3cbe795a31bad7334c5aaa319e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XoFCE7fJdRndqgCOENXbOw.png"/></div></div></figure><h1 id="4019" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">右外部联接或右联接:</h1><p id="6eda" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">右连接返回右表中所有的<strong class="ih hj">匹配行+不匹配行</strong></p><p id="41bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">通用语法:</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="2cfd" class="lm kf hi li b fi ln lo l lp lq">SELECT table1.column1,table1.column2,table2.column1,.... FROM table1 RIGHT JOIN table2 ON table1.matching_column = table2.matching_column;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lu"><img src="../Images/b7d03148a9e16f1d68aed1c8d1496863.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*7eK_WAV6Jg4iNxlBlU0CYQ.png"/></div></figure><p id="8f5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">右连接也称为右外连接。左侧没有匹配行的行，结果集将包含null。</p><p id="d993" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际查询</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="64a2" class="lm kf hi li b fi ln lo l lp lq">select * from Employee as e right join Department on e.DepartmentID=Department.DepartmentID order by Department.DepartmentID desc;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lv"><img src="../Images/67aaff3e4d9584e149f5e96366d0b7db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRSSwM-gzktc83NhvXb1nw.png"/></div></div></figure><h1 id="ce8a" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">完全外部连接或完全连接</h1><p id="f419" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">完全连接返回左表和右表中的所有行，还包括不匹配的行。完全连接通过结合左连接和右连接来创建结果集。没有找到匹配行的行将给出空值。</p><p id="b24e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">通用语法</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="351c" class="lm kf hi li b fi ln lo l lp lq">SELECT table1.column1,table1.column2,table2.column1,.... FROM table1 FULL JOIN table2 ON table1.matching_column = table2.matching_column;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lu"><img src="../Images/918801b66a429b7597da8c90fb0507ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*QjpooP984YMUkYfnARkPIA.png"/></div></figure><p id="be01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际查询</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="3bb0" class="lm kf hi li b fi ln lo l lp lq">select * from Employee as e full join Department on e.DepartmentID=Department.DepartmentID order by Department.DepartmentID desc;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lw"><img src="../Images/cb1b5d61563c5c0430e666aecac21845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-cM7kJvtEcIEYWGwpj0yFQ.png"/></div></div></figure><h1 id="3909" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">交叉连接</h1><p id="a649" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">它产生两个表的笛卡尔积，这涉及到连接。在上面的例子中，我们有雇员表和部门表，雇员表中有1001行，部门表中有11行，那么这个连接的输出包含</p><p id="047b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">11011行。</p><p id="fe93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，如果您使用on语法手段条件，它将抛出一个错误。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lx"><img src="../Images/b83f43582697c19ea983c28c59e60a95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*oN5_xv8xbVlF75mlTWMlSQ.png"/></div></figure><h1 id="4922" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">自连接</h1><p id="de02" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">join表示一个表连接到它自己，这叫做自连接。这对于查询分层数据或比较同一表中的行非常有用。自联接不是任何不同类型的联接。大多数情况下，当表有一个外键引用它自己的主键时。</p><p id="4a76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自联接可以使用内部联接或左联接。当您为自连接编写查询时，请记住为表编写别名，否则将会引发错误。</p><p id="63fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于创建表的Create table语句。</p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="7a9d" class="lm kf hi li b fi ln lo l lp lq">create table selfjoin (empid int,name varchar(300),managerid int)</span></pre><p id="1fa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建表格后，我们可以向该表格添加行</p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="361d" class="lm kf hi li b fi ln lo l lp lq">insert into selfjoin values (1,'sagar',3); insert into selfjoin values (2,'ram',1); insert into selfjoin values (3,'ravi',3); insert into selfjoin values (4,'sham',1); insert into selfjoin values (5,'naga',6); insert into selfjoin values (6,'saga',5);</span></pre><p id="c2e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">通用语法</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="ca2e" class="lm kf hi li b fi ln lo l lp lq">SELECT column_name(s) FROM table1 T1, table1 T2 WHERE condition;</span></pre><p id="c1c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，我们需要找出谁是谁的经理。</p><p id="2dc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际查询</strong></p><pre class="jt ju jv jw fd lh li lj lk aw ll bi"><span id="0847" class="lm kf hi li b fi ln lo l lp lq">select a.name,b.name from selfjoin as a inner join selfjoin as b on a.managerid=b.empid</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ly"><img src="../Images/a997517c24bfb48bea909e8617a6f970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HTVbbIusrekNHUc21t3ybA.png"/></div></div></figure></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><p id="3bf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mg">原载于2019年12月9日</em><a class="ae jd" href="https://sagarjaybhay.com/sql-join-inner-left-right-outer-self-join-2019/" rel="noopener ugc nofollow" target="_blank"><em class="mg">https://sagarjaybhay.com</em></a><em class="mg">。</em></p></div></div>    
</body>
</html>