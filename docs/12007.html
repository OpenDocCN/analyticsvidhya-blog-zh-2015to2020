<html>
<head>
<title>Bitcoin Price Prediction with Random Forest and Technical Indicators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机森林和技术指标的比特币价格预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bitcoin-price-prediction-with-random-forest-and-technical-indicators-python-560800d6f3cd?source=collection_archive---------6-----------------------#2020-12-28">https://medium.com/analytics-vidhya/bitcoin-price-prediction-with-random-forest-and-technical-indicators-python-560800d6f3cd?source=collection_archive---------6-----------------------#2020-12-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6c89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在市值超过5000亿美元的比特币创下历史新高后，包括我在内的很多人都想知道，比特币的价值是会一直增加，还是像2017年那样是泡沫。这就是我写这篇文章的动机。</p><p id="baf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我解释了如何向由价格历史和交易量组成的源数据集添加特性。然后，使用技术指标丰富的数据集来训练一个<strong class="ih hj">随机森林</strong>分类模型，该模型预测比特币的价值在未来是增加还是减少。</p><p id="1264" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有使用过的库都列在<a class="ae jd" href="https://github.com/rs75/bitcoin-price-model" rel="noopener ugc nofollow" target="_blank">对应的GitHub库</a>的<a class="ae jd" href="https://github.com/rs75/bitcoin-price-model/blob/main/Pipfile" rel="noopener ugc nofollow" target="_blank"> pipfile </a>中。这个库还包含一个Jupyter笔记本，上面有完整的代码。</p><h1 id="95ea" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">创建数据集</h1><p id="5f60" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">价格和交易量的历史数据可以从quandl获得，它提供了一个python库。这非常简单，因为它将数据直接加载到Pandas数据框架中。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="e5ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经可以尝试使用这个数据框架来训练分类模型，但是我决定添加更多的功能，这些功能通常会使模型更加准确。</p><p id="da83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我找到了一个名为<a class="ae jd" href="https://github.com/bukosabino/ta" rel="noopener ugc nofollow" target="_blank"> ta </a>的库，它创建了许多技术指标，如<strong class="ih hj">均线</strong>或<strong class="ih hj">布林线</strong>(以及许多其他指标)。它最初是为分析股票数据而设计的，但也应该适用于比特币。以下代码向数据集中添加了80多个要素。在Github 上查看<a class="ae jd" href="https://github.com/rs75/bitcoin-price-model/blob/main/bitcoin_price_prediction.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本，查看输出。</a></p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="821b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是创建我们想要预测的类。为了不使问题变得太复杂，我决定只预测未来7天比特币的价值是涨还是跌。预测二元类比预测具体价格容易得多。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><h1 id="dc26" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">训练分类模型</h1><p id="28aa" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">接下来，我们需要将数据集分为测试数据和训练数据。前2000天用于培训，剩下的491天用于测试。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="e366" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在有趣的部分来了，创建<strong class="ih hj">随机森林分类器</strong>并用训练数据拟合它。其他分类模型也可以，我只是选择随机森林，因为我个人喜欢它。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><h2 id="b9a8" class="ko jf hi bd jg kp kq kr jk ks kt ku jo iq kv kw js iu kx ky jw iy kz la ka lb bi translated">评估模型</h2><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><pre class="kh ki kj kk fd lc ld le lf aw lg bi"><span id="7493" class="ko jf hi ld b fi lh li l lj lk">0.5804480651731161</span></pre><p id="5464" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个预测在58%的情况下是正确的。用训练数据集对它进行测试的结果是72%的准确率，这并不奇怪，因为这样的模型往往会过度拟合。</p><h1 id="6d30" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">解释</h1><p id="d133" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">下面的代码片段将结果可视化。红点和绿点表示在给定时间预测是否正确。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es ll"><img src="../Images/faf6fd85cf2c66d28aa0744919bf023e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4d1Twolc2BDmnCAkl2Q_bg.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">基于随机森林评估的比特币价格预测</figcaption></figure><p id="fd65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> random forest </strong>模型正确预测了2020年3月的下降，当时是日冕危机的开始。然而，2020年底的上涨并没有被正确预测。</p><p id="0fbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型完全依赖于从价格历史中获得的技术数据，许多人认为这些数据大多是随机的。因此，我对结果感到满意，但如果基本面因素也包括在内，我会期待显著的改善。例子可能是比特币的谷歌搜索量或区块链的分析。特别是区块链可能非常有价值，因为它包含了自2009年初以来的所有交易。</p></div></div>    
</body>
</html>