<html>
<head>
<title>Understanding torch.gather function in Pytorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解 Pytorch 中的 torch.gather 函数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-torch-gather-function-in-pytorch-f90db58b3c51?source=collection_archive---------4-----------------------#2020-10-18">https://medium.com/analytics-vidhya/understanding-torch-gather-function-in-pytorch-f90db58b3c51?source=collection_archive---------4-----------------------#2020-10-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="076d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个函数的两个参数，<strong class="ih hj"> index </strong>和<strong class="ih hj"> dim </strong>是理解函数的关键。</p><p id="fd5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于 2D 的情况，dim = 0 对应于行，dim = 1 对应于列。</p><p id="fbea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于 3D 的情况，dim = 0 对应于来自批次的图像，dim = 1 对应于行，dim = 2 对应于列。</p><h1 id="b21f" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">2D 输入张量的情况</h1><h2 id="3392" class="kb je hi bd jf kc kd ke jj kf kg kh jn iq ki kj jr iu kk kl jv iy km kn jz ko bi translated">1.理解模糊论点:</h2><blockquote class="kp kq kr"><p id="a40c" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">a.当 dim = 0 时，我们选择行。</p><p id="5da6" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">b.当 dim = 1 时，我们选择列。</p></blockquote><h2 id="4c62" class="kb je hi bd jf kc kd ke jj kf kg kh jn iq ki kj jr iu kk kl jv iy km kn jz ko bi translated">2.理解索引参数:</h2><blockquote class="kp kq kr"><p id="8339" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">a.索引参数将具有与输入相同的维数(并不意味着形状相同)。</p><p id="e058" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">b.输出张量将与索引张量具有相同的形状。</p><p id="b5cc" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">c.索引张量的元素告诉选择哪一行(对于 dim = 0，2D 情况),特定元素的位置告诉选择哪一列。</p><p id="b880" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">d.索引张量的元素告诉选择哪一列(对于 dim = 1，2D 情况),特定元素的位置告诉选择哪一行。</p></blockquote><h1 id="a916" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">3D 输入张量的情况</h1><h2 id="d575" class="kb je hi bd jf kc kd ke jj kf kg kh jn iq ki kj jr iu kk kl jv iy km kn jz ko bi translated">1.理解模糊论点:</h2><blockquote class="kp kq kr"><p id="2168" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">a.当 dim = 0 时，我们从批中选择图像。</p><p id="ebd6" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">b.当 dim = 1 时，我们选择行。</p><p id="df9e" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">c.当 dim = 2 时，我们选择列。</p></blockquote><h2 id="515e" class="kb je hi bd jf kc kd ke jj kf kg kh jn iq ki kj jr iu kk kl jv iy km kn jz ko bi translated">2.理解索引参数:</h2><blockquote class="kp kq kr"><p id="3eec" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">a.从上面的 a 和 b，2D 输入张量的情况适用。</p><p id="3fe9" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated">b.对于 dim = 1 和 dim = 2，索引张量的元素告诉从批(对于 dim = 0，3D 情况)中选择哪个图像，并且特定元素的位置告诉选择哪个行和列，等等。</p></blockquote><p id="801c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们举两个 2D 的例子。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/a766459c17529461cb339bced5575d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WlJjuXAWzn3jGq_izq3x0A.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">2D 输入张量的例子</figcaption></figure><p id="6410" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一个例子</strong></p><p id="cd15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当 dim = 0 时，并且</p><p id="05e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ind_2d = [[3，2，0，1]]</p><p id="cc0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ind_2d 具有 shape (1，4 ),因此输出将具有相同的形状。</p><p id="2ce1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ind_2d 的第 0 个元素，即 3 告诉我们选择第 3 行第 0 列(因为 3 是索引张量的第 0 个元素)。</p><p id="6faf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ind_2d 的第一个元素(即 2)告诉我们从 0 开始选择第二行(行，因为 dim = 0)和第一列(因为索引张量的第一个元素)。诸如此类。</p><p id="739e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二个例子</strong></p><p id="ab19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们假设从上面的 src_2d 张量我们想要选择 0，6，10 和 15。(提示:我们从上到下按顺序读取这些数字，因此我们形成了一个类似索引张量的列。当我们从左向右阅读时，我们形成像索引张量一样的行。)</p><p id="f211" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在 0 属于第 0 列，6 属于第 2 列，10 属于第 2 列，15 属于第 3 列。</p><p id="ce9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们的指数张量是[[0，2，2，3]]，以列的形式，即形状(4，1)。因为我们选择了列，所以 dim = 1。</p><p id="4fdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们不可能选择行并得到想要的输出张量。</p><h2 id="376e" class="kb je hi bd jf kc kd ke jj kf kg kh jn iq ki kj jr iu kk kl jv iy km kn jz ko bi translated">3D 的情况非常类似。从下面的信息图中获取想法。</h2><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lm"><img src="../Images/b128fb2237a26157ce691b735a32dbf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5CyUPpruS8oIYOQxvc7G9Q.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">3D 输入张量的例子</figcaption></figure><p id="053a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是 python 笔记本的链接，其中包含 2D 和 3D 输入张量两种情况下的几个示例:</p><div class="ln lo ez fb lp lq"><a href="https://github.com/pranavchat14/torch/blob/main/torch_gather.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">pranavchat 14/火炬</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">permalink dissolve GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">github.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me lg lq"/></div></div></a></div><p id="3d9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">链接到 Pytorch 函数:</p><p id="a238" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae mf" href="https://pytorch.org/docs/stable/generated/torch.gather.html?highlight=torch%20gather#torch.gather" rel="noopener ugc nofollow" target="_blank">https://py torch . org/docs/stable/generated/torch . gather . html？highlight = torch % 20 gather # torch . gather</a></p></div></div>    
</body>
</html>