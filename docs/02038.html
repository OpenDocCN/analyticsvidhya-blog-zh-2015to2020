<html>
<head>
<title>[Kaggle] Titanic Survival Prediction — Top 3%</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">泰坦尼克号生存预测-前3%</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/kaggle-titanic-survival-prediction-top-3-ea6c8dcc9b6c?source=collection_archive---------1-----------------------#2019-11-27">https://medium.com/analytics-vidhya/kaggle-titanic-survival-prediction-top-3-ea6c8dcc9b6c?source=collection_archive---------1-----------------------#2019-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fba9d0ec3137389f75da5a267b713f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukzDTJD4ieskdL5hfKpBOA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">(来源:<a class="ae iu" href="https://www.britannica.com/story/the-unsinkable-titanic" rel="noopener ugc nofollow" target="_blank">https://www.britannica.com/story/the-unsinkable-titanic</a>)</figcaption></figure><p id="17fd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在学习了一个月的Python之后，我计划在项目中应用我的知识。Kaggle是一个举办机器学习比赛并提供真实世界数据集的伟大平台。作为我的第一次尝试，我在这个项目上总共花了10天时间。感谢在线资源，如Stackoverflow和Medium的文章，它们帮助很大！</p><h1 id="ed44" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">索引</h1><ol class=""><li id="6222" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated">背景</li><li id="0024" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">探索性数据分析</li><li id="51bc" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">缺失数据/异常值的插补</li><li id="938a" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">数据转换</li><li id="6adb" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">特征创建</li><li id="ddf2" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">特征选择</li><li id="4306" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">模型</li><li id="92c4" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">提交</li></ol></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="7db6" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated">1.背景</h1><h2 id="7f63" class="lt ju hi bd jv lu lv lw jz lx ly lz kd jg ma mb kh jk mc md kl jo me mf kp mg bi translated">挑战</h2><p id="e304" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">泰坦尼克号的沉没是历史上最臭名昭著的海难之一。</p><p id="03bc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1912年4月15日，在她的处女航中，被广泛认为是“不沉”的皇家邮轮泰坦尼克号在与冰山相撞后沉没。不幸的是，没有足够的救生艇容纳船上的每个人，导致2224名乘客和船员中的1502人死亡。</p><p id="e8d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然幸存有一些运气成分，但似乎某些群体比其他群体更有可能幸存。</p><p id="28bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个挑战中，我们要求你建立一个预测模型来回答这个问题:“什么样的人更有可能生存？”使用乘客数据(如姓名、年龄、性别、社会经济阶层等)。</p><h2 id="d646" class="lt ju hi bd jv lu lv lw jz lx ly lz kd jg ma mb kh jk mc md kl jo me mf kp mg bi translated">概观</h2><p id="9215" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">数据被分成两组:</p><ul class=""><li id="bb9a" class="kr ks hi ix b iy iz jc jd jg mk jk ml jo mm js mn kz la lb bi translated">训练集(train.csv)</li><li id="8d40" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js mn kz la lb bi translated">测试集(test.csv)</li></ul><p id="077c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">训练集应该用于构建您的机器学习模型。对于训练集，我们为每个乘客提供结果(也称为“地面真相”)。你的模型将基于“特征”，如乘客的性别和阶级。你也可以使用<a class="ae iu" href="https://triangleinequality.wordpress.com/2013/09/08/basic-feature-engineering-with-the-titanic-data/" rel="noopener ugc nofollow" target="_blank">特征工程</a>来创建新的特征。</p><p id="6943" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">测试集应该用于查看您的模型在看不见的数据上的表现。对于测试集，我们不为每个乘客提供地面实况。预测这些结果是你的工作。对于测试集中的每个乘客，使用您训练的模型来预测他们是否在泰坦尼克号沉没时幸存。</p><p id="e90e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还包括gender_submission.csv，这是一组假设所有且只有女性乘客幸存的预测，作为提交文件的示例。</p><h2 id="5baf" class="lt ju hi bd jv lu lv lw jz lx ly lz kd jg ma mb kh jk mc md kl jo me mf kp mg bi translated">数据字典</h2><p id="6a9f" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">variabledefinitionkeysurvivalsurvival 0 = No，1 = YespclassTicket class1 = 1st，2 = 2nd，3 = 3rdsexSexAgeAge in yearssibsp #兄弟姐妹/配偶在泰坦尼克号上的人数父母/子女在泰坦尼克号上的人数</p><h2 id="4671" class="lt ju hi bd jv lu lv lw jz lx ly lz kd jg ma mb kh jk mc md kl jo me mf kp mg bi translated">可变音符</h2><p id="0e63" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">pclass:社会经济地位(SES)的代表<br/>1日=上层<br/>2日=中层<br/>3日=下层</p><p id="c967" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">年龄:如果小于1，年龄是分数。如果估计年龄，是xx.5的形式吗</p><p id="3c7f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">sibsp:数据集这样定义家庭关系……<br/>兄弟姐妹=兄弟、姐妹、继兄弟、继姐妹<br/>配偶=丈夫、妻子(情妇和未婚夫被忽略)</p><p id="0c46" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">帕奇:数据集是这样定义家庭关系的……<br/>父母=母亲，父亲<br/>孩子=女儿，儿子，继女，继子<br/>一些孩子只和保姆一起旅行，因此帕奇=0。</p><h2 id="fc95" class="lt ju hi bd jv lu lv lw jz lx ly lz kd jg ma mb kh jk mc md kl jo me mf kp mg bi translated">目标</h2><p id="806a" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">你的工作是预测泰坦尼克号沉没时是否有乘客幸存。<br/>对于测试集中的每个变量，您必须预测该变量的0或1值。</p><h2 id="f8d7" class="lt ju hi bd jv lu lv lw jz lx ly lz kd jg ma mb kh jk mc md kl jo me mf kp mg bi translated">公制的</h2><p id="938b" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">你的分数是你正确预测的乘客百分比。这就是所谓的<a class="ae iu" href="https://en.wikipedia.org/wiki/Accuracy_and_precision#In_binary_classification" rel="noopener ugc nofollow" target="_blank">精度</a>。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="e364" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated"><strong class="ak"> 2。探索性数据分析</strong></h1><p id="a0b4" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">导入库:</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="db25" class="lt ju hi mt b fi mx my l mz na">import numpy as np<br/>import os<br/>import pandas as pd<br/>import seaborn as sns<br/>from matplotlib import pyplot as plt<br/>from sklearn import metrics<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.feature_selection import RFECV<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.metrics import accuracy_score<br/>from sklearn.model_selection import cross_val_score, GridSearchCV<br/>from sklearn.preprocessing import LabelEncoder<br/>import warnings</span><span id="0d5a" class="lt ju hi mt b fi nb my l mz na">warnings.filterwarnings(‘ignore’)</span></pre><p id="ddc8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导入数据:</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="c2b6" class="lt ju hi mt b fi mx my l mz na">train_data = pd.read_csv(‘train.csv’)<br/>test_data = pd.read_csv(‘test.csv’)</span></pre><p id="1736" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据结构:</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="0ae2" class="lt ju hi mt b fi mx my l mz na">train_data.info()</span><span id="9efd" class="lt ju hi mt b fi nb my l mz na">Output:<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 891 entries, 0 to 890<br/>Data columns (total 12 columns):<br/>PassengerId    891 non-null int64<br/>Survived       891 non-null int64<br/>Pclass         891 non-null int64<br/>Name           891 non-null object<br/>Sex            891 non-null object<br/>Age            714 non-null float64<br/>SibSp          891 non-null int64<br/>Parch          891 non-null int64<br/>Ticket         891 non-null object<br/>Fare           891 non-null float64<br/>Cabin          204 non-null object<br/>Embarked       889 non-null object<br/>dtypes: float64(2), int64(5), object(5)<br/>memory usage: 83.7+ KB</span><span id="400e" class="lt ju hi mt b fi nb my l mz na">test_data.info()</span><span id="700d" class="lt ju hi mt b fi nb my l mz na">Output:<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 418 entries, 0 to 417<br/>Data columns (total 13 columns):<br/>Age            332 non-null float64<br/>Cabin          91 non-null object<br/>Embarked       418 non-null object<br/>Fare           417 non-null float64<br/>Name           418 non-null object<br/>Parch          418 non-null int64<br/>PassengerId    418 non-null int64<br/>Pclass         418 non-null int64<br/>Sex            418 non-null object<br/>SibSp          418 non-null int64<br/>Survived       0 non-null float64<br/>Ticket         418 non-null object<br/>Title          418 non-null object<br/>dtypes: float64(3), int64(4), object(6)<br/>memory usage: 45.7+ KB</span></pre><ol class=""><li id="d632" class="kr ks hi ix b iy iz jc jd jg mk jk ml jo mm js ky kz la lb bi translated">总行数:891用于训练，418用于测试数据集。</li><li id="6135" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">客舱:数据缺失&gt; 70%。<br/>由于少于30%的数据无法提供意义信息，客舱数据可以忽略。</li></ol><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="217d" class="lt ju hi mt b fi mx my l mz na">train_data.drop([‘Cabin’], axis=1, inplace=True)<br/>test_data.drop([‘Cabin’], axis=1, inplace=True)</span></pre><p id="0a57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">幸存</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="f949" class="lt ju hi mt b fi mx my l mz na">sns.countplot(train_data.Survived)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/c344e885e9181e8e450a36cb786731d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oDN_9ccN8gmjqYZSA6I9sw.png"/></div></div></figure><p id="f634" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总存活概率约为38%</p><p id="7d1f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Pclass </strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="f54d" class="lt ju hi mt b fi mx my l mz na">sns.countplot(train_data.Pclass)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/ce5f7b8ecdb4b753a47960a277a0b218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*itxTcQ77wOnFnMec3U7gQg.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="534d" class="lt ju hi mt b fi mx my l mz na">sns.barplot(x=’Pclass’, y=’Survived’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/6e0d7c0f9abac169fb1c247910820653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxN-RRv8-ZfKllX0jH7yDQ.png"/></div></div></figure><p id="b9ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.Pclass 1(上层阶级)的乘客生还的可能性更大。</p><p id="c753" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.Pclass是一个很好的生存预测特征。</p><p id="d8f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">性</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="fb34" class="lt ju hi mt b fi mx my l mz na">sns.countplot(train_data.Sex)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/0dc8e8915987d3e3e1776899f0721534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gIdwF9HWOgJpxOOUKP20SQ.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="ff8f" class="lt ju hi mt b fi mx my l mz na">sns.barplot(x=’Sex’, y=’Survived’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/5c27ac859752b09316314abfba15b012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l7X25xbve2X6JPddr-VJWQ.png"/></div></div></figure><p id="e496" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.男女比例:约2/3对约1/3</p><p id="87ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.男性存活的可能性要小得多，存活几率只有20%。对于女性来说，存活几率超过70%。</p><p id="a8c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.显然，性别是预测生存的一个重要特征。</p><p id="c6f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">年龄</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="5c4c" class="lt ju hi mt b fi mx my l mz na">plt.hist(train_data.Age, edgecolor=’black’)<br/>plt.xlabel('Age')<br/>plt.ylabel('count')<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/de3a7d4848b6301cd6e8b0e20d54f32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAvDR00WAASxsKjXEZwKyg.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="50bb" class="lt ju hi mt b fi mx my l mz na">sns.boxplot(x=’Survived’, y=’Age’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/1da81e61d740a659130af6849db86570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-XDOh31pfiiYQIi_7jzCw.png"/></div></div></figure><p id="4fb3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.乘客年龄主要在20-40岁之间。</p><p id="b39e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.年轻的乘客更容易幸存。</p><p id="6ae3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> SibSp </strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="4497" class="lt ju hi mt b fi mx my l mz na">sns.countplot(train_data.SibSp)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/78339500990c86960d0d5cf1818533a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nchPbQjNO1mlPpQNcWONZQ.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="5c33" class="lt ju hi mt b fi mx my l mz na">sns.barplot(x=’SibSp’, y=’Survived’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/74dd06eea9e03ffe5500cd874a10a7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wXZ7TsJD4W1lL0AiZ86VQ.png"/></div></div></figure><p id="39aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.大多数乘客与一个兄弟姐妹/配偶一起旅行。</p><p id="b051" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.与没有兄弟姐妹/配偶的乘客相比，有一个兄弟姐妹/配偶的乘客更有可能幸存。</p><p id="afcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.对于那些超过1个兄弟姐妹/配偶的人，信息不足以提供任何见解。</p><p id="5121" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">烤干</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="42c0" class="lt ju hi mt b fi mx my l mz na">sns.countplot(train_data.Parch)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/0d211db3bdab92b43c262ab8e6b5b5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rSvsaV8gKLqAMithhPRi5A.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="8193" class="lt ju hi mt b fi mx my l mz na">sns.barplot(x=’Parch’, y=’Survived’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/7818ba6edc92a1ed8ea9483b838f2831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wyUufoxMY9Om5fVzYFIbzQ.png"/></div></div></figure><p id="27f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.&gt; 70%的乘客没有父母/子女陪伴。</p><p id="90e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.和父母/孩子一起旅行的乘客比没有父母/孩子的乘客更有可能幸存。</p><p id="b4c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">票</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="5ce2" class="lt ju hi mt b fi mx my l mz na">train_data.Ticket.head(10)</span><span id="041e" class="lt ju hi mt b fi nb my l mz na">Output:<br/>0 A/5 21171<br/>1 PC 17599<br/>2 STON/O2. 3101282<br/>3 113803<br/>4 373450<br/>5 330877<br/>6 17463<br/>7 349909<br/>8 347742<br/>9 237736<br/>Name: Ticket, dtype: object</span></pre><p id="a800" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">票价</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="483e" class="lt ju hi mt b fi mx my l mz na">sns.distplot(train_data.Fare)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/dcf4e5a9c008bb47b33516910f04e5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0KZ3NkLx5qMX0IwcYcdZMw.png"/></div></div></figure><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/adfe8a00c76e6b4442247331f55042b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HAvL4rGhvC7PODk8-cQRmg.png"/></div></div></figure><ol class=""><li id="6d6c" class="kr ks hi ix b iy iz jc jd jg mk jk ml jo mm js ky kz la lb bi translated">这种分布是右偏的。观察到异常值。</li><li id="b2a8" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">对于那些幸存下来的人来说，他们的票价相对较高。</li></ol><p id="bc02" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">着手进行</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="ba09" class="lt ju hi mt b fi mx my l mz na">sns.countplot(train_data.Embarked)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/2d94212343be8f57eaaf2470ecd578c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fyVG9Z1ZeuvH2F5Qf_xfeg.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="0352" class="lt ju hi mt b fi mx my l mz na">sns.barplot(x=’Embarked’, y=’Survived’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/230d8748e82ba55c4015ee84964d9887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h9rjwbA24Ksl2mRayJP1PA.png"/></div></div></figure><p id="9583" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.超过2/3的乘客在c港上船。</p><p id="5df3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.在C港上船的乘客生还的可能性更大。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="dc74" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated"><strong class="ak"> 3。缺失数据/异常值的插补</strong></h1><p id="4db3" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated"><strong class="ix hj">年龄</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="f4bb" class="lt ju hi mt b fi mx my l mz na">train_data.Name.head(10)</span><span id="8106" class="lt ju hi mt b fi nb my l mz na">Output:<br/>0 Braund, Mr. Owen Harris<br/>1 Cumings, Mrs. John Bradley (Florence Briggs Th…<br/>2 Heikkinen, Miss. Laina<br/>3 Futrelle, Mrs. Jacques Heath (Lily May Peel)<br/>4 Allen, Mr. William Henry<br/>5 Moran, Mr. James<br/>6 McCarthy, Mr. Timothy J<br/>7 Palsson, Master. Gosta Leonard<br/>8 Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)<br/>9 Nasser, Mrs. Nicholas (Adele Achem)<br/>Name: Name, dtype: object</span></pre><p id="53ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从乘客的名字中提取头衔(先生/夫人/小姐/主人)。对于训练和测试数据集都可以这样做。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="ecc7" class="lt ju hi mt b fi mx my l mz na">whole_data = train_data.append(test_data)<br/>whole_data['Title'] = whole_data.Name.str.extract(r'([A-Za-z]+)\.', expand=False)<br/>whole_data.Title.value_counts()</span><span id="3542" class="lt ju hi mt b fi nb my l mz na">Output:<br/>Mr          757<br/>Miss        260<br/>Mrs         197<br/>Master       61<br/>Dr            8<br/>Rev           8<br/>Col           4<br/>Ms            2<br/>Major         2<br/>Mlle          2<br/>Countess      1<br/>Jonkheer      1<br/>Don           1<br/>Sir           1<br/>Dona          1<br/>Capt          1<br/>Mme           1<br/>Lady          1<br/>Name: Title, dtype: int64</span></pre><p id="9f06" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">常见的称呼是(先生/小姐/夫人/主人)。一些头衔(女士/女士/先生…等。)可以归入普通标题。剩下的未分类的标题可以放在“其他”中。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="c3c3" class="lt ju hi mt b fi mx my l mz na">Common_Title = [‘Mr’, ‘Miss’, ‘Mrs’, ‘Master’]<br/>whole_data[‘Title’].replace([‘Ms’, ‘Mlle’, ‘Mme’], ‘Miss’, inplace=True)<br/>whole_data[‘Title’].replace([‘Lady’], ‘Mrs’, inplace=True)<br/>whole_data[‘Title’].replace([‘Sir’, ‘Rev’], ‘Mr’, inplace=True)<br/>whole_data[‘Title’][~whole_data.Title.isin(Common_Title)] = ‘Others’</span></pre><p id="0ee7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看训练数据集中的标题和年龄之间的关系。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="a15f" class="lt ju hi mt b fi mx my l mz na">train_data = whole_data[:len(train_data)]<br/>test_data = whole_data[len(train_data):]</span><span id="5421" class="lt ju hi mt b fi nb my l mz na">sns.boxplot(x='Title', y='Age', data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/7bda11fd1d5750ec60551a3fd34519f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5P2YJnzEVNRfoqYowAEK2w.png"/></div></div></figure><p id="14f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">找出每个题目中年龄的中位数。<br/>(备注:仅使用训练数据集以避免数据泄露)</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="4f26" class="lt ju hi mt b fi mx my l mz na">AgeMedian_by_titles = train_data.groupby(‘Title’)[‘Age’].median()<br/>AgeMedian_by_titles</span><span id="4771" class="lt ju hi mt b fi nb my l mz na">Output:<br/>Title<br/>Master     3.5<br/>Miss      21.5<br/>Mr        30.0<br/>Mrs       35.0<br/>Others    47.0<br/>Name: Age, dtype: float64</span></pre><p id="1847" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据标题估算缺失的年龄值。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="7921" class="lt ju hi mt b fi mx my l mz na">for title in AgeMedian_by_titles.index:<br/>    train_data['Age'][(train_data.Age.isnull()) &amp; (train_data.Title == title)] = AgeMedian_by_titles[title]<br/>    test_data['Age'][(test_data.Age.isnull()) &amp; (test_data.Title == title)] = AgeMedian_by_titles[title]</span></pre><p id="e716" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">登船</strong></p><p id="ea38" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于训练数据集，只有2个值缺失。简单地估算模式。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="18f8" class="lt ju hi mt b fi mx my l mz na">train_data[‘Embarked’].fillna(train_data.Embarked.mode()[0], inplace=True)</span></pre><p id="abcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">票价</strong></p><p id="8dc0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于测试数据集，只有1个值缺失。简单地估算中间值，</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="23ff" class="lt ju hi mt b fi mx my l mz na">test_data[‘Fare’].fillna(test_data[‘Fare’].median(), inplace=True)</span></pre><p id="5e60" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于训练数据集，有3个异常值(即512.3292)。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="379c" class="lt ju hi mt b fi mx my l mz na">For train dataset, there are outliers observed. Replace them with median.</span><span id="3df1" class="lt ju hi mt b fi nb my l mz na">train_data.Fare.sort_values(ascending=False).head(5)</span><span id="3e51" class="lt ju hi mt b fi nb my l mz na">Output:<br/>679 512.3292<br/>258 512.3292<br/>737 512.3292<br/>341 263.0000<br/>438 263.0000</span></pre><p id="d527" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">应处理异常值，以免扭曲分布，从而使模型更加稳健。</p><p id="e213" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">离群值可以替换为最大上限、中值，或者您可以简单地删除它们。</p><p id="a0d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我选择用第二个更高的票价(即263英镑)来代替异常值。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="b8e3" class="lt ju hi mt b fi mx my l mz na">train_data.loc[train_data.Fare&gt;512, ‘Fare’] = 263<br/>train_data.Fare.sort_values(ascending=False).head(5)</span><span id="e668" class="lt ju hi mt b fi nb my l mz na">Output:<br/>341    263.0<br/>438    263.0<br/>88     263.0<br/>679    263.0<br/>258    263.0<br/>Name: Fare, dtype: float64</span></pre><p id="460e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">检查丢失的数据。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="25a7" class="lt ju hi mt b fi mx my l mz na">train_data.info()</span><span id="bd88" class="lt ju hi mt b fi nb my l mz na">Output:<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 891 entries, 0 to 890<br/>Data columns (total 12 columns):<br/>Age            891 non-null float64<br/>Embarked       891 non-null object<br/>Fare           891 non-null float64<br/>Name           891 non-null object<br/>Parch          891 non-null int64<br/>PassengerId    891 non-null int64<br/>Pclass         891 non-null int64<br/>Sex            891 non-null object<br/>SibSp          891 non-null int64<br/>Survived       891 non-null float64<br/>Ticket         891 non-null object<br/>Title          891 non-null object<br/>dtypes: float64(3), int64(4), object(5)<br/>memory usage: 90.5+ KB</span><span id="4f63" class="lt ju hi mt b fi nb my l mz na">test_data.info()<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 418 entries, 0 to 417<br/>Data columns (total 12 columns):<br/>Age            418 non-null float64<br/>Embarked       418 non-null object<br/>Fare           418 non-null float64<br/>Name           418 non-null object<br/>Parch          418 non-null int64<br/>PassengerId    418 non-null int64<br/>Pclass         418 non-null int64<br/>Sex            418 non-null object<br/>SibSp          418 non-null int64<br/>Survived       0 non-null float64<br/>Ticket         418 non-null object<br/>Title          418 non-null object<br/>dtypes: float64(3), int64(4), object(5)<br/>memory usage: 42.5+ KB</span></pre></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="0e84" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated"><strong class="ak"> 4。数据转换</strong></h1><p id="9d18" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">将字符串编码为数字以进行建模。</p><p id="6035" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">性</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="16ae" class="lt ju hi mt b fi mx my l mz na">train_data[‘Sex_Code’] = train_data[‘Sex’].map({‘female’:1, ‘male’:0}).astype(‘int’)<br/>test_data[‘Sex_Code’] = test_data[‘Sex’].map({‘female’:1, ‘male’:0}).astype(‘int’)</span></pre><p id="82dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">登船</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="e9bd" class="lt ju hi mt b fi mx my l mz na">train_data['Embarked_Code'] = train_data['Embarked'].map({'S':0, 'C':1, 'Q':2}).astype('int')<br/>test_data['Embarked_Code'] = test_data['Embarked'].map({'S':0, 'C':1, 'Q':2}).astype('int')</span></pre><p id="0517" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将数据分组到箱中，以使模型更加稳健并避免过度拟合。</p><p id="4f57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">年龄</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="a383" class="lt ju hi mt b fi mx my l mz na">train_data['AgeBin_5'] = pd.qcut(train_data['Age'], 5)<br/>test_data['AgeBin_5'] = pd.qcut(test_data['Age'], 5)</span><span id="a527" class="lt ju hi mt b fi nb my l mz na">sns.barplot(x='AgeBin_5', y='Survived', data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/f09756a5c7e01829e0ba9652b4b0d4b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_ZZ55N-8PhGfvfxjru7HA.png"/></div></div></figure><p id="06be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">票价</strong></p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="9211" class="lt ju hi mt b fi mx my l mz na">train_data[‘FareBin_5’] = pd.qcut(train_data[‘Fare’], 5)<br/>test_data[‘FareBin_5’] = pd.qcut(test_data[‘Fare’], 5)</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/9b8d67b4f9097948e4158425ffbbe3cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FgieHbkjRD0VpzeiGXvpRA.png"/></div></div></figure><p id="6016" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将年龄和费用箱编码成用于建模的数字。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="57b9" class="lt ju hi mt b fi mx my l mz na">label = LabelEncoder()<br/>train_data['AgeBin_Code_5'] = label.fit_transform(train_data['AgeBin_5'])<br/>test_data['AgeBin_Code_5'] = label.fit_transform(test_data['AgeBin_5'])</span><span id="a7c5" class="lt ju hi mt b fi nb my l mz na">label = LabelEncoder()<br/>train_data[‘FareBin_Code_5’] = label.fit_transform(train_data[‘FareBin_5’])<br/>test_data[‘FareBin_Code_5’] = label.fit_transform(test_data[‘FareBin_5’])</span></pre></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="6b7f" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated"><strong class="ak"> 5。特征创建</strong></h1><p id="e41a" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated"><strong class="ix hj">单独</strong></p><p id="6737" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SibSp和Parch都与家族成员有关。为了简单起见，我决定将它们合并成一个单一的特性，即FamilySize。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="06bc" class="lt ju hi mt b fi mx my l mz na">train_data[‘FamilySize’] = train_data.SibSp + train_data.Parch + 1<br/>test_data[‘FamilySize’] = test_data.SibSp + test_data.Parch + 1</span><span id="579b" class="lt ju hi mt b fi nb my l mz na">sns.countplot(train_data.FamilySize)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/bf3c34c32d5630c761dee63affed6825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b23DQc3sPNn0tv35AKxsrw.png"/></div></div></figure><p id="0472" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于家庭大小=1的比例占主导地位，它可能不能提供足够的预测能力。我决定把他们组织起来，然后决定是否单独旅行。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="e578" class="lt ju hi mt b fi mx my l mz na">train_data[‘Alone’] = train_data.FamilySize.map(lambda x: 1 if x == 1 else 0)<br/>test_data[‘Alone’] = test_data.FamilySize.map(lambda x: 1 if x == 1 else 0)</span><span id="714e" class="lt ju hi mt b fi nb my l mz na">sns.countplot(train_data.Alone)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/31772bf294b4b309ea93ad17f500cd86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BUn-4j-zPORVZsxjcn63sw.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="1766" class="lt ju hi mt b fi mx my l mz na">sns.barplot(x=’Alone’, y=’Survived’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/feb7c50d7e6eca3b15dd56186887bf5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xdb_o8M7Ar0_J2c_Mv5DDA.png"/></div></div></figure><p id="f8b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">据观察，独自旅行生存的可能性更小(约30%对约50%)。</p><p id="95dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">标题</strong></p><p id="2bb0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标题是为年龄缺失值的插补而创建的。它也可以作为一个新的功能。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="b4a2" class="lt ju hi mt b fi mx my l mz na">sns.countplot(train_data.Title)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/c86446a816f99cbe318260e519a5a6e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KA45QCPoiEjN5CtUZa09pw.png"/></div></div></figure><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="91cf" class="lt ju hi mt b fi mx my l mz na">sns.barplot(x=’Title’, y=’Survived’, data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/b2a68c81e4773a5ecbae24ef2533e4c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mdnBqajvpWkWJRYQXkMynA.png"/></div></div></figure><p id="05c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很明显先生这个头衔比起其他人来说存活的可能性要小得多。</p><p id="7f30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们为建模对特征进行编码。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="2e18" class="lt ju hi mt b fi mx my l mz na">train_data[‘Title_Code’] = train_data.Title.map({‘Mr’:0, ‘Miss’:1, ‘Mrs’:2, ‘Master’:3, ‘Others’:4}).astype(‘int’)<br/>test_data[‘Title_Code’] = test_data.Title.map({‘Mr’:0, ‘Miss’:1, ‘Mrs’:2, ‘Master’:3, ‘Others’:4}).astype(‘int’)</span></pre><p id="c489" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">连通生存</strong></p><p id="3bc5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从《泰坦尼克号》电影中，幸存者通常都是家庭成员。他们互相帮助寻找出路。此外，家庭通常有孩子，这是第一优先发送到安全的船只。当然，应该有父母来照顾孩子。</p><p id="23ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要搞清楚家庭群体，除了乘客的姓氏(可能有同姓，但家庭不同)，我们还要看车票。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="d982" class="lt ju hi mt b fi mx my l mz na">train_data[[‘Name’, ‘Ticket’]].sort_values(‘Name’).head(20)</span><span id="32f7" class="lt ju hi mt b fi nb my l mz na">Output:<br/>845                              Abbing, Mr. Anthony           C.A. 5547<br/>746                      Abbott, Mr. Rossmore Edward           C.A. 2673<br/>279                 Abbott, Mrs. Stanton (Rosa Hunt)           C.A. 2673<br/>308                              Abelson, Mr. Samuel           P/PP 3381<br/>874            Abelson, Mrs. Samuel (Hannah Wizosky)           P/PP 3381<br/>365                   Adahl, Mr. Mauritz Nils Martin              C 7076<br/>401                                  Adams, Mr. John              341826<br/>40    Ahlin, Mrs. Johan (Johanna Persdotter Larsson)                7546<br/>855                       Aks, Mrs. Sam (Leah Rosen)              392091<br/>207                      Albimona, Mr. Nassef Cassem                2699<br/>810                           Alexander, Mr. William                3474<br/>840                      Alhomaki, Mr. Ilmari Rudolf    SOTON/O2 3101287<br/>210                                   Ali, Mr. Ahmed  SOTON/O.Q. 3101311<br/>784                                 Ali, Mr. William  SOTON/O.Q. 3101312<br/>730                    Allen, Miss. Elisabeth Walton               24160<br/>4                           Allen, Mr. William Henry              373450<br/>305                   Allison, Master. Hudson Trevor              113781<br/>297                     Allison, Miss. Helen Loraine              113781<br/>498  Allison, Mrs. Hudson J C (Bessie Waldo Daniels)              113781<br/>834                           Allum, Mr. Owen George                2223</span></pre><p id="cd07" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">看来同姓的乘客有相同的票名。</p><p id="2359" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们提取姓氏和票名，找出重复的。训练和测试数据集中可能有来自相同家庭的乘客。所以，我决定整体来做。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="9d39" class="lt ju hi mt b fi mx my l mz na">whole_data = train_data.append(test_data)<br/>whole_data['Surname'] = whole_data.Name.str.extract(r'([A-Za-z]+),', expand=False)<br/>whole_data['TixPref'] = whole_data.Ticket.str.extract(r'(.*\d)', expand=False)<br/>whole_data['SurTix'] = whole_data['Surname'] + whole_data['TixPref']<br/>whole_data['IsFamily'] = whole_data.SurTix.duplicated(keep=False)*1</span><span id="1aca" class="lt ju hi mt b fi nb my l mz na">sns.countplot(whole_data.IsFamily)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/5a676fe36d7df68b06407aa9c2b37e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKUWrVA_g5Wam8cKRcY7iA.png"/></div></div></figure><p id="4566" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大约1/3的乘客与家人一起旅行。</p><p id="ac38" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们把有孩子的家庭挖出来。简单地列出那些有家庭和孩子的“SurTix”。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="1146" class="lt ju hi mt b fi mx my l mz na">whole_data['Child'] = whole_data.Age.map(lambda x: 1 if x &lt;=16 else 0)<br/>FamilyWithChild = whole_data[(whole_data.IsFamily==1)&amp;(whole_data.Child==1)]['SurTix'].unique()</span><span id="89f5" class="lt ju hi mt b fi nb my l mz na">len(UniqueFamilyTixWithChild)</span><span id="dd02" class="lt ju hi mt b fi nb my l mz na">Output:<br/>66</span></pre><p id="ca56" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有66个家庭有一个或多个孩子。</p><p id="bbc0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对每个有孩子的家庭进行编码(例如，为其他家庭分配0)。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="7cd3" class="lt ju hi mt b fi mx my l mz na">whole_data['FamilyId'] = 0</span><span id="b9dc" class="lt ju hi mt b fi nb my l mz na">x = 1<br/>for tix in UniqueFamilyTixWithChild:<br/> whole_data.loc[whole_data.SurTix==tix, ['FamilyId']] = x<br/> x += 1</span></pre><p id="1022" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看每个有孩子的家庭的生存数据</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="8b84" class="lt ju hi mt b fi mx my l mz na">whole_data[‘SurvivedDemo’] = whole_data[‘Survived’].fillna(9)<br/>pd.crosstab(whole_data.FamilyId, whole_data.SurvivedDemo).drop([0]).plot(kind=’bar’, stacked=True, color=[‘black’,’g’,’grey’])<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/ad7da0f5521e75013b5cdb35a033a47a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Avh2igHk6BjfbPZkd2K8ig.png"/></div></div></figure><p id="cba4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">据观察，这些家族通常都存活(即全绿)或不存活(即全黑)。这一发现证明了关联生存的概念。对于上述每个家庭，如果至少有一个幸存，我们假设其他人也能幸存。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="1d48" class="lt ju hi mt b fi mx my l mz na">whole_data[‘ConnectedSurvival’] = 0.5 </span><span id="3e79" class="lt ju hi mt b fi nb my l mz na">Survived_by_FamilyId = whole_data.groupby(‘FamilyId’).Survived.sum()<br/>for i in range(1, len(UniqueFamilyTixWithChild)+1):<br/> if Survived_by_FamilyId[i] &gt;= 1:<br/> whole_data.loc[whole_data.FamilyId==i, [‘ConnectedSurvival’]] = 1<br/> elif Survived_by_FamilyId[i] == 0:<br/> whole_data.loc[whole_data.FamilyId==i, [‘ConnectedSurvival’]] = 0</span><span id="a795" class="lt ju hi mt b fi nb my l mz na">train_data = whole_data[:len(train_data)]<br/>test_data = whole_data[len(train_data):]</span><span id="3845" class="lt ju hi mt b fi nb my l mz na">sns.barplot(x='ConnectedSurvival', y='Survived', data=train_data)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/b65e8d16391623d838725b3f25fac459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w3JyRtbSSOv-8pu7KeA9pw.png"/></div></div></figure><p id="a32f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于以下乘客，生还的可能性要高得多:</p><ol class=""><li id="9f42" class="kr ks hi ix b iy iz jc jd jg mk jk ml jo mm js ky kz la lb bi translated">与家人一起旅行</li><li id="ff43" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">家中有一个或多个孩子的</li><li id="5da4" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">家庭中有一名或多名幸存者</li></ol></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="da09" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated"><strong class="ak"> 6。功能选择</strong></h1><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="1648" class="lt ju hi mt b fi mx my l mz na">train_data.columns</span><span id="e75a" class="lt ju hi mt b fi nb my l mz na">Output:<br/>Index(['Age', 'Embarked', 'Fare', 'Name', 'Parch', 'PassengerId', 'Pclass', 'Sex', 'SibSp', 'Survived', 'Ticket', 'Title', 'Sex_Code', 'AgeBin_5', 'FareBin_5', 'AgeBin_Code_5', 'FareBin_Code_5', 'FamilySize', 'Alone', 'Title_Code', 'Surname', 'TixPref', 'SurTix', 'IsFamily', 'Child', 'FamilyId', 'ConnectedSurvival'],<br/>dtype='object')</span></pre><p id="037b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，删除那些未使用的列</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="8eb4" class="lt ju hi mt b fi mx my l mz na">X_train = train_data.drop([‘Age’, ‘Embarked’, ‘Fare’, ‘Name’, ‘Parch’, ‘PassengerId’, ‘Sex’, ‘SibSp’, ‘Survived’, ‘Ticket’, 'Title', ‘AgeBin_5’, ‘FareBin_5’, ‘FamilySize’, ‘Surname’, ‘TixPref’, ‘SurTix’, ‘IsFamily’, ‘Child’, ‘FamilyId’], axis=1)</span><span id="7ce7" class="lt ju hi mt b fi nb my l mz na">y_train = train_data[‘Survived’]</span></pre><p id="8e9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将模型指定为RandomForestClassifier。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="8bc8" class="lt ju hi mt b fi mx my l mz na">model = RandomForestClassifier(n_estimators=200, random_state=2)</span></pre><p id="40cc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看特性的重要性。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="da3f" class="lt ju hi mt b fi mx my l mz na">model.fit(X_train,y_train)<br/>importance = pd.DataFrame({‘feature’:X_train.columns, ‘importance’: np.round(model.feature_importances_,3)})<br/>importance = importance.sort_values(‘importance’, ascending=False).set_index(‘feature’)</span><span id="156b" class="lt ju hi mt b fi nb my l mz na">importance.plot(kind='bar', rot=0)<br/>plt.show()</span></pre><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/ed85ea61ec5b2977bbd9c0f0bece8134.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n0Ke-Tv41ylCgdCDrRlk5w.png"/></div></div></figure><p id="b51f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择用于建模的前5个重要特征(即Title_Code、Sex_Code、Connected _ Survivial、Pclass和FareBin_Code_5)。始终保持最小数量的特征，以避免过度拟合。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="fc2e" class="lt ju hi mt b fi mx my l mz na">final = [‘Title_Code’, ‘Sex_Code’, ‘ConnectedSurvival’, ‘Pclass’, ‘FareBin_Code_5’]</span></pre></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="debe" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated"><strong class="ak"> 7。型号</strong></h1><p id="7feb" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg mh ji jj jk mi jm jn jo mj jq jr js hb bi translated">调整模型参数。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="3976" class="lt ju hi mt b fi mx my l mz na">grid_param = {<br/> ‘n_estimators’: [100, 200, 300],<br/> ‘criterion’:[‘gini’, ‘entropy’],<br/> ‘min_samples_split’: [2, 10, 20],<br/> ‘min_samples_leaf’: [1, 5],<br/> ‘bootstrap’: [True, False],<br/>}</span><span id="b5db" class="lt ju hi mt b fi nb my l mz na">gd_sr = GridSearchCV(estimator=model,<br/> param_grid=grid_param,<br/> scoring=’accuracy’,<br/> cv=5,<br/> n_jobs=-1)</span><span id="1bc5" class="lt ju hi mt b fi nb my l mz na">gd_sr.fit(X_train[final], y_train)<br/>best_parameters = gd_sr.best_params_<br/>print(best_parameters)</span><span id="c3e1" class="lt ju hi mt b fi nb my l mz na">Output:<br/>{'bootstrap': True, 'criterion': 'entropy', 'min_samples_leaf': 5, 'min_samples_split': 2, 'n_estimators': 300}</span></pre><p id="f730" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">调整后设置模型参数。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="1f76" class="lt ju hi mt b fi mx my l mz na">model = RandomForestClassifier(n_estimators=300, bootstrap=True, criterion= 'entropy', min_samples_leaf=5, min_samples_split=2, random_state=2)</span></pre><p id="1e8e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用5重交叉验证计算预测的准确性。</p><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="9f58" class="lt ju hi mt b fi mx my l mz na">all_accuracies = cross_val_score(estimator=model1, X=X_train, y=y_train, cv=5)</span><span id="8bcc" class="lt ju hi mt b fi nb my l mz na">all_accuracies<br/>all_accuracies.mean()</span><span id="0edf" class="lt ju hi mt b fi nb my l mz na">Output:<br/>[0.86592179 0.84357542 0.83707865 0.80898876 0.88700565]<br/>0.8485140544303522</span></pre><p id="0fc2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">精确度平均值为0.8485</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="54b4" class="jt ju hi bd jv jw lo jy jz ka lp kc kd ke lq kg kh ki lr kk kl km ls ko kp kq bi translated"><strong class="ak"> 8。提交</strong></h1><pre class="mo mp mq mr fd ms mt mu mv aw mw bi"><span id="6694" class="lt ju hi mt b fi mx my l mz na">X_test = test_data[final]</span><span id="8e5f" class="lt ju hi mt b fi nb my l mz na">model.fit(X_train[final],y_train)<br/>prediction = model.predict(X_test)<br/>output = pd.DataFrame({‘PassengerId’: test_data.PassengerId, ‘Survived’: prediction.astype(int)})<br/>output.to_csv(‘my_submission.csv’, index=False)</span></pre><p id="ed60" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Kaggle得分为0.82296(前3%)</p><figure class="mo mp mq mr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/3a7952b5c327417fb772c61aa5474919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JL8474gac9gw5lRgWigo7A.png"/></div></div></figure><p id="5d29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谢谢大家！</p></div></div>    
</body>
</html>