<html>
<head>
<title>The groupby Method in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的groupby方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-groupby-method-in-python-4b3c24e4a9e5?source=collection_archive---------15-----------------------#2020-12-16">https://medium.com/analytics-vidhya/the-groupby-method-in-python-4b3c24e4a9e5?source=collection_archive---------15-----------------------#2020-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8f3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">python中关于groupby方法的一切。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0ad32e24381953ce299d666202c16dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6j1EibsUG0wC-NLlFfuoQg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">马哈拉施特拉邦迪韦加尔海滩，来源:-互联网</figcaption></figure><p id="3847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好，希望你们都过得好。</p><p id="fed9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将了解python中groupby方法的所有内容。所以把这篇文章一直读到最后，你会知道我们可以多么容易地使用groupby方法处理数据来发现有趣的见解。</p><p id="96b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">先决条件:Python的熊猫库的基础知识</p><p id="2234" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目标</strong> :-假设我们有一个印度的GDP数据集，其中包含像邦、区(北、南、东、西)等特征。我们希望按区域计算GDP，即我们希望<strong class="ih hj">按</strong>区域对 GDP <strong class="ih hj">进行分组。这里groupby方法来帮助我们。</strong></p><p id="a141" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目录:-</p><ol class=""><li id="f618" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc jy jz ka kb bi translated">什么是groupby方法？</li><li id="3f07" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">何处使用groupby方法</li><li id="4895" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">用一个例子演示</li></ol><p id="ac87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">groupby特性允许您基于列将行分组在一起，并对它们执行特定的功能(如求和、平均、计数)。我们需要使用groupby特性来对表中的一些行进行分组，然后对它们执行特定的功能(比如均值、计数)。</p><p id="6475" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看一个例子…</p><p id="3a61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本次演示中，我们将使用数据集信用风险。你可以从<a class="ae kh" href="https://github.com/Dnp1995/Datasets/blob/main/credit_risk_train_data.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="2672" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集包括申请银行贷款的申请人的信息。</p><p id="a78f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将导入所有必需的库并加载数据集</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="3ae1" class="kn ko hi kj b fi kp kq l kr ks">import numpy as np<br/>import pandas as pd<br/>from IPython.core.interactiveshell import InteractiveShell<br/>InteractiveShell.ast_node_interactivity='all'<br/>df=pd.red_csv('credit_risk_train_data')</span></pre><p id="2f50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混洗数据集并制作一个简单的过滤器“prop”来分组“Property_Area”要素</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="0e53" class="kn ko hi kj b fi kp kq l kr ks">df=df.sample(frac=1.radom_state=123)<br/>df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/b7a05f40508de42065c42775ca770dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XHuskIUAJu9IZurO9lqdQg.png"/></div></div></figure><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="72bc" class="kn ko hi kj b fi kp kq l kr ks">prop=df.groupby('Property_Area')</span></pre><p id="0259" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将找到第一次出现的属性，下面的代码将告诉您如何做到这一点，但在此之前，我们将看到' Property_Area '属性的频率分布。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="6ac7" class="kn ko hi kj b fi kp kq l kr ks">df['Property_Area'].value_counts()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/432b14afd8c904d1a192e5ca7272d0fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKi8I-wfHLPrnJ1IUj50dw.png"/></div></div></figure><p id="c1c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们希望在数据集中找到第一个出现的Property_Area属性。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="efd3" class="kn ko hi kj b fi kp kq l kr ks">prop.first()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kv"><img src="../Images/0be8b5d1b9c0ea03b20357babceaebc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xsdxl25GJwEQVyJlwitooA.png"/></div></div></figure><p id="4013" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上表中，我们了解到applicant-Loan_ID=LP001924是数据集中第一个财产面积位于农村的申请人。同样，申请人Loan_ID=LP002537是数据集中的第一个申请人，其Property_Area位于农村</p><p id="62de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，我们可以找到最后出现的属性。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="7e91" class="kn ko hi kj b fi kp kq l kr ks">prop.last()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/d5e98901e7a30f1f510548085e123025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FFaSubVrOjpx0fLer2M32g.png"/></div></div></figure><p id="0808" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，有时我们需要从原始数据集中提取一个样本来研究它。下面的代码将向您展示使用groupby方法从大型数据集中提取所需样本是多么容易。我们将提取‘Property _ Area’为‘Urban’的行/观测值。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="d40a" class="kn ko hi kj b fi kp kq l kr ks">prop.get_group('Urban').head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/f16c4b166c706c9f7737cd00eb0c03a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ekwvJXXoakNy4Ms__e17Ng.png"/></div></div></figure><p id="0f8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们反复检查我们是否是真实的</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="5311" class="kn ko hi kj b fi kp kq l kr ks">df[df['Property_Area']=='urban'].head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/f4802747e28e316002627df9e7d5dc64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GW92tyZHP6K4Uiz-00IMGw.png"/></div></div></figure><p id="7570" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以上两个表都返回相同的一组观察值，所以我们是真实的。</p><p id="ed13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们要找到对应于属性的索引号行。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="85f4" class="kn ko hi kj b fi kp kq l kr ks">prop.groups</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/3c2cee5e3d056b0ef413c184d9794c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6_CvsOl6lLtLK9zy-qqPg.png"/></div></div></figure><p id="9a1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将寻找具有另一个特征的特定属性的数值变量的平均值</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="b43d" class="kn ko hi kj b fi kp kq l kr ks">prop.mean()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/f68ca5f90beb333d4c0d7b2871054276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q73-_bWWPoul-gUdrK-yew.png"/></div></div></figure><p id="140b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，上表给出了与农村、半城市和城市属性相对应的申请人的平均收入</p><p id="a5e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用groupby方法的数据可视化:- </strong></p><p id="811e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以借助groupby方法来可视化我们的数据。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="404b" class="kn ko hi kj b fi kp kq l kr ks">prop.size().sort_values(ascending=True).plot(kind='barh')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es la"><img src="../Images/d20ec78c63e47a6f9f061b9d957d9c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*PBfRBnOxJaobmzG-qgg9KQ.png"/></div></figure><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="3665" class="kn ko hi kj b fi kp kq l kr ks">prop[['ApplicantIncome','LoanAmount']].mean().plot(kind='bar')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/545095826e6a40de1c216d95c257918b.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*xa7VwaTe-g0m8mgEGsvXOw.png"/></div></figure><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="ae22" class="kn ko hi kj b fi kp kq l kr ks">prop['Loan_Status'].count().plot.pie(subplots=True)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lc"><img src="../Images/085f9e59e7ec4b54395878215b27e9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*eBUDAWOgExv_YymRbHG1BQ.png"/></div></figure><p id="951e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，这里我们可以看到来自半城市的申请人有更多的贷款批准。</p><p id="b409" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们只是做了一个属性区域的分组。现在，我们将了解如何对多个要素的数据进行分组</p><p id="3a79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">多重分组</strong> :-</p><p id="b2ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据特征“性别”和“属性_面积”对数据集进行分组。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="0eee" class="kn ko hi kj b fi kp kq l kr ks">prop=df.groupby(['Gender','Property_Area'])</span></pre><p id="4cf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们要根据'性别'来计算属性['农村'，'房产'，'半城市'，'城市']的出现频率。</p><p id="7c31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，正如我们在上面所做的，我们将根据属性计算['ApplicantIncome '，' CoapplicantIncome '，' LoanAmount']的总和。</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="8202" class="kn ko hi kj b fi kp kq l kr ks">prop.sum()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/ef13e8768bbba22219017ff9318876a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gklKzyBA17rY4lNGUAHnZw.png"/></div></div></figure><p id="1f82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将使用聚合函数对数据进行更多的统计计算</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="6ae2" class="kn ko hi kj b fi kp kq l kr ks">prop.agg({'LoanAmount':'mean','ApplicantIncome':'sum'})</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kv"><img src="../Images/f148c4616d77dd57fd3a785f6d3ac65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPJSKWkqCIbE4G-yjXAcCA.png"/></div></div></figure><p id="bd90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上表可以看出，LoanAmount一栏给出了女性申请人对应每个Property_Area的平均值。申请人收入一栏列出了与每个财产领域相对应的女性申请人的总收入。所以聚合函数以简单的表格形式给出复杂的数据，我们很容易理解。</p><p id="aa68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们已经研究了一些聚合函数，比如均值、众数和总和。它们对一组数据执行统计操作。浏览一下Pandas包中的所有集合函数:</p><ul class=""><li id="54ee" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc ld jz ka kb bi translated">count()-非空观察值的数量</li><li id="2ee6" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">Sum()-值的总和</li><li id="c5f3" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">Mean()-值的平均值</li><li id="dbf8" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">median()-数值的算术中值</li><li id="e891" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">min()-最小值</li><li id="8918" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">max() —最大值</li><li id="f3a9" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">mode() —模式</li><li id="a25f" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">std() —标准偏差</li><li id="02be" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc ld jz ka kb bi translated">var() —方差</li></ul><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="02eb" class="kn ko hi kj b fi kp kq l kr ks">prop.agg(['size','sum','mean'])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kv"><img src="../Images/9d64d692e8a867f28e7bf9991b65e4ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MjXP6jFR3OLF8TJgCK-znQ.png"/></div></div></figure><p id="ae16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，我们可以说Groupby方法对于捕捉对数据和模式的洞察非常有用。使用groupby方法，我们只需几行代码就可以从我们的数据集中获得有效且有影响力的见解。</p><p id="2ba6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢大家！</p><p id="20ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有任何疑问或想要更多的见解，请通过<a class="ae kh" href="https://www.linkedin.com/in/dhiraj-patil-analyst" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="c94b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">喜欢文章就鼓掌评论！</strong></p></div></div>    
</body>
</html>