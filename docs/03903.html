<html>
<head>
<title>A Visual Exploration of Weight Initialisation in Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络中权重初始化的可视化探索</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-visual-exploration-of-weight-initialisation-in-neural-networks-32c9736eec36?source=collection_archive---------24-----------------------#2020-02-24">https://medium.com/analytics-vidhya/a-visual-exploration-of-weight-initialisation-in-neural-networks-32c9736eec36?source=collection_archive---------24-----------------------#2020-02-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d8e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最近开始探索神经网络的视觉潜力，在这个过程中，我看到了大卫·哈令人着迷的<a class="ae jd" href="http://blog.otoro.net/archive.html" rel="noopener ugc nofollow" target="_blank">博客。</a></p><p id="ab8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在他的一篇<a class="ae jd" href="http://blog.otoro.net/2015/06/19/neural-network-generative-art/" rel="noopener ugc nofollow" target="_blank">帖子</a>中，他通过MLP传递每个像素的x，y坐标来创建一系列图像。输出到3个通道(每个像素的RGB)，他最终得到了这样的图像:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/ad062bff955da02947e469293cbbb41a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*svpZPtmDeIiWQKxiEylayg.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">从MLP生成的图像</figcaption></figure><p id="e6e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相当酷。</p><p id="cc7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我很想尝试自己实现它来生成一些这样的图片。因此，在PyTorch中，我将一个具有2个输入(标准化像素索引)、3个输出(RGB通道)和8个线性层(16个神经元)的MLP放在一起。</p><p id="f9bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击播放并..</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ju"><img src="../Images/17c4eadc63705567f3f9926d48f67f66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*7LffWxeChAvnEf7dFY-bmg.png"/></div></figure><p id="d8a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">瞧啊。一个灰色的斑点…嗯嗯…</p><p id="d358" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我花了太多时间检查我的代码是否有bug。我恍然大悟，默认情况下权重到底是怎么初始化的？</p><p id="62d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实证明PyTorch就是这么做的:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jv"><img src="../Images/e1792781c16fbc9ff05f50d4023a0037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmC-I4yNx8PFvomIWtrISQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">【https://pytorch.org/docs/stable/nn.html#linear-layers T4】</figcaption></figure><p id="056d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不会深入不同初始化方案的细节，因为有很多好的解释。但本质上，任何神经网络都只是一系列矩阵乘法。如果我们有很多这样的(一个“深”网络)，那么每一层的输出可以逐渐变得巨大或微小，它们的梯度也是如此(爆炸/消失)。这对于学习来说并不理想，解决这个问题的方法是通过权重初始化。</p><p id="8c3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，在这种情况下，我只是试图从一个单一的向前传球漂亮的图片。</p><p id="9ad5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看一些使用默认初始化的重量:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jw"><img src="../Images/726b9dfe65e8e5416ae664633734b906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0nuSvAJYloajUbFnO5zDEQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">使用默认初始化的前两个神经元的权重</figcaption></figure><p id="d236" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型的输出是:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jx"><img src="../Images/018832b6f0b6dbbc5a0f2f98c56a934a.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*zOzXk5iqnqd5veXYV7dz2g.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">6个像素的RGB值</figcaption></figure><p id="ca40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">难怪一切都是灰色的。</p><p id="f50f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们用一个标准的正态分布来初始化呢？</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jy"><img src="../Images/a4ef939cd2028308d6284c31ca728b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eakpiY1Vi_MLLSeVDcwwtg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">使用正态分布初始化的前两个神经元的权重</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jz"><img src="../Images/6bb07f29a3977a7263507b0d3c6cadd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*VP8a59LRFilgG-ABwRiCVw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">最终层的6个输出</figcaption></figure><p id="6666" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而结果…</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ka"><img src="../Images/00d6c6d64e5ce37d03fb0fbe2f4bb985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*WAkSBixcSxYJ4Yaj4XGdIA.png"/></div></figure><p id="9791" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哒哒！这还差不多。但是为什么所有的东西都穿过图像的中间呢？</p><p id="c667" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初我将偏差设置为0，因此每个神经元都必须经过原点。这只是像素指数归一化后的图像中点。</p><p id="d1c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个1.25的偏差</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kb"><img src="../Images/60883c2620597e9f177a71b68bc1af35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*cEghSUufO86JRupET380PQ.png"/></div></figure><p id="8d4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">20层16神经元</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kc"><img src="../Images/43e26ba107db79c95216d3c5696788f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*1FjPR8nS4rs2EtaP-IUg3w.png"/></div></figure><p id="2fd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8层48个神经元</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kd"><img src="../Images/09033650a4702c873e4831a656c81adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*wjLRmh6gy7DDpU35y7leBg.png"/></div></figure><p id="7a85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我应该提到，这些都使用双曲正切作为激活函数，因为它提供了更广泛的输出频谱。</p><p id="9a45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了比较，这里是乙状结肠和ReLU</p><div class="jf jg jh ji fd ab cb"><figure class="ke jj kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/8096fc6aff4523dc1ad44bd039f395f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*SHJE6my9ZQux-mTCqMg6FQ.png"/></div></figure><figure class="ke jj kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/2d6e1f8a6d37de0daac1bf081ffdffe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*V9TRiWABOJ3ZVe1cY_JeHw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx kk di kl km translated">Sigmoid(左)、ReLU(右)，图表显示了R输出通道的分布</figcaption></figure></div><p id="7a22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想修改的话，这是密码</p></div></div>    
</body>
</html>