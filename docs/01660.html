<html>
<head>
<title>Building a basic Search Engine using Elasticsearch &amp; fscrawler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Elasticsearch &amp; fscrawler构建一个基本的搜索引擎</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-basic-search-engine-using-elasticsearch-fscrawler-97104c1ea220?source=collection_archive---------0-----------------------#2019-11-07">https://medium.com/analytics-vidhya/building-a-basic-search-engine-using-elasticsearch-fscrawler-97104c1ea220?source=collection_archive---------0-----------------------#2019-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="edaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，最近我的公司需要建立一个搜索引擎，以便更容易地从过去的项目中获取信息。从本质上说，有一个巨大的信息宝库，以Powerpoint幻灯片和PDF文档的形式存储在多个平台上，如我们的共享驱动器、Confluence存储库等。搜索引擎将在以下方面有所帮助:</p><ul class=""><li id="9d4b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">支持通过单一门户访问各种信息源</li><li id="605e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">允许高级搜索功能帮助人们轻松解析信息</li></ul><p id="f387" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是我们将在本文中构建的搜索引擎的截屏。这里，很明显，我没有花太多时间来格式化最终的HTML页面，因为我只是想展示Elasticsearch和fscrawler以及Python和flask。</p><p id="4e78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">登陆页面</strong></p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/7ccde71f8f43e0c366052c185f318cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eZoqpY-bNbBXZQq0vNX5BA.png"/></div></div></figure><p id="b62f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结果页面</strong></p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kd"><img src="../Images/31eefd7f2d02104efc0d809e466a6eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7YYZm_n5hV5JX-bSJeY5xg.png"/></div></div></figure><p id="3a3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将展示如何在您自己的本地机器上使用以下代码运行快速而肮脏的搜索引擎:</p><ul class=""><li id="6ccf" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">fscrawler —代表文件系统爬网程序。顾名思义，它有助于索引pdf、MS Office等二进制文档。</li><li id="7a62" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">elastic search——elastic search是一个基于Lucene库的开源搜索引擎。它提供了全文搜索功能，并返回与模式无关的JSON文档</li><li id="c954" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">python——高级解释编程语言</li><li id="bad0" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Flask——Flask是一个用Python编写的微型web开发框架</li></ul><p id="7aad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始吧…</p><p id="fbf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置弹性搜索客户端</strong></p><ul class=""><li id="6748" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">Elasticsearch可以从<a class="ae ke" href="https://www.elastic.co/downloads/elasticsearch" rel="noopener ugc nofollow" target="_blank">这个位置</a>下载。然后将其提取到“搜索引擎”文件夹中</li><li id="3747" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">导航到终端中的安装位置。以下是我使用的位置:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="f145" class="kk kl hi kg b fi km kn l ko kp">cd C:\Users\risesh.bhutani\Desktop\Search Engine\elasticsearch-7.3.2</span></pre><ul class=""><li id="6142" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">接下来，在终端中输入以下命令来运行Elasticsearch:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="03a7" class="kk kl hi kg b fi km kn l ko kp">bin\elasticsearch.bat</span></pre><ul class=""><li id="80b0" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">要确认elasticsearch现在正在您的笔记本电脑上运行，您可以导航到<a class="ae ke" href="http://localhost:9200" rel="noopener ugc nofollow" target="_blank"> http://localhost:9200 </a>，这将显示有关elasticsearch模块的信息</li></ul><p id="28db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置fscrawler </strong></p><ul class=""><li id="1e3d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">我们需要做的第一件事是找到并安装fscrawler。在这里，我们要小心下载与我们的版本Elasticsearch兼容的正确版本fscrawler(你可以在<a class="ae ke" href="https://github.com/dadoonet/fscrawler" rel="noopener ugc nofollow" target="_blank"> this github页面</a>确认版本兼容性)。这里，我们将使用与Elasticsearch V7兼容的fscrawler 2.7。fscrawler安装文件可以在<a class="ae ke" href="https://fscrawler.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到，我们已经下载了一个稳定的压缩版本(fs crawler-es7–2.7–2019 09 27 . 070712–49)</li><li id="6849" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">下载完成后，解压缩文件并安装在首选位置。让我们在桌面上设置一个名为“搜索引擎”的文件夹，我将使用这个文件夹来提取fscrawler。</li><li id="a28d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">我还在“搜索引擎”中创建了另一个名为“样本文件”的文件夹。该文件夹包含我们希望能够搜索到的所有文件。就我而言，我刚刚从<a class="ae ke" href="http://www.gutenberg.org" rel="noopener ugc nofollow" target="_blank">www.gutenberg.org</a>下载了一些免费书籍的文本版本</li><li id="8ebd" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">接下来打开终端并导航到安装位置:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="d07b" class="kk kl hi kg b fi km kn l ko kp">cd C:\Users\risesh.bhutani\Desktop\Search Engine\fscrawler-es7–2.7-SNAPSHOT</span></pre><ul class=""><li id="d6de" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">现在，键入以下命令来运行fscrawler，创建一个名为<code class="du kq kr ks kg b">‘data_science_index’</code>的索引。这将运行一次并创建索引。我不需要它重复运行，因为这纯粹是为了演示目的。</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="8b0d" class="kk kl hi kg b fi km kn l ko kp">bin\fscrawler — config_dir ./DS data_science_index — loop 1</span></pre><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kt"><img src="../Images/35fce8fe233f33869a10c559f6c85154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LRYKhKaOOiZU2sheVyfgaA.png"/></div></div></figure><p id="57e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，导航到fscrawler安装位置&gt; DS &gt; data_science_index并打开' _settings '文件以执行以下步骤:</p><ul class=""><li id="cf3c" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">将url更改为您保存ppt和pdf文件的位置(“Sample_files”文件夹)—这告诉fscrawler它需要对“Sample_files”文件夹中的文件进行爬网</li><li id="ad4a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">保存并关闭设置文件</li><li id="15d7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">从步骤5开始在终端中重新运行该命令。此步骤为放置在“Sample_files”文件夹中的所有文件创建索引</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es ku"><img src="../Images/56b768c0febb85be6a0af112e61e6af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*N6mV4mMXCPBIJkg1f1BYpQ.png"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kv"><img src="../Images/b547ca691d1e2659d9678b5b4faef246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vMAZkYeNAlyhOaJaRJmXKA.png"/></div></div></figure><p id="cc98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置Python依赖关系</strong></p><p id="2493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在为python应用程序设置库:</p><p id="256a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开终端并运行以下命令</p><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="c796" class="kk kl hi kg b fi km kn l ko kp">python -m pip install flask</span><span id="6005" class="kk kl hi kg b fi kw kn l ko kp">python -m pip install Elasticsearch</span></pre><p id="a181" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置python代码</strong></p><ul class=""><li id="e20b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">让我们从构建python代码开始，该代码将定义我们将在搜索引擎中执行的操作和响应。我正在调用我的python脚本<code class="du kq kr ks kg b">‘Search_Engine_python.py’</code></li><li id="96e9" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">导入依赖项，如flask和elasticsearch:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="3171" class="kk kl hi kg b fi km kn l ko kp">from flask import Flask, render_template, request<br/>from elasticsearch import Elasticsearch<br/>import os</span></pre><ul class=""><li id="dcac" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">设置flask app和elasticsearch api连接:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="1eff" class="kk kl hi kg b fi km kn l ko kp">os.chdir(“C:\\Users\\risesh.bhutani\\Desktop\\Search Engine\\”)<br/>app = Flask(__name__)<br/>es = Elasticsearch(‘127.0.0.1’, port=9200)</span></pre><ul class=""><li id="2b98" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">点击URL时呈现主页:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="7ade" class="kk kl hi kg b fi km kn l ko kp"><a class="ae ke" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route(‘/’)<br/>def home():<br/> return render_template(‘search.html’)</span></pre><ul class=""><li id="5a27" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">接下来，定义请求搜索时的响应:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="beff" class="kk kl hi kg b fi km kn l ko kp"><a class="ae ke" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route(‘/search/results’, methods=[‘GET’,’POST’])<br/>def request_search():<br/> search_term = request.form[“input”]<br/> res = es.search(<br/> index=’data_science_index’,<br/> body={<br/> “query” : {“match”: {“content”: search_term}},<br/> “highlight” : {“pre_tags” : [“&lt;b&gt;”] , “post_tags” : [“&lt;/b&gt;”], “fields” : {“content”:{}}}})<br/> res[‘ST’]=search_term</span><span id="405b" class="kk kl hi kg b fi kw kn l ko kp">for hit in res[‘hits’][‘hits’]:<br/> hit[‘good_summary’]=’….’.join(hit[‘highlight’][‘content’][1:])<br/> return render_template(‘results.html’, res=res)</span></pre><p id="1c0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个步骤基本上定义了当网页请求搜索时会发生什么。</p><ol class=""><li id="54ad" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc kx jj jk jl bi translated">首先，使用请求库从网页中检索搜索词，并将其存储到名为“search_term”的变量中</li><li id="b76c" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kx jj jk jl bi translated">来自Elasticsearch的数据以JSON文件的形式接收。因此，使用Elasticsearch中定义的搜索方法，我们查询之前创建的‘data _ science _ index’来进行匹配。检索到的数据存储在名为“res”的字典中</li><li id="734f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kx jj jk jl bi translated">我们还从“highlight”键中提取了一些字段，因为这包含一个摘要，并且还向搜索词添加了一些格式化标签。这可以在我们的前端使用，以更好地格式化结果。</li><li id="2fd3" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kx jj jk jl bi translated">此外，我们还在“res”字典中为搜索词创建了另一个条目</li><li id="ba5a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kx jj jk jl bi translated">最后，我们对每次点击的摘要进行格式化，这可以在每次点击的<code class="du kq kr ks kg b">[‘highlight’][‘content’]</code>部分找到，以便于阅读</li><li id="0383" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kx jj jk jl bi translated">这个字典“res”被返回，名为<code class="du kq kr ks kg b">‘results.html’</code>的模板被呈现</li></ol><p id="8847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，在main()中运行应用程序:</p><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="d008" class="kk kl hi kg b fi km kn l ko kp">if __name__ == ‘__main__’:<br/> <!-- -->app.run(‘127.0.0.1’, debug=True)</span></pre><p id="f17a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置网页</strong></p><ul class=""><li id="589d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">让我们首先构建一些基本的网页来访问我们的搜索引擎并显示结果。</li><li id="4c13" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">名为“search.html”的登录页面是在“搜索引擎”文件夹中名为“模板”的文件夹中创建的</li><li id="2565" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">编写一些基本的html代码来格式化页面:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="9f53" class="kk kl hi kg b fi km kn l ko kp">&lt;!DOCTYPE html&gt;<br/>&lt;html lang=”en”&gt;<br/>&lt;head&gt;<br/> &lt;meta charset=”utf-8"&gt;<br/> &lt;link rel=”stylesheet” href=”<a class="ae ke" href="https://fonts.googleapis.com/css?family=Pacifico" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/css?family=Pacifico</a>"&gt;<br/> &lt;link rel=”icon” href=”<a class="ae ke" href="http://obj-cache.cloud.ruanbekker.com/favicon.ico" rel="noopener ugc nofollow" target="_blank">http://obj-cache.cloud.ruanbekker.com/favicon.ico</a>"&gt;<br/> &lt;link href=”//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css” rel=”stylesheet”&gt;<br/> &lt;title&gt;Knowledge Repository Search&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/> &lt;br/&gt; &lt;br/&gt;<br/> &lt;div class=”container”&gt;<br/> &lt;div style=”background:transparent !important” class=”jumbotron”&gt;<br/> &lt;div style=”font-family: ‘Times New Roman’”&gt;<br/> &lt;p&gt;<br/> &lt;center&gt;<br/> &lt;font size=”6" style=”color:rgb(239,127,26);”&gt; &lt;br/&gt;KNOWLEDGE REPOSITORY SEARCH&lt;/font&gt;<br/> &lt;/center&gt;<br/> &lt;/p&gt;<br/> &lt;/div&gt;<br/> &lt;/div&gt;</span></pre><ul class=""><li id="0823" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">现在，创建一个带有输入文本框和搜索按钮的基本表单。这就完成了我们的登录页面:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="7456" class="kk kl hi kg b fi km kn l ko kp">&lt;form action=”/search/results” method=”post”&gt;<br/> &lt;div class=”input-group”&gt;<br/> &lt;input type=”text” class=”form-control input-lg” name=”input” placeholder=”Search” autofocus&gt;<br/> &lt;div class=”input-group-btn”&gt;<br/> &lt;button class=”btn btn-primary btn-lg” type=”submit”&gt;<br/> &lt;i class=”glyphicon glyphicon-search”&gt;&lt;/i&gt;<br/> &lt;/button&gt;<br/> &lt;/div&gt;<br/> &lt;/div&gt;<br/> &lt;/form&gt;</span><span id="a689" class="kk kl hi kg b fi kw kn l ko kp">&lt;br&gt;&lt;br&gt;<br/> <br/> &lt;/div&gt;<br/> &lt;/div&gt;<br/> &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><ul class=""><li id="b67b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">现在，对于名为“results.html”的搜索结果页面。</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="9772" class="kk kl hi kg b fi km kn l ko kp">&lt;!DOCTYPE html&gt;<br/>&lt;html lang=”en”&gt;<br/> &lt;head&gt;</span><span id="2b58" class="kk kl hi kg b fi kw kn l ko kp">&lt;meta charset=”utf-8"&gt;<br/> &lt;link rel=”stylesheet” href=”<a class="ae ke" href="https://fonts.googleapis.com/css?family=Pacifico" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/css?family=Pacifico</a>"&gt;<br/> &lt;link rel=”icon” href=”<a class="ae ke" href="http://obj-cache.cloud.ruanbekker.com/favicon.ico" rel="noopener ugc nofollow" target="_blank">http://obj-cache.cloud.ruanbekker.com/favicon.ico</a>"&gt;<br/> &lt;link href=”//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css” rel=”stylesheet”&gt;</span><span id="2409" class="kk kl hi kg b fi kw kn l ko kp">&lt;title&gt;Knowledge Repository Search&lt;/title&gt;<br/> &lt;/head&gt;</span></pre><ul class=""><li id="4ccc" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">在结果页面上重新呈现搜索栏和标题:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="4659" class="kk kl hi kg b fi km kn l ko kp">&lt;div class=”container”&gt;<br/> &lt;div style=”background:transparent !important” class=”jumbotron”&gt;<br/> &lt;div style=”font-family: ‘Times New Roman’”&gt;<br/> &lt;p&gt;<br/> &lt;center&gt;<br/> &lt;font size=”6" style=”color:rgb(239,127,26);”&gt; <br/> KNOWLEDGE REPOSITORY SEARCH&lt;/font&gt;<br/> &lt;/center&gt;<br/> &lt;/p&gt;<br/> &lt;/div&gt;<br/> &lt;/div&gt;</span><span id="a07c" class="kk kl hi kg b fi kw kn l ko kp">&lt;form action=”/search/results” method=”post”&gt;<br/> &lt;div class=”input-group”&gt;<br/> &lt;input type=”text” class=”form-control input-lg” name=”input” placeholder=”Search” autofocus&gt;<br/> &lt;div class=”input-group-btn”&gt;<br/> &lt;button class=”btn btn-primary btn-lg” type=”submit”&gt;<br/> &lt;i class=”glyphicon glyphicon-search”&gt;&lt;/i&gt;<br/> &lt;/button&gt;<br/> &lt;/div&gt;<br/> &lt;/div&gt;<br/> &lt;/form&gt;</span></pre><ul class=""><li id="1f1e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">使用Jinja(python的web模板引擎)访问res字典的元素，并构建一个表结构:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="d43c" class="kk kl hi kg b fi km kn l ko kp">&lt;center&gt;<br/> &lt;br/&gt; &lt;h3&gt;{{ res[‘hits’][‘total’][‘value’] }} results found for &lt;em&gt;”{{res[‘ST’]}}” &lt;/em&gt; &lt;/h3&gt;<br/> &lt;/center&gt;<br/> &lt;br/&gt;</span><span id="3874" class="kk kl hi kg b fi kw kn l ko kp">&lt;table class=”table”&gt;<br/> &lt;thead&gt;<br/> &lt;tr&gt;<br/> &lt;th&gt;File Name&lt;/th&gt;<br/> &lt;th&gt;Link&lt;/th&gt;<br/> &lt;th&gt;Summary&lt;/th&gt; <br/> &lt;th&gt;Score&lt;/th&gt;<br/> &lt;/tr&gt;<br/> &lt;/thead&gt;</span></pre><ul class=""><li id="2bcd" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">现在，通过使用Jinja遍历<code class="du kq kr ks kg b">‘Res’</code>中的数据来填充表格:</li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="ade4" class="kk kl hi kg b fi km kn l ko kp">{% for hit in res[‘hits’][‘hits’] %}</span><span id="a1cb" class="kk kl hi kg b fi kw kn l ko kp">&lt;tbody&gt;<br/> &lt;tr&gt;<br/> &lt;th scope=”row”&gt;{{ hit[‘_source’][‘file’][‘filename’] }}&lt;/th&gt;<br/> &lt;td&gt;&lt;a href=”{{ hit[‘_source’][‘file’][‘url’] }}”&gt;{{ hit[‘_source’][‘file’][‘filename’] }}&lt;/a&gt;&lt;/td&gt;<br/> &lt;td id=”{{loop.index}}” name=”goodSummary”&gt; {{ hit[‘good_summary’]}} &lt;/td&gt; <br/> &lt;td&gt;{{ hit[‘_score’] }}&lt;/td&gt;<br/> &lt;/tr&gt;<br/> &lt;/tbody&gt;<br/>{% endfor %}</span><span id="ed1b" class="kk kl hi kg b fi kw kn l ko kp">&lt;/table&gt;</span><span id="e9fd" class="kk kl hi kg b fi kw kn l ko kp">&lt;/div&gt;<br/> &lt;/div&gt;<br/> &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="b4c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，注意第三个元素被命名为goodSummary。这是因为我们希望使用Javascript重新呈现这一部分，以确保文本中出现的高亮标记不会被视为常规文本。</p><ul class=""><li id="d2f8" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">将以下代码段添加到results.html代码的头部分之后和正文部分之前。这基本上将文本转换成innerHTML格式。代码的最后一行运行Javascript函数<code class="du kq kr ks kg b">populateText()</code></li></ul><pre class="js jt ju jv fd kf kg kh ki aw kj bi"><span id="0734" class="kk kl hi kg b fi km kn l ko kp">&lt;script language=”Javascript”&gt;<br/> function populateText() {<br/> var data = document.getElementsByName(“goodSummary”);<br/> for (const item of data) {<br/> item.innerHTML = item.textContent<br/> }<br/> }<br/>&lt;/script&gt;</span><span id="0885" class="kk kl hi kg b fi kw kn l ko kp">&lt;body onload=”populateText()”&gt;</span></pre><p id="b254" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查看结果</strong></p><p id="1e9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们完成了构建。打开浏览器并导航至<a class="ae ke" href="http://127.0.0.1:5000" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000 </a>，这将打开“search.html”页面。进行的任何搜索都会在“results.html”页面中显示结果。希望你能够跟随并为自己建立一个令人敬畏的搜索引擎。编码快乐！</p></div></div>    
</body>
</html>