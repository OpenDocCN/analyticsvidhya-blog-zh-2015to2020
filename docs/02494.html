<html>
<head>
<title>Active Learning… Learning with the model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">主动学习…用模型学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/active-learning-learning-with-the-model-5727d2474a90?source=collection_archive---------10-----------------------#2019-12-19">https://medium.com/analytics-vidhya/active-learning-learning-with-the-model-5727d2474a90?source=collection_archive---------10-----------------------#2019-12-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e2b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好！！我花了一些时间来张贴，但我在这里又一个令人兴奋的话题。这极大地帮助了我处理我在模型训练中面临的数据注释问题，所以我决定与你们分享它。</p><p id="801c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数时候，每当我们开始构建深度学习模型时，我们都会陷入获得标记数据的困境。我们有大量的数据，但缺乏标记数据。这导致出现了许多像understand.ai这样的初创公司，它们为你做数据标注。现在这肯定是有用的，但是如果你不能把你的数据外包给他们呢？？</p><p id="507e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们进行模型开发时，我们需要一个方便的解决方案。于是主动学习就来了。主动学习是一种半监督学习，我们有效地选择最重要的数据点，这些数据点可以有效地代表完整的人口分布。因此，除了模型的可信度，我们还可以检查数据的相似性。这种方法极大地减少了模型训练所需的注释数据量。类似于最大模型性能的最小数据利用。</p><p id="1719" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这也可以被不同地视为采样。随机抽样是一种挑选出数据子集并进行分析的方法，假设它是整个数据集的良好代表。主动学习是更好的智能选择数据的方式。</p><p id="ab4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">主动学习</strong></p><p id="805a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该过程可分为以下步骤:</p><ul class=""><li id="51a2" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">初始的一组最小数据点被标记，用于第一轮模型训练。因此，在每一轮训练之后，将产生当前模型(θ)。</li><li id="f541" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">该当前模型(θ)用于评估包含在剩余未标记数据点中的信息。使用一种查询选择策略，选择最具信息量的数据点。模型对这些数据点最为困惑。查询选择策略的一个例子是在训练模型的分类阶段预测的概率值。我们将在本主题中进一步讨论各种查询选择策略。</li><li id="1b92" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">然后，这些混淆数据点的标签由Oracle手动获取。</li><li id="71a4" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">然后将标记的例子包括在训练数据中，并且使用新的训练数据集重新训练该模型。</li><li id="dd79" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">这个过程一直重复，直到我们没有预算来获得标签，或者我们不再能看到模型性能的持续改进。</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/2f0a19b2db6f58fd100531c75b39bede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SunmFQmVYwTfh1Dqkfp2BA.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">上述步骤可以浓缩在这个流程图中，这个流程图代表了人工智能的迭代过程</figcaption></figure><p id="e217" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询策略</strong></p><p id="7015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">不确定性采样</strong>是用于查询选择策略的最简单和默认的技术。有两种使用方法。</p><ul class=""><li id="0cc8" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">根据当前模型(θ)与分离超平面的距离，选择当前模型(θ)最不确定的数据点。预测超平面，使得支持向量(最接近超平面的点)尽可能远离它。如果该点非常接近超平面，那么这意味着区别不是非常明确。</li></ul><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">靠近直线的点是最容易混淆的点。基于点与超平面轨迹2的距离，选择最接近它的点，并为进一步的训练进行注释。</figcaption></figure><ul class=""><li id="f91d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">使用模型预测的标签概率P( θ)选择数据点。假设对于一个分类问题，如果模型已经预测了概率为[0.2，0.3，0.5]的类别。这里我们可以清楚地看到，虽然预测可以是第三类，但区别不是很明显。这些数据点可用于手动标记。这些概率值的含义表明，该数据点包含模型以前没有遇到过的特征，并且根据当前学习的特征，模型不能决定该数据点的实际类别。</li></ul><p id="b98f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不确定性采样的主要问题是，它可能认为一个异常值可能是一个信息数据点。这些数据点没有帮助，而且经常误导模型。</p><p id="b71f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个查询选择策略是检查<strong class="ih hj">预期模型变化</strong>。在这里，我们选择数据点，其包含带来模型性能的最大变化。</p><p id="f519" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一种这样的技术是<strong class="ih hj">密度重量年龄检查。</strong>在这里，我们通过测量数据点与整个未标记样本池的平均相似性来检查数据点的信息量权重。通过使用这种方法，异常值可能不会获得很大的权重，因为它与其余的数据点高度不相似。</p><p id="506f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用了python中的主动学习库<a class="ae kj" href="https://github.com/modAL-python/modAL" rel="noopener ugc nofollow" target="_blank">model</a>进行编程。python中还有其他库，如ALiPy。具有145个数据点的iris数据集用于解释如果我们明智地选择它们，我们如何能够用最少的数据点获得接近最佳的精度。这里，我们从训练集中的最初5个数据点开始，执行10次迭代，找到模型最容易混淆的点，并在该点上进一步训练它。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">性能图，其中x轴代表列车组大小，y轴代表模型精度</figcaption></figure><p id="c799" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在每次迭代中，一个数据点被添加到训练集中。我们可以清楚地看到，在第7次迭代之后，<br/>初始(5) + 7(每次迭代一个数据)= 12个数据点<br/>，我们能够达到大约98%的准确度。这里我用概率得分来寻找最容易混淆的数据点。你可以在这里找到这个练习<a class="ae kj" href="https://github.com/anjana7/Active-Learning/blob/master/Active%20Learning%20-%20Iris%20Demo.ipynb" rel="noopener ugc nofollow" target="_blank">的GitHub代码。</a></p><p id="6c98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初的<a class="ae kj" href="https://arxiv.org/abs/1909.03585" rel="noopener ugc nofollow" target="_blank">关于<a class="ae kj" href="https://paperswithcode.com/paper/modal-a-modular-active-learning-framework-for" rel="noopener ugc nofollow" target="_blank">主动学习</a>的论文</a>说，每次训练后，只有被神谕标记的混淆点会被添加到训练集中。主动学习的一个增强是<strong class="ih hj">合作学习</strong>，如果我们得到一个具有很高可信度标签的数据点属于一个预测的类别，我们就接受它。我们将此数据点添加到我们的训练集，并将其预测作为其真实标签。因此，除了oracle标记的点之外，高置信度预测点也被添加到训练集中。</p><p id="6566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在每个硬币都有两面。主动学习也有它自己的问题。一个这样的例子是异常检测问题。假设我们想要标记用于识别垃圾邮件的数据点。在这种情况下，AL将不起作用，因为垃圾邮件将是离群值。</p><p id="87b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在某些情况下，主动学习的样本有可能不代表潜在的群体分布。但对于其他人来说，这是一种方便的技术，可用于在我们的模型构建过程中进行有效的采样和智能数据标记。</p><p id="9d2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">非常感谢！！！通读这篇文章。希望对大家有帮助。一定要试试Jordan的这个YouTube <a class="ae kj" href="https://www.youtube.com/watch?v=8Jwp4_WbRio" rel="noopener ugc nofollow" target="_blank">链接</a>进行主动学习。</p></div></div>    
</body>
</html>