<html>
<head>
<title>Solving “Titanic: Machine Learning from Disaster” using Neural Networks and Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用神经网络和张量流解决“泰坦尼克号:灾难中的机器学习”</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/solving-titanic-machine-learning-from-disaster-using-neural-networks-and-tensorflow-2abade61994a?source=collection_archive---------6-----------------------#2020-05-18">https://medium.com/analytics-vidhya/solving-titanic-machine-learning-from-disaster-using-neural-networks-and-tensorflow-2abade61994a?source=collection_archive---------6-----------------------#2020-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/a5e7bab44c8907adfe7e21342284ba62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*wKmr2Sffqkr9FimI.gif"/></div><figcaption class="im in et er es io ip bd b be z dx translated">杰克对罗斯说使用张量流=)</figcaption></figure><p id="e27b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">《泰坦尼克号:机器从灾难中学习》</em> </strong>是机器学习初学者的经典问题。</p><p id="96cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">挑战在于根据一组训练数据来预测哪些人会在灾难中幸存，哪些人不会。显然，这只是一个挑战，试图发现幸存者和非幸存者特征之间的相关性，并利用它进行预测。</p><p id="370c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不过事不宜迟，还是解决吧！</p><h1 id="1348" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">开头</strong></h1><p id="5138" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">当你从Kaggle下载数据时，他们提供了两个数据集。</p><p id="8c80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个对应于训练，用数据来训练你的模型，这个数据集已经有了谁幸存谁不幸存的答案。在你问我之前，我不知道这是不是真的。</p><p id="480c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是我们在这个数据上有些问题…</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/77d5f8e68887f6c5a05a8858856aca24.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/0*aF7XRizN9CFij6cK.gif"/></div><figcaption class="im in et er es io ip bd b be z dx translated">可视化数据后的我…</figcaption></figure><p id="fdfc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一个问题是:我们对于这个问题的数据很少。训练数据集只有891个例子。但是这并不意味着我们不能解决问题！</p><p id="12ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些数据有一些不一致，所以我们需要解决让任何数据科学家的工作变得更糟的问题。</p><h1 id="9445" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">调整数据并解决不一致性</strong></h1><p id="e961" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我将继续这些数据的问题，以及我们如何解决它，这篇文章的重点是建立一个模型，谁来解决我们的问题。</p><p id="2edd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一个问题是数据集中存在的字符串数据，但这很容易解决。字符串数据位于“名称”和“票证”列中，如下图所示:</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kx"><img src="../Images/cfc5bd4b2864ec0efde02c93026c5b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_iR_oI_0XK0dPswi9FbGsg.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">资料组</figcaption></figure><p id="65ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于这个问题，我们有很多解决方案，但最简单的是删除这些列，因为它们对我们的模型不太重要。</p><p id="d1ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">删除这些列后，我们必须处理缺失的数据。</p><p id="9f59" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了识别缺失的数据，可以将<strong class="is hj"> <em class="jo"> Seaborn和Matplotlib </em> </strong>与<strong class="is hj"> <em class="jo"> HeatMap </em> </strong>图配合使用，以便更好地可视化。</p><pre class="kt ku kv kw fd lc ld le lf aw lg bi"><span id="d673" class="lh jq hi ld b fi li lj l lk ll">plt.figure(figsize=(12, 6))</span><span id="c6b8" class="lh jq hi ld b fi lm lj l lk ll">sns.heatmap(train.isnull(), yticklabels=False, cbar=False, cmap='viridis')</span></pre><p id="dc54" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在定位缺失数据后，我们有两种常见的解决方案:</p><p id="5bf4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo"> 1-删除缺少数据的行(注意！).</em> </strong></p><p id="c0ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果是一个数字数据，比如年龄或类似的东西，我们可以用所有其他数据的平均值来填充数据。T25】</p><p id="90b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以为您的问题选择最佳解决方案，但我真的推荐第二个，因为您不会丢失对您的模型有用的数据。</p><p id="fc81" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上这是训练数据集的问题！</p><p id="7bc4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是别担心，我给你准备了一个惊喜…</p><p id="d0a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个项目的存储库中，我将把已经格式化的数据输入到我们的模型中！</p><p id="a925" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们解决了你问题中最糟糕的部分。<strong class="is hj">该做机器学习了，宝贝！</strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/6ccf55d34b9c09a18823c29b1164e659.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*B7IvpR5zoCILzRrV.gif"/></div><figcaption class="im in et er es io ip bd b be z dx translated">我格式化所有数据后，准备建立我的模型</figcaption></figure><h1 id="3a49" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak"> <em class="lo">建立模型</em> </strong></h1><p id="c2d8" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">对于这个问题，就像你在标题中看到的，我们将使用<strong class="is hj"> <em class="jo">神经网络</em> </strong>和<strong class="is hj"> <em class="jo"> Tensorflow </em> </strong>。</p><p id="a22c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将数据分成75%用于训练，25%用于测试。我们在这里使用神经网络，我们需要尽可能多的数据，但减少太多的测试数据会导致我们的模型性能不佳。</p><p id="826b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的模型将有4层，其中:</p><ul class=""><li id="11e7" class="lp lq hi is b it iu ix iy jb lr jf ls jj lt jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">输入图层将一个</em> </strong> <a class="ae ly" href="https://www.mathworks.com/help/deeplearning/ref/nnet.cnn.layer.flattenlayer.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> <em class="jo">图层展平</em> </strong> </a> <strong class="is hj"> <em class="jo">。</em> </strong></li><li id="717c" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">这2个隐藏层，每层有32个神经元，会随着R的密集</em></strong><a class="ae ly" href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="jo">elu</em></strong></a><strong class="is hj"><em class="jo">激活。</em> </strong></li><li id="02f3" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">输出层将被密集的</em></strong><a class="ae ly" href="https://machinelearningmastery.com/logistic-regression-for-machine-learning/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="jo"/></strong></a><strong class="is hj"><em class="jo">激活。</em>T49】</strong></li></ul><p id="c699" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在构建我们的模型之后，我们将用以下代码编译它:</p><ul class=""><li id="ec1c" class="lp lq hi is b it iu ix iy jb lr jf ls jj lt jn lu lv lw lx bi translated"><a class="ae ly" href="https://towardsdatascience.com/understanding-binary-cross-entropy-log-loss-a-visual-explanation-a3ac6025181a" rel="noopener" target="_blank"> <strong class="is hj"> <em class="jo">二元交叉熵</em> </strong> </a> <strong class="is hj"> <em class="jo">损失函数。</em>T59】</strong></li><li id="88fd" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><a class="ae ly" href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> <em class="jo">亚当优化器</em> </strong> </a> <strong class="is hj"> <em class="jo">。</em> </strong></li><li id="2118" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">以准确度为主要衡量标准。</em>T73】</strong></li></ul><p id="1215" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，是时候训练我们的模型了！</p><p id="8797" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于这些模型，我使用了以下参数:</p><ul class=""><li id="6fd5" class="lp lq hi is b it iu ix iy jb lr jf ls jj lt jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo"> 150个时代</em> </strong></li><li id="6eed" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj">批量<em class="jo">15</em>批量</strong></li></ul><p id="074b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">训练完模型后，结果不会太有传染性…</p><p id="ebaa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过这些参数，模型在测试数据集中制定了以下指标:</p><ul class=""><li id="21a0" class="lp lq hi is b it iu ix iy jb lr jf ls jj lt jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">精度0.7578</em></strong></li><li id="7c50" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo"> 0.5041损失</em> </strong></li></ul><p id="1a68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个损失太大了，但是不要担心，我们有很多方法来改善它！</p><h1 id="83df" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我们如何改进它？</h1><p id="1b1a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">造成这一结果的原因不仅仅是我们选择的参数，而是一个主要问题。</p><p id="e5b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们正在使用<strong class="is hj"> <em class="jo">神经网络</em> </strong>，我们需要更多的数据来追赶惊人的结果！</p><p id="ad67" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">神经网络</em> </strong>如此强大，但相比其他算法需要大量数据。</p><p id="aedb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是这并不意味着这个问题不能用神经网络来解决。我们可以通过改变参数来改善这些结果。而在这里，我给你最好的建议，用一个简单的字来恢复:<strong class="is hj"> <em class="jo">考！</em>T11】</strong></p><p id="9edb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面，我列举了一些可以改进模型的变化:</p><ul class=""><li id="ab70" class="lp lq hi is b it iu ix iy jb lr jf ls jj lt jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">减少测试数据的例子来使用到模型的训练中。</em>T15】</strong></li><li id="6c34" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">增加列车运行过程中的批次数量。</em>T19】</strong></li><li id="f353" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">增加训练过程中的历元数(这可能导致过拟合！).</em> </strong></li><li id="0ddc" class="lp lq hi is b it lz ix ma jb mb jf mc jj md jn lu lv lw lx bi translated"><strong class="is hj"> <em class="jo">改变模型的架构。</em> </strong></li></ul><p id="d294" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样可以改进你的模型，产生更好的结果，比如我在这个问题中使用NN的最好损失是0.37。但是天空才是极限！</p><h1 id="1290" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">一些附加信息</h1><p id="5fb4" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">对于你有一个小数据集，<strong class="is hj"> <em class="jo">少于5000个例子</em> </strong>的问题，我真的推荐使用其他算法，像逻辑回归(我在这个挑战中用过，你可以在这里查一下<a class="ae ly" href="https://github.com/gabrielmayers/kaggle_titanic-logistic_regression" rel="noopener ugc nofollow" target="_blank"/>)或者随机树森林，它们可以比神经网络表现的更好。</p><p id="8d61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于这个具体的问题和解决方案，我个人建议试验一个多选项的参数来改进模型！</p><p id="ff05" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以在<a class="ae ly" href="https://github.com/gabrielmayers/kaggle_titanic-neural_networks" rel="noopener ugc nofollow" target="_blank">这里</a>访问这个项目的资源库。</p><p id="199b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目前，这就是全部！</p><p id="57ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下次见！</p><p id="dae5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">我的社交媒体:</em> </strong></p><p id="86de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">领英:</em></strong><em class="jo"/><a class="ae ly" href="https://www.linkedin.com/in/gabriel-mayer-779b5a162/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/gabriel-mayer-779b5a162/</a></p><p id="e816" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="jo">GitHub:</em></strong><a class="ae ly" href="https://github.com/gabrielmayers" rel="noopener ugc nofollow" target="_blank">https://github.com/gabrielmayers</a></p><p id="37d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="jo">Instagram:</em></strong><a class="ae ly" href="https://www.instagram.com/gabrielmayerl/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/gabrielmayerl/</a></p></div></div>    
</body>
</html>