<html>
<head>
<title>Generators in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的生成器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/generators-in-python-5ed2d5803af?source=collection_archive---------19-----------------------#2020-10-20">https://medium.com/analytics-vidhya/generators-in-python-5ed2d5803af?source=collection_archive---------19-----------------------#2020-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/085f37ffde3f10686f74697213ab5ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vVBZKHJK7BBZyUo5HFrcbg.jpeg"/></div></div></figure><p id="7e19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Python通常被认为是“懒惰”的编程语言，因为它有大量程序员友好的、开箱即用的函数。几个<em class="jo">导入</em>命令，我们就准备好了，用我们能找到的最简单的语法武装起来。</p><p id="ccad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是为什么开始使用Python编程的程序员很难切换到任何其他编译语言的原因，也是为什么人们普遍认为:</p><blockquote class="jp jq jr"><p id="6f51" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">一次是Python程序员，永远是Python程序员</p></blockquote><p id="cb5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，遵循既定的传统，我们打算展示另一种“懒惰”但有用的高级Python技术。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="78e5" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">迭代器vs生成器</strong></h1><p id="9b74" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">迭代器可以定义为一个具有有限数量的值的对象，可以使用循环对其进行迭代。Python中内置的迭代器有list、tuple、set和dict。</p><p id="ef53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简单地说，生成器是一个返回可以迭代的对象的函数，但它并不完全是迭代器。它们以一种特殊的方式在对象中生成一个项，并且只在被请求时才这样做。<strong class="is hj">他们一次生成一个项目。</strong></p><p id="0111" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">生成器一次只处理一项，这使得它们的内存效率比迭代器高得多，迭代器将整组值存储在内存中，尤其是当涉及大量数据时。</p><p id="8700" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们甚至可以在所有元素生成之前就开始使用生成器。</p><p id="5127" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它们很容易实现，但是有点棘手，很难掌握。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="42cd" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">实现</strong></h1><p id="c984" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">生成器的定义就像一个普通的函数，但有一点不同。它涉及到使用<strong class="is hj"><em class="jo">yield</em></strong><em class="jo"/>关键字代替<strong class="is hj"> <em class="jo"> return。虽然它们的工作方式几乎完全相同，但如果互换使用，那就大错特错了。</em></strong></p><p id="bb31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo"> yield </em> </strong>语句暂停函数的执行，并向调用者返回值，记住函数的最后状态，这与<strong class="is hj"> <em class="jo"> return </em> </strong>不同，后者在被调用时会将函数从调用堆栈中移除，从而使其不再存在，直到再次被调用。</p><p id="0a32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们让发电机和大脑发挥作用。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/183cc40035353cd68304126c06d4dd9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDsKH-bmSn7fV9AD44cDZQ.png"/></div></div></figure><p id="7b39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以使用for循环一次访问所有元素，或者使用next()方法一次访问一个元素。请注意，如果生成器对象在最后一个元素处遇到next()调用，它将抛出一个<em class="jo"> StopIteration </em>。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/4a4b03a4eb2d20f37560c1ca62c6312a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoDFhQicCoy-6CW_At0vCA.png"/></div></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/931906ac94325e8dfa65c4229df59e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M9UYDUmkQMDKHe6w3L8p0w.png"/></div></div></figure><p id="cad6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">sum()和sorted()等内置方法可以很好地处理生成器对象。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/b2cf34f1ad5b0c132330997d791cc7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ik_SNM4kTt7pGRei-O7jpA.png"/></div></div></figure><p id="5134" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用生成器创建斐波那契数列，</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/3c1fdfc34068cb7709b99125c6c0bd2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-iouE8U5Il6twV-iy0XcA.png"/></div></div></figure><p id="ff11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们也有一个创建生成器对象的简写方法，它几乎类似于list comprehension，唯一的区别是使用了圆括号而不是方括号。</p><blockquote class="jp jq jr"><p id="7617" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">my_generator = (i for i in range(100))</p><p id="75f7" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">my_list = [i for i in range(100)]</p></blockquote><p id="5d8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对什么是发电机以及如何使用发电机有了一个概念后，我们继续讨论它的优点。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="a08b" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">为什么是发电机？</strong></h1><p id="0071" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">与简单的迭代器相比，比如说一个列表，生成器大大减少了内存占用，提高了可伸缩性，并使我们的程序对最终用户的响应更快。</p><p id="ea39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，如上所述，我们不需要等待生成器生成所有项目，就可以开始使用它。</p><p id="f7e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看生成器对象为我们节省内存的规模，</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/d97cddbcd64e39beaa93200bb7752f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*271slz9M3oDpRTm_1lKQgA.png"/></div></div></figure><p id="7448" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于相对较小的生成器和列表对象，我们看到使用的内存量有很大的不同，生成器对象消耗的内存要少得多。当使用生成器而不是列表时，节省的内存量增加了许多倍，并且项目的数量非常大。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/8d03c41944da689739aa7071fd3ea3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dUEK2lsNo22Dla-KPR5Jtw.png"/></div></div></figure></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="4513" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">到目前为止我们学到了什么… </strong></h1><ul class=""><li id="fad5" class="lq lr hi is b it la ix lb jb ls jf lt jj lu jn lv lw lx ly bi translated">生成器是可以迭代的对象。它们一次生成一个元素。</li><li id="8378" class="lq lr hi is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly bi translated">我们只能对一个生成器对象迭代一次，它会记住它的位置并从那个位置开始。这有时会导致意想不到的错误，所以我们在使用它们时必须小心。</li></ul><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/1ceca565e7505cc59d8b3954eb110922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QdVFxleL3IymN7QmV0LOQ.png"/></div></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">生成了两个元素，因此sum()方法从生成器的当前位置(3)计算总和，给出了一个意外的结果。</figcaption></figure><ul class=""><li id="309b" class="lq lr hi is b it iu ix iy jb mj jf mk jj ml jn lv lw lx ly bi translated">生成器的内存效率很高，无论要生成多少项，都消耗相同的内存。</li><li id="9a1d" class="lq lr hi is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly bi translated">发电机是用与<strong class="is hj">关联的<em class="jo">语句产生</em>而不是<strong class="is hj"> <em class="jo">返回。</em> </strong>虽然功能相似，但一定不能互换使用。</strong></li><li id="4cc6" class="lq lr hi is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly bi translated">尤其在处理大量项目时，应首选发电机。</li></ul></div></div>    
</body>
</html>