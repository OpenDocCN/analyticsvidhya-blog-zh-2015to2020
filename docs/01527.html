<html>
<head>
<title>Does Transforming Data Differently Affect Clustering?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">转换数据对聚类有不同的影响吗？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/does-transforming-data-differently-affect-clustering-9ace230f54b?source=collection_archive---------3-----------------------#2019-10-29">https://medium.com/analytics-vidhya/does-transforming-data-differently-affect-clustering-9ace230f54b?source=collection_archive---------3-----------------------#2019-10-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ed4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可能会偶然发现各种机器学习模型，这些模型无法对数据集进行有意义的洞察。或者，我们可能会发现自己在参加在线ML挑战时，RMSE(均方根误差)不能再下降了。然后专家来了，分析数据并建议转换数据。(嗯…大部分时间:)。</p><p id="2d4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在深入探讨我希望您采取的措施之前，让我们先来看看转型的重要性。</p><blockquote class="jd je jf"><p id="009b" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">"变化是不可避免的，但是转变是通过有意识的选择."</p><p id="b8dc" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> —希瑟·阿什·阿马拉</strong></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/80ca78d3d03f772fe9c38b0e5dcd4b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_n6d5yzkIdtJZE_765LgQ.jpeg"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">变压器</figcaption></figure><h1 id="123a" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">为什么要转换数据？</h1><p id="2751" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">转型并不能保证提高绩效，但通常会有所帮助。</p><p id="6a1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我问你这个…假设你有只有两个特征的房子的数据，即房间数量和房价。增加一个单元房会使房子贵1美元吗？还是反过来？不。因为他们有不同的规模和单位。机器学习模型往往偏向于具有更大幅度和方差的特征，即房价。因此，模型不能像预期的那样正确地学习其他特征。</p><p id="6934" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，高幅度值需要大存储和高计算能力，导致训练周期长。</p><p id="7697" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对测试数据缺乏洞察力和准确性低是它的一些常见后果。所以我们必须把它们降低到一个共同的规模或者<strong class="ih hj">改变它。</strong></p><p id="887e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，当您处理欧几里得距离时，如在K-最近邻中或在KMeans中计算质心，甚至在PCA(主成分分析)中，数据转换是必要的。其中一些转换技术是标准化和规范化。</p><p id="8785" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我已经做了概述。让我们挖到一个更窄的路径，在这里我们将处理一个聚类问题，并看看不同的转换技术将如何影响我们的聚类结果。我将使用sklearn.preprocessing包中的StandardScaler和MinMaxScaler。</p><h1 id="7a7d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">资料组</h1><p id="7b83" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">我使用了航空业客户的数据集，其中包括他们的飞行模式、常旅客奖励的赚取和使用以及航空公司信用卡的使用等。任务是通过聚类识别客户群。以下是描述性元数据和数据集头。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ld"><img src="../Images/c1adc48d40787e3a50f0897b5f98a2b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4UOuXmDAANInUlYu-hwMEw.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">元数据</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es le"><img src="../Images/e599b42653e3d9ff9ba648ad59ec662a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wChXMmrdhTdDT4CSJol9w.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">数据集(注意:由于我只取了前5行，Qual_miles、cc2_miles和cc3_miles数据不一致)</figcaption></figure><p id="e696" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们开始分析…</p><h1 id="8c4a" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">执行标准缩放</h1><p id="c8a4" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">标准缩放的作用是变换每个要素(不是每个样本),使平均值变为0，标准差变为1。结果值也称为Z分数。据统计，大约68%的数据位于[-1，1]的Z值范围内。这是数据转换后的样子。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lf"><img src="../Images/99eaac7b57dbea24254f594c50097e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nFQiCyO07GL_S80yUG97JA.png"/></div></div></figure><p id="4dbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将在这里使用KMeans聚类算法。由于手动决定k值(即聚类数)是KMeans的缺点，因此最好使用肘方法，然后决定k值。</p><p id="c5a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选择正确的k值</strong></p><p id="4b02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">肘形法绘制不同k值的WCSS(聚类平方和内)。WCSS被定义为集群的每个成员与其质心之间的平方距离之和。“WCSS”，简单的东西，沉重的名字。</p><p id="6306" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再来看剧情。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lg"><img src="../Images/6b5653791084bae85300a088df067edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*lxc4_L972zaj9kWhUVUKFg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">标准缩放的弯管法曲线</figcaption></figure><p id="ccc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从图上看，WCSS没有大幅下降的点是5。然而，也有其他次优的k值。此外，我们还通过使用K++手段摆脱了随机初始化陷阱。以下是我在应用算法后发现的每个聚类的推论。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lh"><img src="../Images/b0be06aa38f020996b52301bc582a265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdrAr5yfy1Int4VHTqChDQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated"><strong class="bd kc">聚类0: </strong>这是拥有cc1_miles的人的最大聚类，cc2_miles和cc3_miles最低。普通的新客户，也许这就是为什么他们的信用里程低。</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es li"><img src="../Images/9ceccb38cc765c271d0a52782bb4e2f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*HJEutADnxqJKmJQeIV0dXg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated"><strong class="bd kc">聚类1: </strong>大约26%的客户使用飞行信用卡进行了平均最高交易，即cc1_miles</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lj"><img src="../Images/a735c13ededa2b5d6b67796ffb1cc141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*o1gH5zSLHh9FL-sJJberlQ.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated"><strong class="bd kc">集群2: </strong>这是一小群人，他们喜欢用奖励信用卡(即cc2_miles)付款，不使用飞行信用卡或小型企业信用卡。</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lj"><img src="../Images/42e87f78686c6ea9f9a4dacedf5ef852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*BLQ1IwcwOKjjyYmRlUx-Jw.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated"><strong class="bd kc">集群3: </strong>这些是4%的客户。他们中的大多数都有3英里的信用额度，但都是老客户。也许是因为糟糕的旅行经历。</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lk"><img src="../Images/783922626a6064b8d537087de419e960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*ioRAo530yJeI0aH12uPC-g.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated"><strong class="bd kc">聚类4: </strong>这4000人中的15人在小企业(cc3_miles)信用卡中具有最高信用评分，并且还在所有等级中具有Flyer信用卡评分。</figcaption></figure><p id="d2cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以根据客户对不同信用卡的消费以及他们自注册以来的天数来标记客户。</p><p id="9493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们试试MinMaxScaler。</p><h1 id="1387" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">执行最小-最大缩放</h1><p id="3c05" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">最小-最大缩放将数据集范围缩小到指定的比例，而不影响其分布形状。通过减去相应的最小值，然后除以其相应的范围，计算出每个特征的<strong class="ih hj">。</strong></p><p id="7058" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看[0，1]范围的变换数据集。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ll"><img src="../Images/0cd214992896064fe4ae24c12085f9ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jS3VzsBWeWfu1JU63VzE2g.png"/></div></div></figure><p id="06d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管如前所述，我们已经知道了k值，但仍然建议使用Elbow方法。</p><p id="d5c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选择正确的k值</strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lm"><img src="../Images/e308b82a542e0027ab5be0d9cfdebf42.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*XospAlN_PHyZQN9EBnYPdg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">最小-最大缩放的弯头方法曲线</figcaption></figure><p id="43d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哇哦。没出事吗？。什么事？。仔细看，在同一个数据集上，曲线只是通过采用与以前不同的变换技术而发生变化。这一次，它建议我用k=4。因为在这一点上，WCSS值的下降率不再是实质性的。对集群好奇？？。在这里，有克迈恩斯。</p><p id="176b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只是为了更好的可视化，我做了一个额外的特性“cc_sum”(这是cc1_miles、cc2_miles和cc3_miles的横列总和)。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ln"><img src="../Images/4de5aa293af1af3b133e063859068fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*hu_DyjqouDm2FFJhRbVI5w.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">聚类可视化(注意:“航班交易12个月”与列名“航班_交易_12”相同)</figcaption></figure><p id="483e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一次，聚类结果的关键取决于Award和cc_sum特性。我想用下面的方式来解释这个集群的特征。</p><p id="ab63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大约13%的平均年龄最大的顾客获得了奖励(奖励=1)，可能是因为他们主要通过飞行信用卡进行了最高的非航班交易。(粉丝)</p><p id="cd94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Violet: </strong>大约24%获得奖励，不是因为非航班交易，而是因为在过去12个月中比粉丝稍高的航班交易。(支持者)</p><p id="c228" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">黄色:</strong>总客户中约有一半是平均新客户，未授予(奖励=0)，平均成交率低。(不满意)</p><p id="2206" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的12个月里，未获得奖励的剩余人员的非航班交易量远远高于那些不满意但不是常客的人。(漫游者)</p><h1 id="9296" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">那么，哪个更好呢？</h1><blockquote class="jd je jf"><p id="c676" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">“我真的很喜欢在一旁观看，因为我真的可以从不同的角度看比赛。”</p><p id="cae8" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">凯文·诺克斯</p></blockquote><p id="afa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我是这家航空公司的营销主管，我会发现最小-最大扩展集群更有指导意义。他们帮助我跟踪我的忠实客户，维护来自不满意的人的反馈&amp;甚至我可以通过分别给漫游者和支持者折扣和更好的服务来进行有针对性的广告。</p><p id="65d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，对于附属于该航空公司的信用卡公司的营销主管来说，标准的扩展集群更有吸引力。因为这些聚类在不同信用卡在新顾客、老顾客或普通顾客中的受欢迎程度方面更有指导意义。</p><p id="04ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，不同的转换技术通常有一定的局限性。并非每个数据集都适合每种缩放技术。这就是你必须做出决定的时候。</p><h1 id="5d65" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">什么时候用什么</h1><p id="e2db" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">MinMaxScaler不会改变分布的形状，它只是将值缩小到指定的范围。因此，数据集包含的信息的性质保持不变。</p><p id="65da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当每个特征或多或少遵循标准正态分布时，标准定标器通常可能表现得更好。数据信息。可能会改变，因为整个分布会自动调整均值为零，方差为一。</p><p id="7b8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，如果您希望您的异常值保持其重要性，MinMaxScaler会比StandardScaler更有帮助。</p></div><div class="ab cl lo lp gp lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hb hc hd he hf"><p id="2f72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这篇文章对你有所帮助。谢谢你。</p><p id="eadd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lv" href="https://www.linkedin.com/in/tauheed-ahmad/" rel="noopener ugc nofollow" target="_blank">领英。</a></p></div></div>    
</body>
</html>