# 了解 CatBoost 算法

> 原文：<https://medium.com/analytics-vidhya/catboost-101-fb2fdc3398f3?source=collection_archive---------5----------------------->

# 最好的 Boosting 算法之一

![](img/e469ff9c2dc529e579f6d89377b6528f.png)

[汉娜剧团](https://unsplash.com/@htroupe?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

在这个快速教程中，我们将讨论:

*   CatBoost 的起源。
*   何时使用 CatBoost(哪种类型的数据)。
*   如何在任何数据集上实现 CatBoost？

CatBoost 起源于一家名为 Yandex 的俄罗斯公司。这是最新的助推算法之一，因为它在 2017 年推出。有许多增强算法，如 XGBoost、LightGBM 等。但是由于几个原因，没有一个能与 CatBoost 相比。

CatBoost 的意思是分类增强，因为它被设计为完美地处理分类数据，如果您的数据集中有分类数据的话

下面是 CatBoost 的一些特性，这些特性使它有别于所有其他的 Boosting 算法。

*   **无需参数调谐的高品质**
*   **分类特征支持**
*   **快速且可扩展的 GPU 版本**
*   **通过减少过拟合提高精度**
*   **快速预测**
*   **在数据较少的情况下工作良好**

由于上面提到的原因，CatBoost 在最近的 Kaggle 比赛中备受喜爱，现在让我们回答另一个问题**什么时候使用这个令人惊叹的 Boosting Algo？**

# 何时使用 CatBoost 算法？

这里有两种类型的数据**异构数据**和**同构数据**。

> **异构数据:数据类型和格式可变性很大的数据。由于缺少值、高数据冗余，它们可能是不明确的和低质量的。示例:预测信用评分的数据集**
> 
> **同质数据:是由彼此相似的事物组成的数据集，这意味着整个数据集具有相同的数据类型和格式。例如:图像、视频、声音、文本的数据集。**

> CatBoost 适用于异构数据。

因此，如果你有一个图像、文本或声音的数据集，使用神经网络可能是一个好主意，因为神经网络是这些类型的同类数据的最先进技术。

但是，如果您有异构数据的分类问题，那么使用 CatBoost 将是最安全的做法，因为 CatBoost 能够在第一次运行时胜过大多数提升算法。

# 实现 CatBoost

我们将在人类活动识别数据集上应用 CatBoost 进行多类分类。人体活动识别数据集是 UCI 数据集，在这个分类问题中，我们必须根据智能手机传感器(如陀螺仪和加速度计)提取的数据，预测六种活动，如行走、上楼、下楼、坐着、站着和躺着。

为了解决这个问题，在导入数据集后，我使用标准的缩放器进行预处理，然后是应用 CatBoost 分类器的主要部分。让我们看看分类器代码并理解每一行。

因此，首先我们必须导入 CatBoost 分类器，如代码的第一行所示。

导入 CatBoost 库后，我们将创建我们的模型，现在让我们检查这些参数。

*   **迭代:** 1000 次迭代意味着 CatBoost 算法将运行 1000 次以最小化损失函数。
*   **损失函数:**在这里，当我们对多个类进行分类时，我们必须指定“多类”。在二进制分类的情况下，如果我们不提及损失函数，算法将理解并执行二进制分类。
*   **bootstrap_type** :该参数影响构建树结构时选择树的分裂的算法方面的正则化&速度。这里我们选择了贝叶斯，但是如果我们不指定这个参数也没关系。
*   **eval_metric** :在这里，因为我们必须进行多类分类，所以我们选择了“multiclass”作为 eval_metric，当使用二进制分类时，我们不必指定此参数。
*   **叶估计迭代次数**:该参数定义了选择树结构后计算叶值的规则，我们取 100，但也可以不指定该参数。
*   **随机强度**:它指定我们希望我们的梯度增强树彼此之间有多随机。如果我们不指定也没关系。
*   **深度**:我们希望我们的树有多深我指定了 7，因为它给了我最高的精度，但是不指定它也可以，让 CatBoost 算法使用它的默认值。
*   **l2 叶正则化**:为了指定 l2 正则化值，我们取 5，但这不是强制性的。
*   **学习率**:这非常重要，但通常默认的 CatBoost 学习率 0.03 也很好。
*   **装袋温度**:定义贝叶斯自举的设置。默认情况下，它用于分类和回归模式。使用贝叶斯 bootstrap 为对象分配随机权重。不强制指定。
*   **任务类型**:强烈建议只在 GPU 上使用 CatBoost 算法，因为在 CPU 上使用 CatBoost 算法会变得相当慢。

在改变参数并找到最佳参数后，我们将拟合模型并预测输出。 ***很容易操作，CatBoost 只需要几个参数就可以调优，比如你调的话，***

*   **学习率+迭代次数**
*   **深度**
*   **L2 _ 正规化**
*   **装袋 _ 温度**
*   **随机 _ 强度**

> 那么你将能够很容易地获得非常好的性能相比，其他升压算法。

在 CatBoost 中，您只需指定数据集类型(二元或多类分类)就可以运行模型，并且您仍然能够获得非常好的分数，而不会出现任何过度拟合。

这就是这个算法的工作原理。我在参考资料中提供了一些链接，通过这些链接，您将能够了解这个 CatBoost 算法。

**参考**

*   [https://github . com/original meet/Human _ Activity _ Recognition _ Using _ smart phone/blob/master/cat boosting . py](https://github.com/OriginalMeet/Human_Activity_Recognition_Using_smartphone/blob/master/catboosting.py)
*   [https://catboost.ai/](https://catboost.ai/)