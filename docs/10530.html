<html>
<head>
<title>PyQGIS — Script for visualization of grid-based data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyQGIS —基于网格的数据可视化脚本</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pyqgis-script-for-drawing-colored-rectangles-4c4944caffe4?source=collection_archive---------20-----------------------#2020-10-22">https://medium.com/analytics-vidhya/pyqgis-script-for-drawing-colored-rectangles-4c4944caffe4?source=collection_archive---------20-----------------------#2020-10-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5316" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">利用QGIS实现网格数据可视化的简单方法</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/9b387868957599bd968b4d49352d64b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*URyVKAqlgdezaJsF2pdCkA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">基于网格的可视化(图片作者:作者)</figcaption></figure><p id="5e79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您是否尝试过在地图上可视化基于网格的数据？QGIS是处理地图和可视化的绝佳选择！有时，当您处理大量数据和层时，使用GUI(图形用户界面)是一项挑战。这里，皮格吉斯人进来了！该软件将强大且语法简单的编程语言Python与QGIS功能相结合。在这个故事中，将一步一步地解释为基于网格的数据的可视化绘制彩色矩形的脚本。如果你只是想要代码，请访问:<a class="ae jt" href="https://github.com/tisljaricleo/PyQgisScripts" rel="noopener ugc nofollow" target="_blank">https://github.com/tisljaricleo/PyQgisScripts</a></p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="a14b" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">问题描述</strong></h1><p id="d65d" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">让我们来定义我们的问题。在处理基于网格的数据时，可视化有时非常重要。在这个故事中，我们将展示如何可视化这种数据，并根据某些值对其进行着色。我们的示例将包括使用QGIS和PyQGIS在<a class="ae jt" href="https://www.openstreetmap.org" rel="noopener ugc nofollow" target="_blank"> OSM(开放街道地图)</a>上创建网格，其中矩形的颜色将指示车辆的平均速度(绿色-高速；黄色-中速；红色-低速)。</p><p id="5435" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可视化基于网格的数据的其他示例可以是某些区域的新冠肺炎病例数、细胞中的人口密度、城市中的污染以及各种热图的可视化。</p><h1 id="bbe3" class="kb kc hi bd kd ke le kg kh ki lf kk kl km lg ko kp kq lh ks kt ku li kw kx ky bi translated"><strong class="ak">工具</strong></h1><ol class=""><li id="2c13" class="lj lk hi ih b ii kz im la iq ll iu lm iy ln jc lo lp lq lr bi translated">QGIS——免费开源地理信息系统软件。你可以在https://qgis.org/en/site/官方页面<a class="ae jt" href="https://qgis.org/en/site/" rel="noopener ugc nofollow" target="_blank">下载。在</a><a class="ae jt" rel="noopener" href="/">媒体</a>上有一些关于如何安装QGIS的教程。</li><li id="29ba" class="lj lk hi ih b ii ls im lt iq lu iu lv iy lw jc lo lp lq lr bi translated">PyQGIS结合Python和QGIS功能的软件。它用于重复任务的自动化，如创建和编辑大量的层。官方文件可以在这里找到<a class="ae jt" href="https://docs.qgis.org/3.10/en/docs/index.html" rel="noopener ugc nofollow" target="_blank">https://docs.qgis.org/3.10/en/docs/index.html</a></li><li id="f773" class="lj lk hi ih b ii ls im lt iq lu iu lv iy lw jc lo lp lq lr bi translated">Python控制台——QGIS有它的Python安装和控制台，所以我们<strong class="ih hj">不必从官方页面安装</strong> Python。</li></ol><h1 id="df72" class="kb kc hi bd kd ke le kg kh ki lf kk kl km lg ko kp kq lh ks kt ku li kw kx ky bi translated">让我们工作吧</h1><p id="5680" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">首先，在QGIS应用程序中打开新项目，并添加OSM地图图层。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/ab7cd81b76521638aef74a7c604dda4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yJrN0rG_tl7_5IQ6VBParw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">向QGIS项目添加OSM地图(图片来源:作者)</figcaption></figure><p id="4dd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开Python控制台。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/96176fb000fa05eef4f661bb71d7cce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TvROlQFScofiHVKZCtoKPw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">打开Python控制台(图片作者:作者)</figcaption></figure><p id="5d4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击“显示编辑器”按钮，打开编辑Python代码的窗口。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/3bc589da20741b9faca2b7bf448e75ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GeDUK8Y4UKQx2WJDF7MQEQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Python代码编辑器(图片作者:作者)</figcaption></figure><p id="c81b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将Github资源库<a class="ae jt" href="https://github.com/tisljaricleo/PyQgisScripts/blob/main/Rectangle%20drawing/rectangle_drawing.py" rel="noopener ugc nofollow" target="_blank">中的代码复制并粘贴到Python代码编辑器中。然后按绿色的播放按钮。</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/774b78bea06dc579291e47eb90db0f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sffRtDTaUuLY8VlqgKbZNA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mb"><img src="../Images/43c5ad5929c41e6ddd4a7b1d65651a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XiwpvCvnjCkhSWrPVDJ07Q.png"/></div></div></figure><p id="3152" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按下绿色播放按钮后，一些新的层将被创建。要查看结果，右键单击其中一个图层并选择“缩放至图层”选项。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/9e4566fb3f6a401523a5d85770d983f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ZEjBsTI7T3oDp2e4-JzNA.png"/></div></div></figure><p id="5a7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此示例显示了5x5矩形网格。这些颜色表示在矩形区域行驶的车辆的速度。在下一节中，您将学习如何定制代码来满足您的需求。</p><h1 id="cf3f" class="kb kc hi bd kd ke le kg kh ki lf kk kl km lg ko kp kq lh ks kt ku li kw kx ky bi translated">自定义网格可视化</h1><p id="ae32" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">创建自定义网格可视化只需更改几个参数。</p><ol class=""><li id="9184" class="lj lk hi ih b ii ij im in iq mc iu md iy me jc lo lp lq lr bi translated">矩形的形状和大小</li></ol><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="77d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变量lon_start和lat_start将定义地图上的起始GNSS点。lon_step和lat_step是用于增加对应于距离度量的某个定义数的经度和纬度的系数。让我们更详细地解释这一点。在这个例子中，我们想要创建500x500 m的矩形。这意味着要在地图上移动500米，我们必须增加/减少经度0.006545和纬度0.004579。变量x_num和y_num将定义要绘制的矩形的行数和列数。所有变量如下图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mh"><img src="../Images/b99337bb22963edbee5d15940712f62c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3hEnJ9krF6JFWnl-Cksyxw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">用于绘图的自定义变量(图片来源:作者)</figcaption></figure><p id="aee9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.矩形颜色</p><p id="bf32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">速度矩阵必须具有与矩形相同的尺寸(行和颜色)。换句话说，每个矩形必须有一个相应的速度值。矩形的颜色基于某个数值。在本例中，它是平均速度，如下面的代码所示。<br/>你可以使用任何其他值(密度，污染等。)只要尺寸与矩形的数量相匹配。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="d1a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.颜色范围</p><p id="d28f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您需要不同的颜色范围，您必须编辑函数def drawRectangles(points，c_value，name)。找到下面列出的部分代码，并在括号内添加或更改定义的值。</p><p id="659e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(类别名称，下限，上限，(红色，绿色，蓝色，阿尔法))</strong></p><h1 id="4f23" class="kb kc hi bd kd ke le kg kh ki lf kk kl km lg ko kp kq lh ks kt ku li kw kx ky bi translated">结论</h1><p id="ab81" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">谢谢你读了这个故事！我希望这些内容对你有用。更多类似的故事，请访问我的个人资料。</p><p id="c1e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整代码可以在这里找到:<a class="ae jt" href="https://github.com/tisljaricleo/PyQgisScripts/blob/main/Rectangle%20drawing/rectangle_drawing.py" rel="noopener ugc nofollow" target="_blank">https://github . com/tisljarico/pyqgiscripts/blob/main/Rectangle % 20 drawing/Rectangle _ drawing . py</a></p><p id="7b69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如有任何问题或建议，欢迎评论或联系我！</p><p id="ecd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">领英:<a class="ae jt" href="https://www.linkedin.com/in/leo-tisljaric-28a56b123/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/leo-tisljaric-28a56b123/</a></p></div></div>    
</body>
</html>