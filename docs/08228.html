<html>
<head>
<title>End to End process from EDA to Model creation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从EDA到模型创建的端到端流程</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ml-machine-learning-model-that-classify-the-robot-from-their-sequence-3383bfa71a18?source=collection_archive---------24-----------------------#2020-07-21">https://medium.com/analytics-vidhya/ml-machine-learning-model-that-classify-the-robot-from-their-sequence-3383bfa71a18?source=collection_archive---------24-----------------------#2020-07-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8749" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题陈述:</p><p id="f459" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5个机器人的名字出人意料地被命名为0，1，2，3，4，它们正在进行一场统一的对话，每个机器人以循环的方式一次吐出10个数字。如果你选择接受它，你的任务是训练一个模型，当给定机器人说出的10个数字时，它可以准确地预测机器人。这5个机器人之间的长时间对话日志已经给出，这是你的<a class="ae jd" href="https://www.kaggle.com/msk1097/classification-of-robots-from-their-conversation" rel="noopener ugc nofollow" target="_blank">数据集</a>。</p><h1 id="81d5" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">目标:开发一个最大似然模型，从机器人的序列中准确预测机器人</h1><h2 id="790e" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">建模前采取了以下步骤:</h2><h1 id="a8c8" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">1.数据探索和预处理</h1><p id="d172" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">a)。五点汇总(最小值、最大值、分位数(0.25.0.75)、平均值)以了解特性和值分布。</p><p id="a993" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)。数据集中存在数据分布(偏离正态分布)。</p><p id="86a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">c)。检查空值/缺失值/模糊值</p><p id="7d48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">d)。检查并删除导致数据中类别分布不平衡的重复值。</p><p id="9abd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">e)。使用Shapiro测试检查特征的正态性(统计分析/假设(alpha=0.05时数据是正态的))</p><p id="9fbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">f)。检查极值和异常值(z得分和分位数值)</p><p id="c044" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">g)。类(目标)分布，无论它是平衡的还是不平衡的。</p><p id="69a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">h)。不平衡类别3和4的上采样为其他类别增加了数据点数量。</p><div class="kv kw kx ky fd ab cb"><figure class="kz la lb lc ld le lf paragraph-image"><img src="../Images/6ba6fd1d474b141089f3553b99bfa6bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*xuoO_bICz93kyZKr7NlUnA.png"/></figure><figure class="kz la lb lc ld le lf paragraph-image"><img src="../Images/448e0a143bcd42553acd97c5f918284f.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZIe_4HgasB6Y4umyNstqoQ.png"/><figcaption class="li lj et er es lk ll bd b be z dx lm di ln lo translated">不平衡类的采样前后</figcaption></figure></div><p id="858e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我)。使用pairplots关联和绘制数据点。</p><p id="7d00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">j)。在k-均值和聚类分析之后，存在不同的3个聚类，这告诉我们两个类(3，1)之间的分离少得多。它们具有几乎相同或重叠的数据点。</p><figure class="kv kw kx ky fd la er es paragraph-image"><div class="er es lp"><img src="../Images/df4a8b4afae727e529ac955235ed7305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*V9bp0FvUEs_RzCOWaL7dEA.png"/></div></figure><p id="c165" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我)。由于数据是完整的数值和非常大的值(le12的数量级),并且最小值低至零，因此有必要进行数据转换，以减少这种严重右偏的数据，其中少数值非常大，而大多数值很低。</p><p id="a818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">j)。日志转换:在这种情况下是最好的，但是由于引入了-inf和inf而没有使用。</p><p id="098f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">h)。BoxCox转换:因为boxcox只取非常正的值(即&gt; 0而不是0 ),所以所有为零的数据行都被删除。</p><h1 id="cf4a" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">2.特征选择和工程</h1><p id="83ab" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">k)。数据在转换之前已经被拆分，因此测试数据不应该暴露给even transform方法，因为它会导致数据泄漏，从而导致过度拟合。</p><p id="8cc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">l)使用协方差和绘制热图发现了非常高的多重共线性..= 0.8)-与-目标特征</p><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/3dde2abdd6a428f3120041bbf43333db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Si4fDWjp_ZNUB-r-pu0XLw.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">显示共线性的热图</figcaption></figure><p id="75ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(n)高相关性过滤器可用于特征选择，但是它们显示所有特征彼此相关(&gt; =0.8)并且与目标特征(&lt;0.8).m)</p><p id="7872" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Two major reasons to adopt PCA for our process are <strong class="ih hj">非常高的相关性和特征选择问题。</strong></p><h1 id="7161" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">迭代次数</h1><h2 id="28fc" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">迭代1:</h2><p id="5cef" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">a)分割数据后，由于数据不符合正态分布，并且在未转换的数据集中也存在不平衡，因此使用了树算法。[占用太多时间和内存，准确率非常低]</p><h2 id="901f" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">迭代2:</h2><p id="f218" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">a)分割数据后，由于数据不符合正态分布，且数据集中存在不平衡，因此使用了树算法。[精确度高，但测试数据集中缺少类别]</p><h2 id="da1e" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">迭代3:</h2><p id="6a9e" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">a)分割数据后，由于数据不符合正态分布，且数据集中存在转换不平衡，聚类(k-means)数据输入模型后，[列车数据精度高，而测试数据精度低。(过度拟合)]</p><h2 id="d648" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">迭代4:</h2><p id="9ff2" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">a)分割数据后，由于数据不符合正态分布，且数据集中也存在不平衡，因此使用了不同的非参数模型。[树算法和SVM]</p><h2 id="0df5" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">迭代5:</h2><p id="12b1" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">a)分割数据后，由于数据不符合正态分布，且数据集中也存在不平衡，因此使用了不同的非参数模型。【深度学习Keras，基础神经网络。]</p><h2 id="4ae6" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">所有这些迭代还涉及超参数调整</h2><h2 id="6627" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">模型比较(PCA前后)</h2><h2 id="db18" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">最终模型:SVM，测试精度为78.3%</h2><p id="0339" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">如果我们看到不同的评估指标，如召回率、精确度和f1评分，他们在SVM也表现良好。</p><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lv"><img src="../Images/76de18a93dcf2777431e3457c1f6dc3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-as53JSKi9OIgFCKhCP4-g.png"/></div></div></figure><h1 id="858c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">最终意见:</h1><ol class=""><li id="200c" class="lw lx hi ih b ii kq im kr iq ly iu lz iy ma jc mb mc md me bi translated">我们可以看到，即使在PCA之后，模型的准确度分数也没有太大的变化。说到这里，为了模型的通用性和稳健性，我们应该考虑PCA。</li><li id="b76f" class="lw lx hi ih b ii mf im mg iq mh iu mi iy mj jc mb mc md me bi translated">由于我们可以看到数据集中存在线性不可分的数据点，因此PCA对于减少数据集中的多重共线性是必要的。</li><li id="e789" class="lw lx hi ih b ii mf im mg iq mh iu mi iy mj jc mb mc md me bi translated">引入PCA后，精确度(主要)、召回率和f值都有所提高，这些也是可以考虑的评估指标，但目前我们的目标是获得最高的精确度。</li></ol><h2 id="e01b" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">即兴创作和风险</h2><ol class=""><li id="22a0" class="lw lx hi ih b ii kq im kr iq ly iu lz iy ma jc mb mc md me bi translated">数据集中的多重共线性。</li><li id="a108" class="lw lx hi ih b ii mf im mg iq mh iu mi iy mj jc mb mc md me bi translated">PCA降低了维度空间，有留下一些点的风险</li><li id="1c18" class="lw lx hi ih b ii mf im mg iq mh iu mi iy mj jc mb mc md me bi translated">此外，统计分析的变量与类。</li><li id="3b0e" class="lw lx hi ih b ii mf im mg iq mh iu mi iy mj jc mb mc md me bi translated">可以增加神经网络层和纪元。</li><li id="185d" class="lw lx hi ih b ii mf im mg iq mh iu mi iy mj jc mb mc md me bi translated">可以使用更多的模型(助推器、系综)。例如:XGBoost</li><li id="9f58" class="lw lx hi ih b ii mf im mg iq mh iu mi iy mj jc mb mc md me bi translated"><a class="ae jd" href="https://github.com/amitfire/EDA-for-Data-Science-Projects" rel="noopener ugc nofollow" target="_blank">https://github.com/amitfire/EDA-for-Data-Science-Projects</a></li></ol></div></div>    
</body>
</html>