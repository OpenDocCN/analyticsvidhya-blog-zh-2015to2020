<html>
<head>
<title>Thank You Sir</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谢谢你，先生</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/thank-you-sir-d02dabee2ab6?source=collection_archive---------17-----------------------#2019-10-21">https://medium.com/analytics-vidhya/thank-you-sir-d02dabee2ab6?source=collection_archive---------17-----------------------#2019-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="4176" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">我是如何为井字游戏实现著名的DeepMind算法的</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f59c1651aec76f0dc3dc3a330c8c25cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3EptlF8E5PJFRHVs"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">达米安·帕特考斯基在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="7c8a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">所以，我无事可做，因为我的gpu正忙着做一些计算，而我在想我毕业后和我的本科生导师度过的时间，准确地说是9个月。我记得他告诉我，我可以写一篇关于我的工作的文章，这是我在那段时间完成的一篇论文。</p><p id="52a2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">那是2017年，我计划开始我的MS，但不知何故它推迟了一年，我决定回去和我的主管一起做一些项目。最初，我从事几个项目，包括盲文本去模糊、汽车模拟中的自动驾驶和神经隐写术。过了一段时间，我的导师去参加一个会议，他不在的时候，我读了他的一些论文和他的博士论文(其中一些)。当他回来时，我让他告诉我一个想法，他让我读一读“阿尔法围棋”。</p><blockquote class="kk"><p id="ca03" class="kl km hi bd kn ko kp kq kr ks kt kj dx translated">接下来是我读完之后的回忆。</p></blockquote><p id="ac89" class="pw-post-body-paragraph jo jp hi jq b jr ku ij jt ju kv im jw jx kw jz ka kb kx kd ke kf ky kh ki kj hb bi translated">我了解了以下事实:</p><blockquote class="kz la lb"><p id="db63" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">2016年3月，Deepmind的AlphaGo以4比1击败世界冠军围棋选手Lee Sedol。</p><p id="340b" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">2017年10月18日，AlphaGo Zero以100比0击败了AlphaGo。</p><p id="9863" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">2017年12月5日，DeepMind发布了另一篇论文，展示了AlphaGo Zero如何在国际象棋和shogi中击败世界冠军程序StockFish和Elmo。</p><p id="f8a9" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">一种在没有任何人类专家策略先验知识的情况下擅长某事的算法诞生了。</p></blockquote><p id="bc12" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我对此感到非常惊讶，所以我决定自己实现它，我的主管给了我一篇关于在Connect4上实现相同算法的文章，但我无法掌握任何东西，所以我决定从头开始，在(3x3) Tic Tac Toe上实现它，因为这样更容易实现游戏的逻辑，而且我可以在更短的时间内检查我的进度。下面的文章在整个过程中对我帮助很大。</p><div class="lg lh ez fb li lj"><a rel="noopener follow" target="_blank" href="/applied-data-science/how-to-build-your-own-alphazero-ai-using-python-and-keras-7f664945c188"><div class="lk ab dw"><div class="ll ab lm cl cj ln"><h2 class="bd hj fi z dy lo ea eb lp ed ef hh bi translated">如何使用Python和Keras构建自己的AlphaZero AI</h2><div class="lq l"><h3 class="bd b fi z dy lo ea eb lp ed ef dx translated">通过自我游戏和深度学习，教机器学习Connect4策略。</h3></div><div class="lr l"><p class="bd b fp z dy lo ea eb lp ed ef dx translated">medium.com</p></div></div><div class="ls l"><div class="lt l lu lv lw ls lx jh lj"/></div></div></a></div><div class="lg lh ez fb li lj"><a href="http://tim.hibal.org/blog/alpha-zero-how-and-why-it-works/" rel="noopener  ugc nofollow" target="_blank"><div class="lk ab dw"><div class="ll ab lm cl cj ln"><h2 class="bd hj fi z dy lo ea eb lp ed ef hh bi translated">AlphaGo Zero -工作方式和原因</h2><div class="lq l"><h3 class="bd b fi z dy lo ea eb lp ed ef dx translated">2016年3月，DeepMind的AlphaGo成为第一个击败顶级人类围棋选手的人工智能，引起了轩然大波。这个版本…</h3></div><div class="lr l"><p class="bd b fp z dy lo ea eb lp ed ef dx translated">tim.hibal.org</p></div></div><div class="ls l"><div class="ly l lu lv lw ls lx jh lj"/></div></div></a></div><blockquote class="kk"><p id="9280" class="kl km hi bd kn ko lz ma mb mc md kj dx translated">在与DeepMind的论文[ <a class="ae jn" href="https://discovery.ucl.ac.uk/id/eprint/10045895/1/agz_unformatted_nature.pdf" rel="noopener ugc nofollow" target="_blank"> 1 </a>，<a class="ae jn" href="https://arxiv.org/pdf/1712.01815.pdf" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]一起反复阅读了许多文章之后，我对该算法有了如下理解。</p></blockquote><h1 id="a121" class="me mf hi bd mg mh mi mj mk ml mm mn mo io mp ip mq ir mr is ms iu mt iv mu mv bi translated"><strong class="ak">概述</strong></h1><p id="d63c" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">通过self play使用当前最佳玩家生成训练数据，以训练第二最佳玩家，然后对照最佳玩家评估其性能，如果其赢得55%的时间，则在下一次迭代中用最佳玩家替换它。</p><h1 id="384d" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">目标</h1><p id="8f7f" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">目标是预测两件事:</p><blockquote class="kz la lb"><p id="7836" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在每一点上，采取哪一步棋实际上是学习政策。</p><p id="0252" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在每一点上，直接的回报是什么，实际上是学习价值函数。</p></blockquote><h1 id="2f9c" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">方法学</h1><blockquote class="kz la lb"><p id="04f1" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">自我游戏</p><p id="f247" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">网络权重优化</p><p id="9733" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">网络评估</p></blockquote><blockquote class="kk"><p id="5d41" class="kl km hi bd kn ko lz ma mb mc md kj dx translated">接下来是我对实现该算法所需的构件的翻译。世界应该是什么样子？如何表现不同的阶段？如何存储数据？</p></blockquote><h1 id="2853" class="me mf hi bd mg mh mi mj mk ml mm mn mo io mp ip mq ir mr is ms iu mt iv mu mv bi translated">自我游戏</h1><blockquote class="kz la lb"><p id="cbfc" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">通过蒙特卡罗树搜索移动选择</p><p id="c207" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">每次移动时，都会存储以下信息:</p><p id="a660" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">游戏状态</p><p id="47b6" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">搜索概率</p><p id="9819" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">获胜者</p></blockquote><h1 id="d064" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">表现</h1><blockquote class="kz la lb"><p id="6290" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">0表示在该位置没有移动</p><p id="a3b9" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">1代表参与人1</p><p id="09d7" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">2代表参与人2</p></blockquote><h1 id="5268" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">状态</h1><blockquote class="kz la lb"><p id="0925" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在任何情况下，游戏的条件是一种依赖于表现的状态。</p><p id="b496" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">这里，是完整的迷宫:</p><p id="4f2e" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">0000000001</p><p id="2b47" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">0000000002</p><p id="59e9" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">以及一个转向指示器</p><p id="2def" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">(上面显示的是正在考虑的游戏的初始状态)</p></blockquote><h1 id="9ba0" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">儿童</h1><blockquote class="kz la lb"><p id="5fe1" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">从一个状态可能的移动被认为是它的孩子。</p><p id="637e" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">儿童游戏的初始状态是:</p><p id="65e3" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">100000000</p><p id="0f19" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">010000000</p><p id="e2f1" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">001000000</p><p id="74a9" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">000100000</p><p id="9fc2" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">000010000</p><p id="b3aa" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">000001000</p><p id="da22" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">000000100</p><p id="8044" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">000000010</p><p id="fc08" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi">000000001</p><p id="350f" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">一个孩子储存五种价值观</p><p id="6af8" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">N →采取行动的次数</p><p id="e650" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">W →国家总值</p><p id="9748" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">Q →状态的平均值</p><p id="c0e4" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">P →政策功能预测</p><p id="3754" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">V →价值函数预测</p></blockquote><h1 id="5281" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">蒙特卡罗树搜索</h1><blockquote class="kz la lb"><p id="141b" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">给定一个状态，通过选择最佳子节点来浏览树，直到到达一个叶节点。</p><p id="8d69" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在叶节点，预测它的每个子节点的概率。</p><p id="c0be" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">从叶向后传播到根，在这种情况下，根是输入，并更新N、W和q的值。</p><p id="ed34" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">重复这个循环一段时间。</p><p id="551d" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">从一堆动作中选出最好的一个。</p></blockquote><h1 id="a1d9" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">儿童选择</h1><blockquote class="kz la lb"><p id="31e4" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">基于等式Q+U选择孩子</p><p id="8875" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">Q →状态的平均值</p><p id="3f07" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">U →一个P和N的函数，如果一个动作相对于其他动作没有被深入研究，或者如果该动作的先验概率很高，则该函数增加</p><p id="2a2c" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在这种情况下，u是零件号</p><p id="7139" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">所以等式变成了(P/N)+Q</p><p id="6a1f" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">因为在模拟的早期，U应该占主导地位(更多的探索)，但是后期Q更重要(开发)</p><p id="ea88" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">因此需要一个小的修改，即(ε*(P/N))+Q</p></blockquote><h1 id="ec44" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">值更新</h1><blockquote class="kz la lb"><p id="82d1" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在反向传播过程中，这些值更新如下:</p><p id="5d01" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">N = N+1</p><p id="bf52" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">W = W+V</p><p id="bdf5" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">Q = W/N</p></blockquote><h1 id="45bc" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">插曲</h1><p id="d7bb" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">从头到尾玩的一局就是一集。</p><h1 id="d462" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">数据生成</h1><blockquote class="kz la lb"><p id="2808" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">一旦一集结束，所有执行的步骤都将被标记。</p><p id="04b6" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">获胜玩家所走的所有步骤将被分配+1，而所有其他步骤将被分配-1。</p><p id="360d" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">类似地，每一步都将被分配一个CNN提供的概率。</p></blockquote><h1 id="e567" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">深度神经网络</h1><blockquote class="kz la lb"><p id="0ca1" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">这是一个具有1个卷积层和40个残差层的网络，具有双头输出、值头和策略头。</p><p id="1d97" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">Value head给出一个范围[-1，1]内的单一预测，实际上是试图预测游戏的结果。</p><p id="84ef" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">保单负责人给出了9种概率，实际上是试图预测孩子之间的概率分布。</p><p id="62cb" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">为了更快的收敛，我把模型分成不同的头部。</p><p id="fa3c" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">价值头情况下的损失函数是均方误差，而策略头情况下的损失函数是软最大交叉熵。</p></blockquote><h1 id="fc35" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">网络权重优化</h1><blockquote class="kz la lb"><p id="8bfe" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">一旦使用当前最好的玩家通过自我游戏生成了数据，现在就该使用最好的玩家生成的数据重新训练第二好的玩家了。</p><p id="894e" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">从数据中抽取小批量样本。</p><p id="bb5b" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在这些岗位上对当前网络进行再培训。</p></blockquote><h1 id="55bd" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">网络评估</h1><p id="f44c" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">在训练之后，是时候对照迄今为止最好的网络来评估重新训练的网络的性能，如果重新训练的网络赢得55%的游戏，它将成为新的最好的网络，并且对于下一次迭代，角色将被改变，因为新的最好的网络将产生用于训练先前最好的网络的数据。</p><h1 id="55a9" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">一些超参数</h1><blockquote class="kz la lb"><p id="cb0b" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">训练时期的数量:1</p><p id="72e1" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">训练迭代次数:20</p><p id="ae19" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">自我游戏时的游戏数量:100</p><p id="428d" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">评估期间的游戏数量:40</p><p id="5250" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">批量:256个</p><p id="c8e0" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">样本量:512</p><p id="1ed4" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">蒙特卡洛模拟:100</p><p id="ef5e" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">正则化常数:0.0001</p><p id="9c1b" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">学习率:0.01</p><p id="27d3" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">动量:0.9</p><p id="bc24" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">优化器:SGD</p></blockquote><h1 id="6979" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">结果</h1><blockquote class="kz la lb"><p id="00e3" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">在100场比赛后，以40比0击败了未经训练的算法</p><p id="fccb" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">200场比赛后，以40比0击败第一名</p></blockquote><blockquote class="kk"><p id="8e22" class="kl km hi bd kn ko lz ma mb mc md kj dx translated">到目前为止，我已经尝试解释了算法的整体工作原理，现在我将尝试解释我的代码结构。</p></blockquote><h1 id="c830" class="me mf hi bd mg mh mi mj mk ml mm mn mo io mp ip mq ir mr is ms iu mt iv mu mv bi translated">节点类</h1><p id="6b52" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">节点类包含以下属性</p><blockquote class="kz la lb"><p id="82f3" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">n是一个动作被执行的次数</p><p id="69c7" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated"><strong class="jq hj"> w </strong>是下一个状态的总值</p><p id="f134" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated"><strong class="jq hj"> q </strong>是下一个状态的平均值</p><p id="0ca3" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated">p是选择行动a的先验概率</p><p id="02b1" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated"><strong class="jq hj">状态</strong>包含游戏的当前状态</p><p id="77c7" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated"><strong class="jq hj">动作</strong>包含当前状态的可能动作</p><p id="665a" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated"><strong class="jq hj"> p </strong>包含移动概率</p><p id="9bee" class="jo jp lc jq b jr js ij jt ju jv im jw ld jy jz ka le kc kd ke lf kg kh ki kj hb bi translated"><strong class="jq hj"> v </strong>是状态值(针对当前玩家)</p></blockquote><h1 id="bab9" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">功能</h1><h1 id="987d" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">行动</h1><p id="8d92" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">它以索引的形式从当前状态返回可能的动作。</p><h1 id="ccd9" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">儿童</h1><p id="4e0d" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">它返回更新的节点，子数组包含状态形式的可能动作，父数组包含当前状态。</p><h1 id="df7a" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">结论</h1><p id="0f3f" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">如果玩家赢了，它返回1；如果对手赢了，它返回2；如果游戏没有结束，它返回-1；如果游戏打平，它返回0。</p><h1 id="cf6c" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">模拟</h1><p id="dcb8" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">它执行完整的蒙特卡罗模拟，并返回移动概率。</p><h1 id="a480" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">mcst</h1><p id="fd2f" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">它通过执行多个模拟来执行蒙特卡罗树搜索，并返回最佳移动、当前移动概率。</p><h1 id="c0e9" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">打印_迷宫</h1><p id="3ee4" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">它以板的形式打印输出。</p><h1 id="e36f" class="me mf hi bd mg mh mi mj mk ml mm mn mo io nb ip mq ir nc is ms iu nd iv mu mv bi translated">插曲</h1><p id="81e0" class="pw-post-body-paragraph jo jp hi jq b jr mw ij jt ju mx im jw jx my jz ka kb mz kd ke kf na kh ki kj hb bi translated">它使用蒙特卡罗树搜索执行游戏的完整一集，并返回pi_model提供的移动概率、z_model提供的状态值和states在一集期间提供的不同状态的预测，如果是玩家1的移动，则附加值为1，如果是玩家2的移动，则附加值为2。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ne"><img src="../Images/534721edfbdcb6c870c2915a48db81bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*i1TPXjNsg590mdyaRg9pKA.gif"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">演示</figcaption></figure><blockquote class="kk"><p id="ffc0" class="kl km hi bd kn ko lz ma mb mc md kj dx translated">代码可在<a class="ae jn" href="https://github.com/thanif/Alpha-Zero-on-Tic-Tac-Toe-using-Keras" rel="noopener ugc nofollow" target="_blank">这个</a>存储库中获得。</p></blockquote><p id="73b8" class="pw-post-body-paragraph jo jp hi jq b jr ku ij jt ju kv im jw jx kw jz ka kb kx kd ke kf ky kh ki kj hb bi translated">那么，下一步是什么？嗯，我正在研究骑自行车的人的检测，并在这个过程中完成了另一篇论文。我希望尽快写下它。</p></div></div>    
</body>
</html>