<html>
<head>
<title>Hive using S3 and Scala</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用S3和Scala的Hive</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hive-using-s3-and-scala-af5524302758?source=collection_archive---------7-----------------------#2020-02-22">https://medium.com/analytics-vidhya/hive-using-s3-and-scala-af5524302758?source=collection_archive---------7-----------------------#2020-02-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="c717" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">带有外部数据存储的Hive模式初学者指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/3d9e6489d9d012868b0e64734f3194d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktqeq6NDpcFzRln6dnEuxw.png"/></div></div></figure><p id="0be2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在本文中，我将分享我维护Hive模式的经验。这将对那些愿意涉足大数据技术的大一新生很有用。这将主要描述如何使用Scala连接到Hive，以及如何使用AWS S3作为数据存储。</p><p id="9f1e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">简介</strong></p><p id="765b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Hive是一个数据仓库基础设施工具，用于在分布式环境中处理结构化数据。它位于Spark/Hadoop之上，用于汇总大数据，并简化查询和分析。</p><p id="34a9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最初，Hive是由脸书开发的。后来，Apache Software Foundation采用了它，并以Apache Hive的名称将其进一步开发为开源软件。</p><p id="8127" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">特色</strong></p><ul class=""><li id="d0fe" class="kf kg hi jl b jm jn jp jq js kh jw ki ka kj ke kk kl km kn bi translated">使用Map Reduce概念进行执行。</li><li id="6d42" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">专为OLAP而非OLTP设计。</li><li id="f8b3" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">快速、可升级和可扩展</li><li id="2ed0" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">将模式存储在数据库中，并将处理后的数据导入HDFS。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kt"><img src="../Images/cd0b38a031335cb44dc5c22f7f5ae933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ux_LWPfUSyzQe0FAM9ijFw.png"/></div></div></figure><p id="699f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">数据库</strong></p><p id="0b92" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">数据库是表的集合。Hive中允许使用关键字SCHEMA和DATABASE。我们可以选择任何一个。这里我们使用数据库而不是模式。可以使用“创建数据库”来创建数据库。要进入模式内部，可以使用关键字“USE”。</p><pre class="iy iz ja jb fd ku kv kw kx aw ky bi"><span id="4f41" class="kz la hi kv b fi lb lc l ld le"><strong class="kv hj">CREATE DATABASE userdb;<br/>USER userdb;</strong></span></pre><p id="9c6d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">表格</strong></p><p id="40bc" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">有三种类型的配置单元表。它们是内部的、外部的和暂时的。内部表存储数据库中表的元数据以及表数据。但是外部表将元数据存储在数据库中，而表数据存储在远程位置，如AWS S3和HDFS。删除内部表时，所有表数据都将随元数据一起被删除。删除外部表时，只会删除元数据。而不是表数据。这样，实际数据将得到保护。如果您将新表指向相同的位置，数据将通过新表可见。</p><p id="8c71" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Hive是一个数据仓库，使用MapReduce框架。因此，数据检索的速度对于小型查询来说可能不够公平。为了提高性能，可以对配置单元表进行分区。分区技术可以应用于外部表和内部表。像bucketing这样的概念也是有的。您可以选择这些技术中的任何一种来提高性能。</p><p id="7a29" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">将数据从一个地方复制到另一个地方时，临时表非常有用。它充当数据库会话中保存数据的临时位置。会话超时后，所有临时表都将被清除。</p><p id="dacb" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">内部表(托管)</strong></p><p id="1e0a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在内部表的情况下，首先，我们创建表，然后加载数据，因此我们称之为模式上的<strong class="jl hj">数据。</strong>删除此表后，数据和模式都将被删除。</p><pre class="iy iz ja jb fd ku kv kw kx aw ky bi"><span id="390f" class="kz la hi kv b fi lb lc l ld le"><strong class="kv hj">CREATE TABLE user_info (<br/>business_unit INT, <br/>employee_id INT<br/>)<br/>LOCATION "S3://location"<br/>TBLPROPERTIES (<br/>"s3select.format" = "parquet"<br/>);</strong></span></pre><p id="980c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">外部表格</strong></p><p id="85f9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在这种情况下，HDFS上的数据已经可用，表将基于现有的HDFS数据创建。我们称之为<strong class="jl hj">数据模式。</strong>在删除表时，Hive只删除模式，数据在HDFS上仍然可用。</p><pre class="iy iz ja jb fd ku kv kw kx aw ky bi"><span id="4ce7" class="kz la hi kv b fi lb lc l ld le"><strong class="kv hj">CREATE TABLE user_info (<br/>business_unit INT, <br/>employee_id INT<br/>)<br/>LOCATION "S3://location"</strong></span></pre><p id="fd05" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">降表</strong></p><p id="8871" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果删除内部表，数据也将随模式一起被删除。对于外部表，只有模式将被删除，而数据仍将存在于HDFS上。</p><pre class="iy iz ja jb fd ku kv kw kx aw ky bi"><span id="4c9d" class="kz la hi kv b fi lb lc l ld le"><strong class="kv hj">DROP TABLE IF EXISTS user_info</strong></span></pre><p id="894b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">总之，托管表就像一个普通的数据库表，我们可以在其中存储数据和查询。删除托管表时，存储在其中的数据也会被删除，并且永远丢失。而删除外部表将删除元数据，但不会删除数据。</p><p id="206c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果你喜欢这篇文章，请点击👏所以其他人会在媒体上看到它。</p></div></div>    
</body>
</html>