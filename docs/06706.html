<html>
<head>
<title>Introduction to mapping in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中的映射介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mapping-australia-in-r-6ce092c48b49?source=collection_archive---------6-----------------------#2020-05-31">https://medium.com/analytics-vidhya/mapping-australia-in-r-6ce092c48b49?source=collection_archive---------6-----------------------#2020-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="dec5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">0.0简介</h1><p id="cf53" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我喜欢地图。我也是一个r迷。</p><p id="8940" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在过去的几个月里，我一直在探索如何最好地使用澳大利亚统计局的R和数据创建澳大利亚地图。这是我学到的。</p><p id="e294" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">首先，澳大利亚统计局定期更新他们的地理位置。他们都可以很容易地访问<a class="ae kg" href="https://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/1270.0.55.001July%202016?OpenDocument" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="e39b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">您将需要下载“ESRI Shapefile格式”(例如，ESRI Shapefile格式的统计区域二级(SA2) ASGS Ed 2016数字边界)。SA或统计区域是澳大利亚统计局将国家划分为便于分析的区域的方式。</p><p id="478b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">第二，有无数的软件包来帮助空间可视化。这里有一个不完整的列表，对下面的例子很有用。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="a6bb" class="kq ig hi km b fi kr ks l kt ku">#install spatial packages<br/>install.packages("plyr")<br/>install.packages("dplyr")<br/>install.packages("ggplot2")<br/>install.packages("rgdal")<br/>install.packages("tmap")<br/>install.packages("ggmap")<br/>install.packages("sf")<br/>install.packages("ggspatial")<br/>install.packages("rlang")<br/>install.packages("broom")<br/>install.packages("tidyverse")<br/>install.packages("readxl")<br/>install.packages("raustats")<br/>install.packages("purrr")<br/>install.packages("Census2016")</span><span id="2f96" class="kq ig hi km b fi kv ks l kt ku">#load spatial packages<br/>library(plyr)<br/>library(dplyr)<br/>library(ggplot2)<br/>library(rgdal)<br/>library(tmap)<br/>library(ggmap)<br/>library(dplyr)<br/>library(sf)<br/>library(ggspatial)<br/>library(rlang)<br/>library(broom)<br/>library(tidyverse)<br/>library(readxl)<br/>library(raustats)<br/>library(purrr)<br/>library("Census2016")</span></pre><h1 id="984e" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak"> 1.0将shapefiles导入R </strong></h1><p id="aace" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">用于R(“SF”)的<a class="ae kg" href="https://cran.r-project.org/web/packages/sf/index.html" rel="noopener ugc nofollow" target="_blank">简单特性包提供了处理空间数据的所有基本要求。</a></p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="cb19" class="kq ig hi km b fi kr ks l kt ku">#Use the sf package to import shapefiles<br/>install.packages("sf")<br/>library(sf)</span><span id="4117" class="kq ig hi km b fi kv ks l kt ku">#Select the location where the ASGS files are saved<br/>AUS_SA2_shp &lt;- read_sf("K:/Alteryx/ASGS","SA2_2016_AUST")<br/>AUS_CED_shp &lt;- read_sf("K:/Alteryx/ASGS","CED_2016_AUST")</span><span id="9fce" class="kq ig hi km b fi kv ks l kt ku">#Check the data imported correctly<br/>head(AUS_SA2_shp)<br/>head(AUS_CED_shp)</span></pre><h1 id="bf89" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">2.0使用ggplot制作简单的空间地图</h1><p id="63e4" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">使用ggplot2和geom_sf函数制作shapefile的地图非常简单。此外，多个shapefiles可以用单独的属性绘制在一个绘图中。在下面的例子中，SA2横跨澳洲的地图和维多利亚SA2的地图(绿色)都绘制在同一个图表上。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="6152" class="kq ig hi km b fi kr ks l kt ku">library(ggplot2)<br/>library(dplyr)</span><span id="85ab" class="kq ig hi km b fi kv ks l kt ku">#Read in the SA2 shapefile downloaded from the ABS<br/>AUS_SA2_shp &lt;- read_sf("K:/Alteryx/ASGS","SA2_2016_AUST")</span><span id="f253" class="kq ig hi km b fi kv ks l kt ku">#filter the Australian SA2 shapefile for only Victoria<br/>AUS_SA2_VIC_shp &lt;- AUS_SA2_shp %&gt;%<br/>    filter(STE_CODE16 == 2)</span><span id="137c" class="kq ig hi km b fi kv ks l kt ku">#plot a map of Australia (grey) and a map of Victoria (green)<br/>ggplot() +<br/>  geom_sf(data=AUS_SA2_shp)+<br/>  geom_sf(data=AUS_SA2_VIC_shp,fill = "#A5D46A")+<br/>  ggtitle("Australian SA2 map") +<br/>          xlab("Longitude") +<br/>          xlim(110,155)+<br/>          ylab("Latitude") + <br/>          theme_bw()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es kw"><img src="../Images/10271409716cd723ba0cdbe1db3f5477.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*TCHGQd0DjMqvb6fwtiT3-Q.png"/></div></figure><h1 id="54ea" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">3.0绘制两个形状文件的交集图</h1><p id="521d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">通常shapefiles有不同的地理位置，您想要找出它们重叠的地方(形式上:intersect)。使用st_intersect函数很简单。以下脚本绘制了英联邦选举部门(即投票选民)的shapefile和维多利亚的shapefile的交集。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="c1d4" class="kq ig hi km b fi kr ks l kt ku">#import a shapefile of state boundaries<br/>AUS_STATE_shp &lt;- read_sf("K:/Alteryx/ASGS","STE_2016_AUST")</span><span id="0668" class="kq ig hi km b fi kv ks l kt ku">#import a shapefile of Australian electorates<br/>AUS_CED_shp &lt;- read_sf("K:/Alteryx/ASGS","CED_2016_AUST")</span><span id="6f64" class="kq ig hi km b fi kv ks l kt ku">#check the imports worked<br/>head(AUS_STATE_shp)<br/>head(AUS_CED_shp)</span><span id="e011" class="kq ig hi km b fi kv ks l kt ku">#filter the shapefile for Victoria only<br/>AUS_STATE_VIC_shp &lt;- AUS_STATE_shp %&gt;%<br/>filter(STE_CODE16==2)</span><span id="c967" class="kq ig hi km b fi kv ks l kt ku">#run a spatial intersection for the state of Victoria and all electorates<br/>VIC_CED &lt;- st_intersection(AUS_STATE_VIC_shp, AUS_CED_shp)</span><span id="8521" class="kq ig hi km b fi kv ks l kt ku">#plot this intersecting shapefile<br/>ggplot() +<br/>  geom_sf(data=VIC_CED)+<br/>  ggtitle("Commonwealth Electoral Divisions in Victoria") +<br/>          xlab("Longitude") +<br/>          ylab("Latitude") + <br/>          theme_bw()</span><span id="36b8" class="kq ig hi km b fi kv ks l kt ku">ggsave("C:/Users/Charles F Coverdale/Desktop/VIC_CED.pdf",units="cm",dpi=200, device="pdf")</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es la"><img src="../Images/83b700a68e092281b443a84e3e5803f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZLt8v6Z5mWkb9plfnoOiw.png"/></div></div></figure><h1 id="87d9" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">4.0在shapefile上绘制单个特征(如城市)</h1><p id="ca3e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">除了绘制单个shape file或shape file的交叉点，还可以在地图上绘制特征(如某个点)。</p><p id="6535" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在下面的示例中，选择的首府城市(及其标签)被绘制在澳大利亚各州的地图上。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="1d83" class="kq ig hi km b fi kr ks l kt ku">#import a shapefile of state boundaries<br/>AUS_STATE_shp &lt;- read_sf("K:/Alteryx/ASGS","STE_2016_AUST")</span><span id="dde9" class="kq ig hi km b fi kv ks l kt ku">#make a new dataset of cities in Australia (google the locations)<br/>AUS_cities &lt;- tribble(<br/>  ~city, ~lat, ~long, <br/>  "Brisbane",-27.4698, 153.0251,<br/>  "Sydney", -33.8688, 151.2093,<br/>  "Melbourne", -37.8136, 144.9631)</span><span id="e168" class="kq ig hi km b fi kv ks l kt ku">#check it looks okay<br/>AUS_cities</span><span id="37f0" class="kq ig hi km b fi kv ks l kt ku">#convert those two columns to geometry column with the st_as_sf() function. Google Maps uses the coordinate reference system 4326 (the GPS system).</span><span id="ed9d" class="kq ig hi km b fi kv ks l kt ku">AUS_cities_geometry &lt;- AUS_cities %&gt;% <br/>  st_as_sf(coords = c("long", "lat"), crs = 4326)</span><span id="298b" class="kq ig hi km b fi kv ks l kt ku">#check it looks right<br/>AUS_cities_geometry</span><span id="c3cd" class="kq ig hi km b fi kv ks l kt ku">ggplot() +<br/>  geom_sf(data=AUS_STATE_shp)+<br/>  geom_sf(data=AUS_cities_geometry, size=3)+<br/>  geom_sf_label(data =AUS_cities_geometry, aes(label = city))+<br/>  ggtitle("Brisbane, Sydney and Melbourne") +<br/>  xlab("Longitude") +<br/>  ylab("Latitude") + <br/>  theme_bw()</span><span id="a167" class="kq ig hi km b fi kv ks l kt ku">ggsave("C:/Users/Charles F Coverdale/Desktop/3_capital_cities.pdf",units="cm",dpi=200, device="pdf")</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/81e60d86d55a22449dae5f29404201a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RqI3FJxo7mHS7X_nAYyNyw.png"/></div></div></figure><h1 id="b155" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.0在地图上绘制外部数据源(如人口普查)</h1><p id="97b7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">制图带来的绝大部分好处是可视化跨区域变量。在R中，这涉及到基于一个公共字段将两个数据集连接在一起。以下示例涉及将人口普查数据(SA2级别)连接到shapefile，然后生成地图。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="3eaa" class="kq ig hi km b fi kr ks l kt ku">#Get the census data (already by SA2) by using the Census2016_wide_by_SA2_year function in the Census2016 package</span><span id="e360" class="kq ig hi km b fi kv ks l kt ku">census2016_wide &lt;- Census2016_wide_by_SA2_year<br/>head(census2016_wide,n=20)</span><span id="cf6f" class="kq ig hi km b fi kv ks l kt ku">#Select the key demographic columns (first 8 columns)<br/>census_short &lt;- census2016_wide[,1:8]<br/>head(census_short,n=20)</span><span id="883f" class="kq ig hi km b fi kv ks l kt ku">#Filter for data from the 2016 year<br/>census_short_2016 &lt;- census_short %&gt;%<br/>    filter(year==2016)head(census_short_2016)</span></pre><p id="a5d2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">该软件包中的人口普查数据格式相对简洁。</p><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lg"><img src="../Images/976d59032564e206c1cd6130e93bc05a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EXLryxVsQGAUDZXD4nREgA.png"/></div></div></figure><p id="680d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">接下来，我们将人口普查数据加入shapefile。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="371d" class="kq ig hi km b fi kr ks l kt ku">#Join the two sf (SA2 and census) by their common field.<br/>SA2_shp_census_2016 &lt;- inner_join(AUS_SA2_shp,census_short_2016,<br/>                        by = c("SA2_NAME16" = "sa2_name"))</span><span id="e385" class="kq ig hi km b fi kv ks l kt ku">#check the format                        <br/>head(SA2_shp_census_2016)</span><span id="19ba" class="kq ig hi km b fi kv ks l kt ku">#Plot a map that uses census data <br/> ggplot() + <br/> geom_sf(data = SA2_shp_census_2016, <br/>       aes(fill = median_age, border=NA)) +<br/> ggtitle("Australian median age (SA2)") +<br/> xlab("Longitude") +<br/> ylab("Latitude") + <br/> theme_bw() +<br/> theme(legend.position = "right",<br/>     legend.title = element_text("Median age"))</span><span id="beb8" class="kq ig hi km b fi kv ks l kt ku">ggsave("C:/Users/Charles F Coverdale/Desktop/median_age_map.png",<br/>units="cm",dpi=200, device="png")</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lh"><img src="../Images/d88a0d0ca1d49e66e3203322b264e702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EteJXnMKYNRDFJOhfTFiNA.png"/></div></div></figure><h1 id="7449" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">6.0世界舞台上的澳大利亚</h1><p id="b026" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">能够在世界地图上突出显示各个国家是很有用的。坐标参考系统和地图投影(广义上说，世界是什么样子取决于你对地球形状的假设)在这里开始变得重要起来。</p><p id="b48e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">首先，我们导入整个世界的形状文件。</p><p id="b50a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">接下来，我们过滤掉南极洲(对于绘制人口变量或类似的东西，它在世界地图上几乎从来没有用)。</p><p id="1941" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">第三，我们为我们选择的国家创建一个单独的shapefile层(在这个例子中是澳大利亚)。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="6eb4" class="kq ig hi km b fi kr ks l kt ku">#download a world map (e.g. "Admin 0 – Countries"):<br/><a class="ae kg" href="https://www.naturalearthdata.com/downloads/110m-cultural-vectors/" rel="noopener ugc nofollow" target="_blank">https://www.naturalearthdata.com/downloads/110m-cultural-vectors/</a></span><span id="d313" class="kq ig hi km b fi kv ks l kt ku">#read in the worldmap shapefile using read_sf<br/>world_map &lt;- read_sf("C:/Users/Charles F Coverdale/Desktop/go_bag/R code/ne_110m_admin_0_countries.shp")<br/>world_map</span><span id="bb36" class="kq ig hi km b fi kv ks l kt ku">#remove Antarctica<br/>world_sans_antarctica &lt;- world_map %&gt;% <br/>  filter(ISO_A3 != "ATA")</span><span id="29c3" class="kq ig hi km b fi kv ks l kt ku">#check the data structure<br/>world_sans_antarctica</span><span id="2ff6" class="kq ig hi km b fi kv ks l kt ku">#create a world map plot to test is looks right<br/>ggplot() + <br/>  geom_sf(data = world_sans_antarctica)+<br/>  theme_minimal()</span><span id="a58e" class="kq ig hi km b fi kv ks l kt ku">#Create a new dataframe by filtering for Australia by ISO alpha 3 code<br/>world_AUS &lt;- world_sans_antarctica %&gt;%<br/>  filter(ISO_A3 == "AUS")</span><span id="c697" class="kq ig hi km b fi kv ks l kt ku">#plot a map with both a world shapefile and an Australia shapefile <br/>#here we use the Robinson coordinate reference system for accuracy</span><span id="fea8" class="kq ig hi km b fi kv ks l kt ku">ggplot() + <br/>  geom_sf(data = world_sans_antarctica) +<br/>  geom_sf(data=world_AUS, fill = "#EC8E55", color = "white")+<br/>  coord_sf(crs = 54030)+<br/>  theme_void()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es li"><img src="../Images/2979635d24fd923a86e9cf1fab499383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xvf18Npn56f5JRs3zDl9xA.png"/></div></div></figure><h1 id="c2f8" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">7.0在世界地图上绘制外部数据源(如世界银行)</h1><p id="fec2" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">就像在5.0中一样，也可以将外部数据集链接到世界地图。</p><p id="b83e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Andrew Wheiss为他的大学班级做了一个很好的例子，他从世界银行下载了世界发展指标，并把它们标在世界地图上。</p><p id="44e7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">下面是将预期寿命映射到全局shapefile的代码的简化版本。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="6a9a" class="kq ig hi km b fi kr ks l kt ku">#download "Admin 0 – Countries" from <a class="ae kg" href="https://www.naturalearthdata.com/downloads/110m-cultural-vectors/" rel="noopener ugc nofollow" target="_blank">https://www.naturalearthdata.com/downloads/110m-cultural-vectors/</a></span><span id="d587" class="kq ig hi km b fi kv ks l kt ku">#read in the world map shapefile<br/>world_map &lt;- read_sf("C:/Users/Charles F Coverdale/Desktop/ne_110m_admin_0_countries.shp")</span><span id="26f7" class="kq ig hi km b fi kv ks l kt ku">#remove Antarctica<br/>world_sans_antarctica &lt;- world_map %&gt;% <br/>  filter(ISO_A3 != "ATA")</span><span id="2358" class="kq ig hi km b fi kv ks l kt ku">#check the plot works<br/>ggplot() + <br/>  geom_sf(data = world_sans_antarctica)+<br/>  theme_minimal()</span><span id="854a" class="kq ig hi km b fi kv ks l kt ku">#get latest data from the World Bank<br/>install.packages("WDI")<br/>library(WDI)</span><span id="0dfa" class="kq ig hi km b fi kv ks l kt ku">#choose the development indicators for 2017<br/>indicators &lt;- c("SP.DYN.LE00.IN")</span><span id="b24c" class="kq ig hi km b fi kv ks l kt ku">wdi_raw &lt;- WDI(country = "all", indicators, extra = TRUE, <br/>               start = 2017, end = 2017)</span><span id="87ab" class="kq ig hi km b fi kv ks l kt ku">#check the data structure<br/>head(wdi_raw)</span><span id="f8f1" class="kq ig hi km b fi kv ks l kt ku">#extract the life expectancy column<br/>wdi_clean_small &lt;- wdi_raw %&gt;% <br/>  select(life_expectancy = SP.DYN.LE00.IN, iso3c)</span><span id="4d55" class="kq ig hi km b fi kv ks l kt ku">#check the data structure<br/>head(wdi_clean_small)</span><span id="1cd8" class="kq ig hi km b fi kv ks l kt ku">#join the shapefile and life expectancy data set together<br/>world_map_with_life_expectancy &lt;- world_sans_antarctica %&gt;% <br/>  left_join(wdi_clean_small, by = c("ISO_A3" = "iso3c"))</span><span id="b039" class="kq ig hi km b fi kv ks l kt ku">#produce a map of life expectancy across the world<br/>ggplot() + <br/>  geom_sf(data = world_map_with_life_expectancy, <br/>          aes(fill = life_expectancy),<br/>          size = 0.25) +<br/>  coord_sf(crs = 54030) +  # Robinson<br/>  scale_fill_viridis_c(option = "viridis") +<br/>  labs(fill = "Life expectancy") +<br/>  theme_void() +<br/>  theme(legend.position = "bottom")</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ca"><img src="../Images/ceb049b2a095b11b13e3e59bcbe31a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOltLzZUF2-Xi7C6pOfToA.png"/></div></div></figure><p id="6a20" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">该地图可以进一步细分为单个地区或洲。澳大利亚大陆没什么可看的(也就是说，没有各州的细分)，所以让我们试试非洲吧。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="bf37" class="kq ig hi km b fi kr ks l kt ku">#start with the data "world_sans_antarctica_fixed from the previous set<br/>#filter for the UN region called "Africa"<br/>world_Africa &lt;- world_sans_antarctica_fixed %&gt;% <br/>                     filter(REGION_UN == "Africa")</span><span id="e4e8" class="kq ig hi km b fi kv ks l kt ku">#check the data looks good<br/>world_Africa</span><span id="21fc" class="kq ig hi km b fi kv ks l kt ku">#produce the map (same function as previously)<br/>ggplot() + <br/>  geom_sf(data = world_Africa, <br/>          aes(fill = life_expectancy),<br/>          size = 0.25) +<br/>  coord_sf(crs = 54030) +  # Robinson<br/>  scale_fill_viridis_c(option = "viridis") +<br/>  labs(fill = "Life expectancy") +<br/>  theme_void() +<br/>  theme(legend.position = "bottom")</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es lj"><img src="../Images/f7cd860b5f97ea9b9c61506d05b2a880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*0erBs0SAgxsZ1i5aJyPO4w.png"/></div></figure><h1 id="0556" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">8.0后续步骤</h1><p id="6606" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在R中，你还可以用贴图做无数的事情，包括gganimate、R shiny和各种面包裹方法。</p><p id="e785" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">查看<a class="ae kg" href="https://github.com/charlescoverdale" rel="noopener ugc nofollow" target="_blank">我的github </a>或<a class="ae kg" href="http://www.charlescoverdale.com" rel="noopener ugc nofollow" target="_blank">网站</a>的未来帖子。</p></div></div>    
</body>
</html>