<html>
<head>
<title>Dog Breed Classifier 10 Minute Challenge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">犬种分类器10分钟挑战</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dog-breed-classifier-10-minute-challenge-6a78413ea2a2?source=collection_archive---------44-----------------------#2020-04-06">https://medium.com/analytics-vidhya/dog-breed-classifier-10-minute-challenge-6a78413ea2a2?source=collection_archive---------44-----------------------#2020-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/16508819248ba6f0349f689330899581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VstXOfJZZk-HA5gM"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@joeyc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔·凯恩</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="5db4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">狗品种检测一直是基本的视觉挑战之一。但是，我能多容易地构建一个性能相当好的轻型犬种分类器呢？</p><p id="8691" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了有点乐趣，我还会添加一个功能，将人脸分类到最接近的狗品种中:)</p><p id="570c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第一步:导入数据集</strong></p><p id="e323" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于人脸，我将使用野生(LFW)数据集中的标记人脸。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">加载LFW数据集</figcaption></figure><p id="0011" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我将加载狗数据集。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">导入狗数据集</figcaption></figure><p id="bd92" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们设想一下数据集的分区。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/f41bf4c27772b164d20e8efb87c21f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*QX97Oei02RwhFt2cYyV1AQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">培训、验证和测试集的比较</figcaption></figure><p id="49be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第二步:区分人和狗</strong></p><p id="38e0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了区分狗和人的脸，我将建立一个人脸检测器和一个狗检测器。</p><p id="51b4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了构建一个人脸检测器，我使用了OpenCV的HaarCascadeClassifier。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用OpenCV中的HaarCascadeClassifier检测人脸</figcaption></figure><p id="ee50" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦我们有了人脸检测器，就该构建狗检测器了，为此我将使用在ImageNet数据集上预训练的ResNet50模型</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="c6c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第三步:检测犬种</strong></p><p id="b57f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们可以区分狗和人脸，让我们继续检测狗的品种。</p><p id="b7fe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用迁移学习来创建一个使用预训练(ImageNet) ResNet50模型的CNN。首先，我们将使用模型获取数据集的瓶颈特征。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="1f3c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将提取的特征保存为<code class="du ka kb kc kd b">DogResnet50Data.npz</code></p><p id="9743" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们加载特征并创建我们的模型。我们添加了一个GlobalAveragePooling层，然后是一个Dropout层和一个Dense层。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">负载特征和模型</figcaption></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ke"><img src="../Images/8ab3ddf2f22cd7ccbcdadcf0c0f2b3f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*_2q2o05NGXbpJ_n8cQtk_A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型摘要</figcaption></figure><p id="d7db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们将在狗数据集上训练我们的模型。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="3330" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">快速训练在测试集上给了我们一个<code class="du ka kb kc kd b">80.7416%</code>的准确度。现在，让我们用这个模型来预测一些品种！我们将使用下面的函数<code class="du ka kb kc kd b">detect</code>。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="68b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤4:测试</strong></p><p id="437b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是时候尝试一下了！</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/1e3008233ce7669d548885dff2ce3af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJ6FRykYuyjCaBqZeQLiCA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">看到我们的结果</figcaption></figure><p id="6aa8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我得到了这些图像的以下结果(从左到右):</p><pre class="jt ju jv jw fd kg kd kh ki aw kj bi"><span id="b020" class="kk kl hi kd b fi km kn l ko kp">This is not a dog, but if it were, it would be a: Nova_scotia_duck_tolling_retriever</span><span id="4195" class="kk kl hi kd b fi kq kn l ko kp">This dog seems to be a: Kuvasz</span><span id="e552" class="kk kl hi kd b fi kq kn l ko kp">This dog seems to be a: Mastiff</span><span id="b8e4" class="kk kl hi kd b fi kq kn l ko kp">This is not a dog, but if it were, it would be a: Cavalier_king_charles_spaniel</span><span id="4535" class="kk kl hi kd b fi kq kn l ko kp">This is not a dog, but if it were, it would be a: French_bulldog</span><span id="4fd4" class="kk kl hi kd b fi kq kn l ko kp">This is not a dog, but if it were, it would be a: Beagle</span></pre><p id="d7b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:使用的人脸是用<a class="ae iu" href="https://www.thispersondoesnotexist.com/" rel="noopener ugc nofollow" target="_blank">https://www.thispersondoesnotexist.com/</a>生成的</p><p id="5409" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，这就是我如何在大约10分钟内建立一个狗品种分类器。希望你喜欢阅读这篇文章！</p></div></div>    
</body>
</html>