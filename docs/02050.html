<html>
<head>
<title>DB::Transaction !! The Laravel Sweet Hack #00….</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DB::交易！！拉勒维尔甜蜜黑客#00…</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/db-transaction-the-laravel-sweet-hack-00-ded131b71ec9?source=collection_archive---------13-----------------------#2019-11-27">https://medium.com/analytics-vidhya/db-transaction-the-laravel-sweet-hack-00-ded131b71ec9?source=collection_archive---------13-----------------------#2019-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="fb14" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">固执己见的观点</h1><p id="cc1b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">对我来说，Laravel是最好的php开发框架之一，除了对原始php的了解。我只使用过code igniter，slim，你可以支持我的观点，这是一个固执的观点，但我手头有事实(<em class="kb">改天再讲</em>)</p><h1 id="af97" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">少数黑客</h1><p id="835b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">黑客！！！</strong>是的，hack，根据我最小的语言用法库，hack是以简单的方式完成复杂事情的整洁方式。或者我们可以称之为让困难的事情看起来简单的好方法。</p><p id="64c6" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">如果我可以通过对我进行非常广泛的查询来获得一个关系的数据，这是一种黑客行为，这就是laravel为您提供的模型中属性的使用，惰性集合的使用以及它提供的所有其他相关ORM功能。</p><p id="feff" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">阴谋黑客</strong><strong class="jf hj"><em class="kb">数据库事务</em> </strong>赋予我们更安全地执行数据多次修改操作的能力，如<strong class="jf hj"> <em class="kb">删除、更新和插入</em> </strong>数据到我们的数据库。</p><p id="6d40" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">DB::transaction有一个<strong class="jf hj"> DB::commit() </strong>和<strong class="jf hj"> DB::rollback() </strong>，它们是基于正在执行的查询批的状态使用的。</p><h1 id="2df7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">引人深思的事</h1><p id="bfbf" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">给出了一个任务，要求做以下事情:您需要解析多个<strong class="jf hj"> CSV文件，每个文件有大约50k条记录</strong>，其中它应该首先删除所有记录，然后在数据库中插入所有记录。什么方法是可行的？？！！当你使用事务时，任务会做得很好。</p><p id="27bb" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj"> <em class="kb">伪代码</em> </strong> <em class="kb">为此会看起来像这样的东西</em></p><p id="bcbf" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">DB::transaction()</strong>/*开始事务*/</p><p id="4482" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><em class="kb">试试{ </em></p><p id="047e" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">while(($ data = fgetcsv($ exchange symbol))！= = false)/*读取csv记录*/</p><p id="23e7" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">if(count($ row data)= = 10000){ DB::table(' all _ securities ')-&gt; insert($ row data)；unset($ row data)；} /*获取前10000条记录并尝试插入它们*/</p><p id="1faa" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">DB::commit()</strong>；/* Commit Transaction */}<em class="kb">catch(\ Exception $ e){</em>//回滚事务DB::roll back()；} fclose($ exchange symbol)；</p><p id="7e0a" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这是一种更简单的看待问题的观点。您可能会注意到，我们插入了10，000条记录。我们可以根据我们的需要/数据库服务器来改变这个限制。</p><p id="3b74" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">因此，在我们的示例中，如果在while循环中的删除操作或插入操作引发了任何异常，事务将在catch块中回滚，并且不会发生任何数据库更改。如果一切顺利，我们提交交易。</p><p id="5b17" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">谢谢DB::transaction() </strong></p><p id="1bfc" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">如果它值得别人欣赏，请鼓掌欢迎。干杯</p><p id="85b6" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"># laravel # laravelhacks # simpler code</p></div></div>    
</body>
</html>