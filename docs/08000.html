<html>
<head>
<title>Data Preprocessing before model training</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模型训练前的数据预处理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-pre-processing-before-model-training-7e741e9cb253?source=collection_archive---------8-----------------------#2020-07-14">https://medium.com/analytics-vidhya/data-pre-processing-before-model-training-7e741e9cb253?source=collection_archive---------8-----------------------#2020-07-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ca92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你已经有了一个数据集，你已经准备好开始模型训练和预测，但是请等待！这些数据准备好训练算法了吗？你们可能都知道答案，一个很大的否定。那么，有哪些东西可以让我们的数据为建模做好准备呢？以下是需要遵循的步骤，通常称为<em class="jd">数据预处理</em>技术:</p><ol class=""><li id="4ebb" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">导入库</li><li id="3798" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">读取数据集</li><li id="8e30" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">检查和处理缺失值</li><li id="d1e8" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">编码技术</li><li id="b2f4" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">特征缩放</li><li id="a96d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">分割数据集</li></ol><p id="6a22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们一个一个地来看这些:</p><p id="f1e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">导入库:</strong>首先，我们需要导入所有必要的python库，这些库在所有步骤中都要用到。导入<em class="jd">熊猫</em>很重要，因为它有助于读取不同格式的文件(csv、excel、json等)。Pandas提供了各种操作和分析数据的选项。同样，<em class="jd"> numpy </em>对于我们的数据进行数学运算也很有帮助。需要时，还可以导入所有其他库。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/27012c1bcf77f7929da742ad995e9e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*7hHoPUqzJ1-lfkvwP8k_hg.jpeg"/></div></figure><p id="9527" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">读取数据集:</strong> Pandas帮助将不同格式的文件读取到Pandas数据帧中:这是一个创建二维表(行和列)的构造函数，该表是可变的，可以包含异构数据。这里我要借用一个数据集(确保数据文件与工作笔记本在同一个路径下)。Doing data.head()将显示前5行(从索引0开始)。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ka"><img src="../Images/06071e5f1403495374a03ca1c5508a11.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*NetuFj0UB1g2W8Psxp-gmw.jpeg"/></div></div></figure><p id="5f29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">检查缺失值:</strong>一旦加载了数据，第一件事就是检查空值或任何缺失值。所有机器学习算法都无法处理具有空值的数据集。下面的代码片段说明了哪些列包含缺少的值。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kf"><img src="../Images/0d2160ad4f0fea3eb3d6245c7a05c0cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*y8WQN4uLZqynkuF6c2VY6g.jpeg"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kg"><img src="../Images/53b5790626f0e57cba91cb8a21ddc642.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*dmL4pWh6t0cZ7Jk3wR6XHw.jpeg"/></div></figure><p id="e06c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在的主要部分是删除这些丢失的值。对于分类变量，我们通常用模式替换丢失的值。对于数字特征，有均值插补、中值插补、分组插补和KNN插补。向前填充和向后填充也用于用正好在丢失值之前或之后的值来填充丢失的值。还需要分析数据，了解缺失值的域和模式。</p><p id="52a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一种方法可以通过使用机器学习方法来计算缺失值。在这种情况下，可用数据是训练数据，缺失值数据是预测数据。使用回归或分类算法，我们可以预测丢失的值。(只是附上2个片段供参考)。你可以在这里查看一个深入讨论缺失值类型的内容丰富的博客<a class="ae kh" rel="noopener" href="/@dikshabellani.2803/handling-missing-values-bb8b549364cc?sk=e8e564953e9039429d1715d23acb8315">。</a></p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ki"><img src="../Images/278a55e4a3fb088e323205e8a9f978c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*QI0oTw6mG6HI7Nrh36t-Kw.jpeg"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kj"><img src="../Images/180b0360e4769f45acd7abed04bb7a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*xtXRx1x08R2xs-o3v0RDEQ.jpeg"/></div></figure><p id="6ced" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">编码技术:</strong>机器学习算法只对数字数据起作用。如果有任何分类列，那么它们将被编码成数值。有两种方式来执行编码:标签编码和一个热编码。标签编码是对顺序数据进行的，值被分配给列中的每个唯一标签。一个热编码(也称为虚拟变量)用于名义数据。这里所有的唯一值都被赋予1或0，因此也称为二进制编码。每个唯一值都被转换为一列。所有这些编码值都从0开始，只是分类值的表示。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kk"><img src="../Images/075c1698d3bbb3f51c0159cf512767d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*jC7ukv9J69-lF4SAZbQGuw.jpeg"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">展示标签编码如何工作的示例</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kp"><img src="../Images/801040ffeaf2771fda8d5815c1071de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*EuXSZAA0iCwqiDNtGkPq_A.jpeg"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">标签编码前后</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kq"><img src="../Images/ecdc233cfa8694a51a7a8efbdf54f649.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*-v0Ke4v_CP4q7iM2P2o8FQ.jpeg"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">位置有6个唯一值</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kr"><img src="../Images/44eb8a5c8ae5d7a5137ef46176be7880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uB05blF1rBPUj8hzivmSXg.jpeg"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">在应用一次热编码后，每个唯一值都被转换为仅包含二进制值的列。1表示该位置</figcaption></figure><p id="3e42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">特征缩放:</strong>有时在训练模型时，有必要将所有数值变量的范围调整到一个共同的比例。这有助于在培训时同等重视所有变量。规范化和标准化是两种最常见的技术。在标准化中，这些值被缩小到0到1或-1到1的范围。在标准化中，这些值的均值为零，方差为1。</p><p id="3fd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，你们可以浏览这个关于<a class="ae kh" rel="noopener" href="/@nishant.shah0209/feature-selection-techniques-1a99e61da222">特征选择</a>技术的博客，因为这也是一个需要考虑的重要因素。</p><p id="ef29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">拆分数据:</strong>现在在给定数据训练模型的同时，我们将给出一部分数据进行训练，保留剩余的数据作为测试数据。一般来说，划分为20%的测试数据和80%的训练数据(但这不是固定的，您可以根据数据的大小取任何值)。这将有助于通过比较预测值和测试数据值来了解我们的预测有多准确。变量的顺序应该和给定的一样。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ks"><img src="../Images/319a95eef4be083c8d7437c0c1f16041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HLWBcpCEfeaDsNqwtWbhUQ.jpeg"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">测试规模为20%</figcaption></figure><p id="5a36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您已经准备好了预处理步骤，可以开始模型训练了。</p></div></div>    
</body>
</html>