<html>
<head>
<title>Logistic Regression in Simple words</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单的逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-in-simple-words-f747a202ddfe?source=collection_archive---------15-----------------------#2019-12-01">https://medium.com/analytics-vidhya/logistic-regression-in-simple-words-f747a202ddfe?source=collection_archive---------15-----------------------#2019-12-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/91d474877a505904b665003d20cb8f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wgDiDEpoK5rE21pHfPy1yA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">美国国家航空航天局拍摄的照片——夜晚地球大气的天体视图</figcaption></figure><p id="d3cd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这篇文章中，我们将看到逻辑回归的基本概念，并试图用简单的数学术语来解释它。</p><p id="d5bf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们开始吧..</p><p id="9f9d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">逻辑回归是机器学习中最流行和广泛使用的监督学习算法和分类技术之一，用于预测分类变量。</p><p id="8578" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">很少有实时应用程序，</p><p id="1944" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">a.在线交易中的欺诈检测(是或否)</p><p id="15c7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">b.电子邮件分类(垃圾邮件或非垃圾邮件)</p><p id="bd89" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">c.癌症检测(是否为癌症)</p><p id="a6ba" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">d.降雨预报..等等</p><h1 id="0d5a" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">分类类型</h1><p id="9802" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">有两种分类</p><ol class=""><li id="bd9a" class="kv kw hi iw b ix iy jb jc jf kx jj ky jn kz jr la lb lc ld bi translated">二元分类—最终结果是二元的，例如是/否、1/0、成功/失败..等等</li><li id="3180" class="kv kw hi iw b ix le jb lf jf lg jj lh jn li jr la lb lc ld bi translated">多类分类—最终结果有两种以上的可能性，例如差/一般/好。</li></ol><h2 id="bde3" class="lj jt hi bd ju lk ll lm jy ln lo lp kc jf lq lr kg jj ls lt kk jn lu lv ko lw bi translated">它与线性回归有什么不同？</h2><p id="611e" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">线性回归是一种数学技术，它在与实际值的平均偏差最小的数据点上绘制直线，因此我们可以使用该直线来预测未来的输入值。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/017f24fbe52dd22a2cf5d40e454a68b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*QHqi36j1qdNYHtTAsQcxhw.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">线性回归</figcaption></figure><p id="5f18" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">另一方面，逻辑回归是一种分类技术，通过基于其各自具有最小损失函数的结果值绘制<strong class="iw hj">决策边界</strong>来分离数据点。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/f4436b8e83bb3dac2942f242e6720232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*n2Yhin53lFn-7xloKg_sfQ.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">逻辑回归</figcaption></figure><p id="90db" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">除了使用直线来分隔数据点之外，线性回归和逻辑回归没有任何共性。</p><p id="61ac" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">好吧！那么它是如何从数学上分离数据点的呢？让我们从一个简单的例子开始，这样我们可以直观地理解算法是如何工作的。</p><p id="b6a1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">假设我们有两个训练示例—我们有一个重量为85.5克、周长为8.25英寸的网球示例，而另一个样本足球重量为450克、周长为22英寸，现在我们的目标是要求逻辑算法根据标记数据的特征值对给定样本进行分类。</p><p id="47ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="md">球重=变量一= x1 =</em>【85.5，450】</strong></p><p id="4788" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="md">球周长=变量二= x2 =【8.25，22】</em></strong></p><p id="29da" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="md">球类型=输出= y =【网球、足球】</em> </strong></p><p id="67dc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在继续之前，让我们把数据形象化，这样更容易理解这个想法。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/11642d0ac519ffbc5370f47563c353a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-N2boT7BECFN4k-D70mCrg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">可视化给定数据</figcaption></figure><p id="a2a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请记住，我们的目标是绘制基于特征值(x1，x2)分隔数据点的线，我们将抵制自己绘制分类器的诱惑，而是寻求算法的帮助，因为它可以处理大量的训练样本，这是人类不可能做到的。</p><p id="4075" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">实现这一点的一种方法是随机绘制多个分类器，并选择对训练数据和测试数据都表现良好的分类器。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/d993bc16ca6c22569c5bf061ff9699dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SK1lPJTCS-05jJ7lAqF1Kg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">随机线分类器</figcaption></figure><p id="7aa9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是我们可以绘制的随机线分类器之一，但这实际上并没有分离数据点，因此我们无法说出哪个是足球，哪个是网球。因此，随机选择分类器不是解决问题的有效方法，尤其是当数据量增加时。</p><p id="5ca7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">sigmoid函数通过使用其优雅的数学特性，实际上可以帮助我们找到最准确的分类器。</p></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><h1 id="f365" class="js jt hi bd ju jv mm jx jy jz mn kb kc kd mo kf kg kh mp kj kk kl mq kn ko kp bi translated">Sigmoid函数</h1><p id="1461" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">我们可以如下定义sigmoid函数。</p><blockquote class="mr"><p id="d209" class="ms mt hi bd mu mv mw mx my mz na jr dx translated">1/1+e^(- z)</p></blockquote><p id="db40" class="pw-post-body-paragraph iu iv hi iw b ix nb iz ja jb nc jd je jf nd jh ji jj ne jl jm jn nf jp jq jr hb bi translated">我们先来了解一下公式。乙状结肠的功能是什么？简单地说，如果你为z插入任何值，sigmoid函数将产生0到1之间的数。</p><p id="6e4a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">不要害怕“e”这个术语，它被称为“欧拉数”，属于<strong class="iw hj"> <em class="md">超越</em> </strong>数，在数学上具有有趣的性质，请参考【https://en.wikipedia.org/wiki/Transcendental_number】的了解更多信息，现在就把它想象成常数数值<strong class="iw hj"> 2.71828182845 ……… </strong>继续。</p><p id="7806" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">举个例子，</p><p id="9010" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果z = 3，sigmoid函数将产生接近1的值0.9526</p><p id="55d7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果z = -3，sigmoid函数将产生接近于0的值0.047</p><pre class="ly lz ma mb fd nh ni nj nk aw nl bi"><span id="06af" class="lj jt hi ni b fi nm nn l no np">z = 3<br/>g = 1/(1+(np.exp(-z)))</span><span id="e7ef" class="lj jt hi ni b fi nq nn l no np">print(g)</span><span id="fdb3" class="lj jt hi ni b fi nq nn l no np">Output : 0.9525741268224334</span></pre><p id="fa78" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">由此可以看出，当z &gt; 0时，g(z)将趋近于1，当z&lt;0 then g(z) will approach 0 and when z = 0 , g(z) is exactly 0.5 .</p><p id="2726" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">We can visualise the sigmoid function in below graph for the mix of -ve and +ve values .</p><pre class="ly lz ma mb fd nh ni nj nk aw nl bi"><span id="e0ba" class="lj jt hi ni b fi nm nn l no np">z = [-10,-8,-6,0,2,3,4,10]</span><span id="f0fa" class="lj jt hi ni b fi nq nn l no np">f = []<br/>for i in range (0,len(z)):<br/>    g = 1/(1+(np.exp(-z[i])))<br/>    #print(g)<br/>    f.append(g)<br/>print(f)</span><span id="f6a6" class="lj jt hi ni b fi nq nn l no np">f = [4.5397868702434395e-05, 0.0003353501304664781, 0.0024726231566347743, 0.5, 0.8807970779778823, 0.9525741268224334, 0.9820137900379085, 0.9999546021312976]</span></pre><p id="288d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">For the above value of ‘z’ , we will get the sigmoid function as below graph..</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es nr"><img src="../Images/e784d51ae323194d140fd38c78bf5d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*5hy5XoFYxatBO0pA3QUYgA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Sigmoid Function</figcaption></figure><blockquote class="mr"><p id="8bd5" class="ms mt hi bd mu mv ns nt nu nv nw jr dx translated">Intuition of using sigmoid function is to find right the decision boundary (separating line) , line equation θ^t * x ≥ 0 or θ^t * x &lt; 0 , in either one of the way we can achieve the classifier which separates two different probability of events .</p></blockquote><h1 id="8643" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd nx kf kg kh ny kj kk kl nz kn ko kp bi translated">Hypothesis and cost function</h1><p id="65c4" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">Since we are going to plot the decision boundary as linear line or polynomial line, it is obvious that we will need a line equation. At the same time we want the line to be a classifier of probability of an event hence we are plugging the line equation in to sigmoid function.</p><p id="4a21" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Hypothesis for logistic regression is as follows,</p><blockquote class="mr"><p id="6393" class="ms mt hi bd mu mv mw mx my mz na jr dx translated"><strong class="ak"><em class="oa">h(x)= g(z)= g(θ^t * x)= 1/(1+e^(-θ^t * x))</em></strong></p></blockquote><blockquote class="ob oc od"><p id="44f2" class="iu iv md iw b ix nb iz ja jb nc jd je oe nd jh ji of ne jl jm og nf jp jq jr hb bi translated">在逻辑回归中，成本函数是实际结果和假设之间的分类差异。</p></blockquote><p id="2a89" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="md">逻辑回归成本函数如下</em></p><blockquote class="mr"><p id="1f3c" class="ms mt hi bd mu mv mw mx my mz na jr dx translated"><em class="oa"> cost(h(x)，y) = { -log(h(x)如果y = 1；-log(1-h(x))如果y = 0} </em></p></blockquote><p id="33ad" class="pw-post-body-paragraph iu iv hi iw b ix nb iz ja jb nc jd je jf nd jh ji jj ne jl jm jn nf jp jq jr hb bi translated"><em class="md">如果h(x) = 1且y =1，则J(θ) = 0 </em></p><p id="8504" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="md">如果h(x) = 1且y =0，则J(θ)接近∞ </em></p></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><p id="2680" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们使用上一个例子中的sigmoid函数来查找分类器。</p><p id="abd9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们希望g(z) ≥ 0 .5，只有当z≥0时才有可能</p><p id="3792" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里z = <strong class="iw hj"> <em class="md"> θ^t * x </em> </strong></p><p id="b283" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">于是，<strong class="iw hj"><em class="md">θ^t * x≥0；</em>θ^t * x =</strong>θ0+θ1x1+θ2x 2)</p><p id="43fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们知道x1和x2的值，但是θ0、θ1和θ2是未知的，并且必须通过优化算法(如梯度)来计算，让我们假设我们已经使用具有如下最小成本函数的梯度下降找到了参数。</p><p id="1e11" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们来考虑，参数θ为→ [9.7，2.09，-0.47]</p><p id="fc6c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们得到决策边界方程为，9.7 + 2.09 x1- 0.47 x2 ≥ 0，由此我们可以将数据点拆分为两个事件的概率。</p><p id="9044" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们只需要两个端点来绘制决策边界，因此上述等式也可以重新表述为:</p><p id="c642" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">X2 =(-9.7x 0)-(2.09 x1)/-0.47 =[57.49837741，401.93286108]</p><p id="a450" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">X1 = min(x1)，min (x2) = [8.25，85.5]</p><p id="a5e0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，通过绘制这条连接上述两个X1和X2的线，我们将得到分隔我们的数据点(在示例中为球重量和周长)的决策边界的近似值，如下所示:</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es nr"><img src="../Images/055a340572c9dcaeb4396cbf0e55851d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*IvEIuz9hPl_LIZo0SVNRjA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">训练数据的决策边界</figcaption></figure><p id="ae7e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">酷！我们基于其可能的结果(这里是网球、足球)在数学上分离了两个数据点，因此当我们得到新的输入特征x1、x2时，我们可以说它属于网球还是足球的类别。</p><p id="f176" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">例如，如果我们输入新的球重量→ 50，周长→ 15.5，它将被假设为网球，因为它低于决策边界，反之亦然。</p><p id="79ba" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">确切的方法也可以用于具有许多特征的较大数据点，但是基于我们的目标和数据的性质，我们可能需要通过添加多项式和一些其他调整技术来弯曲线，无论基本概念如何保持不变，</p><blockquote class="mr"><p id="cfb5" class="ms mt hi bd mu mv mw mx my mz na jr dx translated">“我们需要一个好的分类器来根据可能的结果将数据点分成两个或更多，该分类器将用于未知的新数据点，以预测其结果”。</p></blockquote><h1 id="46cc" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd nx kf kg kh ny kj kk kl nz kn ko kp bi translated">结束注释</h1><p id="1f34" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">逻辑回归是一种广泛使用的分类技术，与线性回归相比，它可能看起来有点复杂，但一旦我们理解并用一些小数据集实现它，我们就可以意识到它是一种多么优雅和简单的分类和预测分类变量的技术。</p><p id="dd02" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">也参考我以前的博客来了解NumPy中的<a class="ae ng" rel="noopener" href="/analytics-vidhya/simple-linear-regression-with-example-using-numpy-e7b984f0d15e">线性回归</a>。</p><blockquote class="mr"><p id="d2c1" class="ms mt hi bd mu mv mw mx my mz na jr dx translated">为了更好的未来，继续努力！！</p></blockquote></div></div>    
</body>
</html>