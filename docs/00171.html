<html>
<head>
<title>Building a Flower Classifier using Fast.ai</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Fast.ai构建花卉分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-flower-classifier-using-fast-ai-a815f9b25a04?source=collection_archive---------1-----------------------#2018-10-30">https://medium.com/analytics-vidhya/building-a-flower-classifier-using-fast-ai-a815f9b25a04?source=collection_archive---------1-----------------------#2018-10-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0a26" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用ResNet-34</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/467a27d44b068058230dc7d728b60f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qWzryR2lks9myW2gSxFFw.jpeg"/></div></div></figure><p id="2ca5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为了构建我们的花分类器，我们将使用Kaggle提供的<a class="ae kf" href="https://www.kaggle.com/alxmamaev/flowers-recognition/home" rel="noopener ugc nofollow" target="_blank">花识别数据集</a>。图片分为五类:雏菊、郁金香、玫瑰、向日葵、蒲公英。每个班级大约有800张照片。</p><h2 id="787f" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated">将数据分为训练集和验证集</h2><p id="cb26" class="pw-post-body-paragraph jj jk hi jl b jm lb ij jo jp lc im jr js ld ju jv jw le jy jz ka lf kc kd ke hb bi translated">由于我们的数据还没有被分成训练集和验证集，我们将使用“os”和“shutil”模块对它们进行单独划分。(假设数据集的当前路径是data/flowers-kaggle)</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lg lh l"/></div></figure><h2 id="0681" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated">导入包和设置批量大小</h2><p id="6195" class="pw-post-body-paragraph jj jk hi jl b jm lb ij jo jp lc im jr js ld ju jv jw le jy jz ka lf kc kd ke hb bi translated">既然我们的训练和验证集已经就绪，让我们导入必要的包并设置我们的批量大小。我们将与位于<a class="ae kf" href="https://hackernoon.com/pytorch-1-0-468332ba5163" rel="noopener ugc nofollow" target="_blank"> Pytorch 1.0 </a>之上的<a class="ae kf" href="http://www.fast.ai/2018/10/02/fastai-ai/" rel="noopener ugc nofollow" target="_blank"> fastai V1库</a>合作。</p><pre class="iy iz ja jb fd li lj lk ll aw lm bi"><span id="6405" class="kg kh hi lj b fi ln lo l lp lq">from fastai import *<br/>from fastai.vision import *</span><span id="7b45" class="kg kh hi lj b fi lr lo l lp lq">bs = 64</span></pre><h2 id="061b" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated">看着这些数据</h2><p id="d21e" class="pw-post-body-paragraph jj jk hi jl b jm lb ij jo jp lc im jr js ld ju jv jw le jy jz ka lf kc kd ke hb bi translated">我们<em class="ls">总是</em>需要很好地理解问题是什么，数据看起来像什么，然后才能想出如何解决它。查看数据意味着了解数据目录的结构，标签是什么，以及一些示例图像是什么样子。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="0e15" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">您的输出应该如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lt"><img src="../Images/caad1e02b5c07c3363b12b6da27b8153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RrxjklVj6AhUcS4Pisjbiw.png"/></div></div></figure><h2 id="9e97" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated">培训:resnet34</h2><p id="1943" class="pw-post-body-paragraph jj jk hi jl b jm lb ij jo jp lc im jr js ld ju jv jw le jy jz ka lf kc kd ke hb bi translated">我们现在使用resnet34卷积神经网络模型的预训练权重来<a class="ae kf" href="https://sajfd-hfafbjhd-akshaye.herokuapp.com" rel="noopener ugc nofollow" target="_blank">到</a>训练我们的模型。我们将为训练<a class="ae kf" href="http://people.tamu.edu/~akshayeap/sajfd-hfafbjhd.html" rel="noopener ugc nofollow" target="_blank">4个时期(通过我们所有数据的4个周期)。</a></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lu"><img src="../Images/3c2caf0cddf42c6fe2e6b46a623dbbe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*fFdOM51UzzLPjA7SpnDSkg.png"/></div></figure><p id="8f81" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">恭喜你！我们的模型现在已经训练好了，你可以看到它的准确率超过了90%。</p><h2 id="30f8" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated">在自定义输入上测试我们的分类器</h2><p id="7337" class="pw-post-body-paragraph jj jk hi jl b jm lb ij jo jp lc im jr js ld ju jv jw le jy jz ka lf kc kd ke hb bi translated">我们可以测试我们的分类器，向它传递我们选择的任何图像，并观察它的工作情况。为此，我们需要创建一个名为test的文件夹，并将我们的自定义文件放入其中。要查看分类器的输出，我们首先获取图像上所有类别的预测，挑选具有最高预测的类别，然后返回该类别的类别标签:</p><p id="4604" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">输入图像:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lv"><img src="../Images/c150ed2ade048c84898d6a8e756bd288.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*Enn5Ldg-LmL3BqCF57ZuWQ.jpeg"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lw"><img src="../Images/ddf868a563f8b2828d791890bf3c79fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*1sViJ4OfujIpU2ysYbhkVQ.png"/></div></figure></div></div>    
</body>
</html>