<html>
<head>
<title>Fraudulent Transaction Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">欺诈交易预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/fraudulent-transaction-prediction-6888c4ca8031?source=collection_archive---------14-----------------------#2019-11-14">https://medium.com/analytics-vidhya/fraudulent-transaction-prediction-6888c4ca8031?source=collection_archive---------14-----------------------#2019-11-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="4e28" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">目标</strong> : <strong class="ak">识别&amp;预测欺诈交易</strong></h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/bfc11b5738fbf42edc3a9c8ca9a9789f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMed81vpgzbojWx15acO9A.png"/></div></div></figure><p id="6a33" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">根据《福布斯》的数据，2015年，银行和商户因全球发行的所有信用卡、借记卡和预付费通用支付卡和自有品牌支付卡而遭受的欺诈损失达到218.4亿美元，其中美国占84.5亿美元，占总数的近五分之二(38.7%)。但到2020年，如果全球增长率达到45%，欺诈损失可能超过120亿美元..</p><h1 id="b19e" class="kf kg hi bd kh ki kj kk kl km kn ko kp io kq ip kr ir ks is kt iu ku iv kv kw bi translated"><strong class="ak">数据集:</strong></h1><ul class=""><li id="4dd0" class="kx ky hi jl b jm kz jp la js lb jw lc ka ld ke le lf lg lh bi translated">来源<a class="ae li" href="https://www.kaggle.com/c/ieee-fraud-detection/overview" rel="noopener ugc nofollow" target="_blank">Kaggle.com</a>；Vesta提供的数据</li><li id="8da3" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">形状(大小):590540条记录，433个特征</li><li id="6026" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">更多信息(<a class="ae li" href="https://www.kaggle.com/c/ieee-fraud-detection/data" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/ieee-fraud-detection/data</a>)</li><li id="806d" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">问题:二元分类</li></ul><p id="385c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">代码:</strong>T12】https://github.com/aabdygaziev/capstone-project</p><p id="ff64" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">挑战:</strong>大数据集，大量缺失值，不平衡数据，特征选择。</p><p id="e8ba" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">我解决问题的方法:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lo"><img src="../Images/3e3469e6d40781f2c3b9a2069e47c141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F469Vz8ZTBcrvezTQLIiCg.png"/></div></div></figure><p id="fe91" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">使用的工具:</strong></p><ul class=""><li id="71a4" class="kx ky hi jl b jm jn jp jq js lp jw lq ka lr ke le lf lg lh bi translated">大蟒</li><li id="7d92" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">熊猫，scikit-learn，imblearn，mlxtend，lightgbm</li></ul><p id="c9d4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">方法学:</strong></p><ul class=""><li id="3c3e" class="kx ky hi jl b jm jn jp jq js lp jw lq ka lr ke le lf lg lh bi translated">合成少数过采样技术— SMOTE</li><li id="0904" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">插补方法—简单插补器</li><li id="d43f" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">特征选择</li></ul><p id="b3ff" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">问题的相关性</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/27f3c05a19c7a76aa6e3f503e76ecd51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fmEiIlkUHenwf0wiyzUNbg.png"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">1美元欺诈的成本(来源:LexisNexis)</figcaption></figure><p id="541c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">最大的输家</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lx"><img src="../Images/d9b560224922a491484baca16e30f619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eAcrubpJkzEaptc93p1fiw.png"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">LexisNexis的研究</figcaption></figure><p id="c6ce" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">数据清洗:</strong>清洗过程非常重要。在你做分析和建立模型之前，清理你的数据。在我的例子中，我为缺失值设置了20%的阈值水平。如果某个要素的缺失值超过20%，则该要素将被丢弃。其余符合要求的，其值是估算的。此外，位于0.025和0.975分位数的异常值将被移除。捕获了99.5%的数据。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ly"><img src="../Images/42b747ddf2aae54666a57e6adf3521c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*2vTwIrqdELKJY-tpheO7GA.jpeg"/></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">正态分布曲线</figcaption></figure><p id="76bb" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">功能选择:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lz"><img src="../Images/c5a2e55fa97a67d0332c13c6eb64ee64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*GVC6qe1b-Fw4qtS8OAws4g.png"/></div></figure><p id="aa36" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在实施特征选择方法后，这些特征被证明是重要的特征:</p><ul class=""><li id="5149" class="kx ky hi jl b jm jn jp jq js lp jw lq ka lr ke le lf lg lh bi translated">C1-C14(计数，例如找到多少地址与支付卡相关联，等等。实际意义被掩盖)</li><li id="3e7b" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">交易金额</li><li id="d4e2" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">TransactionDT(给定参考日期时间的时间增量)</li><li id="71d0" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">card1 — card6(支付卡信息，如卡类型、卡类别、发行银行、国家)</li><li id="8c44" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">D1-D15:时间差值，如前一次事务处理之间的天数</li><li id="5dfd" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke le lf lg lh bi translated">vxxxx:Vesta设计了丰富的功能，包括排名、计数和其他实体关系。</li></ul><p id="48e4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">不平衡数据集:</strong>这个数据集非常不平衡。只有3.5%被标注为1(诈骗)，96.5%为0(非诈骗)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ma"><img src="../Images/839ba074b290428585d66785dd4d90ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*LLyNzOIeFceQeoL1e5Xs_g.png"/></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">不平衡的目标数据</figcaption></figure><p id="9650" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">对你的目标数据进行重采样是很重要的，否则你的模型会过度适应多数类，性能会很差。</p><p id="f6a8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">SMOTE——合成少数过采样技术。这是一种过采样方法，其中通过创建“<em class="mb">合成</em>”示例对少数类进行过采样，而不是通过替换进行过采样。</p><p id="5a83" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果您想了解更多关于SMOTE的信息:<a class="ae li" href="https://www.cs.cmu.edu/afs/cs/project/jair/pub/volume16/chawla02a-html/node6.html#SECTION00042000000000000000" rel="noopener ugc nofollow" target="_blank">https://www . cs . CMU . edu/AFS/cs/project/Jair/pub/volume 16/chawla 02 a-html/node 6 . html # section 0004200000000000</a></p><h1 id="557f" class="kf kg hi bd kh ki kj kk kl km kn ko kp io kq ip kr ir ks is kt iu ku iv kv kw bi translated"><strong class="ak">造型</strong></h1><p id="5722" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js mc ju jv jw md jy jz ka me kc kd ke hb bi translated">在这个项目中，我试图适应几个模型:</p><ol class=""><li id="ccf6" class="kx ky hi jl b jm jn jp jq js lp jw lq ka lr ke mf lf lg lh bi translated">RandomOverSampler，LinearSVC(重采样，模型)AUC 0.52</li><li id="51a2" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">BalancedRandomForestClassifier，— AUC 0.54</li><li id="5850" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">SMOTE，RandomForestClassifier — AUC 0.71</li><li id="5807" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">SMOTE，XGBClassifier — AUC 0.63</li><li id="899f" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">SMOTE，堆叠概化器(2级)— AUC 0.73</li><li id="d0c3" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">SMOTE，GridSearch，LightGBM。LGBMClassifier — AUC .97</li></ol><p id="2550" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最佳模型:<strong class="jl hj"> SMOTE，GridSearch，LightGBM。LGBMClassifier — AUC .97 </strong></p><p id="03e3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">模型的决策树:<strong class="jl hj"> LightGBM。LGBMClassifier </strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mg"><img src="../Images/2fc50ff31e645b98f5c3aeea0bc4fc23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VjNrbr_ya22zuzqd3RLSBQ.png"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">树的快照</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/1c27640cf468865b7202c7f82f444436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9iV9J4cIOoltyvkuxtHhsQ.png"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">树的全景</figcaption></figure><h2 id="6afb" class="mi kg hi bd kh mj mk ml kl mm mn mo kp js mp mq kr jw mr ms kt ka mt mu kv mv bi translated"><strong class="ak">本项目的主要收获:</strong></h2><ol class=""><li id="7208" class="kx ky hi jl b jm kz jp la js lb jw lc ka ld ke mf lf lg lh bi translated">有一个明确的目标。你在解决什么问题？</li><li id="f7f2" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">研究你的问题:当其他人试图解决这个问题时，他们面临的挑战是什么？(例如，“不平衡数据集”)</li><li id="976c" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">了解您的数据集；研究你有什么信息，你能用它做什么</li><li id="580f" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">检查你的数据:丢失的值，不相关的功能，重复等…</li><li id="e37b" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">数据工程:努力降低数据的维数</li><li id="0379" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">总是试图用最少的特征来构建你的模型</li><li id="d76c" class="kx ky hi jl b jm lj jp lk js ll jw lm ka ln ke mf lf lg lh bi translated">检查你的结果；调整参数以获得更好的结果，并进行测试</li></ol></div></div>    
</body>
</html>