# æœç”¨ç±»å›ºé†‡çš„ç†ŠçŒ«:Dask-ä½¿ç”¨ python ä»£ç çš„ç«¯åˆ°ç«¯æ•°æ®ç§‘å­¦

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/pandas-on-steroids-dask-end-to-end-data-science-with-python-code-1845d3722c8a?source=collection_archive---------7----------------------->

## ç«¯åˆ°ç«¯å¹¶è¡Œæ•°æ®ç§‘å­¦ä»è¯»å–å¤§æ•°æ®åˆ°æ•°æ®æ“ä½œåˆ°å¯è§†åŒ–å†åˆ°æœºå™¨å­¦ä¹ 

![](img/d1aceb2065f54fc0bf81f3bff7224dd9.png)

æ‹¥æœ‰è¶…èƒ½åŠ›çš„ç†ŠçŒ«

ä¿—è¯è¯´ï¼Œä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶ 90%çš„æ—¶é—´èŠ±åœ¨æ¸…ç†æ•°æ®ä¸Šï¼Œ10%çš„æ—¶é—´èŠ±åœ¨æŠ±æ€¨æ•°æ®ä¸Šã€‚ä»–ä»¬çš„æŠ±æ€¨å¯èƒ½åŒ…æ‹¬æ•°æ®å¤§å°ã€é”™è¯¯çš„æ•°æ®åˆ†å¸ƒã€ç©ºå€¼ã€æ•°æ®éšæœºæ€§ã€æ•°æ®æ•è·ä¸­çš„ç³»ç»Ÿé”™è¯¯ã€è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¹‹é—´çš„å·®å¼‚ç­‰ç­‰ã€‚

ä¸€ä¸ªå¸¸è§çš„ç“¶é¢ˆä¸»é¢˜æ˜¯æ•°æ®è§„æ¨¡å·¨å¤§ï¼Œè¦ä¹ˆæ•°æ®ä¸é€‚åˆå†…å­˜ï¼Œè¦ä¹ˆå¤„ç†æ—¶é—´å¤ªé•¿(å¤§çº¦å‡ åˆ†é’Ÿ),ä»¥è‡³äºå›ºæœ‰çš„æ¨¡å¼åˆ†æå˜å¾—æ¯«æ— æ„ä¹‰ã€‚æ•°æ®ç§‘å­¦å®¶å¤©ç”Ÿå°±æ˜¯å¥½å¥‡çš„äººï¼Œä»–ä»¬æƒ³è¦è¯†åˆ«å’Œè§£é‡Šé€šå¸¸éšè—åœ¨ç²—ç•¥çš„æ‹–æ”¾æµè§ˆä¸­çš„æ¨¡å¼ã€‚ä»–ä»¬éœ€è¦èº«å…¼æ•°èŒï¼Œé€šè¿‡åå¤æŠ˜ç£¨(è¯»å–è¿­ä»£)è®©æ•°æ®æ‹›ä¾›ğŸ˜‚)

åœ¨æ¢ç´¢æ€§æ•°æ®åˆ†æè¿‡ç¨‹ä¸­ï¼Œä»–ä»¬èº«å…¼æ•°èŒï¼Œä»çº½çº¦å‡ºç§Ÿè½¦è´¹ç”¨æ•°æ®é›†([https://www.kaggle.com/c/new-york-city-taxi-fare-prediction](https://www.kaggle.com/c/new-york-city-taxi-fare-prediction))-IDã€è´¹ç”¨ã€è¡Œç¨‹æ—¶é—´ã€ä¹˜å®¢å’Œä½ç½®çš„ 6 åˆ—æœ€å°æ•°æ®é›†ä¸­ï¼Œä»–ä»¬çš„é—®é¢˜å¯èƒ½åŒ…æ‹¬:

> 1.ç¥¨ä»·å¦‚ä½•é€å¹´å˜åŒ–ï¼Ÿ
> 
> 2.è¿™äº›å¹´æ¥æ—…è¡Œçš„æ¬¡æ•°å¢åŠ äº†å—ï¼Ÿ
> 
> 3.äººä»¬å–œæ¬¢ç‹¬è‡ªæ—…è¡Œè¿˜æ˜¯æœ‰äººé™ªä¼´ï¼Ÿ
> 
> 4.éšç€äººä»¬å˜å¾—æ›´åŠ æ‡’æƒ°ï¼Œå°è·ç¦»éª‘è¡Œå¢åŠ äº†å—ï¼Ÿ
> 
> 5.äººä»¬æƒ³åœ¨ä¸€å¤©ä¸­çš„ä»€ä¹ˆæ—¶é—´å’Œä¸€å‘¨ä¸­çš„å“ªä¸€å¤©å»æ—…è¡Œï¼Ÿ
> 
> 6.é™¤äº†å¸¸è§„çš„æœºåœºæ¥é€å¤–ï¼Œæœ€è¿‘è¿™ä¸ªåŸå¸‚æ˜¯å¦å‡ºç°äº†æ–°çš„çƒ­ç‚¹ï¼Ÿ
> 
> 7.äººä»¬æ˜¯å¦åœ¨è¿›è¡Œæ›´å¤šçš„åŸå¸‚é—´æ—…è¡Œï¼Ÿ
> 
> 8.äº¤é€šæµé‡çš„å¢åŠ æ˜¯å¦ä¼šå¯¼è‡´ç›¸åŒè·ç¦»çš„æ›´å¤šè´¹ç”¨/æ—¶é—´ï¼Ÿ
> 
> 9.æ˜¯å¦æœ‰å¤§é‡çš„æ¥é€ç‚¹æˆ–äº¤é€šç¹å¿™çš„åŒºåŸŸï¼Ÿ
> 
> 10.æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨å¼‚å¸¸å€¼ï¼Œä¾‹å¦‚ 0 è·ç¦»å’Œ 100 ç¾å…ƒä»¥ä¸Šçš„ç¥¨ä»·ç­‰ç­‰ï¼Ÿ
> 
> 11.å‡æœŸå’Œæœºåœºæ—…è¡ŒæœŸé—´çš„éœ€æ±‚å˜åŒ–ä¼šå¢åŠ å—ï¼Ÿ
> 
> 12.å¤©æ°”(å¦‚ä¸‹é›¨æˆ–ä¸‹é›ª)ä¸å‡ºç§Ÿè½¦éœ€æ±‚æœ‰å…³è”å—ï¼Ÿ

å³ä½¿å›ç­”äº†è¿™äº›é—®é¢˜ï¼Œä¹Ÿå¯èƒ½å‡ºç°å¤šä¸ªå­çº¿ç´¢ï¼Œå³æˆ‘ä»¬èƒ½å¦é¢„æµ‹ Covid å¦‚ä½•å½±å“æ–°å¹´ï¼Œæ¯å¹´çš„çº½çº¦é©¬æ‹‰æ¾å¦‚ä½•æ”¹å˜å‡ºç§Ÿè½¦éœ€æ±‚ï¼Œç‰¹å®šè·¯çº¿æ˜¯å¦æ›´å€¾å‘äºå¤šåä¹˜å®¢(æ´¾å¯¹ä¸­å¿ƒ)ä¸å•åä¹˜å®¢(æœºåœºåˆ°éƒŠåŒº)ã€‚

ä¸ºäº†æ¶ˆé™¤è¿™äº›å¥½å¥‡å¿ƒï¼Œæ—¶é—´æ˜¯è‡³å…³é‡è¦çš„ï¼Œè®©æ•°æ®ç§‘å­¦å®¶ç­‰å¾… 5 åˆ†é’Ÿä»¥ä¸Šæ¥è¯»å– csv æ–‡ä»¶(55 Mn è¡Œ)æˆ–è¿›è¡Œåˆ—æ·»åŠ ï¼Œç„¶åè¿›è¡Œèšåˆæ˜¯ä¸€ç§çŠ¯ç½ªã€‚æ­¤å¤–ï¼Œç”±äºå¤§å¤šæ•°æ•°æ®ç§‘å­¦å®¶éƒ½æ˜¯è‡ªå­¦çš„ï¼Œä»–ä»¬å·²ç»éå¸¸ä¹ æƒ¯äº pandas æ•°æ®æ¡†æ¶ APIï¼Œæ‰€ä»¥ä»–ä»¬ä¸ä¼šæƒ³è¦ä½¿ç”¨ä¸åŒçš„ API(å¦‚ numbaã€Spark æˆ– datatable)é‡æ–°å¼€å§‹å­¦ä¹ è¿‡ç¨‹ã€‚æˆ‘å°è¯•è¿‡åœ¨ DPLYR(R)ã€Pandas(Python)å’Œ pyspark(Spark)ä¹‹é—´å‘¨æ—‹ï¼Œè€ƒè™‘åˆ°éœ€è¦ç»Ÿä¸€çš„ç®¡é“å’Œä»£ç è¯­æ³•ï¼Œè¿™æœ‰ç‚¹ä»¤äººå¤±æœ›/å¾’åŠ³ã€‚ä¸è¿‡ï¼Œå¯¹äºå¥½å¥‡çš„ä¹¡äº²ä»¬ï¼Œæˆ‘åœ¨è¿™é‡Œå†™äº†ä¸€ä¸ª pyspark å…¥é—¨æŒ‡å—:[https://medium . com/@ ravish ankar _ 22148/billion-of-rows-milliseconds-time-pyspark-starter-guide-c1f 984023 bf2](/@ravishankar_22148/billions-of-rows-milliseconds-of-time-pyspark-starter-guide-c1f984023bf2)

åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘è¯•å›¾æä¾›ä¸€ä¸ªå…³äº Dask çš„å®é™…æ“ä½œæŒ‡å—ï¼Œå¯¹æˆ‘ä»¬å¿ƒçˆ±çš„ç†ŠçŒ«åšæœ€å°çš„å»ºç­‘æ”¹åŠ¨:

1.  æ•°æ®è¯»å–å’Œåˆ†æ

è¾¾æ–¯å…‹ vs ç†ŠçŒ«é€Ÿåº¦

Dask æ˜¯å¦‚ä½•å°†æ•°æ®å¤„ç†é€Ÿåº¦æé«˜ 90 å€çš„ï¼Œä¾‹å¦‚ç†ŠçŒ«çš„æ•°æ®å¤„ç†é€Ÿåº¦ä» 1 ç§’æé«˜åˆ° 91 ç§’ã€‚

![](img/7e8529afb759bb938ac081923172d8c1.png)

ã€https://dask.org/ã€‘æ¥æº:[](https://dask.org/)

*Dask ä¹‹æ‰€ä»¥å¦‚æ­¤å—æ¬¢è¿ï¼Œæ˜¯å› ä¸ºå®ƒä½¿ Python ä¸­çš„åˆ†æå…·æœ‰å¯ä¼¸ç¼©æ€§ï¼Œå¹¶ä¸”ä¸éœ€è¦åœ¨ SQLã€Scala å’Œ Python ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚ç¥å¥‡çš„æ˜¯ï¼Œè¿™ä¸ªå·¥å…·åªéœ€è¦æœ€å°‘çš„ä»£ç ä¿®æ”¹ã€‚å®ƒå°†è®¡ç®—åˆ†è§£æˆ pandas æ•°æ®å¸§ï¼Œä»è€Œå¹¶è¡Œæ“ä½œä»¥å®ç°å¿«é€Ÿè®¡ç®—ã€‚*

*![](img/6d6f35111f3e2502c288145c7bd50404.png)*

**æ¥æº:*[*https://docs.dask.org/en/latest/*](https://docs.dask.org/en/latest/)*

*2.æ•°æ®èšåˆ:*

*è¯·æ³¨æ„ï¼ŒPandas API å®Œå…¨æ²¡æœ‰å˜åŒ–ï¼Œå®ƒèƒ½å¤Ÿåœ¨å‡ æ¯«ç§’å†…æ‰§è¡Œèšåˆå’Œæ’åºã€‚**è®¡ç®—()**æ‡’æƒ°è®¡ç®—ç»“æŸæ—¶çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†å¤§æ•°æ®çš„ç»“æœå­˜å‚¨åœ¨ Pandas æ•°æ®å¸§ä¸­ã€‚*

*3.æœºå™¨å­¦ä¹ :*

*ä¸‹é¢çš„ä»£ç ç‰‡æ®µæä¾›äº†ä¸€ä¸ªä½¿ç”¨ XGBoost åœ¨ Dask ä¸­æ„å»ºç‰¹æ€§å·¥ç¨‹å’Œ ML æ¨¡å‹çš„å·¥ä½œç¤ºä¾‹*

*åŸºäº Dask çš„ç‰¹å¾å·¥ç¨‹å’Œ ML æ¨¡å‹*

***ç»“è®º:***

*Dask æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œæä¾›å¹¶è¡Œè®¡ç®—ã€å¤§æ•°æ®å¤„ç†å’Œåˆ›å»ºç«¯åˆ°ç«¯çš„æ•°æ®ç§‘å­¦ç®¡é“ã€‚å®ƒæœ‰ä¸€ä¸ªé™¡å³­çš„å­¦ä¹ æ›²çº¿ï¼Œå› ä¸º API å‡ ä¹ç±»ä¼¼äºç†ŠçŒ«ï¼Œå®ƒå¯ä»¥è½»æ¾å¤„ç†å†…å­˜ä¸è¶³çš„è®¡ç®—(å¤§çº¦ 10 å€çš„ RAM)ã€‚*

*å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ´»çš„åšå®¢ï¼Œæˆ‘å°†åœ¨ Dask ç³»åˆ—ä¸­å†™ä¸‹åç»­éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¹¶è¡Œå¤„ç†é’ˆå¯¹ Kaggle æ’è¡Œæ¦œã€‚å¦‚æœæ‚¨åœ¨è®¾ç½® Dask æ—¶é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œæˆ–è€…æ— æ³•æ‰§è¡Œä»»ä½• Dask æ“ä½œï¼Œç”šè‡³æ˜¯ä¸€èˆ¬çš„èŠå¤©ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ã€‚å¿«ä¹å­¦ä¹ ï¼ï¼ï¼*

*æ¥æº:*

1.  *[https://ml.dask.org/](https://ml.dask.org/)*
2.  *https://dask.org/*
3.  *[https://medium . com/@ ravish ankar _ 22148/billion-of-rows-milliseconds-time-py spark-starter-guide-c1f 984023 BF 2](/@ravishankar_22148/billions-of-rows-milliseconds-of-time-pyspark-starter-guide-c1f984023bf2)*
4.  *[https://towards data science . com/how-I-learn-to-love-parallelised-apply-with-python-pandas k-and-numba-f 06 b0b 367138](https://towardsdatascience.com/how-i-learned-to-love-parallelized-applies-with-python-pandas-dask-and-numba-f06b0b367138)*
5.  *[https://www . ka ggle . com/yuliagm/how-to-work-with-big-datasets-on-16g-ram-dask](https://www.kaggle.com/yuliagm/how-to-work-with-big-datasets-on-16g-ram-dask)*
6.  *[https://medium . com/better-programming/what-is-dask-and-how-it-can-help you-a-data-scientist-72 adec 7 CEC 57](/better-programming/what-is-dask-and-how-can-it-help-you-as-a-data-scientist-72adec7cec57)*