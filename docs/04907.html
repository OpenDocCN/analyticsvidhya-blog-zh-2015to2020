<html>
<head>
<title>Introduction to generating labels programmatically using Snorkel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用通气管以编程方式生成标签的介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/introduction-to-generating-labels-programmatically-using-snorkel-297976312497?source=collection_archive---------8-----------------------#2020-04-05">https://medium.com/analytics-vidhya/introduction-to-generating-labels-programmatically-using-snorkel-297976312497?source=collection_archive---------8-----------------------#2020-04-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="3b86" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">为什么我们需要关心标签的生成？</h1><p id="cf57" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">近年来，数据科学算法有了重大发展。越来越多的企业在决策中使用机器学习和深度学习算法。在过去十年中，计算能力也增加了几倍。因此，也有技术和工具来满足需求。但是有一个问题，数据本身。公司有数十亿条记录，但他们没有标签。许多先进的算法需要标记数据。</p><p id="3c1a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">传统上，组织会雇人手动标记数据。但这受到人员可用性、贴标签时间和预算的限制。特别是当我们谈论电子商务、社交网络或银行等在线业务中每天数TB的数据生成时。对于这些情况，手动标记数据几乎是不可能的，需要以编程方式生成标记数据。</p><h1 id="73f6" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">如何以编程方式生成标签数据？</h1><p id="7ca7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">有几种方法可以处理未标记的数据:</p><ol class=""><li id="a0bb" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><em class="kp">主动学习</em>:在小数据集上训练模型。预测无标签数据的标签。预测标签中具有低置信度的数据点被发送给人类专家进行标记。</li><li id="c25d" class="kg kh hi jf b jg kq jk kr jo ks js kt jw ku ka kl km kn ko bi translated"><em class="kp">半监督学习</em>:类似于主动学习，但不是将数据发送给人类专家，而是使用领域和任务不可知的假设来改进标签。</li><li id="a5ca" class="kg kh hi jf b jg kq jk kr jo ks js kt jw ku ka kl km kn ko bi translated"><em class="kp">迁移学习</em>:针对新数据调整的大数据集预训练模型。</li><li id="e982" class="kg kh hi jf b jg kq jk kr jo ks js kt jw ku ka kl km kn ko bi translated"><em class="kp">弱监督</em>:使用容易获得、高水平且可能不是很精确的规则来标记未标记的数据。示例通气管将在以下章节中解释。</li></ol><p id="a0fb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">下图很好地解释了这些方法的总结:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/49eaf62770fa8880a1e723e29da4b513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VxSYoC04FYe6gj7BxDdxbQ.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">参考:https://www.snorkel.org/blog/weak-supervision<a class="ae ll" href="https://www.snorkel.org/blog/weak-supervision" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><h1 id="88bf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">现在，让我们去潜水吧</strong></h1><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lm"><img src="../Images/8d5eb2ad009116326e7d8c87bdf95ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5zXdgNe2pbW4vO415g0fA.png"/></div></div></figure><h1 id="a9c2" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">浮潜——监管不力</h1><p id="93c2" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">通气管作为python包运输。浮潜要求用户编写可以标记部分数据的规则。这些规则是在领域专家的帮助下编写的高级规则。在通气管术语中，这些规则被称为<strong class="jf hj"> <em class="kp">标记函数。</em> </strong>这些标注功能适用于所有未标注的数据。转换后的数据被发送到被称为<strong class="jf hj">标签模型</strong>的呼吸管的核心功能，该核心功能估计各个标签功能的准确度以及它们之间的相关性，以将标签分配给未标记的数据。通气管还提供<strong class="jf hj">切片功能</strong>，用于观察数据切片上的标签模型性能(例如，城市A与城市B)。正如你可能想知道如何估计通气管的性能，一个小的黄金集又名<strong class="jf hj">开发集</strong>是必要的。开发集也可以用来处理标签中的不平衡。通气管还提供了<strong class="jf hj">转换函数</strong>，可用于数据扩充，以研究数据的不变性。</p><h1 id="078b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">如何估计单个标签功能的精确度？</h1><p id="6a23" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">鉴于浮潜不使用任何黄金设置的标签生成，问题是如何估计精度。参考文件是此处的<a class="ae ll" href="https://arxiv.org/pdf/1810.02840.pdf" rel="noopener ugc nofollow" target="_blank"/>。通气管标签模型算法如下所示。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ln"><img src="../Images/447201a748c14b6e85eeb721c82dc42e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BbD534rhfrQzXlCJ8F4jig.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">参赛:https://www.youtube.com/watch?v=RUPbYvzSrg0</figcaption></figure><p id="a020" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">来自标记函数的噪声标记预测可以被视为与实际标记(未知)具有某种相关性的因子图。创建观察值(来自标记函数)和分隔符集(实际标记)之间的协方差矩阵。作者用矩阵求逆的方法形成方程，用矩阵补全法求解该方程，以估计标记函数的精度。在通气管中使用pytorch神经网络解决了这个问题。下图说明了如何将标注函数(LFs)矩阵中的y预测转换为矩阵补全方法，以及如何估计相关性~zz^T。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lo"><img src="../Images/0f76b649667acdf4a6e3c20eafa1faab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQIYHwxZ9MEMPQjHvVY0fg.png"/></div></div></figure><p id="5fcc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">上述方法利用了标记函数输出的逆广义协方差矩阵的图结构稀疏性，以将学习它们的精度和相关强度减少到矩阵完成类型的问题。作者声称这个公式更具可扩展性，实现起来更干净，并且有更清晰的理论保证。</p><h1 id="abbb" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">通气管示例</h1><p id="e29a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">酷，让我们现在进入浮潜。在<a class="ae ll" href="https://www.snorkel.org/get-started/" rel="noopener ugc nofollow" target="_blank">通气管页面</a>上的例子很好，我将在下面解释。</p><p id="e5c1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤1:获取大量未标记的数据。我假设我们有:)</p><p id="a4f4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤2:编写标签函数</p><p id="0afc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">标签函数可以返回多个标签。这里我们来看一个更简单的二元分类器。除了输出True和False之外，还可以有第三个输出absent。</p><p id="6fab" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">要编写标注函数，需要使用decorator <code class="du lp lq lr ls b">@labeling_function()</code></p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="7e46" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤3:对所有未标记的数据应用标记函数</p><p id="7368" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">虽然下面的例子使用熊猫数据框架，通气管中的应用程序也可用于pyspark。</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="d33a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤4:获取预测标签</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="ede9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤5:(可选)定义转换函数</p><p id="f2d0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这个函数可以用decorator @ <code class="du lp lq lr ls b">@transformation_function()</code>来声明</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="f448" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤6:(可选)应用步骤5中定义的转换函数</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="99e9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤7:(可选)定义切片函数</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="481a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">步骤8:训练分类器</p><p id="d425" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">最后一步是训练一个ed-end分类器模型，作者声称该模型显示了预测标签准确性的提高。在下面的例子中，使用了逻辑回归模型。也可以使用任何其他模型。该分类器可用于估计标签。</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="ddfe" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><em class="kp">希望你们喜欢。如果有，请鼓掌！</em></p></div></div>    
</body>
</html>