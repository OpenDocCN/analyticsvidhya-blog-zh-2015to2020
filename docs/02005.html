<html>
<head>
<title>Using Convolutional Neural Networks to Classify Street Signs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用卷积神经网络对街道标志进行分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-convolutional-neural-networks-to-classify-street-signs-eef7bd6a200a?source=collection_archive---------23-----------------------#2019-11-25">https://medium.com/analytics-vidhya/using-convolutional-neural-networks-to-classify-street-signs-eef7bd6a200a?source=collection_archive---------23-----------------------#2019-11-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5e426f00e95882d9fac4a5cb20359d19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3bnhGykmfZPbwl5AZ2PLYQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:yonah.org</figcaption></figure><p id="12cf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">自从汽车发明以来，随着时间的推移，制造商已经稳步增加了更多的安全功能并改进了汽车设计，目标是让驾驶员在路上更加安全。汽车制造商已经花费了数百万美元来研究安全带、轮胎和几乎所有能想到的汽车零件的安全改进。尽管有所有这些投资，驾驶仍然比2019年的航空旅行更加致命。根据<a class="ae js" href="https://www.nsc.org/road-safety/safety-topics/fatality-estimates" rel="noopener ugc nofollow" target="_blank">国家安全委员会</a>的数据，仅在2018年美国就有大约4万人死于汽车事故。事实上，2018年全球共有约500人死于飞机坠毁——与仅在美国发生的车祸死亡人数相比，这比<strong class="iw hj">少80倍</strong><strong class="iw hj"/>。</p><p id="5578" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有许多因素可能导致这种巨大的差异，例如与机动车驾驶员相比，商业飞行员在培训和认证方面的难度，以及道路上的汽车数量与飞机的数量。尽管如此，在我看来，死亡率的差异仍然相当惊人。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/f626b0c80527f1fba9671c0b335f3135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OE7MmQO3O0Pb9E6a.jpeg"/></div></div></figure><blockquote class="jy jz ka"><p id="be69" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated">如今，特斯拉、沃尔沃等公司和许多其他公司正在投资人工智能等技术，试图纠正问题的根源，以及我们以前忽略的问题——<strong class="iw hj">方向盘后面的人类表现。</strong></p></blockquote><p id="031d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">自汽车发明以来，汽车技术最令人兴奋的进步可能是自动驾驶汽车的诞生。曾经是科幻小说的主题，通过卷积神经网络(CNN)和其他建模技术的力量，自动驾驶汽车已经成为可能。但是，在我们完全交出钥匙之前，我们必须克服三大挑战。</p><p id="9fb4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们必须:</p><p id="e0fc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">&gt; 1.获取数据(传感器、摄像机)</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/1c54d6e6e363438fb124b7e163898868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juuc_tJPtezMivSYcqH-gg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae js" href="https://www.sae.org/*" rel="noopener ugc nofollow" target="_blank">www.sae.org</a></figcaption></figure><p id="b7c2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">&gt; 2.处理数据(人工智能——我们将关注这一部分)</p><p id="2e15" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">&gt; 3.根据数据采取行动(驾驶汽车)</p><p id="e8c6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了突出特斯拉等公司在向公众提供自动驾驶汽车时所面临的一小部分技术挑战，我们将专门关注步骤2的简化应用，<strong class="iw hj">处理图像数据，以确定我们“正在看”的是什么</strong>。为了实现这一目标，我使用了一个包含43种标记街道标志的100，000张图像的数据集来创建受监督的深度学习模型，该模型利用了CNN，能够非常可靠地(稍后将详细介绍)对街道标志的新图像进行分类。对于这一切意味着什么的一个很好的总结，请查看Dhanoop Karunakaran 的这个<a class="ae js" rel="noopener" href="/intro-to-artificial-intelligence/deep-learning-series-1-intro-to-deep-learning-abb1780ee20">系列文章。</a></p><p id="1a1b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当讨论这种类型的技术时，注意错误的潜在后果是很重要的。在无人驾驶汽车的情况下，一个错误识别的停车标志<em class="kb">或行人</em>很容易导致死亡。在一项正式的研究中，可能会对每个符号的错误分类的重要性进行评估，并给予权重。通过这种方式，一个新的模型可以被训练成在对更“关键”的街道标志进行分类时“宁可谨慎”。虽然这一切在理论上听起来很棒，但这些选择背后的伦理也必须认真评估。例如，如果我们的加权输入使我们的新模型在分类停车标志时犯的错误更少，但在分类行人过街标志时表现稍差，这是“可接受的”吗？综上所述，就本文的目的而言，我们将更多地关注技术本身。</p><p id="c72d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">那么，你如何教计算机识别不同的物体呢？为了触及这一点，我们将从一个简单的例子开始。作为人类，当我们看下面的图片时，我们看到一只可爱的黑色和灰色皮毛的狗站在斑点地毯上。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/9861dfbc9569adb354c8f62595be068d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWPyQoZVxZQ_2kFp07kSGw.jpeg"/></div></div></figure><p id="9e72" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">不用思考，我们就知道图像的主体不是一匹马、一辆车或一只猫。即使在观看我为同一只狗拍摄的经过大量编辑的照片时，作为人类，我们仍然不难识别图像的主体是一只狗，即使它是蓝色的。看一看:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/183cebdcc2b3f4a5cc6f76ad7492d25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*wmPcxOuhrrV89-3Lls_pTw.jpeg"/></div></figure><p id="f0a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">毫不奇怪，计算机不知道狗是什么，更不知道人长什么样。取而代之的是，计算机将图像视为名为<strong class="iw hj">张量</strong>的分组矩阵。在每个矩阵中，每个数字对应于图像中的一个特定像素。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/7adfa2cf3b92b6ca61ce933fe430dd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*P9cVNLe1mcLQOO_m9gjcYA.gif"/></div></figure><p id="5c8d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用卷积神经网络，我们能够训练模型来提取图像特征，如边缘、形状和颜色，用于图像分类。使用监督学习模型，我们可以通过一个模型传递数以千计的狗的图像，以便“教计算机”狗长什么样。因此，虽然计算机可能不欣赏我的狗奥利弗有多可爱，但通过对它的肖像应用不同的滤镜，它可以确定奥利弗的面部结构、颜色和形状与其他狗有相似之处，并且它很可能也是一只狗。</p><p id="6848" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所描述的相同技术可用于分类任意数量的目标类，如街道标志。为了说明这个过程，我们将使用一个非常“轻”(读:弱)的CNN，作为一个例子来解释在图像分类过程中“幕后”发生了什么。如果你想看我用来生成这些例子的代码，或者查看我训练的更健壮的CNN的例子，以及看看训练CNN所需的其他一些过程，如图像预处理、探索性数据分析等，请务必查看我的代码<a class="ae js" href="https://github.com/pawoody/DL_street_signs/blob/master/traffic_signs_modeling.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="9ae4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，在本帖中，我们将使用由下图总结的非常基本的CNN来揭示计算机能够“看”和“学习”的方式。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/c64ca4ff75987d9872af4d2d99e25b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*_J_SvJME1PQSpgxpHW48Ow.png"/></div></figure><p id="08d3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">那么，这意味着什么呢？我们为什么要这么做，它如何帮助我们教会计算机对街道标志进行分类？</p><p id="37da" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们有输入图像，所有图像的尺寸都是32x32x3，或者更简单地说，图像的高度和宽度都是32像素，有3个颜色通道(红色、绿色和蓝色)。因为这些输入不同于其他神经网络的输入，在其他神经网络中，模型输入是向量，我们需要按摩我们的输入图像，以便使用深度学习对它们进行可靠的分类。对于这个例子，我从数据集中选择了一个随机图像。让我们看看这个例子，并展示我们的模型是如何评估图像的:</p><pre class="ju jv jw jx fd kk kl km kn aw ko bi"><span id="c2d2" class="kp kq hi kl b fi kr ks l kt ku"># Selecting an example image<br/>example = plt.imshow(data['x_train'][2, :, :, :])</span></pre><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/e63c672cae37b9e467213d09f41cec2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*GqMthZcRXsbt_yhXQME2uQ.jpeg"/></div></figure><p id="e845" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">正如我之前提到的，计算机“看到”图像是一组叫做张量的矩阵。让我们看一下同一个示例图像:</p><pre class="ju jv jw jx fd kk kl km kn aw ko bi"><span id="ea7f" class="kp kq hi kl b fi kr ks l kt ku"># Displaying Image Tensor<br/>how_the_computer_sees_it = data['x_train'][2]<br/>display(how_the_computer_sees_it)</span></pre><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/22402c5a86dffe85f3fa338e4b18255b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwJ9JrV5CU6imeeGAelG6Q.png"/></div></div></figure><p id="c7ed" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们已经了解了模型输入，让我们更仔细地了解一下流程:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/34deab8b50e806216dbc4b75e7c298b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQl4axV4-MSEbCCbomRq4Q.png"/></div></div></figure><p id="bf1a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如上图所示，应用于输入图像的第一层是卷积层。在这一步中，我们将卷积核应用于我们的图像，在输入图像上有效地滑动一个较小的3x3像素过滤器，评估它们的点积。在上面的例子中，我们选择在这个卷积步骤中应用32个过滤器，调整层输出的维度。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/70b2549b56f0e931fecf1590063bae1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2iP-Z-YU-xrEP2sn6yRRmA.png"/></div></div></figure><p id="0191" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，使用滑动2x2过滤器，为我们解析的图像的每个“窗口”或“块”选择最大值，应用池层来减少模型的维度(以及参数)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/d9f3ff6bc17ba5ccd0183cc962e2e46a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNuENzZRnf_7HCJcS0uxhQ.png"/></div></div></figure><p id="69e0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，为了将我们的图像输入转化为与我们用来对图像进行分类的神经网络的密集层兼容的矢量化格式，我们将图像输入展平到一个数组中。</p><p id="ddd7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">虽然我们可以在上面的图像中看到边缘和形状的突出显示，但我们的输出对人眼来说并不“清晰”。尽管如此，即使是这个非常简单的CNN也能相对较好地从数据库中分类出街道标志的图像(约80%)。在创建和评估这个基线模型之后，我训练了更多的、经过调整的CNN，并评估了它们的性能，准确率超过94%。你可以通过查看这个<a class="ae js" href="https://github.com/pawoody/DL_street_signs/blob/master/traffic_signs_modeling.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a>来查看我的代码和结论。</p><p id="11a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在现实世界中，手头的任务比简单地对符号进行分类要复杂得多。在自动驾驶的背景下，从许多角度看，许多类型的对象都必须以极高的速度进行处理、分类和极其可靠的操作，所有这些都关系到人的生命。</p><p id="c2ee" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在考虑我们的实验结果以及其他使用神经网络对图像数据进行分类的结果时，需要记住的最重要的因素之一是用于训练我们的模型的图像质量。虽然使用非常小的图像极大地减少了训练深度学习模型所需的时间/资源，但它也很可能妨碍分类性能。当模型在控制一辆高速行驶的汽车时，必须考虑更多的因素时，同样的挑战被极大地放大了。这一细节凸显了特斯拉等公司面临的巨大挑战，以及他们最近收购<a class="ae js" href="https://fortune.com/2019/10/02/tesla-autopilot-ai-deepscale/" rel="noopener ugc nofollow" target="_blank"> DeepScale </a>的重要性，该公司专注于减少对自动驾驶汽车传感器获得的图像数据进行分类所需的资源。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><p id="bc6f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="kb">原载于2019年11月25日</em><a class="ae js" rel="noopener" href="/swlh/using-convolutional-neural-networks-to-classify-street-signs-a84b55e11e83"><em class="kb">https://medium.com</em></a><em class="kb">。</em></p></div></div>    
</body>
</html>