<html>
<head>
<title>Understanding Flask and Building Web API using Python and Flask.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Flask并使用Python和Flask构建Web API。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-flask-and-building-web-api-using-python-and-flask-5611e6f66e03?source=collection_archive---------15-----------------------#2020-04-18">https://medium.com/analytics-vidhya/understanding-flask-and-building-web-api-using-python-and-flask-5611e6f66e03?source=collection_archive---------15-----------------------#2020-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="a468" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">烧瓶是什么？</h1><p id="b885" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Flask是一个流行的Python web框架，这意味着它是一个用于开发web应用程序的第三方Python库。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kb"><img src="../Images/e18558ca70e0bd7272f0313ce42a941f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*XzIRJGujfqAiOV2EIQgR_Q.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">照片:【waysquare.com T4】</figcaption></figure><p id="0733" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">有两个著名的Python web框架。Flask被认为比Django web框架更具Pythonic性，因为在一般情况下，Flask web应用程序更显而易见。对于初学者来说，Flask也很容易上手，因为启动和运行一个简单的应用程序几乎没有样板代码。</p><p id="55a4" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated"><strong class="jf hj">安装:</strong>默认情况下，它会安装最新的python版本。因此，它可以避免不同版本库之间的兼容性问题。</p><p id="e6de" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">激活创建的环境，并使用pip安装烧瓶。</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="33e8" class="ky ig hi ku b fi kz la l lb lc">1)conda create --name newenv python=3.6</span><span id="7f6a" class="ky ig hi ku b fi ld la l lb lc">2)Activate newenv</span><span id="97c9" class="ky ig hi ku b fi ld la l lb lc">3)pip install flask</span></pre><p id="e707" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">现在，让我们创建一个简单的hello函数，它使用flask返回“Hello World”。</p><p id="56c3" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">代码:</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="24a5" class="ky ig hi ku b fi kz la l lb lc"><strong class="ku hj">from </strong>flask <strong class="ku hj">import </strong>Flask<br/><br/>app = Flask(__name__)<br/><br/>@app.route(<strong class="ku hj">"/"</strong>)<br/><strong class="ku hj">def </strong>hello():<br/>    <strong class="ku hj">return "Hello World!"<br/><br/><br/>if </strong>__name__ == <strong class="ku hj">'__main__'</strong>:<br/>    app.run(debug=True)</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/110132e24e5dfdff744c4e9bb701ff5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9OfZGx51j3Y5ZFi1hMQf7w.png"/></div></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lj"><img src="../Images/25a1466ee063c6f3f920b07669418abd.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*cjaHsI3hyr0Po4fx2Qp3hg.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">简单烧瓶API的输出</figcaption></figure><p id="e94c" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">好吧！现在让我们看一下代码。</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="5cb1" class="ky ig hi ku b fi kz la l lb lc"><strong class="ku hj">from </strong>flask <strong class="ku hj">import </strong>Flask</span></pre><p id="8218" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这一行要求应用程序从flask包中导入Flask模块。用于创建web应用程序实例的Flask。</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="a959" class="ky ig hi ku b fi kz la l lb lc">app = Flask(__name__)</span></pre><p id="4221" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这一行创建了您web应用程序的一个实例。__name__是python中的一个特殊变量，如果模块(python文件)作为主程序执行，它将等于“__main__”。</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="8e7a" class="ky ig hi ku b fi kz la l lb lc">@app.route(<strong class="ku hj">"/"</strong>)</span></pre><p id="8f3c" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这条线定义了路线。例如，如果我们像上面一样将route设置为“/”，那么如果我们访问localhost:5000/，就会执行代码。您可以将路由设置为“/test ”,如果我们访问localhost:5000/test，就会显示我们的“hello world”。</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="e217" class="ky ig hi ku b fi kz la l lb lc"><strong class="ku hj">def </strong>hello():<br/>    <strong class="ku hj">return "Hello World!"</strong></span></pre><p id="d403" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这一行定义了当我们访问route时将执行功能。</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="cfcc" class="ky ig hi ku b fi kz la l lb lc"><strong class="ku hj">if </strong>__name__ == <strong class="ku hj">'__main__'</strong>:<br/>    app.run(debug=True)</span></pre><p id="f646" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这一行表示如果我们从python代码运行flask应用程序，它将开始运行。我们还将<code class="du lk ll lm ku b">debug </code>参数设置为<code class="du lk ll lm ku b">true</code>。这将在网页上打印出可能的Python错误，帮助我们跟踪错误，并在做出任何新的更改时重新加载Flask API。您还可以将<code class="du lk ll lm ku b">host </code>参数和<code class="du lk ll lm ku b">port </code>添加到您想要的端口(例如，您可以将其更改为6000，而不是默认的5000)。</p></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><p id="d1fc" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">现在总结一下，让我们举一个上传图片并保存到本地文件系统的真实例子。</p><pre class="kc kd ke kf fd kt ku kv kw aw kx bi"><span id="5e3f" class="ky ig hi ku b fi kz la l lb lc">from flask import Flask, request</span><span id="cdb5" class="ky ig hi ku b fi ld la l lb lc">import cv2</span><span id="13ab" class="ky ig hi ku b fi ld la l lb lc">app = Flask(__name__)</span><span id="fe6a" class="ky ig hi ku b fi ld la l lb lc">@app.route('/upload', methods=['GET', 'POST'])</span><span id="8968" class="ky ig hi ku b fi ld la l lb lc">def upload_file():</span><span id="5a82" class="ky ig hi ku b fi ld la l lb lc">if request.method == 'GET':</span><span id="3ad9" class="ky ig hi ku b fi ld la l lb lc">img_path=request.values.get('image_path')</span><span id="3268" class="ky ig hi ku b fi ld la l lb lc">img=cv2.imread(img_path)</span><span id="5b55" class="ky ig hi ku b fi ld la l lb lc">cv2.imwrite('sample_out.jpg',img)</span><span id="c2e8" class="ky ig hi ku b fi ld la l lb lc">return 'file saved to local directory'</span><span id="3c45" class="ky ig hi ku b fi ld la l lb lc">if __name__=='__main__':</span><span id="1466" class="ky ig hi ku b fi ld la l lb lc">app.run(debug=True)</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lu"><img src="../Images/db17e90ee3c3901abc6f3c92f6f44f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4LG95nSez-Me9Og8qhSxUw.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">Flask API已经启动并正在运行。</figcaption></figure><p id="b358" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这个flask API的输入是一个图像的路径。因此，让我们检查输出。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lv"><img src="../Images/b3c3c1379bee61701ead3de08491fa86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V1a0GGA7pxHowXq2RClzbQ.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">使用URL和输入图像路径返回字符串，如图所示，输出图像存储在本地文件系统中。</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lw"><img src="../Images/1b480321e32620ce879cd4350411374e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2yhEuRm5h9IkB_ws7plpGw.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">输出响应200</figcaption></figure><p id="03f5" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">现在，我们将输出文件保存在本地文件系统中，文件名为‘sample _ out . jpg’。我们可以创建真实世界的web应用程序，可以是一些页面、一个博客、一个wiki，也可以是一个在线日程表应用程序或一个商业网站。</p><p id="e4c0" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">在上面的代码中，引入了CORS，这是一个用于处理跨源资源共享(CORS)的Flask扩展，使得跨源AJAX成为可能。</p><h1 id="e420" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">结论:</strong></h1><p id="cfdc" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">构建Flask API相当容易。现在，您可以创建Flask API，客户端可以使用描述的URL访问您的API。您还可以使用调度程序，创建cron作业或间隔作业，并使用给定的参数执行特定的功能。看看APscheduler，它不仅触发代码中的功能，还触发你头脑中的一些想法。目前就这些。希望提到的一切都很清楚。感谢阅读这篇文章，如果你喜欢，不要忘记留下一些掌声😉。</p><p id="2e42" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">LinkedIn:</p><div class="lx ly ez fb lz ma"><a href="https://www.linkedin.com/in/nikhil-pentapalli-5744bb18b/" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hj fi z dy mf ea eb mg ed ef hh bi translated">Nikhil Pentapalli -数据科学家和机器学习工程师| LinkedIn</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">经验丰富的机器学习专家，有在Reliance Industries Ltd .工作的证明历史，精通…</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">www.linkedin.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo kh ma"/></div></div></a></div></div></div>    
</body>
</html>