# 机器学习项目:预测足球运动员的市场价值

> 原文：<https://medium.com/analytics-vidhya/machine-learning-project-predicting-football-players-market-value-fd40636462bf?source=collection_archive---------2----------------------->

![](img/5fd9a16e930d00f6753d388b939fe8bd.png)

如果你想预测一些东西，如价格、销售等，回归可能是一个很好的解决方案。在这篇文章中，我将应用一种机器学习算法来预测足球运动员的市场价值。

1.  定义问题
2.  网页抓取
3.  数据清理
4.  探索性数据分析
5.  建立模型
6.  评估模型结果
7.  结论

在写我的帖子之前，我想分享一下我的 [**Github repo**](https://github.com/yalinyener/MarketValuesOfFootballPlayers) **，**如果你感兴趣，你可以找到 Jupyter 的笔记本代码。

# **定义问题**

每个数据科学项目都始于一个问题。在我的项目中，我的**业务需求**场景是:

预测足球运动员的市场价值，并确定谁被高估或低估。

首先，我需要导入库并设置一些默认显示选项

![](img/3eb8a52cbf7c97a2afcb2ac914fc25c3.png)

# **网页抓取**

Web 抓取是一种从互联网上收集数据并将其解析成有意义的形式的技术。如果没有直接下载数据的方法，就需要将数据提取成数据帧等有意义的形式。如果你想了解更多关于网页抓取的细节，你可以访问我的另一篇文章 [**使用 Python 的网页抓取**](/analytics-vidhya/step-by-step-web-scraping-using-python-36ecb502f8e)

在这个项目中我使用了 [**sofifa**](http://www.sofifa.com) 数据集。sofifa 主页如下图所示；

![](img/f2357ebdef0d120fa4ac21a39bfa0a3a.png)

SoFifa 玩家列表主页

主页包括球员特征数据，每个页面有 60 名球员。所以我需要建立一个循环来从 sofifa 得到所有的玩家。我使用 BeautifulSoup 库来收集数据。

![](img/a05a4f5218b29e0afaced15f021fc3f9.png)

在清理过程之后，我检查了行数并删除了重复的行。最后我从 sofifa 网页上刮到了 19316 个玩家。

```
Number of All Rows
30415

Number of Rows Without Duplicated
19316
```

# **数据清理**

数据清洗是任何机器学习项目中至关重要的一步。清晰的数据意味着更准确的结果。如果你使用网络抓取技术获取数据，在机器学习算法之前，你必须花费大量的时间来清理你的数据

获得数据后，您的数据框如下所示。对于机器学习算法来说太复杂:)

![](img/5f85f839d8fe453be2bb844b7de5a5ce.png)

在我的项目中，我将这些步骤用于数据清理；

*   拆分列，
*   删除不需要的字符(如\n)
*   将高度列转换为厘米
*   将重量栏转换为千克
*   将价值、工资和 Release_Clause 转换为十进制货币。(包括€、M 和 K 字符)
*   删除一些列为空的行
*   将国际声誉列(5 ★)转换为整数(5)
*   将所有数字列转换为整数或浮点数

最后，我清理了我的数据，并转换如下所示的数据帧。

![](img/c730159c5e18e392e5678bc9b5491e74.png)

# **探索性数据分析**

探索性数据分析可以帮助你，

*   了解您的数据，
*   探索数据的结构，
*   识别变量之间的关系，

简而言之，探索性数据分析告诉我们关于数据的几乎一切。

让我们来看看一些简要的信息和图形。

![](img/4c4c4b6f53de1eb3cc0366a0a87ceb40.png)

## 球员位置分布

![](img/8d0305236a547d70258382df6891b8b2.png)

## 每个位置的平均值

![](img/7c2b5ea116dccd9989a55b452cdc1cd8.png)

# 建立模型

在这个项目中，我使用了回归模型。什么是回归模型？

R **回归模型**用于预测连续值。这是最常见的机器学习算法之一。这里，我们根据输入变量 x 预测目标变量 Y(值)。目标变量和预测值之间应该存在线性关系，因此称为线性回归。

在模型开始时，我将我的数据框拆分为 Xb，yb 作为基线模型。Xb 包括所有数字列(59 个特征), yb 是我的目标列(值),创建 OLS 模型

```
player_modelb = sm.OLS(yb, Xb, data=player_list)

resultsb = player_modelb.fit()

print(resultsb.summary())
```

![](img/0a640211783dea65e4ab1b3abf68a5e6.png)

根据我的基线模型，R 平方值为 0.954，这是很好的，但模型有一些复杂性(要素的数量)，并有强烈的多重共线性问题(Cond。否非常高)

# **评估模型结果**

模型需要一些特征工程工作。首先，我们看看我们的目标列的分布

![](img/b40a6b3c131af6ab6c18bfeb5b72a0c2.png)

根据分布图，它看起来像一个正偏斜。所以我必须计算我的目标列的日志

![](img/008283b09ee55765d9753de9fb068cde.png)

第二步是减少特征的数量。当我们需要减少特征数量时，相关矩阵可以帮助我们。让我们找到与目标(值)高度相关的列。

然后我决定用这些列来预测价值；

*   全部的
*   年龄
*   Int _ 信誉
*   增长
*   Release _ 子句
*   高度
*   重量

让我们看看这些选定列和目标列之间的热图

![](img/47c5cbb0c0433d71228aae82c012b9d7.png)

和目标列的 pairplot

![](img/725716d4a52c95c987fb52fea6835bf7.png)

然后，我创建了一个具有选定特征的模型，并检查了一些参数。OLS 回归的结果看起来很棒。因为有较少特征(6)且它帮助我们清楚地解释我们的模型，我们的 R 平方值是高的(0.941)并且没有由于 Cond 引起的多重共线性。否(117)低。

![](img/0dfb2e3543d52d192978167c152547fc.png)

现在，我必须将数据分为训练集、测试集和验证集。并再次运行模型，最后比较岭、套索和多项式回归结果。

![](img/53ede0a7009c5ef6aa9bddaa5f7f63cf.png)![](img/3918d4efc12479c766cca4a4451911b0.png)

我们在 2 次多项式回归上有最好的结果，其次是线性回归。现在我将运行交叉验证。Lasso 回归结果告诉我们，这是一个过拟合问题，岭回归类似于线性回归。

![](img/692a4dd354d1402a8f20b7562ec459f5.png)

# **结论**

我们可以比较实际值和预测值。

![](img/742a1b9bc848abc6f50cf3563970d8d4.png)

如果我们将这些对数值转换成倒数，我们就可以比较真实值(百万€)

![](img/dc580b072938493ecd17e17aa5a3964b.png)

在线性模型中，我们必须控制 **5 个假设**。

**假设 1:** 回归在参数上是线性的，正确指定。

我们可以直观地检查这个假设，绘制预测与实际的对比图。我们应该观察到，这些点是关于通过原点的一条有斜率的直线近似对称的。

![](img/742a1b9bc848abc6f50cf3563970d8d4.png)![](img/5ee23ce834aa412c9dc15a4423a1f7a6.png)

**假设 2:** 残差应该是均值为零的正态分布。

![](img/73c1999a4ccc72ec45964560ee9ff50b.png)

**假设 3:** 误差项必须有恒定方差。

![](img/6a5b060dea96edca38c88eb0f62ca66a.png)

**假设 4:** 误差在观测值之间是不相关的。我们可以检查观察结果之间的相关性。

![](img/c5cca4293e3b1eb6f77a944158373003.png)

**假设 5:** 没有一个自变量是任何其他自变量的完美线性函数(没有完美多重共线性)

当你检查你的 OLS 回归结果时。不，告诉我们，是否有很强的多重共线性。

![](img/ef98cae294cd70c12696ae6439b69544.png)

最后，让我们找出哪些球员最被高估，哪些最被低估。

最大的负差是塞尔吉奥·拉莫斯的 848 万€。塞尔吉奥·拉莫斯的实际市值为 3250 万€，但模型预测值为 3998 万€。

![](img/d3a7c4fb02a1f4a8bc494b18e3c3024f.png)

最大的正差额是 3904 万€给伊卡尔迪..Icardi 的实际市场价值为 5300 万€，但模型预测价值为 1396 万€。

![](img/5de9263e2ee1f3a0c506c239a6cf8aee.png)![](img/7e7c8a4db0f5a9ddabe5f2f4b69c1080.png)![](img/c2a974436c52b8285015c155a1a8a4de.png)

最后，我们尝试使用机器学习算法，基于 Fifa 2020 特征数据预测足球运动员的价值。

感谢你阅读我的帖子，希望你喜欢。如果您有任何问题或想要分享您的意见，请随时联系我。