<html>
<head>
<title>An introduction to Bag of Words using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的单词包介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/an-introduction-to-bag-of-words-using-python-25640f379f05?source=collection_archive---------6-----------------------#2019-11-02">https://medium.com/analytics-vidhya/an-introduction-to-bag-of-words-using-python-25640f379f05?source=collection_archive---------6-----------------------#2019-11-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5ce1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们想在机器学习算法中使用文本，我们必须将它们转换成数字表示。计算机非常擅长处理数字，这不足为奇。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e0b59bb76b665e5fa22c9f54681b7bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HFwaBJ0lxzGbGzPNziWADQ.jpeg"/></div></div></figure><p id="8314" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jp">为什么需要将文本转换成数值表示？</em> </strong></p><p id="bdbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">举个例子:如果你有一套像黑、蓝、白、黄、绿这样的颜色。在这里，机器不可能比较这些颜色，比如哪个更大和更小(比如说黑色大于白色是无关紧要的)。因此，在这些情况下，有必要将这些文本转换成数字。</p><p id="708f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它遵循以下步骤:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/997c4acea577680c2b1a92a8953b0ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJykVXi_OQRULpK6PlGNPQ.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">要遵循的步骤</figcaption></figure><p id="1484" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，生成的输出向量可以用作机器学习算法的输入。</p><p id="719d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看两句话:</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="c534" class="ka kb hi jw b fi kc kd l ke kf">1. "John likes to watch movies. Mary likes movies too."</span><span id="57aa" class="ka kb hi jw b fi kg kd l ke kf">2. "John also likes to watch football games."</span></pre><p id="6dae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两个句子也可以用单词集合来表示。</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="6448" class="ka kb hi jw b fi kc kd l ke kf">1. ['John', 'likes', 'to', 'watch', 'movies.', 'Mary', 'likes', 'movies', 'too.']</span><span id="5520" class="ka kb hi jw b fi kg kd l ke kf">2. ['John', 'also', 'likes', 'to', 'watch', 'football', 'games']</span></pre><p id="1be0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，对于每个句子，删除多次出现的单词，并使用单词计数来表示。</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="6e26" class="ka kb hi jw b fi kc kd l ke kf">1. {"John":1,"likes":2,"to":1,"watch":1,"movies":2,"Mary":1,"too":1}</span><span id="5be3" class="ka kb hi jw b fi kg kd l ke kf">2. {"John":1,"also":1,"likes":1,"to":1,"watch":1,"football":1,   "games":1}</span></pre><p id="ae01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设这些句子是文档的一部分，下面是我们整个文档的组合词频。两个句子都考虑进去了。</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="d2db" class="ka kb hi jw b fi kc kd l ke kf">{"John":2,"likes":3,"to":2,"watch":2,"movies":2,"Mary":1,"too":1,  "also":1,"football":1,"games":1}</span></pre><p id="a381" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自文档中所有单词的上述词汇，以及它们各自的单词计数，将被用于创建每个句子的向量。</p><p id="e051" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">向量的长度将始终等于词汇量。在这种情况下，向量长度是10。</strong></p><p id="23dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在一个向量中表示我们的原始句子，每个向量都用全零初始化—<strong class="ih hj">【0，0，0，0，0，0，0，0】</strong></p><p id="0cc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来是与我们的词汇表中的每个单词进行迭代和比较，如果句子中有那个单词，就增加向量值。</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="a7fc" class="ka kb hi jw b fi kc kd l ke kf">John likes to watch movies. Mary likes movies too.<br/>=========================================================<!-- --> <br/>[1, 2, 1, 1, 2, 1, 1, 0, 0, 0]</span><span id="6256" class="ka kb hi jw b fi kg kd l ke kf">John also likes to watch football games.<br/>=========================================================<br/>[1, 1, 1, 1, 0, 0, 0, 1, 1, 1]</span></pre><p id="49e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，在句子1中，单词<code class="du kh ki kj jw b">likes</code>出现在第二个位置，并且出现了两次。因此，句子1的向量的第二个元素将是2:<strong class="ih hj">【1，2，1，1，2，1，1，0，0，0】</strong></p><p id="c782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">向量总是与我们的词汇量成正比。</p><p id="8810" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个生成的词汇表很大的大文档可能会产生一个包含很多0值的向量。这被称为<strong class="ih hj">稀疏向量</strong>。<em class="jp"> </em>稀疏向量在建模时需要更多的内存和计算资源。对于传统算法来说，大量的位置或维度会使建模过程非常具有挑战性。</p><h1 id="e286" class="kk kb hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">编写我们的BOW算法</h1><p id="8558" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">我们代码的输入将是多个句子，输出将是向量。</p><p id="1d9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入数组如下:</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="3faa" class="ka kb hi jw b fi kc kd l ke kf">["Joe waited for the train", "The train was late", "Mary and Samantha took the bus",</span><span id="1d38" class="ka kb hi jw b fi kg kd l ke kf">"I looked for Mary and Samantha at the bus station",</span><span id="a62c" class="ka kb hi jw b fi kg kd l ke kf">"Mary and Samantha arrived at the bus station early but waited until noon for the bus"]</span></pre><h2 id="3c92" class="ka kb hi bd kl lm ln lo kp lp lq lr kt iq ls lt kx iu lu lv lb iy lw lx lf ly bi translated">第一步:标记一个句子</h2><p id="8a7d" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">我们将从删除句子中的停用词开始。</p><blockquote class="lz ma mb"><p id="853a" class="if ig jp ih b ii ij ik il im in io ip mc ir is it md iv iw ix me iz ja jb jc hb bi translated"><strong class="ih hj">停用词</strong>是不包含足够重要性的词，在没有我们的算法的情况下不能使用。我们不希望这些单词占用我们的数据库空间，或者占用宝贵的处理时间。为此，我们可以通过存储您认为是停用词的单词列表来轻松删除它们。</p><p id="d729" class="if ig jp ih b ii ij ik il im in io ip mc ir is it md iv iw ix me iz ja jb jc hb bi translated"><strong class="ih hj">记号化</strong>是将一串字符串分解成单词、关键词、短语、符号和其他元素的行为，称为<strong class="ih hj">记号</strong>。记号可以是单个的单词、短语，甚至是整个句子。在标记化的过程中，一些类似标点符号的字符被丢弃。</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="4bcb" class="ka kb hi jw b fi kc kd l ke kf">def word_extraction(sentence):    <br/>   ignore = ['a', "the", "is"]    <br/>   words = re.sub("[^\w]", " ",  sentence).split()    <br/>   cleaned_text = [w.lower() for w in words if w not in ignore]    <br/>   return cleaned_text</span></pre><h2 id="332d" class="ka kb hi bd kl lm ln lo kp lp lq lr kt iq ls lt kx iu lu lv lb iy lw lx lf ly bi translated">第二步:对所有句子应用标记化</h2><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="43ec" class="ka kb hi jw b fi kc kd l ke kf">def tokenize(sentences):    <br/>   words = []    <br/>   for sentence in sentences:        <br/>     w = word_extraction(sentence)        <br/>     words.extend(w)            <br/>   words = sorted(list(set(words)))    <br/>   return words</span></pre><p id="1f3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该方法迭代所有句子，并将提取的单词添加到一个数组中。</p><p id="95cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该方法的输出将是:</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="bd86" class="ka kb hi jw b fi kc kd l ke kf">['and', 'arrived', 'at', 'bus', 'but', 'early', 'for', 'i', 'joe', 'late', 'looked', 'mary', 'noon', 'samantha', 'station', 'the', 'took', 'train', 'until', 'waited', 'was']</span></pre><h2 id="f1be" class="ka kb hi bd kl lm ln lo kp lp lq lr kt iq ls lt kx iu lu lv lb iy lw lx lf ly bi translated">第三步:建立词汇并生成向量</h2><p id="c367" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">使用步骤1和2中定义的方法创建文档词汇表，并从句子中提取单词。</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="749f" class="ka kb hi jw b fi kc kd l ke kf">def generate_bow(allsentences):        <br/>   vocab = tokenize(allsentences)    <br/>   print("Word List for Document \n{0} \n".format(vocab))</span><span id="0ca1" class="ka kb hi jw b fi kg kd l ke kf">  for sentence in allsentences:        <br/>    words = word_extraction(sentence)        <br/>    bag_vector = numpy.zeros(len(vocab))        <br/>    for w in words:            <br/>      for i,word in enumerate(vocab):                <br/>        if word == w:                     <br/>         bag_vector[i] += 1                            <br/>  print("{0}\n{1}\n".format(sentence,numpy.array(bag_vector)))</span></pre><p id="0af6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是我们代码的定义输入和执行:</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="0e72" class="ka kb hi jw b fi kc kd l ke kf">allsentences = ["Joe waited for the train train", </span><span id="ed83" class="ka kb hi jw b fi kg kd l ke kf">"The train was late", </span><span id="005b" class="ka kb hi jw b fi kg kd l ke kf">"Mary and Samantha took the bus",</span><span id="8bec" class="ka kb hi jw b fi kg kd l ke kf">"I looked for Mary and Samantha at the bus station",</span><span id="b5f9" class="ka kb hi jw b fi kg kd l ke kf">"Mary and Samantha arrived at the bus station early but waited until noon for the bus"]</span><span id="2751" class="ka kb hi jw b fi kg kd l ke kf">generate_bow(allsentences)</span></pre><p id="4038" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个句子的输出向量是:</p><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="7884" class="ka kb hi jw b fi kc kd l ke kf">Output:<br/>--------------------------------------<br/>Joe waited for the train train<br/>[0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 2. 0. 1. 0.]<br/>==================================================================<br/>The train was late<br/>[0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1.]<br/>==================================================================<br/>Mary and Samantha took the bus<br/>[1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0. 0. 0. 0.]<br/>==================================================================<br/>I looked for Mary and Samantha at the bus station<br/>[1. 0. 1. 1. 0. 0. 1. 1. 0. 0. 1. 1. 0. 1. 1. 0. 0. 0. 0. 0. 0.]<br/>==================================================================<br/>Mary and Samantha arrived at the bus station early but waited until noon for the bus<br/>[1. 1. 1. 2. 1. 1. 1. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 1. 1. 0.]</span></pre><p id="51cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你所看到的，<strong class="ih hj">每个句子都与我们在步骤1中生成的单词表进行了比较。基于该比较，向量元素值可以增加</strong>。这些向量可以在ML算法中用于文档分类和预测。</p><p id="95e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们编写了代码并生成了向量，但现在让我们多了解一下这个单词包。</p><h1 id="be9f" class="kk kb hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">洞察词汇袋</h1><p id="aac5" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">BOW模型只考虑一个已知单词是否出现在文档中。它不关心它们出现的意义、上下文和顺序。</p><p id="dd72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这提供了相似文档将具有彼此相似的字数的洞察力。换句话说，两个文档中的单词越相似，文档就越相似。</p><p id="bf9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，这都是关于单词袋的理解！</p><h1 id="39c6" class="kk kb hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">弓的局限性</h1><blockquote class="lz ma mb"><p id="dc25" class="if ig jp ih b ii ij ik il im in io ip mc ir is it md iv iw ix me iz ja jb jc hb bi translated"><strong class="ih hj">语义</strong>:基本的BOW方法不考虑单词在文档中的含义。它完全忽略了使用它的上下文。根据上下文或邻近单词，同一个单词可以用在多个地方。</p><p id="df52" class="if ig jp ih b ii ij ik il im in io ip mc ir is it md iv iw ix me iz ja jb jc hb bi translated"><strong class="ih hj">矢量大小</strong>:对于一个大文档，矢量大小可能会很大，导致大量的计算和时间。您可能需要根据与您的用例的相关性来忽略单词。</p></blockquote><p id="9699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">感谢您阅读本文。显示的代码在我的</strong><a class="ae mf" href="https://github.com/MachineLearnWithRosh/Bag-Of-Words" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">GitHub</strong></a><strong class="ih hj">上有。</strong></p><p id="ae51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在Medium和<a class="ae mf" href="http://www.linkedin.com/in/roshan-kumar-gupta-43a96bb2" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我。</p><p id="9c64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如有任何问题，您可以通过电子邮件(roshangg 96[at]Gmail[dot]com)联系我。</p></div></div>    
</body>
</html>