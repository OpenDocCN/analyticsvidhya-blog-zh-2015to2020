<html>
<head>
<title>Evaluation Criteria for Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习模型的评估标准</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/evaluation-criteria-for-machine-learning-models-ce04692cc3e3?source=collection_archive---------3-----------------------#2020-12-09">https://medium.com/analytics-vidhya/evaluation-criteria-for-machine-learning-models-ce04692cc3e3?source=collection_archive---------3-----------------------#2020-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bdf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据科学涉及到在我们甚至接近说我们有一个工作的机器学习模型之前进行多种活动。它涉及数据分析(也称为探索性数据分析，也称为EDA)，从数据集中的给定特征中创建有意义的特征(也称为特征工程)，然后在“清理”的数据集上应用机器学习模型。</p><p id="4603" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着像R/Python这样的工具和语言的出现，我们可以毫不费力地在清理后的数据集上应用机器学习算法，我想困难的部分是知道哪种算法应用于哪种问题，更困难的部分是确保应用的算法是准确的。</p><p id="2a6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将查看一些可用于检查机器学习算法准确性的评估指标，并了解哪种评估指标适用于哪种问题。</p><p id="1eb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是评估指标</strong></p><p id="548f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在监督学习下，我们有两种类型的业务问题</p><p id="538e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类——输出应符合预期类别之一。例如，客户是否会流失，社交媒体帖子是积极的、消极的还是中性的等等。</p><p id="34a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回归—其中输出是一个连续变量。例如基于过去的数据预测商店在这个冬天的销售额等。</p><p id="67c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归用于分类问题，线性回归用于回归问题。然而，有像决策树，KNN等算法。这可以应用于分类和回归。此外，由于有如此多的集成技术和超参数可用，检查应用于数据集的模型的准确性甚至更加重要。</p><p id="2f1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们在引言部分所讨论的，由于像R/Python这样的语言和市场上可用的无数工具，在数据集上应用机器学习算法已经变得很容易。一个数据科学家的工作不能仅仅通过对数据应用ML算法来完成，一个好的数据科学家应该使用不同的标准来评估他/她的算法。</p><p id="b294" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">不同类型的评估指标</strong></p><p id="3e61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">回归:</strong>在这一节中，我们将看看应该应用于评估回归算法优劣的评估指标</p><p id="cb55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们进入回归模型的评估度量之前，让我们看看术语“误差”。正如我们所见，回归涉及预测连续变量，因此误差是“实际期望值与ML模型预测值的差异”</p><p id="2908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">平均绝对误差(MAE): </strong>预测值与实际值的绝对差值的平均值。取绝对值是为了消除负值的影响</p><p id="0004" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MAE =绝对值(实际值-预测值之和))</p><p id="117e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该指标仅提供了误差大小的概念，但没有方向的概念(我们所说的方向是指它不会告诉您是预测过度还是预测不足)</p><p id="9f5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">均方误差(MSE): </strong>预测值与实际值之差的平方。</p><p id="4494" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MSE =的平方(实际值-预测值之和)</p><p id="3ae7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就像MAE一样，这个度量标准也提供了误差大小的概念，但没有方向的概念</p><p id="e546" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">均方根误差(RMSE): </strong>预测值与实际值之差的平方根。由于MSE值的平方，实际和预测的b/w差异的输出看起来非常大，因此在RMSE平方根中将单位转换回原始值。</p><p id="537c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">RMSE =的平方根(实际值-预测值之和的平方)</p><p id="4c62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一指标再次提供了误差大小的概念，但没有方向的概念</p><p id="1f3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> R square: </strong>到目前为止，我们已经看到这些评估指标提供了误差大小，但是我们如何知道多少误差值是可接受的呢？我们需要一些基线模型进行比较，因此我们将基线模型作为平均值，即预测值是所有值的平均值</p><p id="394b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">r平方= 1 — MSE(模型)/ MSE(基线模型)</p><p id="f6e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">均方差越小，预测越好；因此，从1中减去它，使得该值在0和1之间，即不适合完全适合</p><p id="f88e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">R square提供了一组预测值与实际值的拟合优度，因此可以对所有线性回归模型进行计算</p><p id="af11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">调整后的R平方:</strong>到目前为止，我们已经看到R平方是预测值的拟合优度，这意味着R平方的值越高，预测模型越好，但是R平方有一个问题。</p><p id="0861" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在模型中添加新特征后，R平方值总是增加(或保持不变),因为您在模型中添加的任何特征都会随机或逻辑地对预测值产生一些影响，因此R平方不断增加，我们会陷入模型变得越来越好的陷阱。</p><p id="c8db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，为了解决这个问题，调整后的R平方对于每个特征的添加都惩罚R平方值。</p><p id="04db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">调整后的R平方= 1-(1-R平方)[(n-1)/(n-k+1)]</p><p id="34c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中n =值的数量，k =特征的数量</p><p id="2f53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分母中包含k总是会降低整体值，因此，如果特征不重要，调整后的R平方值会降低。当你有更多的变量时，总是计算调整后的R平方，这样你就不会陷入增加R平方值的陷阱</p><p id="8459" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分类:</strong>在本节中，我们将了解应该应用于评估分类算法优劣的评估指标</p><p id="0dde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们进入不同的评估指标之前，让我们借助混淆矩阵来看几个基本术语。混淆矩阵是预测类别/值与实际类别/值的表格表示</p><p id="7c3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">二元分类情况下的混淆矩阵如下所示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/bfae143ab85b8d21fe84864dd37fc4dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*7Sd1tj2LNjt8LR4D9pq45A.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">混淆矩阵</figcaption></figure><p id="0fe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TP =真正值，即实际值为正，模型预测值也为正</p><p id="23e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FP =假阳性，即实际值为正，但我们的模型预测值为负</p><p id="8e4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FN =假阴性，即实际值为负，但我们的模型预测值为正</p><p id="42b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TN =真负值，即实际值为负值，模型预测值也为负值</p><p id="1153" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">准确性</strong> —它是所有预测中正确预测的数量。精确度可以从混淆矩阵中导出，例如，如果混淆矩阵基于您的ML模型如下所示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/b67c01380bb25b6c02aa257044ffd5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*KNDtC3kentZGuMvQYUNIxg.png"/></div></figure><p id="2bfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的准确率是:10 + 14(正确预测的数量)/ 10+14+2+4(总预测的数量)，结果是80%</p><p id="37bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们可以说你的模型给出了80%的准确率</p><p id="71a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们什么时候可以使用准确性:</p><p id="9097" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可用于二进制和多类问题</p><p id="d51a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">适用于每类中的观测值数量相等的情况</p><p id="533e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">适用于所有预测和预测误差同等重要的情况</p><p id="5dc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> AUC-ROC </strong> —称为受试者工作特征(ROC)曲线下面积。它是在不同概率阈值下计算的真阳性率(TPR)和假阳性率(FPR)的图，以预测类别标签。现在我们来看看更多的细节:</p><p id="6a2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">真阳性率(TPR) = TP/ TP + FP</p><p id="03da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假阳性率(FPR) = FP/ FP + TN</p><p id="c49c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看什么时候应该使用这个评价标准:</p><p id="22dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于平衡类的二元分类问题，即当两个二元类的观察值大致相等时(是/否)</p><p id="ccff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提供不同阈值的模型摘要</p><p id="1a12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可用于比较不同阈值的两种模型</p><p id="2a32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">精度</strong> —这是ML模型在所有实际阳性结果(Tue阳性+假阳性)中正确预测阳性结果(真阳性)的数量</p><p id="ab48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">精度= TP/ TP + FP</p><p id="e85f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">精度值越高越好。因此，当您的模型不能承受假阳性时，精度应该用作评估标准。例如，假设您有一个检测癌症(癌症= 1)的ML模型，在这种情况下，您的模型检测到某人患有癌症仍然是没问题的，因为进一步的测试将提供正确的结果，但如果出现假阳性则是灾难性的，即您的模型没有检测到癌症，而患者患有癌症</p><p id="255c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">回忆</strong> —这是所有预测阳性结果(真阳性+假阴性)中正确预测结果(真阳性)的数量</p><p id="6b36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">召回= TP/ TP + FN</p><p id="3255" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">召回值越高越好。因此，当你的模型不能承受假阴性时，回忆应该作为一个评估标准。例如，假设您有一个ML模型来检测有罪(有罪= 1)，在这种情况下，识别某人有罪而她/他不有罪是灾难性的</p><p id="dfaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> F1得分</strong> —它是精确度和召回率的调和平均值</p><p id="461e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">F1 = 2 / [1/召回率x 1/精确度]</p><p id="aa30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么时候我们应该使用这个评价标准:</p><p id="3a93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当精确度和召回率对您的输出都很重要时</p><p id="b007" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于具有不平衡类别的二元分类问题(当“是”或“否”的值与其他值相比非常小时，例如信用卡交易中的欺诈)</p><p id="72e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总之，有许多评估标准来检查您的ML算法的准确性，以便您可以根据可用的超级参数来微调您的算法。</p></div></div>    
</body>
</html>