<html>
<head>
<title>Yelp Dataset — Classifying Users as ‘Harsh’ or ‘Lenient’</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Yelp数据集——将用户分为“苛刻”或“宽容”两类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/classifying-yelp-users-as-harsh-or-lenient-e8021a299567?source=collection_archive---------21-----------------------#2020-05-30">https://medium.com/analytics-vidhya/classifying-yelp-users-as-harsh-or-lenient-e8021a299567?source=collection_archive---------21-----------------------#2020-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/d20af1cf75300a924167b6830a8f513c.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*Z6II-I2VlLPU5Zdbm9l68w.png"/></div></figure><h1 id="11d6" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">动机</h1><p id="6bb9" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">Yelp数据集是为研究用途发布的数据集合。在这篇文章中，我们关注于使用数据来理解流行用户的影响；拥有大量粉丝并被Yelp授予<em class="ki">精英</em>身份的用户。</p><p id="83d4" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">毫无疑问，这些受欢迎的用户对其他用户的决策有着深远的影响。然而，受欢迎的用户给予企业的评论或评级可能不反映企业的实际表现。正如社会上的任何意见一样，这些用户在本质上可能过于“苛刻”或“宽容”。</p><p id="49a1" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">我们将首先设计一种方法来将流行用户分类为“苛刻”或“宽容”，以便其他用户在接受流行用户的话之前有额外的信息，使用来自多个假设测试的工具来确保这些结果的重要性。然后，我们将研究影响流行用户性质的一些属性。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><h1 id="9c74" class="im in hi bd io ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj bi translated">受欢迎用户的重要性</h1><p id="a8ad" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">流行用户是基于以下标准定义的</p><ul class=""><li id="2a66" class="la lb hi jm b jn kj jr kk jv lc jz ld kd le kh lf lg lh li bi translated">前1%的粉丝群</li><li id="ee32" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lf lg lh li bi translated">连续两年或以上成为精英会员</li></ul><p id="0818" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">共有N = 752个流行用户。</p><p id="2eb5" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">为了证明这些用户的重要性，我们将重点关注在热门用户发布评论前后τ = 60天的时间窗口内某个企业的签到次数。</p><p id="2972" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">预计在负面评价(1星评级)后，入住数量会减少，而正面评价(5星评级)则相反。为此，我们遵循以下方法:</p><ol class=""><li id="aa3f" class="la lb hi jm b jn kj jr kk jv lc jz ld kd le kh lo lg lh li bi translated">获取发布大众用户评论的日期，t₀</li><li id="48fe" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lo lg lh li bi translated">找出(m₀)之前和(m₁)之后的累计签到次数的梯度</li><li id="17f4" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lo lg lh li bi translated">计算梯度的变化，δᴾᵒᵖᵘˡᵃʳ</li><li id="6f14" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lo lg lh li bi translated">对5个正常用户重复上述操作，并找到他们梯度变化的平均值，δᴺᵒʳᵐᵃˡ</li><li id="aca5" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lo lg lh li bi translated">在5%的显著性水平上进行双尾假设检验，其中|h₀:μ=δᴺᵒʳᵐᵃˡ|和|h₁:μ≠δᴺᵒʳᵐᵃˡ|，μ= δᴾᵒᵖᵘˡᵃʳ.</li><li id="d04c" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lo lg lh li bi translated">对所有受欢迎的用户评论重复上述步骤。</li></ol><p id="3b86" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">下面显示了一个例子，在这个例子中，在受欢迎的用户发布了一个糟糕的评级后，梯度就发生了明显的变化。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lp"><img src="../Images/939da80ccad9b0ff4ed0202e9e18c057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CIfE05D5ss5YGkrn"/></div></div></figure><p id="c203" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">共有923个1星或5星的流行用户评论，其中641个通过了假设检验，为“显著”。因此，我们可以得出结论，69%的1星/5星受欢迎用户评论在95%的置信区间导致受评论业务的受欢迎程度下降/上升。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><h1 id="5e8c" class="im in hi bd io ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj bi translated">对流行用户进行分类</h1><p id="f2be" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">我们已经证明了流行用户的评论事实上是重要的。现在，我们将根据定义的标准将这些用户分为“苛刻”或“宽松”。</p><p id="235d" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">对于来自用户<em class="ki"> i </em>的业务<em class="ki"> j </em>的每个评论，分配一个分数</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es ly"><img src="../Images/4a65b725cfc97d7bd965d1615eadf13a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hFjrgZVQD79duqSD"/></div></div></figure><p id="2da2" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">其中m是用户<em class="ki"> i </em>评论过的餐厅总数，<em class="ki">r</em>ᵢⱼ<em class="ki">t5】是用户<em class="ki"> i </em>给餐厅<em class="ki"> j </em>和&lt; <em class="ki"> r </em> ⱼ &gt; <em class="ki"> </em>是餐厅<em class="ki">j</em>的平均评分</em></p><p id="115f" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">sᵢⱼ &lt; 0 indicates a harsh score and sᵢⱼ &gt; 0表示宽松的分数。因此，可以取每个用户的所有分数的平均值，并且可以使用该标准对用户进行分类。然而，这些结果的显著性需要检验。相反，我们在5%的显著性水平上进行双尾t检验，以获得p值pᵢ，其中假设为</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/769dd767b6e3aed1b5f559a5e3a62d65.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/0*jjHig2j7Y35b9cMn"/></div></figure><p id="b750" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">我们将sᵢ称为用户<em class="ki"> i </em>的平均评级偏差。t检验假设sᵢ服从正态分布，这是基于下图的合理假设。此外，当进行Kolmogorov-Smirnov检验时，返回的p值为0.027，这意味着sᵢ可以在2.5%的显著性水平上用正态分布来描述。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/620726ff39bae2b7cbd4c36b4a4cde10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/0*aQzH4F1B8j1Rbp8x"/></div></figure><h1 id="22fd" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">多重假设检验</h1><p id="4dae" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">如果我们只测试了一个用户的分数，并得到pᵢ ≤ 5%，那么我们拒绝零假设，并根据他们的分数对用户进行分类。然而，我们正在测试许多用户对同一数据导致的科学现象<em class="ki"> P-Hacking — </em>操纵数据以获得具有统计意义的P值<em class="ki">(详见本文</em> <a class="ae mb" rel="noopener" href="/@i.pamuditha/p-hacking-part-01-introduction-what-is-p-value-7b78d2b3484"> <em class="ki">文章</em> </a> <em class="ki">)。这反过来增加了我们数据中假阳性的数量——不正确的重要结果。为了控制假阳性发生的数量，我们可以使用家庭式错误率(FWER)或假发现率(FDR)对此进行校正。</em></p><p id="0d49" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">FWER是至少一个假发现的概率，因此我们将使用Bonferroni的方法来减少假阳性的数量。为了实现这一点，当pᵢ≤α/ν时，零假设被拒绝，其中α是5%显著性区间。可以看出，当我们有大的N(大量测试)时，这个条件变得更加严格，我们最终会拒绝真阳性。这将显示在结果中。</p><p id="4fb7" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">为了解决拒绝真阳性的问题，我们可以使用限制较少的FDR标准来控制1型错误。为此，我们遵循BH(q) (Benjamini-Hochberg程序)。该过程如下</p><ol class=""><li id="c6d8" class="la lb hi jm b jn kj jr kk jv lc jz ld kd le kh lo lg lh li bi translated">按升序对p值进行排序</li><li id="1033" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lo lg lh li bi translated">找出最大的p值，使得pᵢ≤q * I/ν</li><li id="e476" class="la lb hi jm b jn lj jr lk jv ll jz lm kd ln kh lo lg lh li bi translated">剔除p值<em class="ki"> 1，…，i </em></li></ol><p id="dbf9" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">这些不同的修正方法会对用户进行不同的分类。</p><h1 id="2b51" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">探索用户属性</h1><p id="496b" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">最后，我们将探索这些用户的一些属性。这将基于其他用户对一个受欢迎的用户给出的所有评论的反应，而这些评论又是由反应给出的；可爱的，有趣的，朴素的，作家的，火辣的，酷的。对于这些属性，这些值都被转换为概率，即用户<em class="ki"> i </em>在其评论中获得“酷”反应的概率是多少。例如，如果用户对他们的评论有总共个Rᵗᵒᵗᵃˡ反应，其中Rᶜᵒᵒˡ是“酷”反应，则该用户的值为Pᶜᵒᵒˡ = Rᶜᵒᵒˡ/Rᵗᵒᵗᵃˡ.所有反应的P之和应该等于1。这些属性中的每一个与每个用户的平均评级偏差sᵢ的相关性将通过执行回归分析来计算。</p><p id="86dd" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">最后一个属性是流行用户的性别。Yelp数据集不包含性别，而是使用Python上的<em class="ki"> genderize </em>包根据用户的姓名来猜测性别。对此的分析将基于前四个时刻。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><h1 id="e2e2" class="im in hi bd io ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj bi translated">评估结果</h1><p id="871c" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">不出所料，Bonferroni方法在拒绝假设方面被证明是非常严格的。事实上，有| sᵢ &gt; 1 |的用户(他们对企业的评级偏离平均企业评级超过1星)不会被拒绝。因此，在本例中，Bonferroni方法大大减少了假阴性的数量，但代价是拒绝了更多的真阳性。使用BH(q)校正进行多重假设检验被证明是一种较好的方法。我们可能会发现一些错误的发现，但只要大多数是正确的，这在这种情况下应该不是问题。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mc"><img src="../Images/6c22cd36e809054a0f05508a168c6359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QOKJGMmeDGcuNHmV"/></div></div></figure><p id="9c68" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">当绘制p对sᵢ的每个反应时，趋势如下图所示，证明其他用户对受欢迎用户的评论的反应与受欢迎用户是严厉还是宽容之间没有关系。然而，这可能是因为所有的评论反应都是积极的。有一些负面反应会透露更多信息。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es md"><img src="../Images/e6a2e468d9d82a0d6ff123eba2d42f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bvFWgj8Ysv9gOm96"/></div></div></figure><p id="9e62" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">接下来我们来看看性别的影响。表2中显示的4个矩表明存在某种关系。总的来说，女性在评论时似乎比男性更苛刻。这可以从男性和女性的平均和偏斜的相反符号中具体看出。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es me"><img src="../Images/086b915f8703880a843fdb584a7df606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_7RTzh-KocMicqjN"/></div></div></figure><p id="dc78" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">为了进一步研究这个问题，我们建立了一个逻辑回归模型来预测用户是男是女，这取决于他们的评级与真实业务评级的偏差(sᵢ).该模型的样本内准确率为66%，样本外准确率为68%；证明这可能是进一步研究的一个有趣领域，特别是调整机器学习模型以改善该测试的结果。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="4adc" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">摆弄Yelp数据集是发展你的数据分析技能的好方法。我强烈推荐下载数据集，玩玩看能不能得出什么有趣的结论。</p></div></div>    
</body>
</html>