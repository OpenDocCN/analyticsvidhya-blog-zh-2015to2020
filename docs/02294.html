<html>
<head>
<title>Confusion Matrix, Accuracy, Precision, Recall, F1 Score</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混淆矩阵、准确度、精确度、回忆、F1分数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/confusion-matrix-accuracy-precision-recall-f1-score-ade299cf63cd?source=collection_archive---------0-----------------------#2019-12-10">https://medium.com/analytics-vidhya/confusion-matrix-accuracy-precision-recall-f1-score-ade299cf63cd?source=collection_archive---------0-----------------------#2019-12-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e8b8" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">二元分类度量</strong></h2></div><h2 id="3801" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated"><strong class="ak">如何评价一个机器学习模型的性能？</strong></h2><p id="4e75" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">让我们考虑一个任务，对一个人是<strong class="jx hj">怀孕</strong>还是<strong class="jx hj">没怀孕</strong>进行分类。如果怀孕测试呈阳性(+ve)，那么这个人就是怀孕了。另一方面，如果怀孕测试是阴性(-ve)，那么这个人没有怀孕。</p><p id="04e0" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">现在考虑由机器学习算法进行的上述分类(怀孕或未怀孕)。机器学习算法的输出可以映射到以下类别之一。</p><ol class=""><li id="44c2" class="kt ku hi jx b jy ko kb kp ji kv jm kw jq kx kn ky kz la lb bi translated">实际怀孕(阳性)并归类为怀孕(阳性)的人。这叫<strong class="jx hj">真正(<em class="lc"> TP </em>)。</strong></li></ol><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ld"><img src="../Images/c5dcb0515715261b8420d12eb5d46cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*Q6-K7WYnNNw0no2AwgQCTg.jpeg"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">图1:真阳性。</figcaption></figure><p id="f154" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">2.实际上没有怀孕(阴性)并被归类为没有怀孕(阴性)的人。这叫做<strong class="jx hj">真否定(<em class="lc"> TN </em>)。</strong></p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lp"><img src="../Images/615367faa1a0af2470eaa41596b65d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*ptuWd5YIkY8owxVvyGL_Ug.jpeg"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">图2:真阴性。</figcaption></figure><p id="0165" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">3.实际上没有怀孕(阴性)而被归类为怀孕(阳性)的人。这叫做<strong class="jx hj">假阳性(<em class="lc"> FP </em>)。</strong></p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lq"><img src="../Images/8b90739229189b14a36486f9506a80c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*PPVyz2ZdiHfsykqlS2Zpmw.jpeg"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">图3:假阳性。</figcaption></figure><p id="47e2" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">4.实际怀孕(阳性)并被归类为未怀孕(阴性)的人。这叫做<strong class="jx hj">假阴性(<em class="lc"> FN </em>)。</strong></p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lr"><img src="../Images/ad7a7d2b636edb65cabee5ed1b9c40db.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*UShjXzBZQFeDMtc3d0viPw.jpeg"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">图4。假阴性。</figcaption></figure><p id="24e6" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">我们想要的是<strong class="jx hj">真阳性</strong>和<strong class="jx hj">真阴性</strong>，但是由于分类错误，我们也可能以<strong class="jx hj">假阳性</strong>和<strong class="jx hj">假阴性而告终。</strong>所以对一个人是否怀孕的分类存在混乱。这是因为没有一个机器学习算法是完美的。不久我们将在一个称为混淆矩阵的矩阵中描述这种对数据进行分类的混淆。</p><p id="efd3" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">现在，我们选择100个人，其中包括孕妇，不包括孕妇和腹部肥胖的男性。让我们假设这100人中有40人怀孕，剩下的60人包括未怀孕的女性和腹部肥胖的男性。我们现在使用机器学习算法来预测结果。使用机器学习算法的预测结果(怀孕+ve或-ve)被称为<strong class="jx hj"> <em class="lc">预测标记</em> </strong>，真实结果(在这种情况下，我们从医生/专家的记录中得知)被称为<strong class="jx hj"> <em class="lc">真实标记</em> </strong>。</p><p id="8d8d" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">现在我们将介绍<strong class="jx hj"> <em class="lc">混淆矩阵</em> </strong>，它是计算机器学习算法在将数据分类到其相应标签中的<strong class="jx hj"> <em class="lc">准确度</em> </strong>所需要的。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ls"><img src="../Images/644ff860c730cd2da8d826e6d3d92bd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UcjYCTujXzmVohL7xU1s4w.png"/></div></div></figure><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lx"><img src="../Images/ac9a7c5359c352dedbf8d976d0dfc64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*RAjgF3akuC47Le0iGfZ2_A.png"/></div></figure><p id="fcb4" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">下图说明了二元分类问题的混淆矩阵。</p><div class="le lf lg lh fd ab cb"><figure class="ly li lz ma mb mc md paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><img src="../Images/fa9782af390f7fa2b6bb9e79c357bd44.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*f5ZeXvhsNFZ4q91M4Lotgg.jpeg"/></div></figure><figure class="ly li me ma mb mc md paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><img src="../Images/0b3118106c7814d021a6dc058a019df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*5CATnJ2FyNOF9xTpJ7qA5w.jpeg"/></div><figcaption class="ll lm et er es ln lo bd b be z dx mf di mg mh translated">图5:混淆矩阵。</figcaption></figure></div><p id="ca0b" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">我们现在回到先前的例子，将100人(包括40名孕妇，其余60名不是孕妇和腹部肥胖的男性)分类为怀孕或未怀孕。通过机器学习算法，在40名孕妇中，30名孕妇被正确分类，其余10名孕妇被分类为未怀孕。另一方面，在未怀孕类别的60人中，55人被归类为未怀孕，其余5人被归类为怀孕。</p><p id="1018" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">本例中，<strong class="jx hj"><em class="lc"/></strong>= 55，<strong class="jx hj"> <em class="lc"> FP </em> </strong> = 5，<strong class="jx hj"> <em class="lc"> FN </em> </strong> = 10，<strong class="jx hj"> <em class="lc"> TP </em> </strong> = 30。混淆矩阵如下。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es et"><img src="../Images/036af8d2c73079787404c7f9d147568e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qn9aixzYGKIBB62QrQPfNQ.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">图6:怀孕与未怀孕分类的混淆矩阵。</figcaption></figure><h2 id="8e33" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">这个分类任务的机器学习模型的<strong class="ak">精度</strong>是多少？</h2><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mi"><img src="../Images/d2650641ea55768929d1c81ecacf23f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFW6rXbctrhWHxD8OXi4wg.png"/></div></div></figure><p id="8d44" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">准确度表示正确分类的数据实例的数量占数据实例总数的比例。</p><p id="177d" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">在本例中，准确度= (55 + 30)/(55 + 5 + 30 + 10 ) = 0.85，百分比准确度为85%。</p><h2 id="69fa" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">准确性是最好的衡量标准吗？</h2><p id="5c03" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">如果数据集不平衡(负类和正类都有不同数量的数据实例)，准确性可能不是一个好的衡量标准。我们将用一个例子来解释这一点。</p><p id="0ee5" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">考虑以下场景:有90个人健康(阴性)，10个人患有某种疾病(阳性)。现在，假设我们的机器学习模型完美地将90个人分类为健康，但它也将不健康的人分类为健康。在这种情况下会发生什么？让我们看看混淆矩阵，找出准确度？</p><p id="a46d" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">本例中，<strong class="jx hj"><em class="lc"/></strong>= 90，<strong class="jx hj"> <em class="lc"> FP </em> </strong> = 0，<strong class="jx hj"> <em class="lc"> FN </em> </strong> = 10，<strong class="jx hj"> <em class="lc"> TP </em> </strong> = 0。混淆矩阵如下。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mj"><img src="../Images/237d1e10d5cca17fcd62b6e3606f7915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1cFV9vNv1RgW7m211Nv1yQ.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">图7:健康与不健康人群分类任务的混淆矩阵。</figcaption></figure><p id="6066" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">在这种情况下，精度将是(90 + 0)/(100) = 0.9，精度百分比为90 %。</p><h2 id="27c7" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">有什么猫腻吗？</h2><p id="4f83" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">在这种情况下，准确度是90 %,但是这个模型非常差，因为所有10个不健康的人都被分类为健康的。通过这个例子，我们想说的是，当数据集不平衡时，准确性不是一个好的衡量标准。在这种情况下使用准确性会导致对结果的误导性解释。</p><p id="2a6b" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">所以现在我们进一步找出另一个分类标准。我们再次回到怀孕分类的例子。</p><p id="ec59" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">现在我们将在数据实例分类中找到<strong class="jx hj">精度(阳性预测值)</strong>。精度定义如下:</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es mk"><img src="../Images/ceeaf32932fb9b6f1c1797e88a06ab48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*VXnUvOEdf3IiYVCD6Wd2vg.png"/></div></figure><h2 id="1d50" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">精准是什么意思？</h2><p id="369e" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated"><strong class="jx hj"> <em class="lc">精度</em> </strong>对于一个好的分类器来说理想情况下应该是1(高)。只有当分子和分母相等时<strong class="jx hj"> <em class="lc">精度</em> </strong>才会变为1，即<strong class="jx hj"> <em class="lc"> TP = TP +FP </em> </strong>，这也意味着<strong class="jx hj"> <em class="lc"> FP </em> </strong>为零。随着<strong class="jx hj"> <em class="lc"> FP </em> </strong>的增加，分母的值变得大于分子而<strong class="jx hj"> <em class="lc">的精度</em> </strong>的值减小(这是我们不希望的)。</p><p id="8584" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">所以在怀孕的例子中，<strong class="jx hj"> <em class="lc">精度</em> </strong> = 30/(30+ 5) = 0.857</p><p id="1734" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">现在我们将介绍另一个重要的指标叫做<strong class="jx hj"> <em class="lc">召回</em> </strong>。<strong class="jx hj"> <em class="lc">召回</em> </strong>又称为<strong class="jx hj"> <em class="lc">灵敏度</em> </strong>或<strong class="jx hj"> <em class="lc">真阳性率</em> </strong>，定义如下:</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ml"><img src="../Images/575cb0558b7c452194de8d692afa45b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*Aj3aYW4vwYAoJqyL36PVtQ.png"/></div></figure><p id="4987" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated"><strong class="jx hj"> <em class="lc">回想一下</em> </strong>理想情况下应该是1(高)为好的分类器。<strong class="jx hj"> <em class="lc">回忆</em> </strong>只有当分子和分母相等时才变成1，即<strong class="jx hj"> <em class="lc"> TP = TP +FN </em> </strong>，这也意味着<strong class="jx hj"> <em class="lc"> FN </em> </strong>为零。随着<strong class="jx hj"><em class="lc"/></strong>FN的增加，分母的值变得大于分子而<strong class="jx hj"><em class="lc"/></strong>的值减小(这是我们不希望的)。</p><p id="32d4" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">所以在怀孕的例子中，让我们看看回忆是什么。</p><p id="838f" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated"><strong class="jx hj"> <em class="lc">回忆</em> </strong> = 30/(30+ 10) = 0.75</p><p id="0bc5" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">所以理想情况下，在一个好的分类器中，我们希望<strong class="jx hj"> <em class="lc">精度</em> </strong>和<strong class="jx hj"> <em class="lc">召回</em> </strong>为一，这也意味着<strong class="jx hj"> <em class="lc"> FP </em> </strong>和<strong class="jx hj"> <em class="lc"> FN </em> </strong>为零。因此，我们需要一个同时考虑到<strong class="jx hj"><em class="lc"/></strong>和<strong class="jx hj"> <em class="lc">召回</em> </strong>的指标。<strong class="jx hj"><em class="lc">F1-分数</em> </strong>是一个同时考虑了<strong class="jx hj"> <em class="lc">精度</em> </strong>和<strong class="jx hj"> <em class="lc">召回</em> </strong>的指标，定义如下:</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mm"><img src="../Images/ec3007675cb5a93f34052a7c09fce13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uo7HN1pdMlMwTbNSdyO3A.png"/></div></div></figure><p id="1353" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">只有当<strong class="jx hj"><em class="lc"/></strong><strong class="jx hj"><em class="lc"/></strong>都为1时，<strong class="jx hj"> <em class="lc"> F1得分</em> </strong>才变为1。只有当<strong class="jx hj"><em class="lc"/></strong><strong class="jx hj"><em class="lc"/></strong>都高时<strong class="jx hj"> <em class="lc"> F1分</em> </strong>才会变高。<strong class="jx hj"> <em class="lc"> F1得分</em> </strong>是<strong class="jx hj"> <em class="lc">精度</em></strong><strong class="jx hj"><em class="lc">召回</em> </strong>的调和平均值，是比<strong class="jx hj"> <em class="lc">精度</em> </strong>更好的衡量指标。</p><p id="e421" class="pw-post-body-paragraph jv jw hi jx b jy ko ij ka kb kp im kd ji kq kf kg jm kr ki kj jq ks kl km kn hb bi translated">在怀孕的例子中，<strong class="jx hj"> <em class="lc"> F1得分</em></strong>= 2 *(0.857 * 0.75)/(0.857+0.75)= 0.799。</p><h2 id="d413" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">参考书目</h2><p id="6bc1" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">下面是neptune.ai的一篇关于常见二进制分类度量的有趣文章。文章的链接可以在这里找到:<a class="ae mn" href="https://neptune.ai/blog/f1-score-accuracy-roc-auc-pr-auc)" rel="noopener ugc nofollow" target="_blank">https://neptune.ai/blog/f1-score-accuracy-roc-auc-pr-auc</a></p></div></div>    
</body>
</html>