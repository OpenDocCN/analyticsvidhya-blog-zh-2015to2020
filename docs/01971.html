<html>
<head>
<title>Python 3.8 New Features: The Walrus Operator And Positional-Only Parameters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 3.8新特性:Walrus运算符和仅位置参数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-3-8-new-features-the-walrus-operator-and-positional-only-parameters-e7333eb8be2a?source=collection_archive---------14-----------------------#2019-11-24">https://medium.com/analytics-vidhya/python-3-8-new-features-the-walrus-operator-and-positional-only-parameters-e7333eb8be2a?source=collection_archive---------14-----------------------#2019-11-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ff1f34f941ecb741fec4f473faaaf995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d9Mnmd1BuQIW1eMc1ua0KA.png"/></div></div></figure><h1 id="8cbc" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">部分概述</h1><ul class=""><li id="6a5c" class="jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated">海象运营商</li><li id="8286" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated">仅位置参数</li><li id="adc2" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated">参考</li></ul><h1 id="1fd4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">第1部分Walrus运算符(赋值表达式)</h1><p id="bc69" class="pw-post-body-paragraph kl km hi jq b jr js kn ko jt ju kp kq jv kr ks kt jx ku kv kw jz kx ky kz kb hb bi translated">我们使用赋值表达式(<code class="du la lb lc ld b">walrus operator</code>)。它使用walrus操作符(<code class="du la lb lc ld b">:=</code>)在一个表达式中对变量名赋值和求值，从而减少了重复。这是在<code class="du la lb lc ld b">Python 3.8</code>中引入的一种新语法，解决了该语言长期存在的导致代码重复的问题。</p><p id="9654" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">现在，让我们看看:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="6f77" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">if</strong> fake_val :<strong class="ld hj">=</strong> fake_func():<br/>    <em class="lw"># do something with fake_val</em></span><span id="3f16" class="lr ir hi ld b fi lx lt l lu lv"><strong class="ld hj">while</strong> fake_val :<strong class="ld hj">=</strong> fake_func():<br/>    <em class="lw"># do something with fake_val<br/></em></span><span id="1aa0" class="lr ir hi ld b fi lx lt l lu lv">fake_val <strong class="ld hj">=</strong> fake_func1()</span><span id="7fb3" class="lr ir hi ld b fi lx lt l lu lv"><strong class="ld hj">if</strong> <strong class="ld hj">not</strong> fake_val:<br/>    logging<strong class="ld hj">.</strong>warning('fake func1')<br/>    fake_val <strong class="ld hj">=</strong> fake_func2()<br/>    <strong class="ld hj">if</strong> <strong class="ld hj">not</strong> fake_val:<br/>        logging<strong class="ld hj">.</strong>warning('fake func2')<br/>        val <strong class="ld hj">=</strong> func3()</span><span id="3416" class="lr ir hi ld b fi lx lt l lu lv"><strong class="ld hj">if</strong> <strong class="ld hj">not</strong> fake_val:<br/>    <strong class="ld hj">raise</strong> ValueError('....')</span></pre><p id="1ee2" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">升级到3.8后，您可以将其重构为:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="1c64" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">if</strong> <strong class="ld hj">not</strong> (fake_val :<strong class="ld hj">=</strong> fake_func1()):<br/>    logging<strong class="ld hj">.</strong>warning('fake func1')<br/>    <strong class="ld hj">if</strong> <strong class="ld hj">not</strong> (fake_val :<strong class="ld hj">=</strong> fake_func2()):<br/>        logging<strong class="ld hj">.</strong>warning('fake func2')<br/>        <strong class="ld hj">if</strong> <strong class="ld hj">not</strong> (fake_val :<strong class="ld hj">=</strong> fake_func3()):<br/>            <strong class="ld hj">raise</strong> ValueError('....')</span></pre><p id="7a40" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">例如，在这里，我定义了篮子的内容。</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="5c45" class="lr ir hi ld b fi ls lt l lu lv">fruits_in_basket <strong class="ld hj">=</strong> {<br/>    'apple': 15,<br/>    'peach': 10,<br/>    'lemon': 5,<br/>}</span></pre><p id="5df0" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">现在我们想点一些柠檬。所以我们需要确保篮子里至少有一个柠檬。</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="c744" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">def</strong> <strong class="ld hj">order_func</strong>(count):<br/>    <strong class="ld hj">...</strong></span><span id="6673" class="lr ir hi ld b fi lx lt l lu lv"><strong class="ld hj">def</strong> <strong class="ld hj">out_of_stock</strong>():<br/>    <strong class="ld hj">...</strong></span><span id="4c22" class="lr ir hi ld b fi lx lt l lu lv">count <strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('lemon', 0)<br/><strong class="ld hj">if</strong> count:<br/>    order_func(count)<br/><strong class="ld hj">else</strong>:<br/>    out_of_stock()</span></pre><p id="a671" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">升级到3.8后，您可以将其重构为:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="1237" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">if</strong> count :<strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('lemon', 0):<br/>    order_func(count)<br/><strong class="ld hj">else</strong>:<br/>    out_of_stock()</span></pre><p id="da67" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">如果我们想做柠檬汁，我们需要10个柠檬。</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="24cf" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">def</strong> <strong class="ld hj">make_lemon_juice</strong>(count):<br/>    <strong class="ld hj">...</strong></span><span id="81b1" class="lr ir hi ld b fi lx lt l lu lv">count <strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('lemon', 0)<br/><strong class="ld hj">if</strong> count <strong class="ld hj">&gt;=</strong> 10:<br/>    make_lemon_juice(count)<br/><strong class="ld hj">else</strong>:<br/>    out_of_stock()</span></pre><p id="0f22" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">升级到3.8后，您可以将其重构为:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="7f8f" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">if</strong> (count :<strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('lemon', 0)) <strong class="ld hj">&gt;=</strong> 10:<br/>    make_lemon_juice(count)<br/><strong class="ld hj">else</strong>:<br/>    out_of_stock()</span></pre><p id="1f29" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">如果我们想点桃子和柠檬汁；</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="1626" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">def</strong> <strong class="ld hj">make_peach_juice</strong>(count):<br/>    <strong class="ld hj">...</strong></span><span id="755c" class="lr ir hi ld b fi lx lt l lu lv"><strong class="ld hj">def</strong> <strong class="ld hj">make_lemon_juice</strong>(count):<br/>    <strong class="ld hj">...</strong></span><span id="6bcb" class="lr ir hi ld b fi lx lt l lu lv">count <strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('peach', 0)<br/><strong class="ld hj">if</strong> count <strong class="ld hj">&gt;=</strong> 2:<br/>    make_peach_juice(count)<br/><strong class="ld hj">else</strong>:<br/>    count <strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('lemon', 0)<br/>    <strong class="ld hj">if</strong> count <strong class="ld hj">&gt;=</strong> 10:<br/>        make_lemon_juice(count)<br/>    <strong class="ld hj">else</strong>:<br/>        <em class="lw"># 'Nothing'</em></span></pre><p id="1cc9" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">升级到3.8后，您可以将其重构为:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="8f41" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">if</strong> (count :<strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('peach', 0)) <strong class="ld hj">&gt;=</strong> 2:<br/>    make_peach_juice(count)<br/><strong class="ld hj">elif</strong> (count :<strong class="ld hj">=</strong> fruits_in_basket<strong class="ld hj">.</strong>get('lemon', 0)) <strong class="ld hj">&gt;=</strong> 10:<br/>    make_lemon_juice(count)<br/><strong class="ld hj">else</strong>:<br/>    <em class="lw"># 'Nothing'</em></span></pre><p id="02ae" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">一般来说，当您发现自己在一组行中多次重复相同的表达式或赋值时，是时候考虑使用赋值表达式来提高可读性了。</p><h1 id="0701" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">第2部分—仅位置参数</h1><p id="f41c" class="pw-post-body-paragraph kl km hi jq b jr js kn ko jt ju kp kq jv kr ks kt jx ku kv kw jz kx ky kz kb hb bi translated">我们可以在函数定义中使用<code class="du la lb lc ld b">/</code>来表示在它之前的参数只是位置性的。</p><p id="5a12" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">例如:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="46b0" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">def</strong> <strong class="ld hj">func</strong>(a, <strong class="ld hj">/</strong>):<br/>    <strong class="ld hj">pass</strong></span><span id="739b" class="lr ir hi ld b fi lx lt l lu lv">func('foobar')</span><span id="2f94" class="lr ir hi ld b fi lx lt l lu lv"><em class="lw"># This raises</em><br/>func(a<strong class="ld hj">=</strong>'foobar')</span></pre><p id="6b6c" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">如果func在需要<code class="du la lb lc ld b">positional-only</code>时使用<code class="du la lb lc ld b">keyword argument</code>，则<code class="du la lb lc ld b">TypeError</code>发生。</p><p id="e0e8" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">下面是一个包含所有参数类型的函数定义示例。</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="a032" class="lr ir hi ld b fi ls lt l lu lv"><strong class="ld hj">def</strong> <strong class="ld hj">func</strong>(a, <strong class="ld hj">/</strong>, b, <strong class="ld hj">*</strong>, c):<br/>    <strong class="ld hj">pass</strong></span><span id="5cab" class="lr ir hi ld b fi lx lt l lu lv">a: positional-only<br/>b: positional or keyword<br/>c: keyword-only</span></pre><p id="d3e7" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">因此，<code class="du la lb lc ld b">func</code>可以这样叫:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="cbae" class="lr ir hi ld b fi ls lt l lu lv">func('foo', 'bar', c<strong class="ld hj">=</strong>'foobar')</span><span id="d596" class="lr ir hi ld b fi lx lt l lu lv">func('foo', b<strong class="ld hj">=</strong>'bar', c<strong class="ld hj">=</strong>'foobar')</span></pre><p id="c074" class="pw-post-body-paragraph kl km hi jq b jr le kn ko jt lf kp kq jv lg ks kt jx lh kv kw jz li ky kz kb hb bi translated">但不是这样的:</p><pre class="lj lk ll lm fd ln ld lo lp aw lq bi"><span id="3d67" class="lr ir hi ld b fi ls lt l lu lv"><em class="lw"># TypeError: func() got some positional-only arguments passed as keyword arguments: 'a'</em><br/>func(a<strong class="ld hj">=</strong>'foo', b<strong class="ld hj">=</strong>'bar', c<strong class="ld hj">=</strong>'foobar')</span><span id="66a5" class="lr ir hi ld b fi lx lt l lu lv"><em class="lw"># TypeError: func() takes 2 positional arguments but 3 were given</em><br/>func('foo', 'bar', 'foobar')</span></pre><h1 id="3e86" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">第3节—参考文献</h1><ul class=""><li id="3491" class="jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><a class="ae ly" href="https://www.python.org/dev/peps/pep-0569/#id6" rel="noopener ugc nofollow" target="_blank">https://www.python.org/dev/peps/pep-0569/#id6</a></li><li id="efe8" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated"><a class="ae ly" href="https://docs.python.org/3.8/whatsnew/3.8.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3.8/whatsnew/3.8.html</a></li><li id="f16b" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated"><a class="ae ly" href="https://www.python.org/dev/peps/pep-0572/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/dev/peps/pep-0572/</a></li><li id="616f" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated"><a class="ae ly" href="https://www.python.org/dev/peps/pep-0013/#electing-the-council" rel="noopener ugc nofollow" target="_blank">https://www . python . org/dev/peps/pep-0013/#选举委员会</a></li><li id="b05a" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated"><a class="ae ly" href="https://docs.python.org/3/glossary.html#keyword-only-parameter" rel="noopener ugc nofollow" target="_blank">https://docs . python . org/3/glossary . html #仅关键字-参数</a></li></ul></div></div>    
</body>
</html>