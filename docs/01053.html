<html>
<head>
<title>Naive Bayes Classifier using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的朴素贝叶斯分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/naive-bayes-classifier-a-beginners-guide-to-master-the-fastest-and-simplest-classification-d6a368e6b737?source=collection_archive---------3-----------------------#2019-09-28">https://medium.com/analytics-vidhya/naive-bayes-classifier-a-beginners-guide-to-master-the-fastest-and-simplest-classification-d6a368e6b737?source=collection_archive---------3-----------------------#2019-09-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="09e2" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">掌握最快最简单分类算法的初学者指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/3efdcea7be8bb4f5f87039e4807c7b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRfAyPq9eJhpEdROB_lIRg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">板球投掷，来源:espncricinfo.com</figcaption></figure><p id="e783" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi kj translated">我应该先击球还是先投球？嗯...球场似乎潮湿，天气晴朗，让我们先打保龄球。你可能经历过这种情况，你根据一些独立的条件做决定。让我们选择板球的例子，假设你已经赢得了掷硬币，现在作为队长，你必须决定是先投球还是先击球。你将根据天气、球场条件、湿度、微风等条件做出决定，并假设所有这些条件独立地影响我们决定是先投球还是先击球。如果球场是新鲜的，草较少，天气晴朗，湿度较小，微风缓慢，那么这肯定意味着你应该首先击球，并在板上获得更高的分数。否则，如果球场是湿的，有裂缝，天气阴沉，风很大，那么作为队长，你会去打保龄球。因此，我们做出“天真”的假设，认为所有这些条件都独立影响我们作为船长的决定。这就是人类所做的，现在让我们学习帮助机器以类似方式接近的算法。</p><p id="fd64" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们打破术语<em class="ks">‘朴素贝叶斯分类器’</em>，然后理解它。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kt"><img src="../Images/16beef68faf40f1eedb7c66911bcd0ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*H2YO3OcCCr0VsDGNv3Ssqw.jpeg"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">来源:memes.ucoz.com</figcaption></figure><p id="20f9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">天真是针对我们在算法中计算概率时所做的无知假设。朴素贝叶斯也被称为<em class="ks">白痴</em>贝叶斯，因为每个假设的概率计算都被简化了，使得在真实数据中最不可能的计算变得容易。现在让我们进一步讨论数学术语。</p><p id="b51f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们来理解“贝叶斯”术语，这是解决这个问题的最重要的概率方法。贝叶斯定理提供了一种基于似然、边际和先验概率计算后验概率的方法。我们将进一步理解所有这些术语的含义。给定我们所拥有的可以用作我们关于问题的先验知识的数据，选择最可能的假设的最简单方法之一。贝叶斯定理提供了一种方法，在已知先验知识的情况下，我们可以计算假设的概率。例如在板球的例子中，我们必须计算P(球棒或碗|天气、球场、湿度…..)</p><p id="3213" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在对于公式，我们假设“H”代表假设,“E”代表证据或简单的预测与给定数据。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ku"><img src="../Images/3b3d3857949ba982aac4d611ae7dc37a.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*saXJNgouo6rzGeyQaheq-w.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">贝叶斯定理，来源:swarm-help.zendesk.com</figcaption></figure><ul class=""><li id="35fa" class="kv kw hi jp b jq jr jt ju jw kx ka ky ke kz ki la lb lc ld bi translated"><strong class="jp hj"> P(H|E) </strong>是假设H给定数据E的概率，这叫做后验概率。</li><li id="6185" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki la lb lc ld bi translated"><strong class="jp hj"> P(E|H) </strong>假设假设H为真，数据E的概率。</li><li id="412c" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki la lb lc ld bi translated"><strong class="jp hj"> P(H) </strong>是假设H为真的概率(不考虑数据)。这叫做h的先验概率。</li><li id="eaa2" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki la lb lc ld bi translated"><strong class="jp hj"> P(E) </strong>是数据的概率(不考虑假设)。</li></ul><p id="365b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">并且最终的术语分类器仅仅是模型的离散响应。与我们有连续反应的回归变量相比。最好的例子是情感分析，在这种分析中，我们将文本分为积极、消极或中性等不同的反应。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lj"><img src="../Images/962f31cb0ed0c25e804f43e3eaea79fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*qjlA3rk8yUtixr2j4vbrrg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">来源:pinterest.com</figcaption></figure><p id="8e87" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">总的来说，我们天真地假设所有的预测因子都可以被独立地计算以给出最终的结果，因此我们用Bayes定理独立地计算每个预测因子的假设的后验概率。这一过程进一步有助于实现最终任务，即分类。这是一种监督学习算法。此外，这陈述并解释了术语“朴素贝叶斯分类器”。</p><h1 id="dd2e" class="lk ll hi bd lm ln lo lp lq lr ls lt lu io lv ip lw ir lx is ly iu lz iv ma mb bi translated">算法背后的数学原理:</h1><p id="2c0a" class="pw-post-body-paragraph jn jo hi jp b jq mc ij js jt md im jv jw me jy jz ka mf kc kd ke mg kg kh ki hb bi translated">让我们回到最初的例子来理解朴素贝叶斯背后的计算。</p><p id="efe5" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">比如说，如果板球场是湿的，首先击球的概率是多少？</p><blockquote class="mh mi mj"><p id="b699" class="jn jo ks jp b jq jr ij js jt ju im jv mk jx jy jz ml kb kc kd mm kf kg kh ki hb bi translated">P(先击球|湿)=P(湿|先击球)*P(先击球)/P(湿)</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mn"><img src="../Images/372027f2d1bb3afaa2ee863f44f6a8dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*s6X8OORuE_59oZkun2R1KQ.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">资料组</figcaption></figure><p id="e396" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">上面我有一个天气和相应的目标变量“击球优先？”的训练数据集。现在，我们需要根据天气情况来分类玩家会选择球棒还是碗。让我们按照以下步骤来执行它。</p><ol class=""><li id="e7be" class="kv kw hi jp b jq jr jt ju jw kx ka ky ke kz ki mo lb lc ld bi translated">将数据集转换成频率表。</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mp"><img src="../Images/549bf46fdfec4c518ca6622dc75404ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*5j93dRf8uNikH0zB9CXCUA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">频率表</figcaption></figure><p id="1ad2" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">2.通过查找概率创建一个可能性表。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mq"><img src="../Images/4721b29007d2c68d1178314fe6d3d919.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*ItxX0PZApIXp2Nt1kiKxYA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">可能性表</figcaption></figure><p id="fed2" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">类似地，计算每隔一个预测值的可能性表。</p><p id="422c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">3.现在，使用朴素贝叶斯方程来计算每一类的后验概率。具有最高后验概率的类是预测的结果。</p><p id="f0b9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">所以简单地说，如果我们把它用于天气，</p><blockquote class="mh mi mj"><p id="3ef0" class="jn jo ks jp b jq jr ij js jt ju im jv mk jx jy jz ml kb kc kd mm kf kg kh ki hb bi translated">P(是|晴)= P(晴|是)* P(是)/ P(晴)</p><p id="6d77" class="jn jo ks jp b jq jr ij js jt ju im jv mk jx jy jz ml kb kc kd mm kf kg kh ki hb bi translated">P(晴|是)= 3/10 = 0.3，P(晴)= 5/14 = 0.36，P(是)= 10/14 = 0.64</p><p id="3027" class="jn jo ks jp b jq jr ij js jt ju im jv mk jx jy jz ml kb kc kd mm kf kg kh ki hb bi translated">现在P(是|晴)= 0.33 * 0.64 / 0.36 = 0.60，概率较大。</p></blockquote><p id="9ce8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">因此，如果天气晴朗，队长很可能会选择先击球。</p><p id="03c2" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">因此，如果我们想更多地基于天气、湿度和各种属性进行预测，那么</p><blockquote class="mh mi mj"><p id="6c63" class="jn jo ks jp b jq jr ij js jt ju im jv mk jx jy jz ml kb kc kd mm kf kg kh ki hb bi translated">P(是|天气、螺距、湿度… )=P(是|天气)*P(是|螺距)*P(湿度)……</p></blockquote><p id="bfb2" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">所以只需将每个属性的后验概率相乘，就可以得到最终需要的结果。</p><p id="be43" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">同样，我们也可以使用朴素贝叶斯分类器进行文本分类。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mr"><img src="../Images/0a35a692eb70e1b6a650667fd3c65dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JAr9n0cVtL7yr7o1YnI-iQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">来源:macmilliandictionaryblog.com</figcaption></figure><p id="d6cb" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">自然语言处理和单词标记化是这样做的先决条件。那么进一步的朴素贝叶斯分类器将帮助我们对文本进行分组分类。</p><p id="51e7" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Ex: P(莎士比亚写的|《憎恶》《绝对》《线圈》)</p><p id="5687" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这就是我们要计算的，得到给定文本是莎士比亚写的可能性，因为憎恶，绝对和线圈是莎士比亚最常用的词。</p><h1 id="563d" class="lk ll hi bd lm ln lo lp lq lr ls lt lu io lv ip lw ir lx is ly iu lz iv ma mb bi translated"><strong class="ak">朴素贝叶斯模型的类型:</strong></h1><ol class=""><li id="7506" class="kv kw hi jp b jq mc jt md jw ms ka mt ke mu ki mo lb lc ld bi translated"><strong class="jp hj">高斯模型</strong>:用于正态分布数据的简单分类。</li><li id="726e" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated"><strong class="jp hj">多项式模型</strong>:多用于文本分类问题。在<a class="ae mv" href="https://www.toppr.com/guides/maths/probability/bernoulli-trials-and-binomial-distribution/" rel="noopener ugc nofollow" target="_blank">伯努利试验</a>的帮助下，我们可以找到“一个单词在给定文本中出现的频率”。</li><li id="1e70" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated"><strong class="jp hj">伯努利模型</strong>:如果你的特征向量是二元的，二项式模型是有用的。仅用于两个离散变量。</li></ol><h1 id="1869" class="lk ll hi bd lm ln lo lp lq lr ls lt lu io lv ip lw ir lx is ly iu lz iv ma mb bi translated">为什么要使用朴素贝叶斯分类器？</h1><ol class=""><li id="7f92" class="kv kw hi jp b jq mc jt md jw ms ka mt ke mu ki mo lb lc ld bi translated">轻松快速地预测测试数据集的类别。它在多类预测中也有很好的表现</li><li id="65e5" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">有时比逻辑回归表现更好。使用这两种算法，选择精度最高的算法。</li><li id="98a0" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">更有效地处理有数百个数据点但变量很少的问题。</li><li id="4d2a" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">众所周知，它可以很好地处理连续和离散数据。</li><li id="3ccf" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">如果独立性假设成立，它导致最有效的分类算法。</li></ol><h1 id="a03c" class="lk ll hi bd lm ln lo lp lq lr ls lt lu io lv ip lw ir lx is ly iu lz iv ma mb bi translated">在哪里使用朴素贝叶斯分类器？</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mw"><img src="../Images/6ff9e6f36e389aaa185cc87ba3433374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wpk1ar_xzImsf5oCQ5gucQ.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">来源:blog.malwarebytes.com</figcaption></figure><ol class=""><li id="e208" class="kv kw hi jp b jq jr jt ju jw kx ka ky ke kz ki mo lb lc ld bi translated">文本分类</li><li id="f12f" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">情感分析</li><li id="f173" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">垃圾邮件过滤</li><li id="baaa" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">将新闻分为政治、科学、技术、犯罪等类别。</li><li id="7647" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated">推荐系统</li></ol><p id="3a4b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">还可用于实时预测和多类预测。朴素贝叶斯分类器有着大量的实际应用。</p><p id="44d3" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面是在Scikit-learn的帮助下用Python实现的一个简单的高斯朴素贝叶斯。我们已经用天气和湿度的特征来举例说明击球或保龄球的决定。我们将首先标记这些特征，训练它们，并使用训练好的模型来获得预测结果。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mx my l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">使用sklearn和python的朴素贝叶斯</figcaption></figure><p id="47de" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这只是一个如何实现的例子。当您希望模型更加精确时，请使用大型数据集。</p><h2 id="cc13" class="mz ll hi bd lm na nb nc lq nd ne nf lu jw ng nh lw ka ni nj ly ke nk nl ma nm bi translated">重要参考:</h2><ol class=""><li id="565c" class="kv kw hi jp b jq mc jt md jw ms ka mt ke mu ki mo lb lc ld bi translated"><a class="ae mv" href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/naive_bayes.py" rel="noopener ugc nofollow" target="_blank">带有Scikit-Learn的朴素贝叶斯</a>:带有Scikit-Learn的内置函数高斯朴素贝叶斯的实现。</li><li id="3759" class="kv kw hi jp b jq le jt lf jw lg ka lh ke li ki mo lb lc ld bi translated"><a class="ae mv" href="https://scikit-learn.org/stable/modules/naive_bayes.html" rel="noopener ugc nofollow" target="_blank">朴素贝叶斯文档</a></li></ol><p id="b7d3" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在你可以理解新闻分类的背景，也可以设计新闻分类了。加载你最喜欢的变量很少的庞大数据集，并尝试一下！朴素贝叶斯有多准确？检查一下。从现在开始，你需要的只是练习。</p></div></div>    
</body>
</html>