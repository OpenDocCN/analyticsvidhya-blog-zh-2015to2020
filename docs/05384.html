<html>
<head>
<title>Apache Airflow — Programmatic platform for Data Pipelines and ETL/ELT workflows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache Airflow —数据管道和ETL/ELT工作流的编程平台</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/apache-airflow-programmatic-platform-for-data-pipelines-and-etl-elt-workflows-b9e4d8346541?source=collection_archive---------20-----------------------#2020-04-19">https://medium.com/analytics-vidhya/apache-airflow-programmatic-platform-for-data-pipelines-and-etl-elt-workflows-b9e4d8346541?source=collection_archive---------20-----------------------#2020-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6e8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在当前数据驱动的世界中，数据管道和ETL(提取、转换和加载)工作流在收集和处理来自不同来源的数据方面起着重要作用。许多数据科学家和小公司依赖这些工作流的质量和性能来处理和分析下游的数据，以获得业务洞察力。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3c62b1958b26b708022c7a2d4a3b53d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q5hILy_YJswr02kd2K4x7w.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:Panoply.io</figcaption></figure><p id="5912" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">市场上有许多ETL平台/工具可以帮助更快更容易地构建简单和静态的工作流。尽管ETL平台提供了简单的拖放UI组件来构建工作流，但对于小公司或数据科学家来说，由于成本或限制，总是存在是选择ETL平台还是从头构建工作流的问题。ETL工具的最大限制之一是它们大多是接口驱动的，这使得调试和导航变得困难，并且它们引入了可复制性问题。关于ETL工具的缺点已经说得够多了，我将把探索ETL的优点和缺点留给你，让我们进入主题。</p><h1 id="2716" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">什么是阿帕奇气流？</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/c92cd17b68c33970a1b9581e40df0352.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*rGAJOeEAba5nO6ge-o2MyQ.png"/></div></figure><p id="96bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自网站(【https://airflow.apache.org/】T2):</p><blockquote class="kt ku kv"><p id="92eb" class="if ig kw ih b ii ij ik il im in io ip kx ir is it ky iv iw ix kz iz ja jb jc hb bi translated">Airflow是一个以编程方式创作、调度和监控工作流的平台。</p><p id="b474" class="if ig kw ih b ii ij ik il im in io ip kx ir is it ky iv iw ix kz iz ja jb jc hb bi translated">使用airflow将工作流创作为任务的有向无环图(Dag)。airflow scheduler在遵循指定依赖关系的同时，对一组工作线程执行您的任务。丰富的命令行实用程序使在Dag上执行复杂的手术变得轻而易举。丰富的用户界面使得可视化生产中运行的管道、监控进度以及在需要时解决问题变得容易。</p></blockquote><p id="3699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，借助Airflow，我们可以通过python脚本创建动态工作流，并对其进行调度和监控。Airflow为管理Dag提供了一个不错的UI(除了工作流什么都没有)。让我们看看气流的一些关键方面:</p><ol class=""><li id="7e6b" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">气流是可伸缩的、可扩展的、优雅的，并且具有用于管道的动态配置</li><li id="e80a" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">它是开源的，完全用Python编写</li><li id="1a59" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">它有大量的集成，包括谷歌云平台，亚马逊网络服务，微软Azure</li></ol><h1 id="edb9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">气流是如何工作的？</h1><p id="5305" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">气流构建的基本概念是有向无环图(DAG)。在计算机科学和数学中，DAG是一个有向图，没有连接其他边的圈。这意味着不可能从一条边开始遍历整个图。在Airflow的DAG中，每个节点都是一个代表bash命令或python函数的任务。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/0c869bd8e2195dcd5e39cae5c8636221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TcW6YGhyNEE46_b8JK7UgA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">样本气流DAG</figcaption></figure><p id="294c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DAG开始于“run_this_first”节点，结束于“join”节点。任务“加入”依赖于所有上游任务，即只有在执行了“加入”任务之前的所有节点/任务后，才会执行“加入”任务。这使得气流工作流程更加高效和可靠。</p><p id="26bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基本概念:</strong></p><p id="3c02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> DAG </strong> —任务/使用的图形。</p><p id="69c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">操作符</strong> —操作符是指转换步骤，例如bash_operator，python_operator。这些操作符基本上是我们任务的组成部分。</p><p id="8a0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">传感器</strong> —这种类型的操作员执行频率/超时轮询功能，以监控工作流程</p><p id="af18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">执行器</strong> —这类操作员执行触发操作，例如HiveOperator，Pig Operator。</p><p id="99b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">任务</strong> —任务是DAG的主要实体。这里的主要内容是在某个时间点运行的任务实例。</p><p id="ef14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> HOOK </strong> —被认为是JDBC、HTTP等外部系统的接口。</p><p id="9ba5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Airflow非常简单，创建DAG只需要Python编程知识。如果按照DAG参数中的指定自动失败，Airflow支持任务的重新执行。</p><h1 id="8f43" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">简单的使用案例</h1><p id="a452" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">让我们看一个简单的气流用例:</p><p id="84f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">问题陈述:</strong>我们需要从新闻API源获取数据，并执行某些NLP转换，然后将其存储在数据库中以供进一步分析。</p><p id="003d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案:</strong></p><ol class=""><li id="924c" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">安装并初始化气流网络服务器和调度程序</li><li id="de33" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">编写三个python函数，一个用于连接和从新闻API源获取数据，第二个用于转换获取的数据，第三个用于将转换后的数据存储在数据库中</li><li id="9bc2" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">导入气流并使用您自己的计划间隔和参数创建DAG</li><li id="b17a" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">使用Python_Operator和三个Python函数创建任务</li><li id="55ec" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">创建任务相关性并执行文件</li><li id="6208" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">转到web用户界面并启动DAG</li></ol><p id="c049" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就这样，你的狗就可以跑了。</p><h1 id="191c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">为什么阿帕奇气流很重要？</h1><p id="63c5" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">表明阿帕奇气流重要性的主要原因是</p><ul class=""><li id="84a5" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lu lg lh li bi translated">最重要的优势是，它提供了调度分析工作流和数据仓库的能力，也可以在单个平台下进行管理，以便访问一个全面的视图来检查状态。</li><li id="c365" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lu lg lh li bi translated">执行的日志条目集中在一个位置。</li><li id="9019" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lu lg lh li bi translated">气流的使用也很重要，因为它具有自动化工作流开发的优势，因为它有一种将工作流配置为代码的方法。</li><li id="ee2d" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lu lg lh li bi translated">在Dag中，它提供了依赖关系的清晰描述。</li><li id="1db4" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lu lg lh li bi translated">生成元数据的能力为重新生成独特的上传提供了优势。</li></ul><p id="e8a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Apache Airflow支持与PySpark的集成，这使得它也可以用于大数据管道。参考下图</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/c67f3e442f5e648612008c927a722176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmdTUGbpgaxgg9R2EXqiZw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:<a class="ae ks" rel="noopener" href="/@natekupp/getting-started-the-3-stages-of-data-infrastructure-556dac82e825">https://medium . com/@ natekupp/getting-started-the-3-stages-of-data-infra structure-556 DAC 82 e 825</a></figcaption></figure><h1 id="14d5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="b89f" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">在这篇文章中，我讨论了什么是airflow，它的优点，以及Apache Airflow如何帮助在Python中以编程方式构建快速、动态而高效的ETL工作流。在我的下一篇关于Airflow的文章中，我将举一个ETL工作流的真实例子，向您展示如何设置Airflow并在Airflow中开发工作流。</p></div></div>    
</body>
</html>