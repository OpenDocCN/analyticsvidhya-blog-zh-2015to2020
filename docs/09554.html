<html>
<head>
<title>Data Cleansing using Pandas in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 中的 Pandas 进行数据清理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-cleansing-using-pandas-in-python-33204242d3b2?source=collection_archive---------10-----------------------#2020-09-10">https://medium.com/analytics-vidhya/data-cleansing-using-pandas-in-python-33204242d3b2?source=collection_archive---------10-----------------------#2020-09-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/7649cef19cb49f12f1dbd1c77904701a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3mLoYhJiJTNS44X8LpOqUg.jpeg"/></div></figure><p id="3f48" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本帖中，我们将使用 Pandas 库和 Python 来演示如何清理真实世界的数据，以便它可以用于任何处理任务。坦白地说，从真实世界的传感器获得的大多数数据都包含大量垃圾和空值。数据分析或机器学习算法通常不支持数据格式。因此，数据清理几乎总是大多数数据分析/ML/AI 工作的第一步。</p><p id="505f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Pandas 是一个非常强大的数据处理库。早些时候，我是一个巨大的 Matlab 迷，并认为在数据分析方面没有 Matlab 的对手。但是自从我搬到了熊猫(实际上是 Python)，我讨厌再回到 Matlab。</p><p id="fa91" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">不管怎样，现在先把 Matlab 放在一边，让我们从熊猫开始。</p><p id="eeb1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我将使用的数据是真实世界的通话数据记录(CDR ),由意大利电信在 2014 年大数据竞赛中公布。你可以在这里  <em class="jl"> </em>找到并下载完整的数据集<a class="ae jk" href="https://dandelion.eu/datagems/SpazioDati/milano-grid/resource/" rel="noopener ugc nofollow" target="_blank"> <em class="jl">(我要警告的是，这是一个非常庞大的数据集。每个文件超过 300 MB，总共有 62 个文件—每天一个文件)。我只分享一个文件，我将通过我的 google drive 在这个博客中使用。点击<a class="ae jk" href="https://drive.google.com/file/d/1z_SM5wt9XavI7fSNar9wKnDvhXwD1fDC/view?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <em class="jl">此处</em> </a>获取该文件。</em></a></p><p id="039c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该数据集捕捉了意大利电信用户在意大利米兰市整整两个月的通话、短信和互联网使用情况。每一天都被记录为一个文件。然而，对于这个博客，我将只使用这个 CDR 中一天的数据(即单个文件)。</p><p id="eac2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们首先从导入所有必需的包开始</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="4f6e" class="jv jw hi jr b fi jx jy l jz ka">import pandas as pd<br/>from pandas import read_csv</span></pre><p id="0240" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在导入所有必要的包之后，让我们开始真正的工作。Pandas 提供了一个函数<strong class="io hj"> read_csv(…) </strong>(我们之前已经导入了)来读取不同种类的数据文件。在我们的文件中，数据以制表符分隔的格式存储。因此我们将使用<strong class="io hj">&lt;delimiter = ' \t '&gt;</strong>参数来指定在读取过程中每当文件中存在一个制表符(\ t)时就要中断。</p><p id="656e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我总是不喜欢弄乱存储数据的实际变量。因此，我们将在另一个数据帧中克隆数据，并将其命名为<strong class="io hj"> df </strong>。命令<strong class="io hj"> df.head() </strong>将显示数据集的前几个成员。</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="4456" class="jv jw hi jr b fi jx jy l jz ka">dataset = pd.read_csv('D:/Research/dataset/sms-call-internet-mi-2013-11-1.txt', delimiter='\t')<br/>df = dataset<br/>df.head()</span></pre><p id="5bc7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意数据集是原始格式的(见下面的图 1)。甚至没有提到列的名称。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/2bb96611f0820a402bdacaece68a7f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*2rVir6u6aYtvQ7QJoHsIbQ.png"/></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">图 1:来自意大利电信的原始数据</figcaption></figure><p id="d132" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，我们将使用<strong class="io hj"> df.columns </strong>给所有的列起一个合适的名字。在这种特殊情况下，数据集提供者(即意大利电信)已经给出了关于列的所有信息。因此，我们将使用这些信息来适当地命名每一列。</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="ee5a" class="jv jw hi jr b fi jx jy l jz ka">df.columns = ['Grid ID', 'Time Stamp','Caller ID','SMS in', <br/>             'SMS out','Call in','Call out','Internet']</span></pre><h1 id="2ff5" class="kg jw hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">数据清理</h1><p id="731c" class="pw-post-body-paragraph im in hi io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">当处理真实世界的数据时，数据清理是非常关键的并且几乎总是需要的(如前所述)步骤，因为捕获的数据可能有许多差异、缺失值等。</p><p id="62fc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">例如，请注意，在上面的图 1 中，原始数据集中有几个 NaN 值。这些值表明数据采集传感器由于各种原因无法获得任何值。我们将用零(0)替换所有 NaN 值。为此，熊猫提供了一个简单的功能<strong class="io hj">【菲尔娜(…) </strong>。我们将用这个函数将 NaN 替换为零(0)。另外，注意使用<strong class="io hj"> inplace = True </strong>等同于声明<strong class="io hj"> df = df.fillna(0) </strong>。这是 pandas 的另一个强大特性，它允许更简洁的代码版本。</p><p id="a88f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">每个记录条目的时间单位以毫秒为单位。因此，我们也将时间单位改为分钟。最后，我们将在下面的图 2 中显示格式化的数据。</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="bc6e" class="jv jw hi jr b fi jx jy l jz ka"># Fill all the NaN values with 0<br/>df.fillna(0,inplace = True)<br/><br/>#The time is in milli-seconds. We will change it to minutes.<br/>df['Time Stamp'] = df['Time Stamp']/(1000*60)<br/><br/>df.head()</span></pre><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es li"><img src="../Images/a20a7931c5075f6e693e7a77135e859d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*CAgKw-0lOU9__ynj3QLMQA.png"/></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">清洗后的 CDR</figcaption></figure><p id="c3ab" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意，所有 NaN 值都被替换为 0。时间戳也改成了分钟。</p><p id="e34f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，我们将显示互联网活动，以观察我们有什么样的数据(您也可以玩玩其他活动，如呼入、呼出等)。你也可以尝试插入其他活动。</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="3788" class="jv jw hi jr b fi jx jy l jz ka">%matplotlib inline<br/>import matplotlib<br/>import matplotlib.pyplot as plt<br/>plt.plot(df['Internet'])<br/>plt.grid()<br/>plt.xlabel('Time (in 10-minute interval)', fontsize =12)<br/>plt.ylabel('Activity', fontsize = 12)</span></pre><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="ab fe cl lj"><img src="../Images/1e17b4c4ec289c0d669c1c65bca89b3e.png" data-original-src="https://miro.medium.com/v2/format:webp/0*MZiKTxxym-MA_8vj.png"/></div></figure><p id="de9c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">本周我们将在此停留。下周，我们将使用这个更干净的数据版本，使用深度神经网络(递归神经网络)来预测细胞流量。在那之前…</p><p id="63a8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">完整的代码呈现在<a class="ae jk" href="https://github.com/SRJaffry/Data_cleansing" rel="noopener ugc nofollow" target="_blank"> <em class="jl">这里</em> </a>。</p></div></div>    
</body>
</html>