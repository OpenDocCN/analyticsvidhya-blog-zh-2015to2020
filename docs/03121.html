<html>
<head>
<title>Upload a Pandas DataFrame to MongoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">上传熊猫数据到MongoDB</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-upload-a-pandas-dataframe-to-mongodb-ffa18c0953c1?source=collection_archive---------0-----------------------#2020-01-17">https://medium.com/analytics-vidhya/how-to-upload-a-pandas-dataframe-to-mongodb-ffa18c0953c1?source=collection_archive---------0-----------------------#2020-01-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ea99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">快速简单的指南</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/0ae3f99475cd47abf6c20625532fd6f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*mJyB63SvhyQ9vuaNA5fLOg.png"/></div></figure><p id="5423" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您已经设置了一个MongoDB帐户和集群，我建议您跳到“将数据帧上传到MongoDB”一节。如果您不确定如何连接和设置数据库，您可能还想看看前面的部分。</p><h1 id="6d9a" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">设置您的MongoDB和集群</h1><p id="7a4b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">您需要做的第一件事是创建一个MongoDB帐户。你可以在这里这样做:R <a class="ae kp" href="https://cloud.mongodb.com/user#/atlas/register/accountProfile" rel="noopener ugc nofollow" target="_blank">注册MongoDB </a></p><p id="d61f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注册后，应该会提示您创建一个集群。假设你不想付费，你可以在“<strong class="ih hj">启动集群</strong>选项中选择创建集群。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/f012ce2420e521af13a9c44d97de8b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfFKO9MtaaisWvwZLMw0zQ.png"/></div></div></figure><p id="cfb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您需要选择一个提供商和一个地区。在这种情况下，最简单的方法就是选择AWS并选择离您最近的位置。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kv"><img src="../Images/56ffee83b6b78ccad91409122d08aa97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gGh6UbTihQPc_VcqDdITpA.png"/></div></div></figure><p id="296a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在同一页面上，如果您向下滚动，您将看到您能够升级存储和备份选项，以及命名您的群集。我将把它命名为“集群测试”从这些选项中进行选择后，点击站点右侧的“<strong class="ih hj">创建集群</strong>按钮。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kw"><img src="../Images/0831206edadec232cf089930f0cb4550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QlhR6HJMZ5EwaU83gRpbMQ.png"/></div></div></figure><p id="69dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您应该看到集群正在创建。这可能需要3分钟，所以在你等待的时候喝点咖啡吧！加载完成后，点击“<strong class="ih hj">连接</strong>”按钮。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kx"><img src="../Images/ab80ca58cdfd3f01fc046d99d31e05f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JsIiZaK_vMSWDL0xB2dyyg.png"/></div></div></figure><h1 id="1228" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">设置到集群的连接并创建数据库</h1><p id="2104" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">接下来，将提示您设置连接安全性。根据我的经验，创建一个Mongodb用户比将您的IP地址列入白名单更容易。这样你就可以从任何一台计算机上访问数据库。为此，创建一个您可以记住的用户名和密码。然后，点击<strong class="ih hj">“创建MongoDB用户”</strong>和<strong class="ih hj">选择连接方式</strong>按钮。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ky"><img src="../Images/390ca9f5d699f3b2174fe4182ff84d65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*AQhexWYH3qh5kAHsI-NO2g.png"/></div></figure><p id="800e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，你可以选择如何联系。由于我们使用python中的pandas数据框架，我们将选择“<strong class="ih hj">连接您的应用程序。</strong>从驱动列表中选择<strong class="ih hj">Python</strong>&amp;’<strong class="ih hj">3.6或更高版本</strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kz"><img src="../Images/3e32a4acf3af1dafb6d512074e3ceb04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*zzBLWjSa7SHM_6KuybyphQ.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es la"><img src="../Images/cf17c71f2faf35d293131872ccb2e506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*gx-tVL6j2hLh3p5oIAFoaA.png"/></div></figure><p id="4a54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击“复制”您刚刚保存的字符串将用于连接到数据库。接下来，您需要点击“<strong class="ih hj">收藏库</strong>”选项卡，然后点击“<strong class="ih hj">添加我自己的数据</strong>”按钮。然后，填写您想要的数据库名称和集合名称，并单击“<strong class="ih hj">创建</strong>按钮。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lb"><img src="../Images/2b67fc4c10a293a0c25344f1979479eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vr2Ru8zTP6SjYRBGXztW2A.png"/></div></div></figure><h1 id="37a3" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">将熊猫数据帧上传到MongoDB</h1><p id="caff" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我推荐使用python笔记本，但是您也可以轻松地使用普通的。py文件类型。你需要在所有标有&lt;<caps>的区域填入你的相关信息。函数“df_to_mongo”按行将数据帧格式化成一个类似json的对象，并返回每行的列表。</caps></p><pre class="jf jg jh ji fd lc ld le lf aw lg bi"><span id="5427" class="lh jn hi ld b fi li lj l lk ll"># Imports<br/>import pandas as pd<br/>from pymongo import MongoClient</span><span id="78df" class="lh jn hi ld b fi lm lj l lk ll"># Load csv dataset<br/>data = pd.read_csv('&lt;&lt;INSERT NAME OF DATASET&gt;&gt;.csv')</span><span id="cf12" class="lh jn hi ld b fi lm lj l lk ll"># Connect to MongoDB<br/>client =  MongoClient("mongodb+srv://&lt;&lt;YOUR USERNAME&gt;&gt;:&lt;&lt;PASSWORD&gt;&gt;<a class="ae kp" href="http://twitter.com/clustertest" rel="noopener ugc nofollow" target="_blank">@clustertest</a>-icsum.mongodb.net/test?retryWrites=true&amp;w=majority")</span><span id="62a4" class="lh jn hi ld b fi lm lj l lk ll">db = client['&lt;&lt;INSERT NAME OF DATABASE&gt;&gt;']<br/>collection = db['&lt;&lt;INSERT NAME OF COLLECTION&gt;&gt;']</span><span id="9ef5" class="lh jn hi ld b fi lm lj l lk ll">data.reset_index(inplace=True)<br/>data_dict = data.to_dict("records")</span><span id="3b55" class="lh jn hi ld b fi lm lj l lk ll"># Insert collection<br/>collection.insert_many(data_dict)</span></pre><p id="344d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">祝贺你！</strong>如果您用自己的信息替换了&lt; &lt; &gt; &gt;并运行了这段代码，那么您应该会看到来自pandas dataframe的数据出现在您在MongoDB上设置的数据库的collections选项卡中。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ln"><img src="../Images/04621f8fc04c14da0879cb651fc93590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yuZAjubwoepvTa6PGoF2PQ.png"/></div></div></figure><p id="40c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，您甚至可以通过列名和该列中的值来过滤数据库中的结果。需要注意的一点是，上传到MongoDB的dataframe不再是表，因为MongoDB是非关系数据库。</p><p id="dd1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">这是我写的为数不多的文章之一，所以如果我有任何错误，请原谅我。我希望这篇文章对你有所帮助，并非常感谢你的任何批评或问题。</em></p></div></div>    
</body>
</html>