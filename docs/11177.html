<html>
<head>
<title>Silver Medal Solution to OSIC Pulmonary Fibrosis Progression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">OSIC肺纤维化进展银牌解决方案</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/silver-medal-solution-to-osic-pulmonary-fibrosis-progression-99017ee24641?source=collection_archive---------8-----------------------#2020-11-21">https://medium.com/analytics-vidhya/silver-medal-solution-to-osic-pulmonary-fibrosis-progression-99017ee24641?source=collection_archive---------8-----------------------#2020-11-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2646d4fa4ffa05aaf72a2faf1ed7921a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4u33qbgpLy2swEbbuLaUA.png"/></div></div></figure><h1 id="fa20" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">简介:</strong></h1><p id="0612" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">首先，我要感谢<a class="ae km" href="https://www.kaggle.com/c/osic-pulmonary-fibrosis-progression/overview" rel="noopener ugc nofollow" target="_blank">卡格尔和OSIC </a>举办这次比赛。我还要感谢我的队友<a class="ae km" href="https://www.kaggle.com/jagadish13" rel="noopener ugc nofollow" target="_blank">贾加迪什</a>和<a class="ae km" href="https://www.kaggle.com/trooperog" rel="noopener ugc nofollow" target="_blank">舒巴姆</a>。在这场比赛中，我们被要求根据患者肺部的ct扫描和肺活量计的输出来预测患者肺功能下降的严重程度，肺活量计测量吸入和呼出的空气量，并且还提供表格数据作为参赛者的输入，表格数据包括基线FVC(用力肺活量系数)、周数、年龄、性别和百分比。挑战在于使用机器学习技术，以影像、元数据和基线FVC作为输入进行预测。这更像是一场表格数据的竞争，但使用CT扫描会带来推动，同时当它被赋予比表格数据更高的优先级时，它会导致排行榜的急剧下降。在这场比赛中，我意识到这是一场回归和分类的比赛。此外，公开排行榜的分数仅基于15%的测试数据，当私人分数公布时，我们看到了巨大的排行榜变动。但是我们从动荡中幸存了下来，因为我们选择了验证分数更高的模型。因此，我们最终的解决方案是efficient-net-b5(在CT扫描上训练)、elastic-net(在表格数据上训练)和quantile-regression-model(在表格数据上训练)的集成。</p><h1 id="5ac2" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">型号:</strong></h1><p id="e107" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们最终的effnet模型是有效的-b5-模型用CT扫描训练，训练是模型-&gt; globalaverageopooling-&gt;添加高斯噪声-&gt; Dropout-&gt; Dense with Adam Optimizer。这样就输出了斜率和初始FVC(用力肺活量),有了这个斜率，我们就可以根据初始FVC计算出随后几周的FVC。我们对这个模型进行了50个时期的训练，得到的CV值(平均绝对误差)为3.47718631997。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/760e732c90a0b25d04fdcd4361281f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*AbqKdJbOrPIFzbVTVjcikA.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">eff net-b5-模型</figcaption></figure><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/d74f30b1d5c2da925921f3e4f951e324.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*O4Tf2R6l91BdTdxe6U2uJw.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">肺部图像样本。</figcaption></figure><p id="4d50" class="pw-post-body-paragraph jo jp hi jq b jr kx jt ju jv ky jx jy jz kz kb kc kd la kf kg kh lb kj kk kl hb bi translated">上面显示的肺图像是一个样本肺图像，作为我们模型的输入。</p><h1 id="82fd" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">竞争指标:</strong></h1><p id="767a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">对数似然的一个修改版本被作为竞争度量给出。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/0bf2acae08ed5bfb64028a7825e8c3c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*XuArAAkxuSaIO-A9MMYbbA.png"/></div></figure><p id="23f9" class="pw-post-body-paragraph jo jp hi jq b jr kx jt ju jv ky jx jy jz kz kb kc kd la kf kg kh lb kj kk kl hb bi translated">对于每个真实的FVC测量，竞争者被要求预测FVC和置信度(标准差<em class="ld"> σ </em>)。误差的阈值为1000毫升，以避免较大的误差对结果造成不利影响，而置信值被限制在70毫升，以反映FVC的近似测量不确定性。通过对患者在所有测试集中最后3周获得的指标进行平均来计算最终得分。下面给出了我的竞争指标的python实现。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/133293fab31736b7f944329c4cc8c9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lal2fp8bup-bzsjgzA8cBw.png"/></div></div></figure><h1 id="8ceb" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">训练:</strong></h1><p id="0bc2" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">这是使用以下参数训练的:</p><ul class=""><li id="ad18" class="lf lg hi jq b jr kx jv ky jz lh kd li kh lj kl lk ll lm ln bi translated">Adam优化器，带有减少平台调度程序</li><li id="9019" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">用0.003的LR训练50个时期和5个折叠</li><li id="985e" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">effnet-model的批量大小为4</li><li id="5ff6" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">接下来，我们使用新的分位数损失对表格数据进行分位数回归:</li></ul><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/e9b0d590453083c4cc4b5c398c05f9f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3N_Cr2RuCBht0pAqlq9eHg.png"/></div></div></figure><ul class=""><li id="195c" class="lf lg hi jq b jr kx jv ky jz lh kd li kh lj kl lk ll lm ln bi translated">为10倍和855个时期训练分位数回归模型。</li><li id="eebe" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">使用Adam Optimizer和0.1的LR进行训练</li><li id="1194" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">接下来，我们对alpha=0.3和l1_ratio=0.8的表格数据使用ElasticNet</li><li id="9ee6" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">我们把这个训练了10次</li><li id="6749" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">接下来，我们对random_state=42的表格数据使用LassoRegressor，我们没有做太多的更改。</li><li id="c527" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">我们把这个训练了10次。</li><li id="4de9" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">无批量累加或混合精度</li><li id="564b" class="lf lg hi jq b jr lo jv lp jz lq kd lr kh ls kl lk ll lm ln bi translated">我们只使用kaggle内核-一个用于训练effnet，另一个用于推断effnet，在线训练和推断剩余的模型。</li></ul><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/3676825f9da1af62d1b2f70c89467293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAacqMfj1HBz0frqLUDSaA.png"/></div></div></figure><h1 id="526f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">组装:</strong></h1><p id="c802" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们做了加权平均，权重是使用<strong class="jq hj"> scipy的优化</strong>和<strong class="jq hj">最小化</strong>函数计算的。</p><h1 id="d3da" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">最终提交:</strong></h1><p id="fbb0" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我最后提交的是上述三个模型的合集。然而，我们发现elastic-net得分很高，但我们没有选择它作为我们的最终提交，否则我们会在排行榜上上升一些。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/ef94ceee1eaba8d5c8a2df867bb52191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZp2aqP1J9OSD84SzYcccA.png"/></div></div></figure><p id="8639" class="pw-post-body-paragraph jo jp hi jq b jr kx jt ju jv ky jx jy jz kz kb kc kd la kf kg kh lb kj kk kl hb bi translated">这是我在Kaggle上的第一枚银牌，我真的很高兴。试图下次获得金牌。这真的是一场很好的比赛，我们明白不尊重CV而提高公众lb分数是不好的，正如你从上面的分数中所看到的。</p><p id="7156" class="pw-post-body-paragraph jo jp hi jq b jr kx jt ju jv ky jx jy jz kz kb kc kd la kf kg kh lb kj kk kl hb bi translated">我已经附上我的github回购包含代码。</p><p id="7d18" class="pw-post-body-paragraph jo jp hi jq b jr kx jt ju jv ky jx jy jz kz kb kc kd la kf kg kh lb kj kk kl hb bi translated"><a class="ae km" href="https://github.com/vineeth-raj/OSIC-Pulmonary-Fibrosis-Progression" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> Github回购</strong> </a></p></div></div>    
</body>
</html>