<html>
<head>
<title>Integrating your RASA chat bot with Slack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">整合你的RASA聊天机器人和Slack</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/integrating-your-rasa-chat-bot-with-slack-c18bffc6018b?source=collection_archive---------3-----------------------#2020-04-10">https://medium.com/analytics-vidhya/integrating-your-rasa-chat-bot-with-slack-c18bffc6018b?source=collection_archive---------3-----------------------#2020-04-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7d9d06da82fd369f0df8be7e6049d4cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hh9oMR7fN3pL_f5K5xUAwQ.png"/></div></div></figure><p id="3ff1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">嗯，我最近使用RASA框架构建了我的第一个对话聊天机器人，并开始探索将我的聊天机器人与一些标准的可用交互工具集成的方法。</p><p id="8863" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我发现slack是可用的最佳选项之一，但我很难将RASA与Slack整合，因为我在网上找到的大多数帮助文章都不是最新的。因此，我想到写这篇文章来写下做上述工作所需的步骤，以便它可以帮助像我一样受困于这项任务的其他开发人员。</p><p id="61f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，集成中涉及到许多简单的步骤，我需要你耐心地阅读这篇文章。我会尽量保持文章的简洁，不遗漏任何关键步骤，我保证如果你遵循这些步骤，你会有一个适合自己的slack bot。</p><blockquote class="jp jq jr"><p id="aaac" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">在继续之前，看看RASA bot与Slack集成后的样子可能是个好主意。我制作了一个简单的机器人，用于了解我的国家(印度)任何特定地区的冠状病毒数字。</p></blockquote><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es jv"><img src="../Images/8e9ec1da3b30942698830d8d05ab0eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*0PsFouNNE_vSX29xBc2lHQ.gif"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">机器人在空闲时与用户交互</figcaption></figure><h1 id="ade9" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">这篇文章是写给谁的？</h1><p id="4687" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">任何已经<em class="jo">开发了RASA聊天机器人的人都在寻找将其与Slack整合的方法。</em></p><h1 id="6960" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><em class="lh">先决条件:</em></h1><blockquote class="jp jq jr"><p id="db4b" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">1.在你的本地机器上一个完全工作的RASA聊天机器人。(在尝试集成之前，请确保您已经在本地系统上全面测试了bot。)</p><p id="46fc" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">2.Ngrok软件，用于在本地RASA bot和Slack之间创建隧道，以便通过安全链接交换消息。你可以从<a class="ae li" href="https://ngrok.com/download" rel="noopener ugc nofollow" target="_blank">这里</a>下载ngrok软件。继续在您的系统上安装它。</p><p id="8238" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">3.互联网连接正常。</p></blockquote><p id="11df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">仅此而已。有了这三件重要的事情，你就可以直接开始下一步了。</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><h1 id="dc29" class="ke kf hi bd kg kh lq kj kk kl lr kn ko kp ls kr ks kt lt kv kw kx lu kz la lb bi translated">步骤:</h1><ol class=""><li id="4075" class="lv lw hi is b it lc ix ld jb lx jf ly jj lz jn ma mb mc md bi translated"><em class="jo">创建松弛应用</em></li></ol><p id="e23b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在创建slack <em class="jo"> app </em>之前，您需要使用您的电子邮件id <a class="ae li" href="https://slack.com/create#email" rel="noopener ugc nofollow" target="_blank">在这里</a>创建一个slack <em class="jo"> workplace </em>。创建工作区后，您可以在该工作区内从<a class="ae li" href="https://api.slack.com/apps" rel="noopener ugc nofollow" target="_blank">这里</a>快速创建一个新应用。</p><p id="2c35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您创建了应用程序，您将被引导至<em class="jo">基本信息</em>部分，您应该向下滚动以到达<em class="jo">显示信息</em>。在这里，您可以选择为您的机器人填充名称、描述、照片和背景颜色。请注意，所有这些属性都是可选的，但我建议您添加这些属性，以使您的机器人看起来直观。</p><p id="4c6c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">填写完上述属性后，<em class="jo">保存更改</em>选项应被激活。您应该单击它来确认更改。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b179c74ff38fffb14dad1285556a3a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*B7QLyeQ3fY09Nu5AtKR9kg.gif"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">显示信息</figcaption></figure><p id="e713" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.<em class="jo">您的机器人的授权和许可</em></p><p id="5c05" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">填写完<em class="jo">基本信息</em>部分后，您应该为您的机器人添加权限，这样它就可以与任何想要与您的机器人互动的人一起读写文本消息。</p><p id="1aed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要添加权限，导航到页面左侧菜单上的<em class="jo"> OAuth &amp;权限</em>选项卡，并向下滚动到<em class="jo">范围</em>部分。</p><p id="0cf4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将<strong class="is hj"> chat:write、im:read、im:write、im:history </strong>和<strong class="is hj"> mpim:history </strong>从下拉列表添加到<em class="jo"> Bot令牌范围。</em>添加后应该类似下图。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/eda989a256d152d3a06f03af39beb4be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Y95FKZXwMEVpN_nqIUGZQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">Bot令牌范围</figcaption></figure><p id="88fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，向上滚动并点击<em class="jo">安装应用</em>选项，以这些权限在slack上安装应用。将出现一个弹出窗口，通知您的机器人正在请求您的工作空间的权限。继续并点击允许。</p><p id="c52c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在安装了具有权限的应用程序后，您将获得<em class="jo">密钥</em>来连接您的slack bot和RASA bot。该密钥以<strong class="is hj"> xoxb- </strong>开头，被称为<strong class="is hj"> Bot用户OAuth访问令牌</strong>，在<em class="jo"> OAuth &amp;权限</em>部分下可见。该令牌看起来像下面这样。(出于显而易见的原因，我故意隐藏了我的令牌。)</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/94624e6f2588120a55387f1aeeada7ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WyNVGxWAatkywQ4ia980Zg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">Bot用户OAuth访问令牌</figcaption></figure><p id="f723" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.<em class="jo">设置凭证. yml页面</em></p><p id="77c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是复制上述bot令牌并粘贴到RASA项目的credentials.yml页面中。注意，在<em class="jo"> credentials.yml </em>中已经有一个关于slack的注释部分。只需取消对该部分的注释，并添加令牌作为参数<em class="jo"> slack_token </em>的值。保持<em class="jo">松弛通道</em>参数为空。</p><p id="714d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作为参考，在此阶段，您的credentials.yml文件应该如下所示:</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/6dca1096841658a8816a7e3e71a99a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*57lET60kKqFilF7AcqwddA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">credentials.yml</figcaption></figure><p id="e5a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.<em class="jo">运行动作、ngrok和shell的脚本。</em></p><p id="9c0c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是倒数第二步，您需要运行以下脚本:</p><p id="1751" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">a.运行操作服务器</p><p id="828b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在运行动作脚本之前，确保取消注释项目的<em class="jo"> endpoints.yml </em>页面中的action_endpoint标签。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/4a79d4feb148aade82bbfbcaabf18859.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*mZ4Bj_fayxHHT7_7WqhKsA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">endpoint.yml</figcaption></figure><p id="ee01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，使用anaconda提示符，使用以下命令在本地机器上启动RASA操作服务器。(确保您在RASA项目目录中)。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/5528b7d02a309c5f24fa665f427940b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uqad7N6MgTT_tPAIODJ5Ng.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">正在启动操作服务器</figcaption></figure><p id="4dad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">b.运行RASA shell</p><p id="9591" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一个关键步骤是从anaconda提示符启动RASA shell。我已经包含了许多用于调试的可选参数，您可以删除其中的一些参数。不用说，在anaconda提示符下执行下面的命令时，您需要位于您的RASA项目目录中。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/5d33a3c6d2a14458fe22685d415130c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*8IZYQ3FD9QiA7Xdngl_0EA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">RASA shell启动脚本</figcaption></figure><p id="2197" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">c.在本地主机的5002端口上启动ngrok</p><p id="c7c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一个作业是通过打开命令提示符并键入命令<strong class="is hj"> ngrok http 5002，在端口5002上启动ngrok。</strong></p><p id="4943" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">成功执行后，您应该会看到类似下面的内容:</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/c2d2fa845652ebbc9210670234428503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6yLGHLWgeoFbahHrCYBCcQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">ngrok开始</figcaption></figure><p id="032e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图中突出显示的文本(URL)是公共服务器，slack将使用它与运行在5002上的localhost进行对话。复制URL并追加<strong class="is hj"> webhooks/slack/webhook </strong>得到如下内容:</p><p id="339d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">https://e8def6a6.ngrok.io/webhooks/slack/webhook<a class="ae li" href="https://e8def6a6.ngrok.io/webhooks/slack/webhook" rel="noopener ugc nofollow" target="_blank"/></p><p id="1f95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，以上网址因人而异，您应该使用自己的ngrok网址进行整合。</p><p id="52dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我知道有很多工作要做，但请耐心等待，因为我们几乎已经完成了。</p><p id="5fe4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.<em class="jo">松弛状态下的最终配置</em></p><p id="fc32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">祝贺你完成了整合的最后一步！最后一圈，我们结束了。</p><p id="dfcf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在此步骤中，您需要首先从左侧菜单选项转到<em class="jo">事件订阅</em>部分，然后切换页面上的<em class="jo">启用事件</em>开关以确保其打开。</p><p id="9d50" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启用事件，显示您需要粘贴上面复制的ngrok URL的<em class="jo">请求URL </em>部分。如果您严格遵循了上述所有步骤，您将获得针对您的请求URL部分的“<strong class="is hj">验证</strong>备注”奖励。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/c108d4773835c519557eaaf266609b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*GQ2WaTi7AZl0hcLL8gozug.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">事件订阅</figcaption></figure><p id="5643" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在同一个页面中，进入<em class="jo">订阅bot事件</em>，添加以下2个事件:<strong class="is hj"> message.im </strong>和<strong class="is hj"> message.mpim </strong>。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/2a6ebf19ff7557744f3d22988c672137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PdlT9EAvisErpKJJprQY0w.png"/></div></div></figure><p id="f50e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">添加这些事件将提示您保存更改并重新安装应用程序。继续重新安装应用程序，就是这样！</p><p id="b6bc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你的机器人现在可以使用了！！</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="1c42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要开始和你的机器人聊天，去<a class="ae li" href="https://slack.com/intl/en-in/" rel="noopener ugc nofollow" target="_blank">https://slack.com/intl/en-in/</a>然后点击启动Slack去你的工作区。从左侧菜单中选择您的机器人并开始聊天！:)</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/64539394a3492b7769de93f9bf4ad4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-EI4t5K8is6SYL2ugP0RQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">slack中的聊天机器人</figcaption></figure><p id="326c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望你能够按照上面的步骤将你的RASA机器人与slack集成。如果你需要任何澄清，请在评论中提出你的问题，我会很乐意回复你的！</p><p id="f583" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">干杯！</p></div></div>    
</body>
</html>