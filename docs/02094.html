<html>
<head>
<title>Spark Select and Select-expr Deep Dive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">火花选择和选择表达式深潜</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/spark-select-and-select-expr-deep-dive-d63ef5e04c87?source=collection_archive---------1-----------------------#2019-11-30">https://medium.com/analytics-vidhya/spark-select-and-select-expr-deep-dive-d63ef5e04c87?source=collection_archive---------1-----------------------#2019-11-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="586e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我在<strong class="ih hj"> spark深潜系列</strong>深潜阅读csv之后的第三篇</p><div class="jd je ez fb jf jg"><a rel="noopener follow" target="_blank" href="/@somanathsankaran/spark-csv-deep-dive-part-ii-6d3389904f71"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">火花CSV深潜-第二部分</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">这是我上一篇文章的延续</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">medium.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><p id="c31f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章包括在pyspark中处理选择和过滤表达式</p><ol class=""><li id="8dfb" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">选择and和别名列</li><li id="354d" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">灵活的SelectExpr(用于蜂巢人)</li><li id="77fc" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">通过select利用Python的强大功能(列表理解)</li></ol><p id="e472" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:创建输入数据帧</strong></p><p id="e837" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Spark会话的read csv方法创建df</p><figure class="kl km kn ko fd kp er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kk"><img src="../Images/1c4781c6c0c40c62aff3fb348056f2f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GaoNT1Uq3Dc4EjwWLD9TBg.png"/></div></div></figure><p id="9817" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:在DF中选择</strong></p><p id="bf4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据文件df .选择接受</p><p id="c636" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.字符串列表</p><p id="69ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.列列表</p><p id="7c95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3 .表情</p><p id="e5ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.“*”(星形)</p><p id="16cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。字符串列表:</strong></p><p id="d473" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以将列名作为python字符串对象的列表来传递</p><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es kv"><img src="../Images/d2b2d09c658550e0ceffcc0f76601b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*9jx3cRqDORZ5B644W2Avyw.png"/></div></figure><p id="1a74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。列表栏</strong></p><p id="11ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以从pyspark.sql.functions导入spark列类并传递列列表</p><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es kw"><img src="../Images/1fab6af27c9c31cfd84c6d768addd36e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gWjaAhMw344FxT61b1iflA.png"/></div></figure><p id="8601" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。星号(" *"): </strong></p><p id="7566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">星型语法基本上选择所有类似于sql中select *的列</p><figure class="kl km kn ko fd kp er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kx"><img src="../Images/1686f7fd8904d150d5598591fcd59ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQ-I5U1iZpSR-L6UTTywIQ.png"/></div></div></figure><p id="4b66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:选择别名:</strong></p><p id="3e1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个常见的用例是进行一些操作，并将数据指定为新的数据帧，而不是显示</p><p id="7964" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，我们将fair乘以70，并将其从美元转换为印度卢比，并将列名指定为Fare_INR</p><figure class="kl km kn ko fd kp er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ky"><img src="../Images/19bcf055566d730bc5a90dcf23b46d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18ceY4mgWDKxVWo2Ig0vEA.png"/></div></div></figure><p id="fc4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们选择了所有的列，并添加了一个新列Indian_INR</p><p id="0a49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">灵活选择表达式和别名列</strong></p><p id="2f93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您是sql /Hive用户，我也是，如果您错过了spark中的case语句。</p><p id="d9fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要担心selectExpr会来救援</p><p id="b323" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.SelectExpr对于灵活的sql语句和添加字段非常有用</p><figure class="kl km kn ko fd kp er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kz"><img src="../Images/7e7093f6c8e98db5540a0ce429651d15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*469pBDQJXsc0KVSPxnO5Xg.png"/></div></div></figure><p id="02bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.使用所有内置的配置单元函数</p><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es la"><img src="../Images/ca91af795d606f48e75272a0672d15be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*zgOb1bqQesamNIvj3A9HDw.png"/></div></figure><p id="ab5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.使用selectExpr转换数据类型很容易</p><p id="c085" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们将幸存的dtypes从string转换为int</p><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es lb"><img src="../Images/5850021c9247cd0de1bde2ecccbf3681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*ICcqcfxMDOgGss6FN5SECA.png"/></div></figure><p id="9075" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.用SelectExpr添加常数</p><p id="533e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个常见的用例是添加像current_date这样的常量字段</p><p id="848e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可以用SelectExpr轻松完成</p><figure class="kl km kn ko fd kp er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es lc"><img src="../Images/e14229fafddcdb903cc0099e0848f9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lgqNlhJhCZQzkScBnnuQkg.png"/></div></div></figure><p id="5e8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。使用select </strong>利用Python的强大功能(列表理解)</p><p id="0e89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然选择接受列表，我们可以使用列表理解来选择某些列。假设用户已经给出了一个列列表来操作df</p><p id="79f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用带有if子句的列表理解(或生成器表达式)来选择所需的列</p><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es ld"><img src="../Images/e61e948a4e8b815f4bec206725c3e2d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*G_hN9FxhJDUE_R2k9R9q-w.png"/></div></figure><p id="0e7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Github链接:<a class="ae le" href="https://github.com/SomanathSankaran/spark_medium/tree/master/spark_csv" rel="noopener ugc nofollow" target="_blank">https://github . com/SomanathSankaran/spark _ medium/tree/master/spark _ CSV</a></p><p id="8e89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae le" rel="noopener" href="/@somanathsankaran/spark-group-by-and-filter-deep-dive-5326088dec80"> <strong class="ih hj">下一个教程:https://medium . com/@ somanathsankaran/spark-group-by-and-filter-deep-dive-5326088 dec 80</strong></a></p><p id="f903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lf">请给我发spark中我必须涉及的话题，并给我改进写作的建议:)</em> </strong></p><p id="89e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">学习，也让别人学习！！</strong></p></div></div>    
</body>
</html>