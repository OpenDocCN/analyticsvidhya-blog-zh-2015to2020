<html>
<head>
<title>Use R packages efficiently</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有效地使用R包</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/use-r-packages-efficiently-b3105d5969c1?source=collection_archive---------23-----------------------#2020-03-23">https://medium.com/analytics-vidhya/use-r-packages-efficiently-b3105d5969c1?source=collection_archive---------23-----------------------#2020-03-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e932" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想利用这个机会写一些有用的模式来组织你的R代码。这些可能是高级R用户所熟知的，但在大多数教程中却被忽略了。所以，坐好，放松，享受一些有用的简单的休息技巧吧！</p><h1 id="942c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">1.正在加载R包</h1><p id="a1b2" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在R中加载包最著名的方式是通过<code class="du kg kh ki kj b">library()</code>命令。这个选项的一个缺点是，如果在R环境中找不到这个包，就会抛出一个错误。另一个函数是<code class="du kg kh ki kj b">require()</code>,如果找不到包，它就抛出一条警告消息并返回<code class="du kg kh ki kj b">FALSE</code>,如果找到了，它就加载包并返回<code class="du kg kh ki kj b">TRUE</code>。</p><p id="c608" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想查看系统中的所有包，您可以使用<code class="du kg kh ki kj b">installed.packages()</code>，或者类似于<code class="du kg kh ki kj b">"testthat" %in% installed.packages()</code>的命令来检查特定的包(在本例中为<code class="du kg kh ki kj b">testthat</code>)。</p><h1 id="aaeb" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">2.基本文件夹结构</h1><p id="8535" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">R包的内容通常包含在一个结构化的文件夹中，该文件夹包含R文件以及文档和其他二进制文件。一个工作的R包的最简单的结构应该如下所示。</p><pre class="kk kl km kn fd ko kj kp kq aw kr bi"><span id="9a0a" class="ks je hi kj b fi kt ku l kv kw">├── DESCRIPTION<br/>├── NAMESPACE<br/>└── R<br/>    ├── file1.R<br/>    └── file2.R</span></pre><p id="1514" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kg kh ki kj b">DESCRIPTION</code>是包含包的元数据的文件。它至少需要两个字段:包的名称和版本。<code class="du kg kh ki kj b">NAMESPACE</code>是由<code class="du kg kh ki kj b">roxygen2</code>自动生成的文件，不能手工编辑。也就是说，下面的mock应该可以与任何包一起导出R文件夹中定义的所有函数。</p><pre class="kk kl km kn fd ko kj kp kq aw kr bi"><span id="4c4d" class="ks je hi kj b fi kt ku l kv kw"># Generated by roxygen2: fake comment so roxygen2 overwrites silently.<br/>exportPattern("^[^\\.]")</span></pre><p id="1dbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，<code class="du kg kh ki kj b">R</code>是包含所有R定义和变量的文件的文件夹。</p><h1 id="3e58" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">3.访问命名空间中导出的变量</h1><p id="8f2a" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">加载整个包可能需要一段时间，更不用说它可能会覆盖内存中与包中定义的一些对象同名的变量。所以，如果想在一个包中只使用一个函数，可以使用双冒号操作符，<code class="du kg kh ki kj b">::</code>。例如，为了使用包<code class="du kg kh ki kj b">testthat</code>中的函数<code class="du kg kh ki kj b">test_file()</code>，可以简单地输入<code class="du kg kh ki kj b">testthat::test_file()</code>。</p><h1 id="d235" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">4.访问命名空间中的内部变量</h1><p id="b920" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">三重冒号操作符<code class="du kg kh ki kj b">:::</code>，简单来说就是<code class="du kg kh ki kj b">::</code>在类固醇上！该操作符允许您使用包中定义的变量，这些变量不导出到用户环境中。</p><p id="edf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一个例子，运行命令<code class="du kg kh ki kj b">testthat:::praise()</code>你会发现一个惊喜！</p><h1 id="1ddd" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">5.devtools就在那里！用它！</h1><p id="cb6d" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在您的R环境中安装<code class="du kg kh ki kj b">devtools</code>包通常并不简单，因为它有许多依赖项和C二进制文件，但是它会使开发R包变得容易得多。因此，请耐心完成额外的调试工作——这在将来会有回报的！</p><p id="cb6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开发R包的一些最有用的函数有:<code class="du kg kh ki kj b">document()</code>、<code class="du kg kh ki kj b">install()</code>、<code class="du kg kh ki kj b">load_all()</code>和<code class="du kg kh ki kj b">test()</code>。</p><ul class=""><li id="5d80" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated"><code class="du kg kh ki kj b">document()</code>:使用以<code class="du kg kh ki kj b">#'</code>开头的注释和<code class="du kg kh ki kj b">NAMESPACE</code>文件生成所有文档，包括手册页。当<code class="du kg kh ki kj b">NAMESPACE</code>被重写时，每次加载包时，只有标有<code class="du kg kh ki kj b">@export</code>的定义被导出。</li><li id="d9cd" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><code class="du kg kh ki kj b">install()</code>:在本地R环境下，安装工作目录或提供的路径对应的R包。</li><li id="12a8" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><code class="du kg kh ki kj b">load_all()</code>:加载工作目录或提供的路径对应的R包中定义的所有函数和变量，不需要安装。这在与RStudio结合使用时特别有用，可以创建断点并检查所编写函数的行为。</li><li id="d7d9" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><code class="du kg kh ki kj b">test()</code>:自动运行R包中位于<code class="du kg kh ki kj b">tests</code>的所有单元测试。</li></ul><h1 id="cfe7" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">参考</h1><p id="bd8a" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">所有这些想法都是在探索一些R包的帮助页面或源代码时收集的。以下几页对我特别有帮助。</p><ul class=""><li id="8946" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated"><a class="ae ll" href="https://r-pkgs.org/" rel="noopener ugc nofollow" target="_blank"> R包</a></li><li id="5910" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><a class="ae ll" href="https://www.rdocumentation.org/" rel="noopener ugc nofollow" target="_blank"> R文档</a></li><li id="f50a" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><a class="ae ll" href="https://github.com/r-lib/testthat" rel="noopener ugc nofollow" target="_blank">测试存储库</a></li></ul><h1 id="cee6" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结论</h1><p id="ab6e" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我希望这篇文章对你有用，也不要忘记分享你最喜欢的R技巧！</p></div></div>    
</body>
</html>