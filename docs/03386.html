<html>
<head>
<title>Install TensorFlow GPU on Ubuntu 18.04 LTS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu 18.04 LTS上安装TensorFlow GPU</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-set-up-tensorflow-gpu-on-ubuntu-18-04-lts-7a09ffd5f30f?source=collection_archive---------0-----------------------#2020-01-29">https://medium.com/analytics-vidhya/how-to-set-up-tensorflow-gpu-on-ubuntu-18-04-lts-7a09ffd5f30f?source=collection_archive---------0-----------------------#2020-01-29</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><div class=""><h2 id="7c24" class="pw-subtitle-paragraph ig hi hj bd b ih ii ij ik il im in io ip iq ir is it iu iv iw ix dy translated">使用NVIDIA CUDA/cuDNN的GPU加速深度学习</h2></div><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et iy"><img src="../Images/8a1ab120d1a45a8ee0197fb74aa7d583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*aBcfRK-jUEB1y3EVM1YgQg.png"/></div></figure><h1 id="8a39" class="jg jh hj bd ji jj jk jl jm jn jo jp jq ip jr iq js is jt it ju iv jv iw jw jx bi translated"><strong class="ak">TL；博士</strong></h1><p id="d176" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">我如何在Ubuntu 18.04 LTS上安装兼容的NVIDIA CUDA Tookit和cuDNN包，以便在笔记本电脑上使用GPU加速TensorFlow/Keras的深度学习。</p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h1 id="564e" class="jg jh hj bd ji jj lb jl jm jn lc jp jq ip ld iq js is le it ju iv lf iw jw jx bi translated">目录</h1><ol class=""><li id="831e" class="lg lh hj ka b kb kc ke kf kh li kl lj kp lk kt ll lm ln lo bi translated"><a class="ae lp" href="#bd39" rel="noopener ugc nofollow">免责声明</a></li><li id="2c21" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="#757b" rel="noopener ugc nofollow">简介</a></li><li id="68d3" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="#cb8f" rel="noopener ugc nofollow">安装流程</a> <br/>步骤1。<a class="ae lp" href="#dcce" rel="noopener ugc nofollow">识别兼容性</a>步骤2<br/>。<a class="ae lp" href="#7b17" rel="noopener ugc nofollow">安装视频驱动</a>步骤3<br/>。<a class="ae lp" href="#8614" rel="noopener ugc nofollow">安装CUDA工具包</a>步骤4<br/>。<a class="ae lp" href="#d7f8" rel="noopener ugc nofollow">安装CUDNN库</a> <br/>第五步。<a class="ae lp" href="#1927" rel="noopener ugc nofollow">更新环境变量</a> <br/>第六步。<a class="ae lp" href="#0ec4" rel="noopener ugc nofollow">安装TensorFlow-GPU和Keras </a> <br/>步骤7。<a class="ae lp" href="#059f" rel="noopener ugc nofollow">运行验证测试</a> <br/>步骤8。<a class="ae lp" href="#ea17" rel="noopener ugc nofollow">在CNN模型上试运行</a></li><li id="66ca" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="#9fdb" rel="noopener ugc nofollow">杂项提示</a><br/>a .<a class="ae lp" href="#80bd" rel="noopener ugc nofollow">tensor flow-GPU还是不加载怎么办？</a> <br/> b. <a class="ae lp" href="#9c3c" rel="noopener ugc nofollow">如何管理CUDA内存不足警告？</a> <br/> c. <a class="ae lp" href="#6a59" rel="noopener ugc nofollow">如何监控GPU使用情况？</a> <br/> d. <a class="ae lp" href="#c7df" rel="noopener ugc nofollow">如何杀死(释放)失控的进程？</a> <br/> e. <a class="ae lp" href="#2786" rel="noopener ugc nofollow">我如何让Keras CuDNNLSTM使用最新的空间？</a></li><li id="a05d" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="#32be" rel="noopener ugc nofollow">总结</a></li><li id="ba6a" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="#3532" rel="noopener ugc nofollow">方便的参考资料</a></li></ol></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h1 id="bd39" class="jg jh hj bd ji jj lb jl jm jn lc jp jq ip ld iq js is le it ju iv lf iw jw jx bi translated">放弃</h1><p id="8b60" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">在我们开始之前，有些警告是适当的。</p><ul class=""><li id="e4bd" class="lg lh hj ka b kb lv ke lw kh lx kl ly kp lz kt ma lm ln lo bi translated">本文不是为Anaconda用户编写的，因为当您在Anaconda下安装Tensorflow-gpu时，它会为您处理上述CUDA驱动程序。可以在这里<a class="ae lp" rel="noopener" href="/@shaolinkhoa/install-tensorflow-gpu-2-0-alpha-on-anaconda-for-windows-10-ubuntu-ced099010b21"> <strong class="ka hk">这里</strong> </a>这里<a class="ae lp" href="https://docs.anaconda.com/anaconda/user-guide/tasks/tensorflow/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk">这里</strong> </a> <strong class="ka hk">查看。</strong></li><li id="89e0" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">这主要是针对那些使用Anaconda之外的IDE和虚拟环境进行编码的Python用户。</li><li id="e535" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">此外，这是基于我的经验与Ubuntu 18.04 LTS只。然而，我认为整个安装过程也很容易适应LTS的Ubuntu 16.04。</li><li id="677d" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">遗憾的是，即使你已经成功地安装并测试了兼容的CUDA/cuDNN包，也不能保证你的设置一定能工作。可能需要额外的调整和实验。</li></ul><p id="ee91" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h1 id="757b" class="jg jh hj bd ji jj lb jl jm jn lc jp jq ip ld iq js is le it ju iv lf iw jw jx bi translated">介绍</h1><p id="79c8" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">在我加入<a class="ae lp" href="https://metis.kaplan.com.sg/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk"> Metis </strong> </a>数据科学训练营旅程之前，建议的先决条件之一是准备一台Ubuntu笔记本电脑。自然，我毫不犹豫地去争取。在我的笔记本电脑上安装Ubuntu，并与Windows进行双引导，这是一次非常棒的学习经历，值得一提。</p><p id="fc27" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">最重要的是，我希望我的DL项目能够充分利用我的笔记本电脑GPU (GTX 1050)。事实证明，我花了很多时间搜索并重新安装库包。因此，我决定写这篇博客作为我自己的参考，如果你也感兴趣，希望它也能帮助你。</p><h2 id="11d7" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">先决条件</h2><ul class=""><li id="1b9a" class="lg lh hj ka b kb kc ke kf kh li kl lj kp lk kt ma lm ln lo bi translated">您的计算机上必须安装有NVIDIA显卡。您可以从命令行中找到:</li></ul><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="28d2" class="me jh hj mt b fj mx my l mz na"><strong class="mt hk">$</strong> lspci | grep -i nvidia</span></pre><ul class=""><li id="4bc9" class="lg lh hj ka b kb lv ke lw kh lx kl ly kp lz kt ma lm ln lo bi translated">你已经安装了Ubuntu 18.04 LTS(我的参考资料:<a class="ae lp" href="https://itsfoss.com/install-ubuntu-1404-dual-boot-mode-windows-8-81-uefi/" rel="noopener ugc nofollow" target="_blank">此处</a>、<a class="ae lp" href="https://hackernoon.com/installing-ubuntu-18-04-along-with-windows-10-dual-boot-installation-for-deep-learning-f4cd91b58557" rel="noopener ugc nofollow" target="_blank">此处</a> &amp; <a class="ae lp" rel="noopener" href="/@mishawagon/ubuntu-and-windows-10-dual-boot-setup-2d5e6b5842fe">此处</a>)</li><li id="491e" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">你已经为机器学习建立了一个<a class="ae lp" href="https://www.digitalocean.com/community/tutorials/how-to-install-python-3-and-set-up-a-programming-environment-on-ubuntu-18-04-quickstart" rel="noopener ugc nofollow" target="_blank"> Python开发环境</a></li></ul><p id="2a74" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h1 id="cb8f" class="jg jh hj bd ji jj lb jl jm jn lc jp jq ip ld iq js is le it ju iv lf iw jw jx bi translated">安装过程</h1><p id="89dd" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">在我们开始之前，知道如何在出现问题时恢复到之前的状态总是好的。幸运的是，卸载非常简单，详见<a class="ae lp" href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#removing-cuda-tk-and-driver" rel="noopener ugc nofollow" target="_blank">此处</a>:</p><p id="0e7c" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><br/>移除CUDA工具包:<code class="dv nb nc nd mt b"><strong class="ka hk">$</strong> sudo apt-get --purge remove "*cublas*" "cuda*"</code></p><p id="38d5" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">要删除libcudnn驱动程序:<br/> <code class="dv nb nc nd mt b"><strong class="ka hk">$</strong> sudo apt-get --purge remove "libcudnn7*"</code></p><p id="412f" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">移除NVIDIA驱动程序(可选):<br/> <code class="dv nb nc nd mt b"><strong class="ka hk">$</strong> sudo apt-get --purge remove "*nvidia*"</code></p><p id="15b0" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="dcce" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤1 —确定兼容性</h2><p id="e2da" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">我们需要确保您的系统不存在以下兼容性问题:</p><ul class=""><li id="40ec" class="lg lh hj ka b kb lv ke lw kh lx kl ly kp lz kt ma lm ln lo bi translated">视频驱动程序</li><li id="54d2" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">CUDA工具包</li><li id="54e4" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">cuDNN</li><li id="e79d" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">Tensorflow GPU</li></ul><p id="9069" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">先弄清楚你的NVIDIA显卡是否兼容<a class="ae lp" href="https://developer.nvidia.com/cuda-gpus" rel="noopener ugc nofollow" target="_blank">T3这里T5。</a></p><p id="a062" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">接下来，使用以下选项之一记下显卡驱动程序的版本:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="1c08" class="me jh hj mt b fj mx my l mz na">$ modinfo nvidia | grep version<br/>$ nvidia-settings</span></pre><p id="1166" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">访问<a class="ae lp" href="https://docs.nvidia.com/deploy/cuda-compatibility/index.html#binary-compatibility__table-toolkit-driver" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk">此处</strong> </a>识别哪个版本的CUDA与您的卡兼容。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et ne"><img src="../Images/fdd6d0de1ea5b4d12a26be1aeeab7784.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*skyWRkhIesOXr2yenHhZyA.png"/></div><figcaption class="nf ng eu es et nh ni bd b be z dy translated">表1: Cuda工具包和兼容的视频驱动程序</figcaption></figure><p id="d8c3" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">最后，访问此处的<a class="ae lp" href="https://www.tensorflow.org/install/source#gpu" rel="noopener ugc nofollow" target="_blank"><strong class="ka hk"/></a>来记下基于你最兼容的CUDA版本，你可以安装哪个cuDNN和TensorFlow。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="es et nj"><img src="../Images/48699120123064e3d631baae4d32f6b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mrZmlb7Cyf35Y4rIgHeZPw.png"/></div></div><figcaption class="nf ng eu es et nh ni bd b be z dy translated">表2: Tensorflow GPU和各自的兼容库</figcaption></figure><p id="3d42" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">从我个人的经验来看，虽然我们应该只安装兼容的CUDA和各自的cuDNN版本，但是我们有一点空间根据默认的安装结果来改变cuDNN版本。更多关于<a class="ae lp" href="#a192" rel="noopener ugc nofollow">这个</a>以后再说。</p><p id="8398" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="7b17" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤2 —安装视频驱动程序</h2><p id="1a7d" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">现在你知道你有一个兼容的NVIDIA显卡，让我们安装最新的驱动程序。</p><p id="39a5" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">首先，让我们将您拥有的与可用的进行比较:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="7698" class="me jh hj mt b fj mx my l mz na">$ <!-- -->modinfo nvidia | grep version<br/>$ ubuntu-drivers devices</span></pre><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et no"><img src="../Images/609188d1babefc6ccf02947a50774852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*omLzNw4YORjgI_8xGA3OhA.png"/></div></figure><p id="86ff" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">让我们从驱动程序列表中安装最新推荐的驱动程序，如果您还没有这样做。就我而言，我使用以下代码将我的GTX 1050更新到版本440:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="e155" class="me jh hj mt b fj mx my l mz na">$ sudo apt install <strong class="mt hk">nvidia-driver-440</strong></span></pre><blockquote class="np nq nr"><p id="4b88" class="jy jz ns ka b kb lv ik kd ke lw in kg nt mb kj kk nu mc kn ko nv md kr ks kt hc bi translated"><strong class="ka hk">务必</strong>确保在重启前选择了NVIDIA驱动程序。</p></blockquote><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="6080" class="me jh hj mt b fj mx my l mz na">$ prime-select query<br/>$ prime-select nvidia</span></pre><p id="74a1" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="8614" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤3 —安装CUDA工具包</h2><p id="5b3d" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">有了最新的视频驱动程序，让我们安装与你的视频驱动程序最兼容的CUDA Tookit。</p><p id="65da" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">让我们看看你是否安装了它，或者更糟，错误的版本。要进行检查，请使用以下命令之一:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="2670" class="me jh hj mt b fj mx my l mz na">$ nvcc --version<br/>$ apt list --installed | grep -i nvcc</span></pre><p id="511e" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果您安装了不兼容的版本和/或它不适合您，建议执行干净的卸载:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="9a62" class="me jh hj mt b fj mx my l mz na">$ sudo apt-get — purge remove “*cublas*”<br/>$ sudo apt-get — purge remove “cuda*”</span></pre><p id="2649" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果您安装了正确的版本，那么您可以跳到下一步。</p><p id="9111" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">要下载您的兼容CUDA工具包，请访问<a class="ae lp" href="https://developer.nvidia.com/cuda-toolkit-archive" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk">此处</strong> </a> <strong class="ka hk"> </strong>和<strong class="ka hk"> </strong>选择您可以使用的兼容版本<strong class="ka hk">。</strong>我们不需要去<strong class="ka hk"> </strong> <a class="ae lp" href="https://developer.nvidia.com/cuda-downloads" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk">这里</strong> </a> <strong class="ka hk"> </strong>安装最新的CUDA，因为Tensorflow GPU库通常还不兼容它(请参考上面的<a class="ae lp" href="#d8c3" rel="noopener ugc nofollow">表2 </a>进行回顾)。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="es et nw"><img src="../Images/0f08b404f80f92988d9ddf6081531e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_jtc-08WRNXvwiZq5IJHw.png"/></div></div></figure><p id="88a1" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">一旦你点击了相应的版本，你将被送到一个新的页面。从这里，选择Ubuntu 18.04的所有相关选项。下面是我选择下载CUDA Tookit 10.0的截图，这是我安装TensorFlow GPU 1.13和1.14的兼容版本。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="es et nx"><img src="../Images/2b18892c6b4d97d46b9918320278e2d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIHmd1WBDl5peSw7ItlStg.png"/></div></div></figure><p id="bf17" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">点击“下载”按钮下载“基本安装程序”deb文件，并按照框中的说明进行操作，最后一条除外。</p><blockquote class="np nq nr"><p id="b8d3" class="jy jz ns ka b kb lv ik kd ke lw in kg nt mb kj kk nu mc kn ko nv md kr ks kt hc bi translated"><strong class="ka hk">重要提示</strong>:之后不要升级你安装的CUDA版本。</p></blockquote><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="es et ny"><img src="../Images/2bd71c092673114a7b1d1b51986b7a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iMe_UeKYpdu_57i63e5fKw.png"/></div></div></figure><p id="de37" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="d7f8" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤4 —安装cuDNN库</h2><p id="6892" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">现在我们已经安装了CUDA，让我们安装兼容的cuDNN。像往常一样，让我们检查一下您是否已经安装了一个，如果它不适合您，那么您将需要删除它。<br/> <code class="dv nb nc nd mt b">$ apt list --installed | grep -i libcudnn</code></p><p id="6ab2" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">版本控制有两个部分。对于我的情况，我需要cuDNN版本7.6和CUDA工具包版本10.0。因此，我下载并安装了它。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="es et nz"><img src="../Images/a38ccd48f4596014e6df736f734ba799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrhOP3e0SjZYdf1G-y5H0g.png"/></div></div></figure><p id="f729" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果需要删除已有的libcudnn:<br/>T1】</p><p id="372e" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">访问<a class="ae lp" href="https://developer.nvidia.com/cudnn" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk">此处</strong> </a>点击“下载cuDNN”继续。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="es et oa"><img src="../Images/2c412bea8087a28f194e013d63b92ce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hF1b_8LKgdMP-eHnZvs6UQ.png"/></div></div></figure><p id="f4c0" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">然后会提示您注册或登录。如果这是你第一次来这里，你必须注册。</p><p id="d040" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">一旦登录，勾选同意条款，你应该看到这个页面。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et ob"><img src="../Images/3d609962dbfb0fbf6b593d6f6fe54c5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*3PHUOHPu6r6hiBOTnEXjeQ.png"/></div></figure><p id="0836" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果您的cuDNN版本不在列表中，则选择“<em class="ns">存档的cuDNN版本</em>”以获得更多选项。</p><p id="c811" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">请记住，要匹配与您可以/想要安装的TensorFlow兼容的cuDNN和CUDA版本。对于我的情况，我选择了cuDNN 7.6.3和CUDA 10.0。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et oc"><img src="../Images/b91feab723e473fdb2ca8174fc6bab98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*Wud1kmNE-DwRpnnvXwH_Lg.png"/></div></figure><p id="7a5d" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">下载Ubuntu 18.04的所有三个Deb文件:</p><ul class=""><li id="5c67" class="lg lh hj ka b kb lv ke lw kh lx kl ly kp lz kt ma lm ln lo bi translated">cuDNN运行时库</li><li id="1239" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">cuDNN开发者库</li><li id="d28a" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">cuDNN代码示例和用户指南</li></ul><p id="2abd" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">要安装，请运行以下命令(但将文件名更改为您下载的文件名):</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="97c5" class="me jh hj mt b fj mx my l mz na">$ sudo dpkg -i <em class="ns">libcudnn7_7.6.5.32-1+cuda10.0_amd64.deb</em><br/>$ sudo dpkg -i <em class="ns">libcudnn7-dev_7.6.5.32-1+cuda10.0_amd64.deb</em><br/>$ sudo dpkg -i <em class="ns">libcudnn7-doc_7.6.5.32-1+cuda10.0_amd64.deb</em></span></pre><p id="77ce" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">我们还要防止版本被意外/自动更新:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="7f49" class="me jh hj mt b fj mx my l mz na">$ sudo apt-mark hold libcudnn7 libcudnn7-dev<br/>$ apt-mark showhold</span></pre><p id="d366" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="1927" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤5 —更新环境变量</h2><p id="8a97" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">快到了！我们必须更新几个环境变量。首先，检查CUDA是否已经在您的系统路径中:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="953f" class="me jh hj mt b fj mx my l mz na">$ echo $PATH<br/>$ echo $LD_LIBRARY_PATH</span></pre><p id="389f" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">若要更新，请使用您喜欢的文本编辑器打开。bashrc文件:<br/> <code class="dv nb nc nd mt b">$ nano ~/.bashrc</code></p><p id="b3c2" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">跳到文件的末尾，添加以下三行，但是要确保修改CUDA版本以匹配您的版本。</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="d356" class="me jh hj mt b fj mx my l mz na"><br/># NVIDIA CUDA Toolkit<br/>export PATH=/usr/local/cuda-<strong class="mt hk">10.0</strong>/bin:$PATH<br/>export LD_LIBRARY_PATH=/usr/local/cuda-<strong class="mt hk">10.0</strong>/lib64:$LD_LIBRARY_PATH</span></pre><p id="1804" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">重启以使这些生效。</p><blockquote class="np nq nr"><p id="f1fe" class="jy jz ns ka b kb lv ik kd ke lw in kg nt mb kj kk nu mc kn ko nv md kr ks kt hc bi translated"><strong class="ka hk"> NB </strong>:通过运行下面的命令之一，可以在不重启的情况下执行修改，但是当我随后运行验证测试时，不知何故它对我不起作用。如果你的测试第一次也失败了，在你尝试其他任何事情之前:试着重启一次，然后再次运行测试以确保万无一失。</p></blockquote><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="477c" class="me jh hj mt b fj mx my l mz na">$ source ~/.bashrc<br/>$ . ~/.bashrc</span></pre><p id="4c78" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="0ec4" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤6-安装Tensorflow GPU和Keras</h2><p id="c140" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">如果您还没有安装TensorFlow GPU和Keras，让我们来安装它们。您需要的TF版本必须与您的CUDA工具包和cuDNN库兼容(参见表2)。</p><p id="dddf" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">对于我来说，我的显卡兼容CUDA 10.1和更低版本。这基本上意味着我可以安装任何版本的TensorFlow GPU。然而，由于我的DL项目仍然运行在旧的TF (TensorFlow)版本上，我将只安装最新的TF 1.14。</p><p id="1ea4" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">要安装特定的TF版本，请运行以下命令:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="8a11" class="me jh hj mt b fj mx my l mz na">$ pip install “tensorflow-gpu==1.14.*”<br/>$ pip install keras</span></pre><p id="b6d0" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">要检查:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="c365" class="me jh hj mt b fj mx my l mz na">$ pip list | grep -i tensor<br/>$ pip list | grep -i keras</span></pre><p id="c76f" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="059f" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤7 —运行验证测试</h2><p id="9ffc" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">我们现在越来越接近了！让我们按此顺序运行以下测试:</p><ul class=""><li id="c256" class="lg lh hj ka b kb lv ke lw kh lx kl ly kp lz kt ma lm ln lo bi translated">步骤7a。验证cuDNN正在工作</li><li id="b227" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">步骤7b。验证TensorFlow GPU正在工作</li></ul><h2 id="a40b" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤7a —验证cuDNN</h2><p id="4559" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">按此处 指示的<a class="ae lp" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#verify" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk">运行以下命令。</strong></a></p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="d0e5" class="me jh hj mt b fj mx my l mz na">$ cp -r /usr/src/cudnn_samples_v7/ $HOME<br/>$ cd  $HOME/cudnn_samples_v7/mnistCUDNN<br/>$ make clean &amp;&amp; make<br/>$ ./mnistCUDNN</span></pre><p id="eff1" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果cuDNN工作正常，您应该会看到这条消息:<br/> <code class="dv nb nc nd mt b">Test passed!</code></p><h2 id="41e0" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">步骤7b —验证Tensorflow GPU</h2><p id="44cd" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">从命令行启动“python”并执行这些代码:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="59ac" class="me jh hj mt b fj mx my l mz na">$ python<br/>&gt;&gt;&gt; import tensorflow as tf<br/>&gt;&gt;&gt; print(tf.test.gpu_device_name())<br/>&gt;&gt;&gt; quit()</span></pre><p id="dc88" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果TF-GPU安装正确，应该会报告一个GPU设备:<br/> <code class="dv nb nc nd mt b">/device:GPU:0</code></p><p id="2f02" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="ea17" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">第八步。在CNN模型上试运行</h2><p id="6102" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">访问<a class="ae lp" href="https://www.tensorflow.org/tutorials/images/cnn" rel="noopener ugc nofollow" target="_blank"> <strong class="ka hk">这里</strong> </a>，下载笔记本，给它一个旋转。</p><p id="73d6" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果你遇到CUDA OOM(内存不足)警告，点击<a class="ae lp" href="#9c3c" rel="noopener ugc nofollow"> <strong class="ka hk">此处</strong> </a>了解如何解决。</p><p id="690e" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h1 id="9fdb" class="jg jh hj bd ji jj lb jl jm jn lc jp jq ip ld iq js is le it ju iv lf iw jw jx bi translated">杂项提示</h1><p id="c633" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">现在，您已经成功安装了一个可运行的TensorFlow GPU，让我根据自己的学习经验与您分享几个技巧。</p><p id="c21d" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="80bd" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">Tensorflow-GPU还是不加载怎么办？</h2><ol class=""><li id="d2fc" class="lg lh hj ka b kb kc ke kf kh li kl lj kp lk kt ll lm ln lo bi translated">确保安装了与<a class="ae lp" href="#dcce" rel="noopener ugc nofollow">最兼容的版本</a>:<a class="ae lp" href="#7b17" rel="noopener ugc nofollow">NVIDIA视频驱动</a>，<a class="ae lp" href="#8614" rel="noopener ugc nofollow"> CUDA工具包</a>，<a class="ae lp" href="#d7f8" rel="noopener ugc nofollow"> cuDNN </a>和<a class="ae lp" href="#0ec4" rel="noopener ugc nofollow"> TensorFlow-GPU </a>。</li><li id="d5d0" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated">确保<a class="ae lp" href="#1927" rel="noopener ugc nofollow">路径和LD_LIBRARY_PATH </a>已经正确更新。</li><li id="4ef6" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated">重启机器并再次运行<a class="ae lp" href="#059f" rel="noopener ugc nofollow">验证测试</a>。</li><li id="a959" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated">根据各种论坛讨论，如果您无法在当前设置下使用Tensorflow-GPU，您可以尝试降级到不同版本的Tensorflow-GPU、cuDNN和CUDA Toolkit(按此顺序)。在每次排列改变后运行验证测试。</li><li id="81a9" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated">在谷歌上搜索错误信息，或者在StackOverflow这样的论坛上发帖寻求帮助。</li></ol><blockquote class="np nq nr"><p id="8ddc" class="jy jz ns ka b kb lv ik kd ke lw in kg nt mb kj kk nu mc kn ko nv md kr ks kt hc bi translated"><strong class="ka hk">重要提示</strong>:在安装一个不同的版本之前，一定要记得卸载以前的CUDA/cuDNN版本。记住也要更新环境变量。</p></blockquote><p id="20e6" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="9c3c" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">如何管理CUDA内存不足警告</h2><p id="08b4" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">请注意，您可能遇到的一个常见问题是<strong class="ka hk"> CUDA OOM(内存不足)</strong>警告。基于<a class="ae lp" href="https://stackoverflow.com/questions/34199233/how-to-prevent-tensorflow-from-allocating-the-totality-of-a-gpu-memory" rel="noopener ugc nofollow" target="_blank">这个</a>和<a class="ae lp" href="https://riptutorial.com/tensorflow/example/31879/control-the-gpu-memory-allocation" rel="noopener ugc nofollow" target="_blank">这个</a>，您可以将以下代码插入到您的脚本/笔记本中，以帮助管理该问题。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="od oe l"/></div></figure><p id="2d01" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="6a59" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">如何监控GPU的使用</h2><p id="30a6" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">在命令行中运行以下命令之一:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="681a" class="me jh hj mt b fj mx my l mz na">$ nvidia-smi<br/>$ watch -n 5 nvidia-smi</span></pre><p id="02ed" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">您可能希望监控温度、当前内存使用量和每个进程的内存使用量(以及各自的PID)。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="es et of"><img src="../Images/56f37035026d2f3a8b6166e50a3d0da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n6l3BNG8j9tQwn0p5BPawA.png"/></div></div></figure><blockquote class="np nq nr"><p id="9ff0" class="jy jz ns ka b kb lv ik kd ke lw in kg nt mb kj kk nu mc kn ko nv md kr ks kt hc bi translated"><strong class="ka hk"> NB </strong>:注意CUDA版本列为10.2，和我安装的10.0不一样。根据<a class="ae lp" href="https://stackoverflow.com/questions/53422407/different-cuda-versions-shown-by-nvcc-and-nvidia-smi" rel="noopener ugc nofollow" target="_blank">这个</a>和<a class="ae lp" href="https://docs.nvidia.com/cuda/cuda-runtime-api/driver-vs-runtime-api.html" rel="noopener ugc nofollow" target="_blank">这个</a>，有两种不同的API，运行时和驱动API。我们安装的CUDA工具包指的是运行时API，而不是视频驱动API。</p></blockquote><p id="7dfb" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="c7df" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">如何终止(释放)失控的进程</h2><p id="ed2b" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">如果GPU内存没有被释放，即使你已经退出了你的IDE或笔记本，那么你可以手动杀死它。您可以通过使用其各自的PID来实现。例如，如果我想终止上面显示的最后一个进程2471:</p><pre class="iz ja jb jc fe ms mt mu mv aw mw bi"><span id="be8b" class="me jh hj mt b fj mx my l mz na">$ sudo kill -9 2471</span></pre><p id="14e9" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">如果您不确定要终止哪个进程，您可以从底层开始，尤其是可疑地占用大量内存的进程。</p><p id="ded6" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h2 id="2786" class="me jh hj bd ji mf mg mh jm mi mj mk jq kh ml mm js kl mn mo ju kp mp mq jw mr bi translated">我如何让Keras CuDNNLSTM与最新的空间</h2><p id="51c5" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">在弄清楚Google Colab是如何做到的之后，只安装以下版本:</p><ul class=""><li id="b292" class="lg lh hj ka b kb lv ke lw kh lx kl ly kp lz kt ma lm ln lo bi translated">CUDA工具包10.0</li><li id="37db" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">cuDNN 7.6</li><li id="f2c7" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ma lm ln lo bi translated">TensorFlow 1.15.x</li></ul><p id="a192" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><strong class="ka hk">注1: </strong>在保留CUDA Toolkit 10.0兼容版本的同时，我能够将cuDNN从7.4升级到7.6，尽管这在<a class="ae lp" href="https://www.tensorflow.org/install/source#gpu" rel="noopener ugc nofollow" target="_blank">网站上没有被列为兼容</a>。</p><p id="0bb6" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><strong class="ka hk">注2: </strong>在安装了TF 1.15之后，我在使用Keras卷积层进行图像分类项目时遇到了问题。最终，通过在新环境中安装TensorFlow 1.14.x解决了这个问题。<a class="ae lp" href="https://docs.python-guide.org/dev/virtualenvs/" rel="noopener ugc nofollow" target="_blank">虚拟环境</a>为赢！</p><p id="33ef" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h1 id="32be" class="jg jh hj bd ji jj lb jl jm jn lc jp jq ip ld iq js is le it ju iv lf iw jw jx bi translated">包裹</h1><p id="a389" class="pw-post-body-paragraph jy jz hj ka b kb kc ik kd ke kf in kg kh ki kj kk kl km kn ko kp kq kr ks kt hc bi translated">最后，我希望你能够在你的Ubuntu 18.04 LTS上成功安装一个工作Tensorflow-GPU环境，它可以通过你的板载GPU全面加速你的所有深度学习项目。</p><p id="29b1" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">对于那些因为任何原因而不能这样做的人，不要绝望。你可以一直使用云解决方案，例如，<a class="ae lp" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>，它免费提供GPU和TPU！或者，您也可以尝试使用<a class="ae lp" href="https://www.tensorflow.org/install/docker" rel="noopener ugc nofollow" target="_blank"> Docker </a>来代替。</p><p id="d627" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated">感谢你阅读我的文章，我希望这对你有用！</p><p id="34d2" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl ku kv gq kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hc hd he hf hg"><h1 id="3532" class="jg jh hj bd ji jj lb jl jm jn lc jp jq ip ld iq js is le it ju iv lf iw jw jx bi translated">方便的参考资料</h1><ol class=""><li id="4acb" class="lg lh hj ka b kb kc ke kf kh li kl lj kp lk kt ll lm ln lo bi translated"><a class="ae lp" href="https://docs.nvidia.com/cuda/index.html" rel="noopener ugc nofollow" target="_blank"> CUDA工具包文档</a></li><li id="a6af" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated">用于Linux的NVIDIA CUDA安装指南</li><li id="896a" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#install-linux" rel="noopener ugc nofollow" target="_blank">Linux上的cuDNN安装指南</a></li><li id="5fe1" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="https://www.tensorflow.org/install/gpu" rel="noopener ugc nofollow" target="_blank"> TensorFlow GPU支持</a></li><li id="5e71" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="https://www.tensorflow.org/install/source#gpu" rel="noopener ugc nofollow" target="_blank"> TensorFlow GPU兼容性列表</a></li><li id="ba9d" class="lg lh hj ka b kb lq ke lr kh ls kl lt kp lu kt ll lm ln lo bi translated"><a class="ae lp" href="https://www.tensorflow.org/install/pip" rel="noopener ugc nofollow" target="_blank"> TensorFlow Pip安装指南</a></li></ol><p id="ca8f" class="pw-post-body-paragraph jy jz hj ka b kb lv ik kd ke lw in kg kh mb kj kk kl mc kn ko kp md kr ks kt hc bi translated"><a class="ae lp" href="#564e" rel="noopener ugc nofollow"> ^ </a></p></div></div>    
</body>
</html>