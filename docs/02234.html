<html>
<head>
<title>Enhancing the performance measures by Voting Classifier in ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用最大似然法中的投票分类器增强性能度量</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/voting-classifier-in-machine-learning-9534504eba39?source=collection_archive---------5-----------------------#2019-12-07">https://medium.com/analytics-vidhya/voting-classifier-in-machine-learning-9534504eba39?source=collection_archive---------5-----------------------#2019-12-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="668b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设你是决策小组的一员，小组的每个成员都有一个关于某事的决定。专家组在他们之间进行投票，并做出最终决定。他们是怎么做到的？简单来说，他们采用全体成员投票的方式。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/c56cdd850ac91d4c9b5b30e78123892c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*KGY9BS4K-rmZJp3pzIj9IA.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">小组讨论和投票。</figcaption></figure><p id="53ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以用机器学习分类问题来做同样的事情。假设你已经训练了几个分类器，如逻辑回归分类器，SVC分类器，决策树分类器，随机森林分类器，也许还有几个，每个分类器的准确率都在85%左右。</p><p id="9959" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，机器学习分类我们也可以使用小组投票法。换句话说，创建一个均匀的分类器的一个非常简单的方法是聚合每个分类器的预测，并预测投票最多的类。这种多数投票分类器被称为硬投票分类器。</p><p id="9b2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有点令人惊讶的是，这种投票分类器通常比集成中的最佳分类器获得更高的准确度。事实上，即使每个分类器都是弱学习器(意味着它只比随机猜测稍好)，集成仍然可以是强学习器(实现高精度)，只要有足够数量的弱学习器并且它们足够多样化。获得不同分类器的一种方法是使用非常不同的算法来训练它们。这增加了他们犯不同类型错误的机会，提高了整体的准确性。</p><p id="c639" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码在Scikit-Learn中创建和训练了一个投票分类器。</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="46b5" class="ju jv hi jq b fi jw jx l jy jz">from sklearn.ensemble import RandomForestClassifier <br/>from sklearn.ensemble import VotingClassifier<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.svm import SVC</span><span id="06a1" class="ju jv hi jq b fi ka jx l jy jz">log_clf = LogisticRegression()<br/>rnd_clf = RandomForestClassifier()<br/>svm_clf = SVC()</span><span id="7b55" class="ju jv hi jq b fi ka jx l jy jz">voting_clf = VotingClassifier( estimators=[(‘lr’, log_clf), (‘rf’, rnd_clf),<br/> (‘svc’, svm_clf)], voting=’hard’ )<br/>voting_clf.fit(X_train, y_train)</span></pre><p id="74c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看每个分类器在测试集上的准确性:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="5003" class="ju jv hi jq b fi jw jx l jy jz">from sklearn.metrics import accuracy_score<br/>for clf in (log_clf, rnd_clf, svm_clf, voting_clf):<br/>    clf.fit(X_train, y_train)<br/>    y_pred = clf.predict(X_test)<br/>    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))</span></pre><p id="381a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kb">逻辑回归0.864 <br/>随机森林分类器0.872 <br/> SVC 0.888 <br/>投票分类器0.896 </em> </strong></p><p id="c737" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你有它！投票分类器略微优于所有单个分类器。如果所有分类器都能够估计类概率(即，它们有一个pre dict_proba()方法)，那么您可以告诉Scikit-Learn预测具有最高类概率的类，在所有单个分类器上平均。这被称为软投票。它通常比硬投票获得更高的性能，因为它给予高度自信的投票更多的权重。你所需要做的就是用voting="soft "替换voting="hard "并确保所有的分类器都能估计类概率。SVC类默认情况下不是这样，所以需要将其概率超参数设置为True(这将使SVC类使用交叉验证来估计类概率，减慢训练，并且它将添加一个predict_proba()方法)。如果您修改前面的代码以使用软投票，您会发现投票分类器达到了91%以上的准确率！</p></div></div>    
</body>
</html>