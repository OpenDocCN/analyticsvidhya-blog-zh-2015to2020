<html>
<head>
<title>Face Detection with 15 lines of python code using OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用OpenCV的15行python代码实现人脸检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/face-detection-with-15-lines-of-python-code-using-opencv-2508e2d2f8f8?source=collection_archive---------13-----------------------#2019-09-20">https://medium.com/analytics-vidhya/face-detection-with-15-lines-of-python-code-using-opencv-2508e2d2f8f8?source=collection_archive---------13-----------------------#2019-09-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4424c7448103720db556f78f571cf58d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*up7OiBis6OwYrenz9bw0fQ.jpeg"/></div></div></figure><p id="b9ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大家好，欢迎来到令人兴奋的计算机视觉世界，这里的乐趣永无止境。</p><p id="75e3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天，我们将了解如何在视频中检测人脸。在这里，我们将使用主要的网络摄像头用于学习目的，它肯定可以替换为任何视频文件。</p><p id="0f65" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，让我们开始行动吧！</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="2259" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated"><strong class="ak">先决条件:</strong></h2><p id="40dc" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated"><strong class="is hj">1—OpenCV<br/>2—Haar scade XML文件</strong></p><h2 id="048f" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated"><strong class="ak">步骤:</strong></h2><p id="21a6" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">1 —让我们首先打开网络摄像头，阅读视频馈送并在窗口中显示。</p><p id="2e1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2 —添加一个条件，帮助我们退出视频馈送并关闭步骤1中使用的显示窗口。</p><p id="53be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3-检测面部并在面部周围绘制一个矩形。</p><p id="a3d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用这些步骤，我们就大功告成了。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="c989" class="jv jw hi la b fi le lf l lg lh">import cv2<br/>cap = cv2.VideoCapture(0)<br/>while True:<br/>    ret, img = cap.read()<br/>    cv2.imshow('Video feed', img)<br/>    key = cv2.waitKey(30) &amp; 0xff<br/>    if key == 27:<br/>        break<br/>cap.release()<br/>cv2.destroyAllWindows()</span></pre><p id="bdf5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码通知导入cv2 (opencv)进行进一步的处理。在下一行中，我们通过将0作为参数来打开主网络摄像头。如果您有一个辅助摄像头，您可以将0更改为1。</p><p id="4bbd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一行有一个无限循环，表示在没有遇到中断条件之前，将视频提要保持在显示窗口中。</p><p id="542f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个循环中，我们读取VideoCapture接收到的任何内容，并通过使用imshow将其显示在一个名为“Video Feed”的窗口中。</p><p id="b4eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们添加一个中断条件，就像按下“ESC”键一样，然后中断循环，将它带到最后一行，以释放网络摄像头并破坏显示窗口。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="e6ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4 —现在是最后一步，让我们来检测人脸。对于这一步，我们将使用下面一行代码加载一个Haarcascade ' Haarcascade _ frontal face _ default . XML'。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="82b6" class="jv jw hi la b fi le lf l lg lh">face_cascade = cv2.CascadeClassifier('haarcascade_frontalface_default.xml')</span></pre><p id="25b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5-为了避免任何干扰，我们将使用下面一行代码将从网络摄像头读取的图像转换为灰度。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1105" class="jv jw hi la b fi le lf l lg lh">gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span></pre><p id="1177" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6-我们将使用下面一行代码使用灰度图像来检测人脸。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="57ac" class="jv jw hi la b fi le lf l lg lh">faces = face_cascade.detectMultiScale(gray, 1.3, 5)</span></pre><p id="3e69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">faces变量将具有长度、宽度、高度和宽度。</p><p id="45e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7-我们将使用这些坐标绘制一个矩形，如下图所示。</p><p id="4a31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8-绘制矩形时传递的参数是实际图像、起点坐标、终点坐标、要使用的颜色、边框宽度。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="5857" class="jv jw hi la b fi le lf l lg lh">for (x, y, w, h) in faces:<br/> cv2.rectangle(img, (x, y), (x+w, y+h), (0,255,0), 2)</span></pre><p id="2c14" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就是这样，我们成功地用python写了一个人脸检测程序。恭喜你！！参见下面的完整代码。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="be91" class="jv jw hi la b fi le lf l lg lh">import cv2</span><span id="19d5" class="jv jw hi la b fi li lf l lg lh">face_cascade = cv2.CascadeClassifier(‘haarcascade_frontalface_default.xml’)</span><span id="0a41" class="jv jw hi la b fi li lf l lg lh">cap = cv2.VideoCapture(0)</span><span id="1d5c" class="jv jw hi la b fi li lf l lg lh">while True:<br/>    ret, img = cap.read()</span><span id="6e9a" class="jv jw hi la b fi li lf l lg lh">    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span><span id="e3a6" class="jv jw hi la b fi li lf l lg lh">    faces = face_cascade.detectMultiScale(gray, 1.3, 5)</span><span id="5b42" class="jv jw hi la b fi li lf l lg lh">    for (x, y, w, h) in faces:<br/>        cv2.rectangle(img, (x, y), (x+w, y+h), (0,255,0), 2)</span><span id="3946" class="jv jw hi la b fi li lf l lg lh">    cv2.imshow(‘image window’, img)</span><span id="1782" class="jv jw hi la b fi li lf l lg lh">    k = cv2.waitKey(30) &amp; 0xff</span><span id="e6e3" class="jv jw hi la b fi li lf l lg lh">    if k == 27:<br/>        break</span><span id="e686" class="jv jw hi la b fi li lf l lg lh">cap.release()<br/>cv2.destroyAllWindows()</span></pre><p id="7a9c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢您访问这篇文章，希望您喜欢。请在下面的评论部分分享您的反馈。直到下一次。</p><p id="9c59" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最诚挚的问候</p></div></div>    
</body>
</html>