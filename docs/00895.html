<html>
<head>
<title>Everything you need to know to train your custom object detector model using YOLOv3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用YOLOv3训练自定义对象检测器模型所需的一切</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/everything-you-need-to-know-to-train-your-custom-object-detector-model-using-yolov3-1bf0640b0905?source=collection_archive---------0-----------------------#2019-09-17">https://medium.com/analytics-vidhya/everything-you-need-to-know-to-train-your-custom-object-detector-model-using-yolov3-1bf0640b0905?source=collection_archive---------0-----------------------#2019-09-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3e86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我们将学习如何使用<a class="ae jd" href="https://pjreddie.com/darknet/" rel="noopener ugc nofollow" target="_blank"> Darknet </a>框架在自定义数据集上训练<a class="ae jd" href="https://pjreddie.com/darknet/yolo/" rel="noopener ugc nofollow" target="_blank"> YOLOv3 </a>。之后，这将有足够的关于物体检测的知识，你可以根据你的需要和游戏来调整它。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/875d66d4aec06a39e133428b398e5539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8KqdQiw8jr4xCrFUWQAZg.png"/></div></div></figure><p id="56cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用下面的方法从A到Z。(为了更好地理解，请确保您遵循了每一步。)</p><blockquote class="jq jr js"><p id="5a58" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated"><strong class="ih hj">什么是物体探测？</strong></p><p id="f3c2" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated"><strong class="ih hj">可用的物体检测算法</strong></p><p id="2e22" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated"><strong class="ih hj">为什么是YoloV3？</strong></p><p id="decc" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated"><strong class="ih hj">图像标注</strong></p><p id="69b5" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated"><strong class="ih hj">安装</strong></p><p id="9003" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated"><strong class="ih hj">最后，训练模型。</strong></p></blockquote></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><p id="2361" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是目标检测，为什么它会受到如此多的关注？</strong></p><p id="b414" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对象检测是一种计算机视觉技术，用于定位图像或视频中的对象实例。对象检测算法通常利用机器学习和深度学习来产生有意义的结果。当人类观看图像或视频时，我们可以在瞬间识别并定位感兴趣的对象。物体检测的目标是使用计算机复制这种智能。</p><p id="fdc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用例层出不穷，无论是<strong class="ih hj">追踪物体</strong>、<strong class="ih hj">视频监控</strong>、<strong class="ih hj">行人检测</strong>、<strong class="ih hj">异常检测</strong>、<strong class="ih hj">人数统计</strong>、<strong class="ih hj">自动驾驶汽车</strong>还是<strong class="ih hj">人脸检测</strong>，不胜枚举。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ke"><img src="../Images/2ca57f08bd64a9405cc86b8e63eaef1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*OHlBv6CJfJen_18EFWWNmQ.gif"/></div></figure></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><p id="d1cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">物体检测算法:</strong></p><p id="701f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是工业中用于对象检测的一些常见模型架构。</p><ul class=""><li id="16d3" class="kf kg hi ih b ii ij im in iq kh iu ki iy kj jc kk kl km kn bi translated"><strong class="ih hj">更快的R-CNN </strong></li><li id="7d40" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc kk kl km kn bi translated"><strong class="ih hj"> YOLO(你只看一次)</strong></li><li id="137e" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc kk kl km kn bi translated"><strong class="ih hj"> SSD(单发多盒防守器)</strong></li></ul><p id="1fce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有更多像R-CNN，Fast R-CNN，Mask R-CNN(是的他们是不同的)。我们必须根据我们的需求来决定使用哪一种，每一种都有其优缺点。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/2821fc39f2ff954c5714abc79a1b3a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1ri4SvI_oBzSd02WlW09g.png"/></div></div></figure><p id="d52c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不会在这里深入讨论每一个具体的算法，如果你想知道更多，请在评论区告诉我。但是对于你的基本理解，请看下图。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ku"><img src="../Images/ac625c73900bd3326439c07238660fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q6GXy52crw3E4RHxgn1oWg.png"/></div></div></figure></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><p id="1ecc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">YOLO——你只看一次</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kv"><img src="../Images/b88db94dc4f29889814fa6ea21e5b842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GMPHIkNmB6LhlcxGGMMyTg.png"/></div></div></figure><p id="55b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">YOLO是如何运作的？我们把一幅图像分割成一个SxS网格，在每个网格中我们有m个边界框。对于每个边界框，网络输出该边界框的类概率和偏移值。具有高于阈值的分类概率的边界框被选择并用于定位图像内的对象。</p><p id="2462" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有其他对象检测算法都使用区域来定位图像中的对象。网络不会看到完整的图像。取而代之的是图像中包含物体的概率较高的部分。<strong class="ih hj"/>或【只看一次】是一种与<a class="ae jd" href="http://ai.stanford.edu/~tianshig/papers/nips09-sceneObject.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">基于区域的算法</strong> </a>有很大不同的物体检测算法。在YOLO，单个卷积网络预测边界框和这些框的类别概率。</p><p id="1ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如果你想深入Yolo，看看各层是如何工作的，可以参考这份官方的</strong> <a class="ae jd" href="https://pjreddie.com/media/files/papers/YOLOv3.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">研究论文</strong> </a> <strong class="ih hj">。</strong></p><h1 id="0420" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">YOLO的优势和劣势</h1><ul class=""><li id="aaed" class="kf kg hi ih b ii lu im lv iq lw iu lx iy ly jc kk kl km kn bi translated">YOLO比其他物体检测算法快几个数量级(每秒45帧)。</li><li id="aed5" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc kk kl km kn bi translated">YOLO算法的局限性在于它会与图像中的小对象进行斗争，例如，它可能很难检测到一群鸟。这是由于算法的空间限制。</li></ul></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><p id="0587" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据收集和标注</strong></p><p id="5fe8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经有了关于对象检测和Yolo的基本信息，让我们进入最繁琐的任务，即<strong class="ih hj">获取用于训练和测试的数据。</strong>如果你不想弄乱数据处理部分你可以使用来自<a class="ae jd" href="https://github.com/tahaemara/yolo-custom-object-detector/tree/master/python/Dataset" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">这里的</strong> </a> <strong class="ih hj">的魔方图片和标签。</strong></p><p id="d99b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想在你自己的数据集上训练模型，你可以从<a class="ae jd" href="https://www.kaggle.com/datasets" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>获取图像和标签。对于Yolo中的培训，注释需要在。txt格式。如果您有XML格式的注释，您可以将它们更改为Yolo。txt格式使用这个<a class="ae jd" href="https://github.com/mukundsharma1995/yolov3-object-detection/blob/master/xml_to_txt.py" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">脚本</strong> </a>虽然不完美但是解决了目的。只要换19号线和26号线，你就可以走了。</p><p id="22c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果这个脚本不起作用，你可以试试我在其他 <a class="ae jd" href="https://github.com/ManivannanMurugavel/YOLO-Annotation-Tool/blob/master/convert.py" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">博客</strong> </a> <strong class="ih hj">上找到的脚本。</strong></p><p id="ed3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Yolo的注释文件类似于:</p><blockquote class="lz"><p id="b9c4" class="ma mb hi bd mc md me mf mg mh mi jc dx">0 0.332853 0.575862 0.210375 0.489655</p></blockquote><p id="40d1" class="pw-post-body-paragraph if ig hi ih b ii mj ik il im mk io ip iq ml is it iu mm iw ix iy mn ja jb jc hb bi translated">注释过程为每个图像生成一个文本文件，其中包含每个对象的对象类别号和坐标，每个对象的每一行都是这种格式“(对象id)(x-中心)(y-中心)(宽度)(高度)”。坐标值(x、y、宽度和高度)相对于图像的宽度和高度。</p><p id="b720" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你从谷歌或任何其他来源下载图像，你需要一个工具来注释图像，<a class="ae jd" href="https://github.com/tzutalin/labelImg" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> LabelImg </strong> </a> <strong class="ih hj"> </strong>工具<strong class="ih hj"> </strong>将解决这个问题，因为它安装起来既快又容易。</p><h2 id="8af1" class="mo kx hi bd ky mp mq mr lc ms mt mu lg iq mv mw lk iu mx my lo iy mz na ls nb bi translated">使用LabelImg注释图像的步骤:</h2><ol class=""><li id="d563" class="kf kg hi ih b ii lu im lv iq lw iu lx iy ly jc nc kl km kn bi translated">创建一个包含图像的文件夹，并将其命名为“图像”。</li><li id="8869" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">为注释文件创建一个文件夹，并将其命名为“标签”。<strong class="ih hj">文件夹“图像”和“标签”必须在同一目录下。</strong></li><li id="6736" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">打开标签应用程序。</li><li id="3fd6" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">点击“打开目录”,然后选择图像文件夹。</li><li id="2772" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">点击“更改保存目录”并选择标签文件夹。</li><li id="448f" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">在工具栏"保存"按钮的正下方，单击" PascalVOC "按钮切换到YOLO格式。</li><li id="5fc6" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">你会发现所有的图像都列在文件列表面板中。</li><li id="3309" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">单击您想要注释的图像。</li><li id="9148" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">单击键盘上的字母“W ”,在所需的图像对象上绘制矩形，在弹出的窗口中键入对象的名称。</li><li id="ff12" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">单击“CTRL+S”将注释保存到标签文件夹。</li><li id="95d9" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">重复步骤8到10，直到完成对所有图像的注释。</li></ol><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es nd"><img src="../Images/3ae6e00fd24b41ed8ea23e5990774252.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SqnfWm2sSE_azhLCXCUKPw.png"/></div></div></figure><h1 id="017e" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">安装暗网</h1><p id="b3c9" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq ne is it iu nf iw ix iy ng ja jb jc hb bi translated">Darknet是一个开源的神经网络框架，支持CPU和GPU计算。</p><p id="dcbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装暗网:</p><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="efed" class="mo kx hi ni b fi nm nn l no np">git clone https://github.com/pjreddie/darknet<br/>cd darknet</span></pre><p id="e0de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有一个专门的GPU机器用于训练，那么这是很好的，如果你像我一样，你可以使用AWS来完成这个，我使用了一个spot实例(p2.xlarge)。如果您在AWS上设置GPU spot实例时需要任何帮助，请告诉我，我将单独发表一篇文章。<strong class="ih hj">我假设你们已经知道如何设置GPU机器。</strong></p><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="f2d6" class="mo kx hi ni b fi nm nn l no np">vim Makefile</span></pre><p id="d11c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(如果您正在使用GPU，请将GPU从0更改为1，如果您已经安装了OPENCV，请将OpenCV设置为“1”，否则不需要)</p><p id="8394" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">保存Makefile并运行根目录中的命令来启动构建过程。</p><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="9d02" class="mo kx hi ni b fi nm nn l no np">make</span></pre><p id="9a87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过运行以下命令，您可以检查所有内容是否编译正确</p><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="7750" class="mo kx hi ni b fi nm nn l no np">./darknet</span></pre><p id="37db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该会看到类似这样的内容:</p><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="027a" class="mo kx hi ni b fi nm nn l no np">usage: ./darknet &lt;function&gt;</span></pre><p id="c8b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您也可以参考<a class="ae jd" href="https://pjreddie.com/darknet/yolo/" rel="noopener ugc nofollow" target="_blank"> Yolo-Darknet </a>进行安装，并下载cfg和预训练重量。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><p id="6de0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">培训过程开始前</strong></p><p id="58bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在收集和注释数据集之后，我们在同一个目录中有两个文件夹:文件夹“<strong class="ih hj"> images </strong>”和文件夹“<strong class="ih hj"> labels </strong>”。</p><p id="5d6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">复制图像和标签文件夹中的所有内容，并将它们放在一个文件夹中。最后，<strong class="ih hj">将文件夹保存在暗网根目录</strong>下。</p><p id="73b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们需要通过提供两个文本文件将数据集分为训练集和测试集，一个包含训练集(<strong class="ih hj"> train.txt </strong>)和测试集(<strong class="ih hj"> test.txt </strong>)的图像路径</p><p id="3d1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可以通过使用<a class="ae jd" href="https://github.com/mukundsharma1995/yolov3-object-detection/blob/master/split_train_test.py" rel="noopener ugc nofollow" target="_blank">脚本</a>来完成，在这一步之后，你将让<strong class="ih hj"> train.txt </strong>和<strong class="ih hj"> test.txt </strong>在暗网根目录下复制它们。</p><p id="8a5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">train.txt和test.txt将类似于:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es nq"><img src="../Images/314a18ec632eaeec87ae06c11182f2da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ysKExW9ikeUae42oO_22xQ.png"/></div></div></figure><p id="5f47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">准备YoloV3配置文件</strong></p><p id="afe2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">YOLO需要某些特定的文件来知道如何训练和训练什么。</p><p id="f137" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要修改YOLOv3 tiny模型(<a class="ae jd" href="https://github.com/pjreddie/darknet/blob/master/cfg/yolov3-tiny.cfg" rel="noopener ugc nofollow" target="_blank"> yolov3-tiny.cfg </a>)来训练我们的定制检测器。这一修改包括:</p><ol class=""><li id="7992" class="kf kg hi ih b ii ij im in iq kh iu ki iy kj jc nc kl km kn bi translated">取消对第5、6和7行的注释，并将训练批次更改为64，子部分更改为2。</li><li id="ba0a" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">在每个yolo输出“[yolo]”之前更改卷积层“[卷积]”的过滤器数量，使得过滤器数量= # anchors x(5+# of classes)= 3 *(5+1)= 18。数字5是参数center_x、center_y、宽度、高度和对象分数的计数。因此，将第127行和第171行改为“filters=18”。</li><li id="72cd" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">对于每个yolo层[yolo],将类的数量改为1，如第135行和第177行所示。</li></ol><p id="ac03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还需要创建两个文件"<strong class="ih hj"> objects.names </strong>"，其名称暗示它包含类的名称，以及文件"<strong class="ih hj"> training.data </strong>"，它包含训练所需的参数。</p><ul class=""><li id="cd4b" class="kf kg hi ih b ii ij im in iq kh iu ki iy kj jc kk kl km kn bi translated"><em class="jt"> cfg/obj.data </em></li></ul><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="a56c" class="mo kx hi ni b fi nm nn l no np">classes= 1<br/>train  = ./darknet/train.txt  <br/>valid  = ./darknet/test.txt  <br/>names = ./darknet/cfg/objects.names  <br/>backup = ./darknet/backup/</span></pre><ul class=""><li id="a67d" class="kf kg hi ih b ii ij im in iq kh iu ki iy kj jc kk kl km kn bi translated"/></ul><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="09b6" class="mo kx hi ni b fi nm nn l no np">Rubiks Cube   #name you used while annotation</span></pre><p id="a9be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">确保将这三个文件保存在这个位置:<strong class="ih hj">。/darknet/cfg/ </strong></p><h2 id="a55f" class="mo kx hi bd ky mp mq mr lc ms mt mu lg iq mv mw lk iu mx my lo iy mz na ls nb bi translated">下载预训练卷积权重</h2><p id="8899" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq ne is it iu nf iw ix iy ng ja jb jc hb bi translated">为了训练YOLOv3，我们使用在Imagenet上预先训练的卷积权重。我们使用来自<a class="ae jd" href="https://pjreddie.com/darknet/imagenet/#darknet53" rel="noopener ugc nofollow" target="_blank">暗网53 </a>模型的权重。你可以在这里下载卷积层的权重<a class="ae jd" href="https://pjreddie.com/media/files/darknet53.conv.74" rel="noopener ugc nofollow" target="_blank">(76mb)</a>并把它放在暗网的主目录中。</p><p id="4ce3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">开始训练</strong></p><p id="e533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有趣的部分到了！在你的终端中输入下面的命令，观察你的GPU做它最擅长的事情</p><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="4f57" class="mo kx hi ni b fi nm nn l no np">./darknet detector train cfg/obj.data cfg/yolov3-tiny.cfg darknet53.conv.74</span></pre><h2 id="e978" class="mo kx hi bd ky mp mq mr lc ms mt mu lg iq mv mw lk iu mx my lo iy mz na ls nb bi translated">笔记</h2><ol class=""><li id="f996" class="kf kg hi ih b ii lu im lv iq lw iu lx iy ly jc nc kl km kn bi translated">权重将每100次迭代保存在备份文件夹中，直到900次，然后每10000次。</li><li id="4da0" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc nc kl km kn bi translated">一旦平均损失小于0.06，或者一旦avg值不再增加，就杀死训练过程。</li></ol><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="3583" class="mo kx hi ni b fi nm nn l no np">Region 23 Avg IOU: 0.880141, Class: 0.999959, Obj: 0.999842, No Obj: 0.000690, .5R: 1.000000, .75R: 1.000000,  count: 1498591: 0.033501, <strong class="ni hj">0.063296 avg</strong>, 0.000010 rate, 0.004106 seconds, 498591 images<br/>Loaded: 0.003061 seconds</span></pre><h1 id="9ddd" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结果</h1><p id="35f1" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq ne is it iu nf iw ix iy ng ja jb jc hb bi translated">我们现在应该有<em class="jt">。对备份目录中代表我们的训练模型的</em>文件进行加权。让我们在一些图像上使用它，看看它能多好地检测它被训练的对象。</p><pre class="jf jg jh ji fd nh ni nj nk aw nl bi"><span id="1a43" class="mo kx hi ni b fi nm nn l no np">./darknet detector test cfg/obj.data cfg/yolov3-tiny.cfg backup/yolov3-tiny_900.weights<em class="jt"> data/rubicks</em>.jpg</span></pre><p id="2f33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以选择一些有趣的图像来展示您的检测设置的性能。没有在训练中使用的图像，我们在这里没有作弊。</p><p id="0850" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果结果不符合你的预期，是时候让你知道如何学习了。</p><p id="58e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想改变重量保存的速度，你可以在cfg文件中使用“步骤”。</p><p id="99dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如果你需要一个可以在网络摄像头上作为实时检测器的脚本，你可以试试这个</strong> <a class="ae jd" href="https://github.com/mukundsharma1995/yolov3-object-detection/blob/master/video.py" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">脚本</strong> </a> <strong class="ih hj">，你只需要提供yolov3.weights，yolov3-tiny.cfg和objects.names作为参数。</strong></p><p id="2db5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong>:这是针对单个物体检测。请使用此<a class="ae jd" rel="noopener" href="/@manivannan_data/how-to-train-multiple-objects-in-yolov2-using-your-own-dataset-2b4fee898f17">链接</a>进行多对象训练。谢谢，祝您愉快。</p><p id="ef77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">详细了解可以参考的有用博客:</strong></p><p id="3a15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" rel="noopener" href="/@manivannan_data/how-to-train-yolov2-to-detect-custom-objects-9010df784f36">在YoloV2中训练自定义对象检测</a></p><p id="fe1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" rel="noopener" href="/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088">Yolo、YoloV2、YoloV3有何不同？</a></p><p id="f814" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="http://emaraic.com/blog/yolov3-custom-object-detector" rel="noopener ugc nofollow" target="_blank">魔方博客参考这个</a></p><p id="4d9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" rel="noopener" href="/@fractaldle/brief-overview-on-object-detection-algorithms-ec516929be93">物体检测算法详解</a></p></div></div>    
</body>
</html>