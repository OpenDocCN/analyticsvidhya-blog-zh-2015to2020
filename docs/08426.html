<html>
<head>
<title>Converting WhatsApp chat data into a Word Cloud | Python | Simple Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将WhatsApp聊天数据转换为单词云| Python |简单方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/converting-whatsapp-chat-data-into-a-word-cloud-python-simple-way-1f003b03f5f9?source=collection_archive---------10-----------------------#2020-07-29">https://medium.com/analytics-vidhya/converting-whatsapp-chat-data-into-a-word-cloud-python-simple-way-1f003b03f5f9?source=collection_archive---------10-----------------------#2020-07-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/15de05e7c8263bfd46a9619d8878c2e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_vrKljwaysa0ZoHJoqYvw.jpeg"/></div></div></figure><div class=""/><figure class="ev ex ir is it hk er es paragraph-image"><div class="er es iq"><img src="../Images/31c2fe0bb3eacbfa600a84200ada54da.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*pw3inFqa2-3uoVfG-wO7Wg.jpeg"/></div></figure><p id="8fa3" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我在学习熊猫及其应用时，偶然发现了python中的word cloud模块。</p><p id="ec0d" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我们继续之前，我想浏览一下我们将使用的模块，即pandas、matplotlib和word cloud。</p><p id="3dca" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以，<strong class="iw hu"> pandas </strong>是一个为Python编程语言编写的软件库，用于数据操作和分析。</p><p id="538f" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu"> matplotlib </strong>。<strong class="iw hu"> pyplot </strong>是使<strong class="iw hu"> matplotlib </strong>像MATLAB一样工作的函数集合。</p><p id="8dfe" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">MATLAB用于在一个易于使用的环境中集成计算、可视化和编程。</p><p id="ab12" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu">单词云</strong>或标签云是一种数据可视化技术，用于表示文本数据，其中每个单词的大小表明其频率或重要性。</p><p id="1ed7" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu">停用词</strong>是对句子没有多大意义的英语单词。它们可以被安全地忽略，而不会牺牲句子的意义。例如，像the，he，have等这样的词。</p><p id="971d" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们开始吧。</p><p id="7a79" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu"> 1)导出WhatsApp聊天</strong></p><p id="bf14" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当我这样做的时候，我得到了一个. txt文件。</p><p id="f192" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">(WhatsAppChat.txt)</p><p id="84a1" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2)转换。txt文件到。csv文件</p><p id="7219" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了做到这一点，我用了熊猫。</p><p id="b461" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我在我的计划中引进了熊猫。然后，我创建了一个数据帧来读取。txt文件。的。txt文件没有像。csv文件。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="16b4" class="kb kc ht jx b fi kd ke l kf kg">import pandas as pd</span><span id="d431" class="kb kc ht jx b fi kh ke l kf kg">df=pd.read_csv(r”WhatsAppChat.txt”,header=None,error_bad_lines=False,encoding=’utf8’)</span></pre><p id="224e" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，我将数据分成列，方法是将它们分开并给每一列一个名称。聊天文件中数据集的第一行包含加密细节，这里不需要。所以，我在数据集中删除了那条线。然后，我将剩下的两个部分命名为Date和Convo，两个部分都用逗号分隔，即“，”。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="3037" class="kb kc ht jx b fi kd ke l kf kg">df= df.drop(0)<br/> df.columns=['Date', 'Convo']</span></pre><p id="e27c" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我将Convo数据集分为“时间”和“内容”两列，两列之间用连字符分隔，即“-”。Convo列中的数据被制成一个数据帧<strong class="iw hu"> Chat。</strong></p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="d14c" class="kb kc ht jx b fi kd ke l kf kg">Chat = df[“Convo”].str.split(“-“, n=1, expand=True)</span><span id="6c39" class="kb kc ht jx b fi kh ke l kf kg">df[‘Time’] = Chat[0]</span><span id="a383" class="kb kc ht jx b fi kh ke l kf kg">df[‘Content’] = Chat[1]</span></pre><p id="0c27" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">内容列被创建到另一个数据集<strong class="iw hu"> Chat1 </strong>中，以将其进一步分成两列，“用户”和“消息”，两列都用冒号分隔，即“:”。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="a1a1" class="kb kc ht jx b fi kd ke l kf kg">Chat1 = df[“Content”].str.split(“:”, n=1, expand=True)</span><span id="c480" class="kb kc ht jx b fi kh ke l kf kg">df[‘User’] = Chat1[0]</span><span id="9f7c" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’] = Chat1[1]</span></pre><p id="0f16" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，删除Convo列并将Message列转换为小写。所有列媒体省略的单元格和删除的消息都被替换为字符串“媒体共享”和“删除的消息”。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="b928" class="kb kc ht jx b fi kd ke l kf kg">df=df.drop(columns=[‘Convo’])</span><span id="1951" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’] = df[‘Message’].str.lower()</span><span id="eb12" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’]=df[‘Message’].str.replace(‘&lt;media omitted&gt;’, ’Media Shared’)</span><span id="1102" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’] = df[‘Message’].str.replace(‘this message was deleted’, ’DeletedMsg’)</span></pre><p id="6e81" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，将数据帧转换为名为“new_csv.csv”的. csv文件。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="1a31" class="kb kc ht jx b fi kd ke l kf kg">df.to_csv(“new_csv.csv”,index=False)</span></pre><p id="d851" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu">万岁！！！</strong></p><p id="82f6" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，。txt被转换成。csv文件。</p><p id="f8cf" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu">下一步</strong>:</p><p id="2a6a" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu"> 3)使用转换后的。csv聊天文件做一个文字云。</strong></p><p id="3e29" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为此我们需要word cloud和matplotlib.plyplot包。</p><p id="d9ec" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我导入了数据可视化和从聊天文件创建单词云所必需的包。</p><p id="b794" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">(附:确保你已经安装了它们。您可以使用“pip install <package name="">”命令来完成。)</package></p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="dcdc" class="kb kc ht jx b fi kd ke l kf kg">import   matplotlib.plyplot as mpl</span><span id="3bf3" class="kb kc ht jx b fi kh ke l kf kg">from worcloud import WordCloud,STOPWORDS</span></pre><p id="14cd" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我使用new_csv.csv文件从其中读取数据并创建数据框。</p><p id="ab7f" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我创建了一组停用词和一个变量来存储WordCloud函数生成的所有数据。我从包含所有聊天文本的消息列中提取数据，并将其转换为小写字符串。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="051a" class="kb kc ht jx b fi kd ke l kf kg">df1=pd.read_csv(“new_csv.csv”)</span><span id="9378" class="kb kc ht jx b fi kh ke l kf kg">stopwords=set(STOPWORDS)</span><span id="5e84" class="kb kc ht jx b fi kh ke l kf kg">words=’’.join(df1.Message.astype(str)).lower()</span><span id="b819" class="kb kc ht jx b fi kh ke l kf kg">wordcloud=WordCloud(stopwords=stopwords, min_font_size=10,background_color=’white’,   width=800,height=800,color_func=random_color_func).generate(words)</span></pre><p id="59d7" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，我创建了一个名为“random_color_func”的函数，用来给单词渲染随机的橙色。这是通过更改hsl(色调、饱和度、亮度)值来实现的。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="8c30" class="kb kc ht jx b fi kd ke l kf kg">def random_color_func(word=None, font_size=None, position=None,  orientation=None, font_path=None, random_state=None):</span><span id="ed50" class="kb kc ht jx b fi kh ke l kf kg">h = int(360.0 * 21.0 / 255.0)</span><span id="cda0" class="kb kc ht jx b fi kh ke l kf kg">s = int(100.0 * 255.0 / 255.0)</span><span id="e2ca" class="kb kc ht jx b fi kh ke l kf kg">l = int(100.0 * float(random_state.randint(60, 120)) / 255.0)</span></pre><p id="6f82" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，我用mpl对wordcloud变量中的单词进行了绘图和可视化。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="4d05" class="kb kc ht jx b fi kd ke l kf kg">mpl.figure(figsize=(8,8),facecolor=None)</span><span id="d3f9" class="kb kc ht jx b fi kh ke l kf kg">mpl.imshow(wordcloud, interpolation="bilinear")</span><span id="7579" class="kb kc ht jx b fi kh ke l kf kg">mpl.axis("off")</span><span id="cb1f" class="kb kc ht jx b fi kh ke l kf kg">mpl.tight_layout(pad=0)</span><span id="291b" class="kb kc ht jx b fi kh ke l kf kg">mpl.show()</span></pre><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es ki"><img src="../Images/f85d5eb3b13f2a426cb3f241e5ac1f78.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*r4zVrlruLxt2pYnwMDzRJQ.jpeg"/></div></figure><p id="fe51" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">WordCloud已生成。耶耶耶！！！</p><p id="35f7" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">完整的代码如下:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="16f4" class="kb kc ht jx b fi kd ke l kf kg">import pandas as pd</span><span id="115c" class="kb kc ht jx b fi kh ke l kf kg">import matplotlib.plyplot as mpl</span><span id="4a25" class="kb kc ht jx b fi kh ke l kf kg">from worcloud import WordCloud,STOPWORDS</span><span id="daab" class="kb kc ht jx b fi kh ke l kf kg">df=pd.read_csv(r”WhatsAppChat.txt”,header=None,error_bad_lines=False,encoding=’utf8’)</span><span id="f1b0" class="kb kc ht jx b fi kh ke l kf kg">df= df.drop(0)<br/> df.columns=['Date', 'Convo']</span><span id="5552" class="kb kc ht jx b fi kh ke l kf kg">Chat = df[“Convo”].str.split(“-“, n=1, expand=True)</span><span id="36fb" class="kb kc ht jx b fi kh ke l kf kg">df[‘Time’] = Chat[0]</span><span id="32bd" class="kb kc ht jx b fi kh ke l kf kg">df[‘Content’] = Chat[1]</span><span id="2e1c" class="kb kc ht jx b fi kh ke l kf kg">Chat1 = df[“Content”].str.split(“:”, n=1, expand=True)</span><span id="89cf" class="kb kc ht jx b fi kh ke l kf kg">df[‘User’] = Chat1[0]</span><span id="f090" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’] = Chat1[1]</span><span id="eecf" class="kb kc ht jx b fi kh ke l kf kg">df=df.drop(columns=[‘Convo’])</span><span id="678e" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’] = df[‘Message’].str.lower()</span><span id="f547" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’]=df[‘Message’].str.replace(‘&lt;media omitted&gt;’, ’Media Shared’)</span><span id="b6f0" class="kb kc ht jx b fi kh ke l kf kg">df[‘Message’] = df[‘Message’].str.replace(‘this message was deleted’, ’DeletedMsg’)</span><span id="08eb" class="kb kc ht jx b fi kh ke l kf kg">df.to_csv(“new_csv.csv”,index=False)</span><span id="b972" class="kb kc ht jx b fi kh ke l kf kg">def random_color_func(word=None, font_size=None, position=None,  orientation=None, font_path=None, random_state=None):</span><span id="2b80" class="kb kc ht jx b fi kh ke l kf kg">h = int(360.0 * 21.0 / 255.0)</span><span id="4206" class="kb kc ht jx b fi kh ke l kf kg">s = int(100.0 * 255.0 / 255.0)</span><span id="351f" class="kb kc ht jx b fi kh ke l kf kg">l = int(100.0 * float(random_state.randint(60, 120)) / 255.0)</span><span id="45be" class="kb kc ht jx b fi kh ke l kf kg">df1=pd.read_csv(“new_csv.csv”)</span><span id="c4db" class="kb kc ht jx b fi kh ke l kf kg">stopwords=set(STOPWORDS)</span><span id="7e72" class="kb kc ht jx b fi kh ke l kf kg">words=’’.join(df1.Message.astype(str)).lower()</span><span id="d59a" class="kb kc ht jx b fi kh ke l kf kg">wordcloud=WordCloud(stopwords=stopwords, min_font_size=10,background_color=’white’, width=800,height=800,color_func=random_color_func).generate(words)</span><span id="bab6" class="kb kc ht jx b fi kh ke l kf kg">mpl.figure(figsize=(8,8),facecolor=None)</span><span id="93e0" class="kb kc ht jx b fi kh ke l kf kg">mpl.imshow(wordcloud,interpolation="bilinear")</span><span id="6faa" class="kb kc ht jx b fi kh ke l kf kg">mpl.axis("off")</span><span id="b7ea" class="kb kc ht jx b fi kh ke l kf kg">mpl.tight_layout(pad=0)</span><span id="1e11" class="kb kc ht jx b fi kh ke l kf kg">mpl.show()</span></pre><p id="ca3d" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">感谢阅读。给一个👏如果你喜欢的话。</p><p id="6462" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae kj" href="https://www.geeksforgeeks.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hu">我也会很快在GeeksforGeeks </strong> </a>上发表</p><p id="6a70" class="pw-post-body-paragraph iu iv ht iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hu"> &lt; &gt;同♥.</strong></p></div></div>    
</body>
</html>