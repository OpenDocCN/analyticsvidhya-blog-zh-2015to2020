<html>
<head>
<title>Custom Object Detection With Tensorflow Using Google Colab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Colab的Tensorflow进行自定义对象检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/custom-object-detection-with-tensorflow-using-google-colab-7cbc484f83d7?source=collection_archive---------2-----------------------#2019-12-09">https://medium.com/analytics-vidhya/custom-object-detection-with-tensorflow-using-google-colab-7cbc484f83d7?source=collection_archive---------2-----------------------#2019-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/42c776dc62051cfea839ce7b8d8efa3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o8Khjem_Lvbe0p6a"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated"><a class="ae jc" href="https://unsplash.com/@ja_ma?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> ja ma </a>在<a class="ae jc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="25e4" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在这篇博文中，我们将使用Tensorflow对象检测API构建一个自定义的对象检测器。我会选择苹果果实的检测。但是你可以选择任何你想要的图像来检测你自己的自定义对象。</p><p id="3773" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">需要的步骤是:</strong></p><ol class=""><li id="d758" class="kb kc hi jf b jg jh jk jl jo kd js ke jw kf ka kg kh ki kj bi translated">装置</li><li id="1e27" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated">收集数据</li><li id="8bc7" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated">标签数据</li><li id="2c8b" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated">为培训生成TFRecords</li><li id="0e28" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated">配置培训</li><li id="c0d7" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated">培训模式</li><li id="de19" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated">导出推理图</li><li id="cb48" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated">测试对象检测器</li></ol><h1 id="0d40" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">装置</h1><p id="05aa" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">确保你有Python 3.6或更高版本。我已经在我的Ubuntu 18.04机器上做到了这一点。如果你使用的是Windows，那么这个过程会有一点不同。</p><p id="9edd" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你已经有了<strong class="jf hj"> <em class="ls"> pip </em> </strong>那么你就可以开始了。否则，通过以下方式安装<strong class="jf hj"> <em class="ls"> pip3 </em> </strong></p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="8358" class="ly kq hi lu b fi lz ma l mb mc">sudo apt install python3-pip</span></pre><h1 id="b09f" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">1.1张量流</h1><p id="db08" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">然后使用以下命令安装Tensorflow:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="cf62" class="ly kq hi lu b fi lz ma l mb mc">pip3 install tensorflow</span></pre><p id="df86" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果您有可以与Tensorflow一起使用的GPU:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="0550" class="ly kq hi lu b fi lz ma l mb mc">pip install tensorflow-gpu</span></pre><p id="3824" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">其余的库可以通过apt-get安装在Ubuntu 18.04上:</p><h1 id="6f75" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">1.2其他依赖关系</h1><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="a99f" class="ly kq hi lu b fi lz ma l mb mc">sudo apt-get install protobuf-compiler python3-pil python3-lxml python3-tk git</span></pre><p id="26bb" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">其他人</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="7424" class="ly kq hi lu b fi lz ma l mb mc">pip3 install pillow Cython lxml jupyter matplotlib contextlib2</span></pre><p id="32df" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">确保Cython已经安装，然后再做</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="eefe" class="ly kq hi lu b fi lz ma l mb mc">pip3 install pycocotools</span></pre><h1 id="43b6" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">1.3克隆Tensorflow模型库</h1><p id="8531" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">克隆TensorFlow模型库:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="7c51" class="ly kq hi lu b fi lz ma l mb mc">git clone <a class="ae jc" href="https://github.com/tensorflow/models.git" rel="noopener ugc nofollow" target="_blank">https://github.com/tensorflow/models.git</a></span></pre><p id="261b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">从此时起，该目录将被称为</strong> <code class="du md me mf lu b">models </code> <strong class="jf hj">目录。</strong></p><h1 id="2f52" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">1.4设置环境</h1><p id="ea61" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">在克隆了tf models repo之后，现在转到研究文件夹</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="8d2d" class="ly kq hi lu b fi lz ma l mb mc">cd models/research</span></pre><p id="3296" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> Protobuf编译</strong></p><p id="261d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Tensorflow对象检测API使用Protobufs来配置模型和训练参数。在使用框架之前，必须编译Protobuf库。这应该通过从tensorflow/models/research/目录运行以下命令来完成:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="9113" class="ly kq hi lu b fi lz ma l mb mc"># From tensorflow/models/research/<br/>protoc object_detection/protos/*.proto --python_out=.</span></pre><p id="471c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">向PYTHONPATH添加库</strong></p><p id="e92b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在本地运行时，tensorflow/models/research/和slim目录应该附加到PYTHONPATH中。这可以通过从tensorflow/models/research/运行以下命令来完成:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="55de" class="ly kq hi lu b fi lz ma l mb mc"># From tensorflow/models/research/<br/>export PYTHONPATH=$PYTHONPATH:`pwd`:`pwd`/slim</span></pre><p id="f0fd" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><em class="ls">注意:</em>这个命令需要在您启动的每个新终端上运行。如果您希望避免手动运行它，可以将它作为一个新行添加到~/的末尾。bashrc文件，用您系统上tensorflow/models/research的绝对路径替换<code class="du md me mf lu b">pwd</code>。</p><p id="dc5d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">物体检测安装</strong></p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="c298" class="ly kq hi lu b fi lz ma l mb mc"># From tensorflow/models/research/<br/>sudo python3 setup.py install</span></pre><p id="674d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">测试安装</strong></p><p id="4e41" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">您可以通过运行以下命令来测试是否正确安装了Tensorflow对象检测API:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="aed3" class="ly kq hi lu b fi lz ma l mb mc">python3 object_detection/builders/model_builder_test.py</span></pre><p id="349c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果结果如下所示，您就可以继续下一步了！</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="c7fd" class="ly kq hi lu b fi lz ma l mb mc">...............----------------------------------------------------------------------<br/><br/>Ran 15 tests in 0.120sOK</span></pre><h1 id="770b" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">收集数据</h1><p id="3e63" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated"><strong class="jf hj"> 2.1 </strong>打开你的谷歌chrome浏览器，安装一个名为<a class="ae jc" href="https://chrome.google.com/webstore/detail/download-all-images/ifipmflagepipjokmbdecpmjbibjnakm?hl=en" rel="noopener ugc nofollow" target="_blank">的扩展，下载所有图片</a></p><p id="229d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> 2.2 </strong>。现在在谷歌图片中搜索你想要的图片，在我的例子中，是“苹果”。现在点击浏览器右上角的“下载所有图片”扩展按钮。你会得到一个包含你的图片的zip文件。然后提取它。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mg"><img src="../Images/9e2e5e1481e41cbe47ca99e4ae17e2c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miaBZ6zD1i_JH3iCDvehYQ.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">苹果文件夹</figcaption></figure><h1 id="f205" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">标签数据</h1><p id="dd11" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">打开你的终端，安装<em class="ls">标签</em></p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="fcf7" class="ly kq hi lu b fi lz ma l mb mc">pip3 install labelImg</span></pre><p id="1a9b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">LabelImg是一个图形化的图像注释工具。</p><p id="e450" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">安装标签后，输入以下命令打开它</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="2152" class="ly kq hi lu b fi lz ma l mb mc">labelImg</span></pre><p id="d270" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在你的终端里</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mh"><img src="../Images/462b5eb01c8d95753d08adefac0b2a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OiCJO87VmS_dOkNiDPy82w.gif"/></div></div></figure><p id="a686" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">并且像我正在做的那样遵循上面的。对所有的图片都这样做。它正在做的是，生成一个XML文件，其中包含带有标签的对象坐标。</p><p id="caab" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我标记了大约100张图片。</p><p id="4e2f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在克隆我的仓库</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="33e7" class="ly kq hi lu b fi lz ma l mb mc">git clone https://github.com/TheCaffeineDev/Tensorflow-Object-Detection-API-With-Custom-Dataset.git</span></pre><p id="c779" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">克隆后进入目录。</p><p id="d52d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">您的目录结构应该如下所示:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="aab9" class="ly kq hi lu b fi lz ma l mb mc">├── ...<br/>    ├── data                 <br/>    ├── images<br/>    │   ├── train<br/>    │   ├── test<br/>    ├── utils<br/>    │	├── label_map_util.py<br/>    │	├── visualization_utils.py<br/>    ├── generate_tfrecord.py<br/>    └── object-detection.pbtxt<br/>    └── transform_image_resolution.py<br/>    └── xml_csv.py<br/>    └── webcam_inference.py</span></pre><h1 id="c1f8" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">为培训生成TFRecords</h1><p id="5b63" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">现在将70%的图像文件复制到训练文件夹<em class="ls"> images/train </em>中，剩下的30%复制到测试文件夹中。</p><p id="1ae8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">有了标记的图像，我们需要创建TFRecords，它可以作为目标检测器训练的输入数据。为了创建TFRecords，我们将使用来自<a class="ae jc" href="https://github.com/datitran/raccoon_dataset" rel="noopener ugc nofollow" target="_blank"> Dat Tran的浣熊检测器</a>的两个脚本。即<em class="ls"> xml_to_csv.py </em>和<em class="ls"> generate_tfrecord.py </em>文件。</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="8074" class="ly kq hi lu b fi lz ma l mb mc">├── ...<br/>├── data                 <br/>├── images<br/>│   ├── train<br/>│		├── image1.jpg<br/>│		├── image1.xml ..<br/>│   ├── test<br/>│		├── image5.jpg<br/>│		├── image5.xml ..<br/>├── generate_tfrecord.py<br/>└── object-detection.pbtxt<br/>└── transform_image_resolution.py<br/>└── xml_csv.py<br/>└── webcam_inference.py </span></pre><p id="21de" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在，在该文件夹中，我们可以通过打开命令行并键入以下命令，将XML文件转换为train_label.csv和test_label.csv:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="3c5a" class="ly kq hi lu b fi lz ma l mb mc">python xml_to_csv.py</span></pre><p id="88a1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这将在数据目录中创建两个文件。一个叫做<em class="ls"> test_labels.csv </em>，另一个叫做<em class="ls"> train_labels.csv </em>。</p><p id="57e3" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在我们能够将新创建的文件转换成TFRecords之前，我们需要修改<em class="ls"> generate_tfrecords.py </em>文件中的几行。</p><p id="f07c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">出发地:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="1349" class="ly kq hi lu b fi lz ma l mb mc"># TO-DO replace this with label map , replace with your own classes<br/>def class_text_to_int(row_label):<br/>    if row_label == 'apple':<br/>        return 1<br/>    else:<br/>        return 0</span></pre><p id="cc98" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你有多门课，</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="67ad" class="ly kq hi lu b fi lz ma l mb mc"># TO-DO replace this with label map<br/>def class_text_to_int(row_label):<br/>    if row_label == 'apple':<br/>        return 1<br/>    elif row_label == 'banana':<br/>        return 2<br/>    elif row_label == 'orange':<br/>        return 3<br/>    else:<br/>        return None</span></pre><p id="105c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在，您可以通过键入以下命令来生成TFRecords:</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="c214" class="ly kq hi lu b fi lz ma l mb mc">python3 generate_tfrecord.py --csv_input=data/train_labels.csv  --output_path=train.record --image_dir=images/train</span><span id="0714" class="ly kq hi lu b fi mi ma l mb mc">python3 generate_tfrecord.py --csv_input=data/test_labels.csv  --output_path=test.record --image_dir=images/test</span></pre><p id="f44f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这两个命令生成一个<em class="ls"> train.record </em>和一个<em class="ls"> test.record </em>文件，可用于训练我们的目标探测器。</p><h1 id="b449" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">配置培训</h1><p id="f22a" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">在训练之前，我们需要做的最后一件事是创建一个标签映射和一个训练配置文件。</p><h1 id="6fc1" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">创建标注地图</h1><p id="063d" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">标签映射将id映射到名称。我已经为培训创建了一个标签映射文件。看起来是这样的:</p><p id="5077" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">编辑<em class="ls"> object-detection.pbtxt </em></p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="ef50" class="ly kq hi lu b fi lz ma l mb mc">item{<br/>  id:1<br/>  name:"apple"<br/><br/>}</span></pre><p id="7d2a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果您使用多个类，请遵循这个模式。</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="6d65" class="ly kq hi lu b fi lz ma l mb mc">item {<br/>    id: 1<br/>    name: 'apple'<br/>}<br/>item {<br/>    id: 2<br/>    name: 'banana'<br/>}<br/>item {<br/>    id: 3<br/>    name: 'orange'<br/>}<br/>item {<br/>    id: 4<br/>    name: 'etc'<br/>}</span></pre><p id="e739" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">每个项目的id号应该与<em class="ls"> generate_tfrecord.py </em>文件中指定的id相匹配。</p><h1 id="8c35" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">创建培训配置</h1><p id="b509" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">我们将在Google Colab中训练我们的模型。</p><p id="722c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">请点击下面的链接。我已经做了适当的记录。</p><p id="6468" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><a class="ae jc" href="https://colab.research.google.com/drive/1o7JB0pWanEMn6qnRnEXphu0T4YbuKLL2" rel="noopener ugc nofollow" target="_blank">在Colab中打开</a></p><p id="a4ff" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我使用“SSD_MOBILENET_V2”进行训练，批量大小为4。您可以更改步骤的数量，使用哪个预训练模型&amp;批次和大小。</p><p id="9fcd" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">然后你需要运行下面的单元格。将有一个上传TF记录标题。下面你需要上传你生成的<em class="ls"> train.record </em>，<em class="ls">test . record</em>&amp;<em class="ls">object-detection . Pb txt</em>文件。</p><h1 id="fbd1" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">培训模式</h1><p id="ea38" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">上传完所有文件后，运行下面的单元格。它会被训练的。</p><h1 id="fddd" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">导出推理图</h1><p id="7fb8" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">如果你已经运行了所有的单元格，那么，最后，一个名为<em class="ls">frozen _ inference _ graph . Pb</em>file的文件将被下载。</p><h1 id="3443" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">测试对象检测器</h1><p id="a6db" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">现在将那个<em class="ls">freezed _ inference _ graph . Pb</em>文件复制到我的GitHub克隆文件夹中。然后你需要在那个<em class="ls"> webcam_inference.py </em>中编辑一些东西来测试你自己的物体检测器。打开文件并检查代码。我已经提到你需要改变的线。你几乎可以做到。</p><p id="68db" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果您正确遵循了上述所有步骤，那么您将能够通过网络摄像头测试您的模型。</p><h1 id="a982" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结论</h1><p id="1a77" class="pw-post-body-paragraph jd je hi jf b jg ln ji jj jk lo jm jn jo lp jq jr js lq ju jv jw lr jy jz ka hb bi translated">Tensorflow对象检测API允许您使用迁移学习技术创建自己的对象检测器。</p><p id="c055" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">下面是抢码链接。</p><p id="7282" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><a class="ae jc" href="https://github.com/TheCaffeineDev/Tensorflow-Object-Detection-API-With-Custom-Dataset" rel="noopener ugc nofollow" target="_blank"> Github回购</a></p><p id="7dc0" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你有任何问题、建议或批评，可以通过推特或邮件联系我。</p><p id="a52e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><em class="ls">原贴于我的</em> <a class="ae jc" href="https://thecodemonk.in/software/object-detection" rel="noopener ugc nofollow" target="_blank"> <em class="ls">博客</em> </a> <em class="ls">。</em></p><p id="2bc0" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">谢谢你</p><h1 id="f9ad" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">参考</h1><ol class=""><li id="14e0" class="kb kc hi jf b jg ln jk lo jo mj js mk jw ml ka kg kh ki kj bi translated"><a class="ae jc" href="https://github.com/tensorflow/models/tree/master/research/object_detection" rel="noopener ugc nofollow" target="_blank">https://github . com/tensor flow/models/tree/master/research/object _ detection</a></li><li id="15ba" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated"><a class="ae jc" rel="noopener" href="/@WuStangDan/step-by-step-tensorflow-object-detection-api-tutorial-part-1-selecting-a-model-a02b6aabe39e">https://medium . com/@ WuStangDan/step-by-step-tensor flow-object-detection-API-tutorial-part-1-selecting-a-model-a 02 b 6 aabe 39 e</a></li><li id="4bd7" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated"><a class="ae jc" href="https://pythonprogramming.net/introduction-use-tensorflow-object-detection-api-tutorial/" rel="noopener ugc nofollow" target="_blank">https://python programming . net/introduction-use-tensor flow-object-detection-API-tutorial/</a></li><li id="d7f8" class="kb kc hi jf b jg kk jk kl jo km js kn jw ko ka kg kh ki kj bi translated"><a class="ae jc" href="https://towardsdatascience.com/creating-your-own-object-detector-ad69dda69c85" rel="noopener" target="_blank">https://towards data science . com/creating-your-own-object-detector-ad 69 DDA 69 c 85</a></li></ol></div></div>    
</body>
</html>