<html>
<head>
<title>Predictive Modelling Using ANN with Python Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用人工神经网络和Python进行预测建模第3部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predictive-modelling-using-ann-with-python-part-3-a0cbdefbec2?source=collection_archive---------8-----------------------#2020-03-08">https://medium.com/analytics-vidhya/predictive-modelling-using-ann-with-python-part-3-a0cbdefbec2?source=collection_archive---------8-----------------------#2020-03-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="69d2" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak"> <em class="ix">预测建模使用安·基里尔·叶列缅科</em> </strong></h2></div><p id="1755" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">大家好:)又回来了，我已经很久没有写我们的人工神经网络预测模型的第三部分了，呵呵呵。</p><p id="289a" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">因此，今天我将继续我们的ML旅程的下一部分，在第一和第二部分中，我们进行数据预处理，在这一部分中，我们需要建立我们的神经网络架构，有许多种神经网络架构，您可以在此图中看到:</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/65057e544a64c645aaee50b6f883188f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UM0W8txUM4tR1ygERzn9Nw.png"/></div></div></figure><p id="8ae3" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">从简单的<em class="kg">(单层感知器)</em>到高级架构，我们可以使用的架构种类太多了，但在本教程中，我们将使用输入层有11个节点的ANN，2个隐藏层有6个节点，输出层有单个节点<em class="kg">(因为我们只需要1个值，它是预测值)</em></p><p id="cd80" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">要创建一个架构，第一步是我们需要导入库</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kh"><img src="../Images/b8da2733c1f7758ea6347900f2394f9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNxBS05lTpgDRQhwqAXwZg.png"/></div></div></figure><p id="86bd" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">然后用这段代码构建架构</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ki"><img src="../Images/9ddf8f25bd91dd6b42a62d18cd6276c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ge-f7yxPYCISiKyVRQqVQg.png"/></div></div></figure><p id="cdf7" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">通过这些步骤，我们已经完成了构建我们人工神经网络体系结构，它看起来像这样</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es kj"><img src="../Images/485a1ff62b74e0040292ca6e87bbf1b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*C_BKNyvKBwuhXmd9S1Pfiw.png"/></div></figure><p id="96a7" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在我们建立了人工神经网络体系结构之后的下一步，我们需要编译神经网络模型，编写以下代码</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es kk"><img src="../Images/564c5902ea07c6ac0039cc6ee9fd7163.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*B1x4E__frygBZAi508SCyQ.png"/></div></figure><p id="6056" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">第一个参数(optimizer = adam)是随机梯度下降的类型，它对于找到最佳权重非常有效。</p><p id="dfd4" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">第二个参数是损失函数，损失函数是误差平方和<br/>如果我们有二进制结果，对数损失函数称为binary_crossentropy，如果大于2，则称为categorical _ crossentropy。</p><p id="d892" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">第三个参数是指标(我们选择用来评估模型的标准)，为了提高模型性能，我们使用了准确性标准。</p><p id="d080" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">最后一步是我们需要训练之前准备的所有数据，在您的IDE上编写此代码。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kl"><img src="../Images/41782fe520d339fc4e0e1296c426f2e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQb_cYHXVEO_yWTWvQTTVQ.png"/></div></div></figure><p id="8328" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">稍等片刻:)，我们得到训练过程的准确率为0.8624 = 86.24%</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es km"><img src="../Images/4925c1792f1d109e628b53748ceec94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*zYnivARDcSN1WY4Gjt1PpQ.png"/></div></figure><p id="ef70" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在所有的过程完成后，我们可以找到Y_predict的结果，并找到我们的ML与混淆度量的真正准确性。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kn"><img src="../Images/c7230ae27cad6a396bf49651c298f955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1Mz_vD5u84qDhUCt2B17g.png"/></div></div></figure><p id="b225" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们会得到这样的结果</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es ko"><img src="../Images/299bdaf993ba9b4f8be0546ea523c1e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*amArujNd9yz9HSBVCR9mwg.png"/></div></figure><p id="ed30" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">为了找到我们的ML模型的真实精度，我们使用公式<em class="kg"> (TP+FN)/sum_of_test_data，(</em> 1490+228)/2000 = 0.859，因此我们得到的真实精度是85.9%</p><p id="87f1" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">所以大家:)这就是我们今天使用人工神经网络进行预测建模的全部教程，非常感谢你阅读了我的全部文章，如果我的代码或其他代码中有错误，我很抱歉，下一期教程再见，:D</p><p id="17dd" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">请参见以下URL中的第1部分和第2部分:</p><p id="ae9b" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><a class="ae kp" rel="noopener" href="/@bayysp/predictive-modelling-using-ann-with-python-ab701f3199dc">第一部分</a> <br/> <a class="ae kp" rel="noopener" href="/@bayysp/predictive-modelling-using-ann-with-python-part-2-734291d3f241">第二部分</a></p><p id="94c0" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">下面是这个URL中的代码:</p><p id="dfb0" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><a class="ae kp" href="http://github.com/bayysp/PredictiveModelANN" rel="noopener ugc nofollow" target="_blank">github.com/bayysp/PredictiveModelANN</a></p></div></div>    
</body>
</html>