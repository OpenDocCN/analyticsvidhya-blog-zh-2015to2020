<html>
<head>
<title>Stretched Exponential Decay function for Epsilon Greedy Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ε贪婪算法的拉伸指数衰减函数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/stretched-exponential-decay-function-for-epsilon-greedy-algorithm-98da6224c22f?source=collection_archive---------7-----------------------#2020-05-03">https://medium.com/analytics-vidhya/stretched-exponential-decay-function-for-epsilon-greedy-algorithm-98da6224c22f?source=collection_archive---------7-----------------------#2020-05-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="20de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在从事强化学习(RL)项目时，我一直在寻找一个衰减函数，它可以为RL代理提供以下特性</p><ol class=""><li id="fe0e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">在剧集的开始部分有更多的探索时间</li><li id="ac2f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">在剧集结尾进行随机探索，实现更多开发(准确定性策略)</li><li id="a1c7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">从勘探转换到开采时平滑梯度</li></ol><p id="1430" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然网上有好几个资源，但我找不到与我要找的功能最匹配的。所以我最后自己发明了一个衰变函数。我还知道了这种衰减函数叫做拉伸指数衰减</p></div><div class="ab cl jr js gp jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="hb hc hd he hf"><h2 id="5c7f" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">拉伸指数衰减的表达式</h2><p id="2c05" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">在python中，代码看起来像这样:</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="5c16" class="jy jz hi ld b fi lh li l lj lk">A=0.5<br/>B=0.1<br/>C=0.1<br/>def epsilon(time):<br/>    standardized_time=(time-A*EPISODES)/(B*EPISODES)<br/>    cosh=np.cosh(math.exp(-standardized_time))<br/>    epsilon=1.1-(1/cosh+(time*C/EPISODES))<br/>    return epsilon</span></pre><p id="fe43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的片段是我们将训练RL代理的迭代次数。此外，还有3个超参数:A、B和c。我们将在一会儿看看这个</p><p id="fa38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于上面的超级参数设置，衰减函数将如下所示:</p><figure class="ky kz la lb fd lm er es paragraph-image"><div class="er es ll"><img src="../Images/90212eb0a0f11de3bb18f7ea5a7a6469.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*RbxhBfEUWZsfynvf5cT0Vw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">集数=100，000 A=0.5，B=0.1，C=0.1</figcaption></figure><p id="ee08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图的左尾部具有大于1的ε值，当与ε贪婪算法结合时，将迫使代理探索更多</p><p id="c3ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图的右尾具有接近零的ε值，这有助于代理展现准确定性行为。这意味着代理将在剧集的后期开发更多，但是它也可以随机探索。想象一下，当部署一个RL代理人再次扮演人类对手时，如果代理人总是选择相同的最佳行动，代理人的行动总是可以被猜到的。所以这个衰减函数也可以用于这些情况。</p><p id="0021" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在图的左尾和右尾之间有一个过渡部分，它平滑地将代理行为从探索过渡到利用</p><p id="8743" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查衰减函数形状的代码</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="1926" class="jy jz hi ld b fi lh li l lj lk">new_time=list(range(0,EPISODES))<br/>y=[epsilon(time) for time in new_time]<br/>plt.plot(new_time,y)<br/>plt.ylabel('Epsilon')<br/>plt.title('Stretched Exponential Decay Function')</span></pre></div><div class="ab cl jr js gp jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="hb hc hd he hf"><h2 id="e216" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">衰减函数的超参数</h2><p id="bb03" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">参数A决定了我们希望代理在探索或开发上花费更多的时间。对于低于0.5的A值，代理人将花费更少的时间探索，更多的时间利用。对于0.5以上的A值，您可以期待代理探索更多</p><p id="e284" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">衰减函数对于A=0.3，图形的左尾已经缩短，因此代理将相对探索较短的持续时间</p><figure class="ky kz la lb fd lm er es paragraph-image"><div class="er es ll"><img src="../Images/1e346d84109a999107a7fdc4c5c17e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*SCAtYSzUgEEH6pT2C3EhiQ.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">对于A=0.3，左尾翼被缩短</figcaption></figure><p id="df56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">衰减函数A=0.7时，图形的左尾部变长，因此代理将探索更长的持续时间</p><figure class="ky kz la lb fd lm er es paragraph-image"><div class="er es ll"><img src="../Images/8e76c2d93d132486ae006cf24fb6061d.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*W6o3M6WG8OFBWH5LXBm5Pw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">对于A=0.5，左尾翼已经加长</figcaption></figure><p id="e6b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参数B决定了勘探区和开采区之间的过渡区的坡度</p><p id="c46f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当B为0.3时，斜率接近45度。我个人选择B=0.1</p><figure class="ky kz la lb fd lm er es paragraph-image"><div class="er es ll"><img src="../Images/19d3f1ecf89af5588d22ac3b1488d647.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*RcButRaRYYvkx4UGmBd9zg.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">B=0.3时，过渡部分的坡度= -45度</figcaption></figure><p id="523a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参数C控制图形左右尾部的陡度。C值越高，图形的左右尾部越陡。在这里，我也更喜欢使用C=0.1</p><figure class="ky kz la lb fd lm er es paragraph-image"><div class="er es lt"><img src="../Images/06c596fd79b48b6e838883ea6d4fad4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*wk2JPeS6wV-cUAI9_xQJrw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">当C=0.7时，左右尾部趋于变陡</figcaption></figure></div><div class="ab cl jr js gp jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="hb hc hd he hf"><h2 id="cc94" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">ε贪婪算法中衰减函数的配置</h2><p id="f80f" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">ε贪婪算法的代码如下</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="22f5" class="jy jz hi ld b fi lh li l lj lk">def epsilon_greedy(state, time):<br/>    <br/>    z = np.random.random() #provides a number less than 1<br/>    state=Q_state(state)   #state is provided by environment  <br/>    if z &gt; epsilon(time):<br/>    #for smaller epsilon values, the agent is forced to chose the best possible action</span><span id="0d79" class="jy jz hi ld b fi lu li l lj lk">        action = &lt;write your code to choose best possible action&gt; <br/>#Exploitation: this gets the action corresponding to max q-value of current state<br/>        <br/>    else:<br/># for larger epsilon values (close to 1), the agent is forced to explore by choosing a random action</span><span id="a7c7" class="jy jz hi ld b fi lu li l lj lk">        action = &lt;write your code to choose the a random action&gt;    #Exploration: randomly choosing and action<br/>    <br/>    return action</span></pre></div></div>    
</body>
</html>