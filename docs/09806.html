<html>
<head>
<title>Why pipenv over venv for Python projects?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么Python项目要用pipenv而不是venv？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/why-pipenv-over-venv-for-python-projects-a51fb6e4f31e?source=collection_archive---------4-----------------------#2020-09-21">https://medium.com/analytics-vidhya/why-pipenv-over-venv-for-python-projects-a51fb6e4f31e?source=collection_archive---------4-----------------------#2020-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/42ea55291a9002887bd3ec2549b6765e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*eR1TuGbdv6kK_QG5R8YDsw.png"/></div></figure><p id="6204" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">默认情况下，系统上的每个Python项目都将使用这些相同的目录来存储和检索站点包(第三方库)。<br/>但是您可能会发现，在您的本地机器上管理针对不同Python版本的具有不同依赖关系的不同项目是非常痛苦的。</p><p id="688e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这种情况下，<em class="jk">虚拟环境</em>的概念就来帮助我们了。如果你没有使用过或者不知道Python中的虚拟环境，让我先为你定义一下。</p><blockquote class="jl jm jn"><p id="e16c" class="im in jk io b ip iq ir is it iu iv iw jo iy iz ja jp jc jd je jq jg jh ji jj hb bi translated">虚拟环境是一种工具，通过为不同项目创建隔离的Python虚拟环境，有助于保持不同项目所需的依赖关系分离。</p></blockquote><p id="f34f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，基本上安装在本地机器上的Python( <em class="jk">父</em>)会在您的机器上产生另一个Python( <em class="jk">子</em>)，您可以将这个环境用于一个特定的项目。您可以在这个虚拟环境中安装或卸载依赖项，而不会影响安装在您的<em class="jk">父</em> Python中的依赖项。</p><p id="c2ae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建虚拟环境的一种常见方式是使用<code class="du jr js jt ju b">venv</code>。<em class="jk"> venv </em>模块预装了Python 3.5+版本。下面列出了一些使用<em class="jk"> venv </em>创建虚拟环境的重要命令:</p><h2 id="55a2" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">创建虚拟环境</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="81d9" class="jv jw hi ju b fi ky kz l la lb">python -m venv environment_name</span></pre><h2 id="e9e3" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">激活虚拟环境</h2><ul class=""><li id="380a" class="lc ld hi io b ip le it lf ix lg jb lh jf li jj lj lk ll lm bi translated">对于<strong class="io hj"> MacOS </strong>和<strong class="io hj"> Linux </strong>用户<strong class="io hj"> </strong>:</li></ul><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="6b7c" class="jv jw hi ju b fi ky kz l la lb">venv environment_name/bin/activate</span></pre><ul class=""><li id="cd3a" class="lc ld hi io b ip iq it iu ix ln jb lo jf lp jj lj lk ll lm bi translated">对于Windows用户，首先将您的目录更改为新创建的环境文件夹，然后运行以下命令:</li></ul><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="debb" class="jv jw hi ju b fi ky kz l la lb">..\environment_name\Scripts\activate</span></pre><h2 id="ba4f" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">停用虚拟环境</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="8418" class="jv jw hi ju b fi ky kz l la lb">deactivate</span></pre><h2 id="2cca" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">检查虚拟环境中安装的所有依赖项</h2><ul class=""><li id="5b6e" class="lc ld hi io b ip le it lf ix lg jb lh jf li jj lj lk ll lm bi translated">首先激活虚拟环境，然后使用以下命令查看该虚拟环境中安装的依赖项列表:</li></ul><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="0f38" class="jv jw hi ju b fi ky kz l la lb">pip freeze</span></pre><ul class=""><li id="bc18" class="lc ld hi io b ip iq it iu ix ln jb lo jf lp jj lj lk ll lm bi translated">生成一个<em class="jk"> requirements.txt </em>文件，该文件包含所有与它们各自版本的依赖关系:</li></ul><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="e958" class="jv jw hi ju b fi ky kz l la lb">pip freeze &gt; requirements.txt</span></pre><h2 id="fce4" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">从requirements.txt文件安装所有依赖项</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="b23b" class="jv jw hi ju b fi ky kz l la lb">pip install -r requirements.txt</span></pre></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><p id="f0e3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们转到<a class="ae lx" href="https://pipenv.pypa.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj"> Pipenv </strong> </a>，这已经成为管理项目依赖关系的推荐方法。代替在你的项目中有一个<code class="du jr js jt ju b">requirements.txt</code>文件，并管理虚拟环境，我们现在将在我们的项目中有一个<code class="du jr js jt ju b">Pipfile</code>自动做所有这些事情。如果您曾经使用过Node.js，您可能会熟悉<em class="jk"> package.json </em>和<em class="jk"> package-lock.json </em>文件。<em class="jk"> Pipfile </em>和<em class="jk"> Pipfile.lock </em>文件与Python中的类似。</p><h2 id="64ea" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">安装管道</h2><p id="76f9" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix ly iz ja jb lz jd je jf ma jh ji jj hb bi translated">让我们首先在本地机器上安装<em class="jk"> Pipenv </em>。使用以下命令来完成此操作:</p><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="abf3" class="jv jw hi ju b fi ky kz l la lb">pip install pipenv</span></pre><h2 id="3ef9" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">第一次使用pipenv</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="af31" class="jv jw hi ju b fi ky kz l la lb">pipenv install</span></pre><p id="0540" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的命令将寻找一个<em class="jk"> Pipenv </em>文件。如果它不存在，它会创造一个新的环境并激活它。运行上述命令后，我们会发现两个新文件:<em class="jk"> Pipenv </em>和<em class="jk"> Pipenv.lock </em></p><h2 id="9370" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">激活已经创建的pipenv环境</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="ed8e" class="jv jw hi ju b fi ky kz l la lb">pipenv shell</span></pre><h2 id="2070" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">安装/卸载依赖项</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="9fe9" class="jv jw hi ju b fi ky kz l la lb">pipenv install django</span><span id="734a" class="jv jw hi ju b fi mb kz l la lb">pipenv uninstall django</span></pre><h2 id="3b71" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">安装开发依赖项</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="fdd1" class="jv jw hi ju b fi ky kz l la lb">pipenv install nose --dev</span></pre><h2 id="7387" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">从requirements.txt安装</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="c88b" class="jv jw hi ju b fi ky kz l la lb">pipenv install -r requirements.txt</span></pre><h2 id="1989" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">检查安全漏洞</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="adb3" class="jv jw hi ju b fi ky kz l la lb">pipenv check</span></pre><h2 id="e1b0" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">检查依赖图</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="bc4a" class="jv jw hi ju b fi ky kz l la lb">pipenv graph</span></pre><h2 id="8c96" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">运行自定义脚本</h2><p id="ab9e" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix ly iz ja jb lz jd je jf ma jh ji jj hb bi translated">与npm类似，我们也可以使用pipenv运行定制脚本。假设我们正在进行一个Django项目，我们必须使用命令:<code class="du jr js jt ju b">python manage.py runserver</code> <em class="jk">来运行服务器。</em>现在我们可以将该命令添加到我们的<em class="jk"> Pipfile </em>中，目前，我们的<em class="jk"> Pipfile </em>可能如下所示:</p><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="a059" class="jv jw hi ju b fi ky kz l la lb">[[source]]<br/>url = "<a class="ae lx" href="https://pypi.org/simple" rel="noopener ugc nofollow" target="_blank">https://pypi.org/simple</a>"<br/>verify_ssl = true<br/>name = "pypi"</span><span id="2341" class="jv jw hi ju b fi mb kz l la lb">[packages]<br/>django = "*"</span><span id="a29b" class="jv jw hi ju b fi mb kz l la lb">[dev-packages]<br/>nose = "*"</span><span id="dd92" class="jv jw hi ju b fi mb kz l la lb">[scripts]<br/>server = "python manage.py runserver"</span><span id="d939" class="jv jw hi ju b fi mb kz l la lb">[requires]<br/>python_version = "3.8"</span></pre><p id="a263" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在上面的输出中，我们可以看到我们已经在scripts部分添加了脚本。因此，现在我们可以简单地运行下面的命令来运行我们的服务器:</p><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="9ee9" class="jv jw hi ju b fi ky kz l la lb">pipenv run server</span></pre><h2 id="3f97" class="jv jw hi bd jx jy jz ka kb kc kd ke kf ix kg kh ki jb kj kk kl jf km kn ko kp bi translated">锁定依赖关系</h2><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="d118" class="jv jw hi ju b fi ky kz l la lb">pipenv lock -r</span></pre><p id="9874" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Pipfile.lock文件通常如下所示:</p><pre class="kq kr ks kt fd ku ju kv kw aw kx bi"><span id="2b79" class="jv jw hi ju b fi ky kz l la lb">{<br/>    "_meta": {<br/>        "hash": {<br/>            "sha256": "627ef89...64f9dd2"<br/>        },<br/>        "pipfile-spec": 6,<br/>        "requires": {<br/>            "python_version": "3.8"<br/>        },<br/>        "sources": [<br/>            {<br/>                "name": "pypi",<br/>                "url": "<a class="ae lx" href="https://pypi.org/simple" rel="noopener ugc nofollow" target="_blank">https://pypi.org/simple</a>",<br/>                "verify_ssl": true<br/>            }<br/>        ]<br/>    },<br/>    "default": {<br/>        "django": {<br/>            "hashes": [<br/>                "sha256:acdcc1...ab5bb3",<br/>                "sha256:efbcad...d16b45"<br/>            ],<br/>            "index": "pypi",<br/>            "version": "==3.1.1"<br/>        },<br/>        "pytz": {<br/>            "hashes": [<br/>                "sha256:a061aa...669053",<br/>                "sha256:ffb9ef...2bf277"<br/>            ],<br/>            "version": "==2020.1"<br/>        }<br/>    },<br/>    "develop": {}<br/>}</span></pre></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="a343" class="mc jw hi bd jx md me mf kb mg mh mi kf mj mk ml ki mm mn mo kl mp mq mr ko ms bi translated">结论</h1><p id="bc4d" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix ly iz ja jb lz jd je jf ma jh ji jj hb bi translated">公平地说，<em class="jk"> Pipenv </em>在为您的包安装所有必需的子依赖项时，表现就像pip一样。但是一旦您解决了这个问题，<em class="jk"> Pipfile.lock </em>会为每个环境跟踪您的应用程序的所有相互依赖关系，包括它们的版本，因此您基本上可以忘记相互依赖关系。</p><p id="8fa1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在实践中，这意味着你可以继续在开发中工作，直到你有了一套适合你的包/版本。现在您可以简单地发出<code class="du jr js jt ju b">pipenv lock</code>和<em class="jk"> Pipenv </em>将锁定您的项目需要的所有依赖/相互依赖，锁定它们的版本并散列结果，这样您就可以在生产中确定性地复制您的构建。</p><p id="0c3e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，我的建议是<strong class="io hj">停止在虚拟环境中安装pip，开始安装pipenv。相信我，你不会后悔的。</strong></p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><p id="683f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我把一些与<em class="jk"> pipenv </em>相关的基本命令放到了Github Gist中。你可以在这里参观它们或者去http://srty.me/pipenv参观。如果你喜欢这个帖子，请鼓掌或主演<a class="ae lx" href="http://srty.me/pipenv" rel="noopener ugc nofollow" target="_blank"> Github Gist </a>来支持。你可以在我的<a class="ae lx" href="http://srty.me/ashutosh" rel="noopener ugc nofollow" target="_blank">网站</a>联系我。<br/>以上就是我的侧面，感谢阅读！</p></div></div>    
</body>
</html>