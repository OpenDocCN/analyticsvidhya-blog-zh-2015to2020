<html>
<head>
<title>Useful Pandas Tricks Part — 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有用的熊猫把戏第三部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/useful-pandas-tricks-part-3-9db0d534a05a?source=collection_archive---------23-----------------------#2020-05-05">https://medium.com/analytics-vidhya/useful-pandas-tricks-part-3-9db0d534a05a?source=collection_archive---------23-----------------------#2020-05-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/40bc490b3c3a25ae00a5a38c772ddb1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gh6s_USO5BUs0au7ObjbAQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">熊猫3(功夫熊猫3电影的壁纸)</figcaption></figure><div class=""/><p id="dc72" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作为我上一篇<a class="ae js" rel="noopener" href="/@kumar.brar/useful-pandas-tricks-part-2-1cdeca72ee9a">文章</a>的延续，我将继续介绍Pandas中用于数据分析和操作的有用技巧。</p><p id="aa18" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们首先创建一个数据帧，如下所示:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="c4b8" class="kc kd hx jy b fi ke kf l kg kh">df = pd.DataFrame({'col_one':['1.1', '2.2', '3.3'],<br/>                   'col_two':['4.4', '5.5', '6.6'],<br/>                   'col_three':['7.7','8.8', '-']})<br/>df</span></pre><p id="7396" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">dataframe与查找每列数据类型的查询如下所示:</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ki"><img src="../Images/9396bdc08af3d4cdd055013de9964a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q5bZyZGYSFeMlwOm60xr6g.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">创建数据帧和相应的命令来查找列的数据类型</figcaption></figure><p id="d987" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如上所示，列的数据类型是'<em class="kj">对象'类型。</em>如果我们想将数据类型转换成其他类型，我们可以通过在pandas中使用<em class="kj"> astype函数</em>来实现。请注意，这个函数将只改变col_one和col_two的数据类型。它不会改变col_three的数据类型，因为它包含连字符(-)符号，pandas不会将其识别为任何数据类型。</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/eabcfb92b66ff5b180b0bf5c33eaeecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dnonxzGG0JEeW6M14fIJaA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">使用astype函数转换列的数据类型</figcaption></figure><p id="a536" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们需要将任何数据类型转换为' NaN ',我们可以使用如图所示的<em class="kj">强制</em>关键字。我们还可以使用fillna方法填充零来代替NaN(不是一个数字)。下面，我用一行代码演示了整个功能，但是您也可以用两个步骤来完成。</p><p id="ce18" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hy">注:</strong> <em class="kj">作为一个练习，我把它留给你，让你自己做同样的事情。</em></p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kl"><img src="../Images/19da1b17e9e7cb72b621eaa2e1f130ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ko1LRYfOUUuRfQGxMPzMBw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">在一行中使用强制关键字和fillna方法</figcaption></figure><p id="4779" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">假设您有三个不同的csv文件，您可以借助<em class="kj"> read_csv </em>函数在pandas中读取，如下所示:</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ki"><img src="../Images/830687b98fe6cca3139d63ca16c1dce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-psKTqN0-xp6fvg1wy3cQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">在熊猫中读取CSV文件</figcaption></figure><p id="e3dc" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，文件名的名称匹配某个模式，因为所有文件名都包含名称stocks*。csv(这里，*表示任何字符或数字，我们知道文件名类似于stocks1.csv、stocks2.csv和stocks3.csv，其中stocks一词在所有文件名中是常见的。)</p><p id="8135" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hy"> <em class="kj">注意:</em> </strong>如果您需要一个文件名列表，这些文件名中间都有某个扩展名、前缀或任何常见的字符串，请使用<a class="ae js" href="https://pymotw.com/2/glob/#module-glob" rel="noopener ugc nofollow" target="_blank"> glob </a>而不是自己编写代码来扫描目录内容。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="ef85" class="kc kd hx jy b fi ke kf l kg kh">from glob import glob<br/>stock_files = sorted(glob('C:/Data/stocks*.csv'))  ## Here, with the help of sorted function , we can sort the files<br/>stock_files</span><span id="3b93" class="kc kd hx jy b fi km kf l kg kh">pd.concat((pd.read_csv(file) for file in stock_files) , ignore_index=True)  ## In the execution of above statement, our row index is getting repeated between 0 to 2. So, in order to ignore the index, we set ignore_index filed as True.</span></pre><p id="bb1f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出如下所示:</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kn"><img src="../Images/de1d79751380bb3c73c740cf36e17d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8S1Kr-lB1k7JnClAi2s5w.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">连接结果</figcaption></figure><p id="63a4" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们也可以通过列来连接一个表。比方说，我们有如下所示的两个文件:</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ko"><img src="../Images/1517bfb06623f01451cbe931031c27ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IapRIk6r_VxazdTj_dPLUg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">由列分隔的两个表</figcaption></figure><p id="3978" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，如果我们想根据列将这两个表连接成一个表，那么我们可以在下面命令的帮助下做同样的事情。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="404f" class="kc kd hx jy b fi ke kf l kg kh">drink_files = sorted(glob('C:/Data/drinks*.csv'))</span><span id="58bd" class="kc kd hx jy b fi km kf l kg kh">pd.concat((pd.read_csv(file) for file in drink_files), axis='columns').head()</span></pre><p id="5098" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">结果如下所示:</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kp"><img src="../Images/7587f25bf0ec1fa4d0c67d89ea4e0eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dHsXefFkDPR4M7bRqnjBfw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">通过列连接表</figcaption></figure><p id="05c5" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在下一篇文章中，我将解释我们可以在pandas中用于数据分析和操作的其他技巧。</p></div></div>    
</body>
</html>