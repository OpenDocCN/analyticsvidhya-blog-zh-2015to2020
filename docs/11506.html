<html>
<head>
<title>A method to discretization latitude and longitude</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种离散化经纬度的方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-method-to-discretization-latitude-and-longitude-c05d53f0fdfa?source=collection_archive---------15-----------------------#2020-12-06">https://medium.com/analytics-vidhya/a-method-to-discretization-latitude-and-longitude-c05d53f0fdfa?source=collection_archive---------15-----------------------#2020-12-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1f13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">短篇小说，<br/>这个故事与之前的<a class="ae jd" rel="noopener" href="/analytics-vidhya/reverse-address-to-latitude-and-longitude-using-here-api-73458b4df996">个故事</a>有关。这篇主要文章是地理空间数据景观的一部分。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="2489" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，什么是地理空间数据？<br/>根据 www.gislounge.com<a class="ae jd" href="http://www.gislounge.com" rel="noopener ugc nofollow" target="_blank"/>，地理空间数据定义如下。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/19e04a9c11709d436a96cb87ccc869ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mUsP2yqdnIw4fAgyt6f0aA.png"/></div></div></figure><p id="0fa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，任何包含坐标、地址、城市或邮政编码的数据。属于地理空间数据景观。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jx"><img src="../Images/d0fdf1119818662b58e0b299356fd8d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKfCz7lEcHqb5Qq2cjDI_w.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">地理空间数据示例</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="ca67" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">地理哈希</h1><p id="703b" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Geohash" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Geohash </strong> </a>是 Gustavo nie Meyer<a class="ae jd" href="https://en.wikipedia.org/wiki/Geohash#cite_note-first2008-1" rel="noopener ugc nofollow" target="_blank">【1】</a>和 g . m . Morton<a class="ae jd" href="https://en.wikipedia.org/wiki/Geohash#cite_note-morton66-2" rel="noopener ugc nofollow" target="_blank">【2】</a>在 2008 年发明的一个<a class="ae jd" href="https://en.wikipedia.org/wiki/Public_domain" rel="noopener ugc nofollow" target="_blank">公共域</a> <a class="ae jd" href="https://en.wikipedia.org/wiki/Geocode#Geocode_system" rel="noopener ugc nofollow" target="_blank">地理编码系统</a>，它将一个地理位置编码成一个由字母和数字组成的短字符串。它是一种分层的空间数据结构，将空间细分为网格形状的桶，这是所谓的 Z 顺序曲线 T21 的众多应用之一，通常称为空间填充曲线。</p><p id="1b69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，geohash 将一对纬度和经度编码成一个字符串。这取决于 geohash 的级别。例如，geohash 级别 1 有 1 个数字字符串，geohash 级别 2 有 2 个数字字符串，依此类推。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lf"><img src="../Images/546e9ed4001b5b99b782d72afc641765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*CSv17bfcvWqCJrP_O9YdaA.png"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated"><a class="ae jd" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-geohashgrid-aggregation.html" rel="noopener ugc nofollow" target="_blank">https://www . elastic . co/guide/en/elastic search/reference/current/search-aggregations-bucket-geohashgrid-aggregation . html</a></figcaption></figure><p id="5cab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">地理哈希可视化</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lg"><img src="../Images/e2ae5b9a244fe336a251b7f54f6346d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KJEK3E2UpOrHrAXHI1bSTw.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated"><a class="ae jd" href="https://www.movable-type.co.uk/scripts/geohash.html" rel="noopener ugc nofollow" target="_blank">https://www.movable-type.co.uk/scripts/geohash.html</a></figcaption></figure><p id="3ed9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图说明，qqguwf 是 geohash 级。编码范围为-6.2265 和 106.826。此外，它还显示了 9 个 geohash 邻域。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="8f54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">一个简单的用例</strong></p><p id="9b86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哪个区域属于商业区？<br/>假设:业务领域是业务点感兴趣的领域。例如:商店、咖啡馆、餐馆、公共汽车站等..</p><p id="747f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入必要的库</p><pre class="jm jn jo jp fd lh li lj lk aw ll bi"><span id="ee34" class="lm kd hi li b fi ln lo l lp lq">import random<br/>import geohash<br/>import pandas as pd <br/>import seaborn as sns</span></pre><p id="5444" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成随机坐标函数</p><pre class="jm jn jo jp fd lh li lj lk aw ll bi"><span id="7553" class="lm kd hi li b fi ln lo l lp lq">def generate_random_data(lat, lon, num_rows):<br/> #df_res = pd.DataFrame()<br/> random_item = [‘store’,’cafe’,’restaurant’,’office’,’bus stop’]<br/> tmp_list = []<br/> for _ in range(num_rows):<br/> hex1 = ‘%012x’ % random.randrange(16**12) # 12 char random string<br/> flt = float(random.randint(0,100))<br/> dec_lat = random.random()/100<br/> dec_lon = random.random()/100<br/># print (hex1.lower(), flt, lon+dec_lon, lat+dec_lat)<br/> tmp_list.append([hex1.lower(), lat+dec_lat , lon+dec_lon, random.choice(random_item) ])<br/> return pd.DataFrame(tmp_list,columns = [‘idx’,’latitude’,’longitude’,’type’])</span><span id="d189" class="lm kd hi li b fi lr lo l lp lq"># generate random geohash<br/>df_random = generate_random_data(-6.23,106.826,100)</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es ls"><img src="../Images/deb6d6860027ea493b431fb887a1d568.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*Hft-OWG9Jhc3ykIXAqAjRw.png"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">随机坐标</figcaption></figure><p id="90fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加地理哈希</p><pre class="jm jn jo jp fd lh li lj lk aw ll bi"><span id="27a0" class="lm kd hi li b fi ln lo l lp lq"># add geohash level 6<br/>df_random[‘geohash’] = df_random.apply(lambda x:geohash.encode(x[‘latitude’],x[‘longitude’],6),axis=1)</span></pre><p id="ac6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">聚合和透视</p><pre class="jm jn jo jp fd lh li lj lk aw ll bi"><span id="d564" class="lm kd hi li b fi ln lo l lp lq"># aggregation and pivot<br/>df_random_group = df_random[[‘geohash’,’type’,’idx’]].groupby([‘geohash’,’type’]).agg({“idx”: “nunique”}).reset_index()<br/>df_random_group_pvt = df_random_group.pivot(index=’geohash’, columns=’type’, values=’idx’).fillna(0)</span></pre><p id="e83b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">聚合输出</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lt"><img src="../Images/28c21be7b25f170b87d7ec51b1cd95d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ZijM_1C8WoX_Gzr_a7T0A.png"/></div></div></figure><p id="f59e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">枢轴输出</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lu"><img src="../Images/10369e15dc5eafe13627c0f80947b158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*qHjF28y3RKi7ywWbIJFePg.png"/></div></figure><p id="c2ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加热图</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lv"><img src="../Images/d0b090909940392b9337146321fb3187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*t3kJB6u3rpzhXzX7qgPZVA.png"/></div></div></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="aefb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong> <br/>总而言之，geohash 让 geo 计算变得更加简单快捷。<br/>从上面的热图可以看出，geohash qqguwf 属于商业区。因为，那里有很多餐馆、商店、办公室等。</p></div></div>    
</body>
</html>