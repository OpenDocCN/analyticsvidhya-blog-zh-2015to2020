<html>
<head>
<title>Natural Language Processing with Restaurant Reviews (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">餐馆评论的自然语言处理(第三部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/natural-language-processing-with-restaurant-reviews-part-3-2e08da61b8e5?source=collection_archive---------14-----------------------#2020-10-18">https://medium.com/analytics-vidhya/natural-language-processing-with-restaurant-reviews-part-3-2e08da61b8e5?source=collection_archive---------14-----------------------#2020-10-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b60c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，在本博客的前两部分中，我们对数据进行了分析，并创建了机器学习分类器模型来预测给定的评论是正面还是负面。</p><p id="2c7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">链接到以前的部分-</p><div class="jd je ez fb jf jg"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/natural-language-processing-with-restaurant-reviews-part-1-46e228585a32"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">餐馆评论的自然语言处理(上)</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">这些天每个人似乎都在谈论机器学习，每个人似乎都想成为数据…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">medium.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><div class="jd je ez fb jf jg"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/natural-language-processing-with-restaurant-reviews-part-2-ad240d1a7393"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">餐馆评论的自然语言处理(下)</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">在本博客的第 1 部分，我们致力于分析和理解餐馆评论数据集。我们发现…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">medium.com</p></div></div><div class="jp l"><div class="jw l jr js jt jp ju jv jg"/></div></div></a></div><p id="e6f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从使用分类器做一个测试预测开始。</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="c8db" class="kg kh hi kc b fi ki kj l kk kl"><em class="km">#doing a test prediction<br/></em>test = ["the food was not very good, it was very rotten and tasted bad"]<br/><br/><em class="km">#transforming for using on the model (using the count vectorizer)<br/></em>test_vec = cv.transform(test)<br/><em class="km">#0= not liked<br/>#1= liked the food</em></span><span id="816b" class="kg kh hi kc b fi kn kj l kk kl">classifier.predict(test_vec)[0]</span></pre><figure class="jx jy jz ka fd kp er es paragraph-image"><div class="er es ko"><img src="../Images/40b7421e111b1efa7c49cc0d2af7f7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*dg-qvMxDUPcTC5iXukLeQg.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">输出。</figcaption></figure><p id="0d84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出给出了“0 ”,这是负面评论的类别。因此，我们可以理解模型运行良好。</p><h1 id="90d0" class="kv kh hi bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">使用 Pickle 保存模型和文本语料库</strong></h1><figure class="jx jy jz ka fd kp er es paragraph-image"><div class="er es ls"><img src="../Images/1c23d92805143a1638f94a9ff5f18168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/0*b-ICQsfFowL2fvsk.jpg"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">现实生活中的泡菜:)</figcaption></figure><p id="b0d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在现实生活中，泡菜是用来长时间储存食物和保存食物的。同样，在 Python <strong class="ih hj">中，pickle </strong>可以用来将机器学习模型存储为文件以备后用。要阅读更多关于 Python 中 pickle 的内容，请访问-</p><div class="jd je ez fb jf jg"><a href="https://www.tutorialspoint.com/python-pickling" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">蟒蛇腌制</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">Python pickle 模块用于序列化和反序列化 Python 对象结构。转换任何…的过程</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">www.tutorialspoint.com</p></div></div><div class="jp l"><div class="lt l jr js jt jp ju jv jg"/></div></div></a></div><p id="eb18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">继续进行的代码-</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="2898" class="kg kh hi kc b fi ki kj l kk kl"><em class="km">#saving the model</em><br/><strong class="kc hj">import</strong> <strong class="kc hj">pickle</strong></span><span id="bd52" class="kg kh hi kc b fi kn kj l kk kl">filename = 'reviews_classifier.sav'<br/>pickle.dump(classifier, open(filename, 'wb'))</span></pre><p id="e4e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将把分类器模型作为. sav 文件保存在 Jupyter 笔记本/Python IDE 的本地目录中。</p><p id="43ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们还必须保存语料库以备后用。在语言学和 NLP 中，<strong class="ih hj">语料库</strong>(拉丁文字面意思为身体)指的是文本的集合。这里的语料库是所有评论的集合。我们将需要语料库能够为我们的模型使用计数矢量器。当我们使用一个新的输入时，它应该能够被输入到模型中。因此，计数矢量器将需要语料库。所以我们继续保存语料库。</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="378b" class="kg kh hi kc b fi ki kj l kk kl"><em class="km">#saving the corpus</em><br/><br/>type(corpus)</span></pre><figure class="jx jy jz ka fd kp er es paragraph-image"><div class="er es lu"><img src="../Images/ec76bb4e0ac585ef42211d71b019bec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*dwHrqhLA73_r_9O-RDaOEw.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">语料库实际上是一个列表。</figcaption></figure><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="ef3c" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">with</strong> open('corpus.data', 'wb') <strong class="kc hj">as</strong> filehandle:     <br/><em class="km"># store the data as binary data stream</em>     <br/>    pickle.dump(corpus, filehandle)</span></pre><p id="39f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们也将<strong class="ih hj">文集</strong>保存为一个文件。它被保存为<strong class="ih hj"> corpus.data </strong>。</p><h1 id="ab50" class="kv kh hi bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">创建一个. py 可执行文件来运行分类器</h1><p id="be26" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">我们将从他们的文件中加载语料库和模型。</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="d263" class="kg kh hi kc b fi ki kj l kk kl">import pickle<br/>from sklearn.feature_extraction.text import CountVectorizer</span><span id="bebb" class="kg kh hi kc b fi kn kj l kk kl">#model filename<br/>filename = 'reviews_classifier.sav'</span><span id="93ec" class="kg kh hi kc b fi kn kj l kk kl">loaded_classifier = pickle.load(open(filename, 'rb'))</span><span id="da56" class="kg kh hi kc b fi kn kj l kk kl">cv = CountVectorizer(max_features = 2000)</span><span id="5df6" class="kg kh hi kc b fi kn kj l kk kl">#loading the corpus</span><span id="c365" class="kg kh hi kc b fi kn kj l kk kl">with open('corpus.data', 'rb') as filehandle:<br/>    # read the data as binary data stream<br/>    corpus = pickle.load(filehandle)<br/>#fitting the count vectorizer with the corpus<br/>cv.fit_transform(corpus)</span></pre><p id="a4f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将研究 python 代码，现在几乎所有的东西都是简单的 python 代码。</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="98d0" class="kg kh hi kc b fi ki kj l kk kl">print("Welcome to the Restaurant Review analyser")<br/>print("The output will be either positive or negative.")<br/>print("A count vectorizer was used")<br/>print("---------------------------------------------------")<br/>user_input=input("Enter the review of the restaurant:  ")</span><span id="3e53" class="kg kh hi kc b fi kn kj l kk kl">test = [user_input]<br/>test_vec = cv.transform(test)</span><span id="f941" class="kg kh hi kc b fi kn kj l kk kl">val=loaded_classifier.predict(test_vec)[0]</span><span id="786c" class="kg kh hi kc b fi kn kj l kk kl">print("---------------------------------------------------")</span><span id="fb8b" class="kg kh hi kc b fi kn kj l kk kl">if(val==0):<br/>    print("The review entered was negative.")    <br/>    print("The user did not like the restaurant.")</span><span id="f65c" class="kg kh hi kc b fi kn kj l kk kl">if(val==1):<br/>    print("The review entered was positive.")<br/>    print("The user liked the restaurant.")</span></pre><p id="4445" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果执行该代码，用户可以选择用简单的英语输入评论，并输出评论是积极的还是消极的。这个项目是基本的自然语言处理技术的整体实现。</p><p id="8b32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自然语言处理的主要目标之一是以一种聪明而有用的方式从人类语言中获取意义。更高级的应用包括文本摘要、主题提取、情感分析、关系提取等等。关注我，了解机器学习、数据科学、NLP 等等。</p><p id="e50d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Github Repo 有所有的项目文件-</p><div class="jd je ez fb jf jg"><a href="https://github.com/prateekmaj21/Restaurant-Reviews-NLP-Project" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">prateekma 21/餐厅-评论-NLP-项目</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">一个基于餐馆评论的自然语言处理项目。GitHub 是超过 5000 万开发人员的家园，他们在…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">github.com</p></div></div><div class="jp l"><div class="ma l jr js jt jp ju jv jg"/></div></div></a></div><p id="747f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这份工作，一定要给它一颗星。</p><p id="707a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">谢谢你。</strong></p></div></div>    
</body>
</html>