<html>
<head>
<title>Feature Selection: Embedded Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç‰¹å¾é€‰æ‹©:åµŒå…¥å¼æ–¹æ³•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/feature-selection-embedded-methods-a7940036973f?source=collection_archive---------2-----------------------#2020-12-13">https://medium.com/analytics-vidhya/feature-selection-embedded-methods-a7940036973f?source=collection_archive---------2-----------------------#2020-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="358a" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">æƒå¨æŒ‡å—</h2><div class=""/><div class=""><h2 id="2dcd" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">3 åŸºäºåµŒå…¥å¼æ–¹æ³•é€‰æ‹©ç›¸å…³ç‰¹æ€§</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/be5a08507f48e6f07665cda4c357cc8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oYqHNNds5crc9_jk"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae jw" href="https://unsplash.com/@edgr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">eduÂ·æ ¼å…°å¾·</a>åœ¨<a class="ae jw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure><h2 id="91e1" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ho bi translated">ç›®å½•</h2><ul class=""><li id="3565" class="ku kv hi kw b kx ky kz la ki lb km lc kq ld le lf lg lh li bi translated"><a class="ae jw" href="#e412" rel="noopener ugc nofollow">åµŒå…¥æ–¹æ³•</a></li><li id="88e3" class="ku kv hi kw b kx lj kz lk ki ll km lm kq ln le lf lg lh li bi translated"><a class="ae jw" href="#3998" rel="noopener ugc nofollow">å¥—ç´¢</a></li><li id="f518" class="ku kv hi kw b kx lj kz lk ki ll km lm kq ln le lf lg lh li bi translated"><a class="ae jw" href="#a430" rel="noopener ugc nofollow">åŠŸèƒ½é‡è¦æ€§</a></li><li id="ec2c" class="ku kv hi kw b kx lj kz lk ki ll km lm kq ln le lf lg lh li bi translated"><a class="ae jw" href="#bc99" rel="noopener ugc nofollow">ç»“è®º</a></li></ul><p id="c9f4" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated"><em class="md">è¿™ç¯‡æ–‡ç« æ˜¯å…³äºç‰¹æ€§é€‰æ‹©çš„åšå®¢ç³»åˆ—çš„ç¬¬ä¸‰éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æœ€åä¸€éƒ¨åˆ†ã€‚çœ‹çœ‹æ»¤é•œ(</em><a class="ae jw" href="https://tzinie.medium.com/feature-selection-73bc12a9b39e" rel="noopener"><em class="md">part 1</em></a><em class="md">)å’ŒåŒ…è£…å™¨(</em><a class="ae jw" rel="noopener" href="/analytics-vidhya/feature-selection-85539d6a2a88"><em class="md">part 2</em></a><em class="md">)çš„æ–¹æ³•ã€‚</em></p></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><h1 id="e412" class="ml jy hi bd jz mm mn mo kd mp mq mr kh ix ms iy kl ja mt jb kp jd mu je kt mv bi translated">åµŒå…¥å¼æ–¹æ³•</h1><p id="e097" class="pw-post-body-paragraph lo lp hi kw b kx ky is lr kz la iv lt ki mw lv lw km mx ly lz kq my mb mc le hb bi translated">åµŒå…¥å¼æ–¹æ³•ç»“åˆäº†è¿‡æ»¤å™¨å’ŒåŒ…è£…å™¨æ–¹æ³•çš„ä¼˜ç‚¹ã€‚å¦‚æœæ‚¨ä»”ç»†ç ”ç©¶è¿™ä¸‰ç§ä¸åŒçš„æ–¹æ³•ï¼Œæ‚¨å¯èƒ½ä¼šæƒ³çŸ¥é“åŒ…è£…æ–¹æ³•å’ŒåµŒå…¥æ–¹æ³•ä¹‹é—´çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆã€‚</p><p id="639c" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">ä¹ä¸€çœ‹ï¼Œä¸¤è€…éƒ½æ˜¯åŸºäºæœºå™¨å­¦ä¹ æ¨¡å‹çš„å­¦ä¹ è¿‡ç¨‹æ¥é€‰æ‹©ç‰¹å¾ã€‚ç„¶è€Œï¼ŒåŒ…è£…æ–¹æ³•åŸºäºè¯„ä¼°åº¦é‡åå¤è€ƒè™‘ä¸é‡è¦çš„ç‰¹å¾ï¼Œè€Œ<strong class="kw hs">åµŒå…¥å¼æ–¹æ³•å¹¶è¡Œæ‰§è¡Œç‰¹å¾é€‰æ‹©å’Œç®—æ³•è®­ç»ƒ</strong>ã€‚æ¢å¥è¯è¯´ï¼Œç‰¹å¾é€‰æ‹©è¿‡ç¨‹æ˜¯åˆ†ç±»/å›å½’æ¨¡å‹çš„ç»„æˆéƒ¨åˆ†ã€‚</p><p id="0bf5" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">åŒ…è£…å™¨å’Œè¿‡æ»¤å™¨æ–¹æ³•æ˜¯ç¦»æ•£çš„è¿‡ç¨‹ï¼Œä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œç‰¹å¾è¦ä¹ˆè¢«ä¿ç•™ï¼Œè¦ä¹ˆè¢«ä¸¢å¼ƒã€‚ç„¶è€Œï¼Œè¿™é€šå¸¸ä¼šå¯¼è‡´è¾ƒé«˜çš„æ–¹å·®ã€‚å¦ä¸€æ–¹é¢ï¼ŒåµŒå…¥å¼æ–¹æ³•æ›´åŠ è¿ç»­ï¼Œå› æ­¤ä¸ä¼šå—åˆ°é«˜å¯å˜æ€§çš„å½±å“ã€‚</p></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><h1 id="3998" class="ml jy hi bd jz mm mn mo kd mp mq mr kh ix ms iy kl ja mt jb kp jd mu je kt mv bi translated">å¥—ç´¢</h1><p id="e9a9" class="pw-post-body-paragraph lo lp hi kw b kx ky is lr kz la iv lt ki mw lv lw km mx ly lz kq my mb mc le hb bi translated">æœ€å°ç»å¯¹æ”¶ç¼©å’Œé€‰æ‹©ç®—å­(LASSO)æ˜¯ä¸€ç§åŒæ—¶æ‰§è¡Œå˜é‡é€‰æ‹©å’Œæ­£åˆ™åŒ–çš„<em class="md">æ”¶ç¼©</em>æ–¹æ³•ã€‚æˆ‘çŸ¥é“ï¼Œè¿™å¬èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†å¾ˆå¿«ä½ å°±ä¼šæ„è¯†åˆ°è¿™åªæ˜¯ L1 æ­£åˆ™åŒ–çš„çº¿æ€§å›å½’ã€‚ä½†æ˜¯è®©æˆ‘ä»¬ä¸€æ¬¡åšä¸€ä»¶äº‹ï¼Œä» L1 æ­£åˆ™åŒ–å¼€å§‹ã€‚</p><p id="23c7" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">æ­£åˆ™åŒ–æ˜¯<em class="md">å°†ç³»æ•°(æƒé‡)å‘é›¶æ”¶ç¼©</em>çš„è¿‡ç¨‹ã€‚è¿™åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè¿™æ„å‘³ç€ä½ åœ¨æƒ©ç½šæ›´å¤æ‚çš„æ¨¡å‹ä»¥é¿å…è¿‡åº¦æ‹Ÿåˆã€‚</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mz"><img src="../Images/a509007d016bf2b89701f01e43748e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_7OPgojau8hkiPUiHoGK_w.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">å¦‚æœä½ æ²¡æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æƒ³è¦ä¸­é—´çš„é‚£ä¸ªã€‚</figcaption></figure><p id="d2d4" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">ä½†æ˜¯è¿™å¦‚ä½•è½¬åŒ–ä¸ºç‰¹å¾é€‰æ‹©å‘¢ï¼Ÿæ‚¨å¯èƒ½å¬è¯´è¿‡å…¶ä»–æ­£åˆ™åŒ–æŠ€æœ¯ï¼Œå¦‚å²­å›å½’æˆ–å¼¹æ€§ç½‘ï¼Œä½† LASSO å…è®¸å°†ç³»æ•°è®¾ç½®ä¸º 0ã€‚å¦‚æœç³»æ•°ä¸ºé›¶ï¼Œåˆ™ä¸è€ƒè™‘è¯¥ç‰¹å¾ï¼Œå› æ­¤ï¼Œå®ƒåœ¨æŸç§ç¨‹åº¦ä¸Šè¢«ä¸¢å¼ƒã€‚</p><blockquote class="na nb nc"><p id="bc83" class="lo lp md kw b kx lq is lr kz ls iv lt nd lu lv lw ne lx ly lz nf ma mb mc le hb bi translated">æ³¨:å¼¹æ€§ç½‘æ˜¯å¥—ç´¢å’Œå²­å›å½’çš„ç»“åˆã€‚è¿™æ„å‘³ç€å®ƒè¿˜å¯ä»¥æ‰§è¡Œç‰¹å¾é€‰æ‹©ã€‚å²­å›å½’ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå®ƒåªå…è®¸ç³»æ•°éå¸¸æ¥è¿‘é›¶ï¼Œä½†å®é™…ä¸Šæ°¸è¿œä¸ä¼šä¸ºé›¶ã€‚</p></blockquote><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es ng"><img src="../Images/853a3b6b5c80dde1aff50d88b275ddd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*l2RtKPDGeQP-QkQDpeK1Ig.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">å¥—ç´¢ç›®æ ‡:ç¬¬ä¸€ä»»æœŸï¼›RSS |ç¬¬äºŒå­¦æœŸï¼›L1 å¸¸æ¨¡</figcaption></figure><p id="c32c" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">å¤æ‚åº¦å‚æ•°Î»(Î»)æ˜¯éè´Ÿçš„ï¼Œå¹¶ä¸”æ§åˆ¶æ”¶ç¼©é‡ã€‚å…¶å€¼è¶Šå¤§ï¼Œæ”¶ç¼©é‡è¶Šå¤§ï¼Œæ‚¨æ„å»ºçš„æ¨¡å‹å°±è¶Šç®€å•ã€‚å½“ç„¶ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªæ‚¨åº”è¯¥è°ƒæ•´çš„è¶…å‚æ•°ã€‚</p><blockquote class="na nb nc"><p id="3fb0" class="lo lp md kw b kx lq is lr kz ls iv lt nd lu lv lw ne lx ly lz nf ma mb mc le hb bi translated">æƒ©ç½šçš„æ€æƒ³è¢«ç”¨åœ¨è®¸å¤šç®—æ³•ä¸­ï¼ŒåŒ…æ‹¬ç¥ç»ç½‘ç»œï¼›æˆ‘ä»¬ç§°ä¹‹ä¸º<em class="hi">é‡é‡è¡°å‡</em>ã€‚</p></blockquote><p id="0465" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­â€¦â€¦æˆ‘ä»<a class="ae jw" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_breast_cancer.html" rel="noopener ugc nofollow" target="_blank"> sklearn </a>(äºŒå…ƒåˆ†ç±»ä»»åŠ¡)ä¸­é€‰æ‹©äº†ä¹³è…ºç™Œæ•°æ®é›†ã€‚æ•°æ®é›†ä¸­åªæœ‰ 569 ä¸ªæ ·æœ¬ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°†å¯¹æ¯ä¸ªæ­¥éª¤è¿›è¡Œåˆ†å±‚äº¤å‰éªŒè¯ã€‚</p><pre class="jh ji jj jk fd nh ni nj nk aw nl bi"><span id="113a" class="jx jy hi ni b fi nm nn l no np">from sklearn.linear_model import LassoCV<br/>from sklearn.datasets import load_breast_cancer<br/>from sklearn.model_selection import StratifiedKFold</span><span id="6675" class="jx jy hi ni b fi nq nn l no np">cancer = load_breast_cancer()</span><span id="2231" class="jx jy hi ni b fi nq nn l no np">X = cancer.data<br/>y = cancer.target</span><span id="0eb3" class="jx jy hi ni b fi nq nn l no np">skf = StratifiedKFold(n_splits=10<br/>lasso = LassoCV(cv=skf, random_state=42).fit(X, y)</span><span id="edc2" class="jx jy hi ni b fi nq nn l no np">print('Selected Features:', list(cancer.feature_names[np.where(lasso.coef_!=0)[0]]))</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es nr"><img src="../Images/8e66d86cb7de936f391c65f4843d1572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iMNbGY6pT0V9giZFiSdWrQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">å¥—ç´¢:é€‰å®šçš„ç‰¹å¾</figcaption></figure><pre class="jh ji jj jk fd nh ni nj nk aw nl bi"><span id="03cc" class="jx jy hi ni b fi nm nn l no np">lr = LogisticRegression(C=10, class_weight='balanced', max_iter=10000, random_state=42)<br/>preds = cross_val_predict(lr, X[:, np.where(lasso.coef_!=0)[0]], y, cv=skf)<br/>print(classification_report(y, preds))</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ns"><img src="../Images/0092f8e0210452a18a59e07ae52eea86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igibBv5eja1CGCcflW4cbA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">åˆ†ç±»æŠ¥å‘Šï¼›å¥—ç´¢</figcaption></figure></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><h1 id="a430" class="ml jy hi bd jz mm mn mo kd mp mq mr kh ix ms iy kl ja mt jb kp jd mu je kt mv bi translated">ç‰¹å¾é‡è¦æ€§</h1><p id="eea1" class="pw-post-body-paragraph lo lp hi kw b kx ky is lr kz la iv lt ki mw lv lw km mx ly lz kq my mb mc le hb bi translated"><em class="md">çš„ç‰¹è‰²é‡è¦æ€§</em>æœ‰å°è±¡å—ï¼Ÿ</p><p id="1a42" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">é€šè¿‡å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬çœŸçš„å¯ä»¥å¾—åˆ°ç‰¹å¾ç©ºé—´çš„è¦ç‚¹â€”â€”æå–æœ‰ç”¨çš„ä¿¡æ¯â€”â€”ä»è€Œå¾—åˆ°ä¸€ä¸ªæ›´å¥½ã€æ›´æ˜“è§£é‡Šçš„æ¨¡å‹ã€‚æˆ‘ä»¬æœ‰ä¸¤æ¡è·¯å¯ä»¥èµ°ï¼›åŸºäºæ ‘çš„æ–¹æ³•å’Œæ’åˆ—é‡è¦æ€§ã€‚</p><h2 id="4ed3" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ho bi translated">åŸºäºæ ‘çš„æ–¹æ³•</h2><p id="b5c6" class="pw-post-body-paragraph lo lp hi kw b kx ky is lr kz la iv lt ki mw lv lw km mx ly lz kq my mb mc le hb bi translated">å†³ç­–æ ‘ã€RandomForestã€ExtraTreeã€XGBoost æ˜¯å¯ä»¥ç”¨æ¥è·å¾—ç‰¹å¾é‡è¦æ€§çš„ä¸€äº›åŸºäºæ ‘çš„æ–¹æ³•ã€‚æˆ‘æœ€å–œæ¬¢çš„æ˜¯ RandomForest å’Œ Boosted Trees (XGBoostï¼ŒLightGBMï¼ŒCatBoost ),å› ä¸ºå®ƒä»¬é€šè¿‡å¼•å…¥éšæœºæ€§æ¥æ”¹å–„ç®€å•å†³ç­–æ ‘çš„æ–¹å·®ã€‚</p><p id="4176" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated"><strong class="kw hs">ä½†æ˜¯æ€ä¹ˆåšå‘¢ï¼Ÿ</strong></p><p id="35f0" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ç»§ç»­é€‰æ‹©éšæœºæ£®æ—ä½œä¸ºæˆ‘çš„ç®—æ³•ã€‚éšæœºæ£®æ—ä½¿ç”¨<strong class="kw hs">å‡å€¼å‡å°‘æ‚è´¨</strong> <em class="md">(åŸºå°¼æŒ‡æ•°)</em> <strong class="kw hs"> </strong>æ¥ä¼°è®¡ä¸€ä¸ªç‰¹å¾çš„é‡è¦æ€§ã€‚å€¼è¶Šä½ï¼Œç‰¹æ€§è¶Šé‡è¦ã€‚åŸºå°¼æŒ‡æ•°çš„å®šä¹‰æ˜¯:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es nt"><img src="../Images/dca9f13c29d3248bab363fdc0873b728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnrL7akbekezdWQwpFKdlg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">åŸºå°¼æŒ‡æ•°å…¬å¼</figcaption></figure><p id="dddc" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">å…¶ä¸­ç¬¬äºŒé¡¹æ˜¯æ ·æœ¬<code class="du nu nv nw ni b">i</code>çš„æ¯ç±»æ¦‚ç‡çš„å¹³æ–¹å’Œã€‚ä¸ºä½¿ç”¨ç‰¹å¾<code class="du nu nv nw ni b">j</code>çš„æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹æµ‹é‡ç‰¹å¾<code class="du nu nv nw ni b">j</code>çš„åŸºå°¼æŒ‡æ•°ï¼Œå¹¶å¯¹é›†åˆä¸­çš„æ‰€æœ‰æ ‘è¿›è¡Œå¹³å‡ã€‚å¦‚æœåˆ°è¾¾è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰æ ·æœ¬éƒ½ä¸å•ä¸ªç±»ç›¸é“¾æ¥ï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹å¯ä»¥è¢«ç§°ä¸º<strong class="kw hs">çº¯</strong>ã€‚ç‚¹å‡»é˜…è¯»æ›´å¤šç›¸å…³ä¿¡æ¯<a class="ae jw" href="https://towardsdatascience.com/gini-index-vs-information-entropy-7a7e4fed3fcb" rel="noopener" target="_blank">ã€‚</a></p><pre class="jh ji jj jk fd nh ni nj nk aw nl bi"><span id="0273" class="jx jy hi ni b fi nm nn l no np">from sklearn.datasets import load_breast_cancer<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.feature_selection import SelectFromModel<br/>import matplotlib.pyplot as plt</span><span id="f56d" class="jx jy hi ni b fi nq nn l no np">cancer = load_breast_cancer()</span><span id="8311" class="jx jy hi ni b fi nq nn l no np">X = cancer.data<br/>y = cancer.target</span><span id="de7e" class="jx jy hi ni b fi nq nn l no np">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<strong class="ni hs">0.2</strong>, random_state=42, stratify=y)</span><span id="4f44" class="jx jy hi ni b fi nq nn l no np">rf = RandomForestClassifier(n_estimators = 100, class_weight='balanced', random_state=42)<br/>rf.fit(X_train, y_train)</span><span id="d7b8" class="jx jy hi ni b fi nq nn l no np">importances = rf.feature_importances_<br/>indices = np.argsort(importances)[::-1]</span><span id="9ae6" class="jx jy hi ni b fi nq nn l no np">plt.figure()<br/>plt.title("Feature importances")<br/>plt.bar(range(X_train.shape[1]), importances[indices],<br/>        color="lightsalmon", align="center")<br/>plt.xticks(range(X_train.shape[1]), cancer.feature_names[indices], rotation=90)<br/>plt.xlim([-1, X_train.shape[1]])<br/>plt.show()</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es nx"><img src="../Images/17d503ddb944901dae3a489a20f8cb36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_ExGYodooYALtY_T4YuWg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">ç‰¹å¾é‡è¦æ€§ï¼›éšæœºæ£®æ—</figcaption></figure><p id="6f70" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">å½“æ ¹æ®è¦ç´ çš„é‡è¦æ€§é€‰æ‹©è¦ç´ æ—¶ï¼Œè¿™å¯ä»¥å¾ˆå¥½åœ°ä¼°è®¡æ‚¨æƒ³è¦è®¾ç½®çš„é˜ˆå€¼ã€‚æˆ‘é€‰æ‹© 0.06ï¼Œè¿™å¯¼è‡´ 7 ä¸ªç‰¹å¾ã€‚</p><pre class="jh ji jj jk fd nh ni nj nk aw nl bi"><span id="847b" class="jx jy hi ni b fi nm nn l no np">sfm = SelectFromModel(rf, threshold=0.06)</span><span id="e680" class="jx jy hi ni b fi nq nn l no np">sfm.fit(X_train, y_train)</span><span id="e80b" class="jx jy hi ni b fi nq nn l no np">X_important_train = sfm.transform(X_train)<br/>X_important_test = sfm.transform(X_test)</span><span id="8924" class="jx jy hi ni b fi nq nn l no np">rf = RandomForestClassifier(n_estimators = 100, class_weight='balanced', random_state=42)</span><span id="d930" class="jx jy hi ni b fi nq nn l no np">rf.fit(X_important_train, y_train)<br/>y_pred = rf.predict(X_important_test)</span><span id="b701" class="jx jy hi ni b fi nq nn l no np">print(classification_report(y_test, y_pred))</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ny"><img src="../Images/a2e4791d908e40892a0935b1ba53d0ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_F965YHShHkgtSE4m_1B3g.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">åˆ†ç±»æŠ¥å‘Šï¼›éšæœºæ£®æ—</figcaption></figure><blockquote class="na nb nc"><p id="372e" class="lo lp md kw b kx lq is lr kz ls iv lt nd lu lv lw ne lx ly lz nf ma mb mc le hb bi translated">ä½ å¯ä»¥ç®€å•åœ°ç”¨<code class="du nu nv nw ni b">XGBClassifier()</code>æ›¿æ¢<code class="du nu nv nw ni b">RandomForestClassifier()</code>ï¼Œå¯¹ä»»ä½•æå‡æ ‘ç®—æ³•é‡å¤åŒæ ·çš„æ“ä½œ</p></blockquote><h2 id="390c" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ho bi translated">æ’åˆ—é‡è¦æ€§</h2><p id="ef00" class="pw-post-body-paragraph lo lp hi kw b kx ky is lr kz la iv lt ki mw lv lw km mx ly lz kq my mb mc le hb bi translated">ä¸€ä¸ªä¸å¤ªå‡ºåä½†ä»ç„¶å€¼å¾—æ¢ç´¢çš„æƒ³æ³•ã€‚è¯¥æ–¹æ³•æ”¹å˜ä¸€ä¸ªç‰¹å¾çš„å€¼ï¼Œç„¶åæµ‹é‡æ¨¡å‹è¯¯å·®çš„å¢åŠ ã€‚å½“ä¸”ä»…å½“æ´—ç‰Œå¯¼è‡´å¢åŠ æ—¶ï¼Œè¯¥ç‰¹å¾æ‰æ˜¯é‡è¦çš„ã€‚è¿™äº›æ­¥éª¤å¦‚ä¸‹:</p><ol class=""><li id="593f" class="ku kv hi kw b kx lq kz ls ki nz km oa kq ob le oc lg lh li bi translated">ç…§å¸¸è®­ç»ƒæ¨¡å‹ã€‚ä¼°ç®—è¯¯å·®:<code class="du nu nv nw ni b">L(y, f(X))</code>ï¼›<code class="du nu nv nw ni b">L</code>:ä¸¢å¤±ï¼Œ<code class="du nu nv nw ni b">y</code>:çœŸå®ç›®æ ‡å‘é‡ï¼Œ<code class="du nu nv nw ni b">f(X)</code>ï¼›ä¼°è®¡ç›®æ ‡å‘é‡ã€‚</li><li id="0544" class="ku kv hi kw b kx lj kz lk ki ll km lm kq ln le oc lg lh li bi translated">å¯¹äºè¾“å…¥ç‰¹å¾å‘é‡ä¸­çš„æ¯ä¸ªç‰¹å¾<code class="du nu nv nw ni b">j</code>ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„è¾“å…¥çŸ©é˜µ<code class="du nu nv nw ni b">X'</code>ï¼Œå…¶ä¸­ç‰¹å¾<code class="du nu nv nw ni b">j</code>è¢«ç½®æ¢â€”â€”ä»¥æ–­å¼€ç‰¹å¾<code class="du nu nv nw ni b">j</code>ä¸ç›®æ ‡å˜é‡<code class="du nu nv nw ni b">y</code>çš„å…³è”ã€‚ç”¨æ–°çš„è¾“å…¥çŸ©é˜µå†æ¬¡ä¼°ç®—è¯¯å·®:<code class="du nu nv nw ni b">L(y, f(X'))</code>ã€‚é€šè¿‡ç®€å•çš„æ“ä½œè®¡ç®—é‡è¦æ€§:<code class="du nu nv nw ni b">L(y, f(X'))-L(y, f(X))</code>ã€‚</li><li id="fb10" class="ku kv hi kw b kx lj kz lk ki ll km lm kq ln le oc lg lh li bi translated">æ ¹æ®è¦ç´ çš„é‡è¦æ€§å¯¹å…¶è¿›è¡Œæ’åºã€‚</li></ol><pre class="jh ji jj jk fd nh ni nj nk aw nl bi"><span id="47de" class="jx jy hi ni b fi nm nn l no np">from sklearn.datasets import load_breast_cancer<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.ensemble import RandomForestClassifier</span><span id="b678" class="jx jy hi ni b fi nq nn l no np">import eli5<br/>from eli5.sklearn import PermutationImportance</span><span id="653e" class="jx jy hi ni b fi nq nn l no np">cancer = load_breast_cancer()</span><span id="da76" class="jx jy hi ni b fi nq nn l no np">X = cancer.data<br/>y = cancer.target</span><span id="d05a" class="jx jy hi ni b fi nq nn l no np">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<strong class="ni hs">0.2</strong>, random_state=42, stratify=y)</span><span id="9540" class="jx jy hi ni b fi nq nn l no np">rf = RandomForestClassifier(n_estimators = 100, class_weight='balanced', random_state=42)<br/>rf.fit(X_train, y_train)</span><span id="8caf" class="jx jy hi ni b fi nq nn l no np">perm = PermutationImportance(rf, random_state=42).fit(X_test, y_test)</span><span id="319d" class="jx jy hi ni b fi nq nn l no np">eli5.show_weights(perm, features_names=cancer.feature_names)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es od"><img src="../Images/aa62195188669dfbe852c3d12a19fd54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B38frwmye7Y0FgBTvr3eHw.png"/></div></div></figure><p id="a68d" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">æˆ‘é€‰æ‹©é‡è¦æ€§é«˜äº 0.08 çš„ç‰¹å¾ã€‚</p><pre class="jh ji jj jk fd nh ni nj nk aw nl bi"><span id="c82d" class="jx jy hi ni b fi nm nn l no np">rf = RandomForestClassifier(n_estimators = 100, class_weight='balanced', random_state=42)<br/>preds= cross_val_predict(rf, X[:, np.where(perm.feature_importances_&gt;=0.008)[0]], y, cv=skf)<br/>print(classification_report(y, preds))</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es oe"><img src="../Images/1128c8aa2cb73f62b1a6e5939c1300f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzCT8WY30XzsnLylCQN2tA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">åˆ†ç±»æŠ¥å‘Šï¼›æ’åˆ—é‡è¦æ€§</figcaption></figure><p id="3750" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">è¿™ç§æ–¹æ³•å¾ˆå°‘ç”¨äºé€‰æ‹©ç‰¹å¾ï¼Œè€Œæ˜¯å‡ºäºå¯è§£é‡Šæ€§çš„åŸå› ã€‚</p></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><p id="167b" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">å¦‚æœæˆ‘ä»¬ä¸æ‰§è¡Œç‰¹å¾é€‰æ‹©ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es of"><img src="../Images/bc3167255811a135f5c61e9addb443fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EP-aTKYNmyJWrsGLXO8vA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">åˆ†ç±»æŠ¥å‘Šï¼›æ— ç‰¹å¾é€‰æ‹©</figcaption></figure><p id="bd97" class="pw-post-body-paragraph lo lp hi kw b kx lq is lr kz ls iv lt ki lu lv lw km lx ly lz kq ma mb mc le hb bi translated">å—¯ğŸ¤”â€¦å¥½å§ï¼Œæ€§èƒ½æ–¹é¢æ²¡æœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚ä½†æ˜¯ï¼Œè¯·å§‹ç»ˆè®°ä½ï¼Œæ¯ç§æ–¹æ³•éƒ½ä¼šå¯¼è‡´æ›´å°çš„ç‰¹å¾ç©ºé—´ï¼Œä»è€Œå¯¼è‡´æ›´å¿«çš„è®­ç»ƒå’Œæ›´å¤šå¯è§£é‡Šçš„æ¨¡å‹ã€‚å› æ­¤ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨æ€§èƒ½ä¸Šæ²¡æœ‰æ”¹è¿›ï¼Œä½†æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ 4 ä¸ªåŠŸèƒ½è€Œä¸æ˜¯ 30 ä¸ªåŠŸèƒ½è·å¾—äº†ç›¸åŒçš„ç»“æœï¼</p><h1 id="bc99" class="ml jy hi bd jz mm og mo kd mp oh mr kh ix oi iy kl ja oj jb kp jd ok je kt mv bi translated">ç»“è®º</h1><p id="70ba" class="pw-post-body-paragraph lo lp hi kw b kx ky is lr kz la iv lt ki mw lv lw km mx ly lz kq my mb mc le hb bi translated">åˆ°æœ¬ç³»åˆ—çš„ç»“å°¾ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œç‰¹æ€§é€‰æ‹©å°±æ˜¯é€šè¿‡æˆ‘ä»¬åœ¨ä¸åŒæ–‡ç« ä¸­æè¿°çš„è¿‡ç¨‹ï¼Œè‡ªåŠ¨ä¿æŒç›¸å…³å’Œæœ‰ç”¨çš„ç‰¹æ€§ã€‚æˆ‘ä»¬ä»ä¸åŒçš„è§’åº¦ç ”ç©¶ç‰¹å¾é€‰æ‹©ä»»åŠ¡ï¼›ä»ç»Ÿè®¡å­¦åˆ°æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚æ€»çš„æ¥è¯´ï¼Œå®ƒå¯ä»¥äº§ç”Ÿæ›´å¥½çš„æ¨¡å‹ï¼Œå®ç°æ›´é«˜çš„æ€§èƒ½å’Œæ›´å¥½çš„å¯è§£é‡Šæ€§ã€‚æœ€åä½†å¹¶éæœ€ä¸é‡è¦çš„æ˜¯ï¼Œæ‹¥æœ‰ä¸€ä¸ªç‰¹å¾å­é›†ä½¿æœºå™¨å­¦ä¹ ç®—æ³•èƒ½å¤Ÿæ›´å¿«åœ°è®­ç»ƒã€‚</p></div></div>    
</body>
</html>