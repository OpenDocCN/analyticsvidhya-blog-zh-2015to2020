<html>
<head>
<title>How to Train a Neural Network Classifier on ImageNet using TensorFlow 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用TensorFlow 2在ImageNet上训练神经网络分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-train-a-neural-network-classifier-on-imagenet-using-tensorflow-2-ede0ea3a35ff?source=collection_archive---------1-----------------------#2020-12-23">https://medium.com/analytics-vidhya/how-to-train-a-neural-network-classifier-on-imagenet-using-tensorflow-2-ede0ea3a35ff?source=collection_archive---------1-----------------------#2020-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bfe6c1e435470f4607e169adfa74fafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_kr3-J7dN_qLniA2vVbeA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">ImageNet数据集中的图像样本，其中每个图像都是1000个类中的一个。</figcaption></figure><p id="765d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">图像分类是计算机视觉中的一个经典问题。今天，这个问题的最先进的模型使用神经网络，这意味着实现和评估这些模型需要使用像PyTorch或TensorFlow这样的深度学习库。</p><p id="6bc1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您可以很容易地找到PyTorch教程，用于下载预训练模型、设置ImageNet数据集和评估模型。但是我在TensorFlow中找不到一个全面的教程来做同样的事情。在本文中，我将向您展示如何实现。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="f8fe" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">要求</strong></p><ul class=""><li id="ed60" class="jz ka hi iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">Python 3</li><li id="8925" class="jz ka hi iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">TensorFlow 2.3.1(用<code class="du kn ko kp kq b">pip3 install tensorflow==2.3.1</code>安装)</li><li id="a7e1" class="jz ka hi iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">TensorFlow数据集(使用<code class="du kn ko kp kq b">pip3 install tensorflow-datasets==4.1.0</code>安装)</li><li id="cecf" class="jz ka hi iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated"><a class="ae kr" href="https://docs.nvidia.com/deeplearning/cudnn/support-matrix/index.html" rel="noopener ugc nofollow" target="_blank"> CUDA和cuDNN </a>(因为我用的是NVIDIA GPU)</li><li id="3baf" class="jz ka hi iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">ILSVRC2012_img_train.tar和ILSVRC2012_img_val.tar，可以从<a class="ae kr" href="http://www.image-net.org/challenges/LSVRC/2012/downloads.php#images" rel="noopener ugc nofollow" target="_blank">这里</a>下载。请注意，这些归档通常存储在只读存储器中(供多个用户使用)，因为它们需要大约156 GB的存储空间。</li></ul></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="9bb0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">概述</strong></p><p id="5169" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们将完成3个基本步骤:准备ImageNet数据集，编译预训练模型，最后评估模型的准确性。</p><p id="3c14" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，让我们导入一些包:</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="3978" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们将下载ImageNet标签，并指定ImageNet归档文件的位置。尤其是<code class="du kn ko kp kq b">data_dir</code>应该是ILSVRC2012_img_train.tar和ILSVRC2012_img_val.tar所在的路径。而<code class="du kn ko kp kq b">write_dir</code>应该是我们想要写入提取的图像内容的目录。确保您的<code class="du kn ko kp kq b">write_dir</code>目录包含<code class="du kn ko kp kq b">extracted</code>、<code class="du kn ko kp kq b">dowloaded</code>和<code class="du kn ko kp kq b">data</code>目录。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="685c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里的关键是我们用关键字参数调用了<code class="du kn ko kp kq b">tfds.load</code>到<code class="du kn ko kp kq b">download_and_prepare</code>调用，指定了我们的归档文件的位置和提取的记录应该放在哪里。</p><p id="b617" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，因为预训练的分类模型将224 x 224的图像作为输入，所以我们需要对数据进行一些预处理。这里我们将使用<code class="du kn ko kp kq b">mobilenet_v2.preprocess_input(i)</code>，但是如果您使用不同的模型，您可以替换这个调用。例如，如果我使用VGG-16，我会调用<code class="du kn ko kp kq b">vgg16.preprocess_input(i)</code>。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="99fb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们编译一个我们选择的模型。在我的情况下，一个移动V2。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="515f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，由于我们设置数据集的方式，我们可以在训练数据上评估该模型，并使用几行代码打印准确性！</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="db26" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有了一个运行良好的预训练分类器，您现在可以对模型进行微调，以满足您的分类问题的需要。下面是<strong class="iw hj">的完整实现</strong>，但也可以在我的GitHub 上找到<a class="ae kr" href="https://github.com/KMVarma/828i_f20/blob/main/notebooks/MobileNetV2%20on%20ImageNet.ipynb" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">下载预训练模型、设置ImageNet数据集以及在Tensorflow 2中评估模型的完整实施</figcaption></figure></div></div>    
</body>
</html>