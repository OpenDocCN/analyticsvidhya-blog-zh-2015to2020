<html>
<head>
<title>Bag Of Visual Words</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">视觉单词包</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bag-of-visual-words-bag-of-features-9a2f7aec7866?source=collection_archive---------2-----------------------#2020-11-05">https://medium.com/analytics-vidhya/bag-of-visual-words-bag-of-features-9a2f7aec7866?source=collection_archive---------2-----------------------#2020-11-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c90c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">视觉单词包(也称为特征包)是一种简洁描述图像并计算图像之间相似性的技术。<br/>用于图像分类。该方法起源于文本检索(信息检索),是 NLP 算法单词包的扩展。在单词包中，我们扫描整个文档并统计文档中出现的每个单词。然后，我们创建一个词频直方图，并使用这个直方图来描述文本文档。在视觉单词包中，我们输入的是图像而不是文本文档，我们使用视觉单词来描述图像。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/20ff89756e67bf3b68a84111452057e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*osAPbj8PHuNDeMeu5okVxg.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">文本文档的单词包</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jp"><img src="../Images/8a7330ab4d16f68edba4b3b0f0e73d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*819Tjz-SatAN1RfeLeqGlw.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">图像视觉词汇包</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ju"><img src="../Images/7354a3ba8a6da889793f49e29ae6681e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*INIjw8nKjYf8NHmXLaoAuw.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">视觉单词</figcaption></figure><p id="87da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 BoVW 中，我们将图像分解成一组独立的特征。特征由关键点和描述符组成。关键点和兴趣点是一回事。它们是图像中的空间位置或点，定义了图像中什么是有趣的或突出的。它们对于图像的旋转、收缩、平移、扭曲等是不变的。关键点是图像中的特定点，比如图像中的每 10 个像素。描述符是关键点的值(描述)。然后，我们使用聚类算法基于这些描述符创建字典或码本。我们通过我们的图像重复，并检查我们的图像是否有字典中存在的单词。如果是，我们增加这个特定单词的计数。最后，我们为这个图像创建直方图。从这个直方图中，我们可以找到相似的图像，或者预测这个图像的类别。</p><h1 id="0e8e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">我们如何创建码本？？？…..</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kt"><img src="../Images/da0497253a3946a1dfd560b23758ca1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJ1PHXFM--YWxGlUWLbbFQ.jpeg"/></div></div></figure><p id="ab44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了创建码本，我们使用 SIFT、BRISK 等特征提取器。如前所述，这些技术检测图像中的关键点，并为输入图像计算它们的值(描述符)。这些特征检测器返回包含描述符的数组。我们对训练数据集中的每个图像都这样做。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ku"><img src="../Images/d2136bd5b67a37b6b17014b20e5ed477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkHtuK7J8oT8fGpf4LFeDQ.jpeg"/></div></div></figure><p id="f838" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将有 N(训练数据集中的图像数)个数组。下一步，我们垂直堆叠这些数组。现在我们将使用类似 K-Means 的聚类算法来形成 K 个聚类。K-Means 将数据点分成 K 组，并将返回每组的中心(见下图)。每个聚类中心(质心)充当一个视觉单词。所有这 K 个质心形成了我们的码本。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kv"><img src="../Images/fbd11270ae66c7b06ef0887b2138e695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lT49odUrYS399CtR991oOw.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">k 均值聚类</figcaption></figure><h1 id="8588" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">创建直方图……..</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kw"><img src="../Images/82be3cdd8b4bb559bbc2a92299a61ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGtLEz1aF4tz9fJKilKdAA.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">检测视觉单词</figcaption></figure><p id="2fdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将创建一个形状为(N，K)的 2D 零数组。我们将在接下来的几行中看到如何填充这个数组。接下来，我们再次遍历图像，在字典中查找图像中的单词。一旦我们检测到一个单词同时出现在字典和图像中，我们就增加这个特定单词的计数(即 array[i][w]+=1，其中 I 是当前图像，w 是这个单词)。这就是我们如何为图像创建直方图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kx"><img src="../Images/ece66bf79157862a04f951729daa5656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tDi3Y4Iz-YZ1n8F0sSLIWQ.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">创建直方图</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ky"><img src="../Images/20a83b8da500bacca14dbb96937b0ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zZuOGtDi3-DF3TWmGrdsFw.jpeg"/></div></div></figure><p id="dafc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，所有的图像将被转换成直方图。现在，我们可以训练一个模型(随机森林，LinearSVC)来对图像进行分类。测试数据集中的图像以相同的方式进行预处理，然后输入模型以预测图像类别。</p><p id="e615" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BoVW 方法适用于捕捉许多细节的大型显微镜图像</p><p id="e14f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，这种方法有一个问题。当视觉单词出现在图像数据库的许多或每幅图像中时，就会出现这种情况。考虑一个文本文档，像 is、are 等这样的词不会有太大帮助，因为它们在所有文档中都存在。这些词使得分类任务更加困难。为了解决这个问题，我们可以应用所谓的 TF-IDF(术语频率-逆文档频率)重新加权方法。它重新加权直方图的每个箱，并降低“无信息”单词(即，在许多图像/任何地方出现的特征)的权重，并增强稀有单词的重要性。</p><p id="7aee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">直方图中每个重新加权的单词都可以使用下图中给出的 TF-IDF 公式进行计算。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kz"><img src="../Images/8fe71fd8f3af255b4a415f17f72aa208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kd109tZSlvhBlSz_uvF_A.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">TF-IDF 加权</figcaption></figure><p id="54ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你用这个公式玩一段时间，你会明白它是如何降低所有图片中出现的单词的重要性的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es la"><img src="../Images/5970921d92f7f3c035a3e753a0873943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpXyGUxyvVXxjuCVS3dPaQ.jpeg"/></div></div></figure><p id="d446" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上图中，你可以看到蓝色单词在重新加权的直方图中的权重几乎为零。</p><p id="c79b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朋友们，这就是我要说的一切……..</p><p id="8223" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请通过提供您的宝贵反馈来帮助我。</p></div></div>    
</body>
</html>