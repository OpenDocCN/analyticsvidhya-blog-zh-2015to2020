<html>
<head>
<title>Adding mixed shaped inputs to a neural network.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向神经网络添加混合形状的输入。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/adding-mixed-shaped-inputs-to-a-neural-network-5bafc58e9476?source=collection_archive---------6-----------------------#2020-07-21">https://medium.com/analytics-vidhya/adding-mixed-shaped-inputs-to-a-neural-network-5bafc58e9476?source=collection_archive---------6-----------------------#2020-07-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e019" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用图像和数字通过Keras进行预测。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/8e55865c14b2a0415cb4cc1c0bdc36a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*slPaqbUsh4Smac_R"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">克里斯里德在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="35be" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在生活中，我们必须处理不同类型的输入；图像、文本、数字等。神经网络也可以。</p><p id="f35c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，假设我们想要构建一个使用位置数据、属性和图像来预测房价的网络。这个过程大概是这样的:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kk"><img src="../Images/4ce1401f1876c850b93c84919e3e1d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*kzR_gt0opS74fvhEU8PA0g.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">图一。神经网络数据流</figcaption></figure><p id="e0dd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们将使用一个简化的示例。我们将输入带有X或I的图像，以及带有0或1的数字数据。输出如下表所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kl"><img src="../Images/bc6b90523a570b997566de3dfee3e790.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*IBvaZDKcHFI_ZhMkKbD9XQ.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">图二。投入产出表</figcaption></figure><p id="53e0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，如果我们添加一个带有X和数字0的图像，我们得到的输出是1。</p><p id="2bda" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在开始构建我们的网络之前，我们导入所需的库:</p><pre class="iy iz ja jb fd km kn ko kp aw kq bi"><span id="62f7" class="kr ks hi kn b fi kt ku l kv kw">import numpy as np<br/>import random<br/>import tensorflow as tf<br/>from tensorflow import keras</span></pre></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h2 id="713a" class="kr ks hi bd le lf lg lh li lj lk ll lm jx ln lo lp kb lq lr ls kf lt lu lv lw bi translated">构建我们的数据</h2><p id="a979" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">让我们从构建输入数据开始。我们将创建两个3x3的黑白图像。</p><pre class="iy iz ja jb fd km kn ko kp aw kq bi"><span id="6608" class="kr ks hi kn b fi kt ku l kv kw">#0 is black, 255 is white.<br/>X_image = [[0,255,0],[255,0,255],[0,255,0]]<br/>I_image = [[255,0,255],[255,0,255],[255,0,255]]</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mc"><img src="../Images/d4c104aae9ba7eaf39c5ef6dfdc80233.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*vO_Y6fcTT-UlY42aTkuf8A.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">图3。x和I，大小增加了100倍。</figcaption></figure><p id="6f5c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们现在将创建我们的数据。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="49d8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们现在有三个数据集；我们的图像和数字输入和输出数组。它们的形状如下表所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mf"><img src="../Images/d7d8ccbc83d067f4bcbe6558bd8e8b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*oSlY7y2-96UJ99nvMArh5Q.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">图4。数据形状</figcaption></figure></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h2 id="c627" class="kr ks hi bd le lf lg lh li lj lk ll lm jx ln lo lp kb lq lr ls kf lt lu lv lw bi translated">设计我们的模型</h2><p id="5de9" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">我们现在可以设计模型的数据流了:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mg"><img src="../Images/5123585b977754100b719b2c9cdbddf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uNvYUsY_weJqCPKaJqAYLw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">图5。模型数据流</figcaption></figure><p id="492f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">构建我们的模型:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="15bc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里，我们使用TensorFlow <em class="mh"> concat </em>层来组合我们的输出，并将它们传递给组合的密集层。</p><p id="775b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">还要注意我们如何能够用卷积层处理图像，用密集层处理数字，这提高了我们的网络性能。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h2 id="9b6c" class="kr ks hi bd le lf lg lh li lj lk ll lm jx ln lo lp kb lq lr ls kf lt lu lv lw bi translated">训练我们的模型</h2><p id="8fba" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">为了训练我们的模型，我们遵循Keras functional API方法:</p><ol class=""><li id="96a5" class="mi mj hi jq b jr js ju jv jx mk kb ml kf mm kj mn mo mp mq bi translated">定义我们的优化器和损失函数。</li><li id="8b30" class="mi mj hi jq b jr mr ju ms jx mt kb mu kf mv kj mn mo mp mq bi translated">定义培训步骤。</li><li id="50af" class="mi mj hi jq b jr mr ju ms jx mt kb mu kf mv kj mn mo mp mq bi translated">定义训练功能。</li><li id="47d6" class="mi mj hi jq b jr mr ju ms jx mt kb mu kf mv kj mn mo mp mq bi translated">火车。</li></ol><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="756a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">模型训练进度如下图所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mw"><img src="../Images/40b9f1867ed0148c47ee67cff17cce19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qkydzhMquY8GXSHuJFNGQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">图6。时代和损失</figcaption></figure><p id="18ae" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">万岁！我们的模型可以100%准确地预测产量。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="19bd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们现在已经建立了使用Keras functional API向模型添加混合数据类型的基础。对于进一步的阅读，我建议查看<a class="ae jn" href="https://keras.io/guides/functional_api/" rel="noopener ugc nofollow" target="_blank"> Keras functional API指南、</a>tensor flow网站，并查看更多关于使用混合数据的<a class="ae jn" href="https://www.pyimagesearch.com/2019/02/04/keras-multiple-inputs-and-mixed-data/" rel="noopener ugc nofollow" target="_blank">示例。</a></p><p id="4bbf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本文使用的代码可以在<a class="ae jn" href="https://github.com/g-vega-cl/Articles/blob/master/Adding_mixed_shaped_inputs_to_a_neural_network/2020_07_20_MixedInputsCode.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>