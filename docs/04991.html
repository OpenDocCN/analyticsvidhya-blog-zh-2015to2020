<html>
<head>
<title>How to build personalized recommendation from scratch: recipes from Food.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从零开始建立个性化推荐:来自Food.com的食谱</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-build-personalized-recommendation-from-scratch-recipes-from-food-com-c7da4507f98?source=collection_archive---------12-----------------------#2020-04-07">https://medium.com/analytics-vidhya/how-to-build-personalized-recommendation-from-scratch-recipes-from-food-com-c7da4507f98?source=collection_archive---------12-----------------------#2020-04-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6ca117e891505365e2f7fd8320be8cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4ey4qpqEsUVlSSfIFvI6Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">信用:<a class="ae iu" href="https://unsplash.com/@dosejuice" rel="noopener ugc nofollow" target="_blank">剂量果汁</a></figcaption></figure><p id="5e65" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文以我最近的一个项目为例，讲述了如何从头开始构建推荐系统。你可以在网上找到的阅读或论文的数量是无穷无尽的，因为它是当今it界广泛使用的系统，仅举几个公司的例子:谷歌、脸书、YouTube、亚马逊等。</p><p id="ca88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，对于初学者来说，从他们的第一个推荐系统项目开始总是势不可挡的。在本文中，我将尽可能简单地解释概念，并尽可能使用例子。</p><p id="6b5f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">#数据</strong></p><p id="380f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据来源于<a class="ae iu" href="https://www.kaggle.com/shuyangli94/food-com-recipes-and-user-interactions#interactions_validation.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>感谢李，它由超过23万的食谱数据，超过22万的用户和超过100万的食谱评论组成。关于可视化和数据探索的更多讨论，请参考我的另一篇博客文章，这是该项目的第一阶段。</p><p id="f53a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">#协同过滤</strong></p><p id="4ef5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们谈论推荐系统时，人们不能回避协同过滤这个术语。简单来说，协同过滤就是根据用户的偏好或产品的特性进行预测(过滤)。返回的预测是我们的建议。</p><p id="e2da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个项目中，我们将讨论两种类型的协作系统，即基于记忆的和基于模型的。最后，我们将看看混合方法如何帮助我们改进建议。你可以在这里找到我的代码<a class="ae iu" href="https://github.com/ZeeTsing/Recipe_reco" rel="noopener ugc nofollow" target="_blank">的完整库。</a></p><p id="845c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">#模型1:潜在狄利克雷分配(LDA)特征提取+基于记忆</strong></p><p id="eb2c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了构建我们的第一个模型，我们首先假设用户喜欢与他们过去喜欢和/或查看过的食谱相似的食谱。换句话说，如果用户喜欢巧克力蛋糕，那么很可能用户也喜欢巧克力馅饼(考虑它们是相似的)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/2e3a2b8d55ced7d0500a239bcbbd4783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5AGgYBQGUlS4gq3Z"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">下午吃点巧克力蛋糕吗？信用:<a class="ae iu" href="https://unsplash.com/@heftiba" rel="noopener ugc nofollow" target="_blank"> <br/> @heftiba </a></figcaption></figure><p id="cdb9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的第一个模型使用LDA作为食谱成分的特征提取:每个食谱被转换成由单词袋模型表示的矩阵，然后LDA模型将处理并生成对主题有贡献的可能单词的线性组合。推荐模型计算数据库中每个食谱之间的距离或“相似度”，并“记住”它(内存)。</p><p id="8ea3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你也可以在我的另一个博客中阅读更多关于LDA的内容。</p><p id="f9fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，当我们主要使用主题来计算食谱之间的距离时，如果它们属于同一个主题，我们会期望很多相似的食谱。例如，我们认为法国香草焦糖布丁的配方与巧克力焦糖布丁的配方相似。这是我们在给出推荐时尽量避免的:相似但不太相似作为同一物品的变体。因此，我们在代码中添加了一个转折，以确保一旦生成某个组的推荐，该推荐会计算不同主题组中的相似度。</p><p id="e238" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">优点:</strong>方法通俗易懂；</p><p id="5f21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">缺点:</strong>时间和计算效率低，当有百万或万亿字节的数据时，会非常慢；</p><p id="1e05" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">#模型2:用户特征+基于模型(SVD) </strong></p><p id="279a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第二个模型以不同的方式假设用户行为:现在我们假设用户喜欢与他们相似的用户喜欢的食谱。例如，如果用户A喜欢炸鸡、薯条和汉堡食谱，而用户B喜欢炸鸡和薯条食谱，我们的模型说用户B可能也喜欢汉堡。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/51aa9f93f8e13ccb55b170cbdcbf16a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LfknMUzCmpMUNfCl"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">还有炸鸡？信用:<a class="ae iu" href="https://unsplash.com/@haseebjkhan" rel="noopener ugc nofollow" target="_blank">哈苏卜·贾米尔</a></figcaption></figure><p id="4135" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该模型首先构建一个用户-产品矩阵，代表用户对配方的评论和评论历史。每个用户由单行表示，而列表示用户与配方的交互历史。为了实现过滤，我们选择使用一种称为奇异值分解(SVD)的技术。简而言之，SVD试图将原始矩阵中的信息压缩成一个更小的矩阵，同时也将相似的条目聚集在一起。</p><p id="3d13" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">优点:</strong> SVD算法通过给出有效的推荐而在推荐系统中工作良好。</p><p id="0f3e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">缺点:</strong>当数据太多时，算法可能很昂贵；解释不是直截了当的。</p><p id="6ada" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> #模型3:配方特征+基于模型(SVD) </strong></p><p id="4cd9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">模型3做出了与模型1相同的假设，模型1侧重于配方。在这个模型中，我们使用了食谱所有可能的属性，而不仅仅是配料。这应该会让我们对食谱有一个全面的了解。</p><p id="9b92" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用户-产品矩阵现在变成了“配方-属性”矩阵，而配方由行表示，属性由列表示。然后使用奇异值分解算法实现该模型。</p><p id="37a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">优点&amp;缺点:</strong>与模型2相同</p><p id="d9eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">#车型4:混合动力车型</strong></p><p id="0e3f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你读过像Netflix推荐系统奖这样的推荐系统中的著名案例，你会意识到优秀的系统通常会采用混合方法来提高推荐准确度。</p><p id="2c1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用简单的话来说，一个混合模型可以跟踪人群的预测能力。在我们的混合模型中，我们将模型2和模型3的结果结合起来，这样我们就可以同时捕获食谱的特征和用户的历史。最后的推荐是由两个模型产生的推荐的简单平均值。</p><p id="8406" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">优点:</strong>比单一模型更好的预测能力，可以泛化，减少过拟合；</p><p id="1e3e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">缺点:</strong>很难解释。</p><p id="8546" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">#结果</strong></p><p id="bf4a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们对所有四个模型都尝试了相同的输入，以便您可以判断我们的模型表现如何。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/e0a0ae26ffd6b5f52f2c4dbbb59de534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lMISpXd69TlZEnzwkMc34w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型1和2产生的建议</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/6a65f54e20b4696c31f70a36112f5790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VYp2hEK-MCp8PzJvEgo2jw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型3和4产生的建议</figcaption></figure><p id="d5ef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有四个输入项目:黄油蛋糕，奶酪卷，鸡胸肉Saltimbocca和瑞士蟹融化。四种菜肴中有三种使用奶酪，所以当我发现有人推荐比萨饼或奶酪相关的食谱时，我不会感到惊讶。黄油蛋糕是一种甜点，所以蛋糕或甜点推荐似乎也很自然。</p><p id="0c51" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了评估我们的模型性能，我们需要在没有实际用户输入的情况下使用precision@k，recall@k。我们还没有实现评估，但我们把它作为读者探索的下一步。</p><p id="a1d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">#讨论</strong></p><p id="fb26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除了用正确的标准完成项目。还可以部署在真实的生产环境中以收集更多信息。</p><p id="0c3d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">推荐系统的领域是巨大而深刻的。如果熟悉深度学习，还可以考虑用编解码算法构建推荐系统。</p><p id="9229" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢您的阅读，希望您喜欢！</p></div></div>    
</body>
</html>