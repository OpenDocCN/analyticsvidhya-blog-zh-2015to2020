<html>
<head>
<title>Web Scraping in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的Web抓取</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/web-scraping-in-python-2b592dd48df?source=collection_archive---------11-----------------------#2019-09-23">https://medium.com/analytics-vidhya/web-scraping-in-python-2b592dd48df?source=collection_archive---------11-----------------------#2019-09-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d24c283565fa606c39c011b410f976f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*39pzxP1Y1FPeHhkkGh5akg.png"/></div></div></figure></div><div class="ab cl iq ir gp is" role="separator"><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv"/></div><div class="hb hc hd he hf"><h1 id="1997" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated"><strong class="ak">简介</strong></h1><p id="7b65" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">目前，世界正朝着数据科学和机器学习的方向发展。这些领域需要的燃料是数据，我们从以下两个主要来源获得数据:</p><blockquote class="kt ku kv"><p id="ffe7" class="jv jw kw jx b jy kx ka kb kc ky ke kf kz la ki kj lb lc km kn ld le kq kr ks hb bi translated">1)使用API:</p></blockquote><p id="7dd8" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">这些API由允许检索数据的各种网站公开。示例:脸书图形API</p><blockquote class="kt ku kv"><p id="59d1" class="jv jw kw jx b jy kx ka kb kc ky ke kf kz la ki kj lb lc km kn ld le kq kr ks hb bi translated">2)网页抓取:</p></blockquote><p id="1d61" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">在这种技术中，抓取网页以提取有用的信息。这种技术被称为网络抓取或网络采集或网络数据提取。</p><h1 id="354e" class="ix iy hi bd iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju bi translated"><strong class="ak">抓取网页的步骤:</strong></h1><p id="4d55" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jx hj">第一步:</strong></p><p id="ea39" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">安装所需的第三方库。这可以通过下面的命令来完成</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="1f89" class="lt iy hi lp b fi lu lv l lw lx">pip install requests</span><span id="6c05" class="lt iy hi lp b fi ly lv l lw lx">pip install html5lib</span><span id="a803" class="lt iy hi lp b fi ly lv l lw lx">pip install bs4</span></pre><p id="40a6" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">第二步:</strong></p><p id="a03a" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">在python项目或您的笔记本中导入库</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/15714cca607a08b2f943113b2cafe974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*aWc5_KeT7Cwc-6vifZLcsA.png"/></div></figure><p id="43c9" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">如果你想知道为什么我们需要这些库，我们在哪里使用它。别担心，我们会为您提供以下步骤:</p><p id="b8ab" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">第三步:</strong></p><p id="95ec" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">向您想要访问其数据的网页的url发送HTTP请求。在此步骤中，服务器将使用网页的html内容进行响应，该内容可用于提取数据。</p><p id="3243" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">使用请求库在python中发送http请求</p><p id="c750" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">让我们使用一个示例网站来看看如何做到这一点</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/faa058b929183355648506ba1c7e1a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRxK66U2zqckXU1-tHJFuQ.png"/></div></div></figure><p id="32f3" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">第四步:</strong></p><p id="6a20" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">到目前为止，事情相当简单。现在让我们用BeautifulSoup来解析这个html响应，让它变得更有趣一些。这个库建立在各种库之上，如html5lib、lxml、html.parser等。</p><p id="e2ed" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">让我们在代码中使用它</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/9776a32f687261cf9e6d37e5c6fc5b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LPlleEqkY6cwV0zEkmu6hA.png"/></div></div></figure><p id="27ef" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">这里，</p><blockquote class="kt ku kv"><p id="de4b" class="jv jw kw jx b jy kx ka kb kc ky ke kf kz la ki kj lb lc km kn ld le kq kr ks hb bi translated"><strong class="jx hj"> r.content </strong>:原始HTML内容。</p><p id="6c8c" class="jv jw kw jx b jy kx ka kb kc ky ke kf kz la ki kj lb lc km kn ld le kq kr ks hb bi translated"><strong class="jx hj"> html5lib </strong>:指定html解析器。</p><p id="0cf9" class="jv jw kw jx b jy kx ka kb kc ky ke kf kz la ki kj lb lc km kn ld le kq kr ks hb bi translated"><strong class="jx hj">soup . pretify():</strong>它给出了从原始HTML内容创建的解析树的可视化表示。</p></blockquote><p id="1402" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">第五步:</strong></p><p id="f5f7" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">现在让我们搜索并解析我们在soup变量中得到的这棵树。如果你仔细观察，我们会对id为 的<strong class="jx hj"> <em class="kw"> div的内容感兴趣</em></strong></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/b92f85484db971943b53147b1e0a7add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fpS2PXJDCNdDytMT3Oqwlw.png"/></div></div></figure><p id="cb80" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">我们可以用下面的行提取这个div</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/bd00d8bf4d01bc59e4b7d9bf15414d53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPCtEmyMJzcZFW9BIfQIWw.png"/></div></div></figure><p id="6960" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">唷</strong>！我们现在非常接近我们的数据。让我们在这个div上写一个循环，找到所有可以用来检索有用信息的td。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/8e6483ea99dad93fc7ec63d08bb27d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uigSkM67ODD_-bQfQmkp8g.png"/></div></div></figure><p id="3ed9" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">在上面这段代码中，我们创建了一个字典来保存一行表中的所有信息。可以使用点符号来访问嵌套结构。为了访问HTML元素中的文本，我们使用了<strong class="jx hj">。正文</strong></p><p id="e9eb" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">第六步:</strong></p><p id="fd16" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">最后一步</strong>！将这些数据转储到excel中。这包括几个子步骤:</p><ol class=""><li id="8278" class="mf mg hi jx b jy kx kc ky kg mh kk mi ko mj ks mk ml mm mn bi translated">导入excel writer(可使用<strong class="jx hj"> pip install xlwt </strong>下载)</li></ol><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/13461f7e1f634de1de6c088432859efc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uo5XCcjiJFVFyjcIQDH_3w.png"/></div></div></figure><p id="de7b" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">2.创建带有一个选项卡的excel工作簿</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/2c3ac684940f5562f30fa06fe0ba120b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2AC-bEY5__7paIAUNX1FZg.png"/></div></div></figure><p id="370c" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">3.将标题信息写入此工作表1</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/df762618ee84657fd782f53c047d200b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Saa0sdiAXZA1ao6cY2noVw.png"/></div></div></figure><p id="54ce" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">4.现在写下我们从网页上提取的信息</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/6297a921ada6b8aa9ded9188bfd5af1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OuVHihR_k2FZmvWsoph8RQ.png"/></div></div></figure><p id="d731" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">5.保存excel</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/1d7855c3a7e736fb6d9b67d00a87e12d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*e3sxSgtqZnPiENGgXrMmZw.png"/></div></figure><p id="68d8" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">现在让我们看看我们的excel是什么样子的</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/5759b046084a95d345a7179bdb3f9a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kw8gLDjO3nB-mPuqEr1WVQ.png"/></div></div></figure><p id="6b83" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">恭喜</strong>！您已经成功抓取了一个网页，从中提取了有用的内容。同样，你也可以在其他网页上试试。</p><p id="db56" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated"><strong class="jx hj">我能抓取任何网站吗？？？</strong></p><p id="d5fd" class="pw-post-body-paragraph jv jw hi jx b jy kx ka kb kc ky ke kf kg la ki kj kk lc km kn ko le kq kr ks hb bi translated">你可以在几乎任何网站上进行抓取，大多数网站都倾向于实施屏蔽来防止他们的网站被抓取。您可以在robots.txt文件或服务条款中找到这些块。然而，这些规则决不是由法律强制执行的。</p></div></div>    
</body>
</html>