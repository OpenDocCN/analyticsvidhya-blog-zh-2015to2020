<html>
<head>
<title>Transfer Learning — Reusing a pre-trained Deep Learning model on a new task</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移学习——在新任务中重复使用预先训练的深度学习模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/reusing-a-pre-trained-deep-learning-model-on-a-new-task-transfer-learning-1c0a25a92dfb?source=collection_archive---------0-----------------------#2018-12-18">https://medium.com/analytics-vidhya/reusing-a-pre-trained-deep-learning-model-on-a-new-task-transfer-learning-1c0a25a92dfb?source=collection_archive---------0-----------------------#2018-12-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7284435b8a3581ae9f6f9390265a9d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*981XgBH42QOdHReYZoJdzw.jpeg"/></div></div></figure><p id="340a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated">在向有志之士教授<em class="jx">数据科学</em>一年多之后，我想我可以肯定地说<strong class="is hj">迁移学习</strong>是一个困扰很多学生的概念。对于他们中的大多数人来说，这更像是“<em class="jx">不是机器学习，而且随着深度学习越来越深入，那现在我还需要了解一些迁移学习吗？</em>”。但在大多数情况下，有志者甚至不会意识到这个术语(<em class="jx">迁移学习</em>)，因为MOOCs并不真正使用这个术语(<a class="ae jy" href="https://www.youtube.com/watch?v=yofjFQddwHE" rel="noopener ugc nofollow" target="_blank">除了吴恩达</a>)。然而，在线教育门户网站上的专家讲师甚至不会跳过这个话题，只是他们没有明确使用这个术语，导致大量好奇的学习者经常提出类似于“<em class="jx">我知道如何训练一个模型，并且已经这样做了，但现在如何将这个预先训练好的模型用于新的任务？</em>“因此，让我们试着用简单的术语从概念上分解这个主题，以填补空白。</p><p id="2425" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在整篇文章中，我不会重复发明轮子，也不会叙述别人根本没有解释过的事情。所以当你觉得“<strong class="is hj"> <em class="jx">我本可以自己完成这件事的时候&amp;不需要他来告诉我！</em> </strong>”，我的回答是“<em class="jx">请这么做，因为在这个数字时代我们已经有足够的免费资源了&amp;没有比自己研究更好的方法了</em>”。但是对于那些努力寻找相关信息的学习者来说，我们将依次采取步骤来理解&amp;引导我们自己找到可以帮助我们理解这个重要概念的资源。</p><p id="937b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每当我们发现自己迷失的时候，我们的第一反应就是搜索<strong class="is hj"> <em class="jx">谷歌</em> </strong>，对吗？而且往往<strong class="is hj">维基</strong>搜索结果高居搜索引擎结果榜首，那么让我们先从什么<em class="jx"> </em> <a class="ae jy" href="https://en.wikipedia.org/wiki/Transfer_learning" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> <em class="jx">维基</em> </strong> </a> <em class="jx"> </em>说:</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/6dc4bbc51fcc1b43b008860bec7c1e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jeQqD8fEUhZOIwk0Soa3xA.png"/></div></div></figure><p id="f5dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“<strong class="is hj"> <em class="jx">储存在解决一个问题时获得的知识，并将其应用于另一个不同但相关的问题</em> </strong>”之所以被强调，是因为这是我们一开始就需要向我们的灰色细胞提供的所有信息。尝试用一个更简单的例子在你的脑海中重现它，比如:作为一个酷的新时代游戏千禧一代，如果你知道如何使用<a class="ae jy" href="https://www.techopedia.com/definition/7363/gamepad" rel="noopener ugc nofollow" target="_blank">游戏手柄</a>(手持控制器或游戏手柄)，你就很有可能开始玩视频游戏，无论是在<a class="ae jy" href="https://en.wikipedia.org/wiki/Xbox" rel="noopener ugc nofollow" target="_blank"> <em class="jx"> Xbox </em> </a>上还是在<a class="ae jy" href="https://en.wikipedia.org/wiki/PlayStation" rel="noopener ugc nofollow" target="_blank"> <em class="jx"> PlayStation </em> </a>上。</p><p id="b2cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设，你的大脑最初接受了使用<em class="jx">游戏手柄</em>的训练，同时在<em class="jx"> PlayStation </em>上玩游戏，后来当你也购买了<em class="jx"> Xbox </em>时，你的大脑自动转移了那个<em class="jx">游戏手柄</em>控制/使用模型，并将其调整到你的大脑已经开始为Xbox上的游戏创建的知识管道。这使得你的大脑在学习<em class="jx"> Xbox </em>时非常容易工作，因为它部分使用了预先训练的(<em class="jx">游戏手柄</em>)模型，并根据Xbox游戏体验的要求快速定制它。</p><p id="9d30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们有了一点概念上的理解，让我们想想为什么深度学习模型是固有的。那么深度学习模型有效的特殊要求是什么？<strong class="is hj"> &gt; </strong> <strong class="is hj">深度学习模型很像我们的女朋友</strong>，<strong class="is hj">无论我们为她们做(喂)多少(数据量)，她们都不会满意，所以我们得到的回报只是成本(指成本/损失误差)</strong>。但是如果我们运气好的话，我们可能只是找到了适合自己的女孩(深度学习模型)，而当这种罕见的事情发生时，我们就是放不下她(预训练模型)，对吗？</p><p id="91ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样，一个优秀的预训练模型可以成为我们的多用途工具，因为它可以帮助完成许多其他事情，因此迁移学习是高级预测神经网络算法的一个重要概念。<strong class="is hj"> &gt; </strong>另一个重要的方面是，在现实世界中，<strong class="is hj">为每项任务装配一个巨大的标签化数据集就像陪我们的女朋友去购物一样困难</strong>。但是如果我们知道女朋友的BFF(预训模特)也在镇上呢？当我们享受利物浦带着啤酒和披萨与切尔西比赛的时候，难道我们不应该更喜欢让他们两个都去疯狂购物(为其他任务训练新模型)吗？</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/7cbfa01452400abc3a3721e7532b8d00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smuLscJDGufKaqTfXbewng.jpeg"/></div></div></figure><p id="58c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为这个假设的女朋友已经帮助我们理解了迁移学习的必要性，所以让我们继续来弄清楚在实施这个概念的过程中统计上发生了什么。例如，在计算机视觉场景中，深度学习算法通常试图辨别初始层中的边缘、中间层中的形状以及最终层中的一些必要的议程特定特征。<strong class="is hj">通过迁移学习，我们重用预训练模型的初始层和中间层，只为新任务</strong>重新训练最终层。当我们没有足够的标记数据来完成我们的新任务时，这非常方便，也因为像神经网络、<a class="ae jy" href="https://en.wikipedia.org/wiki/Bayesian_network" rel="noopener ugc nofollow" target="_blank">贝叶斯网络</a>或<a class="ae jy" href="https://en.wikipedia.org/wiki/Markov_logic_network" rel="noopener ugc nofollow" target="_blank">马尔可夫逻辑网络</a>这样的训练算法是非常计算详尽的。注意，这个过程也有局限性，我们将在本文的后面讨论。</p><p id="c024" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了进一步扩展我们关于刚才提到的图像识别示例的迁移学习的知识，让我们快速浏览一下<a class="ae jy" href="https://www.linkedin.com/in/andrewyng/" rel="noopener ugc nofollow" target="_blank">吴恩达</a>的这个富有洞察力的会议，他演示了(参考作为新任务<em class="jx">的<em class="jx">放射学诊断</em>)</em>新模型(使用放射学图像数据集)中最终层的新权重集的初始化<em class="jx"> </em>，同时保持我们预训练模型的初始&amp;中间层完好无损。随着进一步的替代改进，我们的源(预训练)模型的所有权重得到修改，而不是简单地重新初始化和学习目标(新)模型中最终分类层的权重。随着培训数据可用性的增加，这种额外的模型灵活性开始产生效益。现在让我们来听听这个活生生的传说:</p><figure class="ka kb kc kd fd ij"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="1bc6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">信息量很大，对吧？但在某个地方，它可能会戳中你的头脑，为什么所有地方的转移学习的参考大多是计算机视觉(特别是图像)相关的。所以<strong class="is hj">让我们换个话题，现在来看看<em class="jx">自然语言处理</em> (NLP) </strong>。多年来，NLP领域缺乏一个已建立的参考数据集和源任务来学习可概括的基础模型，因此'<em class="jx">微调预训练的</em>'模型的社区不是那么大。</p><p id="6571" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，最近的论文，如Howard和Ruder的<a class="ae jy" href="https://arxiv.org/pdf/1801.06146.pdf" rel="noopener ugc nofollow" target="_blank">“用于文本分类的通用语言模型微调”</a> &amp;拉德福德的论文<a class="ae jy" href="https://s3-us-west-2.amazonaws.com/openai-assets/research-covers/language-unsupervised/language_understanding_paper.pdf" rel="noopener ugc nofollow" target="_blank">“通过生成性预训练提高语言理解”</a>展示了在自然语言领域有前途的模型微调能力。尽管这些论文中的源数据集各不相同，但社区似乎正在标准化一个“<em class="jx">语言建模</em>”目标，作为训练可转移基础模型的途径。显而易见的好处来自于这样一个事实:原始文本对于每一个可以想到的领域都是大量可用的，并且<em class="jx">语言建模</em>具有不需要带标签的训练数据的理想属性。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/45a3cbab7bb6865598257d4b660bccb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qaNJXrLZLL38H6JGON85OA.png"/></div></div><figcaption class="ki kj et er es kk kl bd b be z dx translated">【必读】一篇关于KDNuggets 的非常全面的<a class="ae jy" href="https://www.kdnuggets.com/2018/10/more-effective-transfer-learning-nlp.html" rel="noopener ugc nofollow" target="_blank">文章，关于“<strong class="bd km">NLP</strong>的有效迁移学习”</a></figcaption></figure><p id="ef88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我可以给你一些高端的例子，在这些例子中，迁移学习已经被应用于深度学习，并被观众广泛接受，但如果你处于初始学习阶段，架构可能会很快变得复杂，因此我不会这样做。仍然只是列举几个供你参考(如果你希望更多地了解它，或者可能只是出于采访的目的):<strong class="is hj">&gt;Google的Inception模型</strong><a class="ae jy" href="https://ai.googleblog.com/2016/03/train-your-own-image-classifier-with.html" rel="noopener ugc nofollow" target="_blank">在Google AI博客上使用TensorFlow实现简单的图像分类</a><strong class="is hj">&gt;微软的ResNet模型</strong><a class="ae jy" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank">原文</a> <em class="jx">但是</em>从这个<a class="ae jy" rel="noopener" href="/@14prakash/understanding-and-implementing-architectures-of-resnet-and-resnext-for-state-of-the-art-image-cf51669e1624">开始易于理解</a>使用PyTorch首先实现<strong class="is hj"> &gt;</strong></p><p id="e996" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了我在整篇文章中附上的所有超链接，你就可以使用TensorFlow、PyTorch等工具在特定场景中实现迁移学习了。主要在计算机视觉和自然语言处理领域有深度学习模型。在实现之前，我们需要理解<a class="ae jy" href="https://arxiv.org/abs/1411.1792" rel="noopener ugc nofollow" target="_blank">我们的源模型的特性有多大的可移植性</a>，以及我们是否做了足够的工作来避免常见的缺点。<strong class="is hj">我们还需要注意一些缺点，比如:&gt; </strong>我们可能会在新数据集的架构灵活性方面受到<em class="jx">的限制。&gt; <em class="jx">对于目标任务，学习率通常保持很低</em>，因为我们相信我们的源模型的权重，并且不急于以任何方式太快地扭曲它们。</em></p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/51261552fde3894e83231d89587abf2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7bQvSHX_bX7_cbCeL9OYXQ.jpeg"/></div></div></figure><p id="ac36" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总的来说，到目前为止，我们观察到了对方法论的概念性理解、数学倾向、流行的实现领域、很少的实际例子，以及迁移学习的常见缺陷。继续，问题是<strong class="is hj">迁移学习本身是否在每个方面都是如此有效的解决方案，以至于它可以成为任何深度学习问题的明确解决方案</strong>？不幸的是，答案是<strong class="is hj">不</strong>，因为“<em class="jx">在统计学习中没有免费的午餐”</em>。</p><p id="dd8d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是将其他微调概念集成到执行管道中的地方。这里有一个由Sebastian Ruder 撰写的<a class="ae jy" href="http://ruder.io/transfer-learning/" rel="noopener ugc nofollow" target="_blank">机器学习博客，详细介绍了这些概念，以及更多类似于</a><a class="ae jy" href="https://en.wikipedia.org/wiki/Semi-supervised_learning" rel="noopener ugc nofollow" target="_blank">半监督学习</a>、<a class="ae jy" href="https://www.youtube.com/watch?v=UdXfsAr4Gjw" rel="noopener ugc nofollow" target="_blank">多任务学习</a>、<a class="ae jy" href="https://arxiv.org/pdf/1707.00600.pdf" rel="noopener ugc nofollow" target="_blank">零起点学习</a>等等，所以我强烈推荐看看这个博客。杰森·布朗利的另一个博客<a class="ae jy" href="https://machinelearningmastery.com/transfer-learning-for-deep-learning/" rel="noopener ugc nofollow" target="_blank">值得关注。如果您希望我涵盖其中的任何概念，请在<em class="jx">评论</em>部分告诉我。感谢您的时间，并享受机器学习！</a></p><p id="8d6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">页（page的缩写）s:本文中提到的任何性别/关系仅仅是为了增加一点幽默&amp;绝对没有冒犯任何人的意思。:)</p></div></div>    
</body>
</html>