<html>
<head>
<title>Deploying Django app on Heroku with GitHub</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GitHub在Heroku上部署Django应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploying-django-app-on-heroku-with-github-fb3e3aaaa633?source=collection_archive---------3-----------------------#2020-07-11">https://medium.com/analytics-vidhya/deploying-django-app-on-heroku-with-github-fb3e3aaaa633?source=collection_archive---------3-----------------------#2020-07-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ff0f08fbdf87cc8f59a23e02392c814a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RKww7E3bI2YKr1Mww62skw.png"/></div></div></figure><p id="bf69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Heroku提供了许多强大的特性，可以在实时服务器上部署项目，以便从世界上的任何地方访问它。最简单的方法是将其与GitHub集成，并在GitHub上部署代码。Heroku可以自动构建并发布(如果构建成功)pushes到指定的GitHub存储库。</p><p id="9ceb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">先决条件</em> </strong> : GitHub账号和Django App。</p><p id="7208" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我们要做的事情的清单-</p><ul class=""><li id="9b4c" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><em class="jo">在Heroku上创建应用</em></li><li id="666a" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><em class="jo">准备部署应用</em></li><li id="116b" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><em class="jo">将代码推送到GitHub </em></li><li id="4d13" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><em class="jo">部署在Heroku </em></li></ul><p id="8119" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们开始吧！</p><h2 id="7fa8" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">1.在Heroku上注册并创建一个应用</h2><p id="ab60" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">在此输入您的详细信息<a class="ae ld" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank">注册一个免费的heroku帐户</a>。</p><p id="785a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">登录您的帐户，点击新建&gt;<strong class="is hj">创建新应用</strong>。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/f9b6f11da663a8a6d39344c6e11f3c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nmkBI9GxjYC3AyPp19EgVA.png"/></div></div></figure><p id="ed41" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输入唯一的应用名称。(有时可能需要尝试几次才能看到可用的内容)。检查地区并点击创建应用程序。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/d6dad81ff33c64ff3d0deb06705aea84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sG5UN8hZoYL1eXR3oTOxw.png"/></div></div></figure><h2 id="5807" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">2.正在为部署准备Django应用程序</h2><p id="a1d7" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">为部署准备Django App包括向项目根目录添加几个文件、安装几个包以及为heroku部署配置settings.py文件。一头扎进去，跟着步骤走-</p><p id="7feb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Django settings.py中，将调试值设置为False，并在<strong class="is hj"> ALLOWED_HOSTS </strong>中，输入我们刚刚在上面创建的heroku应用程序域名。</p><pre class="lf lg lh li fd lk ll lm ln aw lo bi"><span id="846d" class="kd ke hi ll b fi lp lq l lr ls">DEBUG = False</span><span id="baf8" class="kd ke hi ll b fi lt lq l lr ls">ALLOWED_HOSTS = ['mrmapp.herokuapp.com']</span></pre><p id="d929" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，安装<strong class="is hj"> django-heroku </strong>包。这将自动配置您的Django应用程序在Heroku上工作。</p><pre class="lf lg lh li fd lk ll lm ln aw lo bi"><span id="094e" class="kd ke hi ll b fi lp lq l lr ls">pip install django-heroku</span></pre><p id="6f0f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在settings.py文件<code class="du lu lv lw ll b"><strong class="is hj">import django_heroku</strong></code>的顶部，并在文件底部添加以下语句。</p><pre class="lf lg lh li fd lk ll lm ln aw lo bi"><span id="5d27" class="kd ke hi ll b fi lp lq l lr ls"># Activate Django-Heroku.<br/>django_heroku.settings(locals())</span></pre><p id="23b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，安装以下软件包-</p><pre class="lf lg lh li fd lk ll lm ln aw lo bi"><span id="fff8" class="kd ke hi ll b fi lp lq l lr ls">pip install gunicorn<br/>pip install whitenoise</span></pre><p id="4587" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Gunicorn </strong>是一个用于WSGI应用程序的Python-HTTP服务器，而<strong class="is hj">whiten noise</strong>允许我们的web应用程序提供自己的静态文件。现在在你的项目settings.py中添加<strong class="is hj">' whiten noise . MIDDLEWARE . whitenoisemiddleware '，</strong>在中间件部分如下图所示-</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/75af389d7b0e7c4dbe758d3a7e469c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gi2JH7efzzz0BR0O5iK4WQ.png"/></div></div></figure><p id="7f0e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于Heroku不提供静态文件，我们需要在我们的项目settings.py文件中配置<strong class="is hj"> STATIC_ROOT </strong>,方法是在我们的static_url上面添加下面一行</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/a0845bd4df3388cba797d28b32006ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*al1ThITSSX12OGIhnk5RTA.png"/></div></div></figure><p id="8ef3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，在应用程序的根目录(包含manage.py)中创建一个名为“<strong class="is hj"> Procfile </strong>”的文件，不包含任何文件扩展名。它指定了应用程序在启动时执行的命令。这里，我们通过在文件中添加下面一行来指定流程类型</p><pre class="lf lg lh li fd lk ll lm ln aw lo bi"><span id="09f7" class="kd ke hi ll b fi lp lq l lr ls">web: gunicorn projectname.wsgi --log-file -</span></pre><p id="2621" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:项目名称应该是包含wsgi文件settings.py文件的文件夹的名称</p><p id="057f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，在django项目根目录(manage.py文件所在的位置)中创建一个文件<strong class="is hj"> runtime.txt </strong>。这告诉Heroku我们正在使用哪个版本的python。输入您在文件中使用的python版本。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/6d7e89464a4a0235171daf1868bf3fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vPnOfnKp53DaM7eC_WDfVw.png"/></div></div></figure><p id="17e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在终端中运行以下命令</p><pre class="lf lg lh li fd lk ll lm ln aw lo bi"><span id="04d7" class="kd ke hi ll b fi lp lq l lr ls">pip freeze &gt; requirements.txt</span></pre><p id="a4bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将在根目录中创建一个<strong class="is hj"> requirements.txt </strong>文件(与包含manage.py文件的文件相同),该文件包含项目运行所需的所有包及其版本的列表。文件中指定的所有依赖项都会在heroku中的应用程序启动之前自动安装。(如果您安装新的软件包并运行相同的命令，它将更新现有的文件)</p><p id="cbc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">项目设置到此结束，接下来我们将把代码推送到GitHub并部署它。</p><h2 id="9aa5" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">3.把代码推给GitHub</h2><p id="c993" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">我使用PyCharm IDE并创建了一个私有存储库，然后将我的代码推送到GitHub。为此，在菜单栏中导航到VCS &gt;导入到版本控制&gt;在GitHub上共享项目。输入存储库名称，选中私有和共享。查看详情<a class="ae ld" href="https://www.jetbrains.com/help/pycharm/manage-projects-hosted-on-github.html#share-on-GitHub" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="d3bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一种方法是，在您的GitHub帐户中创建一个空的私有存储库。将文件(离开虚拟环境ENV文件夹)从项目文件夹直接拖放到repo，并将它们提交到主分支。</p><p id="7e82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您有一个现有的repo，那么推送最新的代码并将其合并到主分支，因为我们将部署主分支本身。</p><h2 id="782b" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">4.在Heroku的部署</h2><p id="5d41" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">在Heroku中，导航至您的应用程序&gt;设置。向下滚动并点击<strong class="is hj">添加build pack</strong>T14】选择Python &gt;保存更改</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/eebb6c84e59ea90c338afb5eabb1baca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fe4LKw6aB_vWTyIoLTYXrg.png"/></div></div></figure><p id="134a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导航到部署选项卡，在部署方法下&gt;点击GitHub。点击下面的<strong class="is hj">连接到GitHub </strong>按钮。出现一个弹出窗口，要求授权连接到您的GitHub帐户。点击授权Heroku。在Connect to GitHub部分，搜索您的存储库。点击连接。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/85e0b19ac69a05aa2e4346bccf604a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mVToHT4L9AyX1H_Iu36XKw.png"/></div></div></figure><p id="9b35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">连接后，您可以选择手动或自动部署它。通过手动部署，您可以从连接的存储库中创建任何分支的即时部署。如果要控制何时将更改部署到Heroku，请使用手动部署。</p><p id="73e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果希望在每次对主服务器进行新的推送时进行部署，可以使用自动部署。当您为分支启用自动部署时，Heroku会自动构建并部署对该分支的所有推送。</p><p id="8f5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择分支(主)并点击<strong class="is hj">部署分支</strong>。这将启动构建过程，一旦完成，将显示一条成功消息。</p><p id="154a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击<strong class="is hj">查看</strong>按钮。这应该会在浏览器中启动您的应用程序，您的应用程序现在已经启动，可以在世界任何地方访问，祝贺您！</p></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="8afa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">页（page的缩写）如果你想在AWS上托管你的数据库并连接到heroku，你可以关注我的博客<a class="ae ld" rel="noopener" href="/swlh/creating-a-postgresql-db-on-aws-and-connecting-it-to-heroku-django-app-29603df20c2a">这里</a>。快乐阅读！</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/ccbff5b9c3801b5f65dfd990715c648e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zdyWnOEHPQlpo0Mw"/></div></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">本·科尔德在<a class="ae ld" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div></div>    
</body>
</html>