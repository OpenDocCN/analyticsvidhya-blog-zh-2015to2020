<html>
<head>
<title>Supervised Learning — Linear Regression (Using R)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">监督学习—线性回归(使用R)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/supervised-learning-linear-regression-using-r-93f48c6c394d?source=collection_archive---------1-----------------------#2020-04-27">https://medium.com/analytics-vidhya/supervised-learning-linear-regression-using-r-93f48c6c394d?source=collection_archive---------1-----------------------#2020-04-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="f049" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">问题陈述:-生成N个点的适当的二维数据集。将数据集分为训练数据集和测试数据集。I)用最小二乘法进行线性回归分析。ii)绘制用于训练MSE和测试MSE的图形，并对曲线拟合和泛化误差进行评论。iii)验证数据集大小和偏差-方差权衡的影响。iv)应用交叉验证并绘制误差图。v)应用子集选择方法并绘制误差图。vi)描述您在每个案例中的发现。</p></blockquote></div><div class="ab cl jh ji gp jj" role="separator"><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm"/></div><div class="hb hc hd he hf"><p id="96e7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated"><strong class="il hj">下面给出了程序和数据集的链接</strong></p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/6b661ba409ef4dc0ff8d78ea5898a4db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*6HpyzmtS3uxJYb0OG0U1mQ.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">图片来源:- <a class="ae kd" href="https://thinksproutinfotech.com/" rel="noopener ugc nofollow" target="_blank">思创资讯科技</a></figcaption></figure><h1 id="4e2a" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">什么是线性回归？</strong></h1><p id="eb5b" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jo le iw ix jp lf ja jb jq lg je jf jg hb bi translated">线性回归基本上是一种统计建模技术。但它也广泛用于机器学习。在线性回归中，我们试图借助一些输入值(<strong class="il hj"> <em class="ik"> x </em> </strong>)来预测一些输出值(<strong class="il hj"> <em class="ik"> y </em> </strong>)是标量值。</p><p id="aed9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">我们称输入变量为独立变量。这是因为这些值不依赖于任何其他值。在同样的意义上，我们称输出标量值为因变量。这是因为为了找到这些输出标量值，我们依赖于输入变量。</p><h1 id="cc57" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">线性回归的数学表示</h1><p id="51f7" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jo le iw ix jp lf ja jb jq lg je jf jg hb bi translated">为了知道线性回归的表示，我们必须考虑问题的数学和机器学习方面。但是这真的很容易理解，一点也不花哨。</p><p id="5ab1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">比方说，我们有一系列标记的例子，</p><p id="7a81" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated"><strong class="il hj"> (xi，易)Ni=1 </strong></p><p id="18ca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">其中N是数据集的大小或长度，xi是来自<strong class="il hj"> i=1，…，N的特征向量，而Yi </strong>是实值目标。为了更清楚起见，你可以把的集合称为自变量，把易的集合称为因变量或目标变量。</p><p id="b7b6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">我希望现在你对这些符号在机器学习中是如何使用的有所了解。如果我们把上面的简化成文字，那么我们可以说:<br/> <br/> <em class="ik">我们要用</em> <strong class="il hj"> <em class="ik"> x </em> </strong> <em class="ik">中的特征组合建立一个线性模型，并预测</em><strong class="il hj"><em class="ik">【y】</em></strong>中的标量值</p><p id="e933" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">当我们考虑一个简单的线性回归，即单个<strong class="il hj"> <em class="ik"> x </em> </strong>和单个<strong class="il hj"><em class="ik"/></strong>y时，那么我们可以写，</p><p id="9034" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated"><strong class="il hj"> y=β0+β1x </strong></p><p id="cc80" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">其中，β0是截距参数，β1是斜率参数。</p><p id="bd95" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">如果你分析上面的方程，那么你可能会发现它和一条线的方程是一样的:</p><p id="657e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated"><strong class="il hj"> y=mx+c </strong></p><p id="452c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">其中m是斜率，c是y轴截距。</p><p id="a8cd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">现在，我们只需要记住上面的等式是针对单值<strong class="il hj"> <em class="ik"> x </em> </strong>的。我们将再次回到这些，以了解它们在机器学习中实际上是如何使用的。首先我们来讨论一下什么是<strong class="il hj">一元线性回归</strong>什么是<strong class="il hj">多元线性回归。</strong></p><h1 id="8850" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">简单线性回归</h1><p id="6264" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jo le iw ix jp lf ja jb jq lg je jf jg hb bi translated">我们知道，在线性回归中我们需要利用自变量(<strong class="il hj"> <em class="ik"> x </em> </strong>)找出因变量(<strong class="il hj"> <em class="ik"> y </em> </strong>)。</p><p id="33bc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">在简单线性回归中，对于每个观测值i=1，2，…，N，只有一个xi和一个易。这是最简单的线性回归形式。</p><h1 id="e387" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">多元线性回归</h1><p id="55ef" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jo le iw ix jp lf ja jb jq lg je jf jg hb bi translated">在多元线性回归中，我们有两个或多个自变量(x)和一个因变量(y)。因此，我们有多个特性列和一个目标列，而不是单个特性列。</p><h1 id="a796" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">均方误差成本函数</h1><p id="8d12" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jo le iw ix jp lf ja jb jq lg je jf jg hb bi translated">MSE是我们从标记集得到的Yi值和预测的y新值之间的平均平方差。我们必须最小化这个平均平方差，以在给定的数据上得到一个好的回归模型。</p><p id="b43f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">以下是MSE的公式:</p><p id="674e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated"><strong class="il hj">MSE = 1N∑(yi-(mxi+b))2</strong></p><p id="5e61" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">在上面的等式中，N是训练数据集中已标记示例的数量，yi是数据集中的目标值，而(mxi+b)是目标的预测值或者你可以说y new。</p><p id="9efb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">最小化上述成本函数将意味着找到尽可能接近训练目标值的新目标值。这将确保我们找到的线性模型也接近训练示例。</p><p id="aa30" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">为了最小化上述成本函数，我们必须找到两个参数m和b的优化值。为此，我们使用梯度下降法来找到关于m和b的偏导数。在这种情况下，成本函数如下所示:</p><p id="665f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated"><strong class="il hj"> f(m，b)= 1N∑I = 1N(yi-(mxi+b))2</strong></p><p id="c44b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">接下来，我们用链式法则求上述函数的偏导数。为了解决这个问题，我们使用斜率和截距的更新值遍历数据，并在这样做的同时尝试降低成本函数。这部分是纯数学的，机器学习的实现显然是通过编码实现的。</p><h1 id="a991" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">使用广告数据集进行线性回归的程序- </strong></h1><h2 id="8d91" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">步骤1:加载所需的数据集。</h2><h2 id="60d7" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输入:-</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es lv"><img src="../Images/dd86727194407f0ebc7ad0e7943258aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*I8S-m035alTfONLakq-oLg.png"/></div></figure><p id="f612" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">我们可以在上面的代码中看到如何将数据集导入RStudio。数据集导入成功后，我们就可以查看数据集了。下图显示了上述代码的输出。</p><h2 id="ab0e" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输出:-</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/c5983e066ce5ae27423ea94ea205c50f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*7SkGQJER_Ar-UyFAqz-fog.png"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/3bd21a9abcf645ddf16ae6f9bd8532ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*PXz8J2CWbosJwPI7GBl84A.png"/></div></figure><h2 id="3fff" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">步骤2:提取所需的数据。</h2><h2 id="329a" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输入:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es lw"><img src="../Images/fc1d5d8bd9634e25377e0d64b96c8706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*ezUpFx5JEe1h4qe3FjCbCQ.png"/></div></figure><p id="ad2a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">这里的data1包含我们需要从主数据集中处理的信息。</p><h2 id="f1ee" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输出:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/8992098a787960abcd2f0f4071f424c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*CwqabcgxOLbKZz5iI7iR-Q.png"/></div></figure><h2 id="d34c" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">步骤3:将数据集分为训练数据集和测试数据集。</h2><h2 id="2ac0" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输入:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es lx"><img src="../Images/b0ce63b60673b93673ab57c593689f1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*_lBccn7lZuwAtxSyJjU2FQ.png"/></div></figure><p id="333e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">这里，值1:140被提取用于训练目的，而值141:200被提取用于测试目的。</p><h2 id="fc27" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输出:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/e5e62016c62136aa55bf13616a1f0f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*ocQLJ4YcSubWKtwcpP24hg.png"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/ccad8a39d605b84b872818f3fc9a8774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*oD3KfxIRFXxWXrHOibWk8Q.png"/></div></figure><h2 id="7d50" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">步骤4:使用cbind函数绑定所有列。</h2><h2 id="b935" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输入:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/5d7917c0716f901ad18c8100dca59ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*HVEgFJLoEGosgwdrSTT64A.png"/></div></figure><p id="1ad2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated"><strong class="il hj"> lm </strong>用于拟合线性模型。它可用于进行回归、单层方差分析和协方差分析。</p><p id="8660" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">象征性地指定了<code class="du ly lz ma mb b">lm</code>的型号。一个典型的模型具有形式<code class="du ly lz ma mb b">response ~ terms</code>，其中<code class="du ly lz ma mb b">response</code>是(数字)响应向量，<code class="du ly lz ma mb b">terms</code>是指定<code class="du ly lz ma mb b">response</code>的线性预测值的一系列项。表格<code class="du ly lz ma mb b">first + second</code>中的术语说明表示<code class="du ly lz ma mb b">first</code>中的所有术语以及<code class="du ly lz ma mb b">second</code>中的所有术语，并去掉重复项。形式为<code class="du ly lz ma mb b">first:second</code>的规范表示通过将<code class="du ly lz ma mb b">first</code>中的所有术语与<code class="du ly lz ma mb b">second</code>中的所有术语进行交互而获得的术语集。规格<code class="du ly lz ma mb b">first*second</code>表示<code class="du ly lz ma mb b">first</code>和<code class="du ly lz ma mb b">second</code>的<em class="ik">十字</em>。这个和<code class="du ly lz ma mb b">first + second + first:second</code>一样。</p><h2 id="4d60" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输出:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/d2a6a114743b247ab2f6fada8af3b2de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Fiw5Co9UqsLyVOlYkK5b5A.png"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/8d1cc770fd88c8cb8cadc26df7e433f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*MWF-iR2dpgLgStv9tiAWdg.png"/></div></figure><h2 id="daa7" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">步骤5:绘制单个对象的图形。</h2><h2 id="c598" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输入:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/0eb83fc4b1d1dca22bb224fec42cf581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*CUkWoLePFDGJ54TwJRVE6w.png"/></div></figure><h2 id="ded0" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输出:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/4f25f75f2c0de387e51792738f313ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*aPLgNo3CxTpnowD8STcoBA.png"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/632f44b865178de33f190f2845a32232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*yJ5b5Uq2wTghJIrmZC6_uA.png"/></div></figure><h2 id="55b4" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">第六步:预测数据的价值。</h2><h2 id="0235" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输入:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es mc"><img src="../Images/7bbb1ac0621de03c786e6bb453eb09e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*WJknj1p8w-inkwfgAjOcnQ.png"/></div></figure><h2 id="b9aa" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输出:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es md"><img src="../Images/6060070f7b6c9d6d3e451a98754f3ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*KoRRKsHEZRNLykPBHGT38A.png"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/6504903093bcba25daed8d00b672bec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*tW4TrIElWcSVWpFHZdT2uQ.png"/></div></figure><h2 id="1cac" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">步骤7:最后为训练和测试数据集绘制一个模型</h2><h2 id="3059" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输入:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/6472c56d3044fb846dc6ccad1c4dbfee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*UT_k9SjbltmZ2W7uqEdSlg.png"/></div></figure><h2 id="aa02" class="lh kf hi bd kg li lj lk kk ll lm ln ko jo lo lp ks jp lq lr kw jq ls lt la lu bi translated">输出:</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/540c9615c236e66bacc3592a6434b37b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*UJzSV9i76ruq-nPw_8cagg.png"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/085d17b369fd737cb8b0eedb35b43845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*On1uPje4fWrISd7L3nOnAg.png"/></div></figure><p id="f636" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">点击<a class="ae kd" href="https://github.com/kshitijved/Linear_Regression" rel="noopener ugc nofollow" target="_blank">此处</a>下载程序和数据集…</p></div></div>    
</body>
</html>