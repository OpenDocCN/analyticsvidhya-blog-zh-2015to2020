<html>
<head>
<title>Data Cleaning and Preparing functions in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的数据清理和准备函数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-cleaning-and-preparing-functions-in-python-47950bd82f44?source=collection_archive---------33-----------------------#2020-04-26">https://medium.com/analytics-vidhya/data-cleaning-and-preparing-functions-in-python-47950bd82f44?source=collection_archive---------33-----------------------#2020-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="55ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为每个有抱负的数据科学家都知道数据清理和准备的重要性，所以让我们使用python中的pandas和numpy来深入研究一些可以用于数据清理的方法。</p><p id="1e75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先你需要导入两个库</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="332d" class="jm jn hi ji b fi jo jp l jq jr">import pandas as pd<br/>import numpy as np</span></pre><p id="abde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">出于演示目的，我们将在本文中创建临时数据帧和序列。</p><ol class=""><li id="cc2a" class="js jt hi ih b ii ij im in iq ju iu jv iy jw jc jx jy jz ka bi translated">处理丢失的数据</li></ol><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="412c" class="jm jn hi ji b fi jo jp l jq jr">string_data = pd.Series(['affd','fafd','dgbddb',np.nan])<br/>string_data.isnull()</span><span id="63e0" class="jm jn hi ji b fi kb jp l jq jr">#output<br/>0    False<br/>1    False<br/>2    False<br/>3     True<br/>dtype: bool</span></pre><p id="9655" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正在申请。dataframe上的isnull()函数返回一系列null值为true的bool项。</p><p id="d9a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.过滤掉丢失的数据</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8e48" class="jm jn hi ji b fi jo jp l jq jr">from numpy import nan as NA<br/>data = pd.Series([1,NA,3.5,NA,7])</span><span id="a36b" class="jm jn hi ji b fi kb jp l jq jr">data_na = data.dropna()<br/>data[data.notnull()]</span><span id="3107" class="jm jn hi ji b fi kb jp l jq jr"># output<br/>0    1.0<br/>2    3.5<br/>4    7.0<br/>dtype: float64</span></pre><p id="3449" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以用。dropna()函数或者你可以使用。notull()。结果是一个包含所有非空值的序列。</p><p id="23db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，For dataframe dropna()删除所有包含na值的行。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c599" class="jm jn hi ji b fi jo jp l jq jr">data = pd.DataFrame([[1,2,3,4],[4,6,4,NA],<br/>                    [2,6,3,1],[8,9,NA,NA]])<br/>data<br/>data.dropna()</span><span id="7624" class="jm jn hi ji b fi kb jp l jq jr">#output<br/><strong class="ji hj">data</strong><br/>Out[12]: <br/>   0  1    2    3<br/>0  1  2  3.0  4.0<br/>1  4  6  4.0  NaN<br/>2  2  6  3.0  1.0<br/>3  8  9  NaN  NaN</span><span id="deb4" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.dropna()</strong><br/>Out[13]: <br/>   0  1    2    3<br/>0  1  2  3.0  4.0<br/>2  2  6  3.0  1.0</span></pre><p id="b516" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">传递how="all "只会删除包含所有NAs的行。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="23f2" class="jm jn hi ji b fi jo jp l jq jr">data = pd.DataFrame([[1,2,3,4],[4,6,4,NA],<br/>                    [2,6,3,1],[8,9,NA,NA],[NA,NA,NA,NA]])</span><span id="a107" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data</strong><br/>Out[17]: <br/>     0    1    2    3<br/>0  1.0  2.0  3.0  4.0<br/>1  4.0  6.0  4.0  NaN<br/>2  2.0  6.0  3.0  1.0<br/>3  8.0  9.0  NaN  NaN<br/>4  NaN  NaN  NaN  NaN</span><span id="b5ac" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.dropna(how = "all")</strong><br/>Out[18]: <br/>     0    1    2    3<br/>0  1.0  2.0  3.0  4.0<br/>1  4.0  6.0  4.0  NaN<br/>2  2.0  6.0  3.0  1.0<br/>3  8.0  9.0  NaN  NaN</span></pre><p id="b070" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以同样的方式删除列，传递axis = 1</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="d70b" class="jm jn hi ji b fi jo jp l jq jr">data = pd.DataFrame([[1,2,3,4],[4,6,4,NA],<br/>                    [2,6,3,1],[8,9,NA,NA]])</span><span id="aa5b" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data</strong><br/>Out[22]: <br/>   0  1    2    3<br/>0  1  2  3.0  4.0<br/>1  4  6  4.0  NaN<br/>2  2  6  3.0  1.0<br/>3  8  9  NaN  NaN</span><span id="080f" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.dropna(axis = 1)</strong><br/>Out[23]: <br/>   0  1<br/>0  1  2<br/>1  4  6<br/>2  2  6<br/>3  8  9</span><span id="6be7" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.dropna(axis = 1, how = "all")</strong><br/>Out[24]: <br/>   0  1    2    3<br/>0  1  2  3.0  4.0<br/>1  4  6  4.0  NaN<br/>2  2  6  3.0  1.0<br/>3  8  9  NaN  NaN</span></pre><p id="180c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您希望只保留包含一定数量观察值的行。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="822c" class="jm jn hi ji b fi jo jp l jq jr">df = pd.DataFrame(np.random.randn(7,3))<br/>df.iloc[:4,1] = NA<br/>df.iloc[:2,2] = NA</span><span id="6e49" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">df</strong><br/>Out[28]: <br/>          0         1         2<br/>0  0.926414       NaN       NaN<br/>1  0.159192       NaN       NaN<br/>2 -0.724809       NaN -1.417761<br/>3  0.282927       NaN -1.463186<br/>4  0.170544 -0.490909 -0.974798<br/>5 -0.770864 -0.087966 -0.125960<br/>6 -1.874506  1.419397 -0.758035</span><span id="d70f" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">df.dropna()</strong><br/>Out[29]: <br/>          0         1         2<br/>4  0.170544 -0.490909 -0.974798<br/>5 -0.770864 -0.087966 -0.125960<br/>6 -1.874506  1.419397 -0.758035<br/><br/><strong class="ji hj">df.dropna(thresh = 2)</strong><br/>Out[30]: <br/>          0         1         2<br/>2 -0.724809       NaN -1.417761<br/>3  0.282927       NaN -1.463186<br/>4  0.170544 -0.490909 -0.974798<br/>5 -0.770864 -0.087966 -0.125960<br/>6 -1.874506  1.419397 -0.758035</span></pre><p id="1066" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.填充缺失值</p><p id="a269" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用常数调用fillna会用该值替换丢失的值</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="82da" class="jm jn hi ji b fi jo jp l jq jr"><strong class="ji hj">df.fillna(0)</strong><br/>Out[31]: <br/>          0         1         2<br/>0  0.926414  0.000000  0.000000<br/>1  0.159192  0.000000  0.000000<br/>2 -0.724809  0.000000 -1.417761<br/>3  0.282927  0.000000 -1.463186<br/>4  0.170544 -0.490909 -0.974798<br/>5 -0.770864 -0.087966 -0.125960<br/>6 -1.874506  1.419397 -0.758035</span></pre><p id="f648" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用字典调用fillna()，你可以为每一列使用不同的填充值</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="3f4c" class="jm jn hi ji b fi jo jp l jq jr"><strong class="ji hj">df.fillna({1:0.5,2:0})</strong><br/>Out[32]: <br/>          0         1         2<br/>0  0.926414  0.500000  0.000000<br/>1  0.159192  0.500000  0.000000<br/>2 -0.724809  0.500000 -1.417761<br/>3  0.282927  0.500000 -1.463186<br/>4  0.170544 -0.490909 -0.974798<br/>5 -0.770864 -0.087966 -0.125960<br/>6 -1.874506  1.419397 -0.758035</span></pre><p id="424c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.删除重复项</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="3d32" class="jm jn hi ji b fi jo jp l jq jr">data = pd.DataFrame({'k1':['one','two'] *3 + ['two'],<br/>                     'k2' : [1,1,2,3,3,4,4]})</span><span id="ef25" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data</strong><br/>Out[40]: <br/>    k1  k2<br/>0  one   1<br/>1  two   1<br/>2  one   2<br/>3  two   3<br/>4  one   3<br/>5  two   4<br/>6  two   4</span><span id="32cf" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.duplicated()</strong> ## returns a boolean series<br/>Out[41]: <br/>0    False<br/>1    False<br/>2    False<br/>3    False<br/>4    False<br/>5    False<br/>6     True<br/>dtype: bool</span><span id="8efa" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.drop_duplicates()<br/></strong>data.duplicated() ## returns a boolean series<br/>Out[41]: <br/>0    False<br/>1    False<br/>2    False<br/>3    False<br/>4    False<br/>5    False<br/>6     True<br/>dtype: bool</span><span id="5a39" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.drop_duplicates() <br/></strong>Out[42]: <br/>    k1  k2<br/>0  one   1<br/>1  two   1<br/>2  one   2<br/>3  two   3<br/>4  one   3<br/>5  two   4</span></pre><p id="ab87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还可以指定一个子集来检测重复项</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="bca6" class="jm jn hi ji b fi jo jp l jq jr"><strong class="ji hj">data['v1'] = range(7)<br/>data</strong><br/>Out[44]: <br/>    k1  k2  v1<br/>0  one   1   0<br/>1  two   1   1<br/>2  one   2   2<br/>3  two   3   3<br/>4  one   3   4<br/>5  two   4   5<br/>6  two   4   6</span><span id="2b65" class="jm jn hi ji b fi kb jp l jq jr"><strong class="ji hj">data.drop_duplicates(['k1'])</strong><br/>Out[45]: <br/>    k1  k2  v1<br/>0  one   1   0<br/>1  two   1   1</span></pre><p id="1d2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们继续做进一步分析之前，这些是我们可以用来清理和准备数据的一些函数。将在接下来的部分中涉及更多内容，比如使用地图和lambda函数转换数据。</p><p id="2020" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何改进的建议都是受欢迎的，如果这篇文章在某些方面对你有所帮助，我会非常喜欢它。</p></div></div>    
</body>
</html>