<html>
<head>
<title>Features of Pandas and their functionality</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫的特征及其功能</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/features-of-pandas-and-their-functionality-603ef1c52e74?source=collection_archive---------16-----------------------#2020-02-04">https://medium.com/analytics-vidhya/features-of-pandas-and-their-functionality-603ef1c52e74?source=collection_archive---------16-----------------------#2020-02-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4d07346094d674018738862f3159f94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AxNj4d2_5RvT1VngWYKT5A.jpeg"/></div></div></figure><p id="c3d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每一个与数据科学相关的问题都是从探索性数据分析(EDA)开始的。那么EDA是什么？</p><p id="7fc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated">探索性数据分析是一种数据分析方法，采用各种技术从现有数据中获取尽可能多的见解。一些洞见是检测重要变量，检测异常值等 </p><p id="38ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我的EDA之旅主要得益于两个库(pandas和NumPy)以及与它们相关的特性。我们将探索Pandas的一些特性和功能(因为Pandas依赖于NumPy并与之互操作)</p><h2 id="40b5" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">用一些随机值创建一个序列</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="4e3d" class="jy jz hi ky b fi lc ld l le lf">np.random.seed(1)<br/>X = np.random.randint(low=1, high=100, size=10)<br/>A = pd.Series(X)</span></pre><blockquote class="lg lh li"><p id="dbc5" class="iq ir jx is b it iu iv iw ix iy iz ja lj jc jd je lk jg jh ji ll jk jl jm jn hb bi translated"><strong class="is hj"> <em class="hi">一个数据帧是一系列</em> </strong>的集合</p></blockquote><ul class=""><li id="2e0f" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">创建带有两个标签的数据帧</strong></li></ul><p id="a299" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每个标签代表其系列</p><ul class=""><li id="e3ce" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">第二系列</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="e575" class="jy jz hi ky b fi lc ld l le lf">np.random.seed(2)<br/>X = np.random.randint(low=0,high=100,size=10)<br/>B = pd.Series(X)</span></pre><ul class=""><li id="4c3b" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">使用字典方法创建数据帧</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6ce2" class="jy jz hi ky b fi lc ld l le lf">df = pd.DataFrame({<br/>    "A" : A,<br/>    "B" : B<br/>})</span></pre><ul class=""><li id="23a5" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">使用zip创建数据帧</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8b71" class="jy jz hi ky b fi lc ld l le lf">df = pd.DataFrame(list(zip(A,B)), columns=["A","B"])</span></pre><ul class=""><li id="43aa" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">数据帧的索引值</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="22aa" class="jy jz hi ky b fi lc ld l le lf">df.index = [<br/>    "Row-1","Row-2","Row-3","Row-4","Row-5",<br/>    "Row-6","Row-7","Row-8","Row-9","Row-10"<br/>]</span></pre><h2 id="101b" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">查看数据框中的数据</h2><ul class=""><li id="5ea4" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">数据帧的大小</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="28ea" class="jy jz hi ky b fi lc ld l le lf">size_of_df = df.shape</span><span id="d795" class="jy jz hi ky b fi ma ld l le lf">no_of_rows = df.shape[0]</span><span id="dc1e" class="jy jz hi ky b fi ma ld l le lf">no_0f_columns = df.shape[1]</span></pre><ul class=""><li id="536b" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">前5行</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="4fa7" class="jy jz hi ky b fi lc ld l le lf">df.head()</span></pre><ul class=""><li id="6c87" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">最后5行</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="944e" class="jy jz hi ky b fi lc ld l le lf">df.tail()</span></pre><ul class=""><li id="eb0d" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">前4行</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="aa0b" class="jy jz hi ky b fi lc ld l le lf">df.head(4)</span></pre><ul class=""><li id="f25f" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">列</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8c8f" class="jy jz hi ky b fi lc ld l le lf">df.columns</span></pre><h2 id="8ac6" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">向数据框架添加另一列</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="3b94" class="jy jz hi ky b fi lc ld l le lf">np.random.seed(3)<br/>C = np.random.randint(low = 0, high=100, size=10)<br/>df["C"] = C</span></pre><h2 id="627f" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">使用列标签选择数据</h2><ul class=""><li id="a0d9" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">选择列A</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6744" class="jy jz hi ky b fi lc ld l le lf">df["A"]</span></pre><ul class=""><li id="0c2c" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">选择B列和C列</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0283" class="jy jz hi ky b fi lc ld l le lf">df[["B","C"]]</span></pre><ul class=""><li id="c721" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">使用选择B列和C列。通信线路（LinesofCommunication）</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="5b65" class="jy jz hi ky b fi lc ld l le lf">df.loc[:,["B","C"]]</span></pre><ul class=""><li id="3fa0" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">从列B &amp; C中选择行3和行6</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c467" class="jy jz hi ky b fi lc ld l le lf">df.loc[["Row-3","Row-6"],["B","C"]]</span></pre><ul class=""><li id="3699" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">选择第4行和第8行之间的数据</li></ul><p id="b260" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当使用loc对行进行切片时，第一个值和最后一个值都包含在内。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="4e04" class="jy jz hi ky b fi lc ld l le lf">df.loc["Row-5" : "Row-7"]</span></pre><ul class=""><li id="e4dc" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">选择第4行和第8行之间以及B &amp; C列中的数据</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0c69" class="jy jz hi ky b fi lc ld l le lf">df.loc["Row-5":"Row-7","B" :"C"]</span></pre><h2 id="47d8" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">通过定位选择数据</h2><ul class=""><li id="cad9" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">选择列A</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="7caa" class="jy jz hi ky b fi lc ld l le lf">df.iloc[:,0]</span></pre><ul class=""><li id="8a15" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">选择B列和C列</li></ul><p id="3689" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用iloc对列进行切片时，第一个值是包含性的，最后一个值是排他性的。这里，列索引1是包含性的，3是排他性的。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="d5e4" class="jy jz hi ky b fi lc ld l le lf">df.iloc[:,1:3]</span></pre><ul class=""><li id="9173" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">选择第4行和第8行之间的数据</li></ul><p id="338d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当像普通python列表一样使用iloc对行进行切片时，第一个值是包含性的，最后一个值是排他性的。这里，行索引4是包含性的，而8是排他性的。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c2df" class="jy jz hi ky b fi lc ld l le lf">df.index[4] = "Row-5"</span><span id="30b1" class="jy jz hi ky b fi ma ld l le lf">df.index[7] = "Row-8"</span><span id="8584" class="jy jz hi ky b fi ma ld l le lf">df.iloc[4:7]</span></pre><ul class=""><li id="ec58" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">选择第4行和第8行之间以及B &amp; C列中的数据</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8b91" class="jy jz hi ky b fi lc ld l le lf">df.iloc[4:7,1:3]</span></pre><h2 id="b066" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">删除</h2><ul class=""><li id="4131" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">删除第5行</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="1d1d" class="jy jz hi ky b fi lc ld l le lf">df.drop(labels=["Row-5"],axis=0)</span></pre><ul class=""><li id="e78e" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">删除B列</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c179" class="jy jz hi ky b fi lc ld l le lf">df.drop(columns=["B"],axis=1)</span></pre><ul class=""><li id="a2d8" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">删除第5行和第B列</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="b4f7" class="jy jz hi ky b fi lc ld l le lf">df.drop(columns=["B"], index=["Row-5"])</span></pre><h2 id="ec41" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">应用</h2><ul class=""><li id="3d4c" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">创建一个返回该数字平方的函数</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0356" class="jy jz hi ky b fi lc ld l le lf">`square = lambda x: x*x</span></pre><ul class=""><li id="14cc" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">通过在序列级别应用函数来计算A列中所有元素的平方</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="051d" class="jy jz hi ky b fi lc ld l le lf">df["A"].apply(lambda x: square(x))</span></pre><ul class=""><li id="be90" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">通过在数据帧级别应用函数来计算A列中所有元素的平方</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6e57" class="jy jz hi ky b fi lc ld l le lf">df.apply(lambda x: square(x["A"]), axis=1)</span></pre><ul class=""><li id="4e44" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">通过在数据帧级别应用函数来计算B列和C列中所有元素的平方</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="7264" class="jy jz hi ky b fi lc ld l le lf">df.apply(lambda x: square(x[["B","C"]]), axis=1)</span></pre><h2 id="2bcf" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">串联</h2><ul class=""><li id="9f0e" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">创建新的数据框架</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6041" class="jy jz hi ky b fi lc ld l le lf">np.random.seed(4)<br/>X = np.random.randint(low=1, high=100, size=(5,3))<br/>new_df = pd.DataFrame(X, columns=["A","B","C"])</span></pre><ul class=""><li id="f941" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">合并两个数据帧</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="bb30" class="jy jz hi ky b fi lc ld l le lf">df = pd.concat((df,new_df),ignore_index=True)</span></pre><h2 id="50b8" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">分组</h2><ul class=""><li id="a941" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">向DataFrame添加一个新列，该列包含三个不同的值。该数据帧由15个元素组成</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="60b3" class="jy jz hi ky b fi lc ld l le lf">np.random.seed(5)<br/>D = np.random.randint(low = 1, high=4, size=15)</span><span id="c92f" class="jy jz hi ky b fi ma ld l le lf">df["D"] = D</span></pre><ul class=""><li id="cad7" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">提取数据帧中D列为1的所有值</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="bdaa" class="jy jz hi ky b fi lc ld l le lf">df.groupby("D").get_group(1)</span></pre><ul class=""><li id="f143" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">提取数据帧中列D为2或3的所有值</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f367" class="jy jz hi ky b fi lc ld l le lf">pd.concat(<br/>    (<br/>        df.groupby("D").get_group(2),<br/>        df.groupby("D").get_group(3)<br/>    )<br/>)</span></pre><ul class=""><li id="e5ed" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">B列中所有值的总和，其中D列为2</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="a35d" class="jy jz hi ky b fi lc ld l le lf">df.groupby("D").get_group(2)["B"].sum()</span></pre><ul class=""><li id="d8db" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">C列中所有值的平均值，其中D列为3</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="926f" class="jy jz hi ky b fi lc ld l le lf">df.groupby("D").get_group(3)["C"].mean()</span></pre><p id="a6de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jx">我们将借助亚马逊股票数据来探究这些操作</em> </strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/10cc4fd42f4ad220ab8b0cf310bc30d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smUSG-zjAES4y8JcJiEjNg.jpeg"/></div></div></figure><h2 id="ebdc" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">这些数据包含什么？</h2><ul class=""><li id="e667" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">该数据集包含从2018年1月1日到2018年12月31日的股票记录</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="a2c7" class="jy jz hi ky b fi lc ld l le lf">df.shape</span></pre><ul class=""><li id="f3eb" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">它包含251条记录</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="eeb2" class="jy jz hi ky b fi lc ld l le lf">df.tail(10)</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/4fa5a7e149b6c82a7bfbcd96fed28c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*l8h48VHPBKsdt9Fgu8XJKQ.png"/></div><figcaption class="md me et er es mf mg bd b be z dx translated">2018年AMZN股票数据</figcaption></figure><h2 id="e9e6" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">合并数据集</h2><ul class=""><li id="f1c0" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">加载2019年的股票数据集</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8b8f" class="jy jz hi ky b fi lc ld l le lf">new_df = pd.read_csv("AMZN_2019.csv")</span></pre><ul class=""><li id="1335" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">合并两个数据集</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="bddf" class="jy jz hi ky b fi lc ld l le lf">df = pd.concat((df,new_df),ignore_index=True)</span></pre><ul class=""><li id="1d04" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">新数据集</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0730" class="jy jz hi ky b fi lc ld l le lf">df.tail(10)</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/008181a03260ff1f9cba7816c4660a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*bgKbOi3qdf3XwNK8VpJAWQ.png"/></div><figcaption class="md me et er es mf mg bd b be z dx translated">亚马逊储存了2018年1月1日至2019年12月31日的数据</figcaption></figure><ul class=""><li id="4386" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">提取由不同的“关闭”和“调整关闭”值组成的记录</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8842" class="jy jz hi ky b fi lc ld l le lf">df[df['close'] != df['Adj Close'] ]</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/1618c34f5355b08f55772376760a3b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*Z6zeWE2xaGwpaKYtLxdENA.png"/></div><figcaption class="md me et er es mf mg bd b be z dx translated">没有记录包含不同的“关闭”和“调整关闭”值</figcaption></figure><p id="8f6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为收盘值和调整收盘值相同，所以我们删除调整收盘列</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="9976" class="jy jz hi ky b fi lc ld l le lf">df.drop(["Adj Close"], axis=1, inplace=True)</span></pre><ul class=""><li id="befa" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取前10天数据</strong></li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="dc8a" class="jy jz hi ky b fi lc ld l le lf">df.iloc[:10]</span></pre><ul class=""><li id="6da4" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取最近10天的数据</strong></li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="b887" class="jy jz hi ky b fi lc ld l le lf">df.iloc[-10:]</span></pre><ul class=""><li id="6460" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取最近10天的记录，仅包含开盘价和收盘价</strong></li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="28d1" class="jy jz hi ky b fi lc ld l le lf">df.iloc[-10:,[1,4]]</span></pre><ul class=""><li id="579a" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取收盘值大于开盘值的最后10条记录</strong></li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="be2e" class="jy jz hi ky b fi lc ld l le lf">df[df["Close"] &gt; df["Open"]].iloc[-10:]</span></pre><h2 id="4824" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated"><strong class="ak">创建一个新列，其中包含与日期</strong>相对应的日名称</h2><ul class=""><li id="2983" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">创建一个函数，将普通日期转换为日期名称。</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="882d" class="jy jz hi ky b fi lc ld l le lf">sample_date = '2020-01-31'</span></pre><ul class=""><li id="656d" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">创建<strong class="is hj"><em class="jx">convert _ date _ to _ day _ name(date)</em></strong>函数，以sample_date格式的数据作为输入</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c6b4" class="jy jz hi ky b fi lc ld l le lf">import datetime</span><span id="2bf4" class="jy jz hi ky b fi ma ld l le lf">import calendar</span><span id="b0a8" class="jy jz hi ky b fi ma ld l le lf">def convert_date_to_day_name(date):<br/>    year, month, day = date.split("-")<br/>    dt_idx = datetime.date(int(year),int(month),int(day)).weekday()<br/>    return calendar.day_name[dt_idx]</span></pre><ul class=""><li id="860f" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">创建一个包含日名称的新列</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="d071" class="jy jz hi ky b fi lc ld l le lf">df["Day_Name"] = df.apply(<br/>    lambda x:convert_date_to_day_name(x["Date"]),<br/>    axis=1<br/>)</span></pre><h2 id="b5dc" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated"><strong class="ak">更新后的数据集</strong></h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="9cab" class="jy jz hi ky b fi lc ld l le lf">df.head(10)</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/3e5a722f6778b7a8c509722d527590b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*nXHt7fnMEPHOZPSbjqSgnQ.png"/></div></figure><ul class=""><li id="699e" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取星期一的所有记录</strong></li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="a32e" class="jy jz hi ky b fi lc ld l le lf">df.groupby("Day_Name").get_group("Monday")</span></pre><ul class=""><li id="eef7" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取周一最低价值的股票</strong></li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="20b9" class="jy jz hi ky b fi lc ld l le lf">monday_df = df.groupby("Day_Name").get_group("Monday")<br/>monday_df["Low"].min()</span></pre><ul class=""><li id="ffbe" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取周二最高值的股票</strong></li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="7975" class="jy jz hi ky b fi lc ld l le lf">tuesday_df = df.groupby("Day_Name").get_group("Tuesday")<br/>tuesday_df["High"].max()</span></pre><ul class=""><li id="2d91" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated"><strong class="is hj">提取以盈利结束的周五的数量</strong></li><li id="cedb" class="lm ln hi is b it mk ix ml jb mm jf mn jj mo jn lr ls lt lu bi translated">星期五的所有记录</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="080c" class="jy jz hi ky b fi lc ld l le lf">friday_df = df.groupby("Day_Name").get_group("Friday")</span></pre><ul class=""><li id="8435" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">周四的所有记录</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="d649" class="jy jz hi ky b fi lc ld l le lf">thursday_df = df.groupby("Day_Name").get_group("Thursday")</span></pre><ul class=""><li id="26d4" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">创建一个将日期从字符串类型更改为日期时间类型的函数</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f174" class="jy jz hi ky b fi lc ld l le lf">def convert_into_datetime_format(date):<br/>    year,month,day = date.split("-")<br/>    return datetime.datetime(int(year),int(month),int(day))</span></pre><ul class=""><li id="2d06" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">在所有星期四记录上迭代所有星期五记录</li></ul><p id="519b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用<strong class="is hj"><em class="jx">convert _ into _ datetime _ format</em></strong>函数检查星期五的日期和星期四的日期之间的差异。如果是1天，则考虑周五和周四的记录，以便进一步处理</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="5d10" class="jy jz hi ky b fi lc ld l le lf">def day_difference(x,y):<br/>    x = convert_into_datetime_format(x)<br/>    y = convert_into_datetime_format(y)<br/>    return (x-y).days</span></pre><p id="bab4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">计算星期五收盘价和星期四收盘价之间的差值</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2cac" class="jy jz hi ky b fi lc ld l le lf">result = []<br/>for f in friday_df.values:<br/>    for t in thursday_df.values:<br/>        condition = day_difference(f[0],t[0])<br/>        if(condition == 1):<br/>            result.append(f[4]-t[4])</span></pre><p id="22a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以盈利结束意味着收盘价高于前一天的收盘价</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="839b" class="jy jz hi ky b fi lc ld l le lf">import numpy as np</span><span id="ea4a" class="jy jz hi ky b fi ma ld l le lf">result = np.array(result)<br/>(result &gt; 0).sum()</span></pre><h2 id="36a8" class="jy jz hi bd ka kb kc kd ke kf kg kh ki jb kj kk kl jf km kn ko jj kp kq kr ks bi translated">结论</h2><p id="2e24" class="pw-post-body-paragraph iq ir hi is b it lv iv iw ix lw iz ja jb mp jd je jf mq jh ji jj mr jl jm jn hb bi translated">这是对熊猫不同操作员及其功能的简要介绍。我们还简要地研究了其他库，如DateTime和calendar。<strong class="is hj"> <em class="jx">您将在</em></strong><a class="ae ms" href="https://github.com/ambatiashok60/Medium/blob/master/Features%20of%20Pandas%20and%20their%20Functionality/Features%20of%20Pandas.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="jx">GitHub</em></strong></a>找到与我们的讨论相关的完整代码和数据文件</p></div></div>    
</body>
</html>