<html>
<head>
<title>Automation using Pydrive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pydrive实现自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automation-using-pydrive-e6387cc6df4b?source=collection_archive---------13-----------------------#2020-10-12">https://medium.com/analytics-vidhya/automation-using-pydrive-e6387cc6df4b?source=collection_archive---------13-----------------------#2020-10-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fb24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在想如何自动化我工作中的一些流程，我意识到有一个是关于下载和上传机构视频的，平均每天300个。这项活动是手动的，需要一群人从云平台下载视频，并上传到我们的业务Google drive帐户，因为云平台只保留视频15天。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/94359022c79d46e1bf91d39e1ebe87c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ck64PRBkZJR_xaLjZOv5ow.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">像蚂蚁一样工作</figcaption></figure><p id="7359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了避免像蚂蚁一样工作，我将此作为一个挑战，并开始了一个关于视频大小、所需权限、版权保护、本地服务器和Google drive的存储容量以及这些视频上传频率的清单。</p><p id="6df9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除此之外，我选择使用python是因为Pydrive库简化了Google Drive API任务的使用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/234f5085b073b53e6fe33c8cac789323.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*oJGyPshJabvY8VI0t-vC3Q.png"/></div></figure></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><p id="aa73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是使用我们的Google商业账户启用Google Drive API，遵循以下步骤:<a class="ae jx" href="https://developers.google.com/drive/api/v3/enable-drive-api" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/drive/api/v3/enable-drive-api</a></p><p id="0123" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我为我的项目创建了OAuth 2.0凭证，并将client_secrets.json文件下载到我的python脚本的同一个目录中，在那里我实现了命令行身份验证:</p><p id="e9c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jx" href="https://pythonhosted.org/PyDrive/pydrive.html#pydrive.auth.GoogleAuth.CommandLineAuth" rel="noopener ugc nofollow" target="_blank">https://python hosted . org/py drive/py drive . html # py drive . auth . Google auth . command line auth</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jy"><img src="../Images/cf8ffd8e24d26b2ff9fe5317bc669e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*n_lvAimvv6xJMICA4zrqjQ.png"/></div></figure><p id="6c33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除此之外，我还创建了settings.yaml，在其中定义了客户端机密，并创建了凭证文件，用于保存Google auth生成的令牌访问。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/c213c20cab5d68a8f23462fa2442e3e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*yypmU3RJBH2YNKJZs7ieiw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">settings.yaml配置</figcaption></figure><p id="0e95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其次，在我的python脚本中，我定义了两种方法，在这两种方法中，我基于当前日期在Google Drive中创建了一个文件夹:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/c2cc341ed2069fed7aaa8c89e44103ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*qaOlRBv_XhZEdGAceokTDA.png"/></div></figure><p id="6e25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">继续我的脚本，我必须从我们的本地服务器上获取视频，并通过一个可共享的公共链接上传到Google Drive，而无需作者共享和复制需要作者权限:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kb"><img src="../Images/7ec3534dbc4ee217879c206cf670e061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*9A3Gg8XqYNQXw2REVRe_6A.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">“替代链接”显示可共享的公共链接</figcaption></figure><p id="fbc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我实现了一种使用线程并行上传视频的方法:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kc"><img src="../Images/6d1aae34856c9f435aff50b9ab992a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*2QnyMSopTaep7_slCZQd_g.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">导入线程库</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kd"><img src="../Images/d9c99ad79e450626a174cd2aba8f5cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:188/format:webp/1*h-VYUj0hBcFDpZl7VO8ylg.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">定义线程的数量</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/b2bdf0e5a3a6507e410a1e9e0a4b0f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*1lxFjDObJRgyD3_5YDVdTg.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">定义使用线程的方法</figcaption></figure></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><p id="0d3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，我准备了一个python脚本，将视频从云平台下载到我们的本地服务器。这个过程是在我把它们上传到Google Drive之前。</p><p id="b84e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我使用请求库从URL下载视频，并使用Shutil包将文件对象复制到我们的本地服务器上。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><p id="cb24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种自动化之前，我们需要6个人来下载和上传视频，他们在工作时间表中花了一些时间来完成这项工作，所以这项任务在一天结束时完成。自动化后，整个过程只需要2个小时，不需要任何人来完成。</p></div></div>    
</body>
</html>