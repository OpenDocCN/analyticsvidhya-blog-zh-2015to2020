<html>
<head>
<title>BScGAN (Conditional GAN for Background Subtraction)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BScGAN(用于背景扣除的条件GAN)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bscgan-conditional-gan-for-background-subtraction-21fa152825db?source=collection_archive---------12-----------------------#2019-12-27">https://medium.com/analytics-vidhya/bscgan-conditional-gan-for-background-subtraction-21fa152825db?source=collection_archive---------12-----------------------#2019-12-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6103" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BScGAN [2]是一种条件生成对抗网络(cGAN)，专门用于使用背景和前景图像生成分割掩模[3]，并且优于其他背景减法。图1显示了一个典型的cGAN模型的架构。我们试图使用辅助信息(如类标签或来自其他模态的数据)来控制输出，而不是仅仅将潜在空间提供给生成器模型。我们可以通过将y(图1)馈入发生器和鉴频器来执行调理。稍后，我们将看到cGAN的架构是如何针对背景减除任务进行修改的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/01e3148d0174083f207cc7432529af56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qSEiDeDhO3gpvQh1.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><strong class="bd jt">图1:</strong>cGAN模型的架构</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="91fb" class="kb kc hi bd jt kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">发电机</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/3ea9fc1554a387125cded342b248b3ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LHLAfZ_fH1YG_mIDpo6Eg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><strong class="bd jt">图2: </strong>发电机的架构</figcaption></figure><p id="3182" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用前景和背景图像作为生成器的输入，而不是使用噪声作为这个cGAN网络的输入。图2显示了发生器的示意图(带有带跳线连接的U形网络)。</p><p id="fdf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">香草UNET架构最初是为了生物医学图像分割。主要概念是首先通过卷积运算(扩展阶段)压缩图像，然后通过上采样(压缩阶段)对张量进行“解卷积”。上采样张量应该理想地包含语义的正确分割。此外，扩展阶段通过一系列上卷积和连接将特征和空间信息与收缩路径中的高分辨率特征相结合(以避免信息丢失)。对于发生器，输入形状被改变以适应6个通道，即3个前景通道和3个背景通道(图2)。</p><p id="9b97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据BScGAN [2]的原始架构，编码器由8个卷积层组成。第一层使用7 × 7卷积生成64幅特征图。第8层生成512幅1 × 1大小的特征地图。它们的权重是随机初始化的。此外，中间的六个卷积层是用ResNet-101模型的权重初始化的六个ResNet块。在所有的编码器层中，使用泄漏-ReLU非线性。</p><p id="7cd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解码器架构以与编码器架构相同的方式构造，并且包括8个去卷积(例如，转置卷积)层，但是具有相反的层排序，并且下采样层被上采样层代替。解码器层的权重被随机初始化。所有去卷积层都使用ReLU函数，除了第8个1 × 1去卷积层使用Tanh激活来产生最终的前景对象二进制蒙版。</p><p id="3095" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下代码显示了如何使用Vanilla U-Net作为生成器架构对网络的生成器部分进行编码(该模型的架构与原始论文中提出的架构不同)。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kz la l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">发电机架构</figcaption></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kz la l"/></div></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="9915" class="kb kc hi bd jt kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">鉴别器</h1><p id="458a" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">鉴别器有七个输入通道，由前景图像、背景图像和遮罩组成。前景和背景被馈送到鉴别器，该鉴别器具有地面真相掩模和交替批次中生成的掩模。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/e4d059107458803c880efd45a93f3292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QL5UGrNomibLPwehm41dTw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">鉴别器的体系结构</figcaption></figure><p id="0e23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，根据原始论文，鉴别器网络由4个卷积和下采样层组成(图2)。第一层生成64个要素地图。此外，第4层生成512个30 × 30大小的特征地图。所有卷积都是3 × 3空间滤波器，跨距参数值为2。它们的权重被随机初始化，并且它们使用leakyReLU函数作为激活。最后一个卷积层之后是一个全连接(FC)层。该FC层被应用于将特征映射转换成一维向量，并遵循Sigmoid函数。</p><p id="d0a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的代码显示了如何对网络的鉴别器部分进行编码。鉴别器的架构如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/a33cb363ec8ffd0ec19532001a6a1a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*jxLo8ybQVSALu5Va77pBpw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><strong class="bd jt">图4: </strong>鉴别器的架构</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="d43c" class="kb kc hi bd jt kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">GAN网络</h1><p id="e77f" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">最初，BScGAN使用MSE作为内容损失(放在生成器前面)。然而，对于生成器，我们用骰子损失来代替MSE，因为它更好地处理了类不平衡。cGAN(生成器G和鉴别器D)模型中使用的对抗性损失在以下等式中定义。对抗训练期间G (l_GD)的损失函数在等式4中公式化，其中值λ是15。鉴别器试图最小化l_GD，而发生器的任务是最大化l_GD(等式5)。当鉴别器和发生器的损失函数变得相对稳定时，训练停止。在测试期间，生成器用于使用输入对创建分段掩码</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/aa967414d152b3b8d8e002e64ee9ada2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*MGYOn5GxTIpRFsUObFMfvg.png"/></div></figure><p id="0f4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面给出了cGAN网络的代码。模型总结如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lj"><img src="../Images/98f1adc46f397a36ffa8695730bd5811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMSPAYF1WxbCE3ZyUYjUqA.png"/></div></div></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="7f9e" class="kb kc hi bd jt kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">参考文献</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lk"><img src="../Images/9f4cc8f9ee50ec55432ee2c36e06be4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*FBe2P0wDhNiBhtrDQvCotg.png"/></div></figure></div></div>    
</body>
</html>