<html>
<head>
<title>Implementation of Upper Confidence Bound Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">置信上限算法的实现</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implementation-of-upper-confidence-bound-algorithm-ce0651b63c15?source=collection_archive---------2-----------------------#2020-12-07">https://medium.com/analytics-vidhya/implementation-of-upper-confidence-bound-algorithm-ce0651b63c15?source=collection_archive---------2-----------------------#2020-12-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/b1277b99235658cdd80ad64a40ffe061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*mt-3gMmfb9ztsUdl9yB65A.jpeg"/></div></figure><div class=""/><p id="a41d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇文章中，我们将可视化UCB算法如何工作的多臂土匪问题。</p><h2 id="bb6c" class="jk jl hp bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated">简而言之，UCB算法</h2><p id="0f73" class="pw-post-body-paragraph im in hp io b ip kf ir is it kg iv iw ix kh iz ja jb ki jd je jf kj jh ji jj hb bi translated">在UCB算法中，我们在初始阶段开始探索所有的机器，然后当我们找到具有最高置信界限的机器时，我们开始利用它来获得最大的回报。</p><p id="4960" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你想更好地理解它，你可以看到多武装匪徒问题的<a class="ae kk" rel="noopener" href="/analytics-vidhya/upper-confidence-bound-for-multi-armed-bandits-problem-ea5d7bc840ff">置信上限。在这里，我们将重点放在算法部分，并借助编码将其可视化。</a></p><p id="c67e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看UCB算法的步骤是什么。</p><h2 id="cbe7" class="jk jl hp bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated">UCB算法的步骤</h2><ol class=""><li id="5dbd" class="kl km hp io b ip kf it kg ix kn jb ko jf kp jj kq kr ks kt bi translated"><em class="ku">在每一轮</em> <strong class="io hq"> <em class="ku"> n </em> </strong> <em class="ku">，我们考虑机器m的两个数字。<br/>-&gt;</em>【nₘ(n)=机器m直到第n轮被选择的次数。<br/>-&gt;【rₘ(n)=机器m直到第n轮的奖励次数</li><li id="a0eb" class="kl km hp io b ip kv it kw ix kx jb ky jf kz jj kq kr ks kt bi translated"><em class="ku">从这两个数字我们要计算，<br/> a. </em>机器的平均报酬m到回合n，rₘ(n) = Rₘ(n) / Nₘ(n).<br/> <em class="ku"> b. </em>置信区间[rₘ(n)—δₘ(n)，rₘ(n)+δₘ(n)]在第n轮用，δₘ(n)= sqrt(1.5 * log(n)/nₘ(n))</li><li id="5d4f" class="kl km hp io b ip kv it kw ix kx jb ky jf kz jj kq kr ks kt bi translated"><em class="ku">我们选择具有最大UCB的机器</em> <strong class="io hq"> <em class="ku"> m </em> </strong> <em class="ku">，</em>(<em class="ku"/>rₘ(n)+δₘ(n)</li></ol></div><div class="ab cl la lb gp lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="hb hc hd he hf"><p id="00f9" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我知道这些对你来说可能看起来很混乱，但是让我们把它变得更简单！</p><p id="084c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个周末我很无聊，去了朋友(Nilesh)家。闲聊了一会儿后，我们计划一起去看电影。但问题是看哪部电影。我建议看一些科幻电影，他不同意，他建议看一些动作片，我不同意。然后他建议我们至少敲定5部电影，然后再决定看哪一部。我也同意，因为我们已经建议了很多电影。</p><p id="6f48" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以我们列出了5部电影。钢铁侠<br/> 2。天使坠落了<br/> 3。霍布斯&amp;肖<br/> 4。6地下<br/> 5。开始</p><p id="89e9" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们再次开始争夺哪一个观看，因为他们都有良好的IMDB评级。然后他妈妈来了，问我们为什么打架。我们告诉她我们的问题。她想了一下，说你为什么不问问你的其他朋友看哪部电影。我们认为这是个好主意。但是给每个人打电话并不是一个好主意，因为这非常耗时。我们做了一个谷歌表格，发给我们所有的朋友填写。这几乎花了15分钟，我们几乎收到了100条评论。现在我们有了100个不同的电影朋友的数据，他们更喜欢看。该数据包含二进制值，表示0表示他们不喜欢该电影，1表示他们喜欢该电影。</p><figure class="li lj lk ll fd hk er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lh"><img src="../Images/b56b866791f6e57eb21de2e640a18878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-9omACPg4XcBHymr0LIIg.jpeg"/></div></div></figure><p id="59c4" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">伟大的兄弟！让我们计算每部电影的总数，并选择最大的一部。</p><p id="af0a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我:我们可以这么做，但是有个问题。</p><p id="282a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">什么兄弟？</p><p id="8550" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="ku">我:兄弟，我们的朋友已经给出了他们在5部电影中最喜欢哪一部的观点，而不是基于我最喜欢钢铁侠的排名。我想我们做了错误的评论。</em></p><p id="2867" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="ku">尼尔什:你疯了吗？你是说我们得到了错误的数据集。如果你再次要求他们都来填充，这次他们可能会忽略我们。</em></p><p id="3d3e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我:我不是说我们需要另一个数据集。我认为我们需要用不同的方式来可视化这些数据。</p><p id="9656" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如何？</p><p id="861b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我:我们需要一个不偏不倚的决定，因为几乎每个评论都包含了我们的朋友也喜欢的我们选择的电影。</p><p id="8ff8" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">是的，但是我们要怎么做呢？我们不能只要求妈妈从100个评论中选择任何一部电影，看看我们的朋友是否喜欢它。然后统计每部电影最后是否被妈妈选中，是否被我们的朋友喜欢。伙计，我们最好放弃看电影的计划，去做点别的事情。</p><p id="c58b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我:我知道哥哥，但是你为什么要让妈妈来做。我们可以很容易地解决这个问题，使用我读到的置信上限方法。</p><p id="6969" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个问题和你的多股武装匪徒问题有什么相同之处？</p><p id="3c25" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我:你看，我们有5部电影和这5部电影的100条影评。我们希望机器通过每个评论进行探索，并随机选择一部电影，检查它是否受到我们朋友的喜欢。但与此同时，我们不希望机器偏向一部电影，而希望它也给其他人机会。最后，我们希望它通过利用置信上限来找到被我们的大多数朋友选择的电影。我们也会得到一个很好的视觉效果，我们会据此来看电影。</p><p id="3602" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">是的，你说到点子上了。让我们看看它会把我们带到哪里。</p><p id="1ee1" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我:是啊兄弟。</p><p id="08fd" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们在数据集上运行了下面的代码。</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="3033" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们最终得到了这样的可视化，</p><figure class="li lj lk ll fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/227438d699e613143fd184f9f082df24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*P3x6D4uoM6tlBkWsrnicyg.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">电影5(盗梦空间)得到了我们大多数朋友的喜欢</figcaption></figure><p id="0bdc" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">尼尔什:哇兄弟！我还想看《盗梦空间》，以防它不起作用，但这个模型也暗示了《盗梦空间》电影本身。</p><p id="1cc5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我:真心老弟！这太神奇了。让我们看《盗梦空间》 <strong class="io hq">。</strong></p></div><div class="ab cl la lb gp lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="hb hc hd he hf"><h2 id="803b" class="jk jl hp bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated">它到底是怎么发生的？</h2><p id="8d25" class="pw-post-body-paragraph im in hp io b ip kf ir is it kg iv iw ix kh iz ja jb ki jd je jf kj jh ji jj hb bi translated">让我们一步步了解。在此之前，我希望你在另一个<a class="ae kk" href="https://drive.google.com/file/d/1VOwRqTOYoHl434YmNeQLWEF-MIlcej5G/" rel="noopener ugc nofollow" target="_blank">选项卡</a>中打开算法步骤。</p><ol class=""><li id="ba46" class="kl km hp io b ip iq it iu ix lw jb lx jf ly jj kq kr ks kt bi translated"><strong class="io hq"> <em class="ku"> __init__ </em>方法:<br/> </strong>在这个方法中我们已经完成了算法的步骤1，并定义了某些属性。<br/> <em class="ku">自我。__N </em> →评论总数<br/> <em class="ku">自我。__m </em> →电影总数<br/> <em class="ku">自。__movie_selected </em> →每轮选出的100部电影列表<br/> <em class="ku"> self。__number_of_selection </em> →到第n轮为止电影m被选中的次数<br/> <em class="ku"> self。__sum_of_movie_rank → </em>电影m到第n轮的排名总和。</li><li id="37ac" class="kl km hp io b ip kv it kw ix kx jb ky jf kz jj kq kr ks kt bi translated"><strong class="io hq">实现_ucb方法:<br/> </strong>在这个方法中，我们实现了步骤2和步骤3的结合。</li></ol><figure class="li lj lk ll fd hk er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lz"><img src="../Images/6e8304c14cc7ba48192bbb94548d6d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgLWyzmlK1eJcFt9S0sBAw.jpeg"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">UCB算法的第二步</figcaption></figure><p id="113f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在If条件中，我们检查电影是否至少被选择了一次。因为如果它没有被选择至少一次，那么根据算法的步骤2(a)的公式，我们将得到无穷大，因为分母变成0。如果电影没有被选择至少一次，那么它将把它的上限设置为无穷大(这里用高值1e500表示)。</p><p id="72ec" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">否则，根据步骤2(a)中的公式计算电影的平均等级，并根据步骤2(b)中的公式计算上置信度。</p><p id="20df" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们已经实施了第2步，让我们进入第3步。</p><figure class="li lj lk ll fd hk er es paragraph-image"><div class="er es ma"><img src="../Images/62862b5339edceee758312fc5e319dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*2IPhXLfS3cnagQl698hCgA.jpeg"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">第三步</figcaption></figure><p id="d41c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在步骤3中，我们将计算的上限与最大上限进行比较，如果它大于<em class="ku"> max_upper_bound </em>，则将上限作为最大上限，并将选择的电影作为当前电影。</p></div><div class="ab cl la lb gp lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="hb hc hd he hf"><p id="ad38" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这就是UCB的实现方式。可以有多种方法来实现。如果你用另一种方法解决，请随意分享。</p></div><div class="ab cl la lb gp lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="hb hc hd he hf"><p id="50df" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="ku">参考文献</em>:</p><ol class=""><li id="1f73" class="kl km hp io b ip iq it iu ix lw jb lx jf ly jj kq kr ks kt bi translated"><a class="ae kk" href="https://www.udemy.com/course/machinelearning/learn/lecture/6456832#questions" rel="noopener ugc nofollow" target="_blank">https://www . udemy . com/course/machine learning/learn/lecture/6456832 #问题</a></li></ol></div></div>    
</body>
</html>