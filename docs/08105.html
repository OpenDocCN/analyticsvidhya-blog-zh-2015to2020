<html>
<head>
<title>Beginner’s Guide to Association Rule Learning using Apriori</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Apriori学习关联规则的初学者指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/beginners-guide-to-association-rule-learning-using-apriori-723c1bc02ae6?source=collection_archive---------18-----------------------#2020-07-17">https://medium.com/analytics-vidhya/beginners-guide-to-association-rule-learning-using-apriori-723c1bc02ae6?source=collection_archive---------18-----------------------#2020-07-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1f28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们经常在亚马逊上浏览时遇到“购买了A商品的顾客也购买了这些”或“看过电影A的人也在网飞上看过这些”的情况。这种类型的购买或观看建议是通过所谓的关联规则学习来实现的。今天我要和大家分享一个非常著名的关联规则学习算法<strong class="ih hj"> Apriori </strong>。这种算法以其更复杂的形式被世界各地的许多企业用来提供相关产品的折扣或建议人们购买相关产品。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/13d5d368aa99d5d6373d7e5d85ea817f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HWYnEEkCXomHO4Q5"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@jjying?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="dac1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关联规则学习是一种机器学习方法，用于发现大型数据库中变量之间有趣和有用的关系。它旨在使用一些感兴趣的度量来识别在数据库中发现的强规则。</p><p id="d1bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Apriori算法有三个基本部分，这三个部分是其运行所必需的。让我们先了解一下这些基本理论。我将使用一些变量的随机值来简化这一部分。数据集将在本文的后面部分详细解释。</p><p id="087a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">支持度:支持度是一个项目集出现在数据集中的频率的指示。让我们考虑产品A。那么产品A的支持由下式给出</p><p id="8dec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Supp(A) =(购买A的用户数)/(用户总数)</p><p id="800b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">信心:</strong>信心是我们的规则被发现为真的频率的指示，即，如果我们通过说如果一个人购买产品A，那么他也可能购买产品B来形成规则。因此，</p><p id="13fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Conf(A → B) =(同时购买A <strong class="ih hj">和</strong> B的用户数量)/(购买A的用户数量)</p><p id="5781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">升力:</strong>升力是我们预测中的改进。它描述了规则的质量或相关性。</p><p id="1fb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">升力(A → B) =形态(A→B)/支持(B)</p><p id="9626" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个简单的例子来描述这些术语。假设我们有一个100人的样本，其中40人购买了产品a。然后，</p><p id="72c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Supp(A) = 40/100 = 2/5</p><p id="8062" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这40个人中，假设有7个人也买了A，那么，</p><p id="1f14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Conf(A → B) = 7/40</p><p id="28d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，假设10%的人买了B，不管他们是否买了A。然后，</p><p id="4b7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Supp(B) = 10/100 = 1/10并且</p><p id="22f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">升力(A→B)=(7/40)/(1/10)=(7/40)* 10 = 7/4 = 1.75</p><p id="8739" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是我们需要知道的一切。现在，让我们直接进入它的Python实现。我们这里的目标是从数据集中确定哪些产品最常一起购买。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="6ca6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将从安装将要使用Apriori的库开始。通常，这个库不包含在标准的Anaconda发行版中。该库的名称为<a class="ae jt" href="https://pypi.org/project/apyori/" rel="noopener ugc nofollow" target="_blank"> Apyori </a>。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="02d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们将导入一些标准库，如NumPy和pandas。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="8df8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们导入数据集。这里要记住的一件非常重要的事情是，Apriori只接受规则计算的字符串列表形式的输入。因此，要始终注意将每个元素转换成一个字符串，并将它们排列成一个字符串列表，其中每个列表都是一个特定用户进行的交易。数据集在<a class="ae jt" href="https://drive.google.com/file/d/1iHPLs2m5o-b5yzRZEi7aVo5KPQkuNyDU/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>可用。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="eea2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集有7501行和20列。每一行代表客户在某一天进行的交易。每一列对应一种特定的产品。我们将把这个数据帧转换成一个7501列表的列表，其中每个列表代表一个事务。任何缺少的值将由字符串“nan”填充。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="db12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然已经创建了事务列表，那么是时候训练我们的模型了。首先，我们导入先验。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="85c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将创建一个变量<strong class="ih hj">规则</strong>，它将包含先验函数的输出。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="d1f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我按照以下逻辑设置了最小支持度:只有当一个产品一天至少出现三次时，算法才会考虑制定规则。一周有7天，因此，由于数据集有一周的观察，我们每周将有至少21次产品出现，因此对任何考虑中的产品的最小支持是(21/7501)。最小置信度是我用试错法设定的。经过几次尝试后，我将最小置信度设置为0.2，因为较高的置信度会导致较少或没有规则。电梯的情况也是如此。</p><p id="25ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">max_length和min_length用于描述规则两侧产品总数的最大和最小总和。在这里，我只使用一种产品，对应于这种产品，算法将确定哪种产品与它一起被最频繁地购买。如果您希望在众多产品中确定购买的产品，请相应地设置最大和最小长度。</p><p id="f15d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简洁明了地显示规则，我将把它打印成一个列表。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="e741" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果将以下列方式显示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/0622799dd100b64fe9e8b989b5ec2eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sC3-KL_a4jHd8CfK5IjnLQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最终规则。图片由作者提供。</figcaption></figure><p id="3c65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在以RelationRecord开始的每一行中，items_base告诉我们最初购买的产品，items_add提供与items_base一起购买的产品。从第二行可以明显看出，在获得数据集的超市中，每当人们购买淡奶油时，他们往往也会在篮子中加入鸡肉。这个观察值的升力是4.84，这告诉我们这确实是一个强规则。</p><p id="7e74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我将这些结果排列在一个整洁干净的数据框中。尝试和理解这段代码是可选的。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="0b12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将是我将所有内容放入数据框的最后一段代码，我还将显示前10条相关规则。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/e72da52bc8661b8894ef011cf5be7c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*b2onfBCvEa-s20IKfS3idw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">显示前10个相关规则的数据框，根据其各自的提升按降序排列。图片由作者提供。</figcaption></figure><p id="c3ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在这里有一些有趣的奖励。有人可能会问，那么，我们用这样一套规则做什么呢？作为超市经理，如果由我来决定，我会利用这些规则为经常一起购买的商品提供有趣的优惠，这将使我在市场竞争中获得优势，并吸引更多的顾客。</p><p id="8cf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢你坚持到最后。希望你喜欢它！！</p></div></div>    
</body>
</html>