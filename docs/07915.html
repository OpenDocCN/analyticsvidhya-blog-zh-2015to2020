<html>
<head>
<title>Scrape data when the URL is changing based on the search term</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当URL根据搜索词发生变化时抓取数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/scrape-data-when-the-url-is-changing-based-on-the-search-term-726feca08cb8?source=collection_archive---------25-----------------------#2020-07-11">https://medium.com/analytics-vidhya/scrape-data-when-the-url-is-changing-based-on-the-search-term-726feca08cb8?source=collection_archive---------25-----------------------#2020-07-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="97f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的，我不确定如何开始我的第一个项目，以及该做些什么。我热爱太多的东西，经过长时间的思考，我决定现在是时候将我的热情付诸行动了——网球！。</p><p id="9df7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想知道一个球员全年的排名，于是开始在网上寻找不同的网站，找到了官方网站<a class="ae jd" href="https://www.atptour.com/" rel="noopener ugc nofollow" target="_blank">https://www.atptour.com/</a>。吨的信息，但我只想一件事，排名！一切都好，准备处理并开始刮网，但是！我意识到每个玩家都有唯一的标识符:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/b637bdfa139cf0c2d08d97a26bfb2e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*wYA2w4kNmxKhlwihsF2RUg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">圆圈内-拉斐尔·纳达尔的唯一标识符</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jq"><img src="../Images/959e1171dcdea8b43ac382c58d987782.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*cmTBkbell_XFkG7rXyEcZQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">罗杰·费德勒的唯一标识符</figcaption></figure><p id="4d40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而且是不可能的(或者无聊！！！)手动输入URL并将他们的表格下载到nice data-frame中以绘制图表。不确定该做什么，记得硒是存在的，但你会问我如何用它来做？让我告诉你一个好方法。</p><p id="f795" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的目标是将任何玩家的排名下载到熊猫数据框中，并绘制成图表以供可视化。</p><p id="61ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将一步一步地讲述如何利用美丽的硒/美丽的汤/请求和熊猫。</p><p id="5bd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先也是最重要的是安装它们，最简单的方法:PIP INSTALL(模块名)，它很快就准备好了。为此:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/610060695d75441ef4a38f9561d516c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*CEsWmviJlg-T5tWbeNWcXQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">搜索CMD</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es js"><img src="../Images/82b2c8a972a0abb48f5f43a2daab63ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*T-HXgvxAqIQdbkCW0tnydg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">只需输入。很简单，对吧？</figcaption></figure><p id="0968" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下载完所有模块后，我们就准备好了！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jt"><img src="../Images/e53f39faaaf891c5c74b0302f4c36cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*adV819djkzkUIBR7RPolZQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">他们每个人都有一个目的，你以后会发现。保证！</figcaption></figure><p id="5c3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在导入模块或导入它的一部分，例如selenium的webdriver，它与浏览器连接(我使用chrome来简化和更好地与selenium同步，Firefox对我不起作用；-( ).</p><p id="dc62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要为我们的驱动程序(浏览器)设置一个变量。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ju"><img src="../Images/f4cf44b808f7feebc2ff9ce270a69608.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*Np-BCfjdhq_eJuyP3rz4oQ.png"/></div></figure><p id="4c88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们伟大的Python知道我们正在使用什么浏览器了。接下来的事情就看你的喜好了:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jv"><img src="../Images/82ace3ced7cb0edc9e88e58bb7d15dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*DUjFm17YRNGNvlit39iygw.png"/></div></figure><p id="e16a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">命令Selenium在网站上传后等待1秒钟，有时会发生Selenium工作非常快，网站很慢，并且会因为他没有找到元素而抛出错误(此外，请保证在下面解释它！)</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/5af1d293573d073053765421ffb059a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*NK8-gkvcxv04CCHKmBKM9Q.png"/></div></figure><p id="7a9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">直接进入搜索页面找到我们想要的球员。</p><p id="c368" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码的下一部分是最令人沮丧的，需要耐心，我爱我的电脑不像这个家伙:-):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jx"><img src="../Images/6afb6cbc94fc560121729e48b1f858dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*BtVnTYbXRDWZHjQ00ps-vw.gif"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jy"><img src="../Images/d1d66e2376ac126dcae78ad74fcc638d.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*_b5zACFSYejtWVch1Lzk8g.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">这是什么？</figcaption></figure><p id="1b8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面那行你需要用inspect找到</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jz"><img src="../Images/5c16e130bf782c8b931c3074cc9cc541.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*zzOMebL4ocLOa24BNXWWOg.png"/></div></figure><p id="b0dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你需要找到搜索框所在的确切位置，找到了吗？</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ka"><img src="../Images/c034a37cb558bdffa47bb21cef4f0263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-F8jBZorr7PJd5EqWxLrxw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">XPATH现在已经找到了，复制它并粘贴到您的代码中</figcaption></figure><p id="3d11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使它变得更容易，Selenium提供了按不同参数搜索的选项，这里是按ID，即find.element_by_id()</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kf"><img src="../Images/4800e3dcb3351140ceb3117c0d7ad8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*D0xk5iOKvw3bZf8tmOXVnA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">XPATH——因为Selenium很好，所以只需要@id后面的部分</figcaption></figure><p id="4343" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">selenium知道你要在哪里输入玩家的名字后，现在是时候键入它了:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kg"><img src="../Images/6cb7e096416622737b66ae90bed47f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*8SLsvyv5d7WRRVCEqx3s2Q.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">用人类的语言来说:Send_keys = type。keys.return = Enter</figcaption></figure><p id="3e2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太棒了，现在我们键入(send_keys)玩家的名字，然后按enter (keys.return)。但是！我们可能会遇到一个恼人的问题，错别字时，寻找一个球员来避免它，我们可以使用伟大的尝试/除外。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kh"><img src="../Images/5ba8c8ccaf9049c5ad12b2e2552ae4dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-b1RWTwDezNTb-mhErbwA.png"/></div></div></figure><p id="9576" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的截图，记得令人沮丧的XPATH，这里我们再次寻找玩家的元素来点击它。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ki"><img src="../Images/ea762de7425a2cc7562c447df7d8ea9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3MRLoEsylmOhzegrNRMJDQ.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">我们找到了它，现在我们可以点击它进入玩家的花瓶信息。</figcaption></figure><p id="89e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是计算机不是在人工智能上运行的，而且确实是“愚蠢的”,所以如果我做错了，计算机会问我:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kj"><img src="../Images/31b5f6bd2572039f86d13b89eacb6196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*zTFlnQs6q5W-TZEJZfcJxg.gif"/></div></figure><p id="4344" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并抛出可怕的追溯</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kk"><img src="../Images/9bab3d71d5cd183100702d3179a6ca44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d2cN1641s8M2tkntcL4JFw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jx"><img src="../Images/14a439d62a13d37f28ae981e438f08c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*KA76h9KQ7rKer2gX6eEbfA.gif"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">那是每次追溯后的我:-)</figcaption></figure><p id="f6ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不过放心，生活是美好的，我们的蟒蛇也是。为了转移这个问题，我们使用了try/except，如果有错别字，我们会很容易地纠正它。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kl"><img src="../Images/742b9d3162cabd02185c4fa3196f9ac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*M3nV7QHcp20AUmOn4hQAPA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">你决定什么是你的追溯</figcaption></figure><p id="9d61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太棒了，我们通过了关卡。现在我们想知道具体玩家的网址并打印出来。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es km"><img src="../Images/21fca2a9ad3d31747ca83dbbefa5f6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TIcNQdmJExjnPi9eK4llJw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">我将在我的下一篇文章中解释我到底在这里做什么，现在就这样吧。</figcaption></figure><p id="64c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们找到了“排名历史”的XPATH，点击它，它将我们带到页面。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kn"><img src="../Images/d606d1e8d0bc253a083f2ea0a2e0789c.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*L_d1LvrhElpwyIVwDgXZDg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">同样，因为是我的函数的一部分，url == None把它当作是。</figcaption></figure><p id="933f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Selenium有一个很棒的功能，可以抓取当前的url:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ko"><img src="../Images/56c30de387041cafc423d3ed986db9e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*CU9uyMG9wRSe_vxcWxYVAQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">罗杰·费德勒的当前URL =登录页面</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kp"><img src="../Images/1a4646aa3ac6fcd6538e30613bbafd5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/1*QATh51XAtbX9cdJ6nJFLYw.gif"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">找到网址了！！！</figcaption></figure><p id="3d59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们知道了如何获取URL，下一篇文章我将展示如何下载熊猫格式的数据。</p><p id="b4fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢它，并请评论让我知道它是否好，当然还有任何反馈！</p></div></div>    
</body>
</html>