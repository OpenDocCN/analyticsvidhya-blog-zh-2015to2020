<html>
<head>
<title>GoogleNews API—Live News from Google News using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GoogleNews API——使用Python从Google News获取实时新闻</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/googlenews-api-live-news-from-google-news-using-python-b50272f0a8f0?source=collection_archive---------2-----------------------#2020-06-17">https://medium.com/analytics-vidhya/googlenews-api-live-news-from-google-news-using-python-b50272f0a8f0?source=collection_archive---------2-----------------------#2020-06-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/b0da9e8430d11c74a761ee10e02ecd0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*kSGc10VrNZ9AgV5gyLHiiQ.jpeg"/></div></figure><p id="6513" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">大家好。我已经有了一些令人兴奋的东西和一个更简单的方法来搜索来自世界各地的新闻。我们知道如何使用BeautifulSoup和Selenium来抓取新闻文章。但是有了这个api，您不需要将自己限制在几个来源或出版物上。</p><p id="2d60" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我告诉你一个我工作的愚蠢方法，这样你就不会犯同样的错误。但是他们说愚蠢对你的职业有好处。我得到了一个项目，收集新闻文章，并在文章上应用一些数据可视化，并创建一个仪表板。如果你们想知道我是如何创建仪表板的，我很乐意与你们分享。所以，回到这个故事，我当时不知道我们有这么简单的方法来获取实时新闻文章。我坚持使用一些特定数量的出版物，访问每个出版物的网站，对每个搜索查询应用beautifulsoup和selenium来获取链接，然后使用报纸模块来解析文章。在我完成这个项目后，我发现了最简单的api，它可以让我们的生活变得更容易，而且一点也不耗时，至少与我以前获得相同甚至更精确结果的方法相比是这样的。所以，我们继续吧，不要再浪费你的宝贵时间了。</p><p id="7bcc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一个任务是安装GoogleNews和newspaper3k来解析文章，这可以通过下面的语句来完成。</p><p id="4280" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">！pip安装GoogleNews</p><p id="1a19" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">！pip安装报纸3k</p><p id="8dab" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">是时候导入一些库来获取我们现在要获取的文章列表了。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="c0f7" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq hj">from </strong>GoogleNews <strong class="jq hj">import </strong>GoogleNews<br/><strong class="jq hj">from </strong>newspaper <strong class="jq hj">import </strong>Article<br/><strong class="jq hj">import </strong>pandas <strong class="jq hj">as </strong>pd</span></pre><p id="0b65" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下一个任务是获取数据。给定您想要搜索新闻文章的时间段和查询，我们将获得一个列表，其中包含日期、标题、媒体、描述、文章发布的链接以及img属性下的图像链接。</p><p id="64cc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您将在下面的代码中看到，googlenews.result()将返回我们上面讨论的所有内容的列表</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="afde" class="ju jv hi jq b fi jw jx l jy jz">googlenews=GoogleNews(start=<strong class="jq hj">'05/01/2020'</strong>,end=<strong class="jq hj">'05/31/2020'</strong>)<br/>googlenews.search(<strong class="jq hj">'Coronavirus'</strong>)<br/>result=googlenews.result()<br/>df=pd.DataFrame(result)<br/>print(df.head())</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/3beaa191572dd15ce62c30b8f87a2b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*-WIicTak4ybpL_t8KCP2kg.png"/></div></figure><p id="f8a6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们已经在开始和结束变量中指定了时间段。我们将在调用搜索函数时提供查询作为参数。此api中的新闻数量有搜索限制。我们最多能收集10条新闻。现在，我们将努力获取更多。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="7f19" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq hj">for </strong>i <strong class="jq hj">in </strong>range(2,20):<br/>    googlenews.getpage(i)<br/>    result=googlenews.result()<br/>    df=pd.DataFrame(result)</span></pre><p id="c8dd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以在for循环中写尽可能多的数字来得到页码。它将停止，直到它得到所有的文章，关于在特定时间段的搜索。</p><p id="d175" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们来看看给定出版物中20篇文章的图表示例。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="er es kb"><img src="../Images/ed184b297dbc9cddfdfb729075aa8769.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oyQwXBqlMVt3BJNDPlbZ5Q.png"/></div></div></figure><p id="dfda" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，您还没有使用本模块获得完整的文章。谷歌新闻的描述属性不会给你完整的文章。所以我们现在将尝试从python的报纸模块中提取并解析文章。我们已经导入了文章库。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="a25f" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq hj">for </strong>ind <strong class="jq hj">in </strong>df.index:<br/>    dict={}<br/>    article = Article(df[<strong class="jq hj">'link'</strong>][ind])<br/>    article.download()<br/>    article.parse()<br/>    article.nlp()<br/>    dict[<strong class="jq hj">'Date'</strong>]=df[<strong class="jq hj">'date'</strong>][ind]<br/>    dict[<strong class="jq hj">'Media'</strong>]=df[<strong class="jq hj">'media'</strong>][ind]<br/>    dict[<strong class="jq hj">'Title'</strong>]=article.title<br/>    dict[<strong class="jq hj">'Article'</strong>]=article.text<br/>    dict[<strong class="jq hj">'Summary'</strong>]=article.summary<br/>    list.append(dict)<br/>news_df=pd.DataFrame(list)<br/>news_df.to_excel("articles.xlsx")</span></pre><p id="281f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将遍历前面创建的数据框架，并创建一个新的数据框架，其中也可以包含完整的文章和摘要。前面数据帧中的链接列包含文章发布的链接，通过文章包，我们可以获取文章和摘要。标题列已经存在，因此您可以从前面的数据框架中访问它，也可以从文章包中访问它。我们也可以把这个数据框转换成excel表格。</p><p id="fa6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">以下是完整的代码:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="396b" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq hj">from </strong>GoogleNews <strong class="jq hj">import </strong>GoogleNews<br/><strong class="jq hj">from </strong>newspaper <strong class="jq hj">import </strong>Article<br/>from newspaper import Config<br/><strong class="jq hj">import </strong>pandas <strong class="jq hj">as </strong>pd<br/>import nltk</span><span id="1dda" class="ju jv hi jq b fi kg jx l jy jz">#config will allow us to access the specified url for which we are #not authorized. Sometimes we may get 403 client error while parsing #the link to download the article.</span><span id="33dd" class="ju jv hi jq b fi kg jx l jy jz">nltk.download('punkt')<br/><br/>user_agent = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36'<br/>config = Config()<br/>config.browser_user_agent = user_agent</span><span id="7363" class="ju jv hi jq b fi kg jx l jy jz">googlenews=GoogleNews(start=<strong class="jq hj">'05/01/2020'</strong>,end=<strong class="jq hj">'05/31/2020'</strong>)<br/>googlenews.search(<strong class="jq hj">'Coronavirus'</strong>)<br/>result=googlenews.result()<br/>df=pd.DataFrame(result)<br/>print(df.head())</span><span id="88ce" class="ju jv hi jq b fi kg jx l jy jz"><strong class="jq hj">for </strong>i <strong class="jq hj">in </strong>range(2,20):<br/>    googlenews.getpage(i)<br/>    result=googlenews.result()<br/>    df=pd.DataFrame(result)<br/>list=[]</span><span id="943b" class="ju jv hi jq b fi kg jx l jy jz"><strong class="jq hj">for </strong>ind <strong class="jq hj">in </strong>df.index:<br/>    dict={}<br/>    article = Article(df[<strong class="jq hj">'link'</strong>][ind],config=config)<br/>    article.download()<br/>    article.parse()<br/>    article.nlp()<br/>    dict[<strong class="jq hj">'Date'</strong>]=df[<strong class="jq hj">'date'</strong>][ind]<br/>    dict[<strong class="jq hj">'Media'</strong>]=df[<strong class="jq hj">'media'</strong>][ind]<br/>    dict[<strong class="jq hj">'Title'</strong>]=article.title<br/>    dict[<strong class="jq hj">'Article'</strong>]=article.text<br/>    dict[<strong class="jq hj">'Summary'</strong>]=article.summary<br/>    list.append(dict)<br/>news_df=pd.DataFrame(list)<br/>news_df.to_excel("articles.xlsx")</span></pre><p id="d27d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">希望有所帮助。编码快乐！</p></div></div>    
</body>
</html>