<html>
<head>
<title>Regularization: Batch-normalization and Drop out</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正规化:批量正规化和退出</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/everything-you-need-to-know-about-regularizer-eb477b0c82ba?source=collection_archive---------5-----------------------#2020-07-16">https://medium.com/analytics-vidhya/everything-you-need-to-know-about-regularizer-eb477b0c82ba?source=collection_archive---------5-----------------------#2020-07-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="bb2c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">批量归一化和丢弃作为正则化器来克服深度学习模型中的过拟合问题。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/de4560fefbe05789a22b4d5f871ac400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/1*oZjtmox-nEmcnW1NV5GVbw.gif"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://towardsdatascience.com/why-so-many-data-scientists-are-leaving-their-jobs-a1f0329d7ea4" rel="noopener" target="_blank">来源</a></figcaption></figure><p id="2ce6" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">您是否遇到过导致过度拟合的大型数据集？</p><p id="d71f" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">过度拟合的原因之一是网络中的大权重。网络权重较大的网络可能是网络不稳定的标志，在这种情况下，输入的微小变化会导致输出的巨大变化。这个问题的解决方案是更新学习算法，以鼓励网络保持较小的权重。这就是所谓的正规化。</p><p id="7ea9" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">在本文中，我们将发现权重正则化如何帮助更快地训练网络，减少过度拟合，并通过深度学习模型进行更好的预测。</p><p id="e9c7" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">下面提到了用于正则化的一些技术</p><ul class=""><li id="b603" class="kg kh hi jm b jn jo jq jr jt ki jx kj kb kk kf kl km kn ko bi translated">批量标准化</li><li id="88fd" class="kg kh hi jm b jn kp jq kq jt kr jx ks kb kt kf kl km kn ko bi translated">脱落层</li></ul><p id="d7ca" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">先说批量归一化，</p><h2 id="18da" class="ku kv hi bd kw kx ky kz la lb lc ld le jt lf lg lh jx li lj lk kb ll lm ln lo bi translated">批量标准化</h2><p id="4925" class="pw-post-body-paragraph jk jl hi jm b jn lp ij jp jq lq im js jt lr jv jw jx ls jz ka kb lt kd ke kf hb bi translated">批处理规范化是一种提高人工神经网络的速度、性能和稳定性的技术，也称为批处理规范。想法是以这样的方式标准化每一层的输入，使得它们具有平均激活输出零和单位标准偏差。</p><p id="1518" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj">为什么我们要将输入标准化？</strong></p><p id="0f21" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">假设我们有2D数据，X1和X2。X1特征在200到-200之间具有非常宽的分布，而X2特征具有非常窄的分布。左图显示了具有不同范围的数据的方差。右图显示数据位于-2到2之间，并且正态分布，平均值和单位方差为0。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lu"><img src="../Images/6ffc84ac56d58acfc369b177ef257eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DUy0lDzmF_vwSWhe"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://padhai.onefourthlabs.in/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="24fa" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">本质上，通过归一化来缩放输入使误差表面更接近球形，否则它将是一个非常高曲率的椭圆。有一个高曲率的误差曲面意味着我们采取了许多不一定是最佳方向的步骤。当我们缩放输入时，我们减少曲率，这使得像梯度下降这样忽略曲率的方法工作得更好。当误差表面是圆形或球形时，梯度指向最小值。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lz"><img src="../Images/6139f4da051eed7e9e9f8f97415c538a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PWqw2iUsKZZsLAtr"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://www.oreilly.com/library/view/fundamentals-of-deep/9781491925607/ch04.html" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ma"><img src="../Images/7e23948e9d7f39370965bb18cb20819f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/0*rA412lbmoP3I83Ie"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://mc.ai/a-way-to-improve-gradient-descent-stochastic-gradient-descent-with-restarts/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="f099" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj">为什么叫批量归一化？</strong></p><p id="f884" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">在批量标准化中，正如我们对输入进行标准化一样，我们也对所有层的激活进行标准化，因此，在每一层，我们的平均值和单位标准偏差均为0。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mb"><img src="../Images/528e5fc35855dd4de360e83647bcd003.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/0*sWV5iIxuAXUKC6PJ"/></div></figure><p id="3034" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">这就是我们如何使所有层的激活正常化。</p><p id="ae51" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">最终活化层将是，</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mc"><img src="../Images/5bc7c2694b9642ae387fde5f56c6be01.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*hW82PvuRWkuY8FAm"/></div></figure><p id="cf62" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">在参数γ和β与网络的其它参数一起被学习的情况下，它也将对损耗有所贡献，因为h_final取决于γ和β，这也将对损耗有所贡献。</p><p id="e53f" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">现在，如果γ(gamma)变为σ(标准差),β(beta)变为μ(均值),则等式变为:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es md"><img src="../Images/18c85a96fb5d67f1f44b2cb9e717a62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*00y0EAc1Fa5_3am5fOEl5w.png"/></div></figure><p id="afaf" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">σ = 1且μ = 0，那么我们可以说，</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es me"><img src="../Images/a47f58d2b715235af766c6152615d49d.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/format:webp/1*Gx7FQuLHMUfcU3DlSeUiFQ.png"/></div></figure><p id="b90d" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">因此网络在两个方向上都具有灵活性，</p><ul class=""><li id="3424" class="kg kh hi jm b jn jo jq jr jt ki jx kj kb kk kf kl km kn ko bi translated">如果归一化有助于减少误差损失，则输入为(γ)γ= 1和(β)β= 0。</li><li id="c976" class="kg kh hi jm b jn kp jq kq jt kr jx ks kb kt kf kl km kn ko bi translated">否则，可学习的参数γ和β将以这样一种方式学习，即总损失将减少。</li></ul><p id="6ce6" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj">批处理规范化作为一个正则化器是如何工作的？</strong></p><p id="bbec" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">所以我们计算的是小批量的平均值和标准差，而不是整个数据。因此，在每一层，我们添加噪声，噪声具有非零均值和非单位方差，并且是为每一层随机生成的。然后将它添加到批量归一化层之后，以故意将协变量转换引入激活，它充当正则化子。因此，在信息较少的情况下，网络必须预测正确的标签。也使模型更加健壮。</p><p id="bc9c" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj">合奏法:</strong></p><p id="7947" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj"> Ensemble </strong>学习通过组合几个模型来帮助提高机器学习结果。集成方法是一种元算法，它将几种机器学习技术结合到一个预测模型中，以减少方差(bagging)、偏差(boosting)或改善预测。</p><p id="b50c" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj">辍学的想法</strong></p><p id="e271" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">用数据上的大参数训练一个深度神经网络可能导致<em class="mf">过拟合</em>。</p><p id="1457" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><em class="mf">能否在同一数据集上训练多个不同配置的神经网络，并取这些预测的平均值？</em></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mg"><img src="../Images/0dfebab82bf7be713b071ca233a48d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/0*qp8E65zwfzzvDW48"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://giphy.com/explore/yes-we-can" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="2832" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">但是已知具有不同模型配置的神经网络的集成可以减少过拟合，但是需要训练和维护多个模型的额外计算费用。</p><p id="6aae" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">所以在图片中出现了<em class="mf">退出层</em>，</p><p id="c364" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">通过在训练期间随机删除节点，可以使用单个模型来模拟具有大量不同的网络架构。这被称为dropout，它提供了一种计算上非常便宜且有效的正则化方法来减少过拟合并改善泛化误差。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mh"><img src="../Images/d3810cdf0a49e236b64f6b43d22ed663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bTMVb8uekPpHxDcm"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://padhai.onefourthlabs.in/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="170d" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">在训练期间，一定数量的层输出以一定的概率p被丢弃。这具有使该层看起来像并且被视为像具有不同数量的节点和与前一层的连通性的层的效果。在中，训练期间对层的每次更新都是用所配置层的不同视图来执行的。</p><p id="c3d8" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj">结论</strong></p><ol class=""><li id="7b9d" class="kg kh hi jm b jn jo jq jr jt ki jx kj kb kk kf mi km kn ko bi translated">批量归一化将从分散到异常值的梯度正则化，并在小批量的范围内向共同目标流动(通过归一化它们)。导致学习过程的加速。</li><li id="a715" class="kg kh hi jm b jn kp jq kq jt kr jx ks kb kt kf mi km kn ko bi translated">辍学是神经网络中的一种正则化方法，有助于减少神经元之间的相互依赖学习。</li></ol><blockquote class="mj mk ml"><p id="8a20" class="jk jl mf jm b jn jo ij jp jq jr im js mm ju jv jw mn jy jz ka mo kc kd ke kf hb bi translated">引用说明:本文的内容和结构基于四分之一实验室PadhAI的深度学习讲座。</p></blockquote><p id="387e" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">如果你有任何反馈让我改进，或者如果你想分享任何想法或经验，请随意评论。</p><p id="f03d" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">你想要更多吗？在<a class="ae jj" href="https://www.linkedin.com/in/aditi-kothiya/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae jj" href="https://github.com/Aditi81" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上关注我。</p></div></div>    
</body>
</html>