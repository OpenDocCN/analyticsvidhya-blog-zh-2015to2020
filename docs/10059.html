<html>
<head>
<title>How to install TensorFlow, cuda-toolkit, and cudnn on Windows 10?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Windows 10上安装TensorFlow、cuda-toolkit、cudnn？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-install-tensorflow-cuda-toolkit-and-cudnn-on-windows-10-9efa075b448c?source=collection_archive---------4-----------------------#2020-10-03">https://medium.com/analytics-vidhya/how-to-install-tensorflow-cuda-toolkit-and-cudnn-on-windows-10-9efa075b448c?source=collection_archive---------4-----------------------#2020-10-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="50f8" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">让TensorFlow与GPU协同工作的分步指南。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/e2fbb2d9ca39534dd17895e6410f94d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DppmLjUV-MCkJ_9F"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jn" href="https://unsplash.com/@nanadua11?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">娜娜杜瓦</a>拍摄的照片</figcaption></figure><h1 id="d01e" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="f192" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">我个人使用Anaconda作为我的<em class="lc"> goto </em> Python发行版。因此，我选择的包管理器是<strong class="ki hj"> <em class="lc"> conda </em> </strong>。直到大约一个月前，我所要做的就是让TensorFlow与GPU一起工作:<em class="lc">conda install tensor flow-GPU = version *。</em>我确实用上面的命令行安装了TensorFlow-GPU 1.15和2.1.0，运行起来完美无缺。下图向我们展示了这一点。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ld"><img src="../Images/c8f5b90c9d5b96fed00cd14d68f7d4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fdFqdLV6EDEHtVcuG7xOlw.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">TensorFlow v1.15.0和v2.1.0使用GPU，无需手动安装cuda-toolkit和cudnn</figcaption></figure><p id="3e02" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated">从<em class="lc">程序和功能</em>窗口可以看到，没有手动安装cuda-toolkit的组件。<em class="lc">康达</em>以前是在环境本身做的。因此，当我写<a class="ae jn" rel="noopener" href="/analytics-vidhya/comparing-gpu-performance-for-deep-learning-between-pop-os-ubuntu-and-windows-69aa3973cc1f?source=friends_link&amp;sk=1039650505eec776dbd5e186f3f5910b"> <em class="lc">我以前的文章</em> </a>时，我试图在我的机器学习平台上以同样的方式安装它。它抛出了一个如下所示的错误(因为我已经在我的钻机上安装了它，所以我在我的笔记本电脑上重新创建了这个错误)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ld"><img src="../Images/d71d95896e3e6dfc828c7377dafe4015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tnseLrT0V0jeaGB0gDP8ug.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">导入tf版本2.1.0时出错</figcaption></figure><p id="7ba3" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated">它证明TensorFlow v1.15仍然可以检测到我的GPU，但当我试图使用v2.1.0时，我抛出了一个错误。我谷歌了一下，大多数答案导致我手动安装cuda-toolkit和cudnn。由于许多人认为在Windows上运行这个程序很麻烦，所以我决定写一个循序渐进的指南。</p><p id="69b4" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated">当cuda-toolkit和cudnn版本与TensorFlow版本的要求不匹配时，我还得到一个错误。你可以在这里  <em class="lc">(查看已测试的构建配置)</em>阅读更多关于哪个版本的TensorFlow需要哪个版本的cuda-toolkit和cudnn <a class="ae jn" href="https://www.tensorflow.org/install/source_windows" rel="noopener ugc nofollow" target="_blank"> <em class="lc">。</em></a></p><h1 id="bf89" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">所以让我们开始吧。</h1><h2 id="831d" class="lj jp hi bd jq lk ll lm ju ln lo lp jy kp lq lr ka kt ls lt kc kx lu lv ke lw bi translated">第一步</h2><p id="3567" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">检查您是否有支持Cuda的显卡。点击 可以找到一个列表<a class="ae jn" href="https://developer.nvidia.com/cuda-gpus" rel="noopener ugc nofollow" target="_blank"> <em class="lc">。如果是，您需要将显卡驱动程序更新到418.x版或更高版本。可以从<a class="ae jn" href="https://www.nvidia.com/download/index.aspx?lang=en-us" rel="noopener ugc nofollow" target="_blank"> <em class="lc"> Nvidia的网站</em> </a>手动下载驱动或者使用<a class="ae jn" href="https://www.nvidia.com/de-de/geforce/geforce-experience/" rel="noopener ugc nofollow" target="_blank"> <em class="lc"> GeForce体验</em> </a>。</em></a></p><h2 id="be97" class="lj jp hi bd jq lk ll lm ju ln lo lp jy kp lq lr ka kt ls lt kc kx lu lv ke lw bi translated">第二步</h2><p id="23de" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">安装cuda工具包。你可以在<a class="ae jn" href="https://developer.nvidia.com/cuda-toolkit-archive" rel="noopener ugc nofollow" target="_blank"> <em class="lc">这个档案</em> </a>里找到所有版本。</p><ul class=""><li id="d386" class="lx ly hi ki b kj le km lf kp lz kt ma kx mb lb mc md me mf bi translated">首先，决定你想要哪个版本的TensorFlow。</li><li id="ba73" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">看这里的<a class="ae jn" href="https://www.tensorflow.org/install/source_windows" rel="noopener ugc nofollow" target="_blank"><em class="lc"/></a><em class="lc"/>你将需要一个测试版的工具包。</li><li id="03c2" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">下载那个版本。您可以下载并安装多个版本。</li></ul><p id="23ad" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated">(我下载了v10.0和v 10.1-更新2)</p><p id="8fcb" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated">在安装cuda-toolkit之前，您还需要安装Visual Studio。安装<a class="ae jn" href="https://visualstudio.microsoft.com/vs/older-downloads/" rel="noopener ugc nofollow" target="_blank"> <em class="lc"> VS 2017 </em> </a>。安装Visual Studio之后，像其他任何正常安装一样安装cuda-toolkit。</p><h2 id="81ae" class="lj jp hi bd jq lk ll lm ju ln lo lp jy kp lq lr ka kt ls lt kc kx lu lv ke lw bi translated">第三步</h2><p id="6856" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">下载适合您的cuda版本的cudnn。你将需要一个开发者帐户来做到这一点。如果没有，请创建一个。可以从<a class="ae jn" href="https://developer.nvidia.com/rdp/cudnn-archive" rel="noopener ugc nofollow" target="_blank"> <em class="lc">这里</em> </a>下载。您将下载一个zip文件。如果您选择默认设置，您的cuda工具包将安装在下面的路径中。</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="e0a3" class="lj jp hi mm b fi mq mr l ms mt">C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.1</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mu"><img src="../Images/e849d8abf94c0c6318cd7226fbcd593d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ecJwP-oTdi9QRvRDTtDM0w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Cudnn</figcaption></figure><p id="b5af" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated">将cudnn zip中的文件复制到cuda-toolkit安装中相应的文件夹中。也就是说，</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="fcc8" class="lj jp hi mm b fi mq mr l ms mt">from the bin folder in your zip file to C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.1\bin\<br/>from the include folder in zip to C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.1\include\<br/>and<br/>from the lib\x64 to C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.1\lib\x64\</span></pre><h2 id="d7e8" class="lj jp hi bd jq lk ll lm ju ln lo lp jy kp lq lr ka kt ls lt kc kx lu lv ke lw bi translated">第四步</h2><p id="901f" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">将所有cuda-toolkit版本添加到path变量中。为此，请打开命令提示符并键入以下命令-</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="33ce" class="lj jp hi mm b fi mq mr l ms mt">SET PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.1\bin;%PATH%<br/>SET PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.1\extras\CUPTI\lib64;%PATH%<br/>SET PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.1\include;%PATH%</span></pre><p id="377d" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated">确保对所有已安装的版本都这样做。因此，在我的例子中，我也添加了下面的命令。</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="355e" class="lj jp hi mm b fi mq mr l ms mt">SET PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\bin;%PATH%<br/>SET PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\extras\CUPTI\lib64;%PATH%<br/>SET PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0\include;%PATH%</span></pre><h2 id="a22f" class="lj jp hi bd jq lk ll lm ju ln lo lp jy kp lq lr ka kt ls lt kc kx lu lv ke lw bi translated">第五步</h2><p id="0fae" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">现在是时候安装TensorFlow了。使用pip创建一个新环境并安装TensorFlow。我用pip是因为TensorFlow推荐，而conda只有2.1.0以上的版本，而pip有2.3.1。</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="c86d" class="lj jp hi mm b fi mq mr l ms mt">conda create --name env_name<br/>conda install python=3.7 -y<br/>pip install tensorflow-gpu==version*</span></pre><h2 id="ab6e" class="lj jp hi bd jq lk ll lm ju ln lo lp jy kp lq lr ka kt ls lt kc kx lu lv ke lw bi translated">就是这样。你可以走了。现在你可以在你的GPU上训练你的模型。</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ld"><img src="../Images/75a43917a84c246c13da47536a607d60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYNwZRmVQPdCGXNl6mfvJA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">TensorFlow使用GPU，手动安装cuda-toolkit和cudnn</figcaption></figure><p id="4029" class="pw-post-body-paragraph kg kh hi ki b kj le ij kl km lf im ko kp lg kr ks kt lh kv kw kx li kz la lb hb bi translated"><strong class="ki hj">奖励</strong>:你可以使用动态模式进行训练，也可以分配特定数量的GPU内存。您可以通过在脚本中添加以下几行来实现这一点。</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="f921" class="lj jp hi mm b fi mq mr l ms mt"># Dynamic memory by allowing memory growth<br/>physical_devices = tf.config.experimental.list_physical_devices('GPU')<br/>for physical_device in physical_devices:<br/>  tf.config.experimental.set_memory_growth(physical_device, True)</span><span id="5292" class="lj jp hi mm b fi mv mr l ms mt"># Static by allocating fixed amount of memory<br/>gpu_mem = 6<br/>gpus = tf.config.experimental.list_physical_devices('GPU')# The variable GB is the memory size you want to use.<br/>config = [tf.config.experimental.VirtualDeviceConfiguration(memory_limit=(1024 * gpu_mem))]<br/>if gpus:    # Restrict TensorFlow to only allocate 1*X GB of memory on the first GPU    <br/>  try:         <br/>    tf.config.experimental.set_virtual_device_configuration(gpus[0], config)        <br/>    logical_gpus = tf.config.experimental.list_logical_devices('GPU')         <br/>    print(len(gpus), "Physical GPUs,", len(logical_gpus), "Logical GPUs")    <br/>  except RuntimeError as e:        <br/>    # Virtual devices must be set before GPUs have been initialized           <br/>    print(e)</span></pre><h2 id="1b6e" class="lj jp hi bd jq lk ll lm ju ln lo lp jy kp lq lr ka kt ls lt kc kx lu lv ke lw bi translated">我希望这在某种程度上帮助了你。祝你训练模特愉快。</h2></div></div>    
</body>
</html>