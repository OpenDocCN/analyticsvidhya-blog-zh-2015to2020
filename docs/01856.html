<html>
<head>
<title>DecisionTree Classifier — Working on Moons Dataset using GridSearchCV to find best hyperparameters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">决策树分类器—使用GridSearchCV处理Moons数据集，以找到最佳超参数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/decisiontree-classifier-working-on-moons-dataset-using-gridsearchcv-to-find-best-hyperparameters-ede24a06b489?source=collection_archive---------4-----------------------#2019-11-18">https://medium.com/analytics-vidhya/decisiontree-classifier-working-on-moons-dataset-using-gridsearchcv-to-find-best-hyperparameters-ede24a06b489?source=collection_archive---------4-----------------------#2019-11-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ac20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">决策树是一种很好的分类方法，不像随机森林，它们是透明的或白盒分类器，这意味着我们可以找到决策树分类背后的逻辑。</p><p id="11b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还将向您展示一种从模型创建决策树的. png文件的快速方法，这将解释我所说的透明性，它看起来像这样(代码如下)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f81759c1b971c26e3f1538e05e937666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X39cP8Q6WIob0isi5rDvgw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">卫星数据集的决策树</figcaption></figure><p id="4769" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们是怎么做到的？</p><p id="e3b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们会谈到这一点，但首先让我们读一读我们的数据集。</p><div class="jt ju ez fb jv jw"><a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_moons.html" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">sk learn . datasets . make _ moons-sci kit-learn 0 . 21 . 3文档</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">将两个交错的半圆制作成一个简单的玩具数据集，以可视化聚类和分类算法。阅读…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">scikit-learn.org</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk jn jw"/></div></div></a></div><p id="9223" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将首先将数据集加载到对象中，然后将其拆分为训练数据集和测试数据集</p><pre class="je jf jg jh fd kl km kn ko aw kp bi"><span id="d7a1" class="kq kr hi km b fi ks kt l ku kv">from sklearn.datasets import make_moons</span><span id="47ca" class="kq kr hi km b fi kw kt l ku kv">dataset=make_moons(n_samples=10000, shuffle=True, noise=0.4, random_state=42)</span><span id="6779" class="kq kr hi km b fi kw kt l ku kv">X,y=dataset</span><span id="6047" class="kq kr hi km b fi kw kt l ku kv">X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=42)<br/></span></pre><p id="3015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将初始化我们的分类器和GridSearchCv，它是帮助我们找到最佳超参数的主要组件。</p><p id="78d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们简单地创建一个超参数的元组(一种非编辑列表),我们希望机器用它来测试，并把它们保存为参数。</p><p id="bbbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们将分类器和参数列表作为gridsearchcv的参数。</p><pre class="je jf jg jh fd kl km kn ko aw kp bi"><span id="171e" class="kq kr hi km b fi ks kt l ku kv">from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.model_selection import GridSearchCV</span><span id="9255" class="kq kr hi km b fi kw kt l ku kv">params = {'max_leaf_nodes': list(range(2, 100)), 'min_samples_split': [2, 3, 4]}<br/>grid_search_cv = GridSearchCV(DecisionTreeClassifier(random_state=42), params, verbose=1, cv=3)</span><span id="e933" class="kq kr hi km b fi kw kt l ku kv">grid_search_cv.fit(X_train, y_train)</span></pre><p id="aa2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们用训练数据拟合了网格搜索cv模型，我们将简单地问什么对你最有效，它会回答，类似于-</p><pre class="je jf jg jh fd kl km kn ko aw kp bi"><span id="cefe" class="kq kr hi km b fi ks kt l ku kv">grid_search_cv.best_estimator_</span></pre><p id="3382" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得到了一个答案，下面这些参数是这个算法的最佳超参数</p><pre class="je jf jg jh fd kl km kn ko aw kp bi"><span id="cfc3" class="kq kr hi km b fi ks kt l ku kv">GridSearchCV(cv=3, error_score='raise-deprecating',<br/>       estimator=DecisionTreeClassifier(class_weight=None, criterion='gini', max_depth=None,<br/>            max_features=None, max_leaf_nodes=None,<br/>            min_impurity_decrease=0.0, min_impurity_split=None,<br/>            min_samples_leaf=1, min_samples_split=2,<br/>            min_weight_fraction_leaf=0.0, presort=False, random_state=42,<br/>            splitter='best'),<br/>       fit_params=None, iid='warn', n_jobs=None,<br/>       param_grid={'max_leaf_nodes': [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99], 'min_samples_split': [2, 3, 4]},<br/>       pre_dispatch='2*n_jobs', refit=True, return_train_score='warn',<br/>       scoring=None, verbose=1)</span></pre><p id="b9e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在回到用这个模型制作一个树模型图像，简单地复制下面的代码-</p><pre class="je jf jg jh fd kl km kn ko aw kp bi"><span id="2e3f" class="kq kr hi km b fi ks kt l ku kv">from sklearn.tree import export_graphviz</span><span id="793a" class="kq kr hi km b fi kw kt l ku kv">export_graphviz( <br/> grid_search_cv.best_estimator_,<br/> out_file=(“moons_tree.dot”),<br/> feature_names=None,<br/> class_names=None,<br/> filled=True,<br/>)</span></pre><p id="ee3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你运行了这个，你的代码目录将显示moons_tree.dot为一个新文件，只需在终端中运行这个文件就可以把它转换成。png</p><pre class="je jf jg jh fd kl km kn ko aw kp bi"><span id="1adb" class="kq kr hi km b fi ks kt l ku kv">$ dot -Tpng moons_tree.dot -o moons.png</span></pre><p id="2040" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">瞧，你的文件夹里有一棵树，它解释了这个模型是如何工作的。</p><p id="3a5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是决策树的魅力所在，要查看我的代码，您可以访问&gt;</p><div class="jt ju ez fb jv jw"><a href="https://github.com/Madmanius/DecisionTreeClassifier_GridSearchCv" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">madmanius/decision tree classifier _ GridSearchCv</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">决策树是一种很好的分类方法，不像随机森林，它们是透明的或白盒…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">github.com</p></div></div><div class="kf l"><div class="kx l kh ki kj kf kk jn jw"/></div></div></a></div></div></div>    
</body>
</html>