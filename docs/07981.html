<html>
<head>
<title>Running Totals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">累计总数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/running-totals-59d6cc015195?source=collection_archive---------24-----------------------#2020-07-13">https://medium.com/analytics-vidhya/running-totals-59d6cc015195?source=collection_archive---------24-----------------------#2020-07-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/a825323e57f12ba96fe7e862b215305f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*5kgyspGNnAWtrAxrsLrpAg.jpeg"/></div></figure><p id="ea7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最初发布于:</p><div class="jk jl ez fb jm jn"><a href="https://www.vivran.in/post/running-totals" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">累计总数</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">计算一组数据的累计总数是数据分析师的常见要求之一。这篇文章…</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">www.vivran.in</p></div></div><div class="jw l"><div class="jx l jy jz ka jw kb ik jn"/></div></div></a></div><p id="878a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">计算一组数据的累计总数是数据分析师的常见要求之一。本文探讨了如何在Excel和Power BI中计算运行总数。</p><p id="95b6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当我们使用Excel表格和数据透视表时，获取运行总计是一项简单的任务</p><h1 id="112c" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用快速分析进行累计</h1><p id="fd78" class="pw-post-body-paragraph im in hi io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">请考虑下表:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/9f6c8f0788e239564da179208781be5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*S3V0HY4_nq0j0mZQIwiHbA.png"/></div></figure><p id="37b8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下载<a class="ae lk" href="https://vivranin-my.sharepoint.com/:x:/g/personal/vivek_ranjan_vivran_in/EVKB4jfTRINChkKk3j4akz0B1Yys0v7KpQQ8yUD-CDJJwg?e=gy5ICh" rel="noopener ugc nofollow" target="_blank">样本数据文件</a></p><p id="fc96" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">目标是在订单总数旁边添加一列，用于订单的运行总数</p><p id="aba6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">选择订单合计&gt; Ctrl + Q(快速分析) &gt;合计&gt;列的运行合计</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/7a0e9aa2331578aad371ec8adbf106d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*y8sGYW1dSOnlU9PJ9hDtMw.png"/></div></figure><p id="df9e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它添加了一个包含计算累计值的公式的列:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/448761a2798eb987abc24be031494e83.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*vT3-O6daoETmFAWwra3T2g.png"/></div></figure><h1 id="9915" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用枢轴的累计</h1><p id="ba66" class="pw-post-body-paragraph im in hi io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">将字段拖到值中:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/f8acf094125f710ed71e2bf95dac7916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-kAiNQyw8HeEwOHHiTM9Q.png"/></div></div></figure><p id="5fd9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本例中，我们在Value下拖动了Order Quantity字段两次</p><p id="bdd4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">右键单击包含订单值的任何单元格&gt;值字段设置:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/300aea17be3f45c1fb4d89f89f5a5bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*NhnIO53RQvdSsbX1BJKeEg.png"/></div></figure><p id="4a67" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在值字段设置选项&gt;显示值为&gt;运行总计中</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/e6406c1dab15fa7a928925c793977d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*dkqnRtODtqSr4TPEBa2JAg.png"/></div></figure><p id="5530" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">结果:包含累计计算的列:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/d659d644e53430f1de8a889650fcd834.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*JZGGJdGnh0Gzg6Hy_3pa4Q.png"/></div></figure><p id="a2ec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">查看以下关于pivots的文章:</p><p id="f59b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lk" href="https://www.vivran.in/post/5-useful-features-of-excel-pivot-tables" rel="noopener ugc nofollow" target="_blank">数据透视表的5个有用特性</a></p><p id="8390" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lk" href="https://www.vivran.in/post/do-more-with-pivot-tables-value-field-settings" rel="noopener ugc nofollow" target="_blank">用枢轴做更多事情</a></p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="3a4d" class="kc kd hi bd ke kf mc kh ki kj md kl km kn me kp kq kr mf kt ku kv mg kx ky kz bi translated">使用DAX度量</h1><p id="54ed" class="pw-post-body-paragraph im in hi io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">我们希望它能如此简单。如果我们了解DAX的几个基本概念，那么也不难。</p><p id="fea1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lk" href="https://vivranin-my.sharepoint.com/:u:/g/personal/vivek_ranjan_vivran_in/ETfujvS-KeZMr1_PrjDfWVsBEuKl7CGUfAHoMRsHn5AHSA?e=lvIp0g" rel="noopener ugc nofollow" target="_blank">下载样本文件</a></p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/8b32a37e1e604ee8095763cfe4826c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*qvohGYOyJNVMaRk8HoBD5Q.png"/></div></figure><p id="2009" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为此，我们创建了以下DAX衡量标准:</p><pre class="lg lh li lj fd mi mj mk ml aw mm bi"><span id="bb53" class="mn kd hi mj b fi mo mp l mq mr">Total Orders = SUM(dtOrders[Order Quantity])<br/>  <br/>  <br/> Running Total (Prod Sub Cat) = <br/> <br/> //defining the subcategory selected in the visual<br/> VAR _SubCat = SELECTEDVALUE(dtOrders[Product Sub-Category])<br/>  <br/> //filtering the table as per the visual selected. <br/> VAR _Filter = <br/>  FILTER(<br/>    ALLSELECTED(dtOrders[Product Sub-Category]),<br/>     dtOrders[Product Sub-Category] &lt;= _SubCat<br/>  )<br/>  <br/> //calculating the running total<br/> VAR _RT = <br/>  CALCULATE(<br/>    [Total Orders],<br/>      _Filter<br/>  )<br/>  <br/> RETURN<br/> _RT</span></pre><p id="34e3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上述DAX衡量标准为:</p><p id="a497" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先识别过滤器上下文中的当前产品子类别</p><p id="0927" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">_Filter变量返回一个包含按字母顺序排序的产品子类别的列表，包括当前产品子类别。例如，对于产品子类别书架，它返回一个表:器具、活页夹和活页夹附件以及书架。</p><p id="e3bd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">计算上一步中返回的产品子类别的订单总数。</p><p id="a7a7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要根据订单总数而不是产品子类别来计算累计，请将产品子类别替换为订单总数DAX度量:</p><pre class="lg lh li lj fd mi mj mk ml aw mm bi"><span id="9009" class="mn kd hi mj b fi mo mp l mq mr">Running Total (Total Orders) = <br/> VAR _CurrentOrder = [Total Orders]<br/>  <br/> VAR _Filter = <br/>  FILTER(<br/>    ALLSELECTED(dtOrders[Product Sub-Category]),<br/>     [Total Orders] &gt;= _CurrentOrder<br/>  )<br/>  <br/> VAR _RT = <br/>  CALCULATE(<br/>    [Total Orders],<br/>      _Filter<br/>  )<br/>  <br/> RETURN<br/> _RT</span></pre><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/05150234cf72fe5559d6f8a3f7148721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*lNEupCfotFzknRYAbI0nxA.png"/></div></figure><p id="71d0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你可以参考下面这篇关于如何使用DAX计算日期的累计的文章</p><p id="b972" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lk" href="https://www.vivran.in/post/dax-time-intelligence-part-2-till-date-aggregations" rel="noopener ugc nofollow" target="_blank"> DAX时间智能:截止日期汇总</a></p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><p id="2435" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="mt">我写关于</em><a class="ae lk" href="https://www.vivran.in/my-blog/categories/excel" rel="noopener ugc nofollow" target="_blank"><em class="mt">MS Excel</em></a><em class="mt"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/powerquery" rel="noopener ugc nofollow" target="_blank"><em class="mt">权力查询</em></a><em class="mt"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/powerbi" rel="noopener ugc nofollow" target="_blank"><em class="mt">权力毕</em></a><em class="mt"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/power-pivot" rel="noopener ugc nofollow" target="_blank"><em class="mt">权力中枢</em></a><em class="mt"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/dax" rel="noopener ugc nofollow" target="_blank"><em class="mt">DAX</em></a><em class="mt"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/data-analytics" rel="noopener ugc nofollow" target="_blank"><em class="mt">数据分析【数据</em></a></p><p id="4df7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lk" href="https://twitter.com/imvivran" rel="noopener ugc nofollow" target="_blank"> @imVivRan </a></p></div></div>    
</body>
</html>