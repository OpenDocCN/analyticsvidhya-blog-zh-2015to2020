<html>
<head>
<title>ETL through multiple pages of a website in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Power BI中通过网站的多个页面进行ETL</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/etl-by-looping-through-a-website-in-power-bi-a0553dcfe353?source=collection_archive---------27-----------------------#2020-03-03">https://medium.com/analytics-vidhya/etl-by-looping-through-a-website-in-power-bi-a0553dcfe353?source=collection_archive---------27-----------------------#2020-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/5a37bb28ae3b10066ebc411659206ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2y7jPirLNtPHduWzlgphQ.jpeg"/></div></div></figure><div class=""/><p id="4e73" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将通过一个例子来执行ETL(提取、转换、加载)功能，方法是在一个网站的多个页面之间循环。</p><p id="3b92" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们将使用一个名为planecrashinfo.com的网站，该网站拥有自1920年以来所有飞机失事的历史数据。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jo"><img src="../Images/30aa0d961943440dde3a3a8e9b70b183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uCyVfw8Ah3pYrngKjRm73g.png"/></div></div></figure><p id="3c34" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们将随机打开其中一个页面，并在Power BI中提取该网页的数据，在本例中，我选择1922</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jo"><img src="../Images/0d34429502dd14524701b66300fa6a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JPhG-n9WllXjTMJJ9tNLQ.png"/></div></div></figure><p id="c33b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是打开Power BI Desktop并加载它(见下图)</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jt"><img src="../Images/d0a19615a1b49fc168ad3c8ff5540d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0hBRYajSvz6Zl4fDta26EQ.gif"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">在Power BI桌面中获取数据</figcaption></figure><p id="2ea7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步，我们将对这些数据进行一些转换，</p><ul class=""><li id="8caf" class="jy jz ht is b it iu ix iy jb ka jf kb jj kc jn kd ke kf kg bi translated">用换行符[#(cr)]将位置/操作符拆分成两列，即位置和操作符。</li><li id="41c2" class="jy jz ht is b it kh ix ki jb kj jf kk jj kl jn kd ke kf kg bi translated">用换行符[#(cr)]将飞机类型/注册拆分成两列，即位置和运营商。</li><li id="a8cd" class="jy jz ht is b it kh ix ki jb kj jf kk jj kl jn kd ke kf kg bi translated">用/和(将死亡人数列分成三列，即空中死亡人数、空中死亡人数和地面死亡人数。</li></ul><p id="9dee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是定义参数，我们可以使用查询编辑器中的<strong class="is hu">管理参数</strong>选项来定义参数，但是，这里我们将使用高级编辑器并使用M代码来定义我们的参数。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jt"><img src="../Images/15a3b06ddc0c5982f0fa5266fb9e605a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*RGBIwE7k-SK2lzL9zNJX-g.gif"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">使用高级编辑器传递参数</figcaption></figure><p id="446e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了测试这一点，我们可以触发AircraftEvents函数并手动输入一些年份，这将在查询编辑器中创建一个包含该特定年份数据的表</p><p id="9d04" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，由于我们需要该网站上所有年份的数据，我们将从该网站上导入年份列表，删除不需要的列，并将多个列拆分为一列，将其重命名为“year”</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jt"><img src="../Images/64430509249fa4ac9f5a88e95f01a769.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LLTH5KKCqF_QpWvq6qwXRQ.gif"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">从网站提取年份列表</figcaption></figure><p id="1195" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们有两个查询，第一个是AircraftEvents，这是一个功能查询，第二个是网站上所有年份的列表。我们需要找到一种方法将年份列表传递给AircraftEvents函数。</p><p id="98ae" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们将在Year_List查询中添加一个自定义列，并使用参数[Year]调用函数AircraftEvents，其中[Year]是Year_List表中列的名称。</p><p id="fb2a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">=飞机事件([年份])</p><p id="43fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将为我们提供一个包含许多表的自定义列，每年一个表，一旦我们扩展该表，我们将得到一个合并的数据表，其中包含所有年份的飞机失事数据。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jt"><img src="../Images/02d57f0d2d97c9b31844919358341c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*elcZ3q0PVucn8q1B7Ex_tg.gif"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">调用Year_List表中的AircraftEvents表</figcaption></figure><p id="8d3b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您的数据集已经准备好，可以进行很酷的可视化了。在下一篇文章中，我将分享我的PowerBI仪表板视觉效果。</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><p id="882d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">照片由<a class="ae kt" href="https://www.pexels.com/@wdnet?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> PhotoMIX有限公司</a>从<a class="ae kt" href="https://www.pexels.com/photo/black-samsung-tablet-computer-106344/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>拍摄</p><p id="85b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">文章转载自<a class="ae kt" href="https://www.youtube.com/redirect?q=http%3A%2F%2Fblog.pragmaticworks.com%2Ftopic%2Fpower-bi&amp;redir_token=Au3RwWxmBCtmqBTFzLZkfMa5nwZ8MTU4MzMxOTA5MUAxNTgzMjMyNjkx&amp;v=-rQhqKZM0OM&amp;event=video_description" rel="noopener ugc nofollow" target="_blank">http://blog.pragmaticworks.com/topic/</a></p></div></div>    
</body>
</html>