<html>
<head>
<title>Neural Collaborative Filtering for Drug prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于药物预测的神经协同过滤</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/neural-collaborative-filtering-for-drug-prediction-e8d0c552317b?source=collection_archive---------9-----------------------#2020-06-09">https://medium.com/analytics-vidhya/neural-collaborative-filtering-for-drug-prediction-e8d0c552317b?source=collection_archive---------9-----------------------#2020-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="5ef9" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">用多层感知器模型预测药物</p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/a6bfb1d7b6d2c255e5678671b81d8fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tyV5hx3AmVxqAyC1tBZ1wQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">神经协同过滤研究论文[1]</figcaption></figure><p id="1032" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi ka translated">机器学习可以用于人类生活的各个方面。</p><p id="65ae" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">药物检测的思想类似于推荐系统的思想，在推荐系统中，基于某些因素将项目推荐给用户。</p><p id="ff41" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">同样，我们可以根据某些因素推荐该药物用于治疗某些医疗状况。</p><p id="0d33" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">为了做到这一点，我们在这里使用神经协同过滤方法来预测特定医疗条件下的药物。我们将使用在<strong class="il hj"> <em class="ik">研究论文【1】</em></strong>中提出的多层感知器模型</p><p id="92af" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">我们已经做了某些<strong class="il hj">修改</strong>来匹配当前的需求。</p><p id="c573" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">有了这个项目，我们将能够做到以下几点:</p><blockquote class="if ig ih"><p id="324f" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">给定一种医疗状况，以建议用于治疗该医疗状况的适当药物(在此解释)</p><p id="2e83" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">给出一种药物，以找到该药物可以帮助的医学状况(可以通过将同一项目中的(药物，状况)改为(状况，药物)来完成)</p></blockquote><p id="66d9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">现在我们开始吧</p><h1 id="bf77" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">导入必要的库</h1><blockquote class="if ig ih"><p id="1612" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">完整的神经网络模型是基于Keras API开发的</p></blockquote><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><h1 id="e77e" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">资料组</h1><blockquote class="if ig ih"><p id="89fc" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">了解数据集</p></blockquote><p id="8dca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">我们使用的是drug_com数据集，你可以从Kaggle <strong class="il hj"> </strong> <a class="ae lj" href="https://www.kaggle.com/jessicali9530/kuc-hackathon-winter-2018" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj">这里</strong> </a>下载</p><p id="82ae" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">该数据集包括不同的药物及其在不同医疗条件下的有效性/用途。</p><p id="2c0c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">现在，让我们分析数据集，以了解数据。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lk"><img src="../Images/39b22e5d86ddf41d151bc8f3994125b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzl3ioDgRYQTMFvvUONF3g.png"/></div></div></figure><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><blockquote class="ll"><p id="be95" class="lm ln hi bd lo lp lq lr ls lt lu jg dx">3436</p><p id="1e15" class="lm ln hi bd lo lp lv lw lx ly lz jg dx">885</p></blockquote><p id="e23b" class="pw-post-body-paragraph ii ij hi il b im ma io ip iq mb is it jx mc iw ix jy md ja jb jz me je jf jg hb bi translated">我们的数据集包含药品名称和各自的医疗状况，以及所有其他信息，如综述、评级、有用计数…</p><p id="4204" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">现在，我们希望发现特定药物在不同条件下的有效性(例如，预测药物在特定条件下的有效性)</p><p id="e642" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">这里我们可以看到，我们有3436种独特的药物，885种独特的条件，以及161297种积极的相互作用，我们可以将所有其他相互作用(即3436*885 - 161297)视为消极的相互作用</p><h1 id="1d59" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">将药品名称映射到唯一id，并将唯一id映射到药品名称</h1><blockquote class="if ig ih"><p id="d1d9" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">让数据准备好工作</p></blockquote><p id="70ed" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">删除字符串数据可能会很复杂，所以我们将字符串值映射到可用的整数(只需获取索引值)</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="f368" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">我们可以使用任何一列来表示药品名称和医疗状况之间的相互作用。(即使我们现在不使用任何它的罚款)</p><p id="d837" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">这里我们用有用的计数作为药物和特定医疗条件之间的相互作用</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mf"><img src="../Images/f438388af9b67a526cf396f51d3579cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZzwSRPBIQeb9j2c-UC_Sg.png"/></div></div></figure><p id="4fef" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">绘图</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mg"><img src="../Images/33192febb1d6620272ef4020b19c2e86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*FMERzNFas7GlaParc7dp2A.png"/></div></figure><p id="d43e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">由于这是一个二元分类问题，我们不考虑药物的性质(可以在下一部分完成)</p><p id="7571" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">我们将构建稀疏矩阵来表示药物和医疗条件之间的相互作用</p><p id="07ca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">为了进行测试，我们选取了200名用户及其积极和消极的交互(请查看参考研究论文[1]中的“负采样的对数损失”部分，以了解关于消极交互和评估过程的开始)</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><h1 id="9519" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">评估流程</h1><blockquote class="if ig ih"><p id="6974" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">药品推荐的绩效</p></blockquote><p id="9331" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">为了评估药物推荐的性能，我们采用了留一法评估。如<strong class="il hj">所述<em class="ik">所指</em>研究论文</strong></p><p id="e683" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated"><strong class="il hj">HR</strong>→命中率</p><p id="e311" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated"><strong class="il hj">NDCG</strong>→归一化贴现累计收益</p><p id="1663" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">人力资源直观地衡量测试项目是否出现在前5名的列表中，NDCG通过给排名靠前的命中项目分配较高的分数来说明命中项目的位置。我们将计算每个测试用户的两个指标，并分配平均分。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><h1 id="8c72" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">准备模型</h1><blockquote class="if ig ih"><p id="3070" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">多层预置</strong>:(如<strong class="il hj"> <em class="hi">引用研究论文【1】</em></strong>所述)</p></blockquote><p id="f008" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">由于NCF采用两种途径来模拟药物和条件，所以通过连接它们来组合两种途径的特征是直观的。这种设计在多模态深度学习作品中被广泛采用。然而，简单的向量连接并不考虑药物和条件潜在特征之间的任何相互作用，这不足以对协同过滤效果进行建模。我们将在连接向量上添加隐藏层来解决这个问题，使用标准MLP来学习药物和条件潜在特征之间的相互作用。从这个意义上说，我们可以赋予模型很大程度的<strong class="il hj">灵活性和非线性。</strong></p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><h1 id="10f3" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">培训测试和评估:</h1><blockquote class="if ig ih"><p id="61bd" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">培训和评估MLP模型</p></blockquote><p id="4f3f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">神经网络体系结构将具有6个隐藏层，其中一个是输入层(通过串联药物和条件嵌入形成),另一个是输出层</p><p id="b2dc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">优化器、学习速率、批量大小、时期……都是在做了一些实验后决定的，并为这项工作选择了最佳的。</p><p id="b431" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">该过程包括:</p><ol class=""><li id="a7f9" class="mh mi hi il b im in iq ir jx mj jy mk jz ml jg mm mn mo mp bi translated">创建模型</li><li id="dd72" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mm mn mo mp bi translated">火车模型</li><li id="488b" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mm mn mo mp bi translated">测试/评估模型</li><li id="f308" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mm mn mo mp bi translated">计算HR，NDCG</li><li id="ab11" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mm mn mo mp bi translated">检查最佳人力资源，NDCG和保存模型</li><li id="9f9a" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mm mn mo mp bi translated">对“纪元”时间重复步骤3、4和5</li></ol><p id="50d1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">这将保存最好的模型</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mv"><img src="../Images/8f60561c7ef4d5591fe0a8564da64914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uIDC9SKCKDmfkznRNZA_Qw.png"/></div></div></figure><p id="0e41" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">宾果我们得到了一个非常好的命中率(1.00)和标准化折扣累积收益(0.99)，损失高达0.02</p><p id="cc59" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">尽管我们的性能很好，但现实世界中的模型预测可能没有那么高，但这仍然是一个好结果！！</p><p id="0c7d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">现在让我们试着找出治疗风湿性关节炎的可能药物</p><p id="bc31" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">类风湿性关节炎(RA) →一种自身免疫性疾病，可导致关节痛和全身损伤</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lh li l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mw"><img src="../Images/6e60e0ceb13f7e3c0221b1773df486a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WcDQuXv974VxcQLcTSHwFA.png"/></div></div></figure><h1 id="ac0e" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">结论:</h1><blockquote class="if ig ih"><p id="d0ea" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">解决模型性能问题</p></blockquote><p id="05c9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">该模型预测了一些正确的药物，如:</p><ul class=""><li id="358f" class="mh mi hi il b im in iq ir jx mj jy mk jz ml jg mx mn mo mp bi translated"><strong class="il hj">羟氯喹</strong></li></ul><p id="6c37" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">并且还提出了治疗类风湿性关节炎的可能药物</p><ul class=""><li id="3a32" class="mh mi hi il b im in iq ir jx mj jy mk jz ml jg mx mn mo mp bi translated">依那西普</li><li id="9d33" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mx mn mo mp bi translated">对乙酰氨基酚/氢可酮</li><li id="0129" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mx mn mo mp bi translated">萘普生</li><li id="32ae" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mx mn mo mp bi translated">阿列夫</li></ul><p id="3318" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">虽然这些药物的作用只能由在这些领域工作的科学家来证实。</p><p id="04bc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">该模型的预测可能不是10/10，但我们甚至可以通过做某些修改和大量研究来实现。</p><h1 id="5119" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak"> <em class="my">修改</em> </strong>:</h1><blockquote class="if ig ih"><p id="bef3" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">让模型更好地工作</p></blockquote><p id="35d8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">这是药物预测的基本模型</p><p id="43a0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">可以通过修改来学习一些更复杂的关系</p><ul class=""><li id="a7e8" class="mh mi hi il b im in iq ir jx mj jy mk jz ml jg mx mn mo mp bi translated">我们可以考虑药物的特性(如蛋白质结构、在不同环境中的活性……)</li><li id="6a7d" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mx mn mo mp bi translated">大型数据集也有助于增加可能性的范围，并能带来更好的预测</li><li id="b9ee" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mx mn mo mp bi translated">使用更深的神经网络结构</li><li id="7ee1" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mx mn mo mp bi translated">微调超参数</li><li id="00a4" class="mh mi hi il b im mq iq mr jx ms jy mt jz mu jg mx mn mo mp bi">…</li></ul><p id="7c39" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">在第二部分，我们将尝试创建这样一个模型，并为新冠肺炎找到可能性……:)</p><h1 id="da25" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">谢谢你…</h1><p id="e4e4" class="pw-post-body-paragraph ii ij hi il b im mz io ip iq na is it jx nb iw ix jy nc ja jb jz nd je jf jg hb bi translated"><strong class="il hj">Github:</strong><a class="ae lj" href="https://github.com/mankar1257/Drug-Prediction-using-neural-collaborative-filtering" rel="noopener ugc nofollow" target="_blank">https://Github . com/mankar 1257/Drug-Prediction-using-neural-collaborative-filtering</a></p><p id="28e9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated"><strong class="il hj">卡格尔:</strong></p><p id="de69" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jx iv iw ix jy iz ja jb jz jd je jf jg hb bi translated">https://www.kaggle.com/vaibhavmankar/kernel484ca8db6 b</p><h1 id="5690" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">参考资料:</h1><p id="987f" class="pw-post-body-paragraph ii ij hi il b im mz io ip iq na is it jx nb iw ix jy nc ja jb jz nd je jf jg hb bi translated">[1]何湘南，廖，张汉旺，，聂，，蔡达生(2017)。神经协同过滤。澳大利亚珀斯WWW '17会议录，2017年4月3日至7日。</p></div></div>    
</body>
</html>