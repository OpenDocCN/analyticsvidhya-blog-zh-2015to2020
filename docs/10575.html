<html>
<head>
<title>Step by Step guide to add friends with Django</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与 Django 添加好友的分步指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/add-friends-with-689a2fa4e41d?source=collection_archive---------1-----------------------#2020-10-25">https://medium.com/analytics-vidhya/add-friends-with-689a2fa4e41d?source=collection_archive---------1-----------------------#2020-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b6e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想在你的 Django 网站上拥有<strong class="ih hj"> <em class="jd">添加好友、发送好友请求、接受好友请求</em> </strong>功能吗？那么请阅读这篇文章:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/fce6fd493655273ffee79829a6252d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*h_mS-rH1Vbdgk-5Sjqyn8g.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">在 Django 添加朋友非常简单</figcaption></figure><h1 id="2c43" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">步骤 1:拥有某种配置文件模型或定制用户</h1><p id="4e16" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">为什么我们需要自定义用户模型或概要文件模型？这个配置文件模型或自定义用户模型将有一个朋友字段，我们将存储一个特定用户的所有朋友</p><p id="05fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用的是<strong class="ih hj">定制用户模型</strong>，它有一个<em class="jd">ManyToManyField</em><strong class="ih hj">friends</strong>引用回这个<strong class="ih hj">用户</strong>模型。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/58f855fda0badc92979d0fa7d8630e7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJoNIR5Ci4ZaQc8gcOvmqw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">这里最重要的是朋友字段</figcaption></figure><h1 id="7102" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">步骤 2:创建朋友请求模型</h1><p id="e422" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">这个朋友请求模型将存储朋友请求信息，即谁向谁发送请求。</p><p id="c348" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个朋友请求模型将有两个字段:</p><ul class=""><li id="c83a" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated"><strong class="ih hj">来自用户</strong>:它将与发送该请求的用户(<em class="jd">第一用户</em> ) <strong class="ih hj">有一个<em class="jd">外键</em>关系，</strong></li><li id="90c5" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><strong class="ih hj">到用户</strong>:它还将与另一个用户<em class="jd">第二个用户</em> ) <strong class="ih hj">有一个<em class="jd">外键</em>关系，第一个用户向其发送请求</strong>。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lm"><img src="../Images/7147cc4b161da59c16e5f748e0dd71b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oNcb2Nm9XOxu0bIvObyKCg.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">朋友请求模型</figcaption></figure><p id="112c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">确保字段有相关名称，并且它们有不同的名称。</strong></p><h2 id="2376" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">然后迁移模型。</h2><blockquote class="mb mc md"><p id="0fe3" class="if ig jd ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated"><strong class="ih hj">认证用户(可选)</strong></p><p id="7f68" class="if ig jd ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated">如果你从零开始学习本教程，或者你还没有设置你的认证系统，那么你也可以按照这些步骤来做。</p><p id="4d01" class="if ig jd ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated"><strong class="ih hj">我把下面那些步骤都挪了！</strong></p></blockquote><h1 id="bf56" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">步骤 3:为好友请求创建视图</h1><h2 id="fff2" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">1.发送好友请求</h2><ul class=""><li id="53f4" class="ky kz hi ih b ii ko im kp iq mh iu mi iy mj jc ld le lf lg bi translated">我们得到用户 id <strong class="ih hj">，我们将向其发送好友请求</strong></li><li id="5fb7" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">创建一个新的朋友请求实例，其中我们将请求将被发送到的用户设置为 _user = <strong class="ih hj">，</strong></li><li id="46a9" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">from_user 将是发送请求<em class="jd">的<strong class="ih hj">用户，即</strong></em>请求用户或当前用户</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mk"><img src="../Images/3a27fa789009db1f76f22f6aa7abcd2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ik0niLeYnzvSLH6AGBCTmw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">发送好友请求视图</figcaption></figure><h2 id="71b5" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">2.接受好友请求</h2><ul class=""><li id="e4a7" class="ky kz hi ih b ii ko im kp iq mh iu mi iy mj jc ld le lf lg bi translated">我们得到我们将要接受的请求的请求 id</li><li id="9f76" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">我们还确保请求的<strong class="ih hj"> to_user </strong>是当前用户<em class="jd">即</em> <strong class="ih hj">发送请求的用户</strong>是接受请求的当前用户，</li><li id="8225" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">然后我们将当前用户添加到<strong class="ih hj"><em class="jd">from _ user’</em></strong>s(<strong class="ih hj">发送</strong> <strong class="ih hj">请求的用户</strong>)好友字段</li><li id="088a" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">我们还将 from_user 添加到当前用户的朋友字段中</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ml"><img src="../Images/d952d79c41c0ddbe808a597c111ea377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ermZFAOTc__sBy-7k6hXfA.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">接受好友请求</figcaption></figure><h1 id="113f" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">步骤 4:创建 URL</h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mm"><img src="../Images/af13ade0eb4b3c2e07df2f4e320bdc14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRZWoHVE_1aRzlNRDVsTJA.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">发送和接收视图的 URL</figcaption></figure><h1 id="c170" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">第五步:模板</h1><ol class=""><li id="c7c8" class="ky kz hi ih b ii ko im kp iq mh iu mi iy mj jc mn le lf lg bi translated">我在一个列表中显示所有用户，每个用户都有一个<em class="jd"> href </em>，当点击它时<strong class="ih hj">会向该用户发送一个好友请求。</strong></li></ol><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mo"><img src="../Images/1d8dd73f2e0ed03982b762761cd1b412.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MnACWg_FagaSJNdkalC3Aw.png"/></div></div></figure><p id="0a39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.我在这里显示了发送给当前用户的所有好友请求，当前用户有一个<em class="jd"> href </em>，点击后<strong class="ih hj">将接受好友请求</strong>，两个用户都将成为<strong class="ih hj">好友。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mp"><img src="../Images/656de06ee4718cc65b3f77650059c010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bp08r-xlQxzoxWdaIXdkfw.png"/></div></div></figure><h1 id="7ed6" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">就是这样！我们到此为止。</strong></h1></div><div class="ab cl mq mr gp ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="hb hc hd he hf"><h1 id="21bc" class="jq jr hi bd js jt mx jv jw jx my jz ka kb mz kd ke kf na kh ki kj nb kl km kn bi translated">步骤 3 之前的可选步骤:验证用户</h1><blockquote class="mb mc md"><p id="df88" class="if ig jd ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated">在 settings.py 中添加 AUTH_USER_MODEL</p><p id="a310" class="if ig jd ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated">此处<strong class="ih hj">为<em class="hi">用户。用户</em> </strong>是指<strong class="ih hj"> <em class="hi">用户</em> </strong> app 中的<strong class="ih hj"> <em class="hi">用户</em> </strong>模型</p></blockquote><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es nc"><img src="../Images/7e0a70d4251e093834bfae2688d43150.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*nLlHORjL3U7eK8JqNp8BEQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">在 settings.py 中</figcaption></figure><h2 id="d8c7" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">1.创建用户表单:</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es nd"><img src="../Images/9130b54b6fd519268f26b350a404a644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHULeBdr_Yh9D3Ab6KMqLA.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">注册的用户创建表单</figcaption></figure><h2 id="108e" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">2.创建注册视图:</h2><p id="7c44" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">将这些导入 views.py</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ne"><img src="../Images/66d967d8ac11e5b16d020bc976728c3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BERfK8Ib39wlVnn7HeVCxQ.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">必要的进口</figcaption></figure><p id="1ab2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后创建注册视图:<em class="jd">(非常基本的认证)</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es nf"><img src="../Images/88ee701bec7de33020d80f003aba3aa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CAdUtUpy88p84zQxeev1UA.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">注册视图(忽略打印声明)</figcaption></figure><h2 id="9c01" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">3.创建登录视图</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ng"><img src="../Images/46806aeed91791a9586437670a617096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3QzAUb2zVdX0iuSGqxFQag.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">登录视图</figcaption></figure><h2 id="05c9" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">4.创建 URL</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es nh"><img src="../Images/4cf1170a358e37b7eb884f67ed0a6ad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gyffoCeWYRQdNp_j7ruVgg.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">urls.py</figcaption></figure><h2 id="7d1f" class="ln jr hi bd js lo lp lq jw lr ls lt ka iq lu lv ke iu lw lx ki iy ly lz km ma bi translated">5.HTML 模板</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ni"><img src="../Images/a583602a13621bf24425d4c04c700f3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*hn5o_LAymVJ8PnZicEGj7A.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">Homepage.html</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es nj"><img src="../Images/8ae10020b3ee3ef4a42a080c860a77dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ttO1-l01OjNQHKk5fEavsQ.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">login.html</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es nk"><img src="../Images/b1e3130db515b5defdcff6541b666268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*20HARZLvm8Nr1Y3QfpiL3Q.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">Signup.html</figcaption></figure></div><div class="ab cl mq mr gp ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="hb hc hd he hf"><h1 id="aed4" class="jq jr hi bd js jt mx jv jw jx my jz ka kb mz kd ke kf na kh ki kj nb kl km kn bi translated">希望这有所帮助🎉</h1></div></div>    
</body>
</html>