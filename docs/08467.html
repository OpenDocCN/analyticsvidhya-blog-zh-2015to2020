<html>
<head>
<title>Hello World of Machine Learning using TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用张量流的机器学习的 Hello World</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hello-world-of-machine-learning-using-tensorflow-fee1318776fe?source=collection_archive---------24-----------------------#2020-07-30">https://medium.com/analytics-vidhya/hello-world-of-machine-learning-using-tensorflow-fee1318776fe?source=collection_archive---------24-----------------------#2020-07-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e684" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们学习机器学习中最基本的‘Hello World’。我们将使用<strong class="ih hj"> TensorFlow </strong>，一个部署在谷歌云平台上的端到端开源机器学习平台。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/cf630b943b0f6cabdd9181113c706152.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*oIpV4FRTxhpMb4VFqbYEbQ.png"/></div></figure><p id="85da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">机器学习的基础观点</strong>。</p><p id="8a9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑以传统方式构建应用程序，如下图所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/507c666e8b46ff3b4e0d53e210178e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q0dfTrpvIZoWopmV.png"/></div></div></figure><p id="6381" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你用编程语言表达<strong class="ih hj">规则</strong>。这些作用于<strong class="ih hj">数据</strong>，你的程序提供<strong class="ih hj">答案</strong>。在活动检测的情况下，规则(您编写的定义活动类型的代码)对数据(人的移动速度)进行操作，以便找到答案——从用于确定用户活动状态(他们是步行、跑步、骑自行车等)的函数返回的值。).通过机器学习检测这种活动状态的过程非常相似，只是轴不同:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/64a5b24db06f4b487b8875d03f09f8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BFEgDPQoo_xhcZ6c.png"/></div></div></figure><p id="47d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不是试图定义规则并用编程语言表达它们，而是提供答案(通常称为标签)和数据，然后机器推断出确定答案和数据之间关系的规则。例如，在机器学习环境中，活动检测场景可能如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/9e6ca755e5e6538ec53abd7914889882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6pfQPpOjQrRuuPtu.png"/></div></div></figure><p id="c26c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你收集了大量的数据，并给它们贴上标签，有效地说明“这就是走路的样子”，“这就是跑步的样子”等等。然后，计算机可以从数据中推断出决定表示特定活动的不同模式的规则。</p><p id="6c6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了作为编程这种场景的替代方法，这还使您能够开辟新的场景，例如在基于规则的传统编程方法下可能无法实现的高尔夫场景。</p><p id="1cfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在传统编程中，你的代码被编译成一个二进制文件，这个二进制文件通常被称为<strong class="ih hj">程序</strong>。在机器学习中，你从数据和标签中创建的项目被称为<strong class="ih hj">模型</strong>。</p><p id="2b07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将此结果视为一个模型，它在运行时的用法如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/ec96cbd8502f4934346dc0e74d672d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9S5O4Yxt8SEhQU63.png"/></div></div></figure><p id="b00a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您向模型传递一些数据，模型使用它从训练中推断出的规则来做出预测，即“这些数据看起来像走路”、“这些数据看起来像骑自行车”等。</p><p id="9447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们建立一个非常简单的“Hello World”模型，它具有可以在任何机器学习场景中使用的大多数构件。我们将执行以下操作。</p><ul class=""><li id="2fc1" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">在 google 云平台上创建虚拟机，设置 Python 开发环境</li><li id="e818" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">为机器学习模型创建脚本</li><li id="b147" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">训练你的神经网络</li><li id="dd4a" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">测试您的模型</li></ul><p id="059a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转到谷歌云平台控制台</p><p id="2b69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置虚拟机以执行实验任务。</p><ol class=""><li id="35b7" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc ke jw jx jy bi translated">选择<strong class="ih hj">导航菜单</strong> &gt; <strong class="ih hj">计算引擎</strong>，然后点击<strong class="ih hj">虚拟机实例</strong>。</li><li id="6901" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc ke jw jx jy bi translated">在<strong class="ih hj">创建名为<strong class="ih hj"> mllearn </strong>的实例</strong>对话框中，在右窗格中，将<em class="kf">机床类型</em>设置为<strong class="ih hj"> n1-standard1 </strong>。将所有其他字段保留为默认值。</li><li id="62ae" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc ke jw jx jy bi translated">点击<strong class="ih hj">创建</strong>。</li></ol><p id="45ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您的新虚拟机列在虚拟机实例列表中，您会看到一个绿色复选标记，表示您的虚拟机已成功创建。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/c435a9814b3b14ce6d5af74c572b2718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Mhq4NUJGD_oTsc0P.jpg"/></div></div></figure><p id="a322" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击新虚拟机实例右侧的<strong class="ih hj"> SSH </strong>，通过 SSH 连接到虚拟机的控制台。</p><h1 id="465f" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">在系统上安装 Python 开发环境</h1><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="6b09" class="lj kh hi lf b fi lk ll l lm ln">python3 --version pip3 --version virtualenv --version</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lo"><img src="../Images/ca1e6e66395649a2d1de088f28acf153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n5v-7N3hILG56hDR.jpg"/></div></div></figure><p id="1e22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出显示 Python 3.5.3 已经在环境中，但是没有<a class="ae lp" href="https://pip.pypa.io/en/stable/installing/" rel="noopener ugc nofollow" target="_blank"> pip 包管理器</a>和<a class="ae lp" href="https://virtualenv.pypa.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> Virtualenv </a>。</p><p id="48e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.安装 pip 软件包管理器和 Virtualenv:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="40e0" class="lj kh hi lf b fi lk ll l lm ln">sudo apt update</span><span id="b797" class="lj kh hi lf b fi lq ll l lm ln">sudo apt install python3-pip -y</span><span id="64ab" class="lj kh hi lf b fi lq ll l lm ln">sudo pip3 install -U virtualenv # system-wide install</span></pre><p id="08e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.确认安装了 pip 软件包管理器和 Virtualenv:</p><p id="b253" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">创建虚拟环境</strong></p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="9611" class="lj kh hi lf b fi lk ll l lm ln">virtualenv --system-site-packages -p python3 ./venv</span></pre><p id="657e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.激活虚拟环境:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="d551" class="lj kh hi lf b fi lk ll l lm ln">source ./venv/bin/activate (venv) student-02-f4b8fb7e3cd3@mllearn:~$</span></pre><p id="183b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.升级<code class="du lr ls lt lf b">pip</code>以在虚拟环境中安装软件包，而不影响主机系统设置。</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="4531" class="lj kh hi lf b fi lk ll l lm ln">pip install --upgrade pip</span></pre><p id="dbe7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.查看虚拟环境中安装的包</p><p id="6832" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">安装 TensorFlow pip 包</strong></p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="fc7e" class="lj kh hi lf b fi lk ll l lm ln">pip install --upgrade tensorflow</span></pre><p id="70e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.验证安装</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="0fb3" class="lj kh hi lf b fi lk ll l lm ln">python -c "import warnings;warnings.simplefilter(action='ignore', category=FutureWarning);import tensorflow as tf;print(tf.reduce_sum(tf.random.normal([1000, 1000])))"</span></pre><p id="432d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们最后会看到这样的东西。</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="f4aa" class="lj kh hi lf b fi lk ll l lm ln">Tensor("Sum:0", shape=(), dtype=float32)</span></pre><p id="a362" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在 TensorFlow 现已安装！</p><p id="e672" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">创建你的第一个机器学习模型</strong></p><p id="459f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑以下几组数字。你能看出他们之间的关系吗？</p><p id="dd06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们观察它们时，我们可能会注意到，当你从左向右阅读时，X 值增加 1，相应的 Y 值增加 3。所以你可能会认为 Y=3X 正负什么的。然后我们可能会看到 X 上的 0，看到 Y = 1，我们得出关系 Y=3X+1。</p><p id="2b15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这几乎正是我们如何使用代码来训练一个模型，称为<strong class="ih hj"> <em class="kf">神经网络</em>，</strong>来发现这些数据项之间的模式！</p><p id="7791" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看看用来做这件事的代码，我们用数据来训练神经网络！通过输入一组 x 和一组 y，它应该能够找出它们之间的关系。</p><p id="6e0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一步一步地创建脚本。</p><p id="f93d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建并打开文件<code class="du lr ls lt lf b">model.py</code>。</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="415a" class="lj kh hi lf b fi lk ll l lm ln">nano model.py</span></pre><p id="8d1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将以下代码添加到导入中:</p><ul class=""><li id="2aff" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">TensorFlow，为了使用方便称之为<code class="du lr ls lt lf b">tf</code></li><li id="defb" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">一个名为<code class="du lr ls lt lf b">numpy</code>的库，它帮助将数据表示为列表</li><li id="cf38" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated"><code class="du lr ls lt lf b">keras</code>，将神经网络定义为一组连续层的框架</li><li id="2077" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">添加代码以抑制不推荐使用的警告，从而使输出更容易理解。</li></ul><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="03ce" class="lj kh hi lf b fi lk ll l lm ln">import warnings warnings.simplefilter(action='ignore', category=FutureWarning) import tensorflow as tf import numpy as np from tensorflow import keras from tensorflow.python.util import deprecation deprecation._PRINT_DEPRECATION_WARNINGS = False</span></pre><p id="3d67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 nano 中保持<code class="du lr ls lt lf b">model.py</code>打开，以进行下一部分。</p><p id="cb24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义并编译神经网络</strong></p><p id="3f29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，创建尽可能简单的神经网络。它有 1 层，那层有 1 个神经元，输入形状是 1 个值。</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="7146" class="lj kh hi lf b fi lk ll l lm ln">model = tf.keras.Sequential([keras.layers.Dense(units=1, input_shape=[1])])</span></pre><p id="2246" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，编写代码来编译您的神经网络。当我们这样做时，我们必须指定两个函数，一个<code class="du lr ls lt lf b">loss</code>和一个<code class="du lr ls lt lf b">optimizer</code>。</p><p id="d38a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们已经看到了很多机器学习的数学，这里是我们通常会使用它的地方，但在这种情况下，它被很好地封装在函数中。逐步介绍正在发生的事情:</p><ul class=""><li id="668b" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">我们知道，在函数中，数字之间的关系是<code class="du lr ls lt lf b">y=3x+1</code>。</li><li id="3b21" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">当计算机试图“学习”时，它会做出猜测…也许是<code class="du lr ls lt lf b">y=10x+10</code>。<code class="du lr ls lt lf b">loss</code>功能将猜测的答案与已知的正确答案进行对比，并衡量其表现的好坏。</li><li id="8a8d" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">接下来，该模型使用优化器函数进行另一次猜测。基于损失函数的结果，它将尝试最小化损失。在这一点上，也许它会拿出类似<code class="du lr ls lt lf b">y=5x+5</code>的东西。虽然这仍然很糟糕，但它更接近正确的结果(即损失更低)。</li><li id="573c" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">对于您指定的时期数，模型会重复此操作。</li><li id="d7ab" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">但是首先，我们向<code class="du lr ls lt lf b">model.py</code>添加代码，告诉它使用<code class="du lr ls lt lf b">mean squared error</code>来处理丢失，使用<code class="du lr ls lt lf b">stochastic gradient descent</code> (sgd)来处理优化器。我们还不需要理解这些的数学，但是我们可以看到它们是有效的</li></ul><p id="b576" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着时间的推移，我们将了解不同的和适当的损失和优化功能的不同情况。</p><p id="6d26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.将以下代码添加到<code class="du lr ls lt lf b">model.py</code>:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="16a5" class="lj kh hi lf b fi lk ll l lm ln">model.compile(optimizer='sgd', loss='mean_squared_error')</span></pre><p id="f658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 nano 中保持<code class="du lr ls lt lf b">model.py</code>打开，以进行下一部分。</p><p id="30c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">提供数据</strong></p><p id="1c90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如你所见，它们之间的关系是 Y=3X+1，所以 X = -1，Y=-2 等等。等等。</p><p id="9236" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个名为<code class="du lr ls lt lf b">numpy</code>的 python 库提供了大量数组类型的数据结构，这是一种事实上的标准数据输入方式。要使用这些，使用<code class="du lr ls lt lf b">np.array\[\]</code>在 numpy 中将值指定为数组。将以下代码添加到<code class="du lr ls lt lf b">model.py</code>:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="19a3" class="lj kh hi lf b fi lk ll l lm ln">xs = np.array([-1.0, 0.0, 1.0, 2.0, 3.0, 4.0], dtype=float) ys = np.array([-2.0, 1.0, 4.0, 7.0, 10.0, 13.0], dtype=float)</span></pre><p id="1414" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lr ls lt lf b">model.py</code>，包含定义神经网络所需的所有代码。现在，让我们添加代码来训练神经网络，以推断这些数字之间的模式，并使用它们来创建一个模型。</p><p id="9916" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">训练神经网络</strong></p><p id="9652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了训练神经网络“学习”Xs 和 Ys 之间的关系，我们让它通过一个循环:进行猜测，测量它有多好或多坏(也称为损失)，使用优化器进行另一次猜测，等等。它会按照您指定的次数(比如 500 次)来执行。</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="91a0" class="lj kh hi lf b fi lk ll l lm ln">model.fit(xs, ys, epochs=500)</span></pre><p id="0ed4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的 model.py 应该是这样的</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="7f2c" class="lj kh hi lf b fi lk ll l lm ln">import warnings <br/>warnings.simplefilter(action='ignore', category=FutureWarning)<br/>import tensorflow as tf <br/>import numpy as np from tensorflow <br/>import keras from tensorflow.python.util <br/>import deprecation <br/>deprecation._PRINT_DEPRECATION_WARNINGS = False </span><span id="48d1" class="lj kh hi lf b fi lq ll l lm ln">model = tf.keras.Sequential([keras.layers.Dense(units=1, input_shape=[1])]) <br/>model.compile(optimizer='sgd', loss='mean_squared_error') </span><span id="72f1" class="lj kh hi lf b fi lq ll l lm ln">xs = np.array([-1.0, 0.0, 1.0, 2.0, 3.0, 4.0], dtype=float) <br/>ys = np.array([-2.0, 1.0, 4.0, 7.0, 10.0, 13.0], dtype=float) </span><span id="531e" class="lj kh hi lf b fi lq ll l lm ln">model.fit(xs, ys, epochs=500)</span></pre><p id="caae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按<strong class="ih hj"> Ctrl+x </strong>关闭 nano，然后按<strong class="ih hj"> Y </strong>保存<code class="du lr ls lt lf b">model.py</code>脚本，然后<strong class="ih hj">输入</strong>确认脚本名称。</p><p id="88f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">运行您的脚本</strong></p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="5b58" class="lj kh hi lf b fi lk ll l lm ln">python model.py</span></pre><p id="fcc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看输出，可能略有不同。请注意，该脚本打印出了每个时期的损失。滚动历元，损失值在前几个历元相当大，但每一步都变小。例如:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/347338d7988c35764f526efcd842e93c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*anLX3MbzxtThjmz2.png"/></div></div></figure><p id="808b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练完成时，损失非常小，表明我们的模型在推断数字之间的关系方面做得非常好:</p><p id="3676" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用模型</strong></p><p id="3929" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在有一个经过训练的模型来学习 X 和 Y 之间的关系。我们可以使用<code class="du lr ls lt lf b">model.predict</code>方法来计算出以前未知的 X 的 Y。例如，如果 X = 10，你认为 Y 会是什么？</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="56ec" class="lj kh hi lf b fi lk ll l lm ln">nano model.py</span></pre><p id="e6c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.将以下代码添加到脚本的末尾:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="40dd" class="lj kh hi lf b fi lk ll l lm ln">print(model.predict([10.0]))</span></pre><p id="4a7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.按下<strong class="ih hj"> Ctrl+x </strong>，<strong class="ih hj"> Y </strong>，然后<strong class="ih hj">回车</strong>保存并关闭<code class="du lr ls lt lf b">model.py</code>。</p><p id="9547" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.猜测 Y 值，然后运行您的脚本:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="3cd5" class="lj kh hi lf b fi lk ll l lm ln">python model.py</span></pre><p id="e64c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Y 值列在历元之后。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/20afbe1ce6b46125f5363812fe401113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2pslEzVFTY4jQGBD.png"/></div></div></figure><p id="75f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可能认为 Y=31，对吗？但是在上面的示例输出中，它最终稍微超过了(31.005917)。为什么？</p><p id="bb0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经网络处理<em class="kf">概率</em>，所以给定我们输入的数据，神经网络计算出 X 和 Y 之间的关系是 Y=3X+1 的概率非常高，但是只有 6 个数据点我们无法确定。因此，10 的结果非常接近 31，但不一定是 31。</p><p id="a624" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你使用神经网络时，我们会看到这种模式重复出现。你几乎总是要处理概率，而不是确定性，并且会做一点编码来计算基于概率的结果，特别是在分类的时候。</p><p id="2d07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">你好，机器学习世界</strong>的会议到此结束。</p></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><p id="6a15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kf">原载于 2020 年 7 月 30 日</em><a class="ae lp" href="https://prajwol-kc.com.np/2020/07/30/hello-world-of-machine-learning-using-tensorflow" rel="noopener ugc nofollow" target="_blank"><em class="kf">https://prajwol-kc.com.np</em></a><em class="kf">。</em></p></div></div>    
</body>
</html>