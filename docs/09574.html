<html>
<head>
<title>Twitter toxicity detector using Tensorflow.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Tensorflow.js的Twitter毒性检测器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/twitter-toxicity-detector-using-tensorflow-js-1140e5ab57ee?source=collection_archive---------5-----------------------#2020-09-11">https://medium.com/analytics-vidhya/twitter-toxicity-detector-using-tensorflow-js-1140e5ab57ee?source=collection_archive---------5-----------------------#2020-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="739c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">近年来，随着仇恨言论、骚扰和攻击性内容的增加，Twitter上的互动变得越来越有害。在本文中，我想解释如何使用twitter API和tensorflow.js来构建一个简单的有毒tweet检测器</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/b4a1a1f4f1a76476ff508ba2712a7ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-bzuQoAItTehbCfwOIacQ.jpeg"/></div></div></figure><h1 id="b936" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">介绍</h1><p id="891e" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">在这篇文章中，我想一步一步地展示如何构建一个web应用程序来显示来自给定用户的最后的有害推文和转发。</p><p id="746c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该应用程序将接收2个参数:<strong class="ih hj"> tweets搜索</strong>和<strong class="ih hj">用户名。</strong></p><ul class=""><li id="ab8a" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated"><strong class="ih hj">要搜索的Tweets:</strong>我们希望从twitter API中获取要分析的Tweets的数量(10、20、50或100)。</li><li id="7b7f" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated"><strong class="ih hj">用户名:</strong>我们将从中分析推文的twitter用户(@…)。</li></ul><p id="5df2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分析的推文越多，预测毒性的处理就变得越昂贵，所以我添加了一个选择器来获取10、20、50或100条推文(其中50至100条推文意味着非常高的处理成本，这也是我不建议在低性能计算机或手机浏览器上尝试的原因)。</p><p id="a56e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，它会显示一个检测到的有毒推文和转发列表。您可以从<a class="ae lh" href="https://mcarlomagno.github.io/TwitterToxicityDetector/" rel="noopener ugc nofollow" target="_blank">这里</a>访问现场演示。</p><blockquote class="li lj lk"><p id="7117" class="if ig jd ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>有时Twitter API在第一次尝试时不会获得所有的tweets，因此您可能需要再次按下“搜索TWEETS”。<em class="hi">🤷‍♂️ </em></p></blockquote><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lo"><img src="../Images/c52abb5d5b779d72f963e1b48fdd6352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CBszVhL6oCkric59.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">演示截图</figcaption></figure></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h2 id="3797" class="ma jr hi bd js mb mc md jw me mf mg ka iq mh mi ke iu mj mk ki iy ml mm km mn bi translated">Twitter API</h2><p id="50b7" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">twitter API允许我们以编程方式访问Twitter内容，它可以用于读取、分析和与tweets、直接消息、用户和其他关键Twitter资源进行交互。</p><p id="acfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lh" href="https://developer.twitter.com/en/docs/twitter-api" rel="noopener ugc nofollow" target="_blank">更多信息</a></p><h2 id="e68a" class="ma jr hi bd js mb mc md jw me mf mg ka iq mh mi ke iu mj mk ki iy ml mm km mn bi translated">Tensorflow.js</h2><p id="bc33" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">TensorFlow.js是一个JavaScript库，用于在浏览器和Node.js中训练和实现机器学习模型。</p><p id="d12a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lh" href="https://www.tensorflow.org/js" rel="noopener ugc nofollow" target="_blank">更多信息</a></p><h2 id="c9ff" class="ma jr hi bd js mb mc md jw me mf mg ka iq mh mi ke iu mj mk ki iy ml mm km mn bi translated">毒性分类模型</h2><p id="ef40" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">毒性模型是一个tensorflow机器学习模型，它可以检测文本是否包含诸如侮辱、淫秽、仇恨或明确的性语言等有毒内容。它建立在<a class="ae lh" href="https://github.com/tensorflow/tfjs-models/tree/master/universal-sentence-encoder" rel="noopener ugc nofollow" target="_blank">通用句子编码器</a>的基础上，并在包含约200万条毒性评论的民事评论<a class="ae lh" href="https://figshare.com/articles/data_json/7376747" rel="noopener ugc nofollow" target="_blank">数据集</a>上进行训练。</p><p id="667a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lh" href="https://github.com/tensorflow/tfjs-models/tree/master/toxicity" rel="noopener ugc nofollow" target="_blank">更多信息</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mo"><img src="../Images/b7f531dbd1b44345be4a066084866f18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nxotg7GOwts8RdDhDoRTxA.jpeg"/></div></div></figure></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="fb41" class="jq jr hi bd js jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn bi translated">设置</h1><h2 id="bcad" class="ma jr hi bd js mb mc md jw me mf mg ka iq mh mi ke iu mj mk ki iy ml mm km mn bi translated"><strong class="ak">推特API </strong></h2><p id="6b67" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">首先要做的是创建一个twitter开发者账户来访问API，按照这个<a class="ae lh" href="https://developer.twitter.com/en/apply-for-access" rel="noopener ugc nofollow" target="_blank">指南</a>的简单步骤来完成。</p><p id="376e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注册后，我们可以访问<a class="ae lh" href="https://developer.twitter.com/en/portal/products" rel="noopener ugc nofollow" target="_blank">门户</a>来查看使用统计数据，并访问端点URL和API的访问密钥。</p><h2 id="809d" class="ma jr hi bd js mb mc md jw me mf mg ka iq mh mi ke iu mj mk ki iy ml mm km mn bi translated">Tensorflow.js和毒性分类器</h2><p id="7c3f" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">为了能够在浏览器中使用Tensorflow，我们只需使用HTML、CSS和JavaScript创建一个经典的web应用程序(如果你不知道如何做，请遵循<a class="ae lh" href="https://www.w3schools.com/howto/howto_website.asp" rel="noopener ugc nofollow" target="_blank">这个</a>指南)，然后我们使用yarn、npm或Script标签从tensorflow导入模型和工具。</p><p id="3812" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个<a class="ae lh" href="https://github.com/tensorflow/tfjs-models/tree/master/toxicity" rel="noopener ugc nofollow" target="_blank"> github </a>中，很好地解释了如何去做。</p><h2 id="9cbf" class="ma jr hi bd js mb mc md jw me mf mg ka iq mh mi ke iu mj mk ki iy ml mm km mn bi translated"><strong class="ak"> Express.js环境</strong></h2><p id="5c47" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">不幸的是，Twitter不允许应用程序直接从浏览器访问API，因此需要构建一个服务器应用程序才能访问。</p><p id="a91d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的例子中，我是使用<a class="ae lh" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express.js </a>完成的，然后我将它部署到<a class="ae lh" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> heroku </a>。使用免费帐户，您可以创建和部署多达5个服务器应用程序。</p><p id="35a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您不知道如何做，或者如果您只是不想创建服务器应用程序，您可以克隆<a class="ae lh" href="https://github.com/MCarlomagno/toxicity-classifier-server" rel="noopener ugc nofollow" target="_blank">我的项目</a>，修改参数以访问您的twitter API，然后部署到您的heroku帐户。</p><p id="d4f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如果你对服务器一无所知或者你只是不想自己构建它，你可以使用我构建的服务器的API url从你的web应用程序直接访问我的API(我启用了</strong><a class="ae lh" href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">CORS</strong></a><strong class="ih hj">以保持任何人都可以访问它)。</strong></p><p id="f006" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">网址格式:</strong></p><p id="598f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">https://toxicity-classifier-server.herokuapp.com/twits/<username>/<number_of_tweets/></username></p><h2 id="6a85" class="ma jr hi bd js mb mc md jw me mf mg ka iq mh mi ke iu mj mk ki iy ml mm km mn bi translated"><strong class="ak">最终架构:</strong></h2><p id="38b9" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">一旦我们完成了所有这些步骤，我们就可以构建这个架构，并且我们可以随心所欲地使用它。在这种情况下，我们将使用它来获取给定用户最近的推文，并从浏览器中对其进行分析。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mu"><img src="../Images/6d79f620a630dc95bbc650135dc6cb07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7KJdsb9cGkoULbVEZ_3myA.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated"><strong class="bd js">架构流程图</strong>(绘制这个比系统编程花的时间还长)</figcaption></figure></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="43d0" class="jq jr hi bd js jt mp jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj mt kl km kn bi translated"><strong class="ak">步骤</strong></h1><p id="d28f" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">在您的web项目中，采取以下步骤。</p><p id="5fe6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1- </strong>将一个js文件链接到html模板。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="3605" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2- </strong>导入之前安装的tensorflow毒性库。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="550e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3- </strong>应用程序启动时加载模型(仅使用<strong class="ih hj">毒性</strong>标签和给定的<strong class="ih hj">阈值</strong>)。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="62cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4- </strong>当“搜索推文”事件被触发时，访问API以获取最近的推文。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="2a34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5- </strong>获取推文后，分析它们并预测毒性。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="d3fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 6- </strong>显示毒性值为<strong class="ih hj">真</strong>或<strong class="ih hj">空</strong>的推文(<strong class="ih hj">空</strong>表示程序不确定它是否有毒，结果不超过阈值)。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mv mw l"/></div></figure><h1 id="a23c" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">示例结果</h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mx"><img src="../Images/b3d9611ba31df00002f0bb87357e9023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*24OO9lWYuNGQiUIA.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es my"><img src="../Images/d43942e1247a7add0dcbec078b24e535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GnkXCLh1rT1O4xCv.png"/></div></div></figure><h1 id="abd2" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="dcaa" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">世界上产生的数据量每年都呈指数增长，有许多开放和免费的工具可以让我们以有趣的方式利用这些数据，例如使用本文中所示的机器学习模型。</p><p id="c9fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这款迷你系统的其他有趣功能包括:</p><ul class=""><li id="78d0" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">使用Twitter API的其他特性。</li><li id="b0c3" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">使用其他张量流模型来检测文本中的模式。</li><li id="c3d8" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">扩展应用程序以显示更多信息。</li><li id="4148" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">使用该模型进行数据分析(例如，一段时间内的[<em class="jd">toxic _ tweets</em>/<em class="jd">total _ tweets</em>)。</li></ul><p id="e1f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我鼓励您尝试创建自己的版本，以其他方式利用这些数据。</p><blockquote class="li lj lk"><p id="f240" class="if ig jd ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj"> Github回购:</strong>T30】https://github.com/MCarlomagno/toxicity-classifier</p><p id="34f8" class="if ig jd ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">试玩app:</strong><a class="ae lh" href="https://mcarlomagno.github.io/TwitterToxicityDetector/" rel="noopener ugc nofollow" target="_blank">https://mcarlomagno.github.io/toxicity-classifier/</a></p></blockquote></div></div>    
</body>
</html>