<html>
<head>
<title>Implementing Linear Regression algorithm on Covid19 datasets for prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Covid19数据集上实现线性回归算法进行预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-use-machine-learning-algorithms-such-as-linear-regression-on-covid19-datasets-for-prediction-56a623e2899a?source=collection_archive---------9-----------------------#2020-06-30">https://medium.com/analytics-vidhya/how-to-use-machine-learning-algorithms-such-as-linear-regression-on-covid19-datasets-for-prediction-56a623e2899a?source=collection_archive---------9-----------------------#2020-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6fe6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回归模型估计变量之间的关系。简而言之，从给定的输入变量或特征列表中，它估计连续的因变量。典型的应用包括生存预测、天气预报等。如果数据范围和响应的性质是实数，则使用回归技术。回归激活函数可以是线性的、二次的、多项式的、非线性的等等。在训练阶段，隐藏参数根据训练中给出的输入值进行优化。进行优化的过程是梯度下降算法，也称为<strong class="ih hj">最速下降算法</strong>。梯度下降用于更新模型的参数。如果学习速率太大，将会导致超调，如果学习速率太小，将需要更长的时间来收敛，如果使用神经网络，则还需要反向传播算法来计算每一层的梯度。一旦理论参数/假设参数得到训练(当它们在训练期间给出最小误差时)，则具有训练参数的相同理论/假设与新的输入值一起使用，以预测将再次成为真实值的结果。</p><p id="0f74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">线性回归</strong>是一种基于单一预测变量x预测响应Y的方法</p><h1 id="1441" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">数据集描述:</strong></h1><p id="0da9" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我已经从kaggle.com下载了数据集。数据集名称为“印度2019年新型冠状病毒疾病数据集”</p><p id="2bd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">冠状病毒是一个很大的病毒家族，可能导致动物或人类疾病。在人类中，已知几种冠状病毒会导致呼吸道感染，从普通感冒到更严重的疾病，如中东呼吸综合征(MERS)和严重急性呼吸综合征(SARS)。最近发现的冠状病毒导致冠状病毒疾病新冠肺炎-世界卫生组织</p><p id="e0ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">世界各地新病例的数量与日俱增。该数据集包含来自印度各邦和中央直辖区的每日信息。</p><p id="14a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">州一级的数据来自卫生部家庭福利部</p><p id="ef35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">个人层面的数据来自<a class="ae kg" href="https://www.covid19india.org/" rel="noopener ugc nofollow" target="_blank"> covid19india </a></p><p id="cd6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在每日数据集上使用了大量的印度新冠肺炎病例</p><p id="22d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于<em class="kh"> error_bad_lines=False </em>，python只从3567行中挑选了2524个条目</p><figure class="kj kk kl km fd kn er es paragraph-image"><div class="er es ki"><img src="../Images/cb024f5981189a8f87d2c27469956155.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*1u40mGL1YHjE12Cp59fd3A.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">数据集描述</figcaption></figure><h1 id="f072" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak"> Python代码</strong></h1><ol class=""><li id="573e" class="ku kv hi ih b ii kb im kc iq kw iu kx iy ky jc kz la lb lc bi translated">导入库</li></ol><pre class="kj kk kl km fd ld le lf lg aw lh bi"><span id="b784" class="li je hi le b fi lj lk l ll lm">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt #Data visualisation libraries <br/>import seaborn as sns<br/>from sklearn.model_selection import KFold, cross_val_score, train_test_split</span></pre><p id="b4ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.读取数据集，并使用seaborn对其进行配对绘制。Seaborn是python中最常用的可视化工具之一</p><pre class="kj kk kl km fd ld le lf lg aw lh bi"><span id="44e0" class="li je hi le b fi lj lk l ll lm">covid_data = pd.read_csv(r’C:\Users\sushilkumar.yadav\Desktop\vmware\Personal\Spyder\Covid19datasets\covid_19_india.csv’, header=0, delim_whitespace=True, error_bad_lines=False)<br/>covid_data.head()<br/>covid_data.info()<br/>covid_data.describe()<br/>covid_data.columns<br/>sns.pairplot(covid_data)</span></pre><p id="9c8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出</p><figure class="kj kk kl km fd kn er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/88cde3ec62c715a8df053f99f76174b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qg-uw7LnmErsi-BsdxaLNw.png"/></div></div></figure><p id="834f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.让我们现在开始训练回归模型！我们需要首先将数据分成一个X数组和一个y数组，X数组包含要训练的特性，y数组包含目标变量，在本例中是死亡列。</p><pre class="kj kk kl km fd ld le lf lg aw lh bi"><span id="19ff" class="li je hi le b fi lj lk l ll lm">X = covid_data[[‘Date’, ‘Confirmed’]]<br/>y = covid_data[‘Deaths’]<br/>X[‘Date’] = pd.to_datetime(X[‘Date’], format=’%d-%m-%y’)</span></pre><p id="c359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.现在，根据数据绘制死亡率，根据日期绘制所有曲线</p><pre class="kj kk kl km fd ld le lf lg aw lh bi"><span id="fa76" class="li je hi le b fi lj lk l ll lm">plt.xticks(rotation=45)<br/>print(X[‘Date’])<br/>plt.plot_date(X[‘Date’], y, fmt=’b-’, xdate=True, ydate=False)<br/>covid_data.plot()<br/>plt.show()<br/>date = X.loc[:, [‘Date’]]<br/>X[‘Date2num’] = X[‘Date’].apply(lambda x: mdates.date2num(x))<br/>del X[‘Date’]</span></pre><p id="7165" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出</p><figure class="kj kk kl km fd kn er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/f04db865e22dc790af5857f7893577a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kttGi4F2sTNKtZ5MzoTWBA.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">死亡率绘图</figcaption></figure><figure class="kj kk kl km fd kn er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/cf9bd8b5c90aad480a72f6b25299b61c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FgJ9LLCKHMyt3r5v_JaFrQ.png"/></div></div></figure><p id="5318" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.<strong class="ih hj">列车试分裂</strong></p><p id="6c47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将数据分为训练数据集和测试数据集，在我们的例子中，我们使用30%的数据作为测试数据，其余的数据作为训练数据</p><pre class="kj kk kl km fd ld le lf lg aw lh bi"><span id="2631" class="li je hi le b fi lj lk l ll lm">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)<br/>date_test = date.loc[:np.floor(m*0.3)]<br/>date_train = date.loc[np.floor(m*0.3)+1:]</span></pre><p id="d53c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.<strong class="ih hj">创建和训练模型</strong></p><p id="6fba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们对训练数据拟合线性回归模型</p><pre class="kj kk kl km fd ld le lf lg aw lh bi"><span id="147c" class="li je hi le b fi lj lk l ll lm">lr = LinearRegression()<br/>lr.fit(X_train,y_train)</span></pre><p id="5a60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.让我们预测并可视化这个模型</p><pre class="kj kk kl km fd ld le lf lg aw lh bi"><span id="fc6f" class="li je hi le b fi lj lk l ll lm">print(‘Coefficients: \n’, lr.coef_)<br/># The mean square error<br/>print(“Residual sum of squares: %.2f”<br/> % np.mean((lr.predict(X_test) — y_test) ** 2))<br/># Explained variance score: 1 is perfect prediction<br/>print(‘Variance score: %.2f’ % lr.score(X_test, y_test))<br/># Plot outputs<br/>plt.xticks(rotation=45)<br/>plt.plot_date(date_test, y_test, fmt=’b-’, xdate=True, ydate=False, label=’Real value’)<br/>plt.plot_date(date_test, lr.predict(X_test), fmt=’r-’, xdate=True, ydate=False, label=’Predicted value’)<br/>plt.legend(loc=’upper center’)<br/>plt.ylabel(‘No. of Deaths’)<br/>plt.title(‘Covid19 Death prediction for India’)<br/>plt.grid()</span></pre><p id="651a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出</p><figure class="kj kk kl km fd kn er es paragraph-image"><div class="er es ls"><img src="../Images/f1fd34b3536113a6c617e0f9c53e3bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*VN2aKD4p1BJM3P6BYmAzUg.png"/></div></figure><figure class="kj kk kl km fd kn er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/4ada60c56e7ae670945d39791994c534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2h_aXdPyarVy1W_045eKQ.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">真实值和预测值</figcaption></figure><p id="e3a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这能给机器学习在解决现实生活问题中的应用提供一些小依据</p></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><p id="77e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是完整的代码，</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="0b5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要了解机器学习算法，请参考我以前的文章</p><div class="mc md ez fb me mf"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/an-overview-of-machine-learning-algorithms-4a9a881a1a4b"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">机器学习算法综述</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">机器学习是让计算机在没有程序员明确编程的情况下行动的科学。它…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt ko mf"/></div></div></a></div><div class="mc md ez fb me mf"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/kernel-based-approaches-in-machine-learning-aaf174bdf49a"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">机器学习中基于核的方法</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">核是一种使用线性分类器来解决非线性问题的方法，这是通过转换一个</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">medium.com</p></div></div><div class="mo l"><div class="mu l mq mr ms mo mt ko mf"/></div></div></a></div></div></div>    
</body>
</html>