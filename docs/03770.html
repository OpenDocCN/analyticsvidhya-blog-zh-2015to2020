<html>
<head>
<title>Word Embedding using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python嵌入单词</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/word-embedding-using-python-63770334841?source=collection_archive---------7-----------------------#2020-02-18">https://medium.com/analytics-vidhya/word-embedding-using-python-63770334841?source=collection_archive---------7-----------------------#2020-02-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ec2e678578faa247deb0cc6dfe4dc36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdR2DQ3Bn8o-KmS5qdWdnw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://www.pexels.com/photo/screen-web-design-developing-codes-1936299/" rel="noopener ugc nofollow" target="_blank">信号源</a></figcaption></figure><p id="d9f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我们将看到如何生成单词嵌入并为相应的单词绘制图表。</p><h1 id="ba1f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">属国</h1><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="be72" class="la ju hi kw b fi lb lc l ld le">- NLTK<br/>- Sklearn<br/>- Gensim<br/>- Plotly<br/>- Pandas</span></pre><p id="2b7d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们需要获得一个段落或文本，我们需要为其找到嵌入，我在这篇文章中从<a class="ae iu" href="https://en.wikipedia.org/wiki/Jupiter" rel="noopener ugc nofollow" target="_blank">这里</a>取了一个pragraph。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="9712" class="la ju hi kw b fi lb lc l ld le">paragraph = '''Jupiter is the fifth planet from the Sun and the largest in the Solar System. <br/>    It is a gas giant with a mass one-thousandth that of the Sun, <br/>    but two-and-a-half times that of all the other planets in the Solar System combined. <br/>    Jupiter is one of the brightest objects visible to the naked eye in the night sky, <br/>    and has been known to ancient civilizations since before recorded history. <br/>    It is named after the Roman god Jupiter. When viewed from Earth, <br/>    Jupiter can be bright enough for its reflected light to cast shadows, <br/>    and is on average the third-brightest natural object in the night sky after the Moon and Venus.'''</span></pre><p id="1c91" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来我们需要对文本进行标记，所以我们使用<code class="du lf lg lh kw b">nltk</code>库来完成这项工作:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5def" class="la ju hi kw b fi lb lc l ld le">import nltk</span><span id="1105" class="la ju hi kw b fi li lc l ld le"># tokeninizing the paragraph<br/>sent_text = nltk.sent_tokenize(paragraph)<br/>word_text = [nltk.word_tokenize(sent) for sent in sent_text]<br/>print(word_text)</span></pre><p id="a8ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">令牌化后，我们将获得一个2D数组，如下所示:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c2df" class="la ju hi kw b fi lb lc l ld le">[['Jupiter', 'is', 'the', 'fifth', 'planet', 'from', 'the', 'Sun', 'and', 'the', 'largest', 'in', 'the', 'Solar', 'System', '.'], ['It', 'is', 'a', 'gas', 'giant', 'with', 'a', 'mass', 'one-thousandth', 'that', 'of', 'the', 'Sun', ',', 'but', 'two-and-a-half', 'times', 'that', 'of', 'all', 'the', 'other', 'planets', 'in', 'the', 'Solar', 'System', 'combined', '.'], ['Jupiter', 'is', 'one', 'of', 'the', 'brightest', 'objects', 'visible', 'to', 'the', 'naked', 'eye', 'in', 'the', 'night', 'sky', ',', 'and', 'has', 'been', 'known', 'to', 'ancient', 'civilizations', 'since', 'before', 'recorded', 'history', '.'], ['It', 'is', 'named', 'after', 'the', 'Roman', 'god', 'Jupiter', '.'], ['When', 'viewed', 'from', 'Earth', ',', 'Jupiter', 'can', 'be', 'bright', 'enough', 'for', 'its', 'reflected', 'light', 'to', 'cast', 'shadows', ',', 'and', 'is', 'on', 'average', 'the', 'third-brightest', 'natural', 'object', 'in', 'the', 'night', 'sky', 'after', 'the', 'Moon', 'and', 'Venus', '.']]</span></pre><p id="d742" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将使用<code class="du lf lg lh kw b">gensim</code>包从<code class="du lf lg lh kw b">Word2Vec</code>模型中获取单词embedding。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f256" class="la ju hi kw b fi lb lc l ld le">from gensim.models import Word2Vec</span><span id="a28a" class="la ju hi kw b fi li lc l ld le"># train model to get the embeddings<br/>model = Word2Vec(word_text, min_count=1)</span></pre><p id="db96" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了绘制单词嵌入，我们需要首先将多维嵌入转换为2D数组。因此，要将其转换为2D数组，我们使用<code class="du lf lg lh kw b">PCA</code></p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="0da2" class="la ju hi kw b fi lb lc l ld le"># getting the embedding vectors<br/>X = model[model.wv.vocab]<br/># dimentionality reduction using PCA<br/>pca = PCA(n_components=2)<br/># running the transformations<br/>result = pca.fit_transform(X)<br/># getting the corresponding words<br/>words = list(model.wv.vocab)</span></pre><p id="a3a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们需要做一些处理来将PCA结果转换成数据帧，如下所示:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c1e4" class="la ju hi kw b fi lb lc l ld le">import pandas as pd</span><span id="1108" class="la ju hi kw b fi li lc l ld le"># creating a dataframe from the results<br/>df = pd.DataFrame(result, columns=list('XY'))<br/># adding a columns for the corresponding words<br/>df['Words'] = words<br/># converting the lower case text to title case<br/>df['Words'] = df['Words'].str.title()</span></pre><p id="9433" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">获得所需的数组后，我们可以使用<code class="du lf lg lh kw b">plotly</code>绘制图表</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="13a2" class="la ju hi kw b fi lb lc l ld le">import plotly.express as px</span><span id="be6c" class="la ju hi kw b fi li lc l ld le"># plotting a scatter plot<br/>fig = px.scatter(df, x="X", y="Y", text="Words", log_x=True, size_max=60)<br/># adjusting the text position<br/>fig.update_traces(textposition='top center')<br/># setting up the height and title<br/>fig.update_layout(<br/>    height=600,<br/>    title_text='Word embedding chart'<br/>)<br/># displaying the figure<br/>fig.show()</span></pre><p id="2a0e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，单词嵌入图表将如下所示:</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/427e318475f507176c383bb1ee12ea46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dfWIh5TNxTJXzWLmjZqrRg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">单词嵌入图</figcaption></figure><p id="8753" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">整个代码如下:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8d41" class="la ju hi kw b fi lb lc l ld le">import nltk<br/>import pandas as pd<br/>import plotly.express as px<br/>from gensim.models import Word2Vec</span><span id="1ba3" class="la ju hi kw b fi li lc l ld le">paragraph = '''Jupiter is the fifth planet from the Sun and the largest in the Solar System. <br/>    It is a gas giant with a mass one-thousandth that of the Sun, <br/>    but two-and-a-half times that of all the other planets in the Solar System combined. <br/>    Jupiter is one of the brightest objects visible to the naked eye in the night sky, <br/>    and has been known to ancient civilizations since before recorded history. <br/>    It is named after the Roman god Jupiter. When viewed from Earth, <br/>    Jupiter can be bright enough for its reflected light to cast shadows, <br/>    and is on average the third-brightest natural object in the night sky after the Moon and Venus.'''</span><span id="6e53" class="la ju hi kw b fi li lc l ld le"># tokeninizing the paragraph<br/>sent_text = nltk.sent_tokenize(paragraph)<br/>word_text = [nltk.word_tokenize(sent) for sent in sent_text]</span><span id="e8ec" class="la ju hi kw b fi li lc l ld le"># train model to get the embeddings<br/>model = Word2Vec(word_text, min_count=1)<br/># getting the embedding vectors<br/>X = model[model.wv.vocab]<br/># dimentionality reduction using PCA<br/>pca = PCA(n_components=2)<br/># running the transformations<br/>result = pca.fit_transform(X)<br/># getting the corresponding words<br/>words = list(model.wv.vocab)</span><span id="ed2f" class="la ju hi kw b fi li lc l ld le"># creating a dataframe from the results<br/>df = pd.DataFrame(result, columns=list('XY'))<br/># adding a columns for the corresponding words<br/>df['Words'] = words<br/># converting the lower case text to title case<br/>df['Words'] = df['Words'].str.title()</span><span id="ef96" class="la ju hi kw b fi li lc l ld le"># plotting a scatter plot<br/>fig = px.scatter(df, x="X", y="Y", text="Words", log_x=True, size_max=60)<br/># adjusting the text position<br/>fig.update_traces(textposition='top center')<br/># setting up the height and title<br/>fig.update_layout(<br/>    height=600,<br/>    title_text='Word embedding chart'<br/>)<br/># displaying the figure<br/>fig.show()</span></pre><p id="7a46" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">编码快乐！！！</p></div></div>    
</body>
</html>