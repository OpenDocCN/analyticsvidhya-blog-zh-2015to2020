<html>
<head>
<title>Logistic Regression — The Theoretical Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归——理论方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-the-theoretical-way-1f22f273b840?source=collection_archive---------22-----------------------#2020-05-16">https://medium.com/analytics-vidhya/logistic-regression-the-theoretical-way-1f22f273b840?source=collection_archive---------22-----------------------#2020-05-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7fae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在继续之前，我相信你必须了解<strong class="ih hj">线性回归</strong>。如果你不知道，请浏览我以前的文章:<a class="ae jd" rel="noopener" href="/analytics-vidhya/data-science-linear-regression-part-i-1800681ac5de">线性回归一</a> &amp; <a class="ae jd" rel="noopener" href="/analytics-vidhya/linear-regression-part-ii-ca9e57767347">线性回归二</a>。</p><p id="b9c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，让我给你们简单介绍一下，这是逻辑回归的第一部分，它涵盖了我们实际应用之前需要知道的所有理论。文章的第二部分将在下周到来，将有实用的方法。这种实用的方法不仅仅是应用逻辑回归，它还会告诉你解决特定商业问题或项目的方法。我希望您阅读这篇文章，这样您将能够理解逻辑回归实现背后的直觉。</p><p id="565e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，在讨论逻辑回归之前，我想先讨论一些概念，它们是理解模型的基础，如概率和比值比。到本文结束时，你对它的回答将是二元的，即你理解了(1)或你不理解(0)。如果您有任何疑问，请随时发表评论，或者您可以通过startmljourney@gmail.com联系我</p><p id="53da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们从这里开始我们的逻辑回归之旅。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="aaad" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">可能性</h1><p id="71df" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">概率是特定事件发生的可能性。一个<strong class="ih hj">机会</strong>是在<strong class="ih hj">不确定</strong>条件下可能发生的事情。不确定的条件是不稳定的，并涉及风险。风险与不确定性和波动性相关。例如，股票市场的风险与股票市场的不确定性和股票价格的波动有关。随着市场波动，风险也在增加。</p><p id="5580" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数学等式中，我们可以将概率定义为:</p><p id="fbf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> P(A)=m/n </strong></p><p id="7c06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中:<strong class="ih hj"> m </strong>为<strong class="ih hj">事件A </strong>的有利发生次数；<strong class="ih hj"> n </strong>是<strong class="ih hj">结果的总数。</strong></p><p id="2048" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果发生的概率是<strong class="ih hj"> P </strong>，那么不发生的概率是<strong class="ih hj"> (1-P) </strong>。</p><p id="b1a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">事件</strong>是一组实验结果。有两种类型的事件:</p><ul class=""><li id="e468" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated"><strong class="ih hj">互斥:</strong>两个事件的发生相互排斥，即两个事件不能在同一时间点发生。如果<strong class="ih hj">事件A </strong>发生，<strong class="ih hj">事件B </strong>不会发生，反之亦然。</li><li id="9f28" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated"><strong class="ih hj">独立事件:</strong>其发生不受其他事件影响的事件</li></ul><p id="006c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将在这里只谈论<strong class="ih hj">条件概率，</strong>虽然还有其他规则。然而，对于这篇文章，我想简单地告诉你。</p><p id="df9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有两个事件<strong class="ih hj"> A </strong>因此，如果你阅读上述语句，你可以很容易地识别条件语句，即假设事件B已经发生。请记住这句话，我在介绍逻辑回归时会说得更清楚。它在数学上可以表示为:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lc"><img src="../Images/9a5126b6d447bafaba7122560ee83a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*0l04z-TVWPGPGl_HAJ36MQ.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">条件概率</figcaption></figure><h1 id="4d32" class="jl jm hi bd jn jo lo jq jr js lp ju jv jw lq jy jz ka lr kc kd ke ls kg kh ki bi translated">让步比</h1><p id="2627" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">特定事件的优势比可以定义为有利结果的数量与不利结果的数量之间的比率。它基本上告诉您事件A的存在与否如何影响事件B的存在与否。比值比可以用数学方法表示为:</p><p id="6f85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">赔率= P/(1-P) </strong></p><p id="b235" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">例一</strong>:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lt"><img src="../Images/a48c2475da26fc51e752f0eb98ee8f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*YrOAuZa84uqUYQ0C2_AnsA.jpeg"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">让步比</figcaption></figure><p id="57fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们想找出如果你有肺癌暴露于吸烟的几率和如果你没有肺癌暴露于吸烟的几率。</p><p id="2316" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此比值比= (90 x 90) / (10 x 10) =81。</p><p id="743d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着如果你有肺癌，那么你吸烟的可能性是没有肺癌的81倍。</p><p id="4406" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">例二</strong>:</p><p id="32ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">比方说我在和AI下棋。10场比赛，我赢了4场，输了6场。因此，我赢这场比赛的可能性是4/6，即66。如果我们把比赛次数从10场增加到100场，我仍然只能赢4场比赛。因此我输了96场比赛。获胜的几率变成4/96，即0.41。因此，这意味着我打得越差，我赢的几率将接近于0。在这种情况下，我输了，赔率可以被认为是赢的<strong class="ih hj">赔率。在这里，赢的几率在0到4之间。现在，如果我开始赢得更多的比赛，我获胜的几率就会增加。比方说，我和AI打了100场比赛，赢了94场，因此我输了6场。所以，<strong class="ih hj">赢</strong>的几率是94/6，即15.667，当我赢的时候，几率可以被认为是<strong class="ih hj">赢</strong>的几率，随着我对AI的表现越来越好而增加。如果我一直保持这样的进步，获胜的几率将会越来越接近无穷大。所以在这个例子中，我赢的几率在4到无穷大之间。</strong></p><p id="c86e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如何把赔率和概率联系起来？</strong></p><p id="c6e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重点关注下面写的两个陈述:</p><ul class=""><li id="a68a" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">如果事件发生的概率是<strong class="ih hj"> P，</strong>那么事件发生的几率是<strong class="ih hj"> P/(1-P)。</strong></li><li id="e36b" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">如果一个事件发生的几率是<strong class="ih hj"> O </strong>，那么一个事件发生的概率是<strong class="ih hj"> O/(1+O) </strong>。</li></ul><p id="976e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过以上陈述，需要注意的要点是:</p><ul class=""><li id="edb1" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">概率值的范围从<strong class="ih hj"> 0到1 </strong>。赔率有无限的范围</li><li id="bbf9" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">一个事件发生的概率总是小于它发生的几率</li></ul><p id="23b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将在下一节逻辑回归中谈到它的重要性。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="020e" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">逻辑回归</h1><p id="1b79" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">逻辑回归是一个<strong class="ih hj">概率</strong>模型，它返回一个事件发生的概率。用于分类任务，如搅动&amp;未搅动、通过&amp;失败等。因此，这意味着目标变量是分类的，即二项式1 &amp; 0或真&amp;假。逻辑回归也可用于多项目标变量，但为了便于理解，我们将使用二元目标变量。在这种情况下，我们有一个因变量和一组自变量，模型检查条件概率，即给定一组自变量，目标变量为1或真的概率是多少。</p><p id="b759" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归使用比值比对数的概念。这只是简单地取我之前解释过的比值比的对数，我们可以计算log(比值比)。为什么我们取比值比的对数是一个有趣的问题。比值比的范围是无穷大，因此比值的大小是不可比的。在我们前面的部分，在第二个例子中，赢的赔率范围在0到4之间，而赢的赔率范围在4到无穷大之间，这是一个非常大的范围。因此，对那些支持获胜的人来说，获胜的几率看起来要小得多。因此，请看下面的例子:</p><blockquote class="lu lv lw"><p id="6f17" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated">获胜的几率:4/96 = .0417</p><p id="d19c" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated">log(获胜几率):log(.0417) = -1.38</p><p id="6274" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated">获胜的可能性:96/4 =24</p><p id="cfed" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated">log(赢的几率):log(24) =1.38</p></blockquote><p id="4a0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，看看比例后采取对数的赔率，它看起来是对称的，有一个公平的比较规模。所以用log，我们让它和原点等距，表示反对获胜和赞成获胜。几率日志有助于我们理解<strong class="ih hj"> Logit功能。</strong></p><p id="e1fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，对于逻辑回归，我们计算P(Y=1|X)的概率的对数，其等于Z，其中Z是转置(W)和X的点积。这里，W是权重矩阵，X是独立变量的矩阵。如果你注意到了，这个Z和我们在线性回归中学到的等式是一样的。这就是为什么算法的名字叫做回归。数学表示:</p><p id="0323" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">logo DDS(P(Y = 1 | X))= Z = W . Transpose * X</p><p id="21de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，为了从回归方程中找到概率，即Z，我们对Z应用逻辑函数。它可以数学表示为:</p><p id="8096" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> f(Z)=1/(1+e^-z) </strong></p><p id="9cad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> f(Z) </strong>简称sigmoid函数，是一个<strong class="ih hj">逻辑函数。</strong>因此，逻辑函数是几率对数的<strong class="ih hj">倒数。</strong></p><p id="cb84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，逻辑回归曲线是一条sigmoid曲线，看起来像这样:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/7656998f11bde4e8e8832696cd769193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YuabQiGBA-W-5PWsojwN5A.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">s形曲线</figcaption></figure><p id="7408" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，当你看到这条曲线时，它是一条介于0和1之间的S形曲线。当曲线接近或接近0或1时，曲线变得平坦，因此在这些区域梯度变为0。因此，这意味着该算法存在<strong class="ih hj">消失梯度</strong>的问题。<strong class="ih hj"> Sigmoid函数</strong>，将一个大的输入空间压缩成一个介于0和1之间的小输入空间。因此，sigmoid函数输入的大变化会导致输出的小变化。因此，导数变小。<strong class="ih hj">当<strong class="ih hj"> sigmoid函数经过. 5 </strong>时<strong class="ih hj"> sigmoid函数</strong>的导数</strong>为<strong class="ih hj">最大值</strong>。参考下图，sigmoid函数为蓝色，其导数为红色虚线。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mg"><img src="../Images/29f38b0e33ecbaa683c057d6a4d27753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zJ2UQP8fIrIq-arHaiRqQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">Sigmoid函数及其导数</figcaption></figure><p id="142d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个<strong class="ih hj">消失梯度</strong>的问题只有当我们与<strong class="ih hj">梯度下降优化器</strong>一起使用时才能在逻辑回归中看到，梯度下降优化器<strong class="ih hj">反向传播</strong>以更新<strong class="ih hj">权重</strong>，从而使<strong class="ih hj">损失函数</strong>最小化<strong class="ih hj"/>。尽管在逻辑回归中你并不经常遇到梯度消失的问题。</p><p id="10ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我上面提到的损失函数，让我简单描述一下。我们在逻辑回归中使用的损失函数是<strong class="ih hj">对数损失函数</strong>。我们的目标是最小化对数损失函数。它在数学上可以表示为:</p><p id="767a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">L(a，y)= -(y*log(a )+ (1-y)*log(1-a))</p><p id="44ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">L(a，y)，即损失函数是单个例子的成本。下面给出的图片对此进行了进一步解释:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es mh"><img src="../Images/0d697c38d88e50c2bf357fa41dcc9e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*HeL0AdTy2jx9tUZSNwn3Xg.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">损失函数</figcaption></figure><p id="1d8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">成本函数是所有训练示例的损失函数之和，如下所示:</p><p id="c7f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">J(W，b)=(1/m) * Sum(L(ai，yi))</p><p id="13c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中I是从0到样本总数</p><p id="c670" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然学了这个，那我来分享一下梯度下降的logistic回归的算法。</p><h2 id="1db3" class="mi jm hi bd jn mj mk ml jr mm mn mo jv iq mp mq jz iu mr ms kd iy mt mu kh mv bi translated">带梯度下降算法的逻辑回归</h2><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mw"><img src="../Images/8acd37d0776197718778a9f5e0dce27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ua5YjsFYRoNpeohDVeNHeQ.jpeg"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">梯度下降逻辑回归</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="5558" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再见，朋友们！我希望这篇文章对你有所帮助，我会很快看到它的下一部分。继续学，继续赚！</p></div></div>    
</body>
</html>