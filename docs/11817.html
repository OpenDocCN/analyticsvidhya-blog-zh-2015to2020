<html>
<head>
<title>A Gentle Introduction Into The Histogram Of Oriented Gradients</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">方向梯度直方图的温和介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-gentle-introduction-into-the-histogram-of-oriented-gradients-fdee9ed8f2aa?source=collection_archive---------1-----------------------#2020-12-20">https://medium.com/analytics-vidhya/a-gentle-introduction-into-the-histogram-of-oriented-gradients-fdee9ed8f2aa?source=collection_archive---------1-----------------------#2020-12-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/7cf2af2006bd203b0cd41f372316d21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*XZxX8V4OrVSwQ9e9snE3gA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">信用:<a class="ae iq" href="https://iq.opengenus.org/object-detection-with-histogram-of-oriented-gradients-hog/" rel="noopener ugc nofollow" target="_blank">iq.opengenus.org</a></figcaption></figure><p id="b655" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">机器学习是一个独特的领域，它随着时间的推移而迅速发展；曾经的最佳算法常常在十到二十年内被替换，以便为更有效的方法让路。方向梯度直方图检测方法(简称 HOG)是这些古老算法中的一种，已有近十年的历史；然而，有一点与众不同，那就是今天<strong class="it hj">仍在大量使用</strong>，并取得了惊人的效果。</p><p id="5a64" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">梯度方向直方图方法主要用于面部和图像检测，以对图像进行分类，就像您在上面看到的那样。这个领域有大量的应用，从自动驾驶汽车到监控技术，再到更智能的广告。本文将深入探讨 HOG 检测方法背后的实现，并理解为什么它至今仍被广泛使用。我希望你们都和我一样有兴趣了解 HOG 的本质，所以让我们开始吧！</p><p id="461b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj"> <em class="jp">注意</em> </strong> <em class="jp">:这篇文章确实需要对机器学习和数学概念有很高的理解，比如归一化、梯度和极坐标，一旦我们进入其中，可能会有点混乱。</em></p><h1 id="9e62" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">初步步骤</h1><h2 id="4764" class="ko jr hi bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb bi translated">特征描述符</h2><p id="7b56" class="pw-post-body-paragraph ir is hi it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hb bi translated">在本文中，您可能经常听到这个名称，但是<strong class="it hj">特性描述符</strong>只是表示图像的表示，它只是从图像中提取有用的信息，而忽略不必要的信息。</p><p id="a1ce" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在 HOG 特征描述符的情况下，我们还将图像(宽 x 高 x 通道)转换成由用户选择的长度为<em class="jp"> n </em>的特征向量。虽然可能很难查看这些图像，但这些图像对于像支持向量机这样的图像分类算法来说是完美的，以便产生良好的结果。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/51b5477fee0a1dcb5f59297219894365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*Z_ucCHeRnFYfglokNlV5zg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图像上的 HOG 特征描述符示例。信用:<a class="ae iq" href="https://www.analyticsvidhya.com/blog/2019/09/feature-engineering-images-introduction-hog-feature-descriptor/" rel="noopener ugc nofollow" target="_blank">分析 Vidhya </a></figcaption></figure><p id="d0bc" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，你们可能想知道 HOG 特征描述符实际上将如何整理这些不必要的信息。它只是通过<strong class="it hj">使用梯度直方图来实现这一点，该直方图被用作图像的特征</strong>。梯度对于检查图像中的边缘和角落(通过强度变化的区域)非常重要，因为它们通常比平坦区域包含更多的信息。</p><h2 id="bb8e" class="ko jr hi bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb bi translated">预处理</h2><p id="079c" class="pw-post-body-paragraph ir is hi it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hb bi translated">人们在进行 HOG 对象检测时经常犯的一个主要错误是，他们忘记对图像进行预处理，以使其具有固定的纵横比。常见的长宽比(宽度:高度)是 1:2，因此您的图像可以是 100x200、500x1000 等。</p><p id="b5b7" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">对于您选择的特定图像，请确保您确定了您想要的部分，以便它<strong class="it hj">正确地符合长宽比</strong>，并允许从长远来看更容易访问。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/0947edb2ca988e75e0ea60bcea7a4731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FVxbjDMr8pOP-DWwd4t5UQ.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">数据预处理的一个例子。信用:【learnopencv.com T2】</figcaption></figure><h1 id="25fa" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">计算梯度</h1><p id="2aea" class="pw-post-body-paragraph ir is hi it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hb bi translated">如上所述，为了制作 HOG 特征描述符，我们需要计算相应的水平和垂直梯度，以实际提供直方图，该直方图可以在算法的后面使用。这可以通过简单地用这些内核过滤图像来实现:</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/65273f2d29026cf59423e471f8721af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*nmsiB7fTG6nLLZQou7bKiA.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">信用:【learnopencv.com T4】</figcaption></figure><p id="fb92" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">像这样的核通常用于图像分类，主要用于卷积神经网络，以便找到特定图像中的边缘和重要点。如果你对深入理解内核感兴趣，<a class="ae iq" href="https://setosa.io/ev/image-kernels/" rel="noopener ugc nofollow" target="_blank">这里的</a>是一篇从视觉上描述这些内核的文章。</p><p id="c650" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">然后，梯度的大小和方向可以通过使用下面的公式简单地找到(注意，在某种意义上，这只是从<strong class="it hj">笛卡尔坐标到极坐标</strong>的转换):</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/49b65cb45994f169c0601adc8da82947.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*w3Uo3WUwnbpgmNOZHRKvpA.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">信用:<a class="ae iq" href="https://www.learnopencv.com/histogram-of-oriented-gradients/" rel="noopener ugc nofollow" target="_blank">learnopencv.com</a></figcaption></figure><p id="3fc2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，虽然上面的这些公式可能看起来有点令人生畏，但请记住，这种实现的大部分将由计算机处理，因此没有必要自己实际计算这些梯度。如果你对计算这些梯度背后的数学更感兴趣，我建议你在这里查看这篇文章<a class="ae iq" href="https://lilianweng.github.io/lil-log/2017/10/29/object-recognition-for-dummies-part-1.html#how-hog-works" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="a20a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果你不明白梯度是如何计算的，那也没关系。你应该从梯度中得到的主要收获是<strong class="it hj">在强度发生急剧变化的地方，梯度的幅度会增加。</strong>下图突出显示了渐变的一个最佳示例，当它们通过这些渐变围绕图像的边缘燃烧时，就可以做到这一点。不必要的信息像背景一样被去除，只留下必要的部分。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/6b42b44e1ecd096c9bc468b2fe3d66dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*jqwhfzvftFR0HDd_4Lg25A.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">信用:<a class="ae iq" href="https://www.learnopencv.com/histogram-of-oriented-gradients/" rel="noopener ugc nofollow" target="_blank">learnopencv.com</a></figcaption></figure><p id="a816" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">总而言之，请理解梯度具有大小和方向，其中大小是通过三个颜色通道中梯度大小的最大值计算的，角度是通过与所评估的三个通道中最大梯度对应的角度计算的。这些可以产生像上面这样的图像，它可以检测重要的信息，忽略不必要的部分。</p><h1 id="1569" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">从这些梯度制作直方图</h1><p id="db9a" class="pw-post-body-paragraph ir is hi it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hb bi translated">要进入 HOG 算法的下一步，请确保将图像分成多个单元，以便可以计算每个单元的梯度直方图。例如，如果你有一个 64x128 的图像，将你的图像分成 8x8 的单元(这将涉及一点调整和猜测！).</p><p id="8b90" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">特征描述符将允许简明扼要地表示图像的特定小块；以上面的例子为例，一个 8×8 的单元可以简单地用 128 个数字来解释(8×8×2，其中最后 2 个数字来自梯度幅度和方向值)。通过进一步转换这些数字来计算直方图，我们可以得到一个对噪声更加鲁棒、更加紧凑的<strong class="it hj">图像块。</strong></p><p id="0bde" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">对于直方图，一定要把它分成<strong class="it hj">九个独立的面元</strong>，每个面元对应 0-160°的角度，增量为 20°。这里有一个例子，展示了具有各自梯度大小和方向的图像是什么样子的(注意，箭头会根据大小而变大)。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lu"><img src="../Images/449a211c0cecfe08469d9cf1d8e33c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhsKGuHj2zhr2ny9MyvryA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">信用:<a class="ae iq" href="https://www.learnopencv.com/histogram-of-oriented-gradients/" rel="noopener ugc nofollow" target="_blank">learnopencv.com</a></figcaption></figure><p id="7555" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我们如何决定每个像素在直方图中的位置？很简单。根据所选择的方向来选择容器，并且随后放置在容器内的值取决于幅度。注意，如果一个像素位于两个面元的中间，那么它会根据它们与各个面元的距离来相应地分割幅度。在执行该过程之后，可以形成直方图，并且可以容易地看到具有最大权重的箱。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/7dfa8b1150d892a71be9462ad316f887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*FNxLHK16nXAQLP4WweXf7Q.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">根据像素的方向和大小将像素放入仓中。信用:<a class="ae iq" href="https://www.learnopencv.com/histogram-of-oriented-gradients/" rel="noopener ugc nofollow" target="_blank">learnopencv.com</a></figcaption></figure><h1 id="279d" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">块规范化(可选)</h1><p id="b6d4" class="pw-post-body-paragraph ir is hi it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hb bi translated">照明变化是另一个主要因素，它会打乱这些梯度的计算。例如，如果图像比当前亮度暗 1/2，那么梯度幅度和随后的直方图幅度都将减半。因此，我们希望我们的描述符<strong class="it hj">没有光照变化，以便它是公正和有效的。</strong></p><p id="bc1c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">典型的标准化过程是通过简单地计算一个向量的长度，然后简单地用该长度除该向量的所有元素。例如，如果你有一个向量[1，2，3]，那么根据基本的数学原理，这个向量的长度就是 14 的平方根。将向量除以这个长度，就得到新的归一化向量[0.27，0.53，0.80]。</p><p id="e774" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">根据您的偏好(无论您想要在 8×8 块上执行还是在更大的 16×16 块上执行)，可以执行这个标准化过程<strong class="it hj">。请记住，首先将这些块转换成元素向量，以便可以执行上面强调的规范化。</strong></p><h2 id="c990" class="ko jr hi bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb bi translated">图像可视化</h2><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/ad92217e819000c1f9430b769ee03cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*TnaBUxwycqB4Rf4sD2lvnQ.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">最终 HOG 可视化示例。信用:<a class="ae iq" href="https://twitter.com/openmvcam/status/781507218936135681" rel="noopener ugc nofollow" target="_blank">推特</a></figcaption></figure><p id="8132" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在许多情况下，HOG 描述符通常与右边的图像一起可视化，以便获得人的形状的准确表示。这种可视化对于理解梯度在哪里移动以及知道对象在图像内部的位置非常有用。</p><h1 id="316a" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">猪的应用</h1><p id="8542" class="pw-post-body-paragraph ir is hi it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hb bi translated">梯度方向直方图对象检测方法无疑会导致<strong class="it hj">图像识别和人脸检测领域的巨大进步。从增强现实工具到改善盲人的视力，这一领域可以对多个行业产生巨大影响。</strong></p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lx"><img src="../Images/e878584e0eff3d062b61d29a57508ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a0e6Spj7jCCYG8DMj0RKcw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">鸣谢:<a class="ae iq" href="https://news.microsoft.com/apac/features/a-new-way-to-give-driving-lessons-for-autonomous-vehicles/" rel="noopener ugc nofollow" target="_blank">微软新闻</a></figcaption></figure><p id="8d62" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我最感兴趣的应用是在自动驾驶汽车领域。计算机视觉有许多不同的方法来检测车辆和物体，所以没有多少公司在自动驾驶汽车上实现 HOG 是有道理的。我希望一些公司看到 HOG 的可行性，并在未来利用它。</p><p id="b32b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">网上解释如何使用 HOG 进行图像检测的资源并不多，所以如果你们都有兴趣获得关于 HOG 编码实现的未来文章，请在下面发表评论！</p><h1 id="3bb5" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">TL；速度三角形定位法(dead reckoning)</h1><ul class=""><li id="305e" class="ly lz hi it b iu lc iy ld jc ma jg mb jk mc jo md me mf mg bi translated">梯度方向直方图法(简称 HOG)用于目标检测和图像识别。</li><li id="bd01" class="ly lz hi it b iu mh iy mi jc mj jg mk jk ml jo md me mf mg bi translated">HOG 基于特征描述符，提取有用的信息，丢弃不必要的部分。</li><li id="af95" class="ly lz hi it b iu mh iy mi jc mj jg mk jk ml jo md me mf mg bi translated">HOG 计算每个单独像素的梯度幅度和方向的水平和垂直分量，然后将信息组织成 9-bin 直方图，以确定数据中的偏移。</li><li id="6a39" class="ly lz hi it b iu mh iy mi jc mj jg mk jk ml jo md me mf mg bi translated">可以进一步利用块归一化来使模型更加优化并且偏差更小。</li><li id="0d7f" class="ly lz hi it b iu mh iy mi jc mj jg mk jk ml jo md me mf mg bi translated">从自动驾驶汽车领域到 AR 和 VR 领域(大多是涉及图像检测的任何事情)，HOGs 都可以在任何地方使用。</li></ul><h1 id="3379" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">额外资源</h1><ul class=""><li id="e426" class="ly lz hi it b iu lc iy ld jc ma jg mb jk mc jo md me mf mg bi translated">文章:<a class="ae iq" href="https://www.learnopencv.com/histogram-of-oriented-gradients/" rel="noopener ugc nofollow" target="_blank">梯度方向直方图</a>(如果你想巩固你在本文中学到的概念，提供一个高层次的概述)</li><li id="71d1" class="ly lz hi it b iu mh iy mi jc mj jg mk jk ml jo md me mf mg bi translated">文章:<a class="ae iq" rel="noopener" href="/swlh/histogram-of-oriented-gradients-hog-for-multiclass-image-classification-and-image-recommendation-cf0ea2caaae8">用于多类图像分类和图像推荐的梯度方向直方图(HOG)</a>(如果你想看 HOG 的简单编码实现)</li><li id="4742" class="ly lz hi it b iu mh iy mi jc mj jg mk jk ml jo md me mf mg bi translated">研究论文:<a class="ae iq" href="https://ieeexplore.ieee.org/abstract/document/5547996" rel="noopener ugc nofollow" target="_blank">使用 HOG 特征进行粗略车辆定位的视觉分类</a>(如果你想看 HOG 在 AVs 中的应用)</li><li id="02d8" class="ly lz hi it b iu mh iy mi jc mj jg mk jk ml jo md me mf mg bi translated">视频:<a class="ae iq" href="https://www.youtube.com/watch?v=0Zib1YEE4LU" rel="noopener ugc nofollow" target="_blank">梯度方向直方图(HOG) </a>(如果你想要更直观而不是书面的解释)</li></ul></div><div class="ab cl mm mn gp mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="hb hc hd he hf"><p id="7be9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><em class="jp">嗨！我今年 16 岁，目前对机器学习和生物技术领域感兴趣。如果你有兴趣看到更多我的内容和我发布的内容，可以考虑订阅我的</em> <a class="ae iq" href="https://forms.gle/gdCammxd628UTQ9j9" rel="noopener ugc nofollow" target="_blank"> <em class="jp">简讯</em> </a> <em class="jp">！查看我的简讯</em> <a class="ae iq" href="https://preview.mailerlite.com/s8f3g8" rel="noopener ugc nofollow" target="_blank"> <em class="jp">这里</em> </a> <em class="jp">！还有，看看我的</em><a class="ae iq" href="https://www.linkedin.com/in/karthikmittal/" rel="noopener ugc nofollow" target="_blank"><em class="jp">LinkedIn</em></a><em class="jp">和</em><a class="ae iq" href="https://github.com/karthikm15" rel="noopener ugc nofollow" target="_blank"><em class="jp">Github</em></a><em class="jp">页面。如果你有兴趣谈论自动驾驶汽车或只是一般的技术，请使用我的</em> <a class="ae iq" href="https://calendly.com/karthikmittal306" rel="noopener ugc nofollow" target="_blank"> <em class="jp">日历</em> </a> <em class="jp">注册聊天。</em></p></div></div>    
</body>
</html>