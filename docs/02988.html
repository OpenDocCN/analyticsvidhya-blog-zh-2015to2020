<html>
<head>
<title>Crafting Recommendation Engine in PySpark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在PySpark中制作推荐引擎</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/crafting-recommendation-engine-in-pyspark-a7ca242ad40a?source=collection_archive---------3-----------------------#2020-01-11">https://medium.com/analytics-vidhya/crafting-recommendation-engine-in-pyspark-a7ca242ad40a?source=collection_archive---------3-----------------------#2020-01-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/963c0b150a60bc677393263d4020d604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v0ZshLu2efalM7Pf"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Jez Timms 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="3589" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di"> H </span> ello，</p><p id="cecc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在今天的网络时代，每个顾客都有多种选择。假设最近我想买一台经济实惠的笔记本电脑，却不知道该买什么。有可能会浪费大量的时间在互联网上浏览和浏览各种网站，希望找到一些有用的信息。我可能会寻求其他人的推荐。</p><p id="51f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据收集的快速增长导致了一个新的信息时代。数据被用来创建更高效的系统，这就是推荐系统发挥作用的地方。推荐系统是一种信息过滤系统，因为它们提高了搜索结果的质量，并提供了与搜索项目或用户的搜索历史更相关的项目。它们用于预测用户对某个项目的评分或偏好。像网飞和Spotify这样的公司，他们的业务和成功高度依赖于推荐引擎的有效性</p><p id="a878" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可能会有一些网站或网络应用程序根据我以前购买的笔记本电脑或我朋友的笔记本电脑向我推荐一些最好的笔记本电脑。我可以登录然后中大奖！我得到了符合我口味的被大力推荐的笔记本电脑。</p><p id="252b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是被推荐引擎利用的力量。从亚马逊到网飞，推荐引擎是机器学习最广泛使用的应用之一。</p><p id="e982" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个博客主要致力于推荐引擎的直观解释及其在PySpark中的实现。</p><blockquote class="kd"><p id="7c64" class="ke kf hi bd kg kh ki kj kk kl km js dx translated"><em class="kn">所以我们滚吧！</em></p></blockquote><blockquote class="ko kp kq"><p id="3b7f" class="iv iw kc ix b iy kr ja jb jc ks je jf kt ku ji jj kv kw jm jn kx ky jq jr js hb bi translated"><strong class="ix hj">推荐引擎</strong></p></blockquote><p id="578f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">推荐引擎更广为人知的名称是推荐系统，它是一种分析数据的工具，目的是为用户可能感兴趣的网站、广告横幅、产品提供建议。</p><p id="51f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">更简单地说，它基本上是一个根据用户的趋势或数据分析向用户推荐服务、产品和信息的系统。该数据可以是用户的历史或类似用户的行为。</em></p><p id="b79a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">推荐系统通过用户的体验、行为、偏好和兴趣为用户打开了接触整个数字世界的大门。这些系统还为亚马逊、沃尔玛等公司提供了一种高效的方式，为消费者提供<em class="kc">个性化信息</em>和<em class="kc">解决方案</em>。</p><blockquote class="ko kp kq"><p id="f634" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">推荐系统的优势</strong></p></blockquote><ul class=""><li id="60f9" class="kz la hi ix b iy iz jc jd jg lb jk lc jo ld js le lf lg lh bi translated">这些系统有助于提高组织的点击率和收入</li><li id="9c01" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated">推荐引擎对用户体验产生积极的影响，从而带来更高的客户满意度和保留率。</li><li id="b909" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated">例如，有了网飞，你不必浏览成千上万的盒子和电影名称，网飞为你提供了你可能喜欢的更窄的项目选择。该功能提供了更好的用户体验。这样，网飞实现了更低的取消率，每年为公司节省了大约10亿美元。</li><li id="4a37" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated">亚马逊在近20年前开始使用推荐系统，现在它已经被部署到其他行业，如金融和旅游。</li></ul><blockquote class="ko kp kq"><p id="bcd3" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">推荐系统的工作流程</strong></p></blockquote><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/0457b53449ab921b7161c5b3b694b2ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*hQAQ8s0-mHefYH83uDanGA.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:<a class="ae iu" href="https://upload.wikimedia.org/wikipedia/commons/5/52/Collaborative_filtering.gif" rel="noopener ugc nofollow" target="_blank">https://upload . wikimedia . org/Wikipedia/commons/5/52/Collaborative _ filtering . gif</a></figcaption></figure><p id="0ca0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基本上，推荐系统通过一种完全基于用户视角和浏览历史的过滤过程向特定用户提供建议。推荐系统的输入将是关于用户的信息，比如他的浏览历史、偏好和喜好。此信息反映了产品的先前使用情况以及指定的等级。他们还根据有多少用户喜欢来对产品和服务进行排名。它有助于对用户最喜欢的产品进行分类。在余弦相似度的帮助下，人们还可以发现不同产品之间有多相似。如果产品彼此非常相似，它们可能会吸引相同的用户。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/81604162b8d6db8a61e1e250c181efea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*OaYu8eTeBg51ANV7ScrQFw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">典型推荐引擎来源:【https://new.hindawi.com/journals/sp/2019/5941096/fig2/ T4】</figcaption></figure><p id="8568" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">主要有三种推荐系统:- </em></p><p id="7c91" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1)人口统计过滤</strong>——他们根据电影的受欢迎程度和/或类型，向每个用户提供综合推荐。系统向具有相似人口统计特征的用户推荐相同的电影。由于每个用户都是不同的，这种方法被认为太简单了。这个系统背后的基本思想是，更受欢迎和好评的电影将有更高的概率被普通观众喜欢。当我们打开手机上的某个应用程序时，它会要求访问我们的位置。基于我们的位置和周围的人，它会推荐我们可能喜欢的东西，这是任何应用程序中的一个基本推荐器。</p><p id="4418" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2)基于内容的过滤——他们根据一个特定的项目推荐相似的项目。该系统使用项目元数据，例如流派、导演、描述、演员等。对于电影，提出这些建议。这些推荐系统背后的一般思想是，如果一个人喜欢一个特定的项目，他或她也会喜欢与之相似的项目。这可以在网飞、Facebook Watch等应用中看到，它们根据导演、英雄等推荐下一部电影或视频。</p><p id="6390" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 3)协同过滤</strong>——该系统匹配具有相似兴趣的人，并基于该匹配提供推荐。协作过滤器不像基于内容的过滤器那样需要项目元数据。这是最复杂的个性化推荐，这意味着它考虑了用户喜欢什么和不喜欢什么。这方面的主要例子是谷歌广告。在协同过滤的保护伞下，我们有以下几种方法</p><ul class=""><li id="7cff" class="kz la hi ix b iy iz jc jd jg lb jk lc jo ld js le lf lg lh bi translated"><strong class="ix hj"> <em class="kc">基于记忆- </em> </strong> <em class="kc">它基本上识别用户的聚类，以便计算一个特定用户的</em> <strong class="ix hj"> <em class="kc"> </em> </strong> <em class="kc">交互来预测其他相似用户的交互。第二个思考过程是识别用户A评定的项目群，并预测用户与项目B的交互。基于记忆的方法在处理大型稀疏矩阵时会失败</em>。</li><li id="92ac" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><strong class="ix hj"> <em class="kc">基于模型- </em> </strong> <em class="kc">方法基本上围绕着ML和数据挖掘工具和技术展开。传统的机器学习方法用于训练模型并从中获得预测</em> <strong class="ix hj"> <em class="kc">。这些方法的一个优点是，与其他基于记忆的方法相比，它们能够向更多的用户推荐更多的项目。与基于记忆的方法相比，这些方法对于大型稀疏矩阵工作良好。</em></strong></li></ul><p id="5789" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3)混合系统- 整合两种类型的信息，目的是避免使用一种推荐系统时产生的问题。</p><blockquote class="kd"><p id="d2ee" class="ke kf hi bd kg kh ki kj kk kl km js dx translated">现在是理论实践的时候了！</p></blockquote><blockquote class="ko kp kq"><p id="59d1" class="iv iw kc ix b iy kr ja jb jc ks je jf kt ku ji jj kv kw jm jn kx ky jq jr js hb bi translated"><strong class="ix hj">用PySpark构建推荐引擎</strong></p></blockquote><p id="15bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据<a class="ae iu" href="https://spark.apache.org/docs/latest/" rel="noopener ugc nofollow" target="_blank">阿帕奇Spark </a>的官方文档-</p><blockquote class="kd"><p id="d1f9" class="ke kf hi bd kg kh ki kj kk kl km js dx translated">“Apache Spark是一个快速通用的集群计算系统。它提供了Java、Scala、Python和R的高级API，以及支持通用执行图的优化引擎。它还支持一套丰富的高级工具，包括用于SQL和结构化数据处理的<a class="ae iu" href="https://spark.apache.org/docs/latest/sql-programming-guide.html" rel="noopener ugc nofollow" target="_blank"> Spark SQL </a>，用于机器学习的<a class="ae iu" href="https://spark.apache.org/docs/latest/ml-guide.html" rel="noopener ugc nofollow" target="_blank"> MLlib </a>，用于图形处理的<a class="ae iu" href="https://spark.apache.org/docs/latest/graphx-programming-guide.html" rel="noopener ugc nofollow" target="_blank"> GraphX </a>，以及<a class="ae iu" href="https://spark.apache.org/docs/latest/streaming-programming-guide.html" rel="noopener ugc nofollow" target="_blank"> Spark Streaming </a></p></blockquote><p id="de4b" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg ku ji jj jk kw jm jn jo ky jq jr js hb bi translated">在高层次上，它是一个开源的大范围数据预处理引擎，具有自己的开发API，这些API具有分布式工作负载，用于完成需要重复访问数据集的流、机器学习或SQL工作负载。Spark的核心能力在于处理批处理和流作业。</p><p id="dba3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">基本上Apache Spark给用户提供的都是高级API，比如</em><a class="ae iu" href="https://spark.apache.org/docs/latest/api/java/index.html" rel="noopener ugc nofollow" target="_blank"><em class="kc">Java</em></a><em class="kc">、Scala、</em><a class="ae iu" href="https://spark.apache.org/docs/latest/api/python/index.html" rel="noopener ugc nofollow" target="_blank"><em class="kc">Python</em></a><em class="kc">和r .虽然Spark是用Scala写的，但还是提供了Scala、Java、Python，以及R. </em>中丰富的API</p><p id="e907" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我可以一整天都谈论Spark，因为它很棒，但这不在本博客的讨论范围之内。欲了解更多信息，请参考此<a class="ae iu" href="https://spark.apache.org/docs/latest/quick-start.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="bce2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们直接跳到使用MLib Spark Python API构建推荐引擎。</p><blockquote class="ko kp kq"><p id="9d3e" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">集成PySpark和Anaconda </strong></p></blockquote><p id="dc0b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当您在初始阶段设置Apache Spark时，这将有点棘手。这篇文章真的有助于快速初始化PySpark与Jupyter笔记本的集成。</p><blockquote class="ko kp kq"><p id="6bb3" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">数据集</strong></p></blockquote><p id="08db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了构建我们的推荐系统，我们使用了MovieLens数据集。你可以在这里 找到我们在推荐系统项目<a class="ae iu" href="https://github.com/shashwatwork/Building-Recommeder-System-in-PySpark/blob/master/movielens_ratings.csv" rel="noopener ugc nofollow" target="_blank"> <em class="kc">中使用过的movielens_rating.csv。该数据由应用于10329部电影的105339个评级组成。</em></a></p><blockquote class="ko kp kq"><p id="1db9" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">推荐系统的方法</strong></p></blockquote><p id="7e3b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用协作过滤，我们通过从许多用户(协作)收集偏好或品味信息来预测(过滤)用户的兴趣。潜在的假设是，如果用户A在一个问题上与用户B有相同的意见，A更有可能在不同的问题x上有B的意见，而不是随机选择用户对x的意见。</p><p id="0939" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">起初，人们会对不同的项目进行评分(比如视频、图片、游戏)。然后，系统预测用户对尚未评级的项目的评级。新的预测建立在与活动用户具有相似评级的其他用户的现有评级的基础上。</p><blockquote class="ko kp kq"><p id="b507" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">导入基本库</strong></p></blockquote><p id="1314" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了用PySpark构建机器学习模型，我们将使用以下软件包-</p><ul class=""><li id="6e2b" class="kz la hi ix b iy iz jc jd jg lb jk lc jo ld js le lf lg lh bi translated">find Spark-用于Jupyter笔记本与Spark的集成</li><li id="6425" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated">火花。任何Spark应用程序的会话入口点。</li><li id="88f2" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated">py spark . ml-py spark的机器学习API。</li><li id="0bbf" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated">熊猫-用于数据导入和EDA。</li></ul><p id="f7a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">对Spark Session感到困惑让我们分解一下py Spark . SQL . Spark Session(Spark context，jsparkSession=None) </em>用Dataset和DataFrame API编程Spark的入口点。SparkSession可用于创建数据帧、将数据帧注册为表、对表执行SQL、缓存表和读取parquet文件。为了创建Spark会话，请遵循以下构建模式</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><blockquote class="ko kp kq"><p id="95bc" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">检索数据&amp;数据预处理</strong></p></blockquote><p id="5848" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于Spark来说，2.x具有强大的内置加载能力。csv文件作为PySpark数据帧。我们将使用<em class="kc"> data.describe()。show() </em>函数显示关于spark数据帧的信息。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="758e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">输出截图:</em></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/fb1baec38498045fb2871ce94cf0540d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*TPdK4-iHP6LvEZIIqU-IIg.png"/></div></figure><p id="e7ce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以做一个分割来评估我们的模型表现如何，但是请记住，很难确切地知道一个推荐系统对于某些主题的实际效果如何。特别是如果涉及到主观性，例如，不是每个喜欢《星球大战》的人都会喜欢《星际迷航》,即使推荐系统可能会建议不是这样。</p><p id="f768" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">由于我们使用较小的数据集，因此80:20的列车分割对于我们的用例来说足够了。</em></p><pre class="lo lp lq lr fd lw lx ly lz aw ma bi"><span id="8964" class="mb mc hi lx b fi md me l mf mg">(training, test) = data.randomSplit([0.8, 0.2])</span></pre><blockquote class="ko kp kq"><p id="6635" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">对训练数据使用ALS构建推荐模型</strong></p></blockquote><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/5bb089abe56b0372aae982694ac261d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*TTiUqlO5e0gAn_8Xl6vUbw.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:<a class="ae iu" href="https://towardsdatascience.com/learning-how-recommendation-system-recommends-45ad8a941a5a" rel="noopener" target="_blank">https://towards data science . com/learning-how-recommendation-system-recommended-45 ad8 a 941 a 5a</a></figcaption></figure><p id="2afa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Spark提供了一个机器学习算法MLib。Spark MLib算法旨在提供具有可扩展性和易用性的实用机器学习。以下是一些与spark机器学习库相关的术语-</p><ul class=""><li id="8d4b" class="kz la hi ix b iy iz jc jd jg lb jk lc jo ld js le lf lg lh bi translated"><strong class="ix hj">提取:</strong>从“原始”数据中提取特征。</li><li id="44a7" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><strong class="ix hj">转换</strong>:缩放、转换或修改特征。</li><li id="4104" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><strong class="ix hj">选择</strong>:选择较大特征集合的子集。</li><li id="6f3d" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><strong class="ix hj">位置敏感散列(LSH) </strong>:这类算法结合了特征转换和其他算法的各个方面。</li></ul><p id="6c1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用于机器学习的Spark MLlib库通过使用交替最小二乘法来提供协同过滤实现。MLlib中的实现具有以下参数:</p><ul class=""><li id="2ab8" class="kz la hi ix b iy iz jc jd jg lb jk lc jo ld js le lf lg lh bi translated"><em class="kc"> numBlocks </em>是用于并行计算的块数(设置为-1自动配置)。</li><li id="463b" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><em class="kc"> rank </em>是模型中潜在因素的个数。</li><li id="9cc5" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><em class="kc">迭代</em>是要运行的迭代次数。</li><li id="fac5" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><em class="kc">λ</em>指定ALS中的正则化参数。</li><li id="7231" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><em class="kc"> implicitPrefs </em>指定是使用显式反馈ALS变量还是适用于隐式反馈数据的变量。</li><li id="6f86" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><em class="kc"> alpha </em>是一个适用于ALS隐式反馈变量的参数，该变量控制偏好观察中的基线置信度。</li></ul><p id="0a2b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，让我们构建ALS模型，并用由<em class="kc"> randomsplit() </em>函数创建的训练特征来拟合该模型。</p><p id="fd71" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">此处需要注意的一点是，我没有使用冷启动策略，该策略用于确保我们不会获得NaN评估指标。</em></p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="1e4b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">答对了！！！我们的模型现在是适合的，下一步将从适合的交替最小二乘模型生成推荐或预测。</p><blockquote class="ko kp kq"><p id="7f22" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">生成预测&amp;模型评估</strong></p></blockquote><p id="4dfb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在成功执行spark作业之后，是时候使用内置的转换函数来评估构建模型了。这个函数或多或少类似于传统机器学习算法(Sklearn)中的predict()函数。然而，transform()函数转换输入的测试数据或看不见的数据，以便生成预测。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="7119" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">输出截图</em></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/64e0de0d8e2d2e97aff9a8142284e6ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*ckdAa-UqiYoCUU44rvr1ig.png"/></div></figure><p id="889f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">评估模型是建立有效的机器学习模型的核心部分。在PySpark中，我们将使用<em class="kc"> RMSE(均方根误差)</em>作为我们的评估指标。</p><p id="a8d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">RMSE在评级栏中描述了我们的错误。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="765e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么接下来我们还没有为我们的用户获得电影推荐。我们现在就开始吧！</p><blockquote class="ko kp kq"><p id="e127" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">推荐患有ALS的电影</strong></p></blockquote><p id="a835" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有了模型，你将如何向用户提供推荐呢？</p><p id="6ad7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里的方法很简单，我们将采用单个用户id example11作为特征，并将其传递给经过训练的ALS模型。就像我们处理测试数据一样！</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="cc75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">输出截图</em></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/0890664469cf04e59d29e2e0f8023747.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*gn6Ihs7At7JilpAqPkIUFA.png"/></div></figure><p id="3b1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将使用<em class="kc"> model.transform() </em>函数来生成推荐电影及其预测特征。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="68c6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">输出截图</em></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/2c59e13eea897f2a025f345c7557787f.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*fTiv7fXwsl0GzCjmpuIYig.png"/></div></figure><blockquote class="ko kp kq"><p id="d146" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">结束注释</strong></p></blockquote><p id="dc92" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从使用案例中，我们观察到在您当前的系统中包含一个推荐将是有效的和有吸引力的，因为它增强了体验以吸引更多的客户参与。从商业的角度来看，它创造了巨大的收入。此外，推荐系统完全依赖于商业目标。</p><p id="1f60" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc"> PySpark无疑拥有强大的机器学习API，并且在不断发展。我强烈建议您将此Collabaortave filtering与其他</em> <a class="ae iu" href="https://gist.github.com/entaroadun/1653794" rel="noopener ugc nofollow" target="_blank"> <em class="kc">推荐引擎</em> </a> <em class="kc"> </em> <a class="ae iu" href="https://gist.github.com/entaroadun/1653794" rel="noopener ugc nofollow" target="_blank"> <em class="kc">数据集</em> </a> <em class="kc">一起使用。坚持练习，坚持学习！</em></p><p id="f225" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">我的</em><a class="ae iu" href="https://github.com/shashwatwork/Building-Recommeder-System-in-PySpark" rel="noopener ugc nofollow" target="_blank"><em class="kc">GitHub</em></a><em class="kc">上有这个项目使用的完整代码和数据集。</em></p><blockquote class="ko kp kq"><p id="539d" class="iv iw kc ix b iy iz ja jb jc jd je jf kt jh ji jj kv jl jm jn kx jp jq jr js hb bi translated"><strong class="ix hj">参考文献</strong></p></blockquote><ul class=""><li id="9b30" class="kz la hi ix b iy iz jc jd jg lb jk lc jo ld js le lf lg lh bi translated"><a class="ae iu" href="https://spark.apache.org/docs/latest/ml-collaborative-filtering.html" rel="noopener ugc nofollow" target="_blank">https://spark . Apache . org/docs/latest/ml-collaborative-filtering . html</a></li><li id="ccca" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><a class="ae iu" href="https://spark.apache.org/docs/latest/ml-guide.html" rel="noopener ugc nofollow" target="_blank">https://spark.apache.org/docs/latest/ml-guide.html</a></li><li id="aa65" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><a class="ae iu" href="https://tryolabs.com/blog/introduction-to-recommender-systems/" rel="noopener ugc nofollow" target="_blank">https://tryo labs . com/blog/introduction-to-recommender-systems/</a></li><li id="8ef6" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><a class="ae iu" href="https://towardsdatascience.com/learning-how-recommendation-system-recommends-45ad8a941a5a" rel="noopener" target="_blank">https://towards data science . com/learning-how-recommendation-system-recommended-45 ad8 a 941 a 5a</a></li><li id="7a4c" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><a class="ae iu" href="https://spark.apache.org/docs/latest/api/python/pyspark.ml.html" rel="noopener ugc nofollow" target="_blank">https://spark . Apache . org/docs/latest/API/python/py spark . ml . html</a></li><li id="f3d5" class="kz la hi ix b iy li jc lj jg lk jk ll jo lm js le lf lg lh bi translated"><a class="ae iu" href="https://www.analyticsvidhya.com/blog/2018/06/comprehensive-guide-recommendation-engine-python/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2018/06/comprehensive-guide-recommendation-engine-python/</a></li></ul><p id="f498" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你喜欢这个帖子，请关注我。如果你注意到思维方式、公式、动画或代码有任何错误，请告诉我。</p><p id="e113" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc">干杯！</em></p></div></div>    
</body>
</html>