<html>
<head>
<title>.NET Core, Dependency Injection and Inversion of Control (IoC)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">。NET核心、依赖注入和控制反转(IoC)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/net-core-dependency-injection-and-inversion-of-control-ioc-42f598326a8b?source=collection_archive---------13-----------------------#2020-04-15">https://medium.com/analytics-vidhya/net-core-dependency-injection-and-inversion-of-control-ioc-42f598326a8b?source=collection_archive---------13-----------------------#2020-04-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4a1ff9d697fcde4244683b6706e409b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mWFQKBztTkPSYEUfVZBIfg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://codinginfinite.com/wp-content/uploads/2019/01/net-core-love.jpg" rel="noopener ugc nofollow" target="_blank">https://coding infinite . com/WP-content/uploads/2019/01/net-core-love . jpg</a></figcaption></figure><p id="322e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated">设计模式是为了帮助软件工程师写出更好的代码。当我们说更好的时候，这意味着更容易测试，应该有关注点的分离，当然它是有逻辑的(是的，当然软件中的一切都是有逻辑的)！</p><p id="4fff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最近我一直在研究。网芯。我有构建RESTFul应用程序的背景。。NET Core似乎偏离了传统的ASP.NET MVC开发模式。我非常喜欢它，用咖啡不停地编码，直到我卡在一个点上:<strong class="ix hj">依赖注入</strong>！</p><p id="545a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们首先理解代码结构。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/88ef529e0c9585cab9ec12f4c306d06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXVEf3Cmz8IoPo31Q-8nQw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">API中的控制流和数据流</figcaption></figure><blockquote class="kh ki kj"><p id="9a6a" class="iv iw kk ix b iy iz ja jb jc jd je jf kl jh ji jj km jl jm jn kn jp jq jr js hb bi translated">我们使用MVC模式来控制应用程序。收到任何请求后，<strong class="ix hj">控制器</strong>验证请求的真实性，然后移交给<strong class="ix hj">服务层</strong>。这一层执行所有的业务逻辑。如果需要从数据库中获取/检索/存储/更新数据，该层调用<strong class="ix hj"> DB层</strong>。我们也可以将这个DB层称为<strong class="ix hj">模型层</strong>。现在控制器不能直接访问数据库，同样服务层(业务逻辑)也不能直接访问数据库。这是关注点分离的一个方面。</p></blockquote><h1 id="b39f" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">那么有什么问题呢</h1><p id="bc02" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">英寸NET Core有一个名为<strong class="ix hj"> DBContext </strong>的类，主要负责执行数据库操作。如果搭建数据库，DBContext将与模型类一起创建。DBContext是在Startup.cs类期间注入到IServices中的。现在，因为WebAPI是从模型项目中分离出来的，我们需要将模型引用到WebAPI项目中。这不是理想的解决方案，因为我们想要实现关注点的分离。</p></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><h1 id="02fe" class="ko kp hi bd kq kr ly kt ku kv lz kx ky kz ma lb lc ld mb lf lg lh mc lj lk ll bi translated"><strong class="ak">所以让我们反转控制</strong></h1><p id="5b43" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">IoC或控制反转基本上是一种改变控制流的设计模式。说你午餐需要做饭。但是你很累或者很懒或者像我一样你不知道怎么做饭！！因此，你实际上不是为自己准备午餐，而是雇佣任何厨师来做午餐。换句话说，你实际上把控制权从你自己手中转到了厨师手中。很酷不是吗？</p><blockquote class="kh ki kj"><p id="2b07" class="iv iw kk ix b iy iz ja jb jc jd je jf kl jh ji jj km jl jm jn kn jp jq jr js hb bi translated">因此，在我们的项目结构中，我们引入了一个新项目。你可以叫它IoC，Helper，Referer，随你喜欢。现在，IoC项目实际上可以保留模型和服务层的引用。但控制器应仅包含国际奥委会项目的参考。要注入任何依赖关系，控制器应调用IoC项目中的任何指定方法，并将其IServices对象作为参数传递。IoC现在可以将DBContext的引用添加到IServices对象。换句话说，不是API做注射，而是它把这项特殊的工作交给IoC项目，就像你付钱让厨师给你做薯条，而不是油炸你自己。</p></blockquote><p id="a6af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们已经实现了项目关注点的分离和。NET核心的简单方法是应用一个简单的设计模式，叫做:<strong class="ix hj">控制反转</strong>！</p><p id="11a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在IoC项目中，我们创建了一个名为<strong class="ix hj"> RegisterServices </strong>的静态方法。<strong class="ix hj"> </strong>该方法接受注册数据库上下文的IServiceCollection对象。可以使用该对象注册其他服务。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/b4155a2e3b9ea83e684c915068410e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVPLV1iHzuekNUmUB6zNTw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在IoC中注册类以注册DbContext</figcaption></figure><p id="0024" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在这个方法在Startup.cs文件中被调用，我们将IServiceCollection对象作为参数传递。因为该方法是静态的，所以我们不需要创建Register类的实例(IoC项目)</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/df9304e425385ae517b6ad247349f0d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YV-r5PkirO4EDNroEuyuUA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Startup.cs</figcaption></figure><p id="fe54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是这个流程的示意图。请注意，控制反转只改变控制流，而不改变数据流。这是因为控制模式的反转试图在不改变数据流的情况下分离类结构。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/bae5e82ac4eaffe237859c925797f3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*ntKRKZ2FP09JgUyjXdjh4A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">控制反转(IoC)项目介绍</figcaption></figure><p id="c7ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在我的<a class="ae iu" href="https://github.com/umairk83/IoC-and-DependencyInjection" rel="noopener ugc nofollow" target="_blank"> GitHub </a>库找到完整的代码。请随意使用代码。如果你喜欢这个，请分享并关注我更多精彩的文章。下次再见，感谢阅读并享受编码…</p></div></div>    
</body>
</html>