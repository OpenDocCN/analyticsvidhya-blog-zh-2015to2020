<html>
<head>
<title>WHEN and WHY are batches used in machine learning ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中什么时候用批次，为什么用批次？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/when-and-why-are-batches-used-in-machine-learning-acda4eb00763?source=collection_archive---------2-----------------------#2019-11-19">https://medium.com/analytics-vidhya/when-and-why-are-batches-used-in-machine-learning-acda4eb00763?source=collection_archive---------2-----------------------#2019-11-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f799" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">机器学习数据集中批次的本质细节</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/1699b2ba12c44672bcca8b2e25d8611d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E4_zIg6joS_aIpmOenkV6w.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">数据</figcaption></figure><h2 id="921a" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">介绍</h2><p id="cefb" class="pw-post-body-paragraph kl km hi kn b ko kp ij kq kr ks im kt jy ku kv kw kc kx ky kz kg la lb lc ld hb bi translated">嘿，你在加载数据集的时候有没有碰到过“批处理”这个术语？</p><p id="bed9" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">不管答案是肯定的还是否定的，今天你将学习批处理，以及为什么你应该考虑在你的机器学习管道中使用它。</p><p id="b05d" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">不要再拖延了，让我们马上开始吧。</p><p id="2022" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">嗯，这个肯定要通过一个例子来说明。</p><p id="5c3a" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">抓紧了，你的故事来了—</p><p id="a4c0" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">你有一个绝妙的想法，要建立一个深度学习模型，从MRI扫描中检测脑瘤和其他大脑异常。</p><p id="0c05" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">创建一家创业公司似乎是个好主意，对吧？</p><p id="91c9" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">第一件事是收集所需的数据，现在假设您已经完成了这项工作，现在您已经准备好了数据。</p><p id="ef51" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">现在是了解什么是“批”的时候了。</p><h2 id="b19d" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">何时以及为什么使用批处理？</h2><p id="b9da" class="pw-post-body-paragraph kl km hi kn b ko kp ij kq kr ks im kt jy ku kv kw kc kx ky kz kg la lb lc ld hb bi translated">在将数据集加载到内存之前，我们有两种选择-</p><p id="fce0" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">1.您可以一次将整个数据集加载到内存中，也可以</p><p id="cf9d" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">2.你可以把一组样本数据装入存储器</p><p id="b705" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">什么都不明白，对吧？让我给你分析一下。</p><p id="df0c" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">如前所述，你刚刚开始建立你的梦想创业，所以你可能没有高端的GPU或CPU。</p><p id="8288" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">你可能有一个巨大的数据集，比如说，一百万张大脑扫描图像。因此，如果您将整个数据集加载到内存中，模型的训练速度将会非常慢，因为您在CPU中使用了大量内存，这是非常低效的。</p><p id="c38d" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">伙计们，别灰心，有更好的方法适合你们。</p><p id="041a" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">你可以把你的数据集分成几批，也就是说，如果你有一个包含10个大脑扫描图像的数据集，你可以把你的数据集分成两批，每批有5个图像，</p><p id="ea99" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">图像总数= 10</p><p id="7fd0" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">1批= 5张图像</p><p id="a19d" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">所以，一共两批。</p><p id="206c" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">(批数*单批图像数=数据集总数)=&gt; (2 * 5 = 10)。</p><p id="3e26" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">这个孩子的游戏玩够了，让我们变得更大，如果你有一个包含100000个图像的大脑扫描图像数据集，我们可以将其转换为3125个批次，其中每个批次有32个图像。</p><p id="87ce" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">图像总数= 100000</p><p id="5f8f" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">1批= 32张图像</p><p id="9613" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">所以，一共3125批，(3125 * 32 = 100000)。</p><p id="455e" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">因此，与将全部100000幅图像加载到内存中(这对计算机来说太昂贵了)相比，您可以加载32幅图像(1批)3125次，与加载完整的数据集相比，这需要更少的内存。</p><p id="08ea" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">你应该考虑使用批处理的另一个原因是，当你训练你的深度学习模型而不分割成批处理时，那么你的深度学习算法(可能是神经网络)必须在存储器中存储所有那些100000个图像的误差值，这将导致训练速度大大降低。</p><p id="3104" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">该模型仅在通过整个数据集之后更新超参数(权重和偏差)。</p><p id="f708" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">但是，如果您将100000个图像数据集分成包含32个图像的批，则模型只需存储这32个图像的误差值。</p><p id="e397" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">这里，模型在完成每一批后更新超参数。</p><p id="a6b7" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">每32张图像(1批)后，将更新hyper参数。</p><h2 id="cc9c" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">基于批量大小的不同梯度下降算法</h2><p id="eeba" class="pw-post-body-paragraph kl km hi kn b ko kp ij kq kr ks im kt jy ku kv kw kc kx ky kz kg la lb lc ld hb bi translated">根据批量大小，有3种梯度下降算法:</p><ol class=""><li id="e781" class="lj lk hi kn b ko le kr lf jy ll kc lm kg ln ld lo lp lq lr bi translated">随机梯度下降</li></ol><p id="8d16" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">这里，每个数据集行被认为是一个批次，也就是说，如果您有一个包含1000个图像的数据集，那么每个图像是一个批次(总共1000个批次)，因此像权重和偏差这样的超参数在数据集的每一行之后被更新。</p><p id="f453" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">2.批量梯度下降算法</p><p id="6193" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">在该算法中，整个数据集被视为一个批次，对于1000个图像数据集，只有一个批次，有1000个数据(即数据集中的总行数)。</p><p id="3d62" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">3.小批量梯度下降</p><p id="156a" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">在该算法中，批量的大小大于1且小于数据集的总大小，常用的批量大小为32(单个批量中32个数据点)。</p><p id="67f6" class="pw-post-body-paragraph kl km hi kn b ko le ij kq kr lf im kt jy lg kv kw kc lh ky kz kg li lb lc ld hb bi translated">如果您将所有数据打包在一个批次中，这称为批次梯度下降，如果批次数量等于数据集中的数据点数量，则称为随机梯度下降。最后，如果批数介于1和数据集中的数据点总数之间，则称为最小批梯度下降。</p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h2 id="850e" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">结论</h2><p id="c4ae" class="pw-post-body-paragraph kl km hi kn b ko kp ij kq kr ks im kt jy ku kv kw kc kx ky kz kg la lb lc ld hb bi translated">你必须对批处理有完整的概念，并且你必须能够回答批处理的时间和原因。因此，下次当您加载数据集时，在训练您的模型之前请三思:)</p></div></div>    
</body>
</html>