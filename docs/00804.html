<html>
<head>
<title>Unsupervised Learning — K-means and Hierarchical Clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无监督学习——K-均值和层次聚类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-scaling-and-unsupervised-learning-b254054cbd3d?source=collection_archive---------3-----------------------#2019-09-09">https://medium.com/analytics-vidhya/data-scaling-and-unsupervised-learning-b254054cbd3d?source=collection_archive---------3-----------------------#2019-09-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1db0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用鸢尾物种识别问题来演示无监督学习技术。这篇文章不是提供问题的解决方案，而是向你展示特征工程和数据缩放对不同的聚类方法有什么影响。</p><h2 id="017a" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">关于数据集</h2><p id="2770" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">鸢尾花数据集是一个只有150行的小数据集(3种鸢尾花各50行:setosa、versicolor和virginica)。物种由4个特征定义:<em class="kd">萼片宽度</em>、<em class="kd">萼片长度</em>、<em class="kd">花瓣宽度</em>和<em class="kd">花瓣长度</em>。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ke"><img src="../Images/7425d335e92cbc88b47c94478b951309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2b9TA6i27eGjeDQE9qUaEg.png"/></div></div></figure><div class="kf kg kh ki fd ab cb"><figure class="kq kj kr ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/a4eb89721edff7f03c1db15308946f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*Um6tA0NLF5KM4pdF32uR8Q.png"/></div></figure><figure class="kq kj kw ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/6175974d7ada0d44e93da2b76f14a52d.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*oJkSF1DrC_k91I1n8doAVg.png"/></div></figure><figure class="kq kj kx ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/45bfdc888c554f60340ba1affb73ecef.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*E8nK5s8usNWU1DLyHA10rQ.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx lc di ld le translated"><strong class="bd jf">三种花卉的分布指标</strong></figcaption></figure></div></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h2 id="0dcc" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">数据分析和特征工程</h2><p id="bf69" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">萼片长度和萼片宽度具有某种正态分布，但花瓣长度和花瓣宽度不遵循高斯分布。所以，我按物种划分了这些特征，看看这些特征是如何在不同物种中分布的。</p><div class="kf kg kh ki fd ab cb"><figure class="kq kj lm ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/299883101838806a39d920328930c64a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*oUTuqgLpFZtsYs9J47lZgw.png"/></div></figure><figure class="kq kj ln ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/74ded205737776f0affafb1832215215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*qVmpK8yJj5lsIXpjPdhh6w.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx lo di lp le translated"><strong class="bd jf">所有特征的频率分布——萼片长度、萼片宽度、花瓣长度、花瓣宽度</strong></figcaption></figure></div><p id="a728" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从配对图中可以看出，刚毛鸢尾的花瓣长度和花瓣宽度与其他两个物种明显不同，这导致了与正态分布的偏差。这也是为什么花瓣长度和花瓣宽度与花的种类(种)具有如此高的相关性，而萼片宽度与种类负相关的原因(参见下面的相关矩阵)。此外，使用任何一对特征都可以将刚毛藻与其他两个物种区分开来。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div class="er es lq"><img src="../Images/c13eee33390be77934e60bc556623325.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*7w6K3vepucNgXzqdXu0mSw.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx translated"><strong class="bd jf">关联热图</strong></figcaption></figure><p id="7a7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，对于所有的特征对组合，杂色和海滨锦鸡儿没有明显的边界。因此，我设计了两个新的特征:萼片区域和花瓣区域，看看这些特征是否有助于区分物种。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es lr"><img src="../Images/5d1ad17d1f422106ccd3104c57fd9ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zTL0lWXtpB32nArJD5KhrA.png"/></div></div></figure><p id="a854" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而且，似乎由于这两个新的特征，物种之间的区别与以前相比确实增加了，但集群仍然不是完全不同的。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><p id="1992" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在来模拟这些集群。但是，在我们进行算法训练之前，需要对数据进行缩放，以照顾到:</p><ul class=""><li id="6b0d" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc lx ly lz ma bi translated">鸢尾所有特征的显著不同的数据范围</li><li id="c18d" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">萼片面积和花瓣面积是不同的单位(平方公制单位),这使得它的值也比长度和宽度大得多</li></ul><h2 id="740a" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">数据缩放</h2><p id="b940" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">我使用的两种缩放技术是:</p><ol class=""><li id="58a3" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc mg ly lz ma bi translated"><strong class="ih hj">标准化— </strong>标准化是指减去一个位置度量值，再除以一个尺度度量值，从而得到一个均值为0、标准差为1的“标准正态”随机变量。标准化假设您的数据正态分布在每个要素中。通过“移除平均值并缩放至单位方差”，您可以在图片中看到，无论原始值是多少，现在它们都具有相同的“比例”。它按列工作。</li><li id="091f" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc mg ly lz ma bi translated"><strong class="ih hj">归一化— </strong>表示除以向量的范数。它还经常指通过向量的最小值和范围进行重新调整，使所有元素位于0和1之间，从而使数据集中所有数值列的值达到一个通用的范围。当特性具有不同的范围时(就像我们的例子一样)，这是最有必要的。它按行工作。</li></ol></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><p id="ed8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用了两种无监督学习技术来形成聚类:K-means和凝聚层次聚类。</p><h2 id="8760" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">k均值聚类</h2><p id="3681" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">K-means聚类是一种无监督学习方法，其中观察值被划分为指定数量的非重叠聚类。这是通过首先决定簇的数量=‘K’(<strong class="ih hj">这里k=3并且是预先决定的</strong>)来执行的。</p><p id="b7da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后将每个观察值分配给这K个聚类中的一个。这里的成本函数是所有K个聚类的聚类内变化的总和，我们的目标是使其最小化。简而言之，K-mean算法首先将观察值随机分配给任何K-聚类。然后计算每个聚类的质心。质心是该特定聚类中所有观测值的p个特征的平均值的向量。然后，它将观察值重新分配给质心最接近该特定观察值的聚类。当结果不再改变时，这就停止了。目标是:</p><ul class=""><li id="81ca" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc lx ly lz ma bi translated">最小化聚类中所有观测值与其质心的距离，以及</li><li id="057f" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">最大化所有质心之间的距离</li></ul><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es lr"><img src="../Images/5d1ad17d1f422106ccd3104c57fd9ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zTL0lWXtpB32nArJD5KhrA.png"/></div></div></figure><p id="d625" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于虹膜数据集，我们没有得到非重叠聚类作为k-means算法的输出。数据标准化后，重叠进一步增加(参见下表)。不过，通过对要素进行归一化，可以在一定程度上解决重叠问题，因为它解决了数据范围和要素间不同测量单位的变化问题。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es mh"><img src="../Images/792a4258c5c1f8491c1a5e441713a9e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yoWpUf88Xklha2rsP1QYtQ.png"/></div></div></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h2 id="eb47" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">凝聚层次聚类</h2><p id="8bd9" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">凝聚聚类是最常见的层次聚类类型，用于根据相似性将对象分组到聚类中。它也被称为<em class="kd">艾格尼丝</em> ( <em class="kd">集聚嵌套</em>)。该算法首先将每个对象视为一个单独的集群。接下来，成对的聚类被连续地合并，直到所有的聚类被合并成一个包含所有对象的大聚类。该算法适用于可能有也可能没有重叠聚类的数据。分层聚类的局限性:</p><ol class=""><li id="6127" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc mg ly lz ma bi translated">分层聚类没有数学目标。</li><li id="3e6d" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc mg ly lz ma bi translated">层次聚类的高空间和时间复杂度。因此，当我们有大量数据时，不能使用这种聚类算法。</li></ol><p id="d978" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为iris数据集非常小(只有150行),所以运行这个算法不成问题。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es lr"><img src="../Images/5d1ad17d1f422106ccd3104c57fd9ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zTL0lWXtpB32nArJD5KhrA.png"/></div></div></figure><p id="2c1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们看到，尽管聚类有重叠(特别是萼片面积对萼片长度和萼片宽度)，但该模型的准确性相当好(参见下表)。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es mi"><img src="../Images/0bf65f5dfc4ddb34cae0567f61fc74f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxcL8OU-qQsqJu0696kmDg.png"/></div></div></figure><div class="mj mk ez fb ml mm"><a href="https://github.com/surbhigupt/iris_flower_identity/blob/master/Iris%20Classification%20-%20Unsupervised%20learning%20%28clustering%29.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">surbhigup/iris _ flower _ identity</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">github.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ko mm"/></div></div></a></div></div></div>    
</body>
</html>