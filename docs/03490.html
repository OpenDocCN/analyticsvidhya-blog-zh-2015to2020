<html>
<head>
<title>Capital Bike Share Demand Prediction using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习的首都自行车份额需求预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/capital-bike-share-demand-prediction-using-machine-learning-3c6c2c958e82?source=collection_archive---------6-----------------------#2020-02-04">https://medium.com/analytics-vidhya/capital-bike-share-demand-prediction-using-machine-learning-3c6c2c958e82?source=collection_archive---------6-----------------------#2020-02-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fb626df66ae59575fc2a66be13244d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jQKnd1ibriKp9Mza.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">首都自行车共享站。本·舒明的图片在许可下分发<a class="ae iu" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by-sa/3.0/deed.en</a></figcaption></figure><p id="65cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用机器学习来预测事件非常流行。这个概念有很多应用。我们希望预测天气以做好最坏的准备，我们希望预测股票以赚更多的钱，企业希望预测销售以便他们可以专注于大局。所有这些都可以使用机器学习来完成。</p><p id="4386" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这项研究中，让我们讨论如何使用一种叫做长短期记忆(LSTM)模型的特殊神经网络来预测自行车共享需求。</p><h1 id="9a0e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据:</h1><p id="6019" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">对于这个任务，我使用了位于<a class="ae iu" href="https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset" rel="noopener ugc nofollow" target="_blank">的自行车共享数据集https://archive . ics . UCI . edu/ml/datasets/Bike+Sharing+dataset</a>。该数据集包含华盛顿大都市区的自行车共享数据。数据集包含温度、风速、星期几、小时、假期等参数，以及显示一小时内自行车出行次数的“计数”参数。</p><div class="kw kx ez fb ky kz"><a href="https://www.datadriveninvestor.com/2019/02/08/machine-learning-in-finance/" rel="noopener  ugc nofollow" target="_blank"><div class="la ab dw"><div class="lb ab lc cl cj ld"><h2 class="bd hj fi z dy le ea eb lf ed ef hh bi translated">金融领域的机器学习|数据驱动的投资者</h2><div class="lg l"><h3 class="bd b fi z dy le ea eb lf ed ef dx translated">在我们讲述一些机器学习金融应用之前，我们先来了解一下什么是机器学习。机器…</h3></div><div class="lh l"><p class="bd b fp z dy le ea eb lf ed ef dx translated">www.datadriveninvestor.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln io kz"/></div></div></a></div><p id="3d0b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们处理数据之前，最好先想象一下数据显示的趋势。例如，出于本能，人们会想比较工作日和周末的自行车共享需求。图1显示了2011年2月7日至11日工作日(周一至周五)的自行车共享每小时需求。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/a86a959f92071d5fc8b81204148cfbd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*rHEr-uQUXnKkT0kLb3JI6w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图一。2011年2月7日至11日工作日的每小时自行车份额计数</figcaption></figure><p id="d71a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很明显，工作日早上6点到10点和下午4点到7点的自行车共享活动有所增加，中午略有增加，这是可以理解的，因为这是办公/上学高峰时间，而中午是午餐时间。因此，自行车份额需求在这些时候很高。</p><p id="c740" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下图2显示了2011年2月12日和13日周末周六和周日的自行车份额需求。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/c5e7b95be9c68dc5fb31ccfc2d98bb0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*jzdAVE2mLgBeBW5eDTct-w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图二。2011年2月12日和13日周末(周六和周日)的自行车份额需求</figcaption></figure><p id="5769" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从图2可以明显看出，自行车共享需求从早上6点到下午2点增加，然后减少。可以观察到，周末自行车共享需求没有工作日数据显示的两个高峰，这两个高峰可能显示人们在早上使用自行车共享，在户外享受和下午2点后需求下降。</p><p id="cd82" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">图3显示了每月的需求计数。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/1bfd48daf9e6175af9825bd2a80bebd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*gwRZkjy929IYwoG2-QIXhw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3。每月自行车共享需求的箱线图</figcaption></figure><p id="b6f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">据观察，当天气不冷时，自行车份额需求较高，因为1月(1)、2月(2)和12月(12)似乎比一年中的其他月份需求相对较少。</p><p id="5205" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们转到预处理部分，为机器学习模型准备数据。</p><h1 id="136d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">预处理:</h1><p id="7da1" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">对于预处理，我首先删除分析不需要的列，即</p><ol class=""><li id="c4f9" class="lv lw hi ix b iy iz jc jd jg lx jk ly jo lz js ma mb mc md bi translated">随意(有多少用户随意使用自行车共享)</li><li id="a194" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">已注册(有多少注册用户使用自行车共享)</li><li id="5217" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">工作日(星期几)</li><li id="c1f6" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">即时(数据记录的序列号)</li><li id="be6f" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">归一化温度</li></ol><p id="c048" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">删除这些列后，我们的数据中只剩下以下几列，如图4所示:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/647e322deff7d9ea7b3a1dad55b5f3a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*xDFit6bd5aQKLH9ef-1NEg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4。删除不相关的列后的一瞥</figcaption></figure><p id="3478" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里</p><ol class=""><li id="d918" class="lv lw hi ix b iy iz jc jd jg lx jk ly jo lz js ma mb mc md bi translated">季节有4个不同的值1 =春天，2 =夏天，3 =秋天，4 =冬天</li><li id="2c35" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">假日(0或1)-是否将该日视为假日</li><li id="acc8" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">工作日(0或1)-这一天既不是周末也不是假日</li><li id="0eaa" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">天气有4个截然不同的数值1:晴、少云、部分多云、部分多云<br/> 2:雾+多云、雾+碎云、雾+少云、雾<br/> 3:小雪、小雨+雷雨+散云、小雨+散云<br/> 4:大雨+冰托盘+雷雨+雾、雪+雾</li><li id="b62d" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">temp —以摄氏度为单位的温度</li><li id="6c1a" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">湿度—相对湿度</li><li id="5d52" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">风速——风速</li><li id="74e8" class="lv lw hi ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">cnt —每小时自行车共享数</li></ol><p id="c37b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">缩放数据</strong></p><p id="d7fe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于湿度、风速和温度是连续值，我们使用scikit-learn的标准定标器来定标每一列，使平均值为0，标准偏差为1。原因是，如果值经过缩放或归一化，机器学习算法的性能会很好。我们对“cnt”自行车份额需求列进行了同样的操作。</p><p id="aa92" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">创建数据序列</strong></p><p id="e258" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了预测一个小时的自行车共享需求，我们给我们的算法一个“n”值序列，并让它预测第”(n+1)个值。为此，我们构建了“n”小时的“n”个输入序列，然后使用算法预测第(n+1)小时的第(n+1)次自行车共享需求。我用10个值的序列来预测第11小时的自行车份额需求。</p><p id="8a65" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">拆分数据</strong></p><p id="4727" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们将数据拆分为训练:测试拆分。我选择在90:10火车:测试分裂。</p><h1 id="ee34" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">机器学习模型</strong></h1><p id="1c7d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">对于这项任务，可以采用许多模型。例如，基于树的预测器、神经网络或其他模型。我选择使用称为长短期记忆(LSTM)模型的特殊类型的神经网络，它是递归神经网络的变体，但没有消失/爆炸梯度问题。LSTM如下所示:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/0359db8f233e1b2e5375ea1e6382eb67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/0*GZhn7tUyN_vtOn51.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5。在<a class="ae iu" href="https://commons.wikimedia.org/w/index.php?title=User:MingxianLin&amp;action=edit&amp;redlink=1" rel="noopener ugc nofollow" target="_blank">https://commons.wikimedia.org/w/index.php?下发行的林明贤的长短期记忆模型title =用户:林明贤&amp;action = edit&amp;red link = 1</a></figcaption></figure><p id="a941" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些LSTMs非常擅长捕捉基于时间序列的顺序数据。由于这是一个独立的话题，我就不多谈它的理论了。</p><p id="c50a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我使用的Keras库具有图6所示的模型特征。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/974368b1144eca20a4a3f9b6c02a178a.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*SQtSsrJffAB0q1kqGfSXuw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图6。LSTM模型</figcaption></figure><h1 id="1424" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结果</h1><p id="43c0" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">该模型被训练10个时期，并且发现训练和验证损失分别为0.08和0.13，如图7所示。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/dbca6ec6ae1207a88d353e817e25f4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*W8qoGTVvYpe6UW51zCqPOw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图7。培训和验证损失</figcaption></figure><p id="5230" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">预测模型预测自行车份额需求的性能如图8所示。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/b4b4fe6aa59f99db639f4554860a0603.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*K4TL38wyo6G8fG62_q29Dw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图8。LSTM模型预测的自行车份额需求与实际需求</figcaption></figure><p id="7d21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以看出，我们的模型在预测自行车份额需求方面做得非常好。</p><h1 id="16ad" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="a697" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我希望读者对LSTM预测首都自行车份额需求的实现感兴趣。它帮助我用Keras实现了LSTM，并加强了我对熊猫的了解。完整的代码可以在我的GitHub知识库中找到，网址是<a class="ae iu" href="https://github.com/shayanalibhatti/Predicting_Bike_Share_Demand_with_LSTM" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/shayanalibhatti/Predicting _ Bike _ Share _ Demand _ with _ LSTM</a>。</p></div></div>    
</body>
</html>