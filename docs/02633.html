<html>
<head>
<title>Pandas As SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫作为SQL</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-as-sql-a6ac3bb13166?source=collection_archive---------10-----------------------#2019-12-26">https://medium.com/analytics-vidhya/pandas-as-sql-a6ac3bb13166?source=collection_archive---------10-----------------------#2019-12-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="44ef" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Python探索SQL查询与Pandas</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/c8a65d2aed171fa23f02a4ceeed9e64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbdxlltlpoppw8dh3QSwcg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">用Python弄脏你的手</figcaption></figure><p id="43ac" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><em class="kj"> Pandas </em>是一个开源的、BSD许可的库，为构建在C库之上的<a class="ae kk" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>编程语言提供高性能、易于使用的数据结构和数据分析工具。</p><p id="2737" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">使用pip3安装熊猫</strong></p><blockquote class="kl km kn"><p id="c599" class="jn jo kj jp b jq jr ij js jt ju im jv ko jx jy jz kp kb kc kd kq kf kg kh ki hb bi translated">$ pip3安装熊猫</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kr"><img src="../Images/dd2ce0627ec5d8bb640f28354ebe2494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6zMsS-l3_beudHH_h9uIw.png"/></div></div></figure><p id="dba1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">在python脚本里面导入熊猫</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ks"><img src="../Images/4702f48c637847261020d1946c8b1857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*CT98rYGyC5T6OauMQCsmIA.png"/></div></figure><p id="f40f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">将Python连接到MySQL数据库</strong></p><p id="d5ca" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们有两个表的客户数据库，使用SQLAlchemy连接和检索，并转换到数据框架。</p><p id="4216" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du kt ku kv kw b">$ pip3 install sqlalchemy</code></p><p id="96ab" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du kt ku kv kw b">$ pip3 install pymysql</code></p><p id="1bd5" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du kt ku kv kw b">$ sudo apt-get install python-mysqldb</code></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kx"><img src="../Images/1f52831d11f7ee2c41990c177141c000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*X-vCWJL0n3_qczrdhV25oA.png"/></div></figure><p id="76f2" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里，我们将客户、订单表数据存储在数据帧df1、df2中。</p><p id="84af" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">让我们开始对数据帧进行查询…</strong></p><ol class=""><li id="ba54" class="ky kz hi jp b jq jr jt ju jw la ka lb ke lc ki ld le lf lg bi translated"><strong class="jp hj">从df1中选择</strong> only列(客户名称)</li></ol><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="d265" class="ll lm hi kw b fi ln lo l lp lq"># SQL Query: SELECT CustomerName from Customers;</span><span id="cb50" class="ll lm hi kw b fi lr lo l lp lq">new_df = df1['CustomerName']</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ls"><img src="../Images/c5dbdf19508fe34e21c5867ec32d907a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*7WpiLDL9-A2cU23xxmRDNw.png"/></div></figure><p id="19e4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">2.<strong class="jp hj">从df1中选择</strong>和<strong class="jp hj"> WHERE </strong>子句</p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="0d23" class="ll lm hi kw b fi ln lo l lp lq"># SQL Query: SELECT * FROM TABLE WHERE COLUMN_NAME = SOME_VALUE<br/>where_df = df1.loc[df1['CustomerName'] == 'Alfred']</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lt"><img src="../Images/5c290f2b6b6fde6e09cf4c557535e129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*6HpGSsFnZhyMC4ttYeNBVw.png"/></div></figure><p id="8055" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">3.<strong class="jp hj">从df1中选择AND，OR </strong>和<strong class="jp hj"> NOT </strong>运算符</p><p id="308c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">和</strong>(我们有两套，国家为墨西哥)</p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="4200" class="ll lm hi kw b fi ln lo l lp lq"># SQL QUERY: SELECT COLUMN 1,COLUMN 2 FROM TABLE_NAME WHERE CONDITION1 AND CONDITION2<br/>where_and_df = df1.loc[(df1['Country'] == 'Mexico') &amp; (df1['ContactName'] == 'Anna')]</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lu"><img src="../Images/de07c032d6670903061bdb8575688b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*7QZcvLJ70dpkxodalStilA.png"/></div></figure><p id="6f46" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">或</strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="eed9" class="ll lm hi kw b fi ln lo l lp lq"># SQL QUERY: SELECT COLUMN 1,COLUMN 2 FROM TABLE_NAME WHERE CONDITION1 OR CONDITION2<br/>where_or_df = df1.loc[(df1['Country'] == 'Mexico') | (df1['ContactName'] == 'Anna')]<br/>print(where_or_df)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lv"><img src="../Images/2bd25ffa7e3072c8478674dc538fdc48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*CxTQqXo-J5h_cllK_c2CAw.png"/></div></figure><p id="da18" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">不是</strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="108f" class="ll lm hi kw b fi ln lo l lp lq"># SQL QUERY: SELECT COLUMN 1 FROM TABLE_NAME WHERE NOT CONDITION <br/>where_not_df = df1.loc[(df1['Country'] != 'Mexico')]</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lw"><img src="../Images/4892e46b4db67eaafca9d3efe7587f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*EiyIeJbMxk9D7fnYAsLBeg.png"/></div></figure><p id="9eeb" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 4。</strong> <strong class="jp hj">按</strong>顺序排列</p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="e8ca" class="ll lm hi kw b fi ln lo l lp lq">where_order_asc_df = df1.sort_values('CustomerID', ascending=True)<br/>print(where_order_asc_df)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lx"><img src="../Images/a61a9410e610f60437334b2f08e4da03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*r1-_bka8n9bIYSHg7zlwYA.png"/></div></figure><p id="8515" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 5。插入</strong></p><p id="9fcd" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">创建新数据框以插入值</p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="ee97" class="ll lm hi kw b fi ln lo l lp lq">#INSERT INTO table_name (column1, column2, column3, ...) VALUES (value1, value2, value3, ...);<br/># Create a dataframe and insert value<br/>data = {'EmployeeName': ['John', 'Kate', 'Max', 'Linie'],<br/>        'EmployeeID': [68, 74, 77, 78]}<br/><br/># create data frame<br/>df_employee = pd.DataFrame(data)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ly"><img src="../Images/9e538440898b6cf1c8a01c79caab0eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*PCXjuOOqFHz6d6qnqi80gg.png"/></div></figure><p id="f56c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">追加到现有数据框</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lz"><img src="../Images/fadbb2144621153b30742ace816f60f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*fF17kf2uWsYT0pkQaPlp_A.png"/></div></figure><p id="44f6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 6。空值</strong></p><p id="2278" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">带有空值的数据帧</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lx"><img src="../Images/f84b562e31fd79bd535709530c059344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*XXb4l2Qh-M_HQsqvKXyDvw.png"/></div></figure><p id="7af1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 7。更新</strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="19d1" class="ll lm hi kw b fi ln lo l lp lq"># SQL Query:UPDATE table_name SET column1 = value1, column2 = value2, ... WHERE condition;<br/>df_updated_employee.loc[df_updated_employee.EmployeeName == 'Max', 'EmployeeName'] = 'NewMax'</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ma"><img src="../Images/70d3f4be6750ff9f61039b3a28888125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ho-flrU1ZbiPx_Ovoxg5w.png"/></div></div></figure><p id="1fab" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 8。删除</strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="2d66" class="ll lm hi kw b fi ln lo l lp lq"># SQL QUERY: DELETE FROM table_name WHERE condition;<br/># dropping row based on index values<br/>df_updated_employee.drop([3], inplace=True)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mb"><img src="../Images/7136d35c8676a852503af6c502337fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlJtIfeKzj5g2el3CmG3Ng.png"/></div></div></figure><p id="4f1b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 9。选择顶部底部</strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="854a" class="ll lm hi kw b fi ln lo l lp lq"># Top<br/># SQL Query: SELECT column_name(s) FROM table_name WHERE condition LIMIT number;<br/>print(df_updated_employee.head(2))<br/><br/># Bottom<br/># SQL Query: SELECT column_name(s) FROM table_name WHERE condition LIMIT number;<br/>print(df_updated_employee.tail(1))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mc"><img src="../Images/24e32d2693794ec893fea10a024c5acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*4xv6pjYDmzWlJ8RBnoR_1A.png"/></div></figure><p id="bccc" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 10。最小值、最大值、总和、计数和AVG </strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="665f" class="ll lm hi kw b fi ln lo l lp lq"># SELECT MIN(EmployeeID) AS SmallestPrice FROM df_employee;<br/># SELECT MAX(EmployeeID) AS SmallestPrice FROM df_employee;<br/># SELECT SUM(EmployeeID) AS SmallestPrice FROM df_employee;<br/># SELECT COUNT(EmployeeID) AS SmallestPrice FROM df_employee;<br/># SELECT AVG(EmployeeID) AS SmallestPrice FROM df_employee;<br/>print(df_updated_employee['EmployeeID'].min())<br/>print(df_updated_employee['EmployeeID'].max())<br/>print(df_updated_employee['EmployeeID'].sum())<br/>print(df_updated_employee['EmployeeID'].count())<br/>print(df_updated_employee['EmployeeID'].mean())</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es md"><img src="../Images/743297e4b99e5bcf0b469b9b7178f22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*umeybQlwDiF7ShlAuUgOug.png"/></div></figure><p id="b487" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 11。在</strong>中</p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="0b86" class="ll lm hi kw b fi ln lo l lp lq"># SELECT column_name(s) FROM table_name WHERE column_name IN (value1, value2, ...);<br/>print(df_updated_employee.isin({'EmployeeName': ['John']}))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es me"><img src="../Images/b53dae4096986c8b4ff36e1f9317d55c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*9Q12HUQre-Qsu7sjE_qxiQ.png"/></div></figure><p id="a0f2" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 12。在</strong>之间</p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="ef73" class="ll lm hi kw b fi ln lo l lp lq"># SELECT column_name(s) FROM table_name WHERE column_name BETWEEN value1 AND value2;<br/>print(df_updated_employee[df_updated_employee['EmployeeID'].between(74, 77)])</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mf"><img src="../Images/f6808283c63b7b4b86533d04dda54b97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*Qw646rT5ul03ZGw-AeWP8g.png"/></div></figure><p id="44ba" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> 13。加入</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mg"><img src="../Images/1a5ef77c2efe797582403756de59745d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*AbeiH5t4udF5dDrbwqSdTQ.png"/></div></figure><p id="bb72" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">join子句用于根据两个或多个表之间的相关列来组合它们中的行。</p><p id="2ee3" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">内部连接</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mh"><img src="../Images/6c908385acc3320c32256bb5a7523986.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/0*lquzaxySVCKoeG7M"/></div></figure><p id="6b7d" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> <em class="kj">如果列值匹配则获取该特定行。</em> </strong></p><p id="f316" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">SQL查询(<strong class="jp hj"> <em class="kj">内部联接)</em> </strong>:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/cbee5d0ca0acbec13fb1630c908a562b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJzxk2ZPuiZGHEOn52CzbA.png"/></div></div></figure><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="1004" class="ll lm hi kw b fi ln lo l lp lq"># SQL QUERY<br/>select * from orders <strong class="kw hj">inner JOIN</strong> Customers on Orders.CUstomerID=Customers.CustomerID</span><span id="0c1d" class="ll lm hi kw b fi lr lo l lp lq">inner_join_df = pd.merge(df1,df2,on='CustomerID',how='inner')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mj"><img src="../Images/a3f387ea3d7664cd04376ae6d68fffe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*rbNNE12XbOAKfsq9IoZrgg.png"/></div></figure><p id="98f1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">左连接</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mk"><img src="../Images/762843443675c4a9a9a548d72fd41870.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*iTAGNZy82kCjK6ePqg-NGw.png"/></div></figure><p id="cc86" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">LEFT JOIN关键字返回左表(表1)中的所有记录，以及右表(表2)中的匹配记录。如果不匹配，则右侧的结果为空。</p><p id="05de" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> <em class="kj">从左表中获取所有记录，从右表中只获取匹配值，其他为空。</em> </strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="6b27" class="ll lm hi kw b fi ln lo l lp lq"># SQL QUERY<br/>SELECT * FROM Customers <strong class="kw hj">LEFT JOIN</strong> Orders ON Customers.CustomerID = Orders.CustomerID ORDER BY Customers.CustomerName;</span><span id="d7aa" class="ll lm hi kw b fi lr lo l lp lq">left_join_df = pd.merge(df1,df2,on='CustomerID',how='left')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ml"><img src="../Images/e18e57bfd21c0f1e985f6067339c84f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*yEjyDuWUKN1mmyjVV7hE1A.png"/></div></figure><p id="321a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">右连接</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mm"><img src="../Images/5805a3324c9dc65d43e90593372a2430.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*xhQssXrrhUrXVTFAKZYRsQ.png"/></div></figure><p id="f37e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">RIGHT JOIN关键字返回右表(表2)中的所有记录，以及左表(表1)中的匹配记录。当没有匹配时，结果从左侧为空。</p><p id="c67f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> <em class="kj">从右表中获取所有记录，从左表中只获取匹配的值，其他为空。</em>T3】</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mn"><img src="../Images/2a12ac7725d3570a082813341a62b77f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*Ow-TTiBqvH3EnpvA3FoshQ.png"/></div></figure><p id="0061" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">全外接</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mo"><img src="../Images/5e306cef61b6a2f8dcc5bf1e7c056753.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*5ugqEU2obdtH_EopLYH1UQ.png"/></div></figure><p id="057c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">当左(表1)或右(表2)表记录中有匹配项时，FULL OUTER JOIN关键字返回所有记录。</p><p id="56e4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">注意:完全外连接可能会返回非常大的结果集！</p><p id="a2db" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">提示:完全外部连接和完全连接是相同的。</p><p id="3930" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj"> <em class="kj">从右表获取所有记录，从左表获取所有匹配值..</em>T9】</strong></p><pre class="iy iz ja jb fd lh kw li lj aw lk bi"><span id="a8ba" class="ll lm hi kw b fi ln lo l lp lq"># SQL QUERY<br/>SELECT * FROM Customers <strong class="kw hj">FULL OUTER</strong> <strong class="kw hj">JOIN</strong> Orders ON Customers.CustomerID = Orders.CustomerID ORDER BY Customers.CustomerName;</span><span id="cde5" class="ll lm hi kw b fi lr lo l lp lq">full_outer_join_df = pd.merge(df1,df2,on='CustomerID',how='outer')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mp"><img src="../Images/fadf0119e1759a9036a80db61ed17b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*z49Neynu9YRAng8w_Iz7AQ.png"/></div></figure></div></div>    
</body>
</html>