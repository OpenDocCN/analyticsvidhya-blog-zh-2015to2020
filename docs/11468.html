<html>
<head>
<title>Detecting Malaria from cell images using CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CNN从细胞图像中检测疟疾</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/detecting-malaria-from-cell-images-using-cnn-e9ab9346cb0?source=collection_archive---------9-----------------------#2020-12-04">https://medium.com/analytics-vidhya/detecting-malaria-from-cell-images-using-cnn-e9ab9346cb0?source=collection_archive---------9-----------------------#2020-12-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1966" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用卷积神经网络开发神经网络来分类细胞是否被感染。</p><h1 id="113d" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">议程</h1><p id="5a6d" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在这篇文章中，我将向你展示如何开发一个神经网络来分类，一个细胞是否被感染使用卷积神经网络。我们将使用Kaggle提供的数据集，其中包含27，558张感染和未感染细胞的图像。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/60b67ef7ecbf37e13339891472406be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ppCpPeBypiM1ymK6"/></div></div></figure></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="c274" class="jd je hi bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">发展</h1><p id="ab00" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated"><strong class="ih hj">加载数据</strong></p><p id="c220" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此处提供的<a class="ae le" href="https://www.kaggle.com/iarunava/cell-images-for-detecting-malaria" rel="noopener ugc nofollow" target="_blank">疟疾细胞图像数据集包含27558张感染和未感染疟疾细胞的图像。</a></p><p id="3580" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个项目中，我们使用cv2来读取和存储图像的像素值。这里是加载数据的方法之一。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lf"><img src="../Images/f217a8532886e9f92d31abc59e53d0ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OEtf8hatD2ysAh0dD1viuA.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">从内存加载数据</figcaption></figure><p id="f8c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在下面看到一些例子。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lk"><img src="../Images/e04f28222f14cbfcba9d1895676481a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*gPbJKE44RhmjTgt1id0QVQ.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated"><strong class="bd jf">示例图片</strong></figcaption></figure><p id="f848" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集包含相同数量的感染和未感染图像。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ll"><img src="../Images/33945ae4c0302f0e56bc5e066687e80d.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*0OFvuYpWMTd_KQ4Ov-DkBw.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated"><strong class="bd jf">标签计数</strong></figcaption></figure><p id="2c7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置图像子集</strong></p><p id="f176" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将图像分为三组:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lm"><img src="../Images/276376f3908dae329c5e36ea736d366d.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*MEqG_8MeeuE4e2okPzmgdw.png"/></div></figure><h2 id="cecb" class="ln je hi bd jf lo lp lq jj lr ls lt jn iq lu lv jr iu lw lx jv iy ly lz jz ma bi translated">图像增强</h2><p id="6ecc" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">图像增强是一种对原始图像应用不同变换的技术，这导致相同图像的多个变换副本。应用这些小变化不会改变它的目标类，但也提供了查看这些图像的新视角。这些图像增强技术不仅扩展了数据集，还在数据集中加入了一定程度的变化，这使得您的模型能够更好地对看不见的数据进行归纳。</p><p id="aaa4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本项目中，我们使用了ImageDataGenerator类，因为它旨在提供实时数据增强，即在模型处于训练阶段时生成增强图像。</p><p id="daba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个项目中，我们使用了4种不同的转换技术。每一个都在下面描述。</p><pre class="kh ki kj kk fd mb mc md me aw mf bi"><span id="edfb" class="ln je hi mc b fi mg mh l mi mj">• 10% — Horizontal shift<br/>• 10% — Width shift<br/>• 10 degree — Random rotation, in a range of 360 degrees<br/>• 10% — Zoom </span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mk"><img src="../Images/ce38618c8da3c947dc29e55358f7ac55.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*HQZjzrmcDr5iUt9ZkkLrGA.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated"><strong class="bd jf">增强图像</strong></figcaption></figure><h2 id="ad05" class="ln je hi bd jf lo lp lq jj lr ls lt jn iq lu lv jr iu lw lx jv iy ly lz jz ma bi translated">构建CNN架构</h2><p id="78dd" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这是我们项目最重要的一步。它由五部分组成——</p><ol class=""><li id="3d56" class="ml mm hi ih b ii ij im in iq mn iu mo iy mp jc mq mr ms mt bi translated">盘旋</li><li id="56e2" class="ml mm hi ih b ii mu im mv iq mw iu mx iy my jc mq mr ms mt bi translated">联营</li><li id="15fc" class="ml mm hi ih b ii mu im mv iq mw iu mx iy my jc mq mr ms mt bi translated">变平</li><li id="26b5" class="ml mm hi ih b ii mu im mv iq mw iu mx iy my jc mq mr ms mt bi translated">密集或完全连接</li><li id="7497" class="ml mm hi ih b ii mu im mv iq mw iu mx iy my jc mq mr ms mt bi translated">拒绝传统社会的人</li></ol><p id="cba6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">卷积</strong></p><p id="085e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积的主要目的是从输入图像中提取特征。卷积通过使用输入数据的小方块学习图像特征来保持像素之间的关系。</p><p id="bbe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在卷积运算中，我们从一个核开始，它只是一个小的权重矩阵。这个内核在输入数据上“滑动”,对它当前所在的输入部分执行元素级乘法，然后将结果累加成一个输出像素。</p><p id="6d10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是3×3核和7×7输入图像的卷积运算的例子。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mz"><img src="../Images/a1c8f94ce52d121f28178dbbaf276acc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jG9CTw9kXikNWW_g.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">资料来源:www.superdatascience.com</figcaption></figure><p id="8279" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">联营</strong></p><p id="2968" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当图像太大时，池层减少了参数的数量。在这个项目中，我们使用了最大池层。</p><p id="1dec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在最大池中，选择批次的最大像素值。这里的批次是指一组像素，其大小等于基于图像大小决定的过滤器大小。在以下示例中，选择了2x2的滤波器。池化方法的输出随着过滤器大小值的变化而变化。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es na"><img src="../Images/dc00c1f99aee2c1b1fcc8bca31d1efbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IawpNVwZ0mC2_SGP.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">资料来源:computersciencewiki.org</figcaption></figure><p id="0ac6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">展平</strong></p><p id="4a17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="nb">扁平化</em>是将数据转换成一维数组，输入到下一层。我们展平卷积层的输出，以创建单个长特征向量。并且它连接到最终的分类模型。</p><p id="d517" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">密集或全连接层</strong></p><p id="b65b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们称之为全连接层的层，我们将矩阵展平成向量，并将其馈入像神经网络一样的全连接层。</p><p id="1c03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">特征映射矩阵将被转换为矢量。对于完全连接的层，我们将这些特征组合在一起以创建一个模型。最后，我们有一个激活函数，如softmax，将输出分类为受感染或未受感染。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es nc"><img src="../Images/801620a03d2b7e951d63bc4446d4bfcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tajm5N8Ei5KIPsZ0hP7B3Q.jpeg"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">具有许多卷积层的神经网络</figcaption></figure><p id="25ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">辍学</strong></p><p id="8fec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Dropout用于防止模型过度拟合。Dropout的工作原理是在训练阶段的每次更新时，将隐藏单元(组成隐藏层的神经元)的输出边缘随机设置为0。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es nd"><img src="../Images/ad04e5d30c65b3d421f6da95ef0698c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*2NvZ7P6N75iaN_eHQqG0zQ.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">CNN模型架构</figcaption></figure><p id="676f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">培训</strong></p><p id="4fc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在测试了许多优化器之后，我选择了和Adam一起工作。Adam利用自适应学习率方法的力量来为每个参数找到单独的学习率。Adam的设计结合了Adagrad和RMSprop的优点，前者适用于稀疏渐变，后者适用于在线设置。拥有这两者使我们能够将Adam用于更广泛的任务。Adam也可以看做是RMSprop和SGD与momentum的结合。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ne"><img src="../Images/4082a9d136b7b6a25037c47b73869150.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/0*Mu-8EjKp7tJWaJlb.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">资料来源:亚当论文原文</figcaption></figure><p id="2558" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在训练阶段，我们使用损失函数作为分类交叉熵，因为我们将训练CNN输出每个图像在2个类别上的概率，并且我们使用“准确度”作为准确度矩阵。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es nf"><img src="../Images/a9644f4306cc74c52d4d1367cac5973a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*SAWQqDkhLypUxJf-g2NDvA.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">培训和验证损失的比较</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ng"><img src="../Images/24a78c1e01c01e5ff543748460a34b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*0hpdov9vrPB1C8dhsZtbvQ.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">培训和验证损失的比较</figcaption></figure><p id="0ea9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">测试</strong></p><p id="d12c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一点上，网络在识别训练和验证图像方面足够准确，并以超人的准确性对它们进行分类。</p><p id="6d93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该网络的最终测试是查看一个完全未知的数据集，以正确分类图像。</p><p id="83cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想象不出比这更好的结果了！该网络以95%的惊人准确率(大约)完成了这项任务。</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><p id="bd67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个项目的所有代码都可以在我的GitHub配置文件中找到:</p><div class="nh ni ez fb nj nk"><a href="https://github.com/vipinkatara/malaria-detection-using-cnn" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab dw"><div class="nm ab nn cl cj no"><h2 class="bd hj fi z dy np ea eb nq ed ef hh bi translated">vipinkatara/疟疾检测-使用cnn</h2><div class="nr l"><h3 class="bd b fi z dy np ea eb nq ed ef dx translated">GitHub是超过5000万开发人员的家园，他们一起工作来托管和审查代码、管理项目和构建…</h3></div><div class="ns l"><p class="bd b fp z dy np ea eb nq ed ef dx translated">github.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny kq nk"/></div></div></a></div><div class="nh ni ez fb nj nk"><a href="https://linkedin.com/in/vipin-katara-951a5750" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab dw"><div class="nm ab nn cl cj no"><h2 class="bd hj fi z dy np ea eb nq ed ef hh bi translated">Vipin katara - Amity工程学院&amp;技术学院-新德里，德里，印度| LinkedIn</h2><div class="nr l"><h3 class="bd b fi z dy np ea eb nq ed ef dx translated">查看Vipin katara在全球最大的职业社区LinkedIn上的个人资料。唯品教育上市于…</h3></div><div class="ns l"><p class="bd b fp z dy np ea eb nq ed ef dx translated">linkedin.com</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny kq nk"/></div></div></a></div></div></div>    
</body>
</html>