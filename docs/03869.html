<html>
<head>
<title>A Product Manager’s Cheatsheet to Pandas/Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">产品经理对熊猫/Python的备忘单</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-product-managers-cheatsheet-to-pandas-python-81fd020d5caa?source=collection_archive---------10-----------------------#2020-02-23">https://medium.com/analytics-vidhya/a-product-managers-cheatsheet-to-pandas-python-81fd020d5caa?source=collection_archive---------10-----------------------#2020-02-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="087b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我担任产品经理期间，我不时需要处理Excel中的数据。有些情况下，我需要比Excel更好的工具，尤其是在以下情况下:</p><ul class=""><li id="8273" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">我需要在一个超过40万行的表中查找，这会降低我办公室笔记本电脑的速度</li><li id="e849" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">我需要在复杂的逻辑中处理列，通常包括在特定条件下查找多个表或在一个组中选取行</li><li id="226d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">当我浏览数据时，我想保存我的工作过程，这样我就可以在其他电子表格中快速应用它</li><li id="cf53" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">我想用简洁的风格快速绘制直方图、散点图和其他类型的可视化效果</li><li id="b472" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">我想从一个文件夹中的多个文件中读取并混合数据</li><li id="f005" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">偶尔想做一些聚类之类的数据挖掘。</li></ul><p id="4928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这些情况下，数据分析库Python with Pandas完全符合我的需求。在这里，我将在每次从Onenote笔记本复制时共享我的备忘单，但我将从设置工具开始，因为读者没有Python环境。</p><h1 id="42ae" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">设置工具</h1><p id="0c6e" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">最简单的方法是<a class="ae ku" href="https://www.anaconda.com/distribution/#windows" rel="noopener ugc nofollow" target="_blank">下载一个Anaconda包</a>，点击“下一步”、“下一步”，直到完成(对于Mac用户来说过程类似)。</p><p id="0d16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/8cdd893dc56126e6723321b3d8ba3942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-mzowEWHeaiyA3c9yJYPA.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">下载时一定要选择Python 3.7</figcaption></figure><h1 id="fd46" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">开始工作</h1><p id="ecee" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在开始菜单中启动Anaconda Navigator，点击“Jupyter笔记本”下的“启动”，这是我用于数据分析的主要工具。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ll"><img src="../Images/347081e970c0ba885ab79a599c5ae1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EBt5hxn4NylI7Z9zWSal1Q.png"/></div></div></figure><p id="bde0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将在您的浏览器中创建一个新的选项卡，界面如下。您可以在这里创建文件夹和组织文件。当你准备开始一个新项目时，点击“新建”按钮，选择“Python 3”。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lm"><img src="../Images/29138c38d2f15ca14991cd46de651048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-o6OL-BBWsmRz3t38TlbSA.png"/></div></div></figure><p id="e805" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在新的笔记本中，我总是从将以下代码粘贴到代码框中开始。这些代码支持绘图和导入特定的库，并且对于每个任务来说都是一样的。</p><p id="8b8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后一行指向我想要使用的excel文件的路径。我相应地更改了文件名和路径。</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="791b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一定要运行代码。在Jupyter Notebook中，代码是通过点击“运行”按钮来运行的，或者更常见的是，点击Ctrl+Enter。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lp"><img src="../Images/a01bdf7e62c4a25a645796958843a74c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQqPPhvNBwEeGGVLpMTgJw.png"/></div></div></figure><p id="07a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后单击加号为一些新代码添加一个块。这就是通常用笔记本完成工作的方式。</p><h1 id="5599" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">使用行和列</h1><p id="9b5c" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在最后一步中，我将excel文件加载到一个名为df的“DataFrame”(相当于Excel中的一个工作表)中。我可以用它做很多事情:</p><p id="bd55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个名为df2的新数据框架，带有“name”列(列名在Excel文件的第一行):</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="b4ef" class="lv js hi lr b fi lw lx l ly lz">df2 = df['name']</span></pre><p id="3d5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者有两列，“名称”和“价格”</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="3854" class="lv js hi lr b fi lw lx l ly lz">df2 = df[['name', 'price']]</span></pre><p id="fca0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者创建一个在“城市”列中只有“纽约”的行:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="443f" class="lv js hi lr b fi lw lx l ly lz">df2 = df.loc[df['city'] == 'New York']</span></pre><p id="1a25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者具有多个条件和一个范围(括号是必需的):</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="0e7c" class="lv js hi lr b fi lw lx l ly lz">df2 = df.loc[(df['city'] == 'New York') &amp; (df['price'] &lt; 50)]</span></pre><h1 id="cc48" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">转换数据</h1><p id="64b0" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">创建新列也很容易(python有广泛的数学函数):</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="19b0" class="lv js hi lr b fi lw lx l ly lz">df2['amount'] = df2['price'] * df2['qty']</span></pre><p id="d52f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者使用Python函数:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="2c42" class="lv js hi lr b fi lw lx l ly lz">level_map = {'One': 1, 'Two': 2, 'Three': 3}<br/>df2['level_number'] = df2['level'].map(lambda x: level_map[x])</span></pre><p id="b512" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这类似于Excel中的公式，但它更灵活，因为有一整套编程语言可供使用。</p><h1 id="b1cc" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">绘制图表</h1><p id="42ab" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我最常用的图表是直方图、折线图、散点图、条形图和箱线图。</p><p id="d85c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名产品经理，有时我希望看到一些列的分布情况，而不是平均值这样的总数，然后我会绘制一个直方图:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="a0ec" class="lv js hi lr b fi lw lx l ly lz">df['price'].plot.hist()</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es ma"><img src="../Images/d1b9f28cf750b624e4b3b0c378c161d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*lgcLTKYiylcyWpNJaSwVyA.png"/></div></figure><p id="547f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了比较变量，我用了一个线图:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="ccc7" class="lv js hi lr b fi lw lx l ly lz">df[['cost', 'revenue']].plot()</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mb"><img src="../Images/97c8a37cbf13c2711739211472880111.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*JNE0OKFizov8nefRv0rFoQ.png"/></div></figure><p id="e85d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">散点图允许我直观地观察两个变量之间的关系:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="23dc" class="lv js hi lr b fi lw lx l ly lz">df.plot.scatter(x='cost', y='revenue')</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mc"><img src="../Images/7fcaef88a0e3e40e4a9817dc2dd700c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*Yflsa9JAlf0qmiCm6H2oxQ.png"/></div></figure><p id="c9e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不经常在熊猫中使用条形图，部分原因是我可以在Excel中相当容易地做到这一点。但这是一种直观显示数字的便捷方式:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="90e8" class="lv js hi lr b fi lw lx l ly lz">df.plot(kind='bar')</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es md"><img src="../Images/ae448f66065e88c803315116316f4fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*_k9Xr7qvSPNxNy2umsE8Ag.png"/></div></figure><p id="1307" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">箱线图允许我同时比较平均值、四分位数和异常值:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="1e94" class="lv js hi lr b fi lw lx l ly lz">df.boxplot(column=['cost', revenue'])</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es me"><img src="../Images/2456111358439b86ef7eff217c415622.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*r0tX0V-q-jTMWjmWkWl1IA.png"/></div></figure><h1 id="723e" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">连接表格</h1><p id="9c9f" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">熊猫的VLOOKUP是这样的:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="25e3" class="lv js hi lr b fi lw lx l ly lz">df_cost.merge(df_revenue, how='left')</span></pre><p id="7edd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将两个数据帧连接在一起，使用相同的列名作为索引。(如果没有相同列名，可以使用“left_on”和“right_on”参数)</p><p id="60ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这件事的奇妙之处在于，你可以用“how”参数决定如何合并表:“left”保留左边数据帧的所有行，并选择右边的一行；‘右’则相反；“outer”保留所有行；而“inner”只保留两边都存在的行。</p><h1 id="0da6" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">分组行</h1><p id="6c1d" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">通常的任务是按标签列对行进行分组，并为每个组生成一个汇总结果。例如，计算每个地区的总利润:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="9e6f" class="lv js hi lr b fi lw lx l ly lz">df.groupby('region', as_index=False).sum()</span></pre><p id="4333" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我总是将as_index设置为false，因为在默认情况下，Pandas会为分组结果创建索引，这常常会给后面的分析带来麻烦(除非你非常清楚如何处理这些)。</p><p id="697c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用“groupby”可以完成一些用Excel很难甚至不可能完成的任务，例如选出每个地区利润最高的商店:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="8a3a" class="lv js hi lr b fi lw lx l ly lz">df.groupby('region', as_index=False)<br/>       .apply(lambda g: g.sort_values('profit').head(1))</span></pre><h1 id="8b28" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">导出回Excel</h1><p id="c326" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">当我完成工作时，我只需使用:</p><pre class="kw kx ky kz fd lq lr ls lt aw lu bi"><span id="5d9f" class="lv js hi lr b fi lw lx l ly lz">df.to_excel('e:\works\path_to_file.xlsx')</span></pre><p id="7794" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">把我的数据框放回excel文件。</p><h1 id="8fb5" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">结论</h1><p id="a97e" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">即使我的工作不需要我执行繁重的数据科学，了解Pandas和Python确实让我的生活变得容易得多，因为它的表达简短、灵活且优雅。</p></div></div>    
</body>
</html>