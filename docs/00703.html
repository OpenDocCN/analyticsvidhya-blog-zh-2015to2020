<html>
<head>
<title>3 Beginner-Friendly Techniques to Extract Features from Image Data using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从影像数据中提取要素的3种初学者友好技术</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/3-beginner-friendly-techniques-to-extract-features-from-image-data-using-python-bd5e60e56876?source=collection_archive---------3-----------------------#2019-08-29">https://medium.com/analytics-vidhya/3-beginner-friendly-techniques-to-extract-features-from-image-data-using-python-bd5e60e56876?source=collection_archive---------3-----------------------#2019-08-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="c6d2" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">概观</h1><ul class=""><li id="f9cf" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">您知道可以使用机器学习技术处理图像数据吗？</li><li id="4402" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">深度学习模型是本月的热门话题，但并不是每个人都可以获得无限的资源——这就是机器学习的救星！</li><li id="a6ed" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">在本文中，了解如何使用Python从图像中提取要素</li></ul><h1 id="2e9a" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="3166" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">你以前处理过图像数据吗？也许你想<a class="ae kp" href="https://www.analyticsvidhya.com/blog/2018/10/a-step-by-step-introduction-to-the-basic-object-detection-algorithms-part-1/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">建立自己的物体检测模型</a>，或者只是想计算走进一栋大楼的人数。使用计算机视觉技术处理图像的可能性是无限的。</p><p id="c8cd" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">但是我最近在数据科学家中看到了一个趋势。人们坚信，当涉及到处理非结构化数据，特别是图像数据时，深度学习模型是前进的方向。深度学习技术无疑表现得极其出色，但这是处理图像的唯一方法吗？</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/f06f5898a110d52c76e8547fb4e6d668.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s6DLJHs6n_gux37c.jpg"/></div></div></figure><p id="073a" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">并不是所有人都像谷歌和脸书这样的科技巨头一样拥有无限的资源。那么，如果不通过深度学习的镜头，我们如何处理图像数据呢？</p><p id="df71" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我们可以利用<a class="ae kp" href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>的力量！没错——我们可以使用简单的机器学习模型，比如<a class="ae kp" href="https://www.analyticsvidhya.com/blog/2016/04/complete-tutorial-tree-based-modeling-scratch-in-python/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">决策树</a>或<a class="ae kp" href="https://www.analyticsvidhya.com/blog/2017/09/understaing-support-vector-machine-example-code/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">支持向量机(SVM) </a>。如果我们提供正确的数据和特征，这些机器学习模型可以充分执行，甚至可以用作基准解决方案。</p><p id="1fe9" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">因此，在这篇初学者友好的文章中，我们将了解从图像中生成特征的不同方式。然后你可以在你最喜欢的<a class="ae kp" href="https://www.analyticsvidhya.com/blog/2017/09/common-machine-learning-algorithms/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习算法</a>中使用这些方法！</p><h1 id="1667" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">目录</h1><ol class=""><li id="2f35" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq lh js jt ju bi translated">机器是如何存储图像的？</li><li id="ec29" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq lh js jt ju bi translated">用Python读取图像数据</li><li id="ab64" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq lh js jt ju bi translated">从图像数据中提取特征的方法#1:灰度像素值作为特征</li><li id="4145" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq lh js jt ju bi translated">用于从图像数据提取特征的方法#2:通道的平均像素值</li><li id="dd30" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq lh js jt ju bi translated">从图像数据中提取特征的方法#3:提取边缘</li></ol><h1 id="1c5c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">机器是如何存储图像的？</h1><p id="5889" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">让我们从基础开始。在我们看其他东西之前，了解我们如何在我们的机器上读取和存储图像是很重要的。考虑这个'<em class="li">PD . read _【T1]'函数，但是对于图像。</em></p><p id="3757" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我将以一个简单的例子开始。请看下图:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es lj"><img src="../Images/a444aef2aa79b10f85677db14f54ce4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/0*BH754ZGijoACFDxn.png"/></div></figure><p id="d7ba" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我们有数字8的图像。仔细看这张图片，你会注意到它是由一些小方块组成的。<strong class="jf hj">这些被称为像素。</strong></p><p id="1bf8" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">然而，有一个警告。我们看到的是图像本身——它们的视觉形式。我们可以很容易地区分边缘和颜色，以识别图片中的内容。另一方面，机器很难做到这一点。它们以数字的形式存储图像。请看下图:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es lj"><img src="../Images/3e9bb43081e14601b35a7d13f531d2fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/0*uoY5WhYacjxOVmei.png"/></div></figure><p id="d4d3" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">机器以数字矩阵的形式存储图像。这个矩阵的大小取决于任何给定图像中的像素数量。</p><blockquote class="lk ll lm"><p id="722b" class="ka kb li jf b jg kq kc kd ji kr ke kf ln ks kh ki lo kt kk kl lp ku kn ko jq hb bi translated"><em class="hi">假设一幅图像的尺寸是180 x 200或者n x m，这些尺寸基本上就是图像的像素数(高x宽)。</em></p></blockquote><p id="80f4" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated"><strong class="jf hj">这些数字或像素值表示像素的强度或亮度。</strong>较小的数字(更接近零)代表黑色，较大的数字(更接近255)代表白色。通过分析下面的图片，你会明白我们已经学到了什么。</p><p id="8003" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">下图的尺寸为22 x 16，您可以通过计算像素数来验证:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lq"><img src="../Images/e62ad854e21454fdb32a98192d107680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x0y_8ZEr4GEbkePA.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">来源:<a class="ae kp" href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">应用机器学习课程</a></figcaption></figure><p id="118c" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我们刚刚讨论的例子是黑白图像。那么彩色图像(在现实世界中更普遍)呢？你认为彩色图像也以2D矩阵的形式存储吗？</p><blockquote class="lk ll lm"><p id="71d7" class="ka kb li jf b jg kq kc kd ji kr ke kf ln ks kh ki lo kt kk kl lp ku kn ko jq hb bi translated"><em class="hi">彩色图像通常由多种颜色组成，几乎所有的颜色都可以由三原色(红、绿、蓝)生成。</em></p></blockquote><p id="34cd" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">因此，在彩色图像的情况下，有三个矩阵(或通道)——红色、绿色和蓝色。每个矩阵的值在0-255之间，代表该像素的颜色强度。考虑下图来理解这个概念:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es lv"><img src="../Images/cc54f969dbb8cea9a23ac89071648a15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*eN0puwG2bJDdnZ00.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">来源:<a class="ae kp" href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">应用机器学习课程</a></figcaption></figure><p id="2169" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我们在左边有一个彩色图像(就像我们人类看到的那样)。在右边，我们有三个矩阵用于三个颜色通道——红色、绿色和蓝色。这三个通道叠加形成一个彩色图像。</p><p id="5975" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated"><em class="li">注意，这些不是给定图像的原始像素值，因为原始矩阵会非常大，难以可视化。此外，还有各种其他格式的图像存储。RGB是最流行的一种，因此我在这里提出了它。你可以在这里</em>  <em class="li">了解更多其他流行格式</em> <a class="ae kp" href="https://www.w3schools.com/cssref/css_colors_legal.asp" rel="noopener ugc nofollow" target="_blank"> <em class="li">。</em></a></p><h1 id="9bf7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">用Python读取图像数据</h1><p id="eeac" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">让我们把理论知识付诸实践。我们将启动Python并加载一幅图像，看看矩阵是什么样子:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="32f0" class="mb ig hi lx b fi mc md l me mf">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>from skimage.io import imread, imshow<br/><br/>image = imread('image_8_original.png', as_gray=True)<br/>imshow(image)</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mg"><img src="../Images/b98dd79c2ab2b60d9f93b2a7c32d26fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/0*gRpvFTkrEIEpbMj4.png"/></div></figure><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="17b9" class="mb ig hi lx b fi mc md l me mf">#checking image shape <br/>image.shape, image</span><span id="6b38" class="mb ig hi lx b fi mh md l me mf">(28,28)</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mi"><img src="../Images/902881eab13ff75a1281e4b83ee32a04.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*quUG1bxjVPePunDj.png"/></div></figure><p id="7723" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">矩阵有784个值，这是整个矩阵的很小一部分。</p><p id="d14a" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">现在让我们深入本文背后的核心思想，探索使用像素值作为特征的各种方法。</p><h1 id="4a70" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">方法#1:灰度像素值作为特征</h1><blockquote class="lk ll lm"><p id="4133" class="ka kb li jf b jg kq kc kd ji kr ke kf ln ks kh ki lo kt kk kl lp ku kn ko jq hb bi translated"><em class="hi">从图像创建特征的最简单方法是使用这些原始像素值作为单独的特征。</em></p></blockquote><p id="a4dd" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">以上面的图像为例(数字“8”)，图像的尺寸是28 x 28。</p><p id="3cb4" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">你能猜出这张图片的特征数量吗？特征的数量将与像素的数量相同！因此，这个数字将是784。</p><p id="45f4" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">现在又有一个好奇的问题——我们如何把这784个像素排列成特征？嗯，我们可以简单地将每个像素值一个接一个地附加起来，以生成一个特征向量。下图对此进行了说明:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mj"><img src="../Images/2a14a496815b041ad52980c6cba051d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TJjWmWg-NNuJbQCx.png"/></div></div></figure><p id="1451" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">让我们用Python制作一个图像，并为该图像创建以下特征:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="59d5" class="mb ig hi lx b fi mc md l me mf">image = imread('puppy.jpeg', as_gray=True)                        image.shape, imshow(image)</span><span id="f2f7" class="mb ig hi lx b fi mh md l me mf">(650, 450)</span></pre><p id="f082" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">这里的图像形状是650 x 450。因此，特征的数量应该是297，000。我们可以使用NumPy中的<em class="li"> reshape </em>函数来生成该图像，其中我们指定了图像的尺寸:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="fc47" class="mb ig hi lx b fi mc md l me mf">#pixel features                                               features = np.reshape(image, (660*450))                                               features.shape, features</span><span id="2de4" class="mb ig hi lx b fi mh md l me mf">(297000,) <br/>array([0.96470588, 0.96470588, 0.96470588, ..., 0.96862745, 0.96470588, 0.96470588])</span></pre><p id="0fe6" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">这里，我们有我们的特征—长度为297，000的1D数组。很简单，对吧？</p><p id="a6b9" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">但在这里，我们只有一个单一的通道或灰度图像。我们能对彩色图像做同样的事情吗？让我们来了解一下！</p><h1 id="8634" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">方法#2:通道的平均像素值</h1><p id="8696" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">在读取上一节中的图像时，我们已经设置了参数<em class="li"> 'as_gray = True' </em>。因此，我们在图像中只有一个通道，我们可以很容易地附加像素值。让我们删除参数并再次加载图像:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="52e4" class="mb ig hi lx b fi mc md l me mf">image = imread('puppy.jpeg')     <br/>image.shape</span><span id="2182" class="mb ig hi lx b fi mh md l me mf">(660, 450, 3)</span></pre><p id="b271" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">这一次，图像有一个维度(660，450，3)，其中3是通道的数量。我们可以像以前一样继续创建特征。在这种情况下，特征的数量将是660*450*3 = 891，000。</p><p id="e284" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">或者，我们可以使用另一种方法:</p><blockquote class="lk ll lm"><p id="8c49" class="ka kb li jf b jg kq kc kd ji kr ke kf ln ks kh ki lo kt kk kl lp ku kn ko jq hb bi translated"><em class="hi">我们可以生成一个新矩阵，其中包含所有三个通道的像素平均值，而不是分别使用三个通道的像素值。</em></p></blockquote><p id="f22e" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">下图将让你更清楚地了解这个想法:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mk"><img src="../Images/344b84ead4328ac6e662cfec115390ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/0*JOzCGEbw5ZrFygMG.png"/></div></div></figure><p id="ec9f" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">通过这样做，特征的数量保持不变，并且我们还考虑了来自图像的所有三个通道的像素值。让我们用Python来编码。我们将创建一个同样大小为660 x 450的新矩阵，其中所有值都被初始化为0。该矩阵将存储三个通道的平均像素值:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="b28e" class="mb ig hi lx b fi mc md l me mf">image = imread('puppy.jpeg')<br/>feature_matrix = np.zeros((660,450))                        feature_matrix.shape</span><span id="b866" class="mb ig hi lx b fi mh md l me mf">(660, 450)</span></pre><p id="428e" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我们有一个尺寸为(660 x 450 x 3)的3D矩阵，其中660是高度，450是宽度，3是通道数。为了获得平均像素值，我们将使用一个<em class="li">用于</em>循环:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="3708" class="mb ig hi lx b fi mc md l me mf">for i in range(0,iimage.shape[0]):<br/>   for j in range(0,image.shape[1]):<br/>        feature_matrix[i][j] = ((int(image[i,j,0]) + int(image[i,j,1]) + int(image[i,j,2]))/3)</span></pre><p id="79bc" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">新矩阵将具有相同的高度和宽度，但只有一个通道。现在，我们可以按照上一节中的相同步骤进行操作。我们将像素值一个接一个地附加起来，得到一个1D数组:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="6faf" class="mb ig hi lx b fi mc md l me mf">features = np.reshape(feature_matrix, (660*450))                        features.shape</span><span id="f171" class="mb ig hi lx b fi mh md l me mf">(297000,)</span></pre><h1 id="c52a" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">方法#3:提取边缘特征</h1><p id="02da" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">假设我们得到了下图，我们需要识别图中的物体:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mi"><img src="../Images/1e5c16adf5db8c97deefbc038cda8764.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*NmL3luAwk8S03vKb.png"/></div></figure><p id="7427" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">你一定在瞬间认出了这些物体——一只狗、一辆车和一只猫。在区分这些图像时，您考虑了哪些特征？形状可能是一个重要因素，其次是颜色或大小。如果机器也能像我们一样识别形状会怎么样？</p><p id="e666" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">类似的想法是提取边缘作为特征，并将其用作模型的输入。我希望你们思考一下这个问题——我们如何识别图像中的边缘？边缘基本上是颜色变化剧烈的地方。请看下图:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es ml"><img src="../Images/1b95beabea3a79886d24dc88cc296c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/0*VLfFPm8u9TOBDhyR.png"/></div></figure><p id="91db" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我在这里强调了两个方面。我们可以识别边缘，因为颜色从白色变为棕色(右图)和棕色变为黑色(左图)。我们知道，图像是以数字的形式表现的。因此，我们将寻找像素值变化剧烈的像素。</p><p id="0051" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">假设我们有以下图像矩阵:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mm"><img src="../Images/a5e394c096515552d6576703c4be9694.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/0*RCpPXaz5Hyeoccyn.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">来源:<a class="ae kp" href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">应用机器学习课程</a></figcaption></figure><p id="e517" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">为了识别一个像素是否是边缘，我们将简单地减去像素两边的值。在本例中，我们突出显示了值85。我们将找到值89和78之间的差异。由于这个差别不是很大，我们可以说这个像素周围没有边缘。</p><p id="6563" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">现在考虑下图中高亮显示的像素125:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mn"><img src="../Images/7fcda51f0c8ef7c30f089e70ee79ef29.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/0*iDuD-LTWsEoJt-2M.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">来源:<a class="ae kp" href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">应用机器学习课程</a></figcaption></figure><p id="dfdf" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">由于该像素两侧的值之间的差异很大，我们可以得出结论，在该像素处有显著的转变，因此它是边缘。现在的问题是，我们必须手动完成这一步吗？</p><p id="7d0f" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">不要！有各种各样的内核可以用来突出显示图像中的边缘。我们刚刚讨论的方法也可以使用Prewitt核(在x方向)来实现。下面给出的是Prewitt内核:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mi"><img src="../Images/56f85342334b76d1d6e279fa5768a5d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*hO4oM1YyxIhdQegC.png"/></div></figure><p id="2348" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">我们将所选像素周围的值乘以所选的核(Prewitt核)。然后，我们可以将结果值相加以获得最终值。因为我们已经在一列中有-1，在另一列中有1，所以将这些值相加相当于取差。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mi"><img src="../Images/ad83a26f4157bf422df97e1b28d210e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*d2x8jOAaWMR-vNkQ.png"/></div></figure><p id="9ddc" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">还有各种其他的内核，我在下面提到了四种最常用的内核:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mo"><img src="../Images/5c9944a41766bd377f89240960a779d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*O8vFRXiBqptrY5kU.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">来源:<a class="ae kp" href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">应用机器学习课程</a></figcaption></figure><p id="b5d2" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">现在让我们回到笔记本，为同一幅图像生成边缘特征:</p><pre class="kw kx ky kz fd lw lx ly lz aw ma bi"><span id="70d0" class="mb ig hi lx b fi mc md l me mf">#importing the required libraries<br/>import numpy as np<br/>from skimage.io import imread, imshow<br/>from skimage.filters import prewitt_h,prewitt_v<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="119a" class="mb ig hi lx b fi mh md l me mf">#reading the image <br/>image = imread('puppy.jpeg',as_gray=True)</span><span id="69b4" class="mb ig hi lx b fi mh md l me mf">#calculating horizontal edges using prewitt kernel<br/>edges_prewitt_horizontal = prewitt_h(image)<br/>#calculating vertical edges using prewitt kernel<br/>edges_prewitt_vertical = prewitt_v(image)</span><span id="7613" class="mb ig hi lx b fi mh md l me mf">imshow(edges_prewitt_vertical, cmap='gray')</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mp"><img src="../Images/8695295009ca5bdfe09dfab234402d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/0*9IvnoO62Kpbwi7sG.png"/></div></figure><h1 id="df70" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结束注释</h1><p id="1ecb" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">这是一个友好的介绍，让您接触到图像数据。我觉得这是数据科学家工具箱中非常重要的一部分，因为目前生成的图像数量在迅速增加。</p><p id="b357" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">那么一旦你熟悉了这个话题，你能做什么呢？在我的下一篇文章中，我们将深入探讨接下来的步骤——很快下降！所以请关注这个空间，如果你对这篇文章有任何问题或想法，请在下面的评论区告诉我。</p><p id="c09a" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated">此外，这里有两个全面的课程，让你开始学习机器学习和深度学习:</p><ul class=""><li id="4b2c" class="jd je hi jf b jg kq ji kr jk mq jm mr jo ms jq jr js jt ju bi translated"><a class="ae kp" href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional/?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">应用机器学习:从初学者到专业人士</a></li><li id="9aa1" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><a class="ae kp" href="https://courses.analyticsvidhya.com/courses/computer-vision-using-deep-learning-version2?utm_source=blog&amp;utm_medium=3-techniques-extract-features-from-image-data-machine-learning" rel="noopener ugc nofollow" target="_blank">使用深度学习的计算机视觉</a></li></ul></div><div class="ab cl mt mu gp mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hb hc hd he hf"><p id="0497" class="pw-post-body-paragraph ka kb hi jf b jg kq kc kd ji kr ke kf jk ks kh ki jm kt kk kl jo ku kn ko jq hb bi translated"><em class="li">原载于2019年8月29日</em><a class="ae kp" href="https://www.analyticsvidhya.com/blog/2019/08/3-techniques-extract-features-from-image-data-machine-learning-python/" rel="noopener ugc nofollow" target="_blank"><em class="li">https://www.analyticsvidhya.com</em></a><em class="li">。</em></p></div></div>    
</body>
</html>