<html>
<head>
<title>Deploying a Machine Learning Model as a Flask App on Heroku -Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Heroku上部署机器学习模型作为Flask应用程序-第2部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploying-a-machine-learning-model-as-a-flask-app-on-heroku-part-2-9d8366eb784c?source=collection_archive---------11-----------------------#2020-03-11">https://medium.com/analytics-vidhya/deploying-a-machine-learning-model-as-a-flask-app-on-heroku-part-2-9d8366eb784c?source=collection_archive---------11-----------------------#2020-03-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4fb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">本教程是</em> <a class="ae je" rel="noopener" href="/@oluakintoye/deploying-a-machine-learning-model-as-a-flask-app-on-heroku-part-1-b5e194fed16d"> <em class="jd">第一部分</em> </a> <em class="jd">中关于在Heroku上部署机器学习模型作为flask app的文章的延续。在这一部分，我们将在Heroku的平台上部署web应用程序。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/c9a33958ceb35703576b3ee845d018f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yy_XmMB3_3O13cx6"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">照片由<a class="ae je" href="https://unsplash.com/@alanka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> pha tran </a>在<a class="ae je" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="20d7" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><strong class="ak"> Heroku-用于应用部署</strong></h2><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es kq"><img src="../Images/1a27529b435fac1e9162fe30336a2dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1QgLDmU6YD4rBTfijpiYA.png"/></div></div></figure><p id="f410" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Heroku是一个云平台，允许开发者完整地构建、运行和操作他们的应用程序。作为一个平台即服务(PaaS)，Heroku支持多种编程语言，这些语言被用作web应用程序开发模型。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="f7bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">至此，我们已经有了一个在本地运行的web应用程序。然而，这很难分享，但将我们的flask应用程序部署到Heroku将使人们更容易访问您的应用程序。为此，您需要执行以下操作:</p><ol class=""><li id="811f" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">注册一个<a class="ae je" href="https://signup.heroku.com/signup/dc" rel="noopener ugc nofollow" target="_blank">免费Heroku账户</a></li><li id="697e" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">安装<a class="ae je" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank"> Git </a></li><li id="8195" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">安装<a class="ae je" href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install" rel="noopener ugc nofollow" target="_blank"> Heroku CLI工具</a>。</li></ol><h1 id="78c7" class="lm jw hi bd jx ln lo lp kb lq lr ls kf lt lu lv ki lw lx ly kl lz ma mb ko mc bi translated">部署</h1><p id="ed41" class="pw-post-body-paragraph if ig hi ih b ii md ik il im me io ip iq mf is it iu mg iw ix iy mh ja jb jc hb bi translated">在部署应用程序之前，我们必须在webapp文件夹中创建几个文件:</p><ol class=""><li id="03c9" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">requirements.txt:这是一个文本文件，向Heroku指明构建应用程序时使用的依赖项或包。即flask、sklearn、gunicorn</li></ol><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="3459" class="jv jw hi mj b fi mn mo l mp mq">flask<br/>pandas<br/>numpy<br/>sklearn<br/>gunicorn</span></pre><p id="58f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.Procfile:这是一个没有扩展名的文件，是我们的主机平台Heroku固有的，应该表明我们正在使用一个web服务，给出了它的配置细节。Procfile帮助heroku检测应用程序应该从哪里开始。</p><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="d632" class="jv jw hi mj b fi mn mo l mp mq">web: gunicorn -b :$PORT app:app</span></pre></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="8b06" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">生产Web堆栈</h2><p id="8055" class="pw-post-body-paragraph if ig hi ih b ii md ik il im me io ip iq mf is it iu mg iw ix iy mh ja jb jc hb bi translated">将flask应用程序部署到生产环境中时，有一些重要事项需要注意:</p><p id="0b85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Flask内置的开发web服务器非常适合测试，但不应该用于生产。它不适合，因为它不能很好地伸缩，并且默认情况下一次只能服务一个请求。</p><p id="bd66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过在生产环境中运行web应用程序，我们希望它能够处理多个用户请求，而不必在获得响应之前等待很长时间。为此，应使用生产堆栈。</p><p id="9400" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生产设置由多个组件组成，这些组件专为某一特定事物而构建和设计。生产堆栈中的通信类似于flask的内置web服务器；通过HTTP。</p><p id="42c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总之，在生产中运行flask时，请确保:</p><ol class=""><li id="8d58" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">使用生产就绪的网络服务器，如<strong class="ih hj"> Nginx </strong></li><li id="2523" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">让T2的WSGI T3应用服务器来处理你的应用，比如T4的guni corn T5</li></ol><p id="7ff4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还要注意，当在Heroku上运行时，已经隐式地提供了一个web服务器，您应该在Procfile中指定一个命令来运行应用服务器(在我们的例子中是Gunicorn)。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="f17e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在创建了上述必需的文件之后，它们应该放在我们的app.py所在的目录中。下一步是使用您的终端来定位您的web应用程序文件夹，然后运行以下命令。</p><h2 id="333c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">为web应用程序创建一个git存储库:</h2><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="dd5c" class="jv jw hi mj b fi mn mo l mp mq">git init</span></pre><h2 id="e2d1" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">使用Heroku登录:</h2><p id="2569" class="pw-post-body-paragraph if ig hi ih b ii md ik il im me io ip iq mf is it iu mg iw ix iy mh ja jb jc hb bi translated">注册heroku帐户后，您可以使用CLI登录</p><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="a208" class="jv jw hi mj b fi mn mo l mp mq">heroku login</span></pre><p id="b099" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">系统会提示您按下任何键来打开默认的网络浏览器，然后您就可以登录了</p><h2 id="0836" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">创建新的Heroku应用程序:</h2><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="2269" class="jv jw hi mj b fi mn mo l mp mq">heroku create [web app name]</span></pre><p id="4991" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们正在创建一个heroku应用程序，其中[web应用程序名称]将是您首选的web应用程序名称。例如，<em class="jd"> " heroku create wine-qual" </em>，其中wine-qual是我们首选的web应用程序名称。</p><h2 id="e925" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">将文件添加到存储库:</h2><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="f428" class="jv jw hi mj b fi mn mo l mp mq">git add .<br/>git commit -m "First"</span></pre><h2 id="ba27" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">设置远程存储库:</h2><p id="925a" class="pw-post-body-paragraph if ig hi ih b ii md ik il im me io ip iq mf is it iu mg iw ix iy mh ja jb jc hb bi translated">这个命令设置远程repo，以便使用git从我们的本地web应用程序推送到Heroku。</p><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="e731" class="jv jw hi mj b fi mn mo l mp mq">heroku git:remote -a [web app name]</span></pre><h2 id="9d08" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">将您的应用推向网络:</h2><p id="3f64" class="pw-post-body-paragraph if ig hi ih b ii md ik il im me io ip iq mf is it iu mg iw ix iy mh ja jb jc hb bi translated">这个命令将上传你的文件，安装它需要的软件包，并让应用程序在线运行！。</p><pre class="jg jh ji jj fd mi mj mk ml aw mm bi"><span id="5598" class="jv jw hi mj b fi mn mo l mp mq">git push heroku master</span></pre><p id="f74b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一切正常，请转到您的[app-name].herokuapp.com，当然是用您选择的应用程序名称替换[app-name]。如果这样做之后，你看到了某种服务器错误，请确保检查你的应用程序，登录heroku并寻找你的heroku错误代码<a class="ae je" href="https://devcenter.heroku.com/articles/error-codes" rel="noopener ugc nofollow" target="_blank">以正确调试。</a></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mr"><img src="../Images/2a81c6fe187434eab7e2e9776fca14ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_P_GQ8LsGsAnzTQ8mdBxw.jpeg"/></div></div></figure><p id="9782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">瞧啊。，您已经成功地部署了一个功能性的web应用程序，它可以将您的模型的结果与其他人进行交流。</p><p id="ec43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一定要分享给别人看。如果你有任何反馈，请与我分享。请随时通过<a class="ae je" href="https://www.linkedin.com/in/oluakintoye/" rel="noopener ugc nofollow" target="_blank"> Linkedln </a>与我联系。感谢阅读。</p></div></div>    
</body>
</html>