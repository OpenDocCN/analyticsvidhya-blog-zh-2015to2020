<html>
<head>
<title>Predicting Revenue with Gamma Distribution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用伽玛分布预测收入</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-gamma-distribution-and-its-applications-in-the-mobile-app-industry-2ba891d8b7f4?source=collection_archive---------6-----------------------#2020-05-09">https://medium.com/analytics-vidhya/the-gamma-distribution-and-its-applications-in-the-mobile-app-industry-2ba891d8b7f4?source=collection_archive---------6-----------------------#2020-05-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9fc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好！<br/>今天，我们将从移动应用行业的角度来回顾伽玛分布。<br/>我在构建我的第一个生命周期价值模型时第一次使用了这种分布，我认为这是在公司工作的任何数据科学家都应该知道的一种基本分布，这种分布涉及收集用户信息，尤其是最重要的信息，即这些用户为您的公司带来的收入。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="b16e" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">伽玛分布</strong></h1><p id="f07c" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">伽玛分布是一个双参数连续概率分布族。<br/>伽玛分布的概率密度函数可以表示为:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es kn"><img src="../Images/cd87fff16ec66fd0cc3c8fcd8f26316a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*botX-G8xeie5aarEqaUUFw.png"/></div></figure><p id="959b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它有两个参数，<strong class="ih hj"> alpha </strong> -代表<em class="kv">形状</em>参数，<strong class="ih hj"> beta- </strong>代表<em class="kv">比例</em>参数，它的支撑只由正值组成。<br/>我通常不喜欢在不解释的情况下抛出定义，所以我为那些想知道为什么这些参数被称为“形状”和“比例”的好奇者增加了一小段关于这两个参数的内容。如果您愿意，可以随意进入下一部分。</p><p id="3e8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kv">形状和比例参数<br/> </em>那么这两个参数到底是什么意思呢？<br/>我们可以通过一个例子来看。我们从α开始。<br/>要查看更改alpha对pdf函数的影响，让我们查看下图:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kw"><img src="../Images/42e707514b5577ab877e8c4195916c71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6u5ihwcJsXdp6PyIa6DB2w.png"/></div></div></figure><p id="0097" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们看到了为什么阿尔法得到了它的名字作为形状参数-越大的阿尔法-更多的pdf将其形状向右移动。<br/>如果我们将alpha设为3(随机选择)，并将beta设为我们的变量，图像将会是:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kw"><img src="../Images/fed64d818b1330f9293e6d5b66911f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-Qa1aicdQ2NZ48Xjg01Ig.png"/></div></div></figure><p id="ebfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们看到β负责密度函数的振幅。从数学上来说，这很容易说明，但是因为这不是我这篇文章的主要目标，我们将转到更有趣的部分。<br/>关于伽马分布的更多信息，你可以阅读Aerin Kim关于这个主题的伟大文章。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="e356" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">动机</strong></h1><p id="41c2" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">Gamma发行版有很多应用，但与移动应用领域最相关的应用是…预测收入！</p><p id="fbd1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更准确地说，我们将使用伽玛分布来预测您的用户的每笔交易的预期收入。</p><p id="68e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为什么是伽马？<br/> </strong>首先，手头的变量是连续的，我们只得到每个用户的预期收益的正值(在这种情况下我们会忽略非付费用户，他们的预期收益实际上是0，对我们来说没那么有趣:)。<br/>选择伽马分布的另一个原因是它的曲线。让我们看看伽玛分布产生的以下曲线:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es lc"><img src="../Images/0235927a55d7c0311a6ecb8817b91147.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*rnNMcq5YNToroAKFoRcAgQ.png"/></div></figure><p id="1314" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你正在开发一个FTP(免费游戏)应用程序，你的每用户收入直方图看起来将非常类似于上图中的红色曲线。有很多“低支付者”，即购买量较小的支付者，只有极少数“高消费者”，即平均交易金额较大的支付者。<br/>这就是我们在这种情况下选择伽玛的原因。<br/> <strong class="ih hj">为什么不直接计算平均值？</strong> <br/>正如我们在统计学的第一课中所知，当我们试图估计某个随机变量的期望值时，简单平均值可以用作随机变量期望值的无偏估计量。嗯，在我们的情况下……可能不是这样的。<br/>假设用户购买了1次，金额为1.99美元。你会说这个用户的预期交易价值是1.99美元吗？<br/>仅通过一次观察，很难对期望值做出很好的估计，而且考虑到我们的大多数用户不会购买很多东西，我们将需要使用某种先验知识来消除这些方法的偏差。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="1511" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">形成期望</h1><p id="82c3" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">对于具有x个事务的给定用户，设z1，z2，…zn表示每笔交易的美元价值。<br/>我们假设每笔交易的价值围绕用户(未观察到的)平均交易价值E(M)随机变化。<br/>在这种情况下，客户观察到的平均交易价值将为:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es ld"><img src="../Images/c5a8744d41d9dc2418117ff387a796a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*aGkM_56PCthKelUGOYckyw.png"/></div></figure><p id="9d57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们假设Zi是iid伽马分布变量，具有形状参数<em class="kv"> p </em>和比例参数<em class="kv"> v </em>。<br/>利用涉及伽马分布的两个标准关系:</p><p id="0a70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kv">我</em> </strong>。x iidγ(p，ν)个随机变量之和为分布γ，形状参数为px，尺度参数为ν。<br/> <strong class="ih hj"> <em class="kv"> ii </em> </strong>。乘以标量1/x的伽马(px，ν)随机变量本身是具有形状参数<em class="kv"> px </em>和比例参数<em class="kv"> νx </em>的分布伽马</p><p id="e56a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结合这两个已知的性质，我们得到平均观察事务值，<em class="kv"> mx，</em>也是以这个<em class="kv"> px </em>为形状参数，<em class="kv"> vx </em>为尺度参数的伽玛分布。它的pdf可以表示为:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es le"><img src="../Images/d40342eb1ffb5d0a173d5bd0fd6d7fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*pqrOXLRUmchi5cEINa5DCA.png"/></div></figure><p id="35f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，我们已经处理了观察到的部分，但是请记住，我们还需要考虑用户交易数量较少的情况，输入贝叶斯定理来帮助我们！</p><p id="e780" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">添加先验信息</strong></p><p id="5de5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了说明跨用户的潜在平均交易值的异质性，我们假设ν的值根据具有形状参数<em class="kv"> q </em>和比例参数<em class="kv"> γ的伽马分布分布在整个群体中。<br/></em></p><p id="1851" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在应用Bayes定理找到v的后验分布后，我们得到v是伽玛分布，具有:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es lf"><img src="../Images/d4b3a79d2dd11f7b56806cb46c601225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*SyQ8X077Vzsh61FzTDIU6A.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">v的后验分布</figcaption></figure><p id="f144" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这里，我们可以找到用户交易价值的后验期望值:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es lk"><img src="../Images/7fdd8cfe0ae4dd16da7085eb1ae3809b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*JHhaKib1IO8A_bOUEFYUAQ.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">mx的后验期望值</figcaption></figure><p id="df7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，期望值可以用加权平均来解释。<br/> <strong class="ih hj"> w1 </strong>是分配给我们先验知识的权重，其中<strong class="ih hj"> w2 </strong>是分配给实际数据的权重。<br/>我们掌握的证据越多，即<em class="kv"> x </em>越大，则<strong class="ih hj"> w2 </strong>相对于<strong class="ih hj"> w2 </strong>越大，这导致我们更相信实际数据，即我们之前覆盖的平均交易统计。<br/>所以对于有很多交易的用户来说，简单均值和后验期望会显示出接近相同的值。就是交易不多的用户会把后验预期推得比简单均值好很多。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="1954" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">性能</strong></h1><p id="859f" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">那么与简单均值相比，后验期望有多好呢？<br/>让我们用下图来回顾一下这两个估计器的性能:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ll"><img src="../Images/fb675de186727cfaf2624a1f427492e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IW7ObPg-dtUX6pGUnBocMw.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">两种估计量的性能</figcaption></figure><p id="1fa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Y轴上，这是绝对误差度量，即从“实际”期望值到估计的期望交易值的绝对误差。<br/>“真实”在这里指的是一个用户在应用中使用一年后的平均交易价值——所以它捕捉到了用户一生中在应用中的大部分交易。<br/>在X轴上，它是发生估算时用户进行的最大购买次数。<br/>例如，图中第一个点显示了后验期望(红色)和朴素均值(青色)的表现，在仅给定1笔交易的情况下，尽力估计用户的真实期望交易值。关于第二点，他们正在做同样的事情，但是现在他们要处理≤2个事务，等等。</p><p id="4a7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，后验预期的力量体现在低付费用户身上，他们没有很多信息可以利用，所以先验知识在这个区域协助我们。随着我们有更多的证据，这两个估计量不出所料地彼此接近。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="a438" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">总结</strong></h1><p id="042c" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在本文中，我介绍了一种方法来估计移动应用领域中用户的预期交易价值。<br/>这篇文章中我遗漏的主要内容是关于如何实现参数估计以达到后验期望的数学过程。<br/>这是一个相当全面的解释，但简而言之，人们需要创建似然函数，并尝试通过梯度下降或其他类型的数值优化算法来优化它。<br/>我希望您发现它很有用，并在日常工作中尝试一下。</p><p id="6170" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">迈克尔</p></div></div>    
</body>
</html>