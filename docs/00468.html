<html>
<head>
<title>Predictive Modeling for Tanzanian Water Pumps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">坦桑尼亚水泵的预测建模</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predictive-modeling-for-tanzanian-water-pumps-701bcc7760b2?source=collection_archive---------3-----------------------#2019-07-02">https://medium.com/analytics-vidhya/predictive-modeling-for-tanzanian-water-pumps-701bcc7760b2?source=collection_archive---------3-----------------------#2019-07-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/d796e2218d232b36764c54be38af7749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*13eTNzkTNtrL23ksafPwqg.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">坦桑尼亚是塞伦盖蒂平原的故乡。<a class="ae hv" href="https://www.harpersbazaar.com/culture/travel-dining/a17259/how-to-plan-your-first-safari/" rel="noopener ugc nofollow" target="_blank">图片信用</a></figcaption></figure><div class=""/><div class=""><h2 id="7c17" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">Kaggle竞赛演练</h2></div><p id="6db9" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这篇文章将从文本和视觉上阐述我的预测建模过程，从最初的探索到超参数调整。我们将探索一个充斥着缺失记录和重复信息的数据集，然后尝试建立一个准确的模型来预测一个给定的水泵是在运行、需要维修还是不起作用。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h2 id="0033" class="kq kr hy bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">阶段1:导入数据并熟悉</h2><p id="8d6b" class="pw-post-body-paragraph jn jo hy jp b jq ll iz js jt lm jc jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">大多数Kaggle比赛的数据都可以在比赛信息中以. csv文件的形式找到。Pandas提供了一种简单的方法来导入一个. csv文件作为Pandas DataFrame对象；<a class="ae hv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank"> pd.read_csv() </a>。</p><p id="872d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我通常发现，在一头扎进清理、争论和特征工程之前，检查数据集的个体质量是有帮助的。并非每个数据集都是相同的，不同的数据需要不同的攻击计划。Pandas为我们提供了<code class="du lq lr ls lt b">.info()</code>，它打印了数据帧的形状(59，400个实例和43个特性)、特性名称、特性类型、每个特性的非空值计数以及数据帧的内存使用情况(19.9 MB)；它是一匹真正的老黄牛。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="bf24" class="kq kr hy lt b fi mc md l me mf">df.info()<br/>____________________________________________________________________&lt;class 'pandas.core.frame.DataFrame'&gt; <br/>Int64Index: 59400 entries, 0 to 59399<br/>Data columns (total 43 columns):</span><span id="2e15" class="kq kr hy lt b fi mg md l me mf">key_0                    59400 non-null int64 <br/>id_x                     59400 non-null int64 <br/>amount_tsh               59400 non-null float64 <br/>date_recorded            59400 non-null object <br/>funder                   55765 non-null object <br/>gps_height               59400 non-null int64 <br/>installer                55745 non-null object <br/>longitude                59400 non-null float64 <br/>latitude                 59400 non-null float64 <br/>wpt_name                 59400 non-null object <br/>num_private              59400 non-null int64 <br/>basin                    59400 non-null object <br/>subvillage               59029 non-null object <br/>region                   59400 non-null object <br/>region_code              59400 non-null int64 <br/>district_code            59400 non-null int64 <br/>lga                      59400 non-null object <br/>ward                     59400 non-null object <br/>population               59400 non-null int64 <br/>public_meeting           56066 non-null object <br/>recorded_by              59400 non-null object <br/>scheme_management        55523 non-null object <br/>scheme_name              31234 non-null object <br/>permit                   56344 non-null object <br/>construction_year        59400 non-null int64 <br/>extraction_type          59400 non-null object <br/>extraction_type_group    59400 non-null object <br/>extraction_type_class    59400 non-null object <br/>management               59400 non-null object <br/>management_group         59400 non-null object <br/>payment                  59400 non-null object <br/>payment_type             59400 non-null object <br/>water_quality            59400 non-null object <br/>quality_group            59400 non-null object <br/>quantity                 59400 non-null object <br/>quantity_group           59400 non-null object <br/>source                   59400 non-null object <br/>source_type              59400 non-null object <br/>source_class             59400 non-null object <br/>waterpoint_type          59400 non-null object <br/>waterpoint_type_group    59400 non-null object <br/>id_y                     59400 non-null int64 <br/>status_group             59400 non-null object </span><span id="3baa" class="kq kr hy lt b fi mg md l me mf">dtypes: float64(3), int64(9), object(31) <br/>memory usage: 19.9+ MB</span></pre><p id="142f" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">标签</strong></p><p id="02c9" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">有三种可能的值:</p><ul class=""><li id="f5c8" class="mh mi hy jp b jq jr jt ju jw mj ka mk ke ml ki mm mn mo mp bi translated">功能性:供水点可以使用，不需要维修</li><li id="5686" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">功能需要修复:供水点可以运行，但需要修复</li><li id="02b3" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">不起作用:水点不起作用</li></ul><p id="6196" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">特性</strong></p><p id="24ba" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">您的目标是为数据集中的每个记录预测水点的运行条件。</p><ul class=""><li id="2527" class="mh mi hy jp b jq jr jt ju jw mj ka mk ke ml ki mm mn mo mp bi translated">amount_tsh:总静压头(水点可用水量)</li><li id="b4fa" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">date_recorded:输入行的日期</li><li id="ced6" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">出资人:谁出资的油井</li><li id="4e25" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">gps_height:井的高度</li><li id="5917" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">安装者:安装油井的组织</li><li id="83a4" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">经度:GPS坐标</li><li id="914e" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">纬度:GPS坐标</li><li id="5a3e" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">wpt_name:水点的名称(如果有)</li><li id="2418" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">num_private:是否私人使用</li><li id="08a0" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">盆地:地理流域</li><li id="e611" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">子村:地理位置</li><li id="d076" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">区域:地理位置</li><li id="ffb6" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">region_code:地理位置(编码)</li><li id="38aa" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">地区代码:地理位置(编码)</li><li id="dc28" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">lga:地理位置</li><li id="afae" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">病房:地理位置</li><li id="e13e" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">人口:井周围的人口</li><li id="ae5f" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">public_meeting:真/假</li><li id="0578" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">recorded_by:进入该行数据的组</li><li id="754f" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">方案_管理:谁在操作水点</li><li id="333f" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">scheme_name:谁在操作水点</li><li id="bb10" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">允许:如果水点是允许的</li><li id="1154" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">建造年份:供水点建造的年份</li><li id="32de" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">extraction _ type:water point使用的提取类型</li><li id="abc7" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">extraction _ type _ group:water point使用的提取类型</li><li id="dbf9" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">extraction _ type _ class:water point使用的提取类型</li><li id="4b0f" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">管理:如何管理水点</li><li id="c31b" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">管理组:如何管理水点</li><li id="f062" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">付款:水的价格</li><li id="cb54" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">付款类型:水的价格</li><li id="79d3" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">水质:水的质量</li><li id="caaa" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">quality_group:水的质量</li><li id="ef49" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">数量:水的数量</li><li id="93c2" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">数量_组:水的数量</li><li id="a6d4" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">来源:水的来源</li><li id="635a" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">source_type:水的来源</li><li id="3d03" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">source_class:水的来源</li><li id="e9fc" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">水点类型:水点的种类</li><li id="51e8" class="mh mi hy jp b jq mq jt mr jw ms ka mt ke mu ki mm mn mo mp bi translated">水点类型组:水点的类型</li></ul></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h2 id="5232" class="kq kr hy bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">阶段2:清理、争论和工程特性</h2><p id="d2e5" class="pw-post-body-paragraph jn jo hy jp b jq ll iz js jt lm jc jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">第一次攻击数据集时，找到一个好的起点并不是一件小事，因为通常有多个明显的地方可以开始清理、特征工程和探索性分析。我将在这里为读者提供一些安慰的话:选择一个开始的地方，相信你的直觉，开始编码。如果你碰壁了，不要害怕撤退，重组，并攻击其他地方。它——而且——你会没事的。我们将从用<a class="ae hv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.replace.html" rel="noopener ugc nofollow" target="_blank"> df.replace() </a>清理construction_year特性开始。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="b83e" class="kq kr hy lt b fi mc md l me mf">features['construction_year'].replace({0:1993})<br/># 1993 is an arbitrarily chosen year</span></pre><p id="4390" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">特色工程</strong></p><p id="4841" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">利用这种清洁的建造年份特征，我们可以设计泵的年龄和每年供应的平均pop特征。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="3f6a" class="kq kr hy lt b fi mc md l me mf">features['age'] = features['date_recorded'] - features['construction_year']</span><span id="41d8" class="kq kr hy lt b fi mg md l me mf">features['pop/year'] = features['population'] / features['age']</span></pre><p id="ae48" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们可以通过创建一个特征来表示井口服务的每个人可以获得的理论水量，从而进一步发展我们的特征工程。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="91eb" class="kq kr hy lt b fi mc md l me mf">features['water/person'] = features['amount_tsh'] / features['population']</span></pre><p id="48a0" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">编码</strong></p><p id="345e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">编码有助于量化分类数据或定性数据。有一个不断扩展的<a class="ae hv" href="https://contrib.scikit-learn.org/categorical-encoding/" rel="noopener ugc nofollow" target="_blank">编码方法库</a>专注于不同类型的数据。我们将对低基数特性使用一种热编码，对高基数特性使用顺序编码。我们还在数据上使用空值<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank">输入</a>和<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html" rel="noopener ugc nofollow" target="_blank">标准缩放</a>，以便在将数据输入到模型之前对其进行清理。</p><p id="a02d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">探索性可视化</strong></p><p id="8a44" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">探索数据的一个聪明方法是创建可视化。这是一个非常自由的过程，而且每个数据集都是不同的，所以没有一个放之四海而皆准的策略。由于这部分代码非常密集，我将只展示可视化，但是，如果你对代码感兴趣，在这篇文章的结尾有一个到colab笔记本的链接。</p><p id="9374" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">由于我们数据集中的水泵是固定设备，这有助于可视化它们的地理位置。</p><figure class="lu lv lw lx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mv"><img src="../Images/51024739a0dc0ff3880737d041df7af3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PsJCo6TjEgsSILnZlCwfmQ.jpeg"/></div></div></figure><p id="7006" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">一个泵的经纬度和它的状态之间似乎没有明确的关系。然而，有许多非常不同的泵群看起来具有相同的状态。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h2 id="1f1c" class="kq kr hy bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">阶段3:构建基线模型和过度拟合模型</h2><p id="60b7" class="pw-post-body-paragraph jn jo hy jp b jq ll iz js jt lm jc jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">我们将建立一个基线模型来设定我们预测能力的下限。我特别喜欢使用多数类预测作为基线，因为这很容易理解。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="2f0e" class="kq kr hy lt b fi mc md l me mf">X_matrix, y_vector = df.drop(columns='status_group'), df['status_group']</span><span id="8c92" class="kq kr hy lt b fi mg md l me mf">majority_class = y_vector.mode()</span><span id="605f" class="kq kr hy lt b fi mg md l me mf">y_vector.value_counts(normalize=True)</span><span id="d7a3" class="kq kr hy lt b fi mg md l me mf">____________________________________________________________________</span><span id="ef03" class="kq kr hy lt b fi mg md l me mf">functional                 0.543081 <br/>non functional             0.384242 <br/>functional needs repair    0.072677 <br/>Name: status_group, dtype: float64</span></pre><p id="dbf2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">由于54%的实例处于功能状态，我们预计我们的多数类预测的准确度约为54%。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="411e" class="kq kr hy lt b fi mc md l me mf">from sklearn.metrics import accuracy_score</span><span id="0b1c" class="kq kr hy lt b fi mg md l me mf">majority_prediction = [majority_class] * len(y_vector)</span><span id="b55d" class="kq kr hy lt b fi mg md l me mf">accuracy_score(y_vector, majority_prediction)</span><span id="1693" class="kq kr hy lt b fi mg md l me mf">____________________________________________________________________</span><span id="d63e" class="kq kr hy lt b fi mg md l me mf">0.543080808080808</span></pre><p id="4078" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">太棒了，我们现在对未来的预测有了底线。</p><p id="1b74" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们创建一个模型，使我们的数据过度拟合，以确保我们能够做出有价值的预测。对于这个任务，我通常选择一个<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html" rel="noopener ugc nofollow" target="_blank">决策树</a>。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="efb8" class="kq kr hy lt b fi mc md l me mf">from sklearn.tree import DecisionTreeClassifier</span><span id="d68b" class="kq kr hy lt b fi mg md l me mf">decision_tree = DecisionTreeClassifier(max_depth=50)</span><span id="b989" class="kq kr hy lt b fi mg md l me mf">decision_tree.fit(X_matrix, y_vector)</span><span id="b787" class="kq kr hy lt b fi mg md l me mf">____________________________________________________________________</span><span id="b3d8" class="kq kr hy lt b fi mg md l me mf">DecisionTreeClassifier<br/>(class_weight=None, criterion='gini',     max_depth=50,max_features=None, max_leaf_nodes=None,                        min_impurity_decrease=0.0, min_impurity_split=None,                        min_samples_leaf=1, min_samples_split=2,                        min_weight_fraction_leaf=0.0, presort=False,                        random_state=None, splitter='best')</span></pre><p id="616c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">通过使用混淆矩阵，我们可以看到我们的过度拟合模型的表现。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="210f" class="kq kr hy lt b fi mc md l me mf">from sklearn.metrics import classification_report, confusion_matrix<br/>import seaborn as sns</span><span id="de89" class="kq kr hy lt b fi mg md l me mf">def con_matrix_analysis(model):<br/>  x = model.predict(X_matrix)<br/>  <br/>  print(classification_report(y_vector, x,<br/>        target_names=['Functional', 'Needs Repair', 'Not-Functional']))</span><span id="604e" class="kq kr hy lt b fi mg md l me mf">  con_matrix = pd.DataFrame(confusion_matrix(y_vector, x), <br/>             columns=['Predicted Functional', 'Predicted Needs  Repair', 'Predicted Not-Functional'], <br/>             index=['Actual Functional', 'Actual Needs Repair', 'Actual Not-Functional'])<br/>                            <br/>  sns.heatmap(data=con_matrix, cmap='cool')<br/>  plt.show();<br/>  return con_matrix</span><span id="b6e9" class="kq kr hy lt b fi mg md l me mf">con_matrix_analysis(decision_tree)</span></pre><figure class="lu lv lw lx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mw"><img src="../Images/568443df87b6727b005a4f8f88922096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sCF44SC8wwuZoGn00W2ryQ.png"/></div></div></figure></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h2 id="9541" class="kq kr hy bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">阶段4:建立一个精确的模型并调整它的超参数</h2><p id="f2bd" class="pw-post-body-paragraph jn jo hy jp b jq ll iz js jt lm jc jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">我们将为我们的最终模型使用一个<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank">随机森林分类器</a>。随机森林就像它听起来的那样，是一个决策树的森林。我们还将使用<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html" rel="noopener ugc nofollow" target="_blank">随机搜索交叉验证</a>从各种超参数设置中选择最佳模型。</p><p id="1e65" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">基于我们的交叉验证，具有最准确结果的随机森林分类器是具有92个估计器和最大深度26的模型。当我们将选择的模型传递给我们的混淆矩阵分析函数时，我们得到了下面的结果。</p><figure class="lu lv lw lx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mx"><img src="../Images/9fb64489793806513b50b31e8ae97435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m_x8iHgy6QqGnuqmVgwCng.png"/></div></div></figure><h2 id="5dad" class="kq kr hy bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">阶段5:预测和导出</h2><p id="df5c" class="pw-post-body-paragraph jn jo hy jp b jq ll iz js jt lm jc jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">我们流程的最后一个阶段是使用我们的模型来预测X_test数据帧中包含的泵的状态，将该数据帧转换为. csv文件，并从我们的环境中导出该文件。Pandas再次伸出援手，用<a class="ae hv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_csv.html" rel="noopener ugc nofollow" target="_blank"> pd.to_csv() </a>将数据帧转换成。csv文件。</p><pre class="lu lv lw lx fd ly lt lz ma aw mb bi"><span id="5a0c" class="kq kr hy lt b fi mc md l me mf">prediction = model.predict(X_test)</span><span id="484e" class="kq kr hy lt b fi mg md l me mf">submission['status_group'] = prediction</span><span id="1c56" class="kq kr hy lt b fi mg md l me mf">submission.to_csv('submission_1.csv', index=False)</span><span id="d2fc" class="kq kr hy lt b fi mg md l me mf">from google.colab import files<br/>files.download('submission_1.csv')</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><p id="36ac" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我希望我已经为读者提供了一个易于理解且内容丰富的关于Kaggle竞争、机器学习和数据科学任务的介绍。对于那些感兴趣的人，我在这个项目中使用的Colab笔记本链接如下。</p><p id="0829" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在T <a class="ae hv" href="https://twitter.com/matt42kirby" rel="noopener ugc nofollow" target="_blank"> witter </a>、<a class="ae hv" href="https://github.com/mkirby1995" rel="noopener ugc nofollow" target="_blank"> GitHub </a>、<a class="ae hv" href="https://www.linkedin.com/in/mathew-kirby-082062ba/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我</p><p id="f67f" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是我在这篇文章中使用的Colab笔记本的链接。</p><figure class="lu lv lw lx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es my"><img src="../Images/7bd6cf240f7f42dd9ae1e22dae2ae938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W87v99m7Xf_L7DST0lRb6A.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://www.serengeti.com/" rel="noopener ugc nofollow" target="_blank">形象信用</a></figcaption></figure></div></div>    
</body>
</html>