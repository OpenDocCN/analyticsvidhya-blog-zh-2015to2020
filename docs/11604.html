<html>
<head>
<title>Web Scraping in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中的网页抓取</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/web-scraping-in-r-cbb771cd0061?source=collection_archive---------13-----------------------#2020-12-10">https://medium.com/analytics-vidhya/web-scraping-in-r-cbb771cd0061?source=collection_archive---------13-----------------------#2020-12-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="6a40" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">使用 rvest 和 dplyr 进行数据提取和数据分析</strong></h2></div><blockquote class="ix iy iz"><p id="8f6d" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jd hj"> <em class="hi">什么是网页抓取？</em> </strong></p></blockquote><p id="1321" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">刮基本上是指提取某物。因此，在计算机科学中，网络抓取意味着从网站中提取数据。收集这些数据，然后将其导出为对用户更有用的格式。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ka"><img src="../Images/56e29d329118d0f755ab71a4a6cfd50f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NcZQGh6gDsYqHB83MDOccg.jpeg"/></div></div></figure><p id="654a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在，我们将从亚马逊网站上抓取数据。我们将删除惠普和戴尔两家公司的笔记本电脑价格数据。因此，首先，加载一些将帮助我们抓取的库</p><pre class="kb kc kd ke fd km kn ko kp aw kq bi"><span id="fdbb" class="kr ks hi kn b fi kt ku l kv kw">library(xml2)<br/>library(rvest)<br/>library(dplyr)</span></pre><p id="f8b9" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">如果您还没有安装这些软件包，那么您首先通过以下命令安装它们</p><pre class="kb kc kd ke fd km kn ko kp aw kq bi"><span id="9823" class="kr ks hi kn b fi kt ku l kv kw">install.packages("xml2")<br/>install.packages("rvest")<br/>install.packages("dplyr")</span></pre><blockquote class="ix iy iz"><p id="538e" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jd hj"> <em class="hi"> xml2 </em> </strong> <em class="hi">库帮助我们读取 Html 文本，它从节点中提取各种组件。</em></p><p id="880e" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jd hj"> <em class="hi"> rvest </em> </strong> <em class="hi">帮助我们从网页中抓取信息。</em></p><p id="7598" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jd hj"> <em class="hi"> dplyr </em> </strong> <em class="hi">库帮助我们进行数据操作，如数据排序等。</em></p></blockquote><p id="932b" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在，转到您想要删除的页面。我使用了一个 chrome 扩展“SelectorGadget”来检查元素。不同的浏览器有不同的扩展名，例如 Mozilla Firefox 有一个名为“ScrapeMate Beta”的扩展名，其他浏览器有其他扩展名。因此，您可以添加这种类型的扩展，以便用浏览器在任何网页上选择数据。</p><h1 id="4dcf" class="kx ks hi bd ky kz la lb lc ld le lf lg io lh ip li ir lj is lk iu ll iv lm ln bi translated"><strong class="ak">第一步</strong></h1><p id="58c6" class="pw-post-body-paragraph ja jb hi jd b je lo ij jg jh lp im jj jx lq jm jn jy lr jq jr jz ls ju jv jw hb bi translated">复制你想要废弃的网页的链接，并存储在任意变量中。然后，阅读这个 HTML 页面。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es lt"><img src="../Images/e7470358328fcd54630d5c9dc0456e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*hi0Gat0h-1ZLILN3eCCDtQ.png"/></div></figure><h1 id="5206" class="kx ks hi bd ky kz la lb lc ld le lf lg io lh ip li ir lj is lk iu ll iv lm ln bi translated">第二步</h1><p id="4de3" class="pw-post-body-paragraph ja jb hi jd b je lo ij jg jh lp im jj jx lq jm jn jy lr jq jr jz ls ju jv jw hb bi translated">因为我想取消项目的价格和名称。因此，我将选择项目的价格和名称，您可以选择其中的任何一个，链接将由包含该页面上所有项目的价格和名称的扩展生成。将有两个单独的链接生成一个价格和另一个名称。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lu"><img src="../Images/fdd56503918b39de07d19e3c4a66e55c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o8-XzINpTqwCe0iZcFXRZw.png"/></div></div></figure><p id="e205" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">正如你所看到的，我有一个绿色项目的选定价格，所有价格都是自动选择的。链接也生成了，你可以在底部的右边看到它。<br/>通过选择项目的名称，另一个链接将像这样生成。现在是写一些代码的时候了。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es lv"><img src="../Images/ad8aba7e27ff0deb2f70eb23c72d970d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*JYQaPdq1DEP9rbGGciszpA.png"/></div></figure><p id="d6d7" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">本代码中“%&gt;%”含义与<br/> x=c(8，99，78，88)<br/><strong class="jd hj">x %&gt;% plot()</strong><br/>或<br/> <strong class="jd hj"> plot(x) </strong> <br/>两者相同。我希望你已经明白了。所以，价格和名字存储在这些变量中，你可以在图中看到。</p><h1 id="6d66" class="kx ks hi bd ky kz la lb lc ld le lf lg io lh ip li ir lj is lk iu ll iv lm ln bi translated"><strong class="ak">第三步</strong></h1><p id="d48b" class="pw-post-body-paragraph ja jb hi jd b je lo ij jg jh lp im jj jx lq jm jn jy lr jq jr jz ls ju jv jw hb bi translated">创建数据框并将其转换为 CSV 文件。所以，我们可以用它来可视化。并且在 CSV 文件中，我们可以更好地了解这些信息。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es lw"><img src="../Images/fe47b36c72f1f21c45f4ef9aa9b7579d.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*hoanVVMy6vQYjwV73D3w7Q.png"/></div></figure><p id="bb6a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这种技术只适用于一个网页。如果我们想抓取多页。</p><blockquote class="ix iy iz"><p id="3edd" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jd hj"> <em class="hi">一次刮多页</em> </strong></p></blockquote><p id="de84" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">如果你已经在一个页面上完成了抓取，那么对你来说这不是一个困难的任务。我们有同样的代码，只是有一些小的改动。首先，您需要查找链接，并找到当您单击“下一步”转到下一页时链接部分发生变化的位置。</p><p id="0d35" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">例如，链接是<a class="ae lx" href="http://www.dummy.com/tittles/ttyr" rel="noopener ugc nofollow" target="_blank">www.dummy.com/tittles/movie</a></p><p id="6c40" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在，当点击“下一步”时，链接将会是这样的【www.dummy.com/titiles/moviespage=1 T2】或链接中的任何其他类型的更改。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ly"><img src="../Images/c14f68b822ac7dd3355a7b645f1e109a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXp037xXngrrVTfOIWKVLA.png"/></div></div></figure><p id="9809" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">首先，我创建了一个 for 循环，这样我们可以很容易地转到下一页。在链接中，我放了一个<strong class="jd hj">变量</strong> name <strong class="jd hj"> page_no，</strong>这样链接会随着循环的迭代而改变。如果我只创建一个数据框，那么该数据框将只包含最后一页的数据。因为它会自我更新并包含最新的值。所以，在这种情况下，rbind 帮助我们从这个问题中走出来。并且用 0 代替 NA(不是数字)是一个很好的做法。所以，将来当你想对数据进行一些操作时，你不会有任何问题。</p><p id="505b" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这里你可以看到 CSV 文件。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es lz"><img src="../Images/03e2c5bbb024e97bcf64b65c266e719f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*surmO0tmUeKBEJ-0uvS-Iw.png"/></div></figure><p id="0d3c" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">对惠普笔记本电脑的价格和名称重复同样的过程。</p><blockquote class="ix iy iz"><p id="1bb9" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jd hj"> <em class="hi">分析数据</em> </strong></p></blockquote><p id="ea63" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在，我们有了包含两家公司(即戴尔和惠普)的笔记本电脑价格的数据。我们将通过绘制它们来分析它。因此，我们可以找到两家公司的酷睿 i7 笔记本电脑的平均价格。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es ma"><img src="../Images/c4e0768bd786c60ff6457ba936f8d535.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*xek7972WO28czJvvfs45EA.png"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">戴尔笔记本电脑价格平均价格</figcaption></figure><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es ma"><img src="../Images/bc4510e1f37bd4e683217fbc586f6c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*d2bENGuuC0LD8KvQrtTGUA.png"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">惠普笔记本电脑平均价格</figcaption></figure><p id="600a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">从图片中你可以很容易地了解两家公司的酷睿 i7 笔记本电脑的平均价格。黑线清楚地表明了价格的平均值。</p><p id="0fdf" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在这篇博客中，我的目的不是告诉你今天笔记本电脑的平均价格是多少？。我只想告诉你，我们可以很容易地分析刮后的数据。所以，连一个普通人都懂。R 语言帮助我们做到了这一点。您可以使用 R 中的 boxplot 函数来绘制这种类型的数据。你也可以使用许多其他的图，如条形图、饼图、柱状图等。这完全取决于您正在处理的数据类型。</p><p id="e7c1" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我希望这个博客能帮助你用 R 做抓取和分析数据。</p><p id="2371" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在这里你可以找到完整的代码</p><div class="mf mg ez fb mh mi"><a href="https://github.com/Subhan-khaliq/Web-Scraping-with-R" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hj fi z dy mn ea eb mo ed ef hh bi translated">subhan-khaliq/Web-Scraping-with-R</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">我收集了一些数据，找到亚马逊上笔记本电脑的价格和名称，然后我分析了这些数据。GitHub 是…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">github.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw kk mi"/></div></div></a></div></div></div>    
</body>
</html>