<html>
<head>
<title>Plant’s Doctor: Detecting Diseases in Plants!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">植物医生:检测植物中的疾病！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/plants-doctor-detecting-diseases-in-plants-e5c44c569bdb?source=collection_archive---------2-----------------------#2019-11-27">https://medium.com/analytics-vidhya/plants-doctor-detecting-diseases-in-plants-e5c44c569bdb?source=collection_archive---------2-----------------------#2019-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="18cb" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">建立植物病害检测系统指南。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/7e5589001a31e726bd6691bfc25cccd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gPZ6OM4PICjOeLPK"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">让·拉科斯克在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="471f" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">目录-</h1><ol class=""><li id="0d6e" class="kg kh hi ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">介绍</li><li id="124b" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">数据描述</li><li id="3abf" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">使用的度量</li><li id="0438" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">损失函数</li><li id="e490" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">数据探索</li><li id="453b" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">列车测试分离</li><li id="6424" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">系统模型化</li><li id="de35" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">图像预测</li><li id="a3ef" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">法斯泰图书馆</li><li id="73bb" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">结果</li><li id="e87e" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt ku kv kw kx bi translated">参考</li></ol><h1 id="48a5" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">简介-</h1><p id="a358" class="pw-post-body-paragraph ld le hi ki b kj kk ij lf kl km im lg kn lh li lj kp lk ll lm kr ln lo lp kt hb bi translated">据联合国粮食及农业组织(UN)称，跨境植物病虫害影响粮食作物，给农民造成重大损失，威胁粮食安全。</p><p id="25ec" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">近年来，跨界植物病虫害的传播急剧增加。全球化、贸易和气候变化，以及几十年来农业集约化导致的生产系统复原力下降，都起到了一定作用。</p><p id="0e23" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">跨界植物病虫害很容易传播到几个国家，达到流行病的程度。疾病的爆发和激增会给农作物和牧场造成巨大损失，威胁脆弱农民的生计，同时威胁数百万人的粮食和营养安全。</p><p id="8869" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">利用深度学习，我们试图创建一个可以检测植物疾病的模型。</p><h1 id="1442" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">数据集描述-</h1><p id="7fa5" class="pw-post-body-paragraph ld le hi ki b kj kk ij lf kl km im lg kn lh li lj kp lk ll lm kr ln lo lp kt hb bi translated">我使用了<em class="lv">“植物村数据集”</em>，可从以下链接获得-</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="6724" class="mb jp hi lx b fi mc md l me mf">git clone https://github.com/spMohanty/PlantVillage-Dataset<br/>cd PlantVillage-Dataset</span></pre><ul class=""><li id="2d05" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">数据集包含54，305幅图像。这些图像涵盖了14种作物:<em class="lv">苹果、蓝莓、甜椒、樱桃、葡萄、橙子、桃子、土豆、覆盆子、大豆、南瓜、草莓和番茄</em>。</li><li id="aaff" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">它包含17种真菌性疾病、4种细菌性疾病、2种霉菌(卵菌)疾病、2种病毒性疾病和1种由螨虫引起的疾病的图像。12种作物也有健康叶片的图像，这些叶片没有明显受到疾病的影响。</li><li id="cf59" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">该数据集包含38类作物病害对，列表如下</li></ul><p id="fcdc" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated"><em class="lv">1-苹果黑星病【T12苹果黑腐病<br/>3-苹果雪松锈病<br/>4-苹果健康<br/>5-蓝莓健康<br/>6-樱桃健康<br/>7-樱桃白粉病<br/>8-玉米灰斑病<br/>9-玉米普通锈病<br/>10-玉米健康<br/>11-玉米大斑病<br/>12-葡萄黑腐病<br/>13-葡萄黑麻疹<br/>15-葡萄叶枯病<br/> 16 晚疫病<br/>24-树莓健康<br/>25-大豆健康<br/>26-南瓜白粉病<br/>27-草莓健康<br/> 28-草莓叶枯病<br/>29-番茄细菌性斑点病<br/>30-番茄早疫病<br/>31-番茄晚疫病<br/>32-番茄叶霉病<br/>33-番茄七斑叶螨<br/>34-番茄二斑叶螨<br/>35-番茄靶斑【T34</em></p><h1 id="9e4a" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">使用的度量-</h1><p id="4ef9" class="pw-post-body-paragraph ld le hi ki b kj kk ij lf kl km im lg kn lh li lj kp lk ll lm kr ln lo lp kt hb bi translated">在后面的部分，我们会看到这是一个不平衡数据集的问题，所以我们不能依赖于准确性。</p><p id="1fdd" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">所以我们在这里使用-</p><ul class=""><li id="7e4d" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">精确</li><li id="e5ec" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">回忆</li><li id="4d6b" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">F1 _分数</li></ul><p id="203c" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">让我们理解以下指标-</p><ol class=""><li id="128c" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt ku kv kw kx bi translated"><strong class="ki hj"><em class="lv"/></strong>-它表达了我们的模型所说的相关的数据点实际上是相关的数据点的比例。</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mk"><img src="../Images/126eafa49fb9249d7e84c44024d5fb66.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/0*lFHRUV3CY3DSiTHw.png"/></div></figure><p id="dda3" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">2.<strong class="ki hj"> <em class="lv">召回</em></strong>——指被我们的模型正确分类的相关结果总数的百分比。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ml"><img src="../Images/a14787d5cf94f89f8717ab76ea0d6fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/0*50VgOF7xjWDLTDFd.png"/></div></figure><p id="c2f9" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">3.<strong class="ki hj"><em class="lv">F1 _ Score</em></strong>——可以解释为精度和召回率的加权平均，其中F1得分在1时达到最佳值，在0时达到最差得分。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mm"><img src="../Images/aae920590696ac47c9856d2415a24589.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/0*I-oW8X-2o4B0n51H.png"/></div></figure><h1 id="58b4" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">损失函数-</h1><p id="f4ad" class="pw-post-body-paragraph ld le hi ki b kj kk ij lf kl km im lg kn lh li lj kp lk ll lm kr ln lo lp kt hb bi translated">这里我们使用分类交叉熵作为损失函数来最小化。也称为<em class="lv">软最大损耗</em>。它是一个<em class="lv"> Softmax激活</em>加上一个<em class="lv">交叉熵损失</em>。如果我们使用这个损失，我们将训练一个CNN来输出每个图像在C类上的概率。它用于多类分类。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/3522574cb1635784b7766106cb771f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IqXfIdj6Xj8lBY9v.png"/></div></div></figure><h1 id="5531" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">探索数据-</h1><p id="686e" class="pw-post-body-paragraph ld le hi ki b kj kk ij lf kl km im lg kn lh li lj kp lk ll lm kr ln lo lp kt hb bi translated">首先，我们需要导入一些基本的库来简化我们的工作。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/a746dbe393cf8bbfc22c5b646b1238f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KkwQyULDFEWKYfzfjxdUrQ.jpeg"/></div></div></figure><ul class=""><li id="2fd4" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">我们提到包含图像的文件夹的路径，并获得图像文件夹中所有类的列表。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mp"><img src="../Images/6cb041b26b0fce73a37a61b2a947822b.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*_qnfZfbmy_7rPQnsNBm_PA.jpeg"/></div></figure><p id="ce1a" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">作为运行上述代码的结果，我们得到了下面的输出-</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mq"><img src="../Images/ce5e9b37fdbba5e70bfa9412416a587a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLBsvvUlxbca4DYdN4QjoA.jpeg"/></div></div></figure><ul class=""><li id="73de" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">现在让我们看看每个类中有多少图像，并将这些信息表示为一个数据帧。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mr"><img src="../Images/f91626e3caa912052c9872a43fa0cfe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z4b_991pBVW1lJoa-L9EEA.png"/></div></div></figure><p id="3dd2" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">这是上面代码的输出-</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ms"><img src="../Images/9d5c04556d44d8b23d8faf0551e65196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3FYxNDmJjad08Bm63rIEuw.jpeg"/></div></div></figure><ul class=""><li id="3d02" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">正如你所注意到的，每个类别中的图像数量是不同的，所以这是一个不平衡数据的例子&amp;因此我们不能依赖于准确性。</li><li id="272e" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">如果我们对图像总数求和，我们将得到54305幅图像。</li><li id="01ca" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">接下来，我们将尝试使用下面的代码获取每个图像的路径和标签</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/72c8fa467ef1fdce534026baa93144d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vgNeKg2z6updz2yi8uuKww.jpeg"/></div></div></figure><ul class=""><li id="c013" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">让我们从每门课中画出10张图片，并想象出来-</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mt"><img src="../Images/e16f8696aa61de7ee847e7b632c04cea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gMnXKPXhWae8SIm34DFHpQ.jpeg"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mu"><img src="../Images/ddd7a4e136599a7082a3417cbaddaa3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7jyp5DydSCxJjrIATRG2A.png"/></div></div></figure><ul class=""><li id="f0b9" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">下一步，从每个类中画出一张图片并给它们贴上标签怎么样</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mv"><img src="../Images/d6108845b77a60cf9e013d8e80e2ac6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uq-TTGShIRpgnbzAWc6_iA.png"/></div></div></figure><h1 id="a474" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">列车-测试分离-</h1><p id="466e" class="pw-post-body-paragraph ld le hi ki b kj kk ij lf kl km im lg kn lh li lj kp lk ll lm kr ln lo lp kt hb bi translated">将数据分为训练和测试的过程</p><ul class=""><li id="a798" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">在数据文件夹中创建两个文件夹，命名为train和test。</li><li id="2cc1" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">在训练和测试文件夹中创建c子文件夹，其中c是数据文件夹中与类别同名的类别数。</li><li id="df2c" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">现在制作一个包含图像路径的数据框(例如Apple__Apple_scab/00075aa8..)作为文件名、标签和类名。</li><li id="0f95" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">使用numpy生态数生成器，生成54305(等于图像数)的数，其中n=1(试验数)，p=0.8(训练大小)。</li><li id="edfc" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">在df中的filename上开始一个循环，如果生成的数字是1，那么将那个图像(filename)附加到train，否则它将进入测试。</li></ul><p id="e78c" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">下图显示了将数据分为训练和测试以及设置训练和测试目录的代码-</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mw"><img src="../Images/e80d00ec69e04e26f93e25991926a356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tXfppj1qRe-YLIwG_wqDtg.png"/></div></div></figure><h1 id="3ebd" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">建模-</h1><ul class=""><li id="b9e0" class="kg kh hi ki b kj kk kl km kn ko kp kq kr ks kt mj kv kw kx bi translated">我已经尝试了各种模型，但在这里我写的是最适合这种情况的模型。</li><li id="e6c7" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">在尝试了各种模型之后，我发现Inception V3模型是最好的模型。</li><li id="b2d7" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">所以让我们借助迁移学习来了解它在这里是如何使用的。</li><li id="8213" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">我们还在这里应用了图像增强，它用于通过使用水平/垂直翻转、旋转、图像亮度变化、水平/垂直移动等来人为地增加数据集中图像的变化，这种图像增强是由ImageDataGenerator执行的。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mx"><img src="../Images/a89c578418d2dacdd00d0e8b182f89e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWQ-uKCdOmNYZzmGWJqebA.png"/></div></div></figure><ul class=""><li id="9d4c" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">我们使用来自目录的Keras流来获取训练和测试数据。记住在test_generator中设置shuffle=False，否则预测时会有随机性。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/48897e06739b14388738b172dd86070e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I5RMQQHylpt1q4dJ8uqfWg.png"/></div></div></figure><ul class=""><li id="8463" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">最后，我们必须定义我们的模型结构，这里我们使用迁移学习的概念。</li><li id="208d" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">迁移学习是一种机器学习方法，其中为一项任务开发的模型被重新用作第二项任务模型的起点。</li><li id="ee79" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">在这里，我们使用inception v3模型，它是在imagenet数据集上训练的，并根据我们的需要修改最后几层，并编译和打印它的摘要。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mz"><img src="../Images/0b599057ad5da44c88cee0251661ad81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HaBWbobL0Rt1uTmLGQKhxg.png"/></div></div></figure><ul class=""><li id="da4e" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">由于它是不平衡的数据，我们在这里不能使用准确性作为度量，我们需要使用F1_score、precision和recall，但问题是Keras没有这些度量，所以我们通过Keras的回调方法获得它。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es na"><img src="../Images/774ac452064109c28f626512ba166853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAp0YB1Z2v8XkJq2A86VJQ.jpeg"/></div></div></figure><ul class=""><li id="35d8" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">现在是时候引入keras中可用的其他回调并适应模型了。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nb"><img src="../Images/831a5b4fc5062a0d815fddc77d1a8045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p1CAkHJvZeSBeKu9b7zEYQ.png"/></div></div></figure><ul class=""><li id="8bad" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">绘制训练和测试损失以及训练和测试数据的各种指标</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nc"><img src="../Images/5d8aa18972db7798006fe4201dbab2f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PUt6wv9zC47ZTzLjwrZmYA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nd"><img src="../Images/498eb685c0e497baa6fec006392d81ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*Cins-TDK9RHACtU2fglirA.png"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ne"><img src="../Images/45c8c99125527f93d69560192de5a1de.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*egqtDMqZraWvzABt0pwKRA.png"/></div></figure><ul class=""><li id="b288" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">对测试数据的预测——为了避免奇怪/随机的输出，我们需要在使用predict_generator之前重置测试生成器。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/773d4daa133e9e7e6c5b276cca0d70b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-IQqzieGPAw4QoMEM9Vyw.jpeg"/></div></div></figure><ul class=""><li id="2dcc" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">y_pred有预测的标签，但我们不能简单地说出预测是什么，因为我们所能看到的只是像0，1，4，1，0，6… <br/>这样的数字，最重要的是，我们需要将预测的标签与它们的唯一id(如文件名)进行映射，以找出我们对哪个图像预测了什么。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ng"><img src="../Images/57bfb0943659a43ac4b341a3bace274b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ALvsAg-V2CQ0f9gZLIMz7w.png"/></div></div></figure><ul class=""><li id="b055" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">让我们把混乱、精确和回忆矩阵形象化</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nh"><img src="../Images/83ea82e0cdd095ff4173f10f94121984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nkLG0Z-qOP06D3UNFDYNoA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">混淆矩阵</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ni"><img src="../Images/9ecfb81af4c8c69d94030a837283b304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*10I_YN4Twn3mjOKd2APNYg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">回忆矩阵</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/acd4df359ff11f427380b424ec554b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHUS9hIa8mE0Qe5rYL2mJw.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">精度矩阵</figcaption></figure><h1 id="954e" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">对图像的预测-</h1><ul class=""><li id="8e19" class="kg kh hi ki b kj kk kl km kn ko kp kq kr ks kt mj kv kw kx bi translated">为了对单个图像进行预测，让我们定义一个函数<em class="lv"/><strong class="ki hj"><em class="lv">【pred _ img</em></strong>，它将绘制图像并给出图像所属的类。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nk"><img src="../Images/f2b3badce387b78bdc0a82e62c84f7a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mdP9NFhLnLxZbuO0bAAe1Q.png"/></div></div></figure><ul class=""><li id="65ff" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">对一些图像的预测-</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nl"><img src="../Images/3aa82c18d3a39780750d2b561046db69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0e3X5f10ZPI4uWqqbGj5Mw.jpeg"/></div></div></figure><h1 id="1c24" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">FAST-AI库-</h1><ul class=""><li id="5e77" class="kg kh hi ki b kj kk kl km kn ko kp kq kr ks kt mj kv kw kx bi translated">同样的问题尝试一个新的库怎么样，所以这里我在尝试Fast ai library来检测植物中的病害。</li><li id="7a12" class="kg kh hi ki b kj ky kl kz kn la kp lb kr lc kt mj kv kw kx bi translated">第一步是导入库</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nm"><img src="../Images/107528be174aa612dc3cc288d8248f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HDNQxB9isQrRXyuBvcvM3A.png"/></div></div></figure><ul class=""><li id="248e" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">加载数据并获取data-imagedatabunch . from _ folder中存在的类可用于加载具有以下结构的数据。</li></ul><p id="6055" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">火车</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="f063" class="mb jp hi lx b fi mc md l me mf">-Class1</span><span id="037a" class="mb jp hi lx b fi nn md l me mf"> -Class2<br/> -...</span></pre><p id="a356" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">-有效</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="ce9e" class="mb jp hi lx b fi mc md l me mf">-Class1</span><span id="4d8d" class="mb jp hi lx b fi nn md l me mf"> -Class2</span><span id="583b" class="mb jp hi lx b fi nn md l me mf"> -...</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es no"><img src="../Images/4f11c7ece92758f07a614ebd9040040a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qs949MBjjZd2u3TCMa3JKQ.jpeg"/></div></div></figure><ul class=""><li id="1488" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">使用show_batch方法显示随机的一批图像。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/818a0a37e75236c1a29adeffe41db21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0X2motkLPeMTdNoG_cpbQ.jpeg"/></div></div></figure><ul class=""><li id="a3c3" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">这里，我们使用resnet34架构进行建模，该架构通过fastai库的cnn_learner方法使用，为了拟合该模型，使用fit_one周期，该周期基本上随着时间的推移改变学习速率以实现更好的结果。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es np"><img src="../Images/1a3114a2707161acd77a793e669a103e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4UxeRIp_uzRh1GnVe48pQ.png"/></div></div></figure><ul class=""><li id="7a94" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">解释结果，用最高损失、混淆矩阵和最混淆的预测绘制图像-</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nq"><img src="../Images/2444375bd0a1d9244c9e58faf07394de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o0TLdgutRvJ03bTrxpPZEg.jpeg"/></div></div></figure><ul class=""><li id="bb8f" class="kg kh hi ki b kj lq kl lr kn mg kp mh kr mi kt mj kv kw kx bi translated">在单一图像上预测-</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nr"><img src="../Images/d57fbb623155ddc142a897dc7980db27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*egrn6f7Y2jFkb7S73Ar_gA.jpeg"/></div></div></figure><p id="b6ad" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">因此，我们可以得出结论，FASTAI库非常容易使用。我们可以用一行代码得到不同的方法。</p><h1 id="fdc0" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">结果-</h1><p id="cac1" class="pw-post-body-paragraph ld le hi ki b kj kk ij lf kl km im lg kn lh li lj kp lk ll lm kr ln lo lp kt hb bi translated">我们用漂亮的表格总结结果-</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ns"><img src="../Images/622b57663008aef33d34c3f1999ed889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*34aU3zxaEdiRX0iGIt9Yzg.jpeg"/></div></div></figure><p id="11ab" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated"><strong class="ki hj"> <em class="lv">参考文献- </em> </strong></p><p id="eda6" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">1-【https://arxiv.org/ftp/arxiv/papers/1604/1604.03169.pdf T4】</p><p id="3e83" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">2-<a class="ae jn" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank">https://blog . keras . io/building-powerful-image-class ification-models-using-very-little-data . html</a></p><p id="9246" class="pw-post-body-paragraph ld le hi ki b kj lq ij lf kl lr im lg kn ls li lj kp lt ll lm kr lu lo lp kt hb bi translated">3-<a class="ae jn" href="https://github.com/bkleyn/plant_diseases" rel="noopener ugc nofollow" target="_blank">https://github.com/bkleyn/plant_diseases</a></p><blockquote class="nt nu nv"><p id="427b" class="ld le lv ki b kj lq ij lf kl lr im lg nw ls li lj nx lt ll lm ny lu lo lp kt hb bi translated">感谢您的阅读！！！</p></blockquote></div></div>    
</body>
</html>