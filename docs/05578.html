<html>
<head>
<title>Customized Visualization Using Python in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Power BI中使用Python定制可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/customized-visualization-using-python-in-power-bi-fa4c5c986b1b?source=collection_archive---------6-----------------------#2020-04-26">https://medium.com/analytics-vidhya/customized-visualization-using-python-in-power-bi-fa4c5c986b1b?source=collection_archive---------6-----------------------#2020-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8caa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Power BI中运行python脚本的简单步骤</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1df81aa1a69263544a87a81df0f5f95c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AMjM_0HteKo-BBEH"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">艾萨克·史密斯在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9ef5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Python与Power BI的集成在更加定制化的可视化方面打开了一个巨大的机会，在提取和清理数据方面也打开了许多<em class="ju">的可能性。</em></p><p id="1530" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这使用户能够利用令人惊叹的可视化库，如<a class="ae jt" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>、<a class="ae jt" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>和许多其他库。</p><p id="be3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们开始吧</p><blockquote class="jv jw jx"><p id="825b" class="if ig ju ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">我们需要最新版本的Power BI，这将在预览功能中集成Python。</p></blockquote><h2 id="94be" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">运行Python脚本到<strong class="ak">创建数据帧</strong></h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/d9905b887f2c9086344f9e80f1fba9b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ErMG_9lUFLRCWNUX5hbPpw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Python脚本</figcaption></figure><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="ccf2" class="kb kc hi ky b fi lc ld l le lf">import pandas as pd</span><span id="d3eb" class="kb kc hi ky b fi lg ld l le lf">df = pd.DataFrame({</span><span id="5f1d" class="kb kc hi ky b fi lg ld l le lf">'First_name':['Vijay','Eri','Dawn','Abhinav','Alok','Shambhavi','Vipu'],</span><span id="5c3a" class="kb kc hi ky b fi lg ld l le lf">'Age':[21,34,42,18,24,80,22],</span><span id="f3ee" class="kb kc hi ky b fi lg ld l le lf">'Weight': [180, 130, 200, 140, 176, 142, 210],</span><span id="dfd3" class="kb kc hi ky b fi lg ld l le lf">'Gender':['M','F','F','M','M','F','M'],</span><span id="ec00" class="kb kc hi ky b fi lg ld l le lf">'State':['Delhi','Oregon','California','Delhi','Banarash','Delhi','Mumbai'],</span><span id="56d1" class="kb kc hi ky b fi lg ld l le lf">'Children':[4,1,2,3,10,0,4],</span><span id="cf7e" class="kb kc hi ky b fi lg ld l le lf">'Pets':[3,2,2,5,0,1,5]</span><span id="6707" class="kb kc hi ky b fi lg ld l le lf">})</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/7b9c9b95107075a9bfaddeec48e81834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Mo3ubd1WJsYf4LcDNtQ7Xw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">数据帧</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/fffa25d57be0c0e0a4441e6f6f5088fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*5Heo2ukn1tIuspsC2nqyTA.png"/></div></figure><p id="f951" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击此图标时，脚本编辑器会打开一个空的可视区域。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/c615c9cefda59c8e549195c46a4a9cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*wC8A8q6rvHEXf7nsb45xdQ.png"/></div></figure><p id="5d31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以从我们正在工作的数据集中添加必填字段，这在内部创建了一个Pandas数据框架。然后，我们可以使用Matplotlib和Seaborn之类的库编写定制脚本来创建定制的视觉效果。</p><h1 id="a425" class="lk kc hi bd kd ll lm ln kh lo lp lq kl lr ls lt ko lu lv lw kr lx ly lz ku ma bi translated">使用Matplotlib创建散点图</h1><p id="618c" class="pw-post-body-paragraph if ig hi ih b ii mb ik il im mc io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">在创建可视化之前，我们将导入以下库</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="c19a" class="kb kc hi ky b fi lc ld l le lf">import matplotlib.pyplot as plt</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/d938d73984426ff690fbfe80b76ec939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RfUclf5tamUH8mz9eiPBsQ.png"/></div></div></figure><p id="131b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行该脚本后，输出如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/5ab9841b27d3b1b014059b78770059e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*OEB_dXQ9uNbO4Ad0MveOqg.png"/></div></figure><p id="b176" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">创建多列线图</strong></p><p id="929c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们为每个人创建一个线图，显示他们的孩子和宠物的数量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mi"><img src="../Images/44d389140b62a22613b7cca4e0ad97c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ARPgx1zx4V4J3JD4gvnKbA.png"/></div></div></figure><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="95a3" class="kb kc hi ky b fi lc ld l le lf">import matplotlib.pyplot as plt</span><span id="9c51" class="kb kc hi ky b fi lg ld l le lf">ax = plt.gca()</span><span id="3820" class="kb kc hi ky b fi lg ld l le lf">dataset.plot(kind='line',x='First_name',y='Children',ax=ax)</span><span id="4d05" class="kb kc hi ky b fi lg ld l le lf">dataset.plot(kind='line',x='First_name',y='Pets', color='red', ax=ax)</span><span id="1d18" class="kb kc hi ky b fi lg ld l le lf">plt.show()</span></pre><p id="c092" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行这段代码后，输出如下</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/dca5a7d772d756f3d34f7183be4c68bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*mSlRsFCuxDf96wFizCiBzg.png"/></div></div></figure><p id="8682" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，我们可以使用matplot创建许多可视化。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/d227b0a978e2e342780ea6fc271f9b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6TAWzGzIQWONkevR"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@matthardy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">麦特·哈迪</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="23c6" class="lk kc hi bd kd ll lm ln kh lo lp lq kl lr ls lt ko lu lv lw kr lx ly lz ku ma bi translated"><strong class="ak"> Seaborn图书馆</strong></h1><p id="9b0c" class="pw-post-body-paragraph if ig hi ih b ii mb ik il im mc io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">首先在power BI中下载并导入Tips数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/65a6161eea5d467d6ea753d19fbad36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7XRDtOESh-FwFsiV8TUDzA.png"/></div></div></figure><h1 id="40ec" class="lk kc hi bd kd ll lm ln kh lo lp lq kl lr ls lt ko lu lv lw kr lx ly lz ku ma bi translated">小提琴情节与Seaborn图书馆</h1><p id="0093" class="pw-post-body-paragraph if ig hi ih b ii mb ik il im mc io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">这将导入视觉库，允许你创建一些很酷的视觉效果。让我们添加代码来获得我们想要的视觉效果。我们将创建的第一个视觉效果是小提琴的情节。我们将使用在中添加的值来创建数据集。</p><h2 id="04d6" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated"><strong class="ak">粘贴这段代码</strong></h2><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="b2c1" class="kb kc hi ky b fi lc ld l le lf">import seaborn as sns</span><span id="596b" class="kb kc hi ky b fi lg ld l le lf">sns.violinplot(x='day',y='Total_Bill',data=dataset)</span><span id="4673" class="kb kc hi ky b fi lg ld l le lf">plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mj"><img src="../Images/f2e58c2d125fc8357d9db4dfdcf1a11d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*J_6fjqKTt2L_CLt3mRKuug.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">小提琴情节</figcaption></figure><h1 id="8e0e" class="lk kc hi bd kd ll lm ln kh lo lp lq kl lr ls lt ko lu lv lw kr lx ly lz ku ma bi translated">创建Seaborn散点图</h1><p id="afe9" class="pw-post-body-paragraph if ig hi ih b ii mb ik il im mc io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">该图用于查看两个变量之间的关系。</p><p id="917b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">粘贴此代码</strong></p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="040f" class="kb kc hi ky b fi lc ld l le lf">import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="58f0" class="kb kc hi ky b fi lg ld l le lf">sns.scatterplot(x='Total_Bill', y='tip',hue='size', size='size',sizes=(20, 900),data=dataset)<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/d1bfcfacb9e793b02a8c2220b14efac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_vhPjDCurs0KP9pO9yNdXg.png"/></div></div></figure><h1 id="0be9" class="lk kc hi bd kd ll lm ln kh lo lp lq kl lr ls lt ko lu lv lw kr lx ly lz ku ma bi translated">创建Seaborn Pair图</h1><p id="7f61" class="pw-post-body-paragraph if ig hi ih b ii mb ik il im mc io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">我们要创造的最后一个情节是最容易的。它被称为配对图，本质上是所有数据集相关性的集合，类似于单独的图形。它可以让你快速简单地查看你的相关性，以便进行更深入的探索。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="fdbf" class="kb kc hi ky b fi lc ld l le lf">import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>sns.pairplot(dataset,hue='sex')<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/8b127a61177c89e8b67aaed019c6e1f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bEkYtzONUDUjv8Jge3HvwA.png"/></div></div></figure><p id="b81a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p><p id="c2b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然您已经知道如何在Power BI中使用Python集成，那么定制您的视觉效果的可能性是无穷无尽的，可以构建令人惊叹的仪表板！</p><p id="e166" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这篇文章能帮助你并节省大量的时间。</p><p id="f228" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">快乐编码。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/5a3e01d0ae575a61b2190fe22726e0f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HZ3rfNZmeSLX4LkE"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">由<a class="ae jt" href="https://unsplash.com/@felix_mittermeier?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">菲利克斯·米特迈尔</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure></div></div>    
</body>
</html>