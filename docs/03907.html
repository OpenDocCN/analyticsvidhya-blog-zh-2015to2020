<html>
<head>
<title>Text to Speech in C++</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C++中的文本到语音转换</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/text-to-speech-in-c-624d0f814ad1?source=collection_archive---------0-----------------------#2020-02-25">https://medium.com/analytics-vidhya/text-to-speech-in-c-624d0f814ad1?source=collection_archive---------0-----------------------#2020-02-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/9813b5491cfbfd7957b272facd5a4a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WuEZ2jTZ-SKH74lS"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">丹尼尔·山特维克在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="a3f8" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">用C++实现文本到语音转换的简单程序</h2></div><p id="a4fb" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">文本到语音是机器学习的一种常见实现方式，事实上，已经建立了许多使用文本到语音的伟大的机器学习应用程序。通过导入一些预定义的模型并使用它们，在C++中进行文本到语音的转换要容易得多。让我们来看看吧。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="f36c" class="ks kt hy ko b fi ku kv l kw kx">import pyttsx3<br/>engine = pyttsx3.init() # object creation</span><span id="3975" class="ks kt hy ko b fi ky kv l kw kx">""" RATE"""<br/>rate = engine.getProperty('rate')   # getting details of current speaking rate<br/>print (rate)                        #printing current voice rate<br/>engine.setProperty('rate', 125)     # setting up new voice rate<br/></span><span id="06e8" class="ks kt hy ko b fi ky kv l kw kx">"""VOLUME"""<br/>volume = engine.getProperty('volume')   #getting to know current volume level (min=0 and max=1)<br/>print (volume)                          #printing current volume level<br/>engine.setProperty('volume',1.0)    # setting up volume level  between 0 and 1</span><span id="ca79" class="ks kt hy ko b fi ky kv l kw kx">"""VOICE"""<br/>voices = engine.getProperty('voices')       #getting details of current voice<br/>#engine.setProperty('voice', voices[0].id)  #changing index, changes voices. o for male<br/>engine.setProperty('voice', voices[1].id)   #changing index, changes voices. 1 for female</span><span id="0543" class="ks kt hy ko b fi ky kv l kw kx">engine.say("Hello World!")<br/>engine.say('My current speaking rate is ' + str(rate))<br/>engine.runAndWait()<br/>engine.stop()</span></pre><p id="fe5c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">你看，Python和基本TTS系统20行代码。现在，让我们看看如何在C++中实现它。</p><h2 id="53d7" class="ks kt hy bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">先决条件</h2><ul class=""><li id="7db0" class="ls lt hy jp b jq lu jt lv jw lw ka lx ke ly ki lz ma mb mc bi translated">微软Visual Studio带C++或者下载了<a class="ae hv" href="https://github.com/mjakal/sapi5_on_linux" rel="noopener ugc nofollow" target="_blank">SAPI Linux版</a></li><li id="79a1" class="ls lt hy jp b jq md jt me jw mf ka mg ke mh ki lz ma mb mc bi translated">熟悉指针</li><li id="4d78" class="ls lt hy jp b jq md jt me jw mf ka mg ke mh ki lz ma mb mc bi translated">熟悉多线程和COM编程会有所帮助，但不是必需的</li></ul><h2 id="7a53" class="ks kt hy bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">我们开始吧</h2><p id="a745" class="pw-post-body-paragraph jn jo hy jp b jq lu iz js jt lv jc jv jw mi jy jz ka mj kc kd ke mk kg kh ki hb bi translated">我们将从基本的编码开始，然后我们将采用面向对象的方法。</p><p id="c90c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们包括标题。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="1d2d" class="ks kt hy ko b fi ku kv l kw kx">#include &lt;sapi.h&gt;<br/>#include&lt;iostream&gt;<br/>#include &lt;string&gt;<br/>using namespace std;</span></pre><p id="8058" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们将声明一个ISpVoice类型的指针。ISpVoice接口使应用程序能够执行文本合成操作。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="a6ff" class="ks kt hy ko b fi ku kv l kw kx">ISpVoice* pVoice=NULL;</span></pre><p id="553c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在我们声明一个HRESULT类型的变量。HRESULT是Windows操作系统和早期的IBM/Microsoft OS/2操作系统中使用的一种数据类型，用于表示错误条件和警告条件。HRESULT最初的目的是为公共和微软内部使用正式地安排错误代码的范围，以防止OS/2操作系统的不同子系统中的错误代码之间的冲突。HRESULTs是数字错误代码。HRESULT中的各个位对有关错误代码的性质及其来源的信息进行编码。HRESULT错误代码是COM编程中最常见的，它们构成了标准化COM错误处理约定的基础。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="0bf4" class="ks kt hy ko b fi ku kv l kw kx">HRESULT hr;</span></pre><p id="9053" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在是一个<a class="ae hv" href="https://stackoverflow.com/questions/402283/stdwstring-vs-stdstring" rel="noopener ugc nofollow" target="_blank"> wstring </a>类型的变量，我们将从用户那里获取输入。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="13c6" class="ks kt hy ko b fi ku kv l kw kx">wstring input;</span></pre><p id="9bed" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">SAPI是一个基于COM的应用程序，COM必须在使用前和SAPI活动期间进行初始化。在大多数情况下，这适用于宿主应用程序的整个生命周期。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="0ba2" class="ks kt hy ko b fi ku kv l kw kx">a=CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);<br/>if (FAILED(a))<br/>{   <br/>cout &lt;&lt; "ERROR 404 FAILED INITIALIZING COM\n";<br/>exit(1);<br/>}</span></pre><p id="7d99" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">先来了解一下CoInitializeEx的参数。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="e279" class="ks kt hy ko b fi ku kv l kw kx">HRESULT CoInitializeEx(LPVOID pvReserved, DWORD dwCoInit);</span></pre><p id="584e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">第一个参数是保留的，必须为空。第二个参数指定程序将使用的线程模型。</p><p id="bece" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">一旦我们在工作状态中有了COM，我们的下一件事就是创建简单的COM对象的声音。默认语音来自“控制面板”中的“语音”部分，包括语音(如果您的系统上有多个语音)和语言(英语、日语等)等信息。).</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="4a66" class="ks kt hy ko b fi ku kv l kw kx">hr = CoCreateInstance(CLSID_SpVoice, NULL, CLSCTX_ALL, IID_ISpVoice, (void **)&amp;pVoice);</span></pre><p id="cd07" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们来理解一下是<a class="ae hv" href="https://docs.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance" rel="noopener ugc nofollow" target="_blank">参数</a>。</p><p id="127a" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du ml mm mn ko b">rclsid</code></p><p id="554a" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">与将用于创建对象的数据和代码关联的CLSID。</p><p id="1f79" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du ml mm mn ko b">pUnkOuter</code></p><p id="05f5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">If <strong class="jp hz"> NULL </strong>表示对象不是作为聚合的一部分创建的。如果非<strong class="jp hz">空</strong>，则指针指向聚合对象的<a class="ae hv" href="https://docs.microsoft.com/windows/desktop/api/unknwn/nn-unknwn-iunknown" rel="noopener ugc nofollow" target="_blank"> IUnknown </a>接口(控制<strong class="jp hz"> IUnknown </strong>)。</p><p id="ad51" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du ml mm mn ko b">dwClsContext</code></p><p id="9d1e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">管理新创建对象的代码将在其中运行的上下文。这些值取自枚举<a class="ae hv" href="https://docs.microsoft.com/windows/desktop/api/wtypesbase/ne-wtypesbase-clsctx" rel="noopener ugc nofollow" target="_blank"> CLSCTX </a>。</p><p id="c975" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du ml mm mn ko b">riid</code></p><p id="ab8a" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">对用于与对象通信的接口标识符的引用。</p><p id="47f5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du ml mm mn ko b">ppv</code></p><p id="804a" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">接收<em class="mo"> riid </em>中请求的接口指针的指针变量的地址。成功返回后，* <em class="mo"> ppv </em>包含请求的接口指针。失败后，* <em class="mo"> ppv </em>包含<strong class="jp hz">空值</strong>。</p><p id="2d20" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在我们必须做我们的实际任务，也就是说。说话是一个简单的单行任务，我们必须调用speak out of voice对象。</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="3e24" class="ks kt hy ko b fi ku kv l kw kx">if( SUCCEEDED( hr ) )<br/>{   getline(wcin,input);    <br/>    <strong class="ko hz">hr = pVoice-&gt;Speak(</strong>input.c_str()<strong class="ko hz">, 0, NULL);<br/></strong>    pVoice-&gt;Release();<br/>    pVoice = NULL;<br/>}</span></pre><p id="1056" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">点击阅读更多关于Speak <a class="ae hv" href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms719820(v%3Dvs.85)" rel="noopener ugc nofollow" target="_blank">参数的信息</a></p><p id="ccc8" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">结合我们得到的一切</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="3921" class="ks kt hy ko b fi ku kv l kw kx">#include &lt;sapi.h&gt;<br/>#include&lt;iostream&gt;<br/>#include &lt;string&gt;<br/>using namespace std;</span><span id="8f52" class="ks kt hy ko b fi ky kv l kw kx">int main()<br/>{<br/>  ISpVoice* pVoice=NULL;<br/>  HRESULT hr;<br/>  wstring input;<br/> a=CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);<br/> if (FAILED(a))<br/> {   <br/> cout &lt;&lt; "ERROR 404 FAILED INITIALIZING COM\n";<br/> exit(1);<br/> }<br/> HRESULT CoInitializeEx(LPVOID pvReserved, DWORD dwCoInit);<br/> hr = CoCreateInstance(CLSID_SpVoice, NULL, CLSCTX_ALL,       IID_ISpVoice, (void **)&amp;pVoice);<br/> <br/>if( SUCCEEDED( hr ) )<br/>{   getline(wcin,input);    <br/>    <strong class="ko hz">hr = pVoice-&gt;Speak(</strong>input.c_str()<strong class="ko hz">, 0, NULL);<br/></strong>    pVoice-&gt;Release();<br/>    pVoice = NULL;<br/>}<br/>return 0;<br/>}</span></pre></div><div class="ab cl mp mq gp mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hb hc hd he hf"><p id="598b" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们用面向对象的方法来做吧</p><p id="a25a" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们的文件结构如下:</p><p id="70fb" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">头文件</strong></p><ul class=""><li id="86ec" class="ls lt hy jp b jq jr jt ju jw mw ka mx ke my ki lz ma mb mc bi translated">基本语音. h</li><li id="6dc9" class="ls lt hy jp b jq md jt me jw mf ka mg ke mh ki lz ma mb mc bi translated">女声h</li><li id="5e76" class="ls lt hy jp b jq md jt me jw mf ka mg ke mh ki lz ma mb mc bi translated">男声</li></ul><p id="2b82" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">源文件</strong></p><ul class=""><li id="1c06" class="ls lt hy jp b jq jr jt ju jw mw ka mx ke my ki lz ma mb mc bi translated">基础语音</li><li id="4af3" class="ls lt hy jp b jq md jt me jw mf ka mg ke mh ki lz ma mb mc bi translated">女性之声</li><li id="01e7" class="ls lt hy jp b jq md jt me jw mf ka mg ke mh ki lz ma mb mc bi translated">TTS.cpp</li><li id="6d5b" class="ls lt hy jp b jq md jt me jw mf ka mg ke mh ki lz ma mb mc bi translated">男声. cpp</li></ul><p id="65f3" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Basic Voice.h将成为我们的基类。让我们看看它</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="8d0a" class="ks kt hy ko b fi ku kv l kw kx">#pragma once</span><span id="c360" class="ks kt hy ko b fi ky kv l kw kx">#include &lt;sapi.h&gt;</span><span id="910d" class="ks kt hy ko b fi ky kv l kw kx">#include&lt;iostream&gt;</span><span id="2086" class="ks kt hy ko b fi ky kv l kw kx">#include &lt;string&gt;</span><span id="27d3" class="ks kt hy ko b fi ky kv l kw kx">using namespace std;</span><span id="453e" class="ks kt hy ko b fi ky kv l kw kx">class BasicVoice</span><span id="6022" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="1e88" class="ks kt hy ko b fi ky kv l kw kx">protected:</span><span id="fa03" class="ks kt hy ko b fi ky kv l kw kx">int choice;</span><span id="b046" class="ks kt hy ko b fi ky kv l kw kx">ISpVoice* pVoice;</span><span id="dad4" class="ks kt hy ko b fi ky kv l kw kx">HRESULT hr,a;</span><span id="73ff" class="ks kt hy ko b fi ky kv l kw kx">wstring input;</span><span id="2e09" class="ks kt hy ko b fi ky kv l kw kx">public:</span><span id="6419" class="ks kt hy ko b fi ky kv l kw kx">BasicVoice() {</span><span id="4aaa" class="ks kt hy ko b fi ky kv l kw kx">pVoice = NULL;</span><span id="2569" class="ks kt hy ko b fi ky kv l kw kx">input = L"";</span><span id="9a29" class="ks kt hy ko b fi ky kv l kw kx">a=CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);//HRESULT CoInitializeEx(LPVOID pvReserved, DWORD dwCoInit);</span><span id="53d1" class="ks kt hy ko b fi ky kv l kw kx">if (FAILED(a))</span><span id="a0fb" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="aa64" class="ks kt hy ko b fi ky kv l kw kx">cout &lt;&lt; "ERROR 404 FAILED INITIALIZING COM\n";</span><span id="0e51" class="ks kt hy ko b fi ky kv l kw kx">exit(1);</span><span id="0672" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="c195" class="ks kt hy ko b fi ky kv l kw kx">hr = CoCreateInstance(CLSID_SpVoice, NULL, CLSCTX_ALL, IID_ISpVoice, (void **)&amp;pVoice);</span><span id="230b" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="1801" class="ks kt hy ko b fi ky kv l kw kx">virtual void setSpeech();</span><span id="aa9a" class="ks kt hy ko b fi ky kv l kw kx">virtual void byeSpeech() = 0;</span><span id="f0a5" class="ks kt hy ko b fi ky kv l kw kx">virtual void outSpeech();</span><span id="6095" class="ks kt hy ko b fi ky kv l kw kx">virtual ~BasicVoice() {</span><span id="59ce" class="ks kt hy ko b fi ky kv l kw kx">::CoUninitialize();</span><span id="b334" class="ks kt hy ko b fi ky kv l kw kx">delete pVoice;</span><span id="385b" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="7dfe" class="ks kt hy ko b fi ky kv l kw kx">};</span></pre><p id="4d74" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在我们的基类中，我们初始化所有的变量。让我们在BasicVoice.cpp中查找</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="99b5" class="ks kt hy ko b fi ku kv l kw kx">#include "BasicVoice.h"</span><span id="4659" class="ks kt hy ko b fi ky kv l kw kx">//pure abstract class so empty functions</span><span id="9411" class="ks kt hy ko b fi ky kv l kw kx">void BasicVoice::setSpeech()</span><span id="761e" class="ks kt hy ko b fi ky kv l kw kx">{}</span><span id="117e" class="ks kt hy ko b fi ky kv l kw kx">void BasicVoice::byeSpeech()</span><span id="b8e0" class="ks kt hy ko b fi ky kv l kw kx">{}</span><span id="44b5" class="ks kt hy ko b fi ky kv l kw kx">void BasicVoice::outSpeech()</span><span id="ef55" class="ks kt hy ko b fi ky kv l kw kx">{}</span></pre><p id="c1b0" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz"> MaleVoice.h </strong></p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="a1e1" class="ks kt hy ko b fi ku kv l kw kx">#pragma once</span><span id="0d5e" class="ks kt hy ko b fi ky kv l kw kx">#include "BasicVoice.h"</span><span id="fbaa" class="ks kt hy ko b fi ky kv l kw kx">class MaleVoice :</span><span id="8269" class="ks kt hy ko b fi ky kv l kw kx">public BasicVoice</span><span id="56ab" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="7535" class="ks kt hy ko b fi ky kv l kw kx">public:</span><span id="32f7" class="ks kt hy ko b fi ky kv l kw kx">void setSpeech();</span><span id="ca45" class="ks kt hy ko b fi ky kv l kw kx">void outSpeech();</span><span id="938d" class="ks kt hy ko b fi ky kv l kw kx">void byeSpeech();</span><span id="810b" class="ks kt hy ko b fi ky kv l kw kx">};</span></pre><p id="57a1" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz"> Malevoice.cpp </strong></p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="4e2f" class="ks kt hy ko b fi ku kv l kw kx">#include "MaleVoice.h"</span><span id="668a" class="ks kt hy ko b fi ky kv l kw kx">void MaleVoice::setSpeech()</span><span id="db94" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="210c" class="ks kt hy ko b fi ky kv l kw kx">if (SUCCEEDED(hr))</span><span id="2b0e" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="23d9" class="ks kt hy ko b fi ky kv l kw kx">cout &lt;&lt; "Enter text:\n";</span><span id="056e" class="ks kt hy ko b fi ky kv l kw kx">cin.ignore(1, '\n');</span><span id="4988" class="ks kt hy ko b fi ky kv l kw kx">getline(wcin, input);</span><span id="befb" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="6cd9" class="ks kt hy ko b fi ky kv l kw kx">else</span><span id="8ec7" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="e81f" class="ks kt hy ko b fi ky kv l kw kx">cout &lt;&lt; "NOt Initalized";</span><span id="9421" class="ks kt hy ko b fi ky kv l kw kx">exit(-1);</span><span id="db82" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="adce" class="ks kt hy ko b fi ky kv l kw kx">system("cls");</span><span id="19b5" class="ks kt hy ko b fi ky kv l kw kx">cout &lt;&lt; "At What Speed you want to Play your Voice\n1 for Normal \n2 for -2x\n3 for 2x";</span><span id="e019" class="ks kt hy ko b fi ky kv l kw kx">cin &gt;&gt; choice;</span><span id="7dcd" class="ks kt hy ko b fi ky kv l kw kx">if (choice == 2)</span><span id="e19e" class="ks kt hy ko b fi ky kv l kw kx">hr = pVoice-&gt;Speak((L"&lt;rate absspeed='-2'&gt;" + input).c_str(), 0, NULL);</span><span id="6c21" class="ks kt hy ko b fi ky kv l kw kx">else if (choice == 3)</span><span id="f168" class="ks kt hy ko b fi ky kv l kw kx">hr = pVoice-&gt;Speak((L"&lt;rate absspeed='2'&gt;" + input).c_str(), 0, NULL);</span><span id="02b2" class="ks kt hy ko b fi ky kv l kw kx">else</span><span id="a8af" class="ks kt hy ko b fi ky kv l kw kx">hr = pVoice-&gt;Speak(input.c_str(), 0, NULL);</span><span id="604f" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="2048" class="ks kt hy ko b fi ky kv l kw kx">void MaleVoice::outSpeech()</span><span id="6a02" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="9e7b" class="ks kt hy ko b fi ky kv l kw kx">pVoice-&gt;Release();</span><span id="7210" class="ks kt hy ko b fi ky kv l kw kx">pVoice = NULL;</span><span id="f89b" class="ks kt hy ko b fi ky kv l kw kx">::CoUninitialize();</span><span id="c290" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="071e" class="ks kt hy ko b fi ky kv l kw kx">void MaleVoice::byeSpeech()</span><span id="d30c" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="f049" class="ks kt hy ko b fi ky kv l kw kx">}</span></pre><p id="8d50" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">请注意，我们正在设置速度。可以通过XML标签添加许多功能。在这里看完整个<a class="ae hv" href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms717077(v%3Dvs.85)" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="5f08" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">女性声音. h </strong></p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="4636" class="ks kt hy ko b fi ku kv l kw kx">#pragma once</span><span id="b4a3" class="ks kt hy ko b fi ky kv l kw kx">#include "BasicVoice.h"</span><span id="1306" class="ks kt hy ko b fi ky kv l kw kx">class FemaleVoice : public BasicVoice</span><span id="be5e" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="9ab5" class="ks kt hy ko b fi ky kv l kw kx">public:</span><span id="bb2e" class="ks kt hy ko b fi ky kv l kw kx">void setSpeech();</span><span id="cd8d" class="ks kt hy ko b fi ky kv l kw kx">void outSpeech();</span><span id="4c66" class="ks kt hy ko b fi ky kv l kw kx">void byeSpeech();</span><span id="0a42" class="ks kt hy ko b fi ky kv l kw kx">};</span></pre><p id="0655" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">女性声音. cpp </strong></p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="7d21" class="ks kt hy ko b fi ku kv l kw kx">#include "FemaleVoice.h"</span><span id="1d6a" class="ks kt hy ko b fi ky kv l kw kx">void FemaleVoice::setSpeech()</span><span id="3616" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="f4d0" class="ks kt hy ko b fi ky kv l kw kx">if (SUCCEEDED(hr))</span><span id="b89b" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="581c" class="ks kt hy ko b fi ky kv l kw kx">cout &lt;&lt; "Enter text:\n";</span><span id="3922" class="ks kt hy ko b fi ky kv l kw kx">cin.ignore(1,'\n');</span><span id="89ba" class="ks kt hy ko b fi ky kv l kw kx">getline(wcin, input);</span><span id="7207" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="cf0b" class="ks kt hy ko b fi ky kv l kw kx">cout &lt;&lt; "At What Speed you want to Play your Voice\n1 for Normal \n2 for -2x\n3 for 2x";</span><span id="ea65" class="ks kt hy ko b fi ky kv l kw kx">cin &gt;&gt; choice;</span><span id="e8f4" class="ks kt hy ko b fi ky kv l kw kx">if (choice == 2)</span><span id="4df8" class="ks kt hy ko b fi ky kv l kw kx">hr = pVoice-&gt;Speak((L"&lt;rate absspeed='-2'&gt;&lt;voice required='Gender = Female;'&gt;" + input).c_str(), 0, NULL);</span><span id="9e9b" class="ks kt hy ko b fi ky kv l kw kx">else if (choice == 3)</span><span id="14d4" class="ks kt hy ko b fi ky kv l kw kx">hr = pVoice-&gt;Speak((L"&lt;rate absspeed='2'&gt;&lt;voice required='Gender = Female;'&gt;" + input).c_str(), 0, NULL);</span><span id="40dd" class="ks kt hy ko b fi ky kv l kw kx">else</span><span id="4e67" class="ks kt hy ko b fi ky kv l kw kx">hr = pVoice-&gt;Speak((L"&lt;voice required='Gender = Female;'&gt;" + input).c_str(), 0, NULL);</span><span id="5bc1" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="177f" class="ks kt hy ko b fi ky kv l kw kx">void FemaleVoice::outSpeech()</span><span id="123d" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="065f" class="ks kt hy ko b fi ky kv l kw kx">pVoice-&gt;Release();</span><span id="8dba" class="ks kt hy ko b fi ky kv l kw kx">pVoice = NULL;</span><span id="6d19" class="ks kt hy ko b fi ky kv l kw kx">::CoUninitialize();</span><span id="4c97" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="9cae" class="ks kt hy ko b fi ky kv l kw kx">void FemaleVoice::byeSpeech()</span><span id="abad" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="695c" class="ks kt hy ko b fi ky kv l kw kx">if (SUCCEEDED(hr))</span><span id="01cb" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="b1e5" class="ks kt hy ko b fi ky kv l kw kx">hr = pVoice-&gt;Speak(L"&lt;voice required='Gender = Female'&gt; &lt; rate absspeed = '-5' &gt; Bhut Shukria Sir", 0, NULL);</span><span id="c054" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="1957" class="ks kt hy ko b fi ky kv l kw kx">}</span></pre><p id="8e35" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在这里，我们通过使用XML标签添加了女声选项。</p><p id="7106" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz"> TTS.cpp </strong></p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="c1c8" class="ks kt hy ko b fi ku kv l kw kx">#include "BasicVoice.h"</span><span id="857a" class="ks kt hy ko b fi ky kv l kw kx">#include "MaleVoice.h"</span><span id="d7ef" class="ks kt hy ko b fi ky kv l kw kx">#include "FemaleVoice.h"</span><span id="e56e" class="ks kt hy ko b fi ky kv l kw kx">int main()</span><span id="262c" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="6b92" class="ks kt hy ko b fi ky kv l kw kx">BasicVoice* b1 = NULL;</span><span id="d634" class="ks kt hy ko b fi ky kv l kw kx">b1 = new MaleVoice;</span><span id="4181" class="ks kt hy ko b fi ky kv l kw kx">int choice;</span><span id="cbe6" class="ks kt hy ko b fi ky kv l kw kx">do {</span><span id="3116" class="ks kt hy ko b fi ky kv l kw kx">cout &lt;&lt; "1 to Output in Male Voice \n2 to Output in Female Voice\n";</span><span id="993a" class="ks kt hy ko b fi ky kv l kw kx">cin &gt;&gt; choice;</span><span id="d9dd" class="ks kt hy ko b fi ky kv l kw kx">switch (choice)</span><span id="d5e0" class="ks kt hy ko b fi ky kv l kw kx">{</span><span id="e386" class="ks kt hy ko b fi ky kv l kw kx">case 1:</span><span id="47aa" class="ks kt hy ko b fi ky kv l kw kx">b1 = new MaleVoice; //  we create a new malevoice object.</span><span id="96b1" class="ks kt hy ko b fi ky kv l kw kx">b1-&gt;setSpeech();</span><span id="3480" class="ks kt hy ko b fi ky kv l kw kx">b1-&gt;outSpeech();</span><span id="c00e" class="ks kt hy ko b fi ky kv l kw kx">delete b1; //after outputing that voice , we delete that object</span><span id="66e4" class="ks kt hy ko b fi ky kv l kw kx">break;</span><span id="8751" class="ks kt hy ko b fi ky kv l kw kx">case 2:</span><span id="b46a" class="ks kt hy ko b fi ky kv l kw kx">b1 = new FemaleVoice;// we create a new femalevoice</span><span id="8adb" class="ks kt hy ko b fi ky kv l kw kx">b1-&gt;setSpeech();</span><span id="3a55" class="ks kt hy ko b fi ky kv l kw kx">b1-&gt;outSpeech();</span><span id="89f7" class="ks kt hy ko b fi ky kv l kw kx">delete b1;//after outputing that voice , we delete that object</span><span id="d969" class="ks kt hy ko b fi ky kv l kw kx">break;</span><span id="d3aa" class="ks kt hy ko b fi ky kv l kw kx">case 3:</span><span id="2731" class="ks kt hy ko b fi ky kv l kw kx">b1 = new FemaleVoice;</span><span id="1c09" class="ks kt hy ko b fi ky kv l kw kx">b1-&gt;byeSpeech();</span><span id="e314" class="ks kt hy ko b fi ky kv l kw kx">b1-&gt;outSpeech();</span><span id="f6c8" class="ks kt hy ko b fi ky kv l kw kx">delete b1;</span><span id="53e0" class="ks kt hy ko b fi ky kv l kw kx">break;</span><span id="4023" class="ks kt hy ko b fi ky kv l kw kx">default:</span><span id="4bd1" class="ks kt hy ko b fi ky kv l kw kx">break;</span><span id="9963" class="ks kt hy ko b fi ky kv l kw kx">}</span><span id="b795" class="ks kt hy ko b fi ky kv l kw kx">} while (choice != 3);</span><span id="00ae" class="ks kt hy ko b fi ky kv l kw kx">system("pause");</span><span id="a9e4" class="ks kt hy ko b fi ky kv l kw kx">return 0;</span><span id="ac3e" class="ks kt hy ko b fi ky kv l kw kx">}</span></pre><p id="bfa5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在这里，我们使用菜单驱动的方法来获取用户的输入，并以语音格式生成它们。</p></div><div class="ab cl mp mq gp mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hb hc hd he hf"><p id="8fe2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在这里寻找完整的组织代码<a class="ae hv" href="https://github.com/ahmadmustafaanis/Text-to-Speech-in-Cpp" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c430" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果你在C++中成功实现了文本到语音转换，请在评论中告诉我。</p><p id="e044" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在<a class="ae hv" href="https://twitter.com/AhmadMustafaAn1" rel="noopener ugc nofollow" target="_blank">推特</a>上与我联系。</p><p id="fc24" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">请在评论中留下您的反馈。</p></div></div>    
</body>
</html>