<html>
<head>
<title>How to send email via python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过python发送电子邮件</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-send-email-via-python-95302a7f06de?source=collection_archive---------6-----------------------#2020-06-15">https://medium.com/analytics-vidhya/how-to-send-email-via-python-95302a7f06de?source=collection_archive---------6-----------------------#2020-06-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e4fa" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">每天自动发送销售报告</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/3fb1855986a0cabc7285c37f55aef8be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Hw_DUXRPK0pNt-25"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@muukii?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Muukii </a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="c8e0" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="967f" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">最近，我的公司让我为我们的销售部门研究报告解决方案。我需要每天向销售经理发送销售报告。销售报告将在一天结束后准备，报告需要在上午08:00发送。因此，我尝试使用用Python编写的自定义场景脚本来自动化流程。</p><h1 id="d59e" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">如何通过python发送电子邮件</h1><p id="59d4" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">Python在标准库中包含了几个模块，用于处理电子邮件和电子邮件服务器。基本上我们会使用内置的<strong class="ki hj"> smtplib </strong>模块，它可以使用简单邮件传输协议(SMTP)发送电子邮件。<strong class="ki hj"> smtplib </strong>使用RFC 821协议进行SMTP。本教程中的示例将使用自己的SMTP服务器来发送带有附件和HTML内容的电子邮件，但同样的原则也适用于其他电子邮件服务。</p><p id="595b" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">要发送电子邮件，您需要使用SMTP(简单邮件传输协议)。如前所述，Python提供了处理这个任务的库，你不需要额外的安装或技巧。您可以使用以下语句导入该模块:</p><p id="6969" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第4–5行:导入smtplib相关模块。默认情况下，它应该包含在Python中。</p><p id="1763" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第6–8行:我们将处理MIME消息类型，它能够结合HTML和纯文本。在Python中，由<em class="lh"> email.mime </em>模块处理。</p><p id="5ce1" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第11行:附件仍然是MIME对象，但是我们需要用base64模块对它们进行编码。</p><p id="29d4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第13行:导入datetime模块。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="li lj l"/></div></figure></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="fb4c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">让我们创建sendemail函数:</strong></p><p id="d358" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第2–6行:创建<code class="du lr ls lt lu b">MIMEMultipart</code>消息对象，并用适当的标题为<code class="du lr ls lt lu b">From</code>、<code class="du lr ls lt lu b">To</code>和<code class="du lr ls lt lu b">Subject</code>字段加载它。</p><p id="3ae5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第9行:添加你的消息体。</p><p id="717d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第11–24行:添加附件。</p><p id="039c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第29–34行:登录邮件服务器并发送邮件。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="li lj l"/></div></figure></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="60b3" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我建议在脚本的顶部定义电子邮件地址和消息内容，这样你就可以很容易地更改它:</p><p id="3810" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第2行:定义发送日期。</p><p id="d3e8" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第4–8行:定义发件人姓名、发件人电子邮件、发件人密码、收件人和主题。</p><p id="25a9" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第10行:创建一个HTML消息。</p><p id="5819" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第14行:调用sendemail函数。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="b88b" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">干杯！！！我现在收到了带销售报告的电子邮件！</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lv"><img src="../Images/077617a0a9affe767f7d8eb3bb96cc59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YT82GBjekgV4Wbnj-ZxJ1Q.png"/></div></div></figure></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="345f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在我们需要配置自动报告发送。</p><p id="695e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">创建一个run.sh</p><pre class="iy iz ja jb fd lw lu lx ly aw lz bi"><span id="2514" class="ma jp hi lu b fi mb mc l md me">#!/bin/bash<br/>source /home/user/.bashrc<br/>python /home/user/sales_report_email.py</span></pre><p id="47e7" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在linux上设置cron作业。</p><pre class="iy iz ja jb fd lw lu lx ly aw lz bi"><span id="1e5b" class="ma jp hi lu b fi mb mc l md me">user@reportsrv$ crontab -e</span><span id="bff2" class="ma jp hi lu b fi mf mc l md me">00 8 * * * /usr/bin/bash /home/user/run.sh &gt; /home/user/logs/run_report_`date +\%Y\%m\%d`.log</span></pre></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="1c74" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这些只是使用Python发送电子邮件的基本选项。您还可以使用for…loop发送多个收件人。为了获得更好的结果，请查看Python文档！</p><p id="c277" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">感谢阅读！如果你喜欢这篇文章，请通过鼓掌来感谢你的支持(👏🏼)按钮，或者通过共享这篇文章让其他人可以找到它。</p><p id="5d00" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">最后，我希望你能学会如何使用python来发送电子邮件。您还可以在<a class="ae jn" href="https://github.com/kindersham/100DaysDS/tree/master/SendEmail" rel="noopener ugc nofollow" target="_blank"> GitHub </a>资源库中找到完整的项目。</p></div></div>    
</body>
</html>