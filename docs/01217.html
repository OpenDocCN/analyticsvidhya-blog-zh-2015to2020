<html>
<head>
<title>Machine Learning for your flat hunt</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的平板搜索提供机器学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-for-your-flat-hunt-part-2-320d98e5e874?source=collection_archive---------22-----------------------#2019-10-08">https://medium.com/analytics-vidhya/machine-learning-for-your-flat-hunt-part-2-320d98e5e874?source=collection_archive---------22-----------------------#2019-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1195" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第2部分:更多的数据，新的希望和更好的模型</h2></div><p id="b3b1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你有没有想过最近的地铁对你公寓价格的影响？你身边的几家幼儿园呢？你准备好投入地理空间数据的世界了吗？</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/029776adfa1b1ffe32b0c8fd6cec66c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zcl6hFD9ZX2xxEt2Yi6sYg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">这个世界提供了如此多的信息…</figcaption></figure><h1 id="4848" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">这是怎么回事？</h1><p id="6138" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">在<a class="ae lg" rel="noopener" href="/@vee.sot/machine-learning-for-your-flat-hunt-part-1-e054e506a4b2">上一部分</a>中，我们有一些数据，并试图在叶卡捷琳堡的房地产市场上找到一个足够好的报价。</p><p id="ca16" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们已经达到了交叉验证准确率接近73%的程度。然而，每个硬币都有两面。73%的准确率是27%的误差。我们怎样才能减少这种情况？下一步是什么？</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="e2de" class="kj kk hi bd kl km lo ko kp kq lp ks kt io lq ip kv ir lr is kx iu ls iv kz la bi translated">空间数据将会有所帮助。</h1><p id="847a" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">从环境中获取更多数据呢？我们可以使用地理环境和一些空间数据。</p><p id="2fda" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很少有人一辈子都呆在家里。有时他们去商店，把孩子从托儿所带走。他们的孩子长大了，去上学，上大学等等。或者…有时他们需要医疗帮助，他们正在寻找医院。一个非常重要的事情是公共交通，至少地铁。换句话说，那里附近有很多东西，对定价有影响。让我给你看一份清单。</p><ul class=""><li id="48da" class="lt lu hi iz b ja jb jd je jg lv jk lw jo lx js ly lz ma mb bi translated">公共交通站</li><li id="30ab" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">商店</li><li id="49b4" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">幼儿园</li><li id="109a" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">医院/医疗机构</li><li id="a055" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">教育机构</li><li id="7330" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">麦德龙</li></ul><p id="a67c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从<a class="ae lg" href="https://bst.digital/" rel="noopener ugc nofollow" target="_blank">不同的来源</a>获得信息后，我做了一个可视化。<br/>地图上有一些点是叶卡捷琳堡最负盛名(也是最昂贵)的地区。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/3afca730586fa7a83b1ad36f90107ba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4tME-gw842J2XoJnaDu4w.png"/></div></div></figure><ul class=""><li id="a282" class="lt lu hi iz b ja jb jd je jg lv jk lw jo lx js ly lz ma mb bi translated"><strong class="iz hj"> R </strong> ed点—平面</li><li id="d3f7" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated"><strong class="iz hj"> O </strong>范围—停止</li><li id="82b1" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">你好——商店</li><li id="a574" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated"><strong class="iz hj"> G </strong>绿色——幼儿园</li><li id="43ea" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated"><strong class="iz hj"> B </strong> lue —教育</li><li id="b8e1" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated"><strong class="iz hj"> I </strong> ndigo —医疗</li><li id="b7c6" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated"><strong class="iz hj"> V </strong> iolet — Metro</li></ul><p id="3a6a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是的，彩虹在这里。</p><p id="88c6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们有了一个以地理数据为界的数据集，其中包含一些新信息</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="79ab" class="mm kk hi mi b fi mn mo l mp mq">df.head(10)</span></pre><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="mr ms l"/></div></figure><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="8810" class="mm kk hi mi b fi mn mo l mp mq">df.describe()</span></pre><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="mr ms l"/></div></figure><h1 id="ff6c" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">一个很好的旧模型</h1><p id="e7d7" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">做与上一部分相同的动作</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="0b26" class="mm kk hi mi b fi mn mo l mp mq">y = df.cost<br/>X = df.drop(columns=['cost'])<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,random_state=42)</span></pre><p id="dc80" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们再次训练我们的模型，交叉手指，并尝试再次预测公寓的价格。</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="ce42" class="mm kk hi mi b fi mn mo l mp mq">from sklearn.linear_model import LinearRegression<br/>regressor = LinearRegression()<br/>model =   regressor.fit(X_train, y_train)<br/>do_cross_validation(X_test, y_test, model)</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mt"><img src="../Images/1c2d98379c943ec55aec22f2ebb0376e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*aNDibILW8WxXguM8Xa42Lw.png"/></div></figure><p id="b4c7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗯……看起来比之前73%准确率的结果要好。试着解释一下怎么样？我们以前的模型有足够好的能力来解释统一价格。</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="9679" class="mm kk hi mi b fi mn mo l mp mq">estimate_model(regressor)</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mu"><img src="../Images/dbb3a37009df40567daa1e0016d539f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h9fzrNqDEhtwtZ3Ej0fkeQ.png"/></div></div></figure><p id="bb02" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">哎呀…我们的新模型与旧功能配合得很好，但新功能的行为似乎很奇怪。</p><p id="e661" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，教育或医疗机构数量的增加会导致公寓价格的下降。因此，公寓附近的停车站数量是相同的情况，它应该对公寓价格有额外的贡献。</p><p id="2c65" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">新模型更好，但它不符合现实生活。</p><h1 id="86bc" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">有东西坏了</h1><p id="16a0" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">让我们想想发生了什么。在ML来到我们的生活之前，线性回归就已经被发明了。这种方法的关键特征是<strong class="iz hj">线性度</strong>。</p><p id="7044" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你的数据符合“X越大，Y也越大”的观点，线性回归就是一个好工具。但是地理数据比我们预期的更复杂。例如:</p><ul class=""><li id="7650" class="lt lu hi iz b ja jb jd je jg lv jk lw jo lx js ly lz ma mb bi translated">当你的公寓附近有一个公共汽车站时，这是很好的，但是如果公共汽车站的数量在5个左右，这将导致一条嘈杂的街道。</li><li id="393c" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">如果有一所大学，它应该对价格有很好的影响，同时，如果你不是一个非常善于交际的人，你家附近的一群学生会不太高兴。</li><li id="cfa9" class="lt lu hi iz b ja mc jd md jg me jk mf jo mg js ly lz ma mb bi translated">你家附近的地铁很好，但是如果你住的地方离最近的地铁站步行一个小时，那就没什么意义了。</li></ul><p id="4d60" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如你所见，这取决于许多因素和观点。我们的地理数据的性质不是线性的，我们无法推断它们的影响。</p><p id="e8d1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同时，为什么具有奇异系数的模型比前一个模型效果更好？</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="c17c" class="mm kk hi mi b fi mn mo l mp mq">plot.figure(figsize=(10,10))<br/>corr = df.corr()*100.0<br/>sns.heatmap(corr[['cost']],<br/>            cmap= sns.diverging_palette(220, 10),<br/>            center=0,<br/>            linewidths=1, cbar_kws={"shrink": .7}, annot=True,<br/>            fmt=".2f")﻿﻿﻿﻿</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mv"><img src="../Images/0e93d4624e33719a1e93a0773d4adc41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*PVvXo-u1UuChy4GH_7Q3xg.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">与楼价的相关性</figcaption></figure><p id="d279" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">看起来很有趣。我们在前面的部分已经看到了类似的图片。<br/>到最近地铁的距离和价格之间存在负相关关系。而且这个因素对精度的影响比一些老的更大。</p><p id="5a47" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同时，我们的模型工作混乱，看不到聚合数据和目标变量之间的依赖关系。这种简单性有其自身的局限性。</p><h1 id="c145" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">国王死了，国王万岁！</h1><p id="f4a2" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">如果线性回归不适合我们的情况，还有什么更好的呢？如果我们的模型能“更聪明”就好了…</p><p id="9ace" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">幸运的是，我们有一个更好的方法，因为它更灵活，并且有一个内置的机制“<em class="mw">做如果这样做，否则做那个</em>”。<strong class="iz hj">决策树</strong>出现。</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="23aa" class="mm kk hi mi b fi mn mo l mp mq">from sklearn.tree import DecisionTreeRegressor</span></pre><p id="ee2e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">决策树可以有不同的深度，通常，当深度为3或更大时，它工作得很好。最大深度参数对结果影响最大。让我们做一些代码来检查深度从3到32</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="cd3a" class="mm kk hi mi b fi mn mo l mp mq">data = [] <br/>for x in range(3,32):<br/>    regressor = DecisionTreeRegressor(max_depth=x,random_state=42)<br/>    model =   regressor.fit(X_train, y_train)<br/>    accuracy = do_cross_validation(X, y, model)<br/>    data.append({'max_depth':x,'accuracy':accuracy})</span><span id="0d36" class="mm kk hi mi b fi mx mo l mp mq">data = pd.DataFrame(data)<br/>ax = sns.lineplot(x="max_depth", y="accuracy", data=data)<br/>max_result = data.loc[data['accuracy'].idxmax()]<br/>ax.set_title(f'Max accuracy-{max_result.accuracy}\nDepth {max_result.max_depth} ')</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es my"><img src="../Images/194183aa857572e30f13e9a12b7bab77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*USm5BpdS6wbujqdNC8TPqg.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">“更多”并不意味着“最好”</figcaption></figure><p id="4443" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗯……对于一棵树的<em class="mw"> max_depth </em>等于8的情况，精度在77以上。</p><p id="ebdb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们不考虑这种方法的局限性，这将是一个很好的成就。让我们看看它如何与<em class="mw"> max_depht=2 </em>一起工作</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="b4a7" class="mm kk hi mi b fi mn mo l mp mq">from IPython.core.display import Image, SVG<br/>from sklearn.tree import  export_graphviz<br/>from graphviz import Source<br/>2_level_regressor = DecisionTreeRegressor(max_depth=2, random_state=42)<br/>model = 2_level_regressor.fit(X_train, y_train)<br/>graph = Source(export_graphviz(model, out_file=None<br/>   , feature_names=X.columns<br/>   , filled = True))<br/>SVG(graph.pipe(format='svg'))</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mz"><img src="../Images/ae845c32875a6ac203be3a0c998722d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gq1Tyj60rwDU3PWI3uu46Q.png"/></div></div></figure><p id="2389" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这张图上，我们可以看到只有4种预测变量。当您使用<em class="mw">决策树回归器时，</em>的工作方式与<em class="mw">线性回归</em>不同。只是不同而已。它不使用因子(系数)的贡献，而<em class="mw">决策树回归器</em>使用“可能性”。一套公寓的价格将与预测的最相似的公寓价格相同。</p><p id="170a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以用那棵树来预测我们的价格。</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="2b8d" class="mm kk hi mi b fi mn mo l mp mq">y = two_level_regressor.predict(X_test)<br/>errors = pd.DataFrame(data=y,columns=['errors'])<br/>f, ax = plot.subplots(figsize=(12, 12))<br/>sns.countplot(x="errors", data=errors)</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es na"><img src="../Images/e0c225df04f46efc48959922b20c2f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iojuzTVZLy9GcxCWoM2w8g.png"/></div></div></figure><p id="e6eb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你的每一个预测都会与这些值中的一个相匹配。当我们使用<em class="mw"> max_depth=8 </em>时，我们预计2000多套公寓不会有超过256种不同的变体。也许这对于分类问题是好的，但是对于我们的情况来说不够灵活。</p><h1 id="e67c" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">群体的智慧</h1><p id="3e14" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">如果你试图预测世界杯决赛的比分，很有可能你会弄错。同时，如果你询问所有裁判对冠军的看法，你会有更好的机会猜测。如果你问独立专家、培训师、法官，然后用答案变魔术——你的机会会大大增加。看起来像是总统选举。</p><p id="9053" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">几棵“原始”树的组合比它们中的每一棵能提供更多。而<em class="mw"> RandomForestRegressor </em>是我们将要使用的工具</p><p id="29ff" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，让我们考虑模型中的基本参数— <em class="mw"> max_depth </em>、<em class="mw"> max_features </em>和一个<em class="mw">数量的树</em>。</p><h2 id="5bff" class="mm kk hi bd kl nb nc nd kp ne nf ng kt jg nh ni kv jk nj nk kx jo nl nm kz nn bi translated">树的数量</h2><p id="a50a" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">依照<a class="ae lg" href="https://www.researchgate.net/publication/230766603_How_Many_Trees_in_a_Random_Forest" rel="noopener ugc nofollow" target="_blank">随机森林中有多少棵树？</a>“最好的选择会是128棵树。进一步增加树的数量不会导致精度的显著提高，但是会增加训练的时间。</p><h2 id="5daa" class="mm kk hi bd kl nb nc nd kp ne nf ng kt jg nh ni kv jk nj nk kx jo nl nm kz nn bi translated">最大特征数量</h2><p id="a3e1" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">现在我们的模型有12个特征。一半是与地势平坦有关的老建筑，另一半与地理环境有关。所以我决定给他们每个人一个机会。假设一棵树有6个特征。</p><h2 id="8e87" class="mm kk hi bd kl nb nc nd kp ne nf ng kt jg nh ni kv jk nj nk kx jo nl nm kz nn bi translated">树的最大深度</h2><p id="918b" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">对于这个参数，我们可以分析一条学习曲线。</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="1acc" class="mm kk hi mi b fi mn mo l mp mq">from sklearn.ensemble import RandomForestRegressor<br/>data = []<br/>for x in range(1,32):<br/>    regressor = RandomForestRegressor(random_state=42, max_depth=x,<br/>                                      n_estimators=128,max_features=6)<br/>    model =   regressor.fit(X_train, y_train)<br/>    accuracy = do_cross_validation(X, y, model)<br/>    data.append({'max_depth':x,'accuracy':accuracy})<br/>data = pd.DataFrame(data)<br/>f, ax = plot.subplots(figsize=(10, 10))<br/>sns.lineplot(x="max_depth", y="accuracy", data=data)<br/>max_result = data.loc[data['accuracy'].idxmax()]</span><span id="2290" class="mm kk hi mi b fi mx mo l mp mq">ax.set_title(f'Max accuracy-{max_result.accuracy}\nDepth {max_result.max_depth} ')</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es no"><img src="../Images/a6a16d8e53064e7cc15fc0b729f95402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*7q6dKcZxzPUkXf4U2MZtsg.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">86%的准确率是惊人的</figcaption></figure><p id="8a75" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">哇……超过86%的准确率，而一个设计树上只有77%。它看起来很神奇，不是吗？</p><h1 id="f54c" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">结论</h1><p id="be36" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">嗯……现在我们在预测方面有了比以前更好的结果，86%接近终点线。检查的最后一步——让我们看看特征的重要性。地理数据对我们的模型有什么好处吗？</p><pre class="ju jv jw jx fd mh mi mj mk aw ml bi"><span id="aeaf" class="mm kk hi mi b fi mn mo l mp mq">feat_importances = pd.Series(model.feature_importances_, index=X.columns)<br/>feat_importances.nlargest(5).plot(kind='barh')</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es np"><img src="../Images/b569f95404996337bc2eded197d44d71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*3QT4xIxMxKx8oQLuGrzKRA.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">五大最重要的功能</figcaption></figure><p id="707a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一些旧的特征仍然对结果有影响。同时，离最近的地铁和幼儿园的距离也受到了影响。这听起来很合理。</p><p id="9554" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">毫无疑问，地理数据帮助我们改进了模型。</p><h1 id="02cc" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">附言</h1><p id="9289" class="pw-post-body-paragraph ix iy hi iz b ja lb ij jc jd lc im jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">我们的旅程还没有结束。86%的准确率对于真实数据来说是一个惊人的结果。与此同时，在我们预期的14%和10%的平均误差之间有一个小的差距。在我们故事的下一章，我们将努力克服这个障碍，或者至少减少这个错误。</p><p id="d4ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae lg" href="https://github.com/VeeSot/flats/blob/master/part2.ipynb" rel="noopener ugc nofollow" target="_blank">这里的</a>是IPython笔记本</p></div></div>    
</body>
</html>