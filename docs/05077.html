<html>
<head>
<title>3 Simple Steps to Merge a Large Number of Files using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python合并大量文件的3个简单步骤</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/3-simple-steps-to-merge-a-large-number-of-files-using-python-b673e6b0de95?source=collection_archive---------16-----------------------#2020-04-10">https://medium.com/analytics-vidhya/3-simple-steps-to-merge-a-large-number-of-files-using-python-b673e6b0de95?source=collection_archive---------16-----------------------#2020-04-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/598bb41ee2fc18b389a052d18be2839d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q8wsbQTqAe0DdF9N"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">卢卡·布拉沃在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="8b90" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据提取后，我们通常需要将这些文件合并在一起，以便进一步分析。可以是几个文件，也可以是几百个文件。只需几个文件就可以很容易地将我们需要的数据复制并粘贴到一个工作表中。然而，当处理大量文件时，手动处理是没有意义的。所以在这里，我要分享一个三步走的方法，我曾经用Python把数据放在一起。</p><h1 id="3cdf" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.导入库</h1><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="7af4" class="la ju hi kw b fi lb lc l ld le">import pandas as pd<br/>import os</span></pre><p id="e4b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了合并文件，我们需要使用两个模块，pandas用于读取CSV文件，os用于与操作(文件)系统交互。</p><h1 id="420e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2.定义变量</h1><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="a4d1" class="la ju hi kw b fi lb lc l ld le">file_list = os.listdir(r'C://Users//kelly//Desktop//data)<br/>Folder_Path = r'C://Users//kelly//Desktop//data'<br/>SaveFile_Path = r'C://Users//kelly//Desktop//data'<br/>SaveFile_Name = r'merged.csv'</span></pre><p id="b170" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，为了简化代码，我创建了4个变量。只有file_list的数据类型是列表(文件夹路径下的所有文件)，除此之外都是字符串。</p><h1 id="618d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">3.循环运行</h1><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="abbd" class="la ju hi kw b fi lb lc l ld le">for i in range(1, len(file_list)):<br/>    df = pd.read_csv(Folder_Path + '//' + file_list[i])<br/>    df.to_csv(SaveFile_Path + '//' + SaveFile_Name, index = False, header = False)</span></pre><p id="e648" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，在for循环中，我逐个读取文件并保存到另一个文件中(在本例中是merged.csv)。因此，merged.csv文件将按行追加。如果需要，还可以更改to_csv的参数。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="7ef9" class="jt ju hi bd jv jw lm jy jz ka ln kc kd ke lo kg kh ki lp kk kl km lq ko kp kq bi translated">关于我</h1><p id="d95c" class="pw-post-body-paragraph iv iw hi ix b iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo lv jq jr js hb bi translated">嗨，我是Kelly，一名具有新闻和传播背景的商业分析研究生，喜欢分享探索数据和有趣发现的生活。如果您有任何问题，请随时联系我，电话:【kelly.szutu@gmail.com】T5T7】</p></div></div>    
</body>
</html>