<html>
<head>
<title>Exploring Users’ Data in twitter using Twitter API.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用twitter API探索Twitter中的用户数据。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploring-users-data-in-twitter-using-twitter-api-612584d0c123?source=collection_archive---------13-----------------------#2020-07-21">https://medium.com/analytics-vidhya/exploring-users-data-in-twitter-using-twitter-api-612584d0c123?source=collection_archive---------13-----------------------#2020-07-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5ed3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">衡量非洲用户在twitter中的影响力。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ec98ec71bfb0d52060863ee0f5659d52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lve3v_z_eWa4rG6168dDRw.jpeg"/></div></div></figure><p id="3b2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我关于数据科学的第一篇文章，也是我作为数据科学家的旅程中的重要一步。我要感谢10所学院，因为它们确实使我比昨天好了10倍。接下来三个月的每个星期，我的技能都会在每周的挑战中不断提高。</p><p id="d0fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在阅读了<a class="ae jp" href="http://twitter.mpi-sws.org/icwsm2010_fallacy.pdf" rel="noopener ugc nofollow" target="_blank">百万追随者谬误文档</a>之后，我开始明白研究影响力如何帮助我们理解为什么某些趋势和创新比其他趋势和创新被更快地采用，以及我们如何帮助广告商和营销人员设计更有效的数字活动。基于这一点，我决定缩小到非洲，衡量一些非洲有影响力的人和非洲政府官员的影响力。以下是对分析的解释。</p><h1 id="bc27" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">通过网络搜集获取数据</h1><p id="19cc" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">第一步是获得非洲推特用户和被认为有影响力的政府高级官员的名单。这是通过以下两个python包实现的:</p><ul class=""><li id="e128" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">用于处理所有HTML处理的BeautifulSoup包</li><li id="8336" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">用于执行HTTPs请求的请求包</li></ul><p id="4e21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我收集数据的两个网站是:</p><ul class=""><li id="a51d" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated"><a class="ae jp" href="https://africafreak.com/100-most-influential-twitter-users-in-africa" rel="noopener ugc nofollow" target="_blank">非洲100名最有影响力的推特用户</a></li><li id="d38b" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated"><a class="ae jp" href="https://www.atlanticcouncil.org/blogs/africasource/african-leaders-respond-to-coronavirus-on-twitter/#east-africa" rel="noopener ugc nofollow" target="_blank">非洲领导人在推特上回应冠状病毒</a></li></ul><p id="8bbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些网站推荐了非洲最具影响力的人物，我们将使用twitter上的数据，通过比较不同的影响力指标来验证这份名单。理解了前进的方向后，我必须安装我将使用的库。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="fa5b" class="lm jr hi li b fi ln lo l lp lq">#Getting the content from the url by making a requests</span><span id="482d" class="lm jr hi li b fi lr lo l lp lq">url="<a class="ae jp" href="https://www.atlanticcouncil.org/blogs/africasource/african-leaders-respond-to-coronavirus-on-twitter/#southern-africa" rel="noopener ugc nofollow" target="_blank">https://www.atlanticcouncil.org/blogs/africasource/african-leaders-respond-to-coronavirus-on-twitter/#southern-africa</a>"<br/>r=requests.get(url)<br/>soup=BeautifulSoup(r.content)<br/>links=soup.find_all('blockquote') #block quote is the tag that contains the information we need.</span></pre><p id="b67e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的代码中，在请求包的帮助下，我们通过传递url获取内容，然后使用BeautifulSoup对其进行转换。通过浏览网站，我们找到了我们需要的列表中的相似性，在这种情况下，我们需要的所有twitter句柄都嵌入在<blockquote>标签中。使用BeautifulSoup，我找到了标签中的所有内容，并将其转换为一个列表字符串。使用python字符串操作，我对数据进行了清理，并获得了twitter句柄。我对另一个网站做了同样的事情，得到了非洲有影响力的人的名单。</blockquote></p><h1 id="2117" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">访问Twitter API</h1><p id="a76d" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">我首先安装了Tweepy——一个用于与twitter API交互的python包装器。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="1e01" class="lm jr hi li b fi ln lo l lp lq"><strong class="li hj"><em class="ls">!pip install tweepy</em></strong></span></pre><p id="5d3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我创建了一个身份验证对象，以便能够从twitter访问数据。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="376b" class="lm jr hi li b fi ln lo l lp lq"># Creating the authentication object<br/>auth = tweepy.OAuthHandler(Consumer key, Consumer secret)<br/># Setting your access token and secret<br/>auth.set_access_token(Access token, Access token_secret)<br/># Creating the API object while passing in auth information<br/>api = tweepy.API(auth, wait_on_rate_limit=True,<br/>                     wait_on_rate_limit_notify=True)</span></pre><p id="4d15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">专注于一个人带领其他人参与某些行为的潜力，我对twitter中的“人际”活动很感兴趣。我有兴趣获得:</p><ul class=""><li id="9fa4" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">用户的追随者数量</li><li id="2861" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">用户的朋友数量</li><li id="3857" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">用户的转发次数</li><li id="c5e9" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">喜欢的数量</li><li id="4836" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">提及次数</li></ul><p id="cefd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来使用用户对象方法，我能够获得列表中所有用户的followers_count和friends_count。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="9654" class="lm jr hi li b fi ln lo l lp lq">#getting followers_count of users<br/>followers = []<br/>for screen_name in names:<br/>    u=api.get_user(screen_name)<br/>    followers.append(u.followers_count)</span><span id="c19d" class="lm jr hi li b fi lr lo l lp lq">#getting friends_count of the users<br/>friends = []<br/>for screen_name in names:<br/>    u=api.get_user(screen_name)<br/>    friends.append(u.friends_count)</span></pre><p id="99a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我编写了一个函数，将转发次数作为retweet_count，将喜欢次数作为favorite_count。该函数获取用户的tweet以及每个tweet的retweet_count和favorite_count。该函数还为每个用户将数据写入csv文件。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="5d16" class="lm jr hi li b fi ln lo l lp lq">def get_tweets(screen_name):</span><span id="697a" class="lm jr hi li b fi lr lo l lp lq">#initialize a list to hold all the tweepy Tweets<br/>    alltweets = []</span><span id="6de0" class="lm jr hi li b fi lr lo l lp lq">#make initial request for most recent tweets (200 is the maximum allowed count)<br/>    new_tweets = api.user_timeline(screen_name = screen_name, count=200)</span><span id="d2b6" class="lm jr hi li b fi lr lo l lp lq">#save most recent tweets<br/>    alltweets.extend(new_tweets)</span><span id="d33d" class="lm jr hi li b fi lr lo l lp lq">#save the id of the oldest tweet minus one<br/>    oldest = alltweets[-1].id - 1</span><span id="a5da" class="lm jr hi li b fi lr lo l lp lq">#keep grabbing tweets until there are no tweets left to grab. <br/>    # Limit set to around 3k tweets, can be edited to preferred number.<br/>    while len(new_tweets) &gt; 0:<br/>        print("getting tweets before %s" % (oldest))</span><span id="b4b7" class="lm jr hi li b fi lr lo l lp lq">#all subsiquent requests use the max_id arg to prevent duplicates<br/>        new_tweets = api.user_timeline(screen_name = screen_name,count=200, max_id=oldest)</span><span id="b889" class="lm jr hi li b fi lr lo l lp lq">#save most recent tweets<br/>        alltweets.extend(new_tweets)</span><span id="3b19" class="lm jr hi li b fi lr lo l lp lq">#update the id of the oldest tweet less one<br/>        oldest = alltweets[-1].id - 1</span><span id="2b36" class="lm jr hi li b fi lr lo l lp lq">print("...%s tweets downloaded so far" % (len(alltweets)))</span><span id="da83" class="lm jr hi li b fi lr lo l lp lq">#transform the tweets into a 2D array that will populate the csv <br/>    outtweets = [[tweet.id_str, tweet.created_at,tweet.retweet_count,tweet.favorite_count, tweet.text.encode("utf-8")] for tweet in alltweets]</span><span id="5f8d" class="lm jr hi li b fi lr lo l lp lq">#write the csv  <br/>    with open('%s_tweets.csv' % screen_name, 'w') as f:<br/>        writer = csv.writer(f)<br/>        writer.writerow(["id","created_at","retweet_count","favorite_count","text"])<br/>        writer.writerows(outtweets)</span><span id="f759" class="lm jr hi li b fi lr lo l lp lq">pass</span></pre><p id="3215" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我需要得到提及；用户在其他推文中被提及的次数。为了避免运行时可能由于一些用户名不可操作而导致的代码中断，我们使用try异常来传递tweepy.error。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="a5ac" class="lm jr hi li b fi ln lo l lp lq">#collecting mentions for the users</span><span id="04bc" class="lm jr hi li b fi lr lo l lp lq">#list100 is a list where i stored the twitter handles. <br/>mentions = [] <br/>for influencer in list100: <br/>  try:<br/>    for status in tweepy.Cursor(api.user_timeline, id=influencer).items():<br/>      if hasattr(status, "entities"):<br/>        entities = status.entities<br/>        if "user_mentions" in entities:<br/>          for ent in entities["user_mentions"]:<br/>            if ent is not None:<br/>              if "screen_name" in ent:<br/>                name = ent["screen_name"]<br/>                if name is not None:<br/>                  mentions.append(name)<br/>  except Exception:<br/>            pass</span></pre><p id="cb8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获得了所有需要的用户信息后，我高兴地开始进行分析。恭喜我们刚刚完成了60%的项目。</p><h1 id="d66c" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">分析推特数据</h1><p id="21b1" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">因为很难确定很少发推文的用户的影响力，所以我把注意力集中在那些有最低活跃水平的用户身上，那些发推文超过50条的用户。我还删除了那些screen_names无效的人的名字，因为这些信息对于确定一个用户被其他人提及或转发的次数非常重要。</p><p id="2263" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从用户在twitter上的活动中，我们可以获得三种类型的影响，如前面提到的文档中所概述的；百万追随者谬论，这些是:</p><ul class=""><li id="5865" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">Indegree影响力(Reach_score)，用户的关注者数量，表示用户的受众。我是通过从追随者中减去以下内容来计算的。</li><li id="85a2" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">转发影响力(popularity_score)，我是通过把转发数和赞数相加来衡量的。这表明用户生成具有传递值的内容的能力。</li><li id="313f" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">提及影响力(relevance_score)，我们通过包含一个人名字的提及次数来衡量。这表明用户在对话中吸引他人的能力。</li></ul><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="9781" class="lm jr hi li b fi ln lo l lp lq">#Calculating the popularity_score and storing the results in a new column<br/>data2["popularity_score"]=data2["retweet_count"]+data2["favorite_count"]</span><span id="9351" class="lm jr hi li b fi lr lo l lp lq">#Calculating the reach score<br/>data2["reach_score"]=data2["No.of followers"]+data2["friends_count"]</span></pre><p id="69ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">微笑，因为我们现在有了全部的数据，但是我们仍然没有回答我们的问题。我们现在将使用不同的影响力指标对我们的数据进行分类，并得出见解和尝试回答，影响力是否取决于一个人拥有的追随者数量？</p><p id="6c26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们先将数据按人气评分排序，根据转发影响力得出前10名。然后我用plotly软件包绘制了数据，这是曲线图。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="550a" class="lm jr hi li b fi ln lo l lp lq">#sorting data according to popularity score<br/>data3.sort_values(by=['popularity_score'], ascending=False).head(10)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/8edb761bf0d8b5eb1c06fbf82466e760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U4ZAlWzPF4tSZAwJYROhMw.png"/></div></div></figure><p id="9f51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其次，我们根据reach_score对列表进行了排序，得到了前10名影响者，然后使用plotly包绘制了一个条形图。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="61f4" class="lm jr hi li b fi ln lo l lp lq">#sorting data according to reach_score<br/>data3.sort_values(by=['reach_score'], ascending=False).head(10)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/9c8ef16fb28782a5e81f640f5c7dbbca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZGY7Vo8xotxcmBo2TRqm7A.png"/></div></div></figure><p id="e657" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我根据提及次数对数据进行了分类，以确定提及影响力的前10名。</p><pre class="je jf jg jh fd lh li lj lk aw ll bi"><span id="80a9" class="lm jr hi li b fi ln lo l lp lq">#sorting data according to mention_count<br/>data3.sort_values(by=['mention_count'], ascending=False).head(10)</span></pre><p id="2cdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分析之后，我从操作中得出不同的见解，以下是见解。</p><h1 id="2885" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="b9fb" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">在这个项目中，我分析了twitter在非洲的影响力，我采用了三种不同的方法来捕捉不同的视角。这些是调查结果:</p><ul class=""><li id="58ed" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">indegree影响力代表用户的受欢迎程度，但它与其他重要指标(如吸引观众，即转发和提及)无关，因此不足以得出用户通过关注者或朋友数量受受受欢迎程度影响的结论。</li><li id="55d8" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">转发是由推文的内容价值驱动的，而提及是由用户的名字价值驱动的。因此，建议普通用户发布丰富而有创意的内容来获得影响力。</li><li id="5183" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">前10名影响者在“受欢迎程度分数”、“可及程度分数”和“相关性分数”上几乎没有重叠，这表明仅“不同意”、“转发”或“提及”影响力很少揭示影响者。</li></ul><p id="327e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这不同意许多人持有的跟随者谬论。</p><p id="876b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的<a class="ae jp" href="https://github.com/Davidelvis/10academyprojects" rel="noopener ugc nofollow" target="_blank"> github库</a>中找到整个项目和材料</p><p id="6c40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ls">跨越话题和时间的影响力动态呢？影响力是自发获得的还是偶然获得的？</em> </strong></p><p id="d42e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将成为我下次文章的一部分。如果你发现这个足智多谋，别忘了与朋友分享。</p><h1 id="35f7" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">参考</h1><p id="7c18" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">我在练习中发现的一些丰富的材料。</p><ol class=""><li id="b125" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc lu kz la lb bi translated"><a class="ae jp" href="https://realpython.com/python-web-scraping-practical-introduction/" rel="noopener ugc nofollow" target="_blank">python中web报废的实用介绍</a></li><li id="4b74" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lu kz la lb bi translated"><a class="ae jp" href="https://africafreak.com/100-most-influential-twitter-users-in-africa" rel="noopener ugc nofollow" target="_blank">https://Africa freak . com/100-非洲最具影响力的推特用户</a></li><li id="627d" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lu kz la lb bi translated">博客:<a class="ae jp" href="https://www.tweetbinder.com/blog/twitter-impressions/" rel="noopener ugc nofollow" target="_blank">如何计算Twitter浏览量并达到</a></li></ol></div></div>    
</body>
</html>