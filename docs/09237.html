<html>
<head>
<title>Clarity in Confusion Matrix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混乱矩阵中的清晰度</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/clarity-in-confusion-matrix-17fb1da6dabf?source=collection_archive---------31-----------------------#2020-08-29">https://medium.com/analytics-vidhya/clarity-in-confusion-matrix-17fb1da6dabf?source=collection_archive---------31-----------------------#2020-08-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8b8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数真实世界场景总是存在类不平衡，这意味着一种类型的数据的观察数量比另一种类型的数据多。例如，在信用卡交易中，欺诈交易的数量远远少于真实交易。同样，在医学上，患病的人数少于健康的人数(感谢上帝！) .</p><p id="8ae1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想象一下，在信用卡场景中，欺诈交易/观察的数量远远少于真实交易。这意味着，在我们的数据集中，只有极少数数据是欺诈性标签，大多数数据是真正的标签。</p><p id="d1a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，在Kaggle的<a class="ae jd" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">信用卡欺诈</a>数据集中，284，807笔交易中只有492笔欺诈。这意味着只有0.172%的观察是欺诈。如果我们创建一个虚拟模型(<em class="je">猜猜看，有一个真实的sklearn虚拟分类器</em>)，它预测所有数据都是真实交易，没有欺诈交易，我们的模型将具有0.998%的准确性。</p><p id="5db4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">喔，是的，没错。我们没有做任何事情就达到了998%的准确率。但是这种准确性能让我们对欺诈数据有所了解吗？不，一点也不。即使有0.998%的准确度，我们的模型也是没有价值的。在这里“混乱矩阵”是我们的救星。这里，我们的目标不是识别真实交易，而是针对欺诈交易。我们不仅要从整个数据集中识别欺诈交易，还要从实际欺诈中识别欺诈交易。</p><h1 id="5604" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">混淆矩阵</h1><p id="eb31" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">混淆矩阵是一个表格，通常用于描述一个分类模型(或“分类器”)对一组真实值已知的测试数据的性能。</p><p id="f69e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个例子:</p><figure class="kj kk kl km fd kn er es paragraph-image"><div class="er es ki"><img src="../Images/251a41801451a72bb02e06ecf2d91b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*VsEWqTA_QQqfLV6G0WAhKw.jpeg"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">样本混淆矩阵</figcaption></figure><h1 id="41b6" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">基本术语</h1><p id="b8ca" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">以下4个基本术语将帮助我们确定我们需要的指标。</p><ul class=""><li id="fc97" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated"><strong class="ih hj">真阳性(TP) </strong>:当实际值为正，预测值也为正时。真正被指责为阳性</li><li id="d46a" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">真负值(TN) </strong>:实际值为负值，预测也为负值时。真正被指责为消极</li><li id="cab6" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">误报(FP) </strong>:实际为负，但预测为正。被错误地指责为阳性</li><li id="5eb4" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">假阴性(FN) </strong>:实际为正，但预测为负。错误地习惯于消极</li></ul><h1 id="211a" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">韵律学</h1><blockquote class="li lj lk"><p id="b2bc" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">准确性:模型预测多长时间是正确的？</strong></p></blockquote><ul class=""><li id="0c43" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">正确预测总数/预测总数</li><li id="6ded" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">(TP+TN)/合计= (100+50)/165 = 0.91</li></ul><blockquote class="li lj lk"><p id="3fbe" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">误分类率:分类器预测出错的频率？</strong></p></blockquote><ul class=""><li id="8fe9" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">错误预测总数/预测总数</li><li id="cea2" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">(FP+FN)/总数= (10+5)/165 = 0.09</li><li id="569f" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">精度的补充，即1 —精度</strong></li><li id="257c" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">也称为“错误率”</li></ul><blockquote class="li lj lk"><p id="7394" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">真阳性率:实际阳性被预测为阳性的频率有多高？</strong></p></blockquote><ul class=""><li id="cf8f" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">也被称为“敏感症”或“回忆T4”</li><li id="ad57" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">TP/(FP+TP) = 100/105 = 0.95</li></ul><blockquote class="li lj lk"><p id="01a1" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">假阳性率:实际阴性被预测为阳性的频率？</strong></p></blockquote><ul class=""><li id="4ee3" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">FP/(TN+FP)= 10/60 = 0.17</li></ul><blockquote class="li lj lk"><p id="9987" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">真阴性率:实际阴性被预测为阴性的频率？</strong></p></blockquote><ul class=""><li id="464d" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">TN/(TN+FP) = 50/60 = 0.83</li><li id="10de" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">假阳性率的补充，即1 —假阳性率</li><li id="2c39" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">也被称为“特异性”</li></ul><blockquote class="li lj lk"><p id="ed6b" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"><strong class="ih hj">精度:当预测为正时，其正确的频率有多高</strong></p></blockquote><ul class=""><li id="4442" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">TP/(FP+TP) = 100/110 = 0.91</li></ul><p id="ebfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请记住，精确度和召回率是最常见的评估指标</p><h1 id="034c" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">让我们现在做一些代码</h1><blockquote class="li lj lk"><p id="e838" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">从sklearn.tree导入决策树分类器</p><p id="2572" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">dt = DecisionTreeClassifier()。拟合(X_train，y_train)</p><p id="9ba6" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">tree _ predicted = dt . predict(X _ test)</p><p id="06a0" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">混淆=混淆_矩阵(y _测试，树_预测)</p></blockquote><figure class="kj kk kl km fd kn er es paragraph-image"><div class="er es lo"><img src="../Images/1edccd44c1f2051798ffe93843a1960e.png" data-original-src="https://miro.medium.com/v2/resize:fit:184/format:webp/1*R8_mnAbjg4PeT91HGsY6rg.jpeg"/></div></figure><blockquote class="li lj lk"><p id="94b6" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">从sklearn.metrics导入准确度分数、精确度分数、召回分数、f1分数</p><p id="bc0f" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">#准确度= TP + TN / (TP + TN + FP + FN)</p><p id="935e" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">#精度= TP / (TP + FP)</p><p id="cdee" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"># Recall = TP / (TP + FN)也称为敏感度或真阳性率</p><p id="2c5c" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated"># F1 = 2 *精度*召回/(精度+召回)</p><p id="8c80" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">打印('精度:{:.2f} '。格式(accuracy_score(y_test，tree_predicted))</p><p id="53a2" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">打印('精度:{:.2f} '。格式(precision_score(y_test，tree_predicted)))</p><p id="8c75" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">打印(' Recall: {:.2f} '。格式(recall_score(y_test，tree_predicted)))</p><p id="675c" class="if ig je ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">打印(' F1: {:.2f})。格式(f1_score(y_test，tree_predicted)))</p></blockquote><figure class="kj kk kl km fd kn er es paragraph-image"><div class="er es lp"><img src="../Images/189dcadd9bc221c411642749a56f3ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*uJQ2dx-mW9IghPmpdHumdw.jpeg"/></div></figure></div></div>    
</body>
</html>