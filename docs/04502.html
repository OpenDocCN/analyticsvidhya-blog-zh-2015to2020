<html>
<head>
<title>Web data scraping with Python &amp; Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和Selenium进行Web数据抓取</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/web-data-scraping-with-python-selenium-7a1e91206642?source=collection_archive---------7-----------------------#2020-03-22">https://medium.com/analytics-vidhya/web-data-scraping-with-python-selenium-7a1e91206642?source=collection_archive---------7-----------------------#2020-03-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7385ddf39b323e0f70a17d45179f4f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZTzAdcEcRna48Wtyguze7g.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用Chrome驱动程序通过python和Selenium快速抓取数据</figcaption></figure><h1 id="0e6f" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">网络数据抓取！？什么、为什么和如何</h1><p id="c0cb" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">抓取数据是抓取网页，将您想要的信息存储到本地数据库或电子表格中，供以后检索或分析。这就像从网页上复制和粘贴内容一样，但抓取通常是由机器人或机器人来完成的，它们定期做这项工作。</p><p id="3ebc" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">需要注意的是，网络抓取违反了大多数网站的服务条款。如果你过于频繁或恶意抓取，你的IP地址可能会被禁止访问某个网站。T3】</p><h1 id="1211" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">为什么是Python？</strong></h1><p id="39f6" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">你可能听说过Python有多棒。但是，其他语言也是如此。那我们为什么要选择Python而不是其他语言进行网页抓取呢？</p><p id="f9e6" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">下面是Python的特性列表，这些特性使它更适合web抓取。</p><ul class=""><li id="039a" class="kw kx hi ju b jv kq jz kr kd ky kh kz kl la kp lb lc ld le bi translated"><strong class="ju hj">易用性:</strong> Python编码简单。您不必添加分号“；”或花括号“{}”的任何位置。这使得它不那么凌乱，易于使用。</li><li id="5611" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">大量的库:</strong> Python拥有大量的库，如<a class="ae lk" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>、<a class="ae lk" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>等。，它为各种目的提供方法和服务。因此，它适用于web抓取和提取数据的进一步操作。</li><li id="ac1a" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">动态类型化:</strong>在Python中，你不必为变量定义数据类型，你可以在任何需要的地方直接使用变量。这样可以节省时间，让你的工作更快。</li><li id="5d7d" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">易于理解的语法:</strong> Python语法易于理解主要是因为阅读Python代码与阅读英文语句非常相似。它富有表现力，易于阅读，Python中使用的缩进也有助于用户区分代码中不同的范围/块。</li><li id="087f" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">小代码，大任务:</strong>使用网页抓取节省时间。但是你花再多时间写代码又有什么用呢？嗯，你不需要。在Python中，你可以编写小代码来完成大任务。因此，即使在编写代码时，您也节省了时间。</li></ul><h1 id="943b" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">硒，哈？</h1><p id="ee99" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">Selenium是一个web测试库。它用于自动化浏览器活动。然后，您可以编写一个python脚本来自动控制浏览器交互，比如链接点击和表单提交。然而，当我们想要从javascript生成的网页内容中提取数据时，Selenium是有用的。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h1 id="782e" class="iu iv hi bd iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn lw jp jq jr bi translated">装置</h1><ul class=""><li id="ecbb" class="kw kx hi ju b jv jw jz ka kd lx kh ly kl lz kp lb lc ld le bi translated"><a class="ae lk" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python 2.x </a>或者<a class="ae lk" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python 3.x </a></li><li id="2f1c" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><a class="ae lk" href="https://pypi.org/project/selenium/" rel="noopener ugc nofollow" target="_blank">硒</a>包</li></ul><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="34b3" class="mj iv hi mf b fi mk ml l mm mn">pip install selenium</span></pre><ul class=""><li id="f35e" class="kw kx hi ju b jv kq jz kr kd ky kh kz kl la kp lb lc ld le bi translated"><a class="ae lk" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank"> Chrome驱动</a> <em class="kv">(版本取决于你的Chrome的版本)</em></li><li id="8a82" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><a class="ae lk" href="https://www.google.com/intl/en_us/chrome/" rel="noopener ugc nofollow" target="_blank">谷歌浏览器</a></li></ul><h1 id="8f66" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">快速入门演示</h1><p id="2f24" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这里是一个简单的python脚本，使用Selenium框架从<a class="ae lk" href="https://www.itftennis.com/en/tournament-calendar/mens-world-tennis-tour-calendar/?startdate=2020-01" rel="noopener ugc nofollow" target="_blank"> ITF世界网球巡回赛</a>日历网站提取数据(赛事详情)并下载到一个CSV文件中。</p><ol class=""><li id="2e5d" class="kw kx hi ju b jv kq jz kr kd ky kh kz kl la kp mo lc ld le bi translated">导入和创建google chrome的新实例，然后访问目标网站:</li></ol><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="f8f6" class="mj iv hi mf b fi mk ml l mm mn">from selenium import webdriver<br/>import pandas as pd</span><span id="98f2" class="mj iv hi mf b fi mp ml l mm mn">DRIVER_PATH = '<em class="kv">chrome driver path on your pc</em>'<br/>driver = webdriver.Chrome(executable_path=DRIVER_PATH)<br/>driver.get('<a class="ae lk" href="https://www.itftennis.com/en/tournament-calendar/mens-world-tennis-tour-calendar/?startdate=2020-01" rel="noopener ugc nofollow" target="_blank">https://www.itftennis.com/en/tournament-calendar/mens-world-tennis-tour-calendar/?startdate=2020-03</a>')</span></pre><p id="c0c2" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">2.定位元素&amp;逐页检查找到目标:</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/20b5fc0555348d1bd37d5bf90a632ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iYrKQgZw59A46nUi-8ycqw.png"/></div></div></figure><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="8293" class="mj iv hi mf b fi mk ml l mm mn">items = len(driver.find_elements_by_class_name("whatson-table__tournament"))</span></pre><p id="136e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">3.解析项目和提取:</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="a66c" class="mj iv hi mf b fi mk ml l mm mn">total = []</span><span id="6c38" class="mj iv hi mf b fi mp ml l mm mn">for item in range(items):</span><span id="59d5" class="mj iv hi mf b fi mp ml l mm mn">items = driver.find_elements_by_class_name("whatson-table__tournament")</span><span id="7dc4" class="mj iv hi mf b fi mp ml l mm mn">for item in items:</span><span id="2b8d" class="mj iv hi mf b fi mp ml l mm mn">t_name = item.find_element_by_class_name('name').text</span><span id="e69a" class="mj iv hi mf b fi mp ml l mm mn">t_date = item.find_element_by_class_name('date').text</span><span id="f7dc" class="mj iv hi mf b fi mp ml l mm mn">t_hostname = item.find_element_by_class_name('hostname').text</span><span id="f0cd" class="mj iv hi mf b fi mp ml l mm mn">t_location = item.find_element_by_class_name('location').text</span><span id="6734" class="mj iv hi mf b fi mp ml l mm mn">t_category = item.find_element_by_class_name('category').text</span><span id="3e3e" class="mj iv hi mf b fi mp ml l mm mn">t_prize_money = item.find_element_by_class_name('prize-money').text</span><span id="738f" class="mj iv hi mf b fi mp ml l mm mn">t_surface = item.find_element_by_class_name('surface').text</span><span id="e0b5" class="mj iv hi mf b fi mp ml l mm mn">t_status = item.find_element_by_class_name('status').text</span><span id="0693" class="mj iv hi mf b fi mp ml l mm mn">new = ((t_name, t_date, t_hostname, t_location, t_category,t_prize_money,t_surface,t_status))</span><span id="5dda" class="mj iv hi mf b fi mp ml l mm mn">total.append(new)</span></pre><p id="271e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">4.数据格式:</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="1b19" class="mj iv hi mf b fi mk ml l mm mn">df = pd.DataFrame(total, columns=['Name', 'Date', 'Hostname','Location','Category','Prize Money','Surface','Status'])</span><span id="ebef" class="mj iv hi mf b fi mp ml l mm mn">df.to_csv('itf_tournaments.csv')</span><span id="0143" class="mj iv hi mf b fi mp ml l mm mn">driver.close()</span></pre><p id="c619" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">所有这些代码加在一起</strong></p><p id="41ea" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">现在，我们将把迄今为止我们所看到的所有内容放入一个代码中。我们可以通过遍历在前面的代码中找到的所有类名，提取特定网页上每个锦标赛的名称、日期、主机名、位置、类别、奖金、表面和状态。</p><p id="5274" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">以下是从网站提取所有锦标赛数据的优化python脚本片段:</p><figure class="ma mb mc md fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="2aa1" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">5.执行和结果:</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/af0e963c9abf490aa1ab0b5f75ec8f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qvLuEOajJiJTk2IZ8ufWWw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在Windows cmd上运行python脚本</figcaption></figure><p id="5eb6" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">从网站抓取数据可能需要几分钟时间。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/e35c033d829341e936b2f6660bbe27a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jezjOFTY8E-eI2qJuF9suw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">生成的包含抓取数据的csv文件</figcaption></figure><h1 id="2426" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结论</h1><p id="89b7" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">只需用23行代码编写一个简单的自动化程序，您就可以查询web服务器、请求数据并解析它以提取您需要的信息。我希望你喜欢这篇文章！现在，您应该对web抓取和Selenium API在Python中的工作原理有了很好的理解。</p><p id="536e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">如果你喜欢这篇文章并想看更多，请关注我的页面！ </p></div></div>    
</body>
</html>