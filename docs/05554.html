<html>
<head>
<title>Generate a static choropleth India map using corona virus pandemic data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用冠状病毒疫情数据生成静态choropleth印度地图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/generate-a-static-choropleth-india-map-using-corona-virus-pandemic-data-19e9cbf5a07d?source=collection_archive---------6-----------------------#2020-04-25">https://medium.com/analytics-vidhya/generate-a-static-choropleth-india-map-using-corona-virus-pandemic-data-19e9cbf5a07d?source=collection_archive---------6-----------------------#2020-04-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a8be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一篇文章中，我将演示如何使用冠状病毒疫情数据和不同的python库创建choropleth地图。我们将使用Matplolib、Geopandas、Geoplot库来生成静态地图。</p><p id="62d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在开始编写代码之前，让我们先来看看<strong class="ih hj">什么是choropleth map </strong>？</p><p id="ab9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">根据谷歌- </strong> <br/> <em class="jd">一种在预先定义的区域内利用阴影、颜色或符号放置的差异来表示这些区域内特定量的平均值的地图。</em></p><p id="4af7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了生成choropleth地图，我们需要地图和数据。我们使用形状文件来生成地图。我们使用excel文件作为数据</p><p id="8793" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Matplolib <br/>  Matplotlib是一个Python 2D绘图库，它以多种硬拷贝格式和跨平台的交互环境生成出版物质量数字。Matplotlib可用于Python脚本、Python和IPython shells、Jupyter笔记本、web应用服务器和四个图形用户界面工具包。</p><p id="3244" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">shape file<br/></strong><strong class="ih hj">shape file</strong>是一种简单的非拓扑格式，用于存储地理要素的几何位置和属性信息。<strong class="ih hj"> shapefile </strong>中的地理特征可以用点、线或多边形(区域)来表示。</p><p id="9c1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过5个步骤实现choropleth映射</p><h2 id="269a" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">步骤1:读取excel文件</h2><blockquote class="jz ka kb"><p id="23b5" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">data _ df = pandas . read _ excel(' data _ ecxel . xlsx ')</p></blockquote><h2 id="0731" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">步骤2:读取形状文件</h2><blockquote class="jz ka kb"><p id="67dc" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">map_df = gpd.read_file(fp)</p></blockquote><h2 id="b7ff" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">步骤3合并地图文件和数据文件</h2><blockquote class="jz ka kb"><p id="7902" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">merged _ data = map _ df . merge(data _ df，on = 'Country '，how = 'left ')</p></blockquote><h2 id="d4c6" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">步骤4:使用库创建绘图</h2><blockquote class="jz ka kb"><p id="2e42" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">fig，ax = plt.subplots(1，figsize=(10，10))</p></blockquote><h2 id="c4b5" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">步骤5:将数据绘制到地图中</h2><blockquote class="jz ka kb"><p id="78e7" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">merged_data.plot(column='cases '，cmap='YlOrRd ')</p></blockquote><p id="044a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看生成静态地图的代码。</p><h2 id="203b" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">使用MATPLOTLIB</h2><p id="35ac" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">必需的进口</p><blockquote class="jz ka kb"><p id="e83c" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">将pandas作为pd导入<br/>将seaborn作为sns导入<br/>将geopandas作为gpd导入<br/>将matplotlib.pyplot作为plt导入</p></blockquote><p id="fd24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">读取形状文件<br/>我们使用geopandas来读取形状文件。</p><blockquote class="jz ka kb"><p id="52e7" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">FP = r ' India-polygon . shp '<br/>map _ df = GPD . read _ file(FP)<br/>map _ df . head()#检查文件头</p></blockquote><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es kk"><img src="../Images/8b0d439fecb91d7a9909dc525e699ce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*_9uzfojIwIhs6R95ffxcdA.png"/></div></figure><p id="244e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用熊猫阅读excel文件</p><blockquote class="jz ka kb"><p id="8e47" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">data _ df = PD . read _ excel(r ' data _ ecxel . xlsx ')<br/>data _ df . rename(columns = { ' Name of State/UT ':' ST _ nm ' }，in place = True)<br/>data _ df . head()#检查文件头</p></blockquote><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es ks"><img src="../Images/7e5db7f509b561c31f462238bcbce0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*JlfVoHKta3QebhJ1_1atVg.png"/></div></figure><p id="deb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">合并具有州名的列上的数据</p><blockquote class="jz ka kb"><p id="526e" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">merged= map_df.merge(data_df，on = 'st_nm '，how = 'left') <br/> merged.head()</p></blockquote><figure class="kl km kn ko fd kp er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/29620ad54aac52f72b7df367f475e747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zp0AgdOq4r0sOf1nUdS8Ng.png"/></div></div></figure><p id="ea69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，使用Matplolib创建绘图</p><blockquote class="jz ka kb"><p id="a67a" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">fig，ax = plt.subplots(1，figsize=(10，10))<br/>ax . axis(' off ')<br/>ax . set _ title(' covi 19 data '，fontdict={'fontsize': '25 '，' fontweight' : '10'})</p></blockquote><p id="bcf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用数据绘制地图</p><blockquote class="jz ka kb"><p id="bc26" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">merged.plot(column= '确诊病例总数'，cmap='YlOrRd '，linewidth=0.8，ax=ax，edgecolor='0 '，legend=True，markersize=[39.739192，-104.990337])</p></blockquote><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es ky"><img src="../Images/202914258bc37c5cd5651d5b321f8755.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*DwPgpuGaQFKI5F4skHCJiw.png"/></div></figure><h2 id="0e22" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">使用GEOPLOT</h2><p id="5b12" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">Geoplot是一个高级Python地理空间绘图库。它是对<code class="du kz la lb lc b">cartopy</code>和<code class="du kz la lb lc b">matplotlib</code>的扩展，使映射变得容易:就像1的<code class="du kz la lb lc b">seaborn</code>。地理空间。它具有以下特性:</p><ol class=""><li id="d730" class="ld le hi ih b ii ij im in iq lf iu lg iy lh jc li lj lk ll bi translated">高级绘图API</li><li id="fb31" class="ld le hi ih b ii lm im ln iq lo iu lp iy lq jc li lj lk ll bi translated">原生投影支持</li><li id="0e18" class="ld le hi ih b ii lm im ln iq lo iu lp iy lq jc li lj lk ll bi translated">与matplotlib的兼容性</li></ol><p id="080d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">必需的进口</p><blockquote class="jz ka kb"><p id="15dc" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">将geoplot作为gdp导入<br/>将geoplot作为gplt导入<br/>将geoplot.crs作为gcr导入</p></blockquote><p id="bdfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用上面生成的文件，通过Geoplot库绘制choropleth mapp。</p><blockquote class="jz ka kb"><p id="27d8" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">gplt.choropleth( <br/>合并，hue= '总确诊病例'，projection=gcrs。AlbersEqualArea()，<br/> edgecolor='black '，linewidth=1，cmap='YlOrRd '，legend=True)</p></blockquote><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es lr"><img src="../Images/f6820a2962cc527849a526983cc804cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*-F8LWF_db9On9glnBxScMw.png"/></div></figure><h2 id="7c0e" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><strong class="ak">使用树叶</strong></h2><p id="5ee9" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">必需的进口</p><blockquote class="jz ka kb"><p id="129b" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">从叶子导入插件<br/>导入ipywidgets <br/>导入地理编码器<br/>导入geopy <br/>导入numpy作为np <br/>导入pandas作为pd</p></blockquote><p id="ee9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要Geojson格式的shapefile来创建边界</p><blockquote class="jz ka kb"><p id="eaa4" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">使用open(r'Indian_States ')作为f导入JSON【T15:<br/>geo JSON _ counties = JSON . load(f)</p></blockquote><p id="2050" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要用州名来设定身份。</p><blockquote class="jz ka kb"><p id="0d7c" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">对于geojson_counties中的I[' features ']:<br/>I[' id ']= I[' properties '][' NAME _ 1 ']<br/>#加载与geo_json相关联的数据<br/>pop _ df = PD . read _ excel(r ' data _ ecxel . xlsx ')<br/>pop _ df . head()</p></blockquote><figure class="kl km kn ko fd kp er es paragraph-image"><div class="er es ls"><img src="../Images/1a97e4df3fea8de46f7487686dd36191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*v5dC_t13evQnJLwNi85avQ.png"/></div></figure><p id="03ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建叶子地图并向其中添加数据</p><blockquote class="jz ka kb"><p id="698e" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">flm。choropleth(<br/>geo _ data = geo JSON _ counties，name='choropleth '，<br/> data=pop_df，columns=['州名/ UT '，'确诊病例总数']，<br/> #参见。Choropleth？关于key_on的详细信息<br/> key_on='feature.id '，fill_color='YlGn '，<br/> fill_opacity=0.5，line_opacity=0.5)。添加到(映射1)</p><p id="09ac" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">#层控制打开或关闭choro pleth<br/>flm。LayerControl()。添加到(映射1)</p><p id="2611" class="if ig jd ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">#显示地图<br/>地图1</p></blockquote><figure class="kl km kn ko fd kp er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lt"><img src="../Images/58a010d2cf577e464ad1f40daeb6d825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzyuDh2dPkKFJTOOuumTxA.png"/></div></div></figure><h1 id="00b6" class="lu jf hi bd jg lv lw lx jk ly lz ma jo mb mc md jr me mf mg ju mh mi mj jx mk bi translated">Github链接:</h1><p id="80d5" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">你可以在这里得到代码和文件<a class="ae ml" href="https://github.com/Princenihith/Maps_with_python" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>