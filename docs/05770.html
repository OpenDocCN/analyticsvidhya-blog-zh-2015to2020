<html>
<head>
<title>Facebook Graph API | Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">脸书图形API | Python</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/facebook-graph-api-python-3c8bab8a5a2a?source=collection_archive---------1-----------------------#2020-05-02">https://medium.com/analytics-vidhya/facebook-graph-api-python-3c8bab8a5a2a?source=collection_archive---------1-----------------------#2020-05-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/35f381240703acc03b6d81284b9b006c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wi2rR55OZ01dvL_S1m6U_g.png"/></div></div></figure><p id="01e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">自从我了解了Python，并且熟练掌握了它的流行库之后，一个总是让我觉得有趣并且总是显示出其巨大潜力的领域就是使用Python的基于HTTP的API调用。人们通常用它来联系各种社交平台，如脸书、推特等。以便提取有意义的数据，如发布的内容、发布的图片、喜欢的内容、完成的评论等。在各种帖子、页面、推文中等等。</p><p id="80b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个这样流行且高效的基于HTTP的API是<strong class="is hj">脸书的Graph API。</strong>在本文中，我们将详细讨论这个API，并且在最后也将亲自动手。</p><h1 id="ee45" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">概述:- </strong></h1><p id="4a8c" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated"><strong class="is hj">图形API </strong>是从<strong class="is hj">脸书</strong>平台获取数据以及将数据发布到其上的主要方式。这是一个基于HTTP的API，应用程序可以通过程序/脚本的方式使用它来查询数据、发布新故事、管理广告、上传照片以及执行各种各样的其他任务。我将使用Python3来完成我的工作，正如你将看到的那样。嗯，远程访问脸书所有可用公共信息的想法本身就很吸引人。不是吗？<br/> <strong class="is hj">哦当然，是它！不过，像往常一样，我想走一步看一步，并请求你沉住气。让我们讨论一下脸书的Graph API，它的基础知识和背景，在我们进入实用主义的方法和接触API之前再多一点。</strong></p><h1 id="88b9" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">基础知识:- </strong></h1><ul class=""><li id="a509" class="kr ks hi is b it km ix kn jb kt jf ku jj kv jn kw kx ky kz bi translated"><strong class="is hj">图形API得名于“社交图”的概念</strong>。社交图通常被定义为说明社交网络中的人、群体和组织之间的互连/关系的图表或图形。<strong class="is hj"> <em class="la">还记得大卫·芬奇的电影《社交网络》吗？</em> </strong></li></ul><figure class="lc ld le lf fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/b9eb667ce0b635d335eccf7961bc9c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*ZAbo-WOj-clzxKnvAKR1ew.jpeg"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">社交网络</figcaption></figure><p id="2cbe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">忠告:只取形象比喻！😛</strong></p><p id="8841" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">术语“社交图”也用于描述个人的社交网络。当描绘成地图时，社交图表现为一组由线连接的网络节点。</p><ul class=""><li id="4741" class="kr ks hi is b it iu ix iy jb lk jf ll jj lm jn kw kx ky kz bi translated"><strong class="is hj">脸书图形API本质上由</strong> <strong class="is hj">节点、边&amp;字段</strong>组成。</li></ul><figure class="lc ld le lf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/b04a76fece17762030f3136987bd94df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y3DvJM1-IBWKzNn6EtbWjw.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">社交图概述| API</figcaption></figure><p id="36d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="la">节点</em> </strong> <em class="la">基本上都是个体唯一的对象，比如一个用户、一张照片、一条评论、一个群组或者一个页面等。一种分类使用节点来获得关于特定对象的信息/数据。假设明天我想获得关于乐队Metallica的官方脸书页面的信息。<br/>显然，这就是我要使用节点的地方。</em> <strong class="is hj"> <em class="la">边缘</em> </strong> <em class="la">基本上就是单个对象和对象集合之间的联系，比如一张照片上的评论或者一个页面上的照片。人们通常利用边缘来获得围绕单个对象的对象集合。</em> <strong class="is hj"> <em class="la">字段</em> </strong> <em class="la">基本上是关于一个对象的数据，例如，一个脸书页面的名字或者一个脸书用户的生日。特别是利用字段来获取关于单个对象或集合中每个对象的数据。</em></p><ul class=""><li id="4092" class="kr ks hi is b it iu ix iy jb lk jf ll jj lm jn kw kx ky kz bi translated"><strong class="is hj">Graph API是基于HTTP的，</strong>这意味着它可以与任何具有HTTP库的语言一起工作，比如cURL或urllib。这也意味着你和我可以在我们的浏览器中直接使用Graph API。你想看看怎么做吗？试着在你的浏览器中请求这个网址(<strong class="is hj"/><a class="ae lo" href="https://graph.facebook.com/facebook/picture?redirect=false" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">【https://graph.facebook.com/facebook/picture?redirect=false】</strong></a><strong class="is hj"/>)。现在如果你看到一个JSON节点对象——说<strong class="is hj"> <em class="la">“天哪，我是真的</em>格兰芬多！😛<em class="la"> " </em> </strong> <em class="la">然后从响应中复制URL，并在另一个选项卡中请求相同的内容，您将看到一个FB徽标图像。现在让我告诉你，它相当于执行了cURL请求:</em><strong class="is hj"><em class="la">cURL-I-X GET \<br/>"https://graph.facebook.com/facebook/picture？redirect=false”。</em>T41】</strong></li><li id="d831" class="kr ks hi is b it lp ix lq jb lr jf ls jj lt jn kw kx ky kz bi translated">图形API的结构是这样的，人们使用<strong class="is hj">节点</strong>来获得关于单个对象的数据。一种是使用<strong class="is hj">边</strong>来获取与一个节点相关联的对象集合，或者将对象发布到那些集合。然后，用户使用<strong class="is hj">字段</strong>来指定用户希望在响应中包含的所有数据。</li><li id="daf4" class="kr ks hi is b it lp ix lq jb lr jf ls jj lt jn kw kx ky kz bi translated"><strong class="is hj">说到主机URL，所有的请求都被传递到graph.facebook.com主机URL。唯一的例外是，我们将见证使用graph-video.facebook.com上传视频的id。</strong></li><li id="2241" class="kr ks hi is b it lp ix lq jb lr jf ls jj lt jn kw kx ky kz bi translated"><strong class="is hj">深入研究对象ID，</strong>我们看到节点是独立的对象，每个节点都有一个唯一的ID，因此人们可以通过直接查询它的ID来获得关于该节点的信息。比方说，我们每天都使用脸书，我们应该知道平台上存在的每个脸书页面或每个脸书用户帐户都有一个ID，允许一个人查询关于该页面或用户的信息:<strong class="is hj"><em class="la">curl-I-X GET \<br/>【"https://graph.facebook.com/object-id？access _ token = your-access-token "</em></strong>。现在，如何获得object-id或access_token，是我将在我们将所有这些付诸实践时解释的事情。现在，我要告诉你的是，你需要一个脸书开发者登录相同的和一些必要的权限，以及应用程序/用户访问令牌，你将生成。</li><li id="0ab3" class="kr ks hi is b it lp ix lq jb lr jf ls jj lt jn kw kx ky kz bi translated"><strong class="is hj"> Objects Fields &amp; Edges : </strong>如果想获得某个节点的特定信息/数据(称为字段)，他/她可以包含Fields参数，并指定他们希望在响应中返回哪些字段。例如，在读取用户对象时，您可以获得的字段之一是<strong class="is hj"> name </strong>字段，这是您在脸书上的名字。下面是查询的样子:<strong class="is hj"><em class="la">curl-I-X GET \ " https://graph . Facebook . com/your-Facebook-user-id？fields = name&amp;access _ token = your-access-token "。<br/> </em> PS : </strong>很容易知道你的facebook-user-id和access_token是你在developers.facebook.com上生成的东西。我们一会儿会讨论这个问题。<br/> <strong class="is hj">比如我提交了下面这个网址——“</strong><a class="ae lo" href="https://graph.facebook.com/your-facebook-user-id?fields=name&amp;access_token=access-token" rel="noopener ugc nofollow" target="_blank">https://graph . Facebook . com/[your-Facebook-user-id]？fields = name&amp;access _ token =[access-token</a>]"<strong class="is hj">在我的浏览器的另一个选项卡中，得到了想要的响应。</strong></li></ul><figure class="lc ld le lf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/dd36e642e1a9301d1b6c34b53ed2d7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2hXfkbm9H_sTYXaPOCu7w.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">向API查询特定数据(字段=名称)</figcaption></figure><ul class=""><li id="346d" class="kr ks hi is b it iu ix iy jb lk jf ll jj lm jn kw kx ky kz bi translated">您还会看到，大多数节点也有边，这些边可以返回与该节点相关联的对象集合。现在，如果您想要查询一条边，您必须使用节点ID和边名。正如我在用户节点引用中所列出的边，有一个<strong class="is hj">照片</strong>边，查询它我得到所有的照片对象。<strong class="is hj">你想试试吗？<br/> </strong>好的，那么要获得你拥有的所有照片，你需要查询节点的<strong class="is hj">照片</strong>边。但是，在我让您运行查询之前，请确保您有一个带有<strong class="is hj"> user_photos </strong>权限的用户访问令牌。您可以使用图形浏览器工具获得一个。你必须登录developers.facebook.com。您可以使用<strong class="is hj"><em class="la">curl-I-X GET \ "https://graph.facebook.com/your-facebook-user-id/photos？access _ token = your-access-token "</em>T13】</strong></li><li id="714b" class="kr ks hi is b it lp ix lq jb lr jf ls jj lt jn kw kx ky kz bi translated">现在，还可以使用Graph API进行POST操作。你知道吗，如果你有一个带有<strong class="is hj"> <em class="la">电子邮件</em> </strong>权限的访问令牌，你就可以更新你的电子邮件字段。你也可以用这个来做同样的事情-<strong class="is hj"><em class="la">curl-I-X POST \ "https://graph.facebook.com/your-facebook-user-id？email=you@your-email.com&amp;访问令牌=你的访问令牌”。</em> </strong></li><li id="b05b" class="kr ks hi is b it lp ix lq jb lr jf ls jj lt jn kw kx ky kz bi translated">同样，您也可以对对象ID执行删除操作，并删除一个节点。</li></ul><figure class="lc ld le lf fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/250803dc91638989073019bfa5c67f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*zNgfbjazcqv3ojsIPPllLw.jpeg"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">不要最终删除你的脸书帐户。</figcaption></figure><p id="98bc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以如果你运行这个命令，你将能够删除你的脸书用户帐号:-<br/><strong class="is hj"><em class="la">curl-I-X DELETE \ "https://graph.facebook.com/object-id？访问令牌=您的访问令牌”。</em> </strong></p><p id="d50e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PS:你可能真的不想那么做！😟🙏只是为了知识！</p><p id="ab74" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以上是脸书图形API的概述，以及它的真正构成。希望我上面提到的基础知识，给你解释了这个概念，嗯。在脸书官方图形API网站上有更多的记录。请通过同样的方式深入潜水。</p><h1 id="6bdc" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">现在是使用PYTHON的时候了</h1><p id="39e0" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">所有设置提取一些有意义的数据从脸书个人资料和网页？</p><figure class="lc ld le lf fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/956fe000ab1cf75728d750077f8b026c.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*G3gozIBF7F3OCOYOcSN9AA.gif"/></div></figure><p id="ffd6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们一步一步来:- </p><ol class=""><li id="72f9" class="kr ks hi is b it iu ix iy jb lk jf ll jj lm jn lx kx ky kz bi translated"><strong class="is hj">首先，</strong> <strong class="is hj">我需要你在脸书上注册成为一名开发者，</strong>因为这将为我们获得访问令牌铺平道路。我的朋友，你知道对公共API的访问权标对一个人来说就像氧气。😆</li></ol><p id="82dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">I)好的，所以你需要在<a class="ae lo" href="http://developers.facebook.com/" rel="noopener ugc nofollow" target="_blank">http://developers.facebook.com/</a>上记账。简单的事情，是吗？</p><p id="e3aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ii)登录后，接下来，我希望您前往<a class="ae lo" href="https://developers.facebook.com/tools/explorer" rel="noopener ugc nofollow" target="_blank">https://developers.facebook.com/tools/explorer</a>。在这里，您需要转到右上角的“我的应用程序”下拉菜单，然后选择“添加新应用程序”。你需要选择一个显示名称，一个类别，然后“创建应用程序ID”。恭喜你，你刚刚创建了一个应用程序。</p><p id="e172" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">iii)现在，我需要你回到https://developers.facebook.com/tools/explorer<a class="ae lo" href="https://developers.facebook.com/tools/explorer" rel="noopener ugc nofollow" target="_blank"/>。你看到右边有一个标签“脸书应用”(下图中标为B)吗？在“脸书应用”下拉列表中，您可以看到您的应用名称。请选择它！</p><p id="d1fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">iv)接下来，您必须从用户或页面下拉菜单<em class="la">(下图中标为C)</em>中选择“获取用户访问令牌”。</p><figure class="lc ld le lf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/c0ea3fac37110fe76a73622837acca31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-QMf2-L2FMdK6n1xinUXMg.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">图形API浏览器-令牌生成器屏幕</figcaption></figure><p id="efd6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">v)从标签“添加权限”<em class="la">(图中标记为D)</em>下出现的菜单中选择权限，最后点击“生成访问令牌”<em class="la">(图中标记为A)</em>。您还会看到一个小图标，用于复制剪贴板上的令牌，就在令牌旁边。<strong class="is hj"> <em class="la">好了，现在您有了用户访问令牌。</em>T13】</strong></p><h1 id="1a31" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">访问FACEBOOK上个人数据的PYTHON代码:- </strong></h1><ol class=""><li id="aeab" class="kr ks hi is b it km ix kn jb kt jf ku jj kv jn lx kx ky kz bi translated">首先，安装facebook-sdk并导入重要的库——“URL lib 3”、“facebook”、“requests”，如果它们已经可用的话。如果没有，请下载这些库。</li></ol><figure class="lc ld le lf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/4c9043f13709804114a434c4980e7208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0FihhYvkTga_K1gYqR2R4A.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">安装所需的库和sdk</figcaption></figure><p id="1f45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.是时候确保我们拥有手头任务的正确权限了。因此，在这里，您需要返回到Graph API Explorer屏幕，并确保在<strong class="is hj">权限</strong>标签下保持不变。</p><figure class="lc ld le lf fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/0403378e4b34311f9b8710e555ba9f76.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*9L9Dbgm2opuuxYTrcpK97g.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">许可</figcaption></figure><p id="9c26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在为自己生成访问令牌之前，请确保您在图形API浏览器屏幕上获得了必要的权限。让我来帮你弄清楚我要执行的活动的权限。显然，在这里我已经获得了用户数据权限中几乎所有可用的权限，但是您不必获得所有权限。您应该根据您的用例获取相关的权限。</p><p id="523b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.现在，我们将尝试从我的脸书个人资料中挖掘一些数据。我们将挖掘数据，即f <strong class="is hj">名字、位置、个人资料链接&amp;电子邮件</strong>。我模糊了一些敏感的信息，我相信你会认为是合理的。我导入json的原因是因为我想以json的形式呈现/存储检索到的数据。这里，<strong class="is hj">令牌</strong>变量应该具有“用户访问令牌”,这是您在标记相关权限后在Graph API Explorer屏幕上生成的。<strong class="is hj"> graph </strong>只是我创建的用来访问API方法的对象。最后，我在get_object方法中使用“me”的原因是因为我们试图提取关于我自己的用户帐户的信息。<br/> <strong class="is hj"> PS : </strong>您可以根据需要增加字段数量。只需确保您拥有所需的权限即可。</p><figure class="lc ld le lf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/105519497623d3cf4894dc062602f3d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V__BUaXgJMNFag_udj-GZQ.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">从我自己的FB用户帐户中挖掘数据</figcaption></figure><p id="647b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="la">接下来，我将更新这篇文章，关于如何访问脸书上可用的公共数据，比如名称中带有特定关键字的事件/某些类型的事件、页面数据、群组数据等。我现在所希望的是，你们中的一些人会发现这篇文章值得你花时间去读。我正在更多地探索Graph API，并承诺会带来Graph API的高级范围和用法。</em>T12】</strong></p><figure class="lc ld le lf fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/e82aba2a822bf115eb780ddd36273e64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*5DRxR-AbvCYEln5baCDHnA.jpeg"/></div></figure></div></div>    
</body>
</html>