<html>
<head>
<title>Hotel Reviews Sentiment Analysis From Scratch To Deployment With Both Machine Learning And Deep Learning Algorithms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">酒店评论情绪分析从零开始到部署，同时使用机器学习和深度学习算法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hotel-reviews-sentiment-analysis-from-scratch-to-deployment-with-both-machine-learning-and-deep-76ba89b14a56?source=collection_archive---------1-----------------------#2020-10-15">https://medium.com/analytics-vidhya/hotel-reviews-sentiment-analysis-from-scratch-to-deployment-with-both-machine-learning-and-deep-76ba89b14a56?source=collection_archive---------1-----------------------#2020-10-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6262" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你只需要知道机器学习对非结构化数据的影响</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><p id="4d28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目录:</p><p id="6c60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(一)问题陈述</p><p id="ee3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈡动机</p><p id="683e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈢数据处理</p><p id="de59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈣数据清理</p><p id="0cc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(五)机器学习模型构建</p><p id="1c91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(六)深度学习模型构建</p><p id="06b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈦部署</p><p id="eeab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈧结论</p><p id="9e66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈨未来的范围</p><p id="3a63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">㈩参考资料</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jk"><img src="../Images/04a363305eb746659f8008e7bf8a616d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T_j8S4R1n__hEsTU"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">Rhema Kallianpur 在<a class="ae jv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="5043" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">(一)问题陈述:</h2><p id="d235" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我们的目标是将给定的酒店评价分为正面评价或负面评价。</p><p id="9317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们的问题陈述属于二元分类问题。</p><h2 id="2dcb" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">㈡动机:</h2><p id="c513" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">如果任何企业想在市场上维持更长的时间，那么他们的客户的评论是他们业务的关键指标。在未来，NLP在商业中扮演着非常重要的角色，因为九分之十的人使用手机进行日常购物、社交媒体发布、电影票预订、医院预约、酒店预订等。如果我们能从这些非结构化数据中提取出一些对业务增长有用的信息，每天都会有数Pb的非结构化数据在网络上产生。</p><p id="6e70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我选择酒店领域，从非结构化数据(文本评论)中提取信息，并为社会发展贡献我的知识。</p><p id="da47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在解决酒店评论分析问题的过程中，我学到了很多东西，获得了更多的知识。</p><h2 id="1d38" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">㈢数据处理:</h2><p id="58ee" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我从Kaggle上获取数据集。【https://www.kaggle.com/anu0012/hotel-review? T4】select=train.csv </p><p id="22ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集分为两个csv文件</p><p id="72af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个csv文件train.csv，包含38932个数据点和5个特征</p><p id="a19b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二个csv文件test.csv包含29404个数据点和5个特征</p><p id="af4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我采用train.csv来训练模型</p><p id="15ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将train.csv分成训练数据集和验证数据集</p><blockquote class="kw kx ky"><p id="1362" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated"><strong class="ih hj">进口熊猫当pd </strong></p><p id="21b4" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated"><strong class="ih hj"> #读取csv </strong></p><p id="f2b2" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated"><strong class="ih hj">df = PD . read _ CSV('/content/Drive/My Drive/archive/train . CSV ')</strong></p><p id="2a90" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated"><strong class="ih hj"> df.head() </strong></p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ld"><img src="../Images/54b21f185c9f33e6b2b560bc9900ba0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J7Qt_YEGO0olk_7l5djUsQ.png"/></div></div></figure><p id="1902" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的数据框包含5个要素</p><p id="6612" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在5个特征中，只有两个特征对情感分析有用</p><p id="5b8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">描述和Is_Response功能仅对情感分析有用</p><p id="e3ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，现在我们可以从数据帧中删除剩余的特征</p><blockquote class="kw kx ky"><p id="b4cd" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">df.drop(['User_ID '，' Browser_Used '，' Device_Used']，axis=1，inplace=True)</p><p id="8428" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#丢弃无用功能后</p><p id="c65c" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">df.head()</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ld"><img src="../Images/59091c271789e2d869160b183edbf4e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dslMl-P6gVW_PtLWvY442A.png"/></div></div></figure><p id="5ff6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们在dataframe中有两个特性</p><h2 id="a759" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated"><strong class="ak">(四)数据清理:</strong></h2><p id="5605" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">这两个功能都有非结构化数据，现在我们需要使用文本到矢量转换技术将非结构化数据转换为结构化数据</p><p id="b04f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在文本到向量的转换之前，我们需要清理描述特征，因为它包含了对情感分类没有用的特殊字符、停用词、数字</p><p id="7a82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于文本清理，我使用了'<strong class="ih hj"> re' </strong>模块</p><p id="8a70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Is_Response包含两个类，一个是<strong class="ih hj">开心</strong>，另一个是<strong class="ih hj">不开心，</strong>现在我们需要将这两个类转换成数值形式，因为机器学习模型只理解数值。</p><p id="5c44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在转换之前，我们需要检查数据帧中是否存在空值</p><blockquote class="kw kx ky"><p id="944c" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">df.isnull()。总和()</p></blockquote><blockquote class="le"><p id="0c05" class="lf lg hi bd lh li lj lk ll lm ln jc dx translated">描述0 <br/> Is_Response 0</p></blockquote><p id="c4bd" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">这两个特性中没有任何空值</p><p id="e375" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们要将Is_Response特征转换成数字形式</p><p id="0e97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用标签编码器来转换Is_Response功能，但我创建了字典并将其映射到Is_Response功能</p><blockquote class="kw kx ky"><p id="319f" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#创建字典</p><p id="1888" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">dict={ '快乐':0，'不快乐':1}</p><p id="26db" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#将字典映射到Is_Response特征</p><p id="a84e" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">df['class']=df['Is_Response']。地图(字典)</p><p id="0455" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">df.head()</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ld"><img src="../Images/95f5f75c5ff2bc7cf124cae8b0cfb62e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ro_ySCBizKeboCjWkorKiw.png"/></div></div></figure><p id="9c88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了<strong class="ih hj">类</strong>特性</p><p id="bcd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不开心:1</p><p id="ba55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐:2</p><p id="b586" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以丢弃Is_Response特性了</p><blockquote class="kw kx ky"><p id="6250" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">df.drop(['Is_Response']，axis=1，inplace=True)</p><p id="140e" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">df.head()</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ld"><img src="../Images/535a9f245be2306bf115d00e47270a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPusNyz9SgfzqAQC-WRp7Q.png"/></div></div></figure><p id="7164" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们成功地将一个特征转换成数字形式</p><p id="a2fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们需要将描述特征转换为矢量，在矢量转换之前，我们需要清除特殊字符、标签、数字等</p><p id="90e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于文本预处理，我使用了<strong class="ih hj"> nltk </strong></p><blockquote class="kw kx ky"><p id="b85b" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#文本预处理</p><p id="266a" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">从nltk.corpus导入停用词</p><p id="7bba" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">从nltk.stem.porter导入PorterStemmer</p><p id="7a6e" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">ps = PorterStemmer()</p><p id="2607" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">语料库= []</p><p id="06b0" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">对于范围内的I(0，len(df)):</p><p id="5faf" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">审查= re.sub('[^a-zA-Z]'，' '，df['描述'][i])</p><p id="16e4" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">review = review.lower()</p><p id="9764" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">review = review.split()</p><p id="6695" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">review =[PS . stem(word)for word in review if not word in stop words . words(' English ')]</p><p id="ae9e" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">评论=“”。加入(审核)</p><p id="f65b" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">corpus.append(评论)</p></blockquote><p id="ff88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过文本预处理后，我们得到了完全干净的语料库</p><blockquote class="kw kx ky"><p id="ccd9" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">文集[15]</p><p id="f7ef" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">10月10日入住，非常喜欢返程日游织女星另一个晚上未被发现出现酒店分数很高地点很棒一尘不染李干净经典的设计舒适的卧室友好的管理人员jorg同事前台狂欢直到发烧友帮忙推荐很棒的餐厅地点参观等管理特别是李帮忙让我们称赞房间事后检查清新甚至飞行回家漫长的一天享受南加利福尼亚的阳光</p></blockquote><p id="e209" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你观察上面的语料库，我们没有任何特殊字符，没有标签，没有数字，没有大写字母，完全词干化的单词</p><p id="c0a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们的描述特性已经完全清理干净了，现在我们可以应用<strong class="ih hj">单词包/Tfidf矢量器/ word2vec </strong>将文本转换成矢量</p><p id="0da2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> TfidfVectorizer: </strong>将文本转换成矢量</p><blockquote class="kw kx ky"><p id="de0b" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">从sk learn . feature _ extraction . text导入tfidf矢量器</p><p id="c9c7" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">从sk learn . feature _ extraction . text导入tfidf矢量器</p></blockquote><p id="6265" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"># I take ngrams = (1，3) [1到3个单词的组合]</p><p id="3574" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#我取前10000个单词(最常用)</p><blockquote class="kw kx ky"><p id="cbc6" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">tfidf =矢量器(max_features=10000，ngram_range=(1，3))</p><p id="5552" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">tfidf_word=tfidf.fit_transform(语料库)。托阵列()</p><p id="84cf" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">tfidf_class=df['class']</p></blockquote><p id="7f9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了数字形式的两个特征</p><p id="710d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">tfidf_word是向量</p><p id="5125" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">tdfidf_class是0/1类</p><blockquote class="kw kx ky"><p id="828e" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">final_df['class']。值计数()</p></blockquote><p id="3c7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">0: 26521</p><p id="a0d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">1: 12411</p><p id="e7f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有不平衡的数据集</p><p id="5dbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了平衡数据集，我们可以进行上采样、下采样或创建合成数据</p><p id="ef79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是我想试验，所以我用不平衡数据集训练模型</p><h2 id="feb7" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated"><strong class="ak">(五)构建机器学习模型:</strong></h2><blockquote class="kw kx ky"><p id="1b46" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">tfidf_word.shape，tfidf_class.shape</p></blockquote><p id="fbe2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">((38932, 10000), (38932,))</p><p id="b8ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#将数据分为训练和测试数据集</p><blockquote class="kw kx ky"><p id="4aec" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">从sklearn.model_selection导入训练_测试_拆分</p><p id="35c7" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">x2_train，x2_test，y2_train，y2 _ test = train _ test _ split(tfi df _ word，tfidf_class，test_size=0.33)</p><p id="71b2" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">x2_train.shape，y2_train.shape</p></blockquote><p id="5c7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">((26084, 10000), (26084,))</p><blockquote class="kw kx ky"><p id="99bc" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">x2 _测试.形状，y2 _测试.形状</p></blockquote><p id="7734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">((12848, 10000), (12848,))</p><p id="42a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用多项式朴素贝叶斯</p><blockquote class="kw kx ky"><p id="b5bb" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">从sklearn.naive_bayes导入多项式</p><p id="9e17" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">分类器_ 2 =多项式inb()</p><p id="0e60" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">分类器_2.fit(x2_train，y2_train)</p></blockquote><p id="80be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">预测训练模型的测试数据</p><blockquote class="kw kx ky"><p id="02fa" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">y2 _ pred =分类器_2 .预测(x2 _测试)</p></blockquote><p id="e571" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数组([0，0，0，…，1，0，0])</p><p id="ce10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练和测试数据集的模型得分</p><blockquote class="kw kx ky"><p id="2cc0" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#关于培训</p><p id="ddf3" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">classifier_2.score(x2_train，y2_train)</p></blockquote><p id="48ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">0.8793896641619383</p><blockquote class="kw kx ky"><p id="57b7" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#测试中</p><p id="5719" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">分类器_ 2 . score(x2 _测试，y2 _测试)</p></blockquote><p id="1ceb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">0.8709526774595268</p><p id="d6ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算训练模型的混淆矩阵</p><blockquote class="kw kx ky"><p id="e12e" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">从sklearn导入指标</p><p id="3fa0" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">metrics . confusion _ matrix(y2 _ test，y2_pred)</p><p id="96f4" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi">([[8278, 480],</p><p id="109b" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi">[1178, 2912]])</p></blockquote><p id="047b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">超参数优化</strong></p><blockquote class="kw kx ky"><p id="ca36" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">hyper _ classifier =多项式B(alpha=0.1)</p></blockquote><p id="32aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将numpy作为np导入</p><p id="9845" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"># alpha是朴素贝叶斯中的超参数</p><p id="d947" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">前一个分数=0</p><blockquote class="kw kx ky"><p id="e039" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">对于np.arange(0，1，0.1)中的alpha:</p><p id="7f6e" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">sub _ classifier =多项式</p><p id="75a3" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">sub_classifier.fit(x2_train，y2_train)</p><p id="03f9" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">y _ pred = sub _ classifier . predict(x2 _ test)</p><p id="e874" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">score = metrics . accuracy _ score(y2 _ test，y2_pred)</p><p id="5619" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">如果分数&gt;上一个分数:</p><p id="2584" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">超级分类器=子分类器</p><p id="0625" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">print("Alpha: {}，Score : {} "。格式(alpha，分数))</p></blockquote><p id="6125" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">超参数结果</p><p id="1b6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.0，分数:0.8756758676876</p><p id="2f2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.1，分数:0.8758658768686</p><p id="954c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.2，分数:0.8758658768686</p><p id="4cc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.30000000000000004，分数:0.800000001</p><p id="6fb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.4，分数:0.8758658758686</p><p id="a1d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.5，分数:0.8758658758686</p><p id="4190" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.600000000000001，分数:0.800000002</p><p id="63d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.700000000000001，分数:0.800000002</p><p id="1f4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.8，分数:0.8758658758686</p><p id="5dad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿尔法值:0.9，分数:0.8758658768686</p><p id="1b67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">我的观察:</strong></p><p id="ab8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在训练数据集上，我们得到了0。36860 . 68686868661</p><p id="d8cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在测试数据集上，我们得到了0。49660 . 68686868686</p><p id="c0f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有不平衡的数据集，根据数据集中一个类支配另一个类的理论，我们的模型偏向于主要类，但我们在训练和测试数据集上得到了几乎相同的结果！。</p><h2 id="c3b8" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">(六)构建深度学习模型:</h2><p id="947e" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在上面，我们已经将Is_Responsible特性转换为class特性</p><p id="612d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我想在tensorflow文档的帮助下将文本转换成矢量形式</p><blockquote class="kw kx ky"><p id="3e55" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#文本预处理</p></blockquote><p id="4324" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">移除特殊字符的功能</p><blockquote class="kw kx ky"><p id="06f4" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">def remove_special_chars(文本):</p><p id="a9ed" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">for remove in map(lambda r:re . compile(re . escape(r))，['，'，':'，" = "，" &amp; "，"；"、' % '、' $ '、' @ '、' % '、'^'、' * '、'('、')'、' { '、' } '、'['、']'、' | '、'/'、' \\ '、'&gt;'、'</p><p id="a832" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">text.replace(remove, ‘’, inplace=True)</p><p id="3525" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">return text</p></blockquote><p id="a116" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Function for removing tags</p><blockquote class="kw kx ky"><p id="04fa" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">def remove_tags(text):</p><p id="bfd8" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">return re.compile( r”  ]+&gt; "。sub("，文本)</p></blockquote><p id="3ede" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">移除数字的功能</p><blockquote class="kw kx ky"><p id="afc7" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">def remove_num(文本):</p><p id="1a29" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">返回“”。join(re sub(r '([0–9+])'，' '，text))</p></blockquote><p id="b515" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我创建了三个单独函数来清理文本</p><p id="daf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#将df复制到新变量中</p><blockquote class="kw kx ky"><p id="a7d7" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">final_df=df.copy()</p></blockquote><p id="e65a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">调用<strong class="ih hj">移除_标签</strong>函数</p><blockquote class="kw kx ky"><p id="2f67" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">final_df。描述=final_df。description . apply(lambda x:remove _ tags(x))</p></blockquote><p id="4e78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">调用<strong class="ih hj">移除数量</strong>函数</p><blockquote class="kw kx ky"><p id="9d24" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">final_df。描述=final_df。description . apply(lambda x:remove _ num(x))</p></blockquote><p id="2c64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">调用<strong class="ih hj"> remove_special_chars </strong>函数</p><blockquote class="kw kx ky"><p id="1f51" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">remove_special_chars(final_df。描述)</p></blockquote><p id="9606" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在调用了所有函数之后，我们从特殊字符、数字和标签中得到干净的文本。</p><p id="16df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们要对句子进行分词，分词后我们得到单词</p><p id="4894" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们想把句子降得更低=真</p><p id="a0f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用' '(空格)<code class="du lt lu lv lw b">Separator for word splitting.</code></p><blockquote class="kw kx ky"><p id="519d" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">Tokenizer = Tokenizer(num _ words = 5000，filters= '！"#$%&amp;()*+,-./:;&lt;=&gt;？@[\\]^_`{|}~\t\n',lower=true,split='’)</p></blockquote><p id="7961" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"># tensorflow文档</p><p id="188e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">tokenizer . fit _ on _ texts():</strong></p><p id="ca6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">根据文本列表更新内部词汇。</strong></p><p id="9e51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">在文本包含列表的情况下，我们假设列表的每个条目是一个令牌。</strong></p><blockquote class="kw kx ky"><p id="0381" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">tokenizer . fit _ on _ texts(final _ df[" Description "])</p></blockquote><p id="8c96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"># tensorflow文档</p><p id="842a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">tokenizer . texts _ to _ sequences():</strong></p><p id="2656" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">将文本中的每个文本转换为整数序列。</strong></p><blockquote class="kw kx ky"><p id="b6f9" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">x = tokenizer . texts _ to _ sequences(final _ df[" Description "])</p></blockquote><p id="4f4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">填充以获得相同长度的句子，如果我们有相同长度的句子，那么我们可以使用一批数据点进行训练。它降低了时间复杂度</p><blockquote class="kw kx ky"><p id="4083" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">X = pad_sequences(X，maxlen=100)</p></blockquote><p id="d60e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经转换了矢量</p><p id="1828" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文本向量</p><blockquote class="kw kx ky"><p id="3f77" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">X[500]</p></blockquote><p id="2b96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数组([ 0，0，0，0，0，0，0，0，0，0，0，0，0，0，0，0，26，298，2，6，47，7，3，425，14，21，3，566，71，1483，3，22，1022，12，21，133，2107，2568，4，1，179，63，6 1，123，118，651，52，94，193，70，1295，7，1，1248，496，6，289，1，12，2533，120，88]，dtype=int32)</p><p id="013d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们仔细观察上面的矢量，500个索引句转换成矢量。句子中的每个单词由语料库中的单词索引来表示</p><blockquote class="kw kx ky"><p id="5c90" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">y= final_df['class']</p></blockquote><p id="9b17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">词汇_大小</p><blockquote class="kw kx ky"><p id="e2de" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">vocab _ size = len(tokenizer . word _ index)+1</p><p id="76f8" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">vocab_size</p></blockquote><p id="db77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">70925</p><p id="1c1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">出于部署目的，我们需要将标记器保存到pickle文件中。</p><blockquote class="kw kx ky"><p id="023b" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated"><strong class="ih hj">导入</strong><strong class="ih hj">pickle</strong><br/>T5】#保存 <br/> <strong class="ih hj">用</strong>打开(' tokenizer.pickle '，' WB ')【T10])作为句柄:<br/> pickle.dump(tokenizer，handle，protocol=pickle。最高_协议)</p></blockquote><p id="198f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将数据分为训练和测试数据集</p><p id="b4fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">x =转换矢量</p><p id="4d33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">y=审查等级</p><blockquote class="kw kx ky"><p id="a789" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated"><strong class="ih hj">from</strong><strong class="ih hj">sk learn . model _ selection</strong><strong class="ih hj">import</strong>train _ test _ split<br/>X _ train，X_test，Y_train，Y_test = train_test_split(X，Y，test_size=0.3，random_state = 24)</p></blockquote><p id="4be9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">构建用于训练的单层LSTM细胞</p><p id="d680" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">LSTM模型需要嵌入层和密集层进行训练</p><p id="7271" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嵌入层把正整数(索引)变成固定大小的密集向量。</p><p id="c490" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的问题陈述属于二进制分类，因此我们需要在密集层中使用sigmoid激活</p><p id="b4c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在LSTM细胞中，神经元数目是超参数，我取100个神经元。</p><p id="2be5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要指定嵌入向量输出，我取嵌入向量输出大小= 40，它也是一个超参数</p><p id="4b80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">优化器=adam，指标=准确性</p><p id="5e4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型结构</p><blockquote class="kw kx ky"><p id="8443" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">embedding_vector_features = 40<br/>model = Sequential()<br/>model . add(Embedding(vocab _ size，Embedding _ vector _ features，input _ length = 100))<br/>model . add(LSTM(100))<br/>model . add(Dense(1，activation='sigmoid '))</p></blockquote><pre class="jd je jf jg fd lx lw ly lz aw ma bi"><span id="4a93" class="jw jx hi lw b fi mb mc l md me">Model: "sequential"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>embedding (Embedding)        (None, 100, 40)           2837000   <br/>_________________________________________________________________<br/>lstm (LSTM)                  (None, 100)               56400     <br/>_________________________________________________________________<br/>dense (Dense)                (None, 1)                 101       <br/>=================================================================<br/>Total params: 2,893,501<br/>Trainable params: 2,893,501<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><p id="adbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型编译</p><blockquote class="kw kx ky"><p id="2226" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">model . compile(loss = ' binary _ cross entropy '，optimizer='adam '，metrics =[' accuracy '])<br/>print(model . summary())</p></blockquote><p id="5298" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">拟合模型</p><p id="0233" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">batch_size和epochs是超参数，我手动取batch_size =32和epochs=20</p><blockquote class="kw kx ky"><p id="eec4" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">history=model.fit(X_train，Y_train，batch_size=32，epochs=20，validation_data=(X_test，Y_test)，)</p></blockquote><pre class="jd je jf jg fd lx lw ly lz aw ma bi"><span id="58a5" class="jw jx hi lw b fi mb mc l md me">Epoch 16/20<br/>852/852 [==============================] - 44s 51ms/step - loss: 0.0529 - accuracy: 0.9835 - val_loss: 0.7259 - val_accuracy: 0.8307<br/>Epoch 17/20<br/>852/852 [==============================] - 43s 51ms/step - loss: 0.0400 - accuracy: 0.9880 - val_loss: 0.8985 - val_accuracy: 0.8256<br/>Epoch 18/20<br/>852/852 [==============================] - 43s 51ms/step - loss: 0.0387 - accuracy: 0.9882 - val_loss: 0.8848 - val_accuracy: 0.8247<br/>Epoch 19/20<br/>852/852 [==============================] - 44s 51ms/step - loss: 0.0268 - accuracy: 0.9917 - val_loss: 1.0238 - val_accuracy: 0.8229<br/>Epoch 20/20<br/>852/852 [==============================] - 44s 51ms/step - loss: 0.0329 - accuracy: 0.9905 - val_loss: 0.8495 - val_accuracy: 0.8091</span></pre><p id="d0ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你在第20世末观察上述训练过程</p><p id="9ed4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练精度= 0.99，val_accuracy = 0.80</p><p id="2213" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练损失= 0.032，val_loss=0.84</p><p id="b6fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着训练损失减少，验证损失增加，这意味着模型过度拟合。我们知道我们的数据集是不平衡的，如果我们在不平衡的数据集上训练一个神经网络，它偏向于主要类</p><p id="96c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在机器学习模型中没有太多的准确性差异，但当谈到深度学习模型时，我们清楚地了解不平衡数据集的影响</p><p id="5bad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了克服这个问题，我们可以在训练时使用退出率，退出率是神经网络中的一种正则化技术。</p><p id="d4cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用新数据评估已训练的模型</p><blockquote class="kw kx ky"><p id="775c" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#新评论</p><p id="3e72" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">string11= ' ' '这家酒店太棒了，我喜欢它的服务，安东尼是一个很棒的人，你可以在前台看到他！它离一切都很近，对孩子们来说很棒，我喜欢它。有史以来最好的酒店，但非常干净，质量非常好，非常适合夫妇和单身人士。''</p><p id="ff2b" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#使用新评审评估训练模式</p><p id="c80b" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">x _ 1 = tokenizer . texts _ to _ sequences([string 11])<br/>x _ 1 = pad _ sequences(x _ 1，maxlen = 100)<br/>model . predict(x _ 1)</p></blockquote><p id="9096" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出</p><blockquote class="kw kx ky"><p id="a809" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">数组([[0.00015311]]，dtype=float32)</p><p id="6ae3" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">我们知道0:正类1:负类</p></blockquote><p id="c80e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出值接近0，给定评论为正，模型预测也为正，因此我们的训练模型在新数据上工作良好，但我们不能断定它是广义模型。我们需要做大量的hypreparameter优化，然后只有我们可以得出结论。</p><p id="405e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">建立辍学率为0.5的LSTM</strong></p><p id="fb85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的训练中我们知道我们的LSTM模型过度拟合。为了避免这种情况，我们需要进行超参数优化、辍学率和批量标准化层添加。</p><p id="b052" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">辍学率调整神经网络，所以为了避免过度拟合的问题，我只添加了50%的辍学率其余网络与上述LSTM网络相同的辍学层。我们也可以添加批处理标准化，但是我想在数据上进行实验，所以我只取辍学率。</p><blockquote class="kw kx ky"><p id="f6c4" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#模型构建</p><p id="77a0" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">Dropout tec embedding_vector_features = 40<br/>model _ 2 = Sequential()<br/>model _ 2 . add(Embedding(vocab _ size，Embedding _ vector _ features，input _ length = 100))<br/>model _ 2 . add(Dropout(0.5))<br/>model _ 2 . add(LSTM(100))<br/>model _ 2 . add(Dropout(0.5))<br/>model _ 2 . add(Dense(1，activation='sigmoid '))</p><p id="234a" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#模型编译<br/>Model _ 2 . compile(loss = ' binary _ cross entropy '，optimizer='adam '，metrics =[' accuracy '])<br/>print(Model _ 2 . summary())</p></blockquote><pre class="jd je jf jg fd lx lw ly lz aw ma bi"><span id="e953" class="jw jx hi lw b fi mb mc l md me">Model: "sequential_1"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>embedding_1 (Embedding)      (None, 100, 40)           2837000   <br/>_________________________________________________________________<br/>dropout (Dropout)            (None, 100, 40)           0         <br/>_________________________________________________________________<br/>lstm_1 (LSTM)                (None, 100)               56400     <br/>_________________________________________________________________<br/>dropout_1 (Dropout)          (None, 100)               0         <br/>_________________________________________________________________<br/>dense_1 (Dense)              (None, 1)                 101       <br/>=================================================================<br/>Total params: 2,893,501<br/>Trainable params: 2,893,501<br/>Non-trainable params: 0</span></pre><p id="0614" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#拟合模型</p><blockquote class="kw kx ky"><p id="e04f" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">history_2=model_2.fit(X_train，Y_train，<br/> batch_size=32，<br/>epoch = 20，<br/> validation_data=(X_test，Y_test)，<br/>)</p></blockquote><pre class="jd je jf jg fd lx lw ly lz aw ma bi"><span id="af07" class="jw jx hi lw b fi mb mc l md me">Epoch 16/20<br/>852/852 [==============================] - 30s 35ms/step - loss: 0.1535 - accuracy: 0.9424 - val_loss: 0.4867 - val_accuracy: 0.8491<br/>Epoch 17/20<br/>852/852 [==============================] - 29s 34ms/step - loss: 0.1494 - accuracy: 0.9442 - val_loss: 0.5066 - val_accuracy: 0.8455<br/>Epoch 18/20<br/>852/852 [==============================] - 30s 35ms/step - loss: 0.1459 - accuracy: 0.9459 - val_loss: 0.4815 - val_accuracy: 0.8439<br/>Epoch 19/20<br/>852/852 [==============================] - 30s 35ms/step - loss: 0.1397 - accuracy: 0.9482 - val_loss: 0.4840 - val_accuracy: 0.8450<br/>Epoch 20/20<br/>852/852 [==============================] - 30s 35ms/step - loss: 0.1414 - accuracy: 0.9481 - val_loss: 0.4699 - val_accuracy: 0.8447</span></pre><p id="8262" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你在20世纪末观察上述训练过程</p><p id="cce8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练精度= 0.9481，Val_accuracy = 0.84</p><p id="5b22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练损失= 0.1414，val_loss = 0.4699</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mf"><img src="../Images/8abf05282a2917e2132d3d22118f10d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*QRsyQ0pL_ItoERSnYDKPFg.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">失败</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mg"><img src="../Images/43b334238c75423695141256aa9fc597.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*CP34UsyrVy7i7ZFZNv0Ypg.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">准确(性)</figcaption></figure><p id="681f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与没有辍学率的LSTM网络相比，通过添加辍学率，我们的模型val_loss也随着训练损失而减少。因此，通过增加辍学率，我们的模型有更少的机会过度拟合。</p><p id="1d34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在不进行参数优化的情况下，仅训练20个时期的模型，我就获得了近94 %的准确率</p><p id="f505" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我进行超参数优化，并添加Dropout和BatchNormalization层，那么我可以获得一般化的模型，它可以对新数据执行更显著的操作。</p><p id="7fec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我的目标是了解不平衡数据集如何影响神经网络</p><p id="37cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">我的观察</strong></p><p id="25ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果没有退出率，我们的模型会因为不平衡的数据集而过度拟合</p><p id="b068" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过增加退出率，我们的模型不容易过度拟合</p><p id="ee80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过进行超参数优化和添加批处理规范化，我们可以提高模型在新数据上的性能。</p><p id="cc3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">双向LSTM : </strong></p><p id="ef3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用双向将通过两种方式运行我们的输入，一种是从过去到未来，另一种是从未来到过去，这种方式与单向的不同之处在于，在向后运行的LSTM中，您可以保存来自未来的信息，并且结合使用两种隐藏状态，您可以在任何时间点保存来自过去和未来的信息。</p><p id="7647" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">构建单层双向LSTM细胞用于训练</p><p id="65d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">双LSTM模型需要嵌入层和密集层进行训练</p><p id="708d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嵌入层把正整数(索引)变成固定大小的密集向量。</p><p id="d276" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的问题陈述属于二进制分类，因此我们需要在密集层中使用sigmoid激活</p><p id="2fff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在双LSTM细胞中，神经元数目是超参数，我取100个神经元。</p><p id="4875" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要指定嵌入向量输出，我取嵌入向量输出大小= 40，它也是一个超参数。</p><p id="a81c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我以0.65的辍学率添加了辍学层</p><p id="5f88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">优化器=adam，指标=准确性</p><blockquote class="kw kx ky"><p id="74d6" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#模型构建</p><p id="d5e5" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">embedding_vector_features = 40<br/>model _ 3 = Sequential()<br/>model _ 3 . add(Embedding(vocab _ size，Embedding _ vector _ features，input _ length = 100))<br/>model _ 3 . add(Dropout(0.65))<br/>model _ 3 . add(双向(LSTM(100)))<br/>model _ 3 . add(Dropout(0.65))<br/>model _ 3 . add(Dense(1，activation='sigmoid '))</p><p id="f765" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#模型编译<br/>Model _ 3 . compile(loss = ' binary _ cross entropy '，optimizer='adam '，metrics =[' accuracy '])<br/>print(Model _ 3 . summary())</p></blockquote><pre class="jd je jf jg fd lx lw ly lz aw ma bi"><span id="683f" class="jw jx hi lw b fi mb mc l md me">Model: "sequential_3"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>embedding_3 (Embedding)      (None, 100, 40)           2837000   <br/>_________________________________________________________________<br/>dropout_4 (Dropout)          (None, 100, 40)           0         <br/>_________________________________________________________________<br/>bidirectional_1 (Bidirection (None, 200)               112800    <br/>_________________________________________________________________<br/>dropout_5 (Dropout)          (None, 200)               0         <br/>_________________________________________________________________<br/>dense_3 (Dense)              (None, 1)                 201       <br/>=================================================================<br/>Total params: 2,950,001<br/>Trainable params: 2,950,001<br/>Non-trainable params: 0</span></pre><p id="f664" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#拟合模型</p><blockquote class="kw kx ky"><p id="08a3" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">history_2=model_3.fit(X_train，Y_train，<br/> batch_size=32，<br/> epochs=20，<br/> validation_data=(X_test，Y_test)，<br/>)</p></blockquote><pre class="jd je jf jg fd lx lw ly lz aw ma bi"><span id="43ec" class="jw jx hi lw b fi mb mc l md me">Epoch 16/20<br/>852/852 [==============================] - 36s 42ms/step - loss: 0.1928 - accuracy: 0.9258 - val_loss: 0.4412 - val_accuracy: 0.8521<br/>Epoch 17/20<br/>852/852 [==============================] - 36s 42ms/step - loss: 0.1915 - accuracy: 0.9270 - val_loss: 0.4410 - val_accuracy: 0.8501<br/>Epoch 18/20<br/>852/852 [==============================] - 36s 42ms/step - loss: 0.1840 - accuracy: 0.9300 - val_loss: 0.4129 - val_accuracy: 0.8537<br/>Epoch 19/20<br/>852/852 [==============================] - 36s 42ms/step - loss: 0.1836 - accuracy: 0.9290 - val_loss: 0.4079 - val_accuracy: 0.8492<br/>Epoch 20/20<br/>852/852 [==============================] - 35s 42ms/step - loss: 0.1787 - accuracy: 0.9329 - val_loss: 0.4438 - val_accuracy: 0.8545</span></pre><p id="55eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你在20世纪末观察上述训练过程</p><p id="b109" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练精度= 0.9329，val_accuracy= 0.85</p><p id="b786" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练损失= 0.17，val_loss = 0.44</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mh"><img src="../Images/5eefcfaab1e57e2c732ec09413d70065.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*Te32F91eqORB8DkOrnTzxg.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">失败</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mg"><img src="../Images/f37d3e3e5146ae8f9d9cf60c553e569f.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*9W7BDPTWxyYyZ69tAhI4qg.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">准确(性)</figcaption></figure><p id="4599" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你观察以上结果，双向LSTM比LSTM好一些什么</p><p id="aebb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过进行超参数优化和添加批处理规范化，我们可以提高模型的性能</p><p id="6e83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">出于部署目的保存双向模型</p><blockquote class="kw kx ky"><p id="e3b4" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#保存训练模型</p><p id="0c98" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">model_3.save('b_lstm.h5 ')</p></blockquote><p id="8dcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用新数据评估双LSTM</p><blockquote class="kw kx ky"><p id="1275" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#用于评估培训模型的新数据</p><p id="a223" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">string11= ' ' '我们想找一家离电视节目《菲尔博士》拍摄地很近的汽车旅馆，于是选择了西好莱坞日落大道上的沙丘。尽管该酒店展示了AAA标志，但仍有许多不足之处。浴室的门框底部有碎片和刮痕，乳液容器是半满的——显然没有被客房服务人员更换。我们需要一个早期的叫醒电话，但不能使用收音机闹钟，因为房间里没有收音机。遥控器上没有电视频道列表，电视菜单上也没有，这让看电视成了一件苦差事。退房时，电视遥控器必须归还。这个地方达到了它的目的，但不是一个重游的地方。''</p><p id="3ca5" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#使用tokenizer将上述文本转换为矢量</p><p id="c804" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">x _ 1 = tokenizer . texts _ to _ sequences([string 11])</p><p id="7ff7" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#在转换的向量上填充<br/> x_1 = pad_sequences(x_1，maxlen=100)</p><p id="bfac" class="if ig kz ih b ii ij ik il im in io ip la ir is it lb iv iw ix lc iz ja jb jc hb bi translated">#根据新数据评估训练模型<br/> model_3.predict(x_1)</p></blockquote><p id="7599" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出数组([[0.98076105]]，dtype=float32)</p><p id="5bfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">给定的新数据是负面评论数据</p><p id="3571" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型预测也遭到负面评论</p><p id="0307" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们训练过的模型在新数据上表现良好。</p><p id="9c8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过进行超参数优化来提高我们的模型性能。</p><h2 id="0e80" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated"><strong class="ak">(七)使用流线型框架部署经过训练的双向LSTM:</strong></h2><p id="750f" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">对于部署，我们需要经过训练的model.h5和tokenizer.pkl</p><p id="d6a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经保存了这两个文件</p><p id="1221" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了构建web应用程序，我使用了streamlit框架</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mi jj l"/></div></figure><p id="067f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以在任何云平台上部署这个web应用程序，这是深度学习模型，所以我们不能在Heroku上部署这个web应用程序，因为Heroku只允许500 MB的应用程序。这个应用程序将超过500 MB，所以请在AWS或Azure上尝试</p><p id="1923" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于部署，我们需要requirement.txt、setup.sh、Procfile文件</p><h2 id="c083" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated"><strong class="ak">(八)结论:</strong></h2><p id="1f81" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated"><strong class="ih hj">没有辍学的LSTM:</strong></p><p id="a3c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总参数:2，893，501</p><p id="5945" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在20世纪末期</p><p id="7036" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练精度= 0.99，val_accuracy = 0.80</p><p id="a57a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练损失= 0.032，val_loss=0.84</p><p id="3c28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着训练损失减少，验证损失增加，这意味着模型过度拟合。</p><p id="d113" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">辍学的LSTM:</strong></p><p id="37c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总参数:2，893，501</p><p id="0bbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在20世纪末</p><p id="0143" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练精度= 0.9481，Val_accuracy = 0.84</p><p id="83e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练损失= 0.1414，val_loss = 0.4699</p><p id="55ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与没有辍学率的LSTM网络相比，通过添加辍学率，我们的模型val_loss也随着训练损失而减少。因此，通过增加辍学率，我们的模型有更少的机会过度拟合。</p><p id="d1f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">带压差的双向LSTM</strong></p><p id="6897" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总参数:2950001</p><p id="16f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在20世纪末</p><p id="1b0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练精度= 0.9329，val_accuracy= 0.85</p><p id="8568" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练损失= 0.17，val_loss = 0.44</p><p id="5154" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你观察以上结果，双向LSTM比LSTM好一些什么</p><p id="1b51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我这篇文章的主要目的是不平衡数据集如何影响机器学习模型</p><p id="6abb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在朴素贝叶斯中，我们没有发现那么大的影响，但是当涉及到深度学习模型时，我们观察到不平衡数据集的影响</p><p id="558d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不平衡数据集的LSTM影响为了克服不平衡数据集的影响，我在LSTM模型中使用了辍学率，然后我们的模型减少了不平衡数据集的影响。我们可以进行超参数优化来提高性能。</p><h2 id="9e42" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">㈨未来范围:</h2><ul class=""><li id="6ab6" class="mj mk hi ih b ii kr im ks iq ml iu mm iy mn jc mo mp mq mr bi translated">应用更多算法并检查不平衡数据集的影响</li><li id="f2b1" class="mj mk hi ih b ii ms im mt iq mu iu mv iy mw jc mo mp mq mr bi translated">超参数优化</li><li id="eef5" class="mj mk hi ih b ii ms im mt iq mu iu mv iy mw jc mo mp mq mr bi translated">添加合成数据以平衡数据集</li></ul><h2 id="d492" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated">㈩参考资料:</h2><ul class=""><li id="85bb" class="mj mk hi ih b ii kr im ks iq ml iu mm iy mn jc mo mp mq mr bi translated"><a class="ae jv" href="https://github.com/streamlit/streamlit" rel="noopener ugc nofollow" target="_blank">https://github.com/streamlit/streamlit</a></li><li id="4f1a" class="mj mk hi ih b ii ms im mt iq mu iu mv iy mw jc mo mp mq mr bi translated"><a class="ae jv" href="https://stackoverflow.com/questions/43035827/whats-the-difference-between-a-bidirectional-lstm-and-an-lstm" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/43035827/a-bidirectional-lstm-and-an-lstm有什么区别</a></li></ul></div></div>    
</body>
</html>