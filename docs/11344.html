<html>
<head>
<title>Essential developer tools for improving your Python code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于改进Python代码的基本开发工具</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/essential-developer-tools-for-improving-your-python-code-71616254134b?source=collection_archive---------9-----------------------#2020-11-30">https://medium.com/analytics-vidhya/essential-developer-tools-for-improving-your-python-code-71616254134b?source=collection_archive---------9-----------------------#2020-11-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5097726cec363c5a4f265c8c608c8e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rt_M2_BUE_6RjEKJ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae iu" href="https://unsplash.com/@louishansel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Louis Hansel @shotsoflouis </a>拍摄的照片</figcaption></figure><p id="c589" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我多年使用Python作为编程语言开发软件的过程中，我越来越喜欢一些开发工具，它们可以帮助我编写更好的代码。特别是当与团队中的其他开发人员一起工作时，这些工具可以用来创建统一的代码库，这些代码库经过了良好的测试，更加安全，对所有合作开发人员来说都是可读的。</p><p id="8722" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我将分享我喜欢的开发人员工具，并向您展示如何使用Git预提交钩子在每次Git提交或推送操作中自动运行这些工具。</p><h2 id="cb79" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">内容</h2><ol class=""><li id="9ed1" class="ko kp hi ix b iy kq jc kr jg ks jk kt jo ku js kv kw kx ky bi translated">你为什么需要这些工具？</li><li id="e2ae" class="ko kp hi ix b iy kz jc la jg lb jk lc jo ld js kv kw kx ky bi translated">工具</li><li id="f63d" class="ko kp hi ix b iy kz jc la jg lb jk lc jo ld js kv kw kx ky bi translated">代码样式和格式化工具(isort、Flake8、Bugbear、Black、Mypy)</li><li id="fcc4" class="ko kp hi ix b iy kz jc la jg lb jk lc jo ld js kv kw kx ky bi translated">软件测试工具(Pytest，coverage.py)</li><li id="6efb" class="ko kp hi ix b iy kz jc la jg lb jk lc jo ld js kv kw kx ky bi translated">安全工具(土匪，安全)</li><li id="738d" class="ko kp hi ix b iy kz jc la jg lb jk lc jo ld js kv kw kx ky bi translated">自动化(使用预提交挂钩)</li><li id="48c9" class="ko kp hi ix b iy kz jc la jg lb jk lc jo ld js kv kw kx ky bi translated">奖金</li></ol></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><h1 id="6707" class="ll ju hi bd jv lm ln lo jz lp lq lr kd ls lt lu kg lv lw lx kj ly lz ma km mb bi translated">为什么？</h1><p id="44d6" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">现在你可能会想:为什么我需要所有这些工具？而最重要的答案是:节省时间。手动完成所有这些检查需要很多时间(除非你是完美的程序员)，你可以通过自动化来节省时间。此外，编写错误代码会导致在调试和修复错误上浪费时间。在开始之前，让我们先回顾一下我将讨论的不同类别的工具。</p><p id="5548" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">代码风格和格式<br/> </em>毫无疑问，任何开发者都可以享受一个可读的、格式良好的、统一的代码库。在Python生态系统中，有这样一个概念，即编写代码时充分利用Python的习惯用法(也称为编写“Python”代码)，最好符合Python 的<a class="ae iu" href="https://www.python.org/dev/peps/pep-0020/" rel="noopener ugc nofollow" target="_blank">禅和</a><a class="ae iu" href="https://pep8.org" rel="noopener ugc nofollow" target="_blank"> PEP 8标准</a>。对于任何开发人员来说，主动检查自己或他人代码的一致性都是一个相当乏味的挑战。</p><p id="a42c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">软件测试</em> <br/>作为一名开发人员，当代码库的软件测试(例如单元测试)最好在每次代码变更时自动运行时，我对任何代码的结果都更有信心。此外，Python不是一种静态类型的编程语言，这一事实在不主动检查类型和测试失败的情况下，给编写无错误代码带来了一些挑战。</p><p id="ed30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">安全</em> <br/>开发人员可以得到帮助的第三个领域是安全领域。大量使用开源软件库或组件会使应用程序容易受到使用这些库或组件所带来的任何安全威胁。如果一个开发者被告知在一个依赖的软件包中存在已知的安全漏洞，这不是很酷吗？</p><p id="3a18" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我们将要讨论的工具集中在上面描述的“代码风格和格式”、“软件测试”或“安全性”类别中的一个。我们开始吧！</p></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><h1 id="88d4" class="ll ju hi bd jv lm ln lo jz lp lq lr kd ls lt lu kg lv lw lx kj ly lz ma km mb bi translated">工具</h1><p id="d4f8" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><em class="mf">项目配置<br/> </em>当然，需要进行一些配置来调整所有工具并加入或排除一些参数。每个工具都有自己的一套配置参数和配置格式，但是有一种趋势是工具都符合<code class="du mg mh mi mj b">pyproject.toml</code>格式(更多信息见<a class="ae iu" href="https://www.python.org/dev/peps/pep-0518/" rel="noopener ugc nofollow" target="_blank"> PEP 518 </a>)。对于下面的每个工具，我将尽可能在<code class="du mg mh mi mj b">pyproject.toml</code>部分提到相关的配置参数。为了方便起见，我把最后一个<code class="du mg mh mi mj b">pyproject.toml</code>放在了Github的仓库里。</p><p id="38f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">*注意:下面例子中的‘app’文件夹指的是我的项目文件夹。</em></p><h1 id="f709" class="ll ju hi bd jv lm mk lo jz lp ml lr kd ls mm lu kg lv mn lx kj ly mo ma km mb bi translated">代码样式和格式</h1><p id="9d50" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">对于代码风格和格式，我使用的是isort、Flake8、Bugbear、Black和Mypy。我将在下面详细讨论它们。</p><h2 id="f887" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">伊索特</h2><p id="faf8" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/PyCQA/isort" rel="noopener ugc nofollow" target="_blank"> Github库</a></p><p id="618f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">它有什么作用？<br/> </em>它将你的<code class="du mg mh mi mj b">import</code>语句从这里排序:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="7e6a" class="jt ju hi mj b fi mx my l mz na">from pytz import timezone<br/>from app.const import NAME<br/><br/>from datetime import datetime as dt</span></pre><p id="fbc7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对此:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="65b4" class="jt ju hi mj b fi mx my l mz na"># Standard library imports<br/>from datetime import datetime as dt<br/><br/># Third party imports<br/>from pytz import timezone<br/><br/># Local application imports<br/>from app.const import NAME</span></pre><p id="aa74" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很漂亮吧？</p><p id="bbee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="688a" class="jt ju hi mj b fi mx my l mz na">[tool.isort]<br/>multi_line_output = 3<br/>include_trailing_comma = true<br/>force_grid_wrap = 0<br/>use_parentheses = true<br/>line_length = 88<br/>skip = []<br/>import_heading_stdlib = 'Standard library imports'<br/>import_heading_thirdparty = 'Third party imports'<br/>import_heading_firstparty = 'Local application imports'<br/>import_heading_localfolder = 'Local folder imports'<br/>known_first_party = ['app']</span></pre><p id="460a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="20ee" class="jt ju hi mj b fi mx my l mz na">pip install isort<br/>isort .</span></pre><h2 id="26b7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">薄片8</h2><p id="9705" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/PyCQA/flake8" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></p><p id="7e68" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它是做什么的？<br/>  Flake8是围绕<a class="ae iu" href="https://github.com/PyCQA/pyflakes" rel="noopener ugc nofollow" target="_blank"> pyflakes </a>、<a class="ae iu" href="https://github.com/PyCQA/pycodestyle" rel="noopener ugc nofollow" target="_blank"> pycodestyle </a>和Ned Batchelder的<a class="ae iu" href="https://github.com/PyCQA/mccabe" rel="noopener ugc nofollow" target="_blank"> McCabe脚本</a>的包装器，本质上检查是否符合<a class="ae iu" href="https://pep8.org" rel="noopener ugc nofollow" target="_blank"> PEP 8 </a>代码风格标准。<br/>如果检测到任何不符合项，工具将输出带有错误代码的警告。以下是它输出的一些错误示例:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="8c66" class="jt ju hi mj b fi mx my l mz na">app/main.py:14:7: E111 indentation is not a multiple of four<br/>app/main.py:14:7: E117 over-indented<br/>app/main.py:15:7: E111 indentation is not a multiple of four<br/>app/const.py:1:20: W292 no newline at end of file</span></pre><p id="1736" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:flake8有几个扩展其功能的插件(包括这里提到的一些其他工具，例如“flake8-isort”)，但是我更喜欢将这些工具的执行分开，这样配置和执行更容易。</p><p id="e221" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置<br/> </em> Flake8还不支持<code class="du mg mh mi mj b">pyproject.toml</code>配置<a class="ae iu" href="https://gitlab.com/pycqa/flake8/-/issues/428" rel="noopener ugc nofollow" target="_blank"/>，所以我们需要在项目根目录下创建一个<code class="du mg mh mi mj b">.flake8</code>配置文件:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="4e06" class="jt ju hi mj b fi mx my l mz na">[flake8]<br/>ignore = E203, E266, E501, W503<br/>max-line-length = 88<br/>max-complexity = 18<br/>select = C,E,F,W,B<br/>filename = app/*.py</span></pre><p id="62b2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注:<code class="du mg mh mi mj b">B</code>选择是针对Bugbear错误代码的。</p><p id="06e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="8435" class="jt ju hi mj b fi mx my l mz na">pip install flake8<br/>flake8 &lt;project_folder_name&gt;</span></pre><h2 id="a5b5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">使人过分害怕的东西</h2><p id="e676" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/PyCQA/flake8-bugbear" rel="noopener ugc nofollow" target="_blank"> Github库</a></p><p id="1307" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">它有什么作用？Bugbear是flake8的一个插件，包含一些不适合pyflakes或pycodestyle的错误和警告规则。这方面的一个例子是规则B009:</em></p><blockquote class="nb nc nd"><p id="7a0a" class="iv iw mf ix b iy iz ja jb jc jd je jf ne jh ji jj nf jl jm jn ng jp jq jr js hb bi translated">不要调用<code class="du mg mh mi mj b">getattr(x, 'attr')</code>，而是使用正常的属性访问:<code class="du mg mh mi mj b">x.attr</code>。对于不存在的属性，缺省为<code class="du mg mh mi mj b">getattr</code>将导致<code class="du mg mh mi mj b">AttributeError</code>被引发。如果您事先知道属性名，使用<code class="du mg mh mi mj b">getattr</code>没有额外的安全性。</p></blockquote><p id="a495" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置<br/> </em>只需在flake8的选择配置参数中添加<code class="du mg mh mi mj b">B</code>即可。</p><p id="fc6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="20d3" class="jt ju hi mj b fi mx my l mz na">pip install flake8-bugbear<br/>flake8 &lt;project_folder_name&gt;</span></pre><h2 id="0040" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">黑色</h2><p id="3c61" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/psf/black" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></p><p id="0cd6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它是做什么的？<br/>  Black是一个(牛逼的)坚持PEP8(尽可能)的固执己见的代码格式化程序。</p><p id="8096" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它变成了这样:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="0d94" class="jt ju hi mj b fi mx my l mz na">def print_hi(name):<br/> date_time = tz.localize(<br/>     dt.now())<br/> print(<br/>     f"Hi, {name} it is currently {date_time}"<br/> )<br/>def   print_hello(<br/>        name<br/>):<br/>  print(<br/>   f"Hello, {name} "<br/>   f"how are you?"<br/>  )</span></pre><p id="dd5f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">变成这样:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="b486" class="jt ju hi mj b fi mx my l mz na">def print_hi(name):<br/>    date_time = tz.localize(dt.now())<br/>    print(f"Hi, {name} it is currently {date_time}")<br/><br/><br/>def print_hello(name):<br/>    print(f"Hello, {name} " f"how are you?")</span></pre><p id="cf16" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">✨魔法！✨</p><p id="e66d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="353a" class="jt ju hi mj b fi mx my l mz na">[tool.black]<br/>line-length = 88<br/>target-version = ['py38']<br/>include = '\.pyi?$'<br/>exclude = '''<br/>/(<br/>    \.eggs          # exclude a few common directories in the<br/>  | \.git           # root of the project<br/>  | \.hg<br/>  | \.mypy_cache<br/>  | \.tox<br/>  | \.venv<br/>  | _build<br/>  | buck-out<br/>  | build<br/>  | dist<br/>  | migrations<br/><br/>  # The following are specific to Black, you probably don't want those.<br/>  | blib2to3<br/>  | tests/data<br/>)/<br/>'''</span></pre><p id="5b33" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="56d9" class="jt ju hi mj b fi mx my l mz na">pip install black<br/>black &lt;project_folder_name&gt;</span></pre><h2 id="6873" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Mypy</h2><p id="b3a7" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/python/mypy" rel="noopener ugc nofollow" target="_blank"> Github库</a></p><p id="6e91" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它是做什么的？使用Mypy，你可以将类型hinst ( <a class="ae iu" href="https://www.python.org/dev/peps/pep-0484/" rel="noopener ugc nofollow" target="_blank"> PEP 484 </a>)添加到你的代码中，并检查你的代码中的类型错误。</p><p id="69e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有趣的事实:Mypy的创造者Jukka Lehtosalo在Dropbox与Python(吉多·范·罗苏姆)的创造者合作开发Mypy。更多信息<a class="ae iu" href="https://dropbox.tech/application/our-journey-to-type-checking-4-million-lines-of-python" rel="noopener ugc nofollow" target="_blank">在这里</a>。</p><p id="bdad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种类型错误的例子有:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="5397" class="jt ju hi mj b fi mx my l mz na">app/main.py:15: error: Missing return statement<br/>app/main.py:25: error: Argument 1 to "print_hi" has incompatible type "str"; expected "List[str]"<br/>Found 2 errors in 1 file (checked 3 source files)</span></pre><p id="c9ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置</em></p><p id="cd89" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Mypy还不支持<code class="du mg mh mi mj b">pyproject.toml</code><a class="ae iu" href="https://github.com/python/mypy/issues/5205" rel="noopener ugc nofollow" target="_blank"/>，所以我们必须在项目根目录下创建一个<code class="du mg mh mi mj b">mypy.ini</code>文件，其中包含:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="46e2" class="jt ju hi mj b fi mx my l mz na">[mypy]<br/>python_version=3.8<br/>platform=linux<br/><br/>files=app/<br/>ignore_missing_imports=true</span></pre><p id="ea0f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="1d18" class="jt ju hi mj b fi mx my l mz na">pip install mypy<br/>mypy &lt;project_folder_name&gt;</span></pre><h1 id="9f5e" class="ll ju hi bd jv lm mk lo jz lp ml lr kd ls mm lu kg lv mn lx kj ly mo ma km mb bi translated">软件测试</h1><p id="8f6d" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">对于软件测试，我使用Pytest和coverage.py。</p><h2 id="1b82" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Pytest</h2><p id="70ef" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/pytest-dev/pytest" rel="noopener ugc nofollow" target="_blank"> Github库</a></p><p id="cc20" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">它有什么作用？<br/> </em> Pytest是一个软件测试Python代码的框架。我最喜欢它的一个特性是，它允许你创建可重用的测试代码片段(<a class="ae iu" href="https://docs.pytest.org/en/stable/fixture.html" rel="noopener ugc nofollow" target="_blank"> fixtures </a>),这些代码可以被组合在一个测试中。</p><p id="ee31" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置<br/> </em> Pytest支持<code class="du mg mh mi mj b">pyproject.toml</code>配置:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="7614" class="jt ju hi mj b fi mx my l mz na">[tool.pytest.ini_options]<br/>minversion = "6.0"<br/>addopts = "-ra"<br/>testpaths = [<br/>    "app",<br/>]<br/>python_files = "*_test.py"<br/>junit_family = "legacy"</span></pre><p id="c9b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">注意:任何文件名以</em> <code class="du mg mh mi mj b"><em class="mf">_test.py</em></code> <em class="mf">结尾的文件在运行pytest时都会被自动测试。</em></p><p id="2239" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="0cf1" class="jt ju hi mj b fi mx my l mz na">pip install pytest<br/>pytest &lt;project_folder_name&gt;</span></pre><p id="4dd4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">成功测试的输出:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="d948" class="jt ju hi mj b fi mx my l mz na">➜ pytest app -ra<br/>===================== test session starts ========================<br/>platform darwin -- Python 3.8.5, ...,  pluggy-0.13.1<br/>rootdir: /, configfile: pyproject.toml, testpaths: app<br/>collected 1 item</span><span id="df9a" class="jt ju hi mj b fi nh my l mz na">app/main_test.py .                                          [100%]</span><span id="55b6" class="jt ju hi mj b fi nh my l mz na">===================== 1 passed in 0.05s ==========================</span></pre><p id="f512" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">失败测试的输出:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="00a9" class="jt ju hi mj b fi mx my l mz na">pytest app -ra<br/>===================== test session starts ========================<br/>platform darwin -- Python 3.8.5, ..., pluggy-0.13.1<br/>rootdir: /, configfile: pyproject.toml, testpaths: app<br/>collected 1 item</span><span id="3d87" class="jt ju hi mj b fi nh my l mz na">app/main_test.py F                                                                                                   [100%]</span><span id="bd71" class="jt ju hi mj b fi nh my l mz na">=========================== FAILURES ==============================<br/>________________________ test_print_hi ____________________________</span><span id="5cb1" class="jt ju hi mj b fi nh my l mz na">capsys = &lt;_pytest.capture.CaptureFixture object at 0x1056d5fa0&gt;</span><span id="1e4a" class="jt ju hi mj b fi nh my l mz na">def test_print_hi(capsys):<br/>        from app.main import print_hi</span><span id="e01d" class="jt ju hi mj b fi nh my l mz na"># Happy flow<br/>        name = "Chris"<br/>        print_hi(name)<br/>        captured = capsys.readouterr()<br/>        assert captured.out.startswith(f"Hi, {name} it is currently")</span><span id="7bad" class="jt ju hi mj b fi nh my l mz na"># Invalid type<br/>        name = 1<br/>&gt;       print_hi(name)</span><span id="369c" class="jt ju hi mj b fi nh my l mz na">app/main_test.py:16:<br/>_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _</span><span id="3bc2" class="jt ju hi mj b fi nh my l mz na">name = 1</span><span id="f5ca" class="jt ju hi mj b fi nh my l mz na">def print_hi(name: str) -&gt; str:<br/>        if not isinstance(name, str):<br/>&gt;           raise TypeError("name is of invalid type")<br/>E           TypeError: name is of invalid type</span><span id="23f0" class="jt ju hi mj b fi nh my l mz na">app/main.py:17: TypeError<br/>===================== short test summary info =====================<br/>FAILED app/main_test.py::test_print_hi - TypeError: name is of invalid type<br/>======================= 1 failed in 0.07s =========================</span></pre><h2 id="ada4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Coverage.py</h2><p id="67ae" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/nedbat/coveragepy" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></p><p id="6f21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它是做什么的？使用coverage.py您可以测量代码执行的百分比，例如在运行pytest时。这些度量给你一个指示，你的代码有多少被软件测试覆盖。当然，覆盖率并不能说明软件测试的质量。</p><p id="1279" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="7078" class="jt ju hi mj b fi mx my l mz na">[tool.coverage.run]<br/>branch = true<br/>command_line = '-m pytest'<br/>source = ['app/']<br/><br/>[tool.coverage.report]<br/>precision = 2<br/>skip_covered = true<br/>fail_under = 90</span></pre><p id="4f48" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="7bf7" class="jt ju hi mj b fi mx my l mz na">pip install coverage[toml]<br/>coverage run<br/>coverage report -m</span></pre><p id="a5ac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">覆盖率报告的输出示例:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="21b3" class="jt ju hi mj b fi mx my l mz na">coverage report -m<br/>Name          Stmts   Miss Branch BrPart     Cover   Missing<br/>------------------------------------------------------------<br/>app/main.py      14      1      6      1    90.00%   24-&gt;25, 25<br/>------------------------------------------------------------<br/>TOTAL            28      1      6      1    94.12%</span><span id="e286" class="jt ju hi mj b fi nh my l mz na">3 files skipped due to complete coverage.</span></pre><h1 id="fd21" class="ll ju hi bd jv lm mk lo jz lp ml lr kd ls mm lu kg lv mn lx kj ly mo ma km mb bi translated">安全性</h1><p id="1e65" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">为了检查安全漏洞，我使用了Bandit和Safety。</p><h2 id="fcb6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">强盗</h2><p id="2d3e" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/PyCQA/bandit" rel="noopener ugc nofollow" target="_blank"> Github库</a></p><p id="48ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它是做什么的？<br/> 在您的代码上运行Bandit可以让您识别已知的安全问题(例如，使用<code class="du mg mh mi mj b">assert</code>语句作为检查，在编译成字节码时会被删除)。所有检查的清单可以在这里找到<a class="ae iu" href="https://bandit.readthedocs.io/en/latest/plugins/index.html#complete-test-plugin-listing" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="e069" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置</em></p><p id="fb62" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Bandit还不支持<code class="du mg mh mi mj b">pyproject.toml</code><a class="ae iu" href="https://github.com/PyCQA/bandit/issues/550" rel="noopener ugc nofollow" target="_blank"/>，所以要配置它，必须在项目文件夹根目录下创建一个<code class="du mg mh mi mj b">.bandit</code>文件。</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="c5a9" class="jt ju hi mj b fi mx my l mz na">[bandit]<br/>targets = app/<br/>recursive = true<br/>skips = B101</span></pre><p id="d5aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">注意:B101测试被跳过，因为它(也)触发</em> <code class="du mg mh mi mj b"><em class="mf">_test.py</em></code> <em class="mf">文件中使用的断言语句。当断言在测试文件中时，有一个</em> <a class="ae iu" href="https://github.com/PyCQA/bandit/issues/346" rel="noopener ugc nofollow" target="_blank"> <em class="mf">请求</em> </a> <em class="mf">忽略B101。</em></p><p id="86e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="6bee" class="jt ju hi mj b fi mx my l mz na">pip install bandit<br/>bandit --ini .bandit -r</span></pre><p id="4950" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">示例输出:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="2134" class="jt ju hi mj b fi mx my l mz na">bandit --ini .bandit -r<br/>[main] INFO Using ini file for skipped tests<br/>[main] INFO Using ini file for selected targets<br/>[main] INFO profile include tests: None<br/>[main] INFO profile exclude tests: None<br/>[main] INFO cli include tests: None<br/>[main] INFO cli exclude tests: B101<br/>[main] INFO running on Python 3.8.5<br/>Run started:2020-11-29 15:27:27.049118</span><span id="7e56" class="jt ju hi mj b fi nh my l mz na">Test results:<br/> No issues identified.</span><span id="e8a2" class="jt ju hi mj b fi nh my l mz na">Code scanned:<br/> Total lines of code: 28<br/> Total lines skipped (#nosec): 0</span><span id="81ae" class="jt ju hi mj b fi nh my l mz na">Run metrics:<br/> Total issues (by severity):<br/>  Undefined: 0.0<br/>  Low: 0.0<br/>  Medium: 0.0<br/>  High: 0.0<br/> Total issues (by confidence):<br/>  Undefined: 0.0<br/>  Low: 0.0<br/>  Medium: 0.0<br/>  High: 0.0<br/>Files skipped (0):</span></pre><h2 id="0b97" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">安全</h2><p id="569d" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/pyupio/safety" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></p><p id="80c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它是做什么的？<br/> 它扫描你已安装的依赖项，寻找已知的安全漏洞。默认情况下，它使用带有已知漏洞的<code class="du mg mh mi mj b">safety-db</code>数据库。</p><p id="8f73" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">配置<br/> </em>运行安全不需要详细配置。</p><p id="16a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装运行？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="e9cc" class="jt ju hi mj b fi mx my l mz na">pip install safety<br/>safety check</span></pre><p id="9656" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">示例输出:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="d8ea" class="jt ju hi mj b fi mx my l mz na">safety check<br/>+==================================================================+<br/>| REPORT                                                                       |<br/>| checked 50 packages, using default DB                                        |<br/>+==================================================================+<br/>| No known security vulnerabilities found.                                     |<br/>+==================================================================+</span></pre></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><h1 id="c114" class="ll ju hi bd jv lm ln lo jz lp lq lr kd ls lt lu kg lv lw lx kj ly lz ma km mb bi translated">自动化</h1><p id="e860" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">为了有效地使用上述工具，我使用<a class="ae iu" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks" rel="noopener ugc nofollow" target="_blank"> Git预挂钩</a>来自动触发使用<code class="du mg mh mi mj b">pre-commit</code>的工具。</p><h2 id="5250" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">预提交</h2><p id="2b61" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><a class="ae iu" href="https://github.com/pre-commit/pre-commit" rel="noopener ugc nofollow" target="_blank"> Github库</a></p><p id="16a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">它有什么作用？<br/> </em>这是一个用于预提交钩子的(多语言)包管理器。在<code class="du mg mh mi mj b">pre-commit</code>配置中定义的脚本将在执行<code class="du mg mh mi mj b">git commit</code>或<code class="du mg mh mi mj b">git push</code>时触发。<br/>预提交允许你配置脚本从本地包运行，或者直接从它们的仓库运行钩子。</p><p id="3471" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">使用本地包<br/> </em>的配置为了将所有工具集成到<code class="du mg mh mi mj b">commit</code>或<code class="du mg mh mi mj b">push</code>钩子中，我们将通过创建<code class="du mg mh mi mj b">.pre-commit-config.yaml</code>为<code class="du mg mh mi mj b">pre-commit</code>构建一个配置文件。</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="7f0e" class="jt ju hi mj b fi mx my l mz na">repos:<br/>  - repo: local<br/>    hooks:<br/>      - id: isort<br/>        name: isort<br/>        stages: [commit]<br/>        language: system<br/>        entry: isort<br/>        types: [python]<br/>      - id: black<br/>        name: black<br/>        stages: [commit]<br/>        language: system<br/>        entry: black<br/>        types: [python]<br/>      - id: flake8<br/>        name: flake8<br/>        stages: [commit]<br/>        language: system<br/>        entry: flake8<br/>        types: [python]<br/>      - id: mypy<br/>        name: mypy<br/>        stages: [commit]<br/>        language: system<br/>        entry: mypy<br/>        types: [python]<br/>        pass_filenames: false<br/>      - id: bandit<br/>        name: bandit<br/>        stages: [commit]<br/>        language: system<br/>        entry: bandit --ini .bandit -r<br/>        types: [python]<br/>        pass_filenames: false<br/>      - id: pytest<br/>        name: pytest<br/>        stages: [commit]<br/>        language: system<br/>        entry: pytest app -ra<br/>        types: [python]<br/>        pass_filenames: false<br/>      - id: safety<br/>        name: safety<br/>        stages: [commit]<br/>        language: system<br/>        entry: safety check<br/>        types: [python]<br/>        pass_filenames: false<br/>      - id: coverage<br/>        name: coverage<br/>        stages: [push]<br/>        language: system<br/>        entry: coverage run<br/>        types: [python]<br/>        pass_filenames: false</span></pre><p id="7be1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">注意:coverage.py会在每一个</em> <code class="du mg mh mi mj b"><em class="mf">git push</em></code> <em class="mf">之前执行，其余的在一个</em> <code class="du mg mh mi mj b"><em class="mf">git commit</em></code> <em class="mf">之前执行。</em></p><p id="0e9b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">使用非本地存储库的配置<br/> </em>你也可以利用在线存储库来获取预提交钩子。除了pytest &amp; coverage.py之外的所有包都提供了可以使用的在线存储库。</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="6123" class="jt ju hi mj b fi mx my l mz na">repos:<br/>-   repo: https://github.com/timothycrosley/isort<br/>    rev: 5.6.4<br/>    hooks:<br/>    -   id: isort<br/>-   repo: https://github.com/psf/black<br/>    rev: 20.8b1<br/>    hooks:<br/>    -   id: black<br/>-   repo: https://gitlab.com/pycqa/flake8<br/>    rev: 3.8.4<br/>    hooks:<br/>    -   id: flake8<br/>        additional_dependencies: [flake8-bugbear]<br/>-   repo: https://github.com/pre-commit/mirrors-mypy<br/>    rev: v0.790<br/>    hooks:<br/>    -   id: mypy<br/>-   repo: https://github.com/Lucas-C/pre-commit-hooks-bandit<br/>    rev: v1.0.4<br/>    hooks:<br/>    -   id: python-bandit-vulnerability-check<br/>-   repo: local<br/>    hooks:<br/>    -   id: pytest<br/>        name: pytest<br/>        stages: [commit]<br/>        language: system<br/>        entry: pytest -v --showlocals<br/>        types: [python]<br/>        pass_filenames: false<br/>    -   id: coverage<br/>        name: coverage<br/>        stages: [push]<br/>        language: system<br/>        entry: coverage run<br/>        types: [python]<br/>        pass_filenames: false<br/>-   repo: https://github.com/Lucas-C/pre-commit-hooks-safety<br/>    rev: v1.1.3<br/>    hooks:<br/>    -   id: python-safety-dependencies-check</span></pre><p id="8a15" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">如何安装？</em></p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="21f7" class="jt ju hi mj b fi mx my l mz na">pip install pre-commit<br/>pre-commit install<br/>pre-commit install --hook-type pre-push</span></pre><p id="70be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">注意:第一条命令安装</em><code class="du mg mh mi mj b"><em class="mf">pre-commit</em></code><em class="mf">；第二个命令安装git预提交挂钩&amp;第三个命令安装配置文件中定义的git预推送挂钩。</em></p><p id="5e17" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">怎么跑？<br/> </em>安装预提交和预推送挂钩后，工具将在每次提交和推送至git存储库时被触发。<br/>您可以通过执行以下命令手动触发预提交挂钩(例如用于测试目的):</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="1d12" class="jt ju hi mj b fi mx my l mz na">pre-commit run --all-files</span></pre><p id="3334" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">示例输出:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="5044" class="jt ju hi mj b fi mx my l mz na">➜ pre-commit run --all-files<br/>isort.........................................................Passed<br/>black.........................................................Passed<br/>flake8........................................................Passed<br/>mypy..........................................................Passed<br/>bandit........................................................Passed<br/>pytest........................................................Passed<br/>safety........................................................Passed</span></pre><p id="1f54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当<code class="du mg mh mi mj b">isort</code>或<code class="du mg mh mi mj b">black</code>在林挺时修改文件时，会出现一个错误:</p><pre class="mp mq mr ms fd mt mj mu mv aw mw bi"><span id="59a2" class="jt ju hi mj b fi mx my l mz na">⇣5% ➜ pre-commit run --all-files<br/>isort....................................................................Failed<br/>- hook id: isort<br/>- files were modified by this hook</span><span id="a34e" class="jt ju hi mj b fi nh my l mz na">Fixing /Users/chris/Code/C01/developer-tools/app/main.py</span><span id="6d2b" class="jt ju hi mj b fi nh my l mz na">black.........................................................Passed<br/>flake8........................................................Passed<br/>mypy..........................................................Passed<br/>bandit........................................................Passed<br/>pytest........................................................Failed<br/>- hook id: pytest<br/>- files were modified by this hook</span><span id="a169" class="jt ju hi mj b fi nh my l mz na">====================== test session starts =========================<br/>platform darwin -- Python 3.8.5, ... -- /bin/python<br/>cachedir: .pytest_cache<br/>rootdir: /, configfile: pyproject.toml, testpaths: app<br/>collected 1 item</span><span id="3fa6" class="jt ju hi mj b fi nh my l mz na">app/main_test.py::test_print_hi PASSED                                   [100%]</span><span id="abf6" class="jt ju hi mj b fi nh my l mz na">====================== 1 passed in 0.03s ===========================</span><span id="f40a" class="jt ju hi mj b fi nh my l mz na">safety........................................................Passed</span></pre><p id="f10a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">重新执行钩子将清除失败(在之前的运行中修改了文件)。</p><p id="8b66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">注意:如果您想在提交或推送时跳过运行预提交钩子，您可以通过将</em> <code class="du mg mh mi mj b"><em class="mf">--no-verify</em></code> <em class="mf">添加到</em> <code class="du mg mh mi mj b"><em class="mf">git commit</em></code> <em class="mf">或</em> <code class="du mg mh mi mj b"><em class="mf">git push</em></code> <em class="mf">命令中来实现。</em></p></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><h1 id="d515" class="ll ju hi bd jv lm ln lo jz lp lq lr kd ls lt lu kg lv lw lx kj ly lz ma km mb bi translated">奖金</h1><p id="c8b4" class="pw-post-body-paragraph iv iw hi ix b iy kq ja jb jc kr je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">为了让你快速入门，我已经编写了这个 Python框架，包括上面描述的所有工具。您可以通过克隆存储库并遵循<code class="du mg mh mi mj b">README.md</code>来测试它。祝你检查的愉快！</p><p id="6076" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你已经到达终点了！如果你喜欢这篇文章，我会很感激鼓掌👏。</p><p id="bce5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你知道任何其他的工具会是一个很好的补充或认为这篇文章可以改进吗？也请让我知道！</p></div></div>    
</body>
</html>