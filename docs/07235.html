<html>
<head>
<title>Linear Algebra from Strang.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">斯特朗的线性代数。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-algebra-from-strang-3394007ec79c?source=collection_archive---------3-----------------------#2020-06-18">https://medium.com/analytics-vidhya/linear-algebra-from-strang-3394007ec79c?source=collection_archive---------3-----------------------#2020-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="b111" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">python中的投影矩阵。</h2></div><p id="f34b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">斯特朗教授的《线性代数导论》是一次进入线性代数领域的不可思议的旅程。在接下来的几篇文章中，我的目标是从Python的角度阐明其中的一些部分。尽情享受吧！</p><p id="e811" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我想研究一类特殊的矩阵，<em class="jt">投影矩阵。</em>首先看一些相当直观的投影矩阵，它们将3D中的线投影到定义它们的标准正交基上。其次，我们将看看如何将任意向量投影到直线上。然后，我们将总结如何定义任意平面的投影矩阵。</p><p id="c6c1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一路上，我们将使用vanilla numpy和plotly将这些想法翻译成python语言。</p><p id="6370" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">开始前请注意。在阅读本文之前，你应该对矩阵的基本运算有所了解，例如内积和外积。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h2 id="e017" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">投影矩阵</h2><p id="3d7a" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">给定某个n维向量，v = (a1，a2，…，an)我们可以考虑这个向量到Rn中各个子空间的投影。你猜对了，我们用投影矩阵来描述这些投影。</p><p id="109e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们把自己限制在三维空间。然后我们可以描述投影矩阵，它们分别将向量v投影到z轴和xy平面上。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lb"><img src="../Images/c5a511072d82d1b66bbd455ce45873e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2dXeeTEhf0cqakPVHvqAg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">投影矩阵。当作用于三维列向量时，它们分别挑选出z和xy平面中的分量。</figcaption></figure><p id="eaa1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们有一个向量<strong class="iz hj"> v </strong>，那么我们可以像这样把这个矩阵投影到z轴上</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lr"><img src="../Images/a45220f25ea70e0fc034084945948e14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dppg7tQ14xe6KjpSJ6gSCA.png"/></div></div></figure><p id="5d16" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，投影矩阵挑选出了<strong class="iz hj"> v </strong>的分量，该分量指向我们希望投影到的平面/直线。斯特朗对投影矩阵的目的描述如下。</p><blockquote class="ls lt lu"><p id="a49d" class="ix iy jt iz b ja jb ij jc jd je im jf lv jh ji jj lw jl jm jn lx jp jq jr js hb bi translated">目标是找到每个子空间中的部分P，以及产生该部分p=Pv的投影矩阵P。—奇怪</p></blockquote><h2 id="d423" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">Python中的投影矩阵</h2><p id="cd73" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">让我们在一些python脚本的帮助下，想象一下这些特殊的三维投影矩阵在做什么。我们可以将投影矩阵定义如下…</p><pre class="lc ld le lf fd ly lz ma mb aw mc bi"><span id="e7e7" class="kb kc hi lz b fi md me l mf mg">import numpy as np </span><span id="3cf2" class="kb kc hi lz b fi mh me l mf mg">P_z = np.matrix([[0, 0, 0], [0, 0, 0], [0, 0, 1]])<br/>P_xy = np.matrix([[1, 0, 0], [0, 1, 0], [0, 0, 0]]) </span></pre><p id="074a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在可以使用这些投影矩阵将任意一个定义在同一基上的向量分别投影到z轴和xy平面上。</p><pre class="lc ld le lf fd ly lz ma mb aw mc bi"><span id="f512" class="kb kc hi lz b fi md me l mf mg">b = np.matrix([2,3,4])<br/>p_xy = P_xy*b.T<br/>p_z = P_z*b.T</span></pre><p id="dc1a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这显示了投影是如何找到的。我们简单地用投影矩阵和我们想要投影的向量计算内积。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mi"><img src="../Images/841c905b8bc86d216c8e8ddf1567668c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-LgZJTkh5GtXoiW-Xshbg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">图中显示了将向量<strong class="bd kd"> b </strong>(蓝色)分别投影到x轴(绿色)和xy平面(红色)的结果。</figcaption></figure><h2 id="b1ad" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">投影到直线上</h2><p id="b55e" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">上面的例子相对简单，因为我们选择投影到标准正交基向量上，我们的向量<strong class="iz hj"> v </strong>就是在这些向量中定义的。如果我们想投影到任意一条线上呢？</p><blockquote class="ls lt lu"><p id="33f0" class="ix iy jt iz b ja jb ij jc jd je im jf lv jh ji jj lw jl jm jn lx jp jq jr js hb bi translated">投影的关键是正交性:从b到p的直线垂直于向量a</p></blockquote><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mj"><img src="../Images/5def0a4906a1c316422d95483a419925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*DjjQT1icIzm-SAluJy2kwA.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">图片取自《线性代数导论—陌生》</figcaption></figure><p id="f92c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有了这一点几何知识，我们将能够推导出任意直线<strong class="iz hj">和</strong>的投影矩阵。也就是说，我们将找到一个投影矩阵P，它将任何一条线投影到<strong class="iz hj"> a </strong>上。我们可以把它分成几个步骤。</p><p id="c92d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们注意到<strong class="iz hj"> b </strong>到<strong class="iz hj"> a </strong>的投影可以被认为是<strong class="iz hj">a</strong>的某个标量倍数</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mk"><img src="../Images/938b45db0bf18a07095f174ed5fe8976.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*rOakjiwP8ve9RH5cwexfpQ.png"/></div></figure><p id="f9bb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其次，我们注意到“误差”(从<strong class="iz hj"> b </strong>到<strong class="iz hj"> a </strong> ) <strong class="iz hj"> b </strong>的垂直距离)可以用矢量<strong class="iz hj"> b </strong>及其到<strong class="iz hj"> a </strong>的投影来表示。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mk"><img src="../Images/4ad43bfc0af5bc5354f29fb2853fa28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*hCuQTRUQn1VRCfLv--1g4w.png"/></div></figure><p id="62a4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的等式可以用<strong class="iz hj"> b </strong>和一些标量时间<strong class="iz hj"> a </strong>来表示。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es ml"><img src="../Images/07967cdbb0d777aae3a4b9e5bd80d2c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*ip40HwCNa0w_DBXq0IpYaw.png"/></div></figure><p id="6e63" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">抓住你了！这里唯一的未知数是我们的标量x，回想一下误差垂直于a的事实，我们可以取内积，把结果设为零。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mm"><img src="../Images/fe232e6a78bf5d0fe0f55d5b7d7506d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*lje8Bimv0Ab05AiGMeL1dg.png"/></div></figure><p id="7378" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">重新排列我们可以解出未知的标量。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mn"><img src="../Images/11fe0a2507f3a9c58dca27aeadf3f213.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*rX6opmy58_NwlrwfmR99rg.png"/></div></figure><p id="6d86" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就允许我们用<strong class="iz hj"> b </strong>和<strong class="iz hj"> a </strong>来表达<strong class="iz hj"> p </strong>。这真是太棒了。它告诉我们，我们可以取R3上的任何其他向量，并使用这个相同的投影矩阵来计算到a上的投影。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mo"><img src="../Images/11c42e6120d13d6f292b584c5c23c107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4sg1mZjZ5KKFNTKIgrSs2g.png"/></div></div></figure><h2 id="9d09" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">用python投影到一条线上</h2><p id="6186" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">将上面的内容转录成python非常简单。首先让我们写一个函数，它接受向量并返回它的投影矩阵。</p><pre class="lc ld le lf fd ly lz ma mb aw mc bi"><span id="8c05" class="kb kc hi lz b fi md me l mf mg">def gen_projection_matrix(a):<br/>    return np.outer(a, a) / a.dot(a)</span></pre><p id="5f6b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们编写一个函数，它采用一个作用于向量<strong class="iz hj"> b </strong>的投影矩阵。</p><pre class="lc ld le lf fd ly lz ma mb aw mc bi"><span id="b18b" class="kb kc hi lz b fi md me l mf mg">def calc_projection(b, P):<br/>  return P.dot(b.T)</span></pre><p id="baee" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们用两个3D向量来试试。</p><pre class="lc ld le lf fd ly lz ma mb aw mc bi"><span id="b1d3" class="kb kc hi lz b fi md me l mf mg">a = np.array([1, 2, 2])<br/>b = np.array([1, 1, 1])</span><span id="86e6" class="kb kc hi lz b fi mh me l mf mg">P = gen_projection_matrix(a)<br/>p = calc_projection(b, P)</span></pre><p id="ef2f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们把这些向量和误差一起画出来。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mi"><img src="../Images/e29362da30b8d2c2cb98296ac7439561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNW181_Yo5TK8_foQ49szA.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">描绘投影的图形(绿色)。向量<strong class="bd kd"> b </strong>(红色)到线<strong class="bd kd"> a </strong>(蓝色)上。误差是矢量<strong class="bd kd"> b </strong>到<strong class="bd kd"> a </strong>的垂直距离。</figcaption></figure><h2 id="3b09" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">投影到平面上</h2><p id="d784" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">斯特朗在本书的这一部分开始陈述如下。</p><blockquote class="ls lt lu"><p id="29ad" class="ix iy jt iz b ja jb ij jc jd je im jf lv jh ji jj lw jl jm jn lx jp jq jr js hb bi translated">从Rm中的n个向量a1，…，an开始。假设这些a是线性独立的。问题:求最接近给定向量b的组合p = x1 a1 ++ Xn an .—Strang。</p></blockquote><p id="f3d0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这听起来可能有点令人生畏。然而，我们很快就看到了几何解释是如何让一切井井有条的。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mp"><img src="../Images/2268600a2487a98af248951e91adf4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8AFEzSwB4BMwNQzOICJ9iQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">图片取自《线性代数导论—陌生》</figcaption></figure><p id="b3db" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个平面可以用横跨该平面的向量基来描述。我们让这些向量构成a的列空间，这样我们的误差项将垂直于平面上所有的向量。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mq"><img src="../Images/c7303c20419550f1f8c8d4c240ac10ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*UJQ1WG0dwXLGe2bAfLy6pA.png"/></div></figure><p id="5466" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从这一点出发，上面的推导遵循了一个非常相似的思路。导致投影<strong class="iz hj"> p </strong>到A所跨越的平面上，描述如下。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mr"><img src="../Images/15d99f4d9f206668d5dac7e400bcf2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dtd9f5xbVp3VDr9AVKKwzg.png"/></div></div></figure><h2 id="3280" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">用python投影到平面上</h2><p id="9648" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">让我们把这些方程写成python的语言。投影矩阵可以这样计算。</p><pre class="lc ld le lf fd ly lz ma mb aw mc bi"><span id="b0a6" class="kb kc hi lz b fi md me l mf mg">def calc_proj_matrix(A):<br/>    return A*np.linalg.inv(A.T*A)*A.T</span></pre><p id="7473" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">而<strong class="iz hj"> b </strong>在A所跨越的平面上的投影由下面的等式描述。</p><pre class="lc ld le lf fd ly lz ma mb aw mc bi"><span id="927c" class="kb kc hi lz b fi md me l mf mg">def calc_proj(b, A):<br/>    P = calc_proj_matrix(A)<br/>    return P*b.T</span></pre><p id="3892" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">A的列定义了平面，所以我们投影到A的列空间。计算A的列空间中向量的叉积，并让平面通过原点，这为我们提供了绘制平面所需的一切。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es ms"><img src="../Images/7f9e98dc434939a1bf874e9a26125fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*147SE8xBCYeihzhzJUPUAg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">描绘投影的图形(绿色)。将矢量<strong class="bd kd"> b </strong>(红色)投影到平面(灰色)上。误差是矢量<strong class="bd kd"> b </strong>与平面的垂直距离。</figcaption></figure><h2 id="c750" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">一句话</h2><p id="756d" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">一个简洁但完全直观的事实是，对于给定的投影矩阵，P的平方，或P的任意次方，将与P完全相同。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mt"><img src="../Images/105cd591710f2ed0f2a63489ada07383.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*D4FxyTkhRPRFMiR8ZMvVuw.png"/></div></figure><p id="2b86" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这告诉我们，如果你将一个投影应用到一个子空间多次，它在第一次投影后保持不变。一旦它被投射到子空间上，它就在子空间上！</p><p id="50a2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于所有代码签出—<a class="ae mu" href="https://github.com/mjhoshea/linear_algebra_from_strang/blob/master/projections_and_least_squares.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/mjhoshea/linear _ algebra _ from _ strang/blob/master/projections _ and _ least _ squares . ipynb</a></p></div></div>    
</body>
</html>