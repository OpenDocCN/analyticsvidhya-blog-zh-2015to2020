<html>
<head>
<title>How to automate Python code formatting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何自动化 Python 代码格式化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-automate-python-code-formatting-2509440491db?source=collection_archive---------12-----------------------#2020-11-16">https://medium.com/analytics-vidhya/how-to-automate-python-code-formatting-2509440491db?source=collection_archive---------12-----------------------#2020-11-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/af829f1837f898d1e597a0ee557cdc27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/0*ZEG2jmEOAgGzKLmc.jpeg"/></div></figure><p id="950d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你好，你好，我的工程师同事们！</p><p id="6ce5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我想讨论一下 Python 协议。</p><p id="f9e1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，我们将讨论一些格式概念和为什么我们应该遵循 Python 协议的原因。然后我将向您展示三个工具，您可以使用它们来自动化整个过程！我们将介绍布莱克、YAPF 和伊索特图书馆。听起来不错吧？让我们开始吧…</p><p id="e645" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你是一个听觉学习者，我在这里制作了一个关于这个讨论的基础和自动化工具的视频:<a class="ae jk" href="https://youtu.be/q2d5vrw1Lss" rel="noopener ugc nofollow" target="_blank">https://youtu.be/q2d5vrw1Lss</a></p><h1 id="525a" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">什么是最佳实践？</h1><p id="df33" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">仅仅是遵循 PEP 8 风格指南吗？</p><p id="0449" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">PEP 8 是代码约定，是一个随着 Python 的变化而发展的活文档(参见 https://www.python.org/dev/peps/pep-0008/<a class="ae jk" href="https://www.python.org/dev/peps/pep-0008/" rel="noopener ugc nofollow" target="_blank"/>)。</p><p id="d1fc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">或者是遵循 Python 的禅，这是一套用 Python 编码的原则(参见 https://www.python.org/dev/peps/pep-0020/<a class="ae jk" href="https://www.python.org/dev/peps/pep-0020/" rel="noopener ugc nofollow" target="_blank">)。</a></p><p id="49df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这些增强方案都没有涵盖所有内容，但是从设计上来说，它们非常灵活。</p><h1 id="6de6" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">你应该对此固执己见吗？</h1><p id="0254" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">在用 Python 编码时，应该允许你有任何个人偏好吗？只要代码按预期运行，并且有测试覆盖，是否存在正确或错误的编码方式？你认为代码的效率比可读性更重要吗？</p><p id="7181" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在 Python 成为遗产之前，有很多问题可以讨论。</p><p id="071e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我和我的团队讨论了我们编码的方式，以及在我们的代码库中出现的一些不一致。我们每个人都提出了我们喜欢看到的代码格式。</p><p id="fc6b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们都同意的一件事是一致性。从函数和类到我们编写测试的方式。只要我们意见一致，我们就可以开始关注更重要的事情。</p><h1 id="0332" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">Python 协议的优点</h1><ul class=""><li id="a1df" class="ko kp hi io b ip kj it kk ix kq jb kr jf ks jj kt ku kv kw bi translated"><em class="kx">代码评审:</em>当你评审代码时，你不希望你的注意力被吸引到风格注释上，而不是集中在正在创建的特性和测试的覆盖范围上。</li><li id="9af3" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">一致性:在代码库之间保持一致的风格会让你的代码更具可读性。我们人类的直觉是寻找模式。因此，一致的代码库将允许开发人员(尤其是代码库新手)更快地掌握代码的精髓。</li><li id="45f2" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated"><em class="kx">关注:</em>一旦你有了合适的协议，它最终会变成你的第二天性。然后，您可以开始关注真正的问题和您正在创建的功能。</li><li id="cbd5" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated"><em class="kx">美观:</em>一致的代码库好看！</li></ul><h1 id="f0d7" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">我们该怎么办？</h1><p id="425b" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">作为基础，我们使用 PEP8 和 PEP 20，如果你是林挺，无论如何你都需要符合 PEP 8。</p><p id="fb22" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">规则是不断变化的，这就是编码的方式。但是我们已经制定了一些基本规则来遵守:</p><ul class=""><li id="08fa" class="ko kp hi io b ip iq it iu ix ld jb le jf lf jj kt ku kv kw bi translated">模块文档字符串包含模块的详细描述，并在需要的地方有示例用例。</li><li id="9713" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">导入遵循 PEP 8，首先是标准模块，其次是第三方，然后是应用级模块。</li><li id="ee0c" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">来自单个依赖项的多个导入被括在括号中，并在末尾添加一个逗号。逗号是这样的，GitHub 会将任何新添加的内容识别为单行更改，而不是删除和替换。</li><li id="d462" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">全局变量全部大写，变量描述它们包含的数据，所有变量也是如此。</li><li id="0bf7" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">模块的单个异常与代码存储在同一个文件中。然而，如果有几个，我们为异常创建一个新文件并导入它们(以避免混乱)。</li><li id="4782" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">函数名应该尽可能具有描述性。</li><li id="5600" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">我们目前使用 Python 3.7，所以对于我们的函数，我们使用变量和预期返回的类型提示。</li><li id="fb13" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">具有多个变量的复杂函数可能需要一个 docstring。</li><li id="1a7b" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">具有异常处理的函数必须记录异常，并有一个处理的 docstring 解释。</li><li id="8d04" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">字典应该在每一行都有一个键和值，并以逗号结尾。</li><li id="df55" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">对于列表创建，我们试图保持 Pythonic 式的(即列表理解)，但是如果它不适合一行，那么我们使用循环。</li><li id="c156" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">对于日志记录，我们使用 f 字符串(它看起来更好一点)。</li></ul><p id="9394" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面是用代码编写的上述规则的示例:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="a729" class="lp jm hi ll b fi lq lr l ls lt"><em class="kx">"""<br/>Module docstring describing what the module does<br/>"""</em></span><span id="d0a4" class="lp jm hi ll b fi lu lr l ls lt">import logging<br/>import os<br/>import sys</span><span id="e88f" class="lp jm hi ll b fi lu lr l ls lt">import pandas as pd</span><span id="7b15" class="lp jm hi ll b fi lu lr l ls lt">from file_to_be_imported import descriptive_function_1<br/>from files_to_be_imported import (<br/> descriptive_function_2,<br/> descriptive_function_3,<br/> descriptive_function_4,<br/>)</span><span id="3d1d" class="lp jm hi ll b fi lu lr l ls lt">GLOBAL_VARIABLE = "global variable"<br/></span><span id="ec8b" class="lp jm hi ll b fi lu lr l ls lt">class SomeException(Exception):<br/> <em class="kx">"""this is an exception and needs a docstring"""<br/> </em>pass<br/></span><span id="73fe" class="lp jm hi ll b fi lu lr l ls lt">def single_variable(var: str):<br/> descriptive_function_1(var)<br/></span><span id="677a" class="lp jm hi ll b fi lu lr l ls lt">def multiple_variables(<br/> descriptive_var_1: str,<br/> descriptive_var_2: int,<br/> descriptive_var_3: bool,<br/>):<br/> try:<br/> descriptive_function_2(descriptive_var_1)<br/> descriptive_function_3(descriptive_var_2)<br/> descriptive_function_4(descriptive_var_3)<br/> except SomeException:<br/> logging.exception("Some Exception occurred")</span><span id="e523" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_dict_example = {<br/> "key1": "value1",<br/> "key2": "value2",<br/> }</span><span id="4d63" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_list_example = [x for x in range(0, 10)]</span><span id="1ba0" class="lp jm hi ll b fi lu lr l ls lt"> logging.info(f"{descriptive_dict_example} and {descriptive_list_example}")</span></pre><h1 id="62e9" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">演示时间</h1><h1 id="3094" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">自动格式化！</h1><p id="0ea4" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">作为软件工程师，一旦我们解决了一个重复出现的问题，我们就应该自动化它。我发现了两个可能对您有用的库:</p><p id="7342" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kx">黑色:</em> </strong></p><p id="d424" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是一个简单易用的模块，它的配置非常少。他们喜欢说“我们固执己见，所以你不必如此”</p><p id="04c7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://black.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">https://black.readthedocs.io/en/stable/</a></p><p id="0069" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">他们有一个在线格式化工具，你可以用它来查看黑色格式化的结果。为了和 Pipenv 一起使用，我们必须使用 pip 来安装它，由于某种原因，Pipenv 没有直接选择这个库。如果有人能告诉我为什么，我很想知道:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="4cbf" class="lp jm hi ll b fi lq lr l ls lt">pipenv run pip install black</span></pre><p id="ed90" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面我创建了一个文件，我想格式化:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="3f45" class="lp jm hi ll b fi lq lr l ls lt">import os, sysfrom file_to_be_imported import descriptive_function_1class SomeException(Exception):def single_variable(var: str):def multiple_variables(descriptive_var_1: str,descriptive_list_example = [<br/>import logging import pandas as pd <br/>from files_to_be_imported import descriptive_function_2, descriptive_function_3, descriptive_function_4 GLOBAL_VARIABLE = "global variable" <br/> """this is an exception and needs a docstring"""<br/> pass <br/> descriptive_function_1(var) <br/> descriptive_var_2: int,<br/> descriptive_var_3: bool,<br/>):<br/> x for x in range(0, 10)<br/> ] <br/> """<br/> This is a more complex function so this<br/> Params are not needed if they are descriptive enough unless they are dataframes. Dataframes should be described.<br/> SomeException: The cases for Exceptions should always be described<br/> """<br/> try:<br/> descriptive_function_2(descriptive_var_1,)<br/> descriptive_function_3(descriptive_var_2)<br/> descriptive_function_4(descriptive_var_3)<br/> except SomeException:<br/> logging.exception("Some Exception occurred") descriptive_dict_example = {"key1": "value1","key2": "value2",} logging.info(f"{descriptive_dict_example} and {descriptive_list_example}")</span></pre><p id="d5a0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">(眼尖的也会注意到文件末尾没有换行符)</p><p id="fec2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后运行黑色:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2fc4" class="lp jm hi ll b fi lq lr l ls lt">pipenv run black &lt;path to file&gt;</span></pre><p id="7472" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以在我们的例子中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="b590" class="lp jm hi ll b fi lq lr l ls lt">pipenv run black file_to_be_formatted.py</span></pre><p id="7b46" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">结果如下:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8075" class="lp jm hi ll b fi lq lr l ls lt">file_to_be_formatted.pyimport os, sys<br/>import logging</span><span id="e8b2" class="lp jm hi ll b fi lu lr l ls lt">import pandas as pd</span><span id="dd3e" class="lp jm hi ll b fi lu lr l ls lt">from file_to_be_imported import descriptive_function_1<br/>from files_to_be_imported import (<br/> descriptive_function_2,<br/> descriptive_function_3,<br/> descriptive_function_4,<br/>)<br/></span><span id="528e" class="lp jm hi ll b fi lu lr l ls lt">GLOBAL_VARIABLE = "global variable"<br/></span><span id="6bde" class="lp jm hi ll b fi lu lr l ls lt">class SomeException(Exception):<br/> <em class="kx">"""this is an exception and needs a docstring"""</em></span><span id="22b4" class="lp jm hi ll b fi lu lr l ls lt"><em class="kx"> </em>pass<br/></span><span id="6f3b" class="lp jm hi ll b fi lu lr l ls lt">def single_variable(var: str):<br/> descriptive_function_1(var)<br/></span><span id="feca" class="lp jm hi ll b fi lu lr l ls lt">def multiple_variables(<br/> descriptive_var_1: str, descriptive_var_2: int, descriptive_var_3: bool,<br/>):<br/> try:<br/> descriptive_function_2(descriptive_var_1,)<br/> descriptive_function_3(descriptive_var_2)<br/> descriptive_function_4(descriptive_var_3)<br/> except SomeException:<br/> logging.exception("Some Exception occurred")</span><span id="c030" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_dict_example = {<br/> "key1": "value1",<br/> "key2": "value2",<br/> }</span><span id="52fb" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_list_example = [x for x in range(0, 10)]</span><span id="36f8" class="lp jm hi ll b fi lu lr l ls lt"> logging.info(f"{descriptive_dict_example} and {descriptive_list_example}")</span></pre><p id="931a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里需要注意几点:</p><ul class=""><li id="e45b" class="ko kp hi io b ip iq it iu ix ld jb le jf lf jj kt ku kv kw bi translated">它还没有完全覆盖 PEP8 进口标准。尽管它用括号括起了多个导入。</li><li id="7a1e" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">它在我们的单行 docstring 之后添加了一个新行。</li><li id="440a" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">它在一行中列出了函数的所有变量。</li><li id="3de2" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">字典键值在单独的行上。</li><li id="0e57" class="ko kp hi io b ip ky it kz ix la jb lb jf lc jj kt ku kv kw bi translated">列表理解也在一行上。</li></ul><p id="1294" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">总的来说，它做得相当不错，如果你真的不想在格式化上固执己见，也许这就是你要的格式化程序。</p><p id="f697" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kx"> YAPF </em> </strong>:</p><p id="b5de" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">诞生于谷歌深处的 YAPF 是一个高度可配置的格式化程序。它使用称为旋钮的东西(如果你是英国人，这听起来很滑稽)来配置 Python 格式:</p><p id="5a12" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它们被设置在一个名为<code class="du lv lw lx ll b">.style.yapf</code>的文件中，见下文:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="4744" class="lp jm hi ll b fi lq lr l ls lt">[style]<br/>based_on_style = pep8<br/>dedent_closing_brackets = true<br/>each_dict_entry_on_separate_line = true</span></pre><p id="b2b4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">需要设置<code class="du lv lw lx ll b">based_on_style</code>:有<code class="du lv lw lx ll b">pep8</code>、<code class="du lv lw lx ll b">google</code>、<code class="du lv lw lx ll b">facebook</code>和<code class="du lv lw lx ll b">yapf</code>。然后，您可以添加旋钮来配置您想要的格式样式。您也可以单独使用<code class="du lv lw lx ll b">based_on_style</code>。在上面的例子中，我将括号设置为 dedent，并将每个字典条目放在单独的一行上。</p><p id="8ded" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，您可以使用以下命令运行 yapf:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="480d" class="lp jm hi ll b fi lq lr l ls lt">pipenv install -d yapf pipenv run yapf -i file_to_be_formatted.py</span></pre><p id="a5bc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用前面的文件，我们最终得到的结果是:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8a7b" class="lp jm hi ll b fi lq lr l ls lt">import os, sys<br/>import logging</span><span id="0eb0" class="lp jm hi ll b fi lu lr l ls lt">import pandas as pd</span><span id="e7cd" class="lp jm hi ll b fi lu lr l ls lt">from file_to_be_imported import descriptive_function_1<br/>from files_to_be_imported import descriptive_function_2, descriptive_function_3, descriptive_function_4</span><span id="10ec" class="lp jm hi ll b fi lu lr l ls lt">GLOBAL_VARIABLE = "global variable"<br/></span><span id="4cd2" class="lp jm hi ll b fi lu lr l ls lt">class SomeException(Exception):<br/> <em class="kx">"""this is an exception and needs a docstring"""<br/> </em>pass<br/></span><span id="cd99" class="lp jm hi ll b fi lu lr l ls lt">def single_variable(var: str):<br/> descriptive_function_1(var)<br/></span><span id="6c81" class="lp jm hi ll b fi lu lr l ls lt">def multiple_variables(<br/> descriptive_var_1: str,<br/> descriptive_var_2: int,<br/> descriptive_var_3: bool,<br/>):<br/> try:<br/> descriptive_function_2(descriptive_var_1, )<br/> descriptive_function_3(descriptive_var_2)<br/> descriptive_function_4(descriptive_var_3)<br/> except SomeException:<br/> logging.exception("Some Exception occurred")</span><span id="cde3" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_dict_example = {<br/> "key1": "value1",<br/> "key2": "value2",<br/> }</span><span id="b684" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_list_example = [x for x in range(0, 10)]</span><span id="589b" class="lp jm hi ll b fi lu lr l ls lt"> logging.info(f"{descriptive_dict_example} and {descriptive_list_example}")</span></pre><p id="4091" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">请注意，YAPF 和黑色一样，不包括进口商品。但是我们设法去掉了函数上的括号。字典键值都在单独的行上。总的来说，它在总体风格上坚持了 PEP8。</p><p id="3657" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您还想控制导入，那么您需要将前面两个格式化程序中的一个与 iSort 结合起来:</p><p id="9c83" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要安装和使用 iSort:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="fafa" class="lp jm hi ll b fi lq lr l ls lt">pipenv install -d isort<br/>pipenv run isort file_to_be_formatted.py</span></pre><p id="fc4b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将对您的导入和括号以及多个导入语句进行排序。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="80b7" class="lp jm hi ll b fi lq lr l ls lt">"""file_formatted_with_isort.py"""<br/>import logging<br/>import os<br/>import sys</span><span id="47d5" class="lp jm hi ll b fi lu lr l ls lt">import pandas as pd</span><span id="f53d" class="lp jm hi ll b fi lu lr l ls lt">from file_to_be_imported import descriptive_function_1<br/>from files_to_be_imported import (descriptive_function_2,<br/> descriptive_function_3,<br/> descriptive_function_4)</span></pre><p id="8ab2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，要将它与 YAPF 结合起来，您需要在多导入行的末尾添加一个逗号。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c5b9" class="lp jm hi ll b fi lq lr l ls lt">"""file_formatted_with_isort.py"""<br/>import logging<br/>import os<br/>import sys</span><span id="17df" class="lp jm hi ll b fi lu lr l ls lt">import pandas as pd</span><span id="981d" class="lp jm hi ll b fi lu lr l ls lt">from file_to_be_imported import descriptive_function_1<br/>from files_to_be_imported import (descriptive_function_2,<br/> descriptive_function_3,<br/> descriptive_function_4,)</span></pre><p id="3ebc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用 iSort 和 YAPF 的最终结果是:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="9ea7" class="lp jm hi ll b fi lq lr l ls lt">"""file_formatted_with_isort_and_yapf.py"""import logging<br/>import os<br/>import sys</span><span id="fc3d" class="lp jm hi ll b fi lu lr l ls lt">import pandas as pd</span><span id="4118" class="lp jm hi ll b fi lu lr l ls lt">from file_to_be_imported import descriptive_function_1<br/>from files_to_be_imported import (<br/> descriptive_function_2,<br/> descriptive_function_3,<br/> descriptive_function_4,<br/>)</span><span id="dfb0" class="lp jm hi ll b fi lu lr l ls lt">GLOBAL_VARIABLE = "global variable"<br/></span><span id="8567" class="lp jm hi ll b fi lu lr l ls lt">class SomeException(Exception):<br/> <em class="kx">"""this is an exception and needs a docstring"""<br/> </em>pass<br/></span><span id="1131" class="lp jm hi ll b fi lu lr l ls lt">def single_variable(var: str):<br/> descriptive_function_1(var)<br/></span><span id="052e" class="lp jm hi ll b fi lu lr l ls lt">def multiple_variables(<br/> descriptive_var_1: str,<br/> descriptive_var_2: int,<br/> descriptive_var_3: bool,<br/>):<br/> try:<br/> descriptive_function_2(descriptive_var_1, )<br/> descriptive_function_3(descriptive_var_2)<br/> descriptive_function_4(descriptive_var_3)<br/> except SomeException:<br/> logging.exception("Some Exception occurred")</span><span id="5fb2" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_dict_example = {<br/> "key1": "value1",<br/> "key2": "value2",<br/> }</span><span id="c009" class="lp jm hi ll b fi lu lr l ls lt"> descriptive_list_example = [x for x in range(0, 10)]</span><span id="2224" class="lp jm hi ll b fi lu lr l ls lt"> logging.info(f"{descriptive_dict_example} and {descriptive_list_example}")</span></pre><p id="78e0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你可以看到进口现在是 PEP8 标准。我们还对多重导入语句加了括号并做了说明！太棒了。</p><p id="c230" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我希望这能让你对如何使用这些工具有一点了解。我真的相信 Python 协议应该被标准化，这样作为开发者我们可以专注于重要的事情。</p><p id="8c48" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我将编写一个 shell 脚本来自动化整个过程，我会在后续的博客中发布。</p><p id="b134" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你有任何问题，请随意提问，我会在下一个问题上和你联系。</p></div></div>    
</body>
</html>