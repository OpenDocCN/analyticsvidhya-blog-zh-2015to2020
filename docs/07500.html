<html>
<head>
<title>Nonlinear Regression with Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有深度学习的非线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/non-linear-regression-with-deep-learning-221584ccc8c2?source=collection_archive---------2-----------------------#2020-06-28">https://medium.com/analytics-vidhya/non-linear-regression-with-deep-learning-221584ccc8c2?source=collection_archive---------2-----------------------#2020-06-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1db9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我们将学习使用"<a class="ae jd" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>"训练神经网络进行回归预测，以及所有的理论和实践细节！本教程中分享的方法和代码可以用于任何其他回归任务，因此在本教程之后，您将能够通过训练有素的神经网络解决任何回归问题！</p><h1 id="971d" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">克拉斯</h1><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es kc"><img src="../Images/d98075f0bcaaa0f9a9776d4191121324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*VebfCe6ECxcET9B5.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">Keras是<a class="ae jd" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle上前5名获胜团队中使用最多的深度学习框架！</a></figcaption></figure><p id="1990" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>是为人类设计的API，不是为机器设计的。Keras遵循减少认知负荷的最佳实践:它提供一致的&amp;简单API，最大限度地减少常见用例所需的用户操作数量，并提供清晰的&amp;可操作错误消息。它有大量的文档和开发人员指南。</p><p id="4d49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将使用Keras和<a class="ae jd" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>后端在<a class="ae jd" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> python </a>上实现一个用于回归预测的神经网络！</p><h1 id="18b5" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">回归</h1><p id="abfd" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">回归是一种机器学习(ML)算法，可以被训练来预测实数输出；比如温度，股价，等等。</p><p id="6452" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">例如:以下哪一项是回归任务？</strong></p><ul class=""><li id="4e0e" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">预测人的年龄</li><li id="8717" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">预测某人的国籍</li><li id="91b3" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">预测一家公司的股票价格明天是否会上涨</li><li id="9e04" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">预测一份文件是否与目击不明飞行物有关？</li></ul><p id="7784" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解法:</strong>预测一个人的年龄(因为是实值，预测国籍是分类的，股票价格会不会涨是离散的——是/否答案，预测一个文档是否与UFO有关又是离散的——是/否答案)。</p><h2 id="d025" class="lh jf hi bd jg li lj lk jk ll lm ln jo iq lo lp js iu lq lr jw iy ls lt ka lu bi translated">分类与回归</h2><p id="0297" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">回归算法和分类算法的主要区别在于，回归算法是用来预测价格、工资、年龄等连续值的。并且使用分类算法来预测/分类离散值，例如男性或女性、真或假、垃圾邮件或非垃圾邮件等。其实也就这些了！</p><p id="d500" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面给出的数字会让你对回归有更清晰的认识！没错，这个身材太牛了！:)</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es lv"><img src="../Images/11cfe6841bdea4ce0a0d20b663d725a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*Xj49KzH8neMP-pJT.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">分类与回归</figcaption></figure><p id="ad51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将训练一个Keras神经网络来预测“<a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/Yacht+Hydrodynamics" rel="noopener ugc nofollow" target="_blank">游艇流体动力学数据集</a>的回归情况！案例包含6个输入值和一个输出值！我们将尝试预测回归，以便能够使用6个输入值来预测输出！</p><h1 id="0f1e" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">游艇流体动力学数据集</h1><p id="f5dd" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">关于数据集的所有细节都可以在<a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/Yacht+Hydrodynamics" rel="noopener ugc nofollow" target="_blank"> UCI机器学习库</a>获得！</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es lw"><img src="../Images/df9112e482c0b2247f17c3d108369330.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*wMA29-6UnT3yjOgELi-Qqg.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">游艇流体力学数据集的快速总结</figcaption></figure><p id="d5b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在初始设计阶段预报帆船的剩余阻力，对于评估船舶性能和估算所需推进功率具有重要价值。基本输入包括基本船体尺寸和船速。</p><p id="f035" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">属性信息<br/> <em class="lx">输入:</em> </strong>变化涉及船体几何系数和弗劳德数；<br/> <strong class="ih hj"> <em class="lx"> 1。</em> </strong>浮力中心的纵向位置，无量纲。<br/> <strong class="ih hj"> <em class="lx"> 2。</em> </strong>棱形系数，无量纲。<br/> <strong class="ih hj"> <em class="lx"> 3。</em> </strong>长度-位移比，无量纲。<br/> <strong class="ih hj"> <em class="lx"> 4。</em> </strong>束流比，无量纲。<br/> <strong class="ih hj"> <em class="lx"> 5。</em> </strong>长宽比，无量纲。<br/> <strong class="ih hj"> <em class="lx"> 6。</em> </strong>弗劳德数，无量纲。<br/> <strong class="ih hj"> <em class="lx">输出:</em> </strong>被测变量为单位重量排量的剩余阻力；<br/> <strong class="ih hj"> <em class="lx"> 7。</em> </strong>单位重量排水量的剩余阻力，无量纲。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ly"><img src="../Images/7e8d60af0d6d3a98e1fa4c37594f98a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rsJAs6Krk7N9fkTXwxX3Iw.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated">带有数据集标题的样本行。</figcaption></figure><h1 id="32d1" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">设计和开发用于回归预测的Keras神经网络</h1><h2 id="7ff0" class="lh jf hi bd jg li lj lk jk ll lm ln jo iq lo lp js iu lq lr jw iy ls lt ka lu bi translated">网络架构设计</h2><p id="d23c" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">要实现用于回归的神经网络，必须定义架构本身。它使用一个简单的多层感知器(MLP)来定义架构，如下图所示。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es md"><img src="../Images/55b3b52fc33e2d39512869c5bf54e2c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hr00KoRgWkPAZo0vPaCKgA.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated">简单的多层感知器(MLP)来定义架构。</figcaption></figure><h2 id="d4a1" class="lh jf hi bd jg li lj lk jk ll lm ln jo iq lo lp js iu lq lr jw iy ls lt ka lu bi translated">履行</h2><p id="a367" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">既然我们已经设计好了我们的Keras神经网络，现在就来实现我们的设计吧！</p><p id="35fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。首先，我们应该进口必要的包装:</strong></p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="3638" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。)</strong>然后，我们需要读取我们的训练和验证数据:</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="2d9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。)</strong>我们得到了训练和验证数据，现在让我们训练我们的Keras神经网络来预测回归。换句话说，让我们在<em class="lx">【网络架构设计】</em> <strong class="ih hj"> </strong>部分实现我们刚刚设计的神经网络架构，并执行模型训练！</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="67a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是模型实现的说明:</p><ul class=""><li id="b990" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">由于执行了回归，包含具有线性激活函数的单个神经元的密集层。通常使用基于ReLu的激活，但是因为它是执行回归的，所以需要线性激活(第8行)。</li><li id="18c7" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">用于回归预测的模型用Adam优化器初始化，然后被编译(第11行)。</li><li id="4cab" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">平均绝对百分比误差被用作损失函数，这意味着试图最小化预测和实际“每单位驱替重量的剩余阻力”值之间的平均百分比差(第11行)。</li><li id="20cd" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">对于训练神经网络来说，选择训练时段的数量是一个重要的问题。使用太多的时段会导致训练数据集的<a class="ae jd" href="https://en.wikipedia.org/wiki/Overfitting" rel="noopener ugc nofollow" target="_blank">过拟合</a>，使用太少的时段也会导致<a class="ae jd" href="https://en.wikipedia.org/wiki/Overfitting" rel="noopener ugc nofollow" target="_blank">欠拟合</a>模型。因此，使用了<a class="ae jd" href="https://keras.io/api/callbacks/early_stopping/" rel="noopener ugc nofollow" target="_blank">早期停止方法</a>，该方法允许您指定任意大量的训练时期，并且一旦模型性能在维持验证数据集上停止改善，就停止训练(行#14)。</li></ul><p id="07dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上，请注意，回归案例有两种主要的典型设计方法:</p><ul class=""><li id="ecda" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">使用linear(默认的)作为输出层的激活函数(和之前层的ReLu)。</li><li id="44d8" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">使用“均方误差”作为损失度量。</li></ul><p id="758a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。)</strong>我们可以绘制训练历史，看看“我们的模型训练进行得如何？”：</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="me mf l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mg"><img src="../Images/46c25f0cfa8f1ba080fcf815464f56fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*HoIJ-nBjhXbvl3Q9c0ssCw.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">培训历史图</figcaption></figure><p id="bb71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。)</strong>现在，让我们看看“我们的模型在训练数据上的预测有多成功？”：</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="me mf l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mh"><img src="../Images/b49893bc7aaec7bc5fac69de2e2e7868.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*1NrrKs6Wjmo4cFOP_rALlA.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">训练集的实际与预测图</figcaption></figure><p id="089c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型对训练数据的预测达到了0.995 R平方！这太棒了。</p><blockquote class="mi mj mk"><p id="a216" class="if ig lx ih b ii ij ik il im in io ip ml ir is it mm iv iw ix mn iz ja jb jc hb bi translated"><strong class="ih hj"> R平方(R2) </strong>是一种统计度量，表示回归模型中由自变量或变量解释的因变量方差的比例。</p></blockquote><p id="9d7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 6。)</strong>我们研究中最激动人心的部分是检查“我们的模型在验证数据(我们的模型从未见过的数据)上的预测有多成功！)?"：</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="me mf l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mh"><img src="../Images/690534f2978718d08040f6e09bcec31c.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*G9CTfNnB9ZDLbv2HouQPoQ.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">验证集的实际与预测图</figcaption></figure><p id="0cac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型对验证数据的预测达到了0.992 R平方！这太神奇了！请不要认为在训练数据上达到0.99 R平方比在验证数据上达到0.99 R平方更容易！</p><h1 id="6bb7" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结论</h1><p id="c7a0" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">在本教程中，我们学习了回归算法的理论背景。我们还设计并实现了一个使用“<a class="ae jd" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>进行非线性回归预测的神经网络。我们使用“<a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/Yacht+Hydrodynamics" rel="noopener ugc nofollow" target="_blank">游艇流体力学数据集</a>作为案例研究，我们在训练和验证数据上都达到了0.99的R平方，这太棒了！本教程中分享的方法和代码可以用于任何其他回归任务，如“<a class="ae jd" href="http://archive.ics.uci.edu/ml/datasets/Computer+Hardware" rel="noopener ugc nofollow" target="_blank">计算机硬件</a>”、“<a class="ae jd" href="http://archive.ics.uci.edu/ml/datasets/Energy+efficiency" rel="noopener ugc nofollow" target="_blank">能效</a>”等等！因此，在本教程之后，你能够解决任何回归问题！</p><p id="a38c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于实现部分的源代码和更多细节可以在<a class="ae jd" href="https://github.com/ahmetozlu/nonlinear-regression-keras" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">这个GitHub库</strong> </a>中找到！</p></div></div>    
</body>
</html>