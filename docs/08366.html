<html>
<head>
<title>5 Steps to Auto-grade your Jupyter Notebooks- nbgrader simplified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的Jupyter笔记本电脑自动评分的5个步骤</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/5-steps-to-auto-grade-your-jupyter-notebooks-nbgrader-simplified-4cbebf8943ef?source=collection_archive---------2-----------------------#2020-07-27">https://medium.com/analytics-vidhya/5-steps-to-auto-grade-your-jupyter-notebooks-nbgrader-simplified-4cbebf8943ef?source=collection_archive---------2-----------------------#2020-07-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="22d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">比方说，你班上有200名学生，有10份试卷，每份试卷有10个问题。所以，20000道题需要评分。您想要一根魔棒在一瞬间生成一个包含所有学生成绩的. csv文件。` nbgrader `有那根魔杖'(抄袭自本文的`步骤5 ')。</p><p id="5259" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="https://nbgrader.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">nbgradier</a>便于在Jupyter笔记本上创建和评分作业。这个工具是使用笔记本的讲师的必备工具。一旦你习惯了“nbgrader ”,没有它你永远也写不出测试。然而，事实证明，如果使用不当，它会增加而不是减少你的工作量。具体来说，</p><ul class=""><li id="1d09" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">对于初学者来说，nbgrader可能很快变得不必要的复杂——官方文档对快速入门没有太大的启发。在下面的“步骤2”中有更多的信息。</li><li id="dbd0" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">例如，如果您有n个以上的学生(对我来说，n=3)，那么在nbgrader中手动输入学生id会变得很乏味。</li></ul><p id="ea47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你以前从未听说过nbgrader，或者你想知道自动给jupyter笔记本评分意味着什么，你可能会发现先看看这个介绍nbgrader核心功能的<a class="ae je" href="https://youtu.be/5WUm0QuJdFw" rel="noopener ugc nofollow" target="_blank">官方视频</a>会很有用。</p><blockquote class="jt ju jv"><p id="b54c" class="if ig jd ih b ii ij ik il im in io ip jw ir is it jx iv iw ix jy iz ja jb jc hb bi translated"><em class="hi">在这里，我将更多地关注如何快速上手nbgrader，并尽可能多地实现自动化。</em></p></blockquote><p id="6b73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于一个150人的班级来说，以下5个步骤对我来说是最有效的——最省时省力。但是，我经历了惨痛的教训。</p><h1 id="a239" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">第一步:</h1><h2 id="97ec" class="kx ka hi bd kb ky kz la kf lb lc ld kj iq le lf kn iu lg lh kr iy li lj kv lk bi translated">安装nbgrader(最好在虚拟环境中)</h2><p id="ef0d" class="pw-post-body-paragraph if ig hi ih b ii ll ik il im lm io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">假设你已经安装了jupyter。</p><ul class=""><li id="ccb7" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">使用conda(推荐):</li></ul><p id="eac5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“康达安装-康达锻造分级器”</p><ul class=""><li id="ea35" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">或者使用画中画:</li></ul><p id="a2d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">` pip安装nbgrader</p><p id="9d4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">成功安装后，当您从该虚拟环境启动任何笔记本电脑时,“Formgrader”的扩展将出现在顶部。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lq"><img src="../Images/01d256dbaec53d4eca1300a2c39f7d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mT7v1DEPSr3UHvllB2eBMg.png"/></div></div></figure><h1 id="359a" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">第二步</h1><h2 id="60f3" class="kx ka hi bd kb ky kz la kf lb lc ld kj iq le lf kn iu lg lh kr iy li lj kv lk bi translated">创建您的课程</h2><ol class=""><li id="adc5" class="jf jg hi ih b ii ll im lm iq mc iu md iy me jc mf jl jm jn bi translated">您在终端中的当前路径应该是您想要存储课程材料的位置。然后，在终端/cmd中运行以下命令:</li></ol><p id="4f9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">` nb年级快速入门课程_id</p><p id="2073" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的命令将为您创建一个名为‘course _ id’的课程目录以及其他必要的文件。</p><p id="50e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.现在，将路径设置为新创建的目录“course_id”。通过以下方式发布jupyter笔记本:</p><p id="1f7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">jupyter笔记本</p><p id="ff76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实证明，对于它的大部分功能，nbgrader在很大程度上依赖于某种层次结构(见下图)。错过第一步(例如，从任意目录启动笔记本会带来不必要的复杂性)将违反该结构，并且你将浪费数小时来弄清楚为什么使用“Formgrader”创建的作业没有保存在例如“course_id/source”目录中。</p><h2 id="d02e" class="kx ka hi bd kb ky kz la kf lb lc ld kj iq le lf kn iu lg lh kr iy li lj kv lk bi translated">“步骤2”的成就:</h2><p id="4598" class="pw-post-body-paragraph if ig hi ih b ii ll ik il im lm io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">通过执行步骤2，将自动创建以下分层结构。花一些时间来理解这种结构是值得的。并不是这个结构中的所有文件都与我们有关。官方哲学中有更多关于这方面的内容。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mg"><img src="../Images/31760787bc8cf039c56cb656478e5c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uawFjaAYCifarCN0XXBGMg.png"/></div></div></figure><h1 id="a776" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">第三步</h1><h2 id="af38" class="kx ka hi bd kb ky kz la kf lb lc ld kj iq le lf kn iu lg lh kr iy li lj kv lk bi translated">在数据库中自动添加学生id</h2><p id="6b49" class="pw-post-body-paragraph if ig hi ih b ii ll ik il im lm io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">用student _ ids填充数据库(也可以选择姓名)。假设所有学生的id都在一个. txt文件中。确保你的。txt文件包含唯一的学生id。</p><pre class="lr ls lt lu fd mh mi mj mk aw ml bi"><span id="87f9" class="kx ka hi mi b fi mm mn l mo mp">import pandas as pd<br/>from nbgrader.api import Gradebook</span><span id="123c" class="kx ka hi mi b fi mq mn l mo mp"># Create the connection to the database<br/>with Gradebook('sqlite:///gradebook.db') as gb:<br/>    path_of_file_holding_student_ids =  '../student_ids.txt'<br/>    # read the txt file<br/>    with open(path_of_file_holding_student_ids) as f:<br/>        # extract ids in a list.<br/>        student_ids = [word.strip() for line in f.readlines() for          word in line.split(',') if word.strip()]<br/>        # populate database with ids<br/>        for _id in student_ids:<br/>            gb.add_student(_id)</span></pre><p id="516b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自定义文件读取:</strong></p><p id="f848" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码部分(从上面复制的)只是将students _ ids从txt文件读入一个列表。为了满足您的需求，您可以对其进行相应的修改。例如，如果您的文件是不同的格式/样式。</p><pre class="lr ls lt lu fd mh mi mj mk aw ml bi"><span id="3ff7" class="kx ka hi mi b fi mm mn l mo mp">with open(path_of_file_holding_student_ids) as f:<br/>        # extract ids in a list.<br/>        student_ids = [word.strip() for line in f.readlines() for word in line.split(',') if word.strip()]</span></pre><p id="d4b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，从您的笔记本中，单击“form graderer ”,然后单击“Manage Students ”,您新添加的学生应该会出现在那里，如下所示:</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mr"><img src="../Images/79ad1edd39850637e3d7631ee1648a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-uTvyLafcqJDtPFU0-puRg.png"/></div></div></figure><p id="a31e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">暂时忽略“总分”。在底部，注意手动“+添加新学生…”如果你有很多学生，这将很快变得乏味。</p><p id="dd1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">`本笔记本中的所有代码都应在“course_id”目录下执行。`</em> </strong></p><h1 id="65aa" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">第四步</h1><h2 id="1f50" class="kx ka hi bd kb ky kz la kf lb lc ld kj iq le lf kn iu lg lh kr iy li lj kv lk bi translated">创建分配:</h2><p id="b3b3" class="pw-post-body-paragraph if ig hi ih b ii ll ik il im lm io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">安装后，可使用“formgrader”扩展。点击它，然后点击`+添加新任务`。说出你的作业。在其中创建一个新笔记本。然后，笔记本打开后，在工具栏顶部点击“查看”-&gt;“单元格工具栏”-&gt;“创建作业”(见下图)。关于介绍“nbgrader”核心功能的<a class="ae je" href="https://youtu.be/5WUm0QuJdFwhttps://youtu.be/5WUm0QuJdFw" rel="noopener ugc nofollow" target="_blank">官方视频</a>和<a class="ae je" href="https://nbgrader.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank">文档</a>已经用具体的例子很好地向您介绍了这一点，所以我不会进一步展开。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es ms"><img src="../Images/daf7fa95967aed796b7b93e9548bc2be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qvUkdOz83jxVRLcrbil4lA.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mt"><img src="../Images/6402447179977ebe1a20cd5eec07adbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlUwji_srpL9ctDPJAxXeg.png"/></div></div></figure><h1 id="6d90" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">第五步</h1><h2 id="7320" class="kx ka hi bd kb ky kz la kf lb lc ld kj iq le lf kn iu lg lh kr iy li lj kv lk bi translated">亲笔签名的作业</h2><p id="86ff" class="pw-post-body-paragraph if ig hi ih b ii ll ik il im lm io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">比方说，你的班上有200名学生，有10个测试，每个测试有10个问题。所以，20000道题需要评分。你想用魔法棒为所有学生生成一个. csv文件，这是你如何使用它:</p><p id="d68f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">将学生提交的内容放在一个名为“已提交:</em> </strong>的目录中</p><pre class="lr ls lt lu fd mh mi mj mk aw ml bi"><span id="142c" class="kx ka hi mi b fi mm mn l mo mp">import shutil<br/>import os</span><span id="3dec" class="kx ka hi mi b fi mq mn l mo mp">"Move submissions to a dir called `submitted` directory. So, nbgrader can recognize them for grading."</span><span id="3354" class="kx ka hi mi b fi mq mn l mo mp"># Path of directory containing students submissions initially (arbitrary dir)<br/>arbit_dir = 'arbitrary/'</span><span id="d949" class="kx ka hi mi b fi mq mn l mo mp">### First Create a dir called 'submitted` in course_id dir<br/>os.mkdir('submitted')<br/>subm_dir = 'submitted/'</span><span id="9570" class="kx ka hi mi b fi mq mn l mo mp"># Get files in arbitrary dir containing students submissions<br/>files = os.listdir(arbit_dir)</span><span id="793f" class="kx ka hi mi b fi mq mn l mo mp"># Move all files (submissions) from arbitrary directory to submitted dir<br/>for f in files:<br/>    shutil.move(arbit_dir+f, subm_dir)</span></pre><p id="f435" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">对每个作业评分，生成一个包含所有评分的. csv文件:</em> </strong></p><pre class="lr ls lt lu fd mh mi mj mk aw ml bi"><span id="3111" class="kx ka hi mi b fi mm mn l mo mp">import os</span><span id="52da" class="kx ka hi mi b fi mq mn l mo mp">## Grading the whole course work i.e. all assignments released.<br/>from nbgrader.apps import NbGraderAPI</span><span id="a902" class="kx ka hi mi b fi mq mn l mo mp">api = NbGraderAPI()<br/># Get names of all assignments (e.g. if 5 assignments were released so far, return 5 names)<br/>all_assignments_names = api.get_source_assignments()</span><span id="ddc0" class="kx ka hi mi b fi mq mn l mo mp"># Grade each assignment<br/>for assignment_name in all_assignments_names:<br/>    command = "nbgrader autograde '%s'" % assignment_name<br/>    os.system(command)</span><span id="d34d" class="kx ka hi mi b fi mq mn l mo mp"># Get grades in a csv file <br/>os.system("nbgrader export")</span></pre><p id="916f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果使用不当，你可能会浪费更多的能量。</p><p id="f874" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(以下。csv文件将在“眨眼之间”创建。我没有为亲笔签名写任何“提交文件”,所以你通常会看到0分。但是，这说明了一点。)</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mu"><img src="../Images/4ca04826ff2046b16598c3da4889d701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-LtKbhbYbBD988GGKkWDQ.png"/></div></div></figure><h2 id="179c" class="kx ka hi bd kb ky kz la kf lb lc ld kj iq le lf kn iu lg lh kr iy li lj kv lk bi translated">关于“提交目录”和层次结构的更多信息:</h2><p id="0c52" class="pw-post-body-paragraph if ig hi ih b ii ll ik il im lm io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">你将在一个任意的目录中收集学生提交的材料(以某种方式使用LMS或通过电子邮件等)，但nbgrader无法在那里找到它们。观察下面的层次结构:</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mv"><img src="../Images/8d0b84977dbf45b0f846318bdb416c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgaYrZutPwA9_dgv8qrovA.png"/></div></div></figure><p id="8006" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du mw mx my mi b">nbgrader</code>将只检测那些提交的内容，如果它们在<code class="du mw mx my mi b">submitted</code>目录中，最终对它们进行评分，而这个目录本身应该在<code class="du mw mx my mi b">course_id</code>目录中。这就是为什么在<code class="du mw mx my mi b">step5</code>中的第一个snipped会移动<code class="du mw mx my mi b">submitted</code>目录中的文件。此外，假设每个学生提交的内容都是这样组织的:</p><p id="4186" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">`<code class="du mw mx my mi b">{student_id}<strong class="ih hj">/</strong>{assignment_id}<strong class="ih hj">/</strong>{notebook_id}.ipynb</code></p><p id="2bb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中:</p><ul class=""><li id="4c55" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">student_id(一个目录)对应于学生的唯一id，例如studendid1(与数据库- <code class="du mw mx my mi b">Step3</code>中的相同)。</li><li id="94a9" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">assignment_id(目录)对应于分配的唯一名称，例如Test1。</li><li id="7c7d" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">notebook_id (an。ipynb文件)对应于任务中笔记本的名称，例如logistic_reg.ipynb。</li></ul><p id="6ed5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">这是包括在内的最少电池，您需要使用</em> <code class="du mw mx my mi b"><em class="jd">nbgrader</em></code> <em class="jd">来增强您的学习和教学体验。</em> <code class="du mw mx my mi b"><em class="jd">nbgrader</em></code> <em class="jd">提供了更多的功能——例如，可以选择进行</em> <a class="ae je" href="https://nbgrader.readthedocs.io/en/stable/user_guide/creating_and_grading_assignments.html?highlight=manual%20grading#manual-grading" rel="noopener ugc nofollow" target="_blank"> <em class="jd">手动评分</em> </a> <em class="jd">，如何编写</em> <a class="ae je" href="https://nbgrader.readthedocs.io/en/stable/user_guide/autograding_resources.html?highlight=good%20test#tips-for-writing-good-test-cases" rel="noopener ugc nofollow" target="_blank"> <em class="jd">好的测试</em> </a> <em class="jd">，以及</em><a class="ae je" href="https://jupyter.org/hub" rel="noopener ugc nofollow" target="_blank"><em class="jd">JupyterHub</em></a><em class="jd">(如果您在本地机器上使用nbgrader，我认为这些功能在本文中是多余的。)</em></p></div></div>    
</body>
</html>