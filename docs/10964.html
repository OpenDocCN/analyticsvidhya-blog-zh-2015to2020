<html>
<head>
<title>Spark MLlib, ML Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">火花 MLlib，ML 管道</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/spark-mllib-6f70a7062e3b?source=collection_archive---------17-----------------------#2020-11-10">https://medium.com/analytics-vidhya/spark-mllib-6f70a7062e3b?source=collection_archive---------17-----------------------#2020-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c639" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MLlib 是 Apache Spark 的机器学习库。包括高质量的算法，比 MapReduce 快一百倍。</p><h2 id="7c28" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">MLlib 的高级目标</h2><ul class=""><li id="ccc4" class="jy jz hi ih b ii ka im kb iq kc iu kd iy ke jc kf kg kh ki bi translated">让实用的机器学习变得可扩展和简单。</li><li id="1e73" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">简化可扩展机器学习管道的开发和部署。</li></ul><h2 id="c88d" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">MLlib 中的不同组件</h2><p id="31fc" class="pw-post-body-paragraph if ig hi ih b ii ka ik il im kb io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">MLlib 包含许多算法和实用程序。</p><ol class=""><li id="351e" class="jy jz hi ih b ii ij im in iq kr iu ks iy kt jc ku kg kh ki bi translated">算法—分类、回归、聚类</li></ol><p id="40ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.管道——构建、评估、调优、持久化(保存和加载模型和管道)</p><p id="704a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.特征化—提取、转换</p><p id="f4df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.实用程序-线性代数、统计</p><h2 id="99a7" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">Spark MLlib 数据类型</h2><p id="db83" class="pw-post-body-paragraph if ig hi ih b ii ka ik il im kb io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">支持存储在单机上的本地向量和矩阵，以及分布式矩阵。</p><ul class=""><li id="9014" class="jy jz hi ih b ii ij im in iq kr iu ks iy kt jc kf kg kh ki bi translated">局部向量-支持密集和稀疏两种类型的局部向量。</li></ul><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="007e" class="jd je hi la b fi le lf l lg lh">Dense format: [1.0,0.0,3.0]<br/>Sparse format: (3,[0,2],[1.0,3.0])</span></pre><ul class=""><li id="995a" class="jy jz hi ih b ii ij im in iq kr iu ks iy kt jc kf kg kh ki bi translated">标记点——标记点是与标记/响应相关联的密集或稀疏向量。例如:在二进制分类中，标签应该是 0(负)或 1(正)。</li><li id="8eba" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">局部矩阵—局部矩阵具有整数类型的行和列索引，以及存储在单台计算机中的双精度类型值。</li><li id="36da" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">分布式矩阵-分布式矩阵具有长类型行和列索引以及双精度类型值。它以分布式方式存储在一个或多个 rdd 中。类型:RowMatrix，IndexedRowMatrix，CoordinatedMatrix</li></ul><h2 id="9e24" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">Spark MLlib 基本统计</h2><p id="8898" class="pw-post-body-paragraph if ig hi ih b ii ka ik il im kb io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">MLlib 通过 statistics 包中的函数 colStats()提供 RDD(矢量)的汇总统计数据。<strong class="ih hj"> colStats() — </strong>返回列方向的最小值、最大值、平均值、方差、非零值的数量以及总计数。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="6b00" class="jd je hi la b fi le lf l lg lh">from pyspark.mlllib.stat import Statistics</span><span id="2a05" class="jd je hi la b fi li lf l lg lh">sc = ...........# sparkContext<br/>mat = ..........# an RDD of vectors</span><span id="90ac" class="jd je hi la b fi li lf l lg lh"><br/># Computing column summary statistics</span><span id="824c" class="jd je hi la b fi li lf l lg lh">summary = Statistics.colStats(mat)<br/>print(summary.mean())<br/>print(summary.variance())<br/>print(summary.numNonzeros())</span></pre><p id="0648" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MLlib 还可以使用统计信息包执行两个数据系列之间的关联。根据输入的类型，如果有两个 rdd[Double]或一个 RDD[vector]，则输出将是 Double 或相关矩阵。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9cf4" class="jd je hi la b fi le lf l lg lh">from pyspark.mlllib.stat import Statistics</span><span id="467a" class="jd je hi la b fi li lf l lg lh">sc = ...........# sparkContext</span><span id="2549" class="jd je hi la b fi li lf l lg lh">series1 = ......# series 1 <br/>series2 = ......# must have same cardinality as series 1</span><span id="1a4f" class="jd je hi la b fi li lf l lg lh">#Computes correlation using pearson;s method by default. </span><span id="baa5" class="jd je hi la b fi li lf l lg lh">print(Statistics.corr(series1, serie2, method= 'pearson'))</span><span id="21d1" class="jd je hi la b fi li lf l lg lh">data = .........# RDD of vectors<br/>print(Statistics.corr(data, method= 'pearson'))</span></pre><h2 id="9afe" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">ML 管道是如何工作的？</h2><figure class="kv kw kx ky fd lk er es paragraph-image"><div class="er es lj"><img src="../Images/feaf30a3d5e536de6e36f447b0e07711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*FDs96eKT1irP_bN_E0LWMw.png"/></div></figure><ol class=""><li id="4c46" class="jy jz hi ih b ii ij im in iq kr iu ks iy kt jc ku kg kh ki bi translated">变形金刚—</li></ol><ul class=""><li id="41be" class="jy jz hi ih b ii ij im in iq kr iu ks iy kt jc kf kg kh ki bi translated">特征提取的预处理链。</li><li id="c984" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">将数据转换成可消费的格式。</li><li id="c6c0" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">获取输入列，将其转换为输出列。</li><li id="4990" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">很少的例子会是—标准化数据、符号化、将分类值转换为数值。</li></ul><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ee48" class="jd je hi la b fi le lf l lg lh">transform()</span></pre><p id="afd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.估计量</p><ul class=""><li id="e1ce" class="jy jz hi ih b ii ij im in iq kr iu ks iy kt jc kf kg kh ki bi translated">对数据进行训练(拟合)的学习算法。</li><li id="7dda" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">返回一个模型，这是一种转换器。</li><li id="dcd0" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">几个例子是——字符串索引器，一个热门的编码器</li></ul><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="f06b" class="jd je hi la b fi le lf l lg lh">fit()</span></pre><p id="7802" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.求值程序</p><ul class=""><li id="c297" class="jy jz hi ih b ii ij im in iq kr iu ks iy kt jc kf kg kh ki bi translated">根据特定指标评估模型性能— ROC，RMSE</li><li id="7574" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">有助于模型调整过程的自动化。比较模型性能并选择生成预测的最佳模型。</li><li id="6770" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">示例:BinaryClassificationEvaluator、CrossValidator 等。</li></ul><div class="ln lo ez fb lp lq"><a href="https://github.com/radhikagupta6/Spark_ml_Pipelines/blob/main/Classification_problem_with_ML_pipelines.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">radhikagupta 6/Spark _ ml _ Pipelines</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">Permalink GitHub 是 5000 多万开发人员的家园，他们一起工作来托管和审查代码、管理项目以及…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">github.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me ll lq"/></div></div></a></div></div></div>    
</body>
</html>