<html>
<head>
<title>Time Series Forecasting using TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于张量流的时间序列预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-forecasting-using-tensorflow-rkt109-ea858d8e49c6?source=collection_archive---------0-----------------------#2020-04-03">https://medium.com/analytics-vidhya/time-series-forecasting-using-tensorflow-rkt109-ea858d8e49c6?source=collection_archive---------0-----------------------#2020-04-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/36d2cd01d5ea1aa2fd1bbf3a29c86189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2Wvxenw5Q5PCugHcInuDA.png"/></div></div></figure><p id="a656" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">时间序列</strong>表示实体随时间的变化。例如，你可能听说过天气预报，我们试图预测未来某个特定时间的天气状况，可能是一天中的某个特定时间。时间序列的其他例子有公司股票的每日收盘价、月降雨量数据和年销售额等。</p><p id="6f38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我提供了本教程中使用的代码的GitHub库的链接。https://github.com/aryan109/Sunspot_Prediction<a class="ae jo" href="https://github.com/aryan109/Sunspot_Prediction" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="1f9b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">时间序列的组成部分</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/7bbec240ed5b9ac827681484ad03ab04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/0*B5-pzc68sqNPRpQj.png"/></div></figure><h2 id="7e36" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">趋势</h2><p id="4bf9" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">趋势显示了数据在很长一段时间内增加或减少的总体趋势。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/5523fcf00b4093ae64f109bd7e482bc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1CGcdS7DF4mdwT2P.png"/></div></div></figure><h2 id="4e6e" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">周期性波动</h2><p id="8f64" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">时间序列中有一些成分会在一段时间内重复出现。他们以一种有规律的间歇性方式行动。这些变化有两种类型:- <br/> <strong class="is hj"> a)季节性变化:</strong>这些是节奏力，在不到一年的时间内以规则和周期性的方式起作用。<br/> <strong class="is hj"> b)周期性变化:</strong>时间序列中自身运行时间跨度超过一年的变化为周期性变化。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/04800cfbc006c96d7d53557956193d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fol4pzVPAAWcocqw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">有上升趋势的周期性波动</figcaption></figure><h2 id="b69a" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">随机或不规则运动(噪音)</h2><p id="067a" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">这些随机或不规则的变化是不可预见的、不可控的、不可预测的和不稳定的。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/3992ea67973e6638df7f5e8848d95c0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zxqe8SBU8V8yUUqR.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">噪声波形</figcaption></figure><blockquote class="ls lt lu"><p id="eb8c" class="iq ir lv is b it iu iv iw ix iy iz ja lw jc jd je lx jg jh ji ly jk jl jm jn hb bi translated">一般来说，现实世界中的时间序列既有趋势性又有季节性，还带有一些白噪声。</p></blockquote><h2 id="a570" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">在本教程中，我们将做太阳黑子预测。</h2><p id="8e1c" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">你可能在想“什么！孙也得了斑？？?"</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/7f8b6aa30d0e4ccf7462ccfbf3ea7159.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/0*EDcTJGORoXaqPHhY"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">图像显示一个真正的太阳黑子。</figcaption></figure><p id="e145" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">太阳黑子</strong>是太阳表面呈现黑色的区域。它们看起来很暗，因为它们比太阳表面的其他部分更冷。然而，太阳黑子的温度仍然很高——大约6500华氏度！太阳黑子被用来记录太阳周期。<strong class="is hj">太阳周期</strong>是太阳磁场大约每11年经历的周期。</p><h1 id="94d3" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我们开始吧</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/be5d528a3c626474f95f4ae521d4bc6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g9tNb-mSLKfQI2e6"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">由<a class="ae jo" href="https://unsplash.com/@max_duz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Max Duzij </a>在<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="32e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们需要下载我们的时间序列数据。下面是以CSV格式下载数据的代码。</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="1f4f" class="ks jq hi mc b fi mg mh l mi mj">!wget — no-check-certificate \<br/> <a class="ae jo" href="https://storage.googleapis.com/laurencemoroney-blog.appspot.com/Sunspots.csv" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/laurencemoroney-blog.appspot.com/Sunspots.csv</a> \<br/> -O /tmp/sunspots.csv</span></pre><p id="82f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下载的CSV文件如下所示:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/d81eb213af508b7ff7d5898b3ce70afa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4T_-eH2OstpohZOzUTrSVQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">黑子. csv</figcaption></figure><p id="c73c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如您所见，该文件总共包含3列，我们将把第1列和第3列提取到一个NumPy数组中。我们已经选择了索引列，这将很容易作出预测，因为我们只需要给索引。</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="7cd4" class="ks jq hi mc b fi mg mh l mi mj">import csv<br/>time_step = []<br/>sunspots = []</span><span id="13ff" class="ks jq hi mc b fi ml mh l mi mj">with open(‘/tmp/sunspots.csv’) as csvfile:<br/> reader = csv.reader(csvfile, delimiter=’,’)<br/> next(reader)<br/> for row in reader:<br/> sunspots.append(float(row[2]))<br/> time_step.append(int(row[0]))</span><span id="f19e" class="ks jq hi mc b fi ml mh l mi mj">series = np.array(sunspots)<br/>time = np.array(time_step)<br/>print(‘series: {}’.format(series[:5]))<br/>print(‘time: {}’.format(time[:5]))</span></pre><p id="d8f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们画出这个系列，看看它有什么。</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="ef37" class="ks jq hi mc b fi mg mh l mi mj">plt.figure(figsize=(10, 6))<br/>plot_series(time, series)</span></pre><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/749fbdfe9859eab12c42f3439459099e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amYRjhBEf2Svzj1WL4laow.png"/></div></div></figure><h1 id="0e13" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">正在准备数据集</h1><p id="0f4a" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">我们必须将我们的时间序列分成训练期和验证期。</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="f854" class="ks jq hi mc b fi mg mh l mi mj">split_time = 3000<br/>time_train = time[:split_time]<br/>x_train = series[:split_time]<br/>time_valid = time[split_time:]<br/>x_valid = series[split_time:]</span></pre><p id="49c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分割时间为3000意味着从0到3000将用于训练，3000到最后用于验证。</p><p id="3614" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们将定义一个函数来创建一个窗口数据集。在一个<strong class="is hj">窗口数据集中，</strong>前n个值可以被视为<strong class="is hj">输入特征</strong>。而带有任意时间戳的当前值就是<strong class="is hj">输出标签</strong>。窗口数据集由固定的<strong class="is hj">窗口大小</strong>组成。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/0df1dc4508e347df653c9e58789e4087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5LxXIM9-S0OclvDRQTiWw.png"/></div></div></figure><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="b1e4" class="ks jq hi mc b fi mg mh l mi mj">def windowed_dataset(series, window_size, batch_size, shuffle_buffer):<br/> series = tf.expand_dims(series, axis=-1)<br/> ds = tf.data.Dataset.from_tensor_slices(series)<br/> ds = ds.window(window_size + 1, shift=1, drop_remainder=True)<br/> ds = ds.flat_map(lambda w: w.batch(window_size + 1))<br/> ds = ds.shuffle(shuffle_buffer)<br/> ds = ds.map(lambda w: (w[:-1], w[1:]))<br/> return ds.batch(batch_size).prefetch(1)</span></pre><p id="8d4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们使用<strong class="is hj"> windowed_dataset </strong>函数创建训练数据集</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="5d56" class="ks jq hi mc b fi mg mh l mi mj">tf.keras.backend.clear_session()<br/>tf.random.set_seed(51)<br/>np.random.seed(51)<br/>shuffle_buffer_size = 1000<br/>window_size = 64<br/>batch_size = 256<br/>train_set = windowed_dataset(x_train, window_size, batch_size, shuffle_buffer_size)<br/>print(x_train.shape)</span></pre><h1 id="674f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">创建模型</h1><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="2af2" class="ks jq hi mc b fi mg mh l mi mj">tf.keras.backend.clear_session()<br/>model = tf.keras.models.Sequential([<br/> tf.keras.layers.Conv1D(filters=60, kernel_size=5,<br/> strides=1, padding=”causal”,<br/> activation=”relu”,<br/> input_shape=[None, 1]),<br/> tf.keras.layers.LSTM(60, return_sequences=True),<br/> tf.keras.layers.LSTM(60, return_sequences=True),<br/> tf.keras.layers.Dense(30, activation=”relu”),<br/> tf.keras.layers.Dense(10, activation=”relu”),<br/> tf.keras.layers.Dense(1),<br/> tf.keras.layers.Lambda(lambda x: x * 400)<br/>])<br/>model.summary()</span></pre><p id="7570" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该模型的摘要如下所示:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/7ccb1b0021b1fc4255209fb4b764db86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYLSqEeT5A71WbU9Ro5Xuw.png"/></div></div></figure><p id="feab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如你所看到的，这个模型由<strong class="is hj">卷积层、LSTM层</strong>和<strong class="is hj">致密层</strong>组成。如果你不知道这些层到底是做什么的，不要担心，很快我会写一篇文章描述所有不同类型层的功能。</p><h1 id="f1da" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">现在让我们编译和训练模型</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/978eb294a4171db164c00ccf7248c4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jFAhR2rwA7P56YUl"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">照片由<a class="ae jo" href="https://unsplash.com/@roozbeheslami?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Roozbeh Eslami </a>在<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="a1f9" class="ks jq hi mc b fi mg mh l mi mj">optimizer = tf.keras.optimizers.SGD(lr=1e-5, momentum=0.9)<br/>model.compile(loss=tf.keras.losses.Huber(),<br/> optimizer=optimizer,<br/> metrics=[“mae”])<br/>history = model.fit(train_set,epochs=500)</span></pre><p id="b2a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">训练开始了…..</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/91435df45ee48a2ea632de1005e13956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LqMZm1_0D_QGZC4Hs76PFw.png"/></div></div></figure><p id="4201" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">训练需要时间，所以请放松。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/4a66bb792ab1f7ae81a1fc7df7c47a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a2iOvcZpfs2DasoN"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">Max van den Oetelaar 在<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h1 id="1cc6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">评估模型</h1><p id="b5d5" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">现在，我们将通过观察训练损失来了解我们的模型有多好</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="9114" class="ks jq hi mc b fi mg mh l mi mj"># — — — — — — — — — — — — — — — — — — — — — — — — — — — — — -<br/># Retrieve a list of list results on training and test data<br/># sets for each training epoch<br/># — — — — — — — — — — — — — — — — — — — — — — — — — — — — — -<br/>loss=history.history[‘loss’]<br/>epochs=range(len(loss)) # Get number of epochs<br/># — — — — — — — — — — — — — — — — — — — — — — — — <br/># Plot training and validation loss per epoch<br/># — — — — — — — — — — — — — — — — — — — — — — — — <br/>plt.plot(epochs, loss, ‘r’)<br/>plt.title(‘Training loss’)<br/>plt.xlabel(“Epochs”)<br/>plt.ylabel(“Loss”)<br/>plt.legend([“Loss”])<br/>plt.figure()</span><span id="acd3" class="ks jq hi mc b fi ml mh l mi mj">zoomed_loss = loss[200:]<br/>zoomed_epochs = range(200,500)<br/># — — — — — — — — — — — — — — — — — — — — — — — — <br/># Plot training and validation loss per epoch<br/># — — — — — — — — — — — — — — — — — — — — — — — — <br/>plt.plot(zoomed_epochs, zoomed_loss, ‘r’)<br/>plt.title(‘Training loss’)<br/>plt.xlabel(“Epochs”)<br/>plt.ylabel(“Loss”)<br/>plt.legend([“Loss”])</span><span id="c6a3" class="ks jq hi mc b fi ml mh l mi mj">plt.figure()</span></pre><p id="5643" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">图表应该与此类似。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/02614fb7f8cfda0defcc771a766c5370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*HybwRD8Y5gQC2WzGzKzTdQ.png"/></div></figure><p id="0993" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二个图只是放大了第一个图的最后一部分。通过这一点，我们可以清楚地了解过去300年的训练状况。</p><h1 id="a11e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">让我们预测一下</h1><p id="0bd4" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">现在，随着你的模型被训练，准备好看到未来。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/9714b4085742ccc9087773250534eb7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ogu0s-4sIyhmYorV"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">照片由<a class="ae jo" href="https://unsplash.com/@lenneek?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Elena Koycheva </a>在<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="f10d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将创建一个函数来帮助我们做预测。</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="92d2" class="ks jq hi mc b fi mg mh l mi mj">def model_forecast(model, series, window_size):<br/> ds = tf.data.Dataset.from_tensor_slices(series)<br/> ds = ds.window(window_size, shift=1, drop_remainder=True)<br/> ds = ds.flat_map(lambda w: w.batch(window_size))<br/> ds = ds.batch(32).prefetch(1)<br/> forecast = model.predict(ds)<br/> return forecast</span></pre><p id="7213" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们将使用这个函数来做预测。</p><pre class="ko kp kq kr fd mb mc md me aw mf bi"><span id="697d" class="ks jq hi mc b fi mg mh l mi mj">rnn_forecast = model_forecast(model, series[…, np.newaxis], window_size)<br/>rnn_forecast = rnn_forecast[split_time — window_size:-1, -1, 0]<br/>plt.figure(figsize=(10, 6))<br/>plot_series(time_valid, x_valid)<br/>plot_series(time_valid, rnn_forecast)</span></pre><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/219e26a92d8230b5ebe7e3b16fe1ebc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WK9dM64wz58u-diRRpcSVQ.png"/></div></div></figure><p id="6459" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">蓝色是原始系列，橙色是预测系列，结果看起来相当不错😃。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/dc08000aa2f548a44fc372d177ce5f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CX9pKNrObDfYAz2u9aRqSQ.jpeg"/></div></div></figure><p id="56fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望你明白如何用TensorFlow做时间序列预测。</p><p id="300e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请给出您的反馈或建议。谢谢你🙂</p></div></div>    
</body>
</html>