<html>
<head>
<title>Starting with Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Docker开始</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/starting-with-docker-bfd74021d5c7?source=collection_archive---------9-----------------------#2019-09-12">https://medium.com/analytics-vidhya/starting-with-docker-bfd74021d5c7?source=collection_archive---------9-----------------------#2019-09-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c063" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个Docker帖子已经永远在我的待办事项列表上了:现在是时候了！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/cc33928621dd06b962d57bc03fcd267f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o8arOfJbYRIqBZg9"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@ilangamuwa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Nilantha Ilangamuwa </a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="56fc" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">为什么是Docker呢？</h2><ul class=""><li id="5502" class="kp kq hi ih b ii kr im ks iq kt iu ku iy kv jc kw kx ky kz bi translated">如果你曾经不得不使用一个虚拟的<em class="la">机器</em>，你就会知道它们有多慢多重——它们占据了太多的空间！Docker更快更轻！</li><li id="e01d" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated">如果您曾经在您的本地机器虚拟环境(您的代码在其中工作)和将它部署到其他地方(甚至是<em class="la">与</em>相同的环境)之间遇到过问题，在那里它突然不再工作了，Docker可以提供一个工作空间，它在您的本地机器上运行将与在远程机器上运行完全相同，因为它实际上是同一个“机器”！变量更少，故障排除更简单。</li></ul><p id="39a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du lg lh li lj b">Dockerfile</code>文件中的指令，Docker将您的环境——库、任何依赖项、环境变量和配置文件等——和<em class="la">代码</em> <em class="la">一起</em>打包成一个<code class="du lg lh li lj b">image</code>,您可以与任何人共享。然后他们可以在他们的机器上<code class="du lg lh li lj b">run</code>图像，无论你发送给他们什么都可以工作！💥</p><h2 id="9065" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">那么，我们如何开始？</h2><ol class=""><li id="9e53" class="kp kq hi ih b ii kr im ks iq kt iu ku iy kv jc lk kx ky kz bi translated">创建一个码头中心账户:<a class="ae jt" href="https://hub.docker.com" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com</a></li><li id="51e8" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc lk kx ky kz bi translated">从docker hub下载docker。</li><li id="34d7" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc lk kx ky kz bi translated">下载完成后(如果你用的是Mac的话，会被拖到应用程序中)，点击它，等待docker启动(需要一些时间)。启动后，docker符号应该会出现在电池和wifi符号旁边的状态栏顶部。</li><li id="2448" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc lk kx ky kz bi translated">打开一个终端，从任何目录中键入<code class="du lg lh li lj b">docker run hello-world</code>，它将从Docker Hub获取Hello World映像，构建它，并打印一条消息。或者，更简单地说，你也可以只输入<code class="du lg lh li lj b">docker info</code>,你就会得到你机器上所有Docker信息的打印结果😁</li><li id="57c8" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc lk kx ky kz bi translated">希望这行得通！</li></ol></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h2 id="e47c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">一些可以尝试的事情:</h2><p id="95e8" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated"><strong class="ih hj">探索你正在做的事情— </strong></p><ul class=""><li id="9c70" class="kp kq hi ih b ii ij im in iq lv iu lw iy lx jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker images</code>查看您有哪些图像。目前可能没有。</li><li id="c444" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker ps</code>或<code class="du lg lh li lj b">docker ps -a</code>查看哪些容器是或曾经是活动的。如果你什么都没有，做<code class="du lg lh li lj b">docker run busybox</code>然后再试<code class="du lg lh li lj b">docker ps -a</code>。您应该会看到新的一行。记下<code class="du lg lh li lj b">&lt;IMAGE&gt;</code>图像名称，以及<code class="du lg lh li lj b">&lt;CONTAINER ID&gt;</code>、<code class="du lg lh li lj b">&lt;STATUS&gt;</code>和<code class="du lg lh li lj b">&lt;NAMES&gt;</code>，因为这些可以在命令行中引用，以执行诸如删除、停止或运行特定的操作。</li></ul><p id="3a1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">跑步— </strong></p><ul class=""><li id="b303" class="kp kq hi ih b ii ij im in iq lv iu lw iy lx jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker run &lt;IMAGE&gt;</code>启动docker容器并在其中运行您的程序。</li><li id="5445" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated">如果你没有要运行的图像，试试<code class="du lg lh li lj b">docker run busybox</code>，它会在你的机器上显示，然后搜索<a class="ae jt" href="https://hub.docker.com" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>找到它，下载它，并在一个容器中运行它。您还可以使用<code class="du lg lh li lj b">docker pull &lt;IMAGE&gt;</code>从Docker Hub获取图像。你可以在<a class="ae jt" href="https://hub.docker.com/search?&amp;q=" rel="noopener ugc nofollow" target="_blank">中心点击</a>查看更多图片。</li><li id="3df8" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker run -it &lt;IMAGE&gt; sh</code>运行图像，并打开一个shell以便可以直接与容器交互。如果容器已经在运行，执行<code class="du lg lh li lj b">docker exec -it &lt;CONTAINER ID&gt; sh</code>在容器中得到一个shell提示。</li></ul><p id="77f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">停止并移除docker物件— </strong></p><ul class=""><li id="ab98" class="kp kq hi ih b ii ij im in iq lv iu lw iy lx jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker stop &lt;CONTAINER ID&gt;</code>以优雅的方式停止容器运行。但是容器仍然存在，所以在某个时候你需要移除它。</li><li id="0337" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker system prune -a</code> <strong class="ih hj"> <em class="la">删除你机器上的每个图像和每个容器！</em> </strong>😱然而，在执行这个请求之前，<em class="la">会要求</em>确认，这很好🎉</li><li id="6aa4" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated">更明智的<code class="du lg lh li lj b">rm</code>命令包括:<code class="du lg lh li lj b">docker rm &lt;CONTAINER ID&gt;</code>删除特定的容器，<code class="du lg lh li lj b">docker container prune</code>仅删除停止的容器，<code class="du lg lh li lj b">docker rmi</code>删除图像。</li><li id="52ca" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated">提示:在输入<container id="">时，你只需要输入前几个值，它就会知道你指的是哪一个。✨</container></li><li id="50d3" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated">有关移除图像、容器和卷的更多信息，请查看数字海洋的<a class="ae jt" href="https://www.digitalocean.com/community/tutorials/how-to-remove-docker-images-containers-and-volumes" rel="noopener ugc nofollow" target="_blank">这篇文章。</a></li><li id="89b5" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker -h</code>查看还有哪些命令可用。</li></ul><h2 id="b326" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated"><strong class="ak">制作自己的&lt;形象&gt; </strong></h2><p id="71d6" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">为了创建你自己的图像，你需要打一个order文件。如果您当前的文本编辑器还没有安装语法荧光笔，安装语法荧光笔会有助于提高可读性。我使用Atom，有几个Docker语法高亮器可供安装👍要在Atom中找到它们，打开Atom，选择<code class="du lg lh li lj b">Packages</code>-&gt;-<code class="du lg lh li lj b">Settings View</code>-&gt;-<code class="du lg lh li lj b">Install Packages/Themes</code>，然后在搜索栏中键入类似<code class="du lg lh li lj b">Docker highlighter</code>的内容。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/b7283c9ae00c08cec5045d984e24f0bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fI89fv66BH5GC0jwwWVSeg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">如何在Atom文本编辑器中安装附加包？可以帮助安装一个Docker语法荧光笔。上面的代码显示了Dockerfile语法高亮显示。</figcaption></figure><h2 id="e117" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated"><code class="du lg lh li lj b">Dockerfile</code></h2><p id="0c72" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">这是指令文件。通常，我们将Dockerfile建立在一个已经存在的映像上，这样我们就不必从头开始构建映像。例如，如果您想在您的容器中运行python代码，那么您可以将您的docker文件基于一个<a class="ae jt" href="https://hub.docker.com/_/python/" rel="noopener ugc nofollow" target="_blank">现有的python映像</a>。为此，第一行将是<code class="du lg lh li lj b">FROM &lt;IMAGE&gt;</code>，其中<code class="du lg lh li lj b">&lt;IMAGE&gt;</code>是预先存在的图像。下面的截图显示了一个基于<a class="ae jt" href="https://hub.docker.com/_/python/" rel="noopener ugc nofollow" target="_blank">官方Python3图片</a>的Dockerfile。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/7110cb2992ae9a0d02ae0da430798515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HklraNbCqnQaBUNK1MDu-Q.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从如何在Docker Hub 上使用<a class="ae jt" href="https://hub.docker.com/_/python/?tab=description" rel="noopener ugc nofollow" target="_blank"> Python映像的示例中复制到Atom中的示例Docker文件的屏幕截图</a></figcaption></figure><p id="87ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第1行:</strong>标签<code class="du lg lh li lj b">:3</code>指定使用哪个版本的图像。对于python 2版本，这也可以读作<code class="du lg lh li lj b">FROM python:2</code>。对于所有不同的版本或标签，请查看python Docker Hub 页面上的<a class="ae jt" href="https://hub.docker.com/_/python/" rel="noopener ugc nofollow" target="_blank">支持的标签。</a></p><p id="cfb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第3行:</strong>指定容器的工作目录<code class="du lg lh li lj b">WORKDIR</code></p><p id="9358" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第5行&amp;第6行:</strong>将<code class="du lg lh li lj b">reqiuirements.txt</code>从本地机器上的当前目录复制到<code class="du lg lh li lj b">WORDKDIR</code>容器中，然后<code class="du lg lh li lj b">RUN</code>安装文件中列出的所有库。</p><p id="29d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第8行:</strong>所有内容都从本地机器上的当前目录复制到容器中的<code class="du lg lh li lj b">WORKDIR</code></p><p id="20fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第10行:</strong><code class="du lg lh li lj b">CMD</code>命令在新容器中启动python脚本💥</p><p id="8447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">提示！</strong>用<code class="du lg lh li lj b">FROM python:3-onbuild</code>写更少的行，这将包括复制文件部分和来自<code class="du lg lh li lj b">requirements.txt</code>的需求的安装。上面的Dockerfile文件变成:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/beb11c473ccd1a374684a5b5fdabb334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zs3vEBYhILU5k2SD4oAysg.png"/></div></div></figure><p id="dc22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，构建映像，共享并运行:</p><ul class=""><li id="346e" class="kp kq hi ih b ii ij im in iq lv iu lw iy lx jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker build -t &lt;TAG NAME&gt; .</code>将从这个docker文件构建图像，给它一个对你有意义的<code class="du lg lh li lj b">-t</code>标记名。<code class="du lg lh li lj b">.</code>表示Dockerfile文件是当前位置。</li><li id="fab6" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker run -it &lt;TAG NAME&gt;</code>将在<code class="du lg lh li lj b">-i</code>交互模式下运行新图像。</li></ul></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><p id="f738" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想使用Docker Hub或其他地方的图像，而不需要额外的库或环境变量等，并使用它运行一个脚本，该怎么办？一定要写Dockerfile，建立新形象吗？</p><p id="56f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相反，我们可以运行下面的命令来启动一个直接基于图像<code class="du lg lh li lj b">&lt;TAG NAME&gt;</code>的容器，比如官方的python图像，并在其中运行脚本<code class="du lg lh li lj b">my-new-python-script.py</code>:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mb"><img src="../Images/ce3b49bc5ef204c4e94dda4ad1d56f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qN68sW-91IiyrYZEnlDYSw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">运行不包含在映像构建中的脚本的命令</figcaption></figure><ul class=""><li id="12b4" class="kp kq hi ih b ii ij im in iq lv iu lw iy lx jc kw kx ky kz bi translated"><code class="du lg lh li lj b">docker run -it</code>和以前一样，在脚本所在的目录下运行。</li><li id="65a7" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">-v "$PWD":/usr/src/myapp</code>将本地目录——或<code class="du lg lh li lj b">-v</code>卷——直接挂载到容器，这意味着所需的脚本必须在当前的本地目录中。</li><li id="86d3" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">-w /usr/src/myapp</code>定义工作目录。即使在构建映像的Dockerfile文件中指定了<code class="du lg lh li lj b">WORKDIR</code>，这也是必要的。</li><li id="8f46" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated"><code class="du lg lh li lj b">&lt;TAG NAME&gt; python my-new-python-script.py</code>正在指定要使用的图像，然后调用python脚本。</li></ul><p id="cb47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想从同一个映像运行几个容器，并且不想使用随机生成的容器名，可以用标志<code class="du lg lh li lj b">--name</code>指定一个容器名。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/e08d4c0ab85bc5b8513e87affec690cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qY0AqISugeuwoVXZCVjNlA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">命令来运行不包含在映像构建中的脚本，并将容器命名为“new-script”</figcaption></figure><p id="e087" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的终端代码中，容器被命名为“new-script ”,所以我知道哪个脚本在那个容器中运行。然而，容器名必须是唯一的，记住这一点。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><p id="72b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前就这些。要记的东西太多了，很容易让人不知所措。一些方便的资源包括:</p><ul class=""><li id="6860" class="kp kq hi ih b ii ij im in iq lv iu lw iy lx jc kw kx ky kz bi translated">命令行参考<a class="ae jt" href="https://docs.docker.com/engine/reference/commandline/docker/" rel="noopener ugc nofollow" target="_blank">https://docs . docker . com/engine/reference/command line/docker/</a></li><li id="5124" class="kp kq hi ih b ii lb im lc iq ld iu le iy lf jc kw kx ky kz bi translated">码头工人自己的课程【https://docker-curriculum.com T2】</li></ul><p id="d613" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，不要忘记清理你退出的容器！！！👋</p></div></div>    
</body>
</html>