<html>
<head>
<title>One Hot encoding of text data in Natural Language Processing.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然语言处理中文本数据的一种热编码。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/one-hot-encoding-of-text-data-in-natural-language-processing-2242fefb2148?source=collection_archive---------1-----------------------#2020-08-14">https://medium.com/analytics-vidhya/one-hot-encoding-of-text-data-in-natural-language-processing-2242fefb2148?source=collection_archive---------1-----------------------#2020-08-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9868c2b0b72156dc3ee32fce620d9380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xyifJ4nVFqMEUt3711HX8g.jpeg"/></div></div></figure><p id="216d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">机器学习和深度学习最有趣的应用之一可以在<strong class="is hj">自然语言处理(NLP) </strong>领域找到。NLP 中的许多任务包括处理被理解为文本序列的文本和句子。但是作为机器学习模型一部分的<strong class="is hj">神经网络</strong>需要以张量或向量的形式输入，其组成元素是数字形式的。那么，这些数据是如何以文本形式输入到这样一个神经网络模型中的呢？使我们能够做到这一点的方法之一，我们将在下面讨论，被称为<strong class="is hj">一个热编码</strong>。</p><p id="7bc3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在一种热编码中，作为给定文本数据一部分的每个单词(甚至符号)都以向量的形式书写，仅由 1 和 0 组成。所以一个热向量是元素只有 1 和 0 的向量。每个单词被写成或编码成一个热向量，每个热向量都是唯一的。这允许单词由其一个热向量唯一地识别，反之亦然，即没有两个单词将具有相同的一个热向量表示。例如，下图显示了给定句子中单词的一种热编码。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/9a201cf0d45d36e0e93ba135e9c7a9bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*_da_YknoUuryRheNS-SYWQ.png"/></div></figure><p id="d375" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，在左侧图像中，单词“The”<strong class="is hj"/>和“The”<strong class="is hj"/>具有不同的编码，暗示它们是不同的。因此，我们<strong class="is hj">将文本数据中的每个单词和符号</strong>表示为唯一的一个热向量，该向量包含数字数据(1 和 0)作为其组成元素。一个单词被表示为一个<strong class="is hj">向量</strong>，因此句子中的单词列表可以表示为一个<strong class="is hj">向量数组</strong>或一个<strong class="is hj">矩阵</strong>，如果我们有一个单词被热编码的句子列表，那么它将产生一个元素是矩阵的数组。所以我们最终得到了一个三维张量，可以输入到神经网络中。</p><p id="db5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们从头开始使用<strong class="is hj"> numpy </strong>库来检查它在<strong class="is hj"> Python </strong>中的实现。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="b1fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第一行，我们有由两个句子组成的样本集。接下来，我们创建一个空的 Python <strong class="is hj">字典</strong>，用于存储我们的<strong class="is hj">单词(键)</strong>和它们对应的<strong class="is hj">索引(值)</strong>，后面是一个设置为 0 的计数器，用于计算字典中键-值对的数量。第一个 for 循环遍历句子，而下一行中的 for 循环遍历所选句子中的每个单词，并拆分每个单词，返回一个<strong class="is hj">字符串列表。</strong>然后，如果<em class="jv"> current_word </em>变量的值不在字典<em class="jv"> token_index </em>中，那么我们将它添加到<em class="jv"> token_index </em>字典中，并为它分配一个等于<em class="jv"> counter </em>变量的值的索引，并将其加 1，以从 1 而不是 0 开始我们的索引，并且还将<em class="jv"> counter </em>的值加 1。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="f7d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们得到了如上图所示的字典。请注意，样本中有 11 个单词，但只有 10 个索引，因为“has”是重复的，甚至符号和数字(表示为字符串)也有分配给它们的索引，因为它们也是由空格分隔的文本字符。因此，字典的最大长度也是 10。</p><p id="b7bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们创建一个由 0 作为元素的张量。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="cd04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jv">结果</em>是一个三维张量，其元素为两个矩阵(样本中元素的数量)。每个矩阵都有<em class="jv"> max_length </em>行数(这里是 6)和<em class="jv">max(token _ index . values())+1</em>列(这里是 10 + 1 = 11)。因此，我们现在有一个<strong class="is hj">形状张量(2，6，11)。</strong></p><p id="8f49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们用零作为元素，从之前的张量创建一个热表示。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="f4fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第一个 for 循环中，我们考虑每个句子及其在由<em class="jv">枚举返回的<strong class="is hj">枚举对象</strong>中的索引(示例)。</em></p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="jt ju l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">以上是为“示例”中的一个句子转换为列表的枚举对象。</figcaption></figure><p id="7c42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">枚举对象被转换成 l <strong class="is hj"> ist </strong>(代码在左边)，for 循环在单词列表元素上迭代。在下一行中，我们得到了<em class="jv"> token_index </em>中的<strong class="is hj"> (keys) </strong>的<strong class="is hj">值</strong>。例如在<em class="jv"> token_index </em>中‘Neptune’的值是 7。然后将前一个零张量中的位置索引<strong class="is hj">等于<em class="jv"> (i，j，index) </em>的元素设为 1。再次考虑我们之前的“Neptune”示例，这里我们从 0 开始对行和列进行计数，因为它属于第二个句子，所以 i = 1，这意味着它是合成张量中第二个矩阵的一部分，它是句子的第一个单词，所以它在第二个矩阵的第 0 行，并且它在 token_index 的第 7 列中的值将被设置为 1.0。</strong></p><p id="3440" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果是我们的<em class="jv">样本中句子的一个热点表示。</em>形状的张量(2，6，11)。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="ac63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们将“样本”中的数据表示为<strong class="is hj"> One hot。</strong></p></div></div>    
</body>
</html>