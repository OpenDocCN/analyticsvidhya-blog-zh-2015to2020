<html>
<head>
<title>Comparing Image Classification with Dense Neural Network and Convolutional Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">稠密神经网络和卷积神经网络在图像分类中的比较</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/comparing-image-classification-with-dense-neural-network-and-convolutional-neural-network-5f376582a695?source=collection_archive---------5-----------------------#2020-12-28">https://medium.com/analytics-vidhya/comparing-image-classification-with-dense-neural-network-and-convolutional-neural-network-5f376582a695?source=collection_archive---------5-----------------------#2020-12-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="07de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文将展示用于对40类人脸图像进行分类的深度神经网络模型的差异。</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jj"><img src="../Images/84302c07fbaa4fe47c1228d397acb693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQFFDF_yIpAHuOiHnSeBAA.png"/></div></div></figure><h1 id="59f9" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">介绍</h1><p id="6532" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">图像分类是使用机器学习实现的技术之一。这种方法也被称为计算机视觉，它允许计算机具有理解图像并将其分类到相应类别的能力。深度神经网络是机器学习的后续，即使用神经网络进行建模，通过反向传播来最小化损失函数。用于图像分类的最佳深度学习模型之一是卷积神经网络(CNN)，它被证明可以获得图像分类的最高精度。我将使用一个具有几个隐藏层的密集神经网络模型和一个卷积神经网络，将用于人脸识别的简单图像分类与40个不同的类别进行比较。</p><h1 id="442b" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">数据收集</h1><p id="8d9c" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">这个分类我得到的数据是我一个班的同学给我的。有40个人有不同的名字，每个名字对应于将要预测的类别。这些照片是用网络摄像头在一个在线会议应用平台上拍摄的，每个人从不同的角度拍摄10张照片。我们使用特定的背景图像来拍摄照片，使其更具一般性。</p><p id="3825" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是我们使用的背景图片。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ky"><img src="../Images/e724931547a974dd946c891132299b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZoQH4QjPjxxZPuBPtW7EWg.jpeg"/></div></div></figure><p id="3c9d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图像中的蓝色水平线将有助于眼睛的定位。然后，在得到照片后，我们将在黑色线条的正方形中裁剪图像，并将其整形为100 x 100像素。</p><p id="4d6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们从40个不同的类中得到400个100×100像素的图像，每个类有10个不同的图像。</p><h1 id="c3ae" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">数据处理</h1><p id="1cf8" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">我将使用<strong class="ig hi"> Tensorflow-Keras </strong> API来分离用于训练和测试的数据，训练数据，并对数据建模。处理完数据后，我们将数据分成70%用于培训，30%用于验证和测试。</p><p id="3e9d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我用的是<strong class="ig hi"> TensorFlow。keras . preprocessing . image _ dataset _ from _ directory</strong>包从一个目录创建一个数据集，并将数据分成70%和30%。这也将从文件目录中重新生成类名，由此我们得到了40个不同的类。</p><p id="7f3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们得到的数据是RGB图像。也就是说，每个图像将包含100×100×3，每个像素的范围从0到255。在我们得到两个不同的数据集，即训练数据集和验证数据集之后，我们使用MinMaxScaler来处理数据，并得出每个像素的范围从0到1。</p><h1 id="0c2a" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">建模</h1><p id="e34e" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">在这一部分中，使用了两个建模部分，密集神经网络和卷积神经网络。首先，我们将寻找密集的神经网络模型。</p><h2 id="5dc3" class="kz jw hh bd jx la lb lc kb ld le lf kf ip lg lh kj it li lj kn ix lk ll kr lm bi translated">密集神经网络/深度神经网络</h2><p id="9630" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">密集的神经网络意味着每个神经元都与下一层的每个神经元紧密相连。我将使用Tensorflow-Keras sequential来构建这个密集的神经网络模型。该模型有1个输入层、4个隐藏层和1个输出层。</p><p id="0483" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输入层是一个展平层，将从100x100x3三维张量输入到一维张量。第一个到最后一个隐藏层是一个密集连接的层，第一个隐藏层中有1024个神经元，第二个隐藏层中有512个神经元，第三个隐藏层中有256个神经元，最后一个隐藏层中有128个神经元。最后是输出层，这也是一个密集层，有40个神经元，对应于模型的每个类别。</p><p id="96cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这个模型中的每个隐藏层，我选择整流器线性单元作为激活函数，在输出层选择softmax激活。最后，我们用adam优化器编译模型，并使用稀疏分类交叉熵作为损失函数。</p><p id="e62e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是模型总结。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es ln"><img src="../Images/325babb1f051f7df73b06c61e990b3b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*-Peizu5KzOnv-gO8JwtCWg.png"/></div></figure><h2 id="648d" class="kz jw hh bd jx la lb lc kb ld le lf kf ip lg lh kj it li lj kn ix lk ll kr lm bi translated">卷积神经网络</h2><p id="ae6c" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">CNN(卷积神经网络)模型是一种使用卷积概念的深度学习模型。该模型最常用于机器学习中的图像分析。当使用CNN时，有一个称为conv2d的层，它接受张量的输入，并将二维核的大小指定为参数。</p><p id="5659" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的模型采用第一个输入图层，使用最小最大缩放器方法重新缩放图像，因此每个像素的值都在0和1之间。我们的模型有3个卷积层，每个卷积层的滤波器大小为32像素，内核大小为3x3。在每个卷积层之间，我们有一个最大图像采样池层，它采用pool_size中的最大值。</p><p id="0047" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在几个卷积层之后，我们用展平层展平图像，得到大小为3200的1维张量。然后，我们使用具有128个神经元的密集连接层和具有40个神经元的输出层，每个神经元代表一个类。</p><p id="25c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于激活函数，我在隐藏卷积层和隐藏密集层使用了整流器线性单元。并且使用softmax作为输出层中的激活函数来进行预测。然后，我们用adam作为优化器，用稀疏分类交叉熵作为损失函数来编译模型。</p><p id="ca7c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是模型总结。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lo"><img src="../Images/97949e132a8f5b0524eeacf4291bd039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*Yv-77GjuKkXNLOmww63tYA.png"/></div></figure><h1 id="3503" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">培养</h1><p id="0050" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">我使用一台个人电脑，通过启用GPU的Tensorflow API来训练数据。我用几个时期来训练模型，并使用验证数据集来验证数据。我还使用python时间包测量了训练数据所花费的时间。这是密集神经网络和卷积神经网络的训练结果。</p><h2 id="7841" class="kz jw hh bd jx la lb lc kb ld le lf kf ip lg lh kj it li lj kn ix lk ll kr lm bi translated">DNN</h2><p id="791b" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">我使用100个历元进行训练，并在训练数据时使用Keras早期停止进行回调。所得到的训练数据仅使用了20个时期，并且具有97%的准确度和83%的验证准确度。在这个模型中，训练20个历元所花费的时间大约是17.2秒。</p><h2 id="9aa1" class="kz jw hh bd jx la lb lc kb ld le lf kf ip lg lh kj it li lj kn ix lk ll kr lm bi translated">美国有线新闻网；卷积神经网络</h2><p id="43e4" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">对于CNN模型，我使用10个历元进行训练，而没有使用Keras提前停止进行回调。当训练数据完成10个时期时，它具有99%的准确度和94%的验证准确度。训练数据所需的时间在8.15秒左右。</p><h1 id="f0b7" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">结果</h1><p id="8f7b" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">两种模型的结果都显示了很好的图像分类效果。虽然DNN模型被认为是过度拟合的，因为当我测试测试数据时，训练数据的准确性很高，但它成功地对30幅图像中的27幅进行了正确分类。对于CNN模型，它显示了验证数据的更好的准确性，这意味着该模型更通用，而不仅仅是记忆训练数据。CNN模型成功地将30张图片中的29张分类正确。</p><h1 id="a232" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">准确度和损耗图</h1><p id="f92a" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">在得到DNN和CNN模型的训练结果后，我用Matplotlib库绘制了准确率和损失结果。它显示了两个模型的数据达到收敛。</p><h2 id="20c2" class="kz jw hh bd jx la lb lc kb ld le lf kf ip lg lh kj it li lj kn ix lk ll kr lm bi translated">DNN图</h2><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es lp"><img src="../Images/5c1bfca8649cf7fa8ac528053f078b97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eL4rUIKJfx66DZeejscflg.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">DNN模型的精确度和损失图。</figcaption></figure><h2 id="fd3a" class="kz jw hh bd jx la lb lc kb ld le lf kf ip lg lh kj it li lj kn ix lk ll kr lm bi translated">CNN图表</h2><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es lu"><img src="../Images/3d9f2b9f3c1350e8f5ccd722f5b89378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wO87ZPOUiHkTkGP084i00g.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">CNN模型的精确度和损失图。</figcaption></figure><h1 id="9743" class="jv jw hh bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">结论</h1><p id="c0cd" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip kv ir is it kw iv iw ix kx iz ja jb ha bi translated">在比较了DNN和CNN图像分类模型后，我们得出结论，CNN是图像分类的最佳解决方案。虽然在这个问题中，我使用了一张具有特定背景和相同大小的图像，这也使得用DNN进行图像分类仍然是可能的，并且得到了一个很好的结果。对于训练数据，在这个给定模型的特定问题中，DNN需要20个历元17秒的训练时间来达到收敛。而用CNN模型，只需要8秒的训练时间10个历元就能达到收敛。</p></div></div>    
</body>
</html>