<html>
<head>
<title>PYTORCH DATA LOADERS — 4 Types</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PYTORCH 数据加载器— 4 种类型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pytorch-data-loaders-4-types-6cd05074256b?source=collection_archive---------15-----------------------#2020-10-05">https://medium.com/analytics-vidhya/pytorch-data-loaders-4-types-6cd05074256b?source=collection_archive---------15-----------------------#2020-10-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0a51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将向您展示如何在 Pytorch 中设置数据加载器和转换器，您需要导入以下内容来完成相同的练习</p><p id="74a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">导入火炬视觉<br/>导入火炬<br/>导入 os <br/>导入 matplotlib.pyplot 为 plt <br/>导入 numpy 为 np </em></p><h1 id="98a5" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">MNIST 数据集</h1><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es kc"><img src="../Images/e7620493a3de60425cfd89c7d99be1f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*Ft2rLuO82eItlvJn5HOi9A.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">MNIST 数据集(图像源维基)</figcaption></figure><h1 id="f5fe" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> 1。定义转换</strong></h1><p id="09c3" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">图像调整大小(256，256)或任何其他大小<br/>转换为 Pytorch 张量<br/>通过调用 torch vision . transform . Normalize 来规格化图像</p><p id="f815" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">transform _ img = torch vision . transforms . compose([torch vision . transforms . resize((256，256))，<br/>torch vision . transforms . totensor()，<br/>torch vision . transforms . normalize(mean =[0.485]，STD =[0.229]))])</em></p><h1 id="1763" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">2.从 torchvision.datasets 创建数据集</h1><p id="e3f8" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">设置一些目录路径，download = True 将数据下载到指定的目录中，transform 应该设置为上面定义的 transform</p><p id="579e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">dir _ path = ' C:\ \ Users \ \ Asus \ \ py torch-basics-part 2 '</em></p><p id="1985" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">dataset _ Mn ist _ train = torch vision . datasets . Mn ist(dir _ path，train=True，transform=transform_img，<br/> target_transform=None，download=True) </em></p><p id="fd6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以索引这个数据集，dataset_mnist_train[i]将包含(Image，Label)的元组。</p><h1 id="0e9e" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">3.创建数据加载器</h1><p id="6def" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">这里重要的是，batch_size 应根据应用设置为 8、16 或 32，Batch_size=1 将使模型非常慢，因为较高的批处理大小将需要更多的 GPU 内存。设置 Shuffle = True。</p><p id="c57b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">data loader _ mnist _ train = torch . utils . data . data loader(dataset _ mnist _ train，batch_size=32，<br/> shuffle=True，num_workers=1) </em></p><h1 id="0491" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> 4。检查数据</strong></h1><p id="ee48" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">现在，您可以按如下方式使用此数据加载器</p><p id="edf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> images，classes = next(ITER(data loader _ mnist _ train))</em></p><p id="4263" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运筹学</p><p id="69a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">对于图像，dataloader_mnist_train 中的类:<br/>print(image . shape)<br/>print(class)</em></p><p id="fc4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，图像的批量大小为 32，因为我们创建了 32 个批量大小的数据加载器，同时请注意，每个图像的标签将有 32 个值</p><pre class="kd ke kf kg fd kt ku kv kw aw kx bi"><span id="ff1d" class="ky jf hi ku b fi kz la l lb lc">torch.Size([32, 1, 256, 256])<br/>tensor([7, 0, 9, 6, 2, 5, 6, 3, 3, 2, 7, 6, 7, 9, 2, 6, 0, 2, 1, 6, 8, 0, 0, 8,<br/>        3, 4, 3, 8, 5, 0, 8, 9])<br/>torch.Size([32, 1, 256, 256])<br/>tensor([9, 8, 0, 5, 4, 4, 0, 1, 4, 0, 2, 6, 3, 0, 4, 0, 2, 0, 1, 6, 0, 8, 6, 1,<br/>        2, 4, 0, 7, 3, 5, 1, 0])<br/>torch.Size([32, 1, 256, 256])<br/>tensor([1, 2, 4, 5, 6, 3, 5, 1, 8, 5, 9, 6, 9, 2, 5, 5, 1, 1, 8, 2, 2, 1, 3, 3,<br/>        1, 1, 0, 3, 4, 2, 7, 2])<br/>torch.Size([32, 1, 256, 256])<br/>tensor([5, 8, 7, 2, 8, 1, 7, 4, 1, 0, 8, 3, 1, 1, 5, 1, 1, 4, 0, 1, 0, 2, 6, 1,<br/>        2, 6, 9, 9, 5, 1, 4, 4])</span></pre><h1 id="2a6c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">打印图像</strong></h1><p id="c253" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">定义一个小函数将 Torch 张量转换为 numpy 数组</p><p id="cec7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">def</em>T34<em class="jd">convert _ to _ numpy(InP)</em><em class="jd">:<br/>InP = InP . numpy()。transpose((1，2，0)) <br/> mean = np.array([0.485，0.456，0.406])<br/>STD = NP . array([0.229，0.224，0.225])<br/>InP = STD * InP+mean<br/>InP = NP . clip(InP，0，1) <br/> return inp </em></p><p id="3935" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">批量制作 32 幅图像的网格</strong></p><p id="5fb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> images，classes = next(ITER(data loader _ mnist _ train))<br/>images . shape</em></p><pre class="kd ke kf kg fd kt ku kv kw aw kx bi"><span id="5fb1" class="ky jf hi ku b fi kz la l lb lc">torch.Size([32, 1, 256, 256])</span></pre><p id="ef6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">grid _ image = torch vision . utils . make _ grid(images)<br/>out . shape</em></p><pre class="kd ke kf kg fd kt ku kv kw aw kx bi"><span id="fa72" class="ky jf hi ku b fi kz la l lb lc">torch.Size([3, 1034, 2066])</span></pre><p id="cb82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">images _ numpy = convert _ to _ numpy(out)<em class="jd"><br/>PLT . im show(images _ numpy)</em></p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ld"><img src="../Images/21b451d85657867910fe97ade215c2db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vNFPokJexx3IoqlltoGDqg.png"/></div></div></figure><h1 id="0c9c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">时尚达人数据集</strong></h1><p id="bd04" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">与 MNIST 数据非常相似的程序，(1)创建图像转换器(2)从 torch vision . datasets . fashion mnist 创建时尚 mnist 数据(3)创建数据加载器。这一次，我们选择了批量大小为 8</p><p id="098b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">transform _ img</em></strong><em class="jd">= torch vision . transforms . compose([torch vision . transforms . resize((256，256))，<br/>torch vision . transforms . totensor()，<br/>torch vision . transforms . normalize(</em><strong class="ih hj"><em class="jd">mean =[0.485]，STD =[0.229]</em></strong><em class="jd">))</em></p><p id="90a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">dataset _ fashion _ mnist _ train</em></strong><em class="jd">= torch vision . datasets .</em><strong class="ih hj"><em class="jd">fashion mnist</em></strong><em class="jd">(dir _ path，train=True，transform=transform_img，<br/> target_transform=None，download=True) </em></p><p id="ddbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">data loader _ fashion mnist _ train</em></strong><em class="jd">= torch . utils . data . data loader(dataset _ fashion _ mnist _ train，batch_size=8，<br/> shuffle=True，num_workers=4) </em></p><p id="da58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">打印样本图像</strong></p><p id="094a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">图片，类</em></strong><em class="jd">= next(ITER(</em><strong class="ih hj"><em class="jd">data loader _ fashion mnist _ train</em></strong><em class="jd">)<br/></em><strong class="ih hj"><em class="jd">grid _ images</em></strong><em class="jd">= torch vision . utils . make _ grid(</em><strong class="ih hj"><em class="jd">图片</em> </strong> <em class="jd"> ) <br/> </em></p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es li"><img src="../Images/eecad2137e51e965aca8ebe6bf00de1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bWT0yojh-4BzU-87OvxCmA.png"/></div></div></figure><h1 id="08f6" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> SBU 数据集</strong></h1><p id="76b7" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">SBU 数据集包含以目标/标注作为图像标题(文本)的图像</p><p id="b89b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据下载/转换和数据加载器创建非常类似于 MNIST 和时尚 MNIST，唯一的区别是 SBU 数据有彩色图像，每个图像将有 3 个通道(R，G，B)</p><p id="2a16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">dir _ path</em></strong><em class="jd">= ' C:\ \ Users \ \ Asus \ \ py torch-basics-part 2 '<br/></em><strong class="ih hj"><em class="jd">transform _ img</em></strong><em class="jd">= torch vision . transforms . compose([<br/>torch vision . transforms . resize(256)，<br/>torch vision . transforms . center crop(224)，<br/> torchvision</em></p><p id="4a5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">dataset _ sbu _ train</em></strong><em class="jd">=</em><strong class="ih hj"><em class="jd">torch vision . datasets . sbu</em></strong><em class="jd">(</em><strong class="ih hj"><em class="jd">dir _ path</em></strong><em class="jd">，transform =</em><strong class="ih hj"><em class="jd">transform _ img</em></strong><em class="jd">，target_transform=None，download=True) </em></p><p id="b082" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">data loader _ sbu _ train</em></strong><em class="jd">=</em><strong class="ih hj"><em class="jd">torch . utils . data . data loader</em></strong><em class="jd">(</em><strong class="ih hj"><em class="jd">dataset _ sbu _ train</em></strong><em class="jd">，batch_size=8，<br/> shuffle=True，num_workers=4) </em></p><p id="ef82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">检查数据并打印图像</strong></p><p id="bcb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> images，classes = next(ITER(data loader _ sbu _ train))<br/></em><strong class="ih hj"><em class="jd">grid _ images</em></strong><em class="jd">= torch vision . utils .</em><strong class="ih hj"><em class="jd">make _ grid</em></strong><em class="jd">【images】<br/>images _ numpy = convert _ to _ numpy(</em><strong class="ih hj"><em class="jd">grid _ images</em></strong></p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es li"><img src="../Images/94987ca05961a63ecadeb2cf4cca6665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9prO5jcth0xtNE60Szcv6w.png"/></div></div></figure><p id="0d27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">打印(类)### </em> <strong class="ih hj"> <em class="jd">这些都是图片说明文字</em> </strong></p><pre class="kd ke kf kg fd kt ku kv kw aw kx bi"><span id="4ba6" class="ky jf hi ku b fi kz la l lb lc">(' I love that little white hippie van in front of us.', " The first-floor women's bathroom in Canaday library is covered with pun-filled graffiti like this.  I cannot resist a pun!", ' There is a black cat in my back yard', ' Tools and bearings all over the floor a sure sign of work being done!', ' we stopped to check on the geese (who are off in the lake to the left of the frame) on our morning bike ride.', ' bowl of fruit (that was consumed by me soon after this was taken)', ' Stained glass window in the Ridderzaal', ' Rachel up in the tree house that is still being built.')</span></pre><p id="3d25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">你可以观看我的 Youtube 视频，了解这些数据加载器的详细说明</strong></p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="a05a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Youtube 频道:<a class="ae ll" href="https://www.youtube.com/c/nagarajbmachinelearning" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/c/nagarajbmachinelearning</a></p></div></div>    
</body>
</html>