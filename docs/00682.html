<html>
<head>
<title>CERN | GSoC’19: Generative Adversarial Networks for Particle Physics Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CERN | GSoC'19:粒子物理应用的生成对抗网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cern-gsoc19-generative-adversarial-networks-for-particle-physics-applications-c3da13a3f44b?source=collection_archive---------14-----------------------#2019-08-25">https://medium.com/analytics-vidhya/cern-gsoc19-generative-adversarial-networks-for-particle-physics-applications-c3da13a3f44b?source=collection_archive---------14-----------------------#2019-08-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8796f55f7448b5a16ff97c83f4defd39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8DG-Q7Vkan5wx2NQ6YsjEQ.png"/></div></div></figure><figure class="ir is it iu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es iq"><img src="../Images/2361997c25c057f3dcd6f2a683168030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*viS5c2p_1gbIQ9oYsr5Mvg.jpeg"/></div></div></figure><p id="803f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">三个月前，我被选为<a class="ae jt" href="https://home.cern/" rel="noopener ugc nofollow" target="_blank"> CERN-HSF </a>的<a class="ae jt" href="https://summerofcode.withgoogle.com" rel="noopener ugc nofollow" target="_blank">谷歌代码之夏</a>学生，在<a class="ae jt" href="https://root.cern/tmva" rel="noopener ugc nofollow" target="_blank"> TMVA(多变量分析工具包)图书馆</a>从事“粒子物理应用的生成对抗网络(GANs)”项目。这段旅程真的很棒，我喜欢在CERN组织下工作，也学到了很多东西。</p><p id="3589" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae jt" href="https://root.cern/" rel="noopener ugc nofollow" target="_blank"> ROOT </a>是由CERN开发的模块化科学工具包，提供处理大数据处理、统计分析、可视化和存储所需的所有功能。<a class="ae jt" href="https://root.cern/tmva" rel="noopener ugc nofollow" target="_blank"> TMVA </a>是一个根集成项目，为高能物理中多变量分类和回归目标应用的训练和评估提供机器学习环境。</p><p id="3fb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该项目的主要目标是为生成性对抗网络建立一个基础，并为TMVA的GANs开发一个模型。</p><h1 id="6dd6" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">生成对抗网络导论</h1><p id="bb12" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">生成对抗网络是最有趣的深度学习模型之一。两个模型通过对抗过程联合训练:</p><ol class=""><li id="3fb6" class="kx ky hi ix b iy iz jc jd jg kz jk la jo lb js lc ld le lf bi translated">生成器学习创建看起来真实的图像。</li><li id="acca" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated">鉴别器学习辨别图像是真实的(来自数据集)还是伪造的(来自生成器)。</li></ol><h2 id="a181" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">鉴别器模型</h2><p id="1931" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">该模型的功能类似于卷积神经网络(CNN)。鉴别器是由许多隐藏层和一个输出层组成的CNN。鉴别器通过在真实数据上训练来学习实际图像看起来如何以及真实数据应该包含什么特征。因此，鉴别器的输出可以是0或1，其中0表示鉴别器将输入数据分类为假数据(从生成器采样)，1表示它将输入数据分类为实数据(从实分布采样)</p><h2 id="35d2" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">发电机模型</h2><p id="5d20" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">生成器负责生成图像，有效地反转了CNN的功能。在CNN中，我们传递一个图像作为输入，图像的标签作为输出。相反，在生成器中，随机生成的噪声作为输入给出。</p><p id="17ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，发生器将这种噪声转换成有意义的输出。噪声通常从比输出空间的维度更小的维度上的分布中被采样。</p><h2 id="811d" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">训练甘斯</h2><p id="9b5f" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">在训练期间，发生器在创建看起来真实的图像方面逐渐变得更好，而鉴别器在区分生成的样本和实际样本方面变得更好。当鉴别器不再能够区分真实图像和赝品时，就达到了平衡。</p><h1 id="9e81" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">GANs的层数</h1><p id="6260" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">正如我们所知，在生成图像的过程中，生成器需要增加输出的维度，因此，我们在生成器模型中采用了层来实现这一点。</p><p id="80b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TMVA拥有卷积层和最大池层等图层，可对输入张量进行下采样，并将其转换为低维张量。因此，我们引入了像上采样和转置卷积层这样的层，它们将对给定的张量进行上采样，因此，我们可以获得更高维的张量。</p><h2 id="60b4" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">TMVA一层的结构</h2><p id="4ee6" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">TMVA不支持3D张量数据结构(尽管目前正在引入RTensor)。因此，对于任何3D输入，我们需要将3D输入张量转换为2D矩阵，然后可以执行相应的操作。每一层执行相应的正向传递和反向传递。</p><h1 id="ef0c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">上采样层</h1><p id="0d04" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">上采样层是一个简单的层，通常不需要任何过滤器/权重。它增加了输入的维度，因此可用于卷积层之后的生成模型。它也可以被认为是一个反向的池层。</p><h2 id="d148" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">工作</h2><p id="2fb6" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">这里介绍一种简单的上采样变体，即最近邻插值技术。在最近邻插值中，我们将输出图像中每个像素的值确定为输入图像中最近邻的值，如下图所示。</p><p id="c92b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">考虑最近邻插值的简单例子，其中我们将矩阵A (3x3)上采样为更高维的矩阵B (6x6)。</p><figure class="ir is it iu fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/a194d367a04143b3f5069fc8b5f2d6fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/0*m0EUXlbbOPx7_5RX"/></div><figcaption class="ma mb et er es mc md bd b be z dx translated">最近邻插值</figcaption></figure><h1 id="babc" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">转置卷积层</h1><p id="3eff" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">转置卷积运算等效于常规卷积的梯度计算(常规卷积的反向传递)。我们可以用它来增加张量的维数，而不是使用预定义的插值技术。</p><h2 id="1d73" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">工作</h2><p id="007d" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">这里使用的转置卷积技术最好用一个例子来描述:考虑一个输入矩阵A(2×2)和一个核矩阵B(4×4)。</p><h2 id="bd6e" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">生成转置卷积矩阵</h2><p id="cc64" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">我们用矩阵来表示转置卷积运算。它只不过是一个重新排列的核矩阵，因此我们可以使用矩阵乘法来执行转置卷积运算。在上面的例子中，为了得到大小为7×1的输出向量，我们生成大小为7×4的转置卷积矩阵。</p><figure class="ir is it iu fd ij er es paragraph-image"><div class="er es me"><img src="../Images/709a839e97e446a13faa7a33392e98fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/0*kzRNGQmzbau33UwD"/></div></figure><p id="8caa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我们将4x4内核重新安排为7x4内核。</p><h2 id="230d" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">将输入转换成单个列向量。</h2><p id="a9cb" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">这里，我们将输入矩阵(2x2)展平成一个列向量(4x1)</p><figure class="ir is it iu fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/dbb93f5413aab680265cb996b846157a.png" data-original-src="https://miro.medium.com/v2/resize:fit:252/0*dg61d0iBy6K0Y6Rc"/></div></figure><h2 id="3bfb" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">生成相应的输出向量</h2><p id="c501" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">因此，我们通过将转置卷积矩阵与输入向量相乘来生成输出向量。</p><figure class="ir is it iu fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/f92d944e6614d6d0757c2fc2070149e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/0*JWFUb3M1qn3zjdPf"/></div></figure><h1 id="adce" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">TMVA DNN模块中的GANs</h1><p id="7177" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">类MethodGAN ( GAN模块)包含了GAN的实际实现。MethodGAN为用户定义自己的GANs架构提供了灵活性，因为架构作为输入传递到模型上，MethodGAN由各种解析函数组成，这些函数在解析架构输入字符串后创建模型。</p><p id="a7ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在粒子物理中，生成对抗网络在生成图像方面非常有用，作为实验的替代方案，我们需要执行大量实验并以图像的形式生成结果。</p><figure class="ir is it iu fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/4dc0b080618a77637eaa3e29e971ac4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*ZgQXqlD10gyGDxE-3YMdHA.jpeg"/></div><figcaption class="ma mb et er es mc md bd b be z dx translated">TMVA甘斯建筑</figcaption></figure><h1 id="be7a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">未来的工作</h1><ul class=""><li id="982f" class="kx ky hi ix b iy ks jc kt jg mi jk mj jo mk js ml ld le lf bi translated">为发生器和鉴别器实现独立的损耗函数。</li><li id="18ae" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js ml ld le lf bi translated">增加了对高能物理应用的gan的其他变体的支持。</li><li id="0d90" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js ml ld le lf bi translated">用其他标准实现对结果进行基准测试。</li></ul><h2 id="c4b6" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">感谢</h2><p id="484e" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">我衷心感谢我的所有导师<em class="mm"> Lorenzo Moneta、Manos Stergiadis、Sergei Gleyzer、Omar Andres Zapata Mesa、Sitong An、Stefan Wunsch、Kim Albertsson和Gerardo Gutiérrez </em>在整个开发过程中为我提供指导，帮助我做出实施决策，处理技术问题，并在周会上提供宝贵的意见。</p><p id="451a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我还要感谢<a class="ae jt" rel="noopener" href="/@anushreerankawat110"> <em class="mm"> Anushree Rankawat </em> </a>帮助我理解现有的代码库，并帮助解决其他实现问题。</p><p id="5543" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谷歌代码之夏帮助我成为这样一个伟大社区的一部分，并给了我一个在这样一个令人兴奋的项目上工作的机会。</p><p id="4a6b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，和Surya Dwivedi一起工作也是一次很棒的经历。</p><h2 id="8bd9" class="ll jv hi bd jw lm ln lo ka lp lq lr ke jg ls lt ki jk lu lv km jo lw lx kq ly bi translated">重要链接:</h2><p id="78b0" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">链接到上采样层和转置层的实现:PR-4146</p><p id="cafb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">链接到GANs代码:<a class="ae jt" href="https://github.com/Ask149/root/tree/dev/ashish/temp" rel="noopener ugc nofollow" target="_blank"> GANs实施</a></p><p id="b37b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其他链接:<a class="ae jt" href="https://github.com/root-project/root/pull/4275" rel="noopener ugc nofollow" target="_blank"> PR-4275 </a></p></div></div>    
</body>
</html>