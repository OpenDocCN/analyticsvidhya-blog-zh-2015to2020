# å¼ºåŒ–å­¦ä¹ :æ—¶é—´å·®å¼‚å­¦ä¹ ç®€ä»‹

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/nuts-and-bolts-of-reinforcement-learning-introduction-to-temporal-difference-td-learning-a0624eb3b985?source=collection_archive---------1----------------------->

å½“ DeepMind æå‡ºä¸€ç§åœ¨é›…è¾¾åˆ©æ¸¸æˆä¸Šè¾¾åˆ°è¶…äººæ°´å¹³çš„ç®—æ³•æ—¶ï¼ŒQ-learning æˆä¸ºäº†æ•°æ®ç§‘å­¦ä¸­ä¸€ä¸ªå®¶å–»æˆ·æ™“çš„åå­—ã€‚è¿™æ˜¯å¼ºåŒ–å­¦ä¹ çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ä¹‹ä¸€ã€‚æ¯å½“æˆ‘é˜…è¯»å…³äº RL çš„èµ„æ–™æ—¶ï¼Œæˆ‘ç»å¸¸ä¼šç¢°åˆ° Q-learningã€‚

![](img/42664d1da732a70e8184c5c4516d509c.png)

ä½†æ˜¯ Q-learning å’Œæˆ‘ä»¬çš„æ—¶é—´å·®å¼‚å­¦ä¹ è¿™ä¸ªè¯é¢˜æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿè®©æˆ‘ä¸¾ä¸ªä¾‹å­æ¥ç›´è§‚åœ°è¯´æ˜æ—¶é—´å·®å¼‚å­¦ä¹ æ˜¯æ€ä¹ˆå›äº‹ã€‚

Rajesh è®¡åˆ’å¼€è½¦ä»å¾·é‡Œå»æ–‹æµ¦å°”ã€‚åœ¨è°·æ­Œåœ°å›¾ä¸Šå¿«é€ŸæŸ¥çœ‹æ˜¾ç¤ºï¼Œä»–çš„è¡Œç¨‹ä¼°è®¡ä¸º 5 å°æ—¶ã€‚ä¸å¹¸çš„æ˜¯ï¼Œç”±äºè·¯éšœï¼Œå‡ºç°äº†æ„å¤–çš„å»¶è¿Ÿ(ä»»ä½•é•¿é€”æ—…è¡Œçš„äººéƒ½ä¼šæœ‰åŒæ„Ÿï¼).æ‹‰æ°ä»€çš„é¢„è®¡åˆ°è¾¾æ—¶é—´ç°åœ¨ä¸Šå‡åˆ°äº† 5 å°æ—¶ 30 åˆ†é’Ÿã€‚

![](img/7b06925f11283c95be9701777fcd7c53.png)

åŠè·¯ä¸Šï¼Œä»–æ‰¾åˆ°äº†ä¸€æ¡æ”¯è·¯ï¼Œç¼©çŸ­äº†ä»–çš„åˆ°è¾¾æ—¶é—´ã€‚æ‰€ä»¥æ€»çš„æ¥è¯´ï¼Œä»–ä»å¾·é‡Œåˆ°æ–‹æµ¦å°”çš„æ—…ç¨‹éœ€è¦ 5 å°æ—¶ 10 åˆ†é’Ÿã€‚

![](img/071d21bce3e8529c1f71ba719009a78c.png)

ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ° Rajesh çš„åˆ°è¾¾æ—¶é—´æ˜¯å¦‚ä½•æ ¹æ®ä¸åŒçš„å‰§é›†ä¸æ–­å˜åŒ–å’Œæ›´æ–°çš„ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œè¿™è¯´æ˜äº†æ—¶é—´å·®å¼‚å­¦ä¹ æ¦‚å¿µã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨è¯¦ç»†ä»‹ç»è¿™ç§ç®—æ³•åŠå…¶ç»„ä»¶ï¼ŒåŒ…æ‹¬ Q-learning å¦‚ä½•èå…¥å…¶ä¸­ã€‚æˆ‘ä»¬è¿˜å°†æŒ‘é€‰ä¸€ä¸ªæ¡ˆä¾‹ç ”ç©¶ï¼Œå¹¶ç”¨ Python æ¥è§£å†³å®ƒã€‚

è¿™æ˜¯æœ€æœ‰è¶£çš„å¼ºåŒ–å­¦ä¹ æ¦‚å¿µä¹‹ä¸€ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬äº«å—å­¦ä¹ çš„ä¹è¶£å§ï¼

# ç›®å½•

*   æ—¶å·®å­¦ä¹ ç®€ä»‹
*   æ”¿ç­–å¤–å­¦ä¹ ä¸æ”¿ç­–å†…å­¦ä¹ 
*   Q-learning:éç­–ç•¥æ—¶é—´å·®å¼‚å­¦ä¹ 
*   SARSA:åŸºäºç­–ç•¥çš„æ—¶é—´å·®å¼‚å­¦ä¹ 
*   æ¡ˆä¾‹ç ”ç©¶:ä½¿ç”¨ Python ä¸­çš„ Q-learning è¿›è¡Œå‡ºç§Ÿè½¦è°ƒåº¦

# æ—¶å·®å­¦ä¹ ç®€ä»‹

æˆ‘ä»¬åœ¨å¼•è¨€ä¸­å‘å±•äº†ä¸€ç§å¯¹æ—¶é—´å·®å¼‚å­¦ä¹ çš„ç›´è§‰ã€‚ç°åœ¨è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°ç†è§£å®ƒã€‚

åœ¨æˆ‘çš„[ä¸Šä¸€ç¯‡å…³äºè’™ç‰¹å¡ç½—å­¦ä¹ ](https://www.analyticsvidhya.com/blog/2018/11/reinforcement-learning-introduction-monte-carlo-learning-openai-gym/?utm_source=blog&utm_medium=reinforcement-learning-temporal-difference)çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å½“ç¯å¢ƒçš„æ¨¡å‹åŠ¨æ€äº‹å…ˆæœªçŸ¥æ—¶ï¼Œå¦‚ä½•ä½¿ç”¨å®ƒæ¥è§£å†³é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹(MDP)ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç”¨é‚£ä¸ªä»£æ›¿ TD å‘¢ï¼Ÿ

å—¯ï¼Œè™½ç„¶è’™ç‰¹å¡ç½—å­¦ä¹ ä¸ºæ— æ¨¡å‹å­¦ä¹ æä¾›äº†ä¸€ç§æœ‰æ•ˆè€Œç®€å•çš„æ–¹æ³•ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›å±€é™æ€§ã€‚å®ƒåªèƒ½åº”ç”¨äºå¶å°”å‘ç”Ÿçš„ä»»åŠ¡ã€‚

ä¸€ä¸ªé˜¶æ®µæ€§çš„ä»»åŠ¡æŒç»­æœ‰é™çš„æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œä¸‹ä¸€ç›˜æ£‹æ˜¯ä¸€ä¸ªé˜¶æ®µæ€§çš„ä»»åŠ¡ï¼Œä½ ä¼šèµ¢æˆ–è¾“ã€‚å¦‚æœä¸€é›†å¾ˆé•¿(å¾ˆå¤šæƒ…å†µä¸‹éƒ½æ˜¯è¿™æ ·)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»ç­‰å¾…å¾ˆé•¿æ—¶é—´æ¥è®¡ç®—ä»·å€¼å‡½æ•°ã€‚

æ—¶é—´å·®åˆ†(TD)å­¦ä¹ æ˜¯ä¸€ç§æ— æ¨¡å‹å­¦ä¹ ç®—æ³•ï¼Œå…·æœ‰ä¸¤ä¸ªé‡è¦ç‰¹æ€§:

*   å®ƒä¸éœ€è¦é¢„å…ˆçŸ¥é“æ¨¡å‹åŠ¨åŠ›å­¦
*   å®ƒä¹Ÿå¯ä»¥åº”ç”¨äºéå¶å‘ä»»åŠ¡

![](img/7f3d917546f387695ac675c89d0442d6.png)

TD å­¦ä¹ ç®—æ³•æ˜¯ç”±ä¼Ÿå¤§çš„ Richard Sutton åœ¨ 1988 å¹´æå‡ºçš„ã€‚è¯¥ç®—æ³•åŒæ—¶è€ƒè™‘äº†è’™ç‰¹å¡ç½—æ–¹æ³•å’ŒåŠ¨æ€è§„åˆ’(DP)çš„ä¼˜ç‚¹:

*   åƒè’™ç‰¹å¡ç½—æ–¹æ³•ä¸€æ ·ï¼Œå®ƒä¸éœ€è¦æ¨¡å‹åŠ¨åŠ›å­¦ï¼Œè€Œä¸”
*   å’ŒåŠ¨æ€è§„åˆ’ä¸€æ ·ï¼Œå®ƒä¸éœ€è¦ç­‰åˆ°ä¸€é›†ç»“æŸçš„æ—¶å€™æ‰åšå‡ºä»·å€¼å‡½æ•°çš„ä¼°è®¡

ç›¸åï¼Œæ—¶é—´å·®å¼‚å­¦ä¹ åŸºäºå…ˆå‰å­¦ä¹ çš„ä¼°è®¡æ¥é€¼è¿‘å½“å‰ä¼°è®¡ã€‚è¿™ç§æ–¹æ³•ä¹Ÿç§°ä¸ºå¼•å¯¼ã€‚

# è·å¾— TD é¢„æµ‹èƒŒåçš„ç›´è§‰

æˆ‘ä»¬è¯•å›¾åœ¨æ—¶é—´å·®å¼‚å­¦ä¹ ä¸­é¢„æµ‹çŠ¶æ€å€¼ï¼Œå°±åƒæˆ‘ä»¬åœ¨è’™ç‰¹å¡ç½—é¢„æµ‹å’ŒåŠ¨æ€è§„åˆ’é¢„æµ‹ä¸­æ‰€åšçš„é‚£æ ·ã€‚åœ¨è’™ç‰¹å¡æ´›é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç®€å•åœ°è·å–æ¯ä¸ªçŠ¶æ€çš„å¹³å‡å›æŠ¥æ¥ä¼°è®¡ä»·å€¼å‡½æ•°ï¼Œè€Œåœ¨åŠ¨æ€è§„åˆ’å’Œ TD å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å½“å‰çŠ¶æ€æ¥æ›´æ–°å…ˆå‰çŠ¶æ€çš„å€¼ã€‚ä½†æ˜¯ TD å­¦ä¹ ä¸åƒ DP é‚£æ ·éœ€è¦ç¯å¢ƒçš„æ¨¡å‹ã€‚

æˆ‘ä»¬å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼ŸTD å­¦ä¹ ä½¿ç”¨ç§°ä¸º TD æ›´æ–°è§„åˆ™çš„ä¸œè¥¿æ¥æ›´æ–°çŠ¶æ€çš„å€¼:

![](img/03db325e1249347ab8e546d91ca97bb7.png)

å‰ä¸€çŠ¶æ€å€¼=å‰ä¸€çŠ¶æ€å€¼+ learning_rate *(å¥–åŠ±+æŠ˜æ‰£ _ å› å­(å½“å‰çŠ¶æ€å€¼)-å‰ä¸€çŠ¶æ€å€¼)

è¿™ä¸ªç­‰å¼å®é™…ä¸Šæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

è¿™æ˜¯**å®é™…æŠ¥é…¬(r + Gamma * V(s'))** å’ŒæœŸæœ›æŠ¥é…¬ **V(s)** ä¹‹å·®ä¹˜ä»¥å­¦ä¹ ç‡Î±ã€‚

å­¦ä¹ ç‡æ„å‘³ç€ä»€ä¹ˆï¼Ÿ

å­¦ä¹ ç‡ï¼Œä¹Ÿç§°ä¸ºæ­¥é•¿ï¼Œå¯¹æ”¶æ•›å¾ˆæœ‰ç”¨ã€‚

å› ä¸ºæˆ‘ä»¬å–å®é™…å€¼å’Œé¢„æµ‹å€¼ä¹‹é—´çš„å·®å€¼ï¼Œè¿™å°±åƒä¸€ä¸ªè¯¯å·®ã€‚æˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸º **TD è¯¯å·®**ã€‚æ³¨æ„ï¼Œæ¯æ¬¡çš„ TD è¯¯å·®æ˜¯å½“æ—¶ä¼°è®¡çš„è¯¯å·®ã€‚å› ä¸º TD è¯¯å·®å–å†³äºä¸‹ä¸€ä¸ªçŠ¶æ€å’Œä¸‹ä¸€ä¸ªå¥–åŠ±ï¼Œæ‰€ä»¥å®é™…ä¸Šç›´åˆ°ä¸€ä¸ªæ—¶é—´æ­¥é•¿ä¹‹åæ‰å¯ç”¨ã€‚è¿­ä»£åœ°ï¼Œæˆ‘ä»¬å°†å°è¯•æœ€å°åŒ–è¿™ä¸ªè¯¯å·®ã€‚

## ä»¥å†°æ¹–ä¸ºä¾‹ç†è§£ TD é¢„æµ‹

è®©æˆ‘ä»¬ä»¥å†°æ¹–ä¸ºä¾‹æ¥ç†è§£ TD é¢„æµ‹ã€‚æ¥ä¸‹æ¥æ˜¾ç¤ºçš„æ˜¯å†°å†»çš„æ¹–æ³Šç¯å¢ƒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†å€¼å‡½æ•°åˆå§‹åŒ–ä¸º 0ï¼Œå¦‚ V(S)ä¸­æ‰€æœ‰çŠ¶æ€çš„ 0ï¼Œå¦‚ä¸‹é¢çš„çŠ¶æ€-å€¼å›¾æ‰€ç¤º:

![](img/b1ecd89df5a92dd2c13b11fca314bc44.png)

å‡è®¾æˆ‘ä»¬å¤„äºä¸€ä¸ªèµ·å§‹çŠ¶æ€(1ï¼Œ1)ï¼Œæˆ‘ä»¬é‡‡å–äº†ä¸€ä¸ªæ­£ç¡®çš„è¡ŒåŠ¨ï¼Œå¹¶ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€(1ï¼Œ2)ï¼Œå¾—åˆ°çš„å›æŠ¥(r)ä¸º-0.4ã€‚

æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥æ›´æ–°çŠ¶æ€çš„å€¼å‘¢ï¼Ÿå›æƒ³ä¸€ä¸‹ TD æ›´æ–°å…¬å¼:

![](img/9cf9785e025d5f00b412c52bb1a40b93.png)

è®©æˆ‘ä»¬è€ƒè™‘å­¦ä¹ ç‡(Î±)ä¸º 0.1ï¼Œè´´ç°å› å­()ä¸º 0.5ï¼›æˆ‘ä»¬çŸ¥é“çŠ¶æ€(1ï¼Œ1)çš„å€¼ï¼Œå¦‚åœ¨ v(s)ä¸­ï¼Œæ˜¯ 0ï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€(1ï¼Œ2)çš„å€¼ï¼Œå¦‚åœ¨ V(sâ€™)ä¸­ï¼Œä¹Ÿæ˜¯ 0ã€‚æˆ‘ä»¬è·å¾—çš„å›æŠ¥(r)æ˜¯-0.3ã€‚æˆ‘ä»¬åœ¨ TD è§„åˆ™ä¸­æ›¿æ¢å¦‚ä¸‹:

V(s) = 0 + 0.1 [ -0.4 + 0.5 (0)-0]

V(s) = â€” 0.04

å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å€¼è¡¨ä¸­å°†çŠ¶æ€(1ï¼Œ1)çš„å€¼æ›´æ–°ä¸º-0.04ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:

![](img/919cddbc2bb7f3abd1a73b7a9daff4f7.png)

ç°åœ¨æˆ‘ä»¬åœ¨çŠ¶æ€ as (1ï¼Œ2)ï¼Œæˆ‘ä»¬é‡‡å–ä¸€ä¸ªè¡ŒåŠ¨æƒåˆ©ï¼Œå¹¶ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€(sâ€™)(1ï¼Œ3)ï¼Œå¹¶æ”¶åˆ°å¥–åŠ±(r) -0.4ã€‚æˆ‘ä»¬ç°åœ¨å¦‚ä½•æ›´æ–° state (1ï¼Œ2)çš„å€¼ï¼Ÿæˆ‘ä»¬å°†æ›¿æ¢ TD æ›´æ–°ç­‰å¼ä¸­çš„å€¼:

V(s) = 0 + 0.1 [ -0.4 + 0.5(0)-0 ]

V(s) = -0.04

ç»§ç»­åœ¨å€¼è¡¨ä¸­å°† state (1ï¼Œ2)çš„å€¼æ›´æ–°ä¸º-0.04:

![](img/ba8d5d5cab91150908168cca1d8dba9a.png)

è·Ÿæˆ‘åˆ°ç›®å‰ä¸ºæ­¢ï¼Ÿæˆ‘ä»¬ç°åœ¨å¤„äºçŠ¶æ€(1ï¼Œ3)ã€‚è®©æˆ‘ä»¬å‘å·¦èµ°ä¸€æ­¥ã€‚

æˆ‘ä»¬å†æ¬¡å›åˆ°çŠ¶æ€(sâ€™)(1ï¼Œ2)ï¼Œæˆ‘ä»¬å¾—åˆ°å¥–åŠ±(r) -0.3ã€‚è¿™é‡Œï¼Œåœ¨å€¼è¡¨ä¸­ï¼ŒçŠ¶æ€(1ï¼Œ3)çš„å€¼æ˜¯ 0ï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€(1ï¼Œ2)çš„å€¼æ˜¯-0.03ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–° state (1ï¼Œ3)çš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤º:

V(s) = 0 +0.1 [ -0.4 + 0.5 (-0.04)-0) ]

V(s) = 0.1[-0.42]

V(s) = -0.042

ä½ çŸ¥é“ç°åœ¨è¯¥åšä»€ä¹ˆã€‚åœ¨å€¼è¡¨ä¸­å°† state (1ï¼Œ3)çš„å€¼æ›´æ–°ä¸º-0.042:

![](img/192d989340f43b5e4d185cbce8b8c113.png)

æˆ‘ä»¬ä½¿ç”¨ TD æ›´æ–°è§„åˆ™ä»¥ç±»ä¼¼çš„æ–¹å¼æ›´æ–°æ‰€æœ‰çŠ¶æ€çš„å€¼ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒTD é¢„æµ‹ç®—æ³•ä¸­æ¶‰åŠçš„æ­¥éª¤æ˜¯:

1.  é¦–å…ˆï¼Œå°† V(S)åˆå§‹åŒ–ä¸º 0 æˆ–æŸä¸ªä»»æ„å€¼
2.  ç„¶åï¼Œå¼€å§‹è¿™ä¸€é›†ã€‚å¯¹äºæƒ…èŠ‚ä¸­çš„æ¯ä¸€æ­¥ï¼Œåœ¨çŠ¶æ€ S ä¸­æ‰§è¡ŒåŠ¨ä½œ Aï¼Œå¹¶æ¥æ”¶å¥–åŠ± Rï¼Œç„¶åç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€(Sâ€™)
3.  ä½¿ç”¨ TD æ›´æ–°è§„åˆ™æ›´æ–°å…ˆå‰çŠ¶æ€çš„å€¼
4.  é‡å¤æ­¥éª¤ 2 å’Œ 3ï¼Œç›´åˆ°æˆ‘ä»¬åˆ°è¾¾ç»ˆç«¯çŠ¶æ€

# ç†è§£æ—¶é—´å·®å¼‚æ§åˆ¶

åœ¨æ—¶é—´å·®é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬*ä¼°è®¡*ä»·å€¼å‡½æ•°ã€‚åœ¨ TD æ§åˆ¶ä¸­ï¼Œæˆ‘ä»¬*ä¼˜åŒ–*ä»·å€¼å‡½æ•°ã€‚æˆ‘ä»¬ç”¨äº TD æ§åˆ¶çš„ç®—æ³•æœ‰ä¸¤ç§:

*   éç­–ç•¥å­¦ä¹ ç®—æ³•:Q å­¦ä¹ 
*   åŸºäºç­–ç•¥çš„å­¦ä¹ ç®—æ³•:SARSA

**æ”¿ç­–å¤– vs æ”¿ç­–å†…**

æ”¿ç­–å¤–å­¦ä¹ å’Œæ”¿ç­–å†…å­¦ä¹ æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿç­”æ¡ˆå°±åœ¨ä»–ä»¬çš„åå­—é‡Œ:

*   **éç­–ç•¥å­¦ä¹ :**ä»£ç†æ ¹æ®ä»å¦ä¸€ä¸ªç­–ç•¥é‡‡æ ·çš„ç»éªŒå­¦ä¹ ç­–ç•¥Ï€
*   **åŸºäºç­–ç•¥çš„å­¦ä¹ :**ä»£ç†ä»ç›¸åŒç­–ç•¥Ï€çš„ç»éªŒæ ·æœ¬ä¸­å­¦ä¹ ç­–ç•¥Ï€

è®©æˆ‘ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚å‡è®¾ä½ ä½œä¸ºä¸€åæ•°æ®ç§‘å­¦å®¶åŠ å…¥äº†ä¸€å®¶æ–°å…¬å¸ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å°†æ”¿ç­–å­¦ä¹ ç­‰åŒäºå·¥ä½œå­¦ä¹ ã€‚ä½ ä¼šå°è¯•ä¸åŒçš„äº‹æƒ…ï¼Œå¹¶ä¸”åªä»è‡ªå·±çš„ç»å†ä¸­å­¦ä¹ ã€‚

æ”¿ç­–å¤–å­¦ä¹ æ˜¯æŒ‡ä½ å¯ä»¥å®Œå…¨äº†è§£å…¶ä»–å‘˜å·¥çš„è¡Œä¸ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ è¦åšçš„å°±æ˜¯ä»å‘˜å·¥çš„ç»å†ä¸­å­¦ä¹ ï¼Œè€Œä¸æ˜¯é‡å¤å‘˜å·¥å¤±è´¥çš„äº‹æƒ…ã€‚

# q å­¦ä¹ 

Q-learning æ˜¯ä¸€ç§éå¸¸æµè¡Œå’Œå¹¿æ³›ä½¿ç”¨çš„éç­–ç•¥ TD æ§åˆ¶ç®—æ³•ã€‚

åœ¨ Q å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯çŠ¶æ€-åŠ¨ä½œå€¼å¯¹-åœ¨çŠ¶æ€ s ä¸­æ‰§è¡ŒåŠ¨ä½œ a çš„æ•ˆæœã€‚è¿™å‘Šè¯‰æˆ‘ä»¬åœ¨ç‰¹å®šçŠ¶æ€ä¸‹(Q(sï¼Œa))åŠ¨ä½œå¯¹ä»£ç†æœ‰å¤šå¥½ï¼Œè€Œä¸æ˜¯åªçœ‹åœ¨é‚£ä¸ªçŠ¶æ€ä¸‹(V(s))æœ‰å¤šå¥½

æˆ‘ä»¬å°†æ ¹æ®ä»¥ä¸‹ç­‰å¼æ›´æ–° Q å€¼:

![](img/860d37866248a27a18dfe1141de4298b.png)

ä¸ºä»€ä¹ˆ Q-learning è¢«è®¤ä¸ºæ˜¯ä¸€ç§éç­–ç•¥æŠ€æœ¯ï¼Ÿè¿™æ˜¯å› ä¸ºå®ƒä½¿ç”¨ä¸‹ä¸€ä¸ªçŠ¶æ€ğ‘ â€²å’Œè´ªå©ªåŠ¨ä½œğ‘â€².çš„ q å€¼æ¥æ›´æ–°å…¶ q å€¼æ¢å¥è¯è¯´ï¼Œå®ƒä¼°è®¡äº†å‡è®¾éµå¾ªè´ªå©ªæ”¿ç­–(*maxQ(*s ' a*)*)çš„çŠ¶æ€-è¡ŒåŠ¨å¯¹çš„å›æŠ¥(æ€»è´´ç°æœªæ¥æŠ¥é…¬)ï¼Œå°½ç®¡äº‹å®ä¸Šå®ƒå¹¶æ²¡æœ‰éµå¾ªè´ªå©ªæ”¿ç­–ï¼

ä¸Šé¢çš„ç­‰å¼ç±»ä¼¼äº TD é¢„æµ‹æ›´æ–°è§„åˆ™ï¼Œä½†æœ‰ç»†å¾®çš„åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯ Q-learning ä¸­æ¶‰åŠçš„æ­¥éª¤(æˆ‘æƒ³è®©ä½ æ³¨æ„åˆ°è¿™é‡Œçš„åŒºåˆ«):

1.  é¦–å…ˆï¼Œå°† Q å‡½æ•°åˆå§‹åŒ–ä¸ºæŸä¸ªä»»æ„å€¼
2.  ä½¿ç”¨ epsilon-greedy ç­–ç•¥()ä»ä¸€ä¸ªçŠ¶æ€é‡‡å–ä¸€ä¸ªåŠ¨ä½œï¼Œå¹¶å°†å…¶ç§»åŠ¨åˆ°æ–°çš„çŠ¶æ€
3.  é€šè¿‡éµå¾ªæ›´æ–°è§„åˆ™æ¥æ›´æ–°å…ˆå‰çŠ¶æ€çš„ Q å€¼
4.  é‡å¤æ­¥éª¤ 2 å’Œ 3ï¼Œç›´åˆ°æˆ‘ä»¬åˆ°è¾¾ç»ˆç«¯çŠ¶æ€

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°å†°æ¹–çš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬å¤„äºçŠ¶æ€(3ï¼Œ2)ï¼Œæœ‰ä¸¤ä¸ªåŠ¨ä½œ(å·¦å’Œå³)ã€‚è¯·å‚è€ƒä¸‹å›¾:

![](img/4dba194109a64ea15a7c84f5953f50d4.png)

æˆ‘ä»¬ä½¿ç”¨ Q-learning ä¸­çš„Îµ-è´ªå©ªç­–ç•¥é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œã€‚**æˆ‘ä»¬è¦ä¹ˆæ¢ç´¢ä¸€ä¸ªæ¦‚ç‡ä¸ºÎµçš„æ–°åŠ¨ä½œï¼Œè¦ä¹ˆé€‰æ‹©æ¦‚ç‡ä¸º 1-Îµçš„æœ€ä½³åŠ¨ä½œã€‚**å‡è®¾æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªæ¦‚ç‡Îµï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªç‰¹å®šçš„åŠ¨ä½œ(å‘ä¸‹ç§»åŠ¨):

![](img/2829e57dbe01ae5ecb0e8c671b27daf3.png)

æˆ‘ä»¬å·²ç»åœ¨çŠ¶æ€(3ï¼Œ2)ä¸­æ‰§è¡Œäº†å‘ä¸‹çš„åŠ¨ä½œï¼Œå¹¶ä¸”ä½¿ç”¨Îµ-è´ªå©ªç­–ç•¥åˆ°è¾¾äº†æ–°çš„çŠ¶æ€(4ï¼Œ2)ã€‚æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æ›´æ–°è§„åˆ™æ›´æ–°å…ˆå‰çŠ¶æ€(3ï¼Œ2)çš„å€¼ï¼Ÿè¿™å¾ˆç®€å•ï¼

è®©æˆ‘ä»¬è€ƒè™‘Î±ä¸º 0.1ï¼Œè´´ç°å› å­ä¸º 1ï¼Œå¥–åŠ±ä¸º 0.4:

![](img/c14a04cd95d901f71c787937665716fd.png)

*Q( (3ï¼Œ2) down) = Q( (3ï¼Œ2) down ) + 0.1 ( 0.4 + 1 max [Q( (4ï¼Œ2) action) ]- Q( (3ï¼Œ2)ï¼Œdown)*

æˆ‘ä»¬å¯ä»¥è¯´ï¼Œåœ¨ Q è¡¨ä¸­ï¼Œå…·æœ‰å‘ä¸‹åŠ¨ä½œçš„çŠ¶æ€(3ï¼Œ2)çš„å€¼æ˜¯ 0.6ã€‚å¯¹äºçŠ¶æ€(4ï¼Œ2)ï¼Œmax Q ( (4ï¼Œ2)ï¼Œaction)æ˜¯å¤šå°‘ï¼Ÿ

æˆ‘ä»¬å·²ç»ç ”ç©¶äº†ä¸‰ä¸ªåŠ¨ä½œ(å‘ä¸Šã€å‘ä¸‹å’Œå‘å³)ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åªæ ¹æ®è¿™äº›åŠ¨ä½œå–æœ€å¤§å€¼ã€‚è¿™é‡Œä¸æ¶‰åŠæ¢ç´¢â€”â€”è¿™æ˜¯ä¸€ä¸ªç›´æˆªäº†å½“çš„è´ªå©ªæ”¿ç­–ã€‚

åŸºäºå‰é¢çš„ Q è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æ’å…¥å€¼:

Q( (3ï¼Œ2)ï¼Œdown) = 0.6 + 0.1 ( 0.4 + 1 * max [0.2ï¼Œ0.4ï¼Œ0.6] â€” 0.6)

Q( (3ï¼Œ2)ï¼Œdown) = 0.64

å› æ­¤ï¼Œæˆ‘ä»¬å°† Q çš„å€¼((3ï¼Œ2)ï¼Œdown)æ›´æ–°ä¸º 0.64ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å¤„äº(4ï¼Œ2)çŠ¶æ€ã€‚æˆ‘ä»¬åº”è¯¥é‡‡å–ä»€ä¹ˆè¡ŒåŠ¨ï¼ŸåŸºäºÎµ-è´ªå©ªç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥æ¢ç´¢æ¦‚ç‡ä¸ºÎµçš„æ–°åŠ¨ä½œï¼Œæˆ–è€…é€‰æ‹©æ¦‚ç‡ä¸º 1-Îµçš„æœ€ä½³åŠ¨ä½œã€‚å‡è®¾æˆ‘ä»¬é€‰æ‹©äº†åè€…ã€‚å› æ­¤ï¼Œåœ¨(4ï¼Œ2)ä¸­ï¼Œè¡ŒåŠ¨æƒæœ‰ä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦é€‰æ‹©çš„:

![](img/4b3ccfd2cdba2ab71fc0fc5c8167c580.png)

å¯¹ï¼Œæˆ‘ä»¬å·²ç»æ¬åˆ°äº†å·(4ï¼Œ3)ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œäº‹æƒ…è¿›å±•é¡ºåˆ©ã€‚ä½†æ˜¯ç­‰ç­‰â€”â€”æˆ‘ä»¬å¦‚ä½•æ›´æ–°å…ˆå‰çŠ¶æ€çš„å€¼å‘¢ï¼Ÿ

Q( (4ï¼Œ2)ï¼Œright) = Q( (4ï¼Œ2)ï¼Œright ) + 0.1 ( 0.4 + 1*max [Q( (4ï¼Œ3) action) ]- Q( (4ï¼Œ2)ï¼Œright)

å¦‚æœä½ çœ‹ä¸‹é¢çš„ Q è¡¨ï¼Œæˆ‘ä»¬åªç ”ç©¶äº†çŠ¶æ€(4ï¼Œ3)çš„ä¸¤ä¸ªåŠ¨ä½œ(å‘ä¸Šå’Œå‘ä¸‹)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä»…åŸºäºè¿™äº›åŠ¨ä½œæ¥å–æœ€å¤§å€¼(è¿™é‡Œæˆ‘ä»¬ä¸ä¼šæ‰§è¡ŒÎµ-è´ªå©ªç­–ç•¥ï¼›æˆ‘ä»¬åªéœ€é€‰æ‹©å…·æœ‰æœ€å¤§ä»·å€¼çš„è¡ŒåŠ¨):

![](img/330558b311cf721ad057c022959746e1.png)

Q ( (4ï¼Œ2)ï¼Œright) = Q((4ï¼Œ2)ï¼Œright) + 0.1 (0.4 + 1 max [ (Q (4ï¼Œ3)ï¼Œup)ï¼Œ(Q (4ï¼Œ3)ï¼Œdown) ] â€” Q ((4ï¼Œ2)ï¼Œright)

Q ( (4ï¼Œ2)ï¼Œå³)= 0.6 + 0.1 (0.4 + 1 max [ 0.2ï¼Œ0.4] â€” 0.8)

= 0.6 + 0.1 (0.4 + 1(0.4) â€” 0.6)

= 0.62

å‰å®³ï¼æˆ‘ä»¬å°†çŠ¶æ€ Q çš„å€¼((4ï¼Œ2)ï¼Œå³)æ›´æ–°ä¸º 0.62ã€‚

> è¿™å°±æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨ Q-learning ä¸­è·å¾—çŠ¶æ€-åŠ¨ä½œå€¼ã€‚æˆ‘ä»¬ä½¿ç”¨Îµ-è´ªå©ªç­–ç•¥æ¥å†³å®šé‡‡å–ä»€ä¹ˆè¡ŒåŠ¨ï¼Œå¹¶åœ¨æ›´æ–° Q å€¼æ—¶ç®€å•åœ°é€‰æ‹©æœ€å¤§è¡ŒåŠ¨ã€‚

# è¨å°”è¨

çŠ¶æ€-åŠ¨ä½œ-å¥–åŠ±-çŠ¶æ€-åŠ¨ä½œ(SARSA)æ˜¯ä¸€ç§åŸºäºç­–ç•¥çš„ TD æ§åˆ¶ç®—æ³•ã€‚ç±»ä¼¼äºæˆ‘ä»¬åœ¨ Q-learning ä¸­æ‰€åšçš„ï¼Œæˆ‘ä»¬**å…³æ³¨çŠ¶æ€-åŠ¨ä½œå€¼ï¼Œè€Œä¸æ˜¯çŠ¶æ€-å€¼å¯¹ã€‚**åœ¨ SARSA ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®ä»¥ä¸‹æ›´æ–°è§„åˆ™æ›´æ–° Q å€¼:

![](img/04e389fce4977aca7be22378883e9434.png)

ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°**æ²¡æœ‰æœ€å¤§ Q(s 'ï¼Œa'** )(ä¸åƒ Q-learning)ã€‚è¿™é‡Œï¼Œç®€å•æ¥è¯´å°±æ˜¯ Q(s 'ï¼Œa ')ã€‚å½“æ‚¨å®Œæˆä»¥ä¸‹ SARSA æ­¥éª¤æ—¶ï¼Œæ‚¨ä¼šæ˜ç™½è¿™ä¸€ç‚¹:

1.  é¦–å…ˆï¼Œå°† Q å€¼åˆå§‹åŒ–ä¸ºä¸€äº›ä»»æ„å€¼
2.  é€šè¿‡Îµ-greedy ç­–ç•¥()é€‰æ‹©ä¸€ä¸ªæ“ä½œï¼Œå¹¶ä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€
3.  é€šè¿‡éµå¾ªæ›´æ–°è§„åˆ™æ¥æ›´æ–°å‰ä¸€çŠ¶æ€ä¸­çš„ Q å€¼ï¼Œå…¶ä¸­ aâ€™æ˜¯ç”±Îµ-è´ªå©ªç­–ç•¥é€‰æ‹©çš„åŠ¨ä½œ()
4.  ç°åœ¨æˆ‘ä»¬å°†ä¸€æ­¥ä¸€æ­¥åœ°ç†è§£è¿™ä¸ªç®—æ³•

è®©æˆ‘ä»¬è€ƒè™‘åŒä¸€ä¸ªå†°æ¹–çš„ä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬å¤„äºçŠ¶æ€(4ï¼Œ2)ã€‚æˆ‘ä»¬æ ¹æ®Îµ-è´ªå©ªç­–ç•¥å†³å®šè¡ŒåŠ¨ã€‚å‡è®¾æˆ‘ä»¬ä½¿ç”¨æ¦‚ç‡ 1â€”Îµå¹¶é€‰æ‹©æœ€ä½³è¡ŒåŠ¨(å‘å³ç§»åŠ¨):

![](img/1a9ca68452bc8c862d41977d3606689d.png)

æˆ‘ä»¬åœ¨å·(4ï¼Œ3)ç€é™†ã€‚æˆ‘ä»¬å¦‚ä½•æ›´æ–°å…ˆå‰çŠ¶æ€(4ï¼Œ2)çš„å€¼ï¼Ÿæˆ‘å°†è°ƒå‡ºä¸Šé¢çš„ç­‰å¼å¹¶ä»£å…¥æ•°å€¼ã€‚è®©æˆ‘ä»¬è€ƒè™‘Î±ä¸º 0.1ï¼Œå›æŠ¥ä¸º 0.4ï¼Œè´´ç°å› å­ä¸º 1:

![](img/eb590b49a7429d7535e6b30567359f67.png)

Q( (4ï¼Œ2)ï¼Œright) = Q( (4ï¼Œ2)ï¼Œright) + 0.1 ( 0.4 + 1 *Q( (4ï¼Œ3)ï¼Œaction)) â€” Q((4ï¼Œ2)ï¼Œright)

æˆ‘ä»¬å¦‚ä½•é€‰æ‹© *Q ((4ï¼Œ3)ï¼Œaction)* çš„å€¼ï¼Ÿæˆ‘ä»¬ä¸èƒ½åƒåœ¨ Q-learning ä¸­é‚£æ ·åªæ‹¿èµ· *max ( Q(4ï¼Œ3)ï¼Œaction)* ã€‚åœ¨ SARSAï¼Œæˆ‘ä»¬ä½¿ç”¨Îµè´ªå©ªç­–ç•¥ã€‚çœ‹çœ‹æˆ‘ä¸‹é¢å±•ç¤ºçš„ Q è¡¨ã€‚åœ¨çŠ¶æ€(4ï¼Œ3)ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†ä¸¤ä¸ªåŠ¨ä½œ:

![](img/8cc056cbed234a395bde1dfec09e7e95.png)

æˆ‘ä»¬è¦ä¹ˆä»¥æ¦‚ç‡Îµæ¢ç´¢ï¼Œè¦ä¹ˆä»¥æ¦‚ç‡ 1-Îµåˆ©ç”¨ã€‚å‡è®¾æˆ‘ä»¬é€‰æ‹©äº†å‰ä¸€ä¸ªé€‰é¡¹ï¼Œå¹¶æ¢ç´¢äº†ä¸€ä¸ªæ–°çš„åŠ¨ä½œ(å‘å³ç§»åŠ¨):

![](img/0795dd86ca1350a89a7a439630d9b0fc.png)

Q ( (4ï¼Œ2)ï¼Œå³)= Q((4ï¼Œ2)ï¼Œå³)+ 0.1 (0.4 + 1 (Q (4ï¼Œ3)ï¼Œå³)â€” Q ((4ï¼Œ2)ï¼Œå³)

Q ( (4ï¼Œ2)ï¼Œright) = 0.6 + 0.1 (0.4 + 1(0.7) â€” 0.6)

Q ( (4ï¼Œ2)ï¼Œå³)= 0.65

> è¿™å°±æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨ SARSA ä¸­è·å¾—çŠ¶æ€-åŠ¨ä½œå€¼ã€‚æˆ‘ä»¬ä½¿ç”¨Îµ-è´ªå©ªç­–ç•¥é‡‡å–è¡ŒåŠ¨ï¼Œå¹¶é€‰æ‹©ä½¿ç”¨Îµ-è´ªå©ªç­–ç•¥æ›´æ–° Q å€¼çš„è¡ŒåŠ¨ã€‚

ç°åœ¨æ¥çœ‹çœ‹å®é™…æƒ…å†µï¼Œåœ¨ [Analytics Vidhya åšå®¢](https://www.analyticsvidhya.com/blog/2019/03/reinforcement-learning-temporal-difference-learning/)ä¸Šæœ‰ä¸€ä¸ªå¾ˆæ£’çš„ä½¿ç”¨ Q-Learning è§£å†³å‡ºç§Ÿè½¦è°ƒåº¦çš„ python æ¡ˆä¾‹ç ”ç©¶ã€‚çœ‹çœ‹è¿™ä¸ªã€‚

![](img/066f25d363f7ff1ad6c967df48bf7e29.png)

ç›¸å…³æ–‡ç« 

*åŸè½½äº 2019 å¹´ 3 æœˆ 28 æ—¥*[*https://www.analyticsvidhya.com*](https://www.analyticsvidhya.com/blog/2019/03/reinforcement-learning-temporal-difference-learning/)*ã€‚*