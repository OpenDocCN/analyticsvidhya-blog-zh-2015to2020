<html>
<head>
<title>Recognizing Handwritten Digits with scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 scikit-learn 识别手写数字</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/recognizing-handwritten-digits-with-scikit-learn-67be1a4c74ae?source=collection_archive---------14-----------------------#2020-10-07">https://medium.com/analytics-vidhya/recognizing-handwritten-digits-with-scikit-learn-67be1a4c74ae?source=collection_archive---------14-----------------------#2020-10-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/11c7f9bce47811e760ebb37694409e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*B0LqaybEOoU1J0iZQcT_Aw.jpeg"/></div></figure><p id="27ea" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数据分析不仅限于数字和字符串，因为图像和声音也可以被分析和分类。识别手写文本是一个问题，可以追溯到需要识别手写文档中的单个字符的第一台自动机器。</p><p id="9990" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了解决 Python 中的这个问题，<strong class="io hj"> scikit-learn </strong>库提供了一个很好的例子来更好地理解这种技术、所涉及的问题以及做出预测的可能性。<strong class="io hj"> scikit-learn </strong> python 库是解决机器学习和数据科学问题从乞讨到结束的常用工具。建立在机器学习库基础上的 scikit-learn 。</p><p id="9d3a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">。Numpy</p><p id="0abb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">。Scipy</p><p id="f834" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">。Matplotlib</p><p id="43ad" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> scikit-learn </strong>提供了广泛的内置算法，可以充分利用数据科学项目:以下是使用<strong class="io hj"> scikit-learn </strong>库的主要方式。</p><ol class=""><li id="827a" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">分类</li><li id="3394" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">回归</li><li id="c947" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">使聚集</li><li id="d38a" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">降维</li><li id="03ac" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">型号选择</li><li id="0270" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">预处理</li></ol><p id="dcbe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">简而言之，该库专注于数据建模。<strong class="io hj"> scikit-learn </strong>附带了一些小型标准数据集。不需要从一些网站下载任何文件。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="4e39" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们开始吧，</p><p id="4403" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">今天我们要实现一个数字识别器。<strong class="io hj"> scikit-learn </strong>库的 Digits 数据集提供了许多数据集，可用于测试数据分析和结果预测的许多问题。一些科学家声称它 95%的时候都能准确预测数字。进行数据分析来接受或拒绝这个假设。</p><p id="ee70" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">导入重要库</strong></p><p id="2a8c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从 sklearn 导入数据集<br/>从 sklearn 导入 svm <br/>从 matplotlib 导入 pyplot 作为 plt</p><p id="33e6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，您可以将数字数据集加载到笔记本中。</p><p id="41ec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">svc = svm。SVC(γ= 0.001，C=100。)<br/>digits = datasets . load _ digits()</p><p id="8f87" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">加载数据集后，您可以分析内容。首先，您可以通过调用 DESCR 属性来读取关于数据集的大量信息。<code class="du kf kg kh ki b">DESCR</code>包含数据的自由文本描述，而<code class="du kf kg kh ki b">details</code>包含 openml 存储的元数据字典，如数据集 id。</p><p id="cff9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">打印(数字。描述)</p><p id="ef81" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">手写数字的图像包含在 digits.images 数组中</p><p id="c53f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">打印(digits.images[0])</p><p id="291b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您将获得以下结果:</p><p id="3274" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数组([[ 0。, 0., 5., 13., 9., 1., 0., 0.], [ 0., 0., 13., 15., 10., 15., 5., 0.], [ 0., 3., 15., 2., 0., 11., 8., 0.], [ 0., 4., 12., 0., 0., 8., 8., 0.], [ 0., 5., 8., 0., 0., 9., 8., 0.], [ 0., 4., 11., 0., 1., 12., 7., 0.], [ 0., 2., 14., 5., 10., 12., 0., 0.], [ 0., 0., 6., 13., 10., 0., 0., 0.]])</p><p id="9696" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您可以使用 matplotlib 库直观地检查这个结果的内容</p><p id="5b9c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">plt.imshow(digits.images[0]，cmap=plt.cm.gray_r，interpolation='nearest ')</p><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/ec066d6b964c5dfebeca8cfc9179056b.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*Bxbjvi09dM85boMGeg1llg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">1797 个手写数字中的一个</figcaption></figure><p id="c36d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">由图像表示的数值，即目标，包含在 digit.targets 数组中。</p><p id="77c0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">打印(数字.目标)</p><p id="f977" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一旦定义了预测模型，就必须用训练集来指导它，训练集是一组您已经知道所属类别的数据。考虑到 Digits 数据集中包含的大量元素，您肯定会获得一个非常有效的模型，即能够非常确定地识别手写数字的模型。</p><p id="4dc6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过使用 matplotlib 库，我们可以详细查看所有手写数字:</p><p id="be08" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">只保留为循环定义的行和列，图形。</p><p id="1f66" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于范围(1，5)内的 I:<br/>PLT . subplot(3，2，I)<br/>PLT . im show(digits . images[I]，cmap=plt.cm.gray_r，interpolation='nearest ')</p><p id="ff04" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里我只取了前 4 个数字。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/6fba233d1ec1610e0c6722ab04792801.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*vtREWUsFh5uYO5APpMZ0WQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">前 4 个数字</figcaption></figure><h2 id="ed75" class="kt ku hi bd kv kw kx ky kz la lb lc ld ix le lf lg jb lh li lj jf lk ll lm ln bi translated">生成模型</h2><p id="2d0d" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">让我们建立支持向量机模型。首先，导入 SVM 模块，通过在<code class="du kf kg kh ki b">SVC()</code>函数中传递自变量内核作为线性内核来创建支持向量分类器对象。</p><p id="60ce" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，使用<code class="du kf kg kh ki b">fit()</code>将您的模型安装在训练集上，并使用<code class="du kf kg kh ki b">predict()</code>对测试集进行预测。</p><p id="a230" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，您可以训练之前定义的 svc 估计器。svc.fit(数字.数据[1:1790]，数字.目标[1:1790])</p><p id="f815" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">svc.predict(digits.data[1:7])</p><pre class="kk kl km kn fd lt ki lu lv aw lw bi"><span id="5009" class="kt ku hi ki b fi lx ly l lz ma">array([1, 2, 3, 4, 5, 6])</span></pre><p id="5027" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果将它们与实际数字进行比较，如下所示:</p><p id="b8b4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">digits.target[1:7]</p><pre class="kk kl km kn fd lt ki lu lv aw lw bi"><span id="642a" class="kt ku hi ki b fi lx ly l lz ma">array([1, 2, 3, 4, 5, 6])</span></pre><p id="8219" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">可以看到 svc 估计器已经正确学习。它能够识别手写数字，正确解释验证集的所有六个数字。</p><p id="7cae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们可以计算数字识别器的准确性。但是如果你像我一样是初学者，那么谷歌一下，这里的<a class="ae mb" href="https://stackoverflow.com/questions/42471082/how-to-find-out-the-accuracy" rel="noopener ugc nofollow" target="_blank">就是解决方案:</a></p><p id="55ee" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从 sklearn.metrics 导入 accuracy _ score<br/>accuracy _ score(SVC . predict(digits . data[1:7])，digits.target[1:7])</p><p id="7ba8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">或者</p><p id="2e6d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">a=digits.target[1:7]</p><p id="1d38" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">b=svc.predict(digits.data[1:7])</p><p id="6c40" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">比较 a 和 b，我们得到的精度为:</p><p id="2f48" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于范围内的 I(len(a)):<br/>是=否=0 <br/>如果 a[i]==b[i]: <br/>是+=1 <br/>否则:<br/>否+=1</p><p id="010f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">准确度=(是/(否+是))*100</p><p id="4fba" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您可以选择较小的训练集和不同的验证范围。在上面的例子中，我们已经得到了 100%准确的预测，但这可能并不总是如此。</p><h1 id="637c" class="mc ku hi bd kv md me mf kz mg mh mi ld mj mk ml lg mm mn mo lj mp mq mr lm ms bi translated">结论:</h1><p id="c167" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">在我们学习之前，如何从 sklearn 导入数据集，如何使用估计函数<strong class="io hj"> fit() </strong>和<strong class="io hj"> predict() </strong>建立模型并进行预测。我们也计算准确度，简而言之我们用 Skleran 库介绍。</p></div></div>    
</body>
</html>