<html>
<head>
<title>Create Github Actions and be smart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建Github动作，变得聪明</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-github-actions-and-be-smart-f1e6b9cc9bfa?source=collection_archive---------9-----------------------#2020-01-09">https://medium.com/analytics-vidhya/create-github-actions-and-be-smart-f1e6b9cc9bfa?source=collection_archive---------9-----------------------#2020-01-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="172a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Github动作自动化您繁琐的工作。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/0d39d2c6fdb0ba5325a8bcddb8f6fe22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_J82MWNqkfzwaEhleMzJqA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">来源:<a class="ae jn" href="https://lubus.in/blog/github-actions-to-release-wordpress-plugin-3656" rel="noopener ugc nofollow" target="_blank">https://lubus . in/blog/github-actions-to-release-WordPress-plugin-3656</a></figcaption></figure><h1 id="8c44" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">什么是Github Actions？</h1><p id="1450" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><a class="ae jn" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/about-github-actions" rel="noopener ugc nofollow" target="_blank"> GitHub Actions使您能够直接在您的GitHub存储库中创建定制的软件开发生命周期(SDLC)工作流。</a></p><p id="313e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Github动作是自定义代码/指令，以您喜欢的任何方式在Github repo中交互和执行一些操作。(真的！！！)</p><p id="da71" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">CI/CD是它的传统范例。如果你知道CI/CD那么就知道<strong class="ki hj"> <em class="lh"> Github Actions </em> </strong>对它来说是++的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es li"><img src="../Images/37904009b20915be544be00ea3711338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J43iahKWgNSNuqNwCs3xEg.png"/></div></div></figure><h1 id="b1c9" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">更多关于它的？</h1><ul class=""><li id="e054" class="lj lk hi ki b kj kk km kn kp ll kt lm kx ln lb lo lp lq lr bi translated"><em class="lh"> Github Actions </em>被<strong class="ki hj">完全集成到Github </strong>中，因此不需要任何外部站点，并且只能在您的repo中进行管理。</li><li id="3ab8" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb lo lp lq lr bi translated"><em class="lh"> Github Actions </em> <strong class="ki hj">为各种配置项配置提供了多个模板</strong>，用户可以创建自己的自定义操作并在<a class="ae jn" href="https://github.com/marketplace?type=actions" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj"> Marketplace </strong> </a>上发布。</li><li id="4e21" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb lo lp lq lr bi translated">Github Actions 对每一个开源库都是完全免费的<strong class="ki hj">,包括每月2000分钟的免费构建时间，这与大多数CI/CD免费计划相当。</strong></li></ul><h1 id="7332" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">Github操作</h1><p id="f9e3" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在创建动作之前，让我们先了解一下动作的基本术语。</p><h2 id="a80d" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">动作:</h2><p id="6edc" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">可用于创建<strong class="ki hj">作业</strong>的小型可移植代码。您可以使用市场中的操作，也可以自己创建一个。</p><h2 id="9eca" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">工作:</h2><p id="6d27" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">一个作业由多个<strong class="ki hj">步骤</strong>组成，在虚拟环境实例中运行。作业可以独立运行，也可以顺序运行。</p><h2 id="ecc9" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">步骤:</h2><p id="099c" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">步骤是可以由作业执行的一组任务。步骤可以运行命令或操作。</p><h2 id="688b" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">工作流程:</h2><p id="3abe" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">工作流是由一个或多个作业组成的自动化流程，可以由事件触发。工作流是使用中的YAML文件定义的。github/workflows目录。</p><h1 id="cc4a" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">创建自定义操作</h1><h2 id="f992" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">问题</h2><p id="fb7a" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">自动创建获取内容并追加到<a class="ae jn" href="https://github.com/akashp1712/python-tricks/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj"> README.md </strong> </a>文件中</p><p id="69b0" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我创建了一个repo，我想在其中发布python技巧。主要内容是python技巧，部分内容驻留在<strong class="ki hj"> <em class="lh"> /data </em> </strong>文件夹中的单独文件中。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ml"><img src="../Images/f72384f2c548632c270fe53442ba8dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4hghmr_BybNzVBA--KeqA.png"/></div></div></figure><p id="4dde" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">每个文件的内容都是JSON格式，如下所示:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/7896c25771d79165ca23df38d31068b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BA2LAeSQfWbAD2kU9w0WQ.png"/></div></div></figure><p id="47ab" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我想<strong class="ki hj">读取每个文件，并将内容</strong>复制到README.md文件，该文件应如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/6f575e81e33aefecaf314251b7449fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XGU-7-osN77vcm1Kl5c7Xw.png"/></div></div></figure><h2 id="e815" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">可能的解决方案:</h2><ol class=""><li id="eabe" class="lj lk hi ki b kj kk km kn kp ll kt lm kx ln lb mo lp lq lr bi translated">手动复制粘贴，推送README.md — <strong class="ki hj">不……</strong></li><li id="60be" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb mo lp lq lr bi translated">写一个读取每个文件的python脚本，复制到README.md并推送。</li></ol><h2 id="3cff" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">如果Github为你做了一切呢？？？</h2><p id="eac4" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">是的，让我们创建一个Github动作来做到这一点。</p></div><div class="ab cl mp mq gp mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hb hc hd he hf"><h2 id="2621" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">步骤1:为您的工作创建一个脚本</h2><p id="6ea2" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">让我们创建一个python文件，它将从<em class="lh"> /data </em>文件夹中读取所有JSON文件，并将内容添加到README.md文件中</p><p id="a10c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><a class="ae jn" href="https://github.com/akashp1712/python-tricks" rel="noopener ugc nofollow" target="_blank"><strong class="ki hj">python-戏法</strong> </a> <strong class="ki hj"> / </strong> <a class="ae jn" href="https://github.com/akashp1712/python-tricks/tree/master/action-generate-readme" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj">动作-生成-自述</strong></a><strong class="ki hj">/</strong><a class="ae jn" href="https://github.com/akashp1712/python-tricks/tree/master/action-generate-readme/main.py" rel="noopener ugc nofollow" target="_blank"><strong class="ki hj">main . py</strong></a></p><p id="6a90" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我把这个文件保存在一个单独的文件夹里，这个文件夹就是动作目录。该文件将在您选择的虚拟机中执行。</p><h2 id="6bc7" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">步骤2:创建一个Docker文件</h2><p id="70eb" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">Github允许你构建Docker和Javascript动作。在这里，我们将使用Docker创建它。</p><p id="ef48" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">让我们<a class="ae jn" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/creating-a-docker-container-action#create-a-dockerfile" rel="noopener ugc nofollow" target="_blank">创建一个<strong class="ki hj"> Docker文件</strong> </a> <strong class="ki hj"> </strong>并添加以下内容:</p><p id="e42d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><a class="ae jn" href="https://gist.github.com/akashp1712/17714c60bb07a650b20025922d27fb55" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/akashp 1712/17714 c 60 bb 07 a 650 b 20025922d 27 FB 55</a></p><ul class=""><li id="3f02" class="lj lk hi ki b kj lc km ld kp mw kt mx kx my lb lo lp lq lr bi translated">我们将在docker中使用<strong class="ki hj"><em class="lh">python:3 . 8 . 1-alpine 3.10</em></strong>图像</li><li id="a67e" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb lo lp lq lr bi translated">并将入口点设置为main.py文件</li></ul><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="3ad6" class="lx jp hi na b fi ne nf l ng nh">ADD main.py /main.py                       <br/>ENTRYPOINT ["python", "/main.py"]</span></pre><h2 id="6920" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">第三步:将行动付诸实施(心流！)</h2><p id="e4c8" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">现在，这是Github动作的重要部分:<a class="ae jn" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-workflows" rel="noopener ugc nofollow" target="_blank">配置工作流</a>。</p><p id="529c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在<a class="ae jn" href="https://github.com/akashp1712/python-tricks/blob/master/.github/workflows/main.yml" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj"> <em class="lh">文件夹下创建工作流文件<strong class="ki hj"> main.yml </strong>。github/workflows/</em></strong></a></p><p id="ac8d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">让我解释一下工作流文件:</p><h2 id="a39e" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">引发</h2><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="f6b3" class="lx jp hi na b fi ne nf l ng nh">on:<br/>  push:                           <br/>    paths:                           <br/>      - 'data/**.json'                           <br/>      -'!data/0_metadata.json'</span></pre><ul class=""><li id="c6a0" class="lj lk hi ki b kj lc km ld kp mw kt mx kx my lb lo lp lq lr bi translated">工作流表示，当对<em class="lh"> /data文件夹中的更新/新JSON文件进行推送时，它应该触发作业。</em></li><li id="3ed7" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb lo lp lq lr bi translated">点击 阅读更多关于触发<a class="ae jn" href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-a-workflow#triggering-a-workflow-with-events" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj">的信息。天空是极限。</strong></a></li></ul><h2 id="b6e5" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">乔布斯</h2><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="00f0" class="lx jp hi na b fi ne nf l ng nh">jobs:                         <br/>  generate-metadata:                           <br/>     runs-on: ubuntu-latest</span></pre><ul class=""><li id="977c" class="lj lk hi ki b kj lc km ld kp mw kt mx kx my lb lo lp lq lr bi translated">名为“生成元数据”的作业将在<em class="lh"> ubuntu虚拟机</em>上运行</li><li id="c914" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb lo lp lq lr bi translated">您的工作流中可以运行多个作业。</li></ul><pre class="iy iz ja jb fd mz na nb nc aw nd bi"><span id="4938" class="lx jp hi na b fi ne nf l ng nh">steps:                             <br/>  - uses: actions/checkout@v1                             <br/>  - name: Add list of files to a metadata file and generate Readme<br/>    uses: ./action-generate-readme<br/>  - name:  Commit File changes<br/>    # skipping the commit code<br/>  - name: Push changes                               <br/>    uses: ad-m/github-push-action@master<br/>       with:                                 <br/>         github_token: ${{ secrets.GITHUB_TOKEN }}</span></pre><p id="5096" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这项工作有<strong class="ki hj"> 4个步骤</strong>:</p><ol class=""><li id="8bd1" class="lj lk hi ki b kj lc km ld kp mw kt mx kx my lb mo lp lq lr bi translated"><strong class="ki hj"> actions/checkout@v1 </strong> —是一个来自市场的Github动作，它检查VM中的代码。</li><li id="bcf9" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb mo lp lq lr bi translated"><strong class="ki hj">。/action-generate-readme </strong> —是生成readme文件的本地操作</li><li id="6b55" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb mo lp lq lr bi translated">提交文件更改—这是普通的git命令</li><li id="4cf0" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb mo lp lq lr bi translated"><strong class="ki hj">ad-m/Github-push-action @ master—</strong>是来自市场的Github action，它将更改推送到遥控器。</li></ol></div><div class="ab cl mp mq gp mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hb hc hd he hf"><p id="a0ff" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">仅此而已。真的。</p><p id="a362" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们的第一个动作已经准备好了，这是最基本的，对我们的回购做一个简单的操作。让我们看看它的实际效果。我需要做的就是推一个<strong class="ki hj"> JSON </strong>文件。</p><p id="691a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">它触发了工作流程，您可以从<strong class="ki hj"> <em class="lh">动作</em> </strong>选项卡中看到</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ni"><img src="../Images/98619244d662ea4a23894b7c3a042dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FT3sHnEqV1pLhsF9aj9PVg.png"/></div></div></figure><p id="9fa6" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">单击正在运行的工作流将显示详细的执行情况。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/ed7f8c952dfefb88eef801186cc2b94e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u805HRNrBEa_49Tkx6gwOA.png"/></div></div></figure><p id="d0be" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">您可以看到，作业的所有步骤都是按顺序执行的，一旦完成，就会显示绿色勾号。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nk"><img src="../Images/ba1de491eb5293afdbe1a6e5c5cd33da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jk5VdpzleJm9CXGnIRmo3g.png"/></div></div></figure><p id="8e07" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">瞧，它会自动提交。(您也可以配置生成拉取请求)</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nl"><img src="../Images/e5d69cc2f7f79570477120eba1438b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UN9P4JyVObdELyKSFmOx-Q.png"/></div></div></figure><p id="36c5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">就这样，伙计们。</p><p id="17f4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们在repo中创建了一个简单的Gighub操作，它自动完成了我的工作负载。</p></div><div class="ab cl mp mq gp mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hb hc hd he hf"><h2 id="7559" class="lx jp hi bd jq ly lz ma ju mb mc md jy kp me mf ka kt mg mh kc kx mi mj ke mk bi translated">人们还可以使用Github动作做什么？</h2><ul class=""><li id="e766" class="lj lk hi ki b kj kk km kn kp ll kt lm kx ln lb lo lp lq lr bi translated">自动发布WordPress插件</li><li id="bb12" class="lj lk hi ki b kj ls km lt kp lu kt lv kx lw lb lo lp lq lr bi translated">Lint检查代码</li></ul></div></div>    
</body>
</html>