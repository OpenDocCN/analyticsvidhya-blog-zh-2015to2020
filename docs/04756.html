<html>
<head>
<title>Corona Detection From X-Ray Images using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于深度学习的X射线图像电晕检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/corona-detection-from-x-ray-images-using-deep-learning-72ba5db16608?source=collection_archive---------32-----------------------#2020-03-30">https://medium.com/analytics-vidhya/corona-detection-from-x-ray-images-using-deep-learning-72ba5db16608?source=collection_archive---------32-----------------------#2020-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/04ae6a0cbed5dc2ffcb3d8ec42886c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ZnWuNSfIpmkacNjWsNMr5A.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">来源:谷歌</figcaption></figure><h1 id="118d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">让我们明白什么是新冠肺炎。</h1><p id="fa64" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">冠状病毒病(新冠肺炎)是一种由新型病毒引起的传染病。这种疾病导致呼吸道疾病(如流感)，症状包括咳嗽、发烧，在更严重的情况下，呼吸困难。</p><p id="dc2d" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">大多数感染新冠肺炎病毒的人会经历轻度至中度的呼吸道疾病，无需特殊治疗即可康复。老年人以及那些患有心血管疾病、糖尿病、慢性呼吸系统疾病和癌症等潜在疾病的人更有可能患上严重疾病。</p><p id="174f" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">当一个人感染新冠肺炎病毒时，他的肺会发生什么变化？</p><blockquote class="kr ks kt"><p id="b551" class="jo jp ku jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated">根据医生和专家的说法:“呼吸树的内层受到损伤，导致炎症。这反过来刺激气道内层的神经。仅仅一粒灰尘就能引起咳嗽。”</p><p id="d289" class="jo jp ku jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated">-约翰·威尔逊教授，皇家澳大拉西亚内科医学院当选院长和呼吸内科医生。</p></blockquote><p id="cbc0" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">充满炎症物质的肺部无法获得足够的氧气进入血液，降低了身体吸收氧气和排出二氧化碳的能力。这就是导致死亡的原因。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es ky"><img src="../Images/740ad183020d47c939cd1619af2085e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7xqci5RgtmPG6ekxnyXKlQ.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">呼吸内科医生John Wilson解释了新冠肺炎的影响范围。这张图片显示了一名新冠肺炎患者的CT扫描。由新型冠状病毒引起的肺炎可以表现为肺部外缘上独特的模糊斑块，如箭头所示。图片来源:美联社</figcaption></figure><h1 id="f187" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">在这种情况下，ML如何提供帮助？</h1><p id="5082" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们可以建立一个模型，该模型将在这些X射线图像中找到模式，并试图预测患者是被“冠状病毒”感染还是“正常”。</p><p id="ed46" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这将减少检测和推断患者是否被感染所需的时间。</p><h1 id="8d02" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">数据集:</h1><p id="981e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">让我们看看数据集是什么样子的:</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lh"><img src="../Images/106ecf96a9fd625a4fcd639d82060daf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1Uw-4oQ1kyShCw60x0PqA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">训练文件夹:两组图像，电晕和正常</figcaption></figure><p id="2710" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">数据完全平衡:电晕-120和正常-124</p><p id="ab07" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">让我们看一张日冕的图像:</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es li"><img src="../Images/4886f08ffc9f491f4bfd52c7d8c58c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ymlnrF0RaiQ4QieB6g7gg.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">受感染者X射线</figcaption></figure><p id="a8db" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">让我们来看看正常的单一形象:</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lj"><img src="../Images/0d4e5556da67dad0c827425ea6f61ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIy_nBitM8WqrMvaolhQNA.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">正常人X射线</figcaption></figure><h2 id="2d52" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">文件夹结构:</h2><p id="f526" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">基本上，有3个文件夹，每个文件夹包含2个子文件夹:</p><p id="d3d2" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">文件夹为train、test和validation，每个主文件夹由名为corona和normal的子文件夹组成。</p><p id="a299" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这是我们所有的。</p><blockquote class="kr ks kt"><p id="378b" class="jo jp ku jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated">你可以从<a class="ae ly" href="https://bit.ly/3dvXVa0" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> <em class="hi">这里</em> </strong> </a>下载数据。这些数据是通过网站<a class="ae ly" href="https://aihubprojects.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">收集到的，并放入一个驱动链接中</strong> </a> <strong class="jq hj">，</strong>请查看它们，它们有很酷的东西和项目，还有许多博客可供阅读、探索和增加你的知识。</p></blockquote><h1 id="8e37" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">深度学习方法:</h1><p id="3513" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们将使用CNN模型来找出图像中包含的模式。你可以在<a class="ae ly" href="https://towardsdatascience.com/applied-deep-learning-part-4-convolutional-neural-networks-584bc134c1e2" rel="noopener" target="_blank"> <strong class="jq hj"> <em class="ku">这里</em> </strong> </a>阅读CNN。您将在参考博客中找到大量关于CNN模型的信息。</p><h1 id="a990" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">数据预处理:</h1><h2 id="9846" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">分离数据</h2><p id="f433" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">一旦我们有了数据，我们就可以创建类，并将它们放入每个类的单独文件夹中，例如:corona图像应该在corona文件夹中，normal图像应该在normal文件夹中。但是不用担心，积累数据的人已经处理好了。</p><p id="2670" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">为什么放在不同的文件夹里？</strong></p><p id="22af" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这样我们就可以教我们的模型，哪个图像属于哪个类别。</p><h2 id="75e5" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">扩充数据</h2><p id="d0c3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们都知道，图像可以被增强，我们可以人为地增加模型的数据量，为什么不呢？</p><p id="164b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">你可以在这里   <strong class="jq hj"> <em class="ku">阅读关于图像增强<a class="ae ly" href="https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> <em class="ku">。</em> </strong>它由不同类型的增强组成，借助代码和图像很容易解释。</a></em></strong></p><p id="442a" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我执行的增强如下:</p><ol class=""><li id="768c" class="lz ma hi jq b jr km jv kn jz mb kd mc kh md kl me mf mg mh bi translated">重新缩放:创建不同大小的图像的新版本。</li></ol><p id="c5e6" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">2.剪切范围:执行图像的剪切变换。</p><p id="4484" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">3.缩放范围:缩放图像。</p><p id="874f" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">3.旋转范围:图像旋转的角度。</p><p id="d4fa" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">4.宽度移动范围:根据宽度移动宽度。</p><p id="cc55" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">5.高度移动范围:根据高度移动高度。</p><p id="55d9" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">6.水平翻转:创建一个水平翻转的新图像。</p><p id="222c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">7.垂直翻转:创建一个垂直翻转的新图像</p><h2 id="9a88" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">正在创建ImageDataGenerator对象:</h2><p id="2e76" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们将使用上面提到的增强，用于发电机对象，然后传递包含火车图像的主文件夹的目录(记住火车文件夹已经包含两个子文件夹corona和normal)。这些文件夹将帮助put model了解哪个图像属于哪个类别。</p><p id="06cb" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们将目标尺寸设置为300 x 300，实际图像的尺寸更大，大约为1400 x 1200，这可能需要很长时间来训练，因此我们缩小了图像尺寸。</p><p id="8b68" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们将批量大小设置为32，将类别模式设置为分类。</p><p id="7dcf" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们还为我们的模型创建图像的输入大小，即:</p><p id="9e6a" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">(300 x 300 x 3)，其中3是图像的尺寸RGB : 3</p><h2 id="ab71" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">模型架构:</h2><p id="f6c0" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们使用了一个序列模型，它由Conv2D层、BatchNorm层、MaxPooling层、Flatten层、Dropout层和Dense层组成，作为输出。</p><p id="e99d" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">输出分为2类，电晕或正常。</p><p id="56d9" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">有6个Conv2D层，每个层的内核大小为(3x3)，激活为ReLU，内核初始化器和内核正则化器为L2。</p><p id="e77c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">CNN层的激活单位在2 — 2⁶.之间</p><p id="931b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">MaxPooling层的池大小为(2x2)。</p><p id="97a6" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">丢弃层丢弃该层0.5%的神经元。</p><h2 id="7c90" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">模型编译参数:</h2><p id="4f21" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">该模型使用“二进制交叉熵”的损失。</p><p id="3dfc" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">“二进制精度”的度量。</p><p id="a435" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">使用的优化器是Adagrad，学习率为0.001，衰减为0.9</p><h2 id="1124" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">训练模型:</h2><p id="9546" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">以10为纪元，我们训练该模型，它给出了最终的训练损失为0.27，训练精度为0.93，测试损失为0.28，测试精度为0.95。这对于简单的模型来说是不错的。</p><h1 id="144f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">让我们看看一些结果:</h1><p id="992b" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">用于测试的图像来自模型尚未看到的测试文件夹。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es mi"><img src="../Images/ef40e79c11c4796859a5a3eb8f83d27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5GK2Q65mE-TzIw17HA_bAA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">电晕x射线图像的预测</figcaption></figure><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es mj"><img src="../Images/1856d6945146109776ebd6fc6d1b7fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XBtKWiMLVHkhrPs1syrcgA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">正常x射线图像的预测</figcaption></figure><h1 id="e1db" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论:</h1><ol class=""><li id="2e2e" class="lz ma hi jq b jr js jv jw jz mk kd ml kh mm kl me mf mg mh bi translated">该模型似乎工作良好，但仍需要改进，以便我们可以达到更高的准确性。</li><li id="df94" class="lz ma hi jq b jr mn jv mo jz mp kd mq kh mr kl me mf mg mh bi translated">如果数据更多，我们的模型可能会更复杂，可能会有更多的参数需要训练，可能会取得更好的结果。</li></ol><h1 id="2373" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">参考资料:</h1><p id="9b0d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">来源:<a class="ae ly" href="https://www.theguardian.com/world/2020/mar/28/what-happens-to-peoples-lungs-when-they-get-coronavirus" rel="noopener ugc nofollow" target="_blank">https://www . the guardian . com/world/2020/mar/28/what-occass-to-the-people-lungs-what-ochaps-when-when-then-when-they-theguardian . com/world/2020/mar/28/what-goes-to-people-when-then-get-coronavirus</a></p><blockquote class="kr ks kt"><p id="a77f" class="jo jp ku jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated"><strong class="jq hj">感谢阅读！</strong></p><p id="651a" class="jo jp ku jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated">如果你想了解更多类似的话题或者看看我还能提供什么，一定要访问我的网站:<a class="ae ly" href="https://digital.allaboutstuffs.com/" rel="noopener ugc nofollow" target="_blank">所有关于东西</a></p><p id="7475" class="jo jp ku jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated">准备好让你的学习更上一层楼了吗？查看我提供的课程:<a class="ae ly" href="https://digital.allaboutstuffs.com/courses/" rel="noopener ugc nofollow" target="_blank">课程</a></p><p id="370c" class="jo jp ku jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated">生活工作压力大？花一点时间来放松和放松我的舒缓和放松的视频！现在就去我的频道，开始你的内心平和与宁静之旅吧</p></blockquote></div></div>    
</body>
</html>