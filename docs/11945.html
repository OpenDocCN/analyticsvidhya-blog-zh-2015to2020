<html>
<head>
<title>Converting and reading a document with speech option using Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python通过语音选项转换和读取文档。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/converting-and-reading-a-document-in-with-speech-option-using-python-876860dea05b?source=collection_archive---------14-----------------------#2020-12-24">https://medium.com/analytics-vidhya/converting-and-reading-a-document-in-with-speech-option-using-python-876860dea05b?source=collection_archive---------14-----------------------#2020-12-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="24be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何使用Python和PyCharm IDE设计一个简单的GUI，可以读取pdf文件，同时可以转换任何文件。txt，。doc，。docx文件转换为pdf文件。<strong class="ih hj">只是为了好玩！！</strong></p><p id="fb98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">概述:</strong></p><p id="745b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">pyttsx3、tkinter、pyPDF2等各种python库和包被用于应用程序的前端和后端实现。简单的功能是读出在文件位置中提供给GUI的文件以及感兴趣的页码，作为GUI的输入，应该从该页码开始读取。如果给定文件有扩展名，如。txt，。doc，。docx文件将被转换为pdf，并保存在代理可以读取的位置。</p><p id="76d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">库和包:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/8e0552bd0c35bb6994364b81ed8a5779.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*qV7LXdFmV-9ZJwpy9pCNvg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">已经使用的库和包</figcaption></figure><p id="89bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，在使用pip实现之前，使用以下命令安装软件包和库:</p><p id="46f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> pip安装tkinter </strong></p><p id="56f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> pip安装pyPDF2 </strong></p><p id="3666" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我确实遇到了识别文件的问题，为此我必须重新安装py win32(Python for Windows extension ),而且一切正常！！。</p><p id="5041" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> GUI设计:</strong></p><p id="0785" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我猜这个GUI是使用Python的tkinter包制作的最简单的GUI。！。</p><p id="ca30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本组件是从tkinter作为Tk()启动的根。该组件包含文本字段，用于捕获要读取的文件的位置和应该开始读取的页码。提供适当的输入后，应用程序将检查输入的位置是否指向pdf。以防万一。txt，。doc或. docx文件，那么在阅读之前，它将被提取并转换为pdf。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/79c5f3ea2a28d28e9386e26c1c1ee6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4kwW3tKYcbnLq9epdFb_A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">GUI的外观</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ju"><img src="../Images/97f04046e45da1c77e1de4e55e5a4776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dimLxjgazIq3fsEVFPx3hQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">GUI代码片段</figcaption></figure><p id="f55b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">错误消息也被检查:使用从tkinter调用的messagebox和使用tkinter的顶层类定制的错误框检查错误消息，该错误框将消息框架放在根框架上。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jv"><img src="../Images/df839d65562ce322d46922496920847c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFHBZ3rxYSPvKhwRlTOkkA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">对于空文本字段。</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/0c0dbef979aabd19e2e4fdb8389d4165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o9rKEyFcQ7WWun-C3-VBOA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">错误检查的代码片段</figcaption></figure><p id="8611" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">pdf文件以外的文件转换发生在后端，如下面的代码所示。用户可以自定义路径来保存转换后的pdf文件，否则它会将文件存储在PyCharm文件的venv文件夹中。变量“ext”包含使用Python的“<strong class="ih hj"> os </strong>”模块在提供的文件位置检查的文件的扩展名。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jx"><img src="../Images/05aa28a3483b7fadb177f7671427aeb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*OYvz5OpCdP0hJonjs88Djw.png"/></div></figure><p id="bbf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码片段显示了使用Python的PyPDF2和pyttsx3库启动阅读代理，朗读文件的提取文本。一个页面的条件只是一个显示的提示，但是使用for…循环，可以读取多个页面。速度(“速率”)、音量等属性已修改如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jy"><img src="../Images/815012c9eb97135b1c65025c974c3aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*ZW7RIs0l5d0gXZw8wbkamQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">阅读代理的几行代码</figcaption></figure><p id="f63d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我保留了默认的声音选择，但它可以改变。:)</p><p id="36b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您点击所有有效输入的“阅读”按钮时，pdf的音频开始播放。这对于一个初学者的工作来说是令人愉快的！！</p><p id="2cb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多详情，可参考以下链接:</p><p id="051c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jz" href="https://github.com/Eva86271/AudioPython/blob/master/venv/PDFReader.py" rel="noopener ugc nofollow" target="_blank">https://github . com/EVA 86271/audio python/blob/master/venv/pdf reader . py</a></p><p id="0ca4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯！！</p></div></div>    
</body>
</html>