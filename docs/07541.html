<html>
<head>
<title>Iris Species Classification Using Auto ML (pycaret)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于自动最大似然法的鸢尾属物种分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/iris-species-using-auto-ml-pycaret-327985fb362f?source=collection_archive---------11-----------------------#2020-06-29">https://medium.com/analytics-vidhya/iris-species-using-auto-ml-pycaret-327985fb362f?source=collection_archive---------11-----------------------#2020-06-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c5d0b2baa54fe6d378d8d2bebc46926a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0EZotY9xP2Czi1DKVNVhDQ.png"/></div></div></figure><p id="61c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击了解关于iris <a class="ae jo" href="https://en.wikipedia.org/wiki/Iris_flower_data_set" rel="noopener ugc nofollow" target="_blank">数据集</a>的更多信息。</p><p id="96cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击查看完整的<a class="ae jo" href="https://www.kaggle.com/jerryjohn1995/iris-species-best-simple-accurate-100-pycaret" rel="noopener ugc nofollow" target="_blank">代码</a>。</p><h1 id="f389" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak"> 1。简介</strong></h1><p id="2887" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在这篇文章中，我们将学习如何通过一种方法来建立一个模型，这种方法与普通的传统方法或其他Kaggle作品中使用的所谓raw方法完全不同。传统方法的缺点是在数据预处理、特征选择、模型选择、超参数调整等方面浪费了大量的时间..这些天来，许多汽车MI是可用的，可以很容易pip安装和使用非常有效。许多耗时的工作可以简单地用几行代码完成。在大多数情况下，这种方法比使用传统方法制作的模型精度更高。</p><h1 id="b313" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak"> 2。关于数据集</strong></h1><p id="6a04" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">表格中的每一行都代表一朵鸢尾花，包括它的种类和它的植物部分的尺寸，萼片和花瓣，以厘米为单位。在这里，我们正在寻找三种不同种类的鸢尾花。他们是</p><ol class=""><li id="4b2c" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated">杂色鸢尾</li><li id="9dd6" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">刚毛鸢尾</li><li id="0735" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">海滨鸢尾</li></ol><p id="91ff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它包括每种鸢尾的50个样本以及花的一些特征。一种花与另外两种花是线性可分的，但是另外两种花彼此不是线性可分的。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/77a584a73b1e9f3664f2c968b0e33677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NW4OXXsspVoa_lg7TNraSQ.png"/></div></div></figure><h1 id="a6e6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak"> 3。</strong>安装必要的软件包</h1><p id="376d" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在我们进入编码部分之前，首先导入所有必要的包。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5a7f" class="lq jq hi lm b fi lr ls l lt lu">!pip install pycaretimport numpy as np <em class="lv"># linear algebra</em><br/>import pandas as pd <em class="lv"># data processing, CSV file I/O (e.g. pd.read_csv)</em><br/>import matplotlib.pyplot as plt <em class="lv">#Data visualization </em><br/>import seaborn as sns <em class="lv">#Data visualization</em></span></pre><p id="33bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> pycaret </strong> : <em class="lv">我们这里使用的AutoML是pycaret </em></p><p id="2dcf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> numpy </strong>:用于线性代数的库</p><p id="0715" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> pandas </strong>:用于<em class="lv">数据处理的库，CSV文件I/O(如pd.read_csv </em></p><p id="0bad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">matplotlib :用于数据可视化的库。</p><p id="6188" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> seaborn </strong>:用于数据可视化的库。</p><h1 id="d6d5" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">4.获取数据</h1><p id="ebce" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们可以使用熊猫图书馆获得数据集。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="b1bd" class="lq jq hi lm b fi lr ls l lt lu"><em class="lv"># Getting the dataset to "dataset" variable</em><br/><br/>dataset = pd.read_csv("../input/iris/Iris.csv") <br/><em class="lv"># the iris dataset is now a Pandas DataFrame</em></span><span id="5713" class="lq jq hi lm b fi lw ls l lt lu"><em class="lv"># Showing first 5 rows.</em><br/><br/>dataset.head()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/3d8280690af116d9a184c23052f80b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*qLl2tg4Sjqixgi4GzmWSKQ.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">前五排</figcaption></figure><h1 id="c22f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">5.现在我们通过比较每一列来绘制图表。</h1><p id="c747" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><strong class="is hj"> a .花瓣长度&amp;花瓣宽度</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="110a" class="lq jq hi lm b fi lr ls l lt lu">sns.FacetGrid(dataset,hue='Species',size=5).map(plt.scatter,'PetalLengthCm','PetalWidthCm').add_legend()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/7e2e000898b32a1e6c3f22df46ed7039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*5EBCOdeDIZ98qLzjPbYyAQ.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated"><strong class="bd jr">花瓣长度&amp;花瓣宽度</strong></figcaption></figure><p id="0ebe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> b .萼片宽度&amp;花瓣宽度</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5c7a" class="lq jq hi lm b fi lr ls l lt lu">sns.FacetGrid(dataset,hue='Species',size=5).map(plt.scatter,'SepalWidthCm','PetalWidthCm').add_legend()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es md"><img src="../Images/726da1685f7fdc41c8189c87541dcf2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*5Q531sp1AK9ZDkBypiwqsw.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated"><strong class="bd jr">萼片宽度&amp;花瓣宽度</strong></figcaption></figure><p id="631b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> c .萼片宽度&amp;花瓣长度</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="fa2e" class="lq jq hi lm b fi lr ls l lt lu">sns.FacetGrid(dataset,hue='Species',size=5).map(plt.scatter,'SepalWidthCm','PetalLengthCm').add_legend()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es me"><img src="../Images/07cd0d110cc6ffb45ef0cd4205140fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*rl0c_Olgp_x193knSZ8y2A.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated"><strong class="bd jr">萼片宽度&amp;花瓣长度</strong></figcaption></figure><p id="b2d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> d .萼片长度&amp;花瓣宽度</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="ff01" class="lq jq hi lm b fi lr ls l lt lu">sns.FacetGrid(dataset,hue='Species',size=5).map(plt.scatter,'SepalLengthCm','PetalWidthCm').add_legend()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/b6e8743178af92ee47299d550d54f6d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*RT3ad-6v-b-Zd5tp_1n9JA.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated"><strong class="bd jr">萼片长度&amp;花瓣宽度</strong></figcaption></figure><p id="bc64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> e .萼片长度&amp;花瓣长度</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="f0b1" class="lq jq hi lm b fi lr ls l lt lu">sns.FacetGrid(dataset,hue='Species',size=5).map(plt.scatter,'SepalLengthCm','PetalLengthCm').add_legend()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/5561efba35ec4b2f12982f44051cbb64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*EbPq1cPo1hUbvU5Grn0mAQ.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated"><strong class="bd jr">萼片长度&amp;花瓣长度</strong></figcaption></figure><p id="97b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> f .萼片长度&amp;萼片宽度</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="bf75" class="lq jq hi lm b fi lr ls l lt lu">sns.FacetGrid(dataset,hue='Species',size=5).map(plt.scatter,'SepalLengthCm','SepalWidthCm').add_legend()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/841a075eb3064e0919e9f579cfe75fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*-5OqEGS3yJyJYAUihOysQQ.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated"><strong class="bd jr">萼片长度&amp;萼片宽度</strong></figcaption></figure><h1 id="ab2b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">6.检查数据集是否平衡或不平衡</h1><p id="08a7" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><strong class="is hj">没有空值，数据是完好的，所以这里不需要数据预处理。</strong></p><p id="5b86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们知道有三种不同的鸢尾花(即:杂色鸢尾、刚毛鸢尾和海滨鸢尾)。对于每个分类问题，如果数据集是平衡的(即:如果有两个类感染(1)和未感染(0)，总共有1000行数据，我们可以说数据集是平衡的，如果数据集的50%感染(1)，而另50%未感染(0))。在我们的例子中，如果所有三个物种都有大约相同数量的数据，那么这是最好的情况。(如果数据集不平衡，那么有很多机会出现欠拟合和过拟合)</p><p id="cb4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面我们来检查一下这个条件。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="6092" class="lq jq hi lm b fi lr ls l lt lu">dataset['Species'].value_counts().plot.pie(explode=[0.1,0.1,0.1],autopct='<strong class="lm hj">%1.1f%%</strong>',shadow=True,figsize=(10,8))<br/>plt.show()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/de37655ef12bff64461d79586fa6058e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wmqq3LnLLJhhZtgKJnBupA.png"/></div></div></figure><p id="6339" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">这是一个平衡数据集</strong></p><h1 id="e1e2" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">7.为模型选择准备数据</h1><p id="ebf2" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在这一步中，我们将数据集一分为二。第一部分包含用于训练和测试的95%的数据。剩余的5%被存储起来，并用于尝试我们开发的最终模型(该数据被命名为未见过的数据)。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/2f0d34e14ee019253e50955a06c1c775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UpZ8okrDekIeVszw5wqJ_w.png"/></div></div></figure><h1 id="c59f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">8.导入pycaret分类方法</h1><p id="8a42" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们在这里使用的自动Ml是pycaret。它的工作非常简单，因为我们想给数据集作为数据，我们的目标列作为目标。我们还可以设置一些其他功能，如下所示。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="d799" class="lq jq hi lm b fi lr ls l lt lu"><em class="lv"># Importing pycaret classification method</em><br/><br/>from pycaret.classification import *</span><span id="78ea" class="lq jq hi lm b fi lw ls l lt lu"><em class="lv"># This is the first step of model selection</em><br/><em class="lv"># Here the data is our datasets, target is the labeled <br/>column(dependent variable), section is is random number for future identification.</em></span><span id="d719" class="lq jq hi lm b fi lw ls l lt lu">exp = setup(data = data, target = 'Species', session_id=77 )<br/><br/><em class="lv"># After this we will get a list of our columns and its type, just confirm they are the same. Then hit enter.</em></span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/6533ab03f8e012b729c276f408d12804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*WIcy9EyG03zIpIpr1_QqmQ.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">我们得到的输出</figcaption></figure><blockquote class="ml mm mn"><p id="c963" class="iq ir lv is b it iu iv iw ix iy iz ja mo jc jd je mp jg jh ji mq jk jl jm jn hb bi translated">完成后，我们将得到一个列及其类型的列表，只需确认它们是相同的。然后按回车键。</p></blockquote><h1 id="0c78" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">9.比较模型</h1><p id="9273" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在确认列类型之后，我们可以用两个ML算法运行数据集，并比较性能，如下所示。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="b230" class="lq jq hi lm b fi lr ls l lt lu"><em class="lv">#This command is used to compare different models with our dataset.</em><br/><em class="lv">#The accuracy,F1 etc of each model is listed in a table.</em><br/><em class="lv">#Choose which model you want</em><br/>compare_models()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/45daade9493142b77adbc4124cedbb02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQTta5vR0Fzl6gjk51hLsw.png"/></div></div></figure><p id="e4ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上表中，我们可以看到许多具有良好精度的模型。</p><blockquote class="ml mm mn"><p id="0fef" class="iq ir lv is b it iu iv iw ix iy iz ja mo jc jd je mp jg jh ji mq jk jl jm jn hb bi translated"><em class="hi">下一步是决定使用哪种算法，然后复制它的代码。</em></p></blockquote><p id="4a42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">不同型号的代码如下。</strong></p><p id="53f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">逻辑回归<strong class="is hj">‘lr’</strong></p><p id="cb14" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">k最近邻<strong class="is hj">‘KNN’</strong></p><p id="7134" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">朴素贝叶斯<strong class="is hj">‘nb’</strong></p><p id="84cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">决策树<strong class="is hj">‘dt’</strong></p><p id="0787" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SVM(线性)<strong class="is hj">‘支持向量机’</strong></p><p id="086f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SVM(径向基函数)<strong class="is hj">‘径向基函数支持向量机’</strong></p><p id="5409" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">高斯过程<strong class="is hj">‘GPC’</strong></p><p id="3195" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">多层感知器<strong class="is hj">‘多层感知器’</strong></p><p id="7e60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">山脊分级机<strong class="is hj">‘山脊’</strong></p><p id="11ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随机森林<strong class="is hj">‘RF’</strong></p><p id="066d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">二次圆盘。分析<strong class="is hj">‘qda’</strong></p><p id="c419" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AdaBoost<strong class="is hj">‘ada’</strong></p><p id="fe6b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">梯度推进分类器<strong class="is hj"> 'gbc' </strong></p><p id="fd9e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">线性圆盘。分析<strong class="is hj">‘LDA’</strong></p><p id="d20b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">额外树分类器<strong class="is hj">‘et’</strong></p><p id="dff6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">极端梯度推进<strong class="is hj"> 'xgboost' </strong></p><p id="91ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">光梯度增强<strong class="is hj">‘light GBM’</strong></p><p id="a264" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">催化增强分类器<strong class="is hj">‘催化增强’</strong></p><h1 id="32d7" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">10.创建模型</h1><p id="3c57" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在使用代码创建模型。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="a191" class="lq jq hi lm b fi lr ls l lt lu"><em class="lv"># With this command we are creating a Naives Byes model</em><br/><em class="lv"># The code for Naives Byes is " nb "</em><br/><em class="lv"># fold is the number of fold you want</em><br/><br/>nb_model = create_model('nb', fold = 10)</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/d37c6a28e3cb3ad5bf3e59f9c43a8ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*s5jVgtnIieFOHukDbEMVww.png"/></div></figure><p id="c278" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该表显示了所有10次折叠的精确度和其他读数。</p><p id="8215" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在调整超参数。</p><blockquote class="ml mm mn"><p id="3076" class="iq ir lv is b it iu iv iw ix iy iz ja mo jc jd je mp jg jh ji mq jk jl jm jn hb bi translated"><em class="hi">调整hyper参数将有助于提高精确度和其他功能。</em></p></blockquote><h2 id="e693" class="lq jq hi bd jr mt mu mv jv mw mx my jz jb mz na kd jf nb nc kh jj nd ne kl nf bi translated">对于不平衡的数据集，我们主要看F1分数，因为我们的数据集是平衡的，我们可以使用精确度。</h2><blockquote class="ml mm mn"><p id="085b" class="iq ir lv is b it iu iv iw ix iy iz ja mo jc jd je mp jg jh ji mq jk jl jm jn hb bi translated">对于这些数据集，我们已经获得了100%的准确率。因此，没有t <em class="hi">调整超参数，</em>它会工作。</p></blockquote><h1 id="de54" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">11.调整超参数</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="419b" class="lq jq hi lm b fi lr ls l lt lu">nb_tuned = tune_model('nb')</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ng"><img src="../Images/69d22bbf219ea065bec8149a08de443a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*kTlk75YQN58Hv-XXpHf3ew.png"/></div></figure><h1 id="6c6c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">12.绘制ROC曲线</h1><p id="a12c" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">随着曲线向x和y轴移动，性能会提高。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="1a59" class="lq jq hi lm b fi lr ls l lt lu">plot_model(nb_tuned, plot = 'auc')</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es nh"><img src="../Images/006ecbf61b4bf61ce308796be5f40d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*Zg-wDSNkQcOO6GDS0nEUXQ.png"/></div></figure><h1 id="53a1" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">13.混淆矩阵</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="740d" class="lq jq hi lm b fi lr ls l lt lu">plot_model(nb_tuned, plot = 'confusion_matrix')</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ni"><img src="../Images/80eadd98f95ecfec1c537793d07166a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vMlj26neAdSvv6LWpAQ56A.png"/></div></div></figure><p id="9df8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们可以看到每一个值都被准确预测。一切都是积极的。</p><h1 id="7cd2" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">14.使用测试数据集预测准确性</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="ec08" class="lq jq hi lm b fi lr ls l lt lu">predict_model(nb_tuned);</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nj"><img src="../Images/79990acb0d3362ba0b403361b17c9187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*KswFSxxGgQR80Hnzs9qGqA.png"/></div></div></figure><h2 id="c0a3" class="lq jq hi bd jr mt mu mv jv mw mx my jz jb mz na kd jf nb nc kh jj nd ne kl nf bi translated">我们得到的精度为1(即100%的精度)</h2><h1 id="3779" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">15.用看不见的数据检查</h1><p id="dd4a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">最初，我们将一部分数据集分离为看不见的数据集，用于检查最终开发的模型。下面我们正在检查这个。结果是带有标签和分数(最后两列)的数据框。其中标签是预测的标签，分数是机器认为具有准确度的百分比。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5b91" class="lq jq hi lm b fi lr ls l lt lu">new_prediction = predict_model(nb_tuned, data=data_unseen)</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nk"><img src="../Images/338be01d95398f980d956dcb016a89a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*veSnbh-5ivI0OEwJdHJD3A.png"/></div></div></figure><h1 id="47c6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">16.摘要</h1><p id="5dbf" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">正如我们在上面看到的，我们得到了一个100%精确的高精度模型，没有过度拟合。自动Ml更受欢迎，因为它耗时更少，而且效果非常好。对于经验不足的人来说，超参数调整并不容易，但它对模型的性能有很大的影响。</p><p id="224f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">没有十全十美的，如果有人发现任何错误或建议，请在下面不吝赐教。</p></div></div>    
</body>
</html>