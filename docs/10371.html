<html>
<head>
<title>How to deploy Machine Learning models on Android and IOS with Telegram Bots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ç”¨Telegram Botsåœ¨Androidå’ŒIOSä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ æ¨¡å‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/how-to-deploy-machine-learning-models-on-android-and-ios-with-telegram-bots-a6fb16922741?source=collection_archive---------6-----------------------#2020-10-16">https://medium.com/analytics-vidhya/how-to-deploy-machine-learning-models-on-android-and-ios-with-telegram-bots-a6fb16922741?source=collection_archive---------6-----------------------#2020-10-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c36b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨è¿™ç¯‡åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•å°†æ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¸¦åˆ°æ‰‹æœºä¸Šï¼Œæ— è®ºæ˜¯Androidè¿˜æ˜¯IOSï¼Œéƒ½å¯ä»¥ä½¿ç”¨Telegram Botsï¼Œå¹¶å…è´¹å°†å…¶æ‰˜ç®¡åœ¨herokuä¸Šã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/fb0fbb8370018d862bfc0e3924123484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSRoEMbi3XTZJ4D6U8irLg.png"/></div></div></figure><p id="369e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘æ•¢è‚¯å®šï¼Œä½ å·²ç»çœ‹åˆ°äº†æˆ‘çš„é¢å…·æ£€æµ‹æœºå™¨äººæ¼”ç¤ºã€‚å¦‚æœä½ è¿˜æ²¡æœ‰<a class="ae jp" href="https://youtu.be/i1-vxmxwqGA" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">ç‚¹å‡»è¿™é‡Œ</strong> </a>ã€‚æˆ‘å°†ä¸€æ­¥ä¸€æ­¥åœ°æè¿°ä½ å¦‚ä½•åœ¨å‡ åˆ†é’Ÿå†…å®ŒæˆåŒæ ·çš„äº‹æƒ…ã€‚ä½†é¦–å…ˆï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œè¿™ä¸ªé¢å…·æ£€æµ‹æœºå™¨äººå¦‚ä½•æœ‰ç”¨ï¼Ÿ</p><h1 id="c823" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">è¿™ä¸ªé¡¹ç›®çš„çµæ„Ÿ</h1><p id="0e89" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">å½“æˆ‘çœ‹åˆ°ä¼˜æ­¥çš„è¿™æ¡æ¨æ–‡æ—¶ï¼Œæˆ‘æœ‰äº†è¿™ä¸ªæƒ³æ³•ï¼Œä»‹ç»äº†ä»–ä»¬ä¸ºå¸æœºå’Œä¹˜å®¢æä¾›çš„é¢å…·éªŒè¯åŠŸèƒ½:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kt ku l"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">ä¼˜æ­¥çš„æ¨ç‰¹</figcaption></figure><p id="9f3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å—¯ï¼Œæˆ‘æƒ³åšåŒæ ·çš„äº‹æƒ…ï¼Œé‡ç°ç”¨æˆ·ä½“éªŒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­æ‹ç…§ï¼Œç„¶åæœ‰ä¸€ä¸ªé®ç½©æ£€æµ‹å“åº”ã€‚</p><p id="45c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸å¹¸çš„æ˜¯ï¼Œåƒå¤§å¤šæ•°æ•°æ®ç§‘å­¦å®¶å’Œæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆä¸€æ ·ï¼Œæˆ‘æ²¡æœ‰ç§»åŠ¨åº”ç”¨ç¨‹åºåˆ›å»ºæŠ€èƒ½ã€‚æˆ‘æƒ³è¿‡å­¦ä¹ Flutterï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥åœ¨IOSå’ŒAndroidä¸Šéƒ¨ç½²ï¼Œä½†æ˜¯ï¼Œå˜¿ï¼Œæˆ‘å·²ç»æœ‰ä¸€ä¸ªæŠ€èƒ½åˆ—è¡¨è¦å­¦ä¹ äº†ã€‚</p><p id="e2f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘åæ¥å‘ç°ï¼Œä½ å¯ä»¥åœ¨Telegramä¸Šå…è´¹åˆ›å»ºæœºå™¨äººï¼Œå› ä¸ºTelegramå¯ä»¥åœ¨æ‰€æœ‰ç§»åŠ¨å¹³å°ä¸Šä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨windowsï¼Œmacå’Œlinuxä¸Šä½¿ç”¨ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥ç”¨æ¥æœåŠ¡äºæ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚</p><p id="40b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é‚£ä¹ˆï¼Œè¿™ä¸ªé¡¹ç›®æˆ‘ä»¬éœ€è¦ä»€ä¹ˆ:</p><ul class=""><li id="d54c" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">æ•°æ®:æˆ´å£ç½©çš„äººå’Œä¸æˆ´å£ç½©çš„äººçš„å›¾åƒ</li><li id="62b1" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">æ¨¡å‹:æˆ‘ä»¬å°†ä½¿ç”¨Fastai v2æ¥è®­ç»ƒä¸€ä¸ªåˆ©ç”¨è¿ç§»å­¦ä¹ çš„æ¨¡å‹</li><li id="6d04" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">ç”µæŠ¥è´¦æˆ·:æ˜¾ç„¶</li><li id="78ee" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">Herokuå¸æˆ·:ç”¨äºæ‰˜ç®¡</li></ul><p id="3d4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¼€å§‹å§ã€‚</p><h1 id="33c0" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">æ•°æ®</h1><p id="d857" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">æˆ‘ä¸å¿…ä»å¤´å¼€å§‹æ„å»ºæ•°æ®é›†ã€‚æˆ‘æ˜¯é€šè¿‡<a class="ae jp" href="https://www.linkedin.com/in/prajna-bhandary-0b03a416a/" rel="noopener ugc nofollow" target="_blank">èˆ¬è‹¥æ³¢ç½—èœœå¤š</a>æ‰¾åˆ°è¿™ä¸ª<a class="ae jp" href="https://github.com/prajnasb/observations" rel="noopener ugc nofollow" target="_blank">å›è´­</a>çš„ã€‚å¥¹å·²ç»åšäº†è¿™é¡¹å·¥ä½œã€‚ä½ å¯ä»¥åœ¨å®éªŒæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ•°æ®ã€‚690ä¸ªæˆ´é¢å…·çš„äººçš„å›¾åƒåœ¨åä¸ºâ€œå¸¦é¢å…·â€çš„æ–‡ä»¶å¤¹ä¸­ï¼Œ686ä¸ªä¸æˆ´é¢å…·çš„äººçš„å›¾åƒåœ¨åä¸ºâ€œä¸å¸¦é¢å…·â€çš„æ–‡ä»¶å¤¹ä¸­ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚è®©æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªæ¨¡å‹</p><h1 id="ab02" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">ä½¿ç”¨Fastai v2è¿›è¡Œæ¨¡å‹è®­ç»ƒ</h1><p id="0feb" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">æˆ‘æœ€è¿‘å¼€å§‹ç”¨<a class="ae jp" href="https://www.amazon.fr/Deep-Learning-Coders-Fastai-Pytorch/dp/1492045527" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">ç¨‹åºå‘˜æ·±åº¦å­¦ä¹ </strong> </a>çš„ä¹¦å­¦ä¹ fastaiã€‚æ‰€ä»¥ï¼Œè¿™æ˜¯ä¸€ä¸ªé”»ç‚¼æˆ‘æŠ€èƒ½çš„æœºä¼šã€‚å¦å¤–ï¼Œä½¿ç”¨fastai v2å­¦ä¹ Transfertåªéœ€5æˆ–6è¡Œä»£ç ã€‚ä½†æˆ‘ä¹Ÿå¯ä»¥ç”¨Tensorflow 2.0æ¥åšï¼Œå¾—åˆ°åŒæ ·çš„ç»“æœã€‚</p><p id="9447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬å®‰è£…<a class="ae jp" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank"> fastai </a>ã€‚å»ºè®®åœ¨åº·è¾¾ç¯å¢ƒä¸‹åšã€‚å®‰è£…fastbookå¹¶è·å–ä¸€äº›å®ç”¨ç¨‹åºæ–‡ä»¶:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="97af" class="ls jr hi lo b fi lt lu l lv lw">conda install -c fastai -c pytorch fastai<br/>pip install -Uqq fastbook</span></pre><p id="9a67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‰“å¼€ç¬”è®°æœ¬ï¼Œè®©æˆ‘ä»¬å¯¼å…¥æ‰€éœ€çš„æ‰€æœ‰å†…å®¹:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="d4c7" class="ls jr hi lo b fi lt lu l lv lw">import fastbook<br/>fastbook.setup_book()<br/>from fastbook import *<br/>from fastai.vision.all import *</span></pre><p id="89ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ•°æ®ç›®å½•çš„è·¯å¾„:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="9e6b" class="ls jr hi lo b fi lt lu l lv lw">path = Path("../data")</span></pre><p id="86fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ˜¯æ—¶å€™åˆ›å»ºæ•°æ®åŠ è½½å™¨äº†ã€‚å°±è¿™ä¹ˆç®€å•ã€‚æ•°æ®å—å°†è·å–å›¾åƒï¼Œä½¿ç”¨å…¶ä¸­çš„20%è¿›è¡ŒéªŒè¯ï¼Œé€šè¿‡è·å–çˆ¶ç›®å½•åè·å–æ ‡ç­¾ï¼Œå¹¶å°†æ‰€æœ‰å›¾åƒçš„å¤§å°è°ƒæ•´ä¸º128*128*3</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="bf92" class="ls jr hi lo b fi lt lu l lv lw">mask = DataBlock(<br/>    blocks=(ImageBlock, CategoryBlock), <br/>    get_items=get_image_files, <br/>    splitter=RandomSplitter(valid_pct=0.2, seed=42),<br/>    get_y=parent_label,<br/>    item_tfms=Resize(128))</span></pre><p id="6efa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹éªŒè¯é›†ä¸­çš„ä¸€äº›å›¾åƒ:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="843b" class="ls jr hi lo b fi lt lu l lv lw">dls = mask.dataloaders(path)<br/>dls.valid.show_batch(max_n=10, nrows=2)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/7d09c6e9e35afaf6ac46597b6a4d6262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nSnhwRNA113Wwp3EpXfHw.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">æˆ‘ä»¬çš„æ©æ¨¡æ£€æµ‹æ•°æ®é›†çš„ä¸€äº›å›¾åƒ</figcaption></figure><p id="e212" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å·²ç»å¯ä»¥çœ‹åˆ°ï¼Œä¸€äº›å›¾åƒæ˜¯é€šè¿‡ç®€å•åœ°åœ¨äººä»¬çš„è„¸ä¸Šæ·»åŠ ä¸€ä¸ªé¢å…·è€Œäº§ç”Ÿçš„ã€‚å¾ˆé«˜å…´çŸ¥é“ã€‚</p><p id="72d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥æ·»åŠ ä¸€äº›æ•°æ®æ‰©å……æ­¥éª¤ï¼Œå¹¶ä½¿ç”¨resnet18é€šè¿‡Transfert learningè®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="da0d" class="ls jr hi lo b fi lt lu l lv lw">mask = mask.new(<br/>    item_tfms=RandomResizedCrop(224, min_scale=0.5),<br/>    batch_tfms=aug_transforms())<br/>dls = mask.dataloaders(path)</span><span id="0e07" class="ls jr hi lo b fi ly lu l lv lw">learn = cnn_learner(dls, resnet18, metrics=error_rate)<br/>learn.fine_tune(4)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/16ede8b37fc0f01887b29143caafdf1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*SvClF0fyl0m9QGqh-qvMBg.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">åŸ¹å…»</figcaption></figure><p id="e4ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å°±è¿™æ ·ï¼Œåœ¨æˆ‘çš„æœ¬åœ°æœºå™¨ä¸Šï¼Œä»…ä»…2åˆ†é’Ÿï¼Œæˆ‘ä»¬å°±æœ‰äº†99 %çš„å‡†ç¡®ç‡ã€‚å¤šç¥å¥‡å•Šï¼è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ··æ·†çŸ©é˜µ:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/15545e465f24232d8152f48dd015cf7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*Bul9JAPdyZnPakhMfuH1Qw.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">æ··æ·†çŸ©é˜µ</figcaption></figure><p id="31e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åªæœ‰2ä¾‹æ²¡æœ‰æˆ´å£ç½©çš„äººè¢«è¯¯å½’ç±»ä¸ºæˆ´å£ç½©ã€‚æˆ‘ä»¬å¯ä»¥å¯¼å‡ºè¿™ä¸ªæ¨¡å‹ï¼Œå¹¶å¼€å§‹ä¸ºæˆ‘ä»¬çš„æœºå™¨äººç¼–å†™ä»£ç ã€‚</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="6c44" class="ls jr hi lo b fi lt lu l lv lw">learn.export("model.pkl")</span></pre><h1 id="8191" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">æˆ‘ä»¬æ¨¡å‹çš„ç”µæŠ¥æœºå™¨äºº</h1><p id="245b" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">è¿™æ˜¯æœ‰è¶£çš„éƒ¨åˆ†ï¼Œè€Œä¸”å‡ºä¹æ„æ–™çš„ç®€å•ã€‚è¦åœ¨Telegramä¸Šåˆ›å»ºä¸€ä¸ªæœºå™¨äººï¼Œåœ¨Telegramä¸Šæœç´¢<strong class="ih hj">æœºå™¨äººçˆ¶äº²</strong>ï¼Œå‘é€è¿™ä¸ªå‘½ä»¤:<strong class="ih hj"> /newbot </strong>ï¼Œå®ƒä¼šè¯¢é—®ä½ çš„æœºå™¨äººçš„åå­—å’Œç”¨æˆ·åã€‚ä¸€æ—¦ä½ å®Œæˆäº†è¿™äº›æ­¥éª¤ï¼Œä½ å°†è·å¾—ä¸€ä¸ª<strong class="ih hj">é“¾æ¥</strong>æ¥è®¿é—®ä½ çš„æœºå™¨äººï¼Œä»¥åŠä¸€ä¸ª<strong class="ih hj">ä»¤ç‰Œ</strong>ï¼Œå®ƒå°†åœ¨ä»£ç ä¸­è¢«ç”¨æ¥ä¸æœºå™¨äººäº¤äº’ã€‚</p><p id="19be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¤§æ¦‚æ˜¯è¿™æ ·çš„:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/44577b042ed1a1544085bf9db3db3689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*5_jT1t-hAeRh6weSoKDAFg.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">åƒµå°¸çˆ¶äº²</figcaption></figure><p id="a29d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å»ä½ æœ€å–œæ¬¢çš„ä»£ç ç¼–è¾‘å™¨ï¼Œå¯¹æˆ‘æ¥è¯´æ˜¯Pycharmï¼Œè®©æˆ‘ä»¬ä¸ºè¿™ä¸ªæœºå™¨äººå†™è„šæœ¬ã€‚</p><p id="83e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†ä½¿ç”¨<a class="ae jp" href="https://github.com/python-telegram-bot/python-telegram-bot" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> python-telegram-botåº“</strong> </a>ã€‚å®‰è£…æ–¹å¼:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="2de3" class="ls jr hi lo b fi lt lu l lv lw">pip install python-telegram-bot</span></pre><p id="6079" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½¿ç”¨fastaiç…§å¸¸å¯¼å…¥åº“ä»¥è¿›è¡Œæ¨¡å‹åŠ è½½:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="b9c6" class="ls jr hi lo b fi lt lu l lv lw">import logging<br/>from telegram.ext import Updater, CommandHandler, MessageHandler, Filters<br/>from fastai.vision.all import load_learner</span></pre><p id="e9e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‰€æœ‰ç”µæŠ¥æœºå™¨äººå¿…é¡»ä¸ºç‰¹æ®Šå‘½ä»¤<strong class="ih hj">/å¼€å§‹</strong>å’Œ<strong class="ih hj">/å¸®åŠ©</strong>å®šä¹‰ä¸€ä¸ªåŠŸèƒ½ã€‚</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="22fe" class="ls jr hi lo b fi lt lu l lv lw">def start(update, context):<br/>    update.message.reply_text(<br/>        "Bot by @kevindegila on Twitter \n\n "<br/>        "EN : Just send me a photo of you and I will tell you if you're wearing a mask ğŸ˜ \n"<br/>        "FR : Envoie moi une photo de toi et je te dirai si tu portes un masque ğŸ˜"<br/>    )<br/><br/><br/>def help_command(update, context):<br/>    update.message.reply_text('My only purpose is to tell you if you are wearing a mask. Send a photo')</span></pre><p id="5ca5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æ‚¨æ‰€è§ï¼Œè¿™äº›å‡½æ•°å°†æ›´æ–°å’Œä¸Šä¸‹æ–‡ä½œä¸ºè¾“å…¥ï¼Œå¹¶ä½¿ç”¨<strong class="ih hj">update . message . reply _ text()</strong>å‡½æ•°å‘æœºå™¨äººå‘é€æ–‡æœ¬ã€‚</p><p id="fb51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Updaterç±»çš„ä¸€ä¸ªå®ä¾‹æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤å’Œæ¶ˆæ¯ï¼Œå°†å®ƒä»¬è½¬å‘ç»™è°ƒåº¦ç¨‹åºï¼Œè°ƒåº¦ç¨‹åºå°†æ¶ˆæ¯å‘é€ç»™ä¸åŒçš„å¤„ç†ç¨‹åº:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="ae4d" class="ls jr hi lo b fi lt lu l lv lw">def main():<br/>    updater = Updater(token="token", use_context=True)<br/>    dp = updater.dispatcher</span><span id="6e18" class="ls jr hi lo b fi ly lu l lv lw">    dp.add_handler(CommandHandler("start", start))<br/>    dp.add_handler(CommandHandler("help", help_command))</span><span id="d6c7" class="ls jr hi lo b fi ly lu l lv lw">    updater.start_polling()<br/>    updater.idle()</span><span id="7930" class="ls jr hi lo b fi ly lu l lv lw">if __name__ == '__main__':<br/>    main()</span></pre><p id="e7c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨è¿™ä¸€æ­¥ï¼Œæ‚¨å¯ä»¥é€šè¿‡è¿è¡Œè„šæœ¬æ¥è¿è¡Œæ‚¨çš„botï¼Œå¹¶ä¸ºç‰¹æ®Šå‘½ä»¤å‘é€æ¶ˆæ¯ã€‚</p><p id="056a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬æ·»åŠ é®ç½©æ£€æµ‹åŠŸèƒ½ã€‚æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥åŠ è½½æˆ‘ä»¬çš„æ¨¡å‹ï¼Œå¦ä¸€ä¸ªå‡½æ•°ç”¨äºæ¥æ”¶æ¥è‡ªç”¨æˆ·çš„å›¾åƒï¼Œå¹¶å°†è¿™ä¸ªå‡½æ•°ä¼ é€’ç»™å¸¦æœ‰å›¾åƒè¿‡æ»¤å™¨çš„æ¶ˆæ¯å¤„ç†ç¨‹åº:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="146e" class="ls jr hi lo b fi lt lu l lv lw">def load_model():<br/>    global model<br/>    model = load_learner('model/model.pkl')<br/>    print('Model loaded')</span><span id="65ce" class="ls jr hi lo b fi ly lu l lv lw">def detect_mask(update, context):<br/>    user = update.message.from_user<br/>    photo_file = update.message.photo[-1].get_file()<br/>    photo_file.download('user_photo.jpg')<br/>    <br/>    label = model.predict('user_photo.jpg')[0]<br/>    if label == "with_mask":<br/>        update.message.reply_text(<br/>            "EN: Looks like you are wearing a mask ğŸ˜·. I hope you don't forget it when going out!ğŸ˜‰ \n\n"<br/>            "FR: On dirait que tu portes un masque ğŸ˜·, J'espÃ¨re que tu ne l'oublies pas quand tu sors! ğŸ˜‰"<br/>        )<br/>    else:<br/>        update.message.reply_text(<br/>            "EN: Looks like you are not wearing a mask ğŸ˜·. Please wear one and stay safe ğŸ™„\n\n"<br/>            "FR: On dirait que tu ne portes pas un masque ğŸ˜·. S'il te plait, va en porter un. Fais attention ğŸ™„"<br/>        )</span></pre><p id="0916" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ˜¯å¦‚ä½•ä¸‹è½½å›¾ç‰‡å¹¶å°†å…¶ä¼ é€’ç»™æˆ‘ä»¬çš„æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨<strong class="ih hj">label = model . predict(' user _ photo . jpg ')[0]</strong>è·å¾—æ ‡ç­¾çš„ã€‚æˆ‘ä»¬åªæ˜¯æ ¹æ®é¢„æµ‹çš„æ ‡ç­¾å‘é€ä¸åŒçš„æ¶ˆæ¯ã€‚</p><p id="726a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬ä¸»è¦åŠŸèƒ½ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="1de1" class="ls jr hi lo b fi lt lu l lv lw">def main():<br/>    load_model()<br/>    updater = Updater(token="token", use_context=True)<br/>    dp = updater.dispatcher<br/>    dp.add_handler(CommandHandler("start", start))<br/>    dp.add_handler(CommandHandler("help", help_command))<br/><br/>    dp.add_handler(MessageHandler(Filters.photo, detect_mask))<br/><br/>    updater.start_polling()<br/>    updater.idle()</span></pre><p id="b064" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™å°±æ˜¯æˆ‘ä»¬çš„æœºå™¨äººã€‚ä¸€åˆ‡éƒ½å‡†å¤‡å¥½äº†ï¼Œå®ƒåº”è¯¥å¯ä»¥åœ¨ä½ çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šå·¥ä½œã€‚</p><p id="0804" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬å…è´¹åœ¨herokuä¸Šéƒ¨ç½²å®ƒã€‚</p><h1 id="c9ff" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">åœ¨Herokuéƒ¨ç½²ç”µæŠ¥æœºå™¨äºº</h1><p id="dc5c" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">å¦‚æœæ‚¨è¿˜æ²¡æœ‰å¸æˆ·ï¼Œè¯·å‰å¾€<a class="ae jp" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank">https://www.heroku.com/</a>æ³¨å†Œã€‚ç¬¬äºŒæ­¥æ˜¯ç‚¹å‡»<strong class="ih hj">æ–°å»º</strong>æŒ‰é’®ï¼Œè¿›å…¥ä½ çš„ã€https://dashboard.heroku.com/ã€‘T2åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åº:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/865799b4157e376aba2fad131976fb00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*wirEDPFW0n-ICeg7xZt-oQ.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">herokuä¸Šçš„åº”ç”¨ç¨‹åºåˆ›å»º</figcaption></figure><p id="19fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åˆ›å»ºåº”ç”¨ç¨‹åºåï¼Œæ‚¨éœ€è¦åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­åˆ›å»º3ä¸ªç‰¹æ®Šæ–‡ä»¶:</p><ul class=""><li id="bdab" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">ä¸€ä¸ªåä¸º<strong class="ih hj"> Procfile </strong>çš„æ–‡ä»¶å‘Šè¯‰Herokuå¦‚ä½•è¿è¡Œä½ çš„ä»£ç :</li></ul><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="d0ed" class="ls jr hi lo b fi lt lu l lv lw">worker: python main.py</span></pre><ul class=""><li id="5161" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">ä¸€ä¸ªåä¸ºruntime.txtçš„æ–‡ä»¶ï¼Œå‘Šè¯‰Herokuå®‰è£…å“ªä¸ªç‰ˆæœ¬çš„Python:</li></ul><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="3232" class="ls jr hi lo b fi lt lu l lv lw">python-3.7.0</span></pre><ul class=""><li id="bc4a" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">ä¸€ä¸ªåä¸ºrequirements.txtçš„æ–‡ä»¶ï¼Œå‘Šè¯‰herokuå®‰è£…ä¸€äº›åº“ã€‚è¿™é‡Œæˆ‘ä»¬å®‰è£…äº†Pytorchçš„cpuç‰ˆæœ¬ï¼Œä»¥é¿å…è¶…è¿‡Herokuä¸Š500Mbçš„slugå¤§å°ã€‚ç¡®ä¿å°†fastaiè®¾ç½®ä¸ºä¸æ‚¨è®­ç»ƒæ¨¡å‹æ—¶ä½¿ç”¨çš„ç‰ˆæœ¬ç›¸åŒ:</li></ul><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="0ac6" class="ls jr hi lo b fi lt lu l lv lw">python-telegram-bot<br/>-f https://download.pytorch.org/whl/torch_stable.html<br/>fastai==2.0.13<br/>torch==1.6.0+cpu<br/>torchvision==0.7.0+cpu</span></pre><p id="0f90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæ‚¨åªéœ€æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼Œå°±å¯ä»¥æ‰˜ç®¡æ‚¨çš„botå¹¶éšæ—¶å¯ç”¨:</p><ul class=""><li id="6747" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">åˆ›å»ºä¸€ä¸ªrepoå¹¶å°†æ‰€æœ‰æ–‡ä»¶æäº¤ç»™master</li><li id="61f2" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">ç¼–å†™<strong class="ih hj"> herokuç™»å½•</strong>å‘½ä»¤æ¥è¿æ¥åˆ°æ‚¨çš„herokuå¸æˆ·</li><li id="c644" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">å°†herokuæ·»åŠ ä¸ºè¿œç¨‹å›è´­ï¼Œä½¿ç”¨<strong class="ih hj">heroku git:remote-a app _ name</strong>ä½œä¸ºæ‚¨åœ¨herokuä¸Šçš„åº”ç”¨åç§°</li><li id="520c" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">é€šè¿‡ä½¿ç”¨<strong class="ih hj"> git push heroku master </strong>å°†æ‚¨çš„ä»£ç æ¨é€åˆ°Herokuè¿›è¡Œéƒ¨ç½²</li></ul><p id="abd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å°±æ˜¯è¿™æ ·ã€‚æ‚¨å¯ä»¥é€šè¿‡æµ‹è¯•telegramå¹¶æŸ¥çœ‹å¸¦æœ‰<strong class="ih hj">heroku logs-tail</strong>çš„æ—¥å¿—æ¥æ£€æŸ¥ä¸€åˆ‡æ˜¯å¦æ­£å¸¸ã€‚</p><h1 id="38b8" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">å…³äºä¼¦ç†çš„å‡ ç‚¹æ€è€ƒ</h1><p id="8155" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">åˆ›å»ºè¿™æ ·çš„é¡¹ç›®æ—¶ï¼Œæœ‰å‡ ä»¶äº‹å€¼å¾—è€ƒè™‘:</p><ul class=""><li id="58fa" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated"><strong class="ih hj">å…³äºå‹å·</strong>:å®ƒèƒ½è¯†åˆ«æ‰€æœ‰è‚¤è‰²ã€æ‰€æœ‰æ€§åˆ«çš„é¢è†œå—ï¼Ÿåœ¨éƒ¨ç½²è¿™ç§æ¨¡å‹ä¹‹å‰ï¼Œæ‚¨å¿…é¡»æ£€æŸ¥åå·®ã€‚</li><li id="950c" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj">å…³äºbot </strong>:åº”è¯¥ä¿å­˜ç”¨æˆ·å›¾ç‰‡å—ï¼Ÿä»–ä»¬åŒæ„æ”¶é›†ä»–ä»¬çš„æ•°æ®äº†å—ï¼Ÿåœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œæˆ‘æ²¡æœ‰ä¸ºè¿™ä¸ªæœºå™¨äººä¿å­˜å›¾åƒã€‚å¦‚æœæˆ‘åšäº†ï¼Œæ— è®ºå¦‚ä½•æˆ‘éƒ½ä¼šè¶…è¿‡å­å¼¹çš„å°ºå¯¸ã€‚</li></ul><p id="e6e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æƒ³äº†è§£æ›´å¤šå…³äºäººå·¥æ™ºèƒ½ä¼¦ç†çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹fast.aiçš„è¯¾ç¨‹:<a class="ae jp" href="https://ethics.fast.ai/" rel="noopener ugc nofollow" target="_blank">https://ethics.fast.ai/</a></p><h1 id="6815" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">ç»“è®º</h1><p id="3fee" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<strong class="ih hj">ç”µæŠ¥æœºå™¨äºº</strong>ï¼Œå®ƒå¯ä»¥åˆ¤æ–­ç”¨æˆ·çš„ç…§ç‰‡ä¸Šæ˜¯å¦æˆ´ç€<strong class="ih hj">é¢å…·</strong>ã€‚æˆ‘ä»¬ç”¨<strong class="ih hj"> fastai v2 </strong>å’Œæ æ†<strong class="ih hj">transfer learning</strong>è®­ç»ƒæ¨¡å‹ã€‚è¿™ä¸ªæœºå™¨äººæ˜¯ä½¿ç”¨<strong class="ih hj"> python-telegram-bot </strong>åº“åˆ›å»ºçš„ï¼Œæˆ‘ä»¬å°†æˆ‘ä»¬çš„æœºå™¨äººéƒ¨ç½²åœ¨<strong class="ih hj"> Heroku </strong>ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬çš„æœºå™¨äººå°±å¯ä»¥éšæ—¶å¯ç”¨ã€‚</p><p id="4aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœä½ è¯»åˆ°æœ€åï¼Œæˆ‘é¼“åŠ±ä½ ä¸ºè¿™ç¯‡æ–‡ç« é¼“æŒå¹¶åˆ†äº«å®ƒã€‚å¦‚æœä½ ä¼šæ³•è¯­ï¼Œå¯ä»¥åœ¨æˆ‘çš„<a class="ae jp" href="https://www.youtube.com/channel/UC5tyoKrTlhBSM9NkQYW1RzA" rel="noopener ugc nofollow" target="_blank"> Youtube </a>é¢‘é“çœ‹<a class="ae jp" href="https://youtu.be/i1-vxmxwqGA" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">è§†é¢‘</strong> </a>æ•™ç¨‹ï¼Œæœ‰é—®é¢˜å¯ä»¥åŠ å…¥æˆ‘çš„discordæœåŠ¡å™¨:<a class="ae jp" href="https://www.youtube.com/redirect?q=https%3A%2F%2Fdiscord.gg%2FsHE5exZ&amp;event=video_description&amp;v=dVJPSWkpBKo&amp;redir_token=QUFFLUhqbG5vT1BkSmxzVVA4SzFGb0JtNkR4M0EyMnI0QXxBQ3Jtc0trcVRMTVdHMHFoS2FoZmRKQzFNSmZhTDMzOUJFQ1dMdHlsTkJ1bV93c3V5WEdEc0FVTjVMS0FVTXl5Zl95dENnREZabUxIN3BBVlZxTzRKWkRyc0tWQTdGUDFyZV8tZWYwM0VoYzhwMXYySGIxUHh1MA%3D%3D" rel="noopener ugc nofollow" target="_blank">https://discord.gg/sHE5exZ</a></p><p id="c8b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¹Ÿæ¬¢è¿åœ¨twitterä¸Šæå‡ºåé¦ˆå’Œé—®é¢˜ã€‚</p></div></div>    
</body>
</html>