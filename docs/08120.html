<html>
<head>
<title>Basic of Deep Neural Networks In Vision — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">视觉深度神经网络基础—第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basic-of-deep-neural-networks-in-vision-part-1-c735dc86d66f?source=collection_archive---------9-----------------------#2020-07-18">https://medium.com/analytics-vidhya/basic-of-deep-neural-networks-in-vision-part-1-c735dc86d66f?source=collection_archive---------9-----------------------#2020-07-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0bcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个博客是对深度神经网络基础的介绍。有一种人工智能的嗡嗡声，你想知道它们是如何工作的吗？我将在视觉中深入报道AI的一切，所以让我们从基础开始，这个博客将会给你一个关于DNN的内核、通道和训练的直觉……</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="http://gph.is/1yLdu6J" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h1 id="7783" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">所以让我们开始吧…</h1><p id="7410" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">深度神经网络(DNN)的基本组件是内核和通道。在开始之前，我将解释人工智能和视觉的过程。</p><h1 id="dc32" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">该过程(简述)</h1><p id="165b" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在视觉中，输入数据是图像，图像被馈送到神经网络。最初的几个核充当过滤器来识别图像的基本构建块，即边缘和梯度。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ks"><img src="../Images/5f619875b5329bf8919201b84fea1938.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*9ItsFRWtu1TZFBDoyUlZ2w.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://distill.pub/2017/feature-visualization/" rel="noopener ugc nofollow" target="_blank">边缘和渐变</a></figcaption></figure><p id="2f3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">后面的几个内核过滤纹理和图案，</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kv"><img src="../Images/f97ae2a813a43369b8513bfe0d4ee26d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*0eG09DMQFGSaNIi8E_Fi3A.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://distill.pub/2017/feature-visualization/" rel="noopener ugc nofollow" target="_blank">纹理和图案</a></figcaption></figure><p id="0f87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后内核过滤对象的部分，</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kw"><img src="../Images/2fabce0c68f0fff83de590fad963c212.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*v2UkKYgnBRtZ2DYCccaakQ.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://distill.pub/2017/feature-visualization/" rel="noopener ugc nofollow" target="_blank">物体的部件</a></figcaption></figure><p id="f2ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后他们过滤物体</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kx"><img src="../Images/3b1ca974ada030e86a4e030fe498907c.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*-q_IEO9mkCcVTF7oFmquaA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://distill.pub/2017/feature-visualization/" rel="noopener ugc nofollow" target="_blank">对象</a></figcaption></figure><p id="7488" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您在上面看到的图像是特征图，即作为过滤操作的输出而产生的通道。在上面的图像右下角有一张狗的特征图，因此如果有狗出现在图像中:这个频道会确认它。所以让我们理解什么是通道和内核。</p><h1 id="16ea" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">频道</h1><p id="c464" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">每个频道都是一个特定信息的容器，容器是用来装东西的对象。让我们以电视为例:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ky"><img src="../Images/636831ff1d49868d75d6603499e2a148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*2jXKt8h1LuLOxGEIxRqxLA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://techcrunch.com/2019/04/10/t-mobile-officially-unveils-its-home-tv-service-tvision-home/" rel="noopener ugc nofollow" target="_blank">电视频道</a></figcaption></figure><p id="c393" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，你在图像中看到的每个频道都播放特定信息的节目。你永远无法期待卡通电视网的新闻或CNN的动画/卡通。在这里，每个频道都是一个存储数小时视频和信息的容器。</p><p id="0127" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此在DNN，这些代表包含地图特征的容器。因此，从“过程”中的图像，我们看到了边缘和梯度的通道，纹理和图案，物体和物体的部分。</p><h1 id="389a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">核心</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kz"><img src="../Images/8ebd9d1736a4705f5d6ebfef9204ac91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48V9Z3yXHZXcn3UFbOTEbQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">3x3内核</figcaption></figure><p id="6e37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">内核是为我们提取特征的家伙。内核也可以被称为过滤器或特征提取器。它的任务是获取输入并从中提取特征，并将它们存储在称为通道的特征图中。这里，层1是输入层，层1中的每个方块是图像中的一个像素，是一个神经元。绿色网格是在输入通道上运行的内核，即滤除边缘和梯度的图像。第一层内核的输出存储在第二层。在第2层，再次运行一个新内核，其输出将存储在第3层。</p><p id="8c50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以你可能想知道这些内核值应该是什么，才能过滤出想要的对象。我将简要介绍培训内容(深入第2部分)。</p><h2 id="2c4e" class="le jq hi bd jr lf lg lh jv li lj lk jz iq ll lm kd iu ln lo kh iy lp lq kl lr bi translated"><strong class="ak">内核初始化</strong></h2><p id="2a7d" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">内核值是从一组随机数中随机分配的。我们不能让内核值为0或1或任何值，除了从零开始训练的随机值。原因如下:</p><p id="ddfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">内核是过滤器，它对输入图像进行处理，并给出通道作为输出。如果所有的值都是0，所有的卷积运算(在第2部分中讨论)都将是0。让我们以过滤茶叶为例:全0表示过滤器没有开口来过滤茶叶中的茶叶。因此，当我们通过过滤器倒茶时，我们将一无所获。</p><p id="ae26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们用1初始化所有的内核值，我们将得到相同的内核，给出相同的通道作为输出。内核的任务应该是分离，如果我们有相同的过滤器，它将产生相同的结果。举个例子:如果用来分离茶叶和茶叶的过滤器是打开的(没有网)，它会把同样的未过滤的茶叶还回去。</p><h1 id="9ae0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">感受野</h1><p id="f2be" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">这是DNN关于视觉的最重要的概念之一。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ls"><img src="../Images/34d9cbe5058ffcbc0fdfcb8da3b4e82e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/1*CwgHDTwdWdg4Wr1LZ_3K5g.gif"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">感受野概念</figcaption></figure><p id="b0f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的图像中，在5x5的图像上使用了3x3的内核，得到3x3的通道，然后再次在其上使用3x3的内核，得到1x1的输出。为了达到5x5的全局感受野，使用了两个3x3。绿色像素知道浅紫色像素中发生的情况，因此它的全局感受野是5×5，而局部感受野是3×3，因为它只看到黄色像素中发生的情况，但间接知道紫色像素中发生的情况。</p><p id="8a7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它可以被定义为DNN正在观看的输入图像的区域。为复杂数据集提供良好结果所需的最小感受野至少是图像的大小。DNN应该有所有像素值的信息，所以采取适当的决定。</p><p id="b1af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如:我们可能想要检测苍蝇，它们的尺寸非常小，可以在帧中的任何地方，因此DNN应该能够扫描整个图像来寻找苍蝇。</p><h2 id="d610" class="le jq hi bd jr lf lg lh jv li lj lk jz iq ll lm kd iu ln lo kh iy lp lq kl lr bi translated">使用3x3到达所有感受野</h2><p id="64c5" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">如上所述，使用5×5或两个3×3的核可以达到5×5的整体感受野。在现实世界中，图像的尺寸会很大，从50×50到1024×1024或更大，因此不会单独使用卷积层，我们将使用max pooling和其他层来帮助达到所需的感受野。</p><h1 id="8582" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">内核大小</h1><p id="0199" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">内核可以有各种大小，即在图像中，我们有任何所需大小的2D或3D内核:5x5或100x100。它可以是任何东西。但是最好是3x3的内核大小，而不是任何其他的内核大小。以下原因是:</p><ol class=""><li id="c56f" class="lt lu hi ih b ii ij im in iq lv iu lw iy lx jc ly lz ma mb bi translated">使用3x3在大粒上到达衍生感受野。它极大地减少了参数，例如:一个5x5内核将有25个神经元(在一个图像中，每个像素都是一个神经元)，因此要查看所有像素并做出决定，如果我们直接应用5x5，它将有25个参数，这些参数是神经元的权重，如果我们应用两个3x3，则总参数计数将是9+9 =18。一旦我们在复杂的图像上使用更大的网络，差别将会很大。</li><li id="7b9a" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">奇数核允许更容易地使用像三角形这样的形状，这在偶数核中是困难的。</li><li id="c118" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">GPU设计用于更快地执行3x3，因此处理时间更快。</li></ol><h1 id="d64c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak"><em class="mh"/></strong>训练(简写)</h1><p id="42ce" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">所有DNNs都在训练中使用反向传播。假设过滤器是为了从图像中识别狗，因此最初内核是随机初始化的。所以他们将不能识别狗，因此对于所有错误的结果，我们计算损失并根据损失更新神经元的权重。然后，使用这些更新的权重来完成相同的任务，并且重复该过程，直到达到特定的精度或者已经用完了次数(总训练循环)。深入将在后面的部分。</p><h1 id="6fa6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">参考</h1><ol class=""><li id="82b4" class="lt lu hi ih b ii kn im ko iq mi iu mj iy mk jc ly lz ma mb bi translated"><a class="ae jo" href="https://distill.pub/2017/feature-visualization/" rel="noopener ugc nofollow" target="_blank">蒸馏酒吧</a></li></ol><p id="23ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章，请鼓掌。如果你有疑问，可以在这里评论。</p></div></div>    
</body>
</html>