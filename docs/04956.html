<html>
<head>
<title>Predict the probability of a person getting infected by COVID-19 using Deep learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习预测一个人被新冠肺炎感染的概率</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predict-the-probability-of-a-person-getting-infected-by-covid-19-using-deep-learning-4965703053bf?source=collection_archive---------24-----------------------#2020-04-06">https://medium.com/analytics-vidhya/predict-the-probability-of-a-person-getting-infected-by-covid-19-using-deep-learning-4965703053bf?source=collection_archive---------24-----------------------#2020-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0ecf42edd7acd07e462c456f98956b71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CV5RgcSiXl7cd65TMCTgzw.png"/></div></div></figure><p id="357f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">冠状病毒是一个由数百种病毒组成的家族，可以引起发烧、呼吸系统问题，有时还会引起胃肠道症状。2019年的新型冠状病毒是该家族已知感染人类的七个成员之一，也是过去三十年来第三个从动物跳到人类的病毒。</p><p id="42c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">全世界都在参与反对这个疫情的斗争。数据科学界可以对抗击这种疾病产生重大影响。已经有许多优秀的努力使用数据可视化和蒙特卡罗模拟来帮助打击这种疫情的传播。这种预测模型有助于识别那些风险最大的人。通过结合医疗保健技术领域的努力，我们希望减轻这种可怕疾病的影响。</p><blockquote class="jo jp jq"><p id="e700" class="iq ir jr is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">注意:由于实时数据不可用，本教程中使用的数据是合成数据，因此它不能用来预测现实世界的衰老。然而，如果我们获得了真实的数据，我们就可以用它来训练我们的模型。</p></blockquote><h1 id="3d6a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">探索数据</h1><p id="e041" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">数据为CSV格式，包含28列</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/42545128d769b6afb01f75dbc930848d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zLd2B-i02nm3vhssUHGImg.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">数据集中列的说明</figcaption></figure><p id="4d81" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jr"> Infect_Prob </em>是一个人被感染的概率，它将是我们模型的标签，其余27列代表特征。</p><p id="9851" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我正在使用合作实验室来运行这个IPythonNotebook。所有需要的文件包括这个笔记本都在这个链接里:<a class="ae lh" href="https://github.com/aryan109/predict_COIVID19_infection_probability" rel="noopener ugc nofollow" target="_blank">https://github . com/aryan 109/predict _ coi vid 19 _ infection _ probability</a></p><h2 id="1fc6" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">加载数据</h2><p id="f0d4" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">我们将数据加载到熊猫数据框架。</p><p id="b7b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于训练数据:</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="0eda" class="li jw hi lx b fi mb mc l md me">#set path of training data according to your directory structure<br/>URL = ‘/content/drive/My Drive/Dataset/Train_dataset.csv’ <br/>dataframe = pd.read_csv(URL)<br/>dataframe.head()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/7a89880118485ea6f34e8b4bedb126c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8JuWlcsu3xGVybgjncmQA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">前5行训练数据</figcaption></figure><p id="c10e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于测试数据:</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="201c" class="li jw hi lx b fi mb mc l md me">#set path of test data according to your directory structure<br/>testUrl = '/content/drive/My Drive/Dataset/Test_dataset.csv' <br/>testDataframe = pd.read_csv(testUrl)<br/>testDataframe.head()</span></pre><h1 id="3481" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">数据预处理</h1><p id="0b62" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">我们需要在这些特征上做<em class="jr">特征选择</em>，只保留最重要的特征。例如，像年龄、肺部评分、心脏评分这样的特征是比人-Id、姓名和称号更重要的特征。</p><p id="a6f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还会将职业、共病等分类特征转换成<strong class="is hj">一次性编码</strong>。</p><h2 id="0d11" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">一键编码</h2><p id="e1c8" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">一种热编码是将分类变量转换成一种形式的过程，这种形式可以提供给ML算法，以便在预测中做得更好。</p><p id="c406" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">示例:</p><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/699a67556ebe48aa035deb2c627ae95d.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*PwSacZXBG71NLc35u2Kajg.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">已知资料</figcaption></figure><p id="1707" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一次热编码后的数据:</p><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/936648188a3320b15bd1cb3837eef675.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*orlwPVWCqihRJvUK4Qap4w.png"/></div></figure><p id="4613" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">0表示不存在，1表示存在。</p><p id="ddcf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将创建一个函数来进行数据预处理</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="e965" class="li jw hi lx b fi mb mc l md me">def cleanData(dataframe):<br/> df2 = dataframe<br/> Gender = pd.get_dummies(df2.Gender, prefix=’Gender’)<br/> Occupation=pd.get_dummies(df2.Occupation,prefix=’Occupation’)<br/> Mode_transport=pd.get_dummies(df2.Mode_transport,prefix=’Mode_transport’)<br/> comorbidity=pd.get_dummies(df2.comorbidity,prefix=’comorbidity’)<br/> df2[‘Pulmonary_score’] = df2[‘Pulmonary score’]<br/> df2[‘cardiological_pressure’] = df2[‘cardiological pressure’]<br/> df2 = df2.drop([‘Pulmonary score’,’cardiological pressure’],axis=1)<br/> Pulmonary_score=pd.get_dummies(df2.Pulmonary_score,prefix=’Pulmonary_score’)<br/> cardiological_pressure=pd.get_dummies(df2.cardiological_pressure,prefix=’cardiological_pressure’)<br/> df2 = pd.concat([Gender,Occupation,Mode_transport,comorbidity,Pulmonary_score,cardiological_pressure,df2] , axis=1)<br/> df2=df2.drop([‘Region’,’Gender’,’Occupation’,’Mode_transport’,’comorbidity’,’Pulmonary_score’,’cardiological_pressure’],axis = 1)<br/> df = df2<br/> df=df.drop([‘Designation’, ‘Name’, ‘Married’, ‘Children’, ‘Insurance’, ‘salary’,’people_ID’], axis = 1) <br/> return df</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/08120832420bd86edb14ff2a3bd30e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SkhvWJKDrsLVnr8olPqC4g.png"/></div></div></figure><h2 id="edea" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">处理缺失值</h2><p id="0387" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">在本教程中，为了简单起见，我们将删除所有包含缺失值的行。</p><p id="3a6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">找出每列中NA值的数量。</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="1a3e" class="li jw hi lx b fi mb mc l md me">df.isna().sum()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/7fed3954ea9cecda0e5565d260bee327.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*35sV4r-MfER3TKdNyTBi3w.png"/></div></figure><p id="6015" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">删除包含NA的行</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="c204" class="li jw hi lx b fi mb mc l md me">#to keep simple initially we are dropping all na columns<br/>df = df.dropna() <br/>print(‘after dropping all na’)<br/>df.isna().sum()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/19e57af984955fc729954cb84300f827.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*pd_siD90q0mWQOJzu7CtIA.png"/></div></figure><h2 id="173e" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">将数据分为训练和测试</h2><p id="64e9" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">90%的数据将用于训练，10%的数据将用于验证</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="77fd" class="li jw hi lx b fi mb mc l md me">train_dataset = df2.sample(frac=0.9,random_state=0)<br/>test_dataset = df2.drop(train_dataset.index)<br/>print(len(train_dataset), ‘train examples’)<br/>print(len(test_dataset), ‘validation examples’)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/142dbdf1c4107c060991491f461e86aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*ClEy-It1lytpkb-Ibfje-w.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">代码的输出</figcaption></figure><h2 id="4fef" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">关于数据的一些统计</h2><p id="895d" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">我们使用<em class="jr"> describe() </em>函数查看关于数据的统计</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="3147" class="li jw hi lx b fi mb mc l md me">train_stats = train_dataset.describe()<br/>train_stats.pop(“Infect_Prob”)<br/>train_stats = train_stats.transpose()<br/>train_stats</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/9021111aca4e7eb62f68d82a7c9db85c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sv4QuSAGyUxseY7g0-5cSQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">输出</figcaption></figure><p id="03f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们将标签(Infect_Prob)存储到单独的变量中</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="4ecf" class="li jw hi lx b fi mb mc l md me">train_labels = train_dataset.pop(‘Infect_Prob’)<br/>test_labels = test_dataset.pop(‘Infect_Prob’)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/8f4e9ce9d1cf08133923c594624c2639.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*F8GH96cVvwH1eTMN7Mz6dg.png"/></div></figure><h2 id="36a7" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">标准化数据集</h2><p id="4869" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated"><strong class="is hj">归一化</strong>用于缩放属性的数据，使其落在一个较小的范围内，如-1.0到1.0或0.0到1.0。之所以使用它，是因为我们在不同的尺度上处理属性，这可能会导致一个同等重要的属性(在较低的尺度上)的稀释无效性，因为其他属性在较大的尺度上具有值。</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="6db2" class="li jw hi lx b fi mb mc l md me">def norm(x):<br/> return (x — train_stats[‘mean’]) / train_stats[‘std’]<br/>normed_train_data = norm(train_dataset)<br/>normed_test_data = norm(test_dataset)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/c828134fecb99bfdd4e9d7b4b6633631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1CeNytdnC_lU4HrYx1H9w.png"/></div></div></figure><h1 id="55a4" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">定义模型</h1><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="692d" class="li jw hi lx b fi mb mc l md me">def build_model():<br/> model = keras.Sequential([<br/> layers.Dense(64, activation=’relu’, input_shape=[len(normed_train_data.keys())]),<br/> layers.Dense(32, activation=’relu’),<br/> layers.Dense(16, activation=’relu’),<br/> layers.Dense(1)<br/> ])</span><span id="260a" class="li jw hi lx b fi mo mc l md me">optimizer = tf.keras.optimizers.RMSprop(0.0005)</span><span id="501b" class="li jw hi lx b fi mo mc l md me">model.compile(loss=’mae’,<br/> optimizer=optimizer,<br/> metrics=[‘mae’, ‘mse’])<br/> return model</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/efa9c1c11337569d2917d3f6b3a6fc98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PV9Qg63TQ647rYs0sgrHw.png"/></div></div></figure><h2 id="3fe7" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">让我们训练模型</h2><p id="e93a" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">我们将训练500个纪元的模型</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="8e98" class="li jw hi lx b fi mb mc l md me">EPOCHS = 500<br/>history = model.fit(<br/> train_dataset, train_labels,<br/> epochs=EPOCHS, validation_split = 0.2, verbose=0,<br/> callbacks=[tfdocs.modeling.EpochDots()])</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/0731a77541714e761aad3c422f3b9806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IvV-azVsyyHoJVpIo5k0vA.png"/></div></div></figure><h1 id="546a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">绘制一些图表</h1><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/5103506b3f879d3d82fa872d0cb3f46e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*HzfdVpmJkr-nPQP4KIPbOw.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">训练用图</figcaption></figure><h2 id="5d47" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">测试我们的模型</h2><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="9b4a" class="li jw hi lx b fi mb mc l md me">test_predictions = model.predict(test_dataset).flatten()<br/>a = plt.axes(aspect=’equal’)<br/>plt.scatter(test_labels, test_predictions)<br/>plt.xlabel(‘True Values [Infect_prob]’)<br/>plt.ylabel(‘Predictions [Infect_prob]’)<br/>lims = [0, 100]<br/>plt.xlim(lims)<br/>plt.ylim(lims)<br/>_ = plt.plot(lims, lims)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/bd8c6e65c05f31cbb108a9b694d48432.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*QRIqSV4UQO_YcvjpMll2dQ.png"/></div></figure><p id="9b90" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">绘制误差图</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="1af3" class="li jw hi lx b fi mb mc l md me">error = test_predictions — test_labels<br/>plt.hist(error, bins = 25)<br/>plt.xlabel(“Prediction Error [Infect_prob]”)<br/>_ = plt.ylabel(“Count”)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/8d4f3d96aaabf75b839110b081e623ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2vVMrsTOrZSuhZeF-r0rRA.png"/></div></figure><h1 id="ff75" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">最终预测并保存结果</h1><p id="9de3" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">做预测就像调用一个函数一样简单</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="cffb" class="li jw hi lx b fi mb mc l md me">ans = model.predict(testData)</span></pre><p id="b04f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jr"> ans </em> </strong> <em class="jr"> </em>将举行结果</p><h2 id="8a62" class="li jw hi bd jx lj lk ll kb lm ln lo kf jb lp lq kj jf lr ls kn jj lt lu kr lv bi translated">将结果存储到CSV文件中</h2><p id="70ed" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">首先，我们将创建一个只有列名的空数据框架</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="77df" class="li jw hi lx b fi mb mc l md me">dfObj = pd.DataFrame(columns=[‘people_ID’, ‘infect_prob’])</span></pre><p id="8d6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后我们将peopleId数组转换成NumPy数组</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="dac1" class="li jw hi lx b fi mb mc l md me">peopleIdArr = peopleId.to_numpy()</span></pre><p id="801a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们将把people_Id和Infect_Prob添加到空白数据帧表单<strong class="is hj"> peopleIdArr </strong>和<strong class="is hj"> ans </strong>中</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="1f9d" class="li jw hi lx b fi mb mc l md me">k = 0<br/>while(k&lt; len(peopleIdArr)):<br/> i = int(peopleIdArr[k])<br/> j = ans[k][0]<br/> dfObj = dfObj.append({‘people_ID’: i,’infect_prob’:j}, ignore_index=True)<br/> k+=1<br/>dfObj.head()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/d5330f62a7b972a0aa483ebf3536ce2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*tgwedx8OJ7C-_bssVH4WrA.png"/></div></figure><p id="1c66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们将包含结果的数据帧转换成CSV文件并下载。</p><pre class="kz la lb lc fd lw lx ly lz aw ma bi"><span id="a9c2" class="li jw hi lx b fi mb mc l md me">dfObj2.to_csv(r’/content/prob1.csv’, index=False)<br/>from google.colab import files<br/>files.download(“/content/prob1.csv”)</span></pre><p id="c490" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行此代码后，prob1.csv将自动下载。</p><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/1a5675b805b6d17bbf19079f46eda9b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Mu8JBLRBD2DwCxUL"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">乔恩·泰森在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/e2dbf10517a327f8cda649f5f8bcbccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*wJ_dv24TVzCCklcDmsAFIQ.png"/></div></figure></div></div>    
</body>
</html>