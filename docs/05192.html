<html>
<head>
<title>SEIR Analysis on Covid-19 India Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎印度数据的SEIR分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/seir-analysis-on-covid-19-india-data-23e8def2c616?source=collection_archive---------31-----------------------#2020-04-13">https://medium.com/analytics-vidhya/seir-analysis-on-covid-19-india-data-23e8def2c616?source=collection_archive---------31-----------------------#2020-04-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9d20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文旨在将SEIR模型(易感、暴露、感染、恢复)应用于新冠肺炎印度数据。这个数据的来源是<a class="ae jd" href="https://www.kaggle.com/sudalairajkumar/covid19-in-india" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a><strong class="ih hj">。</strong>该数据每天更新。在这篇文章中，我使用了截至2020年4月13日的数据。</p><p id="5a53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章包含</p><p id="dbd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">1&gt;SEIR简介</strong></p><p id="4c0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。&gt;实现SEIR的Python代码</strong></p><p id="5d58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3 &gt;如何考虑干预SEIR模式</strong> l</p><p id="f9ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">SEIR简介</strong></p><p id="36ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种方法将种群分成四个区间。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/1ca13716a5236cc2ebd7682ae8e2a7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXu9ZwPkD6gFuaiY2ZmkeQ.png"/></div></div></figure><p id="5f88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">易感者-代表目前未被感染但有可能被疾病感染的人数。</p><p id="0c86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">暴露(E)-代表暴露于冠状病毒，但由于潜伏期(潜伏期)，他们的身体没有症状的人数。</p><p id="efc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">传染性(I)-它代表所有被感染的人的数量，并且很可能传播这种疾病。</p><p id="26c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">康复(R)-代表治愈或死亡的人数。请注意在这个模型中没有单独的死亡舱。</p><p id="a093" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这四个隔间之间关系由微分方程组给出:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jq"><img src="../Images/7dfcf21147e30be801b78c8a4048ecf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*0on0vrxEGcUg5K6C5_XAyA.png"/></div></figure><p id="5c58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，这些微分方程和是零，这意味着从一个隔间出来的任何东西都会进入另一个隔间。这意味着<strong class="ih hj">易感者</strong>在与<strong class="ih hj">染病者</strong>接触时，可能会进入<strong class="ih hj">暴露</strong>隔间。部分来自<strong class="ih hj">暴露</strong>隔室的人将根据潜伏期转移到<strong class="ih hj">感染</strong>隔室，部分<strong class="ih hj">感染</strong>的人将根据治疗期间所需的恢复时间<strong class="ih hj">恢复</strong>。在任何时候，所有这些区间的总和将等于总人口。</p><p id="91c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这些等式中,<strong class="ih hj"> β </strong>可以作为感染者和易感者之间的接触率，而<strong class="ih hj"> γ </strong>仅仅是恢复率或感染者恢复所需的平均时间。<strong class="ih hj">一个</strong>是潜伏期。上面的等式也有死亡率和出生率的项，但是在这个分析中我们不考虑它们。</p><p id="c24e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如何在新冠肺炎印度数据上使用这些信息？</strong></p><p id="fc34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在印度，不管我们有什么数据，大多数感染者需要大约15-25天才能康复，所以对于这篇文章来说<strong class="ih hj"> γ </strong>可能是1/25。日冕的潜伏期大约是5.2天(<strong class="ih hj">值得商榷，但在大多数文章中是5.2 </strong>)，所以对于这篇文章来说<strong class="ih hj"> a </strong>是1/5，但我们不知道<strong class="ih hj"> β。</strong>我们将<strong class="ih hj">使用曲线拟合</strong>来确定这个参数<strong class="ih hj"> β。Scipy(python中的一个包)有一些用于曲线拟合和求解微分方程的工具。</strong></p><p id="af5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">创建求解微分方程的函数</strong></p><pre class="jf jg jh ji fd jr js jt ju aw jv bi"><span id="c308" class="jw jx hi js b fi jy jz l ka kb"># Total population, N.<br/>N = 1210568111<br/># Initial number of infected and recovered individuals, I0 and R0.<br/>I0, R0 = 1, 0<br/>E0=0<br/># Everyone else, S0, is susceptible to infection initially.<br/>S0 = N — I0 — R0<br/># Contact rate, beta, and mean recovery rate(rec),incubation period(gamma),<br/>beta, gamma,rec = 5,5,25 <br/># A grid of time points (in days)<br/>t = df_train[‘days’]<br/>x_test = df_test[‘days’]<br/># The SIR model differential equations.<br/>def deriv(t, y, N,gamma,rec,beta):<br/> S, E, I,R = y<br/> dSdt = -beta * S * I / N<br/> dEdt = (beta * S * I / N) — ((1/gamma) * E)<br/> dIdt = ((1/gamma) * E)-((1/rec)*I)<br/> dRdt = (1/rec) * I<br/> return dSdt,dEdt, dIdt, dRdt</span></pre><p id="6983" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的代码片段中，<strong class="ih hj"> deriv </strong>是将生成所需微分方程的函数的名称。现在这些微分方程将由另一个函数求解。</p><pre class="jf jg jh ji fd jr js jt ju aw jv bi"><span id="9c4f" class="jw jx hi js b fi jy jz l ka kb">def fit_odeint(t, beta):<br/> y0 = S0, E0, I0,R0<br/> ret = solve_ivp(deriv,[0,t.max()],y0,args=(N,gamma,rec,beta),t_eval=np.arange(t.max()+1),method=’Radau’)<br/> S, E, I,R = ret.y<br/> if(I.shape[0]==t.shape[0]):<br/>   if((S.sum()*E.sum()*I.sum()*R.sum())&gt;0):<br/>       res=np.concatenate(((I+R),R),axis=0)<br/>       return(np.array(res))<br/>   else:<br/>       return(np.zeros((2*t.shape[0],)))<br/> else:<br/> return(np.zeros((2*t.shape[0],)))</span></pre></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><p id="5678" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该函数使用scipy包的<strong class="ih hj"> solve_inp </strong>函数。它求解微分方程系统，在这种情况下由函数<strong class="ih hj"> deriv给出。</strong>现在你们可能都已经注意到，这个函数<strong class="ih hj"> fit_odeint </strong>还有一个参数β(接触率)，其值是未知的，我们将使用曲线拟合找到该值。</p><pre class="jf jg jh ji fd jr js jt ju aw jv bi"><span id="fac9" class="jw jx hi js b fi jy jz l ka kb">popt, pcov = optimize.curve_fit(fit_odeint,t,y,maxfev=500000000,p0=[beta])</span></pre><p id="3189" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结果</strong></p><p id="1ee9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是时候看看我们所做的所有这些繁重工作的结果了。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kj"><img src="../Images/1fc7db6cf5aafa5664bfa0ce0c6a9518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SxYJOPop_swErhQB2-F3Lg.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated">原始资料</figcaption></figure><p id="e38a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">上周的数据被认为是测试数据，其余的都是训练数据。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ko"><img src="../Images/3a30395a8d89e3c51009d8bc54ad8168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6qBRqDL0Qn6Rb_fhSYw9w.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated"><strong class="bd kp">列车数据预测</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kq"><img src="../Images/26d8cade7125e9168505bcf9a09d0726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1i3jYi3U20T-SWAXFmGNA.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated"><strong class="bd kp">对测试数据的预测</strong></figcaption></figure><p id="36d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对测试数据的预测没有那么好<strong class="ih hj"> (R2=0.83) </strong>但是为什么会这样呢？这是因为我们没有考虑<strong class="ih hj">锁定的影响吗？让我们检查一下。</strong></p><p id="0be4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何考虑SEIR模型中的锁定效应？</p><p id="90d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于封锁，接触率将会下降。衰减函数有几个选项。来源-<a class="ae jd" href="https://github.com/SwissTPH/openmalaria/wiki/ModelDecayFunctions" rel="noopener ugc nofollow" target="_blank">https://github . com/Swiss TPH/open malaria/wiki/ModelDecayFunctions</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kr"><img src="../Images/ae06e7f037a9609a4f5fcabeabab5084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*QZQuwAgQkpsYLBLJz06xbw.png"/></div></figure><p id="2d88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经使用了K=2的希尔函数，并使用曲线拟合来寻找L(衰变率)。</p><p id="d0ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">修改后的功能:</p><pre class="jf jg jh ji fd jr js jt ju aw jv bi"><span id="a1e9" class="jw jx hi js b fi jy jz l ka kb">def deriv_1(t, y, N,gamma,rec,L,k):<br/> S, E, I,R = y<br/> beta=0.27/((1 + (t/L)**k))<br/> dSdt = -beta * S * I / N<br/> dEdt = (beta * S * I / N) — ((1/gamma) * E)<br/> dIdt = ((1/gamma) * E)-((1/rec)*I)<br/> dRdt = (1/rec) * I<br/> #print(dSdt)<br/> #print(S,R)<br/> return dSdt,dEdt, dIdt, dRdt</span></pre><p id="bd3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">锁定是在2020年3月25日实施的，因此在那一天之前使用恒定接触率，之后应用该希尔函数。这个0.27是在一些迭代之后找到的。</p><p id="0555" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">发现L很大，所以接触率没有降低很多。可能需要更多的数据才能知道下降率。<strong class="ih hj">记录锁定后的全部数据，用于查找L </strong>。与前面的例子不同，它没有分为测试和训练，只是为了扩大训练数据集，以便人们可以更好地理解数据。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ks"><img src="../Images/4b2987e0cfeb40f7e721670505b7d18c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytjhe7WFEF-p1PZG5wXvrg.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated"><strong class="bd kp">锁定后数据预测</strong></figcaption></figure><p id="a6e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们试着预测未来</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/1a2ea7721113acee8c575180d60f239d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPae17ARa9QigdOkSdln-A.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated"><strong class="bd kp">关于2020年1月31日之后天数的确诊病例预测</strong></figcaption></figure><p id="5ce7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关键要点:</strong></p><p id="3f2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1 &gt;根据这一模型，曲线稳定大约需要<strong class="ih hj">210天，比2020年1月31日(8月第一周)</strong>多。在该分析中，接触率的下降非常小，但在实际情况下，由于锁定和其他措施，接触率将以更快的速度下降，因此该持续时间可能会更短。你也可以观察到确诊病例的价值相当高。这是因为接触率是折旧在模型中不是很突出。</p><p id="6fe4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2 &gt;增加病床数量和隔离所有感染者，将大大降低接触率，这将有助于稳定曲线。</p></div></div>    
</body>
</html>