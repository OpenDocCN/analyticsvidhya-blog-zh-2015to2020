<html>
<head>
<title>Use Naive Bayes Algorithm for Categorical and Numerical data classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用朴素贝叶斯算法进行分类和数值数据分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/use-naive-bayes-algorithm-for-categorical-and-numerical-data-classification-935d90ab273f?source=collection_archive---------0-----------------------#2019-11-24">https://medium.com/analytics-vidhya/use-naive-bayes-algorithm-for-categorical-and-numerical-data-classification-935d90ab273f?source=collection_archive---------0-----------------------#2019-11-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4fa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">朴素贝叶斯</em> </strong>是一种<strong class="ih hj">监督</strong>学习算法，属于<strong class="ih hj">贝叶斯</strong>分类。它使用<strong class="ih hj">概率</strong>进行预测分析。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/f134d148844700392e8132ff7e89debc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SY3_mIfUCOnZtOj5gfoXeQ.png"/></div></div></figure><h2 id="8500" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">贝叶斯方程的证明:</h2><p id="0c90" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">如果我们考虑两个类别<strong class="ih hj"> A </strong>和<strong class="ih hj"> B </strong>,那么→</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kq"><img src="../Images/e37d9dbd937525aadfcb3f7305b0deef.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/0*42FGhvuQQZbVWEpn.png"/></div></figure><p id="b930" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，A对B的概率= <strong class="ih hj"> P(A|B) = </strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kr"><img src="../Images/094c540a42cee738122b03d733f33b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*CUsTDhYE15-MvNPS7nl7EQ.png"/></div></figure><p id="ea5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且，B对A的概率= <strong class="ih hj"> P(B|A) = </strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ks"><img src="../Images/487ccf3d27e1f2136e81301ccda2d34c.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*L28PlEBeKcAumGkt7PSmKQ.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kt"><img src="../Images/995f0208a76d5797aec3f7b581200437.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*LevuV_1tIKDxL0bIElMLxQ.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">朴素贝叶斯方程</figcaption></figure><p id="b25a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将使用这个等式来理解朴素贝叶斯分类如何在各种数据集上工作，并为我们完成分类工作。</p><h2 id="27fb" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated"><strong class="ak">使用朴素贝叶斯分类器的领域:→ </strong></h2><ol class=""><li id="dd86" class="ky kz hi ih b ii kl im km iq la iu lb iy lc jc ld le lf lg bi translated">新闻分类(分为体育、医疗、媒体、娱乐等。)</li><li id="9b47" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">垃圾邮件过滤(将电子邮件分类为垃圾邮件或非垃圾邮件)</li><li id="945e" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">人脸识别和物体检测</li><li id="381f" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">医疗诊断</li><li id="6ba6" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">天气预报</li></ol><h2 id="7b75" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated"><strong class="ak">朴素贝叶斯算法如何工作:→ </strong></h2><p id="4986" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">为了理解这种算法是如何工作的，我们将使用这个数据集来对来自特定地方的具有特定收入的人进行分类，根据他们的性别进行分类。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lm"><img src="../Images/3a2242c71c1235b38f4a1d1bae95a135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i3PW6FunfE9BMXuO8EtOwQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">心脏病诊断数据集</figcaption></figure><p id="bcd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将开始为数据集中的每个独立列(城市、性别和收入)构建<strong class="ih hj">频率</strong>和<strong class="ih hj">可能性</strong>表。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ln"><img src="../Images/21e763bf6a49b2c9f384a7e5d19c69de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mYXgkXY8f1FSKOG6NSHC0w.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">疾病列的可能性表</figcaption></figure><p id="c5e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们从下表中得到的各种概率是:—</p><ul class=""><li id="bcf8" class="ky kz hi ih b ii ij im in iq lo iu lp iy lq jc lr le lf lg bi translated">P(达拉斯|是)= 2/4，P(达拉斯|否)= 2/4</li><li id="db08" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated">P(纽约市|是)= 1/4，P(纽约市|否)= 3/4</li><li id="e61a" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated">P(达拉斯)= 4/8，P(纽约)= 4/8</li><li id="60f7" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated">P(是)= 3/8，P(否)= 5/8</li></ul><p id="1f5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，给定患心脏病的可能性，城市是“达拉斯”= <strong class="ih hj"> P(是|达拉斯)</strong> = (P(是)* P(达拉斯|是))/P(达拉斯)=((3/8)*(2/4)/(4/8)= 0.375<strong class="ih hj">[</strong><em class="jd">从贝叶斯方程导出的公式</em><strong class="ih hj">】</strong></p><p id="4557" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同理，<strong class="ih hj"> P(无|达拉斯)</strong> = 0.625，<strong class="ih hj"> P(有|纽约市)</strong> = 0.18，<strong class="ih hj"> P(无|纽约市)</strong> = 0.93</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ls"><img src="../Images/773e78a382625931f99fa8fc0e2cb7a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f09RsCQWhgivap4Smz8QHQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">性别列的可能性表</figcaption></figure><p id="cc98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们从下表中得到的各种概率是:—</p><ul class=""><li id="7dc5" class="ky kz hi ih b ii ij im in iq lo iu lp iy lq jc lr le lf lg bi translated">P(男性|是)= 2/5，P(男性|否)= 3/5</li><li id="f124" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated">P(女性|是)= 1/3，P(女性|否)= 2/3</li><li id="6081" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated">P(男性)= 5/8，P(女性)= 3/8</li><li id="128e" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated">P(是)= 3/8，P(否)= 5/8</li></ul><p id="e37b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，给定患心脏病的可能性，城市是“男性”= <strong class="ih hj"> P(是|男性)</strong> = (P(是)* P(男性|是))/P(男性)=((3/8)*(2/5)/(5/8)= 0.24<strong class="ih hj">[</strong><em class="jd">从贝叶斯方程导出的公式</em><strong class="ih hj">】</strong></p><p id="2734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同理，<strong class="ih hj"> P(无|男)</strong> = 0.6，<strong class="ih hj"> P(有|女)</strong> = 0.33，<strong class="ih hj"> P(无|女)</strong> = 1.11</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lt"><img src="../Images/fe9277f836e2abba58bc76b237a040e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xTN6yH_hn0zJNgBsNi5NA.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">表1</figcaption></figure><p id="4434" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于那些不明确的列，如“<strong class="ih hj">收入</strong>列，我们将使用<strong class="ih hj">平均值、标准差和正态分布</strong>公式来计算患者是否患有心脏病的可能性。公式如下所示:→</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lu"><img src="../Images/c9e82625c81649f48a475a9b514ab8bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*cJmZWhNakedlGUr0NhkgdA.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated"><strong class="bd js">均值、标准差和正态分布公式</strong></figcaption></figure><p id="0d3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了计算我们预测患者是否患有心脏病的任何新值<strong class="ih hj"> <em class="jd"> X </em> </strong>的可能性，我们将首先计算值<strong class="ih hj"> mean </strong>和<strong class="ih hj"> std。偏差</strong>为收入栏根据心脏病存在与否，而不是针对该人的相应收入。* *然后我们将计算一个人患心脏病的可能性，或者，不是借助正态分布公式，而是使用我们必须预测疾病的那个人的收入值。**[ <strong class="ih hj">重要</strong></p><p id="4359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们准备好预测新的测试数据集。因此，如果我们必须预测以下情况:→</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/a33cf6c91204113f3e6d68a5832e5d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOhR0Yud51i7hBrby9911Q.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">测试数据</figcaption></figure><p id="62a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先我们将计算患病的可能性，值100000:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lw"><img src="../Images/d0d05b0469c477cdff7d28694092ac4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N7bRyi_yYFEBO1rXnMIxKg.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">正态分布1000值</figcaption></figure><p id="5167" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“是”，此人有疾病的可能性为→ <strong class="ih hj"> P(收入= 10000 |疾病=是)</strong>=(1/(42397.5 *(2.506)))*(2.718)^-((100000–68386.66)/(2 * 42397.5))= 0.00000712789</p><p id="cb44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“否”，此人未患病的可能性是→ <strong class="ih hj"> P(收入= 10000 |患病=否)</strong>=(1/(28972.49 *(2.506)))*(2.718)^-((100000–79571.8)/(2 * 28972.49))= 0.0000107421</p><h2 id="8318" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">预测:→</h2><p id="128c" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">for : X =(城市=达拉斯，性别=女性，收入=100K)</p><ul class=""><li id="88af" class="ky kz hi ih b ii ij im in iq lo iu lp iy lq jc lr le lf lg bi translated"><strong class="ih hj">P(X | Class = No)</strong>= P(City = Dallas |Class=No) * P(性别=女性| Class = No)* P(收入= 100K | Class = No)= 2/4 * 2/3 * 0.00000712789 = 0.00000237596</li><li id="bb54" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated"><strong class="ih hj">P(X | Class = Yes)</strong>= P(City = Dallas |Class=Yes) * P(性别=女性| Class = Yes)* P(收入= 100K | Class = Yes)= 2/4 * 1/3 * 0.0000107421 = 0.000001790</li></ul><p id="2d12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">* *[自P(X |否)*P(否)&gt; P(X |是)*P(是)]**。因此，[P(No | X)&gt; P(Yes | X)]= &gt;<strong class="ih hj">Class = No</strong>[<strong class="ih hj">Important</strong>]，算法将给出<strong class="ih hj"> No </strong>作为<strong class="ih hj">输出</strong>，并且对于该测试数据集<strong class="ih hj">，我们将认为患者不会患有心脏病。</strong></p><h2 id="fd67" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">最需要注意的是:→</h2><p id="d622" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated"><strong class="ih hj">* *如果我们的数据集中只有分类列** </strong>，如“城市”和“性别”列。那么在这种情况下，我们按照给定的步骤执行:→</p><p id="0ab4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">for : X =(城市=达拉斯，性别=女性)</p><ul class=""><li id="e409" class="ky kz hi ih b ii ij im in iq lo iu lp iy lq jc lr le lf lg bi translated"><strong class="ih hj">P(Class = No | X)</strong>= P(Class = No | City = Dallas)* P(Class = No | Gender = Female)= 0.625 * 1.11 = 0.69375</li><li id="dd33" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated"><strong class="ih hj">P(Class = Yes | X)</strong>= P(Class = Yes | City = Dallas)* P(Class = Yes | Gender =女性)= 0.375 * 0.33 = 0.12375</li><li id="a90d" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc lr le lf lg bi translated">因此，<strong class="ih hj"> P(否)</strong>= 0.69375/(0.69375+0.12375)= 0.84862385321&amp;<strong class="ih hj">P(是)</strong>= 0.12375/(0.69375+0.12375)= 0.15137614678</li></ul><p id="09e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于<strong class="ih hj">P(Class = No | X)</strong>&gt;<strong class="ih hj">P(Class = Yes | X)</strong>因而，<strong class="ih hj">P(No)</strong>&gt;<strong class="ih hj">P(Yes)</strong>=&gt;<strong class="ih hj">Class = No</strong><strong class="ih hj">重要</strong>，同样地，算法会给<strong class="ih hj"> No </strong>作为<strong class="ih hj">输出</strong>并且，对于这个条件也和</p><p id="cac5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是朴素贝叶斯算法的工作原理。我希望你喜欢阅读这篇博客。如果你有任何问题、意见或顾虑，请在评论区告诉我。在那之前享受学习。</p></div></div>    
</body>
</html>