<html>
<head>
<title>CICD Pipeline : From Jupyter Notebook to AWS Sagemaker Endpoint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CICD管道:从Jupyter笔记本到AWS Sagemaker端点</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cicd-pipeline-from-jupiter-notebook-to-aws-sagemaker-endpoint-e56f40ec2a2f?source=collection_archive---------3-----------------------#2020-08-07">https://medium.com/analytics-vidhya/cicd-pipeline-from-jupiter-notebook-to-aws-sagemaker-endpoint-e56f40ec2a2f?source=collection_archive---------3-----------------------#2020-08-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8e84c191628918b50293474b7edfed4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6c64eS0wOT_mniIz.png"/></div></div></figure><p id="a783" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将介绍如何在AWS中构建一个CICD管道来部署机器学习模型。为了构建CICD管道，我使用了AWS代码提交(代码库)和CodeBuild、CloudWatch、ECR、Lambda。</p><p id="44d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将把这个过程分成3个步骤。</p><p id="a153" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">步骤1:创建一个CodeCommit存储库，并与Sagemaker Jupyter笔记本集成。</p><p id="8286" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">步骤2:集成CodeCommit以触发CodeBuild项目，该项目构建Docker映像并将其推送到ECR存储库。</p><p id="1745" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第三步:<strong class="is hj"> </strong> Lambda函数创建一个Sagemaker端点。</p><p id="93eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第一步:创建一个CodeCommit存储库，并与Sagemaker Jupyter笔记本集成。</strong></p><p id="00ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在CodeCommit中创建一个存储库，从本地将推理代码、nginx.conf、serve、wsgi.py以及dockerfile推送到CodeCommit。</p><p id="3481" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">代码:<a class="ae jo" href="https://github.com/NareshReddyy/Sagemaker_deploy_own_model.git" rel="noopener ugc nofollow" target="_blank">https://github . com/NareshReddyy/Sagemaker _ deploy _ own _ model . git</a></p><p id="e31b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以参考这篇关于<a class="ae jo" rel="noopener" href="/@lee.naresh962/deploy-your-own-model-with-aws-sagemaker-55b4234be4a">如何在Sagemaker </a>上部署自己的模型的文章。</p><p id="ab63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在使用Sagemaker Notebook Git repositories设置将Sagemaker Notebook与CodeCommit集成，您可以选择使用GitHub来代替CodeCommit。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/3583344845c249ddd27a2843870e6b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mn2CCsE_-Vb8jEFDIHqhMQ.png"/></div></div></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/0a351f15105787d047674140c590f259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8dqxS2f2p4Q6xJ_x7kctg.png"/></div></div></figure><p id="9933" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤2:集成CodeCommit以触发CodeBuild项目，该项目构建Docker映像并将其推送到ECR存储库。</strong></p><p id="835a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将代码推送到CodeCommit存储库之后，创建一个CodeBuild项目。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jv"><img src="../Images/343ff7f2c75e7ab4d8de50a006a72fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*egisg_JIqt0OBKZKtQuHGQ.png"/></div></div></figure><p id="4041" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择包含源代码的CodeCommit存储库。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jw"><img src="../Images/ac81263ee67e0e7e695cb59376948ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzBAebXM5C649VEcjLaQ8A.png"/></div></div></figure><p id="3f84" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当您调用AWS CodeBuild来运行构建时，您必须提供有关构建环境的信息，构建环境表示操作系统、编程语言运行时和CodeBuild用来运行构建的工具的组合。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jx"><img src="../Images/e7fc61f654ef767727a974b4503975b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGHSv_JnsJR_coUFWbTPtg.png"/></div></div></figure><p id="9f41" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个buildspec文件，CodeBuild使用该文件运行生成，其中包含生成命令和相关设置。创建buildspec.yml，并将其保存在CodeCommit存储库中的根(顶层)目录中。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/9dad4b0b0d8504a4f0c52242c62c5224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAFLsmFYBVpt9RejaOIw7g.png"/></div></div></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/de0364a69c3d6da63fb3b244d60b1a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1hoSVbrDc8XwWX1V-l8Pg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">buildspec文件的环境变量</figcaption></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/e0c0517c67b8b12e91ca8e9ba7785aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*svWSjEZUel3cmN_mmqRZiw.png"/></div></div></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/66dacab3db36cd5b7f30b11733e391b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXRCcPD-VbAtodH4hwsU3g.png"/></div></div></figure><p id="e393" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每当有人提交到CodeCommit存储库时，创建一个Lambda function add事件来启动CodeBuild中的构建。</p><p id="485a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在触发器配置中，选择要配置触发器的代码库、事件、分支，并在自定义数据中传递CodeBuild项目名称。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/46661e1d61450e71000794e6a6f03311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_mVek16Beor5xh07JPwVCQ.png"/></div></div></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/a32ef56666cb21e39b5813b8bc6693ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_G0lJmA-Di62ZSEPkjkSGQ.png"/></div></div></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/2651624e2d73d7ee25ffd481dd2318dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXgKRoKUdtcaD3sJdZU9rw.png"/></div></div></figure><p id="0e2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤3:创建Sagemaker端点的Lambda函数。</strong></p><p id="152c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个lambda函数，使用来自CloudWatch规则的触发器创建Sagemaker端点，其中任何对ECR存储库的提交都会触发lambda。</p><p id="31c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了创建Sagemaker端点，您需要创建Sagemaker端点配置、模型。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/22762f86452fe9ccc261fb4331f65779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQ86h5TSCIrrXNRMOgGDyA.png"/></div></div></figure><p id="9233" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还可以使用CloudFormation，也就是IaC(Infrastructure as Code)来部署代码，创建Sagemaker端点。</p><p id="1f7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请评论可能的改进和建议。</p></div></div>    
</body>
</html>