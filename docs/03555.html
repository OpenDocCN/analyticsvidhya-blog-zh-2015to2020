<html>
<head>
<title>Joins In Spark — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">加入Spark —第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/joins-in-spark-part-1-efb08a405bf9?source=collection_archive---------9-----------------------#2020-02-07">https://medium.com/analytics-vidhya/joins-in-spark-part-1-efb08a405bf9?source=collection_archive---------9-----------------------#2020-02-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dca1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">连接基本上是将两个或更多不同的表组合起来，根据某种标准得到一组结果。数据连接是任何ETL应用程序最常见的用法，但也是最棘手和计算量最大的操作。</p><p id="2649" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前，Spark提供了<br/> 1)内连接<br/> 2)外连接<br/> 3)左连接<br/> 4)右连接<br/> 5)交叉连接<br/> 6)左反连接<br/> 7)左半连接</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/bbaec3233a0c1c7b7528d72db7bdeb41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/0*6gkLf3Gb0moROCPV.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">火花连接类型</figcaption></figure><p id="bbde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">内部连接</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/aa449fdbfe6a1d5c5d1e20d034e441cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*Lg74uwJjD0nIiiA1kqFEmw.png"/></div></figure><p id="8e5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">内部连接是Spark中的默认连接，也是最常用的连接，它连接键列上的两个数据集，键不匹配的行从两个数据集中删除</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jq"><img src="../Images/e0a00060a2baae52746ad7d272f8942c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n20VPJzgfSOn-encdvghAQ.png"/></div></div></figure><p id="5e27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">外部连接</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/e7de3d16348a2fc4a9b533db1c884e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*OqRWSchPyOTQ8eB0_bpd-g.png"/></div></figure><p id="c9b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">外部联接返回两个数据集中的所有行，如果联接表达式不匹配，则在各自的记录列上返回null。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jw"><img src="../Images/49906ca51a9c058be6bebac87b983c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpS8jcGBE107hLIaTDCsVw.png"/></div></div></figure><p id="d7e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">左外连接</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jx"><img src="../Images/54fddaf73fd33365d1be8af957e6b5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*vT7MuJKUT2Z8a1Nu2yc6kA.png"/></div></figure><p id="4adb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">左外连接返回左数据集中的所有行，而不考虑在右数据集中找到的匹配项。当连接表达式不匹配时，它为该记录赋值null，并从右侧删除未找到匹配项的记录。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jy"><img src="../Images/2cbaedc658ce2538f7f6bccd6aa5d43b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKyzzSY62d2lRga7QuCoSQ.png"/></div></div></figure><p id="e5cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">右外连接</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/1866590778343285d5581af9a86ce159.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*zJWTreV9ino_XFzIqpG7VA.png"/></div></figure><p id="1d2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">右外连接与左连接相反，它返回右数据集中的所有行，而不管在左数据集中找到的数学表达式，当连接表达式不匹配时，它为该记录分配null，并从左侧删除未找到匹配的记录。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ka"><img src="../Images/faab513513b8c416514071112308cc85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yc20771IFjyCb3fTA_zGXw.png"/></div></div></figure><p id="350f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">左半连接</strong></p><p id="f62b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">左半连接类似于内连接，不同之处在于左半连接返回左数据集中的所有列，而忽略右数据集中的所有列。换句话说，对于右数据集中符合连接表达式的记录，该连接只返回左数据集中的列，左和右数据集中不符合连接表达式的记录都被忽略。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kb"><img src="../Images/1fe007ad056d05563114b4be0ce7f0e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*C93vFK9bmgqhuDwOIDKLTg.png"/></div></figure><p id="683a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对内部连接的结果使用select可以获得相同的结果，但是使用该连接会更有效。</p><p id="511f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">左反连接</strong></p><p id="aa4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">左反连接与左半连接完全相反。对于不匹配的记录，它只返回左边数据集中的列。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kc"><img src="../Images/344d2ab425e9c37fb464e7f843ec5b25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*WLu9dR7VOIhmTvLTIySzJw.png"/></div></figure><p id="ac9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kd">要了解Spark中Join是如何执行的，请访问</em> <a class="ae ke" rel="noopener" href="/analytics-vidhya/joins-in-spark-7594d0027031"> <em class="kd">文章</em> </a> <em class="kd">。</em></p><p id="19c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章，请点击👏所以其他人会在媒体上看到它。</p></div></div>    
</body>
</html>