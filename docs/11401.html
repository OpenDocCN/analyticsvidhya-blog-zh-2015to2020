<html>
<head>
<title>ML08: Efficiency Tips for R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ML08:R的效率提示</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ml08-f9d2f375dd1f?source=collection_archive---------22-----------------------#2020-12-01">https://medium.com/analytics-vidhya/ml08-f9d2f375dd1f?source=collection_archive---------22-----------------------#2020-12-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="78c7" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">矢量化是一把强有力的剑</h2></div><p id="d208" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">效率在实施阶段非常突出。r拥有矢量化功能，可以节省很多时间。那么，让我们从R中的效率提示开始吧！</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><blockquote class="ka kb kc"><p id="93b0" class="ix iy kd iz b ja jb ij jc jd je im jf ke jh ji jj kf jl jm jn kg jp jq jr js hb bi translated"><strong class="iz hj"> <em class="hi">大纲</em> </strong> <em class="hi"> <br/> </em> <strong class="iz hj"> <em class="hi"> (1)一条建议</em></strong><em class="hi"><br/></em><strong class="iz hj"><em class="hi">(2)更多效率提示为R </em> </strong> <em class="hi"> <br/> </em> 1 .避免使用c()、cbind()、rbind() <br/> 2。矢量化最好<br/> 3。避免循环<br/> 4。运行循环<br/> 5时，在高级创建固定空间。使用列&amp;行的索引做索引<em class="hi"> <br/> </em> <strong class="iz hj"> <em class="hi"> (3)引用</em> </strong></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kh"><img src="../Images/fdb3bb7c52ce2c5e56d4f982a4f51673.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*GnK5TmqzfUAdHfCvIuMPsA.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">图1:一个时钟(<a class="ae kt" href="https://zh.wikipedia.org/wiki/File:Out_of_date_clock_icon_2.svg" rel="noopener ugc nofollow" target="_blank">来源</a>)。</figcaption></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="17c2" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">(1)一条建议</h1><blockquote class="ka kb kc"><p id="8b5f" class="ix iy kd iz b ja jb ij jc jd je im jf ke jh ji jj kf jl jm jn kg jp jq jr js hb bi translated">每当你使用c()、append()、cbind()、rbind()或paste()创建一个更大的对象时，R必须<strong class="iz hj">首先为新对象分配空间，然后将旧对象复制到它的新家</strong>。如果你多次重复这个过程，比如在for循环中，那么这个过程会非常昂贵。</p><p id="da13" class="ix iy kd iz b ja jb ij jc jd je im jf ke jh ji jj kf jl jm jn kg jp jq jr js hb bi translated">矩阵代数是矢量化的一个典型例子。这些循环由BLAS等高度优化的外部库执行。如果你能找到使用矩阵代数解决问题的方法，你通常会很快得到答案。[1]</p></blockquote><h1 id="05ad" class="ku kv hi bd kw kx lm kz la lb ln ld le io lo ip lg ir lp is li iu lq iv lk ll bi translated">(2)针对R [2][3][4][5]的更多效率提示</h1><p id="43ce" class="pw-post-body-paragraph ix iy hi iz b ja lr ij jc jd ls im jf jg lt ji jj jk lu jm jn jo lv jq jr js hb bi translated">总之，</p><h2 id="2e76" class="lw kv hi bd kw lx ly lz la ma mb mc le jg md me lg jk mf mg li jo mh mi lk mj bi translated">1.避免使用<em class="mk"> c()、cbind()、rbind() </em></h2><ul class=""><li id="ca4e" class="ml mm hi iz b ja lr jd ls jg mn jk mo jo mp js mq mr ms mt bi translated">避免使用<em class="kd"> c()、cbind()、rbind() </em>，因为它们<strong class="iz hj">涉及复制和粘贴，这很耗时</strong>。A <em class="kd"> for循环</em>比<em class="kd"> c()、cbind()、rbind()执行得更好。</em></li><li id="a824" class="ml mm hi iz b ja mu jd mv jg mw jk mx jo my js mq mr ms mt bi translated"><em class="kd"> cbind() </em>运行速度比<em class="kd"> rbind() </em>快，这是因为r固有的存储结构。</li></ul><h2 id="73cf" class="lw kv hi bd kw lx ly lz la ma mb mc le jg md me lg jk mf mg li jo mh mi lk mj bi translated">2.矢量化是最好的</h2><ul class=""><li id="13ce" class="ml mm hi iz b ja lr jd ls jg mn jk mo jo mp js mq mr ms mt bi translated">省时排序:向量&gt;矩阵&gt;数据.帧</li><li id="2f8a" class="ml mm hi iz b ja mu jd mv jg mw jk mx jo my js mq mr ms mt bi translated"><em class="kd">矩阵</em>实际上与R中的<em class="kd">向量</em>相似，因为它基于<em class="kd">向量</em>，而<em class="kd">数据帧</em>的结构与<em class="kd">向量</em>和<em class="kd">矩阵</em>完全不同。</li><li id="e994" class="ml mm hi iz b ja mu jd mv jg mw jk mx jo my js mq mr ms mt bi translated">用<em class="kd">矢量化</em>和<em class="kd">矢量</em>代替<em class="kd">循环</em>、<em class="kd"> data.frame </em>、<em class="kd"> c()、cbind()、rbind() </em>。<strong class="iz hj">矢量化和向量是最好的选择！！</strong></li></ul><h2 id="f1dc" class="lw kv hi bd kw lx ly lz la ma mb mc le jg md me lg jk mf mg li jo mh mi lk mj bi translated">3.避免循环</h2><ul class=""><li id="129f" class="ml mm hi iz b ja lr jd ls jg mn jk mo jo mp js mq mr ms mt bi translated">尝试利用<em class="kd">矢量化</em>而不是<em class="kd">循环</em>。</li><li id="d453" class="ml mm hi iz b ja mu jd mv jg mw jk mx jo my js mq mr ms mt bi translated">使用类似于<em class="kd"> %in% </em>和<em class="kd"> match() </em>的函数来避免循环。回想一下，<em class="kd"> for循环</em>比<em class="kd"> c()、cbind()、rbind() </em>执行得更好。</li><li id="9889" class="ml mm hi iz b ja mu jd mv jg mw jk mx jo my js mq mr ms mt bi translated">然而，来自<em class="kd"> C </em>回路的<em class="kd"> lappy </em>家族被证实<strong class="iz hj">不会比r中的</strong> <em class="kd">回路</em>快</li></ul><h2 id="1e0e" class="lw kv hi bd kw lx ly lz la ma mb mc le jg md me lg jk mf mg li jo mh mi lk mj bi translated">4.运行循环时在高级中创建固定空间</h2><ul class=""><li id="dca7" class="ml mm hi iz b ja lr jd ls jg mn jk mo jo mp js mq mr ms mt bi translated">运行循环时，预先创建给定长度或行列的向量或矩阵，然后用NAs填充它们。创建新的内存空间并同时运行循环是非常耗时的。</li></ul><h2 id="922d" class="lw kv hi bd kw lx ly lz la ma mb mc le jg md me lg jk mf mg li jo mh mi lk mj bi translated">5.使用列和行的索引进行索引</h2><ul class=""><li id="f27f" class="ml mm hi iz b ja lr jd ls jg mn jk mo jo mp js mq mr ms mt bi translated">避免使用col &amp; row名称来做索引或切片，即我们应该使用col &amp; row的索引来做索引，例如给定“apple”列1的名称，我们最好采用<em class="kd"> A[，1] </em>而不是<em class="kd"> A[，" apple"] </em>。</li></ul><h1 id="90dd" class="ku kv hi bd kw kx lm kz la lb ln ld le io lo ip lg ir lp is li iu lq iv lk ll bi translated">(3)参考文献</h1><p id="c3c6" class="pw-post-body-paragraph ix iy hi iz b ja lr ij jc jd ls im jf jg lt ji jj jk lu jm jn jo lv jq jr js hb bi translated">[1]提高性能。检索自</p><div class="mz na ez fb nb nc"><a href="https://adv-r.hadley.nz/perf-improve.html" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi translated">24提高性能</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">我们应该忘记小的效率，比如说97%的时候:过早的优化是万恶之源…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">新西兰高级研究中心</p></div></div></div></a></div><h2 id="5bd2" class="lw kv hi bd kw lx ly lz la ma mb mc le jg md me lg jk mf mg li jo mh mi lk mj bi translated">(中文)</h2><p id="a2f4" class="pw-post-body-paragraph ix iy hi iz b ja lr ij jc jd ls im jf jg lt ji jj jk lu jm jn jo lv jq jr js hb bi">[2] 李大貓(2016)。R语言在哪些情况下for循环可以避免？取自：</p><div class="mz na ez fb nb nc"><a href="https://www.zhihu.com/question/33901694" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi">R语言在哪些情况下for循环可以避免？</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx">用过一段时间R的朋友估计对R语言的for loop循环和apply函数孰优孰劣问题都不会陌生，网络上可以找到很多讨论，知乎上类似的问题也不少，可以看到大多数的意见是不要用for…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">www.zhihu.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq kn nc"/></div></div></a></div><p id="386b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">[3] celestialgod (攸藍)(2015)。Re: [問題] 應用迴圈於資料處理的效率。取自：</p><div class="mz na ez fb nb nc"><a href="https://www.ptt.cc/bbs/R_Language/M.1438689234.A.10D.html" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi">Re: [問題] 應用迴圈於資料處理的效率</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx">※ 引述《missingmini (just missing)》之銘言： : [程式範例]: : 我有一個很大的 data.table 物件，名稱為 tbl_left，是由 fread 讀入文字檔案 : 建立的，大小為 1821350 x…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">www.ptt.cc</p></div></div></div></a></div><p id="7811" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">[4] R 语言的内置函数是用什么语言编的？取自：</p><div class="mz na ez fb nb nc"><a href="https://d.cosx.org/d/101285-101285" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi">R语言的内置函数是用什么语言编的？ - COS论坛 | 统计之都 | 统计与数据科学论坛</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx">R的大多数函数都是R语言写的，还有一大部分是C语言，极少部分Fortran。你下载R的源代码包解压用R统计一下就知道了。 ## 列举所有文件 x = list.files('R-2.10.1', recursive = TRUE) ##…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">d.cosx.org</p></div></div><div class="nl l"><div class="nr l nn no np nl nq kn nc"/></div></div></a></div><p id="5391" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">[5] 梁家安 (2017)。Efficiency Tips for R Loop。取自：</p><div class="mz na ez fb nb nc"><a href="https://rpubs.com/leongkaon/268784?fbclid=IwAR0gJaTyFjFmgvH53uWGY5bzrwMaJ-w0vN4Qdjr_fUhRiiLgkp0-vhoJ-G0" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi translated">RPubs</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">编辑描述</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">rpubs.com</p></div></div></div></a></div></div></div>    
</body>
</html>