<html>
<head>
<title>Execute MySQL Queries 10x Faster-Simple PySpark tutorial with Databricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MySQL 查询执行速度提高 10 倍——简单的 PySpark 教程，带数据块</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/execute-mysql-queries-10x-faster-simple-pyspark-tutorial-with-databricks-a39164550749?source=collection_archive---------4-----------------------#2020-09-23">https://medium.com/analytics-vidhya/execute-mysql-queries-10x-faster-simple-pyspark-tutorial-with-databricks-a39164550749?source=collection_archive---------4-----------------------#2020-09-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d5dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如今许多公司都使用 Apache Spark。对于那些不使用 Spark 的人来说，您在执行查询上花费了过多的时间。学习它会让你在工业上更有优势。此外，在您的本地机器上安装 Spark 可能非常复杂，除非您有一个非常昂贵和强大的系统，否则不值得麻烦地尝试安装(相信我！).幸运的是，Databricks 公司提供了 Spark 基础设施，没有所有复杂的安装问题…..而且可以免费使用！下面是开始的步骤！</p><h1 id="c8aa" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak"> 1。下载 JDBC 驱动</strong></h1><p id="7fa7" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">一个<strong class="ih hj"> JDBC 驱动程序</strong>是一个软件组件，它使得一个<a class="ae kg" href="https://en.wikipedia.org/wiki/Java_(programming_language)" rel="noopener ugc nofollow" target="_blank"> Java </a>应用程序能够与一个<a class="ae kg" href="https://en.wikipedia.org/wiki/Database" rel="noopener ugc nofollow" target="_blank"> d </a>数据库(<a class="ae kg" href="https://en.wikipedia.org/wiki/JDBC_driver" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/JDBC_driver</a>)进行交互</p><p id="5790" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 jupyter notebook 中运行这两个命令(如果您是 linux 用户，也可以在 bash 中运行它们):</p><p id="c531" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">I)为 MySQL <br/>下载必要的 JDBC 驱动！wget<a class="ae kg" href="https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.45.tar.gz" rel="noopener ugc nofollow" target="_blank">https://dev . MySQL . com/get/Downloads/Connector-J/MySQL-Connector-Java-5 . 1 . 45 . tar . gz</a></p><p id="0d73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ii)提取 JDBC 驱动 JAR 文件<br/>！塔尔 zxvf mysql-connector-java-5.1.45.tar.gz</p><h1 id="9343" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak"> 2。创建数据块账户</strong></h1><div class="kh ki ez fb kj kk"><a href="https://databricks.com/try-databricks?_ga=2.119219724.466172152.1600626235-1555438613.1599863553" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hj fi z dy kp ea eb kq ed ef hh bi translated">尝试数据块</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">为业务选择一个平台数据团队的协作环境，共同构建解决方案无限…</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">databricks.com</p></div></div><div class="kt l"><div class="ku l kv kw kx kt ky kz kk"/></div></div></a></div><p id="fa20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">I)填写表格</p><p id="8e5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ii)选择“社区版”</p><p id="ac0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iii)当您完成身份验证并进入主屏幕时，选择“工作区”。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es la"><img src="../Images/06dfcc592fe21899385bf70afa1c9e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eridCaONircjBLsEyblPyw.jpeg"/></div></div></figure><p id="fd13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iv)然后点击“创建”,然后点击“库”</p><p id="4e60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">v)随意命名库，然后放入 jar 文件并点击“创建”</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es ll"><img src="../Images/bfdfc318a2bd95f8e6a438e8e2d1949f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXpUlTbA0S7fFuZ804kIgw.jpeg"/></div></div></figure><p id="93e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">vi)在下一页上，单击“在所有群集上自动安装”</p><h1 id="f4fb" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">3.创建一个集群</h1><p id="0952" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">集群是数据块计算资源的集合。</p><p id="3e55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">I)在侧边栏中，单击<strong class="ih hj">集群</strong>按钮。</p><p id="2561" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">二)1。在群集页面上，单击'<strong class="ih hj">创建群集'</strong></p><p id="f5c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iii)为其命名，保留所有默认设置，然后单击“创建集群”</p><h1 id="3f7a" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">4.创建笔记本</h1><p id="935e" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">笔记本是在 Apache Spark 集群上运行计算的单元的集合。要在工作区中创建笔记本:</p><p id="0448" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一、在工具条中，点击<strong class="ih hj">工作区</strong>按钮。</p><p id="f497" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">二。在工作区文件夹中，选择:<strong class="ih hj">创建&gt;笔记本</strong>。</p><p id="5daf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">三。在创建笔记本对话框中，输入名称并在语言下拉列表中选择<strong class="ih hj"> Python </strong>(假设您是 Python 用户)</p><p id="78da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">四。点击<strong class="ih hj">创建</strong>。笔记本打开，顶部有一个空单元格。</p><h1 id="92b0" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak"> 5。MySQL-PySpark 连接示例</strong></h1><p id="208a" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在笔记本中，用您的 MySql 凭证填写以下模板</p><p id="1ac1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">I)创建 JDBC 网址</p><pre class="lb lc ld le fd lm ln lo lp aw lq bi"><span id="6de9" class="lr je hi ln b fi ls lt l lu lv"><br/>jdbcHostname = "&lt;hostname&gt;"<br/>jdbcDatabase = "employees"<br/>jdbcPort = 3306<br/>jdbcUrl = "jdbc:mysql://{0}:{1}/{2}?user={3}&amp;password={4}".format(jdbcHostname, jdbcPort, jdbcDatabase, username, <strong class="ln hj">password)</strong></span></pre><p id="4346" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ii)将查询下推到数据库引擎</p><pre class="lb lc ld le fd lm ln lo lp aw lq bi"><span id="53c8" class="lr je hi ln b fi ls lt l lu lv">pushdown_query = "(select * from employees where emp_no &lt; 10008) emp_alias"<br/>df = spark.read.jdbc(url=jdbcUrl, table=pushdown_query)<br/>display(df)</span></pre><p id="eb7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！您刚刚使用 PySpark SQL 执行了您的查询！轻松点。</p><h1 id="ba04" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak"> 6。我的例子-快 10 倍！</strong></h1><p id="2a9f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">检查这两个查询的运行时间。一个在 PySpark SQL 中，一个在 MySQL 中</p><p id="a3d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MySQL-7.56 分钟</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es lw"><img src="../Images/f878b7e517ca2f80cb1b517e195aabb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*UpArIdIblQIpEtRA_dVyPQ.png"/></div></figure><p id="c9ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PySpark SQL- 45.27 秒</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lx"><img src="../Images/64990dbc8ce4eeab2ca14a9ee3d075bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*8krSzlR8eDROLjkPJiuZUQ.png"/></div></div></figure><p id="2228" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">感谢阅读！如果这个教程对你有帮助，请喜欢它，也请跟随我。干杯！</strong></p><h1 id="e28b" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">来源和其他参考资料</strong></h1><p id="ad5c" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated"><a class="ae kg" href="https://neptune.ai/blog/apache-spark-tutorial" rel="noopener ugc nofollow" target="_blank">https://neptune.ai/blog/apache-spark-tutorial</a></p><p id="6f0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kg" rel="noopener" href="/@wesmelton/how-to-use-jdbc-mysql-sql-drivers-with-databricks-apache-spark-774544aa856">https://medium . com/@ wesmelton/how-to-use-JDBC-MySQL-SQL-drivers-with-data bricks-Apache-spark-774544 aa 856</a></p><p id="3e33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kg" href="https://docs.databricks.com/getting-started/quick-start.html" rel="noopener ugc nofollow" target="_blank">https://docs . data bricks . com/getting-started/quick-start . html</a></p><p id="226f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kg" href="https://docs.databricks.com/data/data-sources/sql-databases.html" rel="noopener ugc nofollow" target="_blank">https://docs . databricks . com/data/data-sources/SQL-databases . html</a></p></div></div>    
</body>
</html>