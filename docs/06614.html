<html>
<head>
<title>Why Accuracy is not the Best Metric?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么准确性不是最好的衡量标准？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/why-accuracy-is-not-the-best-metric-59214724faf3?source=collection_archive---------29-----------------------#2020-05-27">https://medium.com/analytics-vidhya/why-accuracy-is-not-the-best-metric-59214724faf3?source=collection_archive---------29-----------------------#2020-05-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/5ea878be04f6fb1c22701f73e040bf2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*jO6eiMLIlE-yD2UIHWBtxw.png"/></div></figure><h1 id="8f12" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">介绍</h1><p id="b7d0" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">目前，世界正在抗击一种疾病——新冠肺炎。致命的是它攻击呼吸器官，可能是致命的。它也在人群中传播，因此，我们需要隔离怀疑感染新冠肺炎病毒的人。我们可以尝试建立一个机器学习模型，根据特征(体温、外部症状或血细胞计数)来预测一个人是否需要隔离。</p><p id="f5ec" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">让我们考虑一个使用决策树分类器构建的样本模型:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="4246" class="kw in hi ks b fi kx ky l kz la">model = <strong class="ks hj">DecisionTreeClassifier</strong>(max_depth=4).fit(X_train, y_train)<br/>y_pred = model.predict(X_test)<br/>print('accuracy: %.2f'% accuracy_score(y_test, y_pred))</span></pre><blockquote class="lb lc ld"><p id="f485" class="jk jl le jm b jn ki jp jq jr kj jt ju lf kk jx jy lg kl kb kc lh km kf kg kh hb bi translated"><strong class="jm hj">输出:</strong> <br/> <em class="hi">精度:0.95 </em></p></blockquote><p id="81bd" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">我们得到了相当好的精度，可能是我们所期望的结果。但是，让我们来看看几个可能会导致问题的场景:</p><ol class=""><li id="6596" class="li lj hi jm b jn ki jr kj jv lk jz ll kd lm kh ln lo lp lq bi translated">尽管准确性很高，但该模型仍然预测到少数人被错误地归类为新冠肺炎阳性。这将不必要地增加隔离的必要性。另一方面，该模型也可能预测少数新冠肺炎阴性的人，这是危险的，因为患者可能在没有治疗的情况下导致严重的健康问题，并且在没有隔离的情况下不知不觉地传播。在误分类中，前者被称为<strong class="jm hj"> <em class="le">假阳性</em> </strong>或<strong class="jm hj"><em class="le">1型错误</em> </strong>，后者被称为<strong class="jm hj"> <em class="le">假阴性</em> </strong>或<strong class="jm hj"><em class="le">2型错误</em> </strong>。这取决于哪个指标更重要和需要更多关注的问题，考虑到我们的问题陈述，我们需要减少假阴性计数。</li><li id="34d9" class="li lj hi jm b jn lr jr ls jv lt jz lu kd lv kh ln lo lp lq bi translated">在实际数据集中发现的一个常见问题是<strong class="jm hj">不平衡数据集</strong>。我们不能期望真实场景中的类具有相同数量的数据。考虑到上述问题陈述，我们可能将95%的数据归类为非新冠肺炎患者。用此数据训练的模型在新数据上大多会预测为非新冠肺炎，并且可能显示出较高的准确性。因此，我们发现精确度不是描述我们的模型有多好的最佳度量。</li></ol><h1 id="02d6" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">让我们看看有助于量化结果的替代指标:</h1><h2 id="6f73" class="kw in hi bd io lw lx ly is lz ma mb iw jv mc md ja jz me mf je kd mg mh ji mi bi translated">混淆矩阵</h2><p id="eed0" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">为了评估二元分类，我们使用混淆矩阵来导出预测结果的重要度量。混淆矩阵看起来像:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/71038443d110140f933135099606841f.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*71Zb7ziBD5uVe7k-hL8lAw.png"/></div></figure><p id="cb7a" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">它让我们深入了解我们已经讨论过的假阳性和假阴性。它还显示了真阳性和真阴性，正如名称所暗示的，如果我们认为我们的类别是阳性和阴性，那么正确分类的数字将由真阳性和真阴性来表示。</p><p id="7d42" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">考虑到上述训练的模型，我们获得一个混淆矩阵:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="5ce3" class="kw in hi ks b fi kx ky l kz la">(tn, fp, fn, tp) = <strong class="ks hj">confusion_matrix</strong>(y_test, pred_y).ravel()<br/>print('TP: %d, TN: %d, FP: %d, FN: %d' % (tp, tn, fp, fn))</span></pre><blockquote class="lb lc ld"><p id="6953" class="jk jl le jm b jn ki jp jq jr kj jt ju lf kk jx jy lg kl kb kc lh km kf kg kh hb bi translated"><strong class="jm hj">输出:</strong> <br/> TP: 29，TN: 397，FP: 6，FN: 18</p></blockquote><p id="23ac" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">虽然准确性很高，但该模型仍然产生18个假阴性，这将不必要地导致病毒传播。我们需要尽可能地降低这个数字，同时我们不能认为每个人都是积极的，那么这个模型就没有用了。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="er es mk"><img src="../Images/1cdc86481bdded5b7d0998824fde551c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VeyCBBMmBGY5OAAivu-o3Q.png"/></div></div></figure><h2 id="aff5" class="kw in hi bd io lw lx ly is lz ma mb iw jv mc md ja jz me mf je kd mg mh ji mi bi translated"><strong class="ak">除了准确性之外，其他有用的指标:</strong></h2><p id="4141" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated"><strong class="jm hj"><br/></strong>精度它决定了预测为阳性的样本数为正[1]。当我们希望假阳性尽可能少时，它有助于确定指标。让我们考虑网页中经常使用的检测僵尸程序的图像验证系统。现在，如果一个人试图访问并且基于验证系统它拒绝访问，那么它不能提供一个好的提供者系统。因此，我们需要建立模型来减少这种情况下的假阳性。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/f7fbe3d113369622e18b99cabd015ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*6nl_2O54EyIXvzYDif4C8Q.png"/></div></figure><p id="b75f" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj">回忆<br/> </strong>也称为灵敏度，它决定了正面预测所捕获的正面样本的数量[1]。上面讨论的问题陈述表明，当我们将一个人归类为新冠肺炎患者或非患者时，需要更少的假阴性。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/3455f8fcae55a4574863b6abe1b70e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*jHUEQY674sOWhNIYeJLt4A.png"/></div></figure><blockquote class="lb lc ld"><p id="59aa" class="jk jl le jm b jn ki jp jq jr kj jt ju lf kk jx jy lg kl kb kc lh km kf kg kh hb bi translated">在一个模型中考虑这两个指标可能会变得具有挑战性，因为我们可能会构建减少假阳性但导致假阴性增加的模型，反之亦然。需要一个平衡的指标来解决这个问题。因此，我们来到F1-Score。</p></blockquote><p id="01f0" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj"> F1得分</strong> <br/>它是精确度和召回率的调和平均值，其中F1得分在1 [2]处达到最佳值。它提供了一个更好的衡量标准来找到精确度和召回率之间的平衡，并通过不仅仅依赖精确度来更好地理解模型。通常，即使两个模型的精确度非常接近，我们也可能会发现F1分数存在明显差异。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="er es mq"><img src="../Images/eac34929129488ccacac17493bf932e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*XLG_xmfKp9rsibZrqRFc9w.png"/></div></div></figure><h2 id="251e" class="kw in hi bd io lw lx ly is lz ma mb iw jv mc md ja jz me mf je kd mg mh ji mi bi translated">受试者工作特性曲线</h2><p id="7e55" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">为了决定最终的模型，我们需要决定分类器所有可能的阈值。ROC曲线显示召回率或真阳性率对假阳性率。假阳性率是指被错误捕获为阳性样本的阴性样本数。我们可以对目标变量设置不同的阈值，并绘制相应的召回率和假阳性率值。具有良好分类的模型将具有高的召回率和假阳性率。因此，理想的曲线应该接近图的左上角，而不好的分类将导致ROC曲线接近45°的线。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/b750a6fd0820496f45223875b2fc7902.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*or0L4CRW5KHnuajUkoinaw.png"/></div><figcaption class="ms mt et er es mu mv bd b be z dx translated">理想ROC曲线</figcaption></figure><p id="2e2d" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">对应ROC曲线的面积称为<strong class="jm hj"> AUROC(受试者工作特性曲线下面积)</strong>。一个理想的好分类模型将具有为1的AUROC值。分类器的<strong class="jm hj"> <em class="le"> AUROC </em> </strong> <em class="le">等于分类器将随机选择的正样本排序高于随机选择的负样本的概率。</em></p></div><div class="ab cl mw mx gp my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="hb hc hd he hf"><p id="a81e" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj">参考文献</strong></p><p id="9ebd" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">[1]Andreas c . Muller &amp; Sarah Guido—<em class="le">“用python进行机器学习简介”</em></p><p id="9a6b" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">[2]https://en.wikipedia.org/wiki/F1_score<a class="ae nd" href="https://en.wikipedia.org/wiki/F1_score" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl mw mx gp my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="hb hc hd he hf"><p id="dc00" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj">感谢您阅读本文。编码快乐！</strong></p></div></div>    
</body>
</html>