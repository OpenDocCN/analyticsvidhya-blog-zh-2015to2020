<html>
<head>
<title>Twitter Sentiment Analysis &amp; Botometer — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Twitter 情绪分析和 Botometer——第二部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/twitter-sentiment-analysis-botometer-part-2-aecdbbbada30?source=collection_archive---------11-----------------------#2020-08-17">https://medium.com/analytics-vidhya/twitter-sentiment-analysis-botometer-part-2-aecdbbbada30?source=collection_archive---------11-----------------------#2020-08-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/cc0f5b7961b654d5fb5e8a501b5e993f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2QHg3p6QP5swOz-Yf8tkfw.png"/></div></figure><p id="91f6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是我的 Twitter 情绪分析和 Botometer 项目博客的第二部分。在这里，我将解释我用来对推文进行简单情感分析的过程(分类推文是正面还是负面)。</p><p id="64d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">简单回顾一下，情感分析是给文本分配一个数值的过程，其中段落在情感(观点或看法)上被评定为积极、消极或中立。作为奖励，我还使用 Twitter 的 API，使用 Botometer 来执行 Twitter 用户僵尸检测。Botometer 是一个软件包，可以在某个阈值上评估特定 Twitter 用户是机器人还是人类的可能性。</p><p id="d78d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">关于获取 Twitter API(应用程序编程接口)凭证的第 1 部分可以在这里找到:</p><p id="ce66" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" rel="noopener" href="/@sdman135/twitter-sentiment-analysis-botometer-part-1-twitter-api-b7604f7af4e9">https://medium . com/@ sdman 135/Twitter-情操-分析-botometer-part-1-Twitter-API-b 7604 f 7 af 4 e 9</a></p><p id="fd94" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">好了，有了我的定制 python 文件(config.py)和 Twitter API 证书，我可以开始使用 python 库'<strong class="io hj"> Tweepy </strong>'拉推了。但是首先我们需要运行定制的 python 文件来加载隐藏变量。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="7aa7" class="ju jv hi jq b fi jw jx l jy jz"><em class="ka"># Running file with my hidden Twitter API info</em><br/>%run config/config.py</span></pre><h1 id="63a6" class="kb jv hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">十二岁</h1><p id="c17a" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">Tweepy 是一个开源的 python 库，托管在<a class="ae jk" href="https://github.com/tweepy/tweepy" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上，使 Python 能够与 Twitter 通信，通过使用其 API 来完成多种不同的操作。Tweepy 还可以帮助制作一个 Twitter 机器人，并自动执行一些操作，如发布推文、喜欢推文或关注某人。但是对于这个项目，我主要是用它来收集推文来进行我的分析。</p><p id="d730" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我使用 OAuthHandler 实例向 twitter 认证，传递我的消费者 API 密钥和访问令牌</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="c8e8" class="ju jv hi jq b fi jw jx l jy jz">auth = tweepy.OAuthHandler(consumer_key, consumer_secret)<br/>auth.set_access_token(access_token,access_token_secret)</span><span id="7dfc" class="ju jv hi jq b fi ld jx l jy jz">api = tweepy.API(auth)</span></pre><p id="c7b6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">API 类提供了对整个 twitter RESTful API 方法的访问。每个方法都可以接受各种参数并返回响应。</p><h2 id="76e5" class="ju jv hi bd kc le lf lg kg lh li lj kk ix lk ll ko jb lm ln ks jf lo lp kw lq bi translated">拉推文</h2><p id="27f3" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">写了一个函数，用 tweepy 的 api 调用，用一个‘关键字’拉推文；并将提取的推文作为熊猫数据帧返回。调用 tweepy 我专注于拉 10，000 条推文，前提是推文是英文的，并且推文不能是转发(原创推文)。如果他们遵循这些标准，该函数将以字符串格式 提取推文 的<strong class="io hj"> <em class="ka">用户名、推文</em> </strong>的<strong class="io hj"> <em class="ka">日期时间以及最后的<strong class="io hj"> <em class="ka">实际推文。还有几个属性我可以拉，但对于这个项目，我只关注这 3 个。拉完推文后，它们被保存到熊猫的数据框中。</em></strong></em></strong></p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="fbb8" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq hj">def</strong> get_related_tweets(key_word):<br/>    <br/>    twitter_users = []<br/>    tweet_time = []<br/>    tweet_string = [] <br/>    <br/>    <strong class="jq hj">for</strong> tweet <strong class="jq hj">in</strong> tweepy.Cursor(api.search,q=key_word, count=1000).items(10000):<br/>            <em class="ka"># Using orginal tweets not retweets</em><br/>            <strong class="jq hj">if</strong> (<strong class="jq hj">not</strong> tweet.retweeted) <strong class="jq hj">and</strong> ('RT @' <strong class="jq hj">not</strong> <strong class="jq hj">in</strong> tweet.text):<br/>                <em class="ka"># Only using english tweets</em><br/>                <strong class="jq hj">if</strong> tweet.lang == "en":<br/>                    <em class="ka"># Tweeter's username </em><br/>                    twitter_users.append(tweet.user.name)<br/>                    <em class="ka"># Date and Time tweet was created</em><br/>                    tweet_time.append(tweet.created_at)<br/>                    <em class="ka"># Actual tweet</em><br/>                    tweet_string.append(tweet.text)<br/>                    print([tweet.user.name,tweet.created_at,tweet.text])<br/>    <em class="ka"># Creating dataframe with desired info</em><br/>    df = pd.DataFrame({'name':twitter_users, 'time': tweet_time, 'tweet': tweet_string})<br/>    <br/>    <strong class="jq hj">return</strong> df</span></pre><p id="d1e9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我在两个话题上各发了 1 万条推文。先是唐纳德·特朗普(Donald Trump)，然后是我喜欢的一部韩国漫画(Manhwa)(但它现在处于暂停状态)“单人练级”。如果你正在寻找一部精彩的动作片，强烈推荐这本书。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="5b1b" class="ju jv hi jq b fi jw jx l jy jz">#pulling tweets that mentions 'Trump'<br/>get_related_tweets('Trump')</span><span id="66f5" class="ju jv hi jq b fi ld jx l jy jz">#pulling tweets that mentions 'Solo Leveling'<br/>get_related_tweets('Solo Leveling')</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lr"><img src="../Images/c96019217c9401f347c0ac70d66f2e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZl5YES0b9zi_h6c1CikQw.jpeg"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">使用关键字= 'Trump '提取的内容示例</figcaption></figure><h1 id="9afe" class="kb jv hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">推特上的情感分析:</h1><p id="c939" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">对于情感分析，我使用了一个非常轻量级的 python 包(<strong class="io hj"> TextBlob </strong>)，它将为我提供一个漂亮而简单的情感极性分数。极性得分是一个浮动值，范围从-1 到+1(分别为 100%负面情绪到 100%正面情绪)。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ma"><img src="../Images/457645065f2c62fc6611c0d3274e0544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s2aAzRLuRrll2JlM.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">特定推文的情感分析值示例(显示这是一条稍微负面的推文)</figcaption></figure><p id="3d4c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了更容易调用，我将情感极性包装在一个函数中。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mb"><img src="../Images/b7b66dd82733fadf7c8854fa2627738a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7L0om91Ej60WDica1Gpsqw.jpeg"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">使用函数的特定推文的情感分析值示例(显示这是一条正面推文)</figcaption></figure><p id="7139" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，我使用一个简单的 lambda 函数对整个数据帧执行情感极性函数。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ma"><img src="../Images/8691a53886552e3213829f99dd706c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iBSwqzmtlCELx2ux.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">不得不审查用户的屏幕名称</figcaption></figure><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mc"><img src="../Images/b99e2d27cb9d780c57f85a85f71630df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RQlQTK2OxFv69PY0jnO1wg.jpeg"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">带有情感极性得分的干净数据帧的示例(单平韩文 Manhwa)</figcaption></figure><ul class=""><li id="92bd" class="md me hi io b ip iq it iu ix mf jb mg jf mh jj mi mj mk ml bi translated">最后，我将情感极性得分按积极/消极进行分类，并显示每个得分。</li></ul><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ma"><img src="../Images/4cc8155ec4d304122e4bc08cb218ecdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n7DfMjwCgSiL0Q--.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">关于总统的正反推文数量非常接近</figcaption></figure><h1 id="dba4" class="kb jv hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">Botometer</h1><p id="a0f4" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">最后，我用 Twitter 的 Api 对一些用户运行了 Botometer。Botometer 分析用户是机器人还是人类。阈值分数小于 0.5，Botometer 预测用户最有可能被人类控制。</p><p id="9b2c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，我用类似 Tweepy 的 Twitter API 证书认证了 Botometer。我还需要一把 rapidapi 钥匙，用于在这里找到的<a class="ae jk" href="https://rapidapi.com/OSoMe/api/botometer-pro" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="e41e" class="ju jv hi jq b fi jw jx l jy jz">twitter_app_auth = {<br/>                    'consumer_key': consumer_key,<br/>                    'consumer_secret': consumer_secret,<br/>                    'access_token': access_token,<br/>                    'access_token_secret': access_token_secret<br/>                   }<br/>botometer_api_url = "https://botometer-pro.p.rapidapi.com"<br/><br/>bom = Botometer(<br/>                wait_on_ratelimit = <strong class="jq hj">True</strong>,<br/>                botometer_api_url=botometer_api_url,<br/>                rapidapi_key = rapidapi_key,<br/>                **twitter_app_auth)</span></pre><p id="cbf8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">响应对象有五个主要部分:</p><ul class=""><li id="c46c" class="md me hi io b ip iq it iu ix mf jb mg jf mh jj mi mj mk ml bi translated"><strong class="io hj">用户</strong>正是来自请求的用户对象。我们将它原封不动地返还给您，并牢记异步工作流，这样您就不必担心保存用户数据并在以后将其与适当的响应相匹配。</li><li id="6144" class="md me hi io b ip mm it mn ix mo jb mp jf mq jj mi mj mk ml bi translated"><strong class="io hj">分数</strong>包含总体分类结果。<em class="ka">英语</em>评分使用所有六个类别的特征，而<em class="ka">通用</em>评分省略了情感和内容特征，两者都是英语特有的。</li><li id="3e82" class="md me hi io b ip mm it mn ix mo jb mp jf mq jj mi mj mk ml bi translated"><strong class="io hj">类别</strong>给出了六个要素类的子分数。</li><li id="0ba2" class="md me hi io b ip mm it mn ix mo jb mp jf mq jj mi mj mk ml bi translated"><strong class="io hj"> CAP </strong>完全自动化概率(CAP)是根据我们的模型，这个账户完全自动化的概率，即一个机器人。这种概率计算使用贝叶斯定理来考虑对机器人总体流行程度的估计，以便平衡误报和漏报。</li><li id="24f8" class="md me hi io b ip mm it mn ix mo jb mp jf mq jj mi mj mk ml bi translated"><strong class="io hj">显示分数</strong>基本上是对应的原始分数乘以 5。显示分数显示在<a class="ae jk" href="https://botometer.iuni.iu.edu/" rel="noopener ugc nofollow" target="_blank">https://botometer.iuni.iu.edu/</a>上。</li></ul><p id="ab83" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来我用一行代码检查了几个使用 Botometer 的用户。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ma"><img src="../Images/4e24035803834f59ffa7960c530e4cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*reSFiH3auF3mzmK4.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">样本显示，根据 Botometer，用户(评分= 0.032)最有可能是人类。</figcaption></figure><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mr"><img src="../Images/807088b95d4b236e954e2d8392147d44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hR815fcYZfJWXVKoY-TZFA.jpeg"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">示例显示用户(评分= 0.892)最有可能是基于僵尸工具的僵尸工具。</figcaption></figure><p id="2ddb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">希望你喜欢我的过程。并继续关注更多项目。</p><p id="a723" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意安全。</p></div></div>    
</body>
</html>