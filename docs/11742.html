<html>
<head>
<title>Web Scraping Example in Python using BeautifulSoup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 BeautifulSoup 的 Python 抓取示例</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/web-scraping-example-in-python-using-beautifulsoup-ed7db83d690?source=collection_archive---------19-----------------------#2020-12-16">https://medium.com/analytics-vidhya/web-scraping-example-in-python-using-beautifulsoup-ed7db83d690?source=collection_archive---------19-----------------------#2020-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f64a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一次我正在开发一个 React 本地移动应用程序，我需要从“万维网”上获取大量数据，而我几乎没有时间去获取它们。(没有时间手写。)作为一个渴望学习新技术的人，我做了一些研究，发现了网络抓取的概念。经过更多的研究，我给了一个叫做 BeautifulSoup 的 Python Web 抓取库一个机会。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e21ae56b1a6c2edd2bb9def21f709ba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLbW76S3hEhmyNi2nSew6w.jpeg"/></div></div></figure><p id="7196" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个故事中，我将以自己的代码为例，尝试解释如何使用 Python 和 BeautifulSoup 库来执行基本的 web 报废。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="e018" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">顺便说一句，如果你合乎道德地使用，网络废弃并不违法。如果你使用的数据已经对所有人公开，那就不应该，但是要注意所有的伦理方面。例如，由于太多的网络垃圾机器人导致网站带宽过载和流量中断，可能会产生一些非法后果。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="0b1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们先试着熟悉一下网页抓取的概念，好吗？为了使这个故事简短，我将引用维基百科，你可以在这里找到<a class="ae jx" href="https://en.wikipedia.org/wiki/Web_scraping#:~:text=Web%20scraping%2C%20web%20harvesting%2C%20or,or%20through%20a%20web%20browser." rel="noopener ugc nofollow" target="_blank">的完整版本。</a></p><blockquote class="jy jz ka"><p id="8837" class="if ig jw ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated"><strong class="ih hj">网页抓取</strong>、<strong class="ih hj">网页抓取</strong>或<strong class="ih hj">网页数据提取</strong>是用于从网站中提取数据的数据抓取。网络抓取软件可以使用超文本传输协议直接访问万维网，或者通过网络浏览器访问万维网。虽然 web 抓取可以由软件用户手动完成，但该术语通常指的是使用 bot 或 web crawler 实现的自动化过程。这是一种复制形式，从网络上收集并复制特定数据，通常复制到中央本地数据库或电子表格中，供以后检索或分析。</p></blockquote><p id="4a45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">维基百科称术语“<em class="jw">虽然网络抓取可以由软件用户手动完成，但该术语通常指的是使用机器人或</em> <strong class="ih hj"> <em class="jw">网络爬虫</em> </strong> <em class="jw">实现的自动化过程。这里写的是网络爬虫，但我认为我们也应该知道网络抓取和网络爬行的区别。</em></p><p id="2dd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单来说，<strong class="ih hj">网络搜集</strong>就是以自动化的方式从网站中提取数据的行为。这是对网页的程序化分析，以便从中下载信息。例如:假设您想从一个电子商务网站中提取特定产品的价格。您编写了一个 web scraper，通过编程从电子商务网站获取 HTML。</p><p id="4c64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，<strong class="ih hj">网页抓取</strong>往往是略有不同的技术。它基本上是一个系统地浏览(读取抓取)万维网的互联网机器人，通常用于 Web 索引。您将一个种子 URL 加载到一个 crawler，它会索引该 URL 的每个子域，并复制数据以供进一步分析。搜索引擎使用网络爬行来索引互联网上的所有内容。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="2d7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在基本介绍之后，我们可以继续看编码示例。这个小应用程序是用 Python 开发的，使用 BeautifulSoup 库作为 web 抓取库。</p><p id="df0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先要做的事。我们需要导入相关的库。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="0300" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入<strong class="ih hj"> BeautifulSoup </strong>以便使用著名的 web scrapper 库。导入<strong class="ih hj"> urllib.request </strong>以打开对特定 URL 的 HTTP 请求。更详细的解释:<a class="ae jx" href="https://docs.python.org/3/library/urllib.request.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/urllib.request.html</a>。</p><p id="54b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，如果您需要解析来自 URL 的数据，请导入<strong class="ih hj"> re </strong> <em class="jw"> </em>(用于正则表达式)<em class="jw"> </em>或任何其他模块。</p><p id="08b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入之后，要做的第一件事是获取主 URL 并打开到该 URL 的连接。我想将从连接中获得的数据存储在一个文本文件中，所以我也打开了一个文件连接。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="efa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们目前没有做任何废弃，只是打开了一个到 URL 的连接，读取了所有的 HTML 数据并关闭了连接。现在，是时候解析 HTML 数据并从中提取一些有意义的信息了。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="713e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的代码行在我的经验中非常重要。大多数时候，BeautifulSoup 可以正确地计算出一个站点的字符编码，但有时情况并非如此。有时它不能得到正确的编码，这让我很头疼。所以，为了绝对安全，我用上面的代码告诉 BeautifulSoup 他需要如何解析来自 URL 的 HTML 数据。在大多数情况下，字符编码是 UTF-8，数据是 HTML 格式。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="d994" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有很多不同的方法来识别你的目标 html 元素，比如元素标签名，id，类名，甚至是样式。我使用了其中一些方法来获得我需要的数据。我想从一个特定的表中获取所有的行，我使用它的元素 id 来访问表。之后，我只使用元素名访问了它的'<em class="jw"> tbody' </em>，并获得了所有使用'<em class="jw"> tr </em>标签的行。</p><p id="78dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有行都有链接到网站子域地址的 URL。我的主要目标是遍历所有子域，并从这些子域的主表中获取所需的数据。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="cbf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这并不总是可行的，但是在这里，我可以通过样式来区分它们，从而获得所需的表行。我想得到所有的表格行('<em class="jw">tr '【T1])，如果它们的'<em class="jw">风格'</em>属性不等于'<em class="jw">高度:46px '(这是表格标题的高度)。</em>然后，我继续从所需表格行的每个单元格中获取值。使用<em class="jw"> row.findAll('td') </em>我得到了一个数组中的所有单元格。之后，我访问了'<em class="jw"> a' </em>标签，然后访问了它的'<em class="jw"> href' </em>标签，并将它们存储在一个名为<em class="jw"> allURLs </em>的数组中。</em></p><p id="5cf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我已经得到了所有子域的 URL。是时候遍历所有的 URL 并访问所需的表数据了。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="527b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在访问了表中所有的'<em class="jw"> td </em>之后，我通过检查一个特定列的文本值来忽略它。剩下的就是应用一些操作，只是为了从我搜集的数据中提取有意义的数据。最后，我关闭了文件阅读器，打印出了一条基本信息。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="a7b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是对使用 Python 的 BeautifulSoup 库进行 web 废弃的快速介绍。这个库本身还有更多的东西，但即使是这几行代码也帮助我在几分钟内获得了近 25 万行有意义的数据。Web 抓取是一种从 web 中提取数据的强有力的方法，在很多领域都非常有用。除了 BeautifulSoup，还有其他有用的库。我鼓励你去看看。</p><p id="2a93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在这里获得这个基本概念验证的完整源代码:<a class="ae jx" href="https://github.com/ismailgok33/UniversityInfo-WebScrapper" rel="noopener ugc nofollow" target="_blank">https://github.com/ismailgok33/UniversityInfo-WebScrapper</a>。我希望这非常有帮助。保持健康。</p></div></div>    
</body>
</html>