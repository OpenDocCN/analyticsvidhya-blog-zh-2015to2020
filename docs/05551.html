<html>
<head>
<title>Twitter Sentiment Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推特情感分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/twitter-sentiment-analysis-b9a12dbb2043?source=collection_archive---------3-----------------------#2020-04-25">https://medium.com/analytics-vidhya/twitter-sentiment-analysis-b9a12dbb2043?source=collection_archive---------3-----------------------#2020-04-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dcb1ee071e3d7747fc5221fbc61e7952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rPrehw_Oa8KT8OnYIfnRkQ.png"/></div></div></figure><blockquote class="iq ir is"><p id="bb27" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用<strong class="iw hj">自然语言处理</strong>理解人们的情绪</p></blockquote><h2 id="8997" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">介绍</h2><p id="59eb" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated"><strong class="iw hj"> Twitter </strong>是人们在各种场合广泛使用的表达观点和展示情感的平台之一。<strong class="iw hj">情感分析</strong>是一种分析数据并检索其所体现的情感的方法。</p><p id="d061" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">tweet格式非常小，这产生了一个全新的问题，比如俚语、缩写等的使用。本文报告了对数据的探索和预处理，将数据转换为适当的输入格式，并通过使用Python和NLTK库建立监督学习模型，将用户通过tweets的观点分类为<strong class="iw hj"> <em class="iv">积极(非种族主义者)和消极(种族主义者)</em> </strong>。</p><h2 id="0d6f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">先决条件</h2><p id="86c4" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated">假定对<strong class="iw hj"> scikit </strong>库和<strong class="iw hj"> NLTK </strong>有实际操作知识。我只是在开玩笑，你只需要对学习NLP和Python基础有强烈的热情，但是你必须对分类算法有很好的了解，因为一旦我们完成NLTK部分，这将派上用场。</p><p id="2363" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">作为先决条件，请确保您的计算机上安装了<a class="ae kv" href="https://jupyter.readthedocs.io/en/latest/install.html?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Jupyter Notebook </a>和P <a class="ae kv" href="https://www.python.org/downloads/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> ython </a>。代码片段只能在Jupyter笔记本上运行。</p><p id="cfe7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">好吧，我们开始吧。</p><p id="935a" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">下载安装NLTK </strong></p><ol class=""><li id="541b" class="kw kx hi iw b ix iy jb jc kd ky kh kz kl la jr lb lc ld le bi translated">安装NLTK:运行<code class="du lf lg lh li b">pip install nltk</code></li><li id="c606" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">测试安装:运行<code class="du lf lg lh li b">python</code>，然后键入<code class="du lf lg lh li b">import nltk</code></li></ol><p id="3b5d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">有关特定平台的说明，请在此处阅读<a class="ae kv" href="https://www.nltk.org/install.html" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="b413" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">我想保持这篇文章的准确性，并在需要时触及重要的理论概念。你可以在这里下载数据集和原始笔记本。</p><h2 id="f094" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">快速工作流程:</h2><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/aaf455e06a99f920d8eb0950095357ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*AjBD7nmt-udGSwS6YjwR5A.jpeg"/></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/fbacdc64957433f5b159672bfdcf2bbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0TzTQnm4sKEYESfCkzvFzA.png"/></div></div></figure><h2 id="51c1" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">查看数据集</h2><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/8da9d2646f30d5120ca9560c82e03c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OnZUhjhgMtbzb-AOvn1kCQ.png"/></div></div></figure><p id="aa3e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">让我们看看我们的训练和测试数据中的推文有多长</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/fb5274883c08d9a30da8ee28d8e50de6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hc4VYS7R3rUSB3joygkftA.png"/></div></div></figure><h2 id="dbd1" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">预处理</h2><p id="5ced" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated">文本数据的主要问题是它们都是文本格式(字符串)。然而，机器学习算法需要某种数字特征向量来执行任务。基本的<strong class="iw hj">文本预处理</strong>包括:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/748437a44da547e4186c642682705bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qmph5SSUzmTif8VkevjAZg.png"/></div></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/8aed6dcf97ca0054a142299a1b471729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axFWBlOfReIv6NZeAwQzTg.png"/></div></div></figure><h2 id="0a5e" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">标记化</h2><p id="6c6c" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated">它只是一个术语，用于描述将普通文本字符串转换为一系列标记(即我们实际需要的单词)的过程。句子分词器可以用来查找句子列表，单词分词器可以用来查找字符串中的单词列表。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/a720ae7924e6c38465f9bceffea4d4f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-vThCv7-sRYtkzc4LIM_g.png"/></div></div></figure><h2 id="a5c5" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">堵塞物</h2><p id="bd5b" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated">词干化是将屈折词(或有时是派生词)缩减为词干、词根或词根形式的过程，通常是书面形式。例如，如果我们要对以下单词进行词干处理:“词干”、“词干化”、“词干化”和“词干化”，结果将是一个单词“stem”。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/8d4d6723610250450e3253e116abd6cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNDdRoM38BaQY5H5LAlqTA.png"/></div></div></figure><h2 id="2043" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">转换</h2><p id="cd18" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated">将整洁的推文添加回我们的主(合并)数据框</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/d16365970bcfc38f47732288ff4cecf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIAFTZgBma05-KanGaKnRA.png"/></div></div></figure><p id="0469" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">现在，我想看看给定的情感在训练数据集中的分布情况。完成这项任务的一种方法是通过绘制单词云来理解常用单词。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/cff39582520b4795e6aeba42e3f43d7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P48HldySaWzueA2D3IMxVA.png"/></div></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/bf1b50b7bfd7857c405d42a46b5921be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7qedyKAJ6FeYsrs38Ugagg.png"/></div></div></figure><p id="1b5c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">单词云是由单词组合而成的图像，看起来像一个云状。云突出了在源文本中出现频率更高的单词。您可以使用不同的字体、布局和配色方案来调整您的云。</p><h2 id="10e0" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">从干净的推文中提取特征</h2><blockquote class="iq ir is"><p id="f95e" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">词汇袋</strong></p></blockquote><p id="0f8e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">词袋模型是自然语言处理和信息检索中使用的一种简化表示。在这个模型中，一个文本(比如一个句子或者一个文档)被表示为它的单词的包(多重集),不考虑语法甚至词序，但是保持多样性</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/6ae0575742cce788c7cf79363a36d591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxJyHuTeIjYosCE1Tl-wkQ.png"/></div></div></figure><h2 id="facd" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">TF-IDF</h2><p id="9fb4" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated"><strong class="iw hj"> <em class="iv"> TF-IDF </em> </strong>代表词频——逆文档频率:在大型文本语料库中，有些词出现频率很高，但有意义的信息很少。如果我们直接使用计数数据来训练模型，则意义不大的非常频繁的标记将对低频但有趣得多的术语产生显著影响。所以有必要对字数统计结果进行归一化和重新加权。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/6ae0575742cce788c7cf79363a36d591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxJyHuTeIjYosCE1Tl-wkQ.png"/></div></div></figure><p id="a6d8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="iv"> Word2vec </em> </strong>是处理文本的两层神经网络。它的输入是一个文本语料库，输出是一组向量</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/46a851dc3e934a4df6837b7d67f07f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z2vnjbMhc9NLaDCocdxifw.png"/></div></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/2322cdf4a02af1eb0873e5b45c05db4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKuuVmDRw65mjyJ5QfUqng.png"/></div></div></figure><p id="2a34" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">Word2vec的向量是如何创建的？<br/>我创建了一个函数，通过对推文中出现的单词的向量取平均值，为每条推文创建一个向量。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/af9df833d40db93d75207ed7ada3ad40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*Ut9vw0eBtoaeJQxlu4HdcA.png"/></div></figure><p id="3d9c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">为了实现Doc2vec，我们必须用唯一的id标记每个标记化的tweet。我们可以通过使用Gensim的LabeledSentence函数来做到这一点。Doc2vec是一个将文档表示为向量的NLP工具。</p><h2 id="2046" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">分类和评估</h2><p id="abb2" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated">现在我们已经准备好了数据的预建模阶段，是时候在我准备好数据的部分对它们进行分类了，这些数据是词袋、TF-IDF、word2vec向量和doc2vec向量。我知道你很高兴通过实现你总是听说的不同的机器学习模型来弄脏你的手和头脑。让我带你们一个接一个地看这些算法。请注意，我不会深入每个细节，但足以理解这些算法如何以及为什么对我们的情感分析有帮助。我已经实现了以下算法。</p><ol class=""><li id="0d21" class="kw kx hi iw b ix iy jb jc kd ky kh kz kl la jr lb lc ld le bi translated">逻辑回归</li><li id="463f" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">朴素贝叶斯</li><li id="b92c" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">支持向量机</li><li id="54c7" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">随机森林</li><li id="1295" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">XGBoost</li></ol><p id="ae05" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">但是仅仅建立算法是不够的。我们需要根据一些标准来评估我们的算法。因此，我认为衡量已实现模型性能的标准是混淆矩阵、准确性、AUC(曲线下面积)和F1分数。</p><p id="4880" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">混淆矩阵<br/> </strong>它是一种机器学习分类问题的性能度量，其中输出可以是两个或更多个类。这是一个包含4种不同的预测值和实际值组合的表格，为我们提供了一个矩阵作为输出，并描述了模型的完整性能。下面是混淆矩阵中涉及的术语。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/ce8fd2f159db536995de0c7bb79ab456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*oN46x_XjCIlP26p8U-jGIA.png"/></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">混淆矩阵</figcaption></figure><p id="cb19" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">真阳性:</strong></p><p id="7733" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">解读:你预测的是正的，这是真的。</p><p id="fbd7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">你预测推特是种族主义的，推特确实是。</p><p id="aa49" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">真否定:</strong></p><p id="0029" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">解读:你预测的是负数，这是真的。</p><p id="0bad" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">你预言推特不是种族主义的，推特实际上不是。</p><p id="fab7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">假阳性:(1型错误)</strong></p><p id="8df2" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">解读:你预测的是正的，是假的。</p><p id="4df4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">你预测推特是种族主义的，但推特实际上不是。</p><p id="4448" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">假阴性:(2型错误)</strong></p><p id="682e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">解读:你预测的是负数，这是假的。</p><p id="898c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">你预测推特不是种族主义，但推特确实是。</p><p id="3649" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">准确性<br/> </strong>由于我们正在研究对推文进行分类的分类问题(种族主义者&amp;非种族主义者)分类准确性将是模型的一个很好的评估者。这是评估机器学习模型表现如何的最常用指标。准确度是做出正确预测的数量与做出的预测总数的比率。</p><p id="b3da" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">准确度= (TP + TN)/(样本总数)</p><p id="68b7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">曲线下面积</strong></p><p id="900d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">曲线下面积(AUC)是最广泛使用的评估指标之一。它用于二进制分类问题。分类器的AUC等于分类器将随机选择的正例排序高于随机选择的负例的概率。</p><p id="7f12" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">假阳性率和真阳性率都具有在范围[0，1]内的值。AUC是在[0，1]内不同点的假阳性率对真阳性率的曲线下面积。</p><p id="7f56" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">ROC曲线下的面积通常用作分类模型质量的度量。随机分类器的曲线下面积为0.5，而完美分类器的AUC等于1。实际上，大多数分类模型的AUC在0.5到1之间</p><p id="37c6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">显然，AUC的范围是[0，1]。值越大，我们模型的性能越好。</p><p id="611d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">当分类器不能区分两组时，面积将等于0.5(ROC曲线将与对角线重合)。当两组完全分离时，即分布没有重叠，ROC曲线下的面积达到1(ROC曲线将达到左上角)</p><p id="fc5e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj"> F1得分</strong></p><p id="5f7e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">F1分数是精确度和召回率之间的调和平均值。F1分数的范围是[0，1]。它告诉您您的分类器有多精确(它正确分类了多少个实例)，以及它有多健壮(它不会遗漏大量实例)。高精度但低召回，给你一个非常准确的，但它错过了大量的实例，难以分类。F1分数越大，我们模型的性能越好。数学上，它可以表示为:</p><p id="4ed0" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">F1评分试图在精确度和召回率之间找到平衡。</p><p id="cff1" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">精度:它是正确的阳性结果数除以分类器预测的阳性结果数。</p><p id="6435" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">召回:正确阳性结果的数量除以所有相关样本的数量(所有应被鉴定为阳性的样本)。</p><p id="4041" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">恭喜你，你已经走了这么远。给自己一个鼓励。</p><p id="40e4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">在我开始讲模型之前，让我提醒你，这些模型是统计模型，但我不会去探究背后的数学。我将把这留给你去深入研究和理解它背后的数学。</p><p id="549d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">逻辑回归<br/> </strong>逻辑回归是一种分类算法，可以帮助我们预测给定的推文是否是种族主义的。<a class="ae kv" href="https://en.wikipedia.org/wiki/Logistic_regression" rel="noopener ugc nofollow" target="_blank">逻辑回归</a>预测截然不同。我们还可以查看模型分类下的概率得分。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/a1d4a5c954d248a10a288dbfa9dd3f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7i-9PfGPzw2Km-vkmvZIw.png"/></div></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">逻辑回归</figcaption></figure><p id="a461" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">逻辑回归使用逻辑sigmoid函数转换其输出，以返回一个概率值，然后可以将该概率值映射到两个或多个离散类。有3种类型的逻辑回归。二进制、多进制和序数。这是逻辑回归的度量评估。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/1d796b8d384b8ca7adebfc8aa7717b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*iNtORf0wf7TzBPSkRFpEiA.png"/></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/8878df5ba8f90d107e276cb355e2bb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*MOWltQzYEMGKvT9XNCEGSg.png"/></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">度量评估</figcaption></figure><p id="cbec" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">朴素贝叶斯</strong></p><p id="adf9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">朴素贝叶斯是一种基于<a class="ae kv" href="https://en.wikipedia.org/wiki/Bayes%27_theorem" rel="noopener ugc nofollow" target="_blank">贝叶斯定理</a>的分类技术，假设预测器之间是独立的。贝叶斯定理提供了一种方式，其中一个方程是描述统计量的条件概率的关系。在贝叶斯分类中，我们感兴趣的是在给定一些观察到的特征的情况下找到标签的概率。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/9f364622f6443139ebeac459961b9b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6I-0rOBK9FBBQ0sQCKnyPA.png"/></div></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">朴素贝叶斯模型实现</figcaption></figure><p id="f54e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">有三种类型的朴素贝叶斯模型。高斯、多项式和伯努利。高斯基本上用于分类问题，而多项式用于获得不同的计数。如果特征向量是二进制的，则使用伯努利。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/b09716f44990e8843fb71972287d892d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*5ydTDbw1g99wBwZah0HGCQ.png"/></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/ac2199e1f9d31dc2d208bd0e021ce38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*l_l4vV23w9L2j3dYR1djng.png"/></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">朴素贝叶斯度量评估</figcaption></figure><p id="0fa7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">Bernoulli在具有单词袋模型的文本分类中是有效的，其中1和0是“单词出现在文档中”和“单词不出现在文档中”。</p><p id="08d0" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">支持向量机</strong></p><p id="ea51" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Support-vector_machine" rel="noopener ugc nofollow" target="_blank"> SVM </a>是一种用于分类和回归问题的监督机器学习算法。在SVM，我们通过寻找能很好地区分两类的超平面来进行分类。内核技巧技术用于转换数据，然后根据数据在可能的输出之间找到最佳边界。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/07eaf95b47823fc8e9fe1f221857b12c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*sR48IKh0QpujjP0M7WLCaA.png"/></div></div></figure><p id="15b8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">可以使用超参数(如核、正则化、伽玛和余量)来优化SVM。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/e82dd9df7065ab6c4b4b397b19d0b9ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*JVRRGUyJwncnE9C7DQMbdw.png"/></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/1c3aa7ae44517b19f45ab0b16ef91af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*fM4n5omz9-cIij9GfRFDtQ.png"/></div></figure><p id="c382" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">SVM在清晰的分离边缘和高维空间中表现得非常好</p><p id="3144" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj">随机森林</strong></p><p id="d284" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Random_forest" rel="noopener ugc nofollow" target="_blank">随机森林</a>是一种监督学习算法。它既可以用于分类，也可以用于回归。这也是最灵活和最容易使用的算法。森林是由树木组成的。据说树越多，森林就越健壮。随机森林在随机选择的数据样本上创建决策树，从每棵树中获得一个预测，并通过投票的方式选择最佳解决方案。它还提供了一个很好的特性重要性指标。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/052cee8751535050d6b0461ca8febd0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6ZdGtY_XwW45XVrInV4qg.png"/></div></div></figure><p id="032b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">选择随机种子，其从训练数据集中随机抽取样本集合，同时保持类别分布。使用这个选定的数据集，可以根据用户定义的值从原始数据集中随机选择一组属性。由于巨大的计算量和很高的过拟合几率，所有的输入变量都不会被考虑。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/47d042917ef8103b40f8b8996b312b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*egRjc0BS9QVwls7tw5pbXQ.png"/></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/009b4f6b1f2b02346c3ad00e252c67e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*25ooc9xh08n2RYj_KM_MpQ.png"/></div></figure><p id="94e8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">在许多情况下，与简单的CART/CHAID或回归模型相比，随机森林给出了更准确的预测。这是因为它同时捕获几个输入变量的方差，并使大量的观察值参与预测。</p><p id="9a71" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated"><strong class="iw hj"> XGBoost </strong></p><p id="b4fb" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">有4个增强机器学习算法<br/> 1。<br/>梯度推进机(GBM)2。极限梯度助推机(<a class="ae kv" href="https://en.wikipedia.org/wiki/Gradient_boosting" rel="noopener ugc nofollow" target="_blank"> XGBM </a> ) <br/> 3。LightGBM <br/> 4。CatBoost</p><p id="449e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">Boosting就是这样一种使用集成学习概念的技术。boosting算法结合多个简单模型来生成最终输出。XGBoost的工作流程是将多个决策树的预测结合起来。梯度推进机器中的所有弱学习器都是决策树。XGBoost中的树是按顺序构建的，试图纠正前面树的错误。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/76b74c22ebd8e04c1a218520e627b290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*TM7_V94vK7YrEhdjj7F1Vg.png"/></div></figure><p id="5609" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">XGBoost在节点级实现并行预处理，这使得它比GBM更快。使用正则化技术XGBoost可以防止过度拟合，并提高整体性能。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es my"><img src="../Images/72362d4a47a453288d6009d430edd1a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*p_kJFoV_GfHecArsgCczEw.png"/></div></figure><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/b450e6ffd6e265c3ade2566fb3954299.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*3vQJoevvZSiEnCqD-YLAiQ.png"/></div></figure><p id="7ba7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">由于XGBoost是最好的机器学习模型之一，我们在处理超参数时需要小心。我们将按照下面的步骤来调整参数。</p><ol class=""><li id="38d0" class="kw kx hi iw b ix iy jb jc kd ky kh kz kl la jr lb lc ld le bi translated">选择相对较高的学习率。通常，在这个阶段使用0.3的学习率。</li><li id="e57e" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">调整特定于树的参数，如max_depth、min_child_weight、subsample、colsample_bytree，保持学习速率固定。</li><li id="c421" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">调整学习速度。</li><li id="c022" class="kw kx hi iw b ix lj jb lk kd ll kh lm kl ln jr lb lc ld le bi translated">最后，调整gamma以避免过度拟合。</li></ol><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/aea97d022082e138aa4722dcd4ff18d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YtqmtOujbWugIQLtYJkMUg.png"/></div></div></figure><p id="ae8b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">从上面的综合分析中，我们能够理解，相对于应用于我们模型的其他机器学习算法，XGBoost模型与我们的数据一起工作得非常好，提高了f1分数和准确性。</p><h1 id="c3ab" class="nb jt hi bd ju nc nd ne jy nf ng nh kc ni nj nk kg nl nm nn kk no np nq ko nr bi translated">结论</h1><p id="b8ac" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je kd ks jh ji kh kt jl jm kl ku jp jq jr hb bi translated">在这个项目中，我们使用多个训练模型来进行预测，并试图在我们的数据集上找到最合适的模型。在这个过程中，我们学习了NLTK和sci-kit-learn库中有用且易于使用的分析步骤和训练模型。使用不同的矢量器、TFIDF和计数矢量器，它将生成不同的结果。例如，我们可以通过TFIDF去除非常低或非常高频率的单词来改进模型。它将使预测模型过滤异常值，提高模型的准确性。</p><p id="8993" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">对Logistic回归、SVM、Random Forest、XGBoost等模型对提取的各种特征进行评价，分别是词袋、Word2Vec、Doc2Vec和TF_IDF。考虑到F1分数的评估指标，我们性能最好的模型是XGBoost，它对Word2Vec特性应用了经过调整的参数，F1分数为0.66。</p><p id="5b1b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je kd jg jh ji kh jk jl jm kl jo jp jq jr hb bi translated">就这样，我们在这个项目中学到了很多细节，涵盖了NLP和统计建模的主题。这里有一个<a class="ae kv" href="https://www.proprofs.com/quiz-school/story.php?title=mjcynzi3nwanez" rel="noopener ugc nofollow" target="_blank">小测验</a>来测试你自己通过这个博客学到了多少。希望你真的喜欢看这个博客。如果你喜欢这个博客，请给一些掌声，并与那些渴望获得一些伟大知识的人分享。</p></div></div>    
</body>
</html>