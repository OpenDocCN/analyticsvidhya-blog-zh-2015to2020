<html>
<head>
<title>A Study of the Hierarchical Clustering: Unsupervised Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">层次聚类研究:无监督机器学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-study-of-the-hierarchical-clustering-unsupervised-machine-learning-8d3bc172b60f?source=collection_archive---------7-----------------------#2020-09-25">https://medium.com/analytics-vidhya/a-study-of-the-hierarchical-clustering-unsupervised-machine-learning-8d3bc172b60f?source=collection_archive---------7-----------------------#2020-09-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/934fd23289dcbf6ad7815c96b394fc4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fVniO2FZsuP4wwfJXdpf5g.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:https://unsplash.com/photos/OgvqXGL7XO4</figcaption></figure><p id="813e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di">另一种流行的聚类方法是层次聚类。我在K-minus聚类中看到过，聚类的个数是需要陈述的。分层聚类不需要这样。呈现在我们眼前的是一些长长的队伍正在相互形成群体。在层次聚类中，这样的图称为树状图。稍后我们会知道这个树状图是什么。</span></p><blockquote class="kc kd ke"><p id="08f2" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">本文将讨论层次聚类的管道。让我们开始吧…</strong></p></blockquote><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/d4791eedf25a822943af434006611979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IsKdrY7g7yreVTqiFZfXzQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图1:层次聚类的类型</strong></figcaption></figure><p id="fed8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">层次聚类有两种类型，凝聚型和分裂型。详细解释和结果如下所示。</strong></p><blockquote class="kc kd ke"><p id="5aac" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">divisible:</strong>在这种方法中，完整的数据集被假设为单个聚类。然后，该聚类被不断分解，直到每个数据点都成为一个单独的聚类。它按照自上而下的方法工作。</p><p id="3bff" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">凝聚式:</strong>凝聚式是除法的完全相反，也叫自底向上法。在这种方法中，每个数据点最初都被视为一个单独的聚类。然后基于这些聚类的距离，用它们形成小聚类，从而这些小聚类再次形成大聚类。参见(图2)了解自上而下和自下而上方法的区别。</p></blockquote><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/d56ca663737f8ad69b11002e86d81bbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*Eqt_e7UnO0DAJ0oMTTde4w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图2:凝聚与分裂的方法|图片来源:</strong> <a class="ae iu" href="https://towardsdatascience.com/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019" rel="noopener" target="_blank"> <strong class="bd ko">走向数据科学</strong> </a></figcaption></figure><p id="3ba0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">凝聚聚类可以用几种方法来完成，举例来说，完全距离、单一距离、平均距离、质心链接和单词方法。让我们来看看对这种方法的解释:</strong></p><blockquote class="kc kd ke"><p id="6ab2" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">完整距离</strong> —根据最大或最长距离在数据点之间形成聚类。<br/> <strong class="ix hj">单一距离</strong> —根据数据点之间的最小或最短距离形成聚类。<br/> <strong class="ix hj">平均距离</strong> —根据数据点之间的最小或最短距离形成聚类。<br/> <strong class="ix hj">质心距离</strong> —根据聚类中心或质心距离形成聚类。<br/> <strong class="ix hj">字法</strong>——基于不同聚类内部的最小变体形成聚类组。</p></blockquote><p id="ad97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">分层聚类的实际应用:</p><ul class=""><li id="a9c0" class="kq kr hi ix b iy iz jc jd jg ks jk kt jo ku js kv kw kx ky bi translated">根据DNA序列对动物和植物进行分类。</li><li id="477c" class="kq kr hi ix b iy kz jc la jg lb jk lc jo ld js kv kw kx ky bi translated">各种病毒引起的流行病。</li></ul><p id="c4a7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们在Kaggle.com上找到的顶级批发数据上实现特殊聚类:<a class="ae iu" href="https://www.kaggle.com/binovi/wholesale-customers-data-set" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/binovi/wholesale-customers-data-set</a></p><p id="6ba9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">让我们导入基本库:</strong></p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="8896" class="lj lk hi lf b fi ll lm l ln lo">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import matplotlib.mlab as mlab<br/>import seaborn as sns<br/>from sklearn.preprocessing import normalize<br/>import scipy.cluster.hierarchy as shc<br/>from sklearn.cluster import AgglomerativeClustering</span></pre><p id="736f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">加载数据集</strong></p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="b9e0" class="lj lk hi lf b fi ll lm l ln lo">url='df1= pd.read_csv("C:/Users/elias/Desktop/Data/Dataset/wholesale.csv")<a class="ae iu" href="https://raw.githubusercontent.com/FazlyRabbiBD/Data-Science-Book/master/data-wholesale-customers.csv'" rel="noopener ugc nofollow" target="_blank">'</a><br/>df = pd.read_csv(url)<br/>df.head()</span></pre><p id="d7d0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了便于聚类，我们将归一化整个数据集。</p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="18e6" class="lj lk hi lf b fi ll lm l ln lo">data_scaled = normalize(df)<br/>data_scaled = pd.DataFrame(data_scaled, columns=df.columns)<br/>data_scaled.head()</span></pre><p id="b3db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">调用数据集后，您将看到如图3所示的图像:</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/c81fbe4dc87f65a0402fb68090ab858b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6XoUNctDzSU60rknXyQP3Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图3:缩放数据集</strong></figcaption></figure><p id="e70f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建归一化数据集的树状图将创建如图4所示的图形。我们用单词连锁法创建了这个树状图。如果我们愿意，我们可以用其他方式创建树状图。从该树状图可以理解，数据点首先形成小的聚类，然后这些小的聚类逐渐变成更大的聚类。</p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="d097" class="lj lk hi lf b fi ll lm l ln lo">plt.figure(figsize=(10, 7))  <br/>plt.title("Dendrograms using Ward")  <br/>dend = shc.dendrogram(shc.linkage(data_scaled, method='ward'))<br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/81e9a589357baff8336e447356a1aa6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*rsado4aUoDJtx9R_2bV8Ow.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图4:单词连锁法的树状图</strong></figcaption></figure><p id="f170" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">查看图4的树状图，我们可以看到较小的星团正在逐渐形成较大的星团。给出了X轴上的数据点和Y轴上的聚类距离。由蓝线形成的两个最大集群的最大距离是7(从那时起没有形成新的集群，并且距离没有增加)。为了便于我们理解，我们为这个距离画了一条线。让我们使用另一种完全连锁的方法来制作树状图:</p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="8887" class="lj lk hi lf b fi ll lm l ln lo">plt.figure(figsize=(10, 7))</span><span id="1352" class="lj lk hi lf b fi lr lm l ln lo">plt.title("Dendrograms using Complete")</span><span id="cbd2" class="lj lk hi lf b fi lr lm l ln lo">dend1 = shc.dendrogram(shc.linkage(data_scaled, method='complete'))</span><span id="6710" class="lj lk hi lf b fi lr lm l ln lo">plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/10a0fa16863e6f212a497b1b23e6c171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*vFjg2DpXD9opkm4bvTowwg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图5:使用完整</strong>的树状图</figcaption></figure><p id="6938" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用一个单一的链接来制作树状图:</p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="e38a" class="lj lk hi lf b fi ll lm l ln lo">plt.figure(figsize=(10, 7))</span><span id="90b7" class="lj lk hi lf b fi lr lm l ln lo">plt.title("Dendrograms using Single")</span><span id="407c" class="lj lk hi lf b fi lr lm l ln lo">dend2 = shc.dendrogram(shc.linkage(data_scaled, method='single'))</span><span id="09a6" class="lj lk hi lf b fi lr lm l ln lo">plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/2253f049c938ff54ad2e6d4fba3f5179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*ZE_VtZcNcBsPudzrGd086w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图6；使用单个</strong>的树状图</figcaption></figure><p id="ff62" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将使用平均值来计算:</p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="0f84" class="lj lk hi lf b fi ll lm l ln lo">plt.figure(figsize=(10, 7))</span><span id="f6d9" class="lj lk hi lf b fi lr lm l ln lo">plt.title("Dendrograms using Average")</span><span id="237f" class="lj lk hi lf b fi lr lm l ln lo">dend3 = shc.dendrogram(shc.linkage(data_scaled, method='average'))</span><span id="89b4" class="lj lk hi lf b fi lr lm l ln lo">plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/e0ca0b755eff1a042b7a2726a9082d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*6-a07z81rga7aNnYo05e1A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图7:使用平均值的树状图</strong></figcaption></figure><p id="49d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在将通过一个聚类的平均值来查看该组，以便我们了解在哪个聚类中平均销售哪种产品。</p><pre class="kk kl km kn fd le lf lg lh aw li bi"><span id="a861" class="lj lk hi lf b fi ll lm l ln lo">agg_wholwsales = df.groupby(['cluster_','Channel'])['Fresh','Milk','Grocery','Frozen','Detergents_Paper','Delicassen'].mean()<br/>agg_wholwsales</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/abe4dab90d0c425f93413d321ddf55c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F7dy3JJz6KBK3dYC7dASiA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ko">图8:销售产品报告</strong></figcaption></figure><p id="67c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di">到</span>总结，本文说明了层次聚类的管道和不同类型的树状图。分层聚类非常重要，本文通过在大规模数据集上实现它来展示这一点。本文用完全连锁法、单连锁法、平均连锁法和单词法等其他方法显示了树状图。</p><p id="8c92" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">参考资料:</p><ol class=""><li id="392b" class="kq kr hi ix b iy iz jc jd jg ks jk kt jo ku js lu kw kx ky bi translated"><a class="ae iu" href="https://towardsdatascience.com/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019" rel="noopener" target="_blank">https://towards data science . com/machine-learning-algorithms-part-12-hierarchical-agglomerate-clustering-example-in-python-1e 18 e 0075019</a></li><li id="64bb" class="kq kr hi ix b iy kz jc la jg lb jk lc jo ld js lu kw kx ky bi translated"><a class="ae iu" href="https://www.analyticsvidhya.com/blog/2019/05/beginners-guide-hierarchical-clustering/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2019/05/初学者-指南-分层-聚类/ </a></li><li id="e3aa" class="kq kr hi ix b iy kz jc la jg lb jk lc jo ld js lu kw kx ky bi translated"><a class="ae iu" href="https://towardsdatascience.com/hierarchical-clustering-in-python-using-dendrogram-and-cophenetic-correlation-8d41a08f7eab" rel="noopener" target="_blank">https://towards data science . com/hierarchical-clustering-in-python-using-dendrogram-and-cophenetic-correlation-8d 41 a 08 f 7 eab</a></li></ol><p id="ac4f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如果你</strong>想要找到我最近发表的文章，你可以在Researchgate或LinkedIn上关注我。</p><p id="714b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">研究之门:</strong><a class="ae iu" href="https://www.researchgate.net/profile/Elias_Hossain7" rel="noopener ugc nofollow" target="_blank">https://www.researchgate.net/profile/Elias_Hossain7</a></p><p id="2248" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">领英:</strong><a class="ae iu" href="https://www.linkedin.com/in/elias-hossain-b70678160/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/elias-hossain-b70678160/</a></p></div></div>    
</body>
</html>