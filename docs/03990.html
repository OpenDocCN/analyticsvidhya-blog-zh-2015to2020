<html>
<head>
<title>A new way to visualize complex Python objects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种可视化复杂Python对象的新方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-new-way-to-visualize-complex-python-objects-bbea595bb1c9?source=collection_archive---------7-----------------------#2020-02-29">https://medium.com/analytics-vidhya/a-new-way-to-visualize-complex-python-objects-bbea595bb1c9?source=collection_archive---------7-----------------------#2020-02-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4b246eca5087b0c71a4a4fab816b0af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQWwXSpODQGW4i3oe_DIXA.png"/></div></div></figure><p id="9adb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我工作的这种快节奏的创业公司，每天都有新的挑战摆在你面前。而在这一条上(宿命？)一天，我在哥伦比亚寻找公共汽车路线。这是来自提供地理数据的<a class="ae jo" href="https://transit.land/api/v1/routes.geojson?operated_by=o-d2g6-transmilenio~alimentadores&amp;per_page=false" rel="noopener ugc nofollow" target="_blank">网站</a>的截图。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/616887d2f31c79a438fda0785e645513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2hUBcxfJtcpGqXDO"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">如果你试着去读的话。</figcaption></figure><p id="693b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我想把这些数据转换成GeoJSON。一个<strong class="is hj"> GeoJSON </strong>只是一个标准化的JSON格式，用来表示地理特征及其非空间属性(例如<em class="jy"> operated_by_name </em>和<em class="jy"> vehicle_type </em>)。</p><p id="ecf2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了将上面截图中的地理数据转换成GeoJSON格式，我需要理解地理数据本身的结构。如果我开始阅读这篇文章，我将需要一副新眼镜。</p><p id="5d40" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">于是我求助于<strong class="is hj"> Python </strong>。我决定，<em class="jy">“让我们将Python上的数据作为JSON读取，然后使用内置的</em> <code class="du jz ka kb kc b"><em class="jy">pprint</em></code> <em class="jy">方法来显示JSON。当然，这种结构会很容易被看到，对吗？”</em></p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/c51cb22aefcf3fbbf2d1131be9001cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xB0qPm5cVamuDuUH"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">不对。</figcaption></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/415809cd5d48bd3122f11f07c10aeab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aD7Xf3kRSGTNPoFH"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">还是不对。</figcaption></figure><p id="b759" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这篇JSON极其冗长，漂亮的印刷让我无法对那里的地理数据结构有所了解。其他选项是<code class="du jz ka kb kc b">json.dumps()</code>或<code class="du jz ka kb kc b">yaml.dump()</code>该对象，它们也不是很容易理解，因为它包含的路线数据，一长串的纬度和经度，当显示时会使浏览该结构变得困难。</p><p id="6d43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，我决定用老办法。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="023e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我拿出笔记本，费力地找出JSON的模式，匹配括号和缩进。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/708b0335e4e72228ab288bbb2058f69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OTBpf-uYtmUR98wr"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">请注意我的文字是如何在一个点之后逐渐消失的</figcaption></figure><p id="7d8a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我已经习惯了使用<code class="du jz ka kb kc b">printSchema()</code>函数在Spark中打印复杂数据帧的模式，所以我对Python没有提供这种支持感到有点失望。</p><p id="8fe5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我做了任何工程师都会做的事:</p><blockquote class="kg"><p id="5c7d" class="kh ki hi bd kj kk kl km kn ko kp jn dx translated">编写<a class="ae jo" href="https://github.com/suryashekharc/print_schema" rel="noopener ugc nofollow" target="_blank">代码</a>来打印模式。</p></blockquote><p id="95de" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">我编写了一个非常通用的代码，可以处理大多数常见的Python对象——字典、JSONs和列表。程序将递归打印对象的结构，尽可能地输出细节。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/4493898e7e386025c4a6417c52272791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0ibUCu0NWdpSmNwd"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">好多了，是吗？</figcaption></figure><p id="506d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这种打印模式的方式有很多优点。</p><p id="626a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，如果我想知道地理数据中有多少条公交路线，我可以查看<em class="jy">“features”</em>列表的计数，在本例中是95条。如果我想知道字典“<em class="jy"> geometry </em>包含什么，我知道它有键“<em class="jy"> type </em>”和“<em class="jy"> coordinates </em>”，它们的值分别是string和list。我还启用了一些特性，比如选择每一级的缩进，如果您想要一个模式有连续的垂直线。</p><p id="8a7a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我已经将所有这些代码签入了GitHub，但是现在我变得雄心勃勃。</p><blockquote class="kg"><p id="c427" class="kh ki hi bd kj kk kl km kn ko kp jn dx translated">我想把这个项目部署到PyPI，这样你也可以下载这个包，并把它作为pprint的替代品(如果你愿意，没有压力)。</p></blockquote><p id="2a7c" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">我遵循了RealPython上的这个<a class="ae jo" href="https://realpython.com/pypi-publish-python-package/" rel="noopener ugc nofollow" target="_blank">指南</a>关于如何发布一个包到PyPI。我在PyPI上发布了1.0.0版本，我甚至可以从其他机器上下载。感觉几乎…太容易了。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/1ac32e1df2a1ca188cad6b667127e242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IXJTIbI0wZqEfnBf"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">JSONOFABITCH</figcaption></figure><p id="a308" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我的预感是对的。即使我可以下载它，它也不能在其他机器上正常工作。导入语句不正确(<em class="jy">模块不可调用</em>)，我在Python2上遇到了有趣的错误，PyPI页面没有接收到readme markdown文件。Github曾经神奇地读取markdown文件，但是为什么PyPI不够聪明？</p><p id="c152" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一天下班后，我和我的同事普内特坐在一起，我们一起开始调试问题。原来，还有一些事情要做。PyPI要求setup.py文件提到一个<code class="du jz ka kb kc b">long_description</code>(我们决定<a class="ae jo" href="https://github.com/suryashekharc/print_schema/blob/master/setup.py" rel="noopener ugc nofollow" target="_blank">从readme文件</a>中动态读取)。并且，为了启用正确的导入级别，我们对init文件做了<a class="ae jo" href="https://github.com/suryashekharc/print_schema/blob/master/print_schema/__init__.py" rel="noopener ugc nofollow" target="_blank">这个更改</a>。</p><p id="d8ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另外，我的代码需要Python3(我在Python2不支持的代码中使用了花哨的类型提示)，所以我在<a class="ae jo" href="https://github.com/suryashekharc/print_schema/blob/master/setup.py" rel="noopener ugc nofollow" target="_blank"> setup.py </a>中添加了<code class="du jz ka kb kc b">python_requires</code>字段。我们将整个装置放在<strong class="is hj"> test.pypi </strong>上，这是一个沙箱，允许你在将包部署到pypi之前对其进行测试。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/2ac41f4706f40e7a080565443cc5ea40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4Hupwzku7s22WKcD"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">看起来我们都准备好了！</figcaption></figure><p id="f7e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PyPI不允许你上传同一个版本的包两次，所以我们推出了新的(和功能！)<code class="du jz ka kb kc b">print-schema version 1.0.2</code>。我对PyPI的第一个贡献现在还活着！</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/8ef86dfdcf3aad4fa726110d4f551672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qq0mbKAGkP6Wb5qu"/></div></div></figure><p id="4dc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我鼓励你用<code class="du jz ka kb kc b">pip install print-schema</code>下载。这里有<a class="ae jo" href="https://github.com/suryashekharc/print_schema" rel="noopener ugc nofollow" target="_blank"> Github链接</a>和<a class="ae jo" href="https://pypi.org/project/print-schema/" rel="noopener ugc nofollow" target="_blank"> PyPI链接</a>。</p><p id="8123" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一定要让我知道你对它的看法！</p></div></div>    
</body>
</html>