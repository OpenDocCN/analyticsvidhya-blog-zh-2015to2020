<html>
<head>
<title>Application of Machine Learning to Life Science(Biology) — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习在生命科学(生物学)中的应用(1)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/application-of-machine-learning-to-life-science-biology-part-1-76924b6c3fa3?source=collection_archive---------17-----------------------#2020-06-21">https://medium.com/analytics-vidhya/application-of-machine-learning-to-life-science-biology-part-1-76924b6c3fa3?source=collection_archive---------17-----------------------#2020-06-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="d73b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">动物基因组相似性的度量</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ae8945ce921c964a4cc6614726868344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5LCOlaxLHWIhC3N6gIO9Jg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图一。来源:<a class="ae jt" href="https://upload.wikimedia.org/wikipedia/commons/a/ac/Aphids_%284575792195%29.jpg" rel="noopener ugc nofollow" target="_blank">https://upload . wikimedia . org/Wikipedia/commons/a/AC/蚜虫_%284575792195%29.jpg </a></figcaption></figure><p id="03b2" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在这篇博客中，我们将看到如何比较不同动物的基因组。为了简单起见，我们将使用可获得的部分基因组序列<a class="ae jt" href="https://drive.google.com/file/d/1mJpltSs1negIBkzFSWYHcF8MyvnnAbrx/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>，而不是研究动物的全基因组序列。</p><h1 id="2cee" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">系列介绍</h1><p id="e7a0" class="pw-post-body-paragraph ju jv hi jw b jx ks jz ka kb kt kd ke kf ku kh ki kj kv kl km kn kw kp kq kr hb bi translated">这是“机器学习在生命科学(生物学)中的应用”的第一个系列。这一系列博客旨在让人们对机器学习技术在生物数据中的应用有一个清晰的认识。</p><h1 id="1326" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">该系列的范围</h1><p id="8e6f" class="pw-post-body-paragraph ju jv hi jw b jx ks jz ka kb kt kd ke kf ku kh ki kj kv kl km kn kw kp kq kr hb bi translated">本系列的目的不是提供生命科学或机器学习领域的压缩指南。相反，它的目的是给出一个关于如何将机器学习应用于一些公开可用数据集的介绍性概述。博客使用的所有代码都在<a class="ae jt" href="https://github.com/mitiku1/ml4compbio" rel="noopener ugc nofollow" target="_blank"> git库</a>中。</p><h1 id="58ce" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">先决条件</h1><p id="c2ec" class="pw-post-body-paragraph ju jv hi jw b jx ks jz ka kb kt kd ke kf ku kh ki kj kv kl km kn kw kp kq kr hb bi translated">假设读者对机器学习和python编程语言有基本的了解。此外，假定读者在遗传学、基因组测序、DNA、蛋白质合成和相关主题领域具有中等水平的生命科学知识。</p><h1 id="fdd5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">第1部分简介</h1><p id="c5b0" class="pw-post-body-paragraph ju jv hi jw b jx ks jz ka kb kt kd ke kf ku kh ki kj kv kl km kn kw kp kq kr hb bi translated">在这篇博客中，我们将看到如何比较八种动物(人类、黑猩猩、小鼠、大鼠、狗、牛、犰狳和大象)的基因组。为了简单起见，我们将使用可用的部分基因组序列<a class="ae jt" href="https://drive.google.com/file/d/1mJpltSs1negIBkzFSWYHcF8MyvnnAbrx/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">在这里</a>，而不是研究动物的整个基因组序列。该数据集用于AIMS-AMMI计算生物学课程。</p><p id="9961" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我们使用的数据集是<a class="ae jt" href="https://en.wikipedia.org/wiki/FASTA_format" rel="noopener ugc nofollow" target="_blank"> <strong class="jw hj"> FASTA </strong> </a>格式。它是多序列FASTA格式。每个基因组序列以一行开始，该行以'&gt;'(大于符号)开始，它指示下一行的基因组序列。</p><p id="61db" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">以下python函数可用于加载FASTA格式的文件。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="de8d" class="lc ig hi ky b fi ld le l lf lg">def read_fasta_file(path):<br/>    """<br/>    Gets genome sequence saved in a file with FASTA format. It is assumed that file is in the following format.</span><span id="2b1a" class="lc ig hi ky b fi lh le l lf lg">    &gt;SEQUENCE_1</span><span id="0f93" class="lc ig hi ky b fi lh le l lf lg">    MTEITAAMVKELRESTGAGMMDCKNALSETNGDFDKAVQLLREKGLGKAAKKADRLAAEG</span><span id="5090" class="lc ig hi ky b fi lh le l lf lg">    LVSVKVSDDFTIAAMRPSYLSYEDLDMTFVENEYKALVAELEKENEERRRLKDPNKPEHK</span><span id="9105" class="lc ig hi ky b fi lh le l lf lg">    IPQFASRKQLSDAILKEAEEKIKEELKAQGKPEKIWDNIIPGKMNSFIADNSQLDSKLTL</span><span id="a791" class="lc ig hi ky b fi lh le l lf lg">    MGQFYVMDDKKTVEQVIAEKEKEFGGKIKIVEFICFEVGEGLEKKTEDFAAEVAAQL</span><span id="3d31" class="lc ig hi ky b fi lh le l lf lg">    &gt;SEQUENCE_2</span><span id="74e1" class="lc ig hi ky b fi lh le l lf lg">    SATVSEINSETDFVAKNDQFIALTKDTTAHIQSNSLQSVEELHSSTINGVKFEEYLKSQI</span><span id="caa4" class="lc ig hi ky b fi lh le l lf lg">    ATIGENLVVRRFATLKAGANGVVNGYIHTNGRVGVVIAAACDSAEVASKSRDLLRQICMH</span><span id="bdea" class="lc ig hi ky b fi lh le l lf lg">    <br/>    Paramters</span><span id="e82c" class="lc ig hi ky b fi lh le l lf lg">    ---------</span><span id="5fc8" class="lc ig hi ky b fi lh le l lf lg">    Path : str</span><span id="da4e" class="lc ig hi ky b fi lh le l lf lg">    Path to file containing genome sequence.</span><span id="c28b" class="lc ig hi ky b fi lh le l lf lg">    Returns</span><span id="2b92" class="lc ig hi ky b fi lh le l lf lg">    ------- </span><span id="8018" class="lc ig hi ky b fi lh le l lf lg">    dict</span><span id="4114" class="lc ig hi ky b fi lh le l lf lg">    A key-value pair where the keys are sequence names and values are genome sequences</span><span id="40e8" class="lc ig hi ky b fi lh le l lf lg">    """</span><span id="0980" class="lc ig hi ky b fi lh le l lf lg">    with open(path) as data_file:</span><span id="3698" class="lc ig hi ky b fi lh le l lf lg">        output = {}</span><span id="6de7" class="lc ig hi ky b fi lh le l lf lg">        sequence_name = None</span><span id="dce4" class="lc ig hi ky b fi lh le l lf lg">        for line in data_file.readlines():</span><span id="6c81" class="lc ig hi ky b fi lh le l lf lg">            if line.startswith("&gt;"):</span><span id="e450" class="lc ig hi ky b fi lh le l lf lg">                sequence_name = line[1:].strip()</span><span id="fa2a" class="lc ig hi ky b fi lh le l lf lg">            else:</span><span id="4f58" class="lc ig hi ky b fi lh le l lf lg">                output.setdefault(sequence_name, "")</span><span id="74b0" class="lc ig hi ky b fi lh le l lf lg">                line = "".join(re.findall("[acgtACGT]+", line)<br/>                output[sequence_name]+=line.upper()</span><span id="612c" class="lc ig hi ky b fi lh le l lf lg">        return output</span></pre><h1 id="c908" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">使用KMer特征构建序列表示</h1><p id="4128" class="pw-post-body-paragraph ju jv hi jw b jx ks jz ka kb kt kd ke kf ku kh ki kj kv kl km kn kw kp kq kr hb bi translated">维基百科对k-mer的定义是</p><blockquote class="li lj lk"><p id="c471" class="ju jv ll jw b jx jy jz ka kb kc kd ke lm kg kh ki ln kk kl km lo ko kp kq kr hb bi translated">在生物信息学中，<strong class="jw hj"> <em class="hi"> k </em> -mers </strong>是生物序列中包含的长度为k的子序列。</p></blockquote><p id="dfc1" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">Kmer方法对于生物序列的分析是有用的。它在某种程度上与DNA的转录有关。密码子是3聚体，滑动窗口大小为3，步距为3，而正常的3聚体步距为1。</p><h1 id="e92b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">例如:k-mers<a class="ae jt" href="https://en.wikipedia.org/wiki/K-mer" rel="noopener ugc nofollow" target="_blank"><strong class="ak">GTAGAGCTGT</strong></a></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/f2b59791a311ef3008bbb31c0c9468c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*7GIfk1bikx4UUtn_ekQP-g.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图2:来源<a class="ae jt" href="https://en.wikipedia.org/wiki/K-mer" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/K-mer</a></figcaption></figure><p id="1285" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">以下python脚本可用于将序列转换为给定k的kmers。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="4e5b" class="lc ig hi ky b fi ld le l lf lg">def get_kmers(seq, k):</span><span id="1bd9" class="lc ig hi ky b fi lh le l lf lg">    """</span><span id="45d1" class="lc ig hi ky b fi lh le l lf lg">    Gets kmers for the given sequence.</span><span id="3288" class="lc ig hi ky b fi lh le l lf lg">    Parameters</span><span id="9664" class="lc ig hi ky b fi lh le l lf lg">    ----------</span><span id="f6b1" class="lc ig hi ky b fi lh le l lf lg">    seq : str</span><span id="c2e6" class="lc ig hi ky b fi lh le l lf lg">         Genomic sequence</span><span id="c824" class="lc ig hi ky b fi lh le l lf lg">    k : int</span><span id="6b9a" class="lc ig hi ky b fi lh le l lf lg">         Length of the kmers to return</span><span id="b0df" class="lc ig hi ky b fi lh le l lf lg">    Returns</span><span id="cf1f" class="lc ig hi ky b fi lh le l lf lg">    -------</span><span id="2a1c" class="lc ig hi ky b fi lh le l lf lg">   list</span><span id="fe1e" class="lc ig hi ky b fi lh le l lf lg">       List of kmers of length k.</span><span id="4bfb" class="lc ig hi ky b fi lh le l lf lg">    """<br/>    <br/>    return [seq[i:i+k] for i in range(len(seq)-k+1)]</span></pre><p id="065e" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">一旦为每个序列提取了kmer列表，接下来就可以创建kmer词汇表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/fa4739991d689a6c8365967c2e28866e.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*Xf71ZowiHPnIK9VFzA2BwA.png"/></div></figure><p id="15dc" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">现在让我们用整数来索引词汇表中的所有kmers。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/2a246b843c848731f160c1c9a9b25881.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*Dn4rg4RObpZcBm7AEHvxcg.png"/></div></figure><p id="ec1c" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">因为我们能够索引kmer，所以我们可以通过索引来访问和表示每个kmer。有了这些信息，我们可以为每个序列建立向量表示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ls"><img src="../Images/dc97de234c1c942f571a675897693cdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*oOWHsWlz0_B8HavGhOZ2oA.png"/></div></figure><p id="8d6c" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">以下python函数可用于构建序列的矢量表示。结果是一个形状为<code class="du lt lu lv ky b">(s,m)</code>的矩阵，其中<code class="du lt lu lv ky b">s</code>是序列的数量，<code class="du lt lu lv ky b">m</code>是词汇的大小</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="f88c" class="lc ig hi ky b fi ld le l lf lg">def get_sequences_kmers_counts(sequences, k, index2animal):<br/>    kmers_counts =[]</span><span id="99b8" class="lc ig hi ky b fi lh le l lf lg">    kmers_vocabulary = set()</span><span id="7002" class="lc ig hi ky b fi lh le l lf lg">    for i in range(len(index2animal)):</span><span id="922b" class="lc ig hi ky b fi lh le l lf lg">        seq_kmers = get_kmers(sequences[index2animal[i]], k)</span><span id="edce" class="lc ig hi ky b fi lh le l lf lg">        kmers_counts.append(Counter(seq_kmers))</span><span id="da87" class="lc ig hi ky b fi lh le l lf lg">        kmers_vocabulary.update(seq_kmers)</span><span id="e295" class="lc ig hi ky b fi lh le l lf lg">    return kmers_counts, kmers_vocabulary</span><span id="f6b8" class="lc ig hi ky b fi lh le l lf lg">def build_vector_representation(sequences, k):</span><span id="8fad" class="lc ig hi ky b fi lh le l lf lg">    animals = list(sequences.keys())</span><span id="ab3b" class="lc ig hi ky b fi lh le l lf lg">    index2animal = {i:animals[i] for i in range(len(animals))}</span><span id="dcbb" class="lc ig hi ky b fi lh le l lf lg">    kmers_counts, kmers_vocabulary =   get_sequences_kmers_counts(sequences, k, index2animal) <br/>    indexed_voc = list(kmers_vocabulary)</span><span id="3a60" class="lc ig hi ky b fi lh le l lf lg">    kmer2index = {indexed_voc[i]:i for i in range(len(indexed_voc))}</span><span id="d99f" class="lc ig hi ky b fi lh le l lf lg">    representation = np.zeros((len(sequences), len(indexed_voc)))<br/>    for i in range(len(sequences)):</span><span id="e886" class="lc ig hi ky b fi lh le l lf lg">        seq_kmer_counts = kmers_counts[i]</span><span id="16f8" class="lc ig hi ky b fi lh le l lf lg">        for kmer in seq_kmer_counts:</span><span id="29e4" class="lc ig hi ky b fi lh le l lf lg">            representation[i][kmer2index[kmer]] = seq_kmer_counts[kmer]</span><span id="f41a" class="lc ig hi ky b fi lh le l lf lg">    return representation, index2animal</span></pre><p id="ea95" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">下图显示了通过上述方法创建的嵌入的3D投影。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/671c01cb8a316b9de5b8fc2bffa312e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rXJhZ6JrFgWKLaaM7pizSA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图三。低维空间中基因组序列表示的可视化。</figcaption></figure><p id="fcf7" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">这个也可以在线查看<a class="ae jt" href="https://projector.tensorflow.org/?config=https://gist.githubusercontent.com/mitiku1/85bb27d1d4cb2856a4db36f015229b3e/raw/c7b0aa42f0e639c4ee1e193870a998afbb7947c2/animal_genome.config" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div></div>    
</body>
</html>