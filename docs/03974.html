<html>
<head>
<title>Swap space &amp; RAM memory extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">交换空间和RAM内存扩展</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/swap-space-ram-memory-extension-c7d371bdc2f0?source=collection_archive---------10-----------------------#2020-02-28">https://medium.com/analytics-vidhya/swap-space-ram-memory-extension-c7d371bdc2f0?source=collection_archive---------10-----------------------#2020-02-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a53c6d885af33e4fae2761a10d6d35c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eS85ulVXzdG5FDgSwGgsRw.jpeg"/></div></div></figure><p id="33ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated">你有没有遇到过这个python错误:</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jx"><img src="../Images/01163b8b7785d14da6891cb918c1d791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miYOUmj0ISCMEZixi_y_3A.png"/></div></div></figure><p id="90ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太棒了。你来对地方了。</p><p id="1330" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当你不知道如何在其他地方运行你的脚本时，这可能是一个真正的问题。幸运的是，有些解决方案很容易应用:</p><ul class=""><li id="ee64" class="kc kd hi is b it iu ix iy jb ke jf kf jj kg jn kh ki kj kk bi translated">买一台更大的机器:(如果你有更多的钱花，如果你不在当地的电脑限制)；</li><li id="ca48" class="kc kd hi is b it kl ix km jb kn jf ko jj kp jn kh ki kj kk bi translated">代码优化:这包括为您的流程使用正确的python对象和大小，尽可能重用python变量或尝试释放内存中的变量。</li></ul><p id="e06b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果所有这些技术都不能解决问题，我们可以尝试最后一种:e <strong class="is hj">扩展RAM内存大小</strong>。</p><p id="b38b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">是的，主流操作系统提供了永久或不永久扩展内存使用的可能性，这种技术就是调用交换。</p><h2 id="2261" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated"><strong class="ak"> 1。什么是swap？</strong></h2><p id="d4b7" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">交换内存是计算机硬盘中的一个空间，操作系统将使用它来存放实际在RAM中的信息，以便为另一个应用程序释放它。当系统需要更多的内存来运行一个新的进程而又没有内存时，就应该这样做，所以我们可以看到，如果我们的系统有足够的内存，它可能就不需要交换内存了。物理内存和交换空间的组合大小就是可用的虚拟内存量。</p><p id="8dc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Linux有两种形式的交换空间:<strong class="is hj">交换分区</strong>和<strong class="is hj">交换文件</strong>。交换分区是硬盘的一个独立部分，专门用于交换；没有其他文件可以驻留在那里。交换文件是文件系统中的一个特殊文件，位于系统和数据文件之间。</p><p id="5693" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个故事中，我们将关注交换文件。</p><h2 id="1ce1" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated"><strong class="ak"> 2。如何激活交换</strong></h2><p id="430b" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">在这个例子中，我们将重点关注<a class="ae lq" href="https://aws.amazon.com/fr/ec2/pricing/on-demand/" rel="noopener ugc nofollow" target="_blank">亚马逊EC2 </a>计算机器。交换文件的主要优点是，您不需要找到一个空分区或磁盘的重新分区来添加额外的交换空间。</p><p id="eb9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了完成这个任务，我们首先需要运行这个命令</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/35453fb0b4e2d5f2cf58bb2347a976b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlP0C_IjZ1ixwibfkZ6eEw.png"/></div></div></figure><p id="80f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该命令创建一个10GB交换文件。详细来说:</p><ul class=""><li id="25cc" class="kc kd hi is b it iu ix iy jb ke jf kf jj kg jn kh ki kj kk bi translated"><strong class="is hj"> /bin/dd </strong>:创建了一个空文件；</li><li id="dfa5" class="kc kd hi is b it kl ix km jb kn jf ko jj kp jn kh ki kj kk bi translated"><strong class="is hj"> if=/dev/zero </strong>:指输入文件；</li><li id="1717" class="kc kd hi is b it kl ix km jb kn jf ko jj kp jn kh ki kj kk bi translated"><strong class="is hj"> of=/var/swapfile </strong>:创建输出文件名swapfile。它将是我们交换文件的名称；</li><li id="663a" class="kc kd hi is b it kl ix km jb kn jf ko jj kp jn kh ki kj kk bi translated"><strong class="is hj"> bs </strong>是块大小。我们将其设置为1兆字节；</li><li id="4b81" class="kc kd hi is b it kl ix km jb kn jf ko jj kp jn kh ki kj kk bi translated"><strong class="is hj">计数</strong>是指我们想要的块数。</li></ul><p id="7c62" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">交换文件大小是通过计算计数值和块大小的乘积获得的(1M x 10240 = 10 GB)。</p><p id="1a39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您需要超过10GB，那么将count变量更改为更高的值。如果运行此命令时出现错误，请首先运行</p><pre class="jy jz ka kb fd ls lt lu lv aw lw bi"><span id="bf61" class="kq kr hi lt b fi lx ly l lz ma">sudo mount /dev/xvda2 /mnt</span></pre><p id="900c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是使用mkswap准备交换文件，就像准备分区一样，并给予chmod权限。我们将使用chmod 600文件(读写)权限。与分区类似，使用swapon命令挂载它。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/7bee1914caba546515665b24cd36f766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LmBwF6vSAOmb_AjTBB-xQ.png"/></div></div></figure><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/1818d3b1a916d3c5e558a96f1841ca2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UJYfaOUAtgqoUtd0rfxRQ.png"/></div></div></figure><p id="93c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们将在/etc/fstab目录中添加一个新行。要做到这一点:打开/etc/fstab，添加这一行并重新启动您的机器。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/f30708539f7ae0e0424c21ff3cb6b601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*72O6Wu1MO652eAy-clrFHQ.png"/></div></div></figure><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/a6d6f4e39b68e853a72707d772ac4f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zm-JhOAuRKXT8BbV6gQEcQ.png"/></div></div></figure><p id="9f96" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">重新启动后，我们可以通过键入以下命令来检查交换是否处于活动状态:</p><pre class="jy jz ka kb fd ls lt lu lv aw lw bi"><span id="f326" class="kq kr hi lt b fi lx ly l lz ma">free -m </span></pre><p id="484a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者对于EC2实例</p><pre class="jy jz ka kb fd ls lt lu lv aw lw bi"><span id="a54f" class="kq kr hi lt b fi lx ly l lz ma">cat /proc/meminfo</span></pre><p id="3d2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">仅此而已。你赢得了10GB的内存，而没有支付任何额外的费用。</p><h2 id="81ad" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">阅读更多:我的交换空间应该有多大？</h2><p id="fdad" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">我们在这个故事中发现，在大量内存使用的情况下，可以扩展物理内存来避免系统崩溃。但主要问题是我们应该分配多少空间？</p><p id="2850" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据<strong class="is hj"> </strong> <a class="ae lq" href="https://itsfoss.com/swap-size/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> itsfoss </strong> </a>网站，我们可以使用这个表格。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/eb4150c2691f12206756dcab5c9528e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lCeQvlO3g7b3gYuUOiEzhw.png"/></div></div></figure><p id="f19b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该表简要概述了如何根据物理内存大小定义交换文件的大小。这表明了RAM大小和相应的交换分配大小之间的关系。</p><h2 id="9c22" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated"><strong class="ak">结论</strong></h2><p id="a668" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">如果您遇到内存错误，您可能需要通过在其他内存中添加交换内存文件来扩展物理内存，从而解决问题。如果在所有这些技术之后，问题仍然是一样的，你肯定需要一个计算能力更强的机器。</p><h2 id="99e4" class="kq kr hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">不要做数据等待，开始编码！</h2></div></div>    
</body>
</html>