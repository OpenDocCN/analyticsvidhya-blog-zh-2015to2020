<html>
<head>
<title>Code Walkthrough in An anonymous Machine Learning Hiring Hackathon-Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">匿名机器学习招聘黑客马拉松中的代码演练-第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/code-walkthrough-in-an-anonymous-machine-learning-hiring-hackathon-82a9b3f99e1d?source=collection_archive---------9-----------------------#2020-11-10">https://medium.com/analytics-vidhya/code-walkthrough-in-an-anonymous-machine-learning-hiring-hackathon-82a9b3f99e1d?source=collection_archive---------9-----------------------#2020-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7369" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是我参与的一个机器学习招聘黑客马拉松的代码演练；然而，我没有被选中。这是一次有趣的经历，我希望我在这个过程中学到了一些新的东西，我也希望读者能从中学到一些东西。这是<strong class="ih hj">匿名</strong>因为我会尽我最大的努力对组织的身份保密，这样有助于学习，同时也不会影响组织。如果它成功地实现了我的愿望，我会试着写更多这样的文章。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7842d74e906a2967f36658cfb14deb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dwzD4nSclN7niVbyBmkPZA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片来自Unsplash</figcaption></figure><p id="7e76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该演练包括关于<strong class="ih hj">问题陈述</strong>、<strong class="ih hj">数据集</strong>和<strong class="ih hj">的信息，以及代码和我解决问题的方法</strong>(数据预处理、模型构建和截止微调)。</p><h2 id="cad1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated"><strong class="ak">问题陈述</strong></h2><p id="e54e" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">提供数据集的组织拥有其产品和销售这些产品的销售团队。销售部门的经理雇用申请人并对他们进行一段时间的培训，这取决于他们在试用期的表现；他们被雇用或被解雇。招聘和培训申请人是一个成本高昂的过程，因此该组织转向数据科学来帮助他们找到可能的申请人。</p><h2 id="ec5f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated"><strong class="ak">数据集</strong></h2><p id="e099" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">该数据集包含有关申请人及其经理的各种信息，以及他们是否被雇用。大多数列名都是不言自明的，但下面仍然是数据集中的列列表以及它们的含义。</p><p id="2d16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ID </strong>:申请人的唯一ID</p><p id="4307" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Office_PIN </strong>:办公室的PIN码</p><p id="5767" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">申请_接收_日期</strong>:收到申请人申请的日期</p><p id="37e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">申请人城市密码</strong>:申请人城市密码</p><p id="9213" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">申请人_性别:申请人性别</p><p id="43c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">申请人_出生日期</strong>:申请人的出生日期</p><p id="8dfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">申请人_婚姻状况</strong>:申请人的婚姻状况</p><p id="98a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">申请人_职业</strong>:申请人申请前的职业</p><p id="7a9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">申请人_资格</strong>:申请人资格</p><p id="db15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理_DOJ </strong>:经理入职日期</p><p id="f927" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">管理者_加入_指定</strong>:管理者的加入指定</p><p id="5c67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理当前职务</strong>:经理当前职务</p><p id="d24f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理级别</strong>:经理级别</p><p id="526a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理状态</strong>:经理状态(已确认或试用)</p><p id="87b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理_性别</strong>:经理的性别</p><p id="fb5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理_出生日期</strong>:经理的出生日期</p><p id="b986" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理数量申请</strong>:经理收到的申请数量</p><p id="270d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理_编号_编码</strong>:(不记得了)😅</p><p id="fc4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Manager_Business </strong>:申请人在Manager下销售初级产品的总成本。</p><p id="318b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Manager_Num_Products </strong>:申请人在Manager下销售的初级产品数量</p><p id="4bd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Manager_Business2 </strong>:申请人在经理管理下销售的次级产品的总成本。</p><p id="3894" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Manager_Num_Products2 </strong>:申请人在经理领导下销售的次级产品数量</p><p id="26e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Business_Sourced </strong>:试用期结束后，申请人是否被录用。</p><p id="8595" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来的部分看<strong class="ih hj">导入数据</strong>、<strong class="ih hj">库</strong>、<strong class="ih hj">数据预处理</strong>和<strong class="ih hj">训练ML模型</strong>和<strong class="ih hj"> Auto-ML模型</strong>。</p><h2 id="f4cd" class="jt ju hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated"><strong class="ak">进口</strong></h2><ol class=""><li id="fecc" class="kt ku hi ih b ii ko im kp iq kv iu kw iy kx jc ky kz la lb bi translated">导入库</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lc"><img src="../Images/2c48e94afb4e93f85e424e528bd77005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*E1J5IzCRIl_BmL3LjRCt1g.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Raghuvansh导入库</figcaption></figure><p id="d029" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将数据(训练和测试)导入Pandas数据框架，将它们合并成一个名为“数据”的数据框架。在组合称为“Split”的列之前，该列被添加到训练和测试数据帧中以区分两个数据帧的行，然后删除训练和测试数据帧以减少内存消耗。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/70f32ce88ac405aad6da560db62977df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8lDys1HKLJGLOUfvdlnEQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">通过Raghuvansh导入数据</figcaption></figure><h2 id="7b03" class="jt ju hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated">数据预处理</h2><ol class=""><li id="9c07" class="kt ku hi ih b ii ko im kp iq kv iu kw iy kx jc ky kz la lb bi translated">检查空值并检查数据的统计。</li></ol><div class="je jf jg jh fd ab cb"><figure class="le ji lf lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/d6893adcababb4e289eb663dff26aa93.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*SxPk5-sWJoXxkfGPZkqOnQ.png"/></div></figure><figure class="le ji lk lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/08a3c4bed241b09857c907cec9d9ff98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1546/format:webp/1*utFARk2kK3Kf2U2PHjixJQ.png"/></div></figure></div><p id="b728" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于有许多列中存在空值，我们将查看一些示例，rest预处理将出现在源代码中。</p><p id="2a78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理_性别</strong></p><div class="je jf jg jh fd ab cb"><figure class="le ji ll lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/b352c0279e2e4a46a0e373fdc35774df.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*qllvoqmwCxAyruRcpx3fLg.png"/></div></figure><figure class="le ji lm lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/bfaca5e69ab559783fa220ebac15bc5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*BI06Trc3zOtcEqGFYoErAw.png"/></div></figure><figure class="le ji ln lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/7d7bf4a583fef2be24e06f59c501af85.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*bFog1FNKZ_hyHfaHpm_jNg.png"/></div></figure></div><p id="2d6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以清楚地注意到，out 14572中的1507个空值对应于值的大约<strong class="ih hj"> 10% </strong>，因此我们不能使用集中趋势(模式)估算这些值，并且我们不能删除该列，因为有许多列具有类似数量的空值，因此我们必须使用其他方法来估算。可能有很多选择，像KNN，神经网络，老鼠。不过，我还是使用了一些基于简单统计的方法，即根据总体中存在的各种类别来分配这些空值，简单地说，根据它们在非空值中的比率在“M”和“F”类别之间分配1507个值。我在之前的一篇<strong class="ih hj">文章</strong>中写过这个技巧。</p><div class="lo lp ez fb lq lr"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/data-preprocessing-decreasing-categories-in-categorical-data-132e8b4a4fd"><div class="ls ab dw"><div class="lt ab lu cl cj lv"><h2 class="bd hj fi z dy lw ea eb lx ed ef hh bi translated">数据预处理:减少分类数据中的类别</h2><div class="ly l"><h3 class="bd b fi z dy lw ea eb lx ed ef dx translated">下一篇文章将着眼于各种数据类型，重点是分类数据，并回答为什么以及如何…</h3></div><div class="lz l"><p class="bd b fp z dy lw ea eb lx ed ef dx translated">medium.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf jn lr"/></div></div></a></div><div class="je jf jg jh fd ab cb"><figure class="le ji mg lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/e6cb10699332d30746bffd0d25eaf121.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*hh8RxkojPuX7j5JpHTERBA.png"/></div></figure><figure class="le ji mh lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/2fcb58602d7d372a673906e3368feaa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*E8FFuHLW89mLkwW7aQjZ5Q.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx mi di mj mk translated">用于插补的函数</figcaption></figure></div><div class="ab cb"><figure class="le ji ml lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/4d612cc14e6651addcb2a400d0340ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1550/format:webp/1*MCqGK1Xp-lW0n4wIV56bVw.png"/></div></figure><figure class="le ji mm lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/54074bdc248eca8d672a0e1b2eb05106.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*KxlRBZy4RPEu2bCsVZ2Yeg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx mn di mo mk translated">插补代码和检查</figcaption></figure></div><p id="b1ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在插补并确认没有空值后，将该列转换为类别。</p><div class="je jf jg jh fd ab cb"><figure class="le ji mp lg lh li lj paragraph-image"><img src="../Images/351317fc3c84bc36861bf6bddf37276b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*972f9Q1E7m9H2jgDhfTuOA.png"/></figure><figure class="le ji mq lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/9f37653adb2220336968deb745d381b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*EiQxx7Xd4rlmDWTs6bS4lA.png"/></div></figure></div><p id="7273" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">申请人_婚姻状况</strong></p><p id="f652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此栏中，空值的数量较少，因此可以使用模式进行插补。但是类别“W”和“D”出现的次数很少，所以我认为这些类别可以转换为空值并进行估算，因为ML模型从数据中学习应该有足够的出现次数。<strong class="ih hj">我很想听听这方面的意见，所以请评论你是否同意我的观点</strong>。</p><div class="je jf jg jh fd ab cb"><figure class="le ji mr lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/d27f3d6a98d1d60ced65b17d5e7d270d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*wgQSA_Jc5F8CZ6NfSgX6yA.png"/></div></figure><figure class="le ji ms lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/fbe99877dcff054d846bb13f100c368e.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*eyWNwVwU4mrw1RnKiQ47cQ.png"/></div></figure></div><p id="273a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了替换出现次数较少的类别，我创建了“to_replace”函数，该函数采用数据帧、列名和一个数字，并将出现次数少于数字的每个值替换为NULL。</p><p id="d277" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以根据我们的意愿来估算它。</p><p id="75ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">经理_业务2 </strong></p><p id="3916" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Manager_Business是一个连续变量，所以均值或中位数也可以估算它。不过，也可以通过使用<strong class="ih hj">宁滨、</strong>将其转换为分类，然后可以估算缺失值。</p><p id="22d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，所有其他列也被估算，空值被删除。现在，一旦从组合数据中恢复了训练和测试数据，我们就可以在这些数据上建立我们的机器学习模型。在这里，我们之前添加的拆分列的值将会很有帮助。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mt"><img src="../Images/96665331ee9b9a57ace610c7f1024728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avcKVOyWDAGoqvSnmBW_LQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从组合数据中获取训练和测试数据</figcaption></figure><p id="73cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们恢复了我们的训练和测试数据，所以我们可以拆分训练数据用于模型训练和验证。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mu"><img src="../Images/cbfdae502c22450ebe9c1bfbe6b5b613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*55oCzBI48Gt0zQOyexXhSA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">将数据分为训练和验证</figcaption></figure><p id="876e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我使用了CatBoost分类器，因为它可以处理分类列，内置了对RandomSearchCV和GridSearchCV的支持，而且速度也很快。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/84fb7e91c5f968385b58c73e90407779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKHbd0HHnP_1WcwoLrO69w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Catboost中的网格搜索参数</figcaption></figure><p id="9c74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了得到更好的结果，寻找最优参数是一个很好的方法。我已经尝试了各种参数'学习率'，'深度'，' l2_leaf_reg '和'迭代'。CatBoostClassifier也用“early_stopping_rounds”进行初始化，以防止过度拟合，并使用没有编码的分类特征。分类特征的名称作为列表传递给“cat_features”参数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mw"><img src="../Images/afefc7406edfe881bd6c2e1c00a5e3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3_N1bhMyvK8FYqvlNSiSQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用网格搜索的Catbbost模型的最佳参数</figcaption></figure><p id="6257" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“grid_search_reult”变量包含最佳参数，这些参数可用于构建我们的最终模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/db31e3fb6a133cb9652fb22d6d866ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIhS76pMQk3ns2k4yILBAg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最终Catboost模型</figcaption></figure><p id="f7ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查结果以防止过度拟合是重要的一步。这可以通过查看混淆度量或一些数字，如准确性或Roc_auc得分来完成。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/a35eb63f2d66e6a74555994e63b6a631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lRS2ZSGXiSb8ggnudT9u7A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">训练和测试数据Roc_auc_score</figcaption></figure><div class="je jf jg jh fd ab cb"><figure class="le ji mz lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/1c1af4cfefbca8bf84112ba73c1439de.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*tKw6yzW-AiJfdc0cv6VScQ.png"/></div></figure><figure class="le ji na lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/75465ee4133c7de2705a6c55514518af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*u8WEACXWqez46q7aUmzTTQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx nb di nc mk translated">训练和测试混淆度量</figcaption></figure></div><p id="4b7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我相信混淆矩阵是结果的真实指示，因为我们可以看到哪类值被准确预测，哪类值没有被准确预测。我们可以看到，假阳性少了，这是好事，假阴性多了，这可不好。我们还可以得出结论，我们的模型未能识别业务来源值为真的许多情况。</p><p id="42da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当一个模型表现不佳时，有各种各样的原因，比如模型可能没有被正确训练或者缺乏预测特征等等。纠正这些错误也是一个重要的过程，可以通过特征工程或微调模型来完成。<strong class="ih hj">但是大多数人忘记了模型的截止值也可以微调</strong>。</p><p id="4edb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">截止微调</strong></p><p id="be30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我遵循两个过程来微调截止频率:</p><p id="735e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。最大化灵敏度和特异性的总和</strong></p><div class="je jf jg jh fd ab cb"><figure class="le ji nd lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/bb4dd4008c0aec98c4b9369248ef5ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*0tq5tlI0P1_a4mMezQ_0Iw.png"/></div></figure><figure class="le ji ne lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/a4f14928e61d50a169980f5865da8743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*uDQR42VsVvOBEzPfQBftzg.png"/></div></figure></div><p id="37c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先将训练和验证数据的实际值和概率相加，然后计算每个截止点的灵敏度和特异性值。</p><div class="je jf jg jh fd ab cb"><figure class="le ji nf lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/403826e3ecdba8213202fd4ef3631787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*7cMqqbIyUpo6eEwVncbHqw.png"/></div></figure><figure class="le ji ng lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/5da33fa269125604c409316014558815.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*ktOMUdRBkHXOXQIVl94FGA.png"/></div></figure></div><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nh"><img src="../Images/31f650f0447ce5419d8b16b088d08bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GuqVHiipAuNd7PDtT9FKQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">灵敏度和特异性以及两者之和的图</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ni"><img src="../Images/2eb68b63fdcce27dbac8a12d6249229c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikolRMBw9OMSbr0htUMFbQ.png"/></div></div></figure><p id="cbb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们试图最大化的敏感性和特异性的总和开始增加，并在截止值0.65处达到最大值</p><div class="je jf jg jh fd ab cb"><figure class="le ji nj lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/2e061478c8bd8631823494eb695c1bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*tFpK2IXvM--kj6zcBkmySA.png"/></div></figure><figure class="le ji nk lg lh li lj paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/7bf01f568c90c2b497db10d14c3e73cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*vRi-D0jCwLJw_yGQzs1Khg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx nl di nm mk translated">微调截止值后的混淆矩阵。</figcaption></figure></div><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nn"><img src="../Images/4a7c8738d22bf9ceb43797bb1d88ece6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cXKjNOtdQasuOf7CWMtqGA.png"/></div></div></figure><p id="65af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们无法检查整体结果是否从混淆指标得到了改善，因此我们需要检查roc_auc得分，这也表明得分得到了改善。</p><p id="b56f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。最大化Roc_Auc分数</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es no"><img src="../Images/c0e3c61b6863de3f21477d620aff4a6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9Fa5_4Nb_Tjj9gKPJ0bpw.png"/></div></div></figure><p id="6f1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们可以确认的，不同临界值的Roc_auc分数也表明0.65是最适合的临界值。</p><p id="3f17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">根据测试数据进行预测</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nh"><img src="../Images/caff393f8b058bb70cdd88c181d440d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w3yJ3TX8E4HQSt5CkUc5IA.png"/></div></div></figure><p id="b7f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CatBoost的“predict_proba”方法为每一行提供了两个值的数组，因此列表理解为在列表中获得其中一个值，然后使用apply方法使用截止值获得二进制预测。</p><p id="7710" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是两部分系列的第1部分的结尾。在这一部分，我们主要关注数据预处理、数据建模和截止值微调。在下一部分中，我们将使用Google Colab研究自动化特征工程和Auto-ML。</p><p id="6b4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文的数据文件和IPYNB文档被添加到我的Github中，请随意下载并运行它们。</p><div class="lo lp ez fb lq lr"><a href="https://github.com/rvt123/Medium_Articles/tree/main/Code%20Walkthrough%20in%20An%20anonymous%20Machine%20Learning%20Hiring%20Hackathon" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab dw"><div class="lt ab lu cl cj lv"><h2 class="bd hj fi z dy lw ea eb lx ed ef hh bi translated">rvt123/Medium_Articles</h2><div class="ly l"><h3 class="bd b fi z dy lw ea eb lx ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="lz l"><p class="bd b fp z dy lw ea eb lx ed ef dx translated">github.com</p></div></div><div class="ma l"><div class="np l mc md me ma mf jn lr"/></div></div></a></div><p id="0251" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">喜欢文章请鼓掌，评论分享观点并连接over<a class="ae nq" href="https://www.linkedin.com/in/raghuvansh-tahlan/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">LinkedIn</strong></a><strong class="ih hj">。</strong></p><div class="lo lp ez fb lq lr"><a href="https://www.linkedin.com/in/raghuvansh-tahlan/" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab dw"><div class="lt ab lu cl cj lv"><h2 class="bd hj fi z dy lw ea eb lx ed ef hh bi translated">raghuvansh tah LAN-Guru Gobind Singh Indraprastha大学-新德里，德里，印度| LinkedIn</h2><div class="ly l"><h3 class="bd b fi z dy lw ea eb lx ed ef dx translated">查看Raghuvansh Tahlan在世界上最大的职业社区LinkedIn上的个人资料。Raghuvansh列出了2项工作…</h3></div><div class="lz l"><p class="bd b fp z dy lw ea eb lx ed ef dx translated">www.linkedin.com</p></div></div><div class="ma l"><div class="nr l mc md me ma mf jn lr"/></div></div></a></div></div></div>    
</body>
</html>