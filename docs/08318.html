<html>
<head>
<title>Finding New Customers using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习寻找新客户</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/finding-new-customers-using-machine-learning-f03857c7f965?source=collection_archive---------7-----------------------#2020-07-25">https://medium.com/analytics-vidhya/finding-new-customers-using-machine-learning-f03857c7f965?source=collection_archive---------7-----------------------#2020-07-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7146" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为Arvato Financial Services创建客户细分报告。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2c69e22fa4d562984426fc64a23eabfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMYzrWjIP6LppjG8kWzOtg.jpeg"/></div></div></figure><h1 id="dd0a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">目录</h1><ol class=""><li id="0b2b" class="kn ko hi ih b ii kp im kq iq kr iu ks iy kt jc ku kv kw kx bi translated">简介和问题陈述</li><li id="4355" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">项目结构和数据</li><li id="a365" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">项目组成部分</li><li id="8173" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">丰富</li><li id="84e5" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">结论部分</li></ol></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><h1 id="dda2" class="jp jq hi bd jr js lk ju jv jw ll jy jz ka lm kc kd ke ln kg kh ki lo kk kl km bi translated">介绍</h1><p id="aa59" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">对贝塔斯曼-阿瓦托数据集的分析将是一次客户细分，将从一家邮购公司收集的客户数据集与从德国一般人群中取样的数据集进行比较…</p><p id="62fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本项目中的数据由贝塔斯曼Arvato Analytics提供:</p><ul class=""><li id="34b1" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">德国一家邮购销售公司的顾客的人口统计数据，</li><li id="1a13" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">并与一般人群的人口统计信息进行了分析和比较。</li></ul><h2 id="0dc7" class="lw jq hi bd jr lx ly lz jv ma mb mc jz iq md me kd iu mf mg kh iy mh mi kl mj bi translated">问题陈述</h2><p id="30da" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">感兴趣的主要问题是预测在邮寄活动中最有可能成为其产品客户的人群。</p><p id="0555" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用监督和非监督学习来达到这个目标。</p><p id="0a86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">无监督学习</strong>帮助我们找到聚类内的相似性。我将应用<strong class="ih hj"> H2O均值</strong>来发现聚类。在预测&amp;分析<strong class="ih hj">聚类</strong>之后，我将能够从<strong class="ih hj"> Azdias </strong>数据集预测潜在客户。</p><p id="4819" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然无监督学习帮助我们找到相似的记录，但<strong class="ih hj">监督学习</strong>将让我们直接预测每个记录类。我们的问题是一个分类问题，因为目标值[0，1]分别代表非潜在客户和潜在客户。我会用<strong class="ih hj"> Lightgbm，XGBoost，CatBoost，Random Forest，Logistic回归</strong> <strong class="ih hj">分类器</strong>算法配合<strong class="ih hj"> sklearn </strong>库来预测每个人是不是潜在客户。</p><h1 id="0ee8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">项目结构</h1><p id="fef3" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">本项目计划在<strong class="ih hj"> 4主要</strong>部分流程中:</p><ul class=""><li id="2d3e" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated"><strong class="ih hj">数据清理</strong>和<strong class="ih hj">数据处理</strong></li><li id="e7f7" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">在对用于客户细分的<strong class="ih hj">重要特征</strong>进行调查之后，实施<strong class="ih hj">无监督学习</strong></li><li id="1bbd" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">实施<strong class="ih hj">监督学习</strong></li><li id="5519" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">卡格尔竞赛</li></ul><p id="9fb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第0部分:数据清理和数据处理</strong> <br/>在使用原始数据集进行分析之前，需要做几件事情:</p><ul class=""><li id="707b" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">探索性数据分析，以根据统计特征</li><li id="9697" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">缺失值的处理</li><li id="a998" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">转换功能和重构代码</li></ul><p id="75f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第1部分:客户细分报告</strong> <br/>这一部分的目的是为邮购公司找到描述典型客户的特征，并找到公司尚未关注的那部分人群。<br/>正因为如此，我们对现有客户和普通人群的特征进行了分析，以便通过使用无监督学习方法来创建客户细分。</p><p id="f00e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第2部分:监督学习</strong> <br/>这一部分的目的是训练一种算法，能够找到对邮寄活动做出积极响应的客户。<br/> Did应用监督学习来调查<strong class="ih hj"> MAILOUT-TRAIN </strong>和<strong class="ih hj"> MAILOUT-TEST </strong>数据集，以预测一个人在活动后是否成为邮购公司的客户。</p><p id="a566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">借助于学习曲线和最佳参数来选择算法的模型。</p><p id="c857" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">PART 3:Kaggle Competition<br/></strong>将从<strong class="ih hj"> part 3 </strong>中训练和参数化得到的<strong class="ih hj">模型</strong>应用于实现，<strong class="ih hj">Kaggle</strong>中的测试数据集，并加载和评级。</p><p id="c51e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据汇总</strong></p><ul class=""><li id="157d" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated"><code class="du mk ml mm mn b"><strong class="ih hj">Udacity_AZDIAS_052018</strong></code> <br/>德国总人口<strong class="ih hj">人口统计数据:</strong> <br/> 891 211人(行)x 366个特征(列)</li><li id="61b2" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated"><code class="du mk ml mm mn b"><strong class="ih hj">Udacity_AZDIAS_052018</strong></code> <br/>邮购公司<strong class="ih hj">客户的人口统计数据:<br/> </strong> 191 652人(行)x 369个特征(列)</li><li id="1ecf" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated"><code class="du mk ml mm mn b"><strong class="ih hj">Udacity_MAILOUT_052018_TRAIN</strong></code> <br/>作为营销活动目标的个人的人口统计数据:<br/> 42 982人(行)x 367(列)</li><li id="3d8f" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated"><code class="du mk ml mm mn b"><strong class="ih hj">Udacity_MAILOUT_052018_TEST<br/></strong></code>作为营销活动目标的个人的人口统计数据:<br/> 42 833人(行)x 366(列)</li></ul><p id="2db1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">功能概述</strong></p><ul class=""><li id="b09a" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">数据属性文件中有关于314列的信息。在这些信息中，只有数据集368列中的233列的信息。来自德国，对这个项目感兴趣的人在论坛上为其中的24个人写了附加信息。</li><li id="961d" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">观察到<strong class="ih hj"> Azdias </strong>和客户数据集之间有3列差异。</li></ul></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><h1 id="4b8a" class="jp jq hi bd jr js lk ju jv jw ll jy jz ka lm kc kd ke ln kg kh ki lo kk kl km bi translated">项目组成部分</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/2b9b7d19bd48795fd263289c5d47bfba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3P2jRm5x0oXn7zMHJNAp6w.png"/></div></div></figure><ul class=""><li id="9c66" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">导入文件是为了做一些探索性的数据分析。开始时，对数据集中缺失值的描述性统计和计算分布进行分析。</li><li id="756b" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">两个数据集的特征是同步的。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mp"><img src="../Images/9f4a492bfbcf1601d833b6ff9e810e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwFd6TcTaKJQ3AkPk7BlgA.png"/></div></div></figure><ul class=""><li id="e135" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated"><strong class="ih hj">80%为空的行</strong>已被删除。</li><li id="ee07" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">检查了<strong class="ih hj">列</strong>的缺失值。观察到在“<strong class="ih hj">高</strong>级别具有缺失值的列在Azdias和Customers的数据集中具有相同的列。相同列的数量是8。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mq"><img src="../Images/812b4d131a8f98c0614417c9b6a939e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BqozvAFDX6EYoSFJGUuuBw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/ca16fd95ad612f51a1703c909b32b66e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dvx2c8n-yR8YrxUxkczt7Q.png"/></div></div></figure><ul class=""><li id="7edb" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated"><strong class="ih hj">编码一些列:<br/> </strong>无监督学习技术只对数字特征起作用。因此，进行一些编码更改或附加假设，以便能够继续。<br/>此外，客户数据集包含目标数据集作为我们客户的源数据。因此，我们将对这个数据集进行列调查。当我们开始这项工作时，这是编码的初步准备，我们将在实现模型之前使用它，我们将从具有高'<strong class="ih hj"> nunique </strong>'值的列开始。</li></ul><blockquote class="ms"><p id="fbb9" class="mt mu hi bd mv mw mx my mz na nb jc dx translated">这里的目的是识别重要的列并显著减少这些特性的唯一值。</p></blockquote></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><blockquote class="nc nd ne"><p id="1b3c" class="if ig nf ih b ii ij ik il im in io ip ng ir is it nh iv iw ix ni iz ja jb jc hb bi translated"><strong class="ih hj">‘RAEGENDE _ jugendjhre’feu ture的编码</strong><br/><strong class="ih hj">RAEGENDE _ jugendjhre</strong>，在这一栏中给我们提供了两种不同的信息。一种是时间序列，另一种是两种类型(主流-前卫)<br/>必须将混合信息代码转换成<strong class="ih hj">两个不同的列。</strong></p></blockquote><pre class="je jf jg jh fd nj mn nk nl aw nm bi"><span id="a0ce" class="lw jq hi mn b fi nn no l np nq">1 : 40ies - war years (Mainstream,O+W)<br/>2 : 40ies - reconstruction years (Avantgarde,O+W)<br/>3 : 50ies - economic miracle (Mainstream,O+W)<br/>4 : 50ies - milk bar / Individualisation (Avantgarde,O+W)<br/>5 : 60ies - economic miracle (Mainstream,O+W)<br/>6 : 60ies - generation 68 / student protestors (Avantgarde,W)<br/>7 : 60ies - opponents to the building of the Wall (Avantgarde,O)<br/>8 : 70ies - family orientation (Mainstream,O+W)<br/>9 : 70ies - peace movement (Avantgarde,O+W)<br/>10 : 80ies - Generation Golf (Mainstream,W)<br/>11 : 80ies - ecological awareness (Avantgarde,W)<br/>12 : 80ies - FDJ/communist party youth organisation (Mainstream,O)<br/>13 : 80ies - Swords into ploughshares (Avantgarde,O)<br/>14 : 90ies - digital media kids (Mainstream,O+W)<br/>15 : 90ies - ecological awareness (Avantgarde,O+W)</span></pre><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nr ns l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nt"><img src="../Images/2b246f74a14486f5eb51ed09beb6f0a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h43W_bjo5jIOryDPcB_G0w.png"/></div></div></figure><blockquote class="nc nd ne"><p id="083b" class="if ig nf ih b ii ij ik il im in io ip ng ir is it nh iv iw ix ni iz ja jb jc hb bi translated">对‘GEBURTSJAHR’future<br/><strong class="ih hj">GEBURTSJAHR</strong>进行编码和调查，在这一栏中给出我们的出生年份。该列类型为<strong class="ih hj">数字</strong>。</p></blockquote><p id="35f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结果:</strong>我们使用此列<strong class="ih hj"> GEBURTSJAHR </strong>经过以下过程:</p><ul class=""><li id="c590" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">在这一栏中它有<code class="du mk ml mm mn b">0</code>(零)。这意味着<strong class="ih hj">错误</strong>或<strong class="ih hj">没有进入</strong>。我们应该用<strong class="ih hj"> NaN </strong>代替<strong class="ih hj"> zero </strong></li><li id="f302" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">用{190:193，191:193，192:193，200:199，201:np对值进行分类。NaN}</li></ul><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nr ns l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nu"><img src="../Images/7c7aba4b408251abc86fd5572244b32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*RA-cq_VWKazzi5Bjf-0PlA.png"/></div></figure><blockquote class="nc nd ne"><p id="e220" class="if ig nf ih b ii ij ik il im in io ip ng ir is it nh iv iw ix ni iz ja jb jc hb bi translated"><strong class="ih hj">对‘EINGEFUEGT _ AM’特性</strong><br/>’<strong class="ih hj">EINGEFUEGT _ AM</strong>的研究，在此栏中为我们提供了年月日信息。我们将年份索引从<strong class="ih hj"> EINGEFUEGT_AM </strong>特征转换成<strong class="ih hj"> EINGEFUEGT_ind </strong></p></blockquote><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nr ns l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nv"><img src="../Images/562c1372f11b78d9d85f7ea3523fb6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*rmFMb2BIWg6KA78zXWeW1Q.png"/></div></figure><p id="5d3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最有可能的是，第一次记录是在22年前取得的，那一年包含了<strong class="ih hj">几乎60%的数据</strong>。<strong class="ih hj">同样持续16到21年包含了~ 90%的数据</strong>。</p><p id="c47c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结果:</strong>由于偏度过大，我们删除了此列。删除创建新的<strong class="ih hj"> EINGEFUEGT_idn </strong>和<strong class="ih hj"> EINGEFUEGT_AM </strong>的列。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nw"><img src="../Images/7d6885d2cdb1e43d8ffbe3325d360937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*wLIwD-YR7Pd3Xg1mykk28w.png"/></div></figure><p id="b61f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分别检查了上述每个特征。删除不必要的功能。对其他每一个进行标签编码。</p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><ul class=""><li id="946f" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">如果用平均值填充<em class="nf">缺失值会将小数引入数据集，这种情况会影响效率</em>。因此，每个列的缺失值都用MODE替换。正因为如此，<strong class="ih hj">缺失值在移除<strong class="ih hj">重复行</strong>后被替换为每列的模式</strong>。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nx"><img src="../Images/1b807b2429947e25e300cace148287cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBRRfCtDlOss9xq62vg56w.png"/></div></div></figure></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/a4f2c56a33bcd8f27c2739ba38b4470b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oZSQNMTQgRIdvZFUsh9Kw.png"/></div></div></figure><p id="9ddf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用4种不同的模型，我们试图识别366个特征中的重要特征。使用了来自<strong class="ih hj"> H2o库</strong>的<strong class="ih hj"> GBM、RF、XGBoost </strong>和<strong class="ih hj"> StackedEnsemble </strong>。在检查了我从每个模型中获得的列的分数之后，我发现了57个重要特征。在下一阶段，将使用这57项功能。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ny"><img src="../Images/ac28ecea04aa8ef1bfceab7f84752815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWsY_SZdTPUF8qCnQyTOrg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nz"><img src="../Images/cf65ec43c940a57113970bd39861bf8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*UmVex_lpeWR-WMrMIVEM4Q.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/d7f121efd67dd321e732ce17d3ec3fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSzTx7kjSQNZtZdM2823ZQ.png"/></div></div></figure></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/85badf6b68db72743528dd7fb2290164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSTwCcJg6uCXyFmFliWFCw.png"/></div></div></figure><p id="8995" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一节中，我将讲述我如何处理无监督学习来分析客户细分的特征。</p><p id="7fe6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们不要忘记，我们的数据集存在不平衡问题。(Azdias-Customers ~ 17%，Mailout Train- 1.1%)我在探索性数据分析中观察到了这一点。在应用<strong class="ih hj"> PCA </strong>之后，我发现<strong class="ih hj">代表90–95%数据的组件</strong>的数量<strong class="ih hj">超过了200个组件</strong>。因此，我决定使用我在上一节中通过特性工程获得的<strong class="ih hj">重要特性</strong>。</p><p id="c848" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用主成分分析后，我从XGBoost获得的特征重要分数比的分数好。这就是为什么我选择只使用的<strong class="ih hj">重要特性。</strong></p><p id="8079" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">决定之后，下一步是确定最佳的集群数量。通过<strong class="ih hj"> Yellowbrick </strong>库的<strong class="ih hj"> KElbowVisualizer </strong>使用肘方法。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es oa"><img src="../Images/f846d6ae351268121be64fbc95243edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*uz_VlHZNQSXhjTDSGH1lDQ.png"/></div></figure><p id="ba2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算并绘制了跨方差K个聚类的平均聚类内距离。决定了4个集群将是一个好的结果。</p><p id="6192" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是实现和集群的时候了。在这里，由<strong class="ih hj"> H2o </strong>在h2o.estimators内部使用<strong class="ih hj">h2okmeanseestimator</strong>算法，并由<strong class="ih hj"> Matplotlib </strong>库用<strong class="ih hj"> Pyplot </strong>绘制。让我告诉你，在应用Azdias-Customers数据集之后，我立即应用了Mailout-Train和Mailout-Test数据集的聚类。</p><div class="je jf jg jh fd ab cb"><figure class="ob ji oc od oe of og paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/e65faf6ab7dfe822bf9e9062facddb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*APuFPpUBFtc0H_1ug0eNTQ.png"/></div></figure><figure class="ob ji oh od oe of og paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/65b3115493fd84bfee2ce93ee3e22242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*7amO_RQ54Bo2kC2M3KQOrw.png"/></div><figcaption class="oi oj et er es ok ol bd b be z dx om di on oo translated">Azdias-客户数据集的聚类</figcaption></figure></div><div class="ab cb"><figure class="ob ji op od oe of og paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/e855d5f14844e86f309c83eea383f081.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*C-yGm8BRbjkNKbslVq-9YA.png"/></div></figure><figure class="ob ji oq od oe of og paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/38706bd43056a3bd4f21cd2d0e10f7e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*LXwozpe_Ve_M7dF7k-00vA.png"/></div><figcaption class="oi oj et er es ok ol bd b be z dx om di on oo translated">邮寄数据集的集群</figcaption></figure></div><p id="5404" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了获得客户，如果在集群选择中遵循下面的顺序<strong class="ih hj">，就可以<strong class="ih hj">快速获得正面结果</strong>。</strong></p><ul class=""><li id="0b61" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">集群3和集群1是客户的最佳细分市场</li><li id="0671" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">集群0可能也不错</li><li id="ab37" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">第二组很糟糕。</li></ul></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es or"><img src="../Images/ee00b08097e32617f063e3ef5bc593f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAiNhnN0AvncAp0np2mhqg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/e5cf30ef06027494e3ad5bc4c7a27aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZIL5qTEOexbttsE_YhuWwg.png"/></div></div></figure><p id="3108" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据清洗阶段变成了<strong class="ih hj">流水线</strong>，并应用于Mailout-Train和Mailout-Test。然后根据<strong class="ih hj">重要特征</strong>排列数据。<br/>建模<strong class="ih hj">randomversampling</strong>之前通过<strong class="ih hj">做了sk learn</strong>(sampling _ strategy =<strong class="ih hj">0.25</strong>)的库来解决不平衡问题。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/8e9b2d18bba1ee5ff71e5044e7afc115.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*upXJKoyBZF-dPrpfJ7Qu2Q.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es os"><img src="../Images/be27c9f2e9439e5a754a76e7b00023af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELC235bM1rvz_i86VdLDAg.png"/></div></div></figure><p id="1e8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于这个过程是分类器，我选择并尝试了Sklearn的<strong class="ih hj">库的Lightgbm、XGBoost、CatBoost、Random Forest、Logistic Regression <strong class="ih hj">分类器模型</strong>。</strong></p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ot"><img src="../Images/ca98c5a5f46efab4219280917f27a5eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*G50jeKH97uV4WqwVt1RpMw.png"/></div></figure><p id="894a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在将VotingClassifier算法应用于集成建模之前，我对不平衡问题进行了调整。我将客户数据集中的一些记录添加到Mailout-Train数据集中，而不是人为地进行过采样。第二个模型产生了更好的结果，尽管不如第一个模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es os"><img src="../Images/9405681615692f84407974d81e9ccb61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWJHdHNcDMuAdyNx8LsBMQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ou"><img src="../Images/cc6dbc4d3f630cc27784865bc2402559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i725Pia4wRTF0lc-lYgp1A.png"/></div></div></figure><p id="401f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我比较<strong class="ih hj">基础模型</strong>、<strong class="ih hj">改进模型</strong>和<strong class="ih hj">改进控制</strong>时，我看到<code class="du mk ml mm mn b"><strong class="ih hj">VotingClassifier</strong></code>和<code class="du mk ml mm mn b"><strong class="ih hj">LGBMClassifier</strong></code>将会给我们最好的结果。因此，微调后的<code class="du mk ml mm mn b"><strong class="ih hj">VotingClassifier</strong></code> <strong class="ih hj">将与邮寄测试</strong>集一起使用。<br/>LGBM的<strong class="ih hj">改进模型最佳模型得分</strong> d在<strong class="ih hj"> 0.815448左右，VotingClassifier </strong>的<strong class="ih hj">0.871796。使用此<strong class="ih hj">投票分类器</strong>模型<strong class="ih hj">预测测试标签。</strong></strong></p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/83410a56932a74782da0ff68c1cf7ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HtIN8t9-H3EWLLhdejWL_A.png"/></div></div></figure><p id="fe70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，将使用根据训练数据训练的最佳模型对邮寄测试数据进行分类。在这里，所有的模型都将被估计。但是will提交的只是微调后的VotingClassifier模型的预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ov"><img src="../Images/21c1fc5bea0861e37abe9cbd9ddc62d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7M_Y1J-O1lecTzQMP7frw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ow"><img src="../Images/810391a43ebb1afb54a7cda58cb08b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s56J7cYheRlIKdAjIxxELw.png"/></div></div></figure></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><h1 id="72ad" class="jp jq hi bd jr js lk ju jv jw ll jy jz ka lm kc kd ke ln kg kh ki lo kk kl km bi translated">改进</h1><p id="0196" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">从数据清理到模型训练，有许多不同的方法和解决方案可以应用。由于这是一个现实生活中的问题，如果特征知识是已知的，结果会更好，因为列的选择将是不同的。综上所述，提高监督学习模型的性能，可以执行以下部分:</p><ul class=""><li id="4d26" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">了解有关功能的更多信息以改进功能工程，</li><li id="d4c8" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">处理不平衡数据:欠采样或过采样，</li><li id="ddaf" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">增加特性或PCA组件。</li><li id="b12e" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">LightGBM模型可以通过运行更广泛的超参数调优来改进。尝试迄今为止最佳分类器的更多超参数调整，并使用最佳优化的分类器模型。</li></ul><h1 id="6a0f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结果</h1><ul class=""><li id="e1ad" class="kn ko hi ih b ii kp im kq iq kr iu ks iy kt jc lv kv kw kx bi translated">用<strong class="ih hj">k均值</strong>获得4个聚类。如果在集群中选择<strong class="ih hj">集群3 </strong>和<strong class="ih hj">集群1 </strong>，可以很快得到正面结果。集群3和集群1是潜在客户的最佳细分市场<strong class="ih hj"/>。</li><li id="29e7" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">这个过程就是分类器。正因为如此，我选择并尝试了Sklearn库的<strong class="ih hj"> Lightgbm、XGBoost、CatBoost、Random Forest、Logistic Regression </strong>分类器模型。<em class="nf">基于树算法的分类器模型对异常值具有鲁棒性。树算法在相同值的基础上分割数据点，因此离群值不会对分割产生太大影响。”(6) <br/><em class="nf">“voting classifier”背后的思想是在概念上组合不同的机器学习分类器，并使用</em> <strong class="ih hj"> <em class="nf">多数</em> </strong> <em class="nf">投票、</em> <strong class="ih hj"> <em class="nf">加权</em> </strong> <em class="nf">，或</em> <strong class="ih hj"> <em class="nf">平均</em> </strong> <em class="nf">预测概率(软投票)来预测类别标签。这种分类器可以用于一组同样表现良好模型，以平衡它们各自的弱点(3) </em></em></li></ul><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nr ns l"/></div></figure><ul class=""><li id="c5ee" class="kn ko hi ih b ii ij im in iq ls iu lt iy lu jc lv kv kw kx bi translated">我从这些模型中得到的ROC-AUC得分的最好结果是来自Lightgbm 的0.79613。<br/>对数据集进行新的过采样后<strong class="ih hj">改进的最佳ROC-AUC得分</strong>来自Lightgbm 约为<strong class="ih hj"> 0.8063，另一个来自VotingClassifier </strong>为<strong class="ih hj">0.8588。使用该投票分类器模型来预测测试标签。</strong></li><li id="c1a8" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">此外，邮寄测试结果为{1: 3531，0 : 33669}，使用<strong class="ih hj">投票分类器</strong>型号。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ox"><img src="../Images/e046a2518c97ae29365f788dda78ca7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ol8Yjayt5qdq2B9vUENZFg.png"/></div></div></figure></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><h1 id="c508" class="jp jq hi bd jr js lk ju jv jw ll jy jz ka lm kc kd ke ln kg kh ki lo kk kl km bi translated">结论</h1><ul class=""><li id="dd14" class="kn ko hi ih b ii kp im kq iq kr iu ks iy kt jc lv kv kw kx bi translated">在普通客户群体数据集上训练了一个<strong class="ih hj"> K均值模型</strong>。使用该模型对客户数据进行聚类以进行客户细分，然后<strong class="ih hj">比较聚类的分布</strong>。</li><li id="a88d" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated"><strong class="ih hj">堆叠</strong>和<strong class="ih hj">投票</strong>比单一模型结果更有用。</li><li id="b338" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">如果我们能向客户展示我们的发现并获得反馈，那就太好了。</li><li id="b3aa" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">这个项目的两个挑战是大数据量和数据不平衡。清理这些大数据并将GridSearcheCV应用于模型也需要大量的时间和机器性能。对于解决方案，应该多花一些时间去了解列，在不禁用重要列的情况下寻求高性能。</li><li id="2eac" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">对我来说，<strong class="ih hj">用<strong class="ih hj">10–128种变化</strong>实现GridSearchCV是一个错误</strong>。更明智的做法是只关注<strong class="ih hj"> LGBM </strong>和<strong class="ih hj"> XGBoost </strong>车型。</li><li id="6e22" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lv kv kw kx bi translated">这个分析的公共代码可以在它的Github库中找到。</li></ul><p id="2a93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本项目使用的一些资源:<br/> (1) <a class="ae oy" href="http://python-graph-gallery.com/barplot/" rel="noopener ugc nofollow" target="_blank">可视化</a> <br/> (2) <a class="ae oy" href="http://docs.h2o.ai/" rel="noopener ugc nofollow" target="_blank"> H2O.ai文档</a> <br/> (3) <a class="ae oy" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingClassifier.html" rel="noopener ugc nofollow" target="_blank">集成投票分类器</a> <br/> (4) <a class="ae oy" href="https://mlfromscratch.com/gridsearch-keras-sklearn/#/" rel="noopener ugc nofollow" target="_blank">用于GridSearch </a> <br/>一些文章:(<a class="ae oy" href="https://datascience.stackexchange.com/questions/37394/are-decision-trees-robust-to-outliers#:~:text=Yes%20all%20tree%20algorithms%20are,depending%20upon%20their%20house%20size." rel="noopener ugc nofollow" target="_blank"> 6 </a>，(<a class="ae oy" href="https://www.analyticsvidhya.com/blog/2016/03/complete-guide-parameter-tuning-xgboost-with-codes-python/" rel="noopener ugc nofollow" target="_blank"> 7 </a>)，(<a class="ae oy" href="https://queirozf.com/entries/one-hot-encoding-a-feature-on-a-pandas-dataframe-an-example" rel="noopener ugc nofollow" target="_blank"> 8 </a>，(<a class="ae oy" href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5#:~:text=AUC%20-%20ROC%20curve%20is%20a,degree%20or%20measure%20of%20separability.&amp;text=By%20analogy,%20Higher%20the%20AUC,with%20disease%20and%20no%20disease." rel="noopener" target="_blank"> 9 </a></p></div></div>    
</body>
</html>