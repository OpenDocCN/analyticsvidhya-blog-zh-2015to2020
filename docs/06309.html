<html>
<head>
<title>Create a FFTW 3 Docker from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始创建一个FFTW 3码头</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-a-fftw-3-docker-from-scratch-a84b05b3ce5b?source=collection_archive---------32-----------------------#2020-05-17">https://medium.com/analytics-vidhya/create-a-fftw-3-docker-from-scratch-a84b05b3ce5b?source=collection_archive---------32-----------------------#2020-05-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="debc" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">开始为集装箱化的目标塑造形象吧！</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/7a21bdf9a848b09a89d98df9ee0f763f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0r_AwSqOPfmkBEuk"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@ishant_mishra54?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ishant Mishra </a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><blockquote class="jo jp jq"><p id="9fc7" class="jr js jt ju b jv jw ij jx jy jz im ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated"><em class="hi">TL；DR:可以从</em> <a class="ae jn" href="https://hub.docker.com/r/cudachen/fftw-docker" rel="noopener ugc nofollow" target="_blank"> <em class="hi">这里</em> </a> <em class="hi">拉图。</em></p><p id="1d0e" class="jr js jt ju b jv jw ij jx jy jz im ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">点击<a class="ae jn" rel="noopener" href="/analytics-vidhya/create-a-fftw-3-docker-from-scratch-a84b05b3ce5b?source=friends_link&amp;sk=b90be6bcf6964532860a9dd0fbead80d">此</a>通过付费墙。</p></blockquote><h1 id="439a" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">动机</h1><p id="386e" class="pw-post-body-paragraph jr js hi ju b jv lg ij jx jy lh im ka li lj kd ke lk ll kh ki lm ln kl km kn hb bi translated">FFTW的速度相当惊人，但安装有点复杂。更重要的是，我想尝试从GitHub repo而不是zip文件中构建FFTW源代码，并且我想要一个配置良好的移动环境。因此，我创建了这个项目并学习了一些关于Docker的基础知识。</p><h1 id="f5ca" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">Dockerfile文件的内容</h1><p id="5f3d" class="pw-post-body-paragraph jr js hi ju b jv lg ij jx jy lh im ka li lj kd ke lk ll kh ki lm ln kl km kn hb bi translated">长话短说，你可以在这里看到整个docker file<a class="ae jn" href="https://github.com/Cuda-Chen/fftw-docker/blob/master/Dockerfile" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="01d8" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">我将概述这个文档的一些重要部分。</p><h1 id="b6cd" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">基础图像</h1><p id="f5a6" class="pw-post-body-paragraph jr js hi ju b jv lg ij jx jy lh im ka li lj kd ke lk ll kh ki lm ln kl km kn hb bi translated">在第一行，你可以看到我选择了Ubuntu的基本图像。虽然有些人认为使用这样的图像会导致巨大的图像尺寸，但我认为我应该使用这种图像，因为它包含标准的<code class="du lo lp lq lr b">glibc</code>，这对FFTW来说至关重要。</p><h1 id="5e22" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">为什么FFTW要求OCaml从零开始构建？</h1><p id="79a6" class="pw-post-body-paragraph jr js hi ju b jv lg ij jx jy lh im ka li lj kd ke lk ll kh ki lm ln kl km kn hb bi translated">在第15~18行，你可以看到我下载了一些包，包括OCaml。原因是作者使用OCaml生成“小代码”，这些小代码是硬编码的代码，以便在特定条件下达到最佳性能。[1]</p><p id="1f62" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">如果你曾经上过编译器的课程，你会意识到用C实现一个小型编译器不仅繁琐，而且需要维护AST(抽象语法树)[2]的知识，即使你用<code class="du lo lp lq lr b">lex</code>和<code class="du lo lp lq lr b">yacc</code>做功课。所以班上一些很酷的家伙会毫不费力地使用其他语言来创建AST，如Haskell和OCaml，从而完美地完成作业。你猜怎么着？作者选择后者来创建那些“小代码”，让FFTW生成优化的C代码。</p><p id="59c2" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">那我为什么要下载其他四个包呢？因为当我试图在Ubuntu Docker中构建FFTW时，容器总是抱怨没有这些包就无法编译。那一刻，我意识到，一个基础映像通常会为了缩小映像大小而丢弃一些包。</p><p id="2ca6" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">那么如何解决这个问题呢？很简单。您只需读取错误，记下错误，在编译前添加缺失的包，然后循环，直到构建没有错误(真的)。</p><h1 id="23cf" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">最后，为什么我们需要ocaml数字库？</h1><p id="e3d1" class="pw-post-body-paragraph jr js hi ju b jv lg ij jx jy lh im ka li lj kd ke lk ll kh ki lm ln kl km kn hb bi translated">很简单。在FFTW GitHub repo的README中提到，OCaml在OCaml 4.06.0中删除了ocaml Num库(2017年11月3日)。[3]</p><p id="0e2c" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">有趣的是Ubuntu 18.04在APT上没有这样的包。因此，我手动下载并从源代码编译它。</p><h1 id="bbc6" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">想到了这个项目</h1><p id="dedf" class="pw-post-body-paragraph jr js hi ju b jv lg ij jx jy lh im ka li lj kd ke lk ll kh ki lm ln kl km kn hb bi translated">完成这个项目后，我不仅意识到如何从零开始编译FFTW。更重要的是，我做了一个很好的实践来创建一个符合我需要的Docker图像，并且我有机会深入挖掘这个使用其他语言来解决c语言陷阱的杰作。</p><p id="bab7" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">最后，希望你们喜欢这篇文章！</p><h1 id="b927" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">参考</h1><p id="2d70" class="pw-post-body-paragraph jr js hi ju b jv lg ij jx jy lh im ka li lj kd ke lk ll kh ki lm ln kl km kn hb bi translated">[1]<a class="ae jn" href="http://www.fftw.org/fftw3_doc/Generating-your-own-code.html" rel="noopener ugc nofollow" target="_blank">http://www.fftw.org/fftw3_doc/Generating-your-own-code.html</a></p><p id="788c" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">[2]https://en.wikipedia.org/wiki/Abstract_syntax_tree<a class="ae jn" href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" rel="noopener ugc nofollow" target="_blank"/></p><p id="2c23" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated">[3]https://github.com/FFTW/fftw3/blob/master/README<a class="ae jn" href="https://github.com/FFTW/fftw3/blob/master/README" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="8244" class="pw-post-body-paragraph jr js hi ju b jv jw ij jx jy jz im ka li kc kd ke lk kg kh ki lm kk kl km kn hb bi translated"><em class="jt">原载于2020年5月18日</em><a class="ae jn" href="https://cuda-chen.github.io/devops/2020/05/18/Create-a-FFTW-3-Docker-from-Scratch.html" rel="noopener ugc nofollow" target="_blank"><em class="jt">https://cuda-Chen . github . io</em></a><em class="jt">。</em></p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><blockquote class="jo jp jq"><p id="6ecb" class="jr js jt ju b jv jw ij jx jy jz im ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">如果你有什么想法和问题要分享，请联系我<a class="ae jn" href="http://clh960524@gmail.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ju hj">clh 960524【at】Gmail . com</strong></a>。另外，你可以查看我的<a class="ae jn" href="https://github.com/Cuda-Chen" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>的其他作品。如果你像我一样对机器学习、图像处理和并行计算充满热情，欢迎在LinkedIn 上加我。</p></blockquote></div></div>    
</body>
</html>