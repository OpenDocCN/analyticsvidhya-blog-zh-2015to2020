<html>
<head>
<title>Logistic Regression in Python using Pandas and Seaborn(For Beginners in ML)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中使用 Pandas 和 Seaborn 的逻辑回归(适用于 ML 初学者)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-in-python-using-pandas-and-seaborn-for-beginners-in-ml-64eaf0f208d2?source=collection_archive---------4-----------------------#2020-10-31">https://medium.com/analytics-vidhya/logistic-regression-in-python-using-pandas-and-seaborn-for-beginners-in-ml-64eaf0f208d2?source=collection_archive---------4-----------------------#2020-10-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4b1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据集和问题陈述</strong></p><p id="7b67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用广告数据集，显示特定的互联网用户是否点击了广告。我们将尝试创建一个模型，根据用户的特征来预测他们是否会点击广告。该数据集包含以下特征:</p><ul class=""><li id="769b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">“每天花在网站上的时间”:消费者在网站上的时间(分钟)</li><li id="e546" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“年龄”:以年为单位的客户年龄</li><li id="8ea7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“地区收入”:平均。消费者地理区域的收入</li><li id="8138" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“每日互联网使用量”:平均。消费者每天花 30 分钟上网</li><li id="46be" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“广告主题行”:广告的标题</li><li id="bf9a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“城市”:消费者的城市</li><li id="675b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“男性”:消费者是否为男性</li><li id="635b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“国家”:消费者所在的国家</li><li id="0b66" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“时间戳”:消费者点击广告或关闭窗口的时间</li><li id="4b73" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“点击了广告”:0 或 1 表示点击了广告</li></ul><p id="8c4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们一步一步地使用 Python 来分析、可视化和建模逻辑回归拟合</p><p id="cf19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#首先，让我们导入所有必需的库-</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="df0f" class="ka kb hi jw b fi kc kd l ke kf">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline</span></pre><p id="8422" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#读取数据帧中的数据-</p><p id="3796" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kg kh ki jw b">ad_data = pd.read_csv(‘advertising.csv’)</code></p><p id="2ac6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#使用 pandas 提供的标题、描述和信息功能检查数据</p><figure class="jr js jt ju fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kj"><img src="../Images/11ad4f230efa6a5986b1349e194d6a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdXGnJunHjsRVXq152KdNw.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">ad_data.head()</figcaption></figure><figure class="jr js jt ju fd kk er es paragraph-image"><div class="er es kv"><img src="../Images/d417757a6c9c78449a5b5bac056fd7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*XbOFUM1jD11Yo84VcAmz-g.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">ad_data.info()</figcaption></figure><figure class="jr js jt ju fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kw"><img src="../Images/b04db3f28c1ff94895ccf63e94745495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E8ca7xi-WSm8XaTtF3vo7g.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">ad_data.describe()</figcaption></figure><h1 id="d4b6" class="kx kb hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">探索性数据分析</h1><p id="6046" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">这对于理解数据、各种特性的行为属性以及依赖关系(如果有的话)总是有帮助的。</p><p id="432a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们尝试尽可能多的可视化。但在这里，让我们做一些常见的图表，这将有助于我们理解关键特性。</p><p id="1535" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用 Python、Seaborn</p><figure class="jr js jt ju fd kk er es paragraph-image"><div class="er es lz"><img src="../Images/770179900f3cb3ce987523d8c3db4aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*XgSNMKkz_Vb9raua8o9kaw.png"/></div></figure><p id="0356" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#绘制年龄直方图</p><p id="7a22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">plt.hist(ad_data['Age']，bins = 40)</p><figure class="jr js jt ju fd kk er es paragraph-image"><div class="er es ma"><img src="../Images/c4d46240dcee3215d7f84c29fa396a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*Bh65Mxmj0j5Su8AhZ4GKTw.png"/></div></figure><p id="a360" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#创建一个显示地区收入与年龄的联合图。</p><p id="d7a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sns.jointplot('年龄'，'地区收入'，数据=ad_data)</p><figure class="jr js jt ju fd kk er es paragraph-image"><div class="er es mb"><img src="../Images/65e5efa9a003e178dcfa514b619274ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*gBNYq1L36cK6eO5NHg7P4Q.png"/></div></figure><p id="932e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#创建一个显示每天花费在网站上的时间与年龄的 kde 分布的联合图</p><p id="2818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sns.jointplot('年龄'，'每天花在网站上的时间'，data=ad_data，kind='kde '，color='red ')</p><figure class="jr js jt ju fd kk er es paragraph-image"><div class="er es mc"><img src="../Images/846b9a53230e9d21fa60025ce52f264d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*FwI7A8v95k4rN8qIDSD66w.png"/></div></figure><p id="19ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#创建“每天花在网站上的时间”与“每天使用互联网的时间”的联合图</p><p id="5c33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sns.jointplot('每天花在网站上的时间'，'每天的互联网使用量'，data=ad_data，color='green ')</p><p id="f7e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#最后，使用“点击广告”列功能定义的色调创建一个 pairplot，以分析每个变量之间的关系</p><p id="8782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kg kh ki jw b">sns.pairplot(ad_data,hue=’Clicked on Ad’)</code></p><p id="9d78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#我们可以看到蓝色和橙色的数据点实际上是分开的，这是一个很好的指标。</p><figure class="jr js jt ju fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es md"><img src="../Images/bb19d0ab5bdecee139d68eb44d3adecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLWLmKsgmEL_SsjAfwW7zA.png"/></div></div></figure><h1 id="23a1" class="kx kb hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">逻辑回归—</h1><h1 id="a232" class="kx kb hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">将数据分成训练集和测试集</h1><p id="8fe6" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated"><code class="du kg kh ki jw b">from sklearn.model_selection import train_test_split</code></p><p id="dec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变量 X 包含解释性列，我们将使用这些列来训练我们的模型，以适应广告是否被点击</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="121d" class="ka kb hi jw b fi kc kd l ke kf">X= ad_data.drop([‘Ad Topic Line’,’City’,’Timestamp’,’Clicked on Ad’,’Country’],axis=1)<br/>y = ad_data[‘Clicked on Ad’]</span><span id="c2d5" class="ka kb hi jw b fi me kd l ke kf">X_train, X_test,y_train, y_test = train_test_split(X,y,test_size=0.33, random_state=42)</span></pre><h1 id="4066" class="kx kb hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">训练模型</h1><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="b299" class="ka kb hi jw b fi kc kd l ke kf">from sklearn.linear_model import LogisticRegression<br/>logreg = LogisticRegression()</span><span id="0b5b" class="ka kb hi jw b fi me kd l ke kf">logreg.fit(X_train,y_train)</span></pre><p id="4904" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得到下面，它显示了默认情况下使用 fit()方法设置的参数</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="7d3c" class="ka kb hi jw b fi kc kd l ke kf">LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,<br/>          intercept_scaling=1, max_iter=100, multi_class='ovr', n_jobs=1,<br/>          penalty='l2', random_state=None, solver='liblinear', tol=0.0001,<br/>          verbose=0, warm_start=False)</span></pre><h1 id="d6c2" class="kx kb hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">我们模型的预测和评估</h1><p id="c78b" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">现在让我们从测试数据中预测数值-</p><p id="b5f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kg kh ki jw b">prediction = logrig.predict(X_test)</code></p><p id="1d7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#我们为逻辑回归模型创建分类报告。这比较了我们的实际值和预测值</p><p id="4044" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自 sklearn.metrics 导入分类 _ 报告</p><p id="56ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打印(分类 _ 报告(y _ 测试，预测))</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="5a84" class="ka kb hi jw b fi kc kd l ke kf">precision    recall  f1-score   support<br/><br/>          0       0.87      0.96      0.91       162<br/>          1       0.96      0.86      0.91       168<br/><br/>avg / total       0.91      0.91      0.91       330</span></pre><p id="056c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这表明我们的模型有大约 91%的准确率。</p><p id="2457" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">全部完成！！我们刚刚使用 sklearn 完成了 python 中的逻辑回归。</p></div></div>    
</body>
</html>