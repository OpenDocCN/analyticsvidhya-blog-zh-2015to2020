<html>
<head>
<title>Chat Application using python3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用python3的聊天应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/chat-application-using-python3-9d1980387503?source=collection_archive---------3-----------------------#2019-07-05">https://medium.com/analytics-vidhya/chat-application-using-python3-9d1980387503?source=collection_archive---------3-----------------------#2019-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7e7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在聊天应用程序非常普遍，有时我们希望我们有自己的聊天应用程序，有自己的定制功能和外观。所以我尝试用套接字编程的概念在Python3中制作一个基于CLI的聊天程序。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="b11f" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是套接字编程？？</h1><p id="268b" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">初学者首先想到的问题是什么是套接字，什么是套接字编程？？？</p><blockquote class="kn ko kp"><p id="b936" class="if ig kq ih b ii ij ik il im in io ip kr ir is it ks iv iw ix kt iz ja jb jc hb bi translated"><strong class="ih hj">网络套接字</strong>是在<a class="ae ku" href="https://en.wikipedia.org/wiki/Computer_network" rel="noopener ugc nofollow" target="_blank">计算机网络</a>上的<a class="ae ku" href="https://en.wikipedia.org/wiki/Node_(networking)" rel="noopener ugc nofollow" target="_blank">节点</a>内发送或接收数据的内部端点。</p></blockquote><p id="58ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在我们可以得出结论，制作这样的控制网络套接字的程序被称为套接字编程。通过套接字编程，我们可以控制网络套接字，并向网络上的其他系统发送数据以传输数据。最常见的套接字应用程序类型是客户端-服务器应用程序，其中一方充当服务器并等待来自客户端的连接。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="2b49" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">弄脏手</h1><p id="18e0" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">现在我们知道了什么是套接字编程以及为什么使用它。Python提供了一个<a class="ae ku" href="https://docs.python.org/3/library/socket.html" rel="noopener ugc nofollow" target="_blank"> socket模块</a>来制作这样的程序。这是我们将用来制作一个客户端服务器聊天应用程序的模块。</p><p id="9109" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模块中的主要套接字API函数和方法是:</p><ul class=""><li id="246b" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">socket():用于创建套接字的实例</li><li id="f1d7" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">bind():将ip和端口号与套接字对象绑定</li><li id="12ce" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">listen():侦听来自客户端的传入请求</li><li id="5168" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">accept():接受来自客户端的传入请求</li><li id="d7a3" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">connect():将客户机连接到服务器的套接字</li><li id="872a" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">recv():从另一端接收数据</li><li id="3e55" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">send():将数据发送到另一端</li><li id="4120" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">close():关闭客户机和服务器之间的会话</li></ul><figure class="lk ll lm ln fd lo er es paragraph-image"><div class="er es lj"><img src="../Images/701143d0b3019199be8a25582ae90215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*CIaCFQecLTzVb8ZZ3b355Q.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">TCP的套接字API调用序列和数据流</figcaption></figure><p id="1354" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种客户机-服务器体系结构中，</p><ol class=""><li id="30a5" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc lv lb lc ld bi translated">服务器创建一个套接字，并将其与IP和端口号绑定。</li><li id="0562" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc lv lb lc ld bi translated">它侦听绑定端口上的传入请求。</li><li id="168e" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc lv lb lc ld bi translated">客户端制作一个套接字，并将其连接到服务器的IP和端口。(三次握手)</li><li id="db61" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc lv lb lc ld bi translated">服务器接受客户端请求，然后开始服务器和客户端之间的数据传输。</li><li id="e252" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc lv lb lc ld bi translated">当数据传输完成时，客户端和服务器之间的连接关闭。(连接终止)</li></ol><h1 id="0ffe" class="jk jl hi bd jm jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd ma kf kg kh bi translated">服务器端[代码]</h1><pre class="lk ll lm ln fd mb mc md me aw mf bi"><span id="65aa" class="mg jl hi mc b fi mh mi l mj mk">import socket         # import socket module<br/>ip="192.168.43.92"    # server's IP address<br/>port=4545             # server's port dedicated for the program           </span><span id="8207" class="mg jl hi mc b fi ml mi l mj mk">s = socket.socket()   # create socket<br/>s.bind((ip, port))    # bind the IP and port with the socket<br/>s.listen()            # listen for incoming requests on port 4545</span><span id="705d" class="mg jl hi mc b fi ml mi l mj mk">c, addr = s.accept()     # accepts the incoming request <br/>                         # + make client object</span><span id="4e01" class="mg jl hi mc b fi ml mi l mj mk">while True:<br/>        c_data = c.recv(1024).decode()      # receive client data<br/>        print("[msg]&gt; "+c_data)             # print client data<br/>        if c_data == 'exit':<br/>                break<br/>        c.send(input("[you]&gt; ").encode())   # sends the server data</span><span id="50e9" class="mg jl hi mc b fi ml mi l mj mk">c.close()        # close client session<br/>s.close()        # close socket </span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="aac2" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">客户端[代码]</h1><pre class="lk ll lm ln fd mb mc md me aw mf bi"><span id="f253" class="mg jl hi mc b fi mh mi l mj mk">import socket                 # import socket module</span><span id="a5c5" class="mg jl hi mc b fi ml mi l mj mk">s=socket.socket()             # create socket instance</span><span id="01b1" class="mg jl hi mc b fi ml mi l mj mk">s_ip = "192.168.43.92"        # server's ip address<br/>s_ port = 4545                # server's port number<br/>s.connect((s_ip, s_port))     # connecting to server's socket</span><span id="b930" class="mg jl hi mc b fi ml mi l mj mk">while True:<br/>        s.send(input("[you]&gt; ").encode())    # send data to server<br/>        s_data = s.recv(1024).decode()       # recv data from server<br/>        if s_data == 'exit':<br/>                break<br/>        print("[msg]&gt; "+s_data)              # print server data</span><span id="2572" class="mg jl hi mc b fi ml mi l mj mk">s.close()                     # close socket</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="a624" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些代码提供了聊天应用程序的基本功能。此代码可以修改，以提供更多的功能，用例，用户界面等，根据个人的要求。</p><p id="d984" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注</strong>:以上代码中使用的IP地址和端口号是我机器的事实，你必须用你机器的事实来替换它们。</p><ul class=""><li id="f673" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">要获得IP，您可以使用windows的“ipconfig”命令和linux的“ifconfig”命令。</li><li id="18af" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">对于端口号，您可以使用系统的任何空闲端口。要检查繁忙的端口，您可以使用带有合适选项/标志的“netstat”命令。</li><li id="b1e7" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">两个设备(客户端和服务器)应该相互连接(即在同一个网络上或可ping通)。</li><li id="c770" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">两个代码共享同一个属于服务器的IP。所以你必须使用服务器的IP地址。</li></ul><p id="ddb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">暂时就这样了。如果你为一些其他用例修改这个，那么我很想知道它。</p></div></div>    
</body>
</html>