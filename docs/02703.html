<html>
<head>
<title>Custom Gym environment with agents that collaborate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有协作代理的定制健身房环境</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/custom-gym-environment-with-agents-that-collaborate-4f96ef898a2a?source=collection_archive---------13-----------------------#2019-12-29">https://medium.com/analytics-vidhya/custom-gym-environment-with-agents-that-collaborate-4f96ef898a2a?source=collection_archive---------13-----------------------#2019-12-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0051db840e4820592328d8431c934889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QqIKOCME7jtrvPFJMzUd2g.jpeg"/></div></div></figure><p id="359d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在<a class="ae jo" rel="noopener" href="/@mathieuces/how-to-create-a-custom-gym-environment-with-multiple-agents-f368d13582ee"> <strong class="is hj">上一篇</strong> </a>中，我解释了如何用多个代理制作一个开放的AI的g <strong class="is hj"> ym </strong>环境。在这一篇中，我将解释如何让他们合作追求一个共同的目标:走出迷宫！</p><p id="e146" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这篇文章的所有代码都在我的<a class="ae jo" href="https://github.com/MathieuCesbron/Maze/tree/collaboration" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> GitHub </strong> </a>上。</p><h1 id="f429" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">自定义环境</h1><p id="ad5c" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">定制环境将是一个<strong class="is hj">迷宫</strong>(类似于<a class="ae jo" rel="noopener" href="/@mathieuces/how-to-create-a-custom-gym-environment-with-multiple-agents-f368d13582ee">上一篇文章</a>中的那个)但是有一些变化。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/de3e1dbc46c35e8bd59a5b6ac6a4ecaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*0oZA8yjbJbd9ePQfRkck7g.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx translated">起始迷宫</figcaption></figure><p id="0e61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">0: <strong class="is hj">空区域</strong>，代理可以去那里</p><p id="b3f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1: <strong class="is hj">代理1 </strong>谁将尝试找到出口</p><p id="d580" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2: <strong class="is hj">代理2 </strong>谁也要试着找到出口</p><p id="bdb2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">陷阱，如果一个特工去了那里，他就输了</p><p id="25d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4: <strong class="is hj">传送点，</strong>如果一个a代理移动到传送点，另一个代理立刻向北移动3格。</p><p id="f543" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5: <strong class="is hj">退出</strong>，退出迷宫并赢得游戏</p><p id="7f7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在游戏中，代理人1开始移动，然后代理人2移动，然后代理人1…如果代理人掉进陷阱或找到出口，游戏结束。是一款<strong class="is hj">回合制游戏</strong>。</p><h1 id="d87d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">奖励函数</h1><p id="715e" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">奖励函数对于找到一种有效的方法来为我们的代理人找到更好的策略是必不可少的。我们的奖励函数取决于行动的结果(<em class="lb">赢了游戏=='W' </em>，<em class="lb">输了游戏=='L' </em>，<em class="lb">继续游戏=='P' </em>)</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/51e7748a77f6d7cf4a24d2d7a2adc9c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*3IqCazwBbBLU4S3R-n4PIw.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx translated">环境中报酬的计算</figcaption></figure><p id="9848" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果一个经纪人找到了出口，他会得到丰厚的回报。请注意<strong class="is hj">它还取决于当前步骤</strong>，因为我们希望代理在可能较少的步骤中找到出口。所以我们赢得的越少，回报就越大。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/741405f1d9c5db6a2c5a1f3cb4d5398f.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*zfmJpP5mXW_xwEbmYJWkrA.png"/></div></figure><p id="e2ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你检查代码，你还会看到我们实现了一个<strong class="is hj"> bonus_reward。如果代理移动到没有代理已经访问过单元，奖励仅为1，否则为0。它是用来促进发现的。</strong></p><p id="19c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果一个代理移动到一个空的单元，他将被奖励-2，如果一个代理已经去过那里，和-1，如果没有人去过那里(注意，奖励仍然是负的)。</p><h1 id="ddb3" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">培训</h1><p id="6e05" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们期待的部分来了，我们的代理人会找到最佳策略吗？</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/de3e1dbc46c35e8bd59a5b6ac6a4ecaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*0oZA8yjbJbd9ePQfRkck7g.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx translated">起始迷宫</figcaption></figure><h2 id="8e07" class="le jq hi bd jr lf lg lh jv li lj lk jz jb ll lm kd jf ln lo kh jj lp lq kl lr bi translated">第0-50集</h2><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/4b00b65cdc9282113c97573e9c5d5d6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*826GtYGjV7fQIR8a9DizTw.png"/></div></figure><p id="d61d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在学习开始时，代理经常在不到3步的时间内找不到出口，当他们找到出口时，主要是因为代理发现了一个陷阱。</p><h2 id="abd2" class="le jq hi bd jr lf lg lh jv li lj lk jz jb ll lm kd jf ln lo kh jj lp lq kl lr bi translated">第51集–1000集</h2><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/d4eea25ae0d6043dcc347fce8c42858a.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*s3JtCQXMHjTODh_x5QUyxg.png"/></div></figure><p id="afa6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们开始看到一些成功，22步的成功远非最佳，代理人显然没有有效地使用传送点，但这仍然是一个进步。</p><h2 id="1284" class="le jq hi bd jr lf lg lh jv li lj lk jz jb ll lm kd jf ln lo kh jj lp lq kl lr bi translated">第1001集–20000</h2><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/07934ee4ea2d17eeee9616214610bbb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*dN6uJrljyW_WcEKwDyLhnw.png"/></div></figure><p id="5150" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AHH！这几乎是这个范围内唯一的成功。让我们看看现在是否能找到最短的路径。</p><h2 id="73b1" class="le jq hi bd jr lf lg lh jv li lj lk jz jb ll lm kd jf ln lo kh jj lp lq kl lr bi translated">第25000集及以后</h2><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/2e60ab29a2619a7731471e1ca4e703f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*PNNZwVyESyGnMGhmvLi_Tw.png"/></div></figure><p id="d093" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最短的路径可以通过使用传送器在4个步骤中完成。在25000集之后，我们训练一个模型来找到最优解。</p><h1 id="ad6c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="b52f" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">协作在强化学习中起作用，看起来很有趣。然而，最大的缺点是获得结果所需的训练时间<strong class="is hj">很长</strong>。</p><p id="a6aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你看了Open AI做的捉迷藏视频吗？他们使用了只有公司才能拥有的计算能力(结果仍然令人印象深刻)。</p></div></div>    
</body>
</html>