<html>
<head>
<title>Docker — Dev, Debug, Deploy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker —开发、调试、部署</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/docker-dev-debug-deploy-15b232eed53e?source=collection_archive---------10-----------------------#2019-12-21">https://medium.com/analytics-vidhya/docker-dev-debug-deploy-15b232eed53e?source=collection_archive---------10-----------------------#2019-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1928502cb67801c8480bce3ae53db78f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jzQaYzFydP79r3hN"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@katetandy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯特·坦迪</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="e566" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">为什么</h1><p id="595c" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">作为一名从事几个项目的开发人员，我想找到一种方法-</p><ul class=""><li id="0075" class="kr ks hi jv b jw kt ka ku ke kv ki kw km kx kq ky kz la lb bi translated">我的安装时间会尽可能快</li><li id="dc61" class="kr ks hi jv b jw lc ka ld ke le ki lf km lg kq ky kz la lb bi translated">与团队成员分享我的代码和项目设置会很容易</li><li id="ebad" class="kr ks hi jv b jw lc ka ld ke le ki lf km lg kq ky kz la lb bi translated">我希望我的开发环境尽可能接近生产环境</li></ul><p id="04b3" class="pw-post-body-paragraph jt ju hi jv b jw kt jy jz ka ku kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">所以我开始寻找这样做的方法，首先我想到了<code class="du lk ll lm ln b">Git</code>，但是<code class="du lk ll lm ln b">Git</code>的问题是设置时间不是最优的- <br/>我如何自动配置<code class="du lk ll lm ln b">Environment Variables</code>？或者为我的项目同步<code class="du lk ll lm ln b">Git hooks</code>，如果我的项目正在使用新的编程语言或版本呢？我不想在本地电脑上开始安装和管理版本..</p><p id="9d33" class="pw-post-body-paragraph jt ju hi jv b jw kt jy jz ka ku kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">也不想为任何解决方案买单。</p><p id="f776" class="pw-post-body-paragraph jt ju hi jv b jw kt jy jz ka ku kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">然后我开始考虑使用<code class="du lk ll lm ln b">Docker</code>作为我的开发环境，我可以将<code class="du lk ll lm ln b">Docker</code>作为“个人开发服务器”运行，并在<code class="du lk ll lm ln b">Docker Image</code>中配置我需要的一切——编译器/解释器、环境变量、依赖项等等，当我完成编码时，我可以在我的生产环境中使用相同的<code class="du lk ll lm ln b">Docker image</code></p><h1 id="c2f5" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">什么是<code class="du lk ll lm ln b">Docker</code></h1><p id="89e0" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">"<code class="du lk ll lm ln b">Docker</code>是一个用于开发、发布和运行应用程序的开放平台。<code class="du lk ll lm ln b">Docker</code>使您能够将应用与基础设施分离，从而快速交付软件。借助<code class="du lk ll lm ln b">Docker</code>，您可以像管理应用程序一样管理基础设施。通过利用<code class="du lk ll lm ln b">Docker's</code>方法快速交付、测试和部署代码，您可以显著减少编写代码和在生产中运行代码之间的延迟。”<br/>来自<code class="du lk ll lm ln b">Docker</code>官方文档，你可以在这里阅读更多<a class="ae iu" href="https://docs.docker.com/engine/docker-overview/" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="261c" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">建设</h1><p id="4ae2" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我用这个<code class="du lk ll lm ln b">Dockerfile</code>作为<a class="ae iu" href="https://docs.docker.com/engine/examples/running_ssh_service/" rel="noopener ugc nofollow" target="_blank">这里</a>的模板，为了构建我的<code class="du lk ll lm ln b">Docker Image</code>，我安装了<code class="du lk ll lm ln b">openssh-server</code>，这样我就可以像开发服务器一样使用它，并与我的队友分享。</p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="7aeb" class="lw iw hi ln b fi lx ly l lz ma">FROM python:3.6<br/>ARG GIT<br/><br/>RUN apt-get update &amp;&amp; apt-get install -y openssh-server<br/>RUN mkdir /var/run/sshd<br/>RUN echo 'root:MYSUPERSECRETROOTPASSWORD' | chpasswd<br/><br/># According to your linux distribution this line my differ<br/>RUN sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config<br/><br/>ENV NOTVISIBLE "in users profile"<br/>RUN echo "export VISIBLE=now" &gt;&gt; /etc/profile<br/>EXPOSE 22<br/><br/>RUN echo ' \n\<br/>git clone $GIT ~/code \n\<br/>cd ~/code \n\<br/>git pull \n\<br/>pip install -r requirements.txt' &gt; ./run.sh<br/><br/># Also configure hooks, environment variables and more<br/><br/>RUN sh ./run.sh<br/><br/>RUN echo '/usr/sbin/sshd -D' &gt;&gt; ./run.sh<br/><br/>CMD ["sh", "./run.sh"]</span></pre><p id="c20f" class="pw-post-body-paragraph jt ju hi jv b jw kt jy jz ka ku kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">当执行<code class="du lk ll lm ln b">docker build</code>时，它将<code class="du lk ll lm ln b">git clone</code>我的项目并安装<code class="du lk ll lm ln b">pip</code>依赖项以及我需要做的任何事情，我还定义了相同的<code class="du lk ll lm ln b">./run.sh</code>文件，每次我使用<code class="du lk ll lm ln b">docker run</code>时都要执行，以便让我的docker保持最新的新提交等等</p><h1 id="d591" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">奔跑</h1><p id="a2ac" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我使用这个命令来运行我的映像</p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="9846" class="lw iw hi ln b fi lx ly l lz ma">&gt; docker run -dP my_cool_docker<br/>37d6e53cb27396467a10c7361d319d28d0197a7b5dc7347bb39c251dff7403dc<br/><br/>&gt; docker port 3<br/>22/tcp -&gt; 0.0.0.0:32768<br/><br/>&gt; ssh root@localhost -p 3276<br/>The authenticity of host '[localhost]:32768 ([::1]:32768)' can't be established.<br/>ECDSA key fingerprint is SHA256:z4x3yWVSJZAoswgEa0utt5jSv0Mt0Ex6sMY8a4CFCnE.<br/>Are you sure you want to continue connecting (yes/no)? yes<br/>Warning: Permanently added '[localhost]:32768' (ECDSA) to the list of known hosts.<br/>root@localhost's password:<br/>Linux 37d6e53cb273 4.9.184-linuxkit #1 SMP Tue Jul 2 22:58:16 UTC 2019 x86_64<br/><br/>The programs included with the Debian GNU/Linux system are free software;<br/>the exact distribution terms for each program are described in the<br/>individual files in /usr/share/doc/*/copyright.<br/><br/>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br/>permitted by applicable law.<br/>root@37d6e53cb273:~# ls -l<br/>total 4<br/>drwxr-xr-x 1 root root 4096 Dec 14 09:45 code</span></pre><p id="a376" class="pw-post-body-paragraph jt ju hi jv b jw kt jy jz ka ku kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">如您所见，我使用<code class="du lk ll lm ln b">detach</code>标志和<code class="du lk ll lm ln b">expose all</code>端口运行<code class="du lk ll lm ln b">image</code>，然后使用<code class="du lk ll lm ln b">ssh</code>通过暴露的端口本地主机，输入您的超级秘密root密码，我们有了一个个人开发服务器，它实际上是运行在您个人PC上的<code class="du lk ll lm ln b">docker container</code>！</p><h1 id="0b28" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">优势</h1><ul class=""><li id="220e" class="kr ks hi jv b jw jx ka kb ke mb ki mc km md kq ky kz la lb bi translated">一次设置满足我的所有需求</li><li id="b4c6" class="kr ks hi jv b jw lc ka ld ke le ki lf km lg kq ky kz la lb bi translated">相同的开发和生产环境</li><li id="de8c" class="kr ks hi jv b jw lc ka ld ke le ki lf km lg kq ky kz la lb bi translated">易于与队友分享</li></ul><h1 id="ac0c" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">不足之处</h1><ul class=""><li id="f25e" class="kr ks hi jv b jw jx ka kb ke mb ki mc km md kq ky kz la lb bi translated">如果您的<code class="du lk ll lm ln b">container</code>崩溃，您可能会丢失数据</li><li id="40ff" class="kr ks hi jv b jw lc ka ld ke le ki lf km lg kq ky kz la lb bi translated">适合那些在生产中使用容器的人</li></ul><p id="52e1" class="pw-post-body-paragraph jt ju hi jv b jw kt jy jz ka ku kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">享受😋</p></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><blockquote class="ml mm mn"><p id="9571" class="jt ju mo jv b jw kt jy jz ka ku kc kd mp lh kg kh mq li kk kl mr lj ko kp kq hb bi translated">喜欢这个帖子？你想访问我的私人github项目？<br/>通过<a class="ae iu" href="https://www.patreon.com/eranelbaz" rel="noopener ugc nofollow" target="_blank"> <em class="hi">补丁</em> </a>支持我</p></blockquote></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><p id="70cd" class="pw-post-body-paragraph jt ju hi jv b jw kt jy jz ka ku kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated"><em class="mo">原载于2019年12月21日</em><a class="ae iu" href="https://dev.to/eranelbaz/docker-dev-debug-deploy-199l" rel="noopener ugc nofollow" target="_blank"><em class="mo">https://dev . to</em></a><em class="mo">。</em></p></div></div>    
</body>
</html>