<html>
<head>
<title>NLP — Sentence Extraction using NLTK: TextRank Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NLP——使用NLTK: TextRank算法的句子抽取</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentence-extraction-using-textrank-algorithm-7f5c8fd568cd?source=collection_archive---------2-----------------------#2019-09-05">https://medium.com/analytics-vidhya/sentence-extraction-using-textrank-algorithm-7f5c8fd568cd?source=collection_archive---------2-----------------------#2019-09-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0fb6" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Python和NLTK轻松实现</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/b3443fcfeedb28e648d10ef803b55904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EmCqALqVmu8Qa7zp"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@northfolk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">北人</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="ee9a" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="b0f7" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><strong class="ki hj"> TextRank </strong>是基于<strong class="ki hj"> PageRank </strong>的算法，常用于关键词抽取和文本摘要。</p><p id="4e41" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们将用Python实现用于句子提取的<strong class="ki hj"> TextRank算法</strong>。该算法的关键是从文本中提取最相关的句子，这是文摘的重要任务之一。</p><h2 id="79b5" class="lh jp hi bd jq li lj lk ju ll lm ln jy kp lo lp ka kt lq lr kc kx ls lt ke lu bi translated">但是，让我们不要重新发明轮子</h2><p id="861c" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这篇文章的先决条件是理解<strong class="ki hj"> PageRank算法，</strong>你可以从以下关于Medium的文章中读到:</p><blockquote class="lv lw lx"><p id="0f7f" class="kg kh ly ki b kj lc ij kl km ld im ko lz le kr ks ma lf kv kw mb lg kz la lb hb bi translated">PageRank (PR)是一种用于计算网页权重的算法，它被<a class="ae jn" href="https://en.wikipedia.org/wiki/Google_Search" rel="noopener ugc nofollow" target="_blank">谷歌搜索</a>用来在<a class="ae jn" href="https://en.wikipedia.org/wiki/Search_engine" rel="noopener ugc nofollow" target="_blank">搜索引擎</a>的结果中对<a class="ae jn" href="https://en.wikipedia.org/wiki/Webpages" rel="noopener ugc nofollow" target="_blank">网页</a>进行排名。</p></blockquote><p id="6893" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">请参考以下文章之一，以获得基本的了解:</p><p id="df2a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><a class="mc md ge" href="https://medium.com/u/c7d314e61b4f?source=post_page-----7f5c8fd568cd--------------------------------" rel="noopener" target="_blank"> Brendan Massey </a>用大量图片解释了PageRank算法背后的症结所在。</p><div class="me mf ez fb mg mh"><a rel="noopener follow" target="_blank" href="/hackernoon/implementing-googles-pagerank-algorithm-88069314fb3d"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">实现Google的Pagerank算法</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">作为一名学习编程的学生，在某种程度上也是计算机科学的学生，我经常发现新的和令人兴奋的历史…</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">medium.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv jh mh"/></div></div></a></div><p id="d0a5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">徐良用python实现很好地解释了这一点。</p><div class="me mf ez fb mg mh"><a href="https://towardsdatascience.com/textrank-for-keyword-extraction-by-python-c0bae21bcec0" rel="noopener follow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">Python关键字提取的文本排名</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">Python和spaCy的一个scratch实现，帮助你理解用于关键词提取的PageRank和TextRank。</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">towardsdatascience.com</p></div></div><div class="mq l"><div class="mw l ms mt mu mq mv jh mh"/></div></div></a></div><p id="db7d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们在做什么？</p><p id="1de2" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们将尝试使用TextRank算法从文本片段中提取顶级句子。</p><pre class="iy iz ja jb fd mx my mz na aw nb bi"><span id="d9e0" class="lh jp hi my b fi nc nd l ne nf"><strong class="my hj">Those Who Are Resilient Stay In The Game Longer<br/>“On the mountains of truth you can never climb in vain: either you will reach a point higher up today, or you will be training your powers so that you will be able to climb higher tomorrow.” — Friedrich Nietzsche<br/>Challenges and setbacks are not meant to defeat you, but promote you. However, I realise after many years of defeats, it can crush your spirit and it is easier to give up than risk further setbacks and disappointments. Have you experienced this before? To be honest, I don’t have the answers. I can’t tell you what the right course of action is; only you will know. However, it’s important not to be discouraged by failure when pursuing a goal or a dream, since failure itself means different things to different people. To a person with a Fixed Mindset failure is a blow to their self-esteem, yet to a person with a Growth Mindset, it’s an opportunity to improve and find new ways to overcome their obstacles. Same failure, yet different responses. Who is right and who is wrong? Neither. Each person has a different mindset that decides their outcome. Those who are resilient stay in the game longer and draw on their inner means to succeed.</strong></span></pre><p id="1159" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">方法:</strong></p><p id="9ec7" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们将分三步完成。是的，答应我！(好吧，可能4。)</p><ol class=""><li id="6d6a" class="ng nh hi ki b kj lc km ld kp ni kt nj kx nk lb nl nm nn no bi translated"><strong class="ki hj">对每个句子中的单词进行分词</strong></li></ol><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="bd21" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这将生成一个<strong class="ki hj">标记化句子列表列表:</strong></p><pre class="iy iz ja jb fd mx my mz na aw nb bi"><span id="adfc" class="lh jp hi my b fi nc nd l ne nf">[['Those', 'Who', 'Are', 'Resilient', 'Stay', 'In', 'The', 'Game', 'Longer', '*', '“', 'On', 'the', 'mountains', 'of', 'truth', 'you', 'can', 'never', 'climb', 'in', 'vain', ':', 'either', 'you', 'will', 'reach', 'a', 'point', 'higher', 'up', 'today', ',', 'or', 'you', 'will', 'be', 'training', 'your', 'powers', 'so', 'that', 'you', 'will', 'be', 'able', 'to', 'climb', 'higher', 'tomorrow.', '”', '—', 'Friedrich', 'Nietzsche', 'Challenges', 'and', 'setbacks', 'are', 'not', 'meant', 'to', 'defeat', 'you', ',', 'but', 'promote', 'you', '.'], ...]</span></pre><p id="04f1" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> 2。构建相似性矩阵</strong></p><p id="8678" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们会用<a class="ae jn" href="https://www.machinelearningplus.com/nlp/cosine-similarity/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj">余弦相似度</strong> </a>来求两个句子之间的相似度，这个相似度会用来衡量两个句子之间的距离。</p><blockquote class="lv lw lx"><p id="45ff" class="kg kh ly ki b kj lc ij kl km ld im ko lz le kr ks ma lf kv kw mb lg kz la lb hb bi translated"><strong class="ki hj">余弦相似度:</strong>余弦相似度是一种度量，用于确定文档的相似程度，而不考虑它们的大小。</p><p id="0e1f" class="kg kh ly ki b kj lc ij kl km ld im ko lz le kr ks ma lf kv kw mb lg kz la lb hb bi translated">余弦相似度作为一种相似度度量，和常用词的数量有什么不同？</p><p id="30e0" class="kg kh ly ki b kj lc ij kl km ld im ko lz le kr ks ma lf kv kw mb lg kz la lb hb bi translated">当绘制在多维空间上时，其中每个维度对应于文档中的一个单词，余弦相似性捕捉文档的方向(角度)而不是大小。</p></blockquote><p id="203a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">即。考虑下面一对句子及其余弦相似度</p><pre class="iy iz ja jb fd mx my mz na aw nb bi"><span id="5331" class="lh jp hi my b fi nc nd l ne nf"><strong class="my hj">1. "NLP is interesting field of AI"</strong>, And <br/>   <strong class="my hj">"NLP makes machine understand language"<br/>   </strong>Consine Similarity: <strong class="my hj">0.7238730093922876</strong></span><span id="b006" class="lh jp hi my b fi nr nd l ne nf"><strong class="my hj">2</strong>. <strong class="my hj">"Alan turing proposed the imitation game"</strong>, And <br/>   <strong class="my hj">"Alan turing hated other games"<br/>   </strong>Consine Similarity: <strong class="my hj">0.91504896898793</strong></span><span id="aa22" class="lh jp hi my b fi nr nd l ne nf"><strong class="my hj">3. "NLP is not just about chatbots"</strong>, And <br/>   <strong class="my hj">"NLP makes chatbots widely used"<br/>   </strong>Consine Similarity: <strong class="my hj">0.7764453512724155</strong></span><span id="410c" class="lh jp hi my b fi nr nd l ne nf"><strong class="my hj">4. "NLP is interesting field of AI"</strong>, And <br/>   <strong class="my hj">"NLP is interesting field of AI"<br/>   </strong>Consine Similarity: <strong class="my hj">1.0</strong></span><span id="51a0" class="lh jp hi my b fi nr nd l ne nf"><strong class="my hj">5. "Those Who Are Resilient Stay In The Game Longer"</strong>, And <br/>   <strong class="my hj">"01234567890"<br/>   </strong>Consine Similarity: <strong class="my hj">0.0</strong></span></pre><p id="20fa" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">类似地，我们需要测量所有句子之间的相似性矩阵。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="e2ad" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们将得到如下相似矩阵:</p><pre class="iy iz ja jb fd mx my mz na aw nb bi"><span id="62b2" class="lh jp hi my b fi nc nd l ne nf">[[0.         0.11395845 0.35076499 0.10679337 0.22030768 0.09455048<br/>  0.08854208 0.05757988 0.09019807 0.04691224 0.05544081 0.20244412]</span><span id="2a7d" class="lh jp hi my b fi nr nd l ne nf"> [0.09867469 0.         0.         0.10985716 0.10198264 0.11671565<br/>  0.11710577 0.10661723 0.22268582 0.08686458 0.03421881 0.08820086]...</span></pre><p id="c88d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> 3。运行PageRank算法</strong></p><p id="bbb1" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在我们有了相似矩阵，我们可以对它运行PageRank算法。如果你已经按照<a class="ae jn" href="https://towardsdatascience.com/textrank-for-keyword-extraction-by-python-c0bae21bcec0" rel="noopener" target="_blank"> <strong class="ki hj"> PageRank的文章</strong> </a>做了，下面的代码也差不多，很好理解。</p><p id="3a5a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们将生成PageRank矩阵，它将包含所有句子的得分，其中最重要的句子得分最高。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="ce9c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们将得到如下的PageRank矩阵:</p><pre class="iy iz ja jb fd mx my mz na aw nb bi"><span id="51ed" class="lh jp hi my b fi nc nd l ne nf">[1.26778728 1.09189214 0.49899918 1.24743264 1.08652989 1.24053865<br/> 1.24198464 0.99690567 0.61024186 0.81140037 0.85049162 1.05579606]</span></pre><p id="dda1" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> 4。提取热门句子</strong></p><p id="e590" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">瞧，我们完成了。你已经猜到这一步了吧？</p><p id="88c6" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在我们将从PageRank矩阵中提取顶级句子。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="9f49" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">以下是前5个句子:{句子:得分}对</p><pre class="iy iz ja jb fd mx my mz na aw nb bi"><span id="76d0" class="lh jp hi my b fi nc nd l ne nf">{'\nThose Who Are Resilient Stay In The Game Longer\n“On the mountains of truth you can never climb in vain: either you will reach a point higher up today, or you will be training your powers so that you will be able to climb higher tomorrow.” — Friedrich Nietzsche\nChallenges and setbacks are not meant to defeat you, but promote you.': <strong class="my hj">1.2712476366837975</strong>,</span><span id="732c" class="lh jp hi my b fi nr nd l ne nf"> 'However, I realise after many years of defeats, it can crush your spirit and it is easier to give up than risk further setbacks and disappointments.': <strong class="my hj">1.0914952900297563</strong>,</span><span id="8613" class="lh jp hi my b fi nr nd l ne nf"> 'However, it’s important not to be discouraged by failure when pursuing a goal or a dream, since failure itself means different things to different people.': <strong class="my hj">1.2401359537858996</strong>,</span><span id="2c5e" class="lh jp hi my b fi nr nd l ne nf"> 'To a person with a Fixed Mindset failure is a blow to their self-esteem, yet to a person with a Growth Mindset, it’s an opportunity to improve and find new ways to overcome their obstacles.': <strong class="my hj">1.2415147486210913</strong>,</span><span id="6846" class="lh jp hi my b fi nr nd l ne nf">'To be honest, I don’t have the answers.': <strong class="my hj">1.2468967412932273</strong>}</span></pre><h1 id="0036" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">#一切都在一个地方:和平！</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="np nq l"/></div></figure><h2 id="afcb" class="lh jp hi bd jq li lj lk ju ll lm ln jy kp lo lp ka kt lq lr kc kx ls lt ke lu bi translated">找到完整的代码<a class="ae jn" href="https://github.com/akashp1712/nlp-akash/blob/master/text-summarization/text_rank_sentences.py" rel="noopener ugc nofollow" target="_blank">在这里</a>并且玩它！</h2><div class="me mf ez fb mg mh"><a href="https://github.com/akashp1712/nlp-akash/blob/master/text-summarization/text_rank_sentences.py" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">akashp1712/nlp-akash</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">github.com</p></div></div></div></a></div><blockquote class="ns"><p id="7468" class="nt nu hi bd nv nw nx ny nz oa ob lb dx translated">技术不会自动改进，当许多人努力工作使它变得更好时，它就会改进——埃隆·马斯克</p></blockquote></div></div>    
</body>
</html>