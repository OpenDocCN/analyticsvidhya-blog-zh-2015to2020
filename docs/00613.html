<html>
<head>
<title>Image Recognition using Pre-trained Xception Model in 5 steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用预训练的异常模型分5步进行图像识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-recognition-using-pre-trained-xception-model-in-5-steps-96ac858f4206?source=collection_archive---------1-----------------------#2019-08-16">https://medium.com/analytics-vidhya/image-recognition-using-pre-trained-xception-model-in-5-steps-96ac858f4206?source=collection_archive---------1-----------------------#2019-08-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8bd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">读者们好，</p><p id="9a40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将带你用python和Keras深度学习库在ImageNet数据库上预训练的卷积神经网络(具体使用<strong class="ih hj"> Xception Model </strong>)来预测图像。</p><p id="f9ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是ImageNet？</strong></p><p id="f2a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ImageNet是一个旨在手动标记和分类图像的项目。在深度学习和卷积神经网络领域，我们将ImageNet简称为“ImageNet大规模视觉识别挑战”。</p><p id="ac11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ImageNet项目的主要目标是训练一个模型，该模型可以将输入图像分类为1000个独立的对象类别。</p><p id="62ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类别包括狗、猫、鱼的种类，车辆类型包括车辆部件如车轮、方向盘等了解更多类别<a class="ae jd" href="https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a" rel="noopener ugc nofollow" target="_blank">参考</a></p><p id="7546" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些模型在大约120万张图像和另外5万张用于验证的图像以及10万张用于测试的图像上进行训练。</p><p id="c840" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于图像识别，我们可以使用Keras核心库中可用的预训练模型。像<strong class="ih hj"> VCG16、VCG19、Resnet50、Inception V3、Xception </strong>等型号</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="3414" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们选择了预先训练的异常模型进行图像分类</p><h1 id="4d5d" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">例外模型</h1><p id="a9ae" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">例外模式是由弗朗索瓦·乔莱提出的。Xception是inception架构的扩展，它用深度方向可分离的卷积代替了标准的Inception模块。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es ko"><img src="../Images/e9b1f5f0d7699a6136f6db78c1b755ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*459jKxLPM9R-Y_z0y8SXug.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">例外的架构(入口流&gt;中间流&gt;出口流)</figcaption></figure><h2 id="d9e8" class="la jm hi bd jn lb lc ld jr le lf lg jv iq lh li jz iu lj lk kd iy ll lm kh ln bi translated">ImageNet:exception模型与其他模型的比较</h2><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lo"><img src="../Images/ffa60e509513e7a9061021db1fb12463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tCTo6M1E5rZ4_ARnPcv-gQ.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">ImageNet: Xception具有最高的准确性</figcaption></figure><p id="8c45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们使用异常模型编写一个用于图像识别的python脚本</p><p id="c4fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤1:安装所需的依赖关系</strong></p><p id="a63a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于图像识别，我们依赖于库Numpy、Matplotlib(用于可视化)、tf-explain(用于导入预训练的模型)、Tensorflow和Keras作为后端</p><p id="cc64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开命令提示符(cmd)&gt;在下面运行命令</p><pre class="kp kq kr ks fd lt lu lv lw aw lx bi"><span id="b550" class="la jm hi lu b fi ly lz l ma mb">pip install tf-explain</span></pre><p id="6fb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:导入包</strong></p><pre class="kp kq kr ks fd lt lu lv lw aw lx bi"><span id="b9f5" class="la jm hi lu b fi ly lz l ma mb">#import libraries</span><span id="26b4" class="la jm hi lu b fi mc lz l ma mb">import numpy as np<br/>import tensorflow as tf<br/>import matplotlib.pyplot as plt<br/>from tf_explain.core.activations import ExtractActivations<br/>from tensorflow.keras.applications.xception import decode_predictions<br/>%matplotlib inline</span></pre><p id="3054" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤3:加载预训练模型</strong></p><pre class="kp kq kr ks fd lt lu lv lw aw lx bi"><span id="fa16" class="la jm hi lu b fi ly lz l ma mb">#load pre trained Xception model</span><span id="1bd3" class="la jm hi lu b fi mc lz l ma mb">model=tf.keras.applications.xception.Xception(weights='imagenet',include_top=True)</span><span id="8da6" class="la jm hi lu b fi mc lz l ma mb">#Summary of Xception Model<br/>print(model.summary)</span></pre><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es md"><img src="../Images/fc6bb2581aad873d151c755b44e3403c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*581Oyh-O0W0xdpfULyo3Dw.jpeg"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">模型摘要</figcaption></figure><p id="9bb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤4:加载并预处理样本输入图像</strong></p><pre class="kp kq kr ks fd lt lu lv lw aw lx bi"><span id="2e52" class="la jm hi lu b fi ly lz l ma mb">#loading and preprocessing cat image</span><span id="53c3" class="la jm hi lu b fi mc lz l ma mb">IMAGE_PATH='./lion.jpg'<br/>img=tf.keras.preprocessing.image.load_img(IMAGE_PATH,target_size=(299,299))<br/>img=tf.keras.preprocessing.image.img_to_array(img)</span><span id="81ef" class="la jm hi lu b fi mc lz l ma mb">#view the image<br/>plt.imshow(img/255.)</span></pre><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es me"><img src="../Images/c0d97fee495c4b03d39b0c08a8026d80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*NqBoxOPFttwjhzYB8X5A-w.jpeg"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">输入图像</figcaption></figure><h2 id="e9a5" class="la jm hi bd jn lb lc ld jr le lf lg jv iq lh li jz iu lj lk kd iy ll lm kh ln bi translated">步骤5:预测图像中的对象</h2><p id="86b0" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">现在，让我们使用在IDE中成功加载的异常模型，对输入图像进行前5个预测。</p><pre class="kp kq kr ks fd lt lu lv lw aw lx bi"><span id="074d" class="la jm hi lu b fi ly lz l ma mb">import requests</span><span id="4b06" class="la jm hi lu b fi mc lz l ma mb">#fetching labels from Imagenet  <br/>response=requests.get('<a class="ae jd" href="https://storage.googleapis.com/download.tensorflow.org/data/imagenet_class_index.json'" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/download.tensorflow.org/data/imagenet_class_index.json'</a>)<br/>imgnet_map=response.json()</span><span id="3c74" class="la jm hi lu b fi mc lz l ma mb">imgnet_map={v[1]:k for k, v in imgnet_map.items()}</span><span id="b43d" class="la jm hi lu b fi mc lz l ma mb">#make model predictions</span><span id="cd70" class="la jm hi lu b fi mc lz l ma mb">img=tf.keras.applications.xception.preprocess_input(img)<br/>predictions=model.predict(np.array([img]))<br/>decode_predictions(predictions,top=5)</span></pre><p id="4c8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结果</strong></p><p id="aaed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从下面的片段中我们发现，Xception模型预测图像由概率为0.87(87%)的<strong class="ih hj">狮子</strong>和概率为0.001(小于1%)的其他动物组成。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es mf"><img src="../Images/fce3839574469ce38c9f1b69e7b837d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*AGyt-f4zliUw5D3uEs5NNA.jpeg"/></div></figure><p id="c2c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考</p><ol class=""><li id="5c27" class="mg mh hi ih b ii ij im in iq mi iu mj iy mk jc ml mm mn mo bi translated">例外:深度可分卷积深度学习(<a class="ae jd" href="https://arxiv.org/abs/1610.02357" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1610.02357</a></li><li id="06da" class="mg mh hi ih b ii mp im mq iq mr iu ms iy mt jc ml mm mn mo bi translated">ImageNet(<a class="ae jd" href="http://www.image-net.org/" rel="noopener ugc nofollow" target="_blank">http://www.image-net.org/</a>)</li></ol></div></div>    
</body>
</html>