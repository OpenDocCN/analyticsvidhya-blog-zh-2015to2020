<html>
<head>
<title>Random Forest and ANN Model with Oversampling Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">过采样数据下的随机森林和人工神经网络模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/random-forest-and-ann-model-with-oversampling-data-b7adde23e55f?source=collection_archive---------5-----------------------#2020-10-28">https://medium.com/analytics-vidhya/random-forest-and-ann-model-with-oversampling-data-b7adde23e55f?source=collection_archive---------5-----------------------#2020-10-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5095" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用SMOTE(合成少数过采样技术)过采样数据时，这些模型的性能如何相互比较</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="412d" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">介绍</h1><p id="c927" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated"><em class="kn">本文是印度尼西亚通信与信息部(Kominfo)35天奖学金课程中6天挑战的成果。</em></p><p id="c88c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">真实世界的数据不是正态分布的，它总是向右或向左倾斜(图1。)，我们如何处理这样的数据？只需丢弃较高比例的数据以使其平衡，但如果数据严重失衡，如欺诈案件或保险索赔，在这种情况下，我们可以对少数类使用过采样技术，以制作类似真实的数据，最终数据具有相同的分布。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es ko"><img src="../Images/6695a01e58756465a3733b32e67523a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*Jwpotn5OKYfkzoGQFYKunA.jpeg"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图一。皮尔逊模式偏度(<a class="ae la" href="https://www.statisticshowto.com/pearson-mode-skewness/" rel="noopener ugc nofollow" target="_blank">信用</a></figcaption></figure><p id="d2d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kn">什么是SMOTE？</em> </strong></p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es lb"><img src="../Images/9947919b0c7d2092d34cdad02c207ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*gC4aDbccu41QD7ZSgpuYFg.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图二。SMOTE ( <a class="ae la" href="https://imbalanced-learn.readthedocs.io/en/stable/over_sampling.html#cbhk2002" rel="noopener ugc nofollow" target="_blank">信用</a>)</figcaption></figure><blockquote class="lc ld le"><p id="b633" class="if ig kn ih b ii ij ik il im in io ip lf ir is it lg iv iw ix lh iz ja jb jc hb bi translated">合成少数过采样(SMOTE)不是复制少数观察结果(如违约者、欺诈者、投机者)，而是根据现有的少数观察结果创建合成观察结果(<a class="ae la" href="https://arxiv.org/abs/1106.1813" rel="noopener ugc nofollow" target="_blank"> Chawla等人，2002 </a>)。</p></blockquote><p id="fe1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae la" href="https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/#:~:text=This%20is%20a%20type%20of,for%20oversampling%20imbalanced%20classification%20datasets." rel="noopener ugc nofollow" target="_blank">特别是</a>，首先从少数民族中随机选择一个例子。然后找到该示例的最近邻居的<em class="kn"> k </em>(通常<em class="kn"> k=5 </em>)。选择随机选择的邻居，并在特征空间中两个示例之间的随机选择点处创建合成示例(图2。)</p><p id="e552" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，可以简单地从少数特征空间数据中用KNN方法建立新的数据库。</p><h1 id="3584" class="jk jl hi bd jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh bi translated">数据集</h1><p id="cce5" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">数据集是来自Kaggle的<a class="ae la" href="https://www.kaggle.com/mhdzahier/travel-insurance" rel="noopener ugc nofollow" target="_blank">旅游保险</a>由63326个实例组成，具有10个特征:</p><ul class=""><li id="1645" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated">代理类型，</li><li id="8795" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">旅游保险代理机构的分销渠道(分销。频道)</li><li id="eeec" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">旅游保险产品名称(产品。姓名)</li><li id="f4cb" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">旅行持续时间(持续时间)</li><li id="557a" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">旅行目的地(目的地)</li><li id="3484" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">旅游保险单销售额(净额。销售)</li><li id="e41f" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">旅游保险代理佣金(佣金)</li><li id="91e1" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">被保险人的性别(性别)</li><li id="cf08" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">被保险人年龄(年龄)</li></ul><p id="a400" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和1个目标列(声称是/否)，目标严重失衡(图3。左)</p><h1 id="cc22" class="jk jl hi bd jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh bi translated">方法</h1><h2 id="3c7c" class="mb jl hi bd jm mc md me jq mf mg mh ju iq mi mj jy iu mk ml kc iy mm mn kg mo bi translated">预处理</h2><p id="04c0" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">我们对数据进行了一些处理，</p><ul class=""><li id="154a" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated">在性别栏中添加第三个类别以填充NaN值，因为该栏有太多的NaN，所以它有男性/女性和未披露的类别。</li><li id="7608" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">替换年龄和持续时间列中的异常值，超过100岁的年龄由数据的平均年龄替换，具有负值的持续时间列由0替换。</li><li id="1624" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">将目标“否”的实例数量减少到只有10.000个实例，以便“是”的比例更高。</li></ul><div class="kp kq kr ks fd ab cb"><figure class="mp kt mq mr ms mt mu paragraph-image"><img src="../Images/388003604a02d62e607d111648aa0c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*PoNH4iv01EyxqGBAq4V5yA.png"/></figure><figure class="mp kt mv mr ms mt mu paragraph-image"><img src="../Images/5dbac85d07a0b5801cbe5b58244c8047.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*0jlV19SFK9Sk4kFxd8Qceg.png"/><figcaption class="kw kx et er es ky kz bd b be z dx mw di mx my translated">图3。缩小前后的标签分布(左)</figcaption></figure></div><p id="3af8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">过采样(SMOTE) </strong></p><p id="1c6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使模型对每个类别更加稳健，使用过采样技术SMOTE来平衡每个类别标签的数据集(图4。).</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es mz"><img src="../Images/4ca8a2bf922e177f371208e2a621510b.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*h7pTQdez4JXy7RH7L1Tt5g.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图4。SMOTE过采样</figcaption></figure><p id="dbec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们看一下数据分布，每个类都有相同数量的标签(图5 &amp; 6)。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es na"><img src="../Images/03d55533f89ba4b9da447c30e5bc586b.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*Gp-GRpewVlsc6ObLVA1uTg.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图5。过采样前</figcaption></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es nb"><img src="../Images/6e533b1f5bd51c6a2476e835f3e8db5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*iFhakfN3Y8ISexv-sg5Z7Q.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图6。过采样后</figcaption></figure><h1 id="fa49" class="jk jl hi bd jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh bi translated">系统模型化</h1><h2 id="b386" class="mb jl hi bd jm mc md me jq mf mg mh ju iq mi mj jy iu mk ml kc iy mm mn kg mo bi translated">随机森林</h2><p id="2c82" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">使用过采样数据集，从其他算法中选择后，选择随机森林(图7。)</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es nc"><img src="../Images/28c41c3295b40c176d9c419fe7940ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*JXJ-83O6oXl20xpW0AqumA.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图7。算法选择</figcaption></figure><p id="84bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，随机森林algirthm适合所有训练数据(图8。)，使用从RandomSearchCV获得的最佳参数</p><blockquote class="lc ld le"><p id="b19c" class="if ig kn ih b ii ij ik il im in io ip lf ir is it lg iv iw ix lh iz ja jb jc hb bi translated">最佳参数{ ' n _ estimates ':400，' max_depth': 8}</p></blockquote><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="er es nd"><img src="../Images/5b7124aa6a8b41f104234cb0d2cf57fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MVGJqGtgqkecoIMh7ih2vw.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图8。随机森林拟合</figcaption></figure><h2 id="4aed" class="mb jl hi bd jm mc md me jq mf mg mh ju iq mi mj jy iu mk ml kc iy mm mn kg mo bi translated">人工神经网络</h2><p id="4f17" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">人工神经网络结构包括1个输入层、4个隐藏层和1个输出层，其中3个为避免过度拟合而减少的层(图9和10。)</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="er es ni"><img src="../Images/8b0354063da88a61a28711b7749fc26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*M3e32mCGdftpkNCNrRNDAw.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图9。人工神经网络架构</figcaption></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="er es nj"><img src="../Images/8faceb49f949cd27d58483dd64565e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pguo-kHkD8b-OfCXB1HEhA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图10。人工神经网络代码</figcaption></figure><h1 id="8c18" class="jk jl hi bd jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh bi translated">结果</h1><p id="c454" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">这个结果来自以前从未见过的测试集</p><h2 id="ff93" class="mb jl hi bd jm mc md me jq mf mg mh ju iq mi mj jy iu mk ml kc iy mm mn kg mo bi translated">随机森林</h2><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es nk"><img src="../Images/2ce722c103cab01f20c5cdaf470cc2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*cXlc8gHivTI7viNYccWhew.png"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es nl"><img src="../Images/a6ab4b81ac608860ec59f48153344067.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*GTxX_64D-D94gZffQLDICw.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图11。随机森林分类报告</figcaption></figure><p id="c8b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林的类0的F1值为0.91，类1的F1值为0.4。过采样技术有效，但不是很好，模型仍无法对类1进行分类，满足结果仍低于0.5。</p><h2 id="0eae" class="mb jl hi bd jm mc md me jq mf mg mh ju iq mi mj jy iu mk ml kc iy mm mn kg mo bi translated">安</h2><p id="5f83" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">从训练曲线来看，结果是比较令人满意的，训练和验证仍然在同一个方向线上。</p><div class="kp kq kr ks fd ab cb"><figure class="mp kt nm mr ms mt mu paragraph-image"><img src="../Images/7056dea4023cfd46ea89e1bec50b2058.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*z7sr6RjtsB-vwdF6_fe8YA.png"/></figure><figure class="mp kt nn mr ms mt mu paragraph-image"><img src="../Images/365fe48374a9857c5d8e6c66fb84f2e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*97SaVp8PYusIzTwodwh5ZQ.png"/><figcaption class="kw kx et er es ky kz bd b be z dx mw di mx my translated">图12。培训损失(左)培训AUC(右)</figcaption></figure></div><p id="500f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用测试集怎么样，结果如下所示(图13)</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es no"><img src="../Images/61f3233ca2744f62e78665e28d86865e.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*Y6YrGZhhsmVkN_1tQJyd_Q.png"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es np"><img src="../Images/3738f3afd6e25c280d5099dd58e8c4e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*9ypNCdkoaVwhzvpTi9pf7A.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">图13。人工神经网络分类结果</figcaption></figure><p id="208c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人工神经网络模型在这个问题上并不是很好，它为1类得到了0.95的F1分数，但仅为0.17。随机森林打败了这个模型。</p><h1 id="aeca" class="jk jl hi bd jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc kd lm kf kg kh bi translated">结论</h1><p id="48c3" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">从这次挑战中，我们得到了一些结论:</p><ul class=""><li id="0d8a" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated">您的数据确实需要预处理</li><li id="2c8e" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">过采样通过使用KNN制作合成数据来降低工作效率</li><li id="434d" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">过多的过采样数据来填补类别不平衡的差距并不能真正帮助模型学习真实世界的数据</li><li id="cc23" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">在这个实验中，兰登森林打败了安</li></ul><p id="381a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多关于我的项目请访问<a class="ae la" href="https://github.com/said-rasidin" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="kn">我的github </em> </strong> </a></p></div></div>    
</body>
</html>