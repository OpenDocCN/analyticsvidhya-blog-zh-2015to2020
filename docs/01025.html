<html>
<head>
<title>Exploring Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploring-linear-regression-474752ba1761?source=collection_archive---------14-----------------------#2019-09-25">https://medium.com/analytics-vidhya/exploring-linear-regression-474752ba1761?source=collection_archive---------14-----------------------#2019-09-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/25d8b6cb9e00e79f6ebccf8594b3f7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*By7ORAAzkszPJ-220E7m5g.png"/></div></div></figure><div class=""/><div class=""><h2 id="fd3b" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">单一和多元</h2></div><p id="8415" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">线性回归是一种统计模型，检查两个或多个变量之间的关系。感兴趣的变量是我们的因变量(<strong class="jk hu"> y </strong>)、我们的目标和我们的自变量(<strong class="jk hu"> x </strong>)，也称为我们的特征。值得注意的是，线性回归用于预测数值(连续)数据。</p><p id="fa81" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">首先，我们来看一个线性回归模型。</p><p id="0fd4" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">线性关系可以是以下两种情况之一:</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="146d" class="kn ko ht kj b fi kp kq l kr ks">positive — spending more on advertising to increase sales<br/>negative — increased surveillance decreases instances of theft</span></pre><p id="fabf" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">y和x之间的关系由以下等式表示</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="44db" class="kn ko ht kj b fi kp kq l kr ks"><strong class="kj hu">y</strong> = <strong class="kj hu">mx</strong> + <strong class="kj hu">b</strong></span><span id="1cd9" class="kn ko ht kj b fi kt kq l kr ks"><strong class="kj hu">b (alpha)<br/>m (beta)</strong></span></pre><p id="72a8" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">其中，因变量<strong class="jk hu"> y </strong>是我们试图预测的变量，自变量<strong class="jk hu"> x </strong>是我们用来进行预测的变量。<strong class="jk hu"> m </strong>是我们回归线的斜率(正或负)，代表<strong class="jk hu"> x </strong>对<strong class="jk hu"> y </strong>的影响。<strong class="jk hu"> b </strong>是从我们的数据中创建的常数。</p><p id="7117" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">首先，让我们导入必要的库和我们将在示例中使用的advertising.csv <a class="ae ku" href="http://faculty.marshall.usc.edu/gareth-james/ISL/data.html" rel="noopener ugc nofollow" target="_blank">数据集</a>，并快速浏览一下我们的数据集。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kv"><img src="../Images/17ebf240370d1f12a0b94415f3003832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-_FfuKfxbW2ih_TcwfFZQ.png"/></div></div></figure><p id="fe2d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们有三个独立变量可以用来预测销售额，但如前所述，我们将着眼于一个变量。电视。</p><p id="7169" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">接下来，我们将使用导入的“statsmodel”库初始化并拟合我们的线性回归模型。我们的第一个模型将包括根据电视广告的花费来预测销售额。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kw"><img src="../Images/e280e23331c049a6fc6c494e14de6b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lFBQIZXiezoDExGrih7HRQ.png"/></div></div></figure><p id="476a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我将在这里花一点时间来谈论我们正在运行的线性回归模型的具体类型，因为您可能已经注意到smf.ols，其中smf是我们的统计库，ols代表<a class="ae ku" href="https://www.encyclopedia.com/social-sciences/applied-and-social-sciences-magazines/ordinary-least-squares-regression" rel="noopener ugc nofollow" target="_blank">普通最小二乘法</a>。这种方法“通过最小化配置为直线的因变量的观察值和预测值之差的平方和来估计关系。”</p><p id="13ef" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">视觉上的OLS是这样的:</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kx"><img src="../Images/826aa1583f080a1a212a2c17161ed357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Oj2SliPANHCxVlcLhObXg.png"/></div></div></figure><p id="c213" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae ku" href="http://setosa.io/ev/ordinary-least-squares-regression/" rel="noopener ugc nofollow" target="_blank">普通最小二乘回归模型</a></p><p id="ec09" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">请注意，测量每个彩色点(真实数据点)和红线(回归线)之间的距离，然后平方。OLS试图找到最佳拟合线，使回归线产生的平方距离的面积最小。你的OLS结果越大，你的模型预测目标的效率就越高。</p><p id="8129" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">“还有许多其他比OLS复杂得多的预测技术，如逻辑回归、加权最小二乘回归、稳健回归和不断增长的非参数方法家族。”<br/> — — <a class="ae ku" href="http://twitter.com/vicapow" rel="noopener ugc nofollow" target="_blank">维克多·鲍威尔</a>和<a class="ae ku" href="http://twitter.com/lewislehe" rel="noopener ugc nofollow" target="_blank">路易斯·乐和</a></p><p id="e05b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">之后，我们将立即运行model.params，以便方便地标记我们的<strong class="jk hu"> b </strong>和<strong class="jk hu"> m </strong>值。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ky"><img src="../Images/666d7744087260410eb58f131d9940b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KaBz3ytNJYMLDRMyJjlR7g.png"/></div></div></figure><p id="3bd8" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">回想y = mx + b我们现在有<strong class="jk hu">销量</strong>=<strong class="jk hu">0.047 *电视</strong> + <strong class="jk hu"> 7.032。</strong></p><p id="3422" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">为了更深入地总结我们的模型，我们将运行print model.summary()</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kz"><img src="../Images/2479d62c42b985afe33d64d2ef579354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*56MwqWnNgeONPnEZ6e_w6A.png"/></div></div></figure><p id="3638" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">结果中有很多信息，但目前的关键要点是位于截距和TV行末端的R平方(右上角)和<a class="ae ku" href="https://towardsdatascience.com/a-very-friendly-introduction-to-confidence-intervals-9add126e714" rel="noopener" target="_blank">置信区间</a>。r平方是一个. 612并不可怕，但可以改善。我们还有两个变量可以添加(广播、报纸)。我们的置信区间很窄，但也可以使用改进。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="5dad" class="kn ko ht kj b fi kp kq l kr ks">R-squared is a statistical measure of how close the data are to the fitted regression line</span></pre><p id="7e90" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">此时，我们的回归模型已经拟合(训练)完毕，因此我们可以继续使用之前陈述的等式预测销售额，或者我们可以设置一个新变量等于model.predict()并绘制我们的结果。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es la"><img src="../Images/b6e006980a1077170c95fbeb4d5a92ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V5oUouw2gZKWS_IzM-0bRw.png"/></div></div></figure><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lb"><img src="../Images/c307000a2b08063ff4b8380ce259e33b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P06XaRQA3DisJD7kbld3gw.png"/></div></div></figure><p id="bd0b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">有了这个模型，我们现在可以预测在电视上花费的任何金额的销售额。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kw"><img src="../Images/c26aa15fea8464fb0e67cafc0be5d869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LO6PXsHqjwAdLxDe0lEMgQ.png"/></div></div></figure><p id="3a85" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">根据我们的模型，如果在电视广告上花费400英镑，销售额将增加26个单位。</p><p id="9903" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">继续多元线性回归就像在我们的模型中添加另一个变量一样简单。我们将使用相同的数据，但这次我们将使用不同的库。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lc"><img src="../Images/32a6adcde8539afd328f48e0a837d040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hEnSHO81QU9jTGItOUY9kQ.png"/></div></div></figure><p id="de39" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">接下来，我们将使用电视、广播和报纸作为预测器来构建线性回归模型。我们还将把数据分成预测值X和输出值y，然后初始化和拟合(训练)我们的模型。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ld"><img src="../Images/c2e3ad031f74e8980019466b4f7d4147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RCDdQZFNSqau1sPI74wkDQ.png"/></div></div></figure><p id="0094" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">一旦我们对数据进行了训练，我们就可以继续查看我们的alpha和beta值。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ld"><img src="../Images/67cc7f6ff1f3da56d266ecca0f5bb3f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUP7uw1l-kPLa5Hwp0Bc1A.png"/></div></div></figure><p id="9dd3" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">最后，我们可以继续创建我们的预测，看看额外的变量是否加强了我们的模型。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ld"><img src="../Images/e8bff41b58fc8490a63efc7d6ad2e5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fR__5NJ4gdlYUHIdWbvpGA.png"/></div></div></figure><p id="7ec3" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">因为我们使用了不同的初始库，所以我们将从sklearn.metrics导入r2_score，以便查看我们训练模型的效果。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ky"><img src="../Images/873a75d0893186c697859d5d732ead63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtlcU9-x2Q3jyjMhtdTv5A.png"/></div></div></figure><p id="0118" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们的最终分数是0.897，比0.612有了显著的提高。添加更多的变量(特征)来训练我们的模型提高了我们的模型的效率。</p><p id="9588" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在我们的<a class="ae ku" rel="noopener" href="/analytics-vidhya/dealing-with-categorical-data-942a8c8fdbad">下一节</a>中，我们将讨论如何处理属于分类变量的预测器。</p></div></div>    
</body>
</html>