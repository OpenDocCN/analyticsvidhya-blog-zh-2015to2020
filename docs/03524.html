<html>
<head>
<title>Face Recognition using K-means clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于K-均值聚类的人脸识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/face-recognition-using-k-means-clustering-127c462e02f2?source=collection_archive---------3-----------------------#2020-02-06">https://medium.com/analytics-vidhya/face-recognition-using-k-means-clustering-127c462e02f2?source=collection_archive---------3-----------------------#2020-02-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/81f7c0989e4938307b5bfa475a5de683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFtUJksqCPJHWeqIpb6VTg.png"/></div></div></figure><p id="1e52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每当我们看到一部关于人工智能的科幻电影时，人脸识别的魔力仍然让我们感到惊讶，这就是为什么在这个主题上潜水，研究和写作的目的是揭示这项令人着迷的技术的秘密。</p><p id="5693" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第一篇文章[ <a class="ae jo" href="https://www.linkedin.com/pulse/face-detection-recognition-yasser-chihab/" rel="noopener ugc nofollow" target="_blank">人脸检测和识别</a> ]中，我讨论了人脸检测和识别背后的想法，以及我如何能够通过使用<strong class="is hj"> Dlib C++ </strong>和<strong class="is hj"> openCV </strong>库来完成工作的解决方案，现在我想解释一下我所研究的最新解决方案，以便使用机器学习算法来实现人脸识别，该算法是使用Python的K-means聚类。</p><h1 id="3ec4" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">解决方案背后的想法</h1><p id="bdca" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在学习了一些机器学习的基础知识后，我痴迷于将我所学到的知识应用到一个真实的问题中，以查看机器学习对我们如何解决一些复杂问题的实际影响。</p><p id="1ffa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我以前的项目中，我开发了一个提供的神经网络，它可以将检测到的人脸作为输入，并将该人脸的数据作为输出，这是一个128维的向量，所以一旦我们有了数据，我们就可以生成它，所以为什么不考虑一个使用机器学习算法的结果更准确的解决方案。</p><p id="fa5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我们需要一个算法，在第一时间将相似的向量分组，换句话说，相似的脸，每组相似的脸当然代表一个我们想识别的已知的人，所以如果我们有一个新的脸，我们只需要把它放在这些组中的一个，我们就可以识别它。如果你了解机器学习算法，你会说我们需要一个无监督的算法，特别是k-means聚类。</p><h1 id="7066" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">无监督算法:K-均值聚类</h1><ul class=""><li id="92e2" class="ks kt hi is b it kn ix ko jb ku jf kv jj kw jn kx ky kz la bi translated">无监督学习</li></ul><p id="fcd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">无监督学习是一种机器学习方法，它允许我们仅基于输入数据来发现模式，换句话说，它试图将输入数据中的未标记数据作为标记数据。</p><ul class=""><li id="74fc" class="ks kt hi is b it iu ix iy jb lb jf lc jj ld jn kx ky kz la bi translated">k-均值聚类算法</li></ul><p id="5eab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">K-means算法是一种无监督的机器学习算法，它试图将相似的数据聚类成K个聚类，其中每个聚类都有一个代表它的质心(中心)。每个聚类包含彼此尽可能相似的数据，当然不在同一聚类中的数据尽可能不同。</p><h1 id="e6b7" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">利用K-means算法进行人脸识别</h1><p id="7e96" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">正如我之前解释的，每张脸都有数据，通过使用这些数据，我们可以识别它，K-means算法试图将相似的数据聚集成K个组或簇，所以我们需要做的是收集我们想要识别他们的脸的人的所有数据，并将他们聚集在K个簇中，结果我们将有K个簇，每个簇代表一个人。</p><p id="9ca4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了训练算法，我拍摄了5名足球运动员(梅西、萨拉赫、c罗、苏亚雷斯和内马尔)的75张不同脸部的照片，每个球员几乎有15张不同位置的脸，并将它们交给我的脸部数据提取器，以便提取数据并存储在数据库中。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es le"><img src="../Images/57c274f0ff2e8d8042817e7f464a6e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*5N1D4h5rekRRYsoTL7zw2A.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">人脸数据</figcaption></figure><p id="7421" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图显示的是c罗的面部数据，这些数据在被转换成对训练算法有效的格式之前。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/41c98c1d5da3dcd212a3744d20ee0bce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*HnYGcwKvuacHjhAT6U1caQ.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">代表数据面的128维向量。</figcaption></figure><p id="624d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转换排列面数据后，最终结果是一个75x128的矩阵，上图显示的是第一列。</p><p id="29eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在我们获得所有数据后，我们可以将它们可视化，看看看起来是什么样子:</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/b999324bdb7aefa8130e6bbe8dce7eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*KHsC_IAeUno43Zm-aqrHmA.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">玩家面部的所有向量的散布</figcaption></figure><p id="e070" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以看到，我们有些点彼此接近，我们可以从第一次可视化中得出结论，这些数据点涉及同一张脸或同一个人，这将在我们应用k-means聚类算法时得到证实。</p><ul class=""><li id="1303" class="ks kt hi is b it iu ix iy jb lb jf lc jj ld jn kx ky kz la bi translated"><strong class="is hj">训练算法</strong></li></ul><p id="64c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">K-means聚类中最重要的事情是选择“K”个聚类，如果选择不当，可能会对结果产生不良影响，因此有一种称为“肘函数法”的方法可以确定最佳聚类数，但在我们的情况下，我们想要的聚类数是明确的，我们想要识别的人数是5(梅西、苏亚雷斯、c罗、内马尔和萨拉赫)。</p><pre class="lf lg lh li fd lp lq lr ls aw lt bi"><span id="2f00" class="lu jq hi lq b fi lv lw l lx ly">Kmean = KMeans(n_clusters=5)<br/>Kmean.fit(data)</span></pre><p id="8e71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在对我们的数据点进行算法训练之后，作为结果，我们将得到代表5个聚类的5个质心的坐标。</p><pre class="lf lg lh li fd lp lq lr ls aw lt bi"><span id="68d8" class="lu jq hi lq b fi lv lw l lx ly">centers=np.array(Kmean.cluster_centers_)</span></pre><p id="9844" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下图是我们5个质心的可视化:</p><figure class="lf lg lh li fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/fdb84488022dec95b534371f1409ef98.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*QJdTggHI5nS8-y5nu_4cBw.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">5个质心的可视化</figcaption></figure><p id="3fdc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除了质心的坐标之外，该算法给出了每个数据点的标签，这意味着现在在训练该算法之后，每个数据点或每个面属于5个聚类之一</p><pre class="lf lg lh li fd lp lq lr ls aw lt bi"><span id="1fde" class="lu jq hi lq b fi lv lw l lx ly">labels=Kmean.labels_</span></pre><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/b26151b57332232c21467481b9039b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*_XSylLbzw_NHIAaDUNpssQ.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">数据点的聚类</figcaption></figure><p id="4229" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">重新组织结果后，我们得到了以下数据框架:</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/9de8ca0b529e7611fdb9c6539a2902fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*N7psCq7YAhEJxrwuewDpCw.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">每个面的聚类</figcaption></figure><p id="af7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们可以看到的，同一个玩家的面部数据属于同一个聚类，所以现在我们的面部数据被标记，我们可以利用它来预测和识别未知的面部。</p><ul class=""><li id="0ae2" class="ks kt hi is b it iu ix iy jb lb jf lc jj ld jn kx ky kz la bi translated">认出一张新面孔</li></ul><p id="cda6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在我们标记了所有的数据点之后，我们可以基于之前发现的5个聚类来识别一个新面孔。</p><p id="7cef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">人脸识别的过程现在非常简单，我们有5个聚类，每个聚类代表一个玩家，所以如果我们给算法一个在训练阶段没有计算的新面孔，它必须把它放在5个聚类中的一个，这个聚类将代表我们想要识别的人。</p><pre class="lf lg lh li fd lp lq lr ls aw lt bi"><span id="675b" class="lu jq hi lq b fi lv lw l lx ly">labels = Kmean.predict(new_data)</span></pre><p id="d336" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">new_data表示C.Ronaldo的数据面，我们希望看到将放在哪个聚类中，当然，new_data是算法的未知数据，它自己必须知道包含与我们的new_data相似的数据点的聚类在哪里。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/20aebf65178f3e6b18aa154393fbd3b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*nqxYo4SFBOHHWE24-0u7AQ.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">新数据的群集</figcaption></figure><p id="72a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们所看到的，该算法将新的数据点放在第3个聚类中，这是C.Ronaldo的聚类，因此现在我们的算法几乎能够识别5名球员的面部。</p><h1 id="9f86" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="9b3a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">当然，仅用75个人脸数据训练算法不足以获得准确的结果，并且仅用2或3个新数据人脸进行测试也不足以说我们的模型已经准备好识别任何新面孔，但是我们可以在k个聚类中标记不同人脸的事实是非常有趣的，并且很好地理解问题并思考我们如何能够找到使问题变得简单一点的解决方案也是非常有趣的。</p><h1 id="560e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Github:</h1><ul class=""><li id="3b9d" class="ks kt hi is b it kn ix ko jb ku jf kv jj kw jn kx ky kz la bi translated">K-means人脸识别:<a class="ae jo" href="https://github.com/yasser1dev/Kmeans_FaceRecognition" rel="noopener ugc nofollow" target="_blank">https://github.com/yasser1dev/Kmeans_FaceRecognition</a></li><li id="09ea" class="ks kt hi is b it md ix me jb mf jf mg jj mh jn kx ky kz la bi translated">数据面提取器:【https://github.com/yasser1dev/FaceRecognition T2】</li></ul></div></div>    
</body>
</html>