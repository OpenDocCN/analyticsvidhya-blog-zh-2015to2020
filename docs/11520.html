<html>
<head>
<title>Linear Regression in Python: Predict e-Commerce Revenue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的线性回归:预测电子商务收入</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-in-python-predict-e-commerce-revenue-dd8e0c8bed2f?source=collection_archive---------1-----------------------#2020-12-07">https://medium.com/analytics-vidhya/linear-regression-in-python-predict-e-commerce-revenue-dd8e0c8bed2f?source=collection_archive---------1-----------------------#2020-12-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6bd1f16a6b6207e06a907c1ed418a76a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5T3n-Qsdxz4Fs6wSBFul7Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@ev?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> ev </a>在<a class="ae iu" href="https://unsplash.com/s/photos/data-science?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="d086" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我们的目标是在Python中使用简单的线性回归和随机森林建立一个预测模型。<a class="ae iu" href="https://www.kaggle.com/srolka/ecommerce-customers" rel="noopener ugc nofollow" target="_blank">数据集</a>在Kaggle上可用，我的<a class="ae iu" href="https://github.com/aycaerbasi/Linear-Regression-in-Python" rel="noopener ugc nofollow" target="_blank">代码</a>在我的Github账户上。</p><p id="9153" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们开始了解数据集。</p><h1 id="4767" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">发现和可视化数据</strong></h1><p id="7671" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在该数据集中，有3个分类特征电子邮件、地址和头像；平均5个数字特征。会话时长、在应用上的时间、在网站上的时间、会员时长和每年花费的金额。有500个例子。这是小的，但对初学者来说很完美。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/18c36c03747a3ffe60e1cd8039a23faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j03gp6QnEYMdzj6hDxmyaw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1:数据帧的前10列。</figcaption></figure><p id="d589" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是与这些列相关的统计信息的摘要。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/2dd0f28d906a4166504dfbe6631709b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqUt8EjkBEqG15Eg343Zyw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图2:统计摘要。</figcaption></figure><p id="8d8f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为直观解释数字数据而创建的属性直方图。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/a5cd4de443b7fd39fedde9d79c4d4043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FgaFnf16d0h7sJCZXYX1fg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3:属性直方图。</figcaption></figure><p id="f492" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">寻找相关性</strong></p><p id="306f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看一下“每年花费的金额”与其他属性有多大关联。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/bfdca3caa3b5fcbcc2542cdb6f0ddba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*If7Th9oJ2N2jGPMwNhQ2kA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">相关的输出。</figcaption></figure><p id="e5b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“会员资格年限”这一属性似乎与“每年花费的金额”最相关。“年花费金额”与“上网时间”呈负相关。所以，这表明在网站上停留时间越长的顾客花的钱就越少。</p><p id="c221" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用散点图来检查相关性。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/b457c9f000b829c48b6513a2069b4ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_4DZ5pO-WViJH6ZTpTHEQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4:散点图。</figcaption></figure><p id="3670" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，收入与会员时间最相关，在app上的时间是相关性高的第二个属性。让我们比较一下app上的时间和web上的时间。我们可以在图5中看到花钱最多的客户属于哪一组。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="c715" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">红点代表较高的消费金额，蓝点代表较低的金额，点的宽度代表会员资格的长度。当点数的宽度增加时，意味着会员资格的长度变长。(乘以10无所谓，只是让图上的点变大了。)图5告诉我们，使用app的客户花了更多的钱。而长期会员可以解读为更喜欢使用app。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/f398a58e5094504b324a8d108a5bdc71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*eQ5_D5SxqrzhPzRqBL01Mg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5</figcaption></figure><h1 id="4a5b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">线性回归</strong></h1><p id="1667" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><a class="ae iu" href="https://en.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank">线性回归</a>是一种监督学习技术。回归是预测连续值的过程。这是通过训练模型来完成的，模型使用以前标记的数据来预测未来的实例。x代表自变量，y代表因变量，它也被称为目标，这个变量将被尝试预测。</p><p id="be12" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">回归的关键点是因变量应该是连续的。</p><p id="dd7f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">线性回归公式</strong>:</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es li"><img src="../Images/586ca18c2b03153615f5b1971d069e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*k7bwIgN6A9H18kFEPM9m0w.png"/></div></figure><p id="9f9b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">θ0和θ1也是线性方程的系数，y是预测变量。</p><p id="e85a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">训练模型</strong></p><p id="756f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大多数机器学习算法不能处理空值。该数据集已经过检查，没有缺失值。</p><p id="f731" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我定义了X和y的值。我只为x选择了数字属性。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="74e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是模型评估输出:</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/bae3f607cd221088c1f53dec28c37a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*A1HUKQNYpywPqyOk2xO1dw.png"/></div></figure><p id="a303" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些系数分别是这些特征的平均值。会话长度、在应用上的时间、在网站上的时间、会员资格的长度，这就是我们定义的x。</p><p id="6542" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">r平方显示了数据与拟合线的距离。最好的分数是1。r平方值接近1表示模型的适用性。对于我们的模型，它是0.986。</p><p id="9a0a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">RMSE测量预测向量和目标值向量之间的距离。我们的型号是9.755美元。</p><h1 id="12cc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">随机森林</h1><p id="29b6" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">让我们用随机森林回归来评估这个模型。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/cfaa9414e8e5bf8826b604b763f8f86b.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*4u3pOF9a9-_0e-XXzGGcLQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">随机森林回归的输出。</figcaption></figure><p id="d8f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">线性回归为该数据集提供了更好的结果。</p><h1 id="5043" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><ol class=""><li id="e9c2" class="ll lm hi ix b iy kr jc ks jg ln jk lo jo lp js lq lr ls lt bi translated"><a class="ae iu" href="https://www.amazon.com/Hands-Machine-Learning-Scikit-Learn-TensorFlow/dp/1492032646/ref=pd_lpo_14_img_0/135-9437164-5211348?_encoding=UTF8&amp;pd_rd_i=1492032646&amp;pd_rd_r=360fa819-e944-461f-a643-b9dc38359802&amp;pd_rd_w=jzU0t&amp;pd_rd_wg=tQsaa&amp;pf_rd_p=7b36d496-f366-4631-94d3-61b87b52511b&amp;pf_rd_r=2TPXGCT5YJG8QMZ4NRXX&amp;psc=1&amp;refRID=2TPXGCT5YJG8QMZ4NRXX" rel="noopener ugc nofollow" target="_blank"> <em class="lu">杰龙，a，2019。使用Scikit-Learn、Keras和Tensorflow进行机器学习。奥赖利。</em>T9】</a></li><li id="252a" class="ll lm hi ix b iy lv jc lw jg lx jk ly jo lz js lq lr ls lt bi translated"><a class="ae iu" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/</a></li><li id="cfd0" class="ll lm hi ix b iy lv jc lw jg lx jk ly jo lz js lq lr ls lt bi translated"><a class="ae iu" href="https://courses.cognitiveclass.ai/courses/course-v1:CognitiveClass+ML0101ENv3+2018/course/" rel="noopener ugc nofollow" target="_blank">认知类:ML0101ENv3 </a></li></ol><p id="0daa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请不要犹豫给我反馈。</p><p id="4bdb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>