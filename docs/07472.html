<html>
<head>
<title>Transfer Learning using Pytorch — a beginners approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pytorch进行迁移学习——初学者方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/transfer-learning-using-pytorch-a-beginners-approach-44b3d37a990c?source=collection_archive---------22-----------------------#2020-06-26">https://medium.com/analytics-vidhya/transfer-learning-using-pytorch-a-beginners-approach-44b3d37a990c?source=collection_archive---------22-----------------------#2020-06-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="790b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">利用深度卷积神经网络对疟疾感染细胞进行分类</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/8dd85ab69d970c4bf85b5c517fdd6639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*-SzSx2BYaTjdQ9mxy6VpDw.png"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://www.who.int/news-room/fact-sheets/detail/malaria" rel="noopener ugc nofollow" target="_blank"><em class="jk"/>https://www.who.int/news-room/fact-sheets/detail/malaria</a></figcaption></figure><h1 id="a00c" class="jl jm hi bd jn jo jp jq jr js jt ju jv io jw ip jx ir jy is jz iu ka iv kb kc bi translated">疟疾检测</h1><p id="98b6" class="pw-post-body-paragraph kd ke hi kf b kg kh ij ki kj kk im kl km kn ko kp kq kr ks kt ku kv kw kx ky hb bi translated">疟疾是一种威胁生命的疾病，由寄生虫引起，通过受感染的雌性疟蚊的叮咬传播给人类。它是可以预防和治愈的。</p><p id="2f01" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">疟疾是由疟原虫寄生虫引起的。这些寄生虫通过被感染的雌性按蚊的叮咬传播给人类，被称为“疟疾病媒”导致人类疟疾的寄生虫有5种，其中两种——恶性疟原虫和间日疟原虫——构成的威胁最大。</p><p id="32b0" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le">诊断疟疾可难</em> </strong>:</p><ul class=""><li id="02eb" class="lf lg hi kf b kg kz kj la km lh kq li ku lj ky lk ll lm ln bi translated">在疟疾不再流行的地方(如美国)，卫生保健提供者可能不熟悉这种疾病。临床医生在治疗疟疾患者时，可能会忘记将疟疾列为潜在诊断之一，也不会安排必要的诊断测试。实验室工作人员可能缺乏疟疾方面的经验，在显微镜下检查血涂片时无法发现寄生虫。</li><li id="807f" class="lf lg hi kf b kg lo kj lp km lq kq lr ku ls ky lk ll lm ln bi translated">疟疾是一种急性发热疾病。在非免疫个体中，症状通常在被感染的蚊子叮咬后10-15天出现。最初的症状——发烧、头痛和发冷——可能很轻微，很难被识别为疟疾。如果不在24小时内治疗，恶性疟原虫疟疾可能发展成严重疾病，通常导致死亡。</li></ul><p id="11bd" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le">显微镜诊断</em> </strong></p><p id="66e2" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">疟疾寄生虫可以通过在显微镜下检查患者的一滴血，在显微镜载玻片上展开成“血涂片”来识别。在检查之前，标本被染色，使寄生虫具有独特的外观。这项技术仍然是实验室确认疟疾的金标准。然而，这取决于试剂、显微镜的质量以及病理学家的经验。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/06698985cc5b9a9a69ac92bf5a170d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SjJ4fuBZ0AzNLcwzNbUhNw.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated"><a class="ae jj" href="https://blog.insightdatascience.com/https-blog-insightdatascience-com-malaria-hero-a47d3d5fc4bb" rel="noopener ugc nofollow" target="_blank">https://blog . insightdatascience . com/https-blog-insightdatascience-com-malaria-hero-a 47d 3d 5 fc 4 bb</a></figcaption></figure><p id="d02a" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">从解决方案开始。</strong></p><p id="ed26" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">尝试的解决方案是使用VGG16预训练模型对感染的细胞进行分类。尝试以初学者的角度使用Google Colab学习PyTorch。</p><p id="7ed6" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">数据来源:</strong> Kaggle</p><p id="91d0" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">导入数据:</strong> <em class="le">！kaggle数据集下载-d iarunava/cell-images-for-detecting-malaria</em></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ly"><img src="../Images/63d127421b0d32c125167699e962bb31.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*no-VsM2KBJ2vXawo3xaK3w.png"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">文件夹结构</figcaption></figure><p id="570c" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">深度学习模型，或者更具体地说，卷积神经网络(CNN)已经被证明在各种各样的计算机视觉任务中非常有效。虽然我们假设你对CNN有所了解，但如果你不了解，请点击这里的查看<a class="ae jj" href="http://cs231n.github.io/convolutional-networks/" rel="noopener ugc nofollow" target="_blank">这篇文章。简而言之，CNN模型中的关键层包括卷积层和池层，如下图所示。</a></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lz"><img src="../Images/c9ed81b7cb39f2bdb35bff89ad72e852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hItMnXH6uWt_PAfhPATXkQ.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">典型的CNN架构</figcaption></figure><p id="66d7" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">什么是迁移学习？</strong></p><p id="0540" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">迁移学习是一种机器学习方法，其中为一项任务开发的模型被重新用作第二项任务模型的起点。</p><p id="0fd8" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">这是深度学习中的一种流行方法，其中预先训练的模型被用作计算机视觉和自然语言处理任务的起点，因为开发关于这些问题的神经网络模型需要大量的计算和时间资源，并且它们在相关问题上提供了巨大的技能飞跃。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ma"><img src="../Images/d0837c0630fcc0690624b9f9094ef06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*JZCrvGdwSeKWJ4i4llXc0w.png"/></div></figure><p id="48e2" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">这两种主要的迁移学习情景如下:</p><ul class=""><li id="70a0" class="lf lg hi kf b kg kz kj la km lh kq li ku lj ky lk ll lm ln bi translated"><strong class="kf hj">微调convnet </strong>:我们用一个预训练的网络来初始化网络，而不是随机初始化，就像在imagenet 1000数据集上训练的网络一样。其余的训练看起来和往常一样。</li><li id="f205" class="lf lg hi kf b kg lo kj lp km lq kq lr ku ls ky lk ll lm ln bi translated"><strong class="kf hj">作为固定特征提取器的conv net</strong>:这里，我们将冻结所有网络的权重，除了最后完全连接的层。这个最后完全连接的层被替换为具有随机权重的新层，并且只有这一层被训练。</li></ul><p id="7829" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated">这里我们使用了VGG16架构</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mb"><img src="../Images/644fd1f3861d8d9203ad6a1ad46126f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*sCoynWkUubRjrjuVzJeFPg.png"/></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">VGG16架构</figcaption></figure><p id="3c58" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">导入库:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mc"><img src="../Images/9eb1083e37664d935d31163b4ef17314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1qyhZ43jgSA_cnKuPgWK4Q.png"/></div></div></figure><p id="75f9" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">用于训练和验证的数据扩充和标准化</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es md"><img src="../Images/e61bac9dfdd0c4a24e646cbcbbfa9dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r7gdUQmUPik0gBMdcpYNXg.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es me"><img src="../Images/95c03923236eaff0e49e3c1b665e0b31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNh_V-tfj3MjKbgp_iDKvQ.png"/></div></div></figure><p id="2d93" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">可视化一些训练图像，以便理解数据扩充。</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mf"><img src="../Images/801d629f914bdc84df9367bcc3fe6202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z7Jdb4Jq4gS4qvgFxroOoQ.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mg"><img src="../Images/820db02d797f53b9f20c8ebd13b1f50b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zG9d_iJ6go-zQVgdYavqcg.png"/></div></div></figure><p id="008e" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">训练模型</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mh"><img src="../Images/ae3cc8bdfdeb91b120fc79be56e7566e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rYHC83mP1IeLjPoIY03PDQ.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mi"><img src="../Images/664b88a083cf639787e2f96a21b8bc4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mXHi_XjzcISQbpXUt5Hc2g.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mj"><img src="../Images/d3689933f5bc23d49acffea1c473f4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4oQlMGdNButjIaxhzo7sg.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mk"><img src="../Images/85ae245b7964dd0558f19b3b0caa01d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YX83D1iRUz1peZ5aVzp5SA.png"/></div></div></figure><p id="cde3" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">加载预训练模型，重置最终全连接层</strong></p><h1 id="7dae" class="jl jm hi bd jn jo jp jq jr js jt ju jv io jw ip jx ir jy is jz iu ka iv kb kc bi translated"><strong class="ak">模型架构:</strong></h1><p id="12e5" class="pw-post-body-paragraph kd ke hi kf b kg kh ij ki kj kk im kl km kn ko kp kq kr ks kt ku kv kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> VGG( </em> </strong></p><p id="90b4" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le">(特征):时序(</em> </strong></p><p id="285d" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (0): Conv2d(3，64，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="7dd3" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(1):ReLU(in place = True)</em></strong></p><p id="11a0" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (2): Conv2d(64，64，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="df9a" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(3):ReLU(in place = True)</em></strong></p><p id="5435" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(4):maxpool 2d(kernel _ size = 2，stride=2，padding=0，exploation = 1，ceil_mode=False) </em> </strong></p><p id="5725" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (5): Conv2d(64，128，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="e869" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(6):ReLU(in place = True)</em></strong></p><p id="bdd4" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (7): Conv2d(128，128，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="e1e5" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(8):ReLU(in place = True)</em></strong></p><p id="0b96" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(9):maxpool 2d(kernel _ size = 2，stride=2，padding=0，exploation = 1，ceil_mode=False) </em> </strong></p><p id="f810" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (10): Conv2d(128，256，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="9019" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(11):ReLU(in place = True)</em></strong></p><p id="cf3b" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (12): Conv2d(256，256，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="d6c9" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(13):ReLU(in place = True)</em></strong></p><p id="30c6" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (14): Conv2d(256，256，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="d6cf" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(15):ReLU(in place = True)</em></strong></p><p id="1dbe" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(16):maxpool 2d(kernel _ size = 2，stride=2，padding=0，exploation = 1，ceil_mode=False) </em> </strong></p><p id="e4eb" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (17): Conv2d(256，512，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="d403" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(18):ReLU(in place = True)</em></strong></p><p id="7be8" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (19): Conv2d(512，512，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="99b3" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(20):ReLU(in place = True)</em></strong></p><p id="5962" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (21): Conv2d(512，512，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="6e05" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(22):ReLU(in place = True)</em></strong></p><p id="84ee" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(23):maxpool 2d(kernel _ size = 2，stride=2，padding=0，exploation = 1，ceil_mode=False) </em> </strong></p><p id="e51e" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (24): Conv2d(512，512，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="aecf" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(25):ReLU(in place = True)</em></strong></p><p id="f88d" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (26): Conv2d(512，512，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="f711" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(27):ReLU(in place = True)</em></strong></p><p id="ddaf" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (28): Conv2d(512，512，kernel_size=(3，3)，stride=(1，1)，padding=(1，1)) </em> </strong></p><p id="6490" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(29):ReLU(in place = True)</em></strong></p><p id="372d" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(30):maxpool 2d(kernel _ size = 2，stride=2，padding=0，exploation = 1，ceil_mode=False) </em> </strong></p><p id="5644" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">T97)T99】</strong></p><p id="bf5e" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(avgpool):AdaptiveAvgPool2d(output _ size =(7，7)) </em> </strong></p><p id="d6ea" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le">(量词):顺序的(</em> </strong></p><p id="b1c8" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (0):线性(in_features=25088，out_features=4096，bias=True) </em> </strong></p><p id="c201" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(1):ReLU(in place = True)</em></strong></p><p id="ba70" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (2):辍学(p=0.5，原地=假)</em> </strong></p><p id="8306" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (3):线性(in_features=4096，out_features=4096，bias=True) </em> </strong></p><p id="f44f" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"><em class="le">(4):ReLU(in place = True)</em></strong></p><p id="99f0" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (5):辍学(p=0.5，原地=假)</em> </strong></p><p id="969d" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> (6):线性(in_features=4096，out_features=1000，bias=True) </em> </strong></p><p id="9112" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le"> ) </em> </strong></p><p id="a131" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">T29)T31】</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es ml"><img src="../Images/d569fbd712b8d214b04dce1d8864fdc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCdacK3-_YJgCT5MEf1iQw.png"/></div></div></figure><p id="4d98" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">注意</strong> <em class="le"> </em> <code class="du mm mn mo mp b"><em class="le">print(model_ft)</em></code> <em class="le">输出一个顺序对象，需要像列表一样查询。否则你可能会看到一个</em> <code class="du mm mn mo mp b"><strong class="kf hj"><em class="le">VGG object has no attribute</em></strong></code> <em class="le">错误。</em></p><p id="5098" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><em class="le">请注意不同的Pytorch型号可能有不同的属性名称，您可能需要自定义名称</em> <code class="du mm mn mo mp b"><em class="le">&lt;model_name&gt;.&lt;feature_name&gt;[0]</em></code></p><p id="f7a9" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><em class="le">例如:</em><strong class="kf hj">model _ ft . classifier[0]。in_features </strong> <em class="le">如果序列被命名为</em> <code class="du mm mn mo mp b"><em class="le">classifier</em></code> <em class="le">。</em></p><h1 id="dda1" class="jl jm hi bd jn jo jp jq jr js jt ju jv io jw ip jx ir jy is jz iu ka iv kb kc bi translated">培训和评估</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mq"><img src="../Images/d3c4eb780d581e760e618b152cbf1707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yTuLMmc4pVgkfLoLaAYxrA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mr"><img src="../Images/8fb71e6965e4c1d3064697e86fbba4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnEM5GYaiq_m78sQ_XUeQw.png"/></div></div></figure><p id="4773" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj"> <em class="le">最佳验证准确度得分:0.957366 </em> </strong></p><h2 id="f950" class="ms jm hi bd jn mt mu mv jr mw mx my jv km mz na jx kq nb nc jz ku nd ne kb nf bi translated"><strong class="ak">可视化预测</strong></h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es ng"><img src="../Images/e848ec52168a01060ceca565cdab004a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFfjClUyoYcXzM3x__RJqA.png"/></div></div></figure><p id="d796" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">模型预测</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es nh"><img src="../Images/409d474b7b287153e1ac5d4939df2ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0ucLiJxOLV6_sgTI79QGg.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx translated">模型做出的预测</figcaption></figure><p id="45c0" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><strong class="kf hj">结论:</strong></p><p id="aa64" class="pw-post-body-paragraph kd ke hi kf b kg kz ij ki kj la im kl km lb ko kp kq lc ks kt ku ld kw kx ky hb bi translated"><em class="le">该模型预测被寄生虫感染的细胞的准确率为95.74 % </em></p></div></div>    
</body>
</html>