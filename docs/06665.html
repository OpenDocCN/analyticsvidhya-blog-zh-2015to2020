<html>
<head>
<title>Using Python to automate your boring and tedious excel tasks!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python来自动化您枯燥乏味的excel任务！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-python-to-automate-your-boring-and-tedious-excel-tasks-1fbbf2ce0de3?source=collection_archive---------19-----------------------#2020-05-29">https://medium.com/analytics-vidhya/using-python-to-automate-your-boring-and-tedious-excel-tasks-1fbbf2ce0de3?source=collection_archive---------19-----------------------#2020-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2ea4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">你是否厌倦了每天在工作中做繁琐重复的excel任务？如果是，那么这篇文章将帮助你度过难关，并为你节省一些时间。您将需要python的pandas库来自动化您的excel任务。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/206631228037d594b57c1bad412edbb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZscO0Jz_ZyYRe0DYytZ8A.jpeg"/></div></div></figure><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="e21d" class="kd ke hi jz b fi kf kg l kh ki">pip install pandas</span></pre><p id="c2d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pandas是一个用于数据分析和操作的多功能库。</p><h2 id="bc7e" class="kd ke hi bd kj kk kl km kn ko kp kq kr iq ks kt ku iu kv kw kx iy ky kz la lb bi translated">案例1:合并多个CSV</h2><p id="5418" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">我们将创建一个文件夹来存储所有的CSV文件，并合并这些文件。我们将使用os和glob模块来处理我们的文件结构。</p><p id="64f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:导入所有模块</strong></p><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="fc66" class="kd ke hi jz b fi kf kg l kh ki">import os<br/>import glob<br/>import pandas as pd</span></pre><p id="97a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:选择目标文件夹(保留要合并的文件)</strong></p><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="d2f5" class="kd ke hi jz b fi kf kg l kh ki">folder = input("Enter folder name :")<br/>os.chdir(folder)<br/>extension = 'csv'<br/>#You can use xlsx as well</span></pre><ul class=""><li id="ec0c" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">os.chdir(folder_name) -&gt;将当前目录更改为目标文件夹</li></ul><p id="a3f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第三步:提取列表中的所有文件名，并将它们连接在一起</p><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="3a47" class="kd ke hi jz b fi kf kg l kh ki">all_filenames = [i for i in glob.glob('*.{}'.format(extension))]<br/>combined_csv = pd.concat([pd.read_csv(f, encoding="utf-8", keep_default_na=False) for f in all_filenames])</span></pre><ul class=""><li id="2531" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated"><em class="lq"> glob.glob('*。)</em> - &gt;通配符符号列出所有文件(本例中为csv)</li><li id="571c" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated"><em class="lq">PD . concat(</em>objs<em class="lq">)</em>-&gt;组合系列或DataFrame对象的序列或映射</li><li id="89dc" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated"><em class="lq"> pd.read_csv(f) </em> - &gt;读取csv文件的函数</li></ul><p id="0047" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤4:保存您的合并文件</strong></p><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="ba3c" class="kd ke hi jz b fi kf kg l kh ki">combined_csv.to_csv('Combined.csv',index=False, encoding='utf-8-sig')</span></pre><ul class=""><li id="25da" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">PD . to _ csv(' filename . CSV ')--&gt;将合并文件保存到CSV的函数</li></ul></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><h2 id="e957" class="kd ke hi bd kj kk kl km kn ko kp kq kr iq ks kt ku iu kv kw kx iy ky kz la lb bi translated">案例excel的排序和过滤功能</h2><p id="93fd" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">我们将使用熊猫数据框架来处理我们的数据。<strong class="ih hj">数据帧</strong>是一种二维数据结构，即数据以表格形式排列成行和列。</p><p id="0d3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用的是Kaggle的网飞数据集，链接如下:</p><div class="md me ez fb mf mg"><a href="https://www.kaggle.com/shivamb/netflix-shows" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">网飞电影和电视节目</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">网飞上的电影和电视节目列表</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">www.kaggle.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu jw mg"/></div></div></a></div><p id="8deb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:读取文件并存储到数据帧</strong></p><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="8178" class="kd ke hi jz b fi kf kg l kh ki">df = pd.read_csv('netflix.csv')<br/>df.head()</span></pre><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mv"><img src="../Images/f898ef4fddcc0ec0f6c9e69c7843a59f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IUmNGkJrIkkabueonSHuHQ.png"/></div></div></figure><p id="15ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们想根据date_added和release_year对数据集进行排序:我们将使用pandas库的sort_value函数。</p><p id="26a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:分拣</strong></p><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="854e" class="kd ke hi jz b fi kf kg l kh ki">df.sort_values(by=['date_added','release_year'],ascending=[True, False],inplace=True)</span></pre><p id="0a6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，排序是按升序进行的，但是您可以相应地更改，如果您选择了将排序后的值存储到变量中的默认方式，那么默认情况下，就地值为False。</p><p id="27ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:过滤</strong></p><p id="5739" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看所有来自美国并在2018年及以后发布的电视节目，我们将应用三个过滤器:</p><ul class=""><li id="bf25" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">“类型”栏中的电视节目过滤器</li><li id="95c3" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated">在release_year列中筛选年份</li><li id="9c6e" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated">筛选“国家”列中的国家</li></ul><pre class="jn jo jp jq fd jy jz ka kb aw kc bi"><span id="ceb6" class="kd ke hi jz b fi kf kg l kh ki">df2 = df[(df['type'] == 'TV Show') &amp; (df['release_year'] &gt;= 2018) &amp; (df['country'] =='United States')]<br/>#Saving filtered data<br/>df2.to_csv('Filtered.csv',index=False,encoding='utf-8-sig')</span></pre></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="30c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你喜欢这篇文章。我很想听听你对这个话题的经验和反馈。</p></div></div>    
</body>
</html>