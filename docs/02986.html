<html>
<head>
<title>Shiny Dashboards with Flexdashboard</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Flexdashboard的闪亮仪表盘</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/shiny-dashboards-with-flexdashboard-e66aaafac1f2?source=collection_archive---------1-----------------------#2020-01-11">https://medium.com/analytics-vidhya/shiny-dashboards-with-flexdashboard-e66aaafac1f2?source=collection_archive---------1-----------------------#2020-01-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="6fce" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">快速构建漂亮的仪表板。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/b013b4b49b6fc9ceb94e9bed90c78e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2-xx451iCTugj5du3scdg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Flexdashboard示例。来自<a class="ae jn" href="https://walkerke.shinyapps.io/neighborhood_diversity/" rel="noopener ugc nofollow" target="_blank"> shinyapps.io </a></figcaption></figure><p id="743f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="kk">这是不断增长的微服务数据报告系列的第一部分。关于部署web应用程序，特别是这个Flexdashboard，请参见第二部分，</em> <a class="ae jn" rel="noopener" href="/analytics-vidhya/deploying-a-shiny-flexdashboard-with-docker-cca338a10d12"> <strong class="jq hj"> <em class="kk">使用Docker </em> </strong> </a> <em class="kk">部署闪亮的Flexdashboard。关于使用闪亮的代理服务器在生产中大规模部署仪表板，请参见第三部分。</em></p><p id="4a49" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="kk">这篇文章也发表在</em><a class="ae jn" href="https://www.r-bloggers.com/" rel="noopener ugc nofollow" target="_blank"><em class="kk">https://www.r-bloggers.com/</em></a><em class="kk">上。更新于2020年4月10日，提供关于性能改进的简短建议。</em></p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="94b7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi ks translated">大多数现代企业都依赖于数据。对能够持续快速地提供准确、相关且易懂的数据见解的技术人员的需求日益增长。这些需求很难满足，而且往往是相互冲突的。它们可以通过提供主要用于内部业务KPI的交互式数据仪表板来满足，但也可以用作与存储数据交互的方式，作为<a class="ae jn" rel="noopener" href="/better-programming/real-life-use-cases-of-dashboards-with-actual-roi-a8d07e36f530">销售平台或生产工具</a>。R Shiny 是一个方便的框架，用于生成反应性的和强大的仪表板。我将向你展示如何通过<code class="du lb lc ld le b">flexdashboard </code>包轻松制作漂亮的反应灵敏的仪表盘。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="a32f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本文中，我们将构建带有闪亮元素的基本<a class="ae jn" href="https://timosch.shinyapps.io/dashboard_example/" rel="noopener ugc nofollow" target="_blank"> Flexdashboard </a>:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lf"><img src="../Images/1c0d4aa325e268b6917c6edb57a9ccf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OGwJfmSoLNE-C92l5QPTBw.gif"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">带<a class="ae jn" href="https://www.getcloudapp.com/" rel="noopener ugc nofollow" target="_blank"> CloudApp </a>的GIF。在<a class="ae jn" href="https://timosch.shinyapps.io/dashboard_example/#section-test-plotly-and-shiny-elements" rel="noopener ugc nofollow" target="_blank"> Shinapps.io </a>上试用Flexdashboard。</figcaption></figure><h1 id="7c2c" class="lg lh hi bd li lj lk ll lm ln lo lp lq io lr ip ls ir lt is lu iu lv iv lw lx bi translated">为什么选择Flexdashboard？</h1><p id="cdf2" class="pw-post-body-paragraph jo jp hi jq b jr ly ij jt ju lz im jw jx ma jz ka kb mb kd ke kf mc kh ki kj hb bi translated">一个<a class="ae jn" href="https://rmarkdown.rstudio.com/flexdashboard/" rel="noopener ugc nofollow" target="_blank"> Flexdashboard </a>是从一个Rmarkdown文件构建的。Rmarkdown是一个强大的框架，用于生成HTML、PDF、Word文档、幻灯片或制作整个网站的报告。如果您熟悉Rmarkdown，那么您已经知道使用markdown语法和CSS来设计文档样式是多么容易。有太多的交互式<a class="ae jn" href="https://www.htmlwidgets.org/" rel="noopener ugc nofollow" target="_blank"> HTML小部件</a>你可以使用渲染成HTML的RMarkdown文件，如交互式<a class="ae jn" href="https://datatables.net/extensions/" rel="noopener ugc nofollow" target="_blank">数据表</a>或各种<a class="ae jn" href="https://plot.ly/r/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>图，并通过<a class="ae jn" href="https://rstudio.github.io/crosstalk/" rel="noopener ugc nofollow" target="_blank">串扰</a>链接HTML小部件上的数据点。从本质上讲，Flexdashboard是一个HTML报表，但是添加了方便样式的仪表板或幻灯片元素。更重要的是，你可以使用<strong class="jq hj">闪亮的</strong>反应式元素，让它成为一个托管在服务器上的完全反应式web应用。或者，您可以使用呈现为HTML文件的Flexdashboard作为仪表板格式的静态报告。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="77e8" class="lg lh hi bd li lj md ll lm ln me lp lq io mf ip ls ir mg is lu iu mh iv lw lx bi translated">构建Flexdashboard</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/2b0adc05dba7b0377bb3740323c80466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BdNccJeP45i68CokoGVHyw.jpeg"/></div></div></figure><p id="ab38" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先安装R库<code class="du lb lc ld le b">flexdashboard</code>。如果您创建一个新的R Markdown文档，您现在将拥有一个Flexdashboard模板，您可以从该模板创建您的文档。Flexdashboards是由YAML标题定义的，我们将会看到这个标题。YAML标题中的选项将配置您的Flexdashboard的许多细节，我们在此仅讨论最重要的部分。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="f845" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">输出:</strong></p><ul class=""><li id="8155" class="ml mm hi jq b jr js ju jv jx mn kb mo kf mp kj mq mr ms mt bi translated"><strong class="jq hj"> flex_dashboard: </strong>定义格式</li><li id="7c1b" class="ml mm hi jq b jr mu ju mv jx mw kb mx kf my kj mq mr ms mt bi translated">方向:如果仪表板元素按行或列排序</li><li id="91d0" class="ml mm hi jq b jr mu ju mv jx mw kb mx kf my kj mq mr ms mt bi translated">社交:如何以及是否应该嵌入社交分享链接</li><li id="5a29" class="ml mm hi jq b jr mu ju mv jx mw kb mx kf my kj mq mr ms mt bi translated">主题:鞋样风格主题，有14种主题可供选择</li><li id="81e0" class="ml mm hi jq b jr mu ju mv jx mw kb mx kf my kj mq mr ms mt bi translated">source_code:源代码是否以及如何可用</li><li id="7d33" class="ml mm hi jq b jr mu ju mv jx mw kb mx kf my kj mq mr ms mt bi translated">还有许多其他重要的输出选项没有在这里使用，仅举几个例子，css:添加自定义CSS样式，vertical_layout:启用滚动，logo:在你的仪表板上添加logo</li></ul><p id="5303" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">运行时:</strong></p><ul class=""><li id="ee70" class="ml mm hi jq b jr js ju jv jx mn kb mo kf mp kj mq mr ms mt bi translated"><strong class="jq hj">闪亮:</strong>启用运行反应闪亮元素</li></ul><h2 id="82c7" class="mz lh hi bd li na nb nc lm nd ne nf lq jx ng nh ls kb ni nj lu kf nk nl lw nm bi translated">构建Flexdashboard</h2><p id="1580" class="pw-post-body-paragraph jo jp hi jq b jr ly ij jt ju lz im jw jx ma jz ka kb mb kd ke kf mc kh ki kj hb bi translated">二级降价标题<code class="du lb lc ld le b">---------------</code>定义了具有相关宽度/高度的行和列。如果没有定义宽度/高度，则行和列被平均分割。第三级标题<code class="du lb lc ld le b">###</code>进一步在行或列内拆分元素。您还可以像在Rmarkdown文档中一样在每个级别使用<code class="du lb lc ld le b">{.tabset}</code>来获取标签集。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nn"><img src="../Images/39f8fac23e66a58a47016462dd2941a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0fV9CIBfpw-m0PiP.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Tabset示例。来自<a class="ae jn" href="https://rmarkdown.rstudio.com/flexdashboard/using.html#tabsets" rel="noopener ugc nofollow" target="_blank"> Rstudio Flexdashboard指南</a></figcaption></figure><p id="562b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于多页Flexdashboard，使用1级标题<code class="du lb lc ld le b">=============</code>定义页面。您可以用<code class="du lb lc ld le b">{data-orientation= }</code>覆盖YAML标题中的元素方向，并用<code class="du lb lc ld le b">{data-icon= }</code>给它一个图标。每一级的标题都可以像Rmarkdown一样用<code class="du lb lc ld le b">[linktext](#headername)</code>链接起来。</p><p id="6cff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们将创建一个两页仪表板。出于演示目的，第一页将一行分成大小不等的两列。第二个页面有一个默认的输入侧边栏，左侧有固定的颜色和宽度，右侧有一个大元素。请注意，我不一定需要在这里给出一个数据宽度参数，如果您在级别1上定义了侧边栏，您可以为所有仪表板页面定义一个全局输入侧边栏。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h2 id="aced" class="mz lh hi bd li na nb nc lm nd ne nf lq jx ng nh ls kb ni nj lu kf nk nl lw nm bi translated">仪表板内容</h2><p id="d40e" class="pw-post-body-paragraph jo jp hi jq b jr ly ij jt ju lz im jw jx ma jz ka kb mb kd ke kf mc kh ki kj hb bi translated">我们将在第一个仪表板页面上制作来自用户jjallaire的<a class="ae jn" href="https://beta.rstudioconnect.com/jjallaire/htmlwidgets-d3heatmap/htmlwidgets-d3heatmap.html" rel="noopener ugc nofollow" target="_blank"> NBA示例Flexdashboard </a>来演示HTML小部件功能。第一个代码块用于加载必要的R库和导入数据。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="ac1c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在第二页，我们将演示基本的发光反应。我们将在左侧的侧边栏中制作一个输入按钮，它在按钮按下时做出反应，并呈现一个<a class="ae jn" href="https://plot.ly/r/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>交互图形。我们用<code class="du lb lc ld le b">withProgress(message= , value= {function})</code>在反应函数中插入一个进度条，并用<code class="du lb lc ld le b">incProgress()</code>增加进度条。该元素增加了用户体验，尤其是当渲染图形或导入数据需要很长时间时。尝试顶部嵌入式仪表板中的按钮反应！你可以在我的<a class="ae jn" href="https://github.com/timosch29/Dockerized-Shiny-Proxy-Server/blob/master/example_dashboard/dashboard_example.Rmd" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>上找到完整的代码。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mj mk l"/></div></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="48d8" class="lg lh hi bd li lj md ll lm ln me lp lq io mf ip ls ir mg is lu iu mh iv lw lx bi translated"><strong class="ak">部署</strong></h1><p id="bd9d" class="pw-post-body-paragraph jo jp hi jq b jr ly ij jt ju lz im jw jx ma jz ka kb mb kd ke kf mc kh ki kj hb bi translated">现在，我们可以在本地查看仪表板进行测试。您可以使用Rstudio中的“Run”按钮来渲染Rmd文件，并在浏览器的查看器窗格中打开它，或者通过R命令<code class="du lb lc ld le b">rmarkdown::run("pathto/dashboard_example.Rmd", shiny_args = list(port = 3838, host = "0.0.0.0"))</code>手动执行此操作。然后，您可以通过<code class="du lb lc ld le b">http://localhost:3838</code>或通过<code class="du lb lc ld le b">shiny_args</code>定义的任何其他主机和端口访问您的网络浏览器中的仪表板。</p><p id="f474" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您还可以使用命令<code class="du lb lc ld le b">rmarkdown::render("pathto/dashboard_example.Rmd")</code>将Rmd文件呈现为静态HTML文件。优点是你可以通过电子邮件将文件作为报告发送，可以是链接、附件，甚至是嵌入邮件正文。在Flexdashboard中制作幻灯片和制作静态报告的选项是展示您的分析结果的一种很好的方式。最大的缺点是你不能使用闪亮的反应。参见下面嵌入的静态HTML文件的第二页。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es no"><img src="../Images/0967f1597fea82b443d6dbd26baef89f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1JCh873p5t7ocBTyhMipag.gif"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">静态Flexdashboard闪亮的反应不起作用，但是互动部件是可能的。在<a class="ae jn" href="https://timosch29.github.io/Dockerized-Shiny-Proxy-Server/example_dashboard/dashboard_example#section-test-html-widget" rel="noopener ugc nofollow" target="_blank"> Github页面</a>上试试吧。</figcaption></figure><p id="b10b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你觉得这篇文章有用，不要忘了鼓掌，并关注我的更多内容！</p><h2 id="3f43" class="mz lh hi bd li na nb nc lm nd ne nf lq jx ng nh ls kb ni nj lu kf nk nl lw nm bi translated">基本web部署</h2><p id="200c" class="pw-post-body-paragraph jo jp hi jq b jr ly ij jt ju lz im jw jx ma jz ka kb mb kd ke kf mc kh ki kj hb bi translated">对于<a class="ae jn" href="https://timosch.shinyapps.io/dashboard_example/#section-test-plotly-and-shiny-elements" rel="noopener ugc nofollow" target="_blank">反应式web应用</a>，Flexdashboard需要部署在web服务器上。你可以在<a class="ae jn" href="https://www.shinyapps.io/" rel="noopener ugc nofollow" target="_blank"> shinyapps.io </a>上轻松做到这一点，你需要有一个帐户来部署，你可以有五个免费版本的应用程序。部署Rmd文件就像部署一个闪亮的应用程序一样简单。</p><p id="212c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您可以将应用程序部署在自己的服务器上，或者作为AWS部署在云服务上。我建议将应用程序部署在一个<strong class="jq hj"> </strong> Docker容器中。在本系列文章的第二部分中，您将了解为什么以及应该如何做，这部分文章是<a class="ae jn" rel="noopener" href="/analytics-vidhya/deploying-a-shiny-flexdashboard-with-docker-cca338a10d12"> <strong class="jq hj">使用Docker </strong> </a> <strong class="jq hj">部署闪亮的Flexdashboard。</strong></p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h2 id="6336" class="mz lh hi bd li na nb nc lm nd ne nf lq jx ng nh ls kb ni nj lu kf nk nl lw nm bi translated">更新:改进Flexdashboard的渲染时间</h2><p id="de5c" class="pw-post-body-paragraph jo jp hi jq b jr ly ij jt ju lz im jw jx ma jz ka kb mb kd ke kf mc kh ki kj hb bi translated">如果您将<code class="du lb lc ld le b">runtime: shiny</code>改为<code class="du lb lc ld le b">runtime: shiny_prerendered</code>，您现在可以显著提高Flexdashboard的反应时间。默认情况下，使用这个选项，当Rmd文件被渲染时，每个代码块都会被渲染一次。您应该设置knitr chunk选项<code class="du lb lc ld le b">context="server”</code>来指定代码，该代码包含应用程序的反应部分，该部分根据用户交互来执行。设置为“数据”或“设置”的上下文允许在渲染和服务器上下文之间高性能地共享对象。您还可以设置一个块选项<code class="du lb lc ld le b">cache=TRUE</code>来缓存预先计算的结果，并设置无效条件。更多信息请见<a class="ae jn" href="https://rmarkdown.rstudio.com/authoring_shiny_prerendered.html" rel="noopener ugc nofollow" target="_blank">https://rmarkdown . r studio . com/authoring _ shiny _ prerendered . html</a>。</p></div></div>    
</body>
</html>