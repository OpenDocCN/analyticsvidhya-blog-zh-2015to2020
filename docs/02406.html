<html>
<head>
<title>Credit Default Analysis using Machine Learning from scratch ( Part 1 )</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从零开始使用机器学习的信用违约分析(第一部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/credit-default-analysis-using-machine-learning-from-scratch-part-1-8dbaad1fae14?source=collection_archive---------5-----------------------#2019-12-15">https://medium.com/analytics-vidhya/credit-default-analysis-using-machine-learning-from-scratch-part-1-8dbaad1fae14?source=collection_archive---------5-----------------------#2019-12-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b7e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两部分系列的第一部分。我将在这里介绍预处理，在另一部分介绍建模。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/612574c609da557bd33d0cd1dad03772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*Yh5gBI9Q1HNQ8d7EprNzcg.png"/></div></figure><p id="5379" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，感谢你来到这里。写这篇博客让我非常兴奋，因为这是我第一篇关于数据科学的博客。这将是一个由两部分组成的系列。我将在这里讨论问题陈述和预处理，并在另一部分做建模工作。</p><p id="c20e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">part 2<a class="ae jm" rel="noopener" href="/@saketgarodia/credit-default-analysis-using-machine-learning-from-scratch-part-of-the-series-2-194d2d78a1a7?source=friends_link&amp;sk=7e202b3e71034ed1e3506e38cd31ca07">https://medium . com/@ saketgarodia/credit-default-analysis-using-machine-learning-from-scratch-part-of-the-series-2-194d 2d 78 a 1a 7？source = friends _ link&amp;sk = 7e 202 B3 e 71034 ed1e 3506 e 38 CD 31 ca 07</a></p><p id="6307" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个项目来自Kaggle的一个竞赛。下面是链接:【https://www.kaggle.com/c/GiveMeSomeCredit】<em class="jd"><em class="jd">。你甚至可以通过这个链接查看我的木星笔记本(</em><a class="ae jm" href="https://github.com/garodisk/Credit-Default-Analysis-/blob/master/preprocessing.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/garo disk/Credit-Default-Analysis-/blob/master/preprocessing . ipynb</a>)</em></p><p id="245c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目标</strong>:通过预测某人在未来两年内遭遇财务困境的概率，提高信用评分的技术水平。</p><h1 id="3e29" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="ak">导入必要的库并读取数据集</strong></h1><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="9bd4" class="kq jo hi km b fi kr ks l kt ku">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import os<br/>np.set_printoptions(edgeitems=10)<br/>np.core.arrayprint._line_width = 180<br/>df = pd.read_csv('cs-training (1).csv')<br/>print(df.head())<br/>print(df.columns)<br/>print(df.shape)<br/>print(df.dtypes)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kv"><img src="../Images/32792c82c4b0d358709beb444fdb4b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*SNPgNX2Gi9zCo4bFa8CFHw.png"/></div></figure><p id="a052" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，我们拥有大约150，000名客户及其各种属性的数据。一些属性是消费者特征，一些属性是关于他们的行为。我们要预测的变量是“SeriousDlqin2yrs”。当“seriousdlqin 2 yers”= = 0时，这意味着该客户与银行无关，当该值为1时，该客户极有可能违约。让我们从一些预处理开始，因为我们手头的数据相当混乱，并且肯定会有许多缺失值、异常值等，这些对于建模目的是无用的。在开始之前，这里有一个不同预测的描述:</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="a98d" class="kq jo hi km b fi kr ks l kt ku">df.SeriousDlqin2yrs = (df.SeriousDlqin2yrs).astype(‘category’)<br/>df.describe()<br/>df.info()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kw"><img src="../Images/716c4bffc272eeed44e5d1101b9cef5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4w8Om3Z3yOEOWl69niCc7Q.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lb"><img src="../Images/03916b2eec91426d47de671021a53630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4xsR0fYb6fQ0cq9THBusTA.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lc"><img src="../Images/3f4396b6c0ee4bea07e86ad5808af359.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*s_SamTrzVkTNKI2oyEx2AQ.png"/></div></figure><h1 id="c934" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">缺失值分析</h1><p id="746a" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">很明显，我们可以看到‘月收入’(~ 20%)和‘依赖人数’(~ 3%)有一些缺失值。根据我们的直觉，我们知道月收入是信用评分的一个重要预测指标，因此我们不会丢弃这些数据点，并找到最佳策略来替换空值。</p><p id="3f54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们首先探索当月收入为“非空”和月收入为“空”时，所有其他预测因素的分布是否有差异。</p><p id="eada" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当月收入为“非空”时，第一列显示不同预测值的ECDF，当月收入为“空”时，第二列显示相同的预测值。</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="8f98" class="kq jo hi km b fi kr ks l kt ku">df_mis_inc = df[df[‘MonthlyIncome’].isna()]<br/>df_not_mis_inc = df[df[‘MonthlyIncome’].notna()]<br/>varNames = [‘RevolvingUtilizationOfUnsecuredLines’, ‘age’, ‘NumberOfTime30–59DaysPastDueNotWorse’, ‘DebtRatio’, ‘NumberOfOpenCreditLinesAndLoans’, ‘NumberOfTimes90DaysLate’, ‘NumberRealEstateLoansOrLines’, ‘NumberOfTime60–89DaysPastDueNotWorse’, ‘NumberOfDependents’]<br/>import numpy as np<br/>from statsmodels.distributions.empirical_distribution import ECDF</span><span id="55d0" class="kq jo hi km b fi li ks l kt ku">def visualizeECDF( variable,data):<br/>df = data[:]<br/>ecdf = ECDF(df[variable])<br/>x = np.linspace(min(df[variable]), np.percentile(df[variable],99.9))<br/>y = ecdf(x)<br/>plt.step(x, y)</span><span id="933f" class="kq jo hi km b fi li ks l kt ku">np.random.seed(100)<br/>fig, axes = plt.subplots(nrows=10, ncols=2)<br/>fig.tight_layout()<br/>fig.set_figheight(45)<br/>fig.set_figwidth(15)<br/>plt.subplots_adjust(hspace=0.5)</span><span id="05a0" class="kq jo hi km b fi li ks l kt ku"><br/>for i in [1,3,5,7,9,11,13,15,17]:<br/>ax = plt.subplot(9,2,i)<br/>ax.set_title(varNames[(i-1)//2])<br/>visualizeECDF(varNames[(i-1)//2], data = df_not_mis_inc)<br/>ax = plt.subplot(9,2,i+1)<br/>ax.set_title(varNames[(i-1)//2])<br/>visualizeECDF(varNames[(i-1)//2], data = df_mis_inc)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lj"><img src="../Images/59c924403dfcb7ed6ed12311884fd8cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*62Q9-uT_8KiYcXfszYhRWQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lo"><img src="../Images/2a0905a1422f09ce9b77323cc20aa787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXOLt4r2O9vlHfTujgTnjw.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lp"><img src="../Images/b888a3c1f507c2f860978ed39ec6790d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eis6Ht_OaOFIJJ59H7tTAw.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lj"><img src="../Images/171a8326dfe4bb284cae022d77be117a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fADkbLJ-rue-KfkhhX0LYw.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lq"><img src="../Images/c5a3876abcfd88a5810ea5dcb2653509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C7UuCzkATj0-4pInPLhf0A.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lr"><img src="../Images/e663168655dc4c8cf746e1be4d91338d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4O4pYZn1TUaJc5i5yCdQQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ls"><img src="../Images/65daabcc3e8ff009502a2542b5a116ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B829QRVcwteP5_CYOfD_oA.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lt"><img src="../Images/899b8ad23c9c460b5c08a5cf331ec84b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yVnFDzXXavbA0cYYAJoXwg.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">左—月收入为零；对-月收入不为空</figcaption></figure><p id="87e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以清楚地看到，除了负债率之外，所有的分布几乎相似。月收入‘非空’时的负债率分布与月收入‘空’时的分布不同。现在让我们看看负债比率的总体分布。</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="df6b" class="kq jo hi km b fi kr ks l kt ku">perc = range(81)</span><span id="e449" class="kq jo hi km b fi li ks l kt ku">val = []</span><span id="c729" class="kq jo hi km b fi li ks l kt ku">for i in perc:</span><span id="22a1" class="kq jo hi km b fi li ks l kt ku">val.append(np.percentile(df[‘DebtRatio’],i ))</span><span id="9a70" class="kq jo hi km b fi li ks l kt ku">import matplotlib.pyplot as plt</span><span id="d0aa" class="kq jo hi km b fi li ks l kt ku">plt.plot(perc, val, ‘go — ‘, linewidth=2, markersize=12)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lu"><img src="../Images/9aa3541507dcc3fece9aa5f5ff4a4c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*ygkvwekW3gRRzwvLy-ElDQ.png"/></div></figure><p id="63df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下面的代码和可视化中，我们将看到缺失收入子集的“脱层”与其他子集的前1个百分位数的“脱层”值具有相同的分布。</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="eb8c" class="kq jo hi km b fi kr ks l kt ku">perc1 = [99.0,99.1,99.2,99.3,99.4,99.5,99.6,99.7,99.8,99.9]<br/>perc2 = [0,10,20,30,40,50,60,70,80,90]<br/>val1 = []<br/>val2 = []</span><span id="ef78" class="kq jo hi km b fi li ks l kt ku">for i in perc1:<br/>val1.append(np.percentile(df_not_mis_inc[‘DebtRatio’],i))</span><span id="0a41" class="kq jo hi km b fi li ks l kt ku">for i in perc2:<br/>val2.append(np.percentile(df_mis_inc[‘DebtRatio’],i))</span><span id="05f4" class="kq jo hi km b fi li ks l kt ku">plt.plot(perc1,val1)<br/>plt.show()<br/>plt.plot(perc2,val2)<br/>plt.show()<br/></span></pre><h2 id="3343" class="kq jo hi bd jp lv lw lx jt ly lz ma jx iq mb mc kb iu md me kf iy mf mg kj mh bi translated">负债比率的前1%分布</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mi"><img src="../Images/e24ca145977544580618a8c88435cbaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*MhiDqKz5rxlouKbOvRn_9w.png"/></div></figure><h2 id="171e" class="kq jo hi bd jp lv lw lx jt ly lz ma jx iq mb mc kb iu md me kf iy mf mg kj mh bi translated">月收入为空时的负债比率分布</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mj"><img src="../Images/5aa3e740a471ca8421fdeb91dd5cd6d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*8MXXRNP94fWd7P6AvpZMBQ.png"/></div></figure><p id="3bf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述分析表明，我们可以使用对应于最高1%负债比率的月收入值来估算月收入，我们得到的负债比率为0.23 ~ 0。因此，我们将用0来估算月收入。这听起来也很直观，因为非常高的债务值通常对应于vesy less月收入，这里是0。同样，我们看到了“无依无靠者”的分布，但我们无法获得任何有用的信息，所以我们只是用中间值0来估算。</p><p id="497e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的下一步是检查异常值</p><h1 id="2634" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">异常值分析</h1><p id="c9a4" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">首先，我们将使用一个基本的箱线图分析来了解异常值。让我们看看有多少值超过了中位数的1.5 IQR。</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="1cbf" class="kq jo hi km b fi kr ks l kt ku">cols = df1.columns</span><span id="d950" class="kq jo hi km b fi li ks l kt ku">for i in cols:<br/>Low_Bound = ((np.percentile(df[i],25)) — 1.5*np.subtract(*np.percentile(df[i],[75,25])))<br/>Upp_Bound = ((np.percentile(df[i],75)) + 1.5*np.subtract(*np.percentile(df[i],[75,25])))<br/>df1[i] = df[i].apply(lambda x : 1 if(x &lt; Low_Bound or x &gt; Upp_Bound) else 0 )<br/>print(df1.sum(axis = 0, skipna = True))</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mk"><img src="../Images/8ba8477fd9bb157e1478880069c83c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*vlFjrNXfPJhWOnd5vc9gww.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">箱线图中异常值的数量</figcaption></figure><p id="4843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，总的来说，我们有大约47%的数据点包含一个或多个异常值。我们不能删除这些数据点，因为我们可能会丢失大量信息。因此，让我们来看看与严重犯罪高度相关的预测因素。像“30-59天的工作日”、“90天的工作日”、“年龄”、“60-89天的工作日”这样的变量与严重的违法行为高度相关。让我们看看他们的价值使用熊猫的价值计数功能来分析离群值。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ml"><img src="../Images/8bf9fc3ff988500a7f1ccb760de9353f.png" data-original-src="https://miro.medium.com/v2/resize:fit:214/format:webp/1*i6bqylsz-I1dR_jyIlizig.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">“number of time 30–59dayspastduenotbraster”的值计数</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mm"><img src="../Images/e7bbaacafea81a20878fc63b59ac219d.png" data-original-src="https://miro.medium.com/v2/resize:fit:206/format:webp/1*P4q6TkDuky9zuLZWbsj3Zg.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">“NumberOfTimes90DaysLate”的Value_counts</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mn"><img src="../Images/0e20e16da42289fe88dfcf0196c10863.png" data-original-src="https://miro.medium.com/v2/resize:fit:216/format:webp/1*cDxkW0iB7Zq_yCO_XQZM4w.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">“number of time 60–89dayspastduenotbraster”的Value_counts</figcaption></figure><p id="28fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，所有这3个预测值只有很少的数据点具有较高的值96和98，但大多数值和中位数都在15左右。这可能是由于一些打字错误或一些数据错误。虽然它不太可能默认98次，但可能会有一些客户具有这些值，但这对预测建模没有用，因为无论如何建模都无法检测到像这样的极端异常值。因此，我们将所有这些值限制为20。</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="23ee" class="kq jo hi km b fi kr ks l kt ku">#Capping<br/>df.loc[df[‘NumberOfTime30–59DaysPastDueNotWorse’]&gt;20,’NumberOfTime30–59DaysPastDueNotWorse’] = 20</span><span id="7b7d" class="kq jo hi km b fi li ks l kt ku">df.loc[df[‘NumberOfTimes90DaysLate’]&gt;20,’NumberOfTimes90DaysLate’] = 20</span><span id="a910" class="kq jo hi km b fi li ks l kt ku">df.loc[df[‘NumberOfTime60–89DaysPastDueNotWorse’]&gt;20,’NumberOfTime60–89DaysPastDueNotWorse’] = 20</span></pre><p id="7e91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以类似的方式，我们将把“NumberRealEstateLoansOrLines”限制为30，“NumberOfOpenCreditLinesAndLoans”限制为40。</p><p id="3572" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们看看其余3个连续变量“RevolvingUtilizationOfUnsecuredLines”、“DebtRatio”和“MonthlyIncome”的分布</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="a4de" class="kq jo hi km b fi kr ks l kt ku">varNames = [‘RevolvingUtilizationOfUnsecuredLines’, ‘DebtRatio’, ‘MonthlyIncome’]<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>from statsmodels.distributions.empirical_distribution import ECDF</span><span id="b2c8" class="kq jo hi km b fi li ks l kt ku">def visualizeECDF( variable,data):<br/>df = data[:]<br/>ecdf = ECDF(df[variable])<br/>x = np.linspace(min(df[variable]), np.percentile(df[variable],99.5))<br/>y = ecdf(x)<br/>plt.step(x, y)</span><span id="7b20" class="kq jo hi km b fi li ks l kt ku">np.random.seed(100)<br/>fig, axes = plt.subplots(nrows=3, ncols=2)<br/>fig.tight_layout()<br/>fig.set_figheight(10)<br/>fig.set_figwidth(15)<br/>plt.subplots_adjust(hspace=0.5)</span><span id="0b91" class="kq jo hi km b fi li ks l kt ku">ax = plt.subplot(3,2,1)<br/>ax.set_title(varNames[0])<br/>visualizeECDF(varNames[0], data = df)</span><span id="3ec4" class="kq jo hi km b fi li ks l kt ku">perc = [97.5,98,98.5,99,99.5,100]<br/>val = []</span><span id="338e" class="kq jo hi km b fi li ks l kt ku">for i in perc:<br/>val.append(np.percentile(df[‘RevolvingUtilizationOfUnsecuredLines’],i ))<br/>ax = plt.subplot(3,2,2)<br/>ax.set_title(varNames[0])<br/>plt.plot(perc, val, ‘go — ‘, linewidth=2, markersize=12)</span><span id="2d34" class="kq jo hi km b fi li ks l kt ku">ax = plt.subplot(3,2,3)<br/>ax.set_title(varNames[1])<br/>visualizeECDF(varNames[1], data = df)</span><span id="d75f" class="kq jo hi km b fi li ks l kt ku">perc = [97.5,98,98.5,99,99.5,100]<br/>val = []</span><span id="2638" class="kq jo hi km b fi li ks l kt ku">for i in perc:<br/>val.append(np.percentile(df[‘DebtRatio’],i ))<br/>ax = plt.subplot(3,2,4)<br/>ax.set_title(varNames[1])<br/>plt.plot(perc, val, ‘go — ‘, linewidth=2, markersize=12)</span><span id="76b3" class="kq jo hi km b fi li ks l kt ku"><br/>ax = plt.subplot(3,2,5)<br/>ax.set_title(varNames[2])<br/>visualizeECDF(varNames[2], data = df)</span><span id="e21d" class="kq jo hi km b fi li ks l kt ku">perc = [97.5,98,98.5,99,99.5,100]<br/>val = []<br/>for i in perc:<br/>val.append(np.percentile(df[‘MonthlyIncome’],i ))<br/>ax = plt.subplot(3,2,6)<br/>ax.set_title(varNames[2])<br/>plt.plot(perc, val, ‘go — ‘, linewidth=2, markersize=12)</span></pre><p id="4aa8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ECDF地块</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es mo"><img src="../Images/74610b4486bbdba39ca2c1e9cb86e58e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n7fu_ZAUt7VVQiJ_9zivUA.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">完全分配与最高2.5个百分点分配(无担保贷款的循环利用)</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es mp"><img src="../Images/53edb5d62a4a24f97c0de9a5ca445651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ssRcms2KNDVyBLB2zRELZQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">完全分布与最高2.5个百分点分布(债务比率)</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es mq"><img src="../Images/3a8e0e7830321511ac5ec163c1e02b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5S-8nyJ1JSLS0VGJflwGA.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">完全分布与最高2.5个百分点分布(月收入)</figcaption></figure><p id="bafe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以从显示前2.5个百分点值分布的第二列中清楚地看到，这些值在99.5个百分点后突然跳跃，这意味着我们可以从所有这3个预测值中删除前0.5个百分点值，因为它们会干扰我们的建模</p><pre class="jf jg jh ji fd kl km kn ko aw kp bi"><span id="5038" class="kq jo hi km b fi kr ks l kt ku">df1 = df[[‘RevolvingUtilizationOfUnsecuredLines’, ‘DebtRatio’, ‘MonthlyIncome’]]</span><span id="2d8d" class="kq jo hi km b fi li ks l kt ku">var1_cap = np.percentile(df[‘RevolvingUtilizationOfUnsecuredLines’],99.5)</span><span id="3e6d" class="kq jo hi km b fi li ks l kt ku">var2_cap = np.percentile(df[‘DebtRatio’],99.5)</span><span id="f39e" class="kq jo hi km b fi li ks l kt ku">var3_cap = np.percentile(df[‘MonthlyIncome’],99.5)</span><span id="19ac" class="kq jo hi km b fi li ks l kt ku">print(var1_cap)</span><span id="dff2" class="kq jo hi km b fi li ks l kt ku">print(var2_cap)</span><span id="d34c" class="kq jo hi km b fi li ks l kt ku">print(var3_cap)</span><span id="6321" class="kq jo hi km b fi li ks l kt ku">df1[‘RevolvingUtilizationOfUnsecuredLines’] = df1[‘RevolvingUtilizationOfUnsecuredLines’].apply(lambda x : x if x&lt;=var1_cap else var1_cap)</span><span id="da2f" class="kq jo hi km b fi li ks l kt ku">df1[‘DebtRatio’] = df1[‘DebtRatio’].apply(lambda x : x if x&lt;=var1_cap else var1_cap)</span><span id="4e2a" class="kq jo hi km b fi li ks l kt ku">df1[‘MonthlyIncome’] = df1[‘MonthlyIncome’].apply(lambda x : x if x&lt;=var1_cap else var1_cap)</span></pre><p id="0c09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经处理了缺失值和异常值，我们可以开始建模了。我将在本系列的第2部分讨论这些数据的建模。下面是PART2的链接——<a class="ae jm" rel="noopener" href="/@saketgarodia/credit-default-analysis-using-machine-learning-from-scratch-part-of-the-series-2-194d2d78a1a7?source=friends_link&amp;sk=7e202b3e71034ed1e3506e38cd31ca07">https://medium . com/@ saketgarodia/credit-default-analysis-using-machine-learning-from-scratch-part-of-the-series-2-194d 2d 78 a 1a 7？source = friends _ link&amp;sk = 7e 202 B3 e 71034 ed1e 3506 e 38 CD 31 ca 07</a></p><p id="84cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请在这里发表对我的代码或博客的任何反馈或改进。我将很高兴接待他们。</p><p id="f47f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢你阅读:D</p></div></div>    
</body>
</html>