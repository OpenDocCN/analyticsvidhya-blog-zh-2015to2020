<html>
<head>
<title>Covid-19: Genetic Mutation or Engineering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎:基因突变还是工程</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/covid-19-genetic-mutation-or-engineering-a55afe359659?source=collection_archive---------24-----------------------#2020-04-18">https://medium.com/analytics-vidhya/covid-19-genetic-mutation-or-engineering-a55afe359659?source=collection_archive---------24-----------------------#2020-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="6adc" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Python中的运动图表可视化</h2></div><blockquote class="ix iy iz"><p id="dcf6" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><a class="ae jx" href="https://www.smh.com.au/politics/federal/virus-will-leave-an-economic-impact-for-decades-20200406-p54hk9.html" rel="noopener ugc nofollow" target="_blank">病毒会给经济留下几十年的影响</a>。</p></blockquote><p id="1556" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated"><em class="jc">利用</em> <strong class="jd hj"> <em class="jc">长期</em> </strong> <em class="jc"> </em> <strong class="jd hj"> <em class="jc">利率</em> </strong> <em class="jc"> </em> <strong class="jd hj"> <em class="jc">数据</em> </strong> <em class="jc">等资料来源来考察历史上12次大流行的经济影响，研究人员从持续40年的大流行中发现了“显著的宏观经济后效”。</em></p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="21ce" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">在本文中，我让数据自己说话。</h1><p id="d6c5" class="pw-post-body-paragraph ja jb hi jd b je la ij jg jh lb im jj jy lc jm jn jz ld jq jr ka le ju jv jw hb bi translated">一张<strong class="jd hj">视觉</strong> <strong class="jd hj">动作图</strong><strong class="jd hj">从3个角度说明了不同国家疫情</strong>的趋势，有很多话要说…</p><ol class=""><li id="8372" class="lf lg hi jd b je jf jh ji jy lh jz li ka lj jw lk ll lm ln bi translated">确诊病例数</li><li id="254f" class="lf lg hi jd b je lo jh lp jy lq jz lr ka ls jw lk ll lm ln bi translated">恢复的病例数</li><li id="9315" class="lf lg hi jd b je lo jh lp jy lq jz lr ka ls jw lk ll lm ln bi translated">死亡人数</li></ol><h2 id="2858" class="lt kj hi bd kk lu lv lw ko lx ly lz ks jy ma mb ku jz mc md kw ka me mf ky mg bi translated">数据源</h2><p id="59d1" class="pw-post-body-paragraph ja jb hi jd b je la ij jg jh lb im jj jy lc jm jn jz ld jq jr ka le ju jv jw hb bi translated">我从约翰·霍普金斯大学系统科学与工程中心(JHU·CSSE)<strong class="jd hj"/>运营的<a class="ae jx" href="https://github.com/maziarizadi/COVID-19" rel="noopener ugc nofollow" target="_blank">数据源</a>获取数据。此外，由<strong class="jd hj"> ESRI生活地图集团队</strong>和<strong class="jd hj">约翰霍普金斯大学应用物理实验室(JHU APL) </strong>支持。</p><figure class="mh mi mj mk fd ml"><div class="bz dy l di"><div class="mm mn l"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">截至2020年4月6日，新冠肺炎在死亡人数超过1万人的国家爆发</figcaption></figure></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="1b20" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">这项工作的Python代码在我的<a class="ae jx" href="https://github.com/maziarizadi/COVID-19" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上完全可用，所以我尽量让它更通用。</p><p id="71cf" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">上面的动作图是用5个维度创建的:</p><ol class=""><li id="0c72" class="lf lg hi jd b je jf jh ji jy lh jz li ka lj jw lk ll lm ln bi translated">x轴:确诊病例数<strong class="jd hj"/></li><li id="1899" class="lf lg hi jd b je lo jh lp jy lq jz lr ka ls jw lk ll lm ln bi translated">y轴:回收的<strong class="jd hj">箱数</strong></li><li id="4178" class="lf lg hi jd b je lo jh lp jy lq jz lr ka ls jw lk ll lm ln bi translated">圆圈颜色:<strong class="jd hj">国家</strong></li><li id="9017" class="lf lg hi jd b je lo jh lp jy lq jz lr ka ls jw lk ll lm ln bi translated">圆圈大小:死亡人数<strong class="jd hj">死亡人数</strong></li><li id="9dea" class="lf lg hi jd b je lo jh lp jy lq jz lr ka ls jw lk ll lm ln bi translated"><strong class="jd hj">时间</strong></li></ol></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="818d" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">让我们让数据运转起来</h1><figure class="mh mi mj mk fd ml"><div class="bz dy l di"><div class="ms mn l"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">资料来源:www.giphy.com</figcaption></figure><p id="6ec7" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">给定的数据被从<a class="ae jx" href="https://github.com/CSSEGISandData/COVID-19" rel="noopener ugc nofollow" target="_blank"> <strong class="jd hj"> JHU CSSE新冠肺炎</strong> </a> <strong class="jd hj"> </strong>分支到我的github中，使用<code class="du mt mu mv mw b">os</code>库，我查看Github文件夹并打印内容。</p><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es mx"><img src="../Images/01ebc9c168f840479f552b785726ad50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*44dMs50u9vYqwZATqErUlQ.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">打印Github文件夹的内容</figcaption></figure><p id="40bf" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">在所有的内容中，我把三个有标记的文件分成三个独立的<code class="du mt mu mv mw b">pandas</code>数据帧，下面是我打印的样本。</p><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es ne"><img src="../Images/883d8f1b8fd89fdc67740bad550b7c7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wMSX7jxeZEnMb0FpQGBjw.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">time _ series _ covid 19 _ deaths _ global . CSV到数据帧的前5行(<strong class="bd kk">在预处理</strong>之前)</figcaption></figure><h1 id="3fa0" class="ki kj hi bd kk kl nf kn ko kp ng kr ks io nh ip ku ir ni is kw iu nj iv ky kz bi translated">预处理数据</h1><p id="5fb7" class="pw-post-body-paragraph ja jb hi jd b je la ij jg jh lb im jj jy lc jm jn jz ld jq jr ka le ju jv jw hb bi translated">像往常一样，我们需要为消费准备数据。我们想要的数据框架必须如下图所示，有5列。</p><p id="ed3e" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">我将解释三个数据帧中的一个的过程，因为它们都是以完全相同的方式完成的。</p><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es nk"><img src="../Images/f9dd547a99500bf7b07dca43e9409ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FFLI6S6sgzEgpeKGBLFG3Q.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">运动图表创建所需的数据格式(预处理后的<strong class="bd kk"/></figcaption></figure><p id="2989" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">看这两个数据结构，很明显我们需要做一些准备。为此，让我们从原始数据框中删除额外的列。</p><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="eac6" class="lt kj hi mw b fi np nq l nr ns">new_data_conf = data_conf.drop(columns=['Province/State','Lat', 'Long'])</span></pre><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es nt"><img src="../Images/a069513ce6d99897a8e16fa6d3b2177d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7v5cOrof8_lAhxY6ZsoEtA.png"/></div></div></figure><p id="7ce3" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">接下来，我们需要将所有内容转换成列。有许多方法可以做到这一点。我的方法是使用基于国家名称的<code class="du mt mu mv mw b">groupby</code>将它们统一到唯一的行中。(请记住，在原始数据集中，由于“省/州”字段，同一国家在多行中重复出现)。</p><blockquote class="ix iy iz"><p id="d4ce" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">关于<code class="du mt mu mv mw b">groupby()</code>的快速说明。对于我已经使用了<code class="du mt mu mv mw b">mean()</code>的数字列，需要使用数学函数。</p></blockquote><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="191a" class="lt kj hi mw b fi np nq l nr ns">new_data_conf = new_data_conf.groupby(['Country/Region'])[new_data_conf.columns].sum()</span></pre><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es nu"><img src="../Images/ae0d2e1d740ee4aa570a2fdd2f06fd7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yrl-SR8Y4fSqCyhLqouYmg.png"/></div></div></figure><p id="f40a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">现在，为了将<code class="du mt mu mv mw b">date</code>转换成列，我使用了<code class="du mt mu mv mw b">transpose()</code>、<code class="du mt mu mv mw b">reset_index()</code>，最后是<code class="du mt mu mv mw b">rename()</code>。</p><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="98f2" class="lt kj hi mw b fi np nq l nr ns">new_data_conf=new_data_conf.transpose()</span><span id="afa0" class="lt kj hi mw b fi nv nq l nr ns">new_data_conf.reset_index(level=0, inplace=True)</span><span id="d7bb" class="lt kj hi mw b fi nv nq l nr ns">new_data_conf.rename(columns={'index' : 'Date'}, inplace=True)</span></pre><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es nw"><img src="../Images/44d78ce9c514a13ad512a192ab3d6c29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6UZ8TZW-VqY1vqkhitia9g.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">time _ series _ covid 19 _ deaths _ global . CSV到数据帧的前5行</figcaption></figure><p id="2e09" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">接下来，我们需要<code class="du mt mu mv mw b">melt</code>数据框来创建另一个包含国家名称的列，这样我们就可以将“已确认”、“已恢复”和“死亡”病例的值作为三个单独的列相加，从而得到我们想要的结构。</p><ol class=""><li id="b0cb" class="lf lg hi jd b je jf jh ji jy lh jz li ka lj jw lk ll lm ln bi translated"><code class="du mt mu mv mw b">melt</code>每个数据帧分开:</li></ol><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="9452" class="lt kj hi mw b fi np nq l nr ns">cols = new_data_conf.columns.tolist()</span><span id="7c69" class="lt kj hi mw b fi nv nq l nr ns">new_data_conf = new_data_conf.melt(id_vars='Date', value_vars=cols[2:])</span></pre><p id="00d9" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">2.使用<code class="du mt mu mv mw b">merge</code>逐个加入他们:</p><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="f5da" class="lt kj hi mw b fi np nq l nr ns"><strong class="mw hj">new_df</strong> = pd.merge(<strong class="mw hj">new_data_conf</strong>, <strong class="mw hj">new_data_reco</strong>,  how='left', left_on=['Date','Country/Region'], right_on = ['Date','Country/Region'])</span><span id="978c" class="lt kj hi mw b fi nv nq l nr ns"><strong class="mw hj">final_df</strong> = pd.merge(<strong class="mw hj">new_df</strong>, <strong class="mw hj">new_data_death</strong>,  how='left', left_on=['Date','Country/Region'], right_on = ['Date','Country/Region'])</span></pre><p id="2a37" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">我们得到了我们想要的数据帧💪</p><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es nx"><img src="../Images/c6c18062f37d1592bc562dba2e4f9428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OkDGLF-v5Dlg6j6hVvPjSg.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">五列理想数据帧</figcaption></figure><p id="ad6c" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">还有最后一步，那就是绘制实际的<strong class="jd hj"> <em class="jc">运动图</em> </strong>。但在此之前，为了获得更好的结果，我想根据“确诊”病例数最高的国家来筛选数据。</p><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="4d62" class="lt kj hi mw b fi np nq l nr ns">top_countries = final_df.loc[final_df['Confirmed_Cases'] &gt; 15000]<br/>top_countries_set = set(top_countries['Country/Region'])</span></pre><blockquote class="ix iy iz"><p id="9960" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">输出列表反映了截至该日期(4月15日)的国家列表。</p></blockquote><p id="3bb8" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">3.选择行:</p><p id="d49a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">将选择的国家列表作为<code class="du mt mu mv mw b">set()</code>放入一个列表中，我使用<code class="du mt mu mv mw b">loc()</code>函数仅选择必填字段，并将其保存在<code class="du mt mu mv mw b">top_countries_df</code>数据框中。</p><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="58ac" class="lt kj hi mw b fi np nq l nr ns">top_countries_df = final_df.loc[final_df['Country/Region'].isin(top_countries_set)]<br/>top_countries_df</span></pre><h1 id="aa5e" class="ki kj hi bd kk kl nf kn ko kp ng kr ks io nh ip ku ir ni is kw iu nj iv ky kz bi translated">运动图表</h1><p id="4fe2" class="pw-post-body-paragraph ja jb hi jd b je la ij jg jh lb im jj jy lc jm jn jz ld jq jr ka le ju jv jw hb bi translated">为了绘制运动图，我们需要填写下面列出的超参数，剩下的是我们导入的<code class="du mt mu mv mw b">MotionChart</code>库</p><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="3ae7" class="lt kj hi mw b fi np nq l nr ns">from motionchart.motionchart import MotionChart</span><span id="54ce" class="lt kj hi mw b fi nv nq l nr ns">mChart = MotionChart(df = top_countries_df, key='Date', x='Confirmed_Cases', y='Recovered_Cases', xscale='linear', yscale='linear', size='Deaths', color='Country/Region', category='Country/Region')</span></pre><p id="7f70" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated"><code class="du mt mu mv mw b">key</code>:“日期”将是我的图表的主要驱动力</p><p id="a317" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated"><code class="du mt mu mv mw b">x</code>轴:选择了“已确认”病例</p><p id="a9ae" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated"><code class="du mt mu mv mw b">y</code>轴:选择了“已恢复”案例</p><p id="831f" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">泡泡<code class="du mt mu mv mw b">size</code>:选择每个场景中‘死亡’的数量</p><p id="0ed7" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated"><code class="du mt mu mv mw b">category</code>:国家列表</p><p id="cbb1" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">这些是我的偏好，任何人都可以根据自己的喜好做出任何改变。</p><h2 id="e763" class="lt kj hi bd kk lu lv lw ko lx ly lz ks jy ma mb ku jz mc md kw ka me mf ky mg bi translated">出版</h2><p id="c767" class="pw-post-body-paragraph ja jb hi jd b je la ij jg jh lb im jj jy lc jm jn jz ld jq jr ka le ju jv jw hb bi translated">要发布图表，取决于您的环境。当我使用Jupyter笔记本时，我使用了<code class="du mt mu mv mw b">.to_notebook()</code>。要在web上发布相同的结果，您需要使用<code class="du mt mu mv mw b">.to_browser()</code>。</p><pre class="mh mi mj mk fd nl mw nm nn aw no bi"><span id="5326" class="lt kj hi mw b fi np nq l nr ns">mChart.to_notebook()</span></pre><p id="6744" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">这是最终结果:</p><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es ny"><img src="../Images/d90782fe3f5d6ed85b13db3366f985cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*htmw9vB1BBvAVLOVkSb-jA.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">截至2020年4月17日的最终图表</figcaption></figure><figure class="mh mi mj mk fd ml er es paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="er es nz"><img src="../Images/dff1d8e5fc33a821b6e584bf97f0e202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xIdWDU5e-WwvHCl4MzbX0Q.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">最终图形包括打开的滑动条</figcaption></figure></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="129a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jy jl jm jn jz jp jq jr ka jt ju jv jw hb bi translated">如果您有任何问题/反馈/意见，请在下面评论。</p><figure class="mh mi mj mk fd ml er es paragraph-image"><div class="er es oa"><img src="../Images/f15b370a88105811762a20876a58d856.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*XK0PLI-onm8LAL4Kv-jeng.gif"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">资料来源:giphy.com</figcaption></figure></div></div>    
</body>
</html>