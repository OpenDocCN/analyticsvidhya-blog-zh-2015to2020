<html>
<head>
<title>Conditional Probability | Bayes Theorem | Naïve Bayes Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">条件概率|贝叶斯定理|朴素贝叶斯分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/conditional-probability-bayes-theorem-na%C3%AFve-bayes-classifier-152f4bbc3e0f?source=collection_archive---------2-----------------------#2020-08-04">https://medium.com/analytics-vidhya/conditional-probability-bayes-theorem-na%C3%AFve-bayes-classifier-152f4bbc3e0f?source=collection_archive---------2-----------------------#2020-08-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/abf660a0bc6edf4e61dd685cb2086fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzynPkAViU1i9WIiJSdesg.png"/></div></div></figure><p id="0c41" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">你有没有想过:</p><p id="f23f" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">你的可疑/营销邮件是如何被自动放入垃圾邮件箱而不是主收件箱的？</p><p id="5d7e" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">我们如何预测今天是否会下雨？</p><p id="7987" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">如果你有这些问题，那就通读一下这篇文章，你就能大致了解这些预测是如何做出的，这在日常生活中非常有用。</p><p id="1234" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">在现实生活中，我们都面临这样的情况，即基于某些条件和先验知识，我们想要预测某个事件的发生，例如，我是一个板球迷，基于今天的天气条件，如温度和湿度水平，以及在这些条件下发生降雨的先验知识，我想计算我们是否会有比赛的概率，基于此，我想把我的赌注下在:D 身上</p><p id="f43c" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">在这篇文章中，我将试图解开朴素贝叶斯分类器如何工作的谜团。我们将继续进行:</p><ul class=""><li id="ec6d" class="jw jx hi ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke bi translated">基本术语、事件和概率</li><li id="a9a2" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">贝叶斯定理，基础和公式推导</li><li id="d686" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">朴素贝叶斯分类及实例</li><li id="a820" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">使用朴素贝叶斯方法的优点、缺点和假设</li></ul><h2 id="76d7" class="kk kl hi bd km kn ko kp kq kr ks kt ku jj kv kw kx jn ky kz la jr lb lc ld le bi translated"><strong class="ak">基本定义和术语:</strong></h2><ul class=""><li id="ff5c" class="jw jx hi ja b jb lf jf lg jj lh jn li jr lj jv kb kc kd ke bi translated"><strong class="ja hj">独立事件:</strong>如果事件连续发生，第一个事件的发生不影响第二个事件的成功/失败</li><li id="4a37" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">例如:如果我们掷骰子 3 次，我们想计算连续得到 3 个 6 的概率。它将是 1/6 * 1/6* 1/6，第一次掷骰子不会影响后续掷骰子得到 6 的概率。</li><li id="a295" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">相关事件:如果一个事件的发生影响了第二个事件的发生，我们称之为相关事件</li><li id="1cea" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">例如:如果我们从一副 52 张牌中随机抽取 4 张牌而不替换，如果我们要计算连续得到皇后的概率，它将是 4/52 * 3/51 * 2/50 * 1/49。这里抽一张皇后牌的概率从 4/52 变为 3/51，因为我们已经拿走了一张牌，那也是一张皇后牌，同样地，在第四次抽牌时，概率下降到 1/49</li><li id="885c" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated"><strong class="ja hj">条件概率:</strong>当我们试图计算一个条件下的概率，即事件 B 已经发生时，事件 A 发生的概率</li><li id="19a1" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">例如，如果我们从一副牌中一张一张地抽取 2 张牌，而没有替换，并且当我们知道第一张牌是一张女王时，我们对计算抽取一张女王的概率感兴趣</li></ul><h1 id="a908" class="lk kl hi bd km ll lm ln kq lo lp lq ku lr ls lt kx lu lv lw la lx ly lz ld ma bi translated"><strong class="ak">条件概率方程:</strong></h1><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mb"><img src="../Images/b3b8ccb54c0d544289de5f8bfafaa369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T1VJfJ11L6dRtIhEo7UknQ.png"/></div></div></figure><p id="e91c" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">让我们通过一个例子有一个清晰的画面。</p><p id="a657" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj">问题:问题:</strong></p><p id="050c" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">一个钱包里有 4、5 和 3 卢比面值的硬币。分别是 2，5 和 10。抽取两个硬币而不替换第一个抽取的硬币。查找 P(绘制 Rs.2，然后 Rs.2)</p><p id="46dc" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj"> <em class="mc">解决方案:</em> </strong></p><p id="b9c0" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">有四个 Rs 2 硬币，总共有 12 个硬币，所以</p><p id="aa4d" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">p(第一次抽取的 2 卢比硬币)= 4/12，即 1/3</p><p id="506d" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">第一次抽奖的结果影响了第二次抽奖的概率，因为第一次抽奖后，我们还剩 3 枚 2 卢比的硬币，现在我们总共有 11 枚硬币。</p><p id="b383" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">p(第二次抽取 2 卢比硬币)= 3/11</p><p id="f5a7" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">最后 P(画 Rs。2，那么 Rs 2 ) = (4/12)*(3/11) = <strong class="ja hj"> 1/11 </strong></p><h1 id="12f5" class="lk kl hi bd km ll lm ln kq lo lp lq ku lr ls lt kx lu lv lw la lx ly lz ld ma bi translated"><strong class="ak">贝叶斯定理基础及推导:</strong></h1><ul class=""><li id="6686" class="jw jx hi ja b jb lf jf lg jj lh jn li jr lj jv kb kc kd ke bi translated">在概率论中，<strong class="ja hj">贝叶斯定理</strong>描述了基于可能与事件相关的条件的先验知识的事件概率</li><li id="2879" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated"><strong class="ja hj">推导:</strong>贝叶斯定理是通过将下面提到的等式 1 和等式 2 的 P(A 和 B)等式化，通过条件概率等式推导出来的</li></ul><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es md"><img src="../Images/0521546ad3376945f5207ca27d0b45b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fuq-lkDpmuJOAuvz-sCB7A.png"/></div></div></figure><h1 id="2c52" class="lk kl hi bd km ll lm ln kq lo lp lq ku lr ls lt kx lu lv lw la lx ly lz ld ma bi translated">朴素贝叶斯分类器；</h1><p id="598b" class="pw-post-body-paragraph iy iz hi ja b jb lf jd je jf lg jh ji jj me jl jm jn mf jp jq jr mg jt ju jv hb bi translated">分类问题就像我们需要预测 y 的类别，其中提供了特征向量 X，也称为特征向量(X = [x1，x2，x3，x4，...]特征)。所以基于 X，我们需要计算 y 的类，数学上，当 X 发生时，我们可以用 y 来表示。</p><p id="e488" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><em class="mc">我们这里假设特征 x1、x2、x3 都是彼此独立的。</em></p><p id="76f6" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">如上所述，独立事件意味着不受先前事件影响的事件。在数学公式中，我们可以把独立概率写成如下。</p><p id="5b15" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">现在我们将推导朴素贝叶斯分类器方程:</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mh"><img src="../Images/1930df18e7e81fecb83a07c39dfa410c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6uYYMQ_XCYyb_TBA9_ZOg.png"/></div></div></figure><p id="ec46" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">对于 Y 的所有类，我们计算概率，具有 max(P)的类作为最终类返回</p><p id="4f62" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">Result = argmax{(Yi / x1 x2 x3..xn)}比如，如果我们有两类 Y，即 0 和 1，那么我们计算 P[Y = 1/x1 x2 x3…]和 P[Y=0 / x1 x2 x3 …]</p><p id="4d1b" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj"> <em class="mc">现在如果 P [Y=1] &gt; P[Y=0]那么返回 1 else 0 class。</em>T13】</strong></p><h2 id="a2c7" class="kk kl hi bd km kn ko kp kq kr ks kt ku jj kv kw kx jn ky kz la jr lb lc ld le bi translated">通过示例实现朴素贝叶斯:</h2><p id="7315" class="pw-post-body-paragraph iy iz hi ja b jb lf jd je jf lg jh ji jj me jl jm jn mf jp jq jr mg jt ju jv hb bi translated">假设我们得到了一些变量温度、风、湿度和天气的数据，我们需要知道我们是否会有一场板球比赛。我们得到了以下历史数据，今天的情况是(前景=晴朗，温度=炎热，湿度=正常，风=错误)。看看我们今天是否有比赛。</p><p id="7976" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">给定数据:</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mi"><img src="../Images/315eaacb91f71d3d1e0232971b3ea5ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vK3K4oAuPdxRPd0sYMlTWw.png"/></div></div><figcaption class="mj mk et er es ml mm bd b be z dx translated">输入数据</figcaption></figure><p id="9ad3" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">步骤 1:创建特征矩阵并分离出响应变量</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mn"><img src="../Images/41fcf62c317b552c68d92ded45d3e3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Hp6rCl0fL0K9M9M2VUVQA.png"/></div></div><figcaption class="mj mk et er es ml mm bd b be z dx translated">已创建特征矩阵</figcaption></figure><p id="3d8a" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">步骤 2:为所有特征创建频率表以找到 P(特征/是)和 P(特征/否)，这给出了每个 outlook 给定匹配被玩或没被玩的概率，如下:</p><p id="f650" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><em class="mc"> P(Sunny / Played= Yes)会是</em></p><p id="77cf" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><em class="mc">(比赛场次=是，前景=晴朗)/(总场次=是)即 4/9 </em></p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mo"><img src="../Images/85c9daf6cf0bab6a52c9794258aa9638.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhTM4MVABX4NXcvn1_VJ9g.png"/></div></div></figure><p id="782d" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">步骤 3:求 P(Y)，匹配概率=(匹配(是)/总数):</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mp"><img src="../Images/08209185795fd82fd8e4adf9cca456ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*cZfF7z9GwIMDZkgXvGaypw.png"/></div></figure><p id="048f" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj">来自朴素贝叶斯公式</strong></p><p id="13dc" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">计算玩游戏的概率:</p><p id="0013" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">p(是/(前景=晴朗，温度=热，湿度=正常，风=假))=</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mq"><img src="../Images/c5049522f5f735871219ce02504ab914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rclFtUXBvYf-9HkoL1bhlw.png"/></div></div></figure><p id="4bec" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">p(是/(前景=晴朗，温度=热，湿度=正常，风=假)))=</p><p id="b635" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">=(2/9 *2/9 *6/9 *6/9 )* (9/14) / P(晴)*P(热)* P(正常)*P(F)</p><p id="ad8f" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">= 144/(10206 *常数)</p><p id="b2e0" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><em class="mc">P[是]= 0.0141 *常数</em></p><p id="5f0e" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">计算不玩游戏的概率:</p><p id="3082" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">p(否/(前景=晴朗，温度=热，湿度=正常，风=假))=</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mq"><img src="../Images/90ea5d3da8d85d569632b7911b2485a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mI7vJ4nWwBVmGXEAIE5CBg.png"/></div></div></figure><p id="8b2e" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">p(否/(前景=晴朗，温度=热，湿度=正常，风=假)))=</p><p id="1869" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">=(2/5 *2/5 *1/5 *2/5 )* (5/14) / P(晴)*P(热)* P(正常)*P(F)</p><p id="c8f7" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">= 40/(8750 *常数)</p><p id="33fa" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">P[No]= <em class="mc"> 0.0045 *常数</em></p><p id="ff3c" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">这里 P[是]&gt; P[否]，所以最终预测的类将是<strong class="ja hj"><em class="mc">Y =是</em> </strong></p><p id="641b" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj">朴素贝叶斯的假设:</strong></p><ul class=""><li id="661a" class="jw jx hi ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke bi translated">所有特征都具有同等的权重</li><li id="f52a" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">所有的功能都是相互独立的</li></ul><p id="6df5" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj">朴素贝叶斯的优点:</strong></p><ul class=""><li id="c3b9" class="jw jx hi ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke bi translated">易于实施</li><li id="7d6f" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">速度快，需要更少的数据进行训练</li><li id="bbeb" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">如果假设成立，那么性能是伟大的</li></ul><p id="b48e" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj">朴素贝叶斯的缺点:</strong></p><ul class=""><li id="513e" class="jw jx hi ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke bi translated">对朴素贝叶斯的主要模仿是独立预测者的假设。</li><li id="80c0" class="jw jx hi ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke bi translated">如果分类变量在测试数据集中有一个类别，但在训练数据集中没有观察到，那么模型将分配 0(零)概率，并且将无法进行预测</li></ul><p id="35c4" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">非常感谢你的阅读。欢迎您的建议和问题。</p></div></div>    
</body>
</html>