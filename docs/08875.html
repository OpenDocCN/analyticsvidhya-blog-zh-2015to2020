<html>
<head>
<title>Understanding CatBoost Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解 CatBoost 算法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/catboost-101-fb2fdc3398f3?source=collection_archive---------5-----------------------#2020-08-17">https://medium.com/analytics-vidhya/catboost-101-fb2fdc3398f3?source=collection_archive---------5-----------------------#2020-08-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="b9dd" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">最好的 Boosting 算法之一</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e469ff9c2dc529e579f6d89377b6528f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*27JzEM5QHOcOygC7"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae jt" href="https://unsplash.com/@htroupe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">汉娜剧团</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="e718" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在这个快速教程中，我们将讨论:</p><ul class=""><li id="793a" class="ks kt hi jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">CatBoost 的起源。</li><li id="aed7" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">何时使用 CatBoost(哪种类型的数据)。</li><li id="46df" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">如何在任何数据集上实现 CatBoost？</li></ul><p id="f22a" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">CatBoost 起源于一家名为 Yandex 的俄罗斯公司。这是最新的助推算法之一，因为它在 2017 年推出。有许多增强算法，如 XGBoost、LightGBM 等。但是由于几个原因，没有一个能与 CatBoost 相比。</p><p id="1018" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">CatBoost 的意思是分类增强，因为它被设计为完美地处理分类数据，如果您的数据集中有分类数据的话</p><p id="b16e" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">下面是 CatBoost 的一些特性，这些特性使它有别于所有其他的 Boosting 算法。</p><ul class=""><li id="f5af" class="ks kt hi jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><strong class="jw hj">无需参数调谐的高品质</strong></li><li id="3597" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">分类特征支持</strong></li><li id="c0fe" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">快速且可扩展的 GPU 版本</strong></li><li id="4e3d" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">通过减少过拟合提高精度</strong></li><li id="8450" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">快速预测</strong></li><li id="3c06" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">在数据较少的情况下工作良好</strong></li></ul><p id="bc30" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">由于上面提到的原因，CatBoost 在最近的 Kaggle 比赛中备受喜爱，现在让我们回答另一个问题<strong class="jw hj">什么时候使用这个令人惊叹的 Boosting Algo？</strong></p><h1 id="a248" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">何时使用 CatBoost 算法？</h1><p id="ee49" class="pw-post-body-paragraph ju jv hi jw b jx lg jz ka kb lh kd ke kf li kh ki kj lj kl km kn lk kp kq kr hb bi translated">这里有两种类型的数据<strong class="jw hj">异构数据</strong>和<strong class="jw hj">同构数据</strong>。</p><blockquote class="ll lm ln"><p id="80b4" class="ju jv lo jw b jx jy jz ka kb kc kd ke lp kg kh ki lq kk kl km lr ko kp kq kr hb bi translated"><strong class="jw hj">异构数据:数据类型和格式可变性很大的数据。由于缺少值、高数据冗余，它们可能是不明确的和低质量的。示例:预测信用评分的数据集</strong></p><p id="f43c" class="ju jv lo jw b jx jy jz ka kb kc kd ke lp kg kh ki lq kk kl km lr ko kp kq kr hb bi translated"><strong class="jw hj">同质数据:是由彼此相似的事物组成的数据集，这意味着整个数据集具有相同的数据类型和格式。例如:图像、视频、声音、文本的数据集。</strong></p></blockquote><blockquote class="ls"><p id="91e2" class="lt lu hi bd lv lw lx ly lz ma mb kr dx translated">CatBoost 适用于异构数据。</p></blockquote><p id="de94" class="pw-post-body-paragraph ju jv hi jw b jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr hb bi translated">因此，如果你有一个图像、文本或声音的数据集，使用神经网络可能是一个好主意，因为神经网络是这些类型的同类数据的最先进技术。</p><p id="c274" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">但是，如果您有异构数据的分类问题，那么使用 CatBoost 将是最安全的做法，因为 CatBoost 能够在第一次运行时胜过大多数提升算法。</p><h1 id="4df4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">实现 CatBoost</h1><p id="1bbe" class="pw-post-body-paragraph ju jv hi jw b jx lg jz ka kb lh kd ke kf li kh ki kj lj kl km kn lk kp kq kr hb bi translated">我们将在人类活动识别数据集上应用 CatBoost 进行多类分类。人体活动识别数据集是 UCI 数据集，在这个分类问题中，我们必须根据智能手机传感器(如陀螺仪和加速度计)提取的数据，预测六种活动，如行走、上楼、下楼、坐着、站着和躺着。</p><p id="148f" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">为了解决这个问题，在导入数据集后，我使用标准的缩放器进行预处理，然后是应用 CatBoost 分类器的主要部分。让我们看看分类器代码并理解每一行。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="392e" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">因此，首先我们必须导入 CatBoost 分类器，如代码的第一行所示。</p><p id="309d" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">导入 CatBoost 库后，我们将创建我们的模型，现在让我们检查这些参数。</p><ul class=""><li id="4400" class="ks kt hi jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><strong class="jw hj">迭代:</strong> 1000 次迭代意味着 CatBoost 算法将运行 1000 次以最小化损失函数。</li><li id="6dc4" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">损失函数:</strong>在这里，当我们对多个类进行分类时，我们必须指定“多类”。在二进制分类的情况下，如果我们不提及损失函数，算法将理解并执行二进制分类。</li><li id="927c" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj"> bootstrap_type </strong>:该参数影响构建树结构时选择树的分裂的算法方面的正则化&amp;速度。这里我们选择了贝叶斯，但是如果我们不指定这个参数也没关系。</li><li id="165d" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj"> eval_metric </strong>:在这里，因为我们必须进行多类分类，所以我们选择了“multiclass”作为 eval_metric，当使用二进制分类时，我们不必指定此参数。</li><li id="acd4" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">叶估计迭代次数</strong>:该参数定义了选择树结构后计算叶值的规则，我们取 100，但也可以不指定该参数。</li><li id="b782" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">随机强度</strong>:它指定我们希望我们的梯度增强树彼此之间有多随机。如果我们不指定也没关系。</li><li id="23fe" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">深度</strong>:我们希望我们的树有多深我指定了 7，因为它给了我最高的精度，但是不指定它也可以，让 CatBoost 算法使用它的默认值。</li><li id="3c4d" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj"> l2 叶正则化</strong>:为了指定 l2 正则化值，我们取 5，但这不是强制性的。</li><li id="8823" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">学习率</strong>:这非常重要，但通常默认的 CatBoost 学习率 0.03 也很好。</li><li id="113d" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">装袋温度</strong>:定义贝叶斯自举的设置。默认情况下，它用于分类和回归模式。使用贝叶斯 bootstrap 为对象分配随机权重。不强制指定。</li><li id="1540" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">任务类型</strong>:强烈建议只在 GPU 上使用 CatBoost 算法，因为在 CPU 上使用 CatBoost 算法会变得相当慢。</li></ul><p id="fb2f" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在改变参数并找到最佳参数后，我们将拟合模型并预测输出。<strong class="jw hj"> <em class="lo">很容易操作，CatBoost 只需要几个参数就可以调优，比如你调的话，</em> </strong></p><ul class=""><li id="41af" class="ks kt hi jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><strong class="jw hj">学习率+迭代次数</strong></li><li id="5537" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">深度</strong></li><li id="7fa6" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">L2 _ 正规化</strong></li><li id="c6ff" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">装袋 _ 温度</strong></li><li id="e3ec" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><strong class="jw hj">随机 _ 强度</strong></li></ul><blockquote class="ls"><p id="b07e" class="lt lu hi bd lv lw lx ly lz ma mb kr dx translated">那么你将能够很容易地获得非常好的性能相比，其他升压算法。</p></blockquote><p id="0f58" class="pw-post-body-paragraph ju jv hi jw b jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn mg kp kq kr hb bi translated">在 CatBoost 中，您只需指定数据集类型(二元或多类分类)就可以运行模型，并且您仍然能够获得非常好的分数，而不会出现任何过度拟合。</p><p id="2e46" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">这就是这个算法的工作原理。我在参考资料中提供了一些链接，通过这些链接，您将能够了解这个 CatBoost 算法。</p><p id="ea27" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated"><strong class="jw hj">参考</strong></p><ul class=""><li id="b1bf" class="ks kt hi jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated"><a class="ae jt" href="https://github.com/OriginalMeet/Human_Activity_Recognition_Using_smartphone/blob/master/catboosting.py" rel="noopener ugc nofollow" target="_blank">https://github . com/original meet/Human _ Activity _ Recognition _ Using _ smart phone/blob/master/cat boosting . py</a></li><li id="abcc" class="ks kt hi jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated"><a class="ae jt" href="https://catboost.ai/" rel="noopener ugc nofollow" target="_blank">https://catboost.ai/</a></li></ul></div></div>    
</body>
</html>