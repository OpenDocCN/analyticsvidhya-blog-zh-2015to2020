<html>
<head>
<title>What’s Cooking ? .. NLP Kaggle Challenge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在煮什么？..NLP卡格尔挑战</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/whats-cooking-nlp-kaggle-challenge-fb9e090bf00a?source=collection_archive---------10-----------------------#2020-06-09">https://medium.com/analytics-vidhya/whats-cooking-nlp-kaggle-challenge-fb9e090bf00a?source=collection_archive---------10-----------------------#2020-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1877" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 81% </strong>精度模型是如何实现的！！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/377442005a0684de0428b1e41792e1df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uZVxiwWK-QxDbyCFe-A9KQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">由<a class="ae jt" href="https://pixabay.com/users/GraphicMama-team-2641041/" rel="noopener ugc nofollow" target="_blank">图形妈妈团队</a></figcaption></figure><p id="67bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将讨论<a class="ae jt" href="https://www.kaggle.com/c/whats-cooking/overview" rel="noopener ugc nofollow" target="_blank">什么是烹饪？</a>挑战<a class="ae jt" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank">卡格尔</a>。简单来说，这是一个分类问题，根据配料，我们应该对菜肴的类型进行分类。</p><h1 id="7bbe" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据类型和属性</h1><p id="6a93" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">挑战提供的<a class="ae jt" href="https://www.kaggle.com/c/whats-cooking/data" rel="noopener ugc nofollow" target="_blank">数据</a>以<a class="ae jt" href="https://en.wikipedia.org/wiki/JSON" rel="noopener ugc nofollow" target="_blank"> JSON </a>格式分割成两个文件<strong class="ih hj">(训练/测试)</strong>。</p><p id="4ab9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们将使用训练文件作为<strong class="ih hj">训练</strong>和<strong class="ih hj">验证</strong>数据，因为测试文件仅用于kaggle最终提交<strong class="ih hj"> <em class="kx">(无标签)</em> </strong>。</p><p id="6ed3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练文件:</p><ul class=""><li id="c714" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated"><code class="du lh li lj lk b"><strong class="ih hj">id</strong></code>:食谱id</li><li id="fede" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><code class="du lh li lj lk b"><strong class="ih hj">cuisine</strong></code>:菜肴类型(即印度菜、希腊菜..等等)</li><li id="c966" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><code class="du lh li lj lk b"><strong class="ih hj">ingredients</strong></code>:配料清单(即水、油、小麦..等等)</li></ul><p id="5df9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">测试文件:</p><ul class=""><li id="316e" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated"><code class="du lh li lj lk b"><strong class="ih hj">id</strong></code>:食谱编号</li><li id="53dc" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><code class="du lh li lj lk b"><strong class="ih hj">cuisine</strong></code>:菜系类型</li></ul><h1 id="5350" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">环境和配置</h1><p id="89b8" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">以下是最常用的Python数据科学包..</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="2424" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">熊猫列和行显示配置..</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="eccc" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据加载</h1><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="3896" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据管道</h1><p id="23fc" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我来解释一下<a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> sklearn管道</strong> </a>的手法</p><blockquote class="ls lt lu"><p id="4cc6" class="if ig kx ih b ii ij ik il im in io ip lv ir is it lw iv iw ix lx iz ja jb jc hb bi translated"><a class="ae jt" href="https://www.kaggle.com/baghern" rel="noopener ugc nofollow" target="_blank"><em class="hi">@ dbaghern</em></a><em class="hi">在她牛逼的</em> <a class="ae jt" href="https://www.kaggle.com/baghern/a-deep-dive-into-sklearn-pipelines" rel="noopener ugc nofollow" target="_blank"> <em class="hi">笔记本</em> </a> <em class="hi"> : </em> <strong class="ih hj"> <em class="hi">管道</em> </strong> <em class="hi">是一种精简大量例程流程的方法，将小块逻辑封装到一个函数调用中，这使得实际建模变得更加容易，而不仅仅是编写一堆代码。</em></p></blockquote><p id="dc23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的管道将如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/1ba91af12ddf4ca9921c4644ae4b2b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3edgoI25KpnnPV7Ehg6DHw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">管道设计</figcaption></figure><h1 id="82f4" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据预处理</h1><p id="b7fa" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在这里，我将构建管道的预处理类，应用基本的简单文本预处理步骤，如下所示:</p><ul class=""><li id="fad8" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">连接多词成分，这将是一个可选步骤，因为我正在检查它是否会增加我的准确性(我不会在预处理中使用它)..它降低了准确性。</li><li id="9e96" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated">将配料列表转换为字符串</li><li id="e112" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated">从字符串中移除所有错误的符号</li><li id="c472" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated">删除停用词</li></ul><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="0816" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我之前提到的，我们会将训练文件数据分为训练和验证，我决定将其设为<strong class="ih hj"> (70%训练和30%验证)</strong>，测试将用于kaggle最终结果提交。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="23a5" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">特征抽出</h1><p id="cf98" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在这一步我们将使用<strong class="ih hj"> TfidfTransformer </strong>，<a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfTransformer.html" rel="noopener ugc nofollow" target="_blank"> TF-IDF </a>是特征表示技术，强制使用<a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html" rel="noopener ugc nofollow" target="_blank"> CountVectorizer </a>作为前一步，或者您可以使用<a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" rel="noopener ugc nofollow" target="_blank"> TfidfVectorizer </a>，因为它相当于CountVectorizer后跟TfidfTransformer。</p><p id="aa8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么我走了两步？！答案是，我们只能将<strong class="ih hj">计数矢量器</strong>用作特征表示器，我在模型训练试验中使用过它。</p><h1 id="8666" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据分类器(ML模型)</h1><p id="215d" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">使用许多已知的分类器和它们的默认参数，并且在训练之后，我们将获得具有最高准确度的模型，并且应用网格搜索来找到最佳的其他参数，这些参数促进算法实现更高的准确度。</p><p id="318b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用的分类器:</p><ul class=""><li id="9c55" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html" rel="noopener ugc nofollow" target="_blank">多项式朴素贝叶斯</a>:简单的<a class="ae jt" href="https://datascience.stackexchange.com/questions/30912/what-does-baseline-mean-in-the-context-of-machine-learning" rel="noopener ugc nofollow" target="_blank">基线</a>算法</li><li id="e06d" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html" rel="noopener ugc nofollow" target="_blank"> SGD分类器</a></li><li id="b5f8" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" rel="noopener ugc nofollow" target="_blank">逻辑回归</a></li><li id="b565" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank">随机森林分类器</a></li><li id="8746" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html" rel="noopener ugc nofollow" target="_blank"> SVM分类器</a></li><li id="740d" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html" rel="noopener ugc nofollow" target="_blank">梯度推进分类器</a></li><li id="29c3" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><a class="ae jt" href="https://xgboost.readthedocs.io/en/latest/python/python_api.html#xgboost.XGBClassifier" rel="noopener ugc nofollow" target="_blank"> XGB分类器</a></li><li id="a192" class="ky kz hi ih b ii ll im lm iq ln iu lo iy lp jc ld le lf lg bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html" rel="noopener ugc nofollow" target="_blank">近邻分类器</a></li></ul><h1 id="9607" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">管道</h1><p id="ecf1" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将为每个分类器创建一个管道，并创建一个字典来包含所有创建的管道。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="b310" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">培训和验证</h1><p id="6113" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将训练所有模型，然后找到验证数据的最佳准确性</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="adc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型准确性..</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/9431b23a40c7b9e46dad74df4fd5be72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*k4gxXOH7ygHuHRW9eUVWvw.png"/></div></figure><p id="2847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们看到的，精度最高的模型是<strong class="ih hj">SVM分类器</strong>，因此我们将应用网格搜索来找到最佳参数，看看我们是否可以获得更高的精度..</p><h1 id="6536" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">网格搜索</h1><p id="91ee" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">根据<strong class="ih hj"> SVMClassifier </strong>文档，我们可以调整许多参数，因此我选择了如下最相关的参数，请注意，您必须包括所有<strong class="ih hj">默认</strong>参数，因为它达到了上述最高精度，我们不想降低精度</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="ed81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意<strong class="ih hj"> 'clf__' </strong>是指该参数是流水线中的<strong class="ih hj"> 'clf' </strong>步骤之一</p><p id="6a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用令人敬畏的例子<a class="ae jt" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_grid_search_digits.html" rel="noopener ugc nofollow" target="_blank">这里</a>我们在<strong class="ih hj"> SVC_Pipeline </strong>上应用了网格搜索。</p><p id="db6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">警告..</strong>用了大约<strong class="ih hj"> 24小时</strong>和<strong class="ih hj"> 4个并行作业</strong>(下面是n_jobs参数)得到最佳参数。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="42ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过长时间运行后，我们发现最佳参数是:</p><p id="ff23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">{ <br/> 'clf__C': 10，<br/>' clf _ _ decision _ function _ shape ':' ovo '，<br/> 'clf__gamma': 'scale '，<br/> 'clf__kernel': 'rbf' <br/> }</p><h1 id="695a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">再次训练最佳模特</h1><p id="1c50" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们现在将重新训练模型，将整个训练文件数据(训练+有效)，所以更多的数据可能会提高准确性..</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="84f1" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">提交文件</h1><p id="831f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将存储最终的预测输出，然后将文件提交给Kaggle进行评估</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="5a1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是🥳🥳🥳的评估结果..</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/62fabb714f76a1d6c0f82264ae87afe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FVXXlj9-LmsWGO3S5xZkJg.png"/></div></div></figure></div><div class="ab cl mb mc gp md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hb hc hd he hf"><p id="216b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢，我希望你们都觉得这个教程很有趣。</p><p id="3484" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果有任何澄清，反馈或意见，请随时分享。</p></div><div class="ab cl mb mc gp md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hb hc hd he hf"><p id="53c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码笔记本请点击<a class="ae jt" href="https://github.com/MuhammedMaher/Whats-Cooking.git" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="3930" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也可以在<a class="ae jt" href="https://www.linkedin.com/in/mohamedmaher17/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我</p></div></div>    
</body>
</html>