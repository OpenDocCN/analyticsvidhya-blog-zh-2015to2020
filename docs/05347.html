<html>
<head>
<title>Talking Data User Demographics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对话数据用户人口统计</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/talking-data-user-demographics-37c649dea48c?source=collection_archive---------19-----------------------#2020-04-18">https://medium.com/analytics-vidhya/talking-data-user-demographics-37c649dea48c?source=collection_archive---------19-----------------------#2020-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5f00" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">田径比赛</h2></div><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jf"><img src="../Images/a791b9f5363e8a8b683141327e205a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*fImNepSi7gYm3062H5aHdA.jpeg"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">ML/AI在数字营销中的作用</figcaption></figure><p id="da00" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">商业问题</strong></p><p id="f9a8" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">来源:<a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/overview/description" rel="noopener ugc nofollow" target="_blank">比赛链接</a></p><p id="759a" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">当你走进街角咖啡馆的门时，没有什么比被你最喜欢的饮料问候更令人欣慰的了。虽然一个体贴的咖啡师知道你每周三早上8:15会喝一杯卡布奇诺，但在数字空间里，你喜欢的品牌要个性化你的体验要困难得多。</p><p id="c3ea" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">中国最大的第三方移动数据平台Talking Data明白，日常的选择和行为描绘了我们是谁，我们重视什么。目前，Talking Data正在寻求利用中国每天活跃的5亿移动设备中超过70%的行为数据，帮助其客户更好地了解他们的受众并与之互动。</p><p id="2348" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">在kaggle竞赛中，参赛者被要求建立一个模型，根据他们的应用程序使用情况、地理位置和移动设备属性来预测用户的人口统计特征。这样做将有助于全球数百万开发者和品牌广告商追求数据驱动的营销努力，这些努力与他们的用户相关并迎合他们的偏好。</p><p id="01ec" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">现实世界/业务目标和约束</strong></p><p id="27a6" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.没有低延迟要求。</p><p id="1a41" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.需要数据点属于每个类别的概率。</p><p id="9284" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">现有解决问题的方法:</strong></p><p id="e31f" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">。<a class="ae kn" href="https://github.com/Gautam-v-ml/TalkingData-Mobile-User-Demographics" rel="noopener ugc nofollow" target="_blank">https://github . com/gau tam-v-ml/talking data-Mobile-User-Demographics</a></p><p id="8f40" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这里完成了EDA和数据清理。</p><p id="f994" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">使用逻辑回归等基本ML模型，他可以获得2.38的最高分</p><p id="0cb8" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">对现有方法的改进:</strong></p><p id="2c84" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我跟踪了不同DL和ML型号的组装。</p><p id="a4f5" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">现在我将开始我的方法:</strong></p><p id="7a1b" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">数据概述</strong></p><p id="cbc1" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">数据可从<a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/data" rel="noopener ugc nofollow" target="_blank"> <strong class="jt hj">竞赛页面下载_数据</strong> </a>其中包括:</p><p id="22ca" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.<strong class="jt hj"> gender_age_train.csv，gender_age_test.csv </strong> —这些文件分别包含训练和测试模型的设备的详细信息。</p><p id="8a47" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.<strong class="jt hj"> events.csv，app_events.csv </strong> —当用户使用TalkingData SDK时，事件会连同其时间戳一起记录在该数据中。每个事件都有一个事件id，位置(纬度/经度)，事件对应app_events中的一个应用列表。</p><p id="1d3a" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">3.<strong class="jt hj"> app_labels.csv </strong> —包含用户使用的应用及其对应的label_id。</p><p id="82d6" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">4.<strong class="jt hj"> label_categories.csv </strong> —由app_labels.csv中的应用标签id及其类别组成。例如，标签ID: 4属于游戏艺术风格类别。</p><p id="5b90" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">5.<strong class="jt hj">phone _ brand _ device _ model . CSV</strong>—包含用户使用的设备的设备id，以及相应的电话品牌和设备型号。</p><p id="e4c5" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">绩效指标</strong></p><p id="ebfe" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/overview/evaluation" rel="noopener ugc nofollow" target="_blank"> <strong class="jt hj">多类日志丢失</strong> </a>:每个设备都被标注了一个真实的类。对于每个设备，我们必须预测一组预测概率(每个类别一个)。公式是</p><p id="5334" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">其中，N是测试集中设备的数量，M是类别标签的数量，log是自然对数，如果设备I属于类别j，yij是1，否则是0，pij是观察值ii属于类别j的预测概率。</p><p id="6e2d" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">探索性数据分析:</strong></p><p id="9cc7" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">导入所需的库</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ko"><img src="../Images/97b33d18d96fc1957bffb9475a658dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*fJUTP8XcHYF2fDzB6V9xIg.png"/></div></figure><p id="f382" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">开始对作为数据一部分的每个csv进行分析:</p><p id="b78f" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">性别_年龄_训练</strong> <strong class="jt hj">数据</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kp"><img src="../Images/38694e08167c4010ab1b9f07d351926b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*yX8iQKzRzdNmkfOyfdJbVQ.png"/></div></figure><p id="fe51" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">因此，gender_age_train包含4列:</p><p id="b81c" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">设备id: </strong>注册了通话数据的用户设备id</p><p id="12f0" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">性别:</strong>用户的性别，用M或F分别表示男性或女性</p><p id="421d" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">年龄:</strong>用户的年龄</p><p id="bdd9" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">group: 这是我们问题的目标类，包含我们需要预测的类。第一个字母表示用户的性别，随后是用户所属的年龄组</p><p id="f7f0" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">请看下面的图表，它向我们展示了每组的数量</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kq"><img src="../Images/6183a7351eea39bd23bd8d7350005875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*zPB0rfHFzPT6Cjmj9VEBzA.png"/></div></figure><p id="6006" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">从上面的图中我们可以推断出男性用户比女性用户多。这一点在饼状图中表现得更为明显，其中近65%是男性，35%是女性。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kr"><img src="../Images/660fa78e5e3fb131c1db8d213d613ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*wcYR9y4T98I3J-XNATRt_Q.png"/></div></figure><p id="06fe" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">性别_年龄_测试数据</strong></p><p id="27ae" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这是我们需要预测组(目标变量)的测试数据</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/8d40455740f65398f928b5d10cb0771f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nv6ejT672qD-F6AavwVKIA.png"/></div></div></figure><p id="1730" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">所以测试数据只有一列device_id。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es kx"><img src="../Images/3b93e2e097efed438610b49845d706cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iv-Iqtjvcj6iuxcxosYDgA.png"/></div></div></figure><p id="b90f" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">手机_品牌_设备_型号数据</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ky"><img src="../Images/7b76bb302f68b0a2b6ac034b6f2c4491.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JSRlcfJOA3afyYZHIad3Nw.png"/></div></div></figure><p id="f196" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我们这里有device_id、phone_brand、device_model，并且注意到一些phone_brand和device_model值是中文的。</p><p id="558d" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">首先，我们将检查重复项。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es kz"><img src="../Images/6d904f7c3c6ebafe72f819f396477927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILE5kSM1zSz7QHV1V30WlA.png"/></div></div></figure><p id="3066" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">所以有一些重复的，他们需要被删除。</p><p id="7293" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">事件数据</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es la"><img src="../Images/96afcd03ff17a5a3d537e93b30588a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f4usqzq9XaTTOzSYWmJg0Q.png"/></div></div></figure><p id="6263" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">首先，我们将检查一个设备id是否有多个事件id。</p><p id="45a0" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">为此，我们来看看id为<strong class="jt hj"> 29182687948017175 </strong>的设备的事件数据</p><p id="e664" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">事件[事件['设备id']==29182687948017175]。头(10)</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lb"><img src="../Images/58ed92707368c2f72bd20d5091d513d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Jdc1kEsehNsRXwsYQAsqFA.png"/></div></figure><p id="e73d" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">从上面我们可以说，设备id可以有多个事件。</p><p id="a355" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我们有所有事件的时间戳，我们可以查看所有事件的总体开始和结束时间，以了解所有事件的记录时间。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lc"><img src="../Images/61613912d4b2e41e59139018151404e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z71YTJJwzdy9wkKyjUlTTA.png"/></div></div></figure><p id="5780" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">因此，我们可用的事件数据记录时间为8天，从2016年4月30日午夜到2016年5月8日凌晨12点。</p><p id="f3d5" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在最重要的是我们需要检查是否所有设备都有事件？</p><p id="56cd" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">下面是讲述事件信息的图</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ld"><img src="../Images/639b20505b17643ef510e9605b22bb17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*4Q7QXRggMkl_3jLroyeGqQ.png"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es le"><img src="../Images/04ba0151facfbbcc5cd68d428f14a6fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*ioPF00ZgV0iAOD85Cl49tg.png"/></div></figure><p id="dac5" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">因此，几乎69%的数据没有事件。</p><p id="2383" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在我们看到数据是如何在全球传播的？</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ko"><img src="../Images/fb7035cae8bc6fbb599b0fb05485beab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*xZbMekJJAvVocsxrSMIxMw.png"/></div></figure><p id="5af9" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">上表显示大多数事件发生在位于大西洋中部的(0，0)附近。可以有把握地假设，这些位置上的日志是用户不想共享他们的位置的产品，因此是无用的。其他坐标大部分位于中国，只有少数pin用户在世界其他地方。虽然有三分之一的数据没有信息，但我仍然认为使用位置信息是值得的，因为这两个数字显示了女性和男性之间的分布存在一定的差异</p><p id="a447" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj"> app_labels数据</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lf"><img src="../Images/683b9dde91b2ca943f79f731ac21fef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oUCGme8H3xikKq4ACry9Q.png"/></div></div></figure><p id="5ceb" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在我们会发现我们有多少独特的应用程序标签？</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lg"><img src="../Images/ce4ddcb25401b18e088c0476ce681182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxetEOyHdRWbc8ZML-hC8w.png"/></div></div></figure><p id="2f37" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在我们有507个唯一的应用程序标签，我们也可以有多个标签id与特定的应用程序id相关联。让我们考虑一个id为<strong class="jt hj"> 7324884708820027918 </strong>的应用，它有多个标签。</p><p id="ea5b" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">应用标签[应用标签['应用标识']==7324884708820027918]</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lh"><img src="../Images/1b9855f4ea4c5d21e7c750b56b131149.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*kEUIeBCH0EEubVMtMw2JVg.png"/></div></figure><p id="656b" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">app _事件数据</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es li"><img src="../Images/487dff1c70b77c55613132bee77080ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSZkc5Mro-1uk8MZ7iTNaA.png"/></div></div></figure><p id="c8ff" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我们将通过下面的代码了解独特的应用程序和事件的数量:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="ab fe cl lj"><img src="../Images/8d5dc40b162e27cf4fc6a9107b4d5e28.png" data-original-src="https://miro.medium.com/v2/format:webp/1*d4xN9299VLtUB6hrHnz1cw.png"/></div></figure><p id="7616" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">is_active列分析</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lk"><img src="../Images/e14dffcc098c0eb1eb6d75ca9e22fc98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aOnjSI7ZfanhJbxmb3bfbA.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ll"><img src="../Images/e2e9088dea7fbe5fd468e5b238d7a209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*eZHqEYgcc71I5XysWPsuWw.png"/></div></figure><p id="b8de" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">因此，当有活动正在进行时，大多数应用程序都是不活动的。几乎61%的应用程序是不活跃的，39%的应用程序是活跃的。</p><p id="f736" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">探索性数据分析结论</strong></p><p id="7f4c" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.只有31%的训练和测试数据包含事件和应用相关功能<br/> 2。我们需要为没有事件的设备使用手机品牌和手机型号数据<br/> 3。对于包含事件信息的设备，我们可以使用事件相关功能以及电话品牌和型号功能</p><p id="7767" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">数据准备</strong></p><p id="b68c" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">以下是我在准备模型中使用的数据时遵循的步骤:</p><p id="8f44" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.因为我们的数据中有两种类型的设备，一种有事件详细信息，另一种没有任何事件详细信息。我分离了设备，并为有事件的设备和无事件的设备创建了数据。</p><p id="9a3f" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.对于没有事件数据的设备，我只使用手机品牌和设备型号作为特征。</p><p id="7c32" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">3.对于具有事件数据的设备，我使用了手机品牌、设备型号以及事件数据功能，如中纬度、中经度、事件发生的时间、事件发生的星期几、应用程序事件数据中的is_active功能、设备中使用/安装的所有应用程序列表、按设备id分组的所有应用程序标签列表。</p><p id="0479" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">要查看准备数据的更多细节和代码，请查看我的库:<a class="ae kn" href="https://github.com/ytataji/TalkingDataUserDemographics" rel="noopener ugc nofollow" target="_blank">我的Github库</a></p><p id="1b65" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">现在是时候使用不同的模型来获得更好的预测了！</p><p id="e976" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">以下是实现以下目标的不同方法:</strong></p><p id="b938" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.由于我们数据中的所有设备都有手机品牌和设备型号的详细信息，所以我使用这两个特征来训练一个逻辑回归和两个不同的神经网络模型。我使用这些模型来预测测试数据中设备的类别概率，这些测试数据不包含我们在前面的步骤中分离的事件数据。</p><p id="36c6" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.对于包含事件细节的设备，我使用我们为这些设备提取的事件相关特征，并且仅使用包含事件细节的设备来训练两个不同的神经网络模型。然后，我使用这些模型来预测包含事件数据的测试数据中设备的分类概率。</p><p id="a26a" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">3.最后，我将有事件的设备和无事件的设备的测试数据预测连接起来，并创建了整个测试数据预测文件。</p><p id="72db" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">使用两个不同数据集的特征工程</strong></p><p id="a889" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">因为我们有两个独立的数据，一个是有事件的设备，另一个是没有事件的设备，所以我为这些数据分别准备了特性。</p><p id="07f7" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.<strong class="jt hj">无事件设备:</strong>创建手机品牌、设备型号特征的一次性编码。</p><p id="a8f1" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.<strong class="jt hj">带事件的设备:</strong>创建手机品牌、设备型号、属于设备的应用程序、属于设备的应用程序标签、TFIDF小时编码功能、星期几、应用程序激活、标准化纬度和经度功能的一键编码。我们称之为<strong class="jt hj">事件特征矩阵。</strong></p><p id="ddcb" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">建模</strong></p><p id="fae1" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">正如我的方法中提到的，在这一节中，我将带您浏览我的解决方案中使用的模型。这包括两个部分，即，在没有事件细节的设备数据上建模和在包含事件细节的设备数据上建模。让我们先从没有事件细节的设备建模开始。</p><p id="9b90" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">无事件详情的设备</strong></p><p id="db47" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">在开始建模之前，我将为我的模型创建训练、验证和测试数据。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lm"><img src="../Images/9eff871a350485b838b1feebf7782519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WaYbYfpQXeGGT0UOr-D6vg.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ln"><img src="../Images/51bd44bf2b3335e69e0c5b2e2b8f6802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ScGcLwU41voQ5Hr1dCr8LQ.png"/></div></div></figure><p id="23b0" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj"> X_train_one_hot </strong>是所有设备(有无事件)的列车数据的手机品牌、设备型号特征的一键编码。<strong class="jt hj">X _ test _ no _ events _ one _ hot</strong>是列车数据的手机品牌、设备型号特征的一键编码，仅用于不包含事件详情的设备。原因是，正如我在方法中提到的，手机品牌、设备型号功能适用于所有设备。因此，我针对训练数据中所有可用设备的这些特征来训练模型，并使用模型来预测测试数据中没有事件细节的设备。</p><p id="dd68" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">逻辑回归</strong></p><p id="3701" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">逻辑回归模型在train_1上训练，cv_1是验证数据，test_1是我们预测分类概率的测试数据。</p><p id="afe6" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我已经做了超参数调整，我得到了最好的C为0.1(最低的日志损失)</p><p id="fb67" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">所以我们使用最佳C值为0.1</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lo"><img src="../Images/f1ee474d800c8eb5de248b5b8e8c0b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxX0yiThD2y5QP2H7vAjsw.png"/></div></div></figure><p id="2f39" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">仅使用电话品牌和设备型号one-hot编码作为特征，逻辑回归模型具有2.38的CV对数损失。</p><p id="f24a" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">不，我们去找神经网络</p><p id="991e" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">神经网络1 </strong></p><p id="7171" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">从<a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">竞赛讨论页</a>引用的神经网络架构</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lp"><img src="../Images/b861d51534abfa1e3c2894e6e287acd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FqT5eDwD41hR4ar-UYLXIw.png"/></div></div></figure><p id="2004" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj"> input_shape </strong>这里是X_train_one_hot中的特征数。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lq"><img src="../Images/968c01832fa32447ae35d23b52034894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzMuxlVoJD6HVudG33jAww.png"/></div></div></figure><p id="82aa" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我在X_train_one_hot数据上使用不同的随机分割train，CV训练神经网络1模型5次，如下所示</p><p id="7964" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj"> model_list_1 </strong>包含使用不同随机种子在不同版本的X_train_one_hot数据分割上训练的5个模型。我使用了model_list_1中的每个模型，并对测试数据(test_1)进行了概率预测，然后取所有预测的平均值。</p><p id="7f85" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">下面是以上5个模型的张量板标量</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lr"><img src="../Images/1723223b13a0da29afbf63dc911e9671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DA7ruzL5t_7GgR8J2qIdmg.png"/></div></div></figure><p id="1568" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">神经网络2 </strong></p><p id="061a" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">参考自<a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">竞赛讨论页面</a>的神经网络架构</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ls"><img src="../Images/f132e798a47f9c7830667d2d01d8fb02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBcB1ioU-gehalz8GFnTnw.png"/></div></div></figure><p id="908f" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这里，<strong class="jt hj"> input_dim </strong>是X_train_one_hot中的特征数。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lt"><img src="../Images/ef49499f8ffec2ca9f9d9ab053dcc643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*56fz9bzQQX8aQ_yFzg1ryA.png"/></div></figure><p id="0236" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我在train_1上对神经网络2进行了一次30个时期的训练，并使用该模型对测试数据(test_1)进行预测。</p><p id="db73" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">请参考<a class="ae kn" href="https://github.com/ytataji/TalkingDataUserDemographics" rel="noopener ugc nofollow" target="_blank">我的Github库</a>获取张量板标量</p><p id="a291" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">带有事件详情的设备</strong></p><p id="44c4" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">让我们为我的模型创建训练、验证和测试数据，就像我们以前为没有事件数据的设备所做的那样。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lu"><img src="../Images/822dd4e361cda2d7ca736d5e6e54a98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prsFOG8xUZUbf-BZDgfHNg.png"/></div></div></figure><p id="daf0" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这里X_train_events_one_hot_1是我们在特征准备步骤中创建的列车数据的<strong class="jt hj">事件特征矩阵</strong>。X_test_events_one_hot_1是一个类似于测试数据的<strong class="jt hj">事件特征矩阵</strong>。</p><p id="4146" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">神经网络3 </strong></p><p id="7835" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">参考自<a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">竞赛讨论页面</a>的神经网络架构</p><p id="6eeb" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">输入图层中的差值在此处增加了价值，因为它为预测提供了可变性，因为当我们在输入图层中使用差值时，在每次运行期间，只有一组随机要素被用作模型的输入。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ls"><img src="../Images/10d108aaa95d55e4480c8d98ebb838d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*czIrlxTFc9AzuGdiv-_L1g.png"/></div></div></figure><p id="1863" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这里，<strong class="jt hj"> input_dim </strong>是X_train_events_one_hot_1中的特征数。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lv"><img src="../Images/e3c515a820bc9412ca6b8af05215d60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*RdkRF0CW8-K0BbLVWREf1w.png"/></div></figure><p id="6647" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我训练神经网络3模型20次。</p><p id="cae8" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">然后，我使用model_list_2中的20个模型中的每一个对测试数据(test_2)进行预测，并取预测概率的平均值。</p><p id="49b1" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">请参考<a class="ae kn" href="https://github.com/ytataji/TalkingDataUserDemographics" rel="noopener ugc nofollow" target="_blank">我的Github库</a>获取张量板标量</p><p id="db68" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">神经网络4 </strong></p><p id="14be" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">该神经网络是神经网络3的变体，但是具有2个密集层和不同数量的隐藏单元。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lp"><img src="../Images/2a26acca6bd99c6c03c69c7559cf5a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tswulQT0dwoX88_PQrjtog.png"/></div></div></figure><p id="af68" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这里，<strong class="jt hj"> input_dim </strong>是X_train_events_one_hot_1中的特征数。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lw"><img src="../Images/d9e02bd66432ac62b393a66a91e96717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPMxXVQoT7vvxQR-94bPQw.png"/></div></div></figure><p id="bc85" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">类似于我训练神经网络3的方法，我训练神经网络4模型20次。</p><p id="6cfc" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">然后，我使用model_list_3中的20个模型中的每一个对测试数据(test_2)进行预测，并取预测概率的平均值。</p><p id="35e0" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">请参考<a class="ae kn" href="https://github.com/ytataji/TalkingDataUserDemographics" rel="noopener ugc nofollow" target="_blank">我的Github库</a>获取张量板标量</p><p id="5cb3" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">模特合奏</strong></p><p id="e99d" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.<strong class="jt hj">无事件数据的设备:</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lx"><img src="../Images/8165867b068933ec1016acbe6542b7dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hATXKcIN29tTRJS-XtE_Wg.png"/></div></div></figure><p id="c429" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj"> 2。具有事件数据的设备:</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ly"><img src="../Images/82173a3aaf699a61eab94b7b4bbf4b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IpAOsMot__Rn3EteqDPQGQ.png"/></div></div></figure><p id="95d9" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">最终预测:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lz"><img src="../Images/3270401937554b46fd50101341aa4d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*orJ8uIk87rujS8-HmDP0yw.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ln"><img src="../Images/a537a2fe2d0fae3633feaccef448dbdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppd7mYieczjzHFz8vgSztQ.png"/></div></div></figure><p id="b274" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">最后，我将有事件和无事件设备的这些测试数据预测连接起来，创建了包含112071行的整个测试数据预测文件，其中每行包含设备属于12个类别中每一个类别的预测概率。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ma"><img src="../Images/5869d8cd0be3f7de8dc255692c301119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WfOk6Wh6_ouf8_xbAkE4fA.png"/></div></div></figure><p id="81f5" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">结果</strong></p><p id="1a34" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.<strong class="jt hj">无事件数据:</strong>对所有设备的手机品牌、设备型号的One_Hot编码进行模型训练。</p><p id="84d9" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.<strong class="jt hj">事件数据:</strong>仅针对包含事件细节的设备，在事件特征矩阵上训练模型。</p><p id="3980" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">3.模型中的平均值表示模型有多次运行，并且预测是平均的。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mb"><img src="../Images/fbef89feb371727c1adc5af2326f8469.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*1KbjkLDltBTPR9USV16AMg.png"/></div></figure><p id="f19c" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">提交分数的串联测试预测:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ko"><img src="../Images/08a2b80a6b1b0c4ac61b27291863e35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*20GlB600s-D8px6mDrYizA.png"/></div></figure><p id="af88" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">进一步改进</strong></p><p id="5f0e" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1.我们可以在不同的模型组合上使用不同的权重来改善对数损失</p><p id="2e3f" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.我们可以在不同的ML模型、随机森林或任何模型上使用集成</p><p id="abd1" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">我试图用最简单的方式解释，希望你能理解我的博客。如果您有任何疑问，请随时通过<a class="ae kn" href="http://www.linkedin.com/in/TatajiYerubandhi" rel="noopener ugc nofollow" target="_blank">我的LinkedIn个人资料</a>联系我</p><p id="9ae4" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">感谢您的阅读！！</strong></p><p id="0a07" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jt hj">参考文献</strong></p><p id="cc57" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1 . https:<a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/" rel="noopener ugc nofollow" target="_blank">/</a>/www . ka ggle . com/c/talking data-mobile-user-demographics/</p><p id="ecb5" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">2.<a class="ae kn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/talking data-mobile-user-demographics/discussion/23424</a></p><p id="ddfa" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">3.<a class="ae kn" href="https://machinelearningmastery.com/model-averaging-ensemble-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/model-averaging-ensemble-for-deep-learning-neural-networks/</a></p><p id="57d2" class="pw-post-body-paragraph jr js hi jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><a class="ae kn" href="https://www.appliedaicourse.com/lecture/11/applied-machine-learning-online-course/3081/what-are-ensembles/4/module-4-machine-learning-ii-supervised-learning-models" rel="noopener ugc nofollow" target="_blank">4 . https://www . applied ai course . com/lecture/11/applied-machine-learning-online-course/3081/what-are-ensembles/4/module-4-machine-learning-ii-supervised-learning-models</a></p></div></div>    
</body>
</html>