<html>
<head>
<title>Circular Rotating Gradient Ring-Swift &amp; XCode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">圆形旋转渐变环-Swift &amp; XCode</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/circular-rotating-gradient-ring-swift-xcode-f3e48c38b5ba?source=collection_archive---------13-----------------------#2019-10-21">https://medium.com/analytics-vidhya/circular-rotating-gradient-ring-swift-xcode-f3e48c38b5ba?source=collection_archive---------13-----------------------#2019-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="632d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在任何圆形视图周围添加旋转渐变环—快速</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/ba9d56f805ef792d2c7c41e10417befa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b8jXM-zt8mfCiJlDzml6KA.png"/></div></div></figure><h2 id="5ccd" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">先决条件</h2><p id="b487" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">对Swift和iOS开发的基本了解。</p><h2 id="a5cb" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">跳进来</h2><p id="c311" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">一个独特的简单风格可以让你的应用程序脱颖而出，并增加一个不错的感觉。正确使用渐变可能正是增加用户界面趣味所需要的！让我们开始吧。</p><h2 id="6134" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">添加一些视图</h2><p id="33d5" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">我们需要一个UIView和一个UIImageView。把这两块加起来。给他们起任何你喜欢的名字。我选择了profilePhotoRingView和profilePhoto。不过，请确保使用您自己的图像名称。随着应用程序的扩展和越来越多的开发人员加入团队，明确命名约定将会有很大的帮助！</p><pre class="iy iz ja jb fd la lb lc ld aw le bi"><span id="d273" class="jj jk hi lb b fi lf lg l lh li">lazy var profilePhotoRingView : UIView = {</span><span id="d274" class="jj jk hi lb b fi lj lg l lh li">let oli = UIView()</span><span id="52c9" class="jj jk hi lb b fi lj lg l lh li">oli.translatesAutoresizingMaskIntoConstraints = false</span><span id="99b0" class="jj jk hi lb b fi lj lg l lh li">oli.backgroundColor = .clear</span><span id="ed84" class="jj jk hi lb b fi lj lg l lh li">oli.isUserInteractionEnabled = true</span><span id="ed29" class="jj jk hi lb b fi lj lg l lh li">oli.clipsToBounds = true</span><span id="3ca4" class="jj jk hi lb b fi lj lg l lh li">oli.layer.masksToBounds = true</span><span id="94d3" class="jj jk hi lb b fi lj lg l lh li">return oli</span><span id="9b20" class="jj jk hi lb b fi lj lg l lh li">}()</span><span id="37b9" class="jj jk hi lb b fi lj lg l lh li">lazy var profilePhoto : UIImageView = {</span><span id="c9f1" class="jj jk hi lb b fi lj lg l lh li">let oli = UIImageView()</span><span id="37c2" class="jj jk hi lb b fi lj lg l lh li">let image = UIImage(named : "demo_wall")?.withRenderingMode(.alwaysOriginal)</span><span id="1e32" class="jj jk hi lb b fi lj lg l lh li">oli.image = image</span><span id="1c42" class="jj jk hi lb b fi lj lg l lh li">oli.translatesAutoresizingMaskIntoConstraints = false</span><span id="8e2c" class="jj jk hi lb b fi lj lg l lh li">oli.backgroundColor = UIColor .white</span><span id="4e95" class="jj jk hi lb b fi lj lg l lh li">oli.contentMode = .scaleAspectFill</span><span id="d6ae" class="jj jk hi lb b fi lj lg l lh li">oli.layer.masksToBounds = true</span><span id="2e32" class="jj jk hi lb b fi lj lg l lh li">oli.layer.borderColor =  UIColor .white.cgColor</span><span id="c3ce" class="jj jk hi lb b fi lj lg l lh li">oli.layer.borderWidth = 1.5</span><span id="c777" class="jj jk hi lb b fi lj lg l lh li">oli.isUserInteractionEnabled = true</span><span id="6343" class="jj jk hi lb b fi lj lg l lh li">return oli</span><span id="18ae" class="jj jk hi lb b fi lj lg l lh li">}()</span></pre><h2 id="03ed" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">添加和约束</h2><p id="08a0" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">首先添加profilePhotoRingView，使其出现在profilePhoto下。在viewDidLoad中调用addViews函数。</p><pre class="iy iz ja jb fd la lb lc ld aw le bi"><span id="d99d" class="jj jk hi lb b fi lf lg l lh li">func addViews() {</span><span id="dd92" class="jj jk hi lb b fi lj lg l lh li">self.view.addSubview(profilePhotoRingView)</span><span id="421e" class="jj jk hi lb b fi lj lg l lh li">self.view.addSubview(profilePhoto)</span><span id="09c1" class="jj jk hi lb b fi lj lg l lh li"><br/>self.profilePhotoRingView.centerYAnchor.constraint(equalTo: self.view.centerYAnchor, constant: 0).isActive = true</span><span id="4b3a" class="jj jk hi lb b fi lj lg l lh li">self.profilePhotoRingView.centerXAnchor.constraint(equalTo: self.view.centerXAnchor, constant: 0).isActive = true</span><span id="6af7" class="jj jk hi lb b fi lj lg l lh li">self.profilePhotoRingView.heightAnchor.constraint(equalToConstant: 50).isActive = true</span><span id="20fa" class="jj jk hi lb b fi lj lg l lh li">self.profilePhotoRingView.widthAnchor.constraint(equalToConstant: 50).isActive = true</span><span id="4bb1" class="jj jk hi lb b fi lj lg l lh li">self.profilePhotoRingView.layer.cornerRadius = 25</span><span id="7dcd" class="jj jk hi lb b fi lj lg l lh li">self.profilePhoto.centerYAnchor.constraint(equalTo: self.profilePhotoRingView.centerYAnchor, constant: 0).isActive = true</span><span id="afff" class="jj jk hi lb b fi lj lg l lh li">self.profilePhoto.centerXAnchor.constraint(equalTo: self.profilePhotoRingView.centerXAnchor, constant: 0).isActive = true</span><span id="0c62" class="jj jk hi lb b fi lj lg l lh li">self.profilePhoto.heightAnchor.constraint(equalToConstant: 48).isActive = true</span><span id="e435" class="jj jk hi lb b fi lj lg l lh li">self.profilePhoto.widthAnchor.constraint(equalToConstant: 48).isActive = true</span><span id="d3eb" class="jj jk hi lb b fi lj lg l lh li">self.profilePhoto.layer.cornerRadius = 24</span><span id="4317" class="jj jk hi lb b fi lj lg l lh li">}</span></pre><h2 id="3c3e" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">渐变设置</h2><p id="7b6b" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">添加gradientLayer变量和一个布尔值来控制viewDidLayoutSubviews()。</p><pre class="iy iz ja jb fd la lb lc ld aw le bi"><span id="6ca5" class="jj jk hi lb b fi lf lg l lh li">var gradientLayer: CAGradientLayer!</span><span id="ebbd" class="jj jk hi lb b fi lj lg l lh li">var hasViewBeenLaidOut : Bool = false</span></pre><p id="b2c0" class="pw-post-body-paragraph kh ki hi kj b kk lk ij km kn ll im kp ju lm kr ks jy ln ku kv kc lo kx ky kz hb bi translated">添加handleGradientLayer函数。</p><pre class="iy iz ja jb fd la lb lc ld aw le bi"><span id="90df" class="jj jk hi lb b fi lf lg l lh li">func handleGradientLayer() {</span><span id="3f16" class="jj jk hi lb b fi lj lg l lh li">self.gradientLayer = CAGradientLayer()</span><span id="e3d2" class="jj jk hi lb b fi lj lg l lh li">self.gradientLayer.frame = profilePhotoRingView.bounds</span><span id="eb00" class="jj jk hi lb b fi lj lg l lh li">self.gradientLayer.startPoint = CGPoint(x: 0.5, y: 0.0)</span><span id="5117" class="jj jk hi lb b fi lj lg l lh li">self.gradientLayer.endPoint = CGPoint(x: 0.5, y: 1.0)</span><span id="6f8f" class="jj jk hi lb b fi lj lg l lh li">self.gradientLayer.colors = [UIColor .blue.withAlphaComponent(1.0).cgColor,</span><span id="518f" class="jj jk hi lb b fi lj lg l lh li">UIColor .blue.withAlphaComponent(0.9).cgColor,</span><span id="d711" class="jj jk hi lb b fi lj lg l lh li">UIColor .blue.withAlphaComponent(0.8).cgColor,</span><span id="ee9b" class="jj jk hi lb b fi lj lg l lh li">UIColor .blue.withAlphaComponent(0.7).cgColor,</span><span id="2bd2" class="jj jk hi lb b fi lj lg l lh li">UIColor .orange.withAlphaComponent(0.6).cgColor,</span><span id="d89a" class="jj jk hi lb b fi lj lg l lh li">UIColor .orange.withAlphaComponent(0.5).cgColor,</span><span id="3270" class="jj jk hi lb b fi lj lg l lh li">UIColor .orange.withAlphaComponent(0.4).cgColor,</span><span id="e887" class="jj jk hi lb b fi lj lg l lh li">UIColor .orange.withAlphaComponent(0.3).cgColor,</span><span id="b480" class="jj jk hi lb b fi lj lg l lh li">UIColor .orange.withAlphaComponent(0.2).cgColor,</span><span id="0cbd" class="jj jk hi lb b fi lj lg l lh li">UIColor .orange.withAlphaComponent(0.1).cgColor]</span><span id="3474" class="jj jk hi lb b fi lj lg l lh li">self.profilePhotoRingView.layer.addSublayer(self.gradientLayer)</span><span id="7d86" class="jj jk hi lb b fi lj lg l lh li">self.addGradientRingRotation()</span><span id="e05e" class="jj jk hi lb b fi lj lg l lh li">}</span></pre><p id="d9ee" class="pw-post-body-paragraph kh ki hi kj b kk lk ij km kn ll im kp ju lm kr ks jy ln ku kv kc lo kx ky kz hb bi translated">为什么这么多颜色？！这允许在渐变的顶部有下降的淡入淡出效果，非常酷！这里有一个错误，让我们添加addGradientRingRotation函数。首先，添加CAAnimationDelegate协议。</p><pre class="iy iz ja jb fd la lb lc ld aw le bi"><span id="8a8a" class="jj jk hi lb b fi lf lg l lh li">func addGradientRingRotation() {</span><span id="ac11" class="jj jk hi lb b fi lj lg l lh li">let fullRotation = CABasicAnimation(keyPath: "transform.rotation")</span><span id="8c54" class="jj jk hi lb b fi lj lg l lh li">fullRotation.delegate = self</span><span id="9fb5" class="jj jk hi lb b fi lj lg l lh li">fullRotation.fromValue = NSNumber(floatLiteral: 0)</span><span id="0ea6" class="jj jk hi lb b fi lj lg l lh li">fullRotation.toValue = NSNumber(floatLiteral: Double(CGFloat.pi * 2))</span><span id="0361" class="jj jk hi lb b fi lj lg l lh li">fullRotation.duration = 3.0</span><span id="da36" class="jj jk hi lb b fi lj lg l lh li">fullRotation.repeatCount = Float.infinity</span><span id="e8f6" class="jj jk hi lb b fi lj lg l lh li">fullRotation.isRemovedOnCompletion = false</span><span id="fb29" class="jj jk hi lb b fi lj lg l lh li">profilePhotoRingView.layer.add(fullRotation, forKey: "360")</span><span id="e06d" class="jj jk hi lb b fi lj lg l lh li">}</span></pre><p id="28c7" class="pw-post-body-paragraph kh ki hi kj b kk lk ij km kn ll im kp ju lm kr ks jy ln ku kv kc lo kx ky kz hb bi translated">轻松右转！现在，如果您退出应用程序并返回，isRemovedOnCompletion将确保您的渐变保持旋转——这只是一种可能的实现。</p><p id="578d" class="pw-post-body-paragraph kh ki hi kj b kk lk ij km kn ll im kp ju lm kr ks jy ln ku kv kc lo kx ky kz hb bi translated">最后，让我们将handleGradientLayer函数添加到viewDidLayoutSubviews()中。</p><pre class="iy iz ja jb fd la lb lc ld aw le bi"><span id="0295" class="jj jk hi lb b fi lf lg l lh li">override func viewDidLayoutSubviews() {</span><span id="edc5" class="jj jk hi lb b fi lj lg l lh li">super.viewDidLayoutSubviews()</span><span id="e7ad" class="jj jk hi lb b fi lj lg l lh li">if self.hasViewBeenLaidOut == false {</span><span id="2aa5" class="jj jk hi lb b fi lj lg l lh li">self.handleGradientLayer()</span><span id="a104" class="jj jk hi lb b fi lj lg l lh li">self.hasViewBeenLaidOut = true</span><span id="59fa" class="jj jk hi lb b fi lj lg l lh li">}</span><span id="1686" class="jj jk hi lb b fi lj lg l lh li">}</span></pre><p id="03df" class="pw-post-body-paragraph kh ki hi kj b kk lk ij km kn ll im kp ju lm kr ks jy ln ku kv kc lo kx ky kz hb bi translated">就是这样！现在看你的梯度旋转在她所有的荣耀！请随意调整渐变的持续时间和alpha值，以获得您想要的精确效果！如果你想看到更多的渐变实现，请在下面的评论中告诉我！</p></div></div>    
</body>
</html>