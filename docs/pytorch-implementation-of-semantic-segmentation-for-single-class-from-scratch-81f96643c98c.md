# Pytorch å®ç°ä»æ— åˆ°æœ‰çš„å•ç±»è¯­ä¹‰åˆ‡åˆ†ã€‚

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/pytorch-implementation-of-semantic-segmentation-for-single-class-from-scratch-81f96643c98c?source=collection_archive---------1----------------------->

![](img/3b972051c2af65576646ecb5968a3bd7.png)

å›¾ç‰‡ç”± MIDHUN GEORGE é€šè¿‡ unsplash æ‹æ‘„

## ä»‹ç»

è¯­ä¹‰åˆ†å‰²å¯ä»¥è¢«è®¤ä¸ºæ˜¯åƒç´ çº§çš„åˆ†ç±»ï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œå®ƒæ˜¯æŒ‡å°†å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ é“¾æ¥åˆ°ç±»åˆ«æ ‡ç­¾çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œè¯•å›¾å›ç­”**ä»€ä¹ˆ&å›¾åƒä¸­çš„ä½ç½®**ï¼Œè¯­ä¹‰åˆ†å‰²ä¸åŒäºå®ä¾‹åˆ†å‰²ï¼Œåœ¨å®ä¾‹åˆ†å‰²ä¸­ï¼Œç›¸åŒç±»åˆ«çš„å¯¹è±¡å°†å…·æœ‰ä¸åŒçš„æ ‡ç­¾ï¼Œå¦‚ car1ã€car2 ä¸­çš„ä¸åŒé¢œè‰²ã€‚

åœ¨è¯­ä¹‰åˆ†å‰²ä»¥éå¸¸å¤æ‚çš„å½¢å¼ç”¨äºå¤šç±»çš„æƒ…å†µä¸‹ï¼Œæœ‰è®¸å¤šå¯ç”¨çš„å­˜å‚¨åº“ã€‚**é€šè¿‡è¿™ä¸ªåšå®¢ï¼Œæˆ‘è¯•å›¾ä¸ºä¸€ä¸ªç±»ä»å¤´å¼€å§‹å®ç°è¯­ä¹‰åˆ†å‰²ï¼Œç»è¿‡ä¸€äº›è°ƒæ•´åï¼ŒåŒæ ·çš„æ–¹æ³•åº”è¯¥é€‚ç”¨äºå¤šä¸ªç±»**ã€‚

![](img/df00a1fd508a8f5e9433a89b04a63dd8.png)

è‡ªåŠ¨é©¾é©¶[å›¾ç‰‡æ¥æº](https://www.mapillary.com/dataset/vistas?pKey=-3WWvMk6i1YgKC9ECG2HEA&lat=26.38900088674862&lng=82.67520964428127&z=2.4745541932089794)

![](img/116651860acfbe6056133402358f493a.png)

ç©ºä¸­æˆåƒ[å›¾åƒ](https://deepsense.ai/deep-learning-for-satellite-imagery-via-image-segmentation/)æ¥æº

> å®ƒçš„ä¸€äº›ä¸»è¦åº”ç”¨æ˜¯åœ¨**è‡ªåŠ¨é©¾é©¶**ã€**åŒ»å­¦å›¾åƒè¯Šæ–­ã€èˆªç©ºæˆåƒ**ã€**ç…§ç‰‡ç¼–è¾‘/åˆ›æ„å·¥å…·ä»¥åŠæ›´å¤š**ã€‚

![](img/bc9c46d3dd6058f5b6719cee00000c66.png)

è„‘è‚¿ç˜¤é¢„æµ‹[å›¾ç‰‡](https://news.developer.nvidia.com/automatically-segmenting-brain-tumors-with-ai/)æ¥æº

## æ¶µç›–ä¸»é¢˜çš„è·¯çº¿å›¾

1.  [***æ¦‚è¿°***](#2f8a)
2.  [***å…³äºæˆ‘ä»¬å°†è¦ä½¿ç”¨çš„æ•°æ®å’Œæ¡†æ¶çš„ç®€è¦æè¿°ã€‚***](#6188)
3.  [***ä»£ç å®ç°ä¸ºå•ä¸ªç±»ã€‚***](#e8e0) ***a .***[**æ•°æ®é¢„å¤„ç†ç®¡é“**](#1a68) **b .**[**Dataloders ç®¡é“**](#d7c8) **c .**[**åˆ†æ•°ç®¡é“**](#d15b) **d .**[***åŸ¹è®­***](#652e)
4.  [***æ¨è®º***](#f693)

## è¯­ä¹‰å›¾åƒåˆ†å‰²ç»¼è¿°

ç»™å®šä¸€å¹…ç°åº¦(Hï¼ŒWï¼Œ1)æˆ– RGB(Hï¼ŒWï¼Œ3)å›¾åƒï¼Œæˆ‘ä»¬å¸Œæœ›ç”Ÿæˆä¸€ä¸ªä¸å›¾åƒç»´æ•°ç›¸åŒçš„åˆ†å‰²æ©ç ï¼Œå®ƒç”±ä» 1 åˆ° N çš„åˆ†ç±»å€¼ç»„æˆ(N æ˜¯ç±»çš„æ•°é‡)ã€‚

![](img/774b1396a8a889520c097be75163a80c.png)

è¾“å…¥å›¾åƒåˆ°åˆ†å‰²æ ‡ç­¾[ä¿¡ç”¨](http://self)

![](img/049648118715399a948722a4b6ae8247.png)

åˆ†ç±»åˆ°ä¸€ä¸ªçƒ­ç¼–ç æ ‡ç­¾ä¿¡ç”¨

ç”±åˆ†ç±»å€¼ç»„æˆçš„è¯­ä¹‰æ ‡ç­¾ä¹Ÿå¯ä»¥è¢«çƒ­ç¼–ç ï¼Œå¦‚å·¦å›¾æ‰€ç¤ºã€‚

![](img/754aadd25518ab87b5b935848aed0e33.png)

åŸå§‹å›¾åƒå’Œè¯­ä¹‰æ ‡ç­¾çš„é‡å 

åœ¨å– argmax å¹¶ä¸åŸå§‹å›¾åƒé‡å åï¼Œæˆ‘ä»¬å°†åœ¨å·¦ä¾§å¾—åˆ°ä¸€ä¸ªå›¾åƒã€‚

## æ•°æ®é›†å’Œæ¡†æ¶

æˆ‘ä»¬å°†ä½¿ç”¨ kaggle æä¾›çš„ [carvana](https://www.kaggle.com/c/carvana-image-masking-challenge) æ•°æ®é›†ï¼Œå®ƒåŒ…å«äº†å¤§é‡çš„æ±½è½¦å›¾åƒã€‚æ¯è¾†è½¦æ­£å¥½æœ‰ 16 å¼ ç…§ç‰‡ï¼Œæ¯å¼ éƒ½æ˜¯ä»ä¸åŒçš„è§’åº¦æ‹æ‘„çš„ã€‚

![](img/4295bc8dc3ab7402f4e0980bee246966.png)

å•è½¦å›¾åƒçš„ 16 ä¸ªæ–¹å‘

> **æ–‡ä»¶æè¿°**

*   train â€”æ­¤æ–‡ä»¶å¤¹åŒ…å«è®­ç»ƒé›†å›¾åƒ(ã€‚jpg) [1280ï¼Œ1918]
*   æµ‹è¯•â€”è¯¥æ–‡ä»¶å¤¹åŒ…å«æµ‹è¯•é›†å›¾åƒ(jpg)[1280ï¼Œ1918]
*   train_masks â€”æ­¤æ–‡ä»¶å¤¹åŒ…å«è®­ç»ƒé›†æ©ç (ã€‚gif) [1280ï¼Œ1918]
*   train_masks.csv â€”è¯¥æ–‡ä»¶æä¾›äº†è®­ç»ƒæ©ç çš„æ¸¸ç¨‹ç¼–ç ç‰ˆæœ¬ã€‚
*   metadata.csv åŒ…å«æ‰€æœ‰æ±½è½¦çš„åŸºæœ¬ä¿¡æ¯ã€‚

ä½œä¸ºæ¡†æ¶ï¼Œæˆ‘ä»¬å°†ä¸»è¦ä½¿ç”¨ **Pytorch å’Œ sklearn** (ç”¨äº train/val åˆ†å‰²)ã€‚

# å•ä¸ªç±»çš„å®ç°

å®æ–½ç»†åˆ†ä¸º 4 ä¸ªç®¡é“

1.  **æ•°æ®é¢„å¤„ç†ç®¡é“-** å°† train_mask å›¾åƒä»ã€‚gif åˆ°ã€‚pngï¼Œç„¶åæˆ‘ä»¬å°†è½¬æ¢åˆ—è½¦å’Œåˆ—è½¦æ©ç å›¾åƒ(ã€‚png)ä»å®ƒä»¬çš„åŸå§‹ç»´åº¦åˆ°æ–°ç»´åº¦[128ï¼Œ128]ã€‚å‡ºäºæ‰€æœ‰åŸ¹è®­ç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ 128ï¼Œ128 å¹…å›¾åƒã€‚
2.  **æ•°æ®åŠ è½½å™¨ç®¡é“-** è¿™é‡Œæˆ‘ä»¬å°†æ‰¹é‡è·å–å›¾åƒï¼Œå¯¹å…¶åº”ç”¨å˜æ¢&ï¼Œç„¶åè¿”å›ç”¨äºè®­ç»ƒå’ŒéªŒè¯é˜¶æ®µçš„æ•°æ®åŠ è½½å™¨ã€‚
3.  **åˆ†æ•°ç®¡é“**â€”â€”è®¡ç®—æ‰€éœ€åˆ†æ•°çš„ç®¡é“(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ kaggle æåˆ°çš„éª°å­åˆ†æ•°)ã€‚
4.  **è®­ç»ƒç®¡é“** -å¼€å§‹è®­ç»ƒçš„æœ€ç»ˆç®¡é“ï¼Œè®¡ç®—æŸå¤±&æ›´æ–°å‚æ•°ã€‚

> **å…¥é—¨ï¼ï¼ï¼**

å¯¹äºè¿™ç¯‡åšå®¢ä¸­çš„æ‰€æœ‰ä»£ç ç‰‡æ®µï¼Œæˆ‘éƒ½å°½é‡åœ¨éœ€è¦çš„åœ°æ–¹åšäº†æ³¨é‡Šã€‚æˆ‘ä»¬å°†å¼€å§‹å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åº“ã€‚

![](img/65932e4c6c31e1bc96c131f006f58be3.png)

æˆ‘ä»¬å°†ä½¿ç”¨ Unet æ¶æ„ï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨ç”±[segmentation _ models . py torch](https://github.com/qubvel/segmentation_models.pytorch)æä¾›çš„é«˜çº§ API

![](img/d6f64361bfd4ef3da02b4fbb037662c6.png)

å¯¹äºå›¾åƒå’Œé®ç½©å¢å¼ºï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç”±[albuminations](https://github.com/albumentations-team/albumentations)æä¾›çš„ APIã€‚

1.  **æ•°æ®é¢„å¤„ç†æµæ°´çº¿**

é¦–å…ˆï¼Œæˆ‘ä»¬å°†è½¬æ¢ç«è½¦é¢å…·ä»ã€‚gif åˆ°ã€‚pngï¼Œç„¶åæˆ‘ä»¬å°†è°ƒæ•´ç«è½¦çš„å¤§å°ï¼Œå¹¶å°†å›¾åƒé®ç½©ä¸º[128ï¼Œ128]ã€‚è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ ThreadPoolExecutor è¿›è¡Œå¹¶è¡Œæ“ä½œã€‚

æ•°æ®é¢„å¤„ç†

ç°åœ¨ï¼Œæˆ‘ä»¬å°†åœ¨ dataframe ä¸­åŠ è½½ train_masks.csvï¼Œä»¥ä¾¿è·å–å›¾åƒåç§°ã€‚æˆ‘ä¸ä¼šä½¿ç”¨è¿™ä¸ª csv ä¸­æä¾›çš„è®­ç»ƒæ©ç çš„æ¸¸ç¨‹ç¼–ç ç‰ˆæœ¬ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨åˆšåˆšç”Ÿæˆçš„æ©ç å›¾åƒã€‚

```
df=pd.read_csv('/home/arun/Shashank/carvana/train_masks.csv')# location of original and mask image
img_fol='/media/shashank/New Volume/carvana/train-128'
mask_fol='/media/shashank/New Volume/carvana/train_masks-128'# imagenet mean/std will be used as the resnet backbone is trained on imagenet stats
mean, std=(0.485, 0.456, 0.406),(0.229, 0.224, 0.225)
```

ç”±äºæˆ‘ä»¬å°†ä½¿ç”¨åœ¨ imagnet ä¸Šè®­ç»ƒçš„ resnet åç«¯ï¼Œå› æ­¤æˆ‘ä»¬å°†è®¾ç½® imagenet æ•°æ®çš„å¹³å‡å€¼å’Œæ ‡å‡†åå·®ä»¥ç”¨äºè½¬æ¢ç›®çš„ã€‚

2.**æ•°æ®åŠ è½½å™¨ç®¡é“**

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å®ç°è‡ªå®šä¹‰è½¬æ¢ã€æ•°æ®é›†å’Œæ•°æ®åŠ è½½å™¨ã€‚
ä»å–å†³äºç›¸ä½çš„å˜æ¢å¼€å§‹ï¼Œå¦‚æœæ˜¯â€œè®­ç»ƒâ€,é‚£ä¹ˆæˆ‘ä»¬å°†ä½¿ç”¨æ°´å¹³ç¿»è½¬ä»¥åŠè§„æ ¼åŒ–å’Œä¼ æ„Ÿå™¨ã€‚å¦‚æœâ€œval â€,é‚£ä¹ˆæˆ‘ä»¬å°†åªä½¿ç”¨ Normalize å’Œ ToTensorã€‚

åº”ç”¨å˜æ¢

åœ¨è½¬æ¢ä¹‹åï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸º CarDataset çš„è‡ªå®šä¹‰æ•°æ®é›†ç±»ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ dataloader ä¸­çš„ç´¢å¼• id è·å–åŸå§‹å›¾åƒå’Œé®ç½©ï¼Œç„¶ååœ¨å…¶ä¸Šåº”ç”¨è½¬æ¢ã€‚è¿™ä¸ªç±»çš„è¾“å‡ºæ˜¯å½¢çŠ¶çš„å›¾åƒå¼ é‡[3ï¼Œ128ï¼Œ128]å’Œé®ç½©å¼ é‡[1ï¼Œ128ï¼Œ128]ã€‚å¯¹äºæ©æ¨¡å¼ é‡ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªé€šé“ï¼Œå› ä¸ºæˆ‘ä»¬åªè®­ç»ƒä¸€ä¸ªç±»ã€‚

![](img/3c37efc5e4c891627df6fbdf648b65df.png)

å±è”½å•é€šé“è¡¨ç¤º[1ï¼Œ128ï¼Œ128]ã€‚

è‡ªå®šä¹‰æ•°æ®é›†

ç°åœ¨ä½¿ç”¨ CarDataloader å‡½æ•°ï¼Œæˆ‘ä»¬å°†è¾“å…¥æ•°æ®å¸§åˆ†æˆè®­ç»ƒæ•°æ®å¸§å’Œæœ‰æ•ˆæ•°æ®å¸§(ä»…ä¸ºäº†å‘½å)ã€‚ä½¿ç”¨è¿™äº›æ•°æ®æ¡†æ¶ï¼Œæˆ‘ä»¬åˆ›å»ºç”¨äºè®­ç»ƒå’ŒéªŒè¯çš„æ•°æ®åŠ è½½å™¨ã€‚

æ•°æ®åŠ è½½å™¨

**3ã€‚åˆ†æ•°ç®¡é“**

ä¸ºäº†è§£å†³ç±»åˆ«ä¸å¹³è¡¡çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨**è½¯éª°å­å¾—åˆ†**è€Œä¸æ˜¯ä½¿ç”¨**åƒç´ äº¤å‰ç†µæŸå¤±**ã€‚ä¸ºäº†è®¡ç®—æ¯ä¸ªç±»åˆ«çš„ SDSï¼Œæˆ‘ä»¬ä¹˜ä»¥(é¢„æµ‹åˆ†æ•°*ç›®æ ‡åˆ†æ•°)å¹¶é™¤ä»¥(é¢„æµ‹åˆ†æ•°+ç›®æ ‡åˆ†æ•°)çš„æ€»å’Œã€‚

![](img/357efd963a706e198455a4fe6917040d.png)

[å›¾åƒ](https://www.jeremyjordan.me/semantic-segmentation/)

åœ¨æ‰€æœ‰æ‰¹æ¬¡çš„æ¯ä¸ªæ—¶æœŸå†…ï¼Œæˆ‘ä»¬è®¡ç®—éª°å­ç‚¹æ•°å¹¶æ·»åŠ åˆ°ä¸€ä¸ªç©ºåˆ—è¡¨ä¸­ã€‚åœ¨æ—¶æœŸç»“æŸæ—¶ï¼Œæˆ‘ä»¬è®¡ç®—éª°å­ç‚¹æ•°çš„å¹³å‡å€¼ï¼Œå…¶ä»£è¡¨è¯¥ç‰¹å®šæ—¶æœŸçš„éª°å­ç‚¹æ•°ã€‚

åœ¨ epoch ç»“æŸæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ epoch_log å‡½æ•°è®°å½•éª°å­å€¼ã€‚

**4ã€‚åŸ¹è®­æ¸ é“**

åœ¨æœ€åä¸€ä¸ªç®¡é“ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åˆå§‹åŒ–å¤§å¤šæ•°å€¼æ¥åˆ›å»ºä¸€ä¸ªè®­ç»ƒå™¨ç±»ã€‚

åŸ¹è®­å¸ˆè¯¾ç¨‹

åœ¨æ¯ä¸ªæ—¶æœŸçš„**å¼€å§‹æ–¹æ³•**ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆè°ƒç”¨è¿­ä»£æ–¹æ³•è¿›è¡Œè®­ç»ƒï¼Œç„¶åè°ƒç”¨è¿­ä»£æ–¹æ³•è¿›è¡ŒéªŒè¯&ï¼Œç„¶åè°ƒç”¨**å­¦ä¹ é€Ÿç‡è°ƒåº¦**ã€‚å¦‚æœå½“å‰éªŒè¯æŸå¤±å°äºå‰ä¸€ä¸ªï¼Œåˆ™æˆ‘ä»¬ä¿å­˜æ¨¡å‹å‚æ•°ã€‚

![](img/404bfe6b7755ff2f51696a3ffab58e3b.png)

åœ¨**è¿­ä»£æ–¹æ³•**ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨å‘å‰æ–¹æ³•æ¥è®¡ç®—æŸè€—ï¼Œç„¶åé™¤ä»¥ç´¯åŠ æ­¥é•¿&åŠ åˆ°è¿è¡ŒæŸè€—ä¸Šã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ç»§ç»­å­˜å‚¨æŸè€—æ¢¯åº¦ï¼Œç›´åˆ° loss.grad ä¸­çš„ç´¯ç§¯æ­¥éª¤ã€‚

ä¹‹åï¼Œæˆ‘ä»¬è¿›è¡Œä¼˜åŒ–æ­¥éª¤ï¼Œä¸€æ—¦è¾¾åˆ°ç´¯ç§¯æ­¥éª¤ï¼Œå°±å°†æ¢¯åº¦å½’é›¶ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æœ‰çºªå…ƒæŸå¤±ï¼Œéª°å­å¾—åˆ†&å°†æ¸…é™¤ cuda ç¼“å­˜å†…å­˜ã€‚

åœ¨æ­£å‘æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†åŸå§‹å›¾åƒå’Œç›®æ ‡é®ç½©å‘é€åˆ° GPUï¼Œåˆ›å»ºä¸€ä¸ªæ­£å‘è¿‡ç¨‹æ¥è·å¾—é¢„æµ‹é®ç½©ã€‚ä½¿ç”¨æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬è®¡ç®—æŸå¤±ã€‚

# ä» smp åŠ è½½æ¶æ„

ç°åœ¨æ˜¯ä» smp åŠ è½½ UNet æ¶æ„çš„æ—¶å€™äº†ï¼Œä½¿ç”¨ resnet18 ä½œä¸ºä¸»å¹²ã€‚å¯¹äºç±»çš„æ•°é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ 1 ä½œä¸ºæˆ‘ä»¬çš„æ©ç ç»´æ•°æ˜¯[1ï¼Œ128ï¼Œ128]ã€‚

```
model = smp.Unet("resnet18", encoder_weights="imagenet", classes=1, activation=None)
```

è®©é­”æ³•å¼€å§‹å§ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼

```
model_trainer = Trainer(model)
model_trainer.start()Starting epoch: 0 | phase:train | ğŸ™Š':02:02:11
Loss: 0.1084 |dice: 0.9460
Starting epoch: 0 | phase:val | ğŸ™Š':02:02:48
Loss: 0.0358 |dice: 0.9783
******** New optimal found, saving state ********

Starting epoch: 1 | phase:train | ğŸ™Š':02:02:55
Loss: 0.0288 |dice: 0.9800
Starting epoch: 1 | phase:val | ğŸ™Š':02:03:29
Loss: 0.0239 |dice: 0.9815
******** New optimal found, saving state ********

Starting epoch: 2 | phase:train | ğŸ™Š':02:03:36
Loss: 0.0205 |dice: 0.9836
Starting epoch: 2 | phase:val | ğŸ™Š':02:04:11
Loss: 0.0185 |dice: 0.9844
******** New optimal found, saving state ********

Starting epoch: 3 | phase:train | ğŸ™Š':02:04:18
Loss: 0.0172 |dice: 0.9854
Starting epoch: 3 | phase:val | ğŸ™Š':02:04:53
Loss: 0.0167 |dice: 0.9853
******** New optimal found, saving state ********

Starting epoch: 4 | phase:train | ğŸ™Š':02:04:59
Loss: 0.0155 |dice: 0.9863
Starting epoch: 4 | phase:val | ğŸ™Š':02:05:34
Loss: 0.0154 |dice: 0.9860
******** New optimal found, saving state ********

Starting epoch: 5 | phase:train | ğŸ™Š':02:05:40
Loss: 0.0149 |dice: 0.9864
Starting epoch: 5 | phase:val | ğŸ™Š':02:06:14
Loss: 0.0158 |dice: 0.9850

Starting epoch: 6 | phase:train | ğŸ™Š':02:06:20
Loss: 0.0142 |dice: 0.9869
Starting epoch: 6 | phase:val | ğŸ™Š':02:06:55
Loss: 0.0158 |dice: 0.9848

Starting epoch: 7 | phase:train | ğŸ™Š':02:07:00
Loss: 0.0132 |dice: 0.9877
Starting epoch: 7 | phase:val | ğŸ™Š':02:07:35
Loss: 0.0145 |dice: 0.9863
******** New optimal found, saving state ********

Starting epoch: 8 | phase:train | ğŸ™Š':02:07:41
Loss: 0.0127 |dice: 0.9881
Starting epoch: 8 | phase:val | ğŸ™Š':02:08:15
Loss: 0.0151 |dice: 0.9855

Starting epoch: 9 | phase:train | ğŸ™Š':02:08:21
Loss: 0.0125 |dice: 0.9882
Starting epoch: 9 | phase:val | ğŸ™Š':02:08:57
Loss: 0.0136 |dice: 0.9869
******** New optimal found, saving state ********
```

# æ¨ç†

åœ¨å¤§çº¦ 6 åˆ†é’Ÿå†…ï¼Œæˆ‘ä»¬è¾¾åˆ°äº†ä»¤äººå°è±¡æ·±åˆ»çš„ 98.7 çš„éª°å­å¾—åˆ†ï¼Œä½¿ç”¨èŠ‚çœä¸‹æ¥çš„æƒé‡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸‹é¢çš„ç‰‡æ®µå¯¹æˆ‘ä»¬çš„éªŒè¯æ•°æ®è¿›è¡Œæ¨æ–­ã€‚

![](img/8ed6b62efb0ae95ba03e962b82238033.png)![](img/fbf5b32f7d5e6e40f6812818ed2c524e.png)

å·¦ä¸ºé¢„æµ‹é®ç½©ï¼Œå³ä¸ºç›®æ ‡é®ç½©ã€‚

# **ç»“è®º**

è¿™å¯èƒ½ä¸æ˜¯ SOTA çš„ç»“æœï¼Œä½†æ˜¯é€šè¿‡ä½¿ç”¨ä»…ä»… 200 è¡Œä»£ç ï¼Œæˆ‘ä»¬æ¸…æ¥šåœ°äº†è§£äº†è¯­ä¹‰åˆ†å‰²æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚é€šè¿‡è°ƒæ•´å‡ è¡Œä»£ç ï¼Œå¯ä»¥å¯¹å¤šç±»æ ‡ç­¾åšåŒæ ·çš„äº‹æƒ…ã€‚è¯·**åˆ†äº«ï¼Œå¦‚æœ‰è¯„è®ºè¯·**ç•™ä¸‹ã€‚