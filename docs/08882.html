<html>
<head>
<title>Bernoulli trials in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">python 中的伯努利试验</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bernoulli-trials-in-python-60759b5e0702?source=collection_archive---------12-----------------------#2020-08-17">https://medium.com/analytics-vidhya/bernoulli-trials-in-python-60759b5e0702?source=collection_archive---------12-----------------------#2020-08-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8360" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di"> D </span>违约风险是指公司、个人或国家无法履行其与支付合同利息或债务初始资本相关的义务的风险。</p><p id="a73b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在数据营课程中做了这个练习。假设我们查看一家银行提供的贷款数量，并为每笔违约写下数字 1，为每笔已付贷款写下数字 0。<br/>尽管我们无法知道违约的价值，但违约的可能性是存在的——我们可以假设这种可能性是恒定的。<br/>另外，有没有违约，不影响下一笔贷款还不还的可能性。</p><h2 id="0449" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated"><strong class="ak">随机模块和伯努利试验</strong></h2><p id="9dcd" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">random 模块函数返回一个介于 0 和 1 之间的随机数。</p><p id="8e69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">伯努利过程具有以下特征:</p><ul class=""><li id="3935" class="km kn hi ih b ii ij im in iq ko iu kp iy kq jc kr ks kt ku bi translated">随机变量可以取值 0 或 1。值 1 称为成功，0 称为失败；</li><li id="2d22" class="km kn hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated">在整个实验过程中，成功的概率是不变的；</li><li id="dc58" class="km kn hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated">获得的各种结果是相互独立的。</li></ul><p id="f53c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">概率函数可以写成如下形式:</p><p id="dabb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="la"> p(0) = P(X=0) = 1-p </em></p><p id="3fcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="la"> p(1) = P(X = 1)=p </em></p><p id="854e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">x 称为<em class="la">伯努利随机变量。</em></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="047f" class="jm jn hi lg b fi lk ll l lm ln">def perform_bernoulli_trials(n, p):<br/>    """Perform n Bernoulli trials with success probability p<br/>    and return number of successes."""<br/>    # Initialize number of successes: n_success<br/>    n_success = 0</span><span id="632d" class="jm jn hi lg b fi lo ll l lm ln"># Perform trials<br/>    for i in range(n):<br/>        # Choose random number between zero and one: random_number<br/>        random_number = np.random.random()</span><span id="e6d8" class="jm jn hi lg b fi lo ll l lm ln"># If less than p, it's a success  so add one to n_success<br/>        if random_number &lt; p:<br/>            n_success += 1</span><span id="dcf3" class="jm jn hi lg b fi lo ll l lm ln">return n_success</span></pre><p id="426f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以考虑一家发放了 100 笔抵押贷款的银行。在这种情况下，有可能 0 到 100 的贷款会被拖欠。考虑到违约概率为 p = 0.05，下一个代码使用 perform_bernoulli_trials()函数执行 100 次 Bernoulli 试验。如前所述，成功是一种默认。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="73c9" class="jm jn hi lg b fi lk ll l lm ln"># Seed random number generator<br/>np.random.seed(42)</span><span id="5287" class="jm jn hi lg b fi lo ll l lm ln"># Initialize the number of defaults: n_defaults<br/>n_defaults = np.empty(1000)</span><span id="d9a8" class="jm jn hi lg b fi lo ll l lm ln"># Compute the number of defaults<br/>for i in range(1000):<br/>    n_defaults[i] = perform_bernoulli_trials(100, 0.05)</span><span id="361c" class="jm jn hi lg b fi lo ll l lm ln"># Plot the histogram with default number of bins; label your axes<br/>_ = plt.hist(n_defaults, density=True)<br/>_ = plt.xlabel('number of defaults out of 100 loans')<br/>_ = plt.ylabel('probability')</span><span id="7940" class="jm jn hi lg b fi lo ll l lm ln"># Show the plot<br/>plt.show()</span></pre><figure class="lb lc ld le fd lq er es paragraph-image"><div class="er es lp"><img src="../Images/fb71fd99d368d7cf3cc4ae217392d8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*dvRJVgZhqcFmVxRxlVmZBQ.png"/></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">图 1 —违约概率</figcaption></figure><p id="1684" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图 1 显示了描述违约概率的直方图。</p><h2 id="3e0d" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated">银行违约的可能性有多大？</h2><p id="4485" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">接下来，我们可以看到从前面的代码中得到的违约数量的曲线图，它是一个经验累积分布。</p><p id="113a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果利率如此之高，以至于 10%或更多的贷款被拖欠，那么该银行亏损的概率有多大？</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="b36c" class="jm jn hi lg b fi lk ll l lm ln"># Compute ECDF(Empirical cumulative distribution function): x, y</span><span id="76e6" class="jm jn hi lg b fi lo ll l lm ln">def ecdf(data):<br/>    """Compute ECDF for a one-dimensional array of measurements."""<br/>    # Number of data points: n<br/>    n = len(data)</span><span id="d313" class="jm jn hi lg b fi lo ll l lm ln"># x-data for the ECDF: x<br/>    x= np.sort(data)</span><span id="2ff8" class="jm jn hi lg b fi lo ll l lm ln"># y-data for the ECDF: y<br/>    y = np.arange(1, 1+n) / n</span><span id="1d95" class="jm jn hi lg b fi lo ll l lm ln">return x, y</span><span id="c000" class="jm jn hi lg b fi lo ll l lm ln">x, y = ecdf(n_defaults)</span><span id="f2f4" class="jm jn hi lg b fi lo ll l lm ln"># Plot the CDF with labeled axes<br/>_ = plt.plot(x, y, marker='.', linestyle='none')<br/>_ = plt.xlabel('number of defaults out of 100')<br/>_ = plt.ylabel('CDF')</span><span id="0f63" class="jm jn hi lg b fi lo ll l lm ln"># Show the plot<br/>plt.show()</span><span id="7508" class="jm jn hi lg b fi lo ll l lm ln"># Compute the number of 100-loan simulations with 10 or more defaults: n_lose_money<br/>n_lose_money = np.sum(n_defaults &gt;= 10)</span><span id="b452" class="jm jn hi lg b fi lo ll l lm ln"># Compute and print probability of losing money<br/>print('Probability of losing money =', n_lose_money / len(n_defaults))</span></pre><figure class="lb lc ld le fd lq er es paragraph-image"><div class="er es lx"><img src="../Images/33cd7ac35cd241a88f2a250a215e7198.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*5ly_-cwy9JPyzOxk0o0Y2g.png"/></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">图 2 —赔钱的概率</figcaption></figure></div></div>    
</body>
</html>