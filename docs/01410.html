<html>
<head>
<title>In Depth Statistical Analysis of VGG Face Network’s Performance on Custom Data set</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VGG人脸网络在自定义数据集上性能的深度统计分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/in-depth-statistical-analysis-of-vgg-face-networks-performance-on-custom-data-set-ef4b72bc15b9?source=collection_archive---------8-----------------------#2019-10-20">https://medium.com/analytics-vidhya/in-depth-statistical-analysis-of-vgg-face-networks-performance-on-custom-data-set-ef4b72bc15b9?source=collection_archive---------8-----------------------#2019-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a0c63b8f0506efd04aa8e5252ae4626b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L8hcB-HcYuFHagCn"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">布兰登·莫温克尔在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2473" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">VGG脸是一个非常深刻的CNN架构，它学习了数百万名人的图像。它被用作特征提取器来提取全连接层的激活向量。我浏览了很多博客，这些博客解释了在你的自定义数据集上进行人脸验证和识别。我只提到其中的几个。希望你也会发现它们有用。</p><ul class=""><li id="725e" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">【Keras的VGG脸模特</li><li id="677e" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><a class="ae iu" href="https://machinelearningmastery.com/how-to-perform-face-recognition-with-vggface2-convolutional-neural-network-in-keras/" rel="noopener ugc nofollow" target="_blank">如何进行人脸识别</a></li><li id="87d0" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><a class="ae iu" href="https://www.dlology.com/blog/live-face-identification-with-pre-trained-vggface2-model/" rel="noopener ugc nofollow" target="_blank">活体人脸检测</a></li></ul><p id="1bdd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我将讨论如何提出一个最适合你自己数据的相似性指数阈值(特别是余弦相似性分数)。根据不同的用例，你可能需要修改它(或者让它自动修改自己！)随着你开始收集更多的数据。</p><p id="5f44" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我从搭建舞台开始-</p><p id="5543" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我收集了5个人的大约200张脸用于实验。然后，我准备了pandas数据帧，对每个组内以及组间的图像进行成对比较。</p><p id="44d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设有k个类别或组。每组由一个人多个面部图像组成。</p><p id="bd64" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">n₁ =第1组中的图像数量，n₂ =第2组中的图像数量，依此类推。</p><p id="57eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么组内唯一成对比较的数量可以使用以下公式计算:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/aaa2fbf893360d2b223dd54b38929627.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*TyvVNcD5BKgh32sQpTXyIw.png"/></div></figure><p id="64ce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为有k个群，所以有kC₂唯一对群。组间比较的总数将是，</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/9a051e97b05e39755605e3996c62996a.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*pyKClQZU960KL8Pa5sxneg.png"/></div></div></figure><p id="cc75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总而言之:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/7d3d4df44f1b5300b091dc45137c65da.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*f_UlkWzIBthP5Mu7cWmxxA.png"/></div></figure><p id="ab22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了让生活简单一点，我从每组中抽取10%的配对样本(没有替换)，从每组组间配对中抽取10%。所以我只剩下大约2000对图像。</p><p id="3882" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在执行2000次成对比较并将结果附加到pandas数据框后，数据集看起来如图所示:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/d105cc5a92360ae8387bd1c1f087d2df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XzMnN-pfaOriM1joRrsE2g.png"/></div></div></figure><p id="2d23" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">数据描述:</strong></p><p id="3e93" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Img1:图像1的路径</p><p id="f495" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Img2:图像2的路径</p><p id="5f6a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">is_match:两张脸是否属于同一个人的真值</p><p id="e04c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ε:余弦相似性得分</p><p id="78b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">true_class:人员的姓名</p><p id="1d6c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在数据生成过程中，我确保数据集中没有插入缺失值。</p><p id="87b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">探索性数据分析</strong></p><p id="de5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">A.比较频率分布</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/936be8b0c5023356321a9eb44df3664f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/0*xJr3wyLMpfakKh9j"/></div></figure><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/d59c50c3724daa5b58ee6ca5760fc488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/0*ngMbJTUqN3YshWWx"/></div></figure><p id="7575" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">主要观察结果:</strong></p><ul class=""><li id="ac44" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">“似乎”这两种方法是不同的。</li><li id="8ce1" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">对于负类，很容易看出分布近似正态。</li><li id="9906" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">如果图像是相同的，平均值倾向于向0移动。</li><li id="6415" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">类中有一些标为“True”的异常值。(我们不希望高ε值被贴上真实的标签)</li></ul><p id="ed57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们探索一下系统对于不同的群体是如何表现的。(当图像相同时)</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/241629767481d2673969a5d8e3959411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/0*f4ESC36daBtNWY2J"/></div></figure><p id="b6cb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">重点观察</strong>:</p><ul class=""><li id="6cd9" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">因为C和D的平均值几乎相等。</li><li id="2ec5" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">对于所有被识别为相同的人脸，余弦值小于0.4</li><li id="89e9" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">问题—这是否意味着0.4应该是阈值参数的最佳值？让我们更详细地探讨一下。</li></ul><p id="c5cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们仍然需要了解样本间观察到的差异是仅仅意味着由于抽样变异还是由于总体均值的真实差异？</p><p id="5a82" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，在进入模型构建步骤之前，我们还想回答以下问题。</p><ul class=""><li id="9350" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">正类和负类的epsilon值之间的差异有统计学意义吗？</li><li id="08c2" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">系统是否偏向某个特定的阶层？</li></ul><p id="52b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">方差分析</strong></p><p id="cd4b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">单向方差分析(ANOVA)用于比较几个平均值。这种方法通常用于科学或医学实验中，比较治疗方法、过程、材料或产品。</p><p id="a035" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">比较组均值和中位数:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/2014748aa9423884bc4691fa93881643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*-VC4FStTznLXB6ub260JEA.png"/></div></figure><p id="3a84" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很明显，我们有一个对称的群体分布。所以第一个假设满足了。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/a2a99be20163547ecc566b58d06cb8c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*5SKE7RsBD5HWlP-k5MRkUw.png"/></div></div></figure><p id="1a1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">也证明了组标准偏差非常相似。这些结果与上面给出的箱线图一起表明每组的分布是对称的。因此，我们可以进行方差分析。由于缺少数据点，我有意删除了包含F类的行。</p><p id="b7be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">方差分析表</strong></p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/97d828fdcb9cf0c454485886a0044c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*XahL6nybKuwNb9Bcerb8NQ.png"/></div></figure><p id="46fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据我们的结果，我们可以说，有强有力的证据表明，平均ε值随组而变化。至少有一个群体的平均值是不相等的。</p><p id="94e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Tukey HSD测试:</strong></p><p id="d97c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Tukey HSD检验表明，A、B和C类之间的差异在95%的置信水平下是显著的。然而，对于所有其他组对，ε得分的平均值之间没有显著差异。这意味着在某些情况下，VGG网络可能无法正确识别这些群体中的人脸。可能是因为图像质量差或者闪电条件？这需要进一步调查。我们不会期望CNN偏袒某一群人。</p><p id="970c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">训练和测试数据集</strong></p><p id="da0c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">生成的数据集分为训练数据集和测试数据集，比例为70:30。正类和负类的分布在两个数据集中得到验证，并确保其在容许范围内。</p><p id="e121" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">建模—逻辑模型</strong></p><p id="8a63" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是我的物流模型的输出:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/9012c66283a893e6049885a925215cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWUAIb6x4aHljespKCqvXw.png"/></div></div></figure><p id="9a88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">费希尔评分迭代次数= 6，AIC : 1075</p><p id="6350" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很明显，ε在确定两个面是否相同时非常重要。</p><p id="1f66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下图描述了较低的ε分数有助于较高的匹配概率。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/40d64b8b91d11b0025ded0c3845046dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/0*heNwt5_f_l_y5I61"/></div></figure><p id="b0e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> ROC曲线</strong></p><p id="97a7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ROC曲线是在各种阈值设置下对分类问题的性能测量。该模型在阈值为0.2时获得的曲线下面积为0.8349。AUC越高，该模型在区分相同和不同人脸方面就越好。</p><p id="e4c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么到底有多好呢？如何确定阈值对您的模型是好的？让我们仔细探索一下。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/716a5f1b45632ea7c89cdcbb1f0c08ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/0*JwY6KX9chapqoprV"/></div></div></figure><p id="5a81" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">混乱矩阵</strong></p><p id="9310" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> ( </strong>阈值= 0.3 <strong class="ix hj"> ) </strong></p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/4e314c38819e8ac1dd95b1249093dd59.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*dRLs0i9NWXNIpRx8_8qADg.png"/></div></figure><p id="287b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总体准确率:(338+73)/(338+73+74+38) = 78%</p><p id="942a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在事情变得有点棘手了。</p><p id="981b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们应该接受这种模式并将其部署到我们的生产系统中吗？</p><p id="1a16" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此时，您应该首先仔细分析和理解您的系统的目的，并为其添加一些业务背景。对你来说什么更重要——给人脸贴上完全相同的标签，因为它们实际上完全相同，而且准确度很高？如果不是真的匹配，你能容忍给脸贴上匹配的标签吗？</p><p id="3dcc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，如果一对人脸实际上在91%的情况下是不相似的，那么上面的模型将它们标记为假的。这对于特定的用例来说可能是好的。</p><p id="0b94" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有了上面的统计理解，现在你可以根据小时的要求微调你的阈值。这种统计建模技术允许您建立性能标准，根据需要为各种群体定制您的面部检测模型，或者只是监视真实世界场景中的性能。</p></div></div>    
</body>
</html>