<html>
<head>
<title>GLoVE: Theory and Python Implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">手套:理论和Python实现</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/glove-theory-and-python-implementation-b706aea28ac1?source=collection_archive---------3-----------------------#2020-02-17">https://medium.com/analytics-vidhya/glove-theory-and-python-implementation-b706aea28ac1?source=collection_archive---------3-----------------------#2020-02-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7a4720e84993a3242b47105428cb45b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFKTEPzVCdVZsgYkLPASNQ.jpeg"/></div></div></figure><p id="787e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">GloVe:单词表示的全局向量</p><p id="0708" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我们将介绍构建手套模型的方法，并实现python代码来提取特定单词作为输入的嵌入。</p><p id="9e88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从根本上说，所有开发的语言模型都致力于实现一个共同的目标，即在NLP中实现迁移学习的可能性。因此，不同的教育和商业组织寻求不同的方法来实现这一目标。</p><p id="bd7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个突出且被充分证明的方法是给定一个巨大的语料库，为单词建立一个共现矩阵。斯坦福大学的一组研究人员采用了这种方法，结果证明这是一种简单而有效的方法来提取给定单词的单词嵌入。</p><p id="3f88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">内容:</strong></p><ol class=""><li id="2be2" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><strong class="is hj">回顾单词嵌入</strong></li><li id="a144" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">共现矩阵介绍</strong></li><li id="e443" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">优化的成本函数</strong></li><li id="8b5e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj"> Python实现</strong></li></ol><p id="c8dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">回顾单词嵌入:</strong></p><p id="0199" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单词嵌入是单词的向量表示，帮助我们提取线性子结构，并以模型更好理解的方式处理文本。通常，在定义的模型收敛于成本函数之后，单词嵌入是神经网络结构的隐藏层的权重。要深入了解这一点，请参考以下内容:</p><p id="5087" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" rel="noopener" href="/analytics-vidhya/theory-behind-word-embeddings-in-word2vec-858b9350870b">Word 2 vec中单词嵌入背后的理论</a></p><p id="00c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">同现矩阵介绍</strong></p><p id="313b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从它的定义开始理解共生矩阵。共现矩阵主要给出两个词在庞大的语料库中同时出现的频率信息。考虑下面的截图，</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/6f423b79067b7ec8969f3593c30fcd25.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/0*GQzoac8gv1-zdU6v"/></div></figure><p id="b97d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，X1、X2等是语料库中的特有词，而Xij表示Xi和Xj在整个语料库中一起出现的频率。虽然，这个矩阵作为一个整体不一定服务于我们的目的，它只是成为神经网络训练的目标。换句话说，给定特定单词的一个热嵌入向量的输入(与Word2Vec中相同)，模型被训练来预测共现矩阵。</p><p id="d6d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，总的来说，一旦模型收敛，预测共现矩阵是为了提取单词嵌入而定义的伪任务。</p><p id="d6fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">成本函数:</strong></p><p id="8328" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于任何要收敛的机器学习模型，它本质上需要一个可以优化的成本或误差函数。在这种情况下，成本函数是:</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/fac3bbd358f05089d95dcaf52d8cfa1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/0*KN3GvWO2W1f8uoH2"/></div></figure><p id="248c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，J是成本函数。因此，让我们一个一个地研究这些术语:</p><ol class=""><li id="fc2c" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">Xij是Xi和Xj在语料库中一起出现的频率</li><li id="1023" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">Wi和Wj分别是单词I和j的单词向量。</li><li id="e193" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">bi和bj对应于单词I和j的偏差。</li></ol><p id="3650" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第二个等式中，Xmax是最大同现频率的阈值，该参数被定义为防止隐藏层的权重被破坏。因此，函数f(Xij)本质上是在模型上定义的约束。</p><p id="1e04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦代价函数被优化，隐藏层的权重就变成了单词嵌入。根据我们选择的模型，来自手套模型的单词嵌入可以是50，100维向量。下面的链接提供了斯坦福大学发布的不同类型的手套模型，可供下载。</p><p id="9e61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">手套型号:斯坦福集团</a></p><p id="de38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Python实现</strong></p><p id="ccd8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">令牌和词汇的数量越多，模型性能就越好。此外，我们需要考虑我们所拥有的架构，使用正确的模型来加快计算速度。我们将使用在维基百科数据上训练的100维手套模型来提取python中给定单词的单词嵌入。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/0b313a456f1be1a8a8c6a00995456924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*WsoHSJGjZlVfQl28O77e-A.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">从100D手套模型加载向量的代码片段</figcaption></figure><p id="17b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，print(embedding _ index[' banana '])命令给出了单词banana的单词嵌入向量，类似地，可以提取任何单词的嵌入向量。按照下面的代码片段查找每个单词的余弦相似性指数。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/a57b45eded1b8fdb2ed6198fad7f6e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*X1fAXlc3uxth_HoKjqtauw.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">给出最接近计算结果的前7个单词的代码</figcaption></figure><p id="6f76" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，可以提取线性子结构，这在我以前的帖子中已经讨论过。</p><p id="edd2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面的链接将您重定向到代码文件，用于从预训练的手套模型中提取python中的单词嵌入。</p><p id="7645" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://github.com/abhishekperambai/My_Dir" rel="noopener ugc nofollow" target="_blank">来自GLoVE 100D模型的单词嵌入</a></p><p id="76a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请关注这个空间，获取更多关于嵌入式的内容，因为我计划撰写一系列关于BERT及其应用的文章。非常感谢对此的任何反馈。</p></div></div>    
</body>
</html>