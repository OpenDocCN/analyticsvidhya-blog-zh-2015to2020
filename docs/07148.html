<html>
<head>
<title>S&amp;P 500 Forecasting using Facebook’s Prophet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">标准普尔500利用脸书的先知进行预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/s-p-500-prediction-using-facebooks-prophet-e1a112584b9f?source=collection_archive---------10-----------------------#2020-06-15">https://medium.com/analytics-vidhya/s-p-500-prediction-using-facebooks-prophet-e1a112584b9f?source=collection_archive---------10-----------------------#2020-06-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0650a23840449d05e2ca7909a7660aba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R4LwqjOu0Ht9wPCY.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">鸣谢:Getty Images</figcaption></figure><h1 id="67cd" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">免责声明:市场和机器学习</h1><p id="0016" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">股票绝对是一个时间序列。对于每个值具有连续时间点的任何数据也是如此。不幸的是，你不能可靠地战胜市场。</p><p id="4de2" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">《用Python进行深度学习》Chollet的书说，市场与天气模式等自然现象相比，具有非常不同的统计特征。当你只能访问公开可用的数据时，试图使用机器学习来击败市场是一项艰巨的任务，你可能会浪费时间和资源，却没有任何回报。</p><blockquote class="kw kx ky"><p id="31e6" class="js jt kv ju b jv kq jx jy jz kr kb kc kz ks kf kg la kt kj kk lb ku kn ko kp hb bi translated">永远记住，当谈到市场时，过去的表现并不能很好地预测未来的回报——<strong class="ju hj">看后视镜是一种糟糕的驾驶方式。</strong>另一方面，机器学习适用于过去可以很好预测未来的数据集。</p></blockquote><p id="93ba" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">使用时间序列预测来预测股票价格并让我们都变得富有是一个非常糟糕的主意。相反，如果我们盲目地依赖它，它会让我们损失数百万。</p><h1 id="231d" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">介绍</h1><p id="1338" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这篇文章是关于学习脸书的先知，并用它来预测标准普尔500作为一个教程。</p><p id="b4ef" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">在本教程中，我们将使用Prophet(脸书的时间序列预测库)预测股票价格。然而，历史价格并不能表明价格会上涨还是下跌。我宁愿使用我自己的变量(移动平均线)并使用机器学习来预测股价，而不是仅仅使用历史价格作为股价上涨的指标。</p><h1 id="cbd1" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">脸书的先知是什么？</h1><p id="3f43" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">最常用的预测模型是自回归模型。预测可能是一门很难的科学，需要大量的专业知识。因此，为了开发一种可以捕捉时间序列数据中季节性的模型，脸书的研究团队开发并开源了<a class="ae lc" href="https://facebook.github.io/prophet/docs/quick_start.html#python-api" rel="noopener ugc nofollow" target="_blank"> Prophet </a>，它允许任何拥有Python或R编程技能的人轻松实现对时间序列的预测。</p><p id="ce8c" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">prophet是一个开源库，用于基于<a class="ae lc" href="https://en.wikipedia.org/wiki/Additive_model" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hj">加法回归模型</strong> </a>预测时间序列数据，其中它可以轻松捕获<strong class="ju hj">每日</strong>、<strong class="ju hj">每周</strong>和<strong class="ju hj">每年</strong>季节性以及<strong class="ju hj">假日效应</strong>。</p><p id="bed4" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">Prophet使用一个可分解的时间序列模型，它有三个主要的模型组件:增长、季节性和假期。它们通过以下等式组合在一起:</p><blockquote class="ld"><p id="e148" class="le lf hi bd lg lh li lj lk ll lm kp dx translated">y(t) = g(t) + s(t) + h(t) + e(t)</p></blockquote><p id="2d3a" class="pw-post-body-paragraph js jt hi ju b jv ln jx jy jz lo kb kc kd lp kf kg kh lq kj kk kl lr kn ko kp hb bi translated">其中<strong class="ju hj"> <em class="kv"> g(t) </em> </strong>代表趋势。Prophet使用分段线性模型进行趋势预测，<strong class="ju hj"> <em class="kv"> s(t) </em> </strong>代表由于每周或每年季节性的周期性变化，<em class="kv"> h(t) </em>代表节假日的影响，<em class="kv"> e(t) </em>代表误差项。</p><p id="2a22" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">Prophet模型通常非常快，即使对于成千上万次观察也是如此。它不需要任何数据预处理，也可以处理缺失数据和异常值。</p><p id="3f7e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">我们开始吧！</p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="beaf" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">我们将使用<a class="ae lc" href="https://colab.research.google.com/notebooks/intro.ipynb" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>进行演示，在其中旋转Python笔记本并安装必要的库。</p><p id="5924" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">我们从安装某些库开始，然后导入它！</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/732da7cc5c3ce7bd9643c7f93e4c0efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNe0uvL11lQKrSwB6kMH0g.png"/></div></div></figure><p id="5f07" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">由于google collab中的版本不匹配，我们必须在导入这些库之前安装Plotly、chart_studio并升级statsmodel。</p><p id="d7e9" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">让我们试着理解我们的数据=我们从雅虎财经历史数据中提取了过去6年的标准普尔500数据和每日频率数据。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/b4db8f358c03c42982eed66eaf6367c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gxqLSsrXr5eS1d_uB-pEQ.png"/></div></div></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/caf239fb5df8c57e29ca7f2a66310c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*ow5t__E88PkW6dK45xAe2A.png"/></div></figure><p id="1c78" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">因为我们的数据已经预处理，似乎没有空数据和数据类型也是必要的。所以让我们抓紧时间处理吧！</p><p id="f46f" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">我们绘制了6年的股票价格和这些年的交易量。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/a2343653b477005c0305ce18bf6d9f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NeOtF6O0xMkmTVYzkXCICw.png"/></div></div></figure><p id="917f" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">现在，在完成初始设置后，开始和<a class="ae lc" href="https://facebook.github.io/prophet/docs/quick_start.html" rel="noopener ugc nofollow" target="_blank">先知</a>一起进入这个演示的小树林。</p><p id="f450" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">如前所述，Prophet是由脸书研究小组开发的用于时间序列预测的库。Prophet可以很好地处理受季节性影响很大的数据集，如在线销售数据、企业销售数据、旅行数据、企业许可证数据等。)Python开发人员可以很容易地联系到这个库，因为它使用Scikit-Learn的API(类似于Scikit-Learn)。</p><p id="aa21" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">在我们将数据提供给预言家进行预测之前，需要什么样的预处理步骤？</p><ol class=""><li id="7fc6" class="mh mi hi ju b jv kq jz kr kd mj kh mk kl ml kp mm mn mo mp bi translated">确保您将<em class="kv"> y </em>的收盘<strong class="ju hj">价格</strong>(我们将对此价格进行预测)和<em class="kv"> ds </em>的<strong class="ju hj">日期</strong>替换。</li><li id="1767" class="mh mi hi ju b jv mq jz mr kd ms kh mt kl mu kp mm mn mo mp bi translated">将数据框与Prophet进行拟合，以便检测未来模式。</li><li id="9317" class="mh mi hi ju b jv mq jz mr kd ms kh mt kl mu kp mm mn mo mp bi translated">用日线频率预测收盘价的上(高)价和下(低)价。</li></ol><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/f7673bbb34fb640877991b865233f769.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lO4tKtHHpx_01U_g-pReHA.png"/></div></div></figure><p id="9e15" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">就这样，预测完成，未来365天的预测数据准备就绪。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/f0af63be3120fca6c4db5196d15cd827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*U7ldFoHrUQU7zmGjULag5A.png"/></div></figure><p id="8075" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">让我们把它画出来，研究数据的季节性，看看我们是否能找到什么。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/fa63cbffb19bd8244ede1d5c1b75d2d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KXCdKloAB9zGGfkaqRGjw.png"/></div></div></figure><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/6b3e253d729e86501490d6c54db1c931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Rv7ka6f-SdidZIlRIuw0g.png"/></div></div></figure><p id="44a0" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">从上面的图表中，我们可以了解以下趋势:</p><ol class=""><li id="7cd5" class="mh mi hi ju b jv kq jz kr kd mj kh mk kl ml kp mm mn mo mp bi translated">尽管今年早些时候有所下跌，但标准普尔500显示出了明年上涨的迹象，最高可达3500美元，约有10%的增长！</li><li id="3ab3" class="mh mi hi ju b jv mq jz mr kd ms kh mt kl mu kp mm mn mo mp bi translated">标准普尔500股票价格没有每周的季节性。</li><li id="3d63" class="mh mi hi ju b jv mq jz mr kd ms kh mt kl mu kp mm mn mo mp bi translated">根据年度季节性，它显示在一年的第一季度有所下降，然后在年中恢复。如果你仔细看过去6年的股价图表，那么你会注意到在2016年、2018年甚至2020年的3月至4月期间出现了下跌(但COVID危机使下跌幅度更大)。</li></ol><h1 id="61ac" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">金融概念:(高开低走)和移动平均线</h1><h2 id="07c8" class="mz iv hi bd iw na nb nc ja nd ne nf je kd ng nh ji kh ni nj jm kl nk nl jq nm bi translated">什么是OHLC和烛台？</h2><p id="116d" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">下面的蜡烛线显示了每个时间段的开盘价、最高价、最低价和收盘价。蜡烛的颜色取决于它是看涨(向上)还是看跌(向下)。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nn"><img src="../Images/db75d9a8bf6714b0099ba193a5964e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iVmYB92ZRYwzap4BshUMPA.png"/></div></div></figure><h2 id="9856" class="mz iv hi bd iw na nb nc ja nd ne nf je kd ng nh ji kh ni nj jm kl nk nl jq nm bi translated">什么是移动平均线，它与市场中的买卖有什么关系？</h2><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es no"><img src="../Images/3a2ed2874372b3e6c3b451b116ece921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*oLr6SwhbY_pyUx3AklikiQ.png"/></div></figure><p id="afb9" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">我用<a class="ae lc" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank">和</a>的股票价格数据来演示标准普尔500指数的移动平均线。这是Google Collab上<a class="ae lc" href="https://colab.research.google.com/drive/1KzInwyC7ykvWZkcP6QktPYOEKUPXxQXE?usp=sharing" rel="noopener ugc nofollow" target="_blank">完整笔记本</a>的链接。此外，这是<a class="ae lc" href="https://github.com/meghshah09/SP-500-Stock-Price-Forecasting" rel="noopener ugc nofollow" target="_blank"> github </a>上回购的链接</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es np"><img src="../Images/a27df8402a37398272f80c61fb4281eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmlxt0NT6qvqjT_UQLuuSw.png"/></div></div></figure><h1 id="29e0" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结论</h1><p id="b1f2" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">本教程的唯一目的是浏览脸书的先知图书馆，这对预测高质量的数据非常有帮助。此外，我还想展示Plotly包，以及如何使用它来开发高质量的图表，不仅可以在笔记本上使用，还可以轻松地部署在Web应用程序中。</p><p id="dceb" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">参考资料:</p><ol class=""><li id="e1c3" class="mh mi hi ju b jv kq jz kr kd mj kh mk kl ml kp mm mn mo mp bi translated"><a class="ae lc" href="https://www.kaggle.com/janiobachmann/s-p-500-time-series-forecasting-with-prophet" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/janiobachmann/s-p-500-time-series-forecast-with-prophet</a></li><li id="ce04" class="mh mi hi ju b jv mq jz mr kd ms kh mt kl mu kp mm mn mo mp bi translated"><a class="ae lc" href="https://facebook.github.io/prophet/docs/quick_start.html" rel="noopener ugc nofollow" target="_blank">https://facebook.github.io/prophet/docs/quick_start.html</a></li><li id="2412" class="mh mi hi ju b jv mq jz mr kd ms kh mt kl mu kp mm mn mo mp bi translated"><a class="ae lc" href="https://research.fb.com/prophet-forecasting-at-scale/" rel="noopener ugc nofollow" target="_blank">https://research.fb.com/prophet-forecasting-at-scale/</a></li><li id="f14a" class="mh mi hi ju b jv mq jz mr kd ms kh mt kl mu kp mm mn mo mp bi translated"><a class="ae lc" href="https://finance.yahoo.com/quote/%5EGSPC/history" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/quote/%5EGSPC/history</a></li></ol></div></div>    
</body>
</html>