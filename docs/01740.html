<html>
<head>
<title>Transfer learning with MONK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">跟和尚转移学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/expediting-transfer-learning-the-monks-way-422d7ec40ec6?source=collection_archive---------19-----------------------#2019-11-11">https://medium.com/analytics-vidhya/expediting-transfer-learning-the-monks-way-422d7ec40ec6?source=collection_archive---------19-----------------------#2019-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7bc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">介绍MONK:一个<strong class="ih hj">开源低代码</strong>迁移学习工具包，作为深度学习框架的统一包装器</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a178c529db10eb9a1b4e5c7c9c622577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clv3bSjmChTG7AbPOOiyXQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">MONK工具功能</figcaption></figure><p id="6aaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">网址:【https://monkai-42.firebaseapp.com/ T2】T3</p><p id="08a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">github:【https://github.com/Tessellate-Imaging/monk_v1 T4】</p><h2 id="eaaa" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">迁移学习</h2><p id="7083" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">迁移学习是训练计算机视觉模型中最常用的技术之一。简单地说，一个已经训练好的模型被挑选出来，并为一个不同的用例重新训练。</p><h2 id="edcd" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">涉及的关键步骤是</h2><ol class=""><li id="f07f" class="ku kv hi ih b ii kp im kq iq kw iu kx iy ky jc kz la lb lc bi translated">数据摄取</li><li id="fa70" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">型号选择</li><li id="1f83" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">设置参数</li><li id="e4b2" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">培养</li><li id="8284" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">评估结果</li><li id="011c" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">将结果与之前的培训课程进行比较</li><li id="7274" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">改变参数并重新训练，直到我们找到最适合的模型</li><li id="63da" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">……重复相同的操作</li></ol><p id="017a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">让我们比较一下传统方式和僧侣方式的步骤</strong></p><h1 id="5c5f" class="li jv hi bd jw lj lk ll ka lm ln lo ke lp lq lr kh ls lt lu kk lv lw lx kn ly bi translated">1.编写更少的代码来开始原型制作过程</h1><p id="2e11" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">为了解决迁移学习的问题，通常会使用像keras、pytorch或mxnet这样的框架</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/de3d62bcb24c206b0d1e34c98bcff4ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qcjk2NjfBaECHWR52AjWsg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用pytorch迁移学习—Ref:<a class="ae jt" href="https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html" rel="noopener ugc nofollow" target="_blank">https://py torch . org/tutorials/beginner/transfer _ learning _ tutorial . html</a></figcaption></figure><p id="ce75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">传统方式:</strong>转移学习的第一步是<em class="ma">理解pytorch </em>并编写<em class="ma">这许多行代码！！！！</em></p><h2 id="6abf" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">修道士的方式:从5行代码开始，而不是40行——使用修道士的快速模式</h2><pre class="je jf jg jh fd mb mc md me aw mf bi"><span id="fac1" class="ju jv hi mc b fi mg mh l mi mj">from monk.pytorch_prototype import prototype</span><span id="fe82" class="ju jv hi mc b fi mk mh l mi mj">gtf = prototype(verbose=1);</span><span id="b1a1" class="ju jv hi mc b fi mk mh l mi mj">gtf.Prototype("Project-1", "Experiment-1");</span><span id="2622" class="ju jv hi mc b fi mk mh l mi mj">gtf.Default(dataset_path="train",model_name="resnet18_v1",<br/>           num_epochs=10);</span><span id="2bee" class="ju jv hi mc b fi mk mh l mi mj">gtf.Train();</span></pre><h1 id="6385" class="li jv hi bd jw lj lk ll ka lm ln lo ke lp lq lr kh ls lt lu kk lv lw lx kn ly bi translated">2.无缝切换后端框架</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/794e9180f3e99aab1039bb6b0b10cc7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IjdzO1Dmjz0cS_ockeAaZA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用keras转移学习—Ref:<a class="ae jt" rel="noopener" href="/@14prakash/transfer-learning-using-keras-d804b2e04ef8">https://medium . com/@ 14 Prakash/transfer-learning-using-keras-d 804 b 2e 04 ef 8</a></figcaption></figure><p id="73e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">传统方式:</strong>学习keras，再次编写多行代码。</p><h2 id="d9ed" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">Monk方式:从Monk导入Keras实用程序并编写相同的代码</h2><pre class="je jf jg jh fd mb mc md me aw mf bi"><span id="856f" class="ju jv hi mc b fi mg mh l mi mj">from monk.<strong class="mc hj">keras</strong>_prototype import prototype</span><span id="796b" class="ju jv hi mc b fi mk mh l mi mj">gtf = prototype(verbose=1);</span><span id="6fde" class="ju jv hi mc b fi mk mh l mi mj">gtf.Prototype("Project-1", "Experiment-1");</span><span id="0e8e" class="ju jv hi mc b fi mk mh l mi mj">gtf.Default(dataset_path="train",model_name="resnet18_v1",<br/>           num_epochs=10);</span><span id="2849" class="ju jv hi mc b fi mk mh l mi mj">gtf.Train()</span></pre><p id="f9c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Monk在一定的抽象层次上是语法不变的。</p><p id="fb59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，有人可能会问，仅仅这5行代码就让我失去了操作参数的能力</p><h1 id="c825" class="li jv hi bd jw lj lk ll ka lm ln lo ke lp lq lr kh ls lt lu kk lv lw lx kn ly bi translated">3.以标准化的方式操作参数</h1><p id="8cd6" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">以快速模式加载您的实验，并在每个阶段更改参数</p><p id="9337" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据集更新</strong></p><pre class="je jf jg jh fd mb mc md me aw mf bi"><span id="8c67" class="ju jv hi mc b fi mg mh l mi mj">gtf.update_input_size(256); - Change input shape</span><span id="fa22" class="ju jv hi mc b fi mk mh l mi mj">gtf.update_trainval_split(0.6); - Change splits</span></pre><p id="f7fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有更多…..</p><p id="75fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">型号更新</strong></p><pre class="je jf jg jh fd mb mc md me aw mf bi"><span id="dc6c" class="ju jv hi mc b fi mg mh l mi mj">ptf.update_freeze_layers(10); - freeze layers</span><span id="46c3" class="ju jv hi mc b fi mk mh l mi mj">ptf.append_linear(final_layer=True); - append layers</span></pre><p id="102b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有更多。</p><p id="9331" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查看和尚的更新模式</strong>—<a class="ae jt" href="https://clever-noyce-f9d43f.netlify.com/#/update_mode/update_dataset" rel="noopener ugc nofollow" target="_blank">https://clever-noy ce-f9d 43 f . net lify . com/#/Update _ Mode/Update _ layers</a></p><p id="7aad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查看和尚的专家模式</strong>——【https://clever-noyce-f9d43f.netlify.com/#/expert_mode T2】</p><h1 id="6f3d" class="li jv hi bd jw lj lk ll ka lm ln lo ke lp lq lr kh ls lt lu kk lv lw lx kn ly bi translated">4.比较使用Monk执行的所有实验</h1><p id="0801" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated"><strong class="ih hj">传统的方法:</strong>编写额外的代码来创建比较，并对训练代码进行大量的修改，以便生成这些度量。</p><p id="78e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">修道士之道</strong>:如果我想检查哪个优化器最适合我的训练(一旦这些实验经过训练)</p><pre class="je jf jg jh fd mb mc md me aw mf bi"><span id="3845" class="ju jv hi mc b fi mg mh l mi mj">ctf = compare(verbose=1);<br/>ctf.Comparison("Sample-Comparison-1")</span><span id="6738" class="ju jv hi mc b fi mk mh l mi mj"># Step 1 - Add experiments<br/>ctf.Add_Experiment("Project-Testing-Optimizers", "SGD");<br/>ctf.Add_Experiment("Project-Testing-Optimizers", "ADAM");<br/>ctf.Add_Experiment("Project-Testing-Optimizers", "ADAGRAD");<br/>ctf.Add_Experiment("Project-Testing-Optimizers", "NAG");<br/>ctf.Add_Experiment("Project-Testing-Optimizers", "NADAM");<br/>ctf.Add_Experiment("Project-Testing-Optimizers", "ADAMAX");</span><span id="f164" class="ju jv hi mc b fi mk mh l mi mj"># Step 2 - Compare<br/>ctf.Generate_Statistics();</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/d54d1bdb5f38d02ddaaf5a712b4db501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7BicvQ_zm8ffAsL2zOKfw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">比较多个实验的训练准确度</figcaption></figure><h1 id="bf48" class="li jv hi bd jw lj lk ll ka lm ln lo ke lp lq lr kh ls lt lu kk lv lw lx kn ly bi translated">5.使用Monk的其他好处</h1><ol class=""><li id="2159" class="ku kv hi ih b ii kp im kq iq kw iu kx iy ky jc kz la lb lc bi translated"><strong class="ih hj">从上一个时期中断时，恢复训练课程</strong></li><li id="10e6" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">运行<strong class="ih hj">实验数据分析— </strong>发现类别不平衡、缺失数据、损坏数据</li><li id="87f3" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">将实验</strong>从一个系统复制到另一个系统，无论是本地系统还是云系统</li><li id="67fc" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">估计实际运行前的训练次数</strong></li></ol><p id="4170" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请在这里试用该工具并注册社区和论坛:<a class="ae jt" href="https://monkai-42.firebaseapp.com/" rel="noopener ugc nofollow" target="_blank">https://monkai-42.firebaseapp.com/</a></p><p id="5564" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请在评论中告诉我们你的想法。</p><p id="aed5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">即将发布的故事:使用MONK的教程</p><p id="27ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编码快乐！！！</p></div></div>    
</body>
</html>