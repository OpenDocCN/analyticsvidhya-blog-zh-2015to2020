<html>
<head>
<title>Deploying Streamlit and OpenCV based web application to Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将基于 Streamlit 和 OpenCV 的 web 应用程序部署到 Heroku</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploying-a-streamlit-and-opencv-based-web-application-to-heroku-456691d28c41?source=collection_archive---------4-----------------------#2020-08-24">https://medium.com/analytics-vidhya/deploying-a-streamlit-and-opencv-based-web-application-to-heroku-456691d28c41?source=collection_archive---------4-----------------------#2020-08-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f0b6" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何使用 OpenCV 将 web 应用程序正确部署到 Heroku</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/c54a4fa28f22ac43f254755127b4a695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HkeRpm_zNbMywBES"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jn" href="https://unsplash.com/@v2osk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> v2osk </a>拍摄的照片</figcaption></figure><p id="3c08" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本文将带您通过使用 python、opencv 和 streamlit 构建一个简单的 web 应用程序，并将其部署到 heroku 平台。我写这篇文章是因为在使用 opencv 将应用程序部署到 heroku 时存在一些技术问题。因此，尽管使用了 opencv，本文还是会清晰地引导您将应用程序部署到 heroku。</p><h2 id="31de" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">本文分为两个部分。</h2><blockquote class="lf lg lh"><p id="7235" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated">1.使用 streamlit 创建 web 应用程序。</p><p id="b874" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated">2.将 web 应用程序部署到 heroku。</p></blockquote></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h1 id="559e" class="lt kl hi bd km lu lv lw kq lx ly lz ku io ma ip kx ir mb is la iu mc iv ld md bi translated">第 1 部分:创建基本的 web 应用程序</h1><blockquote class="lf lg lh"><p id="64d6" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated">在这一部分中，我将快速让您使用 opencv 和 streamlit 启动并运行一个简单的 web 应用程序，它可以将任何上传的图像转换为灰度图像。我选择了一个相当简单的应用程序来快速演示如何使用 opencv 向 heroku 正确部署应用程序，完全相同的过程也可以用于任何其他高级 web 应用程序<strong class="jq hj">。</strong></p></blockquote><h2 id="e2c4" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated"><strong class="ak">流线型</strong></h2><p id="fe2b" class="pw-post-body-paragraph jo jp hi jq b jr me ij jt ju mf im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated">Streamlit 让你用看似简单的 Python 脚本为你的机器学习项目创建应用。它非常快速，直观，非常非常容易理解。</p><p id="91f5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本文假设读者非常熟悉 streamlit 的基础知识，我将在这里重点介绍如何快速构建一个 streamlit 应用程序。如果有人需要复习 streamlit，可以参考以下资源:</p><div class="mj mk ez fb ml mm"><a href="https://docs.streamlit.io/en/stable/" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">欢迎使用 Streamlit - Streamlit 0.63.1 文档</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">要使用它，只需导入它，写几行代码，然后用。Streamlit 监视…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">docs.streamlit.io</p></div></div><div class="mv l"><div class="mw l mx my mz mv na jh mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://www.coursera.org/projects/data-science-streamlit-python" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">使用 Streamlit 和 Python 构建数据科学 Web 应用程序</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">由 Coursera 项目网提供。欢迎参加这个动手项目，用…构建您的第一个数据科学 web 应用程序</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">www.coursera.org</p></div></div><div class="mv l"><div class="nb l mx my mz mv na jh mm"/></div></div></a></div><p id="0ad2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我将通过 5 个简单易行的步骤快速介绍一个简单 web 应用程序的开发部分。</p><ol class=""><li id="96a9" class="nc nd hi jq b jr js ju jv jx ne kb nf kf ng kj nh ni nj nk bi translated">进行必要的进口。</li></ol><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="b3a9" class="kk kl hi nm b fi nq nr l ns nt">import cv2<br/>import streamlit as st<br/>import numpy as np</span></pre><p id="af65" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 2。向 web 应用程序添加标题和降价。</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="005a" class="kk kl hi nm b fi nq nr l ns nt">st.title("First Streamlit Web Application")<br/>st.markdown("This simple web application renders \<br/>the uploaded images into grayscale mode.")</span></pre><p id="5b69" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 3。添加侧边栏并为其添加标题。(可选)</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="c41d" class="kk kl hi nm b fi nq nr l ns nt">st.sidebar.title("First Streamlit Web Application")<br/>st.sidebar.markdown("This simple web application renders \<br/>the uploaded images into grayscale mode.")</span></pre><p id="dfd9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 4。在侧边栏上创建一个文件上传器部件。</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="d5a0" class="kk kl hi nm b fi nq nr l ns nt">uploaded_file=st.sidebar.file_uploader(label="Upload Image",\<br/>type=["jpg","jpeg","png"],key="i")</span></pre><p id="b74d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 5。打开上传的图像，将其转换为灰度并呈现在 web 应用程序上。</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="f784" class="kk kl hi nm b fi nq nr l ns nt">if uploaded_file is not None:<br/>    file_bytes = np.asarray(bytearray(uploaded_file.read()),\<br/>    dtype=np.uint8)<br/>    image = cv2.imdecode(file_bytes, 1)<br/>    st.subheader("Grayscale Image")<br/>    st.image(image=cv2.cvtColor(image,cv2.COLOR_RGB2GRAY),width=400)</span></pre><p id="7beb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，使用合适的文件名快速保存该文件，比如“app.py ”,并在本地浏览器上运行它，切换到包含该文件的目录并运行命令:</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="7b15" class="kk kl hi nm b fi nq nr l ns nt">streamlit run app.py</span></pre><p id="6590" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果出现关于禁止访问套接字的错误，那么只需显式指定任何更高的端口号，比如 8502 或 5000。</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="08c5" class="kk kl hi nm b fi nq nr l ns nt">streamlit run app.py --server.port 8502</span></pre><p id="29ad" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这就创建了一个可以在本地机器上完美运行的基本 web 应用程序，现在它必须被部署到 heroku。</p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h1 id="6880" class="lt kl hi bd km lu lv lw kq lx ly lz ku io ma ip kx ir mb is la iu mc iv ld md bi translated">第 2 部分:将应用程序部署到 heroku</h1><blockquote class="lf lg lh"><p id="60ed" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated">在这一部分中，我将带您一步步完成将应用程序部署到 heroku 的过程。</p></blockquote><p id="521e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Heroku 是一个平台即服务(PaaS)，使开发人员能够完全在云中构建、运行和操作应用程序，并支持多种语言，如 Java、Node.js、Scala、Clojure、Python、PHP 和 Go。</p><p id="6f8a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">部署部分可以分为以下 3 个步骤:</strong></p><ul class=""><li id="6ce2" class="nc nd hi jq b jr js ju jv jx ne kb nf kf ng kj nu ni nj nk bi translated"><strong class="jq hj">在 heroku 上创建一个应用程序并安装 buildpacks。</strong></li><li id="9b38" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated"><strong class="jq hj">设置部署所需的文件</strong></li><li id="5bd6" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated"><strong class="jq hj">将应用推送到 heroku。</strong></li></ul><h2 id="0dd8" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">步骤 1:在 heroku 上创建一个应用程序，并设置 buildpacks。</h2><ol class=""><li id="074e" class="nc nd hi jq b jr me ju mf jx oa kb ob kf oc kj nh ni nj nk bi translated">在 heroku 上创建一个帐户并登录。</li></ol><div class="mj mk ez fb ml mm"><a href="https://www.heroku.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">云应用平台| Heroku</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">无论您是在构建简单的原型还是关键业务产品，Heroku 的全托管平台都能为您提供…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">www.heroku.com</p></div></div><div class="mv l"><div class="od l mx my mz mv na jh mm"/></div></div></a></div><p id="1aac" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 2。创建一个新的应用程序，并为该应用程序选择一个合适的名称和位置。</strong></p><blockquote class="lf lg lh"><p id="a0d8" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated"><strong class="jq hj">注意:</strong>如果您希望将应用程序放在您的个人资料中，请尝试为您的应用程序指定一个有意义的名称，因为应用程序名称将是最终部署的应用程序的 URL 的一部分。</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/7f32a2a1046e656fee18f128d5a00496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nrpUiS8_kWZj_B5YM5CfqQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">在 heroku 创建新的应用程序。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/9a0dbb402bc4cdc219bfd4df8c0ec2f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pO6pLq9s8jTT2QsHv-2k1w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">给应用程序起一个合适的名字并创建应用程序。</figcaption></figure><p id="c506" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 3。添加构建包</strong></p><p id="07cc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Heroku Buildpacks 是一组开源脚本，用于在 Heroku 上编译应用程序。它们构成了 Heroku 多语言平台的主干。构建包使您能够扩展 Heroku 的构建系统，以支持您的语言或定制，或者使特定的二进制包可用于运行时。</p><p id="50b2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有关构建包的更多信息，请参考:</p><div class="mj mk ez fb ml mm"><a href="https://devcenter.heroku.com/articles/buildpacks" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">构建包</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">Buildpacks 负责将部署的代码转换成 slug，然后可以在 dyno 上执行。构建包…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">devcenter.heroku.com</p></div></div><div class="mv l"><div class="of l mx my mz mv na jh mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://www.heroku.com/elements/buildpacks" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">Heroku Buildpacks | Heroku</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">Heroku Buildpacks 是一组开源脚本，用于在 Heroku 上编译应用程序。他们构成了…的支柱</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">www.heroku.com</p></div></div><div class="mv l"><div class="og l mx my mz mv na jh mm"/></div></div></a></div><p id="e31c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">转到新创建的 heroku 应用程序的设置菜单，向下滚动到添加 Buildpack 选项，将 build pack 添加到您的应用程序中。对于这个应用程序，我将添加两个 buildpack，第一个是官方支持的，第二个是第三方 build pack。</p><ul class=""><li id="f2b2" class="nc nd hi jq b jr js ju jv jx ne kb nf kf ng kj nu ni nj nk bi translated"><strong class="jq hj"> heroku/python </strong></li><li id="ed27" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated"><a class="ae jn" href="https://github.com/heroku/heroku-buildpack-apt" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj">https://github.com/heroku/heroku-buildpack-apt</strong></a></li></ul><p id="735f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第二个构建包使我们能够正确安装 opencv 的附加依赖项。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/f03f999d329acb6a506893c19487576b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xLvXYdg9c12xydzsKVgBXw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">添加构建包。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/d000c76f6fc9dfd8fcb318d1e17eb6ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ux9YBZjU5GBp4BbAxNztrw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">选择 python buildpack，然后单击保存更改。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/97ffbce6974c0e5539f5e2ce11668d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vKHo2c7PDylqpk9yXU902w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">添加 buildpack URL 并单击 Save changes。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/7f022a53d480c21558ef3ebae49f6a74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKdX1FrZKTzu04TNthnCGg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">最后，应用程序应该包含这两个构建包。</figcaption></figure><h2 id="bfcd" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">步骤 2:设置部署所需的文件</h2><p id="2c01" class="pw-post-body-paragraph jo jp hi jq b jr me ij jt ju mf im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated">应用程序的主目录中应该包含以下文件以及 python 代码。</p><p id="1548" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">应该注意遵循这些文件的确切命名约定，如下所示。</p><ol class=""><li id="17d1" class="nc nd hi jq b jr js ju jv jx ne kb nf kf ng kj nh ni nj nk bi translated"><strong class="jq hj"> requirements.txt </strong></li></ol><p id="2ca9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该文件列出了所有需要的 python 库及其特定版本，以便在 heroku 平台上轻松安装所有依赖项。对于这个应用程序，文件应该如下所示:</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="f6c0" class="kk kl hi nm b fi nq nr l ns nt">numpy==1.18.5<br/>streamlit==0.61.0<br/>opencv-python==4.2.0.34</span></pre><p id="9952" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">通过创建 requirements.txt 文件，可以使用以下命令一次性轻松安装所有依赖项:</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="0cb5" class="kk kl hi nm b fi nq nr l ns nt">pip install -r requirements.txt</span></pre><p id="0ef4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 2。setup.sh </strong></p><p id="b970" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">就像 requirements.txt 一样，这个文件帮助设置所需的环境，以便在 heroku 环境上正确运行应用程序。对于使用 streamlit 的应用程序，该文件的内容可以保持原样，不需要修改。</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="5b2d" class="kk kl hi nm b fi nq nr l ns nt">mkdir -p ~/.streamlit/</span><span id="47a3" class="kk kl hi nm b fi oh nr l ns nt">echo "\<br/>[server]\n\<br/>headless = true\n\<br/>port = $PORT\n\<br/>enableCORS = false\n\<br/>\n\<br/>" &gt; ~/.streamlit/config.toml</span></pre><p id="68cb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 3。过程文件</strong></p><blockquote class="lf lg lh"><p id="6ec9" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated"><strong class="jq hj">注意:</strong>这个文件应该被命名为“Procfile ”,并且不应该有任何扩展名。文本文件（textfile）</p></blockquote><p id="2081" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Procfile 包含启动应用程序要执行的命令。内容如下:</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="7108" class="kk kl hi nm b fi nq nr l ns nt">web: sh setup.sh &amp;&amp; streamlit run app.py</span></pre><p id="e232" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">文件的内容有两部分。</p><p id="e950" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第一部分声明一个进程类型<code class="du oi oj ok nm b">web</code>，以及运行它所需的命令，第二部分包含运行应用程序的命令。</p><blockquote class="lf lg lh"><p id="62b4" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated">注意:确保在这里输入正确的 python 程序名和扩展名。巴拉圭</p></blockquote><p id="3188" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 4。Aptfile </strong></p><blockquote class="lf lg lh"><p id="59b4" class="jo jp li jq b jr js ij jt ju jv im jw lj jy jz ka lk kc kd ke ll kg kh ki kj hb bi translated"><strong class="jq hj">注意:</strong>该文件应命名为“Aptfile ”,并且不应有任何扩展名。文本文件（textfile）</p></blockquote><p id="3404" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这个文件在部署到 heroku 时是可选的，只有当要部署的应用程序使用 opencv 时才需要。这是必需的，因为 opencv 有一些额外的依赖项，这些依赖项默认情况下不会安装在 heroku 上，需要手动安装。这些依赖项可以通过使用 linux 命令<strong class="jq hj"> sudo apt get install </strong>或<strong class="jq hj"> sudo apt install 来安装。</strong>因此，一个附加的 Aptfile(包含这些依赖项的名称)对此有所帮助，它告诉 heroku 使用创建 app 时添加的 apt buildpack 来安装这些依赖项。</p><p id="539e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是将在 Aptfile 中列出的依赖项:</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="4de3" class="kk kl hi nm b fi nq nr l ns nt">libsm6<br/>libxrender1<br/>libfontconfig1<br/>libice6</span></pre><p id="0fa0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 5。runtime.txt </strong></p><p id="ca66" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该文件包含您希望安装在 heroku 平台上的特定 python 版本。它是完全可选的，因为通常 python 版本之间没有太大的区别。</p><p id="6ed2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果有人希望使用它，那么可以指定一个特定的 python 版本，如下所示:</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="2736" class="kk kl hi nm b fi nq nr l ns nt">python-3.6.8</span></pre><p id="0b44" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后，主应用程序目录应该包含以下文件:</p><ul class=""><li id="c2f0" class="nc nd hi jq b jr js ju jv jx ne kb nf kf ng kj nu ni nj nk bi translated">app.py(主 python 文件和其他必需文件)</li><li id="d6e4" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated">requirements.txt</li><li id="eae8" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated">setup.sh</li><li id="1cad" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated">Procfile</li><li id="036a" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated">Aptfile(仅当使用 opencv 时)</li><li id="1411" class="nc nd hi jq b jr nv ju nw jx nx kb ny kf nz kj nu ni nj nk bi translated">runtime.txt(可选)</li></ul><p id="d355" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第三步:将应用程序推送到 heroku。</p><ol class=""><li id="a02a" class="nc nd hi jq b jr js ju jv jx ne kb nf kf ng kj nh ni nj nk bi translated"><strong class="jq hj">装置</strong></li></ol><p id="7b7a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了执行接下来的步骤，应该在本地机器上安装 heroku CLI 工具和 Git。请参考以下资源来安装它们。</p><div class="mj mk ez fb ml mm"><a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">Git -安装 Git</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">在开始使用 Git 之前，您必须让它在您的计算机上可用。即使已经安装了，也是…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">git-scm.com</p></div></div><div class="mv l"><div class="ol l mx my mz mv na jh mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">Heroku CLI</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">Heroku 命令行界面(CLI)使得直接从终端创建和管理您的 Heroku 应用程序变得非常容易…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">devcenter.heroku.com</p></div></div><div class="mv l"><div class="om l mx my mz mv na jh mm"/></div></div></a></div><p id="ea33" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 2。将文件夹初始化为 git 存储库。</strong></p><p id="a5b9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这可以通过终端执行以下命令来完成。</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="e764" class="kk kl hi nm b fi nq nr l ns nt">git init</span></pre><p id="7d2c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 3。登录 Heroku </strong></p><p id="895d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">执行以下命令，并根据提示登录 heroku。</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="4764" class="kk kl hi nm b fi nq nr l ns nt">heroku login</span></pre><p id="520b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 4。将 heroku 应用程序配置为用于推送文件的远程存储库。</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="7a71" class="kk kl hi nm b fi nq nr l ns nt">heroku git:remote -a &lt;your app name&gt;</span></pre><p id="5ff2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于这个应用程序，在 heroku 中创建的应用程序的名称是<strong class="jq hj"> streamlit-opencv-demo。</strong>所以<strong class="jq hj"> </strong>命令应该是这样的:</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="c4dc" class="kk kl hi nm b fi nq nr l ns nt">heroku git:remote -a streamlit-opencv-demo</span></pre><p id="7eb9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 5。将代码提交到存储库。</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="2c3a" class="kk kl hi nm b fi nq nr l ns nt">git add .<br/>git commit -am "commit message"</span></pre><p id="55e5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 6。将代码部署到 heroku。</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="5489" class="kk kl hi nm b fi nq nr l ns nt">git push heroku master</span></pre><p id="11cf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这将开始安装所有依赖项并创建环境，然后部署应用程序。查看此步骤中生成的日志以了解部署过程中发生的事情总是很有趣的。</p><p id="9756" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> 7。按比例增加 dynos，以确保应用程序的平稳运行。</strong></p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="9493" class="kk kl hi nm b fi nq nr l ns nt">heroku ps:scale web=1</span></pre><p id="06cf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有关 dynos 的更多信息，请参考以下链接:</p><div class="mj mk ez fb ml mm"><a href="https://www.heroku.com/dynos" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">赫罗库·达诺斯</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">应用程序开发人员依靠软件抽象来简化开发和提高工作效率。说到跑步…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">www.heroku.com</p></div></div><div class="mv l"><div class="on l mx my mz mv na jh mm"/></div></div></a></div><p id="33d2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">8。打开应用程序。</p><pre class="iy iz ja jb fd nl nm nn no aw np bi"><span id="7ff7" class="kk kl hi nm b fi nq nr l ns nt">heroku open</span></pre><p id="1015" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这将在浏览器中打开应用程序，它应该如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/b2dff9c8671abc6a7500561e6663a785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNYE4wgVbQtrdcGZWNlodg.png"/></div></div></figure><p id="c2a0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该应用程序的完整代码以及所有其他文件都可以在 my github 上找到。</p><p id="68ab" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><a class="ae jn" href="https://github.com/RaviBansal7717/streamlit-opencv-demo" rel="noopener ugc nofollow" target="_blank">https://github.com/RaviBansal7717/streamlit-opencv-demo</a></p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h2 id="b21d" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated"><strong class="ak">参考文献:</strong></h2><div class="mj mk ez fb ml mm"><a href="https://devcenter.heroku.com/articles/getting-started-with-python" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">使用 Python 开始使用 Heroku</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">本教程将让你在几分钟内部署一个 Python 应用程序(一个简单的 Django 应用程序)。再坚持几分钟…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">devcenter.heroku.com</p></div></div><div class="mv l"><div class="oo l mx my mz mv na jh mm"/></div></div></a></div></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h2 id="ead9" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">这就对了。希望该应用程序应该运行正常，用户准备就绪。试着玩这个，也试着部署你自己的令人兴奋和有趣的应用程序。</h2></div></div>    
</body>
</html>