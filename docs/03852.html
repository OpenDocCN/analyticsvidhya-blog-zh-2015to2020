<html>
<head>
<title>Reporting Dashboard using Python Dash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python Dash报告仪表板</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/returns-pain-point-of-e-commerce-industry-a62c47819800?source=collection_archive---------14-----------------------#2020-02-22">https://medium.com/analytics-vidhya/returns-pain-point-of-e-commerce-industry-a62c47819800?source=collection_archive---------14-----------------------#2020-02-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/194dfe1651a9ea1566bd336818506854.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g6-IKFw1tfVzlOVQWdjRew.jpeg"/></div></div></figure><p id="97e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将带你快速地使用Python Dash来展示从ML模型中获得的实时结果。</p><p id="1a48" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Python Dash是基于Python框架的，用于构建漂亮的基于web的分析web应用程序。Dash基于Flask、Plotly.js和React.js编写，非常适合构建数据可视化应用程序和使用纯Python的高度定制用户界面报告仪表板。更多信息可以在Dash官方文档中找到。</p><p id="1125" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不谈背景背景，产品退货一直是电商企业的痛点。处理数据清理、EDA和预测建模非常重要，以清晰易读的形式向业务用户展示这些结果也非常重要。</p><p id="2834" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我曾经使用Python dash来呈现不同切割的预测回报数字，以便进行分析和商业决策。下面是我准备的中级Dash web应用程序的快照:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/960c7e3291c50b5cac716d75966ba934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FIX6urXUpNvDt_PqQ1B-qQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">快照是从中间步骤，有很多像下拉，用户界面改进等附加功能..</figcaption></figure><p id="a4f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jx translated"><span class="l jy jz ka bm kb kc kd ke kf di"> F </span> <strong class="is hj"> <em class="kg">功能性</em> </strong>:用户通过提供的链接打开Dash app，通过预定义的模板上传数值，存储在pickle中的ML训练模型在服务器上运行，结果通过Dash呈现给业务用户。</p><p id="309b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">跳到代码前面，导入必要的包后，我们需要初始化dash app。</p><pre class="jp jq jr js fd kh ki kj kk aw kl bi"><span id="d017" class="km kn hi ki b fi ko kp l kq kr">app = dash.Dash()</span></pre><p id="58a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后我们需要定义App布局。下面是标题文本对齐的初始代码片段:</p><pre class="jp jq jr js fd kh ki kj kk aw kl bi"><span id="17bc" class="km kn hi ki b fi ko kp l kq kr">app.layout = html.Div([<br/> html.Div([<br/> html.H1(<br/> children =’Dash application’, <br/> style = {<br/> ‘textAlign’: ‘left’,<br/> ‘color’: colors[‘text’],<br/> ‘display’: ‘inline-block’<br/> }<br/> ),<br/> ],<br/> style={‘width’: ‘25%’, ‘display’: ‘inline-block’}),</span></pre><p id="516c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我放了一个上传按钮，让用户通过预定义的模板上传值，这些值将输入pickle文件以运行模型。</p><pre class="jp jq jr js fd kh ki kj kk aw kl bi"><span id="3ce8" class="km kn hi ki b fi ko kp l kq kr">html.Div([<br/> dcc.Upload(<br/> id=’datatable-upload’,<br/> children=html.Div([ <br/> html.A(‘Upload File’) <br/> ]),<br/> style={<br/> ‘width’: ‘`00%’, ‘height’: ‘60px’, ‘lineHeight’: ‘60px’,<br/> ‘borderWidth’: ‘1px’, ‘borderStyle’: ‘dashed’, #customizing csv upload option<br/> ‘borderRadius’: ‘5px’, ‘textAlign’: ‘center’, ‘margin’: ‘10px’,<br/> <br/> },<br/> ),<br/> ],<br/> style={‘width’: ‘50%’, ‘display’: ‘inline-block’}),</span></pre><p id="ee3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还可以定制python函数，并在回调中调用它们。在我的dash应用程序中放置主表的回调函数。</p><pre class="jp jq jr js fd kh ki kj kk aw kl bi"><span id="beea" class="km kn hi ki b fi ko kp l kq kr"><a class="ae ks" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(Output(‘output-data-upload4’, ‘children’),<br/> [Input(‘datatable-upload’, ‘contents’)],<br/> [State(‘datatable-upload’, ‘filename’)])<br/>def update_output(contents,filename):<br/> if contents is not None:<br/> df_result = parse_contents(contents, filename)<br/> gf_new = df_result<br/> gf_new = gf_new.round(2)<br/> gf_new = gf_new.applymap(str)<br/> children = [html.Div([dash_table.DataTable(data=gf_new.to_dict(‘records’),columns=[{‘name’: i, ‘id’: i} for i in gf_new.columns],<br/> sorting=True,<br/> pagination_mode=”fe”,<br/> pagination_settings={<br/> “displayed_pages”: 1,<br/> “current_page”: 0,<br/> “page_size”: 10,<br/> },<br/> navigation=”page”,<br/> #style_cell={‘textAlign’: ‘left’}<br/> )])]<br/> return children</span></pre><p id="a668" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您还可以添加一些特色和定制，比如分页模式、pagination_settings、导航等。如果您可以通过HTML和CSS进行定制，Dash可以提供很多功能。</p><p id="283e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">也可以在回调中添加类似下载csv或Excel的按钮。</p><pre class="jp jq jr js fd kh ki kj kk aw kl bi"><span id="e089" class="km kn hi ki b fi ko kp l kq kr"><a class="ae ks" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(Output(‘download-link4’, ‘href’),<br/> [Input(‘datatable-upload’, ‘contents’)],<br/> [State(‘datatable-upload’, ‘filename’)])<br/>def update_output(contents,filename):<br/> if contents is not None:<br/> df_result = parse_contents(contents, filename)<br/> gf_new = df_result<br/> gf_new = gf_new.round(2)<br/> gf_new = gf_new.applymap(str)<br/> csv_string = gf_new.to_csv(index=False, encoding=’utf-8')<br/> csv_string = “data:text/csv;charset=utf-8,” + urllib.pathname2url(csv_string)<br/> return csv_string</span></pre><p id="d1a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您还可以添加预定义的自定义CSS模板以获得更好的用户界面:</p><pre class="jp jq jr js fd kh ki kj kk aw kl bi"><span id="af57" class="km kn hi ki b fi ko kp l kq kr">app.css.append_css({“external_url”: “<a class="ae ks" href="https://codepen.io/chriddyp/pen/bWLwgP.css" rel="noopener ugc nofollow" target="_blank">https://codepen.io/chriddyp/pen/bWLwgP.css</a>"}) #CSS Stylesheet-1</span><span id="f2cd" class="km kn hi ki b fi kt kp l kq kr">app.css.append_css({“external_url”: “<a class="ae ks" href="https://codepen.io/chriddyp/pen/brPBPO.css" rel="noopener ugc nofollow" target="_blank">https://codepen.io/chriddyp/pen/brPBPO.css</a>"}) #CSS Stylesheet-2</span></pre><p id="10b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后但同样重要的是，不要忘记将代码包装在Main函数中，以便在flask服务器上运行。</p><pre class="jp jq jr js fd kh ki kj kk aw kl bi"><span id="da0c" class="km kn hi ki b fi ko kp l kq kr">ap=app.server<br/>if __name__ == ‘__main__’:<br/> ap.run()</span></pre><p id="e188" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从部署的角度来看，你可以在AWS/Azure或任何VM或Heroku上部署你的应用。一旦部署了app，就可以使用Nohup.out(对于AWS)这样的命令来查看日志。您还可以在较大负载和多个用户的情况下调整其性能。</p><p id="ae46" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Dash拥有惊人而广泛的功能。我仍在学习过程中，以完全探索其能力。</p><p id="7a9c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是所有的乡亲。</p></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><blockquote class="lb lc ld"><p id="8416" class="iq ir kg is b it iu iv iw ix iy iz ja le jc jd je lf jg jh ji lg jk jl jm jn hb bi translated"><em class="hi">(免责声明:代码片段可能会有所不同，并且可能不会在快照中显示应用程序，因为两者是在不同的时间记录的)</em></p></blockquote></div></div>    
</body>
</html>