<html>
<head>
<title>How to add Users to Sudoers File in Ubuntu</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Ubuntu中将用户添加到Sudoers文件中</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-add-users-to-sudoers-file-in-ubuntu-e89c24b7369d?source=collection_archive---------0-----------------------#2020-02-04">https://medium.com/analytics-vidhya/how-to-add-users-to-sudoers-file-in-ubuntu-e89c24b7369d?source=collection_archive---------0-----------------------#2020-02-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9bc5c635d2193c7413c11b1bbbc5f98a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RibvTfkkPauPykifmLTrDA.png"/></div></div></figure><blockquote class="iq ir is"><p id="cc78" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">UDO是一个命令行程序，允许受信任的用户以root或其他用户的身份执行命令。</p></blockquote><p id="2d6d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated"><strong class="iw hj"> sudo </strong>允许您以不同用户的身份运行Unix命令。使用<strong class="iw hj"> /etc/sudoers </strong>文件来确认您可以使用哪些特权，该命令有效地提升了您的访问权限，从而允许您运行命令和访问文件，否则您将无法使用。</p><h2 id="e440" class="jv jw hi bd jx jy jz ka kb kc kd ke kf js kg kh ki jt kj kk kl ju km kn ko kp bi translated">sudo命令如何工作</h2><p id="da6d" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je js ks jh ji jt kt jl jm ju ku jp jq jr hb bi translated"><strong class="iw hj"> sudoers文件</strong>是一个文本<strong class="iw hj">文件</strong>，位于“/etc/ <strong class="iw hj"> sudoers </strong>”它控制sudo如何在你的机器上工作。您可能熟悉<strong class="iw hj"> sudo的</strong>主要角色，将您当前帐户的权限提升为root，即所有基于Unix的系统上的超级用户。</p><p id="814e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">真实有效的用户id (uid)和组id (gid)被设置为与<strong class="iw hj"> /etc/sudoers </strong>文件中指定的目标用户相匹配(更改该文件最安全的方法是使用<a class="ae kv" href="https://www.unixtutorial.org/commands/visudo" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> visudo命令</strong> </a> <strong class="iw hj"> </strong> —查看<a class="ae kv" href="https://www.unixtutorial.org/2007/12/visudo-tutorial/" rel="noopener ugc nofollow" target="_blank"> visudo教程</a>)。使用<strong class="iw hj"> sudo </strong>的方法非常简单:运行这个命令，并指定一个希望以不同用户的权限运行的命令行。在运行请求的命令之前，会要求您通过提供用户密码来确认您的身份。</p><p id="e3ce" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated"><strong class="iw hj"> sudoers文件</strong>位于/etc/ <strong class="iw hj"> sudoers </strong>中。并且不应该直接编辑，需要使用visudo命令。</p><h2 id="a09f" class="jv jw hi bd jx jy jz ka kb kc kd ke kf js kg kh ki jt kj kk kl ju km kn ko kp bi translated">维苏多</h2><p id="9f41" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je js ks jh ji jt kt jl jm ju ku jp jq jr hb bi translated">现在主要使用VISUDO文件在sudoers文件中添加用户。</p><p id="9641" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated"><a class="ae kv" href="https://www.unixtutorial.org/commands/visudo" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> visudo </strong> </a>是一个安全更新<strong class="iw hj"> /etc/sudoers </strong>文件的工具，在大多数Linux系统中都有(比如<a class="ae kv" href="http://www.ubuntu.com/" rel="noopener ugc nofollow" target="_blank"> Ubuntu </a>)。这是允许普通用户以超级用户权限运行命令所需的文件——使用<a class="ae kv" href="https://www.unixtutorial.org/commands/sudo/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> sudo命令</strong> </a>。</p><p id="c919" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">以下是Ubuntu手册页对此的描述，我认为这是一个很好的总结:</p><blockquote class="iq ir is"><p id="b22d" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="hi"> visudo </em> </strong> <em class="hi">以安全的方式编辑sudoers文件，类似于vipw。</em> <strong class="iw hj"> <em class="hi"> visudo </em> </strong> <em class="hi">锁定sudoers文件以防多个同时编辑，提供基本的健全性检查，并检查解析错误。如果当前正在编辑sudoers文件，您将会收到一条消息，提示您稍后再试。</em></p></blockquote><p id="11e4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated"><strong class="iw hj">注意</strong>:由于<strong class="iw hj"> /etc/sudoers </strong>文件的敏感内容，您只能以root身份运行<a class="ae kv" href="https://www.unixtutorial.org/commands/visudo" rel="noopener ugc nofollow" target="_blank"> visudo </a>。</p><h1 id="158a" class="kw jw hi bd jx kx ky kz kb la lb lc kf ld le lf ki lg lh li kl lj lk ll ko lm bi translated">使用visudo编辑/etc/sudoers</h1><p id="c61d" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je js ks jh ji jt kt jl jm ju ku jp jq jr hb bi translated">这是<a class="ae kv" href="https://www.unixtutorial.org/commands/visudo" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> visudo </strong>命令</a>的默认行为:只需不带任何参数运行它，它将在vi编辑器中打开/etc/sudoers文件的内容，允许您编辑它，然后应用更改。</p><p id="995b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">我强调应用更改的原因是因为<strong class="iw hj"> vi </strong>会话将不会编辑实际的/etc/sudoers文件，而是由<a class="ae kv" href="https://www.unixtutorial.org/commands/visudo" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> visudo </strong> </a>创建的临时副本。在您做出更改并退出<strong class="iw hj"> vi </strong>之后，<strong class="iw hj"> visudo </strong>将在替换实际的/etc/sudoers文件之前对该文件进行语法检查。</p><p id="5ac8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">提示:如果您使用的是不同的文本编辑器，您可以通过在shell中设置editor变量来轻松覆盖它，<a class="ae kv" href="https://www.unixtutorial.org/commands/visudo" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> visudo </strong> </a>足够智能，可以尊重它并使用指定的编辑器。</p><h1 id="f328" class="kw jw hi bd jx kx ky kz kb la lb lc kf ld le lf ki lg lh li kl lj lk ll ko lm bi translated">使用visudo检查/etc/sudoers语法</h1><p id="c7d9" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je js ks jh ji jt kt jl jm ju ku jp jq jr hb bi translated">有时你不想使用这个命令更新文件，但是想验证<strong class="iw hj"> /etc/sudoers </strong>的语法是否正确。这时，<a class="ae kv" href="https://www.unixtutorial.org/commands/visudo" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> visudo </strong> </a>的-c选项出现了:</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="f07e" class="jv jw hi ls b fi lw lx l ly lz">root@ubuntu:~$ visudo -c<br/>/etc/sudoers file parsed OK</span></pre><p id="eec9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">我们将使用visudo文件向该文件添加用户。</p><p id="6a6b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated"><strong class="iw hj"> visudo </strong>是Unix/Linux中用于安全更新/etc/sudoers文件的特殊工具，由<a class="ae kv" href="https://www.unixtutorial.org/commands/sudo/" rel="noopener ugc nofollow" target="_blank"> sudo命令</a>使用，用于提供和管理特权访问。</p><p id="aa13" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">为了安全地更新/etc/sudoers文件，可以在大多数Linux系统中找到(例如<a class="ae kv" href="http://www.ubuntu.com/" rel="noopener ugc nofollow" target="_blank"> Ubuntu </a>)。</p><p id="8414" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">由于<strong class="iw hj"> /etc/sudoers </strong>文件定义了特权访问的规则(有时是无密码的)，所以您只能以root身份运行visudo。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="8b18" class="jv jw hi ls b fi lw lx l ly lz">root@ubuntu:~$ <strong class="ls hj">/usr/sbin/visudo</strong><br/>visudo: /etc/sudoers: Permission denied</span></pre><h1 id="cbc9" class="kw jw hi bd jx kx ky kz kb la lb lc kf ld le lf ki lg lh li kl lj lk ll ko lm bi translated">visudo命令如何工作</h1><p id="1ebc" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je js ks jh ji jt kt jl jm ju ku jp jq jr hb bi translated">您不需要指定任何命令行选项。只需成为root用户并运行命令。您将看到默认的文本编辑器窗口，其中包含/etc/sudoers文件。</p><p id="605f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">只需运行以下命令:</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="5f7c" class="jv jw hi ls b fi lw lx l ly lz">root@ubuntu:~$ <strong class="ls hj">/usr/sbin/visudo</strong></span></pre><p id="5979" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">运行上面的命令后，你会得到下面的文件，在这里只添加用户。</p><p id="a5b4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">您可以看到“用户权限规范”，唯一的超级用户被添加到超级用户行，您可以添加许多与超级用户相同的用户。</p><p id="08b9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">比如:</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="ebcc" class="jv jw hi ls b fi lw lx l ly lz">root   ALL=(ALL:ALL) ALL<br/>farzana ALL=(ALL:ALL) ALL</span></pre><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/5233147376edab380521b81f4930b72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*qy-lKMrGXCwfApfDg_K5yA.png"/></div></div></figure><p id="8317" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">在visudo文件“ctlr+x”中添加用户并输入“y”后，它将保存visudo文件。现在你可以用Sudo了。比如装库，更新等。</p><p id="0479" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">如果你仔细检查截图，你会注意到第一个重要原因<a class="ae kv" href="https://www.unixtutorial.org/commands/visudo/" rel="noopener ugc nofollow" target="_blank"> visudo命令</a>如此有用:<strong class="iw hj">它不直接编辑/etc/sudoers文件</strong>。相反，它会创建一个名为/etc/sudoers.tmp的副本，并允许您编辑它。这意味着如果你的编辑会话发生了一些事情(服务器崩溃、断电、与远程服务器的连接中断)，你的服务器处于随机安全状态<strong class="iw hj"> /etc/sudoers </strong>是没有风险的。</p><p id="37d2" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">完成编辑后，visudo将对生成的<strong class="iw hj"> /etc/sudoers.tmp </strong>文件执行一系列检查，然后将其更改应用到<strong class="iw hj"> /etc/sudoers </strong>文件中。如果发现问题，您会在保存文件并退出文本编辑器后收到相关消息:</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="b70f" class="jv jw hi ls b fi lw lx l ly lz">root@ubuntu:~$ <strong class="ls hj">visudo</strong><br/>&gt;&gt;&gt; /etc/sudoers: syntax error near line 11 &lt;&lt;&lt;<br/>What now?</span></pre><p id="617f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">只需按回车键即可看到选项:</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="f485" class="jv jw hi ls b fi lw lx l ly lz">Options are:<br/>(e)dit sudoers file again<br/>e(x)it without saving changes to sudoers file<br/>(Q)uit and save changes to sudoers file (DANGER!)</span><span id="15fe" class="jv jw hi ls b fi mb lx l ly lz">What now?</span></pre><p id="8e56" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">最有可能的是，你想按e键继续编辑文件。但是如果你找不到问题所在(很可能是在你之前有人破坏了<strong class="iw hj"> /etc/sudoers </strong>，因为——你猜对了——他们手动编辑文件而不是使用<strong class="iw hj">visudo</strong>)——如果是这样的话，你可以按<strong class="iw hj"> x </strong>退出并进一步调查<strong class="iw hj"> /etc/sudoers </strong>文件。</p><h1 id="0598" class="kw jw hi bd jx kx ky kz kb la lb lc kf ld le lf ki lg lh li kl lj lk ll ko lm bi translated">结论:</h1><p id="c72e" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je js ks jh ji jt kt jl jm ju ku jp jq jr hb bi translated">在Ubuntu中向用户授予sudo访问权限是一项简单的任务，你所要做的就是将用户添加到“visudo”文件中。</p><h1 id="dcae" class="kw jw hi bd jx kx ky kz kb la lb lc kf ld le lf ki lg lh li kl lj lk ll ko lm bi translated">参考资料:</h1><div class="mc md ez fb me mf"><a href="https://www.unixtutorial.org/sudo-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">sudo教程</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">sudo允许您以不同用户的身份运行Unix命令。使用/etc/sudoers文件来确认什么是特权…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">www.unixtutorial.org</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt io mf"/></div></div></a></div><div class="mc md ez fb me mf"><a href="https://www.unixtutorial.org/commands/visudo" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">维苏多</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">visudo是Unix/Linux中的一个特殊工具，用于安全地更新/etc/sudoers文件，sudo命令使用它来…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">www.unixtutorial.org</p></div></div><div class="mo l"><div class="mu l mq mr ms mo mt io mf"/></div></div></a></div><div class="mc md ez fb me mf"><a href="https://linuxize.com/post/how-to-add-user-to-sudoers-in-ubuntu/" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">如何在Ubuntu中添加用户到Sudoers</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">sudo是一个命令行程序，允许受信任的用户以root或其他用户身份执行命令。我们将向您展示…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">linuxize.com</p></div></div><div class="mo l"><div class="mv l mq mr ms mo mt io mf"/></div></div></a></div><p id="8c1b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je js jg jh ji jt jk jl jm ju jo jp jq jr hb bi translated">希望这篇文章对你有帮助。请在下面留下评论/建议！</p></div></div>    
</body>
</html>