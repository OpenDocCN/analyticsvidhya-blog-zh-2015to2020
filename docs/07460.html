<html>
<head>
<title>Kaggle Top 4% Solution: WSDM-KKBOX’s Churn Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kaggle前4%解决方案:WSDM-KKBOX的流失预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/kaggle-top-4-solution-wsdm-kkboxs-churn-prediction-fc49104568d6?source=collection_archive---------10-----------------------#2020-06-26">https://medium.com/analytics-vidhya/kaggle-top-4-solution-wsdm-kkboxs-churn-prediction-fc49104568d6?source=collection_archive---------10-----------------------#2020-06-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/79c5e529c2f4b23c25ef0a44d1300fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OcNmThZjAyjYFsErctCCEw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片由<a class="ae iu" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1607164" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的Gerd Altmann 提供</figcaption></figure><p id="019b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我简要介绍了我对两年前结束的<a class="ae iu" href="https://www.kaggle.com/c/kkbox-churn-prediction-challenge/overview" rel="noopener ugc nofollow" target="_blank"> Kaggle挑战</a>的解决方案，该挑战主要由参与者共享的功能驱动。带有逐行输出的完整代码是初学者友好的，可在<a class="ae iu" href="https://github.com/G-pravin-shankar/Kaggle-Top-4-percent-Solution-WSDM-KKBOX-Churn-Prediction" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><h1 id="f178" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">桌子</h1><ol class=""><li id="5295" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated">概观</li><li id="f2c2" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">商业问题</li><li id="45a1" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">数据</li><li id="739d" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">绩效指标</li><li id="299e" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">现有解决方案</li><li id="952b" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">探索性数据分析</li><li id="92bd" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">首次切割方法</li><li id="69f8" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">最终模型</li><li id="e1d2" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">未来的工作</li><li id="9076" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">真实世界的情况</li><li id="0f57" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">参考</li></ol><h1 id="a326" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">概观</h1><p id="5cfb" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">人们习惯于公司如何营销来获得新客户。首次购买优惠和免费试用期经常被广告所利用。然而，客户保持是不受欢迎的，一个更重要和有效的能力，当企业利用不足将是一个巨大的打击。</p><p id="2631" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">留住现有客户至关重要，因为它比获得新客户更便宜、更省时，而且还有助于通过口碑带来更多客户，因为用户评论比广告更可靠。</p><p id="dadd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果大部分客户离开公司，花在获取客户上的钱就变得不可持续。此外，不满意的客户会损害声誉，这进一步降低了任何吸引客户的努力的效率。</p><p id="7d6a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">建立客户忠诚度可确保长期成功，组织越来越多地通过社交媒体、提供超出承诺的服务、收集定期反馈、个性化、在线聊天、电子邮件和电话支持，在竞争性定价中重塑客户体验。</p><p id="63c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尽管如此，客户流失是不可避免的，永远不应该被忽视。公司一般会从离开的消费者那里收集原因，并对其进行审查，以改善客户体验；这造成了显著的差异。</p><p id="6a3a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">流失预测无非是预测在特定时期将要离开的用户。整个商业社会的改善是为了避免高流失率。一旦预测到极有可能流失的用户，就可以通过解决可能的原因来阻止他们在未来这样做。</p><h1 id="d22e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">商业问题</h1><p id="19bf" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">KKBOX是东南亚一家流行的音乐流媒体服务提供商，是一种基于订阅和广告的商业模式。主要是每月订阅是收入的主要来源，用户可以在他们认为合适的任何时候取消他们的订阅。因此，提高客户流失预测对KKBOX的发展是不可或缺的。</p><p id="f8d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">任务是预测用户是否会在30天内不购买订阅，这是一个二元分类问题。</p><h1 id="b2df" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据</h1><p id="5809" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">KKBOX提供了几个月的交易、日志和会员信息。交易详细信息包括支付方式、订购持续时间、日期、会员到期日、订购取消，用户日志包含持续时间总数、独特歌曲数以及基于用户收听歌曲持续时间的特征。</p><p id="2057" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用户日志和交易细节仅在3月前可用。对于订阅在4月1日到期的用户，整个历史是开放的，但是对于在4月30日到期的用户，最近的活动是不可访问的。进一步的解释和数据可在<a class="ae iu" href="https://www.kaggle.com/c/kkbox-churn-prediction-challenge/data" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><h1 id="94a4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">绩效指标</h1><p id="0184" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">原木损失是竞赛中使用的评估指标。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/f9f6a0f6ba56d571a5d1bcf8c2fd7b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*67e8dmIO5R5A4zNzrwqsRA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://en.wikipedia.org/wiki/Cross_entropy" rel="noopener ugc nofollow" target="_blank">损失函数</a></figcaption></figure><h1 id="7c06" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">现有解决方案</h1><p id="a0c2" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated"><a class="ae iu" href="https://arxiv.org/pdf/1802.03396.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">预测客户流失:时间数据的极端梯度推进</strong> </a> <strong class="ix hj">作者布莱恩·格雷戈里(第一名):</strong></p><p id="a7eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择这个挑战的主要意图是专注于人工特征工程，第一名的获胜者只使用了传统的机器学习模型，这暗示了它的意义。</p><p id="6b88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大多数特征都是通过使用数学运算(如平均值或总和)在不同时间或整个时间内进行聚合和比较而提取的。总共使用了76个特征，并且共享了10个最有用的特征。权重为0.88的XGBoost和权重为0.12的LightGBM是用于预测的模型。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/e19a37e05a572b199ad2fd415300c328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cnx9aj-dDRE5REgG5i4BkQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" rel="noopener" href="/@bryan.gregory1/predicting-customer-churn-extreme-gradient-boosting-with-temporal-data-332c0d9f32bf">布莱恩·格雷戈里的十大重要特征</a>(XGBoost模型)</figcaption></figure><p id="5bb9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.kaggle.com/c/kkbox-churn-prediction-challenge/discussion/46078" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">解</strong> </a> <strong class="ix hj">乘无穷翼(第17位条目)</strong>:</p><p id="faaa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">LightGBM、XGboost和CatBoost模型用于重新标记的数据，并对预测进行平均。提供了特性及其重要性。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/745948008257bd035c6893fbc807fab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*YgH3E30zs0DMGPPG62rJYg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://www.kaggle.com/c/kkbox-churn-prediction-challenge/discussion/46078" rel="noopener ugc nofollow" target="_blank">无限机翼的重要特征</a>(light GBM模型)</figcaption></figure><h1 id="d339" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">探索性数据分析</h1><h2 id="71ff" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">城市</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/a9e769e2e9f0ba0fbed1c13da45fceb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*omo4Xzps0Pu4dgrjlsm93A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">城市(非流失)</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/c2f7c0e3d045a3e50e222bb5c3894be4.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*Dwu7DV_qbp7yjSDpNRitOA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">城市(流失)</figcaption></figure><p id="3c0a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大约一半的用户来自城市“1 ”,但他们只占搅动用户的30%。因此，这些用户不太可能流失。</p><h2 id="afbd" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">年龄</h2><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/1dbd22b8aed29618c3f0d01ed912d6ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*rzBd9EVlmeR5MfRrtUVAzQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">对于许多用户来说，年龄要么被破坏，要么丢失</figcaption></figure><p id="06ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基于第99.9个百分位数，范围10和85之外的值将替换为-1。</p><h2 id="12dc" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">性别</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/31500df5fc78628be31a7b48e834dfc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*Goc30I2Tb8DM424x6Oyc2A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">性别(非流失)</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/0c4309432132c1d8edf5d9e7d599010c.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*cs_Z0gpoWk2vov2NrnNwtg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">性别(流失)</figcaption></figure><p id="3d19" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">女性流失的可能性略低，但性别特征看起来并不乐观。</p><h2 id="03d8" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">通过注册</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/ead7f33e96cea089bfc0c94175c01e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*b5rKaysws5kYuEGrfy_yZA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">通过注册(非流失)</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/108acb7871898eb00d2b8bd9832cd95d.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*O93lmwtAHt4I7ELwKPT9yw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">通过(客户流失)注册</figcaption></figure><p id="b128" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个特性对我们的分类任务很有用。通过“7”注册的用户比其他人更忠诚。</p><h2 id="3af6" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">注册日期</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/61519b237729b6ac483a5e9ac191c471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*f9qp9RPDqXYL2dKdKk8BCw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">最近的用户支配着训练数据</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/8cd758e3bb2dc9fb20c4ceb2439b77db.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*dz3qrRIn1UtDxq_4tIu7Rg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">有些日期是未来的事</figcaption></figure><p id="2491" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">讨论部分提到之前的members.csv文件泄露信息，被移除。目前的版本也有一些不准确之处。例如，测试集中的一个用户的注册日期是未来23天，但不是私人排行榜的一部分。</p><h1 id="2292" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">首次切割方法</h1><p id="226e" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">即使在现实生活中，客户流失预测也没有低延迟限制，这使得探索众多功能以提高准确性变得可行。由于用户日志文件的大小很大，它被分割成块进行处理。</p><p id="adda" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为火车数据提供的一些标签不正确，所以我从事务细节生成数据。成员资格在1月和2月到期的用户分别用作训练集和CV集。由于没有4月份的交易，3月份到期的标签是不完整的，因此被忽略了。占主导地位的阶层，而不是流失率，抽样不足。</p><p id="726b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大多数订阅计划是按月而不是按天进行的，因此我对客户流失的定义与Kaggle对Train和CV数据集的定义略有不同，也就是说，如果用户在到期的一个月内重新订阅，则认为他没有流失。这是因为一些用户可能会跳过一个月，再次重新订阅，而测试集四月有30天。我还尝试了InfiniteWing的<a class="ae iu" href="https://github.com/InfiniteWing/Kaggle/blob/master/KKBOX%20churn/code/labeler_v2_final.py" rel="noopener ugc nofollow" target="_blank">代码</a>来生成标签，但是它增加了0.003的日志损失。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">代码保存不流失的数据点。</figcaption></figure><h2 id="971a" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">用户日志</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/18a0452364918610a39f7ecec8707062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aof4pPIxU5qMQ4VMl0DSbg.png"/></div></div></figure><p id="c433" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除了最后一天的日志之外，还使用了过去15天、上个月、上个月的前15天以及截止日期之前的整个时间段的用户日志的总和、平均值、计数和标准偏差。截止日期不过是最近的可访问日期，12月31日为训练数据，3月31日为测试数据。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">从用户日志中提取上月特征的代码</figcaption></figure><h2 id="10ba" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">成员</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/1ed327e8ec0eb7187120a7ebf5427af2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YC_sgN5IfSXzjJ7IwczPNg.png"/></div></div></figure><p id="880c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用了所有成员功能。</p><h2 id="46e0" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">处理</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/8eb37c9465faa0025bc796f7ce748030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X1NMFz-w3dm3qj6ie9m7QQ.png"/></div></div></figure><p id="4921" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后5次未流失、流失计数、未流失计数、流失率、总取消和交易计数与折扣、每日价格、付款计划天数、付款方式id、是否取消、是否自动续订、会员资格到期日期、实际支付金额、计划标价、计划天数以及最终交易和最终交易前的交易日期一起使用。</p><p id="6ab7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于它们的时间性质，日期特征从截止日期开始被正常编码。例如，最终登录日期转换为“自最终登录后的天数”。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">提取最后5个非流失特征的代码</figcaption></figure><h1 id="4cba" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">最终模型</h1><p id="2a21" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">到目前为止看到的所有特征都用在了比赛中。我添加了最近5天的价格、折扣、实际支付金额和付款计划天数的总和及平均值。此外，还包括截止日期后剩余的到期天数、到期日期与交易日期之间的差异(到期交易间隔)以及到期交易间隔与付款计划天数之间的差异。</p><p id="b5ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">具有dart booster的LightGBM比XGBoost表现更好，并且将非主导类的权重减少30%提高了交叉验证分数。</p><p id="9c43" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在KKBOX同时主办的另一场比赛中，几乎没有提供会员的订阅截止日期。这是外部来源的数据泄漏，但在比赛中是允许的。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/736a3d16e807b931d4da981703da799e.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*5ZjpUFVSbBbejfv1v6R2Ow.png"/></div></figure><p id="55ac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，将概率乘以0.75，显著提高了私人和公共排行榜的分数。这可能是因为与测试数据相比，训练数据的流失率较高(排行榜)。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/83503131633a765d5989170f20da9f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*xiImNa4AkmL6POYVzQHuqg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">32大重要特性</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/661ad65b1e713d73efa456e9a7f6f577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-yrbp3dylEl4z1aGvvTBJQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型中的一棵树</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/36f24b9e2ed62431e2a49e85574e2e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2LZUzstg42jbXRC04KxMmQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">排行榜得分</figcaption></figure><h1 id="cadf" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">未来的工作</h1><p id="36b5" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我手动更新了成员资格到期日期与外部成员文件中的到期日期相同的用户的概率，这仅占泄露信息的1%，其余的数据并没有提高性能，需要特征工程来表示隐式信息，这将改善预测。</p><p id="05c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最近5次客户流失、总客户流失和非客户流失计数以及客户流失率需要更新，因为他们可能遗漏了“is _ cancel”= 1个交易，我仅针对最终交易和最后一个之前交易功能进行了更正。</p><p id="137a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，由于一开始对问题陈述的误解，我错过了会员有效期为1月1日的用户，将他们添加到训练数据将进一步细化预测。</p><h1 id="1edc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">真实世界的情况</h1><h2 id="f3a4" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">回忆</h2><p id="3d4e" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">在应用情况下，即使以精确度或误报率为代价，召回所有将要流失的用户也是很重要的，因为公司不能失去他们的客户。由于流失率的时间变化，ROC AUC和混淆矩阵是合适的指标。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/52f0238a486a976e8d6cc4eed312589c.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*NoWoBlD1ImNvgBvZkVxmKA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">预测(阈值为0.5)</figcaption></figure><p id="4ee2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当只有小于0.5的预测概率被认为是流失时，超过三分之二被遗漏。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/21253f825f45693c1b7d71db7ce8f0b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*suTr7LjI8r7GVKxV-Zdi-g.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">ROC AUC曲线</figcaption></figure><p id="5767" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们的例子中，最佳阈值0.959是曲线上的点，超过该点，召回的增益(真阳性率)小于FPR(假阳性率)。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/1557cbee8edfb29280a5fa9081ad08d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*zLBwMHrum45phHbqlsuQ4Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">预测(阈值为0.959)</figcaption></figure><p id="a74d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在有76.8%的已经搅动的用户预测正确，12.1%没有搅动的用户预测不正确。如果错过25%的搅动对业务不利，我们可以提高门槛；但是FPR的增量会更多。</p><h2 id="11db" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">可解释性</h2><p id="2c8f" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">公司必须了解特定用户为什么会流失，并解决这个问题，或者根据客户的终身价值提供个性化的服务。即使特征是不言自明的，集合模型也不容易解释。</p><p id="e319" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://arxiv.org/abs/1602.04938v3" rel="noopener ugc nofollow" target="_blank">局部可解释模型不可知解释(LIME) </a>是一种推理模型预测的方法，通过一次考虑一个数据点，并通过分析其值的变化如何影响输出来权衡特征。这是每个数据点的线性近似值。然而，它有助于理解模型的复杂决策。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/7c35b005e2ed947751b8323d940887e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9-4PjgSw3aAVW8V0nQAVA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">a.)示例非流失数据点</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/854e84017b145794a8ecfdb981a77e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTj9pYVGP2wq7s1OIWchsA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">b.)示例流失数据点</figcaption></figure><p id="56fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于这是一个二元分类问题，并且类别是矛盾的，我们可以将它们解释为对预测影响最大的特征。</p><p id="efe7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，在“b”的情况下，最终交易的auto_renew为“0 ”,这是交易概率的主要贡献者，KKBOX将使用该信息通过提供折扣来说服用户启用自动支付。如果宁滨工作的话，理解连续特征可能会很简单。</p><p id="1785" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这不是用于Kaggle挑战的模型，因此特性的重要性可能不同。</p><h2 id="360a" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">渗漏</h2><p id="f911" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">与竞争产品相比，一个根本的区别是没有泄漏的空间，事实上，泄漏会严重降低性能。</p><p id="c01d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">应该通过评估前几个月的流失率趋势来应用特征工程，而不是通过探查公共排行榜分数来修改概率。这将有助于模型不仅在4月，而且在未来几个月高效运行。</p><h1 id="7122" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="148c" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">选择这个挑战是一次真正的学习经历，因为它涉及时间信息和特征工程。此外，探索讨论区和实现参与者揭示的功能提高了我的信心。我希望读者也是如此。</p><p id="de2c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">随时和我联系</strong> <a class="ae iu" href="https://www.linkedin.com/in/g-pravin-shankar-825049184" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> LinkedIn </strong> </a> <strong class="ix hj">。</strong></p><h1 id="dd25" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><ul class=""><li id="cd5c" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js my kz la lb bi translated"><a class="ae iu" href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener ugc nofollow" target="_blank">https://www . Applied ai course . com/course/11/Applied-Machine-learning-course</a></li><li id="bd74" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://marcotcr.github.io/lime/tutorials/Lime%20-%20basic%20usage%2C%20two%20class%20case.html" rel="noopener ugc nofollow" target="_blank">https://marcotcr . github . io/Lime/tutorials/Lime % 20-% 20 basic % 20 usage % 2C % 20 two % 20 class % 20 case . html</a></li><li id="16ba" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://towardsdatascience.com/understanding-model-predictions-with-lime-a582fdff3a3b" rel="noopener" target="_blank">https://towards data science . com/understanding-model-predictions-with-lime-a 582 fdff 3a 3b</a></li><li id="aae9" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://www.oreilly.com/content/introduction-to-local-interpretable-model-agnostic-explanations-lime/" rel="noopener ugc nofollow" target="_blank">https://www . oreilly . com/content/introduction-to-local-可解释-模型不可知-解释-lime/ </a></li><li id="32c6" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://arxiv.org/abs/1602.04938v3" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1602.04938v3</a></li><li id="8e47" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://www.profitwell.com/blog/churn-prediction" rel="noopener ugc nofollow" target="_blank">https://www.profitwell.com/blog/churn-prediction</a></li><li id="6481" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://blog.hubspot.com/service/how-to-reduce-customer-churn" rel="noopener ugc nofollow" target="_blank">https://blog . hubspot . com/service/how-to-reducing-customer-churn</a></li><li id="b2e9" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://www.superoffice.com/blog/reduce-customer-churn/" rel="noopener ugc nofollow" target="_blank">https://www.superoffice.com/blog/reduce-customer-churn/</a></li><li id="a869" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js my kz la lb bi translated"><a class="ae iu" href="https://en.wikipedia.org/wiki/Customer_support" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Customer_support</a></li></ul></div></div>    
</body>
</html>