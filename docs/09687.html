<html>
<head>
<title>Machine Learning in Cyber Security — Malicious Software Installation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络安全中的机器学习——恶意软件安装</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-in-cyber-security-malicious-software-installation-5dbbf742af36?source=collection_archive---------14-----------------------#2020-09-16">https://medium.com/analytics-vidhya/machine-learning-in-cyber-security-malicious-software-installation-5dbbf742af36?source=collection_archive---------14-----------------------#2020-09-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f216" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">通过在字符提取上应用TF-IDF进行本地管理活动监控的真实用例</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/ea913fd2f4f985e9e8942d09dad4ca3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OusZtSUzBnqSbUtR.jpg"/></div></div></figure><h1 id="289e" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">介绍</h1><blockquote class="kb kc kd"><p id="f2d7" class="ke kf kg kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">对SOC分析师和安全专业人员来说，由本地管理员监控用户活动始终是一项挑战。大多数安全框架会建议实现白名单机制。</p><p id="f9bf" class="ke kf kg kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated"><em class="hi">然而，现实世界往往并不理想。总是会有不同的开发人员或用户拥有本地管理员权限来绕过指定的控件。有办法监控本地管理员的活动吗？</em></p></blockquote><h1 id="5949" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">先说数据来源</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lb"><img src="../Images/dee3d2de28ec19a7bdf420e523fcce03.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/0*5qHcQEpndByY6r3h.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">数据集外观的示例—上面列出的3个条目指的是同一个软件</figcaption></figure><p id="a39d" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">数据集的外观示例—上面列出的3个条目指的是同一个软件</p><p id="5e09" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">我们有一个定期的批处理作业来检索安装在位于不同地区的每个工作站上的软件。大多数安装的软件都以当地语言显示。(是的，你能说出它的名字——它可能是日本的、法国的、荷兰的…..)因此，您会遇到这样的情况:安装的软件显示为7个不同的名称，而它指的是白名单中的同一软件。更不用说，我们有成千上万的设备。</p><h1 id="0d90" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">数据集的属性</h1><ul class=""><li id="ff37" class="lj lk hi kh b ki ll kl lm lg ln lh lo li lp la lq lr ls lt bi translated"><strong class="kh hj">主机名</strong> —设备的主机名</li><li id="5427" class="lj lk hi kh b ki lu kl lv lg lw lh lx li ly la lq lr ls lt bi translated"><strong class="kh hj">发布者名称</strong> —软件发布者</li><li id="3c26" class="lj lk hi kh b ki lu kl lv lg lw lh lx li ly la lq lr ls lt bi translated"><strong class="kh hj">软件名称</strong> —当地语言的软件名称和不同版本号</li></ul><h1 id="8f71" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">我们有办法识别非标准安装吗？</h1><p id="1c4c" class="pw-post-body-paragraph ke kf hi kh b ki ll ij kk kl lm im kn lg lz kq kr lh ma ku kv li mb ky kz la hb bi translated">我的想法是，公司使用的合法软件应该有不止一个安装，并且软件名称应该不同。在这种情况下，我相信使用机器学习来帮助用户对软件进行分类并突出任何异常值将是有效的。</p><p id="4392" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated"><strong class="kh hj">使用词频的字符处理—逆文档频率(</strong><a class="ae mc" href="https://www.analyticsvidhya.com/blog/2020/02/quick-introduction-bag-of-words-bow-tf-idf/" rel="noopener ugc nofollow" target="_blank"><strong class="kh hj">TF-IDF</strong></a><strong class="kh hj">)</strong></p><p id="964b" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">自然语言处理(NLP)是人工智能的一个子领域，处理理解和处理人类语言。鉴于机器学习的新进展，许多组织已经开始将自然语言处理应用于翻译、聊天机器人和候选人筛选。</p><p id="ccac" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">TF-IDF是一种统计度量，用于评估单词与文档集合中的文档的相关程度。这是通过将两个度量相乘来实现的:一个单词在一个文档中出现的次数，以及该单词在一组文档中的逆文档频率。</p><p id="5712" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">TF-IDF通常用于单词提取。然而，我在想它是否也适用于炭的提取。我们的想法是通过导出软件名称中每个字符的重要性来探索如何应用TF-IDF来提取与软件名称中每个字符相关的特征。下面的脚本示例演示了我如何将TF-IDF应用于我的数据集中的软件名称字段。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="3b55" class="mi jk hi me b fi mj mk l ml mm">import pandas as pd<br/>from sklearn.feature_extraction.text import TfidfVectorizer</span><span id="0a9e" class="mi jk hi me b fi mn mk l ml mm"># Import the dataset <br/>df=pd.read_csv("your dataset")</span><span id="2e31" class="mi jk hi me b fi mn mk l ml mm"># Extract the Manufacturer into List <br/>field_extracted = df['softwarename']</span><span id="6fd9" class="mi jk hi me b fi mn mk l ml mm"># initialize the TF-IDF <br/>vectorizer = TfidfVectorizer(analyzer='char')<br/>vectors = vectorizer.fit_transform(field_extracted)<br/>feature_names = vectorizer.get_feature_names()<br/>dense = vectors.todense()<br/>denselist = dense.tolist()<br/>result = pd.DataFrame(denselist, columns=feature_names)</span></pre><p id="6f96" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">结果片段:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/e971194d4c784556a7b2bb6dd1f5ccc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BW7-iryrT4uYl7HT.png"/></div></div></figure><p id="b0c2" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated"><strong class="kh hj">上述TF-IDF脚本的结果(混合了不同语言，如韩语、中文)</strong></p><p id="299f" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">在上图中，您可以看到执行了一个计算来评估每个字符对软件名称的“重要性”。这也可以解释为每个软件名称上有“多少”指定的字符可用。通过这种方式，您可以统计地呈现每个“软件名称”的特征，我们可以将这些特征放入您选择的机器学习模型中。</p><p id="f594" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">我提取的其他特征相信对模型也有意义:</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="f766" class="mi jk hi me b fi mj mk l ml mm">import math<br/>from collections import Counter</span><span id="221c" class="mi jk hi me b fi mn mk l ml mm"># Function of calculating Entropy <br/>def eta(data, unit='natural'):<br/>    base = {<br/>        'shannon' : 2.,<br/>        'natural' : math.exp(1),<br/>        'hartley' : 10.<br/>    }</span><span id="8ac1" class="mi jk hi me b fi mn mk l ml mm">if len(data) &lt;= 1:<br/>        return 0</span><span id="3f15" class="mi jk hi me b fi mn mk l ml mm">counts = Counter()</span><span id="97c0" class="mi jk hi me b fi mn mk l ml mm">for d in data:<br/>        counts[d] += 1</span><span id="43b7" class="mi jk hi me b fi mn mk l ml mm">ent = 0</span><span id="5a7c" class="mi jk hi me b fi mn mk l ml mm">probs = [float(c) / len(data) for c in counts.values()]<br/>    for p in probs:<br/>        if p &gt; 0.:<br/>            ent -= p * math.log(p, base[unit])</span><span id="5b18" class="mi jk hi me b fi mn mk l ml mm">return ent</span><span id="813b" class="mi jk hi me b fi mn mk l ml mm">entropy  = [eta(x) for x in field_extracted]</span></pre><ul class=""><li id="2307" class="lj lk hi kh b ki kj kl km lg mp lh mq li mr la lq lr ls lt bi translated">空间比率—软件名称有多少个空格</li><li id="dd86" class="lj lk hi kh b ki lu kl lv lg lw lh lx li ly la lq lr ls lt bi translated">元音比率—软件名称有多少个元音(aeiou)</li></ul><p id="ae0c" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">最后，我用标签列出了上面列出的这些特征，并与<strong class="kh hj"> randomtreeforest分类器</strong>进行了比较。你可以选择任何你喜欢的分类器，只要它能给你一个满意的结果。</p><p id="1ac1" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated">感谢阅读！</p><p id="24a8" class="pw-post-body-paragraph ke kf hi kh b ki kj ij kk kl km im kn lg kp kq kr lh kt ku kv li kx ky kz la hb bi translated"><em class="kg">原载于2020年9月16日</em><a class="ae mc" href="https://www.analyticsvidhya.com/blog/2020/09/machine-learning-in-cyber-security-malicious-software-installation/" rel="noopener ugc nofollow" target="_blank"><em class="kg"/></a><em class="kg">。</em></p></div></div>    
</body>
</html>