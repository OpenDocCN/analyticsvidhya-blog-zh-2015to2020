<html>
<head>
<title>Understanding Convolutional Neural Networks (CNN or ConvNet)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解卷积神经网络(CNN或ConvNet)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-convolutional-neural-networks-cnn-or-convnet-128dc51811f3?source=collection_archive---------7-----------------------#2020-02-16">https://medium.com/analytics-vidhya/understanding-convolutional-neural-networks-cnn-or-convnet-128dc51811f3?source=collection_archive---------7-----------------------#2020-02-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4fc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想知道计算机是如何理解一幅狗的图像是否真的是一只狗的吗？或者说它怎么知道狗的鼻子其实是不是鼻子？这一切都始于一个卷积神经网络。</p><p id="64dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本节中，我们将了解以下内容，以便理解CNN:</p><ol class=""><li id="156d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">计算机如何读取图像？</li><li id="5dd5" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">为什么不用全连接神经网络进行图像识别？</li><li id="2c96" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">什么是卷积神经网络？。</li><li id="529e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">CNN是如何工作的？</li><li id="72cb" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">CNN的使用案例</li></ol><p id="be18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始…</p><h2 id="8299" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">1.计算机如何读取图像？</h2><p id="150e" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">因此，每个图像有3个通道，即:红色、绿色和蓝色通道，简称为RGB通道。这些通道中的每一个都有它们各自的像素值，这些像素值按行和列排列。假设我们有一个规格为200x200x3的图像，这意味着我们有200行、200列和3个通道。这主要是针对彩色图像，黑白图像只有两个通道。这基本上是计算机读取图像的方式。</p><p id="f7c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们进入第二个问题…</p><h2 id="1fef" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">2.为什么不用全连接神经网络进行图像识别？</h2><p id="b18d" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">假设我们有一个MNIST数据集，这是一个手写数字图像的数据集，图像大小仅为28x28x1 (28行，28列，1个颜色通道)。因此，全连接神经网络的第一隐藏层中的单个全连接神经元将具有28×28×1 = 786个权重。还假设我们有3个颜色通道，即28×28×3，那么我们在第一个隐藏层中也将有2352个权重。这个数额似乎仍然可以应付，</p><p id="c68f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kr">但是如果我们转向更大的图像呢？</em>例如，更大尺寸的图像，例如200x200x3，将导致神经元具有200x200x3 = 120，000个权重。我们需要处理如此大量的参数，而且，我们几乎肯定会有更多数量的这样的神经元。这将最终导致<strong class="ih hj">过度拟合</strong>。是的，你猜对了！这是我们不使用全连接神经网络进行图像分类的主要原因。</p><p id="413c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们先来了解一下什么是<strong class="ih hj">卷积神经网络</strong>以及我们为什么需要它们。</p><h2 id="f369" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">3.什么是卷积神经网络？</h2><p id="6060" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">现在，你们大多数人一定想知道术语<strong class="ih hj">卷积</strong>是什么意思？在纯数学术语中，卷积是通过积分从两个给定函数导出的函数，它表示一个函数的形状如何被另一个函数修改。哇哦。哇哦。这是什么？简而言之，卷积仅仅意味着一个函数的形状如何被另一个函数修改。就是这样！</p><p id="d86f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是等等，就神经网络而言，这意味着什么？这是一种从图像中提取特征的操作，网络将进一步使用这些特征来了解特定的图像。假设我们有一张狗的图片。所以特征可以是狗的鼻子、耳朵或眼睛等的形状。</p><p id="eed8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们转到我们的主要问题，<strong class="ih hj">CNN是什么？</strong></p><p id="e7d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络是一类用于分类/分析图像的深度神经网络。这是一种前馈神经网络，其中神经元之间的连接模式受到动物视觉皮层组织的启发。视觉皮层基本上是我们大脑中的一小块区域，对视野的特定区域很敏感。</p><p id="a6e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，基本思想是，与传统的神经网络相反，在传统的神经网络中，每个神经元都与其他每个神经元相连，以获得其输入(这就是为什么我们称之为全连接神经网络)，在CNN中，在每一层中，每个输出值都只取决于少量的输入。这使得CNN网络易于在较小的训练数据集上训练，并且不容易过度拟合。这种现象也被称为<strong class="ih hj">连接的稀疏性</strong>。</p><p id="d5b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，但是CNN是怎么工作的？</p><h2 id="0812" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">4.CNN是如何工作的？</h2><p id="e21a" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">所以基本上CNN有4层，即:</p><p id="0c94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a)卷积层b) ReLU层c)汇集层和d)扁平化和全连接网络</p><h2 id="cac2" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">a)卷积层:</h2><p id="da00" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">现在，在第一层即<strong class="ih hj">卷积层</strong>中，借助三个元素执行卷积:</p><ol class=""><li id="8c74" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">输入图像- </strong>要卷积的图像。</li><li id="ce03" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">特征检测器/内核/过滤器- </strong>它们是矩阵形式的一串数字，用于从图像中提取特征。它们可以是一维、二维或三维的。</li><li id="f1d6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">特征图/激活图- </strong>图像和特征检测器之间执行的卷积运算的结果给出了特征图。</li></ol><figure class="kt ku kv kw fd kx er es paragraph-image"><div class="er es ks"><img src="../Images/0422096f91e8e7cb44c2ea21bd3a3114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*TDeLsxckTFHwEbicGxptEw.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">了解如何从输入图像和特征检测器创建特征。</figcaption></figure><p id="7d3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么卷积运算到底是如何工作的呢？</p><ol class=""><li id="9c89" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">我们首先从左上角开始将特征检测器/滤波器投影到输入图像上。假设我们拿一个3x3的特征检测器。所以我们把它投射到输入图像的前3×3像素上。</li><li id="aeaf" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">将特征检测器中的数字乘以输入图像单元中的数字。我们将特征检测器的数量与输入图像单元的前3×3像素的数量相乘。</li><li id="2b79" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">将细胞数相乘得到的所有数字相加，并将该数字放在特征图的第一个左上角。</li><li id="e23a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">现在向右移动特征检测器/过滤器，重复步骤1到3，直到你得到特征图。</li></ol><p id="7e5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个卷积过程如下所示:</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/c130a576969b3027716c271e476171dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rRT3tkMOKX-8c7nqW_iHLQ.gif"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">卷积过程</figcaption></figure><p id="c183" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，如果输入图像大小为5×5，特征检测器大小为3×3，则输出(即特征图)的大小为3×3。</p><p id="0b5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您可能会认为，由于输入图像大小与输出特征检测器的大小不匹配，因此存在信息丢失。是的，你是对的！特征检测器的真正目的是筛选输入图像中的信息，并过滤与其不可分割的部分，排除其余部分。</p><h2 id="21cf" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">B) ReLU(整流线性单位)层:</h2><p id="5dc5" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">ReLU是仅当输入值高于阈值时才激活节点的功能。如果输入值低于零，则输出为零，如果高于某个阈值，则输出与因变量成线性关系。这意味着我们从过滤后的图像中移除负值并用零来代替它。我们为什么要这么做？这样做是为了避免将这些值相加为零。</p><p id="6640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用整流器功能的目的是增加图像中的非线性。我们想这么做的原因是图像天生就是非线性的。通常，一幅图像由许多非线性特征组成。但是我们有可能在卷积层施加一些线性。为了避免这种情况，我们使用整流器来进一步分解线性度。</p><p id="3f83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ReLU函数看起来像这样:</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div class="er es lj"><img src="../Images/ff7bfeeb33a2e78d12ddad4db778a590.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/0*2B8TUGlLCxCANxli.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">ReLU函数</figcaption></figure><h2 id="4799" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">c)汇集层:</h2><p id="94a7" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">汇集有两种类型:1)最大汇集和2)平均汇集。这两者背后的想法如下图所示:</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lk"><img src="../Images/14947304dbcd8e6ce6097ec9b163a699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPCP5wlOuRjdUoODpdsEmw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">池化:最大池化和平均池化</figcaption></figure><p id="229d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上图我们可以稍微了解到，池化缩小了图像的大小。但是我们到底为什么要共用呢？这对我们有什么好处？嗯……以下几点会让你明白:</p><ol class=""><li id="0259" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">缩小图像的大小，以便我们只关注图像的重要方面，而不是图像的整体。</li><li id="d14b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">以减少要计算的参数数量，从而提高计算速度。</li><li id="0dbf" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">使一些检测重要事物的功能更加强大。</li></ol><p id="be9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">汇集涉及的步骤是:</p><ol class=""><li id="3d2e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">我们首先选择大小为2或3的窗口</li><li id="b395" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">然后我们决定我们想要多少步，通常是2步</li><li id="25d5" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">然后，我们将窗口投影到过滤后的图像上，每次取最大值。</li></ol><p id="2a14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是等等！我们这样做不是会丢失信息吗？是的，我们当然是！但这里的问题是，在不影响模型预测的情况下，我们能承受多少信息的损失。也许选择多长时间(经过多少次回旋)和在网络的哪个部分(在网络的开始或中间或末端)使用最大池的标准完全取决于这个网络的用途。</p><h2 id="44ae" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">d)扁平化和全连接网络:</h2><p id="8f36" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">一旦我们得到了图像的汇集特征图，下一步就是将汇集特征图展平成一个列向量，如下图所示:</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div class="er es ll"><img src="../Images/5e0dce039e46aad382939cf7b002770b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*TpRxG-gBY_Y2E414yjKphQ.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">将汇集的特征映射转换为展平的列向量。</figcaption></figure><p id="c2e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们为什么要这么做？因为我们要把这个向量插入到一个全连接的神经网络中进行进一步处理。这个向量作为神经网络的输入，神经网络的作用是组合更广泛的属性，使CNN更有能力对图像进行分类。</p><h2 id="f450" class="jr js hi bd jt ju jv jw jx jy jz ka kb iq kc kd ke iu kf kg kh iy ki kj kk kl bi translated">5.CNN的使用案例:</h2><p id="285b" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">以识别输入图像是猫还是狗以及类似的此类用例。</p><p id="0c41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你已经在高层次上理解了什么是卷积神经网络，以及它是如何工作的。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div class="er es lm"><img src="../Images/eccb4a6b36d1462b3168c3cebdd3d13e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*Apm8X87cEG_d-LXcYT2xSg.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">使用展平后的全连接神经网络进行更好的分类。</figcaption></figure><h1 id="015e" class="ln js hi bd jt lo lp lq jx lr ls lt kb lu lv lw ke lx ly lz kh ma mb mc kk md bi translated">参考资料:</h1><p id="7443" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated"><a class="ae me" href="https://www.youtube.com/watch?v=umGJ30-15_A" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=umGJ30-15_A</a></p><p id="1fbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae me" href="https://www.superdatascience.com/blogs/convolutional-neural-networks-cnn-step-1-convolution-operation" rel="noopener ugc nofollow" target="_blank">https://www . superdata science . com/blogs/convolutionary-neural-networks-CNN-step-1-convolution-operation</a></p><p id="2aeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae me" href="https://www.superdatascience.com/blogs/convolutional-neural-networks-cnn-step-1b-relu-layer/" rel="noopener ugc nofollow" target="_blank">https://www . superdata science . com/blogs/convolutionary-neural-networks-CNN-step-1 b-relu-layer/</a></p><p id="07ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae me" href="https://www.superdatascience.com/blogs/convolutional-neural-networks-cnn-step-2-max-pooling/" rel="noopener ugc nofollow" target="_blank">https://www . superdata science . com/blogs/convolutionary-neural-networks-CNN-step-2-max-pooling/</a></p><p id="7e00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae me" href="https://www.superdatascience.com/blogs/convolutional-neural-networks-cnn-step-3-flattening/" rel="noopener ugc nofollow" target="_blank">https://www . superdata science . com/blogs/convolatile-neural-networks-CNN-step-3-flattening/</a></p><p id="2f3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae me" href="https://www.superdatascience.com/blogs/convolutional-neural-networks-cnn-step-4-full-connection" rel="noopener ugc nofollow" target="_blank">https://www . superdata science . com/blogs/convolutionary-neural-networks-CNN-step-4-full-connection</a></p></div></div>    
</body>
</html>