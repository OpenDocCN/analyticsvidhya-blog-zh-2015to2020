<html>
<head>
<title>Let’s use redux in react</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们在 react 中使用 redux</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/lets-use-redux-in-react-7d7cb066e7c5?source=collection_archive---------10-----------------------#2020-08-04">https://medium.com/analytics-vidhya/lets-use-redux-in-react-7d7cb066e7c5?source=collection_archive---------10-----------------------#2020-08-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5863a0ac6455086827b1c5245a7c3aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TG2ebQQMNS8_FH5MVKjq9w.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@kellysikkema?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae iu" href="https://unsplash.com/s/photos/values?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><blockquote class="iv iw ix"><p id="2f5d" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">Redux 使用起来超级简单。动作用于指示可以对状态做什么，缩减器用于指示状态的转换，分派用于执行动作，存储用于将所有这些结合在一起。听起来像希腊语吗？我来详细解释一下。</p></blockquote><h2 id="cd0e" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">redux 是什么？</strong></h2><p id="d715" class="pw-post-body-paragraph iy iz hi jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">Redux 是一个状态管理库，可以用在 React 中，也可以用在 Angular、Vue 甚至 vanilla JavaScript 中。除了上下文之外，API 可以作为 Redux 的替代。</p><blockquote class="iv iw ix"><p id="5f39" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">为什么我们需要 redux？不能用状态和道具吗？这是额外的负担。</p></blockquote><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es la"><img src="../Images/b32cd002f59448bc926a69c7026e7e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*bC2uYHgeyRSVdXkV23ctOA.png"/></div></figure><p id="a26e" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">让我解释一下，如果子组件有它自己的状态，那么管理它们就不成问题。如果子组件 2 需要这些数据呢？然后，我们必须执行<strong class="jb hj">状态提升</strong>并将这些数据传递给父组件，如下所示，并将它们作为道具传递给子组件。那么还是可控的。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es la"><img src="../Images/c2af9e73eec301ae6cf959669907168f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*_L2y0giADdBSO-GdLm-coA.png"/></div></figure><p id="faa7" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">如果组件 1 和组件 2 也需要这些数据呢？然后我们不得不面对如下的<strong class="jb hj">道具钻</strong>的问题，因为我们不得不使用道具到处传递那些数据，这变成了负担。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es la"><img src="../Images/d1c157c1aa97e128fecf415d3b0c46df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*v8_8URJghJ6Ie3tnbt0tKA.png"/></div></figure><p id="eae6" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后 redux 通过将数据从组件中分离出来来解决这个问题，如下所示。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/0923844d5a889b73e5b1eae98e6c4089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LaWGqbz5L6J_KSsVw3FdNQ.png"/></div></div></figure><blockquote class="iv iw ix"><p id="728d" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">好，然后画面变得清晰。但是 redux 是怎么做到的呢？</p></blockquote><h2 id="2c9c" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">redux 如何管理状态？</h2><p id="a5de" class="pw-post-body-paragraph iy iz hi jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">让我们举一个例子，在常见的情况下，状态会因为我们采取的操作而改变，比如单击“添加”按钮，我们可以增加一个数字。在 redux 中也有 4 个独立的组件来管理状态。</p><ul class=""><li id="6bd8" class="lg lh hi jb b jc jd jg jh ki li km lj kq lk jw ll lm ln lo bi translated">存储—保留所有状态。</li><li id="f954" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">行动——能对国家做些什么。</li><li id="6e85" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">还原器——动作如何改变状态。</li><li id="38d2" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">分派—调用操作来更改状态。</li></ul><blockquote class="iv iw ix"><p id="e905" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">啊啊！我没得到它。好的，这很好，因为这也是我的第一个表达。</p></blockquote><p id="35a0" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">让我们举一个例子，按给定的数增加或减少计数。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/470244714a1f3c2a1fb6b0300cc9a443.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*lC2KVepkJdhll1Zm5UuFCA.png"/></div></figure><p id="5ff5" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">这些动作可以实现为增量和减量。那么当调用递增动作时，缩减器将指示状态将增加给定的数量，或者调用递减动作时，状态将递减给定的数量。除此之外，减速器将启动状态。然后在需要执行动作时调用 dispatch。</p><blockquote class="iv iw ix"><p id="f7ab" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">好的，那么商店的意义是什么？</p></blockquote><p id="05d6" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">商店将包装所有的减压器。这就是为什么我们称之为州保持所有的州。</p><blockquote class="iv iw ix"><p id="81fc" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">我们可以在 React 中直接使用 redux 吗？</p></blockquote><p id="67a8" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">不，我们不能。我们必须使用<code class="du lv lw lx ly b">react-redux</code>库来连接 React 和 Redux。</p><h2 id="3090" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">让我们做三个例子来获得清晰的理解</h2><ol class=""><li id="a225" class="lg lh hi jb b jc kv jg kw ki lz km ma kq mb jw mc lm ln lo bi translated">没有参数的简单递增和递减。</li><li id="10ae" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw mc lm ln lo bi translated">带自变量的增量和减量。</li><li id="cb4d" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw mc lm ln lo bi translated">在 redux 中处理对象状态。</li></ol><h2 id="de55" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">没有参数的简单递增和递减。</h2><p id="263c" class="pw-post-body-paragraph iy iz hi jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">首先使用<code class="du lv lw lx ly b">npx create-react-app redux-tutorial</code>制作一个 react 应用，然后使用<code class="du lv lw lx ly b">npm install redux react-redux</code>安装 redux 和 react-redux 库</p><p id="04a8" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后让我们清除如下的文件夹结构和<code class="du lv lw lx ly b">src/index.js</code>和<code class="du lv lw lx ly b">src/App.js</code>。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/00c41738e03d0f043b19f667ab17bb4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h89jqfcf1r2FzA16FUJ1sw.png"/></div></div></figure><p id="afe5" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated"><code class="du lv lw lx ly b">src/index.js</code></p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="f5e0" class="jx jy hi ly b fi mi mj l mk ml">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import './index.css';<br/>import App from './App';</span><span id="2cec" class="jx jy hi ly b fi mm mj l mk ml">ReactDOM.render(<br/>    &lt;React.StrictMode&gt;<br/>        &lt;App /&gt;<br/>    &lt;/React.StrictMode&gt;,<br/>    document.getElementById('root')<br/>);</span></pre><p id="f129" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated"><code class="du lv lw lx ly b">src/App.js</code></p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="18fc" class="jx jy hi ly b fi mi mj l mk ml">import React from "react";<br/>import "./App.css";</span><span id="2580" class="jx jy hi ly b fi mm mj l mk ml">function App() {<br/>    return (<br/>        &lt;div&gt;<br/>            &lt;p&gt;Hello&lt;/p&gt;<br/>        &lt;/div&gt;<br/>    );<br/>}</span><span id="c216" class="jx jy hi ly b fi mm mj l mk ml">export default App;</span></pre><p id="1a2b" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后先在<code class="du lv lw lx ly b">src/actions/counterActions.js</code>做动作。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="5361" class="jx jy hi ly b fi mi mj l mk ml">// Increment action.<br/>export const increment = () =&gt; {<br/>    return {<br/>        type: "INCREMENT"<br/>    }<br/>}</span><span id="48e7" class="jx jy hi ly b fi mm mj l mk ml">// Decrement action.<br/>export const decrement = () =&gt; {<br/>    return {<br/>        type: "DECREMENT"<br/>    }<br/>}</span></pre><blockquote class="iv iw ix"><p id="6a59" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">哦等等！为什么我们在动作中只表示常量，这真是个笑话？等等！一旦我们继续下一个例子，你就会明白这一点，因为这是最简单的一个例子，类型是我们在这里唯一可以添加的东西。</p></blockquote><p id="6603" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">那我们就在<code class="du lv lw lx ly b">src/reducers/counterReducer.js</code>里做减速器吧。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="0c75" class="jx jy hi ly b fi mi mj l mk ml">const conterReducer = (state = 0, action) =&gt; {<br/>    switch (action.type) {<br/>        case "INCREMENT":<br/>            return state + 1;<br/>        case "DECREMENT":<br/>            return state - 1;<br/>        default:<br/>            return state;<br/>    }<br/>};</span><span id="64a8" class="jx jy hi ly b fi mm mj l mk ml">export default conterReducer;</span></pre><p id="3d76" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">正如我前面提到的，reducer 启动状态，它将指示一旦分派了动作，状态将会发生什么。正如您在切换案例中看到的，它将在类型位于动作对象中的<code class="du lv lw lx ly b"><strong class="jb hj">action.type</strong></code> <strong class="jb hj"> </strong>之间切换。</p><p id="38cd" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后我们必须将这些状态存储在<strong class="jb hj">存储库</strong>(在我们的例子中只有一个状态)中，并且我们必须将存储库注入到<code class="du lv lw lx ly b">src/index.js</code>中的组件树中。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="862f" class="jx jy hi ly b fi mi mj l mk ml">import React from "react";<br/>import ReactDOM from "react-dom";<br/>import "./index.css";<br/>import App from "./App";<br/>import { createStore } from "redux";<br/>import reducers from "./reducers/<!-- -->counterReducer.js<!-- -->";<br/>import { Provider } from "react-redux";</span><span id="ef25" class="jx jy hi ly b fi mm mj l mk ml">// Initiate the store.<br/>const store = createStore(reducers);</span><span id="b32f" class="jx jy hi ly b fi mm mj l mk ml">ReactDOM.render(<br/>  &lt;React.StrictMode&gt;<br/>  {/* Inject store to the component tree. */}<br/>  &lt;Provider store={store}&gt;<br/>      &lt;App /&gt;<br/>    &lt;/Provider&gt;<br/>  &lt;/React.StrictMode&gt;,<br/>  document.getElementById("root")<br/>);</span></pre><p id="8791" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">那么让我们做一个简单的 UI 来表示如下的变化。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/55dd337690149c1386d2d5b8e779bf21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UV2n6UHdbSPINx1Z_0_loA.png"/></div></div></figure><p id="213a" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后我们可以修改<code class="du lv lw lx ly b">src/App.js</code>如下。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="13ff" class="jx jy hi ly b fi mi mj l mk ml">import React from "react";<br/>import "./App.css";<br/><strong class="ly hj">// Import useSelector to connect to the store.<br/>// Import useDispatch to connect actions.</strong><br/>import { useSelector, useDispatch } from "react-redux";<br/>import Row from "react-bootstrap/Row";<br/>import Button from "react-bootstrap/Button";<br/>import Card from "react-bootstrap/Card";<br/><strong class="ly hj">// Import actions.</strong><br/>import { increment, decrement } from "./actions/counterActions";</span><span id="eff3" class="jx jy hi ly b fi mm mj l mk ml">function App() {<br/>  <strong class="ly hj">// Assign the store to a value.</strong><br/>  const counter = useSelector(state =&gt; state);<br/>  <strong class="ly hj">// Initiate the dispatch.</strong><br/>  const dispatch = useDispatch();</span><span id="2ce6" class="jx jy hi ly b fi mm mj l mk ml">return (<br/>    &lt;div&gt;<br/>      &lt;Card style={{ margin: 50, width: "30vw" }}&gt;<br/>        &lt;Card.Header&gt;Simple Counter&lt;/Card.Header&gt;<br/>        &lt;Card.Body&gt;<br/>        &lt;Row&gt;<br/>        <strong class="ly hj">  {/* Show the count. */}</strong>                    <br/>          &lt;p&gt;Count : {counter} &lt;/p&gt;<br/>        &lt;/Row&gt;<br/>        <strong class="ly hj">{/* Dispatched increment action. */}<br/>        </strong>&lt;Button onClick={() =&gt; dispatch(increment())}&gt;<br/>           Increment<br/>        &lt;/Button&gt;{" "}<br/>        <strong class="ly hj">{/* Dispatched decrement action. */}</strong>        <br/>        &lt;Button onClick={() =&gt; dispatch(decrement())}&gt;<br/>          Decrement<br/>        &lt;/Button&gt;<br/>        &lt;/Card.Body&gt;<br/>      &lt;/Card&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="7074" class="jx jy hi ly b fi mm mj l mk ml">export default App;</span></pre><p id="3d5d" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后应用程序将工作，你可以在这里找到代码<a class="ae iu" href="https://github.com/yashodgayashan/redux-tutorial/tree/simpleCounter" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="bef0" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">带自变量的增量和减量。</h2><p id="d732" class="pw-post-body-paragraph iy iz hi jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">让我们来看一个高级的例子，我们需要用一个数字来增加或减少计数。首先，我们必须改变动作以接受一个参数，如下图<code class="du lv lw lx ly b">src/actions/counterActions.js</code>所示。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="93a5" class="jx jy hi ly b fi mi mj l mk ml">export const increment = <strong class="ly hj">num</strong> =&gt; {<br/>  return {<br/>    type: "INCREMENT",<br/>    <strong class="ly hj">value: num</strong><br/>  };<br/>};</span><span id="d2d6" class="jx jy hi ly b fi mm mj l mk ml">export const decrement = <strong class="ly hj">num</strong> =&gt; {<br/>  return {<br/>    type: "DECREMENT",<br/>    <strong class="ly hj">value: num</strong><br/>  };<br/>};</span></pre><p id="3e2f" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后上面的动作将接受一个参数并在对象中返回它。然后会根据<code class="du lv lw lx ly b">src/reducers/counterReducer.js</code>动作中给定的值改变减速器来改变状态。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="ff99" class="jx jy hi ly b fi mi mj l mk ml">const conterReducer = (state = 0, action) =&gt; {<br/>  switch (action.type) {<br/>    case "INCREMENT":<br/>      return state + parseInt(<strong class="ly hj">action.value</strong>);<br/>    case "DECREMENT":<br/>      return state - <strong class="ly hj">action.value</strong>;<br/>    default:<br/>      return state;<br/>  }<br/>};</span><span id="59f0" class="jx jy hi ly b fi mm mj l mk ml">export default conterReducer;</span></pre><p id="8044" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">counterReducer 将根据动作对象的给定数值改变状态。之后我们可以更改<code class="du lv lw lx ly b">src/App.js</code>来制作一个简单的 UI 如下。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/470244714a1f3c2a1fb6b0300cc9a443.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*lC2KVepkJdhll1Zm5UuFCA.png"/></div></figure><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="f192" class="jx jy hi ly b fi mi mj l mk ml">import React, { useState } from "react";<br/>import "./App.css";<br/>import { useSelector, useDispatch } from "react-redux";<br/>import Row from "react-bootstrap/Row";<br/>import Button from "react-bootstrap/Button";<br/>import Card from "react-bootstrap/Card";<br/>import Form from "react-bootstrap/Form";<br/>import { increment, decrement } from "./actions/counterActions";</span><span id="bfba" class="jx jy hi ly b fi mm mj l mk ml">function App() {<br/>  const counter = useSelector(state =&gt; state);<br/>  const dispatch = useDispatch();<br/>  // To set the value in the field.<br/>  const [value, setValue] = useState(0);<br/>  <br/>  return (<br/>    &lt;div&gt;<br/>    &lt;Card style={{ margin: 50, width: "30vw" }}&gt;<br/>      &lt;Card.Header&gt;Simple Counter&lt;/Card.Header&gt;<br/>      &lt;Card.Body&gt;<br/>        &lt;Row&gt;<br/>          &lt;p&gt;Count : {counter} &lt;/p&gt;<br/>        &lt;/Row&gt;<br/>        &lt;Form&gt;<br/>          &lt;Form.Group controlId="formBasicValue"&gt;<br/>            &lt;Form.Label&gt;Value&lt;/Form.Label&gt;<br/>            &lt;Form.Control type="text"<br/>               placeholder={value}<br/>               onChange={event =&gt; setValue(event.target.value)}<br/>            /&gt;<br/>          &lt;/Form.Group&gt;<br/>        &lt;/Form&gt;<br/>        &lt;Button onClick={() =&gt; dispatch(increment(value))}&gt;<br/>          Increment<br/>        &lt;/Button&gt;{" "}<br/>        &lt;Button onClick={() =&gt; dispatch(decrement(value))}&gt;<br/>          Decrement<br/>        &lt;/Button&gt;<br/>     &lt;/Card.Body&gt;<br/>  &lt;/Card&gt;<br/>  &lt;/div&gt;<br/>  );<br/>}</span><span id="ac96" class="jx jy hi ly b fi mm mj l mk ml">export default App;</span></pre><p id="86b7" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后应用程序将工作，你可以在这里找到代码<a class="ae iu" href="https://github.com/yashodgayashan/redux-tutorial/tree/advancedCounter" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="1855" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">在 redux 中处理对象状态。</strong></h2><p id="5d4c" class="pw-post-body-paragraph iy iz hi jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">让我们用 redux 处理一个有两个字段的对象。在这个例子中，让我们创建下面的表单来更改或删除这个人的姓名和年龄。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/fafa474466ec27a8f7af2776ce1a15e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ItPWTC9wn6bObEWIbXTx-w.png"/></div></div></figure><p id="a1e8" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">首先创建另一个动作文件<code class="du lv lw lx ly b">src/actions/userActions.js</code>，如下所示。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="0b9a" class="jx jy hi ly b fi mi mj l mk ml">export const update = (name, age) =&gt; {<br/>  return {<br/>    type: "UPDATE",<br/>    val: {<br/>      name,<br/>      age<br/>    }<br/>  };<br/>};</span><span id="998b" class="jx jy hi ly b fi mm mj l mk ml">export const remove = () =&gt; {<br/>  return {<br/>    type: "DELETE"<br/>  };<br/>};</span></pre><ul class=""><li id="d3cf" class="lg lh hi jb b jc jd jg jh ki li km lj kq lk jw ll lm ln lo bi translated">在更新函数中，它获取姓名和年龄作为参数，并将其作为类型的对象传递。</li><li id="7e65" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">在删除操作中，它只传递类型。</li></ul><p id="e9df" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后我们可以在文件<code class="du lv lw lx ly b">src/reducers/counterReducer.js</code>中创建相应的 reducer，如下所示。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="ec9e" class="jx jy hi ly b fi mi mj l mk ml">const userInfoReducer = <br/>  (state = { name: "yashod", age: 25 }, action) =&gt; {<br/>    switch (action.type) {<br/>      case "UPDATE":<br/>        state = { <br/>          name: action.val.name,<br/>          age: action.val.age<br/>        };<br/>        return state;<br/>      case "DELETE":<br/>        state = {<br/>          name: "",<br/>          age: null<br/>        };<br/>        return state;<br/>      default: <br/>        return state;<br/>    }<br/>  };</span><span id="6c2a" class="jx jy hi ly b fi mm mj l mk ml">export default userInfoReducer;</span></pre><ul class=""><li id="3b04" class="lg lh hi jb b jc jd jg jh ki li km lj kq lk jw ll lm ln lo bi translated">在“更新”中，它将使用从动作传递的值来改变状态。</li><li id="ee4b" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">在"删除"状态下它会清除所有的值。</li></ul><p id="841a" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">那么让我们把<code class="du lv lw lx ly b">src/App.js</code>文件修改如下。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="f17d" class="jx jy hi ly b fi mi mj l mk ml">import React, { useState, useEffect } from "react";<br/>import "./App.css";<br/>import { useSelector, useDispatch } from "react-redux";<br/>import Row from "react-bootstrap/Row";<br/>import Button from "react-bootstrap/Button";<br/>import Card from "react-bootstrap/Card";<br/>import Form from "react-bootstrap/Form";<br/><strong class="ly hj">import { update, remove } from "./actions/userActions";</strong></span><span id="9400" class="jx jy hi ly b fi mm mj l mk ml">function App() {<br/>  const user = useSelector(state =&gt; state);<br/>  const dispatch = useDispatch();<br/>  <strong class="ly hj">// To set the name.</strong><br/>  const [name, setName] = useState(user.name);<br/>  <strong class="ly hj">// To set the age.</strong><br/>  const [age, setAge] = useState(user.age);</span><span id="5593" class="jx jy hi ly b fi mm mj l mk ml">  <strong class="ly hj">// useEffect hook is used to set the name and age variable once               user state is set.</strong><br/>  useEffect(() =&gt; {<br/>    setName(user.name);<br/>    setAge(user.age);<br/>  }, [user]);</span><span id="b24f" class="jx jy hi ly b fi mm mj l mk ml">  return (<br/>    &lt;div&gt;<br/>    &lt;Card style={{ margin: 50, width: "30vw" }}&gt;<br/>      &lt;Card.Header&gt;User Information&lt;/Card.Header&gt;<br/>      &lt;Card.Body&gt;<br/>        &lt;Row&gt;<br/>          &lt;Form&gt;<br/>          &lt;Form.Group controlId="formBasicName"&gt; <br/>          &lt;Form.Label&gt;Name&lt;/Form.Label&gt;<br/>          &lt;Form.Control<br/>            type="name"<br/>            placeholder={name}<br/>            <strong class="ly hj">onChange={event =&gt; setName(event.target.value)}</strong><br/>          /&gt;<br/>          &lt;/Form.Group&gt;<br/>          &lt;br /&gt;<br/>          &lt;Form.Group controlId="formBasicAge"&gt; <br/>          &lt;Form.Label&gt;Age&lt;/Form.Label&gt;<br/>          &lt;Form.Control<br/>            type="age"<br/>            placeholder={age}<br/>            <strong class="ly hj">onChange={event =&gt; setAge(event.target.value)}</strong><br/>          /&gt;<br/>          &lt;/Form.Group&gt;<br/>          &lt;br /&gt;<br/>          &lt;Button variant="primary" <br/>            <strong class="ly hj">onClick={() =&gt; dispatch(update(name, age))}</strong><br/>          &gt; Submit<br/>          &lt;/Button&gt;{" "}<br/>          &lt;Button variant="danger" <br/>            <strong class="ly hj">onClick={() =&gt; dispatch(remove())}</strong><br/>          &gt;Delete<br/>          &lt;/Button&gt;<br/>          &lt;/Form&gt;<br/>        &lt;/Row&gt;<br/>      &lt;/Card.Body&gt;<br/>    &lt;/Card&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="13d8" class="jx jy hi ly b fi mm mj l mk ml">export default App;</span></pre><p id="7d02" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">在这个组件中，</p><ul class=""><li id="4f55" class="lg lh hi jb b jc jd jg jh ki li km lj kq lk jw ll lm ln lo bi translated">一旦名称字段被更改，它将使用<strong class="jb hj">设置名称</strong>功能自动更改本地<strong class="jb hj">名称</strong>状态。</li><li id="f524" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">一旦年龄字段被更改，它将使用<strong class="jb hj">设置年龄</strong>功能自动更改本地<strong class="jb hj">年龄</strong>状态。</li><li id="1ae8" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">一旦点击提交按钮，它将<strong class="jb hj">分派</strong><strong class="jb hj">用年龄和姓名参数更新</strong>功能。</li><li id="81da" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">一旦点击删除按钮，它将<strong class="jb hj">发送</strong>T21 删除功能。</li></ul><blockquote class="iv iw ix"><p id="7511" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">它不起作用了！！！这是为什么呢？</p></blockquote><p id="7ac0" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后你要把减速器导入的<code class="du lv lw lx ly b">src/index.js</code>换成如下。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="e8cc" class="jx jy hi ly b fi mi mj l mk ml">import reducers from "./reducers/userInfo";</span></pre><p id="b4db" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后应用程序将工作，你可以在这里找到代码<a class="ae iu" href="https://github.com/yashodgayashan/redux-tutorial/tree/objectState" rel="noopener ugc nofollow" target="_blank"/>。</p><blockquote class="iv iw ix"><p id="490e" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">如果我们有多个 reducer 文件会怎样？</p></blockquote><p id="35d4" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">让我们转到 redux 基础知识的最后一部分。如果你有一个以上的 reducer 文件，你必须按照你想要的名字创建一个单独的文件(最好是<code class="du lv lw lx ly b">src/reducers/index.js</code>，按如下方式导入)。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/ef65f978681fed1b668fd90831a62512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t3mCtIyKbQd6AOjfta6jXg.png"/></div></div></figure><p id="6bb9" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后在<code class="du lv lw lx ly b">src/reducers/index.js</code>中，您必须使用组合减速器功能组合这些减速器，如下所示。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="2c79" class="jx jy hi ly b fi mi mj l mk ml">import counterReducer from "./counterReducer";<br/>import userReducer from "./userInfo";<br/>import { combineReducers } from "redux";</span><span id="5026" class="jx jy hi ly b fi mm mj l mk ml">const reducers = <strong class="ly hj">combineReducers({<br/>  counter: counterReducer,<br/>  userInfo: userReducer<br/>});</strong></span><span id="ac9c" class="jx jy hi ly b fi mm mj l mk ml">export default reducers;</span></pre><p id="788c" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">然后在<code class="du lv lw lx ly b">src/index.js</code>中，你必须如下导入减速器。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="8ea2" class="jx jy hi ly b fi mi mj l mk ml">import React from "react";<br/>import ReactDOM from "react-dom";<br/>import "./index.css";<br/>import App from "./App";<br/>import { createStore } from "redux";<br/><strong class="ly hj">import reducers from "./reducers";</strong><br/>import { Provider } from "react-redux";<br/>import "bootstrap/dist/css/bootstrap.min.css";</span><span id="a0ad" class="jx jy hi ly b fi mm mj l mk ml">const store = createStore(<strong class="ly hj">reducers</strong>);</span><span id="8f4f" class="jx jy hi ly b fi mm mj l mk ml">ReactDOM.render(<br/>  &lt;React.StrictMode&gt;<br/>    &lt;Provider store={store}&gt;<br/>      &lt;App /&gt;<br/>    &lt;/Provider&gt;<br/>  &lt;/React.StrictMode&gt;,<br/>  document.getElementById("root")<br/>);</span></pre><p id="2fcb" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">您可以在任何组件中使用这些异径管，如下所示。</p><pre class="lb lc ld le fd me ly mf mg aw mh bi"><span id="1b86" class="jx jy hi ly b fi mi mj l mk ml">const user = useSelector(state =&gt; state.<strong class="ly hj">userInfo</strong>);</span></pre><p id="70dc" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">当访问上例中给出的状态(userInfo)时，记得调用用于合并 reducers 的子名称。</p><p id="a2de" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">您可以在这里找到<a class="ae iu" href="https://github.com/yashodgayashan/redux-tutorial/tree/combine" rel="noopener ugc nofollow" target="_blank">中的示例代码。</a></p></div><div class="ab cl mq mr gp ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="hb hc hd he hf"><h2 id="b726" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">奖金部分</h2><ul class=""><li id="e6e0" class="lg lh hi jb b jc kv jg kw ki lz km ma kq mb jw ll lm ln lo bi translated">在哪里使用 API 调用——在操作中使用 API 调用，并将结果传递给缩减器。</li><li id="69f3" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">请保持 reducers 简单，并使用给定的操作对象值构造状态的函数。</li><li id="b27a" class="lg lh hi jb b jc lp jg lq ki lr km ls kq lt jw ll lm ln lo bi translated">保持单独的动作文件和 reducers 文件，以便于维护。</li></ul><p id="a194" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">希望这是有帮助的。</p><p id="edef" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">如果你觉得这有帮助，请点击那个👏并分享到社交媒体上:)。</p></div></div>    
</body>
</html>