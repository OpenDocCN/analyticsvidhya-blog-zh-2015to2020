<html>
<head>
<title>Combine Image &amp; Tabular data in one Model using PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyTorch在一个模型中组合图像和表格数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/combine-image-tabular-data-in-one-model-using-pytorch-38dfd23c437c?source=collection_archive---------7-----------------------#2020-10-06">https://medium.com/analytics-vidhya/combine-image-tabular-data-in-one-model-using-pytorch-38dfd23c437c?source=collection_archive---------7-----------------------#2020-10-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b4f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的博客将帮助读者了解我们如何使用深度学习在PyTorch中将图像和表格数据结合在一起，并从模型中生成预测。我将一步一步地理解整个端到端场景:→</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3185a788909b38023b25be7e3ff07c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BwvI6fbnNLaUmfbuvY0P-w.jpeg"/></div></div></figure><h2 id="3f62" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">#1#创建自定义数据集类→</h2><p id="84aa" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">这里我将使用<a class="ae kp" href="https://www.kaggle.com/c/stanford-covid-vaccine" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> OpenVaccine:新冠肺炎mRNA疫苗降解预测</strong> </a>数据集。<em class="kq">在清理和处理表格数据</em>之后，我将为我们的数据创建数据集类，如下所示……</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="a986" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于有很多代码和语法，我建议阅读代码时参考每个语法旁边的注释。涉及的步骤有:→</p><ol class=""><li id="a32f" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">首先，我们声明了一些我们将需要的特定库。</li><li id="9306" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">我们将为我们创建的数据集类定义构造函数。</li><li id="a6c4" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">然后我们将定义__len__函数来计算数据集的长度</li><li id="31a4" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">然后我们将定义__getitem__函数，提取输入和目标，我们将把它们输入到我们将要创建的模型中。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/6428f83ab1993dbf8780080d00d0862e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bmu6iVkX-zEKKhvqWdj9ZQ.jpeg"/></div></div></figure><h2 id="7d78" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">#2#为数据集类和数据加载器创建对象→</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kr ks l"/></div></figure><h2 id="a7f5" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">#3#创建模型类→</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="eb2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经尽可能多地评论了代码语法，但是读者<strong class="ih hj">如果你仍然觉得你不能理解代码的任何部分，请请随意评论这篇文章，我将非常乐意回答你的疑问</strong>。</p><p id="cd35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第15行的<strong class="ih hj">中仍然有3个主要语法，21 &amp; 56，我们将表格和图像数据层结合起来，从中生成预测</strong>。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="7576" class="jp jq hi lj b fi ln lo l lp lq">15 self.image_dense_layer_2 = nn.Linear(512, 1) # in constructor </span><span id="a443" class="jp jq hi lj b fi lr lo l lp lq">21 self.tabular_dense_layer_4 = nn.Linear(4, 1) # in constructor</span><span id="4f62" class="jp jq hi lj b fi lr lo l lp lq">56 x = torch.cat((x, tab), dim=1) # in forward function</span></pre><h2 id="93bf" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">#4#为我们的模型定义损失函数、优化器和训练循环。</h2><p id="4a05" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在模型创建后，我们将很容易定义以下内容。</p><p id="ae58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你发现实施起来有困难或者只是在这里提出你的意见，请考虑浏览一下我写的关于这个主题的笔记本。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/bd7411192f5622146d61e67ecda53250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_qF-cGeynZtD-FhMTqLfwg.png"/></div></div></figure><p id="224a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你已经理解了我们如何使用pytorch在深度学习模型中结合图像数据和表格数据背后的逻辑。如果你对此有任何问题、意见或担忧，请在评论区告诉我；在那之前，享受学习的乐趣。</p><p id="a980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多与数据科学相关的博客文章，请查看medium上的顶级数据科学博客。</p><ul class=""><li id="f703" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc lt kz la lb bi translated">拉胡尔·阿加瓦尔</li><li id="5704" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated"><a class="ae kp" href="https://medium.com/u/e2f299e30cb9?source=post_page-----d60c71f00c50--------------------------------" rel="noopener">威尔·科尔森</a></li><li id="09db" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated">卡西·科济尔科夫</li><li id="a360" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated"><a class="ae kp" href="https://medium.com/u/8b7aca3e5b1c?source=post_page-----d60c71f00c50--------------------------------" rel="noopener">丽贝卡·维克里</a></li><li id="6851" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated"><a class="ae kp" href="https://medium.com/u/10c138087717?source=post_page-----d60c71f00c50--------------------------------" rel="noopener">杨致远</a></li><li id="15c9" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated">丹尼尔·伯克</li><li id="16a5" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated"><a class="ae kp" href="https://medium.com/u/44bc27317e6b?source=post_page-----d60c71f00c50--------------------------------" rel="noopener">艾里克·莱文森</a></li><li id="2644" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated"><a class="ae kp" href="https://medium.com/u/5153880ce2ee?source=post_page-----d60c71f00c50--------------------------------" rel="noopener">本杰明·哈迪博士</a></li><li id="bea6" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated"><a class="ae kp" href="https://medium.com/u/fba05660b60f?source=post_page-----d60c71f00c50--------------------------------" rel="noopener"> Moez Ali </a></li><li id="2943" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lt kz la lb bi translated"><a class="ae kp" href="https://medium.com/u/f4a64ff38660?source=post_page-----d60c71f00c50--------------------------------" rel="noopener">彭慧琳</a></li></ul></div></div>    
</body>
</html>