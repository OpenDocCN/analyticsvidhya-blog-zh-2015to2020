<html>
<head>
<title>Sound Tasty? A Data Science Project Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">听起来好吃吗？数据科学项目演练</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sound-tasty-a-project-walkthrough-5be396b15bdb?source=collection_archive---------21-----------------------#2019-10-16">https://medium.com/analytics-vidhya/sound-tasty-a-project-walkthrough-5be396b15bdb?source=collection_archive---------21-----------------------#2019-10-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1d06b258c22a43f6568d07df202e2a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VphIS_3oeeXZQHxJL3EuEg.png"/></div></div></figure><p id="5160" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天我要写一个我做的有趣的项目。不幸的是，我对食物的品味有点有限。我倾向于只吃我知道的东西，这是一个问题，因为如果你愿意尝试的话，外面有太多难以置信的食物了！我们上车吧。</p><p id="2db6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我从识别我想从Allrecipes.com得到的食谱数据开始</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/fd73c6857350dc2a3d465971cbb53406.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4kOSyqFZl_bVnMgascf2dg.png"/></div></div></figure><p id="69fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">搜索了一会儿后，我找不到可以使用的API，所以我研究了网站布局，组装了一个Selenium web驱动程序，用作web-scraper。我设置了我的代码来浏览网站的主要类别url，并从大约前100个食谱中复制标题和配料。以下是网页抓取代码:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="503c" class="jy jz hi ju b fi ka kb l kc kd"># # browser = Chrome()</span><span id="cf3d" class="jy jz hi ju b fi ke kb l kc kd">for url in urls:<br/>#     print(url)<br/>#     browser.get(url)</span><span id="0731" class="jy jz hi ju b fi ke kb l kc kd">#     for _ in range(6):<br/>#         browser.execute_script("window.scrollTo(0,             document.body.scrollHeight);")<br/>#         time.sleep(3 + random.random()*10)</span><span id="3c26" class="jy jz hi ju b fi ke kb l kc kd">#     link_list = browser.find_elements_by_xpath('//*[contains(<a class="ae kf" href="http://twitter.com/class" rel="noopener ugc nofollow" target="_blank">@class</a>,"fixed-recipe-card__info")]/a')</span><span id="3a36" class="jy jz hi ju b fi ke kb l kc kd">#     recipe_page_list = [link.get_attribute('href') for link in link_list]</span><span id="ddf1" class="jy jz hi ju b fi ke kb l kc kd">#     len(recipe_page_list)</span><span id="0c00" class="jy jz hi ju b fi ke kb l kc kd">#     with open('recipes_list.json', 'a') as f:</span><span id="5da1" class="jy jz hi ju b fi ke kb l kc kd">#         for recipe in recipe_page_list:</span><span id="909b" class="jy jz hi ju b fi ke kb l kc kd">#             browser.get(recipe)</span><span id="6468" class="jy jz hi ju b fi ke kb l kc kd">#             recipe_dict = {}<br/>            <br/>#             try:<br/>#                 recipe_dict['title'] = browser.find_element_by_xpath('//*[<a class="ae kf" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="recipe-main-content"]').text<br/>#             except:<br/>#                 recipe_dict['title'] = browser.find_element_by_xpath('//*[contains(<a class="ae kf" href="http://twitter.com/class" rel="noopener ugc nofollow" target="_blank">@class</a>, "intro article-info")]/h1').text<br/>            <br/>#             try:<br/>#                 lala_list = browser.find_elements_by_xpath('//*[contains(<a class="ae kf" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>,"lst_ingred")]')<br/>#                 item_list = []<br/>#                 for element in lala_list:</span><span id="1af9" class="jy jz hi ju b fi ke kb l kc kd">#                     item_list += element.find_elements_by_css_selector('span')</span><span id="e69d" class="jy jz hi ju b fi ke kb l kc kd">#                 ingredients = [item.text for item in item_list[:-1]]<br/>#                 recipe_dict['ingredients'] = ingredients<br/>            <br/>#             except:<br/>#                 lala_list = browser.find_elements_by_xpath('//*[contains(<a class="ae kf" href="http://twitter.com/class" rel="noopener ugc nofollow" target="_blank">@class</a>, "ingredients-item-name")]')</span><span id="d6b5" class="jy jz hi ju b fi ke kb l kc kd">#                 ingredients = [item.text for item in lala_list]<br/>#                 recipe_dict['ingredients'] = ingredients</span><span id="372c" class="jy jz hi ju b fi ke kb l kc kd">#             json.dump(recipe_dict, f)<br/>#             f.write('\n')<br/>#             time.sleep(3 + random.random()*10)</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kg"><img src="../Images/a0af003099b2f474c5a40a9bff66f664.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*PINnqQLDVuz4sDcZw-inOA.png"/></div></figure><p id="2bd8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不得不尝试6次获取我的数据，更新不同格式的旧食谱，以及超时和数据存储问题。这个网络追踪器也被Allrecipes.com的活动追踪器卡住了。我的解决方案是在Selenium实例上安装一个广告拦截器。</p><p id="83c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太好了！现在我有了数据，我计划分解成分词，这样我就可以使用Gensim的word2vec来比较成分词嵌入。所以来打扫卫生！</p><p id="b973" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我从存储数据的JSON文件中加载数据，并将其放入EDA的Pandas数据框中。第一个任务是处理丢失的值，幸运的是，没有那么多。然后我去掉了标点符号。接下来，我必须处理如何在配料中找到有意义的词，以及如何处理停用词和度量。这是我的数据看起来的样子。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="035a" class="jy jz hi ju b fi ka kb l kc kd">['2 pounds unpeeled large shrimp',<br/> '2 tablespoons olive oil',<br/> '1 teaspoon minced garlic',<br/> '1/4 teaspoon salt',<br/> '1/8 teaspoon freshly ground black pepper',<br/> '1 cup cocktail sauce',<br/> '1 lemon, cut into wedges']</span></pre><p id="82e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我这个项目的目标只是绘制出口味，并推荐与你喜欢的口味相似的新食物，所以测量被取消了。至于像“未削皮的大”这样的描述或像“切成楔形”这样的说明，我对我认为有价值的信息做出判断，并删除了其余的信息。为了准备word2vec，我将所有的成分分成剩余成分单词的列表。这给我留下了这样的成分表:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="767c" class="jy jz hi ju b fi ka kb l kc kd">['shrimp',<br/> 'olive',<br/> 'oil',<br/> 'garlic',<br/> 'salt',<br/> 'black',<br/> 'pepper',<br/> 'cocktail',<br/> 'sauce',<br/> 'lemon']</span></pre><p id="5fbb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在的问题是,“橄榄”和“油”被认为是两种不同的成分，而显然它们应该只是一种成分。所以我使用Gensim的短语检测来寻找经常在一起的单词，并将它们作为成分重新加入。虽然不是100%准确，但它确实把我们带到了一个更好的地方，拥有一个“柠檬虾”向量不会改变“柠檬”向量或“虾”向量，所以我认为这是可以接受的。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="f374" class="jy jz hi ju b fi ka kb l kc kd">['sauce',<br/> 'cocktail',<br/> 'salt black garlic',<br/> 'olive oil',<br/> 'pepper',<br/> 'lemon shrimp']</span></pre><p id="d93f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在所有的清理工作之后，我终于有了一个可以用于Gensim的word2vec的数据框</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/99675ea6156003ddf2ee5eca91ad69c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GAud1eTa8jOKrgneFD3fLQ.png"/></div></div></figure><p id="27fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是使用word2vec的相似性比较来查找与用户输入的配料相似的单词，然后构建一个函数来返回具有这些相似配料的食谱。我添加了一个可调按钮，从用户输入的名为“多么冒险”的内容中查找非常相似、不太相似或非常不同的配料</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="c5a5" class="jy jz hi ju b fi ka kb l kc kd">model.wv.most_similar(positive=["cheddar cheese"])</span><span id="94b5" class="jy jz hi ju b fi ke kb l kc kd">[('mushrooms', 0.9990376234054565),<br/> ('beef', 0.9988831281661987),<br/> ('monterey jack', 0.9986639022827148),<br/> ('green chile', 0.9985662698745728),<br/> ('sauce', 0.9985474348068237),<br/> ('green onions', 0.9985294342041016),<br/> ('cheese', 0.9985264539718628),<br/> ('seasoning', 0.9983548521995544),<br/> ('tomato sauce', 0.9983314275741577),<br/> ('cayenne pepper', 0.9981967210769653)]</span></pre><p id="768c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了完成这一切，我提取了数据和word2vec模型，并构建了一个Flask应用程序来在Amazon Ec2实例上运行该项目。</p><p id="7d39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让声音变得美味让我很开心，我很乐意听到反馈或改进的想法！</p></div></div>    
</body>
</html>