<html>
<head>
<title>Introduction to Geocoding &amp; Folium &amp; Python Mapping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">地理编码和地图及 Python 制图简介</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/introduction-to-geocoding-folium-python-mapping-c1d2e69c7564?source=collection_archive---------3-----------------------#2020-12-21">https://medium.com/analytics-vidhya/introduction-to-geocoding-folium-python-mapping-c1d2e69c7564?source=collection_archive---------3-----------------------#2020-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ad11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我认为几乎所有来自创造的每一个动作的数据都有一个空间位置。这些数据可以用于任何目的的工作。所以今天，我们生活在信息时代，我们应该在任何规模的工作中使用数据。</p><p id="11c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有很多方法可以创建、可视化和发布地图。但与专业的桌面应用程序不同，有一些简单的方法可以将我们的数据转化为可视化的展示。我认为创建地图最简单有效的方法之一是使用 Python &amp; follow。</p><p id="6f15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有时我们的数据中没有地址的确切位置。但是我们至少需要纬度和经度来在地图上指定一个唯一的位置。所以有时候我们还需要在制图前进行地理编码。</p><p id="d95f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将:</p><p id="361e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1-将数据框导入 python，</p><p id="3c86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2-对长地址进行地理编码以获得纬度和经度，</p><p id="986d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3-将我们的地址输入到带有“叶子”的网络地图中，</p><p id="aa06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4-根据我们在地图上的点创建基于密度的热图。</p><p id="f835" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5-保存我们的地图为 HTML 文件。</p><p id="8b06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最好的学习方法是实践。所以在你自己的电脑上休耕这个过程，如图所示。你需要 Jupyter 笔记本和给定链接中的文件。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="c48b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要如下一些包；</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="99a6" class="jt ju hi jp b fi jv jw l jx jy">import folium<br/>from folium import plugins<br/>from folium.plugins import HeatMap<br/>import os<br/>import geopy<br/>import json</span></pre><p id="5511" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们导入所有我们需要的包后，我们应该打开里面的数据和地理编码地址。我们需要 geopy 的命名模块。在我们定义了我们的地理编码器之后，我们需要循环遍历每个名字并获得纬度和经度变量。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="d6ec" class="jt ju hi jp b fi jv jw l jx jy">geocoder = Nominatim(user_agent= <strong class="jp hj"><em class="jz">specify a valid user agent here</em></strong>)<br/>county = pd.read_excel("countynames.xlsx")<br/>geocodes = []<br/>names = []<br/>for i in country["<strong class="jp hj"><em class="jz">column name here</em></strong>"]:<br/>    names.append(i)</span><span id="e026" class="jt ju hi jp b fi ka jw l jx jy">for i in names: <br/>    address = geocoder.geocode(i)<br/>    geocodes.append(address)</span></pre><p id="5fea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们对地址进行地理编码时，它会返回地址的许多属性，如下所示:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="e4c0" class="jt ju hi jp b fi jv jw l jx jy">stanford  = geocoder.geocode("stanford")<br/>print(stanford)</span></pre><blockquote class="kb kc kd"><p id="2b40" class="if ig jz ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">位置(美国加利福尼亚州圣克拉拉县帕洛阿尔托市斯坦福，(37.426540700000004，-122.42545475467</p></blockquote><p id="0630" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是在这个对象中，我们此刻只需要纬度和经度。所以我们将遍历 geocodes 列表，并从每个对象返回 lat &amp; long 变量。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="ad85" class="jt ju hi jp b fi jv jw l jx jy">codes = []<br/>for i in geocodes:<br/>    lat = i.latitude<br/>    longt = i.longitude<br/>    codes.append([lat,longt])</span></pre><p id="9495" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">纬度和经度变量在里面。纬度和。经度属性，所以我们为每个对象解析这两个属性，并将它们保存到代码列表中。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="68da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在我们有了每个县名的纬度和经度。是时候将这些变量添加到地图中了。在本教程中，我们将使用 leav 来创建地图。所以我们可以用叶子定义一个地图。地图方法。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="d17e" class="jt ju hi jp b fi jv jw l jx jy">istanbul = folium.Map(location=[41.033044, 28.744614], zoom_start=9)</span></pre><p id="6964" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一行代码创建了一个 web 地图，它以给定的缩放比例指向指定的位置。当我们有了地图，我们可以在地图上添加标记、线条、多边形、图标甚至图像。在本教程中，我们将添加一些我们已经地理编码的点。</p><figure class="jk jl jm jn fd ki er es paragraph-image"><div class="er es kh"><img src="../Images/a6cbb3280bf9217963bab7ec18b8b74c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*IOb_kpAGas1Q4NMbOLCYjQ.png"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">不带对象的叶子图。</figcaption></figure><p id="3ef4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们在地图上添加更多的点。我们将使用之前生成的 latlong 变量，并将它们推入到 leav 中。标记()</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="e03f" class="jt ju hi jp b fi jv jw l jx jy">for i in latlong:<br/>    folium.Marker(location= i).add_to(istanbul)</span></pre><p id="06be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这段代码将遍历每个对象并获取长整型变量。然后它会在地图上添加一个标记。这是执行最后一行后的地图:</p><figure class="jk jl jm jn fd ki er es paragraph-image"><div class="er es kp"><img src="../Images/2ea5237eeb1d05c536719eb16fa373bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*7xCn28QbteF2RADMqcruBA.png"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">对于每个县的名称，geopy 都检测到了准确的县位置。</figcaption></figure><blockquote class="kb kc kd"><p id="02ce" class="if ig jz ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">您可以在这里查看不同风格的标记:<a class="ae kq" href="https://georgetsilva.github.io/posts/mapping-points-with-folium/" rel="noopener ugc nofollow" target="_blank">https://George Silva . github . io/posts/mapping-points-with-folio/</a></p></blockquote></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="a9a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们从我们的点创建一个热图。对于这种分析，我们的数据可能不是最好的，但热图目前非常受欢迎。所以你可以把这个应用到你的工作中，用于不同的目的。</p><p id="3ac3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于热图，我们使用的是</p><p id="4527" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建热图非常简单，如图所示。但是，您可以深入研究并发现许多其他关于热图、可视化的功能。</p><p id="3311" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要创建热图:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="0bea" class="jt ju hi jp b fi jv jw l jx jy">HeatMap(latlong, radius = 50).add_to(istanbul)</span></pre><p id="cc72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了保存我们的地图:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="3b28" class="jt ju hi jp b fi jv jw l jx jy">istanbul.save("istanbul-counties")</span></pre><p id="f47a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是最终结果:</p><figure class="jk jl jm jn fd ki er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kr"><img src="../Images/303ec419a549d3ac9c6ed458ee2d0eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCRVlCKWG_Y0016y7WVr2w.png"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">我们的点数分布以及与分布相关的热图</figcaption></figure><p id="ebfb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅此而已！在这个简短的介绍之后，您应该亲自尝试一下，您会发现 leav 中有更多的特性。</p></div></div>    
</body>
</html>