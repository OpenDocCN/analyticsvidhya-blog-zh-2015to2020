<html>
<head>
<title>Recommendation System for Anime Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动漫数据推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/recommendation-system-for-anime-data-784c78952ba5?source=collection_archive---------11-----------------------#2020-08-09">https://medium.com/analytics-vidhya/recommendation-system-for-anime-data-784c78952ba5?source=collection_archive---------11-----------------------#2020-08-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f424" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单，tfidf矢量器和计数矢量器推荐系统，适合初学者。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="79cd" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">目标</h1><p id="762b" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">推荐系统在许多行业中被广泛用于向顾客推荐商品。例如，广播电台可以使用推荐系统来创建本月的前100首歌曲以推荐给观众，或者他们可以使用推荐系统来识别观众已经请求的相似风格的歌曲。基于推荐系统在业界的广泛应用，我们将为动漫数据创建一个推荐系统。如果动漫爱好者每次走进动漫商店或收到基于他们喜欢的类型推荐动漫的电子邮件时，都能看到前100部动漫的更新，那就太好了。</p><p id="7ab8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">利用<a class="ae kn" href="https://www.kaggle.com/CooperUnion/anime-recommendations-database" rel="noopener ugc nofollow" target="_blank">动漫数据</a>，我们将应用两种不同的推荐系统模型:简单推荐系统和基于内容的推荐系统来分析动漫数据并创建推荐。</p><h1 id="6038" class="jk jl hi bd jm jn ko jp jq jr kp jt ju jv kq jx jy jz kr kb kc kd ks kf kg kh bi translated">概观</h1><p id="9e37" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">对于简单的推荐系统，我们需要计算加权评分，以确保不同票数的相同分数的评分具有不同的权重。例如，来自10个人的9.0的平均评级将比来自1000个人的9.0的平均评级具有更低的权重。在我们计算出加权评分后，我们可以看到一个排行榜动画。</p><p id="952c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于基于内容的推荐系统，我们需要确定哪些特征将被用作分析的一部分。我们将应用sklearn <strong class="ih hj"> </strong>来识别上下文中的相似性，并创建动漫建议。</p><h1 id="c278" class="jk jl hi bd jm jn ko jp jq jr kp jt ju jv kq jx jy jz kr kb kc kd ks kf kg kh bi translated">数据概述</h1><p id="4804" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">根据我们现有的动漫数据，总共有12，294部动漫的7种不同类型的数据，包括anime_id、名称、流派、类型、剧集、评级和成员。</p><h1 id="0596" class="jk jl hi bd jm jn ko jp jq jr kp jt ju jv kq jx jy jz kr kb kc kd ks kf kg kh bi translated">履行</h1><p id="dfbe" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated"><strong class="ih hj"> 1。导入数据</strong></p><p id="492c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要导入熊猫，因为让我们把数据很好地放入dataframe格式。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0417" class="lc jl hi ky b fi ld le l lf lg">import pandas as pd<br/>anime = pd.read_csv('…/anime.csv')<br/>anime.head(5)</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es lh"><img src="../Images/fdebf8b861697713a138340b038a6e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ayl8bIrD5ivx8qpCNBID-Q.png"/></div></div></figure><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0486" class="lc jl hi ky b fi ld le l lf lg">anime.info()</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es lp"><img src="../Images/852491e2d18a3717345bf5decb56fbed.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*53gDL9afX2x3cHJ18WBnVQ.png"/></div></figure><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f7c5" class="lc jl hi ky b fi ld le l lf lg">anime.describe()</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es lq"><img src="../Images/81f6fe5a3dd03e24656be5ca88277213.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*-zkpR0fbtsH6tE3DcKQwog.png"/></div></figure><p id="ff66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，最低评级得分为1.67，最高评级得分为10。最小成员数为5，最大成员数为1，013，917。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2b99" class="lc jl hi ky b fi ld le l lf lg">anime_dup = anime[anime.duplicated()]<br/>print(anime_dup)</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es lr"><img src="../Images/52456728aa4d72829f2bf2791eb06450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*nlvZbvrGWWea-gqDLs8ikg.png"/></div></figure><p id="0765" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">没有需要清理的重复数据。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="cdde" class="lc jl hi ky b fi ld le l lf lg">type_values = anime['type'].value_counts()<br/>print(type_values)</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es ls"><img src="../Images/038af76fc1f2d3fafb6004c11474f9a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*gjSORWHQE8gpZkO27hhZ0A.png"/></div></figure><p id="ffb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数动漫都是电视播放的，其次是OVA。</p><p id="1ba4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。简单推荐系统</strong></p><p id="f7ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要知道加权评级(WR)的计算方法。</p><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es lt"><img src="../Images/eac7f10c5d9ae84efd1fe41c6b8cbd1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*uRzzYvW-UBtn5dn86R--Tw.png"/></div></figure><p id="52fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">v是该动漫的投票数；m是在图表中列出所需的最低票数；r是该动漫的平均评分；c是整个报告的平均票数。</p><p id="f142" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要确定这次计算将使用哪些数据。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="72ad" class="lc jl hi ky b fi ld le l lf lg">m = anime['members'].quantile(0.75)<br/>print(m)</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es lu"><img src="../Images/78616a5eea2c13d32005680701a0729e.png" data-original-src="https://miro.medium.com/v2/resize:fit:128/format:webp/1*WZ8J8jS1o7iqTdlsnHiq1A.png"/></div></figure><p id="1d27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据结果，我们将使用那些拥有超过9，437个成员的数据来创建推荐系统。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="1957" class="lc jl hi ky b fi ld le l lf lg">qualified_anime = anime.copy().loc[anime['members']&gt;m]<br/>C = anime['rating'].mean()</span><span id="e3d1" class="lc jl hi ky b fi lv le l lf lg">def WR(x,C=C, m=m):<br/>    v = x['members']<br/>    R = x['rating']<br/>    return (v/(v+m)*R)+(m/(v+m)*C)</span><span id="f5f2" class="lc jl hi ky b fi lv le l lf lg">qualified_anime['score'] = WR(qualified_anime)<br/>qualified_anime.sort_values('score', ascending =False)<br/>qualified_anime.head(15)</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es lw"><img src="../Images/6853fcb9a5cb590b064729f1f04e6907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OiHkRb4-q8WBj4Lm69WInQ.png"/></div></div></figure><p id="435d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是基于加权评分计算的前15名动漫名单。</p><p id="a8a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。基于流派的推荐系统</strong></p><p id="096d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于基于体裁的推荐，我们将使用sklearn软件包来帮助我们分析文本上下文。我们需要计算流派的相似度。我们将要使用的两个方法是TfidfVectorizer和CountVectorizer。</p><p id="3028" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在TfidfVectorizer中，它根据单词在所有文档中出现的频率来计算单词的频率。而CountVectorizer更简单，它只计算单词出现的次数。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="9db6" class="lc jl hi ky b fi ld le l lf lg">from sklearn.feature_extraction.text import TfidfVectorizer</span><span id="929d" class="lc jl hi ky b fi lv le l lf lg">tf_idf = TfidfVectorizer(lowercase=True, stop_words = 'english')<br/>anime['genre'] = anime['genre'].fillna('')<br/>tf_idf_matrix = tf_idf.fit_transform(anime['genre'])</span><span id="5938" class="lc jl hi ky b fi lv le l lf lg">tf_idf_matrix.shape</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es lx"><img src="../Images/db723881fb2f30981c3e8997e5a5526b.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/format:webp/1*7MLQuGapuxAIoNFItr03OA.png"/></div></figure><p id="b260" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到12294部动漫中有46个不同的词。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="76a5" class="lc jl hi ky b fi ld le l lf lg">from sklearn.metrics.pairwise import linear_kernel</span><span id="d4ff" class="lc jl hi ky b fi lv le l lf lg">cosine_sim = linear_kernel(tf_idf_matrix, tf_idf_matrix)<br/>indices = pd.Series(anime.index, index=anime['name'])<br/>indices = indices.drop_duplicates()</span><span id="289b" class="lc jl hi ky b fi lv le l lf lg">def recommendations (name, cosine_sim = cosine_sim):<br/>    similarity_scores = list(enumerate(cosine_sim[indices[name]]))<br/>    similarity_scores = sorted(similarity_scores, key=lambda x: x[1], reverse=True)<br/>    similarity_scores = similarity_scores[1:21]<br/>    anime_indices = [i[0] for i in similarity_scores]<br/>    return anime['name'].iloc[anime_indices]</span><span id="240d" class="lc jl hi ky b fi lv le l lf lg">recommendations('Kimi no Na wa.')</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es ly"><img src="../Images/a001cb41fa60a351765f81c1fff23a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*qofHe3dNOb42aWRVj0fHpA.png"/></div></figure><p id="01a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于TF-IDF的计算，这是前20名的动漫推荐，类似于基米no Na wa..</p><p id="4343" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将看看另一个模型，CountVectorizer()，我们将比较余弦相似度和线性核之间的结果。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="4b4d" class="lc jl hi ky b fi ld le l lf lg">from sklearn.feature_extraction.text import CountVectorizer<br/>from sklearn.metrics.pairwise import cosine_similarity</span><span id="72b9" class="lc jl hi ky b fi lv le l lf lg">count = CountVectorizer(stop_words = 'english')<br/>count_matrix = count.fit_transform(anime['genre'])<br/>cosine_sim2 = cosine_similarity(count_matrix, count_matrix)</span><span id="d527" class="lc jl hi ky b fi lv le l lf lg">recommendations('Kimi no Na wa.', cosine_sim2)</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es lz"><img src="../Images/0bfc9fd314cfb94e677e00af6d16077b.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*p8nLbZ1227ntPXYg0uF8OA.png"/></div></figure><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="146e" class="lc jl hi ky b fi ld le l lf lg">cosine_sim2 = linear_kernel(count_matrix, count_matrix)<br/>recommendations('Kimi no Na wa.', cosine_sim2)</span></pre><figure class="kt ku kv kw fd li er es paragraph-image"><div class="er es ma"><img src="../Images/6e94b164f4ca09cb739257f021a2eaf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*oIvsnP6GOpSG7m2AdSEWTA.png"/></div></figure><p id="2f07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">总结</strong></p><p id="11a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我们研究了动漫数据，并试图建立两种类型的推荐系统。简单的推荐系统让我们看到了排行榜动漫。我们通过对投票和成员数量进行加权评分计算来实现这一点。然后，我们继续构建基于动漫类型特征的推荐系统。在这种情况下，我们应用TfidfVectorizer和CountVectorizer来查看它们的推荐之间的差异。</p><p id="9134" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢这篇文章！</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="d708" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考文献</strong></p><p id="6f83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.<a class="ae kn" href="https://www.datacamp.com/community/tutorials/recommender-systems-python" rel="noopener ugc nofollow" target="_blank">https://www . data camp . com/community/tutorials/recommender-systems-python</a></p></div></div>    
</body>
</html>