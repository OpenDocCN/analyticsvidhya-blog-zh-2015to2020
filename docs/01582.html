<html>
<head>
<title>Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">回归模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/regression-model-e3ecc0823857?source=collection_archive---------8-----------------------#2019-11-01">https://medium.com/analytics-vidhya/regression-model-e3ecc0823857?source=collection_archive---------8-----------------------#2019-11-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/479c17d77bf5d816d11687f031e3a4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gN7XHMjXRApd7nJmhtPh7A.jpeg"/></div></figure><p id="17e2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我们将看到如何在Python中构建回归模型。首先，让我们谈谈回归分析实际上意味着什么..</p><p id="f86e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="jk">回归分析</em> </strong>关注因变量与一个或多个自变量之间的关系，而<strong class="io hj"> <em class="jk">线性回归</em> </strong>只关注两个变量之间的关系。</p><p id="874c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看一元线性回归和多元线性回归的方程。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jl"><img src="../Images/32138368f65a75092742086e33b2e85f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTS2KOsAAV9suSz2ZP7-8A.png"/></div></div></figure><p id="6b84" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里，y是因变量，xi是自变量。b0是截距或常数，当所有自变量都设置为零时，定义为因变量的平均值。</p><p id="cd26" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将应用多元线性回归的概念来预测健康保险费用。让我们看看用python构建模型的步骤。</p><p id="0ebd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">1)导入python库</p><p id="7bf1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2)导入数据</p><p id="f819" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3)缺失值处理</p><p id="8bd1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">4)类别变量的虚拟创建</p><p id="2181" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">5)选择变量的相关性</p><p id="f7a8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">6)数据分割(训练和测试)</p><p id="d4d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">7)建立模型</p><p id="2f55" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">8)递减分析和误差测试</p><p id="007f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您将在这里看到的数据是<strong class="io hj"> <em class="jk">健康保险成本</em> </strong>。建立该模型的主要目的是预测健康保险的成本，同时考虑一些因素。所以，没有任何进一步的拖延，让我们开始吧。</p><p id="6544" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数据有7列:</p><ol class=""><li id="1b72" class="ju jv hi io b ip iq it iu ix jw jb jx jf jy jj jz ka kb kc bi translated">年龄:主要受益人的年龄。</li><li id="3a82" class="ju jv hi io b ip kd it ke ix kf jb kg jf kh jj jz ka kb kc bi translated">性别:性别</li><li id="6bf3" class="ju jv hi io b ip kd it ke ix kf jb kg jf kh jj jz ka kb kc bi translated">身体质量指数:身体质量指数</li><li id="1fbd" class="ju jv hi io b ip kd it ke ix kf jb kg jf kh jj jz ka kb kc bi translated">儿童:健康保险覆盖的儿童人数/受抚养人人数</li><li id="911f" class="ju jv hi io b ip kd it ke ix kf jb kg jf kh jj jz ka kb kc bi translated">吸烟者</li><li id="14d6" class="ju jv hi io b ip kd it ke ix kf jb kg jf kh jj jz ka kb kc bi translated">地区:受益人在美国的居住区，东北，东南，西南，西北</li><li id="d26a" class="ju jv hi io b ip kd it ke ix kf jb kg jf kh jj jz ka kb kc bi translated">费用:由健康保险支付的个人医疗费用</li></ol><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/cd08705d308681b7f9b45034701d8b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*5KU6dyjB5Kh4F_Cw7rg44g.jpeg"/></div></figure><p id="6dbd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">需要导入的重要Python库有:</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/05d94044b64581a194442430cb1c643a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*Pu2PBzLJmwzMtE4UTgGXiw.png"/></div></figure><p id="9385" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们导入健康保险费用数据，并查看数据。下图显示了前五行数据。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/8b9ac3b54b03e7b6afb1e6c6568c66b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*-S4XAQFXIjc3XhMGf0Ie6w.png"/></div></figure><p id="f7b4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们的下一步将是探索数据。我们需要看看是否需要进行缺失值处理或异常值处理。幸运的是，我们这里没有任何缺失值，我们的数据是干净的。</p><p id="9483" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们看看可以从这些数据中得出的可视化结果。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/c02405762dd2996d872d99b9f140d876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*sxuVqdbbdCAoBoncAaNL2w.png"/></div></figure><p id="136e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上图显示了男性和女性的总保险费用。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es km"><img src="../Images/ba5bf33a7cd137f182568b997769ffae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dd843vAWjD-fMprXeqVv2A.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated"><strong class="bd kr">各地区吸烟人数</strong></figcaption></figure><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/4b9ccd01a4590160c780bef5c2b6bf11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*Air8gJyxNGD_UGWpjbiFcA.png"/></div></figure><p id="617d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上图显示男性吸烟者比女性吸烟者多。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es km"><img src="../Images/0f42cd7c5cd4f798686b80243145a671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9uLSSO_2UfpgH7IhxSdPA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">这些是对吸烟者和非吸烟者的收费。</figcaption></figure><p id="3f44" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们将看到18岁男性和女性吸烟者的人数。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es km"><img src="../Images/a400415f08d846d78c902cccf120513a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KWUp-rM-RzhfX9AK5edd0A.png"/></div></div></figure><p id="f555" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">令人惊讶的是，我们看到18岁也有吸烟习惯。</p><p id="fd6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们有一栏是关于人们有多少孩子的。所以，让我们看看分布。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/b4de0eaaa03bd12e9810a7e6f25a0f9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*CaYiOqFFsoRAIeess3ILdQ.png"/></div></figure><p id="6c91" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到只有少数人有5个孩子，许多人没有孩子。</p><p id="2cc7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们看看数据的另一个重要栏目，那就是<strong class="io hj"> <em class="jk">【身体质量指数】</em> </strong>。嗯，身体质量指数低于18.5的人被称为<em class="jk">体重过轻</em>。18.5到24.9之间的身体质量指数是理想的。在25到29.9之间的一个<strong class="io hj">身体质量指数</strong>是<em class="jk">超重</em>和一个超过30的<strong class="io hj">身体质量指数</strong>表明<em class="jk">肥胖</em>。</p><p id="5832" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下图显示了对患有不同身体质量指数病和有吸烟习惯的人收取的费用。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/3e3e1f23bddb88eef07dafa79a8a7401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*5-rVBmqP6DQX10pDyduexQ.png"/></div></figure><p id="67dc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们来看看有吸烟习惯的人的数量，他们属于身体质量指数的不同类别。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es km"><img src="../Images/7a57a3584188a7a1b58f842f5d850a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wNnEH5RdJ5ZybKsxjd4sPA.png"/></div></div></figure><p id="06e4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们观察到，与任何其他类别相比，超重类别中吸烟者的人数更多。</p><p id="7cd4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们已经将数据可视化到最大程度，是时候构建模型了。我们首先制作分类变量的虚拟模型。当假人被制作时，分类变量看起来像这样:</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/4db0587c2d4e002781706a88075abef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*MiHW-J9EeWUucLjxM93p1A.jpeg"/></div></figure><p id="fe9c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在把数字变量串联起来之后，我们得到了最终的数据。看起来像这样:</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kw"><img src="../Images/ed3b8cbe28c09af645c21f591f8a4881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Ew2N_0KQ12G0Bl7dplwzA.jpeg"/></div></div></figure><p id="2240" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在来看多元线性回归的定义。这里我们的“Y”是<em class="jk">费用</em>，因为我们需要预测保险费用和其他代表自变量的列(“xi”)。我们在这里取Y的对数，以便得到正态分布曲线。在构建模型时，我们将数据分为测试数据和训练数据。这意味着我们将70%的数据作为训练数据，30%作为测试数据。</p><p id="e618" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">分割数据后，我们需要添加常数(b0 ),正如多元线性回归的定义所说。完成这些后，我们拟合我们的模型并得到<strong class="io hj"> <em class="jk">【普通最小二乘法】</em> </strong>回归结果。这里的变量较少，因为与其他变量相比，这些变量的特征重要性较高。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kx"><img src="../Images/6b987fe7f499d426f48c8f37fae2ad31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yu2N2Wtu9Uf6rUcBg0p86A.png"/></div></div></figure><p id="3449" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们检查数据中的错误。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/fda50e2c057b1d69d130ca6ccfdfdcad.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*MQTvqsx_zQPt7fZhTitkug.jpeg"/></div></figure><p id="e5f3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">平均绝对误差</p><p id="0ee8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">MSE:均方差</p><p id="3932" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">RMSE:均方根误差</p><p id="cdef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于训练数据，我们得到:</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/eeee57ef40c87ef2b8aab9bea13e3b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*oHz13T2ZGr0JT_skYCZD6w.jpeg"/></div></figure><p id="d4c4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于测试数据，我们得到:</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es la"><img src="../Images/6302118898c09f7039893efc51fce354.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*H6ZJZCExuM92KO5N_Tq8TQ.jpeg"/></div></figure><p id="7ce1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果训练数据的均方误差小于测试数据的均方误差，我们就说模型过拟合。</p><p id="c0ec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，我们的模型既不过度拟合也不欠拟合，可用于预测保险成本。</p><p id="8155" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们已经从OLS回归结果中得到xi系数。因此，我们需要把它放入等式中，以便预测保险成本。</p><p id="2ddd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="jk">例如:</em> </strong></p><p id="d930" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于35岁有吸烟习惯且身体质量指数为24岁的人，健康保险费用为:</p><p id="3ef2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">y = B0+(coef _ age)*年龄+(coef _ BMI)* BMI+(coef _ smoker _ yes)*吸烟者</p><p id="d513" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解完方程后，我们得到的值是23784。因此，这将是上述人员的健康保险费用。同样，我们可以得到其他人的数量。</p><p id="6e74" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，这就是如何使用<strong class="io hj"> <em class="jk">多元回归模型</em> </strong>进行预测。</p><p id="8df3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢阅读:)</p></div></div>    
</body>
</html>