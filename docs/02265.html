<html>
<head>
<title>Firebase ML- Kit, a quick overview</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Firebase ML- Kit，快速概述</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/firebase-ml-kit-a-quick-overview-eba352583927?source=collection_archive---------14-----------------------#2019-12-08">https://medium.com/analytics-vidhya/firebase-ml-kit-a-quick-overview-eba352583927?source=collection_archive---------14-----------------------#2019-12-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="94fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以在学习了如何在Firebase上存储、检索和操作数据或媒体之后，你可能会想你还能做什么？一件显而易见的事情是，您可以使用Firebase轻松控制身份验证。在学习了这类东西大约4个月后，并在该设计上设计了相当多的应用程序，我开始探索一些其他的Firebase特性，最明显的一个是<strong class="ih hj"> ML- kit </strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/6f67b21ce0af27cf892e5362d193ae59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbav_Qw-HHIBJXP1yRETdA.png"/></div></div></figure><blockquote class="jp jq jr"><p id="7753" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated"><em class="hi"> ML Kit可以让你为你的应用程序带来强大的机器学习功能，无论是针对Android还是iOS，无论你是一名经验丰富的机器学习开发者还是刚刚入门。</em></p></blockquote><p id="1a50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ML工具包提供了许多容易定义的ML模型(我们将在本文中讨论)，此外，您可以定义自己的模型，Firebase可以托管这些模型。ML Kit提供了设备上和云API，所有这些都在一个通用而简单的界面中，用于常见的移动用例:识别文本、检测人脸、扫描条形码、标记图像和识别地标。所有这些功能都可以通过几行代码实现。</p><p id="ccc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将了解所有这些功能的基本概述，以及如何快速将其应用到您的android应用中。但首先你需要给你的android应用添加Firebase，如果你不知道怎么做，那么参考<a class="ae jw" href="https://firebase.google.com/docs/android/setup" rel="noopener ugc nofollow" target="_blank">这个</a>。此外，在注册应用程序时，请务必提供SHA1。你可以通过在你的android studio中生成一份签名报告来快速完成这项工作，或者只需按照这些<a class="ae jw" href="https://www.truiton.com/2015/04/obtaining-sha1-fingerprint-android-keystore/" rel="noopener ugc nofollow" target="_blank">指令</a>进行操作。</p><h2 id="d7bc" class="jx jy hi bd jz ka kb kc kd ke kf kg kh iq ki kj kk iu kl km kn iy ko kp kq kr bi translated">1 .<strong class="ak">文本识别- </strong></h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/21685c24b0f60febaed8f04588d93877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*26OQpHevQ4bcUqDkJNkOXA.png"/></div></div></figure><p id="169a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文本识别用于从图像中提取文本。换句话说，它可以用来检测任何基于拉丁语的语言中的文本。<strong class="ih hj">图像可以是位图、byteBuffer或byte[]。在本文中，我将坚持使用位图图像作为所有引用。</strong></p><p id="2e01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先在应用级build.gradle中添加以下依赖项</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="6b36" class="jx jy hi ku b fi ky kz l la lb">implementation 'com.google.firebase:firebase-ml-vision:24.0.1'</span></pre><p id="c89f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将讨论几个在实现其他功能时有用的基本术语。</p><p id="7b83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以首先我们从图像的位图开始。然后我们初始化一个<strong class="ih hj"> FirebaseVisionImage </strong>对象，在构造函数中传递图像的位图。<strong class="ih hj"> FirebaseVisionImage </strong>表示一个图像对象，可以用于设备上和云API检测器。现在我们使用<strong class="ih hj">FirebaseVisionTextRecognizer</strong>来处理图像，这是一种设备上或云文本识别器，可以识别图像中的文本。我们在<strong class="ih hj">FirebaseVisionTextRecognizer</strong>上调用process Image，它将<strong class="ih hj"> firebaseVisionImage </strong>作为参数。然后我们使用一个<strong class="ih hj"> onSuccess </strong>监听器来检查检测何时完成，这是因为<strong class="ih hj"> processImage </strong>是异步的。如果成功，我们可以访问一个<strong class="ih hj"> FirebaseVisionText </strong>对象，它包含在图像中找到的文本。下面是必要的代码片段。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="543a" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">val bitmap = MediaStore.Images.Media.getBitmap(this.contentResolver, contentURI)<br/>val </strong>firebaseVisionImage = FirebaseVisionImage.fromBitmap(bitmap)<br/><strong class="ku hj">val </strong>textRecognizer = FirebaseVision.getInstance().<em class="js">onDeviceTextRecognizer<br/></em>textRecognizer.processImage(firebaseVisionImage)<br/>    .addOnSuccessListener<strong class="ku hj">{<br/>        //If successful an object of FirebaseVisionText will be    //returned which contains all the text found in the image.</strong><br/>    <strong class="ku hj">}<br/><br/>    </strong>.addOnFailureListener<strong class="ku hj">{  }</strong></span></pre><p id="350e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成之后，我们可以处理<strong class="ih hj">firebasevisiontext</strong>对象来提取其中的文本。<strong class="ih hj"> FirebaseVisionText </strong>有两个属性</p><ol class=""><li id="cb72" class="lc ld hi ih b ii ij im in iq le iu lf iy lg jc lh li lj lk bi translated">getText():返回图像中识别的所有文本的单个字符串。</li><li id="90ec" class="lc ld hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated">getTextBlocks():返回一个类型为<strong class="ih hj"> FirebaseVisionText </strong>的列表。<strong class="ih hj">文本块</strong>，图像中识别的文本块，即一组或一段文本。我们可以在文本块中使用一个<strong class="ih hj"> getText() </strong>方法来获取该块中的所有文本。我们还有一个名为<strong class="ih hj"> getLines() </strong>的方法，它返回一个对象类型列表<strong class="ih hj"> FirebaseVisionText </strong>。<strong class="ih hj">行，</strong>即文本块中的一行文本。与block类似，<strong class="ih hj"> FirebaseVisionText </strong>。<strong class="ih hj">行</strong>包含一个<strong class="ih hj"> getText </strong>()方法，它返回一行中的所有文本，以及<strong class="ih hj"> getElements </strong>()方法，它基本上返回一行中所有单词的列表。</li></ol><p id="6e4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是参考资料中链接的codelab中的一段代码，它解释了如何从text block对象中提取文本。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="ef27" class="jx jy hi ku b fi ky kz l la lb">private void processTextRecognitionResult(FirebaseVisionText texts) {<br/>        List&lt;FirebaseVisionText.TextBlock&gt; blocks = texts.getTextBlocks();<br/>        if (blocks.size() == 0) {<br/>            Toast.makeText(this,"No text", Toast.LENGTH_SHORT).show()<br/>            return;<br/>        }<br/>        for (int i = 0; i &lt; blocks.size(); i++) {<br/>            List&lt;FirebaseVisionText.Line&gt; lines = blocks.get(i).getLines();<br/>            for (int j = 0; j &lt; lines.size(); j++) {<br/>                List&lt;FirebaseVisionText.Element&gt; elements = lines.get(j).getElements();<br/>                for (int k = 0; k &lt; elements.size(); k++) {<br/>                    //We can now print the words or highlight it.<br/>                }<br/>            }<br/>        }<br/>    }</span></pre><p id="ec4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就这样，你已经成功地在你的android应用程序中实现了文本识别。以下是您必须查阅的资源列表</p><p id="0295" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(一)<a class="ae jw" href="https://www.youtube.com/watch?v=_qrI1JUCMjI" rel="noopener ugc nofollow" target="_blank">由仁人发射</a></p><p id="bc62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(ii) <a class="ae jw" href="https://gist.github.com/Kartik2301/b34c6b27643298484316d6245bc3a7dd" rel="noopener ugc nofollow" target="_blank">这里的</a>是一个github要点，来自我为了实现上述功能而创建的一个简单的android应用。此外，我还提供了上述应用程序的<a class="ae jw" href="https://github.com/Kartik2301/ML-Kit-" rel="noopener ugc nofollow" target="_blank">链接</a>，您可以导入并运行该链接以获得更好的理解，该应用程序非常简单，不包含高端用户界面，它只有足够的代码来实现核心功能</p><p id="297f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(三)<a class="ae jw" href="https://codelabs.developers.google.com/codelabs/mlkit-android/index.html#5" rel="noopener ugc nofollow" target="_blank"> Codelab </a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/48dba8aa0dac7e17addacac952889824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hEKGT9_Uas72UbrAr3p50w.jpeg"/></div></div></figure><h2 id="c9a5" class="jx jy hi bd jz ka kb kc kd ke kf kg kh iq ki kj kk iu kl km kn iy ko kp kq kr bi translated">2.人脸检测</h2><p id="9640" class="pw-post-body-paragraph if ig hi ih b ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">使用ML Kit的人脸检测API，您可以检测图像中的人脸，识别关键的面部特征，并获得检测到的人脸的轮廓。因为ML Kit可以实时执行人脸检测，所以您可以在视频聊天或游戏等响应玩家表情的应用程序中使用它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/d907e29b9f84ab8c310d44fd9c230ec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RJk3wvIKKiQqg5kUAbOQaA@2x.png"/></div></div></figure><p id="02e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要一个图像(在我们的例子中是位图格式)..首先，在应用级build.gradle中添加以下依赖项</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="53da" class="jx jy hi ku b fi ky kz l la lb">implementation 'com.google.firebase:firebase-ml-vision:24.0.1'<br/>implementation 'com.google.firebase:firebase-ml-vision-face-model:19.0.0'</span></pre><p id="a10d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先如上所述创建<strong class="ih hj"> FirebaseVisionImage </strong>对象，并在构造函数中传递图像的位图。为了处理图像，我们创建了一个对象<strong class="ih hj">firebasevisionfaceedetector。然后我们调用<strong class="ih hj">firebasevisionfaceedetector</strong>对象上的detection方法，将图像位图作为参数传递。然后，我们使用一个<strong class="ih hj"> onSuccess </strong>监听器来检查检测何时完成，这是因为<strong class="ih hj"> detectInImage </strong>是异步的。如果面部识别操作成功，一列<strong class="ih hj"> FirebaseVisionFace </strong>对象将被传递给成功监听器。每个<strong class="ih hj"> FirebaseVisionFace </strong>对象代表在图像中检测到的一张脸。对于每个面部，您可以获得其在输入图像中的边界坐标，以及您配置面部检测器查找的任何其他信息。下面是一些代码片段。</strong></p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="7300" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">val bitmap = MediaStore.Images.Media.getBitmap(this.contentResolver, contentURI)<br/>val </strong>firebaseVisionImage = FirebaseVisionImage.fromBitmap(bitmap)<br/><strong class="ku hj">val </strong>faceDetector = FirebaseVision.getInstance().<em class="js">visionFaceDetector<br/></em>faceDetector.detectInImage(firebaseVisionImage)<br/>    .addOnSuccessListener<strong class="ku hj">{<br/>        //do something</strong><br/>    <strong class="ku hj">}<br/>    </strong>.addOnFailureListener<strong class="ku hj">{<br/><br/>    }</strong></span></pre><p id="c63c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个<strong class="ih hj"> FirebaseVisionFace </strong>对象提供了几个组件的坐标，如左眼、右眼、鼻梁、左右耳等。这些组件被称为地标。此外，该对象还返回一些事件的概率或置信度，如人在微笑，左眼睁开，右眼睁开。您可以访问任何地标，例如:</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="f77e" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">for</strong>(face <strong class="ku hj">in </strong>faces!!){<br/><strong class="ku hj">val </strong>rightEye = face.getLandmark(FirebaseVisionFaceLandmark.<em class="js">RIGHT_EYE</em>)!!<br/><strong class="ku hj">val </strong>smilingProbability = face.<em class="js">smilingProbability<br/></em><strong class="ku hj">val </strong>left_eye_open_probability = face.<em class="js">leftEyeOpenProbability<br/></em><strong class="ku hj">val </strong>right_eye_open_probability = face.<em class="js">rightEyeOpenProbability<br/>}</em></span></pre><p id="e4ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在将人脸检测应用于图像之前，如果您想要更改人脸检测器的任何默认设置，请使用<strong class="ih hj">firebasevisionfaceteditoroptions</strong>对象指定这些设置。举个例子，</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="5afe" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">// High-accuracy landmark detection and face classification<br/></strong>val highAccuracyOpts = FirebaseVisionFaceDetectorOptions.Builder()<br/>        .setPerformanceMode(FirebaseVisionFaceDetectorOptions.ACCURATE)<br/>        .setLandmarkMode(FirebaseVisionFaceDetectorOptions.ALL_LANDMARKS)<br/>        .setClassificationMode(FirebaseVisionFaceDetectorOptions.ALL_CLASSIFICATIONS)<br/>        .build()<br/><br/><strong class="ku hj">// Real-time contour detection of multiple faces<br/></strong>val realTimeOpts = FirebaseVisionFaceDetectorOptions.Builder()<br/>        .setContourMode(FirebaseVisionFaceDetectorOptions.ALL_CONTOURS)<br/>        .build()</span></pre><p id="375c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，当我们定义自定义选项时，我们可以如下初始化<strong class="ih hj">firebasevisionfaceedetector</strong></p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="3af8" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">val </strong>faceDetector = FirebaseVision.getInstance().getVisionFaceDetector(highAccuracyOpts)</span></pre><p id="99ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样，有了这么多代码你就可以实现核心功能了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/d7eb8041fd0d2dbe9ab92d2e2aa29b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IrBaUTyvfNpCFxuVwAiX8A.png"/></div></div></figure><p id="6266" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个应用程序的截图样本，因为<strong class="ih hj"> FirebaseVisionFaceDetector，</strong>提供了一个<strong class="ih hj"> FirebaseVisionFaces </strong>的列表，因此我们也可以使用包含多人的照片。</p><p id="3192" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">资源:</p><p id="d9d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(一)<a class="ae jw" href="https://firebase.google.com/docs/ml-kit/android/detect-faces" rel="noopener ugc nofollow" target="_blank">正式文件</a></p><p id="7738" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(二)<a class="ae jw" href="https://gist.github.com/Kartik2301/1856b4439b8723aba583598184f13995" rel="noopener ugc nofollow" target="_blank"> Github要点</a>，<a class="ae jw" href="https://github.com/Kartik2301/ML-Kit-" rel="noopener ugc nofollow" target="_blank">链接</a>到项目</p><h2 id="11e2" class="jx jy hi bd jz ka kb kc kd ke kf kg kh iq ki kj kk iu kl km kn iy ko kp kq kr bi translated">3.扫描条形码</h2><blockquote class="jp jq jr"><p id="7a23" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">借助ML Kit的条形码扫描API，您可以读取使用大多数标准条形码格式编码的数据。条形码扫描在设备上进行，不需要网络连接。</p><p id="6811" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">条形码是一种将信息从现实世界传递到你的应用程序的便捷方式。特别是，当使用2D格式(如QR码)时，您可以对结构化数据(如联系信息或WiFi网络凭据)进行编码。因为ML Kit可以自动识别和解析这些数据，所以当用户扫描条形码时，您的应用程序可以智能地做出响应。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/0c7e17354951ce182b0f7e661a71afc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MRHb2a9iaghBPRwR-qOh8g@2x.png"/></div></div></figure><p id="65d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">条形码扫描相对简单，首先添加所需的依赖项</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="8e2b" class="jx jy hi ku b fi ky kz l la lb">implementation 'com.google.firebase:firebase-ml-vision:24.0.1'<br/>implementation 'com.google.firebase:firebase-ml-vision-barcode-model:16.0.1'</span></pre><p id="5db3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在像往常一样创建一个<strong class="ih hj"> FirebaseVisionImage </strong>的对象，并在构造函数中传递图像的位图。现在，为了处理图像中的条形码，我们首先创建一个对象<strong class="ih hj">FirebaseVisionBarcodeDetector，</strong>，然后我们可以在这个对象上调用<strong class="ih hj"> detectInImage() </strong>，并将<strong class="ih hj"> FirebaseVisionImage </strong>的对象作为参数传递。然后，我们使用一个<strong class="ih hj"> onSuccess </strong>监听器来检查检测何时完成，这是因为<strong class="ih hj">检测图像</strong>是异步的。下面是所需的代码片段。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="fca1" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">val bitmap = MediaStore.Images.Media.getBitmap(this.contentResolver, contentURI)<br/>val </strong>firebaseVisionImage = FirebaseVisionImage.fromBitmap(bitmap)<br/><strong class="ku hj">val </strong>barcodeDetector = FirebaseVision.getInstance().<em class="js">visionBarcodeDetector<br/></em>barcodeDetector.detectInImage(firebaseVisionImage)<br/>    .addOnSuccessListener<strong class="ku hj">{<br/>        //Do something</strong><br/>    <strong class="ku hj">}<br/>    </strong>.addOnFailureListener<strong class="ku hj">{<br/><br/>    }</strong></span></pre><p id="5d28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果条形码识别操作成功，一列<strong class="ih hj"> FirebaseVisionBarcode </strong>对象将被传递给成功监听器。每个<strong class="ih hj"> FirebaseVisionBarcode </strong>对象代表一个在图像中检测到的条形码。对于每个条形码，您可以获得它在输入图像中的边界坐标，以及由条形码编码的原始数据。此外，如果条形码检测器能够确定条形码编码的数据类型，您可以获得包含解析数据的对象。</p><p id="468e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以如下处理数据</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="9eb2" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">for</strong>(barcode <strong class="ku hj">in </strong>barcodes!!){<br/>    canvas.drawRect(barcode.<em class="js">boundingBox</em>!!,rectPaint)<br/>    <strong class="ku hj">val </strong>valueType = barcode.<em class="js">valueType<br/>    </em><strong class="ku hj">when</strong>(valueType){<br/>        FirebaseVisionBarcode.<em class="js">TYPE_WIFI </em>-&gt; {<br/>            <strong class="ku hj">val </strong>ssid = barcode.<em class="js">wifi</em>!!.<em class="js">ssid<br/>            </em><strong class="ku hj">val </strong>password = barcode.<em class="js">wifi</em>!!.<em class="js">password<br/>            </em><strong class="ku hj">val </strong>type = barcode.<em class="js">wifi</em>!!.<em class="js">encryptionType</em><br/>        }<br/>        FirebaseVisionBarcode.<em class="js">TYPE_URL </em>-&gt; {<br/>            <strong class="ku hj">val </strong>title = barcode.<em class="js">url</em>!!.<em class="js">title<br/>            </em><strong class="ku hj">val </strong>url = barcode.<em class="js">url</em>!!.<em class="js">url</em><br/>        <strong class="ku hj">}<br/>      </strong>}<br/>    }<br/>}</span></pre><p id="7f85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以获得包含在原始格式的条形码中的全部信息，如下所示，</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="dab4" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">val </strong>barcode_raw = barcode.<em class="js">rawValue</em></span></pre><p id="57e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">资源:</p><p id="effb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(一)<a class="ae jw" href="https://firebase.google.com/docs/ml-kit/android/read-barcodes" rel="noopener ugc nofollow" target="_blank">正式文件</a></p><p id="cfde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(二)<a class="ae jw" href="https://gist.github.com/Kartik2301/48d6b5a1d8bef9d9a92d123a8a9b098a" rel="noopener ugc nofollow" target="_blank"> Github要点</a>，<a class="ae jw" href="https://github.com/Kartik2301/ML-Kit-" rel="noopener ugc nofollow" target="_blank">链接</a>到项目</p><h2 id="e00d" class="jx jy hi bd jz ka kb kc kd ke kf kg kh iq ki kj kk iu kl km kn iy ko kp kq kr bi translated">4.标记图像</h2><blockquote class="jp jq jr"><p id="859c" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">图像标签让您深入了解图像的内容。当您使用API时，您会得到一个已识别实体的列表:人、事物、地点、活动等等。找到的每个标签都有一个分数，表明ML模型对其相关性的信心。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/3f122325dcc0fdb1dd55f36fc034ab6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDcsaBA_Su1XFGDCs53quw@2x.png"/></div></div></figure><p id="9d50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ML- Kit提供了基于onDevice和cloude的图像标签API。onDevice API不需要互联网，速度非常快。另一方面，基于云的API需要互联网，并且比onDevice API包含更多的标签，因此更加精确。</p><p id="61c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们讨论onDevice API，首先添加以下依赖项</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="783c" class="jx jy hi ku b fi ky kz l la lb">implementation 'com.google.firebase:firebase-ml-vision:24.0.1'<br/>implementation 'com.google.firebase:firebase-ml-vision-image-label-model:19.0.0'</span></pre><p id="a7e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">延续长久以来的传统，你首先需要获得图像的位图，并将其传递给<strong class="ih hj"> FirebaseVisionImage </strong>对象的构造函数。现在，为了给图像加标签，我们首先创建一个对象<strong class="ih hj"> FirebaseVisionImageLabeler，</strong>，然后我们可以对这个对象执行<strong class="ih hj"> processImage() </strong>，并将对象<strong class="ih hj"> FirebaseVisionImage </strong>作为参数传递。然后我们使用一个<strong class="ih hj"> onSuccess </strong>监听器来检查检测何时完成，这是因为<strong class="ih hj"> processImage() </strong>是异步的。下面是所需的代码片段。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="6de4" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">val bitmap = MediaStore.Images.Media.getBitmap(this.contentResolver, contentURI)<br/>val </strong>firebaseVisionImage = FirebaseVisionImage.fromBitmap(bitmap)<br/><strong class="ku hj">val </strong>options = FirebaseVisionOnDeviceImageLabelerOptions.Builder()<br/>    .setConfidenceThreshold(0.7F)<br/>    .build()<br/><strong class="ku hj">val </strong>labelDetector = FirebaseVision.getInstance().getOnDeviceImageLabeler(options)<br/>labelDetector.processImage(firebaseVisionImage)<br/>    .addOnSuccessListener<strong class="ku hj">{<br/>       //Do something</strong><br/>    <strong class="ku hj">}<br/>    </strong>.addOnFailureListener<strong class="ku hj">{<br/>    }</strong></span></pre><p id="98a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，你可以看到我们已经用<strong class="ih hj">firebasevisiondeviceimagelabeleoptions object</strong>定制了一些设置。比如说—</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="7ceb" class="jx jy hi ku b fi ky kz l la lb"> val options = FirebaseVisionOnDeviceImageLabelerOptions.Builder()<br/>     .setConfidenceThreshold(0.7f)<br/>     .build()</span></pre><p id="8e68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果标记成功，将返回一个列表<strong class="ih hj">FirebaseVisionImageLabel</strong>，该列表中的每个对象包含2个组件标签名和置信度值(浮点型)。以下是显示数据提取的片段:</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="35b6" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">private fun </strong>labelImage(labels: List&lt;FirebaseVisionImageLabel&gt;?, image: Bitmap?){<br/>    <strong class="ku hj">for</strong>(label <strong class="ku hj">in </strong>labels!!){<br/>        <strong class="ku hj">val name = </strong>label.<em class="js">text<br/>        val confidence = </em>label.<em class="js">confidence</em><br/>   }<br/>}</span></pre><p id="dae6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您可以将所有标签存储在一个ArrayList中，并使用ListView和适配器显示它，就像我在示例应用程序中所做的那样。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/217088d2b86d963850ef5ffb451f454d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FCIkqIUmvT9At40qlpDTHw.jpeg"/></div></div></figure><p id="25b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">资源:</p><p id="d233" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正式文件</p><p id="cff6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(二)<a class="ae jw" href="https://gist.github.com/Kartik2301/c9efbf8123a05383c2f65959cf43a2f3" rel="noopener ugc nofollow" target="_blank"> Github Gist </a>，<a class="ae jw" href="https://github.com/Kartik2301/ML-Kit-" rel="noopener ugc nofollow" target="_blank">链接</a>到项目</p><h2 id="8322" class="jx jy hi bd jz ka kb kc kd ke kf kg kh iq ki kj kk iu kl km kn iy ko kp kq kr bi translated">5.地标识别</h2><blockquote class="jp jq jr"><p id="69f3" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">使用ML Kit的地标识别API，您可以识别图像中众所周知的地标。当您将一个图像传递给这个API时，您将获得其中识别的地标，以及每个地标的地理坐标和该地标所在的图像区域。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/1d170a26733b7d644b2e015bc4e6d8e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AbAu-zNE90tm2a1YT4T1vw@2x.png"/></div></div></figure><p id="0498" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们开始之前，您必须知道该API是基于云的，onDevice版本不可用，因此该功能很可能在免费计划中不可用，即Firebase中的Spark计划，它在Flame计划或Blaze计划等付费计划中可用。请参考此处的了解firebase的定价。因此，即使你做了所有正确的事情，但仍然没有看到任何产出，也不要灰心，这可能是由于这个原因。所有其他功能都包含在免费星火计划中。</p><p id="9318" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从添加依赖项开始</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="c1c4" class="jx jy hi ku b fi ky kz l la lb">implementation 'com.google.firebase:firebase-ml-vision:24.0.1'</span></pre><p id="70dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你知道是怎么回事了，</p><p id="4533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个<strong class="ih hj"> FirebaseVisionImage </strong>的对象，并在构造函数中传递图像的位图。现在为了处理图像，我们首先创建一个对象<strong class="ih hj">firebasevisioncloudlandmark detector，</strong>，然后我们可以在这个对象上调用<strong class="ih hj"> detectInImage() </strong>方法，并将<strong class="ih hj"> FirebaseVisionImage </strong>的对象作为参数传递。然后我们使用一个<strong class="ih hj"> onSuccess </strong>监听器来检查检测何时完成，这是因为<strong class="ih hj">detection image</strong>是异步的。下面是所需的代码片段-</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="7b7e" class="jx jy hi ku b fi ky kz l la lb"><strong class="ku hj">val bitmap = MediaStore.Images.Media.getBitmap(this.contentResolver, contentURI)<br/>val </strong>firebaseVisionImage = FirebaseVisionImage.fromBitmap(bitmap)<br/><strong class="ku hj">val </strong>landmarkDetector = FirebaseVision.getInstance().<em class="js">visionCloudLandmarkDetector<br/></em>landmarkDetector.detectInImage(firebaseVisionImage)<br/>    .addOnSuccessListener<strong class="ku hj">{<br/>       //Do something<br/></strong> <strong class="ku hj">}<br/>    </strong>.addOnFailureListener <strong class="ku hj">{ <br/>        <br/>    }</strong></span></pre><p id="50d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果地标识别操作成功，一列<strong class="ih hj">FirebaseVisionCloudLandmark</strong>对象将被传递给成功监听器。每个<strong class="ih hj">FirebaseVisionCloudLandmark</strong>对象代表在图像中检测到的地标。对于每个地标，您可以获得其名称、地理坐标、边界多边形和相关的置信度得分。以下是提取地标数据的示例</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="d4f8" class="jx jy hi ku b fi ky kz l la lb">for (landmark in firebaseVisionCloudLandmarks) {<br/><br/>    val bounds = landmark.boundingBox<br/>    val landmarkName = landmark.landmark<br/>    val entityId = landmark.entityId<br/>    val confidence = landmark.confidence<br/><br/>    for (loc in landmark.locations) {<br/>        val latitude = loc.latitude<br/>        val longitude = loc.longitude<br/>    }<br/>}</span></pre><p id="9d28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我没有任何截图可以附上，因为像你们中的许多人一样，我使用基本免费计划，但正如你所看到的，它的实现基本上是相同的。</p><p id="6f67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">资源</p><p id="ed53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(一)<a class="ae jw" href="https://firebase.google.com/docs/ml-kit/android/recognize-landmarks" rel="noopener ugc nofollow" target="_blank">正式文件</a></p><p id="9b9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，我们现在完成了，唷！这很长，但我希望它不难理解。因此，我们基本上讨论了Firebase提供的默认ML模型可以实现的所有功能，随着您学习或继续学习神经网络和其他概念，您将获得设计自己的模型的技能，Firebase有能力托管它们。在我离开之前，还有一点很重要，在本文中，我们一直使用设备图库(或文件存储)中的可用图像，但是我们也可以配置这些功能来处理移动摄像机拍摄的实时图片，这是因为我们在此讨论的所有firebase探测器都是实时工作的。</p><p id="7a12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">感谢阅读</strong></p><p id="dc8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢这篇文章。</p><p id="4118" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关于我:</strong>我是来自IIIT阿拉哈巴德的大二Android开发人员Kartik Nema</p></div></div>    
</body>
</html>