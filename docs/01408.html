<html>
<head>
<title>Data Imputation and One-hot Encoding with a Readymade Function to impute in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的现成函数进行数据插补和一键编码</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-imputation-and-one-hot-encoding-with-a-ready-to-made-function-to-impute-in-python-aadb790d1259?source=collection_archive---------6-----------------------#2019-10-20">https://medium.com/analytics-vidhya/data-imputation-and-one-hot-encoding-with-a-ready-to-made-function-to-impute-in-python-aadb790d1259?source=collection_archive---------6-----------------------#2019-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0a38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据处理的第一步是处理缺失值。在本文中，我将讨论一个处理熊猫数据框中所有缺失值的简单函数。缺失值的处理称为数据插补。python代码以粗体显示</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="647c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">空值百分比</strong></h1><p id="4cbc" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">首先，让我们检查您的数据中丢失值的百分比</p><p id="c174" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果<strong class="ih hj">“df</strong>是您的数据帧，请查找下面的代码，以找出您的数据集中缺失值的数量和缺失值的百分比。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="393a" class="kw jl hi ks b fi kx ky l kz la"><strong class="ks hj">countofnulls = df.isnull().sum().sum()</strong></span><span id="2c6b" class="kw jl hi ks b fi lb ky l kz la"><strong class="ks hj">print(“countofnulls is”,countofnulls)</strong></span><span id="ce6e" class="kw jl hi ks b fi lb ky l kz la"><strong class="ks hj">#Percentage of nulls <br/>totalelements = df.count().sum()</strong></span><span id="48b1" class="kw jl hi ks b fi lb ky l kz la"><strong class="ks hj">percentageofnulls=(countofnulls*100/totalelements)</strong></span><span id="51a6" class="kw jl hi ks b fi lb ky l kz la"><strong class="ks hj">print(“percentageofnulls is”,percentageofnulls)</strong></span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h2 id="0774" class="kw jl hi bd jm lc ld le jq lf lg lh ju iq li lj jy iu lk ll kc iy lm ln kg lo bi translated"><strong class="ak">替换缺失值的策略:</strong></h2><p id="9ff7" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">现在让我们思考一下，我们可以用什么来代替缺失的值。对于分类变量，我们可以用最常出现的值或众数来代替，对于数值变量，我们可以用数据的中位数来代替。从统计学上来说，中位数比平均数更容易处理异常值。</p><p id="4753" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了区分分类列和数值列，我们需要首先找到给定数据框“df”的所有分类列和数值列。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="c0a9" class="kw jl hi ks b fi kx ky l kz la"><strong class="ks hj">#First we will find numerical columns and delete from the whole set to get categorical columns <br/>num_cols = df._get_numeric_data().columns<br/>categorical_columns=list(set(df.columns) — set(num_cols))<br/>print(“categorical_columns are”,categorical_columns)</strong></span></pre><p id="082d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将在下面的函数中使用这些分类和数字列来替换丢失的值。</p><h2 id="3b39" class="kw jl hi bd jm lc ld le jq lf lg lh ju iq li lj jy iu lk ll kc iy lm ln kg lo bi translated"><strong class="ak">用模式(分类)或中位数估算的函数:</strong></h2><p id="43f2" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">下面的函数采用输入数据集“df ”,并使用分类列的mode和数字列的median估算所有缺失值。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="1a24" class="kw jl hi ks b fi kx ky l kz la"><strong class="ks hj">def PP_impute_with_medianormode (df):<br/> """Iterate through columns of Pandas DataFrame.<br/> Where NaNs exist ,<br/> For numerical columns replace with median,<br/> For categorical columns replace with mode"""<br/>    import pandas as pd<br/>    import numpy as np<br/>    num_cols = df._get_numeric_data().columns<br/>    categorical_columns=list(set(df.columns) - set(num_cols))<br/>    print("categorical_columns are",categorical_columns)<br/>     <br/>     # Get list of DataFrame column names<br/>     cols = list(df)<br/>     # Loop through columns<br/>     for column in cols:<br/>     # Transfer column to independent series<br/>     col_data = df[column]<br/>     # Look to see if there is any missing numerical data<br/>     <br/>     missing_data = sum(col_data.isna())<br/>     if missing_data &gt; 0:<br/>     if(column in categorical_columns): #For categorical columns replace with mode<br/>     #col_mode=col_data.mode()<br/>     col_mode=col_data.value_counts().index[0]<br/>     print("Categorical column is '%s' and its mode is '%s'"%(column,col_mode))<br/>     <br/>     col_data.fillna(col_mode, inplace=True)<br/>     #col_data.replace('NaN',col_mode,inplace=True)<br/>     df[column] = col_data<br/>     else:<br/>     # Get median and replace missing numerical data with median<br/>     col_median = col_data.median()<br/>     print("Numerical column is '%s' and its median is '%s'"%(column,col_median))<br/>     col_data.fillna(col_median, inplace=True)<br/>     df[column] = col_data<br/>     return df</strong></span></pre><h1 id="8952" class="jk jl hi bd jm jn lp jp jq jr lq jt ju jv lr jx jy jz ls kb kc kd lt kf kg kh bi translated"><strong class="ak">调用上述函数</strong></h1><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="3ed3" class="kw jl hi ks b fi kx ky l kz la"><strong class="ks hj">dfimputed = impute_with_medianormode(df)<br/>#dfimputed is your imputed dataframe</strong></span></pre><p id="eeb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果不需要知道分类列的模式，可以注释掉打印命令。dfimputed是对缺失值进行估算的数据集。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="d7f6" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">对估算分类列进行热编码:</strong></h1><p id="80d9" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">如果你给出一个字符串作为特征，你的分类器或回归器会出错，因为它不懂英语。我们必须将分类特征转换成分类器或回归器能够理解的语言，即转换成数字。一种热门编码是将具有m个可能值的分类列转换成m个二元特征列。这里有一个例子:</p><figure class="kn ko kp kq fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lu"><img src="../Images/6d7a2ff06377c93ea261afaf4ba2d37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aPjqlQDKdTL38t6b.png"/></div></div></figure><p id="4572" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上图中，我们将文本或字符串的分类列性别转换为3个不同的二进制列。</p><p id="5313" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以使用内置的pandas命令pd.get_dummies()轻松地对估算数据帧进行热编码，如下所示:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="50d6" class="kw jl hi ks b fi kx ky l kz la"><strong class="ks hj">dfonehotencoded= pd.get_dummies(dfimputed, prefix_sep=”_”,<br/> columns=categorical_columns)</strong></span></pre><p id="6f6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您的数据集已经准备好传递给分类器或回归器。</p><p id="2b66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您阅读本文。请在下面留下你对我的文章的想法和评论。</p></div></div>    
</body>
</html>