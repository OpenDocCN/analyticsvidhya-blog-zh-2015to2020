<html>
<head>
<title>Keras Vs PyTorch Dilemma</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Keras Vs PyTorch困境</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/keras-vs-pytorch-dilemma-dc434e5b5ae0?source=collection_archive---------8-----------------------#2020-05-05">https://medium.com/analytics-vidhya/keras-vs-pytorch-dilemma-dc434e5b5ae0?source=collection_archive---------8-----------------------#2020-05-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8a6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选哪个？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2380494eeddf4f47a9d6d4ab08b508f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KO6T9mqm3iEgUUL3QVEYA.png"/></div></div></figure><p id="08be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以你决定学习深度学习，但还有一个问题是要学习哪些工具。深度学习有很多框架或者库。在本文中，我将比较两个库Keras和Pytorch，因为我认为这两个库是很好的开始。因为他们学习曲线低。初学者可以很容易地学会它们。在这篇文章中，我将分享一种处理这种困境的方法，以及如何选择一种方法。</p><p id="aefd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择一种并感觉良好的最好方法是浏览一下每种框架编码风格。开发任何解决方案时，首要的是您的工具。在开始任何项目之前，你必须正确地设置你的工具，一旦你开始了项目，你就不应该继续改变你的工具。会影响你的生产力。作为一个初学者，你应该尝试不同的工具并找到适合自己的工具，但是当你在做一个严肃的项目时，这些事情应该提前计划好。</p><p id="b885" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每天都有新的框架和工具进入市场。对你来说最好的工具是在定制和抽象之间提供平衡的工具。工具应该与你的思维和编码风格同步。那么如何找到适合自己的工具呢？为此，你必须尝试不同的工具。</p><p id="6f23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用Keras和PyTorch来训练一个简单的模型。如果你是深度学习的新手，不能理解一些概念，不要担心。现在，只需关注框架中的编码风格，并尝试想象哪一种最适合你。这样你会很舒服，也很容易适应。</p><p id="b6e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两者的主要区别在于PyTorch默认处于eager模式，而Keras工作在TensorFlow和其他框架之上。但现在它主要与TensorFlow一起使用。默认情况下，这是在图形模式下。TensorFlow的最新版本提供了类似PyTorch的急切模式，但速度较慢。如果您熟悉NumPy，那么您可以将PyTorch视为具有GPU支持的NumPy。有各种各样的具有高级API的库，比如Keras在后端使用PyTorch。比如:Fastai(也免费提供很棒的讲座，一定要去看看)、Lightning、Ignite等。也看看这些。如果你觉得它们很有趣，那么你会有更多的理由选择PyTorch。</p><p id="61d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这两个框架中有不同的方法来实现模型。让我们来看看这两个框架中的一个简单实现。我会提供谷歌Colab的链接。打开它们，试验代码。这也会帮助你找到最适合你的。</p><p id="919c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不会说得太详细，因为我们的目的是看看代码的结构，并对这两个框架的风格略知一二。</p><h1 id="ab82" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Keras中的模型实现</h1><p id="188a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">下面是数字识别的实现。代码很容易理解。您必须检查colab并试验代码。至少自己跑一趟。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/89c1c336d9c093f7329fb5e9a8056f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqceUCfiQcVRT3Lda0IZnA.png"/></div></div></figure><p id="925e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Keras附带了一些样本数据集。MNIST数字数据集就是其中之一。上面的代码将加载数据。图像采用NumPy数组格式。它还做了一些图像预处理，为我们的模型准备好数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/50970081a025003c0f99b76d68aec04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ws4gTlTD8lJ2DzkTc788aA.png"/></div></div></figure><p id="5d5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的代码描述了我们的模型。在Keras(TensorFlow)中，我们必须首先定义我们想要使用的东西，然后立即运行它们。我们不能当场不做实验，但是我们可以在PyTorch做。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/2ad10a1e8cd4b536177a07652af65c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nU48Mox8DImDWhMGQd9caQ.png"/></div></div></figure><p id="a4bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述代码将开始训练和评估模型。我们可以使用<em class="kv"> save() </em>方法保存模型，稍后使用<em class="kv"> load_model() </em>方法加载它。<em class="kv">使用predict() </em>方法得到测试数据上的输出。</p><p id="ecde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这给了我们一个Keras基本模型实现的概述。现在让我们来看看PyTorch。</p><h1 id="6b8c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">PyTorch中的模型实现</h1><p id="2359" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">研究人员大多使用PyTorch，因为它的灵活性和实验性的编码风格。您可以在PyTorch中调整任何内容。你将拥有完全的控制权。随着控制而来的是责任:)。实验在其中很容易。因为您不必首先定义所有内容，然后运行它。我们可以很容易地测试一个步骤。因此它比Keras更容易调试。让我们看看一个简单的数字识别模型的实现。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/3d27060c74f01a9a3d289e03cfd97a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*DbhyTls6ZDbs1MoF18So-Q.png"/></div></figure><p id="b004" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面这段代码导入了所需的库并定义了一些变量。你看到的变量有<em class="kv"> n_epochs </em>，<em class="kv">动量</em>，<em class="kv">，</em>等等。是超参数，我们必须设置它们。这里就不细说了。我们的目的是理解代码的结构。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/ee07b92dfb2698b1c3b37f8b08f1f52f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDFfn149CPn-WkIA6ub85Q.png"/></div></div></figure><p id="84fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述代码用于声明数据加载器，这些数据加载器用于为训练批量加载数据。有各种方法下载数据，它不是特定于框架的。如果你刚刚开始深度学习，上面的代码可能看起来很复杂。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/49105f29b0e70bca8f2fafb72b1164f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*37DQ56GG8O8K7W1Lb21W0g.png"/></div></div></figure><p id="4c60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们已经定义了我们的模型。这是创建网络一般方式。我们扩展<em class="kv"> nn。模块</em>。在正向传递期间调用<em class="kv"> forward() </em>方法。PyTorch的实现非常简单，可以根据需要进行调整。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/a69ed18dd1f8d5d8d4c92b69c7c776c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kU7JHIVgelV-VqZ2OG4U_A.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es la"><img src="../Images/f2c88d87d3cd379250b8217fb574f5f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FkxAtVI3wEnLnIqshrI5xQ.png"/></div></div></figure><p id="85e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面这段代码中，我们定义了我们的训练和测试函数。在Keras中，我们调用<em class="kv"> fit() </em>方法，一切都为我们完成了。但是在PyTorch中，我们必须手动完成这些步骤。像Fastai这样的高级API库使它变得简单，并且需要更少的代码来训练。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lb"><img src="../Images/d6ee586d772cd31a1f50323219a0267c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fOqmmb066plXMcnqDIQUHw.png"/></div></div></figure><p id="7b33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后保存并加载模型，用于再次训练或预测。这部分没有太大变化。PyTorch型号通常具有延伸pt或pth。</p><h1 id="2560" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我个人的建议</h1><p id="e0fd" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">如果你学习了一种模式并理解了它的概念，那么从一种模式转换到另一种模式并不困难。这是几天的工作。我给你的建议是你应该两者都学。但是你不需要深入学习这两者。您应该从一个框架开始，并在该框架中编写您的模型，但是您还应该了解另一个框架。因为它会帮助你阅读别人在另一个框架中的代码。你永远不要被你的框架所束缚。虽然两者都很好。我从Keras开始。现在我在工作中使用PyTorch。因为PyTorch适合实验作品。我喜欢PyTorch的pythonic风格。从你认为适合你的人开始，然后试着再学一个。如果你找到另一个更舒服的，那就赶紧去。因为PyTorch和Keras的大部分核心概念都差不多。从PyTorch到Keras或Keras到PyTorch的过渡很容易。</p><p id="1fbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">祝你的深度学习之旅好运。把你的注意力更多地放在概念上，以及它们在现实世界中是如何使用和实现的。</p><p id="b212" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Colab链接:</p><ul class=""><li id="a073" class="lc ld hi ih b ii ij im in iq le iu lf iy lg jc lh li lj lk bi translated"><a class="ae ll" href="https://colab.research.google.com/drive/1irYr0byhK6XZrImiY4nt9wX0fRp3c9mx?usp=sharing" rel="noopener ugc nofollow" target="_blank">使用PyTorch进行数字识别</a></li><li id="9a9d" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated"><a class="ae ll" href="https://colab.research.google.com/drive/1QH6VOY_uOqZ6wjxP0K8anBAXmI0AwQCm?usp=sharing" rel="noopener ugc nofollow" target="_blank">使用Keras进行数字识别</a></li></ul><h1 id="879b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">快乐学习！！！</h1><div class="lr ls ez fb lt lu"><a href="https://www.linkedin.com/in/karan-jakhar/" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hj fi z dy lz ea eb ma ed ef hh bi translated">Karan Jakhar -数据科学家-改造系统| LinkedIn</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">查看Karan Jakhar在全球最大的职业社区LinkedIn上的个人资料。Karan有3份工作列在他们的…</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">www.linkedin.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi jn lu"/></div></div></a></div></div></div>    
</body>
</html>