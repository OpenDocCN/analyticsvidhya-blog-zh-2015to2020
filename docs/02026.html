<html>
<head>
<title>Using Neural Networks To Detect Diabetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用神经网络检测糖尿病</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-neural-networks-to-detect-diabetes-d01976f0e966?source=collection_archive---------19-----------------------#2019-11-26">https://medium.com/analytics-vidhya/using-neural-networks-to-detect-diabetes-d01976f0e966?source=collection_archive---------19-----------------------#2019-11-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c9bf2672ece20868e4453a58515ee235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9RUjLTo3ktoCY0K-"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@kateredfern?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯特</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="d8e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">简介:<br/> </strong>正如我们所知，神经网络是计算机科学史上发现的最<br/>高级形式的计算模型。那么是什么让它与其他计算模型如此不同呢？</p><p id="236e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于它能够检测数据中未被发现的模式，只需要很少的特征工程，并且能够作出最可能的决定，它被认为是现代数据爱好者的武器。</p><p id="39f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在制作机器学习模型时，任何制作模型的人主要关心的是以这样一种方式使数据适合模型，即当应用于外部数据时，它以最小的误差幅度给我们最好的准确性。</p><p id="beaf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，为了展示神经网络的实现，我们将使用Keras库，因为它具有用户友好的特性。我们今天要用的数据集来自Kaggle。</p><blockquote class="jt ju jv"><p id="ad94" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">让我们开始:<br/> </strong>每当我们制作机器学习模型时，我们总是遵循这些步骤:<br/> 1 .设置目标<br/> 1 .获取数据<br/> 2 .探索并可视化数据<br/> 3 .从数据中消除不一致<br/> 4 .初始化型号<br/> 5。在模型<br/> 6上训练我们的数据。测试模型的准确性，如果(准确性低于预期)<br/>那么我们对模型和数据进行一些更改，然后重新评估模型。</p></blockquote><h2 id="6c56" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">目的:确定患者是否患有糖尿病</h2><p id="3b72" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">获取数据:<a class="ae iu" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database/" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/UC IML/pima-Indians-diabetes-database/</a><br/>我们使用pandas将数据加载到jupyter笔记本中，看到数据的头部。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/9baa8836447ddf11136d52b4bfc9ff06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kkm5Hf8G14mclfch0bco2g.png"/></div></div></figure><p id="01d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的数据探索中，我们可以得到以下关于属性的信息。</p><p id="b6d0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">怀孕</strong>:怀孕次数<br/> <strong class="ix hj">血糖</strong>:口服葡萄糖耐量试验2小时血糖浓度<br/> <strong class="ix hj">血压</strong>:舒张压(毫米汞柱)<br/> <strong class="ix hj">皮肤厚度</strong>:三头肌皮褶厚度(毫米)<br/> <strong class="ix hj">胰岛素</strong> : 2小时血清胰岛素(μU/ml)<br/><strong class="ix hj">【身体质量指数</strong>:体重指数(体重，单位为千克 <br/> <strong class="ix hj">糖尿病谱系功能</strong>:糖尿病谱系功能<br/> <strong class="ix hj">年龄</strong>:年龄(年)<br/> <strong class="ix hj">结果</strong>:类变量(0或1)【二进制输出】</p><p id="206c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里输出是输出变量，而其余的是自变量。1代表糖尿病，0代表无糖尿病。</p><p id="cdf8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">探索数据集:</strong></p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/cf8a640b420e8df019ff25e75d873198.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*zzMWTtdA1scNqTDp5j3l5Q.png"/></div></figure></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><blockquote class="jt ju jv"><p id="be7b" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">观察</strong>:我们可以看到几乎65 %的患者没有糖尿病，<br/>其余35 %是糖尿病患者。</p></blockquote><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/a128a7f1e9a2886e525146e929b44397.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*ZJ0L2Aix_RcEjYB9CLyDrQ.png"/></div></figure><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/12bfca2bd34d5d94b45f6c08df28bd46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdAzkrBZCJu0ezgFS5W-Kg.png"/></div></div></figure><p id="8e11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据集中所有变量的直方图</p><p id="fde9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jw">从上面的直方图可以得出很多真知灼见:<br/> </em> </strong> 1。大多数患者的年龄分布在20–30岁之间<br/> 2。几乎所有患者的身体质量指数分布都在20–40之间<br/> 3。大多数患者的血糖水平分布在100–150之间<br/>4数据包含某些特征的异常值，我们将了解是否需要进一步的工程设计。因此，使用上述直方图可以得出更多的结论</p><h1 id="6cfb" class="lp kb hi bd kc lq lr ls kg lt lu lv kk lw lx ly kn lz ma mb kq mc md me kt mf bi translated">准备训练数据集:</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/de4f5b540a49cd33fe7dac1f70055601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*05lkJ2_loK_otN9Z_g7CIQ.png"/></div></div></figure><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/60b88a450660e1c6e53f4c977871a97b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*nVbNr28-Dd0SbVYwITHWsA.png"/></div></figure><p id="fddb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们选择了输入要素和输出属性，并将其输入到网络中。根据这些特征，我们的网络将为我们做出预测。</p><h1 id="9e0c" class="lp kb hi bd kc lq lr ls kg lt lu lv kk lw lx ly kn lz ma mb kq mc md me kt mf bi translated">模型准备:</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/86ec9856f4937a110b7261feaa40405f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eDgNLMDlR5AmQB_IvdQabg.png"/></div></div></figure><p id="8497" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们引入了顺序模型，它将定义我们的网络架构，即层的堆栈。我们这里使用的层的类型是密集类型，这是一个完全连接的层。最后，我们实例化我们的模型</p><h1 id="b405" class="lp kb hi bd kc lq lr ls kg lt lu lv kk lw lx ly kn lz ma mb kq mc md me kt mf bi translated">定义网络架构:</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/14a35f39077c804d8ece4a951c5dbef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-tuyw3wUqeonTJOPX2DbA.png"/></div></div></figure><p id="7ba4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们在网络中增加了3层。第一层由8个神经元(随机选择)组成，输入维数是8，因为在我们的数据集中输入特征的数量是8，并且激活函数是relu，因为计算开销小于sigmoid。在第二层中，总共使用了4个具有relu激活功能的神经元<br/>。在最后一层中，仅使用了一个神经元，因为我们的输出仅给出一个二进制结果。</p><p id="4eda" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">参数计算:<br/>输入数*神经元数+偏差(每个神经元1个)<br/> </strong>第一层:8*8+8=72 <br/>第二层4*8+4=36 <br/>第三层:1*4+1=5 <br/>合计=113</p><p id="8fce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">导入优化器优化损失函数</strong></p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/81e2933433d9774d649bd07598bfb0e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*Sx2u_KmhQLN48KZSEeBm5A.png"/></div></figure><p id="1545" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们引入了不同的优化器来减少网络的误差，从而提高精度。我们给出了优化器的学习率。<br/>在SGD中，学习率不衰减，而在rmsprop中，学习率在每个历元后衰减。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/2d3c0187d3635c37937e2537b3e9601c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*mPzsP_L9zAUxQaUQQfYUTw.png"/></div></figure><p id="e31e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们编译了我们的模型，给出了不同的参数，如损失和指标。<br/>当我们的预测标签不大于两个时，使用二元交叉熵<br/>度量参数帮助我们计算必要的测量值，同时训练我们的网络，如准确性和损失。</p><h1 id="1464" class="lp kb hi bd kc lq lr ls kg lt lu lv kk lw lx ly kn lz ma mb kq mc md me kt mf bi translated">训练神经网络:</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/05c5500273b97e2b70d36d7dc7b1c6e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8g1mnxN18EHtz5U1oocgMA.png"/></div></div></figure><p id="00e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">观察</strong>:我们可以看到，我们的训练准确率为65%，验证准确率为59%，可以说我们有一定的过拟合。</p><p id="b7f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">剧情观察:</strong></p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/d4c86ba18ed8680caea66932fb12e57b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*tBwbmfLjODMR5Hn2pB_y6A.png"/></div></figure><p id="0283" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的图中，我们可以说验证精度是恒定的，不随时间增加，训练精度也是如此。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/a68a9168428dc09a90f99d3348c57975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*ebttLcV7HdbdkWviQyLQDg.png"/></div></div></figure><p id="beae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">损失图对于训练数据是好的，但是由于过度拟合，对于验证不是很好。因此，我们可以通过对我们的模型进行一些改变来调整我们的模型，使其表现得更好，比如改变纪元的数量，使用不同的优化器，添加更多的层，并在每层中添加更多的神经元。</p><h1 id="c004" class="lp kb hi bd kc lq lr ls kg lt lu lv kk lw lx ly kn lz ma mb kq mc md me kt mf bi translated">更新网络:</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/3b8ece02725be4941fff0883843f7429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBn4piV_DY6O2lIPcJIFsQ.png"/></div></div></figure><p id="e281" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">更新</strong>:这里我们增加了额外的层，增加了神经元的数量，使用了不同的优化器，将学习率降低到0.001，增加了历元的数量。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/c023302aff3873bd927e8885c76b436d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3zFi_lZx5jTDEnF4K37wQQ.png"/></div></div></figure><p id="e679" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">观察</strong>:训练和验证精度都很好，损失也是双方都可以承受的。让我们借助图表来形象化地描述损失和准确性</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/32261d912e7795f7a20d3ab026d5980e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*_ub_QiWfLZjEzke8TI6VdQ.png"/></div></figure><p id="b598" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到训练和验证准确性的峰值都在增加。这是一个不错的进步。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/315ef9fc2d8e29d3437a79e8b12deb0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*Czi1H6m6xPikoT8uDRyLBA.png"/></div></figure><p id="35a7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">损失图不知何故比前一个好，但仍然需要大量的黑客下降。</p><h1 id="245f" class="lp kb hi bd kc lq lr ls kg lt lu lv kk lw lx ly kn lz ma mb kq mc md me kt mf bi translated">结论:</h1><p id="58bc" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">正如我们可以看到的，在我们的旧模型中经过调整和改变后，我们得到了一个更好的模型，这证明了制作一个好的神经网络就是反复搜索<br/>这样的参数，直到达到所需的精度水平和损失百分比。我鼓励每个人用他们的模型玩一段时间，因为你不能在第一次尝试中得到优化的模型。这是一系列的尝试和失败。</p><p id="29a7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> P </strong>。<strong class="ix hj"> S </strong>:是我在学习机器学习的时候，导师给我的任务之一。它于2019年1月5日完成，我决定将其发布在媒体上。</p><p id="571d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">链接</strong> <strong class="ix hj">到</strong><strong class="ix hj"/><strong class="ix hj">笔记本</strong>:<a class="ae iu" href="https://www.kaggle.com/sanjogch/prediction-using-neural-network-with-keras?scriptVersionId=24105218" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/sanjogch/prediction-using-neural-network-with-keras？scriptVersionId=24105218 </a></p><p id="6ce9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">找到</strong>【https://www.linkedin.com/in/sanjog-g-c-173174186/】我 <strong class="ix hj">上:</strong><a class="ae iu" href="https://www.linkedin.com/in/sanjog-g-c-173174186/" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>