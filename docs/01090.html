<html>
<head>
<title>Dealing with Categorical Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理分类数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dealing-with-categorical-data-942a8c8fdbad?source=collection_archive---------6-----------------------#2019-09-30">https://medium.com/analytics-vidhya/dealing-with-categorical-data-942a8c8fdbad?source=collection_archive---------6-----------------------#2019-09-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/7263808af05e67171f1fd648c6e60539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YHGos38d607RyykOyCpQOw.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="2338" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">用于机器学习-多目标回归</h2></div><p id="9ea3" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在我们的<a class="ae ke" rel="noopener" href="/@mulbahkallen/exploring-linear-regression-474752ba1761">上一节</a>中，我们通过将单一线性回归模型改为多元线性回归模型，极大地提高了我们的R分数。这是通过将剩余的预测因子(特征)添加到我们的线性回归模型中并重新调整(重新训练)它来实现的。</p><p id="be30" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这很容易做到，因为我们所有的额外预测因子都是数值，但如果它们不是呢？查看下面的<a class="ae ke" href="https://archive.ics.uci.edu/ml/datasets/Post-Operative+Patient" rel="noopener ugc nofollow" target="_blank">数据集</a>，注意它包含数值和分类数据。你会注意到我们的数据集大部分是分类的。</p><p id="0fa1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">重要的是要指出，范畴变量有两种类型，名词性和序数。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div class="er es kf"><img src="../Images/dc966f9b961fc186dbf1b8f8cbb6e97c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Hj90yaWrmGVYWLtBGSW54A.jpeg"/></div></figure><p id="573e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">有序分类变量的一个例子是<strong class="jk hu">大小</strong>记录为<strong class="jk hu">小、中</strong>或<strong class="jk hu">大</strong>即<em class="kk">大&gt;中&gt;小。<br/> </em>另一方面，名义分类变量可以是注册为<strong class="jk hu">猫、狗</strong>或<strong class="jk hu">鸟的<strong class="jk hu">宠物</strong>,</strong>从机器学习模型的角度来看，猫不应包含任何小于或大于狗或鸟的内在值。</p><p id="176a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在训练我们的机器学习模型时，这种区别的重要性是显而易见的。模型无法按原样处理分类数据，分类数据必须转换成数字。危险在于我们如何去转换我们的数据。</p><p id="4866" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">对于顺序数据，给数据分配以下数值没有问题。</p><pre class="kg kh ki kj fd kl km kn ko aw kp bi"><span id="5c57" class="kq kr ht km b fi ks kt l ku kv">L - 3<br/>M - 2 <br/>S - 1 </span></pre><p id="58b0" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们的模型将考虑尺寸差异L&gt;M&gt;S与相应的3&gt;2&gt;1的内在本质。</p><p id="54f4" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">另一方面，将<strong class="jk hu"> 1的值指定给<strong class="jk hu">猫</strong>，将</strong>的值指定给<strong class="jk hu"> 2 </strong>并将<strong class="jk hu">鸟</strong>的值指定给<strong class="jk hu"> 3 </strong>可能会导致我们的模型错误解释<strong class="jk hu">猫、狗</strong>和<strong class="jk hu">鸟</strong>的值，从而极大地影响我们模型的误差函数</p><pre class="kg kh ki kj fd kl km kn ko aw kp bi"><span id="6635" class="kq kr ht km b fi ks kt l ku kv"><a class="ae ke" href="https://towardsdatascience.com/understanding-the-3-most-common-loss-functions-for-machine-learning-regression-23e0ef3e14d3" rel="noopener" target="_blank">Error function</a> — a method of evaluating how well specific algorithm models the given data</span></pre><p id="cc4e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">对此的一个解决方案是一键编码的方法。这种方法允许我们为预测值(特征)的每个变量赋予一个二进制值，该值可以被我们的模型准确读取，而不会赋予一个变量比另一个变量更多的权重。这将看起来像下面的例子。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kw"><img src="../Images/feef273562b9f4df768d0f01a937626f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RQBYhimAZDdX5-mTnlbgRw.png"/></div></div></figure><p id="2ae4" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在让我们把目光转回我们的原始数据集。似乎我们的目标数据类型也是分类的。此外，我们的目标不是二元的，而是多类的。同样，数据集的目的是能够预测三种情景中的<strong class="jk hu">一种。根据病人目前的状况，他们应该被送到重症监护室(I)、普通医院(A)还是疗养院(S)。如果我们的目标是二进制的，一旦我们的数据集被一次性编码，我们可以再次使用线性回归模型，但是在这种情况下，这是不可能的。</strong></p><p id="bbbc" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们的下一个选择是研究逻辑回归。虽然回归这个词是在它的名字中，逻辑回归是一个真正的分类模型，而不是回归。大多数情况下，逻辑回归模型旨在解决二元分类问题，但SciKit Learn允许我们调整逻辑回归分类器，以处理多类目标。</p><p id="4693" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在你检查并清理完你的数据集后，只需要几行代码就可以一次性编码我们的数据，初始化并拟合我们的逻辑回归模型，然后看看我们的模型表现如何。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kx"><img src="../Images/3128b9c1a3d901e618cb5b955500de05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHCb4AZNxPQp0c4rIzzfbg.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">注意我们的多类调优被设置为‘ovr ’,意思是<a class="ae ke" href="https://en.wikipedia.org/wiki/Multiclass_classification" rel="noopener ugc nofollow" target="_blank">一个对其余的</a></figcaption></figure><p id="40a4" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">将class_weight设置为“平衡”的原因是，当涉及到我们的目标时，值会不相称。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lc"><img src="../Images/9a5db0e567b68b777b47a12caa261eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n44Itoa46_1LpOL49_YUWg.png"/></div></div></figure><p id="7bbf" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">“平衡”模式使用y值来自动调整与输入数据中的类别频率成反比的权重”。</p><p id="0de3" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这样做是为了让我们的模型不会假设，因为70%的目标值确实是A，它应该只在70%的时间里猜测A。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ld"><img src="../Images/7808fa48272d1fa9f9e6c4becda0bdeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DpiZvavO1nzOUnRJAioW3g.png"/></div></div></figure><p id="ef21" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">请注意，当我们的逻辑回归平衡与不平衡时，会出现两个输出。我们的不平衡预测主要由A组成，而我们的平衡预测更准确地代表真实数据。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es le"><img src="../Images/7248062b9f5aeafacbc581ccec5510f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*huZP174A3dHACpF7slX8gw.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated"><strong class="bd lf">不平衡</strong></figcaption></figure><figure class="kg kh ki kj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lg"><img src="../Images/cc4ec9b48604edb229e360451de074a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4FLS-hZY7yqlgFiTTWqqw.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated"><strong class="bd lf">平衡的</strong></figcaption></figure><p id="814a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">让我们看看我们的最终得分。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es le"><img src="../Images/6e05a0b98054ad1ac9d4ffc192204dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J7ar6YAzeNHhgpUHS_tw5w.png"/></div></div></figure><p id="4bda" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这里有一些事情需要考虑。我们的模型只比A与我们其余数据的比例预测稍好。这应该导致我们对我们的模型有点怀疑，但我们确实平衡了我们的逻辑回归模型，所以也许我们的模型是好的(80%或更高将是更好的)。从现在开始，我们的目标是回头看看是否有更好的方法来微调我们的模型并提高我们的分数。</p><figure class="kg kh ki kj fd hk er es paragraph-image"><div class="er es kf"><img src="../Images/462e5317ed7e2f83f0d2a75a97d2b7d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*r48ehoiRBOvfmpvJNuglmA.jpeg"/></div></figure><p id="c5d2" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">“逻辑回归用于分类，而我们正在处理的问题是分类，逻辑回归是最简单的分类线性模型。”——Dave</p></div></div>    
</body>
</html>