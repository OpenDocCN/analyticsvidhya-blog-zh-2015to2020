<html>
<head>
<title>Sentiment analysis on Ellen’s DeGeneres tweets using TextBlob</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TextBlob对Ellen的DeGeneres推文进行情感分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentiment-analysis-on-ellens-degeneres-tweets-using-textblob-ff525ea7c30f?source=collection_archive---------0-----------------------#2019-07-24">https://medium.com/analytics-vidhya/sentiment-analysis-on-ellens-degeneres-tweets-using-textblob-ff525ea7c30f?source=collection_archive---------0-----------------------#2019-07-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/d04598fb7b73ace5dfdef6bc24b35e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5kxJ-DGCVV3T0MWQ.jpg"/></div></div></figure><div class=""/><p id="e945" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们以任何一家产品公司为例。公司或其产品的成功直接取决于其客户。如果顾客喜欢他们的产品，那么这个产品就是成功的。如果不是，那么公司肯定需要通过改变来改进它的产品。</p><blockquote class="jo jp jq"><p id="d825" class="iq ir jr is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">公司如何知道他们的产品是否成功？</p></blockquote><p id="57d0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，公司需要分析他们的客户，其中一个属性是分析客户的情绪。</p><h2 id="c1c4" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">什么是情感分析？</h2><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="ab fe cl ku"><img src="../Images/943ca280a2527b31023f971f9d624ada.png" data-original-src="https://miro.medium.com/v2/1*_JW1JaMpK_fVGld8pd1_JQ.gif"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">来源:Hackernoon</figcaption></figure><p id="3c0e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个通过计算从一篇文章中识别和分类观点的过程，并检查作者对特定主题或产品的态度是积极的、消极的还是中立的。</p><p id="db13" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">情感分析是一个备受关注和发展的热门话题，它有很多实际的应用。在不断增长的互联网上有许多公开的和私有的数据来源。社交媒体、博客、论坛等有大量表达观点的文本。</p><p id="1b1c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用情感分析，非结构化数据可以自动转换为公众对产品、服务、品牌、政治或人们可以表达意见的任何主题的意见的结构化数据。从文本数据中识别情感对于市场分析、公共关系、产品评论、净推广者评分、产品反馈和客户服务等任务非常有用。</p><h2 id="e346" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">输入:</h2><p id="c5b4" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">文集。它是文本文档的集合，我们希望从这些文本中获得情感。例如，如果文本有great，那么我们希望将其标记为积极的，但如果我们有一个单词或短语不太好，那么我们希望将其标记为消极的，所以我们希望保持所有原始文本的原始顺序，以便我们可以捕捉情感。</p><h2 id="f948" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">文本Blob:</h2><p id="7370" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">TextBlob是一个构建在nltk之上的Python库。它更易于使用，并提供了一些额外的功能，如基于规则的情感评分。TextBlob找到所有可以赋予极性和主观性的单词和短语，并对它们进行平均。更多信息可在<a class="ae le" href="https://textblob.readthedocs.io/en/dev/quickstart.html" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p><h2 id="290c" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">输出:</h2><p id="a263" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">对于每个单词，我们将得到一个情感分数(它们有多积极/消极)和一个主观性分数(它们有多固执己见)</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es lf"><img src="../Images/705cb57864f24d09a8393bc113292c29.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*xQACCy-ZTD89fRIVNyEhaQ.png"/></div></figure><ul class=""><li id="f507" class="lg lh ht is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated"><strong class="is hu">极性</strong>:一个词有多积极或消极。-1是非常消极的。+1很正。</li><li id="ceb6" class="lg lh ht is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo bi translated">主观性:一个词有多主观，或者有多固执己见。0是事实。+1很有意见。</li></ul><p id="14a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jr">在这篇博文中，我们将使用tweepy提取twitter数据。使用Python中的TextBlob库对提取的推文进行情感分析</em></p><h2 id="c844" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">导入必要的库</h2><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="cf2d" class="jv jw ht lv b fi lz ma l mb mc">import pandas as pd<br/>import numpy as np<br/>import tweepy # to use Twitter’s API<br/>import textblob as TextBlob # for doing sentimental analysis<br/>import re # regex for cleaning the tweets</span></pre><h2 id="1a17" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">创建Twitter应用程序</h2><p id="1281" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">为了提取推文，我们需要访问我们的Twitter帐户并创建一个应用程序。我们可以从<a class="ae le" href="https://developer.twitter.com/en/apps" rel="noopener ugc nofollow" target="_blank">这里</a>得到凭证</p><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="abc3" class="jv jw ht lv b fi lz ma l mb mc"># Twitter Api Credentials</span><span id="e599" class="jv jw ht lv b fi md ma l mb mc">consumer_key = “Your consmer key”<br/>consumer_secret = “Your consumer secret key”<br/>access_token = “Your acess token”<br/>access_token_secret = “Your access token secret”</span></pre><p id="0ba3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个访问Twitter API的函数</p><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="8405" class="jv jw ht lv b fi lz ma l mb mc">def twitter():<br/>    # Creating the authentication object<br/>    auth = tweepy.OAuthHandler(consumer_key, consumer_secret) <br/>    # Setting your access token and secret<br/>    auth.set_access_token(access_token, access_token_secret) <br/>    # Creating the API object while passing in auth information<br/>    api = tweepy.API(auth, wait_on_rate_limit = True)  <br/>    return api</span></pre><h2 id="b9b2" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">获取推文</h2><figure class="kq kr ks kt fd hk"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="2a55" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用上面的twitter函数创建一个' tw '对象。我们来分析一下艾伦·德杰尼勒斯的推文。一次计数是指推文的数量。打印最后十条微博。更多关于Tweepy的信息可以在<a class="ae le" href="http://docs.tweepy.org/en/latest/" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="732e" class="jv jw ht lv b fi lz ma l mb mc"># Creating tw object<br/>tw = twitter()</span><span id="8a19" class="jv jw ht lv b fi md ma l mb mc"># Extracting Ellen DeGeneres tweets</span><span id="c625" class="jv jw ht lv b fi md ma l mb mc">search = tw.user_timeline(screen_name="TheEllenShow", count = 200, lang ="en")</span><span id="8880" class="jv jw ht lv b fi md ma l mb mc">#  Printing last 10 tweets</span><span id="cfb4" class="jv jw ht lv b fi md ma l mb mc">print("10 recent tweets:\n")<br/>for tweets in search[:10]:<br/>    print(tweets.text + '\n')</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mg"><img src="../Images/f1be82aaa45d0d2d00130586c954bc58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rI_aR35HxWHzdcgyfTZePA.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">最近十条推文</figcaption></figure><h2 id="25f4" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated"><strong class="ak">创建数据帧</strong></h2><p id="c026" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">提取推文，现在转换成数据帧</p><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="9621" class="jv jw ht lv b fi lz ma l mb mc"># Converting into dataframe (Column name Tweets)</span><span id="8744" class="jv jw ht lv b fi md ma l mb mc">df = pd.DataFrame([tweets.text for tweets in search], columns=[‘Tweets’])<br/>df.head(10)</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es mh"><img src="../Images/b7b11e4c840296921cd7a6444c120da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*faXZl4PQXhrVDCHFoYAtDQ.png"/></div></figure><p id="71ec" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在进行情感分析之前，让我们使用一个正则表达式函数来清理推文。创建了一个叫做clean的小函数。</p><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="b0f3" class="jv jw ht lv b fi lz ma l mb mc"># Cleaning the tweets<br/># Creating a function called clean. removing hyperlink, #, RT, <a class="ae le" href="http://twitter.com/mentions" rel="noopener ugc nofollow" target="_blank">@mentions</a></span><span id="594e" class="jv jw ht lv b fi md ma l mb mc">def clean(x):<br/> x = re.sub(r’^RT[\s]+’, ‘’, x)<br/> x = re.sub(r’https?:\/\/.*[\r\n]*’, ‘’, x)<br/> x = re.sub(r’#’, ‘’, x)<br/> x = re.sub(r’@[A-Za-z0–9]+’, ‘’, x) <br/> return x</span><span id="2278" class="jv jw ht lv b fi md ma l mb mc">df[‘Tweets’] = df[‘Tweets’].apply(clean)</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es mi"><img src="../Images/cb7d5af29770af4b2dafac8dcb701f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*WwkeLIXI9hjDm6lXfp-I9Q.png"/></div></figure><h1 id="079c" class="mj jw ht bd jx mk ml mm kb mn mo mp kf mq mr ms ki mt mu mv kl mw mx my ko mz bi translated">情感分析</h1><p id="5521" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">让我们使用TextBlob进行情感分析。找到极性和主观性。计算极性和主观性。</p><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="9c5b" class="jv jw ht lv b fi lz ma l mb mc">polarity = lambda x: TextBlob(x).sentiment.polarity<br/>subjectivity = lambda x: TextBlob(x).sentiment.subjectivity</span><span id="ceb3" class="jv jw ht lv b fi md ma l mb mc">df[‘polarity’] = df[‘Tweets’].apply(polarity)<br/>df[‘subjectivity’] = df[‘Tweets’].apply(subjectivity)</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es na"><img src="../Images/269345a1898dd252d9da9f74cd67e56e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*pkrk8TzieJy7OagDCPnVwQ.png"/></div></figure><h2 id="6851" class="jv jw ht bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">形象化</h2><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="d9d2" class="jv jw ht lv b fi lz ma l mb mc"># Let’s plot the results<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="f8e2" class="jv jw ht lv b fi md ma l mb mc">plt.rcParams[‘figure.figsize’] = [10, 8]</span><span id="f7ec" class="jv jw ht lv b fi md ma l mb mc">for index, Tweets in enumerate(df.index):<br/> x = df.polarity.loc[Tweets]<br/> y = df.subjectivity.loc[Tweets]<br/> plt.scatter(x, y, color=’Red’)<br/> <br/> <br/>plt.title(‘Sentiment Analysis’, fontsize = 20)<br/>plt.xlabel(‘← Negative — — — — — — Positive →’, fontsize=15)<br/>plt.ylabel(‘← Facts — — — — — — — Opinions →’, fontsize=15)</span><span id="b54c" class="jv jw ht lv b fi md ma l mb mc">plt.show()</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nb"><img src="../Images/0156806c7c655b226da64bd01b231519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XxJNPTG5o4cTpgrIEVtTYw.png"/></div></div></figure><p id="fbef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以看到更多的积极因素，而不是消极因素。让我们计算一下有多少条推文是正面的、负面的和中性的。</p><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="b3ef" class="jv jw ht lv b fi lz ma l mb mc"># Creating function for calculating positive, negative and neutral<br/># More than 1 --&gt; Positive, equal to 0 --&gt; neutral and less than 0 --&gt; Negative</span><span id="fe3f" class="jv jw ht lv b fi md ma l mb mc">def ratio(x):<br/> if x &gt; 0:<br/> return 1<br/> elif x == 0:<br/> return 0<br/> else:<br/> return -1</span><span id="0638" class="jv jw ht lv b fi md ma l mb mc">df['analysis'] = df['polarity'].apply(ratio)</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es nc"><img src="../Images/f836c82702a410aaa7b71098c93544e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*0R1hUh1dc2S3RX-l5k1i9A.png"/></div></figure><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="1e9f" class="jv jw ht lv b fi lz ma l mb mc">df['analysis'].value_counts()</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es nd"><img src="../Images/64f5acb70dcfa3f571c4710b451610b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*0TJqAVMIapOo0f6FcR8BgA.png"/></div></figure><pre class="kq kr ks kt fd lu lv lw lx aw ly bi"><span id="7e8d" class="jv jw ht lv b fi lz ma l mb mc"># Plotting<br/>df[‘analysis’].value_counts().plot(kind = ‘bar’)<br/>plt.show()</span></pre><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ne"><img src="../Images/00dca1c9acb9d2ef46699e9c88d79b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwF4x7zhaSsQp_SLnuCl_w.png"/></div></div></figure><p id="453f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">艾伦·德杰尼勒斯无疑是著名的名人之一，人们更加积极并喜欢她的节目。</p><p id="7c65" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的情感分析是TextBlob使用的一个简单的分析。我们也可以通过在Twitter上搜索任何趋势或标签来进行分析。</p><p id="71f1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读。请继续学习，并关注更多内容！</p></div></div>    
</body>
</html>