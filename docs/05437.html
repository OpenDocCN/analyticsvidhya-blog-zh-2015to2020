<html>
<head>
<title>Recommendation System: Content based (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐系统:基于内容(上)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/recommendation-system-content-based-part-1-8f5ac093127a?source=collection_archive---------5-----------------------#2020-04-21">https://medium.com/analytics-vidhya/recommendation-system-content-based-part-1-8f5ac093127a?source=collection_archive---------5-----------------------#2020-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cb82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章包含了python中CBRS的详细实现步骤，从头开始不需要任何外部库。</p><p id="2926" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">推荐系统的两个著名方法是基于内容和协同过滤。在本文中，我将重点介绍基于内容的推荐系统的实现细节，在本文的第2部分，我将解释协同过滤方法。</p><blockquote class="jd je jf"><p id="be8b" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">CBRS的主要思想围绕着向用户推荐他/她过去评价很高的<em class="hi">类似</em>的商品。</p></blockquote><p id="87fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，在图1中，如果用户喜欢红色的项目(在此发现的共同属性),那么推荐系统将向用户推荐更多的红色项目，并且不强调项目的形状。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jk"><img src="../Images/232bc4ba6f8fc14291b2ea3577962386.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*5L7n63UtsDMIqZjmEJUoyw.jpeg"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">图一</figcaption></figure><p id="d013" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于内容的推荐系统不关注其他用户的评价，这使得该模型能够向具有独特品味的用户推荐新的或不受欢迎的项目。这里的单词“内容”指的是用户喜欢或不喜欢的项目属性，例如电影的类型和类型(类型:动作、冒险和类型:电视连续剧)等。</p><p id="0c17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了向用户推荐任何商品，你需要两个主要的东西:商品简介和用户简介。现在让我们深入研究实现部分。</p><p id="27f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这篇文章，我使用kaggle的动画数据集(参考资料中的链接)。数据集包含两个文件，rating.csv包含用户对不同动漫的评级，因此共有3列，anime.csv包含所有动漫的详细信息，如名称、类型、平均评级等。共有12，294部独特动漫，73，516个独特用户和7，813，737个总评分。</p><p id="2f21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，数据集很大，所以我将使用spark的一些部分。</p><h1 id="0926" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">实施步骤:</h1><p id="98e3" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">在开始推荐商品之前，让我们创建个人资料。</p><p id="fb9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第1步</strong>:通过删除缺失值对数据进行预处理，并分析数据集，以识别可用于预测物品的属性。在这个应用中，我使用了动漫的两个属性:<em class="jg">流派</em>和<em class="jg">类型，</em>你也可以使用平均评分，但需要对其进行处理，使其具有可比性。</p><p id="4b0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:</strong>为表格中的每个动漫创建一个<em class="jg">单词包(BOW) </em>属性流派和类型。BOW将包含我们用作该动画内容的属性值，如图2所示。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kz"><img src="../Images/3af1310ebaebd1141682f5e5b593f31e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hQKBzpoGmcNUq2NtCTWLZw.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">图2(我们表中的一个典型行)</figcaption></figure><p id="4daa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤3 </strong>:为了将每个动画的弓转换成它的<strong class="ih hj"> <em class="jg">物品轮廓向量</em> </strong>我们将为每个动画创建<em class="jg"> TFIDF向量</em>。你也可以使用其他方法，如二进制值表示，但TFIDF分数包含更多信息，而不仅仅是告诉一个单词是否存在于向量中。这有助于给予出现较少的单词比出现较多的单词更大的权重，因此唯一性在这里被赋予更大的价值。</p><p id="44eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要创建TFIDF矢量作为项目配置文件:</p><p id="bbe5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先计算词频<em class="jg"> TF_ij </em>得分，即<em class="jg">词</em> <em class="jg"> i </em>在<em class="jg">文档j </em>中出现的次数(此处为步骤2中的单词包)。</p><p id="0b08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后计算逆文档频率，<em class="jg"> IDF_i = log (N / n_i) </em>其中N是存在的文档总数，而n_i是提及项I的文档数</p><p id="8980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，TFIDF得分计算为<em class="jg"> w_ij = TF_ij * IDF_i. </em>下面的代码片段展示了这些步骤。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">上述TFIDF的Python实现</figcaption></figure><p id="5538" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成后，<em class="jg">将为每个项目</em>提供您的 <strong class="ih hj"> <em class="jg"> </em> </strong> <em class="jg">项目简介，即一个向量，代表动画中出现的每个内容词的值。在我的实现中，我将为一部动画获取一个1 x 51维的向量，这也表示我们总共有50个不同的内容词。总的来说，我们将得到一个12294 x 51的矩阵，即所有动画的项目向量。在图3中，动画的内容词具有大于零的值，而没有找到该动画的内容词将具有零的值，例如冒险= 0。</em></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lg"><img src="../Images/1fb0e7069b69df3030eda57c4f1ebd3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UWMAPb7gcf2-jS3a8vShnQ.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">图3(项目向量)</figcaption></figure><p id="c98d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤4 </strong>:为了找到一个用户的匹配动画，我们需要计算一个<strong class="ih hj"> <em class="jg">用户简档向量</em> </strong>，它也将具有相同内容词的值，即每个用户1×51维的简档向量。用户简档表示用户喜欢/不喜欢项目的哪个属性以及喜欢/不喜欢的程度。</p><p id="c853" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要计算用户配置文件:</p><p id="5d1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查找用户过去评价过的所有动漫。将评级移动到零左右，即从对该用户有评级的所有动画中减去该用户的平均评级。现在，具有正值的评级，即初始评级高于平均评级的动漫是用户喜欢的动漫，反之则是动漫用户不喜欢的动漫。</p><blockquote class="jd je jf"><p id="ac22" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">用户简档向量通过对评分项目简档进行加权平均来计算，其中权重将是我们上面计算的移动评分值。</p></blockquote><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">用户配置文件的Python实现</figcaption></figure><p id="8a98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>您也可以使用其他方法来生成用户配置文件。您的模型对用户的推荐将直接取决于用户创建的个人资料。</p><p id="ebf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第5步</strong>:一旦我们准备好我们的项目和用户资料，我们就可以开始推荐项目。我们使用的方法是<em class="jg">余弦相似度</em>函数，用于查找用户简档和所有项目简档之间的相似度。尚未被使用/观看并且具有最高余弦值的项目将最终被推荐给用户。够简单吧！</p><pre class="jl jm jn jo fd lh li lj lk aw ll bi"><span id="f6d2" class="lm jx hi li b fi ln lo l lp lq">cosine_sim = cosine_similarity(user_vector, item_vectors)</span></pre><h1 id="665b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">结果:</h1><p id="b019" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">表1显示了与用户3最匹配的动画。要观察的是这里的内容，即显示相似性的流派和类型属性。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lr"><img src="../Images/0308702f1f3410da53a0565ccfbc669b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ueeCD9X38WErr-cNBuex7Q.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">表1(对用户3的建议)</figcaption></figure><p id="004d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以扩展我们的模型来查找类似的项目。这可以通过计算需要搜索相似项目的项目向量和所有项目向量之间的余弦相似性来实现，如表2所示。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ls"><img src="../Images/770475d1b5a2ca0bc772e6f901db6eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcuFvWT2Pkb_ODFadJOIFg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">表2(找到与项目“仙女尾巴(2014)”相似的项目)</figcaption></figure><h1 id="a087" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">讨论</h1><p id="391d" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">基于内容是一个很好的开始为用户推荐商品的模型，但是它缺乏推荐商品的多样性。大多数被推荐的项目将具有相同的性质。当我们想要找到相似的条目(表2)时，它会有更好的用途，因为用户可以有非常不同的品味，并且可以喜欢具有完全不同内容的不同类型的条目。但好处是你不需要其他用户的数据，所以没有冷启动的问题，即没有足够的数据来推荐商品。这通常是仍在收集数据的新应用程序面临的问题。</p><p id="831e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是上述模型的完整实现。注意:在本文中，为了保持文章的简洁，我没有包括数据集的预处理等内容。</p><div class="lt lu ez fb lv lw"><a href="https://github.com/arsh1207/BigDataProject.git" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">arsh 1207/大数据项目</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">项目报告算法1 CBRS代码文件PDF副本:Content _ based _ recommendation _ system _ colab . ipynb算法2…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">github.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk jq lw"/></div></div></a></div><p id="6942" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考资料:</p><p id="b70a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">海量数据集的挖掘:【http://www.mmds.org T4】</p><p id="ff0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集:<a class="ae ml" href="https://www.kaggle.com/CooperUnion/anime-recommendations-database#rating.csv" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/Cooper union/anime-recommendations-database # rating . CSV</a>T8】https://www . analyticsvidhya . com/blog/2015/08/beginners-guide-learn-content-based-recommenders-systems/</p><p id="fc83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">项目回购:<a class="ae ml" href="https://github.com/arsh1207/BigDataProject" rel="noopener ugc nofollow" target="_blank">https://github.com/arsh1207/BigDataProject</a></p></div></div>    
</body>
</html>