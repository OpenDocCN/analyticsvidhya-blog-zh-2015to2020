<html>
<head>
<title>Screenshot Taker with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 截图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/screenshot-taker-with-python-4fe19f972556?source=collection_archive---------5-----------------------#2020-11-23">https://medium.com/analytics-vidhya/screenshot-taker-with-python-4fe19f972556?source=collection_archive---------5-----------------------#2020-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e7db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客文章中，我们将看到如何捕捉屏幕截图。我们将看到 python 中的实现。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/93af58f175f0364446f54ac93bd4ef92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EeEkm8HpN6tk2pSkJD28ug.png"/></div></div></figure><p id="fbd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jp" href="https://github.com/ayushi7rawat/Ultimate-Python-Resource-Hub" rel="noopener ugc nofollow" target="_blank">python 中终极资源的存储库</a>。发现有用就掉颗星！有什么要补充的吗？开个 PR 就一样了！</p><p id="08e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以参考我的 YouTube 视频教程，以便更好地理解</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><h1 id="553e" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">介绍</h1><p id="b86c" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">屏幕截图，也称为屏幕捕捉，是显示计算机显示内容的数字图像。常见的屏幕截图是由设备上运行的操作系统或软件创建的。拍摄、保存和分享截图非常有用。</p><h1 id="37dc" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">这个博客将会涵盖什么</h1><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="24af" class="la jt hi kw b fi lb lc l ld le">1. PyAutoGUI Introduction<br/>2. How to capture Screenshot using python</span></pre><h1 id="2205" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">PyAutoGUI 是什么？</h1><p id="bad4" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">PyAutoGUI 允许您的 Python 脚本控制鼠标和键盘，以自动化与其他应用程序的交互。</p><p id="e156" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">特征</p><ul class=""><li id="a460" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">移动鼠标并在其他应用程序的窗口中点击或键入。</li><li id="f991" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">向应用程序发送击键(例如，填写表单)。</li><li id="f669" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">截图，给定一个图像(例如，一个按钮或复选框)，在屏幕上找到它。</li><li id="7969" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">找到应用程序的窗口，并移动、调整大小、最大化、最小化或关闭它(目前仅适用于 Windows)</li><li id="13c4" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">GUI 自动化脚本运行时，显示消息框供用户交互。</li></ul><p id="637d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想了解更多，你可以参考<a class="ae jp" href="https://pyautogui.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> PyAutoGUI 文档</a>。使用此链接导航到文档。</p><p id="4390" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您已经了解了 PyAutoGUI 的基础知识，我们可以前进到编码部分了。</p><h1 id="d3ec" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">该编码了！</h1><p id="0958" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">你可以在我的<a class="ae jp" href="https://github.com/ayushi7rawat/Youtube-Projects/tree/master/Screenshot%20taker%20app" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>找到所有代码。发现有用就掉颗星。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/eb0d1b0f5b1757f04f7d00059ccc501b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VfSo8ldPDJU49cZi"/></div></div></figure><h1 id="b1d9" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">安装 PyAutoGUI</h1><p id="4870" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">打开您的终端并运行以下命令</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="30f0" class="la jt hi kw b fi lb lc l ld le">pip install PyAutoGUI</span></pre><p id="2512" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了这个包，我们准备将它导入到我们的 python 脚本中。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="e5ae" class="la jt hi kw b fi lb lc l ld le">import pyautogui<br/>import tkinter as tk</span></pre><p id="6bbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，是时候创建画布了。我们给它起个名字吧。我使用<code class="du lu lv lw kw b">title</code>方法将<code class="du lu lv lw kw b">Sc taker</code>设置为标题。您可以指定画布尺寸。我把<code class="du lu lv lw kw b">height</code>和<code class="du lu lv lw kw b">width</code>设为<code class="du lu lv lw kw b">300</code>。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="78ee" class="la jt hi kw b fi lb lc l ld le">root= tk.Tk()<br/>root.title('Sc taker')<br/>canvas1 = tk.Canvas(root, width = 300, height = 300)</span></pre><p id="1c9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们用<code class="du lu lv lw kw b">pack</code>方法打包画布。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="28b7" class="la jt hi kw b fi lb lc l ld le">canvas1.pack()</span></pre><p id="b6bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经准备好画布，让我们定义一个函数来捕捉屏幕截图。我把它命名为<code class="du lu lv lw kw b">myScreenshot</code>。</p><p id="e225" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要创建一个对象来存储我们的截图。我把它命名为<code class="du lu lv lw kw b">sc</code>。因此，我们将从<code class="du lu lv lw kw b">sc</code>上的<code class="du lu lv lw kw b">PyAutoGUI</code>调用<code class="du lu lv lw kw b">screenshot</code>方法。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="4c9f" class="la jt hi kw b fi lb lc l ld le">def myScreenshot():<br/>  myScreenshot = pyautogui.screenshot()</span><span id="9660" class="la jt hi kw b fi lx lc l ld le">  myScreenshot.save(r'C:\Users\imar\Desktop\Python Tutotial\screenshot1.png')</span></pre><p id="4ccb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用<code class="du lu lv lw kw b">save</code>方法保存我们的截图。给出正确的路径和截图名称。</p><p id="aa83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们创建一个按钮并指定几个参数。</p><ul class=""><li id="d015" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">我正在设置按钮的<code class="du lu lv lw kw b">text</code>为<code class="du lu lv lw kw b">Take Screenshot</code>。</li><li id="3444" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">我正在通过我在<code class="du lu lv lw kw b">command</code>的<code class="du lu lv lw kw b">myScreenshot</code>功能。</li><li id="b370" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lu lv lw kw b">Background</code>和<code class="du lu lv lw kw b">foreground</code>颜色分别为<code class="du lu lv lw kw b">green</code>和<code class="du lu lv lw kw b">white</code>。</li><li id="4c5d" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">最后，我将<code class="du lu lv lw kw b">font</code>设置为<code class="du lu lv lw kw b">15</code>。</li></ul><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="c22b" class="la jt hi kw b fi lb lc l ld le">myButton = tk.Button(text='Take Screenshot', command=myScreenshot, bg='green',fg='white',font= 15)</span></pre><p id="ae93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们的按钮准备好了，让我们把它放在中间。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="4a0d" class="la jt hi kw b fi lb lc l ld le">canvas1.create_window(150, 150, window=myButton)</span></pre><p id="7640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们将调用我们的<code class="du lu lv lw kw b">mainloop</code>。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="e76e" class="la jt hi kw b fi lb lc l ld le">root.mainloop()</span></pre><p id="f555" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的 Python 脚本准备好了。运行该程序，您会看到类似这样的内容。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/c527fad01635c22723dff25fe2aded6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/0*c3T-XXRI3Zi5S8Cf"/></div></figure><p id="5259" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击<code class="du lu lv lw kw b">Take Screenshot</code>按钮时。新的屏幕截图将被捕获并保存在您指定的路径中。</p><p id="1e05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！很简单，不是吗？</p><p id="85b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在我的<a class="ae jp" href="https://github.com/ayushi7rawat/Youtube-Projects/tree/master/Screenshot%20taker%20app" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>找到所有代码。发现有用就掉颗星。</p><p id="5e88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读，我很乐意通过<a class="ae jp" href="https://twitter.com/ayushi7rawat" rel="noopener ugc nofollow" target="_blank"> Twitter </a>与您联系。</p><p id="f9fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请分享您的宝贵反馈和建议！</p><p id="31d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你绝对应该看看我的其他博客:</p><ul class=""><li id="a55c" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated"><a class="ae jp" href="https://ayushirawat.com/python-39-all-you-need-to-know" rel="noopener ugc nofollow" target="_blank"> Python 3.9:你需要知道的一切</a></li><li id="a73d" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae jp" href="https://ayushirawat.com/the-ultimate-python-resource-hub" rel="noopener ugc nofollow" target="_blank">终极 Python 资源枢纽</a></li><li id="62c4" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae jp" href="https://ayushirawat.com/github-cli-10-all-you-need-to-know" rel="noopener ugc nofollow" target="_blank"> GitHub CLI 1.0:你需要知道的一切</a></li><li id="164a" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae jp" href="https://ayushirawat.com/become-a-better-programmer" rel="noopener ugc nofollow" target="_blank">成为更好的程序员</a></li><li id="b3d1" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae jp" href="https://ayushirawat.com/how-to-make-your-own-google-chrome-extension-1" rel="noopener ugc nofollow" target="_blank">如何制作自己的谷歌 Chrome 扩展</a></li><li id="872e" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae jp" href="https://ayushirawat.com/create-your-own-audiobook-from-any-pdf-with-python" rel="noopener ugc nofollow" target="_blank">使用 Python 从任何 pdf 创建您自己的有声读物</a></li><li id="93e8" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">你很重要，你的心理健康也很重要！</li></ul><h1 id="b852" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">资源:</h1><ul class=""><li id="eb5c" class="lf lg hi ih b ii kq im kr iq lz iu ma iy mb jc lk ll lm ln bi translated"><a class="ae jp" href="https://pyautogui.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">pyautogui.readthedocs.io/en/latest</a></li></ul><p id="6c95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的下一篇博客文章中再见，保重</p></div></div>    
</body>
</html>