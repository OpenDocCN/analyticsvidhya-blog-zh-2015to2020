<html>
<head>
<title>Simple Linear Regression, Cost Function &amp; Gradient Descent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单线性回归、成本函数和梯度下降</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-linear-regression-cost-function-gradient-descent-50c5ed085770?source=collection_archive---------8-----------------------#2020-12-31">https://medium.com/analytics-vidhya/simple-linear-regression-cost-function-gradient-descent-50c5ed085770?source=collection_archive---------8-----------------------#2020-12-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="dba3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://en.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank"> <em class="jd">线性回归</em> </a>是一种强大的统计技术和机器学习算法，用于预测通常为连续数据的两个变量或因素之间的关系。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/9ae4889056710a3f05e8f737b2e67ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dG6m4wnx3ARPtZPd8qf1tQ.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图1:线性回归| GIF:走向数据科学</figcaption></figure><h1 id="ee41" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">应用线性</strong> <strong class="ak">回归</strong></h1><p id="4833" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">线性回归主要用于了解业务和影响盈利能力的因素，对业务趋势进行评估和预测。线性回归用于分析产品的市场有效性、定价和促销。它还用于评估银行业的风险，并用于推荐系统。</p></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><p id="7738" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们考虑一个简单的房价预测示例，其中房价是基于给定的房屋面积来预测的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es le"><img src="../Images/29cb14dc2d3dbff2350db9ce986f3669.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*EoYAk48m16NBPuY1pZOBuQ.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图2:房屋数据</figcaption></figure><p id="ec74" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用上述数据，我们可以构建一个散点图，从中可以得出一条回归线。回归线以这样一种方式通过，即该线更接近大多数点(图1)。这可以通过最小化<em class="jd">成本函数</em>来实现。因为有一个因变量，即可以被视为X的面积，而要预测的价格是Y，所以我们可以得出一个线性方程Y = c1 + c2*X，其中给定的X值Y可以很容易地计算出来。</p><h1 id="5c89" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">C1的值应该是多少&amp; c2？</strong></h1><p id="d4a8" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">这些常量的值精确地决定了回归线，使得回归线更接近最大点数。让我们考虑3个简单的数据点，其中X和Y是预定义的，我们需要为这些数据找到一条最佳的直线。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lf"><img src="../Images/6617f35baa933534a75bdfe5f0fa0cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*d4E5HOCbNu9Y___YkCmuQA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图3:数据点</figcaption></figure><p id="3a34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过观察，我们可以看到X=Y，因此c1和c2的值应该是多少，才能使直线通过大多数数据点。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lg"><img src="../Images/de93dc1a6fd7ac21f80cf8bdecec392d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VMWXqSiCYmDT-j7DC0SAoA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">从左到右:图4a、图4b、图4c</figcaption></figure><p id="71cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以再次观察到，通过改变等式Y = c1 + c2*X中的c1和c2，我们可以得到不同的线，其中我们可以观察到<em class="jd">图4c </em>其中该线通过最佳拟合的所有点。现在，我们可以知道c1 &amp; c2的最佳值分别为0 &amp; 1，将这些值代入等式，我们得到Y=0 +1X → Y=X，因此，现在我们可以使用该等式预测任意给定X值的Y。类似地，我们可以为房屋数据绘制一个散点图(图2 ),并找出最适合的数据。</p><blockquote class="lh li lj"><p id="d25d" class="ie if jd ig b ih ii ij ik il im in io lk iq ir is ll iu iv iw lm iy iz ja jb ha bi translated">这不像我们对上面3个数据点所做的那样简单，现在我们有数百万个数据点用于房屋数据</p></blockquote></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h1 id="7876" class="ju jv hh bd jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn lr kp kq kr bi translated">计算机如何知道哪条线最合适？</h1><p id="6912" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">这是当<em class="jd">成本函数</em>进入画面时，成本函数计算平均误差(损失函数),我们的目标是尽可能减少成本函数，以获得最佳拟合线。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lg"><img src="../Images/60703e90b4670b0ec85cb9e1c6d51283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7q75z8ySjuULn7l5JiO4OQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图5:误差| L至R图:5a、5b、5c</figcaption></figure><blockquote class="lh li lj"><p id="cf17" class="ie if jd ig b ih ii ij ik il im in io lk iq ir is ll iu iv iw lm iy iz ja jb ha bi translated">代价函数是<strong class="ig hi"> J(c1，c2) =1/2m ∑( Y`- Y) </strong>共同写成如下方程<strong class="ig hi">注:</strong>【c1,c2)=(θ₀,θ₁】&amp;y `= y(hat)=假设</p></blockquote><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ls"><img src="../Images/92ad637e55cfa28f386a0c07f388413d.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*9Cujfp98Le1jvHhthsDdbw.png"/></div></figure><ul class=""><li id="475b" class="lt lu hh ig b ih ii il im ip lv it lw ix lx jb ly lz ma mb bi translated">Y →实际值(基本事实)</li><li id="0949" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">Y` = c1+c2X →(预测值)称为假设，即</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mh"><img src="../Images/feeec279c60810d7acb33d5b7dfc5bfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*cFsBs6ND_LC4ztrgAMSKgA.png"/></div></figure><ul class=""><li id="59a6" class="lt lu hh ig b ih ii il im ip lv it lw ix lx jb ly lz ma mb bi translated">m →数据点的数量</li><li id="829b" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">1/2m和平方误差是为了计算平均值和简化数学</li></ul><h1 id="9167" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">成本函数:</strong></h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mi"><img src="../Images/36656238e07637ca8d48f663bff4b270.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*Md6mgdROR9ad8eImPqzb3w.png"/></div></figure><p id="c121" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们通过使用(图5)中的示例来解方程<strong class="ig hi"> <em class="jd"> J(c1，c2) =1/2m ∑( Y`- Y) </em> </strong>来理解它</p><p id="e358" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">图</em><strong class="ig hi"><em class="jd">5a</em></strong>→C1 = 2&amp;C2 = 0因此Y`= 2，m=3</p><p id="5718" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd"> J(c1，C2)=(1/2 * 3)*((2–1)+(2–2)+(2–3))</em><strong class="ig hi">=<em class="jd">0.33</em></strong></p><p id="d245" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">图</em><strong class="ig hi"><em class="jd">5b</em></strong>→C1 = 0&amp;C2 = 0.5y ` = 0+0.5X→y ` = 0.5X<strong class="ig hi"/>且m=3</p><p id="721c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd"> J(c1，C2)=(1/2 * 3)*((0.5–1)+(1–2)+(1.5–3))</em><strong class="ig hi">=<em class="jd">0.58</em></strong></p><p id="d2c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">图</em><strong class="ig hi"><em class="jd">5c→</em></strong>C1 = 0&amp;C2 = 1<strong class="ig hi"/>y ` = 0+X→<strong class="ig hi">y ` = X</strong>且m=3</p><p id="a8d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd"> J(c1，C2)=(1/2 * 3)*((1–1)+(2–2)+(3–3))</em><strong class="ig hi">=<em class="jd">0</em></strong></p><p id="f7e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">比较以上所有示例，图5c给出了最小成本函数，因此我们可以知道图5c中c1=0和c2=1是最佳拟合。因此，现在我们知道哪条线是最佳拟合线，以及如何计算成本函数来获得最接近大多数数据点的最佳拟合线。</p><blockquote class="lh li lj"><p id="b230" class="ie if jd ig b ih ii ij ik il im in io lk iq ir is ll iu iv iw lm iy iz ja jb ha bi translated"><strong class="ig hi">注</strong>:为了计算成本函数，我们需要事先知道c1和c2的值，其中c1和c2可以根据数据集在范围内变化，也可以负向变化以获得更好的拟合。那么，如何动态更新c1和c2的值，直到达到最佳拟合？</p></blockquote><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lf"><img src="../Images/f368b4db235b80304d7ca2290897742b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*WFpl0Eqd64GlQ0g_BvW5NQ.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图6:具有负C2值的数据</figcaption></figure></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h1 id="ff6a" class="ju jv hh bd jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn lr kp kq kr bi translated">如何动态更新c1和c2的值？</h1><p id="2627" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">这可以通过称为<a class="ae jc" href="https://en.wikipedia.org/wiki/Gradient_descent#:~:text=Gradient%20descent%20is%20a%20first,the%20direction%20of%20steepest%20descent." rel="noopener ugc nofollow" target="_blank"> <em class="jd">梯度下降</em> </a> <em class="jd"> </em>的算法来解决，该算法将找到c1和c2的最佳值<a class="ae jc" href="https://en.wikipedia.org/wiki/Maxima_and_minima#:~:text=(Formally%2C%20if%20f%20is%20continuous,at%20critical%20points%20(or%20points" rel="noopener ugc nofollow" target="_blank">局部最小值</a>，使得<em class="jd">成本函数为</em>最小值。如果成本函数最小，那就是我们的回归线最适合的时候。</p><blockquote class="lh li lj"><p id="58b7" class="ie if jd ig b ih ii ij ik il im in io lk iq ir is ll iu iv iw lm iy iz ja jb ha bi translated"><strong class="ig hi">注意</strong> : c1和c2只不过是众所周知的参数，当调整时，我们得到回归直线(c1，c2) →(θ₀,θ₁的最佳拟合。这些也被称为<strong class="ig hi"> <em class="hh">权重</em> </strong>，它们在机器学习算法中被计算并被存储为模型，当给定输入为x时，该模型预测输出y’</p></blockquote><p id="2d6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">梯度下降的整体思想是，我们可以给定c1和c2的任意随机初始值，然后使用梯度下降算法，通过评估每次迭代的成本函数，考虑每次迭代中的所有数据，更新c1和c2。向局部极小值迈进了一步。</p><h1 id="cf2a" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">梯度下降</strong></h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mj"><img src="../Images/1618fae9926f6dcdbd651294351f3236.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*96gBP0iFQrL6S_Ak4FZytA.png"/></div></figure><ul class=""><li id="5fcb" class="lt lu hh ig b ih ii il im ip lv it lw ix lx jb ly lz ma mb bi translated">c1，c2 →两个可以计算成本函数的参数</li><li id="1f79" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">J(c1，c2) →上面在图5中解释的成本函数</li><li id="e35e" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">α → <a class="ae jc" href="http://Learning rate" rel="noopener ugc nofollow" target="_blank"> <em class="jd">学习率</em> </a>用于参数的梯度下降</li></ul><p id="e1c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以在上面的等式中看到，c1和c2通过找到<em class="jd">成本函数</em>的偏微分并将其乘以<em class="jd">学习率(α)来更新。</em></p><blockquote class="lh li lj"><p id="eca0" class="ie if jd ig b ih ii ij ik il im in io lk iq ir is ll iu iv iw lm iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong> c1和c2或(θ₀,θ₁…)任何数量的参数必须同时更新。我将发表新的文章详细解释为什么这和数学背后的梯度下降</p></blockquote><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mk"><img src="../Images/27f47a93433b6c683e51cc3609a5eecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*e88JKNWAFok3vpjeuPfHig.gif"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">梯度下降</figcaption></figure></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h1 id="ef45" class="ju jv hh bd jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn lr kp kq kr bi translated"><strong class="ak">概要:</strong></h1><p id="1ee0" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">你所要做的就是用下面的公式计算参数，你的模型就可以预测了。干杯！！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ml"><img src="../Images/769020c8d1f45a499ff9cb1a7639870f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*sOkZD89uaBZgYj66ZdIe5Q.png"/></div></figure></div></div>    
</body>
</html>