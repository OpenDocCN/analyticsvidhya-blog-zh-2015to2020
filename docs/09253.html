<html>
<head>
<title>Integrating a Machine Learning Model with Django</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Django集成机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/integrating-a-machine-learning-model-with-django-79dd47eabef1?source=collection_archive---------10-----------------------#2020-08-30">https://medium.com/analytics-vidhya/integrating-a-machine-learning-model-with-django-79dd47eabef1?source=collection_archive---------10-----------------------#2020-08-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9b5083134a4a5277c2bbb59e133fca34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HVKOLLX7wprRbHTl2IPDcQ.png"/></div></div></figure></div><div class="ab cl iq ir gp is" role="separator"><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv"/></div><div class="hb hc hd he hf"><p id="d357" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">首先，我们想使用<a class="ae jv" href="https://joblib.readthedocs.io/en/latest/generated/joblib.dump.html" rel="noopener ugc nofollow" target="_blank"> joblib </a>将我们的模型编译成一个漂亮的小。pkl文件。我已经训练了一个关于网络欺凌数据的分类器，所以这就是我将在这个项目中使用的。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="2009" class="kf kg hi kb b fi kh ki l kj kk">clf = DecisionTreeClassifier()<br/>        ......<br/>import joblib<br/>joblib.dump(clf,'cybermodel.pkl')</span></pre><p id="219f" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">现在我们有了。pkl文件，我们可以为django项目建立一个虚拟环境。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="00bb" class="kf kg hi kb b fi kh ki l kj kk">#creates a virtual environment named mlproj<br/>virtualenv --python=python3 mlproj</span><span id="0e22" class="kf kg hi kb b fi kl ki l kj kk">#activates the virtual environment<br/>\path\to\mlproj\Scripts\activate   </span></pre><h1 id="1260" class="km kg hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">建立你的Django项目</strong></h1><p id="07be" class="pw-post-body-paragraph ix iy hi iz b ja lj jc jd je lk jg jh ji ll jk jl jm lm jo jp jq ln js jt ju hb bi translated">在CLI中键入以下命令来设置django项目</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="5971" class="kf kg hi kb b fi kh ki l kj kk">#install django and other packages<br/>&gt; pip install django scikit-learn<br/>&gt; django-admin startproject cyberproj<br/>&gt; cd cyberproj<br/>&gt; python manage.py startapp core    #create an app</span></pre><p id="2550" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">现在，将您的应用程序添加到settings.py文件中的INSTALLED_APPS，并设置您的模板目录</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="1dd4" class="kf kg hi kb b fi kh ki l kj kk"># Application definition</span><span id="b9e4" class="kf kg hi kb b fi kl ki l kj kk">INSTALLED_APPS = [<br/>.....,<br/>'core'                            #your app<br/>]</span><span id="58f7" class="kf kg hi kb b fi kl ki l kj kk">...<br/>#set up your template directory</span></pre><h1 id="a184" class="km kg hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">包括你的。项目中的pkl文件</h1><p id="bbad" class="pw-post-body-paragraph ix iy hi iz b ja lj jc jd je lk jg jh ji ll jk jl jm lm jo jp jq ln js jt ju hb bi translated">在这里，我创建了一个模型文件夹并保存了我的。pkl文件在里面</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/64ac30e25d02531191bb665c646630a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*mQ0v8IH4R1CTZs2DdCHpsw.jpeg"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">model/cybermodel.pkl</figcaption></figure><h1 id="5ab6" class="km kg hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">资源定位符</h1><p id="ac6d" class="pw-post-body-paragraph ix iy hi iz b ja lj jc jd je lk jg jh ji ll jk jl jm lm jo jp jq ln js jt ju hb bi translated">此外，为您的应用程序创建一个<code class="du lt lu lv kb b">urls.py</code>文件，然后打开<code class="du lt lu lv kb b">cyberproj.urls</code>文件并包含应用程序的URL。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="8e72" class="kf kg hi kb b fi kh ki l kj kk">from django.urls import path,include</span><span id="7102" class="kf kg hi kb b fi kl ki l kj kk">urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('',include('core.urls')),     #include your app urls<br/>]</span></pre><h1 id="0edf" class="km kg hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">视图</h1><p id="fa21" class="pw-post-body-paragraph ix iy hi iz b ja lj jc jd je lk jg jh ji ll jk jl jm lm jo jp jq ln js jt ju hb bi translated">现在，让我们创建用于预测和显示结果的视图。</p><p id="3968" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated"><em class="lw">注意:我将加载我的训练数据作为CountVectorizer的词汇表。您的项目的要求可能会有所不同。</em></p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/e31699880d0e85c7be18fcdcf4108dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*caoCKFaWrwHfkhyUHwKIEA.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">mlproj/views.py</figcaption></figure><p id="17e5" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">让我们将视图添加到核心应用程序的urls.py文件中</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="78cf" class="kf kg hi kb b fi kh ki l kj kk">from django.urls import path<br/>from .views import index,predict</span><span id="f894" class="kf kg hi kb b fi kl ki l kj kk">app_name = 'core'</span><span id="6db5" class="kf kg hi kb b fi kl ki l kj kk">urlpatterns = [<br/>    path('',index,<em class="lw">name</em>='index'),<br/>    path('predict/',predict,<em class="lw">name</em>='predict'),<br/>]</span></pre><p id="7ee0" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">所以基本上有两个视图，一个索引视图(用于主页)和一个显示预测结果的视图。在索引视图模板(index.html)中，我包含了一个发送到预测视图的表单。</p><p id="cf9a" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">表单接收文本输入，并将其发送到预测视图。然后，文本输入被转换为稀疏矩阵，该模型预测该输入是否可以被定义为网络欺凌(1或0)。然后，预测和文本输入被传递到预测视图的上下文中。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/d81e958d75ce1758bc5cf82e51618656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYEMEX05ihNbCJeWJ_vxPA.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">index.html模板中的表单</figcaption></figure><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/3a984908f2a8250085f5589e1133158a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aGrbr-j7l2zuP9FsRnGeoQ.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">在result.html模板中显示结果</figcaption></figure><p id="f8e3" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">运行<code class="du lt lu lv kb b">python manage.py migrate</code>和<code class="du lt lu lv kb b">python manage.py makemigrations</code>进行必要的迁移。</p><p id="715f" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">跑<code class="du lt lu lv kb b">python manage.py runserver</code></p><div class="jw jx jy jz fd ab cb"><figure class="ma ij mb mc md me mf paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/635e49de099df0a093a20743cfa68282.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*XbR6vwaK7R7AyhxTzjxZeA.jpeg"/></div></figure><figure class="ma ij mg mc md me mf paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/8634f32b2c88623e4f96b5243b420e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*Dm6QaeJ8cG9bxuKpSAAymw.jpeg"/></div></figure></div><div class="ab cb"><figure class="ma ij mh mc md me mf paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/d12fd7b4608bcdbd9164e5d2bac72036.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*cq24McdORG10TwVC6Czgzg.jpeg"/></div></figure><figure class="ma ij mi mc md me mf paragraph-image"><img src="../Images/5b223a77b1cd719150325852b666a652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*rZvKCiCl8zvTpv71u1xDzA.jpeg"/></figure></div><p id="7c19" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated"><strong class="iz hj"> <em class="lw">管用！</em> </strong></p><p id="5f2d" class="pw-post-body-paragraph ix iy hi iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hb bi translated">点击查看代码<a class="ae jv" href="https://github.com/Fawaz441/ml_with_django" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>