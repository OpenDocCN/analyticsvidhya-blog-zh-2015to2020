<html>
<head>
<title>Time Series Forecast with Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Excel进行时间序列预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-forecast-with-excel-749515813f77?source=collection_archive---------5-----------------------#2020-07-12">https://medium.com/analytics-vidhya/time-series-forecast-with-excel-749515813f77?source=collection_archive---------5-----------------------#2020-07-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1594c50e9c31ba06e45597b1a3836a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_wdOmdFiazVrkBMmnZKhA.jpeg"/></div></div></figure><p id="d2bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2006年，我加入了管理信息系统团队。我们是这个组织的数据管理员。即使是Excel(2003版)对我来说也是全新的、令人着迷的。然后我们开始学习预测技术。一个由六名适马专业人员组成的团队擅长制作年度、月度和每周预测。由于Excel功能有限，他们使用Minitab通过时间序列技术生成预测。当时我几乎不能理解时间序列。对我来说，这是一个相当迷人的主题:利用历史数据预测未来！</p><p id="9fe6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随着时间的推移，我和Excel都发展了分析能力。预测模型已经成为我们两个的常规功能。本文解释了使用预测表生成预测所涉及的步骤。</p><p id="3e5d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Excel 2016中引入的预测表(仅适用于windows)使预测生成成为一个两步流程。</p><p id="3ae8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在数据功能区下找到该功能:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/9870433127630a02836f344c15ff4f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*71HMt4FgLtJU3VUpzBfyiQ.png"/></div></div></figure><h1 id="9141" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">基本功能:预测。美国教育考试服务中心</h1><p id="890f" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">预测表使用指数平滑<em class="kw">季节算法(ETS AAA) </em>预测，使用内置函数预测。ETS <em class="kw">。</em>它使用一个等式对时间序列建模，该等式考虑了<em class="kw">加性误差</em>、<em class="kw">加性趋势</em>和<em class="kw">加性季节性</em>。这种算法也就是俗称的<strong class="is hj"> <em class="kw">霍尔特-温特斯算法</em> </strong>。它被广泛用于预测和计划商业需求。</p><p id="fe90" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">换句话说，当<a class="ae kx" href="https://www.vivran.in/post/what-is-a-time-series" rel="noopener ugc nofollow" target="_blank">时间序列数据</a>具有趋势和季节性时，预测表可用于预测。</p><h1 id="b6b9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使用预测表生成预测</h1><p id="0d85" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">它主要需要两列:</p><p id="7929" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.要预测的值(预测变量)</p><p id="5a97" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.具有连续时间段的列(可以是每月的第一天、每年的时间线或分配给每个时间段的序列号)</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/c531ff4d394423699aafd93328395278.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/0*GVkfMjucV84XS6EY.png"/></div></figure><p id="5eb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于一个时间序列，一个一致的时期是必须的。它可以是值在每月1日的月间隔、年间隔或数字间隔。</p><p id="7c77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集可能有值的空白记录，但这些记录只占总记录的30%或更少。预测表还处理同一时间戳或时间段的多个记录。但是，建议汇总数据集(以确保相同时间戳的唯一记录)</p><p id="1160" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择两列&gt;数据&gt;预测表</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/738300e7deb282f113e9f21cdbded4f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*nq2II6y_bY20SLGX.gif"/></div></figure><p id="c1cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据&gt;预测表</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/800ed38b14c3055b9d019caa3e6c51d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*ao6crzvO5QTbNhcEJDpIsQ.gif"/></div></figure><p id="2c2e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它会打开一个预测工作表窗口:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es la"><img src="../Images/07c604356b20267692d9abab2c09541b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*cqzsGDQi9521xyRluEFNeg.png"/></div></figure><h1 id="1f4f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">预测工作表的组成部分</h1><p id="eb18" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">预测结束:</strong>定义预测周期数(图中用橙色表示)。Excel会创建一个包含历史数据和预测值的表格。</p><p id="dac7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">预测开始:</strong>定义预测的开始点。您可以选取历史数据结束之前的一个时间段。当您这样做时，预测工作表会忽略该期间以外的所有值。在本例中，如果我们将预测起始时间从16更改为11，预测工作表将考虑点1至10来生成预测。</p><p id="3ee5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在最后一个历史点之前开始预测可以让您感觉到预测的准确性，因为您可以将预测序列与实际数据进行比较。</p><p id="75e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kw">但是，如果过早开始预测，生成的估计不一定代表使用所有历史数据生成的预测。</em></p><p id="8d72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用所有的历史数据会给你一个更准确的预测。</p><p id="0a15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">置信区间:</strong>勾选或取消勾选置信区间显示或隐藏。置信区间是预测值周围的一个范围。95%的置信区间表示95%的预测值预计落在该范围内。</p><p id="5478" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">季节性:</strong>它是一个完整数据周期所需的时间步长数，在此之后，该周期在整个时间序列中重复。默认情况下，它会自动检测数据集的季节性。你可以使用公式<strong class="is hj">预测。ETS .季节性</strong>计算数据集中的季节性。</p><p id="04c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">填充缺失点使用:</strong>当数据集中的值缺少数据点时很有用。</p><ul class=""><li id="692c" class="lb lc hi is b it iu ix iy jb ld jf le jj lf jn lg lh li lj bi translated">如果选择零，则它将缺失值视为0并计算预测(不推荐，需要业务判断)</li><li id="30b5" class="lb lc hi is b it lk ix ll jb lm jf ln jj lo jn lg lh li lj bi translated">如果选择插值，它将使用缺失值周围相邻数据点的加权平均值。当缺失值少于总记录的30%时，它可以工作。</li></ul><p id="cc04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">聚合重复项使用:</strong>如果数据集在同一期间有多条记录，默认情况下，Excel使用这些值的平均值进行预测。例如，对于期间10，如果我们有两个值为5 &amp; 6的记录，那么预测表使用5.5(5&amp;6的平均值)作为期间10的值。</p><p id="6561" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以根据数据和预期预测值更改默认计算:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/efb6bbc1f88b62c50cc059cad57913f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*0UnAQAoy6EB-LWfJ.png"/></div></figure><p id="60ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">包含预测统计:</strong>选中此选项可获取以下统计信息:</p><ul class=""><li id="93bc" class="lb lc hi is b it iu ix iy jb ld jf le jj lf jn lg lh li lj bi translated">α，β，γ(平滑系数)</li><li id="6104" class="lb lc hi is b it lk ix ll jb lm jf ln jj lo jn lg lh li lj bi translated">梅斯<strong class="is hj">，</strong>斯马佩，梅伊，RMSE — <a class="ae kx" href="https://www.vivran.in/post/measuring-forecast-accuracy" rel="noopener ugc nofollow" target="_blank">预测模型</a>的精度度量。</li></ul><h1 id="843e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">预测单的输出</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/bf871439fcc4d4037a5b0a5a2f985f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6f5f1Ip3ujH_PNxJSWXxQ.png"/></div></div></figure><p id="853a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">C列中的值是对未来期间的预测。列D &amp; E分别代表估计的下限和上限。因此，对于期间17，平均预测值为7.3，可能在6.9到7.8之间变化(95%的置信度)。</p><p id="51a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kw">我写关于</em><a class="ae kx" href="https://www.vivran.in/my-blog/categories/excel" rel="noopener ugc nofollow" target="_blank"><em class="kw">MS Excel</em></a><em class="kw"/><a class="ae kx" href="https://www.vivran.in/my-blog/categories/powerquery" rel="noopener ugc nofollow" target="_blank"><em class="kw">权力查询</em></a><em class="kw"/><a class="ae kx" href="https://www.vivran.in/my-blog/categories/powerbi" rel="noopener ugc nofollow" target="_blank"><em class="kw">权力毕</em></a><em class="kw"/><a class="ae kx" href="https://www.vivran.in/my-blog/categories/power-pivot" rel="noopener ugc nofollow" target="_blank"><em class="kw">权力中枢</em></a><em class="kw"/><a class="ae kx" href="https://www.vivran.in/my-blog/categories/dax" rel="noopener ugc nofollow" target="_blank"><em class="kw">DAX</em></a><em class="kw"/><a class="ae kx" href="https://www.vivran.in/my-blog/categories/data-analytics" rel="noopener ugc nofollow" target="_blank"><em class="kw">数据分析【数据</em></a></p><p id="67cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kx" href="https://twitter.com/imvivran" rel="noopener ugc nofollow" target="_blank"> @imVivRan </a></p></div></div>    
</body>
</html>