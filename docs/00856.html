<html>
<head>
<title>Improving meteorological and ocean models with Machine Learning (part 1: assessing the meteorological model)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习改进气象和海洋模式(第一部分:评估气象模式)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/improving-meteorological-and-ocean-models-with-machine-learning-part-1-assessing-the-4c309851a81e?source=collection_archive---------9-----------------------#2019-09-13">https://medium.com/analytics-vidhya/improving-meteorological-and-ocean-models-with-machine-learning-part-1-assessing-the-4c309851a81e?source=collection_archive---------9-----------------------#2019-09-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cbce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在最后一部分<a class="ae jd" rel="noopener" href="/analytics-vidhya/improving-meteorological-and-ocean-models-with-machine-learning-part-0-set-up-a-data-frame-4abd3744ec75">(第0部分)</a>，我们定义了一个数据框，其中的列是气象变量。气象站观测的变量(“_o”扩展)和数学模型预测的变量(“_p”扩展)。行是每小时可变的日期类型。</p><p id="a471" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们获取数据框并导入一些库来绘制结果:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="eaec" class="jn jo hi jj b fi jp jq l jr js">import pandas as pd<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt</span><span id="6081" class="jn jo hi jj b fi jt jq l jr js">#from Github link <br/>url=”<a class="ae jd" href="https://raw.githubusercontent.com/granantuin/LEVX_class/master/maestro.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/granantuin/LEVX_class/master/maestro.csv</a>"<br/>master=pd.read_csv(url,index_col=”datetime”,parse_dates=True)</span></pre><p id="4a7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变量<em class="ju"> dir_o，mod_o，wind_gust_o，mslp_o，temp_o，rh_o，visibility_o，</em>有其对应的预测变量(<em class="ju"> dir_p，mod_p </em>等等)。</p><p id="1039" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从温度变量开始，展示一个观察温度和预测温度的散点图。类型:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="e5ad" class="jn jo hi jj b fi jp jq l jr js">sns.scatterplot(x=”temp_o”, y=”temp_p”, data=master)</span></pre><p id="858a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得到了:</p><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es jv"><img src="../Images/4e092bafec31e965f24285d672fc7c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*r8qdOur41xpJ9Npf8SBpLA.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">预测温度(temp_p)与观察温度(temp_o)</figcaption></figure><p id="a503" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哎呀！在上中心位置有明显的异常值。我们应该过滤数据帧:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="89e8" class="jn jo hi jj b fi jp jq l jr js">master_f=master[master.temp_o &lt; 310].copy()</span></pre><p id="b750" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关性看起来很好，大约为0.948029</p><p id="70da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码比较了观察到的温度(temp_o)与模型本身预测的温度(temp_p)之间的差异，以及一个新的预测变量(temp_p_lr)。预测的新变量是通过将观察和预测的温度调整到线性回归而获得的</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="ce1a" class="jn jo hi jj b fi jp jq l jr js">from sklearn.linear_model import LinearRegression<br/>reg = LinearRegression().fit(master_f[“temp_p”].values.reshape(-1, 1), master_f[“temp_o”].values.reshape(-1, 1))</span><span id="a7c1" class="jn jo hi jj b fi jt jq l jr js">master_f[“temp_p_lr”]=reg.predict(master_f[“temp_p”].values.reshape(-1, 1))</span><span id="881a" class="jn jo hi jj b fi jt jq l jr js">master_f[“dif_temp”]=master_f[“temp_o”]-master_f[“temp_p”]<br/>master_f[“dif_temp_lr”]=master_f[“temp_o”]-master_f[“temp_p_lr”]<br/>master_f[[“dif_temp”,”dif_temp_lr”]].plot(kind=”box”,grid=True, figsize=(8,8))</span></pre><p id="12b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用describe()方法的分析结果是:</p><figure class="je jf jg jh fd jw er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/da58b7f09b8d0f7304d7c6f09ddd2b6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*UbMTl1NfJrB9Z4l6YyXOEg.gif"/></div></div></figure><p id="6f54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和箱线图显示</p><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es ki"><img src="../Images/c1a3a1f1fa6c97c39d6f31335b1f8fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*UHSp7vOSAanAsQaGPcOjDg.png"/></div></figure><p id="320c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以说该模型表现良好。观测温度和预测温度之间的平均温差几乎为零(0.1357)，标准偏差为1.9。线性回归可以用来提高平均值几乎为0和标准差相似。</p><p id="237f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一个表现良好的变量是海平面的减压。相关系数0.98。难以提高！！我们可以用Seaborn库显示结果。也有一个异常值。要过滤异常值，请使用:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="131e" class="jn jo hi jj b fi jp jq l jr js">master_f=master[master.mslp_o&gt;90000].copy()</span></pre><p id="3f12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Seaborn:</p><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es kj"><img src="../Images/b36f7d60d804d5b09330c0116f5b2c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*AAiBqAdPau9fG8JZ_BYnWg.png"/></div></figure><p id="067f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">调整到线性回归并在10个箱中聚集点。我们得到:</p><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es kj"><img src="../Images/fc9e169519d87cd39eb680da269a27d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*Fn4cfJD1GLZmDtKEZtEoTA.png"/></div></figure><p id="bde6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获得上述图的代码是:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="a749" class="jn jo hi jj b fi jp jq l jr js">sns.regplot(x=master_f.mslp_o/100, y=master_f.mslp_p/100, x_bins=10, data=master_f)</span></pre><p id="905e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们除以100得到一个友好变量，毫巴。看起来这个模型表现很好，我们不需要任何机器学习算法来改进它。</p><p id="bf69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们要看看这个模型在其他变量上是否表现良好。让我们来看看风向、风力、相对湿度和能见度。代码应该是:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="1bea" class="jn jo hi jj b fi jp jq l jr js">sns.scatterplot(x=”dir_p”, y=”dir_o”, data=master[master.dir_o!=-1])</span><span id="cda3" class="jn jo hi jj b fi jt jq l jr js">sns.scatterplot(x=”mod_p”, y=”mod_o”, data=master)</span><span id="d077" class="jn jo hi jj b fi jt jq l jr js">sns.scatterplot(x=”rh_p”, y=”rh_o”, data=master)</span><span id="022a" class="jn jo hi jj b fi jt jq l jr js">sns.scatterplot(x=”visibility_p”, y=”visibility_o”, data=master[master.visibility_p&lt;10000])</span></pre><p id="17ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在dir_o(编码为-1)中过滤可变风向，并在能见度变量中设置10000米的阈值，因为是机场站报告的最大能见度。</p><p id="6d72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有变量的散点图如下:</p><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es kk"><img src="../Images/f4ca74a07421d27eb295f8c797291a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*BpUxgEG1boHadYuSo1Urjw.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">观察到的风向与预测的风向</figcaption></figure><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es kl"><img src="../Images/ebc41cf496f6b436fe527daa4b1c5217.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*iX6xFEwnTUjoqT-lmID7lQ.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">观测的风力强度与预测的风力强度</figcaption></figure><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es km"><img src="../Images/1a54733432723d356e5a90a1af56fb86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*cTTPiPCsPwJhBEwh5QDnDw.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">观测能见度与预测能见度</figcaption></figure><figure class="je jf jg jh fd jw er es paragraph-image"><div class="er es kn"><img src="../Images/75cd4bff7469f85d0cd6de48b169db8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*7C6cKUeULlnoEcmPwxT-Pw.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">观测湿度与预测湿度</figcaption></figure><p id="ab99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关指数为:</p><ul class=""><li id="f8f9" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">风力强度(mod变量):0.63</li><li id="ef6c" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">风向(方向可变):0.33</li><li id="8e82" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">相对湿度(相对湿度可变):0.76</li><li id="0881" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">能见度(能见度变量):0.36</li></ul><h2 id="2ae2" class="jn jo hi bd lc ld le lf lg lh li lj lk iq ll lm ln iu lo lp lq iy lr ls lt lu bi translated">结论和展望</h2><p id="d33c" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">该模型在压力和温度变化时表现良好。高精度压力变量(相关系数为0.98)。相关指数为0.95的温度可以使用一个变量的线性回归稍微改善。</p><p id="e65d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他预测变量，如风速、方向或能见度，需要大量的机器学习算法，因为模型获得的结果很乱。可变的相对湿度在中间，也许我们可以只用一个线性回归来改进预测。</p><p id="d05e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好消息是，该模型在四个变量上表现不佳，我们可以通过应用各种机器学习技术来增强它。我们可以建立二元分类模型来检测危险阈值，如大风强度或低能见度。</p><p id="cb1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，分类问题只预测主要方向的风向，如北、东北、东等。另一类问题是应用于各种连续变量的回归问题。我们必须直接选择模型中的一些预测变量，或者使用主成分分析对这些变量进行变换。</p><p id="d076" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一篇文章，我将尝试使用深度学习来预测可见性阈值。我忘记了这个坏消息。感谢你阅读我！</p></div></div>    
</body>
</html>