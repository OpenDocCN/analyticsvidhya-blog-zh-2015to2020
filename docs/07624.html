<html>
<head>
<title>Predicting Indian Stock market behaviour in the times of Covid-19, and analysing it’s impact on country’s economy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测新冠肺炎时代的印度股市行为，并分析其对国家经济的影响</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-indian-stock-market-behaviour-in-the-times-of-covid-19-and-analysing-its-impact-on-9e46be88c978?source=collection_archive---------24-----------------------#2020-07-01">https://medium.com/analytics-vidhya/predicting-indian-stock-market-behaviour-in-the-times-of-covid-19-and-analysing-its-impact-on-9e46be88c978?source=collection_archive---------24-----------------------#2020-07-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="66cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">简介<br/> </strong>预测股票市场的表现是最困难的事情之一，疫情可以彻底改变它的行为。预测中涉及到很多因素——物理因素与心理因素、理性和非理性行为等等。所有这些因素结合在一起，使得股价波动很大，很难高度准确地预测。我们能在这个领域使用机器学习(ML)作为游戏改变者吗？使用组织的最新公告、季度收入结果等功能。，机器学习技术有可能挖掘出我们以前没有看到的模式和见解，这些可以用来做出准确无误的预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/505571c22be651b5569937246115e659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eumSUxLD_-Hrf8tHYpVpFg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">关闭价格历史与日期</figcaption></figure><h1 id="7f0d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">问题陈述</h1><p id="e924" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我们的目标是预测Nifty的每日调整收盘价，使用前N天的数据(即预测范围=1)使用移动平均、线性回归、kNN、Prophet和LSTM等技术。我们将使用从2007年11月27日到2020年5月29日的13年历史价格，可以从<a class="ae kw" href="https://www.nseindia.com/market-data/real-time-data-subscription" rel="noopener ugc nofollow" target="_blank"> NSE India </a>轻松下载。下载后，数据集如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/f868d210bd756ae900eab71ea63259cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F6w3QLGvyMhkYY5hSg7r3g.png"/></div></div></figure><h2 id="7277" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">移动平均数</h2><p id="18a9" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">每天的预测收盘价将是一组先前观察值的平均值。我们将使用移动平均技术，而不是简单的平均，移动平均技术对每个预测使用最新的一组值。换句话说，对于每个后续步骤，在从集合中删除最早的观察值时，会考虑预测值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/f87a3c014a5d408679cea9ace0d4bc46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3dT8KAGOXW_wUvhIi8EZQ.png"/></div></div></figure><p id="95b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查RMSE并不能帮助我们理解模型是如何运行的，我们必须将它可视化，以获得更直观的理解。这是预测值和实际值的曲线图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/d2f2dc23cae8d505a0ac5951feb84a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_bCq1ikwNnQwwKHxGCnjQ.png"/></div></div></figure><h2 id="091f" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">推理</h2><p id="b04b" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">RMSE值接近105，(RMSE: 110.53)，但结果并不乐观(从图中可以看出)。</p><h2 id="88e3" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">线性回归</h2><p id="8afd" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">可以在这些数据上实现的最基本的机器学习算法是线性回归。线性回归模型返回一个确定自变量和因变量之间关系的方程。这是一种简单的技术，很容易理解，但是有几个明显的缺点。使用回归算法的一个问题是模型过度适应日期和月份列。模型将考虑一个月前相同的<em class="lo">日期</em>或一年前相同的<em class="lo">日期/月份</em>的值，而不是从预测的角度考虑以前的值。</p><h2 id="361e" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">先知</h2><p id="364c" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">有许多时间序列技术可以在股票预测数据集上实现，但是这些技术中的大多数在拟合模型之前需要大量的数据预处理。由脸书设计和首创的Prophet是一个时间序列预测库，它不需要数据预处理，实现起来非常简单。Prophet的输入是一个包含两列的data frame:date和target (ds和y)。</p><p id="65e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet试图捕捉过去数据中的季节性，当数据集很大时效果很好。这里有一篇有趣的文章，以简单直观的方式解释了Prophet:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/ec81790b1ac5fc6d858dbe4fa027ab80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*PnYKw4UkqAB-STrmiv90Qw.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/c13c833876fc0b349e0cf1bed1a0b2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6TTGqTNm-0gxTUcz_Vz6Bg.png"/></div></div></figure><h2 id="a8a8" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">结果</h2><p id="7c6b" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">均方根值为68.74，但该图不令人满意。</p><h2 id="bb30" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">推理</h2><p id="8975" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">Prophet(像大多数时间序列预测技术一样)试图从过去的数据中捕捉趋势和季节性。该模型通常在时间序列数据集上表现良好，但在这种情况下却名不副实。</p><p id="43f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实证明，股票价格没有特定的趋势或季节性。这在很大程度上取决于目前市场的行情，因此价格会有涨有跌。因此，像ARIMA、萨里玛和预言家这样的预测技术对于这个特殊的问题不会显示出好的结果。</p><p id="812d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们继续尝试另一种先进的技术——长短期记忆(LSTM)。</p><h2 id="8a1b" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">长短期记忆(LSTM)</h2><p id="9f0d" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">LSTMs被广泛用于序列预测问题，并被证明是非常有效的。它们如此有效的原因是因为LSTM能够存储过去重要的信息，并忘记不重要的信息。LSTM有三个城门:</p><ul class=""><li id="dca2" class="lq lr hi ih b ii ij im in iq ls iu lt iy lu jc lv lw lx ly bi translated"><strong class="ih hj">输入门:</strong>输入门向单元状态添加信息</li><li id="39c8" class="lq lr hi ih b ii lz im ma iq mb iu mc iy md jc lv lw lx ly bi translated"><strong class="ih hj">遗忘之门:</strong>它删除模型不再需要的信息</li><li id="6412" class="lq lr hi ih b ii lz im ma iq mb iu mc iy md jc lv lw lx ly bi translated"><strong class="ih hj">输出门:</strong>LSTM输出门选择要显示的信息输出</li></ul><p id="cb01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们将LSTM实现为一个黑盒，并检查它在特定数据上的性能。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/a03b2cd57bdd8c0b8ca5342725f08937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*bbgPbdok8eNe41fct-QtQA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/71e17c81de6cb4e793d8c27c24fe4aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNf4TEqeERCLN4MiO9HISA.png"/></div></div></figure><h2 id="af7f" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">结果</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/581f0e5a5fccbf8997704c0291c8d7b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g2mZ5qs4W1u7cIgZJJfxsQ.png"/></div></div></figure><p id="e93d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">均方根值为11.7722</p><h2 id="f46a" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">推理</h2><p id="d18d" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">哇！LSTM模型可以针对各种参数进行调整，例如更改LSTM层数、添加下降值或增加历元数。但是，LSTM的预测是否足以确定股票价格是上涨还是下跌呢？肯定不是！</p><p id="5fc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我在文章开始时提到的，股票价格受到有关公司的新闻和其他因素的影响，如公司的非货币化或合并/拆分。还有一些无形的因素通常是无法预先预测的。</p><h2 id="f618" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">新冠肺炎和股市崩盘</h2><p id="f3fc" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">由于全球市场的影响，印度金融市场目前正经历剧烈波动。这一下跌与全球基准指数一致，因为国内市场通常会跟踪主要的全球指数，而高波动性可能会在不久的将来持续下去。此外，随着海外投资者(FPI)从新兴市场转向美元支持的安全资产，导致印度股市大幅下跌。S&amp;P BSE Sensex指数在2020年1月20日为42273点，在2020年4月8日为29894点。Sensex的市盈率低于18(2020年3月31日的市盈率为17.81)，远低于20-24的历史区间。大、中、小盘股市场已经从峰值大幅回调。2020财年，中型股指数下跌了26%，而Sensex指数下跌了22%。</p><h2 id="b71e" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">股票市场有崩盘和复苏的历史</h2><p id="6c10" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">全球股市有一段崩盘和复苏的历史，印度股市也不例外。在《哈沙德·梅塔骗局》(Harshad Mehta Scam)中，Sensex在一年内暴跌53%，但在1.5年内收复了127%的失地。在“亚洲危机”(1996年)期间，Sensex指数在4年内下跌40%，但在一年内反弹115%。在“科技泡沫”(2000年)期间，Sensex指数在1.5年内暴跌56%，但在2.5年内反弹138%。当美国面临“房地产——雷曼”危机(2008年)时，Sensex指数在一年内暴跌61%，但在1.5年内反弹157%。在不到3个月的时间里，目前的市场已暴跌约30%。由于新冠肺炎，没有人知道经济何时会回到正轨。一些专家甚至将这次经济崩溃与20世纪的“大萧条”相提并论。“大萧条”始于1929年，一直持续到20世纪30年代末。1929年至1932年期间，全球国内生产总值(国内总产值)下降了约15%。相比之下，在2008年至2009年的大衰退期间，全球GDP下降了不到1%。</p><h2 id="d369" class="ky ju hi bd jv kz la lb jz lc ld le kd iq lf lg kh iu lh li kl iy lj lk kp ll bi translated">当前股票市场的复苏</h2><p id="b300" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">指望经济从当前的新冠肺炎效应中快速反弹是愚蠢的。虽然金融危机是不可避免的，但考虑到各国央行和财政当局全力以赴减轻冲击，深度经济衰退可能会避免。预计2020年世界各地区以及所有行业的贸易量都将大幅下降。但此后全球贸易可能会迅速反弹。然而，这将取决于疫情多快得到控制，以及政府采取何种政策来支持其经济。一旦这个疫情结束，商业和经济恢复正常，股票市场将开始朝着积极的方向发展，正如过去所见证的那样，复苏将比预期更快。高度可取的是，不要跳入市场或不要试图抓住下跌的刀。</p></div></div>    
</body>
</html>