<html>
<head>
<title>What About a 6-Week Machine Learning Project? Beginners Friendly Cat vs Dog Classification Problem.(Week 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为期 6 周的机器学习项目怎么样？初学者友好的猫 vs 狗分类问题。(第三周)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-about-a-6-week-machine-learning-project-e16033dd32f4?source=collection_archive---------23-----------------------#2020-08-11">https://medium.com/analytics-vidhya/what-about-a-6-week-machine-learning-project-e16033dd32f4?source=collection_archive---------23-----------------------#2020-08-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/cb461ceee622679a834aacdb442d5f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ZCHyGbDByq44f68FtETug.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型总结。</figcaption></figure><p id="6b10" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">前进，是的！！！然而，我为期 6 周的 ML 项目又过去了一周，到目前为止，发生了许多令人兴奋的时刻。</p><p id="063e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在第一周，我从 Kaggle 那里得到了一个适合这个项目的数据集，并把它保存在我的硬盘里，这个硬盘又被安装到了 Google Colab 上。然后，我研究了猫和狗的目录、训练和测试集，并找到了获取标签的方法。</p><p id="b82f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">由于没有可用的验证集，我自己创建了一个，由于我的数据完全由图像组成，它被预处理并转化为张量。</p><p id="d962" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我知道，每当我们处理大型数据集时，创建特定批量的数据批次并对这些批次进行处理总是一个更好的主意。所以我也创建了数据批处理和可视化。</p><p id="5135" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所有这些令人兴奋的事情都发生在第一周。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/cb938ca66fda2a40b4ec13757ee3d447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOaxFEKBN_vtwLH-X7BLUg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">第二周</figcaption></figure><p id="f817" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来计划的事情是:</p><ol class=""><li id="a578" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr kd ke kf kg bi translated">建筑模型。</li><li id="496e" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr kd ke kf kg bi translated">创建回调。</li></ol><h1 id="663f" class="km kn hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">建筑模型</h1><p id="7a69" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated">我们有自己的数据集、图像标签、验证集，将图像转换成张量并生成数据批次。我们都准备向前迈进，并选择一个合适的模型来做训练，与猫和狗的训练设置。</p><p id="7626" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了选择模型，我们可以利用<a class="ae js" href="https://tfhub.dev/" rel="noopener ugc nofollow" target="_blank"> Tensorflow Hub </a>。这里有 100 个可用的机器学习模型，我们可以根据我们的问题选择领域，即我们是在处理图像问题、文本问题还是视频问题。由于我们的问题域是图像分类，可以从图像部分选择一个合适的模型，并在我们的 Google Colab 中使用。本项目中使用的型号为<a class="ae js" href="https://tfhub.dev/google/imagenet/mobilenet_v2_140_224/classification/4" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">imagenet/mobilenet _ v2 _ 140 _ 224/class ification</strong></a><strong class="iw hj">。</strong></p><p id="67d3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我们的项目中使用这个模型非常容易，因为它允许我们下载模型或者只是复制模型的 URL。</p><p id="e225" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在构建模型之前，首先要定义一些东西。</p><ol class=""><li id="c45c" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr kd ke kf kg bi translated">输入形状。</li><li id="b977" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr kd ke kf kg bi translated">输出形状。</li><li id="e908" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr kd ke kf kg bi translated">模型 URL。</li></ol><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="0bc9" class="lu kn hi lq b fi lv lw l lx ly">INPUT_SHAPE = [<strong class="lq hj">None</strong>, IMG_SIZE, IMG_SIZE, 3]<br/>OUTPUT_SHAPE = 2<br/>MODEL_URL = <br/>"https://tfhub.dev/google/imagenet/mobilenet_v2_140_224/classification/4"</span></pre><p id="b9fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们在函数的帮助下建立模型。该函数执行以下操作:</p><ul class=""><li id="4369" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr lz ke kf kg bi translated">接受输入形状、输出形状和模型 url。</li><li id="8db8" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr lz ke kf kg bi translated">以连续的方式定义层。</li><li id="e08b" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr lz ke kf kg bi translated">编译模型。</li><li id="ec70" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr lz ke kf kg bi translated">建立模型。</li><li id="fce8" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr lz ke kf kg bi translated">归还模型。</li></ul><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="7db5" class="lu kn hi lq b fi lv lw l lx ly"><strong class="lq hj">def</strong> create_our_model(input_shape = INPUT_SHAPE, output_shape = OUTPUT_SHAPE, model_url = MODEL_URL):<br/>  <em class="ma"># Setup the layers</em><br/>  model = tf.keras.Sequential([<br/>                               hub.KerasLayer(MODEL_URL), <em class="ma"># Layer 1 input layer</em><br/>                               tf.keras.layers.Dense(units=OUTPUT_SHAPE,<br/>                                                     activation="sigmoid") <em class="ma"># Layer 2 Output layer</em><br/>  ])<br/><br/>  <em class="ma"># Compile the model</em><br/>  model.compile(<br/>      loss=tf.keras.losses.CategoricalCrossentropy(),<br/>      optimizer=tf.keras.optimizers.Adam(),<br/>      metrics=["accuracy"]<br/>  )<br/>   <em class="ma"># Build the model</em><br/>  model.build(INPUT_SHAPE)<br/><br/>  <strong class="lq hj">return</strong> model</span><span id="a16b" class="lu kn hi lq b fi mb lw l lx ly">model = create_our_model()<br/>model.summary()</span><span id="7b67" class="lu kn hi lq b fi mb lw l lx ly">Model: "sequential"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>keras_layer (KerasLayer)     (None, 1001)              6158505   <br/>_________________________________________________________________<br/>dense (Dense)                (None, 2)                 2004      <br/>=================================================================<br/>Total params: 6,160,509<br/>Trainable params: 2,004<br/>Non-trainable params: 6,158,505<br/>_________________________________________________________________</span></pre><p id="1d96" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这样，我们的模型就创建好了，可以在以后的过程中使用。</p><h1 id="1f9f" class="km kn hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">创建回调</h1><p id="d127" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated">我们将在一定数量的时期内训练我们的模型，比如说 100 个时期，如果模型在连续数量的时期内给我们相同的精度值，这意味着我们的模型已经停止改进。因此，即使模型被训练了 100 个时期，精确度的值也不会改变，因为它在 15、16 个时期后变成常数。因此，当我们的模型停止改进并开始创建相同的精度值时，我们可以创建回调并停止训练。</p><p id="1c7a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，回调是模型在训练过程中可以使用的辅助函数，用来保存进度、检查进度或在模型停止改进时提前停止训练。</p><p id="33ce" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">创建了 2 个回调:</p><ul class=""><li id="868f" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr lz ke kf kg bi translated">一个用于 TensorBoard，帮助跟踪我们的模型进度。</li><li id="f2a4" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr lz ke kf kg bi translated">另一个是提前停止，防止我们的模型训练太长时间。</li></ul><p id="846b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">冲浪板回调</strong></p><p id="f45f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在创建 tensorboard 回调之前，必须进行适当的设置，包括:</p><ol class=""><li id="a26a" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr kd ke kf kg bi translated">加载 TensorBoard 笔记本扩展。【https://www.tensorflow.org/tensorboard/tensorboard】<a class="ae js" href="https://www.tensorflow.org/tensorboard/tensorboard_in_notebooks" rel="noopener ugc nofollow" target="_blank">_ in _ 笔记本。</a></li><li id="3306" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr kd ke kf kg bi translated">创建一个 TensorBoard 回调函数，它能够将日志保存到一个目录中，并将其传递给我们的 models fit()函数。</li><li id="1ba1" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr kd ke kf kg bi translated">用%tensorboard% magic 函数可视化我们的模型训练日志(我们将在模型训练后进行)。</li></ol><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="a47a" class="lu kn hi lq b fi lv lw l lx ly"><em class="ma"># Import tensorboard notebook extension.</em><br/>%load_ext tensorboard</span><span id="986b" class="lu kn hi lq b fi mb lw l lx ly"><strong class="lq hj">import</strong> <strong class="lq hj">datetime</strong><br/><br/><strong class="lq hj">def</strong> create_callback():<br/>  <em class="ma"># We need a log directory to store the tensorboard logs</em><br/>  logdir = os.path.join("drive/My Drive/CatVsDog/logs",<br/>                        datetime.datetime.now().strftime("%Y%m<strong class="lq hj">%d</strong>-%H%M%S"))<br/>  <strong class="lq hj">return</strong> tf.keras.callbacks.TensorBoard(logdir)</span></pre><p id="cda7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">提前停止回调</strong> </a></p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="136b" class="lu kn hi lq b fi lv lw l lx ly">early_stopping = tf.keras.callbacks.EarlyStopping(<br/>    monitor='val_accuracy',<br/>    patience=3<br/>)</span></pre><p id="625f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我的 Github Repo:<a class="ae js" href="https://github.com/Rohithv07/6WeekPro/blob/master/Cat_Vs_Dog.ipynb" rel="noopener ugc nofollow" target="_blank">https://Github . com/rohit v07/6 week pro/blob/master/Cat _ Vs _ dog . ipynb</a></p><h1 id="0eda" class="km kn hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">下一步是什么</h1><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/2bc7cbe3a876ce783411232b6959b468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lqN0M-NnSQMdziP224xJA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">第 3 周计划</figcaption></figure><p id="3fa4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们已经建立了模型并创建了回调，让我们继续我们感兴趣的部分，即:</p><ul class=""><li id="ef3d" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr lz ke kf kg bi translated">训练我们的模型(对数据子集)。</li><li id="a48e" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr lz ke kf kg bi translated">做出并评估预测。</li></ul><p id="d742" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，这是我下周的主要目标，这将帮助我们了解我们已经建立的模型是否适合在完整数据集上进行训练。在这里，我计划从数据的子集开始训练，这样如果遇到任何问题，我们可以很容易地改变我们的模型或导致问题的任何参数，从而节省时间，而不是从完整的数据集开始我们的模型。通常，在大型数据集上进行训练需要大量的时间，如果不顺利，我们将会损失开发周期中相当大的一部分时间来尝试修补。因此，我在数据子集上训练模型，如果一切顺利，那么我们准备好继续处理完整的数据集。</p><p id="246c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">希望这周一切都会好起来，就像到目前为止一样。我真诚地希望我的这个项目能按时圆满完成。</p></div></div>    
</body>
</html>