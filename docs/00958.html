<html>
<head>
<title>Creating a Recommender Engine Using Amazon Personalize</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Amazon Personalize创建推荐引擎</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/creating-a-recommender-engine-using-amazon-personalize-eae85da8ea21?source=collection_archive---------10-----------------------#2019-09-21">https://medium.com/analytics-vidhya/creating-a-recommender-engine-using-amazon-personalize-eae85da8ea21?source=collection_archive---------10-----------------------#2019-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7fb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客文章中，我将带你了解如何使用亚马逊提供的最新托管机器学习服务之一，名为“<a class="ae jd" href="https://aws.amazon.com/personalize/" rel="noopener ugc nofollow" target="_blank">个性化</a>”。</p><p id="19f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用一些模拟数据来训练一个神经网络，当输入特定的用户id时，它最终会提供推荐的产品。</p><p id="b455" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇博文将解释我的方法。让我们开始吧！</p><h1 id="ed40" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">数据清理和准备</h1><h2 id="ffb2" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">连接数据</h2><p id="86bf" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">提供的数据在5个单独的CSV中。为了创建一个大型CSV，我使用了Pandas数据帧并执行了完全外部连接。只要两个表之间有一个匹配的属性，完全外连接就简单地接受所有属性的联合。注意，AWS Personalize只接受一个<br/>单一csv文件，所以这一步是必需的。</p><p id="146a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://gist.github.com/tdshah/78eaa87cbc3505de05f18da6d5c9e29d.js" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/TD shah/78 ea a87 CBC 3505 de 05 f 18 da 6 D5 C9 e 29d . js</a></p><p id="9541" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Personalize要求以下特性的名称与指定的名称完全一致，因此我重命名了相应的列，以匹配“USER_ID”、“TIMESTAMP”和“ITEM_ID”。这三个特征是使用Personalize训练的任何模型的最低要求，因为它们详细描述了a)谁购买了该物品b)购买了什么物品c)购买该物品的时间。</p><h2 id="6e20" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">时间戳转换</h2><p id="8bf1" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">对于“时间戳”列，个性化需要Unix时间戳。我通过应用执行转换的lambda函数将所需的列转换为Unix时间。</p><p id="a7b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://gist.github.com/tdshah/29cb3f6b18a29c667dd5208b16a127dd.js" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/TD shah/29 CB 3 f 6b 18 a 29 c 667 DD 5208 b 16 a 127 DD . js</a></p><h2 id="2c95" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">其他数据转换</h2><p id="a1cb" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">我有一列数据“是”和“否”，我通过应用执行转换的lambda函数将它们转换为0和1。</p><p id="d427" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://gist.github.com/tdshah/0782d0a9a8bba9c37e940a0c62cdca3c.js" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/TD shah/0782 d0 a9 A8 bb a9 c 37 e 940 A0 c 62 DCA 3c . js</a></p><p id="b1f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我手工删除了对创建模型没有直接帮助的特性(主要是像first_name，last_name这样的字符串)。还有一个“zipcode”属性，我把它去掉了。邮政编码本来可以使用，但就其现状而言，它被视为一个连续变量，尽管它应该被视为分类变量(数字较高的邮政编码并不意味着什么)。要解决这个问题，您可以创建一个区域映射(例如，西海岸邮政编码=“1”)。中西部邮政编码= "2 "等。这个映射会将邮政编码转换成一个连续变量，因为您可以比较邮政编码<br/>区域的数量。</p><h1 id="f58c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">模型准备</h1><h2 id="efcb" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">特征选择</h2><p id="de10" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">我使用了3种不同的<a class="ae jd" href="https://towardsdatascience.com/feature-selection-techniques-in-machine-learning-with-python-f24e7da3f36e" rel="noopener" target="_blank">方法</a>(单变量选择、特征重要性、相关矩阵)来执行特征选择，以查看哪些特征对模型最重要。</p><p id="0ea9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单变量选择-</p><p id="f688" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://gist.github.com/tdshah/b6f999bf94f646dc113dd0ab86a6df86.js" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/TD shah/b 6 f 999 BF 94 f 646 DC 113 DD 0 ab 86 a6 df 86 . js</a></p><p id="d182" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">功能重要性-</p><p id="5bcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://gist.github.com/tdshah/d8e09b22dc85478783101c0d4f325f91.js" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/TD shah/d 8 e 09 b 22 DC 85478783101 c0d 4 f 325 f 91 . js</a></p><p id="b93b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关矩阵-</p><p id="cf3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://gist.github.com/tdshah/ce79df7489bfa1fee63c27664f2bc7e3.js" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/TD shah/ce 79 df 7489 BFA 1 fee 63 c 27664 F2 BC 7 e 3 . js</a></p><h2 id="7e55" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">超参数优化</h2><p id="6a2a" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">我在<a class="ae jd" href="https://aws.amazon.com/sagemaker/" rel="noopener ugc nofollow" target="_blank">亚马逊SageMaker </a>中使用超参数<br/>调优工作执行了超参数优化(HPO)。我在AWS Personalize中选择的解决方案(机器学习模型)“hrnn元数据”有3个超参数:recency_mask(布尔值)、hidden_dimension(值的范围)、bptt(值的范围)。HPO有助于确定为超参数设置什么起始值，之后个性化可以根据需要执行自动调整来更改超参数。</p><h1 id="89e9" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">训练模型</h1><p id="8123" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">我将清理后的CSV上传到S3存储桶中，并创建了适当的存储桶访问策略+ IAM角色，用于个性化访问亚马逊S3资源。</p><p id="5419" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在亚马逊个性化控制台**，</p><ol class=""><li id="80e7" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">创建了一个数据集组，我将CSV数据集上传到其中。我选择了<br/>“用户-商品交互数据集组类型”，因为我的数据集包含用户信息和商品信息，我的最终目标是找到这些属性之间的关系&amp;为特定用户提供产品推荐</li><li id="7f9b" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">创建了一个新的JSON格式的模式，它与我的数据集中的属性相匹配</li><li id="3043" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">创建了从提供的S3文件路径导入数据集的导入作业</li><li id="d9a3" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">创建的解决方案(机器学习模型)。请参见上文所选的解决方案类型。一旦创建了解决方案，就可以捕获描述模型性能的各种度量:标准化的折扣累积、精度、平均倒数排名</li><li id="e529" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">进一步的参数调整应该有助于提高模型的性能</li><li id="e66d" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">创建了一个活动，允许您通过输入用户id并获得推荐项目id的列表来测试训练模型</li></ol><p id="f35e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，可以通过AWS Personalize<br/>“get recommendations”API调用推荐引擎。这就是将结果返回到web应用程序或其他用户界面的方式。</p><ul class=""><li id="bc3b" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc lj lb lc ld bi translated">*这些步骤也可以通过<a class="ae jd" href="https://docs.aws.amazon.com/personalize/latest/dg/aws-personalize-set-up-sdks.html" rel="noopener ugc nofollow" target="_blank">Python SDK(boto 3)I</a>n而不是控制台来执行</li></ul></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="0304" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Tanmay Shah，黑客行业博客撰稿人</p></div></div>    
</body>
</html>