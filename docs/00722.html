<html>
<head>
<title>One-stop Guide to Data Manipulation in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中数据操作的一站式指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-data-manipulation-fb86d0cdd028?source=collection_archive---------0-----------------------#2019-09-01">https://medium.com/analytics-vidhya/python-data-manipulation-fb86d0cdd028?source=collection_archive---------0-----------------------#2019-09-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b51dde4f6be2b768aff9f857f54af57d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hmtfY-LiKI05JfWH4goRXA.png"/></div></div></figure><p id="aeb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于那些正在寻找所有数据操作代码和语法的一站式读物的读者来说，这篇文章非常有帮助。在本文中,‘PANDAS’库被用于数据操作。Pandas是一个流行的Python数据分析工具。它提供了易于使用和高效的数据结构。这些数据结构处理以表格形式存储的数字或标签数据。</p><p id="70ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文涵盖的主题:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/4846ddab86b01211824e10c98c5ef297.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*zNxZNEVldYTM30HyPtPV_A.png"/></div></figure><h1 id="2633" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.资料组</h1><p id="37da" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">美国房屋销售，1963年至2016年:全国和地区已出售和待售的新独栋房屋数量数据。还提供了关于中值和平均价格、按建设阶段划分的已出售和待售房屋数量的全国数据，以及其他统计数据。来自美国人口普查，经济时间序列指标。美国商务部Enigma.io提供的数据。</p><p id="35af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集有20，404行和20列。</p><h1 id="5c06" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2.将你的数据放入数据框架</h1><p id="ad39" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">从CSV文件加载数据帧</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="c443" class="lb ju hi kx b fi lc ld l le lf">df = pd.read_csv(‘file.csv’)</span><span id="8cfe" class="lb ju hi kx b fi lg ld l le lf">df = pd.read_csv(‘file.csv’, header=0, index_col=0, quotechar=’”’,sep=’:’, na_values = [‘na’, ‘-‘, ‘.’, ‘’])</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/ef6c1e7689ac05ee8d425d2a77975cf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*8f72BCPFK0zuYu5UaLrPvA.png"/></div></figure><h1 id="e01d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">3.保存数据帧</h1><p id="26e7" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">将数据帧保存到CSV文件</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="d062" class="lb ju hi kx b fi lc ld l le lf">df.to_csv(‘name.csv’, encoding=’utf-8')</span></pre><p id="b99e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">将数据帧保存到Python字典</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="224f" class="lb ju hi kx b fi lc ld l le lf">dictionary = df.to_dict()</span></pre><p id="cadf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">将数据帧保存到Python字符串</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="ae34" class="lb ju hi kx b fi lc ld l le lf">string = df.to_string()</span></pre><h1 id="7f57" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">4.使用整个数据框架</h1><p id="02df" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">查看数据帧内容</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="ddf2" class="lb ju hi kx b fi lc ld l le lf">df.info()</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es li"><img src="../Images/8df70f0a70e5d355c1ef6bcc22c14280.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*jSrXBpiPOO2mXxR4XbnGsg.png"/></div></figure><p id="8298" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">列统计汇总</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="c2e7" class="lb ju hi kx b fi lc ld l le lf">df.describe()</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/f500442217c794d7d90df3379683bc74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PJo3hmf101ojr_YTNg7DDg.png"/></div></div></figure><p id="054e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">头</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="f4c0" class="lb ju hi kx b fi lc ld l le lf">df.head(n)</span></pre><p id="8e08" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">尾巴</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="c8c8" class="lb ju hi kx b fi lc ld l le lf">df.tail(n)</span></pre><p id="74f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">形状(行数、列数)</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="b150" class="lb ju hi kx b fi lc ld l le lf">df.shape</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/ee86d3c9578ee8b106d8c33d0d0be1c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:246/format:webp/1*o9O3lK53iVRz7__8WANr3Q.png"/></div></figure><h1 id="e0c2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">5.使用行—第1部分</h1><p id="6793" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">守排</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="68ff" class="lb ju hi kx b fi lc ld l le lf">df = df[df['cat_code']== 'SOLD']</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/dd5ba29f516170ed38269c1e8d76b4df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*LJw2ws_rFLp11xiOrrdZtw.png"/></div></figure><p id="af44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">删除行</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="36a5" class="lb ju hi kx b fi lc ld l le lf">df = df[(df['dt_code']!= 'MEDIAN') &amp; (df['dt_code']!= 'NOTSTD') &amp;</span><span id="7a44" class="lb ju hi kx b fi lg ld l le lf">(df['dt_code']!= 'TOTAL')]</span></pre><p id="95cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">删除空值(NaN) </strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="626a" class="lb ju hi kx b fi lc ld l le lf">df = df[pd.notnull(df['dt_code'])]</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/8a570c55de2d5bbbd63ce716a2dcb522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*X_Lb92_QrxDqsEaI2yfmkw.png"/></div></figure><h1 id="0c71" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">6.使用列—第1部分</h1><p id="0c92" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">删除列</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="9391" class="lb ju hi kx b fi lc ld l le lf">df = df.drop(['et_idx','et_code','et_desc','et_unit'], axis=1)</span></pre><p id="201e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">保管栏</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="43c5" class="lb ju hi kx b fi lc ld l le lf">df = df[['per_name','dt_code','dt_desc','dt_unit','val']]</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/ff64755dd678a73cb7d5d5e8948743a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*t7oz56HDbYwzlIOAqLD04g.png"/></div></figure><p id="cd71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">向数据帧添加新列</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="1345" class="lb ju hi kx b fi lc ld l le lf">df['dt_year'] = df['per_name'].str[0:4]</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/00c033d0c9eb6b5f9d44d4219d37f144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9pEilr1ezh18i5YehW1tQ.png"/></div></div></figure><h1 id="f8da" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">7.用户定义的函数</h1><p id="4538" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">使用函数创建新列</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="f79c" class="lb ju hi kx b fi lc ld l le lf">def price (x):<br/>   if x.dt_unit == "K": return(x.val*1000)<br/>   else: return(x.val)<br/>   df['dt_val'] = df[['dt_unit','val']].apply(price, axis=1)</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/c3c37ecf3cf638a24c1aa29055a6a6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*2w56xRbCV6UlPcqg4qgg6Q.png"/></div></figure><h1 id="7ccb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">8.清洗数据集</h1><p id="bf85" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">创建三个数据集</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="7347" class="lb ju hi kx b fi lc ld l le lf">df_UNDERC = df[df['dt_code']==’UNDERC’]</span><span id="5595" class="lb ju hi kx b fi lg ld l le lf">df_COMPED = df[df['dt_code']==’COMPED’]</span><span id="6657" class="lb ju hi kx b fi lg ld l le lf">df_AVERAG = df[df['dt_code']==’AVERAG’]</span></pre><p id="55d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">保管栏</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="fce3" class="lb ju hi kx b fi lc ld l le lf">df_UNDERC = df_UNDERC[['per_name','dt_year','dt_val']]</span><span id="364b" class="lb ju hi kx b fi lg ld l le lf">df_COMPED = df_COMPED[['per_name','dt_year','dt_val']]</span><span id="c95f" class="lb ju hi kx b fi lg ld l le lf">df_AVERAG = df_AVERAG[['per_name','dt_year','dt_val']]</span></pre><p id="ffac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">重命名列</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="5d23" class="lb ju hi kx b fi lc ld l le lf">df_UNDERC = df_UNDERC.rename(columns={'dt_val':'UNDERC'})</span><span id="e7cc" class="lb ju hi kx b fi lg ld l le lf">df_COMPED = df_COMPED.rename(columns={'dt_val':'COMPED'})</span><span id="9a4a" class="lb ju hi kx b fi lg ld l le lf">df_AVERAG = df_AVERAG.rename(columns={'dt_val':'AVERAG'})</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/20ad43f5bc61ea4bf62a2aec85e863dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*nYU8bZeojE2M-aunr9TjMw.png"/></div></figure><h1 id="c0ed" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">9.连接/组合数据帧和分组依据</h1><p id="b865" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">在列上合并</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="5f11" class="lb ju hi kx b fi lc ld l le lf">df_new = pd.merge(left=df_AVERAG, right=df_COMPED, how='left',</span><span id="a775" class="lb ju hi kx b fi lg ld l le lf">left_on='per_name',right_on='per_name')</span><span id="dc56" class="lb ju hi kx b fi lg ld l le lf">df_new = pd.merge(left=df_new, right=df_UNDERC, how='left',</span><span id="53ba" class="lb ju hi kx b fi lg ld l le lf">left_on='per_name',right_on='per_name')</span></pre><p id="7b73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">分组——应用聚合函数</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="3c08" class="lb ju hi kx b fi lc ld l le lf">gb = df_new.groupby(['dt_year'])['AVERAG','COMPED','UNDERC'].agg(np.mean)</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/110afc00ae233fe0ca4169bef62b359c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*cs-C4S18x2brRlILoxYP6w.png"/></div></figure><h1 id="501b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">10.图表和统计</h1><p id="2a52" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">单线图</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="ade0" class="lb ju hi kx b fi lc ld l le lf">gb['AVERAG'].plot.line(color= 'green')</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/922fe0ae4d340ff821cee58dc4ba6c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*Q6Z4kHfSiciyPqFLR3eKLQ.png"/></div></figure><p id="16bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">多线条图形</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="daad" class="lb ju hi kx b fi lc ld l le lf">gb[['COMPED','UNDERC']].plot.line()</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/1d38ac2ed24dee94949ff095ba7b40ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*qPG028dYiNcEcBCiAsuvNA.png"/></div></figure><p id="11d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">相关性</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="f34d" class="lb ju hi kx b fi lc ld l le lf">gb.corr()</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/62327ac0c27625d99c5d4e7902375021.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*cfCkRysyq8v0YVR-THz6fw.png"/></div></figure><p id="6455" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">分位数</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="5666" class="lb ju hi kx b fi lc ld l le lf">quants = [0.05, 0.25, 0.5, 0.75, 0.95]</span><span id="e320" class="lb ju hi kx b fi lg ld l le lf">df_new = gb.quantile(quants)</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/f21c286a40555c216309a525b6b4dbc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*9cQx9L-FGK1ParAiy8Paxw.png"/></div></figure><p id="7107" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">直方图</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="8f32" class="lb ju hi kx b fi lc ld l le lf">import matplotlib.pyplot as plt</span><span id="8eb3" class="lb ju hi kx b fi lg ld l le lf">count, bins = np.histogram(gb['AVERAG'],bins=5)</span><span id="1730" class="lb ju hi kx b fi lg ld l le lf">plt.hist(gb['AVERAG'],bins=5,color='gray',edgecolor='white')</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/209b391893258ad34a60262917c3dfb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*1rGynOUtwLxU3XUdTxR0Cg.png"/></div></figure><h1 id="44d4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">11.使用行—第2部分</h1><p id="efc5" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">对数据帧的行值进行排序</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="6bee" class="lb ju hi kx b fi lc ld l le lf">gb = gb.sort_values(by='AVERAG',ascending=False)</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/55805b5815ab13af0d08563cb0d03be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*A-aUETUlTDnor8nGpa-9Zg.png"/></div></figure><p id="ac20" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">按行索引对数据帧进行排序</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="c961" class="lb ju hi kx b fi lc ld l le lf">gb = gb.sort_index()</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/dfdf3f7f4e4f796a64fde8557763f8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KdmTt-i_mRXNqQQaMO5KMg.png"/></div></figure><p id="aed8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">按整数位置选择一片行</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="e0b5" class="lb ju hi kx b fi lc ld l le lf">gb = gb[32:]</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/0aabde88f8be8a7d9accf3cff4422203.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*H_1oxBpI1ciOgGiQMU2SGA.png"/></div></figure><h1 id="aa6e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">12.使用列—第2部分</h1><p id="987a" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">在</strong>栏中找到最小/最大值的索引标签</p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="8d84" class="lb ju hi kx b fi lc ld l le lf">print(gb['AVERAG'].idxmin())</span><span id="6617" class="lb ju hi kx b fi lg ld l le lf">print(gb['AVERAG'].idxmax())</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/e6705ec5afdd0551b5edc7442dadfa3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:100/format:webp/1*vCO0pHuOef9ylLAKRpn67g.png"/></div></figure><p id="d253" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">整体数据框架上的数学</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="f00b" class="lb ju hi kx b fi lc ld l le lf">print(gb.count())</span><span id="8cdb" class="lb ju hi kx b fi lg ld l le lf">print(gb.mean())</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/0a729f56832837be61fbbc45e3e6acff.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*1Cpps6K8HPsnf-K8UJ9lpQ.png"/></div></figure><p id="42ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">常见的全列方法</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="3dec" class="lb ju hi kx b fi lc ld l le lf">print(gb['AVERAG'].count())</span><span id="64f4" class="lb ju hi kx b fi lg ld l le lf">print(gb['AVERAG'].mean())</span><span id="8a8c" class="lb ju hi kx b fi lg ld l le lf">print(gb['AVERAG'].describe())</span></pre><p id="0c3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">常见的基于元素的方法</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="7c2c" class="lb ju hi kx b fi lc ld l le lf">s = gb['AVERAG'].fillna(0)</span><span id="e05d" class="lb ju hi kx b fi lg ld l le lf">s = df_new['AVERAG'].cumsum()</span></pre><p id="2454" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">对列应用numpy数学函数</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="7706" class="lb ju hi kx b fi lc ld l le lf">df_new['log_data'] = np.log(df_new['AVERAG'])</span><span id="21d3" class="lb ju hi kx b fi lg ld l le lf">df_new['rounded'] = np.round(df_new['log_data'], 2)</span></pre><h1 id="4ed9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">13.使用单元格</h1><p id="313d" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">通过行列标签选择单元格</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="8943" class="lb ju hi kx b fi lc ld l le lf">print('AVG price in 1996: ',round(gb.loc['1996','AVERAG'],2))</span><span id="590e" class="lb ju hi kx b fi lg ld l le lf">print('AVG price in 2006: ',round(gb.loc['2006','AVERAG'],2))</span><span id="9239" class="lb ju hi kx b fi lg ld l le lf">print('AVG price in 2016: ',round(gb.loc['2016','AVERAG'],2))</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/fd95025686119981e7d02a956046dd11.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*xsjw3OVqvM1J1gcSLIMJiA.png"/></div></figure><p id="422c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">通过行列标签设置单元格</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="6edc" class="lb ju hi kx b fi lc ld l le lf">gb.loc['1976','AVERAG'] = -1000</span></pre><p id="6148" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">选择并切割标签</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="5fcb" class="lb ju hi kx b fi lc ld l le lf">df_new = gb.loc['2007':'2016', 'AVERAG':'UNDERC']</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/afb0bad33fd621604ddf7ef23b0c25f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*jw3Ir5YNqwU3H76Nx4dcHA.png"/></div></figure><p id="8a01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">选择行</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="c5ed" class="lb ju hi kx b fi lc ld l le lf">print(gb.loc['2016'])</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/3c24a30afdf6c599d78b19d83c41cc3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*ApGd8f-tKTb9hH8p1r3yhw.png"/></div></figure><p id="6d87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">选择列</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="323d" class="lb ju hi kx b fi lc ld l le lf">print(gb['AVERAG'])</span></pre><h1 id="d3c6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">14.处理缺少的值和字符串</h1><p id="18ab" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">删除所有有NaN的行</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="c29d" class="lb ju hi kx b fi lc ld l le lf">df = df.dropna()</span></pre><p id="dd57" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">删除所有带NaN的列</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="94aa" class="lb ju hi kx b fi lc ld l le lf">df = df.dropna(axis=1)</span></pre><p id="e227" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">删除NaN出现两次以上的所有行</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="e79b" class="lb ju hi kx b fi lc ld l le lf">df=df.dropna(thresh=2)</span></pre><p id="72fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">删除特殊列中出现NaN的所有行</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="af96" class="lb ju hi kx b fi lc ld l le lf">df = df.dropna(df['AVERAG'].notnull())</span></pre><p id="2dae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">记录所有缺失数据</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="932a" class="lb ju hi kx b fi lc ld l le lf">df.fillna(0, inplace=True)</span></pre><p id="31ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">在特殊栏中记录缺失数据</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="7e7f" class="lb ju hi kx b fi lc ld l le lf">s = df['AVERAG'].fillna(0)</span></pre><p id="8ff6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用琴弦</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="9b47" class="lb ju hi kx b fi lc ld l le lf">s = df['col'].str.lower()</span><span id="e631" class="lb ju hi kx b fi lg ld l le lf">s = df['col'].str.upper()</span><span id="b79f" class="lb ju hi kx b fi lg ld l le lf">s = df['col'].str.len()</span><span id="88a3" class="lb ju hi kx b fi lg ld l le lf">s = df['col'].str.replace('old', 'new')</span></pre><h1 id="ea43" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">15.数据透视表</h1><p id="19fe" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated"><strong class="is hj">枢轴</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="7996" class="lb ju hi kx b fi lc ld l le lf">df_pt = pd.pivot_table(df,index='dt_year',columns='dt_code',</span><span id="718c" class="lb ju hi kx b fi lg ld l le lf">values='dt_val',aggfunc=np.mean)</span></pre><p id="8471" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">头</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="152d" class="lb ju hi kx b fi lc ld l le lf">df_pt.head()</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/7f5bc72221591fbaaf4e2df592bde1fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*4AQzqkpJpgLOjxoO_CyP-Q.png"/></div></figure><p id="2854" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">尾巴</strong></p><pre class="jp jq jr js fd kw kx ky kz aw la bi"><span id="5e92" class="lb ju hi kx b fi lc ld l le lf">df_pt.tail()</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es md"><img src="../Images/96c3d76ca4a84d6a78714b9a21726b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*Ku_h5Edwoq67TF7Lg5YPng.png"/></div></figure></div></div>    
</body>
</html>