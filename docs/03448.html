<html>
<head>
<title>How to skip Youtube ads using python?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用python跳过Youtube广告？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-skip-youtube-ads-using-python-e44b82004a99?source=collection_archive---------3-----------------------#2020-02-02">https://medium.com/analytics-vidhya/how-to-skip-youtube-ads-using-python-e44b82004a99?source=collection_archive---------3-----------------------#2020-02-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/af6b915dbb0055a2298ba5882c4d3865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FP3EW6ZcRHADQ97h"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@ytcount?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> YTCount </a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="ba2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Youtube视频已经成为我们日常生活的一部分。不像电视，它帮助我们观看我们感兴趣的内容。</p><p id="526c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我还广泛使用youtube进行娱乐和教育。</p><p id="48a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于广告是youtube.com的主要收入来源，因此，他们前所未有地使用它。</p><p id="8380" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我遇到的一个问题是，我有边吃饭边看电视的习惯。现在在youtube上，当我看一个节目/视频时，每当有广告出现时，我都必须点击跳过广告按钮。</p><p id="e1f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，我习惯在聆听灵性导师的教导时冥想。每次广告来的时候，我的沉思都会被打扰。</p><p id="62b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我决定创建一个机器学习模型，它可以识别屏幕上是否有广告，并点击跳过广告按钮。</p><p id="6536" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我开始使用Windows snipping工具收集数据集。由于神经网络需要大量的数据来训练，我收集了大约600张图像。几乎300张图片包含跳过广告按钮，另外300张图片属于其他类别标签。</p><p id="ec7f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我意识到用手动方式收集图像是非常困难的。我知道我可以使用市场上的任何软件录制屏幕。因此，我在互联网上搜索分离视频的帧，以便我可以将每一帧作为单独的图像。</p><p id="e703" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">OpenCV可以选择这样做。所以，我了解了这一点，并把每一帧分开。数据收集部分变得非常快。现在我有大约1800张图片来训练一个模型。</p><p id="aa5e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我意识到大尺寸的图像即使在谷歌实验室也很难训练。我缩小了图像的尺寸，尽管它占用了太多的空间，以至于每次我训练一个模型时，Google Colab笔记本都会崩溃。</p><h2 id="4d1e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">特征工程</h2><p id="e661" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我尝试了另一种技术，其中我只选择了图像中有跳过按钮的部分。我使用numpy索引切片只选择图像的一部分。</p><p id="8416" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如预期的那样，训练进行得很顺利，模型的训练准确率达到了99%左右。</p><p id="13c6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我使用pyautogui库点击屏幕上的特定点。</p><p id="0bfc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很快我意识到有一个问题，不同的屏幕可以有不同的分辨率，跳过按钮可以在不同的位置，这取决于缩放或全屏模式或影院视图。</p><h2 id="20ac" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">策略的改变</h2><p id="a619" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">当我学习OpenCV时，我开始了解OpenCV中的SIFT特性和模板匹配特性。</p><p id="a00d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我发现OpenCV中的模板匹配是我试图解决的问题的准确解决方案。</p><p id="a71d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我根据屏幕的不同分辨率和缩放级别创建了不同的模板。我在两台不同的笔记本电脑上以不同的分辨率彻底测试了这个脚本。</p><p id="de7d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该应用程序在跨平台上运行良好。</p><p id="e796" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">令人惊讶的是，它在另一个名为voot.com的视频流媒体应用程序中也显示出了良好的效果，一些印度电视节目就是在这个应用程序中播放的。</p><h2 id="defe" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">使用的各种库</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="366c" class="jt ju hi ky b fi lc ld l le lf">import cv2<br/>import numpy as np<br/>import pyautogui<br/>import time</span></pre><p id="ec09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Numpy用于将python图像对象转换成numpy数组，以便在OpenCV的模板匹配方法中使用。</p><h2 id="2b18" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">阅读模板</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="e0cc" class="jt ju hi ky b fi lc ld l le lf"># reading the templates<br/>template3 = cv2.imread('template3.png', 0)<br/>template4 = cv2.imread('template4.png', 0)<br/>template5 = cv2.imread('template5.png', 0)<br/>template6 = cv2.imread('template6.png', 0)</span></pre><p id="9bcf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">模板以灰度格式读取，如标志“0”所示。经过全面测试后，我根据不同的缩放级别创建了四个模板。</p><p id="7d94" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些模板涵盖了所有情况(分辨率、缩放和全屏)。</p><h2 id="c36b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">阈值处理</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="b98e" class="jt ju hi ky b fi lc ld l le lf"># setting the threshold for confidence in template matching<br/>threshold = 0.7</span></pre><p id="4f66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将阈值设置为0.7，这样当图像中某个区域与模板匹配的概率很高时，才考虑该点。</p><h2 id="f1e7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">停止标准</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="7b6a" class="jt ju hi ky b fi lc ld l le lf"># alert box for stopping criteria<br/>pyautogui.alert(text = 'Keep the mouse pointer on the top left/ corner of screen to stop the program', title= 'Stopping Criteria')</span></pre><p id="1634" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在程序开始时，会弹出一个警告框，提示如何停止脚本。</p><p id="1342" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我没有使用任何GUI来启动和停止脚本。更确切地说，我使用了一种黑客技术，在这种技术中，我检查特定的条件以跳出程序。</p><h2 id="017d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">连续循环</h2><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">While循环检查模板匹配并单击skip按钮</figcaption></figure><p id="e32c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个循环将一个接一个地检查一个模板，一旦找到匹配，它将根据找到它的像素位置点击它。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="9b0c" class="jt ju hi ky b fi lc ld l le lf">#     Stopping criteria    <br/>if pyautogui.position() == (0,0):<br/>     pyautogui.alert(text = 'Adskipper is Closed', title =/    'Adskipper Closed')<br/>     break</span></pre><p id="149b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在检查完所有的模板后，它检查鼠标的位置是否在(0，0)处，如果是，那么在显示一个警告框，提示程序关闭后，它退出循环。</p><h2 id="d896" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">进一步的改进</h2><p id="1cae" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们可以使用基于深度学习的图像分割技术，如U-NET、SegNET等。这些是像素级图像分割技术。通过这种方式，我们不必创建不同的模板，也没有机会遗漏任何死角，因为方法是完全不同的。</p><p id="de6d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们也可以把它扩展到手机上。</p><p id="cdbc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还可以为用户创建一个GUI，以便他/她可以轻松地打开或关闭它。</p><p id="ddb9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完整的源代码可以在我的Github档案中找到:<a class="ae iu" href="https://github.com/1993jayant/youtube_adskipper" rel="noopener ugc nofollow" target="_blank">https://github.com/1993jayant/youtube_adskipper</a></p></div></div>    
</body>
</html>