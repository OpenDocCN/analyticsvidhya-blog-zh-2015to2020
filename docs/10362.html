<html>
<head>
<title>Future Prediction of Call and Put Prices using Deep Learning by generating data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过生成数据使用深度学习来预测看涨和看跌价格</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/future-prediction-of-call-and-put-prices-using-deep-learning-by-generating-data-7d08079ffe93?source=collection_archive---------11-----------------------#2020-10-15">https://medium.com/analytics-vidhya/future-prediction-of-call-and-put-prices-using-deep-learning-by-generating-data-7d08079ffe93?source=collection_archive---------11-----------------------#2020-10-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="0af5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">简介:</h1><p id="3b41" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">code:<a class="ae kb" href="https://github.com/maagalamharsha/Future-Prediction-of-Call-and-Put-Prices-using-Deep-Learning/tree/cf17bbad010e00d66b86ae0ec598c1dbbc09bcac" rel="noopener ugc nofollow" target="_blank">https://github . com/maagalamharsha/Future-Prediction-of-Call-and-Put-Prices-using-Deep-Learning/tree/cf 17 bbad 010 e 00d 66 b 86 AE 0ec 598 C1 dbbc 09 bcac</a></p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/a9334badd8bccc5a612436d27066f707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Za7_cf0E4370W5riB76IxA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">AMD 标志</figcaption></figure><p id="cc5f" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">股市预测一直是仅次于计算机视觉的深度学习的最广泛应用之一。这些将用于各种对冲基金，以产生最大的投资回报。我们正在解决的问题是缺乏未来日期的数据，即我们没有未来日期的实时数据。我们将对没有数据的未来日期进行预测。这可以应用于我们给定的相关行业的任何股票价格。</p><p id="3fd1" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">在这篇博客中，我将通过几个其他公司的股票价格数据来展示对 AMD 的预测。请注意，对于未来的日期，我们将不会获得任何与新闻极性相关的数据(即基本面数据)，我们只会使用技术数据进行预测。</p><h1 id="035e" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据:</h1><p id="cfde" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们考虑 2010 年 1 月 1 日至 2020 年 5 月 31 日的培训数据，所有数据均从 Tingo API 获取。请考虑截止日期为 2020 年 5 月 31 日。这是因为在写这篇博客的时候，我们可以得到 2020 年 10 月 11 日的数据，但是我们想要一些真实的数据来比较。</p><p id="b714" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">让我们看看 2010 年的数据。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kx"><img src="../Images/126027cbff7c9d2b562c8d691f2c8276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BgsSq8CdvAXLhwBVMhQB5A.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">自 2010 年以来的 AMD 股价图</figcaption></figure><p id="7378" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们可以像往常一样看到，自 2007 年金融危机以来，该股一直在上涨，自 2017 年以来，由于锐龙宣布推出 CPU 系列，该股已大幅上涨。对于这个模型，我们还将考虑其他各种公司数据。我们不能认为 AMD 是唯一的公司，在金融界所有的公司都是相互关联的。<br/>例句:AMD 和 Intel 是竞争对手，大多数时候它们的动向是成反比的。</p><p id="a825" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">因此，我们会考虑英特尔(INTC)、英伟达(NVDA)、微软(MSFT)、高通(QCOM)、TSMC(TSM)、S&amp;P 交易所交易基金(ETF)等公司的股票收盘价。</p><h1 id="f3f5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">目标:</h1><p id="5a8d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们将预测 AMD 未来 10 天的股价，即从 2020 年 6 月 1 日到 2020 年 6 月 12 日，而不考虑未来的数据。</p><p id="7dbd" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">技术特征:</strong> <br/>利用目标公司的收盘价，我们增加了一些财务技术指标特征。<br/> <strong class="jf hj"> 7 日移动平均线:</strong>是滚动的 7 日移动平均线。这是一个非常接近实际股价的特性。<br/> <strong class="jf hj"> 21 日移动平均线:</strong>与 7 日移动平均线相同，但窗口宽度更大，为 21 日。<br/> <strong class="jf hj">均线敛散性:</strong>是一种趋势动量指标，表示股价的两条均线之间的关系。<br/>MACD 的计算方法是从 12 期均线中减去 26 期指数移动平均线(EMA)。<br/> <strong class="jf hj">布林线:</strong>这是两个最大值和最小值指标，显示距离 20 日简单移动平均线有 2 个标准差。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ky"><img src="../Images/c6e001a1cc9c9636d33a0db9a761eb91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IB4hpBquRIMV9TIXA63RQQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">这是所有技术特征的绘图样本</figcaption></figure><p id="6ba0" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">傅立叶变换:</strong> <br/>傅立叶变换是一种统计函数，它输出一系列正弦波，这些正弦波是实际函数的近似。它的工作原理是对实际函数去噪，得到的函数是近似函数。我们将增加傅立叶变换的两个方面，<strong class="jf hj">角度</strong>和<strong class="jf hj">绝对值</strong> ( <strong class="jf hj">震级</strong>)</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es kz"><img src="../Images/e457ab5ba3433db040af6c7707872702.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*qSXruOS6Nd39dghi_pbWcg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">傅立叶变换公式</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es la"><img src="../Images/d9ac9ef0ac405f60ddb50b7b9feca6ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYSlNV9g0R5mhFdiQGcLyQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">不同通道傅立叶变换的示例图</figcaption></figure><p id="b662" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">相关公司:</strong> <br/>现在我们再加上其他公司同期收盘价。这就像，当我们希望 AMD 成为我们的目标时，我们将把其余公司的收盘价作为独立变量。</p><p id="08b8" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj"> Ex: </strong> <br/> 1)当 AMD 是我们的目标变量时，其余的公司像英特尔(INTC)、英伟达(NVDA)、微软(MSFT)、高通(QCOM)、TSMC(TSM)、S &amp; P ETF(SPY)都将是我们的因变量。<br/> 2)当英特尔是我们的目标变量时，其余公司如 AMD(AMD)、Nvidia(NVDA)、微软(MSFT)、高通(QCOM)、TSMC(TSM)、S &amp; P ETF(SPY)将是我们的因变量。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lb"><img src="../Images/574c85cf27e27f596e5aaa1c1814f319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IwnNwIKoasWjD6KyePEnSQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">预处理后的数据格式</figcaption></figure><p id="7e45" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">方法论:</strong> <br/>目的是在没有提供数据的情况下进行预测。所以我们必须运行一个循环来保存我们需要预测的天数。对于每一个循环，我们需要得到我们数据集中所有公司的预测。有了当前可用的数据，我们可以得到 2020 年 6 月 1 日的预测，但未来几天我们没有数据。这里是预测的使用，我们知道我们可以使用其他公司和技术特征数据来获得 AMD 的预测。同样，我们可以获得其余公司的预测，这样我们就可以获得数据集中所有公司 2020 年 6 月 1 日的预测收盘价。</p><p id="ac92" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们将 2020 年 6 月 1 日的预测纳入实际数据集，同样的过程将持续到循环结束。请注意，在预测未知数据的未来数据时，我们将无法捕捉任何与基本新闻相关的数据，这些数据是进行微观调整的结果。</p><p id="0f6f" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">为了进行预测，我们需要一个模型。我们使用一个有 500 个单元的基本 LSTM 网络。该模型的输入将是 70 天的历史数据。</p><p id="83e5" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">数据看起来像是<strong class="jf hj"> t-70 </strong>、<strong class="jf hj"> t-69 </strong>、<strong class="jf hj"> t-68 </strong> …<strong class="jf hj"> t </strong>。并且该特定观察的目标将是目标公司在时间<strong class="jf hj"> t </strong>的价格。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">培训和生产伪代码</figcaption></figure><p id="0859" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">期权定价:</strong></p><p id="d547" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">它是一种通过支付溢价以特定的未来固定价格购买资产的方式，并且仍然拥有行使它的选择权。当我们知道股票的未来价格时，通常是在月底，这种策略就会奏效。</p><p id="5d4c" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">如果我们确定了月末股票价格的波动范围，我们可以购买一个看涨期权，并在月末以低于市场价格的价格行使它。</p><p id="e27e" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我使用布莱克-斯科尔斯定价模型，用预测价格计算看涨和看跌价格。</p><p id="08e5" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">布莱克-斯科尔斯定价模型:</strong>布莱克-斯科尔斯模型，又称布莱克-斯科尔斯-默顿(BSM)模型，是期权合约定价的数学模型。特别是，该模型估计了金融工具随时间的变化。它假设这些工具(如股票或期货)的价格将呈对数正态分布。利用这一假设，并考虑其他重要的变量，该方程得出了一个看涨期权的价格。(来源:<a class="ae kb" href="https://www.investopedia.com/terms/b/blackscholes.asp" rel="noopener ugc nofollow" target="_blank">https://www.investopedia.com/terms/b/blackscholes.asp</a>)</p><p id="a6f4" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">执行价格:在到期日买入/卖出股票的价格</p><p id="a81f" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">买入价格:一种在到期时以执行价格买入股票的期权，与股票的实际市场价格无关</p><p id="5b65" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">看跌价格:一种在到期时以执行价格出售股票的期权，与股票的实际市场价格无关</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="lc ld l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es le"><img src="../Images/b428ea4c20e73b11f48849986965b805.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*z9fJx009vfTP87ZtuX9PFQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">使用预测价格数据预测买入和卖出价格(买入价格:50 美元)</figcaption></figure><p id="5831" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">未来工作:</strong> <br/>随着<strong class="jf hj">生成对抗网络</strong>的最新进展，我们可以生成几乎看起来像真实数据的数据。GANs 在计算机视觉应用程序中非常流行，用于生成人类的假图片(深度假)。</p><p id="2152" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">当你看彩色图像的数据时。我们会得到一组数字。因此，GAN 会生成我们的数据集中没有的新数组。</p><p id="c4da" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">GAN 包含两个网络 1)发生器和 2)鉴别器。所有实际数据将被标记为 1，来自发生器的假数据将被标记为 0。我们交替更新生成器和鉴别器中的权重。我们继续训练这些模型，直到鉴别器中的损失非常高，并且它不能确定假样本和实际样本之间的差异。</p><p id="6a35" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">因此，同样的方法也可以在我们的应用程序中实现，我们可以向鉴别器提供 10 天的实际数据，并生成一个样本作为第二天的数据。但是由于 gan 是概率模型，所以结果不会每次都相同，并且还需要考虑时间复杂度。gan 很难训练，而且生成的数据通常不可靠。想象一下，一家投资公司生产氮化镓，而数据不可靠，这可能要花费数百万美元。</p><p id="f442" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我也尝试过 GANs，但是生成的数据并不代表实际数据。这将是未来继续研究的一个领域。(如有任何成果，将发布)</p><p id="b3a0" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">推荐人:</strong> <br/> <a class="ae kb" href="https://towardsdatascience.com/aifortrading-2edd6fac689d" rel="noopener" target="_blank">鲍里斯 B </a> : <br/>我从他的工作中学到了很多，学会了如何应用计算机视觉应用软件 GANs 在股票市场上的应用。还有我博客中用到的一些技术指标。<br/> <a class="ae kb" href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="noopener ugc nofollow" target="_blank">杰森·布朗利</a>:</p><p id="a895" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我能够理解 LSTMs 和 LSTMs 所需的数据准备，它帮助我开发了一个基本的 LSTM 网络，该网络足以获得非常准确的预测。</p><p id="d943" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><a class="ae kb" href="https://www.mdpi.com/2076-3417/10/2/437/pdf" rel="noopener ugc nofollow" target="_blank">量化交易中基于组合优化的长短期记忆网络股票预测</a>:</p><p id="1c55" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">这有助于我识别数据的来源。我所有的数据都是从这篇研究论文中列出的来源获得的。</p><p id="87e1" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><a class="ae kb" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">应用人工智能课程</a>:</p><p id="94b4" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">LinkedIn: <a class="ae kb" href="http://www.linkedin.com/in/mharsha-vardhan" rel="noopener ugc nofollow" target="_blank">哈莎·瓦尔登·马加拉姆</a></p></div></div>    
</body>
</html>