<html>
<head>
<title>Linear Regression Using Pandas &amp; Numpy — For Beginners in Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Pandas &amp; Numpy 的线性回归—适用于数据科学初学者</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-using-pandas-numpy-for-beginners-in-data-science-fe57157ed93d?source=collection_archive---------3-----------------------#2020-10-25">https://medium.com/analytics-vidhya/linear-regression-using-pandas-numpy-for-beginners-in-data-science-fe57157ed93d?source=collection_archive---------3-----------------------#2020-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d9d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">问题陈述</strong>纽约一家在线销售服装的电子商务公司也有店内风格和服装建议会议。顾客来到店里，与私人造型师进行会谈/会面，然后他们可以回家，在手机应用程序或网站上订购他们想要的衣服。</p><p id="ff80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该公司正试图决定是将精力集中在他们的移动应用程序体验还是他们的网站上。让我们弄清楚。</p><p id="e4a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#导入所需的包</p><p id="3566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">导入熊猫为 pd <br/>导入 numpy 为 np <br/>导入 matplotlib.pyplot 为 py <br/>导入 seaborn 为 sns <br/> %matplotlib inline </em></p><p id="e0fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#读取文件</p><p id="235d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> customers = pd.read_csv("电子商务客户")</em></p><p id="3395" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#让我们检查数据-</p><p id="af47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> customers.head() </em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/ae3c60da1fb61cfeda99a6db4f12737f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fBbpUZA8ASW2ESL6joUrWA.png"/></div></div></figure><p id="e9cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> customers.describe() </em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/2b6bf1656ff78f5feee376ff85ea8d19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyceNsrHUyuj67qqBkUFuw.png"/></div></div></figure><h1 id="6e0a" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">探索性数据分析</h1><p id="74ee" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">#处理数据的第一步是分析数据，探索存在哪些关系以及这些关系是如何相互关联的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ku"><img src="../Images/75d8a81bb4fbf8b1e0a1894a9c527ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vPvj8zTTHuPjcdvTKBxahg.png"/></div></div></figure><p id="ea5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#创建了一个 jointplot(使用 seaborn)来比较网站上的时间和每年花费的金额列。这是为了检验相关性是否有意义？</p><p id="9ebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> sns.jointplot(x= '在网站上的时间'，y= '每年花费的金额'，数据=客户)</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kv"><img src="../Images/a2e6959db761d7cce6fb5d8ddfc14ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MvFnzBAEWhSKt2Z5cABlfw.png"/></div></div></figure><p id="fccb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#应用程序数据也是如此</p><p id="d242" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> sns.jointplot(x= '应用上的时间'，y= '每年花费的金额'，数据=客户)</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kw"><img src="../Images/2cad79c876be6e1ea2a5075753b2c196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vju_oScYEepfT8qBMoGpeg.png"/></div></div></figure><p id="7d37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#创建了一个十六进制类型的 jointplot，用于显示花在应用程序上的时间与会员资格的长度</p><p id="a29e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">SNS . joint plot(x = ' App 上的时间'，y= '会员时长'，data =客户，kind='hex') </em></p><p id="bf40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#我们可以创建一个 pairplot 来研究整个数据集的关系类型。注意年度消费金额和会员资格之间的线性正相关。</p><p id="bea8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> sns.pairplot(数据=客户)</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kx"><img src="../Images/ea2f85f28e762bd2f245dc093804390a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0u_usYIL0GNXTh1EZCP_0A.png"/></div></div></figure><p id="6b40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#因此，我们通过绘制年度消费金额与会员资格期限的线性图(使用 seaborn 的 lmplot ),深入研究了这种关系</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ky"><img src="../Images/cf664887ace38e786aa623859be2d197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*010i-0wrRwRXMpM3dUn8Ag.png"/></div></figure><p id="b73b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> sns.lmplot(x= '会员时间'，y= '每年消费金额'，数据=客户)</em></p><h1 id="600e" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">培训和测试数据</h1><p id="2fd7" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在我们已经对数据进行了一些探索，让我们继续将数据分成训练集和测试集。设置一个与客户数字特征相等的<strong class="ih hj">变量 X </strong>和一个与“每年花费金额”栏相等的<strong class="ih hj">变量 Y </strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kz"><img src="../Images/95ac82acbd751b64933379731e654634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6JCVEQ7535vyspaYOwucg.png"/></div></div></figure><p id="671b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">X =客户[['平均。会话长度'，'应用时间'，'网站时间'，'会员时间']] <br/> X.head() </p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es la"><img src="../Images/09d63cb622af08f32aecd817cdea4551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*619oMKk4OBLzcmtzsDwvLQ.png"/></div></figure><p id="9782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">Y =客户['每年花费金额'] <br/> Y.head() </em></p><p id="bc9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用 sklearn 中的 model _ selection . train _ test _ split 将数据拆分为训练集和测试集。设置测试大小=0.3，随机状态=101 </strong></p><p id="92eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">从 sklearn.model_selection 导入 train_test_split </em></p><p id="b52d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> X_train，X_test，Y_train，Y_test = train_test_split(X，Y，test_size=0.3，random_state=101) </em></p><h1 id="17ed" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">训练模型</h1><p id="93d2" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在是时候根据我们的训练数据来训练我们的模型了！</p><p id="211e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">从 sklearn.linear_model 导入线性回归</em></p><p id="ad62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> lm = LinearRegression() </em> #创建 LinearRegression 模型的实例</p><p id="4e3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> lm.fit(X_train，Y_train) # </em> Train/fit 在训练数据上，这将给出-</p><pre class="jf jg jh ji fd lb lc ld le aw lf bi"><span id="cd81" class="lg js hi lc b fi lh li l lj lk">LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)</span></pre><p id="c746" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#模型的系数/斜率-</p><p id="b703" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">打印(lm.coef_) </em></p><pre class="jf jg jh ji fd lb lc ld le aw lf bi"><span id="6b7a" class="lg js hi lc b fi lh li l lj lk">[25.98154972 38.59015875  0.19040528 61.27909654]</span></pre><h1 id="706a" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">预测测试数据</h1><p id="1787" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在我们已经拟合了我们的模型，让我们通过预测测试值来评估它的性能！</p><p id="c12b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">预测= lm.predict(X_test) </em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ll"><img src="../Images/25edda8ae2871a0814a7fc6c2b46bf5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*mHCqvfUoUEpT6sSbbGAirg.png"/></div></figure><p id="a8aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#让我们创建一个真实测试值与预测值的散点图，以检查我们模型的性能</p><p id="56da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">py.scatter(Y_test，预测)</p><h1 id="a999" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">评估模型</h1><p id="4f6a" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">让我们通过计算残差平方和以及解释方差得分(R)来评估我们的模型性能</p><p id="75b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">从 sklearn 导入度量<br/> print('MAE= '，metrics . mean _ absolute _ error(Y _ test，prediction) ) <br/> print('MSE= '，metrics . mean _ squared _ error(Y _ test，prediction)) <br/> print('RMSE:'，NP . sqrt(metrics . mean _ squared _ error(Y _ test，prediction))) </em></p><pre class="jf jg jh ji fd lb lc ld le aw lf bi"><span id="4deb" class="lg js hi lc b fi lh li l lj lk">MAE=  7.228148653430853<br/>MSE=  79.81305165097487<br/>RMSE: 8.933815066978656</span></pre><h1 id="8063" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">残差</h1><p id="034b" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">让我们快速研究一下残差，以确保我们的数据一切正常</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lm"><img src="../Images/8e4f175d2eb05f845e269cb1a4edca69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*fc1BTsaniI1E-8yVY1uVSA.png"/></div></figure><p id="9b39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#绘制残差直方图，并使用 plt.hist()确保它看起来呈正态分布。</p><p id="fdce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> py.hist(预测-Y _ 测试，bin = 50)</em></p><h1 id="a881" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">结论</h1><p id="de1b" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们还是想弄清楚原问题的答案，我们是把精力放在手机 App 还是网站开发上？或者这根本不重要，会员时间才是真正重要的。让我们解释一下这些系数来了解一下</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ln"><img src="../Images/74061edb97f880958c26b8db56ba781f.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*N7jp84gPjnSn_Z-VLXS7-w.png"/></div></figure><p id="9658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">一氧化碳=钯。DataFrame(lm.coef_，X.columns) <br/> co.columns = ['系数'] <br/> co </em></p><p id="bc56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解释系数:</p><ul class=""><li id="05ae" class="lo lp hi ih b ii ij im in iq lq iu lr iy ls jc lt lu lv lw bi translated">保持所有其他功能不变，<strong class="ih hj">平均值增加 1 个单位。会话长度</strong>与总花费增加 25.98 美元<strong class="ih hj">相关联。</strong></li><li id="4076" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated">在所有其他功能不变的情况下，App 上的<strong class="ih hj">时间每增加 1 个单位，总花费</strong>就会增加<strong class="ih hj">38.59 美元。</strong></li><li id="37e8" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated">在所有其他功能不变的情况下，网站上的<strong class="ih hj">时间每增加 1 个单位，总花费</strong>就会增加<strong class="ih hj">0.19 美元。</strong></li><li id="42cb" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated">保持所有其他特征不变，会员资格<strong class="ih hj">长度</strong>每增加 1 个单位，总花费<strong class="ih hj">就会增加 61.27 美元</strong>。</li></ul><p id="86e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最终结论— </strong></p><p id="11b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有两种方法可以思考这个问题:1。开发网站以赶上移动应用程序的性能，或者 2。开发更多的应用程序，因为这是什么工作得更好。</p><p id="94bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名数据人员，我们可以用数字向公司提供两种选择，并帮助他们做出决定。</p></div></div>    
</body>
</html>