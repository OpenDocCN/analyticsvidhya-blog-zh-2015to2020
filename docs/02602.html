<html>
<head>
<title>Deep Dive into Back Propagation (III)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入研究反向传播(三)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deep-dive-into-back-propagation-iii-e96234a4f7fd?source=collection_archive---------24-----------------------#2019-12-24">https://medium.com/analytics-vidhya/deep-dive-into-back-propagation-iii-e96234a4f7fd?source=collection_archive---------24-----------------------#2019-12-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0976" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是“深入研究反向传播”的第三部分。要继续阅读，我建议如果你还没看过的话，可以看看第一部分和第二部分。第一部分和第二部分的链接可以在<a class="ae jd" rel="noopener" href="/analytics-vidhya/deep-dive-into-back-propagation-part-ii-c392f804a784">这里</a>和<a class="ae jd" rel="noopener ugc nofollow" target="_blank" href="/analytics-vidhya/deep-dive-into-back-propagation-part-i-e1a92b6dbdb9">这里</a>找到。</p><p id="5e2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们理解了链式法则，我们可以继续我们的<strong class="ih hj">反向传播</strong>例子，在这里我们将计算梯度。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/5db3c26ded950aef75edd33a63e57be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7b6LrX7LjI9TAEGjfkdVIg.png"/></div></div></figure><p id="1808" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，我们只有一个隐藏层，所以我们的反向传播过程将包括两个步骤:</p><p id="8596" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤1:计算相对于权重向量W的梯度(从输出到隐藏层)。<br/>步骤2:计算相对于权重矩阵W的梯度(从隐藏层到输入)。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/72074425eabd180ae5aac850ed6ef052.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-r-5OsqkvwkacWaEiHZXA.png"/></div></div></figure><p id="a575" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第1步</strong>(注意，此处引用的权重向量将为W。所有引用W的指数均已从计算中省略，以保持符号简单)。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/ccd411d6e37aab8570dd10e16c288fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*0zjsn-EWW3gmRO9sOQ6NjA.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式1</figcaption></figure><p id="9233" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可能还记得:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/77660c328e93baff5bfd1a800f25f546.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*feAaFfhBNADAig1dmZ9Qjg.png"/></div></figure><p id="67d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个特定的步骤中，由于输出只有一个值，我们可以按照下面的方式重写等式(其中我们有一个权重向量<em class="jx"/>):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/3a9d8892dc64f57556cccc730cb06490.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*ge9LCyXDSWFwbPsuZfcsBA.png"/></div></figure><p id="d02e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们已经计算了梯度，我们现在知道第一步需要的增量值是:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/2c6d958d47877748092b0c7689f5f888.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*FyNTvvMqyyuKIFWfsaUtGg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式2</figcaption></figure><p id="6b01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算完增量值后，我们可以通过以下方式更新向量W2 <em class="jx"> W </em> 2:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/c00f238520e0fdfd676cbf95a2a44d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*WsiF-Env5q8BJnDZI3bDHQ.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式3</figcaption></figure><p id="0e28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤2 </strong>(在这一步中，我们将需要使用两个权重矩阵。因此，我们不会忽略权重指数。)</p><p id="b7b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的第二步中，我们将通过计算y相对于权重矩阵W的偏导数来更新矩阵W的权重</p><p id="574a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">链式法则将按以下方式使用:</p><p id="8dcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获得y <em class="jx"> y </em>相对于h的偏导数，并将其乘以h相对于W中相应元素的偏导数。我们可以观察每个元素并以如下方式表示方程，而不是参考向量h:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/5e5df54ac51e89ab319b64d1472b63c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*Hc6Hl2LCi3VIKhB392B6HQ.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式4</figcaption></figure><p id="5609" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，我们在单个隐藏层中只有3个神经元，因此这将是三个元素的线性组合:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/d3e41fbabaab20eb32f69eb392f7c4c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*AZfH8sfrJ3mwj77pkSEExA.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式5</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jy"><img src="../Images/99bcb5eee1d88816a839633f2dc2952d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uK9_7h_QuzzyG7OZR9Gpw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/688be28de7cd291925b42265bca99287.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*yMVzo7X4DU9q2B9BogHpOQ.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式6</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jz"><img src="../Images/59fdab23fd007c284c81c2e05718a44f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkrE-Otkg0CWi4SJvgJ1Wg.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/af6973477162e7a7f8b339cc8b37113a.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*Yctb5f94E6vQhm6lpf4gjQ.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式7</figcaption></figure><p id="c85a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/2acd68a2ce8b8516b12d007306baf6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*u55yWkvE0bVYklZA8Rh_cw.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式8</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ka"><img src="../Images/a4eb3f1e5922819e20b6fbbbbe5c186e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPyH8h_rqrC8MZH_buzC3A.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kb"><img src="../Images/de0eeb37e62ce1bae456614dbd02ee58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ylszGj_-mOFHYwlqfby9Qg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式9</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kc"><img src="../Images/388ee8103062fc938594b73918b56b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3PdIvUWYd7Dcv50s0VMaw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/0df2d3bcf8b063a9ea37859bed24656f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*M9bx0brYfN8UYuMjKQv3dw.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式10</figcaption></figure><p id="5099" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">等式9的第二个计算可以通过以下方式计算:</p><p id="585e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(注意结果是多么简单，因为这个偏导数的大部分分量都是零)。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/3ef23df1aaa1a99235bbb5f762905812.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*9agbJx5LwenDuyNZlOoXTA.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式11</figcaption></figure><p id="4ba8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在理解了如何分别对待等式9的每个乘法之后，我们现在可以将它总结如下:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/25fcb9c47bfab4262aab0a6ad28fd77d.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*2r8XWpIHAL_-w4S5A5SFSA.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式12</figcaption></figure><p id="0387" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们准备完成<strong class="ih hj">步骤2 </strong>，其中我们通过计算等式5所示的梯度来更新矩阵W的权重。从以上计算，我们可以得出结论:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kd"><img src="../Images/354e63479e60f2afc04743427b872383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*AUeBCjg9TSbwvfhjwGGBWw.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式13</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ke"><img src="../Images/a2b1e85af03680fd10f2e54a4e274cd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n9LxLSR1uXjKEUUfPkM15A.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/1465ce2f355f158b5b36bbd4f51d1b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*3xKlgkGgzz5l04-le0sm9w.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式14</figcaption></figure><p id="b32f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算完增量值后，我们可以按以下方式更新矢量W:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kf"><img src="../Images/184e093cce77048b9150154a1f687b57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*m2BskCu35jUYBoVBEHBcZg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">等式15</figcaption></figure><p id="02a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在所有这些计算中，我们没有强调有偏差的输入，因为它不会改变我们涵盖的任何概念。正如我之前提到的，简单地认为偏差是一个常数输入，它也通过权重连接到隐藏层的每个神经元。偏差和其它输入之间的唯一区别是，当其它输入改变时，偏差保持不变。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kd"><img src="../Images/c1dbd611c1ecb2168350d62ea6ca8308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*qUYriZNdUY5AeZY1FBos_A.png"/></div></figure><p id="5a3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在更新权重矩阵之后，我们再次开始前馈过程，再次开始更新权重的过程。</p><p id="9d24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本例中，对于每个新输入，我们在每次计算输出后更新权重。每N步更新一次权重通常是有益的。这被称为小批量训练，包括在实际更新重量之前，在多个步骤中平均重量的变化。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/27e856cdd683009e9ba9c0568088232e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*vw2LflFMUYEtH56sh3K0tQ.png"/></div></figure><p id="1f3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用小批量训练有两个主要原因:</p><ol class=""><li id="2eb1" class="kg kh hi ih b ii ij im in iq ki iu kj iy kk jc kl km kn ko bi translated">降低培训过程的复杂性</li><li id="c404" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">噪声降低</li></ol><p id="5957" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">内容鸣谢:Udacity深度学习计划</p></div></div>    
</body>
</html>