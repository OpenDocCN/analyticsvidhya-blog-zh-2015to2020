<html>
<head>
<title>Collecting data from Industrial IoT using Factory Talk Edge Gateway to Azure IoT Hub</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Factory Talk Edge 网关从工业物联网收集数据到 Azure 物联网中心</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/collecting-data-from-industrial-iot-using-factory-talk-edge-gateway-to-azure-iot-hub-e830e65c0934?source=collection_archive---------7-----------------------#2020-11-25">https://medium.com/analytics-vidhya/collecting-data-from-industrial-iot-using-factory-talk-edge-gateway-to-azure-iot-hub-e830e65c0934?source=collection_archive---------7-----------------------#2020-11-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5544" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数工业控制使用罗克韦尔自动化 PLC、传感器和控制系统或西门子、施耐德和少数其他开源和供应商产品。</p><p id="23ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">罗克韦尔自动化发布了一款名为 Factory talk edge gateway 的新产品，这将是我们的重点。Kepware 也是我们可以收集数据的另一个产品。</p><p id="9408" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从 edge 收集数据对于大多数制造企业的运营和优化至关重要。我们可以用于机器学习和人工智能。现在面临的挑战是，将所有数据存储在本地数据中心或制造设施中并不容易，也不经济，因为存储空间和计算都很稀缺。</p><p id="d8a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们可以在云中收集和存储数据，那么我们就可以从数据中建立或创造洞察力。</p><p id="a00f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Factory talk edge gateway 具有称为智能标记的新功能，可以了解在工厂车间内收集和共享的数据的上下文。因此，本文将讨论如何从 PLC 中采集数据。</p><p id="65c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于本文，我们正在测试 compact logix 5480，我们创建了一个简单的程序来生成计数器并增加值。为了检索数据，我们尝试了两种方法，一种是将网关安装在笔记本电脑或虚拟机上，另一种是安装在 Logix 5480 上。</p><p id="cd97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">体系结构</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2694149b46c595a878d98312ff16ad31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WSIpv77e5GIMiWHi8VPtA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">体系结构</figcaption></figure><p id="5e6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先安装 Compact Logix 5480 并更新固件。使用当前数据和时间配置 compact logix。在计算模块中，您可以安装 Factory Talk Edge Gateway。下载软件需要 2 条信息序列号和公司名称或产品密钥。</p><p id="d57b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个 Azure 物联网中心，创建一个物联网设备，并获取设备的名称和连接字符串。加载示例程序以生成一个计数器，并在 x 秒内递增。将程序保存在存储卡中，并翻转运行模式。这允许我们在每次系统重启时加载程序。</p><p id="e28a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是配置网关的时候了:</p><ul class=""><li id="b561" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc jy jz ka kb bi translated">创建 CIP 驱动程序，应该是本地计算模块的 IP 地址</li><li id="88eb" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">要获取 ip 地址，请使用 monitor 并键入 ipconfig</li><li id="55ca" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">创建数据源</li><li id="a06b" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">一个用于紧凑型 logix 5480 中的 PLC</li><li id="4fea" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">IP 通常显示在 LED 显示屏上。</li><li id="1f3d" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">创建模型</li><li id="45b9" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">模型可以将标签分组并应用于不同的输出</li><li id="583b" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">创建应用程序</li><li id="4e7d" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">在这里，我们正在创建 IOT 枢纽</li><li id="02f0" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">指定名称</li><li id="c619" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">指定设备名称</li><li id="075c" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">使用连接字符串(设备)</li><li id="60b6" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">选择配置，选择标签并指定发送频率</li><li id="97c7" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">部署代码</li><li id="7501" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">单击启用数据流</li><li id="3375" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">保存设置</li><li id="4ea1" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">等待系统应该显示全部绿色</li><li id="795d" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">选择“存储并转发”—以便在数据中断时保留数据</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/c1fc052b39d31170cb2a5960af777c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NvVqIIuTu-vKonCV2nfF0A.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">工厂对话边缘网关</figcaption></figure><p id="917d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦连接到 azure IoT hub，请检查概览页面以查看是否有任何消息被发送。如果网关没有显示任何错误并推送数据，那么是时候配置 Azure Stream analytics 以存储到 Azure Data lake store Gen2 中进行进一步处理。数据登陆后，可以批量处理大量数据(大数据)。</p><p id="fee4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是流分析查询的代码</p><pre class="je jf jg jh fd ki kj kk kl aw km bi"><span id="3ade" class="kn ko hi kj b fi kp kq l kr ks">select <br/>gatewayData ,<br/>PublisherId as deviceid,	<br/>EventProcessedUtcTime as EventProcessedUtcTime,<br/>EventEnqueuedUtcTime as EventEnqueuedUtcTime,<br/>IoTHub.ConnectionDeviceId as ConnectionDeviceId,<br/>i.IoTHub.EnqueuedTime as EnqueuedTime<br/>into outputblob from input</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/c235e0e09d53c0d5aa3b439426469b10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g2xTpUilntD0WZRUVoo0LA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">流分析查询</figcaption></figure><p id="bec0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行流分析并确保数据存储如下</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/dfee63e3ab0dc669404147664c56646b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdQXPMQkMADpm8kKyWpPbQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">json 输出示例</figcaption></figure><p id="c035" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有关更多信息，请查看此回购协议以了解更多详情</p><p id="7528" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kv" href="https://github.com/balakreshnan/IIoT-AI/blob/master/IIoT/FTEdgetoAzure.md" rel="noopener ugc nofollow" target="_blank">IIoT-AI/ftedgetazure . MD</a></p><p id="41a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请提供您的意见和想法</p></div></div>    
</body>
</html>