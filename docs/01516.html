<html>
<head>
<title>Extract and write data from Exasol database with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从数据库云服务器数据库中提取和写入数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/extract-and-write-data-from-exasol-database-with-python-6f353d208ac6?source=collection_archive---------3-----------------------#2019-10-28">https://medium.com/analytics-vidhya/extract-and-write-data-from-exasol-database-with-python-6f353d208ac6?source=collection_archive---------3-----------------------#2019-10-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/7c087f4ede360fb7aa5aba6633fc0792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*ZQhIMtNMrU2ARqTqVdJX2A.png"/></div></figure><div class=""/><div class=""><h2 id="69c1" class="pw-subtitle-paragraph im ho hp bd b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd dx translated">从Exasol数据库中读取表格，并将其用作pandas数据框架。将python数据帧写入Exasol表。</h2></div><h1 id="11c3" class="je jf hp bd jg jh ji jj jk jl jm jn jo iv jp iw jq iy jr iz js jb jt jc ju jv bi translated">介绍</h1><p id="a4db" class="pw-post-body-paragraph jw jx hp jy b jz ka iq kb kc kd it ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">无论是数据科学家、数据分析师还是数据工程师，都需要访问来自多个来源的大量数据。需要提取、组合和分析这些数据来创造价值。这个博客有助于提供从您的jupyter笔记本(或您想在其中使用它的任何其他IDE)对Exasol数据源的访问。</p><h1 id="e6df" class="je jf hp bd jg jh ji jj jk jl jm jn jo iv jp iw jq iy jr iz js jb jt jc ju jv bi translated">Exasol</h1><p id="3416" class="pw-post-body-paragraph jw jx hp jy b jz ka iq kb kc kd it ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">连接到Exasol非常简单→有一个名为<strong class="jy hq"> Pyexasol </strong>的专用包可以为我们完成大部分工作。我们需要做的就是导入并使用它。</p><h1 id="ff38" class="je jf hp bd jg jh ji jj jk jl jm jn jo iv jp iw jq iy jr iz js jb jt jc ju jv bi translated"><strong class="ak">数据提取</strong></h1><figure class="kt ku kv kw fd hk er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ks"><img src="../Images/70f0ccf084b19d61829eabd70c39c6a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iOT_f1LYJ0m-e-f9ZkdzRQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">用于连接Exasol数据库的函数</figcaption></figure><p id="dc94" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated">命令行语法可以在python notebook中编写，只需添加符号“！”在行首。<em class="lk">由此行之！pip install pyexasol" </em>简单安装pyexasol包。</p><blockquote class="ll lm ln"><p id="db98" class="jw jx lk jy b jz lf iq kb kc lg it ke lo lh kh ki lp li kl km lq lj kp kq kr hb bi translated">函数connect_exasol将SQL查询作为输入，并以pandas数据帧的形式返回查询的输出表。用户名(代替用户名)和密码(代替密码)等身份验证细节必须在函数中设置一次。还要确保数据源名称(dsn)字符串是正确的。</p></blockquote><p id="8879" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated"><strong class="jy hq"> <em class="lk">用法举例</em> </strong></p><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lr"><img src="../Images/b5c164e90b6d83141f14c097ecf92f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*tOHv7-Q-TVU1tSYmBa8l5g.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">可以从数据库中提取的示例查询</figcaption></figure><h1 id="47a1" class="je jf hp bd jg jh ji jj jk jl jm jn jo iv jp iw jq iy jr iz js jb jt jc ju jv bi translated"><strong class="ak">从pandas向Exasol写入数据</strong></h1><figure class="kt ku kv kw fd hk er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ls"><img src="../Images/e9ab67d0f6e9e42422f23f221a0f3804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqKrMATLkFYJoSt_K7Joww.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">将数据从pandas数据框架写入数据库云服务器的功能</figcaption></figure><p id="453e" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated">函数write_exasol在</p><blockquote class="ll lm ln"><p id="ed02" class="jw jx lk jy b jz lf iq kb kc lg it ke lo lh kh ki lp li kl km lq lj kp kq kr hb bi translated">创建新的空表的SQL查询、需要插入到表中的数据帧、要插入数据的模式以及要插入数据的表名</p></blockquote><p id="0730" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated">确保新创建的表和dataframe的维度相同。</p><p id="1d63" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated"><strong class="jy hq"> <em class="lk">用法</em>举例</strong></p><p id="3bba" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated">一旦创建了上述函数，就可以重用它来创建exasol表，如下所示。</p><p id="af38" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated"><strong class="jy hq">步骤1 </strong>:作为将表写入exasol的第一步，需要在Exasol中创建一个空表。务必确保创建的列数和列的数据类型与需要推入表中的数据相匹配。</p><p id="b24b" class="pw-post-body-paragraph jw jx hp jy b jz lf iq kb kc lg it ke kf lh kh ki kj li kl km kn lj kp kq kr hb bi translated"><strong class="jy hq">第二步</strong>:执行write_exasol函数。在下面的示例中,“jobrole”是一个需要在Exasol中保存为表格的python数据帧。最后两个参数分别是模式名和表名(确保这与新创建的空表匹配)。</p><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lt"><img src="../Images/7d34ee192c025458e90b0c7e4c4db6e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*oJ_8WEopTqIfMXra-3cvyA.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">将数据从pandas数据框架写入数据库云服务器</figcaption></figure><h1 id="6163" class="je jf hp bd jg jh ji jj jk jl jm jn jo iv jp iw jq iy jr iz js jb jt jc ju jv bi translated"><strong class="ak">结论</strong></h1><p id="095e" class="pw-post-body-paragraph jw jx hp jy b jz ka iq kb kc kd it ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">这种连接可用于自动执行任务，通过数据库和python之间的轻松数据交换，我们可以释放python及其各种库的功能，并使用它来执行大数据的多种分析。</p></div></div>    
</body>
</html>