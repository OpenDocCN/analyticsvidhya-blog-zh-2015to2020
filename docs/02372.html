<html>
<head>
<title>Data manipulation in R using dplyr package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用dplyr包在R中进行数据操作</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-manipulation-in-r-using-dplyr-package-15aeef192208?source=collection_archive---------9-----------------------#2019-12-13">https://medium.com/analytics-vidhya/data-manipulation-in-r-using-dplyr-package-15aeef192208?source=collection_archive---------9-----------------------#2019-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/304499d4ffe5c15568b8d5a032105c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NeQjvEPPUylht_Zz"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">米卡·鲍梅斯特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9447" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">什么是dplyr？dplyr是一个强大的R包，用于转换、汇总和执行数据操作。该包包含一组函数(或“动词”)，这些函数执行常见的数据操作，如筛选行、选择特定列、对行重新排序、添加新列和汇总数据。<br/>此外，dplyr包含一个有用的功能来执行另一个常见任务，即“<em class="jt">拆分-应用-组合</em> e”概念。</strong></p><p id="d18c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">重要的dplyr动词<br/> </strong> <br/> select():选择列<br/> filter():过滤行<br/> arrange():重新排序或排列行<br/> mutate():创建新列<br/>summary():汇总值<br/> group_by():允许“拆分-应用-组合”概念中的分组操作</p><p id="76d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt"> #让我们使用哺乳动物睡眠数据</em> <br/>从<a class="ae iu" href="https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/msleep_ggplot2.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载CSV格式的msleep数据集，然后加载到R</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="4be4" class="kd ke hi jz b fi kf kg l kh ki"><em class="jt"># Lets first load libraries</em><br/>library(dplyr)<br/>msleep &lt;- read.csv(msleep.csv)</span><span id="a695" class="kd ke hi jz b fi kj kg l kh ki"><strong class="jz hj">#Select verb: <br/></strong># select name, sleep_total columns<br/><strong class="jz hj">msleep %&gt;% select(name, sleep_total)</strong></span></pre><p id="8a12" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">管子工</strong> : % &gt; %。dplyr从另一个包(magrittr)中导入这个操作符。该运算符允许您将一个函数的输出通过管道传输到另一个函数的输入，而不是嵌套函数。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="f681" class="kd ke hi jz b fi kf kg l kh ki"><em class="jt"># To select all the columns except a specific column, use the “-“ (subtraction) # operator (also known as negative indexing)</em><br/><strong class="jz hj">msleep %&gt;% select(-c(name, genus))</strong></span><span id="b9aa" class="kd ke hi jz b fi kj kg l kh ki"><em class="jt"># To select a range of columns by name, use the “:” (colon) operator<br/></em><strong class="jz hj">msleep %&gt;% select(name: order)</strong></span><span id="d210" class="kd ke hi jz b fi kj kg l kh ki"><em class="jt"># To select all columns that start with the character string “sl”, use the <br/># function starts_with()</em><br/><strong class="jz hj">msleep %&gt;% select(starts_with(match=”sl”))</strong></span><span id="576e" class="kd ke hi jz b fi kj kg l kh ki"><em class="jt"># To select all columns that ends with “wt”</em><br/><strong class="jz hj">msleep %&gt;% select(ends_with(“wt”))</strong></span></pre><p id="0f89" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">过滤动词:</strong></p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="f3d6" class="kd ke hi jz b fi kf kg l kh ki"><em class="jt"># Selecting rows using filter()<br/># Filter the rows for mammals that sleep a total of more than 16 hours.</em><br/><strong class="jz hj">msleep %&gt;% filter(sleep_total &gt;= 16)</strong></span><span id="b295" class="kd ke hi jz b fi kj kg l kh ki"><em class="jt"># Filter the rows for mammals that sleep a total of more than 16 hours and have # a body weight of greater than 1 kilogram.</em><br/><strong class="jz hj">msleep %&gt;% filter(sleep_total &gt;=16, bodywt &gt; 1)</strong></span><span id="fd42" class="kd ke hi jz b fi kj kg l kh ki"><em class="jt"># Filter rows for mammals in the Perissodactyla and Primates taxonomic order</em><br/><strong class="jz hj">msleep %&gt;%<br/> filter(order %in% c(“Perissodactyla”, “Primates”))</strong></span></pre><p id="04e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">安排动词:</strong></p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="0f26" class="kd ke hi jz b fi kf kg l kh ki"><strong class="jz hj"><em class="jt">#</em></strong><em class="jt">To arrange (or re-order) rows by a particular column such as the taxonomic #order, list the name of the column you want to arrange the rows by<br/></em><strong class="jz hj">msleep %&gt;% arrange(order)</strong></span><span id="069b" class="kd ke hi jz b fi kj kg l kh ki"><em class="jt"># Now, we will select three columns from msleep, arrange the rows by the #taxonomic order and then arrange the rows by sleep_total in desc order. Finally #show the head of the final data frame<br/></em><strong class="jz hj">msleep %&gt;%<br/> select(name, sleep_total, order) %&gt;%<br/> arrange(order, desc(sleep_total)) %&gt;% head(5)</strong></span></pre><p id="f6cc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">变异动词:</strong></p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="2229" class="kd ke hi jz b fi kf kg l kh ki"><em class="jt"># Create new columns using mutate()<br/># The mutate() function will add new columns to the data frame. Create a new #column called rem_proportion which is the ratio of rem sleep to total amount of #sleep.</em><br/><strong class="jz hj">msleep %&gt;%<br/> mutate(rem_proportion = sleep_rem/ sleep_total)</strong></span></pre><p id="cce4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">总结:</strong></p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="458f" class="kd ke hi jz b fi kf kg l kh ki"><em class="jt"># Create summaries of the data frame using summarise()<br/># to compute the average number of hours of sleep, apply the mean() function to #the column sleep_total and call the summary value avg_sleep.<br/></em><strong class="jz hj">msleep %&gt;%<br/> summarise(avg_sleep = mean(sleep_total),<br/> min_sleep = min(sleep_total),<br/> max_sleep = max(sleep_total))</strong></span></pre><p id="b2e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">使用group_by() <br/> </strong> <em class="jt"> </em>分组操作group_by()动词是dplyr中的一个重要函数。<br/>这与“拆分-应用-合并”的概念有关。我们实际上想要通过一些变量(例如分类顺序)分割数据框，将一个函数应用到各个组，然后组合输出。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="1037" class="kd ke hi jz b fi kf kg l kh ki"><em class="jt"># Let’s do that: split the msleep data frame by the taxonomic order, then ask for #the same summary statistics as above. We expect a set of summary statistics #for each taxonomic order.</em><br/><strong class="jz hj">msleep %&gt;%<br/> group_by(order) %&gt;%<br/> summarise(max_sleep = max(sleep_total)) %&gt;%<br/> arrange(desc(max_sleep))</strong></span></pre></div></div>    
</body>
</html>