<html>
<head>
<title>Stack Overflow Tag Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">堆栈溢出标签预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/stack-overflow-tag-prediction-fb5c17d6bf39?source=collection_archive---------13-----------------------#2020-12-24">https://medium.com/analytics-vidhya/stack-overflow-tag-prediction-fb5c17d6bf39?source=collection_archive---------13-----------------------#2020-12-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6a444756757795b8bdc6fc6c1dee261a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tvLQGQNDG3KDTmGN.jpg"/></div></div></figure><p id="8bab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你是一名软件工程师或程序员，你一生中一定至少使用过一次 StackOverflow。但是你有没有想过 StackOverflow 是如何预测给定问题的标签的？在这篇博客中，我将讨论 StackOverflow 标记预测器案例研究。</p><h1 id="1d29" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">内容</h1><ol class=""><li id="b8d2" class="km kn hi is b it ko ix kp jb kq jf kr jj ks jn kt ku kv kw bi translated">堆栈溢出数据集概述。</li><li id="5d88" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">探索性数据分析。</li><li id="b4be" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">数据预处理。</li><li id="3e0c" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">数据的缩减。</li><li id="270c" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">列车测试分离。</li><li id="8af0" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">使用 Tfidf 矢量器的文本特征。</li><li id="086b" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">超参数调谐。</li><li id="d10b" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">使用 OneVsRest 分类器的逻辑回归</li><li id="c008" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">带 SVM 的 OneVsRestClassifier</li><li id="5900" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">结论。</li><li id="4457" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">增强功能。</li></ol><p id="6680" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Stack Overflow 是最大、最值得信赖的在线社区，供开发人员学习、分享他们的编程知识和发展他们的职业生涯。</p><p id="b55c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">堆栈溢出是每个程序员都会以某种方式使用的东西。每个月都有超过 5000 万的开发人员来到 Stack Overflow 学习、分享他们的知识，并建立他们的职业生涯。它的特点是在计算机编程中广泛的问题和答案。该网站为用户提供了一个提问和回答问题的平台，并通过会员资格和积极参与，对问题和答案进行投票表决，并以类似于 wiki 或 Digg 的方式编辑问题和答案。截至 2014 年 4 月，Stack Overflow 拥有超过 4，000，000 个注册用户，到 2015 年 8 月底，其问题数量超过 10，000，000 个。根据分配给问题的标签类型，网站上讨论最多的前八个主题是 Java、JavaScript、C#、PHP、Android、jQuery、Python 和 HTML。</p><p id="55d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据可以在这里找到<a class="ae lc" href="https://www.kaggle.com/c/facebook-recruiting-iii-keyword-extraction/data" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"/></a><strong class="is hj">。</strong></p><p id="ecb4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">关于<a class="ae lc" href="https://youtu.be/nNDqbUhtIRg" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">问题</strong> </a> <strong class="is hj">的 Youtube 解释。</strong></p><p id="031e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">更多信息请阅读研究论文<a class="ae lc" href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/tagging-1.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">此处</strong> </a> <strong class="is hj">。</strong></p><p id="7c11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Github 代码回购:<a class="ae lc" href="https://github.com/Sachin-D-N/Stack_overflow_Tag_Prediction/blob/main/Stack_Overflow_Tag_Predictor/Stack_Overflow_Tag_Predictor.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> StackOverflow 标签预测器</strong> </a></p><h1 id="5aa8" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">问题陈述</h1><p id="e1dc" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">仅给定问题文本及其标题，预测标签(关键词、主题、摘要)。</p><p id="c093" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">阅读<a class="ae lc" href="https://www.kaggle.com/c/facebook-recruiting-iii-keyword-extraction/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">上的完整问题陈述</strong></a></p><ul class=""><li id="be50" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn lj ku kv kw bi translated">高<a class="ae lc" rel="noopener" href="/analytics-vidhya/performance-metrics-for-machine-learning-models-80d7666b432e"> <strong class="is hj">精度预测尽可能多的标签，召回</strong> </a> <strong class="is hj">。</strong></li><li id="5de6" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">不正确的标签可能会影响 StackOverflow 上的客户体验。</li><li id="c6bc" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">没有严格的延迟限制。</li></ul><h1 id="0abc" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">数据</h1><p id="19cb" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">数据包含 4 个字段</p><ol class=""><li id="0624" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn kt ku kv kw bi translated">Id —每个问题的唯一标识符</li><li id="7b48" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">标题—问题的标题</li><li id="2d0c" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">正文—问题的正文</li><li id="1a0a" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">标签—与问题相关联的标签</li></ol><p id="de5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击<strong class="is hj"> </strong> <a class="ae lc" href="https://www.kaggle.com/c/facebook-recruiting-iii-keyword-extraction/data" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">此处</strong> </a> <strong class="is hj"> </strong>了解更多详情。</p><p id="fcb8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有的数据都在两个文件中:训练和测试。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="c8db" class="lt jp hi lp b fi lu lv l lw lx"><strong class="lp hj">Size of Train.csv</strong> - 6.75GB<br/><strong class="lp hj">Size of Test.csv</strong> - 2GB<br/><strong class="lp hj">Number of rows in Train.csv</strong> = 6034195</span></pre><p id="0b30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些问题是随机的，既包含冗长的文本网站，也包含与数学和编程相关的网站。每个站点的问题数量可能会有所不同，并且没有对问题进行筛选。</p><h1 id="bb10" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">样本数据点</h1><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="abc9" class="lt jp hi lp b fi lu lv l lw lx"><strong class="lp hj">Title</strong>: Implementing Boundary Value Analysis of Software Testing in a C++ program?<strong class="lp hj">Body </strong>:</span><span id="48b1" class="lt jp hi lp b fi ly lv l lw lx">#include&lt; iostream&gt;\n #include&lt; stdlib.h&gt;\n\n using namespace std;\n\n int main()\n {\n int n,a[n],x,c,u[n],m[n],e[n][4];\n cout&lt;&lt;"Enter the number of variables";\n cin&gt;&gt;n;\n\n cout&lt;&lt;"Enter the Lower, and Upper Limits of the variables";\n for(int y=1; y&lt;n+1; y++)\n {\n cin&gt;&gt;m[y];\n cin&gt;&gt;u[y];\n }\n for(x=1; x&lt;n+1; x++)\n {\n a[x] = (m[x] + u[x])/2;\n }\n for(int i=1; i&lt;n+1; i++)\n {\n for(int l=1; l&lt;=i; l++)\n {\n if(l!=1)\n {\n cout&lt;&lt;a[l]&lt;&lt;"\\t";\n }\n }\n for(int j=0; j&lt;4; j++)\n {\n cout&lt;&lt;e[i][j];\n for(int k=0; k&lt;n-(i+1); k++)\n {\n cout&lt;&lt;a[k]&lt;&lt;"\\t";\n }\n cout&lt;&lt;"\\n";\n }\n } \n\n system("PAUSE");\n return 0; \n }\n</span><span id="6677" class="lt jp hi lp b fi ly lv l lw lx">\n\n</span><span id="aeee" class="lt jp hi lp b fi ly lv l lw lx">The answer should come in the form of a table like</span><span id="e346" class="lt jp hi lp b fi ly lv l lw lx">\n\n</span><span id="524a" class="lt jp hi lp b fi ly lv l lw lx">The output is not coming,can anyone correct the code or tell me what\'s wrong?</span><span id="8b64" class="lt jp hi lp b fi ly lv l lw lx">\n' <strong class="lp hj">Tags </strong>: 'c++ c'</span></pre><h1 id="8879" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">将业务问题映射到机器学习问题</h1><p id="2d22" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">这是一个多标签分类问题。</p><p id="ba45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在多标签分类中，多个标签(在这个问题中是它的标签)可以被分配给每个实例，并且对于该实例可以被分配给多少个类没有限制。来源:<a class="ae lc" href="https://en.wikipedia.org/wiki/Multi-label_classification" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">维基</strong> </a></p><p id="6707" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击 了解更多关于多标签分类问题<a class="ae lc" href="https://scikit-learn.org/stable/modules/multiclass.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"/></a></p><p id="1524" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Stackoverflow 上的一个问题可能是关于 C、指针、JAVA、Regex、FileIO 和/或内存管理中的任何一个，也可能不是这些。</p><h2 id="ac9b" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">绩效指标</h2><ol class=""><li id="5f9c" class="km kn hi is b it ko ix kp jb kq jf kr jj ks jn kt ku kv kw bi translated">微观 F1 分数</li><li id="ef5b" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">宏观 F1 分数</li></ol><p id="f373" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请阅读这篇<a class="ae lc" href="https://www.kaggle.com/wiki/HammingLoss" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">博客</strong> </a>了解更多关于度量的信息。</p><h1 id="3f61" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">探索性数据分析</h1><p id="cb61" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">我已经使用熊猫图书馆加载数据。请访问我的<a class="ae lc" href="https://github.com/Sachin-D-N/Stack_overflow_Tag_Prediction/blob/main/Stack_Overflow_Tag_Predictor/Stack_Overflow_Tag_Predictor.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> GitHub </strong> </a> repo 查看完整代码。我从 Train.csv 中抽取了 20 万(20 万)个数据点的样本。</p><ol class=""><li id="bbeb" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn kt ku kv kw bi translated">数据库中的行数:200000</li><li id="4e3b" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">唯一标签的数量:42048</li><li id="108b" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">十大重要标签:['。一个'，'。app '，' . asp.net-mvc '，'。aspxauth“，”。bash-profile“，”。类别档案'，'。cs 文件“，”。文档'，'。drv '，'。ds-store']</li><li id="d8e5" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">总共有 153 个标签被使用超过 10000 次。</li><li id="01c1" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">14 个标签使用超过 100000 次。</li><li id="3d53" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">最常用的标记(即 c#)使用了 331505 次。</li><li id="1af8" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">由于一些标签比其他标签出现得更频繁，因此微平均 F1 分数是解决此问题的合适指标。</li></ol><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/8134e95f36f9a58807d908fccbd40bc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ykEZHPRrFl09JDNa.png"/></div></div></figure><p id="1bee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.标签分析</p><ul class=""><li id="9b6f" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn lj ku kv kw bi translated">每个问题的最大标签数:5</li><li id="6260" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">每个问题的最小标签数:1</li><li id="e7e5" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">平均值。每个问题的标签数量:2.899440</li><li id="0ded" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">带有 3 个标签的问题出现的次数更多</li></ul><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/95efb0b4615a1534f77b064c643882ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Oy-YchrtjRwol7y_.png"/></div></div></figure><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/d04ec9bf8ab436f1c21a606fc85db087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G7qPE425H-sSx3BQ.png"/></div></div></figure><p id="1f5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">C#出现的次数最多，Java 次之。大多数最常见的标签是编程语言。这是前 20 个标签的图表</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/d404da7b4c92745e146efa3c2f7245a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C2UDsWQDYNvKnk_H.png"/></div></div></figure><ul class=""><li id="c3f8" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn lj ku kv kw bi translated">大多数最常见的标签是编程语言。</li><li id="70a0" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">C#是最常用的编程语言。</li><li id="4f0b" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">Android、IOS、Linux 和 windows 是最常见的操作系统。</li></ul><h1 id="9d2e" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">问题的清洗和预处理</h1><p id="6993" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">由于硬件限制，我只考虑 20 万个数据点</p><ol class=""><li id="808a" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn kt ku kv kw bi translated">问题包含 HTML 标签代码标签，所以从正文中分离出代码片段。</li><li id="9135" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">从标题和正文中删除特殊字符(不在代码中)。</li><li id="4993" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">删除停用词(C 除外)。</li><li id="4e69" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">移除 HTML 标签。</li><li id="fa39" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">将所有字符转换成小写字母。</li><li id="789a" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">使用雪球词干分析器来阻止单词。词干化是将一个单词缩减为其词干的过程。例如:“python”是单词[“python”“python oner”“python 化”“python 化”]的词干。</li><li id="209e" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">给标题更多的权重:给问题加三次标题。标题包含对问题更具体的信息，并且也只有在看到问题标题之后，用户才决定是否详细研究该问题。如果不是所有的用户，至少大部分用户是这样做的。</li></ol><h2 id="7bc4" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">预处理后的样本问题</h2><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/c384bda5ef3513a812508c141e437141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*I4rOmzON4CHoljdc.png"/></div></div></figure><h2 id="110e" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">机器学习模型</h2><ul class=""><li id="3bde" class="km kn hi is b it ko ix kp jb kq jf kr jj ks jn lj ku kv kw bi translated">问题总数:199999</li><li id="22bd" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">标签总数:23747</li></ul><p id="6caa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们要用问题转换(二元相关)的方法来解决问题。</p><h2 id="68a0" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">二元相关性</h2><p id="5478" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">这里我们将把多标签分类问题转化为多个单类分类问题。例如，如果我们有 5 个多标签分类问题，那么我们需要训练 5 个单类分类模型。</p><p id="b2bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上，在这个方法中，我们把每个标签(在我们的例子中是它的标记)作为一个单独的类分类问题。这种技术简单且应用广泛。</p><p id="2097" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请参考这个<strong class="is hj"> </strong> <a class="ae lc" href="https://www.analyticsvidhya.com/blog/2017/08/introduction-to-multi-label-classification/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">博客</strong> </a>了解更多关于解决多标签分类问题的技巧。</p><h2 id="68bf" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">数据的缩减</h2><p id="269f" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">回到我们的 stackoverflow 预测器问题，我们需要训练 23437 个模型！！！对于一个 8GB RAM 和 i5 处理器的系统来说，这实在是太大了(在时间和速度方面)。因此，我们将对标签的数量进行采样，而不是考虑所有标签。但是在信息损失最小的情况下，要采样多少个标签呢？绘制“覆盖问题的百分比”与“标签的数量”将有助于解决这个问题。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/0164af5a9b73fbfa897f331aba40e815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-9tzHn3UtH44asqd.png"/></div></div></figure><h2 id="c9cb" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">观察</h2><ol class=""><li id="8e98" class="km kn hi is b it ko ix kp jb kq jf kr jj ks jn kt ku kv kw bi translated">500 个标签覆盖了 90.446%的问题</li><li id="489f" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">5000 个标签覆盖了 98.77 %的问题</li><li id="c71f" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">通过在总共 23437 个标签中只选择 500 个标签(大约 2%)，我们只丢失了 9%的问题&amp;而且训练 500 个模型是相当好的，所以我们将选择 500 个标签。</li></ol><h1 id="26ba" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">训练和测试数据</h1><p id="5ad1" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">如果每个问题的数据都附有时间戳，那么根据数据的时间性质来拆分数据将比随机拆分数据更有意义。但是由于数据不是时间性的(即没有时间戳)，我们将数据随机分为 80%的训练集和 20%的测试集。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/f773c322a9d847467f97a875461c672d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cuivMSIc5VydYozq.png"/></div></div></figure><h1 id="ff07" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">使用 TfIdf 矢量器显示文本数据</h1><p id="484e" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">有多种方法来描述文本数据。我已经在我的<a class="ae lc" rel="noopener" href="/analytics-vidhya/amazon-fine-food-reviews-featurization-with-natural-language-processing-a386b0317f56"> <strong class="is hj">博客</strong> </a> <strong class="is hj"> </strong>帖子里解释过了。首先，让我们用 TfIdf 矢量器来描述问题数据。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/3176f7818bf4da466d082096e04a6bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vsgFWGtKgkjFGfaH.png"/></div></div></figure><h2 id="768e" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">用 OneVsRest 分类器应用逻辑回归</h2><p id="aac9" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated"><strong class="is hj">超参数调谐以获得最佳 alpha </strong></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/9327263fce6b289535f6c3a650194845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tJf4FNarSIjuVM7t.png"/></div></div></figure><p id="527b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们使用逻辑回归来训练 500 个模型(500 个标签)只不过是具有对数损失的 SGD 分类器。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/7772b40116297c08eecf484cc5d8a547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DCUhjDAz6Xr2c9Ej.png"/></div></div></figure><p id="eba1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">结果</strong></p><ul class=""><li id="1a9a" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn lj ku kv kw bi translated">微 F1-测量值:0.492</li><li id="823d" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">精确度:0.222</li><li id="7932" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">汉明损失:0.0029</li></ul><h2 id="8cd2" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">带 SVM 的 OneVsRestClassifier</h2><p id="65bc" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">让我们用 SVM 算法来训练 500 个模型。线性 SVM 只不过是以损耗为枢纽的 SGD 分类器。在使用 GridSearchCV 找到超参数 alpha 之后，我发现 alpha 是 10**6。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/0921c14ae8685205335a3c0f9e32afd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SkdvhG_IRC6w8q66.png"/></div></div></figure><p id="7e00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">结果</strong></p><ul class=""><li id="acff" class="km kn hi is b it iu ix iy jb lg jf lh jj li jn lj ku kv kw bi translated">微 F1-测量值:0.487</li><li id="3a96" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">精确度:0.201</li><li id="f10f" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">汉明损失:0.0031</li></ul><h1 id="786d" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结论</h1><p id="d5ff" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">在我们目前使用的所有模型中，使用 TfIdf 矢量器和 n_grams=(1，3)的逻辑回归比其他模型表现更好。但我们已经用大量数据点训练了逻辑回归模型，因此将该模型与用较少数据点训练的其余模型进行比较没有意义。</p><p id="db48" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是所有模型的结果…</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/0cb89935cb3860c586dc4e688e10fb4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hvxo1ohFWcTysoR3.png"/></div></div></figure><p id="50b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们只训练了两个线性模型。其他模型，如基于树的模型，由于数据的高维度，在这里不太适用。线性 SVM 具有高时间复杂度，因此在线性 SVM 上训练 500 个模型是不可行的。因此，SGD 分类器是我们的最佳选择。</p><h1 id="cf5b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">像随机森林或 GBDT 这样的复杂模型有问题吗？</h1><p id="f0b9" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">你可能已经注意到了，我采用了像逻辑回归和线性 SVM 这样最简单的模型来训练这个模型。这是复杂模型没有被尝试的两个主要原因</p><p id="fe18" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">高维数据</strong>:由于我们将文本转换为 TfIdf 或 BOW 向量，所以我们得到的维度非常大。当维度很大时，典型的随机森林&amp; GBDT 将不会很好地工作。</p><p id="986c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">需要训练的模型太多:我们实际上有 500 个模型需要训练(在缩减数据之后)。逻辑回归是人们可以使用的最简单的模型&amp;它相对来说更快。如果我们开始使用其他模型，如 RBF-SVM 或 RF，将需要太多的时间来训练模型。对我来说，训练线性 SVM 需要更多的时间，这也是在大幅度缩减数据之后。</p><h2 id="2740" class="lt jp hi bd jq lz ma mb ju mc md me jy jb mf mg kc jf mh mi kg jj mj mk kk ml bi translated">提高</h2><p id="72b2" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">尝试使用更多数据点(在具有 32GB RAM 和高端处理器的系统上)用 Word2Vec 特征化文本数据:当您尝试使用 Word2Vec 时，数据的维数会降低&amp;因此像随机森林或 GBDT 这样的复杂模型可能会工作得很好。</p><p id="44b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">尝试使用 scikit-multilearn 库。请注意，这个库不接受一个稀疏矩阵作为输入，你需要给出一个密集矩阵作为输入。所以显然你需要更多的内存来使用这个库。</p><p id="88d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要了解完整代码请访问我的<a class="ae lc" href="https://github.com/Sachin-D-N/Stack_overflow_Tag_Prediction/blob/main/Stack_Overflow_Tag_Predictor/Stack_Overflow_Tag_Predictor.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> GitHub </strong> </a>链接。</p><p id="3ff0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢您的阅读和耐心。我希望你喜欢这个帖子，如果我的帖子有错误，请告诉我。</p><h1 id="e374" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">参考</h1><ul class=""><li id="55fc" class="km kn hi is b it ko ix kp jb kq jf kr jj ks jn lj ku kv kw bi translated">应用人工智能</li><li id="dcd9" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">维基百科(一个基于 wiki 技术的多语言的百科全书协作计划ˌ也是一部用不同语言写成的网络百科全书ˌ 其目标及宗旨是为全人类提供自由的百科全书)ˌ开放性的百科全书</li><li id="61a6" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">Coursera</li><li id="e743" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn lj ku kv kw bi translated">数据营</li></ul><blockquote class="my mz na"><p id="28f8" class="iq ir nb is b it iu iv iw ix iy iz ja nc jc jd je nd jg jh ji ne jk jl jm jn hb bi translated"><strong class="is hj">联系人:</strong> <a class="ae lc" href="https://sachin-d-n.github.io/Stack_overflow_Tag_Prediction/sachin.s1dn@gmail.com" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">邮箱</strong></a><strong class="is hj"/><a class="ae lc" href="https://www.linkedin.com/in/sachin-d-n-1st-8150351b2/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">LinkedIn</strong></a><strong class="is hj"/><a class="ae lc" href="https://github.com/Sachin-D-N/Stack_overflow_Tag_Prediction/tree/main" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">Github</strong></a><strong class="is hj"/><a class="ae lc" href="https://sachin-s1dn.medium.com/" rel="noopener"><strong class="is hj">中型</strong></a><strong class="is hj"/><a class="ae lc" href="https://twitter.com/home" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">Twitter</strong></a></p></blockquote><p id="aead" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="nb">博客也发布在</em><a class="ae lc" href="https://sachin-d-n.github.io/Stack_overflow_Tag_Prediction/" rel="noopener ugc nofollow" target="_blank"><em class="nb">https://sachin-d-n . github . io</em></a><em class="nb">。</em></p></div></div>    
</body>
</html>