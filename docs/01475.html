<html>
<head>
<title>Recreate your Google Analytics reports in BigQuery using dbt</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用dbt在BigQuery中重新创建您的Google分析报告</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/recreate-your-google-analytics-reports-in-bigquery-using-dbt-part-ii-deep-dive-6f2a35a3706f?source=collection_archive---------3-----------------------#2019-10-25">https://medium.com/analytics-vidhya/recreate-your-google-analytics-reports-in-bigquery-using-dbt-part-ii-deep-dive-6f2a35a3706f?source=collection_archive---------3-----------------------#2019-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="01fa" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第二部分——深潜</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/5a4aee1094e89cf3c50b9c8394a34a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u_7O-JSGpkuzkKUr"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jn" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Carlos Muza </a>拍摄的照片</figcaption></figure><p id="1feb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">数据建模是一个巨大的话题。</p><p id="dcda" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了用我有限的英语恰当地强调这一点，我可能应该写<strong class="jq hj">巨大的</strong>来代替。</p><p id="94fa" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你想知道它有多大，你可以看看Olivier Dupuis  的这个<a class="ae jn" href="https://www.lantrns.co/post/my-journey-introducing-the-data-build-tool-dbt-in-projects-analytical-stacks/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">帖子中的有向无环图。或者在#measure Slack信道中发布的一些Dag。转换大量原始的、不清楚的、杂乱的数据是一项乏味的工作，通常需要多个相互关联的步骤。但是每个能够访问SQL数据库的分析师通常每天都会在较小的范围内这样做。使用一个SQL查询创建一个视图，另一个查询从这个视图创建一个表，另一个查询将它与一些其他数据连接起来…</strong></a></p><p id="1b82" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这个小系列的前一篇文章中，我一直试图展示数据构建工具(dbt)的概念，它旨在使数据转换更容易。<strong class="jq hj">我向您展示了一个工作dbt模型，它应该使用GA导出数据在BigQuery中重新创建一些Google分析模型。我也试着给你一些如何操作的指导。</strong></p><p id="2395" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">“迷你”应该是这篇文章的一个关键词。在BigQuery中重新创建一些谷歌分析报告的整个想法是“迷你”转换的一个例子，许多网络分析师可能会不时地这样做，然后就忘记了。这可以通过使用具有大量cte或子查询的大型查询或使用一系列预定查询来完成。</p><p id="d696" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">不太好，效率不高，可能会坏。这篇文章的目标是探索使用dbt使这些小的转换更容易、更可靠，最重要的是——可重用的可能性。</p><p id="61da" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一部分我几乎是摸不着头脑，这一次我们将尝试提供一些肉。我们将挖掘一些使dbt对我们小小的网络分析世界如此有趣的特性。准备好了吗？</p><h1 id="f21e" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">基础知识</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lc"><img src="../Images/80b8f3d287cfdb844913bd6f2bfd9952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ORoR9wrhXzl7QpMz6Vc4g.jpeg"/></div></div></figure><p id="d311" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们先回顾一下。</p><p id="2f3a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们在做什么？使用Google Analytics导出数据在BigQuery中重新创建3个Google Analytics报告(源/媒体、产品性能、所有页面)。</p><p id="7e7c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><a class="ae jn" rel="noopener" href="/@Buczynski/recreate-your-ga-reports-in-bigquery-using-data-build-tool-part-i-magic-a4610cf5631c"> <strong class="jq hj">在这里你会发现第一部分</strong> </a>，展示了如何安装dbt和运行模型。</p><p id="db96" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><a class="ae jn" href="https://github.com/patbuczynski/dbt-ga-bq-replicate" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">在这里你会找到模型库</strong> </a> <strong class="jq hj">。</strong>它包含两个文件夹和dbt_project.yml文件。dbt_project.yml存储所有与模型相关的设置，如文件夹路径和变量。说到文件夹，这并不奇怪:“macros”文件夹包含了模型中使用的所有宏。</p><p id="59bd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">“model”文件夹分为两个子文件夹:<strong class="jq hj"> Staging </strong>，包含唯一不会具体化为表的子查询；以及<strong class="jq hj"> Production </strong>，包含将成为BigQuery中的表的最终查询。</p><p id="539c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您独立分析每个查询，您会发现它们只是普通的SQL，带有一些奇怪的附加公式。这是正确的。经过大量的简化，dbt可以被定义为由Jinja模板框架支持的SQL查询的集合。但是dbt的强大之处在于关系:模型与其他模型、模型与宏、宏与变量等等。</p><h1 id="92fd" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">dbt和关系的力量</h1><p id="839a" class="pw-post-body-paragraph jo jp hi jq b jr ld ij jt ju le im jw jx lf jz ka kb lg kd ke kf lh kh ki kj hb bi translated">现在，我们正进入dbt成为下一个热门事物的核心。这可能是一个非常空泛的陈述，但在<strong class="jq hj">更简单的情况下，大多数数据构建工具的能力来自于使SQL动态化的能力</strong>，基于其他值(如变量或宏)填充一个模型中的值。那是什么意思？数据构建工具如何做到这一点？</p><ul class=""><li id="03c8" class="li lj hi jq b jr js ju jv jx lk kb ll kf lm kj ln lo lp lq bi translated"><strong class="jq hj">确定执行顺序</strong></li></ul><p id="7823" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">dbt基于查询之间的关系和引用来实现这一点。当你在一个有限的BigQuery环境中工作，并且不熟悉其他云工作流自动化工具(比如我)时，这一点超级重要。<strong class="jq hj">如果您曾经尝试使用BigQuery调度查询来编排多个相互依赖的查询，您就会知道这不是最可靠的解决方案</strong>。数据构建工具解决了这个问题，它基于你的查询构建一个DAG(有向无环图)。它检查模型的哪个元素依赖于其他元素，并在此基础上构建队列。</p><p id="15c3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们检查模型中的示例。</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="f5d5" class="lw kl hi ls b fi lx ly l lz ma">{{config(materialized = ‘table’)}}</span><span id="149d" class="lw kl hi ls b fi mb ly l lz ma">SELECT *,<br/>sum(revenue/quantity) avgPrice, <br/>sum(quantity/transactions) avgQuantity <br/><strong class="ls hj">FROM {{ref(‘stg_revenue’)}}</strong><br/>GROUP BY 1,2,3,4 <br/>ORDER BY 2 DESC</span></pre><p id="f7a8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是一个简单的<a class="ae jn" href="https://github.com/patbuczynski/dbt-ga-bq-replicate/blob/master/models/Production/productPerformance.sql" rel="noopener ugc nofollow" target="_blank">查询</a>，它重新创建了一个产品性能报告，从stg_revenue表(可以在<a class="ae jn" href="https://github.com/patbuczynski/dbt-ga-bq-replicate/blob/master/models/Staging/stg_revenue.sql" rel="noopener ugc nofollow" target="_blank"> Staging文件夹</a>中找到)中获取所有指标，并在它们的基础上进行一些计算。这</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="ab71" class="lw kl hi ls b fi lx ly l lz ma">FROM {{ref(‘stg_revenue’)}}</span></pre><p id="34de" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">命令告诉dbt，它需要首先解析stg_revenue查询，以便能够完成这个查询。因此，最简单的Dag正在创建:</p><p id="5869" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> stg_revenue - &gt;产品性能</strong></p><p id="c19b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">简单到不需要那些花哨的DAG图形:)</p><ul class=""><li id="44c4" class="li lj hi jq b jr js ju jv jx lk kb ll kf lm kj ln lo lp lq bi translated"><strong class="jq hj">金佳</strong></li></ul><p id="467e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我们模型的上下文中(可能还有BQ中的GA数据),这是dbt最重要的特性。Jinja是Python的一个模板框架，它在编写枯燥的(不要重复)SQL时有惊人的用途。让我们试着用一些例子来理解它。</p><p id="ca85" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是s<a class="ae jn" href="https://github.com/patbuczynski/dbt-ga-bq-replicate/blob/master/models/Production/sourceMedium.sql" rel="noopener ugc nofollow" target="_blank">ource media . SQL</a>的一个片段:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="4b03" class="lw kl hi ls b fi lx ly l lz ma">with s as ({{getSessions(‘concat(trafficSource.source, “ / “, trafficSource.medium)’, ‘sm’)}}),</span></pre><p id="3129" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在allPages模型中，您会发现一些非常相似的内容:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="c3fa" class="lw kl hi ls b fi lx ly l lz ma">JOIN ({{ getSessions(‘h.page.pagePath’, ‘page’) }}) as s </span></pre><p id="6dde" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你在上面看到的是一个在两个不同模型中重用的Jinja宏。它获得会话的数量，但基于不同的维度。</p><p id="11bf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您编译并运行第一条语句，您将获得按流量来源和媒介划分的会话数量(在Google Analytics中显示为“来源/媒介”形式)。</p><p id="0ef3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您编译并运行第二条语句，您将获得按页面划分的会话数量。这就像改变谷歌分析定制报告中的维度。下面是实现这一点的代码:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="a8bc" class="lw kl hi ls b fi lx ly l lz ma">{% macro getSessions(<strong class="ls hj">field, alias</strong>) -%}<br/><br/>	SELECT <br/><strong class="ls hj">  {{ alias }}<br/></strong>  , sum(CASE WHEN hitNumber = first_hit THEN visits ELSE null END) AS sessions<br/>  FROM (SELECT<br/><strong class="ls hj">        {{ field }} {{ alias }}<br/></strong>        , MIN(h.hitNumber) OVER (PARTITION BY fullVisitorId, visitStartTime) AS first_hit<br/>        , h.hitNumber<br/>        , totals.visits<br/>        FROM {{var('tableName')}}, {{ unnest('hits', 'h') }}<br/>	WHERE {{tableRange()}}<br/>        GROUP BY 1, h.hitNumber, fullVisitorId, visitStartTime, totals.visits, visitId<br/>        ORDER BY 2 DESC)<br/>      {{ group_by(1) }}<br/>      ORDER BY 2 DESC<br/><br/>{%- endmacro %}</span></pre><p id="996e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Jinja宏类似于编程语言中的函数逻辑。它们是用一组参数定义的(在我们的例子中是'<strong class="jq hj">字段</strong>和'<strong class="jq hj">别名</strong>')，然后可以用这些参数调用。SQL查询是用参数值编译的。所以，基本上如果你用:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="bf56" class="lw kl hi ls b fi lx ly l lz ma">{{ getSessions(‘<strong class="ls hj">h.page.pagePath</strong>’, ‘<strong class="ls hj">page</strong>’) }}</span></pre><p id="bfd9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">编译后的SQL如下所示:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="5ff0" class="lw kl hi ls b fi lx ly l lz ma">SELECT <br/>    <strong class="ls hj">page</strong><br/>  , sum(CASE WHEN hitNumber = first_hit THEN visits ELSE null END) AS sessions<br/>  FROM (SELECT<br/>        <strong class="ls hj">h.page.pagePath page</strong><br/>        , MIN(h.hitNumber) OVER (PARTITION BY fullVisitorId, visitStartTime) AS first_hit</span></pre><p id="85af" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">宏试图抽象GA会话逻辑，以便能够获得任意维度的会话数。第二个宏(getBounces)做了完全相同的事情，但是获得了反弹次数(不是反弹率)指标。</p><p id="31f7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在<strong class="jq hj"> utility.sql </strong>文件夹中，您会发现一些小的宏，它们可能会让您的生活变得更加轻松，还有一些冗余的宏(比如unnest宏，它需要的代码量与它所替换的语句相同)。在下一节中，我们将更深入地了解其中的一些。</p><ul class=""><li id="4621" class="li lj hi jq b jr js ju jv jx lk kb ll kf lm kj ln lo lp lq bi translated"><strong class="jq hj">变量</strong></li></ul><p id="5aa5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">另一件美好的事。Google Analytics big query export schema让你大量重复小事情。表名就是一个很好的例子。</p><p id="d1c1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您有很多Google Analytics属性，并且数据导出到BigQuery，您可能习惯于在所有这些属性之间周旋<code class="du mc md me ls b">duggly-muggly.819301803.ga_sessions_</code>这不是世界上最耗时的任务，但是复制和粘贴不同的表名可能有点烦人。Dbt变量解决了这个问题——你可以在dbt_project.yml文件中定义表名(还记得“项目设置”一节中的<strong class="jq hj"> tableName </strong>变量吗？)然后使用<code class="du mc md me ls b">{{var(‘variable_name’)}}</code>引用它们</p><p id="628a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">就像allPages模型一样:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="57f3" class="lw kl hi ls b fi lx ly l lz ma">(SELECT <br/>  h.page.pagePath Page<br/>  , count(*) Pageviews<br/>  , count(distinct concat(fullVisitorId, cast(visitID as string))) uniquePageviews<br/>  , sum(CASE when h.isEntrance is not null then 1 end) Entraces<br/>  , sum(CASE when h.isExit is not null then 1 end) Exits<br/><strong class="ls hj">  FROM {{var('tableName')}}</strong>, unnest(hits) as h</span></pre><p id="81ba" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这将简单地编译成</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="1c7b" class="lw kl hi ls b fi lx ly l lz ma">FROM `table_name_that_you_specified_in_dbt_project.yml file`</span></pre><p id="e3a7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您可以在您创建的每个新模型中重用该设置。</p><p id="f038" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我们的模型中，我们还有两个变量:<strong class="jq hj"> rangeStart </strong>和<strong class="jq hj"> rangeEnd。</strong>定义查询的时间范围，不直接在模型中使用。相反，你会在<strong class="jq hj"> tableRange() </strong>宏中找到它，放置在<strong class="jq hj">宏</strong>文件夹中的<a class="ae jn" href="https://github.com/patbuczynski/dbt-ga-bq-replicate/blob/master/macros/bq-ga/utility.sql" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> utility.sql </strong> </a>文件中:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="b529" class="lw kl hi ls b fi lx ly l lz ma">{% macro tableRange() -%}</span><span id="bda4" class="lw kl hi ls b fi mb ly l lz ma">_table_suffix between '<strong class="ls hj">{{var("rangeStart")}}</strong>' and '<strong class="ls hj">{{var("rangeEnd")}}</strong>'</span><span id="a327" class="lw kl hi ls b fi mb ly l lz ma">{%- endmacro %}</span></pre><p id="4c5f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该宏用您在<strong class="jq hj"> dbt_project.yml </strong>文件中指定的变量填充_table_suffix语句(在BQ中大量使用GA数据)。因此，为了在我们的模型中使用时间范围，我们只需要调用宏:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="f591" class="lw kl hi ls b fi lx ly l lz ma">(SELECT <br/>          concat(trafficSource.source, " / ", trafficSource.medium) sm ,<br/>          sum(totals.transactions) transactions,<br/>          sum(totals.totalTransactionRevenue / 1000000) revenue<br/>          FROM {{var('tableName')}}<br/><strong class="ls hj">   WHERE {{ tableRange() }}</strong></span></pre><p id="0c24" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它将编译成:</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="d419" class="lw kl hi ls b fi lx ly l lz ma">WHERE _table_suffix between <em class="mf">'rangeStart value' </em>and <em class="mf">'rangeEnd value'</em></span></pre><p id="7468" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这样，当您想要更改日期范围时，不必每次都更改每个查询中的值。</p><p id="1817" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">更是得心应手。运行模型(<a class="ae jn" rel="noopener" href="/@Buczynski/recreate-your-ga-reports-in-bigquery-using-data-build-tool-part-i-magic-a4610cf5631c#b8c4"> dbt run </a>)时，您可以使用</p><pre class="iy iz ja jb fd lr ls lt lu aw lv bi"><span id="d6d3" class="lw kl hi ls b fi lx ly l lz ma">dbt run --vars <!-- -->'{key: value}'</span></pre><p id="7d08" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">旗帜。你只需要做一次，而不是在多次查询中改变范围。这是最干燥的了。你可以在dbt网站上找到更多相关信息。</p><h2 id="7170" class="lw kl hi bd km mg mh mi kq mj mk ml ku jx mm mn kw kb mo mp ky kf mq mr la ms bi translated">还有什么？</h2><p id="ba52" class="pw-post-body-paragraph jo jp hi jq b jr ld ij jt ju le im jw jx lf jz ka kb lg kd ke kf lh kh ki kj hb bi translated">这只是在小型建模任务中可能最有用的选定特征的一小部分。如果您决定更深入地挖掘，您将会发现诸如物化处理、调度(显然)以及最令人兴奋的东西:自动化测试。但是这些特性在我们的模型中并没有用到(或者没有用到很大程度上)。</p><h1 id="cb5f" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">dbt在网络分析领域的下一步是什么？</h1><p id="7dc8" class="pw-post-body-paragraph jo jp hi jq b jr ld ij jt ju le im jw jx lf jz ka kb lg kd ke kf lh kh ki kj hb bi translated">即使只了解dbt最基本的特性，它也会让您觉得值得花时间去研究。我不打算把数据建模作为我的日常业务，但可以把它看作是我的工具箱中一个有价值的补充。特别是当考虑到我们的行业带来的挑战时，比如将历史谷歌分析数据与新的网络和应用属性/扫雪机合并，或者为营销建立真正的仓库，拥有数十亿的谷歌广告表……:)</p><p id="af59" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">可行的数据建模慢慢成为一种需求，而不是web分析中的一个选项</strong>。至少在一些比较大的公司是这样。</p><p id="fe79" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然而，让我重复我的话dbt承诺的最大优势不是技术上的。都是关于<a class="ae jn" rel="noopener" href="/@Buczynski/recreate-your-ga-reports-in-bigquery-using-data-build-tool-part-i-magic-a4610cf5631c#b813"> <strong class="jq hj">心态转变。</strong> </a> <strong class="jq hj">它让你把你的SQL当做一个可重用的资源，而不是一有数据就可以忘记的东西。</strong></p><p id="2a72" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在开始构建您的SQL-dbt代码库可能是一个不错的举措。即使这仅仅意味着在BigQuery中重新创建一些谷歌分析数据。</p></div></div>    
</body>
</html>