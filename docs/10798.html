<html>
<head>
<title>How to pd.merge() two data-frames on a common date column.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何pd.merge()一个公共日期列上的两个数据帧。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-pd-merge-two-data-frames-on-a-common-date-column-e7808d7ccaee?source=collection_archive---------0-----------------------#2020-11-03">https://medium.com/analytics-vidhya/how-to-pd-merge-two-data-frames-on-a-common-date-column-e7808d7ccaee?source=collection_archive---------0-----------------------#2020-11-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/cf76cde16bb53c230a5e62636e3c7f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ndkYNtdcHpAcfFyQ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">马库斯·斯皮斯克在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="fe49" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用新冠肺炎病例和死亡数据进行数据分析的主要挑战之一是将这两个数据框架在日期上合并在一起。由于每个CSV数据文件中有重复的日期条目，合并两个数据帧并不简单。以下是我如何应对这一挑战的解释。</p><h1 id="3885" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak"> 1。数据下载- Cases.csv </strong></h1><p id="e953" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我已经从coronovirus.data.gov.uk下载并保存了cases.csv文件到我的Kaggle网页中。这是对这些数据的一个快速浏览。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/8341dff5fd5b46ccf0e443285c00bfd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TRxXDUAizv0So9vqwRVjPw.png"/></div></div></figure><p id="7295" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">清理和数据准备— </strong>转换日期数据类型，检查数据帧长度，检查空值。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/4f9bb954f471a1153aa74bc8f8db9446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*17XIfAE0Kj0_S-PkxF7S4A.png"/></div></figure><p id="7a7e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">检查任何重复- </strong> 269个唯一的日期表明这些日期是重复的，即重复几次，因此我们得到长度975。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/36bce68a611781b7ddeda10285fdf6cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yw7i9w0JFNvfwlOac_I0ew.png"/></div></div></figure><p id="3f82" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> groupby()、sum() </strong> —使用dates列上的groupby()和newCases列上的sum()返回长度为269的series对象。这将把所有重复的日期组合成一组，并将它们各自的案例相加。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/f0bed9697f4718b15735b318ac826e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lidhrMD8bv1tyBsiXCKYvA.png"/></div></div></figure><p id="e837" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">系列到数据框</strong> — Groupby()函数返回一个系列对象。所以下一步是将这个series对象转换成一个269行的新数据帧。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/7c0cce732be13f4028cfa326b57a024a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bwu3wMqvGeAGRBm5nrOQFw.png"/></div></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/d6fbd2d0618e2b74bcb238d51139dc84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uRFAmrsfRlivbik09QHrxg.png"/></div></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/2e321571ed05cbe259702d34ea1ff2df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*zaaUULFgcRuFxbHYrWsmzQ.png"/></div></figure><p id="6121" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Cases_df数据帧现已准备就绪，可与另一个数据帧合并。</strong></p><h1 id="3cbd" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2 <strong class="ak">。数据下载— Deaths.csv </strong></h1><p id="0f7f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我已经从coronovirus.data.gov.uk下载并保存了deaths.csv文件到我的Kaggle网页中。这是对这些数据的一个快速浏览。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/871c197a552d7436dac84f7e6b71410f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3vsgJO14aaBh4i2E6YdIw.png"/></div></div></figure><p id="753a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">清理和数据准备— </strong>转换日期数据类型，检查数据帧长度，检查空值。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es li"><img src="../Images/46975e6b5061dfc8cbb74fe689e711bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*1AF7WAPpQLlgv7mgS3gBDw.png"/></div></figure><p id="ee1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">检查任何重复- </strong> 226个唯一的日期表明这些日期是重复的，即重复了几次，因此我们得到长度862。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/889eefa9b1c9ca5d20ecb8fb251c53d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_mBYUnb0DuPuogMlIqtqA.png"/></div></div></figure><p id="5f50" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> groupby()，sum() </strong> —使用dates列上的groupby()和newDeaths列上的sum()返回长度为226的series对象。这将把所有重复的日期归为一组，并把他们各自的死亡时间加起来。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/460299099ee27298adbedc6134a78a0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*lMIGuaz-cxcjuaKGWKRbxw.png"/></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/938afd395f8109802260984ea3414735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*bw7F9r8cP6cB8o2fX7GXVQ.png"/></div></figure><p id="d5b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">系列到数据帧</strong> — Groupby()函数返回一个系列对象。所以下一步是将这个series对象转换成一个226行的新数据帧。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/2c9ddb100635c91d94e015eabb95b1f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*X6F0YAYKnaANTcInfB_4kw.png"/></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/e84fc86b023ed8cb4ba3f64c0f048eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VEzTNlVU09ecPD2hUgx2CQ.png"/></div></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/2b3957b1759e4238e0d313dae9fa7ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*klUvWDxer4XQlL8otoOL2Q.png"/></div></figure><p id="3efa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">死亡数据框现已准备好与病例数据框合并。</strong></p><h1 id="5cb0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">合并病例和死亡数据框</strong></h1><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/87a192e6436f9b28e72325c7c8a7225e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TDbDFVTRtlHP0wB5UAal-w.png"/></div></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/3599ef292f0962dee7b65702e0be45ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ss9XGsXlacj0buA0whhNuA.png"/></div></div></figure><h1 id="9c0e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">下面是我们使用pd.merge()时实际发生的情况</strong></h1><p id="d596" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">为了解释这个过程，我创建了两个微型数据框架，分别命名为病例和死亡。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/cb912fdebd4432487fe6421c25b6b1d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*faqaF8nP3zCaSTn7WulJvA.png"/></div></div></figure><p id="e7d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">病例数据框中有3个日期条目(十月、九月、六月)。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/141b30b6c361e695734c6ea826ef018e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0SBo50nSN5ALiFaekltjEg.png"/></div></div></figure><p id="1244" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的死亡数据框中有3个日期条目。(10月、9月、8月)</p><h1 id="01a4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">内部联接时合并</h1><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/b73596de8a3f8438bb555ad4431da88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cNmsMgKpjeXp0cVWunEzag.png"/></div></div></figure><p id="1809" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">观察:内联接输出有十月，九月。这两个日期都出现在病例和死亡数据框中。</p><h1 id="2f25" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">外部连接时合并</h1><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/87d1c96afed808ad272f45a5d6380019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mqnxgBfQWdFKVB8bhjYJFQ.png"/></div></div></figure><p id="60d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">观察:外连接输出有十月、九月、六月和八月。所有数据均来自病例和死亡数据框。</p><h1 id="6122" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">在左连接时合并</h1><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/a2b3352ce696ba2e0c5decf269c4b24e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RzbVTDODR7L7cs7b9MOTw.png"/></div></div></figure><p id="10da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">观察:左连接输出有十月，九月，六月。所有病例的日期都存在，并且只取死亡病例的匹配日期。</p><h1 id="aed8" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">右连接时合并</h1><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/9669747cf30c7ee22932f9e6dd3a69e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQZw6e9hR6IXZHJM8xuqrg.png"/></div></div></figure><p id="47a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">观察:右连接输出有十月、九月、八月。所有死亡日期都存在，并且只取病例中匹配的日期。</p><p id="cf0e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总结本文，关键要点是，如果您必须在一个公共列上合并两个数据框，并且公共列有重复项，一种方法是将一个数据框的公共列中的所有值组合在一起。这将删除所有的重复。新的分组对象可以转换回新的数据框。这将使合并更容易，并且在执行合并时具有准确的值。希望这篇文章是有帮助的。谢谢你。</p></div></div>    
</body>
</html>