<html>
<head>
<title>Logistic Regression Demystified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归去神秘化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-demystified-215def00b37d?source=collection_archive---------25-----------------------#2020-05-20">https://medium.com/analytics-vidhya/logistic-regression-demystified-215def00b37d?source=collection_archive---------25-----------------------#2020-05-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dc21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我们将看到如何应用和如何工作的<strong class="ih hj"><em class="jd"/></strong><em class="jd"/><strong class="ih hj"><em class="jd">回归算法。</em>T9】</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/f2e82445dda31603952ff3e4435b1834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JSFSos_rTX6e4gfr.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">链接<a class="ae ju" href="https://miro.medium.com/max/1600/1*PQ8tdohapfm-YHlrRIRuOA.gif" rel="noopener">此处</a></figcaption></figure><p id="4ae4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们讨论分类问题时，逻辑回归是一个非常著名的算法。我们可以很容易地实现<strong class="ih hj"> <em class="jd">逻辑回归</em> </strong>，只用几行代码就可以得到非常满意的结果。</p><h1 id="7399" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">但是这到底是怎么回事呢？</strong></h1><p id="7f23" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">逻辑回归</em> </strong>与线性回归非常相似，它们的区别在于函数。在<strong class="ih hj"> <em class="jd">线性回归</em> </strong>中我们有一个可以返回负数的函数，在<strong class="ih hj"> <em class="jd">逻辑回归</em> </strong>中，我们有一个只返回正数的函数。</p><p id="308e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在下图中看到更多细节:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ky"><img src="../Images/398289909c3eaaea01e1f1f769818b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GlBQV72LiPqCaLHo.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">链接<a class="ae ju" href="https://miro.medium.com/max/4640/1*dm6ZaX5fuSmuVvM4Ds-vcg.jpeg" rel="noopener">此处</a></figcaption></figure><p id="ec84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们使用<strong class="ih hj"> <em class="jd">二进制分类</em> </strong>(只有2个类)时，这是非常积极的，我们使用<strong class="ih hj"> <em class="jd">二进制逻辑分类</em> </strong>。</p><p id="1520" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae ju" href="https://github.com/gabrielmayers/kaggle_titanic-logistic_regression" rel="noopener ugc nofollow" target="_blank">这个库</a>中，你可以看到我是如何应用逻辑回归来解决<strong class="ih hj"> <em class="jd">【卡格尔挑战泰坦尼克号】、</em> </strong>的，这里我们只有2个类！</p><p id="4392" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是我们也可以将<strong class="ih hj"> <em class="jd">逻辑回归</em> </strong>应用到我们拥有2个以上类的问题中，这被称为:<strong class="ih hj"> <em class="jd">多项逻辑回归</em> </strong>，我们将在下一个例子中深入探讨。</p><p id="1754" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设你想在著名的<a class="ae ju" href="https://archive.ics.uci.edu/ml/datasets/iris" rel="noopener ugc nofollow" target="_blank"> Iris数据集</a>中使用<strong class="ih hj"> <em class="jd">逻辑回归</em> </strong>，对花卉种类进行分类…</p><p id="1407" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们做机器学习吧，宝贝！</p><h1 id="d822" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">看一看数据集</h1><p id="abbc" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">我们可以使用下面的代码行，使用<em class="jd"> Seaborn </em>将数据集加载到我们的笔记本中:</p><pre class="jf jg jh ji fd kz la lb lc aw ld bi"><span id="f14c" class="le jw hi la b fi lf lg l lh li"># Load dataset:</span><span id="d809" class="le jw hi la b fi lj lg l lh li">data = sns.load_dataset(‘iris’)</span></pre><p id="5843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我们可以看看数据…</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lk"><img src="../Images/04911eb9b4871c2d65b4b7077ddf23ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDySWqAKLpggbXLTlVq8eg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">我们的数据集</figcaption></figure><p id="cbae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只是做一个补遗，对于分类问题，神经网络可以比任何算法表现更好，你可以看看我在<a class="ae ju" rel="noopener" href="/analytics-vidhya/solving-titanic-machine-learning-from-disaster-using-neural-networks-and-tensorflow-2abade61994a">这个帖子</a>中如何应用<strong class="ih hj"> <em class="jd">神经网络</em> </strong>来解决<strong class="ih hj"> <em class="jd">《卡格尔挑战泰坦尼克号】</em> </strong>。</p><p id="9adf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是在这个特定的问题中，我们的数据集中有一个改变所有场景的特征。</p><p id="9af1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你在上面的图像中看到的，我们只有150个例子，当我们谈论<strong class="ih hj"> <em class="jd">神经网络时，这是不够的。</em> </strong>其实<em class="jd">，</em>这是为了少！</p><p id="90a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而这也是为什么在这个问题中使用<strong class="ih hj"> <em class="jd">逻辑回归</em> </strong>比较好。</p><p id="9fa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里要观察的另一件重要事情是关于我们的数据。我们不需要改变或格式化任何东西，我们的数据已经准备好输入到我们的模型中，这是非常罕见的！</p><p id="df20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是回来后，我们需要将我们的数据分成训练和测试。对于这个例子，我想使用我的数据集的30% 进行测试，70% 进行训练。</p><p id="e58a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用下面的代码来拆分:</p><pre class="jf jg jh ji fd kz la lb lc aw ld bi"><span id="652b" class="le jw hi la b fi lf lg l lh li">X = data.drop(columns=’species’)<br/>y = data[‘species’]</span><span id="5e6e" class="le jw hi la b fi lj lg l lh li"># Splitting: <br/>from sklearn.model_selection import train_test_split</span><span id="0be4" class="le jw hi la b fi lj lg l lh li">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)</span></pre><p id="69dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">但是我们只有几个数据… </em> </strong></p><p id="377e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我知道，但是对于我们的<strong class="ih hj">逻辑回归模型</strong>，这就足够了！</p><p id="4690" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经将数据集分为训练和测试两部分</p><p id="62f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们建立我们的模型！</p><h1 id="f3b7" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">构建我们的模型</h1><p id="30e0" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">我们想使用<a class="ae ju" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> scikit-learn </strong> </a>来构建我们的模型，但是你可以选择对你更好的。</p><p id="676f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了构建我们的<strong class="ih hj"> <em class="jd">逻辑回归模型</em> </strong>，我们可以从<a class="ae ju" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">scikit-learn</strong></a><strong class="ih hj"/>中导入Logistic Regression类，并将其实例化为一个变量，如下面的代码所示:</p><pre class="jf jg jh ji fd kz la lb lc aw ld bi"><span id="df6e" class="le jw hi la b fi lf lg l lh li"># Building the model:</span><span id="3667" class="le jw hi la b fi lj lg l lh li">from sklearn.linear_model import LogisticRegression</span><span id="a8a5" class="le jw hi la b fi lj lg l lh li">model = LogisticRegression()</span></pre><p id="1901" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们想要使用<em class="jd"> fit() </em>方法训练我们的模型，将我们的训练X和Y作为参数传递，其中:</p><ul class=""><li id="a271" class="ll lm hi ih b ii ij im in iq ln iu lo iy lp jc lq lr ls lt bi translated"><strong class="ih hj"> X: </strong>为输入，如<em class="jd">萼片长度</em>和<em class="jd">花瓣长度</em>。</li><li id="6667" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated"><strong class="ih hj"> Y: </strong>为输出，可以是:<em class="jd"> Setosa </em>，<em class="jd"> Virginica </em>或<em class="jd"> Versicolour </em>。</li></ul><p id="ed87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练我们的模型后，我们可以在测试数据集中进行预测。为此，我们使用<em class="jd"> predict() </em>方法将我们的X_test(测试数据集的输入)作为参数传递，如下面的代码所示:</p><pre class="jf jg jh ji fd kz la lb lc aw ld bi"><span id="a06d" class="le jw hi la b fi lf lg l lh li">pred = model.predict(X_test)</span></pre><h1 id="9162" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">可视化我们模型的度量</h1><p id="ccd7" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">现在，我们已经有了模型的预测，我们可以看看他是否得到了正确的结果。</p><p id="1cd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们可以使用下面的代码使用<a class="ae ju" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">scikit-learn</strong></a><strong class="ih hj"/>的classification_report:</p><pre class="jf jg jh ji fd kz la lb lc aw ld bi"><span id="7435" class="le jw hi la b fi lf lg l lh li">from sklearn.metrics import classification_report, confusion_matrix</span><span id="5158" class="le jw hi la b fi lj lg l lh li">print(classification_report(y_test, pred))</span></pre><p id="7856" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行代码后，我们可以看到模型在我们数据集中表现得非常好，在我们的两个类中达到了100%的准确率，在另一个类中达到了90%。看一下我们的混淆矩阵，我们可以更好地将预测与正确答案进行比较:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/07927b941920903b5c88391a8114c637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kDMZllgSIzy0qPUVpQ0K9w.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">我们模型的结果</figcaption></figure><p id="032f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们有一个训练有素的模特，而且表演得太好了！</p><p id="d9f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在<a class="ae ju" href="https://github.com/gabrielmayers/flowers_classifying-logistic_regression" rel="noopener ugc nofollow" target="_blank">这里</a>访问这篇文章的资源库。</p><p id="1b59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前，这就是全部！</p><p id="e447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下次见！</p><p id="f46f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">我的社交媒体:</em> </strong></p><p id="3083" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">领英:</em></strong><em class="jd"/><a class="ae ju" href="https://www.linkedin.com/in/gabriel-mayer-779b5a162/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/gabriel-mayer-779b5a162/</a></p><p id="c8dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">GitHub:</strong><a class="ae ju" href="https://github.com/gabrielmayers" rel="noopener ugc nofollow" target="_blank">https://github.com/gabrielmayers</a></p><p id="7605" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">Instagram:</em></strong><a class="ae ju" href="https://www.instagram.com/gabrielmayerl/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/gabrielmayerl/</a></p></div></div>    
</body>
</html>