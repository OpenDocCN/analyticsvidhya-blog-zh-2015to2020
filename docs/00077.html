<html>
<head>
<title>Python Implementation of Andrew Ng’s Machine Learning Course (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">吴恩达机器学习课程的Python实现(上)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-implementation-of-andrew-ngs-machine-learning-course-part-1-6b8dd1c73d80?source=collection_archive---------1-----------------------#2018-08-31">https://medium.com/analytics-vidhya/python-implementation-of-andrew-ngs-machine-learning-course-part-1-6b8dd1c73d80?source=collection_archive---------1-----------------------#2018-08-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/94ebbf40d69a4802596d583eed4026ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FGGge_GilZ_KJYaoryaxkA.png"/></div></div></figure><p id="00f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">几个月前，我有机会完成了<a class="jo jp ge" href="https://medium.com/u/592ce2a67248?source=post_page-----6b8dd1c73d80--------------------------------" rel="noopener" target="_blank">吴恩达</a>在Coursera上教授的机器学习MOOC。对于任何想进入人工智能/人工智能世界的人来说，这是一个非常好的介绍。但是问题是…这门课是用八度音程授课的。</p><p id="8168" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我一直在想，如果这门课是用Python写的，会有多神奇。我最终决定重新上这门课，但只有这一次，我将完成Python的编程作业。</p><p id="d0a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这一系列的博客文章中，我计划写一下课程中使用的Python版本的编程练习。我这样做有几个原因:</p><ol class=""><li id="bbb9" class="jq jr hi is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated">它将帮助任何想要Python版本课程的人(也包括我)</li><li id="97a8" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">它有望让那些愿意学习他们已经熟悉的算法的Pythonic实现的用户受益</li></ol><blockquote class="ke kf kg"><p id="545e" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated"><strong class="is hj">先决条件</strong></p><p id="cc7d" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated">强烈建议您首先观看<a class="ae kl" href="https://www.coursera.org/learn/machine-learning/home/week/1" rel="noopener ugc nofollow" target="_blank">第1周</a>视频讲座。</p><p id="a6bf" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated">应该对Python生态系统有基本的了解。</p></blockquote><p id="70b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这一节，我们将看看最简单的机器学习算法。</p><h2 id="05de" class="km kn hi bd ko kp kq kr ks kt ku kv kw jb kx ky kz jf la lb lc jj ld le lf lg bi translated"><strong class="ak">一元线性回归</strong></h2><blockquote class="ke kf kg"><p id="b1fe" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated">首先是问题陈述的一些背景。</p><p id="a96e" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated">这里我们将实现一个变量的线性回归来预测一辆食品车的利润。假设你是一家特许经营餐厅的首席执行官，正在考虑在不同的城市开设新的分店。该连锁店已经在各个城市有了卡车，而且你有了这些城市的利润和人口数据。</p></blockquote><p id="c3d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">文件ex1data1.txt(可在第2周的作业材料中找到)包含我们线性回归练习的数据集。第一列是一个城市的人口，第二列是该城市一辆快餐车的利润。利润为负值表示亏损。</p><p id="baaf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，与执行任何机器学习任务一样，我们需要导入某些库。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="e5da" class="km kn hi lm b fi lq lr l ls lt">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span></pre><p id="7875" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">读取并绘制数据</strong></p><p id="df61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在开始任何任务之前，通过可视化来理解数据通常是有用的。对于此数据集，您可以使用散点图来可视化数据，因为它只有两个属性可以绘制(利润和人口)。</p><p id="b4c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kh">(现实生活中你会遇到的很多其他问题都是多维的，无法在二维图上绘制出来。为了创造多维的情节，你必须创造性地运用各种美学，如颜色、形状、深度等。</em></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="60d5" class="km kn hi lm b fi lq lr l ls lt">data = pd.read_csv('ex1data1.txt', header = None) #read from dataset<br/>X = data.iloc[:,0] # read first column<br/>y = data.iloc[:,1] # read second column<br/>m = len(y) # number of training example<br/>data.head() # view first few rows of the data</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/42881f402fda1705a5b82e1535d4d117.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*ExPQpRyYFAA1zuRlI2Itrg.png"/></div></figure><p id="b633" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们使用pandas <code class="du lv lw lx lm b">read_csv</code>函数来读取逗号分隔的值。此外，我们使用了<code class="du lv lw lx lm b">head</code>函数来查看数据的前几行。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="fbd1" class="km kn hi lm b fi lq lr l ls lt">plt.scatter(X, y)<br/>plt.xlabel('Population of City in 10,000s')<br/>plt.ylabel('Profit in $10,000s')<br/>plt.show()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/3c1729ae6098f9257984b42c0ea26258.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*kKLhUgvOHNfCixlm0pK4yg.png"/></div></figure><p id="642b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">增加截距项</strong></p><p id="cad1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在接下来的几行中，我们向数据中添加了另一个维度来容纳截距项(这样做的原因在视频中有解释)。我们还初始化初始参数<code class="du lv lw lx lm b">theta</code>到<code class="du lv lw lx lm b">0</code>和学习率<code class="du lv lw lx lm b">alpha</code>到<code class="du lv lw lx lm b">0.01</code>。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="8cb8" class="km kn hi lm b fi lq lr l ls lt">X = X[:,np.newaxis]<br/>y = y[:,np.newaxis]<br/>theta = np.zeros([2,1])<br/>iterations = 1500<br/>alpha = 0.01<br/>ones = np.ones((m,1))<br/>X = np.hstack((ones, X)) # adding the intercept term</span></pre><p id="a9b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">关于np.newaxis的注释:</strong>当您将数据读入X，y时，您会发现X，y是秩1数组。秩1的数组将具有(m，1)的形状，而秩2的数组将具有(m，1)的形状。当操作数组时，最好将秩1的数组转换为秩2的数组，因为秩1的数组通常会产生意想不到的结果。<br/>为了将秩1转换为秩2，我们使用了<code class="du lv lw lx lm b">someArray[:,np.newaxis]</code>。</p><p id="9af8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来我们将计算成本和梯度下降。吴恩达在视频讲座中很好地解释了如何做到这一点。我只是为吴恩达在演讲中使用的伪代码提供Python代码。</p><p id="3d5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">计算成本</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="8aa8" class="km kn hi lm b fi lq lr l ls lt">def computeCost(X, y, theta):<br/>    temp = np.dot(X, theta) - y<br/>    return np.sum(np.power(temp, 2)) / (2*m)</span><span id="95e1" class="km kn hi lm b fi lz lr l ls lt">J = computeCost(X, y, theta)<br/>print(J)</span></pre><p id="203e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该会看到<code class="du lv lw lx lm b">32.07</code>的成本。</p><p id="0eef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用梯度下降法寻找最佳参数</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="28d7" class="km kn hi lm b fi lq lr l ls lt">def gradientDescent(X, y, theta, alpha, iterations):<br/>    for _ in range(iterations):<br/>        temp = np.dot(X, theta) - y<br/>        temp = np.dot(X.T, temp)<br/>        theta = theta - (alpha/m) * temp<br/>    return theta</span><span id="d47a" class="km kn hi lm b fi lz lr l ls lt">theta = gradientDescent(X, y, theta, alpha, iterations)<br/>print(theta)</span></pre><p id="2d6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">预期的<code class="du lv lw lx lm b">theta</code>值<code class="du lv lw lx lm b">[-3.6303, 1.1664]</code></p><p id="a381" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在有了<code class="du lv lw lx lm b">theta</code>的优化值。在上述成本函数中使用该值。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="0c1a" class="km kn hi lm b fi lq lr l ls lt">J = computeCost(X, y, theta)<br/>print(J)</span></pre><p id="94f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它应该给你一个值<code class="du lv lw lx lm b">4.483 </code>，比<code class="du lv lw lx lm b">32.07</code>好得多</p><p id="1e0f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">显示最佳拟合线的图</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="d081" class="km kn hi lm b fi lq lr l ls lt">plt.scatter(X[:,1], y)<br/>plt.xlabel('Population of City in 10,000s')<br/>plt.ylabel('Profit in $10,000s')<br/>plt.plot(X[:,1], np.dot(X, theta))<br/>plt.show()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/b0779ef86a9daf675b973c35093a6c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*Mf0wFVzEgyBJz2_ggtLD0A.png"/></div></figure><p id="4b3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们将线性回归的概念扩展到多个独立变量。</p><p id="142c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">多元线性回归</strong></p><p id="1c86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本节中，我们将实现多个变量的线性回归(也称为多元线性回归)。</p><blockquote class="ke kf kg"><p id="7608" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated">问题背景:</p><p id="c51f" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated">假设你正在出售你的房子，你想知道一个好的市场价格是多少。一种方法是首先收集最近出售的房屋信息，并制作一个房价模型。你的工作是根据其他变量预测房价。</p></blockquote><p id="8b91" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">文件ex1data2.txt((可在第2周的作业材料中找到))包含俄勒冈州波特兰市的一组房屋价格训练集。第一栏是房子的大小(平方英尺)，第二栏是卧室的数量，第三栏是房子的价格。</p><p id="5bca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您已经拥有了我们在上一节中构建的必要基础设施，这些基础设施也可以很容易地应用于本节。这里我们将只使用我们在上一节中建立的方程。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="8a63" class="km kn hi lm b fi lq lr l ls lt">import numpy as np<br/>import pandas as pd</span><span id="e073" class="km kn hi lm b fi lz lr l ls lt">data = pd.read_csv('ex1data2.txt', sep = ',', header = None)<br/>X = data.iloc[:,0:2] # read first two columns into X<br/>y = data.iloc[:,2] # read the third column into y<br/>m = len(y) # no. of training samples<br/>data.head()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/6aafa2f37fe7b08382f92b0c43378787.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/1*xbEfhflgwgBQhsV2Zt0z4Q.png"/></div></div></figure><p id="c764" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面可以看出，我们在这里处理的独立变量不止一个(但是你在前面章节学到的概念在这里也适用)。</p><p id="f89f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">特征归一化</strong></p><p id="605a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过查看这些值，注意到房子的大小大约是卧室数量的1000倍。当要素相差数量级时，首先执行要素缩放可以使梯度下降收敛得更快。</p><p id="52f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的任务是:</p><ul class=""><li id="6053" class="jq jr hi is b it iu ix iy jb js jf jt jj ju jn mb jw jx jy bi translated">从数据集中减去每个要素的平均值。</li><li id="31dc" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn mb jw jx jy bi translated">减去平均值后，将特征值除以各自的“标准偏差”</li></ul><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="947d" class="km kn hi lm b fi lq lr l ls lt">X = (X - np.mean(X))/np.std(X)</span></pre><p id="da72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">添加截距项并初始化参数</strong></p><p id="0bb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(下面的代码类似于我们在上一节中所做的)</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="8079" class="km kn hi lm b fi lq lr l ls lt">ones = np.ones((m,1))<br/>X = np.hstack((ones, X))<br/>alpha = 0.01<br/>num_iters = 400<br/>theta = np.zeros((3,1))<br/>y = y[:,np.newaxis]</span></pre><p id="623f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">计算成本</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="bbc3" class="km kn hi lm b fi lq lr l ls lt">def computeCostMulti(X, y, theta):<br/>    temp = np.dot(X, theta) - y<br/>    return np.sum(np.power(temp, 2)) / (2*m)<br/>J = computeCostMulti(X, y, theta)<br/>print(J)</span></pre><p id="bf16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你应该会看到<code class="du lv lw lx lm b">65591548106.45744</code>的成本。</p><p id="1070" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用梯度下降寻找最佳参数</strong></p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="187b" class="km kn hi lm b fi lq lr l ls lt">def gradientDescentMulti(X, y, theta, alpha, iterations):<br/>    m = len(y)<br/>    for _ in range(iterations):<br/>        temp = np.dot(X, theta) - y<br/>        temp = np.dot(X.T, temp)<br/>        theta = theta - (alpha/m) * temp<br/>    return theta<br/>theta = gradientDescentMulti(X, y, theta, alpha, num_iters)<br/>print(theta)</span></pre><p id="4a0f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您的最佳参数将是<code class="du lv lw lx lm b">[[334302.06399328],[ 99411.44947359], [3267.01285407]]</code></p><p id="cdc9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在有了<code class="du lv lw lx lm b">theta</code>的优化值。在上述成本函数中使用该值。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="62a6" class="km kn hi lm b fi lq lr l ls lt">J = computeCostMulti(X, y, theta)<br/>print(J)</span></pre><p id="4802" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这应该给你一个<code class="du lv lw lx lm b">2105448288.6292474</code>的值，比<code class="du lv lw lx lm b">65591548106.45744</code>好得多</p><p id="62d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你现在已经学会了如何用一个或多个独立变量进行线性回归。干得好！</p><p id="274c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个帖子到此为止。如果你喜欢我的作品，请给我一个(或几个)掌声。</p><p id="cddc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在这里找到本系列的其他文章</p><ul class=""><li id="54d2" class="jq jr hi is b it iu ix iy jb js jf jt jj ju jn mb jw jx jy bi translated"><a class="ae kl" rel="noopener" href="/analytics-vidhya/python-implementation-of-andrew-ngs-machine-learning-course-part-2-1-1a666f049ad6">逻辑回归</a>(第2.1部分)</li><li id="494e" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn mb jw jx jy bi translated"><a class="ae kl" rel="noopener" href="/analytics-vidhya/python-implementation-of-andrew-ngs-machine-learning-course-part-2-2-dceff1a12a12">正则化逻辑回归</a>(第2.2部分)</li></ul></div></div>    
</body>
</html>