<html>
<head>
<title>Your First Python Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的第一个Python机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/your-first-python-machine-learning-model-e09868458204?source=collection_archive---------38-----------------------#2020-05-13">https://medium.com/analytics-vidhya/your-first-python-machine-learning-model-e09868458204?source=collection_archive---------38-----------------------#2020-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><blockquote class="im in io"><p id="20fb" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我为一个项目创建我的第一个机器学习模型时，很难找到清晰的代码和解释。因此，我将向您展示一个简单的图像分类模型，您可以尝试并开始探索机器学习可以为您提供什么。</p></blockquote><p id="06ce" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们将使用Python作为编程语言，因为它有大量与数据科学相关的库和文档。为了让我们自己更容易，我们使用TensorFlow，这是大多数机器学习的一个强大而简单的工具。对于一些简单的数字运算，我们需要Numpy。为了制作一些漂亮的图形，我们使用Matplotlib。</p><h2 id="c9ba" class="jr js hi bd jt ju jv jw jx jy jz ka kb jo kc kd ke jp kf kg kh jq ki kj kk kl bi translated"><strong class="ak">让我们开始编码</strong></h2><p id="76a8" class="pw-post-body-paragraph ip iq hi is b it km iv iw ix kn iz ja jo ko jd je jp kp jh ji jq kq jl jm jn hb bi translated">我使用Python 3和TensorFlow 2.2。两者目前都是最新的。你可以从其他作者那里找到关于如何<em class="ir"> pip安装</em>库的在线教程。我建议使用虚拟环境。</p><p id="d5ad" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们的程序需要做的第一件事是导入我们使用的库。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="489e" class="jr js hi kw b fi la lb l lc ld">import tensorflow as tf<br/>from tensorflow import keras</span><span id="6fce" class="jr js hi kw b fi le lb l lc ld">import numpy as np<br/>import matplotlib.pyplot as plt</span></pre><p id="180f" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">然后，下载我们需要的数据来训练我们的图像分类模型。将来你可能会想使用你自己的数据，但现在我们将坚持使用一个容易访问的数据集:时尚MNIST。这个数据集由10种衣服的60，000个标记的训练图像和10，000个标记的测试图像组成。我们可以使用下面一行代码下载这些数据。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="fcf3" class="jr js hi kw b fi la lb l lc ld">(train_images, train_labels), (test_images, test_labels) = keras.datasets.fashion_mnist.load_data()</span></pre><p id="9134" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">在训练和测试我们的模型之前，我们必须对这些数据进行一些更改。首先，我们给不同的标签分配类名。这对于电脑来说是不必要的，但是对于我们自己来说，读真实的名字更容易，比如“衬衫”,而不是像第8类这样的数字。之后，我们需要调整图像像素的值。在标准的<em class="ir">黑&amp;白</em>图像中，像素值在0到255之间，其中0表示全黑，255表示全白。对于我们的<em class="ir">神经网络</em>所做的计算，像素值最好在0和1之间。因此，我们将这些值除以255。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8714" class="jr js hi kw b fi la lb l lc ld">class_names = ['T-shirt/top', 'Trousers', 'Pullover', 'Dress', 'Coat', 'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']</span><span id="36a5" class="jr js hi kw b fi le lb l lc ld">train_images = train_images / 255.0test_images = test_images / 255.0</span></pre><p id="aaa7" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">接下来，我们绘制一些图像来检查它们是否正确导入以及标签是否正确。由于本指南更多的是关于机器学习的，所以我不会详细讨论这个问题。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8aec" class="jr js hi kw b fi la lb l lc ld">plt.figure(figsize=(10,10))<br/>for i in range(25):<br/>   plt.subplot(5,5,i+1)<br/>   plt.xticks([])<br/>   plt.yticks([])<br/>   plt.grid(False)<br/>   plt.imshow(train_images[i], cmap=plt.cm.binary)<br/>   plt.xlabel(class_names[train_labels[i]])<br/>plt.show()</span></pre><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lf"><img src="../Images/c01316bba3152332afa4df0898c143c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyU0ChAWIX1dyN5NzioJIQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">第一个情节应该是这样的</figcaption></figure><p id="28ba" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">有趣的部分现在开始。我们要创造我们的模型。我之前提到过，模型是一个<em class="ir">神经网络</em>。网络的第一层的神经元数量与每幅图像中的像素数量一样多。在这种情况下，图像是28x28像素，我们称之为输入形状。这一层有关键字<em class="ir"> flattten </em>来表示这个二维数组像一维数组一样，这在进行计算之前是必要的。那么这些值必须通过网络的隐藏层。在这种情况下，隐藏层有128个神经元。这些层被称为密集层，因为这一层的每个神经元都与前一层的每个神经元相连。对于像这样的模型，这似乎是显而易见的，但其他一些网络结构使用不同的连接。我们还声明所使用的<em class="ir">激活函数</em>被称为<em class="ir"> relu </em>。在这个阶段，知道这个是最常用于图像分类的就足够了。然后我们创建最后一层。<em class="ir">神经元</em>的数量应与图像类别的数量相对应。在这种情况下，我们有10个不同的类别，所以最后一层有10个<em class="ir">神经元</em>。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="e5b1" class="jr js hi kw b fi la lb l lc ld">model = keras.Sequential([<br/>   keras.layers.Flatten(input_shape=(28, 28)),<br/>   keras.layers.Dense(128, activation='relu'),<br/>   keras.layers.Dense(10)<br/>])</span></pre><p id="8c70" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">完成程序后，你可以四处走动，玩不同的<em class="ir">隐藏层。</em>您可以简单地添加带有<em class="ir">密集层</em>的另一行，或者更改<em class="ir">神经元</em>的数量，或者，如果您变得更高级，可以在TensorFlow文档中查找其他模型结构和激活函数。您应该将过度拟合考虑在内，因为如果模型对您的训练数据太好，一般的识别特征就会丢失，从而使测试数据的结果变得更糟。</p><p id="d34c" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在让我们继续并完成模型。我们必须编译这个模型。我们添加了一个<em class="ir">优化器</em>，它基本上是进行训练的算法。现在，就像<em class="ir">激活功能</em>一样:不用太担心。然后我们加上<em class="ir">损失函数</em>。这个函数测量模型在准确性度量方面做得有多好，这在下一行中陈述。这意味着模型以更高的精度做得更好。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3a3e" class="jr js hi kw b fi la lb l lc ld">model.compile(optimizer='adam',loss=tf.keras.losses.SparseCategorica  lCrossentropy(from_logits=True), metrics=['accuracy'])</span></pre><p id="0708" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">既然我们已经建立了模型，我们可以训练它。因此，使用训练图像和标签。<em class="ir">时期数</em>是您用训练数据训练模型的次数。同样，由于<em class="ir">过度配合</em>，您不应该将此设置得太高。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="e194" class="jr js hi kw b fi la lb l lc ld">model.fit(train_images, train_labels, epochs=10)</span></pre><p id="8eae" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">下一步是打印精度。您可以使用model.evaluate和测试数据来实现这一点。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c67e" class="jr js hi kw b fi la lb l lc ld">test_loss, test_acc = model.evaluate(test_images,  test_labels,<br/>   verbose=2)</span><span id="cb51" class="jr js hi kw b fi le lb l lc ld">print('Test accuracy:', test_acc)</span></pre><p id="4627" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们终于可以展示我们最漂亮的地块了。在第一行中，我们使用<em class="ir"> Softmax。Softmax确保所有的输出加起来等于1，这样我们就可以把输出解释为一个概率。因此，该图将显示模型认为某个图像是某个类别的一部分的概率。</em></p><p id="c1ef" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我将不会去考虑其余的策划，同样的原因，我没有早些时候。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3070" class="jr js hi kw b fi la lb l lc ld">probability_model = tf.keras.Sequential([model,<br/>   tf.keras.layers.Softmax()])</span><span id="01f4" class="jr js hi kw b fi le lb l lc ld">predictions = probability_model.predict(test_images)</span><span id="3919" class="jr js hi kw b fi le lb l lc ld">def plot_image(i, predictions_array, true_label, img):</span><span id="2582" class="jr js hi kw b fi le lb l lc ld">   predictions_array, true_label, img = predictions_array,<br/>   true_label[i], img[i]</span><span id="8b3c" class="jr js hi kw b fi le lb l lc ld">   plt.grid(False)<br/>   plt.xticks([])<br/>   plt.yticks([])</span><span id="28fe" class="jr js hi kw b fi le lb l lc ld">   plt.imshow(img, cmap=plt.cm.binary)<br/>   predicted_label = np.argmax(predictions_array)<br/>   if predicted_label == true_label:<br/>      color = 'blue'<br/>   else:<br/>      color = 'red'</span><span id="a033" class="jr js hi kw b fi le lb l lc ld">plt.xlabel("{} {:2.0f}% ({})".format(class_names[predicted_label],<br/>                              100*np.max(predictions_array),<br/>                              class_names[true_label]),<br/>                              color=color)</span><span id="34c3" class="jr js hi kw b fi le lb l lc ld">def plot_value_array(i, predictions_array, true_label):<br/>   predictions_array, true_label = predictions_array, true_label[i]<br/>   plt.grid(False)<br/>   plt.xticks(range(10))<br/>   plt.yticks([])<br/>   thisplot = plt.bar(range(10), predictions_array, color="#777777")<br/>   plt.ylim([0, 1])<br/>   predicted_label = np.argmax(predictions_array)</span><span id="b739" class="jr js hi kw b fi le lb l lc ld">   thisplot[predicted_label].set_color('red')<br/>   thisplot[true_label].set_color('blue')</span><span id="96f2" class="jr js hi kw b fi le lb l lc ld">num_rows = 5<br/>num_cols = 3<br/>num_images = num_rows*num_cols<br/>plt.figure(figsize=(2*2*num_cols, 2*num_rows))<br/>for i in range(num_images):<br/>   plt.subplot(num_rows, 2*num_cols, 2*i+1)plot_image(i,<br/>     predictions[i], test_labels, test_images)<br/>   plt.subplot(num_rows, 2*num_cols, 2*i+2)<br/>   plot_value_array(i, predictions[i], test_labels)<br/>   plt.tight_layout()<br/>plt.show()</span></pre><figure class="kr ks kt ku fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lr"><img src="../Images/3108b876c79f521eaf1a5edb61ea49e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_NsELX7y6XvaenjaZxwkw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">第二个情节应该是这样的</figcaption></figure><p id="5654" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">正如你在上面的图片中看到的，大多数条形图是蓝色的。这意味着大多数预测是正确的。条形的高度显示了模型对正确答案的确定程度。图片下面是带有确定性的预测，括号里是真实的标签。我们看到在左下角，模型犯了一个错误。模特非常确定图像中有一只凉鞋，但它是一只运动鞋。我们还没有创造出一个完美的模型，但是准确率远远超过90%，我们可以为你的第一个机器学习程序感到自豪。</p><blockquote class="im in io"><p id="a9b2" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">N <!-- -->扩展开来，你可以了解关于<em class="hi">卷积神经网络</em>和更多的一切。他们甚至更强大。要学的东西太多了。</p></blockquote></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="4a13" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在，您已经用不到100行代码创建了第一个机器学习程序。当然，还有很多东西要学，而这仅仅是开始。在实践中，你可能不得不处理所有不同类型的数据和模型，这使得程序更复杂更快。我希望能帮助你激发对机器学习的兴趣。</p><p id="bb51" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">注意:您可以随意使用这段代码。我使用了弗朗索瓦·乔莱对张量流的基本分类的修改版本。</p></div></div>    
</body>
</html>