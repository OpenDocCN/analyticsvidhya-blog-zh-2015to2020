<html>
<head>
<title>Blur or Change Background of Images using Machine Learning with Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Tensorflow使用机器学习模糊或更改图像背景</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/blur-or-change-background-of-images-using-machine-learning-with-tensorflow-f7dab3ddab6f?source=collection_archive---------6-----------------------#2020-06-12">https://medium.com/analytics-vidhya/blur-or-change-background-of-images-using-machine-learning-with-tensorflow-f7dab3ddab6f?source=collection_archive---------6-----------------------#2020-06-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a3a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我们将讨论如何改变图像的背景或者如何模糊图像的背景。我们将使用Unet架构来实现这一目标。</p><p id="985e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有一个名为<a class="ae jd" href="https://cg.cs.tsinghua.edu.cn/dataset/form.html?dataset=ochuman" rel="noopener ugc nofollow" target="_blank"> OCHuman </a>的数据集，它为我们提供了<strong class="ih hj">包围盒、人类姿势和实例遮罩</strong>，但这对我们的任务来说还不够，因为它给出了这样的图像</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/bbfe136af2e624898821582f4371a1a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BWFYnmKpwt4ubOZqxw-ocw.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">应用注记(标注)后的数据集</figcaption></figure><p id="6160" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们只想面具(黑色背景和白色人类)作为标签和图像(原始)作为特征。所以我们创建了我们的海关数据集，里面有这样的图片-</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/643f398dedd24c832b2775d987e3ced5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0yxwOQIhtmoSxFtEcEcDw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">自定义数据集</figcaption></figure><p id="4092" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将这些图像输入到我们创建的Unet模型，该模型应该能够预测类似的面具。</p><blockquote class="jv jw jx"><p id="bab9" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated"><strong class="ih hj">如果你想知道我是如何创建这些图像并训练模型的，请阅读这篇medium文章:</strong><a class="ae jd" rel="noopener" href="/analytics-vidhya/humans-image-segmentation-with-unet-using-tensorflow-keras-fd6cb43b06e5">https://medium . com/analytics-vid hya/humans-image-segmentation-with-unet-using-tensor flow-keras-FD 6 CB 43 b 06 e 5</a></p></blockquote><p id="345c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jy">以上这篇文章将向您详细解释关于</em> <strong class="ih hj"> <em class="jy">数据集、训练、代码和理论。</em>T13】</strong></p><h1 id="e2a1" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">我们使用的Unet的架构-</h1><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="dad7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以看到我们有可训练的参数:1，941，139。您可以增加可训练参数的数量，这可能有助于您获得更好的准确性。</p><h2 id="36b9" class="lc kd hi bd ke ld le lf ki lg lh li km iq lj lk kq iu ll lm ku iy ln lo ky lp bi translated">结果-</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="la lb l"/></div></figure><h2 id="41da" class="lc kd hi bd ke ld le lf ki lg lh li km iq lj lk kq iu ll lm ku iy ln lo ky lp bi translated">预测-</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lq"><img src="../Images/98ed89d66df738a32c75277ef8f1ea0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WDY92GRYC51nICn_bNMJGg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">预言；预测；预告</figcaption></figure><h1 id="b401" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建模糊或更改背景-</h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lr"><img src="../Images/a7031adbbc069c2e825a3981fe59d79b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JVghL6Ec7iP-Ey1EBLRSnA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">模糊图像</figcaption></figure><p id="935a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经创建了模糊图像的脚本，让我们谈谈我们是如何做到这一点的。</p><p id="8569" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，您需要提供原始图像，然后您需要将此图像传递给模型以预测遮罩。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="2345" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们还将原始图像传递给cv2.blur()函数。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="a7d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们总共有三个图像，第一个原始非模糊图像，第二个预测遮罩，和第三个模糊图像。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ls"><img src="../Images/72e260173787e81be144a3b8d2419e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QwQiXziQVZTZhU-bi19fQg.png"/></div></div></figure><p id="eaa8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在为了得到我们的模糊图像，我们需要用模糊图像像素替换黑色像素(来自蒙版),用原始图像替换白色像素(来自蒙版)。合成图像是模糊背景图像。</p><p id="4aef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，当我们替换黑色背景时，你也可以用你自定义的背景图片替换黑色背景。</p><p id="5080" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以下载我们的预训练模型，然后运行“start.py”。</p><p id="b5ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以从我们的<a class="ae jd" href="https://github.com/Dipeshpal/Image-Segmentation-with-Unet-using-Tensorflow-Keras" rel="noopener ugc nofollow" target="_blank"> GitHub </a> repo下载代码和模型。</p><blockquote class="jv jw jx"><p id="744c" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">你可以在我的网站上了解更多:</em></strong><a class="ae jd" href="http://www.dipeshpal.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="hi">www.dipeshpal.com</em></strong></a></p><p id="16d1" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">你可以了解我更多:</em></strong><a class="ae jd" href="http://www.dipeshpal.in/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="hi">www . dipeshpal . I</em></strong></a><strong class="ih hj"><em class="hi">n</em></strong></p><p id="e61b" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">你可以在YouTube上看我的科技视频:</em></strong><a class="ae jd" href="https://www.youtube.com/DIPESHPAL17" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="hi">https://www.youtube.com/DIPESHPAL17</em></strong></a></p><p id="8a28" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated"><strong class="ih hj"><em class="hi">Linkedin:</em></strong><a class="ae jd" href="https://www.linkedin.com/in/dipesh-pal-a34952110/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="hi">https://www.linkedin.com/in/dipesh-pal-a34952110/</em></strong></a></p><p id="74f0" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">推特:</em></strong><a class="ae jd" href="https://twitter.com/dipesh_pal17" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="hi">https://twitter.com/dipesh_pal17</em></strong></a></p><p id="fbbe" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated"><strong class="ih hj"><em class="hi">GitHub:</em></strong><a class="ae jd" href="https://github.com/Dipeshpal" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="hi">https://github.com/Dipeshpal</em></strong></a></p></blockquote><ol class=""><li id="ebc4" class="lt lu hi ih b ii ij im in iq lv iu lw iy lx jc ly lz ma mb bi translated"><strong class="ih hj">GitHub Code:</strong><a class="ae jd" href="https://github.com/Dipeshpal/Image-Segmentation-with-Unet-using-Tensorflow-Keras" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Dipeshpal/Image-Segmentation-with-Unet-using-tensor flow-Keras</a>(你可以使用这个模块在你的系统上运行，但我会推荐你使用Google Colab)</li><li id="4f30" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated"><strong class="ih hj">使用Tensorflow使用UNet完成人体分割教程:</strong><a class="ae jd" rel="noopener" href="/analytics-vidhya/humans-image-segmentation-with-unet-using-tensorflow-keras-fd6cb43b06e5">https://medium . com/analytics-vid hya/humans-image-Segmentation-with-UNet-using-tensor flow-keras-FD 6 CB 43 b 06 e 5</a></li></ol></div></div>    
</body>
</html>