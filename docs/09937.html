<html>
<head>
<title>Covid-19 Outbreak Prediction using machine learning in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用python中的机器学习进行新冠肺炎疫情预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/covid-19-outbreak-prediction-using-machine-learning-in-python-d4a267282192?source=collection_archive---------12-----------------------#2020-09-27">https://medium.com/analytics-vidhya/covid-19-outbreak-prediction-using-machine-learning-in-python-d4a267282192?source=collection_archive---------12-----------------------#2020-09-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cb4b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用机器学习预测印度确诊病例数和死亡人数</h2></div><p id="9702" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">众所周知，现在许多IT公司都在使用机器学习，所以我们可以使用机器学习算法来预测新冠肺炎病例和死亡人数会如何增加。</p><p id="1190" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">机器学习算法是基于你的数据集。所以，首先我们要看看数据集。您将从我的github资源库中找到并下载数据集，您可以在本文末尾找到我的github资源库。下面是我们数据集的图像:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/47135734829fe4f88adcf390f0781de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WQ1TvYeq6P9KfunWVrR8yw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">新冠肺炎-伊尼达数据集</figcaption></figure><p id="91d9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以表格形式给出的数据集包含9列，或者我们可以说是9个属性。通过分析这个数据集，我们不能预测序列号，也不能预测时间。病例按日期增加，或者我们可以说病例数按天增加。数据集包含从1月1日开始的217天。</p><p id="7475" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们希望预测印度的covid病例将如何增加，因此我们必须选择输入参数，这里我们的输入参数是天数，输出参数是确认病例，这意味着最后一列。在应用任何算法之前，我们必须首先分析病例在印度是如何增加的。为此，我们使用python库绘制了确诊病例数与天数的关系图。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kj"><img src="../Images/e471a990f189c30872ab2cc0a979ce29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*E9NI3sekYN0SeNytnuXN8Q.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">印度确诊病例</figcaption></figure><p id="3f7e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上图中，x轴代表天数，y轴代表印度确诊病例数。蓝色圆点代表印度covid病例的增长情况。红线代表我们如何拟合模型(最佳拟合线)。我们可以看到病例呈指数增长。这里我们完成了第一步。</p><p id="2890" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第二步是制作模型。正如我们上面讨论的那样，案例以指数方式增长，因此我们可以使用哪种算法来进行预测。让我们想想。线性回归？不，因为它不是线性增长的。多项式回归？是的，没错。因为图形表示以多项式方式增加情况。</p><p id="e8d5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">执行多项式回归与线性回归略有不同。首先，我们必须将转换为多项式特征，因为我们的输入是天数，我们希望使用多项式回归对案例进行预测。在多项式回归中，您必须首先将输入转换为多项式特征。然后建立线性回归模型，将输入参数和输出参数拟合到线性模型中。下面是显示如何执行多项式回归的代码片段:</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="3dc9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在数据集中，我们可以看到各州确诊病例，但我们希望预测印度的确诊病例，这意味着我们必须添加每天的所有病例。有可能在某一天，许多州都出现了病例，我们必须添加所有病例，为此，我们使用字典来查看当天的病例。为此，我们遍历每一行数据集。这里我们将“日期”作为一个键，并将案例确认为字典中的一个值。通过迭代每一行，如果日期已经存在于字典中，那么我们添加值，如果日期不作为键存在，那么我们产生键和值对。</p><p id="5ada" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要将输入数据从线性转换为多项式，我们必须从sklearn库中导入多项式Features()函数。通过分析上面的图表，我们将次数设置为4，因为在调用fit_transform()函数转换为多项式特征后，它最适合这种情况。现在是时候建立我们的模型了，所以这里我们的模型是线性回归。请记住，我们的输入数据具有多项式特征，当我们将输入和输出参数拟合到模型时，它会执行多项式回归。</p><p id="2364" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，是时候预测病例数了，在给定的数据集中，天数是217天，我们希望预测220天的确诊病例数。在上面的代码中，最后第二行表示如何执行预测。</p><p id="dbe5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是时候预测死亡人数了。首先，我们必须绘制图表，其中x轴代表天数，y轴代表死亡人数。参见下图:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es km"><img src="../Images/1b2869dbee521c549a33a8b90ec426b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*QWvozg7pmOU_PpidES7bgA.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">印度死亡人数</figcaption></figure><p id="8999" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过分析上面的图表，我们可以假设它与我们之前看到的确诊病例非常相似。因此，这里我们不需要再次拟合参数，我们只需更改输出参数来拟合模型。参见下面预测印度220天内死亡人数的代码片段:</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="c7cb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">到目前为止，我们知道如何预测印度的病例数和死亡数，但通过使用这个数据集，我们也可以预测各邦的确诊病例和死亡数。</p><p id="5fbd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了执行状态预测，我们再次使用字典，就像我们在上面的代码中使用的一样，但是这里我们添加了一个额外的条件。假设您想对古吉拉特邦执行这个算法。所以你的额外条件是，如果你给定的状态与数据集的状态相匹配，那么把它添加到字典中，否则转到下一行。参见下面的代码:</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="559a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们做出预测或建立模型之前，是时候分析数据了。在该图中，x轴代表天数，y轴代表古吉拉特邦确诊病例数。见下图:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kn"><img src="../Images/4529606645cb70fa57669616c49986c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y8qixPChVzLkWqmrdaCXog.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">确认古吉拉特邦的covid病例</figcaption></figure><p id="00e3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">蓝色代表古吉拉特邦covid案例的增长，红线代表我们如何拟合模型(这是我们的最佳拟合线)。这与上面的图表非常不同，这意味着我们必须改变度数，如果我们不改变度数，那么它可能会给出错误或不准确的预测。</p><p id="aec7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们将输入参数转换为3次。然后我们用输入参数为3次，输出参数为古吉拉特邦的实证数据来拟合模型，然后再次进行预测。参见下面的代码:</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="d321" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还有最后一项任务，就是预测古吉拉特邦的死亡人数。现在你已经非常熟悉了，为此我们必须对图表进行分析，其中x轴代表天数，y轴代表古吉拉特邦的死亡人数。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es km"><img src="../Images/2b6d38b7255e2eaeb16215e3ddd6b1f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*D8Phz1Xh3OD_lMfA6rC6YA.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">古吉拉特邦的死亡人数</figcaption></figure><p id="1f04" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的图表与我们之前看到的所有图表非常不同，通过分析该图表，我们得出结论，该图表不是指数增长的。最后，125到150天的均值图变成线性，0到125天的均值图与线性图相似，因此我们可以假设我们必须执行线性回归来预测古吉拉特邦的死亡人数。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="1b16" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，我们利用python中的机器学习，成功完成了covid疫情预测。下面你可以找到github仓库，在那里你可以找到完整的代码，也可以下载或查看数据集。</p><h1 id="2542" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">Github资源库:</h1><div class="lg lh ez fb li lj"><a href="https://github.com/apurva-ajmera/ML-Practicles/blob/master/covid-outbreak-prediction" rel="noopener  ugc nofollow" target="_blank"><div class="lk ab dw"><div class="ll ab lm cl cj ln"><h2 class="bd hj fi z dy lo ea eb lp ed ef hh bi translated">apurva-ajmera/ML-Practicles</h2><div class="lq l"><h3 class="bd b fi z dy lo ea eb lp ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="lr l"><p class="bd b fp z dy lo ea eb lp ed ef dx translated">github.com</p></div></div><div class="ls l"><div class="lt l lu lv lw ls lx kd lj"/></div></div></a></div><p id="dc5e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦你复制这个源代码并粘贴到你的计算机上，你将得到下面的输出(确保你已经按照要求安装了库)。</p><p id="a358" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">源代码输出:</strong></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es ly"><img src="../Images/565ceb7ff48ebfa494b035746d47ddea.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*PSPT2o3VjABx61lzfpBNvw.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">源代码的输出</figcaption></figure><p id="4e30" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随便问什么问题(评论一下)。谢谢你。</p></div></div>    
</body>
</html>