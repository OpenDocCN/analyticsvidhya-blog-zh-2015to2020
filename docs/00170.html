<html>
<head>
<title>Getting Started with TensorFlow the Easy Way (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以最简单的方式开始使用TensorFlow(第3部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/getting-started-with-tensorflow-the-easy-way-part-3-9714a09af723?source=collection_archive---------0-----------------------#2018-10-30">https://medium.com/analytics-vidhya/getting-started-with-tensorflow-the-easy-way-part-3-9714a09af723?source=collection_archive---------0-----------------------#2018-10-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="044c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">这是关于如何开始使用Tensorflow的系列文章的第3部分——“在TensorFlow中实现回归示例”。</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="ab fe cl jj"><img src="../Images/275a07d42a9fa357cfe6262ea543d906.png" data-original-src="https://miro.medium.com/v2/format:webp/0*miEaj0tWdAIittAF.png"/></div></figure><p id="c12f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性回归通常总是我们学习的第一个算法。好像是进入数据科学的标杆！虽然其他更有效的算法已经占据了优先地位，但线性回归仍然占据着它的一席之地。</p><p id="c8d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性模型被广泛采用的主要原因之一是因为它们容易拟合并且计算量不大。</p><p id="1be2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文(第3部分)中，我们将使用图形、变量和占位符来实现一个线性回归算法，我们在前两篇文章中已经讨论过了。让我们快速回顾一下:</p><ol class=""><li id="cf06" class="jm jn hi ih b ii ij im in iq jo iu jp iy jq jc jr js jt ju bi translated">TensorFlow在计算图形上工作，计算图形是一组节点</li><li id="e928" class="jm jn hi ih b ii jv im jw iq jx iu jy iy jz jc jr js jt ju bi translated">这些节点共同构成了图形的操作流程</li><li id="bc3e" class="jm jn hi ih b ii jv im jw iq jx iu jy iy jz jc jr js jt ju bi translated">每个节点都是具有一些输入的操作，在执行后提供一个输出</li><li id="4453" class="jm jn hi ih b ii jv im jw iq jx iu jy iy jz jc jr js jt ju bi translated">变量用于存储训练模型的权重和偏差，而占位符用于存储数据样本</li></ol><p id="9962" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果以上任何内容听起来陌生，我鼓励您阅读本系列之前的文章:</p><p id="c291" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第1部分:<a class="ae ka" rel="noopener" href="/analytics-vidhya/series-learning-tensorflow-the-easy-way-dcc5be834d74"> Tensorflow安装和设置、语法和图形</a></p><p id="bd3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第2部分:<a class="ae ka" rel="noopener" href="/analytics-vidhya/getting-started-with-tensorflow-the-easy-way-part-2-30e83830bd25">tensor flow中的变量和占位符</a></p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="e6f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于本文的上下文，我们将采用著名的<a class="ae ka" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques" rel="noopener ugc nofollow" target="_blank">房价:高级回归技术</a>数据集。</p><h2 id="6bdc" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">问题陈述:</h2><blockquote class="ld le lf"><p id="155d" class="if ig jd ih b ii ij ik il im in io ip lg ir is it lh iv iw ix li iz ja jb jc hb bi translated">有79个解释变量描述了(几乎)爱荷华州埃姆斯住宅的每个方面，这个比赛挑战你预测每个家庭的最终价格。</p></blockquote><p id="c5c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们从导入数据开始，深入研究编码部分:</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="e84c" class="ki kj hi lk b fi lo lp l lq lr">import pandas as pd<br/>import numpy as np<br/>import matplotlib as plt<br/>%matplotlib inline<br/>import tensorflow as tf<br/>print("Tensorflow version: {}".format(tf.__version__))</span><span id="31b8" class="ki kj hi lk b fi ls lp l lq lr">train = pd.read_csv("train.csv")<br/>train.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/63063d04466944350064d749fb2b076d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lz55kmEp9W1X0iiUI9MSWw.png"/></div></div></figure><p id="bf34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们的目标是预测房子的销售价格，所以最可靠的变量是实际面积。让我们看看<em class="jd"> GrLivArea </em>和<em class="jd"> SalePrice之间的散点图。</em></p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="6445" class="ki kj hi lk b fi lo lp l lq lr">train.plot(kind='scatter', x= 'GrLivArea',y ='SalePrice', color='red', figsize=(15,5))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es ly"><img src="../Images/7285552a8444388377fc298372a8625b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lLEQ8wOmBNOGs248vV7Rbg.png"/></div></div></figure><p id="8d1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以清楚地看到这两者之间的线性关系。现在，让我们写下线性模型方程；<code class="du lz ma mb lk b">y = mx + b</code>，其中<code class="du lz ma mb lk b">m</code>为斜率，<code class="du lz ma mb lk b">b</code>为截距。</p><p id="f9a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们试图使用<code class="du lz ma mb lk b">GrLivArea</code>信息来预测<code class="du lz ma mb lk b">y_true</code>。我们的模型方程应该是这样的:</p><p id="058d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lz ma mb lk b">y_true = (m * GrLivArea) + b</code></p><p id="49d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们继续构建模型之前，让我们缩放目标和特征。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="013e" class="ki kj hi lk b fi lo lp l lq lr">from sklearn.preprocessing import MinMaxScaler</span><span id="b3d9" class="ki kj hi lk b fi ls lp l lq lr">scaler = MinMaxScaler()train_df['GrLivArea'] = scaler.fit_transform(train_df['GrLivArea'].reshape(-1, 1))<br/>train_df['SalePrice'] = scaler.fit_transform(train_df['SalePrice'].reshape(-1, 1))</span></pre><p id="5197" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">终于到了在TensorFlow中编码模型的时候了！正如我们之前讨论的，权重<code class="du lz ma mb lk b">m</code>和偏差<code class="du lz ma mb lk b">b</code>存储在变量中。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="82c2" class="ki kj hi lk b fi lo lp l lq lr"># Declaring Variables</span><span id="c6d4" class="ki kj hi lk b fi ls lp l lq lr">m = tf.Variable(0.0)<br/>b = tf.Variable(0.0)</span><span id="2852" class="ki kj hi lk b fi ls lp l lq lr"># Declaring placeholders to place the training data</span><span id="2648" class="ki kj hi lk b fi ls lp l lq lr">xph = tf.placeholder(tf.float32,[batch_size])<br/>yph = tf.placeholder(tf.float32,[batch_size])</span><span id="1d4b" class="ki kj hi lk b fi ls lp l lq lr"># Linear Regression Equation</span><span id="0334" class="ki kj hi lk b fi ls lp l lq lr">y_model = m*xph + b<br/>error = tf.reduce_sum(tf.square(yph-y_model))</span><span id="5943" class="ki kj hi lk b fi ls lp l lq lr"># Gradient Descent Optimizer</span><span id="e463" class="ki kj hi lk b fi ls lp l lq lr">optimizer = tf.train.GradientDescentOptimizer(learning_rate=0.001)<br/>train = optimizer.minimize(error)</span></pre><p id="426d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经对模型的框架进行了编码。让我们讨论一下如何实现<a class="ae ka" href="https://www.analyticsvidhya.com/blog/2017/03/introduction-to-gradient-descent-algorithm-along-its-variants/" rel="noopener ugc nofollow" target="_blank">梯度下降</a>。在TensorFlow中，我们有一个内置的GradientDescentOptimizer，它可以优化我们的误差。在这种情况下，我们减少残差平方和:</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="00b9" class="ki kj hi lk b fi lo lp l lq lr">error = tf.reduce_sum(tf.square(yph-y_model))<br/>train = optimizer.minimize(error)</span></pre><p id="1533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们编码重要的训练部分:</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="bd7d" class="ki kj hi lk b fi lo lp l lq lr"># Important! Always initialize the variables</span><span id="94f4" class="ki kj hi lk b fi ls lp l lq lr">init = tf.global_variables_initializer()</span><span id="7551" class="ki kj hi lk b fi ls lp l lq lr">batch_size = 300</span><span id="9761" class="ki kj hi lk b fi ls lp l lq lr">with tf.Session() as sess:<br/>    sess.run(init)<br/>    epochs = 1000<br/>    for i in range(epochs):<br/>        rand_ind = np.random.randint(len(train_df),size=batch_size)<br/>        feed = {xph:train_df['GrLivArea'][rand_ind].values, <br/>                yph:train_df['SalePrice'][rand_ind].values}<br/>        sess.run(train,feed_dict=feed)<br/>    model_m, model_b = sess.run([m,b])</span></pre><p id="9b2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lz ma mb lk b">batch_size</code>是进入一个时期的数据样本数。参数<code class="du lz ma mb lk b">batch_size</code>和<code class="du lz ma mb lk b">learning_rate</code>可以根据问题而变化。</p><p id="0d79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们打印训练好的重量和偏差:</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="edb9" class="ki kj hi lk b fi lo lp l lq lr">print("The trained weight for m is : {m}".format(m=model_m))<br/>print("The trained weight for b is : {b}".format(b=model_b))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mc"><img src="../Images/77d8be5ca36b2412aeef017a1aa0af6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L7znLht6BJD1iqpAOhZHGg.png"/></div></div></figure><p id="90dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候看看结果了！让我们拟合这些值，看看预测的<code class="du lz ma mb lk b">y_hat</code>是什么样子。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="03ff" class="ki kj hi lk b fi lo lp l lq lr">y_hat = train_df['GrLivArea'] * model_m + model_b</span><span id="2518" class="ki kj hi lk b fi ls lp l lq lr">train_df.plot(kind='scatter',x='GrLivArea',y='SalePrice')<br/>plt.plot(train_df['GrLivArea'],y_hat,'r')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/b390c50d4bfc68a5e0803ecf9298d30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dA5qyWT0-U-p9UADOXb7Ag.png"/></div></div></figure><p id="5d3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">耶！我们使用一个特征的模型在预测<code class="du lz ma mb lk b">SalePrice</code>和<code class="du lz ma mb lk b">GrLivArea</code>之间的线性关系方面做得很好。让我们通过检查RMSE值来确认这一点。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="cab4" class="ki kj hi lk b fi lo lp l lq lr">from sklearn.metrics import mean_squared_error</span><span id="16cd" class="ki kj hi lk b fi ls lp l lq lr">rmse = mean_squared_error(train_df['SalePrice'], y_hat) ** 0.5</span><span id="301a" class="ki kj hi lk b fi ls lp l lq lr">print("Root Mean Sqaured Error:",rmse )</span></pre><p id="b7c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我得到的RMSE值是:</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="b574" class="ki kj hi lk b fi lo lp l lq lr">Out[]: Root Mean Squared Error: 0.07797508645667454</span></pre><p id="7a67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，你的误差可能与我的不同，但它不应该是一个白天和夜晚的差异。</p><p id="d12e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文到此为止！恭喜你用TensorFlow构建了你的第一个模型！</p><p id="cf2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一篇文章中，我们将介绍如何用vanilla TensorFlow编写一个完整的分类模型。如果您对实现上述代码有任何疑问，请随时联系我。和往常一样，请确保您关注<a class="ae ka" href="https://medium.com/analytics-vidhya" rel="noopener"> Analytics Vidhya </a>并关注本系列的后续部分。</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="21ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第1部分:<a class="ae ka" rel="noopener" href="/analytics-vidhya/series-learning-tensorflow-the-easy-way-dcc5be834d74"> Tensorflow安装和设置、语法和图形</a></p><p id="2de5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第2部分:<a class="ae ka" rel="noopener" href="/analytics-vidhya/getting-started-with-tensorflow-the-easy-way-part-2-30e83830bd25">tensor flow中的变量和占位符</a></p><p id="1ce9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第3部分:<a class="ae ka" rel="noopener" href="/@shaz13/getting-started-with-tensorflow-the-easy-way-part-3-9714a09af723">在Tensorflow中实现回归示例</a></p><p id="e70c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">第4部分:在Tensorflow中实现分类(下一步)</em></p></div></div>    
</body>
</html>