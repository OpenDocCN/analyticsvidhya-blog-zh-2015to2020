<html>
<head>
<title>Building a Face Detection Model from Video using Deep Learning (Python Implementation)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习从视频构建人脸检测模型(Python实现)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-face-detection-model-from-video-using-deep-learning-python-implementation-9ac10148608c?source=collection_archive---------0-----------------------#2018-12-10">https://medium.com/analytics-vidhya/building-a-face-detection-model-from-video-using-deep-learning-python-implementation-9ac10148608c?source=collection_archive---------0-----------------------#2018-12-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="4f64" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">“计算机视觉和机器学习已经真正开始起步，但对大多数人来说，计算机在查看图像时看到的东西的整体概念相对模糊。”—迈克·克里奇</p></blockquote><p id="5090" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">近年来，计算机视觉这个奇妙的领域已经自成一派。已经有相当多的应用程序在世界各地广泛使用，而我们才刚刚开始！</p><p id="2fa7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在这个领域，我最喜欢的事情之一是我们的社区接受开源概念的想法。即使是大型科技巨头也愿意与每个人分享新的突破和创新，以使这些技术不再是“富人的事情”。</p><p id="fd50" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">一种这样的技术是人脸检测，它在现实世界的使用案例中提供了大量的潜在应用(如果使用正确且符合道德)。在本文中，我将向您展示如何使用开源工具构建一个强大的人脸检测算法。这里有一个演示，可以让您兴奋起来，并为接下来的工作做好准备:</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="858c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">你准备好了吗？接着读下去！</p><p id="135d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><em class="ik">注:如果你想了解计算机视觉的错综复杂，这门课程——</em><a class="ae jr" href="https://trainings.analyticsvidhya.com/courses/course-v1:AnalyticsVidhya+CVDL101+CVDL101_T1/about" rel="noopener ugc nofollow" target="_blank"><em class="ik">使用深度学习的计算机视觉</em></a><em class="ik">——是完美的起点。</em></p><h1 id="7439" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">目录</h1><ol class=""><li id="0824" class="kq kr hi il b im ks iq kt jh ku ji kv jj kw jg kx ky kz la bi translated">人脸检测的潜在应用</li></ol><p id="f780" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">2.设置系统—硬件/软件要求<br/> 2.1硬件设置<br/> 2.2软件设置</p><p id="83bc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">3.深入Python实现<br/> 3.1简单演练<br/> 3.2人脸检测用例</p><h1 id="7c82" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">人脸检测的应用前景</h1><p id="2784" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">让我举几个很棒的例子，在这些例子中，人脸检测技术得到了广泛的应用。我相信您一定在某个时候遇到过这些用例，但没有意识到在幕后使用了什么技术！</p><p id="f931" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">例如，脸书为上传到平台的每张图片自动生成标签建议，取代了手动图像标签。脸书使用一种简单的人脸检测算法来分析图像中人脸的像素，并与相关用户进行比较。我们将学习如何自己构建一个人脸检测模型，但在我们进入技术细节之前，让我们讨论一些其他的用例。</p><p id="a1c0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们越来越习惯用最新的“面部解锁”功能解锁手机。这是一个非常小的例子，说明人脸检测技术是如何被用来维护个人数据的安全。这同样可以在更大的规模上实现，使相机能够捕捉图像和检测人脸。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="b48f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在广告、医疗保健、银行等领域，还有一些其他不太为人所知的人脸检测应用。大多数公司，甚至在许多会议中，你应该携带身份证才能进入。但是，如果我们能想出一种方法，让你不需要携带任何身份证就可以进入呢？面部检测有助于使这一过程变得平滑和容易。这个人只要看着摄像头，摄像头就会自动检测他/她是否应该被允许进入。</p><p id="56bc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">人脸检测的另一个有趣的应用是统计参加活动(如会议或音乐会)的人数。我们安装了一个摄像头，可以捕捉与会者的图像，并给出总人数，而不是手动计算与会者人数。这有助于自动化流程，并节省大量人工。很有用，不是吗？</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/9dbc4af8893cb80d264e2ab667bab5ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ay8IhI8oIBvY99jq.jpg"/></div></div></figure><p id="fac8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">你可以想出更多这样的应用程序——欢迎在下面的评论区分享。</p><p id="36ab" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在这篇文章中，我将把重点放在人脸检测的实际应用上，而只是掩饰其中的算法实际上是如何工作的。如果你想更多地了解他们，你可以浏览<a class="ae jr" href="https://www.analyticsvidhya.com/blog/2018/06/understanding-building-object-detection-model-python/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。</p><h1 id="9c00" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">设置系统—硬件/软件要求</h1><p id="8103" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">既然您已经知道了可以使用人脸检测技术构建的潜在应用程序，那么让我们看看如何使用我们可用的开源工具来实现它。这就是我们社区的优势——共享和开放源代码的意愿是任何行业都无法比拟的。</p><p id="9876" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">具体到本文，以下是我使用过的并推荐使用的方法:</p><ul class=""><li id="cda6" class="kq kr hi il b im in iq ir jh ll ji lm jj ln jg lo ky kz la bi translated">一个网络摄像头(Logitech C920)，用于在联想E470 ThinkPad笔记本电脑(酷睿i5第七代)上构建实时人脸检测器。你也可以使用你的笔记本电脑的内置摄像头，或闭路电视摄像头，在任何适当的系统进行实时视频分析，而不是我正在使用的设置</li><li id="2a31" class="kq kr hi il b im lp iq lq jh lr ji ls jj lt jg lo ky kz la bi translated">使用GPU进行更快的视频处理总是一个额外的好处</li><li id="a18b" class="kq kr hi il b im lp iq lq jh lr ji ls jj lt jg lo ky kz la bi translated">在软件方面，我们使用了安装了所有必备软件的Ubuntu 18.04操作系统</li></ul><p id="2459" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">让我们更详细地探讨这些要点，以确保在构建面部检测模型之前，一切都设置妥当。</p><h1 id="7d67" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">步骤1:硬件设置</h1><p id="37db" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">你要做的第一件事是检查网络摄像头是否设置正确。Ubuntu中的一个简单技巧——查看设备是否已经被操作系统注册。您可以遵循下面给出的步骤:</p><ol class=""><li id="a226" class="kq kr hi il b im in iq ir jh ll ji lm jj ln jg kx ky kz la bi translated">在将网络摄像头连接到笔记本电脑之前，请通过进入命令提示符并键入<em class="ik"> ls /dev/video*来检查所有连接的视频设备。</em>这将打印已经连接到系统的视频设备。</li></ol><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lu"><img src="../Images/6b92f30361b4ac4def4c7df58dc5b8e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*svG1zTFbHxzCQefo.png"/></div></figure><p id="eaa5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">2.连接网络摄像头，然后再次运行该命令。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lu"><img src="../Images/fa759f312c6b8d53ce9b1dead1d7fb2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*AdMIO0_sJfi3LcOC.png"/></div></figure><p id="e2fc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">如果网络摄像头连接成功，命令将显示一个新设备。</p><p id="f0dc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">3.你可以做的另一件事是使用任何网络摄像头软件来检查网络摄像头是否正常工作。你可以用Ubuntu中的“Cheese”来做这个。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lu"><img src="../Images/9360e1890df0a69dc9812954e7038f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*vMiHoXiTJGm8xFiy.png"/></div></figure><p id="a3cf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这里我们可以看到网络摄像头设置正确。硬件方面就这些了！</p><h1 id="c590" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">步骤2:软件设置</h1><h1 id="6d5c" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">步骤2.1:安装Python</h1><p id="99a0" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">本文中的代码是使用Python版构建的。虽然有多种方法可以安装Python，但我推荐使用Anaconda——数据科学领域最流行的Python发行版。这里有一个在你的系统中安装Anaconda 的<a class="ae jr" href="https://www.anaconda.com/download" rel="noopener ugc nofollow" target="_blank">链接。</a></p><h1 id="6398" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">步骤2.2:安装OpenCV</h1><p id="3099" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated"><a class="ae jr" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>(开源计算机视觉)是一个旨在构建计算机视觉应用的库。它有许多用于图像处理任务的预写函数。要安装OpenCV，请对库进行pip安装:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="bfe8" class="ma jt hi lw b fi mb mc l md me">pip3 install opencv-python</span></pre><h1 id="305b" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">步骤2.3:安装face _ recognition API</h1><p id="aeef" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">最后，我们将使用<a class="ae jr" href="https://github.com/ageitgey/face_recognition" rel="noopener ugc nofollow" target="_blank">面部识别</a>，它被称为世界上最简单的Python面部识别API。要安装:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="e6fd" class="ma jt hi lw b fi mb mc l md me">pip install dlib <br/>pip install face_recognition</span></pre><h1 id="1f75" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">让我们深入研究一下实现</h1><p id="133f" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">既然您已经设置了您的系统，现在终于到了开始实际实现的时候了。首先，我们将快速构建我们的程序，然后分解它以理解我们做了什么。</p><h1 id="4c4f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">简单演练</h1><p id="c805" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">首先，创建一个文件<em class="ik"> face_detector.py </em>，然后复制下面给出的代码:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="0365" class="ma jt hi lw b fi mb mc l md me"># import libraries<br/>import cv2<br/>import face_recognition<br/><br/># Get a reference to webcam <br/>video_capture = cv2.VideoCapture("/dev/video1")<br/><br/># Initialize variables<br/>face_locations = []<br/><br/>while True:<br/>    # Grab a single frame of video<br/>    ret, frame = video_capture.read()<br/><br/>    # Convert the image from BGR color (which OpenCV uses) to RGB color (which face_recognition uses)<br/>    rgb_frame = frame[:, :, ::-1]<br/><br/>    # Find all the faces in the current frame of video<br/>    face_locations = face_recognition.face_locations(rgb_frame)<br/><br/>    # Display the results<br/>    for top, right, bottom, left in face_locations:<br/>        # Draw a box around the face<br/>        cv2.rectangle(frame, (left, top), (right, bottom), (0, 0, 255), 2)<br/><br/>    # Display the resulting image<br/>    cv2.imshow('Video', frame)<br/><br/>    # Hit 'q' on the keyboard to quit!<br/>    if cv2.waitKey(1) &amp; 0xFF == ord('q'):<br/>        break<br/><br/># Release handle to the webcam<br/>video_capture.release()<br/>cv2.destroyAllWindows()</span></pre><p id="2982" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">然后，通过键入以下命令运行该Python文件:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="ae7d" class="ma jt hi lw b fi mb mc l md me">python face_detector.py</span></pre><p id="9329" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">如果一切正常，将弹出一个新窗口，运行实时人脸检测。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="mf jq l"/></div></figure><p id="8510" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">总而言之，这就是我们上面的代码所做的:</p><ol class=""><li id="4a50" class="kq kr hi il b im in iq ir jh ll ji lm jj ln jg kx ky kz la bi translated">首先，我们<strong class="il hj">定义了将要进行视频分析的硬件</strong></li><li id="69b5" class="kq kr hi il b im lp iq lq jh lr ji ls jj lt jg kx ky kz la bi translated">由此，我们<strong class="il hj">一帧一帧地实时捕捉视频</strong></li><li id="68d0" class="kq kr hi il b im lp iq lq jh lr ji ls jj lt jg kx ky kz la bi translated">然后我们<strong class="il hj">处理每一帧</strong>和<strong class="il hj">提取图像中所有人脸的位置</strong></li><li id="5275" class="kq kr hi il b im lp iq lq jh lr ji ls jj lt jg kx ky kz la bi translated">最后，我们<strong class="il hj">以视频形式</strong>渲染这些帧，以及脸部位置</li></ol><p id="3ea2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">很简单，不是吗？如果您想了解更详细的细节，我在每个代码部分都添加了注释。你可以随时回去回顾我们所做的事情。</p><h1 id="135c" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">人脸检测用例</h1><p id="6151" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">乐趣不止于此！我们可以做的另一件很酷的事情——围绕上述代码构建一个完整的用例。而且不需要从头开始。我们可以对代码做一些小的修改，然后就可以开始了。</p><p id="7bc8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">例如，假设您想要构建一个基于摄像头的自动系统来实时跟踪说话者的位置。根据他的位置，系统旋转摄像机，使说话者始终在视频中间。</p><p id="e005" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们该怎么做？第一步是建立一个系统来识别视频中的人，并关注说话者的位置。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lu"><img src="../Images/3bc750c1ecf152e9ce7524c1e4abfd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*FkXLClCCTXBpS2v_.png"/></div></figure><p id="06aa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">让我们看看如何实现这一点。为了这篇文章，我从Youtube 上拍摄了一个<a class="ae jr" href="https://youtu.be/A_-KqX-RazQ" rel="noopener ugc nofollow" target="_blank">视频，显示了一位发言者在DataHack Summit 2017大会上的讲话。</a></p><p id="6831" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">首先，我们导入必要的库:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="aa76" class="ma jt hi lw b fi mb mc l md me">import cv2 <br/>import face_recognition</span></pre><p id="9a49" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">然后，看视频，得出长度:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="bcdc" class="ma jt hi lw b fi mb mc l md me">input_movie = cv2.VideoCapture("sample_video.mp4")<br/>length = int(input_movie.get(cv2.CAP_PROP_FRAME_COUNT))</span></pre><p id="d901" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">之后，我们创建一个具有所需分辨率和帧速率的输出文件，它类似于输入文件。</p><p id="3044" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">加载说话者的样本图像以在视频中识别他:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="9593" class="ma jt hi lw b fi mb mc l md me">image = face_recognition.load_image_file("sample_image.jpeg")<br/>face_encoding = face_recognition.face_encodings(image)[0]<br/><br/>known_faces = [<br/>face_encoding,<br/>]</span></pre><p id="d031" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">所有这些都完成了，现在我们运行一个循环，它将执行以下操作:</p><ul class=""><li id="4e71" class="kq kr hi il b im in iq ir jh ll ji lm jj ln jg lo ky kz la bi translated">从视频中提取一帧</li><li id="43ad" class="kq kr hi il b im lp iq lq jh lr ji ls jj lt jg lo ky kz la bi translated">找到所有的面孔并识别他们</li><li id="102b" class="kq kr hi il b im lp iq lq jh lr ji ls jj lt jg lo ky kz la bi translated">创建一个新视频，将原始帧与带注释的说话者面部位置结合起来</li></ul><p id="ba71" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">让我们看看这个的代码:</p><pre class="jk jl jm jn fd lv lw lx ly aw lz bi"><span id="dbe1" class="ma jt hi lw b fi mb mc l md me"># Initialize variables<br/>face_locations = []<br/>face_encodings = []<br/>face_names = []<br/>frame_number = 0<br/><br/>while True:<br/>    # Grab a single frame of video<br/>    ret, frame = input_movie.read()<br/>    frame_number += 1<br/><br/>    # Quit when the input video file ends<br/>    if not ret:<br/>        break<br/><br/>    # Convert the image from BGR color (which OpenCV uses) to RGB color (which face_recognition uses)<br/>    rgb_frame = frame[:, :, ::-1]<br/><br/>    # Find all the faces and face encodings in the current frame of video<br/>    face_locations = face_recognition.face_locations(rgb_frame, model="cnn")<br/>    face_encodings = face_recognition.face_encodings(rgb_frame, face_locations)<br/><br/>    face_names = []<br/>    for face_encoding in face_encodings:<br/>        # See if the face is a match for the known face(s)<br/>        match = face_recognition.compare_faces(known_faces, face_encoding, tolerance=0.50)<br/><br/>        name = None<br/>        if match[0]:<br/>            name = "Phani Srikant"<br/><br/>        face_names.append(name)<br/><br/>    # Label the results<br/>    for (top, right, bottom, left), name in zip(face_locations, face_names):<br/>        if not name:<br/>            continue<br/><br/>        # Draw a box around the face<br/>        cv2.rectangle(frame, (left, top), (right, bottom), (0, 0, 255), 2)<br/><br/>        # Draw a label with a name below the face<br/>        cv2.rectangle(frame, (left, bottom - 25), (right, bottom), (0, 0, 255), cv2.FILLED)<br/>        font = cv2.FONT_HERSHEY_DUPLEX<br/>        cv2.putText(frame, name, (left + 6, bottom - 6), font, 0.5, (255, 255, 255), 1)<br/><br/>    # Write the resulting image to the output video file<br/>    print("Writing frame {} / {}".format(frame_number, length))<br/>    output_movie.write(frame)<br/><br/># All done!<br/>input_movie.release()<br/>cv2.destroyAllWindows()</span></pre><p id="df92" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">然后，代码会给出如下输出:</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="e3d7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">人脸检测真的是一件很棒的事情。🙂</p><h1 id="ddf3" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="9f4b" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jh lb iw ix ji lc ja jb jj ld je jf jg hb bi translated">恭喜你！您现在知道了如何为许多潜在的用例构建人脸检测系统。深度学习是一个如此迷人的领域，我非常期待看到我们接下来的发展方向。</p><p id="8112" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在本文中，我们了解了如何利用开源工具来构建具有现实用途的实时人脸检测系统。我鼓励您构建大量这样的应用程序，并亲自尝试。相信我，有很多东西要学，而且非常有趣！</p><p id="6fa1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">一如既往，如果你有任何疑问/建议，请在下面的评论区联系我们！</p></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><p id="1605" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><em class="ik">原载于2018年12月10日</em><a class="ae jr" href="https://www.analyticsvidhya.com/blog/2018/12/introduction-face-detection-video-deep-learning-python/" rel="noopener ugc nofollow" target="_blank"><em class="ik">【www.analyticsvidhya.com</em></a><em class="ik">。</em></p></div></div>    
</body>
</html>