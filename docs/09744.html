<html>
<head>
<title>How to classify Lego figures to impress your significant other</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对乐高玩具进行分类以打动你的另一半</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-classify-lego-figures-to-impress-your-significant-other-e0f38a262e66?source=collection_archive---------19-----------------------#2020-09-18">https://medium.com/analytics-vidhya/how-to-classify-lego-figures-to-impress-your-significant-other-e0f38a262e66?source=collection_archive---------19-----------------------#2020-09-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0e6cfb670ae085ed0afb8c187a8fe900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SEGHATamz5PNjAMK"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@danielkcheung?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">张家瑜</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="4dcc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你有没有想过如何在你的个人生活中实际运用人工智能？不要再看了！在这篇博文中，我将向你展示如何从你的jupyter笔记本中从kaggle下载一个数据集，并使用fastai最终解决正确分类乐高小雕像的问题。</p><p id="7e7e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了直接从kaggle下载数据集，我们需要使用kaggle API。这基本上意味着你必须登录你的kaggle账户，进入“你的账户”,向下滚动直到你找到API部分。点击“创建新的API令牌”并把它放在kaggle期望这个令牌在你机器上的位置(通常在文件夹~/中)。kaggle)。就这样，现在您可以像这样使用kaggle API:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/0f7e65675750035777edad08f2cb7259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i1abObJ0JmaIv9a9lkGn2A.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/69cba6cc5548d583189105eefec34718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfPlR7BfVlCSVw1Js5uy0Q.png"/></div></div></figure><p id="ea85" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以只需要基本的bash命令。我们下载了一个zip文件，我们可以在jupyter中使用bash对其进行解压缩，并将数据放在我们希望的位置。因此，我们将Python Pathlib包与bash结合使用！</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/ed2dea6f3b3137acde6e9fe169b4e605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O519LMpi3Z3c9J6qJyKebg.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/a2614d8a110328b0fc0af07cacddb14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fsig85z1dsxXXCGuFst_MQ.png"/></div></div></figure><p id="2a60" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">工作起来轻而易举！因此，我们将数据解压到“train”文件夹中，让我们利用fastai提供的众多便捷功能之一来看看数据是如何构造的。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/2a7b4b8d05056040164862bb49a6cb01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZwqLo9E5eFclnah-xWYkg.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/9fc7c1458d2f226b20b327ccc800b7cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WFvJTLG-tu-fh7SlrkOaFw.png"/></div></div></figure><p id="43b1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">记住，我们把数据放入我们的目录'/笔记本/存储/数据/乐高-分类'。在快速浏览了我们的数据后，看起来数据存储如下:首先是我们图像的类型(惊奇/侏罗纪世界)，然后是人物的分类(0001/0002等)。).在这些文件夹中，我们可以找到那个人物的许多不同的照片(001.jpg/002.jpg等等)。让我们通过查看元数据来确认这一点。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/6fa9b797bc83cba728f1541d281e4455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIdiuMq611WHYmA1wE-4Gw.png"/></div></div></figure><p id="0aaa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事实上，这就是这个数据集的结构。我们想要的是fastai的数据块可以轻松使用的数据结构。所以我们需要的是给我们文件名，标签和一个标签，哪个数据用于训练，哪个数据用于验证。幸运的是，我们可以通过组合元数据来得到这一点:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/eea1acda54665f3b485ad08c16b85e7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jk2dAEmvZ3BzhNg4blOldw.png"/></div></div></figure><p id="6237" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">fastai向我们简要介绍了在我们能够最佳利用数据块之前需要检查的内容:</p><pre class="ju jv jw jx fd kc kd ke kf aw kg bi"><span id="905e" class="kh ki hi kd b fi kj kk l kl km">what are the types of our inputs and targets? Images and labels.<br/>where is the data? In a dataframe.<br/>how do we know if a sample is in the training or the validation set? A column of our dataframe.<br/>how do we get an image? By looking at the column path.<br/>how do we know the label of an image? By looking at the column minifigure_name.<br/>do we want to apply a function to a given sample? Yes, we need to resize everything to a given size.<br/>do we want to apply a function to a batch after it's created? Yes, we want data augmentation.</span></pre><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/642fe7789198b944c5beacd4306da4d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovnvCiWJV0JXimIbx1Nu-w.png"/></div></div></figure><p id="6cd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们的数据块叫做lego_block。看它是如何完美地搭配在一起的？</p><p id="8fa8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我简单地解释一下我们的lego_block中的不同步骤在做什么:首先，我们告诉lego_block我们想要在什么上分割我们的数据(这里的缺省值是col='is_valid ')，然后我们简单地放入我们的path列(x[0])并将其与我们的path p和所在的文件夹' train '合并。get_y告诉lego_block在哪里可以找到我们的数据集中的标签(x[2])，然后我们使所有的图像大小相同，并对它们应用变换(查看fastai以了解更多信息)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/78b44261782a16eefea8b36af2c0d1ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qMVuiIDOdjuJAVncIp_yhQ.png"/></div></div></figure><p id="4609" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">光荣！</p><p id="bf49" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">fastai试图让我们的生活更轻松。这个博客旨在向你们展示如何简单快速地获得一个优秀的分类器。在接下来的博客中，我将尝试更好地解释幕后发生的事情。但是现在，让我们享受一下使用fastai构建分类器的速度吧！</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/953487110ebc4b48073e36d1b20eafff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aWnAS437LlOtODuGBy71iQ.png"/></div></div></figure><p id="2673" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">经过几个时期后，我们设法将错误率降低到17%左右。我们能改进吗？我们当然可以。但首先，让我们来看看混淆矩阵:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/246bd011f6df5eee97ea540c230c4b63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q9LMiwMOZiCfWzUwiszq-g.png"/></div></div></figure><p id="a2d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我觉得还不错。然而，看到罗恩·韦斯莱的照片并预测这是哈利·波特——我不知道这会给你的另一半留下多少印象。哦，亲爱的！有一次好老阿姨可能会预测是R2D2。另一方面，美国队长100%预测正确。</p><p id="8b7d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是我们仍然可以尝试通过解冻权重来改进我们的模型，让模型变得更好。让我们来看看这个:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/430a30ca64582ab6b5e0843636855435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ekmITnefxJNDwwUrUKqGQ.png"/></div></div></figure><p id="e6f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我们将解冻参数，并以稍低的学习速率学习:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/d1d6c3338587d7862a5d4651a0f3b91b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SU-Mvw-j2KwwveVGz58Mpg.png"/></div></div></figure><p id="ed26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">哇！只有10%的错误率。我认为那是相当令人印象深刻的！让我们看看混淆矩阵:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/f68fdfa396c687f31b5605e85d8166fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tCOKo1DF58o-TjBUKwo7ZA.png"/></div></div></figure><p id="afa2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有了这些结果，我相信你会给你的另一半留下深刻印象！</p><p id="1db0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这篇博文最初发表在我的个人博客:<a class="ae iu" href="https://lschmiddey.github.io/fastpages_/2020/09/16/Lego-Classification.html" rel="noopener ugc nofollow" target="_blank">https://lschmiddey . github . io/fast pages _/2020/09/16/Lego-classification . html</a></p><p id="dd0e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">拉塞</p></div></div>    
</body>
</html>