<html>
<head>
<title>NSFW Classifier to Curb out Censored Content.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NSFWåˆ†ç±»å™¨éåˆ¶å®¡æŸ¥å†…å®¹ã€‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/nsfw-classifier-to-curb-out-censored-content-d8e88dac165c?source=collection_archive---------5-----------------------#2019-10-20">https://medium.com/analytics-vidhya/nsfw-classifier-to-curb-out-censored-content-d8e88dac165c?source=collection_archive---------5-----------------------#2019-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ef91184d077ff901ef9b2f686f2a908b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1rMWZQEXWsTR-bGY"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@mr_williams_photography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">è¿ˆå¡Â·å¨å»‰å§†æ–¯</a>åœ¨<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹ç…§</figcaption></figure><p id="75d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">ä¸ºäº†è®©ç½‘ç»œå¯¹å„¿ç«¥æ›´å®‰å…¨ï¼Œè®¸å¤šç¤¾äº¤åª’ä½“ï¼Œå¦‚Tumblrã€è„¸ä¹¦ã€Instagramï¼Œéƒ½åœ¨é™åˆ¶NSFWå†…å®¹ï¼Œæ‰“é€ ä¸€ä¸ªæ›´å®‰å…¨çš„ç¤¾åŒºã€‚</strong></p><p id="97cb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æœ€è¿‘ï¼Œå°åº¦æ”¿åºœç¦æ­¢é¿å­•å¥—å¹¿å‘Šï¼Œå› ä¸ºå®ƒä»¬å¯¹å„¿ç«¥æ¥è¯´æ˜¯ä¸‹æµçš„ã€‚äºæ˜¯æˆ‘äº§ç”Ÿäº†ä¸€ä¸ªç–‘é—®ï¼Œè¿™äº›å¹¿å‘ŠçœŸçš„ä¸é›…å—ï¼Ÿè®©æˆ‘ä»¬åˆ©ç”¨æ·±åº¦å­¦ä¹ çš„åŠ›é‡æ‰¾åˆ°ç­”æ¡ˆã€‚æ‰€ä»¥è®©æˆ‘ä»¬é€šè¿‡ä½¿ç”¨<strong class="ix hj"> NSFWåˆ†ç±»å™¨æ¥æ‰¾å‡ºå¹¿å‘Šçš„æœ¬è´¨ã€‚</strong></p><h1 id="450e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">å»ºç«‹æ¨¡å‹çš„æ­¥éª¤:</strong></h1><ol class=""><li id="749b" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated">æ£€ç´¢æ•°æ®</li><li id="ad14" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">é¢„å¤„ç†æ•°æ®</li><li id="34b2" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹</li><li id="c08e" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">ä½¿ç”¨OpenCVæµ‹è¯•å¹¿å‘Š</li><li id="70db" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">æ”¹è¿›æ¨¡å‹ä»¥å‘ç°å›¾åƒä¸­çš„ç»†èŠ‚</li></ol><h1 id="88cd" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.è·å–æ•°æ®:</h1><p id="77a6" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">è·å–æ•°æ®æ˜¯æœ€é‡è¦çš„ä¸€æ­¥ã€‚ä½†æ˜¯30%çš„äº’è”ç½‘å†…å®¹æ˜¯è‰²æƒ…çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„æ•°æ®ã€‚æˆ‘ä»¬åœ¨redditå’Œ9gagä¸Šä¹Ÿæœ‰å¾ˆå¤šä¸å®‰å…¨çš„å†…å®¹ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æå–å›¾åƒæ¥è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚æˆ‘åœ¨Githubä¸Šå‘ç°äº†Alex Kimåˆ¶ä½œçš„è¿™ä¸ªå¾ˆæ£’çš„å›è´­ã€‚æˆ‘ç”¨å®ƒä¸‹è½½äº†ä¸‰ç§å›¾åƒæ•°æ®:è‰²æƒ…ã€ä¸­æ€§å’Œæ€§æ„Ÿã€‚</p><h1 id="ac98" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2.é¢„å¤„ç†æ•°æ®:</h1><p id="ef01" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">ç”±äºæˆ‘ä»¬ä»è„šæœ¬ä¸­ä¸‹è½½çš„æ•°æ®å°†è¢«åˆ†ç±»åˆ°3ä¸ªä¸åŒçš„æ–‡ä»¶å¤¹ä¸­ï¼Œå®ƒä»¬æœ‰å„è‡ªçš„å›¾åƒï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦åˆ†åˆ«æ ‡è®°å®ƒä»¬ã€‚æˆ‘ä»¬å°†ä½¿ç”¨Keras ImageDataGeneratorçš„å¼ºå¤§åŠŸèƒ½æ¥ç”Ÿæˆæ›´å¤šçš„æ•°æ®ã€‚ç¨åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨flowfromdirectory()å‡½æ•°æ¥å¤„ç†è®­ç»ƒã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="0962" class="lt ju hi lp b fi lu lv l lw lx"># File : NSFW.ipynb<br/>train_data_generation <strong class="lp hj">= </strong>ImageDataGenerator(rescale<strong class="lp hj">=</strong>1.<strong class="lp hj">/</strong>255, rotation_range<strong class="lp hj">=</strong>30, width_shift_range<strong class="lp hj">=</strong>0.2, height_shift_range<strong class="lp hj">=</strong>0.2, shear_range<strong class="lp hj">=</strong>0.2, zoom_range<strong class="lp hj">=</strong>0.2, channel_shift_range<strong class="lp hj">=</strong>20, horizontal_flip<strong class="lp hj">=True</strong>)</span></pre><h1 id="cd20" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">3.è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹:</h1><p id="b5ea" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">æˆ‘ä»¬å°†åœ¨Kerasä¸­ä½¿ç”¨è¿ç§»å­¦ä¹ ï¼Œå¹¶ä¸ºæ­¤ä½¿ç”¨MobileNetV2ã€‚å› ä¸ºå®ƒæœ‰å¾ˆå°‘çš„å‚æ•°ï¼Œéå¸¸é€‚åˆåº”ç”¨ç¨‹åºã€‚ç„¶åæˆ‘åœ¨æœ€åä¸€å±‚å°è¯•äº†ä¸åŒçš„æ¶æ„ï¼Œæˆ‘åœ¨å¯†é›†å±‚ä½¿ç”¨äº†256ä¸ªå•ä½å’Œ128ä¸ªå•ä½ï¼Œä½†æ˜¯ä»–ä»¬å¼€å§‹è¿‡åº¦é€‚åº”ã€‚ç„¶åï¼Œæœ€åæˆ‘æƒ³å‡ºäº†ä¸€ä¸ª32ä¸ªå•ä½çš„å•ä¸€å¯†é›†å±‚ï¼Œæ‰¹é‡æ ‡å‡†åŒ–ï¼Œè¾å­¦ï¼Œå¹¶è·å¾—äº†93.5%çš„æµ‹è¯•æ•°æ®çš„å‡†ç¡®æ€§ã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="5e81" class="lt ju hi lp b fi lu lv l lw lx"># File : NSFW.ipynb<br/>conv_m <strong class="lp hj">= </strong>MobileNetV2(weights<strong class="lp hj">=</strong>'imagenet', include_top<strong class="lp hj">=False</strong>, input_shape<strong class="lp hj">=</strong>(size, size, 3)) <br/>conv_m.trainable <strong class="lp hj">= False<br/></strong>model.add(conv_m) model.add(AveragePooling2D(pool_size<strong class="lp hj">=</strong>(7, 7))) model.add(Flatten())<br/>model.add(Dense(32, activation <strong class="lp hj">= </strong>'relu')) model.add(BatchNormalization()) model.add(Dropout(0.5))<br/>model.add(Dense(3, activation<strong class="lp hj">=</strong>'softmax'))</span></pre><p id="9755" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä½¿ç”¨äº†ModelCheckpointå’ŒReduceLROnPlateauå›è°ƒï¼Œç„¶åä½¿ç”¨äº†å¸¦æœ‰åŠ¨é‡çš„SGDåˆ†ç±»å™¨ã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="65fa" class="lt ju hi lp b fi lu lv l lw lx">model.compile( loss<strong class="lp hj">=</strong>'categorical_crossentropy', optimizer<strong class="lp hj">=</strong>SGD(lr <strong class="lp hj">= </strong>0.1, momentum <strong class="lp hj">= </strong>0.9), metrics<strong class="lp hj">=</strong>['accuracy'])</span></pre><p id="2fcf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç„¶åï¼Œæˆ‘ä»¥10çš„æ­¥é•¿å¯¹å®ƒè¿›è¡Œäº†100æ¬¡è®­ç»ƒï¼Œå› ä¸ºæˆ‘æ²¡æœ‰ä»»ä½•GPUï¼Œæ‰€ä»¥æˆ‘èŠ±äº†å¤§çº¦7-8ä¸ªå°æ—¶æ¥è®­ç»ƒ25GBå¤§å°çš„æ¨¡å‹ã€‚æˆ‘åœ¨GCPä¸Šç”¨60 GBå†…å­˜è¿è¡Œå®ƒã€‚ä½ å¯ä»¥ä»æˆ‘çš„Githubè·å¾—è®­ç»ƒè¿‡çš„æ¨¡å‹ï¼Œè§æ–‡ç« æœ«å°¾ã€‚</p><p id="b7be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æˆ‘ä»¬æ¨¡å‹çš„è¾“å‡º:</strong></p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="8ef2" class="lt ju hi lp b fi lu lv l lw lx">from PIL import Image<br/>import numpy as np<br/>from skimage import transform<br/>def load(filename):<br/>    np_image = Image.open(filename)<br/>    np_image = np.array(np_image).astype('float32')/255<br/>    np_image = transform.resize(np_image, (224, 224, 3))<br/>    np_image = np.expand_dims(np_image, axis=0)<br/>    img=mpimg.imread(filename)<br/>    plt.imshow(img)<br/>    return np_image</span><span id="c3bf" class="lt ju hi lp b fi ly lv l lw lx">image = load("selena.jpg")<br/>ans = model.predict(image)<br/>maping = {0 : "Neutral", 1 : "Porn", 2 : "Sexy"}<br/>new_ans = np.argmax(ans[0])</span><span id="0a12" class="lt ju hi lp b fi ly lv l lw lx">print(maping[new_ans], np.round(ans,2))<br/>print("With {} probability".format(ans[0][new_ans]))</span></pre><p id="a6ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¾“å…¥:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/c638c512cb93e77ce84af4d8326c5eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VS1SuN9aRey0qOqerAJVNA.jpeg"/></div></div></figure><p id="cf6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¾“å‡º:<br/>æ€§æ„Ÿ[[0.01 0ã€‚0.99]] <br/>ä»¥0.98çš„æ¦‚ç‡</p><p id="df11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">åœ¨iPhoneä¸Šéƒ¨ç½²æ¨¡å‹ã€‚</strong></p><p id="f12c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦iOSå…¼å®¹å½¢å¼çš„æ¨¡å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨pythonåº“coremltoolsã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="4572" class="lt ju hi lp b fi lu lv l lw lx">import coremltools<br/>model.author <strong class="lp hj">= </strong>"Lakshay Chhabra"<br/>model.short_description <strong class="lp hj">= </strong>"NSFW Image Classifier"<br/>output_labels <strong class="lp hj">= </strong>['Neutral', 'Porn', 'Sexy']</span><span id="9a13" class="lt ju hi lp b fi ly lv l lw lx">ios = coremltools.converters.keras.convert(model, input_names=['image'], output_names = ['output'],                       class_labels = output_labels, image_input_names = 'image', image_scale=1/255.0)</span><span id="953b" class="lt ju hi lp b fi ly lv l lw lx">ios.save('NSFW.mlmodel')</span></pre><p id="7cec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä»¬çš„æ¨¡å‹ä¿å­˜ä¸‹æ¥äº†ï¼Œè®©æˆ‘ä»¬å°†å®ƒåŠ è½½åˆ°swiftåº”ç”¨ç¨‹åºä¸­ã€‚<br/> <strong class="ix hj">ç¬¬ä¸€æ­¥:<br/> </strong>è®¾è®¡appçš„å‰ç«¯ï¼Œæˆ‘ä»¬ä¸ºå®ƒä½¿ç”¨äº†æ•…äº‹æ¿ã€‚æˆ‘ä»¬é€‰æ‹©äº†å¸¦æœ‰æ¨¡ç³Šæ•ˆæœçš„å›¾åƒè§†å›¾ï¼Œå› ä¸ºå›¾åƒå°†æ˜¯NSFWï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å®ƒä»¬éšè—åœ¨æ¨¡ç³Šå±‚ä¸‹ã€‚</p><p id="e41e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">ç¬¬äºŒæ­¥:<br/> </strong>æˆ‘ä»¬æ ¹æ®è‡ªå·±çš„éœ€è¦è°ƒæ•´äº†å›¾åƒçš„å¤§å°ã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="dff6" class="lt ju hi lp b fi lu lv l lw lx">func resizeImage(image: UIImage) -&gt; UIImage {                        var newSize: CGSize <br/>newSize = CGSize(width: 224, height: 224)<br/>let rect = CGRect(x: 0, y: 0, width: 224, height: 224)                UIGraphicsBeginImageContextWithOptions(newSize, false, 1.0)     image.draw(in: rect)        <br/>let newImage = UIGraphicsGetImageFromCurrentImageContext()        UIGraphicsEndImageContext()               <br/>return newImage!   <br/> }</span></pre><p id="a62d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">ç¬¬ä¸‰æ­¥:<br/> </strong>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹æ¥é¢„æµ‹ç»“æœï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ¥è‡ª<a class="ae iu" href="https://github.com/lakshaychhabra/NSFW-ios-ML/blob/master/NSFW%20Detect/ViewController.swift" rel="noopener ugc nofollow" target="_blank">æ–‡ä»¶</a>çš„ä¸€å°æ®µä»£ç ã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="66f1" class="lt ju hi lp b fi lu lv l lw lx">let request = VNCoreMLRequest(model: model) { (request, error) in            print(request.results!)<br/>guard let classification = request.results?.first as? VNClassificationObservation<br/>else{ <br/>fatalError("cant find the image")<br/>}<br/>DispatchQueue.main.async {<br/>let confidenceRate = (classification.confidence) * 100                self.output_label.text = "\(confidenceRate)% it's \(String(describing: classification.identifier))"<br/>self.k = self.dict[classification.identifier]!                if(self.k == 0){<br/>self.warning.text = "Safe Image"<br/>}<br/>else if(self.k == 1){<br/>self.warning.text = "NSFW Image"<br/>}else{ <br/>self.warning.text = "Not For Kids Image"<br/>}                           <br/>}</span></pre><p id="9c2e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">è®©æˆ‘ä»¬çœ‹çœ‹è¾“å‡º:</strong></p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="ma mb l"/></div></figure><h1 id="33b4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">4.ä½¿ç”¨OpenCVæµ‹è¯•å¹¿å‘Š:</h1><p id="348b" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">å¯¹äºæµ‹è¯•è§†é¢‘æ¥è¯´ï¼ŒopenCVæ˜¯ä¸€ä¸ªå¾ˆæ£’çš„åŒ…ã€‚è§†é¢‘åªæ˜¯å›¾åƒåºåˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸ªå›¾åƒè¿›è¡Œåˆ†ç±»ï¼Œå¦‚æœä»»ä½•å›¾åƒä¸å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†è§†é¢‘åˆ—ä¸ºä¸å®‰å…¨ã€‚æˆ‘ä»¬å°†ä½¿ç”¨openCVåŠ è½½è§†é¢‘ï¼Œä¸è¦å¿˜è®°è¿™ä¸€æ­¥ï¼Œå› ä¸ºå®ƒéå¸¸é‡è¦ã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="34e8" class="lt ju hi lp b fi lu lv l lw lx"># File : NSFW Video Detector<br/># We are dividing image by 255.0 as keeping image pixels in range of # 0-1 as it is easier to train. As we used 0-1 range in training so # we need our input as same as we provided while training #classifier.</span><span id="8068" class="lt ju hi lp b fi ly lv l lw lx">vs = cv2.VideoCapture(input_vid)<br/>writer = None<br/>(W, H) = (None, None)<br/> <br/># loop over frames from the video file stream<br/>while True:<br/>    # read the next frame from the file<br/>    (grabbed, frame) = vs.read()<br/> <br/>    # if the frame was not grabbed, then we have reached the end<br/>    # of the stream<br/>    if not grabbed:<br/>        break<br/> <br/>    # if the frame dimensions are empty, grab them<br/>    if W is None or H is None:<br/>        (H, W) = frame.shape[:2]<br/>    <br/>    output = frame.copy()<br/>    frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)<br/>    frame = frame/255.0<br/>    frame = cv2.resize(frame, (224, 224)).astype("float32")<br/>    <br/>#     frame -= mean<br/>    <br/>    # make predictions on the frame and then update the predictions<br/>    # queue<br/>    preds = model.predict(np.expand_dims(frame, axis=0))[0]<br/>    print(preds)<br/>    Q.append(preds)</span><span id="7694" class="lt ju hi lp b fi ly lv l lw lx"># perform prediction averaging over the current history of<br/>    # previous predictions</span><span id="b3b9" class="lt ju hi lp b fi ly lv l lw lx">results = np.array(Q).mean(axis=0)<br/>    i = np.argmax(preds)<br/>    label = labels[i]<br/>    # draw the activity on the output frame<br/>    text = "activity: {}:".format(label)<br/>    cv2.putText(output, text, (35, 50), cv2.FONT_HERSHEY_SIMPLEX, 1.25, (0, 255, 0), 5)</span><span id="03a3" class="lt ju hi lp b fi ly lv l lw lx"># check if the video writer is None<br/>    if writer is None:<br/>        # initialize our video writer<br/>        fourcc = cv2.VideoWriter_fourcc(*"MJPG")<br/>        writer = cv2.VideoWriter(output_vid, fourcc, 30, (W, H), True)</span><span id="fa7b" class="lt ju hi lp b fi ly lv l lw lx"># write the output frame to disk<br/>    writer.write(output)</span><span id="e56b" class="lt ju hi lp b fi ly lv l lw lx"># show the output image<br/>    cv2.imshow("Output", output)<br/>    key = cv2.waitKey(1) &amp; 0xFF</span><span id="0d24" class="lt ju hi lp b fi ly lv l lw lx"># if the `q` key was pressed, break from the loop<br/>    if key == ord("q"):<br/>        break<br/>        <br/># release the file pointers<br/>print("[INFO] cleaning up...")<br/># writer.release()<br/>vs.release()</span></pre><p id="9504" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å½“è¿è¡Œé¿å­•å¥—å¹¿å‘Šæ—¶ï¼Œä¸Šè¿°ä»£ç çš„è¾“å‡ºæ˜¯:</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="mc mb l"/></div></figure><p id="b6f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä¸€äº›åœºæ™¯è¢«åˆ—ä¸ºæ€§æ„Ÿå’Œè‰²æƒ…ï¼Œæ‰€ä»¥æˆ‘æƒ³æ”¿åºœæ˜¯å¯¹çš„ğŸ˜œã€‚</p><h1 id="e8eb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">5.æ”¹è¿›æ¨¡å‹ä»¥å‘ç°å›¾åƒä¸­çš„ç»†èŠ‚:</h1><p id="282c" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">å¦‚æœæˆ‘ä»¬è¦åˆ†ç±»çš„å›¾åƒå¾ˆå¤§ï¼Œè€Œå›¾åƒä¸­åªæœ‰å¾ˆå°ä¸€éƒ¨åˆ†æ˜¯NSFWå†…å®¹ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä½¿ç”¨äº†æ»‘åŠ¨çª—å£æŠ€æœ¯æ¥éå†å›¾åƒä¸­çš„å°å¸§ï¼Œå¹¶é€è¡Œå¯¹å®ƒä»¬è¿›è¡Œåˆ†ç±»ã€‚å½“æˆ‘æŠŠè¿™å¼ å›¾ç‰‡ä½œä¸ºä¸€ä¸ªæ•´ä½“è¾“å…¥åˆ†ç±»å™¨æ—¶ï¼Œå®ƒæŠŠå®ƒè¯†åˆ«ä¸ºè‰²æƒ…å›¾ç‰‡ã€‚ä½†æ˜¯å¯èƒ½å­˜åœ¨NSFWå«é‡éå¸¸å°‘æƒ…å†µã€‚æ‰€ä»¥æˆ‘ä»¬æ¥è¯•è¯•å§ã€‚</p><p id="cdc3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">PSã€‚æˆ‘åœ¨å¤„ç†å›¾åƒåè¾“å…¥äº†å®¡æŸ¥ï¼Œæ‰€ä»¥å¯¹è¯»è€…æ¥è¯´æ˜¯å®‰å…¨çš„ã€‚</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="0f34" class="lt ju hi lp b fi lu lv l lw lx">def check(unsave = 0):<br/>    image = cv2.imread("final.png")<br/>    (winW, winH) = (224, 224)<br/>    maping = {0 : "Neutral", 1 : "Porn", 2 : "Sexy"}<br/>    writer = None<br/>    for resized in pyramid(image, scale=5):<br/>        # loop over the sliding window for each layer of the pyramid<br/>        for (x, y, window) in sliding_window(resized, stepSize=48, windowSize=(winW, winH)):<br/>            # if the window does not meet our desired window size, ignore it</span><span id="ca90" class="lt ju hi lp b fi ly lv l lw lx">if window.shape[0] != winH or window.shape[1] != winW:<br/>                continue</span><span id="5c42" class="lt ju hi lp b fi ly lv l lw lx"># THIS IS WHERE YOU WOULD PROCESS YOUR WINDOW, SUCH AS APPLYING A<br/>            # MACHINE LEARNING CLASSIFIER TO CLASSIFY THE CONTENTS OF THE<br/>            # WINDOW<br/>            output = resized.copy()<br/>            frame = cv2.cvtColor(window, cv2.COLOR_BGR2RGB)<br/>            frame = frame/255.0<br/>            preds = model.predict(np.expand_dims(frame, axis=0))[0]<br/>            i = np.argmax(preds)<br/>            label = maping[i]<br/>            print(preds, label)<br/>            <br/>            if unsave:<br/>                if i == 1:<br/>                    return "Porn Found"<br/>                <br/>            if not unsave:<br/>                clone = resized.copy()<br/>                image = cv2.rectangle(clone, (x, y), (x + winW, y + winH), (0, 255, 0), 2)<br/>                cv2.putText(image, label, (x, y+50), cv2.FONT_HERSHEY_SIMPLEX, 1.25, (0, 255, 0), 5)</span><span id="4515" class="lt ju hi lp b fi ly lv l lw lx">cv2.imshow("Window", clone)<br/>                cv2.waitKey(1)<br/>                time.sleep(0.09)</span><span id="2437" class="lt ju hi lp b fi ly lv l lw lx">if writer is None:<br/>                # initialize our video writer<br/>                    fourcc = cv2.VideoWriter_fourcc(*"MJPG")<br/>                    writer = cv2.VideoWriter("1.avi", fourcc, 8, (1080, 720), True)</span><span id="167c" class="lt ju hi lp b fi ly lv l lw lx"># write the output frame to disk<br/>                writer.write(clone)<br/>    return "Save to View"</span><span id="216e" class="lt ju hi lp b fi ly lv l lw lx"># Frame by Frame ipynb<br/># Just added a very small change</span><span id="37f0" class="lt ju hi lp b fi ly lv l lw lx"><strong class="lp hj">def </strong>isUnsave(): <br/>    ans <strong class="lp hj">= </strong>check(1)<br/>    print(ans)<br/># This check function is similar to what we made during Video <br/># Detection but sliding window concept is added. </span></pre><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="md mb l"/></div></figure><h1 id="e374" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">æœªæ¥å·¥ä½œ:</h1><ol class=""><li id="b66c" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated">è¯¥åˆ†ç±»å™¨æœªèƒ½è¯†åˆ«ç”·æ€§ç”Ÿæ®–å™¨ï¼Œå› ä¸ºå®ƒæ²¡æœ‰åœ¨ç”·æ€§ç”Ÿæ®–å™¨ä¸Šè¿›è¡Œè®­ç»ƒã€‚å› æ­¤ï¼Œä»æœªæ¥çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ›´å¤šçš„æ•°æ®ä¸Šè®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚</li><li id="d271" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">è¿™ä¸ªåˆ†ç±»å™¨æ— æ³•è¯†åˆ«æ¼«ç”»ã€åŠ¨æ¼«å’Œéå¸¸ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨redditä¸ŠåºŸå¼ƒæ›´å¤šæ•°æ®ï¼Œå¹¶è¿›ä¸€æ­¥è®­ç»ƒå®ƒã€‚</li></ol><h1 id="0aeb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">æ€»ç»“:</h1><p id="90f9" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">æ„å»ºè¿™ä¸ªæ¨¡å‹æ˜¯ä¸€ç§å¾ˆæ£’çš„ä½“éªŒï¼Œåœ¨å„ç§å›¾åƒä¸Šæµ‹è¯•å®ƒæ›´æœ‰è¶£ã€‚è¯¥æ¨¡å‹åœ¨æ—¥å¸¸ç”Ÿæ´»å›¾åƒä¸Šæ•ˆæœå¾ˆå¥½ï¼Œç²¾ç¡®åº¦å¯ä»¥è¿›ä¸€æ­¥æé«˜ã€‚å¯¹äºå¤±è´¥æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŠ¨æ¼«å’Œæ›´å¤šè‰²æƒ…èµ„æ–™ä¸Šè®­ç»ƒæ¨¡å‹ã€‚</p><h1 id="42a1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">èµ„æº:</h1><ol class=""><li id="e3ac" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated">æˆ‘çš„NSFWåˆ†ç±»å™¨çš„Githubåº“:<a class="ae iu" href="https://github.com/lakshaychhabra/NSFW-Detection-DL" rel="noopener ugc nofollow" target="_blank">https://github.com/lakshaychhabra/NSFW-Detection-DL</a></li><li id="d2e7" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">iOSåº”ç”¨çš„Githubåº“:<a class="ae iu" href="https://github.com/lakshaychhabra/NSFW-ios-ML" rel="noopener ugc nofollow" target="_blank">https://github.com/lakshaychhabra/NSFW-ios-ML</a></li><li id="f4f7" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">æˆ‘çš„ä½œå“é›†:<a class="ae iu" href="https://lakshaychhabra.github.io" rel="noopener ugc nofollow" target="_blank">lakshaychabra . github . io</a></li></ol><h1 id="3c60" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">å‚è€ƒèµ„æ–™:</h1><p id="c479" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">ç‰¹åˆ«æ„Ÿè°¢æ•°æ®ç§‘å­¦ç¤¾åŒºåœ¨ç½‘ç»œä¸Šæä¾›çš„ç²¾å½©å†…å®¹ã€‚</p><ol class=""><li id="6b64" class="kr ks hi ix b iy iz jc jd jg me jk mf jo mg js ky kz la lb bi translated">æ•°æ®é›†:<a class="ae iu" href="https://github.com/alex000kim/nsfw_data_scraper" rel="noopener ugc nofollow" target="_blank">https://github.com/alex000kim/nsfw_data_scraper</a></li><li id="f7fc" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">åšå®¢å‚è€ƒ:<a class="ae iu" href="https://www.freecodecamp.org/news/how-to-set-up-nsfw-content-detection-with-machine-learning-229a9725829c/" rel="noopener ugc nofollow" target="_blank">https://www . freecodecamp . org/news/how-to-set-up-nsfw-content-detection-with-machine-learning-229 a 9725829 c/</a></li><li id="9e6a" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">OpenCVå‚è€ƒ:<a class="ae iu" href="https://www.pyimagesearch.com/2019/07/15/video-classification-with-keras-and-deep-learning/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2019/07/15/video-classification-with-keras-and-deep-learning/</a>ï¼Œ<a class="ae iu" href="https://www.pyimagesearch.com/2015/03/23/sliding-windows-for-object-detection-with-python-and-opencv/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2015/03/23/sliding-windows-for-object-detection-with-python-and-OpenCV/</a></li><li id="703e" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">å…³äºBançš„æ–°é—»:<a class="ae iu" href="https://www.thehindu.com/news/national/govt-bans-condom-ads-from-6-am-to-10-pm-because-they-are-indecent/article21461765.ece" rel="noopener ugc nofollow" target="_blank">https://www . the Hindu . com/news/national/govt-bans-é¿å­•å¥—-å¹¿å‘Š-ä»æ—©ä¸Š6ç‚¹åˆ°æ™šä¸Š10ç‚¹-å› ä¸ºä»–ä»¬æ˜¯ä¸é›…çš„/article21461765.ece </a></li></ol></div></div>    
</body>
</html>