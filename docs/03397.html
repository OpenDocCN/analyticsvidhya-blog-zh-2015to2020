<html>
<head>
<title>Writing Python Nested List Comprehensions in 3 Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用3个步骤编写Python嵌套列表理解</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/writing-python-nested-list-comprehensions-in-3-steps-75bd9a1b79b6?source=collection_archive---------11-----------------------#2020-01-29">https://medium.com/analytics-vidhya/writing-python-nested-list-comprehensions-in-3-steps-75bd9a1b79b6?source=collection_archive---------11-----------------------#2020-01-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e2787506c7a0c16d1e3486d9bb1c215b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YkUuHBrMl0GFX7c2kZQzyA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由来自<a class="ae iu" href="https://www.pexels.com/photo/close-up-photography-of-quail-eggs-on-nest-810320/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>的<a class="ae iu" href="https://www.pexels.com/@nietjuh?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">伊兰尼特·科彭斯</a>拍摄</figcaption></figure><p id="5e0b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Python的可能性是无限的。对于你学到的每一个技巧和诀窍，似乎还有十几个可以吸收并用来让生活变得更容易。在我看来，作为一个python主义者，你能做的最巧妙的一件事就是列出理解。</p><p id="664a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于那些不知道的人来说，列表理解是循环遍历迭代器(例如，像列表、元组或字典)的一行代码，并根据元素是否符合某些标准挑选出特定的项目。输出是符合条件的新答案列表。</p><p id="6f01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="fc26" class="kc kd hi jy b fi ke kf l kg kh">first_ten = [1,2,3,4,5,6,7,8,9,10]</span><span id="bbf7" class="kc kd hi jy b fi ki kf l kg kh">evens = [number for number in first_ten if number % 2 == 0]</span><span id="4aed" class="kc kd hi jy b fi ki kf l kg kh">evens = [2, 4, 6, 8, 10]</span></pre><p id="2ed9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个列表理解，它根据first_ten列表中的每个数字是否能被2整除来创建一个新的数字列表。</p><p id="15bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">换句话说，我们告诉python从first_ten开始给我们一个条件为真的所有数字的新列表。另一种写法是:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9aa3" class="kc kd hi jy b fi ke kf l kg kh">evens = []</span><span id="12cf" class="kc kd hi jy b fi ki kf l kg kh">for number in first_ten:<br/>    if number % 2 == 0:<br/>        evens.append(number)</span></pre><p id="cac2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">列表理解的不同之处在于，你在<em class="kj">一行</em>中完成了完全相同的事情，而不是四行。感觉很棒，对吧？</p><h1 id="9995" class="kk kd hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">嵌套列表理解</h1><p id="fb8b" class="pw-post-body-paragraph iv iw hi ix b iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo ll jq jr js hb bi translated">你可能想坐下来听接下来的部分。正如我们在上面问题的更长版本的“for”循环中嵌套了一个“if”条件一样，<em class="kj">你也可以在另一个</em>中嵌套一个列表理解。令人兴奋吧。</p><p id="8018" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是什么时候你需要一个嵌套列表理解呢？</p><p id="f04d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设您在字典中有一个包含姓名和电子邮件的地址簿，以及一个即将到来的聚会的单独邀请列表:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="f3ca" class="kc kd hi jy b fi ke kf l kg kh">address_book = </span><span id="5bd2" class="kc kd hi jy b fi ki kf l kg kh">     {“Sally”: "sally@wahoo.com", <br/>      “John”: "john@froogle.com",<br/>      “Veejay”: "veejay@botmail.com",  <br/>      “Tom”: "tom@whymail.com", <br/>      “Meredith”: "meredith@schoolu.edu", <br/>      “Margot”: "margot@baeol.com}</span><span id="7b3c" class="kc kd hi jy b fi ki kf l kg kh">invite_list = ["John", "Veejay", "Margot"]</span></pre><p id="07c5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您想要遍历地址簿，为列表中的名字选择电子邮件地址，并创建一个新列表。这将很容易一次给每个人发电子邮件邀请参加聚会。</p><p id="39f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是理解嵌套列表的绝佳机会:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="510b" class="kc kd hi jy b fi ke kf l kg kh">invite_emails = [address_book[key] for name in invite_list for key in address_book if name in key]</span><span id="2f7c" class="kc kd hi jy b fi ki kf l kg kh">invite_emails = ["john@froogle.com", "veejay@botmail.com", "margot@baeol.com"]</span></pre><h1 id="9480" class="kk kd hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">3步Python列表理解</h1><p id="621b" class="pw-post-body-paragraph iv iw hi ix b iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo ll jq jr js hb bi translated">所以我们遍历一个列表，对照字典交叉检查每个条目，我们也在遍历字典。嵌套循环方法可能有点难看，比如:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="735e" class="kc kd hi jy b fi ke kf l kg kh">for item in invite_list:<br/>    for key in address_book:<br/>        if item == key:<br/>            return value</span></pre><p id="5e3b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是这抛出了很多错误，总体上看起来很痛苦。不，不，我们应该用嵌套列表理解。我们可以做到这一点(答案见上文:我们已经做到了)！</p><p id="97fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当用Python构建嵌套列表理解时，就像软件开发中的许多事情一样，我喜欢从小处着手，一次做一件事。当我成功解决了问题的一小部分时，我就有足够的动力去解决未知的部分。</p><p id="fcfe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤1: </strong>在一个列表理解中，遍历address_book中的键，并用字典中的每个值的<em class="kj">填充新的列表理解。</em></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="2493" class="kc kd hi jy b fi ke kf l kg kh">invite_emails = [address_book[key] for key in address_book]</span><span id="82e8" class="kc kd hi jy b fi ki kf l kg kh">invite_emails = ["sally@wahoo.com", "john@froogle.com", "veejay@botmail.com", "tom@whymail.com", "meredith@schoolu.edu", <br/>"margot@baeol.com"]</span></pre><p id="e68a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">成功！我们已经成功地遍历了字典，没有出现错误消息。这是很好的第一步，但是记住我们还需要遍历邀请列表。</p><p id="23c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤2: </strong>通过invite_list插入一个迭代。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="8e64" class="kc kd hi jy b fi ke kf l kg kh">invite_emails = [address_book[key] <strong class="jy hj">for name in invite_list </strong>for key in address_book]</span><span id="38f8" class="kc kd hi jy b fi ki kf l kg kh">invite_emails = ['<a class="ae iu" href="mailto:sally@wahoo.com" rel="noopener ugc nofollow" target="_blank">sally@wahoo.com</a>', '<a class="ae iu" href="mailto:john@froogle.com" rel="noopener ugc nofollow" target="_blank">john@froogle.com</a>', '<a class="ae iu" href="mailto:veejay@botmail.com" rel="noopener ugc nofollow" target="_blank">veejay@botmail.com</a>', '<a class="ae iu" href="mailto:tom@whymail.com" rel="noopener ugc nofollow" target="_blank">tom@whymail.com</a>', '<a class="ae iu" href="mailto:meredith@schoolu.edu" rel="noopener ugc nofollow" target="_blank">meredith@schoolu.edu</a>', '<a class="ae iu" href="mailto:margot@baeol.com" rel="noopener ugc nofollow" target="_blank">margot@baeol.com</a>', '<a class="ae iu" href="mailto:sally@wahoo.com" rel="noopener ugc nofollow" target="_blank">sally@wahoo.com</a>', '<a class="ae iu" href="mailto:john@froogle.com" rel="noopener ugc nofollow" target="_blank">john@froogle.com</a>', '<a class="ae iu" href="mailto:veejay@botmail.com" rel="noopener ugc nofollow" target="_blank">veejay@botmail.com</a>', '<a class="ae iu" href="mailto:tom@whymail.com" rel="noopener ugc nofollow" target="_blank">tom@whymail.com</a>', '<a class="ae iu" href="mailto:meredith@schoolu.edu" rel="noopener ugc nofollow" target="_blank">meredith@schoolu.edu</a>', '<a class="ae iu" href="mailto:margot@baeol.com" rel="noopener ugc nofollow" target="_blank">margot@baeol.com</a>', '<a class="ae iu" href="mailto:sally@wahoo.com" rel="noopener ugc nofollow" target="_blank">sally@wahoo.com</a>', '<a class="ae iu" href="mailto:john@froogle.com" rel="noopener ugc nofollow" target="_blank">john@froogle.com</a>', '<a class="ae iu" href="mailto:veejay@botmail.com" rel="noopener ugc nofollow" target="_blank">veejay@botmail.com</a>', '<a class="ae iu" href="mailto:tom@whymail.com" rel="noopener ugc nofollow" target="_blank">tom@whymail.com</a>', '<a class="ae iu" href="mailto:meredith@schoolu.edu" rel="noopener ugc nofollow" target="_blank">meredith@schoolu.edu</a>', '<a class="ae iu" href="mailto:margot@baeol.com" rel="noopener ugc nofollow" target="_blank">margot@baeol.com</a>']</span></pre><p id="d1ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好吧，这有点疯狂。我们有三组电子邮件，而理想情况下我们只需要一组。这是因为我们要求python返回invite_list中项目的每个实例的键。三个项目意味着三个完整的邮件地址列表！</p><p id="8932" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们不希望这样，所以我们需要在这里设置一些限制…通过添加一个条件。</p><p id="06ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第三步:</strong>在嵌套列表理解的末尾添加条件。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="0d30" class="kc kd hi jy b fi ke kf l kg kh">invite_emails = [address_book[key] for name in invite_list for key in address_book <strong class="jy hj">if name in key</strong>]</span><span id="0bee" class="kc kd hi jy b fi ki kf l kg kh">invite_emails = ['<a class="ae iu" href="mailto:john@froogle.com" rel="noopener ugc nofollow" target="_blank">john@froogle.com</a>', '<a class="ae iu" href="mailto:veejay@botmail.com" rel="noopener ugc nofollow" target="_blank">veejay@botmail.com</a>', '<a class="ae iu" href="mailto:margot@baeol.com" rel="noopener ugc nofollow" target="_blank">margot@baeol.com</a>']</span></pre><p id="4ca4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">…就是这样。一个新的列表，如果字典中的键碰巧在第二个列表中，则填充这些键。你这么说听起来很简单，对吧？(错误)</p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><p id="8d89" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一般来说，嵌套列表理解(和常规列表理解)非常简洁，是Python的一个有用特性。使用它们已经成为我的第二天性。它们有助于将原本复杂的多行代码功能压缩到一行中。还有什么比这更好的呢？！？</p><p id="4c60" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您正在遍历两个不同的数据结构并比较信息，这将是部署这一独特代码(并给朋友留下深刻印象)的绝佳机会。但它有助于记住我最喜欢的一句关于生活和编程的名言:</p><blockquote class="lt"><p id="999d" class="lu lv hi bd lw lx ly lz ma mb mc js dx translated">“计划不值钱，但规划就是一切。”</p></blockquote><p id="d71d" class="pw-post-body-paragraph iv iw hi ix b iy md ja jb jc me je jf jg mf ji jj jk mg jm jn jo mh jq jr js hb bi translated">不要试图一次编写完整的嵌套python数据结构，也不要为了看看什么有效而把自己逼疯，对于如何编写python嵌套列表，一个更强的策略是制定一个计划。</p><p id="83fd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用上面的3步示例作为蓝图，如果幸运的话，你不会陷入测试每一种可能的方法来循环遍历你的两个迭代器以得到正确的答案。编码快乐！</p></div></div>    
</body>
</html>