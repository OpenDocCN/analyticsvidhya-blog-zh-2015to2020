<html>
<head>
<title>Simple COVID-19 Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单的新冠肺炎数据分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-covid-19-data-analysis-b80aa444e602?source=collection_archive---------27-----------------------#2020-05-06">https://medium.com/analytics-vidhya/simple-covid-19-data-analysis-b80aa444e602?source=collection_archive---------27-----------------------#2020-05-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dce1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名初学数据的科学家，我制定了一个简单的计划来处理新冠肺炎数据，我将在这里介绍这个过程。</p><h1 id="73d9" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">安装/部署软件包:</h1><p id="ee35" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">对于数据分析，我只使用了基本的R包和一些建模包。为了再现性，设置了一个种子。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="9e01" class="kp je hi kl b fi kq kr l ks kt">library(tidyverse)<br/>library(reshape2)<br/>library(hrbrthemes)<br/>library(timeSeries)<br/>library(caret)<br/>library(forecast)<br/>library(lubridate)<br/>library(randomForest)<br/>library(e1071)<br/>library(gbm)<br/>library(DMwR)<br/>theme_set(theme_economist())<br/>set.seed(123)</span></pre></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="fc75" class="jd je hi bd jf jg lb ji jj jk lc jm jn jo ld jq jr js le ju jv jw lf jy jz ka bi translated">分析和清理数据</h1><p id="e3b6" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">数据集来自Kaggle的<a class="ae lg" href="https://www.kaggle.com/c/covid19-global-forecasting-week-4" rel="noopener ugc nofollow" target="_blank"> COVID19全球预测(第4周)</a>挑战赛，他们从约翰·霍普斯金·CSSE那里获得了这些数据。约翰·霍普斯金每天都在更新它的数据，可以很容易地直接从<a class="ae lg" href="https://github.com/CSSEGISandData/COVID-19" rel="noopener ugc nofollow" target="_blank"> GitHub </a>访问。</p><p id="50af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集包含有关正在进行的新冠肺炎疫情的全球信息，其主要关注点是按日期、国家甚至州/省划分的确诊病例和死亡病例。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="fc77" class="kp je hi kl b fi kq kr l ks kt">k.train &lt;- read.csv(“.../Downloads/train.csv”)#Training Data<br/>k.test &lt;- read.csv(".../Downloads/test.csv")#Testing Data</span><span id="a795" class="kp je hi kl b fi lh kr l ks kt">#Make Data Usable<br/>k.train$Province_State &lt;- as.character(k.train$Province_State)<br/>k.train$Country_Region &lt;- as.character(k.train$Country_Region)</span><span id="edf6" class="kp je hi kl b fi lh kr l ks kt">k.test$Province_State &lt;- as.character(k.test$Province_State)<br/>k.test$Country_Region &lt;- as.character(k.test$Country_Region)</span><span id="4945" class="kp je hi kl b fi lh kr l ks kt">k.train$Date &lt;- as.Date(k.train$Date, format = "%Y-%m-%d")<br/>k.test$Date &lt;- as.Date(k.test$Date, format = "%Y-%m-%d")</span><span id="52cf" class="kp je hi kl b fi lh kr l ks kt">k.train$Province_State &lt;- ifelse(k.train$Province_State == "", k.train$Country_Region, k.train$Province_State)<br/>k.test$Province_State &lt;- ifelse(k.test$Province_State == "", k.test$Country_Region, k.test$Province_State)</span><span id="2c0f" class="kp je hi kl b fi lh kr l ks kt">#Show any missing values<br/>colSums(is.na(k.train)) <br/>colSums(is.na(k.test)) <br/>sum(is.na(k.train))</span><span id="55cd" class="kp je hi kl b fi lh kr l ks kt">head(k.train)<br/>tail(k.train)</span><span id="4a1a" class="kp je hi kl b fi lh kr l ks kt">head(k.test)<br/>tail(k.test)</span></pre><div class="kg kh ki kj fd ab cb"><figure class="li lj lk ll lm ln lo paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/787189e6e3b8ecfcbcede6fe07e508b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*Lgu8mlKlIgW-28yG60Ci-g.jpeg"/></div></figure><figure class="li lj lv ll lm ln lo paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/9d5862a4277a018c13b6ac12abf6c3ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*MGNlAimRbclh3cd_SAOSlQ.jpeg"/></div><figcaption class="lw lx et er es ly lz bd b be z dx ma di mb mc translated">培训用数据</figcaption></figure></div><div class="ab cb"><figure class="li lj md ll lm ln lo paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/235d38006e3b05837ff32a21b7e6f0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*s_BoiJILmnfB--DhZXDDGg.jpeg"/></div></figure><figure class="li lj me ll lm ln lo paragraph-image"><img src="../Images/5ef2386fa4ecabf0f7bcd3601be3cc71.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*bXS2TaGU9eWTF1Ii2toqtA.jpeg"/><figcaption class="lw lx et er es ly lz bd b be z dx mf di mg mc translated">测试数据</figcaption></figure></div><p id="1edc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了全球COVID 19信息之外，我还将探索有关饮食预订和美国票房的数据。</p><h1 id="034d" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">形象化</h1><p id="2605" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">由于新冠肺炎是一个全球性问题，我们将首先查看该数据子集。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="kg kh ki kj fd lj er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mj"><img src="../Images/1d20ef02675f5413a970a1503a588488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZtTN-TG2B6rJKAxCt6QLoQ.png"/></div></div></figure><p id="009d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">确诊病例的线图几乎是指数型的，清楚地显示了局势失控的速度。病例的迅速增加因各国的居家命令而受到抑制。通过尝试按国家量化每个锁定的严重性，可以进一步研究这些数据。</p><p id="5d97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，把焦点转移到美国，看看哪些州在死亡人数方面受影响最大是至关重要的。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="kg kh ki kj fd lj er es paragraph-image"><div class="er es mk"><img src="../Images/e0a9613e0992ec2bff7a270b14435c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*qOiW_XKvi9ISNJWQvk7org.png"/></div></figure><p id="f27e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我们可以将数据分组以查看特定的区域，在本例中，这将是美国大西洋中部。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><div class="kg kh ki kj fd ab cb"><figure class="li lj ml ll lm ln lo paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/f44ffddbe1f00c7b7b9fa31391991739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*MfowAMU0e5PUGmnvTsEAVw.png"/></div></figure><figure class="li lj ml ll lm ln lo paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/dc0262f99172a68d95dc4418a7865a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*A1Z72X11Urdik5FfOM4ZtA.png"/></div></figure></div><p id="7424" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要查看流行病对特定州的影响，可以对该州的所有数据点进行分组。此外，要查看新病例和死亡的每日数值，可以向数据集中添加新列。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><div class="kg kh ki kj fd ab cb"><figure class="li lj ml ll lm ln lo paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/b4f0ec1007f6b1dfc1265f3252cf6d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Ca2d77g_Hsnymi9hjO9k-g.png"/></div></figure><figure class="li lj ml ll lm ln lo paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/854a130ad7c928883adaae23ab40ffd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*1fbi1plm2XNv9FmdqMcuzg.png"/></div></figure></div><p id="85f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如所见，黄土曲线被添加到两个图中，这用来显示各个变量之间的局部回归。</p><figure class="kg kh ki kj fd lj er es paragraph-image"><div class="er es mm"><img src="../Images/ad684dba868a468bb5c4098cfcb7cbbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nZ9LL7WR606cXGwI.jpg"/></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">《没时间死》因为病毒已经推迟到11月。</figcaption></figure><p id="211c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了人类健康，新冠肺炎还严重影响了商业。这种疾病影响的一个主要例子是电影业。从电影上映日期被推迟到电影被直接发送到家庭视频，没有一个方面是安全的。一种令人兴奋的可视化影响的方法是查看2019年1月至3月的票房收入，并将其与今年的收入进行比较。数据从<a class="ae lg" href="https://www.boxofficemojo.com/month/by-year/2019/?grossesOption=calendarGrosses" rel="noopener ugc nofollow" target="_blank">票房魔咒</a>手动获取。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="kg kh ki kj fd lj er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mn"><img src="../Images/a44fda4e2da15401bd935fb391b953f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wYe7njqxas0y2eHHHFUafQ.png"/></div></div></figure><p id="f9d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如所见，2020年的初始年收入下降，值得注意的是，2020年4月的收入仅为52，015美元，而2019年的收入为1，034，981，639美元，增长了约20倍。</p><figure class="kg kh ki kj fd lj er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mo"><img src="../Images/e9dfa67aaabf5835c0ee96f4d5d462f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QayUVXlL79r9ZoYh"/></div></div></figure><p id="f103" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个深受新冠肺炎强制检疫影响的行业是餐饮业。OpenTable提供了<a class="ae lg" href="https://www.opentable.com/state-of-industry" rel="noopener ugc nofollow" target="_blank">数据</a>,显示了OpenTable网络上所有渠道的餐厅年复一年的入座客户:在线预订、电话预订和无预约。对于按天进行的年同比比较，它们与上一年同一周的同一天进行比较。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="kg kh ki kj fd lj er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mp"><img src="../Images/038836a389291006840952e3cec780a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jxjSWOtxM8KAp9p0xVqeQ.png"/></div></div></figure><p id="5864" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图表没有骗人。根据OpenTable从3月中旬开始的数据，他们网络中的活动减少了100%,随着美国强制实施封锁，这是可以预料的。</p></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="65c2" class="jd je hi bd jf jg lb ji jj jk lc jm jn jo ld jq jr js le ju jv jw lf jy jz ka bi translated">预测和模型</h1><p id="5155" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">回到Kaggle提供的数据集，可以制作模型来预测确诊病例和死亡人数的增加/减少。我使用了四个模型来预测到该日期的任何批准的实例。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="1ba9" class="kp je hi kl b fi kq kr l ks kt">##NY Data<br/>ny &lt;- k.train %&gt;% dplyr::filter(Country_Region == “US” &amp; Province_State==”New York”) %&gt;% <br/> dplyr::filter(Date &gt;=”2020–03–05")</span><span id="92b0" class="kp je hi kl b fi lh kr l ks kt">ny.test &lt;- k.test %&gt;% dplyr::filter(Country_Region == “US” &amp; Province_State==”New York”)</span></pre><p id="353c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个模型是广义线性模型或GLM。该模型将基础线性模型链接到响应变量，在这种情况下，响应变量将是确认的病例。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="2ea7" class="kp je hi kl b fi kq kr l ks kt">##GLM<br/>glm &lt;- glm(ConfirmedCases~ Date, data=ny)<br/>summary(glm)<br/>pred.glm &lt;- predict(glm,ny.test)<br/>pred.glm &lt;- as.data.frame(pred.glm)</span></pre><p id="a722" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用的下一个模型是支持向量机模型或SVM，这个模型在超平面或接近无限的空间中进行回归分析/赋值。在这个超平面中，模型将理想地找出异常值，并对变量进行适当的分类。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="b21b" class="kp je hi kl b fi kq kr l ks kt">##SVM<br/>svm.model &lt;- svm(ConfirmedCases ~ Date, data = ny)<br/>summary(svm.model)<br/>pred.svm &lt;- predict(svm.model, newdata = ny.test)<br/>pred.svm &lt;- as.data.frame((pred.svm))</span></pre><p id="7dc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在使用SVM之后，我使用相同的变量组合创建了一个随机森林模型。随机森林通过为回归或分类任务创建决策树来工作。随机决策树纠正了决策树过度适应数据的习惯。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="8028" class="kp je hi kl b fi kq kr l ks kt">##Random Forest<br/>rf.model &lt;- randomForest(ConfirmedCases~ Date, data = ny)<br/>summary(rf.model)<br/>rf.predict &lt;- predict(rf.model, ny.test)<br/>rf.predict &lt;- as.data.frame((rf.predict))</span></pre><p id="f345" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用的最后一个模型，也是出于好奇，是一个梯度推进模型或GBM。该模型通过生成弱预测模型集合形式的预测模型来解决分类和回归问题。总体目标是尝试将所有较弱的关联联系起来。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="8e4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在对每个模型进行训练后，我用它们预测了43个时间段(2020年4月2日-2020年5月14日)的确诊新冠肺炎病例，使用的是Kaggle测试数据。我还使用了来自<a class="ae lg" href="https://covidtracking.com/data/state/new-york" rel="noopener ugc nofollow" target="_blank">新冠肺炎跟踪项目</a>的另一组数据来找出每个模型的误差。</p><figure class="kg kh ki kj fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="24bc" class="kp je hi kl b fi kq kr l ks kt">[1] "GLM: "</span><span id="3493" class="kp je hi kl b fi lh kr l ks kt">&gt;DMwR::regr.eval(pred.glm.error,nycConfirmedCases$ConfirmedCases)<br/>              mae          mse         rmse         mape<br/>3.442320e+05 4.696230e+09 6.852904e+04 1.833325e+00</span><span id="f07d" class="kp je hi kl b fi lh kr l ks kt">&gt; print(paste("SVM: ")) <br/>[1] "SVM: " <br/>&gt; DMwR::regr.eval(pred.svm.error,nycConfirmedCases$ConfirmedCases) mae          mse         rmse         mape <br/>1.929837e+05 1.810168e+09 4.254607e+04 9.352455e-01&gt;</span><span id="ecf0" class="kp je hi kl b fi lh kr l ks kt">&gt;print(paste("RF: ")) <br/>[1] "RF: " <br/>&gt; DMwR::regr.eval(rf.predict.error,nycConfirmedCases$ConfirmedCases) mae          mse         rmse         mape <br/>8.941814e+04 3.756527e+08 1.938176e+04 4.436796e-01</span><span id="5959" class="kp je hi kl b fi lh kr l ks kt">&gt; print(paste("GBM: ")) <br/>[1] "GBM: " <br/>&gt;DMwR::regr.eval(boost.predict.error,nycConfirmedCases$ConfirmedCases) <br/>mae          mse         rmse         mape <br/>7.027998e+06 1.286084e+12 1.134056e+06 1.120166e+04</span></pre><p id="2e3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">均方根误差或RMSE在1.938176e+04时是随机森林模型的最佳值。然而，重要的是要注意，在大的情况下，这个误差太大了，并且永久地阻止了这个随机森林模型用于进一步的预测。它需要通过数据争论或改进模型参数来改进。</p></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="580c" class="jd je hi bd jf jg lb ji jj jk lc jm jn jo ld jq jr js le ju jv jw lf jy jz ka bi translated">改进和最终想法</h1><p id="91f3" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">对于世界来说，新冠肺炎是一个需要处理的复杂问题，主要是因为每个人都毫无准备。在这种情况下，一个重要的积极方面是，人们共同努力分析数据，以便能够克服整体状况，并充分解决未来的类似问题。对于这种数据分析的范围来说，还有很大的改进空间。我可以尝试找到更多可以与潜在响应变量进行反应的功能，甚至可以简单地在更广泛的数据集上部署一个模型。对这种分析的另一个改进是更高级的数据转换，这样我就可以揭露任何不明显的关系。正确的答案可能只是更好的型号选择，我希望今后能了解这类信息。</p></div></div>    
</body>
</html>