<html>
<head>
<title>Simple Weighted Average Ensemble | Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单加权平均集成|机器学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-weighted-average-ensemble-machine-learning-777824852426?source=collection_archive---------4-----------------------#2020-10-14">https://medium.com/analytics-vidhya/simple-weighted-average-ensemble-machine-learning-777824852426?source=collection_archive---------4-----------------------#2020-10-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bb6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个关于如何应用加权平均集成来提高预测分数的演练。</p><blockquote class="jd je jf"><p id="82bf" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">本博客的目的</em> </strong></p><p id="4445" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">上周，我的一个机器学习课堂作业要求我们通过组合来自各种算法的预测来执行集合预测。我发现这个话题很吸引人。但是网上能简单解释这个概念的资料并不多。所以，我决定写这篇博客给那些正在尽我最大努力寻找<strong class="ih hj">一个简单的解决方案</strong>的人们。</p><p id="0b71" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">在我对这个主题的研究中，我发现在线文章中有许多不同的风格和方法来实际执行预测模型的加权平均。如果你觉得你想更多地了解这个主题，并想更深入地研究他们的演示背后的算法和数学原理，我鼓励你做更多的研究，并阅读那些发表的关于加权平均集成应用的论文。</p><p id="590c" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">我在网上找到的一篇论文很好地解释了如何在一个案例中应用加权平均系综，这篇论文是由Nivedhitha Mahendran和他来自多所大学的队友们完成的。你可以通过这个<a class="ae jk" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6891280/" rel="noopener ugc nofollow" target="_blank">链接</a>找到文章。</p></blockquote><h1 id="9d84" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">内容表</h1><p id="3cf7" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated"><a class="ae jk" href="#48b7" rel="noopener ugc nofollow"> <em class="jg">简介&amp;一般用法</em> </a></p><p id="ab23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jk" href="#d3c0" rel="noopener ugc nofollow"> <em class="jg">案例走查</em> </a></p><p id="d68b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jk" href="#2f01" rel="noopener ugc nofollow"> <em class="jg">结论</em> </a></p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><h1 id="44a0" class="jl jm hi bd jn jo kv jq jr js kw ju jv jw kx jy jz ka ky kc kd ke kz kg kh ki bi translated"><strong class="ak">简介&amp;一般用法</strong></h1><h2 id="48b7" class="la jm hi bd jn lb lc ld jr le lf lg jv iq lh li jz iu lj lk kd iy ll lm kh ln bi translated">不要把鸡蛋放在一个篮子里</h2><p id="427a" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">平均集成或加权平均集成的基本思想是通过聚集来自多个不同分类器的预测来减少总误差。基本原理是:我们首先假设每个分类器在训练和预测中都会犯不同的错误。然后，我们生成一组具有多种多样性的分类器，并将它们的输出组合在一起。因此，在我们进行汇总后，最终预测的总误差会有所下降。</p><p id="e621" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这真的很像多元化的概念:你不要把鸡蛋放在一个篮子里。当你将资金投入股市时，你会希望建立一个包含不同行业项目的投资组合。如果一个部门表现不佳，损失将由其他部门的收益来平衡。遭受重大财务损失的风险将会降低。</p><h2 id="1edc" class="la jm hi bd jn lb lc ld jr le lf lg jv iq lh li jz iu lj lk kd iy ll lm kh ln bi translated">背后的简单数学</h2><p id="8979" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">假设您有一组五个分类器。假设分类器都是独立的，你会发现它们每个都可能产生0.2的误差。集成分类器在一个实例上出错的情况是5个分类器中至少有3个一起出错(多数投票)。因此，错误预测的概率计算如下:</p><p id="2220" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5中3的组合出问题是10；</p><p id="26ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5中4的组合出问题是5；</p><p id="5b18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而5个都出问题的组合就是1。</p><figure class="lp lq lr ls fd lt er es paragraph-image"><div class="er es lo"><img src="../Images/d67f295b26abd8afe1ccf3da13eaae04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*wV2ohNiZsn-o0dCULvWXag.png"/></div></figure><p id="a9bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，总误差从0.2降至0.058；然而，当您将更多的分类器添加到组合中时，您应该会遇到瓶颈，错误减少的趋势将趋于平稳。</p><h2 id="d253" class="la jm hi bd jn lb lc ld jr le lf lg jv iq lh li jz iu lj lk kd iy ll lm kh ln bi translated">如何直观地实现一个</h2><p id="15b7" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">通常有两种方法。</p><p id="38ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，在训练数据的多个不同子集上训练相同的分类器(例如，决策树)，这导致多个不同的模型(DT1、DT2、DT3、…)。然后，用这些模型预测测试数据，并对结果进行平均(图1.1)。</p><figure class="lp lq lr ls fd lt er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es lw"><img src="../Images/6a84cc0abef3f58215b97c896602594b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oJKi_Xdle5qXjv_XgIKExA.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">图1.1蒋金航绘制</figcaption></figure><p id="e501" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二，你可以用整个训练集训练多个不同的(越多样化越好)分类器，并对结果取平均值(图1.2)。</p><figure class="lp lq lr ls fd lt er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mf"><img src="../Images/6fe01a4e6c7d32c108ecd2d77715d72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UrmG9r6dc2I_ouwtadrWnQ.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">图1.2蒋金航绘制</figcaption></figure><p id="7054" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击<a class="ae jk" href="#2b07" rel="noopener ugc nofollow">此处</a>返回页首。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><h1 id="d3c0" class="jl jm hi bd jn jo kv jq jr js kw ju jv jw kx jy jz ka ky kc kd ke kz kg kh ki bi translated">案例走查</h1><h2 id="6fee" class="la jm hi bd jn lb lc ld jr le lf lg jv iq lh li jz iu lj lk kd iy ll lm kh ln bi translated">数据</h2><p id="d830" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">我用一个五年前发生在Kaggle上的案例比赛作为例子，你可能会在这里找到所有的数据和案例描述<a class="ae jk" href="https://www.kaggle.com/c/homesite-quote-conversion" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="fe5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，我们需要预测哪个Homesite的客户将购买给定的报价。目标变量是二进制的，要么是0(未购买)，要么是1(报价已转换)。</p><p id="5336" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将跳过所有的数据清理部分，因为这不是我们在这个博客的重点。我最终的训练数据有65000行× 596列。我最终的测试数据有173836行× 595列。所有的分类变量都被转换成数字数据。在预测概率和观察目标之间的ROC曲线下的<a class="ae jk" href="http://en.wikipedia.org/wiki/Receiver_operating_characteristic" rel="noopener ugc nofollow" target="_blank">区域对提交进行评估。</a></p><h2 id="aea7" class="la jm hi bd jn lb lc ld jr le lf lg jv iq lh li jz iu lj lk kd iy ll lm kh ln bi translated">密码</h2><p id="9e58" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">在这种情况下，我实现了五个模型:</p><p id="bdba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jg"> KNN、MLPC、XGBoost、决策树、随机森林</em> </strong></p><p id="d634" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将在不调整任何参数的情况下比较单个分类器和集成分类器之间的结果。</p><p id="ea30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步</strong>:加载所有的库和包(使用“pip install<em class="jg">package _ name</em>来安装您没有的分类器)</p><figure class="lp lq lr ls fd lt"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="bdf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步</strong>:用我们的训练数据拟合每个模型</p><figure class="lp lq lr ls fd lt"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="45e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图2.1显示了每个分类器基本性能的Kaggle分数。</p><figure class="lp lq lr ls fd lt er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mi"><img src="../Images/2431493a471fb767882713dd8ade4dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*euoBk5rkpee4_wySStrHaQ.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">图2.1单个模型的性能</figcaption></figure><p id="3bab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步</strong>:测试平均值和加权平均值法</p><figure class="lp lq lr ls fd lt"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="b9aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图2.2显示了集合方法的Kaggle分数:</p><figure class="lp lq lr ls fd lt er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mj"><img src="../Images/9592bf36465d93a401239b535712b169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qoEcIigOtlwcxlqad-qR6Q.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">图2.2集合方法的Kaggle分数</figcaption></figure><p id="cda3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如你所见，加权平均集成在这个案例竞争中胜过所有其他分类器。ROC得分从最差表现(KNN)上升了大约0.38，这是一个巨大的跳跃。加权平均集成方法甚至优于我们的最佳个体模型(XGB分类器)0.045。这在任何情况下的竞争中都是一个显著的增加，尤其是当卡格勒人总是喜欢推动极端的时候。</p><p id="21b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，在这段代码中，我根据经验手动为模型分配权重。如果你想知道什么是权重的“最优”决策，这里有一个超参数调整你的集成的指南:<a class="ae jk" href="https://jinhangjiang.medium.com/hyperparameter-tuning-the-weighted-average-ensemble-in-python-cff2100f0832" rel="noopener">超参数调整Python中的加权平均集成</a>。</p><p id="db78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击<a class="ae jk" href="#2b07" rel="noopener ugc nofollow">此处</a>返回页首。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><h1 id="2f01" class="jl jm hi bd jn jo kv jq jr js kw ju jv jw kx jy jz ka ky kc kd ke kz kg kh ki bi translated">结论</h1><p id="0375" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">这只是一个关于使用多个不同模型执行加权平均集合预测的超级简单的演练。正如我上面所说的，组合越多样化，结果可能就越好。一个例子是:您可以在组合中添加一些线性回归模型，这样线性回归就有可能捕捉到变量之间的线性关系。</p><p id="2c10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，有时候事情并不是这样发展的。这只是五年前的一个例子。许多五年前看起来很难的问题今天会看起来容易得多，因为市场上刚刚出现了更具挑战性的问题。在我处理的一些案例中，无论我尝试多少种不同的权重组合，这种技术都无法超越我最好的个人模型。尽管如此，这个技巧总是帮助我避免过度适应的好方法。</p><p id="6320" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jg">请随时与我联系</em></strong><a class="ae jk" href="https://www.linkedin.com/in/jinhangjiang/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="jg">LinkedIn</em></strong></a><strong class="ih hj"><em class="jg">。</em>T19】</strong></p><h1 id="8efa" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">相关阅读</h1><p id="faf2" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated"><a class="ae jk" href="https://jinhangjiang.medium.com/hyperparameter-tuning-the-weighted-average-ensemble-in-python-cff2100f0832" rel="noopener">超参数调谐Python中的加权平均系综</a></p></div></div>    
</body>
</html>