<html>
<head>
<title>A Model-Based Approach to Build a Recommendation Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种基于模型的推荐引擎构建方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-model-based-approach-to-build-a-recommendation-engine-1519d347cd22?source=collection_archive---------1-----------------------#2019-07-25">https://medium.com/analytics-vidhya/a-model-based-approach-to-build-a-recommendation-engine-1519d347cd22?source=collection_archive---------1-----------------------#2019-07-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e127" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">这是</em> <a class="ae je" href="https://datahack.analyticsvidhya.com/contest/build-a-recommendation-engine-powered-by-ibm-cloud/" rel="noopener ugc nofollow" target="_blank"> <em class="jd"> IBM的推荐引擎挑战赛</em> </a> <em class="jd">的入门指南。本文由IBM的</em><a class="ae je" href="https://www.linkedin.com/in/rajeshjeyapaul/?originalSubdomain=in" rel="noopener ugc nofollow" target="_blank"><em class="jd">Rajesh K jeya Paul</em></a><em class="jd">撰写。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/106738ffd6bb6b774b7f91199fe987d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wHp3S5fhMpXDcxm7eulJPw.jpeg"/></div></div></figure><p id="f4ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">推荐引擎现在无处不在。世界各地的企业正在围绕这些系统创建完整的战略，以改善和增强客户体验。事实证明，这是组织的制胜之举。</p><p id="4dcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">了解推荐引擎的工作原理并构建一个推荐引擎是数据科学家的必备技能。</p><p id="bd2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习是一个优化问题，构建推荐引擎也是一个优化问题。推荐引擎可以灵活地采用基于记忆(非模型)的方法，如基于用户和基于项目的相似性方法，但是用户和项目之间的协作也可以采用基于模型的方法。</p><p id="8b05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可能是一个众所周知的事实，因为有很多内容都在讨论这个问题。在本文中，我将介绍基于模型的协同过滤中的基本优化，尤其是矩阵分解方法，并帮助您理解特定数据集如何适合这种方法。</p><p id="710c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将理解为什么机器学习是一个优化问题。</p><h1 id="2a73" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">机器学习——一个优化问题</strong></h1><p id="afed" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">给定下面的数据集，你能找到给定方程的B0和B1的系数值吗？</p><p id="b594" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd"> y=f(x) <br/>体重= B0+B1 *身高</em> </strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ku"><img src="../Images/b543a653538a5f0e982bcc6b2116ee2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*adKv3NNkKO912yOvMZESXA.png"/></div></div></figure><p id="9ea6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以做出假设，并被鼓励以一个随机值开始旅程。花5秒钟时间继续。</p><p id="bc8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你得到B0和B1的值了吗？</p><p id="853a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，我听到有人说B0 =0，B1=5。感谢你的开始…正如我提到的，你可以做假设，在这种情况下，B0=0，开始</p><p id="706b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">具有任意随机值的旅程，在本例中，B1=5。我们可以试着把这个代入给定的方程吗？</p><p id="c0c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们取身高=180</p><p id="18ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重量= 0 + 5 * 180 = 900 </strong></p><p id="cec1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，对应的体重是86，不是900。因此，下一步是优化B1值。我们可以尝试用4或2或任何其他随机值。让我们取B1=0.5，再次适合算法。</p><p id="3923" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重量= 0 + 0.5 *180 = 90 </strong></p><p id="1ea2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">啊哈，现在我们接近实际体重了，86。现在误差也减小了(90–86)。</p><p id="b2f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是机器学习中的优化之旅。在这种情况下，为给定方程(在这种情况下为线性方程)找到最佳的系数值(称为权重),导致模型的更好性能。</p><p id="90ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">等等，你的旅程还没有结束…你能试着为下面的数据集拟合你的系数值B1=0.5吗？</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kv"><img src="../Images/0361ec684ed76dcf4a9c5f52b19f63b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*Q_c0buVwFWKEOKRW5SLA8g.png"/></div></figure><p id="611a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">体重= 0+ 0.5 (3800) = 1900，并不是实际体重200…怎么回事..？</p><p id="dbad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们有这样奇怪的数据集，这将是实际的行为。因此，这表明数据预处理在使模型更有效方面起着关键作用。在这种情况下，我们可以将上述数据点视为异常值并将其丢弃。</p><p id="6126" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般情况下，我们处理的数据点会有这种行为，并认为是非凸性质的。</p><p id="0541" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以进一步微调B1=0.5的值。</p><p id="997b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个试图达到最优值的旅程可以被称为“随机梯度下降”(SGD)</p><p id="74e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在理解了机器学习是一个优化问题之后，我们将把注意力转向理解推荐系统中的类似优化。</p><h1 id="90fa" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">协同过滤在推荐系统中的作用</strong></h1><p id="02c3" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">协同过滤处理用户-项目关系的过去行为。例如，像星级评定、评论、通过拇指向上/向下的偏好这样的显式反馈，以及像购买历史、鼠标移动等这样的一些隐式反馈。</p><p id="3866" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果数据完整，有看得见的模式，那么我们就很容易预测和推荐。例如，以下面的场景为例:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kw"><img src="../Images/100e6d86e6922d1edb8016ea2cf1e295.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*PJWx4LBlnBIRCiJ9qzCh9g.png"/></div></figure><p id="2013" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我让你预测电影4 (M4)的评分，很简单:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kx"><img src="../Images/0a93835e1db32d409144ce780fb8c546.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*l9s0SV-ML3o-CXuUg-leOg.png"/></div></figure><p id="d2a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，以下面的场景为例:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ky"><img src="../Images/3f6ec5093fc3b26701eb3d584ee5ef15.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*hj--mE4rCXEH4E7tTiHxIQ.png"/></div></figure><p id="238a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这也可能相对容易，因为它有一个模式:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kz"><img src="../Images/dd5c46014661f35f59bb93553786ae22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*3y3ruCfNuGJr2Iv2LGYKPw.png"/></div></figure><p id="89c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们可以将评级视为:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es la"><img src="../Images/45422861db7f87c6966f75cb3fd8dd2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*nb7ak3Zeo2EOMfLRVSKImA.png"/></div></figure><p id="fd4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是我们知道我们的数据是杂乱的，并且表现为以下方式:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lb"><img src="../Images/fc1f79dc3b2eb3ad9d286026e35d5224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytJFLIlQoSDaX3gOCx0UkQ.png"/></div></div></figure><p id="7c13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它只不过是一个稀疏矩阵，这就是为什么我们再次回来，通过优化来解决这个问题，将数据的非凸性质转换为凸性质。</p><p id="fa83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">顺便说一句，这种稀疏矩阵是因为我们只在进行任何在线购买时的行为。下次为了避免这个问题，试着给你买的所有产品打分(开玩笑的！).</p><p id="1b42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，这个问题的答案是“矩阵分解”。协同过滤有矩阵分解和向量分解两种方法来解决这个问题。</p><p id="a980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们来讨论矩阵因式分解部分。什么是矩阵分解？</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lc"><img src="../Images/dc7ca8ff64a3cb488282996eef2f4987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*B6GMxzEd4Pu5A8zJ1PofeA.png"/></div></figure><p id="1473" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将反过来理解这一点，如何分解一个完整的秩矩阵，然后如何通过优化我们可以达到目标秩。</p><p id="ab19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">采用以下等级矩阵，用户项目评级:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ld"><img src="../Images/f252b3e6f81338dfa4cafa09838b26f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*kf2r3VUmIld_-pFx2JCuRQ.png"/></div></figure><p id="a19d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了分解这一点，我们需要创建用户和项目共有的两个基于特征的“因子”。你能猜出电影等级矩阵有哪些特征吗？大概是喜剧和动作片？</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es le"><img src="../Images/b248b012dd8680e9f0d9cfaf83075958.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*bIMyet3w9CdrJkVKJcqXig.png"/></div></figure><p id="d489" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们为这两个功能创建了基于用户的排名:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lf"><img src="../Images/156cbf362405293ee2d23599491574ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*9IRQElPXU7LQ7Bzi5FBFcQ.png"/></div></figure><p id="13a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们得到了这两个功能的电影排名。让我们来看看矩阵分解的全貌。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lg"><img src="../Images/531fb15e49df5dcd0b2c665bbad39d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*koS1AyvY0tv3SZfVIQweqw.png"/></div></div></figure><p id="9d5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">毫不奇怪，秩矩阵是通过叉积使用这两个基于特征的矩阵重新构建的。</p><p id="6c7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用户1 (U1)对电影1 (M1)的评分= 3 = 1*3 + 0*1 =3 </strong></p><p id="ae50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如何导出那些基于特征的矩阵？我们必须回到我们的ML优化技术:</p><ul class=""><li id="65a0" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">从某处开始，取一个随机值</li><li id="79cb" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">假设一下</li></ul><p id="8114" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看下面的场景，我们从随机值开始:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lv"><img src="../Images/a8d1dd7c099dbdaa9fe3be2dc8a9de7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtxpovgVa2rgc89k1phl-w.png"/></div></div></figure><p id="ca30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们采用了随机值，并试图达到目标，并基于误差即兴进一步优化它。</p><p id="558d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，用户1 (U1)对电影1(M1)的评分是3，这是我们的目标，但实际值是1.92。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lw"><img src="../Images/ffe8f81582a0bfefb003aed5ee8cdafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*87Jrh7XQ_-8iAiuGNdCBhg.png"/></div></figure><p id="561b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">优化有助于我们减少达到最佳值的误差。以这种方式，可以逼近稀疏矩阵来构建最优秩矩阵。</p><p id="5fa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，在因子分解过程中，我们可以使一个因子矩阵稳定，比如说用户因子，并修改项目因子。这个过程是相反的，使我们得到一个替代的优化方法，称为<strong class="ih hj">替代最小二乘</strong> (ALS)。</p><p id="2ca0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">旅程不止于此。给定如下数据集，没有排名，那么起点是什么？如何建立秩矩阵？</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lx"><img src="../Images/1cce898a5bffd3d6f112f0a4932e174f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FlGzdjCqmYU8h9VtYpSsdw.png"/></div></div></figure><p id="5069" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以根据购买物品的频率(数量)创建等级吗？还是基于人气？还是一个虚拟矩阵？</p><p id="a6c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决这一问题的方法之一是创建一个等级矩阵，并继续进行基于模型的CF或基于记忆的CF来为用户预测前“n”个项目。</p><p id="f2d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的链接提供了为每个用户购买的商品创建排名的详细信息:这将帮助您创建一个基线模型，并使您能够在正在进行的练习题中提交代码。详情如下:</p><ul class=""><li id="4da1" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">基线模型实现步骤:<a class="ae je" href="https://bit.ly/" rel="noopener ugc nofollow" target="_blank"> https://bit.ly </a> /AVlab</li><li id="4c33" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">推荐引擎在线挑战:<a class="ae je" href="https://ibm.biz/buildRE" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">https://ibm.biz/buildRE</strong></a></li></ul></div></div>    
</body>
</html>