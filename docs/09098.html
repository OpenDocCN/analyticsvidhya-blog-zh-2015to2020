<html>
<head>
<title>A simple way to build your own 3D map with Coloured LIDAR point clouds using xyzspaces</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 xyzspaces 使用彩色激光雷达点云构建您自己的 3D 地图的简单方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-simple-way-to-build-your-own-3d-map-with-coloured-lidar-point-clouds-using-xyzspaces-5b3ca6e43d48?source=collection_archive---------10-----------------------#2020-08-25">https://medium.com/analytics-vidhya/a-simple-way-to-build-your-own-3d-map-with-coloured-lidar-point-clouds-using-xyzspaces-5b3ca6e43d48?source=collection_archive---------10-----------------------#2020-08-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/738bc22783c23a81d9bdb75043db51b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pWA__4AFk1vWPPJxA7SSbw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">旧金山金门大桥彩色激光雷达数据</strong></figcaption></figure><p id="955e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在分析激光雷达数据时，可视化激光雷达点云数据是一个重要的部分。用于对激光雷达数据点进行着色和可视化的大多数方法都涉及许多步骤，并且需要 QGIS 等工具的知识。因此，今天我们将看到一种简单的方法来使用<a class="ae jt" href="https://github.com/heremaps/xyz-spaces-python" rel="noopener ugc nofollow" target="_blank"> xyzspaces </a>对激光雷达点云数据进行着色，并使用<a class="ae jt" href="https://github.com/heremaps/harp.gl" rel="noopener ugc nofollow" target="_blank"> Harp.gl </a>以简单的方式将其可视化。</p><p id="cdb5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用 Python 作为本教程的编码语言。我们将需要一套 python 库，下面是包的列表，你可以用 pip 命令轻松安装它们。</p><ul class=""><li id="68c3" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated"><a class="ae jt" href="https://pypi.org/project/xyzspaces/" rel="noopener ugc nofollow" target="_blank"> xyzspaces </a></li><li id="4466" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae jt" href="https://pypi.org/project/rasterio/" rel="noopener ugc nofollow" target="_blank">拉斯特里奥</a></li><li id="b98b" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae jt" href="https://pypi.org/project/pandas/" rel="noopener ugc nofollow" target="_blank">熊猫</a></li><li id="ac1e" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae jt" href="https://pypi.org/project/scipy/" rel="noopener ugc nofollow" target="_blank"> scipy </a></li><li id="772a" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae jt" href="https://pypi.org/project/geojson/" rel="noopener ugc nofollow" target="_blank"> geojson </a></li></ul><p id="61b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是如何使用彩色激光雷达点构建您自己的 3D 地图。让我们为旧金山的<a class="ae jt" href="https://user-images.githubusercontent.com/30625612/91130314-14ccc300-e6c9-11ea-9d43-e2e655611aaf.jpeg" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">冬青公园</strong> </a> <strong class="ix hj">做一个吧。</strong></p><p id="bc34" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们获取一些数据，我们将使用一个奇妙的资源，那就是 NOAA 网站。我们需要 NOAA 网站上的两种数据类型，一种是高程数据(激光雷达数据)，另一种是影像数据(颜色数据)。</p><h2 id="6d43" class="ki kj hi bd iu kk kl km kn ko kp kq kr jg ks kt ku jk kv kw kx jo ky kz la lb bi translated"><a class="ae jt" href="https://coast.noaa.gov/dataviewer/#/lidar/search/-13627862.786520233,4542209.2338303095,-13627595.462196458,4542531.609236469" rel="noopener ugc nofollow" target="_blank">高程数据源</a></h2><p id="6300" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">使用上面的链接到 NOAA 海拔网站，选择<strong class="ix hj"> 2010 ARRA 激光雷达:金门(CA) </strong>并将其添加到购物车。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/a7b20eb0afe8910757d16decae3d6c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bc3goqWxyncfKSN0_KIB0g.png"/></div></div></figure><h2 id="dc02" class="ki kj hi bd iu kk kl km kn ko kp kq kr jg ks kt ku jk kv kw kx jo ky kz la lb bi translated"><a class="ae jt" href="https://coast.noaa.gov/dataviewer/#/imagery/search/-13627862.786520233,4542209.2338303095,-13627595.462196458,4542531.609236469" rel="noopener ugc nofollow" target="_blank">影像数据源</a></h2><p id="ce4a" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">使用以上链接访问 NOAA 图像网站，选择<strong class="ix hj"> 2016 NAIP 4 波段 8 位图像:加州海岸</strong>并将其添加到购物车中。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/8dc058581f06cf5a69bd3e4f93ebae13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VL4ru1HIa5sw2IK4fqYdew.png"/></div></div></figure><p id="ffb6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，单击右上角的购物车，这将显示您已经添加到购物车中的数据，然后单击下一步。</p><p id="939d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，在“Provision your data”屏幕中为每个数据更改一些设置，如下图所示，因为这将有助于我们稍后轻松可视化数据。</p><div class="li lj lk ll fd ab cb"><figure class="lm ij ln lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/63172471cfd52c83c8233de6215cb4de.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*mYu8T5SFEhOL-uuydJRuVw.png"/></div></figure><figure class="lm ij ls lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/74945f56de46e2cd7cf04849b3fd0606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*T2Vmyh1OuJlj9_EzkYcbfA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx lt di lu lv translated">激光雷达和影像数据的“调配数据”设置</figcaption></figure></div><p id="c4aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">之后，点击“下一步”,输入您的电子邮件 ID 并提交订单。您将收到来自 NOAA 的两封电子邮件，其中包含激光雷达数据和影像文件的下载链接。</p><p id="41cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们开始一些编码！！！</p><p id="0985" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们需要解压缩从 NOAA 获得的激光雷达数据和图像文件的 zip 文件。</p><h2 id="76a7" class="ki kj hi bd iu kk kl km kn ko kp kq kr jg ks kt ku jk kv kw kx jo ky kz la lb bi translated">处理影像数据</h2><p id="c2fb" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">对于解压缩文件夹中的影像数据，您会看到多个文件，但我们只需要一个文件，即。tiff 文件，我们将从中提取颜色数据，这实际上是。tiff 文件以及与颜色像素相关联的纬度和经度。我们将在这里使用 rasterio 来简化事情。</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="8809" class="ki kj hi lx b fi mb mc l md me">import rasterio as rio<br/>from affine import Affine</span><span id="82e3" class="ki kj hi lx b fi mf mc l md me">with rio.open('/Users/omestry/Downloads/Imagery_ISLAND_NEW/Job561243_2016_4BandImagery.tif') as imagery_data:<br/>    T0 = imagery_data.transform<br/>    T1 = T0 * Affine.translation(0.5, 0.5)<br/>    pixel2coord = lambda c, r: (c, r) * T1<br/>    width = imagery_data.width<br/>    height = imagery_data.height<br/>    generate_colour_data(width, height, imagery_data, pixel2coord)</span></pre><p id="436e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的代码提取了。tiff 文件并将其传递给函数<strong class="ix hj"> generate_colour_data </strong>,该函数将以如下格式将颜色数据填充到一个列表中</p><p id="db1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[经度，纬度，红色，绿色，蓝色，阿尔法]</p><p id="99b1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是 generate_colour_data 函数的实现</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="aba3" class="ki kj hi lx b fi mb mc l md me">colour_data = []</span><span id="414c" class="ki kj hi lx b fi mf mc l md me">def generate_colour_data(width, height, imagiry_data, pixel2coord):<br/>    for i in range(1, height):<br/>        for j in range(1, width):<br/>            colour_data.append(<br/>                [<br/>                    pixel2coord(j, i)[0],<br/>                    pixel2coord(j, i)[1],<br/>                    imagiry_data.read([1])[0][i - 1][j - 1],<br/>                    imagiry_data.read([2])[0][i - 1][j - 1],<br/>                    imagiry_data.read([3])[0][i - 1][j - 1],<br/>                    imagiry_data.read([4])[0][i - 1][j - 1],<br/>                ]<br/>            )</span></pre><p id="9875" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，让我们使用<a class="ae jt" href="https://pypi.org/project/xyzspaces/" rel="noopener ugc nofollow" target="_blank"> xyzspaces </a>包将生成的颜色数据添加到 DataHub 空间，这样我们以后就可以利用 DataHub 的搜索功能。</p><p id="279c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要使用 xyzspaces，您需要一个 DataHub 令牌。以下是关于如何生成数据中心令牌的链接:-【https://www.here.xyz/api/getting-token/ T4】</p><p id="a6b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦你有数据中心令牌，我们需要创建一个空间。使用以下代码创建一个数据中心空间</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="c37c" class="ki kj hi lx b fi mb mc l md me">import xyzspaces as xyz</span><span id="5de8" class="ki kj hi lx b fi mf mc l md me">xyz_token = "[YOUR-XYZ-TOKEN]"<br/>xyz = xyz.XYZ(credentials=xyz_token)</span><span id="2c15" class="ki kj hi lx b fi mf mc l md me">title = "LIDAR COLOR DATA"<br/>description = "LIDAR COLOR DATA"</span><span id="1b24" class="ki kj hi lx b fi mf mc l md me">space = xyz.spaces.new(title=title, description=description)</span></pre><p id="2c74" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦我们创建了一个<strong class="ix hj">空间</strong>，我们就可以使用以下代码以优化的方式将颜色数据编写为 geojson 特性，我们将使用 python 的多处理特性来执行多线程。</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="06ce" class="ki kj hi lx b fi mb mc l md me">import concurrent.futures<br/>import time<br/>from functools import partial<br/>from multiprocessing import Manager, Process</span><span id="7d56" class="ki kj hi lx b fi mf mc l md me">from geojson import Feature, Point<br/>from xyzspaces.utils import grouper</span><span id="ba22" class="ki kj hi lx b fi mf mc l md me">manager = Manager()</span><span id="4ecb" class="ki kj hi lx b fi mf mc l md me">def upload_features(features, space):<br/>    fc = []<br/>    try:<br/>        for data in features:<br/>            if data:<br/>                lat, lng = data[1], data[0]<br/>                f = Feature(<br/>                    geometry=Point((lng, lat)),<br/>                    properties={<br/>                        "R": float(data[2]),<br/>                        "G": float(data[3]),<br/>                        "B": float(data[4]),<br/>                    },<br/>                )<br/>                fc.append(f)<br/>        feature_collection = dict(type="FeatureCollection", features=fc)<br/>        space.add_features(features=feature_collection)<br/>        time.sleep(3)<br/>    except Exception as e:<br/>        print(e)</span><span id="5996" class="ki kj hi lx b fi mf mc l md me">features_size = 1000</span><span id="7820" class="ki kj hi lx b fi mf mc l md me">groups = grouper(features_size, colour_data)</span><span id="e3d4" class="ki kj hi lx b fi mf mc l md me">part_func = partial(upload_features, space=space)</span><span id="2829" class="ki kj hi lx b fi mf mc l md me">with concurrent.futures.ProcessPoolExecutor() as executor:<br/>    executor.map(part_func, groups, chunksize=3)</span></pre><p id="a42e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们的图像数据已经准备好了，我们将在后面的步骤中使用生成器空间。</p><h2 id="a2f2" class="ki kj hi bd iu kk kl km kn ko kp kq kr jg ks kt ku jk kv kw kx jo ky kz la lb bi translated">处理激光雷达数据</h2><p id="603d" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">对于解压缩文件夹中的激光雷达数据，您会看到多个文件，但我们只需要一个文件，即。txt 文件，实际上是一个 CSV 数据文件。我们需要从文件中创建一个熊猫数据帧，如下所示</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="e9a6" class="ki kj hi lx b fi mb mc l md me">import pandas as pd</span><span id="2292" class="ki kj hi lx b fi mf mc l md me">csv_data = pd.read_csv('/Users/omestry/Downloads/LIDAR_ISLAND_NEW/Job561242_ca2010_arra_goldengate_m5007_raw.txt')</span><span id="4f26" class="ki kj hi lx b fi mf mc l md me">csv_data[3] = -1<br/>csv_data[4] = -1</span><span id="e0d8" class="ki kj hi lx b fi mf mc l md me">xa = csv_data.to_numpy()</span></pre><p id="a5a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们还在生成的 DataFrame 中添加了两个额外的列，因为我们将使用 scipy 的<a class="ae jt" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cdist.html" rel="noopener ugc nofollow" target="_blank"> cdist </a>函数，该函数要求数据行具有相同的大小，然后我们将它转换为 NumPy 数组。</p><p id="15f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们完成了激光雷达数据，它已经准备好了！！！</p><h2 id="524a" class="ki kj hi bd iu kk kl km kn ko kp kq kr jg ks kt ku jk kv kw kx jo ky kz la lb bi translated">生成地图数据</h2><p id="bf34" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">现在让我们定义一些距离函数，我们将把它传递给 scipy 的<a class="ae jt" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cdist.html" rel="noopener ugc nofollow" target="_blank"> cdist </a>函数，该函数将使用它来确定两点之间的距离。这里我们将使用<strong class="ix hj">哈弗森</strong>距离。</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="cc67" class="ki kj hi lx b fi mb mc l md me">from math import radians, cos, sin, asin, sqrt<br/>from scipy.spatial.distance import cdist</span><span id="9f89" class="ki kj hi lx b fi mf mc l md me">def haversine(lon1, lat1, lon2, lat2):<br/>    """<br/>    Calculate the great circle distance between two points <br/>    on the earth (specified in decimal degrees)<br/>    """<br/>    # convert decimal degrees to radians <br/>    lon1, lat1, lon2, lat2 = map(radians, [lon1, lat1, lon2, lat2])</span><span id="6df0" class="ki kj hi lx b fi mf mc l md me">    # haversine formula <br/>    dlon = lon2 - lon1 <br/>    dlat = lat2 - lat1 <br/>    a = sin(dlat/2)**2 + cos(lat1) * cos(lat2) * sin(dlon/2)**2<br/>    c = 2 * asin(sqrt(a)) <br/>    r = 6371 # Radius of earth in kilometers. Use 3956 for miles<br/>    return c * r</span><span id="8e60" class="ki kj hi lx b fi mf mc l md me">def func(p1, p2):<br/>    return haversine(p1[0], p1[1], p2[0], p2[1])</span></pre><p id="b7b1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将结合激光雷达数据和颜色数据。为了结合激光雷达数据和颜色数据，我们将使用<strong class="ix hj">最近邻方法</strong>。对于每个激光雷达数据点，我们将尝试找到最接近的颜色数据点，并将颜色数据与该激光雷达数据点相关联，为此，我们将使用 DataHub space 的<a class="ae jt" href="https://xyz.api.here.com/hub/static/swagger/#/Read%20Features/getFeaturesBySpatial" rel="noopener ugc nofollow" target="_blank">空间搜索功能</a>。</p><p id="b88d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于每个激光雷达点，我们将每个点视为圆心，半径为 3 米(我们需要将半径设置为尽可能小，以减少要比较的要素)。使用上述考虑因素，DataHub 空间搜索将从激光雷达点半径 3 米内的<strong class="ix hj">空间</strong>返回色点。如果存在多个点，我们将使用 scipy 的<a class="ae jt" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cdist.html" rel="noopener ugc nofollow" target="_blank"> cdist </a>函数找到最近的一个。下面是使用上述算法生成最终数据的代码。</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="d6e3" class="ki kj hi lx b fi mb mc l md me">import concurrent.futures<br/>import time<br/>from functools import partial<br/>from multiprocessing import Manager, Process</span><span id="37cd" class="ki kj hi lx b fi mf mc l md me">import numpy as np<br/>from geojson import Feature, Point<br/>from xyzspaces.utils import grouper</span><span id="2b1e" class="ki kj hi lx b fi mf mc l md me">manager = Manager()<br/>final_data = manager.list()</span><span id="54e3" class="ki kj hi lx b fi mf mc l md me">def gen_feature_color(features, space_color, func):<br/>    try:<br/>        for d in features:<br/>            fl = []<br/>            for f in space_color.spatial_search(lon=d[0], lat=d[1], radius=3):<br/>                fl.append(<br/>                    [<br/>                        f["geometry"]["coordinates"][0],<br/>                        f["geometry"]["coordinates"][1],<br/>                        f["properties"]["R"],<br/>                        f["properties"]["G"],<br/>                        f["properties"]["B"],<br/>                    ]<br/>                )<br/>            closest_index = cdist(<br/>                XA=np.array([d]), XB=np.array(fl), metric=func<br/>            ).argmin()<br/>            rgb = fl[closest_index]<br/>            final_data.append([d[0], d[1], d[2], rgb[2], rgb[3], rgb[4]])<br/>            print(len(final_data))<br/>    except Exception as e:<br/>        print(e)</span><span id="fd2f" class="ki kj hi lx b fi mf mc l md me">features_size = 1000</span><span id="45cb" class="ki kj hi lx b fi mf mc l md me">groups = grouper(features_size, xa)</span><span id="d810" class="ki kj hi lx b fi mf mc l md me">part_func = partial(gen_feature_color, space_color=space, func=func)</span><span id="a512" class="ki kj hi lx b fi mf mc l md me">with concurrent.futures.ProcessPoolExecutor(max_workers=60) as executor:<br/>    executor.map(part_func, groups, chunksize=3)</span></pre><p id="aa93" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上述代码可能需要一些时间来执行，具体取决于您的系统，因为它会为每个激光雷达数据点查找最接近的色点，大约为 1，48，913，因此请耐心等待😉并且在代码执行之前拥有一个☕️。该代码将打印它已经处理的点数。一旦执行完成，我们将准备好<strong class="ix hj"> final_data </strong>列表<strong class="ix hj"> </strong>中的最终数据。现在我们只需要保存它并将其可视化。</p><p id="79fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将把列表保存为一个 JSON 数组，因此要做到这一点，我们需要使用 pandas</p><pre class="li lj lk ll fd lw lx ly lz aw ma bi"><span id="5c30" class="ki kj hi lx b fi mb mc l md me">from pandas import DataFrame</span><span id="ca95" class="ki kj hi lx b fi mf mc l md me">df = DataFrame(list(final_data))</span><span id="7666" class="ki kj hi lx b fi mf mc l md me">df.to_json('FINAL_DATA.json', orient='values')</span></pre><p id="d2ed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在完成了数据处理，现在我们将进入最后也是最激动人心的部分，在地图上可视化数据。</p><h2 id="a9bd" class="ki kj hi bd iu kk kl km kn ko kp kq kr jg ks kt ku jk kv kw kx jo ky kz la lb bi translated">可视化数据</h2><p id="14c3" class="pw-post-body-paragraph iv iw hi ix b iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">我们将使用 Harp.gl 来可视化生成的数据，要使用<a class="ae jt" href="https://github.com/heremaps/harp.gl" rel="noopener ugc nofollow" target="_blank"> Harp.gl </a>我们将需要一个 HERE API-KEY，您可以通过以下链接中的步骤生成它:-<a class="ae jt" href="https://developer.here.com/tutorials/getting-here-credentials/" rel="noopener ugc nofollow" target="_blank">https://developer . HERE . com/tutorials/getting-HERE-credentials/</a></p><p id="2005" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是可用于可视化生成的数据 3D 地图数据的代码，只需将[YOUR-API-KEY]替换为您的 HERE API-KEY 和 FINAL_DATA.json 的路径(如果它不在与代码相同的位置),瞧！！！</p><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="694b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最终结果会是这样的🤩</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/0c826a1b0e7af0ec1faa8b7fb54f93bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*RlIrYnx37DvDcSgqc1_V_g.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">旧金山霍利公园</strong>最终数据可视化</figcaption></figure><p id="a59c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">全部代码都呈现在这个<a class="ae jt" href="https://github.com/omanges/Color-LIDAR" rel="noopener ugc nofollow" target="_blank">资源库</a></p><p id="7adc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae jt" href="https://github.com/heremaps/xyz-spaces-python" rel="noopener ugc nofollow" target="_blank"> xyzspaces </a>的 Github 存储库链接</p><p id="c1e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你有任何问题，请随时联系我😉</p><p id="52ff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">享受快乐编码！！！</p><p id="e30e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您觉得这很有帮助，请点赞并分享<a class="ae jt" href="https://twitter.com/omanges333" rel="noopener ugc nofollow" target="_blank"> @omanges333 </a>和</p></div></div>    
</body>
</html>