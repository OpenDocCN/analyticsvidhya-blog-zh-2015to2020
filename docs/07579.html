<html>
<head>
<title>Math Behind Content Based Recommendation System.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于内容的推荐系统背后的数学。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/math-behind-content-based-recommendation-system-a7e440c96fa?source=collection_archive---------8-----------------------#2020-06-30">https://medium.com/analytics-vidhya/math-behind-content-based-recommendation-system-a7e440c96fa?source=collection_archive---------8-----------------------#2020-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/96671dfac95e7551e2e5c98747515d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XLcRZNEmdCnWPq1Yj5oOqQ.jpeg"/></div></div></figure><p id="87c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">基于内容的推荐系统背后的概念:</strong></p><p id="2248" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我想给出关于基于内容的推荐系统的直觉，比如它在实际操作中是如何工作的，稍后我们将跳到它背后的数学部分！</p><p id="f717" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设，我们有用户1，他看过电影1(动作片)给它的评分是5/5，电影2(爱情片)给它的评分是4/5，电影3(动作片)给它的评分是5/5。</p><p id="15fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，如果用户2观看电影6(动作片)的评分为5/5，而电影7(爱情片)的评分为5/5，那么基于内容的推荐系统最有可能根据与这两个用户相关的评级和电影类型为用户2推荐动作片1或动作片3。</p><p id="8d34" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简而言之，这些算法试图推荐与用户过去喜欢或现在正在检查的项目相似的项目。</p><p id="a01b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简单来说，这就是基于内容的推荐系统的工作原理，但是理解每种算法背后的数学原理也是非常重要的，所以让我们深入了解这种算法背后的数学原理。</p><p id="bd3d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">算法背后的数学:</strong></p><p id="b5d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，让我们从一个简单的例子开始，假设下面的数据，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/02fbb474c26c4f7838598bc68619b487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*LZuL8R16ocXpJe9Kf0NsrQ.png"/></div></figure><p id="0b66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么问题来了，如何才能推荐用户未知的评分呢！？</p><p id="aafe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据以上数据，我们可以看出。电影1、电影2和电影3更倾向于动作片，而电影4和电影5更倾向于爱情片，我们还可以得出结论，用户1和用户2更喜欢动作片而不是爱情片！对于用户3和用户4，反之亦然。</p><p id="eb44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在哪里，</p><p id="00bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">n(U)=用户数量=4，</p><p id="21ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">n(M)=电影数量=5，以及</p><p id="8469" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">n(特征)=2，即(动作和浪漫)</p><p id="62be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们考虑电影1，假设X截距值为X(0)=1，考虑特征值，我们可以将电影1的特征向量写成矩阵(3，1)的向量为[1 0.9 0]，类似地，电影2、3、4和5也有特征向量。</p><p id="bfd4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，对于每个用户“j”，学习参数θ(j)= =真实Number^(3(即(特征(2)+1)，因此通过使用</p><p id="ca83" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(Theta^(j))^(T)*x^(i)，我们可以使用每个用户的参数向量θ(I)来找到电影(I)的评级，其中(I)是用户的数量。</p><p id="d3e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们用更好的概念表述来理解这一点，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/79744db5524412f34856ed2cee3befa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTQokXUs9ZEAcMhCC7t7Gg.jpeg"/></div></div></figure><p id="1f9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，基于这些假设值，对于用户1的参数向量，让我们预测电影3的评级，</p><p id="57d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于下面给出的计算！</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/6b0ff6c0beffa4f0fee323819617157e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_vDEQ_YaEDLCFZVOX27XqQ.jpeg"/></div></div></figure><p id="a848" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，根据计算，我们看到，用户1对电影3的预测评级大约是4.5颗星！</p><p id="d7e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，在这里，我们“假设”了用户1的参数向量，那么我们如何获得实际的参数向量，不仅是针对一个用户，而是针对我们拥有的每个用户！</p><p id="c965" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在此之前，让我们先来谈谈一些我们需要了解的术语:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/be57b73b1d27807340dd5992f11ce764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfSuZnvEaWdLV5aOffgw4w.jpeg"/></div></div></figure><p id="b8f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们看看，我们如何预测每个用户的参数向量的实际值(<strong class="is hj">，我们之前假设的</strong>)。</p><p id="3d87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，要学习参数向量(Theta^(j))，这可以认为是一个线性回归问题，使实际的参数向量和预测的参数向量值尽可能接近，作为损失函数</p><p id="af15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以把它正式表示为，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jv"><img src="../Images/4f305b063489e54bcfd3b410fff71237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NdHJKCGRGsgfAVfU0GFmow.jpeg"/></div></div></figure><p id="80ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就像线性回归模型一样，我们希望选择特定的参数向量，以最小化均方误差项，现在，我们还可以添加正则化项，以避免过拟合，</p><p id="15ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在最小化这一项之后，我们可以得到用户‘j’的电影评级的参数向量的相当好的估计。</p><p id="e269" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，总的来说，我们可以把这个方程表示为，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/36916c02458469d10fd83dec6d6b4c6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-K9AYFdrttVKV6VrLxpGw.jpeg"/></div></div></figure><p id="ca3d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们写了这个等式，考虑到一个用户，</p><p id="43bc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们考虑这个等式，对于多个用户，我们可以修改上面的等式，只需添加一个求和，考虑到存在“n”个用户，可以表示为:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jv"><img src="../Images/57c5c14fb540f755124db74ee204d15f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zxVVkxUzYudd98t4LB4Cg.jpeg"/></div></div></figure><p id="e522" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，</p><p id="5928" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以将整个方程(即损失函数)表示为我们的“J for (Theta(1)，Theta(2)，…。θ(n)”，并且这可以乘以适当的激活函数，并且从预测的参数向量中减去，以便最小化实际和预测的参数向量之间的差异。</p><p id="29db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们将为每个用户获得更好的预测参数向量，我们将使用它来分别预测电影的评级，这就是基于内容的推荐系统的工作方式！</p><p id="f8ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我的第一个博客，我对这个领域的第一个贡献，如果有任何更正，任何需要改进的地方，请告诉我。</p><p id="e78f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">谢谢！</strong>。</p></div></div>    
</body>
</html>