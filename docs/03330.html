<html>
<head>
<title>Talking Data User Demographics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对话数据用户人口统计</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/talking-data-user-demographics-19e3d15627b5?source=collection_archive---------12-----------------------#2020-01-26">https://medium.com/analytics-vidhya/talking-data-user-demographics-19e3d15627b5?source=collection_archive---------12-----------------------#2020-01-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5a09" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">我的第一个卡格尔问题</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/941b68e5e06a5da06c6127568c562ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qg_iMRE_-j6Ih_So"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">弗兰基·查马基在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="dbc3" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">商业问题</h1><p id="e7b2" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">没有什么比当你走进街角咖啡馆的门时，你最喜欢的饮料向你打招呼更令人欣慰的了。虽然一个体贴的咖啡师知道你每周三早上8:15会喝一杯卡布奇诺，但在数字空间里，你喜欢的品牌要个性化你的体验要困难得多。</p><p id="075f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">中国最大的第三方移动数据平台Talking Data明白，日常的选择和行为描绘了我们是谁，我们重视什么。目前，Talking Data正在寻求利用中国每天活跃的5亿移动设备中超过70%的行为数据，帮助其客户更好地了解他们的受众并与之互动。</p><p id="0421" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在kaggle竞赛中，参赛者被要求建立一个模型，根据他们的应用程序使用情况、地理位置和移动设备属性来预测用户的人口统计特征。这样做将有助于全球数百万开发者和品牌广告商追求数据驱动的营销努力，这些努力与他们的用户相关并迎合他们的偏好。</p><h1 id="73a9" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">数据概述</strong></h1><p id="7015" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">数据可从<a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/data" rel="noopener ugc nofollow" target="_blank">竞赛页面</a>下载，其中包括:</p><ol class=""><li id="a556" class="lh li hi ki b kj lc km ld kp lj kt lk kx ll lb lm ln lo lp bi translated"><strong class="ki hj"> gender_age_train.csv，gender _ age _ test . CSV</strong>—这些文件分别包含训练和测试模型的设备的详细信息。</li><li id="d418" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><strong class="ki hj"> events.csv，app_events.csv </strong> —当用户使用TalkingData SDK时，事件连同其时间戳一起被记录在该数据中。每个事件都有一个事件id，位置(纬度/经度)，事件对应app_events中的一个应用列表。</li><li id="b7fd" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><strong class="ki hj"> app_labels.csv </strong> —包含用户使用的应用及其对应的label_id。</li><li id="5f42" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><strong class="ki hj"> label_categories.csv </strong> —由app_labels.csv中的应用标签id及其类别组成。例如，标签ID: 4属于游戏艺术风格类别。</li><li id="dd84" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><strong class="ki hj">phone _ brand _ device _ model . CSV</strong>—包含用户使用的设备的设备id、相应的电话品牌和设备型号。</li></ol><h1 id="9703" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">现实世界/业务目标和约束</strong></h1><ol class=""><li id="a4d2" class="lh li hi ki b kj kk km kn kp lv kt lw kx lx lb lm ln lo lp bi translated">没有低延迟要求。</li><li id="576e" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">需要数据点属于每个类别的概率。</li></ol><h1 id="a559" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">绩效指标</strong></h1><p id="1a7c" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/overview/evaluation" rel="noopener ugc nofollow" target="_blank"><strong class="ki hj"/></a>:每个设备都被标注了一个真实的类别。对于每个设备，我们必须预测一组预测概率(每个类别一个)。公式是</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ly"><img src="../Images/098fe3a1ec6346b0ce22c58f8d4b20b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*cNxfv4ymPg8fmNHuk3oqPw.jpeg"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">来源:<a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/overview/evaluation" rel="noopener ugc nofollow" target="_blank">卡格尔</a></figcaption></figure><p id="de49" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">其中，N是测试集中设备的数量，M是类别标签的数量，log是自然对数，如果设备I属于类别j，yij是1，否则是0，pij是观察值ii属于类别j的预测概率。</p><h1 id="007d" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">数据分析</strong></h1><p id="fede" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">首先让我们导入一些库</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="d1e4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">性别_年龄_车次</strong> <strong class="ki hj">数据</strong></p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="bc52" class="mg jp hi mc b fi mh mi l mj mk">gender_age_train=pd.read_csv('gender_age_train.csv')<br/>gender_age_train.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ml"><img src="../Images/53424accb0b948a606c2dd7384ca4712.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*bU2tPjo2nw1m8rbyLBnhrA.jpeg"/></div></figure><p id="f232" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这里我们有4列:</p><ul class=""><li id="e637" class="lh li hi ki b kj lc km ld kp lj kt lk kx ll lb mm ln lo lp bi translated"><strong class="ki hj">设备id: </strong>注册了通话数据的用户设备id</li><li id="566e" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb mm ln lo lp bi translated"><strong class="ki hj">性别:</strong>用户的性别，用M或F分别表示男性或女性</li><li id="9784" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb mm ln lo lp bi translated"><strong class="ki hj">年龄:</strong>用户的年龄</li><li id="46c4" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb mm ln lo lp bi translated">group: 这是我们问题的目标类，包含我们需要预测的类。第一个字母表示用户的性别，随后是用户所属的年龄组</li></ul><p id="5e68" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">看一下组列的计数图</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mn"><img src="../Images/428b9273ae54567f840f62a79e227280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*al_Wd4vJKdglkRVFN0QZtQ.jpeg"/></div></figure><p id="eada" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">从上面的图中我们可以推断出男性用户比女性用户多。这一点在饼状图中表现得更为明显，其中近65%是男性，35%是女性。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mo"><img src="../Images/47808709c3fa45322f1c467b67fd408d.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*3D2aZqCt4eSRIbU87dyy-g.jpeg"/></div></figure><p id="b53c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">性别_年龄_测试数据</strong></p><p id="acd3" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这是我们需要预测人口统计的测试数据。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="94b1" class="mg jp hi mc b fi mh mi l mj mk">gender_age_test=pd.read_csv('gender_age_test.csv')<br/>gender_age_test.columns.values</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mp"><img src="../Images/db71c424553dbaccf90deb63967fd799.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*M8hob8Upc8G1X-NNQ0fTwg.jpeg"/></div></figure><p id="d00e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">所以测试数据只有一列device_id。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es et"><img src="../Images/c5fb87915f94bf1f473192a66a077af0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GC0baSfw9hgLWSnYeG02Q.jpeg"/></div></div></figure><p id="f021" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">手机_品牌_设备_型号数据</strong></p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="a609" class="mg jp hi mc b fi mh mi l mj mk">phone_data=pd.read_csv('phone_brand_device_model.csv')<br/>phone_data.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mq"><img src="../Images/8cf8b0676c1f352a7508d76ea538284a.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*rMNux0GtyPQ1-ftwRT4YUA.jpeg"/></div></figure><p id="7083" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们这里有device_id、phone_brand、device_model，并且注意到一些phone_brand和device_model值是中文的。让我们看看是否有重复的。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="727a" class="mg jp hi mc b fi mh mi l mj mk">phone_devices_unique=np.unique(phone_data['device_id'].values)<br/>print("Number of Unique Phone Devices: ",len(phone_devices_unique))<br/>print("Total Number of Devices in Phone Data: ",phone_data.shape[0])<br/>print("Number of Duplicate Devices: ",phone_data.shape[0]-len(phone_devices_unique))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mr"><img src="../Images/25f596fa17dc1c1d406d5e5e554dbce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*yvXFOel4Wr8sGXug2FnITw.jpeg"/></div></figure><p id="da25" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">所以有一些重复的，他们需要被删除。</p><p id="a1bf" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">事件数据</strong></p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="f0f0" class="mg jp hi mc b fi mh mi l mj mk">events=pd.read_csv('events.csv')<br/>events.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ms"><img src="../Images/274cc3f55b1fbc15b9626f51b0531970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*G97IZa7c2gMRTpYYziGing.jpeg"/></div></figure><p id="e9a0" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">让我们看看id为<strong class="ki hj"> 29182687948017175 </strong>的设备的事件数据</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="1664" class="mg jp hi mc b fi mh mi l mj mk">events[events['device_id']==29182687948017175].head(10)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mt"><img src="../Images/6b5d3853c92afc89856b769104ad3b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*giVWFYFT8C_DCM0lldNOYQ.jpeg"/></div></figure><p id="73af" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这意味着我们为特定设备记录了多个事件。</p><p id="63f8" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们有所有事件的时间戳，我们可以查看所有事件的总体开始和结束时间，以了解所有事件的记录时间。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="439b" class="mg jp hi mc b fi mh mi l mj mk"># Event Start and End time across the whole Data<br/>event_times=events['timestamp'].values<br/>print("Event Start: ",np.min(event_times))<br/>print("Event End: ",np.max(event_times))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mu"><img src="../Images/3ff1fefad63c656241cd754b89c504db.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*4zFSO2Ee5fKX-60JP16e5Q.jpeg"/></div></figure><p id="9cf2" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">因此，我们可用的事件数据记录时间为8天，从2016年4月30日午夜到2016年5月8日凌晨12点。</p><p id="2128" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">好的，现在让我们看看在我们的训练和测试数据中有多少设备有事件数据？</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mv"><img src="../Images/29b0988d9a74b6a18d9d26595563bb48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*xdnErvIyS4xN_hYAKcICfg.jpeg"/></div></figure><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mw"><img src="../Images/f0d1af323a542fa3406e43b795cfbacb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*-7h1peSuVdWtp4rprg7xPA.jpeg"/></div></figure><p id="a246" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这些图表明，几乎69%的设备没有事件数据，只有31%的设备有事件数据。</p><p id="3cfa" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> app_labels数据</strong></p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="d032" class="mg jp hi mc b fi mh mi l mj mk">app_labels=pd.read_csv('app_labels.csv')<br/>app_labels.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mx"><img src="../Images/921a1e9e2215d868819bbc85b864993f.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*AK402mYTVcI9a8XSRpJrIQ.jpeg"/></div></figure><p id="2687" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">让我们看看我们有多少独特的应用程序标签？</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="df7d" class="mg jp hi mc b fi mh mi l mj mk">unique_app_labels=np.unique(app_labels['label_id'].values)<br/>print("Number of Unique App Labels: ", len(unique_app_labels))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es my"><img src="../Images/854452eede51643ab5781b5929bbd7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*PBMLTX08dzvB1dgbo1P8EA.jpeg"/></div></figure><p id="71b7" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在我们有507个唯一的应用程序标签，我们也可以有多个标签id与特定的应用程序id相关联。让我们考虑一个id为<strong class="ki hj"> 7324884708820027918 </strong>的应用程序，它有多个标签。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="9bf7" class="mg jp hi mc b fi mh mi l mj mk">app_labels[app_labels['app_id']==7324884708820027918]</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mz"><img src="../Images/c3b63203eb2c9faa98a330774faa99f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*brisorNWuMLLR5o_hInqfg.jpeg"/></div></figure><p id="404e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">app _事件数据</strong></p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="2444" class="mg jp hi mc b fi mh mi l mj mk">app_events=pd.read_csv('app_events.csv')<br/>app_events.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es na"><img src="../Images/1b53bcc31c343c83cf72ab55e4a39e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*-jzsDeAAq4RjTQwHsqkTvA.jpeg"/></div></figure><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="30d9" class="mg jp hi mc b fi mh mi l mj mk">unique_apps_1=np.unique(app_events['app_id'].values)<br/>unique_events_1=np.unique(app_events['event_id'].values)<br/>print("Number of Unique Apps: ",len(unique_apps_1))<br/>print("Number of Unique Events: ",len(unique_events_1))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nb"><img src="../Images/5b821fbd46bbf4818584c50838ebc7cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*ATH9REaBERNNIBcrlCNSrQ.jpeg"/></div></figure><p id="0c1a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">让我们看看is_active列</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="5d48" class="mg jp hi mc b fi mh mi l mj mk">plt.figure(figsize=(10,6))<br/>plt.title('Active Events Plot')<br/>app_events['is_active'].map({1:'Active',0:'Inactive'}).value_counts().plot.pie()<br/>plt.show()<br/>print("Active : ",np.round(app_events['is_active'].value_counts()[1]*100/app_events.shape[0],2)," %")<br/>print("Inactive : ",np.round(app_events['is_active'].value_counts()[0]*100/app_events.shape[0],2)," %")</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nc"><img src="../Images/147a79b2039c93558e732174a6df036b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*HndcNm1mnAkHEUHd-tLrLg.jpeg"/></div></figure><p id="36ed" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">因此，当有活动正在进行时，大多数应用程序都是不活动的。几乎61%的应用程序是不活跃的，39%的应用程序是活跃的。</p><p id="c613" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">来自数据分析的见解</strong></p><ol class=""><li id="7208" class="lh li hi ki b kj lc km ld kp lj kt lk kx ll lb lm ln lo lp bi translated">只有31%的训练和测试数据有事件数据。</li><li id="1702" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">对于没有事件数据的设备，我们只有可用于预测用户人口统计的电话品牌和设备型号特征。这意味着，对于几乎69%的设备，我们只有电话数据。</li><li id="ffae" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">对于包含事件数据的设备，我们可以使用其事件相关功能以及其手机品牌和设备型号来预测用户统计数据。</li></ol><h1 id="3676" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">数据准备</strong></h1><p id="7aa7" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">现在，我将简要地解释准备我的模型中使用的数据所遵循的步骤</p><ol class=""><li id="ce53" class="lh li hi ki b kj lc km ld kp lj kt lk kx ll lb lm ln lo lp bi translated">因为我们的数据中有两种类型的设备，一种有事件详细信息，另一种没有任何事件详细信息。我分离了设备，并为有事件的设备和无事件的设备创建了数据。</li><li id="8d39" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">对于没有事件数据的设备，我只使用手机品牌和设备型号作为特征。</li><li id="d544" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">对于具有事件数据的设备，我使用了手机品牌、设备型号以及事件数据功能，如中纬度、中经度、事件发生的时间、事件发生的星期几、应用程序事件数据中的is_active功能、设备中使用/安装的所有应用程序列表、按设备id分组的所有应用程序标签列表。</li></ol><p id="6f2e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">关于我如何准备数据的更多细节和代码，请随时查看我的<a class="ae jn" href="https://github.com/AbhishekKarthik/Talking_Data_User_Demographics" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>。</p><h1 id="0a7c" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">我的方法</h1><ol class=""><li id="f871" class="lh li hi ki b kj kk km kn kp lv kt lw kx lx lb lm ln lo lp bi translated">由于我们数据中的所有设备都有手机品牌和设备型号的详细信息，所以我使用这两个特征来训练一个逻辑回归和两个不同的神经网络模型。我使用这些模型来预测测试数据中设备的类别概率，这些测试数据不包含我们在前面的步骤中分离的事件数据。</li><li id="f72b" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">对于包含事件细节的设备，我使用我们为这些设备提取的事件相关特征，并且仅使用包含事件细节的设备来训练两个不同的神经网络模型。然后，我使用这些模型来预测包含事件数据的测试数据中设备的分类概率。</li><li id="4b69" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">最后，我将有事件的设备和无事件的设备的测试数据预测连接起来，并创建了整个测试数据预测文件。</li></ol><h1 id="2e23" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">准备特性</strong></h1><p id="2a7a" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">因为我们有两个独立的数据，一个是有事件的设备，另一个是没有事件的设备，所以我为这些数据分别准备了特性。</p><ol class=""><li id="ae6a" class="lh li hi ki b kj lc km ld kp lj kt lk kx ll lb lm ln lo lp bi translated"><strong class="ki hj">无事件的设备:</strong>创建手机品牌、设备型号特征的一次性编码。</li><li id="40f4" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><strong class="ki hj">带事件的设备:</strong>创建手机品牌、设备型号、属于设备的应用程序、属于设备的应用程序标签、TFIDF小时编码功能、星期几、应用程序激活、标准化纬度和经度功能的一键编码。让我们称之为<strong class="ki hj">事件特征矩阵。</strong></li></ol><h1 id="8d1b" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">造型</strong></h1><p id="9bf5" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">正如我的方法中提到的，在这一节中，我将带您浏览我的解决方案中使用的模型。这包括两个部分，即，在没有事件细节的设备数据上建模和在包含事件细节的设备数据上建模。让我们先从没有事件细节的设备建模开始。</p><p id="88fd" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">无事件详情的设备</strong></p><p id="74da" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在开始建模之前，我将为我的模型创建训练、验证和测试数据。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="7086" class="mg jp hi mc b fi mh mi l mj mk">#using Label Encoder to encode class labels as integers from 0-11<br/>class_encoder=LabelEncoder()<br/>encoded_y=class_encoder.fit_transform(train_data['group'])<br/>train_data['Class']=encoded_y<br/>y_data=train_data['Class'].values<br/>train_1, cv_1, y_train_1, y_cv_1 = train_test_split(X_train_one_hot, y_data,stratify=y_data,test_size=0.15,random_state=18)<br/>test_1=X_test_no_events_one_hot</span></pre><p id="d295" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> X_train_one_hot </strong>是所有设备(有无事件)的列车数据的手机品牌、设备型号特征的一键编码。<strong class="ki hj">X _ test _ no _ events _ one _ hot</strong>是列车数据的手机品牌、设备型号特征的一键编码，仅用于不包含事件详情的设备。原因是，正如我在方法中提到的，手机品牌、设备型号功能适用于所有设备。因此，我针对训练数据中所有可用设备的这些特征来训练模型，并使用模型来预测测试数据中没有事件细节的设备。</p><p id="b3ab" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">逻辑回归</strong></p><p id="fac5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">逻辑回归模型在train_1上训练，cv_1是验证数据，test_1是我们预测分类概率的测试数据。但首先让我们做一点超参数搜索。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nd"><img src="../Images/232fbe4e126151be7f11b1f9b77090be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IFJqYoJri-rPga6LrJ8EQw.jpeg"/></div></div></figure><p id="02c8" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">因此，我们可以看到，与我们尝试的所有其他值相比，C=0.1具有最低的对数损失。因此，我们将使用C=0.1来训练我们的逻辑回归，并使用它来预测测试数据(test_1)的概率。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="77e4" class="mg jp hi mc b fi mh mi l mj mk">best_c=0.1<br/>lr = LogisticRegression(C=best_c, class_weight='balanced', multi_class='multinomial',solver='lbfgs' ,random_state=42)<br/>lr.fit(train_1, y_train_1)<br/>#Using Model Calibration<br/>lr_sig_clf = CalibratedClassifierCV(lr, method="sigmoid")<br/>lr_sig_clf.fit(train_1, y_train_1)</span><span id="d4e7" class="mg jp hi mc b fi ne mi l mj mk">lr_no_events_train_prediction=lr_sig_clf.predict_proba(train_1)<br/>lr_no_events_cv_prediction=lr_sig_clf.predict_proba(cv_1)<br/>lr_no_events_test_prediction=lr_sig_clf.predict_proba(test_1)</span></pre><p id="4ba4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">仅使用电话品牌和设备型号one-hot编码作为特征，逻辑回归模型具有2.38的CV对数损失。</p><p id="6cc4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">神经网络1 </strong></p><p id="5d09" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">从<a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">竞赛讨论页</a>引用的神经网络架构</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="302f" class="mg jp hi mc b fi mh mi l mj mk">def model_1_1(input_shape):<br/>    model = Sequential()<br/>    model.add(Dense(256, input_dim=input_shape))<br/>    model.add(PReLU())<br/>    model.add(BatchNormalization())<br/>    model.add(Dropout(0.5))<br/>    model.add(Dense(64))<br/>    model.add(PReLU())<br/>    model.add(BatchNormalization())<br/>    model.add(Dropout(0.5))<br/>    model.add(Dense(12))<br/>    model.add(Activation('softmax'))<br/>    model.compile(loss='categorical_crossentropy',<br/>              optimizer='adam',<br/>              metrics=['accuracy'])<br/>    return model</span></pre><p id="6180" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> input_shape </strong>这里是X_train_one_hot中的特征数。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/08e5408528090874c650309b93cdfd7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FigtQP-8wWP1t1fIdVNT9w.jpeg"/></div></div></figure><p id="4371" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我在X_train_one_hot数据上使用不同的随机分割train，CV训练神经网络1模型5次，如下所示</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="3947" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> model_list_1 </strong>包含使用不同随机种子在不同版本的X_train_one_hot数据分割上训练的5个模型。我使用了model_list_1中的每个模型，并对测试数据(test_1)进行了概率预测，然后取所有预测的平均值。</p><p id="fb7c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">神经网络2 </strong></p><p id="d9eb" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">参考自<a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">竞赛讨论页</a>的神经网络架构</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="7101" class="mg jp hi mc b fi mh mi l mj mk">def create_model_1_2(input_dim, learRate=0.0025):<br/>    <br/>    model = Sequential()<br/>    model.add(Dense(500, input_shape=(input_dim,), init='uniform'))<br/>    model.add(PReLU(init='zero'))<br/>    model.add(Dropout(0.82))<br/>    model.add(Dense(12, init='uniform'))<br/>    model.add(Activation('softmax'))<br/>    opt = Adagrad(lr=learRate, epsilon=1e-08)<br/>    model.compile(loss='categorical_crossentropy',<br/>                  optimizer=opt,<br/>                  metrics=['accuracy'])<br/>    return model</span></pre><p id="4582" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这里，<strong class="ki hj"> input_dim </strong>是X_train_one_hot中的特征数。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ng"><img src="../Images/460073f8b62730da65830e22be743542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*c2iFXPPb5ZHf21sQ7zd_cw.jpeg"/></div></figure><p id="e020" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我在train_1上对神经网络2进行了一次30个时期的训练，并使用该模型对测试数据(test_1)进行预测。</p><p id="418e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">具有事件详情的设备</strong></p><p id="eddd" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">让我们为我的模型创建训练、验证和测试数据，就像我们以前为没有事件数据的设备所做的那样。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="ae81" class="mg jp hi mc b fi mh mi l mj mk">y_data_events=events_train_data['Class'].values</span><span id="7a24" class="mg jp hi mc b fi ne mi l mj mk">train_2, cv_2, y_train_2, y_cv_2 = train_test_split(X_train_events_one_hot_1, y_data_events,stratify=y_data_events,test_size=0.2,random_state=9)<br/>test_2=X_test_events_one_hot_1</span><span id="ec9b" class="mg jp hi mc b fi ne mi l mj mk">y_train_nn_3=np_utils.to_categorical(y_train_2)<br/>y_cv_nn_3=np_utils.to_categorical(y_cv_2)</span></pre><p id="fd00" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这里，X_train_events_one_hot_1是我们在特征准备步骤中创建的列车数据的<strong class="ki hj">事件特征矩阵</strong>。X_test_events_one_hot_1是测试数据的类似<strong class="ki hj">事件特征矩阵</strong>。</p><p id="51d5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">神经网络3 </strong></p><p id="998f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">从<a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">竞赛讨论页</a>引用的神经网络架构</p><p id="bca5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">输入图层中的差值在此处增加了价值，因为它为预测提供了可变性，因为当我们在输入图层中使用差值时，在每次运行期间，只有一组随机要素被用作模型的输入。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="9fa7" class="mg jp hi mc b fi mh mi l mj mk">def model_2_1(input_dim):<br/>    model = Sequential()<br/>    model.add(Dropout(0.15, input_shape=(input_dim,)))<br/>    model.add(Dense(240, init='uniform'))<br/>    model.add(PReLU(init='zero'))<br/>    model.add(Dropout(0.8))<br/>    model.add(Dense(240, init='uniform'))<br/>    model.add(PReLU(init='zero', weights=None))<br/>    model.add(Dropout(0.35))<br/>    model.add(Dense(260, init='uniform'))<br/>    model.add(PReLU(init='zero', weights=None))<br/>    model.add(Dropout(0.40))<br/>    model.add(Dense(12, init='uniform'))<br/>    model.add(Activation('softmax'))</span><span id="4aa8" class="mg jp hi mc b fi ne mi l mj mk">opt = Adagrad(lr=0.008, epsilon=1e-08)<br/>    model.compile(loss='categorical_crossentropy',<br/>                  optimizer=opt,<br/>                  metrics=['accuracy'])<br/>    return model</span></pre><p id="42d7" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这里，<strong class="ki hj"> input_dim </strong>是X_train_events_one_hot_1中的特征数。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nh"><img src="../Images/842c1be2282c210073228641ea69713b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*Bslu8c2neirvGVp3mHdb5Q.jpeg"/></div></figure><p id="e719" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我训练神经网络3模型20次。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="35fa" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">然后，我使用model_list_2中的20个模型中的每一个对测试数据(test_2)进行预测，并取预测概率的平均值。</p><p id="e922" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">神经网络4 </strong></p><p id="6d6e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">该神经网络是神经网络3的变体，但是具有2个密集层和不同数量的隐藏单元。</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="5f95" class="mg jp hi mc b fi mh mi l mj mk">def model_2_2(input_dim):<br/>    model = Sequential()<br/>    model.add(Dropout(0.4, input_shape=(input_dim,)))<br/>    model.add(Dense(75))<br/>    model.add(PReLU())<br/>    model.add(Dropout(0.30))<br/>    model.add(Dense(50, init='normal', activation='tanh'))<br/>    model.add(PReLU())<br/>    model.add(Dropout(0.20))<br/>    model.add(Dense(12, init='normal', activation='softmax'))<br/>    model.compile(loss='categorical_crossentropy',     optimizer='adadelta', metrics=['accuracy'])<br/>    return model</span></pre><p id="c0de" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这里，<strong class="ki hj"> input_dim </strong>是X_train_events_one_hot_1中的特征数。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ni"><img src="../Images/fd4a59b1c6fa07ab537ff219fbe66bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H64jblX8-qfDfZOGQ52t5g.jpeg"/></div></div></figure><p id="8aca" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">类似于我训练神经网络3的方法，我训练神经网络4模型20次。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="6063" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">然后，我使用model_list_3中的20个模型中的每一个对测试数据(test_2)进行预测，并取预测概率的平均值。</p><h1 id="9cdb" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">模型集成</h1><ol class=""><li id="a548" class="lh li hi ki b kj kk km kn kp lv kt lw kx lx lb lm ln lo lp bi translated"><strong class="ki hj">无事件数据的设备:</strong>取3个模型预测值的加权平均值:</li></ol><ul class=""><li id="740e" class="lh li hi ki b kj lc km ld kp lj kt lk kx ll lb mm ln lo lp bi translated">逻辑回归(lr _ no _ events _ test _ prediction)—<strong class="ki hj">(0.15)</strong></li><li id="9793" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb mm ln lo lp bi translated">神经网络1平均预测值(test _ pred _ avg _ 1 _ 1)—<strong class="ki hj">(0.75)</strong></li><li id="0745" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb mm ln lo lp bi translated">神经网络2预测(test_pred_1_2) — <strong class="ki hj"> (0.1) </strong></li></ul><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="1a3f" class="mg jp hi mc b fi mh mi l mj mk">w1_1=0.15<br/>w1_2=0.75<br/>w1_3=0.1</span><span id="761f" class="mg jp hi mc b fi ne mi l mj mk">Test_Prediction_1=(w1_1*lr_no_events_test_prediction)+(w1_2*test_pred_avg_1_1)+(w1_3*test_pred_1_2)</span></pre><p id="1db8" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> 2。有事件数据的设备:</strong>取2个模型预测的加权平均值:</p><ul class=""><li id="de43" class="lh li hi ki b kj lc km ld kp lj kt lk kx ll lb mm ln lo lp bi translated">神经网络3平均预测值(test _ pred _ avg _ 2 _ 1)—<strong class="ki hj">(0.5)</strong></li><li id="559b" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb mm ln lo lp bi translated">神经网络4平均预测值(test _ pred _ avg _ 2 _ 2)——<strong class="ki hj">(0.5)</strong></li></ul><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="3f99" class="mg jp hi mc b fi mh mi l mj mk">w2_1=0.5<br/>w2_2=0.5</span><span id="9307" class="mg jp hi mc b fi ne mi l mj mk">Test_Prediction_2=(w2_1*test_pred_avg_2_1)+(w2_2*test_pred_avg_2_2)</span></pre><p id="81e9" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">最后，我将有事件和无事件设备的这些测试数据预测连接起来，创建了包含112071行的整个测试数据预测文件，其中每行包含设备属于12个类别中每一个类别的预测概率。</p><h1 id="97f0" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">结果</h1><ol class=""><li id="2bb9" class="lh li hi ki b kj kk km kn kp lv kt lw kx lx lb lm ln lo lp bi translated"><strong class="ki hj">无事件数据:</strong>模型针对所有设备的手机品牌、设备型号的One_Hot编码进行训练。</li><li id="4c63" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><strong class="ki hj">事件数据:</strong>仅针对包含事件细节的设备，在事件特征矩阵上训练模型。</li><li id="6aa0" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">模型中的平均值表示模型有多次运行，并且预测是平均的。</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mw"><img src="../Images/b62e18d3ab673539b08b40266aa3c9b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*JbvH5GOBU5DvC8hihDIc3A.jpeg"/></div></figure><p id="3e30" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">提交分数的串联测试预测:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nj"><img src="../Images/9cf8a00ee14b1e5b793a589afff4cf40.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*_Nz0M-pJDxeYHB5Ki6_Gvw.jpeg"/></div></figure><h1 id="47a3" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated"><strong class="ak">进一步改进</strong></h1><ol class=""><li id="2086" class="lh li hi ki b kj kk km kn kp lv kt lw kx lx lb lm ln lo lp bi translated">为预测的加权平均值尝试不同的权重，以改善结果。</li><li id="79ef" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated">也可以使用具有不同基础模型的模型集合，如随机森林或XG Boost或任何其他模型。</li></ol></div><div class="ab cl nk nl gp nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="hb hc hd he hf"><p id="d2a4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这是我第一篇关于媒体中的数据科学问题的博客。我希望我能够解释并帮助你理解我解决手头问题的方法。请随意查看我的<a class="ae jn" href="https://github.com/AbhishekKarthik/Talking_Data_User_Demographics" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中的完整解决方案，并通过<a class="ae jn" href="http://www.linkedin.com/in/abhishek-anand9418" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="cc45" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj">感谢您的阅读！！</strong></p></div><div class="ab cl nk nl gp nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="hb hc hd he hf"><h1 id="d2a6" class="jo jp hi bd jq jr nr jt ju jv ns jx jy io nt ip ka ir nu is kc iu nv iv ke kf bi translated"><strong class="ak">参考文献</strong></h1><ol class=""><li id="f090" class="lh li hi ki b kj kk km kn kp lv kt lw kx lx lb lm ln lo lp bi translated"><a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/talking data-mobile-user-demographics/</a></li><li id="d73c" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><a class="ae jn" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="83b3" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><a class="ae jn" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/talking data-mobile-user-demographics/discussion/23424</a></li><li id="110e" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><a class="ae jn" href="https://machinelearningmastery.com/model-averaging-ensemble-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/model-averaging-ensemble-for-deep-learning-neural-networks/</a></li><li id="1798" class="lh li hi ki b kj lq km lr kp ls kt lt kx lu lb lm ln lo lp bi translated"><a class="ae jn" href="https://machinelearningmastery.com/weighted-average-ensemble-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/weighted-average-ensemble-for-deep-learning-neural-networks/</a></li></ol></div></div>    
</body>
</html>