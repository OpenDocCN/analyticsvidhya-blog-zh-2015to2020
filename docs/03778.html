<html>
<head>
<title>Partial F backward method for selecting variables in a regression model using R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用R选择回归模型中变量的部分向后方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/partial-f-backward-method-for-selecting-variables-in-a-regression-model-7dd87687cd69?source=collection_archive---------15-----------------------#2020-02-18">https://medium.com/analytics-vidhya/partial-f-backward-method-for-selecting-variables-in-a-regression-model-7dd87687cd69?source=collection_archive---------15-----------------------#2020-02-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6339e7c72807d7e10c0ed98ab0ebca50.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/0*hZB-SS9thmfQrK2B.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">Sewaqu /公共领域<a class="ae iq" href="https://upload.wikimedia.org/wikipedia/commons/3/3a/Linear_regression.svg" rel="noopener ugc nofollow" target="_blank">【https://upload . wikimedia . org/Wikipedia/commons/3/3a/Linear _ regression . SVG】</a></figcaption></figure><p id="e9f3" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi jp translated"><span class="l jq jr js bm jt ju jv jw jx di">在</span>广泛的<strong class="it hj">随机森林</strong>和<strong class="it hj">深度神经网络</strong>成为机器学习/统计领域热门话题的时代，有些人可能会忘记那些也可以轻松解决实际问题的简单方法。</p><p id="316d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">其中一种方法是回归模型。我将用一个体育领域的例子来探讨它们，特别是排球。因此，我将尝试使用一些被认为有潜力预测因变量的自变量来预测排球运动员在进攻中的起跳高度。</p><p id="4d58" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">包含本文中使用的数据集和完整代码的存储库可以在:<a class="ae iq" href="https://github.com/nascimento1195/estudo-volei" rel="noopener ugc nofollow" target="_blank">https://github.com/nascimento1195/estudo-volei</a>获得。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="6c3f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">将使用的所有运动学变量为:</p><p id="e3d1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj"> x1 </strong> —最终水平速度(米/秒)(甚高频)；<br/> <strong class="it hj"> x2 </strong> —平均水平速度(米/秒)(VHM)；<br/> <strong class="it hj"> x3 </strong> —初始垂直速度(米/秒)(VVI)；<br/> <strong class="it hj"> x4 </strong> —平均垂直速度(米/秒)(VVM)；<br/> <strong class="it hj"> x5 </strong> —平均水平加速度(米/秒)(AHM)；<br/> <strong class="it hj"> x6 </strong> —初始垂直加速度(米/秒)(AVI)；<br/> <strong class="it hj"> x7 </strong> —平均垂直加速度(米/秒)(AVM)；<br/> <strong class="it hj"> x8 </strong> —髋关节的角平均速度(弧度/秒)(VAQ)；<br/> <strong class="it hj"> x9 </strong> —膝关节的角平均速度(弧度/秒)(VAJ)；<br/> <strong class="it hj"> x10 </strong> —踝关节的角平均速度(rad/s)(VAT)；<br/> <strong class="it hj"> x11 </strong> —肩关节的角平均速度(弧度/秒)(VAO)；<br/> <strong class="it hj"> x12 </strong> —最大髋关节屈曲角度()(AFMQ)；<br/> <strong class="it hj"> x13 </strong> —膝关节最大屈曲角度()(AFMJ)；<br/> <strong class="it hj"> x14 </strong> —踝关节背屈最大角度()(ADFMT)；<br/><strong class="it hj">×15</strong>—飞行阶段开始时身体重心的角度()(Angle<br/> <strong class="it hj"> x16 </strong> —肩幅角()(AO)；</p><p id="335b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">待预测的因变量为:</p><p id="e463" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj"> y </strong> —跳跃高度(米)(HSM)；</p><p id="4dbe" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">公制的副标题:</strong></p><p id="8e8a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">米/秒——米/秒；</p><p id="66aa" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">米/秒——米/平方秒；</p><p id="28e5" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">弧度/秒—弧度/秒；</p><p id="79e2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">—度；</p><p id="ebf2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">米—米。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="33e1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">第一步是读取数据，选择独立变量，并且不需要包含我们将使用的函数的原生R包。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="93ba" class="ko kp hi kk b fi kq kr l ks kt"># Reading data<br/>dados&lt;-read.table("dados.txt", h = T)<br/>attach(dados)</span><span id="d359" class="ko kp hi kk b fi ku kr l ks kt"># Getting the independent variables into the variable 'explicativas'<br/>explicativas&lt;-dados[,1:16]</span><span id="7d7b" class="ko kp hi kk b fi ku kr l ks kt"># Loading 'lmtest' package<br/>require(lmtest)</span></pre><p id="bf96" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">准备好数据后，我将开始调整一个完整的(所有可用的变量将用于预测<strong class="it hj"> y </strong>)模型。函数<strong class="it hj">‘lm’</strong>(线性模型)可以做到这一点。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="d58b" class="ko kp hi kk b fi kq kr l ks kt"># Full model with all variables<br/>modelo&lt;-lm(HSM~VHF+VHM+VVI+VVM+AHM+AVI+AVM+VAQ+VAJ+VAT+VAO+AFMQ+AFMJ<br/>           +ADFMT+ACG+AO)</span></pre><p id="a3d7" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我将实现方差分析(<strong class="it hj"> ANOVA </strong>)来获得每个变量的特殊F统计量，这将用于选择我们最终模型的特征。这里的逻辑是在每一步删除最不重要的变量。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="dd42" class="ko kp hi kk b fi kq kr l ks kt"># Analysis of variance of the variables in the model<br/>summary(aov(modelo))</span></pre><p id="af83" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们得到以下结果:</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/f78ee78ecc9d189b8caf07c295ca6707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*_YW9OIH4qP5J2Nc23tdS-w.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图1:部分F统计。</figcaption></figure><p id="3a1a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">根据F统计，最不重要的变量是具有更大的<em class="kw"> p值</em>的变量(在上图的最后一列中表示)。这样，我将在没有变量<strong class="it hj">‘VAQ’</strong>的情况下再次调整模型。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="5750" class="ko kp hi kk b fi kq kr l ks kt"># Model without the variable 'VAQ'<br/>modelo&lt;-lm(HSM~VHF+VHM+VVI+VVM+AHM+AVI+AVM+VAJ+VAT+VAO+AFMQ+AFMJ<br/>           +ADFMT+ACG+AO)</span></pre><p id="11e9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们再次进行方差分析:</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/8dc159ff9790269d3e6172bec02b3893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*LJKLlwouh-Fu7DK0dWpGcQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图2:部分F统计。</figcaption></figure><p id="cc13" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，最小有效变量是<strong class="it hj">‘VVM’</strong>。相同的迭代过程将被重复，直到我们在我们的模型中只得到重要的变量。我们得到的结果如下所示。</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/d2496da6a0abce9f9bb40431028bad83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*bB3hozzu3LbWcGeCrMycZA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图3:最终变量的F统计。</figcaption></figure><p id="4a9d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">正如我们在<strong class="it hj">图3 </strong>中看到的，特殊的f检验表明，模型中剩余的3个变量在5%的置信水平下具有统计显著性(不同于0)(<em class="kw">p值</em> &lt; 0，05)。</p><p id="bf4f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我将使用命令<strong class="it hj"> 'summary(modelo)' </strong>来观察估计的系数、需要移除的截距以及模型的最终<strong class="it hj"> R </strong>。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="9043" class="ko kp hi kk b fi kq kr l ks kt">summary(modelo)</span></pre><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/5938b93c00d5d736ba31583d8dbe7432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*oTd_9ZIFyM9jmi1TU6XJ9g.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图4:剩余变量的T检验。</figcaption></figure><p id="6bb2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在<strong class="it hj">图4 </strong>中显示的第一栏中，我们可以看到估计的系数。在5%的显著性水平上，T检验证实了所选变量不同于0，但截距不是(<em class="kw"> p值</em> = 0，81311 &gt; 0，05)的显著性结果。所以，我将调整没有它的最终模型，以检查决定系数<strong class="it hj"> R </strong> (0，8919)是否会增加。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="c7c9" class="ko kp hi kk b fi kq kr l ks kt">The '-1' syntax express a model without intercept<br/>modelo&lt;-lm(HSM~VHF+VVI+AVI-1)<br/>summary(modelo)</span></pre><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es la"><img src="../Images/c0352b840d7bf1b860724046d7e88f09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*C6aFVwsEXzcme7VteJKjVw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图5:没有截距的最终模型的T检验。</figcaption></figure><p id="d2ef" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">去掉截距，<strong class="it hj"> R </strong>从0.8919跳到0.9968。</p><p id="f612" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">定义了模型的变量。是时候通过测试关于其残差的3个假设来检验模型的质量了:<strong class="it hj">正态性、方差齐性和独立性</strong>。</p><p id="ee1b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">为了检查残差是否正常，我们将使用<strong class="it hj">夏皮罗-维尔克</strong>检验。被测试的零假设是残差服从正态分布。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="8282" class="ko kp hi kk b fi kq kr l ks kt">shapiro.test(residuals(modelo))</span></pre><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/4b0af47088cb0327662616bb5ea4da80.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*TKgxaT9bOeRkCsjMcpcTGw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图6:夏皮罗-维尔克正态性检验。</figcaption></figure><p id="ba02" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">检验的<em class="kw"> p值</em> (0，475)高于5% (0，05)的显著性水平，因此我们没有证据拒绝零假设，这意味着残差被证明是正态的。</p><p id="60fc" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">为了测试残差的同方差性，我们将对它们进行排序(新月顺序)，并将排序后的值分成两组(一组具有最低的50%的值，另一组具有最高的50%的值)。然后，我们可以进行f检验，检查两个极端组之间的方差在统计上是否相等。换句话说，我们可以用“如果在一个组内形成的两个最不同的部分之间的方差在统计上相等，那么很明显这个组内的方差是同质的”这个论点来解释这个技巧。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="8d31" class="ko kp hi kk b fi kq kr l ks kt"># Homogeneity test of residual's variance<br/>ordenado&lt;-sort(residuals(modelo))<br/>res1&lt;-ordenado[1:10]<br/>res2&lt;-ordenado[11:21]<br/>var.test(res1, res2)</span></pre><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/3932e4cf1d4f9b687b18c60c954ea6e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*2W-XeoSxhAc0tyTd9_boDQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图7:比较方差的f检验。</figcaption></figure><p id="35b2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">0.4496(&gt;0.05)的<em class="kw"> p值</em>使我们不会拒绝两个方差的真实比率等于1的无效假设。换句话说，我们可以假设它们在统计上是相等的。</p><p id="73ee" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">最后，我们需要检查残差是否独立。我们将使用<strong class="it hj">德宾-沃森</strong>测试来完成这项工作。无效假设是它们是独立的。</p><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="a2d6" class="ko kp hi kk b fi kq kr l ks kt"># Test for residual's independency<br/>dwtest(modelo)</span></pre><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es la"><img src="../Images/09a49064dba8cc5a8199dac1784637d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*drFtquwC7QA6-rt1GaXBxg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图8:德宾-沃森独立性测试。</figcaption></figure><p id="de66" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们再次得到一个非显著的p值(大于5%的显著性水平)，所以零假设没有被拒绝。</p><p id="3384" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">随着由3个最终变量(“甚高频”、“VVI”和“AVI”)解释的跳跃高度的方差的99，68%以及所有3个被接受的假设，我们用一个有效的预测模型来结束我们的研究。</p></div></div>    
</body>
</html>