<html>
<head>
<title>Molecular Machine Learning: Introduction to building ML models to predict molecular properties.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分子机器学习:建立预测分子性质的ML模型介绍。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/molecular-machine-learning-introduction-to-building-ml-models-to-predict-molecular-properties-5918517e14ff?source=collection_archive---------13-----------------------#2020-01-03">https://medium.com/analytics-vidhya/molecular-machine-learning-introduction-to-building-ml-models-to-predict-molecular-properties-5918517e14ff?source=collection_archive---------13-----------------------#2020-01-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/84132eecd6087e769600b233a7d1619e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTULh5josW88Rrd53hHyRg.jpeg"/></div></div></figure><p id="dc3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">药物发现是一个昂贵而漫长的过程，充满了许多错误的线索和不成功的努力。制药业是世界上监管最严格的行业之一，政府实施了许多规则和法规来保护公众的健康和福祉。一种药物通过临床试验阶段的概率小于12%，大多数药物由于安全原因而失败[1]。在美国，一种实验性药物从理论到实践平均需要10-12年，临床试验大约需要6年的时间。研究和开发每种成功药物的平均成本估计为26亿美元。这个数字包含了失败的成本——在R&amp;D的早期阶段，可能会筛选和评估数千甚至数百万种化合物，但只有少数化合物最终获得批准[1]。因此，在简化药物开发流程方面，尤其是在药物进入临床试验之前的每一步，都有很大的改进空间。</p><p id="c0e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">幸运的是，制药和生物技术行业需要处理大量的数据，但实际上只有很小一部分数据经过处理，才能提供任何切实的结果。因此，有机会在药物发现的所有阶段应用机器学习方法，从药物靶标验证、生物活性预测、识别预后生物标志物等。[2].但是在我们可以将机器学习应用于分子之前，我们需要一种方法来以机器可以理解和使用的形式来表示它们。通常，当我们想到分子时，我们会想象用化学键相互连接的原子群。为了让机器处理分子数据，用线符号的形式表示它们是很重要的。这样的系统被称为<strong class="is hj">简化的分子输入行输入系统</strong> <strong class="is hj">(笑)。</strong>最初的SMILES规范始于20世纪80年代，它在使用短ASCII字符串描述化学物种的结构方面非常有用[3]。例如，字符串“OCC C1 C(C)[n+](CS1)cc 2 CNC(C)nc2N”代表重要的营养物质硫胺素，也称为维生素B1 [4]。大多数化学数据库利用药物的微笑字符串符号。</p><p id="abb3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们不需要记住这些符号，因为大多数现代分子编辑器可以自动将微笑字符串转换为2D或分子的3D模型。使用最重要的开源化学信息学和机器学习工具包RDKit [5]，它可以很容易地转换成python。模块rdkit.Chem中包含绝大多数基本分子功能。以下代码显示了如何将硫胺素微笑字符串转换为2D分子表示。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/5c7df7cef563245e1ff2c51dee75408f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KCwd9qDtSN8-2gHfOjh58w.png"/></div></div></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/e1fc0b2c120661869f5172b7d1e778c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Skl2C2svmL3DqPcC4GeCDQ.png"/></div></figure><p id="c6f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">即使微笑字符串允许我们根据字符串的序列来考虑分子，它仍然不是许多机器学习模型的正确格式。这是因为分子通常具有不同的原子数和不同的序列长度。许多ML模型要求输入长度相同。为了解决这个问题，我们必须将微笑字符串转化为固定长度的向量[4]。有很多方法可以做到这一点，但在这篇博客文章中，我们将重点关注两种方法，甚至对这两种方法进行最大似然预测，看看它们的表现如何。我们将使用来自http://moleculenet.ai/datasets-1的生物物理艾滋病数据集。MoleculeNet管理多个公共数据集，建立评估指标，并提供多个先前提出的分子特征和学习算法的高质量开源实现。</p><h1 id="b762" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">扩展连接指纹:</strong></h1><p id="4317" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">关于ECFP，我不会说太多细节，因为有一篇很好的博文描述了不同种类的分子指纹，更多细节请查看[6]。基本上，扩展连接指纹(ECFP)是1和0的向量，代表分子中特定特征的存在或不存在。他们提取分子的特征，将它们散列，并使用散列来确定应该设置为向量的位[7]。这有助于结合分子的几个有用的特征，并把任意大小的分子转换成固定长度的向量[4]，以备在ML模型中使用。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/c55d13e937dde1901b5b26618315da00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGL9xqnsP2MxFAloC6DtGw.png"/></div></div></figure><p id="107d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它们使得比较不同的模型变得容易，因为我们可以简单地获取两个分子的指纹并比较相应的元素。匹配的元素越多，分子就越相似。ECFP的唯一缺点是，指纹编码了大量关于分子的信息，但有些信息会丢失。两个不同的分子可能有相同的指纹，给定一个指纹，不可能唯一地确定它来自哪个分子[4]。</p><p id="eb0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以通过在MoleculeNet.ai的数据集上应用指纹来看看指纹是如何工作的。你可以从以下链接下载数据集<a class="ae ju" href="https://s3-us-west-1.amazonaws.com/deepchem.io/datasets/molnet_publish/hiv.zip" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">艾滋病毒</strong> </a>。一旦我们解压缩文件，我们可以看看文件包含什么。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/71ad43f7be6f30c53bb4b2c7d39c0dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5u_mIRNsLI879A8K-qNQA.png"/></div></div></figure><p id="b5ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">HIV数据集由药物治疗计划(DTP)艾滋病抗病毒筛选引入，该筛选测试了超过40，000种化合物抑制HIV复制的能力。对筛查结果进行评估，并将其分为三类:确认不活跃(CI)、确认活跃(CA)和确认中度活跃(CM)。他们还为筛查结果提供了另一个带有二元标签的列:1(表示CA/CM)和0 (CI)。</p><p id="5156" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在来看看，当我们表演ECFP时，这些微笑线会发生什么变化。我们将需要一个新的库来做这件事，它叫做deepchem，你可以在这里了解更多关于他们的信息<a class="ae ju" href="https://deepchem.io/" rel="noopener ugc nofollow" target="_blank">https://deepchem.io/</a>。当我们想要处理化学数据集时，这是一个非常有用的包，它基于RDKit工具包。我们可以如下描述数据集中的SMILES列。我们可以看到，我们最终得到了一个包含1025列的数据帧。这是因为在实例化featurizer模块时，我们将大小设置为1024。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/75ae1453892adae9ab1fd0d1b9683cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N__t960fesFeinJn7GqcqQ.png"/></div></div></figure><p id="34e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在特征化过程中，分子被分解成更小的环状亚结构。该亚结构包含一个中心原子，其相邻原子按距中心的距离分组[8]。在散列了所有的子结构之后，我们得到了一个固定长度的二进制指纹。据认为，这种二进制表示包含有关分子拓扑特征的信息，这使其能够应用于类似搜索和活性预测等任务[9]。</p><p id="49c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们查看在这个数据集上执行的测试的最新结果时，我们发现Xgboost表现最好，roc/auc得分为0.841[【http://moleculenet.ai/latest-results】T2]。在这篇博文中，我们将在我们的特色数据集上实现一个基本的lightGBM模型，以检查它与Xgboost相比表现如何。我们可以如下实现它:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/7114d8d6794c55656c13a4d46d1742cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQ3Z1WjCz6pOjtIKfqyH7w.png"/></div></div></figure><p id="ccac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们查看最终迭代的roc_auc_score时，我们发现得分为0.73。对于一个没有进行脚手架拆分的基本版本，我认为这个模型做得很好。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/ff696866eeb9f5b15f6cfb3ab73afc02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i7U7br5geG4sKfRENNMrAw.png"/></div></div></figure><p id="1741" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于博客文章的最后一部分，我们可以看看另一种特征化方法，它可以用于大多数基于图形的模型。我们将在deepchem中实现整个代码，看看在deepchem中构建一个简单的DL模型有多容易。</p><h1 id="5f9b" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">图形卷积:</strong></h1><p id="0e09" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">尽管ECFP在表征分子数据方面做得很好，但它在识别化合物的环状结构方面存在严重缺陷。这是因为分子本质上是图形，每个原子可以被看作节点，它们之间的键可以表示边。许多真正重要的问题通常以图的形式出现，如社会网络、知识图、蛋白质相互作用网络。然而，直到最近，很少有人关注试图重构神经网络体系结构以处理结构化图形。这导致了一些真正强大的图形卷积网络的创建，这些网络可以很容易地用它们的二维表示来表示节点的接近程度。如果你想了解更多关于图卷积网络的知识，你可以看看下面两篇博文[12，13]。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/9c2bec5642ced183260e4381ef3f2e32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u18ejgq41KaZEddoSK1sUA.jpeg"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">图片来自</figcaption></figure><p id="8eda" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">图形卷积特征化为每个原子计算初始特征向量和邻居列表。该特征向量以包含相邻原子类型、杂化类型和价结构的列表的形式总结了原子的局部环境。该列表表示整个分子的连接性，可以通过基于图形的模型处理成一般的图形结构。Deepchem包带有一个方便的模块来加载MoleculeNet数据集，在加载数据集时，我们可以指定我们希望在数据集上执行哪种特征化。我们可以用几行代码实现整个加载和建模[4]。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/21425d8c22d17744ff89212a2534d587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXypghmq-FmIwVVcR25XEA.png"/></div></div></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/2d0aaa2d2a04fe2f09f298df9640cf90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bo-r93aIfiBklKfnExEevw.png"/></div></div></figure><p id="f9c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们计算最终指标时，我们看到我们的模型过度适合训练数据集，并且在测试数据集上的roc/auc得分为0.74。仍有改进的余地。在该数据集上使用GraphConv的官方基准是roc/auc得分0.79。考虑到这只是来自深度化学库的GraphConv模型的开箱即用实现，我们的分数还不算太差。如果我们真的想，我们可以改变一些参数，以确保我们达到基准性能。</p><h1 id="8bb7" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">参考文献:</strong></h1><ol class=""><li id="05fb" class="lj lk hi is b it kt ix ku jb ll jf lm jj ln jn lo lp lq lr bi translated"><a class="ae ju" href="http://phrma-docs.phrma.org/sites/default/files/pdf/rd_brochure_022307.pdf" rel="noopener ugc nofollow" target="_blank">http://phr ma-docs . phr ma . org/sites/default/files/pdf/rd _ book _ 022307 . pdf</a></li></ol><p id="0c89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.Vamathevan，j .，Clark，d .，Czodrowski，P. <em class="ls">等</em>机器学习在药物发现和开发中的应用。<em class="ls">国家修订药物发现</em> <strong class="is hj"> 18，</strong>463–477(2019)doi:10.1038/s 41573–019–0024</p><p id="0991" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.<a class="ae ju" href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Simplified _ molecular-input _ line-entry _ system</a></p><p id="1ca6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.拉姆森达尔湾等。al (2019)生命科学的深度学习，奥赖利(2019年4月12日)</p><p id="eb91" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.<a class="ae ju" href="https://www.rdkit.org/docs/GettingStartedInPython.html" rel="noopener ugc nofollow" target="_blank">https://www.rdkit.org/docs/GettingStartedInPython.html</a></p><p id="f62a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.<a class="ae ju" href="https://towardsdatascience.com/a-practical-introduction-to-the-use-of-molecular-fingerprints-in-drug-discovery-7f15021be2b1" rel="noopener" target="_blank">https://towards data science . com/a-practical-introduction-to-use-of-molecular-fingerprints-in-drug-discovery-7f 15021 be 2 b 1</a></p><p id="6d5f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.【https://www.rdkit.org/UGM/2012/Landrum_RDKit_UGM. T4】Fingerprints.Final.pptx.pdf</p><p id="8126" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.<a class="ae ju" href="https://depth-first.com/articles/2019/01/11/extended-connectivity-fingerprints/" rel="noopener ugc nofollow" target="_blank">https://depth-first . com/articles/2019/01/11/extended-connectivity-fingerprints/</a></p><p id="47bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">9.<a class="ae ju" href="https://pubs.rsc.org/en/content/articlelanding/2018/sc/c7sc02664a#!divAbstract" rel="noopener ugc nofollow" target="_blank">https://pubs . RSC . org/en/content/article landing/2018/sc/c7sc 02664 a #！双摘要</a></p><p id="a60c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">10.胡萨玛尼，苏尼库玛。(2016).控制参数与辛烷异构体理化性质的相关性。应用数学和非线性科学。1.345–352.10.21042/AMNS</p><p id="1202" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">11.基普夫，托马斯&amp;韦林，马克斯。(2016).基于图卷积网络的半监督分类。</p><p id="9da8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">12.<a class="ae ju" href="https://towardsdatascience.com/how-to-do-deep-learning-on-graphs-with-graph-convolutional-networks-7d2250723780" rel="noopener" target="_blank">https://towards data science . com/how-to-do-deep-learning-on-graphs-with-graph-卷积网络-7d2250723780 </a></p><p id="5657" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi">13.</p><div class="lt lu ez fb lv lw"><a href="https://tkipf.github.io/graph-convolutional-networks/" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">图卷积网络有多强大？</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">许多重要的现实世界数据集以图表或网络的形式出现:社会网络、知识图表…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">tkipf.github.io</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk io lw"/></div></div></a></div></div></div>    
</body>
</html>