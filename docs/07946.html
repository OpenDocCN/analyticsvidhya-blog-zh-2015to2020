<html>
<head>
<title>7 Reasons why you should ABSOLUTELY know about fast.ai deep learning library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你应该绝对了解fast.ai深度学习库的7个理由</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/7-reasons-why-you-should-absolutely-know-about-fast-ai-deep-learning-library-890cf4e293de?source=collection_archive---------24-----------------------#2020-07-12">https://medium.com/analytics-vidhya/7-reasons-why-you-should-absolutely-know-about-fast-ai-deep-learning-library-890cf4e293de?source=collection_archive---------24-----------------------#2020-07-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/b45c127fcd676d5a8fdfc15b15f1f384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8dLf-HKeuKwj7iyf"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">Radek Grzybowski 在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="6816" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你是深度学习或机器学习的实践者，那就留下来吧。在这篇文章中，我将向你介绍一个名为fast.ai的令人敬畏的库，它有助于你的训练和模型构建过程。Fast.ai就像pytorch的包装器一样，是用python编写的。它增加了一些额外的功能，这些功能将在下面描述，使您在传统的深度学习任务中更有效率。所以，如果你还不知道fast.ai，你应该知道为什么。</p><h1 id="ab46" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak"> 1。更少的代码行</strong></h1><p id="ab44" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">深度学习或者说人工智能社区似乎有一种让一切变得更难的趋势。我不知道这是否是人们接管的不安全感，如果人工智能很容易，每个人都会开始这样做，或者他们实际上喜欢控制一切，或者也许他们只是喜欢自己实现一切。我也是同类，写很长的python脚本，试图从零开始想出一个模型等等。相信我，这些都不重要，唯一重要的是结果，以及你是怎么做到的。例如，如果你只想使用像<em class="ld"> keras </em>这样的高级api，而对基础知识一无所知，你将无法诊断你的模型。另一方面，如果你喜欢自己完成所有的事情，你会浪费大量的时间去完成最简单的事情。Fast.ai库提供了一种非常简单的方法，仅用15行代码就可以达到最先进的精度。</p><figure class="le lf lg lh fd hk"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="85a4" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">看起来需要更少的时间，信不信由你，这就是在fast.ai中创建一个好的图像分类器所需的时间。数据是根文件夹，其中有你想要分类的图像，这些图像根据它们的类别被分离到不同的文件夹中。</p><h1 id="1810" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak"> 2。一个循环学习</strong></h1><p id="717e" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">Fast.ai库利用了著名的单周期学习，这使得神经网络的学习过程更快。有太多的<em class="ld">优化器</em>，它们倾向于调整<em class="ld">学习速率或梯度步骤</em>，以使学习过程更快、更有效。有一个<em class="ld">动量</em>，它利用了这样一个想法，如果先前的梯度在相同的方向上，就采取较大的步长，如果你得到与先前计算的梯度相反的方向，就采取较小的步长。有<em class="ld"> ADAM </em>和<em class="ld"> ADAGRAD </em>为所有维度提出不同的“<em class="ld">有效学习率”</em>的想法，并在我们进行的过程中修改学习率。然而，我发现成熟的ADAM有时比最简单的优化器——随机梯度下降法——表现更差。一个周期学习并不是一个不同的优化器，而是一种逐渐增加学习率，然后在每个时期再次降低学习率的方法，以确保您永远不会陷入任何局部最优。它不是不可战胜的或神奇的，它仍然会给你带来一些问题，但一个周期的学习肯定会让生活变得简单得多。</p><pre class="le lf lg lh fd lk ll lm ln aw lo bi"><span id="d5b5" class="lp kb hy ll b fi lq lr l ls lt">#get the gist of how learning rate is varied over a single cycle</span><span id="d24f" class="lp kb hy ll b fi lu lr l ls lt">learn.recorder.plot_lr() #after training process</span></pre><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lv"><img src="../Images/5dd8c6670cc0f7682c5fbc92832c739c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6dQHZTCTrAk4X21aTRE4bQ.png"/></div></div></figure><h1 id="bc41" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">3.LR取景器</h1><p id="f1b9" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">没错，你没看错，<strong class="je hz"> <em class="ld">【学习率查找器】</em> </strong>。深度学习的教父之一Yoshua Bengio说，学习率是唯一最重要的超参数，我喜欢遵循他的每一条黄金建议。很多时候，你想出了一个不错的模型，你有世界上所有你需要的数据来解决你的问题，但似乎没有什么工作。嗯，我的朋友，那是因为你把你的<em class="ld">学习速度</em>设置错了。除了监控每个时期后的损失，看看你的损失发生了什么，你可以相应地增加或减少损失，你什么也做不了。当你的单个<em class="ld">纪元</em>需要几十秒左右的时间时，这似乎很有趣，但当这个数字开始上升到几分钟，更不用说几个小时时，这就相当令人沮丧了。不再沮丧，fast.ai来拯救。快速人工智能有一个令人惊叹的功能，称为<em class="ld"> LR </em> finder，它试图用一系列不同的学习率训练你的模型，并返回你一个漂亮的图，Y轴上有<em class="ld">损失</em>，x轴上有<em class="ld"> LR </em>。基本思想是在图最陡的地方使用学习率，同时降低损失。我猜那些快人工智能的小伙子是从霍格沃茨什么的来的。</p><pre class="le lf lg lh fd lk ll lm ln aw lo bi"><span id="a410" class="lp kb hy ll b fi lq lr l ls lt">#after creating your learner object </span><span id="f132" class="lp kb hy ll b fi lu lr l ls lt">learn.lr_find()<br/>learn.recorder.plot()</span></pre><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/b7112f671acf57a4d98489c4af5fd162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mUVeDR-Avg0hl1Y18BnMlg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用resnet18和MNIST调用lr_find得到这个图。最陡下坡在0.001和0.01之间</figcaption></figure><h1 id="79cb" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">4.他们记录一切</h1><p id="db88" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">没有更多的<code class="du lx ly lz ll b">from keras import callbacks</code> Fast.ai有这个漂亮的<em class="ld">学习者</em>对象，它将你的模型和数据绑定在一起，你训练这些<em class="ld">学习者</em>对象。它们似乎记录了你需要的每一点重要信息。所以下次你忘记导入<em class="ld">回调</em>或者不想浏览文档找到你需要的必要功能，那么fast.ai会支持你。</p><pre class="le lf lg lh fd lk ll lm ln aw lo bi"><span id="e0d6" class="lp kb hy ll b fi lq lr l ls lt">learn.recorder.plot_losses()</span></pre><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ma"><img src="../Images/2e74baa8b90587572e887d785bf95cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*26KzBPXzBupKO-qVumAmDg.png"/></div></div></figure><pre class="le lf lg lh fd lk ll lm ln aw lo bi"><span id="a116" class="lp kb hy ll b fi lq lr l ls lt">learn.recorder.plot_metrics()</span></pre><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mb"><img src="../Images/768ce930fb801a8880622b66e276e45f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ayL1qfBloAtVzzew69H4YQ.png"/></div></div></figure><h1 id="d2d7" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">5.用一半的内存和两倍的速度训练</h1><p id="caf1" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">我们钟爱的深度学习模型的训练一般发生在32位。综上所述，训练只不过是一系列32位浮点数的乘法运算。如果我们谈论的是预先训练的模型，这些数字通常会达到几千万。有时你可能会以一个<em class="ld">‘CUDA内存不足错误’</em>结束，这仅仅意味着你的<em class="ld"> gpu </em>已经用完了内存，你必须重启你的内核来让一切恢复正常。如果你在第一个时期遇到这个错误，那么你应该减少你的批量。Fast.ai库提供了一个非常简单的方法，让这些挫折减少一半。fast.ai中的<em class="ld"> learner </em>对象负责您的训练过程，它允许您选择将数字的大小减少到16位浮点数，这不仅在您的gpu上占用更少的空间，而且将训练时间减少了一半，因为乘法运算速度提高了2倍。最好的部分是，你不必去英伟达网站下载一堆脚本来实现这一点。我们只是在创建<em class="ld">学习者</em>对象时指定它。</p><pre class="le lf lg lh fd lk ll lm ln aw lo bi"><span id="9ac5" class="lp kb hy ll b fi lq lr l ls lt">learn = cnn_learner(data, models.resnet34, <br/>                          metrics = accuracy).to_fp16()<br/># Boom! Done!</span></pre><h1 id="98ed" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">6.微小的改进让你更有效率</h1><p id="a947" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">还记得从kaggle或HackerEarth下载数据集的日子吗，它带有一个<em class="ld">训练</em>和<em class="ld">测试</em>文件夹。fast ai中的<em class="ld">数据束</em>对象，也就是你如何在fast.ai中向模型提供数据，将一个<em class="ld">训练集</em>和<em class="ld">验证集</em>以及一个可选的<em class="ld">测试集</em>绑定在一起，并猜测它从你的训练集中随机采样的内容，并自己创建一个验证集。如果我们想特别选择我们的验证集，我们甚至可以提供一个文件。如果您想要查看您的图像分类数据集，只需调用<em class="ld"> show_batch </em>函数和您想要查看的图像数量。<strong class="je hz">数据块API </strong>似乎允许你从你拥有的任何格式的数据中创建你的<em class="ld">数据束</em>。不再需要为这些任务编写定制的生成器。</p><pre class="le lf lg lh fd lk ll lm ln aw lo bi"><span id="d086" class="lp kb hy ll b fi lq lr l ls lt">data.show_batch(rows = 3, figsize = (5, 5)<br/>#data is your data bunch object</span></pre><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mc"><img src="../Images/0abbc30ee5b7b3740deae4e1ebeaab9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*udnOYIOqTagaCSAmteaZcw.png"/></div></div></figure><p id="b7b8" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你正在使用pytorch的<em class="ld">数据加载器</em>，这里是你如何绘图</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es md"><img src="../Images/a2bcb0f73c8547b13f699aca1201533d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8Io2Fh3Qr0Mi-O8Mao-og.png"/></div></div></figure><h1 id="30f5" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">7.社区</h1><p id="859b" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">Fast.ai有一个伟大的学习者和实践者社区，如果你在任何地方卡住了，他们都非常乐意帮助你，这似乎不太可能，因为它太干净了。如果你正在使用fast.ai深度学习库，你必须做的最困难的事情是找出一种方法，从你手头的数据中创建一个<em class="ld">数据束</em>对象。我建议通读一下<strong class="je hz">数据块API </strong> <a class="ae hv" href="https://docs.fast.ai/data_block.html" rel="noopener ugc nofollow" target="_blank">文档</a>来掌握它的窍门，剩下的就像打印一样简单(“Hello World！”).fast.ai社区最好的一点是他们的创建者活跃在他们的论坛上。如果你是一个<em class="ld"> pythonista </em>并且知道如何处理事情，那么好消息是，Fast ai是用python编写的，仅仅是一个对<em class="ld"> pytorch </em>的包装。如果文档看起来有点混乱，人们可以简单地查看源代码。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="2c96" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">杰瑞米·霍华德和fast.ai的人们创造了这么棒的图书馆和MOOC来传播意识和培训人们。如果你是深度学习从业者或者数据科学爱好者，我强烈推荐你去看看。</p><p id="aa06" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你喜欢这本书，请给它一个掌声，或者你知道50！</p></div></div>    
</body>
</html>