<html>
<head>
<title>Deploy Python Dash application on Azure Cloud Web App for Windows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Azure Cloud Web App for Windows上部署Python Dash应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploy-python-dash-application-on-azure-cloud-web-app-for-windows-a68f77cff8fc?source=collection_archive---------7-----------------------#2020-05-07">https://medium.com/analytics-vidhya/deploy-python-dash-application-on-azure-cloud-web-app-for-windows-a68f77cff8fc?source=collection_archive---------7-----------------------#2020-05-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4491" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di">我们</span>将在windows和docker容器上的Azure web上部署本地托管的python dash应用程序。在这篇文章中，我使用了一个dash应用程序的例子，它很常见，可以从dash网站上获得，但是，它可以很容易地扩展到任何复杂的应用程序，并且很容易定制。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/d5cb89d6486806aab8c199737400c9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aZ_-kaFkVUk1wuRuzYYy-A.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">Azure应用部署</figcaption></figure><h2 id="5dca" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">目录:</h2><ol class=""><li id="b86b" class="kx ky hi ih b ii kz im la iq lb iu lc iy ld jc le lf lg lh bi translated">先决条件</li><li id="c0b7" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">本地托管小型python应用程序</li><li id="1845" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">在docker上创建本地虚拟环境的副本</li><li id="224a" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">通过docker推送内容进行部署</li><li id="aeae" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">启用/启动Azure webapp以使用更新的docker内容</li></ol><h2 id="3e41" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">1.先决条件</h2><p id="a991" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">在开始之前，我们必须考虑一些先决条件，以便成功地开发和部署解决方案，它们如下:<br/> a. Docker最新版本已安装<br/>b . Git CMD<br/>c . Python 3.8+<br/>d . Azure订阅</p><h2 id="e17c" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">2.本地托管小型python应用程序</h2><p id="3601" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">因为我们需要在azure上部署之前在本地准备我们的python应用程序，所以我们将在C驱动器上的合适位置创建一个工作目录。现在，在这个特定位置，我们将安装虚拟环境并激活它供我们使用。请在下面找到为此要遵循的步骤(需要在设置工作目录后执行):</p><blockquote class="lq lr ls"><p id="8d45" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">--&gt; pip 3 install-U pip virtualenv<strong class="ih hj"><em class="hi"><br/>--&gt;&gt;</em></strong>virtualenv—系统—站点—包—p python。/venv<br/>-&gt;\ venv \ Scripts \ activate</p><p id="d1b0" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">现在它应该为你启动虚拟环境。一旦venv启动，运行以下步骤设置文件夹:<br/>a . mkdir dash-azure&amp;&amp;CD。<br/> b .为我们的代码创建两个空白文件，application.py和docker file:<br/><code class="du lx ly lz ma b"> </code>touch application . py<br/><code class="du lx ly lz ma b"> </code>touch docker file</p></blockquote><p id="59e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦这些文件启动，让我们运行一些安装，这些安装将成为我们对该应用程序的依赖，并成为需求文件的一部分:</p><blockquote class="lq lr ls"><p id="e430" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">pip安装仪表板—升级</p></blockquote><p id="b09a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于这是一个小的应用程序，我们试图在这里建立，我们有很少的标准要求，所以我们将冻结所有这些要求</p><blockquote class="lq lr ls"><p id="eeba" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">pip冻结&gt; requirements.txt</p></blockquote><p id="c01c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一步中，我们将设置我们启动的应用程序代码，它应该如下所示:</p><blockquote class="lq lr ls"><p id="a840" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">导入dash <br/>将dash_core_components作为dcc导入<br/>将dash_html_components作为html导入</p><p id="affa" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">app = dash。dash()<code class="du lx ly lz ma b"><br/></code>application = app . server</p><p id="228c" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">app.layout = html。Div(children=[ <code class="du lx ly lz ma b"><br/></code> html。H1(children='Hello Dash ')，</p><p id="8e21" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">html。Div(children=''' <code class="du lx ly lz ma b"><br/></code>这是运行在Azure应用服务上的Dash''),</p><p id="fb10" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">dcc。Graph( <br/> id='example-graph '，<br/><code class="du lx ly lz ma b"> </code>figure = {<code class="du lx ly lz ma b"><br/></code>' Data ':[<code class="du lx ly lz ma b"><br/></code>{ ' x ':[1，2，3]，' y': [4，1，2]，' type': 'bar '，' name': 'SF'}，<code class="du lx ly lz ma b"><br/></code> {'x': [1，2，3]，' y': [2，4，5]，' type': 'bar '，' name': 'USA'}，【T4]，<code class="du lx ly lz ma b"><br/></code>，【布局':{【T6]'</p></blockquote><p id="1e28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，我们正在特定端口3000上启动应用程序，这是部署的最关键步骤，如果没有这一点，当我们在Azure中启动它时，由于端口80访问限制，一些用户可能会面临连接问题。但是，如果您没有任何限制，可以随意使用您喜欢的任何端口。</p><blockquote class="lq lr ls"><p id="1743" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">要检查python代码是否正常工作以及dash是否被正确托管，让我们运行一个查询并对其进行分析:<br/> python application.py <code class="du lx ly lz ma b"><br/></code>这将为您提供一个访问正在运行的应用程序的URL (http://127.0.0.1:3000 ),如果您能够访问本地托管的应用程序，则可以对其进行验证。</p></blockquote><h2 id="c28a" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">3.在docker上创建本地虚拟环境的副本</h2><p id="93cf" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">由于我们已经测试，应用程序正在本地运行，在这一步中，我们将在docker上创建图像，我希望docker已经启动并在后台运行。如果没有，docker可以从<a class="ae mb" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank">https://www.docker.com/products/docker-desktop</a><br/>安装注意:您需要在docker上创建一个帐户，所以在我们安装之前，让我们创建一个帐户并登录。</p><p id="45d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们首先更新我们之前创建的docker文件，并将这些代码粘贴如下:<br/> Dockerfile</p><blockquote class="lq lr ls"><p id="6479" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">来自python:3.8-slim</p><p id="9a23" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">曝光3000</p><p id="8031" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">运行mkdir /app <br/> WORKDIR /app <br/>添加需求. txt /app/ <br/>运行pip install -r需求. txt <br/>添加。/app/</p><p id="4e7b" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">入口点[" python "]<br/>CMD[" application . py "]</p></blockquote><p id="36fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦文件被更新和保存，让我们运行以下步骤在docker上构建我们的代码映像。</p><blockquote class="lq lr ls"><p id="783d" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">docker建筑-t dash-azure。docker run-it-RM-p 3000 dash-azure</p><p id="1c18" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">你可以在windows上的127.0.0.1:3000和mac上的0.0.0.0:3000上检查这个应用程序</p></blockquote><p id="f2be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">成功验证后，我们将用简单的3行代码将所有这些更改发布到docker，并使我们的容器能够包含所有最新的代码和部署需求。</p><h2 id="4fef" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">4.通过docker推送内容进行部署</h2><p id="e2a2" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">让我们登录docker并按如下所述将更改推送到图像，请注意用户名是您在docker应用程序上创建id时获得的用户名:</p><blockquote class="lq lr ls"><p id="e3ff" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">docker登录</p><p id="3d59" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">docker标签dash-azure (docker用户名)/dash-azure:1.0.0</p><p id="e27a" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">docker推送用户名/dash-azure:1.0.0</p></blockquote><p id="42c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦这些步骤成功完成，我们的应用程序就被正确地复制到docker，并准备好通过任何支持docker映像的云门户进行部署。</p><h2 id="d1c4" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">5.启用/启动Azure webapp以使用更新的docker内容</h2><p id="d807" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">由于我们一直在为azure web app工作，所以我们今天将重点关注Azure cloud。让我们登录云并启动一个新的web应用程序服务，如下所示:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mc"><img src="../Images/4431b4e7682dc27e827fef102c3bb624.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BspMsjhhLXiX4muz3v328w.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">Webapp创建页面</figcaption></figure><p id="7a6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择您选择的订阅和资源组，我们可以为我们的web应用程序命名任何我们喜欢的名称，但需要按照Azure是唯一的。</p><p id="deb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择Linux作为操作系统，并进入下一页进行docker设置。从发布选项中，我们选择Docker容器并转到下一页:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es md"><img src="../Images/56adeeb8a9f5d04337657373ce672b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XReRQgtY7XD46cJGOjgL2g.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">Docker配置</figcaption></figure><p id="42f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在该页面中，我们需要选择Docker Hub作为单个容器选项中的图像来源。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es me"><img src="../Images/8dfa7ff98b69e5480a1ba932063c98d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FsvVbbWcwVuYir4HKqz4rQ.png"/></div></div></figure><p id="1759" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择Docker hub后，我们需要放置我们的图像和标签名称，如本例所示。</p><p id="0823" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们点击创建应用程序，并等待此应用程序部署在Azure上。</p><p id="cd1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦应用程序部署，可以尝试使用公共网址访问它。然而，一些用户可能会面临问题，应用程序可能无法按时启动，因为我们需要更新一些默认设置，以绕过一些网络挑战。</p><p id="7271" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要做到这一点，如果你还记得，我们将端口3000设置为我们的应用程序和docker的一部分，这样当我们从azure启动时，我们可以在这个端口上访问相同的内容。因此，要实现这一点，我们需要在应用程序配置页面中添加一些设置，如下所述:<br/>使用EXPOSE并在docker文件post连接到python时放置值3000</p><blockquote class="lq lr ls"><p id="4af6" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">使用值为3000的WEBSITES_PORT应用程序设置暴露于该端口</p><p id="6a95" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">使用WEBSITES _ CONTAINER _ START _ TIME _ LIMIT并将值增加到400</p><p id="a532" class="if ig lt ih b ii ij ik il im in io ip lu ir is it lv iv iw ix lw iz ja jb jc hb bi translated">保存设置，重新将图像推送到docker，重启应用程序，web应用程序将恢复到本地运行时的状态。对于日志，请检查应用程序的容器日志。</p></blockquote><p id="ed65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦上述步骤完成，应用程序已重新启动，尝试启动应用程序再次与公共网址和万岁！！你的申请准备好了。</p><p id="3f42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这些信息是有用的！！您能够根据自己的需求部署应用程序。</p><p id="6c0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果有任何反馈或问题，请给我留言。</p><h2 id="3981" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">阿吉特·库马尔<br/>数据科学家</h2><p id="e0cd" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated"><a class="ae mb" href="https://www.linkedin.com/in/ajeet-kumar-53a97880" rel="noopener ugc nofollow" target="_blank">领英</a></p><p id="81f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此处表达的观点是我个人的，并不代表我的雇主或任何其他第三方的观点。</p></div></div>    
</body>
</html>