<html>
<head>
<title>Download Videos From TikTok With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从抖音下载视频</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/download-tiktoks-with-python-dcbd79a5237f?source=collection_archive---------1-----------------------#2020-07-09">https://medium.com/analytics-vidhya/download-tiktoks-with-python-dcbd79a5237f?source=collection_archive---------1-----------------------#2020-07-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0fdde0c5543c9946ee7ddef5cbbc1389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aWK6yDaBe7x5viez2VyeMw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@clark_fransa" rel="noopener ugc nofollow" target="_blank">阿诺德·弗朗西斯卡</a>在<a class="ae iu" href="https://unsplash.com/photos/f77Bh3inUpE" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="56b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在过去的几个月里，抖音的受欢迎程度迅速上升。你可以用抖音的数据做很多项目，在这个项目中，我们将从抖音下载视频。</p><p id="ff85" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你更喜欢视觉学习，看看我为使用这个API制作的视频。我将在那个频道发布更多与逆向工程网站相关的内容，如果你对此感兴趣，请订阅。此外，请随意查看我的另一个<a class="ae iu" href="https://www.youtube.com/c/davidteather" rel="noopener ugc nofollow" target="_blank"> YouTube频道</a>，这是与编程和工程相关的更有趣的内容:)</p><p id="4134" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了能够从python中检索抖音数据，运行以下命令来安装一个库来帮助我们。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="81d3" class="kc kd hi jy b fi ke kf l kg kh">pip install TikTokApi</span></pre><p id="4684" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，您应该运行以下命令来安装剧作家</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="36d8" class="kc kd hi jy b fi ke kf l kg kh">python -m playwright install</span></pre><p id="5ae0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们需要找到verifyFp值。要做到这一点，去tiktok.com在你的浏览器。</p><p id="43ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">点击url旁边的挂锁，如下图所示</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/dce2df33853f7e316fdf2bd230660121.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*rEn2IxFHat8-fEQ_xaOnjQ.png"/></div></figure><p id="4d79" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后点击cookies显示你当前的cookies</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/792c9be8bb2a2c1ce5d147da0c57271e.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*p5Ne70epNAN5HL8s107sWQ.png"/></div></figure><p id="a68a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">转到<a class="ae iu" href="http://www.tiktok.com" rel="noopener ugc nofollow" target="_blank">www.tiktok.com</a>-&gt;cookie-&gt;s _ v _ webid，然后复制s_v_webid cookie的内容并粘贴到verifyFp中</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/9d74e543e2c8c32e7db92b8eef7299c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*j9PtIeHuopnQ2QJarq4qpw.png"/></div></figure><p id="4c6c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们创建一个新的python文件，您可以随意命名它。我们将进行测试，以确保我们能够从python中检索抖音数据。在python脚本中输入以下内容。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="e10d" class="kc kd hi jy b fi ke kf l kg kh">from TikTokApi import TikTokApi<br/>import string<br/>import random<br/>did=''.join(random.choice(string.digits) for num in range(19))<br/>verifyFp="verify_YOUR_VERIFYFP_HERE"<br/>api = TikTokApi.get_instance(custom_verifyFp=verifyFp, custom_did=did)<br/>print(api.trending())</span></pre><p id="254e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">运行您的python脚本，希望它将以python字典格式输出数据。如果脚本没有做到这一点，请访问TikTokApi的GitHub页面,您的问题很可能已经在已关闭的问题部分得到解决，只需搜索您可能遇到的任何错误。</p><blockquote class="kl km kn"><p id="b7f9" class="iv iw ko ix b iy iz ja jb jc jd je jf kp jh ji jj kq jl jm jn kr jp jq jr js hb bi translated">verifyFp令牌似乎在大约2小时后过期，如果你在一个verifyFp下做了太多，它可能会抑制你的请求。目前，你可以通过做<code class="du ks kt ku jy b"><em class="hi">api = TikTokApi.get_instance(custom_verifyFp=verifyFp, use_test_endpoints=True</em></code>来规避这个问题，但是我不能保证这在将来会有效</p></blockquote><p id="5ce1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在将修改之前的python脚本，以便它可以下载抖音趋势分析。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9a78" class="kc kd hi jy b fi ke kf l kg kh">from TikTokApi import TikTokApi<br/>import string<br/>import random<br/>did=''.join(random.choice(string.digits) for num in range(19))<br/>verifyFp="verify_YOUR_VERIFYFP_HERE"<br/>api = TikTokApi.get_instance(custom_verifyFp=verifyFp, custom_did=did)<br/>print(api.trending())</span></pre><p id="1f5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们必须实际保存来自抖音的视频。首先，我们将使用python创建一个名为downloads的文件夹，如果它还不存在的话。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="1b45" class="kc kd hi jy b fi ke kf l kg kh">from pathlib import Path</span><span id="9f5b" class="kc kd hi jy b fi kv kf l kg kh">Path("downloads").mkdir(exist_ok=True) # creates folder</span></pre><p id="48df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在将遍历tiktoks变量中的数据，并将所有视频下载到downloads文件夹中。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="af6a" class="kc kd hi jy b fi ke kf l kg kh">for i in range(len(tiktoks)):<br/>    data = api.get_Video_By_TikTok(tiktoks[i])# bytes of the video<br/>    with open("downloads/{}.mp4".format(str(i)), 'wb') as output:<br/>        output.write(data) # saves data to the mp4 file</span></pre><p id="43c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你完了！如果你运行这个脚本，它应该下载30本TikToks到下载目录。</p><p id="5e64" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您想增加每次运行脚本时下载的TikToks的数量，请更改下面一行</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="259e" class="kc kd hi jy b fi ke kf l kg kh">tiktoks = api.trending()</span></pre><p id="da2e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">到下面</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="07e3" class="kc kd hi jy b fi ke kf l kg kh">count = 100<br/>tiktoks = api.trending(count=count)</span></pre><p id="2cb8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在你可以把100换成你想退多少。</p><blockquote class="kl km kn"><p id="cbbf" class="iv iw ko ix b iy iz ja jb jc jd je jf kp jh ji jj kq jl jm jn kr jp jq jr js hb bi translated">注意:最大数量约为2，000</p></blockquote><p id="a9be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以通过代理服务器发出请求，这样抖音就无法阻止你的IP地址发出请求。</p><blockquote class="kl km kn"><p id="8c97" class="iv iw ko ix b iy iz ja jb jc jd je jf kp jh ji jj kq jl jm jn kr jp jq jr js hb bi translated">注意:许多免费代理不起作用，因为抖音已经阻止这些IP地址发出太多请求。</p></blockquote><p id="9643" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了允许我们的脚本通过代理发出请求，让我们在脚本的顶部用我们的代理IP地址创建一个新变量。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="f8d5" class="kc kd hi jy b fi ke kf l kg kh">proxy_address = "http://xxx.xxx.xxx:XXXX"</span></pre><p id="bcb3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">或者API支持以下用户身份验证</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="244c" class="kc kd hi jy b fi ke kf l kg kh">proxy_address = "http://user:password@xxx.xxx.xxx:XXXX"</span></pre><blockquote class="kl km kn"><p id="6ce0" class="iv iw ko ix b iy iz ja jb jc jd je jf kp jh ji jj kq jl jm jn kr jp jq jr js hb bi translated">注意:确保您的代理使用正确的http方案(https或http)。</p></blockquote><p id="c9b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要修改我们的脚本，只需将<code class="du ks kt ku jy b">proxy=proxy_address</code>作为参数添加到下面几行中。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="8d66" class="kc kd hi jy b fi ke kf l kg kh">tiktoks = api.trending(count=count)</span><span id="4f70" class="kc kd hi jy b fi kv kf l kg kh">data = api.get_Video_By_TikTok(tiktoks[i])</span></pre><p id="a977" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这样它们看起来就像</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="061a" class="kc kd hi jy b fi ke kf l kg kh">tiktoks = api.trending(count=count, <!-- -->proxy=proxy_address<!-- -->)</span><span id="5bda" class="kc kd hi jy b fi kv kf l kg kh">data = api.get_Video_By_TikTok(tiktoks[i], <!-- -->proxy=proxy_address<!-- -->)</span></pre><blockquote class="kl km kn"><p id="92ef" class="iv iw ko ix b iy iz ja jb jc jd je jf kp jh ji jj kq jl jm jn kr jp jq jr js hb bi translated">注意:通过代理发出的请求比没有代理时要慢，并且对于大的计数值会花费相当多的时间。</p></blockquote><p id="5746" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">没有代理的完整脚本</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="999c" class="kc kd hi jy b fi ke kf l kg kh">from TikTokApi import TikTokApi<br/>import string<br/>import random<br/>did=''.join(random.choice(string.digits) for num in range(19))<br/>verifyFp="verify_YOUR_VERIFYFP_HERE"<br/>api = TikTokApi.get_instance(custom_verifyFp=verifyFp, custom_did=did)<br/>print(api.trending())</span><span id="b68f" class="kc kd hi jy b fi kv kf l kg kh">count = 100</span><span id="ce13" class="kc kd hi jy b fi kv kf l kg kh">tiktoks = api.trending(count=count)</span><span id="b073" class="kc kd hi jy b fi kv kf l kg kh">from pathlib import Path</span><span id="fd4b" class="kc kd hi jy b fi kv kf l kg kh">Path("downloads").mkdir(exist_ok=True)</span><span id="5894" class="kc kd hi jy b fi kv kf l kg kh">for i in range(len(tiktoks)):</span><span id="5b55" class="kc kd hi jy b fi kv kf l kg kh">    data = api.get_Video_By_TikTok(tiktoks[i])# bytes of the video</span><span id="dc66" class="kc kd hi jy b fi kv kf l kg kh">    with open("downloads/{}.mp4".format(str(i)), 'wb') as output:</span><span id="8272" class="kc kd hi jy b fi kv kf l kg kh">        output.write(data)</span></pre><p id="26c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代理的完整脚本</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9047" class="kc kd hi jy b fi ke kf l kg kh">from TikTokApi import TikTokApi<br/>import string<br/>import random<br/>did=''.join(random.choice(string.digits) for num in range(19))<br/>verifyFp="verify_YOUR_VERIFYFP_HERE"<br/>api = TikTokApi.get_instance(custom_verifyFp=verifyFp, custom_did=did)<br/>print(api.trending())</span><span id="64e4" class="kc kd hi jy b fi kv kf l kg kh"># Change the line below</span><span id="212a" class="kc kd hi jy b fi kv kf l kg kh">proxy_address = "http://xxx.xxx.xxx:XXXX"</span><span id="9fa7" class="kc kd hi jy b fi kv kf l kg kh">count = 100</span><span id="7ccf" class="kc kd hi jy b fi kv kf l kg kh">tiktoks = api.trending(count=count, proxy_address)</span><span id="d474" class="kc kd hi jy b fi kv kf l kg kh">from pathlib import Path</span><span id="05c5" class="kc kd hi jy b fi kv kf l kg kh">Path("downloads").mkdir(exist_ok=True)</span><span id="dceb" class="kc kd hi jy b fi kv kf l kg kh">for i in range(len(tiktoks)):</span><span id="24c7" class="kc kd hi jy b fi kv kf l kg kh">data = api.get_Video_By_TikTok(tiktoks[i], proxy_address)</span><span id="e1e4" class="kc kd hi jy b fi kv kf l kg kh">with open("downloads/{}.mp4".format(str(i)), 'wb') as output:</span><span id="02f9" class="kc kd hi jy b fi kv kf l kg kh">output.write(data)</span></pre><p id="997e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢你阅读我的文章，希望对你有所帮助！</p></div></div>    
</body>
</html>