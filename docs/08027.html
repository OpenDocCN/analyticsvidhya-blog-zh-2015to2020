<html>
<head>
<title>AutoML: Taking TPOT to the Movies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带TPOT去看电影</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automl-taking-tpot-to-the-movies-cf7e6f67f876?source=collection_archive---------9-----------------------#2020-07-15">https://medium.com/analytics-vidhya/automl-taking-tpot-to-the-movies-cf7e6f67f876?source=collection_archive---------9-----------------------#2020-07-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/2140b667eb99fa7d5c773386adced450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rS774Dl7GVfToyJlaKsOg.png"/></div></div></figure><div class=""/><h1 id="fff6" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">概观</h1><p id="e202" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">本文的目的是详细介绍我对自动机器学习工具TPOT的探索。首先，我将简要介绍autoML的概念。然后，我将给出一个TPOT工具的概述。了解背景信息后，我们将进入电影推荐场景。我将介绍问题、数据、我们场景中TPOT的实现，以及从场景中收集的结果。最后，我将提供一些TPOT作为工具的分析，并提出一些如何将其构建到机器学习操作中的想法。</p><h1 id="9c30" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">什么是AutoML？</h1><p id="771d" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">机器学习行业在过去几年已经起飞。根据Tractica的数据，全球机器学习行业预计到2025年将增长到1260亿美元，年复合增长率为43%。</p><p id="2ab4" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">标准的机器学习模型开发需要在机器学习和应用领域都有很强的领域知识。它还需要大量的时间来运行实验，使用强力试错法来寻找解决方案。埃德·费尔南德斯在《机器学习的现状》中解释了人工智能产业。</p><blockquote class="ks kt ku"><p id="7571" class="jo jp kr jq b jr km jt ju jv kn jx jy kv ko kb kc kw kp kf kg kx kq kj kk kl hb bi translated">尽管付出了巨大的努力，包括公司在过去几年对ML项目和计划的投资，但只有一小部分ML模型进入生产并交付切实的成果。</p></blockquote><p id="7bf1" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">由于缺乏有经验的机器学习专业人员以及他们要求的高薪，许多公司难以投入生产。在写这篇文章的时候，LinkedIn上目前有3.8万个与机器学习相关的工作，机器学习员工的年薪通常为10万至30万美元。⁴</p><p id="7d93" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">AutoML试图解决其中的一些问题。目标是自动化模型开发的数据预处理和模型优化步骤。这包括数据整形、特征选择、算法选择和算法评估。这不仅提高了机器学习工程师的生产率，还降低了对领域知识的需求。</p><p id="701f" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">一些流行的autoML开源工具有<a class="ae ky" href="https://mlbox.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> MLBox </a>、<a class="ae ky" href="https://automl.github.io/auto-sklearn/master/" rel="noopener ugc nofollow" target="_blank"> Auto-Sklearn </a>、<a class="ae ky" href="https://www.h2o.ai/" rel="noopener ugc nofollow" target="_blank"> H2O.ai </a>和<a class="ae ky" href="https://autokeras.com/" rel="noopener ugc nofollow" target="_blank"> AutoKeras </a>。</p><p id="6609" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">大型行业领导者也在将autoML工具产品化，如Google的<a class="ae ky" href="https://cloud.google.com/automl/" rel="noopener ugc nofollow" target="_blank"> Cloud AutoML </a>和SaleForce的<a class="ae ky" href="https://transmogrif.ai/" rel="noopener ugc nofollow" target="_blank"> TransmogrifAI </a>。</p><p id="0bb2" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">然而，今天我们要看一看<a class="ae ky" href="https://epistasislab.github.io/tpot/" rel="noopener ugc nofollow" target="_blank"> TPOT </a>。</p><h1 id="bab6" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">什么是TPOT？</h1><p id="62c2" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">TPOT代表“基于树的管道优化工具”。它是一个autoML工具，专注于创建一个优化的ML管道。这个管道包括选择最佳的预处理器步骤、机器学习算法和模型超参数。</p><figure class="la lb lc ld fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kz"><img src="../Images/14e06224c336d01064a8433ea609f9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yc5A3nvnQjC8k7HGdsXFxg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">【http://epistasislab.github.io/tpot/ T2】号</figcaption></figure><p id="b454" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">TPOT是由宾夕法尼亚大学的Randal S. Olson等人创建的一个自动化工具。它建立在流行的python机器学习库<a class="ae ky" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>之上，并使用相同的API语法。这样一来，开发者就很容易拿起来。</p><p id="0a46" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">TPOT使用遗传编程(一种进化计算技术)来寻找选择器、转换器和估计器的最佳组合，以解决机器学习问题，同时试图限制流水线的复杂性。</p><h2 id="e466" class="li ir ht bd is lj lk ll iw lm ln lo ja jz lp lq je kd lr ls ji kh lt lu jm lv bi translated">TPOT的基因编程</h2><p id="91f3" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">如果您对如何实现TPOT更感兴趣，而不是对其内部工作方式感兴趣，请随意跳过这一节。</p><p id="c340" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">TPOT是用python编写的，使用<a class="ae ky" href="https://deap.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank"> DEAP库</a>来实现遗传编程。在初级水平上，TPOT使用遗传编程的方式和follows:⁵一样</p><ol class=""><li id="a9dc" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl mb mc md me bi translated">TPOT根据指定的总体初始化许多随机管道。对于这个例子，我们假设有100个管道。</li><li id="dad8" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">使用交叉验证和用户定义的评分函数来评估初始管道。</li><li id="608f" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">基于优化评分函数的结果和最小化流水线步骤的数量来对流水线进行排序。生成的前20个管道被选择用于下一代。</li><li id="3cf8" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">在下一代中，基于我们最初假设的100个群体，每个顶部管道产生5个子管道。5%的后代与其他管道交叉或混合，以创建一个部分类似于被组合来创建它的两个管道的管道。剩下的90%的后代接受随机突变。这种变异可以在管道中添加一个步骤，从管道中删除一个步骤，改变步骤中使用的函数，或者改变函数的超参数。</li><li id="8d68" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">这些新管道再次使用交叉验证和用户定义的评分函数进行排名。</li><li id="983b" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">TPOT继续这一过程，直到它已经评估了每一代产生的所有管道。(代数由用户指定)</li></ol><p id="dffd" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这实际上类似于自然选择。最佳管线的特性在每一代中都存在，而小的突变被应用来搜索更大的优化。最终把最好的管道还给用户。</p><h1 id="beaa" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">电影推荐</h1><figure class="la lb lc ld fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mk"><img src="../Images/1ccc93f5107cebde034d2ea6c7102b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rxfpbJ6nq6r9ezyq"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">查尔斯·德鲁维奥在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="6a42" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们将使用TPOT的领域是一直流行的电影推荐引擎。在这个简单的场景中，我们正在构建一个基于流媒体服务的电影推荐系统，类似于网飞。我使用了Kafka服务，该服务可以传输用户正在观看的电影和他们提交的电影评级的数据。原始数据有大约100万用户和大约2.7万部电影。我流式传输这些数据，对其进行解析，并将其保存在数据库中。</p><p id="080c" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">解决这个问题的一种常见方法是基于相似用户的偏好进行推荐，也称为协同过滤。然而，TPOT在其默认算法集中没有任何协同过滤算法。TPOT允许重要的<a class="ae ky" href="https://epistasislab.github.io/tpot/using/#customizing-tpots-operators-and-parameters" rel="noopener ugc nofollow" target="_blank">定制</a>，所以添加一个像<a class="ae ky" href="https://surprise.readthedocs.io/en/stable/getting_started.html" rel="noopener ugc nofollow" target="_blank"> surprise </a>包这样的库并不困难，它通常用于简单的协作过滤。</p><p id="289b" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们将使用关于用户和电影的数据来预测用户将如何在1-5的范围内对电影进行评分。如果我们想要对最高预测评级进行排序并推荐前n部电影，这可以用于推荐服务。我们将保持这个例子尽可能的简单，以保持对autoML方面的关注；因此，我们将只根据模型预测用户评分的准确性来评估模型，而不是根据它生成前n名推荐列表的准确性来评估模型。然而，在整个示例中，我们将牢记建议方面，以考虑该场景的含义。</p><h2 id="3dc6" class="li ir ht bd is lj lk ll iw lm ln lo ja jz lp lq je kd lr ls ji kh lt lu jm lv bi translated">数据</h2><p id="27c8" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">让我们来看看我们的数据。这些是我们正在使用的功能:</p><ul class=""><li id="529e" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl ml mc md me bi translated">年龄—我们预测其评级的用户的年龄</li><li id="d253" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">性别—用户的性别</li><li id="878a" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">职业——用户的职业</li><li id="b7ca" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">预算——电影的预算</li><li id="4e78" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">类型——电影的类型分为二元特征</li><li id="9a4d" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">流行度—来自第三方API的流行度指标</li><li id="3607" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">production _ companies生产中涉及的公司分为二元要素</li><li id="9f4f" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">制片国家——电影的制片国家</li><li id="f38e" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">年份—电影发行的年份</li><li id="654f" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">月份——电影发行的月份</li><li id="9c82" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">收入——电影的总收入</li><li id="d9ea" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">运行时间—电影的长度</li><li id="225f" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">口语—电影中使用的语言</li><li id="5e30" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">vote_average —来自第三方API的评级</li><li id="c5c1" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">vote_count —提交给第三方API的评级数量</li></ul><p id="a527" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">由于二进制特性，我们总共有227个特性(列)和740，732个实例(行)。正如你可能想象的那样，这些特性中的一些看起来像是用户评级的重要指标，而另一些看起来几乎毫无用处。比如投票数大概和热门电影有关联；因此，用户可能更有可能对这些电影进行高度评价。另一方面，这部电影是在埃及制作的这一事实似乎并没有提供太多的信息。</p><h2 id="713b" class="li ir ht bd is lj lk ll iw lm ln lo ja jz lp lq je kd lr ls ji kh lt lu jm lv bi translated">履行</h2><p id="5535" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在我们有了一些数据，我们准备使用TPOT。我将在这里强调实现的主要方面，但是如果您想了解更多细节，有三种方法。</p><ul class=""><li id="4059" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl ml mc md me bi translated"><a class="ae ky" href="https://github.com/bialesdaniel/se4ai-i5-tpot" rel="noopener ugc nofollow" target="_blank"> GitHub Repo </a> —这是TPOT管道优化的代码实现。它使用模块化代码，与您实际实现TPOT的方式非常相似。</li></ul><div class="hh hi ez fb hj mm"><a href="https://github.com/bialesdaniel/se4ai-i5-tpot" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hu fi z dy mr ea eb ms ed ef hs bi translated">bialesdaniel/se4ai-i5-tpot</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">这个回购展示了如何使用TPOT来训练一个最佳的管道来预测用户将如何评价电影中的电影…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">github.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na hp mm"/></div></div></a></div><ul class=""><li id="6202" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl ml mc md me bi translated"><a class="ae ky" href="https://github.com/bialesdaniel/se4ai-i5-tpot/blob/master/notebooks/TPOT_Movies_Explained.ipynb" rel="noopener ugc nofollow" target="_blank"> Python笔记本</a> —在GitHub repo中，我创建了一个可以本地运行的Python笔记本。</li></ul><div class="hh hi ez fb hj mm"><a href="https://github.com/bialesdaniel/se4ai-i5-tpot/blob/master/notebooks/TPOT_Movies_Explained.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hu fi z dy mr ea eb ms ed ef hs bi translated">biales Daniel/se4ai-i5-tpot/notebooks/TPOT _电影_Explaied.ipynb</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">在这个简单的场景中，我们正在构建一个基于流媒体服务的电影推荐系统…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">github.com</p></div></div><div class="mv l"><div class="nb l mx my mz mv na hp mm"/></div></div></a></div><ul class=""><li id="87a0" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl ml mc md me bi translated"><a class="ae ky" href="https://colab.research.google.com/drive/1nsFIhZ13uOkHjBzv_26IqAHXcfBeB9rV?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Colab </a> —如果你想在网上玩这个例子，只需将Google Colab笔记本复制到你的硬盘上。</li></ul><div class="hh hi ez fb hj mm"><a href="https://colab.research.google.com/drive/1nsFIhZ13uOkHjBzv_26IqAHXcfBeB9rV?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hu fi z dy mr ea eb ms ed ef hs bi translated">谷歌联合实验室</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">TPOT电影推荐</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">colab.research.google.com</p></div></div><div class="mv l"><div class="nc l mx my mz mv na hp mm"/></div></div></a></div></div><div class="ab cl nd ne gp nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="hb hc hd he hf"><p id="8163" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">首先，为了加快训练速度，我将使用一小部分数据样本。我用10，000个实例进行训练，用10，000个实例进行测试。</p><pre class="la lb lc ld fd nk nl nm nn aw no bi"><span id="85ef" class="li ir ht nl b fi np nq l nr ns">from tpot import TPOTRegressor</span><span id="462c" class="li ir ht nl b fi nt nq l nr ns">pipeline_optimizer=<br/>  TPOTRegressor(generations=100, population_size=100, verbosity=2, random_state=42, template='Selector-Transformer-Regressor', n_jobs=-1, warm_start=True, periodic_checkpoint_folder='/content/tpot-intermediate-save/')</span><span id="fdf7" class="li ir ht nl b fi nt nq l nr ns">pipeline_optimizer.fit(X_train, y_train)</span><span id="a47d" class="li ir ht nl b fi nt nq l nr ns">pipeline_optimizer.score(X_test, y_test)</span></pre><p id="735c" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">哇，那很简单。这将运行TPOT，创建最佳管道，并使用均方误差评估管道。让我们来看看我们指定的一些TPOT参数。</p><ul class=""><li id="a33c" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl ml mc md me bi translated"><code class="du nu nv nw nl b">generations</code> -这是TPOT将运行的管道生成的迭代次数。或者，您可以指定一个<code class="du nu nv nw nl b">max_time_minutes</code>在一定时间后停止TPOT。</li><li id="9a73" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated"><code class="du nu nv nw nl b">population_size</code> -这是每一代人训练的管道数量。</li><li id="5af6" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated">这只是给了我们一些反馈，让我们知道TPOT正在沸腾。搜索可能会花很长时间，所以我觉得这样可以确保它没有冻结。</li><li id="58ed" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated"><code class="du nu nv nw nl b">random_state</code> -这确保我们第二次运行时使用相同的种子。</li><li id="9bc8" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated"><code class="du nu nv nw nl b">template</code> -这描述了我希望我的管道是什么样子。我几乎没有做过功能工程，所以我想从选择器开始寻找最佳功能，然后转换这些功能，最后使用回归变量。如果我没有指定一个模板，TPOT会选择最合适的组合。在我的试验中，管道的形状最终会变成<code class="du nu nv nw nl b">Regressor-Regresssor-Regressor</code>。</li><li id="e3d0" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated"><code class="du nu nv nw nl b">n_jobs</code> -用于评估的并行进程的数量</li><li id="3cc8" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated"><code class="du nu nv nw nl b">warm_start</code> -这告诉TPOT是否重用最后一次调用‘fit()’时的群体。如果您想停止并重新开始拟合过程，这是很好的。</li><li id="3107" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl ml mc md me bi translated"><code class="du nu nv nw nl b">periodic_checkpoint_folder</code> -训练期间在哪里间歇保存管线。这有助于确保你得到一个输出，即使TPOT突然去世或者你决定提前停止训练。</li></ul><p id="588f" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">基于<code class="du nu nv nw nl b">generations</code>和<code class="du nu nv nw nl b">population_size</code>参数，TPOT将训练10，100条管道，并使用5重(另一个配置选项，但我只是使用默认)交叉验证和负均方误差评分函数对它们进行比较。它可能不会生成10，100个唯一管道，因为它会跳过生成的任何重复管道。此示例生成了大约2，500个不同的管道。可以想象，生成这么多管道并使用交叉验证对它们进行评估是非常耗时的。在我的本地机器上运行python笔记本花了大约6个小时。</p><p id="556b" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">有了机器学习，数据往往越多越好；因此，我决定尝试用50万个实例来训练TPOT，并用其余的数据进行测试。为了加快实验速度，我决定将<code class="du nu nv nw nl b">generations</code>减少到10，将<code class="du nu nv nw nl b">population_size</code>减少到50。即使减少了参数，数据量也大大降低了训练速度。使用本地笔记本运行它花了15个多小时，我从未能在Google Colab上成功完成。</p><h2 id="72f1" class="li ir ht bd is lj lk ll iw lm ln lo ja jz lp lq je kd lr ls ji kh lt lu jm lv bi translated">结果</h2><p id="4def" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">为了比较结果，我使用scikit-learn中的默认参数在大型数据集上训练了一个决策树。这个基本模型给了我1.44的均方误差。在小数据集上训练的TPOT模型具有0.99的均方误差。但是，如果我们将预测评级的分布与实际评级的分布进行比较，我们可以看到该模型主要预测的是多数类(~4)。</p><figure class="la lb lc ld fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nx"><img src="../Images/58764bc9535e0361684a0c471157604b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMeQh_0_hWQvM4hxItWixA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">预测评分(左)和实际评分(右)的分布。</figcaption></figure><p id="a957" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在大型数据集上训练的模型的均方误差为0.98，但预测的分布看起来好得多。</p><figure class="la lb lc ld fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ny"><img src="../Images/79bd9cbf6fa488c92d18ee05c11c2f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ie-9Yg7aGZieAPCC7cH9g.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">预测评分(左)和实际评分(右)的分布。</figcaption></figure><p id="36c3" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">然而，如果我们回想起我们试图解决的问题，这种改进的分配可能没有多大意义。在我们的场景中，错误值是没有意义的，因为我们只关心排序。如果一个预测错了整整两个点，但是所有的电影推荐对用户来说都是正确的顺序，那么这将是一个完美的模型。为了评估基于推荐等级的模型，我们需要提出一种不同的评估方法。然而，这超出了本文的范围。</p><h1 id="d777" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><h2 id="a390" class="li ir ht bd is lj lk ll iw lm ln lo ja jz lp lq je kd lr ls ji kh lt lu jm lv bi translated">好人</h2><p id="8957" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">总的来说，TPOT似乎是一个非常强大的工具。根据Adithya Balaji和Alexander Allen的论文，该论文对auto-sklearn、TPOT、auto ml和H2O进行了基准测试，当涉及到回归问题时，TPOT比其他三个表现得更好。⁶这个工具还有一些好处，从我上面对实现的描述中还看不出来。</p><ol class=""><li id="d9bb" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl mb mc md me bi translated">易于使用——如前所述，TPOT建立在scikit-learn之上，这使得它非常容易获取和使用。TPOT甚至可以选择将最终模型导出为python代码。这使得即使是开发新手也能很容易地使用这个工具。</li><li id="e2ce" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">可定制性——TPOT允许您定制优化过程的许多方面。您可以定义要将哪些算法或超参数引入随机突变。甚至可以定制用于确定最佳模型的评分函数。</li><li id="f501" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">大量的控制——TPOT允许您配置模型生成的所有主要方面。您可以定义从管线搜索应该运行的时间长度到最终管线的所需形状的所有内容。</li><li id="a341" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">节省时间——TPOT在功能工程方面节省了大量时间。我很少考虑哪些功能将是最有用的，但TPOT能够使用所有这些数据来生成一个有用的模型。</li><li id="2691" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">积极开发——TPOT目前维护良好。看起来维护者对GitHub问题的反应很迅速，并且正在努力为这个工具提供新的特性。从工程的角度来看，这一点很重要，因为您希望确保您使用的工具得到很好的支持并持续改进。</li></ol><h2 id="d8a8" class="li ir ht bd is lj lk ll iw lm ln lo ja jz lp lq je kd lr ls ji kh lt lu jm lv bi translated">坏事</h2><p id="c834" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在探索这个工具的时候，我发现了TPOT的一些缺点。我打赌你能猜到第一个是什么。</p><ol class=""><li id="49ea" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl mb mc md me bi translated">耗时——虽然我们节省了大量的特征工程时间，但在等待模型被训练时，我们又浪费了很多时间。根据要素的数量、数据的大小以及需要更新模型的频率，这可能会变得非常昂贵。记住，时间就是金钱。</li><li id="a73b" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">数据类型——不幸的是，TPOT目前在数据类型输入方面并不智能。它只处理数字数据类型。因此，我必须编写代码将一些分类特征转换成二进制特征。然而，TPOT可能正在努力增加一些智能数据清理。这个相关的数据清理<a class="ae ky" href="https://github.com/rhiever/datacleaner/issues/1" rel="noopener ugc nofollow" target="_blank">问题</a>从2016年就开始了。</li><li id="1c56" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">可解释性——由于TPOT是随机生成管道的，所以很难理解为什么某个模型可能表现得最好。这有点令人担忧，因为这可能意味着以后调试模型问题会很困难。</li><li id="4a6e" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">没有回归神经网络——由于TPOT可以为分类问题生成神经网络，我想在我们的问题空间中试验一下这个特性。然而，TPOT还不支持回归问题的神经网络。目前在<a class="ae ky" href="https://github.com/EpistasisLab/tpot/issues/1081" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上有一个问题正在追踪这个问题。</li></ol><h1 id="c019" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">你怎么能利用TPOT呢？</h1><figure class="la lb lc ld fd hk er es paragraph-image"><div class="er es nz"><img src="../Images/24f76eb9e85727003d3ad45d4b272eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*XF3akvvCtNu3u2745BPBLQ.jpeg"/></div></figure><p id="dae0" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">以下是关于如何在你的模型开发过程中使用TPOT的想法。这些想法处于不同的成熟阶段。我想澄清一下，我还没有在生产系统中实现TPOT，所以这些想法完全是基于我的实验和研究。</p><ol class=""><li id="a0ac" class="lw lx ht jq b jr km jv kn jz ly kd lz kh ma kl mb mc md me bi translated">探索一个新的领域——TPOT的目的之一是，你不需要有太多问题空间领域的知识就能有效。在全新的领域，TPOT可能是一个很好的起点。把你所有的数据传给它，看看它会给出什么样的模型。这可以帮助你更好地理解这个领域，因为你知道为什么TPOT会产生这样的模型。</li><li id="f234" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">创建一个管道——显然，TPOT可以用来创建一个管道。如果您有时间生成模型并且互操作性不是问题，那么您可以通过TPOT运行您的数据来生成模型并在生产中使用该模型。</li><li id="0581" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">使用最佳模型解决难以调试的问题——在这种情况下，您有一个已经存在的模型，但是有一个问题您无法解决。例如，一个子群体欺骗了模型，而你却找不到解决方案。您可以使用TPOT生成解决您的问题的最佳模型。正如TPOT documentation,⁷所说，“TPOT旨在成为一个助手，通过探索你可能从未考虑过的管道配置，为你提供如何解决特定机器学习问题的想法，然后将微调留给更受约束的参数调整技术，如网格搜索。”在这种情况下，TPOT是作为集思广益的合作伙伴，提出新的想法来解决一个难题。</li><li id="884d" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">监控—您可以将TPOT作为监控的一部分(作为上限基准)。你可以花很长时间生成一个最优的TPOT管道，并跟踪该模型的性能。然后，当您生成您的实际生产模型(不使用TPOT)时，您可以看到您的模型有多接近最优解。</li><li id="a50f" class="lw lx ht jq b jr mf jv mg jz mh kd mi kh mj kl mb mc md me bi translated">测量模型退化——这个想法肯定有点离谱，所以请原谅我。对于您不经常重新训练您的模型的场景，您可以使用TPOT不断地重新训练一个基准模型。随着新数据的到来，它会重新训练并试图产生一个更好的模型。然后，您将对照TPOT模型跟踪您的实际生产模型的性能。这将有助于识别数据随着时间的推移实际上变得更加相关的情况。通过只跟踪生产模型的准确性，您不会注意到数据变得更加相关，因为模型将继续类似地执行。然而，通过不断地重新训练TPOT模型，你会发现它能够生成越来越好的模型，因为数据的相关性增加了。这会让你意识到你的生产模式已经过时，需要重新培训。</li></ol><p id="0d9e" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这是我目前掌握的全部信息。感谢您阅读我的文章。想了解更多关于TPOT的信息，请查看他们的文档。</p></div><div class="ab cl nd ne gp nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="hb hc hd he hf"><p id="0aba" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hu">参考文献</strong></p><p id="7b96" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">[1]“人工智能软件市场到2025年全球年收入将达到1260亿美元”，【Tractica.omdia.com】T4，2020年。【在线】。可用:<a class="ae ky" href="https://tractica.omdia.com/newsroom/press-releases/artificial-intelligence-software-market-to-reach-126-0-billion-in-annual-worldwide-revenue-by-2025/." rel="noopener ugc nofollow" target="_blank">https://tractica . om dia . com/news room/press-releases/artificial-intelligence-software-market-to-reach-1260亿年全球收入到2025年/。</a>【访问时间:2020年7月15日】。</p><p id="c84e" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">[2] E. Fernandez，《机器学习&amp; AI*产业的现状》，<em class="kr">中</em>，2020。【在线】。可用:<a class="ae ky" href="https://towardsdatascience.com/state-of-the-machine-learning-ai-industry-9bb477f840c8." rel="noopener" target="_blank">https://towardsdatascience . com/state-of-the-machine-learning-ai-industry-9bb 477 f 840 c 8。</a>【访问时间:2020年7月15日】。</p><p id="43fd" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">[3]“美国38000+机器学习岗位(新增1734个)”，<em class="kr">Linkedin.com</em>，2020。【在线】。可用:<a class="ae ky" href="https://www.linkedin.com/jobs/search/?geoId=103644278&amp;keywords=machine%20learning&amp;location=United%20States." rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/jobs/search/?geoId=103644278&amp;关键字=机器% 20学习&amp;地点=美国% 20州。</a>【访问时间:2020年7月15日】。</p><p id="9d3b" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">[4]《机器学习乔布斯| Glassdoor》，<em class="kr"> Glassdoor </em>，2020。【在线】。可用:<a class="ae ky" href="https://www.glassdoor.com/Job/machine-learning-jobs-SRCH_KO0,16.htm?jobType=fulltime&amp;minSalary=113600&amp;maxSalary=318800." rel="noopener ugc nofollow" target="_blank">https://www . glass door . com/Job/machine-learning-jobs-SRCH _ ko0，16.htm？job type = full time&amp;min salary = 113600&amp;maxSalary = 318800。</a>【访问时间:2020年7月15日】。</p><p id="a0b8" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">[5] R. Olson，“TPOT:用于自动化机器学习的基于树的流水线优化工具”，载于<em class="kr"> ICML: 2016 AutoML研讨会</em>，纽约州，2016年。</p><p id="6b32" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">[6] A. Balaji和A. Allen，“自动机器学习框架的基准测试”，Arxiv.org，2018年。【在线】。可用:<a class="ae ky" href="https://arxiv.org/pdf/1808.06492v1.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1808.06492v1.pdf</a>。[访问日期:2020年7月15日]。</p><p id="5665" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">[7] R .奥尔森，《利用TPOT — TPOT》，<em class="kr"> Epistasislab.github.io </em>，2020年。【在线】。可用:<a class="ae ky" href="https://epistasislab.github.io/tpot/using/#what-to-expect-from-automl-software." rel="noopener ugc nofollow" target="_blank">https://epistasislab . github . io/tpot/using/# what-to-expect-from-automl-software。</a>【访问时间:2020年7月15日】。</p></div></div>    
</body>
</html>