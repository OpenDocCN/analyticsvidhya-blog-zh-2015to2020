<html>
<head>
<title>Predict Floods in Southern Malawi : A Machine Learning Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测马拉维南部的洪水:机器学习方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predict-floods-in-southern-malawi-a-machine-learning-approach-3ba30e7c8fc6?source=collection_archive---------15-----------------------#2020-07-01">https://medium.com/analytics-vidhya/predict-floods-in-southern-malawi-a-machine-learning-approach-3ba30e7c8fc6?source=collection_archive---------15-----------------------#2020-07-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1df5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于我们如何在“马拉维洪水预测”Zindi竞赛中获得第五名的报道。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/abae2cda2ccd25364c5bc66903500771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4PLstvU9MEjhBcJASKTVw.jpeg"/></div></div></figure><p id="c098" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2019年12月的第二天，Zindi Platform与UNICEF &amp; Arm合作，推出了一项新的竞赛，奖金池为10，000美元，以预测2019年马拉维南部的洪水。参赛者有六个月的时间，在此期间，他们必须尽最大努力，才能登上榜首。</p><p id="b617" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我个人是3个月后才开始探索比赛的，也就是说离结束还有3个月。我有点不愿意报名，因为我认为已经晚了，从数据的性质来看，我可以看出这个比赛在某种程度上是一个“研究”比赛，需要大量的文档和文献回顾。但最终我还是报名了，原因有几个:</p><ul class=""><li id="3dc0" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">我们将使用地理空间数据，我以前没有使用这些数据的经验，所以这将是探索这些数据的最好机会。</li><li id="9ef8" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">数据集很小，所以在不过度拟合数据的情况下获得一个高性能的模型有点困难。</li><li id="2e6a" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">新冠肺炎隔离已经开始了，所以这将是一个人唯一能做的享受他的时间的事情</li></ul><p id="cf4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我有幸与我共事过的两个最聪明的人一起工作:Idrissa和Bakary。<br/>我们最终在478名数据科学家中获得了<strong class="ih hj">第五名。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/ef92b9f1ac1473e147a7bde0f3bb27a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*of12R5sUONpXo83mmrO6oA.png"/></div></div></figure><p id="e49e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇博文将提供我们解决方案的详细概述，并提供我们提出解决方案所需的见解。以下是目录:</p><ul class=""><li id="e776" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj">简介<br/> - </strong>问题陈述。<br/> -数据和竞争指标。<br/> -使用过的软件&amp;工具。</li><li id="e263" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">预处理<br/> </strong> -探索性数据分析。<br/> -去除噪声特征。<br/> -外部数据。<br/> -特色工程。</li><li id="ea7d" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">建模<br/> </strong> -随机森林模型。<br/> -黑仔射频参数:平均绝对误差。<br/> - XGBoost，LGBM，CatBoost，GBM … <br/> -集合预测。</li><li id="bd6d" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">后处理:<br/> </strong>后处理最终的集合预测。</li></ul><h1 id="4af6" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">简介</strong></h1><h2 id="8883" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">问题陈述</h2><p id="24fe" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">2019年3月14日，热带气旋Idai在莫桑比克贝拉港登陆，然后穿越该地区。马拉维、莫桑比克和津巴布韦的数百万人受到了南部非洲至少二十年来最严重的自然灾害的影响。</p><p id="466d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">近几十年来，非洲各国遭受洪灾的频率和严重程度都有所增加。马拉维在2015年和2019年都遭受了大洪水的袭击。事实上，在1946年至2013年期间，洪水占马拉维主要灾害的48%。马拉维南部与莫桑比克接壤的下希尔河谷由奇卡瓦和恩桑杰两个区组成，是最容易发生洪水的地区。</p><p id="2f82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这项挑战的目标是建立一个机器学习模型，帮助预测马拉维南部洪水的位置和范围。</p><h2 id="1123" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">数据和竞争指标</h2><p id="3d1d" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">在这次比赛中，马拉维南部的地图被分成了大约1平方公里的矩形。每个矩形都有一个唯一的ID。每个矩形都被分配了一个“目标”值，即该矩形在2015年被淹没的部分(百分比)。</p><p id="7a0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据是2015年马拉维南部的洪水范围，但是，我们被鼓励从其他邻近地区和其他历史洪水中获取其他洪水数据来训练我们的模型。(只是我们需要确保不使用2019年的数据，并且没有洪水地区的图像是解决方案的一部分)。</p><p id="159a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">衡量我们模型准确性的测试数据是2019年马拉维南部的洪水范围。</p><p id="4109" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据由大约16K的观察值(即16K的正方形矩形)组成，并且包括以下特征作为起点:</p><ul class=""><li id="74fa" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj">地理坐标:</strong>每个矩形的X，Y坐标。</li><li id="63d7" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">高程:</strong>矩形上空的平均高程。</li><li id="d681" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">主要土地覆盖类型:</strong>大部分地区以草原、稀树草原或农田为主。</li><li id="8f2b" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">每周降雨量:</strong>每个矩形的历史降雨量数据，从洪水前2个月开始，持续18周。</li></ul><p id="db6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目标是给定矩形被淹没的百分比，值在0和1之间。</p><p id="5381" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">竞赛的目标是最小化均方根误差:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lv"><img src="../Images/fe0d90e6da0357b15fe6d9d2616141e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*st1zZN7rHX8KYy_BZWYETg.png"/></div></figure><h2 id="8182" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">二手软件和工具</h2><p id="b35f" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">如前所述，数据具有地理空间性质，因此在这种情况下，使用地理空间工具来可视化、探索和解释数据是至关重要的。</p><p id="8f81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，除了我忠实的朋友熊猫、Numpy、Sickit-Learn、Seaborn、Plotly、XGBoost……我还认识了两个新朋友，我想每个正在读这篇文章的人都应该了解一下:</p><ul class=""><li id="f7b5" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj"> DivaGIS : </strong>一个免费的地理信息系统软件程序，用于分析地理数据，特别是关于生物多样性的点数据。</li><li id="f309" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> GeoPandas : </strong>一个开源项目，使使用python处理地理空间数据变得更加容易。</li></ul><h1 id="0f7c" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">预处理</h1><h2 id="3c38" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">探索性数据分析</h2><p id="ef7a" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">最重要的特征是海拔。分析结果表明，较低的海拔容易发生洪水。<br/>海拔高度对洪水调节功能也有重大影响，因为随着海拔高度的增加，降雨量和河流流量明显增加。<br/>所有现有研究或文献也表明，海拔是洪水预报中最重要的变量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/4a089dfa3e687be0f9d9b592ee90dfed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRu5vK0MTOyfZnCrlDDT8g.png"/></div></div></figure><p id="fe1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的线图代表每种土地类型的平均洪水值，我们可以看到土地类型和2015年目标之间的相关性模式。</p><p id="aaa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在训练数据中，我们在零周(洪水日期)之前获得了17周的降水。在随后的步骤中，我们设法发现这些降水特征中只有一半是有用的，其余的是有噪声的，导致模型表现不佳。(根据第一种解决方案，您可以在这里找到<a class="ae lx" href="https://github.com/belkhir-aziz/Flood-Prediction-in-Malawi-winning-solution-" rel="noopener ugc nofollow" target="_blank"/>，17个降水变量中只有3个是有用的)。</p><p id="3b8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用DivaGIS在地图上绘制了2015年的洪水点，以查看实际发生的情况以及洪水部分集中的位置，我还添加了Chilwa湖点和Shire河(Chilwa和Shire来自外部栅格):</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/2e54b9e0dbaec571fa3f99bd4e91a6f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGACwSZm7R_N4DN8oV-O_g.png"/></div></div></figure><p id="0df0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图中你能看到的红点是2015年的目标，绿点是Chilwa湖点，细黑线是Shire河(马拉维南部洪水最泛滥的河流)。</p><p id="dae9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对上述图的清晰和明显的解释是，大多数被淹没的区域都在Shire河附近，因此，到Shire河的距离将是预测2019年洪水的关键变量。<br/>我们可以从上面的图中做出的另一种解释是，Chilwa湖点应全部设置为零(这比正常情况下更多，因为在最终结果中我们不能将一个湖视为淹没区)。</p><p id="44c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在对马拉维的洪水条件进行研究后，我们发现另一条名为姆万扎河的河流也洪水泛滥，对我们的分析很重要:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/89604146095fefb00b739e01ea4de546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bd9PYwzhyJuXNoXRzmbdRQ.png"/></div></div></figure><p id="2bfb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不出所料，姆万扎河(蓝色中的黑线)是一条洪水泛滥的河流，附近地区容易发生洪水，因此我们应考虑计算到它的距离。</p><p id="10d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在查阅了不同的文献后，我发现森林地区很难被洪水淹没(自然事实)，因此包括马拉维土地覆盖数据应该是一个重要的变量。<br/>以下是马拉维土地覆盖热图:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/63ef6d1f5574a34905c493de42ae6256.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*hxpfRjE5h-jNP2JFzD4cNQ.png"/></div></div></figure><p id="85e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们将之前图中的淹没点与这张图进行比较(使用这张图有点困难),我们可以清楚地看到绿色区域大部分没有被淹没。</p><h2 id="0541" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">外部数据</h2><p id="fd74" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">关于处理真实世界数据而不是合成数据的最有趣的事情之一是，我们可以自由地探索外部数据，并使用它来帮助我们提高我们的模型能力。</p><p id="c56f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的大多数图层都是从这个为马拉维国家提供免费地理空间栅格的<a class="ae lx" href="http://www.masdap.mw/" rel="noopener ugc nofollow" target="_blank">网站</a>中提取的。<br/>我们能够找到的最有价值的特性如下:</p><ul class=""><li id="73b3" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">陆地形态:固体表面的自然形状。</li><li id="4f3c" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">奇尔瓦湖:马拉维南部最大的湖的坐标。</li><li id="c44e" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">Shire&amp;Mwanza河流:马拉维南部洪水泛滥河流的坐标。</li><li id="bf07" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">土壤数据:土壤信息，如腐蚀性、渗透性、土壤深度、积水可能性…</li></ul><h2 id="f531" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">特征工程</h2><p id="98f8" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">特征工程是利用领域知识通过数据挖掘技术从原始数据中提取特征的过程。这些特征可以用来提高机器学习算法的性能。</p><p id="5444" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据我的文献回顾，要生成的第一个特征是斜率。<br/>其实水流速度是由坡度决定的。因此，坡度是食物敏感性的一个重要因素。<br/>坡度可以使用X，Y，高程要素和一个名为<a class="ae lx" href="https://cran.r-project.org/web/packages/raster/index.html" rel="noopener ugc nofollow" target="_blank">栅格</a>的R包获得。</p><p id="5e3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二个特征，也是我称之为<strong class="ih hj">杀手</strong>的特征是到河流的距离。<br/>如前所述，我们使用DivaGIS软件获得河流坐标，并将其保存到CSV文件中。<br/>想法是计算从每个马拉维点到每个河流点的距离，然后取最小值。因此，我们得到了从每个训练点到每条河流的最小距离:</p><ul class=""><li id="d43f" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">Shire_min_dist = min(dist(马拉维，Shire))</li><li id="b7be" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">Mwanza_min_dist = min(dist(马拉维，Mwanza))</li></ul><p id="3145" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于执行这些距离计算的库是Vincenty。我推荐使用它，尤其是在处理大量点的时候。</p><p id="fd19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还使用现有的特征生成了不同的其他特征(对它们应用不同的数学组合)。</p><p id="ed24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经删除了不必要的变量，添加了抓取的数据和新生成的特征，我们需要在进入建模部分之前缩放我们的数据。</p><p id="7935" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在以下情况之一中，缩放数据非常重要:</p><ul class=""><li id="84a0" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">我们将使用线性模型，如:线性回归，广义线性模型…</li><li id="7e79" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">我们将使用基于距离的算法:K-最近邻，支持向量机，K-均值…</li></ul><p id="b3f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们应该关注基于距离的模型的缩放的原因是，在幕后，它们使用数据点之间的距离来确定它们的相似性，因此它们会给具有较高量值的变量较高的权重。<br/>可以考虑几种缩放技术，如最小最大缩放器、正常缩放器、鲁棒缩放器…</p><p id="8606" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，由于我们将使用基于树的算法，缩放并不是一个必须要做的动作，但是众所周知，魔法是存在的，一些愚蠢的动作可能会产生意想不到的结果(我相信所有阅读这篇文章的人都有这样的经历😔 ).</p><h1 id="83b7" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">建模</h1><h2 id="b1f3" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">随机森林</h2><p id="503b" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">正如我在数据描述部分提到的，数据集的形状大约是16K观察值，这被认为是非常小的数据。所以很明显过度拟合的诅咒在角落里等着呢！<br/>机器学习模型的目标是<strong class="ih hj">概括训练数据中的</strong>模式，以便我们能够正确预测从未呈现给模型的新数据。<br/>当涉及到小数据集时，会发生的情况是，模型会捕捉所有东西，甚至是噪音，过度调整训练数据，因此在预测看不见的数据方面表现不佳。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/30102b2728993b861c5cefcd2d8861ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySx35iFLUn9pNiXDMCrmHw.png"/></div></div></figure><p id="20a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据简单本质背后的第一个直觉是当我用不同的模型做第一次尝试时的惊喜:<br/> KNN和决策树比XGBoost和LGBM表现得好得多！<br/>所以这里的重点是尽量坚持简单的模型，不要让它变得太复杂。</p><p id="2eb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的最佳表现模型(基于我的预处理数据)是一个只有50个估值器的随机森林，这证实了我关于我们正在处理的数据的简单性质的假设。</p><p id="c9f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的第二个直觉是关于用于训练模型的适当度量:平均绝对误差还是均方误差？</p><p id="58a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的随机森林的标准度量的选择与我的目标变量高度相关。<br/>以下是我的目标变量分布:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/9bdbe3f7ddcf02e4004308158784764d.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*p5BQMWB32NazYvyIn_dCoQ.png"/></div></figure><p id="5578" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所见，完全被淹没的区域数量(1.0洪水比率)约占总数的2%。<br/>我们可以在这里声明，这些区域是数据中的异常，模型不应该把这些点看得太重，否则我们会过度拟合数据，模型会太复杂，无法对新的看不见的点进行归纳！<br/>有人可能会说:为什么不从数据中去掉这些点，继续努力呢:/？<br/>答案是否定的。我们应该保留这些观察结果有两个原因:<br/>首先，这些异常现象代表了真实世界的证据(在马拉维2015年的灾难中有一些地区完全被淹没)。<br/>其次，这些异常存在于测试集中。</p><p id="3b0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么这个问题的解决方案是什么呢？<br/>简单地说，我们需要告诉模型在面对异常值时不要惩罚太多，这只能通过RF中使用的标准来实现。</p><p id="af58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">众所周知，MAE是实际值和预测值之间的绝对值，除以样本数，而MSE是实际值和预测值之差的平方。<br/>使用MSE时，模型在面对异常值时将受到很大的惩罚，因为误差将被平方，因此模型将更加复杂，并从数据中学习噪声以最小化误差。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mb"><img src="../Images/9ac203aa128386ca2e0c497d74472374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4kE_TFOJ1vnXDWH8ldYxw.jpeg"/></div></div></figure><p id="1188" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果，我发现MAE是最好的标准，用MAE代替MSE给了我巨大的提升(从0.10跳到0.084)。</p><p id="f889" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总之，在处理符合上述标准的数据时，我的三条建议是:</p><ol class=""><li id="c142" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc mc jv jw jx bi translated">首先，坚持简单的模型。</li><li id="0970" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc mc jv jw jx bi translated">第二，你所有的模型参数都很重要(大多数人一般只调3或4个参数，默认情况下保留其余的)。</li><li id="4d84" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc mc jv jw jx bi translated">试着理解你的数据特征。</li></ol><h2 id="e9f1" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">组装</h2><p id="1911" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">下一步是尝试使用不同的模型，如XGBoost、LGBM、CatBoost……正如我们前面讨论的，这些模型的性能比RF低得多，因此我们决定使用它们的预测，并给它们一个小的权重:这就是我们所说的<strong class="ih hj">集合</strong>预测。</p><p id="be0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数情况下，表现最好的模型应该拥有最高的权重(在我的例子中是0.7)，然后尝试按照相同的策略将剩余的0.3分配给所有其他模型。</p><p id="24a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个实现最佳组合的好方法是我出色的队友<strong class="ih hj">伊德里萨</strong>所做的:<br/>创建一个代表每个模型预测的相关矩阵，然后最佳组合将使用那些相关性低的:<br/>基本上，不同的预测意味着每个模型都在捕捉一些其他模型没有的信息，因此，分享观点将提高最终结果！</p><h1 id="1119" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">结论</h1><p id="8519" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">我发现这场比赛最令人兴奋的是交流想法，特别是与我的队友，两位塞内加尔天才<strong class="ih hj"> Idrissa </strong>和<strong class="ih hj"> Bakary </strong>。与如此优秀的团队一起工作和学习是一件有趣的事情。<br/>此外，团队之间的竞争让每个人都想在排行榜上名列前茅，并给出最佳解决方案，这让一方始终保持动力。</p><p id="3ebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名有竞争力的数据科学家，最重要的事情是人们可以经历的现实世界问题的多样性，以及我们可以应用的不同想法(尤其是最疯狂的想法)。</p><p id="647f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢你的时间，我希望你觉得这篇文章有用和有趣。</p></div></div>    
</body>
</html>