<html>
<head>
<title>Building a desktop app using GTK and Python to display motivational quotes — Part#1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GTK和Python构建一个桌面应用程序来显示激励性名言——第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-desktop-app-using-gtk-and-python-to-display-motivational-quotes-part-1-81ec9e69eb1d?source=collection_archive---------13-----------------------#2020-03-21">https://medium.com/analytics-vidhya/building-a-desktop-app-using-gtk-and-python-to-display-motivational-quotes-part-1-81ec9e69eb1d?source=collection_archive---------13-----------------------#2020-03-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4a690ca1c964dfded032151594b6a5b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-6jrZeu3fitlPzrvsbuGoQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Ubuntu工具提示正在运行</figcaption></figure><h1 id="2dc4" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">动机:</h1><p id="7c70" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我有看书和励志名言的爱好。但是如果你像我一样，你也会读到一段很好的引言，然后把它忘掉。这是因为人类的思维方式(或者至少是我的思维方式)，我们需要重复。</p><blockquote class="kq kr ks"><p id="f722" class="js jt kt ju b jv ku jx jy jz kv kb kc kw kx kf kg ky kz kj kk la lb kn ko kp hb bi translated">正是肯定的重复导致了信念。一旦这种信念成为一种深刻的信念，事情就开始发生了。— <strong class="ju hj">穆罕默德·阿里</strong></p></blockquote><p id="c3e7" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">接下来，我开始探索各种已经存在的工具，它们可以帮助我在两者之间进行选择</p><ul class=""><li id="97d0" class="lc ld hi ju b jv ku jz kv kd le kh lf kl lg kp lh li lj lk bi translated">新的激励名言</li><li id="edb5" class="lc ld hi ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated">在goodreads上引用我已经读过并喜欢的书</li></ul><p id="8c68" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">首先，我使用chrome扩展<a class="ae lq" href="https://chrome.google.com/webstore/detail/momentum/laookkfknpbbblfpciffpaejjkokdgca?hl=en" rel="noopener ugc nofollow" target="_blank"> Momentum </a>已经有一段时间了，它显示了一个新的标签，有一个漂亮的背景和一个报价。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/8efefa202779c29581edd2b5b18fc291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQrKi26zxkWWKO1-mVuaNA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Chrome浏览器的新标签页中每天都有激励性的引语/短语</figcaption></figure><p id="592f" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">然而，我想要的东西有以下特点:</p><ul class=""><li id="dd3b" class="lc ld hi ju b jv ku jz kv kd le kh lf kl lg kp lh li lj lk bi translated">控制显示的内容</li><li id="aa8f" class="lc ld hi ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated">一些快捷方便的东西。就像一个键盘快捷键或一个鼠标点击！</li><li id="91b6" class="lc ld hi ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated">一段时间后逐渐消失</li></ul><p id="7fe5" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">因此，我开始寻找在Ubuntu桌面屏幕上显示数据的定制方式，看起来类似于通知弹出窗口或工具提示，而不是一个包含所有按钮的完整应用程序。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><h1 id="feed" class="iu iv hi bd iw ix md iz ja jb me jd je jf mf jh ji jj mg jl jm jn mh jp jq jr bi translated">探索:</h1><p id="6f97" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我已经使用过像<a class="ae lq" href="http://guake-project.org/" rel="noopener ugc nofollow" target="_blank"> Guake </a>这样的终端，它有半透明的背景，也允许字体定制。我开始做关键词搜索，比如:</p><blockquote class="mi"><p id="fb57" class="mj mk hi bd ml mm mn mo mp mq mr kp dx translated">如何在Ubuntu中显示自定义通知？</p></blockquote><h2 id="83fc" class="ms iv hi bd iw mt mu mv ja mw mx my je kd mz na ji kh nb nc jm kl nd ne jq nf bi translated">通知-发送</h2><p id="9554" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我接触的第一个库是Ubuntu处理通知的方式，即<a class="ae lq" href="http://manpages.ubuntu.com/manpages/xenial/man1/notify-send.1.html" rel="noopener ugc nofollow" target="_blank"> notify-send </a>。它还有一个python包装器。但是API是有限制的，如果文本更长，那么它会被自动截断并替换为省略号。这不是我要找的UX。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es ng"><img src="../Images/5e5106ce48993f83da0ffae014d3cf8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*3JL1-W4j93Da6BFKFe2RZA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Ubuntu通知系统，我无法删除截断</figcaption></figure><p id="6c3a" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">在对notify-send进行了一段时间的试验并意识到存在限制之后，我转向了其他库，如<a class="ae lq" href="https://help.gnome.org/users/zenity/2.32/zenity-usage.html.en" rel="noopener ugc nofollow" target="_blank"> zenity </a>和<a class="ae lq" href="https://github.com/yfiton/yfiton" rel="noopener ugc nofollow" target="_blank"> yfiton </a>。</p><h2 id="7b19" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">Zenity</h2><p id="aec2" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">Zenity是一个预装在Ubuntu中的极简对话创建器。它还支持超时，以便对话会在一定时间后自动关闭。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es nm"><img src="../Images/dff1df081e9b01e70b3550341368c0d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*2SUZeS4yZQQNWc1NdvvTYA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Zenity解决了这个目的，但是没有魅力。</figcaption></figure><h2 id="621d" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">Yfiton</h2><p id="c72a" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">通过StackOverflow和AskUbuntu搜索，我登陆了Yfiton，这是一个Java内置的通知发送器。它也支持slack和twitter等渠道，但我的用例不需要这些。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es nn"><img src="../Images/2eefa9f3007ca26329ba239b8153234b.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*i1Wd7S57vuBQuY9_NM0g4A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">y信息通知示例</figcaption></figure><p id="129c" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">YFiton的桌面通知程序正是我所需要的，但有一些限制。例如，左边的图标只能是信息/成功/警告/错误。这意味着，为了使用它，我必须修改它的源代码。在深入研究代码之后，我发现一些定制，比如<a class="ae lq" href="https://docs.oracle.com/javase/8/javafx/api/javafx/geometry/Pos.html" rel="noopener ugc nofollow" target="_blank">定制定位</a>在当前的实现中是不可能的。我花了足够的时间搜索其他的实现或库来帮助我实现我的目标。然后我想起来了:</p><blockquote class="kq kr ks"><p id="9929" class="js jt kt ju b jv ku jx jy jz kv kb kc kw kx kf kg ky kz kj kk la lb kn ko kp hb bi translated">除非你这样做，否则什么都不会起作用。——<strong class="ju hj">玛娅·安杰洛</strong></p></blockquote><h2 id="9151" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">GTK</h2><p id="5581" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我的下一步是通过使用Python和跨平台用户界面开发工具包<a class="ae lq" href="https://www.gtk.org/" rel="noopener ugc nofollow" target="_blank"> GTK </a>来尝试做这件事。考虑到我以前从未做过桌面应用程序开发，我不确定我是否愿意投入足够的时间来学习它。但是由于我一直在引用，我想起了下面的引用，这激励我尝试构建一个定制的应用程序。</p><blockquote class="kq kr ks"><p id="d07a" class="js jt kt ju b jv ku jx jy jz kv kb kc kw kx kf kg ky kz kj kk la lb kn ko kp hb bi translated">活着吧，就像你明天就会死去一样。学习吧，就像你会永远活着一样。— <strong class="ju hj">圣雄甘地</strong></p></blockquote></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><h1 id="3ae5" class="iu iv hi bd iw ix md iz ja jb me jd je jf mf jh ji jj mg jl jm jn mh jp jq jr bi translated">实施:</h1><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es no"><img src="../Images/762e963b0d19708f0ec217812bfd2703.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*qUR0gB9u9hIE3adyWnoEbA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">GTK python的v0实现</figcaption></figure><h2 id="288e" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">透明度和菜单栏删除:</h2><p id="c8d5" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">有了Guake这样的终端，我知道应用程序有可能拥有半透明的背景。为了在GTK实现它，我从一个简单的例子<a class="ae lq" href="https://gist.github.com/fcwu/5794494" rel="noopener ugc nofollow" target="_blank">脚本</a>开始创建一个窗口并设计它的样式。然而，它没有工作，经过一些搜索，最终在一个<a class="ae lq" href="https://discourse.gnome.org/t/top-level-window-transparency-in-newer-versions-of-gtk/2210" rel="noopener ugc nofollow" target="_blank">解决方案</a>上。菜单栏删除原来是一个非常简单的标志<code class="du np nq nr ns b">window.set_decorated(False)</code></p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es nt"><img src="../Images/f539289873248e4a154dbcd7b3c8e89d.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*BxoOT8ilzmMLc2brRbNSAA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">动作栏已移除</figcaption></figure><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nu"><img src="../Images/dbcccc773cc13a821f45114e500251b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vZoUr8wNluWb5RcP2fHG5Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">添加了透明度和CSS更改</figcaption></figure><h2 id="bdde" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">文本显示和格式:</h2><p id="bff9" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">准备好样板文件后，下一步是浏览GTK的python 文档。GTK允许修改CSS样式，因此我很容易根据自己的需要进行修改。事实证明，它非常简洁、简单且易于理解(感觉像是无休止地搜索一些设置，比如缺少一个<strong class="ju hj"> <em class="kt">最大宽度</em> </strong>属性)。创建标签的代码片段比预期的要短。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/a9c6b2bda9c42b3036078ecf06e76df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*gODixFGy2BEoytyH6NwcWw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">添加到文本的自动换行和居中对齐</figcaption></figure><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="nw nx l"/></div></figure><h2 id="8e1d" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">自动超时:</h2><p id="84e7" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我努力寻找一个解决方案，让弹出窗口自动关闭。然后我提醒自己:</p><blockquote class="kq kr ks"><p id="6a68" class="js jt kt ju b jv ku jx jy jz kv kb kc kw kx kf kg ky kz kj kk la lb kn ko kp hb bi translated">完美是好的敌人——伏尔泰</p></blockquote><p id="86a0" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">最后，我使用了一个基于快速线程的hack来发送退出信号，让弹出通知在X秒后关闭。</p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="nw nx l"/></div></figure><h2 id="ebb8" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated"><strong class="ak">数据集:</strong></h2><p id="8b24" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">为了显示作者的引用，我决定首先使用来自可用数据集<a class="ae lq" href="https://www.kaggle.com/akmittal/quotes-dataset" rel="noopener ugc nofollow" target="_blank">的随机引用，这里是</a>。数据集是一个json文件，包含大约50k个引号。它并不完美，但通过一些过滤器，它可以工作。</p><h2 id="ac09" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">键盘快捷键:</h2><p id="ce2c" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我现在需要做的就是将python脚本绑定到键盘快捷方式上。在Ubuntu中，步骤是<strong class="ju hj"> <em class="kt">设置- &gt;键盘- &gt;(向下滚动)- &gt;自定义快捷键- &gt; (+) </em> </strong></p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ny"><img src="../Images/28cd8308e0b576bc82930b089e67499b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmpn7f-vmSpr1Szfkoci1Q.png"/></div></div></figure><p id="c536" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">请注意，任何组合键都可以作为快捷方式，只要它不与任何现有的命令冲突(如Ctrl+V)。键盘快捷键是通用的，所以当焦点在任何窗口时都可以被触发:浏览器、终端或文件浏览器。</p><h2 id="6505" class="ms iv hi bd iw mt nh mv ja mw ni my je kd nj na ji kh nk nc jm kl nl ne jq nf bi translated">结果:</h2><p id="71a0" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在几个小时内，从构建桌面应用程序的零知识开始，我能够编写一个python脚本，当通过键盘快捷键触发时，它会给出以下结果:</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nz"><img src="../Images/5eeb7cea554d6e5af9551cb3c8e5ce27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ED8hekO5bKwDz_DGbl1fcA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">继续按快捷键，保持冷静！</figcaption></figure><p id="b414" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">在这个周末项目中，我学到了很多东西。然而，最重要的学习是:</p><ul class=""><li id="0bd3" class="lc ld hi ju b jv ku jz kv kd le kh lf kl lg kp lh li lj lk bi translated">事情远比看起来容易。</li><li id="fcb8" class="lc ld hi ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated">有很多社区支持来帮助你。</li><li id="b09d" class="lc ld hi ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated">建立自己感兴趣的东西感觉非常好。</li></ul><p id="d303" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">如果我没有在谷歌搜索、stackoverflow和askubuntu threads上搜索的话，我可能要花几个月的时间才能完成同样的工作。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="a43d" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">代码的完成版本可在<a class="ae lq" href="https://gist.github.com/dk-crazydiv/69876a65f9cfc0f409a2744da60f16e1" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae lq" href="https://jovian.ml/kartik.godawat/gtk-desktop-notifications" rel="noopener ugc nofollow" target="_blank">这里</a>获得。已经可以安装使用了。如果你面临任何问题，请在评论中告诉我。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="537b" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">就是这样！在下一部分，我将尝试与Goodreads和Kindle整合，并在GTK进行更多的定制更改。或者，我可能会放弃这个实现，去寻找更好的东西。谁知道呢！</p><p id="3a67" class="pw-post-body-paragraph js jt hi ju b jv ku jx jy jz kv kb kc kd kx kf kg kh kz kj kk kl lb kn ko kp hb bi translated">非常感谢您抽出时间。如果你喜欢阅读，请给我一些掌声。下次再见，祝你愉快:)</p></div></div>    
</body>
</html>