<html>
<head>
<title>Part 1 — Intro to Machine Learning with TensorFlow simplified.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第1部分TensorFlow简化版机器学习简介。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/part-1-intro-to-machine-learning-with-tensorflow-simplified-d5c2582b97a5?source=collection_archive---------17-----------------------#2020-04-21">https://medium.com/analytics-vidhya/part-1-intro-to-machine-learning-with-tensorflow-simplified-d5c2582b97a5?source=collection_archive---------17-----------------------#2020-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0bd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在深入学习本课程之前，您应该了解以下几点:</p><ol class=""><li id="b62c" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">我喜欢边做边学，所以本课中机器学习和张量流的大部分术语都将使用示例进行演示。如果机器学习复杂数学是你想要的，你不会在这里得到它们，但你至少会得到其他一切，直观地理解数学过程</li><li id="adbe" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">对于本课，您需要安装tensorflow和python (numpy和matplotlib)。您可以很容易地在网上找到如何完成安装的资源。此外，你应该有jupyter笔记本电脑安装在您的笔记本电脑或任何闲置你的选择。万一安装变得如此困难，你可以直接在互联网上使用<strong class="ih hj"> google colab notebook </strong>并使用“！pip install package_name”来完成所有安装。</li><li id="44e3" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">您至少应该熟悉基本的python，以便充分利用本文中的代码，但是我将尽力解释这些步骤。</li></ol><p id="cf44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们深入实际业务什么是机器学习？<strong class="ih hj">机器学习</strong>是人工智能(AI)的一种应用，它为系统提供了自动学习和根据经验改进的能力，而无需显式编程。我将通过一个例子来更好地解释这一点:</p><p id="fae0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您有下面的输入和输出值；当你输入0，你得到一个输出32，当你输入8，你得到一个输出46.4等等。现在的问题是:你能计算出输入值38的<strong class="ih hj">输出</strong>值是多少吗？</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/de1a73e4b62a48091dbd9b0ee36331dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*pIWpWGa9i5G4fiyChLFH5Q.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">输入值及其输出值</figcaption></figure><p id="5985" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你的答案是100.4，你就是一个<strong class="ih hj">摇滚明星，</strong>但是你是怎么算出来的呢？通过建立一个简单的线性系统。你可能同意我的观点，在一天结束时，线性系统看起来像是<strong class="ih hj"> y = 1.8*x +32 </strong>，这导致了众所周知的摄氏到华氏的转换。换句话说，输入以摄氏度显示温度值，而输出以华氏度表示相应的温度</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es kd"><img src="../Images/1da4589843eeca9b6a46b0b9470fdff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*h6n5LOU5kIgEcVz5qFxBJw.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">上述输入和输出值的算法导致摄氏温度到华氏温度的转换公式。</figcaption></figure><p id="8614" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你刚刚通过找出输入和输出值之间的确切关系所做的正是机器学习所做的。也就是说，给定一组输入及其相应的输出，机器学习将找出正确的算法来将输入转换为输出。当我说算法时，我指的是输入和输出之间的关系。请这样想:</p><p id="075d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">传统软件开发:</strong>输入和算法已知，你写一个函数产生一个输出。即1。输入数据，请按2。对它应用逻辑(算法)，3。获取输出。让我们看一个例子，假设你想写一个计算机程序，用我们上面得到的关系式把摄氏温度转换成华氏温度，通过软件开发，这个程序可以很容易地用任何编程语言通过使用一个函数来实现。以下是python中的一个示例:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es ke"><img src="../Images/c5bf04d23cac479a34d64a2d33ef3246.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*eIWbDGFcCG7R_2T0uc7pkA.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">求解摄氏华氏转换方程的软件开发。</figcaption></figure><p id="ca48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">机器学习:</strong>输入和输出都是已知的，但是你不知道给定输入产生输出的算法。即1。取输入和输出对，2。算出算法。既然我们不知道算法，就意味着我们不会写函数。以下是python中机器学习函数的一个示例:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kf"><img src="../Images/cc7a4f8cbb0614ef2661cc955b5ac6b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6vHxxEeckRqUST_UOuf0w.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">求解摄氏到华氏转换方程的机器学习方法。</figcaption></figure><p id="8357" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是为了使用机器学习来解决这个问题，我们需要将神经网络的概念引入到上述函数中。机器学习使用神经网络来学习这些输入和输出之间的关系。神经网络的概念将在本课的第二部分彻底讨论。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kk"><img src="../Images/5c92c1cfbe79a6004c26797c9764f108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a4hO1rbsWDz1j7vg1HYW9A.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">将神经网络引入机器学习功能。</figcaption></figure><p id="ab45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以把神经网络想象成由一些预定义的数学和内部变量组成的层的堆叠。输入值被馈送到神经网络，并通过层的堆叠跟随。然后将数学和内部变量应用于输入，并生成输出。为了让神经网络学习输入和输出之间的正确关系，我们必须训练它。我们通过反复让网络尝试将输入映射到输出来训练我们的神经网络。通过训练，神经网络根据经验调整内部变量，直到学会在给定输入的情况下产生输出。内部变量的调整是在我们看不到的一千或几百万次迭代中进行的。现在让我们看看如何在代码中实现这一点。我们将使用机器学习来训练一些数据集，看看我们的机器是否可以在给定输入的情况下正确预测输出，而不是像典型的软件开发人员一样为我们的摄氏到华氏转换编写一个函数。</p><p id="e9b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了让生活更容易，我总是用6个简单的步骤来建立机器学习模型。我不会在后面的文章中详细解释这一点，所以现在要知道每一步都做了什么。</p><ol class=""><li id="87d6" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">导入所有基本依赖:</strong></li></ol><p id="db65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们输入TensorFlow和构建模型所需的其他python依赖项。在这里，我将使用Jupyter笔记本:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es kl"><img src="../Images/41354077b17e1a9e4092f29af34d7e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*ph5L6-xNpHfkJFnCNofmJA.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">导入所有基本依赖项</figcaption></figure><p id="cb54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">设置培训数据:</strong></p><p id="9182" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简化，我们将使用numpy创建一个简单的训练数据，稍后，我们将直接从tensorflow导入数据。我们创建两个数组<code class="du km kn ko kp b">celsius_a</code>和<code class="du km kn ko kp b">fahrenheit_a</code>，我们可以用它们来训练我们的模型。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es kq"><img src="../Images/4884ddebdb56ded34b6cc62d4703d8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*g0Z9YLKdTyP4ohionRZTRQ.png"/></div></figure><h1 id="a2e7" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">一些机器学习术语</h1><ul class=""><li id="d801" class="jd je hi ih b ii lp im lq iq lr iu ls iy lt jc lu jj jk jl bi translated"><strong class="ih hj">特性</strong> —我们模型的输入。在这种情况下，只有一个值，即摄氏度。</li><li id="1474" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc lu jj jk jl bi translated"><strong class="ih hj">标签</strong> —我们的模型预测的输出。在这种情况下，只有一个值，即华氏温度。</li><li id="5c99" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc lu jj jk jl bi translated"><strong class="ih hj">示例</strong> —训练期间使用的一对输入/输出。在我们的例子中，来自<code class="du km kn ko kp b">celsius_a</code>和<code class="du km kn ko kp b">fahrenheit_a</code>的一对特定索引的值，比如<code class="du km kn ko kp b">(22,72)</code>。</li></ul><p id="81cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.<strong class="ih hj">创建模型并将层组装到模型中:</strong></p><p id="5f94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用最简单的模型，称为密集网络，因为这个问题非常简单。这种网络只需要单层，具有单个神经元。</p><p id="6cb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将调用层<code class="du km kn ko kp b">l0</code>，并通过使用以下配置实例化<code class="du km kn ko kp b">tf.keras.layers.Dense</code>来创建它:</p><ul class=""><li id="d58e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc lu jj jk jl bi translated"><code class="du km kn ko kp b">input_shape=[1]</code> —指定该层的输入为单一值。也就是说，该形状是只有一个成员的一维数组。因为这是第一个(也是唯一的)层，所以该输入形状是整个模型的输入形状。单个值是一个浮点数，表示摄氏度。</li><li id="bc34" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc lu jj jk jl bi translated"><code class="du km kn ko kp b">units=1</code> —指定层中神经元的数量。神经元的数量定义了该层必须尝试学习如何解决问题的内部变量的数量(稍后将详细介绍)。由于这是最后一层，它也是模型输出的大小——一个表示华氏温度的浮点值。(在多层网络中，层的大小和形状需要与下一层的<code class="du km kn ko kp b">input_shape</code>相匹配。)一旦定义了层，就需要将它们组装成模型。顺序模型定义将层列表作为参数，指定从输入到输出的计算顺序。</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es lv"><img src="../Images/d01df5eba29015707142c214e76cbb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*fg5Sv2T0vVFLsHXqBNI9lg.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">简单的机器学习模型。</figcaption></figure><p id="716e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.<strong class="ih hj">编译和训练模型:</strong></p><p id="4e1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在训练之前，必须编译模型。为训练而编译时，模型如下所示:</p><ul class=""><li id="2f19" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc lu jj jk jl bi translated"><strong class="ih hj">损失函数</strong>——一种衡量预测与期望结果相差多远的方法。</li><li id="ccd6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc lu jj jk jl bi translated"><strong class="ih hj">优化器功能</strong> —调整内部值以减少损失的一种方式。</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es lw"><img src="../Images/bee5cb24f74983d9ce535852e3c46ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*FEIU9aargMFRvB-qSLKSQQ.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">优化器和损失函数可以根据需要改变。</figcaption></figure><p id="c67e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">优化器和损失函数可以根据需要改变。这将在下一篇文章中得到很好的解释。在构建您自己的模型时，您可能需要考虑的优化器的一部分是学习率(上面代码中的<code class="du km kn ko kp b">0.1</code>)。这是调整模型中的值时采用的步长。如果该值太小，训练模型将需要太多的迭代。太大，精确度会下降。找到一个好的值通常需要一些反复试验，但是范围通常在0.001(默认)和0.1之间。参数<code class="du km kn ko kp b">epochs</code>指定这个循环应该运行多少次，参数<code class="du km kn ko kp b">verbose</code>控制这个方法产生多少输出。我们称之为<code class="du km kn ko kp b">fit</code>方法来训练机器学习中的模型</p><p id="690f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.<strong class="ih hj">可视化损失幅度</strong></p><p id="e153" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将损失幅度可视化，这样我们就可以看到在每个训练时期后模型的损失是如何下降的。高损失意味着模型预测的华氏温度与<code class="du km kn ko kp b">fahrenheit_a</code>的相应值相差甚远。尝试增加历元数和学习率，看看你的模型表现如何。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es lx"><img src="../Images/6ddcab403221dfe735b219e1e7ed9802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*bKnHbjgfBpMkPntfQTMWVw.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">损失幅度与历元数的关系</figcaption></figure><p id="8c00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.<strong class="ih hj">预测我们的模型表现如何</strong></p><p id="716c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你有了一个模型，它已经被训练学习了<code class="du km kn ko kp b">celsius_a</code>和<code class="du km kn ko kp b">fahrenheit_a</code>之间的关系。您可以使用predict方法让它为以前未知的摄氏度计算华氏温度。现在让我们找出华氏温度的值，如果摄氏温度是100度。使用我们在本课开始时推导的公式，华氏温度(F) = 100 *1.8 +32 = 212。现在让我们看看我们的模型预测什么。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es ly"><img src="../Images/e3f51cc3887d68cf7ce598a3b06d6696.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*A4nGlzf20dX7pgebMzWMig.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">耶！几乎一样</figcaption></figure><p id="31aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你只要建立一个机器学习模型，可以把摄氏温度转换成华氏温度，准确率达到99.5%(这个你可以自己用tensorflow或者python均方差计算。)这种准确性在我们处理更大的问题时是不会发生的，但这样做的目的是为了学习机器学习的基础知识。</p><p id="6119" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关于密集网络的一点小注意:</strong>上面我们用了一个密集层来构建我们的模型，但是什么是密集层呢？只是全连接神经网络层的一种说法。每一层中的神经元都与下面各层中的神经元相连。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lz"><img src="../Images/aae3531be585f086130fb6ad5c7c25a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLCvR19WCwu7zG6crbvUJw.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">我们的单一致密层是如何运作的。</figcaption></figure><p id="7397" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的单一致密层正是我们用来建立我们的模型。它以x1为输入，然后反复迭代调整内部变量w11和b1(分别为权重(一般意义上的斜率)和偏差)，直到可以高精度预测。</p><p id="9c37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你已经学习了机器学习的基础，以及如何训练一个简单的机器学习模型。接下来，您将使用tensorflow mnist数据集构建一个真实生活模型。请注意第2部分。</p></div></div>    
</body>
</html>