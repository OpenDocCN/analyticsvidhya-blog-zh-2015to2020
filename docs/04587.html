<html>
<head>
<title>Can Machines Learn and Predict? — Training a Deep Neural Network using Pytorch for Iris Data set.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器可以学习和预测吗？—使用Pytorch为Iris数据集训练深度神经网络。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/can-machines-learn-and-predict-training-a-deep-neural-network-using-pytorch-for-iris-data-set-5fd8cb803fc4?source=collection_archive---------13-----------------------#2020-03-25">https://medium.com/analytics-vidhya/can-machines-learn-and-predict-training-a-deep-neural-network-using-pytorch-for-iris-data-set-5fd8cb803fc4?source=collection_archive---------13-----------------------#2020-03-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b9ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">利用Python程序，对鸢尾数据集训练深度神经网络，预测鸢尾植物的种类。</p><p id="30ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个快速发展的世界中，机器被训练并用于预测结果，涉及人工智能贡献的应用以更快的速度快速增长。</p><p id="292d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章将带你为一个著名的/基本的数据集——<strong class="ih hj">虹膜数据集</strong>训练一个深度神经网络。最后，该网络将能够基于4个不同的物理参数来预测虹膜的种类，这些物理参数将作为输入给出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/995e77ee12e42157fe0b125421be04d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DTgQF95oorbNKxjo"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae jt" href="https://unsplash.com/@benjmater?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">本·马特</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="84ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该流程将遵循以下步骤:</p><ol class=""><li id="7b3d" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">什么是虹膜数据集？—让我们尝试理解数据集，这样我们就可以知道哪些属性将用作输入，以及网络的输出应该是什么。</li><li id="4640" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">拆分数据集—将数据集拆分为训练集、验证集和测试集。</li><li id="0c49" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">开发神经网络层—我们将创建深度神经网络，包括输入层、隐藏层和输出层。</li><li id="2b9e" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">定义训练参数——DNN最重要的部分是定义超参数(学习率、批量、时期数等；)，激活函数，损失函数，这些我们会在编写程序时讨论。</li><li id="8c4c" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">训练网络——完成上述所有过程后，我们将训练深度神经网络。</li><li id="d366" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">预测-根据获得的精度，我们将给出一个随机值，并检查网络是否预测了正确的值。</li></ol><p id="8d4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虹膜数据集到底是什么？</p><p id="b779" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Iris数据集有150行和5列(不包括ID列),看起来像这样:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/b249cb3a470f05daddc26960c77f0f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_6q183sa2xCOnJr31qHyA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">已经示出了数据集的开始5行。</figcaption></figure><p id="55ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Iris数据集由花的4个物理属性组成，即:</p><ol class=""><li id="f701" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">萼片长度，单位为厘米</li><li id="6e02" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">萼片宽度，单位为厘米</li><li id="6b34" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">花瓣长度(厘米)</li><li id="44d8" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">花瓣宽度(厘米)</li></ol><p id="6019" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要预测的一个属性是“种类”列——鸢尾植物的种类。在所提供的数据集中，有三个物种，即“鸢尾”、“杂色鸢尾”、“海滨鸢尾”。</p><p id="691f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，这里4个物理属性将作为网络的输入，并且网络将基于所提供的输入给出一个输出，该输入是属于“鸢尾-setosa”还是“鸢尾-杂色”还是“鸢尾-海滨鸢尾”。</p><p id="d625" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从导入必要的包开始编码:</p><p id="4e1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[如果需要，任何其他信息同样由程序中的# commenting提供]</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="7586" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">定义深度神经网络:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="9811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">定义超级参数:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="fb9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择优化器、损失函数并将数据分成测试、验证和测试集:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="0700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过显示其形状来检查每个集合中有多少条记录:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="9e1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">x_train有120行4列，而x_test和validation set (x_val)都有15行4列。看y_train，y_test和y_val分别是120，15，15条记录。您的输出应该是这样的:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kl"><img src="../Images/ce5ad08befd942d236847b6fc981b123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UTpuU_wwIMlQ6df0GqBJKw.png"/></div></div></figure><p id="6173" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为Pytorch创建数据加载器:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="c514" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">定义一个函数来训练模型:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="796d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，定义一个函数来测试模型:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="59b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候训练模型了:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="048a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在训练过程中，您可以看到每个时期的训练损失和验证损失，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es km"><img src="../Images/e68b2efd0ee9869006fcb8ed33966118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAJ6Tip2kp8eCPPo_rI7dg.png"/></div></div></figure><p id="bbdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们想象一下训练损失和验证损失在每个时期是如何变化的:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kn"><img src="../Images/e5bfda551486f8776e7079a5beeddaf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*r1yxVLPvorrTixgrPazCkg.png"/></div></figure><p id="7449" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看分配给每个加权变量的数字:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/330e2146c28f2e6026bad66de53081b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ar4fEMXstA3iCZwDoFBOVQ.png"/></div></div></figure><p id="1e7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查您的模型如何为测试集工作:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="719b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我们使用混淆矩阵作为测试集的评估因子:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="67e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混乱矩阵看起来是这样的:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kp"><img src="../Images/fd468cdfee72b6f065628858015b89a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*Cnq2N-EPCvwrbwEDOHmlsA.png"/></div></figure><p id="3e0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，预测时间到了:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kk l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kq"><img src="../Images/262ddae420b37efa0fde287a90a7891d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFVjwSPdgJPMcWowT3DibQ.png"/></div></div></figure><p id="184c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以更改x_new变量中的值，并检查您的模型是否预测了正确的鸢尾植物类别。</p><p id="525c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是你如何训练一个深度神经网络，并尝试使用建立的模型进行预测。</p><p id="4539" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何关于这个职位的建议都是受欢迎的。</p><p id="c0df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">欢迎通过<a class="ae jt" href="https://www.linkedin.com/in/arnold-sachith-98752a141/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae jt" href="https://www.instagram.com/arnoldsachith/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>或<a class="ae jt" href="https://www.facebook.com/arnold.sachith" rel="noopener ugc nofollow" target="_blank">脸书</a>与我联系。</p><p id="40d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯:)</p><p id="6771" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阿诺德·萨希特</p></div></div>    
</body>
</html>