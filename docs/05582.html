<html>
<head>
<title>Pandas Tutorials — Advanced Indexing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫教程-高级索引</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-tutorials-advanced-indexing-b35909b26bcd?source=collection_archive---------10-----------------------#2020-04-26">https://medium.com/analytics-vidhya/pandas-tutorials-advanced-indexing-b35909b26bcd?source=collection_archive---------10-----------------------#2020-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3a45906c3d010e9e263c94503a316a04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPJnM0T-HbZlA8TQltpj_A.png"/></div></div></figure><p id="6878" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要了解更多关于高级索引的知识，我们需要记住什么是索引，什么不是索引。</p><p id="32a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">索引是一系列标签。Pandas系列是一维标记的NumPy数组，DataFrame是列是系列的二维数据结构。</p><p id="5a77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Pandas中，索引像字典键一样是不可变的。它们还假设数据类型是同质的，如NumPy数组。</p><p id="7543" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们深入了解所有这些之前，让我们快速提醒自己如何创建系列、索引，并尝试修改索引名称，然后进入我们今天的课程。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="4850" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">创建系列</h2><p id="45ab" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">让我们创建一个股票和价格序列</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="190d" class="jv jw hi la b fi le lf l lg lh">In [1]: import pandas as pd<br/>In [2]: prices = [10.70, 10.80, 10.50, 10.90]<br/>In [3]: shares = pd.Series(prices)<br/>In [4]: print(shares)<br/>Out[4]:<br/>       0       10.70<br/>       1       10.80<br/>       2       10.50<br/>       3       10.90<br/>dtype: float64</span></pre><h2 id="9dfd" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">创建索引</h2><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b711" class="jv jw hi la b fi le lf l lg lh">In [5]: days = ['Mon','Tue','Wed','Thu']<br/>In [6]: shares = pd.Series(prices, Index=days)<br/>Out[6]<br/>     Mon      10.70<br/>     Tue      10.80<br/>     Wed      10.50<br/>     Thu      10.90</span></pre><p id="8d35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面代码的这一步中，我们将先前的默认指数更改为每日股价。我们通过在<code class="du li lj lk la b">pd.Series()</code>方法中指示Index = days来做到这一点。</p><p id="58f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在可以通过调用index属性检查<code class="du li lj lk la b">Shares</code>来验证索引不再是默认的，而是字符串对象</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="dec9" class="jv jw hi la b fi le lf l lg lh">In [7]: print(shares.index)<br/>Out[7]: <br/>     Index(['Mon','Tue','Wed','Thu']),dtype='object')</span><span id="7628" class="jv jw hi la b fi ll lf l lg lh">In[8]: print(shares.index[1])<br/>Out[8]: <br/>     Tue</span><span id="955d" class="jv jw hi la b fi ll lf l lg lh">In [9]: print(shares.index[ :2]<br/>Out[9]:<br/>    Index(['Mon','Tue'], dtype='object'</span><span id="b6b3" class="jv jw hi la b fi ll lf l lg lh">In[10]: print(shares.index[ -2:]<br/>Out[10]:<br/>    Index(['Wed','Thu'], dytpe='object')</span><span id="9795" class="jv jw hi la b fi ll lf l lg lh">In [11]: print(shares.index.name)<br/>Out[11]:<br/>     None</span></pre><p id="5bf3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从第11行代码可以看出，索引“列”没有名称。我们通过调用<code class="du li lj lk la b">.name</code>属性(<code class="du li lj lk la b">shares.index.name</code>)发现了这一点。我们可以通过给<code class="du li lj lk la b">shares.index.name</code>起一个名字来纠正或修改这一点。这使得输出更清晰，更容易被第三方用户阅读和理解。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3f4c" class="jv jw hi la b fi le lf l lg lh">In [12]: shares.index.name = 'Weekdays'<br/>In [13]: print(shares)<br/>Out[13]:<br/>       Weekdays<br/>        Mon      10.70<br/>        Tue      10.80<br/>        Wed      10.50<br/>        Thu      10.90<br/>        dtype:float64</span></pre><p id="c065" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，请注意，不能在数据帧中修改索引。你不能简单地通过给一个特定的条目指定一个新的名字来改变一个索引。这将引发一个<code class="du li lj lk la b">TypeError</code></p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="e357" class="jv jw hi la b fi le lf l lg lh">In[14]: shares.index[2] = 'Wednesday'<br/>TypeError<em class="lm">: Index does not support mutable operations</em></span><span id="422a" class="jv jw hi la b fi ll lf l lg lh">In[15]: shares.index[ :4] = ['Monday', 'Tuesday']<br/>TypeError: <em class="lm">Index does not support mutable operations</em></span></pre><p id="d5e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">TypeError : Index不支持可变操作，这意味着我们不能改变任何索引的形状或格式。熊猫不支持任何此类操作</p><p id="f151" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们用另一个例子来更全面地了解我想表达的观点。我将“导入”存储在本地驱动器上的失业数据集。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="320b" class="jv jw hi la b fi le lf l lg lh">In [1]: import pandas as pd<br/>In [2]: Unemployment = pd.read_csv('unemployment.csv')<br/>In [3]: Unemployment.head()<br/>Out[3]:<br/>      Zip     Unemployment   Participants<br/>0    1001       0.06           13801<br/>1    1002       0.09           24551<br/>2    1003       0.17           11477<br/>3    1004       0.10            4086<br/>4    1005       0.05           11362</span></pre><p id="3b38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">索引列没有标签。我们不希望出现这种情况。相反，我们希望分析这些失业数据，确切了解失业率是从哪里记录的。如果是这种情况，我们需要将Zip列作为新的参考点。我们将通过将Zip列指定为新索引来实现这一点</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="4b6e" class="jv jw hi la b fi le lf l lg lh"><br/>In [2]: Unemployment.index = unemployment['Zip']<br/>In [3]: unemployment.head()<br/>Out[3]:<br/>         Zip     Unemployment   Participants<br/>Zip<br/>1001     1001       0.06           13801<br/>1002     1002       0.09           24551<br/>1003     1003       0.17           11477<br/>1004     1004       0.10            4086<br/>1005     1005       0.05           11362</span></pre><p id="03a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经成功地使Zip列成为新的索引，但是还有一个小问题。我们似乎有一个Zip列的副本。我们可能不需要Zip列在我们的数据框架中占据空间，因为它的主要目的是作为我们ie索引的参考点。我们可以使用<code class="du li lj lk la b">del</code>函数删除该列。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="e65a" class="jv jw hi la b fi le lf l lg lh">In [4]: del Unemployment ['Zip']</span></pre><p id="6946" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，值得注意的是，我们可以在导入数据集时，从一开始就将Zip列指定为索引列，从而避免这种麻烦。通过在<code class="du li lj lk la b">'pd.read_csv()'</code>方法中指出<code class="du li lj lk la b">index_col='Zip'</code>,我们将节省一些编码时间并完成工作。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="f977" class="jv jw hi la b fi le lf l lg lh">In [1]: Unemplyment=pd.Read_csv('unmeployment.csv',index_col='Zip')<br/>In [2]: Unemployment.head()<br/>Out[2]:<br/>        Unemployment   Participants<br/>Zip<br/>1001      0.06           13801<br/>1002      0.09           24551<br/>1003      0.17           11477<br/>1004      0.10            4086<br/>1005      0.05           11362</span></pre><h2 id="9d4b" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">更改数据帧的索引</h2><p id="b659" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">正如我前面指出的，索引是不可变的。这意味着如果我们想要改变或修改数据帧中的索引，那么我们需要改变整个序列。我们可以通过使用<code class="du li lj lk la b">list comprehensions</code>来做到这一点</p><p id="87fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">列表理解是在一行中生成列表的一种简单易读的方式。列表理解将几行代码压缩成一行可爱的代码，足够简短以保持读者的兴趣，也足够详细以完成预期的工作。</p><p id="889a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，代码</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1ea0" class="jv jw hi la b fi le lf l lg lh">In[]:squares = [x**2 for x in range(20)]</span></pre><p id="badd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">生成包含从0到19的所有数字的平方的列表。<br/>替代代码应该是</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="d045" class="jv jw hi la b fi le lf l lg lh">In[]:Squares = [ ]<br/>     for x in range(20):<br/>      Squares.append(x**2)</span></pre><p id="91d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在修改数据帧的索引时，我们可以使用这种相当简洁的方式来处理大量的代码行。例如，如果我们想给数据帧中的所有邮政编码加2来帮助我们进行分析，我们可以使用列表理解</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="f620" class="jv jw hi la b fi le lf l lg lh">In []: new_zip = [i+2 for i in Unemployment.Zip]<br/>In []: Unemployment.Zip = new_zip<br/>In []: unemployment.head()<br/>Out[]:<br/>         Unemployment   Participants<br/>new_zip<br/>1003      0.06           13801<br/>1004      0.09           24551<br/>1005      0.17           11477<br/>1006      0.10            4086<br/>1007      0.05           11362</span></pre><p id="0b80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在大概就是这样了。我希望你学到了新东西。在下一个教程中，我将进入层次索引。</p><p id="3a27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望你在阅读和阅读这篇文章的时候和我写这篇文章的时候一样开心。</p><p id="1249" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">继续编码，直到我再次来到你身边！</p></div></div>    
</body>
</html>