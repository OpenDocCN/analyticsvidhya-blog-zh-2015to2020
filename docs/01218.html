<html>
<head>
<title>Performance Improvement of a Model Through Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过管道提高模型的性能</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/performance-improvement-of-a-model-through-pipelines-eb4b0560104?source=collection_archive---------23-----------------------#2019-10-08">https://medium.com/analytics-vidhya/performance-improvement-of-a-model-through-pipelines-eb4b0560104?source=collection_archive---------23-----------------------#2019-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9ddf2419cb7d8257512372ba6af5f465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eaIFQe_M-PA6I5yT"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1</figcaption></figure><h1 id="f5c5" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">问题动机</h1><p id="afb5" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我解决的问题动机是与<a class="ae kq" href="http://archive.ics.uci.edu/ml/datasets/Adult" rel="noopener ugc nofollow" target="_blank">成人收入普查数据集</a>相关的收入预测问题。目标是准确预测某人的年收入是高于还是低于50，000美元。我的目标是在添加一些步骤以获得更好的性能之前，改进我已经完成的机器学习工作流，同时保持决策树模型的使用。</p><h1 id="c16f" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">管道描述</h1><p id="0498" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">首先，我们用熊猫加载数据集。由于数据集没有丢失值，这是我们不必担心的一件事。首先要做的一件重要事情是EDA(探索性数据分析)，这样我们可以更好地理解数据集，并查看哪些特征与目标变量具有最大的相关性。</p><p id="6f3a" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">之后，我们必须清理、准备和操作数据。我选择了开始做<em class="kw">特色工程</em>。键入`<em class="kw"> dataset.info() </em>`，我们可以看到有<em class="kw"> int64 </em>和<em class="kw"> object </em>列。我对待这个物体特征的方式是:</p><ol class=""><li id="471e" class="kx ky hi ju b jv kr jz ks kd kz kh la kl lb kp lc ld le lf bi translated">检查这些特征中的哪些可以变成二进制列(如只能变成<em class="kw"> Single </em>或<em class="kw">已婚</em>的“婚姻状况”)，因为仅仅通过为列的每个变量分配不同的值来将这种分类特征转换成<em class="kw"> int </em>会使分类变得不可靠，因为分类器认为类别具有自然的顺序；</li><li id="a08b" class="kx ky hi ju b jv lg jz lh kd li kh lj kl lk kp lc ld le lf bi translated">做pd。Categorical()将一些对象特性转换为int，包括二进制对象特性(在本例中，以一种更好的方式，只转换为0和1)。</li></ol><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/ba658d47fbf25376a88b2332a49a7d8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7Z9eu1K5UPtKQiSvFZ_vQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图2</figcaption></figure><p id="5f63" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">此时，我们必须进行建模，换句话说，将数据分为训练/验证和测试。如果我们的目标不是用同一个模型(决策树)得到更好的结果，我们也可以做交叉验证来选择最佳模型。现在，我们使用网格搜索根据模型选择最佳超参数，最后，完成模型，对其进行预测并查看结果。</p><h1 id="d650" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">模型定制和超参数</h1><p id="6111" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">因为我只想使用决策树模型，所以我用决策树模型中的一些超参数创建了一个字典。该字典曾被用作网格搜索参数的<em class="kw"> param_grid </em>。根据网格搜索的结果，我可以发现最佳的超参数是:'<em class="kw">最大深度</em> ': 10，'<em class="kw">最小样本叶</em> ': 5和'<em class="kw">最小样本分割</em> ': 40 <em class="kw">。</em></p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/520d00443bf6ede1a72a39ef400aa768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SY_ke_CNo5sRFv-jRQS3zA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3</figcaption></figure><h1 id="7cda" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结果</h1><p id="c2ad" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">达到的精度正好是0.8581298940580377，比之前好一点，也就是小于0.82。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/b6514777a73696c69a01ee9eb1a90730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*qJO-oYWCKx612MnxfQCkSg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4</figcaption></figure><h1 id="446f" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结论</h1><p id="e397" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在这之前提到的变化，我用的是pd。分类()到<em class="kw">所有的</em>非整型特征，所以我把分类特征转换成<em class="kw">整型</em>，只是通过给每个变量分配不同的值，这并不好(除了生成二进制特征，一次热编码是一个好的解决方案)。因此，特征工程是一个很难的步骤，选择好做什么是至关重要的。除此之外，进行模型定制和测试最佳的超参数确实可以改进模型。结论是，尽管仍有几个改进模型的可能性，例如<em class="kw">特征选择</em>，但添加上述步骤非常重要，确实提高了模型的效率。</p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="b1d6" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated"><strong class="ju hj">结束。</strong></p></div></div>    
</body>
</html>