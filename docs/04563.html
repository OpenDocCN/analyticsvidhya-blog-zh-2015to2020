<html>
<head>
<title>Flight of Corona — a visualization journey around the earth in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">日冕的飞行——R中环绕地球的可视化之旅</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/flight-of-corona-a-visualization-journey-around-the-earth-in-r-fe7d82a41b1?source=collection_archive---------16-----------------------#2020-03-24">https://medium.com/analytics-vidhya/flight-of-corona-a-visualization-journey-around-the-earth-in-r-fe7d82a41b1?source=collection_archive---------16-----------------------#2020-03-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e26b92932ac62d8b2c34cea05855b986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_PwOEdR6v6EE2YOAdENcag.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">科罗娜环球之旅从中国开始</figcaption></figure><p id="1e12" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2019年12月31日，中国当局确认了一种新型肺炎的存在。源头被追踪到了电晕中心武汉的一个肉市场。</p><p id="18d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">后来中国当局将其命名为nCov或新型冠状病毒。自一月份被发现以来，它已经像野火一样蔓延到世界各地，截至2020年3月24日，全球已有超过36万人感染，超过16000人死亡。</p><p id="c1d4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是迄今为止隐形病毒对人类最致命的攻击，到目前为止，医学科学家正在一天24小时工作，寻找治愈它的疫苗。</p><p id="fb18" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这篇文章中，我试图形象化科罗纳的旅程，以及它是如何通过可视化成为全球疫情的。</p><p id="6da9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我使用R和three.js包来可视化Corona旅程和在全球的传播。</p><p id="f4e1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">根据cran.r wesite，threejs包支持交互式3D图形，包括使用three.js和htmlwidgets的点云和球体。点击此处查看全部详情。我在这里使用了来自<a class="ae js" href="https://cran.r-project.org/web/packages/threejs/threejs.pdf" rel="noopener ugc nofollow" target="_blank">的代码</a>，并将Corona数据集放入相同的代码中。所以这篇文章归功于cran.r-project.org。</p><p id="9a10" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">数据取自2020年3月21日的GitHub。所有的经度和纬度也取自同一数据。该数据每天更新，被认为是最可信的数据。在这里找到数据<a class="ae js" href="https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data" rel="noopener ugc nofollow" target="_blank">的链接</a>。数据以汇总数据和时间序列数据的形式出现。在这篇文章中，我使用的是汇总数据。这是数据的第一张图片</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/1a88b6f24c602790e3e1410d5d86b6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KvWqUfFqxq3MPZ8rwBW1Ug.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">GitHub网站的初始数据</figcaption></figure><p id="6a28" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">该数据包含每天的确诊、死亡和恢复病例。可以找到传播的国家/地区和省份/州。</p><p id="aaa9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在使用这些数据时，我必须首先清理它们。对于一些国家，数据是以州为单位显示的，如美国、中国、英国等。所以我不得不手动汇总数据，然后把它放在一个单独的文件中。对于一些国家，我必须手动添加纬度和经度。对于一些地区，我发现纬度和经度指向大海(可能是游轮的位置)。</p><p id="c97d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是清理后的数据。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/471850a714043ce1a167d8f5b5d0a950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*QhO4Eaf8EXWcZPb2PC0NGw.jpeg"/></div></figure><p id="f8c3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">由于日冕的起点是武汉，我们需要以这样一种方式转换数据，即我们应该将中国的纬度和经度作为起点，将其他国家作为纬度和经度的目的地。</p><p id="5e4f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以我进一步处理了我的数据，这是最终的数据，可以显示为航班数据。你可以在C列和D列看到相同的经度和纬度。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/acad4673895cdf2c96446c6fe1e5058b.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*7UXMZY7o1CXn1tpzvmjh0A.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">显示日冕在全球飞行的最终数据集</figcaption></figure><h1 id="c31b" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">可视化1</h1><p id="f093" class="pw-post-body-paragraph iu iv hi iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr hb bi translated">让我们加载数据集，阅读上述文件，看看数据。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="fa64" class="li kb hi le b fi lj lk l ll lm">library(threejs)</span><span id="5f52" class="li kb hi le b fi ln lk l ll lm">CoronaFlight &lt;- read.csv(“D:/Harish/R practice projects/Corona/22March2020/21032020Data_Corona_Flight.csv”)</span><span id="87e7" class="li kb hi le b fi ln lk l ll lm">CoronaFlight</span><span id="f27b" class="li kb hi le b fi ln lk l ll lm">&gt; CoronaFlight<br/> dest_lat dest_long origin_lat origin_long<br/>1 33.9391 67.7100 30.9756 112.2707<br/>2 41.1533 20.1683 30.9756 112.2707<br/>3 28.0339 1.6596 30.9756 112.2707<br/>4 42.5063 1.5218 30.9756 112.2707<br/>5 -11.2027 17.8739 30.9756 112.2707<br/>6 17.0608 -61.7964 30.9756 112.2707<br/>7 -38.4161 -63.6167 30.9756 112.2707<br/>8 40.0691 45.0382 30.9756 112.2707<br/>9 -33.8688 151.2093 30.9756 112.2707<br/>10 47.5162 14.5501 30.9756 112.2707</span></pre><p id="fa8c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">加载地球图像。我用了美国宇航局的图像。你也可以使用threejs软件包中的地球图像。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="423a" class="li kb hi le b fi lj lk l ll lm">earth &lt;- “<a class="ae js" href="http://eoimages.gsfc.nasa.gov/images/imagerecords/73000/73909/world.topo.bathy.200412.3x5400x2700.jpg" rel="noopener ugc nofollow" target="_blank">http://eoimages.gsfc.nasa.gov/images/imagerecords/73000/73909/world.topo.bathy.200412.3x5400x2700.jpg</a>"</span></pre><p id="40e7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以这之后的代码非常简单。只需将数据集放入代码中，就能看到神奇之处。arcs参数将自动获取目的地并像航班一样显示它们。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="a334" class="li kb hi le b fi lj lk l ll lm">FlightOfCorona &lt;- globejs(img=earth, lat=CoronaFlight[,3], long=CoronaFlight[,4], arcs=CoronaFlight,<br/> arcsHeight=0.5, arcsLwd=1, arcsColor=”#ffff00", arcsOpacity=0.50,<br/> atmosphere=TRUE)</span><span id="0e3a" class="li kb hi le b fi ln lk l ll lm">FlightOfCorona</span></pre><p id="ac9b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦我得到了输出，我就把它保存为一个html页面，记录下那个页面，制作一个mp4文件，然后在一个在线工具的帮助下把它制作成一个gif。这是最终的输出。你可以清楚地看到电晕是如何从中国传播到所有国家的。使用相同的代码，您可以绘制不同出发地和目的地的航班数据。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/d4552c34b4796657ca5363dca7d31b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*HrwiYotQ5E3-h-I8eKh57w.gif"/></div></figure><h1 id="f307" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">可视化2</h1><p id="d1c9" class="pw-post-body-paragraph iu iv hi iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr hb bi translated">现在，使用与我在前面部分中向您展示的已清理数据相同的数据，我将向您展示已确认、死亡和已恢复病例的可视化效果。包装也是一样的。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="51ab" class="li kb hi le b fi lj lk l ll lm"><br/>#load the package<br/>library(threejs)</span><span id="653e" class="li kb hi le b fi ln lk l ll lm">#set working directory<br/>setwd(“D:/Harish/R practice projects/Corona/22March2020”)</span><span id="0b85" class="li kb hi le b fi ln lk l ll lm">#read the file<br/>final = read.csv(“21032020Data_2.csv”)</span></pre><p id="376d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">查看列名</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="2555" class="li kb hi le b fi lj lk l ll lm">#look at the column names<br/>colnames(final)</span><span id="3108" class="li kb hi le b fi ln lk l ll lm">&gt; colnames(final)<br/>[1] “Country” “Confirmed” “Death” “Recovered” “Latitude” “Longitude”</span></pre><p id="fba8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">国家的数量是178个。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="c037" class="li kb hi le b fi lj lk l ll lm">nrow(final)</span><span id="a94b" class="li kb hi le b fi ln lk l ll lm">&gt; nrow(final)</span><span id="bf05" class="li kb hi le b fi ln lk l ll lm">[1] 178</span></pre><p id="2fc2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">看数据。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="8b35" class="li kb hi le b fi lj lk l ll lm">head(final, n = 10)</span><span id="f6e7" class="li kb hi le b fi ln lk l ll lm">&gt; head(final, n = 10)<br/> Country Confirmed Death Recovered Latitude Longitude<br/>1 Afghanistan 24 0 1 33.9391 67.7100<br/>2 Albania 76 2 2 41.1533 20.1683<br/>3 Algeria 139 15 32 28.0339 1.6596<br/>4 Andorra 88 0 1 42.5063 1.5218<br/>5 Angola 2 0 0 -11.2027 17.8739<br/>6 Antigua and Barbuda 1 0 0 17.0608 -61.7964<br/>7 Argentina 158 4 3 -38.4161 -63.6167<br/>8 Armenia 160 0 1 40.0691 45.0382<br/>9 Australia 1071 7 26 -33.8688 151.2093<br/>10 Austria 2814 8 9 47.5162 14.5501</span></pre><p id="07df" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在从<a class="ae js" href="http://eoimages.gsfc.nasa.gov/images/imagerecords/73000/73909/world.topo.bathy.200412.3x5400x2700.jpg" rel="noopener ugc nofollow" target="_blank">这里</a>载入地球的图像。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="bd98" class="li kb hi le b fi lj lk l ll lm">#find the earth image<br/>earth &lt;- “<a class="ae js" href="http://eoimages.gsfc.nasa.gov/images/imagerecords/73000/73909/world.topo.bathy.200412.3x5400x2700.jpg" rel="noopener ugc nofollow" target="_blank">http://eoimages.gsfc.nasa.gov/images/imagerecords/73000/73909/world.topo.bathy.200412.3x5400x2700.jpg</a>"</span></pre><p id="92aa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们用下面的代码来可视化确认的案例。在这里，你需要考虑确诊病例。将纬度和经度分别放在lat和long参数中。你可以通过输入不同的值来玩代码，比如颜色、点的大小或者不同的地球图像。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="4bb9" class="li kb hi le b fi lj lk l ll lm">confirmed &lt;- globejs( img=earth, lat = final$Latitude, long = final$Longitude,<br/> value = final$Confirmed,col = ‘#FFFF00’,<br/> pointsize = 1.0,<br/> atmosphere = TRUE)</span><span id="d615" class="li kb hi le b fi ln lk l ll lm">confirmed</span></pre><p id="a228" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是最终的输出。我在飞行示例中使用了与上面提到的相同的过程。条形表示确诊病例数。查看中国、欧洲国家和伊朗的酒吧长度。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/db48fcca9581abb9dd1698f7e47f1f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*bKEJEvjehYEI6l0qRF0PgQ.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">电晕确诊病例</figcaption></figure><p id="cdbd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们得到相同数据的死亡案例。红色条表示死亡病例的数量。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="3325" class="li kb hi le b fi lj lk l ll lm">Death &lt;- globejs( img=earth, lat = final$Latitude, long = final$Longitude,<br/> value = final$Death, col = ‘#FF00001’,<br/> pointsize = 2.0,<br/> atmosphere = FALSE)<br/>Death</span></pre><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/36500fb3384c96b90765dce411ea44c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*eYPRn8GBbw7T80rMUe4DAQ.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">电晕死亡案例</figcaption></figure><p id="6d64" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们用相同的数据绘制恢复的案例。白条表示死亡病例的数量。</p><pre class="ju jv jw jx fd ld le lf lg aw lh bi"><span id="f87c" class="li kb hi le b fi lj lk l ll lm">Recovered &lt;- globejs( img=earth, lat = final$Latitude, long = final$Longitude,<br/> value = final$Recovered, col = ‘#FFFFFF’,<br/> pointsize = 2.0,<br/> atmosphere = FALSE)<br/>Recovered</span></pre><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/51f1b476744a254f87a2959327e0698a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*hyOG9GMwo4pyvvLLTIUY9Q.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">电晕恢复案例</figcaption></figure><p id="7318" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">就这样，我完成了我的文章。感谢阅读全文。很快会遇到一篇新文章。</p><p id="474f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请随时给我留言或给我发邮件到harnagpal@gmail.com。在<a class="ae js" href="https://www.linkedin.com/in/harish-nagpal-8696529/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>和我联系。</p><p id="09cf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">看看我其他关于Medium.com的文章</p><div class="lq lr ez fb ls lt"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/data-science-use-cases-in-life-insurance-8cfbfd8b2fff"><div class="lu ab dw"><div class="lv ab lw cl cj lx"><h2 class="bd hj fi z dy ly ea eb lz ed ef hh bi translated">人寿保险中的数据科学用例</h2><div class="ma l"><h3 class="bd b fi z dy ly ea eb lz ed ef dx translated">数据科学是当今科技界的一个新现象。随着计算能力的增加，它已经改变了世界…</h3></div><div class="mb l"><p class="bd b fp z dy ly ea eb lz ed ef dx translated">medium.com</p></div></div><div class="mc l"><div class="md l me mf mg mc mh io lt"/></div></div></a></div><p id="f76b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" rel="noopener" href="/analytics-vidhya/create-beautiful-visualization-of-data-in-trelliscopejs-package-in-r-c67879c55864">选举可视化带R </a></p><p id="e875" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">c<a class="ae js" rel="noopener" href="/analytics-vidhya/create-beautiful-visualization-of-data-in-trelliscopejs-package-in-r-c67879c55864">trelliscope js-package-in-r-</a></p><p id="1fc2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里看我的数据科学数学艺术<a class="ae js" href="https://www.instagram.com/artofhary/" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="4121" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">参考</h1><p id="a715" class="pw-post-body-paragraph iu iv hi iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr hb bi translated"><a class="ae js" href="http://eoimages.gsfc.nasa.gov/images/imagerecords/73000/73909/world.topo.bathy.200412.3x5400x2700.jpg" rel="noopener ugc nofollow" target="_blank">地球图像</a></p><p id="607b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://cran.r-project.org/web/packages/threejs/threejs.pdf" rel="noopener ugc nofollow" target="_blank"> R三合一包装</a></p><p id="cbc0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://github.com/CSSEGISandData/COVID-19/blob/master/csse_covid_19_data" rel="noopener ugc nofollow" target="_blank">数据来源</a></p><p id="6db3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="http://cran.r-project.org" rel="noopener ugc nofollow" target="_blank">起重机- </a> r</p></div></div>    
</body>
</html>