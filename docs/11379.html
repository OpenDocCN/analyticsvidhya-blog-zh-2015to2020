<html>
<head>
<title>Car Damage Assessment using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习的汽车损坏评估</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/car-damage-classification-using-deep-learning-d29fa1e9a520?source=collection_archive---------0-----------------------#2020-12-01">https://medium.com/analytics-vidhya/car-damage-classification-using-deep-learning-d29fa1e9a520?source=collection_archive---------0-----------------------#2020-12-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/24778e429e57d6e692149e11416646f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jWwb8e0eNhE-RH__sWmRcg.gif"/></div></div></figure><h1 id="1d4b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">概述:</h1><p id="a70e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在汽车保险行业，大量的金钱被浪费在索赔泄漏上。索赔漏损是索赔的最佳解决方案和实际解决方案之间的差距。正在使用目视检查和验证来减少索赔泄漏。但是检查可能需要很长时间，并导致索赔处理的延迟。用于检查和验证的自动化系统将对加速该过程有很大帮助。</p><h1 id="c731" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">内容:</strong></h1><ol class=""><li id="61b7" class="km kn hi jq b jr js jv jw jz ko kd kp kh kq kl kr ks kt ku bi translated">业务用例</li><li id="93ae" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">映射到深度学习问题</li><li id="76bd" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">数据源</li><li id="f4c5" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">现有方法</li><li id="4205" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">对现有方法的改进</li><li id="0678" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">探索性数据分析</li><li id="c3e2" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">首次切割方法</li><li id="df3b" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">深度学习模型</li><li id="a790" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">模型比较和选择</li><li id="5c62" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">Yolo V3</li><li id="b970" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">最终管道</li><li id="60b1" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">Web应用程序</li><li id="3818" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">未来的工作</li><li id="e85a" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">参考</li></ol><h1 id="e167" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">1.业务用例:</h1><p id="0b5a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">减少保险处理过程中的索赔损失。正在进行目视检查和验证。因为这需要很长时间，因为人们需要过来检查损坏情况。我们正试图使这一过程自动化。使用这种自动化将导致索赔处理更快。</p><h1 id="265f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">2.将问题映射到深度学习模型:</h1><p id="14a3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们正在尝试自动化车辆损坏的目视检查和验证。我们的输入数据是汽车受损的图像。</p><p id="8a36" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">为了验证车辆损坏，我们将问题分为三个阶段。1.首先，我们检查给定的汽车输入图像是否已经损坏。</p><p id="af84" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">2.其次，我们检查图像中汽车的哪一侧(前、后、侧)受损。</p><p id="7c38" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">3.第三，我们检查损坏的严重程度(轻微、中等、严重)。</p><p id="1b93" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">这个问题是一个经典的分类问题，因为我们将处理图像作为输入，我们将使用卷积神经网络(CNN)。</p><p id="2abb" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">绩效指标</strong>:</p><p id="1d58" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">在这方面，我们使用准确度、精确度和召回率作为性能指标。</p><p id="4066" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">为了计算准确度、精确度和召回率，我们需要构造混淆矩阵。上述公式如下所示。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/9cce1c34c2744f3a4bddf971fa052e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*6UJvbvmXGmeAwGh2Fyd58Q.jpeg"/></div></div></figure><h1 id="e65a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">3.数据源:</h1><p id="9796" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">因为汽车损坏的数据很少。汽车数据集从下载。</p><p id="7b93" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">【https://www.kaggle.com/anujms/car-damage-detection. T4】</p><p id="eb00" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">上面的数据集是按照我们需要的阶段划分的。</p><p id="e51b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">这包括培训和验证，其中每个文件夹有损坏的汽车照片和全车照片。总共有2300幅图像出现在训练和验证组合中。</p><h1 id="2215" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">4.现有方法:</h1><ol class=""><li id="7bcd" class="km kn hi jq b jr js jv jw jz ko kd kp kh kq kl kr ks kt ku bi translated"><a class="ae lk" href="https://www.ee.iitb.ac.in/student/~kalpesh.patil/material/car_damage.pdf" rel="noopener ugc nofollow" target="_blank">https://www . ee . iitb . AC . in/student/~ kalpesh . Patil/material/car _ damage . pdf</a></li></ol><p id="9284" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">在上述论文中，该团队收集了图像并将数据集分为8类(保险杠凹痕、车门凹痕、玻璃破碎、前照灯破碎、尾灯破碎、擦伤、粉碎、无损坏)。</p><p id="8256" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">由于包含图像的数据集较少，因此他们使用水平翻转在-20°和20°之间随机旋转的增强，将数据集综合放大了5倍。</p><p id="a554" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">他们从零开始训练了一个卷积神经网络和AE CNN。准确率没有达到75%。所以他们去训练预训练的模型。他们使用了预先训练的模型Cars、Inception、Alexnet、VGG19、VGG16和Resnet。他们从预训练模型和SoftMax的输出中训练线性svm，使用adadelta优化和交叉熵损失。实验表明，使用SoftMax分类器比线性SVM分类器效果更好，训练速度更快。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/d4f4f785c23652d53c151739fbe3916d.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*UIRaJ9Cky9nYITSZmYlqhg.png"/></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/9a62fe5482a3c970f828835d1d471c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHLJuc9gEL0s3aRFRvEtQQ.png"/></div></div></figure><p id="cbaa" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">2.<a class="ae lk" href="https://easychair.org/publications/preprint_open/RlQ2" rel="noopener ugc nofollow" target="_blank">https://easychair.org/publications/preprint_open/RlQ2</a></p><p id="f670" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">在这篇论文中，该团队收集了图像，并准备了受损汽车的数据集。他们将数据集分为保险杠凹痕、车门凹痕、玻璃破碎、头灯破碎、尾灯破碎、擦伤、粉碎、无损坏。</p><p id="f278" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">他们通过旋转20度、剪切0.2、缩放范围0.2和水平翻转将数据集放大了4倍。</p><p id="850f" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">而不是在没有预训练重量的情况下训练CNN。他们选择了预先训练好的模型(Alexnet，Inception V3，VGG19，Resnet50，Mobile nets)。他们只训练FC层和每个预训练模型的所有层。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/20ee2c4c3857ae396a39a32a01a33ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v_hnGJ7hNTuZSjRO8zjg7g.png"/></div></div></figure><p id="533f" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">在这个过程中，他们使用YOLOV3来定位损坏，并使用边界框来突出显示。</p><h1 id="c723" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">5.对现有方法的改进:</h1><p id="6fb6" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在所有上述模型中，只有预训练模型的表现优于从头训练。</p><p id="52c4" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我将使用VGG16，VGG19，Resnet。我们也可以使用密集网络，我们可以看到它如何优于其他网络。</p><h1 id="ec2d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">6.探索性数据分析:</h1><p id="c171" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们有三种类型的数据:</p><ol class=""><li id="0821" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">培训和测试文件夹的汽车损坏，而不是损坏的图像。</li><li id="c131" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">培训和测试文件夹的前部、后部和侧面有损坏。</li><li id="8ef5" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">损坏严重程度为轻微、中等、严重的培训和测试文件夹。</li></ol><h2 id="9fae" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated"><strong class="ak">第一阶段(损坏或未损坏):</strong></h2><p id="ec14" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在EDA中，我们将查看每个文件夹有多少个文件，以及数据中顶部图像的高度和宽度。</p><p id="a186" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">条形图:</strong></p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/d122b8f3a07282f52bdf8d9284a55d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*qYFmCDp4iHROm6sEBdcO4w.png"/></div></figure><p id="a7d9" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察结果</strong>:</p><ol class=""><li id="4986" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从列车图中我们可以看到，受损和未受损等级的图像是相等的。</li><li id="e1e2" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">不存在阶级不平衡。</li><li id="3518" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">由于我们拥有的数据集较少，我们可以使用数据扩充来扩大数据集。</li></ol><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/ba834ed786b4a8fd1edae255ce7d5d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*78E-B_-zCaXB81vCKDK_aA.png"/></div></figure><p id="c3cc" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="27cd" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从测试图中我们可以看到，受损和未受损类的图像是相等的。</li><li id="b831" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">因为cars数据集很少，所以测试文件夹中的图像数量较少。</li></ol><p id="dc52" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">图像尺寸图:</strong></p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/7a873d61316443d4f9ac829581ace6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzQOLtpMmGQ0ezn_lJlrVQ.png"/></div></div></figure><p id="28a5" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="3691" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从上面的图中我们可以看到，(194，259)图像形状在受损文件夹和未受损文件夹中比其他图像形状更丰富。</li><li id="3208" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">但是在未损坏的文件夹中，具有(194，259)和(480，640)的图像的数量几乎相等。</li><li id="bd14" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">列车损坏文件夹中有132个独特的图像形状。</li><li id="ba17" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">“列车未损坏”文件夹中有385个独特的图像形状。</li></ol><h2 id="faa0" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">阶段2(前部、后部和侧面):</h2><p id="8fb8" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">柱状图:</strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/91c742f2e9779cf95427fb4a160cef87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*FOb_sASE5L6aOoDBrfVhzw.png"/></div></figure><p id="d517" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="4c7d" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从火车图中我们可以看到，前面、后面和侧面的图像是不相等的。</li><li id="8b8a" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">我们有更多的正面图像，后面和侧面的数量几乎相等。</li><li id="3701" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">由于我们拥有的数据集较少，我们可以使用数据扩充来扩大数据集。</li></ol><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/436072588f7cd7a156c5e799c9af3800.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*8PrFR-aAGGKzqwjibHAk-w.png"/></div></figure><p id="6d6e" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="8f4f" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从测试图中我们可以看到，我们的前、后和侧类图像是不平等的。</li><li id="4eac" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">因为cars数据集很少，所以测试文件夹中的图像数量较少。</li></ol><p id="8862" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">图像图:</strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/e281532706c2b50f4ba645c8beec985c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K8IaV7WKqhjm_jzX8haNXg.png"/></div></div></figure><p id="661a" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="d06d" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从上面的图中我们可以看到,( 194，259)的图像形状在所有的类中都更加丰富。</li><li id="a3be" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">列车前部文件夹中有70个独特的图像形状。</li><li id="34ec" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">列车后部文件夹中有67种独特的图像形状。</li><li id="d1d6" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">列车侧文件夹中有60个独特的图像形状。</li></ol><h2 id="bf51" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">第三阶段(轻度、中度和重度):</h2><p id="8d12" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">条形图:</strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/4f11b2e7f70b7430358e84184b4034ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*CdrMfsxHD2N76nxPmQEK-A.png"/></div></div></figure><p id="f803" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="9d8e" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从火车图中我们可以看到，我们对轻微、中度和严重的印象是不一样的。</li><li id="4aa5" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">我们有更多的严重图像和较少的轻微图像。</li><li id="bc7c" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">由于我们拥有的数据集较少，我们可以使用数据扩充来扩大数据集。</li></ol><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/53f28ce4df5b32f0c52798a7f3960547.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*uSONntXQqCSdDQFcJNaNWA.png"/></div></figure><p id="16ba" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="2bee" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从测试图中我们可以看到，轻微、中等和严重的图像是不相等的。</li><li id="9941" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">因为cars数据集很少，所以测试文件夹中的图像数量较少。</li></ol><p id="9af3" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">图像情节:</strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/b7f059fb9a0dea87f4709d9a44a61955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3r89wvfH73Xy5vF6jF-wag.png"/></div></div></figure><p id="4505" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">观察:</strong></p><ol class=""><li id="aaae" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从上面的图中我们可以看到,( 194，259)的图像形状在所有的类中都更加丰富。</li><li id="51bd" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">列车前部文件夹中有66种独特的图像形状。</li><li id="df11" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">列车后部文件夹中有63种独特的图像形状。</li><li id="b709" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">列车侧文件夹中有70个独特的图像形状。</li></ol><h1 id="f9e9" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">7.首次切割方法:</h1><p id="6d91" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">由于我们拥有的数据集很小，我们将使用数据扩充综合放大数据集两倍。各种论文显示了不同类型的数据增强。我们将使用以下两种类型的数据增强，看看哪种性能更好。</p><ol class=""><li id="4b8d" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">-20到20度之间的随机旋转和水平翻转变换。</li><li id="5c93" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">在-20和20之间随机旋转，剪切范围为0.2，缩放范围为0.2，水平翻转。</li></ol><p id="0dc6" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我们将创建所需的培训文件夹来保存数据增强图像。</p><h2 id="0fa8" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">数据扩充:</h2><p id="055a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">由于我们拥有的数据较少，我们将使用数据扩充来综合扩大数据集。正如在现有的方法中提到的，我将使用两种类型的增强，并将数据集放大两次。</p><ol class=""><li id="c1ed" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">使用-20到20度之间的随机旋转和水平翻转变换将数据集放大两倍。</li><li id="0ea3" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">使用-20和20之间的随机旋转、0.2的剪切范围、0.2的缩放范围和水平翻转将数据集放大两倍。</li></ol><p id="01c4" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">数据增强的可视化:</strong></p><p id="2a59" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">数据扩充1:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/97c8b8b2a0277b06931c19a75dbe7280.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*PaCfCWuG8P17YL_rHCUXZA.png"/></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">原创</figcaption></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/3be7fd5f046ee87fc028541cdb816264.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*sq5mgNSNfhhs7ZDIiYDLOA.png"/></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">数据增强图像</figcaption></figure><p id="4488" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">数据扩充2:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/04aa4a4f64ca32dbddba12fc7ee6e5fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*s8l1JEMcLL1_5_MnsTA9cg.png"/></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">原创</figcaption></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/23dda838f866c4206c206bfc7395c64a.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*2-cXLDwAmh6DD-wqg1mz_w.png"/></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">数据扩充</figcaption></figure><p id="9fe2" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">因此，我们将对我们拥有的所有数据进行数据扩充，并在一个文件夹中创建由原始图像和生成的图像组成的文件夹。</p><p id="f63b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我为每个阶段创建了三种类型的数据。让我们分别查看每个阶段的文件数量。</p><p id="ee00" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">检查是否损坏:</p><ol class=""><li id="0581" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">原始数据(1840个训练文件，460个测试文件)</li><li id="bca5" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">原始数据+数据扩充1 (3680个训练文件，460个测试文件)</li><li id="bbf9" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">原始数据+数据扩充2 (3680个训练文件，460个测试文件)</li></ol><p id="db24" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">检查前面、后面或侧面:</p><ol class=""><li id="2ba2" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">原始数据(985个训练文件，179个测试文件)</li><li id="6b2b" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">原始数据+数据扩充1 (1970个训练文件，179个测试文件)</li><li id="0824" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">原始数据+数据扩充2 (1970个训练文件，179个测试文件)</li></ol><p id="b8c5" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">检查轻微、中等、严重:</p><ol class=""><li id="3143" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">原始数据(979个训练文件，171个测试文件)</li><li id="1ccb" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">原始数据+数据增补1 (1958个训练文件，171个测试文件)</li><li id="14b7" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">原始数据+数据扩充2 (1958个训练文件，171个测试文件)</li></ol><p id="9649" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">在对上述数据进行模型训练后，我将使用YOLO V3使用边界框将图像分类为以下类型之一。</p><ol class=""><li id="0af9" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">玻璃和灯碎了</li><li id="ab6c" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">汽车凹痕和划痕</li><li id="bfd8" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">破碎</li></ol><h1 id="2649" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">8.型号:</h1><p id="d5dc" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">因为预训练模型比从头开始训练模型效果更好。我们将在没有完全连接层的情况下导入以下预训练模型。</p><p id="2830" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">在图像网络数据集上进行预训练:</p><ol class=""><li id="41d8" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">VGG16</li><li id="ae54" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">VGG19</li><li id="1d59" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">DenseNet201</li><li id="1aba" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">ResNet50</li></ol><p id="34c3" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我们需要一个基线模型来比较我们的神经网络模型。因此，我将使用逻辑回归作为基线模型，从上述预训练模型中提取特征。</p><p id="619b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我使用了预训练模型，并在单个ipynb中预测了所有阶段的类。我们有三个阶段</p><p id="cc78" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">第一阶段:检查是否损坏</p><p id="3355" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">第二阶段:损伤定位</p><p id="7375" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">第3阶段:评估损坏的严重程度</p><p id="3981" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">使用逻辑回归作为基线模型，我通过保持层作为第一模型的不可训练层和保持层作为第二模型的可训练层来训练上述模型。</p><p id="6035" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">由于这些型号没有FC层，我对所有型号都使用了以下配置。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="4438" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我已经创建了通用的函数，可以用于任何预训练的模型。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="5cfa" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">神经网络和基线模型的输入数据。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="7966" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">基线模型(逻辑回归):</strong></p><p id="acb6" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">下面的函数给出了使用预训练模型预测的一系列特征。我已经创建了一个x_train，y_train，x_test，y_test使用上述功能。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="bfe4" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">使用上述代码进行逻辑回归的超参数调整。使用上面的最佳alpha创建模型并将模型保存到磁盘。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="f163" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">混淆矩阵:</p><p id="7d27" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">对于二进制值阶段1(检查是否损坏)</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es my"><img src="../Images/7ebf7cfe9ac91acb5307d02ca4743bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*ITXrj5xKOGHa3qPmiW5FvA.png"/></div></figure><p id="f921" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">对于多类，我将展示混淆，精度和召回矩阵，并计算平均精度和召回。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/466108d6f87519dbf8f8f6fc80f0bcc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*oea-YQDsr22rP1AvNoSPrA.png"/></div></figure><p id="e19d" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">基线模型的代码:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="a78f" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">神经网络:</strong></p><p id="e789" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我创建了下面的函数，分别是只在FC层上训练和在所有层上训练。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="58d2" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">使用上述函数创建模型后，我使用阶段1的二元交叉熵损失和阶段2和阶段3的分类交叉熵损失进行了编译。使用SGD优化器和准确性作为度量。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="4d6b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我已经训练了50个纪元的每个模型，并使用模型检查点保存最佳模型。</p><p id="cec1" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">阶段1使用VGG16的示例:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="cdd8" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我一共培养了108个模特。下面是我得到的分数和对每个数据的结论。</p><h1 id="63d2" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">9.型号比较和选择:</h1><p id="0cdc" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">原始数据:</strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/138eab381081f68ad9b5bd02c420e200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRQbIle6ciZ-qEmINacPYQ.png"/></div></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/6bd7b67d81f77a236cc2e1f9003d82c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VdX8F0R23YtC-Qo3Dc6dXQ.png"/></div></div></figure><p id="fb4b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">原始数据+数据扩充1: </strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/5e0eaf4d7b0d321810a8e579b4a7afc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SX9gVOeXwTf8JvYtngz_kw.png"/></div></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/c5453685fd30721423df47123f4e8b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xErtmqgGwq35hSgIwctBNA.png"/></div></div></figure><p id="f8e1" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">原始数据+数据扩充2:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/e767618bd9d6b3b48b7c0b9afd569164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5mFBvTV8P4-YuJPPwtvEA.png"/></div></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/b9c7249e27fe8e5bcb27067a9b2eb3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgQrWqhWaKt3EMhxWRQvgg.png"/></div></div></figure><p id="0de1" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">结论:</strong></p><ol class=""><li id="fb4f" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">从以上所有模型中，我们可以看到，在增强1的原始数据上训练的Densenet(在所有层上训练)模型在阶段2和阶段3中表现最佳。</li><li id="24ac" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">对于阶段1，在增强1的原始数据上训练的densenet(在所有层上训练)非常接近在原始数据上训练的模型，并且两个模型的精度相同。因此，我们可以使用用增强1在原始数据上训练的Densenet(在所有层上训练),而不是在原始数据上训练的模型。</li></ol><p id="ea57" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">所以强化1的Densenet(在所有层上训练)在所有3个阶段中效果最好。</p><h1 id="7825" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">10.YOLO V3:</h1><p id="d717" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我在训练yolov3时使用了下面的github链接作为参考。</p><div class="ng nh ez fb ni nj"><a href="https://github.com/robingenz/object-detection-yolov3-google-colab" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">robin genz/object-detection-yolov 3-Google-colab</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">本指南解释了如何使用Google Colaboratory上的Darknet使用YOLOv3训练您自己的自定义数据集。合作实验室…</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">github.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx io nj"/></div></div></a></div><p id="9ac8" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我已经使用了3个自定义对象检测类。</p><ol class=""><li id="8110" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">玻璃和灯碎了</li><li id="8ac2" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">汽车凹痕和划痕</li><li id="955c" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">破碎</li></ol><p id="0833" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">由于没有数据可以下载，我使用LabelImg工具来创建边界框并给出类。使用下面的github链接安装标签。</p><div class="ng nh ez fb ni nj"><a href="https://github.com/tzutalin/labelImg" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">佐他林/标签</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">LabelImg是一个图形化的图像注释工具。它是用Python写的，使用Qt作为它的图形界面…</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">github.com</p></div></div><div class="ns l"><div class="ny l nu nv nw ns nx io nj"/></div></div></a></div><p id="5a0b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">在为yolo创建数据之后，我已经按照为培训Yolo指定的方式创建了train.txt、test.txt、custom.data、yolov3_custom.cfg、custom.names文件。</p><p id="53c0" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">因为我们有3个职业，我们将训练yolo 6000个周期，重量将保存为1000的倍数。</p><p id="9990" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我已经使用了3种类型的测试图像来查看每种重量的表现。下面是测试图片。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es nz"><img src="../Images/cdd51e0f881b26097dac62dfdec08cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*rUxVqjebi3Xn5jmierm6KA.png"/></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">玻璃和灯破碎示例</figcaption></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es oa"><img src="../Images/52c0abe9bd40af7b5f5a0037943df1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*s3U3sKykmHeCm6nARtXtnw.png"/></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">汽车凹痕和划痕示例</figcaption></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ob"><img src="../Images/bce8d48cb7c45066edc92201b708607d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EXwuy42SVFD1I5iyKddjVw.png"/></div></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">粉碎示例</figcaption></figure><p id="28b4" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">结论:</strong></p><ol class=""><li id="ad73" class="km kn hi jq b jr la jv lb jz lo kd lp kh lq kl kr ks kt ku bi translated">在观察每个文件的结果后，Yolo custom 4000 weights给出了比其他型号更好的结果。</li></ol><h1 id="bd95" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">11.最终管道:</h1><p id="e591" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">代码下面是最终的管道。给定一个输入图像，它会给出报告和yolo预测。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="ff4c" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">下面是上述函数的输出:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es oc"><img src="../Images/78206e985e5d5aeefad771302cf75c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oryuvG2-sG3rXZdIQM9rrg.png"/></div></div></figure><p id="7e22" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">我只显示了VGG 16(只有FC层)的代码。关于EDA、VGG16、VGG19、Densenet、Resnet的其他模型和完整的ipynb文件，请访问我的GitHub资源库。</p><p id="c977" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">上面的文件在我的github存储库中被命名为final_old.ipynb。</p><h1 id="6ad8" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">12.Web应用程序:</h1><p id="4cdd" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">上面的final_old文件已被修改，以将输出返回到web app。我已经创建了一个模板文件夹，其中有app.html文件包含所需的网页。</p><p id="f3dd" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">因为我们将在Colab笔记本上运行，所以我使用Ngrok来运行flask。访问我的github存储库，找到final.ipynb文件，其中包含带ngrok实现的flask和app.html文件。</p><p id="f51b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">下面是web app的演示视频。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="od mg l"/></div></figure><h1 id="fc89" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">13.未来工作:</h1><ol class=""><li id="7c46" class="km kn hi jq b jr js jv jw jz ko kd kp kh kq kl kr ks kt ku bi translated">我们可以通过下载图像获得更多的数据，从而提高训练精度。</li><li id="7dea" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">使用云服务部署web应用程序。</li></ol><h1 id="e994" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">14.参考资料:</h1><ol class=""><li id="ded0" class="km kn hi jq b jr js jv jw jz ko kd kp kh kq kl kr ks kt ku bi translated"><a class="ae lk" href="https://www.ee.iitb.ac.in/student/~kalpesh.patil/material/car_damage.pdf" rel="noopener ugc nofollow" target="_blank">https://www . ee . iitb . AC . in/student/~ kalpesh . Patil/material/car _ damage . pdf</a></li><li id="d7b2" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">【https://www.kaggle.com/anujms/car-damage-detection T2】号</li><li id="411e" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated"><a class="ae lk" href="https://github.com/robingenz/object-detection-yolov3-google-colab" rel="noopener ugc nofollow" target="_blank">https://github . com/robin genz/object-detection-yolov 3-Google-colab</a></li><li id="90ad" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated"><a class="ae lk" href="https://github.com/tzutalin/labelImg" rel="noopener ugc nofollow" target="_blank">https://github.com/tzutalin/labelImg</a></li><li id="0ab3" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated"><a class="ae lk" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com</a></li></ol><h1 id="6df4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">个人资料:</h1><p id="fd4f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj"> GitHub资源库:</strong><a class="ae lk" href="https://github.com/bnspriyatham/Car-Damage-Classification" rel="noopener ugc nofollow" target="_blank"/><a class="ae lk" href="https://github.com/bnspriyatham/Car-Damage-Classification" rel="noopener ugc nofollow" target="_blank">https://github.com/bnspriyatham/Car-Damage-Classification</a></p><p id="fa06" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><strong class="jq hj">领英简介:</strong><a class="ae lk" href="https://www.linkedin.com/in/priyatham-bhaskara-21a670ab/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/priyatham-bhaskara-21a670ab/</a></p></div></div>    
</body>
</html>