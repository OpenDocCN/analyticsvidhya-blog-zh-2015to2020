<html>
<head>
<title>3 Ways to replace Vlookup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3种替换Vlookup的方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/3-ways-to-replace-vlookup-ad87908da3dc?source=collection_archive---------19-----------------------#2020-05-28">https://medium.com/analytics-vidhya/3-ways-to-replace-vlookup-ad87908da3dc?source=collection_archive---------19-----------------------#2020-05-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">通常来说，分析师的角色是动态的，尤其是当你在商业、数据和技术之间搭起桥梁的时候。那是我的角色:)</p><p id="4537" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有有趣和令人兴奋的东西分析部分总是发生在最后，但有<strong class="ih hj">重要</strong>和<strong class="ih hj">关键</strong>但<strong class="ih hj">无聊</strong>和<strong class="ih hj">平凡</strong>的东西，如<strong class="ih hj">数据清理</strong>。</p><p id="1354" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据清理</strong>就是理解最终目标、数据，并开发一种模式来清理数据。<br/>一种常见的数据清理模式是查找。只要你使用任何形式的电子表格，没有办法，你不使用Excel中的查找公式。我在办公室里每走8步，就能发现有人在用Excel上的vloookup。<br/>我们拥有的大部分数据总是不完整的，因此总是需要参照另一个数据集来获得更完整的图片。</p><blockquote class="jm"><p id="fa17" class="jn jo hi bd jp jq jr js jt ju jv jc dx translated">这是我根据不同的目标和最终用户的使用或交互使用的3种主要的查找模式和技术。</p></blockquote><ol class=""><li id="e907" class="jw jx hi ih b ii jy im jz iq ka iu kb iy kc jc kd ke kf kg bi translated">PowerQuery —合并</li></ol><p id="e8c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.DAX —串联x /值</p><p id="dd52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.python-PD . concat</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="b951" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">PowerQuery —合并</h1><p id="24ae" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated">这是我最喜欢的移动方式之一。大多数时候，在我清理和转换数据之后，<strong class="ih hj">我要求用户检查某些字段，并在相应的单元格中输入他们的注释，然后将其发送给我，以便我可以相应地处理它</strong>。我处理的数据量很容易在20k-2ml行之间，因此<strong class="ih hj"> vlookup对我来说不适用，因为它很耗时，增加了文件大小</strong>，并且它不能执行power query中提供的一些自动化过程。在PowerQuery中，合并类似于excel中的查找，但更好，因为它可以处理多对多。<br/>我通常处理的数据是多对多的关系，我的用户通常需要一行中的所有数据。因此，我不得不压缩它，删除重复的数据，并以可读的格式呈现数据。</p><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es lr"><img src="../Images/f8bef2d0210c0acbf1cad1d8e8d2f733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUDVkB2D75a01EZ164Vg0Q.jpeg"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">多对多并将数据压缩到一个唯一的单元格中</figcaption></figure><figure class="ls lt lu lv fd lw er es paragraph-image"><div class="er es mh"><img src="../Images/4d21b917cc27f385506d1769c35df6af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*7AJN6xKMN1OmcDeobvqnOQ.png"/></div><figcaption class="md me et er es mf mg bd b be z dx translated">将两个表格合并在一起以提取您需要的信息。就像查字典一样</figcaption></figure><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mi"><img src="../Images/5c19a3e095ee2c81e23aaf2017a36ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*IMaA7jL6M2FLYp5Ci-eSBw.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">在本例中，您可以看到连接到该特定键的另外两个数据</figcaption></figure><pre class="ls lt lu lv fd mj mk ml mm aw mn bi"><span id="4755" class="mo kp hi mk b fi mp mq l mr ms">Text.Combine(List.Distinct([Table][ColumnName]),"(delimiter)")</span></pre><figure class="ls lt lu lv fd lw"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="004a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你们中的大多数人可能会开始合并更大的数据集。随着<strong class="ih hj">合并</strong>而来的是最常见的性能问题，这些是我更喜欢的<strong class="ih hj">提升性能</strong>的方法。</p><h1 id="6f57" class="ko kp hi bd kq kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll bi translated">桌子。添加键</h1><p id="f2a9" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated"><a class="ae na" href="https://docs.microsoft.com/en-sg/powerquery-m/table-addkey" rel="noopener ugc nofollow" target="_blank">https://docs.microsoft.com/en-sg/powerquery-m/table-addkey</a><br/><a class="ae na" href="https://blog.crossjoin.co.uk/2018/03/16/improving-the-performance-of-aggregation-after-a-merge-in-power-bi-and-excel-power-query-gettransform/" rel="noopener ugc nofollow" target="_blank">https://blog . cross join . co . uk/2018/03/16/improving-of-a-merge-in-power-bi-and-excel-power-query-get transform/</a></p><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es nb"><img src="../Images/06444820dbbd6e713b7cdf68b2d0022c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nJ8tV4aPTMKjMokxE1X2Kw.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">table.addkey示例</figcaption></figure><p id="9e8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">表。缓冲器</strong></p><p id="2a74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我真的不怎么用这个来提高速度，但这是一种技术。<br/><a class="ae na" href="https://social.technet.microsoft.com/Forums/en-US/2cc1b370-9976-4a6b-add1-91efc1d522d7/when-to-use-tablebuffer?forum=powerquery" rel="noopener ugc nofollow" target="_blank">https://social . TechNet . Microsoft . com/Forums/en-US/2cc1b 370-9976-4a6b-add 1-91 EFC 1d 522d 7/when-to-use-table buffer？forum=powerquery </a></p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="5b22" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak"> DAX — Concatenatex(值))</strong></h1><p id="1778" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated">如果您在仪表板上显示数据，或者不需要您的输入，并且处理一对多关系，那么这种模式适合您。在计算列或度量中，有两种方法可以应用此公式，由于DAX执行公式的方式，我不推荐前者。</p><ol class=""><li id="6da1" class="jw jx hi ih b ii ij im in iq nc iu nd iy ne jc kd ke kf kg bi translated">计算列——尽管这是可能的，但如果你打算将它作为表格加载到excel中，我不推荐这种方法，因为如果你有大量数据，这将影响性能</li><li id="7cb3" class="jw jx hi ih b ii nf im ng iq nh iu ni iy nj jc kd ke kf kg bi translated">措施-我通常使用这种方法在数据透视表或PowerBI上呈现文本，最终用户只需要视觉辅助来做出某个决定或呈现某些事实<br/><a class="ae na" href="https://www.fourmoo.com/2018/05/08/dax-concatenating-values-only-when-values-are-selected/" rel="noopener ugc nofollow" target="_blank">https://www . four moo . com/2018/05/08/DAX-concating-values-only-when-values-selected/</a></li></ol><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es nk"><img src="../Images/f8eb0c18843e616a6081c42c9c97a913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0IOvjmcwl2JyUBJcK4OZg.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">度量，连接/值</figcaption></figure></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="ed1e" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">python-Pandas PD。串联</h1><pre class="ls lt lu lv fd mj mk ml mm aw mn bi"><span id="a7c9" class="mo kp hi mk b fi mp mq l mr ms">pd.concat([df1,df2], axis = 1 )</span></pre><p id="3d2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我的数据太大而无法通过PQ处理，这通常是我的首选PQ是提高性能的变通方法。<br/>但是我通常在python中编写完整的数据清理，而不是一点一点地编写，并为我的最终用户将导出文件加载到PowerBI或excel中</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><p id="2a0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong> <br/>如果您在通过Excel清理数据后需要来自最终用户的输入，那么PowerQuery是您最好的朋友，但是<br/>如果您只是呈现数字和处理一对多数据集，那么DAX更适合您<br/>如果性能是PowerQuery中的一个问题，那么Python-PD . concat是加快数据处理活动的一个很好的选择</p><p id="88d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您有这样的活动并且需要帮助，请随时写信给我或者分享您正在使用的其他合并模式。</p></div></div>    
</body>
</html>