<html>
<head>
<title>A Beginners Guide to Computer Vision (Part 2)- Edge Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉初学者指南(第二部分)——边缘检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-beginners-guide-to-computer-vision-part-2-edge-detection-4f10777d5483?source=collection_archive---------2-----------------------#2020-04-21">https://medium.com/analytics-vidhya/a-beginners-guide-to-computer-vision-part-2-edge-detection-4f10777d5483?source=collection_archive---------2-----------------------#2020-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1ed6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">了解边缘检测背后的算法及其实现。</p><p id="1dae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我上一篇博客的延续，请在继续这个话题之前浏览一下。</p><div class="jd je ez fb jf jg"><a rel="noopener follow" target="_blank" href="/@t.bharathchandra/a-beginners-guide-to-computer-vision-part-1-filtering-3d95a1d51fb1"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">计算机视觉初学者指南(第一部分)-过滤</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">计算机视觉是一个令人着迷的研究领域。它有着悠久的发展历史，被许多研究者所重视。</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">medium.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es jw"><img src="../Images/6c6607ee57d6fa12952e49088ed026cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*ujB8H3EkxMFVtmLUBSdDfQ.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">边缘的起源来源:<a class="ae kh" href="http://www1.idc.ac.il/toky/imageProc-08/lectures/06_edgeX4.pdf" rel="noopener ugc nofollow" target="_blank">http://www1 . IDC . AC . il/toky/image proc-08/lectures/06 _ edge x4 . pdf</a></figcaption></figure><h2 id="fb2c" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">什么是边缘检测？</h2><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es ld"><img src="../Images/d02839a9679c0dfb0ac9c62eae492be9.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*xvy8vrfGdZzh6z7DsKuESA.png"/></div></figure><p id="b29b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">边缘检测意味着在图像中找到边界，如上图所示。</p><p id="d754" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了评估边缘检测器的质量，我们使用精度和召回曲线。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es le"><img src="../Images/1751fc716457b2bfcf9f27bbbbfc9056.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*TpHxtv-I-cNUO0jLrOVhiA.png"/></div></figure><p id="31d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面图像中的地面实况(GM)是由人绘制的，方法(RM)的结果是在目标图像上运行边缘检测器之后获得的。真正值是地面真值和方法结果(算法预测的边)的交集区域。精密度是真阳性与方法结果的比值。回忆是真实的积极的和地面真实的比率。下面是不同边缘检测器与人类比较的精确召回曲线。我们的目标是开发一种边缘检测器，其精度-召回曲线高于人类标记。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es lf"><img src="../Images/7b5cfe50ac1cd3b2bb3c58094acb4cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*W1BZBH7HBS54RJiiGEXcAg.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">精度和召回曲线来源:【https://www.youtube.com/watch?v=7mEiTU-XgCo】T2&amp;list = PLD 3 hlsjsx _ imkp 68 wfkzjviptd 8 ie 5 u-9&amp;index = 3</figcaption></figure><h2 id="b18e" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">图像的导数</h2><p id="0fd2" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">连续函数的求导公式是你在高中学过的。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es ll"><img src="../Images/60c036c7793f64daf0952791bdc2da08.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*5Iebt96KnvyqEGhgdLg42A.png"/></div></figure><p id="b94d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是这个公式是针对连续函数的，图像是离散的！！。因此，当我们考虑像素在x方向的邻域时，如上式所示。那么δx将等于1。上面公式中的分子现在只是所考虑的像素和它前面的像素的亮度差。我们称之为向前差分导数。下面是用于查找图像在x方向的导数的遮罩。</p><pre class="jx jy jz ka fd lm ln lo lp aw lq bi"><span id="9b27" class="ki kj hi ln b fi lr ls l lt lu">Backward difference   [-1  1]<br/>Forward difference    [1  -1]<br/>Central difference   [-1 0 1 ]</span></pre><p id="769d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过上面的遮罩对图像进行卷积来找到图像的导数。为了得到更准确的结果，我们通常使用3X3的蒙版。下面是查找图像导数的代码片段。</p><pre class="jx jy jz ka fd lm ln lo lp aw lq bi"><span id="1b2d" class="ki kj hi ln b fi lr ls l lt lu">dx = np.array([[-1,0,1],<br/>               [-1,0,1],<br/>               [-1,0,1]])<br/>dy = np.array([[-1,-1,-1],<br/>               [0,0,0],<br/>               [1,1,1]])<br/>dx_img = ndimage.convolve(guassian_img, dx)<br/>dy_img = ndimage.convolve(guassian_img, dy)</span></pre><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es lv"><img src="../Images/0e07c864ed166cfaba7b64b3f07ccd7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*zAk4GAufZ7CcGlfnUF92yw.png"/></div></figure><h2 id="e04a" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">Prewitt边缘检测器</h2><p id="c369" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">任何边缘检测器流水线都是从滤波开始的。Prewitt边缘检测器使用均值掩模进行滤波。滤波后，我们会找到图像在X和Y方向的导数。微分后，我们会找到你之前找到的两个导数的合力。然后，我们应用阈值强度，并将图像转换为二值图像。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es lw"><img src="../Images/a6f844dea8c7aba94ebe3c04314c2fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*J6M2Xb3UVdWCvvLxnXHb8Q.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">Prewitt边缘检测器流水线</figcaption></figure><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es lx"><img src="../Images/40c6e118aa56d6e0f1596f6e9a625e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*al_QBi65W_GjV1erTYy5_g.png"/></div></figure><h2 id="5873" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">索贝尔边缘检测器</h2><p id="0af3" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">它几乎类似于Prewitt边缘检测，唯一的区别是我们使用不同的掩模来过滤图像。下面的流程图显示了所使用的掩码。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es lw"><img src="../Images/887d53c7addba1c0a7911e95b3351d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*mOTN8-JblbRatKDBsIJjXw.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">Sobel边缘检测流水线</figcaption></figure><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es lx"><img src="../Images/40c6e118aa56d6e0f1596f6e9a625e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*al_QBi65W_GjV1erTYy5_g.png"/></div></figure><h2 id="6f8e" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">Marr Hildreth边缘检测器(高斯拉普拉斯算子)</h2><p id="54b3" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">Marr Hildreth edge detector的灵感来源于神经科学。Marr的滤波器是拉普拉斯滤波器。拉普拉斯滤波器对噪声非常敏感。图像的拉普拉斯算子突出了快速强度变化的区域，因此经常用于边缘检测。因此，在应用拉普拉斯算子之前，我们需要使用高斯滤波器对图像进行适当的滤波。卷积(相关)运算是关联的，我们可以先将高斯平滑滤波器与拉普拉斯滤波器进行卷积，然后将这种混合滤波器与图像进行卷积，以达到所需的结果。结果如下图所示。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es ly"><img src="../Images/697896746dccdbdf965cc76a5c8ed150.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*TEpSP9SJKByedG6w3xDSBg.png"/></div></figure><p id="53a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">原木的形状像一顶倒置的帽子。上图还显示了sigma = 1.4时的9X9对数掩码。该掩模可以直接在图像上卷积，以获得该图像的对数。<strong class="ih hj">获得图像的日志后我们做什么？</strong></p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es lz"><img src="../Images/ca533b24ec7c9d192651dfc5f1485fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*NM00xpmPe8cAlbzo.gif"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">来源:https://homepages.inf.ed.ac.uk/rbf/HIPR2/log.htm<a class="ae kh" href="https://homepages.inf.ed.ac.uk/rbf/HIPR2/log.htm" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="14a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图是包含阶梯边缘的图像沿x轴的强度变化图。此图像的右侧显示了图像的对数图。当图像中存在边缘时，LoG中存在零交叉。因此，这是一个明显的证据，证明我们可以从过零检测边缘。下面是对过零点应用阈值的代码片段。</p><pre class="jx jy jz ka fd lm ln lo lp aw lq bi"><span id="e2e3" class="ki kj hi ln b fi lr ls l lt lu">log_img = ndimage.gaussian_laplace(gray_img, 1.4)<br/>threshold =-0.05<br/>log_final = np.zeros(log_img.shape)<br/>w,h = log_img.shape<br/>for x in range(1,w-1):<br/>    for y in range(1,h-1):<br/>        window = log_img[x-1:x+2,y-1:y+2]<br/>        point = log_img[x,y]<br/>        wmax = window.max()<br/>        wmin = window.min()<br/>        if point==0.0 and wmax&gt;0.0 and wmin&lt;0.0:<br/>            zeroCross=1<br/>        elite point&gt;0.0:<br/>            zeroCross= True if wmin&lt;0.0 else False<br/>        else:<br/>            zeroCross= True if wmin&lt;0.0 else False<br/>        if (wmax-wmin)&gt;threshold and zeroCross:<br/>            log_final[x,y] = 1</span><span id="082d" class="ki kj hi ln b fi ma ls l lt lu">plt.imshow(log_final, cmap = plt.get_cmap('gray'))<br/>plt.show()</span></pre><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es mb"><img src="../Images/d40760acf1149d8d6eedcca07c8ce4a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*gpvv5VOeWSatGndFC5dZGg.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">应用日志过滤器后</figcaption></figure><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es mb"><img src="../Images/a1fc75c5e22a44e2aa3dc51acc51e677.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*apmdLBN-rBwFYbP4dCAU-Q.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">在过零应用阈值后</figcaption></figure><h2 id="9ac3" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">边缘的质量</h2><p id="b308" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">我们可以使用三个基本的质量来评估优势的质量。对噪声、定位和精确响应具有鲁棒性。Canny边缘检测器是在牢记边缘质量的基础上开发的。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mc"><img src="../Images/a6135704339cae82fe0907c2f531e461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PksX-mrtaDCrVE0gH4fotQ.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">来源:【https://www.youtube.com/watch?v=7mEiTU-XgCo】T4&amp;list = PLD 3 hlsjsx _ imkp 68 wfkzjviptd 8 ie 5 u-9&amp;index = 3</figcaption></figure><h2 id="1754" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">Canny边缘检测器</h2><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mh"><img src="../Images/4c4ff988b54b870957c83c2a362ef118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQ6c5B-61DIL-bdstRTuRw.png"/></div></div></figure><p id="0832" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Canny边缘检测器也是从高斯滤波开始的。滤波后，图像将在X和Y方向上被区分。微分后，将计算大小和梯度矩阵。在该流水线中引入了一种称为非最大抑制(NMS)的新方法，以减少响应并使响应成为单个链。在NMS之后，我们应用一个阈值来将图像转换成二进制图像，但是我们以不同的方式实现它，以使边缘位被定位。</p><p id="8e4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你已经熟悉了微分部分，我们用一个类似于下面代码片段所示的公式来计算梯度。</p><pre class="jx jy jz ka fd lm ln lo lp aw lq bi"><span id="65ea" class="ki kj hi ln b fi lr ls l lt lu">gradient = np.degrees(np.arctan2(dy_img,dx_img)) </span></pre><p id="a559" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一条边的梯度垂直于它。如果梯度线是水平的，我们认为梯度为零。下面的图片会让你非常清楚地理解这个概念。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es mi"><img src="../Images/172e262ef5a2ab11eb444d202026a6e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MVjziljdqp8eXVTKMtsC1A.png"/></div></figure><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es mb"><img src="../Images/1ec5e7b87a50f334150ad8df73b7d28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*SraMe1HVKKbx-dLfnTjKrQ.png"/></div></figure><p id="9fbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图是用光谱颜色图绘制梯度矩阵后得到的图像。</p><p id="208f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在了解NMS之前，先看看它的实施情况</p><figure class="jx jy jz ka fd kb"><div class="bz dy l di"><div class="mj mk l"/></div></figure><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es ml"><img src="../Images/1d86c435a0e6d06692278aac6beafa53.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*QxrCVMV64dwe5rgjlbP88w.png"/></div></figure><p id="6f4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在NMS，我们循环遍历图像的每个像素，找到它的类型，如上图所示。然后，我们将考虑中的像素(白色)与补丁中的其他像素(黑色)进行比较，如上图所示。如果考虑中的像素具有更高的亮度，那么我们考虑该像素并抑制剩余的像素。现在我们得到一个单像素边缘的图像。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es mb"><img src="../Images/75fb711f03d74faa752ca2b76a7c9216.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*DA0zh24pPzGcSyKCysQ05g.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">NMS之后</figcaption></figure><p id="7527" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在滞后阈值方法中，我们保持两个阈值(低和高)。</p><p id="b662" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一个像素的强度大于这个阈值，那么我们就认为这个像素是我们图像的一部分。</p><p id="9016" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一个像素的亮度低于这个低阈值，那么我们就不认为这个像素是我们图像的一部分。</p><p id="250a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一个像素的亮度介于高阈值和低阈值之间，我们将查看它的任何相邻像素的亮度是否超过高阈值。如果结果是真的，那么我们就认为这个像素是我们图像的一部分。下图是应用滞后阈值后的图像</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es mb"><img src="../Images/02edc93a9d990b721485e89a3f474ed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*6cjn9tKGwh2oExOGHHovvw.png"/></div></figure><figure class="jx jy jz ka fd kb"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="f34e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里是我关于canny边缘检测器的特别视频，以便更好地理解它。</p><figure class="jx jy jz ka fd kb"><div class="bz dy l di"><div class="mm mk l"/></div></figure><p id="3b75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有实现的代码都在这个链接中</p><div class="jd je ez fb jf jg"><a href="https://github.com/tbharathchandra/A-Beginners-Guide-to-Computer-Vision/blob/master/Edge%20detection.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">tbharathchandra/A-计算机视觉初学者指南</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">permalink dissolve GitHub是4000多万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">github.com</p></div></div><div class="jp l"><div class="mn l jr js jt jp ju jv jg"/></div></div></a></div><p id="9dda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">offfff..是的，这个关于边缘检测的博客到此结束。请继续关注更多关于计算机视觉的内容。</p></div></div>    
</body>
</html>