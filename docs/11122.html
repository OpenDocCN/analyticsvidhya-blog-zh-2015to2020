<html>
<head>
<title>Lets Do Some Data Analysis with SQL-PostgreSQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们用SQL-PostgreSQL做一些数据分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/lets-do-some-data-analysis-with-sql-postgresql-71a861e23619?source=collection_archive---------4-----------------------#2020-11-19">https://medium.com/analytics-vidhya/lets-do-some-data-analysis-with-sql-postgresql-71a861e23619?source=collection_archive---------4-----------------------#2020-11-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8809" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将通过使用下面的表编写一些有趣的<strong class="ih hj"> SQL </strong>查询来教你如何进行数据分析，这些表是DVD_Rental数据库的一部分。</p><p id="d871" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">演员</em> ( <strong class="ih hj">演员id </strong>，名，姓)</p><p id="8903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">电影</em> ( <strong class="ih hj"> film_id </strong>，片名，描述，上映年份，语言_id，出租_时长，出租_费率，替换_费用，评级)</p><p id="bcd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">语言</em> ( <strong class="ih hj">语言_id </strong>，名称)</p><p id="0a12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">类别</em> ( <strong class="ih hj">类别id </strong>，名称)</p><p id="f303" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">f<em class="jd">ILM _ category</em>(<strong class="ih hj">film _ id，category_id </strong>)</p><p id="2b02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">f<em class="jd">ILM _ actor</em>(<strong class="ih hj">film _ id，actor_id </strong>)</p><p id="2a2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用PostgreSQL - pgAdmin，打开查询工具开始编写SQL查询。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/1a4e0fc5b983b2efc9de4d11cd6cbd3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQqAlh30q_pFpVp0KomL2w.png"/></div></div></figure><p id="a658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我准备了35个问题，涵盖了不同的主题，如分组依据、排序依据、有趣的运算符和函数、子查询、连接、子查询、聚合函数、多维数据集、汇总、先取、限制、存在、窗口函数(如lead()、lag()、first_value()、rank()、percent_rank()、partition over()等)。我将向您介绍我是如何回答这些问题的，并提供查询输出的示例。对于一些问题，我会提供不止一个解决方案。我们开始吧。</p><p id="003a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1) <strong class="ih hj">选择每个演员的名和姓。该查询将导致选择2列。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/db51da64afd601fd3e2277097fe5cccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CC4yr8x5wSdGUzPW8NpOOw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jr"><img src="../Images/f6c6dd4eaa3bfad675aa165aa25196e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQtYxXaftd-qzr9h7_PNMQ.png"/></div></div></figure><p id="b522" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2) <strong class="ih hj">选择演员的全名。该查询应该产生1列。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es js"><img src="../Images/be7432a4fd464ff0996b2cbbdc9cb3a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UehVZS8sIb10fONjEszyEQ.png"/></div></div></figure><p id="f99c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意事项</strong>:</p><p id="084e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> || </strong>是一个<strong class="ih hj">串联运算符</strong>。</p><p id="d9a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> full_name </strong>这里称为<strong class="ih hj">别名</strong>，这是我们喜欢的列命名方式。</p><p id="6ac9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在关键字<strong class="ih hj">后面写一个<strong class="ih hj">别名</strong>作为</strong>或者不写<strong class="ih hj">作为</strong>。</p><p id="2fa4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您喜欢使用带有空格的别名，请用<strong class="ih hj">双引号</strong>将它括起来</p><p id="d9e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如“全名”。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jt"><img src="../Images/5ebb1a30a8c513c021bed139963403f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7hi6xaI0D7OpL1SGDPKrg.png"/></div></div></figure><p id="a89b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择名字以“D”开头的演员。</p><p id="5a73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案1 </strong>:像操作器一样使用<strong class="ih hj">。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/0c13cedb3cab33f52932683a91561490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qNA5ZS76y6eYM5i4jiJFSw.png"/></div></div></figure><p id="d9a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">和“D%”一样，</strong>是指以“<strong class="ih hj"> D </strong>”开头的名字，后面是其他名字。</p><p id="3759" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">和“d%”一样，</strong>是指以“<strong class="ih hj"> d </strong>”开头的名称，后面是其他名称。</p><p id="2e02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">或</strong>是一个逻辑运算符，它结合了两个条件，如果两个条件中至少有一个为真，则允许选择名称。</p><p id="c9da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案2 </strong>:使用<strong class="ih hj"> ILIKE </strong>操作器</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jv"><img src="../Images/0bc4a36636437ca9291b53e7eac72f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yN4KVW7H2H5XheNyzGRkiQ.png"/></div></div></figure><p id="61a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ILIKE </strong>忽略大小写，因此它将检索名字以<strong class="ih hj"> d或D. </strong>开头的演员</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jw"><img src="../Images/b8833e790d9331ea9ae863786b776af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AztuWU8VH0XwLY0YMxRZlg.png"/></div></div></figure><p id="5d17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4)选择所有按名字升序排序的演员信息。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jx"><img src="../Images/359f40424e764f0ed569013b47c06a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iH3mzBDXK2ywhHYbDtV2RQ.png"/></div></div></figure><p id="4ccb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ORDER BY </strong>默认情况下会对结果进行升序排序。</p><p id="ea20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数出独特演员的名字</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jy"><img src="../Images/194d7f33185c432b0f1cc44c487c2082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4sJFWIUiP3x0vJ5u8jgvw.png"/></div></div></figure><p id="7486" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> DISTINCT </strong>将选择唯一的名字。</p><p id="b5eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Count </strong> (column_name)是一个聚合函数，它将计算特定列的行数。在这种情况下，它只计算唯一的名字。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jz"><img src="../Images/b9a45baf62f84521f072f8f4edc5033d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rdqBKcMvvEA37kW5XKtmzw.png"/></div></div></figure><p id="a455" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">演员表有<strong class="ih hj"> 200个演员</strong>，其中只有<strong class="ih hj"> 128个</strong>是<strong class="ih hj">唯一的</strong>名。</p><p id="ce43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看这些演员有多少个独特的全名。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ka"><img src="../Images/1c3fa4c5ef3532fb47ddd45144c86f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-1VAjs7EeI2gGqPwScyaw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kb"><img src="../Images/962cbeef6a49396921175563b7597e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F48yNqg2XN9KzDdidrG6_g.png"/></div></div></figure><p id="b8d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果是<strong class="ih hj"> 200个</strong>全名中的<strong class="ih hj"> 199个唯一全名</strong>。这意味着<strong class="ih hj"> 2个演员</strong> <strong class="ih hj">共用</strong>他们的全名。</p><p id="406c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据影片的租借期限来计算影片的数量。电影表中的租借指的是DVD可以被租借多长时间。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kc"><img src="../Images/b38490f04e1218d0233329e08de50d80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HlWf5pcR9jFPiZewLSvhsw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kd"><img src="../Images/9820f9d088c27ba43e4c09c3b7add065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tS9JWyptl15HRYhO-3gpfQ.png"/></div></div></figure><p id="37b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">203部电影的租借期限为4天，212部电影的租借期限为6天，等等。</p><p id="b652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以上，没有排序，让<strong class="ih hj">根据<strong class="ih hj">租赁_持续时间</strong>排序</strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ke"><img src="../Images/f87b6027b0cae070ec968060ecb8526f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tm_0537QNzWcWJt1pChS1w.png"/></div></div></figure><p id="679c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，排序是升序，让我们根据租赁持续时间将<strong class="ih hj">排序为</strong>，而将<strong class="ih hj">排序为降序</strong>。为了做到这一点，我们将添加关键字<strong class="ih hj"> DESC </strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kf"><img src="../Images/9a0b83716598caa8728432f3198a4620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6FSl98Sk8oLKme9ebmTYJA.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kg"><img src="../Images/2af3942b84ad05fe73eff77a68e0afaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6jSU7xAhHuGFRaz6Jh8llw.png"/></div></div></figure><p id="36ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让<strong class="ih hj">按<strong class="ih hj">计数(标题)</strong>降序排列</strong>，</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kh"><img src="../Images/fc86d914d353efbed519edf48b9181df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k24hTYStPIDTNzfnBvV4bg.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ki"><img src="../Images/015c7d54d555a26733efb3bfcfb91269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-0SYM1uADBvDXDdaRdoVA.png"/></div></div></figure><p id="437a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 7)选择最大替换成本</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kj"><img src="../Images/6e4b5b62470ee5cb1f3abe34c846da26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZuVxS6xuVbbB4yyFWJzrg.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kk"><img src="../Images/a78e05511921eef2bd371c1404621a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lykRWvqhY_Cj9RmvBAxGRQ.png"/></div></div></figure><p id="a564" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Max </strong> (column_name)是一个<strong class="ih hj">集合函数</strong>，它将为特定列选择最大值。</p><p id="e3e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择替换成本最高的电影名称。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kl"><img src="../Images/70b6947da0c871c9a3c1952e11930727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*roopUsddJAnUlW7D6-IPdw.png"/></div></div></figure><p id="05cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的查询中，选择的部分是<strong class="ih hj"> WHERE子句</strong>中的<strong class="ih hj">子查询</strong>，它将选择film表中的最大replacement_cost，我们之前发现它是29.99。然后，我们将为那些替换成本等于最大替换成本(29.99)的电影选择标题和替换成本。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es km"><img src="../Images/22941f37f7e874a338644a2795ca9755.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VS5z7Aj-7EnL23sBVpwhFw.png"/></div></div></figure><p id="330b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 9)为电影表中的电影选择唯一的不同分级。</strong></p><p id="f4ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案1 </strong>:使用<strong class="ih hj">区别</strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kn"><img src="../Images/f6d96b9647e9d4a2d80ea3bcca4e52b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*McYnMWiVspiXNwoJymX2ug.png"/></div></div></figure><p id="7f79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">方案二</strong>:使用<strong class="ih hj">由</strong>分组。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ko"><img src="../Images/c8fb0ee9281af09465f7b36fd4de3a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_5dT9cuUqFYW0yW6MDn2A.png"/></div></div></figure><p id="983d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两个查询都将显示以下结果:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/6f18bfcc15459ca60f37560a0f0b0b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JvWVX5_TZzsgPjSefRBvoA.png"/></div></div></figure><p id="5e60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 10)选择每个等级下的电影数量。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kp"><img src="../Images/c23de575448bc764ebe729adb70588bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ceE9ILhXuA-wXD-M2y-Myw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kq"><img src="../Images/9e4dd3cbd6a779288ce459c4e2b2cf73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X05jyUVmYYmIg-zBd-Th0w.png"/></div></div></figure><p id="77d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 11)将前20部电影的语言从英语改为意大利语。</strong></p><p id="4c37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">电影表中的所有电影原本都有一个l<strong class="ih hj">language_id = 1</strong>，而<strong class="ih hj"> English </strong>就是language _ id为1的语言。我会把一些电影改成意大利语的。我需要先从<strong class="ih hj">语言</strong>表中弄清楚<strong class="ih hj">语言_id </strong>和<strong class="ih hj">意大利语</strong>有什么关系。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kr"><img src="../Images/b547a3fb7d58fc46ea46324563348a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QPhT2VFqSwyZHc1z0kQCw.png"/></div></div></figure><p id="f198" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在film表中有1000部电影，现在在前面的update语句之后，该语句将所有film_id ≤ 20的电影的language_id更新为等于2(意大利语id)。英语电影数量应为980部，意大利语电影数量应为20部。让我们在下一个问题中检查一下。</p><p id="1a6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 12)选择按语言分组的电影数量</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ks"><img src="../Images/28231fe78eb4db93e427c8ffaee0d566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xqH0vHJ5HkXWNT2Jo6Vy7w.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/45184538cb28cadd522b777fc3b36c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8-OEfzRzMowSUfWkFUpUQ.png"/></div></div></figure><p id="dd8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的结果证实了我们在前一个问题中的陈述。</p><p id="018b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择大部分电影所属的语言。</p><p id="4e03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于我们在前一个问题中看到的，Language_id ( <strong class="ih hj"> 1) </strong>有980部电影，Language_id ( <strong class="ih hj"> 2 </strong>)有20部电影，所以这里的结果应该是<strong class="ih hj">英语语言</strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ku"><img src="../Images/7de6350b63bd23f32788db38451548da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHHyvwjdkKjfryDC2l0YLw.png"/></div></div></figure><p id="42af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们需要一个<strong class="ih hj">子查询</strong>，它将首先选择具有最高电影计数的language_id，这将返回<strong class="ih hj"> 1 </strong>。然后，我们选择语言名称，它的language_id与子查询检索到的id相等，应该是英语。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kv"><img src="../Images/b25539698a96f94b086fbdb168cc2403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zEuM0QOye_DcFjsXYOpvAQ.png"/></div></div></figure><p id="a527" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 13)选择电影标题、替换成本和分级，以及电影所属分级中电影的平均替换成本。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kw"><img src="../Images/7b0b712562475653ec6e7f2ab0f8abb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PhbVyFl8bHps_8LqagoLBA.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kx"><img src="../Images/5ee08cb136197e99bfd8c57bfd52dc40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*govXymQrTiPKI2J4GNxT1w.png"/></div></div></figure><p id="0a07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的查询中，我使用窗口函数<strong class="ih hj"> OVER (PARTITION BY ) </strong>来选择每个分级类别中电影的平均替换成本。因此，我将显示每部电影的标题、替换成本、评级以及该电影所属评级的平均替换成本。这很有用，这样您就可以将该电影的replacement_cost与该电影的相同分级类别中的其他电影进行比较。</p><p id="a268" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用了<strong class="ih hj"> AVG </strong> (column_name)，这是一个计算平均值的<strong class="ih hj">聚合函数</strong>。我使用了<strong class="ih hj"> ROUND() </strong>函数将结果四舍五入到<strong class="ih hj">小数点后两位。</strong></p><p id="986b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我可以通过编写以下查询获得相同的结果，其中我通过SELECT子句中的子查询获得电影评级的平均replacement_cost。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ky"><img src="../Images/6a15ea4d5f8e76c00fd5b81d7d94acfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XG-YWkn3zxOKzJLQijmslg.png"/></div></div></figure><p id="e171" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 14)选择意大利电影的收视率和平均替换成本。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kz"><img src="../Images/3b4fa7efb42469b4ba6f9338f8a98792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cWVAppTDvt_2_hV6eOtxhw.png"/></div></div></figure><p id="70bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在<strong class="ih hj"> WHERE子句</strong>中使用了一个<strong class="ih hj">子查询</strong>来从语言表中获取意大利语言id。我得到了所有的评级，并平均了意大利电影的每个评级的替换成本。</p><p id="1d23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">统计电影表中替换成本最高的电影。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es la"><img src="../Images/a6cfe0b048b53198ee2ec9bcd05fd977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qo6szoHa046yqaWXG1uUVw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lb"><img src="../Images/ec7db2ec00aeb90cd0fa637236d39efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RL6o09PbcjgmtSrnE8aNZw.png"/></div></div></figure><p id="9d44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">200部电影中有53部电影的重置成本为29.99，这是最大的重置成本。</p><p id="cd76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">统计电影表格中每种语言的电影数量。(请注意，我们只有英语和意大利语的电影)。</p><p id="af66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决方案1:使用<strong class="ih hj">内部连接。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ks"><img src="../Images/e3c22da12d07fb422c724341f7f57468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhzdPbMkz-SYOWiMAKXRaA.png"/></div></div></figure><p id="565e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> JOIN </strong>将连接两个表中具有匹配language_id的行，然后选择指定的列。因为两个表都有language_id，所以我对两个表都使用了alias(f代表电影表，l代表语言表)来区分两者。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lc"><img src="../Images/2ae0fc3cc0299fc2e1fac7256b1bc746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nkOtlGokIpsu2LuxH0fALw.png"/></div></div></figure><p id="4a6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">统计语言表中6种语言(英语、意大利语、法语、普通话、日语和德语)下的电影数量。</p><p id="43d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案1 </strong>:使用<strong class="ih hj">右连接</strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es js"><img src="../Images/839737fa9ff575a43ff1c5d1c1c78095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRgZ2UbWr4GwnhfUL489Cw.png"/></div></div></figure><p id="92ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，上面的查询将自然地连接两个表中的行，其中来自film的language_id与来自language的language _ id匹配。下一步是检查<strong class="ih hj">右侧</strong>的表中是否有任何language_id，即没有出现在连接结果中的<strong class="ih hj">语言</strong>，并将其添加到结果中。在这种情况下，语言表有<strong class="ih hj"> 3种额外语言</strong>。因此它们将被添加到结果中，并且<strong class="ih hj">计数</strong>将为<strong class="ih hj"> 0 </strong>。</p><p id="c239" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">方案二</strong>:使用<strong class="ih hj">左连接</strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ld"><img src="../Images/21e97532a1a5470f2d54829c86868b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkPaU4-EP4UQ8UPudb1E3w.png"/></div></div></figure><p id="fb62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，上面的查询将自然地连接两个表中的行，其中来自film的language_id与来自language的language _ id匹配。下一步是检查<strong class="ih hj">左边</strong>的表中是否有任何language_id，也就是没有出现在连接结果中的<strong class="ih hj">语言</strong>，并将其添加到结果中。在这种情况下，语言表有<strong class="ih hj"> 3种额外语言</strong>。因此它们将被添加到结果中，并且<strong class="ih hj">计数</strong>将为<strong class="ih hj"> 0 </strong>。</p><p id="4ab1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两种解决方案都会产生以下结果:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es le"><img src="../Images/85b3a82944245432d688aea251452699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V9O1ClP9YlbmL6aKQh3ilg.png"/></div></div></figure><p id="a19a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 18)统计按语言id和分级分组的电影数量，并按语言id升序对结果进行排序。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lf"><img src="../Images/1b1d885c2427ef8b08e5261ac3bcbe59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e9a0fYsohWrwFUVkolaU1A.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lg"><img src="../Images/3fb92adaa3263204f3f41868a70f2c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F7nOYIorBhy2QEgsKHIYjg.png"/></div></div></figure><p id="7d49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 19)选择language_id，评级，并统计每个language_id下的电影数量，汇总language_id和评级，然后按语言id排序。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lh"><img src="../Images/8a3c736c27b2358dd36048a5adcae680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onuDqWCQgaC00ZmlY0UIUA.png"/></div></div></figure><p id="3d39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的查询中，我们按language_id和rating分组，选择language_id和rating以及每个组下的电影数。<strong class="ih hj"> Rollup </strong>()然后给出额外信息，即每个language_id的总计数()，而不考虑评级。您可以在下面看到，language_id 1的movie_count是980，language_id 2的movie _ count是20。无论分级或language_id如何，电影总数(1000)也将被计算。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es li"><img src="../Images/e7a555bef914e84b03afc5ca01b66ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MfH_o8QQ3BA-c17ONvxr1Q.png"/></div></div></figure><p id="48e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下面的查询中，我在汇总后交换了列的顺序。查看以下输出有何不同。该汇总将忽略language_id并计算每个分级的总数，然后忽略两者并计算电影的总数，而不考虑它们的language_id和分级。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lj"><img src="../Images/999a77661ffab4290d066f7509096ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ApsMSbrEO_Z5AHeXQUXvNg.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lk"><img src="../Images/6d835087cac393b8ec357727bd010a19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKxwfiMlpW2Uzz_3v9RC_g.png"/></div></div></figure><p id="95ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 20)选择language_id，评分并统计每个language_id下的电影数量，然后对language_id和评分进行立方，并按语言id对结果进行排序。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ll"><img src="../Images/84229651e85d5babe5754cef0a0656b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_5sr2MHra-1bJNRr3A0rZQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lm"><img src="../Images/b8a48a1bae68e3e35f44229b1c131f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C79CjwFa-BEQ3XawJxWLEw.png"/></div></div></figure><p id="9402" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的查询中，我们按language_id和rating分组，选择language_id和rating以及每个组下的电影数。<strong class="ih hj"> Cube </strong>()要做ROLLUP()做过的事情，然后添加额外的信息。因此，它将给出每个language_id的总计数()，而不考虑评级。您可以在下面看到，language_id 1的movie_count是980，language_id 2的movie _ count是20。除此之外，<strong class="ih hj"> Cube </strong>()将提供每个分级的电影总数()，而不考虑language_id (178部电影属于“G”，210部电影属于“NC-17”，194部电影属于“PG”，223部电影属于“PG-13”，195部电影属于“R”)。<strong class="ih hj"> Cube </strong>()还将提供电影的总计数()，而不考虑language_id和等级，即电影表(1000)行中的行数。</p><p id="a882" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 21)选择电影标题、租赁价格以及租赁价格打八折的新列。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ln"><img src="../Images/b1d33359beade2f9686abf2e641e1f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d8DqxYDLv3LtXyLkrfA6aA.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lo"><img src="../Images/d43e4fcf8142e7f4aea1a4b6529bd106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSLUnmt53XmOiywc8U9n_Q.png"/></div></div></figure><p id="89f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用<strong class="ih hj"> ROUND </strong>()函数对结果进行舍入，使用<strong class="ih hj"> TRUNC </strong>()函数去除小数部分，或者使用<strong class="ih hj"> CEIL </strong>()函数返回大于等于结果的最小整数<strong class="ih hj">值</strong>。</p><p id="4453" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择标题、替换成本、等级以及该等级下的最大替换成本。</p><p id="20fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解1: </strong>得到一个评级类别下的最大重置成本。我们可以将<strong class="ih hj"> MAX() </strong>与窗口函数<strong class="ih hj">一起使用OVER PARTITION。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lp"><img src="../Images/a7ca05842a27246df76d93ef0105987b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fI27ZrpDS-t1Zzee-Jodw.png"/></div></div></figure><p id="26d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第一个解决方案中，我按照评级进行了分区，并使用<strong class="ih hj"> MAX() </strong>函数获得了最大值。</p><p id="4553" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解2 </strong>:得到一个评级类别下的最大重置成本。我们可以在分区上使用<strong class="ih hj"> first_value </strong>()和窗口函数<strong class="ih hj">。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lq"><img src="../Images/9c95c520443dcb53a398837a836b9882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J3FQa5yeXzvbL20msRcpbA.png"/></div></div></figure><p id="81d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第二个解决方案中，我按照评级进行了划分，按照替换成本降序进行了排序，并选择了将成为最大值的第一个值。所以它会给出和第一个解一样的结果。</p><p id="7e42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案3: </strong>在<strong class="ih hj">选择子句</strong>中使用<strong class="ih hj">子查询</strong>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lm"><img src="../Images/aa5ab9afc207b223cd70fcb9e3601cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7_kIuF3Dy1lHgZ1vRwm6AA.png"/></div></div></figure><p id="30f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有三种解决方案都会产生以下结果:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lr"><img src="../Images/d27d668d83d132392bff5f31f832ccf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v340iKHsHquDcDFnLVQPqA.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">结果样本</figcaption></figure><p id="61a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 23)为每部电影选择其标题、替换成本、分级以及同一分级中前一行电影的替换成本。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lw"><img src="../Images/12660ec1525d631ab68c34478119f0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FH6n_1hAULR4MqCFi1y4KQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lx"><img src="../Images/c0eec510c67a5080d54b673e9fb81e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZdxP1hONvsssYXcVU5zjXA.png"/></div></div></figure><p id="eb19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你在上面看到的，因为我们没有第一部电影的“G”评级中的<strong class="ih hj">前一部</strong>电影，所以<strong class="ih hj">延迟为零</strong>。</p><p id="8a46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">24) <strong class="ih hj">为每部电影选择其标题、替换成本、分级以及同一分级下一行中该电影的替换成本。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ly"><img src="../Images/4441caf6cd91da3e591b681f991f1efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HvUJWX9hJOrgiCPWuJ6M_Q.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/e40b4ae0ebb1d950e5c2a001435404f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TYkSDaYmoKrGCyhsREkwJw.png"/></div></div></figure><p id="7668" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你在上面看到的，因为在最后一部电影的“NC-17”评级中，我们没有在之后的<strong class="ih hj">电影，所以<strong class="ih hj">的领先优势是零</strong>。</strong></p><p id="112f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 25)将胶片表格中的行分成4个桶或4个订单组。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lf"><img src="../Images/f6135af93b323af4121a9a8e830d7956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYfd8t7JKPh661qxL4cABA.png"/></div></div></figure><p id="00f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> NTILE </strong>()将添加一列，该列将有一个值代表每一行的组号。由于我要求4组<strong class="ih hj"> NTILE </strong> (4)，NTILE列的值将从1到4。</p><p id="aeb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了查看这1000部电影是如何在四组中分配的，我做了以下工作:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ma"><img src="../Images/bd4d8bee8b88fd7d2acad02e736a6929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vnKj4rSOsrVv70pD3iHrlQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mb"><img src="../Images/6e42b59fbae328dbec074524f626f1fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jMhB5LTy6gMhau3NmFbLCg.png"/></div></div></figure><p id="1d07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 26)为每部电影选择其标题、租赁费率以及由language_id划分的下两行的租赁费率。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/a38d64056cc59a5189014a98fa0f1623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tk5jpu9A2HsXspjGtwoAzQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es md"><img src="../Images/58d656b8b06901cf743ecc5cd5c82e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oVzWejd3MrWlDKfhsrk2FA.png"/></div></div></figure><p id="dd6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于在查询中我们要求2个行的<strong class="ih hj">领先，最后两个<strong class="ih hj">行</strong>有一个<strong class="ih hj">空</strong>滞后，因为在它们</strong>之后没有可用的2行<strong class="ih hj">。</strong></p><p id="e845" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 27)为每部电影选择其标题、租赁费率以及由language_id划分的前两行的租赁费率。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es me"><img src="../Images/094032e8077bfaf5c9050a5ba88c96fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0vFLr_RuEGwOGGNikCnow.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mf"><img src="../Images/9dfe6d7c646bfe4216c99697b40023c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVcEgj9rskZOd2N4KPbUUQ.png"/></div></div></figure><p id="9151" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于在查询中我们要求2行的领先，前两行<strong class="ih hj">有一个<strong class="ih hj"> null </strong>滞后，因为在它们的</strong>之前没有2行可用。</p><p id="0eff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 28)按评分显示排名，并按rental_rate排序结果。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mg"><img src="../Images/5c8d17e40bc717be8319c9095c30e7f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpCRn6F0IlZvNbeP0f2Nbg.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mh"><img src="../Images/3670be412c8e92d652baabe02aec5f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LCe4iWMx_s8n8RBZG0E0qg.png"/></div></div></figure><p id="5714" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">前55部电影的租赁费率为4.99，因此所有55部电影将具有相同的等级，等于<strong class="ih hj"> 1 </strong>，电影56具有不同的租赁费率2.99，因此等级从<strong class="ih hj"> 56 </strong>开始，以补偿所有共享相同等级1的前55部电影。</p><p id="5b1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 29)按评级显示百分比排名，按替换成本排序结果。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mi"><img src="../Images/cb4b9ce14b696bf7521f8650e94bfb23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QGBOF3uhYi5Hqjv8sw2WXg.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es md"><img src="../Images/72f0331ed2fcddca8907bd3a40737e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vAsoGJ6BGPdxMU0uX7ri_A.png"/></div></div></figure><p id="9054" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面给出的是百分比等级而不是等级<strong class="ih hj">。</strong></p><p id="25d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 30)使用with语句创建“temp_table”表，该表包含标题以“B”或“B”开头的所有电影。然后从“临时表”中选择所有信息。</strong></p><p id="3b8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本例中，您将看到带有语句的<strong class="ih hj">，语句<strong class="ih hj"> ILIKE </strong>将允许我们选择以b开头的标题，而不考虑其大小写(大写或小写)。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mj"><img src="../Images/7d516c3c02c8a9f7c39ece9dbd861b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4o_1J2tZE7VAyb2G46Rkw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mk"><img src="../Images/ba54799124d70b1537b964964bb66802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRyJVnRv1hYkPzGad1QscQ.png"/></div></div></figure><p id="8689" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择除“PG-13”或“G”级之外的所有电影。</p><p id="5f40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案1 </strong>:使用<strong class="ih hj">成员运算符(NOT IN) </strong>并列出您想要从结果中排除的评级。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kw"><img src="../Images/1d0527dd2b906363fc2c1ce0637307fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZtqAwQ193E34BO3Y8vnZg.png"/></div></div></figure><p id="87b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案2 </strong>:使用<strong class="ih hj">隶属操作符(IN) </strong>并列出您想要包含在结果中的评级。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lg"><img src="../Images/0e71d6218b2cf9d2eef89a0c259cd183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48I4R0EsRnIaSwbmAqkBlA.png"/></div></div></figure><p id="1fde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案3 </strong>:使用<strong class="ih hj">不等于(&lt; &gt;)运算符</strong>，并列出您想要从结果中排除的评分。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lq"><img src="../Images/f28acc5f068596197989ed3e2c92b1b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvx9wa_yJDa_BS7SMI7TbA.png"/></div></div></figure><p id="4113" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案4 </strong>:使用<strong class="ih hj">等号(=)运算符</strong>，并列出您想要包含在结果中的评分。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ml"><img src="../Images/9fbbdaecb76d1de15ae70d2b03dbbaa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJ1OpYKdYIOhBU9mjt38Zw.png"/></div></div></figure><p id="930e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从1到20中选择actor_id为的演员。</p><p id="9ef0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案1 </strong>:使用操作器之间的<strong class="ih hj">。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jz"><img src="../Images/999facadaab067e9ae6837c9d7ba23ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Q0Uyfc_USOOwa_Es4f3aw.png"/></div></div></figure><p id="3958" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案2 </strong>:使用<strong class="ih hj">比较运算符</strong> ≥ and ≤。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mm"><img src="../Images/a981a07bdc74cdecd2ed176dfa8947af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p8l8_f-KMI3Mbj-YStlM6w.png"/></div></div></figure><p id="cd6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 33)选择超过5个字母的演员的名字。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/5f873f0d9d630404725ef934edbbddfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJfMUvNeg46s0jh6TPRL7Q.png"/></div></div></figure><p id="8744" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">长度</strong>()会统计字符数。</p><p id="5317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 34)选择语言标识和语言名称，这些语言标识在电影表中包含电影。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mn"><img src="../Images/cb5f73733142600c875683d0f9bb45be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bAs4jPH8RksI9ChdKOnIsQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mo"><img src="../Images/d8d7045bfd4c464098a92c37ff367eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JSUnJQCiLWoYh-3gCBTYvA.png"/></div></div></figure><p id="1b2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的查询中，如果子查询(SELECT * FROM film f，其中l.language_id = f.language_id)的结果意味着存在<strong class="ih hj"/>将评估为<strong class="ih hj"> true </strong>和<strong class="ih hj"> language_id，将返回name。</strong></p><p id="a81d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是该查询的另一种解决方案:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mp"><img src="../Images/521ae2f46b207990ce2617aa52df9fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kkF0vy8-46k4SS9VAYeN3A.png"/></div></div></figure><p id="9597" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择演员表中的前5行。</p><p id="be5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决方案1:使用极限。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mq"><img src="../Images/34b88744d1d6265e6d11c1d99dbd7292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFF1eLA3nsZnEmwwtdHaTw.png"/></div></div></figure><p id="8732" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决方案2:首先使用FETCH。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mr"><img src="../Images/ade95de4606076a3ac2da038a75d6ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pTqsgf2i9POOlwhUEFgmdQ.png"/></div></div></figure><p id="7edf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两种解决方案都将获得actor_id从1到5的前五个actor。</p><p id="9f02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你对这篇文章感兴趣，并且我能够以一种好的和清晰的方式展示这个主题。</p></div></div>    
</body>
</html>