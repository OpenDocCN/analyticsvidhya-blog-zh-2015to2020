<html>
<head>
<title>Understanding Logistic regression.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解逻辑回归。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-logistic-regression-573a65d6c20?source=collection_archive---------10-----------------------#2020-02-04">https://medium.com/analytics-vidhya/understanding-logistic-regression-573a65d6c20?source=collection_archive---------10-----------------------#2020-02-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if"><p id="a2dc" class="ig ih hi bd ii ij ik il im in io ip dx translated">它不是数据科学。我称之为“数据感”。从数据中发现意义是数据科学。</p></blockquote><p id="f728" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ip hb bi translated"><strong class="is hj">简介:</strong></p><p id="04c1" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">逻辑“回归”？那么，它属于监督学习回归吗？它只对连续值有效吗？线性回归和logistic回归有什么区别？两次回归相同吗？</p><blockquote class="js jt ju"><p id="3929" class="iq ir jv is b it jn iv iw ix jo iz ja jw jp jd je jx jq jh ji jy jr jl jm ip hb bi translated">要么你有和上面提到的一样的问题，要么你觉得那些问题其实是对的，那你就完全错了。</p></blockquote><p id="7ffd" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">让我们看看什么是真正的逻辑回归，我们将逐一回答上述所有问题，我们将建立一个公开信用数据集的逻辑回归模型。</p><p id="ca91" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">首先，让我们弄清楚两件事:</p><ol class=""><li id="d95a" class="jz ka hi is b it jn ix jo jb kb jf kc jj kd ip ke kf kg kh bi translated">当目标变量是连续或离散的，我们使用线性回归。</li><li id="ef43" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">当目标变量是分类/二元时，我们使用逻辑回归。</li></ol><p id="fca8" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">因此，用基本的外行话来说，当目标列是二进制时，就使用逻辑回归。一些例子将是:在一组贷款申请人中，如果一个人得到他的贷款或没有；如果有这款手机，你会买还是不买可以是另一个例子；一只股票会涨还是会跌？一个人是否有某种疾病？算几个例子。</p><blockquote class="js jt ju"><p id="f41e" class="iq ir jv is b it jn iv iw ix jo iz ja jw jp jd je jx jq jh ji jy jr jl jm ip hb bi translated">从技术上和理论上讲，逻辑回归是一种分析数据集的统计方法，其中有一个以上的独立变量帮助确定一个结果，而只有两个可能的结果。</p></blockquote><p id="c4a2" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">虽然，当有两个以上的可能结果时，有一个多类逻辑回归可以应用，关于这一点我们将在文章中进一步讨论。</p><p id="65c0" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">逻辑回归的目标是找到描述因变量和一组自变量之间关系的最佳拟合模型。我们尝试用概率来预测二元反应:Y =成功或失败(1或0)。</p><h1 id="99d6" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">逻辑回归中涉及的假设:</h1><ol class=""><li id="d89e" class="jz ka hi is b it ll ix lm jb ln jf lo jj lp ip ke kf kg kh bi translated">二元逻辑回归要求目标变量是二元的。</li><li id="d968" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">逻辑回归要求观察值相互独立。换句话说，观察值不应来自重复测量。</li><li id="9b1d" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">逻辑回归要求自变量之间很少或没有多重共线性。</li><li id="60b7" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">逻辑回归假设独立变量和对数比值呈线性。</li><li id="072b" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">逻辑回归通常需要大样本量。</li></ol><p id="db05" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated"><strong class="is hj">乙状结肠功能:</strong></p><p id="b81c" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">如上文假设中所述，逻辑回归假设一个线性方程，其中包含独立变量和对数比值来预测一个值。预测值可以位于-∞到+∞范围内的任何位置；但是输出需要是二进制的，即0或1。为了得到0或1的值，我们使用“S <em class="jv"> igmoid函数</em>”。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lq"><img src="../Images/68b93cedb6be43725966f99ebbdca4e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NloTSPs4pCMYDZ8G1kxhoQ.png"/></div></div></figure><p id="ff09" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">Sigmoid函数的公式如下:</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es mc"><img src="../Images/94b8bd44bd6db069a08460d005fbe5ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*ZBpFh1vvobm0UBPpmQnKtA.png"/></div><figcaption class="md me et er es mf mg bd b be z dx translated">图片来源:<a class="ae mh" href="https://www.data-mania.com/blog/logistic-regression-example-in-python/" rel="noopener ugc nofollow" target="_blank">https://www . data-mania . com/blog/logistic-regression-example-in-python/</a></figcaption></figure><p id="e4f5" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">现在，让我们导入数据集，看看数据集的头部。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mi"><img src="../Images/6e45b641d9def2be71d562e06e82e9e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_Ci4JRWUQaiT8FdJf3CXg.png"/></div></div></figure><p id="2b01" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">这是一个“德国信用”数据集。现在让我们在这个数据集上建立一个逻辑回归模型，其中creditability列是目标列。我们将从stats models library中导入GLM，其中GLM代表广义线性模型，我们将使用该模型对信用数据建立逻辑回归模型。</p><blockquote class="js jt ju"><p id="08f1" class="iq ir jv is b it jn iv iw ix jo iz ja jw jp jd je jx jq jh ji jy jr jl jm ip hb bi translated">在高层次上，多类逻辑回归以这样一种方式工作，即它将多类分成二进制。即，如果我们在目标变量中有3个类1、2、3，多类逻辑回归假设类1为0，类2和3为1，然后它意味着重复相同的过程，直到所有类都被覆盖。</p></blockquote><blockquote class="if"><p id="a903" class="ig ih hi bd ii ij ik il im in io ip dx translated">用统计数据撒谎很容易，但没有统计数据就很难讲真话。</p></blockquote><p id="28fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ip hb bi translated">首先，我们将使用sm.glm构建一个模型，并拟合我们的X和y，然后打印模型的摘要。然后，使用我们从数据中获得的结果，我们根据p值选择列(p值大于0.5的任何特征都可以排除，小于0.5的可以使用)。因此，使用这些结果，我们选择特征，然后将数据分成相应的训练和测试，然后在剩余数据上从sklearn构建逻辑回归模型，并获得所需的输出。</p><p id="9832" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">让我们来看看所有这些是如何完成的。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mj"><img src="../Images/5d9cb3ee8cc1f64017159f1116247c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jaWyC3jSrrg9cVKzu1D7Hg.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">这是一个广义线性模型回归结果，我们将检查P&gt;|z|列的P值。</figcaption></figure><p id="1c7c" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">现在我们已经得到了结果，我们检查p值是否大于0.5，并删除列，保留p值小于0.5的列。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mk"><img src="../Images/0d0fcbda534ff74e5ade19e8ea052f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LS_xIIHAogAj4xqYK5_hag.png"/></div></div></figure><p id="1f53" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">因此，我们将数据分为X和y(使用p值小于0.5的列)，然后将数据分为X_train、X_test、y_train、y_test，然后使用sklearn.liear_model的LogisticRegression构建模型。后来，我们在火车上拟合了模型，然后使用X检验进行了预测。</p><p id="e759" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">现在，让我们通过绘制混淆矩阵来检查准确性和剩余的度量。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es ml"><img src="../Images/1de4d12898ac0083d7d8b05eee044d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*c9TkjKDX2VjIyRXPGwokvw.png"/></div></figure><p id="1dfa" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">现在我们将计算假阳性率fpr和真阳性率tpr，用于我们通过绘制ROC曲线建立的模型。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es mm"><img src="../Images/8c1eed6c01b8fc8d1d6973dc1913a5cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*_8aIhuQvZSQcRHLp4R9CmQ.png"/></div></figure><p id="2c6b" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">在“受试者工作特征(ROC)曲线”中，真阳性率(灵敏度)被绘制成不同截止点的假阳性率(100特异性)的函数。“ROC曲线”上的每个点代表对应于特定决策阈值的灵敏度/特异性对。</p><blockquote class="if"><p id="dc63" class="ig ih hi bd ii ij mn mo mp mq mr ip dx translated">自学很重要。你自学有巨大的价值。如果有人教你，你只能从一个角度学习，但是自学的时候，你可以学到很多其他的东西。即使你正在学习一门课程，也要留出一些时间，从其他来源进行自学。</p></blockquote><blockquote class="js jt ju"><p id="27e3" class="iq ir jv is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm ip hb bi translated">希望你在读的时候学到了一些东西，就像我在写的时候学到的一样。</p></blockquote><p id="eb65" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">即将发布的文章:</p><ol class=""><li id="0b30" class="jz ka hi is b it jn ix jo jb kb jf kc jj kd ip ke kf kg kh bi translated">主题建模。</li><li id="8396" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">文本摘要。</li><li id="4e3d" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">从pdf和图像中提取文本。</li><li id="5393" class="jz ka hi is b it ki ix kj jb kk jf kl jj km ip ke kf kg kh bi translated">k-最近邻算法。</li></ol><p id="f124" class="pw-post-body-paragraph iq ir hi is b it jn iv iw ix jo iz ja jb jp jd je jf jq jh ji jj jr jl jm ip hb bi translated">希望在接下来的文章中也能看到你们。祝你过得愉快。谢谢你。</p></div></div>    
</body>
</html>