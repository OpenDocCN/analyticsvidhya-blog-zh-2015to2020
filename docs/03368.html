<html>
<head>
<title>Image Text Recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像文本识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-text-recognition-738a368368f5?source=collection_archive---------2-----------------------#2020-01-28">https://medium.com/analytics-vidhya/image-text-recognition-738a368368f5?source=collection_archive---------2-----------------------#2020-01-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="b42d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用深度学习并在云中部署模型</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/6dc3b2ced9f80175c58277aa30c07c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*PbfZ3ac5sWiKTPVf6R3WFg.jpeg"/></div></figure><p id="b946" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在计算机视觉领域，从图像中读取或识别文本是一项具有挑战性的任务。这主要是因为图像中的文本表现出多样性和可变性。图像的背景实际上是不可预测的，因为一些图像可能具有深色背景，一些图像可能具有浅色背景，并且甚至存在图像字体和背景具有相同颜色并且具有将文本与背景区分开的小轮廓的情况。图像中可能会出现不同字体、方向和不同长度的文本模式。图像中的文字也可能模糊或扭曲</p><p id="be38" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><em class="kb">那么，有没有一种方法可以克服这些挑战，并提出一种解决方案，能够在各种图像中以良好的准确度识别文本？</em></p></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="6fde" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">眼前的问题</h1><p id="a634" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">给定一个输入图像，我们需要以大于80%的合理准确度(与实际文本标签精确匹配)预测图像中的文本，并且应该具有良好的字母匹配准确度。</p><p id="52fb" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">你说这很好，有什么限制吗？是的，有。</p><ul class=""><li id="663c" class="lg lh hi jh b ji jj jl jm jo li js lj jw lk ka ll lm ln lo bi translated">这里有一个<strong class="jh hj">低延迟</strong>要求的意思，给定一张图片，模型应该能够快速预测文本</li><li id="e6a7" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka ll lm ln lo bi translated">从带有可变长度标签/单词的图像中预测文本</li></ul><h1 id="1940" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">性能指标</h1><p id="e21d" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">那么现在我们如何评估我们模型的性能呢？想一想。</p><p id="bfca" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">明白了吗？是的，<strong class="jh hj">精度</strong>是评价模型的主要指标之一。此外，该模型还可以根据其他指标进行评估，如下所示:</p><ul class=""><li id="c1d5" class="lg lh hi jh b ji jj jl jm jo li js lj jw lk ka ll lm ln lo bi translated">字母准确性</li><li id="587d" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka ll lm ln lo bi translated">CTC损失</li></ul><p id="7bd9" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这个CTC是什么，什么意思？我过一会儿会回到这个话题，在那之前请继续阅读。</p><h1 id="b2d8" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">资料组</h1><p id="0060" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">这道题用的数据集是<a class="ae lz" href="https://www.robots.ox.ac.uk/~vgg/data/text/" rel="noopener ugc nofollow" target="_blank"> <strong class="jh hj"> MJ合成词数据集</strong> </a> <strong class="jh hj">。</strong>数据集由9百万幅灰度图像组成，覆盖9万个英文单词。它有三个文本文件annotation_train.txt、annotation_val.txt和annotation_test.txt，其中包含图像列表及其文件名中相应的文本标签。下面是train_annotation文本文件中的值的小图片:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ma"><img src="../Images/63ff456c1c9ea18a2b7f2f93ca6c0f48.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*jxCU3lMYdIX-vMN7XjxTfw.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated"><strong class="bd kl">图1 </strong>:图像是从<a class="ae lz" href="https://www.robots.ox.ac.uk/~vgg/data/text/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kl"> MJ合成词数据集</strong> </a>下载的一段数据</figcaption></figure><p id="6ece" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了解决这个问题，我从Train中抽取了200000幅图像，从Validation中抽取了12000幅图像，从标签长度在4到12之间的测试注释文件中抽取了15000幅图像，并将它们存储在三个独立的文件夹中(Train_data、Val_Data、Test_Data)。</p><h1 id="77a0" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated"><strong class="ak">资料准备</strong></h1><p id="f37c" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">在将图像存储在上述文件夹中后，我从图像文件中提取图像中包含的文本标签，并将字母转换为所有的大写字母。然后，我创建了一个csv文件，其中包含图像文件名及其在图像中对应的文本标签。让我们看看它是什么样子的</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mf"><img src="../Images/8a6f3acf25824fcb9a150becdab3f061.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*nfHul5CNCh2gSN_QWJUEYA.jpeg"/></div></figure><p id="6c9f" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我已经为Val_data，Test_Data文件夹中的图像创建了类似的文件。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/def5c060054f959e3ecfa5fdc89c7093.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*UlYCZeUypiUaoIiVmdCuuw.jpeg"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mg"><img src="../Images/e4a55ec6f7be15a95035f910f0dface0.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*p3HLKMGo4380r9iVpSvssw.jpeg"/></div></figure><p id="f769" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我想分析这些文件夹中图像的宽度和高度，以便在不丢失任何数据的情况下相应地调整它们的大小，并根据调整后的图像训练我的模型。为此，我使用Open CV处理了这些文件夹中的每个图像，提取了每个图像的宽度和高度，并将其与图像名称一起存储在一个csv文件中。我创建的文件如下所示</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mh"><img src="../Images/b8234b1e7c758d73297b11290c28f697.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*MkNVXoxG6StQyLsdciYPEA.jpeg"/></div></figure><p id="f7a5" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我已经在本节中简要介绍了我如何准备数据以开始解决问题，有关我如何处理和准备数据的更详细代码，请随时查看我在GitHub库  <strong class="jh hj">中的<a class="ae lz" href="https://github.com/AbhishekKarthik/ImageTextRecognition" rel="noopener ugc nofollow" target="_blank"> <strong class="jh hj">代码。</strong></a></strong></p><h1 id="f43e" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">数据分析</h1><p id="e301" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated"><strong class="jh hj">图像高度和宽度分析</strong></p><p id="94de" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">请注意，我们将仅分析列车图像的图像大小(图像的高度和宽度)数据，并仅根据我们对列车图像大小的分析结果调整图像大小，以避免任何形式的数据泄漏。现在我们已经准备好了图像大小数据，让我们探索看看我们会发现什么！</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mi"><img src="../Images/d2fedc6c984143b5ff0ac197f9d8d651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLAsk2xqiCAuwduVUeY1xQ.jpeg"/></div></div></figure><p id="a5f1" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">从CDF图中，我们可以看到大多数图像的高度在30到32之间。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mn"><img src="../Images/86bc5e1982d830b0c2f66653b06a5dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a4qYjyM6nAWg4vKOubh8KA.jpeg"/></div></div></figure><p id="b9c7" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">看一下图像宽度的CDF图，我们会发现几乎95%的图像宽度为200或更小。</p><pre class="iy iz ja jb fd mo mp mq mr aw ms bi"><span id="4e78" class="mt kk hi mp b fi mu mv l mw mx">print("Train Images Height 90 percentile :",np.percentile(train_img_size['Height'].values,90))<br/>print("Train Images Height 99 percentile :",np.percentile(train_img_size['Height'].values,99))<br/>print("Train Images Width 90 percentile :",np.percentile(train_img_size['Width'].values,90))<br/>print("Train Images Width 99 percentile :",np.percentile(train_img_size['Width'].values,99))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es my"><img src="../Images/be9c410cb256f3cae76b6c0c741e1da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*lf_-ZjqNPXmWgHU4s8BBDg.jpeg"/></div></figure><p id="f0c6" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">图像高度的第90和第99百分位值没有太大差别。图像宽度的第90和第99百分位值有相当大的差异。让我们仔细看看从第90%到第99%的图像宽度值。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mz"><img src="../Images/f3ca8d1c125043024458c3ea7d8c2797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iqy2DXfrt-RYeOm7SyexfQ.jpeg"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es na"><img src="../Images/76f5a40d403dd4981c613a1102368bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*iiAosvK1rial8bcSuso60g.jpeg"/></div></figure><p id="0e9e" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">从上面我们可以看到，第90和第99百分位之间的图像宽度存在差异。我们可以说，大多数图像的宽度为170，这是第91百分位值。很少有图像的宽度超过200。</p><p id="6987" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">来自图像宽度和高度分析的见解</strong></p><ol class=""><li id="f775" class="lg lh hi jh b ji jj jl jm jo li js lj jw lk ka nb lm ln lo bi translated">大多数图片的高度在31到32之间。</li><li id="af91" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated">几乎90%的图像宽度为170。</li><li id="0b9d" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated">基于这些见解，我们可以将图像调整到32(高)X 170(宽)的尺寸。</li></ol><p id="dea6" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">文本标签分析</strong></p><p id="ad47" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">给定包含文本的输入图像，文本标签是我们的模型预测的输出。标签的长度在这个问题中起着重要的作用，我们有长度在4到12之间的标签。这为探索列车数据中标签的长度提供了一个有趣的案例。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es nc"><img src="../Images/b628f0e424d3d1b13601a626cccf3f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziS-1DBz9W8aWnmwfvpAsw.jpeg"/></div></div></figure><p id="dc5e" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">标签长度的PDF图很好地展示了标签长度在数据中的分布情况。正如我们所见，大多数标签的长度为7、8、9、10。长度为4，5的标签较少。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es nd"><img src="../Images/9f44c322f1960469ce0f9cd9eaac8942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_A5LIH_KMkGEOjMVJ1wwA.jpeg"/></div></div></figure><p id="bd20" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">从CDF图中我们可以看到，长度为4，5的标签所占比例非常小，接近10%。几乎80%的数据的标签长度为10或更少。</p><pre class="iy iz ja jb fd mo mp mq mr aw ms bi"><span id="b4dc" class="mt kk hi mp b fi mu mv l mw mx">def digit_count(labels,size):<br/>    """<br/>    Takes the list of labels and counts the number of labels with and without digits<br/>    and prints its percentage<br/>    """<br/>    present=0<br/>    absent=0<br/>    for i in labels:<br/>        pres=hasDigits(i)<br/>        if pres==True:<br/>            present+=1<br/>        else:<br/>            absent+=1<br/>    present_percent=(present/size)*100<br/>    absent_percent=(absent/size)*100<br/>    print('Labels with Digits: ',present_percent,' %')<br/>    print('Labels without Digits: ',absent_percent,' %')</span><span id="c86e" class="mt kk hi mp b fi ne mv l mw mx">train_labels=[str(x) for x in train_data['Labels'].values]<br/>digit_count(train_labels,len(train_labels))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nf"><img src="../Images/43551170d73d2e0b616a1229bfd7033b.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*QJ55PgWyCl1F7EHFTB3aPA.jpeg"/></div></figure><p id="d540" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在检查我们的文本标签中是否存在数字时，观察到训练数据中几乎所有的标签都不存在数字，并且很少有标签存在数字，但是它们的数量较少。</p><h1 id="0668" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated"><strong class="ak">进场概述</strong></h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ng"><img src="../Images/843c0d6a7072b185951befb02da6139f.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*iDRh0B85zd3Bp_MlcWRZ4w.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">图片来源:<a class="ae lz" href="https://arxiv.org/pdf/1507.05717.pdf" rel="noopener ugc nofollow" target="_blank">T3】CRNN研究论文T5】</a></figcaption></figure><p id="8a2d" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">用于该问题的模型被称为卷积递归神经网络(CRNN ),因为它结合了深度卷积神经网络(DCNN)和RNN，后者构建了用于序列识别的端到端系统。该模型由三个部分组成，包括卷积层、递归层和转录层。卷积层自动从每个输入图像中提取特征序列。在卷积网络之上，建立递归网络，用于对由卷积层输出的特征序列的每一帧进行预测。CRNN顶部的转录层用于将递归层的每帧预测翻译成标签序列。虽然CRNN由不同类型的网络结构(DCNN和RNN)组成，但它可以用一个损失函数进行联合训练。</p><p id="69e1" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">使用CNN提取图像特征</strong></p><p id="ed52" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在CRNN模型中，卷积层由卷积层和最大池层构成。这种组件用于从输入图像中提取连续特征表示。</p><p id="7292" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">使用RNN的序列标记</strong></p><p id="4859" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">深度双向递归神经网络建立在卷积层的顶部，作为递归层。循环层预测特征序列x =x1中每个帧xt的标签分布yt；… ;xT。我们在这里使用双向RNN，因为观察到在基于图像的序列中，来自两个方向的上下文都是有用的并且彼此互补。</p><p id="4511" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">转录</strong></p><p id="d236" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">转录是将RNN做出的每帧预测转换成标签序列的过程。我们将在转录过程中使用连接主义时态分类(CTC)来解码RNN的输出，并将其转换为文本标签。现在让我们讨论一下连接主义者的时间分类。</p><p id="bc3c" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">连接主义时间分类(CTC) </strong></p><p id="f38c" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">序列标注问题由输入序列<em class="kb">X</em>=【<em class="kb">X</em>1、<em class="kb"> x </em> 2、..、<em class="kb"> xT </em>及其对应的输出序列<em class="kb"> Y </em> =[ <em class="kb"> y </em> 1、<em class="kb"> y </em> 2、…、<em class="kb"> yU </em>。在这个问题中，我们需要找到从X到Y的精确映射，但这有几个问题，即<em class="kb"> X </em>和<em class="kb"> Y </em>的长度可能不同，我们没有X和Y的精确对齐(元素的对应)。CTC算法克服了这些挑战。对于给定的X，它给出了所有可能的Y的输出分布。我们可以使用这种分布来<em class="kb">推断</em>一个可能的产量，或者评估一个给定产量的<em class="kb">概率</em>。在这一节中，我试图简单地解释CTC，你可以在这篇写得很好的文章<a class="ae lz" href="https://towardsdatascience.com/intuitively-understanding-connectionist-temporal-classification-3797e43a86c" rel="noopener" target="_blank"><strong class="jh hj"/></a><strong class="jh hj"/>和这篇博客<a class="ae lz" href="https://distill.pub/2017/ctc/" rel="noopener ugc nofollow" target="_blank"> <strong class="jh hj">中阅读更多关于CTC的内容，这有助于我理解连接主义的时间分类及其细节。</strong></a></p><h1 id="d2d2" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated"><strong class="ak">建模</strong></h1><p id="7adb" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">我在相同的数据上训练了两个CRNN模型，看看这两个模型中哪一个给出的结果更好。</p><ul class=""><li id="39c2" class="lg lh hi jh b ji jj jl jm jo li js lj jw lk ka ll lm ln lo bi translated"><strong class="jh hj">模型1: </strong>使用CNN，使用Adam优化器训练RNN的双向LSTM。</li><li id="8f81" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka ll lm ln lo bi translated"><strong class="jh hj">模型2: </strong>使用CNN，在RAdam optimizer上训练的RNN双向GRU。修正亚当(RAdam)是最新的人工智能优化器。你可以在这篇解释优化器的<a class="ae lz" rel="noopener" href="/@lessw/new-state-of-the-art-ai-optimizer-rectified-adam-radam-5d854730807b">中型文章</a>中读到关于RAdam的内容。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nh"><img src="../Images/f2d2702896debf54fbf5d535f6d653ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*BRBZSfsuDLv0A9Gno53tMQ.jpeg"/></div></figure><p id="a897" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这些是我认为出现在我的文本标签中的字母，包括数字形式0-9以及常规字母。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es ni"><img src="../Images/ba9c45ee0029000baee62d57805d00f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bW3W6UmsMkofDAqz_XRuQA.jpeg"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">模型参数</figcaption></figure><p id="90f7" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">型号1 </strong></p><p id="0e27" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">模型架构有两个阶段:</p><ol class=""><li id="612e" class="lg lh hi jh b ji jj jl jm jo li js lj jw lk ka nb lm ln lo bi translated"><strong class="jh hj">训练阶段:</strong>获取输入图像、文本标签(编码为整数)、输入长度(时间步长)、标签长度并输出CTC损失</li><li id="c277" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated"><strong class="jh hj">预测阶段:</strong>获取输入图像并输出尺寸为42×37的矩阵，其中42是RNN的时间步数，37是字母的长度+ 1个ctc空白字符</li></ol><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nj nk l"/></div></figure><p id="e8ec" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在200000幅图像上训练模型1，并在12000幅图像上验证20个时期，并提前停止。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es nl"><img src="../Images/37f803a4fd9737cd78195f2ec554490b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOjjxV5dyn-2VX-a9dojIw.jpeg"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es nm"><img src="../Images/d51ce715204995de1a9ba540089d4db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jYSiBuVSefXogYDQhqSYw.jpeg"/></div></div></figure><p id="031b" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">该模型在这之后又训练了两个时期，并且val_loss没有改善，所以它在时期14停止。我在早期停止回调中使用了恢复最佳权重，因此它恢复了纪元12的权重。我保存了这个最佳模型的重量。</p><p id="6c61" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">可视化模型的训练和验证损失。让我们看看张量板图</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nn"><img src="../Images/ece07259277c5c616988a4c255f12e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*Xg-YryC6asYyjhkc5SH40Q.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">模型1列车损失图</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es no"><img src="../Images/73528437fb0df8b25bd6724a86c83b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*WljT8jUnrVWWirrvJcOT8A.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">模型1验证损失图</figcaption></figure><p id="8084" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">模型2 </strong></p><p id="9880" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">模型2体系结构具有类似于模型1的训练和预测阶段。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nj nk l"/></div></figure><p id="8a7c" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在与模型1相同的一组图像上训练模型2 20个时期，并提前停止。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es np"><img src="../Images/1814f0dc079aab5551754d32b65ab6f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QDe3h88SY3PhFcXSdHN4-g.jpeg"/></div></div></figure><p id="91a9" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">该模型训练了8个时期，并在val_loss没有改善时停止进一步训练。我恢复了最好的模型重量并保存了它们。</p><p id="cfdc" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">让我们看看模型2的张量板图</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nq"><img src="../Images/03aaf3690780641525843a1d81d75aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*JGEFOw5wYDpz_Rxplj3kMg.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">模型2列车损失图</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mf"><img src="../Images/6a657692a62c001533d57c5571f06a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*jv5sSkxi5ARpTmowSsse8w.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">模型2验证损失图</figcaption></figure><h1 id="e3ad" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">结果</h1><p id="d121" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">我使用保存的模型预测了15000张测试图像的文本标签，并计算了准确度和字母准确度。我有一个柱状图，显示了预测文本标签和实际文本标签之间有0，1，2，3，4个字符不匹配的测试图像的百分比。</p><p id="6f06" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">模型1结果</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nr"><img src="../Images/e37897da1427052f20770677dfce70eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*grfq_GHiNlxlSb3M8VW0lQ.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">测试数据图像的模型1结果</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es ns"><img src="../Images/9a303ae1c2bfa3e7f24a9b92b2f67ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Mf4FLt13CPfrDrsdN_JxA.jpeg"/></div></div></figure><p id="7e89" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">模型2结果</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nt"><img src="../Images/b50fc25ba67e3fe1a7f06c5aca3f7b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*jtiDB1ot7_NuzT2Is7J2VQ.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">测试数据图像的模型2结果</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es nu"><img src="../Images/ba2f2cd9fb7f9a6f93e68465ad418ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUSey0SzZFi2y8vu_WMsng.jpeg"/></div></div></figure><h1 id="9566" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">摘要</h1><p id="795d" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">让我们看一下两个模型在测试数据图像上的结果总结。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es nv"><img src="../Images/c8517a07139b5436a25cf4e7ed9a346a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iB8UmckOE8Snhe4Oz-tECw.jpeg"/></div></div></figure><p id="5cd3" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在这两个模型中，模型1的结果更好。</p><h1 id="b879" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated"><strong class="ak">结论</strong></h1><ol class=""><li id="e576" class="lg lh hi jh b ji lb jl lc jo nw js nx jw ny ka nb lm ln lo bi translated">在来自Synth Text Images的200000幅图像上训练的模型1在看不见的15000幅可变长度标签的测试图像上表现得相当好，准确率约为88%,字母准确率约为94%。</li><li id="ecbb" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated">同样在200000幅图像上训练的模型2在15000幅可变长度标签的测试图像上具有大约82%的准确度和大约93%的字母准确度。</li></ol><h1 id="9c26" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">图像的模型预测</h1><p id="5f9d" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">我采用了模型1，它在测试数据图像上具有87%的准确性，并用于在几幅图像上进行预测，以显示该模型如何在给定输入图像的情况下预测输出。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nj nk l"/></div></figure><p id="88d8" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我加载了模型1，获取了我们预测输出的图像的路径，并将其传递给上面的函数以查看输出。所以让我们看看结果如何。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nz"><img src="../Images/92f37484cb8e4f91609646950069640c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*O-z3SbKeqyxkJoeyrfT4-w.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">文本标签预测:计时表</figcaption></figure><p id="c524" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">你可以看到这个模型能够区分看起来几乎相似的字母r，n。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oa"><img src="../Images/65ec4993a170b035f7982555e89c95f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*udmPhbTjtTTkON_-gL6Rfg.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">文本标签的预测:男生</figcaption></figure><h1 id="7421" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">进一步的改进</h1><ol class=""><li id="ac1f" class="lg lh hi jh b ji lb jl lc jo nw js nx jw ny ka nb lm ln lo bi translated">我们可以用更多的图像来训练模型，比如300000或400000张图像，看看结果是否有所改善。</li><li id="feba" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated">用RAdam Optimizer代替Adam Optimizer来试验模型1。</li><li id="8053" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated">我使用的模型是在单个单词图像上训练的，它可以被进一步训练以识别特殊的字符和句子。</li></ol><h1 id="34f8" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated"><strong class="ak">车型部署</strong></h1><p id="b735" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">我创建了一个flask模型应用程序，它获取输入图像并预测输出，你可以在github中我的<a class="ae lz" href="https://github.com/AbhishekKarthik/Image_Text_Recognition_App" rel="noopener ugc nofollow" target="_blank">Image _ Text _ Recognition _ Ap</a>p库中找到该应用程序的代码。我已经在heroku部署了我的应用程序，你可以在这里 访问它<a class="ae lz" href="http://text-image-recognition.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jh hj">。请注意，我已经训练这个模型来预测单个单词的文本图像。🙂</strong></a></p><h1 id="e550" class="kj kk hi bd kl km lu ko kp kq lv ks kt io lw ip kv ir lx is kx iu ly iv kz la bi translated">一个小演示</h1><p id="45e2" class="pw-post-body-paragraph jf jg hi jh b ji lb ij jk jl lc im jn jo ld jq jr js le ju jv jw lf jy jz ka hb bi translated">我想让您看一下我部署的模型是如何工作的会很好</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ob"><img src="../Images/ee0421e372d5e31d532d380c1e5ee4c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*zD5FnusCMFTeidsTnuuC8A.gif"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">图像文本识别演示</figcaption></figure></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><p id="9f84" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这是我第一篇关于媒体深度学习问题的博客。我希望我能够解释并帮助你理解我解决手头问题的方法。请随意查看我的<a class="ae lz" href="https://github.com/AbhishekKarthik/ImageTextRecognition" rel="noopener ugc nofollow" target="_blank"> <strong class="jh hj"> GitHub资源库</strong> </a> <strong class="jh hj"> </strong>中的完整解决方案，并通过<a class="ae lz" href="http://www.linkedin.com/in/abhishek-anand9418" rel="noopener ugc nofollow" target="_blank"> <strong class="jh hj"> LinkedIn </strong> </a>联系我。</p><p id="f7f1" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">感谢您的阅读！！😃</strong></p></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="545a" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">参考</h1><ol class=""><li id="ef48" class="lg lh hi jh b ji lb jl lc jo nw js nx jw ny ka nb lm ln lo bi translated"><a class="ae lz" href="https://arxiv.org/abs/1507.05717" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1507.05717</a></li><li id="7aef" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated"><a class="ae lz" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="a87d" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated"><a class="ae lz" href="https://www.robots.ox.ac.uk/~vgg/data/text/" rel="noopener ugc nofollow" target="_blank">https://www.robots.ox.ac.uk/~vgg/data/text/</a></li><li id="734f" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated"><a class="ae lz" href="https://keras.io/examples/image_ocr/" rel="noopener ugc nofollow" target="_blank">https://keras.io/examples/image_ocr/</a></li><li id="d61b" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated"><a class="ae lz" href="https://towardsdatascience.com/intuitively-understanding-connectionist-temporal-classification-3797e43a86c" rel="noopener" target="_blank">https://towards data science . com/直观-理解-连接主义-时态-分类-3797e43a86c </a></li><li id="6223" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated"><a class="ae lz" href="https://distill.pub/2017/ctc/" rel="noopener ugc nofollow" target="_blank">https://distill.pub/2017/ctc/</a></li><li id="51ee" class="lg lh hi jh b ji lp jl lq jo lr js ls jw lt ka nb lm ln lo bi translated"><a class="ae lz" href="https://cvit.iiit.ac.in/projects/SceneTextUnderstanding/IIIT5K.html" rel="noopener ugc nofollow" target="_blank">https://cvit . iiit . AC . in/projects/scene text understanding/iiit5k . html</a></li></ol></div></div>    
</body>
</html>