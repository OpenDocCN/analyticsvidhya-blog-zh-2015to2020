<html>
<head>
<title>A Complete Guide to Choose the Correct Cross Validation Technique</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">选择正确交叉验证技术的完整指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-complete-guide-to-choose-the-correct-cross-validation-technique-d70810a02f27?source=collection_archive---------3-----------------------#2020-11-07">https://medium.com/analytics-vidhya/a-complete-guide-to-choose-the-correct-cross-validation-technique-d70810a02f27?source=collection_archive---------3-----------------------#2020-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3cc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文是在回归或分类设置中，预测分析解决方案开发周期中经常使用的各种交叉验证技术的完整指南。它还提供了一个用Python编写的示例使用代码，使用真实数据集介绍了每种CV技术。</p><p id="1334" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么是交叉验证？</p><p id="3066" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">验证模型，以确定/评估它是否与数据精确拟合，同时确保它不会过度拟合。</p><p id="d278" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">过度拟合</strong>:模型完全符合训练数据，但不能概括/在测试数据上表现不佳。</p><p id="cf3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从我的经验来看，我认为CV是构建生产就绪的ML模型的重要步骤。(将数据清理和预处理、特征工程视为特征丰富过程的一部分，而不是模型构建。)</p><p id="0e00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">注意:——交叉验证技术取决于底层数据分布。因此，需要对使用CV技术有很好的理解。</em></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">代码:读取数据</figcaption></figure><h2 id="4dcc" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">不同类型的交叉验证技术</h2><p id="950e" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">K-Fold交叉验证:这是我们讨论的CV技术的最简单的形式，其他的CV技术可以被认为是这种技术的变体。<br/>下图清楚地说明了不同的CV技术- <br/>数据被随机混洗，并且创建了具有相同数量样本(大多数)的K-唯一数据集。该模型连续地建立在任何(K-1)个数据集(折叠)上，同时在遗漏的数据集上进行验证，并保持对所建立模型的先前评估度量的跟踪。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kp"><img src="../Images/db4312723dbd771f1375c287bce57712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PJ5dK49j0xrNaQ-YBdnB8g.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">图(1) : K倍交叉验证</figcaption></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">代码:K折叠交叉验证</figcaption></figure><p id="d606" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分层K重交叉验证</strong>:一种CV技术，可视为K重交叉验证技术的衍生版本。这种技术保持折叠(任何K-1数据集)中每个标签的比率恒定。因此，每个折叠基本上具有相同的每种标记的比率。<br/>您可能已经发现了这一点，分层K-Fold CV主要用于倾斜数据集。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kp"><img src="../Images/a0b9c695a641aed66de7b8053de02d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5coPMBsdVZcSfKqs8piM1w.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">图(2):分层交叉验证</figcaption></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">代码:分层K折叠交叉验证</figcaption></figure><p id="a704" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">留一交叉验证</strong>:这种CV技术针对除一个样本之外的所有样本进行训练。它是一个K倍CV，其中K = N，N是数据中的样本数。<br/>由于在数据的N个不同可能组合上的训练在用于训练的计算能力方面成本很高&amp;验证模型，当处理小数据集时，这种CV技术是优选的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kw"><img src="../Images/d4c9d3c33b658c96bab9875df078f43f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLvYQbE1NjclyIpt5IaLoA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">图(3):省去一个交叉验证</figcaption></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">代码:省去一个交叉验证</figcaption></figure><p id="2e40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">组K-折叠交叉验证</strong>:一种CV技术，它创建训练和测试组，使得同一组不会出现在两个不同的折叠中，并且不同组的数量在每个折叠中是相同的。<br/>因此，在分层抽样的调整中，K-Fold CV组通常用于大数据集。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kx"><img src="../Images/c03fbc496b996b62690c1fffa2e708f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PtW8FMQ3NT1glkjmMTIO5A.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">图(4):组K倍交叉验证</figcaption></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">代码:K组折叠交叉验证</figcaption></figure><p id="12f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基于保持的交叉验证</strong>:一种CV技术，它不同于其他CV技术，在其他CV技术中，数据被分成两组，而不是K倍:- <br/> a. <strong class="ih hj">训练组</strong>:在这个数据集上训练模型。<br/> b. <strong class="ih hj">搁置集</strong>:在此数据集上验证模型。该数据集必须保持标签的比率为常数。<br/>这种CV技术通常在处理大型数据集时使用，因为对于上述CV技术来说，它的计算量很大。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ky"><img src="../Images/672e226164ae52ca1279ebb3a6cf83c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZcRXborkw2fTzK3E5CQuA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">图5:支持交叉验证</figcaption></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">代码:支持交叉验证</figcaption></figure><p id="2960" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了方便用户，本文主要关注回归设置，因为scikit-learn库可以直接用于分类设置。</p><p id="ee3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">注意:-在回归设置中，K倍CV、组K倍CV、留一CV可以按原样使用。对于使用基于保留的CV，分组K倍CV与分层抽样，K倍分层CV，目标变量应被划分为多个箱，然后以类似于分类设置的方式使用。</em></p><p id="d7be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">共享的代码包含了宁滨的概念。</em></p><p id="f5fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯！</p><p id="399b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐学习！</p></div></div>    
</body>
</html>