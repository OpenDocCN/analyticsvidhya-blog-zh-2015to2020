<html>
<head>
<title>Credit Card Fraud Detection in Python using Scikit Learn.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Scikit Learnåœ¨Pythonä¸­è¿›è¡Œä¿¡ç”¨å¡æ¬ºè¯ˆæ£€æµ‹ã€‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/credit-card-fraud-detection-in-python-using-scikit-learn-f9046a030f50?source=collection_archive---------0-----------------------#2019-10-26">https://medium.com/analytics-vidhya/credit-card-fraud-detection-in-python-using-scikit-learn-f9046a030f50?source=collection_archive---------0-----------------------#2019-10-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="9d9c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»‹ç»</h1><p id="6ecf" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">ã€æ³¨:â€œç¼–ç è€…â€ï¼Œæ¥çœ‹æœºå™¨å­¦ä¹ ç®—æ³•çš„å¯ä»¥ç›´æ¥è·³è½¬ä»£ç ã€‘</p><p id="0d5a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æˆ‘å·²ç»åŒå€¦äº†æ‰€æœ‰æˆ‘æ”¶åˆ°çš„å…³äºæˆ‘çš„ä¿¡ç”¨å¡è¢«ä½¿ç”¨çš„ç¡®è®¤ä¿¡æ¯ï¼Œå¦‚æœä¸æ˜¯æˆ‘ï¼Œæˆ‘ä¼šè¦æ±‚å›å¤ã€‚ä¸ä»…ä»…æ˜¯ä¿¡ç”¨å¡ï¼Œä»»ä½•åœ¨çº¿æ”¯ä»˜åª’ä»‹ï¼Œä»–ä»¬æ€»æ˜¯ç”¨ä»–ä»¬ç–¯ç‹‚çš„ç¡®è®¤ä¿¡æ¯æ¥çƒ¦ä½ ã€‚æˆ‘æœ‰æ—¶ä¼šæƒ³ï¼Œä¸ºä»€ä¹ˆä»–ä»¬ä¸èƒ½è¢«è¯´æœï¼Œåœ¨ç¡®å®æœ‰å¯ç–‘çš„äº‹æƒ…å‘ç”Ÿçš„æ—¶å€™ç»™æˆ‘å‘ä¿¡æ¯ã€‚æˆ‘æ‰“èµŒä½ ä¹Ÿæ˜¯ã€‚ä½†ä¿¡ç”¨å¡æ¬ºè¯ˆæ˜¯æ”¿åºœé¢ä¸´çš„æœ€å¤§é—®é¢˜ä¹‹ä¸€ï¼Œæ¶‰åŠçš„é‡‘é¢é€šå¸¸éå¸¸å·¨å¤§ã€‚æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ç±»æœåŠ¡å•†é¢ä¸´çš„æŒ‘æˆ˜æ˜¯ä»€ä¹ˆã€‚æˆ‘ä»¬é‡‡å–äº†ä»€ä¹ˆç­–ç•¥æ¥è§£å†³è¿™ä¸ªå·¨å¤§çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆä½ ä¼šå¦‚æ­¤é¢‘ç¹åœ°è¢«è¿™äº›ä¿¡æ¯éªšæ‰°ï¼Ÿ</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/70c903f90153569a1b9aa6d8758d0259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3f4KQvOVZQRCsFLxvHD4rA.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">ç‰¹å¾å›¾åƒ</figcaption></figure><h2 id="15b9" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">ä¿¡ç”¨å¡è¯ˆéª—æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Ÿ</h2><p id="bcb3" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">ä¸€äº›æœ€å¸¸è§çš„å¯èƒ½å‘ç”Ÿæ–¹å¼æ˜¯:</p><ul class=""><li id="18e8" class="lk ll hi jf b jg kb jk kc jo lm js ln jw lo ka lp lq lr ls bi translated">é¦–å…ˆï¼Œä¹Ÿæ˜¯æœ€æ˜æ˜¾çš„ï¼Œå½“ä½ çš„<strong class="jf hj">å¡çš„ç»†èŠ‚</strong>è¢«å…¶ä»–äºº<strong class="jf hj">ç›‘ç£</strong>æ—¶ã€‚</li><li id="fb64" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">å½“ä½ çš„<strong class="jf hj">å¡ä¸¢å¤±æˆ–è¢«ç›—</strong>æ—¶ï¼Œæ‹¥æœ‰å®ƒçš„äººçŸ¥é“å¦‚ä½•å¤„ç†äº‹æƒ…ã€‚</li><li id="9ee8" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated"><strong class="jf hj">å‡ç”µè¯</strong>ç”µè¯è¯´æœä½ åˆ†äº«ç»†èŠ‚ã€‚</li><li id="e25a" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">æœ€åï¼Œä¹Ÿæ˜¯æœ€ä¸å¯èƒ½çš„ä¸€ç‚¹æ˜¯ï¼Œå¯¹é“¶è¡Œè´¦æˆ·ç»†èŠ‚çš„é«˜çº§é»‘å®¢æ”»å‡»ã€‚</li></ul><h2 id="cf78" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">ä¿¡ç”¨å¡æ¬ºè¯ˆæ£€æµ‹é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜æ˜¯:</h2><ul class=""><li id="93d7" class="lk ll hi jf b jg jh jk jl jo ly js lz jw ma ka lp lq lr ls bi translated"><strong class="jf hj">æ¯å¤©éƒ½è¦å¤„ç†å¤§é‡æ•°æ®</strong>ï¼Œæ¨¡å‹æ„å»ºå¿…é¡»è¶³å¤Ÿå¿«ï¼Œä»¥ä¾¿åŠæ—¶åº”å¯¹éª—å±€ã€‚</li><li id="2571" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated"><strong class="jf hj">ä¸å¹³è¡¡çš„æ•°æ®</strong>å³å¤§å¤šæ•°äº¤æ˜“(99.8%)ä¸æ˜¯æ¬ºè¯ˆæ€§çš„ï¼Œè¿™ä½¿å¾—æ£€æµ‹æ¬ºè¯ˆæ€§äº¤æ˜“å˜å¾—éå¸¸å›°éš¾</li><li id="50f5" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated"><strong class="jf hj">æ•°æ®å¯ç”¨æ€§</strong>å› ä¸ºæ•°æ®å¤§å¤šæ˜¯ç§æœ‰çš„ã€‚</li><li id="eeac" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated"><strong class="jf hj">åˆ†ç±»é”™è¯¯çš„æ•°æ®</strong>å¯èƒ½æ˜¯å¦ä¸€ä¸ªä¸»è¦é—®é¢˜ï¼Œå› ä¸ºå¹¶éæ‰€æœ‰æ¬ºè¯ˆäº¤æ˜“éƒ½ä¼šè¢«å‘ç°å’ŒæŠ¥å‘Šã€‚</li><li id="9c3b" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">æœ€åä½†å¹¶éæœ€ä¸é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œ<strong class="jf hj">éª—å­é’ˆå¯¹æ¨¡å‹ä½¿ç”¨çš„é€‚åº”æ€§æŠ€æœ¯</strong>ã€‚</li></ul><h2 id="0c07" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">å¦‚ä½•åº”å¯¹è¿™äº›æŒ‘æˆ˜ï¼Ÿ</h2><ul class=""><li id="d698" class="lk ll hi jf b jg jh jk jl jo ly js lz jw ma ka lp lq lr ls bi translated">ä½¿ç”¨çš„<strong class="jf hj">æ¨¡å‹</strong>å¿…é¡»<strong class="jf hj">è¶³å¤Ÿç®€å•å¿«é€Ÿ</strong>ä»¥æ£€æµ‹å¼‚å¸¸æƒ…å†µå¹¶å°½å¿«å°†å…¶å½’ç±»ä¸ºæ¬ºè¯ˆäº¤æ˜“ã€‚</li><li id="cf7e" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">å¯ä»¥é€šè¿‡é€‚å½“åœ°ä½¿ç”¨ä¸€äº›æ–¹æ³•æ¥å¤„ç†ä¸å¹³è¡¡ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ®µä¸­è®¨è®ºè¿™äº›æ–¹æ³•</li><li id="e16b" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">ä¸ºäº†ä¿æŠ¤ç”¨æˆ·çš„éšç§ï¼Œå¯ä»¥å‡å°‘æ•°æ®çš„ç»´åº¦<strong class="jf hj"/>ã€‚</li><li id="b369" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">è‡³å°‘ä¸ºäº†è®­ç»ƒæ¨¡å‹ï¼Œå¿…é¡»é‡‡ç”¨ä¸€ä¸ªæ›´å¯ä¿¡çš„æ¥æºæ¥åŒé‡æ£€æŸ¥æ•°æ®ã€‚</li><li id="eb83" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">æˆ‘ä»¬å¯ä»¥ä½¿æ¨¡å‹<strong class="jf hj">ç®€å•æ˜“æ‡‚</strong>ï¼Œè¿™æ ·å½“éª—å­åªéœ€ç¨åŠ è°ƒæ•´å°±èƒ½é€‚åº”å®ƒæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥éƒ¨ç½²ä¸€ä¸ªæ–°çš„æ¨¡å‹ã€‚</li></ul><h2 id="867e" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">å¤„ç†ä¸å¹³è¡¡</h2><p id="99ea" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">æˆ‘ä»¬å°†åœ¨æœ¬æ–‡çš„åé¢éƒ¨åˆ†çœ‹åˆ°ï¼Œæˆ‘ä»¬æ”¶åˆ°çš„æ•°æ®æ˜¯é«˜åº¦ä¸å¹³è¡¡çš„ï¼Œå³åªæœ‰0.17%çš„ä¿¡ç”¨å¡äº¤æ˜“æ˜¯æ¬ºè¯ˆæ€§çš„ã€‚å—¯ï¼Œç±»ä¸å¹³è¡¡æ˜¯ç°å®ç”Ÿæ´»ä¸­éå¸¸å¸¸è§çš„é—®é¢˜ï¼Œåœ¨åº”ç”¨ä»»ä½•ç®—æ³•ä¹‹å‰éƒ½éœ€è¦å¤„ç†ã€‚</p><p id="bfd5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æœ‰ä¸‰ç§å¸¸è§çš„æ–¹æ³•æ¥å¤„ç†æ•°æ®çš„ä¸å¹³è¡¡</p><ul class=""><li id="faeb" class="lk ll hi jf b jg kb jk kc jo lm js ln jw lo ka lp lq lr ls bi translated"><strong class="jf hj">æ¬ é‡‡æ ·</strong>-Kubatå’ŒMatwinçš„å•è¾¹é‡‡æ ·(ICML 1997)</li><li id="1c11" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated"><strong class="jf hj">è¿‡é‡‡æ ·</strong> - <strong class="jf hj"> SMOTE </strong>(åˆæˆå°‘æ•°è¿‡é‡‡æ ·æŠ€æœ¯)</li><li id="0f2f" class="lk ll hi jf b jg lt jk lu jo lv js lw jw lx ka lp lq lr ls bi translated">ç»¼åˆä»¥ä¸Šä¸¤è€…ã€‚</li></ul><p id="a88d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">è¿™ç§ä¸å¹³è¡¡ä¸åœ¨æœ¬æ–‡çš„è®¨è®ºèŒƒå›´ä¹‹å†…ã€‚<a class="ae mb" href="https://www.analyticsvidhya.com/blog/2016/03/practical-guide-deal-imbalanced-classification-problems/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æ˜¯å¦ä¸€ç¯‡æŒ‡å¯¼ä½ å…·ä½“å¤„ç†è¿™ä¸ªé—®é¢˜çš„æ–‡ç« ã€‚</p><p id="46a4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¯¹äºé‚£äº›æƒ³çŸ¥é“æ¬ºè¯ˆæ€§äº¤æ˜“æ˜¯å¦å¦‚æ­¤ç½•è§çš„äººæ¥è¯´ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªäº‹å®ã€‚æ¬ºè¯ˆäº¤æ˜“æ¶‰åŠçš„é‡‘é¢é«˜è¾¾æ•°åäº¿ç¾å…ƒï¼Œé€šè¿‡å°†ç‰¹å¼‚æ€§æé«˜åˆ°0.1%ï¼Œæˆ‘ä»¬å¯ä»¥èŠ‚çœæ•°ç™¾ä¸‡ç¾å…ƒã€‚è€Œæ›´é«˜çš„æ•æ„Ÿåº¦æ„å‘³ç€è¢«éªšæ‰°çš„äººæ›´å°‘ã€‚</p><h1 id="28e7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»£ç </h1><p id="b27a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">ä½ å¥½ç¼–ç å‘˜ï¼Œå¦‚æœä½ ç›´æ¥è·³åˆ°è¿™ä¸€éƒ¨åˆ†ï¼Œè¿™é‡Œæ˜¯ä½ éœ€è¦çŸ¥é“çš„ã€‚ä¿¡ç”¨å¡æ¬ºè¯ˆæ˜¯ä¸å¥½çš„ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥è¯†åˆ«æ¬ºè¯ˆï¼Œä½¿ç”¨æ•°æ®ä¸­æä¾›ç»™æˆ‘ä»¬çš„ä¸€äº›ç‰¹å¾ï¼Œç›®å‰æ‚¨å¯ä»¥å®Œå…¨ä¾èµ–è¿™äº›ç‰¹å¾ã€‚æ‰€ä»¥ä¸å¤šè¯´äº†ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p><p id="e0db" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">é¦–å…ˆé€‰æ‹©äº†ä¸€ä¸ªå¹³å°ï¼Œæˆ‘æ›´å–œæ¬¢Google Colabï¼Œä½†Kaggleä¹Ÿå¾ˆæ£’ã€‚ä½ å¯ä»¥ä»GPUé…ç½®çš„è§’åº¦æ¥æ¯”è¾ƒ<a class="ae mb" href="https://towardsdatascience.com/kaggle-vs-colab-faceoff-which-free-gpu-provider-is-tops-d4f0cd625029" rel="noopener" target="_blank">è¿™ç¯‡</a>æ–‡ç« ä¸­çš„è¿™ä¸¤ä¸ªï¼Œå› ä¸ºä»·æ ¼ä¸æ˜¯ä¸€ä¸ªå› ç´ (å®ƒä»¬éƒ½æ˜¯å…è´¹ä½¿ç”¨çš„)ã€‚</p><p id="11bb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¦‚æœä½ æƒ³è®©æˆ‘å†™ä¸€ç¯‡å…³äºå¦‚ä½•ä½¿ç”¨Google Colabæˆ–Kaggleå¹³å°æˆ–ä½ çš„æœ¬åœ°æœºå™¨æ¥æ„å»ºä½ çš„åˆ†ç±»å™¨çš„æ–‡ç« ï¼Œè¯·åœ¨ä¸‹é¢çš„è¯„è®ºä¸­å‘Šè¯‰æˆ‘ğŸ˜‰ã€‚</p><p id="3b29" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">è¿™é‡Œæ˜¯åˆ°ç¬”è®°æœ¬èµ„æºåº“çš„<a class="ae mb" href="https://github.com/amancodeblast/Credit-Card-Fraud-Detection" rel="noopener ugc nofollow" target="_blank"> GitHub </a>é“¾æ¥ã€‚æ‚¨å¯ä»¥æ´¾ç”Ÿå®ƒï¼Œç”šè‡³æ¨é€æ¥å»ºè®®å­˜å‚¨åº“ä¸­çš„ä¸€äº›æ›´æ”¹ã€‚è¯·éšæ„å°è¯•ã€‚</p><p id="c200" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">å¯¼å…¥ä¾èµ–å…³ç³»</strong></p><p id="a4f2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä¸‹é¢æ˜¯å¯¼å…¥æ‰€æœ‰éœ€è¦çš„ä¾èµ–é¡¹çš„ä»£ç </p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="f625" class="kw ig hi md b fi mh mi l mj mk"># import the necessary packages<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>from matplotlib import gridspec</span></pre><p id="e803" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¦‚æœæ‚¨è¿˜æ²¡æœ‰å®‰è£…æ‰€æœ‰è¿™äº›ä¾èµ–é¡¹ï¼Œæˆ‘æ¨èæ‚¨å®‰è£…Anacondaå‘è¡Œç‰ˆ,å®ƒåŒ…å«äº†æ‚¨å°†ä¼šé‡åˆ°çš„å¤§å¤šæ•°åŒ…ã€‚ä½ ä¹Ÿå¯ä»¥è§‚çœ‹è¿™ä¸ªè§†é¢‘æ¥æŒ‡å¯¼windowså®‰è£…Anacondaï¼Œæˆ–è€…é˜…è¯»<a class="ae mb" href="https://www.analyticsvidhya.com/blog/2019/08/everything-know-about-setting-up-python-windows-linux-and-mac/" rel="noopener ugc nofollow" target="_blank">è¿™ç¯‡</a>æ–‡ç« ï¼Œä½œè€…æ˜¯Analytical Vidya for Macæˆ–Linuxã€‚</p><p id="8f5c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">åŠ è½½æ•°æ®</strong></p><p id="1951" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä½ å¾—å…ˆä»<a class="ae mb" href="https://www.kaggle.com/mlg-ulb/creditcardfraud/data#" rel="noopener ugc nofollow" target="_blank"> Kaggleç½‘ç«™</a>ä¸‹è½½æ•°æ®ã€‚å•å‡»å±å¹•ä¸­é—´æ–°ç¬”è®°æœ¬æŒ‰é’®æ—è¾¹çš„ä¸‹è½½æŒ‰é’®ã€‚</p><p id="7ced" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™æ®µä»£ç å°†æ•°æ®é›†åŠ è½½åˆ°æ‚¨æ­£åœ¨ä½¿ç”¨çš„ipythonç¬”è®°æœ¬ä¸­ã€‚</p><p id="3300" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ³¨æ„:æ‹¬å·ä¸­çš„è·¯å¾„å¿…é¡»æ˜¯æ‚¨åœ¨è®¡ç®—æœºä¸­å­˜å‚¨æ•°æ®é›†çš„è·¯å¾„ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Colabï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†æ‚¨çš„é©±åŠ¨å™¨å®‰è£…åˆ°ç¬”è®°æœ¬ä¸Šï¼Œå¹¶å°†å…¶æä¾›ç»™Google Driveçš„æ•°æ®é›†ç›®å½•è·¯å¾„ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="5540" class="kw ig hi md b fi mh mi l mj mk"># Load the dataset from the csv file using pandas<br/>data = pd.read_csv(â€˜/content/drive/My Drive/creditcard.csvâ€™)</span></pre><h2 id="47a6" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">ç†è§£æ•°æ®</h2><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="c686" class="kw ig hi md b fi mh mi l mj mk">Grab a peak at the data<br/>data.head()</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ml"><img src="../Images/3f834bff9b8807fe33d02f9440077334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TkVrs-z8dS39LIAxTvHyEw.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾1å¯ä»Kaggleè·å¾—çš„æ•°æ®</figcaption></figure><p id="aee5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç”±äºä¸€äº›ä¿å¯†é—®é¢˜ï¼ŒåŸæ¥çš„åŠŸèƒ½è¢«æ›¿æ¢ä¸ºV1ï¼ŒV2ï¼Œâ€¦ V28åˆ—ï¼Œè¿™æ˜¯åº”ç”¨äºåŸæ¥çš„PCAè½¬æ¢çš„ç»“æœã€‚å”¯ä¸€æ²¡æœ‰è¢«PCAè½¬æ¢çš„ç‰¹å¾æ˜¯â€œæ—¶é—´â€å’Œâ€œæ•°é‡â€ã€‚ç‰¹å¾â€œç±»åˆ«â€æ˜¯å“åº”å˜é‡ï¼Œåœ¨æ¬ºè¯ˆçš„æƒ…å†µä¸‹å–å€¼1ï¼Œå¦åˆ™å–å€¼0ã€‚</p><p id="111b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ—¶é—´</strong></p><p id="2f28" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ­¤äº‹åŠ¡ä¸æ•°æ®é›†ä¸­ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¹‹é—´ç»è¿‡çš„ç§’æ•°ã€‚</p><p id="092b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">é‡‘é¢</strong></p><p id="9502" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">äº¤æ˜“é‡‘é¢</p><p id="57dc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç±»</strong></p><p id="9ac8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">1è¡¨ç¤ºæ¬ºè¯ˆäº¤æ˜“ï¼Œå¦åˆ™ä¸º0</p><p id="3b06" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">çŸ¥é“æ•°å­—</strong></p><p id="4700" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¦‚æœæ‚¨æƒ³å…ˆå¤„ç†ä¸€ä¸ªè¾ƒå°çš„æ•°æ®é›†ï¼Œç„¶åå½“ä¸€åˆ‡æ­£å¸¸æ—¶ï¼Œå¯ä»¥é€‰æ‹©å–æ¶ˆå¯¹ç¬¬äºŒè¡Œçš„æ³¨é‡Šï¼Œå†æ¬¡æ³¨é‡Šå®ƒå¹¶è¿è¡Œæ‰€æœ‰å•å…ƒæ ¼ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="47bf" class="kw ig hi md b fi mh mi l mj mk"># Print the shape of the data<br/># data = data.sample(frac=0.1, random_state = 48)<br/>print(data.shape)<br/>print(data.describe())</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mm"><img src="../Images/99ec7a32fc9ccbd185ca80099a3ab51b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZSG8Qof0HDAAeRh8L9BjBQ.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾2æè¿°äº†æ•°æ®</figcaption></figure><p id="a6b0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†åœ¨å›¾è¡¨ä¸Šå¯è§†åŒ–æ•°æ®é›†çš„æ‰€æœ‰è¦ç´ ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="e555" class="kw ig hi md b fi mh mi l mj mk"># distribution of anomalous features<br/>features = data.iloc[:,0:28].columns</span><span id="2541" class="kw ig hi md b fi mn mi l mj mk">plt.figure(figsize=(12,28*4))<br/>gs = gridspec.GridSpec(28, 1)<br/>for i, c in enumerate(data[features]):<br/> ax = plt.subplot(gs[i])<br/> sns.distplot(data[c][data.Class == 1], bins=50)<br/> sns.distplot(data[c][data.Class == 0], bins=50)<br/> ax.set_xlabel(â€˜â€™)<br/> ax.set_title(â€˜histogram of feature: â€˜ + str(c))<br/>plt.show()</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mo"><img src="../Images/bde1d5e69fdb3e60169366f695d6d702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HuCOg62UaBK4ri2chrtpvQ.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾3å¯è§†åŒ–æ•°æ®</figcaption></figure><p id="8157" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">è®©æˆ‘ä»¬å°†æ¬ºè¯ˆæ¡ˆä¾‹ä¸çœŸå®æ¡ˆä¾‹åˆ†å¼€ï¼Œå¹¶æ¯”è¾ƒå®ƒä»¬åœ¨æ•°æ®é›†ä¸­çš„å‡ºç°æƒ…å†µã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="5d28" class="kw ig hi md b fi mh mi l mj mk"># Determine number of fraud cases in dataset</span><span id="ff2a" class="kw ig hi md b fi mn mi l mj mk">Fraud = data[data[â€˜Classâ€™] == 1]<br/>Valid = data[data[â€˜Classâ€™] == 0]</span><span id="fc99" class="kw ig hi md b fi mn mi l mj mk">outlier_fraction = len(Fraud)/float(len(Valid))<br/>print(outlier_fraction)</span><span id="7004" class="kw ig hi md b fi mn mi l mj mk">print(â€˜Fraud Cases: {}â€™.format(len(data[data[â€˜Classâ€™] == 1])))<br/>print(â€˜Valid Transactions: {}â€™.format(len(data[data[â€˜Classâ€™] == 0])))</span></pre><p id="d459" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ¬ºè¯ˆåœ¨æ‰€æœ‰äº¤æ˜“ä¸­ï¼Œæ¬ºè¯ˆäº¤æ˜“ä»…å 0.17%ã€‚æ•°æ®æä¸å¹³è¡¡ã€‚è®©æˆ‘ä»¬é¦–å…ˆåº”ç”¨æˆ‘ä»¬çš„æ¨¡å‹ï¼Œä½†ä¸è¦å¹³è¡¡å®ƒï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰è·å¾—å¾ˆå¥½çš„å‡†ç¡®æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥å¹³è¡¡è¿™ä¸ªæ•°æ®é›†ã€‚</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mp"><img src="../Images/ebb92960eede1fd7c060d26486bb3273.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*gFym-RxoXhAj2iKDHJX0sA.jpeg"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾5æ¬ºè¯ˆæ¡ˆä»¶çš„ç™¾åˆ†æ¯”</figcaption></figure><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="3251" class="kw ig hi md b fi mh mi l mj mk">print(â€œAmount details of fraudulent transactionâ€)<br/>Fraud.Amount.describe()</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mq"><img src="../Images/5efed1e4075fd9275e63f8d1d3cc9aa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*aMmxShfkYizfKiZN5pvEFA.jpeg"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾6æ¬ºè¯ˆäº¤æ˜“çš„é‡‘é¢æ˜ç»†</figcaption></figure><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="a8ac" class="kw ig hi md b fi mh mi l mj mk">print(â€œdetails of valid transactionâ€)<br/>Valid.Amount.describe()</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mr"><img src="../Images/11e1e5419f715081a6bc2006ec2239a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*YTmOH8nWsJSO2nAaLum-kQ.jpeg"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾7æœ‰æ•ˆäº¤æ˜“çš„é‡‘é¢æ˜ç»†</figcaption></figure><p id="9421" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°æ³¨æ„åˆ°ï¼Œæ¬ºè¯ˆè€…çš„å¹³å‡é‡‘é’±äº¤æ˜“æ›´å¤šã€‚è¿™ä½¿å¾—è¿™ä¸ªé—®é¢˜çš„å¤„ç†è‡³å…³é‡è¦ã€‚</p><p id="00c2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç›¸å…³çŸ©é˜µä»¥å›¾å½¢æ–¹å¼è®©æˆ‘ä»¬äº†è§£ç‰¹å¾ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬é¢„æµ‹ä¸é¢„æµ‹æœ€ç›¸å…³çš„ç‰¹å¾ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="508b" class="kw ig hi md b fi mh mi l mj mk"># Correlation matrix<br/>corrmat = data.corr()<br/>fig = plt.figure(figsize = (12, 9))</span><span id="2bf5" class="kw ig hi md b fi mn mi l mj mk">sns.heatmap(corrmat, vmax = .8, square = True)<br/>plt.show()</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ms"><img src="../Images/357a4debee6ea4a8d55ec253eadea457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*teLLYuC56Pn0ZoI2o21ITw.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾8ç›¸å…³çŸ©é˜µ</figcaption></figure><p id="da1d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">åœ¨çƒ­å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å¤§å¤šæ•°åŠŸèƒ½ä¸å…¶ä»–åŠŸèƒ½ä¸ç›¸å…³ï¼Œä½†æœ‰ä¸€äº›åŠŸèƒ½å½¼æ­¤ä¹‹é—´å­˜åœ¨æ­£ç›¸å…³æˆ–è´Ÿç›¸å…³ã€‚ä¾‹å¦‚ï¼Œâ€œV2â€å’Œâ€œV5â€ä¸ç§°ä¸ºâ€œæ•°é‡â€çš„ç‰¹å¾é«˜åº¦è´Ÿç›¸å…³ã€‚æˆ‘ä»¬ä¹Ÿçœ‹åˆ°ä¸â€œV20â€å’Œâ€œé‡â€çš„ä¸€äº›å…³è”ã€‚è¿™è®©æˆ‘ä»¬å¯¹ç°æœ‰æ•°æ®æœ‰äº†æ›´æ·±å…¥çš„äº†è§£ã€‚</p><p id="753b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»§ç»­å°†æ•°æ®å€¼åˆ’åˆ†ä¸ºç‰¹æ€§å’Œç›®æ ‡ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="6b16" class="kw ig hi md b fi mh mi l mj mk">#dividing the X and the Y from the dataset<br/>X=data.drop([â€˜Classâ€™], axis=1)<br/>Y=data[â€œClassâ€]<br/>print(X.shape)<br/>print(Y.shape)<br/>#getting just the values for the sake of processing (its a numpy array with no columns)<br/>X_data=X.values<br/>Y_data=Y.values</span></pre><p id="94c6" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä½¿ç”¨Skicit learnå°†æ•°æ®åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="c50e" class="kw ig hi md b fi mh mi l mj mk"># Using Skicit-learn to split data into training and testing sets<br/>from sklearn.model_selection import train_test_split<br/># Split the data into training and testing sets<br/>X_train, X_test, Y_train, Y_test = train_test_split(X_data, Y_data, test_size = 0.2, random_state = 42)</span></pre><h2 id="68ce" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">æ„å»ºéš”ç¦»æ—æ¨¡å‹</h2><p id="5f87" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">éš”ç¦»æ—ä¸€èˆ¬ç”¨äºå¼‚å¸¸æ£€æµ‹ã€‚å¦‚æœä½ æƒ³äº†è§£è¿™ä¸ªç®—æ³•çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·éšæ„çœ‹çœ‹è¿™ä¸ªè§†é¢‘ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="df1d" class="kw ig hi md b fi mh mi l mj mk">#Building another model/classifier ISOLATION FOREST<br/>from sklearn.ensemble import IsolationForest<br/>ifc=IsolationForest(max_samples=len(X_train),<br/> contamination=outlier_fraction,random_state=1)<br/>ifc.fit(X_train)<br/>scores_pred = ifc.decision_function(X_train)<br/>y_pred = ifc.predict(X_test)</span></pre><h2 id="3b55" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">åœ¨æµ‹è¯•é›†ä¸Šæ„å»ºè¯„ä¼°çŸ©é˜µ</h2><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="ece7" class="kw ig hi md b fi mh mi l mj mk"># Reshape the prediction values to 0 for valid, 1 for fraud. <br/>y_pred[y_pred == 1] = 0<br/>y_pred[y_pred == -1] = 1</span><span id="d61c" class="kw ig hi md b fi mn mi l mj mk">n_errors = (y_pred != Y_test).sum()</span></pre><p id="8c30" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">å¯è§†åŒ–è¯¥æ¨¡å‹çš„æ··æ·†çŸ©é˜µã€‚</strong></p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="66ed" class="kw ig hi md b fi mh mi l mj mk">#printing the confusion matrix<br/>LABELS = [â€˜Normalâ€™, â€˜Fraudâ€™]<br/>conf_matrix = confusion_matrix(Y_test, y_pred)<br/>plt.figure(figsize=(12, 12))<br/>sns.heatmap(conf_matrix, xticklabels=LABELS,<br/> yticklabels=LABELS, annot=True, fmt=â€dâ€);<br/>plt.title(â€œConfusion matrixâ€)<br/>plt.ylabel(â€˜True classâ€™)<br/>plt.xlabel(â€˜Predicted classâ€™)<br/>plt.show()</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mt"><img src="../Images/afd6aeaeffbf183fe97c6ae24edf70df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*VbLLim6AfZeVKqx38dDl2g.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾9éš”ç¦»æ—çš„æ··æ·†çŸ©é˜µã€‚</figcaption></figure><p id="3ca7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è¯„ä¼°æ¨¡å‹å¹¶æ‰“å°ç»“æœã€‚æˆ‘ä»¬å°†è®¡ç®—å‡†ç¡®åº¦ã€ç²¾ç¡®åº¦ã€å¬å›ç‡ã€F1åˆ†æ•°å’Œé©¬ä¿®æ–¯ç›¸å…³ç³»æ•°ï¼Œä»¥ä¾¿è¿›è¡Œæ€»ä½“åˆ†æã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="a22a" class="kw ig hi md b fi mh mi l mj mk">#evaluation of the model<br/>#printing every score of the classifier<br/>#scoring in any thing<br/>from sklearn.metrics import confusion_matrix<br/>n_outliers = len(Fraud)<br/>print(â€œthe Model used is {}â€.format(â€œIsolation Forestâ€))<br/>acc= accuracy_score(Y_test,y_pred)<br/>print(â€œThe accuracy is {}â€.format(acc))<br/>prec= precision_score(Y_test,y_pred)<br/>print(â€œThe precision is {}â€.format(prec))<br/>rec= recall_score(Y_test,y_pred)<br/>print(â€œThe recall is {}â€.format(rec))<br/>f1= f1_score(Y_test,y_pred)<br/>print(â€œThe F1-Score is {}â€.format(f1))<br/>MCC=matthews_corrcoef(Y_test,y_pred)<br/>print(â€œThe Matthews correlation coefficient is{}â€.format(MCC))</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mu"><img src="../Images/c2c52686018914572ff8d01fd945500b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BWtnmqLuU71l4sif-W25MA.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾10éš”ç¦»æ—æ¨¡å‹æŠ¥å‘Š</figcaption></figure><p id="35ea" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ­£å¦‚ä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œè¿™ä¸ªæ¨¡å‹å¹¶ä¸åƒé¢„æœŸçš„é‚£æ ·å¥½ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å»ºç«‹ä¸€äº›å…¶ä»–çš„æ¨¡å‹æ¥è·å¾—æ›´å¥½çš„ç»“æœã€‚</p><h2 id="48dd" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">æ„å»ºéšæœºæ£®æ—æ¨¡å‹</h2><p id="0de6" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªéšæœºæ£®æ—æ¥æé«˜æ£€æµ‹å™¨çš„æ€§èƒ½ã€‚æˆ‘æƒ³åˆ°äº†ä½¿ç”¨å†³ç­–æ ‘æ¨¡å‹ï¼Œä½†æ­£å¦‚æˆ‘ä»¬æ‰€çŸ¥çš„<strong class="jf hj"> <em class="mv">éšæœºæ£®æ—</em> </strong>å°±åƒæ˜¯<strong class="jf hj"> <em class="mv">å†³ç­–æ ‘</em> </strong>çš„å†›é˜Ÿï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦è´¹å¿ƒå°è¯•å’Œå¤±è´¥ã€‚ä½ å¯ä»¥è®¤ä¸ºéšæœºæ£®æ—æ˜¯åº”ç”¨äºå†³ç­–æ ‘çš„é›†åˆã€‚<a class="ae mb" href="http://analyticsvidhya.com/blog/2014/06/introduction-random-forest-simplified/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œçš„</a>æ˜¯å¯¹éšæœºæ£®æ—çš„ä¸€ä¸ªå¾ˆå¥½å¾ˆç®€å•çš„è§£é‡Šã€‚</p><p id="a1fe" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä½ ä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ªè§†é¢‘</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="7644" class="kw ig hi md b fi mh mi l mj mk"># Building the Random Forest Classifier (RANDOM FOREST)<br/>from sklearn.ensemble import RandomForestClassifier<br/># random forest model creation<br/>rfc = RandomForestClassifier()<br/>rfc.fit(X_train,Y_train)<br/># predictions<br/>y_pred = rfc.predict(X_test)</span></pre><h2 id="a8fa" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">åœ¨æµ‹è¯•é›†ä¸Šæ„å»ºè¯„ä¼°çŸ©é˜µ</h2><p id="75b4" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è¯„ä¼°æ¨¡å‹å¹¶æ‰“å°ç»“æœã€‚æˆ‘ä»¬å°†è®¡ç®—å‡†ç¡®åº¦ã€ç²¾ç¡®åº¦ã€å¬å›ç‡ã€F1åˆ†æ•°å’Œé©¬ä¿®æ–¯ç›¸å…³ç³»æ•°ã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="2cd8" class="kw ig hi md b fi mh mi l mj mk">#Evaluating the classifier<br/>#printing every score of the classifier<br/>#scoring in any thing<br/>from sklearn.metrics import classification_report, accuracy_score,precision_score,recall_score,f1_score,matthews_corrcoef<br/>from sklearn.metrics import confusion_matrix<br/>n_outliers = len(Fraud)<br/>n_errors = (y_pred != Y_test).sum()<br/>print(â€œThe model used is Random Forest classifierâ€)<br/>acc= accuracy_score(Y_test,y_pred)<br/>print(â€œThe accuracy is {}â€.format(acc))<br/>prec= precision_score(Y_test,y_pred)<br/>print(â€œThe precision is {}â€.format(prec))<br/>rec= recall_score(Y_test,y_pred)<br/>print(â€œThe recall is {}â€.format(rec))<br/>f1= f1_score(Y_test,y_pred)<br/>print(â€œThe F1-Score is {}â€.format(f1))<br/>MCC=matthews_corrcoef(Y_test,y_pred)<br/>print(â€œThe Matthews correlation coefficient is{}â€.format(MCC))</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mw"><img src="../Images/f1eab5be3cf16b9f62a80b517ee610cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4KyTWhuMhsSj3Ea12rSvQ.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾11æ¨¡å‹æŠ¥å‘Šéšæœºæ£®æ—ã€‚</figcaption></figure><p id="a657" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">å¯è§†åŒ–æ··æ·†çŸ©é˜µã€‚</strong></p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="698a" class="kw ig hi md b fi mh mi l mj mk">#printing the confusion matrix<br/>LABELS = [â€˜Normalâ€™, â€˜Fraudâ€™]<br/>conf_matrix = confusion_matrix(Y_test, y_pred)<br/>plt.figure(figsize=(12, 12))<br/>sns.heatmap(conf_matrix, xticklabels=LABELS, yticklabels=LABELS, annot=True, fmt=â€dâ€);<br/>plt.title(â€œConfusion matrixâ€)<br/>plt.ylabel(â€˜True classâ€™)<br/>plt.xlabel(â€˜Predicted classâ€™)<br/>plt.show()</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mt"><img src="../Images/67530b85826ef21ab12d1b4d2dcf3ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*WOk8rda6Ah-TkTmbB8i_mw.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾12éšæœºæ£®æ—</figcaption></figure><h2 id="27dc" class="kw ig hi bd ih kx ky kz il la lb lc ip jo ld le it js lf lg ix jw lh li jb lj bi translated">æƒ³è±¡æ£®æ—</h2><p id="5c6d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">ä»æ£®æ—ä¸­éšæœºé€‰å–ä¸€æ£µæ ‘ï¼Œç„¶åå¯è§†åŒ–ï¼Œä»¥ä¾¿äº†è§£ç®—æ³•å¦‚ä½•åšå‡ºå†³å®šï¼Œå¦‚æœéª—å­é‡‡å–å¯¹ç­–ï¼Œè¿™å°†æœ‰åŠ©äºè½»æ¾æ”¹å˜æ¨¡å‹ã€‚ä¸ºæ­¤ï¼Œä½ å¿…é¡»ä»Sklearnåº“å’ŒIPythonåº“ä¸­å¯¼å…¥ä¸€äº›å·¥å…·ï¼Œä»¥ä¾¿åœ¨ç¬”è®°æœ¬ä¸­æ˜¾ç¤ºã€‚</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="f35d" class="kw ig hi md b fi mh mi l mj mk">#visualizing the random tree <br/>feature_list = list(X.columns)<br/># Import tools needed for visualization<br/>from IPython.display import Image<br/>from sklearn.tree import export_graphviz<br/>import pydot</span><span id="d50e" class="kw ig hi md b fi mn mi l mj mk">#pulling out one tree from the forest<br/>tree = rfc.estimators_[5]<br/>export_graphviz(tree, out_file = â€˜tree.dotâ€™, feature_names = feature_list, rounded = True, precision = 1)<br/># Use dot file to create a graph<br/>(graph, ) = pydot.graph_from_dot_file(â€˜tree.dotâ€™)<br/># Write graph to a png file<br/>display(Image(graph.create_png()))</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mx"><img src="../Images/f8644b44d1db1b9ff85682d78968f4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kw-f15fAjKXw1-XLn68D0w.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾13å¯è§†åŒ–å†³ç­–æ ‘</figcaption></figure><h1 id="85cb" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ç»“è®º</h1><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es my"><img src="../Images/6cd31c9765c43946f7ffafc1e44b06f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8-XY9di8R2Uclkhiv4fAw.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾14æ¯”è¾ƒçš„å…¶ä»–æ¨¡å‹</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es mw"><img src="../Images/f1eab5be3cf16b9f62a80b517ee610cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4KyTWhuMhsSj3Ea12rSvQ.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å›¾16éšæœºæ£®æ—æŠ¥å‘Š</figcaption></figure><p id="6ceb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æˆ‘ä»¬çš„<strong class="jf hj">éšæœºæ£®æ—</strong>ç»“æœåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¶…è¿‡äº†ä¹‹å‰æŠ¥é“çš„ç»“æœï¼Œå…¶<strong class="jf hj">é©¬ä¿®æ–¯ç›¸å…³ç³»æ•°</strong>ä¸º<strong class="jf hj"> 0.8629ã€‚</strong>å…¶ä»–æ€§èƒ½ç‰¹å¾ä¹Ÿä»¤äººæ»¡æ„ï¼Œå› æ­¤ç°åœ¨æˆ‘ä»¬ä¸éœ€è¦å¯¹æ­¤åº”ç”¨å…¶ä»–æ¨¡å‹ã€‚</p><p id="c910" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ­£å¦‚ä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„æ¨¡å‹æˆ–ä»»ä½•æ¨¡å‹ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªä½å¬å›å€¼ï¼Œè¿™æ­£æ˜¯ä½ åœ¨äº¤æ˜“åè¢«<em class="mv">é‚£ä¹ˆå¤šç¡®è®¤ä¿¡æ¯</em>éªšæ‰°çš„åŸå› ã€‚ä½†éšç€æœºå™¨å­¦ä¹ æ¨¡å‹è¶Šæ¥è¶Šå¤šçš„è¿›æ­¥ï¼Œæˆ‘ä»¬æ­£åœ¨ç¼“æ…¢ä½†ç¨³æ­¥åœ°å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸ä¼šå±åŠä½ çš„å¸æˆ·çš„å®‰å…¨ã€‚</p><p id="c37e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å®ç°äº†å¤šå°‘ç›®æ ‡:</p><p id="56dc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ¨¡å‹æ˜¯<strong class="jf hj">å¿«é€Ÿ</strong>ï¼Œå®ƒç»å¯¹æ˜¯<strong class="jf hj">ç®€å•</strong>ï¼Œæœ€é‡è¦çš„æ˜¯<strong class="jf hj">æ˜“äºè§£é‡Š</strong>ï¼Œå¦‚å†³ç­–æ ‘å›¾æ‰€ç¤ºã€‚ç”¨æˆ·çš„éšç§ä»ç„¶å®Œå¥½æ— æŸï¼Œå› ä¸ºæ‰€ä½¿ç”¨çš„æ•°æ®åœ¨å¼€å§‹æ—¶å·²ç»é™ä½äº†ç»´åº¦ã€‚å—¯ï¼Œæˆ‘ä»¬ä»ç„¶æ²¡æœ‰è®¾æ³•å¤„ç†æ•°æ®çš„ä¸å¹³è¡¡ï¼Œä½†æˆ‘è®¤ä¸ºæˆ‘ä»¬æ²¡æœ‰å®ƒä¹Ÿåšå¾—å¾ˆå¥½ã€‚è¿™å®é™…ä¸Šæ˜¯æˆ‘ä»¬æ‰€æœ‰äººçš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ã€‚è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼Œä½†è¿™å¯¹æˆ‘æ¥è¯´æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ã€‚å¸Œæœ›ä½ å–œæ¬¢è¯»è¿™ç¯‡æ–‡ç« ï¼Œå°±åƒæˆ‘å–œæ¬¢å†™å®ƒä¸€æ ·ã€‚è€å®è¯´ï¼Œä¸€å¼€å§‹æˆ‘å¯¹æ­¤æœ‰ç‚¹æ€€ç–‘ï¼Œç‰¹åˆ«æ˜¯å½“éš”ç¦»æ£®æ—æ²¡æœ‰äº§ç”Ÿå¥½çš„ç»“æœæ—¶ï¼Œä½†ç°åœ¨çœ‹åˆ°äº†éšæœºæ£®æ—çš„ç»“æœï¼Œåœ¨å®Œæˆè¿™ç§ç»“æœåï¼Œæˆ‘æ„Ÿåˆ°éå¸¸æ»¡æ„ã€‚</p><p id="692b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">è¯¥é¢†åŸŸéœ€è¦æ›´å¤šçš„ç ”ç©¶ï¼Œè¿™æ˜¯ç‰¹å¼‚æ€§å¢åŠ 0.1%å°†èŠ‚çœæ•°ç™¾ä¸‡ç¾å…ƒ(å¦‚æœä¸æ˜¯æ•°åäº¿ç¾å…ƒ)çš„ä¸»é¢˜ä¹‹ä¸€ã€‚</p><p id="0e76" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¦‚æœä½ å¯¹è¿™ä¸ªè¯é¢˜æœ‰ä»»ä½•å›°éš¾æˆ–ç–‘é—®ï¼Œæ¬¢è¿åœ¨ä¸‹é¢è¯„è®ºã€‚éå¸¸æ„Ÿè°¢ä½ çš„æ”¯æŒï¼Œè¿™å°†æ¿€åŠ±æˆ‘ä¸ºä½ å†™æ›´å¤šè¿™æ ·æœ‰ç”¨çš„æ–‡ç« ã€‚</p><p id="9b38" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä¸‹ä¸€ç¯‡æ–‡ç« å†è§ã€‚åœ¨é‚£ä¹‹å‰ï¼Œç»§ç»­ç¼–ç ğŸ‘©â€ğŸ’»ï¼ï¼</p></div></div>    
</body>
</html>