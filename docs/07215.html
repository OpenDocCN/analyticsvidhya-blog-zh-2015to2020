<html>
<head>
<title>Azure Databricks for Data Noobs Part 2 — Run Notebooks as Jobs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure Databricks for Data Noobs第2部分—将笔记本作为作业运行</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/azure-databricks-for-data-noobs-part-2-run-notebooks-as-jobs-b42c962bc02?source=collection_archive---------9-----------------------#2020-06-17">https://medium.com/analytics-vidhya/azure-databricks-for-data-noobs-part-2-run-notebooks-as-jobs-b42c962bc02?source=collection_archive---------9-----------------------#2020-06-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b651e658f1df388a886591f43fc9ea3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*t9DG_WEP630em6dYL9Z83g.jpeg"/></div></div></figure><p id="a804" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将Databricks笔记本作为一项工作来运行是一种简单的方法，可以将您创建的所有优秀笔记本投入使用。我认为两个最大的好处是:</p><ol class=""><li id="070d" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">作业允许您按计划运行笔记本电脑。</li><li id="52e2" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">作业在按需集群上运行。这意味着您不必仅仅为了运行作业而拥有一个持续运行的集群。这可以控制成本。</li></ol><p id="364b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将执行以下操作:</p><ol class=""><li id="5757" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">创建一个笔记本，用于下载数据集、转换数据集并将转换后的数据集保存到DBFS。</li><li id="fe55" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">以交互方式运行笔记本，并验证笔记本是否正常工作。</li><li id="a12f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">将笔记本作为作业运行，并验证作业是否有效。</li></ol><p id="1d0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请记住，可能需要对笔记本进行更改，以使其作为作业运行。这些变化主要与资源访问有关。</p><h1 id="2927" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">环境设置</h1><p id="2ed4" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">首先，我们需要提供我们的Azure Databricks工作区。和往常一样，我将使用<a class="ae lf" href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest" rel="noopener ugc nofollow" target="_blank"> Azure CLI。</a>如有必要，安装CLI，然后启动Powershell会话。</p><h1 id="b716" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">登录Azure</h1><p id="b3b4" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">运行以下命令登录并设置您的订阅:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><h1 id="1a14" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建资源组</h1><p id="814b" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">运行以下命令创建资源组:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><h1 id="d35e" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建数据块工作空间</h1><p id="3cd5" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">运行下面的脚本来创建Databricks工作空间。这需要几分钟才能完成。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="ba26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过运行以下脚本，验证您的资源组是否包含Databricks工作区:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="c2a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">得到这样的回应:</p><pre class="lg lh li lj fd lm ln lo lp aw lq bi"><span id="8382" class="lr kd hi ln b fi ls lt l lu lv">[“Microsoft.Databricks/workspaces”]</span></pre><h1 id="b1ff" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">打开Databricks工作区</h1><p id="9a91" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">打开Azure门户，单击Databricks工作区资源，然后启动工作区。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/51d127df9df88b4c40e2d4bb80b02c71.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*ecMpyGfpL7afgrJfyO5aUg.png"/></div></figure><p id="89b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">至此，环境已经设置完毕。现在让我们创建一个笔记本！</p><h1 id="d307" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建笔记本</h1><p id="11ef" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">创建一个新笔记本，并添加下面的代码。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="960d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码从<a class="ae lf" href="https://azure.microsoft.com/en-us/services/open-datasets/catalog/us-decennial-census-county/#AzureDatabricks" rel="noopener ugc nofollow" target="_blank"> Azure Open Datasets下载美国人口普查数据。</a>第14行创建一个起始数据帧。第16行通过SQL查询转换数据集。产生的数据集被写入第27行的DBFS。</p><blockquote class="lx ly lz"><p id="b614" class="iq ir ma is b it iu iv iw ix iy iz ja mb jc jd je mc jg jh ji md jk jl jm jn hb bi translated">如果愿意，您可以在查询中替换您自己的县和州。如果你这样做，一定要在你的县名后面加一个空格。</p></blockquote><h1 id="95bd" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建集群</h1><p id="00c8" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">我们没有运行笔记本的集群，所以创建一个。这很容易在工作区UI中完成，但是我们也可以使用Databricks REST API。熟悉REST API是一个好主意，尤其是当您需要使用笔记本进行CI/CD时。</p><h1 id="70b2" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建不记名令牌</h1><p id="5749" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">使用REST API进行身份验证需要一个承载令牌。点击右上角的账户图标，选择<strong class="is hj">用户设置。</strong>然后点击<strong class="is hj">生成新令牌</strong>按钮。给它起个名字，然后点击<strong class="is hj">生成。</strong>保存该值，因为我们稍后会用到它，一旦关闭模式，令牌将无法恢复。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es me"><img src="../Images/28273f893a317938ddd94d90611d9ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*yNeaqmCE8XSkVvWy_ytOaQ.png"/></div></figure><h1 id="7a35" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用API创建集群</h1><p id="3ee2" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">运行下面的<a class="ae lf" href="https://curl.haxx.se/download.html" rel="noopener ugc nofollow" target="_blank"> cURL </a>命令创建一个名为<strong class="is hj"> demo-cluster </strong>的集群，其规格如下:</p><ul class=""><li id="da4d" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn mf ju jv jw bi translated"><strong class="is hj">火花6.6版</strong></li><li id="b4a5" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mf ju jv jw bi translated">30分钟不活动后终止。</li><li id="84b6" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mf ju jv jw bi translated">产生最少1个、最多2个工作节点。</li><li id="8044" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mf ju jv jw bi translated">驱动和工作节点运行<strong class="is hj">标准_DS3_v2 </strong>实例。</li></ul><p id="79fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请确保将Databricks工作空间URI替换为您工作空间的URI。此外，用您的不记名令牌替换不记名令牌。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="efb3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">响应包含集群id。在下一步中，我们需要提供这个值。</p><h1 id="beb7" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用API验证集群正在运行</h1><p id="f140" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">运行以下cURL命令，验证输出中的<strong class="is hj">状态</strong>显示为<strong class="is hj">运行</strong>。<strong class="is hj"> </strong>确保用您的值替换不记名令牌、工作空间URI和集群id。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><h1 id="7133" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">运行笔记本</h1><p id="5c56" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">将笔记本电脑连接到集群并运行它。如果一切顺利，您应该会在输出中看到几个parquet文件。</p><h1 id="2fa3" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">我们在哪里？</h1><p id="9511" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">至此，我们有了一个工作笔记本。然而，有一些问题:</p><ol class=""><li id="466d" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">县和州是硬编码的。如果这个笔记本只能以交互方式运行，那么在运行时给用户提供指定县和州的选项就好了。如果我们要将笔记本作为一项工作来运行，这是必须的。</li><li id="11a9" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">拼花文件被写入集群上的DBFS。您可能不想让多个用户运行这些笔记本电脑来增加负载。如果集群被删除了怎么办？我们可以做得更好。</li><li id="3749" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">以前的拼花文件在每次运行时都会被覆盖。更合理的做法是组织文件，以便在需要时可以随时访问。</li></ol><p id="015d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们依次解决每个问题。</p><h1 id="db9f" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">问题#1:硬编码的县和州</h1><p id="92e1" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">我们可以添加一个Databricks小部件，允许用户在运行时指定县和州。小部件的酷之处在于，当笔记本作为作业运行时，可以提供它们的值。</p><p id="9140" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">编辑笔记本代码以匹配以下内容:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="f9d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第18行和第19行添加了两个textbox小部件。第21行和第22行分别检索州和县的值。该查询在第25行和第26行使用这些值。</p><p id="49cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行笔记本，它会失败，但两个部件会出现在笔记本的顶部。输入州和县:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/e18be07fbe6669bb88be387b3e56883d.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*_154Vi3DWntTAtEwK_o1NQ.png"/></div></figure><p id="04a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">再次运行笔记本，您应该会看到像以前一样的拼花文件列表。</p><p id="8ccc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们将在后面看到的，在设置笔记本作为作业运行时，我们指定了相同的值。</p><h1 id="5917" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">问题#2:文件保存到群集</h1><p id="80ed" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">为了最大限度地利用数据，让我们将parquet文件写入Azure blob存储。</p><p id="fdca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在之前使用的同一个Powershell会话中，创建一个存储帐户和一个名为<strong class="is hj"> data: </strong>的容器</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="0bfd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该脚本在第18行输出存储键值。在将拼花文件写入容器时，我们需要提供笔记本中的键。更新笔记本，使其与下面的代码匹配。不要忘记为您的Azure存储帐户名和密钥提供值。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="563b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在第42行向数据块提供存储连接信息。第47行提供了保存拼花文件的路径。注意，这个路径看起来像一个DBFS文件路径。数据帧被写入行50上的blob存储器。</p><p id="3016" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行笔记本。当它完成时，您应该会看到在<strong class="is hj">数据</strong>容器中的<strong class="is hj">人口统计数据</strong>文件夹中的文件。</p><p id="72ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们处理最后一个问题。</p><h1 id="fde3" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">问题#3:每次运行时文件都会被覆盖</h1><p id="0ea2" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">多个用户可能会在不同的县运行这个查询。因此，按州和县组织文件是有意义的。编辑笔记本代码，使文件改为写入<strong class="is hj">数据/【州】/【县】</strong>。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="c8a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第40和41行清除了县和州名。相对路径<strong class="is hj">【州】/【县】</strong>在第42行构建。</p><p id="f5c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行笔记本，你应该看到按州和县组织的文件！</p><h1 id="5da9" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">我们在哪里？</h1><p id="d956" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">现在，我们有了一个足够通用的笔记本电脑，它可以变成一个作业，由多个用户使用按需集群来运行。</p><h1 id="f6c4" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建集群池</h1><p id="fe40" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">作业运行时会创建按需集群。可以想象，创建集群需要时间，这会增加作业的执行时间。通过创建一个<strong class="is hj">集群池</strong>，我们可以让一组集群处于备用状态。这减少了启动时间，从而减少了总的作业执行时间。</p><p id="a840" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们使用cURL创建一个使用REST API的池。确保用您的值替换不记名令牌和工作空间URI。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="c256" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述请求创建了一个具有以下规格的池:</p><ul class=""><li id="8543" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn mf ju jv jw bi translated">至少两个集群将始终处于备用状态。</li><li id="8515" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mf ju jv jw bi translated">该池将最多创建四个群集。</li><li id="7bd4" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mf ju jv jw bi translated">每个集群都将拥有<strong class="is hj">Spark 6.6版本。</strong></li><li id="0dd6" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mf ju jv jw bi translated">第三和第四个集群在60分钟的空闲后终止。</li><li id="33b5" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mf ju jv jw bi translated">集群运行<strong class="is hj">标准DS3 v2</strong>实例。</li></ul><p id="e43f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果一切顺利，池id将出现在响应中。此时，转到Databricks工作区UI，单击<strong class="is hj">集群，</strong>单击<strong class="is hj">池，</strong>最后单击<strong class="is hj">演示池。</strong>几分钟后，您应该看到至少两个集群实例空闲。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/6a0092ea55d8f0ef57e4afc5fbf625e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*za6CCCiFgCQippUQ9AJOag.png"/></div></div></figure><h1 id="a474" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建工作</h1><p id="a134" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">我们终于准备好创建笔记本作业了！这次我们将使用工作区UI，因为Jobs API需要一个非常冗长的主体。</p><ol class=""><li id="ac4f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">点击<strong class="is hj">作业。</strong></li></ol><p id="d2e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.点击<strong class="is hj">创建工作。</strong></p><p id="4852" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.输入作业名称。</p><p id="bd01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.点击<strong class="is hj">选择笔记本。</strong>选择要作为作业运行的笔记本。</p><p id="d478" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.点击<strong class="is hj">参数旁边的<strong class="is hj">编辑</strong>链接。</strong></p><p id="8d8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.添加作业的运行时参数，即县和州。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/feee4232e70c1af37681c0a15d66fd7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*xFFajmAUO_EwY8_ph2Fu8Q.png"/></div></figure><p id="6e84" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.点击<strong class="is hj">添加。</strong></p><p id="3d26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.点击<strong class="is hj">确认。</strong>参数值显示在工作页面上。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/3a975e2854c3c31f70efeb35a1edd308.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*CUy-LWKLMdX8Mkar_vSChQ.png"/></div></figure><p id="9aae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.点击<strong class="is hj">集群旁边的<strong class="is hj">编辑</strong>链接。</strong></p><p id="eaae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">9.在<strong class="is hj">池</strong>下拉菜单中，选择<strong class="is hj">演示池</strong>。</p><p id="0b2a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">10.在<strong class="is hj"> Databricks运行时版本</strong>下拉列表中，选择<strong class="is hj">运行时:6.6 </strong></p><p id="ebc8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">11.把工人减少到一个。</p><p id="0cb9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">12.点击<strong class="is hj">确认</strong>返回作业页面。</p><p id="402c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">13.点击<strong class="is hj">立即运行。</strong></p><p id="8b18" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">几秒钟后，作业状态显示为<strong class="is hj">正在运行。</strong>几分钟后它应该报告<strong class="is hj">成功了。</strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/7b728308299a7402c6c6e069d0839ab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nUU5czG7fA5I2nplsskGGg.png"/></div></div></figure><h1 id="1f6f" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">清除</h1><p id="7242" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">请记住删除您的资源组，以避免产生额外成本:</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><h1 id="2d45" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">总结</h1><p id="3b5e" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">那真是一次冒险！您编写了一个笔记本，对其进行了调整，使其可以作为作业运行，并且实际上将其作为作业运行。希望这对您有所帮助。感谢阅读！</p></div></div>    
</body>
</html>