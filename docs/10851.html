<html>
<head>
<title>Improving accuracy using deep learning for Fashion MNIST</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习提高时尚MNIST的准确性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/improving-accuracy-using-deep-learning-for-fashion-mnist-d7a3516af347?source=collection_archive---------4-----------------------#2020-11-05">https://medium.com/analytics-vidhya/improving-accuracy-using-deep-learning-for-fashion-mnist-d7a3516af347?source=collection_archive---------4-----------------------#2020-11-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8a35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将介绍如何使用深度学习来改善分类任务的结果。</p><h2 id="901b" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">深度学习框架</h2><p id="a7bd" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">我将使用<a class="ae kd" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> Pytorch </a>库来实现。我们可以使用<a class="ae kd" href="https://www.anaconda.com/" rel="noopener ugc nofollow" target="_blank">康达</a>按照这个链接安装。</p><div class="ke kf ez fb kg kh"><a href="https://pytorch.org/get-started/locally/" rel="noopener  ugc nofollow" target="_blank"><div class="ki ab dw"><div class="kj ab kk cl cj kl"><h2 class="bd hj fi z dy km ea eb kn ed ef hh bi translated">PyTorch</h2><div class="ko l"><h3 class="bd b fi z dy km ea eb kn ed ef dx translated">选择您的首选项并运行安装命令。稳定代表了当前测试和支持最多的版本…</h3></div><div class="kp l"><p class="bd b fp z dy km ea eb kn ed ef dx translated">pytorch.org</p></div></div><div class="kq l"><div class="kr l ks kt ku kq kv kw kh"/></div></div></a></div><h2 id="6718" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">玩具数据集</h2><p id="0cd0" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">我选择了时尚MNIST作为玩具数据集。使用这个数据集，我将尝试从基线改善结果。我们可以从这里得到这个数据集。</p><div class="ke kf ez fb kg kh"><a href="https://www.kaggle.com/zalando-research/fashionmnist" rel="noopener  ugc nofollow" target="_blank"><div class="ki ab dw"><div class="kj ab kk cl cj kl"><h2 class="bd hj fi z dy km ea eb kn ed ef hh bi translated">时尚MNIST</h2><div class="ko l"><h3 class="bd b fi z dy km ea eb kn ed ef dx translated">一个类似MNIST的数据集，包含70，000张28x28的时尚图片</h3></div><div class="kp l"><p class="bd b fp z dy km ea eb kn ed ef dx translated">www.kaggle.com</p></div></div><div class="kq l"><div class="kx l ks kt ku kq kv kw kh"/></div></div></a></div><p id="e704" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从该链接下载以下内容</p><div class="ke kf ez fb kg kh"><a href="https://www.kaggle.com/zalando-research/fashionmnist/download" rel="noopener  ugc nofollow" target="_blank"><div class="ki ab dw"><div class="kj ab kk cl cj kl"><h2 class="bd hj fi z dy km ea eb kn ed ef hh bi translated">你的数据科学之家</h2><div class="ko l"><h3 class="bd b fi z dy km ea eb kn ed ef dx translated">Kaggle是世界上最大的数据科学社区，拥有强大的工具和资源来帮助您实现您的数据…</h3></div><div class="kp l"><p class="bd b fp z dy km ea eb kn ed ef dx translated">www.kaggle.com</p></div></div></div></a></div><p id="6cbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将获得一个archive.zip文件。从这些文件中，我们需要以下文件</p><p id="4861" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">fashion-mnist_train.csv</p><p id="3cb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">fashion-mnist_test.csv</p><p id="5720" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是数据集【https://github.com/zalandoresearch/fashion-mnist T4】的解释</p><p id="922b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是数据集中的样本图像</p><figure class="kz la lb lc fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ky"><img src="../Images/6d69f990be0234a75d9805f76ef8672e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNLB2jtcfb_xTqgQd9ntJA.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">时尚MNIST数据集</figcaption></figure><h2 id="eda4" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">基础模型</h2><p id="2fa3" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">让我们尝试简单的3层神经网络作为我们的基础模型，然后尝试用深度学习的新方法来改进它。</p><p id="a904" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个简单的三层网络示例。</p><figure class="kz la lb lc fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ln"><img src="../Images/51a7463ea946c089f88915f970b038ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VGUn13OmQ0FV0Dq4.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">3 —层网络礼遇:<a class="ae kd" href="http://deeplearning.stanford.edu/tutorial/supervised/MultiLayerNeuralNetworks/" rel="noopener ugc nofollow" target="_blank">http://deep learning . Stanford . edu/tutorial/supervised/MultiLayerNeuralNetworks/</a></figcaption></figure><h2 id="0cd8" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">加载数据</h2><p id="6309" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">以下是加载时尚MNIST数据集的代码</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h2 id="b1a0" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">基础模型编码</h2><p id="7be3" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">现在让我们编码一个基本的3层神经网络并训练它。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="bdf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行此代码后，您将获得如下测试集的准确性</p><figure class="kz la lb lc fd ld er es paragraph-image"><div class="er es lq"><img src="../Images/bb648bbcca73b71b3b5d8c70d33c61a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*45O5chZWTI6ZQCPAmrTiCA.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">3层神经网络精度</figcaption></figure><p id="68fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们的基本模型有74.5%的准确率。该模型有235，146个参数。让我们试着用改进来战胜它。</p><h2 id="acc2" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">LeNet</h2><p id="136c" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">现在让我们使用名为<a class="ae kd" href="https://en.wikipedia.org/wiki/LeNet" rel="noopener ugc nofollow" target="_blank"> LeNet </a>的深度学习模型来提高我们基本模型的性能。这是LeNet的基本架构</p><figure class="kz la lb lc fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lr"><img src="../Images/fde9e7e7e09f36750ca190a1738f276a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*APM9jcAOQCIudvse.jpg"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">LeNet架构</figcaption></figure><p id="8ac5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请参考<a class="ae kd" href="https://en.wikipedia.org/wiki/LeNet" rel="noopener ugc nofollow" target="_blank">维基文章</a>获取解释</p><p id="541d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是LeNet模型代码</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="18b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里只有44426个参数，我们得到的准确率是87.2%！</p><figure class="kz la lb lc fd ld er es paragraph-image"><div class="er es ls"><img src="../Images/a2059a1bdc673079585b8f76b4b7fd9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*TzmLqmuQDoMLU9mp5rsHkw.png"/></div></figure><h2 id="6e32" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">激活单元</h2><p id="3b07" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">现在让我们尝试改进LeNet模型。最近的进步是名为<a class="ae kd" href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)" rel="noopener ugc nofollow" target="_blank"> ReLU </a>的新激活单元。让我们用ReLU代替Tanh，看看精度如何提高。</p><p id="13fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是代码</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="7497" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得到了88.24%的准确率。这是相当大的进步！</p><figure class="kz la lb lc fd ld er es paragraph-image"><div class="er es ls"><img src="../Images/6455efb5d6483cb5013192e297bf16be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*f5fXY0HEUncWJDpQ4jXkhA.png"/></div></figure><h2 id="8982" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">批量标准化</h2><p id="cee4" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated"><a class="ae kd" href="https://en.wikipedia.org/wiki/Batch_normalization" rel="noopener ugc nofollow" target="_blank">批量规格化</a>是一种技术，用于在将输入层发送到下一层之前，通过重新定心和重新缩放来规格化输入层。</p><p id="ef62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们添加批处理规范化，看看它是否能改善结果。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="01e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果是</p><figure class="kz la lb lc fd ld er es paragraph-image"><div class="er es lq"><img src="../Images/5c1794fcbfa6ca100ce457130a302b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*KsxHy2yYGKahrXRhT6c-eA.png"/></div></figure><p id="fbef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了！我们将其提高到89.6%，而没有增加任何参数。</p><h2 id="88d8" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">做大！！</h2><p id="9b4d" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">现在让我们扩大网络，看看它是否能改善结果。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="f7b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果是…</p><figure class="kz la lb lc fd ld er es paragraph-image"><div class="er es lt"><img src="../Images/38eff585da8deef9cff1b260bd69af07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*V_nziz4eq0eQlSmVbxM9GQ.png"/></div></figure><p id="5a93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">酷，我们用85，918个参数达到了91.3%。仍然优于235，146个参数的基线。</p><p id="6496" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，模型的一些调整得到了更多的改进。</p><ul class=""><li id="d64d" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated">使第2层的内核大小从5变为3。112，286个参数和91.4%</li><li id="57d6" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">使第1层到第3层的内核大小从5。154，270个参数和92.5%</li><li id="2ff1" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">制作1层到32层和2层到64层的输出通道。306，622个参数和94.0%</li></ul><p id="8387" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太神奇了！我们利用酷炫的深度学习模型和技术，将准确率从74.5%提高到94.0%。</p><p id="5b68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是参数与精度的关系图</p><figure class="kz la lb lc fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es mi"><img src="../Images/a87ab3bc6419454c128134246057c69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03d9rW6ijj47-bfNAYxnLQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">时尚MNIST改进</figcaption></figure><p id="fe3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有更多的参数需要优化，更多的模型需要探索。请调整，让我知道你们能拿出什么。我很好奇！</p><p id="0235" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再见了。</p></div></div>    
</body>
</html>