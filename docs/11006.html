<html>
<head>
<title>AI Setup Automation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人工智能设置自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ai-setup-automation-8b578ff127c6?source=collection_archive---------25-----------------------#2020-11-12">https://medium.com/analytics-vidhya/ai-setup-automation-8b578ff127c6?source=collection_archive---------25-----------------------#2020-11-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5bc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">一、简介:</strong>数据科学领域的难点工作之一是安装GPU驱动、AI库、env setup。这是流程的第一步，没有成功的设置，我们无法前进。需要有耐心，并排除各种错误，以完成一个成功的设置。假设在一个系统中设置东西需要这么多时间和耐心，那么想象一下在多个系统中设置同样的东西有多困难。在我们的公司，我们可能已经看到软件更新，安全补丁更新是通过使用ansible或网络方法的自动化方式完成的，但没有软件或工具在机器中进行人工智能设置。在这篇博客中，我非常兴奋地分享自动化环境设置、版本控制、库安装、验证、更新、依赖库安装和调度的过程。让我们进入细节…</p><p id="7e29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关键词:</strong> ML库，AI设置，自动安装，CUDA，Nvidia GPU，anaconda，pip，cronjob，子进程</p><p id="1c87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其余博客分为:<br/> II。配置<br/>三。实施<br/>四。验证<br/>五、调度</p><p id="e78c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">二。配置:</strong>我们创建了一个JSON文件，这是一个主文件，包含所有必需的库、版本、测试脚本路径、安装后重启选项、安装状态、验证状态、安装程序信息(是pip还是anaconda)、环境名称、环境中的python版本。为每个深度学习框架(例如TensorFlow、PyTorch、Caffe、Keras和mxnet)创建单独的环境是一个很好的做法，因为一个框架依赖关系可能与其他框架不兼容，而且每个框架都需要不同的Cuda版本，因此在一个环境中不可能有相同的不同Cuda版本。</p><p id="7288" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用了一个配置python文件来存储python可执行路径、env文件夹、JSON文件、日志文件、报告文件和日志级别状态的位置。这是主进程使用的重要文件，主进程在进程开始时加载所有细节。创建一个文件夹来存储每个库的测试脚本。JSON文件中提到了文件和函数名的位置，以便主进程可以加载脚本。</p><p id="10ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">三世。实现:</strong>核心逻辑的实现写在主文件中。在第一步中，我们验证了日志文件是否被创建。如果未创建文件，则创建一个日志文件，设置日志级别状态。日志级别的状态值将来自配置文件。python中有不同的日志级别，它们是调试、信息、警告、错误和关键。根据上下文，我们可以选择任何日志级别。下一步，我们验证提供的JSON文件是否有效。验证JSON的格式、键名和提供的值。如果验证成功，执行将进入下一步，否则将停止执行，并在日志和状态文件中记录错误。</p><p id="b90e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经编写了创建虚拟环境的函数，正如前面讨论的那样，将为每个深度学习框架创建每个环境。在创建之前，进程检查env是否存在，如果不存在，它将创建一个新的环境。Python版本、环境名称、作为环境创建的一部分传递给进程的安装程序信息。用于env创建的子流程，当在不同的环境中执行时，不可能切换到不同的环境。子流程允许我们在主任务中执行任务，允许我们输入标志值，能够捕获和引发错误，阅读<a class="ae jd" href="https://docs.python.org/3/library/subprocess.html" rel="noopener ugc nofollow" target="_blank">本</a>了解有关子流程的信息。使用标志向流程输入“是”或“否”选项。标志用于向输入提供值，它避免了手动输入。这是为什么在自动化中大量使用标志的主要原因之一。创建了一个状态文件来跟踪包名、版本、状态、环境名、验证状态等等。该文件不同于日志文件，它仅用于生成状态报告。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/47cee5dd8feebbd65dc8d912d546fbdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BmOvEFdh5-aJdt8TKylD6g.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">(1)环境创建命令</figcaption></figure><p id="995b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦验证和初始化完成，我们就转移到主函数执行部分。将JSON文件加载到内存中，逐个读取环境，以及它们的包列表和状态。已验证软件包状态是否为空，如果为空，则安装软件包，否则将跳过该软件包并选择另一个软件包。安装时，我们检查了源安装程序，如果是pip，则不需要发送标志“y ”,因为pip将默认采用yes值，如果是conda，则需要发送标志值，因为conda不采用默认值。如果JSON文件中提供的版本没有添加版本，则在安装命令中添加版本，这样它将自动安装最新发布的版本。从JSON文件中读取依赖项值，如果值为“no ”,则在安装命令中添加“no-deps”标志，这样就不会安装任何依赖项。分配给安装程序的默认“是”值。建议安装依赖项，因为大多数python包都需要依赖项，没有依赖项包无法正常工作。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/5419b68ebf49950cb5a112e97eb0fbb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DZ5gy970CTXSd6c8PSY9tA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">(2)no-deps标签的使用。conda包安装命令。</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jv"><img src="../Images/4b5dba914340f1e07720aba73117e3a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-SIVIlz79hFz3-a_VXK9A.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">(3)非deps标签的使用。pip包安装命令。</figcaption></figure><p id="60c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦软件包被安装，我们更新为“成功”。所有具有“成功”状态的包都被移动到验证部分。如果有任何软件包无法安装，我们实现了计数器逻辑。计数器逻辑将按照配置文件中指定的次数重新尝试安装，这是为了避免因网络、服务器和负载而频繁发生错误。深度学习框架需要Cuda工具包cudnn来有效利用GPU。因此，在安装DL框架Tensorflow、Pytorch、Caffe、Keras、Mxnet时，要确保安装了正确的Cuda版本。Conda安装程序安装Dl框架和所需的Cuda工具包。这是anaconda的主要优势之一，也是anaconda比pip更受数据科学相关作品欢迎的原因。参考<a class="ae jd" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html" rel="noopener ugc nofollow" target="_blank"> CUDA </a>链接，了解更多关于CUDA及其使用案例的信息。</p><p id="7af2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">四世。验证:</strong>检查包安装状态的最好方法是用测试脚本进行验证。我们已经为每个AI库创建了一个测试脚本，这个测试脚本的主要操作是执行一个小的演示并返回执行状态。如果测试脚本成功运行，则返回true，否则返回false。软件包会一个接一个地安装，所以每当新的软件包安装时，我们都会验证该软件包的测试脚本和所有以前安装的软件包，这样我们就能知道是哪个软件包导致了错误。成功验证后，我们将状态更新为“已验证”。无论哪个包测试脚本失败，我们都将状态更新为“失败”，因此它们将在下次执行时重新安装并重新测试。</p><p id="5647" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> V .调度:</strong>这个工具可以根据需要灵活地进行调度，为了避免手动运行的负担，我们实现了这个功能。在每一步之后，我们都更新了状态，所以无论执行多少次，都不会重新安装已安装和已验证的包，只会安装已卸载或失败的包。对于基于Unix的计算机，使用init directory或cronjob调度作业有不同的方法。我们通过提供时间、日期和周期，使用cronjob创建了一个作业。所以每当有新的更新时，只需更新JSON文件，调度程序就会安装新的更新。</p><p id="a796" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">六世。结论:</strong>市场上有许多软件工具可用于安装和更新软件，但用于完全自动化人工智能设置的工具有限或没有。我花了很多精力来开发这个产品，希望这个新工具对数据科学家、Ml工程师和IT团队有很大帮助。</p><p id="06ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请在评论区告诉我你的观点、想法和问题。快乐学习😊….</p></div></div>    
</body>
</html>