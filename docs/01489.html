<html>
<head>
<title>Indian driving dataset: Instance Segmentation with Mask R-CNN and Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">印度驾驶数据集:使用掩模R-CNN和张量流的实例分割</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/indian-driving-dataset-instance-segmentation-with-mask-r-cnn-and-tensorflow-b03617156d44?source=collection_archive---------4-----------------------#2019-10-26">https://medium.com/analytics-vidhya/indian-driving-dataset-instance-segmentation-with-mask-r-cnn-and-tensorflow-b03617156d44?source=collection_archive---------4-----------------------#2019-10-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/da4066f4111f4561b966d18616331f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WgHZPHhkeLFdVelm5Gu8Ig.png"/></div></div></figure><p id="e946" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">印度的道路混乱、危险，人类很难掌握。对于让一些自动驾驶成为可能的算法来说，这甚至更难，因为没有足够的印度路况数据可供学习。</p><p id="d8da" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但这种情况即将改变。IIIT-海德拉巴大学的一名计算机视觉科学家和他的团队已经准备好了世界上第一个印度驾驶状况的公共数据集(也是同类中最大的数据集)，该大学是该国24个国际信息技术研究所之一。目前正在公开的数据集将帮助世界各地的计算机视觉研究人员根据印度的驾驶条件训练他们的算法，最终找到可以使道路更加安全的解决方案。</p><p id="87e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">内容:</strong></p><ol class=""><li id="6b59" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">简介数据集</li><li id="fde9" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">细分类型</li><li id="014c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">屏蔽R-CNN</li><li id="cdb7" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">装置</li><li id="688b" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">OpenCV和屏蔽图像中的R-CNN</li><li id="b521" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">在Python中实现掩码R-CNN</li><li id="314e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">COCO配置</li><li id="f53f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建模型并加载训练过的重量</li><li id="9b43" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">类名</li><li id="a28a" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">在IDD上执行屏蔽R-CNN</li><li id="72fc" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">Mask R-CNN可以实时运行吗？</li><li id="9da5" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">摘要</li></ol><h1 id="e3a5" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 1。简介</strong></h1><p id="7222" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">该项目由英特尔(<a class="ae lf" href="https://www.intel.ai/iiit-hyderabad-and-intel-release-worlds-first-dataset-for-driving-in-india/" rel="noopener ugc nofollow" target="_blank">链接</a>)资助，于2017年11月与特伦甘纳邦和卡纳塔克邦政府合作启动。IIIT·海德拉巴的团队开车绕过海德拉巴和本加卢鲁，这两个地区因交通拥堵而闻名。</p><p id="15dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个数据集中有不同的标签。但是我们的数据规模更大，由10，004个带有精细实例级边界的标记图像组成</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/5094340675a57b973d55f2ca3c334147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0GLlxih422Gfjh-ozIQ3w.png"/></div></div></figure><p id="e05b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">城市景观中的道路边界非常明确，通常两侧都有护栏或人行道。然而，在我们的环境中情况并非如此。道路两侧可能有泥泞的地形，但在某种程度上也是可驾驶的。道路本身可能会被泥土覆盖，使得界限非常模糊。另一方面，城市景观模型通常会识别道路旁边的平坦区域，这些区域不需要像道路一样安全驾驶。</p><div class="lh li lj lk fd ab cb"><figure class="ll ij lm ln lo lp lq paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/89cf6a950a1a70978fef8afc84fcb7c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*JOHKAtuNXvg8dwSiDB9rAQ.png"/></div></figure><figure class="ll ij lr ln lo lp lq paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/0e853a466235e7dfcc54a2ef2d31e477.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*49MYSXrscdxNU2vzpf58Zg.png"/></div></figure></div><p id="4414" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些数据是从印度的班加罗尔和海德拉巴及其郊区收集的。这些位置混合了城市和农村地区、高速公路、单车道和双车道道路，交通状况各不相同。由于多种原因，这些地区的驾驶条件非常不规范。</p><h1 id="3982" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">2.细分类型？</h1><p id="915b" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">实例分割是在像素级识别对象轮廓的任务。与类似的计算机视觉任务相比，这是最难的视觉任务之一。考虑以下问题:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/f72c095b91ab09e0c061d71cc642d38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ri3dfxm6NQ_zi7LJW8inyw.png"/></div></div></figure><ul class=""><li id="8a39" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn lt ju jv jw bi translated"><strong class="is hj">分类:</strong>本图中有一个气球。</li><li id="6d65" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><strong class="is hj">语义分割:</strong>这些都是气球像素。</li><li id="7950" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><strong class="is hj">物体检测:</strong>此图像中这些位置有7个气球。我们开始考虑重叠的物体。</li><li id="c6a0" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><strong class="is hj">实例分割</strong>:这些位置有7个气球，这些是属于每一个的像素。</li></ul><h1 id="ca82" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">3.屏蔽R-CNN</h1><p id="ac65" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">掩模区域卷积神经网络(R-CNN)是更快的R-CNN对象检测算法的扩展，增加了额外的功能，如实例分割和额外的掩模头。这允许我们在每个对象的像素级别上形成分段，并且还将每个对象从其背景中分离出来。</p><p id="857e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Mask R-CNN的框架基于两个阶段:首先，它扫描图像以生成提议；这些区域很可能包含物体。其次，它对这些建议进行分类，并创建边界框和遮罩。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/f0af309c54afbe5054ff2b88438cd11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8HCHEFiZom-l0TcOzUE6w.png"/></div></div></figure><p id="7655" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个用作特征提取器的标准卷积神经网络(通常为ResNet101)。早期的层检测低级特征(边缘和拐角)，而后期的层连续检测高级特征(汽车、人、天空)。</p><p id="d37b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过主干网，图像从1024x1024px x 3 (RGB)转换为32x32x2048形状的特征图。</p><p id="ce82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据其研究论文，与其前身fast R-CNN类似，它是一个两阶段框架:第一阶段负责生成对象提议，而第二阶段对提议进行分类，以生成边界框和遮罩。检测分支(分类和边界框偏移)和遮罩分支彼此并行运行。对特定类别的分类不依赖于掩码预测。然而，我们认为它是一个三阶段框架，盒子和掩码的生成是两个不同的阶段，因为我们不在RPN的所有建议上生成掩码，而只在我们从盒子头得到的检测上生成掩码。</p><p id="3cce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不打算详细说明Mask R-CNN是如何工作的，但这是该方法遵循的一般步骤:</p><ol class=""><li id="b0f9" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><strong class="is hj">骨干模型</strong>:标准的卷积神经网络，作为特征提取器。例如，它会将1024x1024x3的影像转换为32x32x2048的要素地图，作为后续图层的输入。</li><li id="c884" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">区域提议网络(RPN) </strong>:使用由多达20万个锚盒定义的区域，RPN扫描每个区域并预测是否有物体存在。RPN的一个很大的优点是不扫描实际的图像，网络扫描特征地图，使它更快。</li><li id="8144" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">感兴趣区域分类和包围盒:</strong>在该步骤中，该算法将RPN提出的感兴趣区域作为输入，并输出分类(softmax)和包围盒(回归量)。</li><li id="152e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">分割掩模</strong>:在最后一步中，算法将正ROI区域作为输入，并生成具有浮点值的28×28像素掩模作为对象的输出。在推断过程中，这些遮罩会按比例放大。</li></ol><h1 id="bebe" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 4。安装</strong></h1><p id="83e5" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">以下是掩码R-CNN的所有依赖项列表:</p><ul class=""><li id="0cf6" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn lt ju jv jw bi translated"><em class="lv"> numpy </em></li><li id="29f2" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> scipy </em></li><li id="38ce" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv">枕头</em></li><li id="3c7c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> cython </em></li><li id="1276" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> matplotlib </em></li><li id="1fad" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> scikit-image </em></li><li id="5239" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv">张量流&gt; =1.3.0 </em></li><li id="1056" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> keras &gt; =2.0.8 </em></li><li id="7062" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> opencv-python </em></li><li id="0c82" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> h5py </em></li><li id="2c43" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">伊姆格</li><li id="976b" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><em class="lv"> IPython </em></li></ul><p id="7c61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在使用Mask R-CNN框架之前，您必须安装所有这些依赖项。</p><h1 id="3a20" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">5.<strong class="ak"> OpenCV和屏蔽图像中的R-CNN</strong></h1><p id="c065" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">既然我们已经看到了Mask R-CNN是如何工作的，那么让我们用一些Python代码来体验一下吧。</p><p id="00b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们开始之前，确保您的Python环境安装了OpenCV 3.4.2/3.4.3或更高版本。如果您想在5分钟或更短的时间内启动并运行，您可以考虑用pip安装OpenCV。如果您有一些其他需求，您可能希望从源代码编译OpenCV。</p><h1 id="653a" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">6.在Python中实现掩码R-CNN</h1><p id="25a6" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">为了执行我将在本节中介绍的所有代码块，在克隆的Mask_RCNN存储库的“samples”文件夹中创建一个新的Python笔记本。</p><p id="d99d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从导入所需的库开始:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/986a4f09a53bbe39e29d38044da7109c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdDvz7Evu2s19ke_UKTKHQ.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">导入库</figcaption></figure><h1 id="c292" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">7.COCO配置</h1><p id="40ea" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">我们将使用在MS-COCO数据集上训练的模型。这个模型的配置在coco.py的CocoConfig类中。</p><p id="5211" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于推理，稍微修改一下配置以适应任务。为此，子类化CocoConfig类并覆盖您需要更改的属性。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/f1d72995057e7e8432015ae61075bdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9_F7cLlY3tBIlpnDbSOKQ.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">coco工具配置</figcaption></figure><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/357f223516085d5cc10ac66fd7cdd8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*LFXQGmrCPHso8QJapw_BSg.png"/></div></figure><p id="faf5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，主干是resnet101，我们之前也讨论过。该模型将返回的遮罩形状是28X28，因为它是在COCO数据集上训练的。而且我们一共81节课(包括后台)。</p><p id="ae58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还可以看到其他各种统计数据，例如:</p><ul class=""><li id="05ec" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn lt ju jv jw bi translated">输入形状</li><li id="571b" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">要使用的GPU数量</li><li id="204e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">验证步骤等等。</li></ul><p id="2e8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该花一些时间来理解这些规范。如果你对这些规范有任何疑问，欢迎在下面的评论区问我。</p><h1 id="5bde" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">8.创建模型并加载训练过的重量</h1><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/acf3793d0c53379621fc4ff1a8826cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RTTMJ_IaIWpHmyit-BU2vw.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">装载重量</figcaption></figure><p id="1c69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">modellib.maskRCNN:基本上它用于初始化mask R-CNN模型</p><p id="7cba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将创建我们的模型并加载我们之前下载的预训练权重。确保预训练的砝码与笔记本放在同一个文件夹中，否则您必须给出砝码文件的位置。</p><h1 id="1bdc" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">9.类名</h1><p id="7bce" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">该模型对对象进行分类并返回类id，类id是标识每个类的整数值。要获得类名列表，您需要加载数据集，然后像这样使用class_names属性。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/752070e022581424ec7a065d428545c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IJBuInoj-O7H3GHIPKavYA.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">类名</figcaption></figure><h1 id="73ae" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">10.在IDD上执行屏蔽R-CNN</h1><p id="505a" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">面具R-CNN是一个相当大的模型。尤其是我们的实现使用了ResNet101和FPN。所以你需要一个10GB内存的现代GPU。它可能对更少的工作，但我没有试过。我使用谷歌联合实验室来训练这个模型，鉴于数据集很小，训练时间不到一个小时。</p><p id="7749" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从IDD目录运行这个命令，开始训练。在这里，我们指定训练应该从预先训练的可可重量开始。代码将自动从我们的存储库中下载重量:</p><p id="50de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用掩模R-CNN执行一个图像分割</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/d1d1e67a3b93a208fa46404ffa18cf31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XpH4UpK69QfYt5LA5bA-xA.png"/></div></div></figure><p id="0067" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们加载一个图像，并尝试查看模型的执行情况。您可以使用您的任何图像来测试模型。图像的输入和输出是</p><div class="lh li lj lk fd ab cb"><figure class="ll ij mg ln lo lp lq paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/caed5d7b5a617e38e36d3167c50c937d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*9vIACxnnp9LmYnvpErZSWg.jpeg"/></div></figure><figure class="ll ij mh ln lo lp lq paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ec6ce86034f05d38319f05daca49a207.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*J71ao2d_DwARL0BFzDryFQ.png"/></div></figure></div><p id="8a68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们使用了掩模R-CNN模型和预训练的权重，并观察了它如何很好地分割图像中的对象。我们将首先从模型中获取预测，然后绘制结果以将其可视化。您可以看到图像是用标签名称进行实例分段的。</p><div class="lh li lj lk fd ab cb"><figure class="ll ij mi ln lo lp lq paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/62a5bb96999dde08cbe0d71aebf836cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*qWVAGslljkaJSdy2EyyyCA.jpeg"/></div></figure><figure class="ll ij mj ln lo lp lq paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ec97fc57d6bb7dc282d5dcb0a89ee62a.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*eJMjpm2mZlOxQGs39tXPPw.png"/></div></figure></div><p id="f410" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有意思。该模型在分割图像中的汽车和摩托车方面做得非常好。</p><p id="059c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用掩码R-CNN的idd数据集的gif输出</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/1bfcaa848315e69d79e3cf3809cbb183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dpNOxniGO2M9r4I3xEBCFA.gif"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">gif输出</figcaption></figure><h1 id="f343" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">11.Mask R-CNN可以实时运行吗？</h1><p id="6745" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">此时你可能想知道是否有可能实时运行Keras + Mask R-CNN，对吗？</p><p id="4c15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">是的，我们可以跑。如你所知，Mask R-CNN是基于更快的R-CNN物体探测器。更快的R-CNN在计算上非常昂贵，并且当您在对象检测之上添加实例分割时，该模型只会变得在计算上更加昂贵，因此:</p><ul class=""><li id="1392" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn lt ju jv jw bi translated"><strong class="is hj">在CPU上，</strong>一个Mask R-CNN无法实时运行。</li><li id="a741" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated"><strong class="is hj">但是在GPU上，</strong> Mask R-CNN最高可以达到5-8 FPS。</li></ul><h1 id="5c21" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">摘要</h1><ul class=""><li id="4398" class="jo jp hi is b it la ix lb jb ml jf mm jj mn jn lt ju jv jw bi translated">在印度驾驶数据集上执行实例分割。</li><li id="6f1b" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">我是用Mask_RCNN执行的</li><li id="f555" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">为了做到这一点，你需要安装一些工具</li><li id="8569" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">以及克隆用于分割的Mask_RCNN和coco工具</li><li id="ca02" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">因此，我在google colab上执行的这整个事情首先我检查了google colab上的GPU(如果它启用或不启用，如果不启用)</li><li id="32ae" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">然后我安装cython和utils</li><li id="77fe" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">克隆coco工具，安装setuptools并设置coco工具</li><li id="d6bb" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">然后克隆Mask_RCNN</li><li id="04ab" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">在此之前，您必须加载Mask_RCNN的权重</li><li id="6c9f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">之后，配置coco工具</li><li id="9a2e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">并创建模型和装载列车重量</li><li id="4b13" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">接下来我给出了类名</li><li id="5010" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">之后，我从idd数据集加载单个图像</li><li id="8c58" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">然后我们得到检测图像标签的输出</li><li id="118d" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">之后我给出了所有的图片(我已经把它们合成了视频)</li><li id="8439" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">然后它检测所有的图像</li><li id="c33f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">所以在那之后，我把它们组合成视频</li><li id="9d73" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">使用Mask_RCNN，我们可以检测所有图像标签。</li><li id="9814" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn lt ju jv jw bi translated">对于代码，我给我的github链接，请检查。</li></ul><p id="254b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">|参考</strong></p><div class="mo mp ez fb mq mr"><a href="https://github.com/ravitejarj/Instance-segmentation-on-idd-using-mask-rcnn" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hj fi z dy mw ea eb mx ed ef hh bi translated">ravitejarj/Instance-segmentation-on-IDD-use-mask-rcnn</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">屏蔽rcnn。为ravitejarj/Instance-segmentation-on-IDD-using-mask-rcnn的开发作出贡献</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">github.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf io mr"/></div></div></a></div><div class="mo mp ez fb mq mr"><a href="https://github.com/matterport/Mask_RCNN" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hj fi z dy mw ea eb mx ed ef hh bi translated">matterport/Mask_RCNN</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">这是Mask R-CNN在Python 3、Keras和TensorFlow上的实现。该模型生成边界框和…</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">github.com</p></div></div><div class="na l"><div class="ng l nc nd ne na nf io mr"/></div></div></a></div><p id="dad2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae lf" href="https://www.analyticsvidhya.com/blog/2019/07/computer-vision-implementing-mask-r-cnn-image-segmentation/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2019/07/computer-vision-implementing-mask-r-CNN-image-segmentation</a></p><div class="mo mp ez fb mq mr"><a href="https://github.com/cocodataset/cocoapi/tree/master/PythonAPI/pycocotools" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hj fi z dy mw ea eb mx ed ef hh bi translated">cocodataset/cocoapi</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">github.com</p></div></div><div class="na l"><div class="nh l nc nd ne na nf io mr"/></div></div></a></div></div></div>    
</body>
</html>