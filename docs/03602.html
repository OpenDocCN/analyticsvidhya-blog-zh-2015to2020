<html>
<head>
<title>EDA Case Study: Corporación Favorita Grocery Sales Forecasting!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">EDA案例研究:Corporación Favorita杂货销售预测！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/eda-case-study-corporaci%C3%B3n-favorita-grocery-sales-forecasting-e6801b29ed3a?source=collection_archive---------10-----------------------#2020-02-10">https://medium.com/analytics-vidhya/eda-case-study-corporaci%C3%B3n-favorita-grocery-sales-forecasting-e6801b29ed3a?source=collection_archive---------10-----------------------#2020-02-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="ig ih ii"><p id="68e6" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated">分析<strong class="im hj">数据的方法</strong>集合<strong class="im hj">来总结它们的主要特征，通常采用可视化方法。</strong></p></blockquote><p id="ce37" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">今天，我们要对一个庞大的数据集——由Kaggle   <em class="il">提供的<strong class="im hj"> <em class="il"> Corporación Favorita杂货销售额进行<strong class="im hj">探索性数据分析(EDA) </strong>。总部位于厄瓜多尔的大型杂货零售商Corporación Favorita ，他们经营着数百家超市，货架上有超过200，000种不同的产品。</em></strong></em></p><p id="8e64" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">在这个数据集中，我们必须预测<strong class="im hj">单位销售额(</strong> <em class="il">一种产品产生的总收入除以该产品在给定时间段</em> <strong class="im hj"> ) </strong>内售出的 <strong class="im hj"> <em class="il">单位总数</em> </strong> <em class="il">)，该产品在厄瓜多尔的不同Favorita商店销售数千种商品。训练数据包括日期、商店和物品信息以及物品是否被促销。</em></p><p id="54b7" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">下面，我将研究关于不同特性的观察分布。我还检查了目标变量(单位销售额)的分布是否有异常值。</p><p id="55a0" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">我在训练集和测试集中发现了一些有趣的差异，这些差异在训练模型之前值得考虑。</p><p id="9033" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">首先，导入库并将各种CSV加载到数据帧中:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es jm"><img src="../Images/5df7f374121bb7508e55d6f1bd544087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*urggrPVQnQK1XNrZoAyz-g.png"/></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es ju"><img src="../Images/196a1911e2667362ac3188ff89f2e9f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*3zsAH3wEMBQaoI6SowlODA.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">Favorita存储数据集。</figcaption></figure><h1 id="1b18" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">训练集:</strong></h1><p id="c812" class="pw-post-body-paragraph ij ik hi im b in kx ip iq ir ky it iu ji kz ix iy jj la jb jc jk lb jf jg jh hb bi translated">让我们看看训练集(df_train)</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lc"><img src="../Images/d525bc9d06cf5da7a50951e9528a0320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fxD-T0w3yBPeBQMKZlk3kg.png"/></div></figure><p id="a0db" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">训练集有<strong class="im hj"> 125，497，040(1.25亿)行</strong>和6列:行id、日期、商店编号、商品编号、单位销售额(请记住，这可以是整数、浮点数或-1，表示返回的商品)，以及特定商品是否有促销。</p><p id="e759" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">总之，我们必须处理onpromotion列中的NaN，并用更有用的列['year '，' month '，' day']替换<code class="du ld le lf lg b">date</code>列。</p><p id="899e" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated"><strong class="im hj"> df_train.fillna(0，inlace=True) —处理NaN的</strong></p><p id="b4a8" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated"><strong class="im hj"> pd。DatetimeIndex(df_train['date'])。年份—从日期中获取年份。</strong></p><p id="4c9e" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">这是从日期列中获取年、月和日，然后删除日期列(因为它现在已经没有用了)后dataframe的外观:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lh"><img src="../Images/57c55c4066612407d24bd18a69add008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*9yMn2J9ot5hsHBU7xwOvzw.png"/></div></figure><p id="2eda" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">数据集也包含store.csv和items.csv文件。让我们来了解一下他们的情况:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es li"><img src="../Images/0fd2f614d733c5e2b151d7f7772f121b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*oNTQdQ4tCY9zOVOsxYxPQQ.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">Store.csv文件</figcaption></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lj"><img src="../Images/0781dc8e459081c3befd77ba3b3d25cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*B_-ooN0T-wXR2Z0shwc3Fw.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">Items.csv文件</figcaption></figure><p id="ba6d" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">值得注意的是，数据集之间存在链接属性——在df_store、df_item和df_train之间共享“store_nbr”和“item_nbr”。在这里，你可以很容易地想到，通过使用熊猫函数<strong class="im hj"> pd.merge() </strong>方法，将它们合并到训练集(df_train)中。</p><p id="13d0" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated"><strong class="im hj"> <em class="il">“合并”两个数据集是将两个数据集合并成一个数据集，并根据公共属性或列对齐每个数据集的行的过程。</em> </strong></p><p id="f8ce" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated"><strong class="im hj"> pd.merge(df_train，df_item，on='item_nbr') </strong></p><p id="4211" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated"><strong class="im hj"> pd.merge(df_train，df_store，on='store_nbr') </strong></p><p id="983c" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">合并后，训练集看起来像这样-</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lk"><img src="../Images/24324d495d0396f2f4d51d70f2e148a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TtAlqoDgkyWwYhMNxZ6Ycw.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">合并数据集。</figcaption></figure><p id="f7ef" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated"><strong class="im hj">现在，我们绘制条形图和折线图等图形，以便更好地理解数据集。</strong></p><h1 id="015c" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">按年、月、日分析数据集:</h1><p id="3d65" class="pw-post-body-paragraph ij ik hi im b in kx ip iq ir ky it iu ji kz ix iy jj la jb jc jk lb jf jg jh hb bi translated">现在，让我们了解一下收集数据的时间范围:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lp"><img src="../Images/69d16a507be282d7dd18e9ab0833a3c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*01zdQqyzVYfRsKgc3wAJ2w.png"/></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lq"><img src="../Images/6569720c6406089798f23cb9560f9e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*qBkuttOv76Ep6X-P2Er2jg.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">x轴=年份，Y轴=单位销售额</figcaption></figure><p id="3fec" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">他们收集了2013年至2017年的数据。除了2017年，每年的观测数量都在增加，但这可能是因为它尚未结束。</p><p id="ddd5" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">让我们看看数据是如何按月分布的:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lr"><img src="../Images/ffd0b52ca6aafd4e46b938451bfc1104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*MkN_EKqoKTIHokyDXOQPjA.png"/></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es ls"><img src="../Images/631afb3a99010d024a4072a34da7308f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*F7mGxVQA2AQDXA8yXQGgew.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">x轴=月，Y轴=单位销售额</figcaption></figure><p id="1ff9" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">观测值几乎按月均匀分布。最高值出现在12月，最低值出现在2月。按一个月中的某一天怎么样？</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lt"><img src="../Images/6c0b976db1bd9c7f0efd152907069674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*jE6XEGF9elmaRXYpJ68owg.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">x轴=天数，Y轴=单位销售额</figcaption></figure><p id="0d0b" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">同样，观测值在一天中几乎是均匀分布的。</p><h1 id="ea47" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">店铺:</strong></h1><p id="8f8d" class="pw-post-body-paragraph ij ik hi im b in kx ip iq ir ky it iu ji kz ix iy jj la jb jc jk lb jf jg jh hb bi translated">现在，让我们确定有多少个商店以及每个商店的观察分布。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lu"><img src="../Images/ec162e1cd5d428ae589699a226898ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qiHCXJ6ry-LMokUyufAGxA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">每个商店的观察分布。</figcaption></figure><p id="ff4f" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">使用<strong class="im hj"> unique() </strong>方法可以发现数据集中有54个商店。这个情节的解读如下。y轴是对应于特定悬挂物的观察次数。观察多的店不一定比观察少的店表现好。这是因为一些商店可能提供更广泛的产品，但推量较少。这将夸大他们在这个阴谋中的数字。我们可以将y轴解释为商店种类的度量。</p><h1 id="95c9" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">项目:</h1><p id="852d" class="pw-post-body-paragraph ij ik hi im b in kx ip iq ir ky it iu ji kz ix iy jj la jb jc jk lb jf jg jh hb bi translated">现在让我们对项目进行分析。根据易腐物品和不易腐物品的数量绘制图表。还可以看看产品系列。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lv"><img src="../Images/8f5e5ed0482147a8d7ea9b9cdfd08e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FNPv6JXAYWj29eFCeVcU6A.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">x轴=易腐物品，y轴=物品数量</figcaption></figure><p id="2368" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">0 =非易腐物品，1 =易腐物品。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lw"><img src="../Images/8630d7d368716f60d4eef1fec4a361fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*8kJgMP15oihHQDA9d318iw.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">x轴=系列，y轴=项目数量</figcaption></figure><p id="7f35" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">总之，商店里有大量与食品杂货相关的不易腐烂的物品。</p><h1 id="a85f" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">促销:</h1><p id="832e" class="pw-post-body-paragraph ij ik hi im b in kx ip iq ir ky it iu ji kz ix iy jj la jb jc jk lb jf jg jh hb bi translated">现在，让我们找出优惠券剪购买了多少物品。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lx"><img src="../Images/0505ad808ba8906466e5e62492cc98e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*Zequp5BDubu-DEER4pTONg.png"/></div></figure><p id="7a89" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">约<strong class="im hj"> 6.22% </strong>的商品是在促销时购买的。</p><p id="d8dd" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">这里我们已经填充了空值，并将onpromotion列转换为分类数据，其中<strong class="im hj"> 0=NaN的值，1=False(没有商品促销), 2=True。</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lv"><img src="../Images/52b9f65b77b0b93048d26203853a9733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjLk74psnzbgonPdMJun3A.png"/></div></div></figure><h1 id="6626" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">城市和州:</h1><p id="4dec" class="pw-post-body-paragraph ij ik hi im b in kx ip iq ir ky it iu ji kz ix iy jj la jb jc jk lb jf jg jh hb bi translated">让我们了解一下州和城市列的信息。我们已经通过使用标签编码将城市和州转换成分类数据。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es ly"><img src="../Images/9baa2bd1a6ce33d144026100b985e30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*QL-RcJCbUkKYVYFjgfanBQ.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">x轴=城市编号，y轴=单位_销售额</figcaption></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lz"><img src="../Images/1d57305aa4d52e12120c12a750af9dcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*k1IJyC4jATMUt-MhcHJhAA.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">x轴=州号，y轴=单位销售</figcaption></figure><p id="9758" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">城市和州列形成了几乎相似的图形。由此，我得出结论，我们可以在最终的训练集中删除state列。从数据集中删除列完全取决于个人感知和目标变量对该列的依赖。</p><h1 id="5e6e" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">结论:</h1><p id="4556" class="pw-post-body-paragraph ij ik hi im b in kx ip iq ir ky it iu ji kz ix iy jj la jb jc jk lb jf jg jh hb bi translated">我们查看了训练集中的观察结果是如何按日期、商店、商品和促销分布的。我们还更加熟悉了目标值单位销售额的分布，这可能需要进行处理以消除异常值。</p><p id="f361" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">我们可以得出结论，年月日列非常重要。为了更好地理解，有必要将日期转换为日期时间。您还可以对数据集样本执行EDA，只需取出样本年份并绘制图表。同样，您可以对测试数据集进行分析。</p><p id="bc1b" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu ji iw ix iy jj ja jb jc jk je jf jg jh hb bi translated">在未来，我计划探索其他数据集。感谢阅读！</p></div></div>    
</body>
</html>