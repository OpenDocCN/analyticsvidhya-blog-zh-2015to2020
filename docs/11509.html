<html>
<head>
<title>Implementing different CNN Architectures on Plant Seedlings Classification dataset — Part 2 (AlexNet)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在植物幼苗分类数据集上实现不同的 CNN 架构—第 2 部分(AlexNet)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implementing-different-cnn-architectures-on-plant-seedlings-classification-dataset-part-2-8db1c3ad4865?source=collection_archive---------18-----------------------#2020-12-06">https://medium.com/analytics-vidhya/implementing-different-cnn-architectures-on-plant-seedlings-classification-dataset-part-2-8db1c3ad4865?source=collection_archive---------18-----------------------#2020-12-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="b98a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我之前的<a class="ae jk" rel="noopener" href="/analytics-vidhya/implementing-different-cnn-architectures-on-plant-seedlings-dataset-to-get-a-good-score-part-1-a90c2d3f306f">文章</a>中，我研究过植物幼苗数据集，因为它是一个竞赛数据集，我们可以在那里提交我们的预测并检查我们的分数。这是测试我们模型的好方法。我们实现了<strong class="io hj"> LeNet </strong>架构，但只能得到 29.77%的分数。首先，这很好，但我们确实需要提高我们的模型性能。为了实现这一点，我想实现一些 CNN 架构，比如<strong class="io hj"> Alexnet </strong>、<strong class="io hj"> VGG </strong>、<strong class="io hj"> Inceptionv3 </strong>和<strong class="io hj"> Xception </strong>。因为，我们理解理论和实际实现是非常重要的。作为计算机视觉的初学者，这一系列文章的目的是让我们想出处理图像分类问题的最佳策略，这样随着我们的进步，我们将逐渐看到代码变得更加复杂。</p><p id="d2a5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我几乎无法从头开始训练<strong class="io hj"> AlexNet </strong>，但是对于其余的架构(<strong class="io hj"> VGG </strong>、<strong class="io hj">盗梦空间</strong>、<strong class="io hj">除了</strong>)，我不得不使用预先训练好的模型。我们将详细介绍预训练模型的含义以及它对我们的益处。</p><p id="0a32" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我不会对这些架构进行深入的解释，而是简单的介绍，然后是实际的代码。</p><p id="84b7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以，让我们从 AlexNet 开始:</p><ol class=""><li id="d82b" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jq jr js jt bi translated">AlexNet :它最初是由 Alex Krizhevsky 设计的。它是与<strong class="io hj">伊利亚·苏茨基弗</strong>和克里热夫斯基的博士导师<strong class="io hj">杰弗里·辛顿</strong>一起发表的，是一个卷积神经网络或 CNN。</li></ol><ul class=""><li id="93f6" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">在参加 ImageNet 大规模视觉识别挑战赛后，AlexNet 一举成名。它实现了 15.3%的前 5 名误差。这比亚军低了 10.8%。</li><li id="9c98" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">原始论文的主要结果是，模型的深度对于其高性能是绝对必要的。这在计算上非常昂贵，但在训练期间，由于 GPU 或图形处理单元，这是可行的。</li><li id="b20c" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我们现在将尝试从头开始实现该架构。我将遵循我上次遵循的相同步骤。</li><li id="c774" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我首先下载数据，这是一个 zip 文件，然后提取内容。我看到有三个文件夹:'<strong class="io hj"> <em class="ka">训练</em> </strong>'，'<strong class="io hj"> <em class="ka">测试</em> </strong>'和'<strong class="io hj"> <em class="ka">样本提交. csv </em> </strong>'。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kb"><img src="../Images/516e99541e4417646da79ff81fba638c.png" data-original-src="https://miro.medium.com/v2/resize:fit:76/0*oy5LV_y1jOAHe-QM"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es kj"><img src="../Images/5bd83169ad04d17fc036cd1dd1fa9656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WB5dhEazRnLeC1Q8.png"/></div></div></figure><p id="f13b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">植物幼苗数据</p><ul class=""><li id="d839" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">然后我检查了'<strong class="io hj">列车</strong>'数据文件夹，看到有 12 个不同的类别。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ko"><img src="../Images/ca9ccc1ad7cd5a0627133704fb007cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/0*9CRnE2UysBavBOI4.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">植物幼苗数据内的不同类别</figcaption></figure><ul class=""><li id="00e2" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">我手动检查了每个文件夹中的不同项目，发现一些类与其他类相比有更多的图像。</li><li id="e7b8" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">这是令人担忧的，因为我知道模型会偏向数量更多的图像。</li><li id="adf6" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">为了解决这个问题，我创建了一个新的 train 文件夹，从每个类中复制了 200 张图片。</li><li id="e090" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">然后我创建了一个验证集，里面有来自每个类的 20 张图片。这样，我就防止了不必要的偏见在模型中蔓延。</li><li id="d33d" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我首先导入所有的包。我用的是 Tensorflow-gpu 1.15 和 Keras 2.3.1</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kt"><img src="../Images/22ef1d288b1fbbbfcc83829280cd250d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/0*W8pS1KJaki0aZ9df.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">导入所有包</figcaption></figure><ul class=""><li id="2c92" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">然后，我使用图像数据生成器来创建我的训练和验证集。这将处理所有需要训练数据和标签的预处理步骤。这包括标准化，增加一些剪切和缩放范围，以创建一定程度的数据扩充。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ku"><img src="../Images/027945e626a21710c0bbc28531d71af7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHYuKhnlBpbBpZjDpVlR5g.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">使用图像数据生成器创建训练和验证集。</figcaption></figure><ul class=""><li id="9a8c" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">数据设置好后，我创建了 AlexNet 模型:</li><li id="1e69" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">它由五个卷积层组成，中间是最大池化和批标准化层，后面是三个完全连接的层。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es kv"><img src="../Images/1b019e0da5d4a6986bbe6475cc553b1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VLs7OzDjQH9mBBhrYEMooA.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">AlexNet 的卷积层</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es kw"><img src="../Images/388fa9c55701819ba769bde72162f6c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nzo_TX7e-TvwLIXIL4elag.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">AlexNet 的全连接层</figcaption></figure><ul class=""><li id="21f2" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">然后，我使用'<strong class="io hj"> SGD </strong>'作为我的优化器，具有学习率和衰减。</li><li id="29ae" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">因为，有 12 个类，我用，'<strong class="io hj">分类 _ 交叉熵【T5 ' '，作为我的损失。</strong></li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es kx"><img src="../Images/b53e60beca2aab22c1fcb108dcfca12d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2iwnpNQJu_iudxT5MzISiA.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">初始化学习率，设置衰减和优化器</figcaption></figure><ul class=""><li id="c65a" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">然后，我对'<strong class="io hj"> 15 </strong>时期的模型进行训练，训练步骤为'<strong class="io hj"> 500 </strong>'，验证步骤为'<strong class="io hj"> 300 </strong>'。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ky"><img src="../Images/e79c2586a845208e74e36ce872542580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mivYGTvLwqU0_HgDGfEPTg.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">损失和准确性的模型训练</figcaption></figure><ul class=""><li id="5f30" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">根据上面的图像，我们可以确认我们的训练准确率稳步上升到 81%,我们的验证准确率也达到 80%</li><li id="f752" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">这很好，这意味着我们的模型没有过度拟合。</li><li id="1fa3" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">保存模型后，我在测试集上使用它，并生成一个 sample_submission.csv 文件，其中包含 ID 和适当的类。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es kz"><img src="../Images/d484c36ca9245ea82599c5cca2d2e10b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sUx480lWkAZ0ZYzC.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">将模型保存到磁盘并加载模型进行预测</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es la"><img src="../Images/0b877c8f6a29d86f2ba99f73dd857012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ba6C6eMa3-WkB4Eu.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">加载模型并将其用于预测</figcaption></figure><ul class=""><li id="9812" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">基于上面的图像，我使用模型开始对测试集进行预测。</li><li id="cd53" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我使用 glob 库获得所有文件的列表，然后遍历它们，将图像的名称附加到一个名为“IDs”的空列表中。</li><li id="b77c" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">然后我加载图像，将其转换为数组，然后使用' expand_dims '来展平数组。</li><li id="10e5" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">然后我用我的模型做预测，它以数组的形式出现。对于 ex: [[0，0，0，1，0，0，0，0，0，0，0，0]]</li><li id="f68d" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我使用“If-Else”条件来获取各种类，并将它们附加到一个名为“Preds”的空列表中。</li><li id="485b" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我现在使用“Ids”和“Preds”来创建我的“sample_submission.csv”文件。</li><li id="8c1c" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我们现在需要将此文件上传到“<a class="ae jk" href="https://www.kaggle.com/c/plant-seedlings-classification/submit" rel="noopener ugc nofollow" target="_blank">植物幼苗分类</a>网站，以进行预测。</li><li id="2040" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">为此，请转到<a class="ae jk" href="https://www.kaggle.com/c/plant-seedlings-classification/overview" rel="noopener ugc nofollow" target="_blank">植物幼苗分类</a>，点击<strong class="io hj">迟交</strong>。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kb"><img src="../Images/61106353948cb2c44761f2c5092067bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:76/0*8YpP13OqYmRjAYlQ"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es lb"><img src="../Images/60f84a067b12bc65bb24b94ccb55feb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G_jK7f-l3UnA33ZC.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">延迟提交选项卡</figcaption></figure><ul class=""><li id="9681" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">当你点击<strong class="io hj">延迟提交</strong>时，你会看到一个上传文件的选项。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es lc"><img src="../Images/1fbb2b2218624f853c6bf14ab9123b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a_fYbywh5xBaIwdb.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">上传文件以获得分数</figcaption></figure><ul class=""><li id="2728" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">文件上传后，点击<strong class="io hj">提交</strong>，即可获得分数。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ld"><img src="../Images/619d5298e468a7a842fac7504f8784e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/0*cJaUL-sUXA98eQLw.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">上传文件并提交</figcaption></figure><ul class=""><li id="2aa3" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">因此，我得到了大约 12.8%的分数，这意味着，我只能正确预测 100 分中的 12 张图像。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es le"><img src="../Images/6c3fd7ed5154ce63e4465ac9fa4392e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ls12IDkK0-EBiWUE05rntQ.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">预测的分类分数</figcaption></figure><ul class=""><li id="15b8" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj ju jr js jt bi translated">因此，我们看到 AlexNet 与 LeNet 相比表现不佳，</li><li id="ea9e" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">即使 AlexNet 运行了更多的纪元，它仍然没有提供与 LeNet 相同的准确性。</li><li id="b262" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我们可以进行一些超参数调整，例如，增加时期、更改图像的输入大小、更改优化器、更改批处理大小，以检查其对预测的影响。</li><li id="23ca" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我把这个选项留给读者。请让我知道你是否能通过改变一些超参数来改变分数。</li><li id="d563" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">在下一个系列中，我们将使用一些预先训练好的模型，如“VGG”、“概念网”和“例外网”来检查我们的预测分数。</li><li id="d660" class="jl jm hi io b ip jv it jw ix jx jb jy jf jz jj ju jr js jt bi translated">我还将经历一些“超参数”调整代码，这样一旦我们有了一个给我们带来良好准确性的模型，我们就可以调整它以获得最佳结果。</li></ul></div></div>    
</body>
</html>