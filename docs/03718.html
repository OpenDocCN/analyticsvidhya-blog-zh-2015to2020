<html>
<head>
<title>Linear Regression on Bangalore House Price Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">班加罗尔房价预测的线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basic-application-of-linear-regression-on-bangalore-house-price-prediction-18a128a49c96?source=collection_archive---------4-----------------------#2020-02-15">https://medium.com/analytics-vidhya/basic-application-of-linear-regression-on-bangalore-house-price-prediction-18a128a49c96?source=collection_archive---------4-----------------------#2020-02-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2ef87e365d266cb68592d41ee562aba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MkpKmiBR_aL5xtyh.png"/></div></div></figure><p id="cb7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">机器学习中的线性回归(y = mx+c)是用来寻找直线的最佳斜率(m)和截距(c)的基本算法之一，它试图以最小的误差拟合所有的数据点。</p><p id="1756" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博客中，我尝试使用sklearn库对班加罗尔房价预测数据应用线性回归算法，并进行一些可视化。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cdd2" class="jx jy hi jt b fi jz ka l kb kc"><strong class="jt hj">import</strong> <strong class="jt hj">pandas</strong> <strong class="jt hj">as</strong> <strong class="jt hj">pd</strong><br/><strong class="jt hj">import</strong> <strong class="jt hj">seaborn</strong> <strong class="jt hj">as</strong> <strong class="jt hj">sns</strong><br/><strong class="jt hj">import</strong> <strong class="jt hj">matplotlib.pyplot</strong> <strong class="jt hj">as</strong> <strong class="jt hj">plt</strong><br/><strong class="jt hj">import</strong> <strong class="jt hj">numpy</strong> <strong class="jt hj">as</strong> <strong class="jt hj">np</strong><br/><strong class="jt hj">import</strong> <strong class="jt hj">re</strong></span><span id="7062" class="jx jy hi jt b fi kd ka l kb kc"><strong class="jt hj">import</strong> <strong class="jt hj">warnings</strong></span><span id="7b8d" class="jx jy hi jt b fi kd ka l kb kc">pd.set_option('max.columns',<strong class="jt hj">None</strong>)<br/>warnings.filterwarnings("ignore")<br/>sns.set()</span><span id="6a6f" class="jx jy hi jt b fi kd ka l kb kc">data = pd.read_csv('Predicting-House-Prices-In-Bengaluru-Train-Data.csv')<br/>print(data.shape)<br/>data.head()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/21eae25225362e783fec3934a024bf9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ruLS-9kWRqhmKvVC541G-A.png"/></div></div></figure><blockquote class="kf kg kh"><p id="f1dd" class="iq ir ki is b it iu iv iw ix iy iz ja kj jc jd je kk jg jh ji kl jk jl jm jn hb bi translated"><strong class="is hj">数据可视化</strong></p></blockquote><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e8be" class="jx jy hi jt b fi jz ka l kb kc">data['area_type'].value_counts()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es km"><img src="../Images/db5055b5400bbee7d357a00c8fcf1484.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*4A1z_Jo0weJM-F_dIoCCOQ.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1240" class="jx jy hi jt b fi jz ka l kb kc">plt.figure(figsize=(15,7))<br/>plt.bar(data['area_type'].value_counts().index,data['area_type'].value_counts().values)<br/>plt.show()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/f5007d80f2a584a36ccb0e8d73d0f819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JK5AWKzSQ5ACPKlCqhJGCA.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="9453" class="jx jy hi jt b fi jz ka l kb kc">plt.figure(figsize=(15,7)) <br/>sns.distplot(data[‘price’]) <br/>plt.show()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/9e0c3db8bf7a748429c6df2b69d18d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tH0FeMhgwils1MPeymRjoQ.png"/></div></div></figure><p id="89e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以观察到价格值向左倾斜，并且大多小于500</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5f5e" class="jx jy hi jt b fi jz ka l kb kc">plt.figure(figsize=(15,7))<br/>sns.boxplot(data=data,x=data['area_type'],y=data['price'])<br/>plt.show()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/3eeffc0dfefec10c7b702ab9fd88e253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0oBvujDo0nk1M53V-mq_sw.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="47c8" class="jx jy hi jt b fi jz ka l kb kc">sub_data = data[data['area_type'] == 'Plot  Area']</span><span id="7f83" class="jx jy hi jt b fi kd ka l kb kc">plt.figure(figsize=(15,7))<br/>sns.boxplot(data=sub_data,x=sub_data['balcony'],y=sub_data['price'])<br/>plt.show()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/913370833dc42856ef4d2db889f38a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S56ZHqqtdDaKYK-3HYYvfQ.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="f850" class="jx jy hi jt b fi jz ka l kb kc">plt.figure(figsize=(15,7)) sns.boxplot(data=sub_data,x=sub_data[‘bath’],y=sub_data[‘price’]) plt.show()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/92de6197fe53136ddb67cc3605caf0a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wda3IV6yOav6b8X6k75uKQ.png"/></div></div></figure><blockquote class="kf kg kh"><p id="1ef7" class="iq ir ki is b it iu iv iw ix iy iz ja kj jc jd je kk jg jh ji kl jk jl jm jn hb bi translated"><strong class="is hj">处理缺失值</strong></p></blockquote><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cdc5" class="jx jy hi jt b fi jz ka l kb kc">data.isnull().sum()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/1cc93d66e76ea5bda763c7c8ee50270e.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*qSMVHLqHpeU4R2vX6m7y1g.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="26e4" class="jx jy hi jt b fi jz ka l kb kc">plt.figure(figsize=(15,7))<br/>plt.barh(data.isnull().sum().index,width=data.isnull().sum().values)<br/>plt.xlabel('total null values')<br/>plt.show()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/0e3221588708415901deac40dec3080d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJNqNVoUbAcn0X3EZbvgmQ.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="fa52" class="jx jy hi jt b fi jz ka l kb kc">data['balcony'].replace({0.0:1,1.0:2,2.0:3,3.0:4},inplace=<strong class="jt hj">True</strong>)<br/>data['balcony'].unique()</span><span id="0286" class="jx jy hi jt b fi kd ka l kb kc">data.fillna(0,inplace=<strong class="jt hj">True</strong>)<br/>data.isnull().sum()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/59d3ed51a07dba03744cdcbf346b8221.png" data-original-src="https://miro.medium.com/v2/resize:fit:352/format:webp/1*2G3JIu2nmIGFwqvlsFV8sQ.png"/></div></figure><blockquote class="kf kg kh"><p id="f32c" class="iq ir ki is b it iu iv iw ix iy iz ja kj jc jd je kk jg jh ji kl jk jl jm jn hb bi translated">处理分类值</p></blockquote><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1d28" class="jx jy hi jt b fi jz ka l kb kc">data.head()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/c1613e5320185832d59f84326565abdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-TSNOl1F9sTSA3xi3FfLeQ.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="4ae0" class="jx jy hi jt b fi jz ka l kb kc">cat_columns = [‘area_type’,’availability’,’location’,’size’,’society’,’bath’,’balcony’] <br/><strong class="jt hj">for</strong> col <strong class="jt hj">in</strong> data.columns: <br/>   <strong class="jt hj">if</strong> col <strong class="jt hj">in</strong> cat_columns: <br/>      data[col] = data[col].astype(‘category’) <br/>      data[col] = data[col].cat.codes</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/64e4c07494a9f741c215efdb4865392f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*sloEm1kt3ZHhdT3OEFQNfg.png"/></div></figure><blockquote class="kf kg kh"><p id="5b17" class="iq ir ki is b it iu iv iw ix iy iz ja kj jc jd je kk jg jh ji kl jk jl jm jn hb bi translated"><strong class="is hj">数据清理</strong></p></blockquote><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1376" class="jx jy hi jt b fi jz ka l kb kc">data['total_sqft'] = data['total_sqft'].apply(<strong class="jt hj">lambda</strong> x: x.split(' - ')[1] <strong class="jt hj">if</strong> (len(x.split(' - ')))&gt;1 <strong class="jt hj">else</strong> x.split(' - ')[0]) data['total_sqft'] = data['total_sqft'].apply(<strong class="jt hj">lambda</strong> x: re.findall(r'\d+',x)[0]) data['total_sqft'] = data['total_sqft'].astype(np.float64)</span></pre><blockquote class="kf kg kh"><p id="9ed7" class="iq ir ki is b it iu iv iw ix iy iz ja kj jc jd je kk jg jh ji kl jk jl jm jn hb bi translated"><strong class="is hj">列车测试分割</strong></p></blockquote><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="2581" class="jx jy hi jt b fi jz ka l kb kc"><strong class="jt hj">from</strong> <strong class="jt hj">sklearn.model_selection</strong> <strong class="jt hj">import</strong> train_test_split<br/>train,test = train_test_split(data,test_size = 0.2,shuffle = <strong class="jt hj">True</strong>,random_state = 41)<br/>  <br/>y_train = train['price'] x_train = train.drop('price',axis = 1)  y_test = test['price'] x_test = test.drop('price',axis = 1)</span></pre><blockquote class="kf kg kh"><p id="b85c" class="iq ir ki is b it iu iv iw ix iy iz ja kj jc jd je kk jg jh ji kl jk jl jm jn hb bi translated"><strong class="is hj">线性回归模型</strong></p></blockquote><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="40a6" class="jx jy hi jt b fi jz ka l kb kc"><strong class="jt hj">from</strong> <strong class="jt hj">sklearn.linear_model</strong> <strong class="jt hj">import</strong> LinearRegression,SGDRegressor <br/><strong class="jt hj">from</strong> <strong class="jt hj">sklearn.metrics</strong> <strong class="jt hj">import</strong> mean_squared_error<br/>  <br/>model = LinearRegression() <br/>model.fit(x_train,y_train)<br/>prediction = model.predict(x_test)<br/>np.sqrt(mean_squared_error(y_test,prediction))<br/>##answer - 108.26</span><span id="adc9" class="jx jy hi jt b fi kd ka l kb kc">plt.figure(figsize=(15,7))<br/>sns.distplot(y_test,color= 'r')<br/>sns.distplot(prediction)<br/>plt.show()</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/adb0cbf18b9e0f04438e1050dcd1cb35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3ZTIH7vMh4xpC3LauP68A.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">红色-真值，蓝色-预测值</figcaption></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b5c4" class="jx jy hi jt b fi jz ka l kb kc">model.coef_,model.intercept_</span><span id="7fc6" class="jx jy hi jt b fi kd ka l kb kc"><em class="ki"># Plot between first hundred "total area in sqft" and actual output</em><br/>plt.plot(x_test['total_sqft'][:100],x_test['total_sqft'][:100]*model.coef_[5]+model.intercept_)<br/>plt.scatter(x_test['total_sqft'][:100],y_test[:100])</span></pre><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/ab2d91c9bd7b42ec1d59ba5040152060.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*DTJUhdbSlEqIgmp9SSi8Ag.png"/></div></figure></div></div>    
</body>
</html>