<html>
<head>
<title>Generate Certificates using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python生成证书</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/generate-certificates-using-python-a7685985ed77?source=collection_archive---------9-----------------------#2020-05-17">https://medium.com/analytics-vidhya/generate-certificates-using-python-a7685985ed77?source=collection_archive---------9-----------------------#2020-05-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5e2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">成为微软学生合作伙伴意味着我们每天都要和我们的开发者社区打交道。每天，我们都在努力教和学新的东西。2020年1月，我被我的大学<em class="jd">麦兰工程技术大学</em> (MUET)选为MSP。后来，我培训了一些其他的学生，包括大三学生、我的队友和老师，让他们成为来自MUET的MSP。他们在4月份被吸纳为议员。从那以后，他们每天都努力学习和教授新的东西。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/8d21bfa7b0719aa759f1a730870b91f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XoTWpCaJbb6TB68Gow8vzA.jpeg"/></div></div></figure><p id="1469" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，我们，来自MUET Jamshoro的MSP，与来自MUET Jamshoro的MSP进行了一系列的网络研讨会，<strong class="ih hj">技术会谈。</strong>全球近340多名参与者参加了此次会议。系列赛结束后，我们向他们承诺，他们都将获得参赛证书。但是创建这么多的证书对我们来说是一项繁忙的任务。这时候我想到用<strong class="ih hj"> Python </strong>来做这个任务。</p><p id="8903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我首先从PIL导入了Image、ImageDraw和ImageFont。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="68b0" class="jv jw hi jr b fi jx jy l jz ka">from PIL import Image, ImageDraw, ImageFont</span></pre><p id="2e60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，因为我是基于我们的<strong class="ih hj"> <em class="jd">反馈表</em> </strong>生成证书的，所以我也必须导入熊猫</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="9165" class="jv jw hi jr b fi jx jy l jz ka">import pandas as pd</span></pre><p id="9e39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入熊猫为<strong class="ih hj"> <em class="jd"> pd </em> </strong>后，我用熊猫的<strong class="ih hj"> <em class="jd"> read_excel </em> </strong>函数读取我们的excel文件，保存到另一个变量<strong class="ih hj"> <em class="jd"> form </em> </strong>。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="6d7f" class="jv jw hi jr b fi jx jy l jz ka">form = pd.read_excel(“feedback_form.xlsx”)</span></pre><p id="eb92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我还需要两件事情来继续我们的真正任务，即使用Python生成批量证书。这两件事就是名字和把名字转换成一个列表。其他编程语言需要大约50多行代码来完成这项任务，您可能需要一两个循环来执行这项任务，但是在Python中，同样的任务只需要一行代码。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="d9a0" class="jv jw hi jr b fi jx jy l jz ka">name_list = form[‘Name’].to_list()</span></pre><p id="42c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我拥有了所有需要的东西后，我开始创建证书。但是我还需要最后一样东西，一个证书模板。我也搞定了。因为MSP程序也为我们提供了证书模板。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kb"><img src="../Images/ecccb601f477873487529433518cfe29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cf-sbk1eL-0rSibUudtrRA.jpeg"/></div></div></figure><p id="5056" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">准备好证书模板后，我需要模板图像中的坐标来开始编写python代码。为此，我也可以使用其他工具，但是我选择使用可用的simples技巧。是的，我用了<strong class="ih hj">颜料。</strong></p><p id="6a07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，我把坐标整理出来了。如果有人不知道如何获得坐标，可以通过移动所需的位置来获得坐标，并且坐标会出现在画图窗口的左下角。我画了这两条线来告诉你我需要这两条线交点的坐标，因为我在截图中看不到鼠标光标。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kc"><img src="../Images/50aa684521198a0a6493fae8f15ef484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0rFehA2udzc-hlNaUyrTg.png"/></div></div></figure><p id="db9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在批量创建证书之前，我需要为单个证书创建代码。为此，我创建了一个名为<em class="jd"> dummy_name的虚拟列表。</em>然后，我首先必须打开图像，即我们的证书图像。我使用了从<strong class="ih hj"><em class="jd">【PIL】</em></strong>导入的<strong class="ih hj">图片</strong>的open()函数，并将它保存到另一个变量im中。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="cd93" class="jv jw hi jr b fi jx jy l jz ka"><em class="jd">dummy_list = [“Dummy”]<br/>im = Image.open("cert.jpg")</em></span></pre><p id="4ba5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在那之后，我现在必须开始画我们的图像。为此，我使用了从PIL<strong class="ih hj"><em class="jd">导入的<strong class="ih hj"> <em class="jd"> ImageDraw </em> </strong>。我使用ImageDraw的Draw()函数来完成这个任务，并将其保存到另一个变量d中。</em></strong></p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="330c" class="jv jw hi jr b fi jx jy l jz ka">d = ImageDraw.Draw(im)</span></pre><p id="d1f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我将我们的坐标保存到一个变量中，location后跟我希望证书上的文本颜色，并使用RGB配色方案将其保存到一个新变量text_color中。最后，在开始生成证书之前，我必须声明文本应该使用哪种字体。我使用了从<strong class="ih hj"><em class="jd"/></strong>导入的<strong class="ih hj"> <em class="jd">图像字体</em> </strong>并将其保存到字体变量中。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="5e14" class="jv jw hi jr b fi jx jy l jz ka">location = (215, 882)<br/>text_color = (0, 137, 209)<br/>font = ImageFont.truetype(“arial.ttf”, 150)</span></pre><p id="587a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我必须将这些属性嵌入到我的文本中。我用了ImageDraw(d)的text()函数。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="c807" class="jv jw hi jr b fi jx jy l jz ka">d.text(location, dummy_list, fill=text_color, font=font)</span></pre><p id="29ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在在最后，我不得不将证书保存为pdf格式。使用Python，您可以将输出文件保存在任何您想要的位置。我还想用每个人的名字保存每个证书。因此，我使用了下面的代码。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="239c" class="jv jw hi jr b fi jx jy l jz ka">im.save(“certificate_” + dummy_list + “.pdf”)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kb"><img src="../Images/f913ac8f3da278d8cc4a4547a90530cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ETVsGwv4Ol7Z6fiAv6sSaw.jpeg"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">以上代码的最终输出看起来就是这样。</figcaption></figure><p id="47a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是单一证书的代码。在创建了上面给出的代码之后，我不必花费时间来批量生成证书。我只需要在适当的地方引入一个循环。</p><p id="27ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在声明name_list之后，我包含了一个循环，</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="51cc" class="jv jw hi jr b fi jx jy l jz ka">for i in name_list:</span></pre><p id="f1e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后将我代码的最后一行从</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="ad47" class="jv jw hi jr b fi jx jy l jz ka">im.save(“certificate_” + dummy_list + “.pdf”)</span></pre><p id="8bf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="ef8b" class="jv jw hi jr b fi jx jy l jz ka">im.save(“certificate_” + i + “.pdf”)</span></pre><p id="1902" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里比较你的最终代码和我的:</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="0229" class="jv jw hi jr b fi jx jy l jz ka">from PIL import Image, ImageDraw, ImageFont<br/>import pandas as pd</span><span id="b793" class="jv jw hi jr b fi kh jy l jz ka">form = pd.read_excel("feedback_form.xlsx")</span><span id="b617" class="jv jw hi jr b fi kh jy l jz ka">name_list = form['Name'].to_list()<br/>for i in name_list:<br/>    im = Image.open("cert.jpg")<br/>    d = ImageDraw.Draw(im)<br/>    location = (215, 882)<br/>    text_color = (0, 137, 209)<br/>    font = ImageFont.truetype("arial.ttf", 150)<br/>    d.text(location, i, fill=text_color,font=font)<br/>    im.save("certificate_"+i+".pdf")</span></pre><p id="cc21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后！👏这就是我如何解决为我的活动参与者生成参与证书的问题。现在的问题是如何把这些证书分别发给每个人。我也为此创建了一个python程序。我将在下一篇文章中分享这一点。</p></div></div>    
</body>
</html>