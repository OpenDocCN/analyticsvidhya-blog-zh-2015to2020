<html>
<head>
<title>The intuition of Triplet Loss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">三重态损失的直觉</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/triplet-loss-b9da35be21b8?source=collection_archive---------0-----------------------#2019-01-12">https://medium.com/analytics-vidhya/triplet-loss-b9da35be21b8?source=collection_archive---------0-----------------------#2019-01-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b15c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们许多人都觉得机器学习是一个黑匣子，接受一些输入，给出一些奇妙的输出。近年来，这个黑匣子一直在创造奇迹，在各自的应用领域模仿人类。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/f08592a98c4f39bc69c14239bb9af81c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*3PgqexUQpjDA_2SL2nyxdQ.jpeg"/></div></figure><p id="0815" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但从我的经验来看，这是令人着迷的，有趣的，有时令人沮丧的(😜)随着我们深入这个黑匣子。这个黑匣子实现了很多十年前我们都没有想到的事情。ML最有趣的部分是理解这个黑盒在幕后做事情的方式，这使它创造奇迹。</p><h2 id="5758" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">动机</h2><p id="9833" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">最近，当我偶然发现一个名为<strong class="ih hj"> <em class="kl"> FaceNet </em> </strong>的<em class="kl">人脸识别模型</em>时，我惊讶于它是如何以如此令人难以置信的准确度识别人脸，以至于只需一次训练。我真的很好奇，想知道这个模型背后发生了什么。看了一点FaceNet，对我来说，主人公就是正在使用的损失函数，不是别人，正是<strong class="ih hj"> <em class="kl">三重损失函数</em> </strong>。我惊讶于几乎每秒钟在我们大脑中发生的一个小的、直觉的思维过程是如何解决非凡的问题的。这是我写这篇文章的动机。</p><h2 id="bade" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">我们走吧</h2><p id="34fa" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">这里我试着解释一下<em class="kl">我对<strong class="ih hj"> <em class="kl">三重态损失函数</em> </strong>概念的理解。这个损失函数是在谷歌创建的模型Facenet成为使用<strong class="ih hj"> <em class="kl">三重损失函数</em> </strong>的<strong class="ih hj"> <em class="kl">人脸识别</em> </strong>中的艺术级模型之后流行起来的。</em></p><p id="194c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我试着用一个类比让你对三重态损失有一个直观的认识。假设你有两个朋友(姑且称他们为<strong class="ih hj"><em class="kl">A</em></strong><strong class="ih hj"><em class="kl">B</em></strong>)。你们所有人都在同一个班级学习(因此也是同样的科目)。已知的事实是，<strong class="ih hj"> <em class="kl"> A </em> </strong>是该类的状元。出成绩当天，你打了50分，你另外两个朋友(<strong class="ih hj"> <em class="kl"> A，B </em> </strong>)分别打了95分和93分。现在，当你的父母得知结果，并且假设他们知道<strong class="ih hj"> <em class="kl"> A </em> </strong>是状元，他们自然会推断<strong class="ih hj"> <em class="kl"> B </em> </strong>也是状元，因为B和状元(A)的分数之差<em class="kl">是</em> <strong class="ih hj"> <em class="kl">低，</em> </strong>而你是NOOB😔😔作为<em class="kl">的标志，你和topper的区别(</em><strong class="ih hj"><em class="kl"/></strong><em class="kl">)是</em><strong class="ih hj"><em class="kl"/></strong>。</p><p id="4465" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们人类，几乎每次都通过遵循规则来进行这种类型的分类/推理；属于同一类别的元素<em class="kl">拥有相似的特征</em>(在我们的场景中，标记)。</p><p id="9151" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">三重损失采用了同样的逻辑，<em class="kl">即它</em>试图<strong class="ih hj"> <em class="kl">减少</em> </strong>相似事物之间的距离/偏差而<strong class="ih hj"> <em class="kl">增加</em> </strong>不同事物之间的相同。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es km"><img src="../Images/5a7275b0794b65a566d4d642afa93975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDBbSTCvh0xnu2otaW9cyw.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">三重损失最小化了锚和正片之间的距离，二者具有相同的身份，并且最大化了锚和不同身份的负片之间的距离。</figcaption></figure><p id="7b3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过与我们的场景进行比较来理解上面的图表。<strong class="ih hj"> <em class="kl"> A </em> </strong>是<strong class="ih hj"> <em class="kl">主播</em> </strong>众所周知他是<strong class="ih hj"> <em class="kl"> </em> </strong> a <em class="kl">主播</em>(身份固定)。你被认为是<strong class="ih hj"> <em class="kl">负</em> </strong>(既然你的和<strong class="ih hj"> <em class="kl">主播</em> </strong>分数之差就是<strong class="ih hj"> <em class="kl">高</em> </strong>)。<strong class="ih hj"> <em class="kl"> B </em> </strong>被认为是<strong class="ih hj"><em class="kl"/></strong>(由于B的<strong class="ih hj"> <em class="kl">和锚</em> </strong>标志的区别是<strong class="ih hj"> <em class="kl">低</em> </strong>)。所以，在训练一个模型进行分类的时候，我们调整参数的权重，使<em class="kl">的三重损失最小化，</em>即<strong class="ih hj"> <em class="kl">减少相似事物之间的差异，增加不同事物之间的差异</em> </strong>。</p><p id="59b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经准备好理解三重态损失在Facenet模型中是如何工作的了。在Facenet模型的训练阶段，每个输入由3张人脸图像组成。其中，两个图像是同一个人(一个图像被认为是<strong class="ih hj"> <em class="kl">锚</em> </strong>，另一个图像被认为是<strong class="ih hj"> <em class="kl">正</em> </strong>)，最后一个图像是不同的人(<strong class="ih hj"> <em class="kl">负</em> </strong>)。Facenet模型处理人脸的每一幅图像，并在128维空间中对特征进行编码，即给出大小为128的向量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/22b7203b31faed16b8d880e964be00b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*2p1VfRZrROjoCPdc8BG0TA.jpeg"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">将图像编码为128大小的矢量</figcaption></figure><p id="6706" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按照上述类比的思维过程，在128维空间中，如果两个编码点之间的距离为<strong class="ih hj"><em class="kl"/></strong>，则可以说两张脸是<strong class="ih hj"> <em class="kl">不同的</em> </strong>，如果距离为<strong class="ih hj"><em class="kl"/></strong><em class="kl">低，则可以说是<strong class="ih hj"> <em class="kl">相同的</em> </strong>(通常我们保留一个阈值来决定距离的高低)。因此，模型以这样的方式调整权重，编码点之间的距离</em></p><ul class=""><li id="e269" class="kw kx hi ih b ii ij im in iq ky iu kz iy la jc lb lc ld le bi translated"><strong class="ih hj"> <em class="kl">锚</em> </strong>像&amp; <strong class="ih hj"> <em class="kl">正</em> </strong>像低。</li><li id="aa8e" class="kw kx hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated"><strong class="ih hj"> <em class="kl">锚</em> </strong>像&amp; <strong class="ih hj"> <em class="kl">负</em> </strong>像高。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lk"><img src="../Images/d167990d60c381454a7b4b8d440f698f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*SKWGC3ehCbGCsbJVge6kmg.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">FaceNet工作流程</figcaption></figure><p id="931f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们能够理解<strong class="ih hj"> <em class="kl">三重态损失函数</em> </strong>的数学方程了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ll"><img src="../Images/52d825d7215ea8c8a893f41803be5f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EgT2EhqKW5hVrNYX6Y-rKg.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">三重损失函数的数学方程。</figcaption></figure><ul class=""><li id="bb81" class="kw kx hi ih b ii ij im in iq ky iu kz iy la jc lb lc ld le bi translated"><strong class="ih hj"><em class="kl">【x】</em></strong>以<strong class="ih hj"> <em class="kl"> x </em> </strong>为输入，返回一个128维向量<strong class="ih hj"> <em class="kl"> w. </em> </strong></li><li id="7079" class="kw kx hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated"><strong class="ih hj"> <em class="kl"> i </em> </strong>表示第<em class="kl">I</em>输入。</li><li id="e7c5" class="kw kx hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated">下标<strong class="ih hj"> <em class="kl"> a </em> </strong>表示<strong class="ih hj"> <em class="kl">锚</em> </strong>图像，<strong class="ih hj"> <em class="kl"> p </em> </strong>表示<strong class="ih hj"> <em class="kl">正</em> </strong>图像，<strong class="ih hj"> <em class="kl"> n </em> </strong>表示<strong class="ih hj"> <em class="kl">负</em> </strong>图像。</li></ul><p id="6d05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的目标是<em class="kl">最小化上面的等式</em>，这意味着:-</p><blockquote class="lm"><p id="c3bb" class="ln lo hi bd lp lq lr ls lt lu lv jc dx translated">最小化第一项→锚和正像之间的距离。</p><p id="9fb3" class="ln lo hi bd lp lq lr ls lt lu lv jc dx translated">最大化(因为它前面有负号)第二项→锚和负像之间的距离。</p></blockquote><p id="0474" class="pw-post-body-paragraph if ig hi ih b ii lw ik il im lx io ip iq ly is it iu lz iw ix iy ma ja jb jc hb bi translated">第三项是作为阈值的<strong class="ih hj"> <em class="kl">偏差</em> </strong>(这里可以忽略)。</p><p id="61c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你理解了这篇关于<strong class="ih hj"> <em class="kl">三连音缺失</em> </strong>的文章😃。</p><p id="587b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请随意提出改进建议和问题。</p><p id="9f51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习快乐！！</p><p id="ef66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kl">参考文献&amp;延伸阅读:<br/></em></strong>【1】Florian Schroff，Dmitry Kalenichenko，James Philbin，<a class="ae mb" href="https://arxiv.org/pdf/1503.03832.pdf" rel="noopener ugc nofollow" target="_blank"> FaceNet:人脸识别和聚类的统一嵌入</a></p><p id="7793" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kl">图片参考资料:<br/> 1) </em> </strong>谷歌<br/> <strong class="ih hj"> <em class="kl"> 2) </em> </strong> FaceNet论文:-<a class="ae mb" href="https://arxiv.org/pdf/1503.03832.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="kl">https://arxiv.org/pdf/1503.03832.pdf</em></strong></a></p></div></div>    
</body>
</html>