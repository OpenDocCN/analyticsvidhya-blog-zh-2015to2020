<html>
<head>
<title>Evaluating ML Models: Precision, Recall, F1 and Accuracy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">评估ML模型:精确度、召回率、F1和准确度</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/evaluating-ml-models-precision-recall-f1-and-accuracy-f734e9fcc0d3?source=collection_archive---------4-----------------------#2019-09-02">https://medium.com/analytics-vidhya/evaluating-ml-models-precision-recall-f1-and-accuracy-f734e9fcc0d3?source=collection_archive---------4-----------------------#2019-09-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="620a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用这些度量来确定模型是否有效</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/87d3dbc3235dfd3bd495984336aef474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*uzJKEMrjHEv9DBAGNke3EQ.png"/></div></figure><p id="f6f6" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><a class="ae kb" rel="noopener" href="/@chris.the.data.scientist/why-accuracy-is-a-misleading-metric-in-machine-learning-3939fd37b942">上一篇文章</a>我们讨论了准确性如何成为衡量人工智能模型性能的误导性指标。</p><p id="20e4" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">那么我们应该用什么指标来代替准确度呢？精度、召回和F1。</p><h1 id="7580" class="kc kd hi bd ke kf kg kh ki kj kk kl km io kn ip ko ir kp is kq iu kr iv ks kt bi translated">我们的例子</h1><p id="d39b" class="pw-post-body-paragraph jf jg hi jh b ji ku ij jk jl kv im jn jo kw jq jr js kx ju jv jw ky jy jz ka hb bi translated">我们将解释与同一个例子相关的准确度、精确度、召回率和F1，并解释每个例子的优缺点。</p><p id="f271" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jh hj">举例:</strong></p><blockquote class="kz la lb"><p id="d5c3" class="jf jg lc jh b ji jj ij jk jl jm im jn ld jp jq jr le jt ju jv lf jx jy jz ka hb bi translated">我们已经建立了一个模型来预测哪些公司可以存活3年以上。下面是对10家不同公司的预测。</p></blockquote><p id="47ff" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">1 =幸存<br/> 0 =失败</p><pre class="iy iz ja jb fd lg lh li lj aw lk bi"><span id="abac" class="ll kd hi lh b fi lm ln l lo lp">### Tabular Format ###<br/>'''<br/>Company No. 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10<br/>            --------------------------------------<br/>Actual:     1   1   0   1   0   0   0   0   0   0 <br/>Predicted:  1   1   1   0   1   0   0   0   0   0<br/>'''<br/></span><span id="a53e" class="ll kd hi lh b fi lq ln l lo lp">### In Python ###<br/>y_true = [1, 1, 0, 1, 0, 0, 0, 0, 0, 0]<br/>y_pred = [1, 1, 1, 0, 1, 0, 0, 0, 0, 0]</span></pre><h1 id="114b" class="kc kd hi bd ke kf kg kh ki kj kk kl km io kn ip ko ir kp is kq iu kr iv ks kt bi translated">准确(性)</h1><blockquote class="kz la lb"><p id="72a8" class="jf jg lc jh b ji jj ij jk jl jm im jn ld jp jq jr le jt ju jv lf jx jy jz ka hb bi translated">模型预测正确值的实例的百分比。(又名。预测公司成功或失败的正确案例百分比)</p></blockquote><pre class="iy iz ja jb fd lg lh li lj aw lk bi"><span id="3697" class="ll kd hi lh b fi lm ln l lo lp">### Python ###</span><span id="b8db" class="ll kd hi lh b fi lq ln l lo lp">y_true = [1, 1, 0, 1, 0, 0, 0, 0, 0, 0]<br/>y_pred = [1, 1, 1, 0, 1, 0, 0, 0, 0, 0]</span><span id="e6b3" class="ll kd hi lh b fi lq ln l lo lp">from sklearn.metrics import accuracy_score<br/>accuracy_score(y_true, y_pred)<br/>&gt;&gt;&gt; 0.7</span></pre><p id="b6cd" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">乍一看，这似乎是一个很好的成功衡量标准，因为该模型实际上在大多数时候是正确的。但要看上下文。</p><p id="0d49" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你用这个模型来选择投资的公司，你的4笔投资中会有50%亏损。在这种情况下，准确性不是评估模型的好指标。</p><h1 id="aa1d" class="kc kd hi bd ke kf kg kh ki kj kk kl km io kn ip ko ir kp is kq iu kr iv ks kt bi translated">精确</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lr"><img src="../Images/e3c1a3bbd7f4a96b4d82c2da873650cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*lLpbjisG7IApA5-j7Rmdig.png"/></div></figure><blockquote class="kz la lb"><p id="8322" class="jf jg lc jh b ji jj ij jk jl jm im jn ld jp jq jr le jt ju jv lf jx jy jz ka hb bi translated">从检索到的所有实例中检索到的相关实例的比例。又名。预测成功的公司中正确预测的数量。</p></blockquote><p id="c77c" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">您可以为以下两种情况计算此指标:I)模型预测的情况<code class="du ls lt lu lh b">1</code>，以及ii)模型预测的情况<code class="du ls lt lu lh b">0</code>。见下文，但积极的情况是最相关的例子。</p><pre class="iy iz ja jb fd lg lh li lj aw lk bi"><span id="90a7" class="ll kd hi lh b fi lm ln l lo lp">### Python ###</span><span id="0cbf" class="ll kd hi lh b fi lq ln l lo lp">from sklearn.metrics import precision_score</span><span id="ed21" class="ll kd hi lh b fi lq ln l lo lp">positive = precision_score(y_true, y_pred, pos_label=1)<br/>print(positive)<br/>&gt;&gt;&gt; 0.5</span><span id="9e52" class="ll kd hi lh b fi lq ln l lo lp">negative = precision_score(y_true, y_pred, pos_label=0)<br/>print(negative)<br/>&gt;&gt;&gt; 0.8333333333333334</span></pre><p id="5430" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果我们坚持选择投资公司的相同背景，那么precision(对于正面案例)实际上是评估该模型的一个很好的指标。</p><p id="ea79" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">你会知道不要投资模型推荐的公司，因为你知道它只有50%的正确率</p><h1 id="8077" class="kc kd hi bd ke kf kg kh ki kj kk kl km io kn ip ko ir kp is kq iu kr iv ks kt bi translated">回忆</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lv"><img src="../Images/b9ce76988cc7d32ecc8fd37597faecf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*23S9ZU_lF8BXfF8ZbrvupA.png"/></div></figure><blockquote class="kz la lb"><p id="9383" class="jf jg lc jh b ji jj ij jk jl jm im jn ld jp jq jr le jt ju jv lf jx jy jz ka hb bi translated">检索到的相关实例占检索到的相关实例总数的比例。又名。该模型发现了所有成功公司的百分之多少。</p></blockquote><p id="7db1" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">同样，相关的实例可能是<code class="du ls lt lu lh b">0</code>或<code class="du ls lt lu lh b">1</code>案例，但我们将在这里计算两者。</p><pre class="iy iz ja jb fd lg lh li lj aw lk bi"><span id="3da9" class="ll kd hi lh b fi lm ln l lo lp">from sklearn.metrics import recall_score</span><span id="5952" class="ll kd hi lh b fi lq ln l lo lp">positive = recall_score(y_true, y_pred, pos_label=1)<br/>print(positive)<br/>&gt;&gt;&gt; 0.6666666666666666</span><span id="24a4" class="ll kd hi lh b fi lq ln l lo lp">negative = recall_score(y_true, y_pred, pos_label=0)<br/>print(negative)<br/>&gt;&gt;&gt; 0.7142857142857143</span></pre><p id="249b" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这里我们看到，在成功的公司中，这个模型发现了67%。在回忆中，我们不考虑我们错误预测了多少公司会成功，只是我们发现了那些会成功的公司。</p><p id="6415" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果环境正在进行投资，我们可能不会使用回忆来评估我们的模型。除非我们是一家风险投资公司，进行大量的小额投资，潜在的回报是1000倍，我们不想错过任何可能成功的公司。</p><h1 id="0491" class="kc kd hi bd ke kf kg kh ki kj kk kl km io kn ip ko ir kp is kq iu kr iv ks kt bi translated">子一代</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lw"><img src="../Images/4bd6d25a51a505aa4cc221f6b17faf2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*SNrXeKjo-MfxG6hIUF6iug.png"/></div></figure><blockquote class="kz la lb"><p id="8dbc" class="jf jg lc jh b ji jj ij jk jl jm im jn ld jp jq jr le jt ju jv lf jx jy jz ka hb bi translated">F1是精确度和召回率的调和平均值。</p></blockquote><p id="39a3" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">F1兼顾了精确度和召回率。</p><p id="5bc8" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我认为这是一个保守的平均值。例如:<br/>0.5和0.5的F1 = 0.5。<br/>1和0.5的F1 = 0.66。<br/>1和0.01的F1 = 0.02。</p><p id="a589" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">同样，我们可以对正反两种情况都进行计算。</p><pre class="iy iz ja jb fd lg lh li lj aw lk bi"><span id="8929" class="ll kd hi lh b fi lm ln l lo lp">### Python ###</span><span id="4fde" class="ll kd hi lh b fi lq ln l lo lp">from sklearn.metrics import f1_score</span><span id="27d0" class="ll kd hi lh b fi lq ln l lo lp">postive = f1_score(y_true, y_pred, pos_label=1)<br/>print(postive)<br/>&gt;&gt;&gt; 0.5714285714285715</span><span id="80d8" class="ll kd hi lh b fi lq ln l lo lp">negative = f1_score(y_true, y_pred, pos_label=0)<br/>print(negative)<br/>&gt;&gt;&gt; 0.7692307692307692</span></pre><p id="4ffe" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">当精确度和召回率都很重要时，我们通常使用F1。在我的现实生活中，他们经常这样做。</p><h1 id="3a17" class="kc kd hi bd ke kf kg kh ki kj kk kl km io kn ip ko ir kp is kq iu kr iv ks kt bi translated">结论</h1><p id="8e16" class="pw-post-body-paragraph jf jg hi jh b ji ku ij jk jl kv im jn jo kw jq jr js kx ju jv jw ky jy jz ka hb bi translated">在我让你走之前，我们可以用这个sklearn报告同时打印所有分数。</p><pre class="iy iz ja jb fd lg lh li lj aw lk bi"><span id="9965" class="ll kd hi lh b fi lm ln l lo lp">### Python ###</span><span id="964f" class="ll kd hi lh b fi lq ln l lo lp">from sklearn.metrics import classification_report</span><span id="f22f" class="ll kd hi lh b fi lq ln l lo lp">report = classification_report(y_true, y_pred)<br/>print(report)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es lx"><img src="../Images/2f1110678b31325d91b26ea5ddc797e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3le31XkQmBjAKp5ZDZjMTg.png"/></div></div></figure><p id="97c2" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">总之，背景总是重要的。这通常需要仔细的思考，领域知识和对你想要达到的目标的理解。</p></div></div>    
</body>
</html>