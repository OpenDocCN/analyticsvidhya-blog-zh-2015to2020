<html>
<head>
<title>Implementing Machine Learning on Avocado Data Set</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Avocado数据集上实现机器学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implementing-machine-learning-on-avocado-data-set-7217943cd7fd?source=collection_archive---------4-----------------------#2020-07-09">https://medium.com/analytics-vidhya/implementing-machine-learning-on-avocado-data-set-7217943cd7fd?source=collection_archive---------4-----------------------#2020-07-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c5b995563149e3fc84b57368cbab89bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XhjIh9SiMio1eOnQCRWpWQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图一</figcaption></figure><p id="7bf3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这些数据于2018年5月从Hass Avocado Board网站下载，并编译成一个CSV文件。以下是哈斯鳄梨委员会在其网站上对数据的描述:</p><p id="6cc4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下表显示了2018年全国零售量(单位)和价格的每周零售扫描数据。零售扫描数据直接来自零售商的收银机，基于哈斯鳄梨的实际零售销售。从2013年开始，下表反映了一个扩展的多渠道零售数据集。多渠道报告包括以下渠道的集合:杂货、大众、俱乐部、毒品、美元和军事。表中(鳄梨)的平均价格反映了单位(每个鳄梨)成本，即使当多个单位(鳄梨)袋装销售时也是如此。表中的产品查找代码(PLU的)仅适用于哈斯鳄梨。其他品种的鳄梨(如青皮)不包括在此表中。</p><p id="1669" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">鳄梨，一种可能起源于墨西哥中南部的树，被归类为樟科开花植物的一员。这种植物的果实，也被称为鳄梨，在植物学上是一种包含一个大种子的大浆果。</p><blockquote class="js jt ju"><p id="0981" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr hb bi translated"><strong class="iw hj">您可以从这个</strong> <a class="ae jz" href="https://github.com/MayankkYogi/Avocado" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">链接</strong> </a>下载数据集和代码</p></blockquote><p id="d730" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">工作流程:</strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/772c93a57d8aed3418fcabbc373c1f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CTk2lsJPuP98wSH8abdcPw.png"/></div></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/445255211b0f6034df7c6fab36d335cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-tTZy05TOlEQwv6aZVT-g.png"/></div></div></figure><p id="b89a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">灵感/标签</strong></p><p id="8927" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">数据集可以从两个角度看，找到城市或地区，找到均价。所以，我会用两种方法来预测这个数据集。</p><p id="b04e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">字段/列:</strong></p><ul class=""><li id="9668" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">日期—观察的日期</li><li id="d2ee" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">平均价格——一个鳄梨的平均价格</li><li id="b9af" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">类型—常规或有机</li><li id="7fe6" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">年份—年份</li><li id="3788" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">区域-观察的城市或区域</li><li id="8a27" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">总量—售出的鳄梨总数</li><li id="a344" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">4046 —出售的PLU 4046鳄梨总数</li><li id="bad6" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">4225 —出售的PLU 4225鳄梨总数</li><li id="369e" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">4770 —出售的PLU 4770鳄梨总数</li></ul><p id="b5e7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">问题描述:</strong></p><p id="7530" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">目标是预测不同类型鳄梨的连续平均价格，并使用它们所在的区域。</p><p id="c517" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">导入库:</strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/45ad9687ea48e5f3f9d138bc136c6738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tiNuPN4RdP3Q6x3PDE3cCw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图一</figcaption></figure><p id="8fb0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我正在导入我需要的EDA，可视化，预测和寻找所有矩阵的所有库。这样做的原因是一次性使用所有的导入语句变得更容易，并且我们不需要在每个点再次导入语句。我们可以在一个地方找到所有的导入语句，而不用在整个笔记本上找到，并且还可以更新。</p><p id="5da0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">将数据集加载到变量:</strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/44e5ed9f53684217dc17a023d29d0efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CrYlcxIg9F6Oh4KyO38HpA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图一</figcaption></figure><p id="44a8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，我将数据集加载到一个变量中，即“df ”,并处理前5行。因为在这个数据集中，大多数列在性质上是浮动的，并且类型和性别是分类值。</p><p id="8399" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">探索性数据分析:</strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/057f519a1c2e3d7badadee3b306d07b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YTfPiX3B8eh_FBdO2jJTOg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4</figcaption></figure><p id="17f3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">正如在数据集中看到的，有一个索引列在预测鳄梨价格时没有起到任何重要作用，所以我删除了该列。</p><p id="671f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，我正在检查数据集的形状，因为在删除索引列后有18249行和13列。</p><p id="e2a6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，大多数列都是相同的数据类型，即float，而Date、type和region是object数据类型。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/3e79f86a8e0d8dd251b633e4c282b548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S7akaoKzpZzhzGCETO9E4g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5</figcaption></figure><p id="1b26" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上面我检查了空值，因为发现数据集中没有空值，因为红色平均分布在每一列。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/955ab5adad00d62ef37d55864abb8725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tBiw79BfOVJZiq13qZWRLg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图6</figcaption></figure><p id="41a3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上文中，我发现2017年是牛油果价格较其他年份更高的积极年份，2015年位居第二。</p><p id="6011" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，我发现在数据集中出现的每一年，哪种类型的鳄梨有总计数，所以两种类型的鳄梨在数据集中出现的数量几乎相同。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/92d928196f2f70f2a1e742809740c42c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJJjTmS81frB9KTMohQXZQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图7</figcaption></figure><p id="0661" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上述统计数据显示，他们的多个异常值大多在XLargeBags中，在一些用于更好预测的列中，平均值和50%值之间也有差异</p><ul class=""><li id="2123" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">此外，每列中的行数相同，这意味着数据集中没有空值。</li><li id="ca3c" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">此外，大多数列的平均值和50%值是相同的，标准差和平均值彼此非常接近。</li><li id="904a" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">大多数列统计数据接近0值。</li><li id="ac67" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">通过检查75%和最大值之间的差异，在一些列中有异常值，我将很快检查它。</li></ul><p id="10cf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">数据可视化:</strong></p><p id="1023" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这一部分中，我们可以使用不同的列绘制不同的图形，并尝试使用matplotlib和seaborn库来可视化数据。</p><p id="e236" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们使用不同的图表包括:</p><ul class=""><li id="7cbf" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">条形图</li><li id="8100" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">计数图</li><li id="85d1" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">线形图</li><li id="e1a2" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">直方图和配对图</li></ul><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/685d199716d2a72332a6ed1970955899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQbXSoI9UgF_7jmMx3QHpg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图8</figcaption></figure><p id="570b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从上面我们了解到:</p><ul class=""><li id="ed7d" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">与其他年份相比，2017年是价格最高一年，而其他年份之间的差异较小。</li><li id="0309" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">9月和10月是平均价格最高的月份，但事实是，鳄梨的价格几乎全年都是一样的，这证明了鳄梨比印度更受欢迎。</li></ul><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/fdf8506c095fb7a2f20428c121be7a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NowmzWawRGm3IpQbhJTEw.png"/></div></div></figure><p id="104d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从上图可以看出:</p><ul class=""><li id="9c88" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">传统型和有机型鳄梨在第8-10个月之间都有涨价。</li><li id="a00b" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">此外，传统类型的鳄梨在价格方面是变化的，如线图所示，因为开始时价格很高，但随后价格下降，等等。</li></ul><p id="1562" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">绘制直方图:</strong></p><ul class=""><li id="346a" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">一个<strong class="iw hj">直方图</strong>在垂直轴上显示频率，水平轴是另一维度。通常它有多个箱，每个箱都有一个最小值和最大值。每个仓也具有在x和无穷大之间的频率</li><li id="3c63" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">因此，在这种情况下，我们还可以检查图形是右斜、左斜还是正态分布图形</li></ul><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/b4d51793550db9b12fab44ef1ff1b515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RSvoTiw-aMfjmRQgNBqyAA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图9</figcaption></figure><p id="ac1c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从绘制这个直方图，我使用的bin大小为30，我们可以采取任何bin大小(适合每个as数据)。</p><ul class=""><li id="152b" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">平均价格柱通常分布在直方图上。</li><li id="91cd" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">其余的数据在数量上变化不大，所以它们几乎是左偏数据</li><li id="b8e4" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">要使列呈正态分布，我们可以使用不同的方法，但是我使用numPy log来使偏斜值呈正态分布。</li></ul><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/65cbd1cb589f1ba4d337f10c28089740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*94kNLjJQsS5BoCsF1zYuRQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图10</figcaption></figure><p id="834b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上图中，我们首先计算倾斜值，一些列倾斜值远不为零。</p><ul class=""><li id="2d29" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">正态分布的最佳偏斜值非常接近零，因此我们使用“log1p”方法使偏斜值接近零</li><li id="f701" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">在最后一个单元格中，我再次检查偏斜度值，第一个偏斜度值和第二个偏斜度值之间存在差异，现在每列的偏斜度值都接近于零。</li></ul><p id="f754" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">注意:使偏斜值接近零将有助于获得更好的分数。</p><p id="267c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">标签编码:</strong></p><p id="9d2c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Sklearn提供了一个非常有效的工具，用于<strong class="iw hj">将分类特征的级别编码为数值。<strong class="iw hj">标签编码器用0和n_classes-1之间的值对标签</strong>进行编码，其中n是不同<strong class="iw hj">标签</strong>的数量。如果一个<strong class="iw hj">标签</strong>重复，它将分配与先前分配相同的值</strong></p><p id="5099" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用编码器将区域和类型转换成数值。</p><p id="396e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">异常值:</strong></p><p id="8b3c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">异常值</strong>是数据集中远离所有其他观察值的数据点。位于数据集总体分布之外的数据点。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/970cd7b92e86b8a8ae8bf5e65046e8eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*N44xuCsZL0YcWNmep1Ny7A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图11</figcaption></figure><p id="30d2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们通过上图中的例子来理解，我们可以清楚地看到，数列中的数字3与数列的本质相去甚远，所以这里的“3”是一个异常值。</p><p id="28af" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们知道异常值可能是一个错误或者仅仅是一个方差，你将如何决定它们是否重要。很简单，如果它们是错误的结果，那么我们可以忽略它们，但是如果它只是数据中的差异，我们就需要想得更远一些。</p><p id="36d3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于鳄梨问题，首先检查每一列的异常值。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/ced459b1a21fc629d6e005484a0255d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTwinxanHz_01Cs3D16uNw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图12</figcaption></figure><p id="144e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从上面的图像中，我们可以清楚地看到，在大部分列中有一些黑点是指异常值，所以这意味着大部分数据在分布之外。</p><p id="5aab" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们检测异常值，第二步是去除异常值，有不同的方法可以去除异常值，即找到IQR、zscore值。</p><p id="874c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我使用两个zscore值，然后我再次检查是否有一些异常值，然后我将通过用该列的平均值替换异常值来删除它。</p><div class="kb kc kd ke fd ab cb"><figure class="le ij lf lg lh li lj paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/0bad579a279f81801e9ec175fd173e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*wI6HjEtwmUPR9mXDpUefCQ.png"/></div></figure><figure class="le ij lk lg lh li lj paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/37fee946443eace32db643b68d1e5200.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*krMl-A7LjpyNHRlbXn-W5w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx ll di lm ln translated">图13</figcaption></figure></div><p id="7ab4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，我首先找到zscore值，然后我决定将一个阈值设为3，这是行业推荐值的标准，然后我移除所有zscore值大于3的异常值。</p><p id="7feb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在去除异常值后，最终有17525和14列出现在数据集中。</p><p id="9bf4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">相关矩阵:</strong></p><p id="0654" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">相关性</strong>矩阵基本上是一个协方差矩阵。一个被称为<strong class="iw hj">相关性</strong>的综合指标描述了线性关联的强度。<strong class="iw hj">相关性</strong>总结了两个定量变量之间线性(直线)关联的强度和方向。用r表示，它取-1到+1之间的值。</p><p id="88a1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我正在查找每列的相关值，该值主要分为两部分:</p><p id="7f3f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">-正相关值</p><p id="3a03" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">-负相关值</p><p id="fd85" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最大值为正意味着列非常相关，反之亦然。</p><p id="5ffe" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我使用seaborn heatmap绘制相关矩阵，并在heatmap图中绘制corr值</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/c3f635eca71e45247406c52302db6a22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j7U6wcqrzpxYhVGkJywZUw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图14</figcaption></figure><p id="272d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">下降和标准定标器:</strong></p><p id="c4bd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我制作了两个变量x和y，其中x包含除平均价格和日期之外的所有列，我们也可以删除日期列，但我保留它是为了EDA的目的，而y只包含环列。</p><p id="23dc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">另外，我在x变量上使用了标准的缩放方法</p><p id="f479" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">平均价格预测:</strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/e37eb8f37fa015d052ed0b0747c71fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8wTslomZUcipz76Ad_dig.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图15</figcaption></figure><p id="ba9e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上面我使用了for循环，它帮助我提供每个随机状态的R2分数，而R2分数最大的最佳状态作为输出值。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/5e8ab43bad506c8c9087117cedb4f6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oKC0tOYz_gVYIS6k26J-iw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图16</figcaption></figure><p id="2599" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在预测中:</p><ul class=""><li id="817c" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">我是通过把平均价格作为一个输出变量来做这个预测的，这个变量在本质上是连续的，所以我使用了回归技术</li><li id="4e5c" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">在计算最佳随机状态时，80是为该模型提供最高R2分数值的最佳状态。</li><li id="63ed" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">使用GridSeachCV后，我可以找到最佳参数，然后我将这些参数用于该模型。</li><li id="82b9" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">使用最佳参数后，我可以得到最佳的R2分数，模型是KNeighboursRegressor。</li><li id="daf1" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">我找到了以下矩阵，它们提供了最好的分数。</li><li id="da2d" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">我还绘制了散点图，我们可以看到实际值和预测值非常接近，所以这条线是最佳拟合线。</li></ul><p id="5380" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我通过将区域作为y值来查找分数，我使用分类方法，因为区域数据本质上是分类的，所以我导入分类模型及其矩阵。</p><p id="b93c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">带区域预测:</strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/5461dc516e8efe6c3c53059422d8e643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofaeOqljsPboP9wkE2U7XQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图17</figcaption></figure><p id="6912" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，我再次进行了标准缩放，并使用相同的for循环模型，该模型提供了最佳状态，给出了最佳的准确度分数。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/b2080290d61e442099cb1cc10647026c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-BEPiOo16OB-qKPkXMfcg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图18</figcaption></figure><p id="4330" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在预测中:</p><ul class=""><li id="6331" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">这里，发生的随机状态是76，这为模型提供了81%的最佳准确度分数。</li><li id="7cfc" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">此外，通过使用GridSeachCV，我能够找到最佳参数，然后找到85%的最佳准确度分数</li></ul><p id="3950" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> Roc曲线:</strong></p><p id="34ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">预测二元结果的概率时，一个有用的工具是<a class="ae jz" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic" rel="noopener ugc nofollow" target="_blank">接收器操作特性曲线</a>，或ROC曲线。</p><p id="8a19" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">它是针对0.0和1.0之间的多个不同候选阈值的假阳性率(x轴)与真阳性率(y轴)的关系图。换句话说，它绘制了虚警率与命中率的关系图。</p><p id="6e4d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">真阳性率计算为真阳性的数量除以真阳性的数量和假阴性的数量之和。它描述了当实际结果是肯定的时，模型在预测肯定类别方面有多好。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/b43ced62e0f4a47a3791cf0e08f5cc74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMgCD1QwTEM9p9gsqXpUtA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图19</figcaption></figure><p id="5f46" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">观察:</strong></p><ul class=""><li id="2cd8" class="kf kg hi iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">与地区相比，以价格为y变量的模型预测效果更好</li><li id="2060" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">此外，我使用标签编码器将分类数据转换成数字数据，即地区和性别</li><li id="184b" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">此外，R2分值也大于准确度分值</li><li id="5fa1" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">平均价格、总袋数和总体积在所有其他列中是正态分布数据</li><li id="aace" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">通过平均值替换后，数据集中没有异常值</li><li id="1583" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">因为年份是所有列中最负的co相关列</li><li id="c97c" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">八月到十月间，鳄梨的价格比其他月份要高得多</li><li id="74ce" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">日期28、29和30鳄梨的价格很高</li><li id="0413" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">与其他地区相比，哈特福德斯普林菲尔德、旧金山和纽约的平均价格更高</li><li id="b8df" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">两种类型鳄梨在第8-10个月之间都有涨价</li><li id="c59f" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">因为有机鳄梨的单位价格比传统的要高</li><li id="4e0d" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">我用地区和价格做了预测，但是用价格预测的分数比地区高</li><li id="d45b" class="kf kg hi iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">所以在这个数据集中，我使用回归和分类技术来制作这个模型</li></ul></div></div>    
</body>
</html>