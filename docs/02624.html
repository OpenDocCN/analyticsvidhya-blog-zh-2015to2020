<html>
<head>
<title>Data Normalization for Numeric features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数字要素的数据规范化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-transformation-for-numeric-features-fb16757382c0?source=collection_archive---------1-----------------------#2019-12-26">https://medium.com/analytics-vidhya/data-transformation-for-numeric-features-fb16757382c0?source=collection_archive---------1-----------------------#2019-12-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dcc68fc712ddafc4c3a7e93ac45e4c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uiXk6m4dj2MCacH953ysWQ.png"/></div></div></figure><p id="b53e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是机器学习预处理部分的另一篇文章。在这里，我们将讨论如何标准化或缩放数据，以便模型可以很好地执行。在我们继续在训练集上拟合模型之前，我们应该看看数据转换技术。这是细化你的训练数据的另一个非常重要的步骤。</p><h1 id="88e1" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">为什么要进行数据扩展？</h1><p id="d04f" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">严格来说，如果不对数字要素应用缩放技术，您的模型仍然可以运行。然而，使用这些技术可以使模型给出更好的结果、更好的准确性和更好的预测。</p><p id="c36b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可能需要对数字数据应用两种转换:</p><ul class=""><li id="8ba5" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated"><strong class="is hj">规范化</strong> —将数值数据转换为与其他数值数据相同的比例。</li><li id="b8d3" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated"><strong class="is hj">分桶</strong> —将数字(通常是连续的)数据转换成分类数据。</li></ul><h1 id="d673" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">👉继续之前要小心</h1><h2 id="4ef9" class="lf jp hi bd jq lg lh li ju lj lk ll jy jb lm ln kc jf lo lp kg jj lq lr kk ls bi translated">浏览和清理您的数据</h2><p id="ff25" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在对数据执行任何转换之前，浏览并清理数据。在收集和构建数据集时，您可能已经完成了以下一些任务:</p><ul class=""><li id="ace3" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated">检查几行数据。</li><li id="965f" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">检查基本统计数据。</li><li id="ba46" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">修复丢失的数字条目。</li></ul><h2 id="a2df" class="lf jp hi bd jq lg lh li ju lj lk ll jy jb lm ln kc jf lo lp kg jj lq lr kk ls bi translated">可视化您的数据</h2><p id="80f6" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">您的数据在基本统计中可能看起来是一种方式，在绘制图表时可能是另一种方式。在你深入分析之前，可以通过散点图或直方图来图形化地查看你的数据。不仅要在管道开始时查看图表，还要在整个转换过程中查看图表。可视化将帮助你不断检查你的假设，并看到任何重大变化的影响。</p><h1 id="e45d" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">正常化</h1><p id="18ab" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">归一化的目标是将要素变换到相似的比例。这提高了模型的性能和训练稳定性。</p><h2 id="bba1" class="lf jp hi bd jq lg lh li ju lj lk ll jy jb lm ln kc jf lo lp kg jj lq lr kk ls bi translated">为什么要正常化？</h2><p id="5401" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">如果同一要素(例如，城市人口)中有非常不同的值，则有必要进行归一化。没有标准化，如果梯度更新太大，您的训练可能会因NaNs而失败。</p><p id="b419" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可能有两个范围差异很大的不同要素(例如，年龄和收入)，从而导致梯度下降“反弹”并减缓收敛速度。像<a class="ae lt" href="http://www.jmlr.org/papers/volume12/duchi11a/duchi11a.pdf" rel="noopener ugc nofollow" target="_blank"> Adagrad </a>和<a class="ae lt" href="https://arxiv.org/abs/1412.6980" rel="noopener ugc nofollow" target="_blank"> Adam </a>这样的优化器通过为每个特征创建单独的有效学习率来防止这个问题。但是优化器不能把你从单个特性内的大范围的值中拯救出来；在这些情况下，您必须正常化。</p><h2 id="1b3d" class="lf jp hi bd jq lg lh li ju lj lk ll jy jb lm ln kc jf lo lp kg jj lq lr kk ls bi translated">标准化技术一瞥</h2><p id="9a33" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">五种常见的标准化技术可能有用:</p><ul class=""><li id="7794" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated">L1- L2正常化</li><li id="b222" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">缩放到一个范围(最小-最大)</li><li id="2499" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">剪报</li><li id="576c" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">对数标度</li><li id="b457" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">标准化<strong class="is hj"> / </strong> Z值</li></ul><p id="181c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> L1- L2关系正常化</strong></p><p id="1a51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时候，我们并不关心向量的大小。我们只想知道它们在我们的特征空间中的方向。因此，在这种情况下，我们可以使用L1或L2归一化，将输入向量单独缩放至单位范数(向量长度)。</p><p id="c78b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于L1归一化，它们的绝对值之和是1。</p><p id="6913" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于L2归一化，它计算为矢量值平方之和的平方根。</p><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/2d640dfe2fac0383587a2e3dce5b8e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*G0wl5ZZ7P9DH6060ATYuAw.png"/></div></figure><p id="234d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">缩放至一个范围(最小-最大)</strong></p><p id="3bb0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将最小值到最大值映射到特定范围(例如0到1)的数据的线性变换</p><p id="5283" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当同时满足以下两个条件时，缩放到一个范围是一个不错的选择:</p><ul class=""><li id="e1a7" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated">您知道数据的大致上限和下限，很少或没有异常值。</li><li id="727e" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">您的数据在该范围内大致均匀分布。</li></ul><p id="e003" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">相比之下，你会<em class="lz">而不是</em>在收入等特征上使用缩放，因为只有少数人有非常高的收入。收入的线性标尺的上限会非常高，大多数人会被挤到标尺的一小部分。</p><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/5786f4f2390ebb9c826439cc62473c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*G2rhh6ZHkE4zzjPVSsw66g.png"/></div></figure><p id="0b64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">剪辑</strong></p><p id="ae37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果数据集包含极端异常值，可以尝试要素裁剪，将高于(或低于)特定值的所有要素值限制为固定值。例如，您可以将所有高于40的温度值裁剪为40。</p><p id="229f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">公式:<em class="lz">如果x &gt; max，那么x' = max否则如果x &lt; min，那么x' = min </em></p><p id="add6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在其他规范化之前或之后应用要素裁剪。</p><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="ab fe cl mb"><img src="../Images/23ae9fa2cdf668c3e3826dba4d0e7cb0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*yipouBQ9DgK0Zbyc0BIBkA.png"/></div></figure><h2 id="dfc1" class="lf jp hi bd jq lg lh li ju lj lk ll jy jb lm ln kc jf lo lp kg jj lq lr kk ls bi translated">对数标度</h2><p id="3dd8" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">对数比例计算值的对数，将大范围压缩到小范围。</p><p id="7b96" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">x′=对数(x)</p><p id="a1ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当少数值有很多点，而大多数其他值只有很少点时，对数比例很有帮助。这种数据分布被称为<strong class="is hj"> <em class="lz">幂律</em> </strong>分布。电影评分就是一个很好的例子。在下面的图表中，大多数电影的收视率很低(尾部的数据)，而少数电影的收视率很高(头部的数据)。对数标度改变了分布，有助于提高线性模型的性能。</p><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/e0ae03fc20933d4d3763e33e9ebd93e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*kvNFiWcnK5JWZt2jp61_jQ.png"/></div></figure><p id="dba0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">标准化/Z值</strong></p><p id="31e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它将每个要素转换为均值为0、标准差为1的正态分布。也可称为<strong class="is hj"> Z分数</strong>变换。</p><p id="dc22" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">公式:<em class="lz"> x' = (x — μ) / σ，</em>其中<em class="lz"> μ </em>为均值，<em class="lz"> σ </em>为标准差</p><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es md"><img src="../Images/00eaee1c5f517da87e98359225c4ec84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*QcIhGP83pIuRcyeAWhKspw.png"/></div></figure><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es me"><img src="../Images/4ba25d57124cefdb7e77702b85e14f7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*iSuJWS5-fJM3TvsJyNxuNg.png"/></div></figure><h2 id="b93b" class="lf jp hi bd jq lg lh li ju lj lk ll jy jb lm ln kc jf lo lp kg jj lq lr kk ls bi translated">👉摘要</h2><ul class=""><li id="3c0f" class="kr ks hi is b it km ix kn jb mf jf mg jj mh jn kw kx ky kz bi translated">最小-最大缩放对异常值很敏感。因此，当特征在固定范围内或多或少均匀分布时，就使用它</li><li id="b71d" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">削波是去除一些异常值的首选方法。它可以与其他标准化技术结合使用</li><li id="bf24" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">当存在极值时，首选对数标度。简而言之，当数据分布不均匀时</li><li id="1798" class="kr ks hi is b it la ix lb jb lc jf ld jj le jn kw kx ky kz bi translated">当有一些异常值时，z分数或标准化是有用的，但不至于极端到需要裁剪</li></ul><p id="3f22" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，选择取决于数据和您打算选择的算法。</p><h1 id="4816" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">木桶理论(宁滨)</h1><p id="2d89" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">如果选择将数字要素分桶，请明确如何设置边界以及应用哪种分桶类型:</p><ul class=""><li id="cb2f" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated"><strong class="is hj">具有等间距边界的桶</strong>:边界是固定的，包含相同的范围(例如，0-4度、5-9度和10-14度，或者5000-9999美元、10000-14999美元和15000-19999美元)。一些桶可能包含许多点，而另一些桶可能很少或没有点。</li></ul><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/8cd65b944eeb90a6bf2e9779007a298f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*PJMW437Wrd5U45ULYWr2xw.png"/></div></figure><ul class=""><li id="4cda" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated"><strong class="is hj">具有分位数边界的桶</strong>:每个桶具有相同的点数。界限不是固定的，可以包含或宽或窄的值。</li></ul><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/a9147439741330d542a0f462ae33e128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*KhCY_onPSDXZ9_PBRevM4g.png"/></div></figure><ul class=""><li id="5e92" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated"><strong class="is hj">分位数v/s相等边界:</strong> <code class="du mk ml mm mn b">cut</code>库将根据值本身而不是这些值的<em class="lz">频率</em>来选择要均匀间隔的仓。每个箱将具有不同数量的记录。</li></ul><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/5bd3cde63fa92d6dc77ecbca8d5e2eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*Y9ZzuZ2z-DKci5PmyfLyYQ.png"/></div></figure><p id="5d16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，当您使用<code class="du mk ml mm mn b"><strong class="is hj">qcut</strong></code>请求五分位数时，将选择箱，以便您在每个箱中有相同数量的记录。(您的输出应该是这样的，每个箱中有6条记录):</p><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/7ce9e83261046e16cbb4f83c3e0fea7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*GqbtO3julBTwEU2mGA1MDw.png"/></div></figure><ul class=""><li id="7468" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated"><strong class="is hj">基于阈值的宁滨:</strong>之前，我们看到了根据箱数分割数据的示例。现在，我们将了解如何根据阈值对数据进行分类。以下示例检查三个不同阈值20、30和64的值，并相应地对数据进行分类。注意，我们指定了3个阈值，数据被分成4个区间。</li></ul><figure class="lv lw lx ly fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/cec83cdc910088c47cf0adb3283af753.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*MLEC2TQkI7e6ODMX4dQIlA.png"/></div></figure><p id="7e77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">👉总结</strong></p><p id="c5a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">等间距边界分桶是一种简单的方法，适用于大量数据分布。但是，对于倾斜的数据，请尝试使用分位数存储。</p><p id="54be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下一篇文章中，我们将更多地讨论数据争论。原始数据需要经过许多提炼步骤才能用于训练目的。</p><h1 id="2741" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">参考资料:</h1><p id="8c55" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated"><a class="ae lt" href="https://developers.google.com/machine-learning/data-prep/transform/introduction" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/machine-learning/data-prep/transform/introduction</a></p></div></div>    
</body>
</html>