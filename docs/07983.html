<html>
<head>
<title>Data Preprocessing Implementation in Real Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实际项目中的数据预处理实现</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-preprocessing-implementation-in-real-project-e82fa4b8c40c?source=collection_archive---------26-----------------------#2020-07-13">https://medium.com/analytics-vidhya/data-preprocessing-implementation-in-real-project-e82fa4b8c40c?source=collection_archive---------26-----------------------#2020-07-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/320e374f091948a69e9c47db8ab47920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-Er2dX1dYrxAR2QKRA3EA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在<a class="ae iu" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae iu" href="https://unsplash.com/@creatveight?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">创作八</a>的照片</figcaption></figure><p id="5d61" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本教程中，我将以零售需求预测项目为例，详细讨论如何对分类特征和数值特征进行数据预处理。</p><p id="28f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从本文中，您将学习以下Python技能:</p><ul class=""><li id="dd20" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">一个热编码</li><li id="ea22" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">从变量中删除单位(字符串)</li><li id="3323" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">将不同的类别替换成数字</li><li id="a406" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">缺失值插补</li></ul><h1 id="829f" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">1预处理:分类特征</h1><ul class=""><li id="8ef2" class="jt ju hi ix b iy lf jc lg jg lh jk li jo lj js jy jz ka kb bi translated">找出并估算分类特征中是否有缺失值。</li><li id="adac" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">删除没有添加太多信息的特征</li><li id="e564" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">选择编码方案将分类特征转换为数值。</li></ul><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="dcb7" class="lt ki hi lp b fi lu lv l lw lx"># importing required libraries</span><span id="9a28" class="lt ki hi lp b fi ly lv l lw lx">import pandas as pd<br/>import numpy as np<br/>import category_encoders as ce</span><span id="1832" class="lt ki hi lp b fi ly lv l lw lx">import matplotlib.pyplot as plt<br/>%matplotlib inline</span></pre><h2 id="8c53" class="lt ki hi bd kj lz ma mb kn mc md me kr jg mf mg kv jk mh mi kz jo mj mk ld ml bi translated">数据集1:每周销售数据包含以下特征</h2><ul class=""><li id="d55f" class="jt ju hi ix b iy lf jc lg jg lh jk li jo lj js jy jz ka kb bi translated"><strong class="ix hj">周_结束_日期</strong> —周日期</li><li id="9547" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">商店编号</strong> —商店编号</li><li id="6573" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj"> UPC </strong> —(通用产品代码)产品特定标识符</li><li id="5723" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">基价</strong> —项目的基价</li><li id="4609" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">展示</strong> —产品是店内促销展示的一部分</li><li id="8a02" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">特征</strong> —产品在店内通告中</li><li id="c7fe" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">单位</strong> —售出的单位(目标)</li></ul><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="eef3" class="lt ki hi lp b fi lu lv l lw lx"># read the store data<br/>data = pd.read_csv('dataset/train.csv')<br/>data.head()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/7a602499c0c1dfbec776033988bfbc37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6RkiE568UiVZdgIJGTLjSw.png"/></div></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="7a29" class="lt ki hi lp b fi lu lv l lw lx">data[['STORE_NUM','UPC','FEATURE','DISPLAY']].isnull().sum()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/8e4c34fd5fb10d83208d5ce4d5f9cdd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*CP8rU18jn7o6b4SIOVDCrA.png"/></div></figure><ul class=""><li id="a4fc" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">STORE_NUM:不需要修改，因为它是一个键，以后将用于合并表。</li><li id="f76f" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">UPC:不需要更改，因为它是键，以后将用于合并表。</li><li id="1a7d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">特性:不需要预处理</li><li id="c09e" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">显示:不需要预处理</li></ul><h2 id="bff4" class="lt ki hi bd kj lz ma mb kn mc md me kr jg mf mg kv jk mh mi kz jo mj mk ld ml bi translated">数据集2:产品数据包含产品的详细信息</h2><ul class=""><li id="b72e" class="jt ju hi ix b iy lf jc lg jg lh jk li jo lj js jy jz ka kb bi translated"><strong class="ix hj"> UPC </strong> —(通用产品代码)产品特定标识符</li><li id="e723" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">描述</strong> —产品描述</li><li id="8e57" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">制造商</strong> —产品制造商</li><li id="e62d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">类别</strong> —产品类别</li><li id="c4b0" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">子类</strong> —产品的子类</li><li id="eb52" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">产品尺寸</strong> —产品的包装尺寸或数量</li></ul><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="581f" class="lt ki hi lp b fi lu lv l lw lx">product_data = pd.read_csv('dataset/product_data.csv')<br/>product_data.head()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/f5c7c3a7255b8b2aa83e7d5365b594c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRG-g2_N5q62SOjSBQLgpQ.png"/></div></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="a9f2" class="lt ki hi lp b fi lu lv l lw lx">product_data.shape<br/>product_data[['UPC','DESCRIPTION','MANUFACTURER','CATEGORY', 'SUB_CATEGORY', 'PRODUCT_SIZE']].isnull().sum()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/e88c287d2c5f09ab76e350c5f4565e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*OCrUc_pH1RbErDqWoMH4gA.png"/></div></figure><p id="1d8f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="mq">没有空值</em> </strong></p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="01db" class="lt ki hi lp b fi lu lv l lw lx"># number of unique description<br/>product_data['DESCRIPTION'].nunique()<br/># number of unique manufacturer<br/>product_data['MANUFACTURER'].nunique()<br/># number of unique categories<br/>product_data['CATEGORY'].nunique()<br/># number of unique sub categories<br/>product_data['SUB_CATEGORY'].nunique()<br/># number of unique product sizes<br/>product_data.PRODUCT_SIZE.nunique()</span></pre><ul class=""><li id="a650" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated"><strong class="ix hj">描述</strong> -在描述中，我们有产品的类别、子类别和尺寸，这些也已经存在于其他特征中。因此，我们将放弃这个特性，因为它不会给模型增加太多价值。</li><li id="f445" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">制造商、类别、子类别</strong> -因为在给定的类别中没有订单，所以我们将对此特征进行热编码。</li><li id="f79b" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj"> PRODUCT_SIZE </strong> —不同类别产品的产品尺寸单位不同。因此，对于每个类别，我们将根据不同的尺寸进行宁滨。</li></ul><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="61a7" class="lt ki hi lp b fi lu lv l lw lx"># drop the DESCRIPTION FEATURE<br/>product_data = product_data.drop(columns= ['DESCRIPTION'])</span><span id="07e8" class="lt ki hi lp b fi ly lv l lw lx"># remove the units from the product size<br/># we will keep only the values<br/>product_data['PRODUCT_SIZE'] = product_data.PRODUCT_SIZE.apply(lambda x: x.split()[0])</span><span id="d705" class="lt ki hi lp b fi ly lv l lw lx"># change data type of product size from string to float<br/>product_data.PRODUCT_SIZE = product_data.PRODUCT_SIZE.astype(float)</span><span id="d7b0" class="lt ki hi lp b fi ly lv l lw lx"># Let's see the unique product size values for each category<br/>product_data.groupby(['CATEGORY'])['PRODUCT_SIZE'].unique()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/de41a38d0bdae8976ff4447bdf927d39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*3D_AD1uDszTygdpy95_DVw.png"/></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="f092" class="lt ki hi lp b fi lu lv l lw lx"># define 3 bins for category type = "COLD CEREAL"<br/>product_data.loc[product_data.CATEGORY == 'COLD CEREAL', 'PRODUCT_SIZE'] = pd.cut(product_data.PRODUCT_SIZE,bins=[10,13,16,21],labels=[1,2,3])</span><span id="a319" class="lt ki hi lp b fi ly lv l lw lx"># define 2 bins for category type = "ORAL HYGIENE PRODUCTS"<br/>product_data.loc[product_data.CATEGORY == 'ORAL HYGIENE PRODUCTS', 'PRODUCT_SIZE'] = pd.cut(product_data.PRODUCT_SIZE,bins=[0,501,1001],labels=[1,2])</span><span id="2578" class="lt ki hi lp b fi ly lv l lw lx"># define 3 bins for category type = "FROZEN PIZZA"<br/>product_data.loc[product_data.CATEGORY == 'FROZEN PIZZA', 'PRODUCT_SIZE'] = pd.cut(product_data.PRODUCT_SIZE,bins=[20,25,30,35],labels=[1,2,3])</span><span id="ade5" class="lt ki hi lp b fi ly lv l lw lx"># define 2 bins for category type = "BAG SNACKS"<br/>product_data.loc[product_data.CATEGORY == 'BAG SNACKS', 'PRODUCT_SIZE'] = pd.cut(product_data.PRODUCT_SIZE,bins=[9,14,20],labels=[1,2])</span><span id="9f50" class="lt ki hi lp b fi ly lv l lw lx"># value counts of PRODUCT SIZE<br/>product_data.PRODUCT_SIZE.value_counts()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/8c9334c1e2be5a5b4eb9dd896a9dfb76.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*N3OG45eJIsvzFnRXeRb8uw.png"/></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="bc47" class="lt ki hi lp b fi lu lv l lw lx"># One Hot Encode the features<br/>OHE_p = ce.OneHotEncoder(cols= ['MANUFACTURER', 'CATEGORY', 'SUB_CATEGORY'])</span><span id="27ee" class="lt ki hi lp b fi ly lv l lw lx"># transform the data<br/>product_data = OHE_p.fit_transform(product_data)</span><span id="e157" class="lt ki hi lp b fi ly lv l lw lx"># updated data<br/>product_data.head()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/4d938bdcbb9de54d9a4b685f34c06c73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*THQ2C_z6IOj_JPVN9SJSBg.png"/></div></div></figure><h2 id="413f" class="lt ki hi bd kj lz ma mb kn mc md me kr jg mf mg kv jk mh mi kz jo mj mk ld ml bi translated">数据集3:存储数据</h2><ul class=""><li id="f513" class="jt ju hi ix b iy lf jc lg jg lh jk li jo lj js jy jz ka kb bi translated"><strong class="ix hj">商店标识</strong> —商店编号</li><li id="03b8" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">店铺名称</strong> —店铺名称</li><li id="3cba" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">地址_城市_名称</strong> —城市</li><li id="9470" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">地址_状态_证明_代码</strong> —状态</li><li id="7cca" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj"> MSA_CODE </strong> —(大都市统计区域)基于地理区域和人口密度</li><li id="6c8d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">细分值名称</strong> —商店细分名称</li><li id="ba11" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj"> PARKING_SPACE_QTY </strong> —商店停车场的停车位数量</li><li id="6bde" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj"> SALES_AREA_SIZE_NUM </strong> —店铺面积</li><li id="2b5e" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">AVG _每周_购物篮</strong> —商店每周售出的平均购物篮</li></ul><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="88d1" class="lt ki hi lp b fi lu lv l lw lx"># read the store data<br/>store_data = pd.read_csv('dataset/store_data.csv')</span><span id="7db2" class="lt ki hi lp b fi ly lv l lw lx">store_data.head()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/ae2aa8c0a36dbed1f39609b7a078822a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HzToP0NVOCGGTNIjMxK5yA.png"/></div></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="7d78" class="lt ki hi lp b fi lu lv l lw lx"># shape of the store data<br/>store_data.shape</span><span id="ee42" class="lt ki hi lp b fi ly lv l lw lx"># check for the null valuesstore_data[['STORE_ID','STORE_NAME','ADDRESS_CITY_NAME','ADDRESS_STATE_PROV_CODE', 'MSA_CODE', 'SEG_VALUE_NAME']].isnull().sum()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/5b5644c469869f4a59696d3c421e1a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*dTemQ69V1BPAvMc6RuVtBw.png"/></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="40ec" class="lt ki hi lp b fi lu lv l lw lx"># number of unique store names<br/>store_data.STORE_NAME.nunique()</span><span id="adf9" class="lt ki hi lp b fi ly lv l lw lx"># number of unique city names<br/>store_data.ADDRESS_CITY_NAME.nunique()</span><span id="bdd7" class="lt ki hi lp b fi ly lv l lw lx"># number of unique state provision code<br/>store_data.ADDRESS_STATE_PROV_CODE.nunique()</span><span id="190b" class="lt ki hi lp b fi ly lv l lw lx"># number of unique msa code<br/>store_data.MSA_CODE.nunique()</span><span id="f222" class="lt ki hi lp b fi ly lv l lw lx"># number of unique segment value names<br/>store_data.SEG_VALUE_NAME.nunique()</span></pre><ul class=""><li id="4fd1" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated"><strong class="ix hj"> STORE_ID </strong> —无需更改，因为它是一个键，以后将用于合并文件。</li><li id="e5a2" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">商店名称 —因为，在76家不同的商店中，我们有72个独特的商店名称。商店名称包含商店的一些位置信息，这些信息以地址、城市名称和州的形式存在。因此，我们将放弃这一功能。</li><li id="084d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj"> ADDRESS_CITY_NAME </strong> —因为在76个不同的商店中，我们有51个唯一的地址城市名称，所以由于基数较高，我们将放弃该功能</li><li id="8bd3" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">ADDRESS _ STATE _ PROV _ CODE</strong>，<strong class="ix hj"> MSA_CODE </strong> —由于给定的类别中没有顺序，所以我们将对这个变量进行热编码。</li><li id="4090" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">商店细分分为三类:高档、主流和超值。高档商店就像它们听起来的那样；它们通常位于高收入社区，提供更高端的产品。主流是中间路线，大多位于中产阶级地区，提供高档和价值产品的组合。超值商店更多地迎合低收入顾客，所以低价会比其他东西更受关注。</li></ul><p id="e5b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我们将<strong class="ix hj">值映射为1 </strong>，<strong class="ix hj">主流映射为2 </strong>，而<strong class="ix hj">高档映射为3 </strong></p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="2bdc" class="lt ki hi lp b fi lu lv l lw lx"># drop store name and address<br/>store_data = store_data.drop(columns=['STORE_NAME','ADDRESS_CITY_NAME'])</span><span id="aaad" class="lt ki hi lp b fi ly lv l lw lx"># OneHotEncode the rest of the categorical features<br/>ONE =ce.OneHotEncoder(cols=['ADDRESS_STATE_PROV_CODE', 'MSA_CODE'])</span><span id="0ce8" class="lt ki hi lp b fi ly lv l lw lx"># transform the data<br/>store_data = ONE.fit_transform(store_data)</span><span id="3fc9" class="lt ki hi lp b fi ly lv l lw lx">store_data.SEG_VALUE_NAME = store_data.SEG_VALUE_NAME.map({'value':1,'MAINSTREAM':2,'UPSCALE':3})</span><span id="b6fc" class="lt ki hi lp b fi ly lv l lw lx"># columns of the updated data<br/>store_data.columns</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/b494cd786078c29c8aeb8ceb98107d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DPL7X1QmMGAD9HbcXjk0Cw.png"/></div></div></figure><h1 id="64ad" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">2预处理:数字特征</h1><ul class=""><li id="ebd3" class="jt ju hi ix b iy lf jc lg jg lh jk li jo lj js jy jz ka kb bi translated">检查并估算数字特征中缺失的值。</li><li id="10e1" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">检查异常值并处理它们。</li></ul><h2 id="0fd9" class="lt ki hi bd kj lz ma mb kn mc md me kr jg mf mg kv jk mh mi kz jo mj mk ld ml bi translated">数据集1:每周销售数据</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="b3e0" class="lt ki hi lp b fi lu lv l lw lx">data.head()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/1f6353db93d878cc672460e47385e8b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aOco3Md_hq81duwquRoWsg.png"/></div></div></figure><p id="608c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每周销售数据具有以下数字特征:基本价格、单位(目标)</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="fc9b" class="lt ki hi lp b fi lu lv l lw lx"># check the null values for the numerical features<br/>data[[ 'BASE_PRICE', 'UNITS']].isna().sum()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es my"><img src="../Images/faee8d1bdaf38fe0558951ec515b05ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*M0ZAabhFu_4ETnwGu6EdkQ.png"/></div></figure><p id="05ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="mq">输入基础价格中的缺失值</em> </strong></p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="7284" class="lt ki hi lp b fi lu lv l lw lx"># creaating a new dataframe which will have "average base price" for the combination of STORE_NUM and UPC<br/># We will use this to impute the missing values<br/>avg_price = data.groupby(['STORE_NUM','UPC'])['BASE_PRICE'].mean().reset_index()</span><span id="b794" class="lt ki hi lp b fi ly lv l lw lx">avg_price</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/a22ffdcdfb4adaec15795e3f5f8fab41.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*Z5JPESVeAloH-0S6JoyIBg.png"/></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="87b7" class="lt ki hi lp b fi lu lv l lw lx"># null values in BASE PRICE<br/>data.loc[data.BASE_PRICE.isna() == True]</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/e1e785aab8a9c5c066b87d7ab1a8bb0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RTQUj10u6lk_lpda024XAw.png"/></div></div></figure><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="54f6" class="lt ki hi lp b fi lu lv l lw lx"># define function to fill missing base price values<br/>def fill_base_price(x) :<br/>    return avg_price.BASE_PRICE[(avg_price.STORE_NUM == x['STORE_NUM']) &amp; (avg_price.UPC == x['UPC'])].values[0]</span><span id="921a" class="lt ki hi lp b fi ly lv l lw lx">data.BASE_PRICE[data.BASE_PRICE.isna() == True] = data[data.BASE_PRICE.isna() == True].apply(fill_base_price, axis=1)<br/></span><span id="8100" class="lt ki hi lp b fi ly lv l lw lx"># scatter plot for UNITS variable<br/># sort the target variable and scatter plot to see if it has some outliers or not</span><span id="c5e7" class="lt ki hi lp b fi ly lv l lw lx">%matplotlib notebook<br/>plt.figure(figsize=(8,6))</span><span id="bd83" class="lt ki hi lp b fi ly lv l lw lx">plt.scatter(x = data.index, y = np.sort(data['UNITS'].values))</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/61be0959586276a91fd3ab4665c17ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8mn3u7HUeOKxNyhFd7KlYA.png"/></div></div></figure><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/12e3d6b8a8d37b8dfae4885f95e45a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W6QgoiMsF-EF1-Ix8ZExpQ.png"/></div></div></figure><p id="1e3d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，在上面的一些点上，单位超过750个，而它们的数量只有21个。因此，我们可以删除它们，因为它们的数量只有21，不会影响数据，这些数据会对我们的模型产生干扰。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es nd"><img src="../Images/f77f66937ce9198e70573d9f556b2556.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*wKTS2qFlBO9-2maUGQymBQ.png"/></div></figure><h2 id="c650" class="lt ki hi bd kj lz ma mb kn mc md me kr jg mf mg kv jk mh mi kz jo mj mk ld ml bi translated">商店数据具有以下数字特征</h2><ul class=""><li id="1ba6" class="jt ju hi ix b iy lf jc lg jg lh jk li jo lj js jy jz ka kb bi translated">停车位数量</li><li id="4f56" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">销售面积大小数量</li><li id="fbac" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">AVG _周刊_篮子</li></ul><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="d122" class="lt ki hi lp b fi lu lv l lw lx"># check for the null values<br/>store_data[['PARKING_SPACE_QTY', 'SALES_AREA_SIZE_NUM', 'AVG_WEEKLY_BASKETS']].isna().sum()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/534a466eba24d11d08bc3e0f048c2915.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*zXPxNkpwnV7eo9gWPmsF-w.png"/></div></figure><p id="3d21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">PARKING _ SPACE _ QTY检查其与SALES_AREA_SIZE_NUM的相关性</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="d6ea" class="lt ki hi lp b fi lu lv l lw lx"># check correlation<br/>store_data[['PARKING_SPACE_QTY','SALES_AREA_SIZE_NUM']].corr()</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es nf"><img src="../Images/b3d1f40f0c4566adad9a7fe0b9e07c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*gYAQBUxEF4N_Q7WPQbaqeA.png"/></div></figure><p id="97b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于<strong class="ix hj"> PARKING_SPACE_QTY </strong>与<strong class="ix hj"> SALES_AREA_SIZE_NUM </strong>的相关性很高，因此我们可以删除此列，因为它不会给模型增加太多价值。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="e6bd" class="lt ki hi lp b fi lu lv l lw lx"># drop the column<br/>store_data = store_data.drop(columns=['PARKING_SPACE_QTY'])</span></pre><h1 id="ff73" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">3保存更新的文件</h1><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="3d30" class="lt ki hi lp b fi lu lv l lw lx">data.to_csv('updated_train_data.cas', index=False)<br/>product_data.to_csv('updated_product_data.csv',index=False)<br/>store_data.to_csv('updated_store_data.csv',index=False)</span></pre><p id="f7e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为参考，请查看此处的笔记本。</p></div></div>    
</body>
</html>