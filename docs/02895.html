<html>
<head>
<title>Understanding Principle Component Analysis(PCA) step by step.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逐步理解主成分分析。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-principle-component-analysis-pca-step-by-step-e7a4bb4031d9?source=collection_archive---------0-----------------------#2020-01-07">https://medium.com/analytics-vidhya/understanding-principle-component-analysis-pca-step-by-step-e7a4bb4031d9?source=collection_archive---------0-----------------------#2020-01-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/501a945b71c0678dc4a9033472747428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GJvUxsU0q1tP4etd"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">诺德伍德主题公司在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="be77" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">介绍</h1><p id="fd5a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj">主成分分析</strong> ( <strong class="jv hj"> PCA </strong>)是一种用于降维的统计程序。它使用正交变换将一组可能相关变量的观察值转换为一组称为主成分的线性不相关变量的值。它经常被用作降维技术。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="d9d9" class="iv iw hi bd ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js bi translated">PCA中涉及的步骤</h1><p id="835f" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj"> <em class="ld">第一步:</em> </strong>将数据集标准化。</p><p id="8eb1" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><strong class="jv hj"> <em class="ld">步骤2: </em> </strong>计算数据集中要素的协方差矩阵。</p><p id="f25a" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><strong class="jv hj"> <em class="ld">第三步:</em> </strong>计算协方差矩阵的特征值和特征向量。</p><p id="15ce" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><strong class="jv hj"> <em class="ld">第四步:</em> </strong>对特征值及其对应的特征向量进行排序。</p><p id="dd2d" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><strong class="jv hj"> <em class="ld">第五步:</em> </strong>挑k个特征值，组成特征向量矩阵。</p><p id="07ca" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><strong class="jv hj">第六步:</strong>对原矩阵进行变换。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="9930" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">让我们一步一步来。</p><h2 id="c080" class="lj iw hi bd ix lk ll lm jb ln lo lp jf ke lq lr jj ki ls lt jn km lu lv jr lw bi translated"><strong class="ak"> 1。标准化数据集</strong></h2><p id="acbc" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">假设我们有下面的数据集，它有4个特征和总共5个训练示例。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/eee8814ac0d0b2f8294cfc61324bb09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*LRIwao7YjAvYfkWpWVrQ_A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">数据集矩阵</figcaption></figure><p id="864b" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">首先，我们需要标准化数据集，为此，我们需要计算每个要素的平均值和标准差。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/e45ff25480830f3080a72880a7ea14b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*X4YeGxtzOhnnOWBfoBBJfA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">标准化公式</figcaption></figure><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/85f0ef8974ef65c97abcd945fe40792b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*FmF9jyYmoapgK1_1U6UxfA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">标准化前的平均值和标准偏差</figcaption></figure><p id="1f8c" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">对数据集中的每个要素应用公式后，将进行如下变换:</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es me"><img src="../Images/d5876e074e5f651932749a0db99558fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*AGic5zirVFgu81HU4Srenw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">标准化数据集</figcaption></figure><h2 id="6ddd" class="lj iw hi bd ix lk ll lm jb ln lo lp jf ke lq lr jj ki ls lt jn km lu lv jr lw bi translated">2.计算整个数据集的协方差矩阵</h2><p id="48d5" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">计算协方差矩阵的公式:</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/e54dc2b1c703d3fbc2e3d97e96c2c5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*ptVjFC7JUJVgnoFEEt6R8w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">协方差公式</figcaption></figure><p id="d5b6" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">给定数据集的协方差矩阵计算如下</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/3c20c373f3b808ba095306094c66b39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*OqKstUmkOHkTO3dayB1QIA.png"/></div></figure><p id="b1af" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">因为我们已经标准化了数据集，所以每个特征的<strong class="jv hj">平均值为0 </strong>，标准差为1。</p><p id="b078" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">var(f1)=((-1.0-0)+(0.33-0)+(-1.0-0)+(0.33–0)+(1.33–0))/5<br/><strong class="jv hj">var(f1)= 0.8</strong></p><p id="e79d" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">cov(f1，F2)=<br/>(-1.0–0)*(-0.632456-0)+<br/>(0.33–0)*(1.264911-0)+<br/>(-1.0–0)*(0.632456-0)+<br/>(0.33–0)*(0.000000-0)+<br/>(1.33–0)*(-1.266</p><p id="c609" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">以类似的方式，他可以计算其他协方差，这将导致下面的协方差矩阵</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es md"><img src="../Images/363b0e487a7a4a0a5c1dba8bb6c8c969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*fyL-SEd7KhNT2WWTjdU_GQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">协方差矩阵(人口公式)</figcaption></figure><h2 id="1cc4" class="lj iw hi bd ix lk ll lm jb ln lo lp jf ke lq lr jj ki ls lt jn km lu lv jr lw bi translated">3.计算特征值和特征向量。</h2><p id="40ed" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj">特征向量</strong>是一个非零向量，当对其应用线性变换时，它最多改变一个标量因子。对应的<strong class="jv hj">特征值</strong>是特征向量缩放的因子。</p><p id="9ed6" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">设A是一个方阵(在我们的情况下是协方差矩阵)，ν a向量和λ a标量满足Aν = λν，则λ称为与A的特征向量ν相关联的特征值<br/>重新排列上面的等式，</p><blockquote class="mh"><p id="84b1" class="mi mj hi bd mk ml mm mn mo mp mq kq dx translated">aν-λν= 0；(A-λI)ν = 0</p></blockquote><p id="7f0d" class="pw-post-body-paragraph jt ju hi jv b jw mr jy jz ka ms kc kd ke mt kg kh ki mu kk kl km mv ko kp kq hb bi translated">因为我们已经知道ν是一个非零向量，这个方程可以等于零的唯一方法是，如果</p><blockquote class="mh"><p id="10b6" class="mi mj hi bd mk ml mm mn mo mp mq kq dx translated">det(A-λI) = 0</p></blockquote><figure class="mx my mz na nb ij er es paragraph-image"><div class="er es mw"><img src="../Images/c519418e548da5ebc158d75d60ff7d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*I-Zum-NHZUnZgACi_ePjuw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">A-λI = 0</figcaption></figure><p id="3bf9" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">解上面的方程= 0</p><p id="9f56" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><strong class="jv hj"> <em class="ld"> λ = 2.51579324，1.0652885，0.39388704，0.02503121 </em> </strong></p><p id="976f" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><strong class="jv hj">特征向量:</strong></p><p id="1dc7" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">求解具有不同λ值的ν向量的(A-λI)ν = 0方程:</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/2fe0ef00094b689e0c5bb98734139c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*isDsfzvBy8OkFpWib65Uuw.png"/></div></figure><p id="6ce9" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">对于λ = <em class="ld"> 2.51579324，使用克莱姆法则求解上述方程，v向量的值为</em></p><p id="d4d7" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated"><em class="ld">v1 = 0.16195986<br/>v2 =-0.52404813<br/>v3 =-0.58589647<br/>v4 =-0.59654663</em></p><p id="4ef8" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">通过同样的方法，我们可以计算其他特征值的特征向量。我们可以用特征向量来构造矩阵。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/602d2b75c91590674971490815aae739.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*Q7vYpDjZzA_CBk2jZinVkg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">特征向量(4 * 4矩阵)</figcaption></figure><h2 id="fc99" class="lj iw hi bd ix lk ll lm jb ln lo lp jf ke lq lr jj ki ls lt jn km lu lv jr lw bi translated"><strong class="ak"> <em class="nd"> 4。</em>对特征值及其对应的特征向量进行排序。</strong></h2><p id="3c7e" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">因为在这种情况下特征值已经排序，所以不需要再次排序。</p><h2 id="7e3b" class="lj iw hi bd ix lk ll lm jb ln lo lp jf ke lq lr jj ki ls lt jn km lu lv jr lw bi translated"><strong class="ak"> <em class="nd"> 5。</em> </strong>挑选k个特征值，形成一个特征向量矩阵</h2><p id="f124" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">如果我们选择前2个特征向量，矩阵将如下所示:</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/ea9088f5097e8a5bae6d039799c81ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*meALpdF0_Ry7SzIRafwFLg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">前2个特征向量(4*2矩阵)</figcaption></figure><h2 id="f7c4" class="lj iw hi bd ix lk ll lm jb ln lo lp jf ke lq lr jj ki ls lt jn km lu lv jr lw bi translated">6。变换原矩阵。</h2><p id="970b" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">特征矩阵*前k个特征向量=转换后的数据</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/ef85776afea5458a9a5c0e93a0945725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mnMItx1CCKgiFtCRPi97wA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">数据转换</figcaption></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="850d" class="iv iw hi bd ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js bi translated">比较sklearn库</h1><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ng"><img src="../Images/aff4732138a2214d687d0f88cc387687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yj9_E_ZP-JGthHiKFPdmKA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用Sklearn的PCA的代码片段</figcaption></figure><p id="0338" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">结果是一样的，只有PC1的方向发生了变化，根据我的说法，没有任何区别，就像这里提到的<a class="ae iu" href="https://stats.stackexchange.com/questions/30348/is-it-acceptable-to-reverse-a-sign-of-a-principal-component-score" rel="noopener ugc nofollow" target="_blank">和</a>一样。因此，我们已经成功地将我们的数据从4维转换到2维。当数据特征高度相关时，PCA最有用。</p><p id="44ae" class="pw-post-body-paragraph jt ju hi jv b jw le jy jz ka lf kc kd ke lg kg kh ki lh kk kl km li ko kp kq hb bi translated">由于这是我的第一个博客，我欢迎大家提出建议，请务必在我的<a class="ae iu" href="https://github.com/gskdhiman/Understanding-PCA" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上查看上面的代码版本。</p></div></div>    
</body>
</html>