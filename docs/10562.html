<html>
<head>
<title>Predicting Diabetes with Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用神经网络预测糖尿病</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-diabetes-with-neural-networks-59be196bc30?source=collection_archive---------6-----------------------#2020-10-24">https://medium.com/analytics-vidhya/predicting-diabetes-with-neural-networks-59be196bc30?source=collection_archive---------6-----------------------#2020-10-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/15b40f1573d5ac8bee632ef3c5c3ebc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IJxyJh__userm-j_.png"/></div></div></figure><p id="ccba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">糖尿病是一种慢性疾病，据估计全世界有 4 . 15 亿人患有糖尿病。每年有 500 万例死亡可归因于糖尿病相关并发症，这是一种与新冠肺炎死亡相关的共病。</p><p id="d28f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">糖尿病的早期阶段通常没有症状，这对于早期检测和诊断是有问题的。不良饮食、缺乏锻炼和体重过重是重要原因。这与二型糖尿病的发作有关，后者是身体对胰岛素逐渐产生抵抗力的结果。1 型糖尿病的不同之处在于，它首先是由于身体无法产生足够的胰岛素。</p><p id="1536" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果早期诊断，二型糖尿病是可以预防和逆转的。我们可以使用机器学习来预测患者的糖尿病，使用生命统计数据，使用患者被诊断的数据集。通过训练神经网络，我们可以用它来对新患者进行预测。</p><h1 id="76fd" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">皮马印第安人糖尿病数据集</h1><p id="97a5" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">皮马印第安人是生活在亚利桑那州的一群美国土著人，由于他们易患糖尿病的遗传倾向而被研究。皮马印第安人的二型糖尿病发病率是世界上最高的。这个数据集来自<a class="ae kr" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>，由加州大学欧文分校机器学习知识库提供。该数据集是从女性收集的测量样本，以及患者在测量后五年内是否患糖尿病的指示。</p><h2 id="7330" class="ks jp hi bd jq kt ku kv ju kw kx ky jy jb kz la kc jf lb lc kg jj ld le kk lf bi translated">初步观察</h2><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/9e058e57aa3bc908c6b32b8a03f03a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WyW5h6_E8182jIHAQk_hJw.png"/></div></div></figure><p id="c496" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们有几个类别以及一个二元分类的结果。同样，通过绘制数据帧的直方图，我们可以看到总体的某些方面以及不应为 0 的值，如身体质量指数、血压或血糖。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/7d74b9890c47a214953e85568321668d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*dwEjl1-L3R-ANAGJpvdvfQ.png"/></div></figure><p id="a8db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在继续之前，需要替换或删除缺失值或 0 值。为了使神经网络有效工作，还需要对数据进行缩放。数据清理和预处理是另一个主题，我将在以后的文章中讨论。</p><h2 id="0fb6" class="ks jp hi bd jq kt ku kv ju kw kx ky jy jb kz la kc jf lb lc kg jj ld le kk lf bi translated">构建神经网络</h2><p id="862f" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">这个神经网络将通过使用 Sequential 类使用 Keras 来构建。</p><p id="e751" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是我的神经网络代码:</p><p id="2706" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[31]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="3531" class="ks jp hi ln b fi lr ls l lt lu"><strong class="ln hj">from</strong> <strong class="ln hj">keras.models</strong> <strong class="ln hj">import</strong> Sequential<br/>model = Sequential()</span></pre><p id="dda7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[32]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="c5be" class="ks jp hi ln b fi lr ls l lt lu"><strong class="ln hj">from</strong> <strong class="ln hj">keras.layers</strong> <strong class="ln hj">import</strong> Dense</span></pre><p id="9528" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[33]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="ed6e" class="ks jp hi ln b fi lr ls l lt lu"><em class="lv"># add first hidden layer</em><br/>model.add(Dense(32,activation='relu',input_dim=8))</span></pre><p id="4822" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[34]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="a761" class="ks jp hi ln b fi lr ls l lt lu"><em class="lv"># Second hidden layer</em><br/>model.add(Dense(16,activation='relu'))</span></pre><p id="0397" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[36]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="f126" class="ks jp hi ln b fi lr ls l lt lu"><em class="lv"># Output layer</em><br/>model.add(Dense(1,activation='sigmoid'))</span></pre><p id="6ce3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[37]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="d473" class="ks jp hi ln b fi lr ls l lt lu"><em class="lv"># Compile the model</em><br/>model.compile(optimizer='adam', loss='binary_crossentropy',metrics=['accuracy'])</span></pre><p id="964f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[38]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="7fbf" class="ks jp hi ln b fi lr ls l lt lu"><em class="lv"># Training for 200 epochs</em><br/>model.fit(X_train,y_train,epochs=200)</span><span id="c756" class="ks jp hi ln b fi lw ls l lt lu">Epoch 1/200<br/>491/491 [==============================] - 2s 3ms/step - loss: 0.6517 - accuracy: 0.6375<br/>.<br/>.<br/>.<br/>Epoch 200/200<br/>491/491 [==============================] - 0s 77us/step - loss: 0.2057 - accuracy: 0.9165</span></pre><p id="f1c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">训练 200 个历元后，准确率从 0.6375 提高到 0.9165。我的完整代码可以在<a class="ae kr" href="https://github.com/geomms/Neural-Network-Projects-with-Python/blob/master/Chapter02-Predicting%20Diabetes%20with%20Multilayer%20Perceptrons.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="0672" class="ks jp hi bd jq kt ku kv ju kw kx ky jy jb kz la kc jf lb lc kg jj ld le kk lf bi translated">结果分析</h2><p id="c48d" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">以下是测试集上预测结果的代码:</p><p id="ce85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[39]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="6514" class="ks jp hi ln b fi lr ls l lt lu"><em class="lv"># Train and Test accuracy</em><br/>scores = model.evaluate(X_train,y_train)<br/>print("Training Accuracy: <strong class="ln hj">%.2f%%\n</strong>" % (scores[1]*100))<br/>scores = model.evaluate(X_test,y_test)<br/>print("Testing Accuracy: <strong class="ln hj">%.2f%%\n</strong>" % (scores[1]*100))</span><span id="7617" class="ks jp hi ln b fi lw ls l lt lu">491/491 [==============================] - 1s 1ms/step<br/>Training Accuracy: 91.45%</span><span id="7924" class="ks jp hi ln b fi lw ls l lt lu">154/154 [==============================] - 0s 645us/step<br/>Testing Accuracy: 79.87%</span></pre><p id="2900" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[40]:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="a9c4" class="ks jp hi ln b fi lr ls l lt lu"><strong class="ln hj">from</strong> <strong class="ln hj">sklearn.metrics</strong> <strong class="ln hj">import</strong> confusion_matrix</span></pre><p id="d0d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在[42]中:</p><pre class="lh li lj lk fd lm ln lo lp aw lq bi"><span id="0904" class="ks jp hi ln b fi lr ls l lt lu">y_test_pred = model.predict_classes(X_test)<br/>cm = confusion_matrix(y_test,y_test_pred)<br/>ax = sns.heatmap(cm, annot=<strong class="ln hj">True</strong>, xticklabels=["No Diabetes",'Diabetes'], yticklabels=['No Diabetes','Diabetes'],<br/>                cbar=<strong class="ln hj">False</strong>,cmap='Blues')<br/>ax.set_xlabel('Prediction')<br/>ax.set_ylabel('Actual')<br/>plt.show()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/df05a49b62d39cc3ee02d7d9247d5159.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*dqpFwBc-mMtZCcqUBkz3KA.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">有假阳性和假阴性的混淆矩阵</figcaption></figure><p id="3a15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">测试集的准确率为 79.87%，对于一个简单的神经网络来说，这还不算太差，但肯定还可以提高。只有 9 个假阳性，但有 22 个假阴性。需要对该模型进行许多改进以降低错误诊断。该数据集只有八个类别，可能不足以真正做出准确的预测。特征工程比增加这种神经网络的复杂性更可能有用。</p></div></div>    
</body>
</html>