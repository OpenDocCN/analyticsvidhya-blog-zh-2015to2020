<html>
<head>
<title>Santander Customer Transaction Prediction: An End to End Machine Learning Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">桑坦德银行客户交易预测:端到端机器学习项目</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/santander-customer-transaction-prediction-an-end-to-end-machine-learning-project-2cb763172f8a?source=collection_archive---------4-----------------------#2019-11-11">https://medium.com/analytics-vidhya/santander-customer-transaction-prediction-an-end-to-end-machine-learning-project-2cb763172f8a?source=collection_archive---------4-----------------------#2019-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="5e74" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">你能确定谁将进行交易吗？</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f5022a3484419e0a47b5eea3b7aac538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4vg0lW_YVZluXxzdGMfCIQ.png"/></div></div></figure><h1 id="7d6b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">目录:</h1><ul class=""><li id="16db" class="jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">问题陈述</li><li id="3b4d" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">数据采集</li><li id="1916" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">评估指标</li><li id="68dc" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">数据描述</li><li id="c0d6" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">探索性数据分析</li><li id="0760" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">特征工程</li><li id="e011" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">解决方案1:具有简单特性的轻型GBM模型</li><li id="7e97" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">解决方案2:特性工程&amp;带有附加特性的LightGBM模型</li><li id="ca90" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">结论</li><li id="c624" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">遵循的程序</li><li id="be99" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">模型性能比较</li></ul><h1 id="d6cf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">问题陈述:</h1><p id="1f3f" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">在这个挑战中，桑坦德银行邀请卡格勒帮助他们识别哪些客户将在未来进行特定交易，而不管交易的金额。为这个竞赛提供的数据与我们可用来解决这个问题的真实数据具有相同的结构。</p><p id="ebab" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">数据是匿名的，每行包含200个数字值，仅用一个数字标识。</p><p id="1be4" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">我们将探索数据，为模型做准备，训练模型并预测测试集的目标值，然后准备提交。</p><h1 id="1bf6" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据采集:</h1><p id="7efb" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">这是卡格尔比赛的照片。从以下来源下载数据集。</p><p id="08c0" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">来源:</strong><a class="ae lg" href="https://www.kaggle.com/c/santander-customer-transaction-prediction/overview" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/桑坦德-客户-交易-预测/概述</a></p><h1 id="6fce" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">评估指标:</h1><p id="a853" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">在预测概率和观察目标之间的ROC曲线下的<strong class="jr hj">区域评估提交。</strong></p><h2 id="b7c1" class="lh ig hi bd ih li lj lk il ll lm ln ip jw lo lp it jy lq lr ix ka ls lt jb lu bi translated">提交文件</h2><p id="696a" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">对于测试集中的每个Id，您必须对目标变量进行二进制预测。该文件应包含一个标题，并具有以下格式:</p><p id="c2f5" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><code class="du lv lw lx ly b">ID_code,target<br/>test_0,0 <br/>test_1,1 <br/>test_2,0 <br/>etc.</code></p><h1 id="5699" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据描述</h1><p id="f18a" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">为您提供了一个匿名数据集，其中包含数字特征变量、二进制目标列和一个字符串<code class="du lv lw lx ly b">ID_code</code>列。</p><p id="e98b" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">任务是预测测试集中<code class="du lv lw lx ly b">target</code>列的值。</p><h2 id="69cf" class="lh ig hi bd ih li lj lk il ll lm ln ip jw lo lp it jy lq lr ix ka ls lt jb lu bi translated">文件描述</h2><ul class=""><li id="c8fc" class="jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">train.csv训练集。</li><li id="5a83" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">test.csv —测试集。测试集包含一些不包括在评分中的行。</li></ul><h1 id="f87c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">探索性数据分析</h1><p id="6ff7" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">让我们加载训练和测试文件。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/4984722c6f23d4a0b259ce845e899f18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RkhpuBl9Oekub1Q5WDd4rw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/6c3e7d59e0ab897390342dbaf1f172b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m3w_gFJJGVLGDICbaTi0qw.png"/></div></div></figure><p id="0f6b" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">训练和测试数据帧都有200000个条目。训练有202列，测试有201列。</p><p id="de34" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">列车包含:</p><ul class=""><li id="5cfe" class="jp jq hi jr b js lb ju lc jw mb jy mc ka md kc kd ke kf kg bi translated">ID_code(字符串)；</li><li id="3ff0" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">目标；</li><li id="c863" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">200个数值变量，命名从var_0到var _ 199</li></ul><p id="ab57" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">测试包含:</p><ul class=""><li id="9377" class="jp jq hi jr b js lb ju lc jw mb jy mc ka md kc kd ke kf kg bi translated">ID_code(字符串)；</li><li id="9a52" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">200个数值变量，命名从var_0到var _ 199</li></ul><h1 id="b4b6" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">检查缺失数据:</strong></h1><p id="68cb" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">让我们检查一下是否有丢失的数据。</p><p id="55eb" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">我们定义了一个助手函数<code class="du lv lw lx ly b">missing_data</code>，并应用于训练和测试数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es me"><img src="../Images/dd8c19eee248e0018ae6b1a6cc9c6471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yPrITEuZgTEam5cWG5WbYw.png"/></div></div></figure><p id="1b40" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">在训练和测试数据集中没有丢失数据。</p><p id="eb56" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">让我们检查训练集和测试集中的数值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/ed4f16c6ea0be82f8e889ab784e527fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QrAOPi1eJmOkCntJb6Bj5A.png"/></div></div></figure><p id="1f9f" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">观察:</strong></p><ul class=""><li id="d554" class="jp jq hi jr b js lb ju lc jw mb jy mc ka md kc kd ke kf kg bi translated">对于训练和测试变量数据，标准偏差相对较大</li><li id="0b2e" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">训练和测试数据的最小、最大、平均、sdt值看起来非常接近</li><li id="fd10" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">平均值分布在很大的范围内</li></ul><p id="6392" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">让我们检查一下<code class="du lv lw lx ly b">target</code>值在训练数据集中的分布。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/dc5a9ad6a1106293ac820fbd56de0396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHNskRImYuTkZ8aae9ERsA.png"/></div></div></figure><p id="bc8f" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">观察:</strong></p><p id="4ad9" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">我们可以看到数据是不平衡的。多数值将0作为目标值。</p><p id="d10b" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">平均值和标准差的分布:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mh"><img src="../Images/f7eeda279efd51e24a64898e72ba750b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UlPLDiRMgtMmNp7oT5neA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mi"><img src="../Images/a5d2fe0cfb37d0a557412ff4ad39c5c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ncm8x9zMIjHOsM31EBvHeg.png"/></div></div></figure><h2 id="5e9f" class="lh ig hi bd ih li lj lk il ll lm ln ip jw lo lp it jy lq lr ix ka ls lt jb lu bi translated">偏斜度和峰度的分布:</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/f6690f8b9dfff4eb0d9fdd82130d5bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clhDs8lwxG5wclBDYKRcoA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/03012a5ff6a551eaf45f64173755a6e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*huyXMQQNHwljc3BVYkUNHA.png"/></div></div></figure><h2 id="5f9f" class="lh ig hi bd ih li lj lk il ll lm ln ip jw lo lp it jy lq lr ix ka ls lt jb lu bi translated"><strong class="ak">特征相关性:</strong></h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/24725ee4ef1a4bee3e38fbb338ef45ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPuQdfTKA4za83cZby5pPg.png"/></div></div></figure><p id="f87f" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">特征之间的相关性非常小。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/9535e5c5c78092d4cfd1207792de8b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2H_OLg8812roiDvHBK2k_w.png"/></div></div></figure><h1 id="89a1" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">重复值:</h1><p id="f3e6" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">让我们检查在训练和测试数据集中是否有任何重复的值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/00a2c78ed189e3ebc8892ff4b53430df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qoagtGYaIgrKTn6t8NY0qg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/93a15fc788d744cefe32fc0dcd63f3ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KuT_XW6TxuN6VjBPik15nw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mp"><img src="../Images/aabe343f5d7d1dd5902d7bffd69b4439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lB9ryqCruxjHOe6dZjXIQg.png"/></div></div></figure><p id="3f1d" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">我们可以看到，上面显示了训练集和测试集中的重复值和前15个最大重复值。</p><p id="8eb9" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">观察:</strong>训练和测试中的相同列具有相同或非常接近的重复数。</p><h1 id="9bc0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">特征工程</h1><p id="c1a0" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">让我们创建简单的特征，如总和、最小值、最大值、平均值、标准差、偏斜、库尔特和中位数，如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/a52868c39d2f0a42d4abc2cb324a5cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwjjoE6eb2LECEHI79utpQ.png"/></div></div></figure><p id="b251" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">让我们检查一下新创建的特征:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mq"><img src="../Images/85cf4d3bb6ed846f0ed7fce945fe4e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iEoI_8X5M9b8SN9qepS9CA.png"/></div></div></figure><p id="beec" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">让我们检查一下这些新设计的特性的分布情况。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/6b6e9c78da4629c4d3c5e24971f5122b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utjJOY4lbGRR8EYfxRCpsA.png"/></div></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">新特征在训练数据集中的分布</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/57ea1c44d56e3f3e06e18bee08e05a45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*34onJDFwZCXj7J7Gm1FOLw.png"/></div></div><figcaption class="mr ms et er es mt mu bd b be z dx translated">测试数据集中新特征的分布</figcaption></figure><p id="bf22" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">圆形特征:</p><p id="ce4c" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">让我们创建一些圆形特征如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mw"><img src="../Images/350726557ce4b9922fa002282f5e04c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovy-3bFvIQq9uqETVMPW3Q.png"/></div></div></figure><p id="c14a" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">让我们看看这些功能是什么样子的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/7fa6c023eaafc31ea78f02b5933f1ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*law2o6en1Qz3lSljPDrJ3g.png"/></div></div></figure><p id="0069" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">现在让我们建立机器学习模型。</p><h1 id="c8d8" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">解决方案1:具有简单功能的轻型GBM模型:</h1><blockquote class="my mz na"><p id="8e5e" class="km kn nb jr b js lb ko kp ju lc kq kr nc ld kt ku nd le kw kx ne lf kz la kc hb bi translated"><strong class="jr hj"> <em class="hi">什么是轻GBM？</em>T12】</strong></p></blockquote><p id="c9b3" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">Light GBM是一个梯度推进框架，使用基于树的学习算法。</p><blockquote class="my mz na"><p id="5a21" class="km kn nb jr b js lb ko kp ju lc kq kr nc ld kt ku nd le kw kx ne lf kz la kc hb bi translated"><strong class="jr hj"> <em class="hi">它与其他基于树的算法有何不同？</em> </strong></p></blockquote><p id="fb82" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">轻型GBM垂直生长树</strong>而其他算法水平生长树，这意味着轻型GBM逐叶生长树<strong class="jr hj">而其他算法逐级生长。它会选择delta损失最大的叶子来生长。当生长相同的叶子时，逐叶算法可以比逐层算法减少更多的损失。</strong></p><p id="af17" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">光GBM模型的超参数:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/e6bcfaf070a53e6e7ceddbcbf9279039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9mF4WBLspPu4lGYKrSzuA.png"/></div></div></figure><p id="c3ea" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">让我们用上面选择的超参数来训练模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ng"><img src="../Images/8f6c4a11bb47bf077db610916bf02fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCmET1_wsUirsu_Nifz09w.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nh"><img src="../Images/efa097f7719beb69604d80a910852b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KeM8R6637YRex3CeItoluw.png"/></div></div></figure><p id="4ab8" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">特征重要性:</strong></p><p id="32d8" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">从该模型中观察到的一些最重要的特征如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ni"><img src="../Images/7d6990c3520cbb51051e82d48165d30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e6P7KUlPddCCm4_vn_Amdg.png"/></div></div></figure><p id="0427" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">测试数据预测:</strong></p><p id="657e" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">现在让我们预测测试数据的结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ng"><img src="../Images/24a28b81fd43a4bae891732dcedb7652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_4gQRPbHeJFQ8jl_w47Iw.png"/></div></div></figure><blockquote class="nj"><p id="8705" class="nk nl hi bd nm nn no np nq nr ns kc dx translated">结果:排行榜得分:AUC — 0.90014(排名335，最高3.8%)</p></blockquote><h1 id="8fad" class="if ig hi bd ih ii ij ik il im in io ip iq nt is it iu nu iw ix iy nv ja jb jc bi translated">解决方案2:特征工程和LightGBM模型</h1><h1 id="bcb5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">特征工程和数据扩充</h1><h2 id="161e" class="lh ig hi bd ih li lj lk il ll lm ln ip jw lo lp it jy lq lr ix ka ls lt jb lu bi translated">1.分离真实/合成测试数据和魔术特征</h2><p id="c671" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">使用一行中的唯一值计数来识别合成样品。如果一行在一个特征中至少有一个唯一值，那么它是真实的，否则它是合成的。YaG320在这个内核中共享了这种技术——伪样本列表和公/私LB拆分(参考:<a class="ae lg" href="https://www.kaggle.com/yag320/list-of-fake-samples-and-public-private-lb-split" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/YAG 320/List-of-Fake-Samples-and-Public-Private-LB-split</a>)，并成功识别测试集中的合成样本。通过这种方式，可以捕获测试集特征的分布峰值上的异常凸起。魔术特征是从测试集中的训练集和真实样本的组合中提取的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nw"><img src="../Images/c33ca32f55d30d0131b719d6c267b7c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22qoTChvpX7ZW1HshVGyDg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nx"><img src="../Images/648efe122089fcfd7de35352ef882e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*II3kRi6VrFG7_9bKxOti_A.png"/></div></div></figure><h2 id="c8ec" class="lh ig hi bd ih li lj lk il ll lm ln ip jw lo lp it jy lq lr ix ka ls lt jb lu bi translated">2.数据扩充</h2><p id="b001" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">数据扩充意味着增加数据点的数量。过采样数据会显著增加CV和排行榜分数，因为数据是不平衡的。这个过采样技术在这个内核中被刘继伟分享(参考:【https://www.kaggle.com/jiweiliu/lgb-2-leaves-augment】<a class="ae lg" href="https://www.kaggle.com/jiweiliu/lgb-2-leaves-augment" rel="noopener ugc nofollow" target="_blank">)。</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ny"><img src="../Images/323a08e8b446cd02dd058d75ac92c6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DbiKl8LHNz1Za_W-mNNp4Q.png"/></div></div></figure><p id="cd1d" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">现在让我们尝试用LighGBM模型来实现这些。</p><h1 id="87e1" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">模型— LightGBM梯度推进决策树</h1><p id="9120" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated">模型的超参数:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nz"><img src="../Images/f3897e254e55ae166c96e0e021ac27d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgOPeg5HcvmExGsn2k0DUw.png"/></div></div></figure><p id="a033" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">实施:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es oa"><img src="../Images/a0eeded759edec6262e51a587da377a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MgerUnywZWZPSISFXaW1Pg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ny"><img src="../Images/0cb36ff3c35db6fa5cee11a1cf320ff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dBTBash9wWzyAclok4ouoQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ob"><img src="../Images/8b0e87f58e83b794ef37b94b463c8656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zbSdt4CJYf5Ek7H_1GDD3g.png"/></div></div></figure><p id="f6ac" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">功能重要性:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es oc"><img src="../Images/914ec1518600913a247ec28dba3ea1f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UEoIHfENkBwrAFCFrsJwUw.png"/></div></div></figure><p id="97ab" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated"><strong class="jr hj">测试数据预测及提交:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es od"><img src="../Images/55a25610b53be286e4c40dc29aaadaa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zFWhSM23-JjRf204mR4IaA.png"/></div></div></figure><blockquote class="nj"><p id="2336" class="nk nl hi bd nm nn no np nq nr ns kc dx translated">结果:排行榜得分:AUC — 0.92358(排名19，为前1%)</p></blockquote><h1 id="3ed1" class="if ig hi bd ih ii ij ik il im in io ip iq nt is it iu nu iw ix iy nv ja jb jc bi translated">结论:</h1><h1 id="3c9f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">遵循的程序</h1><ol class=""><li id="7eef" class="jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc oe ke kf kg bi translated">对训练和测试数据集进行探索性数据分析。</li><li id="f14e" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">对缺失值和重复数据执行检查。</li><li id="e13f" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">观察各种密度图、平均值分布图、偏度图、峰度图、训练图和测试图以及目标值1和0。</li><li id="c10d" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">观察特征之间是否有任何关联</li><li id="3b78" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">执行特征工程并创建特征</li><li id="037e" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">对这些特征应用机器学习模型光梯度增强机器，并观察到0.90014的ROC。</li><li id="8437" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">为了进一步提高模型的得分，采用连续唯一值计数来识别合成样本，区分真实样本和合成样本。使用这些数据在训练集和测试集中创建了神奇的特性。</li><li id="9d2c" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">作为数据扩充步骤，由于数据不平衡，执行了数据过采样。</li><li id="893a" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc oe ke kf kg bi translated">再次应用机器学习模型lightGBM和新创建的神奇功能，它帮助ROC得分提高到0.92358。</li></ol><h1 id="13d0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">模型性能比较</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es of"><img src="../Images/7da0045ce458ef38747099fbcbb251bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hm4PyqcgPno8WvEMmx6cyQ.png"/></div></div></figure><p id="e638" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">具有额外功能的轻型GBM将模型分数提高到0.92358，这非常接近kaggle的排行榜最高分数。肯定可以做得更多。</p><p id="379d" class="pw-post-body-paragraph km kn hi jr b js lb ko kp ju lc kq kr jw ld kt ku jy le kw kx ka lf kz la kc hb bi translated">感谢阅读！</p><h1 id="5777" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">参考资料:</h1><p id="9e30" class="pw-post-body-paragraph km kn hi jr b js jt ko kp ju jv kq kr jw ks kt ku jy kv kw kx ka ky kz la kc hb bi translated"><a class="ae lg" href="https://www.kaggle.com/c/santander-customer-transaction-prediction/notebooks" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/Santander-customer-transaction-prediction/notebooks</a></p></div></div>    
</body>
</html>