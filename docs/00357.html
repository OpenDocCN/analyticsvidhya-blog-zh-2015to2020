<html>
<head>
<title>Natural Language Processing: Experimenting Entity Recognition ( Part 2 AWS Comprehend NLP API)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然语言处理:实验实体识别(第2部分AWS理解NLP API)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/natural-language-processing-experimenting-entity-recognition-part-2-aws-comprehend-nlp-api-1722e80eeb3d?source=collection_archive---------4-----------------------#2019-04-22">https://medium.com/analytics-vidhya/natural-language-processing-experimenting-entity-recognition-part-2-aws-comprehend-nlp-api-1722e80eeb3d?source=collection_archive---------4-----------------------#2019-04-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7d0870e86889e50a10457ce9473d77a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uy8zKcQP5nxg2KUH6rFcqw.jpeg"/></div></div></figure><h1 id="5079" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="6e2f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在本系列的第一篇文章中，我们展示了如何使用Google NLP API从个人资料中提取单词，并将其与工作描述进行比较。在第二篇文章中，让我们使用AWS(Amazon Web Services)understand API做同样的实验。我们将再次使用R，但是同样的事情在Python中也可以很容易地完成，我们将在文章的最后展示如何做。</p><h1 id="47ac" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">使用AWS理解API和R进行实体检测</h1><h2 id="adc6" class="km ir hi bd is kn ko kp iw kq kr ks ja jz kt ku je kd kv kw ji kh kx ky jm kz bi translated">在AWS IAM控制台中设置测试用户</h2><p id="9615" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">首先，您必须有一个AWS的注册帐户，因为不建议使用您的根用户来访问AWS服务，让我们为我们的实验创建一个特定的用户。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/bc01d4c4ae26d1deb6e96d35a24982cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7QE77lTNdMrdBRoyEYfuCQ.png"/></div></div></figure><p id="382c" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">在下一页，将要求您将用户分配到预定义的组(或创建特定的组)。例如，我定义了一个对AWS understand拥有完全访问权限的组，我将把测试用户分配到这个组。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/f7e482fabeca8628df530077f030efcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O64ow7CQN62CFv6jIVzN3A.png"/></div></div></figure><p id="33d0" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">成功创建用户后，您将能够下载用户凭证，这是稍后能够访问AWS API的关键信息，因此请将其保存在安全的地方。</p><h2 id="3cf7" class="km ir hi bd is kn ko kp iw kq kr ks ja jz kt ku je kd kv kw ji kh kx ky jm kz bi translated">用R做实验</h2><p id="2a3a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">为了用R测试AWS API，我们将使用AWS . understand R包和库:</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="3c5a" class="km ir hi lm b fi lq lr l ls lt">install.packages('aws.comprehend')<br/>library(aws.comprehend)</span></pre><p id="0224" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">请注意，如果您想使用这个库，它的检测实体功能会有问题，所以如果您想使用它，请查看github中的修复程序。</p><p id="fa84" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">现在是时候使用您之前保存的访问密钥ID和秘密访问密钥了，它们应该在aws的环境变量中定义。</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="1045" class="km ir hi lm b fi lq lr l ls lt">Sys.setenv("AWS_ACCESS_KEY_ID" = "xxxxxxxxxxxx",<br/>           "AWS_SECRET_ACCESS_KEY" = "yyyyyyyyyyyyyyyyyyyyyyyyy",<br/>           "AWS_DEFAULT_REGION" = "us-east-1")</span></pre><p id="3937" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">正如上一篇文章<a class="ae lu" rel="noopener" href="/@patrick.rotzetter/natural-language-processing-experimenting-entity-recognition-with-google-amazon-nltk-and-maybe-b1fe673efe46">https://medium . com/@ Patrick . rotz etter/natural-language-processing-experimenting-entity-recognition-with-Google-Amazon-nltk-and-maybe-B1 Fe 673 EFE 46，</a>我们使用以下代码读取PDF文件并做一些预处理</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="1943" class="km ir hi lm b fi lq lr l ls lt"># read PDF file using pdftools library<br/>library(pdftools)<br/>library(stringr)<br/>text &lt;- pdf_text("xxxxxx.pdf")<br/>textCV&lt;-paste(text,collapse = " ")<br/>textCV=str_replace_all(textCV,"[^[:graph:]]", " ") <br/>text &lt;- pdf_text("yyyyyyy.pdf")<br/>textJob&lt;-paste(text,collapse = " ")<br/>textJob=str_replace_all(textJob,"[^[:graph:]]", " ")</span><span id="f768" class="km ir hi lm b fi lv lr l ls lt"># clean the text, remove numbers and make everything lower case</span><span id="27df" class="km ir hi lm b fi lv lr l ls lt">library(tm)<br/>library(stringi)<br/>clean_corpus &lt;- function(corpus){<br/>  corpus &lt;- tm_map(corpus, removeNumbers)<br/>  corpus &lt;- tm_map(corpus, content_transformer(stri_trans_tolower))<br/>  return(corpus)<br/>}<br/>text_corpus_clean_CV&lt;-clean_corpus(VCorpus(VectorSource(textCV)))</span></pre><p id="5f63" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">现在我们准备调用AWS NLP API，在这种情况下，我们将使用“检测语法”功能，文本将被分析，单词将被分类为名词、动词、副词等。</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="1d7e" class="km ir hi lm b fi lq lr l ls lt">awsJobSyntax&lt;-detect_syntax(textJob)</span></pre><p id="2085" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">我们将从AWS结果中过滤所有名词，并按名词对它们进行分组和计数:</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="2a21" class="km ir hi lm b fi lq lr l ls lt">awsDetectedNounsinJob&lt;-awsJobSyntax %&gt;% filter(PartOfSpeech.Tag=='NOUN')  %&gt;% group_by(Text) %&gt;% summarise(count = n())</span></pre><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/370bfaf806ec78e028c044c534d31b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aBssVJHEqStb3HlNCLbH2w.png"/></div></div></figure><p id="8c5f" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">与Google API的结果相比，我们可以看到一个单词被识别的次数有一些显著的差异，例如，在之前的实验中，我们有144次使用单词“projects ”,而使用AWS有14次。</p><h1 id="37df" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">尝试Python</h1><h2 id="4f09" class="km ir hi bd is kn ko kp iw kq kr ks ja jz kt ku je kd kv kw ji kh kx ky jm kz bi translated">设置AWS命令行界面</h2><p id="80d0" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">为了能够与AWS understand API进行交互，您需要下载AWS命令行界面(CLI ),并使用您之前存储的凭据对其进行配置。(更多信息请参见<a class="ae lu" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/CLI/latest/user guide/CLI-chap-configure . html</a>)</p><h2 id="c1b5" class="km ir hi bd is kn ko kp iw kq kr ks ja jz kt ku je kd kv kw ji kh kx ky jm kz bi translated">使用Python API</h2><p id="7d39" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">boto3库是用于Python的Amazon Web Services (AWS) SDK。所以首先导入库</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="a37b" class="km ir hi lm b fi lq lr l ls lt">import boto3<br/></span></pre><p id="6c6b" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">然后实例化一个instantiate对象，用“instantiate”作为boto3.client调用的参数</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="a39e" class="km ir hi lm b fi lq lr l ls lt">comprehend = boto3.client(service_name='comprehend', region_name='us-east-1')</span></pre><p id="31a5" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">您可以使用任何流行的PDF库来阅读您的PDF文件，例如</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="077b" class="km ir hi lm b fi lq lr l ls lt">def readPdfFileComprehend(filename):<br/>    text=list()<br/>    read_pdf = PyPDF2.PdfFileReader(filename)   <br/>    for i in range(read_pdf.getNumPages()):<br/>        page = read_pdf.getPage(i)<br/>        txt=page.extractText()<br/>        text.append(txt)<br/>    return text</span></pre><p id="2a4b" class="pw-post-body-paragraph jo jp hi jq b jr lf jt ju jv lg jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">一旦有了想要分析的文本，只需调用检测实体函数就可以了</p><pre class="lb lc ld le fd ll lm ln lo aw lp bi"><span id="41cb" class="km ir hi lm b fi lq lr l ls lt">entities = comprehend.detect_entities(Text=text, LanguageCode='en')</span></pre></div></div>    
</body>
</html>