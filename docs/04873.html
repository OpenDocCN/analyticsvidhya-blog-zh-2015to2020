<html>
<head>
<title>How Europe is generating electricity — Analysis with Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">欧洲是如何发电的——用Plotly分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-europe-is-generating-electricity-analysis-with-plotly-3819e9ec61c2?source=collection_archive---------21-----------------------#2020-04-03">https://medium.com/analytics-vidhya/how-europe-is-generating-electricity-analysis-with-plotly-3819e9ec61c2?source=collection_archive---------21-----------------------#2020-04-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="94f1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">近距离观察欧洲的电力生产，使用Plotly库生成交互式图表。</h2></div><p id="ba2c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated">根据EN 21社区的报告“可再生能源全球现状报告(GSR)”，2017年可再生能源占全球发电能力净增加的70%，但2017年全球与能源相关的二氧化碳排放量增加了1.4%。</p><p id="db08" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">发电跟踪是跟踪电力部门去碳化的一种重要方法，以便了解每种能源对电力供应的贡献。这类数据有几个来源，今天我们将与国际可再生能源机构合作。你可以去https://www.irena.org/<a class="ae kc" href="https://www.irena.org/" rel="noopener ugc nofollow" target="_blank">网站查看所有关于能源的信息和数据。</a></p><p id="063a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下图显示了1990年至2017年欧洲的发电量。我们可以注意到煤和石油的减少，水电和核能发电几乎不变，而可再生能源却在增加。此图中的一个问题是一些来源的比例不同，使得它们在此图中几乎不可见。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kd"><img src="../Images/c2e2c9afc26af5ce5be427848ef4f7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygCfe40QgwboqZl2Csl8cQ.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">欧洲的发电。数据来源:国际可再生能源机构。</figcaption></figure><p id="7e57" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当你做报告时，根据你要讲的故事，用适当的方式展示你的研究是很重要的。在之前的图表(用Matplolib制作)中，如果你想关注可再生能源，这不是展示数据的最佳方式。</p><blockquote class="kt ku kv"><p id="3f5a" class="ix iy kw iz b ja jb ij jc jd je im jf kx jh ji jj ky jl jm jn kz jp jq jr js hb bi translated"><a class="ae kc" rel="noopener" href="/@lugoafonso/wind-energy-in-europe-and-data-science-1228cb83b0c1">查看这本关于欧洲风能和Matplotlib的出版物。</a></p></blockquote><p id="e55d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的视频是用<a class="ae kc" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hj"> Plotly </strong> </a>交互方式呈现的相同数据。使用这个工具，我们可以缩放绘图区域，查看屏幕上的值，取出一些源，将它们添加回去，甚至保存修改后视图的图像。</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es lc"><img src="../Images/46a1b43ba62fcc73f5974c6c1e35313f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvogHRMXayiKSvdy4m5Hxw.png"/></div></div></figure><p id="795f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有几种方法可以使这种形象化，我将向你展示其中一种容易理解的方法。我们将使用<a class="ae kc" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>读取CSV文件，使用<a class="ae kc" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>操作数据，使用<a class="ae kc" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>创建可视化。因此，第一步是导入您将使用的库，然后从Pandas调用类‘read _ CSV’来加载数据。</p><pre class="ke kf kg kh fd ld le lf lg aw lh bi"><span id="a31f" class="li lj hi le b fi lk ll l lm ln">import pandas as pd<br/>import plotly.graph_objects as go<br/>import numpy as np</span><span id="b327" class="li lj hi le b fi lo ll l lm ln">#Load the csv file with Pandas<br/>df = pd.read_csv('Electricity generation by source - Europe.csv')</span></pre><p id="be33" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用“df.head()”查看数据帧的前05行总是有用的。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es lp"><img src="../Images/c86c9b1ba3a338cd425e206c477fff4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bY1O1eR00YVkw3dwVUBT9Q.png"/></div></div></figure><p id="3287" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一些值被加载为NaN(不是数字),这对我们的分析不利。我们可以使用df.fillna(0)将这些NaN值替换为零，如下图所示。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es lp"><img src="../Images/1f72d2009b483408e094019aee778465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3xOUueP1QBU0nvOScmVdg.png"/></div></div></figure><p id="54c2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们使用Numpy中的类‘as array’来操作Pandas数据框中的数据。</p><pre class="ke kf kg kh fd ld le lf lg aw lh bi"><span id="8924" class="li lj hi le b fi lk ll l lm ln">#Transform all the columns into arrays with Numpy<br/>years = np.asarray(df['Year'])<br/>coal = np.asarray(df['Coal'])<br/>oil = np.asarray(df['Oil'])<br/>natgas = np.asarray(df['Natural gas'])<br/>biofuels = np.asarray(df['Biofuels'])<br/>waste = np.asarray(df['Waste'])<br/>nuclear = np.asarray(df['Nuclear'])<br/>hydro = np.asarray(df['Hydro'])<br/>gethermal = np.asarray(df['Geothermal'])<br/>sol_pv = np.asarray(df['Solar PV'])<br/>sol_therm = np.asarray(df['Solar thermal'])<br/>wind = np.asarray(df['Wind'])<br/>tide = np.asarray(df['Tide'])<br/>other = np.asarray(df['Other sources'])</span></pre><p id="dfd9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们可以通过创建一个图形并添加之前创建的每个阵列的图来开始绘制图形。参数“fill = 'tonexty '”用于在每个区域的顶部创建一个区域，“stackgroup = 'one '”为所有源创建一个组，而“mode = 'none '”用于删除区域的线条。</p><pre class="ke kf kg kh fd ld le lf lg aw lh bi"><span id="bb97" class="li lj hi le b fi lk ll l lm ln">#Create a figure and add the stacked lines with Plotly.graph<br/>fig = go.Figure()<br/>fig.add_trace(go.Scatter(x = years, y = coal, name= 'Coal', fill = 'tonexty', stackgroup= 'one', mode= 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = natgas, name = 'Natural Gas', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = oil, name = 'Oil', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = biofuels, name = 'Biofuels', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = waste, name='Waste', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = nuclear, name = 'Nuclear', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = hydro, name = 'Hydro', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = gethermal, name = 'Geothermal', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = sol_pv, name = 'Solar PV', fill ='tonexty', stackgroup='one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = sol_therm, name = 'Solar Thermal', fill ='tonexty', stackgroup='one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = wind, name='Wind', fill = 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = tide, name='Tide', fill= 'tonexty', stackgroup = 'one', mode = 'none'))<br/>fig.add_trace(go.Scatter(x = years, y = other, name = 'Others', fill = 'tonexty', stackgroup = 'one', mode = 'none'))</span></pre><p id="581d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们可以自定义图形的情节，添加一个标题，标签y和x，图例和一切我们认为是必要的。</p><pre class="ke kf kg kh fd ld le lf lg aw lh bi"><span id="715f" class="li lj hi le b fi lk ll l lm ln">#Customize the graph<br/>fig.update_layout(title={'text':'Europe Electricity Generation by Source','y':0.9,'x':0.5,'xanchor':'center','yanchor':'top'},<br/>    xaxis_tickfont_size=12,<br/>    yaxis=dict(title='Electricity [TWh]', titlefont_size=12, tickfont_size=12,),<br/>    legend=dict(x=0, y=-0.1, bgcolor='rgba(255, 255, 255, 0)', bordercolor='rgba(255, 255, 255, 0)'),<br/>    legend_orientation="h"<br/>)<br/>fig.show()</span></pre><p id="f02c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Python可能是数据分析的最佳语言，因为它易于理解，并且它提供了各种各样的工具来操作我们的数据并创建多种类型的可视化，这些可视化可用于内部分析以及最终报告或现场演示。</p><p id="885e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读！</p><p id="de20" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">推特<a class="ae kc" href="https://twitter.com/afonso_lugo" rel="noopener ugc nofollow" target="_blank"> @afonso_lugo </a></p><p id="8777" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">领英<a class="ae kc" href="https://www.linkedin.com/in/afonso-lugo-03055727/" rel="noopener ugc nofollow" target="_blank">阿丰索卢戈</a></p></div></div>    
</body>
</html>