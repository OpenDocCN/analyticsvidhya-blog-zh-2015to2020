<html>
<head>
<title>Predicting Life Expectancy, Part 2: Using Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测预期寿命，第2部分:使用线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-life-expectancy-part-2-using-linear-regression-98d1d95473?source=collection_archive---------15-----------------------#2020-11-29">https://medium.com/analytics-vidhya/predicting-life-expectancy-part-2-using-linear-regression-98d1d95473?source=collection_archive---------15-----------------------#2020-11-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/054906df2df485b8571457392ee45008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*LOwkakJlJi-WybXQd20Ehw.png"/></div></figure><p id="b2d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这篇博客是我上一篇博客<a class="ae jk" href="https://roydipta.medium.com/predicting-life-expectancies-part-1-using-statistics-to-gain-insight-654cb13a9866" rel="noopener"> <em class="jl">预测预期寿命，第一部分:使用统计数据获得洞察力</em> </a>的延续。如果你想通过github repo获得更详细的代码，请查看:【https://github.com/roydipta/life_expectancy<a class="ae jk" href="https://github.com/roydipta/life_expectancy" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="bd1a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">重述:</strong></p><p id="e4a2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在上一篇博客中，我们探讨了如何使用统计学来深入了解我们所拥有的数据。要点是:</p><ul class=""><li id="9c85" class="jm jn hi io b ip iq it iu ix jo jb jp jf jq jj jr js jt ju bi translated">较发达国家的预期寿命高于发展中国家</li><li id="da40" class="jm jn hi io b ip jv it jw ix jx jb jy jf jz jj jr js jt ju bi translated">发达国家的肥胖率高于发展中国家</li></ul><p id="d3b0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这些似乎是非常基本的发现，但我们可以进一步调查这些说法，看看我们是否能学到任何新的东西。</p><h2 id="5eea" class="ka kb hi bd kc kd ke kf kg kh ki kj kk ix kl km kn jb ko kp kq jf kr ks kt ku bi translated">开始:查看相关矩阵和散点图</h2><p id="6bfe" class="pw-post-body-paragraph im in hi io b ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj hb bi translated">我们有很多功能，那么我们如何确定使用哪些功能呢？我们可以看到哪些要素相互关联，这样我们就可以避免多重共线性。为此，我们可以创建一个相关矩阵。</p><p id="030b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们也可以通过散点图来了解每个特征与预期寿命的关系。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="44dd" class="ka kb hi lf b fi lj lk l ll lm"><strong class="lf hj">def</strong> CorrMtx(df, dropDuplicates = <strong class="lf hj">True</strong>):<br/><br/>    <strong class="lf hj">if</strong> dropDuplicates:    <br/>        mask = np.zeros_like(df, dtype=np.bool)<br/>        mask[np.triu_indices_from(mask)] = <strong class="lf hj">True</strong><br/><br/>    <em class="jl"># Set background color / chart style</em><br/>    sns.set_style(style = 'white')<br/><br/>    <em class="jl"># Set up  matplotlib figure</em><br/>    f, ax = plt.subplots(figsize=(11, 9))<br/><br/>    <em class="jl"># Add diverging colormap from red to blue</em><br/>    cmap = sns.diverging_palette(250, 10, as_cmap=<strong class="lf hj">True</strong>)<br/><br/>    <em class="jl"># Draw correlation plot with or without duplicates</em><br/>    <strong class="lf hj">if</strong> dropDuplicates:<br/>        sns.heatmap(df, mask=mask, cmap=cmap, <br/>                square=<strong class="lf hj">True</strong>,<br/>                linewidth=.5, cbar_kws={"shrink": .5}, ax=ax)<br/>    <strong class="lf hj">else</strong>:<br/>        sns.heatmap(df, cmap=cmap, <br/>                square=<strong class="lf hj">True</strong>,<br/>                linewidth=.5, cbar_kws={"shrink": .5}, ax=ax)<br/><br/><br/>CorrMtx(df.corr(), dropDuplicates = <strong class="lf hj">True</strong>)</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/ae385d90c95d799d2ebd6beb93918a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m9llL0uo6YB9ZpuuHifajg.png"/></div></div></figure><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="59c9" class="ka kb hi lf b fi lj lk l ll lm">features = ['year', 'adult_mortality',<br/>       'infant_deaths', 'alcohol', 'percentage_expenditure', 'hepatitis_b',<br/>       'measles', 'bmi', 'under-five_deaths', 'polio', 'total_expenditure',<br/>       'diphtheria', 'hiv/aids', 'gdp', 'population', 'thinness_1-19_years',<br/>       'thinness_5-9_years', 'income_composition_of_resources', 'schooling', 'obesity', 'suicides_no']<br/>n = 4<br/>row_groups= [features[i:i+n] <strong class="lf hj">for</strong> i <strong class="lf hj">in</strong> range(0, len(features), n) ]<br/><strong class="lf hj">for</strong> i <strong class="lf hj">in</strong> row_groups:<br/>    pp = sns.pairplot(data=df, y_vars=['life_expectancy'],x_vars=i, kind="reg", height=3)</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/0bf1803ce0b41672e79de0547c55c466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*PFHvq6QyIDm_k0jTf6enKw.png"/></div></figure><p id="c904" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从这些图中我们可以看出，散点图中有一些突出的特征。具体来说:学校教育、肥胖、酒精、资源的收入构成、白喉、支出百分比和发展状况。因此，我们可以对这些特征进行基线回归，看看我们做得如何。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="8224" class="ka kb hi lf b fi lj lk l ll lm">ols('life_expectancy~schooling+obesity+alcohol+income_composition_of_resources+percentage_expenditure+diphtheria+status',data=df).fit().summary()</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/e129952f85940854f5893f852657abb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*DIOrPoG7HWQjSH2fxQd1FQ.png"/></div></figure><p id="67d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">看起来我们的R平方还不错。它是0.68，这意味着因变量的方差可以用68%的自变量来解释。但是结果中有一些有趣的东西。如果你看看OLS摘要的系数标签，你会发现肥胖有正相关。这实际上没有意义，这种正相关意味着一个国家的肥胖程度越高，他们的预期寿命就越高。嗯，为什么会这样呢？这可能意味着更发达的国家更容易获得食物资源。让我们进一步研究这个问题。如果我们是对的，发达国家应该有更高的肥胖人数。我们必须拿出我们信任的T-test！</p><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/74b3d5b31aac09d929cf7e50e206a303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*QqbtCQPA74SlTFcaG6TZOg.png"/></div></figure><p id="b519" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[13]中:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b469" class="ka kb hi lf b fi lj lk l ll lm">stats.ttest_ind(developed['obesity'], developing['obesity'])</span></pre><p id="17d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Out[13]:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4752" class="ka kb hi lf b fi lj lk l ll lm">Ttest_indResult(statistic=8.718160546902753, pvalue=4.985541604428258e-18)</span></pre><p id="7e74" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[74]:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4856" class="ka kb hi lf b fi lj lk l ll lm">y = df.groupby(['status']).obesity.mean().fillna(0)<br/>x = y.index;<br/>figure, ax = plt.subplots(figsize = (10,6));<br/>sns.barplot(x,y, palette="Greens_r");<br/>sns.set(style='dark')<br/>ax.set_title('Status of Country vs Obesity', fontdict={'fontsize':'x-large'});<br/>ax.set_xlabel('Status', fontdict={'fontsize':'x-large'});<br/>ax.set_ylabel('Obesity', fontdict={'fontsize':'x-large'});</span></pre><figure class="la lb lc ld fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/19c86939c20e33e032614182f27f46c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*olclq2R8eUfvqBgI-5N2PQ.png"/></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">这里的图像叠加了回归分析</figcaption></figure><p id="edce" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">由于我们的P值远低于0.05的置信度，我们可以拒绝零假设。因此，我们可以自信地说，平均而言，发达国家的肥胖率高于非发展中国家。但是有件有趣的事。将发达国家和发展中国家的肥胖和预期寿命的相关性分开，我们可以看到，在发展中国家，随着肥胖指数的增加，预期寿命也增加。而在更发达的国家，随着肥胖症的增加，预期寿命降低。</p></div></div>    
</body>
</html>