<html>
<head>
<title>How I implement neural network from scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何从零开始实现神经网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-i-implement-neural-network-from-scratch-f39b84b2b722?source=collection_archive---------36-----------------------#2020-04-06">https://medium.com/analytics-vidhya/how-i-implement-neural-network-from-scratch-f39b84b2b722?source=collection_archive---------36-----------------------#2020-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/1fae1d466511a2c8a72904abdf5c8b95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rLvhVXoAhtwlAPtj.jpeg"/></div></figure><p id="f065" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi jk translated">机器学习神经网络是一个非常强大的工具。发现于50年代，但由于可用计算能力的指数级增长，直到最近才得到广泛利用。他们使得在学徒期后对新数据进行分类成为可能。</p><p id="dde9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我们将关注一个神经网络被证明非常有趣的实际案例:</p><p id="e9c4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你看到挂在你桌子角落的旧地址簿，只要给每一页拍张照，所有的电话号码都会直接进入你的在线地址簿，这是多么方便啊。</p><p id="6461" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了做到这一点，程序必须能够“读取”页面上的数字。这就是神经网络允许你做的。</p><p id="51e7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过用一系列手绘数字图片训练神经网络，它将能够“猜测”你的老阿姨弗朗索瓦丝的电话号码中有哪些数字。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="72c0" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">从头开始实现神经网络</h1><h2 id="fa3c" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">初始化</h2><p id="62c0" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">要初始化神经网络，必须给定每层(输入、隐藏、输出)的节点数。<br/>在这些信息之后，构造函数将初始化各种东西:</p><ul class=""><li id="f4d9" class="lr ls hi io b ip iq it iu ix lt jb lu jf lv jj lw lx ly lz bi translated">从输入到隐藏层的权重矩阵:` weight_ih '</li><li id="c57b" class="lr ls hi io b ip ma it mb ix mc jb md jf me jj lw lx ly lz bi translated">从隐藏层到输出层的权重矩阵:` weight_ho '</li><li id="bab0" class="lr ls hi io b ip ma it mb ix mc jb md jf me jj lw lx ly lz bi translated">隐藏层的偏差矩阵:` bias_h '</li><li id="a2c2" class="lr ls hi io b ip ma it mb ix mc jb md jf me jj lw lx ly lz bi translated">输出层的偏差矩阵:` bias_o '</li><li id="a66f" class="lr ls hi io b ip ma it mb ix mc jb md jf me jj lw lx ly lz bi translated">任意初始化的学习:` learningRate '</li></ul><h2 id="46e7" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">训练、评分和前馈方法</h2><p id="0d7d" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">我们有三个主要的方法来实现:</p><ul class=""><li id="d3c7" class="lr ls hi io b ip iq it iu ix lt jb lu jf lv jj lw lx ly lz bi translated">前馈:允许从400个像素的单个输入获得预测的功能</li><li id="1f2a" class="lr ls hi io b ip ma it mb ix mc jb md jf me jj lw lx ly lz bi translated">train:一种将输入图像及其标签从训练集中作为参数的方法，考虑到我们正在进行监督学习</li><li id="9af0" class="lr ls hi io b ip ma it mb ix mc jb md jf me jj lw lx ly lz bi translated">score:一种将测试集中的输入图像及其标签作为参数的方法</li></ul><h2 id="79e5" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">前馈方法</h2><p id="b02e" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">首先要做的是实现前馈方法。<br/>为此，我们需要计算隐藏层和输出层的激活。</p><p id="0c0b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">之后，我们需要实现培训功能。<br/>我们首先通过以下公式计算输出(` output_errors `)和隐藏(` hidden_errors `)层的误差:</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mf"><img src="../Images/51b87c1da95c7a88aa37742e2a7f4456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGzuyWTtLk9BiQsLVuBmrA.png"/></div></div></figure><p id="a805" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将输出层的激活作为这个函数的输出</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mo"><img src="../Images/4884a920bd7edd929e130b16e0e265e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1AtH4BBffzbDU6YFXo69Vg.png"/></div></div></figure><h2 id="a284" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">训练方法</h2><p id="cfa5" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">之后，我们需要实现培训功能。<br/>我们首先通过以下公式计算输出(` output_errors `)和隐藏(` hidden_errors `)层的误差:</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mp"><img src="../Images/6510f0c290a807a6a049476dc5160831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dY1Fzauuk8kTlIP7hSu_dw.png"/></div></div></figure><p id="816d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一旦我们有了每个层的误差，我们就可以计算<strong class="io hj">梯度</strong>，以便获得我们将要用来校正<strong class="io hj">权重</strong> (`weight_ih_deltas '和` weight_ho_deltas ')和<strong class="io hj">偏差</strong> (`hidden_gradients '和` output_gradients ')的值。<br/>为此，我们将使用线性回归公式。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mq"><img src="../Images/8d18f44123b70ff11e1576ea0406af94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f2cZsRlzPxEqQL1ezhYZDg.png"/></div></div></figure><p id="d0cd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">训练方法的最后一步是通过添加我们刚刚计算的梯度来更新我们的变量</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mr"><img src="../Images/a84c7c983a3a7de18f02b7d3acdb98ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LF_l0ovPmUNBVQDHgDTYLQ.png"/></div></div></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es ms"><img src="../Images/708d3aa55066bc8b00d651f15dd53887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0-lFDjgURcyT4gZQ088sQ.png"/></div></div></figure><h2 id="8807" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">得分方法</h2><p id="66dd" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">分数方法允许计算列车组<br/>上模型的<strong class="io hj">精度</strong>，为此，我们只需获取输出的<strong class="io hj">最大值</strong>并声明它是我们的预测值<br/>，然后我们构建一个数组来比较“实际”值和“预测”值。<br/>如果预测值等于实际值，我们给数组加一个<strong class="io hj">1</strong>，如果不等于，则加零<strong class="io hj"/></p><p id="c9bc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">之后，我们只需返回以下结果:</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/d30374a4b40a08b9d8caacddd76d78b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*TyIqj-7_ficE4ErMzrbnmQ.png"/></div></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mu"><img src="../Images/c146d409f36dfb6a247410848f677f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sTfwpDY8R_aT3URkF5emqQ.png"/></div></div></figure><h1 id="3186" class="ka kb hi bd kc kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx bi translated">将该模型应用于手写数字识别</h1><p id="f532" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">模特起来了！</p><p id="b6af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了训练这个神经网络，我们将使用一个包含5000张手写数字图像的数据集。数据集的每一行都包含数字的图像及其“标签”，即与之对应的数字。</p><h2 id="2fc5" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">清理数据</h2><p id="5812" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">我们从<strong class="io hj">加载</strong>我们的数据开始</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es nb"><img src="../Images/0f32fe22e0bfba95750f238a3cfe6884.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lv_LquYMHdB-PZrvUHvEyQ.png"/></div></div></figure><p id="257c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如主题所示，有必要在数据集中用0替换“10”。<br/>为此，我们使用了“替换”功能。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es nb"><img src="../Images/9e99fab75c6ad574d7dd2621a15d1682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6_PsQhwqIK3QnuLwr0E9yw.png"/></div></div></figure><h2 id="7d50" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">拆分数据</h2><p id="b7ed" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">我们使用名为“train_test_split”的“scikit learn”方法将数据分成一个<strong class="io hj">序列</strong>和一个<strong class="io hj">测试集</strong>和<br/>这里我们使用的测试集代表我们数据集的20%。这种方法自动对数据进行填充</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es nc"><img src="../Images/de1e1e8d470924157e031f13b422fe58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GyYHswKPMu4EgoSYMVfXsA.png"/></div></div></figure><h2 id="54b9" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated">测试我们的模型</h2><p id="4544" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">为了做到这一点，我们将使用“400”作为组成输入层的数字，假设我们在每个图像中有400个像素。<br/>我们将使用“10”个输出节点作为10个不同的可能值<br/>我们将任意的“35”个节点用于隐藏层</p><p id="299a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在用所有训练集训练我们的模型之前，我们使用“样本”方法来混洗我们的数据</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es nd"><img src="../Images/5c1bc56ce5ede4b7f98fc932975324e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1Jj4NLmgD5M1CrwOiODqA.png"/></div></div></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/1f0dcdfbb8e36313b7d4080348e9697b.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/1*NLCvq19yiZNPyDdzT5K6lQ.gif"/></div></figure><p id="f408" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里我们看到的是MSE，它是一个模型误差指标，随着驱动的进行而减小。</p><p id="89de" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们使用“得分”方法来计算我们模型的<strong class="io hj">精确度</strong></p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es nb"><img src="../Images/ceefc4a780ef25ea2331add253e8f1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fAEgLkGvly4HeGRIQfXhcg.png"/></div></div></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es nf"><img src="../Images/70d07e6519b3ba13862a7ec0c1a36af7.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/1*obipO5CHGQ7arCOdWf3L3Q.gif"/></div></div></figure><p id="e25d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以我们在测试集上有84%的准确率。</p><h2 id="a0ba" class="ky kb hi bd kc kz la lb kg lc ld le kk ix lf lg ko jb lh li ks jf lj lk kw ll bi translated"><strong class="ak">将我们的模型精度与scikit learn的模型精度进行比较</strong></h2><p id="fdec" class="pw-post-body-paragraph im in hi io b ip lm ir is it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj hb bi translated">Scikit learn是一个著名的Python数据科学库，它将允许我们有一个比较点。</p><p id="757c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Scikit learn的神经网络并不是以同样的方式工作。实际上，在计算误差之前，它会前馈所有的数据集。<br/>数据集将被迭代多次。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es ng"><img src="../Images/abf71ae9f469f355777e575c8d65c7f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TEM8Os1S5tvnlo1DTE_d_Q.png"/></div></div></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es nh"><img src="../Images/d9fa6b4314fa6360f96601f735a03347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F91X9qGpvIo94SnT3HiPgA.png"/></div></div></figure><p id="1738" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Scikit learn的神经网络模型给了我们97%的准确率。<br/>这个值可以用神经网络训练模型的方式来解释，如上所述，而且学习率非常低。</p><p id="7be7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">识别地址簿中照片上的电话号码的下一步将是一个程序，它定位照片上号码的位置，并将其转换成一个图片数组。</p><p id="9229" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">总之，我们会说，机器学习是一个未来的领域，它经常看起来模糊不清。这就是为什么详细了解已经在帮助我们的模型是如何工作的非常重要。</p></div></div>    
</body>
</html>