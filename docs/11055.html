<html>
<head>
<title>Optimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">最佳化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/optimization-acb996a4623c?source=collection_archive---------1-----------------------#2020-11-16">https://medium.com/analytics-vidhya/optimization-acb996a4623c?source=collection_archive---------1-----------------------#2020-11-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2d2953f559409a29fa7c1482aa2db548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emPDLzTy0oW5BWLuxDSbKQ.png"/></div></div></figure><p id="8a53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据科学的三大支柱是:</p><ul class=""><li id="b18d" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">线性代数</li><li id="bb99" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">统计数字</li><li id="6ebf" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">最佳化</li><li id="d4b0" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">什么是优化？</li></ul><blockquote class="kc kd ke"><p id="a1fb" class="iq ir kf is b it iu iv iw ix iy iz ja kg jc jd je kh jg jh ji ki jk jl jm jn hb bi translated">“优化问题包括通过系统地从允许的集合中选择输入值并计算函数值来最大化或最小化真实函数。”</p></blockquote><p id="9004" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它在寻找问题的最佳解决方案(可能是最小化或最大化函数形式 f(x))时很有用。这里 x 代表决策变量。我们选择 x 的值，使得函数 f 要么最大化，要么最小化。在解决优化问题时，可能需要满足 x 上的某些约束，即我们只能在某些区域或值集中选择 x。</p><p id="12a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="kf">为什么要优化？</em>T3】</strong></p><p id="d317" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在现实生活中，优化有助于提高系统的效率。它应用于无数领域，包括医药、制造、运输、供应链、金融、政府、物理、经济、人工智能等。在优化模型中，目标可以是最小化生产系统中的成本。在医院中，目标可以是使患者在被医生看到之前在急诊室中的等待时间最小化。在市场营销中，目标可以是在预算和运营条件下，通过瞄准正确的客户来实现利润最大化。人道主义行动的目标是通过设计最佳路线，尽可能快地向尽可能多的灾民分发资源水、食物和医疗服务。它也是数据科学算法的主干。它是数据科学中几乎所有机器学习和统计技术的核心。</p><p id="e9a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它有助于找到问题的最小误差或最佳解决方案。例如，在回归中，误差计算如下:</p><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/62ef6c2ef4e54a20af5c4347ba36a1bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*NGwP9XgrEZvStjEDvHxaGg.png"/></div></figure><p id="4fbe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">优化有助于找到损失函数的最小值。</p><p id="bc11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们再举一个例子。</p><p id="9cf5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们有关于 y 和 x 的数据，并且我们想在 y 和 x 之间拟合一个函数，比如 y=a1+a2*x。我们有 x 和 y 的多个样本，(x1，y1)，(x2，y2)等等。我们可以把这个概括为:yn=a1+a2*xn。正如我们所见，有 n 个方程，但只有 2 个变量。几乎不可能解出所有这些方程。所以我们将误差函数定义为:</p><p id="a228" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">e=y1-a1-a2*x1</p><p id="6ab2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一般情况下，en=yn-a1-a2*xn</p><p id="ab92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果对决策变量的取值没有限制，我们就有一个无约束优化问题。这是线性回归中遇到的一类问题。它也被称为函数逼近问题，广泛应用于数据科学中。</p><p id="ad87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，如果我们查看来自不同类别的数据点，并希望找到一个超平面来分隔这些数据点，那么问题是找到有效分隔这些类别的最佳超平面。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/ad38713212887c61ca76e5e99a58b2dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*y4an1d0Oo4pm46b7QjkKOA.png"/></div></figure><p id="f702" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">答案在于优化。超平面必须以这样的方式选择，即类被有效地分类，并且决策变量是表征超平面的参数。</p><p id="06fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，正如我们所见，几乎所有的机器学习算法都可以被视为优化问题的解决方案。对优化问题的更深入理解可以更好地理解机器学习，并有助于使算法的工作合理化。</p><p id="d917" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="kf">组件优化</em> </strong></p><p id="cb17" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.目标函数(最大值或最小值)</p><p id="8ceb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.决策变量</p><p id="487e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.限制</p><p id="dfeb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一部分是一个目标函数<strong class="is hj"> </strong> f(x ),我们试图将它最大化或最小化。一般来说，我们谈论最小化问题是因为如果你有一个关于 f(x)的最大化问题，它可以被<strong class="is hj"> </strong>转换成一个关于<strong class="is hj"> </strong> -f(x)的最小化问题。</p><p id="be50" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">决策变量(x):第二个组成部分是决策变量，我们可以选择最小化功能。所以，我们通常把这个写成 min f(x)。</p><p id="87db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">约束(a ≤ x ≤ b):第三个组件是将这个<strong class="is hj"> x </strong>约束到某组值的约束。</p><p id="733f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="kf">优化的类型</em> </strong></p><p id="a688" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据目标函数、约束和决策变量的类型，优化可以是各种类型的。</p><p id="5275" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.线性规划:如果决策变量是连续的，函数形式是线性的，所有约束也是线性的，则称为线性规划问题。</p><p id="b2be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.非线性规划:如果决策变量保持连续，而目标函数或约束条件是非线性的，则称为非线性规划问题。</p><p id="1636" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在许多情况下，决策变量可能不是连续的，而是整数。例如:f(x1，x2)和</p><p id="6a30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">x1 <em class="kf"> ∈ </em> [0，1，2，3]</p><p id="60c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">x2 <em class="kf"> ∈ </em> [0，1，2，3]</p><p id="f7fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果目标函数和约束是线性的，决策变量是整数，则称为线性整数规划问题。</p><p id="aa93" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果目标函数或约束条件是非线性的，而决策变量是整数，则称之为非线性整数规划问题。</p><p id="28ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个特殊的情况可能是决策变量只能取二进制值(0，1)，那么这就叫做二进制整数规划问题。</p><p id="acaa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">混合整数线性规划问题:如果决策变量(x)是一个混合变量，如果目标函数(f)是线性的，并且所有的约束也是线性的，那么这类问题称为混合整数线性规划问题。因此，在这种情况下，决策变量是混合的，目标函数是线性的，约束也是线性的。</p><p id="3e98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">混合整数非线性规划问题:如果决策变量(x)保持混合；然而，如果目标函数(f)或约束是非线性的，那么这种类型的问题称为混合整数非线性规划问题。因此，如果目标或约束变得非线性，规划问题就变得非线性。</p><p id="1b09" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们简单地谈谈凸优化。</p><p id="7537" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单变量优化是一个没有约束的非线性优化问题。在单变量优化中，只有一个决策变量。</p><p id="1c41" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最小 f(x)</p><p id="3182" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">x <em class="kf"> ∈ </em> R，</p><p id="3864" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其中 x 是决策变量，f 是目标函数。x 是连续的，因为它可以有无穷多的值。</p><p id="f766" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单变量优化在 2D 中很容易可视化，如下所示:</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/0628b5e0cf2d00924885d8c5eda3f983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNAQ9y3H6eKkPZncQ6okFw.png"/></div></div></figure><p id="7036" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">x 轴代表决策变量(<em class="kf"> x </em>)的各种值，y 轴代表目标函数 f(x)。该图显示了该函数达到最小值的点。通过在 x 轴上放一条垂线，我们得到<em class="kf"> x* </em>，这是函数达到最小值时<em class="kf"> x </em>的值。y 轴上的相应值，<em class="kf"> f*，</em>是该函数可能采用的最佳值。这是一个凸函数，因为只有一个极小值。这个最小值是局部的也是全局的最小值，即函数值比附近的点小，也是最佳解或比所有可行点小。</p><p id="9a03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，在某些情况下，局部和全局最小值可能不一致。函数值可能小于附近点的值(局部最小值)，但不一定是最优解。这样的函数被称为非凸函数。它们可能有多个局部最小值。换句话说，本地附近可能没有更好的点/解决方案，但可能有更远的点/解决方案。</p><p id="d683" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="kf">渐变下降</em> </strong></p><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/21b61bb8a6a5334fbbac3abb9a7de051.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*PjIu1cacnsZTRC6VWBZ61g.png"/></div></figure><p id="cb52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">梯度下降是一种优化算法，可用于在给定具有输入和输出的数据集的情况下估计回归参数的值。</p><p id="2295" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">线性回归模型的成本函数是所有 N 条记录的总误差(均方误差),由下式给出:</p><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/a7ce0a56ddb0ea7031988d8b1a72f035.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*4cVMGEpLL-3vtvr7-AWEcQ.jpeg"/></div></figure><p id="7c0c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">梯度下降使用以下步骤找到使损失函数最小的最佳β0 和β1 值:</p><p id="9e35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.随机猜测β0(偏差或截距)和β1(特征权重)的初始值。</p><p id="6d2a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.针对偏差和权重的初始值，计算结果变量ŷi 的估计值。</p><p id="02ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.计算均方误差函数(MSE)。</p><p id="97bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.通过计算误差函数的梯度来调整β0 和β1 值。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ks"><img src="../Images/d854acbef889612113c338db07d7f321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*Dq9yPzigPWmLv6ayFGw9ew.jpeg"/></div></div></figure><p id="f0d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.重复步骤 1 到 4 几次迭代，直到误差停止进一步减小或者成本变化非常小。</p></div></div>    
</body>
</html>