<html>
<head>
<title>Easy KNN algorithm using scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用scikit-learn的简易KNN算法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/easy-knn-algorithm-using-scikit-learn-7f6e256c9453?source=collection_archive---------1-----------------------#2020-01-01">https://medium.com/analytics-vidhya/easy-knn-algorithm-using-scikit-learn-7f6e256c9453?source=collection_archive---------1-----------------------#2020-01-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f7f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di">在</span> <em class="jm">这篇博客中，我们将了解什么是K-最近邻，该算法如何工作以及如何选择K的值。我们将看到一个使用著名的python库sklearn来使用KNN的示例。</em></p><p id="c290" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">K-最近邻是一个-</p><p id="c367" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">——作为目标变量的监督机器学习算法</strong>已知。</p><p id="d4b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">-非参数化</strong>，因为它不对底层数据分布模式做出假设。</p><p id="2e49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">-使用<strong class="ih hj">特征相似度</strong>预测新点将落入的聚类。</p><p id="65de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">KNN可用于分类和回归预测问题。然而，它更广泛地用于分类问题，因为大多数分析问题涉及决策。</p><p id="3769" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们举一个简单的例子来理解这个算法。下面是一系列红色圆圈和绿色方块:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jn"><img src="../Images/92dee05ea6a0cc91f046a932297eef3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Z2IBZn2-z2ADD0NjLMCwg.png"/></div></div></figure><p id="6be6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你想知道蓝星的等级。这可以是红色圆圈或绿色方块，没有别的。KNN算法中的“K”是我们希望从中进行投票的最近邻居。假设K = 3。因此，我们现在将画一个以蓝星为中心的圆，其大小正好能在平面上包含三个数据点。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jz"><img src="../Images/f129d1bc92cdd800df2f27b71b35a95a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48Xz8BXQcwxV3fwuJ57ezg.png"/></div></div></figure><p id="4b92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">离星星最近的三个点都是红圈。因此，在良好的置信水平下，我们可以说蓝星应该属于红圈类。这里，选择变得非常明显，因为最近邻居的三张选票都投给了红圈。</p><p id="ee7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此最终，我们可以说，该算法检查测试点附近的k个最近的数据点的类，并且大多数的类将被分配给测试数据点。</p><p id="7b99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jm">实现使用scikit</em></strong><em class="jm">-</em>-<strong class="ih hj"><em class="jm">学习:-</em>-</strong></p><p id="4de8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们将使用水果数据作为我们的示例数据集。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es ka"><img src="../Images/a72be8549956e2ed1d83b918da24fa42.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*tHA2Pq56zcbTaqQYDG5rUA.png"/></div></figure><p id="7beb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用水果的质量、宽度和高度作为我们的特征点来预测正确的水果标签(目标值)。</p><p id="479b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入所需模块并加载数据文件(<strong class="ih hj">fruit _ data _ with _ colors . tx</strong>t)</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="7048" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">import numpy as np</strong></span><span id="883f" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">import pandas as pd</strong></span><span id="f7d4" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">from sklearn.model_selection import train_test_split</strong></span></pre><p id="8c0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用pandas将data_ table读入数据帧格式。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="92c4" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">fruits = pd.read_table(‘fruit_data_with_colors.txt’)</strong></span></pre><p id="aca2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获取数据集的前五个数据值，以查看数据集的实际情况。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="05d2" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">fruits.head()</strong></span></pre><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es kn"><img src="../Images/320fdee859fe8b5ca04417fb6fe390fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o8_KKKgRiKNrWPQncvjsHw.png"/></div></div></figure><p id="0a78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建从水果标签值到水果名称的映射，使结果更容易解释</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="3615" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">target_fruits_name = dict(zip(fruits.fruit_label.unique(),<br/>fruits.fruit_name.unique()))</strong></span><span id="aafb" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">target_fruits_name</strong></span></pre><p id="499e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">= {1:'苹果'，2:'橘子'，3:'橘子'，4:'柠檬' }</p><p id="d5d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设x为特征值集合，y为目标值。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="1a0c" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">x = fruits[[‘mass’, ‘width’, ‘height’]]</strong></span><span id="a89b" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">y = fruits[‘fruit_label’]</strong></span></pre><p id="a1fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用train_test_split函数将数据分解为默认的75/25 %训练和测试数据。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="4231" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">x_train, x_test, y_train, y_test = train_test_split(x, y, random_state=0)</strong></span></pre><p id="5972" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们有了训练测试分割，我们就需要创建一个分类器对象的实例。并且在这种情况下是k-NN分类器。并将重要参数(在这种情况下，邻居的数量表示k)设置为分类器使用的特定值(我们取5)。取n_neighbors或k = 5。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="8a84" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">from sklearn.neighbors import KNeighborsClassifier</strong></span><span id="fa34" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">knn = KNeighborsClassifier(n_neighbors = 5)</strong></span></pre><p id="551a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们通过将X_train中的训练集数据和y_train中的标签传递给分类器fit方法来训练分类器。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="1808" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">knn.fit(x_train,y_train)</strong></span></pre><p id="bffb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请记住，在训练阶段，k-NN分类器没有看到测试集中的任何水果。</p><p id="c958" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们对分类器对象使用score方法。</p><p id="0c0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将把测试设定点作为输入，并计算精度。准确度被定义为测试集项目的分数，其真实标签被分类器正确预测。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="2110" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">knn.score(x_test,y_test)</strong></span></pre><p id="efab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">=0.53333333333333333</p><p id="1a0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">举个例子。我将输入一个假设的相当小的水果的质量、宽度和高度。如果我们要求分类器使用预测方法来预测标签。</p><p id="1f24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到输出是它预测这是一个柑橘。</p><p id="27cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如:一个小水果，质量20克，宽4.3厘米，高5.5厘米</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="b587" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">fruit_prediction = knn.predict([[20,4.3,5.5]])</strong></span><span id="f402" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">target_fruits_name[fruit_prediction[0]]</strong></span></pre><p id="8149" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">=普通话</p><p id="41ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以举另一个例子</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="5288" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">fruit_prediction = knn.predict([[180,8.0,6.8]])</strong></span><span id="c185" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">target_fruits_name[fruit_prediction[0]]</strong></span></pre><p id="78d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">=苹果</p><p id="a1ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们使用一个名为plot_two_class_knn的实用函数，它包含在共享实用程序模块中。</p><p id="f776" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将产生具有决策边界的彩色图。然后，您可以自己尝试不同的k值，看看对决策界限有什么影响。</p><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="26c6" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">from adspy_shared_utilities import plot_two_class_knn</strong></span><span id="b8ae" class="kg kh hi kc b fi km kj l kk kl"><strong class="kc hj">plot_two_class_knn(x_train, y_train, 1, ‘uniform’, x_test, y_test)</strong></span></pre><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es ko"><img src="../Images/b8d4653a9a6d2b95fbf798a7460277e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*WD_BOHuaUgdXijE8Zv1teg.png"/></div></figure><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="c711" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">plot_two_class_knn(x_train, y_train, 3, ‘uniform’, x_test, y_test)</strong></span></pre><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es kp"><img src="../Images/99e69f8ffecd1dce0d5504678f5a21b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qSZi707Faz3FwoTaDckzcA.png"/></div></figure><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="7cc9" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">plot_two_class_knn(x_train, y_train, 11, ‘uniform’, x_test, y_test)</strong></span></pre><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es kq"><img src="../Images/86188a7c6727f1efc0d7e40f2492a46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*kVRzrS3WxugF0gN0Rih1oA.png"/></div></figure><pre class="jo jp jq jr fd kb kc kd ke aw kf bi"><span id="ace8" class="kg kh hi kc b fi ki kj l kk kl"><strong class="kc hj">plot_two_class_knn(x_train, y_train, 15, ‘uniform’, x_test, y_test)</strong></span></pre><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es kr"><img src="../Images/32bab19130242ac875da25a8830dd37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*9cWCEMAZB_Shm_u78fMRDg.png"/></div></figure><p id="2ed2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jm">如何选择k:- </em> </strong></p><p id="c3bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你仔细观察(上图)，你会发现随着K值的增加，边界变得更加平滑。随着K值增加到无穷大，它最终变成一个单一的目标区域，这取决于总的多数。训练错误率和验证错误率是我们需要在不同K值上访问的两个参数。</p><p id="fc3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，检查不同k值的精度是选择k值的最简单和最好的方法。</p><p id="02fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在KNN，求k值并不容易。k值小意味着噪声对结果的影响更大，而k值大则计算量大。数据科学家通常选择k=sqrt(n)。</p><p id="fcbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且总是试图为k选择一个奇数值，以避免在两个类的情况下出现平局。</p><p id="ae48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">继续机器学习吧！</strong></p></div></div>    
</body>
</html>