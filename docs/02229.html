<html>
<head>
<title>Search Engine Using Machine Learning and NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习和自然语言处理的搜索引擎</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/search-engine-using-machine-learning-and-nlp-c1ec1e28be7a?source=collection_archive---------0-----------------------#2019-12-07">https://medium.com/analytics-vidhya/search-engine-using-machine-learning-and-nlp-c1ec1e28be7a?source=collection_archive---------0-----------------------#2019-12-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6f10a15b642c549fdeb06479519784fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*977SmGNpxFjTAYe0Jp7KHQ.jpeg"/></div></figure><p id="45a8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">制作一个搜索引擎不是一件容易的事情。所以让我们从基础开始，知道我们如何做搜索？</p><p id="2959" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以借助一些算法进行搜索，比如二分搜索法、线性搜索、BST、Tries等。但是在字符串上应用它们不是很有用，因为我们必须在一个大的数据集中匹配精确的单词，字符串的长度也是一个因素。</p><p id="4c72" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在搜索引擎中，我们想知道一个查询与数据库中的其他数据有多少相似之处。我们将使用pythonto制作我们自己的搜索引擎。让我们开始吧</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="5d4e" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">数据:</h1><p id="f071" class="pw-post-body-paragraph im in hi io b ip kp ir is it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj hb bi translated">首先，我们需要一些数据来匹配我们的查询。所以我正在从卡格尔那里获取<a class="ae ku" href="http://kaggle.com/c/facebook-recruiting-iii-keyword-extraction/data" rel="noopener ugc nofollow" target="_blank"> StackOverflow数据。StackOverflow是一个网站，我们在这里提出与编程相关的问题，其他用户回答这些问题。<br/>在这个数据集中，我们有这样的数据。<br/>这里我们有问题的<strong class="io hj">标题</strong>，问题的<strong class="io hj">正文</strong>即详细解释的代码或问题，以及问题的<strong class="io hj">标签</strong>即标题属于哪种编程语言。</a></p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kv"><img src="../Images/d65cd2bfc25b6d4bee74127f4d495a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fsa7fiTJTl4pgB2YcMG5kQ.png"/></div></div></figure><p id="d78a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数据集有7.2GB，所以我们使用Sqlite与数据集交互，因为我的mac只有8GB内存。有许多行是重复的，所以我们先删除所有重复的行。</p><pre class="kw kx ky kz fd le lf lg lh aw li bi"><span id="ff52" class="lj js hi lf b fi lk ll l lm ln">SQL Code to get Dataset :</span><span id="f0c9" class="lj js hi lf b fi lo ll l lm ln">df <strong class="lf hj">= </strong>pd.read_sql_query('SELECT Title, Body, Tags, COUNT(*) as cnt_dup FROM data GROUP BY Title, Body, Tags')</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/15f3e1d9cefe7654b0710a2da985fff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*ip6pStUS5ZNrZDPOF8o5OQ.png"/></div></figure><p id="4f71" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们发现30%的数据是重复的，也就是说，有许多行重复了两三次。有些行甚至重复了6次。因此，让我们先去掉重复的数据。</p><pre class="kw kx ky kz fd le lf lg lh aw li bi"><span id="5ab6" class="lj js hi lf b fi lk ll l lm ln">df <strong class="lf hj">= </strong>df[df.cnt_dup <strong class="lf hj">&lt; </strong>2]</span></pre><p id="15c6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们希望我们的搜索引擎只关注与C#、Java、C++、C和iOS相关的问题。所以我们首先只获取那些行。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lq"><img src="../Images/53194ec8d608d7c056180394259164a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_iBs10F5EjFWRgRGTvpIRw.png"/></div></div></figure><p id="38fd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过使用多重处理，我们能够只处理那些与C#、Java、C++、C和iOS相关的行。</p><h1 id="86e4" class="jr js hi bd jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko bi translated">预处理:</h1><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lw"><img src="../Images/2c9129a724252e56c82d50ecce0d2f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tj9nTJZ_z9Tb2kkpB9sOSg.png"/></div></div></figure><p id="a304" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们将预处理我们的问题标题，删除html和多余的空格和其他东西。<br/>我们也将使用同样的预处理函数来预处理我们的查询。</p><h1 id="4aec" class="jr js hi bd jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko bi translated">搜索:</h1><p id="5da9" class="pw-post-body-paragraph im in hi io b ip kp ir is it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj hb bi translated">现在，我们希望执行搜索，并为我们的查询问题找到类似的问题。</p><p id="1d02" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们首先将数据矢量化。我们将使用TF-IDF矢量器，因为BoW矢量器不能提供更好的结果。</p><pre class="kw kx ky kz fd le lf lg lh aw li bi"><span id="4ed8" class="lj js hi lf b fi lk ll l lm ln">tfidf <strong class="lf hj">= </strong>TfidfVectorizer()<br/>tfidf_features <strong class="lf hj">= </strong>tfidf.fit_transform(processed.Title)</span></pre><p id="889b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们将使用成对距离，或者我们可以说TF-IDF向量之间的欧几里德距离，来看看我们的查询有多相似。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/7d62b9d7bdd5e36e05c5fc50f61cd361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*4A-bvfW7LDtBRqenlVBXrg.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">这里我们想得到与我们的查询相似的前10个索引。</figcaption></figure><p id="5c19" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于query = "Synchronization ",让我们看看我们的函数返回什么。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/79e4bbbe4beae0b0101ad987bae3b9c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*wXpydvwuEvC2AopSZlD39w.png"/></div></figure><p id="d333" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里，我们可以看到我们的结果是好的，但没有达到标准。那么，我们如何提高搜索引擎的效率呢？</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es md"><img src="../Images/3dcc1ba67f84794dfdd690bd1129e33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*G5LtxCBHNKWmd1n8868uqw.gif"/></div></figure><h1 id="4c63" class="jr js hi bd jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko bi translated">机器学习:</h1><p id="ac3f" class="pw-post-body-paragraph im in hi io b ip kp ir is it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj hb bi translated">我们可以通过使用ML来提高我们的搜索效率吗？<br/>如果是，那么如何？<br/>我们在使用StackOverflow的时候，大多是在查询中加入编程语言。<br/>像:C中的静态变量，Java中的同步，iOS中的查看控制器错误。<br/>我们的数据集有标签，我们能使用这些标签来优化我们的查询吗？<br/>但是如何？答案是<strong class="io hj">是的，我们可以训练一个模型，它可以预测给定查询的标签，并将该标签添加到查询中。</strong></p><p id="c791" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们首先通过仅使用数据集中每一行的第一个标签来简化我们的标签。<br/>我们的数据现在看起来像这样:</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es me"><img src="../Images/64f630944f4c7267eafbf4a286e4ada8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*FiWlXpRdqNiks-k3gAB9Bg.png"/></div></figure><p id="6ae9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们必须首先把我们的标签变成数字形式</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="948d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，我们执行TF-IDF矢量化，并在LR和SVM上训练我们的模型。<br/>我们观察到，我们的LR模型在超参数调整下表现更好。</p><p id="9fa4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以我们用逻辑回归的所有数据再次训练我们的模型。然后我们使用这个函数将预测的标签添加到我们的查询中。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es mh"><img src="../Images/3c2ffe6b6a943157c5a78ad70300cb65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ut8JnnUSs3CrVlK3-HaRIQ.png"/></div></div></figure><p id="fdaa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以我们将使用<strong class="io hj"> process_query </strong>函数<em class="mi">到</em>到<em class="mi">首先处理查询</em>，然后我们使用<strong class="io hj"> label </strong>函数<em class="mi">找到标签</em>，然后我们将使用<strong class="io hj"> change_query </strong>函数<em class="mi">到</em>T24】在查询中添加那个标签。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/4129e8f52813983464faabdffc054863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*qYwVVoGDFdDSsZB2TAyoDw.png"/></div></figure><p id="09de" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们将拥有处理所有处理的<strong class="io hj"> enter_queries </strong>函数。<br/>我们首先优化查询，然后对查询执行TF-IDF，因为查询与数据集具有相同的形状非常重要。然后我们得到指数并公布它们。让我们再次尝试query = "Synchronization "。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/46e5d51d1077403f181463e66faf7903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*2L1J-iVypYBkGwEeAb_XxQ.png"/></div></figure><p id="ce07" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到它被预测为具有标签JAVA，然后它将它附加到查询中并执行相似性，我们得到了比以前更好的结果。</p><p id="53c2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以现在让我们看看当我们使用flask和html使它看起来更真实时是什么样子。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/65d6a49aab92b7bb4d64d814d56e3dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*-PEQFWYYxBx5pJPL3M2K8w.gif"/></div></figure><p id="532d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">太棒了！</p><h1 id="e967" class="jr js hi bd jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko bi translated"><strong class="ak">未来方面:</strong></h1><ol class=""><li id="9098" class="mm mn hi io b ip kp it kq ix mo jb mp jf mq jj mr ms mt mu bi translated">我们可以使用w2v，TF-IDF加权w2v或其他技术来矢量化，因为我受到我的计算能力的限制，所以不能这样做。</li><li id="670f" class="mm mn hi io b ip mv it mw ix mx jb my jf mz jj mr ms mt mu bi translated">使用完整数据集。</li><li id="55fd" class="mm mn hi io b ip mv it mw ix mx jb my jf mz jj mr ms mt mu bi translated">在搜索引擎中制作更好的用户界面</li></ol><p id="ab18" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢你坚持到最后，如果你有任何疑问，请随时询问，这里是我的github回购的链接。</p><div class="na nb ez fb nc nd"><a href="https://github.com/lakshaychhabra/MLSearchEngine" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab dw"><div class="nf ab ng cl cj nh"><h2 class="bd hj fi z dy ni ea eb nj ed ef hh bi translated">lakshaychabra/ml search engine</h2><div class="nk l"><h3 class="bd b fi z dy ni ea eb nj ed ef dx translated">搜索是一项困难的任务，因为要花很多时间。如果我们有一个大型数据集，那么如果我们做一个…</h3></div><div class="nl l"><p class="bd b fp z dy ni ea eb nj ed ef dx translated">github.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ik nd"/></div></div></a></div></div></div>    
</body>
</html>