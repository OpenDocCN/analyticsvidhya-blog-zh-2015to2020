<html>
<head>
<title>File management tool using Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Golang的文件管理工具</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/file-management-tool-using-golang-9858c9278cf3?source=collection_archive---------9-----------------------#2020-10-08">https://medium.com/analytics-vidhya/file-management-tool-using-golang-9858c9278cf3?source=collection_archive---------9-----------------------#2020-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="314d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您是否曾经遇到过这样的情况:您需要重命名一堆到处都是的文件？或者你是否遇到过这样的情况:你想选择性地复制文件，但它们与其他一些文件在一起，你不能简单地选择所有文件？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1fe95182b3d87d0b3105a30c7eafecf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GqJceeMcrSQNJeKb"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Sebastian Herrmann 在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0aa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的生活或工作中，我们可能需要执行这些耗费大量时间的乏味任务，最好使用代码行来自动完成这些杂务。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="ad42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇<a class="ae jt" rel="noopener" href="/swlh/building-cli-based-file-renaming-tool-with-golang-e3c6a16eedf6">文章中，</a>我分享了我们如何使用Golang构建一个基于CLI的文件重命名工具，在这篇文章中，我们将进一步扩展功能到<strong class="ih hj">复制、移动和压缩文件</strong>，同时我们将研究Golang标准库如何帮助我们实现我们想要的。</p><h1 id="9cef" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">复制功能</h1><p id="5202" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">对于复制功能，我们需要一个源文件所在的源路径和一个目标路径。请注意，如果目标路径中存在现有文件，则现有文件将被替换。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">复制功能</figcaption></figure><ol class=""><li id="f7e0" class="lg lh hi ih b ii ij im in iq li iu lj iy lk jc ll lm ln lo bi translated">第7行:<code class="du lp lq lr ls b">os.Open()</code>在给定的路径下打开文件进行读取</li><li id="65f9" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第15行:<code class="du lp lq lr ls b">os.Stat()</code>检查目标文件夹是否存在，如果不存在，它将进入<code class="du lp lq lr ls b">if</code>循环</li><li id="374a" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第16行:<code class="du lp lq lr ls b">os.MkdirAll()</code>创建包含任何必要父目录的目录。<code class="du lp lq lr ls b">os.ModePerm</code>是目录的文件模式和权限，相当于<code class="du lp lq lr ls b">Chmod 777</code></li><li id="54e3" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第21行:<code class="du lp lq lr ls b">os.Create()</code>在给定的路径下创建一个文件。如果路径中存在文件，它将被截断</li><li id="9ed1" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第27行:<code class="du lp lq lr ls b">io.Copy()</code>将文件从源文件复制到目的文件，直到源文件到达EOF</li></ol><h1 id="c07f" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">移动功能</h1><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">移动功能</figcaption></figure><p id="acf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与复制功能类似，我们将检查目标目录是否存在，如果不存在，我们将创建目标目录及其父目录(如果需要)。</p><ol class=""><li id="54c5" class="lg lh hi ih b ii ij im in iq li iu lj iy lk jc ll lm ln lo bi translated">第14行:<code class="du lp lq lr ls b">os.Rename()</code>重命名源文件的整个路径，这实际上将文件移动到一个新的位置</li></ol><h1 id="56d0" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">压缩功能</h1><p id="8fc4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">有一个ZIP包<code class="du lp lq lr ls b">archive/zip</code>提供了对ZIP存档的读写支持。在下面的代码中，我们将传入ZIP文件的名称以及要归档的文件。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">压缩功能</figcaption></figure><ol class=""><li id="8d6f" class="lg lh hi ih b ii ij im in iq li iu lj iy lk jc ll lm ln lo bi translated">第9行:<code class="du lp lq lr ls b">os.Create()</code>用我们传入的给定名称创建一个文件</li><li id="9873" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第15行:<code class="du lp lq lr ls b">zip.NewWriter()</code>实例化一个zip文件编写器</li><li id="2f11" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第19–23行:由于文件夹可以是用户键入的输入，我们需要通过<code class="du lp lq lr ls b">os.Chdir()</code>将当前工作目录更改到指定的文件夹。然后我们在<code class="du lp lq lr ls b">os.Getwd()</code>中返回对应于当前工作目录的根路径名</li><li id="7e61" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第29–34行:遍历每个文件，我们使用<code class="du lp lq lr ls b">filepath.Rel()</code>来获取文件相对于基路径的路径，这样当我们以后想要放入zip存档时，可以保留文件的结构。有了相对路径，我们再在<code class="du lp lq lr ls b">filepath.Join()</code>中形成一条路径</li><li id="f6a7" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第35行:形成路径后，我们调用函数<code class="du lp lq lr ls b">addFileToArchive()</code>将文件放入zip中</li><li id="1ce2" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第59行:<code class="du lp lq lr ls b">fileToZip.Stat()</code>返回描述文件的<code class="du lp lq lr ls b">FileInfo</code>结构。</li><li id="1ee6" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第64–70行:使用第59行的<code class="du lp lq lr ls b">FileInfo</code>，<code class="du lp lq lr ls b">zip.FileInfoHeader()</code>创建一个部分填充的<code class="du lp lq lr ls b">FileHeader</code>，它描述zip中的文件。我们在第69和70行指定了名称和压缩方法(deflate)</li><li id="0ac5" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第72行:<code class="du lp lq lr ls b">zipWriter.CreateHeader()</code>将文件添加到zip中，并返回一个<code class="du lp lq lr ls b">writer</code>，它将用于写入文件的内容</li><li id="82dd" class="lg lh hi ih b ii lt im lu iq lv iu lw iy lx jc ll lm ln lo bi translated">第76行:<code class="du lp lq lr ls b">os.Copy()</code>将内容从源文件复制到zip文件中</li></ol></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="a2fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是文件管理工具的核心功能。对于完整的源代码，你可以看看<a class="ae jt" href="https://github.com/wilsontwm/filezy" rel="noopener ugc nofollow" target="_blank">https://github.com/wilsontwm/filezy</a>我已经建立了一个基于CLI的文件管理工具。</p><p id="6d85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢，干杯！</p></div></div>    
</body>
</html>