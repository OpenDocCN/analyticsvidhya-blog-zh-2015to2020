<html>
<head>
<title>Generative Adversarial Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生成对抗网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/generative-adversarial-networks-df14100f17ed?source=collection_archive---------18-----------------------#2020-05-08">https://medium.com/analytics-vidhya/generative-adversarial-networks-df14100f17ed?source=collection_archive---------18-----------------------#2020-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d49f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的6个月里，我一直在从事深度学习项目，我遇到了许多不同的用例，它们都非常棒，而GAN是真正让我着迷的东西，也是我写这篇文章的动机，来展示我对GAN的看法</p><p id="0722" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么是甘？</p><p id="a88e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GAN是一个神经网络，它由两个网络组成，生成器和鉴别器，两者相互训练并尝试相互学习，例如，教师不断给出反馈，直到学生创建了一个完美的图片，这样教师就无法区分原始图片和学生创建的图片</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/21d64662b7eb0b516b7f44e4c761e3fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*9PW_KWQaNlEzl7UBw5NUmw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">甘观的简单化</figcaption></figure><p id="71dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是生成器和鉴别器？</strong></p><p id="a224" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成器是一种神经网络，它创建新数据，而不是像常规图像分类或其他任务那样尝试对图像进行分类，它使用现有数据来生成新数据，例如，它使用现有图像来创建新图像，主要目标是从称为潜在空间的随机生成的数字向量中生成数据(图像、视频、音频或文本)。</p><p id="27a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">鉴别器更像常规的神经网络，其中我们输入两个图像，一个是真实的，另一个是由生成器创建的虚假的，并且网络使用二进制分类方法对它们进行分类，术语对抗性指向构成GAN框架的两个算法之间的类似游戏的竞争动态</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jp"><img src="../Images/9f051bb3958fa115404c4e825a4e700d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1i8UmeMAs-pOeCPzWpNEQA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">GAN的基本架构</figcaption></figure><p id="efda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们从GAN的架构中可以看到的，两者轮流从反馈中学习，其中鉴别器寻求最小化损失函数，而生成器寻求最大化损失函数，这也可以称为最小最大博弈，当我们达到纳什均衡时可以实现收敛。当GAN框架被引入时，它是一个简单的版本，后来被应用到许多用例中，产生了200多种不同类型的GAN，在本文中，我将通过代码的实际实现更深入地研究DCGAN</p><p id="4c39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">甘的应用</strong></p><p id="e899" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以实现GAN的用例数量是无限的，我列出了其中一些我感兴趣的用例，并实现了其中一个</p><ol class=""><li id="eda9" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">视频生成</li><li id="671a" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">音乐一代</li><li id="2516" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">3D图像生成</li><li id="1439" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">生成逼真的照片图像</li><li id="c238" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">风险测量</li><li id="eea2" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">信用卡欺诈检测</li><li id="36b8" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">使用DCGAN生成动画</li></ol><p id="cdbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里是不同GAN的列表<a class="ae ki" href="https://github.com/hindupuravinash/the-gan-zoo" rel="noopener ugc nofollow" target="_blank">的链接</a></p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="94c8" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">DCGAN概述</h1><p id="895e" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">在GAN的原始版本中，网络是完全连接的密集层，而在DCGAN中，两个网络都使用卷积神经网络，CNN在计算机视觉任务中表现突出，在发表的原始文章中，研究人员建议对生成器和鉴别器网络都使用卷积层。从随机向量z开始，DCGAN首先使用完全连接的层将z投影到具有适当大小的新向量中，以便它可以被整形为空间卷积表示(h*w*c ),然后使用一系列卷积层(称为转置卷积)将特征映射上采样到所需的输出图像大小</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lt"><img src="../Images/ffd63c06feb0377246b99d03da0c6d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Jk8vSb6K-U-PD-HDsaT-A.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">转置卷积运算概述</figcaption></figure><p id="5d5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，使用卷积，我们会缩小图像的大小以提取重要的特征图，而使用转置卷积，我们会通过在输入特征图的元素之间插入0来对特征图进行上采样，上图显示了转置卷积的示例，输入大小为4 *4，步长为2 *2，核大小为2 *2。中间的大小为9 * 9的矩阵显示了将零插入到输入特征图中之后的结果，然后使用步长为1的2 *2核执行常规卷积，结果得到大小为8 * 8的输出。我们还可以通过对步长为2的输出执行常规卷积来验证后向方向，结果得到大小为4 *4的输出特征图，这与我们的原始输入4 *4相同</p><p id="c734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">批量标准化是另一种技术，用于防止在训练期间分布发生变化，从而实现更快更好的收敛。批量定额基于计算出的统计数据对小批量要素进行变换。在批量定额的第一步，计算小批量的平均值和标准偏差。它们都在步骤2中使用，以通过z分数归一化来缩放每个小批量中的示例，从而产生标准化的输入。在步骤3中，可学习参数β和γ允许批处理规范控制归一化特征的移动和扩散，下图提供了批处理归一化的完整过程</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lu"><img src="../Images/bdfd44a5d5c2acd6df660a5c2411261c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2WSbZVhQl8KnjKM59SVKog.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">CNN批处理规范化的工作流程</figcaption></figure><h1 id="8513" class="kq kr hi bd ks kt lv kv kw kx lw kz la lb lx ld le lf ly lh li lj lz ll lm ln bi translated"><strong class="ak">DCGAN的架构</strong></h1><p id="8600" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">生成器网络包含10层，它执行步进卷积以增加张量的空间分辨率，在Keras中，上采样和卷积层的组合相当于一个步进卷积层，基本上生成器从正态分布中采样噪声向量，并不断对其进行变换，直到生成与原始数据集形状相同的最终图像，这是代码块和生成器网络架构</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ma"><img src="../Images/1497c489b9a1b9f89858302204807955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQ0iiezMqQaqrZJVfWZ1og.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">DCGAN体系结构</figcaption></figure><p id="11ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">鉴别器网络使用包含10层的CNN，基本上它采用大小为64 * 64 * 3的图像，并使用2D卷积层对其进行下采样，然后将其传递给完全连接的层进行分类。其输出是关于给定图像是假图像还是真实图像的预测。这可以是0或1，如果输出为1，则传递给鉴别器的图像是真实的，如果输出为0，则传递的图像是假图像</p><h1 id="05ac" class="kq kr hi bd ks kt lv kv kw kx lw kz la lb lx ld le lf ly lh li lj lz ll lm ln bi translated"><strong class="ak">损失函数</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es mb"><img src="../Images/5da56e1d42e723436bdb3e96a8efe3a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yJL3I8F6fxsGuAaskGQCnQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">GAN的最小-最大损失函数</figcaption></figure><p id="d752" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的min max V(D，G)称为价值函数，它可以被解释为一个收益我们希望最大化关于鉴别器(D)的价值，同时最小化关于生成器(G)的价值。D(x)是指示输入示例x是真还是假(生成的)的概率，对于这样的值函数，它需要两个优化步骤，一个是最大化鉴别器的收益，另一个是最小化生成器的收益，训练GAN的实际方法是在这两个优化步骤之间交替进行。先冻结一个网络的参数优化另一个网络的权重，冻结第二个优化第一个。这个过程应该在每个训练迭代中重复，如果我们仔细观察上面的方程，它将是与具有不同参数的二元交叉熵损失相同的方程。我不会深入这个方程的推导，但是你可以参考参考文献中提到的原始论文</p><h1 id="19b7" class="kq kr hi bd ks kt lv kv kw kx lw kz la lb lx ld le lf ly lh li lj lz ll lm ln bi translated"><strong class="ak">挑战GANS </strong></h1><p id="6451" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">GAN的一些主要挑战包括消失梯度和不收敛，模型参数振荡、不稳定和从不收敛。GAN训练中的一个常见问题是我们何时停止训练，类似的模式崩溃问题，其中生成器学习产生具有极低变化的样本，例如在MNIST，从数字0到9有10个主要模式，下面的样本由两个不同的GAN生成。第一行产生所有10种模式，而第二行仅产生一种模式(“6”)，这称为模式折叠。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/60143bae0e24897bc43044a496b90948.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*y2T7wzVheUSTWk_L7281tw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">模式崩溃问题</figcaption></figure><p id="4f55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果不手动可视化输出，很难测量GANs性能，我们可以将合成生成的图像添加到原始数据集，并查看混淆矩阵的改进，我们还必须考虑一个常见的过度拟合问题，这可以通过需要耐心的超参数调整来避免</p><p id="d824" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以改进GANs训练的一些方法是通过归一化-1和1之间的图像，使用高斯分布从生成器生成输入x，应用Drop out并使用Adam作为优化器</p><p id="40a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些都是我在训练DCGAN生成动漫角色的过程中实现的技术，只需3行代码就可以下载该数据集，同时附上完整笔记本的链接。</p><div class="md me ez fb mf mg"><a href="https://github.com/avinashreddy02/DeepLearning/blob/master/GAN/dcgan_anime_generation.py" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">avinashreddy 02/深度学习</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">在GitHub上创建一个帐户，为avinashreddy02/DeepLearning开发做贡献。</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">github.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu jj mg"/></div></div></a></div><p id="643e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在训练的初始阶段，GAN通常产生非常低质量的图像，因为网络正在尝试学习参数，并且随着时间的推移，它将创建许多伟大的图像，因为下面的动画生成是在第100个和第200个历元之后生成的两个图像。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mv"><img src="../Images/43d86ff6876ffdcbc06c513318de66e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*DNp_tIoUdrWf9mC6JBI6nA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">百年后的动漫</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="ab fe cl mw"><img src="../Images/1997253b1703f2b7b8411febad2f51bf.png" data-original-src="https://miro.medium.com/v2/format:webp/1*32jgPMZGoOiIXgBZl9VtcA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">200年后的动漫</figcaption></figure><p id="2c9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还可以在GAN labs中体验GAN如何从初始阶段接受培训，以及如何从随机分布中产生价值，链接如下:</p><div class="md me ez fb mf mg"><a href="https://poloclub.github.io/ganlab/" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">甘实验室:在你的浏览器中玩生成性对抗网络！</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">生成器从噪声鉴别器获取样本分类样本计算鉴别器损耗计算…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">poloclub.github.io</p></div></div><div class="mp l"><div class="mx l mr ms mt mp mu jj mg"/></div></div></a></div><h1 id="ba27" class="kq kr hi bd ks kt lv kv kw kx lw kz la lb lx ld le lf ly lh li lj lz ll lm ln bi translated"><strong class="ak">参考文献</strong></h1><div class="md me ez fb mf mg"><a href="https://www.google.com/books/edition/Generative_Adversarial_Networks_Projects/kmSGDwAAQBAJ?hl=en&amp;gbpv=1&amp;printsec=frontcover" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">生成性对抗网络项目</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">使用Python生态系统探索各种生成性对抗网络架构关键特性使用不同的…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">www.google.com</p></div></div><div class="mp l"><div class="my l mr ms mt mp mu jj mg"/></div></div></a></div><div class="md me ez fb mf mg"><a href="https://www.google.com/books/edition/Python_Machine_Learning/sKXIDwAAQBAJ?hl=en&amp;gbpv=1&amp;printsec=frontcover" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">Python机器学习</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">理论基础扎实的应用机器学习。针对TensorFlow 2、GANs和…进行了修订和扩展</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">www.google.c</p></div></div><div class="mp l"><div class="mz l mr ms mt mp mu jj mg"/></div></div></a></div><div class="md me ez fb mf mg"><a href="https://arxiv.org/abs/1406.2661" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">生成对抗网络</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">我们提出了一个新的框架，通过一个对抗的过程来估计生成模型，在这个过程中，我们同时…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">arxiv.org</p></div></div></div></a></div><p id="6370" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读，我乐于接受建议</p></div></div>    
</body>
</html>