<html>
<head>
<title>SQL Data Base Integration with Python for Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向数据科学的 SQL 数据库与 Python 集成</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sql-data-base-integration-with-python-for-data-science-8aefcc25a47f?source=collection_archive---------14-----------------------#2020-11-10">https://medium.com/analytics-vidhya/sql-data-base-integration-with-python-for-data-science-8aefcc25a47f?source=collection_archive---------14-----------------------#2020-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fbb59c8c06390a3b2510b2e38d5a9d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DgQnm8YPk3BOOyiz.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://www.andreafiori.net/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="0e95" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">T3】PostgreSQLT5】</strong></p><p id="e507" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在您的数据科学之旅中，您不会收到 excel 表格中的数据。数据将主要在数据库中，我们必须从那里提取必要的数据。在这里，我们将看到 SQL 数据库 postgresql 以及如何在您的 python 代码中为您的 AI 或数据科学活动访问它。</p><p id="1047" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">什么是数据库？</em>T9】</strong></p><p id="08df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据库是通过列相互关联的表的集合。对于大多数现实世界的项目，数据库是必不可少的。我们可以使用 SQL(结构化查询语言)来创建、访问和操作数据。我们还可以利用标准化来避免数据冗余。</p><p id="96e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于数据库编程，Python 支持很多数据库服务器- <br/> MySQL、Oracle、PostgreSQL、SQLite、Sybase、Microsoft SQL Server、mSQL、Microsoft Access 等等。它还支持数据查询语句、数据定义语言(DDL)和数据操作语言(DML)。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="89f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">如何连接 PostgreSQL？</em> </strong></p><p id="7b3c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将看到如何通过这些工具连接到 PostgreSQL</p><ul class=""><li id="8184" class="kb kc hi ix b iy iz jc jd jg kd jk ke jo kf js kg kh ki kj bi translated">psql—PostgreSQL 数据库服务器的基于终端的前端。</li><li id="0bb7" class="kb kc hi ix b iy kk jc kl jg km jk kn jo ko js kg kh ki kj bi translated">pg admin—PostgreSQL 数据库服务器的基于 web 的前端。</li></ul><p id="85b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">第 1 部分:使用 psql 连接到 PostgreSQL 数据库服务器</em> </strong></p><p id="d65a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，启动 psql 程序，并使用 postgres 用户连接到 PostgreSQL 数据库服务器:</p><p id="a7f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以单击 enter，它将进入下一步。在密码部分给出你输入的密码，所有其他细节服务器，数据库，端口默认值。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/949610b13ee7b15ba90c6864f51ef1e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4gaVMcVPa3UAxbM_BVg44Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">PSQL 命令外壳连接到 postgresql 服务器</figcaption></figure><p id="aeb4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">检查 PostgreSQL 的版本</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="61c4" class="kz la hi kv b fi lb lc l ld le"><strong class="kv hj">SELECT</strong> <strong class="kv hj">version</strong>();</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/c4ee26be1424935dfc3ba80a58cd43a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqkq7rbf3agATaesK05kDQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">postgresql 版本</figcaption></figure><p id="11ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请不要忘记以分号(；).按下<strong class="ix hj"> Enter </strong>后，psql 将返回您系统上当前的 PostgreSQL 版本。</p><p id="4a93" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">第 2 部分:使用 pgAdmin </em> </strong>连接到 PostgreSQL 数据库服务器</p><p id="a45b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，启动 pgAdmin 应用程序。</p><p id="9bdb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">pgAdmin 应用程序将在 web 浏览器上启动，如下图所示</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/733c57057c8df868400b885aaaebf015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7c17TYwE-nahOh_yEkgFoA.png"/></div></div></figure><p id="c558" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要创建数据库，右键单击 Servers 节点并选择<strong class="ix hj"> Create &gt; Server… </strong>菜单来创建服务器</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/482ae3a077bf4cf3bad672a7c51a1152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*Bz81ubf4o5v5wBVBonkdQg.png"/></div></div></figure><p id="a565" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以指定数据库名称，输入<strong class="ix hj"> postgres </strong>用户的主机和密码，点击<strong class="ix hj">保存</strong>按钮</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es li"><img src="../Images/cac14271134ce28861c4b4ed0242c1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*5MoBpmzRxHAPK-wy6HN9Aw.png"/></div></figure><p id="c0cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我创建了一个名为 course_data 的数据库。通过选择菜单项<strong class="ix hj">工具&gt;查询工具</strong>或点击“对象”正下方的第一个图标，选择数据库打开查询工具。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/9b636df54e23d72f4c45f8fd2d17f4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*2fe3uGr8cw7gELY0NVSObg.png"/></div></figure><p id="fa04" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在查询工具中测试 postgresql 的版本。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/7551ee13e50dd1d53598de6c92115ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tbH5DZGhkTMjr4j1I21UmA.png"/></div></div></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="9d0f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> PostgreSQL 数据库到 Python 的连接</em> </strong></p><p id="35ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">打开 vscode 或 pycharm，选择您最喜欢的 Python IDE。</p><p id="129f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在终端中使用 pip 安装名为 psycogp2 的模块。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="ca15" class="kz la hi kv b fi lb lc l ld le">pip install psycopg2</span></pre><p id="3f88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要连接到 course_data 数据库，可以使用 psycopg2 模块的 connect()函数。</p><p id="e69e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">connect()函数创建一个新的数据库会话，并返回连接类的一个新实例。通过使用 connection 对象，您可以创建一个新的游标来执行任何 SQL 语句。</p><p id="3a38" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要调用<code class="du ll lm ln kv b">connect()</code>函数，需要如下指定 PostgreSQL 数据库参数:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="4825" class="kz la hi kv b fi lb lc l ld le">conn = psycopg2.connect(     <br/>host="localhost",              #give your host where postgresql   <br/>database="coursedata_db",      #give your db name    <br/>user="postgres",               #give your username   <br/>password="password")           #give your password to db</span></pre><p id="123d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">数据库</em> </strong> <em class="jt">:您要连接的数据库的名称。<br/> </em> <strong class="ix hj"> <em class="jt">用户</em> </strong> <em class="jt">:用于认证的用户名。<br/> </em> <strong class="ix hj"> <em class="jt">密码</em> </strong> <em class="jt">:用于认证的密码。<br/> </em> <strong class="ix hj"> <em class="jt">主机</em> </strong> <em class="jt">:数据库服务器地址如 localhost 或 IP 地址。<br/> </em> <strong class="ix hj"> <em class="jt">端口</em> </strong> <em class="jt">:不提供默认为 5432 的端口号。</em></p><p id="6a10" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过游标对象和执行函数，我们可以从数据库中提取列或行</p><p id="d29d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">execute():执行 SQL 语句<br/> fetchall():读取结果<br/> close():关闭与服务器的通信和连接</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/ecb9cdc4c6803ce4d0af7029e9866f36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKSVyAR0MYwFwuJDJ5tmng.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">vscode python 连接到 postgresql 数据库</figcaption></figure><p id="c74d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用 python 代码编写的 SQL 语句，我们可以从 SQL 数据库中提取数据用于数据分析。</p><p id="c3e1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">与我保持联系<em class="jt"> </em> <a class="ae iu" href="https://www.linkedin.com/in/arun-purakkatt-mba-m-tech-31429367/" rel="noopener ugc nofollow" target="_blank"> <em class="jt">链接</em> </a>。</p><p id="0f8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">演职员表&amp;参考文献:</em> </strong></p><ol class=""><li id="7d43" class="kb kc hi ix b iy iz jc jd jg kd jk ke jo kf js lp kh ki kj bi translated"><a class="ae iu" href="https://www.postgresql.org/" rel="noopener ugc nofollow" target="_blank">https://www.postgresql.org/</a></li><li id="9f9b" class="kb kc hi ix b iy kk jc kl jg km jk kn jo ko js lp kh ki kj bi translated"><a class="ae iu" href="https://www.postgresqltutorial.com/" rel="noopener ugc nofollow" target="_blank">https://www.postgresqltutorial.com/</a></li></ol></div></div>    
</body>
</html>