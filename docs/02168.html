<html>
<head>
<title>Mahotas — Image Processing and Manipulation for Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">maho tas—Python的图像处理和操作</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mahotas-image-processing-and-manipulation-for-python-ddb1edb68880?source=collection_archive---------2-----------------------#2019-12-04">https://medium.com/analytics-vidhya/mahotas-image-processing-and-manipulation-for-python-ddb1edb68880?source=collection_archive---------2-----------------------#2019-12-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8364" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Mahotas是一个用于Python的计算机视觉和图像处理库。库是函数和方法的集合，允许您执行许多操作，而不必编写数百行代码。我们都使用图书馆；从numpy到熊猫到matplotlib等等。否则你就要用c语言写代码了。我喜欢快捷方式！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/e942140bab96e0c491d7b1ed4bd0edd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/1*mZVuWMe_UVg_5urYSV2T9g.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">查克也喜欢它👍</figcaption></figure><p id="d06b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Mahotas包括许多算法，这些算法使用数组和一个非常干净的Python接口进行操作。Mahotas算法是用C++实现的，但几乎总是调用Python函数来检查类型，然后调用内部函数。这使得它比仅用C++编写稍微慢一些，但仍然比只使用python快得多。主要是为了C++的处理速度和能力才这样开发的。</p><p id="1aff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Mahotas目前有超过100个用于图像处理和计算机视觉的功能，并且还在不断增长。</p><p id="94a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">mahotas功能的一些示例列表:</p><ul class=""><li id="b14d" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj">色彩空间转换* </strong></li><li id="dd53" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">卷积* </strong></li><li id="3513" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">凸点计算</li><li id="ece0" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kd" href="http://mahotas.readthedocs.io/en/latest/api.html#mahotas.hitmiss" rel="noopener ugc nofollow" target="_blank">撞上了&amp;小姐。细化</a></li><li id="2907" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kd" href="http://mahotas.readthedocs.io/en/latest/morphology.html" rel="noopener ugc nofollow" target="_blank">形态学处理</a></li><li id="4864" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">Sobel边缘检测</li><li id="6e6f" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kd" href="http://mahotas.readthedocs.io/en/latest/surf.html" rel="noopener ugc nofollow" target="_blank">加速鲁棒特征(SURF)，局部特征的一种形式</a></li><li id="ae86" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kd" href="http://mahotas.readthedocs.io/en/latest/thresholding.html" rel="noopener ugc nofollow" target="_blank">阈值处理</a></li><li id="60cf" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kd" href="http://mahotas.readthedocs.io/en/latest/api.html#mahotas.cwatershed" rel="noopener ugc nofollow" target="_blank">分水岭</a></li><li id="a4f2" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">泽尼克&amp;哈拉里克，<a class="ae kd" href="http://mahotas.readthedocs.io/en/latest/lbp.html" rel="noopener ugc nofollow" target="_blank">局部二元模式</a>，以及TAS特征</li></ul><h2 id="f09f" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">为什么是Mahotas:</h2><ol class=""><li id="871a" class="jp jq hi ih b ii kz im la iq lb iu lc iy ld jc le jv jw jx bi translated"><strong class="ih hj">快码:</strong>性能是它的一大关键。因为Mahotas是建立在C++之上的，它真的和计算一样快。加上数组可以Mahotas可以有效地计算大量的数据。</li><li id="36b4" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc le jv jw jx bi translated"><strong class="ih hj">简单代码:</strong>代码要简单，一般一两行就能得到一个效果。你不会在你的代码中写短篇故事。</li><li id="740c" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc le jv jw jx bi translated">最小依赖性: Mahotas被建造得尽可能独立；从其他模块。这意味着在大多数情况下，只需要导入Mahotas就可以运行它的功能。现在，mahotas依赖于C++编译器，数值计算。Numpy的模块是不需要的，编译器涵盖了这一点。但是数组用于将图像转换成数值(用于图像处理)。</li></ol><h2 id="1b34" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">好了，到了有趣的部分</h2><p id="38b6" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated"><strong class="ih hj">色彩空间转换</strong></p><p id="bbe8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要从pylab导入Mahotas和imshow，以显示图像和编辑图像:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="e672" class="ke kf hi lj b fi ln lo l lp lq">import mahotas as mh<br/>from pylab import imshow, show</span></pre><p id="0127" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将Mahotas缩写为mh也是标准做法。</p><p id="bc56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来我们需要一个图像来操作:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="37df" class="ke kf hi lj b fi ln lo l lp lq">#loading image and converting image into an array of RGB values<br/>im = mh.imread('myheroacademia_vol_25.jpg')<br/>im</span><span id="37da" class="ke kf hi lj b fi lr lo l lp lq">&gt;&gt;array([[[148,  55, 144],<br/>        [148,  55, 144],<br/>        [148,  55, 144],<br/>        ...,<br/>        [146,  56, 143],<br/>        [135,  50, 133],<br/>        [225, 142, 222]],<br/><br/>       [[148,  55, 144],<br/>        [148,  55, 144],<br/>        [148,  55, 144],<br/>        ...,<br/>        [146,  56, 143],<br/>        [135,  50, 133],<br/>        [225, 142, 222]],<br/><br/>       [[148,  55, 144],<br/>        [148,  55, 144],<br/>        [148,  55, 144],<br/>        ...,<br/>        [146,  56, 143],<br/>        [135,  50, 133],<br/>        [225, 142, 222]],<br/><br/>       ...,<br/><br/>       [[143,  56, 151],<br/>        [148,  54, 150],<br/>        [152,  52, 148],<br/>        ...,<br/>        [  8,   4,   3],<br/>        [  4,   5,   7],<br/>        [ 69,  86,  96]],<br/><br/>       [[145,  55, 153],<br/>        [148,  54, 151],<br/>        [152,  52, 150],<br/>        ...,<br/>        [  8,   4,   3],<br/>        [  4,   5,   7],<br/>        [ 69,  86,  96]],<br/><br/>       [[145,  55, 155],<br/>        [149,  53, 153],<br/>        [152,  52, 150],<br/>        ...,<br/>        [  8,   4,   3],<br/>        [  4,   5,   7],<br/>        [ 69,  86,  96]]], dtype=uint8)</span></pre><p id="85ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以称图像的形状为:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="8c64" class="ke kf hi lj b fi ln lo l lp lq"># This will display the width, height (in pixels) and how many color channels the image has</span><span id="7217" class="ke kf hi lj b fi lr lo l lp lq">im.shape<br/>&gt;&gt;(1200, 763, 3)</span></pre><p id="9fdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">RGB图像被表示为形状为<code class="du ls lt lu lj b">(h,w,3)</code>的三维数组，其中每个像素由三个值表示，红/绿/蓝。</p><p id="e699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用函数imshow()来查看图像</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="2d98" class="ke kf hi lj b fi ln lo l lp lq"># displaying the image with figsize<br/>ax.imshow(im)<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lv"><img src="../Images/fc7b70a1865d300600b44c7136ca1089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WSkgMgH1COMDC7EQK_DtTA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">在博库没有学术界的主要薇莉安——东村志平，这样一个坏蛋！</figcaption></figure><p id="7884" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将转置图像(im)的RGB值。这将一个值分配给图像转换后的数组，分别转换为绿色、蓝色和红色值。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="024c" class="ke kf hi lj b fi ln lo l lp lq">r,g,b = im.transpose((2,0,1))</span></pre><h2 id="a290" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">现在操纵:</h2><p id="ddfd" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">我们可以从简单开始，使用mahotas函数将图像从RGB变为棕褐色:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="c426" class="ke kf hi lj b fi ln lo l lp lq">tomura_sepia = mh.colors.rgb2sepia(im)<br/>imshow(tomura_sepia)<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es ma"><img src="../Images/5ed240296e996a97fa3a39992880cd53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*49vRY9C_aOXvHPr650xG7g.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">漂亮简单的棕褐色，没有photoshop。</figcaption></figure><p id="48b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以对图像使用伽玛校正，以提高RGB值的亮度(光的强度)</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="ffc0" class="ke kf hi lj b fi ln lo l lp lq"># Changing the gamma values to the second power<br/>imshow(im ** 2.0)<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lv"><img src="../Images/7c713b4b02fc739f54b8a2b34c696d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1dHL89FxP90gZE6IIhkMLA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">好吧，也许我曝光过度了，哈哈</figcaption></figure><p id="6e1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们降低伽玛校正，以便更好地查看图像:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="85f8" class="ke kf hi lj b fi ln lo l lp lq">imshow(im ** 0.02)<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mb"><img src="../Images/7092e337bb3af1359722f626a94b9c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBPCnt03xSVECJFBwRAWeg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">好点了</figcaption></figure><p id="bfc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过向后拉伸伽玛来恢复原始图像:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="0321" class="ke kf hi lj b fi ln lo l lp lq">imshow(mh.stretch(im ** 1.0))<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lv"><img src="../Images/fc7b70a1865d300600b44c7136ca1089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WSkgMgH1COMDC7EQK_DtTA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">恢复正常</figcaption></figure><p id="d7ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以单独编辑RGB灰度值:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="c4f4" class="ke kf hi lj b fi ln lo l lp lq">imshow(mh.as_rgb(r ** .7, g ** 2 , b ** .7))<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lv"><img src="../Images/94bb95112931c04757e988a9d447fcdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7S-i1buzV_ltfyaywbRH_A.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">不是我想要的样子，让我们调整一下。</figcaption></figure><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="6ef1" class="ke kf hi lj b fi ln lo l lp lq">ax.imshow(mh.as_rgb(r ** 1.9, g , b **3))<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lv"><img src="../Images/826bb0bee0bfdd2d5753541530071dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JeB6h3ZQWCh0d_9PVEfBDQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">酷多了😎</figcaption></figure><p id="e19e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们可以在保存RGB值更改并添加以下内容后导出图像:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="d2ff" class="ke kf hi lj b fi ln lo l lp lq">im_filtered = mh.as_rgb(r ** 1.9, g , b **3)<br/><br/>mh.imsave('myheroacademia_vol_25_changed_RGB.jpg', im_filtered)</span></pre><h2 id="fbd4" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">沃尔多在哪？</h2><p id="a7c4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated"><strong class="ih hj">卷积</strong></p><p id="4ee2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Mahotas实现的另一个惊人特性是演示“Wally”，在美国他被称为“Waldo”:</p><p id="85f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，您需要导入:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="022f" class="ke kf hi lj b fi ln lo l lp lq">import mahotas as mh<br/>import mahotas.demos</span></pre><p id="a0dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们需要从演示中加载图像“wally”并显示它:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="41c8" class="ke kf hi lj b fi ln lo l lp lq">wally = mh.demos.load('wally')<br/>imshow(wally)<br/>show()<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mc"><img src="../Images/35e7f783b3f0ab118c434e12d5867073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L3CC8oUYox817KlRhc2Hag.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">你能找到沃尔多吗？英雄联盟</figcaption></figure><p id="f8f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要将wally图像转换为float并转置图像，将新的float图像拆分为R、G、B通道，并获得白色通道:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="3137" class="ke kf hi lj b fi ln lo l lp lq">waldo_float = wally.astype(float)<br/>r,g,b = waldo_float.transpose((2,0,1))</span><span id="ffa2" class="ke kf hi lj b fi lr lo l lp lq"># w is the color white's channel<br/>w = waldofloat.mean(2)</span></pre><p id="7626" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我们需要在y轴上建立一个+1，-1，+1，-1的模式。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="070e" class="ke kf hi lj b fi ln lo l lp lq">pattern = np.ones((24,16), float)<br/>for i in range(2):<br/>    pattern[i::4] = -1</span></pre><p id="fa72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们使用上面的模式对红色减去白色进行卷积。这将对沃尔多的衬衫在哪里产生强烈的反应。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="90e8" class="ke kf hi lj b fi ln lo l lp lq">v = mh.convolve(r-w, pattern)</span></pre><p id="7a05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要做一个面具。图像编辑技术中的遮罩，用于隐藏或暗化图像中不需要的像素:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="4789" class="ke kf hi lj b fi ln lo l lp lq">mask = (v == v.max())<br/>mask = mh.dilate(mask,np.ones((48,24)))</span><span id="2214" class="ke kf hi lj b fi lr lo l lp lq">wally -= np.array(.8*wally * ~mask[:,:,None], dtype=wally.dtype)</span></pre><p id="0dba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们只需要显示图像:</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="9180" class="ke kf hi lj b fi ln lo l lp lq">imshow(wally)<br/>&gt;&gt;</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mc"><img src="../Images/5e01dca51ce0bb959e9f044f83c713b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6F27616lsS_f1T-kJ5-Prg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">他在那里！！！</figcaption></figure><p id="6bff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我看到这个时，数组编辑图像的能力给我留下了深刻的印象。我希望你也是。</p></div></div>    
</body>
</html>