<html>
<head>
<title>Follow these simple steps to solve ML regression problems effectively.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">遵循这些简单的步骤来有效地解决ML回归问题。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/follow-these-simple-steps-to-solve-ml-regression-problems-effectively-5b92250773ab?source=collection_archive---------11-----------------------#2020-05-19">https://medium.com/analytics-vidhya/follow-these-simple-steps-to-solve-ml-regression-problems-effectively-5b92250773ab?source=collection_archive---------11-----------------------#2020-05-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/242387345a5135c0ceb69596c7efbef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*hK697mGf3U8a40yu.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">来源:谷歌</figcaption></figure><p id="b30b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分类问题很简单，因为我们可以依靠类的概率来分类。但是，当涉及到回归时，我们必须预测精确的值。当维数增加时，这个问题变得更加明显。为了预测准确的值，我们需要选择正确的属性和预测值。</p><p id="246d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，拥有解决这些问题的标准方法变得非常方便。在这篇文章中，我将解释我解决回归问题的标准方法。</p><p id="6a1d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将使用<a class="ae jo" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data?select=train.csv" rel="noopener ugc nofollow" target="_blank">ka ggle房价</a>数据集。这是<a class="ae jo" href="https://github.com/narsym/House-Price-Prediction-Advanced-Regression-Techniques" rel="noopener ugc nofollow" target="_blank">一个完整项目的链接</a>，我建议你下载它并按照你的方式阅读这篇文章。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="f44e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当使用pandas读取时，数据集如下所示。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es jw"><img src="../Images/5861f256355bb090ed16c829d902455e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MrVvffxHOEDlpd2CwxQjEw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">加载的数据集</figcaption></figure><p id="79e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们所观察到的，有空值、多维度、分类属性。因此，在应用机器学习算法之前，需要清理数据、降低维度并对分类变量进行编码。</p><p id="96ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以通过遵循一系列步骤来解决所有这些问题。</p><p id="55a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 1。数据清理。</strong></p><p id="6500" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这一步中，目标是消除空值。我们可以通过多种方式做到这一点，用平均值填充缺失值，或者删除缺失值的行，或者删除缺失值的列。</p><p id="cf61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了简单起见，我删除了所有缺少值的列。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kf"><img src="../Images/76c0f438813f44183a0c0c10e8899043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3HyG1DtLBM9Uh05U6RXVw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">清理的数据</figcaption></figure><p id="c77b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2。分离定性和定量属性。</strong></p><p id="5479" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这一步有助于简化特征选择。数字属性很容易输入到特征选择算法中，但是当涉及到分类属性时，我们需要首先对它们进行编码，然后在这些编码的属性上选择特征。那么，当我们可以分别对它们进行手术时，为什么要一起处理呢？</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kg"><img src="../Images/b14f7d161b74f4ba5da2b16052f42e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1kFGzUl-00iwSFgfDWvclw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">分离定性和定量属性</figcaption></figure><p id="d4e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3。数量属性的特征选择。</strong></p><p id="cb38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我已经使用ExtraTreesRegressor进行了特征选择，但是您可以从sklearn.feature_selection类中选择任何模型。Chi2，SelectKBest模型在特性选择方面非常有效，如果您使用笔记本阅读本文，可以尝试使用它们。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kh"><img src="../Images/a2f74df67057b75aa034b19e08d13053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lztic977n9d4qKqKQhB5Yw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">定性属性中的10大特征</figcaption></figure><p id="ad7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从图中可以看出，我们可以使用OverallQual、GarageCars、GrLivArea进行预测。所以，我给他们存储了一个新的数据帧。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ki"><img src="../Images/20c0c40a59530705f8e41fa454195c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_n86eXCYu8GPSP-QGPHBw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">有用的数量属性</figcaption></figure><p id="5fbf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 4。对定性属性进行编码并执行特征选择。</strong></p><p id="7a70" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里对定性属性进行编码，我使用了sklearn.preprocessing中可用的OrdinalEncoder，如果你想使用另一个编码器，你可以使用LabelEncoder，OneHotEncoder，BinaryEncoder等。</p><p id="ab04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于特征选择，我使用了基于树的RandomForestClassifier。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kj"><img src="../Images/6a8ccb8b0b1744945d696d2218eec5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9CIqnqNX5XAoUQZO8EdrnQ.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">有用的定性属性</figcaption></figure><p id="4c44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从柱状图来看，我们可以使用邻居、房屋风格、外部第二。但是为了方便起见，我们只使用邻居和房子风格。</p><p id="983f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 5。绘制定量属性的相关矩阵，并删除高度相关的属性。</strong></p><p id="4141" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，您可以执行一些探索性的数据分析。这是一个简单的散点图，用于检查更大的居住面积和房屋风格销售价格之间的关系。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kk"><img src="../Images/80c9594f0bf823538189a91f8b6bad98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ftdxmXpKdg1jxQ1jQ5mPoQ.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">散点图</figcaption></figure><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/5888b9d6e011afe714dc2fe2e5dcdfca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*5ZOhpl1hIkJxmB1vrIUt3g.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">相关矩阵</figcaption></figure><p id="fb7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以看到没有属性是高度相关的。所以不需要丢弃任何属性。</p><p id="c475" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">即使在这一步之后，如果你得到的是高维数据，你也可以使用降维技术，比如主成分分析。</strong>这里我们有6个属性，所以我们跳过主成分分析。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es km"><img src="../Images/2c079943d66ab2007f077766397e8ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QyayLlb0I2GyXOxL5YdJg.png"/></div></div></figure><p id="587a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 6。编码分类属性。</strong></p><p id="89ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是将分类数据输入机器学习算法的预处理步骤。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kn"><img src="../Images/677f5de5cd1150651e0bb6bdfb38cda5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sH2Rsw4PKvVTByyctO615Q.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">编码分类属性</figcaption></figure><p id="bfec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我使用了虚拟变量，因为这种类型的编码比顺序编码和标签编码等编码类型更有效。</p><p id="e574" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 7。通过连接我们的定性和定量属性创建新的数据框架。</strong></p><p id="7f8c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在此步骤中，将所有定性和定量属性连接成一个数据框。这个数据帧被输入到机器学习算法中。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kg"><img src="../Images/54d55fbfa76c29fcc64ab74884cc68ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oSvQYIMzLtWNWCnAk-2JhA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">准备接受训练</figcaption></figure><p id="6bba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们的数据可以输入到机器学习算法中了。但是首先让我们分成训练集和测试集。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ko"><img src="../Images/e0f58924b5a27895ede333f483f8a8f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2nC8Kq4pJPNnTJ4o33iPA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">训练、测试、分割</figcaption></figure><p id="d415" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 8。应用机器学习算法。</strong></p><p id="5b9d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我选择了线性支持向量回归机。我选择了这种算法，因为它比其他支持向量算法更快，并且需要调整的参数更少。我对它做了一些调整，发现对于这些参数，它给出了最好的分数。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kp"><img src="../Images/36142e2f10440915dcbe2e8411fe3d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XiOuo7wDguW3anY7NkwWg.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">支持向量机</figcaption></figure><p id="1c16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的测试有80%的准确率。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/b9a46d88f7fd6916b00b817f39f57dbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*ILbsCiHkyBZ6v__ybcxsjg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">准确(性)</figcaption></figure><p id="cf13" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">80%的准确率是非常好的，即使我们已经跳过了许多步骤，如填充空值，操作不同的算法等。让我们绘制一个直方图，看看我们的预测是如何随着测试集而变化的。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kr"><img src="../Images/3bee208c82d2cfd9d1ffb0adeff5ca0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*aPhon3at4iZ3LaFmUaMg7A.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">检查差异的直方图</figcaption></figure><p id="7f92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以看到我们的预测非常接近原始值。让我们看看均方误差。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/8087762bfb7b50ce731bf3c8cb75c125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*zm6wC1aI9BdcwnJT7fLMFQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">均方误差</figcaption></figure><p id="9515" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们得到0.039非常好的MSE。</p><p id="5ea8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，按照这些简单的步骤，我们能够获得80%的准确度和0.039 MSE。所以我们可以看到，这些步骤，如果按照顺序来做，是相当有效的。</p><p id="bf38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你有什么想法，请在评论中告诉我。</p><p id="8088" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望这篇文章不要太长太无聊。</p><p id="f0fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>