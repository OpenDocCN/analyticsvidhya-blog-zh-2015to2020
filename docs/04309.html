<html>
<head>
<title>Custom/multiple python or cuda on any Linux system or server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">任何Linux系统或服务器上的定制/多python或cuda</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/custom-multiple-python-or-cuda-on-any-linux-system-or-server-ecd22b5e7b6d?source=collection_archive---------26-----------------------#2020-03-13">https://medium.com/analytics-vidhya/custom-multiple-python-or-cuda-on-any-linux-system-or-server-ecd22b5e7b6d?source=collection_archive---------26-----------------------#2020-03-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/2797a6b42a17b015d0a7e03623d25040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*wE8NQBX8h0aBZ94Q.jpg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图片来源:<a class="ae iq" href="https://wccftech.com/" rel="noopener ugc nofollow" target="_blank">https://wccftech.com/</a></figcaption></figure><p id="8385" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我当时正在我大学的计算服务器上工作，不幸的是事情并不顺利，他们有非常好的计算资源，但我无法利用这些能力，并且正在烧毁我的笔记本电脑。作为一名机器工程师，我必须使用最好的硬件来完成工作。我的大学提供了最好的计算环境之一(<a class="ae iq" href="http://support.eecs.qmul.ac.uk/research/compute-servers/" rel="noopener ugc nofollow" target="_blank"> EECS </a>)，但是很难使用它们来创建虚拟环境并马上开始。因此，在与IT人员进行了大量邮件追逐和沮丧之后，我决定使用我自己的定制python，为我自己原生构建。</p><h1 id="7e17" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">安装python</h1><p id="84b7" class="pw-post-body-paragraph ir is hi it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hb bi translated">为了将python安装到自定义路径并使用它，需要记住一些事情。首先，路径应该有读写权限，为此，你可以使用home目录~/来实现这个目的。其次，应该正确初始化路径和LD_LIBRARY_PATH，这样，如果您使用python RHEL或PIP，它会自动选择，您不必一次又一次地指定路径。</p><p id="e850" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">第一部分——python安装</strong></p><p id="36e5" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">本指南可以用于任何可以从源代码构建的包安装，python在这里只是一个例子。在主目录中创建目录，并使用wget下载python，在那里安装python并提取python</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="2010" class="lb jq hi kx b fi lc ld l le lf">mkdir -p $HOME/local/src $HOME/local/share/lmodfiles                                               cd $HOME/local/src                       <br/>wget <a class="ae iq" href="https://www.python.org/ftp/python/3.6.9/Python-3.6.9.tgz" rel="noopener ugc nofollow" target="_blank">https://www.python.org/ftp/python/3.6.9/Python-3.6.9.tgz</a></span><span id="4f07" class="lb jq hi kx b fi lg ld l le lf">tar zxvf Python-3.6.9.tgz</span></pre><p id="c356" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">安装零件</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="b965" class="lb jq hi kx b fi lc ld l le lf">cd Python-3.6.9<br/>./configure — prefix=$HOME/local/Python/3.6.9 --enable-optimizations<br/>make &amp;&amp; make install</span></pre><p id="9680" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这将在<em class="lh">$ HOME/local/python/3 . 6 . 9/bin/Python</em>安装Python，您可以从那里使用Python，但这不是全部。每次运行python文件或调用RHEL python终端时，您都必须编写自定义路径。另外，如果你必须安装像tensorflow和numpy这样的包，那么你也必须指定路径。这还不是全部，如果你的库路径没有初始化你的python，它将不会识别你的python。这就是为什么我们要做第二部分。</p><p id="b840" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">第二部分—环境变量</strong></p><p id="aecb" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">第一种简单的方法是只附加路径和LD_LIBRARY_PATH，并附加在~/中。bashrc或者~/。bash_profile但是~/里已经有这样的东西了怎么办。bashrc或者您没有访问~/的权限。或者你想有一个自己的自定义软件包？对于这样的需求和遵循最佳实践，我们将使用Linux " <em class="lh">模块</em>的功能。</p><p id="02d0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">模块的描述说"<em class="lh">模块是模块包的用户接口。模块包通过模块文件</em>提供用户环境的动态修改。这意味着，为了使用我们的定制软件或python(在我们的例子中)，我们需要编写一个modulefile并在我们开始使用它时调用它。</p><p id="4506" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">modulefile可以用lua或tcl编写，这取决于系统发行版。但本质上它们非常非常简单。根据系统的不同，您可以遵循任一步骤。</p><p id="f8be" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj"> 1。lua模块文件</strong></p><p id="3631" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">您应该创建目录<em class="lh">$ HOME/local/share/lmodfiles/python</em>，并在该目录中创建一个名为3.6.9.lua的模块文件</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="fdc8" class="lb jq hi kx b fi lc ld l le lf">cd $HOME/local/share/lmodfiles/python<br/>nano 3.6.9.lua</span></pre><p id="3a7d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">然后添加到线下，并根据需要更新路径</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="70ac" class="lb jq hi kx b fi lc ld l le lf">-- Local Variables                       <br/>local name = "Python"                       <br/>local version = "3.6.9"</span><span id="33a6" class="lb jq hi kx b fi lg ld l le lf">-- Locate Home Directory                       <br/>local homedir = os.getenv("HOME")                       <br/>local root = pathJoin(homedir, "local", name, version)<br/>                                                                   -- Set Basic Paths                       <br/>prepend_path("PATH", pathJoin(root, "bin"))                       prepend_path("MANPATH", pathJoin(root, "share/man"))</span></pre><p id="0c82" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj"> 2。tcl模块文件</strong></p><p id="c09a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">您应该创建$ HOME/local/share/lmodfiles/python目录，并在该目录中创建一个名为3.6.9的模块文件</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="f2e3" class="lb jq hi kx b fi lc ld l le lf">cd $HOME/local/share/lmodfiles/python<br/>nano 3.6.9.lua</span></pre><p id="fc39" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">然后添加到线下，并根据需要更新路径</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="1d8e" class="lb jq hi kx b fi lc ld l le lf">#%Module<br/>#<br/># Module Python 3.6.9<br/>proc ModulesHelp { } {<br/>        global python_version<br/>        puts stderr "\tSets the environment for Python $python_version"<br/>        puts stderr "\n"<br/>        puts stderr "\tProduct information:\thttps://<a class="ae iq" href="http://www.python.org/downloads/release/python-366/" rel="noopener ugc nofollow" target="_blank">www.python.org/downloads/release/python-369/</a>"<br/>}</span><span id="5933" class="lb jq hi kx b fi lg ld l le lf">set     python_version       3.6.9<br/>set     python_root          $HOME/local/Python/3.6.9</span><span id="3e76" class="lb jq hi kx b fi lg ld l le lf">module-whatis "Sets the environment for Python $python_version"</span><span id="9c3a" class="lb jq hi kx b fi lg ld l le lf">conflict python</span><span id="ce03" class="lb jq hi kx b fi lg ld l le lf">prepend-path PYTHONPATH         $python_root/lib/python3.6/site-packages<br/>prepend-path PATH               $python_root/bin<br/>prepend-path LD_LIBRARY_PATH    $python_root/lib</span></pre><h2 id="4a84" class="lb jq hi bd jr li lj lk jv ll lm ln jz jc lo lp kd jg lq lr kh jk ls lt kl lu bi translated"><strong class="ak">最后一部分——用途</strong></h2><p id="9b23" class="pw-post-body-paragraph ir is hi it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hb bi translated">为了使用您的自定义python，您总是要编写</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="b637" class="lb jq hi kx b fi lc ld l le lf">module use $HOME/local/share/lmodfiles</span></pre><p id="e37c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">然后在模块中加载</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="3e41" class="lb jq hi kx b fi lc ld l le lf">module load Python/3.6.9</span></pre><p id="1234" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">检查模块文件是否正确写入的一种方法是在键入<code class="du lv lw lx kx b">module load</code>后按双tab键</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ly"><img src="../Images/213bc2107bfae5722d70e31f48acf1f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uWI5-iRS6GN8I5uCEHOlkg.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">健全性检查1</figcaption></figure><p id="60e1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">加载模块后，您可以使用“which”命令来检查是否选择了自定义python。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es md"><img src="../Images/4689edef124596e1f151b94a08abccd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*yHNOgJcvy2pTq5QPHQ2MpQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">健全检查2</figcaption></figure><p id="0280" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">然后，您可以使用<code class="du lv lw lx kx b">python3 -m pip install virtualenv</code>来安装虚拟环境，并从您的定制python开始。</p><h1 id="bdbe" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">参考</h1><div class="me mf ez fb mg mh"><a href="https://www.osc.edu/resources/getting_started/howto/howto_locally_installing_software" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">HOWTO:本地安装软件</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">有时，在HPC系统上访问一个软件的最佳方式是自己将它安装为“本地……</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">www.osc.edu</p></div></div></div></a></div><div class="me mf ez fb mg mh"><a href="http://tommymao.blogspot.com/2018/02/cant-connect-to-https-url-because-ssl.html" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">无法连接到HTTPS URL，因为SSL模块不可用。</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">尝试运行python但遇到此错误:[root @ nbu 773 SRV 1 tmp]# python 3 get-pip . py pip配置为…</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">tommymao.blogspot.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ik mh"/></div></div></a></div><p id="559f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><a class="ae iq" href="https://unix.stackexchange.com/a/42583" rel="noopener ugc nofollow" target="_blank">https://unix.stackexchange.com/a/42583</a></p></div></div>    
</body>
</html>