<html>
<head>
<title>Predicting NJ Transit Delays Using Decision Trees</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用决策树预测新泽西州的交通延误</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-nj-transit-delays-using-decision-trees-58197bd1ca5f?source=collection_archive---------12-----------------------#2019-10-25">https://medium.com/analytics-vidhya/predicting-nj-transit-delays-using-decision-trees-58197bd1ca5f?source=collection_archive---------12-----------------------#2019-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/36187ae83040488283231c25a250b7c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xCck7EJYpZrVtnjh"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的sanga Rima Roman Selia拍摄</figcaption></figure><p id="54c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我每天早上的通勤时间至少需要一个半小时，最长两个小时不等，这取决于我在某一天的运气如何<em class="jt"/>。或者至少，在我质疑我是否能找到任何关于我通勤的数据之前，我是这么想的。于是我开始寻找一个<a class="ae iu" href="https://github.com/pranavbadami/njtransit/" rel="noopener ugc nofollow" target="_blank"> Github repo </a>,里面有每趟NJ transit/美国国家铁路客运公司列车每一站的抓取数据，在抓取期间，每分钟更新一次，以便能够记录列车延误的时间。我想让我的研究变得相当具体，所以我很高兴看到在结合了<em class="jt">之后。csv </em>文件，我有<strong class="ix hj"> 3，429，002 </strong>行数据。我使用<em class="jt"> glob </em>模块合并了这些文件:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/21e6de8ac12989e19bccf8b8cb91859f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*POOv3scxZ8kWaMLme5eWOw.gif"/></div></div></figure><p id="1499" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我真的只关心我的特定轨道，我每天都乘坐NJTransit，所以我摆脱了<em class="jt">型</em>美国国家铁路客运公司和所有不在<em class="jt">线</em>东北走廊的东西，这条线从纽约宾州车站延伸到特伦顿。这将我的数据帧缩小到了528，034行。我顺着这条线索把范围缩小到实际上在纽约(我上下班的地方)或普林斯顿枢纽(我回家的地方)结束的列车。<strong class="ix hj">64316</strong>数据点剩余。</p><p id="f377" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，为了让我的算法更好地工作，我决定只查看每天多次经过这些站点的特定列车，以使<em class="jt"> train_id </em>成为没有太多选项的分类变量，从而挑选出13条特定线路。怀着类似的目标，我抓取了日期列并将其分为两类，夏天和冬天。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/170b6bcc9729bf6aa76fb54e6733db12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*4mMrf6qSpMtxXgv32XTOYg.png"/></div></figure><p id="c99d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">咻，在所有的清理之后，我们还有7595行剩余。现在试着建立一个模型，用我们现有的变量来预测火车晚点。</p><p id="7cd0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用库<em class="jt"> sklearn </em>，<em class="jt"> </em>在将数据分成训练组和测试组之后，对数据运行决策树回归产生了不太理想的结果。配合graphviz，我们甚至可以窥视我们的树！</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/a0c295455c0bb5c665aa2e3a9a4fe721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U49ilLqOvHzW5FKRTRQjqg.png"/></div></div></figure><p id="bd3d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我尝试了一点超参数调整，看看我是否可以提高r平方，减少均方误差。唯一有用的参数是最大深度。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/272d94898141bb82f729107754486f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ykkIzEscx6fjA2G2ZHOkZg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">最佳max_depth似乎是6</figcaption></figure><p id="c99b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用随机森林回归器，我们只能分别获得<strong class="ix hj"> 2.6% </strong>和<strong class="ix hj"> 1.9% </strong>的训练和测试分数，以及<strong class="ix hj"> 6.21 </strong>的<em class="jt">均方根误差</em>。没什么印象。</p><p id="1cff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">见鬼，既然我们在这里，为什么不做一个模型来尝试预测相同的目标变量，但这次是每条线上的每辆火车。在执行了和上面一样的超参数调整后，我得到了一个30的最佳最大树深。这次我的随机森林设法分别得到了<strong class="ix hj"> 16.7% </strong>和<strong class="ix hj"> 15.6% </strong>的训练和测试分数，以及一个<em class="jt">5.71的均方根误差</em>。好一点了，但显然还有很大的改进空间！</p><p id="32e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我不断遇到的最大障碍是，在我最初为自己设定的时间内，很难找到足够的数据来回答我最初打算回答的特定问题。模型中只使用了两个特性，这在模型评估指标中得到了体现，但我能做的有限。我从每个项目中学到了更多，这不是关于能够找到与你的确切问题相匹配的确切数据，而是关于你可以用你能找到的数据回答什么问题。为了改进这个模型，我想通过更多的搜索，包括日期<em class="jt">天气</em>将极大地提高模型的有用性，并且添加另一个或两个变量将允许决策树的更多变化，具有更多的超参数调整选项，例如特征重要性。</p></div></div>    
</body>
</html>