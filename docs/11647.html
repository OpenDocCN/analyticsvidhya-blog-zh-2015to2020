<html>
<head>
<title>Ensemble Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">集成学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ensemble-learning-b4ae1d3be46b?source=collection_archive---------15-----------------------#2020-12-12">https://medium.com/analytics-vidhya/ensemble-learning-b4ae1d3be46b?source=collection_archive---------15-----------------------#2020-12-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="03cb" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">让我们让弱学习者成为强学习者</strong></h1><p id="183b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">先说一个小故事，你小时候一定听过。</p><p id="2b55" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">从前，一位老人和他的三个儿子住在一个村子里。他们总是吵架。</p><p id="2e1f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">几个月过去了，老人生病了。他告诉他的儿子们要保持团结，但他们不听他的。所以，他决定给他们上一堂实用的课，让他们永远不会忘记他们的差异，保持团结。</p><p id="3c11" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">老人把他的儿子们叫来。他告诉他们:“我会给你们一捆棍子。分开每一根棍子，你将不得不把每一根棍子掰成两截。谁折断树枝快，谁就会得到更多的奖励。</p><p id="81c9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">儿子们同意了。老人给了他们每人一捆10根的棍子，并让他们把每根棍子掰成碎片。他们在几分钟内就把棍子打成了碎片，他们又开始争吵谁先来。</p><p id="073d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">老人说:“亲爱的儿子们，游戏还没有结束。现在我会给你们每人另一捆棍子。你必须把棍子打成一捆，而不是一根根分开。”</p><p id="20c2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">儿子们同意了，并试着折断那捆棍子。尽管他们尽了最大的努力，他们还是没能弄断这个包裹。即使他们团结一致，也没能完成任务。</p><p id="7ba1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这就是组合的力量。同样的，如果你结合多种算法，它会比单个算法更好。即使在安全领域中，在不同的层上有不同的供应商也是优选的，这样即使一个供应商中存在漏洞，也不会影响到其他层，并且会导致网络的更强防御。</p><p id="a77f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">不同算法(或一组算法)或预测器的聚合结果通常比最佳单个预测器得到更好的预测，就像新闻频道做的投票后调查一样，他们询问不同地理位置的不同人对即将到来的结果的看法。他们询问不同的人意味着不同职业、不同性别、不同教育水平、不同年龄组等的人，因此组合或汇总的结果称为群体智慧，具有更好的准确性。一组预测器称为集合；因此，这种技术被称为集成学习，集成学习算法被称为集成方法。它对回归和分类都有效。集成的结果优于最好的单个预测器。</p><p id="4db9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">让我们再举一个例子，你可以训练一组决策树分类器，每个分类器在训练集的一个不同的随机子集上。要进行预测，您只需获得所有单个树的预测，然后预测获得最多投票的类。这样的决策树集合被称为<strong class="jf hj">随机森林，</strong>，尽管它很简单，但这是当今最强大的机器学习算法之一。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/7013b9467a88850f311d7900f33c8710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u8v67VQ81VCLq_FHFP8Szw.jpeg"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated"><strong class="bd ih">合奏学习</strong></figcaption></figure><h1 id="23de" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">投票集成学习</h1><p id="ff4b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">假设你已经训练了几个分类器，每个都达到了X%的准确率。你可能有一个逻辑回归分类器，一个SVM分类器，一个K-最近邻分类器(正如我们所读到的不同的算法，如逻辑回归，SVM，线性回归，决策树，K-最近邻等。这些被称为弱学习者)。因此，如果我们结合这些算法的努力，它将成为强大的学习者。系综会达到(X+Y)%。但这取决于分类器之间的差异。这种多数投票分类器被称为硬投票分类器。有点令人惊讶的是，这种投票分类器通常比集成中的最佳分类器获得更高的准确度。</p><p id="4a7c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">如果我们在分类器或回归器(预测器)之间具有多样性，投票集成学习将给出更高的准确性。当预测因子尽可能相互独立时，集合方法效果最好。获得不同分类器的一种方法是使用非常不同的算法来训练它们。这增加了他们犯不同类型错误的机会，提高了整体的准确性。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kw"><img src="../Images/c3e325180dadc03028d4ba69934549fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*wkUPQmihY-JAxYFC6zPffA.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">投票集成学习</figcaption></figure><p id="791e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">如果所有分类器都能够估计类概率(即，它们有一个predict_proba()方法)，那么您可以告诉Scikit-Learn预测具有最高类概率的类，在所有单个分类器上平均。这叫做<strong class="jf hj">软投票</strong>。它通常比硬投票获得更高的性能，因为它给予高度自信的投票更多的权重。你所需要做的就是用voting="soft "替换voting="hard "并确保所有的分类器都能估计类概率。</p><p id="f187" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">让我们运行代码并理解投票。我用的是Jupyter作为IDE和Python 3.7.0版本。我将使用投票分类，投票回归也将以同样的方式工作(代码链接在回归的最后给出)。我使用的是乳腺癌数据集，它有569个观察或实例，有30个不同的特征。数据被标记为数据，对于本教程，我不使用任何数据转换或数据清理或数据预处理。数据直接用于训练和测试分类器的准确性。</p><ol class=""><li id="b978" class="kx ky hi jf b jg kb jk kc jo kz js la jw lb ka lc ld le lf bi translated">让我们导入分类器，accuracy_score用于检查准确性，datasets用于导入乳腺癌数据集，imported train_test_split用于将数据拆分为训练和测试数据集。导入警告以及忽略所有警告警报。</li></ol><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kw"><img src="../Images/2aab200d338925fc222f4e4dd7b58d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*t5agxqkrBSS1h0VayicyGQ.png"/></div></figure><p id="d241" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">2.让我们调用分类器并检查准确性。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kw"><img src="../Images/ac50480dbb5d421603dd1df84805846c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Ysy-vBLKtLRqh1qxErHClg.png"/></div></figure><p id="fef7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">3.正如你所看到的，我们得到的最高准确率约为95.80%。让我们调用投票分类器，再次检查所有分类器的准确性。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kw"><img src="../Images/0a4b270f13c2a4ee80c035acab55b4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*6tovP7Cc8FlJxtnKI6qyZg.png"/></div></figure><p id="e1bc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">4.正如你所看到的，我们已经达到了96.50%的准确率，这高于个人最好的分类器。以上是硬投票的例子。我们把投票方式改为“软投票”。正如你所看到的，我们得到了一个错误，因为所有的分类器都没有predict_prob()作为默认值，我们需要启用它，然后我们将在投票方法中尝试软投票方法。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kw"><img src="../Images/e134c68a38e77bec400bbb25a3151c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*IVSddCObtXfsqknv9T-ePQ.png"/></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kw"><img src="../Images/c76c166687e8d88df2080ac222aedf46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*uBfD3vdJvsYSALDKXdvXRg.png"/></div></figure><p id="19d2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">5.如你所见，软投票分类器的结果是97.20%，这优于个人最佳以及硬投票分类器。</p></div></div>    
</body>
</html>