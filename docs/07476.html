<html>
<head>
<title>Data Manipulation using Tidyr : Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Tidyr进行数据操作:第2部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-manipulation-using-tidyr-part-2-84458c3ef90b?source=collection_archive---------26-----------------------#2020-06-26">https://medium.com/analytics-vidhya/data-manipulation-using-tidyr-part-2-84458c3ef90b?source=collection_archive---------26-----------------------#2020-06-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dcb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，你将学习如何使用<strong class="ih hj"> tidyr </strong> R包执行<strong class="ih hj">数据操作</strong>。<strong class="ih hj"> <em class="jd"> tidyr包</em> </strong>是为特定的任务而设计的，以其<strong class="ih hj">杂乱的</strong>格式获取我们的数据，并将其转换成<strong class="ih hj">整齐的</strong>结构，有利于数据分析。我们将讨论以下功能:</p><ul class=""><li id="3d97" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> <em class="jd">分开</em> </strong></li><li id="d095" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> <em class="jd">联合起来</em> </strong></li><li id="6651" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> <em class="jd">枢_更广</em> </strong></li><li id="bfd4" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> <em class="jd">枢轴_变长</em> </strong></li></ul><h1 id="49ce" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">什么是整齐数据？</strong></h1><p id="a98b" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">有许多方法可以表示数据集中相同的底层数据。作为一名数据分析师，能够以一种对数据分析有效的方式组织数据是很重要的。如果数据集不是用于分析的最佳格式，我们必须重塑或“整理”它。</p><p id="7452" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有三条规则可以使数据集变得整洁:</p><ol class=""><li id="6fd5" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc kv jk jl jm bi translated">每个变量形成一列</li><li id="dd44" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc kv jk jl jm bi translated">每个观察值形成一行</li><li id="05e4" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc kv jk jl jm bi translated">每个值必须有自己的单元格</li></ol><h1 id="f66d" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">所需的R包</h1><p id="504b" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">首先，您需要安装tidyr包并加载tidyr库，然后才能执行以下数据操作功能。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="344c" class="lf jt hi lb b fi lg lh l li lj">install.packages('tidyr')<br/><strong class="lb hj">library</strong>(tidyr)</span></pre><h1 id="0c5e" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">演示数据集</h1><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="f6c3" class="lf jt hi lb b fi lg lh l li lj">df1 &lt;- data.frame(Firstname = c('John', 'Jeff', 'Ronald', 'Jennifer', 'Jessica'),<br/>                   Lastname = c('Novak', 'Barr', 'Lum', 'Forbis', 'Connor'),<br/>                   Birthdate = c('15/05/1980', '08/05/1990', '24/07/1988', '19/11/2000', '31/12/1997'))<br/>print(df1)</span></pre><p id="352e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="kw kx ky kz fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lk"><img src="../Images/1561910f16775f3e3d799fb4c5193dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p8-4rD_H10VMPTogsQdz_A.png"/></div></div></figure><h1 id="907d" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">1.独立功能</h1><p id="1f8d" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">有时，一个列包含两个或多个变量。在演示数据集中，<strong class="ih hj"> <em class="jd">生日</em> </strong>列包含变量<strong class="ih hj"> <em class="jd">日期</em> </strong>，<strong class="ih hj"> <em class="jd">月份</em> </strong>，<strong class="ih hj"> <em class="jd">年份</em> </strong>。如果我们需要将这三个变量作为一个单独的变量，那么我们可以使用<strong class="ih hj"> separate() </strong>函数。该函数通过在出现分隔符的地方进行拆分，将一列拆分成多列。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="b9e7" class="lf jt hi lb b fi lg lh l li lj">sept &lt;- separate(data = df1,<br/>                   col  = Birthdate,  <br/>                   into = c('Date', 'Month', 'Year'),<br/>                   sep = '/') <br/>print(sept)</span></pre><p id="837c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="kw kx ky kz fd ll er es paragraph-image"><div class="er es ls"><img src="../Images/1a180d50195908f46f121964f04ca387.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*iSI8jLXCz02JXulW5NfJoA.png"/></div></figure><h1 id="5d56" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">2.统一功能</h1><p id="d89d" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><strong class="ih hj"> unite() </strong>函数将多列合并成一列。它是<strong class="ih hj"> separate() </strong>函数的逆函数。在演示数据集中，如果我们想要在名称列中组合变量“名字”和“姓氏”，那么我们可以使用<strong class="ih hj"> unite() </strong>函数。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="5042" class="lf jt hi lb b fi lg lh l li lj">unt &lt;- unite(data = df1, <br/>                col  = Name,<br/>                Firstname, <br/>                Lastname, <br/>                sep  = ' ') <br/>print(unt)</span></pre><p id="e938" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="kw kx ky kz fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/b3371ddc1fbe3ac1bef6cc17353496ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*bTI9JGi9-VHIhr-uK3Z2Ew.png"/></div></figure><h1 id="6379" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">3.Pivot_wider函数</h1><p id="3cc9" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">当观察值分散在几行时，使用<strong class="ih hj"> pivot_wider() </strong>函数。在下面右侧的数据集表中，给出了每个“周”和“任务”的观察结果。如果我们希望'赋值'显示为列标题，那么我们可以使用<strong class="ih hj"> <em class="jd"> tidyr包</em> </strong>中的<strong class="ih hj"> pivot_wider() </strong>函数来转换这些数据。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="2f7a" class="lf jt hi lb b fi lg lh l li lj">df2 &lt;- data.frame(Week = c('Week1', 'Week1', 'Week2', 'Week2', 'Week3', 'Week3', 'Week4', 'Week4'),<br/>                  Assignment = c('Assignment1', 'Assignment2', 'Assignment1', 'Assignment2', 'Assignment1', 'Assignment2', 'Assignment1', 'Assignment2'),<br/>                  Completed = c(3, 5, 4, 3, 5, 4, 3, 5))<br/>print(df2)</span><span id="a5c9" class="lf jt hi lb b fi lu lh l li lj">pivot_wider(data = df2, <br/>            id_cols = Week,<br/>            names_from = Assignment, <br/>            values_from = Completed)</span></pre><p id="d0a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="kw kx ky kz fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/5b66ec65bb30dc775338cb576f4df3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UcCamgsRCneCkIoqhySWQ.png"/></div></div></figure><figure class="kw kx ky kz fd ll er es paragraph-image"><div class="er es lw"><img src="../Images/ee16374b2c3144a5f48522e52ce45274.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*SPUUF8yXWTckdoNK3zUSQw.png"/></div></figure><h1 id="b037" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">4.Pivot_longer函数</h1><p id="f74d" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">当我们的数据是宽格式时，有时我们需要将列旋转到一起，以创建一个包含许多行的单列。看下面的数据，我们可以看到主题跨越了多个变量，这通常不是我们想要的表。为了获得正确格式的数据，我们需要将这些列转换成一对新的变量。我们可以使用<strong class="ih hj"> pivot_longer() </strong>函数来做到这一点。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="97de" class="lf jt hi lb b fi lg lh l li lj">df3 &lt;- data.frame(Student = c('John', 'Jeff', 'Ronald', 'Jennifer', 'Jessica'),<br/>                  Maths = c(79, 64, 86, 92, 50),<br/>                  Physics = c(62, 45, 94, 83, 65),<br/>                  Chemistry = c(99, 61, 87, 91, 80))<br/>print(df3)</span><span id="1a6b" class="lf jt hi lb b fi lu lh l li lj">pivot_longer(data =  df3, <br/>             cols = -Student, <br/>             names_to = "Subject", <br/>             values_to = "Marks")</span></pre><p id="d33f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="kw kx ky kz fd ll er es paragraph-image"><div class="er es lx"><img src="../Images/598789c94299ff62b5334f42cdfddffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*mixPvC73q2YJQx_D7Nwm-g.png"/></div></figure><figure class="kw kx ky kz fd ll er es paragraph-image"><div class="er es ly"><img src="../Images/a66ca363e1e4210cb63c0a3060b13200.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*OOiQAnt4a1Q8G3bgCXGrIA.png"/></div></figure><p id="6988" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注:如需更多信息和旋转帮助，请访问<a class="ae lz" href="https://tidyr.tidyverse.org/articles/pivot.html" rel="noopener ugc nofollow" target="_blank">此链接</a>。</p><p id="8a8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本系列的前一部分<a class="ae lz" rel="noopener" href="/analytics-vidhya/data-manipulation-using-dplyr-part-1-fc0706c3c51f">第1部分</a>介绍了使用dplyr包的数据操作。</p><p id="3dd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这个博客或者觉得它很有帮助，请留下你的掌声！</p><p id="78a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢你</p></div></div>    
</body>
</html>