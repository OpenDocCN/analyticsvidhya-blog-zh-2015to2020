<html>
<head>
<title>How to Scrape HTTPS sites in python (BeautifulSoup).</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用python (BeautifulSoup)抓取HTTPS网站？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-scrape-https-sites-in-python-beautifulsoup-a08374af960d?source=collection_archive---------3-----------------------#2020-06-03">https://medium.com/analytics-vidhya/how-to-scrape-https-sites-in-python-beautifulsoup-a08374af960d?source=collection_archive---------3-----------------------#2020-06-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7af2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能听说过网络抓取及其各种应用，但以防万一，你想在这里介绍一下。<strong class="ih hj">在本文中，我们还将关注如何抓取https站点，并以https://www.accuweather.com</strong><a class="ae jd" href="https://www.accuweather.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a><strong class="ih hj">的web抓取为例。</strong></p><h1 id="7165" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">什么是网络抓取？</h1><p id="2f64" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">抓取只是一个提取数据的过程。当我们从网上(如网页或网站)抓取或提取数据或信息时，我们称之为网络抓取。</p><p id="f946" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，web抓取也称为web数据抽取或web收获，是从web中抽取数据。简而言之，web抓取为开发者提供了一种从互联网上收集和分析数据的方法。</p><h1 id="c415" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">为什么要抓取网页？</h1><p id="0830" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">网络抓取提供了一个很好的工具来自动完成人们在浏览时所做的大部分事情。网络搜集在企业中有多种用途</p><ul class=""><li id="460e" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated"><strong class="ih hj">金融:</strong>从bse股票交易所和许多不同的站点获取股票收盘和开盘价。</li><li id="3b3d" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><strong class="ih hj">价格比较:</strong>网络搜集用于从在线购物网站收集数据，并使用它来比较产品的价格。</li><li id="911b" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><strong class="ih hj">电子邮件地址收集:</strong>许多使用电子邮件作为营销媒介的公司使用网络搜集来收集电子邮件ID，然后发送批量电子邮件。</li><li id="9d99" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><strong class="ih hj">社交媒体抓取:</strong>网络抓取用于从Twitter等社交媒体网站收集数据，以了解流行趋势。</li><li id="e0db" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><strong class="ih hj">研发:</strong>网页抓取用于收集大量数据(统计、一般信息、温度等。)从网站上下载，分析后用于调查或研发。</li><li id="1c1a" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><strong class="ih hj">职位列表:</strong>从不同的网站收集有关职位空缺、面试的详细信息，然后在一个地方列出，以便用户可以轻松访问。</li></ul><h1 id="46f9" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">网络抓取合法吗？</h1><p id="8b8a" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">谈论网页抓取是否合法，有些网站允许网页抓取，有些不允许。想知道一个网站是否允许网页抓取，可以看看网站的“robots.txt”文件。您可以通过将“/robots.txt”附加到您想要抓取的URL来找到该文件。</p><h1 id="fa21" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">为什么使用Python进行网络抓取？</h1><p id="05ca" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">Python是最流行的网络抓取语言之一，因为它可以非常容易地处理大多数与网络抓取相关的任务。</p><ol class=""><li id="6bbd" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc kv kn ko kp bi translated">易于使用(没有任何花括号“{ }”或分号“；”任何地方)</li><li id="9c8d" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">巨大的图书馆支持</li><li id="355f" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">巨大的社区</li><li id="1a5a" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">动态类型语言(分配给变量的数据表明变量的类型)</li></ol><h1 id="eb81" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">网页抓取是如何工作的？</h1><p id="55a2" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当您运行web抓取代码时，会向您提到的URL发送一个请求。作为对请求的响应，服务器发送数据并允许您读取HTML或XML页面。然后，代码解析HTML或XML页面，找到数据并提取出来。</p><p id="0e2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要通过python使用web抓取来提取数据，您需要遵循以下基本步骤:</p><ol class=""><li id="3491" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc kv kn ko kp bi translated">找到您想要抓取的URL</li><li id="3200" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">检查页面</li><li id="9419" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">查找要提取的数据</li><li id="5840" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">写代码</li><li id="cbbd" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">运行代码并提取数据</li><li id="e4c1" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">以要求的格式存储数据</li></ol><p id="b504" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在理论已经足够了，让我们跳到抓取https站点的主题<a class="ae jd" href="https://www.accuweather.com/" rel="noopener ugc nofollow" target="_blank">https://www.accuweather.com</a>。我们希望获得天气信息，accuweather为我们提供了<a class="ae jd" href="https://developer.accuweather.com/" rel="noopener ugc nofollow" target="_blank"> API </a>，但出于学习目的，我们将使用BS4(美丽的汤)。</p><p id="aa5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kw">最终结果</em> </strong>:我们将以这种格式提取数据</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es kx"><img src="../Images/789fc4962dbe818ca386dd162e5351e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LPLOsCk6vfn9zcnyLqUBgw.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">输出数据格式(output.csv)</figcaption></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es ln"><img src="../Images/f8ff6b7ccdc3065ae262aed27ecaba48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZX5stDNDKtkNW8kfs_Vung.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">截图来自<a class="ae jd" href="https://www.accuweather.com/en/in/surat/202441/daily-weather-forecast/202441" rel="noopener ugc nofollow" target="_blank">https://www . accuweather . com/en/in/Surat/202441/daily-weather-forecast/202441</a></figcaption></figure><p id="215d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于网页抓取，让我们首先前往<a class="ae jd" href="https://www.accuweather.com/en/in/surat/202441/daily-weather-forecast/202441" rel="noopener ugc nofollow" target="_blank"> accuweather网站</a>，这里我在苏拉特，所以我有苏拉特的天气信息，你也可以前往你所在的地方并获得数据。这是网站的截图，你可以看到<em class="kw">类</em> <strong class="ih hj"> "page-column-1" </strong>，我们的父类和<strong class="ih hj">'内容模块非广告'，</strong>以&lt; a &gt;标签的形式拥有我们的数据。我们在里面有三个类“日期”，“临时”和“信息”。</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es kx"><img src="../Images/716088b5da63f4157e578924ab55e2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fiSLT5Ygtqx-q5VHr7bgWA.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">详细查看“内容模块非广告”类</figcaption></figure><p id="a0b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj">【日期】</strong>类中我们的<strong class="ih hj">日</strong>细节在于<strong class="ih hj">【道氏】类中，日期</strong>细节在于<strong class="ih hj">【子】类中。</strong></p><p id="2af1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj">【temps】</strong>类中，我们的<strong class="ih hj">高</strong>和<strong class="ih hj">低</strong>温度明细分别在<strong class="ih hj">【高】</strong>和<strong class="ih hj">【低】</strong>类中。我们在<strong class="ih hj">“短语”</strong>类中也有短语细节。</p><h1 id="0764" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">代码</strong></h1><p id="2203" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">你应该已经安装了<a class="ae jd" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup库</a>或者你可以</p><pre class="ky kz la lb fd lo lp lq lr aw ls bi"><span id="82e9" class="lt jf hi lp b fi lu lv l lw lx"><strong class="lp hj">pip install beautifulsoup4</strong></span></pre><p id="c29b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在您的命令提示符下。</p><pre class="ky kz la lb fd lo lp lq lr aw ls bi"><span id="cffe" class="lt jf hi lp b fi lu lv l lw lx">## Importing required libraries</span><span id="38ab" class="lt jf hi lp b fi ly lv l lw lx">from bs4 import BeautifulSoup<br/>import requests<br/>import pandas as pd<br/>import csv</span></pre><p id="9af9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">永远记住在抓取https站点时要包含头文件，因为如果没有头文件，就会出现<strong class="ih hj">访问被拒绝</strong>的错误。所有的标题都是一样的，所以不用担心。大多数https网站不允许网络抓取，但问题是，尽管它是https网站，你是如何查看该网站的？这是因为我们的Web浏览器使用<strong class="ih hj">头</strong>让服务器知道请求是通过Web浏览器发出的，所以我们将头传递给服务器。</p><pre class="ky kz la lb fd lo lp lq lr aw ls bi"><span id="0833" class="lt jf hi lp b fi lu lv l lw lx">url=’<a class="ae jd" href="https://www.accuweather.com/en/in/surat/202441/daily-weather-forecast/202441'" rel="noopener ugc nofollow" target="_blank">https://www.accuweather.com/en/in/surat/202441/daily-weather-forecast/202441'</a></span><span id="ddaa" class="lt jf hi lp b fi ly lv l lw lx">headers = {‘User-Agent’: ‘Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36’}</span></pre><p id="a752" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里<a class="ae jd" href="https://pypi.org/project/html5lib/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">‘html 5 lib’</strong></a>是一个解析html的纯python库。</p><pre class="ky kz la lb fd lo lp lq lr aw ls bi"><span id="1b1a" class="lt jf hi lp b fi lu lv l lw lx">r=requests.get(url, headers=headers)<br/>soup1 = BeautifulSoup(r.content, ‘html5lib’)</span></pre><p id="5181" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们就用<a class="ae jd" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#find-all" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">。findAll() </strong> </a>，<a class="ae jd" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#find" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">。bs4的</strong> </a> <strong class="ih hj"> </strong>查找()<a class="ae jd" href="https://pythonprogramming.net/introduction-scraping-parsing-beautiful-soup-tutorial/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">找出数据元素的函数。</strong>get _ text()</a>获取元素的文本。此外，如果你有多个类要提取，然后在列表中传递它们，如<strong class="ih hj"> ['内容模块非广告'，'内容模块非广告底部预测']。</strong></p><p id="5e4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是它的全部代码。</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="7d35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是如何转换为。csv文件，可以根据您的应用程序使用</p><pre class="ky kz la lb fd lo lp lq lr aw ls bi"><span id="8291" class="lt jf hi lp b fi lu lv l lw lx">df.to_csv(‘./output.csv’, encoding=’utf-8', index=False)</span></pre></div><div class="ab cl mb mc gp md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hb hc hd he hf"><h1 id="d556" class="je jf hi bd jg jh mi jj jk jl mj jn jo jp mk jr js jt ml jv jw jx mm jz ka kb bi translated">非常感谢你的阅读，如果你喜欢这个故事，请为它鼓掌。</h1><p id="ec6e" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">给我接通<strong class="ih hj">linkedIn</strong>:<a class="ae jd" href="https://www.linkedin.com/in/kalp-panwala-72284018a/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/kalp-panwala-72284018a</a></p><p id="35fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在推特上关注我:https://twitter.com/PanwalaKalp</p><p id="b0aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关注我的<strong class="ih hj">github:</strong>T38】https://github.com/kpanwala</p><p id="2c4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你对这个故事有任何疑问或者任何改进的空间，那么给我发邮件到<strong class="ih hj">kpanwala33@gmail.com</strong>。</p></div></div>    
</body>
</html>