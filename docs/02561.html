<html>
<head>
<title>How to implement Face Recognition using VGG Face in Python 3.7 and Tensorflow 2.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python 3.7和Tensorflow 2.0中使用VGG人脸实现人脸识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-implement-face-recognition-using-vgg-face-in-python-3-8-and-tensorflow-2-0-a0593f8c95c3?source=collection_archive---------5-----------------------#2019-12-23">https://medium.com/analytics-vidhya/how-to-implement-face-recognition-using-vgg-face-in-python-3-8-and-tensorflow-2-0-a0593f8c95c3?source=collection_archive---------5-----------------------#2019-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="6ae3" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated"><strong class="ak">简介</strong></h1><p id="56ac" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated"><strong class="jm hj">面部识别系统</strong>是一种能够从视频源或图像源的数字图像或视频帧中识别或验证一个人的技术。面部识别系统有多种工作方法，但一般来说，它们通过将从给定图像中选择的面部特征与数据集中的面部进行比较来工作。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="kj kk kl km fd kn er es paragraph-image"><div class="er es ki"><img src="../Images/f6cbea4ebc1e7d3831f0ce39ad20e6a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*IA1Xq5wCD2-7Qn3YABcFmg.gif"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">人脸识别</figcaption></figure><p id="23d4" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">你可以使用这个<a class="ae kz" href="https://github.com/iamatulsingh/face-detection.git" rel="noopener ugc nofollow" target="_blank">链接</a>从我的Github下载完整的源代码。</p><h1 id="289f" class="im in hi bd io ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj bi translated">先决条件</h1><p id="5919" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">这篇文章假设读者熟悉Python、Opencv、Numpy、Tensorflow和Keras等基本概念。</p><h1 id="4378" class="im in hi bd io ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj bi translated">为什么我们需要面部识别？</h1><p id="1b23" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">由于面部是识别人的唯一方式，面部识别因提供安全可靠的安全性而受到关注并在世界范围内迅速发展。</p><p id="b187" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">从创建考勤系统作为基本需求，到使用人脸识别作为机场、刑事侦查、人脸跟踪、法医、公共场所等的安全措施。当然，仅仅通过监控摄像头，我们无法利用罪犯的指纹找到他。</p><figure class="kj kk kl km fd kn er es paragraph-image"><div class="er es ki"><img src="../Images/e12b3a0809d5f549ca247b879b972da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*h3xxSDUb0ewe5pMLuOnV_g.gif"/></div></figure><p id="2ef9" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">因此，让我们开始，看看我们如何建立一个模型，可以帮助我们使用预先训练的VGG人脸2识别模型来识别人。</p><p id="3f07" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">作者在这里提供了完整的源代码<a class="ae kz" href="https://github.com/ox-vgg/vgg_face2" rel="noopener ugc nofollow" target="_blank">和预训练的模型，可以通过标准的深度学习框架下载，如Caffe和PyTorch，尽管没有TensorFlow或Keras的例子。</a></p><p id="7616" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">我们可以将提供的模型转换为TensorFlow或Keras格式，并开发一个模型定义，以便加载和使用这些预训练的模型。令人欣慰的是，这项工作已经完成，可以被第三方项目和库直接使用。我们将使用keras-vggface和MTCNN来帮助我们创建VGGFace2的keras模型</p><p id="610c" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">这些库可以通过pip安装；例如:</p><pre class="kj kk kl km fd lf lg lh li aw lj bi"><span id="3f82" class="lk in hi lg b fi ll lm l ln lo"><strong class="lg hj"><em class="lp">sudo pip install git+https://github.com/rcmalli/keras-vggface.git</em></strong></span><span id="fd57" class="lk in hi lg b fi lq lm l ln lo"><strong class="lg hj"><em class="lp">sudo pip install mtcnn</em></strong></span></pre><p id="b29b" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated"><strong class="jm hj">创建KERAS模型</strong></p><p id="45b6" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">我们将创建一个<strong class="jm hj"> model.py </strong>文件，并将下面的代码添加到其中。</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">model.py</figcaption></figure><p id="17a2" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">现在，我们将创建一个"<strong class="jm hj"> crop_face </strong>"函数，该函数将裁剪面并将其发送给模型以进行下一个过程。假设输入照片包含一张人脸，我们的人脸裁剪方法将返回检测到的第一张人脸。</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">裁剪面</figcaption></figure><p id="e5f5" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">在“<strong class="jm hj"> crop_face </strong>”函数中，我们将使用MTCNN检测人脸，然后在第6行使用Numpy图像切片来裁剪人脸。现在让我们看看我们的模型将如何表现。因此，让我们创建“main.py ”,并将下面的代码复制到其中。</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">main.py</figcaption></figure><p id="2357" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">让我们测试一下这个模型，看看它是否能运行良好。</p><figure class="kj kk kl km fd kn er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/0c44d1d468239ae571eb23d263809853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lMdFoJ84-Z5VPsUVkBEbuA.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">结果</figcaption></figure><p id="6177" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">还好它能找到“完美主义者先生”😃。</p><p id="9ecc" class="pw-post-body-paragraph jk jl hi jm b jn ku jp jq jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh hb bi translated">感谢您耐心看完。如需任何帮助或建议，请联系。</p></div></div>    
</body>
</html>