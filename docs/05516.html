<html>
<head>
<title>Make your Covid-19 Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建您的新冠肺炎数据集</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/make-your-covid-19-dataset-ab70eadc702?source=collection_archive---------24-----------------------#2020-04-23">https://medium.com/analytics-vidhya/make-your-covid-19-dataset-ab70eadc702?source=collection_archive---------24-----------------------#2020-04-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d5d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">全球正面临前所未有的冠状病毒威胁，我们需要随时了解这种病毒传播的最新情况。数据是一种重要的资源，如今检索数据很容易——我们只需谷歌一下，但参与提取数据的过程是一项可以培养洞察力和正确看待事物的活动。</p><p id="49a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm">虽然有许多网站包含数据集，我们随时可用，您可以通过网络搜集包含新冠肺炎相关信息的相关表格来制作您的数据集。这是我的第一篇文章，我们将一起尝试建立我们的数据集！</em></p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jn"><img src="../Images/204ab23679e51e2dc00af9a8b908141b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*MYucwD227toiUbIZlNqDuw.jpeg"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">src:谷歌图片</figcaption></figure><p id="5063" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是您需要的重要Python库(如果您想了解关于该库的更多信息，可以访问链接):</p><ol class=""><li id="3f71" class="kd ke hi ih b ii ij im in iq kf iu kg iy kh jc ki kj kk kl bi translated"><a class="ae km" href="https://pypi.org/project/pandas/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Pandas </strong> </a> -你将需要它来操作我们将在网络抓取后生成的数据帧(是的，我们将从一个可靠的网站获取我们的数据集)。</li><li id="d715" class="kd ke hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><a class="ae km" href="https://pypi.org/project/plotly/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Plotly </strong> </a> -一种更具交互性和综合性的数据可视化方法。</li><li id="c622" class="kd ke hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><a class="ae km" href="https://pypi.org/project/beautifulsoup4/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">beautiful soup</strong></a><strong class="ih hj">-</strong>用于从HTML和XML文件中提取数据的Python库。</li><li id="0170" class="kd ke hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><a class="ae km" href="https://pypi.org/project/urllib3/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">urllib</strong></a><strong class="ih hj">-</strong>一个集合了几个处理URL的模块的包。</li></ol><p id="a064" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm">但是等等，什么是网页抓取？</em></p><p id="ea18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">网页抓取是指抓取网页并从中提取数据。抓取是指下载页面(当您查看页面时，浏览器会这样做)。因此，网页抓取是网页抓取的主要组成部分，以获取网页供以后处理。一旦取出，就可以进行提取。可以对页面内容进行解析、搜索、重新格式化，将其数据复制到电子表格中，等等。</p><p id="4960" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多关于使用beautifulsoup <a class="ae km" href="https://towardsdatascience.com/introduction-to-web-scraping-with-beautifulsoup-e87a06c2b857" rel="noopener" target="_blank"> <em class="jm">这里</em> </a></p><p id="f7d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">推荐使用<a class="ae km" href="https://jupyter.org/install" rel="noopener ugc nofollow" target="_blank"> <em class="jm"> Jupyter笔记本</em> </a>编写代码，因为它有如此多的灵活性。</p><p id="49ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了自己的设置，让我们开始我们的旅程…</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ks"><img src="../Images/8dc00db6ea0bbd6c896b8d3771d8a780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rDsrO3NDZbfKWZAS"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated"><a class="ae km" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动发起人</a>在<a class="ae km" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><blockquote class="kt ku kv"><p id="e4bf" class="if ig jm ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><strong class="ih hj">第一步:进口必需品</strong></p></blockquote><p id="e214" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一如既往，我们的第一步将是导入重要的库。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es kz"><img src="../Images/9623cfe35ccf4f3234053fadb67148c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*hFJksk-uGKG7G8_L0SJDSw.png"/></div></figure><p id="404a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入必要的模块后，您应该指定包含数据集的URL，并将其传递给urlopen()以获取页面的HTML。</p><blockquote class="kt ku kv"><p id="24a8" class="if ig jm ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><strong class="ih hj">第二步:制作一个漂亮的汤品</strong></p></blockquote><p id="db99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是通过将html传递给BeautifulSoup()函数来完成的。漂亮的Soup包用于解析html，即获取原始html文本并将其分解成Python对象。第二个参数“html.parser”是html解析器，此时您不需要担心它的细节。</p><p id="b1f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">soup对象允许您提取关于您正在抓取的网站的有趣信息，例如获取页面的标题。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es la"><img src="../Images/e686859082dc2a132e9b2b9ed0fe3d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*mFpAXeLJxvx_11QFQ8nlDQ.png"/></div></div></figure><p id="f5d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用soup的<a class="ae km" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#calling-a-tag-is-like-calling-find-all" rel="noopener ugc nofollow" target="_blank"> find_all() </a>方法来提取网页中有用的html标签。有用标签的例子包括超链接的&lt; a &gt;，表格的&lt; table &gt;，表格行的&lt; tr &gt;，表格标题的&lt; th &gt;，表格单元格的&lt; td &gt;。例如，下面的代码显示了如何提取网页中的所有超链接。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lb"><img src="../Images/733ba499601c5d412bd0c4ebe5950c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*cgQ2oy6ogYMghGMhhqpoqQ.png"/></div></figure><blockquote class="kt ku kv"><p id="d277" class="if ig jm ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><strong class="ih hj">步骤3:从网站中提取表格行</strong></p></blockquote><p id="c36d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该表包含印度新冠肺炎病例的官方记录。你可以在谷歌上搜索包含有新冠肺炎病例相关信息的定期更新表格的网站。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lc"><img src="../Images/75bf7bc808cd7ca7cd3d6316ea1a0c4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*vtCd0e8w3ljjGsMrjcXNjQ.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">表格HTML标签</figcaption></figure><p id="6713" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用的表格包含了印度新冠肺炎各邦的情况。</p><p id="ae9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该首先以列表形式获取所有表格行，然后将该列表转换为数据框。下面是一个“for”循环，它遍历表格行并打印出行的单元格。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es ld"><img src="../Images/7d059a4dcb087f0095e439f0f58a651d.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*wDskt-Vn4M-CyYsYxXf4RA.png"/></div></figure><p id="a624" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的输出显示每一行都打印有嵌入其中的html标记。这不是我们想要的。你可以用漂亮的汤或者正则表达式来移除html标签。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es le"><img src="../Images/245839ef2706547338f7dfa3a3e71b9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*H3Y-SdEErAIp1AUkJQ44HA.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">使用美味的汤</figcaption></figure><p id="fd98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">移除html标签最简单的方法是使用Beautiful Soup，只需要一行代码就可以做到。将感兴趣的字符串传递给BeautifulSoup()并使用get_text()方法提取没有html标记的文本。</p><p id="31b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<a class="ae km" href="https://docs.python.org/3/library/re.html" rel="noopener ugc nofollow" target="_blank">正则表达式</a>是非常不鼓励的，因为它需要几行代码并且很容易出错。它需要导入' re '(用于<a class="ae km" href="https://docs.python.org/3/library/re.html" rel="noopener ugc nofollow" target="_blank">正则表达式</a>)模块。下面的代码显示了如何构建一个正则表达式来查找&lt; td &gt; html标记中的所有字符，并用一个空字符串替换每个表格行中的字符。</p><p id="cfd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，通过将一个字符串传递给re.compile()来编译正则表达式。点、星和问号(。*?)将匹配一个左尖括号，后面跟任何东西，后面跟一个右尖括号。它以非贪婪的方式匹配文本，也就是说，它匹配尽可能短的字符串。如果省略问号，它将匹配第一个左尖括号和最后一个右尖括号之间的所有文本。编译正则表达式后，可以使用re.sub()方法查找正则表达式匹配的所有子字符串，并用空字符串替换它们。下面的完整代码生成一个空列表，提取每一行的html标记之间的文本，并将其附加到分配的列表中。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lf"><img src="../Images/e239e9c9436b4b66206e653314e8be9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*HOhJ7LzjJAKcg1IF38xNYQ.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">使用正则表达式会使代码变得冗长</figcaption></figure><blockquote class="kt ku kv"><p id="3611" class="if ig jm ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><strong class="ih hj">第四步:将列表转换成数据帧</strong></p></blockquote><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lg"><img src="../Images/ba3976acc60f7d424d429ac1cac15ab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*9D1hS-lStmpdyTVfOd4fpg.png"/></div></figure><p id="9aaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据框不是我们想要的格式。要清理它，您应该在逗号位置将“0”列拆分成多个列。这是通过使用str.split()方法完成的。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lh"><img src="../Images/1cd46dbb715cc535694c4a7b29285b57.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*cjIc0REDQLQ8hdfszzmgSA.png"/></div></figure><p id="755a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这看起来好多了，但仍有工作要做。数据框的每一行都有多余的方括号。您可以使用<a class="ae km" href="https://www.tutorialspoint.com/python/string_strip.htm" rel="noopener ugc nofollow" target="_blank"> strip() </a>方法删除列“0”上的左方括号</p><p id="3eb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该表缺少表头。您可以使用find_all()方法来获取表格标题。与表格行类似，您可以使用Beautiful Soup来提取表格标题的html标记之间的文本。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es li"><img src="../Images/50e94538e842d7c970c6daebf1bed3e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*2V9FV_15594LJ2zZzQVOxA.png"/></div></figure><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lj"><img src="../Images/554f869a57b906267334ae54a0504e1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHNpfao28cudFS1-30vt9Q.png"/></div></div></figure><p id="0a3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，您可以将标题列表转换为pandas数据框。类似地，您可以在所有行的逗号位置将列“0”拆分为多个列。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lk"><img src="../Images/f32409835e5cbbc5df1fb37fb2c9c2d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*OLBYENdx0ix6Nx7Dg9vGNQ.png"/></div></div></figure><p id="ba4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以使用concat()方法将两个数据帧连接成一个数据帧</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ll"><img src="../Images/a19265c52b07485c1d9714f38221a1d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MfByVWgelDuRwNzpvslElQ.png"/></div></div></figure><p id="c782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面显示了如何将第一行指定为表格标题。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lm"><img src="../Images/13450d7ce160bdc23d41e7471f913ec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*kod9oXS01j2INdDt2SQBbw.png"/></div></figure><p id="b8ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，请注意表头是如何复制为数据框中的第一行的。可以使用<a class="ae km" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop.html" rel="noopener ugc nofollow" target="_blank"> drop() </a>命令将其删除。</p><p id="1e83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，您的数据集应该看起来不错。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ln"><img src="../Images/06e09094e6d7cae37175fdf383be57c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QHFTYuNRbxTxEcIVYviHUQ.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">最终表格示例</figcaption></figure><blockquote class="kt ku kv"><p id="4aff" class="if ig jm ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><strong class="ih hj">第五步:数据可视化</strong></p></blockquote><p id="8a62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是最后一步，因为我们有自己的数据，只需要在我们的机器上漂亮地展示出来。此时，您可以参考许多教程和文章来利用您提取的数据，并以您喜欢的方式呈现出来。我用Plotly表示简单的条形图和饼图。更多信息可在<a class="ae km" href="https://plotly.com/python/getting-started/?utm_source=mailchimp-jan-2015&amp;utm_medium=email&amp;utm_campaign=generalemail-jan2015&amp;utm_term=bubble-chart" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="55b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我对数据的最终表示如下:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lo"><img src="../Images/96bf1f210dff4a3caf43570427f47b66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwsZLmmvtlH9x1QfUbdkTg.png"/></div></div></figure><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lo"><img src="../Images/12aaf05155372be9708a9f4c9211abb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RSe5IFqzZhSfYLuf0ruxUw.png"/></div></div></figure><p id="2685" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm">就这样，我们的小实验结束了。我希望这篇文章有助于提高你的学习。</em></p><p id="f9a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm">呆在家里，保持安全！</em></p></div></div>    
</body>
</html>