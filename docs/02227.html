<html>
<head>
<title>House Price Drop in Key West, Florida</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">佛罗里达基韦斯特房价下跌</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/house-price-drop-in-key-west-florida-44b8f37d9c6a?source=collection_archive---------20-----------------------#2019-12-06">https://medium.com/analytics-vidhya/house-price-drop-in-key-west-florida-44b8f37d9c6a?source=collection_archive---------20-----------------------#2019-12-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="942b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">买度假屋？或者…也许不是</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/4f450c228edac4a8efa2b432d07e3436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dgeNExlYMvfRYpWv"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">泰莎·威尔森在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2fd7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">去年十月，我的一个好朋友给我看了一篇关于佛罗里达基韦斯特房地产价格下跌的文章。他真的很想从马萨诸塞州搬到基韦斯特，因为自从他几年前退休以来，寒冷的冬天一直困扰着他。</p><p id="94ba" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">作为一名水文学家，我首先想到的是，这个地区每年被洪水淹没的频率是多少？有多深？为了回答这些问题，我去了NOAA(美国国家海洋和大气管理局)网站，调出了一些极端的海水水位。2017年9月，记录的最高海平面为4.47英尺，2015年至2019年期间的平均最高海平面为2.73英尺。</p><p id="7f0a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于我住在马萨诸塞州的朋友来说，很难想象4.47英尺的海平面对于在基韦斯特买房子意味着什么。所以，我制作了一张地图，展示了几个海平面条件下的基韦斯特。</p><p id="92e4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为此，我从美国国家海洋和大气管理局收集了佛罗里达州基韦斯特的数字高程模型。为了加快我的编程过程，我使用我的GIS(地理信息系统)工具将DEM模型转换成经纬度格式。有了经度-纬度格式后，我编写了以下代码来创建地图。</p><p id="4b96" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">目标是显示正常海平面(0.0)、平均最高海平面2.73英尺和最高记录最高海平面4.47英尺下的基韦斯特地图。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="c7d4" class="kp kq hi kl b fi kr ks l kt ku">## Import libraries</span><span id="62c6" class="kp kq hi kl b fi kv ks l kt ku">import numpy as np<br/>import pandas as pd<br/>import folium<br/>import branca<br/>from folium import plugins<br/>import matplotlib.pyplot as plt<br/>from scipy.interpolate import griddata<br/>import geojsoncontour<br/>import scipy as sp<br/>import scipy.ndimage</span><span id="7fdd" class="kp kq hi kl b fi kv ks l kt ku">%matplotlib inline</span><span id="1735" class="kp kq hi kl b fi kv ks l kt ku"><strong class="kl hj"><em class="kw"># Read the digital elevation  model in longitude, latitude and elevation format <br/></em></strong>data = pd.read_csv('./DEM/Key_West_DEM_LL.xyz', header = None, names = ['longitude','latitude','elevation']) <br/>DEM = data.copy()<br/># Set all negative elevations to zero to show that they will be under the mean sea level of zero<br/>for i in range(0,len(DEM)):<br/>    if DEM['elevation'][i] &lt;= 0.:<br/>        DEM['elevation'][i] = 0.<br/><strong class="kl hj"><em class="kw"># Setup minimum and maximum values for the contour lines (my DEM came in meter)<br/></em></strong>vmin = DEM['elevation'].min() * 3.280833 <br/>vmax = DEM['elevation'].max() * 3.280833</span><span id="ae00" class="kp kq hi kl b fi kv ks l kt ku"><strong class="kl hj"><em class="kw"># Setup colormap<br/></em></strong>colors = ['blue','royalblue', 'navy','pink',  'mediumpurple',  'darkorchid',  'plum',  'm', 'mediumvioletred', 'palevioletred', 'crimson',<br/>         'magenta','pink','red','yellow','orange', 'brown','green', 'darkgreen']<br/>levels = len(colors)<br/>cm     = branca.colormap.LinearColormap(colors, vmin=vmin, vmax=vmax).to_step(levels)</span><span id="c74d" class="kp kq hi kl b fi kv ks l kt ku"><strong class="kl hj"><em class="kw"># Convertion dataframe to array<br/></em></strong>x_orig = np.asarray(DEM.longitude.tolist())<br/>y_orig = np.asarray(DEM.latitude.tolist())</span><span id="43dd" class="kp kq hi kl b fi kv ks l kt ku"><strong class="kl hj"><em class="kw"># convert elevation from  m to ft<br/></em></strong>z_orig = np.asarray(DEM.elevation.tolist()) * 3.280833</span><span id="20ef" class="kp kq hi kl b fi kv ks l kt ku"><strong class="kl hj"><em class="kw"># Make grids<br/></em></strong>x_arr          = np.linspace(np.min(x_orig), np.max(x_orig), 500)<br/>y_arr          = np.linspace(np.min(y_orig), np.max(y_orig), 500)<br/>x_mesh, y_mesh = np.meshgrid(x_arr, y_arr)<br/> <br/><strong class="kl hj"><em class="kw"># Grid the elevation values<br/></em></strong>z_mesh = griddata((x_orig, y_orig), z_orig, (x_mesh, y_mesh), method='linear')<br/> <br/><strong class="kl hj"><em class="kw"># Use Gaussian filter to smoothen the contour<br/></em></strong>sigma = [5, 5]<br/>z_mesh = sp.ndimage.filters.gaussian_filter(z_mesh, sigma, mode='constant')<br/> <br/><strong class="kl hj"><em class="kw"># Create the contour<br/></em></strong>contourf = plt.contourf(x_mesh, y_mesh, z_mesh, levels, alpha=0.5, colors=colors, linestyles='None', vmin=vmin, vmax=vmax)</span><span id="0934" class="kp kq hi kl b fi kv ks l kt ku"><strong class="kl hj"><em class="kw"># Convert matplotlib contourf to geojson<br/></em></strong>geojson = geojsoncontour.contourf_to_geojson(<br/>    contourf=contourf,<br/>    min_angle_deg=3.0,<br/>    ndigits=5,<br/>    stroke_width=1,<br/>    fill_opacity=0.1)<br/> <br/><strong class="kl hj"><em class="kw"># Set up the folium plot<br/></em></strong>geomap1 = folium.Map([DEM.latitude.mean(), DEM.longitude.mean()], zoom_start=12, tiles="OpenStreetMap")<br/> # Plot the contour plot on folium<br/>folium.GeoJson(<br/>    geojson,<br/>    style_function=lambda x: {<br/>        'color':     x['properties']['stroke'],<br/>        'weight':    x['properties']['stroke-width'],<br/>        'fillColor': x['properties']['fill'],<br/>        'opacity':   0.5,<br/>    }).add_to(geomap1)<br/> <br/><strong class="kl hj"><em class="kw"># Add the colormap to the folium map<br/></em></strong>cm.caption = 'Elevation in ft.'<br/>geomap1.add_child(cm)<br/> <br/><strong class="kl hj"><em class="kw"># Fullscreen mode<br/></em></strong>plugins.Fullscreen(position='topright', force_separate_button=True).add_to(geomap1)<br/>geomap1</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kx"><img src="../Images/6cd9e87108eb6b2331ee642dfa44612d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QIqWlFAtvutOPBOKA3HgmA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">基韦斯特在正常海水水位条件下，内陆无水。</figcaption></figure><p id="e12d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">要在地图上方绘制平均最高海水水位，我们需要计算相对于地面高程的水深，并将所有高于平均最高水位的高程上的水深设置为零。以下是该计算的示例代码。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="aad8" class="kp kq hi kl b fi kr ks l kt ku">DEM = data.copy()<br/><strong class="kl hj"><em class="kw"># Set all ground elevation below zero to zero to show that under </em></strong>mean sea level of zero, they are all inundated)<br/>for i in range(0,len(DEM)):<br/>    if DEM['elevation'][i] &lt;= 0.:<br/>        DEM['elevation'][i] = 0.</span><span id="3d5c" class="kp kq hi kl b fi kv ks l kt ku"><strong class="kl hj"><em class="kw"># Set the areas that are not flooded (zero water depth)<br/># Calculate water depth (in meter) in the flooded areas</em></strong></span><span id="99e9" class="kp kq hi kl b fi kv ks l kt ku">for i in range(0,len(DEM)):<br/>    if DEM['elevation'][i] &gt;= ((2.73-1.77)/3.280833):# set no flood area<br/>        DEM['elevation'][i] = 0.<br/>    else:# water depth calculation<br/>        DEM['elevation'][i] = ((2.73-1.77)/3.280833) - DEM['elevation'][i]# <strong class="kl hj"><em class="kw">There is 1.77 ft difference in water surface and DEM datum, it needs correction</em></strong><br/># <strong class="kl hj"><em class="kw">We can create the water depth contour map using the same code as describe in the first set of codes.</em></strong></span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ky"><img src="../Images/d7340da11fc46529d109338cb2a7ae38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dzk57f30ea3Kd_7AdQhflA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">平均最高海平面下的基韦斯特(基准面校正为1.77英尺)</figcaption></figure><p id="68e7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">上述代码适用于计算任何海平面条件下的水深，例如记录的最高海平面为4.47英尺。只需将水深计算中的数字替换为感兴趣的水位。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ky"><img src="../Images/83abc4d2ee030a893e5b31129104d2b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5hOP_GZ_a9WtJ_IvffOKrA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">2017年9月10日最高海平面下的基韦斯特(基准面校正1.77英尺)</figcaption></figure><p id="8237" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">2019年记录的最高海平面为3.43英尺，明显高于平均水平2.73英尺。一个持续的趋势是，未来海平面将继续上升。</p><p id="4083" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">即使你在没有洪水历史的地区买了房子，也不代表永远都是那样。其他需要考虑的是每年高达10，000美元的洪水保险和不断增加的税收。由于排水系统维护费用高昂，该市需要增加税收。海水入侵破坏了城市的一些排水系统。</p><p id="26f7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">那么，我亲爱的朋友，你还考虑搬到佛罗里达吗？</p><p id="6ec7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">参考:</p><ol class=""><li id="c965" class="kz la hi jq b jr js ju jv jx lb kb lc kf ld kj le lf lg lh bi translated"><a class="ae jn" href="https://pypi.org/project/geojsoncontour/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/geojsoncontour/</a></li><li id="2390" class="kz la hi jq b jr li ju lj jx lk kb ll kf lm kj le lf lg lh bi translated">https://www.tjansson.dk/2018/10/contour-map-in-folium/<a class="ae jn" href="https://www.tjansson.dk/2018/10/contour-map-in-folium/" rel="noopener ugc nofollow" target="_blank"/></li><li id="3d1e" class="kz la hi jq b jr li ju lj jx lk kb ll kf lm kj le lf lg lh bi translated">【https://tidesandcurrents.noaa.gov/waterlevels.html? T4】id=8724580 &amp;单位</li></ol></div></div>    
</body>
</html>