<html>
<head>
<title>Loan Data Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">贷款数据预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/loan-data-prediction-c326c72c489d?source=collection_archive---------10-----------------------#2020-06-23">https://medium.com/analytics-vidhya/loan-data-prediction-c326c72c489d?source=collection_archive---------10-----------------------#2020-06-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="56e4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="bcdf" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">问候！欢迎来到我的博客。这个博客是关于贷款预测的。在这里，我们要做的是，我们将尝试根据数据属性来预测用户是否会获得贷款。所以，让我们从它开始。</p><h1 id="476f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据</h1><p id="da27" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">数据取自kaggle.com<a class="ae kb" href="https://www.kaggle.com/altruistdelhite04/loan-prediction-problem-dataset" rel="noopener ugc nofollow" target="_blank">点击此处</a>获取数据。我不拥有数据的权利，我把它用于我的练习目的。</p><h1 id="acd5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">导入数据</h1><p id="5e81" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">首先，让我们从导入库开始。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="a440" class="kl ig hi kh b fi km kn l ko kp">import pandas as pd</span></pre><h1 id="2cb2" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">读取数据</h1><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7878" class="kl ig hi kh b fi km kn l ko kp">data  = pd.read_csv('../input/loan-prediction-problem-dataset/train_u6lujuX_CVtuZ9i.csv')</span></pre><h1 id="c230" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据概述</h1><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="4c23" class="kl ig hi kh b fi km kn l ko kp">data.head(10)</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kq"><img src="../Images/d93ef68d57b4eb031080dffe8eb7be20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GF1-EpOHPuFjNsslV3FdGQ.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">数据头</figcaption></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="a2c5" class="kl ig hi kh b fi km kn l ko kp">data.info()</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lc"><img src="../Images/e6256bb6e69fdcffb12f411de64d8431.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PuwBWk2CAhsWNKVkQjDPrQ.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">数据信息</figcaption></figure><h1 id="6380" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">删除空值</h1><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="9d46" class="kl ig hi kh b fi km kn l ko kp">data.dropna(inplace=True)<br/>vdata.dropna(inplace=True)</span></pre><h1 id="d212" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">应用标签编码器</h1><p id="7380" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">标签编码器用于将分类数据编码成数字数据。</p><p id="015c" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们导入必要的类。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="4ce7" class="kl ig hi kh b fi km kn l ko kp">from sklearn.preprocessing import LabelEncoder</span></pre><p id="0eea" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">为标签编码器创建对象</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7bdc" class="kl ig hi kh b fi km kn l ko kp">le = LabelEncoder()</span></pre><p id="78f8" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">现在我们要做的是，我们将找出具有这种分类数据的数据列。然后，我们将使用标签编码器对其进行拟合变换。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7c70" class="kl ig hi kh b fi km kn l ko kp">datatype = data.dtypes==object<br/>columns = data.columns[datatype].tolist()<br/>data[columns]=data[columns].apply(lambda val : le.fit_transform(val))</span></pre><p id="5850" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">应用标签编码器后，我们的数据看起来是这样的:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="710e" class="kl ig hi kh b fi km kn l ko kp">data.head()</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es li"><img src="../Images/8838e693c8b344b27a8594e4bd004807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y01Yc9yAskU4QejjcGslRg.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">标签编码器后的数据</figcaption></figure><p id="beac" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">删除Loan_id，因为它没有用。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="a10f" class="kl ig hi kh b fi km kn l ko kp">data.drop('Loan_ID',axis=1,inplace=True)</span></pre><h1 id="f8c9" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">形象化</h1><p id="3c62" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">让我们从导入可视化库开始。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="486c" class="kl ig hi kh b fi km kn l ko kp">import seaborn as sns<br/>import matplotlib.pyplot as plt</span></pre><p id="ad60" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们看看不同变量之间的相关性</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="27a9" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.heatmap(data.corr(),annot=True,fmt='.2f')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/858f0aea9c304520e9cdb572e34574e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4_d4nvTE4YAIG7oj.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">相关性-1</figcaption></figure><p id="ad98" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">贷款金额和申请人收入</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="f349" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.scatterplot(data=data,y='ApplicantIncome',x='LoanAmount',hue='Loan_Status')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lk"><img src="../Images/63ed54b61f642c1a2cdc3226073268f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JJJEi7fj42s_ZvJm.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">贷款金额和申请人收入</figcaption></figure><p id="4eb5" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">申请人和共同申请人收入</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="c8e7" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.scatterplot(data=data,y='ApplicantIncome',x='CoapplicantIncome',hue='Loan_Status')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ll"><img src="../Images/07e8029007f8bcecb58a954f3676b533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dveK7PPDDQnnsqi4.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">申请人和共同申请人收入</figcaption></figure><p id="bcef" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">贷款金额和申请人收入</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="82d1" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.scatterplot(data=data,y='ApplicantIncome',x='LoanAmount',hue='Credit_History')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lk"><img src="../Images/6127408af131ecd6596d9ad5144f5a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dw5RGl1fvILlnD7t.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">贷款金额和申请人收入</figcaption></figure><p id="4103" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">申请人的收入和贷款状况与婚姻状况的关系</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="bc9f" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.barplot(data=vdata,x='Loan_Status',y='ApplicantIncome',hue='Married')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lm"><img src="../Images/31ff9759fb646cfcd4e89349192079b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cIo7LMQ-93h1QwL8.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">贷款状况和申请人已婚收入</figcaption></figure><p id="ed39" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">房产面积和贷款状况</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7d0c" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.countplot(data=vdata,x='Property_Area',hue='Loan_Status')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/90f57578606eeae7574d58deb1e2bec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Xtl8loRAJxjaZOvM.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">房产面积和贷款状况</figcaption></figure><p id="ed3a" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">贷款金额期限和贷款状态</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="f0c0" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.countplot(data=vdata,x='Loan_Amount_Term',hue='Loan_Status')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/8410a2f71de2478a77698bd15e2dba77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7GC9byMOw513NCBO.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">贷款金额定期贷款状态</figcaption></figure><p id="4969" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">性别贷款状态</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="cd10" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.countplot(data=vdata,x='Gender',hue='Loan_Status')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/a507f7fa0961c1cee5756fd59639b28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HC_rL5xXVIv0eBjf.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">性别和贷款状况</figcaption></figure><p id="5787" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">个体户贷款状态</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="e0f3" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.countplot(data=vdata,x='Self_Employed',hue='Loan_Status')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/9a2ead35036f7e1c1abd82e04c979cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g-NH_7rPtTPxSl2m.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">个体户贷款状态</figcaption></figure><p id="5c19" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">受抚养人和贷款状态</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="e094" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.countplot(data=vdata,x='Dependents',hue='Loan_Status')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/c754b35d5cb89b6fd6d56ea8ca95c6a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MAK-8heGzxBy5pYR.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">家属与贷款状态</figcaption></figure><h1 id="aa86" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据异常值</h1><p id="d98b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">申请人收入异常值检测</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="2a9a" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.boxplot(data=data,y='ApplicantIncome')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lk"><img src="../Images/c34612b99ce471f3f5058476e408c578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WLlvXXGwVKtC-l93.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">申请人收入异常值</figcaption></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="9bcb" class="kl ig hi kh b fi km kn l ko kp">desc = data['ApplicantIncome'].describe()<br/>q1 = desc[4]<br/>q3 = desc[6]<br/>iqr = q3-q1<br/>low = q1 -0.5*iqr<br/>up = q3 +0.5*iqr<br/>print('Lower limit is ',low,'Upper lim is ',up)<br/>print('New DataFrame')<br/>data = data[(data['ApplicantIncome']&gt;low)&amp;(data['ApplicantIncome']&lt;up)]<br/><br/>Lower limit is  1421.875 Upper lim is  7329.375<br/></span></pre><p id="53f7" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">剔除异常值后</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="3433" class="kl ig hi kh b fi km kn l ko kp"><em class="lo"># Checking outlier</em><br/>plt.figure(figsize=(12,7))<br/>sns.boxplot(data=data,y='ApplicantIncome')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lm"><img src="../Images/8da6b83b9d24f44bd9fc63d5c6c40156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fVZ0Bsz8QxY9It3s.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">申请人收入</figcaption></figure><p id="7f87" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">共同申请人收入异常值</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="98d9" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.boxplot(data=data,y='CoapplicantIncome')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lk"><img src="../Images/2bbbf651851b9f670403c9d347fbc029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KeDwUTwph_mihVNu.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">共同申请人收入异常检测</figcaption></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="2cd2" class="kl ig hi kh b fi km kn l ko kp">desc = data['CoapplicantIncome'].describe()<br/>q1 = desc[4]<br/>q3 = desc[6]<br/>iqr = q3-q1<br/>low = q1 -0.5*iqr<br/>up = q3 +0.5*iqr<br/>print('Lower limit is ',low,'Upper lim is ',up)<br/>print('New DataFrame')<br/>data = data[(data['CoapplicantIncome']&gt;low)&amp;(data['CoapplicantIncome']&lt;up)]<br/>Lower limit is  -1166.5 Upper lim is  3499.5</span></pre><p id="513f" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">剔除异常值后</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="90b1" class="kl ig hi kh b fi km kn l ko kp"><em class="lo"># Checking outlier</em><br/>plt.figure(figsize=(12,7))<br/>sns.boxplot(data=data,y='CoapplicantIncome')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lm"><img src="../Images/4ef85c02af39573c371d3fa8b15d30b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nKLyJ1n7Nt4NYTeq.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">共同申请人收入</figcaption></figure><p id="ca43" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">贷款金额异常值</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="4d78" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.boxplot(data=data,y='LoanAmount')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/07d0e41a01ea43cc8c7ab083c1d56200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IUMl1n7Jddk2v26r.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">贷款金额异常检测</figcaption></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7ca2" class="kl ig hi kh b fi km kn l ko kp">desc = data['LoanAmount'].describe()<br/>q1 = desc[4]<br/>q3 = desc[6]<br/>iqr = q3-q1<br/>low = q1 -0.5*iqr<br/>up = q3 +0.5*iqr<br/>print('Lower limit is ',low,'Upper lim is ',up)<br/>print('New DataFrame')<br/>data = data[(data['LoanAmount']&gt;low)&amp;(data['LoanAmount']&lt;up)]<br/></span><span id="29d5" class="kl ig hi kh b fi lp kn l ko kp">Lower limit is  74.0 Upper lim is  162.0</span></pre><p id="0759" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">移除后</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="85b0" class="kl ig hi kh b fi km kn l ko kp"><em class="lo"># Checking outlier</em><br/>plt.figure(figsize=(12,7))<br/>sns.boxplot(data=data,y='LoanAmount')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/e4d5b309362fe91067bda74f9bc7828b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YWlQNlMhl3oHpdwB.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">贷款金额</figcaption></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7b0a" class="kl ig hi kh b fi km kn l ko kp">data</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lq"><img src="../Images/4ad25474d0296354cb61a6f36f9c6fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x72xiz0EMAjkmUjCqCzjKA.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">移除异常值后的数据概览</figcaption></figure><h1 id="9703" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">特征抽出</h1><p id="7174" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在这个过程中，我们确定哪些因素最突出或最适合训练我们的模型，并帮助我们给出准确的结果。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="d0d5" class="kl ig hi kh b fi km kn l ko kp">plt.figure(figsize=(12,7))<br/>sns.heatmap(data=data.corr(),annot=True,fmt='.2f',cmap='winter')</span></pre><figure class="kc kd ke kf fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lr"><img src="../Images/40cd16c657affb5b49c8a8cd9aff1a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YguPxQhx-Q714tRe.png"/></div></div></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="14f7" class="kl ig hi kh b fi km kn l ko kp">x = data.loc[:,['Gender','Married','CoapplicantIncome','LoanAmount','Credit_History']]<br/>y = data['Loan_Status']</span></pre><h1 id="6937" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">拆分数据</h1><p id="7a64" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">使用train_test_split将数据拆分为训练数据和测试数据</p><p id="7008" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">我们先导入它的库。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="4687" class="kl ig hi kh b fi km kn l ko kp">from sklearn.model_selection import train_test_split</span><span id="b4cc" class="kl ig hi kh b fi lp kn l ko kp">train_x,test_x,train_y,test_y = train_test_split(x,y,test_size=0.1,random_state=101)</span></pre><p id="03de" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">我们将test_size保持为10%,因此训练规模是我们总数据的90%</p><p id="165a" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们导入NumPy和准确度分数和混淆矩阵。这将有助于我们获得模型的准确性，它的混淆矩阵。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7a83" class="kl ig hi kh b fi km kn l ko kp">from sklearn.metrics import accuracy_score,confusion_matrix<br/>import numpy as np</span></pre><h1 id="9425" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">培训模式</h1><p id="9181" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">因此，我们考虑了几种分类算法，并选择了精确度最高的一种。<br/>考虑的算法有:<br/> 1) SVC <br/> 2)逻辑回归<br/> 3)决策树分类器<br/> 4) K近邻<br/>让我们看看哪个性能更好。</p><p id="54b3" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">SVC <br/> SVC代表支持向量分类器。它返回对我们的数据进行有效分类的最佳拟合超平面。SVC有许多超参数，如C、Kernel等，我们可以更新它们，这可以帮助我们提高模型的性能。但是，我们已经使用了所有模型的基本版本，以获得最佳效果。</p><p id="a7b8" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们导入模型并初始化它。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7ac8" class="kl ig hi kh b fi km kn l ko kp">from sklearn.svm import SVC<br/>sr = SVC()</span></pre><p id="050a" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">现在，让我们使用fit()将训练数据拟合到模型中。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="5c76" class="kl ig hi kh b fi km kn l ko kp">svr.fit(train_x,train_y)</span></pre><p id="3172" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">结果是:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="40ea" class="kl ig hi kh b fi km kn l ko kp">SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,<br/>    decision_function_shape='ovr', degree=3, gamma='scale', kernel='rbf',<br/>    max_iter=-1, probability=False, random_state=None, shrinking=True,<br/>    tol=0.001, verbose=False)</span></pre><p id="b8ad" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">现在，让我们应用predict()来预测测试数据的值。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="41dd" class="kl ig hi kh b fi km kn l ko kp">predict = svr.predict(test_x)</span></pre><p id="a1ad" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">现在，让我们看看它的准确率%和混淆矩阵</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="0a65" class="kl ig hi kh b fi km kn l ko kp">accuracy_score(test_y,predict)<br/>0.6923076923076923 <br/>confusion_matrix(test_y,predict)<br/>array([[ 0,  8],<br/>       [ 0, 18]])</span></pre><p id="8479" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">它给出了69.23%的准确率。它的混淆矩阵显示<br/>真阳性= 0 <br/>假阳性= 0 <br/>真阴性= 8 <br/>假阴性= 18 <br/>由此，我们可以得出结论，在传递的26行数据中，它只能识别8行为真阴性，18行为假阴性。</p><p id="4e18" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">逻辑回归</p><p id="6bb7" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">它是分类算法的一种基本形式。当只有两个类别要分类时使用。让我们看看它是如何为我们工作的。</p><p id="976c" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们导入并初始化它。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="c4c6" class="kl ig hi kh b fi km kn l ko kp">from sklearn.linear_model import LogisticRegression<br/>lr = LogisticRegression()</span></pre><p id="e754" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们训练我们的模型。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="e6e6" class="kl ig hi kh b fi km kn l ko kp">lr.fit(train_x,train_y)</span></pre><p id="0b3f" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">现在是时候预测了。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="b852" class="kl ig hi kh b fi km kn l ko kp">predict = lr.predict(test_x)</span></pre><p id="00cc" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">现在，让我们检查一下它的性能:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7de1" class="kl ig hi kh b fi km kn l ko kp">accuracy_score(test_y,predict)*100<br/>92.3076923076923<br/>confusion_matrix(test_y,predict)<br/>array([[ 6,  2],<br/>       [ 0, 18]])</span></pre><p id="8a7f" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">哇，92.3 %太棒了。一个更加平衡的混乱矩阵。我想我们已经有了赢家。</p><p id="00f5" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">决策树分类器</p><p id="1e42" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">因此，决策树分类器是一种用于分类数据的决策树。</p><p id="2b39" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们导入并初始化它。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7170" class="kl ig hi kh b fi km kn l ko kp">from sklearn.tree import DecisionTreeClassifier<br/>dtc = DecisionTreeClassifier()</span></pre><p id="60e5" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们训练它或者我可以说让我们成长它:P</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="2548" class="kl ig hi kh b fi km kn l ko kp">dtc.fit(train_x,train_y)</span><span id="fcd4" class="kl ig hi kh b fi lp kn l ko kp">DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',<br/>                       max_depth=None, max_features=None, max_leaf_nodes=None,<br/>                       min_impurity_decrease=0.0, min_impurity_split=None,<br/>                       min_samples_leaf=1, min_samples_split=2,<br/>                       min_weight_fraction_leaf=0.0, presort='deprecated',<br/>                       random_state=None, splitter='best')</span></pre><p id="3ecf" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">它的预测时间:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="df6e" class="kl ig hi kh b fi km kn l ko kp">predict = dtc.predict(test_x)</span></pre><p id="4771" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">来看看它的性能:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="0d6d" class="kl ig hi kh b fi km kn l ko kp">accuracy_score(test_y,predict)<br/>0.8076923076923077<br/>confusion_matrix(test_y,predict)<br/>array([[ 4,  4],<br/>       [ 1, 17]])</span></pre><p id="3c74" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">还不错，80.76%的准确率。体面的分数必须说。</p><p id="7aaf" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">k-最近邻</p><p id="6f79" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">最后但同样重要的是，KNN是最简单的算法，它使用最近的数据点进行分类。最近的数据点是使用像欧几里德距离这样的距离函数找到的。</p><p id="3eec" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们导入并初始化</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="0f9e" class="kl ig hi kh b fi km kn l ko kp">from sklearn.neighbors import KNeighborsClassifier<br/>knn =KNeighborsClassifier(n_neighbors=5)</span></pre><p id="80a0" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们训练它。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="8202" class="kl ig hi kh b fi km kn l ko kp">knn.fit(train_x,train_y)</span><span id="6c59" class="kl ig hi kh b fi lp kn l ko kp">KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',<br/>                     metric_params=None, n_jobs=None, n_neighbors=5, p=2,<br/>                     weights='uniform')</span></pre><p id="c51a" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">预测:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7425" class="kl ig hi kh b fi km kn l ko kp">predict = knn.predict(test_x)</span></pre><p id="25ae" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">让我们检查一下它的性能</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="494a" class="kl ig hi kh b fi km kn l ko kp">accuracy_score(test_y,predict)<br/>0.6923076923076923<br/>confusion_matrix(test_y,predict)<br/>array([[ 2,  6],<br/>       [ 2, 16]])</span></pre><p id="fc8b" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">其精度与SVC相同，但有不同的混淆矩阵。</p><p id="ba63" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">注意:<br/>我很快会写关于这些算法的详细博客。</p><h1 id="1176" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><p id="b8c7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">所以，我们有了明确的赢家，那就是逻辑回归。其他模型也可以提供这么多或者可能更多，我们对其进行微调。我将很快就这些算法撰写详细的博客，尽可能详细地解释它们。</p><p id="696e" class="pw-post-body-paragraph jd je hi jf b jg ld ji jj jk le jm jn jo lf jq jr js lg ju jv jw lh jy jz ka hb bi translated">我希望你喜欢这个博客。如果你觉得这个博客有帮助/信息，请喜欢它。下次见</p></div></div>    
</body>
</html>