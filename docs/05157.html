<html>
<head>
<title>Mathematics Behind Decision Tree Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">决策树算法背后的数学</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mathematics-behind-decision-tree-algorithm-6c5167bdde54?source=collection_archive---------28-----------------------#2020-04-12">https://medium.com/analytics-vidhya/mathematics-behind-decision-tree-algorithm-6c5167bdde54?source=collection_archive---------28-----------------------#2020-04-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="68ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类和回归树或简称CART是Leo Breiman引入的一个术语，指可用于分类或回归预测建模问题的决策树算法。传统上，这种算法被称为决策树。</p><p id="f72d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">购物车模型表示:</strong></p><p id="02d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">购物车模型的表示是一棵二叉树。这类似于数据结构中的二叉树。每个节点代表一个输入变量(x)和该变量上的一个分割点。树的叶节点包含用于进行预测的输出变量(y)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e19cd7af334d05cc348171141e65bced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wMGeMF4AsiWkEpx3umEp5g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">资料组</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/140640c411d49a43e7ef0a8b8d436ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*UmqxmenKBMZumJC4HcUHow.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">给定数据集的散点图</figcaption></figure><p id="dbc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过在数据中寻找分裂点来学习购物车模型。拆分点是单个属性的单个值，例如，X1属性的第一个值2.77。在分割点分割数据包括将节点上的所有数据分成两组，分割点的左边和分割点的右边。成本函数用于评估分配给分裂每一侧的训练数据的混合类别。在分类问题中，使用基尼指数成本函数。</p><p id="ed41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基尼指数成本函数</strong></p><p id="b50f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们计算分割点的基尼指数如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/17db85492d72f417100fd84faa9da816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*GJV6U4wOGKmKcG2X_DhuDQ.png"/></div></figure><p id="8e52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于每个类(k)，对于每个组(左和右)，其中p是给定组中给定类的训练实例的比例。我们总是有两个组，一个左组和一个右组，因为我们使用的是二叉树。从我们的数据集中我们知道我们只有两个类。因此，我们可以将数据集中任何分割点的基尼指数计算为以下各项之和:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jv"><img src="../Images/f1dbe6ea4c549afcc492699789ff9568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*maY2upka2kym2VD93kbz0w.png"/></div></div></figure><p id="3e6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是选择一个将成为我们决策树根节点的拆分。我们将从第一个候选分割开始，它是X1属性和第一个实例中X1的值:X1 = 2.77</p><p id="7823" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果X1 &lt; 2.77 THEN LEFT</p><p id="447e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">IF X1 &lt;= 2.77 THEN RIGHT</p><p id="928f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Similar do it for all and table is formed as</p><p id="3fef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">R -&gt;向右而L -&gt;向左</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/23a4c046630dedd37f3b1e010aa111a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-OMDbdpKXD44i6q6P9h6A.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/095c723f6c3193438d1bf97d9b902c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qEo7ssbuZffSgWKCWxJX4Q.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jy"><img src="../Images/6b0b84d52bb6c7cd6446784132664b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*zHMXeCvoAVMhETwEL9i3LA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/68d3d727333314f58df4886a170cd1de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-pkwyBf5AGAmB3RDwyLA3g.png"/></div></div></figure><p id="e44e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在X1 = 6.64时出现最小GINI(在X1处分开)= 0(纯GINI指数)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/575c07696c0c8b4b7a97df4d4c42041b.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*Hhn-OFJAdmUXlqMZICtJwg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">在X1 = 6.64处分离</figcaption></figure><p id="b2ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，我们在x2处对此进行计算，可以得到:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/1a9af1081d0de03dbb6ca7be139bd94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fzixdr5URe9T4ue0Czcr3w.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/8af8b9485a200fcef5ea6dfab5382dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*96jFgpfJhY8YIvoLoMm6rA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/6a8e36a81f53460ff4e26bc47534e250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pD3TBR9dcTA-eHezKnE6-Q.png"/></div></div></figure><p id="bfee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最小(GINI(在X2分开)= 0.277，这出现在X2 = 3.16</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/d30183d2518406a6676336f16d541ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*3r2JWi0HSPNyRSvEXJFmwA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">在x2 = 3.16时分割</figcaption></figure><p id="2427" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">测试数据集</strong></p><p id="fc15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以使用训练数据通过取X1 = 6.64来预测新已知的测试数据集，并计算准确度。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/402b0fd4cde69a2783e3d167dd093e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*1bE4OHk7MsrMSvS_B9NmhA.png"/></div></figure><p id="4220" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，这是一个完美的分类或100%准确。</p></div></div>    
</body>
</html>