<html>
<head>
<title>Handle Excel file using Python (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python处理Excel文件(第1部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/handle-excel-file-using-python-part-1-338e0b59fa26?source=collection_archive---------28-----------------------#2020-01-05">https://medium.com/analytics-vidhya/handle-excel-file-using-python-part-1-338e0b59fa26?source=collection_archive---------28-----------------------#2020-01-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b8a081bbb7e312a2e3e35ef5214c9cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DuWTQuLjjY9v_l55wUwl5g.png"/></div></div></figure><p id="c730" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博客中，我们将解释如何使用Python来处理Excel表格。在这里，我们将介绍如何添加一个新的工作表，删除现有的工作表，向单元格添加数据，从工作表中读取数据。这里我将使用Python的openpyxl模块，我们也可以使用Pandas来处理Excel表格，但是这里我们将使用openpyxl模块。</p><p id="0e29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用这个模块，我们可以做很多事情，比如从Excel中读取数据，将其转换为JSON，并使用Python将其索引到Elasticsearch。同样，我们可以从文本文件或Elasticsearch中读取数据，并将其写入Excel表格。我们还可以在Excel表上应用条件格式，使其更有效。我假设Python已经安装在您的机器上。所以我们开始用Python处理Excel吧。</p><p id="94b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要在编写代码之前安装openpyxl模块，为此，我们可以使用以下命令(我使用的是Ubuntu 19.04):</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e692" class="jx jy hi jt b fi jz ka l kb kc">sudo pip3 install openpyxl</span></pre><p id="6078" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以上命令将为Python安装openpyxl模块。得到成功消息后，我们可以开始编写Python代码来处理Excel表。</p><p id="86a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建一个空白的Excel表</strong> <br/>现在我们可以创建一个空白的Excel表来验证是否一切都如预期的那样工作。因此，让我们创建一个python空白文件“testexcel.py ”,并添加以下代码:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="885f" class="jx jy hi jt b fi jz ka l kb kc"># import openpyxl module as this is required to work with Excel<br/>import openpyxl as exl </span><span id="d6e1" class="jx jy hi jt b fi kd ka l kb kc"># provide the Excel file name <br/>filename="testexcel.xlsx"</span><span id="a831" class="jx jy hi jt b fi kd ka l kb kc"># create the workbook object using the Workbook method of openpyxl<br/>wb=exl.Workbook()</span><span id="a33f" class="jx jy hi jt b fi kd ka l kb kc"># now save workbook by providing the file name <br/>wb.save(filename)</span></pre><p id="3615" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在保存这个python文件，并使用以下命令执行它:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b635" class="jx jy hi jt b fi jz ka l kb kc">python3 testexcel.py</span></pre><p id="6503" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行此命令后，您可以在保存Python脚本的同一文件夹中看到“testexcel.xlsx”。我们可以提供Excel文件的完整路径，以防我们想将它保存在其他地方。</p><p id="3ae6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">获取Excel文件详情</strong></p><p id="917e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们将读取Excel表格，并尝试获取文件详细信息和表格详细信息等。我在前一个文件中添加了三张纸，这样会使事情更清楚易懂。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es ke"><img src="../Images/d0b75c8e9b1d11535db3a16af3cb3af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*YPcZ_AFYJL0pjSkhmFkvPg.png"/></div></figure><p id="62dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要编写以下代码来获取Excel表的详细信息:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="55af" class="jx jy hi jt b fi jz ka l kb kc"># import openpyxl module as this is required to work with Excel<br/>import openpyxl as exl  <br/><br/># provide the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># Getting the basic properties of the workbook like last modified by, Created date time, etc<br/>prop = workbook.properties<br/>print(prop)<br/><br/># Getting the sheets in the workbook <br/>worksheet = workbook.worksheets<br/>print(worksheet)<br/><br/># Getting the sheet names in a workbook as a list of strings<br/>sheetname = workbook.sheetnames<br/>print(sheetname)<br/><br/># Getting the active sheet in the workbook<br/>active = workbook.active<br/>print(active)</span></pre><p id="46c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">保存文件后，我们可以运行Python文件，该文件将给出以下输出:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="0b42" class="jx jy hi jt b fi jz ka l kb kc">&lt;openpyxl.packaging.core.DocumentProperties object&gt;<br/>Parameters:<br/>creator='openpyxl', title=None, description=None, subject=None, identifier=None, language='en-IN', created=datetime.datetime(2019, 12, 30, 14, 33, 54), modified=datetime.datetime(2019, 12, 30, 14, 47, 50), lastModifiedBy=None, category=None, contentStatus=None, version=None, revision='1', keywords=None, lastPrinted=None<br/>[&lt;Worksheet "Anurag Sheet 1"&gt;, &lt;Worksheet "Anurag Sheet 2"&gt;, &lt;Worksheet "Anurag Sheet 3"&gt;]<br/>['Anurag Sheet 1', 'Anurag Sheet 2', 'Anurag Sheet 3']<br/>&lt;Worksheet "Anurag Sheet 3"&gt;</span></pre><p id="4965" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样，我们可以通过读取文件来获取Excel文件的详细信息。</p><p id="5b71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建一个新的工作表</strong> <br/>现在我们将使用Python向Excel文件添加一个新的工作表。我们需要为此编写以下代码:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1107" class="jx jy hi jt b fi jz ka l kb kc"># import openpyxl module as this is required to work with Excel<br/>import openpyxl as exl  <br/><br/># provide the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># Creating a new sheet by using create_sheet() method<br/>workbook.create_sheet('Anurag test sheet')<br/><br/># save the workbook<br/>workbook.save(filename)</span></pre><p id="8a25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行上述代码后，我们可以在Excel文件中看到一个新的工作表。</p><p id="4020" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">向Excel表格添加数据</strong> <br/>我们可以通过以下方式向表格的任意单元格添加数据:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cb45" class="jx jy hi jt b fi jz ka l kb kc">1) Set value for cell by providing the cell address like A1, B3, etc<br/>sheet['A1'] = 1<br/><br/>2) Set value for cell by providing the row and column number<br/>sheet.cell(row=2, column=2).value = 2<br/><br/>3) We can also append the data in tablular form, see the below code:<br/><br/>employeedata=[('id','name','mobile'),<br/>      (1,'Anurag',1234567890),<br/>      (2,'Suraj',4323456787)]<br/><br/># append above data<br/>for row in employeedata:<br/>    sheet.append(row)</span></pre><p id="0e61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们编写代码，在Excel的活动工作表中添加单元格值:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b456" class="jx jy hi jt b fi jz ka l kb kc"># import openpyxl module as this is required to work with Excel<br/>import openpyxl as exl  <br/><br/># provide the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># Take the reference of active sheet<br/>sheet = workbook.active<br/><br/>employeedata=[('id','name','mobile'),<br/>      (1,'Anurag',1234567890),<br/>      (2,'Suraj',4323456787)]<br/><br/># append above data<br/>for row in employeedata:<br/>    sheet.append(row)<br/><br/># save the workbook<br/>workbook.save(filename)</span></pre><p id="d880" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行上述代码后，我们可以看到Excel文件中的数据。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/01848574b51384b83779fd1c29bc0ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*vVS77vbC0O7pT603UmIYwg.png"/></div></figure><p id="6d66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博客中，我们介绍了如何查看Excel表格的细节，如何将数据写入Excel表格，以及如何添加新的表格。在下一篇博客“<a class="ae kg" href="https://bqstack.com/b/detail/104/Handle-Excel-file-using-Python-%28Part-2%29" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">【使用Python处理Excel文件(第二部分)</strong> </a>”中，我们将讲述如何从Excel表格中读取数据以及如何在Excel表格数据上添加样式。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><p id="cf51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">【https://bqstack.com】最初发表于<a class="ae kg" href="https://bqstack.com/b/detail/103" rel="noopener ugc nofollow" target="_blank"><em class="ko"/></a><em class="ko">。</em></p></div></div>    
</body>
</html>