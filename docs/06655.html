<html>
<head>
<title>OCR Corrector in RegEx Extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正则表达式提取中的OCR校正器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ocr-corrector-in-regex-extraction-6d2af0d92dc?source=collection_archive---------9-----------------------#2020-05-29">https://medium.com/analytics-vidhya/ocr-corrector-in-regex-extraction-6d2af0d92dc?source=collection_archive---------9-----------------------#2020-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d61b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从文本图像中提取实体有不同的方法。一些方法是:</p><ol class=""><li id="9ef7" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">正则表达式</li><li id="9e58" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">模板</li><li id="0a6f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">机器学习/深度学习</li></ol><p id="ba0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们不会深入每种方法的细节。然而，我们将探索一种方法来改善正则表达式提取。</p><p id="6604" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正则表达式实体提取-在图像的OCR文本上应用正则表达式来提取实体。</p><p id="bd10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于本教程，让我们以PAN文档(在印度使用)为例。这里可以使用任何类型的文本图像和任何类型的OCR引擎。</p><p id="7c7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们假设下面的OCR文本是完美的/没有任何错误</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="667f" class="ka kb hi jw b fi kc kd l ke kf">good_ocr_text = '''आयकर विभाग<br/>भारत सरकार<br/>GOVT OF INDIA<br/>INCOME TAX DEPARTMENT<br/>स्थायी लेखा संख्या काई<br/>Permanent Account Number Card<br/>ABCXY1234Z<br/>Name<br/>ABCD XYZ<br/>father's Name<br/>PQRST UVW<br/>Applcart Sigrahre<br/>Date of Birth<br/>01/01/1975<br/>uSianature'''</span></pre><p id="d2ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将编写一些正则表达式来从OCR文本中提取实体</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="ad71" class="ka kb hi jw b fi kc kd l ke kf">def getPanName(text):<br/>   pattern='(?:Name)\s*([a-z]*\s*[a-z]*\s*[a-z]*)$'<br/>   value = re.search(pattern, text, re.I|re.MULTILINE)<br/>   if value:<br/>      return value.group(1)</span><span id="0c80" class="ka kb hi jw b fi kg kd l ke kf">def getPanNumber(text):<br/>   pattern= '(?:Number Card)\s*([a-z]{5}\d{4}[a-z]{1})$'<br/>   value = re.search(pattern, text, re.I|re.MULTILINE)<br/>   if value:<br/>      return value.group(1)</span><span id="be73" class="ka kb hi jw b fi kg kd l ke kf">print('Name:',getPanName(good_ocr_text))<br/>Name: ABCD XYZ</span><span id="5525" class="ka kb hi jw b fi kg kd l ke kf">print('PAN No:',getPanNumber(good_ocr_text))<br/>PAN No: ABCXY1234Z</span></pre><p id="0779" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用简单的正则表达式成功地提取了想要的实体。</p><p id="d99a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们假设由于某种原因(图像质量改变，OCR引擎改变等)。)OCR文字不好</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="51d7" class="ka kb hi jw b fi kc kd l ke kf">Number --&gt; Numper<br/>Name --&gt; Nane<br/></span><span id="8040" class="ka kb hi jw b fi kg kd l ke kf">bad_ocr_text = '''आयकर विभाग<br/>भारत सरकार<br/>GOVT OF INDIA<br/>INCOME TAX DEPARTMENT<br/>स्थायी लेखा संख्या काई<br/>Permanent Account Numper Card<br/>ABCXY1234Z<br/>Nane<br/>ABCD XYZ<br/>father's Nane<br/>PQRST UVW<br/>Applcart Sigrahre<br/>Date of Birth<br/>01/01/1975<br/>uSianature'''</span></pre><p id="7923" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行相同的正则表达式不会产生预期的结果</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="208f" class="ka kb hi jw b fi kc kd l ke kf">print('Name:',getPanName(bad_ocr_text))<br/>Name: None</span><span id="ecc8" class="ka kb hi jw b fi kg kd l ke kf">print('PAN No:',getPanNumber(bad_ocr_text))<br/>PAN No: None</span></pre><p id="2f87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们有一种可能的方法来达到预期的结果，那就是更新现有的正则表达式，使其包含拼写错误的单词。</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="d84a" class="ka kb hi jw b fi kc kd l ke kf">pattern='(?:Name|Nane)\s*([a-z]*\s*[a-z]*\s*[a-z]*)$'</span></pre><p id="d818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是我们可以给正则表达式添加多少不正确的单词。OCR引擎有无数种方法可以拼错一个单词。</p><p id="939a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，如果我们能够纠正这些不好的单词呢？</p><p id="b52d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建一个正则表达式中使用的单词列表。我们称之为好词(稍后他们将与坏词斗争并取代它们:)</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="6707" class="ka kb hi jw b fi kc kd l ke kf">good_words = ['Name','Number','Card']</span></pre><p id="dca4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将编写一些代码来用好词替换坏词。</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="69b0" class="ka kb hi jw b fi kc kd l ke kf">'''<br/>If bad OCR word matches(75% match) with any of good word then that bad OCR word should be replaced with good word<br/>'''<br/>def ocr_corrector(text,good_words):<br/>  corrected_text = ''<br/>  for sent in text.split("\n"):<br/>    #print(sent)<br/>    new_sent = []<br/>    for word in sent.split(" "):<br/>      if not word.lower() in good_words:<br/>        for gword in good_words:<br/>          if Levenshtein.ratio(word,gword) &gt;= 0.75:<br/>            word = gword.strip()<br/>      new_sent.append(word)<br/>    corrected_text += (" ".join(new_sent)+"\n")<br/>  return corrected_text</span></pre><p id="67df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将把错误的OCR传递给这个方法</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="fc84" class="ka kb hi jw b fi kc kd l ke kf">bad_ocr_text_corrected = ocr_corrector(bad_ocr_text,good_words)</span><span id="6462" class="ka kb hi jw b fi kg kd l ke kf">'''<br/>Bad OCR words are corrected.<br/>Numper --&gt; Number<br/>Nane --&gt; Name<br/>'''<br/>print(bad_ocr_text_corrected)</span><span id="f836" class="ka kb hi jw b fi kg kd l ke kf">आयकर विभाग<br/>भारत सरकार<br/>GOVT OF INDIA<br/>INCOME TAX DEPARTMENT<br/>स्थायी लेखा संख्या काई<br/>Permanent Account Number Card<br/>ABCXY1234Z<br/>Name<br/>ABCD XYZ<br/>father's Name<br/>PQRST UVW<br/>Applcart Sigrahre<br/>Date of Birth<br/>01/01/1975<br/>uSianature</span></pre><p id="8bbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种校正的OCR将给出期望的结果</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="ea32" class="ka kb hi jw b fi kc kd l ke kf">print('Name:',getPanName(bad_ocr_text_corrected))<br/>Name: ABCD XYZ<br/>print('PAN No:',getPanNumber(bad_ocr_text_corrected)) <br/>PAN No: ABCXY1234Z</span></pre><p id="8a6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们在不更新基本正则表达式的情况下获得了想要的结果。我们可以根据特定场景中预期的OCR质量，将75%匹配阈值更改为任何其他阈值。</p><p id="e566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">OCR校正器不必仅应用于正则表达式提取。它可以应用于任何涉及OCR文本的用例。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><p id="3ad4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码可在<a class="ae ko" href="https://github.com/sarang0909/OCR-Corrector" rel="noopener ugc nofollow" target="_blank"> git-hub </a>获得</p><p id="182b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章或有任何建议/意见，请在下面分享！</p><p id="48db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在<a class="ae ko" href="https://www.linkedin.com/in/sarang-mete-6797065a/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系讨论</p></div></div>    
</body>
</html>