<html>
<head>
<title>Introduction to Mixed Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混合模型介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/introduction-to-mixed-models-208f012aa865?source=collection_archive---------0-----------------------#2019-10-25">https://medium.com/analytics-vidhya/introduction-to-mixed-models-208f012aa865?source=collection_archive---------0-----------------------#2019-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/eb7c0923c1b108ef114d41ad74cbb36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E-HwkFjwDMnr_d4H"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae iu" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Carlos Muza </a>拍摄的照片</figcaption></figure><p id="1dfb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个<strong class="ix hj">混合模型</strong>(或者更准确地说是<strong class="ix hj">混合</strong>误差分量<strong class="ix hj">模型</strong>)是一个统计<strong class="ix hj">模型</strong>，包含固定效应和随机效应。它是简单线性模型的扩展。这些模型<strong class="ix hj">在物理、生物和社会科学</strong>的多种学科中都很有用。这就是<em class="jt">回归模型</em>，当您的数据包含全局和组级趋势时，它是线性回归模型的强大工具之一。</p><p id="7fea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它们在对相同的统计单位进行重复测量(纵向研究)或对相关统计单位集群进行测量的情况下特别有用。</p><p id="c4a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在生态学和生物学领域，数据通常是复杂和混乱的，有时是双模态的。我们可能有不同的<strong class="ix hj">分组因素</strong>如种群、物种、地点、性别等。<strong class="ix hj">样本大小</strong>也可能有所欠缺，尤其是如果我们试图用<strong class="ix hj">许多参数</strong>来拟合复杂的模型。</p><p id="52fa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是为什么<strong class="ix hj">混合模型</strong>被开发出来，以处理这种混乱的数据，并允许我们使用我们所有的数据，即使当我们有低样本量、结构化数据和许多协变量时。</p><p id="c8d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">下面是混合模型的表示:</em></p><p id="2ec7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Y =固定效应+随机效应+误差</strong></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es ju"><img src="../Images/2919405cdb7da51056c9dae11e2af22e.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*raxNnXHWytoywkCx9ZzcJQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">混合模型语法</figcaption></figure><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/5f99ca3a3f265952ce5446294744602e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j7J6s6_QhgdsVNDQA-fKNw.png"/></div></div></figure><h2 id="e219" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated"><strong class="ak">什么是固定效果？</strong></h2><p id="9521" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated"><strong class="ix hj">固定效应模型</strong>是一种统计模型，其中模型参数是固定的或非随机量。假设观察值是独立的。</p><p id="c74c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Eg:- </strong>性别是固定效应变量；男性/女性的价值观相互独立(相互排斥)，不会随着时间的推移而改变。</p><h2 id="2a9c" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated"><strong class="ak">什么是随机效应？</strong></h2><p id="c86c" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated"><strong class="ix hj">随机效应模型</strong>是一个统计模型，其中模型参数是随机变量。假设一些观察值之间存在某种类型的关系。</p><p id="093c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">新车的价格根据购买年份的不同而不同。</p><h2 id="82c1" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated"><strong class="ak">混合模式的优势</strong></h2><ol class=""><li id="9699" class="la lb hi ix b iy kv jc kw jg lc jk ld jo le js lf lg lh li bi translated">它允许固定效果的随机效果。</li><li id="f49f" class="la lb hi ix b iy lj jc lk jg ll jk lm jo ln js lf lg lh li bi translated">更好地处理缺失数据。</li><li id="9f83" class="la lb hi ix b iy lj jc lk jg ll jk lm jo ln js lf lg lh li bi translated">允许随着时间的推移重复进行测量。</li><li id="0a6b" class="la lb hi ix b iy lj jc lk jg ll jk lm jo ln js lf lg lh li bi translated">可以处理其他类型的因变量:分类变量、连续变量、顺序变量、离散变量等。</li><li id="4372" class="la lb hi ix b iy lj jc lk jg ll jk lm jo ln js lf lg lh li bi translated">适用于相关数据回归模型，包括重复测量、纵向、时间序列、聚类和其他相关方法。</li></ol><p id="4e29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文通过一个使用礼貌数据的例子来介绍这个概念。我将使用R作为对这种语言的一个小小的慰问，尽管在这篇文章中它是一个健壮的框架。</p><p id="bccc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以手动下载数据……<br/><a class="ae iu" href="http://www.bodowinter.com/tutorial/politeness_data.csv" rel="noopener ugc nofollow" target="_blank"><em class="jt">【http://www.bodowinter.com/tutorial/politeness_data.csv】</em>T5】</a></p><h2 id="c3b1" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated"><strong class="ak">在R中执行混合模式</strong></h2><p id="2ac2" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">R中有两个包来执行混合模型:-</p><ol class=""><li id="1dce" class="la lb hi ix b iy iz jc jd jg lo jk lp jo lq js lf lg lh li bi translated"><em class="jt"> lme4 </em></li><li id="6f00" class="la lb hi ix b iy lj jc lk jg ll jk lm jo ln js lf lg lh li bi translated"><em class="jt"> nmle </em></li></ol><p id="1b92" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">数据分析</strong></p><p id="067c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将在<em class="jt"> </em>这篇帖子中使用<em class="jt"> lme4 </em>包<em class="jt"> </em>来执行混合模式。让我们开始加载数据。显然，数据中存在缺失值。我正在删除丢失的值。删除丢失的值后，数据如下所示。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/28c91485ef18c5e33161006802104e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*O-lrNDidStLrHUe0UVEHOA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">数据汇总</figcaption></figure><p id="ffbc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你有lmer()函数可用；它是函数lm()的混合模型等价物。该函数将构建混合模型。</p><p id="6ad9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">礼貌水平的差异表现在“态度”一栏中。在那一栏中，“pol”代表礼貌，“inf”代表非正式。性别在“性别”一栏中表示为“F”和“M”。从属度量是“频率”，它是以赫兹(Hz)度量的音高。对我们来说，有趣的随机效应在“主题”和“场景”一栏中。</p><p id="7457" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们通过箱线图来看看礼貌和音高之间的关系:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/a01f23b7f640750e6f8159e2d6d8d5cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*u50DU9TBNd9ThLeWphaMqA.png"/></div></figure><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/90e8582222c0d5024969609bf6456930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*jPlPe1DHRijD6nfPZpbTDA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">箱线图</figcaption></figure><p id="595c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这两种情况下，中线是箱线图中心的黑线；在礼貌场合比在非正式场合要低。然而，对于男性来说，这两种礼貌类别之间的重叠可能比女性多一点。</p><p id="a447" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从构建第一个混合模型开始，</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/d5436d0fa4c9b111151e209b5172e9d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*6PS_LRbqRE7noVp4vIcjOw.png"/></div></figure><p id="ef5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，这里频率是我们的因变量，态度是我们的固定效应，主题和场景是我们的随机效应。<em class="jt">(1 |主语)表示什么？</em></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/25689108357ae4342690e2d766213111.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/format:webp/1*bXsf44Yi04-M63ffWPOqYA.png"/></div></figure><p id="349c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这告诉我们，随机截距与固定均值。</p><p id="5f9a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在<code class="du lw lx ly lz b">|</code>运算符右边的是一个因子，被称为术语的“分组因子”。<strong class="ix hj">随机效应(因素)可以交叉或嵌套</strong> —这取决于变量之间的关系。</p><p id="b6ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有各种不同风格的写作随机效应的方程。你可以用先验方法添加随机截距，也可以用截距添加斜率等。下面是在lmer()包中编写随机效果的语法。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/bddaf50341605ceeac746aa22f3a808a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2O83UY54CBcsUPfp9Naeg.png"/></div></div></figure><p id="8bb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们来看看这个模型的总结。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/36d9317c5d2cb4348e13bd3fff462c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*j4n9QYSaGT54DmQHAOp7Wg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型摘要</figcaption></figure><p id="2f22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在混合模型中，你可以在如上所示的模型概要中同时获得固定效应和随机效应。让我们看看标准差，它是在我们的模型摘要中获得的，如下所示。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/f3e7eb9caa18a711af8d4894a86a46eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*Mc_ctPr-u0swOEvHMs0FaQ.png"/></div></figure><p id="4914" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是对因场景和主题(我们的两个随机效应)而导致的从属度量中有多少可变性的度量。你可以看到场景比主题的可变性要小得多。根据上面的箱线图，我们发现受试者之间的差异大于项目之间的差异，这是意料之中的。接下来是“残差”,它代表不是由场景或主题引起的可变性。这就是我们的“ε”，与预测值的“随机”偏差，这种偏差不是由于受试者和场景造成的。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es md"><img src="../Images/172edc60214d179d8652d0bd7eea29f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*_hA-voIa0KBdHoJ2n42UCA.png"/></div></figure><p id="f960" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们检查一下模型概要中的固定效果。这里“态度”是礼貌的分类效果的斜率。现在<strong class="ix hj"> -19.695 </strong>表示<strong class="ix hj">音高在礼貌用语中比在非正式用语中低20 Hz左右</strong>。此外，这个斜率还有一个标准误差和一个t值，t值就是估计值(20 Hz)除以固定效应的标准误差。</p><p id="ed19" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">和往常一样，看看这些图来检验我们的假设是一个很好的练习:</em></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es me"><img src="../Images/22fdb26ee24e4c4a66011e85ce89bd5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:208/format:webp/1*a7d0isSKjfPT-N0Ptw7yVg.png"/></div></figure><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/42749bb3c2ff7f36e7cb19eb26659a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*NeI1JiKimWrqr8Ug68MJkg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">残差与拟合值图</figcaption></figure><p id="038b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">另外，检查QQPlot: </em></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/231cff61b873420f1df61234085d0506.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*pt47Ri__Qc4pGIuZcMFxlw.png"/></div></figure><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/8e7360f0cbdf4632eb2c20756ec73e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*00pUiIDt78qLkatagn6CzA.png"/></div></figure><p id="deac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想看看lme4()的表，我建议你应该看看stargazer()包。它有很好的注释，并且有很多资源。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/19c2bd87b0b8426a85b38672c11921a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*heUjkCBkQCsKyNb2DsN_eg.png"/></div></figure><p id="3abe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们计算模型的RMSE值。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/8824f697d1967eb16d6f600e3b43d7f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*9D-Tuppfly4mes_Tp91sPA.png"/></div></figure><p id="ca3f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">结论</strong></p><p id="9a79" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">混合效果模型可能有点棘手，而且通常在处理其中某些问题的最佳方式上没有太多共识。编码位实际上是(相对)容易的部分。</p></div></div>    
</body>
</html>