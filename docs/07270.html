<html>
<head>
<title>Detecting Fake News using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用机器学习检测假新闻</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/detecting-fake-news-using-machine-learning-95efefab08e4?source=collection_archive---------13-----------------------#2020-06-19">https://medium.com/analytics-vidhya/detecting-fake-news-using-machine-learning-95efefab08e4?source=collection_archive---------13-----------------------#2020-06-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/47b6cbac1ca17caff3afd7ff77b49dc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*2A0EXqjk7sY_ZbWW.gif"/></div><figcaption class="im in et er es io ip bd b be z dx translated">GIF <a class="ae iq" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fgfycat.com%2Fgifs%2Fsearch%2Ftrump%2Bfake%2Bnews&amp;psig=AOvVaw25OUcGmYa68TgzTIpaHotZ&amp;ust=1592610370570000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCKD7x43GjOoCFQAAAAAdAAAAABAa" rel="noopener ugc nofollow" target="_blank">这里</a></figcaption></figure><p id="692d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">目前，最大的问题是<strong class="it hj"> <em class="jp">假新闻</em> </strong>。离开他们几乎是不可能的。</p><p id="f7fd" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但是怎么用<strong class="it hj"> <em class="jp">机器学习</em> </strong>来预测什么是假新闻，什么不是呢？</p><p id="057e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在过去的3天里，我一直在研究这个问题，在这篇文章中，我将解释我如何构建一个能够仅凭新闻标题识别假新闻的机器学习模型。</p><blockquote class="jq jr js"><p id="0232" class="ir is jp it b iu iv iw ix iy iz ja jb jt jd je jf ju jh ji jj jv jl jm jn jo hb bi translated"><strong class="it hj"> <em class="hi">在开始之前:</em> </strong>这只是一个个人项目！我真的认为我们需要的不仅仅是标题来发现什么是<strong class="it hj"> <em class="hi">假新闻</em> </strong>什么不是！这里的<em class="hi">主要思想</em>是展示我们如何使用<strong class="it hj"> <em class="hi">机器学习方法</em></strong><strong class="it hj"><em class="hi">识别假新闻</em> </strong>。</p></blockquote><p id="60b4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">基本上，这个项目分为5个步骤，让我们更好地看到它…</p><h2 id="d076" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated">这些是我们在这个项目中的任务:</h2><ul class=""><li id="59ed" class="kr ks hi it b iu kt iy ku jc kv jg kw jk kx jo ky kz la lb bi translated">将数据输入我们的模型；</li><li id="447a" class="kr ks hi it b iu lc iy ld jc le jg lf jk lg jo ky kz la lb bi translated">格式化数据；</li><li id="0ece" class="kr ks hi it b iu lc iy ld jc le jg lf jk lg jo ky kz la lb bi translated">将数据符号化；</li><li id="4e0d" class="kr ks hi it b iu lc iy ld jc le jg lf jk lg jo ky kz la lb bi translated">建立我们的模型；</li><li id="8b5e" class="kr ks hi it b iu lc iy ld jc le jg lf jk lg jo ky kz la lb bi translated">训练我们的模型；</li><li id="b0b5" class="kr ks hi it b iu lc iy ld jc le jg lf jk lg jo ky kz la lb bi translated">做预测；</li></ul><p id="840e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">让我们开始吧，宝贝！</p><h1 id="59a3" class="lh jx hi bd jy li lj lk kc ll lm ln kg lo lp lq kj lr ls lt km lu lv lw kp lx bi translated">获取数据</h1><p id="931c" class="pw-post-body-paragraph ir is hi it b iu kt iw ix iy ku ja jb jc ly je jf jg lz ji jj jk ma jm jn jo hb bi translated">对于这个项目，我使用了来自<a class="ae iq" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的<a class="ae iq" href="https://www.kaggle.com/clmentbisaillon/fake-and-real-news-dataset" rel="noopener ugc nofollow" target="_blank">假或真的新闻数据集</a>。</p><p id="d507" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这个<strong class="it hj"> <em class="jp">数据集</em> </strong>有2个csv文件，假的真的，我们可以下载合并成一个。</p><p id="a007" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但是在将我们的数据集合并成一个之前，我们需要标记它们。我们想用1代表真，用0代表假。</p><p id="7dd4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">为此，我们可以在每个名为“label”的<strong class="it hj"> <em class="jp">数据集</em> </strong>中添加一列，并将她的值指定为1代表真或0代表假，如下面的代码所示:</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="368d" class="jw jx hi mg b fi mk ml l mm mn">true[‘label’] = 1<br/>fake['label'] = 0</span></pre><p id="e10b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">其他好的做法是验证我们的<strong class="it hj"> <em class="jp">数据集</em> </strong>是否有NaN值，我们可以用<strong class="it hj"><em class="jp"/></strong>和<strong class="it hj"> <em class="jp">热图</em> </strong>图来验证它！</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="7691" class="jw jx hi mg b fi mk ml l mm mn">plt.figure(figsize=(12, 8))<br/>sns.heatmap(data.isnull(), cmap='viridis')</span></pre><p id="ca7b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这样做之后，我们可以使用下面的代码将我们的<strong class="it hj"> <em class="jp">数据集</em> </strong>合并成一个:</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="101e" class="jw jx hi mg b fi mk ml l mm mn"><em class="jp"># Concating:</em><br/><br/>data = pd.concat([true, fake], axis=0)<br/>data</span></pre><p id="b6cb" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我在<strong class="it hj"> <em class="jp">数据集</em> </strong>中做了一些其他的修改，万一我将来再次使用它，你可以在<a class="ae iq" href="https://github.com/gabrielmayers/fake_news-ai/blob/master/Data_Preparation.ipynb" rel="noopener ugc nofollow" target="_blank">这个笔记本</a>中看到所有修改的笔记本。</p><p id="049d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在我们可以保存我们的<strong class="it hj"> <em class="jp">数据集</em> </strong>，如下面的代码所示:</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="5e77" class="jw jx hi mg b fi mk ml l mm mn"><em class="jp"># To csv:</em> </span><span id="0b32" class="jw jx hi mg b fi mo ml l mm mn">data.to_csv(‘data.csv’)</span></pre><p id="7410" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们已经完成了前两个任务，现在，我们可以开始对<strong class="it hj"> <em class="jp">的</em> </strong>数据进行令牌化了！</p><h1 id="8c41" class="lh jx hi bd jy li lj lk kc ll lm ln kg lo lp lq kj lr ls lt km lu lv lw kp lx bi translated">将数据符号化</h1><p id="3ad3" class="pw-post-body-paragraph ir is hi it b iu kt iw ix iy ku ja jb jc ly je jf jg lz ji jj jk ma jm jn jo hb bi translated">基本上，当你将数据标记化时，你将单词转换成数字，即<strong class="it hj"> <em class="jp">机器学习模型</em> </strong>的语言。</p><p id="ea9e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">你可以在<a class="ae iq" href="https://github.com/gabrielmayers/fake_news-ai/blob/master/Model.ipynb" rel="noopener ugc nofollow" target="_blank">这本笔记本</a>里看到<strong class="it hj"> <em class="jp">去符号化</em> </strong>的过程。</p><p id="9ca0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">为了标记我们的数据，我们想要使用Tensorflow预处理库，首先我们想要导入它:</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="3fe5" class="jw jx hi mg b fi mk ml l mm mn"><strong class="mg hj">from</strong> <strong class="mg hj">tensorflow.keras.preprocessing.text</strong> <strong class="mg hj">import</strong> Tokenizer<br/><strong class="mg hj">from</strong> <strong class="mg hj">tensorflow.keras.preprocessing.sequence</strong> <strong class="mg hj">import</strong> pad_sequences</span></pre><p id="b61a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们想使用<em class="jp">填充序列</em>来使所有的数字向量具有相同的长度，你可以在<a class="ae iq" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/sequence/pad_sequences" rel="noopener ugc nofollow" target="_blank">的</a>中阅读更多关于<em class="jp">填充序列</em>的内容。</p><p id="3ebe" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我们想通过使用下面的代码来标记我们的数据:</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="1730" class="jw jx hi mg b fi mk ml l mm mn">train = df[:30000]<br/>test = df[30000:]<br/><br/>train_sentences = train['title'].tolist()<br/>test_sentences = test['title'].tolist()</span><span id="36b6" class="jw jx hi mg b fi mo ml l mm mn">vocab_size = 5000<br/>embedding_dim = 16<br/>max_length = 500<br/>trunc_type = 'post'<br/>padding_type = 'post'<br/>oov_tok = '&lt;OOV&gt;'</span><span id="83d7" class="jw jx hi mg b fi mo ml l mm mn">tokenizer = Tokenizer(num_words=vocab_size, oov_token=oov_tok)<br/>tokenizer.fit_on_texts(train_sentences)<br/>word_index = tokenizer.word_index<br/><br/>training_sequences = tokenizer.texts_to_sequences(train_sentences)<br/>training_padded = pad_sequences(training_sequences, maxlen=max_length, padding=padding_type)<br/><br/>testing_sequences = tokenizer.texts_to_sequences(test_sentences)<br/>testing_padded = pad_sequences(testing_sequences, maxlen=max_length, padding=padding_type, truncating=trunc_type)</span></pre><p id="591d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我们已经完成了数据 的<strong class="it hj"> <em class="jp">标记化过程，让我们构建我们的<strong class="it hj"> <em class="jp">模型</em> </strong>。</em></strong></p><h1 id="bb97" class="lh jx hi bd jy li lj lk kc ll lm ln kg lo lp lq kj lr ls lt km lu lv lw kp lx bi translated">构建模型</h1><p id="94ba" class="pw-post-body-paragraph ir is hi it b iu kt iw ix iy ku ja jb jc ly je jf jg lz ji jj jk ma jm jn jo hb bi translated">我们将用<strong class="it hj"> <em class="jp"> LSTM的</em> </strong>来建造我们的<strong class="it hj"> <em class="jp">模型</em> </strong>。<strong class="it hj"><em class="jp"/> </strong>LSTM的具有记忆的优势，这在我们处理语音、文本和股票价格等序列数据时非常有用。基本上，当过去对预测很重要时，我们有连续的数据！</p><p id="fac1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">你可以在<a class="ae iq" href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>中了解更多关于<strong class="it hj"> <em class="jp"> LSTM的</em> </strong>。</p><p id="b406" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">你可以在<a class="ae iq" href="https://github.com/gabrielmayers/fake_news-ai/blob/master/Model.ipynb" rel="noopener ugc nofollow" target="_blank">这个笔记本</a>里看到<strong class="it hj"> <em class="jp">建筑模型</em> </strong>流程。</p><p id="b1da" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">除此之外，我们将使用<a class="ae iq" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"><strong class="it hj"><em class="jp">tensor flow</em></strong></a>来构建我们的模型！</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="2e0b" class="jw jx hi mg b fi mk ml l mm mn">model = tf.keras.models.Sequential()<br/><br/>model.add(tf.keras.layers.Embedding(vocab_size, embedding_dim, input_length=max_length))<br/>model.add(tf.keras.layers.Bidirectional(<br/>    tf.keras.layers.LSTM(300, dropout=0.3, recurrent_dropout=0.3)<br/>))<br/>model.add(tf.keras.layers.Dense(1, activation='sigmoid'))<br/><br/>model.summary()</span></pre><p id="3e14" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们将使用<a class="ae iq" href="https://towardsdatascience.com/understanding-binary-cross-entropy-log-loss-a-visual-explanation-a3ac6025181a" rel="noopener" target="_blank">二元交叉熵</a>损失函数和<a class="ae iq" href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/" rel="noopener ugc nofollow" target="_blank">亚当优化器</a>来编译我们的模型:</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="72fb" class="jw jx hi mg b fi mk ml l mm mn">model.compile(optimizer='adam',<br/>              loss='binary_crossentropy',<br/>              metrics=['accuracy'])</span></pre><p id="8a3a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们将从我们的<strong class="it hj"> <em class="jp">型号</em> </strong>增加一个<a class="ae iq" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping" rel="noopener ugc nofollow" target="_blank">回调</a>来提高火车的时间:</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="4c40" class="jw jx hi mg b fi mk ml l mm mn">cb = tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=2)</span></pre><p id="8f78" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">而现在，是时候训练宝宝了！</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="836d" class="jw jx hi mg b fi mk ml l mm mn">data_model = model.fit(training_padded, train['label'], epochs=50, validation_data=(testing_padded, test['label']), callbacks=[cb])</span></pre><p id="fdbe" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">让我们看看我们的结果:</p><figure class="mb mc md me fd ij er es paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="er es mp"><img src="../Images/de00475817720297a2f0a892b91b1f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Ix9pNZ1RV28uCz7RxmjZA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">还不错…</figcaption></figure><p id="1c99" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如你所见，我通过了设置为<strong class="it hj"><em class="jp">validation _ data</em></strong>的测试，但是可以随意使用它进行预测！</p><p id="4a8e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">实际上，我们可以通过改变<strong class="it hj"><em class="jp"/></strong>的超参数或者使用文本而不仅仅是新闻标题来改进这个<strong class="it hj"> <em class="jp">模型</em> </strong>。</p><p id="b9dc" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但是现在，这是一个很好的方法！</p><p id="5596" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我希望你喜欢这个实际的例子！</p><p id="6bb0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">目前，这就是全部！</p><p id="da0a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">下次见！</p></div><div class="ab cl mu mv gp mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="hb hc hd he hf"><div class="mb mc md me fd nb"><a href="https://mailchi.mp/42ad4556e7c5/sub-medium" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab dw"><div class="nd ab ne cl cj nf"><h2 class="bd hj fi z dy ng ea eb nh ed ef hh bi translated">在我的VIP内容列表订阅！</h2><div class="ni l"><p class="bd b fp z dy ng ea eb nh ed ef dx translated">gabrielmayer.mp</p></div></div></div></a></div><h1 id="448b" class="lh jx hi bd jy li lj lk kc ll lm ln kg lo lp lq kj lr ls lt km lu lv lw kp lx bi translated">在社交网络上与我联系</h1><p id="5488" class="pw-post-body-paragraph ir is hi it b iu kt iw ix iy ku ja jb jc ly je jf jg lz ji jj jk ma jm jn jo hb bi translated">https://www.linkedin.com/in/gabriel-mayer-779b5a162/<strong class="it hj"><em class="jp">领英:</em> </strong> <em class="jp"> </em> <a class="ae iq" href="https://www.linkedin.com/in/gabriel-mayer-779b5a162/" rel="noopener ugc nofollow" target="_blank"/></p><p id="69ba" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">https://github.com/gabrielmayers<strong class="it hj"><em class="jp">github:</em></strong><a class="ae iq" href="https://github.com/gabrielmayers" rel="noopener ugc nofollow" target="_blank"/></p><p id="f373" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">https://www.instagram.com/gabrielmayerl/<strong class="it hj"><em class="jp">insta gram:</em></strong><a class="ae iq" href="https://www.instagram.com/gabrielmayerl/" rel="noopener ugc nofollow" target="_blank"/></p><p id="7d93" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">https://twitter.com/gabrielmayerss<strong class="it hj"><em class="jp">推特:</em> </strong> <a class="ae iq" href="https://twitter.com/gabrielmayerss" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>