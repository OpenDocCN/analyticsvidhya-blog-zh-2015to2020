<html>
<head>
<title>Leveraging Mobile User Demographics to obtain useful insights using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用移动用户统计数据，通过深度学习获得有用的见解</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/leveraging-mobile-user-demographics-to-obtain-useful-insights-using-deep-learning-25081da73fd?source=collection_archive---------19-----------------------#2020-04-01">https://medium.com/analytics-vidhya/leveraging-mobile-user-demographics-to-obtain-useful-insights-using-deep-learning-25081da73fd?source=collection_archive---------19-----------------------#2020-04-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="65a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将回顾我对<a class="ae jd" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/overview" rel="noopener ugc nofollow" target="_blank"> <em class="je">移动用户人口统计数据问题</em> </a>(一场Kaggle竞赛)的解决方案，它让我进入了排行榜的前9%。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/781c4d5e9d695a3ce861f7f801847d60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gktc1t4HhC1EeRsMMfSNA.jpeg"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">照片由<a class="ae jd" href="https://unsplash.com/@coryschadt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">科里·沙伊特</a>在<a class="ae jd" href="https://unsplash.com/s/photos/people-walking--crowd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="d933" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">业务问题和解决问题的潜在价值:</h1><p id="8b7b" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">腾云天下是国内最大的第三方移动数据平台。他们每天处理超过10tb的数据和超过10亿次的会话请求，并提供移动应用分析、移动广告跟踪、移动市场情报和咨询服务。<strong class="ih hj">挑战的重点是建立一个模型，根据用户的应用使用、地理位置和设备属性来预测用户的人口统计特征(年龄组和性别)</strong>。有了这些信息，就有可能增强开发者和广告商的数据驱动营销，并使其与最终用户更加相关。了解移动用户的年龄组和性别对许多公司来说非常重要，因为这有助于他们进行非常有针对性的营销，并相应地呈现内容。</p><h1 id="2f1f" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">理解数据:</strong></h1><p id="4655" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">该问题是一个12类分类问题(即，我们需要预测给定设备id的年龄组和性别)。</p><p id="2397" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据就是从这个kaggle( <a class="ae jd" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/data" rel="noopener ugc nofollow" target="_blank">链接</a>)获得的。它包含以下文件，</p><ol class=""><li id="6c53" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">gender_age_train.csv，gender_age_test.csv-训练和测试，包含我们必须预测年龄和性别的设备id。</li><li id="6bee" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">events.csv，app _ events . CSV——当用户使用TalkingData SDK时，事件连同其时间戳一起被记录在该数据中。每个事件都有一个事件id，位置(纬度/经度)，事件对应app_events中的一个应用列表。</li><li id="a0c3" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">app_labels.csv-包含应用程序及其相应的类别，label_id可用于连接label_categories</li><li id="4ea9" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">label_categories.csv-文本形式的应用程序标签及其类别</li><li id="1be7" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">phone_brand_device_model.csv-包含每个唯一设备id的电话品牌和电话型号</li></ol><h1 id="3dd2" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">关键绩效指标:</strong></h1><p id="8bd5" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">多类日志丢失:每个设备id都有一个真实的类。使用模型，我们估计该设备id属于每个类别的概率。一旦我们有了这个，我们可以计算损失为</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lm"><img src="../Images/ae4d91d4490721be29fd933308ed55b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*03NL4d54-BuHM-rVE4DqCw.jpeg"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">来源:<a class="ae jd" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/overview/evaluation" rel="noopener ugc nofollow" target="_blank"> Kaggle </a></figcaption></figure><p id="4c35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中N表示数据中唯一设备id的数量，M表示数据中唯一类别标签的数量。</p><h1 id="54e5" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">探索性数据分析:</strong></h1><p id="c1b2" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">让我们从分析<strong class="ih hj">训练数据</strong>开始，</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lp"><img src="../Images/e3b03d3b6596473a8b3d508f337ee4b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*uum0G4ZPeCGj5AodhLnldQ.png"/></div></figure><p id="867d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它包含设备id、性别、年龄和年龄组作为特征。让我们找出目标变量的分布</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lq"><img src="../Images/09c0e9f9ec34ce42f7530f713497b9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*UFvitu8RfEIaI0yd99bhCg.png"/></div></figure><p id="0e79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">似乎有一些阶级的不平衡，而且数据包含更多的男性用户比女性用户，让我们看看到底有多少..</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lr"><img src="../Images/cbc324a715dd9277e9736e80d3b9f495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*0h2D_VhsSUzQjR1ojISf2g.png"/></div></figure><p id="2ace" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大约65%的训练数据是男性</p><p id="ab0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">手机品牌和型号分析:</strong></p><p id="130b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初的数据集包含了所有的中文手机品牌。多亏了这个<a class="ae jd" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/22186" rel="noopener ugc nofollow" target="_blank">翻译</a>，映射成了英语。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ls"><img src="../Images/87a40b783462381fcbcf1d2ce5fd39c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D5dS9QtarflYjOqLIC6uPw.png"/></div></div></figure><p id="ce3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从柱状图来看，小米、三星、华为等品牌在市场上占据主导地位，其大多数客户恰好是男性。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lt"><img src="../Images/2b70568963559480f92160a70d45a2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*9k9DalR2f-yh4jSPaOBm3Q.png"/></div></figure><p id="450b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一些必须处理的副本。</p><p id="068d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">事件分析:</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lu"><img src="../Images/65c6d46c72db9ce317e3a0e37c59aef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*veL_w6TSAPI9jIdoz9FJuA.png"/></div></div></figure><p id="8704" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事件id是正在使用的设备的唯一实例。让我们数一数每天发生的事件的数量</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lv"><img src="../Images/7943c6b02152eb07678463e9ae7203d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*O3dB2Ybcpx3778VmGqwwRQ.png"/></div></div></figure><p id="9d6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每天发生的事件数量大致相同，从中没有多少有用的东西:(</p><p id="83b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们试着绘制地理数据并在地图上显示出来</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lw"><img src="../Images/37bc729fb4ff11d9a701c90a500bf007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14UZr7KJTe3O_JNgtGQ2Ig.png"/></div></div></figure><p id="03bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如所料，男性用户占主导地位。此外，大多数用户集中在中国东部地区。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lx"><img src="../Images/ee8e6dd4677af9fc34d945c8be1192f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5QLAnJxhR2hwLbAgzAmNw.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ly"><img src="../Images/0e0d9e4157eaa6845f2f4d20e67a5628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PX1kq-dBC-_xJsqxFuTOPQ.png"/></div></div></figure><p id="4710" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在训练数据中出现的设备id中只有30%出现在事件文件中。</p><p id="3ca9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">app事件分析</strong>:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lz"><img src="../Images/43c595fa3c1b2bad90807fb7558b85a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*e_I60v-Ln1-fBurcX8ypqw.png"/></div></figure><p id="92fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于所有行，is_installed都是1，因此没有使用该功能。我还找到了is_active特性的百分比</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ma"><img src="../Images/367cc6ea4b7b7c85a4d486973e599ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*UoCFxyn_UOms3l7AEcU4xA.png"/></div></figure><p id="4e27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">来自EDA的结论:</strong></p><ol class=""><li id="9906" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">训练数据中的大部分数据来自男性用户(64%)</li><li id="cc03" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">小米、三星、华为是最受用户欢迎的三大手机品牌</li><li id="68ab" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">手机品牌型号文件中有529行重复</li><li id="dc52" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">来自训练和测试的大约31%的数据在事件文件中具有信息</li></ol><h1 id="bab9" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">我解决问题的方法:</strong></h1><p id="bddf" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">值得注意的是，70%的数据不包含事件信息，它们只包含手机品牌和型号信息。</p><ol class=""><li id="04b0" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">将训练数据分成两部分；包含事件信息的数据和不包含事件信息的数据。</li><li id="eb85" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">对于没有事件信息的数据，使用整个训练数据训练具有品牌和模型的模型，并对没有事件信息的测试数据进行预测。</li><li id="b024" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">对于具有事件信息的数据，使用具有事件信息的训练数据，使用来自事件文件的品牌、模型和特征来训练模型，并预测具有事件信息的测试数据。</li><li id="bf34" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">将步骤2和3中的预测连接起来。</li></ol><p id="37e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">特色工程:</strong></p><p id="873f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据不能直接用于操作，因为它分布在多个表中，每个设备id可以有多个事件id，每个事件id可以有多个应用id，每个应用id可以有多个类别。</p><p id="9356" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，让我告诉你一个例子，我如何使用手机品牌来创建一个热门的功能。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="9287" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将一个整数分配给训练数据中唯一的设备id。然后，我们在手机数据帧中对手机品牌进行标签编码。我们在phone和gatrain数据帧之间进行映射(内部连接)。最后，我们使用scipy包中的<a class="ae jd" href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.sparse.csr_matrix.html" rel="noopener ugc nofollow" target="_blank"> csr_matrix </a>来创建一个热特征。</p><p id="6428" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是我如何使用地理数据(纬度和经度)创建要素的另一个例子。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="a5e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个设备id可以有多个纬度和经度条目(如果设备在多个地方使用)。所以把所有这样的纬度组合起来，找到它的中间值。现在，对于每个设备id，我们都有一个中值纬度和中值经度。我们将它们组合并适合kmeans聚类算法以获得10个箱。</p><p id="ca66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要了解更多关于所创建特性的信息，请查看我在文章末尾给出的github repo。</p><p id="8064" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">造型，无事件:</strong></p><p id="5887" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据仅包含电话品牌和电话型号作为一个热点表示(如上所述)。使用80-20列车测试分割。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="3f34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用了下面的神经网络架构。它是从这个<a class="ae jd" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank"> kaggle论坛</a>上引用的。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mb"><img src="../Images/f4fef42f574932505c2499624b590086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F0YhTMxDJj5ksVP1Ced6Rg.png"/></div></div></figure><p id="3b72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我使用了神经网络集成；我用不同的种子训练模型5次，取每个模型预测的平均值。这样做是为了减少一次训练模型时可能出现的高方差。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mc"><img src="../Images/28dd304a7c05eb1b8435cbab69c886e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*3Ad41I8od892mFfwM8OYGw.png"/></div></figure><p id="c532" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些模型的平均对数损失为2.355</p><p id="37e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">造型，带事件:</strong></p><p id="f903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如前所述，我使用事件文件中的附加特性来建模，并使用80–20分割。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="a36f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用了两个模型，取了它们的加权平均值(后面会讨论)。</p><p id="7d5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型1:引自本<a class="ae jd" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank"> Kaggle论坛</a>。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es md"><img src="../Images/d788c27322d834999339bd1ece3afbb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lrp7OxAT8mk3GEZAYPOogw.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es me"><img src="../Images/54272187e092efbdd55d6c5c55fdf9a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*XfkRz1rFqKnGnpL-Q1r3fg.png"/></div></figure><p id="f4fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在对10个这样的模型的总体结果进行平均后，验证对数损失变成1.905</p><p id="8900" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型2:上述神经网络的变体，但是我试验了隐藏层的数量和密集层中神经元的数量。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mf"><img src="../Images/10984b5e3a37879ad544f9a80fa841b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_-i-qmmoI1q_emxpY1jR6A.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mg"><img src="../Images/603fe3f4f2d25a7d50e37a49dfbc0464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*iRMAStqSVwtj33ZisQXl4g.png"/></div></figure><p id="cf6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在对10个这样的模型的总体结果进行平均后，验证对数损失变成1.902</p><p id="2280" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型组装:</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mh"><img src="../Images/6376684abe51cf57bbd1f6f749147685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*XTmbtX6LmaooYHn7M60whQ.png"/></div></figure><p id="aa8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于使用了2个神经网络来预测包含事件信息的数据，我对它们的预测进行了加权平均。由于两个神经网络的验证损失大致相同，我们给予w1和w2相等的权重。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h1 id="6d72" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">结果:</strong></h1><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mi"><img src="../Images/d57587522541181eb4a17854997cdde4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwwsmXcc4Q8u7_hU5e-QFA.png"/></div></div></figure><p id="da95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">私人排行榜得分:</strong> 2.23900</p><p id="5c5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">公众排行榜得分:</strong> 2.23393</p><p id="4fdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种方法让我进入了排行榜的前9%。以下是我试验过的所有模型的总结。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mj"><img src="../Images/68dda1110a71619e6a5bbf08df632686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nsk4o0CQabWe-nmk2c0Rkg.png"/></div></div></figure></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><h1 id="5e2f" class="jv jw hi bd jx jy mr ka kb kc ms ke kf kg mt ki kj kk mu km kn ko mv kq kr ks bi translated"><strong class="ak">进一步改进:</strong></h1><ol class=""><li id="0111" class="ky kz hi ih b ii kt im ku iq mw iu mx iy my jc ld le lf lg bi translated">组装时尝试不同的重量和模型架构。</li><li id="927f" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">添加更多功能，如应用类别的熵，一周中的几天，一周中的几个小时。</li></ol><h1 id="cb7d" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">结论和一些想法:</strong></h1><ol class=""><li id="cbac" class="ky kz hi ih b ii kt im ku iq mw iu mx iy my jc ld le lf lg bi translated">这些数据有很多缺失值，大约70%的数据不包含事件信息。</li><li id="c435" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">这个问题最难的部分是创建特性，因为数据分布在各个表中，每个表都有自己的主键</li><li id="e80b" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">数据被分成两组，包含事件文件的设备和不包含事件文件的设备，分别进行建模，并将其预测连接起来。这给出了最好的结果。</li></ol></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><p id="5830" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管竞赛截止日期已经过了，但通过探索这个案例研究，我们还是学到了很多东西。我希望我能让你理解这个问题。请随意查看我的<a class="ae jd" href="https://github.com/sooryav98/Talking-Data-Mobile-User-Demographics" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中的完整解决方案，并通过<a class="ae jd" href="https://www.linkedin.com/in/soorya-v-11b01917b/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><h2 id="e9fa" class="mz jw hi bd jx na nb nc kb nd ne nf kf iq ng nh kj iu ni nj kn iy nk nl kr nm bi translated"><strong class="ak">感谢阅读:)</strong></h2></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><h1 id="0bf0" class="jv jw hi bd jx jy mr ka kb kc ms ke kf kg mt ki kj kk mu km kn ko mv kq kr ks bi translated"><strong class="ak">参考文献:</strong></h1><ol class=""><li id="147e" class="ky kz hi ih b ii kt im ku iq mw iu mx iy my jc ld le lf lg bi translated"><a class="ae jd" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">应用课程</a></li><li id="5bc2" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><a class="ae jd" href="https://machinelearningmastery.com/model-averaging-ensemble-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/model-averaging-ensemble-for-deep-learning-neural-networks/</a></li><li id="5082" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><a class="ae jd" href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics/discussion/23424" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/talking data-mobile-user-demographics/discussion/23424</a></li><li id="2e04" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><a class="ae jd" href="https://machinelearningmastery.com/weighted-average-ensemble-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/weighted-average-ensemble-for-deep-learning-neural-networks/</a></li></ol></div></div>    
</body>
</html>