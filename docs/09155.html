<html>
<head>
<title>COVID-19 Detector Flask App from Chest X-ray Images with Keras and Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ Keras å’Œæ·±åº¦å­¦ä¹ ä»èƒ¸éƒ¨ X å°„çº¿å›¾åƒä¸­è·å–æ–°å† è‚ºç‚æ¢æµ‹å™¨çƒ§ç“¶åº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/covid-19-detector-flask-app-from-chest-x-ray-images-with-keras-and-deep-learning-fea33baaefdf?source=collection_archive---------7-----------------------#2020-08-27">https://medium.com/analytics-vidhya/covid-19-detector-flask-app-from-chest-x-ray-images-with-keras-and-deep-learning-fea33baaefdf?source=collection_archive---------7-----------------------#2020-08-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a1b4ed7c26011e7570b5739becb932bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0wAPXPV3rL797b-anN3cA.jpeg"/></div></div></figure><h1 id="616f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Kerasã€TensorFlow å’Œæ·±åº¦å­¦ä¹ åœ¨æ‰‹å·¥åˆ›å»ºçš„ X å°„çº¿å›¾åƒæ•°æ®é›†ä¸­<strong class="ak">æ£€æµ‹æ–°å† è‚ºç‚</strong>ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„ Flask åˆ¶ä½œç›¸åŒçš„ web åº”ç”¨ç¨‹åºï¼</h1><p id="d581" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">è¿™æ˜¯æ‚¨çš„ web åº”ç”¨ç¨‹åºçš„å¤–è§‚â€¦</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/955acb155a4c62a823ff096314380e2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GESIegs-Vhw53kbW-6KecQ.jpeg"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">å¸¦æœ‰ Flask çš„æ–°å† è‚ºç‚æ¢æµ‹å™¨ web åº”ç”¨ç¨‹åºçš„å±å¹•æˆªå›¾</figcaption></figure><h2 id="6e32" class="kv ir hi bd is kw kx ky iw kz la lb ja jz lc ld je kd le lf ji kh lg lh jm li bi translated">åœ¨ä»Šå¤©çš„åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•:</h2><ol class=""><li id="146f" class="lj lk hi jq b jr js jv jw jz ll kd lm kh ln kl lo lp lq lr bi translated"><strong class="jq hj">ä¸º<strong class="jq hj">æ£€æµ‹é˜³æ€§</strong>å’Œ<strong class="jq hj">æ­£å¸¸</strong>çš„æ‚£è€…<strong class="jq hj"> X å°„çº¿å›¾åƒ</strong>ä¸‹è½½</strong>å¼€æºæ•°æ®é›†<strong class="jq hj">æ–°å† è‚ºç‚</strong>(é“¾æ¥ä¼šæåˆ°)</li><li id="4b6b" class="lj lk hi jq b jr ls jv lt jz lu kd lv kh lw kl lo lp lq lr bi translated"><strong class="jq hj">é¢„å¤„ç†</strong>å¹¶åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„â€œæ•°æ®é›†â€æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«è¿‡æ»¤å‡ºçš„â€œæ­£å¸¸â€å’Œâ€œCovidâ€X å°„çº¿å›¾åƒï¼Œä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚</li><li id="4cf3" class="lj lk hi jq b jr ls jv lt jz lu kd lv kh lw kl lo lp lq lr bi translated"><strong class="jq hj">æ„å»º CNN </strong>é€šè¿‡æˆ‘ä»¬åˆ›å»ºçš„æ•°æ®é›†è‡ªåŠ¨æ£€æµ‹ X å°„çº¿å›¾åƒä¸­çš„æ–°å† è‚ºç‚ã€‚</li><li id="de46" class="lj lk hi jq b jr ls jv lt jz lu kd lv kh lw kl lo lp lq lr bi translated"><strong class="jq hj">è®­ç»ƒ</strong>æˆ‘ä»¬çš„ CNNï¼Œçœ‹<strong class="jq hj">æµ‹è¯•/éªŒè¯æ•°æ®</strong>ä¸Šçš„<strong class="jq hj">ç²¾åº¦</strong>ã€‚</li><li id="efd3" class="lj lk hi jq b jr ls jv lt jz lu kd lv kh lw kl lo lp lq lr bi translated">åˆ›å»º Flask Web åº”ç”¨ç¨‹åºã€‚</li></ol><blockquote class="lx ly lz"><p id="157e" class="jo jp ma jq b jr mb jt ju jv mc jx jy md me kb kc mf mg kf kg mh mi kj kk kl hb bi translated"><strong class="jq hj">æ³¨</strong>:æœ¬åšå®¢åŠæä¾›çš„ç›¸å…³èµ„æºä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸å£°ç§°ä»»ä½•çœŸå®çš„è¯Šæ–­æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³ä»æ•™è‚²çš„è§’åº¦æ¥é˜…è¯»ï¼Œè¯·ç»§ç»­é˜…è¯»ï¼</p></blockquote><h1 id="022a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">å¥½å§ï¼æ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ï¼</h1><h2 id="4d67" class="kv ir hi bd is kw kx ky iw kz la lb ja jz lc ld je kd le lf ji kh lg lh jm li bi translated">æ­¥éª¤ 1-ä»ä»¥ä¸‹é“¾æ¥ä¸‹è½½æ•°æ®é›†:</h2><ul class=""><li id="94b1" class="lj lk hi jq b jr js jv jw jz ll kd lm kh ln kl mj lp lq lr bi translated">åŒ…å« Covid19 é˜³æ€§ X å°„çº¿å›¾åƒçš„æ•°æ®é›†</li></ul><div class="mk ml ez fb mm mn"><a href="https://github.com/ieee8023/covid-chestxray-dataset" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hj fi z dy ms ea eb mt ed ef hh bi translated">IEEE 8023/covid-chest Xray-dataset</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">ğŸ›‘æ³¨æ„:è¯·ä¸è¦å£°ç§°æ²¡æœ‰ä¸´åºŠç ”ç©¶çš„æ¨¡å‹çš„è¯Šæ–­æ€§èƒ½ï¼è¿™ä¸æ˜¯ä¸€ä¸ª kaggleâ€¦</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">github.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb io mn"/></div></div></a></div><ul class=""><li id="e767" class="lj lk hi jq b jr mb jv mc jz nc kd nd kh ne kl mj lp lq lr bi translated">åŒ…å« Covid19 è´Ÿ X å°„çº¿å›¾åƒçš„æ•°æ®é›†</li></ul><div class="mk ml ez fb mm mn"><a href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hj fi z dy ms ea eb mt ed ef hh bi translated">èƒ¸éƒ¨ x å…‰å›¾åƒ(è‚ºç‚)</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">5ï¼Œ863 å¼ å›¾ç‰‡ï¼Œ2 ä¸ªç±»åˆ«</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">www.kaggle.com</p></div></div><div class="mw l"><div class="nf l my mz na mw nb io mn"/></div></div></a></div><h2 id="d38b" class="kv ir hi bd is kw kx ky iw kz la lb ja jz lc ld je kd le lf ji kh lg lh jm li bi translated">ç¬¬ 2 æ­¥-æ•°æ®é¢„å¤„ç†:</h2><p id="5e5d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»ä¸‹è½½äº†æ‰€éœ€çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬éœ€è¦é¢„å¤„ç†æˆ‘ä»¬çš„æ•°æ®ï¼Œä»¥è¿‡æ»¤å‡ºâ€œCovidâ€å’Œâ€œæ­£å¸¸â€æƒ…å†µï¼Œæ”¾å…¥æˆ‘ä»¬æ–°çš„é¢„å¤„ç†â€œæ•°æ®é›†â€æ–‡ä»¶å¤¹ä¸­ã€‚</p><p id="0527" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">å¯¼å…¥å¿…è¦çš„åº“å¹¶ä¸º covid é˜³æ€§æ•°æ®é›†çš„æ–‡ä»¶å’Œå›¾åƒæ·»åŠ æ˜ç¡®çš„è·¯å¾„-</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="a980" class="kv ir hi nh b fi nl nm l nn no"><strong class="nh hj">import</strong> pandas <strong class="nh hj">as</strong> pd<br/><strong class="nh hj">import</strong> os<br/><strong class="nh hj">import</strong> shutil</span><span id="79a7" class="kv ir hi nh b fi np nm l nn no"><em class="ma"># create a data for the covid +ve samples (ieee real world dataset)</em><br/><br/>FILE_PATH <strong class="nh hj">=</strong> "covid-chestxray-dataset-master/metadata.csv"<br/>IMAGES_PATH <strong class="nh hj">=</strong> "covid-chestxray-dataset-master/images"</span></pre><p id="737f" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">åŠ è½½æ•°æ®é›†å¹¶æ£€æŸ¥å…¶å½¢çŠ¶-</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="acde" class="kv ir hi nh b fi nl nm l nn no">df <strong class="nh hj">=</strong> pd<strong class="nh hj">.</strong>read_csv(FILE_PATH)<br/>print(df<strong class="nh hj">.</strong>shape)</span><span id="db5a" class="kv ir hi nh b fi np nm l nn no">#o/p - (930, 29)</span></pre><p id="ddef" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">åˆ›å»ºç›®æ ‡ç›®å½•â€œæ•°æ®é›†â€ä»¥è¿‡æ»¤å‡ºå¹¶å­˜å‚¨ covid é˜³æ€§å›¾åƒæ•°æ®ä¸ºâ€œCovidâ€</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="f58d" class="kv ir hi nh b fi nl nm l nn no">TARGET_DIR <strong class="nh hj">=</strong> "Dataset/Covid"<br/><br/><br/><strong class="nh hj">if</strong> <strong class="nh hj">not</strong> os<strong class="nh hj">.</strong>path<strong class="nh hj">.</strong>exists(TARGET_DIR):<br/>    os<strong class="nh hj">.</strong>mkdir(TARGET_DIR)<br/>    print("Covid folder created")</span></pre><p id="2a56" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">å°†æ‰€æœ‰æ–°å† è‚ºç‚é˜³æ€§å›¾åƒä»ä¸‹è½½çš„æ•°æ®é›†ä¸­å¤åˆ¶åˆ°æˆ‘ä»¬è‡ªå·±çš„ç›®æ ‡ç›®å½•â€œæ•°æ®é›†â€çš„â€œcovidâ€æ–‡ä»¶å¤¹ä¸­-</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="e5c2" class="kv ir hi nh b fi nl nm l nn no">cnt <strong class="nh hj">=</strong> 0<br/><br/><strong class="nh hj">for</strong> (i,row) <strong class="nh hj">in</strong> df<strong class="nh hj">.</strong>iterrows(): <br/>    <strong class="nh hj">if</strong> row["finding"] <strong class="nh hj">==</strong> "COVID-19" <strong class="nh hj">and</strong> row["view"]<strong class="nh hj">==</strong>"PA":<br/>        filename <strong class="nh hj">=</strong> row["filename"]<br/>        image_path <strong class="nh hj">=</strong> os<strong class="nh hj">.</strong>path<strong class="nh hj">.</strong>join(IMAGES_PATH,filename)<br/>        image_copy_path <strong class="nh hj">=</strong> os<strong class="nh hj">.</strong>path<strong class="nh hj">.</strong>join(TARGET_DIR)<br/>        shutil<strong class="nh hj">.</strong>copy2(image_path,image_copy_path)<br/>        print('Moving image', cnt)<br/>        <br/>        cnt <strong class="nh hj">+=</strong> 1<br/>print(cnt)</span></pre><p id="a657" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">Kaggle æ­£å¸¸/ Covid19 é˜´æ€§æ•°æ®é›†çš„å›¾åƒé‡‡æ ·-</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="b13c" class="kv ir hi nh b fi nl nm l nn no"><em class="ma"># sampling of images from the kaggle dataset (normal and pneumonia patients)</em><br/><br/><strong class="nh hj">import</strong> random<br/>KAGGLE_FILE_PATH <strong class="nh hj">=</strong> "chest_xray/train/NORMAL"<br/>TARGET_NORMAL_DIR <strong class="nh hj">=</strong> "Dataset/Normal"</span></pre><p id="6d21" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">å°†ä¸‹è½½çš„ Kaggle æ•°æ®é›†ä¸­çš„æ‰€æœ‰æ–°å† è‚ºç‚é˜´æ€§(æ­£å¸¸)å›¾åƒå¤åˆ¶åˆ°æˆ‘ä»¬è‡ªå·±çš„ç›®æ ‡ç›®å½•â€œæ­£å¸¸â€æ–‡ä»¶å¤¹ä¸‹çš„â€œæ•°æ®é›†â€ä¸­-</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="a479" class="kv ir hi nh b fi nl nm l nn no"><strong class="nh hj">for</strong> i <strong class="nh hj">in</strong> range(180):<br/>    <br/>    image_name <strong class="nh hj">=</strong> image_names[i]<br/>    image_path <strong class="nh hj">=</strong> os<strong class="nh hj">.</strong>path<strong class="nh hj">.</strong>join(KAGGLE_FILE_PATH,image_name)<br/>    <br/>    target_path <strong class="nh hj">=</strong> os<strong class="nh hj">.</strong>path<strong class="nh hj">.</strong>join(TARGET_NORMAL_DIR, image_name)<br/>    <br/>    shutil<strong class="nh hj">.</strong>copy2(image_path, target_path)<br/>    <br/>    print("Copying image ",i)</span><span id="c30e" class="kv ir hi nh b fi np nm l nn no">image_names <strong class="nh hj">=</strong> os<strong class="nh hj">.</strong>listdir(KAGGLE_FILE_PATH)</span></pre><h1 id="3931" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">è€¶ï¼</h1><p id="a17e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">æˆ‘ä»¬å·²ç»å®Œæˆäº†æ•°æ®é¢„å¤„ç†ä»»åŠ¡ï¼Œç°åœ¨æ‚¨å·²ç»æœ‰äº†ä¸€ä¸ªâ€œæ•°æ®é›†â€æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰ç»è¿‡è¿‡æ»¤çš„â€œCovidâ€å’Œâ€œæ­£å¸¸â€å›¾åƒæ•°æ®ï¼</p><h2 id="3956" class="kv ir hi bd is kw kx ky iw kz la lb ja jz lc ld je kd le lf ji kh lg lh jm li bi translated">æ­¥éª¤ 3-ä½¿ç”¨ Keras æ„å»º CNN æ¨¡å‹ï¼Œé€šè¿‡æˆ‘ä»¬åˆ›å»ºçš„æ•°æ®é›†è‡ªåŠ¨æ£€æµ‹ X å°„çº¿å›¾åƒä¸­çš„æ–°å† è‚ºç‚:</h2><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es nq"><img src="../Images/026cf05c134340b91d521eb497b607f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*Kmw_qW9u8kN7TVHlx5gvQw.jpeg"/></div></figure><p id="4655" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†æŠŠå„è‡ªçš„è·¯å¾„åˆ†é…ç»™æˆ‘ä»¬çš„è®­ç»ƒå’ŒéªŒè¯é›†(å·²ç»ç”± Kaggle æä¾›),å¹¶å¯¼å…¥å¿…è¦çš„æ¨¡å‹</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="ce4b" class="kv ir hi nh b fi nl nm l nn no">TRAIN_PATH <strong class="nh hj">=</strong> "CovidDataset/Train"<br/>VAL_PATH <strong class="nh hj">=</strong> "CovidDataset/Val"</span><span id="0444" class="kv ir hi nh b fi np nm l nn no"><strong class="nh hj">import</strong> numpy <strong class="nh hj">as</strong> np<br/><strong class="nh hj">import</strong> matplotlib.pyplot <strong class="nh hj">as</strong> plt<br/><strong class="nh hj">import</strong> keras<br/><strong class="nh hj">from</strong>  keras.layers <strong class="nh hj">import</strong> <strong class="nh hj">*</strong><br/><strong class="nh hj">from</strong> keras.models <strong class="nh hj">import</strong> <strong class="nh hj">*</strong><br/><strong class="nh hj">from</strong> keras.preprocessing <strong class="nh hj">import</strong> image</span></pre><p id="f177" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">(åœ¨è¿™é‡Œï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå•ç‹¬çš„â€˜covid datasetâ€™æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­å¤åˆ¶äº† Train å’Œ Val é›†åˆï¼Œä»¥ä¾¿äºåŒºåˆ†å’Œè°ƒç”¨ã€‚)</p><p id="2860" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Keras æ„å»ºæˆ‘ä»¬çš„æ¨¡å‹ã€‚æˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œæ¥è§£å†³æˆ‘ä»¬çš„ç›®çš„-</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="541b" class="kv ir hi nh b fi nl nm l nn no"><em class="ma"># Building the Convolutional Neural Network with Keras</em><br/>model <strong class="nh hj">=</strong> Sequential()<br/>model<strong class="nh hj">.</strong>add(Conv2D(32,kernel_size<strong class="nh hj">=</strong>(3,3),activation<strong class="nh hj">=</strong>'relu',input_shape <strong class="nh hj">=</strong>(224,224,3)))<br/><br/>model<strong class="nh hj">.</strong>add(Conv2D(64,(3,3), activation <strong class="nh hj">=</strong> 'relu'))<br/>model<strong class="nh hj">.</strong>add(MaxPooling2D(pool_size<strong class="nh hj">=</strong>(2,2)))<br/>model<strong class="nh hj">.</strong>add(Dropout(0.25))<br/><br/>model<strong class="nh hj">.</strong>add(Conv2D(64,(3,3),activation <strong class="nh hj">=</strong> 'relu'))<br/>model<strong class="nh hj">.</strong>add(MaxPooling2D(pool_size<strong class="nh hj">=</strong>(2,2)))<br/>model<strong class="nh hj">.</strong>add(Dropout(0.25))<br/><br/>model<strong class="nh hj">.</strong>add(Conv2D(128,(3,3), activation<strong class="nh hj">=</strong>'relu'))<br/>model<strong class="nh hj">.</strong>add(MaxPooling2D(pool_size<strong class="nh hj">=</strong>(2,2)))<br/>model<strong class="nh hj">.</strong>add(Dropout(0.25))<br/><br/>model<strong class="nh hj">.</strong>add(Flatten())<br/>model<strong class="nh hj">.</strong>add(Dense(64, activation<strong class="nh hj">=</strong>'relu'))<br/>model<strong class="nh hj">.</strong>add(Dropout(0.5))<br/>model<strong class="nh hj">.</strong>add(Dense(1,activation<strong class="nh hj">=</strong>'sigmoid'))<br/><br/>model<strong class="nh hj">.</strong>compile(loss <strong class="nh hj">=</strong> keras<strong class="nh hj">.</strong>losses<strong class="nh hj">.</strong>binary_crossentropy, optimizer<strong class="nh hj">=</strong>'adam',metrics <strong class="nh hj">=</strong> ['accuracy'])</span></pre><p id="42c9" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ‰“å°å‡ºæ¨¡å‹çš„æ‘˜è¦æŠ¥å‘Šï¼Œæˆ–è€…åŸºæœ¬ä¸Šæ˜¯æ¨¡å‹æ¶æ„æ‘˜è¦-</p><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="c55a" class="kv ir hi nh b fi nl nm l nn no"><em class="ma">#print out the architectural summary of the model</em><br/>model<strong class="nh hj">.</strong>summary()</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es nr"><img src="../Images/ac3d821e1370714c5de918d1ff7aca7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*l1u3fSAWJcF2rdKzS8eUyg.png"/></div></figure><blockquote class="ns"><p id="3c92" class="nt nu hi bd nv nw nx ny nz oa ob kl dx translated">ä¸‡å²ï¼æˆ‘ä»¬çš„ CNN æ¨¡ç‰¹å·²ç»å‡†å¤‡å¥½æ¥å—è®­ç»ƒäº†ï¼</p></blockquote><h2 id="e883" class="kv ir hi bd is kw oc ky iw kz od lb ja jz oe ld je kd of lf ji kh og lh jm li bi translated">æ­¥éª¤ 4-è®­ç»ƒ CNN æ¨¡å‹</h2><pre class="kn ko kp kq fd ng nh ni nj aw nk bi"><span id="02ab" class="kv ir hi nh b fi nl nm l nn no"><em class="ma"># Let's do the training !</em><br/>train_data_gen <strong class="nh hj">=</strong> image<strong class="nh hj">.</strong>ImageDataGenerator(<br/>    <br/>    rescale <strong class="nh hj">=</strong> 1.<strong class="nh hj">/</strong>255,<br/>    shear_range <strong class="nh hj">=</strong> 0.2,<br/>    zoom_range <strong class="nh hj">=</strong> 0.2,<br/>    horizontal_flip <strong class="nh hj">=</strong> <strong class="nh hj">True</strong>,<br/>)<br/><br/>test_dataset <strong class="nh hj">=</strong> image<strong class="nh hj">.</strong>ImageDataGenerator(rescale<strong class="nh hj">=</strong>1.<strong class="nh hj">/</strong>255)</span><span id="83e1" class="kv ir hi nh b fi np nm l nn no">train_generator <strong class="nh hj">=</strong> train_data_gen<strong class="nh hj">.</strong>flow_from_directory(<br/>    'CovidDataset/CovidDataset/Train',<br/>    target_size <strong class="nh hj">=</strong> (224,224),<br/>    batch_size <strong class="nh hj">=</strong> 32,<br/>    class_mode <strong class="nh hj">=</strong> 'binary')</span><span id="3b3a" class="kv ir hi nh b fi np nm l nn no">validation_generator <strong class="nh hj">=</strong> test_dataset<strong class="nh hj">.</strong>flow_from_directory(<br/>    'CovidDataset/CovidDataset/Val',<br/>    target_size <strong class="nh hj">=</strong> (224,224),<br/>    batch_size <strong class="nh hj">=</strong> 32,<br/>    class_mode <strong class="nh hj">=</strong> 'binary'<br/>)</span><span id="16af" class="kv ir hi nh b fi np nm l nn no">hist <strong class="nh hj">=</strong> model<strong class="nh hj">.</strong>fit_generator(<br/>    train_generator,<br/>    steps_per_epoch <strong class="nh hj">=</strong> 7,<br/>    epochs <strong class="nh hj">=</strong> 11,<br/>    validation_data <strong class="nh hj">=</strong> validation_generator,<br/>    validation_steps <strong class="nh hj">=</strong> 2<br/>)</span></pre><p id="4a96" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">åœ¨æˆ‘æˆåŠŸæ‰§è¡Œè¿™ä¸ªä¹‹åï¼Œæˆ‘åœ¨ç¬¬ 11 ä¸ªçºªå…ƒå¾—åˆ°äº† 98.33% çš„<strong class="jq hj">æµ‹è¯•ç²¾åº¦ã€‚</strong></p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es oh"><img src="../Images/bd9122d115ff7a9e107985f1994a45c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZuCgGrHXT6QFXCjWtELxFw.png"/></div></div></figure><p id="0b9d" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">å¬èµ·æ¥å¾ˆæ£’ï¼Œå¯¹å§ï¼Ÿï¼</p><h2 id="fc41" class="kv ir hi bd is kw kx ky iw kz la lb ja jz lc ld je kd le lf ji kh lg lh jm li bi translated">è€¶ï¼</h2><h2 id="427d" class="kv ir hi bd is kw kx ky iw kz la lb ja jz lc ld je kd le lf ji kh lg lh jm li bi translated">ç°åœ¨è®©æˆ‘ä»¬ä¸“æ³¨äºåˆ›å»ºæˆ‘ä»¬çš„ Flask åº”ç”¨ç¨‹åºï¼</h2><p id="b4cd" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">å¯¹äº Flask web åº”ç”¨ç¨‹åºï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºâ€œWebappâ€çš„å•ç‹¬ç›®å½•ï¼Œå¹¶åˆ›å»ºä»¥ä¸‹å†…å®¹</p><ol class=""><li id="08d1" class="lj lk hi jq b jr mb jv mc jz nc kd nd kh ne kl lo lp lq lr bi translated">ä¸€ä¸ªâ€œ<strong class="jq hj">æ¨¡æ¿</strong>æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­å°†åŒ…å« index.html æ–‡ä»¶ã€‚</li><li id="9e97" class="lj lk hi jq b jr ls jv lt jz lu kd lv kh lw kl lo lp lq lr bi translated">ä¸€ä¸ªâ€œ<strong class="jq hj">æ¨¡ç‰¹</strong>æ–‡ä»¶å¤¹ï¼Œé‡Œé¢ä¼šæœ‰ä½ è®­ç»ƒè¿‡çš„ CNN æ¨¡ç‰¹ã€‚</li><li id="123b" class="lj lk hi jq b jr ls jv lt jz lu kd lv kh lw kl lo lp lq lr bi translated">ä¸€ä¸ª'<strong class="jq hj"> app.py </strong> ' (python)æ–‡ä»¶å°†åŒ…å«æˆ‘ä»¬çš„ web åº”ç”¨ç¨‹åºçš„ flask ä»£ç ã€‚</li></ol><h2 id="887e" class="kv ir hi bd is kw kx ky iw kz la lb ja jz lc ld je kd le lf ji kh lg lh jm li bi translated">æ­¥éª¤ 5- Flask Web åº”ç”¨ç¨‹åºä»£ç å’Œ index.html æ–‡ä»¶</h2><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="oi oj l"/></div></figure><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="oi oj l"/></div></figure><p id="a3ea" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">æ‚¨çš„æ–°å† è‚ºç‚æ£€æµ‹å™¨ WEB åº”ç”¨ç¨‹åºå·²ç»å‡†å¤‡å¥½äº†ï¼ï¼</p><p id="d06d" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„ GitHub repo ä¸Šæ‰¾åˆ°ã€‚:)</p><p id="6d6d" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡åšæ–‡å¹¶ä»ä¸­å¾—åˆ°ä¹è¶£ï¼</p><blockquote class="lx ly lz"><p id="ae21" class="jo jp ma jq b jr mb jt ju jv mc jx jy md me kb kc mf mg kf kg mh mi kj kk kl hb bi translated">å…è´£å£°æ˜- <strong class="jq hj">è¯·è®°ä½ï¼Œæœ¬åšå®¢ä¸­æ¶‰åŠçš„æ–°å† è‚ºç‚æ¢æµ‹å™¨ä»…ç”¨äº<em class="hi">æ•™è‚²ç›®çš„ã€‚</em> </strong>æˆ‘çš„ç›®æ ‡æ˜¯æ¿€åŠ±æ·±åº¦å­¦ä¹ çš„å®è·µè€…ï¼Œæ¯”å¦‚æˆ‘è‡ªå·±ï¼Œä½ ï¼Œå¹¶çå¼€ä½ çš„çœ¼ç›ï¼Œçœ‹çœ‹æ·±åº¦å­¦ä¹ å’Œè®¡ç®—æœºè§†è§‰å¦‚ä½•èƒ½å¤Ÿå¯¹ä¸–ç•Œäº§ç”Ÿ<em class="hi">å¤§å½±å“</em>ã€‚</p></blockquote><p id="2b5e" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">å¿«ä¹æ·±åº¦å­¦ä¹ ï¼</p><p id="e771" class="pw-post-body-paragraph jo jp hi jq b jr mb jt ju jv mc jx jy jz me kb kc kd mg kf kg kh mi kj kk kl hb bi translated">ç›´åˆ°ä¸‹æ¬¡..ï¼</p></div></div>    
</body>
</html>