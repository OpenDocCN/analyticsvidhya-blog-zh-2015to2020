<html>
<head>
<title>Content-based Recommender Systems in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中基于内容的推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/content-based-recommender-systems-in-python-2b330e01eb80?source=collection_archive---------1-----------------------#2020-01-02">https://medium.com/analytics-vidhya/content-based-recommender-systems-in-python-2b330e01eb80?source=collection_archive---------1-----------------------#2020-01-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="437e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><em class="ix">本博客用python </em>说明了一个 <strong class="ak"> <em class="ix">基于内容的推荐系统</em> </strong> <em class="ix"/></h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/521b6a72ed00df9f87695856a289fbca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lhH61OnvbJFWrykk.png"/></div></div></figure><p id="cdb7" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">这是我在从2020年开始的新十年中的第一个博客系列，因此我非常兴奋。在开始用python演示基于内容的推荐系统之前，我建议您花4分钟阅读这篇博客，它用外行的术语定义了推荐系统及其类型。</p><p id="f8c3" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><a class="ae kg" rel="noopener" href="/@saketgarodia/the-world-of-recommender-systems-e4ea504341ac?source=friends_link&amp;sk=508a980d8391daa93530a32e9c927a87">https://medium . com/@ saketgarodia/the-world-of-recommender-systems-e4ea 504341 AC？source = friends _ link&amp;sk = 508 a 980d 8391 DAA 93530 a 32 e 9c 927 a 87</a></p><p id="ce85" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">通过这篇博客，我将展示如何在Kaggle的MovieLens 100k数据集上用Python实现一个基于内容的推荐系统。</p><div class="kh ki ez fb kj kk"><a href="https://www.kaggle.com/prajitdatta/movielens-100k-dataset" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hj fi z dy kp ea eb kq ed ef hh bi translated">MovieLens 100K数据集</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">稳定的基准数据集。1000名用户对1700部电影的100，000次评分</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">www.kaggle.com</p></div></div><div class="kt l"><div class="ku l kv kw kx kt ky ji kk"/></div></div></a></div><p id="87bf" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">让我们开始实施它。</p><h1 id="3b06" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated"><strong class="ak">问题表述</strong></h1><p id="68a5" class="pw-post-body-paragraph jk jl hi jm b jn lr ij jp jq ls im js jt lt jv jw jx lu jz ka kb lv kd ke kf hb bi translated"><em class="lw">构建一个推荐系统，根据之前看过的电影的剧情推荐电影。</em></p><h1 id="a38c" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated">履行</h1><p id="b6aa" class="pw-post-body-paragraph jk jl hi jm b jn lr ij jp jq ls im js jt lt jv jw jx lu jz ka kb lv kd ke kf hb bi translated">首先，让我们导入所有必要的库，我们将使用它们来创建一个基于内容的推荐系统。让我们也导入必要的数据文件。</p><pre class="iz ja jb jc fd lx ly lz ma aw mb bi"><span id="e754" class="mc la hi ly b fi md me l mf mg">#importing necessary libraries</span><span id="b301" class="mc la hi ly b fi mh me l mf mg">import numpy as np</span><span id="ea99" class="mc la hi ly b fi mh me l mf mg">import pandas as pd</span><span id="1975" class="mc la hi ly b fi mh me l mf mg">from sklearn.metrics.pairwise import cosine_similarity</span><span id="43a3" class="mc la hi ly b fi mh me l mf mg">from sklearn.metrics import mean_squared_error</span><span id="8a74" class="mc la hi ly b fi mh me l mf mg">from sklearn.model_selection import train_test_split</span><span id="ffb3" class="mc la hi ly b fi mh me l mf mg">from sklearn.feature_extraction.text import TfidfVectorizer</span><span id="d310" class="mc la hi ly b fi mh me l mf mg">from sklearn.metrics.pairwise import linear_kernel</span><span id="e257" class="mc la hi ly b fi mh me l mf mg">#putting movies data on 'movies' dataframe</span><span id="c12e" class="mc la hi ly b fi mh me l mf mg">movies = pd.read_csv('movies_metadata.csv')</span></pre><p id="78bc" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">因为我们正在构建一个基于情节的推荐系统，所以让我们只选择我们将要使用的列。我们将使用电影'<em class="lw"> id' </em>、电影'<em class="lw">标题</em>和'<em class="lw">概述</em> ' ( <em class="lw">概述</em>详述每部电影的情节)。</p><p id="eae8" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">这是现在的数据。</p><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mi"><img src="../Images/79394350b5b633ce2f5d0b17d4df1d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*SJz4QhdYWhiT-MvefdiMeA.png"/></div></figure><p id="8c99" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">让我们看看电影情节在数据集中是什么样子的。</p><pre class="iz ja jb jc fd lx ly lz ma aw mb bi"><span id="37e5" class="mc la hi ly b fi md me l mf mg">movies[‘overview’][0]</span></pre><p id="33e1" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">电影《玩具总动员》的剧情在数据集中是这样的:<em class="lw">“在伍迪的带领下，安迪的玩具们在他的房间里快乐地生活，直到安迪的生日将巴斯光年带到了现场。由于害怕失去在安迪心中的地位，伍迪密谋反对巴兹。但当情况将巴斯和伍迪与它们的主人分开时，这对搭档最终学会了抛开他们的分歧。</em></p><p id="f928" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">我们有一个大约45466部电影的数据集，足以建立一个基于情节向我们推荐电影的模型。这将会非常有趣。</p><p id="ce9a" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">作为<strong class="jm hj">的第一步</strong>，我们将使用<strong class="jm hj"> TfidfVectorizer </strong>，它将基本上把我们的'<strong class="jm hj"> overview </strong>'(一个文本列)转换成数字。由于计算机只能理解0和1，所以所有的数据科学模型都是基于数值运行的。</p><p id="745b" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">TF-IDF基本上就是<strong class="jm hj">词频-逆文档频</strong>。它创建的特征数量等于概览列中使用的不同单词的总数，并且这些值与特定单词的使用次数成正比，与使用该单词的文档(此处为电影)的数量成反比。它会处罚一个单词，即使这个单词在一部电影中有很大的数量，但在许多电影中是常见的。在许多电影中多次出现但却很常见的词无论如何都不能帮助区分不同的电影。</p><pre class="iz ja jb jc fd lx ly lz ma aw mb bi"><span id="b8d3" class="mc la hi ly b fi md me l mf mg">tfidf = TfidfVectorizer(stop_words=’english’)</span><span id="8819" class="mc la hi ly b fi mh me l mf mg">movies[‘overview’] = movies[‘overview’].fillna(‘’)</span><span id="284b" class="mc la hi ly b fi mh me l mf mg">#Construct the required TF-IDF matrix by applying the fit_transform method on the overview feature</span><span id="67a1" class="mc la hi ly b fi mh me l mf mg">overview_matrix = tfidf.fit_transform(movies[‘overview’])</span><span id="d434" class="mc la hi ly b fi mh me l mf mg">#Output the shape of tfidf_matrix</span><span id="a5bc" class="mc la hi ly b fi mh me l mf mg">overview_matrix.shape</span><span id="690b" class="mc la hi ly b fi mh me l mf mg">#Output<br/>(45466, 75827)</span></pre><p id="38b6" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">现在，我们有了所有电影的“tfidf”特征矩阵。每部电影都有<strong class="jm hj"> 75927 </strong>个<strong class="jm hj">个</strong>个【字】。现在，为了找到电影之间的相似性，我们将使用<strong class="jm hj">余弦_相似性。</strong>在我们的例子中，<strong class="jm hj"> </strong> linear_kernel函数将为我们进行同样的计算。</p><p id="fd1b" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated"><strong class="jm hj">余弦_相似度</strong>基本上是2个向量之间相似度的度量。这个度量是它们之间角度的余弦。这里，每部电影有75927个特征(tfidf值)。现在让我们使用线性核函数来找到相似性矩阵:</p><pre class="iz ja jb jc fd lx ly lz ma aw mb bi"><span id="72f8" class="mc la hi ly b fi md me l mf mg">similarity_matrix = linear_kernel(overview_matrix,overview_matrix)</span><span id="1a5f" class="mc la hi ly b fi mh me l mf mg">similarity_matrix</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mj"><img src="../Images/9f1c9201b9aea118618f01266a817630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*T_IfPfAk5397l123maGiqg.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">相似矩阵</figcaption></figure><p id="f6ab" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">现在，让我们创建一个系列，将矩阵的索引映射到电影名称，这样我们只需输入电影名称就可以轻松获得推荐。</p><pre class="iz ja jb jc fd lx ly lz ma aw mb bi"><span id="30d8" class="mc la hi ly b fi md me l mf mg">#movies index mapping</span><span id="0ebc" class="mc la hi ly b fi mh me l mf mg">mapping = pd.Series(movies.index,index = movies[‘title’])</span><span id="671a" class="mc la hi ly b fi mh me l mf mg">mapping</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mo"><img src="../Images/925ec45f1af5bdc20e2c57050addbcac.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*2uNPafap2HpTdoW_FCTv0A.png"/></div></figure><p id="b258" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">现在，我们将制作一个<strong class="jm hj">推荐函数</strong>，它将使用余弦相似度为我们推荐电影。我们的函数将电影名称作为输入，然后使用上面找到的余弦相似性矩阵找到前15部电影。</p><pre class="iz ja jb jc fd lx ly lz ma aw mb bi"><span id="0163" class="mc la hi ly b fi md me l mf mg"><strong class="ly hj">def recommend_movies_based_on_plot(movie_input):</strong></span><span id="8d16" class="mc la hi ly b fi mh me l mf mg">movie_index = mapping[movie_input]</span><span id="acff" class="mc la hi ly b fi mh me l mf mg">#get similarity values with other movies</span><span id="f80e" class="mc la hi ly b fi mh me l mf mg">#similarity_score is the list of index and similarity matrix</span><span id="84a3" class="mc la hi ly b fi mh me l mf mg">similarity_score = list(enumerate(similarity_matrix[movie_index]))</span><span id="3de1" class="mc la hi ly b fi mh me l mf mg">#sort in descending order the similarity score of movie inputted with all the other movies</span><span id="cf72" class="mc la hi ly b fi mh me l mf mg">similarity_score = sorted(similarity_score, key=lambda x: x[1], reverse=True)</span><span id="bbff" class="mc la hi ly b fi mh me l mf mg"># Get the scores of the 15 most similar movies. Ignore the first movie.</span><span id="a0ea" class="mc la hi ly b fi mh me l mf mg">similarity_score = similarity_score[1:15]</span><span id="c6f3" class="mc la hi ly b fi mh me l mf mg">#return movie names using the mapping series</span><span id="a55a" class="mc la hi ly b fi mh me l mf mg">movie_indices = [i[0] for i in similarity_score]</span><span id="e595" class="mc la hi ly b fi mh me l mf mg">return (movies[‘title’].iloc[movie_indices])</span></pre><p id="6d48" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">现在让我们试着从上面的推荐函数中获取一个关于电影《安迪·哈代的生活》的推荐，看看它会输出什么。</p><pre class="iz ja jb jc fd lx ly lz ma aw mb bi"><span id="14e8" class="mc la hi ly b fi md me l mf mg">recommend_movies_based_on_plot(‘Life Begins for Andy Hardy’)</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mp"><img src="../Images/217df70c19819fc26f553aad87a8c592.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*GMIAaRJt-RmOx4TrNUDKsA.png"/></div></figure><p id="ff35" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">我们最终可以看到，当我们<strong class="jm hj">输入一部电影《安迪·哈代的人生》(Life Begins for Andy Hardy)</strong>时，我们会得到15部与这部电影情节相似的电影推荐。太神奇了。不是吗？</p><p id="124c" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">要了解基于元数据和协同过滤的方法，请浏览我的以下博客:</p><ol class=""><li id="7bd3" class="mq mr hi jm b jn jo jq jr jt ms jx mt kb mu kf mv mw mx my bi translated">基于元数据的推荐系统:<a class="ae kg" rel="noopener" href="/@saketgarodia/metadata-based-recommender-systems-in-python-c6aae213b25c"><em class="lw">https://medium . com/@ saketgarodia/metadata-based-Recommender-Systems-in-python-c 6 aae 213 b 25 c</em></a></li><li id="2209" class="mq mr hi jm b jn mz jq na jt nb jx nc kb nd kf mv mw mx my bi translated">使用协同过滤的推荐系统:<a class="ae kg" rel="noopener" href="/@saketgarodia/recommendation-system-using-collaborative-filtering-cc310e641fde"><em class="lw">https://medium . com/@ saketgarodia/recommendation-system-using-Collaborative-Filtering-cc 310 e 641 FDE</em></a></li></ol><p id="85db" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">感谢阅读。</p><p id="60c9" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">请做帖子反馈。</p></div></div>    
</body>
</html>