<html>
<head>
<title>Machine Learning Starter with Breast Cancer Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有乳腺癌检测的机器学习启动器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-starter-with-breast-cancer-detection-ead09f42df5c?source=collection_archive---------8-----------------------#2019-12-25">https://medium.com/analytics-vidhya/machine-learning-starter-with-breast-cancer-detection-ead09f42df5c?source=collection_archive---------8-----------------------#2019-12-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="88d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从现实世界的问题开始学习机器学习吧！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/c524a10c98a2d49fb2a158cd61bdde1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GmgTGkFqH-tgg_4IFR7HqA.jpeg"/></div></div></figure><blockquote class="jp jq jr"><p id="fdf6" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated"><strong class="ih hj">乳腺癌是女性最常见的癌症，也是第二大常见癌症。2018年新增病例超过200万例，成为当今一个重大的健康问题。</strong></p></blockquote><p id="031d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">乳腺癌检测中的关键挑战是将肿瘤分类为恶性或良性。<strong class="ih hj">恶性</strong>是指癌细胞可以侵入并杀死附近的组织，并扩散到你身体的其他部位。与癌性肿瘤(恶性)不同，<strong class="ih hj">良性</strong>不会扩散到身体其他部位，在某种程度上是安全的。机器学习技术可以用来显著提高早期诊断的准确性。</p><p id="db04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="js">在本文中，我们的目标是通过使用从细胞图像中提取的数据集，使用机器学习技术将肿瘤分类为恶性或良性。</em></p><h1 id="ea9f" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated"><strong class="ak">阶段1:环境设置</strong></h1><p id="74df" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">你可以按照这个<a class="ae kz" href="https://docs.anaconda.com/anaconda/install/linux/" rel="noopener ugc nofollow" target="_blank"> <em class="js">链接</em> </a>在你的系统上安装Anaconda。现在打开你的终端，输入<code class="du la lb lc ld b">jupyter notebook</code>启动Jupyter笔记本应用。笔记本界面将出现在新的浏览器窗口或选项卡中。你可以通过这个<a class="ae kz" href="https://jupyter-notebook-beginner-guide.readthedocs.io/en/latest/execute.html" rel="noopener ugc nofollow" target="_blank">文档</a>来熟悉jupyter笔记本。</p><h1 id="bba8" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">阶段2:导入库和数据集</h1><pre class="je jf jg jh fd le ld lf lg aw lh bi"><span id="8222" class="li jx hi ld b fi lj lk l ll lm">#import libraries<br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="21a3" class="li jx hi ld b fi ln lk l ll lm">#import dataset<br/>from sklearn.datasets import load_breast_cancer<br/>cancer = load_breast_cancer()</span></pre><p id="0390" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过在单元格中运行<code class="du la lb lc ld b">cancer</code>来查看所有数据。</p><h1 id="49d9" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">阶段3:数据可视化</h1><p id="94d1" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">为了以更好的格式查看数据，我们可以使用<code class="du la lb lc ld b">cancer.keys()</code>，它将返回字典中的所有键。我们可以用<code class="du la lb lc ld b">print(cancer['DESCR])</code>查看任何特定的列。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/c1dd268029405358b8c3050e41972b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fdu5AEl0m50Qa0rSJ81FMw.png"/></div></div></figure><p id="eaff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用pandas DataFrame来展示我们所有的数据。我们将用我们的癌症数据和目标数据创建一个数据框架。这将有助于我们在一个数据帧中存储所有的输入和输出。接下来，我们把癌症<code class="du la lb lc ld b">feature_names</code>和<code class="du la lb lc ld b">target</code>加在一起。</p><pre class="je jf jg jh fd le ld lf lg aw lh bi"><span id="82fe" class="li jx hi ld b fi lj lk l ll lm">df_cancer = pd.DataFrame(np.c_[cancer['data'], cancer['target']],columns = np.append(cancer['feature_names'], ['target']))</span><span id="d744" class="li jx hi ld b fi ln lk l ll lm">df_cancer.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lp"><img src="../Images/128bd73af74978536dc4384667248335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2s2Teo1I6Um7Lh69HDJQQ.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">图:数据帧</figcaption></figure><p id="5e00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du la lb lc ld b">df_cancer.head()</code>将返回包含目标数据的前几行。</p><p id="58de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用pairplot来可视化使用seaborn库的所有数据。我们使用前六个特征来绘制数据，但您可以尝试使用所有30个特征。</p><pre class="je jf jg jh fd le ld lf lg aw lh bi"><span id="0ea6" class="li jx hi ld b fi lj lk l ll lm">sns.pairplot(df_cancer, hue = 'target', vars = ['mean radius', 'mean texture', 'mean area', 'mean perimeter', 'mean smoothness', 'mean compactness'])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/03b2ae48fc6ced69b523a917ccee79a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0Vof9q271_AqW9r1wZJFQ.png"/></div></div></figure><p id="0f4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，蓝色点表示威胁生命的恶性病例，橙色点表示良性病例。为了显示特性之间的相关性，我们可以使用seaborn heatmap。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/e5fe6ffcfe4c3d8f14bbb33a9c71bf32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DaZjE44Knfd8jZtvOPKm-Q.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">图:热图</figcaption></figure><p id="86c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们观察热图，我们可以看到所有值都在0和1之间。该值越高，这两个特征之间的相关性就越高。您可以浏览相关矩阵，以获得数据相关值之间的概览。</p><h1 id="55a6" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">阶段4:模型培训</h1><p id="61de" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我们需要从数据框架中删除目标列<code class="du la lb lc ld b">x = df_cancer.drop(['target'], axis=1)</code>来训练我们的模型。下一步我们将通过执行<code class="du la lb lc ld b">y = df_cancer['target']</code>在y中定义我们的输出/目标列。</p><p id="bd61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了训练出我们的模型，我们需要将数据分为训练数据和测试数据。在模型被训练之后，我们将使用测试数据来预测癌症。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/31374e7358fa029d93eb86cf66d63efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGD1EkGP-7suEYbLY0ULcw.jpeg"/></div></div></figure><p id="d857" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们不可能手动分割数据集，我们还需要以随机方式分割数据集。为了帮助我们完成这项任务，我们将使用一个名为<em class="js"> train_test_split </em>的SciKit库。我们将把80%的数据集用于训练，20%用于测试。</p><pre class="je jf jg jh fd le ld lf lg aw lh bi"><span id="306d" class="li jx hi ld b fi lj lk l ll lm">from sklearn.model_selection import train_test_split</span><span id="9d98" class="li jx hi ld b fi ln lk l ll lm">X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=5)</span></pre><p id="93e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要使用数据标准化将所有数据的范围设定在0到1之间。这将有助于我们的模型在训练中获得更好的准确性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/c82b865829cd23a4b59c8cebb786ab1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*3XqFdbJfeACRI_aK27XmdQ.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">图:数据标准化公式</figcaption></figure><pre class="je jf jg jh fd le ld lf lg aw lh bi"><span id="73cc" class="li jx hi ld b fi lj lk l ll lm">min_train = X_train.min()<br/>range_train = (X_train - min_train).max()<br/>X_train_scaled = (X_train - min_train)/ range_train</span><span id="098a" class="li jx hi ld b fi ln lk l ll lm">sns.scatterplot(x = X_train['mean area'], y = X_train['mean smoothness'], hue = y_train)</span><span id="2fad" class="li jx hi ld b fi ln lk l ll lm">sns.scatterplot(x = X_train_scaled['mean area'], y = X_train_scaled['mean smoothness'], hue = y_train)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/def7f4b2a096deecdfb507d82685acfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6fVtL4b83VJK52Jr-cuQQ.jpeg"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">图:左(归一化前)和右(归一化后)</figcaption></figure><p id="364d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还需要对我们的测试数据集进行规范化。</p><pre class="je jf jg jh fd le ld lf lg aw lh bi"><span id="3a6f" class="li jx hi ld b fi lj lk l ll lm">in_test = X_test.min()<br/>range_test = (X_test - min_test).max()<br/>X_test_scaled = (X_test - min_test)/ range_test</span></pre><p id="8960" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在模型中使用支持向量分类器(SVC)。它是一个线性模型分类和回归。它可以解决线性和非线性问题。支持向量机用超平面将两类分类分开。我们在机器学习中的目标是推广模型，在该模型中，它可以识别大多数图像，无论它是恶性的还是良性的，即使它以前没有被看到过。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/ebe649e157dc1f3f0df085ebe05f4635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Fjj7EblDs2J88GgJmyKL8w.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">图:支持向量机</figcaption></figure><h1 id="f172" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">阶段5:模型评估</h1><p id="280d" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我们将使用混淆矩阵来显示测试数据集的结果，并相应地评估我们的模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/a59edc34db913a612481f6a60e6340d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*g5zpskPaxO8uSl0OWT4NTQ.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">图:混淆矩阵</figcaption></figure><p id="6928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们的预测结果是真实的，那么我们都是好的。我们可以计算正确分类的真实类的总数。然而，如果我们的预测告诉我们患者患有癌症(FP ),但是真实类别是阴性的，这导致错误的预测，但是并不严重，那么它可以被注释为类型1错误。此外，如果我们的预测告诉我们患者没有患癌症，但是真实类别是阳性的，这导致错误的预测，它可以被注释为类型2错误。我们需要不惜一切代价避免2型错误，因为这是一种威胁生命的疾病。</p><pre class="je jf jg jh fd le ld lf lg aw lh bi"><span id="5a3d" class="li jx hi ld b fi lj lk l ll lm">from sklearn.svm import SVC<br/>from sklearn.metrics import classification_report, confusion_matrix<br/>svc_model = SVC()</span><span id="5fbc" class="li jx hi ld b fi ln lk l ll lm">svc_model.fit(X_train_scaled, y_train)<br/>y_predict = svc_model.predict(X_test_scaled)</span><span id="b2d2" class="li jx hi ld b fi ln lk l ll lm">cm = confusion_matrix(y_test, y_predict)<br/>ax = sns.heatmap(cm, annot = True)<br/>ax.set_ylim(2.0, 0)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/29ca1e5b05773c2fc2403c041fb5b20a.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*tXveSzjKDLygfdpxCJhUUw.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">图:混淆矩阵的预测结果</figcaption></figure><p id="0253" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们可以看到总共有109个正确预测和5个类型1错误。如上所述，1型错误并不严重，但是我们已经成功地避免了所有2型错误。</p><p id="879e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从分类报告中，我们可以从我们的预测中得到我们性能的总结。我们模型的准确率是96%。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mc"><img src="../Images/7bd07085bd9d1e62377b0b29516c5985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGc5EJxFpWhPQQUKbgWV_w.png"/></div></div></figure><p id="7ab7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样，我们成功地创建了使用机器学习检测乳腺癌的程序。我们能够利用机器学习技术有效地对癌症进行分类。</p><h1 id="9876" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">资源:</h1><p id="dfcc" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">[1]<a class="ae kz" href="https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62" rel="noopener" target="_blank">https://towards data science . com/understanding-confusion-matrix-a9ad 42 dcfd 62</a></p><p id="c29a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[2]<a class="ae kz" href="https://www.javatpoint.com/machine-learning-support-vector-machine-algorithm" rel="noopener ugc nofollow" target="_blank">https://www . Java point . com/machine-learning-support-vector-machine-algorithm</a></p><p id="0661" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[3]<a class="ae kz" href="https://towardsdatascience.com/intro-to-data-analysis-for-everyone-part-3-d8f02690fba0" rel="noopener" target="_blank">https://towards data science . com/intro-to-data-analysis-for-every one-part-3-d8f 02690 FBA 0</a></p><p id="6f44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[4]<a class="ae kz" href="https://www.learntek.org/blog/wp-content/uploads/2018/11/Ml-and-PR.jpg" rel="noopener ugc nofollow" target="_blank">https://www . learn tek . org/blog/WP-content/uploads/2018/11/Ml-and-pr . jpg</a></p></div></div>    
</body>
</html>