<html>
<head>
<title>So you think you don’t have enough data to do Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">所以你认为你没有足够的数据来做机器学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/so-you-think-you-dont-have-enough-data-to-do-machine-learning-3b5c6c512e27?source=collection_archive---------5-----------------------#2020-10-07">https://medium.com/analytics-vidhya/so-you-think-you-dont-have-enough-data-to-do-machine-learning-3b5c6c512e27?source=collection_archive---------5-----------------------#2020-10-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="52f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问一个初学者为什么ML这么难，你很可能会得到这样的答案:<em class="jd">“背后的数学真的很复杂”</em>或<em class="jd">“我不完全明白所有这些层是做什么的”</em>。虽然这显然是真的，而且解释ML模型肯定是一个模糊的主题，但事实是ML很难，因为我们拥有的数据往往无法满足我们模型的复杂性。这在实践中是一个非常普遍的问题，因为你的模型只有在你的数据有多好的时候才会有多好，所以我收集了一些最相关的指导方针，供你在面临数据短缺时使用。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/6259a6aad2a58862a84465c0ac18a4c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WtKr33KEFnwysUPp"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">由<a class="ae ju" href="https://unsplash.com/@franki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">弗兰基·查马基</a>在<a class="ae ju" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="69c0" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">你实际需要多少数据？</h1><p id="eb90" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">这是每个处理数据的人都曾在某个时候想知道的事情。不幸的是，没有一套固定的规则会给你一个直接的答案，你只能求助于指导方针和经验。</p><p id="3ea5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先你应该考虑你的问题有多复杂。预测客户行为与区分猫和狗是不同的。毕竟，作为人类的一员，有些人对你来说可能是不可读的，但你肯定不会发现自己为区分狗和猫而流汗。</p><p id="c9a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，你对算法的<strong class="ih hj">选择也将决定你的集合的适当大小。深度神经网络等更复杂的模型能够捕捉比线性模型更多的细节，但代价是需要更高的集合规模。</strong></p><p id="3e30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果这些指导方针中的任何一个失败了<em class="jd">(很可能是这种情况)</em>，就像你会<strong class="ih hj">从现有文献中获得灵感</strong>来选择一个或另一个模型一样，看看使用了什么输入。毕竟，没有多少人会重新发明轮子，所以你很有可能会遇到类似的问题。</p><p id="d2ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一个重要的考虑因素，那就是你的数据是否呈现出某种季节性。对于遵循每日模式的集合，这肯定不会是相同的预测，就像你期望每年重复的一样。</p><p id="1621" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能听说过10倍法则(意思是你应该拥有至少10倍的功能)。实际上，这通常是一个很好的方法，但是要注意，如果你的特征不能很好地分离目标，这个经验法则对你的问题就完全没用了。</p><p id="d6b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许你只是想要一个特定的<em class="jd">号</em>，这完全可以理解。在线性算法的情况下，每个类数百个例子可能是一个很好的起点。移动到更复杂的算法，任何非线性模型都不能处理这个数量。对于这样的算法，你会希望用至少数万个例子来保护自己，甚至在使用深度神经网络时达到数百万个。</p><p id="d7d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为最后一个建议，在你考虑我将要讨论的任何技术之前，用你所拥有的例子数量绘制一个<strong class="ih hj">学习曲线</strong>【1】。也许你选择的模型已经被你设定的尺寸饱和了，或者也许你会发现你的曲线比你最初想的更加不稳定。</p><h1 id="e50a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">能解决吗？</h1><p id="c073" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">嗯，有可能！除了收集更多数据这一显而易见的选择之外，根据您的问题的特征，您还可以遵循不同的策略。在探索创建人工数据的方法之前，让我补充一些有用的东西:<strong class="ih hj">特征工程</strong>。利用你所拥有的数据集的预测能力，因为它真的可以帮助弥补例子的缺乏。不过，不要过于兴奋，创建数百个特征:你给模型的自由度越高，它就越容易过度拟合！</p><p id="ec0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在回到指导方针，不管是否有可能收集更多的数据，这些都是最常用的增加数据集大小的方法。</p><h2 id="173e" class="ky jw hi bd jx kz la lb kb lc ld le kf iq lf lg kj iu lh li kn iy lj lk kr ll bi translated">数据扩充和综合</h2><p id="ffb2" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">数据扩充是一种技术，它使用已经可用的示例，通过转换它们来创建新的示例。在图像方面，一些最常见的变换包括缩放、裁剪、旋转、翻转、噪声注入或颜色改变。这种技术不仅有助于解决数据稀缺的问题，而且有助于使我们拥有的数据集变得复杂，从而更接近我们在现实生活中会发现的情况，即避免教科书中的例子。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lm"><img src="../Images/34cb5161bdfdc42f7ba59716bb41d307.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnNu1lVgbpDfd9Ne0y8NkA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">几何变换的例子[2]</figcaption></figure><p id="5075" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些Python库很容易增加你的集合的大小，并且入门非常简单，比如Tensorflow的<a class="ae ju" href="https://www.tensorflow.org/tutorials/images/data_augmentation" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> tf.image </strong> </a>和PyTorch的<a class="ae ju" href="https://pytorch.org/docs/stable/torchvision/transforms.html" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">torch vision . transforms</strong></a></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ln lo l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">Tensorflow数据增强</figcaption></figure><p id="9e72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了所讨论的几何和色彩空间变换之外，还有其他有趣的数据扩充技术。例如，随机擦除有目的地掩盖图片的部分以模拟遮挡，并且它可以实现很好的结果，因为模型被迫找到更多的描述性特征。</p><p id="65d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于转换的最后一点提醒是，对增加的数据标签要小心，因为不恰当的改变可能会修改数据类。这方面的一些例子是将6减为0，改变潜在恶性黑色素瘤的颜色，或将路标翻转到不同但现有的方向。</p><p id="f5d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据合成不是转换现有的数据点，而是生成全新的数据点。流行的方法是通过深度学习算法。其中一个是生成对抗网络(GANs)，这是一个非常酷的算法，它学习你的示例的底层分布，以创建新的示例。当然，这是对模型功能的一个非常简单的解释，但是在这篇文章中却是一个复杂的解释。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lp"><img src="../Images/6390c5c442ca8698afaea3882b0f43e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5sHATzzN1B4H6vA7vo_vUw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">生成性对抗网络的简化[4]</figcaption></figure><p id="a2ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一种常用的数据合成技术是合成少数过采样技术(SMOTE) [5]，在数据集不平衡时特别有用。该方法建议将多数类的欠采样和少数类的过采样结合起来，以提高模型的性能。请注意，展示SMOTE的原始作品描述了ROC空间中的性能，而不是简单地用准确性术语描述，这在这种不平衡的情况下具有很大的欺骗性。简而言之，该算法为少数类随机选择一个数据点，然后找到它的k个最近邻，并再次随机选择这k个中的一个。新创建的数据点将在两个选定点之间的直线上随机合成[6]。</p><p id="82e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择哪种技术很大程度上取决于您的问题。当然，使用GAN生成图像比使用现成的Python库旋转要复杂得多。还要考虑你的时间限制，使用GAN来合成新数据将涉及训练不止一个而是两个模型，也许你没有时间做这些。</p><p id="6d1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再一次，你的场景的特征需要被考虑。您是在处理图片还是表格数据？不幸的是，在处理表格时，你不会找到许多简单的技巧来增加你的集合的大小。曾经有过使用GANs生成合成数据的方法[7]，但坦率地说，现实生活中的应用是有限的，社区通常不鼓励这种方法用于这种特定的用例。然而，如果你决定尝试一下，需要考虑一些因素。小心处理时间序列数据，因为生成对立模型可能无法捕捉趋势。总的来说，SMOTE被认为是合成表格数据的更有效的选择。此外，虽然新合成或增强的图像对我们的大脑理解没有挑战，但这不一定适用于表格数据。我建议不要使用领域专家都无法理解的例子，因为你的模型很可能已经缺乏可解释性。</p><p id="2616" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于数据扩充和合成的最后一点说明是，如果您决定使用手头的所有技术，那么很容易得到一个巨大的数据集。这并不一定是一个优势，因为您可能会很快引入一个严重的过度拟合案例。</p><h2 id="af72" class="ky jw hi bd jx kz la lb kb lc ld le kf iq lf lg kj iu lh li kn iy lj lk kr ll bi translated">迁移学习</h2><p id="64f9" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">迁移学习使用预先训练好的模型作为任务的起点。这使我们能够利用网上的大量数据和已经训练好的现有复杂模型。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lq"><img src="../Images/f12f5fa5695bf80feabe28f772c32f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SpjnoomvglIHrrsQ"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae ju" href="https://unsplash.com/@jamesponddotco?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">詹姆斯·庞德</a>在<a class="ae ju" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="3d6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">迁移学习的想法源于这样一个事实，即从特定用例中获得的知识可以扩展到一些相关的领域。你可能会从这句话中猜到，为了让这一点发挥作用，你应该寻找已经在与你类似的数据上训练过的算法。一旦你找到了一个适合你需求的模型，你必须再次训练算法，但不是从头开始，这是一个非常好的好处，因为你的训练时间(和资源)将大大减少。然后，你要做的是冻结除了最后一层之外的所有层，或者增加几层，并且只根据你的自定义数据重新训练这些层。训练完新的之后，你总是可以做最后一轮的全网训练(但这可能不是必须的)。在任何情况下，重要的是要记住，如果新层仍然具有随机初始化的权重(即，未被训练)，则不要训练整个网络，因为这将迫使整个网络进行非常大的更新，最终导致过度拟合。</p><p id="e383" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，在实践中有许多方法来实现迁移学习。如果您想保持简单，并且正在使用Keras，那么使用trainable属性就很容易。将其设置为false将冻结图层，并且在训练过程中不会更新图层。您还可以在<a class="ae ju" href="https://keras.io/api/applications/" rel="noopener ugc nofollow" target="_blank"> Keras Applications </a>上找到一份非常好且全面的可用型号列表，这样您就可以选择最符合您需求的型号。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ln lo l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">使用Keras进行迁移学习</figcaption></figure><h2 id="dd1f" class="ky jw hi bd jx kz la lb kb lc ld le kf iq lf lg kj iu lh li kn iy lj lk kr ll bi translated">数据收集</h2><p id="c9d6" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">有时候，更明显也可能是唯一的选择是简单地收集更多的数据。为此，您很可能希望利用领域专家来帮助您收集和标记(如果适用)新的数据点。</p><p id="0be8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于收集，如果您的用例允许的话，也可以考虑使用开源库。一些最好的公共数据集可以在Kaggle、<a class="ae ju" href="https://datasetsearch.research.google.com" rel="noopener ugc nofollow" target="_blank">谷歌数据集搜索</a>、<a class="ae ju" href="http://www.image-net.org" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>、<a class="ae ju" href="https://s3.amazonaws.com/amazon-reviews-pds/readme.html" rel="noopener ugc nofollow" target="_blank">亚马逊评论</a>或<a class="ae ju" href="http://archive.ics.uci.edu/ml/index.php" rel="noopener ugc nofollow" target="_blank"> UCI机器学习知识库</a>中找到；这取决于您正在寻找的数据类型(图像、表格数据、文本等。)值得看看一些主要云提供商提供的可用数据，如GCP或AWS too。</p><p id="ae69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许你发现自己有足够的数据，但不幸的是没有标记。例如，可能的解决方案可以是使用亚马逊机械土耳其公司(Amazon Mechanical Turk)等工具的众包(crowdsourcing)或半监督学习(semi-supervised learning)，在这种情况下，你可以用可用的已标记数据训练一个模型，随后标记你的集合的其余部分。</p><h1 id="4bf1" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">结论</h1><p id="29da" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">有数不清的方法可以解决数据短缺的问题，因此选择一种方法可能会非常困难。在回顾了一些最流行的技术之后，我会仔细考虑要解决的ML问题的特征，这不仅意味着模型或数据特征的选择，还包括时间或预算约束等业务考虑。</p><p id="77e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可能你需要一个讨论过的策略的组合，或者你唯一可能的出路是收集更多的数据。无论是哪种情况，这都是你ML过程中的关键一步，也是你成功的关键。</p></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><h1 id="1ff4" class="jv jw hi bd jx jy ly ka kb kc lz ke kf kg ma ki kj kk mb km kn ko mc kq kr ks bi translated">参考</h1><p id="2f3b" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">[1] Jason Brownlee，<em class="jd">机器学习需要多少训练数据？</em><a class="ae ju" href="https://machinelearningmastery.com/much-training-data-required-machine-learning/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/much-training-data-required-machine-learning/</a></p><p id="decc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[2] Rohit Dwivedi，<em class="jd">数据增强如何影响图像分类性能，代码</em><a class="ae ju" href="https://analyticsindiamag.com/image-data-augmentation-impacts-performance-of-image-classification-with-codes/" rel="noopener ugc nofollow" target="_blank">https://analyticsindiamag . com/Image-Data-Augmentation-Impacts-Performance-Of-Image-class ification-With-Codes/</a></p><p id="bcc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[3] OpenGenus，<em class="jd">数据增强技术</em><a class="ae ju" href="https://iq.opengenus.org/data-augmentation/" rel="noopener ugc nofollow" target="_blank">https://iq.opengenus.org/data-augmentation/</a></p><p id="f3af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[4]Agnieszka miko ajczyk，Michał Grochowski，<em class="jd">用于改进图像分类问题中深度学习的数据增强</em><a class="ae ju" href="https://www.researchgate.net/publication/325920702_Data_augmentation_for_improving_deep_learning_in_image_classification_problem" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/publication/325920702 _ Data _ augmentation _ for _ improving _ deep _ learning _ in _ image _ class ification _ problem</a></p><p id="3728" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[5] Benjamin Biering，<em class="jd">人工智能入门:需要多少数据？</em><a class="ae ju" href="https://2021.ai/getting-started-ai-how-much-data-needed/" rel="noopener ugc nofollow" target="_blank">https://2021.ai/getting-started-ai-how-much-data-needed/</a></p><p id="7687" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[6] Nitesh诉Chawla <em class="jd">等人，SMOTE:合成少数过采样技术【https://arxiv.org/pdf/1106.1813.pdf</em>T22</p><p id="4322" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[7]https://arxiv.org/abs/1811.11264徐磊<em class="jd">利用生成对抗网络</em>综合表格数据<br/></p></div></div>    
</body>
</html>