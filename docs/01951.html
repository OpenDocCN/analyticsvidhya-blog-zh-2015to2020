<html>
<head>
<title>Advanced Statistics Using R — 6</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用R-6的高级统计</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/advanced-statistics-using-r-6-2789539a0167?source=collection_archive---------10-----------------------#2019-11-23">https://medium.com/analytics-vidhya/advanced-statistics-using-r-6-2789539a0167?source=collection_archive---------10-----------------------#2019-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="ig ih ii"><p id="399e" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated"><em class="hi">如果您还没有阅读R数据分析系列的第5部分，请阅读下面的文章，其中我们讨论了</em> <a class="ae ji" rel="noopener" href="/analytics-vidhya/introduction-to-statistics-using-r-5-4c049ff7abf3"> <em class="hi">使用R-5</em></a><em class="hi">进行统计的介绍。</em></p><p id="d80c" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated">这篇文章的内容是我在IIM-B时代得到的几本书的要点。</p><p id="c921" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated"><em class="hi">人人有责——贾里德·p·兰德</em></p><p id="7f74" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated"><em class="hi">实用数据科学与R —妮娜·祖梅尔&amp;约翰·芒特</em></p><p id="d5de" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated"><em class="hi">文中讨论的所有代码块都以R markdown的形式出现在</em> <a class="ae ji" href="https://github.com/viveksrinivasanss/Data_Science_Using_R" rel="noopener ugc nofollow" target="_blank"> <em class="hi"> Github链接</em> </a> <em class="hi">中。</em></p><p id="8550" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated"><em class="hi">要看我写的所有文章请使用链接，</em><a class="ae ji" rel="noopener" href="/@viveksrinivasan"><em class="hi">Vivek Srinivasan</em></a><em class="hi">。</em></p></blockquote><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jj"><img src="../Images/106f8bf65b2bd86b3c80249386dadec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*yEBschEKK7cqg8rHT4nVBA.jpeg"/></div></figure><p id="9a19" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi ju translated"><span class="l jv jw jx bm jy jz ka kb kc di">在传统的统计课上，威廉·戈塞特在吉尼斯啤酒厂工作时发明的“T0”被用来测试数据的平均值或比较两组数据。为了说明这一点，我们继续使用来自<code class="du kd ke kf kg b">ggplot2</code>的<code class="du kd ke kf kg b">tips </code>数据。</span></p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="8f95" class="kl km hi kg b fi kn ko l kp kq">data(tips,package="reshape2")<br/>head(tips)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kr"><img src="../Images/c59dbd57108bdc309d577cf4a2675dd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7QjM6LxgW7dRoq6POaWnQg.png"/></div></div></figure><h2 id="6c2e" class="kl km hi bd kw kx ky kz la lb lc ld le jr lf lg lh js li lj lk jt ll lm ln lo bi translated">单样本T检验</h2><p id="bdce" class="pw-post-body-paragraph ij ik hi im b in lp ip iq ir lq it iu jr lr ix iy js ls jb jc jt lt jf jg jh hb bi translated">首先，我们对平均小费是否等于<code class="du kd ke kf kg b">$2.50</code>进行单样本t检验。这种测试本质上是计算数据的平均值并建立一个置信区间。如果我们测试的值落在置信区间内，那么我们可以得出结论，它是数据平均值的真实值；否则，我们断定它不是真实的意思。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="74ab" class="kl km hi kg b fi kn ko l kp kq">t.test(tips$tip, alternative="two.sided", mu=2.50)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lu"><img src="../Images/a17c60e55c6ff0b455b97cb38a1ea611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mSss9mSWPokGBfoBgMxlFw.png"/></div></div></figure><p id="fa93" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">零假设被认为是真的；在这种情况下，平均值等于<code class="du kd ke kf kg b">$2.50</code>。输出非常好地显示了均值是否等于<code class="du kd ke kf kg b">$2.50</code>的假设测试的设置和结果。它打印出<code class="du kd ke kf kg b">t-statistic</code>，自由度和<code class="du kd ke kf kg b">p-value</code>。它还为感兴趣的变量提供了95%的<code class="du kd ke kf kg b">confidence interval</code>和<code class="du kd ke kf kg b">mean </code>。<code class="du kd ke kf kg b">p-value</code>表示应该拒绝零假设，我们得出均值不等于<code class="du kd ke kf kg b">$2.50</code>的结论。</p><p id="dc11" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">我们在这里遇到了一些新概念。<code class="du kd ke kf kg b">t-statistic</code>是比率，其中分子是估计平均值和假设平均值之间的差值，分母是估计平均值的标准误差。它在等式中定义</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lv"><img src="../Images/07169faec42892110f53e657003dcf65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*syg2zzKs8bFBr7z8j_hAPA.png"/></div></div></figure><p id="7c74" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">如果假设的平均值是正确的，那么我们期望t统计量落在中间的某个地方，大约是平均值的两个标准差。在下图中，我们看到代表估计平均值的黑色粗线远远落在分布之外，因此我们必须得出平均值不等于<code class="du kd ke kf kg b">$2.50</code>的结论。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="fbb7" class="kl km hi kg b fi kn ko l kp kq">## build a t distribution<br/>randT &lt;- rt(30000, df=NROW(tips)-1)</span><span id="bbad" class="kl km hi kg b fi lw ko l kp kq">## get t-statistic and other information<br/>tipTTest &lt;- t.test(tips$tip, alternative="two.sided", mu=2.50)</span><span id="3b10" class="kl km hi kg b fi lw ko l kp kq">## Plot it<br/>library(ggplot2)<br/>ggplot(data.frame(x=randT)) +<br/>     geom_density(aes(x=x), fill="grey", color="grey") +<br/>     geom_vline(xintercept=tipTTest$statistic) +<br/>     geom_vline(xintercept=mean(randT) + c(-2, 2)*sd(randT), linetype=2)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lx"><img src="../Images/1ce29947b9cbde1a22313478b6f34590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MisV1WEvDkrgCWy90PNqKA.png"/></div></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">tip数据的t分布和t统计。虚线是两个方向平均值的标准偏差。粗黑线，t统计量，远远超出了分布，我们必须拒绝零假设，并得出结论，真正的平均值不是2.50美元。</figcaption></figure><p id="ec95" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated"><code class="du kd ke kf kg b"> p-value</code>是一个经常被误解的概念。尽管有所有的误解，如果零假设是正确的，一个<code class="du kd ke kf kg b">p-value</code>是一个概率，得到一个极端的，或者更极端的结果。这是对统计数据(在这种情况下是估计平均值)极端程度的一种度量。如果统计数据过于极端，我们的结论是应该拒绝零假设。</p><p id="d7d6" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">然而，<code class="du kd ke kf kg b">p-values</code>的主要问题是确定什么应该被认为是过于极端。现代统计学之父罗纳德·a·费舍尔(Ronald A. Fisher)认为，我们应该认为小于0.10、0.05或0.01的<code class="du kd ke kf kg b">p-value</code>过于极端。虽然那些<code class="du kd ke kf kg b">p-values </code>已经是几十年来的标准，但它们是随意选择的，导致一些现代数据科学家质疑它们的实用性。在本例中，p值为5.0799885×108；这小于0.01，所以我们拒绝零假设。</p><p id="25e0" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated"><code class="du kd ke kf kg b">Degrees of freedom</code>是另一个难以理解的概念，但在整个统计中普遍存在。它代表有效的观察次数。通常，某些统计或分布的<code class="du kd ke kf kg b">degrees of freedom </code>是观察值的数量减去被估计的参数的数量。在<code class="du kd ke kf kg b">t-distribution</code>的情况下，正在估计一个参数，即标准误差。在这个例子中，有<code class="du kd ke kf kg b">nrow(tips)-1=243</code>个自由度。</p><p id="e4b9" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">接下来，我们进行单侧t检验，看看平均值是否大于2.50美元。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="89f7" class="kl km hi kg b fi kn ko l kp kq">t.test(tips$tip, alternative="greater", mu=2.50)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mc"><img src="../Images/4e5668aad3c830661ec9f558aadcdc09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I57huJaeHH8ds71CvOoaBg.png"/></div></div></figure><p id="d1dc" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">p值再次表明，我们应该拒绝零假设，并得出均值大于2.50美元的结论，这与置信区间非常吻合。</p><h2 id="c972" class="kl km hi bd kw kx ky kz la lb lc ld le jr lf lg lh js li lj lk jt ll lm ln lo bi translated">双样本T检验</h2><p id="4a6a" class="pw-post-body-paragraph ij ik hi im b in lp ip iq ir lq it iu jr lr ix iy js ls jb jc jt lt jf jg jh hb bi translated">t检验通常用于比较两个样本。继续小费的数据，我们比较女性和男性食客如何给小费。然而，在运行t检验之前，我们首先需要检查每个样本的方差。传统的t检验要求两组具有相同的方差，而Welch双样本t检验可以处理具有不同方差的组。</p><p id="9bb8" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">为了检查两组是否有相同的方差，我们可以使用标准的<code class="du kd ke kf kg b"> F-test</code>(通过<code class="du kd ke kf kg b">var.test</code>函数)或<code class="du kd ke kf kg b">Bartlett test</code>(通过<code class="du kd ke kf kg b">bartlett.test</code>函数)。但是数据应该遵循一个<code class="du kd ke kf kg b">normal</code>分布来执行上述测试。我们将探究两组在数字和视觉上有相同的差异。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="1b19" class="kl km hi kg b fi kn ko l kp kq">## Normality test<br/>shapiro.test(tips$tip)</span><span id="5211" class="kl km hi kg b fi lw ko l kp kq">## Normality test for female<br/>shapiro.test(tips$tip[tips$sex == "Female"])</span><span id="cde2" class="kl km hi kg b fi lw ko l kp kq">## Normality test for male<br/>shapiro.test(tips$tip[tips$sex == "Male"])</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es md"><img src="../Images/e908a599669c883067b34d00cc08eb5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HkdXscGpdzN_f_m7AD8tSA.png"/></div></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es me"><img src="../Images/75791a67bb4addd4b828c149e607a787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*127u2eAHvlJgflJpJrablQ.png"/></div></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mf"><img src="../Images/0dfabc8159fdef6613ffe6e40fb194d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebKwgyAv-GcA-72Aa7MtOg.png"/></div></div></figure><p id="3d28" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">所有的数值试验清楚地表明，数据不是正态分布的。所以我们不能用<code class="du kd ke kf kg b">standard F-test or Bartlett-test</code>来检验方差的相等性。我们还可以直观地检查数据是否呈正态分布，如下所示。即使目测也表明数据不是正态分布的。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="ed3e" class="kl km hi kg b fi kn ko l kp kq"># all the tests fail so inspect visually<br/>ggplot(tips, aes(x=tip, fill=sex)) + geom_histogram(binwidth=.5, alpha=1/2)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mg"><img src="../Images/ae4c21f7aeebae1574187842c6713f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UydqFM5-7hlisiFpdZJYAg.png"/></div></div></figure><p id="3ed1" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">由于数据不是正态分布的，我们可以使用非参数的<code class="du kd ke kf kg b">Ansari-Bradley</code>检验来检验方差的相等性。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mh"><img src="../Images/301c188018f4a367ed2a2d7894d6bd5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F6LAfZ_oUakIowpTODyxFg.png"/></div></div></figure><p id="24d8" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">这个测试表明方差相等，这意味着我们可以使用标准的<code class="du kd ke kf kg b">two-sample t-test</code>。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="0770" class="kl km hi kg b fi kn ko l kp kq">t.test(tip ~ sex, data=tips, var.equal=TRUE)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mi"><img src="../Images/75cab10c1ef927bd08ad2536710aa121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otS_NguquvGzUAOKirESTg.png"/></div></div></figure><p id="bea0" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">根据这个测试，结果并不显著，我们可以得出结论，男女食客给的小费大致相等。虽然所有这些统计上的严格性很好，但一个简单的经验法则是看这两个平均值是否在彼此的两个标准差之内。像往常一样，我们更喜欢可视化的结果，而不是比较数值。这需要对数据进行一点改造。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="d7d2" class="kl km hi kg b fi kn ko l kp kq">library(plyr)<br/>tipSummary &lt;- ddply(tips, "sex", summarize,<br/>          tip.mean=mean(tip), tip.sd=sd(tip),<br/>          Lower=tip.mean - 2*tip.sd/sqrt(NROW(tip)),<br/>          Upper=tip.mean + 2*tip.sd/sqrt(NROW(tip)))<br/>tipSummary</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mj"><img src="../Images/caa035a825c336285e5122cf01f95b00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-iCXllFdyaZZuMyHpbCrqA.png"/></div></div></figure><p id="bb36" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">这段代码中发生了很多事情。首先，<code class="du kd ke kf kg b">ddply</code>用于根据性别水平分割数据。然后，它将summarize函数应用于数据的每个子集。该函数将指定的函数应用于数据，创建一个新的<code class="du kd ke kf kg b">data.frame</code>。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="d129" class="kl km hi kg b fi kn ko l kp kq">ggplot(tipSummary, aes(x=tip.mean, y=sex)) + geom_point() +          geom_errorbarh(aes(xmin=Lower, xmax=Upper), height=.2)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mk"><img src="../Images/057c344714b0b2dca4f23e3a79ee3ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u9z-7R9vzYwoolECdcjlFg.png"/></div></div></figure><p id="4384" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">结果清楚地显示置信区间重叠，表明两种性别的平均值大致相等。</p><h2 id="8ee5" class="kl km hi bd kw kx ky kz la lb lc ld le jr lf lg lh js li lj lk jt ll lm ln lo bi translated">配对双样本T检验</h2><p id="fc9f" class="pw-post-body-paragraph ij ik hi im b in lp ip iq ir lq it iu jr lr ix iy js ls jb jc jt lt jf jg jh hb bi translated">对于检验配对数据(例如，双胞胎的测量值、治疗前后的效果、父子比较)，应使用配对t检验。这很简单，只需将<code class="du kd ke kf kg b">t.test</code>中的成对参数设置为<code class="du kd ke kf kg b">TRUE</code>即可。为了说明这一点，我们使用了卡尔·皮尔逊收集的位于<code class="du kd ke kf kg b">UsingR</code>包中的父亲和儿子的身高数据。身高通常是分布的，所以我们将放弃正态性和等方差的测试。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="2865" class="kl km hi kg b fi kn ko l kp kq">data(father.son, package='UsingR')<br/>head(father.son)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ml"><img src="../Images/be8ffc411d57755c80795c8d528f4976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sh7v_WzKMX1CBA_eAP1BBA.png"/></div></div></figure><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="2905" class="kl km hi kg b fi kn ko l kp kq">t.test(father.son$fheight, father.son$sheight, paired=TRUE)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mm"><img src="../Images/9ce8fe7ea4af96c3c10b683118860d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGh7ecMKNn6H7_9jKNrBgQ.png"/></div></div></figure><p id="8618" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">这个测试表明，我们应该拒绝零假设，并得出结论，父亲和儿子(至少对于这个数据集)有不同的高度。我们使用差异的密度图来显示这些数据，如图所示。我们看到一个均值不为零的分布和一个几乎不排除零的置信区间，这与测试结果一致。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="2413" class="kl km hi kg b fi kn ko l kp kq">heightDiff &lt;- father.son$fheight - father.son$sheight<br/>ggplot(father.son, aes(x=fheight - sheight)) +<br/>    geom_density() +<br/>    geom_vline(xintercept=mean(heightDiff)) +<br/>    geom_vline(xintercept=mean(heightDiff) + 2*c(-1, 1)*sd(heightDiff)/sqrt(nrow(father.son)),linetype=2)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mn"><img src="../Images/2e50c2907e373b4a28e9c1651b32a77b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JGoEGqHPUtv5DHUL4dMhSg.png"/></div></div></figure><h2 id="f9a8" class="kl km hi bd kw kx ky kz la lb lc ld le jr lf lg lh js li lj lk jt ll lm ln lo bi translated">方差分析</h2><p id="61e5" class="pw-post-body-paragraph ij ik hi im b in lp ip iq ir lq it iu jr lr ix iy js ls jb jc jt lt jf jg jh hb bi translated">在比较了两组之后，下一步自然是比较多组。每年，有太多的统计学导论课的学生被迫学习<code class="du kd ke kf kg b">ANOVA</code>(方差分析)测试并记住它的公式</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mo"><img src="../Images/45565af6e2cb8861e9f417b1a761c71d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMi3-YfJcxzIRchtqy9eNg.png"/></div></div></figure><p id="d3cc" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">这不仅是一个费力的公式，常常使许多学生对统计学失去兴趣；这也是一种比较群体的老式方法。尽管如此，还是有一个R函数——尽管很少使用——来进行<code class="du kd ke kf kg b">ANOVA </code>测试。这也使用公式界面，其中左侧是感兴趣的变量，右侧包含控制分组的变量。为了看到这一点，我们用级别<code class="du kd ke kf kg b">Fri, Sat, Sun, Thur</code>来比较一周中每一天的提示。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="0992" class="kl km hi kg b fi kn ko l kp kq">tipAnova &lt;- aov(tip ~ day - 1, tips)<br/>tipAnova</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mp"><img src="../Images/3bcf0294e11d6518547156b6d159a8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sviypuEFv8kN--gjI3iWrQ.png"/></div></div></figure><p id="d068" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated"><code class="du kd ke kf kg b">ANOVA</code>测试任何组是否不同于任何其他组，但它不指定哪个组不同。所以打印测试的总结只会返回一个<code class="du kd ke kf kg b">p-value</code>。由于测试有一个显著的<code class="du kd ke kf kg b">p-value</code>，我们想看看哪个组与其他组不同。</p><pre class="jk jl jm jn fd kh kg ki kj aw kk bi"><span id="9256" class="kl km hi kg b fi kn ko l kp kq">tipsByDay &lt;- ddply(tips, "day", plyr::summarize,<br/>                    tip.mean=mean(tip), tip.sd=sd(tip),<br/>                    Length=NROW(tip),<br/>                    tfrac=qt(p=.90, df=Length-1),<br/>                    Lower=tip.mean - tfrac*tip.sd/sqrt(Length),<br/>                    Upper=tip.mean + tfrac*tip.sd/sqrt(Length)<br/>                    )</span><span id="17bb" class="kl km hi kg b fi lw ko l kp kq">ggplot(tipsByDay, aes(x=tip.mean, y=day)) + geom_point() +<br/>     geom_errorbarh(aes(xmin=Lower, xmax=Upper), height=.3)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mq"><img src="../Images/a80bf9aa5333d537e40022f5810c5941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-C1MhwQo9I_hmTRh8lf8Ag.png"/></div></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">每日小费的均值和置信区间。这表明周日的小费不同于周四和周五的小费。</figcaption></figure><p id="c1de" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">该图显示，周日的提示与周四和周五有所不同(在90%的信心水平下，差异很小)。为了确认来自<code class="du kd ke kf kg b">ANOVA</code>的结果，可以对每一对组进行单独的t检验。</p><p id="fa54" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">无论是计算简单的数字汇总还是进行假设检验，R都有适合它们的函数。分别用<code class="du kd ke kf kg b">mean</code>、<code class="du kd ke kf kg b">var </code>和<code class="du kd ke kf kg b">sd</code>计算均值、方差和标准差。用<code class="du kd ke kf kg b">cor </code>和<code class="du kd ke kf kg b">cov</code>计算相关性和协方差。对于t检验，使用<code class="du kd ke kf kg b">t.test</code>，而<code class="du kd ke kf kg b">aov </code>用于<code class="du kd ke kf kg b">ANOVA</code>。</p><p id="410d" class="pw-post-body-paragraph ij ik hi im b in io ip iq ir is it iu jr iw ix iy js ja jb jc jt je jf jg jh hb bi translated">到目前为止，在<code class="du kd ke kf kg b">data science series using R </code>中，我们已经讨论了如何使用<code class="du kd ke kf kg b">R</code>进行数据准备、构建统计图表以及执行基本到高级水平的统计测试。从下一篇文章开始，我们将把讨论转向使用<code class="du kd ke kf kg b">R</code>理解机器学习算法。</p><blockquote class="ig ih ii"><p id="0ec9" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated"><a class="ae ji" rel="noopener" href="/@viveksrinivasan/simple-linear-regression-7-655537eee4c5">使用R-6的简单线性回归</a></p><p id="64c9" class="ij ik il im b in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh hb bi translated">一定要通过评论和分享文章来分享你的想法和支持。</p></blockquote></div></div>    
</body>
</html>