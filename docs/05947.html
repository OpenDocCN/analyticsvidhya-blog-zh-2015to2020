<html>
<head>
<title>Understanding Unit Testing In Python Part I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Python中的单元测试第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/unit-testing-in-python-for-beginners-8de286eb5c31?source=collection_archive---------25-----------------------#2020-05-06">https://medium.com/analytics-vidhya/unit-testing-in-python-for-beginners-8de286eb5c31?source=collection_archive---------25-----------------------#2020-05-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2596617fff43a886a71e9f836184d15a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnfupMo1VxVFhEVYsj3xMA.png"/></div></div></figure><p id="a34f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正在学习干净漂亮地编写代码的业余程序员，需要理解在部署功能之前对其进行单元测试的重要性。</p><p id="0974" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你是编程新手，刚刚开始，那么很明显你会问，单元测试到底是什么？总的来说，测试很简单，就是一些确保你的程序按预期方式运行的代码。测试在开发的不同阶段进行。通常第一阶段是单元测试，我们会在这篇文章中用一些例子来研究它。</p><p id="4778" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">顾名思义，单元测试是我们测试程序中基本组件工作情况的地方。假设我们有一个文件myProgramfile.py，它有一个如下定义的函数</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="de67" class="jx jy hi jt b fi jz ka l kb kc">def addNumbers(A,B):<br/>    return A+B</span></pre><p id="aea7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以用任意几个数字来测试它，确保它对任意一组数字都有效。但是考虑一个函数，它可以基于这样的参数做不同的事情</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="719a" class="jx jy hi jt b fi jz ka l kb kc">def operateNumbers(A,B,Select):<br/>    if (Select == "Add"):<br/>        return A+B<br/>    elif (Select == "Subtract"):<br/>        return A-B<br/>    elif (Select == "Multiply"):<br/>        return A*B<br/>    elif (Select == "Divide"):<br/>        return A/B</span></pre><p id="11bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，在这种情况下，基于Select参数，输出是不同的，您将不得不多次运行程序，以手动检查输出是否正确，老实说，这是一个真正的麻烦。</p><p id="3763" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们先试试“屁股痛”的版本。为了测试操作功能，我必须这样做</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="68a5" class="jx jy hi jt b fi jz ka l kb kc">result = operateNumbers(10,-2000,"Add")<br/>print("Result: "result)</span></pre><p id="3d93" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行脚本。转到输出，验证它是否显示</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c430" class="jx jy hi jt b fi jz ka l kb kc">Result: -1990</span></pre><p id="4d0f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后再做一遍减法、乘法和除法。想象一下，用1000行程序和复杂得多的函数来做这件事。伙计，太累了。但是不用担心，python的单元测试模块让它变得轻而易举。</p><p id="ae02" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们试试用单元测试的方法。operateNumbers的单元测试看起来就像这样简单</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="325a" class="jx jy hi jt b fi jz ka l kb kc">import unittest<br/>from myProgramFile import operateNumbers</span><span id="e717" class="jx jy hi jt b fi kd ka l kb kc">class testMyProgram(unittest.TestCase):<br/>   def test_operateNumbers(self):<br/>        self.assertEqual(operateNumbers(10,20,"Add"),30)<br/>        self.assertEqual(operateNumbers(10,20,"Subtract"),-10)<br/>        self.assertEqual(operateNumbers(10,20,"Multiply"),200)<br/>        self.assertEqual(operateNumbers(10,20,"Divide"),0.5)<br/>if __name__ == '__main__':<br/>    unittest.main()</span></pre><p id="c621" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您所要做的就是为单元测试创建一个类，用正确的语法定义一个测试函数，并使用assertEqual方法检查您是否得到了想要的值。Python的单元测试有更多的assert方法，如assertTrue、assertFalse、assertIsNone等，但它们都很简单，所以你真的应该查看一下<a class="ae ke" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="b1f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行脚本，您会看到类似这样的内容</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d090" class="jx jy hi jt b fi jz ka l kb kc">.<br/>--------------------------------------------------------------------<br/>Ran 1 test in 0.017s</span><span id="5db6" class="jx jy hi jt b fi kd ka l kb kc">OK</span></pre><p id="039e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这意味着您的单元(这里是out operateNumbers()函数)测试成功。假设我继续编写程序，在myProgramFile.py中添加了2个函数，在unitTest.py中添加了2个测试函数，由于一些错误，我将第一个函数的条件逻辑改为</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b903" class="jx jy hi jt b fi jz ka l kb kc">def operateNumbers(A,B,Select):<br/>    if (Select == "Subtract"): #notice i have changed add to sub<br/>        return A+B<br/>    elif (Select == "Add"): #and sub to add<br/>        return A-B<br/>    elif (Select == "Multiply"):<br/>        return A*B<br/>    elif (Select == "Divide"):<br/>        return A/B</span><span id="6d3f" class="jx jy hi jt b fi kd ka l kb kc">#the 2 other functions I wrote</span></pre><p id="3f52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我没有意识到我做了这个改变，所以没有预先写好的测试，我不会再次检查操作员的工作。但是，我们已经编写了测试代码！所以现在当我运行unitTest.py时。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cd27" class="jx jy hi jt b fi jz ka l kb kc">.F.</span><span id="5f6b" class="jx jy hi jt b fi kd ka l kb kc">====================================================================</span><span id="3052" class="jx jy hi jt b fi kd ka l kb kc">FAIL: test_operateNumbers (__main__.testMyProgram)</span><span id="cf01" class="jx jy hi jt b fi kd ka l kb kc">--------------------------------------------------------------------</span><span id="87c4" class="jx jy hi jt b fi kd ka l kb kc">Traceback (most recent call last):</span><span id="be33" class="jx jy hi jt b fi kd ka l kb kc">File "myProgramUnitTest.py", line 5, in test_operateNumbers</span><span id="8592" class="jx jy hi jt b fi kd ka l kb kc">self.assertEqual(operateNumbers(10,20,"Add"),30)</span><span id="10cf" class="jx jy hi jt b fi kd ka l kb kc">AssertionError: -10 != 30</span><span id="79e8" class="jx jy hi jt b fi kd ka l kb kc">-------------------------------------------------------------------</span><span id="aa62" class="jx jy hi jt b fi kd ka l kb kc">Ran 3 tests in 0.001s</span><span id="6c3e" class="jx jy hi jt b fi kd ka l kb kc">FAILED (failures=1)</span></pre><p id="10f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还有维奥拉。我们就这样发现了我们意想不到的错误及其位置。</p><p id="c38b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当你开始学习编程时，你最好学习测试你的代码。它不仅能节省你大量的时间，还能让你的程序更简洁，更容易调试，更容易协作。</p></div></div>    
</body>
</html>