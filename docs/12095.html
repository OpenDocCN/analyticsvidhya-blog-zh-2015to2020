<html>
<head>
<title>How to create a Postgres database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建Postgres数据库</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-create-a-postgres-database-394b362abfbe?source=collection_archive---------30-----------------------#2020-12-30">https://medium.com/analytics-vidhya/how-to-create-a-postgres-database-394b362abfbe?source=collection_archive---------30-----------------------#2020-12-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/4af3421229e71bad89b6f5665ee587e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9kZEeIFveAWBWAAXVyiLFw.png"/></div></div></figure><div class=""/><p id="1d24" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你好，你好，我的工程师同事们！</p><p id="eebf" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我最近整理了一个关于如何构建可伸缩Python应用程序的每周教程系列。第一集可以看这里:<a class="ae jn" href="https://youtu.be/0NcZjcGgkpE" rel="noopener ugc nofollow" target="_blank">https://youtu.be/0NcZjcGgkpE</a></p><p id="4733" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这篇文章是为了支持第2集，我们将为Python应用程序创建一个Postgres数据库。</p><p id="956b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将执行以下操作来设置数据库:</p><ul class=""><li id="b5a0" class="jo jp hs ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">安装postgres</li><li id="2614" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">创建SQL脚本:</li><li id="264c" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">创建一个“服装店”数据库</li><li id="e116" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">创建一个“衣服_库存”表</li><li id="9e0e" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">为衣服类型、颜色、性别和尺寸创建一个类型</li><li id="c3cc" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">创建回滚SQL脚本</li><li id="4fb6" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">运行脚本并创建数据库</li></ul><h2 id="c350" class="kc kd hs bd ke kf kg kh ki kj kk kl km ja kn ko kp je kq kr ks ji kt ku kv kw bi translated"><strong class="ak">安装Postgres </strong></h2><p id="85d1" class="pw-post-body-paragraph ip iq hs ir b is kx iu iv iw ky iy iz ja kz jc jd je la jg jh ji lb jk jl jm ha bi translated">如果你使用的是Mac，最简单的方法就是使用自制软件(参见<a class="ae jn" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">https://brew.sh/</a>)一旦你在终端上安装了自制软件，你就可以运行下面的命令来安装Postgres:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="3a07" class="kc kd hs lh b fi ll lm l ln lo">brew install postgresql</span><span id="613d" class="kc kd hs lh b fi lp lm l ln lo">brew services start postgres</span></pre><p id="970c" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，您应该能够在终端中运行<code class="du lq lr ls lh b">psql</code></p><h2 id="5af2" class="kc kd hs bd ke kf kg kh ki kj kk kl km ja kn ko kp je kq kr ks ji kt ku kv kw bi translated">创建SQL脚本</h2><p id="fc48" class="pw-post-body-paragraph ip iq hs ir b is kx iu iv iw ky iy iz ja kz jc jd je la jg jh ji lb jk jl jm ha bi translated">对于这个项目，我们正在创建一个服装店，所以我们需要跟踪商店的库存，下面是我们将运行的脚本(ClothesShop.sql ):</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="7114" class="kc kd hs lh b fi ll lm l ln lo">CREATE DATABASE clothes_shop;<br/><br/>\c clothes_shop<br/><br/>CREATE TYPE colours AS ENUM ('blue', 'green', 'red', 'yellow');<br/>CREATE TYPE sexes AS ENUM ('male', 'female');<br/>CREATE TYPE sizes AS ENUM ('small', 'medium', 'large');<br/><br/>CREATE EXTENSION IF NOT EXISTS "uuid-ossp";<br/><br/>CREATE TABLE clothes_stock (<br/>    id UUID NOT NULL DEFAULT uuid_generate_v4(),<br/>    clothes_name TEXT NOT NULL,<br/>    price <em class="lt">NUMERIC </em>NOT NULL,<br/>    cost <em class="lt">NUMERIC </em>NOT NULL,<br/>    colour colours NOT NULL,<br/>    sex sexes NOT NULL,<br/>    clothes_size sizes NOT NULL,<br/>    stock_level <em class="lt">int </em>NOT NULL<br/>);<br/><br/>INSERT INTO clothes_stock (clothes_name, price, cost, colour, sex, clothes_size, stock_level)<br/>VALUES ('Red T-shirt', 1.99, 0.99, 'red', 'male', 'small', 100);</span></pre><p id="220b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，我们创建名为“服装商店”的数据库。</p><p id="cd85" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，我们需要连接到数据库，以创建类型的颜色，性别和大小。</p><p id="71b2" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们需要创建扩展“uuid-ossp ”,这样我们就可以使用函数uuid_generate_v4()来自动生成我们的衣服库存id。</p><p id="a1e2" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后我们创建“衣服库存”表并插入第一个商品。</p><p id="ae30" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以在终端中运行以下脚本:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="e3e1" class="kc kd hs lh b fi ll lm l ln lo">psql -f ClothesShop.sql</span></pre><p id="f429" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，您应该能够看到新的数据库和表了。</p><p id="64ee" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在您的终端中键入以下内容:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="63db" class="kc kd hs lh b fi ll lm l ln lo">psql clothes_shop</span></pre><p id="144a" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="fea4" class="kc kd hs lh b fi ll lm l ln lo">\l</span></pre><figure class="lc ld le lf fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lu"><img src="../Images/bd02c5bb17212612d4941136745ded33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3-mM6dr2zvG-tI5bmbuBg.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">数据库衣服_商店已经创建</figcaption></figure><p id="4b97" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以使用以下代码查看表“衣服_库存”的描述:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="5d6f" class="kc kd hs lh b fi ll lm l ln lo">\d+ clothes_stock</span></pre><p id="0674" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，您应该会看到“衣服_库存”表的描述:</p><figure class="lc ld le lf fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lz"><img src="../Images/acb6d8ce4b6d84ad84aa73293eef6da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gEpvyj5ODi-vTJTktgdIpQ.png"/></div></div></figure><h2 id="6282" class="kc kd hs bd ke kf kg kh ki kj kk kl km ja kn ko kp je kq kr ks ji kt ku kv kw bi translated">创建回滚</h2><p id="ff9b" class="pw-post-body-paragraph ip iq hs ir b is kx iu iv iw ky iy iz ja kz jc jd je la jg jh ji lb jk jl jm ha bi translated">最佳实践(除了对您的SQL脚本进行版本控制之外)是创建一个回滚脚本，这样如果出现问题，您可以回滚您的更改。在这个项目中，我们只有一个非常简单的数据库和表设置。</p><p id="8a13" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果我们想要删除我们刚刚创建的内容，那么我们需要运行以下脚本(ClothesShopRollback.sql):</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="b818" class="kc kd hs lh b fi ll lm l ln lo">\c clothes_shop<br/><br/>DROP TABLE clothes_stock;<br/><br/>DROP TYPE IF EXISTS colours;<br/>DROP TYPE IF EXISTS sexes;<br/>DROP TYPE IF EXISTS sizes;<br/><br/>\c postgres<br/><br/>DROP DATABASE clothes_shop;</span></pre><p id="f399" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">脚本中的第一步是连接到“衣服商店”数据库，然后我们希望以与创建它们相反的顺序删除它们(因此有术语回滚)。</p><p id="9cde" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们删除表“衣服_库存”(以及其中的任何商品)，然后删除我们为这个数据库创建的类型。</p><p id="d60f" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，我们切换到另一个数据库来删除数据库“衣服_商店”,因为您不能删除当前连接的数据库。</p><p id="72c7" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要回滚脚本，请在终端中运行以下命令:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="7387" class="kc kd hs lh b fi ll lm l ln lo">psql -f ClothesShopRollback.sql</span></pre><p id="3a97" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您现在应该看不到数据库了:</p><p id="8b5b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在您的终端中运行以下命令:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="6501" class="kc kd hs lh b fi ll lm l ln lo">psql</span></pre><p id="ac95" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后运行:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="0d89" class="kc kd hs lh b fi ll lm l ln lo">\l</span></pre><p id="9667" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您现在应该看到您的数据库不再存在:</p><figure class="lc ld le lf fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ma"><img src="../Images/804e8e2a6a89722eedd21ee7e16cff39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QeeNBCaCoGdy3usLfhovgA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">数据库衣服商店不再存在</figcaption></figure><p id="11e7" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这就是本教程，我希望你觉得有用。如果您有任何问题，请随意评论，我会在下一个问题上与您联系！</p></div></div>    
</body>
</html>