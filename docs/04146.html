<html>
<head>
<title>Powershell Set Operations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Powershell集合操作</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/powershell-set-operations-47b03045459a?source=collection_archive---------18-----------------------#2020-03-06">https://medium.com/analytics-vidhya/powershell-set-operations-47b03045459a?source=collection_archive---------18-----------------------#2020-03-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b88b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">集合操作可以对传递给它们的对象集合进行过滤、排序、分组和选择操作。</p><p id="d3f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">过滤(Where-Object) </strong></p><p id="5fde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">Get-Service</code> cmdlet获取代表计算机上服务的对象。现在，我想向您展示如何过滤<code class="du jd je jf jg b">Get-Service</code>结果集。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="9cf9" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Where-Object name -eq “MSSQLSERVER”</span></pre><figure class="jh ji jj jk fd jw er es paragraph-image"><div class="er es jv"><img src="../Images/af53babdf73e5d83465e9f07ca29146f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*IoXN6VC4Sqg1YzaQGII2dA.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">过滤结果集</figcaption></figure><p id="b3a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是同义词:</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="3cfa" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Where name -eq “MSSQLSERVER”<br/>Get-Service|? name -eq “MSSQLSERVER”</span></pre><p id="9e95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要在过滤器中添加多个标准。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="5050" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Where-Object {$PSItem.Name -like “*sql*” -and $PSItem.Status -eq “Running”}</span></pre><p id="17e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">排序(排序对象)</strong></p><p id="e52a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用sort-object对<code class="du jd je jf jg b">Get-Service</code> cmdlet结果集进行排序。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="81b4" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Sort-Object name # sort by name<br/>Get-Service|Sort-Object Status # sort by Status</span></pre><p id="8b0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用降序排列。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="14c3" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Sort-Object -Descending Name</span></pre><p id="1c99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是分类对象的同义词</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="a762" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Sort -Descending Name</span></pre><p id="b66b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分组(组-对象)</strong></p><p id="34db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用Group-Object对Get-Service cmdlet进行分组。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="9b2f" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Group-Object Status</span></pre><figure class="jh ji jj jk fd jw er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/a7ad087706c620c0fe7c7ec5dbdddd3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKq56kZZ0gZ2A9lcSzOR7w.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">分组结果集</figcaption></figure><p id="637b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选择(选择对象)</strong></p><p id="fdb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用Select-Object选择Get-Service cmdlet的指定属性。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="9181" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Select-Object Name</span></pre><p id="b91b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以选择不止一个属性。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="6a95" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Select-Object Name,ServiceType,Status</span></pre><p id="922f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果希望看到前N条记录，应该使用-First参数。此示例显示了前10条记录。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="cf6e" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Select-Object -First 10 Name,ServiceType,Status</span></pre><p id="b3b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们想显示所有属性，我们可以使用select *(如sql)。在此示例中，我们可以看到第一条记录的所有属性。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="9814" class="jp jq hi jg b fi jr js l jt ju">Get-Service|Select-Object -First 1 *</span></pre><p id="dcf3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同义词是Select。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="d37d" class="jp jq hi jg b fi jr js l jt ju">Get-Service|select Name,ServiceType,Status</span></pre><p id="f0ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">全部在一个样本中:</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="4504" class="jp jq hi jg b fi jr js l jt ju">Get-Service|where name -like ‘M*’|sort Name|select -first 5 Name,Status,StartType|group-object Status</span></pre><p id="b553" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">低于样本。它得到，名称以' M '服务开始，然后按名称属性排序，并选择前5个记录。最后，它按状态属性分组。</p></div></div>    
</body>
</html>