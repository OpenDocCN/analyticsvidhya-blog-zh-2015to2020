<html>
<head>
<title>Generative Adversarial Networks: A Rival Makes You Stronger</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生成性对抗网络:竞争对手让你更强大</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/generative-adversarial-networks-a-rival-makes-you-stronger-d0b2aa87e06c?source=collection_archive---------28-----------------------#2020-04-07">https://medium.com/analytics-vidhya/generative-adversarial-networks-a-rival-makes-you-stronger-d0b2aa87e06c?source=collection_archive---------28-----------------------#2020-04-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="6206" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">简介</strong></h1><p id="1f49" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">生成敌对网络或gan是生成模型，它创建反映原始数据的新数据实例。它由两个网络组成，一个是生成器，一个可以生成新数据实例的模型，另一个是鉴别器，一个可以鉴别不同类型数据实例的模型。这里有一个用GANs生成的图像的例子。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/e9d9a928f71c44648d39834be57c6e83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TyB6EPdsfWb1sv4J79a30A.jpeg"/></div></div></figure><p id="9542" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">上面的图片是甘通过查看和的时装数据库重新制作的。</p><h1 id="de7f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">甘的结构</strong></h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ks"><img src="../Images/6db3e589ca856e29f55dbe852e5df200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*iiwBrzw3TdHZs1YsNQWzgw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">图1:甘的结构</figcaption></figure><p id="6632" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">在这里，我们可以看到生成器接受一个随机输入，并生成一个样本，即一个虚假的数据实例。然后将该假冒实例传递给鉴别器，以对其真假进行分类。根据该预测，我们计算用于训练网络的损耗。所以让我们一个一个的检查模型。</p><h1 id="2d38" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">鉴别器</h1><p id="b5d9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">鉴别器只是一个二元分类器。我们可以使用任何适合数据分类的分类器网络。它试图从生成器创建的数据中区分真实数据。并且它可以通过鉴别器损失(二进制分类损失)的反向传播来训练。我们将真实图像和生成图像的标签分别视为1和0。我们可以看到，在图1中，鉴别器连接到两个损失函数。在鉴频器训练期间，鉴频器忽略发电机损耗，仅使用鉴频器损耗。并且在训练发电机时使用发电机损耗。但是等等，甘本身不就是单品模特吗？为什么我们需要用不同的损耗分别训练它的零件？这是竞争开始的地方。我们以后再讨论。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kx"><img src="../Images/d226646f74bfc00177f8f7a4e76b26e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*KB1f0dpwGy03GXyFskNumA.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">图2:鉴别器</figcaption></figure><h1 id="62ff" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">发电机</h1><p id="213a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">GAN的生成器部分试图从潜在空间(用于播种生成过程的固定长度的随机向量)生成假数据。根据鉴别器给出的反馈来训练发生器。它的工作是使鉴别器将其输出分类为真实的。因此，如果鉴别器将生成器生成的虚假数据归类为真实数据，则生成器会收到正反馈，如果发生相反的情况，则生成器会收到负反馈并尝试改进。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ks"><img src="../Images/9284802728259c92b3e8764a0c00ed4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*VPVSY40GZYs3hfWx25MWMg.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">图3:生成器</figcaption></figure><p id="419e" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">但是发电机的训练与普通网络有很大不同，为了训练它们，我们改变网络的权重以减少其输出的损失。然而，在GANs情况下，发电机并不直接与其试图影响的损耗(发电机损耗)相连。发生器将产生的数据馈送给鉴别器，鉴别器的预测决定发生器的损耗。</p><h1 id="d6ca" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">如何训练一个甘？</h1><p id="5d91" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">GAN包含两个可单独训练的网络。有许多方法可以训练GAN，但我们将使用的一种方法是，首先我们将训练鉴别器，以便它学习分类，然后我们训练生成器。在生成器训练期间，我们确保鉴别器不可训练。这是一个两步过程，我们停止发电机和训练鉴别器，然后我们停止鉴别器和训练发电机。</p><p id="c7c5" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">这就是奇迹发生的地方。GAN的独特之处在于它根据另一个网络的反馈来训练自己。这意味着鉴别器越好，发生器就越好。生成器试图欺骗鉴别器，使其认为生成的图像是真实的，而鉴别器试图不被生成器欺骗。因此，如果鉴别器是强大的，那么它可以很容易地区分真假，这将使生成器很难试图欺骗鉴别器，并将改进这样做。这两个网络之间的竞争使得甘的训练如此独特。</p><p id="093d" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">但是我们什么时候才能说模型训练好了呢？就是当我们看到鉴别器把真实图像和生成的图像都归类为真实的时候。这个均衡被称为<strong class="jf hj">纳什均衡</strong>。</p><p id="8a36" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">现在，我们将使用一个简单的深度卷积GAN(DCGAN)通过Tensorflow从时尚_MNIST数据集生成数据样本。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ky"><img src="../Images/5fad97c4728461cd923b4459364fa2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*ZpEI7Hy7ehBFxavOChTN1Q.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">时尚MNIST数据集</figcaption></figure><h1 id="6f92" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">让我们建立我们的GAN模型</h1><p id="752d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们将使用TensorFlow框架来构建和训练模型。</p><p id="49a7" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">1-首先导入所有必需的包</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="832a" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">2-设置数据集</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="58ad" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">3-创建发电机模型</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="cd21" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">4-创建鉴别器模型</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="2fe5" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">5-损失和优化</p><ul class=""><li id="c43b" class="lb lc hi jf b jg kn jk ko jo ld js le jw lf ka lg lh li lj bi translated"><strong class="jf hj">鉴别器损失</strong>:将鉴别器对真实图像的预测与1的数组进行比较，将鉴别器对伪造(生成)图像的预测与0的数组进行比较。</li><li id="4a31" class="lb lc hi jf b jg lk jk ll jo lm js ln jw lo ka lg lh li lj bi translated"><strong class="jf hj">发生器损耗:</strong>发生器损耗量化了它欺骗鉴别器的能力。这意味着如果生成器运行良好，鉴别器会将假图像归类为真图像(=1)。这里，我们将把鉴别器对生成图像的判断与1的数组进行比较。</li></ul><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="1d77" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">6-训练模型</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="e911" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">7-生成输出</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="d9b0" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">然后你会得到这样的输出，</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lp"><img src="../Images/8c9323e817da14e7f8a1e1d38f654aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*afiayBfzi4-WWQk8cln2Ww.png"/></div></figure><p id="78ac" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">这是由发电机产生的，够近了吧:-)</p><p id="1c2f" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">如果你愿意的话，你也可以生成一个GIF，它可以通过你的生成器在每一个时期的输出来制作动画，就像这样，</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lp"><img src="../Images/ab1c54ee85eac29a59efd7a697782e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/1*Q5nw2bMS1zUmh7uQJHcDxg.gif"/></div></figure><p id="f5f6" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">我将很快发布如何使用python从任意一组图像生成gif。</p></div></div>    
</body>
</html>