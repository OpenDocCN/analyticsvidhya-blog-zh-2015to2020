<html>
<head>
<title>Python Stock Visualizer with Robin_Stock</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Robin_Stock的Python股票可视化工具</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-stock-visualizer-with-robin-stock-4dc0882eb33d?source=collection_archive---------11-----------------------#2020-06-30">https://medium.com/analytics-vidhya/python-stock-visualizer-with-robin-stock-4dc0882eb33d?source=collection_archive---------11-----------------------#2020-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="954d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最近对股票数据非常感兴趣；作为一个程序员新手，我想创建一个易于理解的程序，并可以用来观察股票市场。</p><p id="8e93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个程序/教程将向您展示如何获得实时和历史股票数据，并使用Python将其实时可视化，允许您监控您已经投资的股票。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a6d7245d29d75fce22f1735a40277ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xms6_-CE-BoM4Q-O_DUV6w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">显示当前和历史股票数据的GUI</figcaption></figure><p id="984b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本教程将分为两个部分，在这里您可以看到如何获得数据，然后使用<a class="ae jt" href="https://docs.python.org/3/library/tkinter.html" rel="noopener ugc nofollow" target="_blank"> tkinter </a>和<a class="ae jt" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>在GUI中可视化数据。</p><h1 id="18cc" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">获取数据</h1><p id="1a3e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了获得这个项目的数据，我们将使用<a class="ae jt" href="https://robin-stocks.readthedocs.io/en/latest/functions.html#getting-stock-information" rel="noopener ugc nofollow" target="_blank">罗宾_斯托克</a>；这个<a class="ae jt" href="http://www.robin-stocks.com/en/latest/quickstart.html" rel="noopener ugc nofollow" target="_blank"> API </a>非常适合获取当前和历史数据，它具有从跟踪股票到买卖股票的功能。您将需要一个<a class="ae jt" href="https://robinhood.com/us/en/" rel="noopener ugc nofollow" target="_blank"> RobinHood </a>登录名来获取数据。使用<em class="kx"> authentication.login() </em>功能，您将使用您的凭证登录，并且您将在首次登录时收到短信确认。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="4b60" class="ld jv hi kz b fi le lf l lg lh">r.authentication.login(username="user", password="pass")</span></pre><p id="c80d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要获得股票的当前价格，可以使用<em class="kx">stocks . get _ latest _ price()</em>函数。这将返回一个字符串列表，因此我们可以使用这段代码，通过获取第一个元素，将其转换为浮点型，并对其进行舍入，以更好的格式获取它。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="9514" class="ld jv hi kz b fi le lf l lg lh">round(float(r.stocks.get_latest_price(ticker_symbol)[0]), 2)</span></pre><p id="06b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了获得历史数据，我们将使用<em class="kx">stocks . get _ stock _ historicals()</em>函数。这个函数有多个参数，可以用来收集各种数据。我们感兴趣的是股票代码、区间和跨度。下面是一个如何获取数据的示例。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="78f4" class="ld jv hi kz b fi le lf l lg lh">r.stocks.get_stock_historicals(symbol, interval="5minute", span="day")</span></pre><p id="644d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将输出一个包含多个字典的大列表。为了让它变成一个更适合pandas的格式，第一步是使用<em class="kx"> pandas从输出中创建一个pandas <a class="ae jt" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank"> DataFrame </a>。DataFrame() </em>函数；从那里，我们可以使用数据转换来获得我们想要的输出。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="7736" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个例子将返回一个日期数组，它的格式便于我们绘图。这是通过将数据帧的<em class="kx">‘begins _ at’</em>列转换为<a class="ae jt" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html" rel="noopener ugc nofollow" target="_blank"> datetime </a>格式，从转换后的数据帧创建<a class="ae jt" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DatetimeIndex.html" rel="noopener ugc nofollow" target="_blank"> DatetimeIndex </a> pandas数据帧，最后<a class="ae jt" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.dt.tz_convert.html" rel="noopener ugc nofollow" target="_blank">转换为正确的时区</a>来完成的。这就是转变的样子。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="73a2" class="ld jv hi kz b fi le lf l lg lh">2020-06-26T13:30:00Z ➡ '2020-06-26 13:30:00+00:00' ➡ '09:30:00'</span></pre><p id="cb99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过使用<em class="kx"> markets.get_top_movers() </em>函数，可以获取的其他一些重要数据包括当天的主要移动者。在我看来，生成的数据帧中最有用的两列是符号<em class="kx">和<em class="kx"> price_movement </em>，它们给出了股票代码、股票价格和百分比变化。</em></p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="0735" class="ld jv hi kz b fi le lf l lg lh"># get the movers going up<br/>pd.DataFrame(r.markets.get_top_movers("up"))</span><span id="5304" class="ld jv hi kz b fi lk lf l lg lh"># get the movers going down<br/>pd.DataFrame(r.markets.get_top_movers("down"))</span></pre><p id="9414" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用robin_stock还可以做很多事情，比如买卖股票，但是这几个函数涵盖了robin_stock的大部分跟踪功能。</p><h1 id="952f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">可视化数据</h1><p id="0eed" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">Tkinter包是创建你自己的GUI(图形用户界面)的最简单的方法之一。为了初始化GUI，您将创建一个名为root的变量。每当您想在GUI中放置一些东西时，您将调用这个对象中的方法。要启动GUI，最后一行代码应该调用<em class="kx"> mainloop() </em>函数来循环并刷新GUI。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="ec66" class="ld jv hi kz b fi le lf l lg lh"># initialize the GUI<br/>root = Tk()</span><span id="45cd" class="ld jv hi kz b fi lk lf l lg lh"># last line of code to start the loop<br/>root.mainloop()</span></pre><p id="ce58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在初始化根之后，您可以开始添加元素来获得您想要的布局。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/cdf299b99c47f23de99ce5317832700a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0AgQD1ceCpEYMVHR-BVJw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">GUI布局示例</figcaption></figure><p id="dd94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://www.tutorialspoint.com/python/tk_label.htm" rel="noopener ugc nofollow" target="_blank">标签</a>是在Tkinter中显示文本的最简单方式。还可以使用一个字符串变量来操纵文本，这使得它非常适合显示不断刷新的当前价格。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="50f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">列表框允许你在你的GUI中显示一个列表。当您单击列表中的一个项目时，Listbox也会返回一个事件，这允许on事件功能。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="5164" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后一步是用<a class="ae jt" href="https://matplotlib.org/3.2.2/contents.html" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>绘图。当<a class="ae jt" href="https://matplotlib.org/3.1.0/gallery/user_interfaces/embedding_in_tk_sgskip.html" rel="noopener ugc nofollow" target="_blank">与Tkinter </a>集成时，我们不使用像<em class="kx"> plt.show() </em>这样的函数，而是使用画布和<em class="kx"> draw() </em>函数来绘制图形。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><h2 id="beee" class="ld jv hi bd jw lm ln lo ka lp lq lr ke iq ls lt ki iu lu lv km iy lw lx kq ly bi translated">将这一切结合在一起</h2><p id="8fdc" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了将所有代码放在一起，我们需要为所有要运行的东西创建一个循环，并创建一个启动函数来获取运行点之前的每日数据。我们还想定义活动时间，因为股票市场只在特定的日期和特定的时间段开放。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="ee70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">要查看该项目的代码，点击</strong> <a class="ae jt" href="https://github.com/PriyaSoneji/StockVisualization" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">此处</strong> </a> <strong class="ih hj">。</strong><em class="kx">stock visualizer bin . py</em>将突出显示本教程中教授的所有内容，并将显示本文顶部显示的实时跟踪GUI。</p><p id="cce2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是一些其他有用的文章，可能也会对你有所帮助:</p><ul class=""><li id="6c30" class="lz ma hi ih b ii ij im in iq mb iu mc iy md jc me mf mg mh bi translated"><a class="ae jt" href="https://towardsdatascience.com/using-python-to-get-robinhood-data-2c95c6e4edc8" rel="noopener" target="_blank">获取罗宾汉数据</a></li><li id="936e" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated"><a class="ae jt" href="https://towardsdatascience.com/how-to-get-stock-data-using-python-c0de1df17e75" rel="noopener" target="_blank">用Python获取股票数据</a></li><li id="6062" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated"><a class="ae jt" href="https://towardsdatascience.com/a-comprehensive-guide-to-downloading-stock-prices-in-python-2cd93ff821d4" rel="noopener" target="_blank">用Python下载股票价格</a>。</li></ul><p id="dfd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这篇文章有所帮助！</p></div></div>    
</body>
</html>