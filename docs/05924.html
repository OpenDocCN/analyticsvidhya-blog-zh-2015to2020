<html>
<head>
<title>Building Python APIs with Flask, Flask-RESTPlus / Flask-RESTX, and Swagger UI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Flask、Flask-RESTPlus / Flask-RESTX和Swagger UI构建Python APIs</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/swagger-ui-dashboard-with-flask-restplus-api-7461b3a9a2c8?source=collection_archive---------2-----------------------#2020-05-06">https://medium.com/analytics-vidhya/swagger-ui-dashboard-with-flask-restplus-api-7461b3a9a2c8?source=collection_archive---------2-----------------------#2020-05-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="adc5" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">编程；编排</h2><div class=""/><div class=""><h2 id="d329" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">如何用Python搭建一个交互式API仪表盘？</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es jg"><img src="../Images/2fc58c61c8ebc7e18cec9add1a044e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*qNObOeuqBv9nsFvuA2MWfA.jpeg"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">照片由<a class="ae js" href="https://unsplash.com/@paytonctuttle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">佩顿·塔特尔</a>在<a class="ae js" href="https://unsplash.com/s/photos/laptop-book?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="746f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ix ke iy kf ja kg jb kh jd ki je kj kk bi translated">什么是Swagger UI？</h1><p id="6c3b" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">Swagger UI是一个可视化和与API交互的工具，它是使用OpenAPI规范自动生成的。它会生成一个网页，帮助我们记录各种API并与之交互。</p><h1 id="f829" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ix ke iy kf ja kg jb kh jd ki je kj kk bi translated">什么是Flask-RESTPlus？</h1><p id="55a3" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">Flask-RESTPlus是Flask的扩展，它鼓励用最少的设置实现最佳实践。它提供了一组装饰器和工具来描述API，并使用Swagger公开其文档。</p><blockquote class="lh li lj"><p id="f7c6" class="kl km lk kn b ko ll is kq kr lm iv kt ln lo kw kx lp lq la lb lr ls le lf lg hb bi translated">注:不再维护Flask-RESTPlus。考虑使用<a class="ae js" href="https://flask-restx.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> Flask-RESTX </a>，Flask-RESTPlus的一个分支</p></blockquote></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="f2fc" class="jt ju hi bd jv jw ma jy jz ka mb kc kd ix mc iy kf ja md jb kh jd me je kj kk bi translated">装置</h1><p id="0ca9" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">可以用pip安装<a class="ae js" href="https://flask-restplus.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> Flask-RESTPlus </a></p><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="beb6" class="mk ju hi mg b be ml mm l mn mo">pip install flask-restplus</span></pre><p id="1979" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">或者使用pip安装<a class="ae js" href="https://flask-restplus.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Flask-RESTX </a>(推荐):</p><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="2c64" class="mk ju hi mg b be ml mm l mn mo">pip install flask-restx</span></pre></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="3565" class="jt ju hi bd jv jw ma jy jz ka mb kc kd ix mc iy kf ja md jb kh jd me je kj kk bi translated">最小API</h1><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="f25d" class="mk ju hi mg b be ml mm l mn mo">from flask import Flask<br/>from flask_restplus import Api, Resource<br/><br/>app = Flask(__name__)<br/>api = Api(app)<br/><br/>@api.route('/hello/')<br/>class HelloWorld(Resource):<br/>    def get(self):<br/>        return "Hello World"<br/>    <br/>if __name__ == '__main__':<br/>    app.run()</span></pre><blockquote class="lh li lj"><p id="0aad" class="kl km lk kn b ko ll is kq kr lm iv kt ln lo kw kx lp lq la lb lr ls le lf lg hb bi translated"><strong class="kn hs">注意:</strong>如果你正在使用Flask-RESTX，那么将导入<code class="du mp mq mr mg b">from flask_restplus import Api, Resource</code>改为<code class="du mp mq mr mg b">from flask_restx import Api, Resource</code>。代码的其余部分保持不变。</p></blockquote><p id="8ade" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">将此文件保存为<code class="du mp mq mr mg b">app.py</code> <em class="lk">(或者你想要的任何其他文件名)</em>，进入终端，键入<code class="du mp mq mr mg b">python app.py</code>(即<code class="du mp mq mr mg b">python &lt;filename&gt;.py</code>)启动程序。</p><p id="5ee1" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">如果您在部署时收到以下错误:</p><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="982d" class="mk ju hi mg b be ml mm l mn mo">from werkzeug import cached_property<br/>ImportError: cannot import name 'cached_property'</span></pre><p id="38f5" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">在导入flask_restplus之前添加以下行:</p><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="7aea" class="mk ju hi mg b be ml mm l mn mo">import werkzeug<br/>werkzeug.cached_property = werkzeug.utils.cached_property</span></pre><p id="869a" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">现在，启动浏览器并转到<code class="du mp mq mr mg b">http://localhost:5000</code>，您应该会看到这个屏幕:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es ms"><img src="../Images/2c92f60985ef5f83e3854d2751f1bc38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xnNBsvokfRnrChioj3umxw.png"/></div></div></figure><p id="f8de" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">这是Swagger UI屏幕。它允许您使用<strong class="kn hs">试用</strong>按钮查看所有端点并测试API。</p><p id="a831" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">您也可以通过访问<code class="du mp mq mr mg b">http://localhost:5000/swagger.json</code>来查看Swagger文件的内容。为上述代码生成的Swagger文件如下:</p><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="6036" class="mk ju hi mg b be ml mm l mn mo">{<br/>    "swagger": "2.0",<br/>    "basePath": "/",<br/>    "paths": {<br/>        "/hello/": {<br/>            "get": {<br/>                "responses": {<br/>                    "200": {<br/>                        "description": "Success"<br/>                    }<br/>                },<br/>                "operationId": "get_hello_world",<br/>                "tags": [<br/>                    "default"<br/>                ]<br/>            }<br/>        }<br/>    },<br/>    "info": {<br/>        "title": "API",<br/>        "version": "1.0"<br/>    },<br/>    "produces": [<br/>        "application/json"<br/>    ],<br/>    "consumes": [<br/>        "application/json"<br/>    ],<br/>    "tags": [<br/>        {<br/>            "name": "default",<br/>            "description": "Default namespace"<br/>        }<br/>    ],<br/>    "responses": {<br/>        "ParseError": {<br/>            "description": "When a mask can't be parsed"<br/>        },<br/>        "MaskError": {<br/>            "description": "When any error occurs on mask"<br/>        }<br/>    }<br/>}</span></pre></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="6553" class="jt ju hi bd jv jw ma jy jz ka mb kc kd ix mc iy kf ja md jb kh jd me je kj kk bi translated">提取请求参数</h1><p id="9bf9" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">您可以使用<code class="du mp mq mr mg b">reqparse</code>获取API调用期间传递的参数</p><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="4217" class="mk ju hi mg b be ml mm l mn mo">from flask import Flask<br/>from flask_restplus import Api, Resource, reqparse<br/><br/>app = Flask(__name__)<br/>api = Api(app)<br/><br/>parser = reqparse.RequestParser()<br/>parser.add_argument('name', help='Specify your name')<br/><br/>@api.route('/hello/')<br/>class HelloWorld(Resource):<br/>    @api.doc(parser=parser)<br/>    def get(self):        <br/>        args = parser.parse_args()<br/>        name = args['name']<br/>        return "Hello " + name<br/>    <br/>if __name__ == '__main__':<br/>    app.run()</span></pre><p id="d8d6" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">在上面的代码中，<code class="du mp mq mr mg b">parser.parse_args()</code>返回一个字典，其中键作为参数的名称，值作为查询中传递的值。</p><p id="da1f" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">这将生成如下的Swagger UI:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es ms"><img src="../Images/4db5c48cfb1372cebb6e9f51196a0e5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2egoYJoZMh9-f3Vf86UAfg.png"/></div></div></figure><p id="ada3" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">点击<strong class="kn hs">试用</strong>按钮检查API。这将导致以下输出:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es ms"><img src="../Images/9dc811f4dd16dc7fc956e8a6ca44b795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKNXRcS0KWe3spdpvLflkg.png"/></div></div></figure></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="3eaf" class="jt ju hi bd jv jw ma jy jz ka mb kc kd ix mc iy kf ja md jb kh jd me je kj kk bi translated">文件上传</h1><p id="f07d" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">要使用文件上传，将位置设置为<code class="du mp mq mr mg b">files</code>并键入<code class="du mp mq mr mg b">FileStorage</code></p><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="bc11" class="mk ju hi mg b be ml mm l mn mo">from flask import Flask<br/>from flask_restplus import Api, Resource<br/>from werkzeug.datastructures import FileStorage<br/><br/>app = Flask(__name__)<br/>api = Api(app)<br/><br/>upload_parser = api.parser()<br/>upload_parser.add_argument('file', <br/>                           location='files',<br/>                           type=FileStorage)<br/><br/>@api.route('/upload/')<br/>@api.expect(upload_parser)<br/>class UploadDemo(Resource):<br/>    def post(self):<br/>        args = upload_parser.parse_args()<br/>        file = args.get('file')<br/>        print(file.filename)<br/>        return "Uploaded file is " + file.filename<br/><br/>if __name__ == '__main__':<br/>    app.run()</span></pre><p id="aae6" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">为上述代码生成的Swagger UI如下所示:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es mx"><img src="../Images/a89fcaebb9d4236fc9930e0f5b164f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SZOXhN-C3zixr2u0et-P6A.png"/></div></div></figure></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="1a79" class="jt ju hi bd jv jw ma jy jz ka mb kc kd ix mc iy kf ja md jb kh jd me je kj kk bi translated">API参数</h1><pre class="jh ji jj jk fd mf mg mh bn mi mj bi"><span id="0a24" class="mk ju hi mg b be ml mm l mn mo">api = Api(app,<br/>          version='10.5',<br/>          title='Flask Restplus Demo',<br/>          description='Demo to show various API parameters',<br/>          license='MIT',<br/>          contact='Jimit Dholakia',<br/>          contact_url='https://in.linkedin.com/in/jimit105',<br/>          doc = '/docs/',<br/>          prefix='/test'<br/>          )</span></pre><p id="a446" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">version</code> → API版本(用于Swagger文档)</p><p id="6c55" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">title</code> → API标题(用于Swagger文档)</p><p id="0ee5" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">description</code> → API描述(用于Swagger文档)</p><p id="abe1" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">license</code> →指定API的许可(用于Swagger文档)</p><p id="0b99" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">license_url</code> →指定许可证页面URL(用于Swagger文档)</p><p id="d052" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">contact</code> →指定联系人(用于Swagger文档)</p><p id="4cbd" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">contact_email</code> →指定联系人的电子邮件地址(用于Swagger文档)</p><p id="194e" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">contact_url</code> →指定联系人的URL(用于Swagger文档)</p><p id="9aa6" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">doc</code> →指定Swagger UI文档的路径。默认为<code class="du mp mq mr mg b">'/'</code></p><p id="c2d9" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated"><code class="du mp mq mr mg b">prefix</code> →为URL的所有端点指定前缀</p><p id="a093" class="pw-post-body-paragraph kl km hi kn b ko ll is kq kr lm iv kt ku lo kw kx ky lq la lb lc ls le lf lg hb bi translated">为上述代码生成的Swagger UI如下:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es my"><img src="../Images/6207dadc76d846b416a1a9d28be6b2c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*dT5Up8teEqrUPQSSLY5ecA.png"/></div></figure></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h2 id="0423" class="mz ju hi bd jv na nb nc jz nd ne nf kd ku ng nh kf ky ni nj kh lc nk nl kj ho bi translated">参考</h2><ul class=""><li id="0053" class="nm nn hi kn b ko kp kr ks ku no ky np lc nq lg nr ns nt nu bi translated"><a class="ae js" href="https://flask-restplus.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">https://flask-restplus.readthedocs.io/en/stable/</a></li><li id="99ea" class="nm nn hi kn b ko nv kr nw ku nx ky ny lc nz lg nr ns nt nu bi translated"><a class="ae js" href="https://flask-restplus.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank">https://flask-restplus.readthedocs.io/en/stable/index.html</a></li></ul><h2 id="680a" class="mz ju hi bd jv na nb nc jz nd ne nf kd ku ng nh kf ky ni nj kh lc nk nl kj ho bi translated">资源</h2><p id="6104" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">这篇文章的所有代码片段都可以在我的GitHub页面上找到。</p><h2 id="6893" class="mz ju hi bd jv na nb nc jz nd ne nf kd ku ng nh kf ky ni nj kh lc nk nl kj ho bi translated">推荐阅读</h2><p id="8ef3" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated"><a class="ae js" rel="noopener" href="/p/655bad51b24">使用Flask和Python创建RESTful Web API</a></p><h2 id="91fe" class="mz ju hi bd jv na nb nc jz nd ne nf kd ku ng nh kf ky ni nj kh lc nk nl kj ho bi translated">让我们连接</h2><p id="f01f" class="pw-post-body-paragraph kl km hi kn b ko kp is kq kr ks iv kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">领英:<a class="ae js" href="https://www.linkedin.com/in/jimit105/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jimit105/</a>T26】GitHub:<a class="ae js" href="https://github.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://github.com/jimit105</a>T29】推特:<a class="ae js" href="https://twitter.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://twitter.com/jimit105</a></p></div></div>    
</body>
</html>