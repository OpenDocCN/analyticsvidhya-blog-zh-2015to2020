<html>
<head>
<title>Heart Disease Prediction With Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习的心脏病预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/heart-disease-prediction-with-machine-learning-d22bc924d8ab?source=collection_archive---------12-----------------------#2020-07-04">https://medium.com/analytics-vidhya/heart-disease-prediction-with-machine-learning-d22bc924d8ab?source=collection_archive---------12-----------------------#2020-07-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dd88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">(使用Streamlit的开源应用框架)</em></p><h2 id="7ad8" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><strong class="ak">什么是机器学习？</strong></h2><p id="1b69" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">机器学习是让计算机像人类一样学习和行动的科学，并通过以观察和现实世界交互的形式向它们提供数据和信息，以自主的方式随着时间的推移改善它们的学习。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div class="er es ke"><img src="../Images/08bf274a1e6d493eec02f098c749d096.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*Ct9FW9E_gGld7y2totYjdQ.png"/></div></figure><h2 id="d83a" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><strong class="ak">什么是Streamlit？</strong></h2><p id="c6a9" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">Streamlit让你用看似简单的Python脚本为你的机器学习项目创建应用。它支持热重新加载，因此当您编辑和保存文件时，您的应用程序会实时更新。不需要弄乱HTTP请求、HTML、JavaScript等。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div class="er es km"><img src="../Images/bfdee3d0107e5fe9355fe3c81e2034d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*OQIrf6YLpttLGSPd1ImlcQ.png"/></div></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="00c1" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">心脏病预测应用概述</h2><p id="0b51" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">这是一个简单的基于机器学习的网络应用程序，可以预测这个人是否患有心脏病。</p><p id="2e2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的数据集取自互联网，根据其中的特征将其分为心脏病患者和非心脏病患者。这些数据将用于创建一个模型，该模型将尝试预测患者是否患有心脏病。</p><p id="e4a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将需要使用三个Python库，即<code class="du ku kv kw kx b">streamlit</code>、<code class="du ku kv kw kx b">pandas</code>和<code class="du ku kv kw kx b">scikit-learn</code>。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="25f8" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">【Streamlit的安装步骤:</h2><p id="72c0" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">打开命令提示符或终端，键入以下命令:</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="9ee4" class="je jf hi kx b fi lc ld l le lf">pip install streamlit </span></pre><h2 id="6151" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><strong class="ak">安装其他需要的库:</strong></h2><p id="8a21" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated"><strong class="ih hj"> pandas : </strong> pandas是一个快速、强大、灵活且易于使用的开源数据分析和操作工具，构建于Python编程语言之上。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="0996" class="je jf hi kx b fi lc ld l le lf">pip install pandas</span></pre><p id="22ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">sci kit-learn</strong>:sci kit-learn(以前叫scikit.learn，也叫sklearn)是一个Python编程语言的免费软件机器学习库。它具有各种分类、回归和聚类算法，包括支持向量机、随机森林、梯度增强、<em class="jd"> k </em> -means和DBSCAN，旨在与Python数值和科学库NumPy和SciPy互操作。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="0af4" class="je jf hi kx b fi lc ld l le lf">pip install -U scikit-learn</span></pre></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="3429" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><strong class="ak">分类算法:</strong> <a class="ae lg" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">随机森林分类器</strong> </a></h2><p id="0620" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">分类是一种将数据分类到给定数量的类别中的技术。分类的主要目的是识别新数据所属的类别/类。</p><p id="84da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林是一种元估计器，它在数据集的各个子样本上拟合多个决策树分类器，并使用平均来提高预测精度和控制过拟合。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="a122" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">让我们从开始</h2><p id="3879" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated"><strong class="ih hj">第一步:</strong></p><p id="574e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分别导入别名为<code class="du ku kv kw kx b">st</code>和<code class="du ku kv kw kx b">pd</code>的<code class="du ku kv kw kx b">streamlit</code>和<code class="du ku kv kw kx b">pandas</code>库。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="11b3" class="je jf hi kx b fi lc ld l le lf">import streamlit as st<br/>import pandas as pd<br/>from sklearn.ensemble import RandomForestClassifier</span></pre><p id="80a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:</strong></p><p id="9398" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在前端，定义一个方法<code class="du ku kv kw kx b">def user_input_features()</code>,该方法将接受与患者的年龄、性别、胸痛类型、静息血压、胆固醇、thalach和其他所需特征相关的输入参数。这些特征将被传递到后端，在后端，经过训练的模型将根据输入参数来预测分类标签。预测结果送回前端显示。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="14d9" class="je jf hi kx b fi lc ld l le lf">    st.write("""**1. Select Age :**""")<br/>    age = st.slider('', 0, 100, 25)<br/>    st.write("""**You selected this option **""",age)<br/>    <br/>    st.write("""**2. Select Gender :**""")<br/>    sex = st.selectbox("(1=Male, 0=Female)",["1","0"])<br/>    st.write("""**You selected this option **""",sex)</span></pre><p id="5852" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里<code class="du ku kv kw kx b">st.slider()</code>和<code class="du ku kv kw kx b">st.selectbox()</code> streamlit方法用于获取输入，而<code class="du ku kv kw kx b">st.wrire()</code>用于同时打印输入。</p><p id="7a30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:</strong></p><p id="920b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据帧形式的综合用户输入参数信息将被分配给<code class="du ku kv kw kx b">df</code>变量。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="8534" class="je jf hi kx b fi lc ld l le lf">df = user_input_features()</span></pre><p id="afb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第四步:</strong></p><p id="65b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一步包含实际的模型构建阶段。这将从保存所有文件的同一路径加载患者数据集，并将其分配给<code class="du ku kv kw kx b">heart</code>变量。</p><p id="1419" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">X</code>变量包含数据集中提供的所有患者特征，而<code class="du ku kv kw kx b">Y</code>变量具有对患者进行分类的输出列目标。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="dc43" class="je jf hi kx b fi lc ld l le lf">heart = pd.read_csv("heart1.csv")<br/>X = heart.iloc[:,0:11].values<br/>Y = heart.iloc[:,[11]].values</span></pre><p id="3528" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五步:</strong></p><p id="55e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在该步骤中，特别是将<code class="du ku kv kw kx b">RandomForestClassifier()</code>函数分配给<code class="du ku kv kw kx b">model</code>变量，并通过使用<code class="du ku kv kw kx b">X</code>和<code class="du ku kv kw kx b">Y</code>变量作为输入参数，经由<code class="du ku kv kw kx b">model.fit()</code>函数训练模型。这意味着将通过使用患者的特征(<code class="du ku kv kw kx b">X</code>)和输出列(<code class="du ku kv kw kx b">Y</code>)训练分类模型来建立分类模型。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="bb75" class="je jf hi kx b fi lc ld l le lf">model = RandomForestClassifier()<br/>model.fit(X, Y)</span></pre><p id="c6ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第六步:</strong></p><p id="deee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在该步骤中，变量<code class="du ku kv kw kx b">prediction</code>将通过从数据帧<code class="du ku kv kw kx b">df</code>中获取用户输入来存储模型预测的值。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="4cbb" class="je jf hi kx b fi lc ld l le lf">prediction = model.predict(df)</span></pre><p id="5f2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">预测将以表格的形式出现。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="d657" class="je jf hi kx b fi lc ld l le lf">st.subheader('Prediction :')<br/>df1=pd.DataFrame(prediction,columns=['0'])<br/>df1.loc[df1['0'] == 0, 'Chances of Heart Disease'] = 'No'<br/>df1.loc[df1['0'] == 1, 'Chances of Heart Disease'] = 'Yes'<br/>st.write(df1)</span></pre><figure class="kf kg kh ki fd kj er es paragraph-image"><div class="er es lh"><img src="../Images/540ed79af641d0a5f04354204fb3c160.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*-xCuJO2_Ux0NMMbNX0B-jA.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">预言；预测；预告</figcaption></figure><p id="41f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第七步:</strong></p><p id="2df9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码将打印模型的预测概率。</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="3a5c" class="je jf hi kx b fi lc ld l le lf">prediction_proba = model.predict_proba(df)<br/>st.subheader('Prediction Probability in % :')<br/>st.write(prediction_proba * 100)</span></pre><figure class="kf kg kh ki fd kj er es paragraph-image"><div class="er es lm"><img src="../Images/0772226c770193b7b37cea22fb4288aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*T-b_O0tR5QbnY1ojd6zG5w.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">推算概率</figcaption></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="a3d4" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><strong class="ak">这个app怎么运行？</strong></h2><p id="8e3d" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">按照给定的步骤，用<code class="du ku kv kw kx b">.py</code>扩展名保存代码。打开命令提示符或终端，使用以下命令执行此<code class="du ku kv kw kx b">.py</code>扩展文件:</p><pre class="kf kg kh ki fd ky kx kz la aw lb bi"><span id="1ad0" class="je jf hi kx b fi lc ld l le lf">streamlit run file_name.py</span></pre><p id="9c6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该命令将执行代码，执行后您的浏览器将弹出并带您进入web应用程序。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/1ba7aa3f882e7bbecc2e112f9d01979b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZhhryci7T75GvCcY11ubw.png"/></div></div></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="e667" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">结论</h2><p id="1aeb" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">随机森林算法是一种强大而简单的算法，在对不同特征进行分类时特别有用。为了更好地理解随机森林算法，这个<a class="ae lg" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank">指南</a>可能会很有帮助。</p></div></div>    
</body>
</html>