<html>
<head>
<title>Basketball Hall of Fame Predictions with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python预测篮球名人堂</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basketball-hall-of-fame-predictions-with-python-b7cee3724112?source=collection_archive---------9-----------------------#2020-05-22">https://medium.com/analytics-vidhya/basketball-hall-of-fame-predictions-with-python-b7cee3724112?source=collection_archive---------9-----------------------#2020-05-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="06e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">名人堂经常是篮球迷们争论的焦点。只有精英中的精英才应该被允许加入，但是影响选民决定的因素太多了。在这里，我们试图模拟他们的决策，并估计玩家被投票的概率。</p><p id="bdcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">包含与这个项目相关的可视化的Tableau故事可以在<a class="ae jd" href="https://public.tableau.com/profile/jean6960#!/vizhome/BasketballHallofFameProbability/BasketballHallofFameProbabilities" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="6254" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">包含这个项目代码的ipython笔记本可以在<a class="ae jd" href="https://github.com/sebasdarius/data_science_portfolio/blob/master/Basketball_HOF/Model_Selection.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="c5f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用从basketball-reference.com<a class="ae jd" href="https://www.basketball-reference.com/" rel="noopener ugc nofollow" target="_blank">刮来的数据。我们收集了常规赛和季后赛的数据，全明星赛的出场次数和各种奖项。我们也使用了和basketball-reference.com一样的标准来决定我们的模型将用来训练哪些球员。我们只考虑那些在NBA打了大部分职业生涯，并且积累了至少50份职业胜利股份的球员。</a></p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="ed40" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">模型构建</strong></h1><p id="d28f" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">首先，我们导入一些需要在数据文件中使用和读取的库。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="8a21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们创建一些我们认为很有预测性的特征。这就是领域知识在机器学习中非常有用的地方。我们还将数据分为训练集、验证集和测试集。因为在现实生活中，我们会使用过去的数据来预测未来的事件，所以我们使用这种方法来分割我们的数据。</p><p id="87fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也删除了还没有资格被投票的球员。大厅要求玩家退役至少3年才被考虑。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="7562" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们手动选择一些我们认为可能值得一看的特性。我们确定了26个可能具有预测性的特征。有了一个更大的数据集，我们也许能够从所有的特征开始。但是对于这个小数据集(141个训练观察值)，太多的变量将使我们的模型难以学习。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="c3a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还创建了一个名为<code class="du kv kw kx ky b">print_metrics</code>的函数来打印出模型的精度和损失函数。</p><p id="36af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用Brier评分作为我们的衡量标准。我们使用这个指标是因为它严重惩罚了大的错误，我们不希望我们的最终概率与事实相差太远。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h2 id="4cc3" class="kz jm hi bd jn la lb lc jr ld le lf jv iq lg lh jz iu li lj kd iy lk ll kh lm bi translated">逻辑回归</h2><p id="0ddd" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">我们要尝试的第一个模型是逻辑回归模型。这是一个很好的首选，因为它是一个简单的算法，这意味着它比更复杂的算法更不容易过度拟合。它也有一个概率解释，这对我们的需求很重要。</p><p id="2313" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了选择用于逻辑回归的特征，我们使用sklearn的递归特征消除(RFE ),它适合我们的模型，并基于前一步的系数在每一步移除一个特征。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="20f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="ko kp kq kr fd ln ky lo lp aw lq bi"><span id="129e" class="kz jm hi ky b fi lr ls l lt lu">6 selected features<br/>['Count_mvp', 'All_stars', 'Championships', 'box_plus_minus', 'value_over_replacement_player', 'ppg'] <br/><br/>Training Accuracy:  0.8272251308900523 <br/>Validation Accuracy:  0.9 <br/>Out of Bag Accuracy:   <br/>Training Loss:  0.10711748964899732 <br/>Validation Loss:  0.0705776399962272</span></pre><p id="57d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们打印最优逻辑回归模型的系数时，我们得到如下结果。</p><pre class="ko kp kq kr fd ln ky lo lp aw lq bi"><span id="2eff" class="kz jm hi ky b fi lr ls l lt lu">                               Coefficients<br/>Count_mvp                          1.569915<br/>All_stars                          2.117843<br/>Championships                      1.551612<br/>box_plus_minus                     1.191951<br/>value_over_replacement_player     -1.241967<br/>ppg                                0.437403</span></pre><p id="1a05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们发现了一些不寻常的事情，那就是“价值超过替代球员”的系数是负的。这令人惊讶，因为这是一个玩家指标，玩家越优秀，这个指标应该越高。负系数几乎肯定是与某些其他特征共线的结果。所以我们要把它从模型中剔除。</p><p id="404a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们这样做时，我们得到以下系数。</p><pre class="ko kp kq kr fd ln ky lo lp aw lq bi"><span id="18ff" class="kz jm hi ky b fi lr ls l lt lu">Training Accuracy:  0.8272251308900523 <br/>Validation Accuracy:  0.9 <br/>Out of Bag Accuracy:   <br/>Training Loss:  0.1148539455765552 <br/>Validation Loss:  0.07083869752849309<br/><br/>                Coefficients<br/>Count_mvp           1.681519<br/>All_stars           2.267450<br/>Championships       1.590180<br/>box_plus_minus      0.114319<br/>ppg                 0.228630</span></pre><p id="cc41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:看起来我们的模型在验证集上比在训练集上表现得更好，这也是不寻常的。但这可能是由于验证集的规模较小。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h2 id="50a2" class="kz jm hi bd jn la lb lc jr ld le lf jv iq lg lh jz iu li lj kd iy lk ll kh lm bi translated">随机森林</h2><p id="5fc7" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">现在我们将尝试另一种类型的模型，随机森林。这种算法也不会过度拟合，这是另一个不错的选择。</p><p id="e794" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们再次使用sklearn特征来提取模型的特征。这次不是用系数去特征，而是用sklearn的<code class="du kv kw kx ky b">feature_importance_</code>。<code class="du kv kw kx ky b">feature_importance_</code>随机播放每个特征，并检查该特征被随机播放时模型性能受到的影响。性能下降越多，该功能就越重要。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="81be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="ko kp kq kr fd ln ky lo lp aw lq bi"><span id="6cae" class="kz jm hi ky b fi lr ls l lt lu">5 selected features<br/>['All_stars', 'Championships', 'player_efficiency_rating', 'win_shares', 'ppg']</span><span id="4a82" class="kz jm hi ky b fi lv ls l lt lu">Training Accuracy:  0.9790575916230366 <br/>Validation Accuracy:  0.8666666666666667 <br/>Out of Bag Accuracy:  0.8743455497382199 <br/>Training Loss:  0.029356830069540672 <br/>Validation Loss:  0.08266228037366541</span></pre><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es lw"><img src="../Images/885e0d9bc60b88217725d56994e26589.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*xiMQ11YPi4X88KB8zWXB2w.png"/></div><figcaption class="lz ma et er es mb mc bd b be z dx translated">随机森林要素重要性</figcaption></figure><p id="de5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为健全性检查，我们为每个预测变量创建部分相关图，以查看我们的每个特征和目标之间是否存在正相关关系。部分相关图让我们通过查看模型如何针对特定特征的不同值对我们的训练示例进行预测来解释我们的模型。它们本质上允许我们看到特征和目标之间的关系，至少根据模型是这样的。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="7fc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每场比赛和锦标赛的分数输出:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es md"><img src="../Images/c2773dae725c47ac446a55eb564d536f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uI1VwPVEyVvf9W9Xl4t84Q.png"/></div></div></figure><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mi"><img src="../Images/be54fbda2c798f0566cd466b046e1141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mhp6AltYAUuHfHOfJhSyEQ.png"/></div></div></figure><p id="b285" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然一些地块最初有小的下降，但从长期来看，它们都是增加的。所以我们可以相信模型没有发现变量之间的奇怪关系。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="3baa" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">组合估计量</h1><p id="574c" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">现在，我们将看看是否可以通过平均两个估计器的输出来得到更好的结果。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="0de8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="ko kp kq kr fd ln ky lo lp aw lq bi"><span id="306b" class="kz jm hi ky b fi lr ls l lt lu">Training Accuracy:  0.9476439790575916 <br/>Validation Accuracy:  0.9666666666666667 <br/>Training Loss:  0.06099515571971145 <br/>Validation Loss:  0.03333333333333333</span></pre><p id="abf3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个模型似乎比单个模型做得更好。所以我们会把它作为我们的最终模型。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h2 id="b2ce" class="kz jm hi bd jn la lb lc jr ld le lf jv iq lg lh jz iu li lj kd iy lk ll kh lm bi translated">测试</h2><p id="c28c" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">最后一步是在我们的测试集上测试模型。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="9548" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="ko kp kq kr fd ln ky lo lp aw lq bi"><span id="9a75" class="kz jm hi ky b fi lr ls l lt lu">Ensemble: <br/>0.8571428571428571 0.1364061293309076</span></pre><p id="597a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管我们采取了预防措施，但看起来我们的模型可能有点过拟合。没有大量数据，很难构建一个可靠的验证集来防止这种情况发生。然而，该模型似乎仍然工作得很好，特别是在准确性方面。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h2 id="4819" class="kz jm hi bd jn la lb lc jr ld le lf jv iq lg lh jz iu li lj kd iy lk ll kh lm bi translated">模型可视化</h2><p id="4273" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">最后，让我们想象一下我们的模型在测试和训练集上的表现。</p><figure class="ko kp kq kr fd ks"><div class="bz dy l di"><div class="kt ku l"/></div></figure><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mj"><img src="../Images/7af5c32c2dc9ea98d88126834a4411a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*4VRLVg3BEQkunxdHi2w0pw.png"/></div></figure><p id="74f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，我们的模型在训练集上的表现明显好于测试集。一个值得注意的观察是，测试集中的大部分错误都是模型确信会进入名人堂的球员。</p><p id="fd61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，最大的错误似乎是两个最近符合条件的球员。这可能向我们暗示，这个模型可能没有错，其中一些球员可能真的会进入名人堂，尽管他们还没有做到。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="d275" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，考虑到进入名人堂生涯的所有因素，我们能够建立一个相当不错的分类器。通过sklearn的内置功能、一些功能工程以及使用分类器集成，我们还能够改进我们的模型。我们还做了一些数据可视化，帮助我们解释我们的模型。</p><p id="9ed9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！</p><p id="03d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">tableau Dashboard:<a class="ae jd" href="https://public.tableau.com/app/profile/jean6960/viz/BasketballHallofFameProbability/BasketballHallofFameProbabilities" rel="noopener ugc nofollow" target="_blank">https://public . tableau . com/app/profile/jean 6960/viz/basketballhallofmeprobability/basketballhallofmeprobabilities</a></p><p id="b2aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Jupyter笔记本:<a class="ae jd" href="https://github.com/sebasdarius/data_science_portfolio/blob/master/Basketball_HOF/Model_Selection.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/sebasdarius/data _ science _ portfolio/blob/master/Basketball _ HOF/Model _ selection . ipynb</a></p></div></div>    
</body>
</html>