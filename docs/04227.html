<html>
<head>
<title>Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-b30ca0bec653?source=collection_archive---------15-----------------------#2020-03-10">https://medium.com/analytics-vidhya/logistic-regression-b30ca0bec653?source=collection_archive---------15-----------------------#2020-03-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/f12711c8f058a95dc4ccb3c866fd9cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*blOad1e0c5V8EsTx03chWg.gif"/></div></figure><p id="90e0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">总有一天，你会得到或选择一个分类数据集，当你到达这一点时，你会很快发现线性回归并不像你想象的那样有用。</p><p id="607c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当您处理分类数据集时，您希望使用<strong class="io hj">逻辑回归</strong>来获得模型的最佳拟合。<strong class="io hj">逻辑回归</strong>可用于二进制数据甚至更复杂的扩展。</p><h1 id="36b6" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">数据集示例</h1><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ki"><img src="../Images/1daf6f0249ad11ee6fa5d21b39e877e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LOzRoxL-WcKRwFGHABXnHw.jpeg"/></div></div></figure><p id="2923" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们来看一个红酒数据集，它有12列，可以在Kaggle上的<a class="ae kr" href="https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009" rel="noopener ugc nofollow" target="_blank">这里</a>找到。由此，我们可以将我们的因变量定义为“质量”，剩下的11列将是我们的自变量，或者称为特征。</p><p id="dee0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我们的整个数据集中有连续的值，但是当我们到达我们的因变量时就停止了，因为它看起来是一个分类变量。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ks"><img src="../Images/f3b0d4eebba96387750d982f3cf84f46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kiofX5tfk4gzJbFZE36Qtw.png"/></div></div></figure><h2 id="8d7c" class="kt jl hi bd jm ku kv kw jq kx ky kz ju ix la lb jy jb lc ld kc jf le lf kg lg bi translated">数据可视化</h2><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lh"><img src="../Images/42fc887d9c3d8afadf0ea2ac32c137e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*giir4B-nXlBSsa1-5aM6Mg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">独立变量的Seaborn散点图</figcaption></figure><p id="3e1c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过绘制自变量的散点图，你可以看到你的数据是如何分布的。通常，您希望您的数据具有一些线性分布的正态分布。我们上面的可视化显示了一些正态分布和更多的指数分布。我们可以通过执行相反的等式，对数，来摆脱指数分布。</p><p id="1162" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">注意</strong>:日志转换可以像调用一行代码一样简单</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="46e6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在使用log转换我们的数据之后，我们现在应该看看我们的数据是如何分布的。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lh"><img src="../Images/f17e763a27eeea32fc869504071b020f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iqqMTsjQqMNZl7r0twwa_A.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">对数转换数据的Seaborn散点图</figcaption></figure><p id="f7c0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的可视化显示了我们新转换的自变量。看起来我们的数据有更多的正态分布和一些线性分布，这正是我们想要的。</p><p id="7389" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下一步是检查因变量的分布:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lo"><img src="../Images/1b981bde3ce9e8f59d22a4642da77ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r4IPmdegOQ2oR2cRHxyldg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">因变量的Seaborn分布图</figcaption></figure><h2 id="c993" class="kt jl hi bd jm ku kv kw jq kx ky kz ju ix la lb jy jb lc ld kc jf le lf kg lg bi translated">检查多重共线性</h2><p id="6466" class="pw-post-body-paragraph im in hi io b ip lp ir is it lq iv iw ix lr iz ja jb ls jd je jf lt jh ji jj hb bi translated">下一步是找出我们的数据是否具有多重共线性(指的是多元回归模型中两个或多个解释变量高度线性相关的情况)。最好不惜一切代价避免多重共线性，因为它会降低模型的准确性。</p><h2 id="8699" class="kt jl hi bd jm ku kv kw jq kx ky kz ju ix la lb jy jb lc ld kc jf le lf kg lg bi translated">我们如何检查</h2><p id="1f67" class="pw-post-body-paragraph im in hi io b ip lp ir is it lq iv iw ix lr iz ja jb ls jd je jf lt jh ji jj hb bi translated">我们可以使用热图来查看多重共线性。如果该值大于0.4，对于更多的要素，则存在严重的多重共线性，您可能需要考虑删除一些要素。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lu"><img src="../Images/309f3234d957333303a7ab9f71f8452e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jFafPxOEwzDuoU5PbiNo8Q.png"/></div></div></figure><p id="bb69" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">看起来我们的数据很好地避免了多重共线性，因此不会删除任何要素。</p><h2 id="9a99" class="kt jl hi bd jm ku kv kw jq kx ky kz ju ix la lb jy jb lc ld kc jf le lf kg lg bi translated">回归</h2><p id="5003" class="pw-post-body-paragraph im in hi io b ip lp ir is it lq iv iw ix lr iz ja jb ls jd je jf lt jh ji jj hb bi translated">我们查看了我们的数据，对其进行了转换，并检查了多重共线性。我们现在准备对我们的数据做一个回归模型。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="e867" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们正在调用<strong class="io hj">逻辑回归</strong>类并实例化它。然后，我们拟合我们的训练集，并预测独立变量的所述训练集。然后，我们将使用分数方法来返回我们的训练集的准确性，遗憾的是，它看起来不太好。我们得到了58%的分数，这意味着我们的模型不太符合数据。</p><h2 id="54f1" class="kt jl hi bd jm ku kv kw jq kx ky kz ju ix la lb jy jb lc ld kc jf le lf kg lg bi translated">如何改进模型？</h2><p id="353b" class="pw-post-body-paragraph im in hi io b ip lp ir is it lq iv iw ix lr iz ja jb ls jd je jf lt jh ji jj hb bi translated">有多种方法可以提高模型的得分，从多项式回归到正则化，甚至是返回并对数据进行不同的变换。但是现在我们将做多项式回归，看看我们是否能得到一个更好的分数。通过进行多项式回归，它将试图通过稍微操纵曲线来更好地拟合我们的数据。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="24c7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的代码帮助我们将多项式回归拟合到我们的逻辑回归中，从而将准确率提高到62%。是的，我知道62%不是你应该吹嘘的东西，但让我们通过检查我们的R平方(一种表示回归模型拟合度的统计度量)来看看它可能有多差。</p><h2 id="3b55" class="kt jl hi bd jm ku kv kw jq kx ky kz ju ix la lb jy jb lc ld kc jf le lf kg lg bi translated">统计模型</h2><p id="4b7e" class="pw-post-body-paragraph im in hi io b ip lp ir is it lq iv iw ix lr iz ja jb ls jd je jf lt jh ji jj hb bi translated">我们可以使用另一个名为StatsModels的库，它将列出关于我们的回归模型的各种信息。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lv"><img src="../Images/b8570fd6baae8c84a0df3eb90e2f6cd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcpyjhxctgrlB2DMdKGCcg.png"/></div></div></figure><p id="32c4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们的R平方和Adj. R平方的值都是1.0。这意味着我们的模型处于最大拟合状态，实际值与预测值之间没有残差。</p><h2 id="98c9" class="kt jl hi bd jm ku kv kw jq kx ky kz ju ix la lb jy jb lc ld kc jf le lf kg lg bi translated">有没有更好的办法？</h2><p id="003b" class="pw-post-body-paragraph im in hi io b ip lp ir is it lq iv iw ix lr iz ja jb ls jd je jf lt jh ji jj hb bi translated">是啊！最可能</p></div></div>    
</body>
</html>