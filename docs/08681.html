<html>
<head>
<title>All you need to know about Replay Subject in RxJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于RxJS中的重放主题，您需要知道的是</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/all-you-need-to-know-about-replay-subject-in-rxjs-e8f2632eeba9?source=collection_archive---------17-----------------------#2020-08-08">https://medium.com/analytics-vidhya/all-you-need-to-know-about-replay-subject-in-rxjs-e8f2632eeba9?source=collection_archive---------17-----------------------#2020-08-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/997091274d1f0782634138f82f9ac95e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLB6EHQOLmO-KTaZlMrjMA.jpeg"/></div></div></figure><p id="4f12" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ReplaySubject是Subject的一个特殊变体，它向观察者发出旧值，即使在执行这些值的时候观察者还没有被创建。它提供了旧值数量的设置，一旦新订户向其注册，它将记住这些旧值的数量。</p><p id="258b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面的代码片段简单演示了replay subject。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="971a" class="jx jy hi jt b fi jz ka l kb kc">import { ReplaySubject } from 'rxjs' ;</span><span id="61ae" class="jx jy hi jt b fi kd ka l kb kc">const rs$ = new ReplaySubject( 2 ); // (1)</span><span id="eadf" class="jx jy hi jt b fi kd ka l kb kc">// subscriber A</span><span id="64f9" class="jx jy hi jt b fi kd ka l kb kc">rs$.subscribe((data) =&gt; { // (2)</span><span id="bb18" class="jx jy hi jt b fi kd ka l kb kc">console.log( 'subscriber A: ' + data);</span><span id="37e5" class="jx jy hi jt b fi kd ka l kb kc">});</span><span id="7d08" class="jx jy hi jt b fi kd ka l kb kc">rs$.next(Math.random()); // (3)</span><span id="8d7c" class="jx jy hi jt b fi kd ka l kb kc">rs$.next(Math.random());</span><span id="465a" class="jx jy hi jt b fi kd ka l kb kc">rs$.next(Math.random());</span><span id="74ce" class="jx jy hi jt b fi kd ka l kb kc">// Subscriber B</span><span id="966d" class="jx jy hi jt b fi kd ka l kb kc">rs$.subscribe((data) =&gt; { // (4)</span><span id="57ff" class="jx jy hi jt b fi kd ka l kb kc">console.log( 'subscriber B: ' + data);</span><span id="c768" class="jx jy hi jt b fi kd ka l kb kc">});</span><span id="e349" class="jx jy hi jt b fi kd ka l kb kc">rs$.next(Math.random());</span></pre><p id="f328" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在步骤1中，我们实例化一个新的ReplaySubject，并将内存值的数量设置为2。这意味着它将在内存中存储至少2个值，因此当它被订阅时，它至少有2个值要发出。在步骤2中，我们已经订阅了在步骤1中创建的replay主题，这里我们只是将值打印到控制台。在步骤3中，我们使用next()方法向replay subject传递新值。我们将这个步骤做3次，以检查我们是否真的可以在内存中存储至少2个值。在下一个步骤4中，我们创建了另一个名为subscriberB的订户，就像前面的订户一样，它将值打印到控制台。在最后一步中，我们再次调用next()方法，并将值设置为某个随机数。</p><p id="8ad1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的关键观察是，在subscriberB出现之前，replay subject已经发出了三个值，并且通过我们的配置，我们已经在内存中保存了两个过去的值。现在来看看输出。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="a11c" class="jx jy hi jt b fi jz ka l kb kc">// subscriber A: 0.8107208546492104 // (1)</span><span id="6c89" class="jx jy hi jt b fi kd ka l kb kc">// subscriber A: 0.04243867985866512 // (2)</span><span id="8b37" class="jx jy hi jt b fi kd ka l kb kc">// subscriber A: 0.5350443486512133 // (3)</span><span id="9a1b" class="jx jy hi jt b fi kd ka l kb kc">// subscriber B: 0.04243867985866512 // (4)</span><span id="3985" class="jx jy hi jt b fi kd ka l kb kc">// subscriber B: 0.5350443486512133 // (5)</span><span id="2a53" class="jx jy hi jt b fi kd ka l kb kc">// subscriber A: 0.07003469196276346 // (6)</span><span id="8440" class="jx jy hi jt b fi kd ka l kb kc">// subscriber B: 0.07003469196276346 // (7)</span></pre><p id="00fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里的输出中，我们有7个值，查看输出值，我们可以得出以下推论。</p><ul class=""><li id="3443" class="ke kf hi is b it iu ix iy jb kg jf kh jj ki jn kj kk kl km bi translated">值1、2和3来自我们在代码片段的步骤3中实现的next()方法。此时，subscriberB不存在。因此没有从subscriberB中打印出任何值。</li><li id="3b65" class="ke kf hi is b it kn ix ko jb kp jf kq jj kr jn kj kk kl km bi translated">现在创建了subscriberB，按照配置，内存中有两个过去的值，订户打印出来。</li><li id="fe6a" class="ke kf hi is b it kn ix ko jb kp jf kq jj kr jn kj kk kl km bi translated">这里要注意的一点是，值4和2以及值5和3是相同的，因为它们是重放主题的内存值。</li><li id="c282" class="ke kf hi is b it kn ix ko jb kp jf kq jj kr jn kj kk kl km bi translated">接下来的值6和7来自代码片段的最后一条语句。</li></ul><p id="1c5d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面提到的几点是你开始使用ReplaySubject时需要了解的所有基础知识。</p></div></div>    
</body>
</html>