<html>
<head>
<title>Predicting Heart Diseases - Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测心脏病-第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-heart-diseases-part-1-d1e297fad9f4?source=collection_archive---------31-----------------------#2020-06-25">https://medium.com/analytics-vidhya/predicting-heart-diseases-part-1-d1e297fad9f4?source=collection_archive---------31-----------------------#2020-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2c9c0f7bb6c0ffc98258cbd57fd76919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWh9jn4VJOOSBgIPLV09Eg.jpeg"/></div></div></figure><p id="743a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如今，我们正与全球艾滋病形势作斗争，但我们不能忘记心脏病，根据许多机构的说法，T2是全世界最大的死亡原因。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/c94516cbc6d88d530be5d74a9941e976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*E0YwRaFnlSFp4Ev5Nxu8Ww.jpeg"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated"><a class="ae jx" href="https://www.who.int/news-room/fact-sheets/detail/the-top-10-causes-of-death" rel="noopener ugc nofollow" target="_blank">来自世卫组织的数据。</a></figcaption></figure><p id="f6bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">心脏病有很多种，但在这个案例研究中，我将重点关注“<strong class="is hj">冠心病</strong>”。这是由于冠状动脉中的脂肪物质阻塞或中断了心脏的血液供应。最常见的症状是心绞痛、心脏病发作和心力衰竭。</p><h1 id="218e" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">如果我告诉你我们可以预测它们会怎么样？</h1><p id="fe6b" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">由于机器学习和Python，我们可以使用医疗信息和小数据集来教授和训练算法。然后，我们可以将这个模型应用于任何人群，以估计这些人群的风险水平。为此，我使用的3个关键概念是:</p><ul class=""><li id="c869" class="lb lc hi is b it iu ix iy jb ld jf le jj lf jn lg lh li lj bi translated"><a class="ae jx" href="https://framinghamheartstudy.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">弗雷明汉风险评分</strong> </a></li><li id="ddf0" class="lb lc hi is b it lk ix ll jb lm jf ln jj lo jn lg lh li lj bi translated"><strong class="is hj">数据分析</strong></li><li id="3c71" class="lb lc hi is b it lk ix ll jb lm jf ln jj lo jn lg lh li lj bi translated"><strong class="is hj">机器学习</strong></li></ul><p id="794a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如上所述，我使用的方法可以推广到任何国家或地区，但因为我是西班牙人，我决定做整个项目，考虑到我的目标是研究西班牙人口。</p><p id="8720" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请跟随我踏上之旅，在这里我将解释如何在人口统计学层面上预测这些疾病。</p><h1 id="5016" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">弗雷明汉风险评分</h1><p id="11b2" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">简而言之，这是一项医学研究，测量一个人在未来10年内患心脏病的概率。这是用弗雷明汉人(英格兰)作为实验人口完成的。专家们研究了他们的心血管问题以及与年龄、吸烟习惯或饮酒等几个因素的关系。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/d2a0fe28878072a9f0a50b1557034a22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AuaaKnRfjMmsch4Aw6IjiQ.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">研究的不同方面。</figcaption></figure><p id="3af8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这项研究根据这些特征给一个人打分。如果你有糖尿病，你会得到一些分数，如果你吸烟，你会得到分数，等等。最终，<strong class="is hj">你的积分越多，风险就越高</strong>。</p><h2 id="7952" class="lq jz hi bd ka lr ls lt ke lu lv lw ki jb lx ly km jf lz ma kq jj mb mc ku md bi translated">准备我们的数据</h2><p id="4cc6" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">首先，我需要一个好的数据集，包含弗雷明汉风险评分考虑的所有参数。我在<a class="ae jx" href="https://www.kaggle.com/sulianova/cardiovascular-disease-dataset" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> Kaggle </strong> </a>找到一个不错的，70.000行。它有我想要的一切:年龄、性别、胆固醇、吸烟习惯等等。<strong class="is hj">数据集干净而平衡</strong>。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/1c2c0ad026b94c59c9db3e11fdcfcc3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hpgzy35JB8tnn45v8dV02w.jpeg"/></div></div></figure><p id="54c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用<strong class="is hj"> Python </strong>，我定义了一个<strong class="is hj">函数</strong>，考虑到所有的Framingham参数，<strong class="is hj">计算数据集中每个虚构人物的风险分数</strong>。此外，请记住，这项研究是在人口统计学层面上进行的，在这种统计数据中很难找到可靠的医学信息，如人群中的胆固醇水平。</p><p id="2a11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，我<strong class="is hj">放弃了所有的医疗数据</strong>。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/02913896d9c61018dfb8befac82be30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*ChOLy_wJqnVcIo0TH2bbng.jpeg"/></div></figure><p id="5e84" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你注意到了吗？许多列被删除。此外，还出现了两个新名称:“身体质量指数”和更重要的“风险组”。<strong class="is hj">身体质量指数</strong>是身体质量指数；一种简单的方法来联系身高和体重，并不是完美的，但便宜的方法来确定一个人是否超重。</p><p id="28fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">风险组</strong>是一个新的类别，区分5个风险级别，从1(低)到5(非常高)。机器学习在处理少量类别时效果更好，所以我决定对不同的弗雷明汉分数进行分组。</p><h1 id="27d5" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">预测风险</h1><p id="ad0c" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">现在我们已经准备好了数据，是时候进行机器学习了。你可能知道，在ML中会有一个<strong class="is hj">目标</strong>列(我们要预测的数据)。其他的将被用来计算这个预测。“T20”风险集团“T21”将是我的目标。</p><p id="2d8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在此之前，我会检查<strong class="is hj">相关性</strong>。这很重要，因为我们可以看到一个变量过于依赖另一个变量。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/d02ea68c15ec00be9fea5a678a120794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HvFw_t8xMSj_btq7vP1gYw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">使用Seaborn绘图。</figcaption></figure><p id="4f17" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">年龄相关性最高，但这是正确的，因为根据弗雷明汉的研究，年龄是风险得分的最决定性因素。</p><p id="1cbd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后是时候<strong class="is hj">缩放</strong>我们的数据了。这里有不同的数量级。二进制(0或1)或其他参数，如年龄，从30到80。“最小最大值缩放器”使这些差异均匀化，因为它<strong class="is hj">将所有值更改为0到1之间的数字</strong>。它会给我们的最终解决方案一个更好的结果。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/cfef40bb3f5c5fdbb082cefbaab7cbe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*V_28vQC2D7rD-CznKDDh4A.jpeg"/></div></div></figure><p id="2d52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，我将数据分为“<strong class="is hj">训练数据</strong>”(我将用来训练我的算法的信息)和“<strong class="is hj">测试数据</strong>”(我将用来检查我的模型的准确性的值)。这种分割过程不是50/50的划分，而是通常80%的训练数据(56.000人)和20%的测试数据(14.000人)。</p><h1 id="11c4" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">该算法</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/6395255716c46f10c1e4c762081ea4e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zYNhLc522h0zftD1zDh2g.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">KNN背后的概念。</figcaption></figure><p id="1187" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在ML中，有许多不同类型的算法，每一种算法根据问题的不同都有优缺点。做了几次尝试后，我选择了<a class="ae jx" href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"/></a>【KNN】K-最近邻。这种方法将研究每个人的数据，并确定这些特征是否属于某个风险群体或其他。</p><p id="fa33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦你有了算法，检查一下所谓的“<strong class="is hj">超参数调整</strong>”总是好的，这是一种“让我们去寻找这个问题可能的最佳配置”的花哨说法。如果你想了解这个过程的更多细节，请查看我的回购。请注意，最后我只是想要一个准确度分数，这个值将给出我们对每个人进行正确风险分类的概率。</p><h1 id="6223" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结果呢</h1><p id="4503" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">在改进了我的算法的不同参数之后，我得到了61%的<strong class="is hj"/>。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/097dcd0e4c5a7398b76670e24195f581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUqYvQOQsi-noHA_LAnghw.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">从我的笔记本到你的屏幕。</figcaption></figure><p id="8e20" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有这些工作只是为了得到61%的准确率？等等。这样好吗？这很糟糕吗？记住大多数时候<strong class="is hj">精度不够</strong>。如果我们考虑2个以上的选项，那么<strong class="is hj">混淆矩阵</strong>就派上用场了。</p><h2 id="0e5d" class="lq jz hi bd ka lr ls lt ke lu lv lw ki jb lx ly km jf lz ma kq jj mb mc ku md bi translated">让我们探索矩阵。</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/264c93d1483a3c901e9222160b400d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Ha4EHIkMrEUw11EGEXRfA.jpeg"/></div></div></figure><p id="8815" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该矩阵中的每一行代表与不同风险组相关的预测。对角线上的<strong class="is hj">数字是正确的预测</strong>，而其他数字是错误的预测。请记住，在这个测试数据中，我有14，000行。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/487b501dddd2bd974bbf14e77d9edc89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ExK7_G5ORYdxXkfg7yDM-w.jpeg"/></div></div></figure><p id="f8a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当预测一个有几种不同可能性的值时，不仅要知道错误，还要知道这个错误的<strong class="is hj">程度</strong>。如果我们考虑正确类别中的值，前一组和后一组，这些数字非常有趣。正如我们所看到的，ML不仅选择了正确的类别，而且避免了相反的类别。极端错误的类别从未超过9%。</p><p id="6f7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我的模型准备好了，我希望你能理解我在整个过程中的想法。下一步将是创建一个西班牙人口模型，应用最大似然算法并研究结果。</p><h1 id="b92b" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结束永远不是结束</h1><p id="dc72" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">非常感谢你读到这里。我不想在一篇文章中给你那么多信息，以免让你不知所措，所以我决定把它分开。在这里，你可以阅读本书的<strong class="is hj">动机</strong>、<strong class="is hj">目标</strong>和<strong class="is hj">最重要的概念</strong>:</p><ul class=""><li id="6439" class="lb lc hi is b it iu ix iy jb ld jf le jj lf jn lg lh li lj bi translated"><strong class="is hj">弗雷明汉评分风险</strong>。</li><li id="5e1d" class="lb lc hi is b it lk ix ll jb lm jf ln jj lo jn lg lh li lj bi translated"><strong class="is hj">机器学习</strong>。</li></ul><p id="763f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是你没看到我是怎么把这个不可思议的工具应用到西班牙人口模型上的。<strong class="is hj">敬请关注本文的第二部分</strong>，你会发现惊人的结果和一些惊喜。</p><p id="831c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">如果你喜欢，请鼓掌并与你认为可能感兴趣的人分享！</strong></p></div></div>    
</body>
</html>