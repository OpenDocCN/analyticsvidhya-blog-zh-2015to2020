<html>
<head>
<title>Learning Python for Data Visualization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习Python进行数据可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/learning-python-for-data-visualization-5c2969f16f21?source=collection_archive---------12-----------------------#2019-08-30">https://medium.com/analytics-vidhya/learning-python-for-data-visualization-5c2969f16f21?source=collection_archive---------12-----------------------#2019-08-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex if ig ih ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure><p id="55dd" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">在我的第一个数据可视化项目中，我深入研究了Zillow提供的房价数据集。这个特殊的数据集具有按邮政编码排列的三居室房屋的平均值。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es jj"><img src="../Images/1d6d336180883a33669655cd97ccda98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QDAUSBBnNKSsagrmf2vqbw.png"/></div></div></figure><p id="da96" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">正如你所看到的，这些列还包括从1996年到2019年每个月的平均月房价。</p><p id="ef4b" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">我对这个项目的目标是:</p><ol class=""><li id="8826" class="ju jv hi in b io ip is it iw jw ja jx je jy ji jz ka kb kc bi translated">创建一个可视化的图表，标出美国每个家庭每月的平均花费。</li><li id="8152" class="ju jv hi in b io kd is ke iw kf ja kg je kh ji jz ka kb kc bi translated">找出美国在2007/2008年房市崩盘中受打击最严重的城市。</li><li id="55ed" class="ju jv hi in b io kd is ke iw kf ja kg je kh ji jz ka kb kc bi translated">创建一个包含数据集中每个邮政编码的choropleth地图。</li></ol><p id="b5ab" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">清理数据时，我采取的第一步是删除除邮政编码和每月价格之外的所有功能。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ki"><img src="../Images/f1d5e8a627026c4ae2f8b63be7a8d42b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*viGOoXoRG7_UT6bDd7YowQ.png"/></div></div></figure><p id="0bc0" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">然后，我转置了数据框，并将索引设置为“日期”。这允许我隔离每个邮政编码，以便在列级别上执行进一步的操作。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kj"><img src="../Images/854bd253474357ab19186a397a25bbf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TcAACFpNKIuZzSH2bd0rQQ.png"/></div></div></figure><p id="bb3c" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">创建一个“百分比变化”栏可以让我看到每个区域的每日波动。我还绘制了这个数据，以便更好地理解这个数据集中的差异。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kk"><img src="../Images/42b9f10fcc2cb57aeb8ec8066709ff29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVb5rfezvcVpKKh92Laq1w.png"/></div></div></figure><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kl"><img src="../Images/6e319ed3555d7492f21085ba76a27722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dsAHlZfrJr_oXR59SYKigQ.png"/></div></div></figure><p id="8d80" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">现在，这是事情变得有点棘手的部分。我的目标是获得从记录数据的第一天开始，房产价值增加的百分比。这意味着在1996年3月，所有财产价值将被设置为0%,并每月增加/减少。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div class="er es km"><img src="../Images/4876af2a6b35b353260e1c21d07ea055.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*_xJQkFWUfhbnr6sD3g_-hw.png"/></div></figure><p id="0cc6" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">在for循环中调用的这个简单函数接受数据集的整个列，保存列中的第一个值，然后计算每个值相对于第一个值的变化百分比。for循环对我们的数据框中的每一列执行此操作，然后将结果保存为新数据框中的一个新列，称为“data”。</p><p id="d4cb" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">收集完这些数据后，我提取了每个时间段的平均值，并绘制了图表。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kn"><img src="../Images/3fee830b3e42277b5b79aeb48a187915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tagjlkpWWAYNt_vMnzvR-A.png"/></div></div></figure><p id="dd55" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">根据这组数据，房地产市场在2006年开始下跌，并在2012年初趋于平稳。根据这张图表，我想找出美国在房地产危机中受打击最严重的地区。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ko"><img src="../Images/5cac7c6e7ae2ee334281df0a9b3f27f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*EQt3x47hBRsDmKm_ojyXeQ.png"/></div></div></figure><p id="eda0" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">“subst”是一个包含两列的数据框(2006–11和2012–02)。隔离这两列后，我用2012年减去2006年，创建了一个新列。这个名为“drop”的新列让我可以看到在这段时间内每个邮政编码下降的百分比。我只需按“下降”列对数据框进行排序，就可以查看下降百分比最高的区域。对这个数据框进行排序后，我发现了以下内容:</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kp"><img src="../Images/aa1122992f5f7ccff13772d86c445696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QwYjhM2Q2FQING73S60CGA.png"/></div></div></figure><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kq"><img src="../Images/1c9e54574ef6e8b988d07935f59f912b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ANI4PctWGkx5d5HbB3ArEw.png"/></div></div></figure><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kr"><img src="../Images/be9a79aadf53cf549ac8cdb9d970b70d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FIeGHQFAMLx1NZwfiKCMsQ.png"/></div></div></figure><p id="4951" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">佛罗里达州的邮政编码出现在房市危机中受打击最严重的前50个地区。自2012年以来，佛罗里达州的许多地区尚未恢复。</p><p id="0ade" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">这个项目的最后一部分是最耗时的。创建一个一段时间内每个邮政编码的动画分布图比我想象的要困难得多。我最终使用了一个名为Geopandas的库，我在网上找到了一个. shp文件，上面有美国每个邮政编码的多边形坐标和形状。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ks"><img src="../Images/8e316958fb935961e84ee65815a6b27c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5BZD6kRY2qZYWWiWjEYuBQ.png"/></div></div></figure><p id="ea48" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">我清理了这些数据，然后将其与我之前的数据集合并。一旦数据被清理和组织，我开始绘图。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kt"><img src="../Images/a3c24ba897855e0badf0008df1137937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B0HxwVUmpaVPy70jn_I6xQ.png"/></div></div></figure><p id="53ca" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">这里有几点需要注意。默认情况下，绘制geopandas地图时，每个国家都有一个空白区域。我必须控制X和Y轴，以便将美国大陆与世界其他地区隔离开来。另外，你可能会注意到地图上有很多空白。这是因为我正在处理的数据集并不包含美国的所有邮政编码。以后想找一个完整的数据集，看一看剧情。</p><p id="a892" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">试图给这张地图添加动画不是一件容易的事情。Geopandas不提供任何动画功能，所以我找到了一个替代解决方案。这个过程有点笨拙，但它的工作。</p><p id="67bf" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">我首先创建了一个for循环，它将为每个时间段创建一个图，然后将该图作为图像保存在一个文件夹中。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div class="er es ku"><img src="../Images/2bc9605022a340d52a6032c22649e10b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*ggn5_4lRaZXRlJZxy_e3Ug.png"/></div></figure><p id="4213" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">运行这段代码需要一段时间，因为它必须绘制14，000个坐标283次。</p><p id="453b" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">然后，我使用OpenCV2编写了一个python脚本来收集文件夹中的所有图像，然后将其转换为MP4文件。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/a495bbd3cd3a5fc85f02e66788113387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*JaEiwO0fPl8Jqw47MIG0kA.png"/></div></figure><p id="5c71" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">最终产品看起来像这样:</p><figure class="jk jl jm jn fd ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure><p id="d330" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">横条上的数字代表房屋价值增加的百分比，最大值为200%。</p><p id="2199" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">该项目的目的不是发现任何关于住房市场的新的革命性见解。我的主要目标是证明，仅仅学习Python一个月，仍然可以完成很多事情。如果您对这个数据集有任何疑问，或者想要学习python时的最佳实践的提示，请随时联系我！</p></div></div>    
</body>
</html>