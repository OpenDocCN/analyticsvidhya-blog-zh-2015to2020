<html>
<head>
<title>New ABCD Of Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的新ABCD</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/new-abcd-of-machine-learning-c5bf9eba75bf?source=collection_archive---------24-----------------------#2020-03-30">https://medium.com/analytics-vidhya/new-abcd-of-machine-learning-c5bf9eba75bf?source=collection_archive---------24-----------------------#2020-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ca22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">时尚MNIST形象分类</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/99b67c207897de37dbf39f9066b50d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywc1SaWWa9JhjhMhgVlyoA.png"/></div></div></figure><p id="9e36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你曾经尝试过图像分类，我打赌你的第一个模型会是MNIST手写数字分类，这有点酷。它被认为是机器学习的“你好世界”，但如果你想要一些新的东西，我会有它“<em class="jp">时尚MNIST图片分类</em>”。它的难度和它的兄弟一样，但是有些不同。所以让我们打开它。</p><p id="c88f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文Github链接:<a class="ae jq" href="https://github.com/aryan109/medium/blob/master/medium_fashion_MNIST.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/aryan 109/medium/blob/master/medium _ fashion _ mnist . ipynb</a></p><h1 id="6d30" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">时尚MNIST数据集</h1><p id="5bdc" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">它包括10类不同类型的服装和配饰，如鞋子、衬衫、裤子等。</p><p id="d9e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每张图片都是28*28像素，黑白的，听起来复古？这是一个单通道图像，意味着它是灰度的，现在听起来很现代😉。如果任何图像将是多色的，那么它将有3个通道，每一个红色蓝色和绿色。这是数据集中的一个示例图像。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/b59c71083f1e300874d9ad6c03331d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*4_BnzTOdG0_mvPWImzwGgg.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图像样本</figcaption></figure><h1 id="68ba" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">模型介绍</h1><p id="a9e0" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们将在这个项目中使用TensorFlow和Keras，因为它们提供了许多机器学习实用程序的高级实现。我建议您使用<em class="jp">合作实验室</em>来运行代码，因为它预装了TensorFlow，并且还提供了GPU硬件加速，这将帮助我们缩短模型的训练时间。</p><h1 id="e153" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">合作实验室简介</h1><p id="89e8" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">它是一个在线平台，提供类似Jupyter笔记本的接口来执行python。它同时支持Python 2和Python 3。正如我之前告诉你的，它有TensorFlow和ha GPU硬件加速可用。</p><p id="473f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是最好的入门平台。稍后，您可以在自己的设备上安装TensorFlow。</p><p id="cdf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是合作实验室的链接:<a class="ae jq" href="https://colab.research.google.com/notebooks/welcome.ipynb#scrollTo=5fCEDCU_qrC0" rel="noopener ugc nofollow" target="_blank">https://colab . research . Google . com/notebooks/welcome . ipynb # scroll to = 5 FCE dcu _ qrc 0</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/bd1554beec242785dbf8f3bb766fbdcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-QZ_wlzRXXerib7iF5bZg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">合作实验室的惠康之窗</figcaption></figure><h1 id="1216" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">从代码开始</h1><p id="146a" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们将从导入所需的库开始。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="58ef" class="lf js hi lb b fi lg lh l li lj"><em class="jp">import tensorflow as t</em></span><span id="624b" class="lf js hi lb b fi lk lh l li lj"><em class="jp">import numpy as np</em></span><span id="e19c" class="lf js hi lb b fi lk lh l li lj"><em class="jp">from tensorflow import keras</em></span></pre><h1 id="a1e5" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">数据加载和预处理</h1><p id="d9dd" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在这里，我们将神经网络用于我们的图像分类模型。您可能知道，“数据”是任何模型的燃料，因此我们首先必须将数据加载到我们的系统中，然后对其进行预处理，使其可用于我们的模型。</p><p id="33a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">时尚MNIST数据集已经存在于Keras中，因此我们不必从外部下载它。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="3fbb" class="lf js hi lb b fi lg lh l li lj">fashion_mnist = keras.datasets.fashion_mnist(train_images,train_labels),(test_images,test_lables)=fashion_mnist.load_data()</span></pre><p id="cc05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将整个数据分为两组“训练数据集”和“测试数据集”，每一组又进一步分为“图像”和“标签”。</p><p id="e6fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里<em class="jp"> train_images </em>和<em class="jp"> train_labels </em>将用于训练模型，而<em class="jp"> test_images </em>和<em class="jp"> test_labels </em>将用于测试我们的模型的准确性。</p><p id="738f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用以下代码查看我们的数据:</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="3932" class="lf js hi lb b fi lg lh l li lj">import matplotlib.pyplot as plt</span><span id="0bab" class="lf js hi lb b fi lk lh l li lj">plt.imshow(train_images[0])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/b59c71083f1e300874d9ad6c03331d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*4_BnzTOdG0_mvPWImzwGgg.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">这将是输出</figcaption></figure><h1 id="1c31" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">重塑数据集</h1><p id="f225" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们不能将图像直接输入模型。我们需要创建一个NumPy图像数组，然后将其提供给模型。转换非常简单，只需调用【reshape()。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="8239" class="lf js hi lb b fi lg lh l li lj">train_images = train_images.reshape(60000,28,28,1)<br/>#60000 is number of train images</span><span id="841f" class="lf js hi lb b fi lk lh l li lj">test_images = test_images.reshape(10000,28,28,1)<br/>#10000 is number of test images</span></pre><h1 id="a290" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">标准化我们的数据集</h1><p id="ad53" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">图像归一化是图像处理中改变像素强度值范围的典型过程。它的正常目的是将输入图像转换为更熟悉或更正常的像素值范围，因此称为归一化。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/c20e77687ca49405f6f5836f8b24c2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7l057gW-uMuZfEF5zXnIvg.png"/></div></div></figure><p id="9aa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了标准化，我们将简单地除以255。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="411b" class="lf js hi lb b fi lg lh l li lj">train_images,test_images=train_images/225.0,test_images/255</span></pre><h1 id="d37e" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">定义我们的模型</h1><p id="f378" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在我们将使用Keras定义我们的模型。我们将使用CNN连接到完全连接的DNN。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="d1cf" class="lf js hi lb b fi lg lh l li lj">model = keras.Sequential([<br/> keras.layers.Conv2D(64,(3,3),activation = ‘relu’,input_shape=(28,28,1)),<br/> keras.layers.MaxPooling2D(2,2),<br/> keras.layers.Flatten(),<br/> keras.layers.Dense(128,activation = ‘relu’),<br/> keras.layers.Dense(10,activation = ‘softmax’)<br/>])<br/>model.summary()</span></pre><p id="968f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">model.summary()将为我们提供关于模型的信息</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/45a60e7fbe1cbdce5d35e5b049c0422c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UuYyRupQMxR6L2Fcy0kOsQ.png"/></div></div></figure><p id="abde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只看可训练参数数量1，366，506！！！</p><h1 id="1e0c" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">利用优化器和损失函数编译模型</h1><p id="a4a9" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated"><strong class="ih hj">优化器</strong>更新权重参数以最小化损失函数。损失函数充当地形的向导，告诉<strong class="ih hj">优化器</strong>它是否正朝着正确的方向移动以到达谷底，即全局最小值。</p><p id="7420" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用<em class="jp"> Adam </em>作为我们的优化器，使用<em class="jp">稀疏分类交叉熵</em></p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="2727" class="lf js hi lb b fi lg lh l li lj">model.compile(optimizer = tf.train.AdamOptimizer(),</span><span id="1a53" class="lf js hi lb b fi lk lh l li lj">loss = ‘sparse_categorical_crossentropy’,</span><span id="8aa8" class="lf js hi lb b fi lk lh l li lj">metrics = [‘accuracy’])</span></pre><h1 id="472d" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">训练我们的模型</h1><p id="d278" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们将使用<em class="jp"> model.fit() </em>来训练我们的模型大约50个纪元。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="68fe" class="lf js hi lb b fi lg lh l li lj">model.fit(train_images,train_labels,epochs = 50)</span></pre><h1 id="4223" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">评估我们的模型</h1><p id="d5b5" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在，我们将使用测试数据评估我们的模型，并找出它在看不见的数据上的表现有多好。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="3586" class="lf js hi lb b fi lg lh l li lj">model.evaluate(test_images,test_lables)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/95072b5835715ae21099a3fad3ce2c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Zmrb0Z3q3o-lsp53v211g.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">这就是最终的输出</figcaption></figure><p id="91d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">损失:0.26，准确率:91.4% </strong></p><p id="349f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个结果还是蛮不错的。由于模型参数的随机初始化，您可能会得到稍微不同的结果。</p></div></div>    
</body>
</html>