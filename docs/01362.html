<html>
<head>
<title>Build a Python Flask App on Glitch!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Glitch上构建一个Python Flask应用程序！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-a-python-flask-app-on-glitch-fc2c4367baaf?source=collection_archive---------2-----------------------#2019-10-17">https://medium.com/analytics-vidhya/build-a-python-flask-app-on-glitch-fc2c4367baaf?source=collection_archive---------2-----------------------#2019-10-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c1f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">厌倦了用Python制作基于文本的自主冒险游戏？准备好通过结合HTML/CSS图形用户界面将您的Python程序带到下一个级别了吗？</p><p id="7d09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Flask是用Python后端构建HTML/CSS web应用程序的完美框架。在本教程中，我们将在<a class="ae je" href="https://glitch.com/" rel="noopener ugc nofollow" target="_blank"> Glitch </a>上构建一个<em class="jd">Office-</em>主题的Flask应用程序！</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jf"><img src="../Images/8d1fee32d4d074e95515eaed8c66c5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*E_H8tIT1cHnHxEHtaYyZBg.gif"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">via <a class="ae je" href="https://giphy.com/" rel="noopener ugc nofollow" target="_blank"> GIPHY </a></figcaption></figure><p id="77ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，你没听错——没有令人沮丧的下载或设置，没有用头撞墙。你可以使用<a class="ae je" href="https://glitch.com/" rel="noopener ugc nofollow" target="_blank"> Glitch </a>直接在你的浏览器中构建这个Flask应用！</p><p id="6ca8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将制作这个应用程序，要求您选择荒岛书籍…</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jr"><img src="../Images/2e428039b967baae9fad31296bb6e290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bgtbg0iIloKs7jGjxwsjag.png"/></div></div></figure><p id="73ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">…然后根据你的回答告诉你你是哪个<em class="jd">办公室</em>人物！</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jw"><img src="../Images/5ea316323b57a4283127206709cae912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RD9_bxTva8BpEcUka4linw.png"/></div></div></figure><p id="313e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你还没有，去<a class="ae je" href="https://glitch.com/" rel="noopener ugc nofollow" target="_blank"> Glitch </a>做个账户。然后按下预览屏幕右下角的麦克风按钮，重新混合<a class="ae je" href="https://glitch.com/~flask-office-starter" rel="noopener ugc nofollow" target="_blank"> Flask Office starter代码</a>。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jx"><img src="../Images/29f0ebd0cae061e234fed81de353399c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mOwIzxqVGDxddjADhQo5KA.png"/></div></div></figure><p id="3960" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">注意:本教程假设读者熟悉HTML/CSS和Python编程。如果你对这些主题不熟悉，可以看看我的其他教程，如果你不怕的话，也可以跟着复制粘贴！</em></p><h1 id="e120" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">模型-视图-控制器架构，或者为什么我们有所有这些文件</h1><p id="c66b" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">这么多文件，都是给你准备的！为什么这么多？</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es lb"><img src="../Images/535bd9f90bf271dd1be84680741301e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nbKmk28iA5ueba3w0_neTA.png"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">为什么文件树中有这么多文件？</figcaption></figure><p id="ba36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们回顾一下大多数web应用程序是如何分解的基础知识。</p><ul class=""><li id="c3a7" class="lc ld hi ih b ii ij im in iq le iu lf iy lg jc lh li lj lk bi translated"><strong class="ih hj">模型</strong>:这是你的应用的主要Python后端逻辑。你所有的类，函数等等。住在这里。我们的模型目前包含在<strong class="ih hj"> model.py </strong>中，尽管在其他地方你可能会看到一个包含多个Python类和文件的文件夹。</li><li id="499c" class="lc ld hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated">查看:这是我们漂亮的HTML/CSS界面——用户看到的。我们的视图目前包含在<strong class="ih hj">模板</strong>文件夹中，其中包含两个空的HTML文件:<strong class="ih hj">index.html</strong>和<strong class="ih hj">result.html</strong>。还有一个<strong class="ih hj">静态</strong>文件夹，其中包含我们的<strong class="ih hj"> style.css </strong>文件等资产。</li><li id="ae5e" class="lc ld hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><strong class="ih hj">控制器</strong>:控制器介于模型和视图之间，调用模型进行后端计算，并将结果传递给视图。我们的控制器住在<strong class="ih hj"> server.py </strong>里。</li></ul><p id="20b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了将这种架构概念化，将web应用程序想象成一家餐馆会有所帮助。模型就是厨房，所有的食物都是在这里烹饪的。视图是呈现给客人的菜单。服务员就是控制者，跑在客人和厨房之间，给客人送食物。</p><h1 id="ad33" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">预览主页</h1><p id="c477" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">现在，我们的主页很无聊。如果我们按“显示”，我们只会看到一些非常简单的Times New Roman文本，上面写着“你好，世界！”</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es lq"><img src="../Images/2bb0fbaf743095429b3ca7d6931980ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*opgEV3V2GIrI7TfWfnzcjw.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es lr"><img src="../Images/4856742a8c4afbee43377172c19a4cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hQav-wppd_z-_C-9sHDgHA.png"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">BOOOO环</figcaption></figure><p id="8673" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这条消息到底是从哪里来的？弹出打开<strong class="ih hj"> server.py </strong>，看看能不能找到线。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ls"><img src="../Images/e625b113755404ffc7ae454e3b75dae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*WrErjQrlwwSO-27B8lH_Hw.png"/></div></figure><p id="eee8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上，我们将在这里变得有趣起来，而不是仅仅返回一个字符串，而是返回一个完整的HTML页面作为我们的主页。</p><p id="e5aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以从导入中看到我们已经导入了<code class="du lt lu lv lw b">from flask import render_template</code>，这意味着我们可以使用Flask中的<code class="du lt lu lv lw b">render_template</code>函数来呈现HTML页面。</p><p id="d0af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而不是回“你好，世界！”我将让我的Flask应用程序从我的<strong class="ih hj">模板</strong>文件夹中提供<strong class="ih hj">index.html</strong>页面。</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="d4b2" class="mb jz hi lw b fi mc md l me mf"><a class="ae je" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route("/")<br/>def home():<br/>  return render_template("index.html")</span></pre><p id="e829" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经准备好看看我们的应用程序现在做了什么…除了一条关于Glitch上编码Flask应用程序的<strong class="ih hj">重要信息！</strong></p><h1 id="eea1" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">在Glitch上使用控制台</h1><p id="fd54" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">每当你在Glitch上对Flask应用程序进行更改时，都需要一段时间才能生效。但是，您可以通过打开控制台并运行刷新命令来强制Glitch更新应用程序。</p><p id="2578" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我通常通过点击左下角的“工具”，然后选择工具栏顶部的“日志”来打开控制台。然后，我可以导航到“控制台”作为选项之一，并运行“刷新”</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mg"><img src="../Images/6d3d130a6dce869791606dd2d4b1cce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*XWO6b7PXjZ_i6kiRpyHqSw.png"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mh"><img src="../Images/da2aa3456f3bea256ac9d94a8cc01912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LKdatVfXMig9cuSGJf0VGQ.png"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">键入“刷新”，然后点击返回！</figcaption></figure><p id="d5ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">顺便说一句，控制台也是你可以运行像<code class="du lt lu lv lw b">mkdir</code>和<code class="du lt lu lv lw b">touch</code>这样的命令来创建新目录和文件的地方。</p><h1 id="cd8a" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">在主页上使用模板</h1><p id="ce5d" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">好的，你在控制台中运行了“刷新”,然后再次预览了你的应用。这是一个完全无聊的白页吗？</p><p id="486e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是因为，如果你打开<strong class="ih hj">模板</strong>，然后打开<strong class="ih hj">index.html</strong>，我们实际上并没有在这里编写任何HTML代码！</p><p id="d85d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们解决这个问题，添加一个HTML框架和一个标题:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="98ca" class="mb jz hi lw b fi mc md l me mf">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;The Office Quiz&lt;/title&gt;<br/>    &lt;link rel="stylesheet" type="text/css" href="static/style.css"&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;h1&gt;<br/>      The Office Quiz<br/>    &lt;/h1&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="5aa4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在运行“刷新”之后，您应该会在页面上看到一些文本！</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mi"><img src="../Images/11a34df7fa1fcaeb157102704de75817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QFzzMoIK-N8neOrCRaox_w.png"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">太美了。</figcaption></figure><h1 id="57ba" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">制造另一条路线</h1><p id="fb10" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">我们已经建立了主页的基本框架。我们只需要另外一个页面，当用户发现他们是什么样的Office角色时就会得到这个结果。</p><p id="4428" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们跳回<strong class="ih hj"> server.py </strong>并添加这条路线。</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="7958" class="mb jz hi lw b fi mc md l me mf"><a class="ae je" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route("/result")<br/>def result():<br/>  return render_template("result.html")</span></pre><p id="0210" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以通过在点击“显示”时出现的应用程序URL后添加/result来访问路径——例如，在代码中的flask-office-starter.glitch.me/result.，我们定义了一个Python函数，当用户到达该页面时运行该函数。在这里，我们再次返回一个模板，但是这次是<strong class="ih hj">result.html</strong>文件。</p><p id="fce8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们前往<strong class="ih hj"> templates/result.html </strong>并稍微修饰一下模板！添加一个HTML框架和一个标题:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="310e" class="mb jz hi lw b fi mc md l me mf">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;The Office Quiz&lt;/title&gt;<br/>    &lt;link rel="stylesheet" type="text/css" href="static/style.css"&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;h1&gt;<br/>      You're {{ character }}!<br/>    &lt;/h1&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="9945" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lt lu lv lw b">{{ character }}</code>行是一个占位符，我们稍后会谈到。很快，这将打印出用户所在的<em class="jd">办公室</em>的字符！</p><p id="68f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果您在控制台中运行“刷新”,在Glitch上按“显示”,并将“/结果”添加到URL，您应该会到达您的结果页面！</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mj"><img src="../Images/a29cde409a208f1e37f258ac2ce52293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18bouBbonCY8Fj6QGgSwFg.png"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">“结果”路线中的存在主义快乐</figcaption></figure><p id="48e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意<code class="du lt lu lv lw b">{{ character }}</code>还没有打印任何东西。这种情况很快就会改变！</p><h1 id="bebc" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">以HTML格式发送数据</h1><p id="f8aa" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">现在，我们要给用户一个小测验，将他们从主页带到结果页，在那里他们可以找到自己是哪个角色！</p><p id="d9dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简单起见，我们的测验只有一个问题:荒岛书的问题。在我们的<strong class="ih hj">index.html</strong>模板的主体中，我们将使用HTML表单中的单选按钮来询问它:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="9d7b" class="mb jz hi lw b fi mc md l me mf">&lt;form method="post" action="/result"&gt;<br/>      &lt;p&gt;<br/>        Which book would you bring to a desert island?<br/>      &lt;/p&gt;<br/>      &lt;input type="radio" name="book" value="bible"&gt; The Bible&lt;br&gt;<br/>      &lt;input type="radio" name="book" value="davinci"&gt; The Da Vinci Code&lt;br&gt;<br/>      &lt;input type="radio" name="book" value="hp"&gt; Physician's Desk Reference (hollowed out with tools inside) but also Harry Potter and the Sorcerer's Stone for when you get bored<br/>      &lt;p&gt;<br/>        &lt;input type="submit" /&gt;<br/>      &lt;/p&gt;<br/>&lt;/form&gt;</span></pre><p id="e8b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该表单使用POST方法将数据从一个网页(index.html)发送到另一个网页(result.html)。表单将通过“/result”路径。</p><p id="565a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，所有单选按钮的名称都是“book”</p><p id="a438" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在这个表单应该出现在主页上了！(记住，运行“刷新”，然后点击“显示”。)</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mk"><img src="../Images/3109429953a190b6bfaf24f65d4cad8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nv_dZ3zqpkEUPATLnlGXAg.png"/></div></div></figure><h1 id="5df9" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">模型编程</h1><p id="64df" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">好了，我们要去后端走一趟。当我们的用户通过表单发送数据时，我们需要处理它。具体来说，我需要一个函数，它接收用户选择的书，并返回他们所在的办公室角色。</p><p id="6e49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进入<strong class="ih hj"> model.py </strong>并编写以下函数:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="2d7c" class="mb jz hi lw b fi mc md l me mf">def get_character(book):<br/>  if book == "bible":<br/>    return "Angela"<br/>  elif book == "davinci":<br/>    return "Phyllis"<br/>  elif book == "hp":<br/>    return "Dwight"<br/>  else:<br/>    return None</span></pre><p id="7695" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，Python中的每本书都与HTML中的单选按钮值相同。</p><p id="8eae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，因为我很有想象力，我也想要一个函数，它从<em class="jd">Office</em>中获取一个角色，并将URL返回给他们的一个有趣的gif。将此功能添加到<strong class="ih hj"> model.py </strong>:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="5d28" class="mb jz hi lw b fi mc md l me mf">def get_gif(character):<br/>  if character == "Angela":<br/>    return "<a class="ae je" href="https://media.giphy.com/media/Vew93C1vI2ze/giphy.gif" rel="noopener ugc nofollow" target="_blank">https://media.giphy.com/media/Vew93C1vI2ze/giphy.gif</a>"<br/>  elif character == "Phyllis":<br/>    return "<a class="ae je" href="https://media.giphy.com/media/1oGnY1ZqXb123IDO4a/giphy.gif" rel="noopener ugc nofollow" target="_blank">https://media.giphy.com/media/1oGnY1ZqXb123IDO4a/giphy.gif</a>"<br/>  elif character == "Dwight":<br/>    return "<a class="ae je" href="https://media.giphy.com/media/Cz1it5S65QGuA/giphy.gif" rel="noopener ugc nofollow" target="_blank">https://media.giphy.com/media/Cz1it5S65QGuA/giphy.gif</a>"<br/>  else:<br/>    return None</span></pre><h1 id="bb25" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">用控制器连接模型和视图</h1><p id="de63" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">好了，我们有了(有点)漂亮的外形。我们有我们(绝对)美丽的功能。现在我们需要连接它们！</p><p id="d998" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">直接进入控制器的核心，<strong class="ih hj"> server.py </strong>。</p><p id="3105" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在<code class="du lt lu lv lw b">import model</code>一行中看到，我们已经导入了model.py的所有内容，这些功能现在对我们可用了。</p><p id="b71b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">行<code class="du lt lu lv lw b">from flask import request</code>意味着我们现在有了一些处理HTTP GET和POST请求的功能。(GET是指我们只要求网页，如主页，而POST将用于发送数据，如结果页。)</p><p id="f4b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们将数据发送到“/result”路由，所以我们需要修改头部以包含POST请求。更改第一行以包含GET和POST请求的功能:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="8424" class="mb jz hi lw b fi mc md l me mf"><a class="ae je" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route("/result", methods=["GET", "POST"])</span></pre><p id="23d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以让我们的函数做不同的事情，这取决于用户是获取还是发送到页面。将您的函数修改为:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="5df2" class="mb jz hi lw b fi mc md l me mf">def result():<br/>  if request.method == "POST":<br/>    return render_template("result.html")<br/>  else:<br/>    return "Sorry, there was an error."</span></pre><p id="0e30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用else语句捕捉错误(比如当我们需要POST请求时发送GET请求)总是一种好的做法。</p><p id="28ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这很好，但我们仍然没有与用户数据进行交互或处理用户数据。</p><p id="a0c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在函数的if分支中，您可以获取由类似这样的表单发送的所有数据。将这一行放在if分支内，但在return语句之前:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="2995" class="mb jz hi lw b fi mc md l me mf">userdata = dict(request.form)</span></pre><p id="aa6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您打印数据，在Glitch上“刷新”并运行您的应用程序，当您提交表单时，您会在<strong class="ih hj">日志</strong>中看到类似这样的内容:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="ef33" class="mb jz hi lw b fi mc md l me mf">{'book': [u'bible']}</span></pre><p id="a1c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个字典，其中“book”是一个键，值是一个单项式列表！您可以向下钻取并分离出具体的图书，如下所示:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="9046" class="mb jz hi lw b fi mc md l me mf">book = userdata["book"][0]</span></pre><p id="9d79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以将模型中的<code class="du lt lu lv lw b">book</code>变量输入到我们的<code class="du lt lu lv lw b">get_character</code>函数中，并找出用户是什么角色:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="f705" class="mb jz hi lw b fi mc md l me mf">character = model.get_character(book)</span></pre><p id="1e77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，因为我很好奇，我将把<code class="du lt lu lv lw b">character</code>变量输入到<code class="du lt lu lv lw b">get_gif</code>函数中，得到一个用户gif的URL！</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="5df3" class="mb jz hi lw b fi mc md l me mf">gif_url = model.get_gif(character)</span></pre><p id="f174" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧…但是我们如何将用户的角色打印到结果页面呢？！</p><p id="7ea9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还记得在results.html的h1中，我们写了下面的占位符吗:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="2c97" class="mb jz hi lw b fi mc md l me mf">&lt;h1&gt;You're {{ character }}!&lt;/h1&gt;</span></pre><p id="fbeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个占位符实际上是在<a class="ae je" href="https://jinja.palletsprojects.com/en/2.10.x/" rel="noopener ugc nofollow" target="_blank"> Jinja </a>中，一种Python的模板语言。当我们渲染模板时，我们实际上可以定义<code class="du lt lu lv lw b">{{ character }}</code>应该有什么值。</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="c76e" class="mb jz hi lw b fi mc md l me mf">return render_template("result.html", character=character)</span></pre><p id="752d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们跳到result.html，我们甚至可以添加一个gif的占位符:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="93c9" class="mb jz hi lw b fi mc md l me mf">&lt;p&gt;<br/>  &lt;img src="{{ gif_url }}" /&gt;<br/>&lt;/p&gt;</span></pre><p id="a6ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在呈现模板时将gif_url值和字符值一起发送。</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="62de" class="mb jz hi lw b fi mc md l me mf">return render_template("result.html", character=character, gif_url=gif_url)</span></pre><p id="6ef8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在<strong class="ih hj"> server.py </strong>中，您完成的“/result”路线应该是这样的:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="3d31" class="mb jz hi lw b fi mc md l me mf"><a class="ae je" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route("/result", methods=["GET", "POST"])<br/>def result():<br/>  if request.method == 'POST' and len(dict(request.form)) &gt; 0:<br/>    userdata = dict(request.form)<br/>    print(userdata)<br/>    book = userdata["book"][0]<br/>    character = model.get_character(book)<br/>    gif_url = model.get_gif(character)<br/>    return render_template("result.html", character=character, gif_url=gif_url)<br/>  else:<br/>    return "Sorry, there was an error."</span></pre><p id="d60b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您能找到我偷偷添加检查的地方吗，以确保用户在发送表单之前确实填写了表单？！</p><p id="f79a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行“刷新”，按“显示”，测试您的测验！</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mk"><img src="../Images/244bdb5842710f3de9b202b72db48ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHdHdixylClhEPzxjkUQPg.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ml"><img src="../Images/c6a7e1351f24870be2c49790c252df3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*r9lNlqaaTwb9SpULXRycoQ.png"/></div></figure><h1 id="858e" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">使用CSS设置样式</h1><p id="d5be" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">最后一件事:去<strong class="ih hj"> static/style.css </strong>添加你的风格。下面是我使用的简单样式表:</p><pre class="jg jh ji jj fd lx lw ly lz aw ma bi"><span id="be3e" class="mb jz hi lw b fi mc md l me mf">body {<br/>  font-family: courier;<br/>  margin: 2em;<br/>  letter-spacing: 1px;<br/>}</span><span id="b203" class="mb jz hi lw b fi mm md l me mf">input[type="submit"] {<br/>  border: 1px solid black;<br/>  font-family: courier;<br/>  padding: 10px;<br/>  border-radius: 10px;<br/>  font-size: 1.1em;<br/>  letter-spacing: 1px;<br/>}</span><span id="cc88" class="mb jz hi lw b fi mm md l me mf">input[type="submit"]:hover {<br/>  background-color: #eee;<br/>  cursor: pointer;<br/>}</span></pre><p id="7f40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行“刷新”，点击“显示”，欣赏您的作品！我发现CSS样式需要一段时间才能生效，所以不要害怕用一个<a class="ae je" href="https://www.google.com/search?q=hard+refresh" rel="noopener ugc nofollow" target="_blank">硬刷新</a>来清空你的缓存。</p><p id="8b00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">恭喜你，你已经在Glitch上建立了一个Flask应用程序！</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mn"><img src="../Images/3c43830d0d9688b3c936a346c71e6aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*z6i67M06SmFMlU1IJyatmg.gif"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">via <a class="ae je" href="https://giphy.com/" rel="noopener ugc nofollow" target="_blank"> GIPHY </a></figcaption></figure><h1 id="1608" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">扩展ˌ扩张</h1><ul class=""><li id="af99" class="lc ld hi ih b ii kw im kx iq mo iu mp iy mq jc lh li lj lk bi translated">当然是设计你的应用程序！</li><li id="7fa2" class="lc ld hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated">添加更多选项和结果。(迈克尔、吉姆和帕姆呢？)</li><li id="4bbc" class="lc ld hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated">向测验中添加另一个问题。</li></ul><h1 id="3182" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">其他Python教程</h1><ul class=""><li id="101f" class="lc ld hi ih b ii kw im kx iq mo iu mp iy mq jc lh li lj lk bi translated"><a class="ae je" rel="noopener" href="/@kellylougheed/coding-english-lit-natural-language-processing-in-python-ba8ebae4dde3">编码&amp;英语文学:Python中的自然语言处理</a></li><li id="3e55" class="lc ld hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><a class="ae je" href="https://towardsdatascience.com/coding-foreign-language-lit-analyzing-dantes-inferno-with-python-nltk-419124c9eb44" rel="noopener" target="_blank">编码&amp;外文Lit:用Python NLTK解析但丁的《地狱》</a></li><li id="0dcd" class="lc ld hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><a class="ae je" rel="noopener" href="/@kellylougheed/hogwarts-sorting-hat-with-python-ae1ab98a3c6b">带蟒蛇的霍格沃茨分院帽</a></li></ul></div></div>    
</body>
</html>