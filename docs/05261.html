<html>
<head>
<title>Making a Calendar in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中制作日历</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/making-a-calendar-in-react-f24d583e5728?source=collection_archive---------16-----------------------#2020-04-15">https://medium.com/analytics-vidhya/making-a-calendar-in-react-f24d583e5728?source=collection_archive---------16-----------------------#2020-04-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/16d052d00483bdf059ab140da00e5b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdDVgL2Ji3wLa2KIugdvbw.jpeg"/></div></div></figure><p id="4227" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我在Flatiron的最后一个项目中，我想制作一个类似于Airbnb的预订系统，允许用户在日历上选择一系列日期，并查看已被屏蔽的日期。经过几个小时的搜索和多次尝试，我找到了一个完美的手机友好的日期选择器库，恰巧叫做Airbnb的react-dates。这个博客将是一个关于如何在你的应用程序中设置日历，划分日期和获取日期范围的教程。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><ol class=""><li id="ab6a" class="jv jw hi is b it iu ix iy jb jx jf jy jj jz jn ka kb kc kd bi translated">正在设置</li></ol><p id="515d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，确保您安装了正确的依赖项。对于这个演示，我将使用bootstrap、反应日期、矩和矩范围。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="dc82" class="kn ko hi kj b fi kp kq l kr ks">npm install --save bootstrap react-dates moment moment-range</span></pre><p id="35ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后转到src&gt;App.js并确保您有以下导入:</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="f07e" class="kn ko hi kj b fi kp kq l kr ks">import React, {Component} from ‘react’;<br/>import ‘bootstrap/dist/css/bootstrap.min.css’;<br/>import ‘react-dates/initialize’;<br/>import ‘react-dates/lib/css/_datepicker.css’;<br/>import {DateRangePicker} from ‘react-dates’;<br/>import Moment from "moment";<br/>import { extendMoment } from "moment-range";<br/>import ‘./App.css’;</span></pre><p id="0b6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，将以下代码复制到App.js中:</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="c520" class="kn ko hi kj b fi kp kq l kr ks">class App extends Component {<br/>  state = {<br/>    startDate: null,<br/>    endDate: null<br/>  };</span><span id="4997" class="kn ko hi kj b fi kt kq l kr ks">render() {<br/>    return (<br/>    &lt;div className='App'&gt;<br/>      &lt;DateRangePicker<br/>        startDate={this.state.startDate} <br/>        startDateId="your_unique_start_date_id" <br/>        endDate={this.state.endDate} <br/>        endDateId="your_unique_end_date_id" <br/>        onDatesChange={({ startDate, endDate }) =&gt; this.setState({  startDate, endDate })} <br/>        focusedInput={this.state.focusedInput} <br/>        onFocusChange={focusedInput =&gt; this.setState({ focusedInput })}<br/>      /&gt;<br/>&lt;/div&gt;<br/>  );<br/> }<br/>}</span><span id="65d8" class="kn ko hi kj b fi kt kq l kr ks">export default App;</span></pre><p id="9350" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此时，您应该已经能够在运行npm install时看到日历了！就这么简单！但是我猜你和我一样，也想用这个日历做点什么。如果你看一下<a class="ae ku" href="https://github.com/airbnb/react-dates" rel="noopener ugc nofollow" target="_blank"> react-dates </a>的文档(我在下面做了链接)，你会发现你可以为DateRangePicker提供很多支持。你可以浏览<a class="ae ku" href="http://airbnb.io/react-dates/?path=/story/drp-input-props--default" rel="noopener ugc nofollow" target="_blank">故事书</a>来了解所有这些，但在接下来的几节中，我将专门讲述我是如何阻止日期和抓取日期的。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="4242" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.取消约会</p><p id="9f4b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">React-date好心地给我们提供了一个道具，让你传递一个函数，它会相应地屏蔽掉日期——<strong class="is hj">is day blocked</strong>。在做了一些检测工作(也就是控制台日志记录)之后，我发现<strong class="is hj">被阻塞的函数</strong>一次给函数一个日期，当它从函数中出来时返回true或false。如果返回值为真，那么这一天将被封锁。听起来很简单，对吗？！但是没有。对于我的应用程序，我需要在数据库中存储一个开始日期和一个结束日期。我意识到我需要创建一个范围，将中间的所有日期都屏蔽掉。这一部分要求你深入moment.js的世界，这有点吓人，但是一旦你阅读了<a class="ae ku" href="https://www.npmjs.com/package/moment-range/v/1.0.2" rel="noopener ugc nofollow" target="_blank">文档</a>，它实际上非常简单。经过大量的思考并一步一步地写出所有的东西，我想到了这个解决方案:</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="4f8c" class="kn ko hi kj b fi kp kq l kr ks">isBlocked = date =&gt; {<br/>  let bookedRanges = [];<br/>  let blocked;</span><span id="3dc0" class="kn ko hi kj b fi kt kq l kr ks">  bookings.map(booking =&gt; {<br/>    bookedRanges = [...bookedRanges, <br/>    moment.range(booking.startDate, booking.endDate)]<br/>   }<br/>  );</span><span id="5939" class="kn ko hi kj b fi kt kq l kr ks">blocked = bookedRanges.find(range =&gt; range.contains(date));</span><span id="09e5" class="kn ko hi kj b fi kt kq l kr ks">return blocked;<br/>};</span></pre><p id="1e2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我使用moment.range()将我的预订数组转换成一个范围数组。这需要开始日期和结束日期。然后我获取这个数组，对于DateRangePicker传入的每个日期，我使用。find()检查是否在我的范围内。如果是，那么它会给我一个true或false值，这个值会返回给DateRangePicker。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="5880" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.抓住日期</p><p id="a0dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我的预订日历的下一站是能够选择日期以便创建预订。为了使事情变得更简单，我使用一个带有startDate和endDate的警报来测试是否返回了正确的值。正如你在上面(和下面)看到的，startDate和endDate需要有自己的状态。这非常有利于使用，因为这意味着获取数据非常容易。我制作了一个按钮，在onClick上为这两种状态发出警告，让自己看到状态在相应地更新。这给了我制定实际预订方法所需的一切。</p><p id="78f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我的App.js文件包含所有代码后的样子:</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="70cf" class="kn ko hi kj b fi kp kq l kr ks">class App extends Component {<br/>  state = {<br/>    startDate: null,<br/>    endDate: null<br/>  };</span><span id="d254" class="kn ko hi kj b fi kt kq l kr ks">  alertStartDate = () =&gt; {alert(this.state.startDate)};</span><span id="cf5d" class="kn ko hi kj b fi kt kq l kr ks">  alertEndDate = () =&gt; {alert(this.state.endDate)};</span><span id="b0fa" class="kn ko hi kj b fi kt kq l kr ks">  render() {<br/>    return (<br/>    &lt;div className='App'&gt;<br/>      &lt;DateRangePicker<br/>        startDate={this.state.startDate} <br/>        startDateId="your_unique_start_date_id" <br/>        endDate={this.state.endDate} <br/>        endDateId="your_unique_end_date_id" <br/>        onDatesChange={({ startDate, endDate }) =&gt; this.setState({  startDate, endDate })} <br/>        focusedInput={this.state.focusedInput} <br/>        onFocusChange={focusedInput =&gt; this.setState({ focusedInput })}<br/>        isDayBlocked={this.isBlocked} <br/>      /&gt;</span><span id="695c" class="kn ko hi kj b fi kt kq l kr ks">    &lt;button onClick={this.alertStartDate}&gt;Click me for start date&lt;/button&gt;</span><span id="74c8" class="kn ko hi kj b fi kt kq l kr ks">    &lt;button onClick={this.alertEndDate}&gt;Click me for end date&lt;/button&gt;</span><span id="ecdc" class="kn ko hi kj b fi kt kq l kr ks">  &lt;/div&gt;<br/>  );<br/> }<br/>}</span><span id="0142" class="kn ko hi kj b fi kt kq l kr ks">export default App;</span></pre></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="7187" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我最后一个项目中最让我紧张的部分。但是我再次被提醒，如果我把事情分解成小块，我最终会找到解决方法。即使您的应用程序不需要这种确切的功能，我也希望这篇文章是一个有用的演示，说明如何设置react-dates日历以及从那里开始。</p><p id="bc52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">来源:</p><div class="kv kw ez fb kx ky"><a href="https://github.com/airbnb/react-dates" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">Airbnb/react-date</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">一个易于国际化、易于访问、移动友好的web日期选择器库。例如…</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">github.com</p></div></div><div class="lh l"><div class="li l lj lk ll lh lm io ky"/></div></div></a></div><p id="1a30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ku" href="http://airbnb.io/react-dates/?path=/story/drp-input-props--default" rel="noopener ugc nofollow" target="_blank">http://airbnb.io/react-dates/?path=/story/drp-input-props-默认</a></p><div class="kv kw ez fb kx ky"><a href="https://www.npmjs.com/package/moment-range/v/1.0.2" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">力矩范围</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">Moment.js的奇特日期范围</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">www.npmjs.com</p></div></div><div class="lh l"><div class="ln l lj lk ll lh lm io ky"/></div></div></a></div><div class="kv kw ez fb kx ky"><a href="https://momentjs.com/docs/" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">Moment.js | Docs</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">Moment被设计为可以在浏览器和Node.js中工作。所有代码都应该在这两种环境中工作，并且…</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">momentjs.com</p></div></div></div></a></div></div></div>    
</body>
</html>