<html>
<head>
<title>Customer Churn Prediction in a Telco</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电信行业的客户流失预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/churn-prediction-in-a-telco-70ba5aa12f70?source=collection_archive---------5-----------------------#2019-10-17">https://medium.com/analytics-vidhya/churn-prediction-in-a-telco-70ba5aa12f70?source=collection_archive---------5-----------------------#2019-10-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="022e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">所有与本帖相关的代码都可以在</em> <a class="ae je" href="https://github.com/alonsosilvaallende/Churn-Prediction-in-a-Telco" rel="noopener ugc nofollow" target="_blank"> <em class="jd">这里</em> </a> <em class="jd">找到。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/8800bc15320f6e90d835405b933c41c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5WQLCjhNc1on9pIx"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">亚历山大·安德鲁斯在<a class="ae je" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="7124" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">客户流失是客户或顾客的损失。为了避免失去客户，一个公司需要检查为什么它的客户在过去离开了，哪些特征对决定谁将在未来流失更重要。因此，我们的任务是预测客户是否会流失，以及哪些是正确预测的最重要特征。和大多数预测问题一样，我们会使用机器学习。</p><p id="8dde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何利用机器学习来做到这一点？首先，我们需要建立一个评估指标。给定一个数据集，我们如何评估我们的流失预测是对还是错？每个人最终都会流失(一些人会换到不同的公司，一些人会完全停止使用提议的服务，最终所有人都会流失，如果不是的话，因为最终公司会像人一样死去)。</p><p id="59f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以问题依然存在，你如何评估你的流失预测是对还是错？</p><p id="c635" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在其他地方(例如参见<a class="ae je" href="https://ragulpr.github.io/2016/12/22/WTTE-RNN-Hackless-churn-modeling/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>或<a class="ae je" rel="noopener" href="/@zachary.james.angell/applying-survival-analysis-to-customer-churn-40b5a809b05a">这篇文章</a>)有人认为，评估流失预测模型的正确方法是通过<a class="ae je" rel="noopener" href="/analytics-vidhya/concordance-index-72298c11eac7">一致性指数</a>。和谐指数基本上集中在被搅动的客户的<strong class="ih hj">订单</strong>。它被定义为预测的一致对的比例除以预测的可能评估对的总数。由于上述原因，这是一种比将问题作为二元分类问题来处理更好的方法。</p><p id="2c7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我认为思考这个问题的正确方式是，假设我们的模型已经预测到客户会以一定的顺序流失，那么这个顺序就是正确的。那些被预测会先流失的顾客确实已经先流失了。因此，我们将通过索引来评估我们的机器学习模型。</p><p id="54b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据咨询服务公司treselle Systems<a class="ae je" href="http://www.treselle.com/blog/customer-churn-logistic-regression-with-r/" rel="noopener ugc nofollow" target="_blank">使用逻辑回归分析了客户流失数据</a>。我们将使用该数据集进行分析。</p><p id="1ccb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于数据集的伟大数据分析，请看<a class="ae je" rel="noopener" href="/@zachary.james.angell/applying-survival-analysis-to-customer-churn-40b5a809b05a">的帖子</a>，作者<a class="ae je" rel="noopener" href="/@zachary.james.angell">扎克·安吉尔</a>。然而，在这篇文章中，我们的重点是不同的，因为我们对使用机器学习进行预测感兴趣。</p><p id="de1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先安装库lifelines和pysurvival以及通常的导入</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><p id="899f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们下载数据集并展示前5个客户</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jx"><img src="../Images/a7a8030c72e2d497140aef327eb9b622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebzZY0Ruh_KrAlGpWVwaeg.png"/></div></div></figure><p id="e00c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集包括以下信息:</p><p id="3d5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+流失的客户—该列称为流失</p><p id="48a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+每位客户已注册的服务—电话、多条线路、互联网、在线安全、在线备份、设备保护、技术支持以及流媒体电视和电影</p><p id="99ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+客户帐户信息—他们成为客户的时间、合同类型(按月、一年、两年)、支付方式、无纸化账单、月费和总费用</p><p id="84d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+客户的人口统计信息——性别、年龄范围，以及他们是否有伴侣和家属</p><p id="68fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数据集中，有7043个客户，其中1869个客户(27%)已经搅动，5174个客户(73%)还没有搅动。</p><p id="a65c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们删除了ID列和TotalCharges列(否则，通过了解每月费用，我们的模型可以很容易地推断出某人已经订阅了多少个月)。我们最后对分类变量使用<a class="ae je" href="https://en.wikipedia.org/wiki/One-hot" rel="noopener ugc nofollow" target="_blank">一键编码</a>。有关数据预处理的详细信息，请查看<a class="ae je" href="https://github.com/alonsosilvaallende/Churn-Prediction-in-a-Telco" rel="noopener ugc nofollow" target="_blank">相关代码</a>。</p><h1 id="35dc" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">数据分析</strong></h1><p id="7b41" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">为了评估我们的模型，我们将数据集分为训练数据集(70%)和测试数据集(30%)。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><p id="7519" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本帖中，我们想比较三种不同的随机森林模型与默认值的性能，以进行流失预测:</p><p id="c13d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+随机森林分类器</p><p id="4898" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+随机森林回归量</p><p id="5d20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+随机生存林</p><p id="6f78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们希望仅从一组特征/协变量中确定谁将首先流失。</p><p id="433b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林分类器通常给出0或1，但是我们可以使用方法<a class="ae je" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier.predict_proba" rel="noopener ugc nofollow" target="_blank"> predict_proba </a>来获得属于搅动类的概率，并因此使用该概率进行搅动的预测排序。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lb"><img src="../Images/462d72f2c12e00d9793ee4423eaf3fdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*Z7LacdIwyzKnqHjfT32lug.png"/></div></figure><p id="209f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林分类器获得0.765的一致指数。最重要的特点是每月收费，其次是合同类型和支付方式。</p><p id="8c5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们先来看看随机森林回归器在只考虑客户的情况下是如何表现的。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lc"><img src="../Images/f5e8e60349ea4d3e1260d9d8b632732f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*LqSrAHDdy2kRExyft7Wrog.png"/></div></figure><p id="a481" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林回归得到的和谐指数为0.817。最重要的特点是每月收费和合同类型。</p><p id="d4a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过考虑所有的顾客来看看我们是否做得更好。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ld"><img src="../Images/0a263ecfc18752c08b0e9281fb62a2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*quauEx1TpR6YoFKXiOo9UQ.png"/></div></figure><p id="f8c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林回归得到的和谐指数为0.82，这与仅考虑顾客的和谐指数几乎相同。最重要的特征是合同类型和每月费用。所有其他功能都远远落在后面。</p><p id="eb0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看随机生存森林的表现。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es le"><img src="../Images/9be35d94f80ca23e2c5e9ed58773baab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*1OH2_OMjkntk_mq5VtN3eQ.png"/></div></figure><p id="c84e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机存活林的和谐指数为0.844。最重要的特征是合同类型、支付方式以及客户是否有与账户相关的在线服务。与随机森林分类器和随机森林回归器给出的重要性相比，每月费用的重要性要小得多。</p><p id="4493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可能是因为我们分割数据集的方式给了随机生存森林模型一个优势。让我们试试随机选择的20颗种子。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lf"><img src="../Images/88884f50d2c034cb4644abd0fcbd8e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*72Jep6nUE7QkFhwmhyX3KA.png"/></div></figure><p id="b7de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在所有考虑的情况下，随机存活森林模型优于随机森林分类器模型和两种考虑的随机森林回归模型。</p><h1 id="b8a0" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">结论</strong></h1><p id="6473" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">我们使用三种不同的随机森林模型考虑了电信公司中的流失预测问题:随机森林分类器、随机森林回归器和随机生存森林，并以和谐指数作为评估指标。在所有考虑的情况下，随机存活森林优于随机森林分类器和随机森林回归器。</p><h1 id="39a5" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">附录</strong></h1><p id="c51c" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">在我们的分析中，我们对随机森林回归器和随机森林分类器不公平，因为没有简单的方法来包括感兴趣的事件(流失)和人们订阅这些模型的时间(或最近已知的时间)。</p><p id="5ec2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林分类器仅使用可用的流失信息。随机森林回归器仅使用可用的时间信息。然而，随机生存森林同时使用流失信息和时间信息。</p><p id="eb1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们考虑两种额外的情况:</p><p id="2fac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，随机森林分类器将使用流失信息，我们将使用流失信息运行随机森林回归器(我们称这种方法为随机森林分类器-回归器)。</p><p id="a8e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二，随机森林回归器将使用时间信息，我们将使用该时间信息运行随机森林分类器(我们称这种方法为随机森林回归器-分类器)。</p><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lg"><img src="../Images/6b71511e85932c291d9c4188134a8291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*vrb3Q5ZdWTKS0g_jhqqmoQ.png"/></div></figure><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="jv jw l"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lh"><img src="../Images/8767d5424feec31d9444d025d977a03b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*raMd0GidUjyZuzQP3Oz1Qw.png"/></div></figure><p id="28e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两种情况都比随机存活森林表现差(随机森林分类器-回归器给出0.689的一致指数，随机森林回归器-分类器给出0.622的一致指数)。实际上，他们的表现比仅仅考虑一个可用的信息更差。</p></div></div>    
</body>
</html>