<html>
<head>
<title>Time Series Prediction with Machine Learning (Getting Started).</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习进行时间序列预测(入门)。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-prediction-with-machine-learning-getting-started-8763eda1127f?source=collection_archive---------2-----------------------#2020-12-16">https://medium.com/analytics-vidhya/time-series-prediction-with-machine-learning-getting-started-8763eda1127f?source=collection_archive---------2-----------------------#2020-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/adee8aba372a8e1be81f534d606694bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/0*a1kdXwxgKvBAcu6P.jpg"/></div></figure><blockquote class="im in io"><p id="6555" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是时间序列数据？</strong></p></blockquote><p id="d04c" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">时间序列数据(带时间戳的数据)是按时间顺序索引的数据点序列。时间戳是在不同时间点收集的数据。</p><p id="2f2d" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">这些数据点通常由同一来源在一段时间间隔内进行的连续测量组成，用于跟踪随时间的变化。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es jr"><img src="../Images/e4b199446e1869920c98d0adb30e7d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*d-SPsArv9q0pANN0hgWSzQ.png"/></div></figure><p id="65ce" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated"><strong class="is hj">举例</strong>:这里有一个数据集，是一个男人从 2004 年 1 月 1 日到<strong class="is hj">2007 年 1 月 1 日到 2007 年 5 月 1 日的个人消费情况，数据在每个月的第一天定期收集。</strong></p><blockquote class="im in io"><p id="0dfc" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">时间序列数据有什么用？</strong></p></blockquote><p id="1c7d" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">使用时间序列数据，我们可以发现数据中的模式，然后可以用它来预测任何给定变量的值。</p><p id="b03a" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">这也有其局限性，如果给定的变量很大程度上依赖于任何外部因素，我们的模型将不会给出最佳结果。</p><p id="fbdc" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">然而，时间序列预测是机器学习的一个重要领域，因为有许多预测问题涉及时间成分。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jw"><img src="../Images/0dd926bcf73cb1aaddffd989f428b6f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lU7kXQ_tytGcNazj.png"/></div></div></figure><p id="c503" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">做时间序列分析/预测时有很多组成部分。使用<strong class="is hj">个人支出</strong>数据集的例子对其进行分析&amp;预测，我们将研究随之而来的所有组成部分。</p><blockquote class="im in io"><p id="9d93" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 1。获取正确格式的时间序列数据</strong></p></blockquote><p id="bee6" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi kb translated"><span class="l kc kd ke bm kf kg kh ki kj di">我们</span>将处理个人支出数据集，该数据集包含一名男子从 2004 年 1 月 1 日到 2007 年 1 月 1 日的个人支出，数据在每月的第一天定期收集。</p><ul class=""><li id="0009" class="kk kl hi is b it iu ix iy jo km jp kn jq ko jn kp kq kr ks bi translated">将包含时间戳数据的变量传递给 index_col，并设置 parse_date=True，以正确的格式读取数据。</li><li id="6bd0" class="kk kl hi is b it kt ix ku jo kv jp kw jq kx jn kp kq kr ks bi translated">检查我们的数据集的频率(可以是每天，每月，每年等。)并相应地设置索引频率。</li></ul><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ky"><img src="../Images/131342d329f9e20cb96ca6328427c1b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yof_hrbs7S1oajZXe0TWtg.png"/></div></div></figure><blockquote class="im in io"><p id="783b" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.<strong class="is hj"> EDA </strong></p></blockquote><ul class=""><li id="6ff5" class="kk kl hi is b it iu ix iy jo km jp kn jq ko jn kp kq kr ks bi translated">我们有月度数据，所以我们总共有 37 行，我们拥有的总数据是<strong class="is hj"> 3 年零 1 个月</strong>(<strong class="is hj">2004–01–01</strong>到<strong class="is hj">2007–01–01</strong>)。</li></ul><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/feb319f6d640ce10065669338672a636.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*7HdherruvnTMzBTbSCpkrQ.png"/></div></figure><ul class=""><li id="ceee" class="kk kl hi is b it iu ix iy jo km jp kn jq ko jn kp kq kr ks bi translated">绘制数据图以获得洞察力:从这张图中我们可以看到，数据中明显存在上升趋势和季节性。这两个术语在时间序列分析中非常重要，因此我们将了解它们的真正含义。</li></ul><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es la"><img src="../Images/1e688d9b70a96ac4a60f0491003fc29f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yXtJZYSrPolwo1TdmiVWXw.png"/></div></div></figure><blockquote class="im in io"><p id="6933" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">重要概念</strong></p></blockquote><ol class=""><li id="97db" class="kk kl hi is b it iu ix iy jo km jp kn jq ko jn lb kq kr ks bi translated"><strong class="is hj">趋势</strong>:<strong class="is hj">趋势</strong>表示<strong class="is hj">数据</strong>在<strong class="is hj">时间</strong>的一段长时间内增加或减少的总趋势。一个<strong class="is hj">趋势</strong>是一个平滑的、一般的、长期的、平均的趋势。在<strong class="is hj">时间</strong>的给定时间段内，增加或减少不一定总是在相同方向上。趋势的三种类型:1 .<strong class="is hj">向上</strong> 2。<strong class="is hj">向下</strong> 3。<strong class="is hj">水平/静止</strong></li><li id="03b0" class="kk kl hi is b it kt ix ku jo kv jp kw jq kx jn lb kq kr ks bi translated"><strong class="is hj">季节性</strong> : <strong class="is hj">季节性</strong>是<strong class="is hj">时间序列</strong>的一个特征，在该时间序列中，数据会经历每个日历年都会出现的有规律且可预测的变化。任何可预测的波动或模式，如果在一年内反复出现，就被称为季节性波动</li><li id="ee18" class="kk kl hi is b it kt ix ku jo kv jp kw jq kx jn lb kq kr ks bi translated"><strong class="is hj">平稳性</strong>:如果一个时间序列数据的统计特性如<strong class="is hj">均值、方差随时间保持不变</strong>，则称该时间序列数据是平稳的。大多数时间序列模型都假设数据是平稳的，因此<strong class="is hj">如果我们的数据是非平稳的，我们必须将其转换为平稳数据</strong>。将数据转换为静态数据的另一个好处是，与静态数据相关的理论更加成熟，也更容易实现。</li></ol><p id="a5b7" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">看上面的图，我们可以说我们的数据有明显的上升趋势，也有一些季节性。但是对于所有的数据集来说，这可能不是那么简单。因此，我们可以使用<strong class="is hj">季节性分解</strong>来确定我们的数据是否具有季节性、趋势性。</p><blockquote class="im in io"><p id="da7c" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">季节性分解</strong></p></blockquote><p id="db09" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">季节性分解将返回 4 样东西:</p><p id="42b1" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">1.<br/>观察到的(原始数据)2。<br/>趋势(大势)3。季节性数据<br/> 4。误差/残差(无法用季节性或季节性解释的数据)</p><p id="74dc" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">季节性分解有<strong class="is hj"> 2 个选项</strong>:</p><p id="89f2" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">1.可加性(当趋势更加线性时，季节性和趋势似乎是常数)<br/> 2。乘法(趋势更加非线性)</p><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/d72137b17a966c4db4c84317793438f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*5tsr1-qFPjPDbWQz0G1ZxQ.png"/></div></figure><p id="3da4" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">从这张图中我们可以看到，季节性分解清楚地告诉我们，数据中有一些<strong class="is hj">上升趋势</strong>和一些<strong class="is hj">季节性</strong>。</p><blockquote class="im in io"><p id="7518" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3。检查平稳性。</strong></p><p id="d7f7" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">迪基-富勒函数</strong>:检查数据是否稳定。</p></blockquote><p id="3827" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">如果<strong class="is hj"> p &lt; 0.5 </strong>:数据为<strong class="is hj">静止</strong>，<strong class="is hj"> p &gt; 0.5 </strong>:数据为<strong class="is hj">非静止。</strong></p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ld"><img src="../Images/4d3094be52a9fc8f9f8ad7c6d7e749c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*og37H3MhR9tn50-K7VIBzg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">使用 Dickey-Fuller 测试来检查平稳性的函数</figcaption></figure><p id="d777" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">因此，在用这个函数检查之后，我们得出结论:<strong class="is hj">数据是非平稳的</strong>。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es li"><img src="../Images/12aec34c5e62f060669d630ea70580f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*rrNYTG7hvDSOrNQHxc68Gw.png"/></div></figure><blockquote class="im in io"><p id="79a5" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 4。选择正确的型号并使数据稳定</strong></p></blockquote><p id="4fd2" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated"><strong class="is hj"> ARIMA </strong>:自回归综合移动平均线。</p><p id="4296" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated"><strong class="is hj"> ARIMA </strong>是预测的最佳模型之一，详情<a class="ae lj" href="https://www.investopedia.com/terms/a/autoregressive-integrated-moving-average-arima.asp" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><ul class=""><li id="a0f4" class="kk kl hi is b it iu ix iy jo km jp kn jq ko jn kp kq kr ks bi translated">为了有效地使用 ARIMA，我们需要理解数据中的<strong class="is hj">平稳性</strong>。</li><li id="4d37" class="kk kl hi is b it kt ix ku jo kv jp kw jq kx jn kp kq kr ks bi translated">如果我们已经确定数据不是平稳的，我们将需要使它平稳来预测它。<br/> -一个简单的方法是使用差分。</li><li id="ffb4" class="kk kl hi is b it kt ix ku jo kv jp kw jq kx jn kp kq kr ks bi translated">数据稳定后，我们需要选择<strong class="is hj"> p，d，q </strong>参数。(<strong class="is hj">p</strong>:AR 中的滞后数，<strong class="is hj"> d </strong>:差异度，<strong class="is hj">q</strong>:MA 模型的阶)</li></ul><p id="6fbf" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated"><strong class="is hj">我们可以在这里使用 auto_arima 函数找到 p，d，q 的最佳值</strong>。我们会的。</p><p id="cb22" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated"><strong class="is hj"> auto_arima(): </strong></p><pre class="js jt ju jv fd lk ll lm ln aw lo bi"><span id="7e92" class="lp lq hi ll b fi lr ls l lt lu">Automatically discover the optimal order for an ARIMA model.<br/><br/>The auto-ARIMA process seeks to identify the most optimal<br/>parameters for an `ARIMA` model</span></pre><p id="3aad" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">所以从<strong class="is hj"> auto_arima()，</strong>我们得到了最佳参数为:<strong class="is hj"> p=1，d=1，q=1 </strong></p><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/71c53c7f0f54cc86e4db6201f7eb8cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*z56bi4-1dYDueMAad39hVQ.png"/></div><figcaption class="le lf et er es lg lh bd b be z dx translated">auto_arima()的输出</figcaption></figure><p id="d38a" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在，我们真的不需要对数据求微分来使它稳定，将 d=1 传递给 ARIMA 将为我们把它微分 1。</p><blockquote class="im in io"><p id="2bce" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 5。建立 ARIMA 模型，并根据测试数据进行预测。</strong></p></blockquote><ul class=""><li id="851d" class="kk kl hi is b it iu ix iy jo km jp kn jq ko jn kp kq kr ks bi translated">在 ARIMA()中，我们传递了 order=(p，d，q)，我们传递了 p，d，q，它们是 0，1，1</li></ul><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es lw"><img src="../Images/79a31a0ab4115d4c136933920fc81584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LVetZM0zbZ6r0-H8HrhLvw.png"/></div></div></figure><blockquote class="im in io"><p id="66e0" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 6。绘制预测图并评估结果。</strong></p></blockquote><p id="c184" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">这是我们得到的结果，考虑到我们使用了一个简单的 ARIMA 模型，并且我们的训练数据很小，输出/RMSE 得分还不错。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es lx"><img src="../Images/687cdf6c8e7b3b7e2d62bb89fa9fb4f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P1xrCaJPZVDW19qUJGgCEA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">绘制预测数据和原始数据。</figcaption></figure><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/0b8455dec848d7e74c91f15447e593a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*w-HGn-dJMGOMbJYtOQla7w.png"/></div><figcaption class="le lf et er es lg lh bd b be z dx translated">RMSE 为榜样。</figcaption></figure><blockquote class="im in io"><p id="61ef" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 7。预测未来数据。</strong></p></blockquote><p id="65d6" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们现在将对全部数据(3 年)进行训练，并对未来 1 年进行预测。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es lz"><img src="../Images/ebb4d56b2ef0d548611b404efacfe633.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XcbtpxhiENCUAjGNZI5EOQ.png"/></div></div></figure><p id="9ef7" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">这是入门，只是为了用一个简单的 ARIMA 模型感受一下时间序列预测，我会举更多的例子，我们使用更复杂的模型，如 SARIMA，SARIMAX，也使用多个列进行预测。</p><p id="c41c" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">感谢阅读:)</p></div></div>    
</body>
</html>