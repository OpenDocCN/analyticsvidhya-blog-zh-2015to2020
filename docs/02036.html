<html>
<head>
<title>Behind the Scenes: Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">幕后:线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/behind-the-scenes-linear-regression-81836eb9ab6?source=collection_archive---------29-----------------------#2019-11-26">https://medium.com/analytics-vidhya/behind-the-scenes-linear-regression-81836eb9ab6?source=collection_archive---------29-----------------------#2019-11-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1bba3073456b0820765370147fe2d1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gKaoPf7qQsmmCZxP"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae iu" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Carlos Muza </a>拍摄的照片</figcaption></figure><h1 id="6592" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">真实现象</h1><p id="9d1b" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在任何预测中，我们试图做的是模拟一个我们只能观察的真实现象。我们不知道确切的机制</p><p id="1646" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">假设我们有一个<em class="kw">真</em>现象y = 100*x1 + 200*x2</p><p id="2ca1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">其中x1 &gt;= 2000且&lt;= 4000 and x2 &gt; = 100且&lt;= 500</p><p id="52be" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">Lets generate some data</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="4fae" class="lg iw hi lc b fi lh li l lj lk">x1range &lt;- as.numeric(2000:4000)<br/> x2range &lt;- as.numeric(100:500)<br/> <br/> #generate 5000 data points<br/> num &lt;- 5000<br/> x1 &lt;- sample(x1range , num , replace= TRUE)<br/> x2 &lt;- sample(x2range , num , replace= TRUE)<br/> ytrue &lt;- 100*x1 +200*x2 <br/> <br/> head(x1)</span><span id="7741" class="lg iw hi lc b fi ll li l lj lk">## [1] 2644 3743 2620 2256 3008 2902</span><span id="fd04" class="lg iw hi lc b fi ll li l lj lk">head(x2)</span><span id="c73b" class="lg iw hi lc b fi ll li l lj lk">## [1] 277 425 223 457 321 336</span><span id="7f58" class="lg iw hi lc b fi ll li l lj lk">head(ytrue)</span><span id="9b1a" class="lg iw hi lc b fi ll li l lj lk">## [1] 319800 459300 306600 317000 365000 357400</span></pre><h1 id="2e2e" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">Errors</h1><p id="0a46" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">It is very difficult to find the true phenomenon because all observations have error.</p><p id="4982" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">YObs = YTrue + Error</p><p id="58a7" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">YTrue = YObs — Error</p><p id="ac97" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">To know anything about YTrue we have to know about YObs and Error distribution. Yobs is the observed data so we have that already. therefore now we need to make some assumptions about the error distribution to be able to even begin to guess YTrue.</p><p id="7e4b" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">Errors usually have the following properties 1. Centered on 0. Mean error is 0. 2. Equally likely to be above or below the mean. Symmetric about the mean. 3. Chance of having an infinite error is almost zero. Therefore as x -&gt; inf prob(x) -&gt; 0。</p><p id="f060" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">许多不同的分布可以用来满足这个条件。拉普拉斯使用三角形误差分布来满足上述各点。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="00dc" class="lg iw hi lc b fi lh li l lj lk">library(ggplot2)<br/> exampleTri &lt;- data.frame( x= c(-5,0,5) ,y= c(0,5,0) )<br/> ggplot(data= exampleTri , aes(x , y)) + geom_line()</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/802b84cdf89bd04680e643ea7b660b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*9gX_5dam5BJdQrWvHvSj0g.png"/></div></figure><p id="e58f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">正态分布</strong>是另一个符合上述标准的分布</p><p id="efed" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以做出的一个假设是，我们观察到的<em class="kw"> y的</em>的误差呈正态分布。这个假设来自<strong class="jv hj">中心极限定理(CLT) </strong>。</p><p id="b39f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">对于我们的例子，我们也为误差分布的标准偏差选择一个随机值，10。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="2d92" class="lg iw hi lc b fi lh li l lj lk"># generate random error values from normal distribution<br/> etrue &lt;- rnorm(num , mean=0, sd=10)<br/> <br/> x1obs &lt;- x1<br/> x2obs &lt;- x2<br/> <br/> # add errors to ytrue<br/> yobs = ytrue + etrue<br/> <br/> <br/> # create a dataframe that will be our ‘observed’ data<br/> dfobs &lt;- data.frame(x1obs,x2obs,yobs)<br/> head(dfobs)</span><span id="8136" class="lg iw hi lc b fi ll li l lj lk">## x1obs x2obs yobs<br/> ## 1 2644 277 319798.2<br/> ## 2 3743 425 459299.3<br/> ## 3 2620 223 306590.7<br/> ## 4 2256 457 316997.2<br/> ## 5 3008 321 364999.8<br/> ## 6 2902 336 357393.5</span></pre><p id="0bee" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><em class="kw"> dfobs </em>现在形成了我们观察到的数据集，我们将尝试从中估计y的真实值。</p><h1 id="f5a7" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">大量样本和系数的抽样分布</h1><p id="1dd5" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">CLT告诉我们的是，如果我们重复实验很多次，那么我们为每个样本计算的样本统计量本身就是正态分布的。在我们的情况下，这将适用于系数估计。</p><h1 id="edd9" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">对系数的CLT进行经验验证</h1><p id="6e51" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">为了验证CLT告诉我们的，我们将这样做</p><p id="ac6c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">1.从我们观察到的数据中抽取一个样本</p><p id="efc9" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">2.执行线性回归</p><p id="d9e1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">3.得到系数，然后从1开始重复。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="40f2" class="lg iw hi lc b fi lh li l lj lk">#initialize coefficient result as 0<br/> coffs &lt;- c(0,0,0)<br/> <br/> # do our experiment 10,000 times<br/> expnum &lt;- 10000<br/> <br/> # each time we repeat our experiment take a sample of size 10 from the observed data<br/> numObsInSample &lt;- 10<br/> <br/> for(i in seq(0,expnum,1)){<br/> <br/> # take sample<br/> sampIndices &lt;- sample(nrow(dfobs),numObsInSample)<br/> samp &lt;- dfobs[sampIndices,]<br/> <br/> # perform linear regression<br/> lm &lt;- glm( yobs ~ x1obs + x2obs , data = samp )<br/> cf &lt;- coef(lm)<br/> <br/> # save coeffients for later analysis in the coffs variable<br/> coffs &lt;- c(coffs , cf)<br/> }<br/> <br/> # convert our results into a matrix with 3 cols<br/> matcoffs &lt;- matrix(coffs, byrow = TRUE ,ncol=3)<br/> head(matcoffs)</span><span id="7f59" class="lg iw hi lc b fi ll li l lj lk">## [,1] [,2] [,3]<br/> ## [1,] 0.000000 0.00000 0.0000<br/> ## [2,] -1.262689 100.00116 199.9726<br/> ## [3,] 3.376745 99.99244 200.0463<br/> ## [4,] 6.812219 99.99737 200.0031<br/> ## [5,] -9.508069 100.00255 200.0046<br/> ## [6,] 2.779624 99.99692 200.0182</span><span id="b1da" class="lg iw hi lc b fi ll li l lj lk">We can see that the coeffients of x1 and x2 are pretty close to our actual true phenomenon in most of our experiments!</span><span id="9c24" class="lg iw hi lc b fi ll li l lj lk">YTrue = 100<em class="kw">x1 + 200</em>x2</span><span id="73b1" class="lg iw hi lc b fi ll li l lj lk">Now according to CLT these coefficients should be normally distributed. Let’s verify.</span><span id="6609" class="lg iw hi lc b fi ll li l lj lk">Let’s check basic descriptive stats about these first</span><span id="2a85" class="lg iw hi lc b fi ll li l lj lk">summary(matcoffs)</span><span id="cddf" class="lg iw hi lc b fi ll li l lj lk">## V1 V2 V3 <br/> ## Min. :-105.995 Min. : 0.00 Min. : 0.0 <br/> ## 1st Qu.: -12.307 1st Qu.:100.00 1st Qu.:200.0 <br/> ## Median : 2.118 Median :100.00 Median :200.0 <br/> ## Mean : 1.616 Mean : 99.99 Mean :200.0 <br/> ## 3rd Qu.: 15.668 3rd Qu.:100.00 3rd Qu.:200.0 <br/> ## Max. : 104.031 Max. :100.03 Max. :200.2</span><span id="d584" class="lg iw hi lc b fi ll li l lj lk">sd(matcoffs[,2])</span><span id="0aeb" class="lg iw hi lc b fi ll li l lj lk">## [1] 0.9999169</span><span id="5ec2" class="lg iw hi lc b fi ll li l lj lk">sd(matcoffs[,3])</span><span id="7c80" class="lg iw hi lc b fi ll li l lj lk">## [1] 2.000062</span></pre><p id="d54d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">看起来V2和V3总是分别在100和200左右。但这是误导。我们需要提高精确度并再次检查。我们将尝试在系数为x1的99.95和100.1的非常小的空间内绘制直方图。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/2b4474c78de13c6e8ee86eab140f3283.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*s01w8D-1VZD3RvAi5KM0fw.png"/></div></figure><p id="6bbb" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">哇！看起来像正态分布！所以我们可以看到B系数本身是正态分布的。</p><h1 id="0591" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">是我的“贝塔”,他们告诉我他们是什么？</h1><p id="e4b9" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">通常我们无法重复实验10，000次，所以我们不知道B系数的分布。我们现在可以安全地假设(基于上面的分析)它是正态分布的。但现在的问题是，我们从样本中得到一组B系数，我们有多大把握不是偶然得到这些系数的？可能这些系数实际上是0，x1和x2对y没有影响，因为这个样本，我们可能偶然发现了这些值。如果我们再取一个样本，发现这些其实是零呢？！我们希望对这些抛给我们的数字有一定程度的信心。</p><h1 id="dc26" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">假设检验</h1><p id="83d5" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">如果我们的自变量——x1，x2对Y没有影响，那么它们的系数应该为零</p><p id="3526" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">Y = 0*x1 + 0*x2</p><p id="723d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">但是我们坚信x1和x2确实对Y有影响，并且想要证明这一点。</p><p id="d3a0" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">因此，我们作出这些系数为0的无效假设，并试图拒绝我们的假设。</p><p id="4c47" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">对于这种情况，使用T检验。 [T-dist] T分布在我们不知道分布的详细信息时用作正态分布的近似值。为了得到整个分布，t分布所需要的只是自由度。这与正态分布不同，正态分布需要我们指定均值和标准差，而这两者我们都没有(因为我们没有为此进行10，000次或100万次实验)。</p><p id="aab9" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">对我们有利的t分布存在，现在这里的权衡是准确性。显然，我们是在近似正态分布，所以我们的估计会有误差。但这对于我们的目的来说已经足够了——对我们对B系数的估计充满信心。但是这将在另一篇文章中讨论。但是基本的想法如下。</p><h1 id="8666" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">估计分布的标准偏差</h1><p id="843f" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">现在摆在我们面前的问题是，我们不知道这个B分布的标准差。</p><p id="8d32" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">为了使术语正确，我们不知道B分布平均值的标准误差<a class="ae iu" href="https://en.wikipedia.org/wiki/Standard_error" rel="noopener ugc nofollow" target="_blank">维基百科</a>。要做的两件事是</p><ol class=""><li id="73fa" class="ln lo hi jv b jw kr ka ks ke lp ki lq km lr kq ls lt lu lv bi translated">使用自举来获得系数估计</li></ol><p id="0cf7" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">Bootstrapping类似于我们上面所做的重复抽样，但这次抽样不是从总体而是从样本本身！！</p><p id="f773" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">Bootstrapping帮助我们估计抽样分布的标准误差。因此，我们将得到我们的“标准差”,然后开始对我们的系数估计感到有信心。</p><ol class=""><li id="8f90" class="ln lo hi jv b jw kr ka ks ke lp ki lq km lr kq ls lt lu lv bi translated">使用T检验</li></ol><p id="0751" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">得到标准误差后，我们就可以计算T统计量并进行T检验，以确定系数在统计上是否显著不同于零。</p><p id="809b" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">最后两个主题将在另一篇文章中详细讨论！</p><h1 id="5c1b" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">来源</h1><p id="e37f" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><a class="ae iu" href="https://stattrek.com/probability-distributions/t-distribution.aspx" rel="noopener ugc nofollow" target="_blank"> T-dist </a></p></div></div>    
</body>
</html>