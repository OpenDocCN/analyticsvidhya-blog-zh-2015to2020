<html>
<head>
<title>Maths and Maths and…</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数学和数学和…</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/maths-and-maths-and-27802d170a9b?source=collection_archive---------19-----------------------#2019-10-31">https://medium.com/analytics-vidhya/maths-and-maths-and-27802d170a9b?source=collection_archive---------19-----------------------#2019-10-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cd35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，通过我以前的文章，你非常了解我的愿望:)正如我所承诺的，我会回来帮助有类似愿望的人。</p><p id="522f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要认为我的标题不完整，因为在机器学习的旅程中，数学传奇永远不会结束。:)</p><p id="480a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您以前没有安装过，请访问下面的链接，这样我们就能在同一页上了:)。</p><p id="ce33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" rel="noopener" href="/@nirmal.maheshwari/a-common-aspiring-data-scientist-93dca12d2298">https://medium . com/@ nirmal . maheshwari/a-common-aspirating-data-scientist-93 DCA 12d 2298</a></p><p id="507a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们深入研究线性和逻辑回归模型的<strong class="ih hj">数学</strong>，如果你在学生时代不熟悉或不喜欢数学，这将是任何模型中最重要和最难理解的部分。舒服地坐好，因为这将会是一篇很长的阅读。</p><h1 id="90b9" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">数学方程式</strong></h1><h2 id="73fe" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated">线性回归</h2><p id="a996" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">Y = β0+β1X1+β2X2+…+βnXn</p><p id="65b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个模型的意义在于，人们可以很容易地解释和理解边际变化及其后果。例如，如果xi的值增加1个单位，保持其他变量不变，y值的总增量将为βi。从数学上讲，截距项(0)是所有预测项设置为零或不考虑时的响应。</p><h2 id="0437" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated"><strong class="ak">逻辑回归</strong></h2><p id="6f82" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这里使用的函数是Sigmoid函数。</p><p id="0d95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归是一个概率分类器，Sigmoid函数返回我们试图预测的类的概率，这也称为逻辑函数。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es kv"><img src="../Images/a3d6b3e3830a1e86b8519f162bdf5c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*a4yfM5eqZ6-yR5rKR_r9mA.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">逻辑函数</figcaption></figure><p id="e900" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要担心，我们将在一段时间内以更易于解释的形式带来上面的等式。</p><h1 id="6c92" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">最佳拟合线</strong></h1><p id="4892" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">通过最小化RSS(残差平方和)的表达式找到最佳拟合线，RSS等于图中每个数据点的残差平方和。从因变量的实际值中减去因变量的预测值，即可得到任何数据点的残差:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lh"><img src="../Images/2b4808c135884270d454069f6554410b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xl7Stf8-Bzm-YxryQl8aqQ.jpeg"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">残差</figcaption></figure><h1 id="a4d0" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">最佳拟合s形曲线</h1><p id="da5e" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">现在，似然函数的概念出现在寻找最佳查找曲线的画面中。这里最适合的是当我们试图最大化点的概率的乘法时。</p><p id="8c6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们考虑一个例子，我们需要发现一个人是否有糖尿病。所以让P1、P2、P3、P4、P6的人没有糖尿病，P5、P7、P8、P9、P10有糖尿病。</p><p id="ced2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是上面例子的似然函数</p><p id="8f00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(1 P1)(1 P2)(1 P3)(1 P4)(1 P6)(P5)(P7)(P8)(P9)(P10)</p><p id="eeb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，它是概率的乘积，取决于人的类别，对于非糖尿病人来说，可能性是1-P，对于糖尿病人来说，可能性是P，因此，为了找到最佳曲线，我们试图最大化这个可能性函数。这也被称为最大似然估计(<strong class="ih hj"> MLE </strong>)</p><p id="1b91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MLE选择那些使似然函数最大化的未知参数组(估计量)。寻找最大似然估计的方法是使用微积分，将逻辑函数对未知参数的导数设置为零，求解它将得到最大似然估计。对于二项式模型，这很容易，但是对于逻辑模型，计算就复杂了。计算机程序用于推导逻辑模型的最大似然估计。<br/>(这是回答这个问题的另一种方法。)<br/> MLE是一种估计数学模型参数的统计方法。如果因变量假设为正态分布，MLE和普通平方估计对于线性回归给出相同的结果。最大似然法没有对独立变量做任何假设。</p><h1 id="0c07" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">赔率和<strong class="ak">对数赔率</strong></h1><p id="84af" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">虽然上面我们已经为逻辑回归定义了方程，但是，这不是很直观。换句话说，P和x的关系如此复杂，以至于很难理解两者之间存在什么样的趋势。如果你以固定的间隔增加x，比如说11.5，那会如何影响概率？会不会也按某个规律的间隔增加？如果没有，会怎么样？</p><p id="c0fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们提出了一个新的方程，它是从sigmoid曲线方程推导出来的。</p><p id="73de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Logistic模型= α+β1X1+β2X2+…。+βkXk</p><p id="4e32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述模型给出的结果为logits，也称为对数概率。</p><p id="5847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">赔率通常被定义为事件发生的概率与事件不发生的概率之比，当我们对等式两边取对数时，它就变成了对数赔率。</p><p id="af8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Alpha是逻辑回归模型中的基线。它是当所有属性(X1，X2，…，…)都满足时实例的对数概率。Xk)是零。在实际场景中，所有属性为零的概率非常低。在另一种解释中，α是当不考虑任何属性时实例的对数概率。</p><p id="54d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">β是在保持所有其他属性固定或不变(控制变量)的情况下，特定属性单位变化的对数优势变化值。这就是我们如何解释逻辑回归模型的结果。</p><h1 id="0a3b" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">成本函数</strong></h1><h2 id="fb97" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated"><strong class="ak">线性回归</strong></h2><p id="32e6" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">均方误差被用作线性回归的成本函数。我们使用梯度下降来最小化成本函数，但我们将在优化部分讨论。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es lm"><img src="../Images/ce5b4dfce1d32ba8a9e7559a0ad967ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*xS722AWRpo1OK-wR4GDEeQ.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">多元线性回归成本函数</figcaption></figure><h2 id="c7d0" class="kc jf hi bd jg kd ke kf jk kg kh ki jo iq kj kk js iu kl km jw iy kn ko ka kp bi translated"><strong class="ak">逻辑回归</strong></h2><p id="29e5" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">在逻辑回归中，我们使用sigmoid函数并执行非线性转换来获得概率。平方这个非线性变换将导致具有局部最小值的非凸性。在这种情况下，使用梯度下降找到全局最小值是不可能的。由于这个原因，MSE不适合逻辑回归。交叉熵或对数损失用作逻辑回归的成本函数。在逻辑回归的成本函数中，有把握的错误预测会受到严重惩罚。自信的正确预测得到的回报更少。通过优化这个成本函数，实现了收敛。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es ln"><img src="../Images/c6e9feeb03633c18a3ab7e672fff99a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*YwnzENGDnjB4LbMC2Tn54Q.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">对数损失/二元交叉熵</figcaption></figure><p id="75ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中<strong class="ih hj"> y </strong>为<strong class="ih hj">标号</strong> ( <strong class="ih hj"> 1 </strong> <strong class="ih hj">糖尿病患者</strong>和<strong class="ih hj"> 0 </strong> <strong class="ih hj">为</strong> <strong class="ih hj">非糖尿病患者</strong>),<strong class="ih hj">p(y)</strong>为所有<strong class="ih hj"> N </strong>点的预测<strong class="ih hj">为糖尿病的概率</strong>。</p><p id="dc76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看这个公式，它告诉你，每增加一个<strong class="ih hj">绿色</strong>点(<em class="lo"> y=1 </em>，它就把<em class="lo"> log(p(y)) </em>加到损失上，也就是<strong class="ih hj"> log患糖尿病的概率</strong>。反之，它加上<em class="lo"> log(1-p(y)) </em>，即<strong class="ih hj">非糖尿病概率的对数</strong> ( <em class="lo"> y=0 </em>)</p><h1 id="b645" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">在逻辑回归模型的情况下，决策边界是线性的还是非线性的？</h1><p id="8552" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">决策边界是一条将目标变量分成不同类别的线。决策边界可以是线性的，也可以是非线性的。在逻辑回归模型的情况下，决策边界是一条直线。</p><p id="7339" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Logistic回归模型公式= α+1X1+2X2+…。+kXk。这清楚地代表了一条直线。逻辑回归只适用于直线能够区分不同类别的情况。如果直线不能做到这一点，那么非线性算法应该用来达到更好的效果。</p><h1 id="a77e" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">一个线性回归的残差之和接近什么值？证明。</strong></h1><p id="d3ed" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">线性回归的残差之和为0。线性回归假设误差(残差)正态分布，平均值为0，即</p><p id="2558" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Y=βX+ε</p><p id="e1a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，Y是目标或因变量，是回归系数的向量，</p><p id="e571" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">x是包含作为列的所有特征的特征矩阵，</p><p id="b89e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ε是剩余项，使得ε∞N(0，σ2)。</p><p id="efb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，所有残差的总和就是残差的期望值乘以数据点的总数。因为残差的期望值是0，所以所有残差项的和是0。</p><p id="83f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注</strong> : N(0，σ2)是具有均值μ和标准差σ2的正态分布的标准符号。</p><p id="d141" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这两个模型中仍然有很多东西，不要着急，但我们肯定会在用Python或R创建模型的过程中，或者在验证/解释或优化过程中，研究p值、VIF、AIC、BIC、Rsquare等东西。</p><p id="b3b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在那之前，请不要挂断，并在评论区给你的意见，以便我改进一些东西，或者如果你想让我在问题中包括一些东西。</p><p id="fc34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要忘记，这必须是一个有抱负的数据科学家的准备问题库。:)</p></div></div>    
</body>
</html>