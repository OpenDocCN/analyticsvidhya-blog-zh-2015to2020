<html>
<head>
<title>Automate GUI Clicks and Save Screenshots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化GUI点击并保存屏幕截图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automate-gui-clicks-and-save-screenshots-fcbc9d52a08c?source=collection_archive---------5-----------------------#2019-10-21">https://medium.com/analytics-vidhya/automate-gui-clicks-and-save-screenshots-fcbc9d52a08c?source=collection_archive---------5-----------------------#2019-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/7be90bd50e5e9b89a5a2a3b269fb4309.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*r7is1sG9CLxLiDFE42rujg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">机器人为您服务</figcaption></figure><p id="1512" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">想象一下，你有一项繁重的任务，要浏览网站(技术网站、社交媒体，如脸书、Instagram、twitter等)上的数百张图片..)然后，您必须使用windows PrntScreen(然后粘贴到paint并以某个名称保存)方法手动保存每个图像或图像的一部分。它会很快变得令人沮丧和枯竭。还有一种情况是，当您想要滚动浏览某些程序表单/页面/屏幕，然后以屏幕截图的形式保存每个表单/页面/屏幕的内容。手动完成这项工作也非常累人。</p><p id="cd53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是<strong class="is hj">“Python GUI自动化”</strong>包来拯救的地方。只需打开您的命令提示符，首先使用pip安装<strong class="is hj"> pyautogui </strong>包。(假设您的系统上已经安装了python)</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b411" class="jx jy hi jt b fi jz ka l kb kc">pip install pyautogui</span></pre><p id="f003" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦安装了这个包，你就可以创建非常强大的GUI自动化脚本。我将从我自己最近的例子开始，我在一个结构工程软件上工作，想要一些结果输出的部分作为单独的图像文件。</p><p id="b2f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将整个过程分为两个主要部分，即在第一部分，我需要设置我想要捕捉的屏幕限制和我需要保存多少截图。在第二部分中，我将展示实现这一目标的实际python代码。</p><ol class=""><li id="895f" class="kd ke hi is b it iu ix iy jb kf jf kg jj kh jn ki kj kk kl bi translated"><strong class="is hj">设置屏幕限制和目标</strong></li></ol><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es km"><img src="../Images/1ccc7800cb6241076c26b2fb1d379b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99UGZNJmLqR3xPxCVs3VvQ.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">软件输出屏幕—力矩图(可以是任何东西..)</figcaption></figure><p id="fc2e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的图像中，我只想捕捉显示结果的屏幕区域，即带有黄色图表的黑色部分。这可能是你的情况，你可以相应地设置目标。上述特殊结果是针对一种载荷组合的。为了获得所有载荷组合的截图，我需要按下屏幕右下角的箭头按钮，结果将在屏幕中央更新。正是这种按下按钮，并采取屏幕截图的特定部分是我想自动化。</p><p id="298b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我需要得到屏幕的准确坐标。为此，你可以在网上使用任何免费的工具，或者如果你够极客的话，你可以自己建一个简单的工具。我在这里网上下载了一个免费的程序:<a class="ae kr" href="https://www.adminsehow.com/2012/03/realtime-mouse-position-monitor-tool/" rel="noopener ugc nofollow" target="_blank">https://www . adminsehow . com/2012/03/real time-mouse-position-monitor-tool/</a></p><p id="2b58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以在第一部分，当我想第一次运行脚本时，我需要为我的程序激活窗口，从那里我想抓取屏幕截图。接下来，我需要采取一个屏幕截图只为特定部分的屏幕。然后我想用一个有用的名字保存这个截图，最后我必须<strong class="is hj">在我的程序中点击</strong>下一步按钮(使用上面的工具在预定的位置)。</p><p id="fda4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这整个过程应该发生在一个定时的方式，所以我需要Python的时间库。这将照顾到最初的滞后以及输出屏幕更新所需的时间，这样我就不会得到混乱的结果。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/c23d0c5ddef80de6524281abbfd93f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*mNyn-ar3phXz2xjUN1k9gg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">下一步按钮的鼠标位置(1208，714)</figcaption></figure><p id="98ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如上所示，下一个按钮位于坐标1208、714处。这大约是按钮的中心。只要鼠标停留在按钮的可点击部分，1210、715就可以了。</p><p id="2c5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2。Python自动化代码</strong></p><p id="afe9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是实际的代码(我故意粘贴为图像，以便您手动输入；总是手写代码而不是复制粘贴是一个很好的学习习惯，因为打字可以增强学习体验。我将一步一步地解释代码。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/aaaca0ae266c16153c55fb6022200999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nog_wYOim8lTSx60lNL5pw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">屏幕截图和GUI点击自动化代码</figcaption></figure><p id="2398" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我正在导入<strong class="is hj"> pyautogui </strong>(确保它已安装)<strong class="is hj"> time </strong>以及<strong class="is hj"> winsound </strong> python库。在认为合适的地方暂停代码执行需要时间。当代码执行停止时，Winsound会发出蜂鸣声。</p><p id="7646" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> pyautogui.click(940，740) </strong>会激活我们要截图的窗口。这将随着您在窗口栏中打开和关闭选项卡而变化。我使用了一个“try-catch”块，以便<strong class="is hj">捕捉</strong>任何异常，并且不会突然结束程序。</p><p id="d429" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> im=pyautogui .截图(region=(375，0，1145，700)) </strong></p><p id="7aa7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有的魔法都发生在上面的语句中，因为这是捕获活动屏幕的代码部分。前两个参数是从屏幕左上角开始的x和y坐标。接下来的两个参数是图像的大小。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/b17eab3e05f8cca99c11d5e7a72e58c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/0*fXNj4yrkTXHRoGS9.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">屏幕的x和Y轴</figcaption></figure><p id="b8d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们需要以一种合乎逻辑的方式保存我们得到的图像文件。如果你正在拍摄一些漂亮的猫咪照片，给它们连续命名为“cat-”+str(I)是有意义的，这样它们就可以保存为“cat-1”、“cat-2”等..</p><p id="10f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来引入休眠，以确保图像被正确保存并写入磁盘，程序为下一步做好准备。接下来，我们通过<strong class="is hj"> pyautogui.click(1210，715)单击一个预定义的位置。</strong>然后我们需要一个小的停顿来确保屏幕更新了最新的结果。</p><p id="b3f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最终蜂鸣器用于标志程序执行的结束。这是非常有用的，如果你有100或1000的图像处理，并为一个新的程序运行，你需要改变一些参数。你可能想知道第一次运行什么时候结束，这样你就可以回到电脑前(是的，只要机器人循环运行并生成截图文件，你就不能做任何其他事情)。不要害怕，如果在IDE中运行，您可以随时通过<strong class="is hj"> Ctrl + C </strong>来结束程序。</p><p id="4aec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是一张漂亮的<strong class="is hj"> gif </strong>展示了整个过程(4个循环)。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kv"><img src="../Images/e84f5ff2ed10ce1d171c8cfa11e4ccbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*84U-vEo6h_Lvhfmhzp1w9w.gif"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">截图，保存并点击下一步</figcaption></figure><p id="7d2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">截图将按照程序中提供的命名约定保存在您的工作目录中。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/d2087e1dbb1995de67d3554d4cce40e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*kVYF4nLLxsNi_Z2VG7UkSw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">保存为单独文件的屏幕截图</figcaption></figure><p id="67d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">欢迎任何意见/建议。</p><p id="c3fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kx">谢谢</em></p></div></div>    
</body>
</html>