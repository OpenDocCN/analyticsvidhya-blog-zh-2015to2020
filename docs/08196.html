<html>
<head>
<title>Azure MLOps: Doing DevOps one better</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure MLOps:将DevOps做得更好</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/azure-mlops-doing-devops-one-better-2557a58d20a3?source=collection_archive---------27-----------------------#2020-07-20">https://medium.com/analytics-vidhya/azure-mlops-doing-devops-one-better-2557a58d20a3?source=collection_archive---------27-----------------------#2020-07-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="96da" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak"> MLOps？那是什么？</strong></h1><p id="0500" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">MLOps是DevOps的一切，加上它负责ML模型训练以及数据集和模型管理的部分。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/5a7c4916cf7a858f26de94c5513bc108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhdPlO5EkyndEvZbm8_wjA.jpeg"/></div></div></figure><p id="ea00" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">不到几周前，我刚刚瞄准并训练了一个我一直在做的项目所需的模型。该模型按照要求和预期工作，是时候部署利用该模型的应用程序了。我像往常一样使用Azure DevOps，对应用程序的源代码进行版本控制，并对其进行打包和部署。但是像其他时候一样，我想知道，</p><blockquote class="ks"><p id="4042" class="kt ku hi bd kv kw kx ky kz la lb ka dx translated">当客户提供新数据并且需要重新培训时，我该怎么办？我是否需要手动重新训练模型，并繁琐地维护其版本和数据集？如果我将模型训练和版本化过程自动化，并将其添加到我当前的DevOps过程中，会怎么样？</p></blockquote><p id="d7a7" class="pw-post-body-paragraph jd je hi jf b jg lc ji jj jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka hb bi translated">这一次，根据我的想法，我开始寻找解决办法。由于我已经在Azure平台上工作，我很快就发现了他们的MLOps解决方案。</p><h1 id="4eaf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">我想做什么？</strong></h1><p id="2e4a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">建立一个管道，该管道:</p><ul class=""><li id="d9fa" class="lh li hi jf b jg kn jk ko jo lj js lk jw ll ka lm ln lo lp bi translated">为模型训练准备我的数据</li><li id="ecdf" class="lh li hi jf b jg lq jk lr jo ls js lt jw lu ka lm ln lo lp bi translated">将准备好的数据保存为版本化数据集</li><li id="1ab7" class="lh li hi jf b jg lq jk lr jo ls js lt jw lu ka lm ln lo lp bi translated">训练模型</li><li id="72b9" class="lh li hi jf b jg lq jk lr jo ls js lt jw lu ka lm ln lo lp bi translated">维护模型的版本</li></ul><h1 id="ba75" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">我是怎么做到的？</h1><p id="d3d2" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我使用了用于Python的Azure机器学习SDK，并编写了一个创建MLOps管道的脚本。管道处理了我想从这个解决方案中得到的一切，并且可以通过Azure的ML web门户上的UI、REST端点等来触发。</p><h1 id="4027" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">脚本配方</h1><p id="e9ad" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">创建MLOps管道的脚本大致包括以下内容:</p><h2 id="ac29" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">正在创建工作区对象</h2><p id="d359" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我创建了一个workspace对象，用于访问与Azure订阅中的工作区相关的所有资源。它需要有关您的工作空间和订阅的信息，以及授予访问权限的凭据。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h2 id="ec2b" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">分配计算集群</h2><p id="1ca5" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了运行流水线的步骤，需要有一台机器可以执行这些步骤。该机器以集群的形式获得，可以根据需要从0扩展到n个节点。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h2 id="da27" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">管线参数和管线数据</h2><p id="d155" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">当触发流水线时，可以指定某些参数值。它们被称为管道参数，就像编程语言中的函数参数一样工作。<br/>在管道的2个步骤将不同的集群作为其计算目标的情况下，它们之间的数据共享是通过管道数据完成的。这是因为不同的集群无法访问彼此的本地存储，因此需要一个公共存储点来共享数据。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h2 id="c266" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">属国</h2><p id="c8ad" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了在计算目标上执行某个步骤，可能需要在该目标上安装某些依赖项。这些依赖关系需要预先定义。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h2 id="e6ce" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">数据准备步骤</h2><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="b874" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">这一步将在计算目标上运行makedata.py。<br/>在该脚本中，所有处理后的最终数据可以注册和版本化如下:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h2 id="47db" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">训练步骤</h2><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="9b5d" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">使用EstimatorStep在计算目标上执行train.py。这不是唯一的方法，脚本可以用不同的方式执行。该文件将包含与模型训练和评估相关的代码，使用先前注册的数据集。您可以将注册数据集的工件下载到计算目标的本地存储中。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="12e3" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">在此步骤中，我们还使用了之前定义的管道数据“training_step_output”，它基本上是一个路径，用于存储输出并与不同的管道步骤共享。</p><h2 id="cd4c" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">模型注册步骤</h2><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="1f0b" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">register.py在不同的计算目标上执行，并且使用存储训练输出的管道数据“training_step_output”。register.py应该是这样的:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h2 id="7bf0" class="lv ig hi bd ih lw lx ly il lz ma mb ip jo mc md it js me mf ix jw mg mh jb mi bi translated">管道发布</h2><p id="b4c1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">最后，我们为管道建立先前定义的步骤序列，并对其进行验证(检查管道数据的循环依赖性等。)并发表。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h1 id="58e3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">大结局</h1><p id="753b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">一旦发布，您可以通过访问您在<a class="ae ml" href="https://ml.azure.com/" rel="noopener ugc nofollow" target="_blank">https://ml.azure.com</a>的工作区来查看您的管道。<br/>作为参考，我的管道最终看起来像这样。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mm"><img src="../Images/bb2e6e5c99bff7d750663a9ba2e9e9ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*o3OnjaiOtlc75XD_LNnAnA.png"/></div></figure><p id="797e" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">您可以从UI提交管道运行。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mn"><img src="../Images/d0a0d5da30f8d4ecbda1704e4276a933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRnmWwNVt9rzHEcvvefeVg.png"/></div></div></figure><p id="691a" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">或者使用REST端点。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mo"><img src="../Images/abd829e88c07be162d3f8bb97e722bc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*9ECs92JLEEG8uTOJiXOvNQ.png"/></div></figure><p id="68c1" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">最后但同样重要的是，通过Azure Machine Learning SDK for Python使用workspace对象。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mj mk l"/></div></figure><h1 id="c01e" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">闭幕词</strong></h1><p id="b8b8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Azure MLOps是一个功能强大的服务，可以用于更多方面。从注册模型时将评估指标添加到模型的元数据中，到封装和部署使用模型的应用程序，使用Azure MLOps可以完成许多事情。所需要的就是探索它所提供的一切。<br/>因此，深入研究<a class="ae ml" href="https://docs.microsoft.com/en-us/python/api/overview/azure/ml/?view=azure-ml-py" rel="noopener ugc nofollow" target="_blank">文档</a>并找到问题的解决方案。</p></div></div>    
</body>
</html>