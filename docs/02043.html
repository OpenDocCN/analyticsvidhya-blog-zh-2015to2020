<html>
<head>
<title>Cut down Cost of running Google Cloud Dataflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">降低运行谷歌云数据流的成本</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cut-down-cost-of-running-google-cloud-dataflow-294a541dfbdc?source=collection_archive---------6-----------------------#2019-11-27">https://medium.com/analytics-vidhya/cut-down-cost-of-running-google-cloud-dataflow-294a541dfbdc?source=collection_archive---------6-----------------------#2019-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e8ae" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak"> <em class="ix">通过这些简单的技巧降低运行批处理/流式云数据流作业的成本</em> </strong></h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/2e38746008be265cfa031adcda046295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*maIbUpuu0dHJtUG8.png"/></div></div></figure><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es jk"><img src="../Images/f116935665d8bbf287eeec2353d41b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/0*dNosNTKNs7ldlME6.png"/></div></figure><p id="7580" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">Google cloud dataflow是大数据堆栈中的杰出产品之一，也是目前非常强大的处理引擎之一，它基于开源的<strong class="jn hj"> <em class="kh"> Apache beam </em> </strong>框架，支持大规模的批处理和流数据处理。</p><p id="46dd" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">这是一项完全托管的大规模大数据处理服务，无需管理任何运行管道的基础设施，但是，我们确实有<strong class="jn hj"> <em class="kh">配置</em> </strong>供我们使用，以改变特定批处理/流作业所需的基础设施，这可以帮助我们<strong class="jn hj"> <em class="kh">显著降低成本。</em>T15】</strong></p><p id="084b" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">让我们来看看其中的一些。</p><h1 id="3b87" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">将GCP服务保持在同一区域内</h1><p id="621c" class="pw-post-body-paragraph jl jm hi jn b jo la ij jq jr lb im jt ju lc jw jx jy ld ka kb kc le ke kf kg hb bi translated">这是我们在创建其他GCP服务时经常犯的错误。尽量将它们放在同一个区域，以避免出入成本。</p><p id="b0f0" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">例如，源文件可以在一个桶中，该桶位于数据流作业正在运行的不同区域。这将增加网络转账的额外费用，通过确保所有服务都在同一地区，您将能够避免任何网络转账费用，因为在几乎所有GCP地区，同一地区内的转账都是免费的。</p><p id="901f" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">默认情况下，如果未在管道配置中指定，数据流作业将在<strong class="jn hj"> <em class="kh">美国中心1 </em> </strong>区域提交和执行。</p><p id="55ea" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">要在部署数据流管道时设置区域，可以添加下面提到的参数。例如:<strong class="jn hj"><em class="kh">—region = us-east 1</em></strong></p><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es lf"><img src="../Images/8dd270ed81380a0dd2880f1d25e9d454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ujS0m7apTMLYSqe-SrtGQ.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">区域的参数详细信息</figcaption></figure><h1 id="1ee9" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">磁盘容量</h1><p id="8894" class="pw-post-body-paragraph jl jm hi jn b jo la ij jq jr lb im jt ju lc jw jx jy ld ka kb kc le ke kf kg hb bi translated">批处理数据流管道的默认磁盘大小为<strong class="jn hj"><em class="kh"/></strong>250 Gb，流式数据流管道的默认磁盘大小为<strong class="jn hj"> 400 Gb </strong>，在大多数情况下，数据文件不会存储在群集上，而是驻留在G <strong class="jn hj"> <em class="kh"> CS存储桶上(如果是批处理，或者是Pub/Sub(如果是流式事件)</em> </strong>使该存储附加到群集上<strong class="jn hj"> <em class="kh">浪费了资源</em> </strong> <em class="kh">，并产生了相关成本</em></p><p id="b457" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">将它减少到建议的最小大小<strong class="jn hj"><em class="kh"/></strong>30Gb。通过进行这种配置更改，您将能够在批处理管道上节省大约<strong class="jn hj"><em class="kh">【8–10美元/月</em> </strong>个工人，在流式管道上节省大约<strong class="jn hj">【15–20美元/月</strong>个工人。</p><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es lk"><img src="../Images/5e540e3407868719dd8f569e1fe8a089.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*GXmfDdpIMCz1FnQFpX4hzw.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">批量数据流管道估计(250Gb与30Gb PD)</figcaption></figure><p id="0073" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">要在部署数据流管道时设置磁盘大小，可以添加下面提到的参数。例如<strong class="jn hj"> <em class="kh"> — disk_size_gb=30 </em> </strong></p><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es ll"><img src="../Images/9078ffa403f359baf1698b4d82b8f350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KAfEepbCwl3nNo2jSS_YJg.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">磁盘大小的参数详细信息</figcaption></figure><h1 id="02f1" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">禁用公共IP</h1><p id="2244" class="pw-post-body-paragraph jl jm hi jn b jo la ij jq jr lb im jt ju lc jw jx jy ld ka kb kc le ke kf kg hb bi translated">默认情况下，数据流服务为您的管道分配<strong class="jn hj"> <em class="kh">公共和私有IP地址，</em> </strong> <em class="kh"> </em>当您创建计算引擎虚拟机时，也会发生同样的事情。</p><p id="dac6" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">保留一个公共IP地址会增加网络成本，并增加你每月的账单。</p><p id="7eca" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">在数据流管道的情况下，如果不需要您从Google cloud外部访问这些管道，您可以在部署管道时禁用此公共IP，从而节省一些网络成本。</p><p id="1310" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">要在部署数据流管道时禁用公共IPs，可以添加下面提到的参数标志。例如<strong class="jn hj"><em class="kh">—no _ use _ public _ IPS = true</em></strong></p><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es lm"><img src="../Images/631bc1dd78d399fb721452fe5db9c8fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YJBBQnpIwE52RYDqPQSo8w.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">公共IP的参数详细信息</figcaption></figure><p id="f44e" class="pw-post-body-paragraph jl jm hi jn b jo jp ij jq jr js im jt ju jv jw jx jy jz ka kb kc kd ke kf kg hb bi translated">暂时就这样吧！请遵循这些技巧，减少你的数据流成本。</p></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h2 id="a91b" class="lu kj hi bd kk lv lw lx ko ly lz ma ks ju mb mc ku jy md me kw kc mf mg ky mh bi translated">如果这篇文章是有帮助的，请在下面留下评论并分享它，以帮助其他人找到它。</h2></div></div>    
</body>
</html>