<html>
<head>
<title>A simple guide to Mask R-CNN implementation on a custom dataset.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在自定义数据集上屏蔽 R-CNN 实现的简单指南。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-simple-guide-to-maskrcnn-custom-dataset-implementation-27f7eab381f2?source=collection_archive---------1-----------------------#2020-08-02">https://medium.com/analytics-vidhya/a-simple-guide-to-maskrcnn-custom-dataset-implementation-27f7eab381f2?source=collection_archive---------1-----------------------#2020-08-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="d736" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在您自己的数据集上训练多类对象检测模型的分步教程。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f61fc5133c7c3426c2c9df68d8c629fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVcRuCDwx3HSDYOUHHPt6Q.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn">MaskRCNN</strong>输出物体检测结果。(<a class="ae jo" href="https://i.insider.com/55f212bdbd86ef16008b9942" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="c0c3" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi ks translated"><span class="l kt ku kv bm kw kx ky kz la di">在</span> <br/>这篇文章中，我们将简明地理解物体检测的不同方法，然后通过简单的步骤来训练你自己的模型。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lb"><img src="../Images/0d49e6b58dc1f1ec0dc162d842dc0062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*XJHQlIhN7lK7y02VDLVfKQ.jpeg"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn">对象定位、语义分割和实例分割的比较</strong>。(<a class="ae jo" href="https://arxiv.org/abs/1704.06857" rel="noopener ugc nofollow" target="_blank">来源</a>)</figcaption></figure><p id="e13d" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">对象检测可以大致分为三大类:<br/> (a)对象定位<br/> (b)语义分割<br/> (c)实例分割</p><p id="5653" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">对象定位指的是检测图像中的对象，并进一步为这些对象分配单个边界框。语义分割是最近开发的一种对象检测方法，其中每个像素被分配一个类别。如上图所示，瓶子标有一种颜色，立方体标有另一种颜色。该方法将相似类型的对象归入一个类别。在这一类别中，有各种先进的算法正在开发中。<br/>第三种类型的检测是实例分割，它涉及检测图像中的每个单独对象并为其分配单独的身份。</p><p id="3e88" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在这里描述的所有三种方法中，实例分割是计算机视觉领域中最具挑战性的任务。它在自动驾驶和感知领域有着广泛的用途，这使得它更加有趣。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="3e3d" class="lc ld hi bd jn le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">代码:</h1><p id="7b58" class="pw-post-body-paragraph jw jx hi jy b jz lt ij kb kc lu im ke kf lv kh ki kj lw kl km kn lx kp kq kr hb bi translated">简单介绍了对象检测之后，让我们开始 MaskRCNN 的简单实现。请按照下面提到的<strong class="jy hj">一步一步地执行</strong>程序。</p><h2 id="ce34" class="ly ld hi bd jn lz ma mb lh mc md me ll kf mf mg ln kj mh mi lp kn mj mk lr ml bi translated">步骤 1:克隆存储库。</h2><p id="ecb9" class="pw-post-body-paragraph jw jx hi jy b jz lt ij kb kc lu im ke kf lv kh ki kj lw kl km kn lx kp kq kr hb bi translated">请复制下面给出的自定义 MaskRCNN 存储库:</p><div class="mm mn ez fb mo mp"><a href="https://github.com/soumyaiitkgp/Custom_MaskRCNN" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">soumyaitkgp/Custom _ MaskRCNN</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">这是一个基于 Matterport Maskrcnn 知识库的知识库，用于将自定义 Maskrcnn 应用到自定义…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jh mp"/></div></div></a></div><p id="86eb" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">请确保安装了自述文件中给出的所有依赖项。</p><h2 id="4aaa" class="ly ld hi bd jn lz ma mb lh mc md me ll kf mf mg ln kj mh mi lp kn mj mk lr ml bi translated">第二步:准备资料。</h2><p id="620e" class="pw-post-body-paragraph jw jx hi jy b jz lt ij kb kc lu im ke kf lv kh ki kj lw kl km kn lx kp kq kr hb bi translated">使用以下步骤准备数据:</p><p id="3f28" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">1.将所有图像收集到一个单独的文件夹中，用于培训。<br/> 2。将数据集大致分成 90:10 的比例，用于训练和验证<br/> 3。将训练图像添加到以下名为“train”的文件夹中</p><pre class="iy iz ja jb fd ne nf ng nh aw ni bi"><span id="9df9" class="ly ld hi nf b fi nj nk l nl nm">D:\..\CustomMask_RCNN\samples\custom\dataset\train</span></pre><p id="148a" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">4.将训练图像添加到以下名为“val”的文件夹中</p><pre class="iy iz ja jb fd ne nf ng nh aw ni bi"><span id="10bc" class="ly ld hi nf b fi nj nk l nl nm">D:\..\CustomMask_RCNN\samples\custom\dataset\val</span></pre><p id="6197" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">5.使用图像注释软件注释图像。有许多<a class="ae jo" href="https://lionbridge.ai/articles/image-annotation-tools-for-computer-vision/" rel="noopener ugc nofollow" target="_blank">工具</a>可用于图像注释。我通常更喜欢<a class="ae jo" href="https://www.makesense.ai/" rel="noopener ugc nofollow" target="_blank"> Makesense.ai </a>，因为不需要下载/安装。此外，它不在自己的服务器上存储任何图像。<br/> 6。注释后，将文件保存到“train”文件夹中，命名为“annotations.json”。<br/> 7。验证图像注释后，将文件以“annotations.json”的名称保存到“val”文件夹</p><h2 id="0a4b" class="ly ld hi bd jn lz ma mb lh mc md me ll kf mf mg ln kj mh mi lp kn mj mk lr ml bi translated">第三步:准备模型。</h2><p id="875c" class="pw-post-body-paragraph jw jx hi jy b jz lt ij kb kc lu im ke kf lv kh ki kj lw kl km kn lx kp kq kr hb bi translated">批注后，打开中给出的“custom.py”文件</p><pre class="iy iz ja jb fd ne nf ng nh aw ni bi"><span id="26fb" class="ly ld hi nf b fi nj nk l nl nm"><em class="nn">D:\..\CustomMask_RCNN\samples\custom</em></span></pre><p id="8597" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">现在遵循给定的步骤:</p><ol class=""><li id="54fc" class="no np hi jy b jz ka kc kd kf nq kj nr kn ns kr nt nu nv nw bi translated">(<strong class="jy hj"> Line 91 </strong>)根据你的要求添加类别名称。我在这里使用两个类别来训练我的模型，自行车和汽车。请根据您的需要随时做进一步的更改。<strong class="jy hj"> <em class="nn">记住按照你在注释中提到的方式输入类名(甚至空格)</em> </strong></li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nx"><img src="../Images/981fe0f839d85be9fd3365a3315474bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rwAd2bXoPf96QmIbfOVGg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn"> Custom.py 文件。</strong>(图片作者提供)</figcaption></figure><p id="b2fd" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">2.(<strong class="jy hj"> Line 140 </strong>)以与上一步相同的方式添加分类标签，将标签名称与分类编号对应起来。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ny"><img src="../Images/95bcfe88155cbe915abb9e4ff7f8cbcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdNCzNskMS1oYiuW15jN4A.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn"> Custom.py 文件。</strong>(图片作者提供)</figcaption></figure><p id="6dfa" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">3.(<strong class="jy hj">第 71 行</strong>)在加号后面加上班级数。例如，这里我的类的数量是 2(汽车和自行车)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nz"><img src="../Images/79f3518e43d5f4ac0876731480fcf4bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYjCauJU5MAx2aYnR2gJzw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn"> Custom.py 文件。</strong>(图片作者提供)</figcaption></figure><h2 id="a48d" class="ly ld hi bd jn lz ma mb lh mc md me ll kf mf mg ln kj mh mi lp kn mj mk lr ml bi translated">有了这三个小步骤，你就准备好训练模型了！</h2><h2 id="3d18" class="ly ld hi bd jn lz ma mb lh mc md me ll kf mf mg ln kj mh mi lp kn mj mk lr ml bi translated">第四步:训练模型。</h2><p id="5990" class="pw-post-body-paragraph jw jx hi jy b jz lt ij kb kc lu im ke kf lv kh ki kj lw kl km kn lx kp kq kr hb bi translated">如果你是 windows 用户，进入文件浏览器的“自定义”文件夹，在上面的地址栏中输入“<em class="nn"> cmd </em>”，然后按回车键，如图所示。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oa"><img src="../Images/d04c5fee3db20a9875ff1a7dd75260b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tbW7JVf7duJNkZ0kYR5ZpQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn"> Custom_MaskRCNN 文件夹下的文件。</strong>(图片作者提供)</figcaption></figure><p id="a4f6" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">打开命令提示符后粘贴以下命令</p><pre class="iy iz ja jb fd ne nf ng nh aw ni bi"><span id="990a" class="ly ld hi nf b fi nj nk l nl nm">python custom.py train — dataset=D:/../CustomMask_RCNN/samples/custom/dataset — weights=coco</span></pre><p id="8fbd" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated"><strong class="jy hj">将路径粘贴到'<em class="nn">数据集= </em>'和'<em class="nn"> —权重</em> ' </strong>之间的数据集，然后按回车键。如果你是第一次训练，那么根据你的网速下载 coco 重量需要一些时间。模型开始训练后，你的屏幕应该是这样的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ob"><img src="../Images/b66d207aee16cc49e9f19471cd75909c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1u4Q6k5ZnICUH1DD4NQntw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn"> MaksRCNN 培训。</strong>(图片作者提供)</figcaption></figure><h2 id="9eac" class="ly ld hi bd jn lz ma mb lh mc md me ll kf mf mg ln kj mh mi lp kn mj mk lr ml bi translated">第五步:结果</h2><p id="685b" class="pw-post-body-paragraph jw jx hi jy b jz lt ij kb kc lu im ke kf lv kh ki kj lw kl km kn lx kp kq kr hb bi translated">模型训练完成后，通过打开自定义文件夹中的 python 笔记本开始测试。</p><ol class=""><li id="1b4f" class="no np hi jy b jz ka kc kd kf nq kj nr kn ns kr nt nu nv nw bi translated">通过在自定义文件夹的地址栏中键入“jupyter notebook”来打开“demo.ipynb”。</li><li id="3656" class="no np hi jy b jz oc kc od kf oe kj of kn og kr nt nu nv nw bi translated">转到主 CustomMask_RCNN 文件夹中的 logs 文件夹，并找到最近的文件夹。文件夹名称应以“自定义”开头，后跟一个唯一的数字。示例-“客户 0001293487”。将最近文件夹的名称更改为“自定义”。</li><li id="e4b2" class="no np hi jy b jz oc kc od kf oe kj of kn og kr nt nu nv nw bi translated">在根目录下的“images”文件夹中插入测试模型所需的图像。</li><li id="ffb1" class="no np hi jy b jz oc kc od kf oe kj of kn og kr nt nu nv nw bi translated">在 4 号单元格中添加你训练你的模型的班级名称。请按照您在“custom.py”文件中输入的顺序添加类名。<strong class="jy hj">不要删除类别“BG”。在它后面添加您的类名，如下所示。</strong></li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oh"><img src="../Images/d93dac310e3e580b0e5aceb604055bbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m_Is4CXzp_n5ZukZPbhy_g.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn">阶级名称。</strong>(图片作者提供)</figcaption></figure><p id="e502" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">5.运行所有单元格以生成最终输出。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oi"><img src="../Images/2fedb00f9918645c57ba8edabed188b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wxm8-e2xtL3W8Gz50wyahg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd jn">MaskRCNN</strong>物体检测输出结果。(<a class="ae jo" href="https://www.motopfohe.bg/en/about-us/news/view/volvo-to-unload-100-self-driving-cars-onto-city-streets-of-gothenburg" rel="noopener ugc nofollow" target="_blank">来源</a>)</figcaption></figure><p id="281a" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我希望这将被证明是 MaskRCNN 实现的有益指南。我发现的最令人兴奋的事情是它的应用水平，从自动驾驶到农民的杂草检测。</p><p id="10d8" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">如果你有任何疑问，请在下面留下评论或者去我的知识库提出问题。</p><p id="35b6" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated"><strong class="jy hj"> Github 链接:</strong></p><div class="mm mn ez fb mo mp"><a href="https://github.com/soumyaiitkgp/Custom_MaskRCNN" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">soumyaitkgp/Custom _ MaskRCNN</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">这是一个基于 Matterport Maskrcnn 知识库的知识库，用于将自定义 Maskrcnn 应用到自定义…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jh mp"/></div></div></a></div></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="e289" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated"><strong class="jy hj">参考文献</strong></p><div class="mm mn ez fb mo mp"><a href="https://github.com/matterport/Mask_RCNN" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">matterport/Mask_RCNN</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">这是 Mask R-CNN 在 Python 3、Keras 和 TensorFlow 上的实现。该模型生成边界框和…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="oj l na nb nc my nd jh mp"/></div></div></a></div><div class="mm mn ez fb mo mp"><a href="https://github.com/matterport/Mask_RCNN/issues/372" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">气球样本:如果我们想为一个以上的班级进行培训，该怎么办？</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">解散 GitHub 是超过 5000 万开发者的家园，他们一起工作来托管和审查代码，管理项目，以及…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="ok l na nb nc my nd jh mp"/></div></div></a></div><div class="mm mn ez fb mo mp"><a href="https://github.com/matterport/Mask_RCNN/issues/1006" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">MakRCNN 用多个类实现问题#1006 matterport/Mask_RCNN</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">我的 json 文件看起来像这样…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="ol l na nb nc my nd jh mp"/></div></div></a></div><h1 id="7f0d" class="lc ld hi bd jn le om lg lh li on lk ll io oo ip ln ir op is lp iu oq iv lr ls bi translated">谢谢大家！</h1></div></div>    
</body>
</html>