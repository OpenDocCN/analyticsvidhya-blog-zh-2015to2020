<html>
<head>
<title>Sentiment Analysis For Bengali News Text Using LSTM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于LSTM的孟加拉语新闻文本情感分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentiment-analysis-for-bengali-news-text-using-lstm-cbed3f66f3bb?source=collection_archive---------10-----------------------#2020-05-11">https://medium.com/analytics-vidhya/sentiment-analysis-for-bengali-news-text-using-lstm-cbed3f66f3bb?source=collection_archive---------10-----------------------#2020-05-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/38cddd094862d2e88f50d0482adfed70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*U76OMenIqfDhgguYokdXVQ.jpeg"/></div></figure><div class=""/><p id="efe3" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi jk translated">情感分析是管理决策和反应的部分，就像情感一样，它产生于文字，广泛应用于数据挖掘、网络挖掘和基于互联网的生活调查等领域，因为假设是对人类行为做出判断的最基本的品质。这个特殊的领域正在研究和机械的社会秩序中膨胀。评估可以是正面的、负面的或中性的，或者它可以包含一个表达评估充分性的算术分数。</p><p id="8369" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">由情绪组成的新闻标题-好的，坏的，中性的。情感分析被用来调查文本信息中存在的人类情感。在这里，我将展示一个基于深度学习的新闻标题情感分析的实现。在孟加拉语新闻标题数据集上的实验表明了该方法的适用性和有效性。</p><h2 id="a4a7" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">加载数据集</h2><p id="dcce" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated"><strong class="io hq"> pandas </strong>是一个快速、强大、灵活且易于使用的开源数据分析库，专为python打造。数据集已保存在excel表格中。所以，需要使用pandas库来读取excel。在python 3中不需要转换编码。re用于替换孟加拉文本中的正则表达式。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="eb82" class="jt ju hp ky b fi lc ld l le lf">import pandas as pd</span><span id="88ed" class="jt ju hp ky b fi lg ld l le lf">import re</span><span id="6752" class="jt ju hp ky b fi lg ld l le lf">df=pd.read_excel("Bengali_News_Headline_Sentiment.xlsx")</span></pre><p id="3f30" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数据集中有三个属性。但是我们需要标题和情感属性来进行情感分析。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="80c8" class="jt ju hp ky b fi lc ld l le lf">df.head()</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lh"><img src="../Images/0e4ae03f0b33f7fa3fd96c0f90b7d19b.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*86ucKtkPvtpYewmO1EJ2DA.png"/></div></figure><p id="4c99" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq"> drop() </strong>用来放下不想要的列和axis=1的指示列。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="5880" class="jt ju hp ky b fi lc ld l le lf">df=df.drop('News Type',axis=1)</span></pre><h2 id="3b7a" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">移除表达式</h2><p id="b958" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">孟加拉文字有一些最常用的表达，如।，:，，？等。在转换标记和序列之前，需要从文本中删除这些表达式。<strong class="io hq"> </strong>应用一个<strong class="io hq">λ</strong>函数来替换标题的那些表达式。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6043" class="jt ju hp ky b fi lc ld l le lf">df['Headline'] = df['Headline'].apply((lambda x: re.sub('[,?'']','',x)))</span></pre><h2 id="f5ba" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">深度学习库</h2><p id="3388" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">为了将文本转换成令牌，使用了Keras <strong class="io hq">令牌化器</strong>。之后，使用将令牌转换为序列Keras填充序列。Keras <strong class="io hq">序列</strong>模型被导入以构建适用于层的简单堆叠的模型，其中每层恰好有<strong class="io hq"> <em class="li">一个输入张量</em> </strong>和<strong class="io hq"> <em class="li">一个输出张量。</em> </strong></p><p id="1a47" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一个<strong class="io hq"> LSTM </strong>网络是一种递归神经网络。递归神经网络是试图模拟时间或序列相关行为的神经网络。为了保持文本序列<strong class="io hq">，导入长短期记忆</strong>。在这里，我们将建立一个维护文本序列的LSTM网络。LSTM细胞块代替了我们的标准神经网络层。这些单元有不同的组件，称为输入门、遗忘门和输出门。</p><p id="bf7c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">密集</strong>层是规则的深度连接神经网络层。这是最常见和最常用的层。</p><p id="b373" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Keras <strong class="io hq">嵌入</strong>层，可用于文本数据上的神经网络。它要求输入数据是整数编码的，因此每个字都由一个唯一的整数表示。</p><p id="466f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq"> SpartialDropout1D </strong>它会删除整个1D特征地图，而不是单个元素。</p><p id="51ef" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Keras <strong class="io hq"> utils </strong>将类向量(整数)转换为二进制类矩阵。</p><p id="2347" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Sklearn模型选择用于将数据集分为训练和测试部分。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c941" class="jt ju hp ky b fi lc ld l le lf">import numpy as np</span><span id="d3c4" class="jt ju hp ky b fi lg ld l le lf">from keras.preprocessing.text import Tokenizer</span><span id="8677" class="jt ju hp ky b fi lg ld l le lf">from keras.preprocessing.sequence import pad_sequences</span><span id="9769" class="jt ju hp ky b fi lg ld l le lf">from keras.models import Sequential</span><span id="ec30" class="jt ju hp ky b fi lg ld l le lf">from keras.layers import LSTM,Dense,Embedding,SpatialDropout1D</span><span id="1720" class="jt ju hp ky b fi lg ld l le lf">from keras.utils.np_utils import to_categorical</span><span id="a04a" class="jt ju hp ky b fi lg ld l le lf">from sklearn.model_selection import train_test_split</span></pre><h2 id="87ab" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">将文本转换为序列</h2><p id="42c4" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">对于特征提取，使用2500个最大特征。Tokenizer根据最大特征数对文本进行标记。和记号赋予器适合标题文本，用于将文本转换成序列。转换后的序列被添加填充序列。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="3122" class="jt ju hp ky b fi lc ld l le lf">max_fatures = 2500</span><span id="d014" class="jt ju hp ky b fi lg ld l le lf">tokenizer = Tokenizer(num_words=max_fatures, split=' ')</span><span id="73bd" class="jt ju hp ky b fi lg ld l le lf">tokenizer.fit_on_texts(df['Headline'].values)</span><span id="ed3e" class="jt ju hp ky b fi lg ld l le lf">X = tokenizer.texts_to_sequences(df['Headline'].values)</span><span id="855e" class="jt ju hp ky b fi lg ld l le lf">X = pad_sequences(X)</span></pre><p id="953e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">x包含32位整数数据类型的文本序列数组。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="d3e2" class="jt ju hp ky b fi lc ld l le lf">X</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lj"><img src="../Images/6480f539305a993b950e36a9cff46de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*48K_Fw_lAgydOkO5Rkm8ew.png"/></div></figure><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="89f8" class="jt ju hp ky b fi lc ld l le lf">np.shape(X)</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lk"><img src="../Images/e383de9ef082c518fbe073d1b0300d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:208/format:webp/1*lILB5_LBGXwmLDpuoHu39Q.png"/></div></figure><h2 id="387f" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">设置模型</h2><p id="4ef0" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">设置嵌入尺寸64。在嵌入层中，最大特征被用作具有嵌入维度的输入，并且输入长度等于填充序列形状。在空间漏失层中，使用0.4的比率。LSTM牢房增加了64个隐藏单元，0.2人辍学，0.2人经常辍学。在输出图层组中，使用“Softmax”激活功能，密度大小为2。Softmax将实数向量转换为分类概率向量。输出向量的元素在范围(0，1)内，总和为1。对于损失计算，使用“分类交叉熵”和“adam”进行优化。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="3f72" class="jt ju hp ky b fi lc ld l le lf">embed_dim = 64</span><span id="7ccb" class="jt ju hp ky b fi lg ld l le lf">model = Sequential()</span><span id="bc35" class="jt ju hp ky b fi lg ld l le lf">model.add(Embedding(max_fatures, embed_dim,input_length = X.shape[1]))</span><span id="a93d" class="jt ju hp ky b fi lg ld l le lf">model.add(SpatialDropout1D(0.4))</span><span id="890a" class="jt ju hp ky b fi lg ld l le lf">model.add(LSTM(64, dropout=0.2, recurrent_dropout=0.2))</span><span id="83cd" class="jt ju hp ky b fi lg ld l le lf">model.add(Dense(2,activation='softmax'))</span><span id="99b5" class="jt ju hp ky b fi lg ld l le lf">model.compile(loss = 'categorical_crossentropy', optimizer='adam',metrics = ['acc'])</span><span id="98ea" class="jt ju hp ky b fi lg ld l le lf">model.summary()</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es ll"><img src="../Images/31224a6a043635d82002e1687067e2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*xbsno19MEFyjhlSS3hmdwg.png"/></div></figure><h2 id="bfdf" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">列车测试划分</h2><p id="b161" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">标题文本是模型的输入，情感是输出。变量X包含模型输入，Y是输出。为了从数据集获得情感值，使用熊猫假人函数。</p><p id="47d3" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于测试，20%的总数据与42个随机状态值一起使用。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f42c" class="jt ju hp ky b fi lc ld l le lf">Y = pd.get_dummies(df['Sentiment']).values</span><span id="741f" class="jt ju hp ky b fi lg ld l le lf">X_train, X_test, Y_train, Y_test = train_test_split(X,Y, test_size = 0.20,random_state = 42)</span><span id="91f9" class="jt ju hp ky b fi lg ld l le lf">print(X_train.shape,Y_train.shape)</span><span id="d972" class="jt ju hp ky b fi lg ld l le lf">print(X_test.shape,Y_test.shape)</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lm"><img src="../Images/0f14efa9e0c807af381f7ef2e7ce0bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/1*nrbHRa7fF1DB7RPJ8cSzVw.png"/></div></figure><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es ln"><img src="../Images/49402aaac957629f4bcf65948cf15cdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:2/format:webp/1*taBY4jELeydzs45A8omDAA.png"/></div></figure><h2 id="2cca" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">火车模型</h2><p id="952d" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">保存模型性能历史变量的每一步被使用。对于迭代，设置10个历元，32个批次大小。验证数据10%的数据用于验证分割。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="cea9" class="jt ju hp ky b fi lc ld l le lf">history=model.fit(X_train, Y_train, epochs = 10, batch_size=32, verbose = 2,validation_split=0.1)</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lo"><img src="../Images/e6f70832fae9d3737a7d7464e61f75c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*30I1YOJMsmAY9vKVxx-UPg.png"/></div></figure><p id="5874" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在训练模型实现了训练数据的97%的准确度和评估数据的64%的准确度之后。模型也按64批次大小进行评估。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8eb1" class="jt ju hp ky b fi lc ld l le lf">score = model.evaluate(X_train, Y_train,batch_size=64, verbose=2)</span><span id="0ab0" class="jt ju hp ky b fi lg ld l le lf">print('Train loss:', score[0])</span><span id="a800" class="jt ju hp ky b fi lg ld l le lf">print('Train accuracy:', score[1])</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lp"><img src="../Images/bad2bc63e62f1764af4c12fc745b7394.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*4q9wq-r8ZznSwEqDp3QE6Q.png"/></div></figure><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="342f" class="jt ju hp ky b fi lc ld l le lf">score = model.evaluate(X_test, Y_test,batch_size=64, verbose=2)</span><span id="2c44" class="jt ju hp ky b fi lg ld l le lf">print('Test loss:', score[0])</span><span id="263b" class="jt ju hp ky b fi lg ld l le lf">print('Test accuracy:', score[1])</span></pre><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lp"><img src="../Images/3b49597abbf2139bf823739b1f36a29f.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*NkWppxCK58y-ie7Tsn6lHw.png"/></div></figure><h2 id="acf7" class="jt ju hp bd jv jw jx jy jz ka kb kc kd ix ke kf kg jb kh ki kj jf kk kl km kn bi translated">情感预测</h2><p id="d2b3" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">用户给出一个标题作为输入句子，然后它将文本转换成用于情感预测的序列。如果模型预测0表示包含负面消息，否则预测正面消息。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8194" class="jt ju hp ky b fi lc ld l le lf">text = input()</span><span id="ae5f" class="jt ju hp ky b fi lg ld l le lf">text = tokenizer.texts_to_sequences(text)</span><span id="de63" class="jt ju hp ky b fi lg ld l le lf">text = pad_sequences(text,maxlen=14,dtype='int32',value=0)</span><span id="4e4f" class="jt ju hp ky b fi lg ld l le lf">predict=model.predict(text,batch_size=1,verbose=2)[0]</span><span id="bc4e" class="jt ju hp ky b fi lg ld l le lf">if(np.argmax(predict)==0):</span><span id="4fc2" class="jt ju hp ky b fi lg ld l le lf">print("Negative News")</span><span id="f1ca" class="jt ju hp ky b fi lg ld l le lf">else:</span><span id="02f5" class="jt ju hp ky b fi lg ld l le lf">print("Positive News")</span></pre><p id="2a13" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">github:<a class="ae lq" href="https://github.com/AbuKaisar24/Machine-Learning-Algorithms-Performance-Measurement-for-Bengali-News-Sentiment-Classification/blob/master/Headline%20Sentiment%20using%20LSTM.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/abukaisar 24/Machine-Learning-Algorithms-Performance-Measurement-for-Bengali-News-sensition-Classification/blob/master/Headline % 20 sensition % 20 using % 20 lstm . ipynb</a></p></div></div>    
</body>
</html>