<html>
<head>
<title>SQL Server Joins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL Server联接</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sql-server-joins-a6cedef552d?source=collection_archive---------34-----------------------#2020-05-07">https://medium.com/analytics-vidhya/sql-server-joins-a6cedef552d?source=collection_archive---------34-----------------------#2020-05-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3028" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">随时获取您想要的数据</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/b27732ac93539ab5073ef94d4f859a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SDxl8q99TT4N7Xrw"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="https://unsplash.com/@blakeconnally?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布莱克·康纳利</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d080" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">之前，我们学习了如何插入、选择和更新数据，基本上是CRUD(创建、读取、更新、删除)的基础。如果你不太熟悉SQL，我肯定会先读一读那篇文章。这将有助于你理解这一点。</p><div class="kk kl ez fb km kn"><a rel="noopener follow" target="_blank" href="/@J.Code/sql-server-introduction-9e172e5d66ba"><div class="ko ab dw"><div class="kp ab kq cl cj kr"><h2 class="bd hj fi z dy ks ea eb kt ed ef hh bi translated">SQL Server简介</h2><div class="ku l"><h3 class="bd b fi z dy ks ea eb kt ed ef dx translated">如何开始使用SQL Server</h3></div><div class="kv l"><p class="bd b fp z dy ks ea eb kt ed ef dx translated">medium.com</p></div></div><div class="kw l"><div class="kx l ky kz la kw lb jh kn"/></div></div></a></div><p id="27c9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">今天我们将学习SQL中更高级的概念，即如何连接表。</p><p id="4577" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">什么是连接？</strong></p><p id="5d98" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当你想…连接多个表中的数据时，连接很有用，希望有所帮助。</p><p id="f600" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">联接用于组合两个或多个表中的行，这些行基于它们之间的相关列。您可以使用一个连接，通过一个查询从多个表中获取数据，而不必进行多次查询来查看您想要的数据。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lc"><img src="../Images/03d16dd056bd8adf4783f161e5f19b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*_pGj3DixmBImxcAl_HWWdA.gif"/></div></figure><p id="36e5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了真正正确地使用联接，您必须理解数据库的结构，并且真正理解表是如何相关的，如果您的项目有一个数据库图表，这将是查看这些关系的最简单的方法之一。</p><p id="366c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果没有，那么你就必须用最难的方法来做，真正地浏览你所有的表，理解它们之间的关系……RIP</p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><h2 id="282b" class="lk ll hi bd lm ln lo lp lq lr ls lt lu jx lv lw lx kb ly lz ma kf mb mc md me bi translated">连接的类型</h2><p id="2802" class="pw-post-body-paragraph jo jp hi jq b jr mf ij jt ju mg im jw jx mh jz ka kb mi kd ke kf mj kh ki kj hb bi translated">有多种类型的连接:</p><p id="5273" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="mk">内部连接<br/> </em>这将返回在两个表中都有匹配值的记录</p><p id="3a93" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="mk">左(外)连接</em> <br/>返回左表中的所有记录和右表中匹配的记录</p><p id="e0f5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="mk">右(外)连接</em> <br/>返回右表中的所有记录和左表中匹配的记录。</p><p id="ead2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="mk">完全(外部)连接</em> <br/>返回两个表中的所有记录。</p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><p id="916b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">内部连接的语法</strong></p><p id="4a18" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">所有连接的语法都是相似的，只是查询的结果不同，所以我只展示内部连接的语法。</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="7107" class="lk ll hi mm b fi mq mr l ms mt">Select *<br/>from tableOne<br/>    joinType join tableTwo<br/>        on (tableOne.columnName = tableTwo.columnName)</span></pre><ul class=""><li id="c779" class="mu mv hi jq b jr js ju jv jx mw kb mx kf my kj mz na nb nc bi translated">你先用<br/> <code class="du nd ne nf mm b">from tableOne</code>说出你想正常查询哪个表</li></ul><p id="7d2d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来是连接，您声明连接的类型，然后是第二个表名，以及来自两个表的相关数据。</p><p id="3560" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du nd ne nf mm b">joinType join tableTwo on (tableOne.columnName = tableTwo.columnName)</code></p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><p id="252d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">创建额外表格</strong></p><p id="6018" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这个例子中，我们需要一个包含相关数据的新表，所以让我们创建一个表，简单地存储我们的员工上下班打卡的时间。该表将共享雇员表中的雇员id和雇员姓名。</p><p id="6750" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，如果您继续阅读我之前创建雇员数据库的文章，您将需要添加另一个表。如果没有，您可以直接跳到连接示例。</p><p id="f5f2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">下面的代码将创建一个表，我把我的数据库称为JobDatabase，如果没有，请确保输入数据库名。</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="37aa" class="lk ll hi mm b fi mq mr l ms mt">USE JobDatabase<br/>GO</span><span id="6732" class="lk ll hi mm b fi ng mr l ms mt">CREATE TABLE TimeClock<br/>(<br/>    employeeID INT NOT NULL PRIMARY KEY,<br/>    employeeName VARCHAR(50),<br/>    timeIn time,<br/>    timeOut Time<br/>)<br/>GO</span><span id="67c2" class="lk ll hi mm b fi ng mr l ms mt">INSERT INTO TimeClock VALUES (1, ‘James’, ‘10:25:35’, ‘16:56:43’);<br/>INSERT INTO TimeClock VALUES (2, ‘Emily’, ‘14:45:25’, ‘16:56:43’);<br/>INSERT INTO TimeClock VALUES (3, ‘Nick’, ‘10:12:56’, ‘15:48:45’);<br/>INSERT INTO TimeClock VALUES (4, ‘Kyle’, ‘10:43:24’, ‘19:42:35’);<br/>INSERT INTO TimeClock VALUES (5, ‘Mike’, ‘20:25:15’, ‘04:23:24’);<br/>INSERT INTO TimeClock VALUES (6, ‘Anthony’, ‘17:34:35’, ‘23:45:24’);<br/>GO</span></pre><p id="b7a5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该表中的数据如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nh"><img src="../Images/2caeef89dac495255ed00ab5487db18f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DaHvsyWHkAJ7HOzD7E4XPA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">时钟表</figcaption></figure></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><h2 id="43fe" class="lk ll hi bd lm ln lo lp lq lr ls lt lu jx lv lw lx kb ly lz ma kf mb mc md me bi translated">连接示例</h2><p id="cfa1" class="pw-post-body-paragraph jo jp hi jq b jr mf ij jt ju mg im jw jx mh jz ka kb mi kd ke kf mj kh ki kj hb bi translated">对于我们的例子，我们需要所有的员工信息，包括他们上班打卡和下班打卡的时间。但是我不想做两次查询，因为那样我不能完全理解数据。我想要一个有所有数据的大桌子。</p><p id="7fef" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果employees表中的ID与TimeClock表中的employeeID匹配，我们希望从employees表和TimeClock表中选择*列</p><p id="f886" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">注意:要访问特定表中的列，可以使用tableName.columnName语法</p><pre class="iy iz ja jb fd ml mm mn mo aw mp bi"><span id="947a" class="lk ll hi mm b fi mq mr l ms mt">select *<br/>from Employees<br/>inner join TimeClock on Employees.ID = TimeClock.employeeID</span></pre></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><p id="96ef" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">结果<br/> </strong>上述查询的结果如下:</p><p id="f9f8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，这两个表被连接在一起，TimeClock表被附加到我们现有的Employees表中。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ni"><img src="../Images/01c586b5253bfc471fd54a53f9d13054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXIsUxn4g9lHJ9dzEF3z1g.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">左边是雇员表，右边是时钟</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nj"><img src="../Images/ea279b4267232d21888ce69dfe49f975.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*z6-XWtRlCDKciBd3eS4PzQ.gif"/></div></figure><p id="399d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢阅读，我希望这有所帮助。我将发布更多关于SQL Server的文章，从基础到更高级的特性，如函数和存储过程，并在所有文章中保持一个更新的列表。</p></div></div>    
</body>
</html>