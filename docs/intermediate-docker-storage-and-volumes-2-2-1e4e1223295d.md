# 中级码头工人:存储和卷(2/2)

> 原文：<https://medium.com/analytics-vidhya/intermediate-docker-storage-and-volumes-2-2-1e4e1223295d?source=collection_archive---------23----------------------->

你回来真是太好了。我们现在可以继续讨论 Docker Volumes。

所以，让我们回顾一下。 **Docker 卷**被认为是将持久数据存储到 Docker 的首选方式。

如果您记得执行**绑定挂载**实践依赖于主机的目录结构，与卷的最大区别是这些卷完全由 Docker 管理，这具有巨大的优势，因为它保证可以在任何地方工作，与存储驱动程序安全共享(稍后解释),最重要的是，可以为容器预先填充，这是自动化的功劳。

这里有一个用法的例子

`docker run -d --name devtest --mount source=david-vol,target=/app nginx`

或者一个非常简单的方法是借助于`-v`标志

工作示例

`docker volume ls`(列出创建的卷)

`docker volume inspect web-vol | more`(一卷完整的详细信息)

您也可以检查卷，在 inspect 命令的帮助下检查卷部分，如`docker container inspect [TAG]`

关于 **Docker Volumes** 还有一点需要拯救，那就是可以将相同的数据共享给其他有能力使用它的容器。

# 回到存储问题:存储驱动因素

在 hood 下有很多事情在进行，但是官方文档规定，当你与一个容器交互时，你实际上并没有写入容器的可写区域，而是使用了 Docker 卷。

我引用一下，“有些工作负载要求您写入容器可写区域”，为此，您将需要一个存储驱动程序。

如果这还不够清楚，那么**存储驱动**就是允许你写入容器可写层的方式，就像这样，但是你可以在这里找到更多信息[。](https://docs.docker.com/storage/storagedriver/)

有两种类型的存储驱动程序，默认选择的`overlay2`和`devicemapper`(稍后解释)设置为`overlay2`存储驱动程序的替代。

扩展一下，`devicemapper`使用基于块的存储，这意味着它可以访问 Docker 专用的块设备，并且直接在块级而不是文件级工作。另一方面，Docker 可以管理直接连接到主机的物理存储。

我只提到了`overlay2`和`devicemapper`，但是根据你的操作系统风格，还有更多选项。但是，当您更改实例的存储驱动程序时，任何映像和容器都将变得不可访问，这是因为它们的层不能被新的存储驱动程序使用，因此在 Docker 设置的起点做出决定至关重要。

根据文档和一些互联网资源，这里有一个如何更改默认值的快速概述。

1.  首先，我们需要停止服务:`sudo systemctl stop docker`
2.  将备份文件生成到临时目的地(安全练习)，如下:`cp -au /var/lib/docker /var/lib/docker.bk`
3.  更改存储驱动选项(如果找到的话)，或者将其添加到位于`vi /etc/docker/deamon.json`的配置守护程序文件中
4.  毕竟:开始你的服务。`sudo systemctl start docker`

## 设备映射器

经过上面的快速解释。设备映射器驱动程序仅支持 RHEL、CentOS 和 Oracle Linux 上的 Docker EE 以及其他 Linux 版本。

就像我之前说的，改变存储驱动会导致可用性的损失，为了“保证”功能和避免丢失应用程序数据，盲目地推荐保存你的容器。

为该驱动程序配置的另一件事是用于生产的`direct-lvm`模式，这与设置磁盘分区和逻辑卷的配置相关，以便配置连接到 Docker 主机的块设备。

深入解释的最佳资源是官方 Docker 文档。放轻松，这是一个中高级概念。

## 簇

Docker 集群存储和机器之间的数据共享之间存在直接关系，正如您所看到的，您应该记住，对于任何东西(即使是集群)，卷都是最推荐的结构，应该分布在主机上，这就是数据共享的优势所在。

这里有一个背景。

具有多个副本的应用程序需要访问一个唯一的或某个相同的文件，以保证所有节点上的信息。

这可以通过云提供商或卷驱动程序来实现，作为开发人员，您可以编写应用程序或将一些 API 端点暴露给外部存储解决方案。但是也有很多插件用于不同的服务和协议(甚至是授权)。

总的来说，这总是取决于您的设置、特性和软件所包含的功能。

这都是为了这个。这个小系列只是想让您对 Docker 中的卷和存储是如何工作的以及如何实现有一个直接而简单的了解。这都是我的经验之谈，如果你发现有什么不对的地方，请随时分享并改正。

快乐编码:)