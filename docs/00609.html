<html>
<head>
<title>Machine Learning Model Interpretability with Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python实现机器学习模型的可解释性。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-mearning-model-interpretability-with-python-1ad8e6a464d1?source=collection_archive---------2-----------------------#2019-08-15">https://medium.com/analytics-vidhya/machine-mearning-model-interpretability-with-python-1ad8e6a464d1?source=collection_archive---------2-----------------------#2019-08-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="2637" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">全面的实践指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/2bcd802a618dff4ed4d7cca4abd2f24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aSC3odScNMyz7Y6MZvqJ1Q.jpeg"/></div></div></figure><h2 id="2889" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">简介:</h2><p id="192a" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">机器学习改善任何业务的潜力不再是秘密。然而，我们建立的模型，大多数时候并没有解释为什么他们会对给定的样本做出某种预测，这对一些企业来说，是采用人工智能驱动战略的障碍。</p><p id="0930" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">在我之前的文章中，我们讨论了在生产环境中构建模型之前应该知道的15件事情。其中一个关键点强调了机器学习模型解释的重要性，以及它在一些业务中的重要性。</p><p id="3675" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">给定一个机器学习模型预测，<strong class="kj hj">“为什么”</strong>问题越来越成为需要回答的事情，为此，正在开发工具和软件包，将机器学习模型从黑盒变成白盒。</p><p id="ef26" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">在这篇文章中，我们将教授如何使用一个叫做<a class="ae lf" href="https://github.com/slundberg/shap" rel="noopener ugc nofollow" target="_blank"> SHAP </a>的工具来解释黑箱模型的预测。本教程中使用的数据是一个真实世界的数据集，即在<em class="lg"> UCI回购</em>中可用的<em class="lg">成人数据集</em>，该数据是关于<em class="lg"> </em>预测一个人的潜在收入是超过5万美元/年还是更少，所以让我们开始吧。</p><h2 id="4f10" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">加载和检查数据:</h2><p id="17ce" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">首先，我们将加载我们将在本教程中使用的必要库和数据:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="85a1" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">加载完数据后，让我们先看看它:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lj"><img src="../Images/c5b09e3b57ae1a6e97d31bd1b7e1f16d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-KEoLJRArVYulm9FGgS6A.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">成人数据集功能</figcaption></figure><p id="b7b7" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">现在，我们的目标功能是什么:</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="9859" class="jj jk hi lp b fi lt lu l lv lw">target : {False: 24720, True: 7841}</span></pre><p id="fe86" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">所以我们的目标是二元的，有真值或假值，真值表示个人收入超过5万美元，假值表示低于5万美元。</p><p id="72dd" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我们的预测器(特征)怎么样？让我们检查它们的类型:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="8af4" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">正如您所看到的，我们正在处理两种类型的特征:数字特征和分类特征。对于数字特征，它们都被设置好了。至于分类特征，我们首先要对它们进行预处理(编码)。</p><p id="a55f" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">对于这个项目，我们将保持简单，只是标签编码，但是有其他方法来处理分类特征，如嵌入或目标编码。为了更清楚地了解这一点，你可以查看我的教程:<a class="ae lf" rel="noopener" href="/@errabia.oussama/tensorflow-2-tutorial-on-categorical-features-embedding-93dd81027ea9"> tensorflow 2分类特征嵌入教程</a></p><h2 id="9adf" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">编码分类特征</h2><p id="affc" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">所以让我们开始编码:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="4537" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">正如您所注意到的，我们已经为每个分类特性创建了一个LabelEncoder，将它与该特性相匹配，然后将该特性转换为整数(对其进行编码)。我们还将编码器保存在字典中(保存它们是一个很好的做法)。</p><p id="78ca" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">现在我们的数据已经准备好了，让我们继续训练我们的LightGBM模型。</p><p id="63d5" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">首先，我们必须创建一个验证集，这样我们就可以评估我们训练好的模型的性能(我们不想花时间解释一个没有价值和糟糕分数的模型)。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="6df3" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我们使用sklearn.model_selection中的train_test_split函数将我们的数据分成一个训练集和一个值集。现在，我们可以移动以适应我们的模型。</p><p id="9330" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我们首先定义LightGBM模型的参数:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="820c" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">现在适合:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><h2 id="2fc7" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">评估:</h2><p id="0a6d" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">让我们观察我们的混淆矩阵，看看我们的模型做得如何:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lx"><img src="../Images/e109746045224ff21bf38bf16d6cbd69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8v2kEw5DmddEMmwt7WRWOA.png"/></div></div></figure><p id="31ef" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">让我们来计算我们的验证分数:</p><p id="9791" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">正类(大于50k $)的召回率和精确度:</p><blockquote class="ly lz ma"><p id="3985" class="kh ki lg kj b kk la ij km kn lb im kp mb lc kr ks mc ld ku kv md le kx ky kz hb bi translated">建议:最好的做法总是手动计算分数，而不是总是依赖于某个函数，你从头开始做得越多，你就越能理解它们，理解你的度量标准是至关重要的。</p></blockquote><p id="ece2" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated"><strong class="kj hj"> 1 —召回</strong>= TP/(TP+FN)= 1629/(1629+680)= 0.705(70%召回率)</p><p id="7afb" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated"><strong class="kj hj">解释</strong>:该模型能够预测70%的人属于阳性类(&gt; 50k$)</p><p id="2100" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated"><strong class="kj hj"> 2 —精度</strong>= TP/(TP+FP)= 1629/(1629+566)= 0.74(74%精度)。</p><p id="c3ff" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated"><strong class="kj hj">解释:</strong>该模型有74%的准确性，这意味着每个预测的真阳性有74%的概率是实际的真阳性。</p><p id="0fcc" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">对于一个不平衡的数据集来说，分数是相对较好的。在这种情况下，这两个类或多或少同等重要。另一方面，当在其他情况下，正类更重要时，需要做一些调整，以便有利于召回而不是精度，但这是另一篇文章的另一个教程，将在不久的将来发表。</p><h1 id="de97" class="me jk hi bd jl mf mg mh jp mi mj mk jt io ml ip jx ir mm is kb iu mn iv kf mo bi translated">模型诊断</h1><h2 id="8db1" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">了解SHAP:</h2><p id="d449" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">在我们开始解释我们的模型之前，让我们先解释一下我们将在研究中使用的工具:SHAP。</p><p id="e7cb" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">那么SHAP是如何运作的呢？让我解释一下(当然不要把事情复杂化):</p><p id="19ab" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">首先，我们需要解释一个术语，即<em class="lg">基值，</em>那么它是什么呢？</p><p id="96ef" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">基本值由SHAP公司内部使用，它只是训练集预测概率的平均值:</p><blockquote class="ly lz ma"><p id="d85e" class="kh ki lg kj b kk la ij km kn lb im kp mb lc kr ks mc ld ku kv md le kx ky kz hb bi translated">base _ value = NP . mean(lgbm _ model . predict _ proba(train)[:，1])</p></blockquote><p id="5b10" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">既然我们知道了什么是基础价值，让我们深入研究一下SHAP:</p><p id="9616" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">假设模型预测一个人拥有超过5万美元的概率为0.6，SHAP所做的是分解所有特征的(0.6- <em class="lg">基础值</em>)概率。同样，我们可以直观地看到哪些特征对该概率的贡献最大，并且请记住，在分解中，一些特征可能具有正值，而一些其他特征可能具有负值:</p><p id="fdaf" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">1-正值表示该特征增加了该实例向正类发展的概率(将该实例推向正类)。</p><p id="70f0" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">2-负值表示该特征降低了该实例向负类发展的概率(将该实例推向负类)。</p><p id="d344" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">现在我们已经了解了SHAP是如何工作的，让我们开始了解是什么驱动我们的模型使用它对给定的数据点进行特定的预测。</p><h2 id="93b2" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">SHAP全球模型解释:</h2><p id="3667" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">首先，对于给定数量的样本，我们将通过可视化特征对SHAP给出的预测概率的影响来观察模型的整体解释:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><blockquote class="ly lz ma"><p id="ede1" class="kh ki lg kj b kk la ij km kn lb im kp mb lc kr ks mc ld ku kv md le kx ky kz hb bi translated">备注:确保将model_output设置为“概率”,这样您将观察到的实际上是概率</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mp"><img src="../Images/35f1a4ad761ad14c1e84c78c9e5b3fe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eoZwTfZ0O-7ofzAArMzb7g.png"/></div></div></figure><p id="a73f" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">那么你如何解读这个图表呢？让我解释一下:</p><blockquote class="ly lz ma"><p id="1c18" class="kh ki lg kj b kk la ij km kn lb im kp mb lc kr ks mc ld ku kv md le kx ky kz hb bi translated">首先请记住:</p><p id="c755" class="kh ki lg kj b kk la ij km kn lb im kp mb lc kr ks mc ld ku kv md le kx ky kz hb bi translated">&gt; &gt; x代表shap值，</p><p id="c481" class="kh ki lg kj b kk la ij km kn lb im kp mb lc kr ks mc ld ku kv md le kx ky kz hb bi translated">&gt; &gt;这些点代表10个样品(每个样品都有一种颜色)</p></blockquote><p id="a996" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">上图可以这样描述:</p><p id="8fc3" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">首先—功能从上到下排列，功能越高意味着影响越大。(根据我们使用的10个实例中shap值的绝对值的平均值对它们进行排序)</p><p id="a62c" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">第二，我们拥有的特征集合对不同的样本产生不同的影响，有时它们通过增加概率做出贡献，而有时它们通过减少概率做出贡献。</p><p id="41f2" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">第三，通过可视化更多的实例，我们可以对一些特征及其预测能力以及它们通常倾向于哪个类别有一个全局的感觉。类似地，我们可以仔细检查模型对这些特性的了解是否有意义。</p><h2 id="6eb1" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">SHAP本地模型解释:</h2><p id="11ea" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">让我们对模型做一个局部的解释，换句话说，在样本层面:</p><p id="2f0f" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我们要做的是——</p><ul class=""><li id="688f" class="mq mr hi kj b kk la kn lb ju ms jy mt kc mu kz mv mw mx my bi translated">我们会随机抽取一个人，</li><li id="c1d3" class="mq mr hi kj b kk mz kn na ju nb jy nc kc nd kz mv mw mx my bi translated">检查它，它是真正的类，</li><li id="551a" class="mq mr hi kj b kk mz kn na ju nb jy nc kc nd kz mv mw mx my bi translated">检查由该模型预测的类别，</li><li id="f3f1" class="mq mr hi kj b kk mz kn na ju nb jy nc kc nd kz mv mw mx my bi translated">想象一下SHAP对那个例子的解释，</li><li id="0c0e" class="mq mr hi kj b kk mz kn na ju nb jy nc kc nd kz mv mw mx my bi translated">通过比较真实类、预测和shap所说的内容，得出结论。</li></ul><p id="ee27" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">让我们开始吧。</p><p id="5d35" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">让我们以这个人为例:</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="41db" class="jj jk hi lp b fi lt lu l lv lw">Age                  32.0<br/>Workclass             4.0<br/>Education-Num        13.0<br/>Marital Status        2.0<br/>Occupation           13.0<br/>Relationship          0.0<br/>Race                  4.0<br/>Sex                   1.0<br/>Capital Gain      15024.0<br/>Capital Loss          0.0<br/>Hours per week       40.0<br/>Country              39.0<br/>Name: 2631, dtype: float64   </span></pre><p id="ae34" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我们的模型预测此人年收入超过50，000美元，根据真实标签，这是一个正确的预测，因此让我们检查一下我们的特征是如何促成这一预测的:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ne"><img src="../Images/847ece2abccbf33027e91f42a37e7c8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_U5KKTUH1xndfSqeaMLoEA.png"/></div></div></figure><p id="c0c1" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">如您所见，基值(模型起点)为0.26，因此shap将对所有要素进行1–0.263 = 0.737的分解。此外，如您所见，资本收益是该概率的最大贡献者，其值为+0.49，这对于15024的高资本收益是有意义的。也32岁也说得通，也该受教育了——小水。</p><p id="8730" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">结论:在这种情况下，预测是正确的，给定特征值，一切都有意义，因此模型做得很好。</p><p id="c8da" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">然而，根据我的经验，真正的洞察力来自于分析错误标记的实例。因此，让我们做一些真正的检查，看看一个假阴性样本(一个样本应该有类阳性，但模型预测类阴性)，看看是否有一些关于模型的解释。</p><p id="625a" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我们将使用以下代码提取所有假阴性样本:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="686d" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">现在让我们检查这些false_negative实例的一个实例:</p><blockquote class="ly lz ma"><p id="0476" class="kh ki lg kj b kk la ij km kn lb im kp mb lc kr ks mc ld ku kv md le kx ky kz hb bi translated">提醒:对于此人，模型预测了类别“<usd but="" the="" actual="" class="" is=""> USD 50K”</usd></p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/4f147e873df7b458c46d9aba6877a484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYHU7RZ59IAw3BP3bkpGDQ.png"/></div></div></figure><p id="0d97" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">好的，非常有趣，让我们说出上面的输出:</p><p id="b1fc" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">模型已经预测了0.36的概率，0.263来自于base_value，至于其余的，来自于特性的贡献。</p><p id="4113" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">因此，如图所示，婚姻状况、年龄、关系和性别对预测有积极影响，这意味着他们正在将样本推向正确的方向，其概率大于0.5。</p><p id="8d47" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">相反，资本收益、受教育程度和职业则相反，它们会产生负值，从而降低概率。</p><p id="c7e9" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">现在我们能从这说些什么呢？</p><p id="6c82" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">首先，考虑到资本收益，将实例设为负类是有意义的，因为该特性的值为0，并且影响不大，所以我想这是可以的。</p><p id="10c9" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">现在对于职业，最大的负贡献者，我们有一个值7，通过使用我们的LabelEncoder我们得到“7 =机器-操作-检查:机器操作员检查员”。从我们的培训数据来看，我们的培训数据中有1387人从事该职业:其中1209人的收入低于5万美元，只有178人的收入超过5万美元。因此，当职业采用该值时，这种没有特征工程的基本模型做出这样的行为并做出负面贡献(推向负面类别)是有意义的，然而，这是在改进模型时要记住的重要见解。</p><p id="a6b3" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">如你所见，这就是模型诊断和解释如此重要的原因，这里列出一些显而易见的结论:</p><p id="cb3c" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">1 —它让你<strong class="kj hj">信任</strong>这个模型，因为现在你正在检查它的预测，并再次检查它们是否有意义(一个评估分数肯定是不够的)。和我们上面做的一样。</p><p id="2fc9" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">2-它让你<strong class="kj hj">洞察</strong>未来的改进，因为它帮助你诊断模型哪里出了问题。和我们上面做的一样。</p><p id="54bb" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">3-它为您提供预测报告，这在一些业务中是必不可少的，当需要根据预测采取行动时(例如，如果模型显示客户将离开，您确实想让公司知道该客户决定背后的原因，而这项研究将帮助您做到这一点)。</p><p id="1445" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">因此，我们将停止本教程在这一点上，现在，更多的章节将在未来的主题。毫无疑问，SHAP是一个很棒的工具，除了我们上面使用的功能之外，它还有更多的功能可以检查，比如依赖图，我们将在未来的学习课程中尝试覆盖它。</p><p id="2fca" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">我希望你觉得这篇教程非常有见地和实用，我希望在读完所有这些文字后，你现在感觉自己是一个更好的数据科学家。</p><p id="8157" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">这是完整Jupyter笔记本的<a class="ae lf" href="https://github.com/oussamaErra/machine-learning-interpretation/blob/master/know%20your%20model.ipynb" rel="noopener ugc nofollow" target="_blank">代码，用于重现上述结果。</a></p><p id="76c5" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">下次告诉我，同时如果你有任何问题要问我，或者你对未来的教程有什么建议，我的联系方式在下面。</p><h1 id="cc7a" class="me jk hi bd jl mf mg mh jp mi mj mk jt io ml ip jx ir mm is kb iu mn iv kf mo bi translated">关于我</h1><p id="1a38" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp ju kq kr ks jy kt ku kv kc kw kx ky kz hb bi translated">我是@ <a class="ae lf" href="https://www.cleverecommerce.com/" rel="noopener ugc nofollow" target="_blank">智能电子商务公司</a>的首席数据科学家，我们利用基于人工智能的强大技术，帮助企业创建和管理谷歌广告活动。</p><p id="b95f" class="pw-post-body-paragraph kh ki hi kj b kk la ij km kn lb im kp ju lc kr ks jy ld ku kv kc le kx ky kz hb bi translated">你可以通过链接的<a class="ae lf" href="https://www.linkedin.com/in/oussama-errabia-0b1a14b3/" rel="noopener ugc nofollow" target="_blank">或Gmail:errabia.oussama@gmail.com联系我。</a></p></div></div>    
</body>
</html>