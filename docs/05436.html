<html>
<head>
<title>HTTP Client with Node.JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有节点的HTTP客户端。射流研究…</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/http-client-with-node-js-c94f75f11c2a?source=collection_archive---------4-----------------------#2020-04-21">https://medium.com/analytics-vidhya/http-client-with-node-js-c94f75f11c2a?source=collection_archive---------4-----------------------#2020-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/cde6de9230aeadd26a09f399f5feb1b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LomlN9X9qOodvrqj.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://db.httpandssl.com/t/what-is-http-a-brief-introduction/30" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><div class=""/><p id="347a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如何执行简单的GET和POST请求</p><p id="b8dd" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在构建web应用程序时，我们经常希望向其他服务发出HTTP请求。</p><blockquote class="jt ju jv"><p id="0177" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">为了做出这样的请求，我们使用核心模块'<strong class="ix hz"> http </strong>'。该模块使用<a class="ae hv" rel="noopener" href="/analytics-vidhya/event-emitters-in-node-js-d93084441974">事件发射器</a>模式</p></blockquote><h1 id="26b1" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">简单的GET请求</h1><blockquote class="jt ju jv"><p id="894a" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">GET请求是指我们从服务器获得的请求</p></blockquote><p id="40e0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有两种方法可以做到这一点，</p><h2 id="adc5" class="ky kb hy bd kc kz la lb kg lc ld le kk jg lf lg ko jk lh li ks jo lj lk kw ll bi translated">1.没有缓冲</h2><p id="d1be" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">一次向终端打印一行新的响应。</p><p id="dc06" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对代码的解释在评论中</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="71ba" class="ky kb hy lw b fi ma mb l mc md">const http = require('http') //require http core module<br/>const url = "http://nodeprogram.com" //url to get data</span><span id="ac82" class="ky kb hy lw b fi me mb l mc md">//perform GET request<br/>http.get(url, (response) =&gt; {<br/>response.on('data',(chunk)=&gt; { //on data event(we are getting data) //,perform the function<br/>console.log(chunk.toString('utf8')<br/>})</span><span id="c44c" class="ky kb hy lw b fi me mb l mc md">response.on('end' ,()=&gt; { //all of the data has been recieved<br/>console.log("response has ended")</span><span id="5eda" class="ky kb hy lw b fi me mb l mc md">})<br/>.on('error' , (error)=&gt; { //error with the request<br/>console.log(error.message) //print error in case error received<br/>})</span></pre><h2 id="a8ab" class="ky kb hy bd kc kz la lb kg lc ld le kk jg lf lg ko jk lh li ks jo lj lk kw ll bi translated">2.带缓冲器</h2><p id="df9f" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">接收到的数据被一次性打印<strong class="ix hz"/></p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="c2cf" class="ky kb hy lw b fi ma mb l mc md">const http = require('http')</span><span id="6853" class="ky kb hy lw b fi me mb l mc md">const url = 'http://nodeprogram.com' //URL to send data to<br/></span><span id="123b" class="ky kb hy lw b fi me mb l mc md">//perform get request<br/>http.get(url, (response) =&gt; {</span><span id="6510" class="ky kb hy lw b fi me mb l mc md">let rawData = '' //save all the data in this variable</span><span id="e8d1" class="ky kb hy lw b fi me mb l mc md">response.on('data', (chunk) =&gt; {</span><span id="f02e" class="ky kb hy lw b fi me mb l mc md">rawData += chunk //all new lines are saved here</span><span id="ae41" class="ky kb hy lw b fi me mb l mc md">})<br/></span><span id="5868" class="ky kb hy lw b fi me mb l mc md">response.on('end', () =&gt; {</span><span id="b14e" class="ky kb hy lw b fi me mb l mc md">console.log(rawData) //print out data once request is completed</span><span id="199a" class="ky kb hy lw b fi me mb l mc md">})</span><span id="193c" class="ky kb hy lw b fi me mb l mc md">})<br/>.on('error', (error) =&gt; {</span><span id="87ab" class="ky kb hy lw b fi me mb l mc md">console.error(`Got error: ' + error.message)</span><span id="7524" class="ky kb hy lw b fi me mb l mc md">})</span></pre></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><h2 id="bf32" class="ky kb hy bd kc kz la lb kg lc ld le kk jg lf lg ko jk lh li ks jo lj lk kw ll bi translated">步伐</h2><figure class="lr ls lt lu fd hk er es paragraph-image"><div class="er es mm"><img src="../Images/31201b8c6ab8a66fccc182e58fb1266c.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/0*v4p1vO23N4Yzi1Lj"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">资料来源:阿扎特·马尔丹关于EDX的NodeJS课程简介</figcaption></figure><h2 id="c8b5" class="ky kb hy bd kc kz la lb kg lc ld le kk jg lf lg ko jk lh li ks jo lj lk kw ll bi translated">在缓冲变量中保存数据的用例是什么？</h2><p id="a42d" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">这个用例在解析JSON文本时很实用。让我们在下一节做吧</p></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><h2 id="a7df" class="ky kb hy bd kc kz la lb kg lc ld le kk jg lf lg ko jk lh li ks jo lj lk kw ll bi translated">解析JSON数据</h2><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="0751" class="ky kb hy lw b fi ma mb l mc md">const https = require('https')</span><span id="0b76" class="ky kb hy lw b fi me mb l mc md">const url = 'https://gist.githubusercontent.com/azat-co/a3b93807d89fd5f98ba7829f0557e266/raw/43adc16c256ec52264c2d0bc0251369faf02a3e2/gistfile1.txt' //JSON  text</span><span id="92d5" class="ky kb hy lw b fi me mb l mc md">https.get(url, (response) =&gt; {</span><span id="c165" class="ky kb hy lw b fi me mb l mc md">let rawData = ''</span><span id="5789" class="ky kb hy lw b fi me mb l mc md">response.on('data', (chunk) =&gt; {</span><span id="d6ac" class="ky kb hy lw b fi me mb l mc md">rawData += chunk</span><span id="2cd2" class="ky kb hy lw b fi me mb l mc md">})<br/></span><span id="e33a" class="ky kb hy lw b fi me mb l mc md">response.on('end', () =&gt; { //when request completes,</span><span id="f202" class="ky kb hy lw b fi me mb l mc md">try {</span><span id="a648" class="ky kb hy lw b fi me mb l mc md">const parsedData = JSON.parse(rawData) //function for parsing data </span><span id="aca9" class="ky kb hy lw b fi me mb l mc md">console.log(parsedData) //print out data</span><span id="f205" class="ky kb hy lw b fi me mb l mc md">} catch (e) {</span><span id="4dd6" class="ky kb hy lw b fi me mb l mc md">console.error(e.message) //print out error </span><span id="4e67" class="ky kb hy lw b fi me mb l mc md">}</span><span id="2753" class="ky kb hy lw b fi me mb l mc md">})</span><span id="5840" class="ky kb hy lw b fi me mb l mc md">})<br/>.on('error', (error) =&gt; {</span><span id="5cdf" class="ky kb hy lw b fi me mb l mc md">console.error(`Got error: ' + error.message)</span><span id="3484" class="ky kb hy lw b fi me mb l mc md">})</span></pre><p id="5d7c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">解析需要在<em class="jw"> try/catch块</em>内部进行，以处理由于JSON输入格式错误</strong>而可能发生的任何故障</p></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><h1 id="719a" class="ka kb hy bd kc kd mn kf kg kh mo kj kk kl mp kn ko kp mq kr ks kt mr kv kw kx bi translated">简单的发布请求</h1><blockquote class="jt ju jv"><p id="91c3" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">POST请求是指我们<strong class="ix hz">向服务器发送</strong>请求。</p></blockquote><p id="0f68" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">举个例子，让我们向<em class="jw">mockbin.com</em>发送数据，然后从站点接收响应。</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="efd3" class="ky kb hy lw b fi ma mb l mc md">const http = require('http')</span><span id="9d26" class="ky kb hy lw b fi me mb l mc md">const postData = JSON.stringify({ foo: 'bar' })</span><span id="c1b7" class="ky kb hy lw b fi me mb l mc md">//define options for requests<br/>const options = {</span><span id="17a7" class="ky kb hy lw b fi me mb l mc md">hostname: 'mockbin.com',</span><span id="084f" class="ky kb hy lw b fi me mb l mc md">port: 80,</span><span id="0f52" class="ky kb hy lw b fi me mb l mc md">path: '/request?foo=bar&amp;foo=baz',</span><span id="0987" class="ky kb hy lw b fi me mb l mc md">method: 'POST',</span><span id="936e" class="ky kb hy lw b fi me mb l mc md">headers: {</span><span id="c15c" class="ky kb hy lw b fi me mb l mc md">'Content-Type': 'application/x-www-form-urlencoded',</span><span id="f973" class="ky kb hy lw b fi me mb l mc md">'Content-Length': Buffer.byteLength(postData)</span><span id="edbd" class="ky kb hy lw b fi me mb l mc md">}</span><span id="bad3" class="ky kb hy lw b fi me mb l mc md">}</span><span id="4aad" class="ky kb hy lw b fi me mb l mc md">//define request</span><span id="8ba1" class="ky kb hy lw b fi me mb l mc md">const req = http.request(options, (res) =&gt; {</span><span id="140f" class="ky kb hy lw b fi me mb l mc md">res.on('data', (chunk) =&gt; {</span><span id="b1c4" class="ky kb hy lw b fi me mb l mc md">console.log(`BODY:` + chunk) //receive response</span><span id="45a9" class="ky kb hy lw b fi me mb l mc md">})</span><span id="0c7a" class="ky kb hy lw b fi me mb l mc md">res.on('end', () =&gt; {</span><span id="d784" class="ky kb hy lw b fi me mb l mc md">console.log('No more data in response.')</span><span id="bd6f" class="ky kb hy lw b fi me mb l mc md">})</span><span id="6423" class="ky kb hy lw b fi me mb l mc md">})</span><span id="deb9" class="ky kb hy lw b fi me mb l mc md">req.on('error', (e) =&gt; {</span><span id="8f67" class="ky kb hy lw b fi me mb l mc md">console.error(`problem with request: ${e.message}`)</span><span id="67c6" class="ky kb hy lw b fi me mb l mc md">})</span><span id="bff3" class="ky kb hy lw b fi me mb l mc md">req.write(postData) //send data to the server</span><span id="920f" class="ky kb hy lw b fi me mb l mc md">req.end()</span></pre></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><h1 id="25ed" class="ka kb hy bd kc kd mn kf kg kh mo kj kk kl mp kn ko kp mq kr ks kt mr kv kw kx bi translated">上传并删除</h1><p id="c9e8" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">这些请求使用相同的POST请求格式，只是相应地更改了<strong class="ix hz"><em class="jw">options . method</em></strong>的值</p></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><p id="b6af" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在接下来的文章中，我们将使用Node.JS制作HTTP服务器，感谢您的阅读。回头见！</p></div></div>    
</body>
</html>