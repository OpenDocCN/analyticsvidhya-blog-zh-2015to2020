<html>
<head>
<title>Convolutional Neural Networks and Backpropagation using Numpy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卷积神经网络和使用Numpy的反向传播</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/convolutional-neural-networks-and-backpropagation-using-numpy-4da2c9d14fdd?source=collection_archive---------1-----------------------#2019-09-28">https://medium.com/analytics-vidhya/convolutional-neural-networks-and-backpropagation-using-numpy-4da2c9d14fdd?source=collection_archive---------1-----------------------#2019-09-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ba70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧！我们开始吧..</p><p id="78bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我准备了这个故事，试图模拟一个卷积神经网络，并通过反向传播仅使用numpy更新它。</p><p id="3901" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有这些背后的想法是为了进一步理解反向传播。</p><p id="378a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我开始之前，我想否认以下声明:</p><p id="b905" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.我不打算在这个时候建立最精确的模型，因为这个想法是解开反向传播。</p><p id="c37d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.运行所有这些将会消耗你大量的内存，而且会花很长时间，主要是因为我想在我的编码中更具教学性，并且使用大量的for循环。所以我为效率不高道歉，但这并不是我在这个内核中的真正目标。</p><p id="49b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这个故事，我将使用古老而著名的MNIST数据(神经网络的hello world)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f03b975cad3fb1b650b8d29a99caffd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQrczw14t_brypOVbaTWRg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/5765dff0c5382c5de16fc94bf5bdef9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHm5OrrNZdrwSGrpi4jnCg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/456887e6e8756471d2faa1753431825c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdWadNLvIQBPqailfbTkdQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jr"><img src="../Images/cf0762301710098305bf05c41cbfcae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Js7EWjl3DLoA-34kHFcpBg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es js"><img src="../Images/9720d5a9c81a3c947beeda7d4c7dd452.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybct_jU3EmiD8_aoNUiQBw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/bc30bc12c3607479a0d9bc2a2b527ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*um_YFF7j3F_0TlB6techMQ.png"/></div></div></figure><p id="c24f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在数据已经被加载和转换了，是时候为我们的神经网络建模了。</p><p id="f6de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个练习中，我将使用以下架构:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ju"><img src="../Images/80f25e8aa308eab7e00fd11c826fff63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZVn8KqyFBa2i7ybBqkouBA.png"/></div></div></figure><p id="2660" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义计算卷积向前传递的函数</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jv"><img src="../Images/185f52d0987e38daa23a434665c83e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*agHV12fP5KU7R_Tlr97ikA.png"/></div></div></figure><p id="5ab4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义计算最大池向前传球的函数</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/d427b30af7514c1ee34d61efbc275040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HLZ9760-cS7vvrbpZy5MAQ.png"/></div></div></figure><p id="6f96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义计算压平前进刀路的功能</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/9fc19e6b328121f054069a7f5e473932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdYvaeEiCMNYtea3uom9VQ.png"/></div></div></figure><p id="00d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义计算密集向前传球的函数</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jy"><img src="../Images/92bea57a89c7198fcab0952a8a5a520f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*puheoxbozeWWrphvbkNIZA.png"/></div></div></figure><p id="f728" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义用于计算向前传递的最终输出的函数</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jz"><img src="../Images/9770c22ebc11b0afd91abe4f7d349ce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wnbDpqd0lgzriX1zFqDvSg.png"/></div></div></figure><p id="ebcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义损失函数的计算</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ka"><img src="../Images/21df330906ffb64823b2d6bda8fb6d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_vFs6dXwY-7Ks2PQ9Fa2fw.png"/></div></div></figure><p id="efaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的。现在，对那些还和我在一起的人来说，棘手的部分来了。<br/>我们现在已经定义了在我们的CNN模型中进行一次向前传递所需的所有函数。<br/>为了让我们的模型学习，我们需要定义反向传播函数。</p><p id="3a0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所知，反向传播使用偏导数和梯度下降来更新参数(权重和偏差)，以便将损失降至最低，从而进行学习。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="32ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你对这个问题有疑问，我鼓励你去youtube上看看3blue1brown、Siraj Raval和吴恩达的资料。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kd kc l"/></div></figure><p id="f686" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输出层反向传播</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ke"><img src="../Images/9da89337851b3e137020b7a57cfdf692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RSjbGHaivU8l044-gWWUA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/24fd31455c51c4863beeb5264b6060d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VCdZTv3Yh33CCHfMuCXH6g.png"/></div></div></figure><p id="5b44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">展平图层反向传播</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kg"><img src="../Images/8d16354ee82c4dc76566f325b157bf46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NaGzsli9xNfcV7EO3FSyRQ.png"/></div></div></figure><p id="6640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最大池层反向传播</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/a841735dfda60755e85ef31a95b487e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyStcnN-53DaohFVRNKdkQ.png"/></div></div></figure><p id="e9b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">卷积层反向传播</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/9879963caaa7e391072164f42aa37565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F8FngdCH88ToyOQghIQNRQ.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ki kc l"/></div></figure><p id="6a10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，最糟糕的部分(或者最好的部分，如果你喜欢这个东西)已经过去了。既然已经声明了所有的函数，我们就可以开始训练我们的数据了。</p><p id="c867" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们必须定义一个新的函数..所有功能之母..</p><p id="e43f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“一个功能是统治他们，一个功能是发现他们，一个功能是把他们带到一起，在黑暗中把他们绑起来”</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kj kc l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/d526da8a766a7375836d34690f1c184a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yT9vWkBmwU028NYbcRQ63w.png"/></div></div></figure><p id="6594" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">行..现在一切准备就绪。让我们开始训练吧</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/91ff4f6e9ec5726895b6af6437b75a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_BpLqs-f-qpQ5pl7fp2oQ.png"/></div></div></figure><p id="9e54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过长时间的训练，测试模型的准确率从14.8%提高到37.7%。我已经停止了，因为学习的速度非常慢，改进需要更多的时间。虽然准确性不是很高，但编码证明了模型正在学习(这毕竟是目标)。</p><p id="3e63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望它是有用的，感谢阅读！</p><p id="c42c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果有人想使用代码，可以在我在Kaggle的个人资料中找到</p><p id="8f74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kl" href="https://www.kaggle.com/kmaciver" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/kmaciver</a></p></div></div>    
</body>
</html>