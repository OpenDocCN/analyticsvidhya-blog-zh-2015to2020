<html>
<head>
<title>How to make Face Recognition with Tensorflow 2 and Data scraping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Tensorflow 2和数据抓取进行人脸识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-make-face-recognition-with-tensorflow-2-and-data-scraping-fac960445e56?source=collection_archive---------4-----------------------#2020-01-10">https://medium.com/analytics-vidhya/how-to-make-face-recognition-with-tensorflow-2-and-data-scraping-fac960445e56?source=collection_archive---------4-----------------------#2020-01-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="ad4e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇文章中，我们将使用自己的数据集(是的，我们将使用我的一个刮刀来创建数据集)来构建人脸识别系统，并从零开始建模，无需任何预先训练的模型或其他人的数据。你可以在这里找到相同<a class="ae jk" href="https://github.com/iamatulsingh/Face_Recognition_Tensorflow" rel="noopener ugc nofollow" target="_blank">的代码</a></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/f27ecf8bf67014e74a1211701e8e2f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TUDvbrORR71YKyRErc8QKA.jpeg"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">人脸识别</figcaption></figure><p id="c2ef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先克隆并使用下面的命令创建数据集。Scraper的名字是“pinterest ”,因为它从那里下载图片。请检查代码以获取更多信息。</p><div class="kb kc ez fb kd ke"><a href="https://github.com/iamatulsingh/pinterest-image-scrap/blob/master/pinterest.py" rel="noopener  ugc nofollow" target="_blank"><div class="kf ab dw"><div class="kg ab kh cl cj ki"><h2 class="bd hj fi z dy kj ea eb kk ed ef hh bi translated">iamatulsingh/Pinterest-图像-废料</h2><div class="kl l"><h3 class="bd b fi z dy kj ea eb kk ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="km l"><p class="bd b fp z dy kj ea eb kk ed ef dx translated">github.com</p></div></div><div class="kn l"><div class="ko l kp kq kr kn ks jv ke"/></div></div></a></div><pre class="jm jn jo jp fd kt ku kv kw aw kx bi"><span id="d9e1" class="ky kz hi ku b fi la lb l lc ld">git clone <a class="ae jk" href="https://github.com/iamatulsingh/pinterest-image-scrap.git" rel="noopener ugc nofollow" target="_blank">https://github.com/iamatulsingh/pinterest-image-scrap.git</a><br/>python3 <a class="ae jk" href="https://github.com/iamatulsingh/pinterest-image-scrap.git" rel="noopener ugc nofollow" target="_blank">pinterest</a>.py</span></pre><p id="c16b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">之后你会在屏幕上看到类似这样的东西。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es le"><img src="../Images/66d98ff422a7b4d3d30451f0856d5fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*616_ecRPfCq8r7GCeG5MQQ.png"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lf"><img src="../Images/aa8ea796bda9549bc6f7423f4e4f0ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uh_akY9rtaTVUwFMjeQWTQ.png"/></div></div></figure><p id="3f64" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">于是我们刮出了“莱昂内尔·梅西”的影像资料。就像这样，你想刮多少就刮多少。同样，在完成抓取部分后，只需在项目的根目录下创建一个文件夹，并给它命名为“people”。把你所有刮下来的文件夹都存进去。现在这只是一个初始步骤，我们必须从图像中裁剪出人脸，因为我们正在创建人脸识别，所以我们希望只在人脸上训练我们的模型，而不是图像中的其他事物，为此我们将在代码中使用“<a class="ae jk" href="https://github.com/ipazc/mtcnn" rel="noopener ugc nofollow" target="_blank"> MTCNN </a>”。</p><p id="7f35" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建一个文件名为“<a class="ae jk" href="https://gist.github.com/iamatulsingh/390d4a54b8236b6e76c1914a0c5f65dd#file-face_detection_operation-py" rel="noopener ugc nofollow" target="_blank">face _ detection _ operation . py</a>”的文件，并将下面的代码复制粘贴到其中。这个文件将帮助我们清理数据。所以只要使用命令“python 3<a class="ae jk" href="https://gist.github.com/iamatulsingh/390d4a54b8236b6e76c1914a0c5f65dd#file-face_detection_operation-py" rel="noopener ugc nofollow" target="_blank">face _ detection _ operation . py</a>运行这个文件，它就会将图像中的所有人脸保存到数据集文件夹中。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="5823" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如你所见，这里有两种方法。1)“保存_裁剪_面”和2)“获取_检测_面”。我们将使用方法1，即“save_cropped_face”用于从刮擦的图像中裁剪面部，而“get_detected_face”用于我们的模型预测。</p><p id="fbe4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们将创建我们的模型。再次复制粘贴以下代码到新的文件名“模型. py”。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="lg lh l"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es li"><img src="../Images/646a95cc336df01474b0dd03503bdd59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*IJL9CX_8Lg_SnBxRXlr_lA.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">模型摘要</figcaption></figure><p id="aaaf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了简单起见，我们将创建“face_recognition.py ”,它将包含我们与训练和预测相关的所有代码，以便我们可以将它导入主文件中，只需调用它的方法，我们就可以训练和测试模型。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="395a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">必须创建一个文件名“main.py ”,并将以下代码复制粘贴到其中。这个文件将是我们将要执行的用于培训和测试的文件。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="77df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">训练后，我们可以检查我们的模型准确性。仅仅过了50个纪元就相当不错了。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lj"><img src="../Images/c3823f3e0d77656d9e145d9f16b0493f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*6Vx8gNQVCvURWqR-7GjDOg.png"/></div></figure><p id="fd67" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们看看我们模型的预测。我已经创建了一个“梅西、c罗(CR7)和小内马尔”的数据集，所以让我们来测试一下。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lf"><img src="../Images/508213ba77c740ee1715a4026cbf9a95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYDPDanAJbAH8a4jkSmMbA.jpeg"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">test.jpg</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lf"><img src="../Images/2ab91243cecce24908dd00fc99f30f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8qEkj8CQI-KY4HuEd7oLeg.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">预测结果</figcaption></figure><p id="abe6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">瞧啊。！！，你就用自己的数据集创建了自己的机器学习模型，用于人脸识别。</p><p id="441c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你喜欢这篇文章或者你有任何建议/反馈，请在这里评论。祝你有美好的一天😃。</p></div></div>    
</body>
</html>