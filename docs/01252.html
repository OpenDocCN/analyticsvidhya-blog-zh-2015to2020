<html>
<head>
<title>Why Data Scientists need NumPy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么数据科学家需要NumPy</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/why-data-scientists-need-numpy-6fefb751dd4c?source=collection_archive---------19-----------------------#2019-10-10">https://medium.com/analytics-vidhya/why-data-scientists-need-numpy-6fefb751dd4c?source=collection_archive---------19-----------------------#2019-10-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/49d9c44515aacfbea5f65929620a2ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzSeXY6XAqDDzNpNuMoQRg.png"/></div></div></figure><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/49d9c44515aacfbea5f65929620a2ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzSeXY6XAqDDzNpNuMoQRg.png"/></div></div></figure><div class=""/><p id="27c6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从事Python工作的数据科学家需要NumPy。但是为什么呢？</p><p id="8b9b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了理解NumPy对数据科学家的重要性，我们需要理解面向数组的计算。</p><h2 id="b752" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">什么是面向阵列的计算？</h2><p id="f1c0" class="pw-post-body-paragraph iu iv hx iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr hb bi translated">面向数组的计算允许一次将一个函数应用于一组完整的值。像R、MATLAB、Julia这样的语言支持数组计算，而Python本身不支持面向数组的计算。</p><p id="1864" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在Python中，我们一次操作一个标量。要转换列表中的所有值，我们需要遍历列表并对列表中的每个值执行操作。这种行为使得Python很慢，很难处理大量数据，数据分析和机器学习也很麻烦。</p><p id="2690" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">幸运的是，Python有NumPy扩展。它使我们能够使用Python中的数组计算功能。如果我们想用Python工作，这对数据科学的所有方面都至关重要，像Pandas和SciPy这样的基本库都是建立在NumPy之上的，依靠它快速高效的方式来处理数学运算。</p><h2 id="2ed3" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">为什么NumPy效率更高？</h2><h2 id="5048" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">在幕后，NumPy的许多功能都是用c语言编写的。</h2><p id="0fed" class="pw-post-body-paragraph iu iv hx iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr hb bi translated">C是一种编译语言:完成的C代码被翻译成机器代码，程序随时准备好与机器进行交互。</p><p id="8fe1" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">另一方面，Python是一种解释型语言:每次我们运行程序时，解释器都将Python代码一步一步地翻译成可执行的字节码。Python代码没有运行前翻译。</p><p id="e541" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因为NumPy的C组件在我们运行它们之前已经被编译成机器代码，所以NumPy操作比使用Python执行同样的操作要快得多。</p><h2 id="44d9" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">NumPy数组:</h2><p id="4137" class="pw-post-body-paragraph iu iv hx iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr hb bi translated">c也是NumPy可以在NumPy数组中存储数据的原因，NumPy数组是一种针对数组计算优化的结构。</p><p id="360a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">NumPy数组包含数据及其对应的元数据。元数据包括数组的维数和形状，以及数据的类型。数据和元数据最佳地存储在系统存储器的数据缓冲区中。</p><p id="28b7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">相比之下，Python结构就像列表一样，分散在系统内存中。</p><p id="bf12" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这种结构差异使得NumPy数组在大小和性能方面比列表更有效。</p><p id="a514" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们来看一些例子。</p><h2 id="e50b" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">尺寸比较</h2><p id="5aa3" class="pw-post-body-paragraph iu iv hx iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr hb bi translated">为了获得元素的大小，我们从sys:</p><div class="hh hi ez fb hj la"><a href="https://docs.python.org/3/library/sys.html#module-sys" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hy fi z dy lf ea eb lg ed ef hw bi translated">sys —特定于系统的参数和函数— Python 3.7.4文档</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">该模块提供了对解释器使用或维护的一些变量的访问，以及对交互…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">docs.python.org `文件</p></div></div></div></a></div><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lj"><img src="../Images/afb79e9d6c1470f7bea5764625df9efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwmuO4aXsTZs1Lx4rWt-xA.png"/></div></div></figure><p id="ac3b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们创建一个Python列表py_list和一个NumPy数组np_array，两者都包含100，000个值:</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lk"><img src="../Images/8a982875d11624962cb77c8215b7585b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGBcH39eo9MDzzPNWmKLeA.png"/></div></div></figure><p id="e248" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们看看这些物品的尺寸:</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ll"><img src="../Images/6f5dace43af4ee85b4dc1adaab8fd446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0G9ICbXNjb3pLR5YdQE7Hw.png"/></div></div></figure><p id="4073" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这使得我们的Python列表比NumPy数组大100016字节，尽管两者包含相同的数据。在处理大量数据时，这会带来显著的不同！</p><h2 id="3826" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">速度比较</h2><p id="5d8b" class="pw-post-body-paragraph iu iv hx iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr hb bi translated">接下来让我们看看计算速度。</p><p id="7891" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我将使用神奇的命令%%timeit来测量代码的执行时间。</p><div class="hh hi ez fb hj la"><a href="https://docs.python.org/2/library/timeit.html" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hy fi z dy lf ea eb lg ed ef hw bi translated">26.6.timeit —测量小代码片段的执行时间— Python 2.7.16文档</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">源代码:Lib/timeit.py这个模块提供了一种简单的方法来为小部分Python代码计时。它既有…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">docs.python.org</p></div></div></div></a></div><p id="bee1" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，让我们对py_list中的每个项目求平方，使用list comprehension遍历列表并转换项目:</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lm"><img src="../Images/47a2e0a5f1a612dded1a6acac6358c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KFmTB06dkyqtUpGA7AL_Ag.png"/></div></div></figure><p id="6b57" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">执行时间为22.8毫秒</p><p id="0f22" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们用同样的方法变换我们的数组np_array。因为NumPy允许矢量化，所以我们可以在数组上调用**2，NumPy同时计算数组中每一项的平方值</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ln"><img src="../Images/fd18ccb2f8e027eff698bf8739ef6917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_muYhDNw5wgCSc_oI-RIA.png"/></div></div></figure><p id="0910" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">执行时间为41.2秒。</p><p id="cbb7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用NumPy数组和向量化计算，执行时间为553(！！！)比遍历列表快两倍。</p><h2 id="f923" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">熊猫</h2><p id="a6cd" class="pw-post-body-paragraph iu iv hx iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr hb bi translated">让我们看看这是否也适用于熊猫的数据框架。<br/>首先，我们需要导入熊猫并创建一个数据框架:</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lo"><img src="../Images/5ac472bed5d7a0522147eb8ea07d5197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZnv_0EwhgVFT9k4JAetaQ.png"/></div></div></figure><p id="17de" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在让我们计算一下对df的一列执行矢量化操作需要多长时间:</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lp"><img src="../Images/3bb287b0ce6713c0bccb422587d80e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wOaO7Tti-N5qwJH-KOKtLA.png"/></div></div></figure><p id="c68d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">733 s。</p><p id="4f95" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">好了，现在让我们测试一下如果我们使用df.itterows遍历数据帧需要多长时间。</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ln"><img src="../Images/10257551c051d55557d4deb5420a5abd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Co0GfgegnATcRgNQVGPaTQ.png"/></div></div></figure><p id="8439" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">6.08秒！！！与第一个例子相比，这是一个永恒！想象一下，如果我们遍历一个大数据框架，会有什么后果。</p><p id="a32b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，遍历数据帧可能不是一个好主意。<br/>但是，如果我们想对你的df值进行复杂的运算呢？比如用一个函数对它们进行变换？</p><p id="4a19" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">熊猫有一个内置的函数可以帮助我们:df.apply()。<br/>在这个例子中，我调用。应用于数据框的一列(一个序列),并应用lambda函数对序列中的每个值求平方:</p><figure class="hr hs ht hu fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lq"><img src="../Images/37e49b13f126ab8ab5fd1ca3ff1ffe21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CBFqVLap-hvieSv71R38RA.png"/></div></div></figure><p id="1524" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">48.5毫秒<br/>这比循环快多了！</p><h2 id="8744" class="js jt hx bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">感谢阅读！</h2><p id="d42a" class="pw-post-body-paragraph iu iv hx iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr hb bi translated">我希望这些例子能够帮助您理解NumPy对于数据科学家的重要性。</p></div></div>    
</body>
</html>