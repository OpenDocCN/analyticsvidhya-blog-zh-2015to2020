<html>
<head>
<title>Testing your Hadoop program with Maven on IntelliJ</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在IntelliJ上用Maven测试Hadoop程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/testing-your-hadoop-program-with-maven-on-intellij-42d534db7974?source=collection_archive---------1-----------------------#2020-01-08">https://medium.com/analytics-vidhya/testing-your-hadoop-program-with-maven-on-intellij-42d534db7974?source=collection_archive---------1-----------------------#2020-01-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2989" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将了解如何在IntelliJ上使用Maven编写和测试Hadoop程序，而无需在自己的机器上配置Hadoop环境或使用任何集群。这不是一篇<a class="ae jd" href="https://dzone.com/articles/6-free-vue-react-and-spring-ebooks-learn-full-stac" rel="noopener ugc nofollow" target="_blank">字数统计map reduce代码教程</a>假设对map-reduce功能有基本的理解。</p><h2 id="6aa0" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">要求</h2><ul class=""><li id="da41" class="jz ka hi ih b ii kb im kc iq kd iu ke iy kf jc kg kh ki kj bi translated">软件开发工具包(Software Development Kit)</li><li id="765f" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><a class="ae jd" href="https://www.jetbrains.com/idea/download/#section=mac" rel="noopener ugc nofollow" target="_blank"> IntelliJ </a>(点击下载)</li><li id="de1a" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">Linux或Mac OS</li></ul><h2 id="9a85" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated"><em class="kp">创建新项目</em></h2><p id="8d53" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">单击创建新项目并选择Maven，然后单击下一步</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/d7195df8da4968967ffe5e717d8202bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P86v9ZB1vJJtOIk839eyFA.jpeg"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lf"><img src="../Images/f8e21837587ab3a015ea619e6d9fab77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmKEIgE5WNtCMfXO9UsNxg.jpeg"/></div></div></figure></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><p id="0420" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置项目名称、项目位置、groupId和artifactId。保持该版本不变，然后单击finish。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ln"><img src="../Images/b137a310c6f743e328bb60b6cf49d327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jy5VPFvuGKNG9hzkpndlWg.jpeg"/></div></div></figure><p id="5df8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lo">现在我们已经准备好配置我们的项目依赖关系了</em></p><h1 id="36ad" class="lp jf hi bd jg lq lr ls jk lt lu lv jo lw lx ly jr lz ma mb ju mc md me jx mf bi translated">配置依赖关系</h1><p id="2c9a" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">打开pom.xml文件。该文件通常是单击“完成”后的默认打开屏幕。单击“启用自动导入”,但如果您希望每次编辑pom.xml文件时都收到通知，也可以导入更改。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mg"><img src="../Images/b6fa29756cbcd5ceb7d9b58ab9d059c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofqUfQo1RFzWjJEEYqtB8A.jpeg"/></div></div></figure><p id="4f2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在您的pom.xml文件中，在项目结束标记之前发布以下代码块</p><pre class="ku kv kw kx fd mh mi mj mk aw ml bi"><span id="547a" class="je jf hi mi b fi mm mn l mo mp">&lt;repositories&gt;<br/>    &lt;repository&gt;<br/>        &lt;id&gt;apache&lt;/id&gt;<br/>        &lt;url&gt;http://maven.apache.org&lt;/url&gt;<br/>    &lt;/repository&gt;<br/>&lt;/repositories&gt;</span><span id="51e0" class="je jf hi mi b fi mq mn l mo mp">&lt;dependencies&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br/>        &lt;artifactId&gt;hadoop-core&lt;/artifactId&gt;<br/>        &lt;version&gt;1.2.1&lt;/version&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br/>        &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;<br/>        &lt;version&gt;3.2.0&lt;/version&gt;<br/>    &lt;/dependency&gt;<br/>&lt;/dependencies&gt;</span></pre><p id="2a1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的pom文件应该如下所示</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mr"><img src="../Images/031c7ac0444e2481e187291a0092aacb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4e-mVZJG5tAmXvlXa-imOA.jpeg"/></div></div></figure><p id="e781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是完整的pom.xml文件</p><pre class="ku kv kw kx fd mh mi mj mk aw ml bi"><span id="e879" class="je jf hi mi b fi mm mn l mo mp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;project <br/>         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br/>         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;<br/>    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/><br/>    &lt;groupId&gt;org.Word&lt;/groupId&gt;<br/>    &lt;artifactId&gt;WordCount&lt;/artifactId&gt;<br/>    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br/>    &lt;repositories&gt;<br/>        &lt;repository&gt;<br/>            &lt;id&gt;apache&lt;/id&gt;<br/>            &lt;url&gt;http://maven.apache.org&lt;/url&gt;<br/>        &lt;/repository&gt;<br/>    &lt;/repositories&gt;<br/>    &lt;dependencies&gt;<br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br/>            &lt;artifactId&gt;hadoop-core&lt;/artifactId&gt;<br/>            &lt;version&gt;1.2.1&lt;/version&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;<br/>            &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;<br/>            &lt;version&gt;3.2.0&lt;/version&gt;<br/>        &lt;/dependency&gt;<br/>    &lt;/dependencies&gt;<br/><br/>&lt;/project&gt;</span></pre><p id="c428" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lo">现在我们准备为我们的示例测试项目WordCount创建类。</em></p><h2 id="c03e" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">创建WordCount类</h2><p id="034f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">进入src -&gt; main -&gt; java package并创建一个新类</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ms"><img src="../Images/7ddd1dbe991d6b77db40552efdad5cb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PmuLvovfnv7J_jzV1hmbKA.jpeg"/></div></div></figure><p id="89bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">命名该类，然后单击并输入</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mt"><img src="../Images/e26360fd3c26979491784d88482a1e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2cVpbACukG_33mnFBenJBA.jpeg"/></div></div></figure><p id="3901" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将以下Java代码粘贴到wordCount类中。</p><pre class="ku kv kw kx fd mh mi mj mk aw ml bi"><span id="73c0" class="je jf hi mi b fi mm mn l mo mp">import java.io.IOException;<br/>import java.util.StringTokenizer;<br/><br/>import org.apache.hadoop.conf.Configuration;<br/>import org.apache.hadoop.fs.Path;<br/>import org.apache.hadoop.io.IntWritable;<br/>import org.apache.hadoop.io.Text;<br/>import org.apache.hadoop.mapreduce.Job;<br/>import org.apache.hadoop.mapreduce.Mapper;<br/>import org.apache.hadoop.mapreduce.Reducer;<br/>import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<br/>import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br/><br/>public class wordCount {<br/><br/>    public static class TokenizerMapper<br/>            extends Mapper&lt;Object, Text, Text, IntWritable&gt; {<br/><br/>        private final static IntWritable one = new IntWritable(1);<br/>        private Text word = new Text();<br/><br/>        public void map(Object key, Text value, Context context<br/>        ) throws IOException, InterruptedException {<br/>            StringTokenizer itr = new StringTokenizer(value.toString());<br/>            while (itr.hasMoreTokens()) {<br/>                word.set(itr.nextToken());<br/>                context.write(word, one);<br/>            }<br/>        }<br/>    }<br/><br/>    public static class IntSumReducer<br/>            extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {<br/>        private IntWritable result = new IntWritable();<br/><br/>        public void reduce(Text key, Iterable&lt;IntWritable&gt; values,<br/>                           Context context<br/>        ) throws IOException, InterruptedException {<br/>            int sum = 0;<br/>            for (IntWritable val : values) {<br/>                sum += val.get();<br/>            }<br/>            result.set(sum);<br/>            context.write(key, result);<br/>        }<br/>    }<br/><br/>    public static void main(String[] args) throws Exception {<br/>        Configuration conf = new Configuration();<br/>        Job job = Job.getInstance(conf, "word count");<br/>        job.setJarByClass(wordCount.class);<br/>        job.setMapperClass(TokenizerMapper.class);<br/>        job.setCombinerClass(IntSumReducer.class);<br/>        job.setReducerClass(IntSumReducer.class);<br/>        job.setOutputKeyClass(Text.class);<br/>        job.setOutputValueClass(IntWritable.class);<br/>        FileInputFormat.addInputPath(job, new Path(args[0]));<br/>        FileOutputFormat.setOutputPath(job, new Path(args[1]));<br/>        System.exit(job.waitForCompletion(true) ? 0 : 1);<br/>    }<br/>}</span></pre><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mu"><img src="../Images/0cdbfa94500c589344d903c2bf58de4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vpxJfe11xOHvBwA7kDzpYg.jpeg"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mv"><img src="../Images/81d106d8181bc3cba23e9d47b9fbefae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DhaPiXhgLuVOwc0AMP6Ssw.jpeg"/></div></div></figure><p id="1e29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">wordCount类代码包括main方法、map类和reduce类。它扫描由第一个参数定义的文件夹中的所有文本文件，并将所有单词的频率输出到由第二个参数定义的文件夹中。</p><h2 id="d5ea" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">我们几乎准备好运行程序了…</h2><p id="f36f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">首先，我们必须创建文本输入文件。在您的项目包中创建新的文件夹，并将其命名为input。然后在输入文件夹/目录中创建你的txt文件，或者如果你已经有了的话拖动一个。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/ffc9b9a6a8197945db356bdc2be7ea38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZoDM4n_Nej0mLezitI_RA.jpeg"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/6a5bf273c403f3865c8eac8398b98a07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sc7iFivA8pe0oXf0vmuy9Q.jpeg"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/b4f10f291b5dd076d8340644e75364b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xLVQ_hnzSbcFt2RllWb1jg.jpeg"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/c8e98b5d2f01f68dd63b7b8530f05efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zFrD1cQwpjeod_Si0VN7-w.jpeg"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/5aa67a401bd061a5d7c07c894581c773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RY9UOaluI43MyNdo1YzdOA.jpeg"/></div></div><figcaption class="mx my et er es mz na bd b be z dx translated">在这个文件中复制并粘贴一些文本</figcaption></figure><p id="b0aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lo">快好了，耐心点……</em></p><p id="82ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还没有设置我们的程序参数。选择运行→编辑配置。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/0ba6928fb97a7df2038106d1d1366375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8NyR43Mlz59JrbGbbrAag.jpeg"/></div></div></figure><p id="9bef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过选择“+”然后选择应用程序来添加新的应用程序配置。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/a40e59063f78317504d1a50841f4ac59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oPMLqiJtnvmg_za8SOosw.jpeg"/></div></div></figure><p id="cbf3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置<code class="du nb nc nd mi b">Main class</code>为字数，设置<code class="du nb nc nd mi b">Program arguments</code>为输入输出。这允许程序从输入文件夹读取并将结果保存到<code class="du nb nc nd mi b">output</code>文件夹。不要创建输出文件夹，因为Hadoop会自动创建该文件夹。如果该文件夹存在，Hadoop将引发一个异常。完成后，选择应用，然后选择确定。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/33486711d092a59b0b18514468d999bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzbVARCZgH8zUBMj7BhKPA.jpeg"/></div></div></figure><p id="2f62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们准备好运行我们的程序了。</p><p id="8931" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择<code class="du nb nc nd mi b">Run</code> → <code class="du nb nc nd mi b">Run 'WordCount'</code>运行Hadoop程序。如果重新运行程序，请删除之前的输出文件夹。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/fea14ac0a90577fe04436ae9cf649b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vztMFgIUuXIejhFKu9_r2w.jpeg"/></div></div></figure><p id="d801" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将出现一个输出文件夹。每次运行的结果都保存在<em class="lo">输出</em> → <em class="lo"> part-r-00000 </em>中。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/f664c51826ccef892ddde68af7ba1932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9n-5btp8viay6vcW3V5SUQ.jpeg"/></div></div></figure></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><h1 id="db9c" class="lp jf hi bd jg lq ne ls jk lt nf lv jo lw ng ly jr lz nh mb ju mc ni me jx mf bi translated">Mac上可能出现的问题</h1><p id="a782" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">如果您的mac上运行的是最新版本的Java，您可能会遇到以下错误。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/a488441e67603f85ea1fc42a3693ab91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t3Z3jMhNgHbSPMYM1JhMsw.jpeg"/></div></div></figure><h2 id="b80d" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">解决办法</h2><p id="24a2" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">我的系统使用Javac版本9来编译程序，所以我将以下内容设置为我的Javac编译器版本。</p><p id="845d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文件-&gt;项目结构-&gt;项目-&gt;项目SDK -&gt; 9。<br/>文件- &gt;项目结构- &gt;项目- &gt;项目语言级别- &gt; 9。<br/>文件- &gt;项目结构- &gt;项目- &gt;模块- &gt; - &gt;源代码→ 9… <br/>项目中- &gt; ctrl + alt + s - &gt;构建、执行、部署- &gt;编译器- &gt; Java编译器- &gt;项目字节码版本- &gt; 9。<br/> Intellij IDEA - &gt;构建、执行、部署- &gt;编译器- &gt; Java编译器- &gt;模块- &gt; 1.9。</p></div></div>    
</body>
</html>