<html>
<head>
<title>Why Linear Regression does not work for classification-Part I?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么线性回归不适用于分类-第一部分？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/why-linear-regression-does-not-work-for-classification-part-i-97b04cab36d9?source=collection_archive---------14-----------------------#2020-02-20">https://medium.com/analytics-vidhya/why-linear-regression-does-not-work-for-classification-part-i-97b04cab36d9?source=collection_archive---------14-----------------------#2020-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="afaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">完成分析。</em></p><p id="0069" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">第一部分</em> </strong> <em class="jd">:线性回归是否适合2类以上的定性反应变量？为什么为什么不呢？</em></p><p id="98f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">第二部分</em> </strong> <em class="jd">:线性回归是否适用于2类定性响应变量？为什么为什么不呢？</em></p><p id="0bb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设给我们一些花卉的特征，我们需要根据它们的特征，如萼片长度、萼片宽度、花瓣长度和花瓣宽度，将这些物种分类为'<em class="jd">鸢尾-刚毛鸢尾</em>'、<em class="jd">鸢尾-杂色鸢尾</em>和'<em class="jd">鸢尾-海滨鸢尾</em>'。</p><p id="4ea2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在实践中，对于这类数据，我们使用像逻辑回归、线性判别分析、SVM等分类算法。但是，我们能用线性回归来解决它吗？让我们检查一下。</p><p id="aa18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面提到的数据是<strong class="ih hj">虹膜数据</strong>，你可以在这里  <strong class="ih hj">查看<a class="ae je" href="https://www.kaggle.com/uciml/iris" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">。</strong></a></strong></p><p id="7c89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我也建议你在继续之前阅读一下关于<a class="ae je" href="https://towardsdatascience.com/linear-regression-detailed-view-ea73175f6e86" rel="noopener" target="_blank"> <strong class="ih hj">线性回归</strong> </a>的内容。</p><p id="0051" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据看起来像这样:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jf"><img src="../Images/afbd74271a9a5ac8c674851f8359e64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*-1MTHZxLLbfwDwPiegR59Q.png"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">鸢尾花的花瓣长度和宽度</figcaption></figure><p id="d5ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了进行线性回归，我们需要考虑三种花的编码:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jr"><img src="../Images/7fe292a5fe0148b49eabfee7c633f3d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*8yJlf56-yqjHVmSehxH99g.png"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">虹膜数据响应变量的首次编码</figcaption></figure><p id="4d85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一切就绪！</p><p id="b678" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以使用线性回归来拟合具有这种编码的虹膜数据，并预测y。</p><p id="e8dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们运行代码。</p><p id="9004" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="https://github.com/ka1shi-medium/Linear-Regression-on-IRIS-data" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">代码</strong> </a>。</p><pre class="jg jh ji jj fd js jt ju jv aw jw bi"><span id="5972" class="jx jy hi jt b fi jz ka l kb kc"><strong class="jt hj">Coefficients</strong>: [-0.16079931 -0.03026038 0.27888762 0.53921169]<br/><strong class="jt hj">Mean Squared Error</strong>: 0.060240061710185554<br/><strong class="jt hj">R2_score</strong>: 0.9158135783553307</span></pre><p id="0e1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，我们用它取得了很好的效果。</p><p id="efd1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">为了进行预测，我假设预测值从0.5到1.5为1(鸢尾-setosa)，1.5到2.5为2(鸢尾-杂色)，2.5到3.5为3(鸢尾-海滨)。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/ffb99df504bdca81eb64b01157b9b690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3YI13kbkLHq78Bg6MXCmfw.png"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">使用第一个编码通过线性回归得出的实际和预测结果(红圈表示实际结果与预测结果不同的点)</figcaption></figure><p id="fea9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是等等！</p><p id="7a2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以像这样选择一个同样合理的编码:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ki"><img src="../Images/a1a3a95f30964a2e0ea4dc0ef4be580f.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*O00NFWXCgHicl-iG0x8A8g.png"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">虹膜数据响应变量的二次编码</figcaption></figure><p id="dd46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过保持除了这个编码之外的一切不变来重新运行代码。</p><p id="c102" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这次我们得到了:</p><pre class="jg jh ji jj fd js jt ju jv aw jw bi"><span id="0117" class="jx jy hi jt b fi jz ka l kb kc"><strong class="jt hj">Coefficients:</strong> [ 0.22466196 -0.82830855  0.03601207 -0.78051466]<br/><strong class="jt hj">Mean Squared Error:</strong>  0.519702808980069<br/><strong class="jt hj">R2_score:</strong> 0.22688838333543437</span></pre><p id="6091" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">我假设预测值从0.5到1.5为1(鸢尾-海滨鸢尾)，1.5到2.5为2(鸢尾-刚毛鸢尾)，2.5到3.5为3(鸢尾-杂色鸢尾)。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kj"><img src="../Images/38f940e82352fa144ec24e8353e0fa66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qKHs7quZL3Ylvs_rvtNQZA.png"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">使用二次编码通过线性回归得到的实际和预测结果</figcaption></figure><p id="8f36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">刚刚发生了什么？</p><p id="8fed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的R平方是0.91，现在只有0.22，均方差也从0.06增加到0.51。</p><p id="165a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">原因明明是编码但是为什么呢？</p><blockquote class="kk"><p id="d708" class="kl km hi bd kn ko kp kq kr ks kt jc dx translated">不幸的是，编码意味着对结果进行排序。</p></blockquote><p id="3afd" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">当我们假设第一个编码时，我们是在间接陈述<em class="jd">Setosa</em>&amp;<em class="jd">Virginica</em>和<em class="jd">Versicolor</em>&amp;<em class="jd">Virginica</em>之间的差异是相同的。</p><p id="3805" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而第二个编码表明<em class="jd">Setosa</em>&amp;<em class="jd">Virginica</em>和<em class="jd">Versicolor</em>&amp;<em class="jd">Setosa</em>之间的区别是相同的。</p><p id="a33e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这种定性的价值观，这就没有任何意义了。</p><p id="529f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果定性响应变量具有像低、中、高这样的值，那么1、2、3编码将是合理的，并且我们可以假设低和中之间的差异与中和高之间的差异相同。</p><blockquote class="kk"><p id="21e4" class="kl km hi bd kn ko kp kq kr ks kt jc dx translated">这些不同的编码产生不同的线性模型，最终导致测试观察的不同系数组。</p></blockquote><p id="e534" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我们的第一种编码给出了更好的结果，但是，选择第一种编码比第二种编码更合理吗？</p><p id="e38c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不，两种编码都同样合理，我们没有合理的解释来选择第一种而不是第二种，人们可以选择任何一种。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="9106" class="lg jy hi bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="fd35" class="pw-post-body-paragraph if ig hi ih b ii md ik il im me io ip iq mf is it iu mg iw ix iy mh ja jb jc hb bi translated"><em class="jd">在实践中，没有自然的方法将两个以上类别的定性响应变量转换为定量变量，并与线性回归拟合。</em></p><p id="cf45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于这些原因，最好对定性响应变量使用合适的分类方法。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h2 id="dd28" class="jx jy hi bd lh mi mj mk ll ml mm mn lp iq mo mp lt iu mq mr lx iy ms mt mb mu bi translated">参考资料:</h2><p id="25aa" class="pw-post-body-paragraph if ig hi ih b ii md ik il im me io ip iq mf is it iu mg iw ix iy mh ja jb jc hb bi translated"><a class="ae je" href="https://faculty.marshall.usc.edu/gareth-james/ISL/" rel="noopener ugc nofollow" target="_blank">统计学习简介</a></p><p id="2b2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="https://www.coursera.org/learn/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>作者吴恩达</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><p id="5954" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码请查看这个<a class="ae je" href="https://github.com/ka1shi-medium/Linear-Regression-on-IRIS-data" rel="noopener ugc nofollow" target="_blank"> GitHub </a>链接。</p><p id="cbdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查<a class="ae je" rel="noopener" href="/@ka1shi/why-linear-regression-does-not-work-for-classification-part-ii-82937927d301"> <strong class="ih hj">第二部分</strong> </a>是否为二元分类的线性回归。</p><p id="841a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请对任何类型的建议、纠正或批评进行评论。</p><p id="ea72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢大家！</p></div></div>    
</body>
</html>