<html>
<head>
<title>Common Excel formulas in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中常见的Excel公式</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/common-excel-formulas-in-python-c5a7ce0ae07a?source=collection_archive---------0-----------------------#2020-03-31">https://medium.com/analytics-vidhya/common-excel-formulas-in-python-c5a7ce0ae07a?source=collection_archive---------0-----------------------#2020-03-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b27fd3f6ce16971a4a8a529d4d3686ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yizt3NnCiiLESShvP-ZnUQ.png"/></div></div></figure><p id="3e23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我已经写了一篇关于如何在Excel中自动化常见数据分析任务的文章。接下来我写了一篇关于如何用python制作数据分析GUI的<a class="ae jo" rel="noopener" href="/analytics-vidhya/how-to-make-gui-in-python-for-data-analysis-f5cee63f4ff8">中型文章</a>。在本文中，我将深入探讨如何在python中实现常见的Excel函数。</p><p id="2e7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在文件“medium.xls”中有以下数据。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jp"><img src="../Images/509d441e45ee220d32dd6003d1a5abdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*04N2pY0cvIJaabfbdPE4bA.png"/></div></figure><p id="6652" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它包含不同组和位置的用户列表。收入和费用列包含每个用户给公司带来的收入和费用。</p><p id="6aee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们有第二个文件“group.xls ”,如下所示</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ju"><img src="../Images/85eaf72612478fc0449b10a4e7c10e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*32xXsFmBPVu4SNJ8iM7Ixw.png"/></div></figure><p id="4e64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它包含每个组号的组名。</p><p id="54b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我将展示如何用python实现常见的excel函数</p><p id="898b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 1阅读文件</strong></p><p id="e67c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用pandas <a class="ae jo" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html" rel="noopener ugc nofollow" target="_blank"> read_excel </a>函数读取pandas库中的excel文件。它读取excel文件并将文件数据作为pandas dataframe对象返回。</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="593a" class="ka kb hi jw b fi kc kd l ke kf">data = pandas.read_excel(r'path to/medium.xls')<br/>group = pandas.read_excel(r'path to/group.xlsx')</span></pre><p id="9c3e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2数据检查</strong></p><p id="11ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们要检查数据是否被正确读取。我们可以使用head方法检查数据帧的前五行，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="54d1" class="ka kb hi jw b fi kc kd l ke kf">data.head(5)</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kg"><img src="../Images/ed284d2fcb8030bb62a5a763724f52af.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*kxOywJk6VmKNcx-Z5PvmIw.png"/></div></figure><p id="77db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用tail方法检查数据帧的最后五行，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="b513" class="ka kb hi jw b fi kc kd l ke kf">data.tail(5)</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/db03bd258b3fd948ebcb8f1880d29b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*hhLdn9pTBQw_Tp6rUaOFMQ.png"/></div></figure><p id="44b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们想检查dataframe的第2行到第7行，我们可以如下使用dataframe对象的iloc方法:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="493f" class="ka kb hi jw b fi kc kd l ke kf">data.iloc[2:8]</span></pre><p id="61a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2。Vlookup </strong></p><p id="2afc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Vlookup可能是Excel中使用最多的函数。它用于连接excel中的两个表。</p><p id="0d45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这可以在pandas库中使用合并功能完成，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="7936" class="ka kb hi jw b fi kc kd l ke kf">data.merge(group, on = 'Group')</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/cb8d5ba557cac9419659e4dd073e758e.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*TVFuvWSO_5W7gtyXzWviSw.png"/></div></figure><p id="981f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于“on”关键字，将给出两个数据帧之间的公共列名的名称。</p><p id="b0ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用merge关键字，将第二组数据帧中的组名添加到数据数据帧中。</p><p id="8ba9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">合并功能可以做更多的事情。你可以在这里了解更多</p><p id="cd27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/" rel="noopener ugc nofollow" target="_blank">https://www . shanelynn . ie/merge-join-data frames-python-pandas-index-1/</a></p><p id="a67c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2透视表</strong></p><p id="046a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据透视表在Excel中用于执行数据聚合。这是Excel中最常用的函数之一。</p><p id="f3a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用dataframe的pivot_table方法在pandas库中创建数据透视表，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="3775" class="ka kb hi jw b fi kc kd l ke kf">data.pivot_table(values='Revenue', index='Location', columns ='Group').fillna(0)</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/0fea4c4e4970e0dda137bb206a90f71d.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*7B4MPGZCejF6w0zp2n_FHg.png"/></div></figure><p id="889b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Excel中，您可以使用GUI为行、列和索引选择列。在熊猫图书馆，你必须提供他们使用关键字。Pivot_table函数以数据帧的形式返回输出，可以进一步处理。</p><p id="3514" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3字符串函数——连接、长度、修剪、左、中、右</strong></p><p id="b669" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Excel有几个字符串函数。在pandas库中，您可以通过首先应用str访问器方法来逐列应用python字符串方法。然后就可以对它应用python中所有的原生字符串函数了。</p><p id="1e20" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Excel中，您可以使用upper函数将文本转换成大写字母。在pandas中，您可以将列中的所有文本转换为大写，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="2858" class="ka kb hi jw b fi kc kd l ke kf">data['User'].str.upper()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/82ccc48cd176d0a49de93ace959471b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*PDcu4TBgoWFk_po9o18c7A.png"/></div></figure><p id="df80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在excel中，您可以使用LOWER函数将文本转换为小写。在Pandas中，我们可以使用lower函数将其转换为小写，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="eb9e" class="ka kb hi jw b fi kc kd l ke kf">data['User'].str.lower()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/dbc307e6f7863eac9fe3650eb8a40a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*T1LgoWmdC6dGwPGkHFDstQ.png"/></div></figure><p id="3b74" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Excel中，你可以使用LEN函数得到字符串的长度。在pandas中，我们可以使用len函数获得字符串的长度，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="a7f0" class="ka kb hi jw b fi kc kd l ke kf">data['User'].str.len()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es km"><img src="../Images/e1c491bf7ab4877b7651de2524df3718.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*i6F17jJjxcvnTFUh-J1Oxg.png"/></div></figure><p id="bc9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在excel中，您可以使用LEFT函数获取字符串的第一个字符。在pandas中，我们可以使用str方法上的切片操作获得字符串的前2个字符，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="a841" class="ka kb hi jw b fi kc kd l ke kf">data['User'].str[:2]</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/695add7e16fd189a58bb5c7a554984fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*38PLLdbjmsY7RNbdxQtvmA.png"/></div></figure><p id="ddd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在excel中，您可以使用右函数获得字符串的最后一个字符。在pandas中，我们可以使用str方法上的切片操作获得字符串的最后2个字符，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="df76" class="ka kb hi jw b fi kc kd l ke kf">data['User'].str[-2:]</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es km"><img src="../Images/e2d010859c1d1e0f0ce02669976d8c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*lgitwK7wCx6eqlKHSbmLtw.png"/></div></figure><p id="1c04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样，你可以使用切片来实现pandas中Excel的mid功能。</p><p id="912f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在excel中，您可以使用CONCATENATE函数合并两个字符串。在pandas中，字符串可以被加在一起连接在一起。</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="5fc9" class="ka kb hi jw b fi kc kd l ke kf">data['User'] + data['Location']</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/54f9668344776d31e89e5454089768ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*tNZGZ8jxRFyjl-If7xG-6A.png"/></div></figure><p id="77e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4个求和函数</p><p id="67ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Excel中，Sumifs用于对满足特定条件的单元格区域求和。在pandas中，sumifs函数可以使用sum函数实现。</p><p id="1abc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，如果我们想知道集团的收入和支出，那么我们可以对groupby方法应用sum函数。</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="6386" class="ka kb hi jw b fi kc kd l ke kf">data.groupby('Group').sum()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/4c94a0cd381684271e1e7ab52d6b0bc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*-omymfn6hCRg5_yV1Tq5WA.png"/></div></figure><p id="979b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将返回集团的收入和费用。</p><p id="ce4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Groupby方法允许您基于作为参数提供给groupby方法的列“Group”中的唯一值来分组隔离数据。它允许拆分数据，并通过您选择的聚合方法进行组合。你可以在这里阅读更多关于groupby的信息</p><p id="d036" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">https://realpython.com/pandas-groupby/<a class="ae jo" href="https://realpython.com/pandas-groupby/" rel="noopener ugc nofollow" target="_blank"/></p><p id="6bc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">和sumifs一样，可以添加更多的条件。假设您只想要位于纽约的组的组智能收入和支出。我们可以通过在应用groupby之前过滤数据来实现这一点，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="89e8" class="ka kb hi jw b fi kc kd l ke kf">data[data['Location']=="Newyork"].groupby('Group').sum()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/a1a4c2809e5f88209eeef83125942203.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*TVysDjTT5DjMCz7OQSvKEQ.png"/></div></figure><p id="5575" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 5个县，平均年数</strong></p><p id="8dc3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">COUNTIFS函数在excel中用于对满足一个或多个条件的单元格区域进行计数。AVERAGEIFS在excel中用于计算满足一个或多个条件的单元格的平均值。</p><p id="6839" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Groupby方法还支持计数和平均聚合方法。当我们应用这些方法时，我们可以得到类似sumifs和countifs的结果。</p><p id="df77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们想知道每组中元素的数量。然后我们可以使用groupby和count来完成，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="99af" class="ka kb hi jw b fi kc kd l ke kf">data.groupby('Group')['Revenue'].count()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/a7a799dcddef2164ce355a52aa8b6ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*Gi4i2O2VucDJFa3_bdM1Gw.png"/></div></figure><p id="f91b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们想知道每组的平均收入和支出。那么我们可以这样做:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="230b" class="ka kb hi jw b fi kc kd l ke kf">data.groupby('Group').mean()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/0ba3ed566787622bb886e7c3c13f2103.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*wEonq5LBrdEt8KCLeY_76g.png"/></div></figure><p id="7643" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 6总和、最大值、最小值、平均值</strong></p><p id="b046" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Sum、Max、Min和Average是必不可少的Excel函数。它们返回选定范围内数值的总和、最大值、最小值和平均值。</p><p id="9c6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Pandas dataframe和series对象都支持sum、max、min和mean函数，可以用来实现上述功能。我已经计算了收入栏的总和、最大值、最小值和平均值，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="de0d" class="ka kb hi jw b fi kc kd l ke kf">data['Revenue'].sum()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/2623c3811db79328dd75b1a1baa9ce81.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/format:webp/1*Ybw9-Xtkl7N_9ZRq_V6BcA.png"/></div></figure><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="3858" class="ka kb hi jw b fi kc kd l ke kf"><br/>data['Revenue'].max()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/e943a4e1562a5bdd330d69d46054f562.png" data-original-src="https://miro.medium.com/v2/resize:fit:90/format:webp/1*5E_t7vhxxS3mdaVMGBMKWA.png"/></div></figure><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="32ea" class="ka kb hi jw b fi kc kd l ke kf">data['Revenue'].min()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/a294dfbfe68b074914e4c21ad3cd5e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:130/format:webp/1*OpR7p1VczASDWJzUGcYImg.png"/></div></figure><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="229a" class="ka kb hi jw b fi kc kd l ke kf">data['Revenue'].mean()</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/e4963a6c12df5d6dd876a3ba14c55545.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*LHrE_4y-orzaJDGiGmRLDw.png"/></div></figure><p id="55da" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 9 If函数</strong></p><p id="4eab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果函数在excel中用于根据条件在值中进行选择。可以使用Numpy库的where函数实现。首先，我们必须导入numpy，如下所示</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="b929" class="ka kb hi jw b fi kc kd l ke kf">import numpy</span></pre><p id="f4d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Numpy库包含一个where函数，其功能类似于excel中的IF公式。它根据条件从两个数组中返回值。你可以在这里了解更多。</p><p id="c1f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html" rel="noopener ugc nofollow" target="_blank">https://docs . scipy . org/doc/numpy/reference/generated/numpy . where . html</a></p><p id="f048" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用numpy where函数来实现一个if公式，其中基于一个条件，我们希望返回1或0。</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="8d39" class="ka kb hi jw b fi kc kd l ke kf">numpy.where(data['Revenue']&gt;400,1,0)</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/daa837a89b1d20f27a907a064b33f6e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*zfznn4xbp-2qcZE9zZGfRw.png"/></div></figure><p id="a544" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还可以比较两列数据帧，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="42cf" class="ka kb hi jw b fi kc kd l ke kf">numpy.where(data['Revenue']&lt;data['Expense'],1,2)</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/95fbf5da897cce1b24f34c0ce6e2c3fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*WhL5KUoztTkS_6fz6rsCgA.png"/></div></figure><p id="7862" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 10号指标与比赛</strong></p><p id="f0aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Excel中，索引和匹配的组合被用来替代Vlookup。Index函数返回指定索引范围内单元格的值。Match返回符合指定条件的单元格区域中单元格的索引。</p><p id="d6de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在pandas中使用Loc访问器方法来访问dataframe中的值。</p><p id="ae0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果只向loc方法传递一个参数。它通过索引标签选择数据帧的行</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="b5d5" class="ka kb hi jw b fi kc kd l ke kf">data.loc[0]</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/7d07c5f537b7bfd32dbf569f2920b62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*qqzXCE3ET3IKtAvq4T41gw.png"/></div></figure><p id="7b31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们想按行和列访问。然后，我们必须为loc方法提供两个参数</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="a846" class="ka kb hi jw b fi kc kd l ke kf">data.loc[0,'User']</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es la"><img src="../Images/bc3e17ff17082da664e37be1c73028f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:142/format:webp/1*_k8M88PDsNjrhGfiQ1Jo0Q.png"/></div></figure><p id="4022" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们想要访问特定的列，那么我们可以提供“:”作为第一个参数来访问所有的行。</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="a419" class="ka kb hi jw b fi kc kd l ke kf">data.loc[:,"User"]</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/3d4a1585b3ce82e1e00fd13fc7add96d.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*PC7HmTOf8xNai-mvZidViA.png"/></div></figure><p id="3f80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在这里阅读关于锁定方法更多信息</p><p id="ab54" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。DataFrame.loc.html</a></p><p id="2c25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Loc方法也接受布尔数组作为参数。因此，如果我们将condition作为参数之一传递，那么它就相当于索引和匹配。</p><p id="36d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设如果想知道收入为500时的费用。那么我们可以这样实现它:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="e79e" class="ka kb hi jw b fi kc kd l ke kf">data.loc[data['Revenue']==500,'Expense']</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/8a18add76978c0959b86fc02eb1aff44.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*B-jlHXpx3g5pYhGkKDfSxA.png"/></div></figure><p id="38c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们想知道收入等于费用时的费用，那么我们可以实现如下:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="3730" class="ka kb hi jw b fi kc kd l ke kf">data.loc[data['Revenue']==data['Expense'],'Expense']</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/84b89990576dca280cb11adc6d2a330f.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*IP59VNnjQfa-hocZotBgZQ.png"/></div></figure><p id="9415" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 13和积</strong></p><p id="b5ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Excel中，SUMPRODUCT函数用于计算两个范围的乘积之和。在熊猫中，它可以按如下方式实现:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="2f10" class="ka kb hi jw b fi kc kd l ke kf">sum(data['Revenue']*data['Expense'])</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es le"><img src="../Images/2e1d7ead1c1fd51c9d362c08ae54915a.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*C0DTq3u36czOQbNRB0c2ag.png"/></div></figure><p id="efb2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这利用了算术运算可以在pandas数据帧上按元素方式完成的事实，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="8420" class="ka kb hi jw b fi kc kd l ke kf">data['Revenue']*data['Expense']</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/9d013bd3df644f7b4089f24123cb2bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*OZLUIxLVqLJNom7JfH3ibw.png"/></div></figure><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="531c" class="ka kb hi jw b fi kc kd l ke kf">data['Revenue']+data['Expense']</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/f3f1f6a7fce7268d537d6355207a823f.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*iZEzDidEkAmE13rDDBu3JA.png"/></div></figure><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="a249" class="ka kb hi jw b fi kc kd l ke kf">data['Revenue']/data['Expense']</span></pre><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/d1a015d99b235de409d953e0a06628ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*f02tIsQsfoeYNuUR8kReaw.png"/></div></figure><p id="581e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 14保存文件</strong></p><p id="a0cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以将分析结果保存为csv或excel格式。为了保存到csv，使用to_csv函数。To_excel函数用于保存为excel格式。在这里，我将数据对象保存为csv和excel格式，如下所示:</p><pre class="jq jr js jt fd jv jw jx jy aw jz bi"><span id="ec70" class="ka kb hi jw b fi kc kd l ke kf">data.to_csv('data.csv')<br/>data.to_excel('data.xls')</span></pre><p id="6855" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 15摘要</strong></p><p id="ccfc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可能有一个excel工作表，其中有许多公式。而且我们想用Python实现工作表的逻辑。在这种情况下，使用这些python函数，我们可以轻松地从Excel过渡到Python。</p></div></div>    
</body>
</html>