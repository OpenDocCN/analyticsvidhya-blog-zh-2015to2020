<html>
<head>
<title>NGBoost incremental Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NGBoost增量预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ngboost-incremental-forecasting-f4173b778f9e?source=collection_archive---------10-----------------------#2020-05-28">https://medium.com/analytics-vidhya/ngboost-incremental-forecasting-f4173b778f9e?source=collection_archive---------10-----------------------#2020-05-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="634a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者<em class="jd">如何满怀信心地预测自己不知道的事情</em>——区间。</p><p id="e5ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前有一个突出的预测挑战正在Kaggle上发生，<a class="ae je" href="https://www.kaggle.com/c/m5-forecasting-accuracy/overview" rel="noopener ugc nofollow" target="_blank"> M5预测挑战</a>。给定的是长时间范围内(1913天或大约5年)产品项目的销售，日历信息和价格信息。从<a class="ae je" href="https://www.kaggle.com/headsortails/back-to-predict-the-future-interactive-m5-eda" rel="noopener ugc nofollow" target="_blank">这里</a>可以找到M. Henze出色的深度分析。挑战的目标是，对个别商品在未来28天的销售情况做出明智的预测。人们可以用不同的方法来应对这一挑战:LSTMs、MCMC等方法。本文将关注如何通过相对新颖的方法—<strong class="ih hj">ng boosting</strong>来<strong class="ih hj">生成预测。</strong></p><p id="77cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NGBoost由斯坦福ML小组开发，由Tony Duan、Anand Avati等人于2019年<a class="ae je" href="https://arxiv.org/abs/1910.03225" rel="noopener ugc nofollow" target="_blank"> arXiv上发表</a>。与其他增强方法相比，这种方法通过利用自然梯度来优化增强，如<a class="ae je" href="https://papers.nips.cc/paper/6907-lightgbm-a-highly-efficient-gradient-boosting-decision-tree.pdf" rel="noopener ugc nofollow" target="_blank"> LightGBM </a>或<a class="ae je" href="https://arxiv.org/abs/1603.02754" rel="noopener ugc nofollow" target="_blank"> XGBoost </a>。它减少了对已知数据点的过度拟合，并在标准基准数据集上至少达到了最先进的性能——参见[1]以获取参考和见解。此外，在拟合模型后，我们可以根据数据生成pdf(概率密度函数)(见下文),甚至可以得到不确定性区间。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jf"><img src="../Images/1faa74f6da2df194ca9934f03e3b2d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*zh8I7uwpYcez_Tsi.png"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jf"><img src="../Images/54d24d86acbb17438e6f5f835e37b981.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*j6csJH7MxzWDRPyg.png"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">M5数据集第一项的训练数据(上图)和测试数据(下图)的拟合NGBoost回归量的概率密度</figcaption></figure><p id="7cb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Boosting算法进行预测不像LSTMs或MCMC方法那样简单。在模型学习了输入数据的底层结构后，LSTM可以在指定的时间步长内生成新数据。如果你安装一个<em class="jd">助推模型</em>并简单地点击“<em class="jd">预测28天</em>”——按钮，它会吐出28次一致的值。<br/>那么，让我们在你最喜欢的编辑器或笔记本中开始派对吧:</p><pre class="jg jh ji jj fd jr js jt ju aw jv bi"><span id="719c" class="jw jx hi js b fi jy jz l ka kb">!pip install ngboost<br/>from ngboost import NGBRegressor</span><span id="7522" class="jw jx hi js b fi kc jz l ka kb">df = # load the dataset as provided on kaggle ...<br/>X, y = # split the df into X and y as described below<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)</span><span id="a532" class="jw jx hi js b fi kc jz l ka kb">ngb_clf = NGBRegressor(n_estimators=100, Score=LogScore, minibatch_frac=0.5)<br/>ngb_clf.fit(X_train, y_train)</span><span id="9607" class="jw jx hi js b fi kc jz l ka kb">ngb_clf.predict(X_test)</span></pre><p id="99da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们已经预测了一些事情，我们想要展望未来——一次一个。<strong class="ih hj">获得调整预测</strong>的方法是<strong class="ih hj">将预测数据纳入考虑</strong>。这意味着我们重新调整模型，并逐步进行下一次预测。您可以在下面的图3中找到一个可行的算法。假设我们有如下格式的输入数据(见图1)。我们另外需要的是第二天的一个空列(例如第1914天)。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/a6e3db812f369bdb40e290b8d0e9c8cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*odW1ADIxnQ6SDREE.png"/></div></div></figure><p id="e282" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们与我们的数据争论(你可能会使用python的pandas或R-tidyverse)并得出下面这个漂亮的数据帧(见图2)，这意味着我们有:<strong class="ih hj"> (1。)</strong><strong class="ih hj">销售额作为我们的y值</strong>或者我们想要拟合和预测的东西，<strong class="ih hj"> (2。)</strong> <strong class="ih hj"> one-hot-encoded </strong>我们感兴趣的<strong class="ih hj">类别</strong>，例如时间特征或价格特征等。和<strong class="ih hj"> (3。)</strong>对item_id进行标签编码(<em class="jd">这是可选的，但有助于稍后分配预测</em>)。现在我们按照下面的伪代码:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ki"><img src="../Images/2ea5cc140dd35df884558e94e23eeee8.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/0*V5_VQ52-apm18H3A.png"/></div></figure><ul class=""><li id="8865" class="kj kk hi ih b ii ij im in iq kl iu km iy kn jc ko kp kq kr bi translated">我们在已知的日子里分割数据帧(例如1913+ <em class="jd"> i </em>其中<em class="jd"> i </em>是我们已经处理过的时间步长)让我们称之为<em class="jd"> X_train </em>而我们不知道的新数据称为<em class="jd"> X_pred </em></li><li id="0263" class="kj kk hi ih b ii ks im kt iq ku iu kv iy kw jc ko kp kq kr bi translated">我们根据现有的数据训练回归器。</li><li id="ed65" class="kj kk hi ih b ii ks im kt iq ku iu kv iy kw jc ko kp kq kr bi translated">我们在<em class="jd"> X_pred </em>上调用拟合回归的预测函数</li><li id="be22" class="kj kk hi ih b ii ks im kt iq ku iu kv iy kw jc ko kp kq kr bi translated">我们重复这个过程，直到我们有28天</li></ul><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es kx"><img src="../Images/cbc999d51c0c2e4f4e00c29bf51f2e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/0*Zk33EOog9aVEldsb.png"/></div></figure><p id="664a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于ngboost提供了什么以及如何工作的用户指南可以在斯坦福ML集团网站上找到。<br/>2020年6月挑战赛结束后，将通过github-link提供我们解决方案的完整代码和一个笔记本。</p><p id="6019" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我的两点意见:NGBoost将给出它认为最有可能发生的预测。对于这种预测挑战，这并不总是有用的，我们发现预测值并不总是实际(验证)值。我们配置中的算法给出了非常保守的估计。尽管在回归问题中有许多很好的应用案例，但我们不认为这是一个预测挑战。相反，我们实现了PyTorch模型，它可以更好地预测数据，并将成为另一个即将到来的故事的主题。</p><p id="b751" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编码快乐！</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="1654" class="lf jx hi bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">参考</h1><ol class=""><li id="b6f1" class="kj kk hi ih b ii mc im md iq me iu mf iy mg jc mh kp kq kr bi translated">托尼·段，阿南德·阿瓦提等。艾尔。<em class="jd"> NGBoost:用于概率预测的自然梯度推进</em>。v3。2020年在<a class="ae je" href="https://arxiv.org/abs/1910.03225" rel="noopener ugc nofollow" target="_blank"> arXiv </a>上市</li><li id="e906" class="kj kk hi ih b ii ks im kt iq ku iu kv iy kw jc mh kp kq kr bi translated"><a class="ae je" href="https://stanfordmlgroup.github.io/ngboost/1-useage.html" rel="noopener ugc nofollow" target="_blank"> NGBoost用户指南</a></li><li id="19de" class="kj kk hi ih b ii ks im kt iq ku iu kv iy kw jc mh kp kq kr bi translated"><a class="ae je" href="https://www.kaggle.com/c/m5-forecasting-accuracy/" rel="noopener ugc nofollow" target="_blank">M5·卡格尔挑战赛</a></li></ol></div></div>    
</body>
</html>