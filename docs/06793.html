<html>
<head>
<title>Perform Image processing with ease using Transfer learning.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用迁移学习轻松执行图像处理。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-get-started-with-transfer-learning-6aa53fc07f31?source=collection_archive---------23-----------------------#2020-06-02">https://medium.com/analytics-vidhya/how-to-get-started-with-transfer-learning-6aa53fc07f31?source=collection_archive---------23-----------------------#2020-06-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6c19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在图像处理中，建立相当精确的模型是非常困难的。但是通过迁移学习，我们可以很容易地采用预先训练好的模型，并根据我们的需要对它们进行调整，从而轻松实现良好的准确性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/480bf0fde56e1f0c238259e473d40b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HslVSB_CPrexXe8c.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:谷歌</figcaption></figure><p id="3d15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图简单说明了迁移学习。我们把已经训练好的模型和它的权重一起，去掉最后几层，然后根据我们的需要添加层。</p><p id="d74d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从Kaggle中探索<a class="ae jt" href="https://www.kaggle.com/tongpython/cat-and-dog" rel="noopener ugc nofollow" target="_blank">猫狗</a>数据集。你可以和这个<a class="ae jt" href="https://www.kaggle.com/narasimha00076/transfer-learning-using-mobilenetv2" rel="noopener ugc nofollow" target="_blank"> Kaggle笔记本</a>一起阅读这篇文章。我强烈建议您通过执行笔记本中的单元格来阅读本文。</p><p id="26e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始这个项目吧。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="6104" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将数据集加载到train_data和test_data列表中。我们使用OpenCV来实现这一点。我们使用tf.image调整图像的大小。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kb"><img src="../Images/785ed725bfab1ce2c95f851f1548eda7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*ZKlkEIVD-scCig77QwFn1g.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从文件夹加载数据</figcaption></figure><p id="f2aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查火车的长度和测试数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kc"><img src="../Images/6e42635bf91f46137d1a3cf9670c5f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sEn3J-2F_swxpBfUFZzHHQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">训练数据和测试数据的长度</figcaption></figure><p id="8c67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，为了提高效率，将这些训练和测试数据转换为Tensflow数据集对象。它接受图像和标签，并将它们组合成数据集对象。这些数据集对象提供了各种功能。例如，我们可以相对于彼此洗牌。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/78f1d488aa13651aef44213d3992b253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tMgU2DjbvWYBpPXzhcKQ5w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">将它们转换成数据集对象</figcaption></figure><p id="5ceb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们格式化图像。我们将图像转换为浮点型，并将其标准化，然后将其大小调整为(160，160)。我们的基本模型(我们使用的预训练模型)接受这种形状。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/e2eb2b5c084344c037956b877a7aa65b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*xnOmUZ-nFgyT5NRKcpypRw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">格式化图像</figcaption></figure><p id="60bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们把它们分成几批，然后洗牌。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/58694a69446a509026f05a3bfacfc46b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCKazwE5bhJ319LHa6KIlQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">批处理和洗牌</figcaption></figure><p id="0ad7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们都有了训练数据。</p><p id="85e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将MobileNetV2实例化为我们的预训练模型。让我们把IMG形状固定为(160，160，3)。我们使用ImageNet权重，这是训练它的数据集。我们设置include_top = False，以便不使用MobileNet的最后几层。我们根据自己的需求定义最后几层。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kg"><img src="../Images/416524da3f0e052b3ec52727ae50656a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xT1_kfqcW5fPP7WCrYNgTw.png"/></div></div></figure><p id="1bb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是基本模型的最后几层，以及可训练和不可训练的参数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/3103fbc1f6d63485abf73f21f506f093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7g025BuL5zLM7mjZIRmOZQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最后几层和参数</figcaption></figure><p id="b883" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查和评估层的形状。首先，训练数据中图像批次的形状。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ki"><img src="../Images/1dd9b49cf611be7e9d63f666c84277d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*D4bl7zNGPFRMTeDYMLc4hA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">训练数据中批次的形状</figcaption></figure><p id="2cc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查基础模型的输出形状。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/a4b300b611f6deef7c984a54268cea2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*1rLEQK3u_i_EnDxeGHPDnA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">基本模型输出形状</figcaption></figure><p id="6556" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们添加全球平均池层。它在5X5X1280上执行平均池化，并将其转换为1X1280。然后我们可以添加我们的密集层来执行分类。让我们检查它的输出形状。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kk"><img src="../Images/a745781c69da10bfe1fe158342f4e596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*VWNgoAQjmqAuPfGdaYtuMA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">全球平均池的产出</figcaption></figure><p id="800e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们用Relu激活增加32个神经元的密集层。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kl"><img src="../Images/e1d72da3efcb5f99d73636a0afd9ebc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gxE4U51iP3u_3M-8Y1LvQQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">隐藏层的输出</figcaption></figure><p id="2190" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们添加一个具有1个神经元的密集层，用于分类。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es km"><img src="../Images/f3a7a13d30cc8479a3f4e61c35004b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CXdLo61KXm1bVW_WEJfiKQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最终层输出形状</figcaption></figure><p id="8fff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有这些层都工作正常，因此，让我们用它们制作一个顺序模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kn"><img src="../Images/29e1b736e0ed0631971b8a0cd3f8f6d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*pEcC6mnVRDHi40k841VvZQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">顺序模型</figcaption></figure><p id="f944" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们保持学习率为0.0001，并使用RMSprop作为优化器，使用准确性作为编译模型的指标。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/298f7af4e7a669b0ed54e8b40a1020a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LuzqZTuGVxf5VkurHT20XA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">编译模型</figcaption></figure><p id="66ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总结。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/384d600cb593bba9bb80e86dbf7e5354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0CRau_2osIal5F_mXuL7w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">摘要</figcaption></figure><p id="00da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了保存最佳模型，让我们使用模型检查点并将其保存为best_model.h5。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kq"><img src="../Images/56d0545c358ad2a37ae529a674138972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OMWP6s7XZzih4yyWJ07ZVA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">复试</figcaption></figure><p id="1526" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们计算每个时期的步数，并检查测试数据的准确性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kr"><img src="../Images/eb816f1c1d70022e12d850962d28162e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvJUdcqg3d-8Z29BkzKstQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">每个时期的步骤</figcaption></figure><p id="4bc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们终于可以训练模型了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/a6cc1dc3214eee0bd20b75d0dcd47b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8cBxICvSSPVl7-KXmgwA0g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">培养</figcaption></figure><p id="a0e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们加载保存的最佳权重。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/d2bfa812aa8ffdcf0da2b944baab5527.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*0VSF6AOz8U2yi-KF2fl27Q.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">装载重量</figcaption></figure><p id="7304" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们根据测试数据评估模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/781f22e5c4016ffec31d763126e9da01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-qyrkv0XxfOBHi4Tv1-RaA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">预言；预测；预告</figcaption></figure><p id="a2b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有76%的准确率。</p><p id="0db7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，这就是迁移学习的优势。我们没有经历用试错法创建模型，并以各种方式进行优化的痛苦过程。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="7c68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，迁移学习怎么样呢？请在下面的评论中告诉我你的想法。</p><p id="893f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是GitHub 上完整项目的链接。</p><p id="c8fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>