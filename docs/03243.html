<html>
<head>
<title>Want to handle the unexpected in Python? TRY this. (EXCEPT don’t abuse it)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">想在Python中处理意外情况吗？试试这个。(除了不要滥用)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/want-to-handle-the-unexpected-in-python-try-this-except-dont-abuse-it-169da40700c3?source=collection_archive---------25-----------------------#2020-01-21">https://medium.com/analytics-vidhya/want-to-handle-the-unexpected-in-python-try-this-except-dont-abuse-it-169da40700c3?source=collection_archive---------25-----------------------#2020-01-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="403f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">错误。对于我们这些编程初学者来说，它们就像死亡和税收一样确定无疑。一个小小的失误，所有的事情都会分崩离析。我们不仅要处理自己的错误，当外部因素的输入发生不可预测的转变时，事情可能会破产。</p><p id="3781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然拼写错误的变量名引起的挫折感可能会令人扫兴，但请考虑替代方案。你的辛勤工作因为一个错误而被搁置，这种恼人的痛苦对于数字的福祉来说可能是必不可少的，就像痛苦的感觉对于活人的生存来说一样:这是一种令人不快但健康的迹象，表明有些事情不对劲。</p><p id="506b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，我们人类会屈服于我们遇到的每一个不舒服的情况，完全停止所有的运动吗？你的Python代码也不需要。进入<strong class="ih hj"> <em class="jd">尝试</em> </strong>语句。</p><p id="8fc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd"> try语句</em> </strong>在您需要定制遇到错误时会发生什么的情况下非常有用。免责声明:它不能代替精心构建的代码。它只是提供了一种调用特定错误而没有后果的方法；能够在不中断执行的情况下，一丝不苟地制定应急计划/警告。</p><p id="d313" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，一个人实际上如何开始编写这些<strong class="ih hj"> <em class="jd"> try语句</em> </strong>？很简单！</p><h1 id="f5bb" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">基本纲要</h1><p id="9874" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd"> try语句</em> </strong>的语法类似于<strong class="ih hj"> <em class="jd"> if语句</em> </strong>。它以一个代码块开始，该代码块包含要<strong class="ih hj"> <em class="jd">尝试</em> </strong>的内容，随后是一个<strong class="ih hj"> <em class="jd">代码块，除了</em> </strong>代码块之外，该代码块包含如果它产生错误时要运行的内容。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="0b48" class="kq jf hi km b fi kr ks l kt ku">def a_simple_try_statement():<br/>    try:<br/>        <em class="jd">#insert code that you would like to test.</em><br/>    except:<br/>        <em class="jd">#code here will run if the test results in an error.</em></span></pre><p id="609f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，除了 行之外，当<strong class="ih hj"> <em class="jd">行中指出特定错误时，您可以选择明确指出这些错误。您可以包含任意多的<strong class="ih hj"> <em class="jd">异常语句</em> </strong>，为每个场景指定不同的代码。像<strong class="ih hj"><em class="jd">elif</em></strong><strong class="ih hj"><em class="jd">语句</em> </strong>只有满足条件的<strong class="ih hj"> <em class="jd">异常</em> </strong>的第一个实例才会运行。</em></strong></p><p id="4f1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，请记住<strong class="ih hj">你不能用逻辑运算符</strong>将这些链接在一起/做出更复杂的陈述。</p><p id="5c53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的例子展示了一个<strong class="ih hj"> <em class="jd"> try/except语句</em> </strong>的基本语法，其中包含了一点复杂性。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="5efc" class="kq jf hi km b fi kr ks l kt ku">def a_way_to_divide_things(thing1,thing2):<br/>    try:<br/>        output = thing1 / thing2<br/><em class="jd">    #If the function receives incompatible variable types:</em><br/>    except TypeError:<br/>        print("You must include only ints or floats")<br/><em class="jd">    #If the function tries to divide by zero:</em><br/>    except ZeroDivisionError:<br/>        print("The universe refuses to reveal its secrets")<br/><em class="jd">#Now the code is prepared to handle multiple (but not infinite) possibilities.</em></span></pre><p id="ecc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这个，你就可以真正地微调你的代码来精确地处理错误，因为Python库能够区分众多的<strong class="ih hj"> <em class="jd">异常</em> </strong>。以下链接包含一个参考，列出了许多可供您选择的选项:</p><div class="kv kw ez fb kx ky"><a href="https://www.tutorialsteacher.com/python/error-types-in-python" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">Python中的错误类型</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">Python程序中最常见的错误原因是某个语句不符合…</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">www.tutorialsteacher.com</p></div></div><div class="lh l"><div class="li l lj lk ll lh lm ln ky"/></div></div></a></div><h1 id="e6cc" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">可变范围和可能需要其他东西的情况</h1><p id="62fc" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当你开始创建自己的try语句时，你可能会无意中破坏你的代码，因为你在<strong class="ih hj"> <em class="jd"> try语句</em> </strong>中显式定义了一个<strong class="ih hj"> <em class="jd">未定义变量</em> </strong>后，遇到了一个意外的错误。虽然这与直觉有些矛盾，但认识到在<strong class="ih hj"> <em class="jd"> try语句</em> </strong> <strong class="ih hj">中成功执行的代码不会创建全局变量</strong>，这就很容易避免了！</p><p id="226e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可变范围可能是一个令人困惑的话题，值得进一步研究。这么说吧，在一个环境中成功运行的东西在另一个环境中不一定成功:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="fa8b" class="kq jf hi km b fi kr ks l kt ku">def dysfunctional(stuff, more_stuff):<br/>    try:<br/>        output = stuff / more_stuff<br/>    except:<br/>        print("Yea... this isn't going to work...")<br/>        output = False<br/>    print(output)<br/><em class="jd">#If this wasn't contained in a function, this code will fall apart.</em></span></pre><p id="9400" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，当你需要给这个变量更大的空间时，会发生什么呢？在你开始想办法把一些if语句偷偷放进去之前，先考虑一下他更冷漠的孪生兄弟:else。这正好符合<strong class="ih hj"> <em class="jd"> try/except </em> </strong>语句的最后一个条件……没有如果和但是:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="f008" class="kq jf hi km b fi kr ks l kt ku">def functional(stuff, more_stuff):<br/>    try:<br/>        output = stuff / more_stuff<br/>    except:<br/>        print("Yea... this isn't going to work...")<br/>        output = False<br/><em class="jd">    #Runs if the code executed in the try statement successfully.</em><br/>    else:<br/>        output = stuff / more_stuff<br/><em class="jd">    #Closes the try statement running regardless of its outcome.</em><br/>    finally:<br/>        print(output)<br/><em class="jd">#If this code is run outside the function it still works!</em></span></pre><p id="397b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后一条语句还包含一个代码块，该代码块前面有一个由单词<strong class="ih hj"> <em class="jd">表示的语句，最后是</em> </strong>。这是一种显式结束<strong class="ih hj"> try </strong>语句的方式，无论是否出现异常，它都将继续执行。</p><h1 id="7eb4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">↑最后↓</h1><p id="3a69" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当然，和任何新工具一样，潜在的坏习惯是存在的，过度使用是非常诱人的。例如，在我加入数据科学训练营的第一周，我开始过多地将它视为一个包罗万象的解决方案。这里显示的是一个函数，在我真正知道如何使用熊猫来解决我的统计问题之前，我编写了这个函数来从一系列数字中确定模式:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="37e9" class="kq jf hi km b fi kr ks l kt ku"><em class="jd">#Iterates through unique numbers in a list counting their<br/>#occurrences keeping track of the most frequent.</em><br/>def mode(dataset):    <em class="jd"><br/> </em>   ordered = sorted(list(set(dataset)))<br/>    for data in ordered:<br/>        current_count = dataset.count(data)</span><span id="a971" class="kq jf hi km b fi lo ks l kt ku">        <em class="jd">#Try-ing too hard to compensate for an empty variable<br/>        #that breaks things during the first run of the for loop.</em><br/>        try:<br/>            count<br/>        except:<br/>            count = current_count<br/>            the_mode = []<br/>        if count &lt; current_count:<br/>            count = current_count<br/>            the_mode = [data]<br/>        elif count == current_count:<br/>            the_mode.append(data)<br/>        else: continue</span><span id="b192" class="kq jf hi km b fi lo ks l kt ku">        <em class="jd">#Statement to address the possibility of no numbers<br/>        #actually repeating.</em><br/>        if ordered == the_mode:<br/>            print(“There is no mode”)<br/>            the_mode = None<br/>    return the_mode</span></pre><p id="551f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然这个函数做了它设定要做的事情，但问题是你真的没有<strong class="ih hj"><em class="jd"/></strong><strong class="ih hj"><em class="jd">尝试</em> </strong>任何事情。变量“count”在循环开始之前就可以很容易地初始化，代码会更清晰、更简洁。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="6aa7" class="kq jf hi km b fi kr ks l kt ku"><em class="jd">#Iterates through unique numbers in a list counting their<br/>#occurrences keeping track of the most frequent.<br/></em>def mode(dataset):<br/>    ordered = sorted(list(set(dataset)</span><span id="da92" class="kq jf hi km b fi lo ks l kt ku">    <em class="jd">#Initializing the variable here reduces those 4 lines of code<br/>    #into a single one.<br/></em>    count=0<br/>    for data in ordered:<br/>        current_count = dataset.count(data)<br/>        if count &lt; current_count:<br/>            count = current_count<br/>            the_mode = [data]<br/>        elif count == current_count:<br/>            the_mode.append(data)<br/>        else: continue</span><span id="3589" class="kq jf hi km b fi lo ks l kt ku">        <em class="jd">#Statement to address the possibility of no numbers<br/>        #actually repeating.<br/></em>        if ordered == the_mode:<br/>            print(“There is no mode”)<br/>            the_mode = None</span><span id="f82d" class="kq jf hi km b fi lo ks l kt ku">    return the_mode</span></pre><p id="8ff2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为<strong class="ih hj"> <em class="jd"> try </em> </strong>可以很容易地防止你的部分代码崩溃，如果你不小心的话，它会成为你找到异常灾难根源的绊脚石。</p><p id="d075" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">故事的寓意，用<strong class="ih hj"> <em class="jd">试</em> </strong>来控制不可控；<strong class="ih hj"> <em class="jd">除了</em> </strong>永远记住不要把事情弄得比你想的更复杂！</p><figure class="kh ki kj kk fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lp"><img src="../Images/a0509c6563442b3a2a6111009a939efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kZ1GOdOf4m0e5T9hac89A.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">是的，这段代码确实可以运行！使用<a class="ae ma" href="https://krita.org/en/" rel="noopener ugc nofollow" target="_blank"> Krita </a>、<a class="ae ma" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank"> PyCharm </a>和公共领域来源合成的图像。</figcaption></figure></div></div>    
</body>
</html>