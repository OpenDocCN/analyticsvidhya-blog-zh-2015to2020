<html>
<head>
<title>Why we move opposite to gradients in Gradient Descent??</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我们在梯度下降中与梯度方向相反？？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/why-we-move-opposite-to-gradients-in-gradient-descent-9077b9aa68e4?source=collection_archive---------4-----------------------#2019-08-31">https://medium.com/analytics-vidhya/why-we-move-opposite-to-gradients-in-gradient-descent-9077b9aa68e4?source=collection_archive---------4-----------------------#2019-08-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5af3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">梯度下降</strong>是一种寻找函数最小值的迭代优化算法。为了使用梯度下降找到函数的局部最小值，我们采取与函数在当前点的梯度的负值成比例的步骤。换句话说，我们的运动方向与梯度方向相反。你有没有想过为什么只有方向相反？为什么不是梯度方向？？？</p><p id="cf02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将试图从数学上证明为什么我们朝着与梯度相反的方向运动。</p><p id="f228" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先让我们试着理解梯度。梯度是由函数对变量的偏导数组成的向量。假设我们的函数看起来像J(w，b) = w + b，那么J(w，b)对w和b的偏导数是</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/42f5635b1e4a09074a3b8907169f9882.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*fa-JbfWpq2NxxRBH8XFASw.png"/></div></figure><p id="f03c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，梯度是这些偏导数的向量，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jl"><img src="../Images/5495a552619194a18b40ef26a1812017.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*XwleL--kWmCnn1GQR2EWtw.png"/></div></figure><p id="92f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们试着找出达到最小值的最佳运动方向。我们可以使用<strong class="ih hj">泰勒级数</strong>得出这个结果。泰勒级数将函数表示为无穷多个项的总和，这些项是根据函数在单个点的导数值计算得出的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jm"><img src="../Images/b5d0db3aec81452afccfe22fb59d72e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*WSnr1oUjdRUPBuyoq8BUtA.png"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated"><a class="ae jr" href="http://mathworld.wolfram.com/TaylorSeries.html" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="bbe6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果J(w)是当前成本值，并且我们在权重w中执行较小的更新η*u，则新的损失将是J(w + η*u)。这里η是这个函数的学习率超参数泰勒级数将看起来像:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es js"><img src="../Images/17fb50ac5718579bd7f4ff3984ea7473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*O6apUeBrSc4HCWET8OUMUg.png"/></div></figure><p id="0ebb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于η非常小，η之后的值将非常接近于零。因此我们可以忽略它们。因此，上述等式变为:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/4a125986e5ffccf3859ce1e24b6ed76a.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*cqXf9G_U2Dw6egpfiPSeng.png"/></div></figure><p id="a1ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新的损失J(w + η*u)应该理想地小于先前的损失J(w)。因此，上述值应该小于零，即</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/1827832837894ffa5525dcca52313ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*DqkjXgRTGDEnym3dzqXmOg.png"/></div></figure><p id="3dd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们知道两个向量的点积是向量间夹角的余弦。即a.b = |a||b|cos(θ)。用这个等式，我们得到</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/4c473597eb0fc2b82ff2c5354a88cd32.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*UtcFIur-UELpYpz1m-C0NA.png"/></div></figure><p id="ee68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中β是u和梯度之间的角度。我们知道cos θ的值介于-1和1之间。因此，上述等式也将位于</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jw"><img src="../Images/a0767201351a46a127cc4aac352076eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*16mGCXSXbfco3HUaw-FYUA.png"/></div></figure><p id="1039" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设分母等于k，我们得到k = || u || * || ∇ J(w) ||。或者</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jx"><img src="../Images/6240a5cbbef91d775d09479b4c35ac03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*0oYwdBWWjcBliklUnWstmg.png"/></div></figure><p id="a309" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们希望损失差为负或最小。由于k为正，当cos(β)为负时，损耗差将为负。当β为180度时，k*cos(β)的最小值。即u与坡度之间的角度应为180度。这意味着我们应该在与坡度成180度或与坡度相反的方向上移动，以最大限度地减少损失。</p><p id="527b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你们都已经找到了我们开始时提出的问题的答案。非常感谢你的阅读。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="a027" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jr" href="https://www.youtube.com/watch?v=giZD8yzXEZ4&amp;list=PLyqSpQzTE6M9gCgajvQbc68Hk_JKGBAYT&amp;index=22" rel="noopener ugc nofollow" target="_blank">深度学习—NPTEL by Mitesh Khapra<br/>https://www.youtube.com/watch?v=giZD8yzXEZ4&amp;list = plyqspqzte 6m 9 gcgajvqbc 68 hk _ JKGBAYT&amp;index = 22</a></p></div></div>    
</body>
</html>