<html>
<head>
<title>Text classification based on Apache Open NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Apache Open NLP的文本分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/text-classification-based-on-apache-open-nlp-317f82f4b1b0?source=collection_archive---------5-----------------------#2019-11-11">https://medium.com/analytics-vidhya/text-classification-based-on-apache-open-nlp-317f82f4b1b0?source=collection_archive---------5-----------------------#2019-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3aba" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Apache Open NLP产品中印第安人的力量和智慧允许您使用机器学习方法解决准备和分类文本的复杂任务。</h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/14a2da422ba41b1c23ff5e491cb238cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tO09tm7JCIQWaNVLHx5kZA.jpeg"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">www.freepik.com<a class="ae jo" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><h1 id="b537" class="jp jq hi bd jr js jt ju jv jw jx jy jz io ka ip kb ir kc is kd iu ke iv kf kg bi translated"><em class="ix">问题陈述</em></h1><p id="e6ea" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp kq kr ks kt ku kv kw kx ky kz la lb lc hb bi translated">在过去的几年里，机器学习为金融行业和智能经济开辟了新的机遇。例如，对营销和金融行业中的产品进行自动分类的任务就非常相关。为了自动生成产品目录而定义类别是一项流行的任务。另一项任务是确定买家感兴趣的对象，准备主要的消费篮子。这些和其他领域需要数据处理自动化。</p><p id="bfa3" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">Apache Open NLP库提供了各种工具来自动化这些任务，包括分类器的实现。分类中最有力的方法之一是最大熵准则。我们将不深究数学计算和概率论。你可以在这里看到(链接)。让我们开始检查它是如何工作的。首先，让我们为我们的任务导入java库。</p><h1 id="9e82" class="jp jq hi bd jr js jt ju jv jw jx jy jz io ka ip kb ir kc is kd iu ke iv kf kg bi translated"><em class="ix">库的使用及其导入</em></h1><pre class="iz ja jb jc fd li lj lk ll aw lm bi"><span id="1a63" class="ln jq hi lj b fi lo lp l lq lr"><strong class="lj hj">package </strong>nlp.textclass;<br/><br/><strong class="lj hj">import </strong>java.io.FileInputStream;<br/><strong class="lj hj">import </strong>java.io.InputStream;<br/><br/><strong class="lj hj">import </strong>opennlp.tools.postag.*;<br/><strong class="lj hj">import </strong>opennlp.tools.tokenize.*;<br/><strong class="lj hj">import </strong>opennlp.tools.util.*;<br/><strong class="lj hj">import </strong>java.io.*;<br/><strong class="lj hj">import </strong>java.util.*;<br/></span></pre><p id="5e90" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">为了进一步的工作，我们需要一个文本处理库和数据输入/输出工具。出于这些目的，我们将采用Apache基金会的开放NLP产品和用于组织输入/输出流的<a class="ae jo" href="https://mvnrepository.com/artifact/com.cedarsoftware/java-util/1.8.0" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> java.util </em> </a>库。我们开始准备数据吧。</p><h1 id="8947" class="jp jq hi bd jr js jt ju jv jw jx jy jz io ka ip kb ir kc is kd iu ke iv kf kg bi translated"><em class="ix">培训数据准备</em></h1><p id="6fad" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp kq kr ks kt ku kv kw kx ky kz la lb lc hb bi translated">在直接进行自动分类模型的生成之前，我想接收用于处理的数据并适当地准备它们。准备好数据和标签后，看起来是这样的。</p><p id="da77" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">这里第一个字是数据，第二个字是标签。</p><pre class="iz ja jb jc fd li lj lk ll aw lm bi"><span id="5bdd" class="ln jq hi lj b fi lo lp l lq lr">String[] product = [“cars_cargo” ,”ipad_electronic” ,”game_entertainment” ,”iphone_electronic” ,”stereo_electronic” ,”mouse_electronic” ,”keyboard_electronic” ,”tablet_electronic” ,”technic_electronic” ,”electronic_electronic” ,”analise_medical” ,”drugs_medical” ,”gas_oil” ,”shave_goods” ,”trousers_clothes” ,”bottle_alcohol” ,”bycicle_bike” ,”bike_bike” ,”stuff_clothes” ,”vine_alcohol” ,”water_goods” ,”jeance_clothes” ,”food_food”];</span></pre><p id="e849" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">我们得到文件<strong class="kj hj"> gen_data.txt. </strong>训练数据可能包括<strong class="kj hj">所有可用</strong>的80%。如果我们想解决一个真正的问题，我们需要更多的数据！</p><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es lt"><img src="../Images/a26cf0d57a57f8e5b85339b3859065d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*nnlmoaR0BeRTzCkis0KldQ.jpeg"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">www.freepik.com</a></figcaption></figure><p id="d479" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">它必须是<strong class="kj hj">5000以上</strong>或【50000以上标明的要素。</p><p id="1403" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">当我们得到规范化和结构化的数据时，我们就可以开始构建模型了。该模型由一组训练数据生成。</p><h1 id="b9fa" class="jp jq hi bd jr js jt ju jv jw jx jy jz io ka ip kb ir kc is kd iu ke iv kf kg bi translated">模型生成</h1><figure class="iz ja jb jc fd jd"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="3a9b" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">在训练并获得<strong class="kj hj">模型-Maxent之后，</strong>我们可以在各种测试数据上对其进行测试。<strong class="kj hj">测试数据可以是所有数据的20%。但是在测试模型之前，我们将为输入文本添加处理程序。这是一个句子检测器和分词器。</strong></p><h1 id="c13b" class="jp jq hi bd jr js jt ju jv jw jx jy jz io ka ip kb ir kc is kd iu ke iv kf kg bi translated"><em class="ix">句子检测器和分词器</em></h1><figure class="iz ja jb jc fd jd"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="607b" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">要对产品进行分类，必须在输入文本中选择单独的单词。在这个例子中，我们将文本分成单独的句子，然后分成单词。我们建立我们的<strong class="kj hj">词性模型(POSmodel) </strong>，之后，than。</p><pre class="iz ja jb jc fd li lj lk ll aw lm bi"><span id="912c" class="ln jq hi lj b fi lo lp l lq lr">POSModel model = POSTaggerME.<em class="ls">train</em>("en", sampleStream, TrainingParameters.<em class="ls">defaultParams</em>(), posModel.getFactory());<br/>Sequence sequences[] = posTagger.topKSequences(message);</span></pre><p id="902a" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">训练结果是这样的。</p><pre class="iz ja jb jc fd li lj lk ll aw lm bi"><span id="36bd" class="ln jq hi lj b fi lo lp l lq lr">POS model started<br/>Indexing events using cutoff of 5</span><span id="2507" class="ln jq hi lj b fi lw lp l lq lr">Computing event counts… done. 374 events<br/> Indexing… done.<br/>Sorting and merging events… done. Reduced 374 events to 366.<br/>Done indexing.<br/>Incorporating indexed data for training… <br/>done.<br/> Number of Event Tokens: 366<br/> Number of Outcomes: 47<br/> Number of Predicates: 99<br/>…done.<br/>Computing model parameters …<br/>Performing 100 iterations.<br/> 1: … loglikelihood=-1439.955203039556 0.016042780748663103<br/> 2: … loglikelihood=-1153.0290547162213 0.27807486631016043<br/> 3: … loglikelihood=-1027.8934671969257 0.2914438502673797<br/>...</span><span id="9d49" class="ln jq hi lj b fi lw lp l lq lr">99: … loglikelihood=-328.84956863946474 0.7593582887700535<br/>100: … loglikelihood=-327.86155121782036 0.7593582887700535<br/>Model generated…<br/>Process finished with exit code 0</span></pre><p id="7104" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">如果模型已经存在，我们可以从文件中加载它。</p><pre class="iz ja jb jc fd li lj lk ll aw lm bi"><span id="ec1a" class="ln jq hi lj b fi lo lp l lq lr">InputStream inPosStream = getClass().getClassLoader().getResourceAsStream("en-pos.dat");<br/>POSModel posModel = new POSModel(inPosStream);<br/>inPosStream.close();<br/>POSTaggerME posTagger = new POSTaggerME(posModel);</span></pre><p id="3b4a" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">做得好，现在让我们继续测试，这在代码中有记录。然后每个单词都会被分类和标注(TAG)，例如:</p><pre class="iz ja jb jc fd li lj lk ll aw lm bi"><span id="e5bf" class="ln jq hi lj b fi lo lp l lq lr">-&gt; OpenNLP: tag detector<br/>boots it is clothes<br/>dress it is clothes</span></pre><p id="cf45" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">我们得到一个模型，然后在文本上运行它，文本被分成单词。它检测单词并使用Java代码对它们进行分类。我们使用了OpenNLP库并创建了NLPClassifier类(详细代码在<a class="ae jo" href="https://github.com/AlexTitovWork/NLPclassifier/blob/master/src/main/java/NLPClassifier.java" rel="noopener ugc nofollow" target="_blank"> Github </a>上)</p><pre class="iz ja jb jc fd li lj lk ll aw lm bi"><span id="40d3" class="ln jq hi lj b fi lo lp l lq lr">public class NLPClassifier {…}</span></pre><p id="e1ae" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">让我们测试一下<strong class="kj hj">句子检测器</strong>。用作<strong class="kj hj">分割器</strong>的<strong class="kj hj">标记器</strong>。<strong class="kj hj">后置分类器</strong>，在主函数中作为<strong class="kj hj">分类器</strong>使用。你可以在<a class="ae jo" href="https://github.com/AlexTitovWork/NLPclassifier/blob/master/src/main/java/NlpProductClassifier.java" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到代码</p><figure class="iz ja jb jc fd jd"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="0d27" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">POS标记器的完整代码和经过测试的<strong class="kj hj">二进制</strong> <strong class="kj hj">模型</strong>都在资源库中。</p><div class="lx ly ez fb lz ma"><a href="https://github.com/AlexTitovWork/NLPclassifier" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hj fi z dy mf ea eb mg ed ef hh bi translated">AlexTitovWork/NLP分类器</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">MLP分类器它是基于OpenNLP库的产品分类器。使用OpenNLP库的营销数据分类器OpenNLP…</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">github.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo ji ma"/></div></div></a></div><p id="6738" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">其他对象</p><div class="lx ly ez fb lz ma"><a href="https://github.com/AlexTitovWork" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hj fi z dy mf ea eb mg ed ef hh bi translated">AlexTitovWork -概述</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">在GitHub上注册您自己的个人资料，这是托管代码、管理项目和与40…</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">github.com</p></div></div><div class="mj l"><div class="mp l ml mm mn mj mo ji ma"/></div></div></a></div><p id="2a60" class="pw-post-body-paragraph kh ki hi kj b kk ld ij km kn le im kp kq lf ks kt ku lg kw kx ky lh la lb lc hb bi translated">祝福你，亚历克斯！</p></div></div>    
</body>
</html>