<html>
<head>
<title>Exploring the Pandas groupby() function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索Pandas groupby()函数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploring-the-pandas-groupby-function-b8c75404fe29?source=collection_archive---------25-----------------------#2020-05-26">https://medium.com/analytics-vidhya/exploring-the-pandas-groupby-function-b8c75404fe29?source=collection_archive---------25-----------------------#2020-05-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c0cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在真实业务用例的帮助下</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/c6d1717a202aee973ed46bf916e22489.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J7Bu0jvRshMa4Y3g"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">亚当·诺瓦克斯基在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="349f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你收到任何新的数据时，你都要尽可能多地做出推论。</p><blockquote class="ju jv jw"><p id="0e47" class="if ig jx ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">如果您的数据有性别、年龄组、教育水平等类别，如果您能够分别提取每个类别的见解，这将非常有用。</p></blockquote><p id="0157" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样做可以回答如下问题:</p><ol class=""><li id="7867" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">学历高工资高吗？</li><li id="836e" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">小城镇的房子比城市的便宜吗？</li><li id="7fa6" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">在所有零售商店中，表现最好的商店是哪家？</li></ol><p id="6c96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是GroupBy增加巨大价值的地方。</p><p id="c11a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Groupby并不是熊猫独有的。由于它是一个重要的分析工具，它存在于:</p><ol class=""><li id="f72c" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">MS-Excel:数据透视表形式</li><li id="a022" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">r:<a class="ae jt" href="https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/group_by" rel="noopener ugc nofollow" target="_blank"><em class="jx">group _ by</em></a><em class="jx"/>函数</li><li id="a328" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">SQL: group by子句</li></ol><p id="0b91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，现在我们清楚了它的重要性，让我们来学习Groupby的机制。</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><p id="73b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">办公用品公司是一家很受欢迎的文具店，在美国有11个销售代表。</p><p id="7dab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该区域分为三个区域:<strong class="ih hj"> <em class="jx">中部、</em> </strong>东部和<strong class="ih hj"> <em class="jx">西部。</em>T19】</strong></p><p id="bc3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的数据集包含所有三个地区一天内销售的文具产品的信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/3453a7aeefaa0939aba8b7cf9bcb38f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*KrkMqelqv6PYUFzaXjvLPg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">办公用品数据集</figcaption></figure></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h2 id="699e" class="kx ky hi bd kz la lb lc ld le lf lg lh iq li lj lk iu ll lm ln iy lo lp lq lr bi translated"><strong class="ak">重要参数</strong></h2><p id="ad4e" class="pw-post-body-paragraph if ig hi ih b ii ls ik il im lt io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated"><strong class="ih hj"> <em class="jx"> by </em> </strong>:该参数告诉类别将作为不同组的列。</p><p id="b144" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，由于我们是基于地区来探索销售，我们将把参数赋值为</p><p id="cdd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jx"> by= 'Region' </em></p><h2 id="d54e" class="kx ky hi bd kz la lb lc ld le lf lg lh iq li lj lk iu ll lm ln iy lo lp lq lr bi translated"><strong class="ak">机制</strong></h2><p id="27de" class="pw-post-body-paragraph if ig hi ih b ii ls ik il im lt io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">Groupby将按以下方式运行:</p><ol class=""><li id="82f0" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj"> Split </strong>:首先将数据帧分割成多个类别，如下图:</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/c79eba5e8f72e19efb8ff024479dd615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*BmMyUGBowicAvbxyk3xHuw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">分组依据-插图</figcaption></figure><p id="8dbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">应用:</strong>对每个组应用一个函数。假设我们想计算每个地区的总销售量。在这种情况下，我们将使用sum()函数。</p><p id="5e55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是后端将发生的情况:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/e6192159b11d0318c1cab9a390c2d25f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DEfxvteIcFA31jJHu46dug.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">分组依据-插图</figcaption></figure><p id="dcd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你所看到的，对于每一组，一个单位的总和是分开的</p><p id="7940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.<strong class="ih hj">合并:</strong>该步骤将最终输出合并成一个数据帧。</p><p id="ab78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候深入研究数据集了。打开你的Jupyter笔记本，跟着做吧！</p><h1 id="d888" class="lz ky hi bd kz ma mb mc ld md me mf lh mg mh mi lk mj mk ml ln mm mn mo lq mp bi translated">入门指南</h1><p id="9dff" class="pw-post-body-paragraph if ig hi ih b ii ls ik il im lt io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">让我们从检查数据样本开始</p><pre class="je jf jg jh fd mq mr ms mt aw mu bi"><span id="0896" class="kx ky hi mr b fi mv mw l mx my">import pandas as pd<br/>data=pd.read_csv('OfficeSupplies.csv')<br/>data.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mz"><img src="../Images/1b3c8ea318e276cbc4549eb46e8cf7d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*cr_iQkbgPO8q0LJ2D4jRPw.png"/></div></figure><p id="5ffe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们找出销售额最高的地区:</p><p id="2851" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们只关心售出的单位数量，所以我们将只选择“单位”列:</p><pre class="je jf jg jh fd mq mr ms mt aw mu bi"><span id="0af7" class="kx ky hi mr b fi mv mw l mx my">data.groupby(by='Region')['Units'].sum()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es na"><img src="../Images/748f3b2c160ca86454c730b1f9aeee0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*nZH3_BOqhfZLcSmzJzPQ2w.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">输出</figcaption></figure><p id="dfcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所看到的，就售出的单位数量而言，<strong class="ih hj">中部</strong>地区的表现优于其他地区。</p><p id="ef8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">介意深入探究一下为什么吗？</strong></p><p id="8b38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看地区销售人员的数量…</p><pre class="je jf jg jh fd mq mr ms mt aw mu bi"><span id="cd8b" class="kx ky hi mr b fi mv mw l mx my">data.groupby(by='Region')['Rep'].count()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nb"><img src="../Images/768b63e115a0b375c965eef210300980.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*2MKiWS2bKnMqu12wJZFWeA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">结果</figcaption></figure><p id="e6d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jx">有趣的是，报告的最高销售额来自拥有最多销售人员的同一地区。</em></p><p id="7727" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么会这样？</p><p id="6690" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是可以解释的。我的假设是，与东部和西部地区相比，中部地区的面积要大得多。</p><p id="a4f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">。各地区的销售人员比例为1:2:4</p><p id="7fe1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">。巧合的是，售出的单位也是同样的比例</p><p id="ea91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你自己试试！</p><p id="d3b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">链接到数据集:<a class="ae jt" href="https://www.kaggle.com/fmendes/office-supply-sales" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/fmendes/office-supply-sales</a></p></div></div>    
</body>
</html>