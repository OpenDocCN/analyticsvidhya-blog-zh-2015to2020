<html>
<head>
<title>Hands-On Machine Learning — Simple Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动手机器学习—简单线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hands-on-machine-learning-simple-linear-regres-c9bdf0b58549?source=collection_archive---------15-----------------------#2020-11-07">https://medium.com/analytics-vidhya/hands-on-machine-learning-simple-linear-regres-c9bdf0b58549?source=collection_archive---------15-----------------------#2020-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/c8fc00e325bd9bb43333a9361344362e.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/0*fce89yBvRsSVVTd1.jpg"/></div></figure><p id="f3d7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">也许关于 python 和数据科学的最好的书籍之一是 Géron 的<em class="jk">用 Scikit-Learn、Keras &amp; TensorFlow </em>进行机器学习的实践。在我看来，这本书特别适合初学者。对于自学成才的数据科学家来说，这本书是绝对必须的。有几个包含代码的指导性项目，为有抱负的数据科学家提供指导。</p><p id="044d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">了解 Scikit-Learn、Keras 和 TensorFlow 对于数据科学家来说也是绝对必须的，因为雇主热衷于这些库及其模块。简要总结:</p><p id="4fef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Scikit-Learn 是一个 Python 的机器学习库，具有统计分析、监督和非监督学习的各种算法。</p><p id="e5a9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Keras 是一个人工神经网络库。</p><p id="b093" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">TensorFlow 是另一个用于机器学习的库，但专注于训练深度神经网络。</p><p id="aed4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这本书用代码指导读者，并对代码做什么以及如何工作做了很好的解释。它还解释了各种算法和神经网络如何与图表和视觉效果一起工作。在我看来，这是理论和实践之间的巨大平衡。</p><h1 id="ea65" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">第 1 章简单线性回归</h1><p id="1545" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">第一章涵盖 scikit-learn 线性模型和一个非常简单的线性回归问题。数据集是经合组织 2015 年美好生活指数。下面是人均 GDP 和生活满意度之间的线性模型的代码。</p><p id="fb2a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[1]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8d0d" class="kx jm hi kt b fi ky kz l la lb"><strong class="kt hj">import</strong> <strong class="kt hj">matplotlib.pyplot</strong> <strong class="kt hj">as</strong> <strong class="kt hj">plt</strong><br/><strong class="kt hj">import</strong> <strong class="kt hj">numpy</strong> <strong class="kt hj">as</strong> <strong class="kt hj">np</strong><br/><strong class="kt hj">import</strong> <strong class="kt hj">pandas</strong> <strong class="kt hj">as</strong> <strong class="kt hj">pd</strong><br/><strong class="kt hj">import</strong> <strong class="kt hj">sklearn.linear_model</strong></span></pre><p id="9b6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[2]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="760a" class="kx jm hi kt b fi ky kz l la lb">oecd_bli = pd.read_csv("oecd_bli_2015.csv",thousands = ',')<br/>gdp_per_capita = pd.read_csv('gdp_per_capita.csv',thousands=',',delimiter='<strong class="kt hj">\t</strong>',encoding='latin1',na_values = 'n/a')</span></pre><p id="ce50" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[7]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="f397" class="kx jm hi kt b fi ky kz l la lb"><strong class="kt hj">def</strong> prepare_country_stats(oecd_bli,gdp_per_capita):<br/>    oecd_bli = oecd_bli[oecd_bli['INEQUALITY']=='TOT']<br/>    oecd_bli = oecd_bli.pivot(index='Country',columns='Indicator',values='Value')<br/>    gdp_per_capita.rename(columns={'2015':'GDP per capita'},inplace=<strong class="kt hj">True</strong>)<br/>    gdp_per_capita.set_index('Country',inplace=<strong class="kt hj">True</strong>)<br/>    full_country_stats = pd.merge(left=oecd_bli,right=gdp_per_capita,left_index=<strong class="kt hj">True</strong>,right_index=<strong class="kt hj">True</strong>)<br/>    full_country_stats.sort_values(by='GDP per capita',inplace=<strong class="kt hj">True</strong>)<br/>    remove_indices = [0,1,6,8,33,34,35]<br/>    keep_indices = list(set(range(36))-set(remove_indices))<br/>    <strong class="kt hj">return</strong> full_country_stats[['GDP per capita', 'Life satisfaction']].iloc[keep_indices]</span></pre><p id="ba13" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[8]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="ce08" class="kx jm hi kt b fi ky kz l la lb">country_stats = prepare_country_stats(oecd_bli,gdp_per_capita)</span></pre><p id="4745" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[10]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="c353" class="kx jm hi kt b fi ky kz l la lb">X = np.c_[country_stats['GDP per capita']]<br/>y = np.c_[country_stats['Life satisfaction']]</span></pre><p id="ef57" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[11]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9323" class="kx jm hi kt b fi ky kz l la lb">country_stats.plot(kind = 'scatter',x='GDP per capita', y='Life satisfaction')<br/>plt.show()</span></pre><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/4e3a3adac30fa5d6b1b8907beb0214d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*4fUh0twTeOOfUfK0cPFjeQ.png"/></div></figure><p id="a57c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[12]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9523" class="kx jm hi kt b fi ky kz l la lb">model = sklearn.linear_model.LinearRegression()</span></pre><p id="03a6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[13]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="d79e" class="kx jm hi kt b fi ky kz l la lb">model.fit(X,y)</span></pre><p id="bd80" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Out[13]:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="a35a" class="kx jm hi kt b fi ky kz l la lb">LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)</span></pre><p id="f1ba" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[14]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="31ca" class="kx jm hi kt b fi ky kz l la lb">X_new = [[22587]] <em class="jk"># GDP per capita for Cyprus</em></span></pre><p id="d0ad" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在[15]中:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="2045" class="kx jm hi kt b fi ky kz l la lb">print(model.predict(X_new))</span><span id="e721" class="kx jm hi kt b fi ld kz l la lb">[[5.96242338]]</span></pre><p id="59ec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">塞浦路斯的数据不详，但根据线性模型，该国的生活满意度应为 5.96。斯洛文尼亚为 5.7，人均国内生产总值为 20，732 美元。这是一个非常简单的(x，y)模型，只有两个变量。该数据集具有许多其他变量和特征，其他 scikit-learn 模型可能更适合这些变量和特征。</p></div></div>    
</body>
</html>