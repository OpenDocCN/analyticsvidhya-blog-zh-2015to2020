<html>
<head>
<title>Classification and Detection of Covid-19 and other diseases using the power of Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习的能力对新冠肺炎病和其他疾病进行分类和检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/classification-and-detection-of-covid-19-and-other-diseases-using-the-power-of-machine-learning-a4005235ff65?source=collection_archive---------10-----------------------#2020-11-06">https://medium.com/analytics-vidhya/classification-and-detection-of-covid-19-and-other-diseases-using-the-power-of-machine-learning-a4005235ff65?source=collection_archive---------10-----------------------#2020-11-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="51a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经网络库Keras与Tenserflow一起用作后端</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7f39fec84b66ddbbfa216fa964543851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZbeu4slVJyTrOkgT53q-A.jpeg"/></div></div></figure><h2 id="7d9f" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">介绍</h2><p id="2f89" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">近年来，深度学习在人工智能领域取得了巨大成功。深度学习使得人工智能任务更容易预测，并与计算机智能一起工作。特别是对于图像分类，现在每个人都更喜欢CNN(卷积神经网络)而不是其他层，因为它的高精度，而且它具有从图像中提取特征的高潜力，这有助于对图像进行分类(即本项目中的疾病)，最重要的是，CNN(卷积神经网络)自早期发展以来主要用于图像分析。</p><p id="5bb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着大数据分析技术的发展，人们越来越重视从大数据分析的角度进行疾病预测，各种研究通过从大量数据中自动选择特征来提高风险分类的准确性，而不是以前选择的特征。然而，这些现有的工作大多考虑结构化数据。例如，对于非结构化数据，利用卷积神经网络(CNN)自动提取文本特征已经引起了广泛的关注，也取得了很好的效果。</p><h2 id="cd7f" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">目标:</h2><ul class=""><li id="76eb" class="kp kq hi ih b ii kk im kl iq kr iu ks iy kt jc ku kv kw kx bi translated"><strong class="ih hj">预测</strong>患者是否应该被诊断为疾病。这是一个<strong class="ih hj">双星</strong>的结局。<br/><strong class="ih hj"/>(+)= 1，患者诊断为疾病<br/> <strong class="ih hj">阴性</strong> (-) = 0，患者未诊断为疾病</li><li id="7dab" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">用各种<strong class="ih hj">分类模型</strong> &amp;做实验，看看哪一个产生最大的<strong class="ih hj">准确度</strong>。</li><li id="588f" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">检查我们数据中的<strong class="ih hj">趋势</strong> &amp; <strong class="ih hj">相关性</strong></li><li id="eb06" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">确定哪些<strong class="ih hj">特征</strong>对阳性/阴性疾病诊断<strong class="ih hj">最重要</strong></li></ul><h1 id="11d2" class="ld jq hi bd jr le lf lg jv lh li lj jz lk ll lm kc ln lo lp kf lq lr ls ki lt bi translated">体系结构</h1><p id="7c79" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">对于该项目，创建了不同的疾病分类模型，作为后端并提供结果。疾病预测模型，如Covid'19、疟疾、慢性肾病、糖尿病等。使用预先训练的模型通过一系列算法和分类来预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/f9c8b8937e4d78f25b2fca09bb343dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsXxmNXuso0tMAZPiJZd4w.png"/></div></div></figure><p id="fbd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个系统设计由以下模块组成:</p><p id="7bde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Covid'19分类模型</p><p id="6235" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">疟疾分类模型</p><p id="1daf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">糖尿病分类模型</p><p id="145d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">慢性肾脏病分类模型</p><p id="f8ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">肺炎分类模型</p><p id="ac5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">糖尿病视网膜病变分类模型</p><h1 id="e804" class="ld jq hi bd jr le lf lg jv lh li lj jz lk ll lm kc ln lo lp kf lq lr ls ki lt bi translated">迁移学习和CNN</h1><p id="1cc3" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">CNN的训练是使用名为Keras的Python库和Tensorflow backend进行的，这是一个深度学习框架。Imagenet数据集已被广泛用于构建各种架构，因为它足够大(1.2M图像)以创建通用模型。虽然，问题陈述来自于训练一个模型。我们使用迁移学习来推广到ImageNet数据集之外的图像。这仅发生在预训练模型的情况下。此外，我们使用微调模型对预训练模型进行修改。</p><p id="81b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络(CNN)是<strong class="ih hj">深度学习神经网络</strong>的一类。CNN代表了图像识别的巨大突破。它们最常用于分析视觉图像，并且经常在图像分类的幕后工作</p><h2 id="635e" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">履行</h2><p id="3401" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">Keras库通过Tensorflow后端导入。导入了Model、VGG19、ImageDataGenerator等库。对于问题陈述，使用VGG19，因为它比resnet50、exception、mobilenet等迁移学习技术提供更好的准确性。顺序模型也被导入。Google Colab用于模型的执行。</p><p id="09ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了训练和测试的目的，为模型定义图像数据集路径。数据集的大小在决定VGG16、VGG19等模型的效率方面起着重要作用。根据原始尺寸调整图像大小，以便更好地确定最佳结果。VGG19库被调用来定义像RBG通道，权重，include_top这样的参数。Imagenet被分配给权重参数，该参数包含用于创建最先进算法的数百万幅图像。include_top参数被指定为false以剪切第一层和最后一层，因为它们用于定义图像大小和类别数。</p><p id="8bdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着迁移学习技术的实施，每一层都不再需要人工训练，因为重量是在VGG预先训练的。基于输出，在最后一层需要一些节点，但是不需要训练所有层。除了要添加的最后一层之外，卷积层都被冻结了。VGG19滚动输出，然后通过flatten()函数将其展平，这是添加密集图层所必需的。输出层将包含两个节点，文件夹和激活功能的长度为“softmax”。如果考虑单个节点，将使用sigmoid激活函数。该层用作模型预测过程中的密集层。model.summary用于查找关于所创建的层的详细信息。Keras调谐器是一个工具，建议验证您的参数，并保持检查。从头开始创建模型时，所有层都被冻结，只有最后一层被重复训练以获得高精度。</p><p id="0879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在模型的编译是使用分类交叉熵完成的。损失函数分类交叉熵用于量化深度学习模型错误，通常在单标签、多类分类问题中。如果使用单个节点，编译将通过二进制交叉熵来完成。</p><p id="0e8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ImageDataGenerator用于从数据集中导入和读取图像。基于个人需求，应用图像增强以在数据集上获得最佳结果。测试数据集只是进行了重新缩放，像素范围大幅缩小。增强技术被分别用于生成模型的训练集和测试集。</p><p id="f88a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">时期在模型中运行，具有指定训练集、验证集、批量大小等的各种参数。时期是机器学习中使用的术语，表示机器学习算法已经完成的整个训练数据集的通过次数。数据集通常被分组成批(尤其是当数据量非常大的时候)。训练模型的持续时间直接取决于历元的数量。因此，确定最佳历元数非常重要。如果你有足够的数据，你可以尝试早期停止法:将数据分成三个数据集，训练，验证和评估。沿着足够数量的历元训练每个网络，以查看固定在最小值的训练均方误差。训练过程使用训练数据集，并且必须逐个时期地执行，以便为验证集计算每个时期中网络的均方误差。具有最小验证MSE的时期的网络被选择用于评估过程。这种方法也可以应用于正则化方法和k-fold交叉验证。</p><h2 id="a34d" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">最大池层</h2><p id="1157" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">它进行下采样，这意味着它从较大的图像输出较小的图像。例如，如果我们在卷积层中有(224，224)大小的图像，那么当使用(2，2)的最大池时，它确实将图像的大小减小到(112，112)。它会减小图像的大小，直到图像到达最终的卷积层。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/9bfc0b7f79309c3740ff8d543e5c2354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ZB6tUUQCn_63YmG2d8DFQ.png"/></div></div></figure><blockquote class="lw lx ly"><p id="11f7" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">疟疾分类模型</p></blockquote><p id="15c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型是在深度学习中使用CNN(卷积神经网络)创建的，使用TensorFlow库和Keras API，在16k训练图像下每个时期训练大约需要2小时。在训练集上的结果是94%,在验证集上的结果是92%,这是相当好的，并且使用数据扩充技术也解决了过拟合问题。在完成我的模型后，我还分析了CNN是深度学习框架中使用TensorFlow后端进行图像分类的最佳技术之一。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/fb53bd5a333b3d7588d0abcd06f18522.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*kWxnVyx1Q3G92dTu58MmTw.png"/></div><figcaption class="me mf et er es mg mh bd b be z dx translated">精确度图表</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mi"><img src="../Images/1df859a5b02b985efea37ed8623e88d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*hkHuLb6Zi8nA76Tyn4JooQ.png"/></div><figcaption class="me mf et er es mg mh bd b be z dx translated">损失图</figcaption></figure><blockquote class="lw lx ly"><p id="85f4" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">糖尿病视网膜检影分类模型</p></blockquote><p id="61c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型是在深度学习中使用CNN(卷积神经网络)创建的，使用TensorFlow库和Keras API，在4k训练图像下每个时期训练大约需要20分钟。在训练集上的结果是96%,这是相当好的，并且使用数据扩充技术也解决了过拟合问题。在完成我的模型后，我还分析了CNN是深度学习框架中使用TensorFlow后端进行图像分类的最佳技术之一。</p><blockquote class="lw lx ly"><p id="2065" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">慢性肾脏分类模型</p></blockquote><p id="a073" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型是在深度学习中使用CNN(卷积神经网络)创建的，使用了具有400行数据的sklearn、pandas和pickle库。年龄、血压、红细胞和其他21个健康相关属性等列被用作数据集。通过在训练集中使用交叉验证对参数进行适当调整，随机森林分类器实现了92%的准确性和99.2%的ROC AUC。经验教训:一些修剪有助于提高RF的性能。</p><p id="d53c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林是一种元估计器，它在数据集的各个子样本上拟合多个决策树分类器，并使用平均来提高预测精度和控制过拟合。如果<code class="du mj mk ml mm b">bootstrap=True</code>(默认)，子样本大小由<code class="du mj mk ml mm b">max_samples</code>参数控制，否则使用整个数据集构建每棵树。</p></div><div class="ab cl mn mo gp mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="hb hc hd he hf"><blockquote class="lw lx ly"><p id="00da" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">最终结果</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mu"><img src="../Images/13f19f25cf87f2deafc9fb931317197c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwS6IvV3uW2WBcw4sSxoWw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mu"><img src="../Images/c1607a1dec2da5d9ca8b1b995c7d9fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oF-g7Wm6jBtNlaukbGhkJg.png"/></div></div></figure></div></div>    
</body>
</html>