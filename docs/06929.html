<html>
<head>
<title>Your Algebra Class Did (Not) Prepare You for This Machine Learning Housing Price Predictor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的代数课没有让你为这个机器学习房价预测器做好准备</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/your-algebra-class-did-not-prepare-you-for-this-machine-learning-housing-price-predictor-b63e691b0bc5?source=collection_archive---------23-----------------------#2020-06-07">https://medium.com/analytics-vidhya/your-algebra-class-did-not-prepare-you-for-this-machine-learning-housing-price-predictor-b63e691b0bc5?source=collection_archive---------23-----------------------#2020-06-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5762" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用线性回归的ML项目&amp;波士顿住房数据集</h2></div><p id="5628" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你的代数课和我的一样，直线方程y=mx+b会永久地印在你的大脑中。您甚至可能还记得使用这个等式来寻找最适合数据的直线。</p><p id="c7e4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无论你做了多少只试图将…线的重要性联系起来的应用题，你可能都没有完全理解在数学课之外了解线性回归会对你产生怎样的影响。暗示你的同学，或者甚至你，问那个臭名昭著的"<em class="jt">为什么我们需要再次知道这个？</em>或者<em class="jt">这对我有什么帮助？</em></p><p id="030a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尝试自己回答这些问题可能是这样的:</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/a98f7083cd58385727c3025911ceaf3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FF3YHa6frgRvm7GG.jpg"/></div></div></figure><p id="f753" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我来为你解答:<strong class="iz hj">机器学习。这就是原因。就是这样。</strong>你的代数课可能已经让线性回归在你的脑海中根深蒂固，但你没有意识到的是，它可能也在为你理解机器学习做准备。如果你仍然觉得自己是个困惑的数学女士，那么本文的其余部分应该会让你明白我们如何在机器学习中使用线性回归来制作强大的预测工具。</p><p id="37ca" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">特别是在这个项目中，我使用线性回归法，根据房屋所在城镇的师生比例和城镇中较低地位人口的百分比等因素，对房价进行了预测。</p><p id="f006" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但首先，让我们探索一下为什么我们要使用机器学习，以及线性回归如何适用于此。</p><h1 id="6bcb" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">机器学习预测未来</h1><p id="246c" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">真的，ML能做到？</p><p id="e4d4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗯，不完全是，但是监督机器学习实际上是一种从数据中做出预测的非常强大的方法。</p><p id="92a5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们被给定一组输入和输出时，监督学习就发生了。计算机学习根据输入来预测输出，并通过将其预测与已知输出进行比较来检查它有多接近。这被认为是“受监督的”,因为我们从数据集知道给定特定输入时什么输出是正确的，并且计算机可以学习它是对还是错。</p><p id="d96e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就代数而言，监督ML是计算机学习基于x和y值的训练集将x映射到y的函数的过程。基本上，<strong class="iz hj">计算机就是用一个已知的x和y来求满足关系y=f(x) </strong>的函数f。</p><p id="248c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在监督学习中，数据集被操纵并分成两组，以实现预测模型:</p><ul class=""><li id="f6b7" class="ld le hi iz b ja jb jd je jg lf jk lg jo lh js li lj lk ll bi translated"><strong class="iz hj">训练数据</strong>:计算机用于<strong class="iz hj">创建模型</strong>的数据。这包括输入(x值)和输出(y值)。</li><li id="d7a7" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated"><strong class="iz hj">测试数据</strong>:计算机用来<strong class="iz hj">学习和改进模型的数据。</strong>测试数据的输入通过模型运行，产生输出(预测)。然后，该模型将其预测输出与测试数据的实际输出进行比较，以确定其拟合程度，并调整模型以更好地拟合数据。</li></ul><p id="0eb3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">简而言之，所有受监督的ML实际上就是<strong class="iz hj">从已知数据中提取关系，以预测新数据的关系。</strong></p><p id="dbd3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后一旦我们有了那个关系(那个函数f)，<strong class="iz hj">我们就可以插入<em class="jt">任何</em> <em class="jt">新的</em> <em class="jt">输入</em>并以相对的置信度预测其输出</strong>。我将在接下来的章节中介绍函数f(x)是什么样的，以及如何使用统计学来确定置信度。</p><h2 id="05fd" class="lr kh hi bd ki ls lt lu km lv lw lx kq jg ly lz ks jk ma mb ku jo mc md kw me bi translated">监督学习的两种类型</h2><p id="c017" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们选择什么类型的模型取决于数据，对于监督学习，它取决于输出的性质，或y值。</p><p id="e00b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">分类</strong>用于<strong class="iz hj"/><strong class="iz hj">输出值离散</strong>的情况。因此，函数f也将是离散的。换句话说，输出被限制在预先确定的类别中，如0或1，猫或狗，黑或白。可以有任意数量的这些类别，也称为类。</p><p id="951e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是监督学习的另一个特点:标签。监管的一部分来自于这样一个事实，即在分类模型中，计算机被赋予每一类数据的标签，而不必自己去弄清楚它们。</p><p id="4aad" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">回归</strong>，另一方面，当<strong class="iz hj">输出值连续时使用。所以，函数f将是连续的。这意味着输出可以取某一范围内的任何值。回归模型的可能输出可能是年龄、体重、利润。同样，因为回归是受监督的，所以计算机知道它预测的目标变量。</strong></p><p id="deb5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">连续函数f意味着我们可以只用一个方程来描述所有已知的数据。对于这个项目，我探索了<strong class="iz hj">线性回归</strong>，或者根据一条线对数据建模，但是当然，还有其他更复杂的回归形式，更适合更复杂的数据集。对于波士顿住房数据集，线性回归工作得很好。</p><p id="32d0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，使用线性回归来模拟我们的数据，函数f可以通过代数课y=mx+b中的方程找到，只需做一些小的调整，我将在接下来分享。</p><h1 id="bf3a" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">工作流程</h1><p id="9480" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">这个Python项目是在Google Colab环境中用Jupyter笔记本创建的。该项目可在<a class="ae mf" href="https://github.com/calidocious/housing-reg" rel="noopener ugc nofollow" target="_blank">github.com/calidocious/housing-reg</a>找到</p><p id="8306" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我将概述我的项目的主要步骤:</p><ol class=""><li id="262f" class="ld le hi iz b ja jb jd je jg lf jk lg jo lh js mg lj lk ll bi translated">加载数据集及其统计数据</li><li id="4cfd" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js mg lj lk ll bi translated">查找数据集的相关要素</li><li id="74f4" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js mg lj lk ll bi translated">使用相关特征训练线性回归模型</li><li id="728f" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js mg lj lk ll bi translated">测试和评估模型</li></ol><h2 id="83ea" class="lr kh hi bd ki ls lt lu km lv lw lx kq jg ly lz ks jk ma mb ku jo mc md kw me bi translated">1.加载数据集及其统计数据</h2><p id="cac0" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在应用任何ML模型之前，我们首先应该理解我们正在处理的数据。为此，我们制作了一个<strong class="iz hj">数据帧</strong>，它是一个<strong class="iz hj">字典对象</strong>。很容易将数据帧想象成行和列相互关联的<strong class="iz hj">结构</strong>，就像字典中的一个单词有多个定义一样。在数据框中，每一列就像是每一段数据的一个“定义”。</p><pre class="jv jw jx jy fd mh mi mj mk aw ml bi"><span id="6d3f" class="lr kh hi mi b fi mm mn l mo mp">df = pd.DataFrame(boston.data, columns=boston.feature_names)</span><span id="b0d7" class="lr kh hi mi b fi mq mn l mo mp">df["MEDV"] = boston.target</span><span id="04fa" class="lr kh hi mi b fi mq mn l mo mp">df_x = df_x.drop("MEDV",axis='columns')          <br/>#remove target from feature (x) frame</span><span id="097f" class="lr kh hi mi b fi mq mn l mo mp">df_y = pd.DataFrame(boston.target)               <br/>#target (y) data frame</span></pre><p id="7e90" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过将波士顿住房数据集作为数据框进行加载和打印，我们发现该数据集有506行和14列。在这些列中，有13列是我们称之为数据的<strong class="iz hj">特征，或输入</strong>。第14列(MEDV，中值或价格的缩写)是<strong class="iz hj">目标变量，或输出。</strong>特性和目标的定义如下所示。</p><pre class="jv jw jx jy fd mh mi mj mk aw ml bi"><span id="20ee" class="lr kh hi mi b fi mm mn l mo mp">Features:<br/><strong class="mi hj">CRIM</strong> - per capita crime rate by town<br/><strong class="mi hj">ZN</strong> - proportion of residential land zoned for lots over 25,000 sq.ft.<br/><strong class="mi hj">INDUS</strong> - proportion of non-retail business acres per town.<br/><strong class="mi hj">CHAS</strong> - Charles River dummy variable (1 if tract bounds river; 0 otherwise)<br/><strong class="mi hj">NOX</strong> - nitric oxides concentration (parts per 10 million)<br/><strong class="mi hj">RM</strong> - average number of rooms per dwelling<br/><strong class="mi hj">AGE</strong> - proportion of owner-occupied units built prior to 1940<br/><strong class="mi hj">DIS</strong> - weighted distances to five Boston employment centres<br/><strong class="mi hj">RAD</strong> - index of accessibility to radial highways<br/><strong class="mi hj">TAX</strong> - full-value property-tax rate per $10,000<br/><strong class="mi hj">PTRATIO</strong> - pupil-teacher ratio by town<br/><strong class="mi hj">B </strong>- 1000(Bk - 0.63)² where Bk is the proportion of blacks by town<br/><strong class="mi hj">LSTAT</strong> - % lower status of the population</span><span id="69ce" class="lr kh hi mi b fi mq mn l mo mp">Target:<br/><strong class="mi hj">MEDV</strong> - Median value of owner-occupied homes in $1000's</span></pre><p id="1f07" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还可以找到一些关于每个特性的统计数据。平均值和中值(50%四分位)等中心指标允许我们假设13个特征中的任何一个与目标价格之间的关系。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es mr"><img src="../Images/32b2f5413331033fd461ff5a041c0fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BR0wzI1CWilYqc18YsxnUQ.png"/></div></div></figure><p id="b02f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，我们不会单独做出这些假设，而是在下一节中更深入一点，从统计上确定这13个特征的相关性。</p><h2 id="d2be" class="lr kh hi bd ki ls lt lu km lv lw lx kq jg ly lz ks jk ma mb ku jo mc md kw me bi translated">2.查找数据集的相关要素</h2><p id="aefc" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们有13个特征可以使用，但并不是所有的13个特征都与预测房价相关。特征选择的一种方法是过滤掉与目标价格不线性相关的特征。</p><p id="95b8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们通过找出每个特征和价格之间的皮尔逊相关系数(PCC)r来做到这一点。r是一个介于-1和+1之间的值，它告诉我们一条线对两个变量之间的关系的拟合程度。</p><p id="5b78" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是了解PCC告诉我们的两个变量</p><ul class=""><li id="148b" class="ld le hi iz b ja jb jd je jg lf jk lg jo lh js li lj lk ll bi translated">r=1(或接近1)表示强正线性相关</li><li id="3bd3" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated">r=0(或接近0)表示弱的或不存在的线性相关性</li><li id="861c" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated">r=-1(或接近-1)表示强负线性相关</li></ul><p id="b231" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于这个我们的线性回归模型，唯一相关的特征将与价格有很强的线性相关性。</p><p id="9197" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的热图显示了数据集所有14个属性之间的PCC。这有助于我们通过使更相关的特征非常暗(r=1)或非常亮(r=-1)来可视化相关特征。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es ms"><img src="../Images/d1f7706eeb65e76f4f04257a0f47247e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*y9eeq5OkOpd1U9oFHzNczQ.png"/></div></figure><p id="f4ea" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">我们将选择与价格的r绝对值大于0.5(强正或负线性相关)的特征。</strong></p><pre class="jv jw jx jy fd mh mi mj mk aw ml bi"><span id="f901" class="lr kh hi mi b fi mm mn l mo mp">#use Pearson correlation to filter out the relevant features of the data frame<br/>cor_target = abs(cor['MEDV'])<br/>relevant_features = cor_target[cor_target&gt;0.5]<br/>print(relevant_features)</span><span id="596b" class="lr kh hi mi b fi mq mn l mo mp"><strong class="mi hj">RM         0.695360<br/>PTRATIO    0.507787<br/>LSTAT      0.737663<br/>MEDV       1.000000</strong></span></pre><p id="b073" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们发现，只有3个特征(平均房间数、学校中的学生与教师的比率以及较低地位人口的百分比)与价格有很强的线性相关性。</p><p id="17c2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们通过检查相关特征彼此之间没有很强的相关性来进一步验证我们的模型。换句话说，<strong class="iz hj">投入物必须对产出价格有强烈的影响，但不能对彼此有强烈的影响</strong>；他们必须独立。</p><p id="22cf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这一次，我们将检查3个相关特性<em class="jt">相对于彼此</em>的PCCs的绝对值是否小于0.5。</p><pre class="jv jw jx jy fd mh mi mj mk aw ml bi"><span id="48ce" class="lr kh hi mi b fi mm mn l mo mp">#check that relevant features do not correlate with each other<br/>print(x[["LSTAT","PTRATIO"]].corr())<br/>print(x[["RM","LSTAT"]].corr())</span><span id="a423" class="lr kh hi mi b fi mq mn l mo mp"><strong class="mi hj">          LSTAT   PTRATIO<br/>LSTAT    1.000000  0.374044<br/>PTRATIO  0.374044  1.000000<br/>             RM     LSTAT<br/>RM     1.000000 -0.613808<br/>LSTAT -0.613808  1.000000</strong></span></pre><p id="024d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">RM和LSTAT强负相关(r=-0.61)，所以其中1个不能用于我们的模型。因为LSTAT的MEDV具有更高的PCC(r = 0.73)，所以我们决定在创建模型之前从数据帧中删除RM。</p><p id="8477" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用统计数据，我们从13个特征中只选择了2个来预测房价:</p><ul class=""><li id="1210" class="ld le hi iz b ja jb jd je jg lf jk lg jo lh js li lj lk ll bi translated">学校学生与学生的比率</li><li id="4244" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated">LSTAT，被认为地位较低的人口百分比</li></ul><h2 id="c1b4" class="lr kh hi bd ki ls lt lu km lv lw lx kq jg ly lz ks jk ma mb ku jo mc md kw me bi translated">3.使用相关特征训练线性回归模型</h2><p id="517b" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在从数据框中移除11个不相关的特征/列之后，我们现在可以实现我们的ML模型。第一步是将数据随机分为训练数据和测试数据。我随意地选择了2:1的训练测试比来分割数据，但是这个数字可以调整。</p><p id="db31" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们将训练数据拟合到线性回归模型。</p><pre class="jv jw jx jy fd mh mi mj mk aw ml bi"><span id="f95a" class="lr kh hi mi b fi mm mn l mo mp"># split data into train and test data<br/>x_train, x_test, y_train, y_test = train_test_split(df_x, df_y, test_size=0.33, random_state = 5)</span><span id="45ed" class="lr kh hi mi b fi mq mn l mo mp"># initialize linear regression model<br/>reg = linear_model.LinearRegression()</span><span id="2fb3" class="lr kh hi mi b fi mq mn l mo mp"># train the model with training data<br/>reg.fit(x_train, y_train)</span></pre><p id="cefe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在模型已经训练好了，我们可以回到我们心爱的方程y=mx+b，在机器学习中，斜率<em class="jt"> m </em>俗称权重，用w来代替。y轴截距<em class="jt"> b </em>通常被称为偏差，我们实际上不需要为其更改变量名。</p><p id="fed8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，由于我们的模型本质上具有2个x值(2个相关特征)，我们可以将y=mx+b重写为y=w1x1 + w2x2 +b，其中x1和x2是特征PTRATIO，LSTAT和w1以及w2是它们各自的权重。</p><p id="9a38" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以用下面的代码找到所有这些值:</p><pre class="jv jw jx jy fd mh mi mj mk aw ml bi"><span id="07db" class="lr kh hi mi b fi mm mn l mo mp">#get weights and intercept<br/>weights = reg.coef_<br/>intercept = reg.intercept_<br/>print(weights)<br/>print(intercept)</span><span id="34c9" class="lr kh hi mi b fi mq mn l mo mp"><strong class="mi hj">[[-1.27674121 -0.79380569]]<br/>[56.04146127]</strong></span></pre><p id="f98d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">瞧，我们现在有了线性回归方程！</p><blockquote class="mt"><p id="c8cf" class="mu mv hi bd mw mx my mz na nb nc js dx translated">y = -1.28x1 -0.79x2 + 56.04</p></blockquote><h2 id="55cb" class="lr kh hi bd ki ls nd lu km lv ne lx kq jg nf lz ks jk ng mb ku jo nh md kw me bi translated">4.测试和评估模型</h2><p id="df7a" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">该项目的最后一部分是测试和评估模型。</p><p id="d7e5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，我们使用新发现的线性模型来预测所有测试输入的输出。然后，我们将预测的输出与测试数据的实际输出进行比较，看我们有多接近。从我们的实际值中减去我们的预测值，除了我们的预测值过高或过低之外，并不能告诉我们太多，但幸运的是，还有其他方法可以找到我们模型中的误差。</p><p id="f487" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用了更多的统计工具:</p><ul class=""><li id="a544" class="ld le hi iz b ja jb jd je jg lf jk lg jo lh js li lj lk ll bi translated"><strong class="iz hj">均方误差(MSE)— </strong>因为这是平方误差，所以可以将其视为实际值(数据点)和预测值(最佳拟合线)之间的平均面积</li><li id="8357" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated"><strong class="iz hj">均方根误差(RMSE)— </strong>直观显示为实际值和预测值之间的平均距离</li><li id="b5ff" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated"><strong class="iz hj"> r平方</strong> <strong class="iz hj"> (r )— </strong>线性模型与数据拟合程度的度量</li></ul><pre class="jv jw jx jy fd mh mi mj mk aw ml bi"><span id="a29d" class="lr kh hi mi b fi mm mn l mo mp">#make predictions with regression model on testing data<br/>y_pred = reg.predict(x_test)</span><span id="817f" class="lr kh hi mi b fi mq mn l mo mp">#compare predicted to actual prices<br/>mse = mean_squared_error(y_test, y_pred)<br/>rmse = mean_squared_error(y_test, y_pred, squared=False)<br/>r2 = r2_score(y_test, y_pred)<br/>print("The model performance for training set")<br/>print('MSE is {}'.format(mse))<br/>print('RMSE is {}'.format(rmse))<br/>print('R2 score is {}'.format(r2))<br/>print("\n")</span><span id="518d" class="lr kh hi mi b fi mq mn l mo mp"><strong class="mi hj">The model performance for training set<br/>MSE is 40.976684403304056<br/>RMSE is 6.401303336298324<br/>R2 score is 0.562886726399217</strong></span></pre><p id="c2b6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">MSE、RMSE和r都是检验我们模型性能的有用工具。它们实际上都是损失函数的形式，ML模型可以使用它们通过最小化它们来自我校正它们的错误。如果我们再次迭代回归，这次使用不同的随机状态和训练测试分割，我们可以比较这些度量来确定模型的哪个实例更好。</p><p id="342d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">考虑到波士顿住房数据集的价格范围(20世纪70年代为5000美元到50000美元),这个特定的线性回归模型是一个相对较好的拟合模型——但它还可以更好。机器学习的美妙之处在于，改进是这类模型的目标。现在，首先了解我们如何将数学课中臭名昭著的直线方程与日益实用的人工智能领域联系起来是有帮助的。</p></div><div class="ab cl ni nj gp nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="hb hc hd he hf"><h1 id="4c6a" class="kg kh hi bd ki kj np kl km kn nq kp kq io nr ip ks ir ns is ku iu nt iv kw kx bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="2363" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在这篇文章中，我:</p><ul class=""><li id="ba85" class="ld le hi iz b ja jb jd je jg lf jk lg jo lh js li lj lk ll bi translated">引入了<strong class="iz hj">两种监督学习，</strong>分类(用于离散分类输出)和回归(用于连续输出)，这两种学习都可以用作预测工具</li><li id="c30b" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated">探索波士顿房屋数据集与<strong class="iz hj">线性回归模型</strong>的拟合特征，以预测房屋的中值(价格)</li><li id="4298" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated">使用皮尔逊相关系数(PCCs)来<strong class="iz hj">选择数据集的相关特征</strong></li><li id="fd92" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated">根据模型的<strong class="iz hj">权重和偏差</strong>找到y=mx+b的最佳拟合线(线性回归线)</li><li id="23ac" class="ld le hi iz b ja lm jd ln jg lo jk lp jo lq js li lj lk ll bi translated">使用三种误差测量方法评估模型— <strong class="iz hj"> MSE </strong>:面积误差；<strong class="iz hj"> RMSE </strong>:距离误差；<strong class="iz hj">r</strong>:PCC错误</li></ul><p id="508c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我用Python编写的第一个大型ML项目，我学到了很多关于这种语言以及如何使用统计数据来驱动我的程序和模型。迫不及待地想了解更多更复杂的项目！</p><p id="79e5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读:)在Medium上给我留下一些掌声、反馈和关注，以获得更多关于人工智能和人工智能的文章，以及商业和科学交汇处的其他创新领域。</p><p id="e14d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你有兴趣陪我一起踏上新兴科技之旅，请通过<a class="ae mf" href="https://www.linkedin.com/in/caitlyncoloma/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae mf" href="http://caitayc@gmail.com" rel="noopener ugc nofollow" target="_blank">电子邮件</a>与我联系，并订阅我的<a class="ae mf" href="https://mailchi.us20.list-manage.com/subscribe?u=3cda5e04da2f88cf231e781d6&amp;id=2ad07268cd" rel="noopener ugc nofollow" target="_blank">每月简讯</a>！</p></div></div>    
</body>
</html>