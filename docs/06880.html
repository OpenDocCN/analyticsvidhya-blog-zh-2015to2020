<html>
<head>
<title>Handwritten Digit Recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">手写数字识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/handwritten-digit-recognition-974dff4991f9?source=collection_archive---------22-----------------------#2020-06-05">https://medium.com/analytics-vidhya/handwritten-digit-recognition-974dff4991f9?source=collection_archive---------22-----------------------#2020-06-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dca8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经网络模仿我们大脑的工作方式，是不是很有趣？</p><p id="79c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">神经网络试图处理神经元，并建立这些可以训练的复杂大脑网络。机器学习的专门子集，使用分层神经网络来模拟人类决策，称为深度学习。</p><p id="ccd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数字识别系统识别来自不同来源数字，如邮件、银行支票、文件以及车辆牌照。本文使用卷积神经网络对MNIST数据集中的手写数字进行分类。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/f1cf60068461917d4d2f5d575fb2e0f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AEMLvmG7enqxiEYH_v9JQA.jpeg"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">MNIST数据库</figcaption></figure><h1 id="53d7" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">卷积神经网络</h1><p id="fbf3" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">卷积神经网络是深度神经网络的一部分，广泛用于分析图像，但它们也可用于其他应用，如视频识别、推荐系统和自然语言处理等。</p><p id="bd56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与其他图像分类算法相比，卷积神经网络使用相对较少预处理。CNN能够检测图像的模式。</p><p id="d9b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络由输入层、输出层和多个隐含层组成。CNN的这些隐藏层被称为卷积层。形成多个隐含层的深度神经网络称为深度神经网络。</p><p id="cf42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络是具有一定复杂度的深度神经网络。在神经网络中，随着我们在层中越来越深，复杂性和准确性继续增加，但不幸的是，时间消耗也增加了。</p><blockquote class="lf lg lh"><p id="12de" class="if ig li ih b ii ij ik il im in io ip lj ir is it lk iv iw ix ll iz ja jb jc hb bi translated">CNN能以更好的结果完成更好的任务。</p></blockquote><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es lm"><img src="../Images/4bb106fce1691b7fe99cdabe1d4001dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VDcgk6MzLZ8WrrOald0-Wg.jpeg"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">深度神经网络</figcaption></figure><h1 id="012f" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">MNIST数据库</h1><p id="cd9e" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">MNIST数据库是可从NIST获得的较大集合的子集。</p><p id="1b28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是由高中生和美国人口普查局员工手写的70，000幅数字小图像组成的集合。SD-3在员工中收集，而SD-1在高中生中收集。</p><p id="568f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有70，000个图像，其中60，000个在训练集中，10，000个在测试集中，并且每个图像具有784个特征。图像以28×28像素为中心，每个特征简单地表示像素强度，从0(白色)到255(黑色)。</p><p id="22f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据像C数组一样存储，即最后一个维度中的索引变化最快。</p><p id="393f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数学中，张量是一个代数对象，它描述了与向量空间相关的代数对象集之间的关系。张量被用作张量流中的基本结构。Tensorflow是google的开源机器学习框架，用于编程arcoss的一系列任务。</p><figure class="jn jo jp jq fd jr"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="3479" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从导入tensorflow和numpy开始编码。将MNIST数据集存储在mnist变量中。</p><pre class="jn jo jp jq fd lp lq lr ls aw lt bi"><span id="30cf" class="lu kd hi lq b fi lv lw l lx ly">import tensorflow as tf<br/>import numpy as np</span><span id="ed45" class="lu kd hi lq b fi lz lw l lx ly">mnist = tf.keras.datasets.mnist</span></pre><p id="e36c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过使用load_data()将数据集分成训练集和测试集。</p><pre class="jn jo jp jq fd lp lq lr ls aw lt bi"><span id="6849" class="lu kd hi lq b fi lv lw l lx ly">(training_images, training_labels), (test_images, test_labels) = mnist.load_data()</span></pre><p id="e35d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">规范化是消除冗余数据并确保数据相关性的过程。将0到1之间的所有值除以最大值255。因此，我们归一化数据集。</p><pre class="jn jo jp jq fd lp lq lr ls aw lt bi"><span id="9e38" class="lu kd hi lq b fi lv lw l lx ly">training_images = training_images.reshape(60000, 28, 28, 1) / 255.0</span><span id="e6b6" class="lu kd hi lq b fi lz lw l lx ly">test_images = test_images.reshape(10000, 28, 28, 1) / 255.0</span></pre><p id="f82e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过在CNN上添加卷积层来创建神经网络模型。</p><h2 id="6397" class="lu kd hi bd ke ma mb mc ki md me mf km iq mg mh kq iu mi mj ku iy mk ml ky mm bi translated">模型设计的概念:</h2><p id="4570" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated"><strong class="ih hj"> <em class="li">顺序</em> </strong>:定义神经网络中的一个层序列。</p><p id="3c43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="li">【Conv2D】</em></strong>:该层改变图像，使图像中的某些特征得到强调。</p><p id="2f8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="li"> Maxpooling2D </em> </strong>:池化是通过取窗口上的最大值来压缩图像的一种方式。</p><p id="8104" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="li">展平</em> </strong>:展平将2D矩阵数据转换为一维向量。</p><p id="02e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="li"/></strong>:这是一层神经元，每层神经元都有激活功能。如果你没有指定任何东西，就不会激活。</p><p id="bd92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="li"> relu </em> </strong>(校正线性单位):该功能防止像素值改变。</p><p id="1465" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="li">soft max</em></strong>:soft max功能将输出转化为概率，并从十类中选择一类。</p><pre class="jn jo jp jq fd lp lq lr ls aw lt bi"><span id="bf07" class="lu kd hi lq b fi lv lw l lx ly">model = tf.keras.models.Sequential()</span><span id="3a6e" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.Conv2D(16, (3,3), activation='relu', padding='same', input_shape = (28 ,28,1)))</span><span id="1ef4" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.MaxPool2D(padding='same'))</span><span id="89f7" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.Conv2D(16, (3,3), activation='relu',     padding='same'))</span><span id="612b" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.MaxPool2D(padding='same'))</span><span id="5e20" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.Flatten())</span><span id="12b8" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.Dense(128, activation=tf.nn.relu))</span><span id="c728" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.Dense(128, activation=tf.nn.relu))</span><span id="f4c1" class="lu kd hi lq b fi lz lw l lx ly">model.add(tf.keras.layers.Dense(10, activation=tf.nn.softmax))</span></pre><p id="c032" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，用优化器和损失函数编译模型。通过调用model.fit()用training_images及其标签对其进行训练。最后，我们得到我们的精度值。</p><pre class="jn jo jp jq fd lp lq lr ls aw lt bi"><span id="b2ed" class="lu kd hi lq b fi lv lw l lx ly">model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])</span><span id="db08" class="lu kd hi lq b fi lz lw l lx ly">history = model.fit(training_images , training_labels , epochs = 20 )<br/>print(history.epoch, history.history['accuracy'][-1])</span></pre><p id="7f38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用模型从未见过的测试数据评估分类器的准确性。利用预测方法得到训练模型的预测值。</p><pre class="jn jo jp jq fd lp lq lr ls aw lt bi"><span id="cca6" class="lu kd hi lq b fi lv lw l lx ly">val_loss, val_acc = model.evaluate(test_images, test_labels)</span><span id="9d44" class="lu kd hi lq b fi lz lw l lx ly">prediction = model.predict(test_images)</span></pre><p id="3625" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，打印预测值。</p><pre class="jn jo jp jq fd lp lq lr ls aw lt bi"><span id="e00a" class="lu kd hi lq b fi lv lw l lx ly">print("The number on the picture is {}   ".format(np.argmax(prediction[666])))</span></pre><h1 id="65a3" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">结论:</h1><p id="5eda" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">我们成功地用卷积神经网络对MNIST数据库中的手写数字进行了分类，准确率达到99.8%。您可以使用gui界面在画布上绘制数字。</p><p id="99b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">github链接:<a class="ae mn" href="https://github.com/suyash-jamdade/Handwritten-Digit-Recognition" rel="noopener ugc nofollow" target="_blank">https://github . com/suya sh-jam Dade/手写数字识别</a></p></div></div>    
</body>
</html>