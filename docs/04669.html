<html>
<head>
<title>Mercari Price Suggestion Challenge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Mercari价格建议挑战</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mercari-price-suggestion-challenge-66500ac1f88a?source=collection_archive---------6-----------------------#2020-03-28">https://medium.com/analytics-vidhya/mercari-price-suggestion-challenge-66500ac1f88a?source=collection_archive---------6-----------------------#2020-03-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="96d1" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这是我在kaggle环境中的第一次数据科学体验。虽然挑战本身很有趣，体验也很神奇，很直观。我希望你在博客的最后意识到你学到了一些东西。</p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/4d3db0c18e0526f31cc023ff44a7bee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiWBNf6c8fJT-bzMk1gh2g.jpeg"/></div></div></figure><p id="b2cb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi jw translated">在<strong class="il hj">机器学习</strong>和<strong class="il hj">深度学习</strong>出现的今天，电子商务网站上重新调整产品的建议和推荐相当普遍。<a class="ae kf" href="https://www.mercari.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj">麦卡利</strong> </a>就是这样一个例子。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es kg"><img src="../Images/bcfe7285d53ebc882a9266c6b6fb99c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iS8Ta0egGT5NYPVl6hzMoQ.jpeg"/></div></div></figure><p id="bfa3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">Mercari是一个在线购物市场，由日本最大的社区之一提供支持，用户可以在这里出售几乎任何东西。</p><p id="2e17" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">社区希望向卖家提供价格建议，但这是一项艰巨的任务，因为卖家可以在mercari marketplace上放置任何东西或任何一捆东西。因为产品的价格取决于它的品牌和产品的用途。不同品牌的相同产品价格不同是很常见的。</p><p id="1b6a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">例如，其中一件毛衣售价335美元，另一件售价9.99美元。你能猜出哪个是哪个吗？大概不会！！</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es kh"><img src="../Images/4ff632d5bb91dd66c3b247a8806cd500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9ZxNpBA177IdysmtYudfA.jpeg"/></div></div></figure><p id="578d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">但是，如果我建立一个系统，使一切自动化，这样它就消除了建议和增加市场中的买家的人工努力。这就是机器学习和深度学习派上用场的地方。</p><h2 id="10ab" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">业务问题:</h2><p id="4cb6" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">理解给定的问题陈述是数据科学之旅中最重要和最具挑战性的部分。因此，不要浪费时间，让我们探讨一下Mercari的业务问题。</p><p id="bf57" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">Mercari社区希望我们建立一个算法，根据产品名称、用户输入的产品文本描述、类别名称、品牌名称、商品状况和运输信息，为购物应用程序建议正确的产品价格。在这里，定价是关于在供给和需求之间找到一个中间点。是不是很好玩？</p><p id="d2a7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在，我将带您了解挑战背后的乐趣，以及我处理这个问题的可能解决方案。</p><h2 id="1184" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">数据来源:</h2><p id="b4b9" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">虽然这是一个kaggle问题，但是可以从kaggle本身提取数据。下面会提到Kaggle链接。这里有五个文件，其中train.tsv是训练数据，test_stg2.tsv是最终提交的测试数据，sample_submission_stg2.csv是样本提交文件。</p><p id="e04e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">https://www . ka ggle . com/c/mercari-price-suggestion-challenge/data</p><h2 id="338b" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated"><strong class="ak">现有方法:</strong></h2><p id="e2ba" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">我将提供一个视频链接，讲述本次比赛的一等奖得主<strong class="il hj">pawei和</strong>Konstantin采用的方法。</p><p id="7265" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><a class="ae kf" href="https://www.youtube.com/watch?v=QFR0IHbzA30&amp;t=2998s" rel="noopener ugc nofollow" target="_blank"><em class="ik">https://www.youtube.com/watch?v=QFR0IHbzA30&amp;t = 2998s</em>T3】</a></p><p id="a8d3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">I)他们很好地解释了优化的东西，比如使用声明性的而不是命令性的语句。</p><p id="77ac" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">II)对于文本预处理，他们使用词干，BOW，一种用于分类特征的热编码。</p><p id="d6bc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">III)他们使用LSTM、CNN和relu作为激活单元，adam作为优化器，并包含文本数据的单词嵌入，作为应对这一挑战的解决方案。</p><p id="a0c0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">你也可以查看下面的链接，找到一些类似的思俊和的解决方案。</p><p id="2467" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><a class="ae kf" href="https://sijunhe.github.io/blog/2018/03/02/kaggle-mercari-price-suggestion-challenge/" rel="noopener ugc nofollow" target="_blank">https://sijunhe . github . io/blog/2018/03/02/ka ggle-mercari-price-suggest-challenge/</a></p><h2 id="c44c" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">首次切割方法:</h2><p id="5c16" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">拥有领域知识和理解数据模式确实有助于解决ML问题。因此，作为第一步，我想通过探索性数据分析(<strong class="il hj"> EDA </strong>)中的各种绘图技术来探索更多关于数据的信息，以便更好地理解数据。我还想知道目标变量的分布。</p><p id="8767" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">对于特征提取，我想使用术语频率逆文档频率(<strong class="il hj"> Tfidf </strong>)和单词包(<strong class="il hj"> BOW </strong>)。我还想引入新的数据功能，如情感分析，停用词计数等..,</p><p id="8d70" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我想尝试线性，套索，山脊，LBMs和简单的MLPs作为我的基础模型。抛一抛，我想尝试我的模型组合。</p><h2 id="db4b" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">目录:</h2><p id="62fe" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated"><strong class="il hj">第一章:数据报废/数据提取/数据导入</strong></p><p id="39c2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">第二章:探索性数据分析</strong></p><p id="3264" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">第三章</strong> : <strong class="il hj">通过ML回归模型求解</strong></p><ul class=""><li id="fbef" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">步骤3-1:特征工程。</li><li id="df29" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">步骤3–2:拆分数据。</li><li id="b74f" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">步骤3–3:特征提取。</li><li id="e0ee" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">步骤3–4:处理数字特征。</li><li id="74c2" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">步骤3–5:回归模型。</li></ul><p id="4819" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">第四章:通过深度学习的解决方案——多层感知器(神经网络)的概念</strong></p><ul class=""><li id="59ae" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">step _ 4–1:处理缺失值</li><li id="9f02" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">步骤4–2:特征提取</li><li id="ea8f" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">步骤4–3:构建模型架构</li></ul><p id="531a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">第五章:结论。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><blockquote class="if ig ih"><p id="8d98" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">第一章:数据提取:</strong></p></blockquote><p id="7887" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">对于这个案例研究，我使用google colaboratory来访问<strong class="il hj"> GPU和高RAM。</strong></p><p id="b979" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我用Curlwget来更快地下载数据。要了解更多这方面的信息，请点击以下链接:<a class="ae kf" href="https://www.thegeekstuff.com/2012/07/wget-curl/" rel="noopener ugc nofollow" target="_blank">https://www.thegeekstuff.com/2012/07/wget-curl/</a></p><p id="1268" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">因为给定数据采用制表符分隔值格式(<strong class="il hj">)。tsv </strong>我们可以把它转换成逗号分隔的值(<strong class="il hj">)。csv) </strong>文件。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es md"><img src="../Images/dc10d9c9957f5e87281ba8a9999c377b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-058la33WX18bTMq1NPAWw.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">转换中。tsv文件到。csv文件格式</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/c76f0f1e25dd9e5d4bb3b8f1735bab46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xU9H24orvhOrTRG-und3g.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mi"><img src="../Images/d77e101c63376bac966cdd2ce805a5db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m9FvpK0g5gSSjo8K17iHyQ.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mj"><img src="../Images/77e877f07061930ba62a9931e96aed0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nDO-dDuzG7jw_YIrfoQzfg.png"/></div></div></figure><p id="66ac" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们可以看到，我们的训练数据由14万多个数据点组成。虽然这是我们可以看到一些值丢失的前5个数据点(<strong class="il hj">南</strong>)。</p><p id="9cc8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">检查数据中的缺失值:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mk"><img src="../Images/75853026ade0ae4d8dbd48cb48a24ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_zPQCwcQlFK1ZVx2TigKBg.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ml"><img src="../Images/bf8d9e7af9ee9e4bb07eae93a2396385.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*iraezNfQkkpo0R1KdAaPPg.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">每个特征中NaN值的数量。</figcaption></figure><p id="8e3a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">正如我所料，该数据集包含缺失值，通常称为NaN值，因此，在对这种类型的数据应用任何模型之前，我们需要填充该数据或简单地将其作为空字符串</p><p id="4839" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">处理数据中的缺失值:</strong></p><p id="e226" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在category_name特征的每个数据点中，我们可以看到三个不同的类别。因此，这里我们将这三个类别分为三个特征，同时我们将在其中填充NaN值。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mm"><img src="../Images/7e80e4d932da41a3e8f490e00717948a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZLy-H46-eh8zmsyUUSNAA.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">将类别功能拆分为三个新功能</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mn"><img src="../Images/2360987821cdaa2bc3373ad4aed54db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Un9_ztyIaTwHKkwoEK2hfA.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">在商品描述和品牌特征中填入NaN值</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mo"><img src="../Images/2b3912bc031c7869e349039f9ab1491c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*GQkxmil8yONXoeR881EdAw.png"/></div></div></figure></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><blockquote class="if ig ih"><p id="9216" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">第二章:探索性数据分析:</strong></p></blockquote><p id="5a46" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在统计学中，EDA是一种分析数据集的方法，通常总结主要特征，并经常用于发现模式以发现异常，测试假设并检查我们对数据做出的主要假设。</p><h2 id="e6ea" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated"><strong class="ak">单变量分析:</strong></h2><p id="5286" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated"><strong class="il hj">子类别1: </strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mp"><img src="../Images/d3e0809901486864602be23a1afab24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zlho2of7iQLHZJhfWhfjpg.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mq"><img src="../Images/9374fd4d4efa2bc888d3d126e6677b6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g1ovK6Qdhbd_mAYd6t0H3A.png"/></div></div></figure><p id="b882" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们可以看到，产品的前三个主要类别是女性、美容和儿童。近60万的产品以女性为主要类别。</p><p id="1f92" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">类似地，对sub_category2，sub_category3做同样的操作，我们得到了下面的结果。</p><p id="73f7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">子类别2: </strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mr"><img src="../Images/e75000ad02a792504fe76202e8847727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5Zd3cnvkVzma6d_w-SaDw.png"/></div></div></figure><p id="1630" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">以前10个子类别2为例，我们有以下分析:</p><p id="d5c6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">从上面的柱状图我们可以看到，近120万卢比的产品是运动服装。化妆品和上衣&amp;衬衫是下两个重复出现的子类别。</p><p id="a732" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">子类别3: </strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ms"><img src="../Images/55dfc2750b932f87d4a8ec9c5ce076f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WPgUJXEGmiaBWlHTwOVrQ.png"/></div></div></figure><p id="02f2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">以sub_category3中的前10个子类别为例，我们进行了以下分析:</p><p id="1dfc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">裤子、紧身衣、打底裤、脸等类别是子类别三级中重复次数前三的东西。</p><p id="e682" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">从上面的分析可以清楚地看出，数据集包含了与女性最相关的大多数产品，如化妆品、连衣裙和一些女性的相关配饰。现在让我们探索数据中的其他特征。</p><p id="7a68" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">品牌名称:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mt"><img src="../Images/6bfd5cd435b9cf5edce8a8ae8323f586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_z0ix7tQ3DYyzW4tl3Gwug.png"/></div></div></figure><p id="9743" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">Nike和PINK是最常见的两个品牌，这两个品牌的产品比例几乎相等。维多利亚的秘密是比赛中的下一个。正如我们已经知道的，大多数产品在数据中没有品牌，那么显然未知品牌将在所有这些品牌中名列前茅。但作为可视化的一部分，我跳过了这一步。</p><p id="c83b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">名称:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mu"><img src="../Images/009689042108b8488b4fd18aed23efa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8R_Ylmhs2RfwmxUTcrWmUg.png"/></div></div></figure><p id="daf8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">取数据中重复次数最多的前10个产品名称。</p><p id="1e2a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">捆绑、保留和匡威是重复次数最多的产品名称的前三名。数据中有近2000个捆绑产品。</p><h2 id="0058" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">项目条件标识:</h2><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mv"><img src="../Images/24e254031f7281ef6823790bf49c85b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_-IIOkZq5lGE4OvisHIoTA.png"/></div></div></figure><p id="2ad8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">值为1的Item_condition_id是数据中重复次数最多的id。近600万卢比的数据包含以1作为条件id的产品。而item_condition_id为5是训练数据中所有产品中重复次数最少的id。</p><h2 id="96a7" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">运输:</h2><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mw"><img src="../Images/5d45312dff5aae3d3bed829bd945477c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amVFboydRB-lR_g2CvA9wQ.png"/></div></div></figure><ul class=""><li id="77f8" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">我们可以看到，大部分运费只由买家支付。(55.3%)</li><li id="17c2" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">44.7%的产品的运费由卖家支付。</li></ul><p id="d2b3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">价格(目标值):</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mx"><img src="../Images/c8cc1ed6fb900aa28102cc0c06d1c302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*0H2iBQb0D3Slf-U_o-bF-w.png"/></div><figcaption class="me mf et er es mg mh bd b be z dx translated">对价格的完整描述，这是我们的目标价值</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es my"><img src="../Images/91f7fa43c56ca1b787c0b7e34b4385be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIDaGBQkO0XcnTP_0pp2Lg.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">价格对日志(价格+1)</figcaption></figure><p id="ae95" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在左图中，我们可以看到价格特征严重右偏，更像是遵循右偏分布，以便使低价的误差比高价的误差更相关，竞争已经采取了均方根对数误差(<strong class="il hj"> RMSLE </strong>)。因此，我们在这个数据集中取了目标变量(价格)的log(价格+1)。</p><h2 id="7c22" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">双变量分析:</h2><p id="059d" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated"><strong class="il hj">运费vs价格:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mz"><img src="../Images/6aa6d4ea785ace7d4382518d99a169f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BcWx_Jqfs94Ei95uRC-j7Q.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es na"><img src="../Images/aa78bfa147cbe45484f1b43cb7076e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*JiQb07Q6NGKUk-ny9ri3IA.png"/></div></figure><p id="de00" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在上面的pdf图中，装运0比装运1具有更高的峰值，并且两个pdf图几乎彼此合并。</p><p id="98eb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">品牌和非品牌产品与价格:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nb"><img src="../Images/8c3711d9bd0142b28a944909d52461a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z2rRZoLh_LsBOaY4WAAIWw.png"/></div></div></figure><p id="624d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">正如我已经预料到的，品牌产品比低峰值的产品具有更高的峰值，这意味着品牌产品会比没有品牌的产品相对具有更高的价格。</p><p id="b0d3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">项目条件标识与价格:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nc"><img src="../Images/cbd4580779eb3b2673aaf414c218ccc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c41H66M4YWDLBAiRBPvgEA.png"/></div></div></figure><p id="6e0c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">item_condition_id为5的产品的第50个百分位数高于具有其它条件id的产品。除了item_condition_id的值为5的产品之外，几乎所有的图都具有相同的范围。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><blockquote class="if ig ih"><p id="ef9b" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">第三章:通过机器学习回归模型的解决方案:</strong></p></blockquote><p id="deb4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在博客的开始，我已经说过我们将使用ML和DL模型来解决这个问题。让我们在这些数据上尝试不同的机器学习模型。</p><h2 id="4626" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">步骤3–1:文本数据的特征工程:</h2><p id="604a" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">到目前为止，我们已经完成了数据分析。现在有趣的部分出现了，那就是特征工程。</p><p id="c914" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们已经看到了文本数据，即item_description，我已经尝试使用各种功能工程技巧，但我发现了四种方法来在我的数据中获得有趣的模式。所以我在我的数据中添加了这些特征，这将在下面清楚地讨论。</p><ul class=""><li id="9578" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">item_description中的停用词数量</li><li id="757a" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">项目_描述长度</li><li id="dcbf" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">是品牌化的</li><li id="be76" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">通过vader词典进行情感评分分析</li></ul><p id="e94c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> I)停用词的数量:</strong></p><p id="7400" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们来统计一下物品描述中的停用词数量。这将是我们的新功能。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nd"><img src="../Images/be9f0cea239024fdb687fdf8df9bf6aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBQJyXym37yGbKD44LKk9w.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">计算item_description中停用字词的数量</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es et"><img src="../Images/3ad8445751504f835d87c85fb2aaf2f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NI6DnjGZzMsX3xOt_HHo0w.png"/></div></div></figure><p id="3edf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在，在进入下一个特征工程之前，我们需要对数据进行预处理。请注意，我没有在上面的函数中使用预处理文本，因为在预处理步骤中，它将删除所有的停用词，因此我们在预处理数据之前对停用词进行了计数。</p><p id="358a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">文本预处理:</strong></p><p id="bc3b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在应用特征工程之前，文本数据的预处理是我们需要做的最重要的步骤。</p><p id="bbca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">基本的文本预处理包括以下步骤:</p><p id="587f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">I)用完整表格代替速记。在这里，像“不会”这样的词将被替换为“不会”等..,</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ne"><img src="../Images/e0e5a8d0f56b7343c38e71d9e571f76f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sa02HQBj2I1UTWoyInMKog.png"/></div></div></figure><p id="afdb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">ii)我们将用空字符串替换\r、\、\n这样的字符串文字</p><p id="4da1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">iii)去除字母数字字符以外的字符。</p><p id="cbad" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">文本是标点符号、特殊字符、空格等的组合..，这些在模型训练中不再有用。因此，我们将删除所有这些字符。</p><p id="df83" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">iv)停用词的删除:</p><ol class=""><li id="a780" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg nf lo lp lq bi translated">通常，文本数据包含<strong class="il hj">停用词</strong>，这些停用词作为特征不再有用，因为它们只是为了在英语中表达完整的意思</li><li id="f6be" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg nf lo lp lq bi translated">因此，有必要删除对回归模型无用的停用词。</li><li id="a52e" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg nf lo lp lq bi translated">一种方法是使用<strong class="il hj"> nltk </strong>(自然语言工具包)</li></ol><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ng"><img src="../Images/e76fd9429f07ac5a4fbc86e53869b494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w35KFtzsQXF8Hdsx57UBDg.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">基本文本预处理</figcaption></figure><p id="5164" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在我们完成了文本预处理，为了可视化预处理后的文本，我们将在这里使用<strong class="il hj"> Wordcloud </strong>来查看在item_description中出现频率最高的单词。重复次数最多的单词比其他任何单词都要大。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mw"><img src="../Images/eaccb2050d84dc7da5ce7541719d56b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dE4K37m4XGfjDG7DNRyksQ.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">使用wordcloud可视化预处理文本</figcaption></figure><ul class=""><li id="6e5b" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">从上面的wordcloud(品牌、新、免费、发货、描述、还)是物品描述中最常见的词。</li><li id="f182" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">卖家使用新的、免费的、送货的、描述性的词语向买家宣传他们的产品。</li><li id="2776" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">现在让我们看看预处理文本中重复次数最多的前25个单词。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mi"><img src="../Images/49d425469814fc7d513421304765e3ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7pGA46mHGODBaOg4EdU_RA.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nh"><img src="../Images/b8c45b89ca9c11b7656872bb56dd851f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8IXmNWEiIrpYnxrtKjWDw.png"/></div></div></figure><ul class=""><li id="bab0" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated"><strong class="il hj">新</strong>和<strong class="il hj">尺寸</strong>是物品描述中重复次数最多的两个顶级词汇。</li><li id="e535" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">近450万卢比的产品在商品描述中使用了new。</li></ul><p id="1204" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">作为下一个功能工程任务，让我们使用item_description、is_branded和情感分析作为我们的新功能，</p><p id="c97c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> II)项目_描述长度:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ni"><img src="../Images/55e57239edb659afc2db240900e851c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OXMtdU9lMp0mkaPerT7hog.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nj"><img src="../Images/be7bf4704c606206cf9d380ebc817a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*rNKZv1GgtMKG5vHUG5HHaA.png"/></div><figcaption class="me mf et er es mg mh bd b be z dx translated">描述长度特征的完整描述。</figcaption></figure><p id="1a1e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> III)是_branded: </strong></p><ul class=""><li id="a026" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">我们可以看到，大多数产品没有品牌。这可以作为我们数据的一个特征。</li><li id="6dea" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">我们知道不同品牌的产品价格不同。这是基于它正在生产的公司。但是一个好的品牌会比不同品牌的相同产品有一个好的价格。</li><li id="d606" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">因此，两个不同品牌(已知品牌，未知品牌)的类似产品可以帮助我们了解产品的价格。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nk"><img src="../Images/5bc85d265b19426647de79715c194f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u2_uONYyZdtAq1zcCLtO4w.png"/></div></div></figure><p id="7b98" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">四)情感得分分析:</strong></p><ul class=""><li id="f181" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">情感得分分析经常被用作处理文本数据的特征工程黑客。</li><li id="0cc0" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">它试图在给定的文本中识别和提取观点。</li><li id="a383" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">情感分析是一个棘手的部分，但是通过在python中使用nltk，它变得很方便。</li><li id="7ac2" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">它将返回四个值:正的、负的、中性的和复合的。</li></ul><p id="f9e4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">要了解更多信息，请点击以下链接:</p><p id="1ba6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><a class="ae kf" href="https://www.geeksforgeeks.org/facebook-sentiment-analysis-using-python/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/Facebook-情操-分析-使用-python/ </a></p><p id="a42c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">情感评分分析如何帮助我们完成任务？？</strong></p><ul class=""><li id="a2ef" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">更常见的是，正面描述的产品可能收费较高。类似地，负面描述产品可能收费较低。</li><li id="9603" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">这意味着它们与我们的数据中的描述和价格(目标值)有一些关联，这标志着我们的任务有了良好的氛围。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nl"><img src="../Images/19a9fd4bf39974ac26d2fbf3b2034088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qkGsXRG6zmtuqYXI-anlsw.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nm"><img src="../Images/3ceff0c064374039df63e9c3afe676d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqIrI0tfbF3yzymb4AemUQ.png"/></div></div></figure><p id="f1af" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">正如我们所看到的，他们将有四个价值观，积极的，消极的，中性的和复合的。现在这四个将成为我们在数据中的新的四个特征。</p><h2 id="6303" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">步骤3–2:拆分数据:</h2><p id="f68c" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">分割数据主要对机器学习的<strong class="il hj">超参数调整</strong>部分有用。由于每个任务ML在模型训练中起着关键作用，并且为了使我们的模型在测试数据上相当好，调整模型超参数是重要的。</p><p id="26bd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">为了完成这项任务，我们需要数据，这些数据通常取自小部分的训练数据，如基于训练数据大小的1-2 %,可以称为交叉验证数据或简单的验证数据。</p><p id="ca80" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在给定的数据集中，我找到了831种零价格产品。但是市场上不会有价格≤0的产品。它们可能是异常值或人为错误。所以我已经把这些产品从数据中剔除了。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nn"><img src="../Images/61ecd9e8b15a5f28996f2719dc325344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OTXnhl9WbkXuZFI1YLGiA.png"/></div></div></figure><h2 id="4725" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">步骤3–3:特征提取:</h2><p id="914b" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">我们已经完成了特征工程，现在是特征提取的时候了。我们的数据是分类、数字和文本特征的组合。但是我们只能向任何ML模型提供数值数据。让我们看看如何使用特征提取技术来实现这一点。</p><p id="f206" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">矢量化可用于文本数据。让我们使用单词包(<strong class="il hj"> BOW </strong>)表示分类和术语频率，使用逆文档频率(<strong class="il hj"> TFIDF </strong>)表示文本数据。</p><p id="7852" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">分类特征的矢量化(一个热编码):</strong></p><p id="794f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们将子类别1、子类别2、子类别3、品牌名称、名称作为我们的分类特征。</p><p id="56cb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">通过<strong class="il hj">计数矢量器的<strong class="il hj"> sklearn </strong>实现可以实现一次热编码。</strong>下面是完成这项工作的代码片段。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es no"><img src="../Images/66f17ab40cfd403afec76a3bf9969585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-iX3R2EhrIVqN_SlaSGDA.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">分类特征的一种热编码- sub_category1</figcaption></figure><p id="cbf3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">请注意，countvectorizer的拟合只应在训练数据上进行。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es np"><img src="../Images/a56b7e9d52a401a1a5784c4b31edd2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lXdjqZ75R8daFoOsuNVEOg.png"/></div></div></figure><p id="a028" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">对sub_category2、sub_category3、brand_name和name特征等其他分类特征执行相同的操作。</p><p id="a65b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">文本特征的矢量化:</strong></p><p id="e4d9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">它们对于将文本特征转换成数字格式是不同的，如TFIDF、word2vec、加权平均word2vec、使用手套向量等..,</p><p id="d85a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">正如我们对分类特征使用简单的单词包一样，我们将使用TFIDF作为我们的文本特征(item_description)。</p><p id="100b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">下面是实现此任务的代码片段。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nq"><img src="../Images/3b5887887a1ac66be245e4fba6543d23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AiSCW5ftg6wnroM9Y0Eccw.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">item_description矢量化</figcaption></figure><p id="10f8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我在这里只选取了前5000个特性，其中每个特性都有至少10个文档的频率。我还使用了双字母组合来描述项目。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nr"><img src="../Images/bfb3ceb8cfab4339cfb9856186556c12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0eiTopDjIsWXCeR-ziBS6w.png"/></div></div></figure><h2 id="18ab" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated"><strong class="ak">步骤3–4:处理数字特征:</strong></h2><p id="aa5d" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">在向我们的数据添加新特征之后，我们总共有6个数字特征。(正、负、中性、复合、描述_长度、计数_停用词)</p><p id="6603" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">特征_缩放:</strong></p><p id="1acc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">由于数字特征包含不同的比例值(有些可能非常高，有些可能非常低，有些也可能是异常值),因此在解决优化问题时，对这些特征进行重定比例非常重要。这些可以通过使用标准化、规范化、最小最大值等多种方式来实现..,</p><p id="cfc7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我使用了标准化，这意味着值将遵循标准正态分布，通过拟合平均值=0和标准差=1的每个要素的值。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ns"><img src="../Images/c3b83ad4ed21919639ef9e61dfbb6dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6WwCRsTunX97UYCtLx_nyQ.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nt"><img src="../Images/f4818d2d9e3cdae628382529e0e79f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5CZSol_Ij7PWhzK1VU70XA.png"/></div></div></figure><p id="c644" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">同样，我们也将对其他数字特征进行同样的处理。查看github资源库，获取完整的代码指南。</p><p id="32e1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">二元特征和item_condition_id: </strong></p><p id="58c9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在，我们只剩下商品标识、品牌和运输特征。这些也是一种分类特征。我们将使用pandas.get_dummies()将其转换为矢量表示，并最终将其制作成稀疏矩阵。</p><p id="d55e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">可以用sklearn来完成。对于我们来说，这就是事情变得更容易的原因，不需要为它编写显式的代码，也不需要在一行代码中完成。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nu"><img src="../Images/9fd501dcf039375bba499c9c1917ed34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3SIL0JC0Tk4S8eM_qWMX3A.png"/></div></div></figure><p id="c48d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">所有功能的串联:</strong></p><p id="644c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们已经得到了所有分类和文本特征的数字格式。现在，我们将把所有这些特征合并成一个最终的稀疏矩阵，它将被馈送给我们的机器学习回归模型。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nv"><img src="../Images/686d95e170fe836ac57a7486b40b13e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9RxDoaqwjEt6CU8nkq5_dw.png"/></div></div></figure><h2 id="02b3" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">步骤3–5:回归模型:</h2><p id="241f" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">现在我们都开始应用回归模型来解决我们的问题。但是对我们的数据应用哪个模型呢？？</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nw"><img src="../Images/85860ff9837e762a736d6cd3300df7e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*ZzNkhGwzwdw0RAsDM4yG5w.jpeg"/></div><figcaption class="me mf et er es mg mh bd b be z dx translated">迷茫吧？</figcaption></figure><p id="9cb7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">机器学习</strong>是世界上发展最快的领域。每天都会有一系列新算法推出。它们中的一些可能对数据起作用，而一些可能不起作用。他们没有这样的最大似然算法可以给出比现有模型更好的结果。如果它存在，那么所有的模型都将被扔进垃圾箱。基于先验知识、领域专家、从问题陈述甚至从一等奖获得者中选择算法来解决他们的<strong class="il hj"> </strong>问题。</p><p id="ff43" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">作为实验，我使用了四个线性回归模型和一个boosting模型:</p><ul class=""><li id="4920" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">线性回归</li><li id="af30" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">里脊回归</li><li id="c3b3" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">套索回归</li><li id="ad8f" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">SGD回归器</li><li id="ac36" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">像LGBM这样的助推模型</li></ul><p id="9a83" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">最后，我们还将尝试从这些模型中组合出最佳模型。</p><p id="7305" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">超参数调整需求:</strong></p><p id="e763" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">超参数在模型预测中起着重要的作用，因为使用超参数调整，我们可以抗议我们的模型过拟合和欠拟合。</p><p id="c9a3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">因此，我们需要以这样一种方式选取这些值(超参数),即训练和测试误差都很低并且彼此一致。</p><p id="da97" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">出于超参数调整的目的，我们使用gridsearchcv和三重交叉验证数据。</p><p id="0f56" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> I)线性回归:</strong></p><p id="2727" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">线性回归是一种基本、简单和常用的预测分析类型。线性回归的总体思想是检查两件事:</p><ul class=""><li id="c351" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">一组预测变量在预测一个结果(因变量)方面做得好吗？</li><li id="f928" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">哪些变量特别是结果变量的重要预测因子，它们以何种方式——由beta估计的大小和符号表示——影响结果变量？</li><li id="4f7e" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">这些回归估计用于解释一个因变量和一个或多个自变量之间的关系。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nx"><img src="../Images/76ad81e1bbf8261241fffc25e6a849c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_p36zuG36kp403i-6YZQlA.png"/></div></div></figure><p id="e65a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">线性回归的RMSLE:训练时为0.4612，cv数据时为0.4693</strong></p><p id="0d86" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">在线性回归中不存在超参数调整，因为模型本身会找到一个最适合数据的平面。</p><p id="4adf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">这是一个简单模型的好成绩，但让我们尝试一些其他模型，通过执行超参数调整来改善指标。</p><p id="a816" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> II)套索回归:</strong></p><p id="382e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">最小绝对收缩和选择运算符</strong>简单套索是一种回归分析方法，可执行变量选择和正则化</p><ul class=""><li id="2124" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">套索回归类似于线性回归，但除了线性回归之外，它还执行收缩。</li><li id="f699" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">不像线性回归拉索有超参数调整超参数:阿尔法</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ny"><img src="../Images/6f6f3651a6e23f7876d61591271f2667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AGQO1r89xy9YLnf_F-0_rQ.png"/></div></div></figure><p id="cdfb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我得到了alpha = <strong class="il hj"> 1e-09 </strong>作为最佳值。所以我再次用最好的alpha值训练模型。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nz"><img src="../Images/36c5a1c47dd7410b16f50a10ebd159e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7A9gsWxKT8ubZ9HqAgCvzA.png"/></div></div></figure><p id="a6de" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">Lasso回归的RMSLE:训练集上为0.4642，cv数据上为0.4699。</strong></p><ul class=""><li id="7c0c" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">在做了所有的事情之后，我们得到了0.4699 RMSLE，这大约等于线性回归的RMSLE。</li><li id="6502" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">但是，与LR相比，训练和cv误差之间的差异很小，这意味着与LR模型相比，该模型的过拟合较少。</li></ul><p id="4428" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> III)岭回归:</strong></p><p id="04cf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">岭回归是一种分析多重共线性数据的技术。</p><ul class=""><li id="5adc" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">通过系数收缩降低了模型的复杂度。</li><li id="a660" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">它也是一个线性模型。</li><li id="9b31" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">此回归模型中也有超参数{alpha，solver}。我们将在这里使用两个解算器，即cholesky和lsqr，作为超参数调整的目的。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oa"><img src="../Images/b375bdd1b351965ae49ef9b601686aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5rLupSBNLV9v-SpYLNAgA.png"/></div></div></figure><p id="9963" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我将alpha = 10和solver = 'cholesky '作为最佳值。所以让我们用这些值来训练模型。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ob"><img src="../Images/f30bbdcec964b38b9fade4254bd2935f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5G9dRuxK1b5OIE-adHLDqQ.png"/></div></div></figure><p id="d684" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">岭回归的RMSLE:训练样本为0.4637，cv数据为0.4667。</strong></p><p id="6df4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">结果略好于上述两个模型。</p><p id="e592" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> IV)新币回归量。</strong></p><p id="2c83" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">随机梯度下降(SGD)是一种简单但非常有效的方法，用于线性分类器在凸损失函数如(线性)下的判别学习。</p><ul class=""><li id="0904" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">每次估计每个样本的损耗梯度，并且模型随着强度的降低而更新，即..学习率。</li><li id="38aa" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">这是一种迭代方法，用于优化具有适当光滑性质的目标函数。因此它也被称为优化算法。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oc"><img src="../Images/dc0886902b747bd5bb292f9a49397e49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gKIL4KdgWS-_i9GCRx-OdQ.png"/></div></div></figure><p id="f3f3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我将alpha = 1e-09和learning_rate = 'adaptive '作为最佳值。所以让我们用这些值来训练模型。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es od"><img src="../Images/5e8ec32785f67bc1850fd87241db87eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5GFSiZDAG4EPahdYD5mew.png"/></div></div></figure><p id="1c97" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">SGD回归的RMSLE:训练上为0.4625，cv数据上为0.4688。</strong></p><p id="734d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> V) LGBM回归量:</strong></p><p id="5bac" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">到目前为止，我们已经尝试了四个简单的线性模型。所以现在让我们尝试一个叫做LGBM的助推模型。</p><p id="a192" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">Light GBM是一个基于决策树算法的快速、分布式、高性能梯度提升框架。</p><ul class=""><li id="05d3" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">比我们在数据集上训练的其他模型训练速度更快，效率更高。</li><li id="0d7b" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">我们可以看到它占用的内存更少。</li><li id="b9be" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">它支持并行学习，并兼容更高的数据集。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oe"><img src="../Images/764647afa75c7838167972fb3653668c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1UCMlhBul6iok0Rw3JpEaw.png"/></div></div></figure><p id="7522" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们可以看到，在lgbm中有许多超参数需要调整。在做了所有的事情之后，我得到了“learning _ rate”:0.1，“max_depth: 15”，“n_estimators: 200”，“num_leaves: 75”，“boosting _ type”:“gbdt”作为我的最佳值。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es of"><img src="../Images/3cd3844978d6910a88889f16d27dc96f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QHjrhA47KVDRBM9EHIOdTA.png"/></div></div></figure><p id="6d24" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">它比我们迄今为止训练过的任何其他模型都有更好的性能。</p><p id="306e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">LGBM回归器的RMSLE:在训练集上为0.4427，在cv数据上为0.4590。</strong></p><h2 id="5202" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">合并所有模型的结果(集合):</h2><p id="e07a" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">作为在我们的模型中使用集成的承诺，让我们使用这个toss模型。</p><p id="18e3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我选择了四个最好的模型，并根据它们的性能为每个模型增加了权重。下面是它的代码片段。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es og"><img src="../Images/7e0558e1f6083ba9cf1bd7e50aee11be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GM2KMgUXvqw8w2df7tap6w.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">四个最佳模型的集合。</figcaption></figure><p id="2659" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">由于lgbm工作良好，我增加了0.6的重量，基于套索的不太适合的性质，我增加了0.2，对于山脊和线性，我增加了0.1。</p><p id="0247" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">因此，通过机器学习回归模型，我们的解决方案在cv数据上的最终RMSLE为0.4487。</strong></p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><blockquote class="if ig ih"><p id="a68d" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">第4章:通过多层感知器(神经网络)的深度学习概念的解决方案</strong></p></blockquote><p id="10c9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">为什么选择神经网络？</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nw"><img src="../Images/c95810944c986260161c7a8f7ab32605.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*fNsX50PCiEU8bs1ByTDLRg.png"/></div></figure><p id="ceb0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">神经网络是一套特定的算法，它彻底改变了机器学习。它们受到生物神经网络的启发，目前所谓的深度神经网络已经被证明工作得相当好。神经网络本身是一般的函数近似，这就是为什么它们可以应用于几乎任何关于学习从输入到输出空间的复杂映射的机器学习问题。</p><p id="8dca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">多层感知器(MLP)是一种前馈人工神经网络，它从一组输入生成一组输出。MLP的特征在于若干层输入结点在输入层和输出层之间连接成一个有向图。MLP使用反向传播来训练网络。</p><ul class=""><li id="2b80" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">这是一种深度学习的方法。</li><li id="ef99" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">与任何机器学习模型不同，MLP不需要显式的特征工程任务，因为模型本身通过反向传播适应数据中的模式。有趣吧？</li><li id="0a41" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">让我们使用一个MLP模型，并检查它是否改善RMSLE指标。</li></ul><p id="820e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在，我们将再次加载数据，并像上面一样将其分为train(用于训练)和val(用于验证)。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/c76f0f1e25dd9e5d4bb3b8f1735bab46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xU9H24orvhOrTRG-und3g.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nn"><img src="../Images/61ecd9e8b15a5f28996f2719dc325344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OTXnhl9WbkXuZFI1YLGiA.png"/></div></div></figure><p id="50be" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们从一开始就在做的事情是，为了训练，MLP可能无法与我们在ML模型中引入的功能一起工作。我从这个案例研究中体验到了这个事实。</p><h2 id="3ec0" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated"><strong class="ak">步骤4–1:处理缺失值:</strong></h2><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oh"><img src="../Images/dddaf36ef20a8da0184a9a446d47770d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EANSbUyuyaXCUlMu4_NVXQ.png"/></div></div></figure><p id="0d3e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们可以看到，我已经用空字符串替换了丢失的值。根据一等奖获得者的概念，我将名称、类别名称、品牌名称和商品描述连接成一个功能，将名称和品牌名称连接成另一个功能。我还规范化了item_condition_id特性。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oi"><img src="../Images/3dd00c8b7d6418906831f169c483b708.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zv5tMO0KjvJC1gCA66TZ-g.png"/></div></div></figure><p id="3b42" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我没有采用price，而是采用log(price+1 ),最后我使用minmaxscaler对这些值进行了预处理。</p><h2 id="df96" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated"><strong class="ak">步骤4–2:特征提取:</strong></h2><p id="3ffa" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">这里，我们将使用TFIDF矢量化作为“total_name”和“total_txt”要素的要素提取工具。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oj"><img src="../Images/c34bf69d8953cd9de30dd05b1f8440d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y7lLT27QCeCXEb7PXbhGDw.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ok"><img src="../Images/0a6067bc8e384b3d8b20481851362cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6QO4X9a5HdQlq5BHayK0PA.png"/></div></div></figure><p id="e590" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">正如我所说的，MLP模型本身通过权重适应数据中的模式，它所需要的只是通过网络传递的大量数据。我为每个矢量化选择了1个lakh特征，还包括了文本数据的二元模型。</p><p id="a7d9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">如果您使用的是colaboratory，那么当Colab崩溃时(我个人在处理这个案例研究时多次经历过这种情况),笔记本会自动断开连接，我们需要从头开始运行所有功能，因此我们不能使用超过220万个功能。</p><p id="814e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">项目_条件_id和发货特征:</strong></p><p id="aa6e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">正如我们在ML中使用pd.get_dummies()一样，我们在这里也将使用相同的方法。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ol"><img src="../Images/8f2463ddb84048800a177a0f8cb935ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ClSNjzpn54tePozWuMOgOw.png"/></div></div></figure><p id="499d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">误差度量:</strong></p><p id="bb97" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">对于模型评估，我们将使用<strong class="il hj"> RMSLE </strong>(均方根对数误差)指标。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es om"><img src="../Images/b9f9667d87af236b63d6334c7333fffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KpVaYKxw2iRp02qWVoOyXw.png"/></div></div></figure><h2 id="3498" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated"><strong class="ak">步骤4–3:构建模型架构:</strong></h2><p id="82e6" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">我们可以使用不同类型的神经网络架构来训练我们的模型。我们将讨论到今天为止的四大著名建筑。</p><p id="1355" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> I)感知器:</strong></p><p id="8f99" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">被认为是第一代神经网络，<strong class="il hj">感知器</strong>是单个神经元的简单计算模型。他们似乎有一个非常强大的学习算法，并且对他们能学会做什么提出了很多宏伟的主张。然而，感知器学习过程今天仍然广泛用于具有包含数百万个特征的巨大特征向量的任务。</p><p id="4caa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> II)卷积神经网络(CNN): </strong></p><p id="0cc5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">随着时间的推移，机器学习研究广泛关注于对象检测问题。但是有各种各样的事情使得识别物体变得困难，比如分割、光照、变形等等..,</p><p id="8430" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">卷积神经网络可以用于从手写数字到3D对象的所有与对象识别相关的工作。CNN的真正价值是在ImageNet上的<strong class="il hj"> ILSVRC-2012 </strong>比赛中显现出来的ImageNet是一个拥有大约120万张高分辨率训练图像的数据集。竞赛的获胜者<a class="ae kf" href="http://www.image-net.org/challenges/LSVRC/2012/supervision.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="il hj">Alex Krizhevsky(NIPS 2012)</strong></a>开发了一种由Yann LeCun开创的非常深度的卷积神经网络。这些使他们如此受欢迎。</p><p id="151a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">三)递归神经网络(RNN): </strong></p><p id="8485" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">rnn非常强大，因为它们结合了两个属性:</p><ol class=""><li id="7203" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg nf lo lp lq bi translated">分布式隐藏状态，允许它们高效地存储大量关于过去的信息，以及</li><li id="d44f" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg nf lo lp lq bi translated">2)非线性动力学，允许它们以复杂的方式更新它们的隐藏状态。如果有足够的神经元和时间，RNNs可以计算任何你的计算机可以计算的东西。</li></ol><p id="6cd2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">四)长短期记忆(LSTM): </strong></p><p id="7adf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><a class="ae kf" href="http://www.bioinf.jku.at/publications/older/2604.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="il hj">hoch Reiter&amp;schmid Huber(1997)</strong></a><strong class="il hj"/>通过建立所谓的<strong class="il hj">长短期记忆网络，解决了让RNN人长时间记住事情(比如几百个时间步骤)的问题。</strong>他们设计了一种记忆细胞，使用逻辑和线性单元，具有乘法相互作用。每当单元的“写”门打开时，信息就进入单元。只要单元的“保持”门打开，信息就留在单元中。通过打开单元的“读取”门，可以从单元中读取信息。</p><p id="ce6d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们的数据集是基于文本特征的，所以我正在构建一个简单的<strong class="il hj"> MLPs </strong>来训练神经网络。这是它的代码片段。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es on"><img src="../Images/07fd17702d08c17c30ad2a862d8d3e49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*boUrgK12hB3GQET9mnFV-Q.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oo"><img src="../Images/9a852faf883015b093ff5351951a1ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6bpL_OlKQwIDJc7mlJSqQ.png"/></div></div></figure><ul class=""><li id="2c00" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">我已经尝试运行了几个时期的模型，但火车和CV上的rmsle都变得更糟。</li><li id="3979" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">因此，我对模型进行了四次训练，用不同的批量大小对每个模型进行了三次拟合。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es op"><img src="../Images/285ee3e48c37e0c16c1fff20e2e25254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D01MLLce9C90IJ1iK1Vl4Q.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">模型预测。</figcaption></figure><ul class=""><li id="2bd6" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">现在，对于这些模型中的每一个，我对数据进行了单独的模型预测。</li><li id="59fb" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">最后，我将所有四个模型的结果进行综合，以减少RMSLE度量。</li></ul><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es oq"><img src="../Images/6207ef1a7ad42103f9d5299485f8e50e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4as-qCp--jKN0-U-xd2a4A.png"/></div></div></figure><p id="36ab" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">综合MLP的RMSLE:在列车上为0.4068，在cv数据上为0.4179</p><h2 id="4ad8" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">所有模型的结果:</h2><p id="23be" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">在训练了机器学习的各种回归模型和神经网络的MLP之后，我得到了0.4179作为我最好的RMSLE分数。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es or"><img src="../Images/2f5c99aa4134363aeaa45a7632e1bee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*aJEyS6LGi3rbGE0CDWnGBA.png"/></div><figcaption class="me mf et er es mg mh bd b be z dx translated">总结所有模型的结果</figcaption></figure><h2 id="d28d" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">最终提交分数:</h2><p id="2025" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">到目前为止，我们已经在列车数据(train.tsv.7z)上使用了所有这些模型，但对于最终提交，我们有单独的数据(test_stg2.tsv)。我提交了组装mlp模型的价格预测，这是我们问题的最终解决方案。</p><p id="bf91" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">这是我通过本次比赛的kaggle内核之一提交提交文件后在kaggle上的最终排行榜分数。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es os"><img src="../Images/0934b46dc0b7992cced55bbeee59e500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nL2kzCmWhdkn0oh-cSk2jA.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">本次比赛排行榜上的最终提交分数</figcaption></figure></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><blockquote class="if ig ih"><p id="521b" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">第五章:结论:</strong></p></blockquote><p id="6b37" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">我们问题陈述的最终解决方案:</strong></p><ul class=""><li id="3e64" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">因为给定问题陈述的主要约束是减少rmsle度量。在对数据训练不同的ML模型后，我们发现cv数据的最小RMSLE为0.44。</li><li id="98a6" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">进一步应用MLP，rmsle减少到0.41，因此这个问题的解算器是<strong class="il hj"> MLP </strong>。</li></ul><p id="9570" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">关于模特培训:</strong></p><ul class=""><li id="228c" class="li lj hi il b im in iq ir jt lk ju ll jv lm jg ln lo lp lq bi translated">我试着在未来的5-10个周期内训练这个模型，我从结果中观察到rmsle正在变得更糟。因此我把训练限制在一个时期。我达到了0.44 rmsle。</li><li id="44f3" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">之后，我用不同的2的倍数的批量对同一个MLP模型进行了三次拟合，rmsle降低到大约0.42。</li><li id="f2cf" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">现在，我对所有四个相似的经过训练的MLP模型进行了整合，对于每个数据点，我使用这些模型预测了价格，并最终取这些预测价格的平均值。</li><li id="e669" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">结果，我在cv数据上获得了<strong class="il hj"> 0.41 </strong> rmsle。</li><li id="a0a0" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">ML和DL是一项试验不同方法的任务，所以我尝试了各种方法来完成这项任务。</li></ul><h2 id="ce2d" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">我对现有方法的改进:</h2><p id="dd6f" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jt lf iw ix ju lg ja jb jv lh je jf jg hb bi translated">我没有采用单独的特征，而是将特征组合起来得到两个新特征，并通过矢量化从中提取了20万个新特征。我还做了这些特征的二元图，这些特征对这些数据非常有效。我还发现了产品价格等于零的数据中的异常值，因此在训练模型时，我删除了产品价格小于或等于零的所有数据点。所有这些都提高了我的模型误差度量，超过了本次比赛的在线解决方案。</p><h2 id="58b7" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">未来工作:</h2><ul class=""><li id="4ed5" class="li lj hi il b im ld iq le jt ot ju ou jv ov jg ln lo lp lq bi translated">作为未来的工作，我想通过尝试模型的新工程特征来试验新的ML回归模型。</li><li id="2e80" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated">这个问题我也想试试卷积神经网络。我希望尝试使用不同的超参数来加快模型的收敛。</li></ul></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><h2 id="4475" class="ki kj hi bd kk kl km kn ko kp kq kr ks jt kt ku kv ju kw kx ky jv kz la lb lc bi translated">参考资料:</h2><ul class=""><li id="defd" class="li lj hi il b im ld iq le jt ot ju ou jv ov jg ln lo lp lq bi translated"><a class="ae kf" href="https://www.kdnuggets.com/2018/02/8-neural-network-architectures-machine-learning-researchers-need-learn.html" rel="noopener ugc nofollow" target="_blank">https://www . kdnugges . com/2018/02/8-神经网络-架构-机器学习-研究人员-需求-学习. html </a></li><li id="8d02" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated"><a class="ae kf" rel="noopener" href="/analytics-vidhya/mercari-price-suggestion-challenge-a-machine-learning-regression-case-study-9d776d5293a0">https://medium . com/analytics-vid hya/mercari-price-suggestion-challenge-a-machine-learning-regression-case-study-9d 776d 5293 a 0</a></li><li id="cc86" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated"><a class="ae kf" href="https://sijunhe.github.io/blog/2018/03/02/kaggle-mercari-price-suggestion-challenge/" rel="noopener ugc nofollow" target="_blank">https://sijunhe . github . io/blog/2018/03/02/ka ggle-mercari-price-suggest-challenge/</a></li><li id="20fa" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated"><a class="ae kf" href="https://www.kaggle.com/c/mercari-price-suggestion-challenge/discussion" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/mercari-price-suggestion-challenge/discussion</a></li><li id="78c7" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated"><a class="ae kf" href="https://towardsdatascience.com/a-data-science-case-study-with-python-mercari-price-prediction-4e852d95654" rel="noopener" target="_blank">https://towards data science . com/a-data-science-case-study-with-python-mercari-price-prediction-4e 852d 95654</a></li><li id="00f5" class="li lj hi il b im lr iq ls jt lt ju lu jv lv jg ln lo lp lq bi translated"><a class="ae kf" href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener ugc nofollow" target="_blank">https://www . Applied ai course . com/course/11/Applied-Machine-learning-course</a></li></ul><p id="9f78" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">这是我的第一次Kaggle体验，在这里我学到了应用ML和DL的真实场景。作为一名渴望成为数据科学家的人，我来到了这里。这包括我这次比赛的最终作品。谢谢你阅读我的文章。</p><p id="85bd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">您可以查看。ipynb在我的<a class="ae kf" href="https://github.com/ChaitanyaNarva/ChaitanyaNarva/blob/master/mercari_casestudy.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj"> Github存储库中获得这个案例研究的完整代码片段。</strong>T15】</a></p><p id="2653" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">关注我</strong>了解更多关于数据科学中不同真实案例研究的文章和实现！也可以通过<a class="ae kf" href="http://www.linkedin.com/in/sai-chaitanya-narava-20b3571a0" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj"> LinkedIn </strong> </a>和<strong class="il hj"/><a class="ae kf" href="https://github.com/ChaitanyaNarva/ChaitanyaNarva" rel="noopener ugc nofollow" target="_blank"><strong class="il hj">Github</strong></a>与我联系</p><p id="b14a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我希望你从这件事中学到了一些东西。这方面的学习永无止境，所以快乐学习吧！！签署再见:)</p></div></div>    
</body>
</html>