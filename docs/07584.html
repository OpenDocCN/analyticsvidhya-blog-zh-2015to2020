<html>
<head>
<title>What I learned from my first Image Processing Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我从我的第一个图像处理项目中学到了什么</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-i-learned-from-my-first-image-processing-project-44433d1fddb7?source=collection_archive---------13-----------------------#2020-06-30">https://medium.com/analytics-vidhya/what-i-learned-from-my-first-image-processing-project-44433d1fddb7?source=collection_archive---------13-----------------------#2020-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="9c45" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">利用OpenCV Python从眼底图像中提取血管</h2><div class=""/><figure class="ev ex ip iq ir is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es io"><img src="../Images/5b95482636588d8a8eb8c2591ba69b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0ROS1ctnErudPrmHpG-Dg.jpeg"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">眼底图像</figcaption></figure><p id="93ea" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">图像处理是对图像进行某种操作，以获得增强的图像或从中提取有用信息的方法。</p><p id="1fed" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">管道是一系列相连的操作集合，其中一个操作的输出是下一个操作的输入。在图像处理中，一项任务可以通过许多不同质量的不同管道来完成。</p><p id="35ab" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我对任何试图用一个新框架开始一个项目的人的建议是，不要试图在项目开始之前了解关于该框架的一切。你可以边做边了解。最好能有个大概的概念，我们能用这个技术和项目蓝图做什么。让我们以这个项目为例。</p><p id="eb37" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在这个项目中，我们的最终目标是分别提取大血管和小血管。血管在图像中被突出显示，因为它们比其他血管更暗。所以一开始我想，如果我能通过颜色过滤所有的血管(这不起作用)，那么我可以通过平滑或模糊来去除小血管，并提取大血管。之后，我需要做的就是从所有血管中减去大血管，提取小血管。这是我实现目标的最初途径。</p><p id="c703" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">然后我发现了一种使用HSV颜色空间来检测物体的方法。这是代码。</p><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div></figure><figure class="kb kc kd ke fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es kh"><img src="../Images/13822bdb9c1b1430465434f1201edef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3ETv7pVB-tRljHaoAKGmA.png"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">带跟踪条的遮罩和分辨率输出</figcaption></figure><p id="4646" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在这里，您可以更改参数并查看输出如何变化。点击退出按钮关闭它。上面的数字是我得到的最好的一个，我对输出不满意。然后我开始用增加亮度和对比度的方法试了一下。但是它没有给我我想要的东西。所以我决定换一种方法。</p><p id="434e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">然后我发现<strong class="jf hs"> <em class="ki">灰度</em> </strong>和<strong class="jf hs"> <em class="ki">绿色通道</em> </strong>图像更容易在各种任务中工作，例如在许多形态学操作和图像分割问题中，并且当我们处理单层图像时，更容易区分图像的特征。于是我应用了<strong class="jf hs"> <em class="ki">灰度</em> </strong>和<strong class="jf hs"> <em class="ki">阈值</em> </strong>配合<strong class="jf hs"> <em class="ki">去噪</em> </strong>。</p><figure class="kb kc kd ke fd is er es paragraph-image"><div class="er es kj"><img src="../Images/558ad91be211374b3d7d79abeebe4e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*_QonSy6OVTCKsImsay_K6Q.jpeg"/></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">应用灰度后的阈值和去噪</figcaption></figure><p id="f897" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">因此，我们可以清楚地看到，它比以前提取了更多的血管，但有很多噪声。所以我必须想办法消除这些噪音。多亏了堆栈溢出，我找到了移除小对象的方法，但是当我直接将它应用到这里时，它移除了相当多的数据。在谷歌和stack overflow的帮助下，我找到了一个解决这个问题的方法，应用<strong class="jf hs"> <em class="ki">膨胀</em> </strong>，然后移除小物体。</p><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">移除小物件</figcaption></figure><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">内核大小的膨胀(5，5)</figcaption></figure><p id="0902" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我尝试了不同内核大小的膨胀，最终得到的是size (2，2)。然后我不小心用大小(1，2)试了一下，它有一些比内核大小(2，2)更多的细节。然后我用大小(2，1)试了一下，它也有一些比内核大小(2，2)更多的细节，甚至比(1，2)更多的细节，但有些细节丢失了。当我合并(1，2)和(2，1)图像时，它给出了更好的输出。</p><div class="kb kc kd ke fd ab cb"><figure class="kk is kl km kn ko kp paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/fb378467afc5b81559c2ed19f543e5b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*qWHieVXKgyhZJ6-zTmxk1w.jpeg"/></div></figure><figure class="kk is kl km kn ko kp paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/959d3cf8fdc8df7036a00cd02d4fd720.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*b_y7844WMKwdLGTSuaE8Nw.jpeg"/></div></figure><figure class="kk is kl km kn ko kp paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/266ab5eaa96c9e16cd79b7bfc0e391a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*eBgZUIXgxdIgGXBr2Wu73g.jpeg"/></div><figcaption class="iz ja et er es jb jc bd b be z dx kq di kr ks translated">从左边开始(内核大小为(2，2)，内核大小为(1，2)，内核大小为(2，1))</figcaption></figure></div><div class="ab cb"><figure class="kk is kl km kn ko kp paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/526d204aadfe63c5069bd501b0c5065d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*XTg9htGCtxivw-LrArP63Q.jpeg"/></div></figure><figure class="kk is kt km kn ko kp paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/41d4c206e5c6003af9490ac62f3392b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*D9GAx4RhP1Wuhj3ns8ESog.jpeg"/></div></figure><figure class="kk is kt km kn ko kp paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/5efb0802cb922e58d1356c457572c7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Tcq-OpDAnHHn1BsKk6kxjQ.jpeg"/></div><figcaption class="iz ja et er es jb jc bd b be z dx kq di kr ks translated">从左侧开始(移除内核大小为(2，2)、内核大小为(1，2)、内核大小为(2，1)的小对象后)</figcaption></figure></div><figure class="kb kc kd ke fd is er es paragraph-image"><div class="er es kj"><img src="../Images/2de2c2f821b4904f12af356803a61482.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*TcOPKnB1pIm87xm1u9axbQ.jpeg"/></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">合并用核大小(1，2)和(2，1)过滤的图像后</figcaption></figure><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">提取所有血管</figcaption></figure><p id="03e1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">可能有一些其他的管道可以提供比这更好的输出。但是我很高兴我得到了什么，因为这是我的第一个图像处理项目和我的时间😉。如果我们去掉背景，你会看得更清楚。你可以使用<strong class="jf hs">屏蔽</strong>和<strong class="jf hs"> <em class="ki">逐位非</em> </strong>运算符来完成。</p><p id="0a26" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hs">遮罩</strong>是由零值和非零值组成的二进制图像。如果<strong class="jf hs">屏蔽</strong>应用于另一个二进制或相同尺寸的<strong class="jf hs">灰度</strong>图像，则<strong class="jf hs">屏蔽</strong>中为零的所有像素在输出图像中被设置为零。所有其他保持不变。</p><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="ead7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在我们的例子中，我们可以定义一个类似下面的函数来移除背景。</p><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div></figure><figure class="kb kc kd ke fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es io"><img src="../Images/9bb72988b3250ca44f8645147e5d6787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zFZytQK8MSxPhtb4i2shQ.jpeg"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">移除背景后</figcaption></figure><p id="ba00" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">那好吧。现在我的第一步完成了。现在我应该尝试提取大血管或小血管。然后我可以从所有血管中减去它，得到另一种血管类型。但是由于小血管比较细，我觉得除了大血管之外的小血管切除起来会比较容易。</p><p id="fceb" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我最初的想法是通过应用模糊和平滑来提取小血管。但是并没有像我想的那样奏效。所以我不得不转向另一种方法。然后，我尝试使用椭圆形状的结构元素进行形态变换，我能够移除小血管。然后我发现轮廓，并删除小组件，同时绘制其他轮廓。以下功能将为您提取大血管。</p><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div></figure><figure class="kb kc kd ke fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es io"><img src="../Images/e334dcc8df45ccb51ac8e76eac9df5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3RSDyBofnLCn7hQrkDLaKA.jpeg"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">在应用形态变换之后</figcaption></figure><figure class="kb kc kd ke fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es io"><img src="../Images/7303541f9bbd8032d14761cc15c1aefb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gmMhHmekSNQG9Xe4v5TpDQ.jpeg"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">大血管</figcaption></figure><p id="612d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">然后通过减法，你可以使用下面的函数提取小血管。</p><figure class="kb kc kd ke fd is"><div class="bz dy l di"><div class="kf kg l"/></div></figure><figure class="kb kc kd ke fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es io"><img src="../Images/89157b709308df0efe2f68f39b0dd1e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7vYJTtIorZ7jtgFm4I1Sg.jpeg"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">小血管</figcaption></figure><p id="50c9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">正如我已经说过，这是我的第一次尝试，它可能不是最好的管道。如果你有比这更好的东西，请留下评论，让我知道。最后，我学到的是，没有找到最佳管道的理论或规则。这是你必须从经验和研究中获得的东西。</p><p id="bde8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">希望这个关于图像处理操作的教程能够帮助那些刚接触OpenCV图像处理的人。</p><p id="5c15" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">完整代码请访问我的<a class="ae ku" href="https://github.com/jpbinith/Extract_Blood_Vessels_from_Fundus_Image.git" rel="noopener ugc nofollow" target="_blank"> Github库</a>。</p></div></div>    
</body>
</html>