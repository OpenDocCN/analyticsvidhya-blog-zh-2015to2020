<html>
<head>
<title>The Derivative of Cost Function for Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归的成本函数导数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/derivative-of-log-loss-function-for-logistic-regression-9b832f025c2d?source=collection_archive---------0-----------------------#2019-12-13">https://medium.com/analytics-vidhya/derivative-of-log-loss-function-for-logistic-regression-9b832f025c2d?source=collection_archive---------0-----------------------#2019-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="59db" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">简介:</strong></h1><p id="9da4" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">线性回归使用<strong class="jf hj">最小平方误差</strong>作为损失函数，给出凸损失函数，然后我们可以通过找到其顶点作为全局最小值来完成优化。然而，对于逻辑回归，假设被改变，通过使用应用于原始模型输出的sigmoid函数进行计算，最小平方误差将产生具有局部最小值的非凸损失函数。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kb"><img src="../Images/18696ffb09d446c47e2b6135259ed768.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/0*oNlo-tas5o6Aq9CV.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">左(线性回归均方损失)，右(逻辑回归均方损失函数)</figcaption></figure><p id="4b8b" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">然而，我们非常熟悉线性回归成本函数的梯度。它有一个非常简单的形式，如下所示，但我想在这里提到一点，即尽管有一个复杂的对数损失误差函数，逻辑回归损失函数的梯度也有相同的形式。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ks"><img src="../Images/6bf9dbcebbc619dd77e2ed431c74284c.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*0zBXd0mLMNf1b55gZMBH8Q.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">线性回归损失函数的梯度</figcaption></figure><p id="ccfa" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">为了保持损失函数的凸性，为逻辑回归设计了对数损失误差函数。成本函数分为y=1和y=0两种情况。</p><p id="0d60" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">对于y=1的情况，我们可以观察到，当假设函数趋于1时，误差最小化为零，当假设函数趋于0时，误差最大。这个标准完全符合我们想要的标准</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/a560a09d909648fe50f68f31e1ff3836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6oBgYMy4wOls9zGC-frSQg.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">价值函数</figcaption></figure><p id="391d" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">结合这两个方程，我们得到如下所示的凸对数损失函数</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ky"><img src="../Images/a758fd84482932713c1be5b4e1cd9657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4pQ9NkAt8m-qdCCZF0Vs1Q.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">组合成本函数</figcaption></figure><p id="ed05" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">为了优化这个凸函数，我们可以用梯度下降法或牛顿法。对于这两种情况，我们都需要导出这个复杂损失函数的梯度。下面给出的步骤显示了推导梯度的数学方法</p><h1 id="5916" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">成本函数的导数:</strong></h1><p id="1574" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">由于逻辑回归的假设函数本质上是sigmoid，因此，第一个重要步骤是找到sigmoid函数的梯度。从下面的推导中我们可以看出，sigmoid函数的梯度遵循一定的模式。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kz"><img src="../Images/d73e9022b8f7fcae2a022343dfd28a84.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*JH0SOoHwq8jM32ga1-eW6Q.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">假设函数</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es la"><img src="../Images/7fc88ad7067bb67c6297718a8b9888e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*hx8Kx9QUp1ax6ROepQkM4w.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">s形函数的导数</figcaption></figure><h1 id="cb57" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">第一步:</strong></h1><p id="d0dd" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">应用链式法则和偏导数写作。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lb"><img src="../Images/335fa9ac3658995ac457ff3147134bd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*fBY7hqlFPPxsdyCzzPZepg.png"/></div></figure><h1 id="b1e6" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">第二步:</h1><p id="a51f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">使用sigmoid函数的导数模式计算偏导数。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lc"><img src="../Images/5d3db197f96b050a338c8592cc93e580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*GSEZeZRaOCoheXBP_B1uKQ.png"/></div></figure><h1 id="47ea" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">第三步:</strong></h1><p id="d776" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">用乘法简化术语</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ld"><img src="../Images/19fcc5c4ef950fbe8ed7237d37dd6f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*GpdxG6KjpnKcT9tL0LjuZg.png"/></div></figure><h1 id="2ec4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">第四步:</strong></h1><p id="0c5a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">通过将求和项转换成关于包括偏差项在内的所有权重的梯度的矩阵形式来移除求和项。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es le"><img src="../Images/541f12656d1eea4754becbd36a775558.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*Nr2E9HL-RCDIW78VmBiJyg.png"/></div></figure><h1 id="8c66" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">结论:</strong></h1><p id="c925" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这个小微积分练习表明，线性回归和逻辑回归(实际上是一种分类)达到了相同的更新规则。我们应该理解的是，成本函数的设计是这种“巧合”发生的部分原因。</p><h1 id="c667" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">感谢您的阅读！！！！</h1><p id="d965" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你喜欢我的工作并想支持我:</p><p id="26b1" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">1-支持我的最好方式是在<a class="ae lf" rel="noopener" href="/@saketthavananilindan"><strong class="jf hj"/></a><strong class="jf hj">中关注我。</strong></p><p id="1da9" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">2-在<a class="ae lf" href="https://www.linkedin.com/in/saket-thavanani-b1a149a0/" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> LinkedIn </strong> </a> <strong class="jf hj">上关注我。</strong></p></div></div>    
</body>
</html>