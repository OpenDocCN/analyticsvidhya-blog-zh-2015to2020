<html>
<head>
<title>2 Things You Need To Know About Multi-armed Bandit — a gentle touch on Beta and Thompson</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于多臂土匪你需要知道的两件事——温柔地接触贝塔和汤普森</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/2-things-you-need-to-know-about-multi-armed-bandit-a-gentle-touch-on-beta-and-thompson-15cdbf901ce0?source=collection_archive---------16-----------------------#2020-02-23">https://medium.com/analytics-vidhya/2-things-you-need-to-know-about-multi-armed-bandit-a-gentle-touch-on-beta-and-thompson-15cdbf901ce0?source=collection_archive---------16-----------------------#2020-02-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4f14fc76b063cdca0f9df324616c11a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8I4_fxwsE7s_5FRfM1BSow.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由来自<a class="ae iu" href="https://www.pexels.com/photo/slot-machines-3021120/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae iu" href="https://www.pexels.com/@dariabuntaria?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">达莉亚·桑尼科娃</a>拍摄</figcaption></figure><p id="507f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">想象你在赌场玩得很开心。有许多老虎机，每台机器有不同的支付率。作为一个有逻辑的人，你想把你的钱放在有最大预期回报的机器上。这就是多兵种土匪问题的由来。我们将在这里涵盖两个最基本的概念:贝塔分布和汤普森抽样。</p><h1 id="0661" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">贝塔分布</h1><p id="605b" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我们使用<strong class="ix hj">贝塔分布</strong>来模拟最简单形式的多臂强盗问题，即二元结果/回报。在赌场的例子中，当结果是成功时，每台机器将支付1美元的奖励，当结果是失败时，支付0美元的奖励。我们的目标是识别成功概率最高的机器。贝塔分布是在区间[0，1]上定义的一族连续概率分布，区间由两个正形状参数参数化，用<em class="kw"> α </em>和<em class="kw"> β </em>表示，它们作为随机变量的指数出现并控制分布的形状。更多信息可在<a class="ae iu" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><blockquote class="kx ky kz"><p id="e3d4" class="iv iw kw ix b iy iz ja jb jc jd je jf la jh ji jj lb jl jm jn lc jp jq jr js hb bi translated">我们使用<strong class="ix hj"> Beta分布</strong>来表示以下两个重要属性:</p><p id="5032" class="iv iw kw ix b iy iz ja jb jc jd je jf la jh ji jj lb jl jm jn lc jp jq jr js hb bi translated">1.贝塔分布被定义在0和1之间，它与我们的估计量的范围相关。</p><p id="63b6" class="iv iw kw ix b iy iz ja jb jc jd je jf la jh ji jj lb jl jm jn lc jp jq jr js hb bi translated">2.后验概率是具有更新参数的β。</p></blockquote><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/e6aea46103af887efa87a3b05c899536.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*84FMqKGJBHUDiE0jW-Pt0Q.png"/></div></figure><p id="d2e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以棒球为例。击球率(BA)是评价一个球员的指标，我们想为一个真实BA为30%的新球员估算BA。由于新球员没有任何击球历史，我们可以假设估计的BA的分布遵循Beta(1，1)，即我们的估计在0和1之间平均分布。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es li"><img src="../Images/7b2063c2fdcdcea82c09ccbaaa992364.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*9Cl6fT0VzW5NgUZHPMvfpA.png"/></div></figure><p id="54b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着游戏的进展，我们可以收集更多的数据，并对玩家的BA做出更好的估计。利用β的性质，我们观察到在10 AB(在蝙蝠时)之后，估计的BA为~10%，但是在1000 AB之后非常接近真实值30%(<a class="ae iu" href="https://github.com/colawhite/abtesting/blob/master/multi_armed_bandit_intro.ipynb" rel="noopener ugc nofollow" target="_blank">代码</a>)。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/dfeeb579f9d9ae16b99f74117f0e41ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*wCxhTLts5O0Gn925D9ytQw.png"/></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/6a1cafed6d34f020c64b16725ab5fb49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*jmiIPZNe7dzasODiFd7--w.png"/></div></figure><h1 id="c14f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">汤普森取样</h1><p id="db5f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">继续讨论，我们使用3个带有Beta分布的老虎机来解释Thompson采样的工作原理。槽0、1和2的真实成功概率分别是0.7、0.8和0.9，然而概率是未知的。我们的目标是识别成功概率最高的机器。</p><p id="2539" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样，由于我们没有信息，我们假设所有3台机器都具有相同的先验分布Beta(1，1)，即3台机器被选中进行实验的可能性相同。在开始时间t = 0，我们运行1000个实验，并观察到机器0、1和2分别被选择324、345和331个实验。然后，我们使用实验结果更新三台机器的β分布的<em class="kw"> α </em>和<em class="kw"> β </em>，然后使用更新后的β作为接下来1000次实验在时间t = 1的新先验概率。我们继续这个过程，直到t = 1000，结果如下所示(<a class="ae iu" href="https://github.com/colawhite/abtesting/blob/master/BernThompson_basic.ipynb" rel="noopener ugc nofollow" target="_blank">代码</a>)。汤普森抽样让我们能够识别真正的最佳机器(机器#2)。这个例子也被称为贝塔-伯努利强盗。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/f9573eac86f640e252f607df604930cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*35D_iTq7pvSQ4vVxOjMSrw.png"/></div></figure><h1 id="5b00" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">概述</h1><p id="169f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">读完这篇文章你应该知道1)什么是贝塔分布，为什么我们假设贝塔分布；以及2)如何应用Thompson采样来解决最简单的多臂土匪问题。下次见！</p><h1 id="27bd" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><ol class=""><li id="3185" class="lm ln hi ix b iy kr jc ks jg lo jk lp jo lq js lr ls lt lu bi translated"><a class="ae iu" href="https://arxiv.org/pdf/1707.02038.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1707.02038.pdf</a></li><li id="7709" class="lm ln hi ix b iy lv jc lw jg lx jk ly jo lz js lr ls lt lu bi translated"><a class="ae iu" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Beta_distribution</a></li></ol></div></div>    
</body>
</html>