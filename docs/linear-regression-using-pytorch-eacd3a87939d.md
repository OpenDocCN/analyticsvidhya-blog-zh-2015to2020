# 使用 PyTorch 进行线性回归

> 原文：<https://medium.com/analytics-vidhya/linear-regression-using-pytorch-eacd3a87939d?source=collection_archive---------25----------------------->

> 在这篇博客中，我们将根据某些参数来分析适用于个人的费用的保险数据集。

# 简介:

保险是一种保护手段。保险有很多种，像健康保险、车辆保险、电话保险。人们购买保险是为了保护自己免受损失。今天，我们期待保险成本预测。我们通过线性回归预测客户未来需要支付的成本。对于这种预测，我们考虑某些参数，如**人的年龄**，这是强制了解客户是否合格。**性别**，要知道是男是女还是别人。**身体质量指数**，这有助于估计你的保单将花费多少。它考虑了顾客的身高和体重等变量，并在一定的统计数据下得到验证。儿童数量，它有助于将父母的保险扩展到儿童。吸烟习惯，它会导致一些健康问题。预测每年的医疗账单的价格。

浏览数据集:

在这个数据集中，我们有 1271 行和 7 列不同参数的形状，如年龄、性别、bmi、儿童、吸烟者、地区和费用。其中我们将“年龄、性别、bmi、儿童、吸烟者、地区”视为“输入”，将“费用”视为“输出”。我们有 3 个“分类栏”，即“性别、吸烟者、地区”。

数据的基本统计:

电荷分布(输出变量):

# 步骤 2:为训练准备数据集

*   我们需要将 Pandas 数据框中的数据转换为 PyTorch 张量以进行训练。
*   为此，第一步是将它转换成 numpy 数组。
*   如果你已经填写了`input_cols`、`categorical_cols`和`output_cols` t
*   下面的函数将执行到 numpy 数组的转换。

当数据帧被转换成 numpy 数组时。数组分为 float 32 和 float64。将`inputs_array`和`targets_array`的 numpy 数组转换成 PyTorch 张量。

*   确保数据类型为`**torch.float32.**`要转换我们使用的函数为“type (float32)”。

我们将在`0.1`和`0.2`之间取一个数来确定用于创建验证集的数据部分。然后，我们使用`random_split`来创建训练&验证数据集

最后，我们可以为培训和验证创建数据加载器。

我们可以根据自己的意愿来决定批量大小，我选择了 10 个作为批量大小

现在，我们将 train 和 val 数据集的数据以及批量大小加载到 train_loader 和 val_loader。

我们正在验证批次数据是否正常工作。

# 步骤 3:创建线性回归模型

我们的模型本身是一个相当直接的线性回归。

让我们使用`InsuranceModel`类创建一个模型。您可能需要稍后返回并重新运行下一个单元来重新初始化模型，以防损失变成`nan`或`infinity.`让我们使用`model.parameters`来检查模型的权重和偏差。

步骤 4:训练模型以适应数据:

为了训练我们的模型，我们将使用相同的`fit`函数解释。这就是定义通用训练循环的好处——我们可以用它来解决任何问题。我们使用 **se 的** `**evaluate**` **函数来计算训练前验证集上的损失。**

我们现在准备训练模型。您可能需要多次运行训练循环，针对不同的时期数和不同的学习率，以获得良好的结果。此外，如果您的损失变得太大(或`nan`)，您可能需要通过运行单元`model = InsuranceModel()`来重新初始化模型。尝试一段时间，尽量降低损失。**我们将以不同的学习率(如 0.1、0.01、0.001 等)对模型进行 4-5 次训练&以获得不同的历元数。检查所有时期模型的最终验证损失。**

步骤 5:使用训练好的模型进行预测

这是我在 10 级时遇到的可能性较小的目标。您可以检查不同级别的目标值，并查看较小的值。

**最后的话**

如果你做到了这一步，感谢你的阅读。特别感谢来自 [Jovian.ml](https://jovian.ml/) 的 [Aakash](/@aakashns) 提供[深度学习与 PyTorch 课程](https://jovian.ml/forum/c/pytorch-zero-to-gans)。如果您有兴趣了解更多信息，请注册该课程或浏览论坛开始学习。

**参考文献:**

[https://jovian . ml/sridedeepyanandamuri/02-insurance-linear-regression](https://jovian.ml/sridedeepyanandamuri/02-insurance-linear-regression)