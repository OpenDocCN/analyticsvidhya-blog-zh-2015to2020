<html>
<head>
<title>Categorical Feature Selection using Chi- Squared Test</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用卡方检验的分类特征选择</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/categorical-feature-selection-using-chi-squared-test-e4c0d0af6b7e?source=collection_archive---------2-----------------------#2020-12-18">https://medium.com/analytics-vidhya/categorical-feature-selection-using-chi-squared-test-e4c0d0af6b7e?source=collection_archive---------2-----------------------#2020-12-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0201" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么是相关性？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7f8b35996c457702ba2e811d804a2cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OZVtaAu6Ext0tlU_.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae jt" href="https://www.google.com/search?q=character&amp;tbm=isch&amp;ved=2ahUKEwi8nKuokNjtAhXHASsKHSw_BJ4Q2-cCegQIABAA&amp;oq=character&amp;gs_lcp=CgNpbWcQAzIECCMQJzIFCAAQsQMyBAgAEAMyCAgAELEDEIMBMggIABCxAxCDATIFCAAQsQMyBQgAELEDMgUIABCxAzIFCAAQsQMyBQgAELEDOgQIABBDOgIIAFCUE1iZPmC6P2gAcAB4AIAB0QGIAewUkgEGMC4xNy4xmAEAoAEBqgELZ3dzLXdpei1pbWfAAQE&amp;sclient=img&amp;ei=hfDcX_zFBceDrAGs_pDwCQ&amp;bih=625&amp;biw=1366#imgrc=OCpB5dLHG0KxSM" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="3212" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关性定义了两个或多个特征之间的相互关系。假设你想买一所房子，房地产商给你看了一些房子，你观察到房价随着房子面积的增加而增加。在这里，房子的大小与价格密切相关。</p><p id="fde5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设你是一名玩家，白领工作出现了巨大的衰退。这次衰退不会影响你的收入，因为白领工作的衰退与你的职业无关。在这种情况下，两个特征之间没有任何关联。</p><p id="18c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在卡方检验中，我们使用p值来决定一个特征是否与目标变量相关。</p><p id="bd86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">H0 :-分类特征和目标变量之间没有关系</p><p id="fd97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">H1:范畴特征和目标变量之间存在某种关系</p><p id="8e9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果<strong class="ih hj"> p值≥0.05 </strong>，未能拒绝零假设，则目标变量和分类特征之间没有任何关系。</p><p id="0c34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果<strong class="ih hj"> p_value &lt; 0.05 </strong>，拒绝零假设，目标变量和分类特征之间将会有一些关系，我们将会把所有这些特征用于进一步的机器学习管道。让我们开始吧……</p><p id="99f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi ju translated"><span class="l jv jw jx bm jy jz ka kb kc di"> N </span>注:-卡方检验只适用于离散的目标变量。如果目标变量是连续的，那么我们应该先做宁滨，然后再做卡方检验。</p><h2 id="6955" class="kd ke hi bd kf kg kh ki kj kk kl km kn iq ko kp kq iu kr ks kt iy ku kv kw kx bi translated">步骤1:获取数据集并导入所有必要的库</h2><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="9351" class="kd ke hi kz b fi ld le l lf lg">#importing all the essential library<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt <br/>import seaborn as sns<br/>from sklearn.feature_selection import chi2<br/>from sklearn.model_selection import train_test_split<br/>--------------------------------------------------------------------<br/>df=pd.read_csv(""<a class="ae jt" href="https://raw.githubusercontent.com/srivatsan88/YouTubeLI/master/dataset/churn_data_st.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/srivatsan88/YouTubeLI/master/dataset/churn_data_st.csv</a>",sep=",")<br/>df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/07a99791964267b6b40619b179e98a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mgyLIsUkrgjrO3FhlW6CxQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">数据集的前五行</figcaption></figure><h2 id="cb71" class="kd ke hi bd kf kg kh ki kj kk kl km kn iq ko kp kq iu kr ks kt iy ku kv kw kx bi translated">步骤2:特征编码</h2><p id="87b8" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">a.首先，我们将提取所有具有分类变量的特征。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="3b50" class="kd ke hi kz b fi ld le l lf lg">df.dtypes</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ln"><img src="../Images/944eb4fc7bfbfa7af3db6f5e7ccbffd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*-6CkdXg037cH8axlSIH7kw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图1</figcaption></figure><p id="cfad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将删除customerID，因为它对目标变量没有影响。</p><p id="3eee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b.提取所有具有分类变量的特征，然后对它们进行特征编码。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="2e3d" class="kd ke hi kz b fi ld le l lf lg">cat_df["gender"]=cat_df["gender"].map({"Female":1,"Male":0})<br/>cat_df["Contract"]=cat_df["Contract"].map({'Month-to-month':0, 'One year':1, 'Two year':2})<br/>cat_df["PaperlessBilling"]=cat_df["PaperlessBilling"].map({"Yes":0,"No":1})<br/>cat_df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lo"><img src="../Images/ecec11cf00f2805d9e4c0f9659bc42ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*UzQrwllOHannhRClbvmkyw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">编码输出</figcaption></figure><h2 id="61c2" class="kd ke hi bd kf kg kh ki kj kk kl km kn iq ko kp kq iu kr ks kt iy ku kv kw kx bi translated">步骤3:应用卡方检验</h2><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="fc46" class="kd ke hi kz b fi ld le l lf lg">x=cat_df.iloc[:,:-1]  #Independent variable<br/>y=cat_df.iloc[:,-1]   #Target variable<br/>f_score=chi2(x,y)   #returns f score and p value <br/>f_score</span><span id="c216" class="kd ke hi kz b fi lp le l lf lg">[out] &gt;&gt; (array([2.63667886e-01, 1.11578017e+03, 1.53480111e+02]),<br/> array([6.07611392e-001, 1.22794132e-244, 3.00847449e-035]))<br/>--------------------------------------------------------------------<br/># printing p values for each categorical features<br/>p_value=pd.Series(f_score[1],index=x.columns)<br/>p_value.sort_values(ascending=True,inplace=True)</span><span id="71bb" class="kd ke hi kz b fi lp le l lf lg">[out] &gt;&gt;Contract            1.227941e-244<br/>        PaperlessBilling     3.008474e-35<br/>        gender               6.076114e-01<br/>        dtype: float64</span></pre><p id="1d67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们借助可视化来理解p_value。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="e34a" class="kd ke hi kz b fi ld le l lf lg">p_value.plot(kind="bar")<br/>plt.xlabel("Features",fontsize=20)<br/>plt.ylabel("p_values",fontsize=20)<br/>plt.title("chi squared test base on p value")<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/0ab03073fa99af1a3f7aef8ae734d02a.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*TJvb-58TGOFZHr5yIW3hQg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图2</figcaption></figure><p id="7e0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们看到上面的图，我们可以得出结论:<strong class="ih hj">性别</strong>特征的p_value约等于0.6，意味着<strong class="ih hj"> p_value &gt; 0.05 </strong>，因此性别对目标变量没有意义。</p><p id="885f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们只选择<strong class="ih hj">合同</strong>和<strong class="ih hj">无纸账单</strong>进行进一步的机器学习建模。</p><p id="055c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi ju translated"><span class="l jv jw jx bm jy jz ka kb kc di"> N </span>注:该技术基于一个假设，即某些数据可能很重要，但卡方检验并未表明在这种情况下，我们的领域知识起着关键作用</p></div></div>    
</body>
</html>