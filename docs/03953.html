<html>
<head>
<title>Joins in Pandas: Master the Different Types of Joins in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pandas中的连接:掌握Python中不同类型的连接</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/joins-in-pandas-master-the-different-types-of-joins-in-python-26c1d2509b1e?source=collection_archive---------7-----------------------#2020-02-27">https://medium.com/analytics-vidhya/joins-in-pandas-master-the-different-types-of-joins-in-python-26c1d2509b1e?source=collection_archive---------7-----------------------#2020-02-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a2f77bcb949ba26cd1f3a0b82ec7b274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HM9L_Qx5xZA2g2aGTWOj1A.jpeg"/></div></div></figure><h1 id="a62f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">熊猫加入简介</h1><blockquote class="jo"><p id="3384" class="jp jq hi bd jr js jt ju jv jw jx jy dx translated">“我在Python中有两个不同的表，但我不知道如何连接它们。我应该考虑什么标准？我可以用哪些不同的方法来连接这些表？”</p></blockquote><p id="4333" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw jy hb bi translated">听起来熟悉吗？我在网上论坛上多次遇到这个问题。使用一个表相当简单，但是当数据分布在两个或更多的表中时，事情就变得很有挑战性了。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/823de19832f3b813de35a9206bc9357c.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*DC8-3QyJNIhBpqgA.png"/></div></figure><p id="a4d2" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">这就是联接概念的由来。我不能强调我在<a class="ae lh" href="https://courses.analyticsvidhya.com/courses/pandas-for-data-analysis-in-python?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">熊猫</a>中使用这些连接的次数！在<a class="ae lh" href="http://datahack.analyticsvidhya.com/?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">数据科学黑客马拉松</a>期间，当我需要快速连接多个表时，它们特别有用。</p><p id="3985" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">我们将在这里了解Pandas中不同类型的连接:</p><ul class=""><li id="a3c4" class="li lj hi kc b kd lc kh ld kl lk kp ll kt lm jy ln lo lp lq bi translated">熊猫的内心世界</li><li id="f433" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated">熊猫的全面加入</li><li id="8acd" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated">左边加入熊猫</li><li id="6a67" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated">加入熊猫吧</li></ul><p id="13ba" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">我们还将讨论如何在Pandas中使用连接来处理冗余或重复值。我们开始吧！</p><p id="15e5" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated"><em class="lw">注意:如果你是熊猫和Python世界的新手，我推荐你参加下面的免费课程:</em></p><ul class=""><li id="2884" class="li lj hi kc b kd lc kh ld kl lk kp ll kt lm jy ln lo lp lq bi translated"><a class="ae lh" href="https://courses.analyticsvidhya.com/courses/pandas-for-data-analysis-in-python?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank"> <em class="lw">用Python进行数据分析的熊猫</em> </a></li><li id="e1b1" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated"><a class="ae lh" href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank"> <em class="lw">用于数据科学的Python</em></a></li></ul><p id="ca9a" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated"><em class="lw">想学习SQL连接吗？我们掩护你！</em> <a class="ae lh" href="https://www.analyticsvidhya.com/blog/2020/02/understanding-sql-joins/?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank"> <em class="lw">在这里头学习所有关于SQL的知识</em> </a> <em class="lw">。</em></p><h1 id="df62" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">理解问题陈述</h1><p id="d6ea" class="pw-post-body-paragraph ka kb hi kc b kd lx kf kg kh ly kj kk kl lz kn ko kp ma kr ks kt mb kv kw jy hb bi translated">我相信你现在对亚马逊和Flipkart这样的电子商务网站非常熟悉。当我们访问不相关的网站时，我们会被他们的广告轰炸——这就是定向营销的力量！</p><p id="cb8a" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">这里我们就拿一个相关营销品牌的简单问题来说。我们有两个表——一个包含关于产品的数据，另一个包含客户级别的信息。</p><p id="200e" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">我们将使用这些表来理解不同类型的连接如何使用Pandas工作。</p><h1 id="f674" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">熊猫的内心世界</h1><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/a13534e6a98f43b33ceca5a94d8ab4e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*7d3gQZXg4ebp9nHW.png"/></div></div></figure><blockquote class="jo"><p id="85f3" class="jp jq hi bd jr js mc md me mf mg jy dx translated">“内部联接是您将使用的最常见的联接类型。它返回的数据帧只包含那些具有共同特征的行。</p></blockquote><p id="bb6c" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw jy hb bi translated">内部联接要求两个联接的数据框架中的每一行都具有匹配的列值。这类似于两个集合的<strong class="kc hj">交集</strong>。</p><p id="59e6" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">先从导入<a class="ae lh" href="https://courses.analyticsvidhya.com/courses/pandas-for-data-analysis-in-python?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">熊猫馆</a>开始:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="808b" class="mm ir hi mi b fi mn mo l mp mq">import pandas as pd</span></pre><p id="6a06" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">对于本教程，我们有两个数据框架——产品和客户。产品数据框架包含产品细节，如<em class="lw">产品ID、产品名称、类别、价格和卖家城市</em>。客户数据帧包含详细信息，如<em class="lw"> id、姓名、年龄、产品id、购买的产品和城市</em>。</p><p id="8a72" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">我们的任务是运用我们的加入技巧，从数据中产生有意义的信息。我鼓励您遵循我们将在本教程中介绍的代码。</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="217c" class="mm ir hi mi b fi mn mo l mp mq">product=pd.DataFrame({ 'Product_ID':[101,102,103,104,105,106,107], 'Product_name':['Watch','Bag','Shoes','Smartphone','Books','Oil','Laptop'], 'Category':['Fashion','Fashion','Fashion','Electronics','Study','Grocery','Electronics'], 'Price':[299.0,1350.50,2999.0,14999.0,145.0,110.0,79999.0], 'Seller_City':['Delhi','Mumbai','Chennai','Kolkata','Delhi','Chennai','Bengalore'] })</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/9d808bc3a5cb1baa257eff431c687f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/0*09Mzk9tx4vyQpBMp.png"/></div></figure><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="4263" class="mm ir hi mi b fi mn mo l mp mq">customer=pd.DataFrame({ 'id':[1,2,3,4,5,6,7,8,9], 'name':['Olivia','Aditya','Cory','Isabell','Dominic','Tyler','Samuel','Daniel','Jeremy'], 'age':[20,25,15,10,30,65,35,18,23], 'Product_ID':[101,0,106,0,103,104,0,0,107], 'Purchased_Product':['Watch','NA','Oil','NA','Shoes','Smartphone','NA','NA','Laptop'], 'City':['Mumbai','Delhi','Bangalore','Chennai','Chennai','Delhi','Kolkata','Delhi','Mumbai'] })</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/7a0431f4ad6d3440e7efdc1c3bad285b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/0*C2tstMZfVBzPJV4r.png"/></div></figure><p id="e793" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">假设我们想知道所有在线销售的产品以及谁购买了它们。我们可以使用内部连接轻松实现这一点。</p><p id="6e70" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">熊猫里的<strong class="kc hj"> merge() </strong>函数就是我们这里的朋友。默认情况下，merge函数执行内部联接。它既接受数据帧作为参数，也接受必须执行连接的列的名称:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="2c82" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product,customer,on='Product_ID')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/29bc291c580216aa737eb138510ea8ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PJvKZFPGPuzY6drc.png"/></div></div></figure><p id="be1b" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">这里，我对“Product_ID”列上的产品和客户数据帧执行了内部连接。</p><p id="858d" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">但是，如果两个数据帧中的列名不同呢？然后，我们必须明确地提到这两个列名。</p><p id="a899" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">“left_on”和“right_on”是我们可以实现这一点的两个参数。“left_on”是左侧数据帧中的键名，而“right_on”是右侧数据帧中的键名:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="eef4" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product,customer,left_on='Product_name',right_on='Purchased_Product')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/028b6db804f8629f50349cc0515c82c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZdCWA-z94VGKDB3_.png"/></div></div></figure><p id="7a64" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">让我们更上一层楼。领导团队现在想要更多关于销售产品的细节。<em class="lw">他们想了解卖家销售给同一城市的所有产品，即卖家和客户都属于同一城市。</em></p><p id="8753" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">在这种情况下，我们必须对产品的<em class="lw"> Product_ID </em>和<em class="lw"> Seller_City </em>以及客户数据框架的<em class="lw"> Product_ID </em>和<em class="lw"> City </em>列执行内部连接。</p><p id="7568" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">那么，我们该怎么做呢？</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/fddb148709005c05efffd0c94f0a69eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*bzrPAkP2rEWtU3W7.png"/></div></figure><p id="9962" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">不要挠头！只需将列名数组传递给<strong class="kc hj"> left_on </strong>和<strong class="kc hj"> right_on </strong>参数:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="ac87" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product,customer,how='inner',left_on=['Product_ID','Seller_City'],right_on=['Product_ID','City'])</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/a418449bc1fe019bf6abe4b45ed3d623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CrNh_WjQOY3QD1_S.png"/></div></div></figure><h1 id="e144" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">熊猫的全面加入</h1><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/7d72517abe05662d33ffcdb687c73430.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*0ZF8ZECW8MUII2O4.png"/></div></figure><p id="6991" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">这是给你的另一个有趣的任务。我们必须将两个数据框架结合起来，这样我们就可以找到所有未售出的产品和所有没有从我们这里购买任何东西的客户。</p><p id="f702" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">为此，我们可以使用完全连接。</p><blockquote class="jo"><p id="b563" class="jp jq hi bd jr js jt ju jv jw jx jy dx translated">"全联接，也称为全外联接，返回在左数据帧或右数据帧中匹配的所有记录。"</p></blockquote><p id="3343" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw jy hb bi translated">当两个数据帧中的行不匹配时，对于缺少匹配行的数据帧的每一列，结果数据帧将具有NaN。</p><p id="4293" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">我们可以通过将<strong class="kc hj"> how </strong>参数作为<strong class="kc hj">‘外部’</strong>传递给<strong class="kc hj"> merge() </strong>函数来执行完全连接:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="409a" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product,customer,on='Product_ID',how='outer')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/d674ae460f8a774304af117e98e0204c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FF4zBDphWzTu3JeU.png"/></div></div></figure><p id="5c24" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">你注意到这里发生了什么吗？两个数据帧的所有不匹配的行对于其他数据帧的列都具有NaN值。但是等等——我们仍然不知道哪一行属于哪一个数据帧。</p><p id="672a" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">对此，熊猫为我们提供了一个绝妙的解决方案。我们只需在函数中将<strong class="kc hj">指示符</strong>参数作为<strong class="kc hj"> True </strong>来提及，一个名为<strong class="kc hj"> _merge </strong>的新列将在结果数据帧中创建:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="e611" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product,customer,on='Product_ID',how='outer',indicator=True)</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/19fcf83e0c03b525d99fe48ed4c44f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LIeMy3EQaBb9pRw7.png"/></div></div></figure><p id="b61c" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">如您所见，<strong class="kc hj"> _merge </strong>列提到了哪一行属于哪一个数据帧。</p><h1 id="fca8" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">左边加入熊猫</h1><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/d15c21b3e190c8ed3f804e650f89f547.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*4knrLPCjKOVgLkyx.png"/></div></figure><p id="1f24" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">现在，假设领导团队只想要那些从我们这里买东西的客户的信息。你猜对了——我们可以在这里使用左连接的概念。</p><blockquote class="jo"><p id="063f" class="jp jq hi bd jr js jt ju jv jw jx jy dx translated"><em class="jz">“左连接，也称为左外连接，返回包含左数据帧所有行的数据帧。”</em></p></blockquote><p id="c39b" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw jy hb bi translated">左侧数据帧的所有非匹配行都包含用于右侧数据帧中的列的NaN。它只是一个内部连接，加上左数据帧中所有不匹配的行，用NaN填充右数据帧的列。</p><p id="6264" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">执行左连接实际上与全连接非常相似。只需将<strong class="kc hj">如何</strong>论证改为<strong class="kc hj">‘左’</strong>:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="7e43" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product,customer,on='Product_ID',how='left')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/fec16422dbcb5065957948ada9ebd078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hQL1myacIlVBAEIw.png"/></div></div></figure><p id="52df" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">在这里，您可以清楚地看到，对于属于客户数据框架的列，所有未售出的产品都包含NaN。</p><h1 id="81c3" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">加入熊猫吧</h1><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/6205230467750251a73dbdf8ddea904f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*j5X9-ALwPWd_LYYF.png"/></div></figure><p id="8318" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">类似地，如果我们想要创建一个客户表，其中包含他们购买的产品的信息，我们可以使用right join。</p><blockquote class="jo"><p id="3afc" class="jp jq hi bd jr js jt ju jv jw jx jy dx translated"><em class="jz">“右连接，也称为右外连接，类似于左外连接。唯一的区别是，右侧数据帧的所有行都按原样获取，只有左侧数据帧的那些行在两者中是共有的。”</em></p></blockquote><p id="aff3" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw jy hb bi translated">与其他联接类似，我们可以通过将<strong class="kc hj"> how </strong>参数更改为<strong class="kc hj">‘right’</strong>来执行右联接:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="c2b6" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product,customer,on='Product_ID',how='right')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/996f4ee6d46f9e56e1613088a5a5e64a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pj1j_2UYHBCwyiQC.png"/></div></div></figure><p id="c08a" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">仔细看看上面的数据框架——对于产品数据框架的列，我们有NaN值。很简单，对吧？</p><h1 id="7746" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">处理连接中的冗余/重复</h1><p id="5437" class="pw-post-body-paragraph ka kb hi kc b kd lx kf kg kh ly kj kk kl lz kn ko kp ma kr ks kt mb kv kw jy hb bi translated">重复值可能是棘手的障碍。它们会在执行连接时导致问题。这些值不会产生错误，只会在我们得到的数据帧中产生冗余。我相信你可以想象那有多有害！</p><p id="f7bf" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">这里，我们有一个数据框架<strong class="kc hj"> product_dup </strong>，其中包含关于产品的重复细节:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="270d" class="mm ir hi mi b fi mn mo l mp mq">product_dup=pd.DataFrame({ 'Product_ID':[101,102,103,104,105,106,107,103,107], 'Product_name':['Watch','Bag','Shoes','Smartphone','Books','Oil','Laptop','Shoes','Laptop', 'Category':['Fashion','Fashion','Fashion','Electronics','Study','Grocery','Electronics','Fashion','Electronics'], 'Price':[299.0,1350.50,2999.0,14999.0,145.0,110.0,79999.0,2999.0,79999.0], 'Seller_City':['Delhi','Mumbai','Chennai','Kolkata','Delhi','Chennai','Bengalore','Chennai','Bengalore'] })</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/c0aeefa0ef750781e7148ae2be06de82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/0*RyuwPWYbV3cDXUkO.png"/></div></figure><p id="21cf" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">让我们看看，如果对该数据帧执行内部连接会发生什么:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="ffac" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product_dup,customer,how='inner',on='Product_ID')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/8480e8e82f06fa9e55369a80f1f23e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NA7sy4dmpvJBT_PG.png"/></div></div></figure><p id="13ee" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">如您所见，我们在结果数据集中也有重复的行。为了解决这个问题，在<strong class="kc hj"> merge() </strong>函数中有一个<strong class="kc hj"> validate </strong>参数，我们可以设置为<strong class="kc hj">'一对一'，【一对多'，【多对一'，</strong>和<strong class="kc hj">'多对多'</strong>。</p><p id="69a6" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">这确保了在两个数据帧之间只存在特定的映射。如果不满足映射条件，那么它抛出一个<strong class="kc hj"> MergeError </strong>。为了解决这个问题，我们可以在应用join之前删除重复项:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="5727" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product_dup.drop_duplicates(),customer,how='inner',on='Product_ID')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/7348b72c94cea194954b9f2de7470ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2JK9TAMKGmL6USvp.png"/></div></div></figure><p id="16ff" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">但是，如果您想保留这些副本，那么您可以根据您的要求给<strong class="kc hj"> validate </strong>值，它不会抛出错误:</p><pre class="ky kz la lb fd mh mi mj mk aw ml bi"><span id="805f" class="mm ir hi mi b fi mn mo l mp mq">pd.merge(product_dup,customer,how='inner',on='Product_ID',validate='many_to_many')</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/e6fc3c64918939b658379cc963a85804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5jZ3hAX8IYGlTYlF.png"/></div></div></figure><p id="3eb4" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">现在，你可以说:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/361d05de12f469e09799315c56767020.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/0*md-_Vp-h_WbmEE1R.png"/></div></figure><h1 id="a497" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">下一步是什么？</h1><p id="4309" class="pw-post-body-paragraph ka kb hi kc b kd lx kf kg kh ly kj kk kl lz kn ko kp ma kr ks kt mb kv kw jy hb bi translated">Pandas中还有一个<strong class="kc hj"> concat() </strong>函数，我们可以用它来连接两个数据帧。我鼓励你探索这一点，并在你的下一个项目中应用它，以及你在本教程中学到的关于连接的知识。</p><p id="c639" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">如果您对本文有任何疑问或反馈，请在下面的评论区分享。我在下面列出了一些与数据科学和Python相关的见解深刻、内容全面的文章和课程。</p><p id="236d" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated"><strong class="kc hj">课程:</strong></p><ul class=""><li id="48a0" class="li lj hi kc b kd lc kh ld kl lk kp ll kt lm jy ln lo lp lq bi translated"><a class="ae lh" href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">面向数据科学的Python</a></li><li id="f9fe" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated"><a class="ae lh" href="https://courses.analyticsvidhya.com/courses/pandas-for-data-analysis-in-python?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">用Python进行数据分析的熊猫</a></li><li id="c202" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated"><a class="ae lh" href="https://courses.analyticsvidhya.com/courses/data-science-hacks-tips-and-tricks?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">数据科学的诀窍、技巧和诀窍</a></li><li id="fca9" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated"><a class="ae lh" href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science-2?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">数据科学简介</a></li><li id="8e8b" class="li lj hi kc b kd lr kh ls kl lt kp lu kt lv jy ln lo lp lq bi translated"><a class="ae lh" href="https://courses.analyticsvidhya.com/courses/a-comprehensive-learning-path-to-become-a-data-scientist-in-2020?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">2020年成为数据科学家的综合学习路径</a></li></ul><p id="9de5" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated"><strong class="kc hj">教程:</strong></p><ul class=""><li id="f1e1" class="li lj hi kc b kd lc kh ld kl lk kp ll kt lm jy ln lo lp lq bi translated"><a class="ae lh" href="https://www.analyticsvidhya.com/blog/2016/01/12-pandas-techniques-python-data-manipulation/?utm_source=blog&amp;utm_medium=joins-in-pandas-master-the-different-types-of-joins-in-python" rel="noopener ugc nofollow" target="_blank">Python中用于数据操作的12种有用的Pandas技术</a></li></ul><p id="bfff" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated">你也可以在分析Vidhya的Android应用上阅读这篇文章</p></div><div class="ab cl nd ne gp nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="hb hc hd he hf"><p id="1e0b" class="pw-post-body-paragraph ka kb hi kc b kd lc kf kg kh ld kj kk kl le kn ko kp lf kr ks kt lg kv kw jy hb bi translated"><em class="lw">原载于2020年2月27日</em><a class="ae lh" href="https://www.analyticsvidhya.com/blog/2020/02/joins-in-pandas-master-the-different-types-of-joins-in-python/" rel="noopener ugc nofollow" target="_blank"><em class="lw">【https://www.analyticsvidhya.com】</em></a><em class="lw">。</em></p></div></div>    
</body>
</html>