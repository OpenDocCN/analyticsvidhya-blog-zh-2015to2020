<html>
<head>
<title>Practical ML Part 2: NLP on Amazon Alexa Reviews</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实用 ML 第 2 部分:亚马逊 Alexa 评论的 NLP</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/practical-ml-part-2-nlp-on-amazon-alexa-reviews-4b0b3a15f4bf?source=collection_archive---------10-----------------------#2020-12-12">https://medium.com/analytics-vidhya/practical-ml-part-2-nlp-on-amazon-alexa-reviews-4b0b3a15f4bf?source=collection_archive---------10-----------------------#2020-12-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7dbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用 NLP 技术评估客户评论的项目</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1e19f3a1115a227251553a9749a87e93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2EGhmTsdlmQTkPg9NJRtag.png"/></div></div></figure><p id="654c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我将实现机器学习模型以将通过参加机器学习课程获得的知识付诸实践的系列文章的第二篇。你可以在这里找到这个系列的第一篇文章。</p><p id="b6c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章中显示的研究数据集可以在这个<a class="ae jp" href="https://www.kaggle.com/sid321axn/amazon-alexa-reviews" rel="noopener ugc nofollow" target="_blank">链接</a>上找到。这份分析的完整笔记可以在<a class="ae jp" href="https://www.kaggle.com/marianaalm/nlpfromamazonalexa" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="940e" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">1 —了解数据</h1><p id="d5d5" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">正在加载数据集:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/14bfdd47365b1a09b62b1fadf4422775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*CqTtmlXINVUUDnHGA8JP1g.jpeg"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/1b2e50791bb2c00ab11d948a227058df.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*_YP5Unr_V1-9DamjkwBOWg.jpeg"/></div></figure><p id="5e1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 3150 条评论中，我们要考虑 5 个变量。</p><ul class=""><li id="48be" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">客户在点评上给出的<strong class="ih hj">评分</strong>，是 1 到 5 之间的整数。</li><li id="76ed" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">评审的<strong class="ih hj">日期</strong>，一个将被进一步转换成 datetime 的对象。</li><li id="0966" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated"><strong class="ih hj">产品的变化</strong>，这是区别产品型号的特征。</li><li id="d2f0" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">评论的全文(<strong class="ih hj">核实评论</strong>)。</li></ul><p id="664b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数评论都是正面的，包括:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/b6eb99513c2f79154faf2729b9629765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*3frYQtJHsa-Sx13Xlpi-og.jpeg"/></div></figure><p id="74f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个数据集的统计数据:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lk"><img src="../Images/65a2a5161aae5879e9777e10f703c780.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*lRJqP2NpSgzKgBKinafQsA.jpeg"/></div></figure><p id="a168" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正面评价数据集的统计数据:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ll"><img src="../Images/f162924e4afd529ff19d3c8676938969.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*XrAupHWxx2-PL3p0QAU-Fw.jpeg"/></div></figure><p id="68e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">负面评论数据集的统计数据:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/9839ce9c7386f12cc13db53bfe69fddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*W-acYnGTY3e5V7RFa6CReA.jpeg"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/756d832bf69024024c7ef6b103b687c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dn9Dxx39H4E__7HikXY2Pg.png"/></div></div></figure><p id="e31b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这一初步分析中，我们可以推断:</p><ul class=""><li id="a4d2" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">从 3 到 5 的评级被分类为正面评价，从 1 到 2 的评级被分类为负面评价</li><li id="19cf" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">亚马逊 Alexa 总体上有非常好的评论，被归类为积极的 91.8%(2893 条评论)。</li><li id="6119" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">评论中普遍存在等于 5 的评级。</li></ul><h1 id="29de" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak"> 2 —分析评论中的文本</strong></h1><p id="d5ea" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">角色越多，我们就有越多的词来进行情感分析。一般来说，越长的评论越准确，因为顾客详细解释了他给出的评级。因此，检查评论在我们的数据集中有多长时间是很重要的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lo"><img src="../Images/3c3dc9b502d17818c0ddf6a37be76bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*sZRYDBctmWomrX08PfL9nQ.jpeg"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lp"><img src="../Images/c8b2cd65039998afe192d8feb7033056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vliLcfWvYz3lzgWDFxWgVg.png"/></div></div></figure><p id="ab80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将数据集分成两部分，一部分是正面评价(反馈=1)，另一部分是负面评价(反馈= 0)，我们得到以下统计数据，现在是长度信息:</p><p id="af71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正面评价数据集的统计数据:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/73313b6e4f3f5f8a274a395c4d099eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*zTCscRnlyrTo8eemyanXeA.jpeg"/></div></figure><p id="7269" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">负面评论数据集的统计数据:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/d6aa6e8c3ebecfd69ce0db3035ef27c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*3_QzY9PGI939qMRFC6CyBg.jpeg"/></div></figure><p id="4ecd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以得出结论:</p><ul class=""><li id="7623" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">大多数评论都在 300 字左右。</li><li id="698b" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">最短的评论有 1 个字符，最长的评论有 2851 个字符。</li><li id="f5a3" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">平均而言，评论长度为 132 个字符。</li><li id="1715" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">如果评审是正面的或负面的，那么平均来说，评审的长度是不同的。正面评论平均长度为 124 个字符，负面评论平均长度为 215 个字符。</li><li id="1aaa" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">我们可以得出结论，平均来说，对产品不满意的人倾向于写更长的评论。</li></ul><p id="7308" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正面评价更容易写，因为你只能说‘这是一款很棒的产品’，并给出很高的评价。写负面评价时，这个人可能想要解释他或她对产品不满意的原因，这需要一个较长的文本。</p><p id="6a1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">产品的变化会影响评论中给出的评级吗？</strong></p><p id="57d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该产品在该数据集中有 16 种变体:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ls"><img src="../Images/64d3bf32179af3b1d84e15ba86fcae06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*fBMV68QmuBBfjMln14fSWg.jpeg"/></div></figure><p id="ce82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在柱状图中绘制评分的变化，我们可以检查产品的变化是否会影响评论:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/3bae20c52cb67ab0aed5dc731f89be8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6HClXuE3diFi8vKXTjLUzA.png"/></div></div></figure><p id="6a01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有变化的平均评分都高于 4 分，因此我们可以得出结论，变化不会影响客户对产品的满意度。</p><h1 id="d033" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">3 —转换数据和清理</h1><p id="b4be" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated"><strong class="ih hj">检查待处理数据的大小</strong></p><p id="291c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将评论中的所有句子连接到一个单独的对象中，我们得到一个包含 419，105 个字符的结果对象。</p><p id="9edd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这些字符中:</p><ul class=""><li id="6ae1" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">363，531 个字符在正面评论中(86.7%)</li><li id="0248" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">55，573 个角色在负面评论中(13.3%)</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/b42a020cd9de3d80eb4dbc327a5d99b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inSFOU1E5HCaqF7zaZqU4g.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">清理数据前的 Wordcloud</figcaption></figure><p id="fa0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在单词云中，数据集中最重要的单词(即出现频率较高的单词)以较大的字符表示，与它们在数据中的频率成比例。这是一种应该小心使用的快速可视化技术。单词云不应该是 NLP 研究的唯一结果，而是可视化信息的一种方式。</p><p id="2e73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">清洗和转换数据集</strong></p><p id="e660" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的分析将考虑评论中的词和反馈分类(正面-1 或负面-0)。其他栏将被删除(日期、评分和评论长度)。生成的数据帧如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/6481eb8226c919b1d70840b194c58537.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*9SC-0Bch8PQllbHmxWvMgg.jpeg"/></div></figure><p id="633f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于机器学习模型，必须处理“变化”列。使用一个热编码，我们有以下 numpy 数组:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="4200" class="mf jr hi mb b fi mg mh l mi mj">X_cat = reviews[['variation']]<br/>onehotencoder = OneHotEncoder()<br/>X_cat = onehotencoder.fit_transform(X_cat).toarray()</span><span id="af5f" class="mf jr hi mb b fi mk mh l mi mj">X_cat.shape</span><span id="0cc4" class="mf jr hi mb b fi mk mh l mi mj">(3150, 16)</span></pre><p id="62a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们有一个包含 16 列(产品的不同变体)和 3150 行的 X 矩阵。</p><p id="074b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来的步骤是将 X 矩阵转换为数据框，并将其与仅包含已验证评论的原始数据集连接起来:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/fd5c6a139c0c63eb7e1180aa321e4d94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k75mILftUgpjyxs6cT3y2g.jpeg"/></div></div></figure><p id="a0a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">处理已验证的评论栏</strong></p><p id="55b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了清理和准备用于机器学习模型的经验证的评论数据，采取了三个步骤:</p><ul class=""><li id="efba" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">删除标点符号</li><li id="6c47" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">去掉停止字如<em class="mm">是</em>、<em class="mm">是、</em> <em class="mm">什么</em> …</li><li id="2b89" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">标记化，这意味着将文本内容分解成各个部分，这些部分可以是单词、字符或子单词。</li></ul><p id="4463" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">删除标点符号是一个明确的要求，因为计算机理解字符，而标点符号不是执行情感分析的有用信息。</p><p id="846d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">停用词也是不必要的信息，因为它们不表达任何情感。删除停用词也可以缩短处理时间。</p><p id="93b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">标记化是 NLP 中的一个重要步骤，在这个步骤中，数据被转换以供处理。</p><p id="47e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要实现上述过程，必须导入一些库:</p><ul class=""><li id="6b65" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">字符串，用于删除标点符号。</li></ul><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="d23c" class="mf jr hi mb b fi mg mh l mi mj">import string<br/></span><span id="806a" class="mf jr hi mb b fi mk mh l mi mj">string.punctuation</span><span id="e717" class="mf jr hi mb b fi mk mh l mi mj">'!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~'</span></pre><ul class=""><li id="67a9" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">Scikit-learn 的计数矢量器，用于标记数据。</li></ul><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="93f8" class="mf jr hi mb b fi mg mh l mi mj">from sklearn.feature_extraction.text import CountVectorizer</span></pre><ul class=""><li id="2fc2" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">NLTK 用于删除停用词。</li></ul><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="ac8b" class="mf jr hi mb b fi mg mh l mi mj">import nltk<br/>from nltk.corpus import stopwords</span><span id="eb8a" class="mf jr hi mb b fi mk mh l mi mj">print(stopwords.words('english'))</span><span id="e962" class="mf jr hi mb b fi mk mh l mi mj">['i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', "you're", "you've", "you'll", "you'd", 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', "she's", 'her', 'hers', 'herself', 'it', "it's", 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this', 'that', "that'll", 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', "don't", 'should', "should've", 'now', 'd', 'll', 'm', 'o', 're', 've', 'y', 'ain', 'aren', "aren't", 'couldn', "couldn't", 'didn', "didn't", 'doesn', "doesn't", 'hadn', "hadn't", 'hasn', "hasn't", 'haven', "haven't", 'isn', "isn't", 'ma', 'mightn', "mightn't", 'mustn', "mustn't", 'needn', "needn't", 'shan', "shan't", 'shouldn', "shouldn't", 'wasn', "wasn't", 'weren', "weren't", 'won', "won't", 'wouldn', "wouldn't"]</span></pre><p id="c8c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个函数来实现一次删除标点符号和停用词:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="01a2" class="mf jr hi mb b fi mg mh l mi mj">def cleaning(message):<br/>  text = [char for char <strong class="mb hj">in</strong> message if char <strong class="mb hj">not</strong> <strong class="mb hj">in</strong> string.punctuation]<br/>  text = ''.join(text)<br/>  text = [word for word <strong class="mb hj">in</strong> text.split() if word.lower() <strong class="mb hj">not</strong> <strong class="mb hj">in</strong> stopwords.words('english')]<br/>  return text</span><span id="9a17" class="mf jr hi mb b fi mk mh l mi mj">reviews_clean = reviews['verified_reviews'].apply(cleaning)</span></pre><p id="17de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了完成这部分过程，数据将被标记化:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="7bc1" class="mf jr hi mb b fi mg mh l mi mj">vectorizer = CountVectorizer(analyzer=cleaning)</span><span id="7d66" class="mf jr hi mb b fi mk mh l mi mj">reviews_countvectorizer = vectorizer.fit_transform(reviews['verified_reviews'])</span><span id="5181" class="mf jr hi mb b fi mk mh l mi mj">reviews_countvectorizer.shape</span><span id="efec" class="mf jr hi mb b fi mk mh l mi mj">(3150, 5211)</span></pre><p id="bb31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">reviews_countvectorizer 包含标记化后的数据，具有以下维度:3150 行和 5211 列。这些列中的每一列都是从数据中提取的令牌。</p><h1 id="c589" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">4 —为机器学习准备模型</h1><p id="3678" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">现在，可以删除原始数据集中的“已验证的评论”列，从而得到一个具有 3150 行和 17 列(产品的 16 个变体和反馈列)的数据框:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="1312" class="mf jr hi mb b fi mg mh l mi mj">reviews.drop(['verified_reviews'], axis = 1, inplace=True)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mn"><img src="../Images/9efa3b284a8f327edb4eba4581c497e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*MnBOMDhatWjejo7maCuhow.jpeg"/></div></figure><p id="46ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">count_vectorizer 对象也被转换成一个 dataframe，有 3150 行和 5211 列</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="01bc" class="mf jr hi mb b fi mg mh l mi mj">reviews2 = pd.DataFrame(reviews_countvectorizer.toarray())<br/>reviews2</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mo"><img src="../Images/77278d08bdaad9cce004da9a80cb858c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*TcwCdF-38XTY_Vf1zJbXWA.jpeg"/></div></figure><p id="b328" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的模型中，输入(X 矩阵)将是令牌(reviews2 数据集)，输出(y 矩阵，我们想要预测的内容)将是仅包含反馈列的原始数据集:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="56b9" class="mf jr hi mb b fi mg mh l mi mj">X = reviews2</span><span id="f2ed" class="mf jr hi mb b fi mk mh l mi mj">y = reviews['feedback']</span></pre><h1 id="1760" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">5 —训练和评估模型</h1><p id="0ac3" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated"><strong class="ih hj">训练模型</strong></p><p id="7a2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归将用于预测来自审查的反馈。在训练之前，我们必须将数据分成测试集和训练集:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="1881" class="mf jr hi mb b fi mg mh l mi mj">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)</span></pre><p id="2a5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终尝试中考虑的测试规模为 20%。第一次尝试考虑 15%的分割，但 20%的结果更好。</p><p id="7d97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，对训练数据实施逻辑回归:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="9e8e" class="mf jr hi mb b fi mg mh l mi mj">logistic = LogisticRegression()<br/>logistic.fit(X_train, y_train)</span></pre><p id="b661" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">评估模型</strong></p><p id="948c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了进行评估，导入了一些 scikit-learn 模块:</p><ul class=""><li id="0f52" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">分类报告，显示模型的精度、召回率、f1 值和支持度。</li><li id="1b3a" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">准确性分数，给出正确预测的数量占模型做出的所有预测的比率。</li><li id="89cb" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">混淆矩阵，用于说明模型的准确性，显示每个标签的正确和错误预测。</li></ul><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="a331" class="mf jr hi mb b fi mg mh l mi mj">accuracy_score(y_test, y_pred)</span><span id="5d04" class="mf jr hi mb b fi mk mh l mi mj">0.946031746031746</span></pre><p id="0b92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型的准确率几乎达到 95%，这是一个很好的总体结果。现在，分析分类报告:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="d8b6" class="mf jr hi mb b fi mg mh l mi mj">print(classification_report(y_test, y_pred))</span><span id="b660" class="mf jr hi mb b fi mk mh l mi mj">precision    recall  f1-score   support<br/><br/>           0       0.89      0.33      0.48        48<br/>           1       0.95      1.00      0.97       582<br/><br/>    accuracy                           0.95       630<br/>   macro avg       0.92      0.66      0.73       630<br/>weighted avg       0.94      0.95      0.93       630</span></pre><p id="03da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显示的每个信息具有以下含义:</p><ul class=""><li id="2fcc" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated"><strong class="ih hj">精度</strong> —相关结果的百分比。</li><li id="51fc" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated"><strong class="ih hj">召回</strong> —被模型正确分类的相关结果总数的百分比。</li><li id="6215" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated"><strong class="ih hj">f1-得分</strong> —准确率和召回率的加权平均值。</li><li id="52c3" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated"><strong class="ih hj">支持度</strong> —训练集中该类的观测值个数</li></ul><p id="f20d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型在识别负面评论方面有困难——我们可以从类别 0 的召回结果中看到:只有 33%的寄存器被正确估计。我们必须记住，我们正在处理一个非常不平衡的数据集——大多数评论都是积极的评论。</p><p id="4aad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应考虑对此模型进行进一步分析。可以考虑一些处理不平衡数据集的技术。这将在关于这个项目的后续文章中讨论。</p></div></div>    
</body>
</html>