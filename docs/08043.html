<html>
<head>
<title>Confusion Matrix is no more confusing.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混乱矩阵不再混乱。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/confusion-matrix-is-no-more-confusing-890988cf0bf3?source=collection_archive---------25-----------------------#2020-07-15">https://medium.com/analytics-vidhya/confusion-matrix-is-no-more-confusing-890988cf0bf3?source=collection_archive---------25-----------------------#2020-07-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/bf538d4d422172f08c731053d76ba7de.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*eaqiWWODpCrRLRGHCrno0w.jpeg"/></div></figure><p id="6651" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我们进入主题之前，让我们理解为什么我们需要考虑混淆矩阵和度量？</p><p id="2856" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">度量在评估模型的性能中起着重要的作用。</p><p id="7d4d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">来自混淆矩阵的度量。</p><ul class=""><li id="9507" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">混淆矩阵(精确度、召回率、F值、准确度)</li></ul><blockquote class="jt ju jv"><p id="a979" class="im in jw io b ip iq ir is it iu iv iw jx iy iz ja jy jc jd je jz jg jh ji jj hb bi translated">混乱矩阵不再混乱。</p></blockquote><p id="3e42" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">假设一个数据集有两个类，比如A类和b类。可能有两种情况，你的数据集是<strong class="io hj">平衡的</strong>和<strong class="io hj">不平衡的</strong>。平衡数据集意味着，A类和B类的记录是平衡的。假设A类有50%的数据，B类有50%的数据或55–45%的数据。不平衡数据集包含90–10%的A类和B类记录，或者80–20%和70–30%的数据。</p><p id="d52d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">平衡数据集和不平衡数据集要考虑的指标是不同的。</p><p id="905b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">混淆矩阵带有实际的和预测的行和列。使用的术语有真阳性、真阴性、假阳性、假阴性。</p><p id="de71" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们分别把这些词分为正确的和积极的。</p><p id="57bc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正:A类；否定:不是A类(B类)</p><p id="a601" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">真:预言是对的；错误:预测是错误的</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ka"><img src="../Images/23d62d52a81fe540af7e597ff4255a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g6WJb5ekZKng93RgYbLB5Q.jpeg"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">图片来自谷歌。</figcaption></figure><p id="8a1f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">真正</strong> : <strong class="io hj"> <em class="jw">正</em> </strong>:模型预测为A类，<strong class="io hj"> <em class="jw">真</em> </strong>什么模型预测正确。<strong class="io hj">结论为</strong>:实际为A级，模型预测为A级。</p><p id="f1c2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">真阴性</strong> : <strong class="io hj"> <em class="jw">阴性</em> </strong>:模型预测为B类，<strong class="io hj"> <em class="jw">真</em> </strong>什么模型预测正确。</p><p id="7e3a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">结论为:实际为B类，模型预测为B类。</p><p id="df1e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">假阳性(Type-1 Error) </strong> : <strong class="io hj"> <em class="jw">阳性</em> </strong>:模型预测为A类，<strong class="io hj"> <em class="jw">假</em> </strong>什么模型预测错了。<strong class="io hj">结论为</strong>:实际为B级，模型预测为a级。</p><p id="0008" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">假阴性(Type-2 Error) </strong> : <strong class="io hj"> <em class="jw">阴性</em> </strong>:模型预测为B类，<strong class="io hj"> <em class="jw">假:</em> </strong>什么模型预测错了。<strong class="io hj">结论为</strong>:实际为A级，模型预测为b级。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/ab844afbb8f46aea680127c916f5c2f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*jAFG4TZ1_-9oNCscUxzqNA.jpeg"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">图片来自谷歌。</figcaption></figure><ul class=""><li id="6bb8" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">实际值和模型预测值的混淆矩阵以行的形式表示。</li><li id="616a" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">对角线代表真正的积极和真正的消极。</li><li id="6b41" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">FP和FN是第1类和第2类误差，这意味着实际值和预测值之间存在矛盾。</li><li id="3eb8" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">用任何分类或集合模型训练模型。</li><li id="9c00" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">通过model.predict(y_test)预测测试数据集</li><li id="3c97" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">打印混淆矩阵。</li></ul><pre class="kb kc kd ke fd kt ku kv kw aw kx bi"><span id="3740" class="ky kz hi ku b fi la lb l lc ld">import pandas as pd<br/>from sklearn.metrics import confusion_matrix</span><span id="be30" class="ky kz hi ku b fi le lb l lc ld">data = {'y_Actual':    [1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0],<br/>        'y_Predicted': [1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0]<br/>        }</span><span id="bdbd" class="ky kz hi ku b fi le lb l lc ld">df = pd.DataFrame(data, columns=['y_Actual','y_Predicted'])</span><span id="d91e" class="ky kz hi ku b fi le lb l lc ld">confusion_matrix = pd.crosstab(df['y_Actual'], df['y_Predicted'], rownames=['Actual'], colnames=['Predicted'], margins=True)</span><span id="f73d" class="ky kz hi ku b fi le lb l lc ld">print(confusion_matrix)<br/>----------------------------------------------------------<br/>Output:<br/>Predicted  0  1  All<br/>Actual              <br/>0          6  1    7<br/>1          2  3    5<br/>All        8  4   12</span></pre><p id="abe6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">打印分类报告，了解精确度、召回率、F1分数和准确度。</p><pre class="kb kc kd ke fd kt ku kv kw aw kx bi"><span id="685c" class="ky kz hi ku b fi la lb l lc ld">from sklearn.metrics import classification_report</span><span id="38d7" class="ky kz hi ku b fi le lb l lc ld">print("-- Classification Report --\n\n",classification_report(df['y_Actual'], df['y_Predicted']))<br/><strong class="ku hj">----------------------------------------------------------<br/>Output:</strong></span><span id="6ab2" class="ky kz hi ku b fi le lb l lc ld">-- Classification Report --<br/><br/>               precision    recall  f1-score   support<br/><br/>           0       0.75      0.86      0.80         7<br/>           1       0.75      0.60      0.67         5<br/><br/>    accuracy                           0.75        12<br/>   macro avg       0.75      0.73      0.73        12<br/>weighted avg       0.75      0.75      0.74        12</span></pre><p id="f54f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">让我们来看看结果:</strong></p><p id="5d86" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如前所述，对角线是TP和TN</p><p id="8a6e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> TP </strong>:实际为0，模型预测为0，满足值6，模型预测8条记录为0。在8个记录中，有6个被正确预测。</p><p id="0781" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> TN </strong>:实际为1，模型预测为满足值3的1，模型预测为1的4条记录。在4条记录中，有3条被正确预测。</p><p id="3dff" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看类型1和类型2错误:</p><p id="77fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> FP </strong>:预测为0，实际为1，满足值2。</p><p id="880d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> FN </strong>:预测为1但实际为0，满足值1。</p><p id="2f65" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">TP = 6；TN = 3；FP = 2；FN = 1</p><p id="449d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi lf translated"><span class="l lg lh li bm lj lk ll lm ln di">如果</span>混淆矩阵没有让你混淆，我们可以继续。从CM中，我们将了解精确度、召回率、F值、准确度等指标。</p><p id="53e8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">准确率</strong>是从整体预测记录(总记录)来看，有多少预测是实际正确的(TP+TN)。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/a6f6d8d0c38d99bd7a50f4d7e064af4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*5HpbwDmGxlOKJntrfLAZiA.png"/></div></figure><p id="6fe3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">精确度= (6+3)/(6+3+2+1)</p><p id="c6f1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果准确率超过90%，一定要怀疑你的数据集。检查数据集是平衡的还是不平衡的。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/b7e8ed07b4be80010fb970413d9fc555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*RRToWiqx3hhihG1qgf0wAA.jpeg"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">图片来自谷歌。</figcaption></figure><p id="7bb2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">精度</strong>:从模型预测的，实际正确的有多少。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/a3d0425a07e33ec943cef3e67ace91ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*dph-13h89w_TDLjrfqpFcw.png"/></div></figure><p id="eef5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">0 = 6/(6+2)的精度</p><p id="dcbb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">1 = 3/(3+1)的精度</p><p id="a621" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">回忆</strong>:从整体实际记录来看，有多少预测是正确的。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/327058c7f7e869b5fe747c595959a981.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*dH3ZjGXeyummfGy8oSGg9A.png"/></div></figure><p id="9edb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">回忆0 = 6/(6+1)</p><p id="44d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">回忆1 = 3/(3+2)</p><p id="d4d2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> F-Beta评分</strong>是FP和FN起重要作用。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/860e8d8303458ef652e6e1174bbf9de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*bDYSaOU1-_cLSfLoTVrG7Q.png"/></div></figure><p id="74a7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">β值的范围可以从0到任何数字，取决于FP和FN的重要性。</p><ul class=""><li id="20e5" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">当FP和FN同等重要时，设β=1，则表示<br/> F1得分。</li><li id="a77c" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">当FP比FN重要时，设β=0.5，则说F0.5分。</li><li id="2183" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">当FN比FP重要时，设β=2，则F2得分。</li></ul><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/31236f268de9c9dcf3550b54c7abd9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*RM_ccpY8aRB1uUCYtQn_uw.jpeg"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">图片来自谷歌。</figcaption></figure><blockquote class="jt ju jv"><p id="40e3" class="im in jw io b ip iq ir is it iu iv iw jx iy iz ja jy jc jd je jz jg jh ji jj hb bi translated">如果数据集包含高度不平衡的类。永远不要追求准确性。假设您的模型将95–5%的数据分为A类和b类。模型可能会将98%的数据预测为A类，此时准确率将达到97%。对于b类，你只能得到2 %的正确预测数据。</p><p id="195a" class="im in jw io b ip iq ir is it iu iv iw jx iy iz ja jy jc jd je jz jg jh ji jj hb bi translated"><strong class="io hj">寻找精度，对于不平衡数据集主要召回F分。</strong></p></blockquote><p id="de95" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">点击了解更多关于<a class="ae lt" rel="noopener" href="/analytics-vidhya/how-to-handle-imbalanced-dataset-b3dc05b85bf9">如何处理不平衡数据集</a>？</p><blockquote class="jt ju jv"><p id="8a96" class="im in jw io b ip iq ir is it iu iv iw jx iy iz ja jy jc jd je jz jg jh ji jj hb bi translated">简单的技巧，记住什么精度和回忆。</p></blockquote><ul class=""><li id="a2bf" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">精度:以字母<strong class="io hj"> P </strong>开头，那么，在<strong class="io hj"> P </strong>预测的记录中，有多少是正确的。回忆:与精确相对。从总体A类来看，有多少是正确的。</li><li id="010c" class="jk jl hi io b ip ko it kp ix kq jb kr jf ks jj jp jq jr js bi translated">你列了一张清单，上面有10样东西要去商店买。但是当你走进商店，却忘记了购物清单，结果只买了7样东西。</li></ul><p id="e798" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">精确度是:在买的7样东西中，有哪些东西符合你的清单。回忆是从10件物品中选出的，你买了哪些相匹配的物品。</p><blockquote class="jt ju jv"><p id="e8d9" class="im in jw io b ip iq ir is it iu iv iw jx iy iz ja jy jc jd je jz jg jh ji jj hb bi translated">什么时候精度优先于召回，反之亦然？</p></blockquote><p id="fdd3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这取决于业务用例。</p><p id="d103" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">当存在与假阴性相关的<strong class="io hj">高成本时，即当肿瘤实际上为恶性时系统预测为良性时，召回应优于精确度</strong>。</strong></p><p id="bba5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当存在与误报(即垃圾邮件检测)相关联的<strong class="io hj">高成本时，<strong class="io hj">精度应优于召回</strong>。</strong></p><p id="b02b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢阅读。继续学习。</p></div></div>    
</body>
</html>