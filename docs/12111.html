<html>
<head>
<title>Text Classification â€” From Bag-of-Words to BERT â€” Part 2 (Word2Vec)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ–‡æœ¬åˆ†ç±»â€”ä»è¯è¢‹åˆ°BERT â€”ç¬¬2éƒ¨åˆ†(Word2Vec)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/text-classification-from-bag-of-words-to-bert-part-2-word2vec-35c8c3b34ee3?source=collection_archive---------1-----------------------#2020-12-31">https://medium.com/analytics-vidhya/text-classification-from-bag-of-words-to-bert-part-2-word2vec-35c8c3b34ee3?source=collection_archive---------1-----------------------#2020-12-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/ec5da50d6b851aaecaa80a0de2810741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jnxo-Rv5L0q-77QQ"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">å¡”æ›¼å¨œÂ·èŒ¹ç±³åœ¨<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„çš„ç…§ç‰‡</figcaption></figure></div><div class="ab cl iu iv go iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="ha hb hc hd he"><p id="e092" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">è¿™ä¸ªæ•…äº‹æ˜¯ä¸€ç³»åˆ—æ–‡æœ¬åˆ†ç±»çš„ä¸€éƒ¨åˆ†â€”â€”ä»å•è¯è¢‹åˆ°ä¼¯ç‰¹ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰æ£€æŸ¥ä¹‹å‰çš„æ•…äº‹ï¼Œä¸€å®šè¦æ£€æŸ¥ä¸€ä¸‹ï¼Œå› ä¸ºè¿™å°†æœ‰åŠ©äºç†è§£æœªæ¥çš„äº‹æƒ…ã€‚</p><p id="b075" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><a class="ae it" href="https://anirbansen3027.medium.com/text-classification-from-bag-of-words-to-bert-1e628a2dd4c9" rel="noopener">ç¬¬ä¸€éƒ¨åˆ†</a></p><p id="afa7" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">åœ¨ä¹‹å‰çš„æ•…äº‹ä¸­(<a class="ae it" href="https://anirbansen3027.medium.com/text-classification-from-bag-of-words-to-bert-1e628a2dd4c9" rel="noopener"> Part 1 (BagOfWords) </a>æˆ‘ä»¬ä½¿ç”¨äº†CountVectorizer(ä¸€ä¸ªsklearnçš„å•è¯åŒ…å®ç°)æ¨¡å‹å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—æ•°æ®é›†ï¼Œæ˜ å°„åˆ°è¾“å‡ºå˜é‡toxicã€severe_toxicã€æ·«ç§½ã€å¨èƒã€ä¾®è¾±ã€identity_hateï¼Œå¹¶ä½¿ç”¨sklearnçš„å¤šè¾“å‡ºåˆ†ç±»å™¨åŒ…è£…å™¨ä¸ºæ‰€æœ‰6ä¸ªè¾“å‡ºå˜é‡åˆ›å»ºé€»è¾‘å›å½’æ¨¡å‹ã€‚</p><p id="4b20" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ç”¨Word2Vecæ¨¡å‹ä»£æ›¿ç¬¬ä¸€éƒ¨åˆ†æ¥åˆ›å»ºåµŒå…¥ï¼Œè€Œä¸æ˜¯BagOfWordså‘é‡ï¼Œç„¶åå°†å…¶è¾“å…¥åˆ°é€»è¾‘å›å½’æ¨¡å‹ä¸­(ä»»ä½•ML/DLæ¨¡å‹éƒ½å¯ä»¥åœ¨Word2VecåµŒå…¥çš„åŸºç¡€ä¸Šæ„å»º)ã€‚</p><p id="2723" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">æ³¨æ„:æˆ‘æ²¡æœ‰åœ¨è¿™ç¯‡åšå®¢ä¸­æ¶‰åŠé€»è¾‘å›å½’å’Œç‰¹å¾é‡è¦æ€§/æ¨¡å‹è§£é‡Šçš„ç»†èŠ‚ï¼Œå› ä¸ºæˆ‘å·²ç»åœ¨ä¸Šä¸€ç¯‡æ–‡ç« (</strong> <a class="ae it" href="https://anirbansen3027.medium.com/text-classification-from-bag-of-words-to-bert-1e628a2dd4c9" rel="noopener"> <strong class="jd hi">ç¬¬ä¸€éƒ¨åˆ†(BagOfWords)</strong></a><strong class="jd hi">)</strong>ä¸­æ¶‰åŠè¿‡</p><p id="e753" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz">ä»€ä¹ˆæ˜¯å•è¯åµŒå…¥ï¼Ÿ</em>T19ã€‘</strong></p><figure class="kb kc kd ke fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ka"><img src="../Images/995155dc1c06ae396e8805c829623ab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K8HYjAhH0g7Vr58IZLerDA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">äºŒç»´å•è¯åµŒå…¥</figcaption></figure><p id="a641" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">å•è¯åµŒå…¥ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä½¿ç”¨é«˜æ•ˆã€å¯†é›†è¡¨ç¤ºçš„æ–¹æ³•ï¼Œå…¶ä¸­ç›¸ä¼¼çš„å•è¯å…·æœ‰ç›¸ä¼¼çš„ç¼–ç ã€‚é‡è¦çš„æ˜¯ï¼Œæ‚¨ä¸å¿…æ‰‹åŠ¨æŒ‡å®šè¿™ç§ç¼–ç ã€‚åµŒå…¥æ˜¯æµ®ç‚¹å€¼çš„å¯†é›†å‘é‡(å‘é‡çš„é•¿åº¦æ˜¯æ‚¨æŒ‡å®šçš„å‚æ•°)ã€‚</p><p id="41f2" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">ä¸Šé¢æ˜¯ä¸€ä¸ªäºŒç»´å•è¯åµŒå…¥ï¼Œå…¶ä¸­æ˜ŸæœŸæ—¥ä¸å…¶ä»–å·¥ä½œæ—¥çš„ç›¸ä¼¼å€¼å¤šäºå®¶åº­æˆå‘˜</p><p id="75ac" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz">ä»€ä¹ˆæ˜¯Word2Vecï¼Ÿ</em> </strong></p><p id="64ed" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">Word2Vecæ˜¯åˆ›å»º/å­¦ä¹ è¿™äº›åµŒå…¥çš„æœ€å¤è€çš„æ–¹æ³•ä¹‹ä¸€ã€‚Word2Vecä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„ç®—æ³•ï¼Œè€Œæ˜¯ä¸€ç³»åˆ—æ¨¡å‹æ¶æ„å’Œä¼˜åŒ–ï¼Œå¯ç”¨äºä»å¤§å‹æ•°æ®é›†å­¦ä¹ å•è¯åµŒå…¥ã€‚é€šè¿‡Word2Vecå­¦ä¹ çš„åµŒå…¥å·²è¢«è¯æ˜åœ¨å„ç§ä¸‹æ¸¸è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸Šæ˜¯æˆåŠŸçš„ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»ã€é—®é¢˜å›ç­”ã€‚è¯¥è®ºæ–‡æå‡ºäº†ä¸¤ç§å­¦ä¹ å•è¯è¡¨å¾çš„æ–¹æ³•:</p><p id="f87d" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">è¿ç»­è¯è¢‹æ¨¡å‹</strong>åŸºäºå‘¨å›´ä¸Šä¸‹æ–‡è¯é¢„æµ‹ä¸­é—´è¯ã€‚ä¸Šä¸‹æ–‡ç”±å½“å‰(ä¸­é—´)å•è¯å‰åçš„å‡ ä¸ªå•è¯ç»„æˆã€‚è¿™ç§æ¶æ„è¢«ç§°ä¸ºå•è¯è¢‹æ¨¡å‹ï¼Œå› ä¸ºå•è¯åœ¨ä¸Šä¸‹æ–‡ä¸­çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚</p><p id="8a07" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">è¿ç»­è·³æ ¼æ¨¡å‹</strong>é¢„æµ‹åŒä¸€å¥å­ä¸­å½“å‰å•è¯å‰åä¸€å®šèŒƒå›´å†…çš„å•è¯ã€‚</p><figure class="kb kc kd ke fd ii er es paragraph-image"><div class="er es kf"><img src="../Images/872068ab00a655fb9523ae09ee1a99d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*-YZnKvaisW3eBJvSxqL7xA.png"/></div></figure><p id="372b" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">åœ¨CBOWä¸­ï¼Œç»™å®šå•è¯(å¿«é€Ÿçš„æ£•è‰²ç›’å­ï¼Œåœ¨æ‡’æƒ°çš„ç‹—ä¸Šé¢)ï¼Œæˆ‘ä»¬æƒ³è¦é¢„æµ‹è·³è·ƒã€‚åœ¨Skipgramä¸­ï¼Œä¸å•è¯jumpæ­£å¥½ç›¸åï¼Œæˆ‘ä»¬æƒ³è¦é¢„æµ‹(å¿«é€Ÿçš„æ£•è‰²æ¡†ï¼Œåœ¨æ‡’ç‹—ä¸Šé¢)</p><p id="3587" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz">ä½†æ˜¯æ¨¡ç‰¹ä»¬æ˜¯æ€ä¹ˆå­¦ä¹ çš„å‘¢ï¼Ÿ</em> </strong></p><figure class="kb kc kd ke fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kg"><img src="../Images/eecb8f662b0e8fa762be561366eb9c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VkyMv_jeRqyBoS29TX1vg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ã€CBOW(å·¦)å’ŒSkip-gram(å³)çš„æ¶æ„</figcaption></figure><p id="27f0" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">è®©æˆ‘ä»¬ä»CBOWå¼€å§‹ï¼Œæˆ‘ä»¬ä»¥å¥å­â€œè‡ªç„¶è¯­è¨€å¤„ç†â€ä¸ºä¾‹ï¼Œå…¶ä¸­â€œè‡ªç„¶â€å’Œâ€œå¤„ç†â€éƒ½æ˜¯ä¸Šä¸‹æ–‡è¯ï¼Œâ€œè¯­è¨€â€æ˜¯ç›®æ ‡è¯ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæµ…çš„ç½‘ç»œï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåªæœ‰ä¸€ä¸ªéšè—å±‚ã€‚</p><p id="614a" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">å› æ­¤ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªåªæœ‰ä¸€ä¸ª1çš„Vé¡¹(è¯æ±‡çš„å¤§å°/å”¯ä¸€å•è¯çš„æ€»æ•°)çš„ç‹¬ä¸€æ— äºŒçš„ç¼–ç å‘é‡ã€‚å‡è®¾æˆ‘ä»¬åªæœ‰5ä¸ªè¯æ±‡(è‡ªç„¶ã€è¯­è¨€ã€å¤„ç†ã€æ˜¯ã€å¾ˆå¥½)ã€‚è‡ªç„¶çš„å‘é‡å°†æ˜¯[1ï¼Œ0ï¼Œ0ï¼Œ0ï¼Œ0]ã€‚ç±»ä¼¼åœ°ï¼Œå¯¹äºå¤„ç†ï¼Œå®ƒå°†æ˜¯[0ï¼Œ0ï¼Œ1ï¼Œ0ï¼Œ0]ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¤§å°ä¸ºV * <em class="jz"> D </em>çš„éšæœºåˆå§‹åŒ–çš„åµŒå…¥å‘é‡(E ),å…¶ä¸­Dæ˜¯å¯ä»¥é€‰æ‹©çš„å‘é‡çš„ç»´æ•°ã€‚è¿™æ˜¯è¾“å…¥å›¾å±‚çš„æƒé‡çŸ©é˜µã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†è¾“å…¥çš„ç‹¬çƒ­ç¼–ç å‘é‡ä¹˜ä»¥æƒé‡/åµŒå…¥å‘é‡ã€‚è¿™ç»™å‡ºäº†å°ºå¯¸ä¸º1 Dçš„ä¸Šä¸‹æ–‡å•è¯(è‡ªç„¶çš„å’Œå¤„ç†çš„)çš„åµŒå…¥å‘é‡</p><p id="7823" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">ç°åœ¨ï¼Œåœ¨éšè—å±‚ä¸­ï¼Œæˆ‘ä»¬å¯¹ä¸Šä¸‹æ–‡å•è¯çš„åµŒå…¥å‘é‡è¿›è¡Œå¹³å‡ï¼Œè¿™å½¢æˆäº†è¯¥å±‚çš„å¤§å°ä¸º1 <em class="jz"> * D. </em>çš„è¾“å…¥ã€‚è¿™ä¹˜ä»¥å¦ä¸€ä¸ªç§°ä¸ºä¸Šä¸‹æ–‡å‘é‡(Eâ€™)çš„å¤§å°ä¸ºD * Vçš„å‘é‡ã€‚è¿™ç»™äº†æˆ‘ä»¬1 * Vçš„å‘é‡ï¼Œè¯¥å‘é‡ç„¶åé€šè¿‡sigmoidå‡½æ•°å¾—åˆ°æœ€ç»ˆè¾“å‡ºã€‚</p><p id="a86e" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">å°†æœ€ç»ˆè¾“å‡ºä¸è¯­è¨€çš„ç‹¬çƒ­ç¼–ç å‘é‡(ä¸­é—´å­—)[0ï¼Œ1ï¼Œ0ï¼Œ0ï¼Œ0]è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶è®¡ç®—æŸå¤±å‡½æ•°ã€‚è¯¥æŸå¤±è¢«åå‘ä¼ æ’­ï¼Œå¹¶ä¸”ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥è®­ç»ƒè¯¥æ¨¡å‹</p><p id="58e7" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">å¯¹äºSkip-gramï¼Œæƒ…å†µæ­£å¥½ç›¸åï¼Œæˆ‘ä»¬æœ‰ä¸­é—´è¯çš„ä¸€ä¸ªçƒ­ç¼–ç å‘é‡ï¼Œå®ƒä¹˜ä»¥æƒé‡/åµŒå…¥å‘é‡E = V * Dï¼Œæˆ‘ä»¬å¾—åˆ°ä¸­é—´è¯çš„åµŒå…¥ï¼Œä½œä¸ºè¾“å…¥å±‚çš„è¾“å‡ºå’Œéšè—å±‚çš„è¾“å…¥ã€‚å®ƒä¸ä¸Šä¸‹æ–‡å‘é‡E' = D * Vç›¸ä¹˜ï¼Œæˆ‘ä»¬å¾—åˆ°è¾“å‡ºï¼Œè¯¥è¾“å‡ºé€šè¿‡sigmoidä¼ é€’ï¼Œå¹¶ä¸ä¸Šä¸‹æ–‡å•è¯è¿›è¡Œæ¯”è¾ƒï¼Œä»¥å¾—åˆ°æŸå¤±å’Œåå‘ä¼ æ’­ã€‚</p><p id="b951" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªåœ¨æœ€åä¿ç•™åµŒå…¥(E)å‘é‡</p><p id="a2f4" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz">æˆ‘ä»¬å°†å¦‚ä½•è·å¾—åµŒå…¥ï¼Ÿ</em> </strong></p><p id="2503" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">Gensimåº“ä½¿æˆ‘ä»¬èƒ½å¤Ÿå¼€å‘å•è¯åµŒå…¥ã€‚Gensimè®©æ‚¨åœ¨è®­ç»ƒè‡ªå·±çš„åµŒå…¥æ—¶å¯ä»¥é€‰æ‹©CBOWæˆ–Skip-gramã€‚(é»˜è®¤ä¸ºCBOW)ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒGensimè¿˜æœ‰ä¸€ä¸ªé¢„è®­ç»ƒåµŒå…¥çš„ç›®å½•ï¼Œè¿™äº›é¢„è®­ç»ƒåµŒå…¥æ˜¯åœ¨å‡ ä¸ªæ–‡æ¡£ä¸Šè®­ç»ƒçš„ï¼Œå¦‚wikié¡µé¢ã€googleæ–°é—»ã€Twitter tweetsç­‰ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åŸºäºè°·æ­Œæ–°é—»è¯­æ–™åº“(30äº¿ä¸ªè¿è¡Œå•è¯)å•è¯å‘é‡æ¨¡å‹(300ä¸‡ä¸ª300ç»´è‹±è¯­å•è¯å‘é‡)çš„é¢„è®­ç»ƒåµŒå…¥ã€‚å®šä¹‰å¤Ÿäº†ã€‚è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä»£ç ğŸ‘¨â€ğŸ’»</p><p id="a42e" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">å®æ–½:</strong></p><p id="7c34" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz"> 1ã€‚è¯»å–æ•°æ®é›†</em> </strong></p><figure class="kb kc kd ke fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ki"><img src="../Images/0543de08e345f6b77adbe68a2a0922ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1oEsT7kJsaTm2saQmCu36g.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æé†’ä¸€ä¸‹ï¼Œè¿™æ˜¯è®­ç»ƒæ•°æ®çš„æ ·å­</figcaption></figure><p id="1de4" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz"> 2ã€‚åŸºæœ¬é¢„å¤„ç†</em> </strong></p><pre class="kb kc kd ke fd kj kk kl km aw kn bi"><span id="0152" class="ko kp hh kk b fi kq kr l ks kt">def preprocess_corpus(texts):<br/>    <em class="jz">#importing stop words like in, the, of so that these can be removed from texts</em><br/>    <em class="jz">#as these words dont help in determining the classes(Whether a sentence is toxic or not)</em><br/>    mystopwords = set(stopwords.words("english"))<br/>    def remove_stops_digits(tokens):<br/>        <em class="jz">#Nested function that lowercases, removes stopwords and digits from a list of tokens</em><br/>        return [token.lower() for token <strong class="kk hi">in</strong> tokens if token <strong class="kk hi">not</strong> <strong class="kk hi">in</strong> mystopwords <strong class="kk hi">and</strong> <strong class="kk hi">not</strong> token.isdigit()<br/>               <strong class="kk hi">and</strong> token <strong class="kk hi">not</strong> <strong class="kk hi">in</strong> punctuation]<br/>    <em class="jz">#This return statement below uses the above function and tokenizes output further. </em><br/>    return [remove_stops_digits(word_tokenize(text)) for text <strong class="kk hi">in</strong> tqdm(texts)]<br/><br/><em class="jz">#Preprocess both for training and test data</em><br/>train_texts_processed = preprocess_corpus(train_texts)<br/>test_texts_processed = preprocess_corpus(test_texts)</span></pre><figure class="kb kc kd ke fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ku"><img src="../Images/8488434cee3f35efbbd15d47539c7b6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wNF-Hm8_cXlSZg1eDy-LQg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">é¢„å¤„ç†çš„ç»“æœ</figcaption></figure><p id="7e07" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»NLTKåº“ä¸­åˆ é™¤åœç”¨è¯å’Œå®Œæ•´æ•°å­—ï¼Œå°å†™æ‰€æœ‰æ–‡æœ¬ï¼Œå¹¶ä½¿ç”¨word_tokenizeå¯¹æ–‡æœ¬è¿›è¡Œæ ‡è®°åŒ–(åˆ†è§£æˆå•ç‹¬çš„æ ‡è®°/å•è¯)</p><p id="2dea" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz"> 3ã€‚åŠ è½½é¢„è®­ç»ƒåµŒå…¥</em> </strong></p><p id="5683" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">æˆ‘ä»¬ä½¿ç”¨Gensimåº“ä¸ºåœ¨Googleæ–°é—»æ•°æ®é›†ä¸Šè®­ç»ƒçš„å•è¯åŠ è½½é¢„è®­ç»ƒåµŒå…¥ã€‚è°·æ­Œæ–°é—»æ¨¡å‹/åµŒå…¥å‘é‡æ˜¯300ç»´çš„ã€‚æŠ¤ç›®é•œæ–°é—»æ¨¡å‹/åµŒå…¥å‘é‡å¤§çº¦æœ‰3 Må­—ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªåµŒå…¥çš„ä¾‹å­ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­é”®æ˜¯å•è¯ï¼Œå€¼æ˜¯è¯¥å•è¯çš„åµŒå…¥å‘é‡ã€‚</p><pre class="kb kc kd ke fd kj kk kl km aw kn bi"><span id="3e00" class="ko kp hh kk b fi kq kr l ks kt"><em class="jz">#Path for the models/ embedding vector</em><br/>google_news_model = '../input/gensim-embeddings-dataset/GoogleNews-vectors-negative300.gensim'<br/><em class="jz">#Loading the models/ embedding vector using KeyedVectors.load function from gensim</em><br/>w2v_google_news = KeyedVectors.load(google_news_model)<br/><em class="jz">#Print Shape of the embedding</em><br/>print("Shape of embedding vector", w2v_google_news["Natural"].shape)<br/><em class="jz">#Let's print first 20 dimensions rather than all 300</em><br/>print("First 20 numbers in the embedding of the word Natural<strong class="kk hi">\n\n</strong>", w2v_google_news["Natural"][:20])</span></pre><figure class="kb kc kd ke fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/975c8bec94d81ac3c0662028b5f5164e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*OIwoM1No4jCI9A4DwIUa8w.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">è¿™å°±æ˜¯å•è¯â€œNaturalâ€çš„åµŒå…¥æ–¹å¼ã€‚</figcaption></figure><p id="80b0" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz"> 4ã€‚ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„æ¨¡å‹å°†æ–‡æœ¬è¾“å…¥è½¬æ¢ä¸ºåµŒå…¥å†…å®¹</em> </strong></p><p id="4f1b" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬ä»å…ˆå‰çš„è¾“å…¥æ ‡è®°åŒ–æ–‡æœ¬ä¸­è·å–è¾“å…¥ï¼Œå¹¶ä»é¢„å…ˆè®­ç»ƒçš„åµŒå…¥å‘é‡ä¸­è·å–æ–‡æœ¬ä¸­æ¯ä¸ªå•è¯çš„åµŒå…¥ã€‚è¿™å°†ä¸ºæˆ‘ä»¬æä¾›æœ€ç»ˆçš„è¾“å…¥æ•°æ®é›†ï¼Œå…¶å½¢å¼ä¸ºæ¯ä¸ªå¥å­çš„åµŒå…¥ï¼Œå¯ç”¨äºä¸è¾“å‡ºå˜é‡ä¸€èµ·è®­ç»ƒã€‚</p><pre class="kb kc kd ke fd kj kk kl km aw kn bi"><span id="5bdd" class="ko kp hh kk b fi kq kr l ks kt"><em class="jz">#Function that takes in the input text dataset in form of list of lists where each sentence is a list of words all the sentences are </em><br/><em class="jz">#inside a list</em><br/>def embedding_feats(list_of_lists, DIMENSION, w2v_model):<br/>    zeros_vector = np.zeros(DIMENSION)<br/>    feats = []<br/>    missing = set()<br/>    missing_sentences = set()<br/>    <em class="jz">#Traverse over each sentence</em><br/>    for tokens <strong class="kk hi">in</strong> tqdm(list_of_lists):<br/>        <em class="jz"># Initially assign zeroes as the embedding vector for the sentence</em><br/>        feat_for_this = zeros_vector<br/>        <em class="jz">#Count the number of words in the embedding for this sentence</em><br/>        count_for_this = 0<br/>        <em class="jz">#Traverse over each word of a sentence</em><br/>        for token <strong class="kk hi">in</strong> tokens:<br/>            <em class="jz">#Check if the word is in the embedding vector</em><br/>            if token <strong class="kk hi">in</strong> w2v_model:<br/>                <em class="jz">#Add the vector of the word to vector for the sentence</em><br/>                feat_for_this += w2v_model[token]<br/>                count_for_this +=1<br/>            <em class="jz">#Else assign the missing word to missing set just to have a look at it</em><br/>            else:<br/>                missing.add(token)<br/>        <em class="jz">#If no words are found in the embedding for the sentence</em><br/>        if count_for_this == 0:<br/>            <em class="jz">#Assign all zeroes vector for that sentence</em><br/>            feats.append(feat_for_this)<br/>            <em class="jz">#Assign the missing sentence to missing_sentences just to have a look at it</em><br/>            missing_sentences.add(' '.join(tokens))<br/>        <em class="jz">#Else take average of the values of the embedding for each word to get the embedding of the sentence</em><br/>        else:<br/>            feats.append(feat_for_this/count_for_this)<br/>    return feats, missing, missing_sentences</span><span id="18fc" class="ko kp hh kk b fi kw kr l ks kt"><em class="jz">#Embeddings for the train dataset</em><br/>train_vectors, missing, missing_sentences = embedding_feats(train_texts_processed, 300, w2v_google_news)</span></pre><figure class="kb kc kd ke fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/da8fd964ad2159e783128a0d1bd7401d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*KiL5VWFuWApoa-5PFtTMzw.png"/></div></figure><p id="5406" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">æ€»ä¹‹ï¼Œæ¯ä¸ªå¥å­å°†æœ‰ä¸€ä¸ª300ç»´çš„åµŒå…¥å‘é‡ï¼Œå®ƒå°†æ˜¯è¯¥å¥å­ä¸­å‡ºç°çš„å•è¯åµŒå…¥çš„å¹³å‡å€¼ã€‚å•è¯åµŒå…¥æ¥è‡ªé¢„å…ˆè®­ç»ƒçš„å•è¯åµŒå…¥ï¼Œè¿™äº›å•è¯åµŒå…¥åœ¨google newsä¸Šè¢«è®­ç»ƒä»¥æ‰¾åˆ°åµŒå…¥ã€‚</p><p id="b0f3" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jz"> 5ã€‚è®­ç»ƒå’ŒéªŒè¯å¤šè¾“å‡ºåˆ†ç±»å™¨</em> </strong></p><p id="56b8" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">è¿™ä¸€éƒ¨åˆ†å°†æ¶‰åŠ5ä»¶äº‹</p><ol class=""><li id="03b4" class="ky kz hh jd b je jf ji jj jm la jq lb ju lc jy ld le lf lg bi translated">è·å–è®­ç»ƒæ•°æ®é›†çš„åµŒå…¥å‘é‡</li><li id="0b95" class="ky kz hh jd b je lh ji li jm lj jq lk ju ll jy ld le lf lg bi translated">å°†åµŒå…¥å‘é‡å’Œè¾“å‡ºå˜é‡åˆ†æˆè®­ç»ƒé›†å’ŒéªŒè¯é›†</li><li id="e373" class="ky kz hh jd b je lh ji li jm lj jq lk ju ll jy ld le lf lg bi translated">åœ¨è®­ç»ƒåµŒå…¥å‘é‡å’Œè¾“å‡ºå˜é‡ä¸Šæ‹Ÿåˆå¤šè¾“å‡ºé€»è¾‘å›å½’æ¨¡å‹<em class="jz">(æˆ‘åœ¨ä¹‹å‰çš„æ•…äº‹(</em> <a class="ae it" href="https://anirbansen3027.medium.com/text-classification-from-bag-of-words-to-bert-1e628a2dd4c9" rel="noopener"> <em class="jz">ç¬¬ä¸€éƒ¨åˆ†(bagowords)</em></a><em class="jz">)</em>ä¸­å·²ç»è¯¦ç»†ä»‹ç»äº†é€»è¾‘å›å½’)</li><li id="1872" class="ky kz hh jd b je lh ji li jm lj jq lk ju ll jy ld le lf lg bi translated">å¯¹éªŒè¯åµŒå…¥å‘é‡è¿›è¡Œé¢„æµ‹</li><li id="f6ff" class="ky kz hh jd b je lh ji li jm lj jq lk ju ll jy ld le lf lg bi translated">æ ¹æ®ROC-AUCè¡¡é‡ç»©æ•ˆ</li></ol><pre class="kb kc kd ke fd kj kk kl km aw kn bi"><span id="b613" class="ko kp hh kk b fi kq kr l ks kt">def train_model(DIMENSION, model):<br/>    <em class="jz">#Get the embedding vector for the training data</em><br/>    train_vectors, missing, missing_sentences = embedding_feats(train_texts_processed, DIMENSION, model)<br/>    <em class="jz">#Split the embedding vector for the training data along with the output variables into train and validation sets</em><br/>    train_data, val_data, train_cats, val_cats = train_test_split(train_vectors, train_labels)<br/>    <em class="jz">#Logistic Regression Model (As we have unbalanced dataset, we use class_weight which will use inverse of counts of that class. It penalizes mistakes in samples of class[i] with class_weight[i] instead of 1)</em><br/>    lr = MultiOutputClassifier(LogisticRegression(class_weight='balanced', max_iter=3000)).fit(train_data, train_cats)<br/>    <em class="jz">#Actuals for the validation data</em><br/>    y_vals = val_cats<br/>    <em class="jz">#Prediction probability for the validation dataset by the model for class 1</em><br/>    y_preds = np.transpose(np.array(lr.predict_proba(val_data))[:,:,1])<br/>    <em class="jz">#Calculate the Mean ROC_AUC </em><br/>    mean_auc = mean(accuracy(y_vals,y_preds))<br/>    return mean_auc, lr</span><span id="5d71" class="ko kp hh kk b fi kw kr l ks kt">mean_auc, lr = train_model(300, w2v_google_news)</span></pre><p id="28c0" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">è¿™ä¸ªæ¨¡å‹è¢«è¯æ˜æ˜¯ç›¸å½“æ¸©å’Œçš„(~0ã€‚60 ROC-AUC)ã€‚ä½†åŒæ ·ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ å¦‚ä½•å®ç°å•è¯åµŒå…¥ã€‚ä½æ€§èƒ½å¯èƒ½æ˜¯å› ä¸ºé¢„è®­ç»ƒçš„åµŒå…¥æ²¡æœ‰æ­£ç¡®åœ°æ•æ‰ç»†èŠ‚ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Word2Vecæ¥è®­ç»ƒæˆ‘ä»¬è‡ªå·±çš„åµŒå…¥ã€‚</p><p id="84e0" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><em class="jz"> TODOs: </em></p><ol class=""><li id="1aa2" class="ky kz hh jd b je jf ji jj jm la jq lb ju lc jy ld le lf lg bi translated">ä»å¤´å¼€å§‹è®­ç»ƒWord2Vecæ¨¡å‹</li><li id="a705" class="ky kz hh jd b je lh ji li jm lj jq lk ju ll jy ld le lf lg bi translated">å°è¯•é›†åˆæ¨¡å‹ï¼Œè€Œä¸æ˜¯æ™®é€šçš„MLæ¨¡å‹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‰“åŒ…å’Œå¢å¼ºæ¨¡å‹æ¯”ç»å…¸çš„MLæŠ€æœ¯ç»™å‡ºæ›´å¥½çš„ç»“æœ</li><li id="66c8" class="ky kz hh jd b je lh ji li jm lj jq lk ju ll jy ld le lf lg bi translated">å¯ä»¥åšæ›´å¥½çš„æ–‡æœ¬é¢„å¤„ç†ã€æ‰“å­—é”™è¯¯çº æ­£ç­‰æ¥è¿›ä¸€æ­¥æ”¹è¿›æ¨¡å‹</li></ol><p id="3e68" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">è¿™æ˜¯å…³äºWord2Vecçš„ï¼Œä¸‹ä¸€ä¸ªï¼Œå°†æ˜¯å…³äºè„¸ä¹¦çš„fastTextï¼Œå®ƒå°†å•è¯åµŒå…¥çš„æ€æƒ³å‘å‰æ¨è¿›äº†ä¸€æ­¥ï¼Œå®ç°äº†ä¸€ç§å«åšå­å•è¯åµŒå…¥çš„ä¸œè¥¿ã€‚åœ¨é‚£ä¹‹å‰ä¿æŒå®‰å…¨ã€‚åŒæ ·ï¼Œå®Œæ•´çš„ä»£ç å‡ºç°åœ¨<a class="ae it" href="https://www.kaggle.com/anirbansen3027/jtcc-word2vec" rel="noopener ugc nofollow" target="_blank">(è¿™é‡Œ)</a>ã€‚è¯·ä»¥å›ç­”å’Œé¼“æŒçš„å½¢å¼æä¾›æ‚¨çš„åé¦ˆ:)</p></div></div>    
</body>
</html>