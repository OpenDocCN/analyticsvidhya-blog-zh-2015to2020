# 部署 Azure 自动化机器学习

> 原文：<https://medium.com/analytics-vidhya/deploy-azure-automated-machine-learning-61501b43b080?source=collection_archive---------0----------------------->

我之前的故事是关于如何轻松地创建模型。自动机器学习通过运行多种算法并找到最佳算法，使数据科学变得非常容易。我们还看到所有的模型都展示出来了，每个模型都可以下载成 pickle 文件。下面是部署该模型的概述步骤

1.  部署最佳模型
2.  注册模型，下载分数文件，下载 Conda 环境文件
3.  创建图像并上传到容器注册表
4.  创建部署以部署到 Azure Kubernetes 群集。
5.  测试 score REST API

好了，现在让我们进入细节。

注意:创建一个至少有 12 个内核的 Azure Kubernetes 集群。

1.部署最佳模型:一旦自动机器学习运行完成，看看这些模型，看看它们的性能。应该有一个图标下载最好的模型，也部署最好的模型。

2.模型注册:一旦点击部署模型，一个新的窗口打开。屏幕将显示 4 个选项。首先是注册模型。接下来下载计分 python 文件。接下来下载用于创建 docker 映像的 conda 环境文件。一旦我们有了必要的文件，让我们开始创建模型。创建一个模型是使用上传 pickle 文件，然后评分和 conda 环境文件。现在，您应该看到在模型部分创建了一个模型。

3.创建图像:现在是时候去模型，选择模型，并创建一个图像。上传评分和 conda 环境文件，然后提交以创建图像。当图像被创建时，将被存储在由机器学习工作空间创建的 Azure 容器注册表中。

现在，在我们创建部署之前，转到“Compute ”,创建一个新的计算，给出一个名称，并在下拉列表中选择 AKS 作为计算目标。然后选择您之前创建的至少具有 12 个内核的 AKS 集群。将 AKS 群集连接到计算目标需要几分钟时间。等到状态显示成功。

4.创建部署:一旦计算目标准备就绪，映像和模型也准备就绪(您可以转到映像并查看状态，应该显示成功)。转到部署部分或转到映像并选择映像，然后单击创建部署。输入一个名称，然后选择运行计分休息 API 的计算目标。如果需要，可以看看高级配置。然后单击“create ”,这需要几分钟时间来完成部署。部署完成后，屏幕会显示关于部署的详细信息，如 REST API 的 URL 和密码以及计算资源的分配。

5.测试 score REST API:一旦部署成功，现在就该测试 REST API 了。我们可以使用 chrome 中的 postman 或者高级 REST 客户端来测试 REST API。确保我们将 POST 称为动词。从部署中复制 URL，并将其粘贴到工具中。创建 2 个标头，一个用于授权和内容类型。授权是对服务进行身份验证的关键，这个关键可以在部署部分的 REST API 的部署细节页面中找到。这是授权样本的样本

授权持有人<key>用部署细节中的主密钥或二级密钥替换<key>。</key></key>

内容型应用程序/json 这是非常常见的一种。

现在是时候用适当的 JSON 消息来构造主体，以发送要评分的数据了。下面是一个样本格式，我们需要发送 JSON 消息来获得分数。

{“数据”:

[​

{“年”:“2019”，

“月”:“6”，

"销售":" ^ 1 " }

]​

}

上面的格式就是 REST API 接受数据作为输入的方式。像 year、month 和 sales 这样的数组值将根据您的模型输入特性而改变。对于我的示例，我使用了上面的方法，但是请修改它以反映您的模型输入特性。一旦 REST API 开始工作，一切都准备好了。REST API 现在可以被其他下游应用程序使用了。

Azure 机器学习服务使数据科学家更容易构建和部署模型。还提供 DevOps 集成。基本模型开发的可视化拖放，然后使用自动化机器学习来尝试不同的模型。使用不同计算选项的选项，如机器学习计算、Azure 数据砖、HDInsight、Azure 数据湖分析等。

请尝试让我知道你的意见。

享受数据科学的乐趣。