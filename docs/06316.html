<html>
<head>
<title>Causal Inference : An Introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">因果推理:导论</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/causal-inference-an-introduction-f424df7c76ef?source=collection_archive---------2-----------------------#2020-05-18">https://medium.com/analytics-vidhya/causal-inference-an-introduction-f424df7c76ef?source=collection_archive---------2-----------------------#2020-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="372d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，因果关系的概念在机器学习和人工智能领域越来越受欢迎，因为它与世界的工作有着内在的联系。因果关系指的是原因和结果之间的关系，也就是说，它基于这样一种假设，即每一个结果都是由一个特定的原因或一组原因引起的。在这篇博客中，我们将了解因果推理的基础知识，熟悉该领域中使用的术语，并深入研究反事实和反事实推理科学，这在最近变得越来越流行。</p><p id="5dd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">先决条件:本博客期望读者熟悉神经网络的基本概念，以及如何借助</em> <a class="ae je" rel="noopener" href="/data-science-group-iitr/loss-functions-and-optimization-algorithms-demystified-bb92daff331c"> <em class="jd">损失函数和优化器</em> </a> <em class="jd">来训练神经网络。</em></p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><h1 id="fd80" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">因果推理</h1><p id="3f51" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">因果推理的领域是基于简单的因果原则，也就是说，我们的行为直接导致直接的结果。通过因果推理，我们可以直接发现政策(或行动)的变化如何导致现实世界结果的变化。让我们熟悉一下该领域中使用的术语。</p><p id="194c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">单位:</strong>数据中的一个个体样本。</p><p id="66c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">变量:</strong>数据集中分析单元的特征。比如国家、人物、天气等。</p><p id="c441" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">总体:</strong>收集所有分析单元的集合。</p><p id="213f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结果变量:</strong>我们想要影响的特定变量。</p><p id="ea9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">策略/处理变量:</strong>用于创建变更(即动作)的变量。</p><p id="0c78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">干预:</strong>改变治疗变量的值，保持其他变量值不变，以研究治疗变量变化的影响。</p><p id="2318" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混杂因素:</strong>影响输入和输出变量的变量。</p><p id="ecf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">反事实结果:</strong>如果该装置暴露于不同的处理，将会出现的结果(无法观察)。</p><p id="cb28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">单元级因果效应:</strong>在保持所有其他变量不变的情况下，由于特定变量的值发生变化而对数据中单个单元产生的因果效应。</p><p id="3a48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">交互效应:</strong>这是指其他变量也可能影响因果效应值的事实。</p><p id="6936" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">异质性:</strong>是指不同单元在受到相同处理时表现出不同因果效应的概念。</p><p id="5097" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">给定输入变量的分布<strong class="ih hj"> X </strong>和结果变量(效果)<strong class="ih hj"> Y </strong>的分布，因果演算区分两种条件分布——观察分布<em class="jd"> P(y|x) </em>和干预分布<em class="jd"> P(y|do(x)) </em>。<em class="jd"> P(y|x) </em>表示<strong class="ih hj"> Y </strong>的分布，假设我们观察到变量<strong class="ih hj"> <em class="jd"> X </em> </strong>取值<em class="jd"> x </em>，而<em class="jd">P(Y | do(X)】</em>描述了<strong class="ih hj"> Y </strong>的分布，这将通过人工强制变量<strong class="ih hj"> X </strong>取值<em class="jd"> x </em>来观察，保持其余变量在使用<a class="ae je" href="https://en.wikipedia.org/wiki/Randomized_controlled_trial" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a>随机对照试验(RCTs)可以获得这样的干预分布。然而，由于伦理或实践方面的考虑，并不总是有可能进行这样的实验。更多关于因果推理及其与do演算的关系可以在<a class="ae je" href="https://www.inference.vc/untitled/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="e3a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">因果推理</strong>的基本问题是，在现实世界中，每个单元只能接受多重处理中的一种，并且只能观察到与该处理相对应的结果。对同一单位的其他治疗的效果不能直接观察到，这就是我们想要使用因果推理技术来预测的。</p><p id="bd5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注:</strong>相关性并不意味着因果关系。相关性指的是两个变量如何相关，而因果关系研究的是一个变量是否影响其他变量。两个变量可能以相关的方式变化，但其中一个可能不会引起另一个的变化。</p><h2 id="3bab" class="kp jn hi bd jo kq kr ks js kt ku kv jw iq kw kx ka iu ky kz ke iy la lb ki lc bi translated">因果推理的框架</h2><p id="6d7a" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated"><strong class="ih hj">结构方程建模(SEM)。</strong> <a class="ae je" href="https://www.lexjansen.com/wuss/2006/tutorials/TUT-Suhr.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="jd">结构方程建模</em> </a>是一种表示、估计和测试变量(测量变量和潜在结构)之间关系网络的方法。该模型最常见的形式是SEM，其目的是说明测量变量的变化和共变。</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ld"><img src="../Images/f63eaedd5fe95af6afc91252557863d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*3DO2Qi5ZngVJLFffGAfkTA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">结构方程模型——学术结构和工作结构之间的关系</figcaption></figure><p id="affc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">潜在成果框架。</strong>也被称为<a class="ae je" href="https://en.wikipedia.org/wiki/Rubin_causal_model" rel="noopener ugc nofollow" target="_blank"> <em class="jd">鲁宾因果模型(RCM) </em> </a>，<em class="jd">潜在结果框架</em>是基于潜在结果的思想。例如，如果一个人上过大学，她在40岁时会有一个特定的收入，而如果她没有上过大学，她在40岁时会有一个不同的收入。为了衡量这个人上大学的因果效应，我们需要比较同一个人在两种不同未来的结果。因为不可能同时看到两种可能的结果，所以其中一种可能的结果总是会被忽略。</p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><h1 id="7452" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">反事实推理</h1><p id="9d92" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在某种程度上，反事实推理可以被定义为对另一个现实的预测。给定一对原因和结果，反事实推理侧重于回答这个问题——“在所有其他条件不变的情况下，对该单位进行不同的处理会有什么影响？”。例如，给一个患有某种疾病的病人服用一种药物<strong class="ih hj"> D1 </strong>，他们表现出好转的迹象。在这种情况下，一个反事实的调查将是询问患者如果接受不同的药物<strong class="ih hj"> D2 </strong>治疗是否仍会表现出类似的改善。</p><p id="07b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进行反事实推理有多种方法，但由于这是一个介绍性的博客，我们将只提到一些非常基本的建模技术。</p><p id="4381" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">贝叶斯结构建模。</strong>在该方法中，设计了一个因果图，并使用贝叶斯技术来估计与特定初始化相对应的结果。<a class="ae je" href="https://arxiv.org/pdf/1506.00356.pdf" rel="noopener ugc nofollow" target="_blank">这篇</a>论文提出了一个相似的模型，用于对时间序列数据进行反事实推断，其中一个变量值在一个特定的时间步长进行干预，并且在随后的时间步长中观察这种干预的效果。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lp"><img src="../Images/00378e65ff3676c0137b218ce4c94b2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*57uTFX6QTNPEwJ7mlW_4XA.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">文中提出的图形模型</figcaption></figure><p id="11ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基于深度学习的生成建模。本文介绍了一种基于变分自动编码器(VAE)的方法，该方法遵循代理推理的因果结构。下图显示了一个具体的因果图。</strong></p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lu"><img src="../Images/44f071c3ecc5a7d2e3af7b14ef0e2535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-1YVVo4WdtxeDv4prxKbPQ.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">因果效应变分自动编码器的模型和推理网络的总体结构。白色节点对应于参数化的确定性神经网络转换，灰色节点对应于从相应分布中抽取样本，白色圆圈对应于根据处理t的切换路径</figcaption></figure><p id="aa3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基于深度学习的确定性方法。</strong>在这种技术中，使用神经预测网络，使得给定输入和单元已经经受的处理，可以获得一组预测值。<a class="ae je" href="https://arxiv.org/pdf/1606.03976.pdf" rel="noopener ugc nofollow" target="_blank">这篇</a>论文提出了TARNet，该TARNet遵循类似的方法，其中有一组共享层，信息在处理分支之间共享，然后有一个单独的分支用于该单元可能经受的每种处理。</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lv"><img src="../Images/1f69c8b6bc9af326622b74236f82f4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/0*wmKX3HGs7eiEwvKy"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">TARNet在论文中提出。</figcaption></figure><p id="5100" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些都是非常基本的方法，旨在执行反事实推理。其他复杂因素，如源样本和目标样本的不相交分布，以及某些治疗的足够训练数据的不可用性等，是另一个博客的主题。</p><h2 id="2fcd" class="kp jn hi bd jo kq kr ks js kt ku kv jw iq kw kx ka iu ky kz ke iy la lb ki lc bi translated">因果推理的评估标准</h2><p id="c539" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">为了训练上面讨论的模型，使用了几个评估度量。</p><p id="0d77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">个体治疗效果(ITE)。</strong>个体治疗效果评估旨在检查一个治疗<em class="jd"> T </em>是否影响特定单位<em class="jd"> i </em>的结果<em class="jd"> Y(i) </em>。如果处理<em class="jd"> T(i) </em>没有应用于单元<em class="jd"> i </em>，<em class="jd"> Y </em> ₀ <em class="jd"> (i) </em>称为处理的潜在结果<em class="jd"> T(i) = 0 </em>，<em class="jd"> Y </em> ₁ <em class="jd"> (i) </em>处理的潜在结果<em class="jd"> T(i) = 1 </em>。对单元<em class="jd"> i </em>的个体治疗效果被定义为潜在治疗结果和控制结果之间的差异；</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lw"><img src="../Images/19a42df90110997c1f26e093027a68a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/format:webp/1*qV_DrRFwJL68vtAguRCN7A.png"/></div></figure><p id="1331" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">估计ITE的挑战在于估计缺失的反事实结果。</p><p id="aafe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">平均治疗效果(ATE)。</strong> ATE是总体中单位水平因果效应所有值的平均值。当所有单元都受到策略影响时的平均结果被称为策略下的平均结果，当没有单元受到策略影响时的平均结果被称为没有策略时的平均结果。平均治疗效果是有政策下的平均结果和无政策下的平均结果之间的差异。</p><p id="bab6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均治疗影响(ATE) <em class="jd"> ψ </em>由下式给出</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lx"><img src="../Images/ce4e179ecbcc52dc1a4cd6227fb1e428.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*hxgAX8H6AX6y_so-UIDzxg.png"/></div></figure><p id="5663" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">异源效应估计的精度(PEHE)。</strong>在二元设置中，PEHE测量预测模型估计两种处理<em class="jd"> t </em> ₀和<em class="jd"> t </em> ₁对样本<strong class="ih hj"> <em class="jd"> X </em> </strong>的效果差异的能力。为了计算PEHE，我们测量了从无噪声的潜在结果分布₁和₀得出的实际效果差y₁(n(y₀(n)和预测效果差yˆ₁(n(yˆ₀(n)之间的均方误差，通过n个样本用n来索引:</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ly"><img src="../Images/49b34d17aa06cf011ee8a50d7cef05ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*TksOcqIT8_wTwnet09TVvw.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated"><a class="ae je" href="https://arxiv.org/pdf/1810.00656.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1810.00656.pdf</a></figcaption></figure><p id="b9d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当潜在的无噪声分布<em class="jd"> </em>未知时，可以使用噪声地面真实结果<em class="jd"> y. </em>来估计效果<em class="jd">y₁(n)——y₀(n)</em>的真实差异</p><p id="da15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这3个指标主要用于训练和评估执行反事实推理的模型。存在其他几个旨在保持潜在空间和最近邻匹配反事实的平衡分布的度量，但这是另一个博客的主题。</p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><h1 id="0453" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">结论</h1><p id="2e35" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">这篇博客简要地谈到了因果推理的基础和该领域的反事实研究。如前所述，在这个领域还有很多东西需要了解。然而，更高级的话题将会在未来的博客中涉及。我希望这篇博客是对因果推理领域的有价值的介绍。</p><p id="0399" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您花时间阅读本博客。如有任何疑问，请联系<a class="ae je" href="https://www.linkedin.com/in/siddhant-haldar-2ba70a136/" rel="noopener ugc nofollow" target="_blank"><em class="jd"/></a><em class="jd">我。</em></p></div></div>    
</body>
</html>