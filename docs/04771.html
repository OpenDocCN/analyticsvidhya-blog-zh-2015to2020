<html>
<head>
<title>Styling your Django Forms with Crispy Forms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用脆的形式设计你的Django表单</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/styling-your-django-forms-with-crispy-forms-b4e12fec0758?source=collection_archive---------6-----------------------#2020-03-31">https://medium.com/analytics-vidhya/styling-your-django-forms-with-crispy-forms-b4e12fec0758?source=collection_archive---------6-----------------------#2020-03-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b869450689bec2579652087122da1257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Cbf1S8oLhokE2FQp.jpeg"/></div></div></figure><p id="26c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将看到如何用库Crispy Forms来设计我们的表单。</p><p id="f8f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，我们走吧。</p><p id="da88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，让我们使用下面的命令安装django和crispy表单</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5629" class="jx jy hi jt b fi jz ka l kb kc">pip install django==2.1.5<br/>pip install django-crispy-forms</span></pre><p id="691c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，让我们使用以下命令创建一个名为“my_project”的新项目:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="fc0b" class="jx jy hi jt b fi jz ka l kb kc">django-admin startproject my_project .</span></pre><p id="4fc9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">既然项目已经创建，让我们使用命令创建一个新的应用程序:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="3e79" class="jx jy hi jt b fi jz ka l kb kc">python manage.py startapp student</span></pre><p id="2667" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在settings.py文件中，我们将在INSTALLED_APPS添加学生应用程序和crispy表单库</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5c42" class="jx jy hi jt b fi jz ka l kb kc">INSTALLED_APPS = [<br/> ‘django.contrib.admin’,<br/> ‘django.contrib.auth’,<br/> ‘django.contrib.contenttypes’,<br/> ‘django.contrib.sessions’,<br/> ‘django.contrib.messages’,<br/> ‘django.contrib.staticfiles’,<br/> ‘student’,<br/> ‘crispy_forms’<br/>]</span></pre><p id="6e4e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在settings.py文件的末尾，我们将添加下面一行，将引导程序定义为crispy表单的模板包。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="0289" class="jx jy hi jt b fi jz ka l kb kc">CRISPY_TEMPLATE_PACK = ‘bootstrap4’</span></pre><p id="abe0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成这些更改后，我们将使用以下命令执行项目的第一次迁移:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="0408" class="jx jy hi jt b fi jz ka l kb kc">python manage.py migrate</span></pre><p id="f17e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行第一次迁移后，让我们在models.py文件中创建Student类</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="8ed1" class="jx jy hi jt b fi jz ka l kb kc">from django.db import models</span><span id="ab97" class="jx jy hi jt b fi kd ka l kb kc"># Create your models here.<br/>class Student(models.Model):<br/>    first_name = models.CharField(max_length=200)<br/>    last_name  = models.CharField(max_length=200)<br/>    resume     = models.TextField()</span><span id="2f6b" class="jx jy hi jt b fi kd ka l kb kc">    def __str__(self):<br/>        return self.first_name + ' ' + self.last_name</span></pre><p id="54ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们来迁移学生应用程序。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="f749" class="jx jy hi jt b fi jz ka l kb kc">python manage.py makemigrations student<br/>python manage.py migrate</span></pre><p id="6899" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们在学生应用程序中创建一个名为<em class="ke"> forms.py </em>的新文件，并编写表单:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="6c9f" class="jx jy hi jt b fi jz ka l kb kc">from .models import Student<br/>from django import forms</span><span id="5500" class="jx jy hi jt b fi kd ka l kb kc">class StudentForm(forms.ModelForm):<br/>    class Meta:<br/>        model  = Student<br/>        fields = ('first_name','last_name','resume')</span></pre><p id="8c67" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在表单已经准备好了，让我们编写视图:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d5cb" class="jx jy hi jt b fi jz ka l kb kc">from django.shortcuts import render<br/>from .models import Student<br/>from .forms import StudentForm<br/>from django.http import HttpResponse</span><span id="38b8" class="jx jy hi jt b fi kd ka l kb kc">def add_student(request):<br/>    form = StudentForm(request.POST or None)<br/>    if form.is_valid():<br/>        instance = form.save(commit=False)<br/>        instance.save()<br/>    return render(request,”student/student_form.html”,{‘form’:form})</span></pre><p id="b54c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在“我的项目”里面，在<em class="ke">的urls.py </em>文件<em class="ke">、</em>上我们会添加一个新的路径:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="3c4d" class="jx jy hi jt b fi jz ka l kb kc">from django.contrib import admin<br/>from django.urls import path<br/>from student.views import add_student</span><span id="9590" class="jx jy hi jt b fi kd ka l kb kc">urlpatterns = [<br/>    path('admin/', admin.site.urls),<br/>    path('add_student',add_student,name='add_student')<br/>]</span></pre><p id="4cc1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们转到模板列表中的<em class="ke"> settings.py </em>文件，我们将添加一个新目录，其中包含:</p><p id="5df6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ke"> os.path.join(BASE_DIR，' templates') </em></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="a377" class="jx jy hi jt b fi jz ka l kb kc">TEMPLATES = [<br/>    {<br/>        'BACKEND':'django.template.backends.django.DjangoTemplates',<br/>        'DIRS': [os.path.join(BASE_DIR,'templates')],<br/>        'APP_DIRS': True,<br/>        'OPTIONS': {<br/>            'context_processors': [<br/>                'django.template.context_processors.debug',<br/>                'django.template.context_processors.request',<br/>                'django.contrib.auth.context_processors.auth',<br/>             'django.contrib.messages.context_processors.messages',<br/>            ],<br/>        },<br/>    },<br/>]</span></pre><p id="c6cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，让我们创建“templates”目录，我们将在项目的根目录下创建它，位置与manage.py文件相同。</p><p id="3ad8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，让我们创建一个名为“模板”的文件夹。<br/>在“templates”文件夹中，我们将创建一个新文件夹“student ”,在“student”文件夹中，我们创建一个名为“student_form.html”的新文件</p><p id="e62d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在文件“student_form.html”中，我们将导入bootstrap并创建一个带有form标签的html表单。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="6275" class="jx jy hi jt b fi jz ka l kb kc">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/> &lt;meta charset="UTF-8"&gt;<br/> &lt;title&gt;Add Student&lt;/title&gt;<br/> &lt;link rel="stylesheet" href="<a class="ae kf" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css</a>" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="5dd8" class="jx jy hi jt b fi kd ka l kb kc">&lt;div class="container"&gt;</span><span id="5240" class="jx jy hi jt b fi kd ka l kb kc">&lt;h3 class="text-center"&gt;Students Form&lt;/h3&gt; <br/>&lt;form action="" method="POST"&gt; {% csrf_token %}<br/>  {{ form.as_p }}<br/>  &lt;button class="btn btn-primary"&gt;Add&lt;/button&gt;<br/> &lt;/form&gt;<br/>&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="f9a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下面的中，我们将用下面的代码行加载crispy _ forms:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="acd4" class="jx jy hi jt b fi jz ka l kb kc">{% load crispy_forms_tags %}</span></pre><p id="047a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们将把“{{form.as_p}}”改为:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="ece0" class="jx jy hi jt b fi jz ka l kb kc">{{ form|crispy }}</span></pre><p id="7fa4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最终文件将如下所示:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b93d" class="jx jy hi jt b fi jz ka l kb kc">&lt;!DOCTYPE html&gt;<br/>{% load crispy_forms_tags %}<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/> &lt;meta charset="UTF-8"&gt;<br/> &lt;title&gt;Add Student&lt;/title&gt;<br/> &lt;link rel="stylesheet" href="<a class="ae kf" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css</a>" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/> &lt;div class="container"&gt;<br/>  &lt;h3 class="text-center"&gt;Students Form&lt;/h3&gt;<br/>  &lt;form action="" method=""&gt; {% csrf_token %}<br/>   {{ form|crispy }}<br/>   &lt;button class="btn btn-primary"&gt;Add&lt;/button&gt;<br/>  &lt;/form&gt;<br/> &lt;/div&gt;<br/> <br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ac4a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在只要去<a class="ae kf" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/</a>add _ student</p><p id="d27d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还有……<br/> <br/>形式是程式化的！</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/b80dab4b003f9b01c34f75f2d88d22db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SedBzHoberK8VaGHiiJgOQ.png"/></div></div></figure><figure class="jo jp jq jr fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/c7b148f862a49aa6af4fb9f10d42e54d.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*xKh0n3u6qxu_HOtdbQVO-Q.gif"/></div></figure></div></div>    
</body>
</html>