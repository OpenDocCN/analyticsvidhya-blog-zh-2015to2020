<html>
<head>
<title>Bias vs Variance Trade-Off</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">偏差与方差的权衡</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bias-vs-variance-trade-off-99aa1acbe0ba?source=collection_archive---------37-----------------------#2020-04-06">https://medium.com/analytics-vidhya/bias-vs-variance-trade-off-99aa1acbe0ba?source=collection_archive---------37-----------------------#2020-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="21bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我试图解释两个关键术语，每个数据科学家都希望在决定训练模型时找到正确的平衡。在本文中，我们将浏览样本数据以及在训练模型和进行比较研究时偏差和方差的影响，并得出直观的结论。让我们开始吧。</p><h1 id="9acf" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">偏置</strong>:</h1><p id="3b14" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">正如我们所知，训练一个监督模型意味着给定的数据分布，其中生成数据的目标函数对我们来说是未知的。该模型旨在逼近目标函数，并产生接近数据中给出的实际/真实标签的输出。简单来说，偏差表示我们偏离真实值有多远。我们的目标是通过在训练过程中最小化损失函数来最小化偏差或误差。</p><p id="8bf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">损失函数公式如下:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="78a2" class="kp je hi kl b fi kq kr l ks kt">MSE = np.mean(np.sum(y-y_hat)**2) for all i data points<br/>MSE = Bias^2 + Variance + Irreducible error</span></pre><p id="c8e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是最小化损失函数的基本均方误差。MSE的另一个变量是偏差和方差。正如我们所见，误差取决于偏差和方差。为了减少误差，我们需要减少偏差和方差。然而，这样做有困难，我们将探讨如何克服这些困难。当我们浏览代码时，事情会变得更清楚。</p><p id="1bae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">需要记住的要点</strong>:偏差表示在最小化损失函数后，模型能够多好地预测输出未知数据的度量之一。</p><p id="04e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，高偏差表示不能依靠它对看不见的数据进行良好的模型预测。它未能捕获数据集中的输入特征与输出关系。在机器学习中，我们称之为欠拟合。</p><p id="378f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">出现欠拟合的场景:</strong></p><ul class=""><li id="792d" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">当我们只有很少的数据来建立一个精确的模型时，就会发生这种情况。</li><li id="ce64" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">当我们试图用非线性数据建立线性模型或未能捕捉到相关关系时。</li><li id="c865" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">在这种情况下，我们有高偏差和低方差，并且使用简单。</li></ul><p id="8499" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">方差</strong>:定义之一是——ML模型在不同组训练数据之间的预测精度相对于整体训练精度的变化。它表示模型对数据波动的敏感性。简而言之，如果我们从相同的未知分布中抽取不同的训练集，对未知数据预测的预测应该不会有太大变化，但如果模型具有较高的方差，则差异会很大。这种差异就是我们所说的高方差。</p><p id="30a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">高方差是什么意思？</p><p id="9cc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型深入捕获训练数据的细节，而不是对以前没有见过的数据进行概括。因此，它在训练数据上表现良好(因为偏差较低)，但在测试数据上有较高的错误率。这种机器学习被称为过度适应。</p><p id="74f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">发生过度拟合的情况:</strong></p><ul class=""><li id="e69e" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">数据有噪声，模型学习数据集中不重要的关系。</li><li id="f44b" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">当我们建立一个复杂的模型，如决策树，高次多项式函数和神经网络</li><li id="533d" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">在这种情况下，我们有高方差和低偏差。为了减少过拟合，我们使用添加到损失函数中的正则化。这简化了模型的复杂性，模型本身是一个单独的话题，改天再讨论。</li></ul><p id="0852" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们明白了，什么是极端“高方差和高偏差”理想情况“低偏差和低方差”，这实际上是不可能实现的，因为现实世界中的数据有噪声。所以我们需要做出权衡来建立一个好的模型。我们如何得到这样一个模型——让我们编码并理解症结所在。</p><h1 id="a97e" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">生成数据:</h1><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="2759" class="kp je hi kl b fi kq kr l ks kt"><strong class="kl hj">def</strong> gen_data(x):<br/>  b = 0.4<br/>  y_og = np.sin(x) + np.exp(-x**2)<br/>  y_noise = t + np.random.uniform(-b,b,len(x))<br/>  <strong class="kl hj">return</strong> y_noise</span><span id="cc0b" class="kp je hi kl b fi li kr l ks kt">x = np.arange(0,4*np.pi,0.2)<br/>y_orig = gen_data(x)<br/><br/>plt.plot(x,y_orig,'o')<br/>plt.grid()</span></pre><figure class="kg kh ki kj fd lk er es paragraph-image"><div class="er es lj"><img src="../Images/a77cb07570de6436a02dc01a83f900ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*Wk_kmnnV7al0_EG_Tk6eMg.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">生成的总数据量</figcaption></figure><h1 id="02cc" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">采样数据:</h1><p id="18e5" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在这个代码片段中，如前所述，为了计算方差，我们随机抽取一个训练集样本，并拟合p_val变量中传递的多项式次数的数据。用多度拟合数据并不总是正确的，它取决于数据分布。在这里，保利最适合伪造数据。</p><p id="fb6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们预测原始数据并存储在y_pred中，我们将使用它来计算偏差和方差，因为我们在y_orig中有原始输出标签值可以与之比较。对于不同的多项式阶和给定的num_trails，该过程继续进行。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="6ee8" class="kp je hi kl b fi kq kr l ks kt"><strong class="kl hj">for</strong> j <strong class="kl hj">in</strong> range(num_trials):<br/>   x_sub, y= get_rand_subsets(0.7, x, y_orig)<br/>   p = np.poly1d(np.polyfit(x_sub, y, p_val))<br/>   P.append(p)<br/>   y_pred = y_pred + p(x)</span></pre><p id="658a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过所有的计算，我们得到了这样的图形。</p><figure class="kg kh ki kj fd lk er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lr"><img src="../Images/e50b39391aa2bd1a3a47b07ce5f555bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tGqeugM05rjrBfnSDSNrg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">用不同的多项式次数拟合数据</figcaption></figure><p id="2ac8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lw">观察:</em> </strong></p><p id="f60b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">左边简单的线性线似乎对数据进行了欠拟合，因为偏差很大。随着我们增加poly顺序，我们可以看到它试图学习数据，从而减少了偏差，但增加了方差。在最右边，我们可以说模型过度拟合了。在每种情况下，我们计算发生的误差，并在以后用于绘图。</p><h1 id="0142" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">偏差和方差计算:</h1><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="5157" class="kp je hi kl b fi kq kr l ks kt">#Bias<br/>y_pred = y_pred/num_trials<br/>bias = np.linalg.norm(y_pred-y_orig)<br/>biases.append(bias)</span><span id="3171" class="kp je hi kl b fi li kr l ks kt">#Variance<br/><strong class="kl hj">for</strong> j <strong class="kl hj">in</strong> range(num_trials):<br/>  p_t = P.pop(0)<br/>  var = var + np.square(p_t(x)-y_pred)</span><span id="6a6f" class="kp je hi kl b fi li kr l ks kt">var = var/num_trials<br/>variance = np.linalg.norm(var)<br/>variances.append(variance)</span></pre><p id="b355" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这段代码中，我们获得了所有训练集的y_pred的平均预测值，并计算了原始标签值的缺失值，以获得给定多边形阶数的偏差。</p><p id="6223" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于方差，我们检查每个试验/训练集偏离均值预测的程度，并存储给定多边形顺序的总体方差。</p><h1 id="ea17" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">剧情与直觉:</strong></h1><figure class="kg kh ki kj fd lk er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lx"><img src="../Images/545ba3b76f8eebd0f25fbba51440defc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Biy_BpNSgxqgXF34x7mBbA.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">权衡图</figcaption></figure><p id="f352" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如之前在误差公式中看到的，我们可以观察到7阶多边形似乎是一个很好的拟合，其中误差、偏差和方差最小，并且模型处于稳定状态。</p><p id="1e67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，适当选择适当模型的优点是:</p><ul class=""><li id="f55c" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">防止训练复杂模型。</li><li id="e42e" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">对看不见的数据进行归纳</li><li id="1ca0" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">由于我们的模型已经达到最小误差，我们有信心获得更好的准确性/预测。</li></ul><h1 id="b408" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结束:</h1><p id="e1b9" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这是我试图用更简单的方式来解释这个概念。我感谢Chinmay Hedge教授(NYU坦登工程学院)通过代码展示的工作，更直观地解释了这个概念。</p><p id="2518" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码可在<a class="ae ly" href="https://github.com/Darshansol9/Bais_Vs_Variance" rel="noopener ugc nofollow" target="_blank">https://github.com/Darshansol9/Bais_Vs_Variance</a>找到</p><p id="537a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请随意评论，如果你喜欢这篇文章，请给我hifi。</p><p id="9f66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！</p><p id="7499" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考文献:</p><div class="lz ma ez fb mb mc"><a href="https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-165e6942b229" rel="noopener follow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hj fi z dy mh ea eb mi ed ef hh bi translated">理解偏差-方差权衡</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">每当我们讨论模型预测时，理解预测误差(偏差和方差)是很重要的。有一个…</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">towardsdatascience.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq ll mc"/></div></div></a></div></div></div>    
</body>
</html>