<html>
<head>
<title>A Quick Example Using LSTM in Stock Market Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用LSTM预测股市的一个简单例子</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-quick-example-using-pytorch-lstm-in-stock-market-prediction-98afe1aeafe5?source=collection_archive---------19-----------------------#2020-12-02">https://medium.com/analytics-vidhya/a-quick-example-using-pytorch-lstm-in-stock-market-prediction-98afe1aeafe5?source=collection_archive---------19-----------------------#2020-12-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e72588a80a59616b6d2a0163c839fec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WfXAou8UTK06SriiFv5EHQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae iu" href="https://pxhere.com/en/photo/970962" rel="noopener ugc nofollow" target="_blank">https://pxhere.com/en/photo/970962</a></figcaption></figure><p id="e4ac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">LSTM是进行时间序列预测的一个非常方便的工具，所以它可以用于股票市场估计也就不足为奇了。在这里，我们给出一个快速演示，为纳斯达克指数预测构建一个2层无状态LSTM，它改编自<a class="ae iu" href="https://www.kaggle.com/taronzakaryan/stock-prediction-lstm-using-pytorch" rel="noopener ugc nofollow" target="_blank">这个Kaggle版本</a>，做了一些小的调整。Jupyter笔记本代码在这里提供<a class="ae iu" href="https://gist.github.com/adoskk/c3d96e4c7ae15a48c2a9ea8bc835ca39" rel="noopener ugc nofollow" target="_blank">，而用过的股票数据可以在这里</a>找到<a class="ae iu" href="https://drive.google.com/file/d/1Ab9DLNSSxhxEnZAJj177PALusithMlD6/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">(感谢我的朋友Will拿出股票数据)。</a></p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="6c91" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，让我们讨论如何解决这个问题。</p><p id="c8b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对LSTM来说，最重要的事情是将数据重新格式化成序列，并决定相应的输入和输出大小。在给定的例子中，我们只有一个253个值的长序列(假设我们只是使用‘Close’列), LSTM不能有效地学习这个。因此，第一项任务是将这些数据分解成更小的部分。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/f3671b0d1841c502bc232ba228098d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*-KqEf-gthiziSwNZdOtFEQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们使用的数据是由253个标量值组成的单列</figcaption></figure><p id="c6df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我们想做预测，一个自然的思考方式是，用一个比给定的253天更短的时间段来预测。在这个<a class="ae iu" href="https://www.kaggle.com/taronzakaryan/stock-prediction-lstm-using-pytorch" rel="noopener ugc nofollow" target="_blank"> Kaggle版本</a>中，我们使用之前的19天来预测第20天，但是用户可以将这个数字更改为任何序列长度，并查看这是否会改善结果。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/ae8508d7486af620dd232aeb3f22f60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLIhLqlh9TfLfmPMSklmUQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">序列长度=20。这里的输入X是前19天的序列，而输出Y是单个标量，是第20天的预测值。</figcaption></figure><p id="df9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，我们通过除以10000(如果您使用不同的标度，请更改数字)来标准化所有股票值，以避免神经元饱和现象，否则，<a class="ae iu" href="https://datascience.stackexchange.com/questions/22047/time-series-forecasting-with-rnnstateful-lstm-produces-constant-values" rel="noopener ugc nofollow" target="_blank">预测可能会变成常数</a>。</p><p id="c70b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，LSTM的建筑简单地遵循标准的建设。由于它是无状态的LSTM，我们在每次训练时将隐藏状态重置为0。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="2639" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个原始的结果，我们可以看到预测几乎代表了真实指数值的趋势。所以我们的模式是成功的！</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/a49430d0d5a2cc97c1a6d4d936634d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXif2ldUB-g2JfjU1ndfKQ.png"/></div></div></figure></div></div>    
</body>
</html>