<html>
<head>
<title>Road Object Detection using YOLOv3 and Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于YOLOv3和Keras的道路目标检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/road-object-detection-using-yolov3-and-keras-1af4edcee17?source=collection_archive---------11-----------------------#2019-11-14">https://medium.com/analytics-vidhya/road-object-detection-using-yolov3-and-keras-1af4edcee17?source=collection_archive---------11-----------------------#2019-11-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="80b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我作为应用人工智能课程的一部分的第一个自我案例研究。我在LinkedIn上看到许多展示物体探测的帖子，这让我兴奋地尝试自己做一些类似的事情。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/4e7078b0cdd4ac07327e6e5276106da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*1o4UCD8TLxm7ibcfb4Mp6w.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">我的案例研究的最终结果</figcaption></figure><p id="71bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我决定把物体检测作为我的案例研究。然后我想到了以下问题:</p><ol class=""><li id="d15e" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">要检测什么对象？</li><li id="d0a5" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">我应该使用哪个数据集？</li><li id="50cb" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">我有哪些计算资源？</li><li id="64f1" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">我应该使用哪种对象检测模型？</li><li id="5114" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">我应该使用哪个平台来训练/测试模型？</li></ol><p id="c476" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如今，自动驾驶汽车是一个热门话题。在这种汽车中，底层感知系统检测行人和车辆。我知道这可以通过物体检测来实现，所以我决定选择这个话题。</p><p id="feeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我主要担心的是，我没有GPU，所以首先我决定使用Google collaboratory作为训练和测试平台。有许多自动驾驶汽车和道路对象数据集可用，如BDD100k、Kitty、Pascal VOC等。我只有很少的时间来完成我的案例研究，collab还有以下两个限制:</p><ol class=""><li id="7b65" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">它的运行时间为12小时。12小时后，我们必须重新连接，导致所有变量和数据丢失。</li><li id="5748" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">此外，我们不能让会话空闲超过1.5小时。</li></ol><p id="af46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑到所有的限制，我选择Pascal VOC作为我的训练和验证数据集。</p><p id="2851" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">说到基于深度学习的对象检测，您会遇到三种主要的对象检测器:</p><ul class=""><li id="43eb" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc kd jv jw jx bi translated">R- CNN及其变体，包括原始R-CNN、快速R-CNN和更快R-CNN</li><li id="b0c6" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc kd jv jw jx bi translated">单触发检测器(SSDs)</li><li id="70d4" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc kd jv jw jx bi translated">YOLO</li></ul><p id="07a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">r-CNN是首批基于深度学习的对象检测器之一，是<strong class="ih hj"> <em class="ke">两阶段检测器的一个例子。</em>T3】</strong></p><ol class=""><li id="c05f" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">在第一个R-CNN出版物中，<a class="ae kf" href="https://arxiv.org/abs/1311.2524" rel="noopener ugc nofollow" target="_blank"> <em class="ke">用于精确对象检测和语义分割的丰富特征层次</em> </a> , (2013) Girshick等人提出了一种对象检测器，该检测器需要诸如<a class="ae kf" href="http://www.huppelen.nl/publications/selectiveSearchDraft.pdf" rel="noopener ugc nofollow" target="_blank">选择性搜索</a>(或等效物)的算法来提出可能包含对象的候选边界框。</li><li id="4a32" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">这些区域然后被传递到CNN进行分类，最终导致了第一批基于深度学习的对象检测器之一。</li></ol><p id="7548" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">标准的R-CNN方法的问题在于，它<em class="ke">非常慢</em>并且不是一个完整的端到端物体检测器。</p><p id="d45b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了帮助提高基于深度学习的对象检测器的速度，单次检测器(SSD)和YOLO都使用了<strong class="ih hj"> <em class="ke">一级检测器策略</em> </strong>。</p><p id="5f17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些算法将对象检测视为回归问题，采用给定的输入图像，同时学习边界框坐标和相应的类别标签概率。</p><p id="0ff1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">一般来说，单级检测机往往不如两级检测机精确<em class="ke">，但速度却快得多。</em>T3】</strong></p><div class="je jf jg jh fd ab cb"><figure class="kg ji kh ki kj kk kl paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><img src="../Images/ebce1eff70019e9a9ec0923cc2217bb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*aFeEgXtb0ar-Zrxujmu1oA.png"/></div></figure><figure class="kg ji kq ki kj kk kl paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><img src="../Images/8b6587015c2efab45ee5f0edc8b57370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*5CuBLYaOLACUNj7jpYwDcQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx kr di ks kt translated">原YOLOv3预测结果(图片来源:【https://pjreddie.com/darknet/yolo/】T4)</figcaption></figure></div><p id="c2f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">YOLO是单级检波器的一个很好的例子。</p><p id="93c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">雷德蒙和法尔哈迪最近发表了一篇新的YOLO论文，<a class="ae kf" href="https://arxiv.org/abs/1804.02767" rel="noopener ugc nofollow" target="_blank"> <em class="ke"> YOLOv3:增量改进</em> </a> (2018)。YOLOv3速度极快，精度极高。在以. 5测量的mAP中，IOU YOLOv3与焦点损耗相当，但速度快4倍左右。此外，你可以简单地通过改变模型的大小在速度和准确性之间进行权衡，不需要重新训练！</p><p id="ffb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在收集了上述信息后，我决定将YOLOv3用于我的案例研究，并将Pascal VOC作为训练数据集。</p><p id="f0c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pascal VOC数据集由20个标签组成，包括但不限于:</p><ul class=""><li id="8c51" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc kd jv jw jx bi translated"><em class="ke">人:</em>人</li><li id="ce5e" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc kd jv jw jx bi translated"><em class="ke">交通工具:</em>自行车、公交车、汽车、摩托车等</li><li id="d40d" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc kd jv jw jx bi translated">…其他一些课程。</li></ul><p id="1327" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢GitHub用户<strong class="ih hj"> <em class="ke"> qqwweee </em> </strong>制作了YOLOv3的Keras实现，该实现已经在PASCAL数据集上进行了训练，但我想在自己创建的注释和锚点以及包含人物和车辆的图像上进行训练。</p><p id="8235" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我按照程序转换了Keras中的YOLOv3重量。我在collab上下载了数据集，并开始使用所需的训练和验证数据集进行训练。</p><p id="b101" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我得到了10.687的验证损失，我肯定可以通过更多的训练来改善，但我在这个阶段停止了。我只有很少的时间来做这些事情，而且由于协作限制，很多时候我丢失了所有的数据和训练课程。此后，减少损失是一个非常缓慢的过程。</p><p id="7b77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我决定在这个阶段测试我的模型，我得到的结果并没有那么糟糕！</p><p id="9f9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">未来增强功能:</strong></p><p id="27d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在未来，我想对这个模型进行更多时代的训练，以获得更好的结果。我将使用像BDD100K这样的数据集来尝试这个模型，以训练我的模型来检测其他道路对象，如交通灯、交通标志、车道线、道路损坏/坑洞。</p><p id="09bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考文献:</strong></p><ol class=""><li id="c041" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><a class="ae kf" href="https://pjreddie.com/darknet/yolo/" rel="noopener ugc nofollow" target="_blank">https://pjreddie.com/darknet/yolo/</a></li><li id="56a0" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kf" href="https://github.com/qqwweee/keras-yolo3" rel="noopener ugc nofollow" target="_blank">https://github.com/qqwweee/keras-yolo3</a></li><li id="c893" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kf" href="https://www.pyimagesearch.com/2017/09/11/object-detection-with-deep-learning-and-opencv/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2017/09/11/object-detection-with-deep-learning-and-opencv/</a></li><li id="bd1f" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae kf" href="https://www.pyimagesearch.com/2018/11/12/yolo-object-detection-with-opencv/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2018/11/12/yolo-object-detection-with-opencv/</a></li></ol></div></div>    
</body>
</html>