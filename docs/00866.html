<html>
<head>
<title>Similarity Measures for Content Based Recommendation Systems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于内容的推荐系统的相似性度量</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/similarity-measures-for-content-based-recommendation-systems-1be7c652c8ac?source=collection_archive---------9-----------------------#2019-09-14">https://medium.com/analytics-vidhya/similarity-measures-for-content-based-recommendation-systems-1be7c652c8ac?source=collection_archive---------9-----------------------#2019-09-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="55d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于推荐系统，尤其是基于内容的推荐系统，要推荐的产品之间的相似性成为一个重要的衡量标准。</p><p id="1cbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们举个例子来理解基于内容的推荐。</p><p id="d8de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设一个朋友来找你寻求电影建议。我们不会随意地给电影取名字，相反，我们会记住朋友对电影类型的喜好，并相应地向他们推荐电影。基于内容的推荐系统采用相同的方法。</p><p id="3ce7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑一个场景，其中用户正在查看一组特定的产品。基于用户正在查看的产品的属性，我们可以推荐具有相似属性的产品。一些基于内容的推荐系统对底层数据中可用的各种特征使用多种相似性度量。</p><p id="55f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将使用两种相似性度量方法:</p><p id="837a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1 —皮尔逊系数和</p><p id="fda1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2-余弦相似性</p><p id="08fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用的数据集将是UCI机器学习知识库上可用的葡萄酒数据集。代码实现在R中(R版本3.5.3，RStudio 1.1.447)。我建议你也这样做，以便更好地理解这个过程。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="61db" class="jm jn hi ji b fi jo jp l jq jr">&gt; library(data.table)<br/>&gt; wine.data &lt;- fread("<a class="ae js" href="https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data</a>")</span></pre><p id="af71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下载完数据集后，让我们探索一下其中的数据。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c9c9" class="jm jn hi ji b fi jo jp l jq jr">&gt; head(wine.data)<br/>   V1    V2   V3   V4   V5  V6   V7   V8   V9  V10  V11  V12  V13  V14<br/>1:  1 14.23 1.71 2.43 15.6 127 2.80 3.06 0.28 2.29 5.64 1.04 3.92 1065<br/>2:  1 13.20 1.78 2.14 11.2 100 2.65 2.76 0.26 1.28 4.38 1.05 3.40 1050<br/>3:  1 13.16 2.36 2.67 18.6 101 2.80 3.24 0.30 2.81 5.68 1.03 3.17 1185<br/>4:  1 14.37 1.95 2.50 16.8 113 3.85 3.49 0.24 2.18 7.80 0.86 3.45 1480<br/>5:  1 13.24 2.59 2.87 21.0 118 2.80 2.69 0.39 1.82 4.32 1.04 2.93  735<br/>6:  1 14.20 1.76 2.45 15.2 112 3.27 3.39 0.34 1.97 6.75 1.05 2.85 1450</span></pre><p id="9bcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">元数据说V1代表“栽培品种”,这基本上是基于化学性质的组合对葡萄酒的分类。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c3e1" class="jm jn hi ji b fi jo jp l jq jr">&gt; table(wine.data$V1)</span><span id="3ae2" class="jm jn hi ji b fi jt jp l jq jr">1  2  3 <br/>59 71 48</span></pre><p id="327f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集具有3种不同类型的“栽培品种”特征。从V2到V14列是葡萄酒的不同化学特性。</p><p id="2cda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的下一步将是把酒的类型和酒的化学性质分成两个不同的数据集。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f6bd" class="jm jn hi ji b fi jo jp l jq jr">&gt; wine_type &lt;- wine.data[,1]<br/>&gt; wine_features &lt;- wine.data[,-1]</span></pre><p id="515d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以从数据集中看到，要素具有不同的取值范围。在计算相似性指数或对葡萄酒属性进行矢量化时，这可能是个问题。为了解决这个问题，我们可以对所有要素的值进行缩放，以保持值的一致性。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b350" class="jm jn hi ji b fi jo jp l jq jr">&gt; wine_features &lt;- data.frame(scale(wine_features))<br/>&gt; head(wine_features)<br/>         V2          V3         V4         V5         V6        V7        V8         V9        V10<br/>1 1.5143408 -0.56066822  0.2313998 -1.1663032 1.90852151 0.8067217 1.0319081 -0.6577078  1.2214385<br/>2 0.2455968 -0.49800856 -0.8256672 -2.4838405 0.01809398 0.5670481 0.7315653 -0.8184106 -0.5431887<br/>3 0.1963252  0.02117152  1.1062139 -0.2679823 0.08810981 0.8067217 1.2121137 -0.4970050  2.1299594<br/>4 1.6867914 -0.34583508  0.4865539 -0.8069748 0.92829983 2.4844372 1.4623994 -0.9791134  1.0292513<br/>5 0.2948684  0.22705328  1.8352256  0.4506745 1.27837900 0.8067217 0.6614853  0.2261576  0.4002753<br/>6 1.4773871 -0.51591132  0.3043010 -1.2860793 0.85828399 1.5576991 1.3622851 -0.1755994  0.6623487<br/>         V11        V12       V13         V14<br/>1  0.2510088  0.3611585 1.8427215  1.01015939<br/>2 -0.2924962  0.4049085 1.1103172  0.96252635<br/>3  0.2682629  0.3174085 0.7863692  1.39122370<br/>4  1.1827317 -0.4263410 1.1807407  2.32800680<br/>5 -0.3183774  0.3611585 0.4483365 -0.03776747<br/>6  0.7298108  0.4049085 0.3356589  2.23274072</span></pre><p id="7c76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于R中的大多数相似性函数要求输入数据是矩阵格式，我们可以将数据集转换成矩阵形式，并为数据分配行名。数据集中的每一行都表示矢量格式的葡萄酒属性。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="6b71" class="jm jn hi ji b fi jo jp l jq jr">&gt; wine_mat &lt;- data.matrix(wine_features)<br/>&gt; rownames(wine_mat) &lt;- seq(1:dim(wine_features)[1])<br/>&gt; wine_mat[1:2,]<br/>         V2         V3         V4        V5         V6        V7        V8         V9        V10        V11<br/>1 1.5143408 -0.5606682  0.2313998 -1.166303 1.90852151 0.8067217 1.0319081 -0.6577078  1.2214385  0.2510088<br/>2 0.2455968 -0.4980086 -0.8256672 -2.483841 0.01809398 0.5670481 0.7315653 -0.8184106 -0.5431887 -0.2924962<br/>        V12      V13       V14<br/>1 0.3611585 1.842721 1.0101594<br/>2 0.4049085 1.110317 0.9625263</span></pre><p id="23d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们转置矩阵，这样我们就有了每种葡萄酒的所有属性映射。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="a14c" class="jm jn hi ji b fi jo jp l jq jr">&gt; wine_mat &lt;- t(wine_mat)</span></pre><p id="21f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们每行代表一种葡萄酒。换句话说，每一行都有葡萄酒的几个属性。我们将使用皮尔逊系数来寻找葡萄酒之间的相似性。皮尔逊系数衡量两个变量之间的相关性。在我们的例子中，每一行都被视为一个变量。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="3617" class="jm jn hi ji b fi jo jp l jq jr">&gt; cor_matrix &lt;- cor(wine_mat, use = "pairwise.complete.obs", method = "pearson")<br/>&gt; dim(cor_matrix)<br/>[1] 178 178<br/>&gt; cor_matrix[1:5,1:5]<br/>          1          2         3             4             5<br/>1 1.0000000  0.7494842 0.5066551  0.7244043066  0.1850897291<br/>2 0.7494842  1.0000000 0.4041662  0.6896539740 -0.1066822182<br/>3 0.5066551  0.4041662 1.0000000  0.5985843958  0.1520360593<br/>4 0.7244043  0.6896540 0.5985844  1.0000000000 -0.0003942683<br/>5 0.1850897 -0.1066822 0.1520361 -0.0003942683  1.0000000000</span></pre><p id="158a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的输出中我们可以看到，生成的矩阵大小为178 x178。这意味着每种葡萄酒与数据集中的其他葡萄酒相比都有相似性得分。所有对角元素。也就是说，每种葡萄酒彼此之间的相似性得分都是满分。正数将显示正相关，同样，负数在结果矩阵中也是如此。</p><p id="afec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看如何使用这个相似度矩阵根据用户的葡萄酒选择来推荐葡萄酒。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="7958" class="jm jn hi ji b fi jo jp l jq jr">&gt; user_view &lt;- wine_features[3,]<br/>&gt; user_view<br/>         V2         V3       V4         V5         V6        V7       V8        V9      V10       V11<br/>3 0.1963252 0.02117152 1.106214 -0.2679823 0.08810981 0.8067217 1.212114 -0.497005 2.129959 0.2682629<br/>        V12       V13      V14<br/>3 0.3174085 0.7863692 1.391224<br/>&gt; sim_items &lt;- cor_matrix[3,]<br/>&gt; sim_items.sorted &lt;- sort(sim_items, decreasing = TRUE)<br/>&gt; sim_items.sorted[1:5]<br/>        3        52        51        85        15 <br/>1.0000000 0.7719273 0.7606256 0.7475886 0.7325499</span></pre><p id="0dee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们最后可以看到，酒号52、52、85和15与用户最初查看的酒号3相似。</p><p id="0f4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以从向量空间模型中考虑一些其他方法来找到相似性，如欧几里德距离或余弦相似性。</p><p id="bdca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们继续讨论余弦相似性，并在R:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="fdca" class="jm jn hi ji b fi jo jp l jq jr">&gt; library("lsa")<br/>&gt; cor_matrix = cosine(wine_mat)<br/>&gt; dim(cor_matrix)<br/>[1] 178 178<br/>&gt; cor_matrix[1:5,1:5]<br/>          1          2         3         4          5<br/>1 1.0000000  0.5622599 0.6726599 0.8107890  0.4871602<br/>2 0.5622599  1.0000000 0.2368420 0.4871792 -0.1573216<br/>3 0.6726599  0.2368420 1.0000000 0.7461053  0.5227389<br/>4 0.8107890  0.4871792 0.7461053 1.0000000  0.4043439<br/>5 0.4871602 -0.1573216 0.5227389 0.4043439  1.0000000</span></pre><p id="12fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经使用了库“lsa”来使用其中的余弦函数。输出是相同的矩阵，它给出了数据集中每种葡萄酒与其他每种葡萄酒之间的余弦相似性。</p><p id="a82e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们再次测试它，向用户推荐葡萄酒选择。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f327" class="jm jn hi ji b fi jo jp l jq jr">&gt; user_view &lt;- wine_features[3,]<br/>&gt; user_view<br/>         V2         V3       V4         V5         V6        V7       V8        V9      V10       V11<br/>3 0.1963252 0.02117152 1.106214 -0.2679823 0.08810981 0.8067217 1.212114 -0.497005 2.129959 0.2682629<br/>        V12       V13      V14<br/>3 0.3174085 0.7863692 1.391224<br/>&gt; sim_items &lt;- cor_matrix[3,]<br/>&gt; sim_items.sorted &lt;- sort(sim_items, decreasing = TRUE)<br/>&gt; sim_items.sorted[1:5]<br/>        3        31        52        49        56 <br/>1.0000000 0.8271992 0.8192096 0.8137115 0.8057562</span></pre><p id="4b4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，根据余弦相似度，与3号酒相似的酒是31号酒、52号酒、49号酒和56号酒。</p><p id="17ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总之，在向量空间模型中有如此多的相似性方法，人们可以对它们进行实验，并选择最适合人们寻求解决的用例的方法。</p></div></div>    
</body>
</html>