<html>
<head>
<title>Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-a8e3d7c2e5ee?source=collection_archive---------20-----------------------#2020-04-23">https://medium.com/analytics-vidhya/logistic-regression-a8e3d7c2e5ee?source=collection_archive---------20-----------------------#2020-04-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f588" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归是监督学习分类算法。在这个算法中，目标属性或因变量是二分的，这意味着只有两个可能的类。简而言之，因变量本质上是二进制的，数据编码为1(代表是/肯定/成功)或0(代表否/否定/失败)。它用于估计一个实例属于特定类的概率。</p><p id="21bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用给定的逻辑函数，</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/8efde0c683e0da342d595cc4f49aa00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*zz3s8DovQcY7u9_-0dGYEQ.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jl"><img src="../Images/93a7d3d2f41be79591970b30d51d5ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*EvpNwNHLUIWksyugWNHt2g.png"/></div></figure><p id="5024" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑函数具有以下特征:<br/>其值在0和1之间。<br/>收敛于1，趋近于+∞。<br/>收敛到0，趋近于-∞。<br/>是平滑对称的曲线。</p><p id="d72f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用scikit学习Python中的逻辑回归:</strong></p><p id="79a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在给定的例子中，我们已经确定了泰坦尼克号上有多少人幸存，有多少人没有。为此，我们必须导入所需的库。</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="fa78" class="jr js hi jn b fi jt ju l jv jw">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.metrics import classification_report,confusion_matrix,accuracy_score</span></pre><p id="756d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下命令用于使用pandas读取CSV文件。<br/>下载数据集:<a class="ae jx" href="https://www.kaggle.com/hesh97/titanicdataset-traincsv" rel="noopener ugc nofollow" target="_blank">点击此处</a></p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="a166" class="jr js hi jn b fi jt ju l jv jw">df=pd.read_csv('/content/drive/My Drive/titanic.csv')<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jy"><img src="../Images/7543ab1b0a85a43185a68e443e5ef7ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KqnJkBf0Hb4P_h-gNCWzdA.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">泰坦尼克号. csv</figcaption></figure><p id="8046" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可视化数据:</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="3c4f" class="jr js hi jn b fi jt ju l jv jw">df.hist()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kh"><img src="../Images/56bc0a362f0c468262c7b7daefe90647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_aHp5OZbavWNwnI0CbKlrg.png"/></div></div></figure><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="bb98" class="jr js hi jn b fi jt ju l jv jw">sns.countplot(x = 'Survived',data = df)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ki"><img src="../Images/ac27abeea7a4bd4a4e260f5bdf7f8d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*wxzq23itDkC1Bi4RdqSPrQ.png"/></div></figure><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="a71f" class="jr js hi jn b fi jt ju l jv jw">sns.countplot(x = ’Survived’,hue = ’Sex’,data = df)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/9b6b7b2730662e91667f6197f1afefad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*mebNJq_UPQaMJD8hdTIbTA.png"/></div></figure><p id="6f28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据预处理:</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="4167" class="jr js hi jn b fi jt ju l jv jw">df.isnull().sum()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kk"><img src="../Images/162255346087fa2f4ab3f65007cb23ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*Zw4w_2r9Sxkr8pgzBLiW1w.png"/></div></figure><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="2307" class="jr js hi jn b fi jt ju l jv jw">sns.heatmap(df.isnull(),yticklabels = False)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/ae5581d9308d144405e17960c87da269.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*AiTuwr8H0sQbmsLJw7zAhA.png"/></div></figure><p id="e22c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将分类变量转换为指示变量</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="73fb" class="jr js hi jn b fi jt ju l jv jw">sex = pd.get_dummies(df[‘Sex’])<br/>sex</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es km"><img src="../Images/c9ff41b83d8861ee2154e43cd3f66781.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*6MIStsy7cdY_StjgHmWo4Q.png"/></div></figure><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="6c21" class="jr js hi jn b fi jt ju l jv jw">embarked = pd.get_dummies(df[‘Embarked’])<br/>embarked</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kn"><img src="../Images/601c67c47d9ee1f4ec4c0283381a2dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*O3TRR_5bpdjbWvHirXPLCw.png"/></div></figure><p id="4612" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从数据集中删除不必要的列</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="7c1a" class="jr js hi jn b fi jt ju l jv jw">df.drop([‘Sex’,’Embarked’,’PassengerId’,’Name’,’Ticket’,’Fare’,’Cabin’,’Parch’,’SibSp’,’Age’],axis=1,inplace=True)</span></pre><p id="8fd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">连接所需的列</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="9058" class="jr js hi jn b fi jt ju l jv jw">df=pd.concat([df,sex,e],axis=1)<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ko"><img src="../Images/863c44a79981a454226a65cf0dbc7bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*xsTCemUzs8aLnPkQLEFoQQ.png"/></div></figure><p id="9908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集分为“属性”和“标签”。属性是自变量，而标签是因变量，其值将被预测。在这个例子中，Pclass、sex、embarked是自变量，而Survived是因变量。</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="3248" class="jr js hi jn b fi jt ju l jv jw">X = df.drop(“Survived”,axis=1)<br/>y = df[“Survived”]</span></pre><p id="95b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练和测试数据:</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="f773" class="jr js hi jn b fi jt ju l jv jw">X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=1)</span></pre><p id="79da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在将数据分成训练集和测试集之后，是时候训练我们的算法了。为此我们使用了逻辑回归</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="8dd1" class="jr js hi jn b fi jt ju l jv jw">model = LogisticRegression()<br/>model.fit(X_train,y_train)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kp"><img src="../Images/a5b93f559c0d62b6cba4fa4437da4b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*vJ9lbxxsCnj33YXqb9lh7g.png"/></div></figure><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="0569" class="jr js hi jn b fi jt ju l jv jw">y_pred = model.predict(X_test)<br/>y_pred</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kq"><img src="../Images/32d6d44d74506d7fa6564d61fdff50eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*ASbktgBqL6_szCSCkdzo_A.png"/></div></figure><p id="a5af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显示混淆矩阵:<br/>混淆矩阵是对一个分类问题的预测结果的总结。正确和错误预测的数量用计数值汇总，并按每个类别细分。</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="92c2" class="jr js hi jn b fi jt ju l jv jw">confusion_matrix(y_test,y_pred)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/c000c999dd326ebf518ef15c1be9c27f.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*7TIhPurTYAQoTKiLerqIXA.png"/></div></figure><p id="7c4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">找出准确度分数</p><pre class="je jf jg jh fd jm jn jo jp aw jq bi"><span id="79cc" class="jr js hi jn b fi jt ju l jv jw">print(‘Accuracy Score:’,accuracy_score(y_test,y_pred)*100)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/35a1cb10bf018bcaef4a30c3128de8f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*HPgWB6cYk0Qg_t4ytn0Ivg.png"/></div></figure><p id="e099" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论:</strong> <br/>本文研究了机器学习算法，即逻辑回归。<br/>我们使用scikit learn实现了逻辑回归。</p><p id="8e9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你们理解如何实现逻辑回归。请在评论区告诉我你的疑问和建议。</p><p id="b81f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐学习！！</p></div></div>    
</body>
</html>