<html>
<head>
<title>Movie Tag Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电影标签预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/movie-tag-prediction-dcdd2f86fcd1?source=collection_archive---------13-----------------------#2020-02-15">https://medium.com/analytics-vidhya/movie-tag-prediction-dcdd2f86fcd1?source=collection_archive---------13-----------------------#2020-02-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e839" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">浪漫的、恐怖的、虚构的</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3d8fa3c965a66ae45cb0b4e6c5669489.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2z6yMjkuUHFWk8lfm2eHw.png"/></div></div></figure><p id="c82e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果给定了电影名，有机会得到电影的类型吗？</p><p id="217b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不，但是如果你在那里提供电影的概要，那么我们可以建立一个机器学习模型来预测这部电影的类型，哦，真的吗？那怎么做呢？</p><p id="d63b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">电影的概要对于建立机器学习模型来预测电影的标签是有价值的，这可以帮助推荐系统检索相似的电影。</p><p id="9533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，让我告诉你，在知道如何建立一个电影标签预测模型之前，你必须清楚一些概念。这篇文章的主旨是假设读者在进一步讨论之前对下面的主题感到满意。</p><ol class=""><li id="26f6" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">Nlp特征化技术。</li><li id="f428" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">像<a class="ae kd" rel="noopener" href="/@yernagulahemanth/logistic-regression-part-i-40d8fed8fdd4">逻辑回归</a>这样的机器学习算法。</li><li id="4033" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">Python。</li></ol><p id="3615" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">内容</strong></p><ol class=""><li id="2e7a" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">数据概述</li><li id="56bb" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">清理和预处理数据</li><li id="40f4" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">特征化数据</li><li id="758b" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">应用模型</li></ol><p id="98c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据概述:</strong>用于构建该模型的数据取自<a class="ae kd" href="https://www.kaggle.com/cryptexcode/mpst-movie-plot-synopses-with-tags" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>，如图1所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ke"><img src="../Images/b8fe73d1896442b5fbde013f1f97e794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwLJpvk-YtqhnZknwvKp2w.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图1</figcaption></figure><p id="9b44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">栏目说明:</strong></p><ol class=""><li id="1555" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj"> imdb_id : </strong> IMDB电影id。</li><li id="8ece" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">片名:</strong>电影名。</li><li id="fafb" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">剧情_剧情简介:</strong>电影概要。</li><li id="c2eb" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">标签:</strong>电影的标签。</li><li id="17b7" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">分割:</strong>代表训练、测试或验证数据。</li><li id="00d6" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">电影概要是从哪里收集来的？</li></ol><p id="d26e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您在这里看到的，目标列是“标签”，它有许多值(标签)，这意味着这是一个多标签问题。多标签<strong class="ih hj"> </strong>是指每个数据点都会有一堆标签，不像每个数据点只有一个标签，比如每部电影都会有很多标签，比如暴力、邪教、哥特、残忍、虐待狂、自我感觉良好、复仇、励志、浪漫、愚蠢。</p><p id="b169" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我为此选择的绩效指标是f1分数</p><p id="00a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">微平均F1分数(平均F分数)</strong>:F1分数可以解释为精确度和召回率的加权平均值，其中F1分数在1时达到其最佳值，在0时达到其最差分数。精确度和召回率对F1分数的相对贡献是相等的。F1分数的公式为:</p><p id="96b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kj"> F1 = 2 *(精度*召回)/(精度+召回)</em></p><p id="aa4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在多类别和多标签的情况下，这是每个类别的F1分数的加权平均值。</p><p id="7487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">清理&amp;预处理数据:</strong>总共有70个唯一标签，每个电影可能有一个或多个标签。标签的绘图如下所示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/2b2852e41794fa7d04ab062315442d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NRBrZTCHLfLoHfs4EJbJSQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图2</figcaption></figure><p id="1bf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很少有像“sci-fi”这样的标签，如果我们清理数据，这个标签可能会分成两个标签，所以我们应该将这个sci-fi替换为science_fiction，第一个直方图的标签丢失了，出现了什么问题？问题是甚至<space>也被认为是一个标签。所以让我们去掉数据中多余的空格。</space></p><p id="4e1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成上述更改后，标签分布如下</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/4d58dd37368553a24512c4371102aa67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sWPgzFufK9mLK_WRtF_Xsg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图3</figcaption></figure><blockquote class="kl km kn"><p id="ff48" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">剧情要点:</p><p id="6a6d" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">大多数标签出现不到1000次</p><p id="fcf8" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">只有八个标签出现超过1000次</p><p id="499e" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">谋杀是出现次数最多的标签，大约6000次</p></blockquote><p id="fa76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看标签的文字云</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kr"><img src="../Images/3865d5b365f04a77d5311577838755ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLfmJoW_iiLnZbsDKk-hZg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图4</figcaption></figure><blockquote class="kl km kn"><p id="84ae" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">剧情要点:</p><p id="a4db" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">最常见的标签是谋杀和暴力</p><p id="bb40" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">下一个重要的标签是闪回，浪漫，复仇，邪教和喜剧</p></blockquote><p id="296c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">据我观察，数据中有一些特殊的字符，就像来自其他语言的字符一样。我用谷歌翻译API把这些字符翻译成英语。</p><p id="765d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">找出特殊字符</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/a1200ff59696d395b7163fae2ebcc7fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3CRvvctNl8GoWNW_x0WDA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图5</figcaption></figure><p id="087c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用英文翻译替换那些特殊字符</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/336c997f818372f487446e9fab484f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ARKLPV1bQUqlsclVxlotSw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图6</figcaption></figure><p id="56a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些被替换的单词</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/f69b90247b6e391c1b0f767dec33698c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*V1Pc4wYng0xwkguzFlj67A.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图7</figcaption></figure></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><blockquote class="kl km kn"><p id="4740" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">我们已经清理完了剩下的数据特征和应用模型🙌🏻</p><p id="2967" class="if ig kj ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">根据数据集中的拆分列拆分数据</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lc"><img src="../Images/a8482d79d43a5ed9244fa114b58ffb20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwb8at7_rWAUBVPpIqwD5g.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图8</figcaption></figure><p id="0264" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">特色化技术:</strong></p><ol class=""><li id="71b4" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">特征化文本</li><li id="f13a" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">特征化目标标签</li></ol><p id="4210" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。特征文本:</strong></p><p id="e771" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于文本的特征化技术是</p><ol class=""><li id="8e62" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">TFIDF单克</li><li id="c28a" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">TFIDF二克</li><li id="16e3" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">TFIDF三克</li><li id="0df9" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">TFIDF Char-3克</li><li id="95a0" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">TFIDF Char-4克</li><li id="d393" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">TFIDF单克+ TFIDF双克+TFIDF三克</li><li id="a6f8" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">TFIDF Char-3克+TFIDF Char-4克</li><li id="707d" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">tfi df 1克+tfi df 2克+tfi df 3克+tfi df 3克+tfi df 4克</li></ol><p id="8781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。特征化目标标签:</strong></p><p id="a957" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如我们所知，总的类别标签是71个标签，并且每个电影可以在这71个标签中获得任意数量的标签，单词包技术被应用于这些标签，并且每个数据点的目标标签用这个单词包向量来表示。</p><p id="ab42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">在对上述特征应用模型后，进行了以下观察</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/97dc9beecb9e6237459dfb86870eec3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uuYhtrvV5jmp5rxvpO2gw.png"/></div></div></figure><p id="66f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p><p id="bc3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.得到的最大f1值为37.805% ~ 38%。<br/> 2。几乎所有的载体都有超过30%的f1值，除了Tri gram载体。<br/> 3。与sgd逻辑回归相比，正常逻辑回归的f1值最高。<br/> 4。基于Uni+Bi+Tri+Chr3+Chr4向量的逻辑回归的最佳alpha值为0.001，sgd逻辑回归的最佳alpha值为0.1。</p></div></div>    
</body>
</html>