<html>
<head>
<title>Creative AI : The Artistic Intelligence</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创造性人工智能:艺术智能</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/creative-ai-the-artistic-intelligence-deea57fdcb03?source=collection_archive---------7-----------------------#2020-12-18">https://medium.com/analytics-vidhya/creative-ai-the-artistic-intelligence-deea57fdcb03?source=collection_archive---------7-----------------------#2020-12-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1102" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">创造性人工智能DeepDream及其实现简介</h2></div><blockquote class="ix iy iz"><p id="945b" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">想知道当我们输入图像时，神经网络在隐藏层中看到了什么吗？AI有能力自己生成电影或创意绘画和图像或游戏吗？人工智能和人类一样有创造力吗？</p></blockquote><p id="8741" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我们将试图通过这篇博客找到这些问题的答案。:)</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ka"><img src="../Images/91f6c8429591c224ad7ee498ab8aac7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RPUpWMO-LPA-N9yDRS-3bA.jpeg"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx translated"><a class="ae kq" href="https://unsplash.com/@alinabelous?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿丽娜·贝鲁斯</a>在<a class="ae kq" href="https://unsplash.com/s/photos/creative-ai?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="2d76" class="ky kz hi bd la lb lc ld le lf lg lh li jx lj lk ll jy lm ln lo jz lp lq lr ls bi translated"><strong class="ak">目录</strong></h2><ul class=""><li id="efd4" class="lt lu hi jd b je lv jh lw jx lx jy ly jz lz jw ma mb mc md bi translated">介绍</li><li id="24bd" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">创造性人工智能的例子</li><li id="5a22" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">DeepDream模型</li><li id="a81a" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">DeepDream的实现</li><li id="8f90" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">结论</li></ul><p id="837e" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jd hj">简介</strong></p><blockquote class="mj"><p id="9542" class="mk ml hi bd mm mn mo mp mq mr ms jw dx translated">“创造性人工智能是人工智能的一个分支，人工智能可以像人类一样创造绘画、电影、音乐、游戏和许多其他创造性艺术。”</p></blockquote><p id="7a55" class="pw-post-body-paragraph ja jb hi jd b je mt ij jg jh mu im jj jx mv jm jn jy mw jq jr jz mx ju jv jw hb bi translated">我们都知道人工智能在技术上发生了巨大的转变，但我们过去常常想知道人工智能是否能取代人类。随着当今机器学习趋势的增长，我们已经达到了人工智能能够自己创造艺术的阶段。</p><p id="39f5" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">正如人类学习探索和创造事物一样，人工智能也逐渐从输入神经网络的图像中学习。例如，参考下面给出的图像。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="8323" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jd hj">创造性人工智能的例子</strong></p><ol class=""><li id="bf14" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw nb mb mc md bi translated">用人工智能创造艺术</li></ol><p id="e26b" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在大量数据和各种机器学习算法的帮助下，我们可以创作出令人着迷的动态创意作品。</p><p id="0e2c" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">参考这个youtube视频，其中展示了基本上由艺术家Refik Anadol创作的创造性艺术。他用创造性的人工智能创造装置和公共艺术。</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="e055" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">2.艾首部电影预告片</p><p id="f695" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">IBM的研究人员与20世纪福克斯公司合作，为电影《摩根》制作了有史以来第一部认知电影预告片。</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="5061" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">3.人工智能艺术家社区</p><p id="20e0" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">AIArtists.org是探索人工智能对艺术和社会的影响的大型艺术家社区。</p><p id="98e7" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">访问<a class="ae kq" href="https://www.AIArtists.org" rel="noopener ugc nofollow" target="_blank">AIArtists.org</a>获得更多使用人工智能创作的艺术作品。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="fb4a" class="ky kz hi bd la lb lc ld le lf lg lh li jx lj lk ll jy lm ln lo jz lp lq lr ls bi translated">DeepDream:深入梦境！</h2><blockquote class="ix iy iz"><p id="04f8" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">什么是DeepDream？</p></blockquote><p id="4159" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">DeepDream是一种计算机视觉算法，由谷歌的一名工程师Alexander Mordvintsev创建，该算法使用CNN通过算法找到并增强图像中的模式，从而创建一种梦幻般的效果。</p><p id="9d3e" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">DeepDream是一项将神经网络学习的模式可视化的实验。DeepDream过度解释和增强了它在图像中看到的模式。随着图片上传到网络，更多奇怪的功能将会出现。</p><p id="b06a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">记住，当我们还是个孩子的时候，我们习惯于在看各种各样的东西的时候解释某些形状，并试图弄清楚它是什么。同样，DeepDream也是通过放大给定图像中的模式来做同样的事情，这种放大是基于它在训练期间被训练看到的东西。</p><blockquote class="ix iy iz"><p id="e964" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">DeepDream是如何工作的？</p></blockquote><ul class=""><li id="1efc" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">当你把一幅图像输入一个经过训练的人工神经网络时，神经元就会被激活。</li><li id="010c" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">深度梦算法的工作原理是试图改变输入图像，让其中一些神经元更加活跃。你可以选择哪一层中的哪一个神经元你想要激发更多，这取决于你想要提取更多的特征。</li><li id="2fea" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">重复该过程，直到完全提取出特定图层所寻找的特征。</li><li id="f98c" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">示例:如果某个特定图层被训练为寻找汽车，深度梦算法将不断尝试以这样一种方式更改输入图像，即无论网络中输入的是什么图像，都会开始在输入图像的基础上创建汽车的特征。这个过程一直持续到DeepDream观察到满意的结果。</li></ul></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="e319" class="ky kz hi bd la lb lc ld le lf lg lh li jx lj lk ll jy lm ln lo jz lp lq lr ls bi translated">DeepDream的实现</h2><p id="a126" class="pw-post-body-paragraph ja jb hi jd b je lv ij jg jh lw im jj jx ne jm jn jy nf jq jr jz ng ju jv jw hb bi translated">在这里，我们将把DeepDream应用到一个城堡的图片上，并观察结果中的图像，以更好地理解DeepDream。</p><p id="e6a1" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在这里，我随机拍摄了一座城堡。您也可以使用任何其他图像。</p><p id="5d9a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">让我们开始实现:)</p><ul class=""><li id="a73b" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">首先，导入我们处理所需的必要库。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="9e5c" class="ky kz hi ni b fi nm nn l no np">import tensorflow as tf<br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>from PIL import Image</span></pre><ul class=""><li id="e288" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">这里，我们使用的是InceptionV3模型，它是图像数据集上的预训练模型。您可以在图像上使用任何预训练的模型。InceptionV3与DeepDream算法中使用的模型非常相似。</li><li id="5bf9" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">预先训练的模型已经有了它们的权重，我们在程序中使用，这就是所谓的迁移学习。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="8491" class="ky kz hi ni b fi nm nn l no np"># Load trained inceptionNet model.</span><span id="d2c2" class="ky kz hi ni b fi nq nn l no np">base_model = tf.keras.applications.InceptionV3(include_top = False, weights = 'imagenet')</span></pre><ul class=""><li id="edf9" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">查看base_model的层。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="424c" class="ky kz hi ni b fi nm nn l no np">base_model.summary()</span></pre><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nr"><img src="../Images/357908469a91bef88780ac2b9fb1b9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G3KSwJzaARjy9F3nS10Zpw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx translated">InceptionV3模型摘要</figcaption></figure><p id="dfe1" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">如上图，模型有输入层，应用于Conv2D，批量归一化，激活函数等。</p><ul class=""><li id="d628" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">加载你想美化的图像！</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="811a" class="ky kz hi ni b fi nm nn l no np">image = Image.open("/CreativeAI/disneyland/img_0.jpg")</span><span id="1622" class="ky kz hi ni b fi nq nn l no np">image.save("img_0.jpg")</span><span id="d727" class="ky kz hi ni b fi nq nn l no np">Image = tf.keras.preprocessing.image.load_img('img_0.jpg')</span></pre><ul class=""><li id="1379" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">将图像转换成numpy数组。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="19d3" class="ky kz hi ni b fi nm nn l no np"># Convert to numpy array<br/>Image = tf.keras.preprocessing.image.img_to_array(Image)</span></pre><ul class=""><li id="a662" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">使图像正常化。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="38db" class="ky kz hi ni b fi nm nn l no np"># Normalize the input image</span><span id="3755" class="ky kz hi ni b fi nq nn l no np">Image = np.array(Image)/255.0</span></pre><ul class=""><li id="4b69" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">现在，我们将选择我们希望激活函数最大化的基本模型的层。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="7870" class="ky kz hi ni b fi nm nn l no np"># Maximize the activations of these layers<br/>names = ['mixed3', 'mixed5', 'mixed7']</span><span id="9abf" class="ky kz hi ni b fi nq nn l no np">layers = [base_model.get_layer(name).output for name in names]</span><span id="9714" class="ky kz hi ni b fi nq nn l no np"># Create the feature extraction model<br/>deepdream_model = tf.keras.Model(inputs = base_model.input, outputs = layers)</span></pre><p id="f192" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">DeepDream选择一个或多个层，并最大化其激活，以便更显著地提取该层的特征。在梦化过程中看到的特征取决于所选择的层，即较低层产生边缘或简单的图案，而较深层在图像中给出复杂的特征，甚至整个物体。</p><ul class=""><li id="ccb9" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">通过馈入我们的输入图像并查看激活“神经元输出”来运行模型。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="1974" class="ky kz hi ni b fi nm nn l no np">activations = deepdream_model(Image)</span><span id="b342" class="ky kz hi ni b fi nq nn l no np">activations</span></pre><p id="07ea" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">上面的代码片段将显示层“混合3”，“混合5”和“混合7”的激活。</p><ul class=""><li id="4362" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">定义一个计算损失的函数。损耗是所选层的激活函数的总和。它的工作原理是通过网络前馈输入图像并产生激活。然后获得这些输出的平均值和总和。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="5ccb" class="ky kz hi ni b fi nm nn l no np">def calc_loss(image, model):</span><span id="0c52" class="ky kz hi ni b fi nq nn l no np"># Convert into batch format<br/>  img_batch = tf.expand_dims(image, axis=0)</span><span id="1e36" class="ky kz hi ni b fi nq nn l no np">  layer_activations = model(img_batch) # Run the model</span><span id="98e2" class="ky kz hi ni b fi nq nn l no np">  print('ACTIVATION VALUES (LAYER OUTPUT) =\n', layer_activations)</span><span id="4350" class="ky kz hi ni b fi nq nn l no np">  losses = [] # accumulator to hold all the losses</span><span id="d8ca" class="ky kz hi ni b fi nq nn l no np">  for act in layer_activations:<br/>    loss = tf.math.reduce_mean(act) <br/>    losses.append(loss)</span><span id="bf00" class="ky kz hi ni b fi nq nn l no np">  print('LOSSES (FROM MULTIPLE ACTIVATION LAYERS) = ', losses)</span><span id="f098" class="ky kz hi ni b fi nq nn l no np">  print('LOSSES SHAPE (FROM MULTIPLE ACTIVATION LAYERS) = ',   np.shape(losses))</span><span id="3d5a" class="ky kz hi ni b fi nq nn l no np">  print('SUM OF ALL LOSSES (FROM ALL SELECTED LAYERS)= ', tf.reduce_sum(losses))</span><span id="fece" class="ky kz hi ni b fi nq nn l no np">  return  tf.reduce_sum(losses) # Calculate sum</span></pre><p id="5449" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">一般来说，我们通过梯度下降使损失最小化，但这里我们通过梯度上升使损失最大化。</p><ul class=""><li id="7b45" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">计算输入图像的损失。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="5e41" class="ky kz hi ni b fi nm nn l no np">loss = calc_loss(tf.Variable(Image), deepdream_model)</span></pre><ul class=""><li id="6e91" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">现在，我们将计算关于图像的梯度，并将其添加到输入图像，这将增强网络看到的特征。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="c5dd" class="ky kz hi ni b fi nm nn l no np">def deepdream(model, image, step_size):</span><span id="02f5" class="ky kz hi ni b fi nq nn l no np">  with tf.GradientTape() as tape:<br/>    tape.watch(image)<br/>    loss = calc_loss(image, model) '''call the function that                              calculate  the loss'''</span><span id="e3d5" class="ky kz hi ni b fi nq nn l no np">''' Calculate the gradient of the loss with respect to the pixels of the input image.'''<br/>  gradients = tape.gradient(loss, image)</span><span id="cb2c" class="ky kz hi ni b fi nq nn l no np">  print('GRADIENTS =\n', gradients)<br/>  print('GRADIENTS SHAPE =\n', np.shape(gradients))</span><span id="5372" class="ky kz hi ni b fi nq nn l no np">''' tf.math.reduce_std computes the standard deviation of elements across dimensions of a tensor'''<br/>  gradients /= tf.math.reduce_std(gradients)</span><span id="e57f" class="ky kz hi ni b fi nq nn l no np">''' In gradient ascent, the "loss" is maximized so that the input image increasingly "excites" the layers.'''</span><span id="5ea8" class="ky kz hi ni b fi nq nn l no np">  image = image + gradients * step_size<br/>  image = tf.clip_by_value(image, -1, 1)</span><span id="6002" class="ky kz hi ni b fi nq nn l no np">  return loss, image</span></pre><ul class=""><li id="8db8" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">DeepDream函数，我们在其中计算损失，并显示相应的图像。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="f0c1" class="ky kz hi ni b fi nm nn l no np">def run_deep_dream_simple(model, image, steps = 100, step_size = 0.01):</span><span id="2951" class="ky kz hi ni b fi nq nn l no np">  # Convert from uint8 to the range expected by the model.<br/>  image = tf.keras.applications.inception_v3.preprocess_input(image)</span><span id="98c7" class="ky kz hi ni b fi nq nn l no np">  for step in range(steps):<br/>    loss, image = deepdream(model, image, step_size)</span><span id="af58" class="ky kz hi ni b fi nq nn l no np">    if step % 100 == 0:<br/>      plt.figure(figsize=(12,12))<br/>      plt.imshow(deprocess(image))<br/>      plt.show()<br/>      print ("Step {}, loss {}".format(step, loss))</span><span id="222d" class="ky kz hi ni b fi nq nn l no np">  plt.figure(figsize=(12,12))<br/>  plt.imshow(deprocess(image))<br/>  plt.show()</span><span id="0adc" class="ky kz hi ni b fi nq nn l no np">  return deprocess(image)</span></pre><ul class=""><li id="9075" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">deprocess函数再次转换为uint8。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="a25b" class="ky kz hi ni b fi nm nn l no np">def deprocess(image):<br/>  image = 255*(image + 1.0)/2.0<br/>  return tf.cast(image, tf.uint8)</span></pre><ul class=""><li id="f8d7" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">加载图像，将其转换为numpy数组并运行模型。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="0820" class="ky kz hi ni b fi nm nn l no np">Image = np.array(tf.keras.preprocessing.image.load_img('img_0.jpg'))</span><span id="2e46" class="ky kz hi ni b fi nq nn l no np">dream_img = run_deep_dream_simple(model = deepdream_model, image = Image, steps = 500, step_size = 0.01)</span></pre><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ns"><img src="../Images/b853a5e834cbb8231fe252d311873c58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3J3LeHREGPU-FKQhVVU2Cg.jpeg"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx translated">原始图像和经过100步处理后的图像</figcaption></figure><p id="5bec" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">如上所示，随着模型在不同步骤的处理，越来越多的特征将被增强，并且类似的梦化结果将被生成。</p><h2 id="3308" class="ky kz hi bd la lb lc ld le lf lg lh li jx lj lk ll jy lm ln lo jz lp lq lr ls bi translated">让我们用所有的图像制作一个视频来检验深度梦境！！</h2><ul class=""><li id="1a0d" class="lt lu hi jd b je lv jh lw jx lx jy ly jz lz jw ma mb mc md bi translated">这个辅助函数加载一个图像，并以浮点numpy数组的形式返回它。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="3f73" class="ky kz hi ni b fi nm nn l no np">def load_image(filename):<br/>  image = PIL.Image.open(filename)<br/>  return np.float32(image)</span></pre><ul class=""><li id="541b" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">现在，我们运行下面的代码，加载原始图像，并将其保存在一个新的文件夹中。</li><li id="8c88" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">你必须创建一个名为“disneypalace”的新文件夹，并将img_0放入其中。</li><li id="482e" class="lt lu hi jd b je me jh mf jx mg jy mh jz mi jw ma mb mc md bi translated">检查图像是否已经存在，对其进行预处理，将其应用于deepdream并存储结果。这种迭代发生多次，然后我们将有许多图像存储在我们的目录中。</li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="9718" class="ky kz hi ni b fi nm nn l no np">import os</span><span id="6046" class="ky kz hi ni b fi nq nn l no np">dream_name = 'disneypalace'</span><span id="35b9" class="ky kz hi ni b fi nq nn l no np">for i in range(0, 50):<br/>  if os.path.isfile('/{}/img_{}.jpg'.format(dream_name, i+1)):<br/>    print("{} present already, continue fetching the frames.".format(i+1))</span><span id="7ebf" class="ky kz hi ni b fi nq nn l no np">  else:<br/>    # Call the load image funtion<br/>    img_result = load_image('/{}/img_{}.jpg'.format(dream_name, i)) </span><span id="493a" class="ky kz hi ni b fi nq nn l no np">  # Zoom the image<br/>  x_zoom = 2 <br/>  y_zoom = 1</span><span id="727b" class="ky kz hi ni b fi nq nn l no np">  '''Chop off the edges of the image and resize the image back to the original shape. This gives the visual changes of a zoom'''</span><span id="9945" class="ky kz hi ni b fi nq nn l no np">  img_result = img_result[0+x_zoom : y_size-y_zoom, 0+y_zoom : x_size-x_zoom]<br/>  img_result = cv2.resize(img_result, (x_size, y_size))</span><span id="74af" class="ky kz hi ni b fi nq nn l no np">  # Adjust the RGB value of the image<br/>  img_result[:, :, 0] += 2  # red<br/>  img_result[:, :, 1] += 2  # green<br/>  img_result[:, :, 2] += 2  # blue</span><span id="c62a" class="ky kz hi ni b fi nq nn l no np">  # Deep dream model<br/>  img_result = run_deep_dream_simple(model = deepdream_model, image = img_result, steps = 100, step_size = 0.1)</span><span id="07f1" class="ky kz hi ni b fi nq nn l no np">  # Clip the image, convert the datatype of the array, and then convert to an actual image.<br/>  img_result = np.clip(img_result, 0.0, 255.0)<br/>  img_result = img_result.astype(np.uint8)<br/>  result = PIL.Image.fromarray(img_result, mode='RGB')</span><span id="7151" class="ky kz hi ni b fi nq nn l no np">  # Save all the frames in the dream location<br/>  result.save(r'/{}/img_{}.jpg'.format(dream_name, i+1))</span><span id="585a" class="ky kz hi ni b fi nq nn l no np">  created_count += 1</span><span id="9b44" class="ky kz hi ni b fi nq nn l no np">  if created_count &gt; max_count:<br/>    break</span></pre><ul class=""><li id="0418" class="lt lu hi jd b je jf jh ji jx my jy mz jz na jw ma mb mc md bi translated">你可以使用任何开源视频制作工具制作视频，我用https://clideo.com/video-maker的<a class="ae kq" href="https://clideo.com/video-maker" rel="noopener ugc nofollow" target="_blank">制作了一个视频，或者你可以使用给定的代码片段制作一个视频。</a></li></ul><pre class="kb kc kd ke fd nh ni nj nk aw nl bi"><span id="cdfc" class="ky kz hi ni b fi nm nn l no np">import cv2<br/>import glob</span><span id="2086" class="ky kz hi ni b fi nq nn l no np">img_array = []</span><span id="a928" class="ky kz hi ni b fi nq nn l no np">for filename in glob.glob('disneypalace/*.jpg'):<br/>  img = cv2.imread(filename)<br/>  height, width, layers = img.shape<br/>  size = (width,height)<br/>  img_array.append(img)</span><span id="708c" class="ky kz hi ni b fi nq nn l no np">out = cv2.VideoWriter('disneypalace.avi',cv2.VideoWriter_fourcc(*'DIVX'), 15, (910, 605))</span><span id="5210" class="ky kz hi ni b fi nq nn l no np">for i in range(len(img_array)):<br/>  out.write(img_array[i])</span><span id="415d" class="ky kz hi ni b fi nq nn l no np">out.release()</span></pre><p id="c2dc" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我做了这个视频，从梦化的图像到原始图像，顺序相反！</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="nc nd l"/></div><figcaption class="km kn et er es ko kp bd b be z dx translated">梦幻般的迪士尼乐园</figcaption></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><blockquote class="ix iy iz"><p id="7f82" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">结论:</p><p id="9108" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">如今，创造性人工智能正在达到新的高度，因为许多研究人员正在探索人工智能来创造各种艺术。如上所述，在创造性人工智能的帮助下，电影预告片已经发布。DeepDream用于<a class="ae kq" href="https://en.wikipedia.org/wiki/Foster_the_People" rel="noopener ugc nofollow" target="_blank">扶植人民</a>的音乐视频《为钱而做》。</p><p id="f02a" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">人工智能的这一分支直到今天还没有被广泛使用，但可以广泛用于作曲、视频和其他艺术。因此，创造性人工智能为每个热衷于创造性人工智能的人打开了探索和研究的大门。</p></blockquote></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="cc38" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jd hj">参考文献:</strong></p><p id="84d0" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">[1]<a class="ae kq" href="https://www.tensorflow.org/tutorials/generative/deepdream" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/tutorials/generative/deepdream</a></p><p id="e536" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><a class="ae kq" href="https://en.wikipedia.org/wiki/DeepDream" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/DeepDream</a></p><h2 id="bc2d" class="ky kz hi bd la lb lc ld le lf lg lh li jx lj lk ll jy lm ln lo jz lp lq lr ls bi translated">感谢您的阅读！祝您愉快！:)</h2></div></div>    
</body>
</html>