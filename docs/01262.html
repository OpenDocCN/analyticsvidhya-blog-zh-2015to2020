<html>
<head>
<title>Text -LSTM(Beginner Guide)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文本-LSTM(初学者指南)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/text-lstm-f1aaceeb5727?source=collection_archive---------7-----------------------#2019-10-11">https://medium.com/analytics-vidhya/text-lstm-f1aaceeb5727?source=collection_archive---------7-----------------------#2019-10-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="620e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">文本分类中的LSTM(单词嵌入)</h2></div><p id="3b2e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我是机器学习的新手。我找不到一个合适的文本LSTM的视觉表达，也找不到喀拉斯LSTM单位在LSTM网络中是如何安排的。这是我对此最简单的解释。在我们进入这篇文章之前，我强烈建议你看看下面我所了解的关于LSTM的文章。</p><div class="jt ju ez fb jv jw"><a href="https://statisticalinterference.wordpress.com/2017/06/01/lstms-in-even-more-excruciating-detail/" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">LSTMs的一个数值例子</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">许多帖子已经详细讨论了LSTMs的向前传球(例如，这里非常有用的帖子)…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">statisticalinterference.wordpress.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk kl jw"/></div></div></a></div><div class="jt ju ez fb jv jw"><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/?source=post_page-----37e2f46f1714----------------------" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">了解LSTM网络</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">2015年8月27日发布人类不是每秒钟都从零开始思考。当你读这篇文章时，你…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">colah.github.io</p></div></div></div></a></div></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><p id="5fcd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">LSTM(长短期记忆)是RNN(递归神经网络)高级版本。RNN的主要问题是它不能记住文本中的长期信息，时间序列数据，过去的信息相关信息被存储以备将来使用。这被称为消失梯度下降，其中权重在初始层上被更新，但是当我们离网络的初始层更远时，权重被更新得很少或者根本不更新。</p><p id="ef10" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">消失梯度下降问题的一个例子是，如果你的权重更新为0.0000000001，那么这些层根本不会学习，或者因为消失梯度而学习非常慢。</p><p id="c307" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上述问题在LSTM得到解决，因为我们有存储单元来存储与网络相关的先前信息。</p><h1 id="aa77" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">LSTM细胞</h1><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es ll"><img src="../Images/cace770db820b756504598221c2c97d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5W8FrASMi93Z81NlAui4w.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">LSTM细胞(来源—<a class="ae ma" href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">http://colah.github.io/posts/2015-08-Understanding-LSTMs/)</a></figcaption></figure><p id="3e55" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是单个LSTM细胞内部的示意图，以及信息如何从一个门流向另一个门，以及从一个细胞流向另一个细胞。</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es mb"><img src="../Images/cf3f4d0cdc9ef7918728fc49e7968f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*Y99Np8ZsfAVHLmbuDuIwrQ.png"/></div></figure><h2 id="4fcf" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">忘记大门</h2><p id="40dd" class="pw-post-body-paragraph ix iy hi iz b ja mq ij jc jd mr im jf jg ms ji jj jk mt jm jn jo mu jq jr js hb bi translated">在中使用遗忘门来遗忘单元状态中的信息。遗忘门使用Sigmoid激活功能，输出范围为(0–1)的值。0表示完全忘记信息，1表示为下一时间步存储信息。遗忘门的一个例子如下</p><blockquote class="mv mw mx"><p id="1df3" class="ix iy my iz b ja jb ij jc jd je im jf mz jh ji jj na jl jm jn nb jp jq jr js hb bi translated">我住在浦那，但现在我住在海德拉巴。所以你可以在我现在的地方下订单。</p></blockquote><p id="e97b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的句子中，我们可以看到位置Pune应该在下一个时间步骤中被删除，因为位置被更改为Hyderabad。这是遗忘之门工作原理的一个小例子。</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nc"><img src="../Images/f75fe20935fcb84af059bc91da18bf69.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*OmemnEIfOBiA9PmnwxV3_Q.png"/></div></figure><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nd"><img src="../Images/41d8df64d8444d483f20783e46c6da33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*4fo7ROqOx5C3o3lo5gEObA.png"/></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h2 id="3a22" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">输入门</h2><p id="b361" class="pw-post-body-paragraph ix iy hi iz b ja mq ij jc jd mr im jf jg ms ji jj jk mt jm jn jo mu jq jr js hb bi translated">输入门决定我们将在单元状态中更新哪些值。它通过Sigmoid Activaton传递这些值，后者给出了要传递的新信息量。再看前面的例子</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es ne"><img src="../Images/b8504bde257b0e3dc35a5b6e01df3514.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*rZA08oVKYep9VMqbj06FcA.png"/></div></figure><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nf"><img src="../Images/c842decaf98aa737fb7c801428a5776b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*sE5gBLcCfKnVgbBDuIg0kA.png"/></div></figure><p id="4a11" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该下部门从状态中获取信息，并将tanh激活功能应用于in。它提出要添加到单元状态的新信息。</p><p id="77bd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的层是tanh激活层，它给出可以添加到下一个单元状态的值。它提出要添加到单元状态的新信息。</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es ng"><img src="../Images/78da4ea0e4435cafddecf60f1382ddd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*4O_MwyDZOeeQgpJOhnwRUg.png"/></div></figure><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nh"><img src="../Images/2bc78263c218464319c6bf18eaf4014d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*6_GbnQ7oqyU_4JfMUouyJQ.png"/></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h2 id="fa2e" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">输出门</h2><p id="fc89" class="pw-post-body-paragraph ix iy hi iz b ja mq ij jc jd mr im jf jg ms ji jj jk mt jm jn jo mu jq jr js hb bi translated">输出门应用Sigmoid激活函数，并给我们单元状态的哪一部分输出到最终状态的信息:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es ni"><img src="../Images/5866ed1e19c1ec1fc6dadf961ffbaa9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*jbTAA8xEB0BcxNiDvNjfaQ.png"/></div></figure><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nj"><img src="../Images/658dedbb5fcddb6e256d42be4628a0b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Is0QEACKZzpDuAO0bAa3RQ.png"/></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h2 id="3c9d" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">更新/下一个单元状态</h2><p id="b160" class="pw-post-body-paragraph ix iy hi iz b ja mq ij jc jd mr im jf jg ms ji jj jk mt jm jn jo mu jq jr js hb bi translated">这是传递到下一个单元或作为输出的最终更新的单元状态:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nk"><img src="../Images/385cd81449f69548fbed8295efcc50ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*o_myMCGy56VksSSi5oiMXw.png"/></div></figure><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nl"><img src="../Images/4e47b777b425293b3c3ae300ed864106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*nv_RKjItFO88nj_blhT5lg.png"/></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h2 id="aae8" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">更新/下一个隐藏状态</h2><p id="3025" class="pw-post-body-paragraph ix iy hi iz b ja mq ij jc jd mr im jf jg ms ji jj jk mt jm jn jo mu jq jr js hb bi translated">这是给予下一个单元或作为输出的最终隐藏状态:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nm"><img src="../Images/dc1889a5494ff788cb56a1888b12a274.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*YGgl_sLHmWqesV2rdReZOg.png"/></div></figure><figure class="lm ln lo lp fd lq er es paragraph-image"><div class="er es nd"><img src="../Images/d2f3637513e54a13af75b3638a2e44d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*IzjWnew1Pd54sX5gPnBaCA.png"/></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h2 id="76cd" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">3个隐藏单元的LSTM表示</h2><p id="9cde" class="pw-post-body-paragraph ix iy hi iz b ja mq ij jc jd mr im jf jg ms ji jj jk mt jm jn jo mu jq jr js hb bi translated">句子—好日子<br/>每个单词的嵌入维数= 5 <br/> LSTM隐藏单元= 3</p><pre class="lm ln lo lp fd nn no np nq aw nr bi"><span id="9725" class="mc ku hi no b fi ns nt l nu nv">inp = Input(shape=(2,))<br/>x = Embedding(50000, 5)(inp)<br/>x = LSTM(3, return_sequences=True)(x)<br/>x = Flatten()(x)<br/>x = Dense(1, activation="sigmoid")(x)<br/>model = Model(inputs=inp, outputs=x)<br/>model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])<br/>print(model.summary())</span></pre></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><pre class="nn no np nq aw nr bi"><span id="bbd0" class="mc ku hi no b fi nw nx ny nz oa nt l nu nv">_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>input_13 (InputLayer)        (None, 2)                 0         <br/>_________________________________________________________________<br/>embedding_13 (Embedding)     (None, 2, 5)              250000    <br/>_________________________________________________________________<br/>lstm_16 (LSTM)               (None, 2, 3)              108       <br/>_________________________________________________________________<br/>flatten_5 (Flatten)          (None, 6)                 0         <br/>_________________________________________________________________<br/>dense_11 (Dense)             (None, 1)                 7         <br/>=================================================================<br/>Total params: 250,115<br/>Trainable params: 250,115<br/>Non-trainable params: 0<br/>_________________________________________________________________<br/>None</span></pre><p id="c934" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下图是如何在LSTM用3个隐藏单元进行单个单元格的计算。</p><blockquote class="mv mw mx"><p id="5fc0" class="ix iy my iz b ja jb ij jc jd je im jf mz jh ji jj na jl jm jn nb jp jq jr js hb bi translated">我没有计算LSTM中的值，这只是示例值</p></blockquote><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es ob"><img src="../Images/29ebc6f8e604556140061c825d06e0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HjCwrrzEQcvctxqgRHshnA.png"/></div></div></figure><p id="504b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的句子是“Good Day ”,因此需要两个STM细胞将信息传递给下一个细胞。下图显示了信息是如何从一个单元格传递到另一个单元格的。</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es oc"><img src="../Images/3b3f76f3ccc3cd0e0852e2e9c1a99c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7N7i8uoSfXq0Rxf5feGDA.png"/></div></div></figure><p id="98f4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上图中，您可以看到“return_sequence”和“return_state”是如何输出值的。</p><h2 id="35ff" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">返回序列</h2><pre class="lm ln lo lp fd nn no np nq aw nr bi"><span id="9658" class="mc ku hi no b fi ns nt l nu nv">return_sequence = True</span></pre><p id="0552" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它输出每个时间步长的值，如上图所示</p><pre class="lm ln lo lp fd nn no np nq aw nr bi"><span id="00cb" class="mc ku hi no b fi ns nt l nu nv">return_sequence = False</span></pre><p id="10c8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它输出上一个时间步长的值，如上图所示</p><h2 id="cca9" class="mc ku hi bd kv md me mf kz mg mh mi ld jg mj mk lf jk ml mm lh jo mn mo lj mp bi translated">返回状态</h2><pre class="lm ln lo lp fd nn no np nq aw nr bi"><span id="a26a" class="mc ku hi no b fi ns nt l nu nv">return_state = True</span></pre><p id="956c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它输出上图所示的最后一个时间步长和最后一个单元状态的值</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><blockquote class="mv mw mx"><p id="21d7" class="ix iy my iz b ja jb ij jc jd je im jf mz jh ji jj na jl jm jn nb jp jq jr js hb bi translated">如果你在这篇文章中发现任何我可能写错的信息，请在raqueebilahi@gmail.com或评论区告诉我</p><p id="c64e" class="ix iy my iz b ja jb ij jc jd je im jf mz jh ji jj na jl jm jn nb jp jq jr js hb bi translated">我也在印度浦那寻找数据科学家的工作。如果你有任何空缺，我很乐意与你联系。请务必让我在raqueebilahi@gmail.com知道</p></blockquote></div></div>    
</body>
</html>