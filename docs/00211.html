<html>
<head>
<title>Implementing Multiclass Logistic Regression using BigQuery ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用BigQuery ML实现多类逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multi-class-logistic-regression-using-bigquery-ml-c4a2c8cddad6?source=collection_archive---------1-----------------------#2018-12-15">https://medium.com/analytics-vidhya/multi-class-logistic-regression-using-bigquery-ml-c4a2c8cddad6?source=collection_archive---------1-----------------------#2018-12-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cade" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据科学是当今非常热门的话题。因此，工业界和学术界投入了大量的时间和金钱来研究和发展这一领域。像谷歌、亚马逊和微软这样的公司在人工智能上下了大赌注。这导致了无数开源和专有工具和库的出现，以帮助数据科学项目和实验的整体开发。</p><p id="0841" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">即使有大量的机器学习库和工具像Tensorflow，Keras，MxNet，Pytorch等。最大的挑战之一是将模型投入生产。机器学习实验只有在部署到生产中时才能为组织带来价值。此外，动态扩展预测过程需要减少规划、工作和基础设施方面的考虑。例如Kubernetes上的docker容器或AWS、Google等上的托管模型部署。BigQuery承诺简化这些挑战。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ecc4b494f027d9718f21d61818b3cc17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xz0UKJ3zec1S4k11lO3EjQ.jpeg"/></div></div></figure><p id="51e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery是Google的一个流行的数据仓库解决方案。它的无服务器架构使它可以轻松地高度扩展。无服务器架构允许最终用户纯粹关注代码中的单个功能。Google functions、Microsoft Azure functions等服务负责物理硬件、虚拟机操作系统和web服务器软件管理。</p><p id="9ad9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Google BigQuery基于类似的原理，最终用户不必担心底层硬件、虚拟机以及节点或实例的数量等。用户只需编写一个SQL查询并执行它。BigQuery的执行算法分析尽可能快地执行查询所需的必要资源，调配资源，执行查询执行，释放资源。</p><p id="36af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery的入门非常简单。用户只需在Google cloud中创建一个帐户，并从控制台激活BigQuery。激活BigQuery需要几秒钟时间。然后，用户可以创建新的数据集。数据集在逻辑上等同于数据库。可以在数据集内创建表格。表的模式可以在创建时定义，也可以在接收数据时动态定义。一旦数据被加载到BigQuery表中，它的ML特性就可以用来准备模型。</p><p id="f1af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌每月免费提供10 GB的存储和1 TB的数据分析。Google最近添加到BigQuery的一个功能是BigQuery ML。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="49d4" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">BigQuery ML的基础</h1><p id="580e" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">BigQuery ML允许其用户使用简单的SQL直接在数据仓库中开发机器学习模型。它支持符合ANSI:2011的标准SQL方言。模型是作为培训工作的一部分自动创建和部署的。最大的优势之一是不需要将数据移出数据仓库，从而节省了额外的步骤。传统上，作为训练过程的一部分，数据被移出数据存储，以便为特征工程步骤进行预处理。BigQuery自动处理现成的特性工程和预处理。由于它的无服务器架构，培训过程是自动扩展的。</p><p id="fc68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">截至目前，BigQuery支持以下模型:</p><ol class=""><li id="c49a" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">线性回归</li><li id="4caa" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">二元逻辑回归</li><li id="d1ba" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">用于分类的多类逻辑回归</li></ol></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="967e" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">多类分类实践</h1><p id="f216" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">在这篇文章中，我将演示如何使用BigQuery ML进行多类分类。由于在撰写本文时，BigQuery只支持逻辑回归，因此我们将使用它来构建我们的模型。</p><p id="90ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将使用消费者投诉数据库作为示例数据集。数据集可以在<a class="ae ln" href="https://catalog.data.gov/dataset/consumer-complaint-database" rel="noopener ugc nofollow" target="_blank">这里</a>找到。我将在Jupyter笔记本中使用Python连接BigQuery。将使用从Google access control获得的服务帐户JSON进行身份验证。</p><h2 id="b948" class="lo jx hi bd jy lp lq lr kc ls lt lu kg iq lv lw kk iu lx ly ko iy lz ma ks mb bi translated">问题描述</h2><p id="937b" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">消费者投诉数据库包括收到的关于各种金融产品的投诉。它由消费者金融保护局发布。我将使用逻辑回归，以消费者投诉叙述为特征，对历史消费者投诉模型进行训练。标签将是金融产品名称。模型应该能够根据消费者投诉叙述文本正确预测产品。</p><h2 id="9ba3" class="lo jx hi bd jy lp lq lr kc ls lt lu kg iq lv lw kk iu lx ly ko iy lz ma ks mb bi translated">解决方法</h2><p id="661a" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">使用Python作为客户端库在BigQuery中插入数据。一旦数据被接收到一个表中，然后使用BigQuery ML来训练模型并获得预测。我将使用Pandas从CSV加载数据，并使用BigQuery Python客户端将数据帧直接接收到BigQuery中。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="334e" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">在BigQuery中加载数据</h1><p id="67b8" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated"><strong class="ih hj">步骤1 </strong>:读取熊猫数据帧:<br/>由于我们将直接从熊猫数据帧加载数据到BigQuery，因此第一步是将CSV读入数据帧。应该正确解析日期列，以便BigQuery可以在接收时自动将其解析为时间戳。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="26a5" class="lo jx hi md b fi mh mi l mj mk">import pandas as pd<br/>from google.cloud import bigquery<br/>import numpy as np</span><span id="423e" class="lo jx hi md b fi ml mi l mj mk">consumer_complaints_df = pd.read_csv("Consumer_Complaints.csv",parse_dates=[0,13])<br/>.set_index("Date received")</span><span id="7686" class="lo jx hi md b fi ml mi l mj mk">consumer_complaints_df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/6227a9fadae66a6b5b2420a0a7c21d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEpNJT0CIPaVSyYCZZi_Cw.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">阅读熊猫数据框中的CSV</figcaption></figure><p id="a908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第2步</strong>:删除“消费者投诉叙述”列为空值的行。<br/>由于本演示的目的是根据“消费者投诉叙述”文本预测产品名称，因此删除了所有具有空值的记录。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="88a6" class="lo jx hi md b fi mh mi l mj mk">print(consumer_complaints_df.shape[0])<br/>print (consumer_complaints_df.index.min())<br/>print (consumer_complaints_df.index.max())<br/>print(consumer_complaints_df.shape[0])</span><span id="c4a9" class="lo jx hi md b fi ml mi l mj mk">consumer_complaints_without_nan_df = consumer_complaints_df[consumer_complaints_df["Consumer complaint narrative"].notnull()]</span><span id="0c15" class="lo jx hi md b fi ml mi l mj mk">print(consumer_complaints_without_nan_df.shape[0])<br/>consumer_complaints_without_nan_df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/f5fd9e656d3d8a7822196e0d17259c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Anx8Hk8e10CpMv8NJL_-BQ.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">为“消费者投诉叙述”选择非空记录</figcaption></figure><p id="e7fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打印独特的标签，了解数据集中的标签。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="045d" class="lo jx hi md b fi mh mi l mj mk">consumer_complaints_without_nan_df["Product"].unique()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/c368a8a3fde0f31100193f689d2b23de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Jm68bwKAyFo2zN1N4j4AA.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">标签列表</figcaption></figure><p id="51d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第3步</strong>:用前5名产品创建一个新的数据框架。<br/>由于沙箱环境和自由层的配额限制，我将把实验限制在前5名产品上。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="55d7" class="lo jx hi md b fi mh mi l mj mk">top_5_products_df = consumer_complaints_without_nan_df.groupby(["Product"]).size().reset_index(name='count').sort_values(['count'], ascending=False)                                                                       .head(5)</span><span id="4379" class="lo jx hi md b fi ml mi l mj mk">top_5_products_df.head(10)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mt"><img src="../Images/2bd82bb3ea00accfdfa8127eba64c311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*msvx97Szg1hqGVPtmnrYVw.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">前5名产品</figcaption></figure><p id="1100" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第4步</strong>:过滤掉只有产品进入前5名的记录。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="3f30" class="lo jx hi md b fi mh mi l mj mk">all_records_top5_product = consumer_complaints_without_nan_df.loc[consumer_complaints_without_nan_df["Product"]                                                                  .isin(top_5_products_df["Product"])]</span><span id="e923" class="lo jx hi md b fi ml mi l mj mk">all_records_top5_product.shape</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mu"><img src="../Images/c6692fa047472d4f60a23566ff434fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U5qY5WInpJZ-yzs072q1tQ.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">仅包含前5大产品的数据集</figcaption></figure><p id="7c8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第5步</strong>:摄取BigQuery中的数据<br/>现在我们将使用服务帐户JSON文件连接到BigQuery，并将过滤后的数据帧摄取到BigQuery数据集中。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="c05a" class="lo jx hi md b fi mh mi l mj mk">client = bigquery.Client.from_service_account_json('&lt;path to service account json&gt;')</span><span id="fd38" class="lo jx hi md b fi ml mi l mj mk">dataset_id = 'bigquery_demo'<br/>table_id = 'consumer_complaint'</span><span id="87aa" class="lo jx hi md b fi ml mi l mj mk">dataset_ref = client.dataset(dataset_id)<br/>dataset = client.get_dataset(dataset_ref)<br/>table_ref = dataset_ref.table(table_id)</span><span id="8b4e" class="lo jx hi md b fi ml mi l mj mk">job_config = bigquery.LoadJobConfig()<br/>job_config.source_format = bigquery.SourceFormat.CSV<br/>job_config.skip_leading_rows = 1<br/>job_config.autodetect = True</span><span id="64ca" class="lo jx hi md b fi ml mi l mj mk">print('Dataset ID: {}'.format(dataset_id))<br/>print('Description: {}'.format(dataset.description))</span><span id="cccc" class="lo jx hi md b fi ml mi l mj mk">job = client.load_table_from_dataframe(all_records_top5_product, table_ref, location='EU')</span><span id="a728" class="lo jx hi md b fi ml mi l mj mk">job.result()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/96c97341bf1a46cbcda2c3a02a984785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Dg_4wMopM2LZIQQ6-RUGQ.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">在BigQuery中插入数据框架</figcaption></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="b7cf" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">构建逻辑回归多类分类器</h1><p id="937c" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated"><strong class="ih hj">第1步</strong>:执行培训任务。<br/>big query的培训非常简单。从语法上看，这就像在数据库中创建一个视图。关键字<em class="mw">创建或替换模型</em>定义我们正在创建一个培训工作，这将创建一个新的模型。选项部分需要参数来定义模型。在这种情况下，它是逻辑回归。如果select中的某一列没有被命名为“标签”,那么<em class="mw"> input_label_cols </em>应该包含应该被视为标签的列的名称。本模块中还应提及其他算法特定的超参数。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="0b64" class="lo jx hi md b fi mh mi l mj mk"># Train a model<br/>train_query = """<br/>    create or replace model<br/>    `bigquery_demo.consumer_complaint_model`<br/>     options<br/>      ( model_type='logistic_reg',<br/>        auto_class_weights=true,<br/>        input_label_cols=['Product'],<br/>        max_iterations=10) AS<br/>     select <br/>     Product, Consumer_complaint_narrative <br/>     from `bigquery_demo.consumer_complaint`<br/>     where Consumer_complaint_narrative is not null<br/>     and Date_received &lt;= "2017-09-30 00:00:00"<br/>     limit 100000<br/>    """<br/>training_job = client.query(train_query).to_dataframe()</span><span id="303c" class="lo jx hi md b fi ml mi l mj mk">print(training_job)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/7bed8fff399d842ecff42558f9b9694e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uy2Xr4dXWonPS7s6Tflz_A.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">训练逻辑回归分类器</figcaption></figure><p id="b287" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第2步</strong>:查看培训总结。<br/> <em class="mw"> ML。对上一步培训模型的</em>调用返回培训总结。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="0b0f" class="lo jx hi md b fi mh mi l mj mk">training_info = """<br/>    select<br/>      *<br/>    from<br/>      ML.TRAINING_INFO(MODEL `bigquery_demo.consumer_complaint_model`)<br/>    """<br/><br/>training_info_job = client.query(training_info).to_dataframe()</span><span id="7306" class="lo jx hi md b fi ml mi l mj mk">print(training_info_job)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/f5902d38d980791bbab92564322ef682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoV6chIoCXl3iYxIkY1OJw.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">培训总结</figcaption></figure><p id="9590" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第3步</strong>:在测试集上对模型进行评价。<br/> <em class="mw"> ML。</em>对模型的调用与对数据的选择查询将对模型进行评估。在这种情况下，select查询将表中日期高于2017年9月30日的所有记录作为评估模型的输入。<br/>平均准确率为. 28，不太好。通过一些超参数调整，它可能会变得更好，但这不在本文的范围内。这里需要注意的一点是，用于培训和评估的整个数据预处理都是由BigQuery管理的。这也可能对精度产生一定影响。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="481f" class="lo jx hi md b fi mh mi l mj mk"># perform evaluation<br/>query_evaluate = """<br/>    select <br/>      * <br/>    from ML.EVALUATE (MODEL `bigquery_demo.consumer_complaint_model`, <br/>      (<br/>        select <br/>        Product, Consumer_complaint_narrative <br/>        from `bigquery_demo.consumer_complaint`<br/>        where Consumer_complaint_narrative is not null<br/>        and Date_received &gt; "2017-09-30 00:00:00"<br/>      ))<br/>    """<br/><br/>evaluation_job = client.query(query_evaluate).to_dataframe()</span><span id="5d97" class="lo jx hi md b fi ml mi l mj mk">print(evaluation_job)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mz"><img src="../Images/c2d8f3c73b7dc4b3cb309fd2543533ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y18asFWUJNzMnmTw6gLU5Q.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">模型评估</figcaption></figure><p id="b6ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第4步</strong>:获取预测<br/> <em class="mw"> ML。对模型的</em>调用将对选择查询传递的数据进行预测。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="cd46" class="lo jx hi md b fi mh mi l mj mk"># perform prediction<br/>query_predict = """<br/>    select <br/>      *<br/>    from ML.PREDICT (MODEL `bigquery_demo.consumer_complaint_model`,<br/>      (<br/>        select <br/>        Consumer_complaint_narrative <br/>        from `bigquery_demo.consumer_complaint`<br/>        where Consumer_complaint_narrative is not null<br/>        limit 2))<br/>    """<br/>prediction_job = client.query(query_predict).to_dataframe()</span><span id="e3fa" class="lo jx hi md b fi ml mi l mj mk">prediction_job.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es na"><img src="../Images/eb7723938d050f52b618e1596f53183a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LcSKGyRbi95m2vqlkEz1ZA.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">来自模型的预测</figcaption></figure><p id="a20f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第五步:评估响应<br/>预测将返回所有标签上概率分布的数据帧。</p><pre class="je jf jg jh fd mc md me mf aw mg bi"><span id="19bc" class="lo jx hi md b fi mh mi l mj mk">prediction_job["predicted_Product_probs"][0]</span><span id="ca70" class="lo jx hi md b fi ml mi l mj mk">prediction_job["predicted_Product_probs"][1]</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/709581d3e8f1c6f1c04ccdf74f9952a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-d9aCClMLmg25HC_IPjMw.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">类间概率分布</figcaption></figure><h1 id="9200" class="jw jx hi bd jy jz nc kb kc kd nd kf kg kh ne kj kk kl nf kn ko kp ng kr ks kt bi translated">限制:</h1><p id="1044" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">BigQuery ML仍处于测试阶段。这是一款相对较新的产品，具有一些非常有前景的特性。然而，它仍然有很长的路要走。到目前为止，它只支持线性回归、二元逻辑回归和多类逻辑回归。多类逻辑回归允许的唯一标签的最大数量是50。</p><p id="efe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个练习的源代码在<a class="ae ln" href="https://github.com/manoveg/ML_with_python/blob/master/bigquery_ml_demo.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上。</p></div></div>    
</body>
</html>