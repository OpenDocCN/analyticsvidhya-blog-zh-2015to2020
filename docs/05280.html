<html>
<head>
<title>KNN vs Decision Tree vs Random Forest for handwritten digit recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ‰‹å†™æ•°å­—è¯†åˆ«çš„KNN vså†³ç­–æ ‘vséšæœºæ£®æ—</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/knn-vs-decision-tree-vs-random-forest-for-handwritten-digit-recognition-470e864c75bc?source=collection_archive---------4-----------------------#2020-04-16">https://medium.com/analytics-vidhya/knn-vs-decision-tree-vs-random-forest-for-handwritten-digit-recognition-470e864c75bc?source=collection_archive---------4-----------------------#2020-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/0c545bab35de956732d6d6a6d6012d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*oUhWO5T1HtPwj5F8sy6tww.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">å–è‡ªMNISTæ•°æ®é›†çš„æ‰‹å†™æ•°å­—</figcaption></figure><div class=""/><p id="6fed" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è¯•å›¾æ¯”è¾ƒä¸‰ç§æœºå™¨å­¦ä¹ ç®—æ³•çš„æ€§èƒ½ï¼Œå³å†³ç­–æ ‘ï¼Œéšæœºæ£®æ—å’Œkæœ€è¿‘é‚»ç®—æ³•ï¼Œç”¨äºä»è‘—åçš„MNISTæ•°æ®é›†ä¸­è¯†åˆ«æ‰‹å†™æ•°å­—ã€‚</p><p id="424f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¼€å§‹ç¼–ç â€¦</p><p id="a9e9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¯¼å…¥æ¨¡å—ï¼ŒåŠ è½½æˆ‘ä»¬çš„æ•°æ®é›†</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="6a77" class="jx jy ht jt b fi jz ka l kb kc">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>df = pd.read_csv(r"D:\ML data\digit prediction\train.csv")<br/>df.head()</span></pre><figure class="jo jp jq jr fd hk er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/2587ff52a2d23a55c545e09d03432be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HtNQ0fPk8eXLqNQFLsbqoQ.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">è¿™é‡Œï¼Œæ¯ä¸ªåƒç´ å±æ€§æŒ‡å®šå›¾åƒåƒç´ çš„åƒç´ å¼ºåº¦</figcaption></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="0f88" class="jx jy ht jt b fi jz ka l kb kc"><strong class="jt hu">#visualising our dataset using matplotlib</strong><br/>image0 = df.iloc[3,1:]<br/>image0                                                <br/>plt.imshow(np.array(image0).reshape(28,28))</span></pre><figure class="jo jp jq jr fd hk er es paragraph-image"><div class="er es ki"><img src="../Images/c6fe556e1ff59a25d9391a23c16f2b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*ycLSZPfO5_ZVLj9i99AV1g.png"/></div></figure><p id="b15a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åˆ›å»ºæˆ‘ä»¬çš„åŸ¹è®­å’Œæµ‹è¯•æ•°æ®</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="171f" class="jx jy ht jt b fi jz ka l kb kc">x = df.iloc[:,1:]<br/>y = df.iloc[:,0]<br/>from sklearn.model_selection import train_test_split<br/>xtrain , xtest ,ytrain, ytest = train_test_split(x,y,test_size =0.2,shuffle = False,random_state =7)</span></pre><p id="599f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">å†³ç­–æ ‘</strong>ğŸŒ²</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="7aea" class="jx jy ht jt b fi jz ka l kb kc">from sklearn.tree import DecisionTreeClassifier <br/>dtree = DecisionTreeClassifier()<br/>dtree.fit(xtrain , ytrain)</span><span id="6b6d" class="jx jy ht jt b fi kj ka l kb kc">from sklearn.metrics import confusion_matrix<br/>cmdtree = confusion_matrix(ytest,ypred)<br/>cmdtree ,dtree.score(xtest , ytest)</span></pre><figure class="jo jp jq jr fd hk er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kk"><img src="../Images/195407ad54b6c9d6f074b1032fb60bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6QY18TSigNpV1j98cnan7g.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">å¸¦æœ‰å‡†ç¡®åº¦åˆ†æ•°çš„æ··æ·†çŸ©é˜µ</figcaption></figure><p id="0d69" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">85 %çš„å‡†ç¡®ç‡ï¼å’©ï¼ï¼Œè‚¯å®šèƒ½åšå¾—æ›´å¥½</p><p id="3751" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">éšæœºæ£®æ—</strong>ğŸŒ´ğŸŒ³ğŸŒ³ğŸŒ³</p><p id="72d7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä½¿ç”¨éšæœºæ£®æ—ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è‚¯å®šåœ°æœŸæœ›ç²¾ç¡®åº¦çš„å¢åŠ ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«è®¤ä¸ºæ˜¯å†³ç­–æ ‘ç®—æ³•çš„ä¼˜åŒ–ç‰ˆæœ¬ã€‚</p><p id="8b99" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç”¨é€šä¿—çš„è¯­è¨€æ¥è¯´ï¼Œéšæœºæ£®æ—ç®—æ³•è€ƒè™‘äº†æˆ‘ä»¬è®­ç»ƒæ•°æ®çš„å‡ ä¸ªå…·ä½“å®ä¾‹ï¼Œå°†å®ƒä»¬åˆ†æˆä¸åŒçš„ç»„(åœ¨æˆ‘çš„ä¾‹å­ä¸­æ˜¯10ä¸ª)ï¼Œç„¶åå¯¹è¿™äº›ç»„åšå‡ºå†³å®šã€‚</p><p id="2f20" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨è¿™äº›æŠ•ç¥¨ä¸­ï¼Œå¤šæ•°äººæŠ•ç¥¨å†³å®šæœ€ç»ˆç»“æœã€‚</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="8f7d" class="jx jy ht jt b fi jz ka l kb kc">from sklearn.ensemble import RandomForestClassifier<br/>rforest = RandomForestClassifier()<br/>rforest.fit(xtrain , ytrain)</span></pre><p id="502c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä½¿ç”¨seabornåº“æ›´å¥½åœ°å¯è§†åŒ–æ··æ·†çŸ©é˜µ</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d8d3" class="jx jy ht jt b fi jz ka l kb kc">cmrforest = confusion_matrix(ytest , ypred)<br/>import seaborn as sn<br/>plt.figure(figsize=(10,7))<br/>sn.heatmap(cmrforest ,annot=True , fmt = 'd')<br/>plt.xlabel('Predicted')<br/>plt.ylabel('Truth')<br/>rforest.score(xtest,ytest)</span></pre><figure class="jo jp jq jr fd hk er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kl"><img src="../Images/c5fa631b051a7b51f69934396936f9e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K1kFqxapY_6VirYTlrZIVw.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">æ›´å¥½çœ‹çš„æ··æ·†çŸ©é˜µ</figcaption></figure><p id="9e83" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ˜¯çš„ï¼Œå‡†ç¡®åº¦å¦‚é¢„æœŸçš„é‚£æ ·æ˜¾è‘—æé«˜ï¼Œå‡†ç¡®åº¦å¾ˆé«˜</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div class="er es km"><img src="../Images/153a22e321fc73cc50b02f030b9ad5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qTgUFWYlYHKrDEuCbA2bLQ.jpeg"/></div></figure><p id="dccb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> KNN ( Kä¸ªæœ€è¿‘é‚»å±…)</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="f0bd" class="jx jy ht jt b fi jz ka l kb kc">from sklearn.neighbors import KNeighborsClassifier<br/>knn = KNeighborsClassifier()<br/>knn.fit(xtrain ,ytrain)<br/>ypred = knn.predict(xtest)<br/>from sklearn.metrics import accuracy_score<br/>accuracy_score(ypred,ytest)</span></pre><figure class="jo jp jq jr fd hk er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kn"><img src="../Images/178f74cdb5e47648bef844415a01849e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fYbZN5ztI-NDV2XWU3O6kw.png"/></div></div></figure><p id="b569" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å› æ­¤ï¼Œå‡†ç¡®ç‡å†æ¬¡æé«˜åˆ°96 %ï¼Œä½†ä»£ä»·æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p id="37a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¼—æ‰€å‘¨çŸ¥ï¼ŒKNNæ˜¯ä¸€ä¸ªæ‡’æƒ°çš„å­¦ä¹ è€…ï¼Œå®ƒä¼šè®°ä½æ•°æ®ï¼Œå› æ­¤è®­ç»ƒæ—¶é—´ä¸º0ã€‚å› ä¸ºå®ƒä¸é’ˆå¯¹å‚æ•°æˆ–æƒé‡è¿›è¡Œè®­ç»ƒã€‚</p><p id="7869" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å®ƒå®é™…ä¸Šåœ¨é¢„æµ‹çš„æ—¶å€™åšäº†æ‰€æœ‰çš„å·¥ä½œã€‚å…¶å¤æ‚åº¦ä¸ºn * m *dï¼Œå…¶ä¸­næ˜¯è®­ç»ƒæ•°æ®çš„å¤§å°ï¼Œmæ˜¯æµ‹è¯•æ•°æ®çš„å¤§å°ï¼Œdæ˜¯æ¯æ¬¡æµ‹è¯•è¦æ‰§è¡Œçš„æ“ä½œçš„æ•°é‡ã€‚</p><p id="51be" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¤§çº¦10å¤šåˆ†é’Ÿåï¼Œå®ƒå®Œæˆäº†é¢„æµ‹ã€‚</p><p id="3fc2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">ç»“è®º</strong></p><p id="22a3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¦‚ä¸Šæ‰€è¿°ï¼Œå†³ç­–æ ‘ä»¥85 %çš„å‡†ç¡®ç‡ç¬é—´å®Œæˆï¼Œéšæœºæ£®æ—ä»¥94 %çš„å‡†ç¡®ç‡ç”¨å¾ˆå°‘çš„è¿è¡Œæ—¶é—´å®Œæˆï¼ŒKNNä»¥96 %çš„å‡†ç¡®ç‡ç”¨ç›¸å½“å¤šçš„è¿è¡Œæ—¶é—´å®Œæˆï¼Œå¹¶ä¸”ä¸€ç›´å ç”¨èµ„æºã€‚</p><p id="876b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å®Œæ•´çš„ä»£ç è¯·å‚è€ƒæˆ‘çš„githubåº“<a class="ae ko" href="https://github.com/kashish07/" rel="noopener ugc nofollow" target="_blank">https://github.com/kashish07/</a></p><p id="b582" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ³¨æ„:æ²¡æœ‰ä½¿ç”¨ç¥ç»ç½‘ç»œï¼Œå› ä¸ºé‚£æ ·ä¼šç ´åç«äº‰ã€‚</p></div></div>    
</body>
</html>