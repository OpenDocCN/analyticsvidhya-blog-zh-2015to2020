<html>
<head>
<title>Corona Virus Data Infographics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电晕病毒数据信息图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/corona-virus-data-infographics-8bf835641ced?source=collection_archive---------20-----------------------#2020-03-03">https://medium.com/analytics-vidhya/corona-virus-data-infographics-8bf835641ced?source=collection_archive---------20-----------------------#2020-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7041a847453297206d19c926ad06d9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*N0tU-Rn2fDcQR68j.png"/></div></div></figure><p id="0abc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作为仪表板:</p><p id="3409" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="http://infographics.quantecdc.es:8080/dashboard" rel="noopener ugc nofollow" target="_blank">http://infographics.quantecdc.es:8080/dashboard</a></p><p id="cf70" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从2020年1月起，冠状病毒开始在中国出现一些报告的区域性病例。现在，在二月底，这种疾病显然被揭示为一种世界范围的现象，因为它很容易在我们相互联系的世界中传播，甚至最近还在以越来越快的速度传播。</p><p id="7689" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本信息图表应用程序使用的数据源由链接<a class="ae jo" href="https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/sudalairajkumar/novel-corona-virus-2019-dataset</a>提供，许可许可证为CC0: Public Domain。数据首先由约翰·霍普金斯大学和世卫组织、疾病预防控制中心、NHC和DXY收集。感谢定期更新。</p><h1 id="482d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">展示世界地理数据</h1><p id="575b" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">为了呈现数据，例如全球传播，我们使用了我们最近提出的python中的散景模块框架以及反应式角度前端。后端和前端完美地结合在一起。数据处理在python后端非常方便地完成，图表可以很容易地在Bokeh模块中创建，然后嵌入前端，具有更好的数据控制，因为任何事件现在都可以导致所呈现数据的重新绘制。</p><p id="acab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">电晕病毒在世界范围内传播的一个有趣的方面是地理位置。幸运的是，所有国家的轮廓都可以在github上获得，没有任何限制性许可(【https://github.com/johan/world.geo.json】T4)。然后可以将轮廓绘制成面片。在散景中，这是通过几行代码完成的:</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="f564" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们用红色半透明圆圈显示了冠状病毒感染的确认数量。面积应该主要与统计的数字成比例，但是由于与其他地方报道的小于10的数字相比，中国几万例感染的令人发指的数字，我们必须做出妥协:最小半径是1，最大半径是20(在内部数据空间单位中)。</p><p id="94cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">圆圈的位置与号码所属的国家有关。我们从名为geopy.geocoders的python模块中提供的<em class="ky">nominam</em>中获得的国家坐标。</p><p id="c175" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于数据固有的时间依赖性，我们将日期作为用户可选择的参数。因此，用户可以通过从数据开始的1月22日到今天连续地改变日期，至少粗略地跟踪世界范围。正如之前已经说过的:由于中国的感染人数太多，这个观察有点偏颇。所以让我们仔细看看每个国家。</p><h1 id="05c8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">关注每个国家确诊的感染人数</h1><p id="c06d" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">通过分别提取每个国家的数据，可以更好地观察时间相关性。这在下面的条形图中完成。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/df41183826510296a4593874496a6cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NX31z73YqXPGMEa8.png"/></div></div></figure><p id="3ede" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我们想介绍一些关于熊猫的技术，这些技术可能有助于处理这类数据。在熊猫体内读取csv数据就像</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="9cca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二行将观察数据列转换成python <em class="ky"> datetime </em>格式，这最终是一个与字符串日期相对比的可比较对象。因为我们对每个城市或省份的数据不感兴趣，所以我们积累了关于国家列和观察日期列的数据。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="a478" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了重新排列索引并再次创建一个单独的国家和日期列，我们使用了最后三行，这对于熊猫来说也不是很明显。用户现在可以选择其中一个国家，并立即收到条形图。</p><h1 id="5051" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Angular和Python中的事件</h1><p id="5d52" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">Angular已经实现并建立在一个固有的事件驱动机制之上，这就是为什么将Python的<em class="ky">异步</em>范例与Angular事件检测结合起来显然是非常有吸引力的。</p><p id="5278" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Python方面，处理<em class="ky">异步</em>的最成熟的web服务器是<em class="ky"> aiohttp </em>。它还提供了一种简单的可能性，即打开一个websocket服务器，Angular客户机可以连接到这个服务器上。</p><p id="5f00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上次我们发布了angular和Bokeh图表的组合，我们通过<em class="ky"> websocket </em>连接将json格式的图表发送到Angular。但是我们依赖于ajax调用来更新，因为BokehJS API主要提供了嵌入图表的黑盒嵌入方法。在更深入地研究了API之后，不使用embed方法而是一步一步地进行嵌入似乎是非常可行的。因此，我们能够提取bokeh文档对象，并从该对象中访问数据源。</p><p id="4ab7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于互联网上有很多可用的视图示例，我们决定提供一点见解，让您了解可以对源对象做些什么，以及我们实际上如何使用它来将更新范例更改为事件驱动。</p><h1 id="fb49" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">源对象更新</h1><p id="a0bc" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们现在把重点放在有角的一面。首先，我们创建一个连接到全局散景对象的服务</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="6da1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">散景库包含在html文件中，有以下两行:</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="9357" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在接收到Python中以<em class="ky"> json </em>格式生成的图表项作为项后，我们可以生成一个<em class="ky">散景</em>文档对象，从中我们可以提取最相关的文档源</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="106f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其中在数据模型的后端使用相同的名称“map-circles”是很重要的。实际的嵌入现在像这样工作</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="22a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第三行是悬停工具正常工作所必需的。既然我们已经访问了源代码，那么继续我们通常的事件驱动更新就不那么困难了。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="9676" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每当相关的<em class="ky"> websocket </em>消息到达<em class="ky"> MessageService </em>时，就会发出source change事件，这将导致一个固有的图表重绘事件。对于任何新源，该订阅必须只进行一次，并且应该确保当图表组件被移除时，订阅被取消订阅。</p><p id="fefb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的下一篇文章中，我们将给出更多关于事件的python后端处理的见解。我们认为，从我们的角度来看，使用<em class="ky"> websocket </em>连接有一些优势，因为它还提供了显示后端事件的可能性，而这在纯web api中是不可能的。</p></div></div>    
</body>
</html>