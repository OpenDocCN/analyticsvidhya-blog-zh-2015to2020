<html>
<head>
<title>Web scraping with Complete ease</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">完全轻松地进行网页抓取</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/web-scraping-with-complete-ease-ee77bd605ba3?source=collection_archive---------16-----------------------#2020-11-17">https://medium.com/analytics-vidhya/web-scraping-with-complete-ease-ee77bd605ba3?source=collection_archive---------16-----------------------#2020-11-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="726a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Ralger 包让网页抓取变得再简单不过了</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/d06543ec02a21adee3b5447fc1b507ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2vwDKDj3ZBdT5jiksaJpgw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:Pixabay</figcaption></figure><p id="55f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你像我一样，需要经常上网，那你就有得吃了。作为一名数据科学家，你将经常负责数据集的创建，因此网络抓取是你工具箱中一项非常重要的技能。在这里，我不会深入讨论这么多关于网络抓取的理论，你可能需要看看我写的这篇文章。你还应该学习如何在我的文章中详细描述的 chromium 浏览器中使用<a class="ae jt" href="https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb?hl=en" rel="noopener ugc nofollow" target="_blank"> SelectorGadget </a>。</p><p id="649d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个<strong class="ih hj"> Ralger </strong>软件包是由 Fodil 开发的，他是经济学博士候选人，也是一个狂热的 R 开发者。你也可以在 Twitter 上关注他。我将带你了解这个令人敬畏的软件包是如何极大地简化你的网页抓取过程的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ju"><img src="../Images/f2fcc9cb5391cda83a937903f066deed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmXUMvagqdytnmSyEXl-2A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:Pixabay</figcaption></figure><h2 id="1270" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><strong class="ak">报废()</strong></h2><p id="074d" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">我要介绍的第一个函数是<strong class="ih hj"> scrap() </strong>函数。我将为此使用<a class="ae jt" href="https://www.imdb.com/chart/top/" rel="noopener ugc nofollow" target="_blank"> IMDB </a>页面以及其他几个页面。我想删除电影标题，但是，我将与 rvest 包(这可能是 R 中最流行的 web 抓取包)进行比较；</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="a5a2" class="jv jw hi kw b fi la lb l lc ld">#With Rvest<br/>"<a class="ae jt" href="https://www.imdb.com/chart/top/" rel="noopener ugc nofollow" target="_blank">https://www.imdb.com/chart/top/</a>" %&gt;% <br/>  read_html() %&gt;% <br/>  html_nodes(".titleColumn a") %&gt;% <br/>  html_text()</span><span id="452d" class="jv jw hi kw b fi le lb l lc ld">#with Ralger<br/>df &lt;- scrap(link = "<a class="ae jt" href="https://www.imdb.com/chart/top/" rel="noopener ugc nofollow" target="_blank">https://www.imdb.com/chart/top/</a>", node =  ".titleColumn a")</span><span id="8c5f" class="jv jw hi kw b fi le lb l lc ld">#Examine the first 10 values<br/>df[1:10]</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/d3470c0a2230bcaf97f79f34ce17fa42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JldWEkluhovZ0HvczAcjZw.png"/></div></div></figure><p id="4c01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj"> scrap() </strong>函数，一行代码(链接和节点)就可以从页面中提取感兴趣的内容。</p><h2 id="f355" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><strong class="ak"> table_scrap() </strong></h2><p id="7e43" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">table_scrap()函数可以帮助你用一行代码提取页面中的任何表格。看看这个<a class="ae jt" href="https://en.wikipedia.org/wiki/List_of_members_of_the_House_of_Representatives_of_Nigeria,_2015%E2%80%932019" rel="noopener ugc nofollow" target="_blank">维基百科链接</a>中的表格，比较一下 Ralger 包是如何无缝提取的。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="7f4f" class="jv jw hi kw b fi la lb l lc ld">df &lt;-table_scrap("<a class="ae jt" href="https://en.wikipedia.org/wiki/List_of_members_of_the_House_of_Representatives_of_Nigeria,_2015%E2%80%932019" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/List_of_members_of_the_House_of_Representatives_of_Nigeria,_2015%E2%80%932019</a>")</span><span id="b574" class="jv jw hi kw b fi le lb l lc ld">head(df)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/3f73cbc5765161950c0b0009b49fba0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ui66Mq8UmF1g6CZE5KRyfQ.png"/></div></div></figure><p id="1f8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对我来说，使用这个函数的最大好处是我不需要重建任何节点。它只是进入 web 链接并提取表格。万一页面上有多个表格，您可以通过函数中的<strong class="ih hj">选择</strong>选项来指定提取哪个表格。</p><h2 id="407c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">tidy_scrap()</h2><p id="c333" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">您是否一直希望废弃多个节点，然后自动将它们全部合并到一个数据帧中，这个函数使其易于无缝执行。从 IMDB 页面中，我想提取电影名称、等级、年份以及等级等，然后将其全部转换为数据帧。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="d315" class="jv jw hi kw b fi la lb l lc ld">#Save the link in a veriable<br/>link &lt;- "<a class="ae jt" href="https://www.imdb.com/chart/top/" rel="noopener ugc nofollow" target="_blank">https://www.imdb.com/chart/top/</a>"</span><span id="405e" class="jv jw hi kw b fi le lb l lc ld">#Specify all the nodes you want to extract<br/>nodes &lt;- c(".titleColumn a", #Movie title node<br/>           ".secondaryInfo", #Year node<br/>           ".imdbRating") #Ratings node</span><span id="b837" class="jv jw hi kw b fi le lb l lc ld">#Specify column names for each nodes to be extracted<br/>columns &lt;- c("MovieTitle", "Year", "Rating") </span><span id="3cc2" class="jv jw hi kw b fi le lb l lc ld">#Use the tidy_scrap function for this. <br/>df &lt;- tidy_scrap(link = link,nodes = nodes, colnames = columns)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/92406cea3a16abba7635056fee73d72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*v-C88ketTYm_ugoGZDGvGg.png"/></div></figure><p id="9add" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，函数中有<strong class="ih hj">节点</strong>，这意味着您可以根据需要指定任意多的节点。</p><p id="7f9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终展示这个 R 包的全部威力。查看这篇 R 教程<a class="ae jt" href="https://www.analyticsvidhya.com/blog/2017/03/beginners-guide-on-web-scraping-in-r-using-rvest-with-hands-on-knowledge/" rel="noopener ugc nofollow" target="_blank">这里</a>，注意完全删除所有需要的信息需要多少行代码。我将尝试对 Ralger 包做同样的事情。</p><pre class="je jf jg jh fd kv kw kx ky aw kz bi"><span id="70d8" class="jv jw hi kw b fi la lb l lc ld">#All nodes needed<br/>m_nodes &lt;- c(".lister-item-header a", #Title Node<br/>  ".genre", #Genre node<br/>  ".runtime", #Runtime Node<br/>  ".ratings-imdb-rating", #Rating Node<br/>  ".sort-num_votes-visible span:nth-child(2)", #Votes node<br/>  ".ghost~ .text-muted+ span", #Gross node<br/>  ".text-muted+ p a:nth-child(1)") #Director node</span><span id="20eb" class="jv jw hi kw b fi le lb l lc ld">#Column names<br/>columns &lt;- c("MovieTitle", "Genre", "Runtime", "Rating", "Votes", "Gross", <br/>             "Director")</span><span id="b782" class="jv jw hi kw b fi le lb l lc ld">#Scrap function<br/>df &lt;- tidy_scrap("<a class="ae jt" href="https://www.imdb.com/search/title/?count=100&amp;release_date=2016,2016&amp;title_type=feature" rel="noopener ugc nofollow" target="_blank">https://www.imdb.com/search/title/?count=100&amp;release_date=2016,2016&amp;title_type=feature</a>",<br/>      nodes = m_nodes, colnames = columns )</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/9923fd43daf03a67897140f8492b9d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8h_nIsYxS4p0bANUSCujFQ.png"/></div></div></figure><p id="715b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">毫无疑问，这是一个非常酷的工具！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/1dd64eaa2580dadbf6a7fa5d25b2488a.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*9eNQQwTAFt6LHP9Dq8CdPg.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">资料来源:Giphy</figcaption></figure><p id="3176" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以探索的另一个特性是<code class="du lk ll lm kw b">askRobot = T</code>询问<code class="du lk ll lm kw b">robots.txt</code>文件是否允许抓取特定的网页。它存在于所有的功能中，你可以快速检查你是否被允许废弃一个网站。很酷是吗？？</p><h2 id="0104" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">结论</h2><p id="b1b1" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这无疑是您希望在数据科学武库中拥有的一件武器。您可以在<a class="ae jt" href="https://github.com/feddelegrand7/ralger" rel="noopener ugc nofollow" target="_blank">这里</a>进一步查看，因为您可以找到更多对您的用例有用的功能。</p></div></div>    
</body>
</html>