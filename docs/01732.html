<html>
<head>
<title>How to cluster dataset with high dimensionality and mixed datatypes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对高维混合数据类型的数据集进行聚类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-cluster-dataset-with-high-dimensionality-and-mixed-datatypes-b2b0b9ee24d6?source=collection_archive---------11-----------------------#2019-11-11">https://medium.com/analytics-vidhya/how-to-cluster-dataset-with-high-dimensionality-and-mixed-datatypes-b2b0b9ee24d6?source=collection_archive---------11-----------------------#2019-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="68ed" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用GLRM进行聚类分析和客户细分</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/732b42db7d7bfca12186dd5779d2981e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZNdic0gCpv8yrBC0.png"/></div></div></figure><p id="ba45" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">集群的挑战</strong></p><p id="2527" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在对零售和电子商务客户数据进行聚类分析时，您通常会发现数据集杂乱无章、高维且包含许多分类变量。虽然有许多降维技术，但大多数都不能很好地处理包含许多分类变量的数据集。传统上，当特征不是干净的数值时，聚类方法会受到影响。例如，最流行的KNN算法只能处理数值变量。</p><p id="0816" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">广义低秩模型</strong></p><p id="50db" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">由斯坦福大学的学生开发的广义低秩模型(GLRMs)(见<a class="ae kf" href="https://web.stanford.edu/~boyd/papers/pdf/glrm.pdf" rel="noopener ugc nofollow" target="_blank"> Udell '16 </a>)提出了一种新的聚类框架来处理所有类型的数据，即使是混合数据类型。使用GLRMs，可以将分类列转换为二进制列。对于其他技术来说，在这种类型的数据集上生成聚类被认为太麻烦了。</p><p id="cfb8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">GLRM的好处是:</p><ul class=""><li id="ffa8" class="kg kh hi jl b jm jn jp jq js ki jw kj ka kk ke kl km kn ko bi translated">减少所需的存储</li><li id="8d6e" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">启用数据可视化</li><li id="649b" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">消除噪音</li><li id="4fe1" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">估算缺失数据</li><li id="999b" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">简化数据处理</li></ul><p id="0391" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以找到更多关于H2O GLRM包装的信息。</p><p id="e3fc" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">使用GLRM变换数据集</strong></p><p id="cb45" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我使用的数据集来自一个虚构的销售cookie订阅的电子商务公司。如您所见，它包含18个变量，其中许多是分类变量。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ku"><img src="../Images/965f7d59b4f8af75fef151f9eaf14862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VnQmd0miRak3XoKISxhc_w.png"/></div></div></figure><p id="2594" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">H2O是一个具有R接口的开源机器学习框架，具有很好的并行实现GLRM的步骤:</p><ol class=""><li id="19fe" class="kg kh hi jl b jm jn jp jq js ki jw kj ka kk ke kv km kn ko bi translated">初始化集群<code class="du kw kx ky kz b">h2o.init()</code></li><li id="cc1d" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kv km kn ko bi translated">存储输入数据<code class="du kw kx ky kz b">as.h2o()</code></li><li id="87ba" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kv km kn ko bi translated">使用<code class="du kw kx ky kz b">h2o.glrm()</code>启动一个K=2的GLRM模型(秩2模型)</li></ol><p id="7013" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">GLRM模型生成X和Y矩阵。x矩阵已经通过调用:x . m = as . data . table(H2O . get frame(m _ glrm @ model $ re presentation _ name))获得</p><p id="40f8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以看到X矩阵由两个原型组成。现在原始数据集已经简化为二维数值数据集。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es la"><img src="../Images/690ac44421987e012f1b8f8a7adc0a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*53uIltroR444YuC_giNlqQ.png"/></div></figure><p id="7def" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">使用K均值算法进行聚类</strong></p><p id="e63d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">要确定分类的数量:</p><p id="ea4e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">首先，我使用map_dbl运行许多k值不同的模型。</p><p id="3fd0" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">tot_withinss = map_dbl(1:10，function(k){<br/>model = k means(x = x . m，centers = k)<br/>model $ tot . withinss<br/>})</p><p id="b077" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">其次，我生成了一个同时包含k和tot_withinss的数据帧。</p><p id="c419" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">elbow_df </p><p id="b900" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">第三，我画肘图。这里的肘点是3。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lb"><img src="../Images/72ca31510354b9fced6707e182f21560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*IRafyv6cr41uMQ5cstWwtg.png"/></div></figure><p id="5eb5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后，我使用k-mean算法创建了3个聚类，并用factoextra软件包绘制了这些聚类。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lb"><img src="../Images/075daa3452ed110fdc8d57953120bf94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*jGU4vrYHEqCJcv2NTtQFlg.png"/></div></figure><p id="862f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最后，我将聚类添加到原始数据集中，并使用聚类进行更多的分析和形成客户洞察力。例如，分类3的预测LTV最高，前90天的收入最高。更多EDA可以在我在github上的演示中找到。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lc"><img src="../Images/3282fb0337dcca21bdc3963b28054922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9OGGeSM3AAbffTAWrM83-A.png"/></div></div></figure><p id="afa7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以在<a class="ae kf" href="https://github.com/ellendeng/clustering_wGLRM" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到R代码，如果有任何问题，请随时在<a class="ae kf" href="https://www.linkedin.com/in/ellen-deng/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p></div></div>    
</body>
</html>