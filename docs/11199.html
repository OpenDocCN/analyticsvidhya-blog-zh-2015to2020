<html>
<head>
<title>Time Series in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的时间序列</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-in-machine-learning-c3299742b2e1?source=collection_archive---------15-----------------------#2020-11-22">https://medium.com/analytics-vidhya/time-series-in-machine-learning-c3299742b2e1?source=collection_archive---------15-----------------------#2020-11-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1823" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是时间序列？</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/a1616d8757d2986ac57c0600073a3ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*CYedRkH3WbjqB0CzkHWSYQ.png"/></div></figure><p id="0bb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">时间序列是按时间顺序索引(或列出或绘制)的一系列数据点。最常见的是，时间序列是在连续的等间隔时间点取得的序列。因此，它是一个离散时间数据序列。例如，固定时间段内的股票价格、酒店预订、电子商务销售、天气周期报告等。</p><p id="8feb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">时间序列分析包括用于分析时间序列数据的方法，以便提取有意义的统计数据和数据的其他特征。时间序列预测是使用模型根据以前观察到的值来预测未来值。</p><p id="c74c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们先讨论几个与时间序列相关的定义。</p><p id="92ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义</strong></p><ul class=""><li id="07b8" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated"><strong class="ih hj">级别:</strong>级别是系列值的平均值。</li><li id="5f1e" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated"><strong class="ih hj">趋势:</strong>趋势显示数据中的模式。例如，股票价格是随时间上升(上升趋势)，还是随时间下降(下降趋势)，或者时间对价格没有太大影响(水平趋势)</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/5d5a199ac4f6f88a653b40ac41ebc600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*kb8nEqOHwOiyYQwuzA7YcA.png"/></div></figure><ul class=""><li id="2f8a" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated"><strong class="ih hj">季节性:</strong>当数据显示一年以上的重复模式时，可称为季节性模式。例如，空调的销售在夏季每年都会增加，而在冬季会减少。</li><li id="da7c" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated"><strong class="ih hj">循环模式:</strong>这些是在较长时间内(一年以上)显示的重复模式。例如，每隔五年，由于大选，股票市场就会有一些波动。</li><li id="ed53" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated"><strong class="ih hj">噪声:</strong>不显示任何模式的变化。</li></ul><p id="4c26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们举一个例子来看看在时间序列分析出现之前都做了些什么。</p><p id="7183" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们手头有一个问题，我们被要求为一家体育制造商预测滑雪产品的销售。您可以使用以下方法进行预测:</p><p id="53d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">旧方法</strong></p><ul class=""><li id="2679" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated"><strong class="ih hj">使用 Average: </strong>您可以将预测作为所有先前值的平均值。</li><li id="5d17" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated"><strong class="ih hj">使用移动平均:</strong>这是一段固定时间内以前值的平均值。例如，您可以根据过去 3 个月的平均值来预测 11 月的销售额。过去的三个月将是八月、九月和十月。如果你预测 12 月份的销售额，那么过去的三个月将是 9 月、10 月和 11 月。虽然考虑的月数相同，但是窗口从一组月移到另一组月。因此得名移动平均线。</li><li id="5148" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated"><strong class="ih hj">使用朴素方法:</strong>朴素方法认为预测将与最后一个数字相同。例如，11 月的预测将是 10 月的销售额。</li><li id="9cf2" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated"><strong class="ih hj">使用季节性朴素法:</strong>季节性朴素法类似于朴素法。这里，新的预测等于上一季度的销售额。</li></ul><p id="5be8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看 Python 中时间序列的编码部分</p><h1 id="3ab3" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">ARIMA(自动回归综合移动平均)</h1><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="c054" class="ld kb hi kz b fi le lf l lg lh"><strong class="kz hj">import</strong> numpy <strong class="kz hj">as</strong> np<br/><strong class="kz hj">from</strong> scipy <strong class="kz hj">import</strong> stats<br/><strong class="kz hj">import</strong> pandas <strong class="kz hj">as</strong> pd<br/><strong class="kz hj">import</strong> matplotlib.pyplot <strong class="kz hj">as</strong> plt<br/><strong class="kz hj">import</strong> statsmodels.api <strong class="kz hj">as</strong> sm<br/><strong class="kz hj">from</strong> statsmodels.graphics.api <strong class="kz hj">import</strong> qqplot<br/><strong class="kz hj">%</strong>matplotlib inline</span><span id="8e36" class="ld kb hi kz b fi li lf l lg lh">In[]:<br/>female_birth_data<strong class="kz hj">=</strong>pd.read_csv("daily-total-female-births-CA.csv")</span><span id="30b4" class="ld kb hi kz b fi li lf l lg lh"><em class="lj"># This is a free datset</em></span></pre><div class="lk ll ez fb lm ln"><a href="https://drive.google.com/file/d/1ZZZz82rgYc1cWPoAdXjI6z2nwlLUpK59/view?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hj fi z dy ls ea eb lt ed ef hh bi translated">每日-女性分娩总数-CA.csv</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">编辑描述</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">drive.google.com</p></div></div></div></a></div><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="33b4" class="ld kb hi kz b fi le lf l lg lh">In [ ]:</span><span id="bd0b" class="ld kb hi kz b fi li lf l lg lh">female_birth_data.head()</span></pre><p id="01c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[ ]:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es lw"><img src="../Images/c78e7e9afb5dcb3f6f0f16787e426760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rwwN_t438XKvF45lGqAfIw.png"/></div></div></figure><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="69fc" class="ld kb hi kz b fi le lf l lg lh">In [ ]:</span><span id="b357" class="ld kb hi kz b fi li lf l lg lh">birth_data<strong class="kz hj">=</strong>pd.read_csv("daily-total-female-births-CA.csv", index_col<strong class="kz hj">=</strong>[0], parse_dates<strong class="kz hj">=</strong>[0])</span><span id="b1fa" class="ld kb hi kz b fi li lf l lg lh">birth_data.head()</span></pre><p id="2171" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[ ]:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mb"><img src="../Images/64b6d09b26012d0c888e8c02fe9af8d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rvay66VP630PaLpq-kS8gA.png"/></div></div></figure><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="def4" class="ld kb hi kz b fi le lf l lg lh">In [ ]:<br/>birth_data.describe()</span></pre><p id="4099" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[ ]:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mc"><img src="../Images/4a29151f3b9b18c95be65d4583a55345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nR-IdXt93fYY07OuscV-NQ.png"/></div></div></figure><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="6443" class="ld kb hi kz b fi le lf l lg lh">In[]:<br/>birth_data.plot() <em class="lj">#almost a stationary series</em></span></pre><p id="26c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[ ]:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/d8cf83f2e268153fd299716ccb5b6db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*FP16-qAH2CvPCz82o0E7GA.png"/></div></figure><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="c0af" class="ld kb hi kz b fi le lf l lg lh">In[]:</span><span id="f1d5" class="ld kb hi kz b fi li lf l lg lh"><em class="lj"># also called as smoothing</em></span><span id="310b" class="ld kb hi kz b fi li lf l lg lh">moving_average_birth<strong class="kz hj">=</strong>birth_data.rolling(window<strong class="kz hj">=</strong>20).mean() </span><span id="29bf" class="ld kb hi kz b fi li lf l lg lh"><em class="lj"># window: This is the number of observations used for calculating the statistic.</em></span><span id="03d3" class="ld kb hi kz b fi li lf l lg lh">In []:</span><span id="fc1f" class="ld kb hi kz b fi li lf l lg lh">moving_average_birth</span></pre><p id="66a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[22]:</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="eca5" class="ld kb hi kz b fi le lf l lg lh">In [ ]:<br/>moving_average_birth.plot() <em class="lj"># we can see that there is a peak in the month of october</em></span></pre><p id="741e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[ ]:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/d8cf83f2e268153fd299716ccb5b6db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*FP16-qAH2CvPCz82o0E7GA.png"/></div></figure><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="ab54" class="ld kb hi kz b fi le lf l lg lh">&lt;matplotlib.axes._subplots.AxesSubplot at 0x1f150907b00&gt;</span></pre><p id="0bf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在[25]中:</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="0a63" class="ld kb hi kz b fi le lf l lg lh">sm.stats.durbin_watson(birth_data) <em class="lj"># very less correlation</em></span></pre><p id="5fa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[25]:</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="d5f4" class="ld kb hi kz b fi le lf l lg lh">array([0.04624491])</span><span id="f28f" class="ld kb hi kz b fi li lf l lg lh">In [ ]:<br/><em class="lj"># show plots in the notebook<br/></em><strong class="kz hj">%</strong>matplotlib inline<br/>fig <strong class="kz hj">=</strong> plt.figure(figsize<strong class="kz hj">=</strong>(12,8))<br/>ax1 <strong class="kz hj">=</strong> fig.add_subplot(211)<br/>fig <strong class="kz hj">=</strong> sm.graphics.tsa.plot_acf(birth_data.values.squeeze(), lags<strong class="kz hj">=</strong>40, ax<strong class="kz hj">=</strong>ax1)<br/>ax2 <strong class="kz hj">=</strong> fig.add_subplot(212)<br/>fig <strong class="kz hj">=</strong> sm.graphics.tsa.plot_pacf(birth_data, lags<strong class="kz hj">=</strong>40, ax<strong class="kz hj">=</strong>ax2)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es me"><img src="../Images/8daba7c90ee8f6341cd2b3c546ba73f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZMjgSVMod0_-d9BMYZx_Q.png"/></div></div></figure><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="5d7d" class="ld kb hi kz b fi le lf l lg lh">In []:</span><span id="2bd4" class="ld kb hi kz b fi li lf l lg lh">training_data<strong class="kz hj">=</strong>birth_data[0:320]<br/>test_data<strong class="kz hj">=</strong>birth_data[320:]</span><span id="204c" class="ld kb hi kz b fi li lf l lg lh">In []:</span><span id="2e82" class="ld kb hi kz b fi li lf l lg lh">from sklearn.model_selection import train_test_split</span><span id="db78" class="ld kb hi kz b fi li lf l lg lh">t_x,t=train_test_split(birth_data)<br/></span><span id="313d" class="ld kb hi kz b fi li lf l lg lh">In []:<br/><strong class="kz hj">from</strong> statsmodels.tsa.arima_model <strong class="kz hj">import</strong> ARIMA</span><span id="27e1" class="ld kb hi kz b fi li lf l lg lh">In []:<br/>arima<strong class="kz hj">=</strong> ARIMA(training_data,order<strong class="kz hj">=</strong>(2,1,3))</span><span id="d419" class="ld kb hi kz b fi li lf l lg lh">model<strong class="kz hj">=</strong>arima.fit()<br/>model.aic</span><span id="6219" class="ld kb hi kz b fi li lf l lg lh">Out[ ]:<br/>2159.076974912458</span><span id="3344" class="ld kb hi kz b fi li lf l lg lh">In []:</span><span id="4774" class="ld kb hi kz b fi li lf l lg lh">pred<strong class="kz hj">=</strong> model.forecast(steps<strong class="kz hj">=</strong>45)[0]</span><span id="f31b" class="ld kb hi kz b fi li lf l lg lh">pred</span></pre><p id="22be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Out[ ]:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/c8e44b3e1560db2837b24a1ba2527502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*nYotfWlMgU42_1eurbwtqA.png"/></div></figure><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="4fac" class="ld kb hi kz b fi le lf l lg lh">In []:</span><span id="c215" class="ld kb hi kz b fi li lf l lg lh"><strong class="kz hj">from</strong> sklearn.metrics <strong class="kz hj">import</strong> mean_squared_error</span><span id="30ef" class="ld kb hi kz b fi li lf l lg lh">np.sqrt(mean_squared_error(test_data,pred))</span><span id="e78d" class="ld kb hi kz b fi li lf l lg lh">Out[]:<br/>6.419420721712673</span></pre><p id="1b4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将通过预测股票价格来进一步讨论 RNN 的时间序列。</p><p id="c12d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章</p><p id="400f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请喜欢，喜欢的话查看我的其他内容</p><p id="92e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那就跟我来</p></div></div>    
</body>
</html>