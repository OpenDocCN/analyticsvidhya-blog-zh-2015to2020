<html>
<head>
<title>File Handling in PYTHON</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PYTHON 中的文件处理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/file-handling-in-python-673a484b34bb?source=collection_archive---------15-----------------------#2020-10-08">https://medium.com/analytics-vidhya/file-handling-in-python-673a484b34bb?source=collection_archive---------15-----------------------#2020-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="aaac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始 python 中的文件处理之旅吧！！！</p><h1 id="07a2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">文件处理</h1><p id="863e" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">Python 也像其他语言一样支持文件处理，包括不同的文件操作，如打开文件、读取、写入和关闭文件，但在深入研究之前，我们首先需要了解我们为什么要进行文件处理，什么是文件处理的需要。</p><p id="6441" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文件是磁盘上存储信息的指定位置。它将数据存储在像硬盘一样的非易失性存储器中，因为我们知道随机存取存储器是易失性的，当计算机关闭时它肯定会丢失数据，所以我们使用文件来存储数据。</p><p id="e72c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在文件处理中，当我们想先读一个文件或想先写一个文件时，我们需要先打开该文件，当我们完成时，它需要被关闭，以便与该文件相关的资源被释放。</p><h1 id="06a4" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">文件操作</h1><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/4cf4c650fe13c38419964d35dbbf6a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*3kl7vDc5wMQWB4k0QD2z7Q.png"/></div></figure><ul class=""><li id="79b7" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">打开一个文件</li><li id="a4b4" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">读取和写入(执行操作)</li><li id="cfcd" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">关闭文件</li></ul><h1 id="939f" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">打开文件</h1><p id="7dca" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">python 有打开文件的内置函数。这个函数返回一个文件对象，也称为句柄。我们称之为句柄，因为它用于相应地读取或修改文件。</p><p id="7c8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">f =打开('文件名. txt ')</p><p id="a593" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以指定打开文件的模式。我们还可以指定我们是想以文本模式还是二进制模式打开文件。</p><h2 id="7e35" class="lc je hi bd jf ld le lf jj lg lh li jn iq lj lk jr iu ll lm jv iy ln lo jz lp bi translated">Python 文件模式</h2><ul class=""><li id="419b" class="ko kp hi ih b ii kb im kc iq lq iu lr iy ls jc kt ku kv kw bi translated">r '打开文件进行读取(默认)</li><li id="fd51" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">如果它不存在，它将创建一个新文件；如果它存在，它将截断该文件。</li><li id="7d19" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">x '以独占方式打开文件，但如果文件已经存在，操作将失败。</li><li id="6dbb" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">一个'打开附加在文件的末尾，不截断它，如果没有文件存在，然后它创建一个新的。</li><li id="2636" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">以文本模式打开文件(默认)</li><li id="8bbf" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">' b '以二进制模式打开文件。我们可以使用二进制模式来存储矩阵或数据列表。</li><li id="eb21" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">+'打开文件进行更新(读写)</li></ul><p id="9867" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如:</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="285a" class="lc je hi lu b fi ly lz l ma mb">f=open('file_name.txt')   #equivalent to read</span><span id="28be" class="lc je hi lu b fi mc lz l ma mb">f=open('file_name.txt','r')</span><span id="fa44" class="lc je hi lu b fi mc lz l ma mb">f=open('file_name.txt','w')</span></pre><p id="c758" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认编码依赖于平台，比如在 window 中是“cp1252”，但在 linux 中是“utf-8”。在 python 中，假设我们以读模式打开一个文件，那么首先 python 与操作系统对话文件操作，然后操作系统与文件对话。因此，建议使用文本模式来指定编码类型。</p><h2 id="5eee" class="lc je hi bd jf ld le lf jj lg lh li jn iq lj lk jr iu ll lm jv iy ln lo jz lp bi translated">关闭文件</h2><p id="0a6f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">关闭文件主要是通过使用 close()方法来完成的。python 有一个垃圾收集器来清理被引用的对象，但是我们不能依赖它来关闭文件。</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="0763" class="lc je hi lu b fi ly lz l ma mb">f=open('file_name.txt')</span><span id="207a" class="lc je hi lu b fi mc lz l ma mb">f.close()</span></pre><p id="3e8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是上面提到的方法并不那么安全，我们不能依赖它。假设考虑一种情况，如果在对文件执行某些操作时出现异常，那么代码在没有关闭文件的情况下存在。所以在这种情况下，我们应该使用 Try…Finally 块。在 python 中，当写入数据时，它首先进入 RAM，然后存储到硬盘，如果我们不关闭文件，数据将粘在 RAM 上，这是易失性的。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es md"><img src="../Images/6246ea1898a17a07f4efc1d0af0a99e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*or4MR6-JfOdH_K5xP6y4FA.png"/></div></div></figure><p id="ac47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还有另一种方法，使用 with 语句。它确保当 with 内部的块退出时文件关闭，我们不需要显式调用 close()方法，它将在内部完成。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mi"><img src="../Images/96570605087bb5ab2a443b4ca95ad061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*quUoqlJ2r39NOMUgW2Xanw.png"/></div></div></figure><h2 id="8c35" class="lc je hi bd jf ld le lf jj lg lh li jn iq lj lk jr iu ll lm jv iy ln lo jz lp bi translated">写入文件</h2><p id="2501" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们可以通过在“w”、“a”或“x”模式下打开文件来写入文件。如果我们以“w”模式打开它，它会覆盖文件，如果它不存在的话，所有以前的数据都会被删除，所以我们在以“w”模式打开文件时必须更加小心。使用 write()方法写入字符串或字节序列。write()返回写入文件的字符数。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mj"><img src="../Images/dde1fd51086d1d4cdc6ab73a03cd3af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28BDSoLEKirKi8G9tHyEEw.png"/></div></div></figure><p id="e5a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面提到的代码将创建一个名为“new.txt”的新文件，如果它以前没有被创建。如果它已经存在，它将被覆盖。</p><p id="fa03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">从文件中读取</strong></p><p id="a5fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有多种方法可用于此目的。我们可以使用 read(size)方法来读取数据的大小。如果没有指定大小，那么它将返回到文件的末尾。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mk"><img src="../Images/2e85c1b0ab740b822c436d9081618886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gWqqkvEQ2MheR0cjgBFKXA.png"/></div></div></figure><p id="1f6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以从 read()方法中读取文件中的字符。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es ml"><img src="../Images/29ea65feb283f310d74d5f9c0df28d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJ-l9SmrzfhlKiWgywIP8Q.png"/></div></div></figure><p id="f2ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们现在再次使用 read()方法，那么它将从光标的当前位置开始读取。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mm"><img src="../Images/666e79aa3c4141ed42a5284ea30f563e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLcOEeOenota1vgmKDmefA.png"/></div></div></figure><p id="d6f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以使用 seek()更改当前光标位置。</p><p id="f3ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">tell()方法用于知道光标的当前位置。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mn"><img src="../Images/53b7820a2470250b40a2c027f52db960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*34i1eKw3D3ewDr2NeFhMyQ.png"/></div></div></figure><p id="03a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以使用 for 循环逐行读取文件。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mo"><img src="../Images/5c0ba41d8e78788f9cb729756923af0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWfRVbgT8NEvxnnN1UgyPQ.png"/></div></div></figure><p id="6fdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以使用 readline()方法来读取文件的单个行。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mn"><img src="../Images/e63b17618d6ebc2d37cc52cb7e3dcc99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MF2esHvFKkCLBY--R5Y-jA.png"/></div></div></figure><p id="6d03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们现在再次使用 readline()，那么它将从当前光标位置开始读取，当到达文件末尾时，所有这些读取方法都返回空值。</p><h2 id="e1a4" class="lc je hi bd jf ld le lf jj lg lh li jn iq lj lk jr iu ll lm jv iy ln lo jz lp bi translated">在 Python 中重命名和删除文件</h2><p id="866c" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在 python 中进行重命名和删除时，我们需要首先在 python 脚本中导入操作系统模块，然后我们将使用 rename()方法。</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="e334" class="lc je hi lu b fi ly lz l ma mb">f=open('new.txt','w')<br/>f.write("hello everyone \n")<br/>f.write("enjoy the evening!! \n")<br/>f.close()</span><span id="3a13" class="lc je hi lu b fi mc lz l ma mb">f=open('new.txt','r')<br/>f.read()<br/>f.close()</span><span id="f382" class="lc je hi lu b fi mc lz l ma mb">import os<br/>os.rename("new.txt","sample.txt")<br/>f=open('sample.txt','r')<br/>f.readline()</span><span id="55ef" class="lc je hi lu b fi mc lz l ma mb">out[]: 'hello everyone \n'</span></pre><p id="9cbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用 os.remove()方法删除文件。</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="243b" class="lc je hi lu b fi ly lz l ma mb">f.close()<br/>os.remove("sample.txt")<br/>f=open("sample.txt",'r')<br/>f.readline()</span></pre><p id="73fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="e97d" class="lc je hi lu b fi ly lz l ma mb"><strong class="lu hj">FileNotFoundError</strong>: [Errno 2] No such file or <strong class="lu hj">directory</strong>: 'sample.txt'</span></pre><h1 id="aac6" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">Python 目录和文件管理</h1><p id="52b6" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">当我们必须处理大量文件时，我们可以将代码放在不同的目录中，使事情更容易管理。目录和文件夹是文件和子目录的集合。python 有操作系统模块，它为我们提供了许多使用目录的有用方法。</p><h2 id="f103" class="lc je hi bd jf ld le lf jj lg lh li jn iq lj lk jr iu ll lm jv iy ln lo jz lp bi translated">获取当前目录</h2><p id="11b1" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们可以使用 getcwd()方法获取当前目录，它以字符串的形式返回当前工作目录。</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="8fec" class="lc je hi lu b fi ly lz l ma mb"><strong class="lu hj">os</strong>.getcwd()</span><span id="5067" class="lc je hi lu b fi mc lz l ma mb"><strong class="lu hj">out</strong>[]: '<strong class="lu hj">C</strong>:\\<strong class="lu hj">Users</strong>\\<strong class="lu hj">DELL</strong> <strong class="lu hj">PC</strong>'</span></pre><h2 id="1cfa" class="lc je hi bd jf ld le lf jj lg lh li jn iq lj lk jr iu ll lm jv iy ln lo jz lp bi translated">更改目录</h2><p id="b11b" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们可以使用 chdir()方法改变当前的工作目录。新路径必须作为字符串提供给此方法。我们可以使用正斜杠或反斜杠来分隔路径元素。</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="4376" class="lc je hi lu b fi ly lz l ma mb"><strong class="lu hj">os</strong>.chdir("/Users/DELL PC/desktop")</span><span id="2b97" class="lc je hi lu b fi mc lz l ma mb"><strong class="lu hj">os</strong>.getcwd()</span></pre><p id="62ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用 listdir()方法列出目录。</p><h2 id="7bb6" class="lc je hi bd jf ld le lf jj lg lh li jn iq lj lk jr iu ll lm jv iy ln lo jz lp bi translated">创建新目录</h2><p id="5618" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">该方法接受新目录的路径，如果没有指定完整路径，则在当前工作目录中创建新目录。我们使用 os.mkdir()方法。我们也可以使用 rmdir()方法删除目录，但它只删除空目录。为了删除非空目录，我们可以在 shutil 模块中使用 rmtree()方法。</p><pre class="kh ki kj kk fd lt lu lv lw aw lx bi"><span id="f3b1" class="lc je hi lu b fi ly lz l ma mb"><strong class="lu hj">os</strong>.mkdir("hey")<br/><strong class="lu hj">os</strong>.rmdir("hey")</span><span id="fb58" class="lc je hi lu b fi mc lz l ma mb">import shutil<br/>os.mkdir('simple')<br/>os.chdir('./simple')<br/>f=open('testfile.txt','w')<br/>f.write("hello world")<br/>os.chdir('../')</span><span id="ad12" class="lc je hi lu b fi mc lz l ma mb">os.rmdir('simple')</span><span id="f25a" class="lc je hi lu b fi mc lz l ma mb">out[]: <strong class="lu hj">OSError</strong>: [WinError 145] The directory is <strong class="lu hj">not</strong> empty: 'simple'</span><span id="fdcd" class="lc je hi lu b fi mc lz l ma mb">f.close()<br/>shutil.rmtree('simple') #non empty directory removal<br/>os.getcwd()</span><span id="1be9" class="lc je hi lu b fi mc lz l ma mb">out[]: 'C:\\Users\\DELL PC'</span></pre><p id="d1f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面提到的例子中，我们首先创建了一个名为 simple 的目录。然后，我们使用 os.chdir(')将它作为当前目录。/simple ')方法在这里单个句号表示它是当前目录，而在 6 行中双句号用于当前目录的父目录。如前所述，我们不能用 os.rmdir()删除非空目录，因为它会给出 OSError，所以在上面提到的代码中提到了如何使用 rmtree()删除非空目录。</p><p id="8724" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">****************************************************************</p><p id="51b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">玩得开心，不断学习，一直坚持编码。</p><p id="8f4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mp">感谢您阅读本文！！！！！</em></p></div></div>    
</body>
</html>