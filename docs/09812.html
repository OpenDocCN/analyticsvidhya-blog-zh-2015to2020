<html>
<head>
<title>Multivariate Time Series Restaurant Demand Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元时间序列餐饮需求预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multivariate-time-series-restaurant-demand-forecasting-1f1633875bc7?source=collection_archive---------10-----------------------#2020-09-21">https://medium.com/analytics-vidhya/multivariate-time-series-restaurant-demand-forecasting-1f1633875bc7?source=collection_archive---------10-----------------------#2020-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4034104e43cb72a75190d1ad30da9d8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRG9fX295aXqslKF0nchMA.jpeg"/></div></div></figure><h2 id="5b3c" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">什么是需求预测</h2><p id="7e68" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi kj translated"><span class="l kk kl km bm kn ko kp kq kr di"> D </span> emand forecasting 是两个词的组合；第一个是需求，另一个是预测。需求是指产品或服务的外部要求。一般来说，预测意味着为未来发生的事件估计现在。它是一种估计未来对产品或服务的可能需求的技术。它是基于对该产品或服务在当前市场条件下的过去需求的分析。</p><h2 id="50ee" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">为什么需求预测很重要？</h2><p id="c316" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi kj translated"><span class="l kk kl km bm kn ko kp kq kr di"> T </span>需求预测对企业来说是一个必不可少的过程，原因有很多:</p><p id="a00d" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">需求预测有助于业务规划、预算和目标设定。一旦你对未来的销售有了很好的了解，你就可以开始制定一个明智的采购策略，以确保你的供应与客户需求相匹配。</p><p id="3364" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">它允许企业更有效地优化库存，提高库存周转率，并降低持有成本。</p><p id="8937" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">它提供了对未来现金流的洞察，这意味着企业可以更准确地预算支付供应商和其他运营成本，并投资于公司的发展。</p><p id="ee02" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">预测需求意味着知道何时增加员工和其他资源，以保持运营在高峰期平稳运行。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="2f26" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi kj translated"><span class="l kk kl km bm kn ko kp kq kr di"> T </span>这篇文章的目的是做一个数据准备和实施多变量时间序列预测技术的演练。该实现显示了预测多元需求几种方式。</p><p id="253c" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">所以让我们开始吧。</p><h2 id="c3be" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">业务问题和限制-</h2><p id="431d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">我们的数据集是周二和周三午餐和晚餐时间的餐馆销售额。</p><p id="c146" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">在这个数据集中，很少有像 Uber Eats 这样的“外卖”订单。</p><p id="53d8" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">典型的午餐时间是上午 11:30-下午 2:00，晚餐时间是下午 6:30-10:00。</p><p id="6e4d" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">数据集只是周二和周三的。我们需要扩展和随机化 min 的数据。6 个月(2019 年 1 月至 2019 年 6 月)中的每一天。</p><p id="f610" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">一家典型的餐馆在周三、周末晚餐、随后的周末午餐有较高的覆盖率(顾客数量)，然后在周一至周五午餐有相对较低的覆盖率。</p><p id="fd85" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">数据扩展/随机化应遵循上述客户数量模式。</p><h2 id="79fa" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">我们的高尔夫-</h2><p id="d77d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">预测<strong class="jq hj">午餐</strong>和<strong class="jq hj">晚餐的顶部“菜单项”和“项目数量”。</strong> <br/>这些预测需要针对未来日期(周一至周日，7 月 1 日至 7 月 7 日)</p><h2 id="8093" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">实施-</h2><p id="b052" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">导入必要的库，如用于数据操作的 pandas、用于执行数学函数的 NumPy 以及 matplotlib、seaborn 是数据可视化库。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="9fd3" class="iq ir hi lj b fi ln lo l lp lq">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>pd.set_option(‘display.max_row’,None)<br/>sns.set_style(‘darkgrid’)</span></pre><p id="d168" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">在熊猫的帮助下加载数据</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="bf59" class="iq ir hi lj b fi ln lo l lp lq">df = pd.read_excel('R. Data.xlsx')<br/>df.head()</span></pre><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/c83ea47dc733339cd19b80ec58c67930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BmNC1JmDDnaIQkbTehAL3A.jpeg"/></div></div></figure><h1 id="daf9" class="ls ir hi bd is lt lu lv iw lw lx ly ja lz ma mb je mc md me ji mf mg mh jm mi bi translated">1.数据准备和预处理。</h1><p id="6791" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">如下所示，在删除不必要的列并输入数据集的空值后，我们就可以按照上面提供的模式准备数据了。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/c36a5154b926280575d854cbd98840c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vz76rmvZfEWJvCFL-QtbSg.jpeg"/></div></div></figure><p id="ee55" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">在我们的数据集中，周三是周末，这是唯一可用的周末数据，所以我们使用它作为进一步的数据准备。</p><p id="c225" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">现在我们将数据分为两组。第一个是工作日，另一个是周末。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="44dd" class="iq ir hi lj b fi ln lo l lp lq">weekday = df[df['Day Type']=='Weekday']<br/>weekend = df[df['Day Type']=='Weekend']</span></pre><p id="4829" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">根据我们所拥有的限制和信息，我们正在为一周中的每一天创建数据。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="3230" class="iq ir hi lj b fi ln lo l lp lq"># Monday - WeekDay<br/>monday = weekday.copy()<br/>monday['Day'] = weekday['Day'].str.replace('Tuesday','Monday')</span><span id="d54a" class="iq ir hi lj b fi mk lo l lp lq"># Tuseday - WeekDay<br/>tuesday = weekday.copy()</span><span id="7583" class="iq ir hi lj b fi mk lo l lp lq"># Wednesday - WeekEnd<br/>wednesday = weekend.copy()</span><span id="e112" class="iq ir hi lj b fi mk lo l lp lq"># Thusday - WeekDay<br/>thursday = weekday.copy()                                         <br/>thursday['Day'] = thursday['Day'].str.replace('Tuesday','Thursday')</span><span id="f25c" class="iq ir hi lj b fi mk lo l lp lq"># Friday - WeekDay<br/>friday = weekday.copy()                                          <br/>friday['Day'] = friday['Day'].str.replace('Tuesday','Friday')</span><span id="e513" class="iq ir hi lj b fi mk lo l lp lq"># Saturday - WeekEnd<br/>saturday = weekend.copy()                                        <br/>saturday['Day'] = saturday['Day'].str.replace('Wednesday','Saturday')</span><span id="b4b9" class="iq ir hi lj b fi mk lo l lp lq"># Sunday - WeekEnd<br/>sunday = weekend.copy()                                          <br/>sunday['Day'] = sunday['Day'].str.replace('Wednesday','Sunday')</span><span id="3a4c" class="iq ir hi lj b fi mk lo l lp lq"># Combining data of days to create one-week data.<br/>week = []<br/>week = pd.concat([tuesday,wednesday,thursday,friday,saturday,sunday,<br/>monday,],axis = 0)</span></pre><p id="07c8" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">现在创建了一周的数据后，我们必须以相同的模式将其扩展 6 个月。所以我们正在为它编写一个函数。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="ef2e" class="iq ir hi lj b fi ln lo l lp lq">months = week.copy()<br/>x = 0<br/>while x &lt; 25:<br/>    months = pd.concat([months,week],axis = 0)<br/>    x = x+1<br/>months.reset_index(drop=True, inplace=True)</span></pre><p id="0d6d" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">这是数据准备的最后阶段。这里，我们为各个数据创建了一个新的日期列，并做了一些预处理以获得合适的数据集。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="85f7" class="iq ir hi lj b fi ln lo l lp lq"># Creating Dates asper range given.<br/>o = pd.date_range(start='1/1/2019', periods=(len(months)/100), freq='D')<br/>date = []<br/>for i in o:<br/>    for j in range(100):<br/>        date.append(i)<br/>date = pd.DataFrame(date,columns = ['Date'])</span><span id="1dad" class="iq ir hi lj b fi mk lo l lp lq"># Concating Dates with our dataset.<br/>final = pd.concat([date,months],axis = 1)</span><span id="a126" class="iq ir hi lj b fi mk lo l lp lq"># Changing Columns Positions for better understanding.<br/>final = final[['Date', 'Shift', 'Day Type', 'Day', 'PartySize', 'MenuCateogry','MenuItem', 'ItemPrice', 'ItemQty']]<br/>final = final.iloc[:18100,:]</span></pre><p id="a760" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">我们得到六个月的最终数据集，它有 18100 行和 9 列。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/8fe6ec6c41339f374343b89a8eedd5f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ip76fMUpC0wDrq6TrRn48g.jpeg"/></div></div></figure><p id="15ad" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">这里我们的数据准备终于完成了。我们维护所有模式，并考虑其他约束来匹配真实世界的数据。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="f6c5" class="ls ir hi bd is lt mm lv iw lw mn ly ja lz mo mb je mc mp me ji mf mq mh jm mi bi translated">2.形象化</h1><p id="eaf1" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">现在，我们正在对数据进行一些探索性的数据分析，以确定菜单上的顶级项目。</p><p id="a7c9" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated"><strong class="jq hj"> 1。词云</strong></p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="f93f" class="iq ir hi lj b fi ln lo l lp lq">from wordcloud import WordCloud<br/>wordcloud_sp = WordCloud(width=5000,height=2000).generate(speaker_rev_string1)<br/>plt.axis("off")<br/>plt.tight_layout(pad=0)<br/>plt.imshow(wordcloud_sp)</span></pre><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/c297f15a3e593131ce09fe116297d71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dPbsiQvfl2p6v1-JWmQh1g.png"/></div></div></figure><p id="db45" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated"><strong class="jq hj"> 2。柱状图</strong></p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="30b1" class="iq ir hi lj b fi ln lo l lp lq">p = pd.DataFrame(product_1.groupby(['MenuItem']).sum())<br/>p = p.reset_index()<br/>p.sort_values(by=['ItemQty'], inplace=True,ascending=False)<br/>plt.figure(figsize=(20,8))<br/>chart = sns.barplot(x="MenuItem", y="ItemQty", data=p)<br/>plt.xticks(rotation=90)</span></pre><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/0640334d4fbeb43dc9b9685ed3b47d52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4dboyteRRcfWOpoTNtbiAQ.png"/></div></div></figure><h1 id="9ec0" class="ls ir hi bd is lt lu lv iw lw lx ly ja lz ma mb je mc md me ji mf mg mh jm mi bi translated">3.模型结构</h1><p id="35bb" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">为了建立一个模型，首先，我们修改了表的一些排列，以便于多变量预测。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="83f5" class="iq ir hi lj b fi ln lo l lp lq">df = final[['Date','Shift','MenuItem','ItemQty']]<br/>new = df.loc[df.index.repeat(df.ItemQty)]<br/>new = new[['Date','Shift','MenuItem']]<br/>table = pd.DataFrame(pd.crosstab(new.Date,[new.Shift,new.MenuItem]))<br/>table.columns = table.columns.map('{0[1]}-{0[0]}'.format)</span></pre><p id="0c0f" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">我们为多元预测模型训练得到的数据集是</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/41204e2869805af98ba84cdd1cc3f804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjlrRODaIVXGsZo7sthqvw.jpeg"/></div></div></figure><p id="fd9c" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">上述数据的外观行为</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/0c933e0e54e0c72fa81ea226a33ea555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*66J-0cyzmpkaOQge7QPQVA.png"/></div></div></figure><p id="5f4d" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">将数据拆分成训练和测试<br/>对于时间序列模型，我们不能随机拆分我们的数据。我们应该在突破时遵循数据的季节性模式。所以我们分如下。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="91d0" class="iq ir hi lj b fi ln lo l lp lq">Train = table[:int(0.85*(len(table)))]<br/>Test = table[int(0.85*(len(table))):]</span></pre><p id="f479" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">对于这些数据，我们使用数据驱动的时间序列模型，如平滑技术。</p><p id="4a7a" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">导入建模所需的库</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="06d0" class="iq ir hi lj b fi ln lo l lp lq">from statsmodels.tsa.holtwinters import SimpleExpSmoothing <br/>from statsmodels.tsa.holtwinters import Holt <br/>from statsmodels.tsa.holtwinters import ExponentialSmoothing</span></pre><p id="b374" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">现在，我们正在为菜单的每个项目构建不同的模型，并制作相应 RMSE 的数据框，以检测哪个模型是最好的。</p><p id="d1fb" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated"><strong class="jq hj">第一个模型:- </strong>冬季指数平滑加性季节性和加性趋势模型</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="65f3" class="iq ir hi lj b fi ln lo l lp lq">p = []<br/>for i in table.columns:<br/> hwe_model_add_add = ExponentialSmoothing(Train[i],seasonal=”add”,trend=”add”,seasonal_periods=7).fit()<br/> pred_hwe_add_add = hwe_model_add_add.predict(start = Test.index[0],end = Test.index[-1])<br/> rmse_hwe_add_add = np.sqrt(np.mean((Test[i]-pred_hwe_add_add)**2))<br/> p.append(round(rmse_hwe_add_add,3))<br/>p = pd.DataFrame(p, columns = [‘Winter_Exponential_Smoothing_RMSE’])</span></pre><p id="7c0d" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated"><strong class="jq hj">第二个模型:- </strong>霍尔特方法模型</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="4c9d" class="iq ir hi lj b fi ln lo l lp lq">for j in table.columns:<br/>    hw_model = Holt(Train[j]).fit()<br/>    pred_hw = hw_model.predict(start = Test.index[0],end = Test.index[-1])<br/>    rmse_hw = np.sqrt(np.mean((Test[j]-pred_hw)**2))<br/>    q.append(round(rmse_hw,3)) <br/>p['Holt method Model_RMSE']= pd.DataFrame(q, columns = ['Holt method Model_RMSE'])</span></pre><p id="e30b" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated"><strong class="jq hj">第三种模式:- </strong>简单指数模式</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="6b58" class="iq ir hi lj b fi ln lo l lp lq">r = []<br/>for o in table.columns:<br/>    ses_model = SimpleExpSmoothing(Train[o]).fit()<br/>    pred_ses = ses_model.predict(start = Test.index[0],end = Test.index[-1])<br/>    rmse_ses = np.sqrt(np.mean((Test[o]-pred_ses)**2))<br/>    r.append(round(rmse_ses,3)) <br/>p['Simple Exponential Mode_RMSE']= pd.DataFrame(r, columns = ['Simple Exponential Mode_RMSE'])</span></pre><p id="69f4" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">每个项目的每个模型的 RMSE 数据框架。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/0212e4f440b3d196e2f1206dc618a4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68TioZRmfPV9AxBP98JVtQ.jpeg"/></div></figure><p id="55ed" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">RMSE 模型的总和。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/fbcf0dcc732b83eccafcc0ca8bc5862e.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*WnoatUGIUGDSFoYtT4E8IA.jpeg"/></div></figure><p id="9204" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">从上面我们可以看到，季节性为 7 的温特斯指数平滑法显示出比其他方法更小的 RMSE 值，所以我们选择它作为我们预测的最终模型。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="4a09" class="ls ir hi bd is lt mm lv iw lw mn ly ja lz mo mb je mc mp me ji mf mq mh jm mi bi translated">4.建筑功能</h1><p id="9753" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">我们正在构建两个不同的函数，第一个是预测菜单中所有项目的需求，第二个是预测菜单中前 N 个项目的需求。</p><p id="4051" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated"><strong class="jq hj">第一功能:- </strong>预测所有项目的需求，并规范午餐和晚餐格式中的数据框架安排。</p><p id="c0a5" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">输入参数。- <br/> <strong class="jq hj"> <em class="mx">表</em> </strong> <em class="mx"> </em> —修改后的历史数据框。<br/><strong class="jq hj"><em class="mx">start _ date</em></strong>—我们要预测的周期的第一天。<br/><strong class="jq hj"><em class="mx">end _ date</em></strong>—我们要预测的期间的最后日期。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="6f20" class="iq ir hi lj b fi ln lo l lp lq">def Daily_menu_forcasting(table,start_date,end_date):<br/>    da = pd.date_range(start = start_date, end = end_date , freq='D')<br/>    for_pred = pd.DataFrame(da,columns = ['Date'] )<br/>    for_pred = for_pred.set_index('Date')<br/>    for i in table.columns:<br/>        hwe_model_add_add = ExponentialSmoothing(table[i],seasonal="add",trend="add",seasonal_periods=7).fit()<br/>        pred_hwe_add_add = hwe_model_add_add.predict(start = for_pred.index[0],end = for_pred.index[-1])<br/>        for_pred[i]=((round(pred_hwe_add_add)).astype(int))<br/>    final_pred =  for_pred<br/>    p = pd.DataFrame(final_pred.stack())<br/>    p = p.reset_index()<br/>    p[['MenuItem','Shift']] = p.level_1.str.split("-",expand=True,)<br/>    p = p.rename(columns={0: "ItemQty"})<br/>    p = p[['Date','Shift','MenuItem',"ItemQty"]]<br/>    p = p[p['ItemQty'] != 0]<br/>    # Makind Dataframe with dinner and lunch columns<br/>    new = p.loc[p.index.repeat(p.ItemQty)]<br/>    f = pd.DataFrame(pd.crosstab([new.Date,new.MenuItem],[new.Shift]))<br/>    f = f.reset_index()</span><span id="f115" class="iq ir hi lj b fi mk lo l lp lq"># Shorting Data Frame on the basis top item<br/>    f['Total orders of Day'] = f.Dinner + f.Lunch<br/>    f = f.sort_values(['Date', 'Total orders of Day'], ascending=[True, False]).reset_index(drop= True)<br/>    f<br/>    Daily_req_FiNal_Ans = f.copy()<br/>    return Daily_req_FiNal_Ans</span></pre><p id="214c" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated"><strong class="jq hj">第二个功能:- </strong>预测前 N 个项目的需求，并标准化午餐和晚餐格式中数据帧的排列。</p><p id="53f7" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">输入参数— <br/> <strong class="jq hj"> <em class="mx">表</em> </strong> —修改后的历史数据画面。<br/><strong class="jq hj"><em class="mx">start _ date</em></strong>—我们要预测的周期的第一天。<br/><strong class="jq hj"><em class="mx">end _ date</em></strong>—我们要预测的期间的最后日期。<br/> <strong class="jq hj"> <em class="mx"> N </em> </strong> —我们想要的前几项的个数。(默认 n=5)</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="bb68" class="iq ir hi lj b fi ln lo l lp lq">def Daily_top_menu_forcasting(table,start_date,end_date,N):<br/>    da = pd.date_range(start = start_date, end = end_date , freq='D')<br/>    for_pred = pd.DataFrame(da,columns = ['Date'] )<br/>    for_pred = for_pred.set_index('Date')<br/>    for i in table.columns:<br/>        hwe_model_add_add = ExponentialSmoothing(table[i],seasonal="add",trend="add",seasonal_periods=7).fit()<br/>        pred_hwe_add_add = hwe_model_add_add.predict(start = for_pred.index[0],end = for_pred.index[-1])<br/>        for_pred[i]=((round(pred_hwe_add_add)).astype(int))<br/>    final_pred =  for_pred<br/>    p = pd.DataFrame(final_pred.stack())<br/>    p = p.reset_index()<br/>    p[['MenuItem','Shift']] = p.level_1.str.split("-",expand=True,)<br/>    p = p.rename(columns={0: "ItemQty"})<br/>    p = p[['Date','Shift','MenuItem',"ItemQty"]]<br/>    p = p[p['ItemQty'] != 0]<br/>    # Makind Dataframe with dinner and lunch columns<br/>    new = p.loc[p.index.repeat(p.ItemQty)]<br/>    f = pd.DataFrame(pd.crosstab([new.Date,new.MenuItem],[new.Shift]))<br/>    f = f.reset_index()</span><span id="b4c8" class="iq ir hi lj b fi mk lo l lp lq"># Shorting Data Frame on the basis top item<br/>    f['Total orders of Day'] = f.Dinner + f.Lunch<br/>    f = f.sort_values(['Date', 'Total orders of Day'], ascending=[True, False]).reset_index(drop= True)<br/>    f<br/>    # Finding Topr product for days.<br/>    name =((f['Date'].astype(str)).unique()).tolist()<br/>    t = pd.DataFrame(columns = f.columns)<br/>    for i in name:<br/>        v = pd.DataFrame((f[f['Date']==i]).head(N))<br/>        t = pd.concat([t,v],axis = 0)<br/>    Daily_top_FiNal_Ans = t.reset_index(drop = True)<br/>    return(Daily_top_FiNal_Ans)</span></pre><p id="d1fd" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">现在，对未来日期(周一至周日，7 月 1 日至 7 月 7 日)菜单上项目的最终需求预测是。</p><p id="2ed3" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">对于所有项目。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="4b79" class="iq ir hi lj b fi ln lo l lp lq">all_menu = Daily_menu_forcasting(table,'7/1/2019','7/7/2019')<br/>all_menu.head(10)</span></pre><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es my"><img src="../Images/b06ed74cf4fc22da91c7af1313d0c122.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*hge6b7nEq_vSZ-rv4hW0yg.jpeg"/></div></figure><p id="d588" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">对于前 N 项。</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="c95d" class="iq ir hi lj b fi ln lo l lp lq"># Here N = 8<br/>top_8_menu = Daily_top_menu_forcasting(table,'7/1/2019','7/7/2019'<br/>,8)<br/>top_8_menu.head(10)</span></pre><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/871d9ba8810de4b9227be49dac115f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*jEP7Xv9jJ_MwJ05lvyjTtQ.jpeg"/></div></figure></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="2866" class="ls ir hi bd is lt mm lv iw lw mn ly ja lz mo mb je mc mp me ji mf mq mh jm mi bi translated">结论-</h1><p id="e96f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi kj translated"><span class="l kk kl km bm kn ko kp kq kr di">我们</span>成功预测了给定时间段内午餐和晚餐菜单上餐厅食品的需求，并确定了菜单上的热门项目。本文展示了实现需求预测的多种方法之一。在我看来，这是处理多元预测业务问题的最佳方式之一。</p><p id="614e" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">完整的代码，请访问我的 Kaggle 页面，如果你觉得有帮助，请投赞成票。-<a class="ae na" href="https://www.kaggle.com/nilaydesmukh/restaurant-demand-forecasting" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com 餐厅-需求-预测</a></p><p id="0311" class="pw-post-body-paragraph jo jp hi jq b jr ks jt ju jv kt jx jy jb ku ka kb jf kv kd ke jj kw kg kh ki hb bi translated">我的 Linkedin—<a class="ae na" href="https://www.linkedin.com/in/nilaydeshmukh/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/nilaydeshmukh</a></p></div></div>    
</body>
</html>