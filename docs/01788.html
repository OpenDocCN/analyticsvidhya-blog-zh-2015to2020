<html>
<head>
<title>An Insight Into The Has-Many Through Concept In Ruby.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入了解Ruby中的Has-Many Through概念。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/an-insight-into-the-has-many-through-concept-in-ruby-49565cc8f984?source=collection_archive---------15-----------------------#2019-11-13">https://medium.com/analytics-vidhya/an-insight-into-the-has-many-through-concept-in-ruby-49565cc8f984?source=collection_archive---------15-----------------------#2019-11-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="5954" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你是编程新手，并且已经开始学习Ruby语言，你可能会觉得自己是世界上最好的程序员。Ruby中使用的语法读起来和写起来就像英语一样不可思议，以至于学习它会很有趣(不是说学习<em class="jk">不有趣)。以这行代码为例:</em></p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="da16" class="ju jv hi jq b fi jw jx l jy jz">name = “Theodore”</span></pre><p id="613f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您已经声明了一个变量“name ”,并将其设置为等于“Theodore”的值。够简单了吧？没有额外的语法，没有隐藏的技巧(直到你学习了变量作用域，我们今天不会深入学习)——只是给一个变量赋了一个值，这个值可以在程序的后面被调用。如此危险地容易理解，以至于你可能会放松警惕。</p><p id="1365" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们更进一步。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="a276" class="ju jv hi jq b fi jw jx l jy jz">class MyClass<br/>   def initialize(name, gender)<br/>      @name = name<br/>      @gender = gender<br/>   end<br/>end</span></pre><p id="9afa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，如果您以前从未遇到过这种类型的代码，您可能不太理解上面的代码，但是相信我，理解它需要熟悉—语法非常简单明了。然而，如果您以前遇到过这种类型的代码，您肯定会知道这里发生了什么。我正在创建一个名为“MyClass”的类，它在实例化时接受两个参数“name”和“gender”。不过，很简单。我想说的是:当编程时，学习语法总是容易的部分，解决问题是程序员的关键。</p><p id="2a6b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在现实生活中，没有一个应用程序会脱离单个类(或对象)运行。对象通常会与其他对象相关联。显示对象之间这种关系的(许多)方法之一是<em class="jk"> has-many到</em>概念。</p><p id="3631" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">假设我们有三种模式:<em class="jk">俱乐部</em>，<em class="jk">国家</em>，<em class="jk">玩家</em>。在足球界，一个俱乐部有很多球员，一个国家也有很多球员。一名球员<em class="jk">属于</em>一个俱乐部，而<em class="jk">属于</em>一个国家。那么，我们如何在代码中展示这一点呢？让我们首先创建我们的模型。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="fd4c" class="ju jv hi jq b fi jw jx l jy jz">class Club<br/>   attr_accessor :name<br/>   def initialize(name)<br/>     @name = name<br/>   end<br/>end</span><span id="1092" class="ju jv hi jq b fi ka jx l jy jz">class Country<br/>   attr_accessor :name<br/>   def initialize(name)<br/>     @name = name<br/>   end<br/>end</span><span id="26af" class="ju jv hi jq b fi ka jx l jy jz">class Player<br/>   attr_accessor :name<br/>   def initialize(name)<br/>     @name = name<br/>   end<br/>end</span></pre><p id="b8fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">太好了。为了简单起见，每个类只通过它们的名字<em class="jk">初始化。记得我们的关系吗？<em class="jk">国家</em>和<em class="jk">俱乐部</em>职业都有-很多<em class="jk">玩家</em>实例。因此，那些类应该存储一个<em class="jk">播放器</em>实例的数组，对吗？</em></p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="7ee8" class="ju jv hi jq b fi jw jx l jy jz">class Club<br/>   attr_accessor :name, :players<br/>   def initialize(name)<br/>     @name = name <br/>     @players = []<br/>   end<br/>end</span><span id="6a77" class="ju jv hi jq b fi ka jx l jy jz">class Country<br/>   attr_accessor :name, :players<br/>   def initialize(name)<br/>     @name = name<br/>     @players = []<br/>   end<br/>end</span></pre><p id="31f1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们已经在<em class="jk"> Country </em>和<em class="jk"> Club </em>类中设置了一个实例变量"<em class="jk"> players </em>"等于一个空数组。关于我们的玩家类，我们注意到了什么？是<strong class="io hj">把</strong>所有的类连接在一起的模型。没有<em class="jk">玩家</em>模式，就没有<em class="jk">国家</em>和<em class="jk">俱乐部</em>的联系。这就是<em class="jk">有-多通过</em>的概念……俱乐部和国家<em class="jk">有-多</em>玩家<em class="jk">到</em>玩家。让我们修改我们的玩家表以在代码中反映这一点:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="5dbb" class="ju jv hi jq b fi jw jx l jy jz">class Player<br/>   attr_accessor :name, :club, :country<br/>   def initialize(name, club, country)<br/>     @name = name<br/>     @club = club<br/>     @country = country<br/>     club.players &lt;&lt; self    #<em class="jk"> self refers to an instance of Player</em><br/>     country.players &lt;&lt; self #<em class="jk"> its added to the empty @players array<br/>   </em>end <br/>end</span></pre><p id="2dbc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，如果我们创建一些测试数据，并在<a class="ae kb" href="https://repl.it/" rel="noopener ugc nofollow" target="_blank"> repl.it </a>中运行它，我们应该得到我们想要的结果，并在Ruby中有一个有效的<em class="jk"> has-many到</em>程序。</p><figure class="jl jm jn jo fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kc"><img src="../Images/9ed6c12ac5c1e4295c6ac23843cfaa05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vhgDjSpwT2YYmidmDYGYww.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated">创建我们的测试数据</figcaption></figure><p id="3130" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们期望什么</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="dabb" class="ju jv hi jq b fi jw jx l jy jz">messi.club</span></pre><p id="858e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">回来吗？让我们试一试。</p><figure class="jl jm jn jo fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es ko"><img src="../Images/dd38433c47588311d8f094191df1f86a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inw95_kKALMR-eIcmMoQXw.png"/></div></div></figure><p id="3a0c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">看起来很乱，但是很管用。它返回了整个对象。然而，我们想要一个更精确的答案，所以让我们稍微修改一下代码。我们只想要梅西效力的俱乐部<em class="jk">的<strong class="io hj">名字</strong>:</em></p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="c248" class="ju jv hi jq b fi jw jx l jy jz">messi.club.name</span></pre><p id="2868" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将返回:</p><figure class="jl jm jn jo fd kd er es paragraph-image"><div class="er es kp"><img src="../Images/7066f48bfeda885f21153a3e07907980.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*_m8eJY9Jtjq1yn885WZmiA.png"/></div></figure><p id="efd0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">太棒了。</p><p id="2a78" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果我们想多走一步呢？如果我们想知道某个俱乐部的球员所代表的所有国家的名字，会怎么样呢？因此，在我们的例子中，如果我们希望所有的国家都在我们的“巴塞罗那”俱乐部中得到代表。让我们为巴塞罗那增加一名球员:</p><figure class="jl jm jn jo fd kd er es paragraph-image"><div class="er es kq"><img src="../Images/b2627d8abd3b84d303a9ef93c6e7185b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*CcN0Jhw4-PcGgCYxEnjdUw.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">为“巴塞罗那”增加了另一名球员</figcaption></figure><p id="5432" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们想要《巴塞罗那》中玩家代表的所有国名。那么我们期望我们的返回值是多少呢？我们使用哪种方法来实现这一点？</p><figure class="jl jm jn jo fd kd er es paragraph-image"><div class="er es kr"><img src="../Images/dd67cd70bc449aff1c07c7be8ee3e4b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*kBQaWgvUcN7NU05G_7v61A.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">这行得通吗？</figcaption></figure><p id="8739" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们试着通过我们的@players数组在我们的<em class="jk"> barca </em>变量中映射<em class="jk">:</em></p><figure class="jl jm jn jo fd kd er es paragraph-image"><div class="er es ks"><img src="../Images/9dac356e7e25fd7f554a980b8a3029a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*LtcD57uIGRkqQMpR5ZWIvw.png"/></div></figure><p id="be86" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">嘣！我们通过@players数组进行映射，过滤出每个球员的国家名称。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="4378" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢阅读，希望你学到了新的东西。我出局了。</p></div></div>    
</body>
</html>