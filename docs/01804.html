<html>
<head>
<title>Towards Machine Learning in Pharo: Visualizing Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">走向Pharo中的机器学习:可视化线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/towards-machine-learning-in-pharo-visualizing-linear-regression-4b55aa335462?source=collection_archive---------15-----------------------#2019-11-14">https://medium.com/analytics-vidhya/towards-machine-learning-in-pharo-visualizing-linear-regression-4b55aa335462?source=collection_archive---------15-----------------------#2019-11-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="13a9" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一个小教程，将教你如何拟合波士顿住房数据的回归线，并用Roassal3可视化它</h2></div><p id="98dd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个关于如何使用来自<a class="ae jt" href="https://github.com/PolyMathOrg/PolyMath" rel="noopener ugc nofollow" target="_blank">学者</a>的线性回归模型估计<a class="ae jt" href="https://pharo.org/" rel="noopener ugc nofollow" target="_blank"> Pharo </a>房屋价格的小教程。然后，我们将使用<a class="ae jt" href="https://github.com/ObjectProfile/Roassal3" rel="noopener ugc nofollow" target="_blank"> Roassal3 </a>的新图表功能来可视化数据点和回归线。</p><p id="fbb7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这篇博文的主要目的是展示昨天推出的Roassal3的新图表功能。我们将构建的可视化并不十分漂亮，但它将让您体验到我们在不久的将来能够做的惊人的事情。</p><h1 id="01dc" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated">装置</h1><p id="34d9" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">Pharo是一种纯面向对象的编程语言<em class="kr">和一个强大的环境</em>，专注于简单性和即时反馈(想想IDE和OS合二为一)。如果你不熟悉Pharo，你可以按照<a class="ae jt" href="https://pharo.org/download" rel="noopener ugc nofollow" target="_blank">https://pharo.org/download</a>上的说明来安装。</p><p id="f702" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">安装并运行Pharo映像后，打开Playground (Ctrl+OW)并执行(选择它并按Ctrl+D)下面的Metacello脚本来安装<a class="ae jt" href="https://github.com/PharoAI/Datasets" rel="noopener ugc nofollow" target="_blank">数据集</a>库。该库将允许您下载不同的数据集(包括我们将在本教程中使用的波士顿住房数据集)并将它们作为<a class="ae jt" href="https://github.com/PolyMathOrg/DataFrame/" rel="noopener ugc nofollow" target="_blank"> DataFrame </a>对象加载到您的图像中:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="1d1e" class="lb jv hi kx b fi lc ld l le lf">Metacello new<br/>   baseline: 'Datasets';<br/>   repository: 'github://PharoAI/Datasets';<br/>   load.</span></pre><p id="c9f2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在运行这个脚本来安装<a class="ae jt" href="https://github.com/PolyMathOrg/PolyMath" rel="noopener ugc nofollow" target="_blank"> PolyMath </a>。这是一个Pharo的科学计算库，包含一个<code class="du lg lh li kx b">PMLinearRegression</code>类:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="5239" class="lb jv hi kx b fi lc ld l le lf">Metacello new<br/>   repository: 'github://PolyMathOrg/PolyMath:v1.0.1/src';<br/>   baseline: 'PolyMath';<br/>   load.</span></pre><p id="6e1f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，执行这个脚本来安装<a class="ae jt" href="https://github.com/ObjectProfile/Roassal3" rel="noopener ugc nofollow" target="_blank"> Roassal3 </a>。我将向您展示的功能是几个小时前添加的。在接下来的几天里，API很有可能会被修改，所以为了确保在你阅读这篇文章的时候一切正常，你必须在一个特定的提交上加载roassal 3<code class="du lg lh li kx b">b9fa9e1</code>:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="5101" class="lb jv hi kx b fi lc ld l le lf">Metacello new<br/>   baseline: 'Roassal3';<br/>   repository: 'github://ObjectProfile/Roassal3:b9fa9e1';<br/>   load.</span></pre><p id="84ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在这篇博文中展示的改动还没有集成到Roassal3的masters分支中，所以你必须单独加载它们。为此，打开Iceberg (Ctrl+OI)，点击Roassal3，找到<code class="du lg lh li kx b">Roassal3-Matplotlib</code>包并按下Load。</p><h1 id="78be" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated">正在加载波士顿住房数据集</h1><p id="e304" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">要加载波士顿住房数据集，只需运行</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="130c" class="lb jv hi kx b fi lc ld l le lf">boston := Datasets loadBoston.</span></pre><p id="42ba" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将为您提供一个包含14列的数据框架:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="bc6c" class="lb jv hi kx b fi lc ld l le lf">1. CRIM: per capita crime rate by town<br/>2. ZN: proportion of residential land zoned for lots over 25,000 sq.ft.<br/>3. INDUS: proportion of non-retail business acres per town<br/>4. CHAS: Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)<br/>5. NOX: nitric oxides concentration (parts per 10 million)<br/>6. RM: average number of rooms per dwelling<br/>7. AGE: proportion of owner-occupied units built prior to 1940<br/>8. DIS: weighted distances to five Boston employment centres<br/>9. RAD: index of accessibility to radial highways<br/>10. TAX: full-value property-tax rate per $10,000<br/>11. PTRATIO: pupil-teacher ratio by town<br/>12. B: 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town<br/>13. LSTAT: % lower status of the population<br/>14. MEDV: Median value of owner-occupied homes in $1000's"</span></pre><p id="c568" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用列<code class="du lg lh li kx b">RM</code>和<code class="du lg lh li kx b">MEDV</code>来研究平均房间数和房价之间的关系。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="3b05" class="lb jv hi kx b fi lc ld l le lf">rooms := boston column: 'RM'.<br/>price := boston column: 'MEDV'.</span></pre><h1 id="9cf2" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated">使用PolyMath对数据进行直线拟合</h1><p id="0e79" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">简单的一元线性回归背后的思想如下:</p><ol class=""><li id="fc9d" class="lj lk hi iz b ja jb jd je jg ll jk lm jo ln js lo lp lq lr bi translated">我们得到了一个积分集合<code class="du lg lh li kx b">(x, y)</code>——在我们的例子中，<code class="du lg lh li kx b">x</code>是房间数量，<code class="du lg lh li kx b">y</code>是价格——并且</li><li id="cfd6" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">我们需要找到两个值<code class="du lg lh li kx b">k</code>和<code class="du lg lh li kx b">b</code>，使得线<code class="du lg lh li kx b">y = kx + b</code>是所有给定点的最佳近似。这些值被称为<em class="kr">【斜率】</em>和<em class="kr">【截距】</em>。</li></ol><p id="f3db" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更具体地说，如果我们想使用斜率<code class="du lg lh li kx b">k</code>和截距<code class="du lg lh li kx b">b</code>来预测每<code class="du lg lh li kx b">xᵢ</code>(房间数量)的<code class="du lg lh li kx b">yᵢ</code>(价格)为</p><figure class="ks kt ku kv fd ly er es paragraph-image"><div class="er es lx"><img src="../Images/f6836e30034ee84077a63af0c9a30ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/1*xNsDTTSAtRT6D1gq8aQkfw.png"/></div></figure><p id="16f2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们需要选择<code class="du lg lh li kx b">k</code>和<code class="du lg lh li kx b">b</code>，使得实际<code class="du lg lh li kx b">yᵢ</code>和预测<code class="du lg lh li kx b">yᵢ´</code>的平方差之和最小；</p><figure class="ks kt ku kv fd ly er es paragraph-image"><div class="er es mb"><img src="../Images/493619b296fcfea303ed52c61a8e7a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*Zc-DHb4TGx4GQEUZ7mcWFA.png"/></div></figure><p id="d507" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我不会详细介绍这是如何实现的(但我鼓励你阅读计算线性回归的不同方法——这非常有趣)。我们可以使用PolyMath的<code class="du lg lh li kx b">PMLinearRegression</code>类找到给定点的斜率和截距。为此，我们只需向其添加点，并提取斜率和截距的值:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="00d7" class="lb jv hi kx b fi lc ld l le lf">regression := PMLinearRegression new.</span><span id="192a" class="lb jv hi kx b fi mc ld l le lf">1 to: rooms size do: [ :i |<br/>    point := (rooms at: i) @ (price at: i).<br/>    regression add: point ].</span><span id="cb35" class="lb jv hi kx b fi mc ld l le lf">k := regression slope.<br/>b := regression intercept.</span></pre><p id="c9c9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们可以根据房间数量来预测建筑物的价格:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="9c24" class="lb jv hi kx b fi lc ld l le lf">predictedPrices := k * rooms + b.</span></pre><p id="8a18" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些预测都在同一条线上，称为<em class="kr">“回归线”</em>。</p><h1 id="755b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke io kf ip kg ir kh is ki iu kj iv kk kl bi translated">用Roassal3绘制回归线</h1><p id="2302" class="pw-post-body-paragraph ix iy hi iz b ja km ij jc jd kn im jf jg ko ji jj jk kp jm jn jo kq jq jr js hb bi translated">最后，我们可以使用Roassal3可视化库构建一个图表，向我们显示我们所有的点和一条穿过它们的线。</p><p id="6955" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们首先创建一个空图表:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="a71f" class="lb jv hi kx b fi lc ld l le lf">chart := RSChart new.</span></pre><p id="a5c7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们创建一个散点图:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="402a" class="lb jv hi kx b fi lc ld l le lf">points := RSScatterPlot new<br/>   x: rooms<br/>   y: price.</span></pre><p id="4350" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还创造了一个系列:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="2bea" class="lb jv hi kx b fi lc ld l le lf">regressionLine := RSLinePlot new<br/>   x: rooms<br/>   y: predictedPrices.</span></pre><p id="59ce" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们将散点图和线条添加到图表中:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="39a6" class="lb jv hi kx b fi lc ld l le lf">chart<br/>   addPlot: points;<br/>   addPlot: regressionLine.</span></pre><p id="b1eb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们为图表的两个坐标轴指定了自定义标题和自定义标签:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="a9b9" class="lb jv hi kx b fi lc ld l le lf">chart<br/>   title: 'Boston Housing';<br/>   xlabel: 'Number of rooms';<br/>   ylabel: 'Price'.</span></pre><p id="096c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们可以通过选择单词<code class="du lg lh li kx b">chart</code>并检查它(Ctrl+I)或(Ctrl+G)来查看图表:</p><figure class="ks kt ku kv fd ly er es paragraph-image"><div class="er es md"><img src="../Images/4c75bc4de9f4a5a85cb083d1b214a0f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*JfA34tmDMJO4x2VZ86VuIg.png"/></div></figure></div></div>    
</body>
</html>