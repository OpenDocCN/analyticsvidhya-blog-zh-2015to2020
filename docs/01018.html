<html>
<head>
<title>Neural Networks for Tabular Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">表格数据的神经网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/neural-networks-for-tabular-data-touching-the-untouched-efd66c950463?source=collection_archive---------7-----------------------#2019-09-25">https://medium.com/analytics-vidhya/neural-networks-for-tabular-data-touching-the-untouched-efd66c950463?source=collection_archive---------7-----------------------#2019-09-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="8ad7" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><em class="ix">这是一篇关于神经网络如何适应表格数据的快速而完整的帖子。我正在使用fastai库来实现它。我们开始吧。</em></h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/40a8f0d998b8f08affef3bd22c32f91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7kbMfsYI653AaxFJbMwcg.jpeg"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">照片由<a class="ae jo" href="https://unsplash.com/@kmuza?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">卡洛斯·穆扎</a>在<a class="ae jo" href="https://unsplash.com/s/photos/tabular-data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="4883" class="jp jq hi bd jr js jt ju jv jw jx jy jz io ka ip kb ir kc is kd iu ke iv kf kg bi translated">理论洞察力</h1><p id="3ac9" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp kq kr ks kt ku kv kw kx ky kz la lb lc hb bi translated">表格数据用电子表格、关系数据库、财务报告等来表示。有许多领域需要表格数据分析，例如:</p><ul class=""><li id="6661" class="ld le hi kj b kk lf kn lg kq lh ku li ky lj lc lk ll lm ln bi translated">简历筛选</li><li id="4084" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">推荐系统</li><li id="a107" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">产品定价</li></ul><p id="128a" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">对表格数据使用神经网络是一个全新的想法，因为市场上已经有很多方法，如随机森林、GBM等。但是神经网络对表格数据也非常有用。对表格数据使用神经网络需要较少的维护，并且该方法是高效和可靠的。</p><p id="0c7e" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">Fastai使得使用神经网络分析表格数据变得非常容易。库<code class="du lw lx ly lz b">fastai.tabular</code>中有一个模块是专门为此目的而构建的。</p><h1 id="f4a3" class="jp jq hi bd jr js jt ju jv jw jx jy jz io ka ip kb ir kc is kd iu ke iv kf kg bi translated">实用知识</h1><p id="1ac6" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp kq kr ks kt ku kv kw kx ky kz la lb lc hb bi translated">让我们按如下方式导入库:</p><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="025f" class="me jq hi lz b fi mf mg l mh mi">from fastai.tabular import *</span></pre><p id="23de" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">除了fastai之外，pandas库还便于分析表格数据。Pandas DataFrame是Python中表格数据的标准格式。</p><p id="b2a2" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">让我们解开数据。数据作为fastai学术数据集之一提供。然后我们将使用熊猫来访问数据库。</p><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="0987" class="me jq hi lz b fi mf mg l mh mi">path = untar_data(URLs.ADULT_SAMPLE)<br/>df = pd.read_csv(path/'adult.csv'); df</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mj"><img src="../Images/6d163c452720d54512325bbe8d2cdc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*LeL_IsKxmLENDf7Lpv25fg.png"/></div></figure><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mk"><img src="../Images/1840d6ff0f141d64772fdf9ce8d477af.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*zmtQqbHArxmPvfw9SGolhg.png"/></div></figure><p id="b944" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">上传数据后，我们需要定义因变量、连续变量和分类变量。</p><p id="19d1" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">❓因变量、连续变量和分类变量是什么意思</p><ul class=""><li id="4662" class="ld le hi kj b kk lf kn lg kq lh ku li ky lj lc lk ll lm ln bi translated">因变量——我们需要找到其值的变量，其值依赖于自变量的变量。</li><li id="82fb" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">连续变量——可以取任何值的变量。</li><li id="3012" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">分类变量—具有一组已定义的取值的变量。这些值是有限的，代表不同的类别，如男性/女性、交通方式等。</li><li id="9518" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">对于分类变量，我们将使用一种叫做嵌入的东西。对于连续变量，它们可以像神经网络中的像素一样被发送到神经网络中。</li></ul><p id="0753" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">在此之后，我们需要提前定义将要发生的过程。因此，我们对数据帧进行预处理，而不是边走边处理。在输入训练数据集以训练模型之前，对训练数据集进行预处理。相同的预处理变量被带到测试和训练数据集。</p><ul class=""><li id="daf1" class="ld le hi kj b kk lf kn lg kq lh ku li ky lj lc lk ll lm ln bi translated">FillMissing它将通过列中存在的值的平均值来填充数据集中缺失的值。可能还有另一种方法来填充空值。</li><li id="4107" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">分类—将分类变量转换为类别，即熊猫类别。</li><li id="cb15" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">归一化—最后，归一化我们的数据，使平均值等于0，标准差等于1。</li></ul><p id="257d" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">让我们如上所述定义流程，如下所示:</p><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="941f" class="me jq hi lz b fi mf mg l mh mi"><strong class="lz hj">dep_var</strong> = 'salary'<br/><strong class="lz hj">cat_names</strong> = ['workclass', 'education', 'marital-status', 'occupation', 'relationship', 'race']<br/><strong class="lz hj">cont_names</strong> = ['age', 'fnlwgt', 'education-num']<br/><strong class="lz hj">procs</strong> = [FillMissing, Categorify, Normalize]</span></pre><p id="72c4" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">让我们使用<a class="ae jo" href="https://docs.fast.ai/tabular.data.html" rel="noopener ugc nofollow" target="_blank"> fastai数据块API </a>创建一个数据束。</p><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="7fab" class="me jq hi lz b fi mf mg l mh mi">data = (TabularList<br/>                   .<strong class="lz hj">from_df</strong>(df, path=path, cat_names=cat_names, cont_names=cont_names, procs=procs)<br/>                   .<strong class="lz hj">split_by_idx</strong>(list(range(800,1000)))<br/>                   .<strong class="lz hj">label_from_df</strong>(cols=dep_var)<br/>                   .<strong class="lz hj">databunch</strong>())</span></pre><ul class=""><li id="35ae" class="ld le hi kj b kk lf kn lg kq lh ku li ky lj lc lk ll lm ln bi translated">在上面的例子中，我们试图根据输入的类型创建一个表格列表。由于我们的输入是表格格式，因此我们将使用<strong class="kj hj"> TabularList </strong>来生成数据串。</li><li id="03c4" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">from_df —我们希望获得由<code class="du lw lx ly lz b">df</code>定义为数据帧的输入列表。我们还需要定义定义数据的路径。与此同时，我们需要定义分类变量和连续变量。最后，我们还需要为我们的数据传递流程。</li><li id="b00c" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">split_by_idx —我们希望从数据中提取200行到我们的验证数据集中。</li><li id="6d0d" class="ld le hi kj b kk lo kn lp kq lq ku lr ky ls lc lk ll lm ln bi translated">label_from_df —我们希望使用因变量来标记我们的数据。</li></ul><p id="f68e" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">如果您想查看一批数据:</p><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="ba56" class="me jq hi lz b fi mf mg l mh mi">data.show_batch(rows=10)</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es ml"><img src="../Images/0555cb3661a6e26b5704a4ed3e029b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3PyWfcxle-TzGSke63fuuw.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><strong class="bd jr">蓝色</strong>:分类变量，<strong class="bd jr">绿色</strong>:连续变量的平均值</figcaption></figure><h2 id="887f" class="me jq hi bd jr mm mn mo jv mp mq mr jz kq ms mt kb ku mu mv kd ky mw mx kf my bi translated">学习者</h2><p id="bc3d" class="pw-post-body-paragraph kh ki hi kj b kk kl ij km kn ko im kp kq kr ks kt ku kv kw kx ky kz la lb lc hb bi translated">对于表格数据串，我们有一个表格学习器。</p><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="28cb" class="me jq hi lz b fi mf mg l mh mi">learn = tabular_learner(data, layers=[200,100], metrics=accuracy)<br/>learn.fit(5, 1e-2)</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mz"><img src="../Images/bb554f9878c0604714503d849b9e49e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*Y_Uaxvy_g91D0qHBWC6Zuw.png"/></div></figure><p id="88b6" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated"><code class="du lw lx ly lz b">layers=</code> —这是我们定义架构的地方，就像我们为卷积网络选择ResNet 34或其他东西一样。它是指输入(嵌入后)和分类层之前的隐藏全连接层的大小。隐藏层的数量决定了列表的长度。</p><p id="da80" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi translated">如果您想获得更相关的结果，可以取消冻结，然后对学习者进行微调。想了解更多这方面的内容，可以去看看我的<a class="ae jo" rel="noopener" href="/analytics-vidhya/image-classification-using-fastai-5ff5b374d414">分类</a>帖子。</p><h2 id="2381" class="me jq hi bd jr mm mn mo jv mp mq mr jz kq ms mt kb ku mu mv kd ky mw mx kf my bi translated">结论</h2><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="9875" class="me jq hi lz b fi mf mg l mh mi">row = df.iloc[801]<br/>df.iloc[801]</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es na"><img src="../Images/17eae22408b5133e1a2ea477b9713c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*kNoyPEZgC_oEMge1fSjW6g.png"/></div></figure><pre class="iz ja jb jc fd ma lz mb mc aw md bi"><span id="5656" class="me jq hi lz b fi mf mg l mh mi">learn.predict(row)</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es nb"><img src="../Images/a1533c8978848eb7162359ba77280e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*dleC4qDFIP8gu00rgyqk8Q.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">我们的推断与实际数据相符。</figcaption></figure><p id="0e77" class="pw-post-body-paragraph kh ki hi kj b kk lf ij km kn lg im kp kq lt ks kt ku lu kw kx ky lv la lb lc hb bi nc translated">总有更多研究的空间，对表格数据的神经网络是一个非常大的研究来源。但在gist中，这就是我们如何使用神经网络来处理表格数据。</p></div></div>    
</body>
</html>