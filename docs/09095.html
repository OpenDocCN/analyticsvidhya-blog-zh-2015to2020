<html>
<head>
<title>Custom PDF Splitter using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 定制 PDF 分割器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/custom-pdf-splitter-using-python-d2c1def7b311?source=collection_archive---------7-----------------------#2020-08-25">https://medium.com/analytics-vidhya/custom-pdf-splitter-using-python-d2c1def7b311?source=collection_archive---------7-----------------------#2020-08-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4d68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每次当我们想分割 PDF 时，我们会去不同的网站，如 ilovepdf 或任何其他网站。想象一下，如果我们没有互联网接入，但仍然想做 pdf 的分割！！！</p><blockquote class="jd je jf"><p id="d2ee" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">有没有想过我们可以使用 Python 制作自己的 PDF 分割器</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/5b969b414817914afb5a25fb99ab4e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wele53uulIU3J1-u8yvxAA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">pdf 拆分器图像</figcaption></figure><p id="924a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们构建 Python 脚本来帮助我们分割 PDF 文件。</p><p id="e670" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个脚本中，我们将把 PDF 文件名、起始页、结束页作为命令行参数。</p><p id="12f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> PDF_File_name </strong>:用户需要提供完整的路径和文件名。比如，如果你在 c 盘中存储了<strong class="ih hj"><em class="jg">【abc.pdf】</em></strong>文件，那么你需要输入如下内容:<strong class="ih hj"> <em class="jg"> "c:\\abc.pdf" </em> </strong></p><p id="45c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">开始页面</strong>:从哪一页开始分割 pdf</p><p id="74e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结束页面</strong>:您想要停止分割 pdf 的页面</p><p id="be3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们的命令提示符屏幕看起来会像这样。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ka"><img src="../Images/f4fca7460dfd8c23e95284b854b53103.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*0i1FXkLUOkpYfmWY2FfkjQ.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">命令提示符</figcaption></figure><p id="3ca1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以这里的文件名是“abc.pdf”(我给出了完整的路径，因为我的 pdf 文件在不同的位置，而 pdfsplits_1.py 文件在不同的位置。)</p><p id="c2e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">起始页= 1，结束页= 5。</p><p id="69f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在让我们从头开始构建它。</p><p id="fd0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们要做的第一件事是导入一些库。</p><ol class=""><li id="efc2" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">PyPDF2</li><li id="ad8b" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">[计]系统复制命令（system 的简写）</li></ol><p id="c345" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PyPDF2:我们将使用这个库来读写 PDF 文件。我们需要做的第一件事是使用下面的命令安装 PyPDF2 库。</p><blockquote class="jd je jf"><p id="aa10" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">P <!-- --> yPDF2 : pip 安装 PyPDF2</p></blockquote><p id="1b02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sys:它内置在库中，所以任何安装都需要。</p><p id="8973" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建 pdfsplit.py 文件。我们将把 pdf 文件名和起始页和结束页作为命令行参数。</p><p id="4c66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1 .导入这两个库。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kp"><img src="../Images/5ff4eef5467d604c2890976dfaa27ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*wQJTujHllxxYWnI0GPRlvA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">进口</figcaption></figure><p id="0ccb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.现在，让我们检查用户需要提供的命令行输入，如 pdf_file_name、start-page、end-page。</p><p id="4b6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了检查这一点，我们将使用 sys 库，并且我们将使用<strong class="ih hj"> argv </strong>来检查用户给出了多少个参数。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kq"><img src="../Images/ff39654c7a77f4293beef0b2d2fff2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N7MSAcfWAbNhdbBYEP1ezA.png"/></div></div></figure><p id="5015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果参数少于 4，我们将显示错误消息。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kr"><img src="../Images/0d718888666f6c3ae60e262d51dab342.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*yUNdNANupoZH19_1nvM0vw.png"/></div></figure><p id="9120" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在错误地使用了少于 4 个参数，那么我们将向他们显示错误。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ks"><img src="../Images/2fcd8cf647b518c44f01c11cef1b016c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*r0NA_QkY6RkU-5GDVSlwrA.png"/></div></figure><p id="4e88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果用户给出了正确的输入，那么我们将这样处理它</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kt"><img src="../Images/eb212d4ce30bb024e0ba87bfc71941da.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*hWpuPvwLLnEUYacMndgGhQ.png"/></div></figure><blockquote class="jd je jf"><p id="1eb9" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">现在让我们看看我们创建的<strong class="ih hj">“pdf _ splitter”</strong>函数。</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ku"><img src="../Images/168de54681f2373c3974958cbb22e558.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*j9DVs--m_5a1YslIxaycAg.png"/></div></figure><p id="0418" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 pdf_splitter 函数中，我们将做以下事情。</p><blockquote class="jd je jf"><p id="d365" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">为分割的 pdf 设置新的 pdf 名称。</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kv"><img src="../Images/fad9071832138f43acaaede62ca346d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*SmElTaje7NIJCuxc7KJq5g.png"/></div></figure><blockquote class="jd je jf"><p id="60bf" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">我们将阅读用户提供的 pdf 文件。</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kw"><img src="../Images/c08f6be87a8de73e25c3a537b3809190.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*FrJvf6ExK4zifLIf5g_SNg.png"/></div></figure><blockquote class="jd je jf"><p id="99dc" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">下一步是创建 pdf 文件编写器对象。</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kx"><img src="../Images/805b9b2eeb8f9e10aed39656e367b184.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*lceTw57-H_t_fGEbonWblA.png"/></div></figure><blockquote class="jd je jf"><p id="7a24" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">现在让我们以二进制形式打开 new_splitted_pdf。</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ky"><img src="../Images/fe2201cd2b81ee9ff1f9f43adf2686b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*2cK-KbdzJoWHOWiUHQUU4g.png"/></div></figure><p id="ea23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们从给定的起始页到结束页循环通过所有页面。在循环浏览所有页面时，我们将阅读整个页面并将其添加到新的 pdf 中。当我们阅读所有页面并将其添加到我们的新 pdf 中时，我们将打印成功创建的 pdf。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kz"><img src="../Images/7bc4b45721918964de9bd7226895bfe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*faaBJA93eNeemH1NNzqjfw.png"/></div></figure><p id="c83c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们结合所有步骤，看看整个代码。(我已经添加了 try and catch 块)</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es la"><img src="../Images/182cfbd4bf59396c1e897c665e0ee999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yiZCyHQejkjAFK_ORXSRA.png"/></div></div></figure><p id="fc9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看工作示例。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lb"><img src="../Images/5f51fab2c48f5957e865cb02a6dc5756.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*-7lCrvaRQx3aBg_DMDywBA.png"/></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lc"><img src="../Images/6365ac3a777b0c73080193a52ce86f55.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*RHZJEtEGYttp6sB3H1ZAEw.png"/></div></figure><p id="5636" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新的“abc splitted.pdf”文件仅包含 5 页。</p><p id="57bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以从给定的链接获得这个脚本。</p><p id="519e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ld" href="https://github.com/raj1997/Python-PDF-Splitter-Script" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="jg">https://github.com/raj1997/Python-PDF-Splitter-Scrip</em></strong></a><strong class="ih hj"><em class="jg"/></strong></p></div></div>    
</body>
</html>