<html>
<head>
<title>Email Spam Detection with Explainable AI Lime</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于可解释人工智能的垃圾邮件检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/email-spam-detection-with-explainable-ai-lime-325f14ba683f?source=collection_archive---------10-----------------------#2020-02-26">https://medium.com/analytics-vidhya/email-spam-detection-with-explainable-ai-lime-325f14ba683f?source=collection_archive---------10-----------------------#2020-02-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/8605af140ff5f2da1903d949d4ee3c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*vtAHb15E8eiHOQK9qqPjIw.jpeg"/></div></figure><p id="046a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这篇博文讨论了一个简单的垃圾邮件检测逻辑回归算法，该算法使用朴素贝叶斯来预测电子邮件是否是垃圾邮件。之后使用LIME(可解释的AI)解释算法的结果。</p><h1 id="a691" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">数据源:</h1><div class="ki kj ez fb kk kl"><a href="https://www.kaggle.com/karthickveerakumar/spam-filter" rel="noopener  ugc nofollow" target="_blank"><div class="km ab dw"><div class="kn ab ko cl cj kp"><h2 class="bd hj fi z dy kq ea eb kr ed ef hh bi translated">垃圾邮件过滤器</h2><div class="ks l"><h3 class="bd b fi z dy kq ea eb kr ed ef dx translated">使用电子邮件识别垃圾邮件</h3></div><div class="kt l"><p class="bd b fp z dy kq ea eb kr ed ef dx translated">www.kaggle.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz ik kl"/></div></div></a></div><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/99a94d1d7f9324872061abe3a356533a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6G5aJWREPKHtXxpRWJp8g.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">数据规格</figcaption></figure><h1 id="1717" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">加载数据:</h1><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="78ce" class="ls jl hi lo b fi lt lu l lv lw"><strong class="lo hj">import</strong> <strong class="lo hj">numpy</strong> <strong class="lo hj">as</strong> <strong class="lo hj">np</strong> <br/><strong class="lo hj">import</strong> <strong class="lo hj">pandas</strong> <strong class="lo hj">as</strong> <strong class="lo hj">pd</strong> <br/><strong class="lo hj">import</strong> <strong class="lo hj">matplotlib.pyplot</strong> <strong class="lo hj">as</strong> <strong class="lo hj">plt</strong><br/>% matplotlib inline<br/><br/>df=pd.read_csv("emails.csv")<br/>df.head()</span></pre><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/0380dde4653d7262d52eb4b37e68f7b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*PFtqS96e6mX1-usSel4Tqw.png"/></div></figure><h1 id="b61a" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">数据集分布:</h1><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="ead5" class="ls jl hi lo b fi lt lu l lv lw">df['spam'].value_counts().plot.bar()</span></pre><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/e7a5f6b6756ee0cd4562a0661f17c5f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*l0l6TGyixwn--iKa_ht_Cw.png"/></div></figure><h1 id="b232" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">文本矢量化:</h1><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="0a39" class="ls jl hi lo b fi lt lu l lv lw"><strong class="lo hj">from</strong> <strong class="lo hj">sklearn.feature_extraction.text</strong> <strong class="lo hj">import</strong> TfidfVectorizer<br/>tfidf = TfidfVectorizer(sublinear_tf=<strong class="lo hj">True</strong>, min_df=5, norm='l2', ngram_range=(1, 2), stop_words='english')<br/>features = tfidf.fit_transform(df['text']).toarray()<br/>features.shape<br/>X=pd.DataFrame(data=features)<br/>Y=df['spam'].astype(str)<br/>df['spam']=df['spam'].astype(str)</span></pre><h1 id="2c00" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">训练朴素贝叶斯分类器:</h1><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="2cd3" class="ls jl hi lo b fi lt lu l lv lw"><strong class="lo hj">from</strong> <strong class="lo hj">sklearn.model_selection</strong> <strong class="lo hj">import</strong> train_test_split<br/><strong class="lo hj">from</strong> <strong class="lo hj">sklearn.feature_extraction.text</strong> <strong class="lo hj">import</strong> CountVectorizer<br/><strong class="lo hj">from</strong> <strong class="lo hj">sklearn.feature_extraction.text</strong> <strong class="lo hj">import</strong> TfidfTransformer<br/><strong class="lo hj">from</strong> <strong class="lo hj">sklearn.naive_bayes</strong> <strong class="lo hj">import</strong> MultinomialNB<br/><br/>    <br/><br/>X_train, X_test, y_train, y_test = train_test_split(X, Y, random_state = 0)<br/><br/>clf = MultinomialNB().fit(X_train, y_train)</span></pre><h1 id="c859" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">进行预测:</h1><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="bac2" class="ls jl hi lo b fi lt lu l lv lw">y_pred=clf.predict(X_test)</span></pre><h1 id="4733" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">分类指标:</h1><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="455c" class="ls jl hi lo b fi lt lu l lv lw"><strong class="lo hj">from</strong> <strong class="lo hj">sklearn.metrics</strong> <strong class="lo hj">import</strong> classification_report<br/>print(classification_report(y_test, y_pred))</span></pre><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/eb36aaff9828bd36e1704b3b173c785b.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*50Z8n8U_suRfFOKtR0C_Gg.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">分类报告</figcaption></figure><h1 id="e4f1" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">使用石灰建立可解释的模型:</h1><h2 id="12db" class="ls jl hi bd jm ma mb mc jq md me mf ju ix mg mh jy jb mi mj kc jf mk ml kg mm bi translated">什么是可解释的人工智能，为什么它很重要？</h2><p id="2003" class="pw-post-body-paragraph im in hi io b ip mn ir is it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj hb bi translated">在一个产品背后，有一个由数据分析师、业务分析师、产品工程师、销售、市场营销等组成的团队。很明显，一个团队的范围从技术专家到没有技术语言或技术语言有限的业务专家。所以现在的问题是，作为一名机器学习开发者，我如何解释我的见解。我怎样才能给我的结果带来自信？我一个商业人士怎么能在“黑匣子”上做决定。</p><p id="ce2b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">答案是“可解释的人工智能”砰！。<strong class="io hj">可解释的人工智能</strong>指的是解决方案的结果可以被人类专家理解的方法和技术。</p><h2 id="3c37" class="ls jl hi bd jm ma mb mc jq md me mf ju ix mg mh jy jb mi mj kc jf mk ml kg mm bi translated">石灰安装:</h2><p id="a8f9" class="pw-post-body-paragraph im in hi io b ip mn ir is it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj hb bi translated">Lime可以使用pip命令简单地安装。</p><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="611e" class="ls jl hi lo b fi lt lu l lv lw">pip install lime</span></pre><h2 id="5c11" class="ls jl hi bd jm ma mb mc jq md me mf ju ix mg mh jy jb mi mj kc jf mk ml kg mm bi translated">实施:</h2><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="a466" class="ls jl hi lo b fi lt lu l lv lw"><strong class="lo hj">from</strong> <strong class="lo hj">lime.lime_text</strong> <strong class="lo hj">import</strong> LimeTextExplainer<br/>class_names=['0','1']<br/>explainer = LimeTextExplainer(class_names=class_names)</span><span id="2374" class="ls jl hi lo b fi ms lu l lv lw">idx = 30<br/>exp = explainer.explain_instance(df.text[idx], c.predict_proba, num_features=6)<br/>print('Document id: <strong class="lo hj">%d</strong>' % idx)<br/>print('Probability=', c.predict_proba([df.text[idx]])[0,1])<br/>print('True class: <strong class="lo hj">%s</strong>' % df.spam[idx])</span><span id="a140" class="ls jl hi lo b fi ms lu l lv lw">exp.as_list()</span></pre><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/64626848a7026cf75623a85ea043d01e.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*b4J-PQl7MkwzbgYiRQ7gwA.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">exp.as_list()</figcaption></figure><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="ac35" class="ls jl hi lo b fi lt lu l lv lw">%matplotlib inline<br/>fig = exp.as_pyplot_figure()</span></pre><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/eafe7527bf13c3bc7039155129dcf88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*DrkPB8fCsnn1farrI2yXVw.png"/></div></figure><pre class="lb lc ld le fd ln lo lp lq aw lr bi"><span id="1df7" class="ls jl hi lo b fi lt lu l lv lw">exp.show_in_notebook(text=<strong class="lo hj">True</strong>)</span></pre><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es mv"><img src="../Images/1c419e815ba575c9fcfbfc6d0c5ddae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qgkg-Rp2Dhe16WIir2Gw6g.png"/></div></div></figure><h2 id="f74f" class="ls jl hi bd jm ma mb mc jq md me mf ju ix mg mh jy jb mi mj kc jf mk ml kg mm bi translated">结论:</h2><p id="311a" class="pw-post-body-paragraph im in hi io b ip mn ir is it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj hb bi translated">我们能够构建一个简单的二进制垃圾邮件分类问题。不仅如此，我们还学会了用石灰构建可解释的人工智能。</p><p id="f4fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Lime解释了为什么某封邮件被识别为垃圾邮件。它通过颜色编码给出了在分类任务中使用的每个表征重要性的见解。</p><p id="b4aa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该算法给出了97%的正确预测。该算法以59%的置信度预测上述特定电子邮件为“垃圾邮件”，以41%的置信度预测为“非垃圾邮件”。像“卡”、“想要”这样的词更有可能出现在垃圾邮件中。</p></div></div>    
</body>
</html>