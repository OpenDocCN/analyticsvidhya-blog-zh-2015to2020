<html>
<head>
<title>6 Steps to Build RoBERTa (a Robustly Optimised BERT Pretraining Approach)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建RoBERTa的6个步骤(稳健优化的BERT预训练方法)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/6-steps-to-build-roberta-a-robustly-optimised-bert-pretraining-approach-e508ebe78b96?source=collection_archive---------5-----------------------#2019-12-28">https://medium.com/analytics-vidhya/6-steps-to-build-roberta-a-robustly-optimised-bert-pretraining-approach-e508ebe78b96?source=collection_archive---------5-----------------------#2019-12-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="9662" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">带代码的实践教程</h2><div class=""/><blockquote class="io ip iq"><p id="93a8" class="ir is it iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">您可以了解如何为NLP分类任务构建预训练模型</p></blockquote><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jq"><img src="../Images/6631f04d57e6f36f954318c63216c177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x7GmjvYpRBeaEcIH"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">安妮·斯普拉特在<a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><p id="33e2" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">在本文中，提供了一个实践教程来构建RoBERTa(一种鲁棒优化的BERT预训练方法)用于NLP分类任务。</p><p id="1d81" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated"><a class="ae kg" href="https://github.com/jinisaweaklearner/ML-DL-papers-and-code/blob/master/src/RoBERTa_multi_class_yelp5.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="iu hs"> <em class="it">代码上传到Github【点击这里】</em> </strong> </a> <strong class="iu hs"> <em class="it">。</em>T13】</strong></p><p id="cca1" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">使用最新/最先进的模型的问题是API不容易使用，并且几乎没有文档和教程(不像使用XGBoost或LightGBM)。</p><p id="23e4" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">在这里，我尽量简化步骤，以建立更多的和有更多的评论。如果你的任务是通过使用文本建立一个分类(二进制/多类)模型，<strong class="iu hs">你只需要在步骤2中改变很少的参数/行</strong>。</p><p id="e013" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">请随意使用、修改代码并给予反馈。让我们边做边学吧！</p><h1 id="b720" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">步骤1-导入包</h1><p id="a707" class="pw-post-body-paragraph ir is hi iu b iv lp ix iy iz lq jb jc ko lr jf jg kp ls jj jk kq lt jn jo jp hb bi translated">在步骤1中，我们需要如下导入所有的包。</p><figure class="jr js jt ju fd jv"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="e769" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">为了给第一次使用这些软件包的人简化这一步，我强烈推荐使用<strong class="iu hs"> Google Colab </strong>并将文件存储在Google Drive上。为什么？大部分包已经安装完毕，你可以在Colab上自由使用GPU。</p><p id="218d" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">你需要安装的唯一软件包是“pytorch-transformers”。</p><figure class="jr js jt ju fd jv"><div class="bz dy l di"><div class="lu lv l"/></div></figure><h1 id="4caf" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">步骤2 —设置配置</h1><p id="adb1" class="pw-post-body-paragraph ir is hi iu b iv lp ix iy iz lq jb jc ko lr jf jg kp ls jj jk kq lt jn jo jp hb bi translated">几乎所有的更改都应该在“config”中。特别是，它们是模型的超参数、文件路径和列名。</p><p id="9733" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">要快速尝试一个参数较少的简单模型，我建议:</p><pre class="jr js jt ju fd lw lx ly lz aw ma bi"><span id="6601" class="mb ks hi lx b fi mc md l me mf">roberta_model_name: 'roberta-base'<br/>max_seq_len: about 250<br/>bs: 16 (you are free to use large batch size to speed up modelling)</span></pre><p id="9bc2" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">为了提高<strong class="iu hs">精度</strong>并有更多的参数，我建议:</p><pre class="jr js jt ju fd lw lx ly lz aw ma bi"><span id="4d0e" class="mb ks hi lx b fi mc md l me mf">roberta_model_name: 'roberta-large'<br/>max_seq_len: over 300<br/>bs: 4 (because of the limitation of GPU memory)</span></pre><p id="71ab" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">以后要有多个不同的模型，用集成学习，我建议换:</p><pre class="jr js jt ju fd lw lx ly lz aw ma bi"><span id="4c17" class="mb ks hi lx b fi mc md l me mf">seed<br/>valid_pct<br/>hidden_dropout_prob</span></pre><p id="9f63" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">要构建二元模型或多类模型，您可以更改:</p><pre class="jr js jt ju fd lw lx ly lz aw ma bi"><span id="d59a" class="mb ks hi lx b fi mc md l me mf">num_labels</span></pre><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es mg"><img src="../Images/18c487e688d67c791ad3b7b13cfceaae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWiC1UAf9-Kt0NGts-yqQA.png"/></div></div></figure><h1 id="643b" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">步骤3 —设置令牌化器</h1><p id="7e10" class="pw-post-body-paragraph ir is hi iu b iv lp ix iy iz lq jb jc ko lr jf jg kp ls jj jk kq lt jn jo jp hb bi translated">你不需要改变这里的任何东西，:D</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es mh"><img src="../Images/f679f9312fdbd258369902913c427866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6QJ2JG6usOawAutbbWrRA.png"/></div></div></figure><h1 id="23bb" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">步骤4 —设置数据集中</h1><p id="c7b6" class="pw-post-body-paragraph ir is hi iu b iv lp ix iy iz lq jb jc ko lr jf jg kp ls jj jk kq lt jn jo jp hb bi translated">因为路径和列名已经在步骤2中设置好了，所以不需要在这里做任何更改。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es mi"><img src="../Images/757e45194f3047f3cd44439285e8b08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_V7dUWBEF6YdaIN7bXfc_A.png"/></div></div></figure><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es mj"><img src="../Images/76deedf2583744c6e8144b4cc8698c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76pccZg5ZPxGA8iIRcpASA.png"/></div></div></figure><h1 id="c7c2" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">步骤5 —培训和评估</h1><p id="ebf5" class="pw-post-body-paragraph ir is hi iu b iv lp ix iy iz lq jb jc ko lr jf jg kp ls jj jk kq lt jn jo jp hb bi translated">同样，您不需要在这里更改任何内容！我在下面留了一些注释，这样你就可以很容易地修改代码。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es mk"><img src="../Images/f89d1dcfe24289fb28526554acf4caa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZSRJql_-79quD01hzpShQ.png"/></div></div></figure><h1 id="da9c" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">第六步——预测</h1><p id="e9dd" class="pw-post-body-paragraph ir is hi iu b iv lp ix iy iz lq jb jc ko lr jf jg kp ls jj jk kq lt jn jo jp hb bi translated">这是最后一步！你可以得到预测，如果你想得到概率而不是0/1，你需要在get_preds_as_nparray中改变返回。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es ml"><img src="../Images/2eae0a4a7c4e68fe69c801fc08d70320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3MapK3EuX0KcEB8krYwLQA.png"/></div></div></figure><p id="b0ab" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated"><a class="ae kg" rel="noopener" href="/@jinisaweaklearner/everything-you-need-about-evaluating-classification-models-dfb89c60e643"> <strong class="iu hs"> <em class="it">您可以在这里</em> </strong> </a>查看分类模型的7个不同评价指标。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="1d27" class="kr ks hi bd kt ku mm kw kx ky mn la lb lc mo le lf lg mp li lj lk mq lm ln lo bi translated">资源</h1><p id="df94" class="pw-post-body-paragraph ir is hi iu b iv lp ix iy iz lq jb jc ko lr jf jg kp ls jj jk kq lt jn jo jp hb bi translated">fast . ai:<a class="ae kg" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank">https://www.fast.ai/</a></p><p id="2a61" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">变形金刚Github:<a class="ae kg" href="https://github.com/huggingface/transformers" rel="noopener ugc nofollow" target="_blank">https://github.com/huggingface/transformers</a></p><p id="bc88" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">变形金刚文档:<a class="ae kg" href="https://huggingface.co/transformers/" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/transformers/</a></p><p id="5327" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">Github上二进制分类问题使用RoBERTa的一个例子:<a class="ae kg" href="https://github.com/devkosal/fastai_roberta/blob/master/fastai_roberta_imdb/Using%20RoBERTa%20with%20Fastai%20Tutorial.ipynb" rel="noopener ugc nofollow" target="_blank">https://Github . com/devkosal/fastai _ RoBERTa/blob/master/fastai _ RoBERTa _ IMDB/使用% 20 RoBERTa % 20 with % 20 fastai % 20 tutorial . ipynb</a></p><p id="6137" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">fast.ai Youtube教程:<a class="ae kg" href="https://www.youtube.com/playlist?list=PLtmWHNX-gukKocXQOkQjuVxglSDYWsSh9" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/playlist?list = PLtmWHNX-gukkocxqokqjuvxglsdywsh 9</a></p><p id="6e7a" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">伯特论文:<a class="ae kg" href="https://arxiv.org/pdf/1810.04805.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1810.04805.pdf</a></p><p id="9fd8" class="pw-post-body-paragraph ir is hi iu b iv iw ix iy iz ja jb jc ko je jf jg kp ji jj jk kq jm jn jo jp hb bi translated">罗伯塔论文:<a class="ae kg" href="https://arxiv.org/pdf/1907.11692.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1907.11692.pdf</a></p></div></div>    
</body>
</html>