<html>
<head>
<title>Troubleshoot Building a Log Analytics Solution using Amazon Web Services technologies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Amazon Web Services技术构建日志分析解决方案的疑难解答</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/troubleshoot-building-a-log-analytics-solution-using-amazon-web-services-technologies-ea2371ab1dfc?source=collection_archive---------15-----------------------#2020-03-12">https://medium.com/analytics-vidhya/troubleshoot-building-a-log-analytics-solution-using-amazon-web-services-technologies-ea2371ab1dfc?source=collection_archive---------15-----------------------#2020-03-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b482e2210d29816981a01e2d094e339e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B73Pxoa5Dvjs4qmsx931UA.png"/></div></div></figure><h1 id="de55" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="ac53" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">什么是大数据？您首先想到的是，数据量大吗？是的，在某种程度上。但是，大数据不仅仅由数量决定，它基本上是由4v定义的，即数量、速度、多样性和准确性。目前，有更多的v定义了大数据的有效性、可变性、脆弱性等。亚马逊网络服务(aws)是一家云服务提供商，拥有大量技术，可以在许多方面轻松处理大数据。在许多大数据用例中，日志分析是一种常见的用例，它允许您分析来自网站、移动设备、服务器、传感器和各种应用程序的日志数据。<a class="ae km" href="https://aws.amazon.com/getting-started/projects/build-log-analytics-solution/" rel="noopener ugc nofollow" target="_blank">这里提到的日志分析项目</a>是一个使用aws技术构建日志分析器并在<a class="ae km" href="https://www.elastic.co/guide/en/kibana/current/dashboard.html" rel="noopener ugc nofollow" target="_blank"> Kibana dashboard </a>中可视化分析输出的综合示例。在本文中，我将介绍我在完成这个项目时遇到的问题以及故障排除步骤。</p><h1 id="83d1" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">逐步指导和排除故障，使您的项目进入工作阶段</h1><p id="bc22" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">首先，你需要创建一个aws帐户，允许继续进行项目访问所需的技术。</p><p id="128e" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">然后启动一个ec2实例，如<a class="ae km" href="https://d1.awsstatic.com/Projects/P4113850/aws-projects_build-log-analytics-solution-on-aws.pdf" rel="noopener ugc nofollow" target="_blank">项目指南</a>中所述。在ec2实例进入运行状态后，您可以使用ssh客户端连接到实例，如下例所示。在这里，sample.pem是ec2密钥对，ec2–54–167–199–228.compute-1.amazonaws.com是创建的ec2实例。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="743e" class="lb ir hi kx b fi lc ld l le lf">ssh -i sample.pem ec2-user@ec2–54–167–199–228.compute-1.amazonaws.com</span></pre><p id="5b3a" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">然后，您需要附加一个IAM角色，该角色具有允许wirte访问Amazon Kinesis Firehose和Amazon CloudWatch的访问策略。您可以通过授予对这两种服务的完全访问权限来创建IAM角色。</p><p id="96fd" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">然后，您需要使用<a class="ae km" href="https://github.com/kiritbasu/Fake-Apache-Log-Generator" rel="noopener ugc nofollow" target="_blank">假Apache日志生成器</a>生成日志文件。运行项目的一种方法是手动下载它，然后使用下面的命令将它转移到ec2实例，假设您处于根级别。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="bb47" class="lb ir hi kx b fi lc ld l le lf">scp -i Desktop/sample.pem -r Documents/Fake-Apache-Log-Generator ec2-user@ec2–54–167–199–228.compute-1.amazonaws.com:~/.</span></pre><h1 id="1f5d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">找不到pip命令</h1><p id="db86" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">当您尝试使用requirements.txt文件和<strong class="jq hj">pip install-r requirements . txt</strong>来安装依赖项时，您可能会得到一个错误消息，说<em class="lg"> pip命令未找到</em>。在这种情况下，您可以运行以下命令来安装pip。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="8805" class="lb ir hi kx b fi lc ld l le lf">sudo yum install python-pip</span></pre><h1 id="c567" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">o错误:[错误13]权限被拒绝</h1><p id="945c" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">之后，如果您尝试在项目级别运行该命令，您可能会得到一个错误，如<strong class="jq hj"> OSError: [Errno 13]权限被拒绝:'/usr/local/lib/…。</strong>。为了克服这个问题，作为一个简单的解决方案，您可以在根级别运行这个命令。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="4e6d" class="lb ir hi kx b fi lc ld l le lf">pip install -r Fake-Apache-Log-Generator/requirements.txt</span></pre><p id="6bcc" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">这将成功导入运行项目所需的依赖项。按照指南中的说明完成此步骤。</p><p id="44ab" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">然后，您必须创建一个Amazon Firehose交付流，它将允许您将生成的日志泵入配置的s3存储桶。接下来，您需要下载并安装aws-kinesis-agent，它会将您的日志放入交付流。您可以按照指南中的说明根据需要更改<em class="lg"> agent.json </em>文件。</p><h1 id="b19d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">0条记录已解析、转换并成功发送了0条记录</h1><p id="866f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">接下来，您可以检查配置的s3存储桶，以检查流是否成功工作。如果没有，请检查位于<strong class="jq hj">/var/log/aws-kinesis-agent/AWS-kine sis-agent . log .</strong>的AWS-kine sis-agent日志。如果日志显示<strong class="jq hj"> 0条记录已解析、转换并成功发送0条记录</strong>，您将需要检查aws-kinesis-agent-user是否拥有对生成的日志文件位置的读取和执行权限。假设您的日志文件位于/home/ec2-user/Fake-Apache-Log-Generator路径中。您可以通过发出以下命令来检查权限。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="cd0f" class="lb ir hi kx b fi lc ld l le lf">ls -l /home/ec2-user/Fake-Apache-Log-Generator</span></pre><p id="17ed" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">现在你必须设置权限给<strong class="jq hj"> aws-kinesis-agent-user </strong>对路径中每个目录的读取和执行权限。在本例中，您需要将权限设置为/home、/home/ec2-user、/home/ec2-user/Fake-Apache-Log-Generator目录和/home/ec2-user/Fake-Apache-Log-Generator/*。记录日志文件。为aws-kinesis-agent-user设置主目录权限的示例如下所示。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="cf96" class="lb ir hi kx b fi lc ld l le lf">chown -R aws-kinesis-agent-user /home<br/>chmod -R 755 /home</span></pre><p id="a9a3" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">设置权限后，您需要使用以下命令重新启动aws-kinesis-agent。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="f528" class="lb ir hi kx b fi lc ld l le lf">sudo service aws-kinesis-agent restart</span></pre><p id="2846" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">然后，您将看到日志被传送到配置的s3存储桶。</p><p id="eafe" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">嘣！！！现在你有一个流进入你的s3桶。现在完成项目已经不是什么难事了:d。</p><p id="fdbc" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">这些是我在项目中遇到的问题，我已经描述了故障排除步骤，这样你就可以让你的日志分析器在你的手边工作。完成该项目后，您将在Kibana dashboard中获得良好的可视化效果，并对日志进行适当的分析，如下所示。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/9c382abec37f012855f1e78975ce4869.png" data-original-src="https://miro.medium.com/v2/resize:fit:60/0*vToPuy6IZIWFsgY0"/></div></figure><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/bdc55a183dd9e03920fcbfd0df527d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*APlcxbjkH_4oN_Vs.png"/></div></div></figure><p id="48d0" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">基巴纳仪表板</p><p id="eca5" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">希望你能够成功地完成这个项目，我的文章将有助于实现它。干杯！！！！！</p><p id="e820" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">如有任何疑问，请通过sewwandikaus.13@cse.mrt.ac.lk联系我。</p><h1 id="310d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">参考</h1><p id="d653" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">[1]<a class="ae km" href="https://aws.amazon.com/getting-started/projects/build-log-analytics-solution/" rel="noopener ugc nofollow" target="_blank">https://AWS . Amazon . com/getting-started/projects/build-log-analytics-solution/</a></p></div></div>    
</body>
</html>