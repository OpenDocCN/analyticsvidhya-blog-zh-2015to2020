<html>
<head>
<title>A Neural Networks based approach to detect Covid-19 through Chest X-Ray</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于神经网络的胸部 x 光新冠肺炎检测方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-neural-networks-based-approach-to-detect-covid-19-through-chest-x-ray-c11c2b44824d?source=collection_archive---------10-----------------------#2020-12-13">https://medium.com/analytics-vidhya/a-neural-networks-based-approach-to-detect-covid-19-through-chest-x-ray-c11c2b44824d?source=collection_archive---------10-----------------------#2020-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f774" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要非常规的方法来对抗这种致命的病毒！</p><p id="a4ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正面临着第三波致命的冠状病毒(新冠肺炎),它已经在世界各地造成了疫情局势，影响到 200 多个国家和地区。这种病毒很容易在人与人之间传播，或者通过触摸受感染的表面传播。新冠肺炎病毒感染的主要症状是发烧、干咳、味觉/嗅觉丧失和呼吸急促。在一些地区，由于缺乏检测试剂盒和医疗保健中心的巨大负担，识别新冠肺炎患者仍然是困难和昂贵的。在测试过程中，从鼻子或喉咙后部的拭子中采集样本，然后实验室检查拭子样本中的病毒遗传物质，一两天后得出测试结果。这个过程是痛苦的，耗时的和昂贵的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/0baa40c4eb82bf3b01c275c31dd90030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kdLGHKdMRxTWMaKPlX7CjQ.png"/></div></div></figure><p id="8fca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新冠肺炎以某种方式影响患者的身体，特别是它攻击和损害人类胸部和肺部的某些区域。该想法是开发一种基于深度神经网络的解决方案，以在患者的胸部 X 射线图像的帮助下自动检测新冠肺炎，一些组织已经创建了公共存储库，其中包含新冠肺炎患者的真实胸部 X 射线图像数据集。</p><p id="d0a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经设计并训练了一个卷积神经网络，它覆盖了成千上万的新冠肺炎效应和正常的 x 光图像。该模型获取疑似患者的 X 射线图像，并提供二元分类来预测(新冠肺炎阳性或正常)。本文一步一步地展示了使用<strong class="ih hj"> Keras </strong>实现的上述项目，即<strong class="ih hj">T5 是运行在<strong class="ih hj"> TensorFlow </strong>顶层的高级 Python 神经网络库。</strong></p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="d8d6" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">资料组</h1><p id="7982" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">本项目中使用的数据集取自两个不同的来源 Kaggle 和 Gituhub，构成了一个包含 3500 幅图像的数据集，其中 70%为训练图像，15%为 val 图像，15%为测试图像，50%为新冠肺炎图像和普通 X 射线图像。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es la"><img src="../Images/ad456e03ac542daa57924918a460fef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*qYcukSkCCHGIMDnDqHJ2AA.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">数据集分布</figcaption></figure><ul class=""><li id="58d8" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">训练集→ 2450 幅图像</li><li id="2c2b" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">验证<em class="jd"> </em>设置→ 550 张图片</li><li id="5c12" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><em class="jd">测试集→ 550 张图像</em></li></ul><h2 id="e911" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">数据来源 1: Kaggle</h2><p id="fd70" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">来自<a class="ae mh" href="https://www.kaggle.com/darshan1504/covid19-detection-xray-dataset" rel="noopener ugc nofollow" target="_blank"> kaggle </a>的数据集由新冠肺炎、细菌性和病毒性肺炎患者以及没有任何疾病的正常人的 X 射线(PA-CXR)图像组成。</p><h2 id="8709" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">数据来源 2: Github</h2><p id="87f3" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">第二个数据集的来源是一个<a class="ae mh" href="https://github.com/ieee8023/covid-chestxray-dataset" rel="noopener ugc nofollow" target="_blank"> gituhub </a>存储库，其中包含新冠肺炎或其他病毒性和细菌性肺炎阳性患者的胸部 x 光和 CT 图像的开放数据集。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="dfde" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">履行</h1><p id="eebc" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated"><strong class="ih hj"> TensorFlow </strong>是一个开源库，用于数据流和跨一系列任务的可区分编程，即机器学习/深度学习应用，如神经网络。<strong class="ih hj"> Keras </strong>是一个用 Python 编写的开源神经网络库，能够运行在 TensorFlow、微软认知工具包、R、Theano 或 PlaidML 之上。这是一个行业强度的框架，可以扩展到大型 GPU 集群或整个<a class="ae mh" href="https://cloud.google.com/tpu" rel="noopener ugc nofollow" target="_blank"> TPU 吊舱</a>，旨在实现深度神经网络的快速实验。在这里，我使用 Keras 来实现二进制分类器，将 X 射线图像分类为新冠肺炎感染或正常。</p><h2 id="abf8" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">&gt; →让我们准备好深入研究代码</h2><p id="bd92" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">如果您计划实现这段代码，我假设您已经在工作站中加载了<em class="jd"> Keras </em>和<em class="jd"> Tensorflow </em>安装。→没有？遵循这个快速指南，了解 Anaconda、Jupyter Notebook、TensorFlow 和 Keras 的深度学习，然后马上回来</p><p id="694e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您不想在本地机器上设置环境，另一种方法是使用云服务进行机器学习，比如我在本次演示中使用的<a class="ae mh" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a></p><h2 id="2e27" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">导入库</h2><p id="f9d1" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">第一步是导入下面的库，这将是进一步处理所需要的</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h2 id="cf4a" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">使用 google Colab 安装 google drive</h2><p id="247a" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">通过 google colab 笔记本获取数据的最佳方式是将数据集放在 google drive 上，并安装带有 colab 的驱动器，在运行以下代码后，将要求您提供凭据和访问代码，以放在笔记本控制台上授权访问。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h2 id="1ff6" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">使用 ImageDataGenerator 提取和转换数据</h2><p id="a82b" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">授权后，我们准备从驱动器中获取数据。有很多方法可以做到这一点，但是使用 Keras 的<strong class="ih hj"><em class="jd">imagedata generator</em></strong><em class="jd">库是我最喜欢的方法。其功能<strong class="ih hj"><em class="jd">flow _ from _ directory</em></strong>不仅可以将图像提取到迭代批次中，还可以提供数据扩充，并将基本的<strong class="ih hj">变换</strong>应用到整个图像数据集，即根据您的要求进行重新缩放、重新整形、缩放和翻转，然后将其转换为数字格式，以便直接传递到模型中。</em></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h2 id="087d" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">定义类标签并将 ImageDataGenerator 迭代器分成 X，Y 训练集和测试集</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h2 id="8412" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">在定型模型之前可视化数据集</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mk"><img src="../Images/5735b47ae24b09edb87b0c48102e7409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lxwFOsJBwHSWlAp2Scpabg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><strong class="bd jz">数据集可视化</strong></figcaption></figure><h2 id="99df" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">设置一些要传递到模型中的重要参数</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h2 id="f5e3" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">基于通道的转换</h2><p id="2d30" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">基于数据格式(即 channels_first 或 channels_last)的数据集转换，并将数值数据转换为浮点数</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h1 id="9291" class="jx jy hi bd jz ka ml kc kd ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku bi translated">模型</h1><p id="f0c1" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">一个基于卷积神经网络的模型包含 6 个隐藏层，已经被设计和训练为在转换数据集上编译后以 16 个时期进化。</p><h2 id="6f31" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">层排列</h2><p id="3d27" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">该网络包含 6 层，包括</p><ul class=""><li id="e827" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">2 个 Conv2D 层，将 Relu 作为激活函数，内核大小为(3，3)，32 作为过滤器。</li><li id="dadb" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">1 个最大池 2D 层，池大小为(2，2)。</li><li id="2498" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">1 展平图层，将输入的空间维度折叠为通道维度。</li><li id="e9ed" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">分别具有 Relu 和 softmax 作为激活函数的 2 个密集层</li></ul><h2 id="d671" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">定义和编译模型</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h1 id="7742" class="jx jy hi bd jz ka ml kc kd ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku bi translated">评价/结果</h1><h2 id="707f" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">测试集上的模型拟合与评估</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h2 id="123d" class="lt jy hi bd jz lu lv lw kd lx ly lz kh iq ma mb kl iu mc md kp iy me mf kt mg bi translated">可视化结果(超过 100 名患者的实际类别与预测类别)</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mi mj l"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mq"><img src="../Images/9b791c50a4d6a4ded704210ea29e6f9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*Hz-rEwbKScn_4hRxOevVxA.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">模型评估的损失和准确度图</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mr"><img src="../Images/e8418b2e63f0861eea555a6c8469fcd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*eFLF1sBKGPcHCa9tWgS9Kg.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">10 样本评估结果</figcaption></figure><p id="2f6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 16 个时期之后，在测试集上已经获得了具有 81%准确度的结果，基于神经网络的模型成功地检测到新冠肺炎患者并且将 X 射线图像分类为(新冠肺炎或正常)</p><h1 id="c1c0" class="jx jy hi bd jz ka ml kc kd ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku bi translated">结论</h1><p id="469c" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">一个问题可以有多种解决方案，每个人都可以发挥自己的作用，为社区贡献自己的一份力量。在这篇文章中，我展示了我在基于卷积神经网络的解决方案上的工作，以检测新冠肺炎患者，开发了二进制分类器，该分类器以 X 射线图像作为输入，并以 81%的准确度将其预测输出为新冠肺炎或正常。</p><p id="e699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">页（page 的缩写）S →非常欢迎您通过我的<a class="ae mh" href="https://github.com/sohailhanfi/CovidDetection" rel="noopener ugc nofollow" target="_blank"> github 资源库</a>参与这个项目，或者在评论区分享您的建议/反馈。</p><p id="7064" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">享受你的一天！</em> </strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ms"><img src="../Images/22900d760377d57d338c8a9592c1ac21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNikD7pEmi9jv5pMKl0nOw.png"/></div></div></figure></div></div>    
</body>
</html>