<html>
<head>
<title>How to Create Bar Chart Race using Matplotlib in Python and using Flourish Studio ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python中的Matplotlib和使用fluorescent Studio创建条形图Race？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-create-bar-chart-race-using-matplotlib-in-python-and-using-flourish-studio-46e7bd986d5?source=collection_archive---------11-----------------------#2020-04-14">https://medium.com/analytics-vidhya/how-to-create-bar-chart-race-using-matplotlib-in-python-and-using-flourish-studio-46e7bd986d5?source=collection_archive---------11-----------------------#2020-04-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8bde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Matplotlib是一个开源库</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/048dd50b285c96087c53b5345a0d933d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cl2a7mxqHDsFlthH"/></div></div></figure><p id="2185" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">彼得罗·马蒂亚在<a class="ae jp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p><h2 id="a847" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">条形图比赛现在是趋势可视化的趋势之一，通过使用Matplotlib我们可以创建这个图表，对于非程序繁荣工作室发布的<a class="ae jp" href="https://app.flourish.studio/@flourish/bar-chart-race" rel="noopener ugc nofollow" target="_blank">比赛图表</a>，我将在后面简要介绍。</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/6a752184939b46ad201d8aebb9954475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*hSqXI4ENSyp-I0sWkhXDLg.gif"/></div><figcaption class="km kn et er es ko kp bd b be z dx translated"><strong class="bd js">条形图竞赛</strong></figcaption></figure><p id="0ed5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可从此<a class="ae jp" href="https://drive.google.com/drive/folders/1Yy-b6ZbGnBnL_S_zOQ5xmPL9BdepxJ5D" rel="noopener ugc nofollow" target="_blank">链接</a>导入的各州商品及服务税收入数据</p><p id="3524" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想知道使用Matplotlib在python中创建一个条形图会有多难，但事实证明一点也不难。</p><h1 id="b04f" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">让我们编码</h1><p id="62bb" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">请在您的系统中安装所有相关的库</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="2926" class="jq jr hi ln b fi lr ls l lt lu">import matplotlib.ticker as ticker</span><span id="a23e" class="jq jr hi ln b fi lv ls l lt lu">import matplotlib.animation as animation</span><span id="820b" class="jq jr hi ln b fi lv ls l lt lu">from IPython.display import HTML</span><span id="0a81" class="jq jr hi ln b fi lv ls l lt lu">import matplotlib.pyplot as plt</span><span id="8770" class="jq jr hi ln b fi lv ls l lt lu">import pandas as pd</span></pre><h2 id="8efb" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">导入商品及服务税数据。</h2><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="0cd4" class="jq jr hi ln b fi lr ls l lt lu">df=pd.read_excel(‘xxxxx.xlsx’,sheet_name=’xxxx’)</span><span id="8908" class="jq jr hi ln b fi lv ls l lt lu">df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/5406156f989076cdcb7631f6fe13546d.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/0*osP9pTTFrAy9OcJY"/></div></figure><h1 id="9707" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">数据转换</h1><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="3b4c" class="jq jr hi ln b fi lr ls l lt lu">current_year = 2019</span><span id="7777" class="jq jr hi ln b fi lv ls l lt lu">dff = (df[df[‘year’].eq(current_year)].sort_values(by=’value’, ascending=True))</span><span id="2eab" class="jq jr hi ln b fi lv ls l lt lu">dff</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/e09d350ed877295eb644fad3b379e19a.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/0*k-6mynsPr7xNA_1Y"/></div></figure><h1 id="3792" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">创建基本图表</h1><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="906b" class="jq jr hi ln b fi lr ls l lt lu">fig, ax = plt.subplots(figsize=(15, 8))</span><span id="d014" class="jq jr hi ln b fi lv ls l lt lu">ax.barh(dff[‘name’], dff[‘value’],color=’brown’)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/454cec6a1dc629b22f7fcfa57fa63c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zQ4ifrYqx6SJGd-P"/></div></div></figure><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="8abf" class="jq jr hi ln b fi lr ls l lt lu">fig, ax = plt.subplots(figsize=(15, 8))</span><span id="b54e" class="jq jr hi ln b fi lv ls l lt lu">dff = dff[::-1] # flip values from top to bottom</span><span id="3f71" class="jq jr hi ln b fi lv ls l lt lu"># pass colors values to ‘color=’</span><span id="37c0" class="jq jr hi ln b fi lv ls l lt lu">ax.barh(dff[‘name’],dff[‘value’],color=’brown’)</span><span id="010c" class="jq jr hi ln b fi lv ls l lt lu"># iterate over the values to plot labels and values</span><span id="a322" class="jq jr hi ln b fi lv ls l lt lu">for i, (value, name) in enumerate(zip(dff[‘value’], dff[‘name’])):</span><span id="e49d" class="jq jr hi ln b fi lv ls l lt lu">ax.text(value, i, name, ha=’right’)</span><span id="d7c8" class="jq jr hi ln b fi lv ls l lt lu"># Add year right middle portion of canvas</span><span id="b89a" class="jq jr hi ln b fi lv ls l lt lu">ax.text(1, 0.4, current_year, transform=ax.transAxes, size=40, ha=’right’)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/0a7a98dc30d28083b1e96fbf4c589bb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PMVSTjClwjN-HXJT"/></div></div></figure><p id="2da6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们只剩下图表的美化部分。</p><h1 id="2e66" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">我们将美化以下事物:</h1><ul class=""><li id="c436" class="lz ma hi ih b ii lh im li iq mb iu mc iy md jc me mf mg mh bi translated">更新字体大小和颜色</li><li id="6a89" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">添加标题</li><li id="f504" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">格式:逗号分隔的值和轴标记</li><li id="64b4" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">网格:在横条后添加线条</li></ul><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="9db3" class="jq jr hi ln b fi lr ls l lt lu">fig, ax = plt.subplots(figsize=(15, 8))</span><span id="ffbd" class="jq jr hi ln b fi lv ls l lt lu">def draw_barchart(year):</span><span id="d88d" class="jq jr hi ln b fi lv ls l lt lu">dff = df[df[‘year’].eq(year)].sort_values(by=’value’, ascending=True)</span><span id="b383" class="jq jr hi ln b fi lv ls l lt lu">ax.clear()</span><span id="0648" class="jq jr hi ln b fi lv ls l lt lu">ax.barh(dff[‘name’], dff[‘value’],color=’brown’)</span><span id="55b8" class="jq jr hi ln b fi lv ls l lt lu">dx = dff[‘value’].max() / 200</span><span id="8c34" class="jq jr hi ln b fi lv ls l lt lu">for i, (value, name) in enumerate(zip(dff[‘value’], dff[‘name’])):</span><span id="0d9e" class="jq jr hi ln b fi lv ls l lt lu">ax.text(value-dx, i, name, size=14, weight=600, ha=’right’, va=’bottom’)</span><span id="2c95" class="jq jr hi ln b fi lv ls l lt lu"># … polished styles</span><span id="5284" class="jq jr hi ln b fi lv ls l lt lu">ax.text(1, 0.4, year, transform=ax.transAxes, color=’red’, size=46, ha=’right’, weight=800)</span><span id="5026" class="jq jr hi ln b fi lv ls l lt lu">ax.text(0, 1.06, ‘revenue (cr)’, transform=ax.transAxes, size=12, color=’green’)</span><span id="793b" class="jq jr hi ln b fi lv ls l lt lu">ax.xaxis.set_major_formatter(ticker.StrMethodFormatter(‘{x:,.0f}’))</span><span id="8628" class="jq jr hi ln b fi lv ls l lt lu">ax.xaxis.set_ticks_position(‘top’)</span><span id="adb8" class="jq jr hi ln b fi lv ls l lt lu">ax.tick_params(axis=’x’, colors=’red’, labelsize=12)</span><span id="4eb6" class="jq jr hi ln b fi lv ls l lt lu">ax.set_yticks([])</span><span id="2053" class="jq jr hi ln b fi lv ls l lt lu">ax.margins(0, 0.01)</span><span id="0386" class="jq jr hi ln b fi lv ls l lt lu">ax.grid(which=’major’, axis=’x’, linestyle=’-’)</span><span id="4d40" class="jq jr hi ln b fi lv ls l lt lu">ax.set_axisbelow(True)</span><span id="d6dc" class="jq jr hi ln b fi lv ls l lt lu">ax.text(0, 1.12, ‘Total GST revenue state wise’,</span><span id="0b80" class="jq jr hi ln b fi lv ls l lt lu">transform=ax.transAxes, size=24, weight=600, ha=’left’)</span><span id="9bb4" class="jq jr hi ln b fi lv ls l lt lu">ax.text(1, 0, ‘by<a class="ae jp" href="http://twitter.com/prabhat" rel="noopener ugc nofollow" target="_blank"> @prabhat</a>’, transform=ax.transAxes, ha=’right’,</span><span id="1255" class="jq jr hi ln b fi lv ls l lt lu">color=’blue’, bbox=dict(facecolor=’white’, alpha=0.8, edgecolor=’red’))</span><span id="925e" class="jq jr hi ln b fi lv ls l lt lu">plt.box(False)</span><span id="a6d9" class="jq jr hi ln b fi lv ls l lt lu">draw_barchart(2018)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/2c92df77c676e055694bdfe19e05f8b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sQ50DUxZ7URNh2ya"/></div></div></figure><h1 id="d819" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">动画片</h1><p id="8a6e" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">Matplotlib的动画基类处理动画部分。它提供了一个构建动画功能的框架。有两个主要接口可以实现这一点:</p><p id="35d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jp" href="https://matplotlib.org/api/_as_gen/matplotlib.animation.FuncAnimation.html#matplotlib.animation.FuncAnimation" rel="noopener ugc nofollow" target="_blank"> FuncAnimation </a>通过反复调用函数<em class="mo"> func </em>制作动画。</p><p id="9aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jp" href="https://matplotlib.org/api/_as_gen/matplotlib.animation.ArtistAnimation.html#matplotlib.animation.ArtistAnimation" rel="noopener ugc nofollow" target="_blank"> ArtistAnimation </a>:使用一组固定艺术家对象的动画。</p><p id="9395" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，在这两者中，<strong class="ih hj"> FuncAnimation </strong>是最方便使用的一个。你可以在<a class="ae jp" href="http://matplotlib.sourceforge.net/api/animation_api.html" rel="noopener ugc nofollow" target="_blank">文档</a>中读到更多关于它们的内容，因为我们将只关注FuncAnimation工具。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="1fd8" class="jq jr hi ln b fi lr ls l lt lu">fig, ax = plt.subplots(figsize=(15, 8))</span><span id="83bf" class="jq jr hi ln b fi lv ls l lt lu">animator = animation.FuncAnimation(fig, draw_barchart, frames=range(2017, 2020))</span><span id="3a74" class="jq jr hi ln b fi lv ls l lt lu">HTML(animator.to_jshtml())</span></pre><p id="5eaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是期望的输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/6a752184939b46ad201d8aebb9954475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*hSqXI4ENSyp-I0sWkhXDLg.gif"/></div></figure><h1 id="68cf" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">条形图比赛可以创建使用蓬勃发展，以及，这基本上是为非程序员。</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/72e64a31789251b8020c9ea567539c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i3eZWnit931Fd9La"/></div></div></figure><p id="ec94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Anthony DELANOIX 在<a class="ae jp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p><h1 id="acf0" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">为什么要用花枝招展？</h1><p id="5f11" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">有很多专用软件可用，fluore带有六个预装模板，用于制作交互式地图可视化。您可以在现有模板上上传数据，并轻松创建图表。</p><h1 id="3188" class="kq jr hi bd js kr ks kt jw ku kv kw ka kx ky kz kd la lb lc kg ld le lf kj lg bi translated">丰富的酒吧比赛特色</h1><ul class=""><li id="b1a2" class="lz ma hi ih b ii lh im li iq mb iu mc iy md jc me mf mg mh bi translated">设置字体和颜色</li><li id="c114" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">图像:圆形或矩形</li><li id="c7b1" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">交互式过滤器</li><li id="a105" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">按最大或最小条形排序</li><li id="7c34" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">显示累加器</li><li id="b329" class="lz ma hi ih b ii mi im mj iq mk iu ml iy mm jc me mf mg mh bi translated">完全移动友好</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/34eb36d7b625f170824ba87598050856.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*0FilhlV4jQ9f50Thn71rmQ.gif"/></div></figure><p id="c5cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p><p id="2403" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Python是一种非常强大的编程语言，因为它有很多库，其中之一就是可视化的Matplotlib。尽管创建一个更加定制化的图表会非常耗时和复杂，但是在python中一切皆有可能。另一方面，Flourish是一个用户友好的数据可视化平台，用于创建强大的交互式数据故事。</p><p id="ea5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这篇文章能帮助你并节省大量的时间。</p><p id="6b47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐编码。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a6e5d272e00d0452278e944138381a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9iLEkSDhr2N5SA48"/></div></div></figure><p id="d6bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">照片由<a class="ae jp" href="https://unsplash.com/@phammi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米PHAM </a>在<a class="ae jp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></div></div>    
</body>
</html>