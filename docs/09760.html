<html>
<head>
<title>Create a Quiz Application for Windows using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python为Windows创建一个测验应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-a-quiz-application-for-windows-using-python-df7c14a5230d?source=collection_archive---------11-----------------------#2020-09-19">https://medium.com/analytics-vidhya/create-a-quiz-application-for-windows-using-python-df7c14a5230d?source=collection_archive---------11-----------------------#2020-09-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/cf17b5c5674d853bd4c080751f621af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AleJLgsPQ0j_WHko"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae iu" href="https://unsplash.com/@azhar93?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Azharul Islam </a>拍摄</figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h2 id="68a6" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">介绍</h2><p id="7dbf" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">大家好！欢迎学习使用Python创建/构建Windows GUI应用程序的分步指南。我想从告诉你我为什么决定写这篇文章开始。</p><p id="5a85" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">我的德语相当流利，我的女朋友总是不停地抱怨我，不帮助她学习德语。所以，我开始教她德语，并给了她一份PDF文档，让她试着记忆一些词汇。这对她来说是“无聊”的，她也不觉得这是一种学习新事物的令人兴奋的方式。我知道那里有更好的应用程序来学习德语，但因为她抱怨我没有帮助她，我决定为她建立一个测试应用程序，认为她会喜欢它并变得更好。</p><p id="5ccb" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">该应用程序包含基本的选择题。用户可以输入他们的名字，并选择问题是否显示英语单词，他们可以选择一个德语单词，反之亦然。他们可以选择他们想回答的问题的数量。最后五个分数也会显示出来。该图显示了应用程序的主窗口以及问答窗口。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/17a3be45c4e52b211e688fd5b1c73c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J3KLENm49J22c5ogeXWw_A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">第一眼</figcaption></figure><p id="2e59" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">正如你所看到的，如果有人不确定，他们可以检查所有显示的选项的含义，选择，并移动到下一个问题或退出游戏。只有在您完成测验后，分数才会被跟踪并添加到您的显示屏上。您可以使用底部的<em class="lf">重置</em>按钮重置您的分数。如果你想学习，按下<em class="lf">学习</em>按钮打开一个包含词汇的PDF。<em class="lf">(免责声明:vocab并非100%正确。大多数使用这些单词的文章都是不正确的，因为我是在大约3-4年前从互联网上随机收集词汇的。)</em></p><h2 id="b492" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">先决条件</h2><p id="b984" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated"><strong class="kc hj">知识:</strong>我假设你知道<em class="lf"> python(使用类、库如pandas、Tkinter、pillow (PIL)等。)</em>。完整的代码可以在这篇文章的结尾找到。解释每一行代码超出了本文的范围。</p><p id="2753" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated"><strong class="kc hj">软件:</strong>装了熊猫和枕头的Python。</p><h2 id="4cf7" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">那么，我们开始吧。</h2><p id="ac3c" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">我将代码分成两个不同的类:一个我命名为<em class="lf">generated data</em>，另一个命名为<em class="lf"> QuizIt </em>。顾名思义，我使用<em class="lf">generated data</em>来生成列表:一个包含问题，第二个包含他们的个人选择(选项)，最后一个包含他们的答案。整个GUI部分都是用<em class="lf"> QuizIt编写的。我将首先解释我如何生成数据，然后转到GUI。</em></p><p id="e40e" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated"><strong class="kc hj"><em class="lf">generated data</em></strong>:下面，你可以找到代码来生成不同的列表传递给测验。该类将数据框架(df)、问题数量(num_ques)和形式(为给定的英语单词选择一个德语单词，反之亦然)作为输入。词汇表是从包含两列(德语和英语)的Excel文件中提取的。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="00cf" class="jc jd hi lh b fi ll lm l ln lo">import random<br/>class GenerateData:<br/>    def __init__(self, df, num_ques, form):<br/>        self.df = df<br/>        self.num_ques = num_ques<br/>        self.form = form</span></pre><p id="595a" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">下面的方法生成一个英语的问题字符串，4个德语的选项，以及正确的答案并返回它们。它首先从数据帧中选择一个随机整数索引。然后，它从数据框中随机选择3种可能性和一个正确答案，然后对它们进行洗牌，这样解决方案就不会总是以<em class="lf">选项A、</em>结束。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="0c79" class="jc jd hi lh b fi ll lm l ln lo">def generate_eng2ger(self):<br/>    question = []<br/>    data_len = len(self.df)+1<br/>    n = random.randint(0, data_len)<br/>    lst = []<br/>    options = []<br/>    for i in range(3):<br/>        no = random.randint(0, data_len)<br/>        lst.append(no)<br/>    lst.append(n)<br/>    lst = random.sample(lst, len(lst))<br/>    <br/>    ### Creating the question<br/>    question.append(f'Select a german word for "{self.df.iloc[n, 1]}":')<br/>    <br/>    ### Creating options/choices<br/>    for l in lst:<br/>        options.append(f'{self.df.iloc[l, 0]}')</span><span id="0408" class="jc jd hi lh b fi lp lm l ln lo">### Allocating the answer<br/>    answer = self.df.iloc[n, 0]<br/>    return question, options, answer</span></pre><p id="92aa" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">另一种方法做同样的事情，但是用德语返回问题，用英语返回选项和答案。</p><p id="6ddc" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">类中的最后一个方法考虑要生成的问题数量(在__init__中指定)。例如，如果用户选择25个问题，该方法将以三个列表的形式分别返回25个问题的列表、它们的选择(选项)以及它们的正确答案。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="9113" class="jc jd hi lh b fi ll lm l ln lo">def collection(self):<br/>    """<br/>   Generates a collection of questions, respective multiple-choices     and answers for German to English.<br/>    Returns:<br/>    questions, options, answers (in that order)<br/>     """<br/>    questions = []<br/>    choice_list = []<br/>    answers = []</span><span id="c293" class="jc jd hi lh b fi lp lm l ln lo">if self.form=='The correct German word':<br/>        for i in range(self.num_ques):<br/>            question, options, answer = self.generate_eng2ger()<br/>            questions.append(question)<br/>            choice_list.append(options)<br/>            answers.append(answer)<br/>    else:<br/>        for i in range(self.num_ques):<br/>            question, options, answer = self.generate_ger2eng()<br/>            questions.append(question)<br/>            choice_list.append(options)<br/>            answers.append(answer)<br/>    return questions, choice_list, answers</span></pre><p id="f941" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated"><strong class="kc hj"> <em class="lf"> QuizIt </em> </strong>:这个类创建GUI。这个类有300多行代码，因此我不会完全解释它。该类导入以下模块:</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="83f0" class="jc jd hi lh b fi ll lm l ln lo"># Imports<br/>import os<br/>import pickle<br/>import PIL<br/>from PIL import ImageTk<br/>import pandas as pd<br/>from datetime import datetime<br/>from dataprep import GenerateData<br/>from tkinter import *<br/>from tkinter import messagebox</span></pre><p id="2a38" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">如前所述，Excel文件用于生成测验数据。下面几行代码显示了数据的少量预处理。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="f732" class="jc jd hi lh b fi ll lm l ln lo">### Preparing the dataframe<br/>df = pd.read_excel('vocab_reduced.xlsm')    # Reading the vocab from an Excel file<br/>df.dropna(inplace=True)     # Droping NaN (empty cells/values)<br/>df.drop_duplicates(subset=['German', 'English'], keep='last', inplace=True)     # Dropping words if they repeat<br/>df.reset_index(inplace=True, drop=True)</span></pre><p id="0894" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">代码太长，无法粘贴到此处。这里可以找到<a class="ae iu" href="https://github.com/vkyprmr/medium/tree/master/quizIt" rel="noopener ugc nofollow" target="_blank"><strong class="kc hj"><em class="lf"/></strong></a><strong class="kc hj"><em class="lf"/></strong>以及所使用的词汇和图标。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="3f41" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">转换成。并为分发创建一个设置。</p><p id="d868" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">我使用<em class="lf"> auto-py-to-exe </em>作为我的goto来将python脚本转换成windows可执行文件。如果你已经安装了它，你知道如何使用它。如果没有，您可以使用以下方式安装:</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="7fb6" class="jc jd hi lh b fi ll lm l ln lo">pip install auto-py-to-exe</span></pre><p id="f53d" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">一旦你有了它，你需要做的就是提供脚本的路径，添加一个图标(如果你想的话)，命名，改变输出路径到你的附加文件所在的目录(例如，在我的例子中，我有一个pdf，excel和png文件作为附加文件，所以我在<em class="lf">附加文件</em>部分指定了它)，如果它适用于你，查看任何其他设置。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/ca731014de743ca95aad5228eb502468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZafz8aF_1zKZE8QAgxUFQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">转换中。PY to。可执行程序的扩展名</figcaption></figure><p id="bae0" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated"><strong class="kc hj"> <em class="lf">注:</em> </strong> <em class="lf">本。exe文件应该放在与您的图像或附加文件相同的文件夹中。</em></p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/454847d56fd6ffef31ff88cd518c49a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fWDlpRh5C0nAdKSl9JUqig.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">。EXE已创建</figcaption></figure><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/b46fbf2758561df8284c06903647569e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*gpF5ZTkNE7TsV5TcBA-5Hw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">创建压缩的zip文件夹</figcaption></figure><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/3a09923a4696318a5a8ed6d8d806af9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIHbBAeKkBWIUzma1MdgNQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">#1选择安装程序的依据。zip文件— #2给出ZIP文件—如您在左下角所见，设置文件已生成</figcaption></figure><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/fb64f10eb08287428a8110d735a654ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KILFkhuMoJD1zdnIzh4ZoQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">安装就像一个正常的安装过程，然后用户可以使用EXE文件启动应用程序</figcaption></figure><p id="5685" class="pw-post-body-paragraph ka kb hi kc b kd kv kf kg kh kw kj kk jn kx km kn jr ky kp kq jv kz ks kt ku hb bi translated">现在你可以运行这个了。无需安装或配置Python。为了更容易地将您的应用程序分发或发送给某人，您可以创建一个设置。为此，你需要在你的电脑上安装NSIS。从<a class="ae iu" href="https://nsis.sourceforge.io/Download" rel="noopener ugc nofollow" target="_blank"> <em class="lf">到这里</em> </a>都可以。然后创建一个压缩的zip文件夹。exe)并且所有数据文件都是。只需在windows搜索栏中搜索即可打开NSIS软件。看下图。给你。现在你可以把这个安装文件发送给任何你想要的人，他们将能够运行这个应用程序，而不需要安装Python或任何库。</p></div></div>    
</body>
</html>