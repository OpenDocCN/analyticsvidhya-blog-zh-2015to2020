<html>
<head>
<title>The art of transfer learning (Part-I)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移学习的艺术(上)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-art-of-transfer-learning-e6aea8fc0b8c?source=collection_archive---------25-----------------------#2020-08-25">https://medium.com/analytics-vidhya/the-art-of-transfer-learning-e6aea8fc0b8c?source=collection_archive---------25-----------------------#2020-08-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/16ce7a291c5fcf5dedb32d51bbe3c608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M5fcr_taGKSlhJIX0x8AZA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:由<a class="ae iu" href="https://unsplash.com/images/nature/sunset?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae iu" href="https://unsplash.com/@recalmedia?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Recal Media </a></figcaption></figure><p id="2c01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗨，朋友们，今天在这篇博文中，我将向你们概述迁移学习的概念。这个博客分为两部分，在这一部分，我将尝试解释不同类型的迁移学习技术的理论概念，以及如何存储和使用特征向量来制作一个相当准确的图像分类器。</p><p id="1abc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完成本博客后，您将能够:</p><ul class=""><li id="f52b" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">了解当应用于计算机视觉的深度学习时，有哪些不同类型的迁移学习。</li><li id="830a" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">从预先训练的CNN中提取特征。</li><li id="647c" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">对HDF5数据格式的基本理解。</li></ul><p id="8d0b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1。什么是迁移学习:</strong></p><blockquote class="kh ki kj"><p id="4a35" class="iv iw kk ix b iy iz ja jb jc jd je jf kl jh ji jj km jl jm jn kn jp jq jr js hb bi translated"><strong class="ix hj">迁移学习(TL) </strong>是<a class="ae iu" href="https://en.wikipedia.org/wiki/Machine_learning" rel="noopener ugc nofollow" target="_blank">机器学习</a> (ML)中的一个研究问题，它专注于存储在解决一个问题时获得的知识，并将其应用于另一个不同但相关的问题。</p></blockquote><p id="4ded" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来源:<a class="ae iu" href="https://en.wikipedia.org/wiki/Transfer_learning#Definition" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Transfer_learning#Definition</a></p><p id="17a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个标准的定义，让我进一步简化一下。我们可以把迁移学习想象成使用预先训练好的模型作为从最初没有训练过的数据中学习模式的捷径的能力。仍然不清楚让我们举一个标准机器学习问题的例子，其中我们给出了两个分类问题:</p><p id="8fb1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1:我们的首要任务是训练一个能够在摩托车和自行车之间进行分类的CNN(卷积神经网络)。</p><p id="12eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2:第二个任务是对轿车、SUV和跑车等3类汽车进行分类</p><p id="2c5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，使用机器学习、神经网络和深度学习中的标准实践，我们会将这视为两个独立的问题。首先，我们将在自行车和摩托车标签上收集足够的数据，然后在数据集上训练模型。第二个任务遵循类似的过程，只是这一次，收集不同汽车类别的图像，然后在标记的汽车数据集上训练模型。</p><blockquote class="kh ki kj"><p id="9230" class="iv iw kk ix b iy iz ja jb jc jd je jf kl jh ji jj km jl jm jn kn jp jq jr js hb bi translated">现在，迁移学习提出了一种不同的训练范式:-如果我们可以使用现有的预训练分类器，并将其用作新分类任务的起点，会怎么样？</p></blockquote><p id="02cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上述挑战的背景下，我们将首先训练CNN对自行车和摩托车进行分类。然后，我们将使用同样的CNN训练过的自行车和摩托车数据来区分汽车类别，</p><blockquote class="kh ki kj"><p id="667a" class="iv iw kk ix b iy iz ja jb jc jd je jf kl jh ji jj km jl jm jn kn jp jq jr js hb bi translated">即使汽车数据没有与自行车和摩托车数据混合。</p></blockquote><p id="8632" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这有多异想天开？</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/89267395f602c3ab7d742b0d2ea0d30e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*hqo3ynog8U-hJ230tV2x3A.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:谷歌gif的</figcaption></figure><p id="960e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，上述方法听起来很有希望成为现实，但不幸的是，这并不是因为这种类型的迁移学习只对真正深度的神经网络有好处，并且是在大规模数据集上训练的，如<a class="ae iu" href="http://www.image-net.org/" rel="noopener ugc nofollow" target="_blank"> Image-net </a>数据集。这些网络在迁移学习任务方面表现出色，因为这些网络学习一组丰富的、有区别的特征来识别1000个单独的对象类别。这些过滤器可以被<em class="kk">重用</em>用于分类任务，而不是CNN最初训练的内容，这是有道理的。</p><p id="321b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一般来说，当应用于计算机视觉的深度学习时，有两种类型的迁移学习:</p><p id="dbe4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="kk"> 1。将网络视为任意特征提取器。</em>T9】</strong></p><p id="8d25" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.<strong class="ix hj">T13】</strong></p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/ca006cb5da6dfd22e4359bb24b4d441a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEvjYneMPfSwQE8aQIZapg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">描述迁移学习的第二种技术<a class="ae iu" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.slideshare.net%2FPyData%2Fpy-datasf&amp;psig=AOvVaw2_K1d5BetTs_l3Q5bDWAvd&amp;ust=1598595545340000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCKi_-9PcuusCFQAAAAAdAAAAABAP" rel="noopener ugc nofollow" target="_blank">的图像</a>。</figcaption></figure><p id="7671" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇博客中，我们将主要关注迁移学习的第一种方法，将网络视为特征提取器。</p><p id="0b12" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2。从预先训练的CNN中提取特征:</strong></p><p id="d2ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们总是将CNN视为端到端的图像分类器，如下所示:</p><p id="1983" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.我们将图像输入网络。</p><p id="133e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.图像通过网络向前传播。</p><p id="0fca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.我们从网络的末端获得最终的分类概率。</p><p id="b0fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，并没有严格的规则来遵循上述步骤并总是通过整个网络传播图像。相反，我们可以在网络的任意部分停止传播，例如激活层或汇集层，此时从网络中提取值，并将其用作特征向量。通过这个例子，我们可以更好地理解它</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/cc48a0eb0e178c5a8227da574be33fc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*Wcj2h0QKKByG7w9HSprqmg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">作为特征提取器的VGG16网络架构</figcaption></figure><p id="47f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个标准的<a class="ae iu" href="https://neurohive.io/en/popular-networks/vgg16/" rel="noopener ugc nofollow" target="_blank"> VGG16 </a>架构，或者可以被视为基于Imagenet数据集的标准预训练模型。图像的左侧是原始的VGG16网络架构，它输出1000个ImageNet类标签中每个标签的概率，图像的右侧描绘了网络结构，其中最终的全连接层从VGG16中移除，而不是返回最终的<a class="ae iu" href="https://machinelearningmastery.com/pooling-layers-for-convolutional-neural-networks/" rel="noopener ugc nofollow" target="_blank">池</a>层的输出。这个输出将作为我们提取的特征。除了网络中的层之外，我们还包括了每个层的体积的输入和输出形状。在这种将网络视为特征提取器的方法中，我们基本上尝试在任意点“切割”网络，通常在完全连接的层之前完成，但这实际上取决于数据集和用例。</p><p id="0612" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2.1了解流程:</strong></p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/f5278f61fe1a2ce3c3e240f62e7a355a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5z0Pv4aYLbGxJ1CE_KX1A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">具有过滤器和池层计算的VGG16网络架构。</figcaption></figure><p id="a7b2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面图像的右侧，最后一层是max-pooling层，假设有512个大小为7 x 7的过滤器，其输出形状将为7 x 7 x 512。如果在移除FC层的情况下通过网络向前传播映像，我们将剩下512，7 x 7个激活，这些激活基于映像内容而激活或不激活。因此，我们实际上可以将这些7 x 7 x 512 = 25，088个值作为量化图像内容的特征向量。现在，如果我们对整个图像数据集(包括VGG16最初未被训练的数据集)重复这一过程，我们将获得N个图像的设计矩阵，每个图像具有25，088列，用于量化它们的内容(即特征向量)。因此，通过使用这些特征向量，我们可以在该特征的基础上训练任何机器学习模型，如线性SVM、逻辑回归分类器或随机森林，以获得识别图像新类别的分类器。CNN本身不能识别这些新的类别，相反我们把它作为一个中间的特征提取器。底层的ML模型将负责从CNN提取的特征中学习模式，但是通过应用迁移学习，我们能够毫不费力地构建<em class="kk">超精确图像分类器</em>。诀窍是<em class="kk">提取</em>这些特征并以有效的方式存储它们。为了完成这项任务，我们需要HDF5。</p><p id="1c52" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2.1.1什么是HDF5？</strong></p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/bb4656f6f0ce11b732bf32b01d2b073c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*2FccKf7dhqI5xzfz8yHLew.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae iu" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fgiphy.com%2Fgifs%2Fgotham-fox-3o7qDP28LG5LrVYfde&amp;psig=AOvVaw2fpN_mp2AN3EMZAM54LGVL&amp;ust=1598601729626000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCLjAh9nzuusCFQAAAAAdAAAAABAW" rel="noopener ugc nofollow" target="_blank">谷歌gifs </a></figcaption></figure><p id="116b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">分层数据格式版本5 (HDF5)是一种支持大型、复杂、异构数据的开源文件格式。HDF5使用类似“文件目录”的结构，允许您以多种不同的结构化方式组织文件中的数据，就像您在计算机上处理文件一样。在HDF5中，我们在计算机上称之为“目录”或“文件夹”的称为“组”，在计算机上称之为“文件”的称为“数据集”。HDF5中有两个重要术语，它们是:</p><ul class=""><li id="95e6" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated"><strong class="ix hj">组:</strong>HD F5文件中的文件夹状元素，其中可能包含其他组或数据集。</li><li id="9de8" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">数据集:</strong>包含在HDF5文件中的实际数据。数据集通常(但不是必须)存储在文件的组中。</li></ul><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/9fee1f7c819e9c15e31d422c1e1adf25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9p5C9Y-Ekhx9zsU__NQHCg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="kx">包含组、数据集和相关元数据的示例HDF5文件结构。</em></figcaption></figure><p id="934d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kk">数据集</em>可以被认为是同构数据类型(整数、浮点、Unicode等)的多维数组(即NumPy数组)。).HDF5是用C写的；然而，通过使用h5py模块(<a class="ae iu" href="http://www.h5py.org/" rel="noopener ugc nofollow" target="_blank">h5py.org</a>)，我们可以使用Python编程语言访问底层的C API。h5py之所以如此牛逼，是因为它与数据交互的便捷性。我们可以在我们的HDF5数据集中存储<em class="kk">大量的</em>数据，并以类似NumPy的方式操作这些数据。例如，我们可以使用标准Python语法来访问和切片存储在磁盘上的<em class="kk">多TB数据集</em>中的行，就好像它们是加载到内存中的简单NumPy数组一样。由于专门的数据结构，这些切片和行访问变得很快。将HDF5与h5py配合使用时，您可以将您的数据想象成一个巨大的NumPy数组，它太大而无法放入主内存，但仍然可以访问和操作。也许最好的是，HDF5格式是标准化的，这意味着以HDF5格式存储的数据集具有内在的可移植性，可以由使用不同编程语言(如C、MATLAB和Java)的其他开发人员访问。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="3995" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">非常感谢朋友们阅读这篇文章，在下一篇即将发表的博客文章中，我将试着写一篇自定义的Keras和python代码，并给你们演示一下，这些代码能够接受输入数据并使用迁移学习。我们将使用预先训练的CNN模型，如VGG16、Resnet、Alexnet等作为特征提取器，并以HDF5文件格式存储各自的特征。使用得到的特征向量，我们将尝试建立一个很棒的图像分类器，所以请保持关注。T3】</p><p id="2447" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">参考文献:</strong></p><p id="6267" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://en.wikipedia.org/wiki/Transfer_learning#Definition" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Transfer_learning</a></p><p id="7da9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.pyimagesearch.com/2019/05/20/transfer-learning-with-keras-and-deep-learning/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2019/05/20/transfer-learning-with-keras-and-deep-learning/</a></p><div class="lf lg ez fb lh li"><a href="http://www.image-net.org/" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab dw"><div class="lk ab ll cl cj lm"><h2 class="bd hj fi z dy ln ea eb lo ed ef hh bi translated">ImageNet</h2><div class="lp l"><h3 class="bd b fi z dy ln ea eb lo ed ef dx translated">ImageNet是一个根据WordNet层次结构(目前只有名词)组织的图像数据库，其中每个…</h3></div><div class="lq l"><p class="bd b fp z dy ln ea eb lo ed ef dx translated">www.image-net.org</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw io li"/></div></div></a></div><div class="lf lg ez fb lh li"><a href="https://neurohive.io/en/popular-networks/vgg16/" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab dw"><div class="lk ab ll cl cj lm"><h2 class="bd hj fi z dy ln ea eb lo ed ef hh bi translated">VGG16 -用于分类和检测的卷积网络</h2><div class="lp l"><h3 class="bd b fi z dy ln ea eb lo ed ef dx translated">VGG16是由英国牛津大学的K. Simonyan和A. Zisserman提出的卷积神经网络模型。</h3></div><div class="lq l"><p class="bd b fp z dy ln ea eb lo ed ef dx translated">神经蜂巢. io</p></div></div><div class="lr l"><div class="lx l lt lu lv lr lw io li"/></div></div></a></div><p id="5dde" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.neonscience.org/about-hdf5#:~:text=The%20Hierarchical%20Data%20Format%20version,with%20files%20on%20your%20computer." rel="noopener ugc nofollow" target="_blank">https://www . neon science . org/about-HD F5 #:~:text = The % 20 hierarchical % 20 data % 20 format % 20 version，with % 20 files % 20 on % 20 your % 20 computer。</a></p></div></div>    
</body>
</html>