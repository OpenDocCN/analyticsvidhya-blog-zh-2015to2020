<html>
<head>
<title>Predicting Vehicle Mileage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测车辆里程</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-vehicle-mileage-5e22a0933514?source=collection_archive---------2-----------------------#2019-10-07">https://medium.com/analytics-vidhya/predicting-vehicle-mileage-5e22a0933514?source=collection_archive---------2-----------------------#2019-10-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="9d9c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用pandas、seaborn和scikit-learn的数据科学项目</h2></div><p id="64cb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从小我就一直对汽车行业感兴趣。我过去常常翻阅模型统计数据，从头到尾阅读汽车杂志。在这个项目中，我将这种热情应用于一个具有重大现实世界适用性的数据分析项目。</p><p id="71fa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我使用的特定数据集由398种独特车辆的规格组成，这些规格由伦敦大学学院编制，可在Kaggle上免费获得。每个条目都包含独特的信息，如气缸、马力、加速度等。最重要的是，每辆车都包含一个mpg数字形式的标签。这是我希望分析并最终预测的具体指标。</p><p id="3b6e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了开始数据分析，我首先导入了。csv文件转换成一个谷歌Colab笔记本电脑使用熊猫，以便将其转换成一个数据框。以下是初步的观察:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/8a2d381c3e4bb87b26f46767e6139219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YcsHwFRxR6xqpQPddX_0Sw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">数据概述</figcaption></figure><p id="4b36" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">似乎有七个独特的数量变量和一个分类变量。第一栏(不考虑指数)是最重要的mpg数据。这些特性中的大多数似乎都是不言自明的。唯一不明确的列是origin。这到底是什么意思？嗯，快速浏览Kaggle论坛可以发现，标签1、2和3分别与美国、欧洲和亚洲相关联。在充分理解数据特征之后，第一步是数据清理。我首先检查数据是否包含任何空值。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kj"><img src="../Images/3cd16a893de696769a1a33a8e54dd989.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*zLUosDJKjZjoIyige49r4w.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">空值计数</figcaption></figure><p id="a607" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完美！似乎我中了头彩:一个没有空值的数据集。让我们试着做一些进一步的操作。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/e2995fab9d22f9191438db4e3f303bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9vkG5yOXWHYUWDw7"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">试图操纵数据</figcaption></figure><p id="da36" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是什么？马力列似乎是由对象类型而不是整数组成的。更令人担忧的是，数据集的创建者似乎使用了问号(“？)而不是空值，以便表示未知值。幸运的是，快速检查表明只有6行有这个问题，所以我们可以继续删除它们，以便继续我们的数据分析。</p><p id="df08" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我希望通过取数量特征的平均值来获得数据的整体表示。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kl"><img src="../Images/604e5e44c0b0bd5d8bd21b0857e0dc48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kxSN5L20VJMGJACe4zBmg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">数量特征的平均值</figcaption></figure><p id="89a9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有意思。平均车型年份是1975年，考虑到该数据集是在1983年编制的，这是合理的。平均里程也是非常可观的(当时)23.45英里/加仑。我对提取数据集中表示的特定品牌感兴趣，这对于seaborn可视化来说是完美的。</p><div class="ju jv jw jx fd ab cb"><figure class="km jy kn ko kp kq kr paragraph-image"><img src="../Images/c0773ff43f8e229e8f054ff2865a81b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*v6BSNfLHEbtQfSuRECIEhA.png"/></figure><figure class="km jy ks ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><img src="../Images/3a22f0d093df920e241d17aed2a5897f.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/0*qkzgXQyIMHjfuMIa"/></div><figcaption class="kf kg et er es kh ki bd b be z dx kt di ku kv translated">汽车制造商分布</figcaption></figure></div><p id="23d1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个数据集似乎明显偏向国内制造商，最受欢迎的是福特和雪佛兰。接下来，我深入研究了seaborn强大的可视化库。例如，它能够比较两个特定的分类变量，如马力和排量。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kw"><img src="../Images/3a2e5ffc2aceebcf3caa0314f0cd56af.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*jYE4V8vaEcZYWG_-8TYFdg.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">马力与排量</figcaption></figure><p id="56a7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">联合阴谋告诉我们两件截然不同的事情。首先，马力和排量正相关。置换是无可替代的。第二，似乎有大量大约50-100马力和50-150排量的汽车。让我们继续深入，seaborn可以展示甚至更复杂的多变量关系。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kx"><img src="../Images/d012976922003741ad9b8d187b4e64f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mnwP96R8KWgT70rCP7GyQ.png"/></div></div></figure><p id="4787" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的散点图中，mpg是相对于马力绘制的。此外，重量较大的汽车用较深的颜色表示，而气缸数量较大的汽车用较大的圆圈表示。该图展示了一些有趣的趋势。一般来说，随着马力、重量和气缸数量的增加，它们的mpg以类似指数衰减的趋势增加。</p><p id="995a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着这些数据可视化的方式，我想过渡到使用机器学习算法预测mpg。认识到我想预测mpg是至关重要的，mpg是一个连续的数值变量。因此，像逻辑回归或分类器这样的东西并不合适，因为它们都有离散的输出。我最初的直觉是实现多元线性回归，这将很好地工作，因为我们有许多分类特征。</p><p id="c3d2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我的机器学习实现完全是通过Python的sci-kit学习库进行的。第一个重要步骤是将数据集分成训练和测试数据。回归将根据训练数据优化和微调其参数。然后，将根据以前从未见过的测试数据来评估It性能。幸运的是，sci-kit的train-test-split自动化了这个过程。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ky"><img src="../Images/a50ae7fd6b9caddb805dacfdeed96a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ssgKrf3BmD8_stM4u0nmxw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">训练-测试-拆分</figcaption></figure><p id="3fab" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这行代码中有几个重要的事情需要注意。首先，我需要删除数据集的“mpg”、“car name”和“make”特性，以生成X_train数据集(训练阶段的输入)。这是因为“mpg”是标签本身，而后两个特征是分类的而不是定量的。接下来，我指定了0.3的测试大小，这意味着70%的数据用于训练，30%用于测试。最后，随机状态被设置为42。这一点至关重要，因为众所周知，42是生命、宇宙和一切终极问题的答案。</p><p id="06ad" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我实例化了模型，使用了。拟合函数对其进行训练，并将其应用于测试数据。有几种方法可以评估这个模型，但是我从两个可视化开始。</p><div class="ju jv jw jx fd ab cb"><figure class="km jy kz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><img src="../Images/2af7b6af3d9512cd7efc2e21c04614a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*ZEWGwJzl3AQoytV6iiQ27A.png"/></div></figure><figure class="km jy la ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><img src="../Images/79be02c9c0a8839f5a877d2b013a316b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*OVqcX97ctmCu-eq-CvGuNQ.png"/></div></figure></div><p id="fe30" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一个散点图展示了预测mpg值与实际mpg值的对比。理想情况下，如果预测是完美的，这将只是一条y = x线。尽管事实并非如此，但令人欣慰的是，至少有一条线看起来接近于此。第二个数字是残差的分布。根据统计理论，有效模型的残差应该是正态分布的，这种趋势可以在图表中看到。</p><p id="e332" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，有几个量化指标可用于描述模型的特征。这些包括r、平均绝对误差、均方误差和均方根误差。所有这些都包含在scikit-learn的度量库中。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lb"><img src="../Images/e1569b5be3c0e104ec9a231079e69186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gfZPwJxShpEFVAI2"/></div></div></figure><p id="f469" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该模型尊敬RMSE为3.17，r为0.81；然而，我渴望一个更好的模型。我决定使用多层感知器回归器，这是一个输出连续值的简单神经网络模型。我再次经历了同样的过程，将数据分成训练和测试数据集。然而，与线性回归相比，我必须采取两个关键的额外步骤。首先，我将数据标准化，使所有的定量变量都在相同的范围或数值范围内。这也是MLP敏感的一个因素。</p><p id="7e0f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第二，MLP回归器提供了更多的模型参数来修改。而不是随机地输入不同的选项，例如学习速率、迭代次数、隐藏层数等。，我决定实现一种叫做网格搜索的技术，这种技术可以自动输出一组指定参数值的最佳组合，这组参数值称为参数空间。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/ff48e2f96b789b29ad1884604aa625af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nxN6ld2o0WFXY360"/></div></div></figure><p id="3b6b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">运行了一段时间后，网格搜索最终找到了三个参数的最佳组合:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lc"><img src="../Images/9769baddc284811b8b5741cfa8066e2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gPVOC5k4vDhy-QQU"/></div></div></figure><p id="31a9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我能够使用这个优化的回归预测mpg，并分析模型的预测能力。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ld"><img src="../Images/fa6d2055c4addfc2c0a5570f7009cf4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cNtqVVhXISPG-9HV"/></div></div></figure><p id="78ed" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不出所料，这个具有微调超参数的更复杂的模型具有明显更高的r值(几乎为0.87)和更低的RMSE。总的来说，我对结果相当满意，尤其是考虑到原始数据集是如此之小。</p><p id="1dfa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在未来，这些模型的准确性可以通过进一步的特征工程来提高。例如，我可以创建一个额外的列，使用马力和重量数据来创建功率重量比功能。此外，我可以扩展网格搜索参数空间，以包含默认MLP回归器实现中包含的更多超级参数。最后，如果我使用一个更强大的库，如Tensor Flow，作为机器学习后端，我会很兴奋地看到我的预测如何公平。</p></div></div>    
</body>
</html>