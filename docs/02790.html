<html>
<head>
<title>Image Classification Using the Variational Autoencoder</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用变分自动编码器的图像分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/activity-detection-using-the-variational-autoencoder-d2b017da1a88?source=collection_archive---------9-----------------------#2020-01-02">https://medium.com/analytics-vidhya/activity-detection-using-the-variational-autoencoder-d2b017da1a88?source=collection_archive---------9-----------------------#2020-01-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9791010e17fb32a60b9178932066e0e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IJyxNl7ycrg4V90sp2tLAw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">前超级鹰队(尼日利亚足球队)教练斯蒂芬·凯希(来源:半岛电视台)</figcaption></figure><p id="7a70" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这个项目的代码可以在<a class="ae js" href="https://github.com/samsonafo/Activity-Detection-using-Variational-Autoencoders" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><p id="14a6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用神经网络的传统图像识别需要图像标记。图像标注可能是一项单调乏味或者更昂贵的工作。想象一下，运营一家拥有大型图像数据集的公司，每次我们需要为特定图像类型构建图像识别算法时，我们都需要将图像标记为<strong class="iw hj">【实例】</strong>和<strong class="iw hj">【非实例】</strong>。例如，“猫”和“不是猫”或“狗”和“不是狗”。问题是有很多种<strong class="iw hj">‘非实例’。</strong>例如，为了建立一个猫的图像标识符，我们将所有的猫标记为<strong class="iw hj">猫</strong>以及狗、山羊、汽车、人类、飞机等。好像<strong class="iw hj">不是猫。</strong>如果我们想要用相同的数据集构建一个人类图像标识符，那么我们必须将所有的人类图像标记为<strong class="iw hj">人类</strong>而将所有其他图像标记为<strong class="iw hj">非人类。</strong></p><p id="a3b5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这显然既费时又费钱。于是问题就来了——我们能不能建立一个图像识别器，而不必经过严格的图像识别？或者更好地说，我们是否可以建立一个神经网络，可以学习图像来自哪里的具体分布？除了图像识别之外，这种思想可以用于根据图像的分布来分离图像。比如把不道德的图像从视频中分离出来，或者把广告从视频中分离出来。</p><p id="d1fb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这个项目中，我使用变分自动编码器(VAE)来解决这些问题。我对来自特定分布的图像训练了变分自动编码器，以便当来自不同分布的图像被馈送到VAE时，重建损失预计会更高。通过重建损失，可以跟踪图像是否属于特定的分布。在这个例子中，我考虑用这个想法将足球图像从广告中分离出来。</p><p id="6462" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">变型自动编码器</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/b89130a9072a0fae623849c4125ae42a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HF_sgzdYDvBMFDaCa8e8yQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">变分自动编码器的结构</figcaption></figure><p id="4f79" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">VAE是一个深层次的生成模型，就像生成对抗网络一样。深度生成模型显示出令人难以置信的能力，可以生成高度逼真的内容类图像。变分自动编码器由编码器、潜在空间和解码器组成。编码器和解码器基本上是神经网络。这篇<a class="ae js" href="https://towardsdatascience.com/understanding-variational-autoencoders-vaes-f70510919f73" rel="noopener" target="_blank">文章</a>中也很好地解释了变分自动编码器。</p><p id="bb43" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">VAE通过编码器接收输入，并在潜在空间中产生一个更小、更密集的表示(<em class="jy">编码)</em>，该潜在空间包含足够的信息，供网络的下一部分(解码器)将其处理为所需的输出格式，在最佳情况下，这就是输入到编码器的确切输入。通过训练过程，VAE的潜在空间被设计为连续的，允许容易的随机采样和插值。</p><p id="aa6b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">VAE在两个损失上被优化，kl损失和重建损失(输入图像和重建图像之间的差异)。kl损失是潜在空间的分布和具有平均值0(零)和标准偏差1(一)的标准高斯分布之间的差异。这是将潜在空间的分布压缩到标准分布。这有助于解码器在解码图像时从潜在空间的每个区域进行映射。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="5adb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我的例子中(使用变分自动编码器从广告中分离足球图像)，我必须将视频分成帧(图像)。然后，仅在来自该分布的图像(足球图像)上训练VAE。重要的是要注意，变分自动编码器是一个运行计算方面非常昂贵的算法，所以我决定在一个<strong class="iw hj"> EC2 </strong>实例上运行它。数据储存在一个<strong class="iw hj"> S3 </strong>桶里。在有序的步骤中，我们有:</p><ol class=""><li id="ff76" class="kb kc hi iw b ix iy jb jc jf kd jj ke jn kf jr kg kh ki kj bi translated">我们将足球视频转换成帧。</li><li id="3f5e" class="kb kc hi iw b ix kk jb kl jf km jj kn jn ko jr kg kh ki kj bi translated">构建VAE的架构，并编写所有必要的函数。</li><li id="aa48" class="kb kc hi iw b ix kk jb kl jf km jj kn jn ko jr kg kh ki kj bi translated">在AWS EC2实例上进行培训时，将培训时段移动到S3时段</li><li id="cfe5" class="kb kc hi iw b ix kk jb kl jf km jj kn jn ko jr kg kh ki kj bi translated">重复任何步骤，直到重建损失显著减少。</li></ol><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/efc60e7e9b4bdb051f4f5da611abf2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*nX93j3kAuRIkcU3zdEzJiQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">用<strong class="bd kq"><em class="kr">99872576</em></strong><em class="kr">参数</em>重建损失</figcaption></figure><p id="7bf2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上图显示了在重复上述步骤后VAE的重建损失。我也有下面的重建图像可以展示。<strong class="iw hj">注意</strong>我必须缩小输入编码器的图像尺寸。这是为了提高速度，减少VAE的火车时间，同时避免使用太大的EC2实例，这对我来说不方便。<strong class="iw hj">输入编码器的图像尺寸为60 x 80。</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ks"><img src="../Images/e1bc3a3a80c25a9342b2b928848808ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RMW0zWQFQCfM3QHZWawdkg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">输入图像(非缩小版)—大小为1280 x 720。(来源:UEFA.com)</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/c62b43be7db1554e18f6cf9596f758c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/format:webp/1*mCZ5VkOXLQLZ-Bnvmyl38A.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">重建图像—大小为60 x 80(损失139.55)</figcaption></figure><p id="343e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">该算法对于足球图像表现相当好。在广告的情况下，VAE的重建损失更高。当然，考虑到VAE只对足球图像有些熟悉，这是意料之中的。</p><p id="6e89" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">由于许多足球图像具有包含足球场(绿色草坪)的大面积，我推测该算法也可以学习这一点，因此当具有大面积绿色区域的图像被输入到VAE时，即使它们不是足球图像，VAE也可能将它们作为足球图像。我决定通过尝试来自美式足球的图像来测试这一点，美式足球也有绿色的草坪，正如预期的那样，算法认为它们仍然是足球图像。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/1ebea5090865fd5da14780de0fc0e92c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*DyP2XdNyc7GdluVWbMpx0A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">不同图像类型的重建损失</figcaption></figure><p id="593d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从结果来看，VAE的真实阳性率为0.93。VAE很难从美式足球图像中分离出足球图像，同时它也有0.31的误报率。总之，可以有把握地得出结论，通过重建损失，我们能够根据它们各自的分布对图像进行分类，而无需事先标记。</p><p id="3d21" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在接下来的步骤中，我将在一个更大的EC2实例上训练图像。这将允许它用更大的图像进行训练，并且有可能用更多的图像进行训练以减少重建损失。</p><p id="6b48" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">致谢</strong></p><p id="282b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我非常感谢柏林数据科学静修中心的技术总监<strong class="iw hj"> Adam Green </strong>，感谢他对这个项目的支持。特别感谢我的甜心，<strong class="iw hj"> Olamide </strong>的情感支持，以及<strong class="iw hj"> Wuraola </strong>在编辑这篇文章时的帮助。</p><p id="47e0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如有疑问或个人信息，请随时通过<a class="ae js" href="https://www.linkedin.com/in/samson-afolabi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>联系我。</p><p id="547a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">延伸阅读</strong></p><ol class=""><li id="30cf" class="kb kc hi iw b ix iy jb jc jf kd jj ke jn kf jr kg kh ki kj bi translated">理解变分自动编码器。<a class="ae js" href="https://towardsdatascience.com/understanding-variational-autoencoders-vaes-f70510919f73" rel="noopener" target="_blank">链接</a></li><li id="4ea1" class="kb kc hi iw b ix kk jb kl jf km jj kn jn ko jr kg kh ki kj bi translated">直观地理解变化的自动编码器。<a class="ae js" href="https://towardsdatascience.com/intuitively-understanding-variational-autoencoders-1bfe67eb5daf" rel="noopener" target="_blank">链接</a></li></ol><p id="fdb9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你喜欢这篇文章，你可以考虑请我喝☕️.咖啡</p><p id="d7f9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Vielen Dank😊</p></div></div>    
</body>
</html>