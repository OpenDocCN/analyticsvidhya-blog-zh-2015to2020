<html>
<head>
<title>TF-IDF/Term Frequency Technique: Easiest explanation for Text classification in NLP using Python (Chatbot training on words)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TF-IDF/词频技术:使用Python(聊天机器人词汇训练)对自然语言处理中文本分类的最简单解释</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tf-idf-term-frequency-technique-easiest-explanation-for-text-classification-in-nlp-with-code-8ca3912e58c3?source=collection_archive---------0-----------------------#2019-05-30">https://medium.com/analytics-vidhya/tf-idf-term-frequency-technique-easiest-explanation-for-text-classification-in-nlp-with-code-8ca3912e58c3?source=collection_archive---------0-----------------------#2019-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="42ed" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">或者如何找到句子和文档的意思</h2></div><p id="0a9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TF-IDF或(术语频率(TF)-逆密集频率(IDF))是一种用于发现由单词组成的句子的含义并抵消单词袋技术的能力的技术，该技术有利于文本分类或帮助机器读取数字中的单词。然而，当你要求它理解句子或文档的意思时，它就在你面前爆炸了。</p><p id="0521" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我强烈建议您在阅读本文之前先阅读一下BoW，了解一下上下文</p><div class="jt ju ez fb jv jw"><a rel="noopener follow" target="_blank" href="/swlh/bag-of-words-code-the-easiest-explanation-of-nlp-technique-using-a-python-8a4fdfb8598c"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">单词包代码——使用python对NLP技术最简单的解释</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">我的乘客朋友们，你好，(跳到代码末尾)</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">medium.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk kl jw"/></div></div></a></div><h1 id="5075" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">那么它是什么，你想用一个例子来理解吗？</h1><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="e97a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设一台机器正在试图理解这个的意思—</p><blockquote class="ll lm ln"><p id="e46a" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">今天是美好的一天</p></blockquote><p id="19fe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你在这里关注什么，但是作为一个人而不是一台机器告诉我？</p><p id="3a09" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这句话讲的是<strong class="iz hj">今天</strong>，它也告诉我们今天是<strong class="iz hj">美好的一天</strong>。心情<strong class="iz hj">愉快/积极</strong>，还有什么牛仔？</p><p id="bce3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">美丽显然是这里使用的形容词。从BoW方法来看，所有的单词都被分解成计数和频率，没有对某个特定单词的偏好，这里所有的单词都有相同的频率(在这种情况下是1)，显然机器没有强调美感或积极的情绪。</p><p id="e0bc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些词只是被分解，如果我们谈论重要性，“a”和“日”或“美”一样重要。</p><p id="b5f4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是与“美”相比,“a”真的能告诉你更多关于句子上下文的信息吗？</p><p id="65a1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不，这就是为什么单词袋需要升级。</p><p id="30b9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，另一个主要缺点是，假设一个文档有200个单词，其中“a”出现了20次，“the”出现了15次，等等。</p><p id="8e89" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">许多反复出现的词在最终的特征构建中被赋予了更大的重要性，而我们却忽略了那些重复较少但却很重要的词，比如雨、美丽、地铁、名字。</p><p id="1424" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，如果由机器阅读，很容易错过作者的意思，它提出了一个TF-IDF解决的问题，所以现在我们知道<strong class="iz hj">为什么我们使用TF-IDF。</strong></p><h1 id="6abc" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">现在让我们看看它是如何工作的，好吗？</h1><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="ls lk l"/></div></figure><p id="80fc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TF-IDF通过引入一个叫做<strong class="iz hj">逆文档频率的重要概念，在解决单词袋的主要缺点方面很有用。</strong></p><p id="c899" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个分数，机器会评估句子中使用的单词，并测量它与整个文档中使用的单词相比的用法。换句话说，这是一个突出每个单词在整个文档中的相关性的分数。它的计算方法是-</p><blockquote class="ll lm ln"><p id="542e" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">IDF =Log[(#文档数)/(包含单词的文档数)]和</p><p id="2efd" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">TF =(文档中单词的重复次数)/(文档中的单词数)</p></blockquote><p id="e78f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好的，现在让我们假设TF回答这样的问题—<strong class="iz hj">beauty在整个文档中使用了多少次</strong>，给我一个概率，IDF回答这样的问题:beauty这个词在整个文档列表中有多重要，<strong class="iz hj">它是所有文档中的共同主题吗</strong>。</p><p id="03b8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，使用TF和IDF机器可以理解文档中的重要单词以及贯穿所有文档的重要单词。</p><h2 id="f1e9" class="lt kn hi bd ko lu lv lw ks lx ly lz kw jg ma mb ky jk mc md la jo me mf lc mg bi translated">回答我这个问题—</h2><blockquote class="ll lm ln"><p id="b8ab" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">想象一下，有一个充满句子的文档，打破它的最好方法是什么，以便机器可以理解它是什么？</p><p id="2c20" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">1.用语言打破它</p><p id="b94b" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">2.用字母打破它</p><p id="c5f3" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">3.把它分成句子</p><p id="94c0" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">4.按字节分解</p></blockquote><p id="5001" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你能回答吗？</p><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h1 id="ad6c" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">时间到了。</h1><p id="b562" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated"><em class="lo">目前的答案是选项3 </em>。把它分解成句子。</p><p id="016f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为什么？因为当你把一个文档分成多个句子时，每个句子都有多个单词，这些单词为句子提供了一些上下文，这些句子作为一个整体为文档提供了一些上下文，然后我们可以向机器提问，</p><blockquote class="ll lm ln"><p id="2503" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">【Siri有哪些互相类似的文档？</p></blockquote><p id="9e21" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过评估TF-IDF或多个<em class="lo">“句子中使用的单词与整个文档中使用的单词”，</em>我们了解-</p><ol class=""><li id="028d" class="mm mn hi iz b ja jb jd je jg mo jk mp jo mq js mr ms mt mu bi translated">一个单词对一个句子有多有用(帮助我们理解一个单词在句子中的重要性)。</li><li id="cf8e" class="mm mn hi iz b ja mv jd mw jg mx jk my jo mz js mr ms mt mu bi translated">一个单词对一个文档有多有用(帮助我们理解文档中出现频率较多的重要单词)。</li><li id="fd23" class="mm mn hi iz b ja mv jd mw jg mx jk my jo mz js mr ms mt mu bi translated">帮助我们忽略拼写错误的单词(使用n-gram技术),下面我将介绍一个例子</li></ol><p id="6bb5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">想象一下，在一个文档中，你把“example”拼错成了“example ”,而你忘记了在把它交给机器阅读之前回去修改它</p><p id="49da" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在BOW的情况下,“example”和“example”将被视为不同的单词，并被赋予相同的重要性，因为它们的频率是相同的。</p><p id="0d24" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是在TD-IDF的情况下，因为IDF的分数，这个错误被纠正，因为我们知道example作为一个单词比example更重要，所以我们把它当作一个无用的单词。</p><p id="d7ba" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，因为这些分数，我们的机器对这些文件有了更好的理解，并且可以被要求比较这些文件，找到相似的文件，找到相反的文件，找到文件中的相似之处，并且可以被机器用来推荐你接下来要读什么，酷吧？</p><p id="87f3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我想在我告诉你怎么做之前，你需要一分钟的时间来回顾和理解这个概念，当然，我会举一个例子，所以如果你在概念上模糊不清，但几乎很清楚，一旦你用这个例子练习，你就肯定没问题了。</p><h1 id="b85f" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">找到一个文档的TF-IDF的方法是什么？</h1><p id="8f94" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">使用TF-IDF查找文档含义的过程非常类似于单词袋，</p><ol class=""><li id="2bd9" class="mm mn hi iz b ja jb jd je jg mo jk mp jo mq js mr ms mt mu bi translated">清理数据/预处理—清理数据(标准化数据)、规格化数据(全部小写)、词条化数据(所有单词到词根)。</li><li id="6dcf" class="mm mn hi iz b ja mv jd mw jg mx jk my jo mz js mr ms mt mu bi translated">用频率标记单词</li><li id="c7ba" class="mm mn hi iz b ja mv jd mw jg mx jk my jo mz js mr ms mt mu bi translated">查找单词的TF</li><li id="ca29" class="mm mn hi iz b ja mv jd mw jg mx jk my jo mz js mr ms mt mu bi translated">查找IDF单词</li><li id="cda2" class="mm mn hi iz b ja mv jd mw jg mx jk my jo mz js mr ms mt mu bi translated">矢量化词汇</li></ol><p id="c12b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">(如果你不熟悉这些是什么，我建议阅读我在上面分享的文章BOW，以清楚地了解如何做到这些)。</p><p id="13c5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将使用这些技术来涵盖下面的例子，所以我希望你熟悉它们。</p><h2 id="23d7" class="lt kn hi bd ko lu lv lw ks lx ly lz kw jg ma mb ky jk mc md la jo me mf lc mg bi translated">让我们以三个文档为例-</h2><p id="5e34" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">今天会下雨。</p><p id="9e61" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">文件2 </strong>今天我不出去了。</p><p id="431e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">文件3 </strong>我要去看第三季首播。</p><p id="354b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要找到TF-IDF，我们需要执行上面列出的步骤，让我们开始吧。</p><h1 id="1f3e" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">步骤1清理数据并标记化</h1><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es na"><img src="../Images/c7aaf6b12bbab94abfdfede0d1d9553c.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*4e7_738WtUgkKSdumJfQ1Q.png"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">文件词汇</figcaption></figure><h1 id="dd62" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">寻找TF</h1><p id="d4ba" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated"><strong class="iz hj">文件1 </strong> —</p><blockquote class="ll lm ln"><p id="9cc8" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">今天会下雨。</p></blockquote><p id="d3b5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">找到它的TF =(文档中单词的重复次数)/(文档中单词的数量)</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ng"><img src="../Images/049b8b7a2dd24b87d5563988fff81c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*pWR7LSh3Ui9ADTqRrcbTcw.png"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">句子1的TF</figcaption></figure><p id="5960" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">继续余下的句子-</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es nh"><img src="../Images/0d0abb7fc01268c75367e34918f88c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*58b3x6cd6SefwgERcaGamg.png"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">文档的TF</figcaption></figure><h1 id="c36f" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">寻找IDF</h1><p id="3559" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">查找文档的IDF(我们仅对没有停用词的功能名称/词汇进行此操作)</p><p id="6de6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">IDF =Log[(文档数)/(包含该单词的文档数)]</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ni"><img src="../Images/c04c28354e9fe95a72c078175d26919c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*goSIDb32U3DflYNrKUXQHQ.png"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">文档的IDF</figcaption></figure><h1 id="c072" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">步骤4建立模型，即把所有单词一个接一个地堆叠起来—</h1><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="er es nj"><img src="../Images/62aeecf11587aa676e3bd825f5b3acfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OXjZ3vpUk-T3kyZL4Ytncw.png"/></div></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">3份文件的IDF值和TF值。</figcaption></figure><h1 id="12a2" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">比较结果，用表格提问</h1><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="er es no"><img src="../Images/d7de7a1121f637ed9b049b9447515969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhKVAMWLbmstk5VO3jdAiw.png"/></div></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">记住，最后的等式= TF-IDF = TF * IDF</figcaption></figure><p id="33ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用该表可以很容易地看出，像<strong class="iz hj">‘it’，‘is’，‘rain’</strong>这样的词对文档1很重要，但对文档2和文档3不重要，这意味着文档1和2 &amp; 3在谈论rain时是不同的。</p><p id="47b7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你也可以说文件1和文件2谈的是某件事<strong class="iz hj">‘今天’</strong>，文件2和文件3因为有了<strong class="iz hj">‘我’这个字，所以讨论了作者的某件事。</strong></p><p id="1a1e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这张表帮助你找到相似和不相似的btw文件，文字和更多更好的比弓。</p><blockquote class="ll lm ln"><p id="344b" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">如果你想看我选的例子的视频，可以看看同样的视频。<a class="ae np" href="https://www.youtube.com/watch?v=ouEVPRMHR1U" rel="noopener ugc nofollow" target="_blank">查看视频</a></p></blockquote><h1 id="9d18" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">让我们编写这个代码，自己看看</h1><h2 id="6013" class="lt kn hi bd ko lu lv lw ks lx ly lz kw jg ma mb ky jk mc md la jo me mf lc mg bi translated"><strong class="ak">挑战是使用这些句子，并使用TF-IDF找到赋予这些句子意义的单词，好吗？</strong></h2><p id="7a2a" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">我们开始吧</p><p id="2f5d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"><em class="lo">#第1部分申报所有文件并分配给Vocab文件</em> </strong></p><pre class="le lf lg lh fd nq nr ns nt aw nu bi"><span id="9998" class="lt kn hi nr b fi nv nw l nx ny">Document1= “It is going to rain today.”<br/>Document2= “Today I am not going outside.”<br/>Document3= “I am going to watch the season premiere.”<br/>Doc = [Document1 ,<br/> Document2 , <br/> Document3]<br/>print(Doc)<br/><strong class="nr hj"><em class="lo">Output</em>&gt;&gt;&gt;<br/></strong><em class="lo">[‘It is going to rain today.’, ‘Today I am not going outside.’, ‘I am going to watch the season premiere.’]</em></span></pre><p id="c456" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"><em class="lo">#第二部分—初始化tfidf矢量器</em> </strong></p><pre class="le lf lg lh fd nq nr ns nt aw nu bi"><span id="f080" class="lt kn hi nr b fi nv nw l nx ny">from sklearn.feature_extraction.text import TfidfVectorizer</span><span id="be71" class="lt kn hi nr b fi nz nw l nx ny">vectorizer = TfidfVectorizer()</span></pre><p id="1c2f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">部署TF-IDF有多简单，对吗？</p><p id="6f6d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"><em class="lo">#第3部分—获取我们将用于标记文档的最终单词的特征名称</em> </strong></p><pre class="le lf lg lh fd nq nr ns nt aw nu bi"><span id="6c47" class="lt kn hi nr b fi nv nw l nx ny">analyze = vectorizer.build_analyzer()</span><span id="3220" class="lt kn hi nr b fi nz nw l nx ny">print(‘Document 1’,analyze(Document1))</span><span id="9e47" class="lt kn hi nr b fi nz nw l nx ny">print(‘Document 2’,analyze(Document2))</span><span id="5093" class="lt kn hi nr b fi nz nw l nx ny">print(‘Document 3’,analyze(Document3))</span><span id="cce4" class="lt kn hi nr b fi nz nw l nx ny">print(‘Document transform’,X.toarray())</span><span id="8cd4" class="lt kn hi nr b fi nz nw l nx ny"><strong class="nr hj"><em class="lo">Output</em>&gt;&gt;&gt;</strong></span><span id="2ac8" class="lt kn hi nr b fi nz nw l nx ny"><em class="lo">Document 1 [‘it’, ‘is’, ‘going’, ‘to’, ‘rain’, ‘today’]</em></span><span id="9c2d" class="lt kn hi nr b fi nz nw l nx ny"><em class="lo">Document 2 [‘today’, ‘am’, ‘not’, ‘going’, ‘outside’]</em></span><span id="da96" class="lt kn hi nr b fi nz nw l nx ny"><em class="lo">Document 3 [‘am’, ‘going’, ‘to’, ‘watch’, ‘the’, ‘season’, ‘premiere’] </em></span><span id="69ed" class="lt kn hi nr b fi nz nw l nx ny"><em class="lo">Document transform [[0. 0.27824521 0.4711101 0.4711101 0. 0. 0. 0.4711101 0. 0. 0.35829137 0.35829137 0. ] [0.40619178 0.31544415 0. 0. 0.53409337 0.53409337 0. 0. 0. 0. 0. 0.40619178 0. ] [0.32412354 0.25171084 0. 0. 0. 0. 0.4261835 0. 0.4261835 0.4261835 0.32412354 0. 0.4261835 ]]</em></span></pre><p id="f4e0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">看看每个句子是如何分解成单词的，每个单词又是如何被机器表示成一个数字的，我已经把上面两个都分解了。</p><p id="a1d2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"><em class="lo">#第4部分—矢量化或创建所有三个文档的矩阵，并找到特征名称</em> </strong></p><pre class="le lf lg lh fd nq nr ns nt aw nu bi"><span id="f951" class="lt kn hi nr b fi nv nw l nx ny">X = vectorizer.fit_transform(Doc)</span><span id="eac5" class="lt kn hi nr b fi nz nw l nx ny">print(vectorizer.get_feature_names())</span><span id="d12a" class="lt kn hi nr b fi nz nw l nx ny"><strong class="nr hj"><em class="lo">Output</em>&gt;&gt;&gt; <br/></strong>[‘am’, ‘going’, ‘is’, ‘it’, ‘not’, ‘outside’, ‘premiere’, ‘rain’, ‘season’, ‘the’, ‘to’, ‘today’, ‘watch’]</span></pre><p id="cf37" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出表示为3个句子添加上下文的重要单词。这是在所有三个句子中都很重要的单词，现在你可以向机器问任何你喜欢的问题，比如</p><blockquote class="ll lm ln"><p id="fb4a" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">什么是类似的文件？</p><p id="b925" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">什么时候会下雨？</p><p id="98a5" class="ix iy lo iz b ja jb ij jc jd je im jf lp jh ji jj lq jl jm jn lr jp jq jr js hb bi translated">我做完了，接下来读什么？</p></blockquote><p id="858b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为机器有一个分数来帮助回答这些问题，TF-IDF证明是一个很好的工具来训练机器回答聊天机器人的问题。</p><p id="c2d5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想看完整的代码-</p><p id="4734" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">点击这里查看我的Github &gt;<a class="ae np" href="https://github.com/rmadan16/TF-IDF" rel="noopener ugc nofollow" target="_blank"><strong class="iz hj">查看包字代码</strong>。</a></p></div></div>    
</body>
</html>