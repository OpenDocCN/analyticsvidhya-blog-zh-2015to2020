<html>
<head>
<title>Predict Traffic Accident Severity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测交通事故严重程度</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predict-traffic-accident-severity-96a15620fa63?source=collection_archive---------20-----------------------#2020-10-10">https://medium.com/analytics-vidhya/predict-traffic-accident-severity-96a15620fa63?source=collection_archive---------20-----------------------#2020-10-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a839" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类模型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/8240a2320ff6209eb71d541876e4218f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*Ocxq4ifdJD-OzqqQM7d4YA.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">预测交通事故严重程度</figcaption></figure><p id="a6c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">道路安全应该是政府、地方当局和私营公司投资于有助于减少事故和提高整体驾驶安全的技术的优先考虑。</p><p id="97aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们将分析历史碰撞数据并准备分类模型来预测未来事件。</p><h1 id="8c22" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">数据:</strong></h1><p id="0333" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">从<a class="ae ks" href="https://s3.us.cloud-object-storage.appdomain.cloud/cf-courses-data/CognitiveClass/DP0701EN/version-2/Data-Collisions.csv" rel="noopener ugc nofollow" target="_blank">https://S3 . us . cloud-object-storage . appdomain . cloud/cf-courses-Data/cognitive class/DP 0701 en/version-2/Data-collisions . CSV</a>下载数据集</p><p id="3d01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集形状:<strong class="ih hj"> 194673 个样本，38 个特征</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/ccbc3fc8628813cca964718c8b6e7ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4ggYDsR9JEGcrJyU_pLQA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">功能列表</figcaption></figure><p id="e53b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里<strong class="ih hj"> SEVERITYCODE </strong>是<strong class="ih hj"> </strong>目标变量。</p><p id="7d95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1:财产损失，</strong></p><p id="daec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2:受伤</strong></p><h1 id="2038" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">数据清理和数据分析:</strong></h1><p id="761b" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">下图显示了目标变量中的类别分布不平衡。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ky"><img src="../Images/3812f9f246629f2dc4e7c11f083811cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bAyJKZr7YHpmqlbiqA3pXA.png"/></div></div></figure><p id="bcd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要减少大多数班级的人数以使分布均衡。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kz"><img src="../Images/09ce2674d510bc7c2288142eec74eea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E9Dq65e0lTBTZaiOGal_xw.png"/></div></div></figure><p id="8a78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">执行向下采样后目标变量中的分布。现在是平衡数据集。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es la"><img src="../Images/fe4742267ae04ba8c447e91e0ccb75c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z4lyhSyQ8m89X9tUt04kCQ.png"/></div></div></figure><p id="336c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">识别并删除缺失值超过 30%的列。并移除缺失值少于 3%的样本。因为如果我们使用任意方法填充缺失的数据，生成坏数据的可能性会更高。</p><div class="je jf jg jh fd ab cb"><figure class="lb ji lc ld le lf lg paragraph-image"><img src="../Images/d3009df7d3052eebcce668a3f3e42637.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*05xJTGHGgztbgxP9eju3Aw.png"/></figure><figure class="lb ji lh ld le lf lg paragraph-image"><img src="../Images/be130699407060d50937df5fffd07094.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*VA4YjjUbfpR3eqbHynGI7w.png"/><figcaption class="jl jm et er es jn jo bd b be z dx li di lj lk translated">缺失值&gt; 30%和缺失值&lt; 3%</figcaption></figure></div><p id="b2fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Check category distribution of other features with respect to target variable along with data distribution in continuous features and visualize results. It will help to find duplicate and ambiguous categories within data set.</p><p id="cd0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">It will also help to check patterns in data before performing down sampling and after performing down sampling. If data distribution gets changed after applying any up sampling or down sampling technique, that means either we may have generated bad data or have lost some important information from original data set. Here pattern remains intact after applying down sampling technique that means we have not lost any important information.</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ll"><img src="../Images/35a447e6dc940471675fc4bf78bd2adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bvvrNdoXSvijAYbxzsmWYA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lm"><img src="../Images/aa29b40665d6c86406ca46a665330a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RfcCoXPB7a3tRcwhiX56lA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated"><strong class="bd jr">关于目标变量的数据分布:下采样前</strong></figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ln"><img src="../Images/6ab276ab0bcc57a0effc00d30e40429b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qCNlvqMvneTd6vm5Mu8atw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lm"><img src="../Images/e48cdad21ffc2db9345e2e6b22a86e81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PtWBcO_rEhwR3uHtdd5Bmg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated"><strong class="bd jr">目标变量的数据分布:降采样后</strong></figcaption></figure><p id="24e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">观察:</strong></p><p id="a8a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图显示，即使在下采样后，数据模式仍保持不变。这意味着我们没有丢失任何重要数据。</p><p id="2c26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">具有模糊类别的功能“UNDERINFL”。我们应该把 Y 和 1 合并，把 N 和 0 合并。</p><p id="cd91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">具有模糊类别的特征天气。我们应该把雨夹雪/冰雹/冻雨和下雪混在一起，其他的和未知的，有严重侧风的风沙/尘土混在一起。</p><p id="de32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">具有不明确类别的特征道路状况。我们应该把其他的和未知的融合在一起。</p><p id="a07d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">具有不明确类别的特征光导管。我们应该把其他未知的、黑暗的——路灯关掉——没有路灯。</p><p id="a466" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它还表明，最大的碰撞发生在晴朗的天气干燥的道路上和日光下。</p><p id="8848" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查异常值并删除。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lo"><img src="../Images/5d89e9fdb63399caab3fba2d9075a002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHyzaWOdDj0OVY6SkJ17Gw.png"/></div></div></figure><p id="d003" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后将分类变量转换为数值，因为机器学习模型不支持字符串或文本数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lp"><img src="../Images/a6b5001d60fc30bf8b713cfcb234022e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YN2qv3_c9YnwNKGXbDBNBw.png"/></div></div></figure><p id="4bf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">丢弃重复样本并标准化输入数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lq"><img src="../Images/7724b4277f01bae7e4cbcca13689f127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txmUI1ZpVgLV4Y5Lw-P3pA.png"/></div></div></figure><h1 id="747c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">建模:</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/05bd9077c8199e91da8d0287b0f7d62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*XHwl8Gsz7IWFAdfj-ML2aQ.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ls"><img src="../Images/623fe6aed46bc0073351383d24d3e238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4sg28tvcL8gLapEvGM45zA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lt"><img src="../Images/8e6eb809ca6d07d572f970212cc6eaeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3i8kP7wsKeE1tT0MPIlicA.png"/></div></div></figure><blockquote class="lu lv lw"><p id="6611" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated">在这里，您也可以使用 scikit-learn 的<strong class="ih hj"> GridSearchCV </strong>方法尝试多个超参数，这将产生给定模型的最佳超参数。稍后，您可以使用这些参数来训练模型。</p></blockquote><p id="fdd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj">准确度、F1-得分、Jaccrd 相似性得分、精确度、召回率进行评估。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/a2cb8d83b21a05a9a58e70a1c6e4e583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*21Ta2EaB9crQB5XMfzHrZw.png"/></div></figure><h1 id="c7d8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">结果:</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mc"><img src="../Images/b612aa7cd85d9a6c666311dc75f61de4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a1bpTHvNtYGTV-iD4M4Mew.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">使用不同算法和评估指标的预测结果</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es md"><img src="../Images/6ee9672d81996642bd506b7b3cf66037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCeyPBG-ib9keMfysTvI3Q.png"/></div></div></figure><h1 id="9074" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">结论:</strong></h1><p id="5d89" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">SVM 在其他车型中表现最佳，同时培训时间也比其他车型高 100 倍。</p><p id="a681" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们追求精确，那么决策树表现良好，如果我们追求召回，那么 KNN 表现良好。</p><p id="bd9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里“精确”指的是预测的碰撞伤害百分比是真实的伤害。取而代之的是，90%的碰撞确实涉及到了被正确预测的伤害.对于这个特定的问题，召回率比精确度更重要，因为高召回率将有利于所有需要的资源都准备好来预测碰撞是否涉及伤害。</p></div></div>    
</body>
</html>