<html>
<head>
<title>Simple Bayes: an example you can apply today!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单贝叶斯:一个你今天可以应用的例子！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-bayes-an-example-you-can-apply-today-11381b723967?source=collection_archive---------27-----------------------#2020-03-13">https://medium.com/analytics-vidhya/simple-bayes-an-example-you-can-apply-today-11381b723967?source=collection_archive---------27-----------------------#2020-03-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fc1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">贝叶斯或概率统计方法不仅在学术界和科学领域，而且在商业领域变得越来越流行。即使贝叶斯定理本身并不难理解，但当涉及到线性回归参数时，计算马上变得繁琐得多。所以，人们决定跳过它。</p><p id="5a72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，可能还有接下来的文章，我将给出几个案例和简单的Python例子，说明数据分析师和数据科学家如何在相当常见的情况下应用贝叶斯，当它带来可靠和合理的结果时，不需要付出太多的努力。</p><h1 id="5c26" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">任务</h1><p id="564d" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我的大部分经历都与游戏设计有关。假设你的游戏设计师/制作人想出了一个关于新功能/游戏机制的主意。她相信你所有的球员都会喜欢它。在一组27名玩家的游戏测试中，只有9人表示他们完全理解这个想法和机制。与预期相差很大，对吧？如何找到共识？仅仅根据26条评论就能下结论吗？没有时间去思考和做更多的测试了——我们需要计划一个发布！</p><p id="bb95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太棒了。这是用贝叶斯理论掸去你讲课灰尘的最佳时机。</p><p id="b4b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从数学上来说，我们有一个<a class="ae kg" href="https://en.wikipedia.org/wiki/Binomial_distribution" rel="noopener ugc nofollow" target="_blank"><em class="kh"/></a>二项式过程，需要估计参数𝜃——成功率——喜欢和玩新机制的玩家比例。</p><p id="c561" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们加载库并设置关键变量。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="3848" class="kr je hi kn b fi ks kt l ku kv">import numpy as np<br/>import matplotlib.pyplot as plt<br/>from scipy import stats</span><span id="be22" class="kr je hi kn b fi kw kt l ku kv">plt.style.use('seaborn-darkgrid')<br/>plt.rcParams['figure.figsize']=(10,6)</span><span id="994c" class="kr je hi kn b fi kw kt l ku kv">N = 27 # Number of trials/testers<br/>success = 9<br/>x = np.arange(0, N+1) # All possible outcomes</span></pre><p id="c340" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更好地理解全貌，让我们画出不同真实𝜃的可能结果</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="ad1b" class="kr je hi kn b fi ks kt l ku kv">theta=np.linspace(0.1, 0.9, 5) # set of different possible thetas</span><span id="e4f1" class="kr je hi kn b fi kw kt l ku kv">f,ax = plt.subplots(len(theta), 1,<br/>                    sharex=True, sharey=True,<br/>                    figsize=(8, 7), constrained_layout=True)</span><span id="2d87" class="kr je hi kn b fi kw kt l ku kv">for j in range(len(theta)):        <br/>    p = theta[j]        <br/>    y = stats.binom(n=N, p=p).pmf(x)        <br/>    ax[j].vlines(x, 0, y, colors='C0', lw=5)        <br/>    ax[j].set_ylim(0, 0.5)<br/>    ax[j].plot(0, 0, label="N = {:3.1f}\nθ ={:3.2f}".format(N,p))<br/>    ax[j].axvline(x=success, color='C4', linestyle='--')<br/>        <br/>    ax[j].legend()<br/>    ax[4].set_xlabel('number of success')        <br/>    ax[0].set_xticks(x)</span></pre><figure class="ki kj kk kl fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es et"><img src="../Images/23f436e527859dab00f560652edebddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZEski97p6Di1WH2pgN7zw.png"/></div></div></figure><p id="661c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，𝜃大于70%看起来绝对不合理。但是50%的概率有可能是真的。在这种情况下，27次试验中有9次成功的概率只有3.5%。但是谁知道呢，也许在生产中，有了我们真正的用户大军，我们会得到更多的运气。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="c3c9" class="kr je hi kn b fi ks kt l ku kv">stats.binom.pmf(success, N, 0.5)<br/>Out[4]: 0.034919567406177285</span></pre><p id="b5b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是为了计划这个特性的发布，我们需要得到一些𝜃.的边界游戏设计师同意她最初的感觉过于乐观。但是在真实的人群中，当人们开始玩并谈论新的机制时，她预计参与度不会低于70%。不错！我们将在我们的先验中反映这一点。</p><h1 id="42a1" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">院长</h1><p id="3b9c" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">让我们为可能的𝜃估计建立空间，然后使用<a class="ae kg" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank"> <em class="kh">贝塔分布</em> </a>来表示<em class="kh">“不低于70%的参与度”</em>。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="41fc" class="kr je hi kn b fi ks kt l ku kv">theta_space = np.linspace(0, 1, 100)</span><span id="b08c" class="kr je hi kn b fi kw kt l ku kv">alpha=10<br/>beta=5</span><span id="987a" class="kr je hi kn b fi kw kt l ku kv">y_pdf=stats.beta.pdf(theta_space, alpha, beta)<br/>fig, ax = plt.subplots(1,1)<br/>plt.plot(theta_space, y_pdf)<br/>ax.set_xlabel('theta')<br/>plt.show()</span></pre><figure class="ki kj kk kl fd kx er es paragraph-image"><div class="er es le"><img src="../Images/1a81ef460420188910a675a3965e7d22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*rSAXLwsdCOOEP3IenWkp4A.png"/></div></figure><p id="9c32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不会过多关注<a class="ae kg" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank"> beta分布</a>本身。但我只想说𝛼和𝛽塑造了这条曲线。如果我们成比例地增加它们，例如把𝛼设为6，𝛽设为3，我们会得到“更胖的钟”，对所讨论的参数没有那么确定的先验知识。在许多出版物中，像这本<a class="ae kg" href="https://subscription.packtpub.com/book/data/9781789341652" rel="noopener ugc nofollow" target="_blank">的书</a>，推荐使用<em class="kh">的弱信息先验</em>，我完全喜欢这个想法。</p><p id="4451" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，有了二项式和贝塔分布，贝叶斯计算非常简单——我保证！基于公式𝑃(𝜃|𝑦) ~ 𝐵𝑒𝑡𝑎(𝛼+𝑦，𝛽+𝑁−𝑦)我们可以很容易地获得新的𝛼和𝛽的后验估计我们真正的𝜃</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="11c9" class="kr je hi kn b fi ks kt l ku kv">alpha_post=alpha+success<br/>beta_post=beta+N-success</span><span id="c1c0" class="kr je hi kn b fi kw kt l ku kv">y_pdf=stats.beta.pdf(theta_space, alpha_post, beta_post)<br/>fig, ax = plt.subplots(1,1)<br/>plt.plot(theta_space, y_pdf)<br/>ax.set_xlabel('theta')<br/>plt.show()</span></pre><figure class="ki kj kk kl fd kx er es paragraph-image"><div class="er es lf"><img src="../Images/2517866c3824eaa10d21f75bfa42e3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*xbVfmt2pgQ1J6aQDRtnqaA.png"/></div></figure><h1 id="106d" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">合理估计</h1><p id="5d76" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">就是这样！基于我们的实验和对速率应该是多少的先验信念，我们得到了这个分布。我们来画一些关键值。贝塔分布理论平均值是𝜇=𝛼/(𝛼+𝛽)</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="881f" class="kr je hi kn b fi ks kt l ku kv">alpha_post/(alpha_post+beta_post)<br/>Out[9]: 0.4523809523809524</span></pre><p id="890f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和90% <em class="kh">最高密度区间</em>。请记住，这不同于置信区间，90%是一个任意的数字。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="f839" class="kr je hi kn b fi ks kt l ku kv">x1=stats.beta.ppf(0.05, alpha_post, beta_post) # limits lower 5% tail on the right<br/>x2=stats.beta.ppf(0.95, alpha_post, beta_post) # limits upper 5% tail on the left</span><span id="fbb3" class="kr je hi kn b fi kw kt l ku kv">fig, ax = plt.subplots(1,1)<br/>plt.plot(theta_space, y_pdf, label='pdf')<br/>plt.axvline(x1, color='C4', linestyle='--')<br/>plt.axvline(x2, color='C4', linestyle='--')<br/>plt.show()</span></pre><figure class="ki kj kk kl fd kx er es paragraph-image"><div class="er es lf"><img src="../Images/8943e931c06e58009f84854b64586990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*qvKQa6NCEbKee0w54RgusA.png"/></div></figure><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="26ef" class="kr je hi kn b fi ks kt l ku kv">print(x1, x2)<br/>0.32866582116602666 0.5787066958031966</span></pre><p id="70ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我要说的是，期望参与超过60%的机制是不合理的。同时，我们确信至少有33%的玩家会得到它并玩它。有了这把叉子，我们可以制定计划。</p><p id="a3c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">真正美妙的是，有了新的数据，我们可以更新估计。假设我们又收到了10条评论。我们只需将结果添加到我们的𝛼和𝛽中，就能更精确地了解𝜃.</p><p id="8c29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望无论你在哪个领域工作，你都会发现这是有趣和有用的。更多的例子和场景，你可以很容易地使用贝叶斯方法将随之而来。</p><p id="bb6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">敬请期待！</p></div></div>    
</body>
</html>