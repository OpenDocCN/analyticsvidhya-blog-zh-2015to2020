<html>
<head>
<title>MongoDB in Python Tutorial for Beginners (using PyMongo)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python初学者教程中的MongoDB(使用PyMongo)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mongodb-in-python-tutorial-for-beginners-using-pymongo-4c43129721fd?source=collection_archive---------9-----------------------#2020-02-20">https://medium.com/analytics-vidhya/mongodb-in-python-tutorial-for-beginners-using-pymongo-4c43129721fd?source=collection_archive---------9-----------------------#2020-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="fdf3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">概观</h1><ul class=""><li id="e5ea" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">MongoDB是一个数据科学家应该知道的流行的非结构化数据库。</li><li id="38d8" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">我们将讨论如何使用Python(和PyMongo库)处理MongoDB数据库。</li><li id="b9c0" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">我们将使用Python讲述MongoDB中的所有基本操作。</li></ul><h1 id="5d62" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结构化数据库的挑战</h1><p id="fb47" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">我们现在正以前所未有的速度产生数据。这些数据的规模和大小令人难以置信！看看这些数字:</p><ul class=""><li id="397b" class="jd je hi jf b jg kp ji kq jk kr jm ks jo kt jq jr js jt ju bi translated">脸书仅在一天之内就产生了4pb的数据</li><li id="29a6" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><strong class="jf hj">谷歌</strong>每天产生20 Pb的数据</li><li id="6ff0" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">此外，<strong class="jf hj">大型强子对撞机</strong> (27公里长的世界上最强大的粒子加速器)每秒产生1pb的数据。最重要的是，这些数据是非结构化的</li></ul><p id="077e" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">您能想象使用SQL处理如此大量的数据吗？这是在给自己做噩梦！</p><p id="0037" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">作为一名数据科学家，SQL是一门很好的学习语言，当我们处理结构化数据时，它确实工作得很好。但是，如果您的组织处理非结构化数据，SQL数据库无法满足要求。</p><p id="c6c1" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">结构化数据库有两个主要缺点:</p><ul class=""><li id="98be" class="jd je hi jf b jg kp ji kq jk kr jm ks jo kt jq jr js jt ju bi translated"><strong class="jf hj">可伸缩性:</strong>随着数据库变大，很难伸缩</li><li id="ac72" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><strong class="jf hj">弹性:</strong>结构化数据库需要预定义格式的数据。如果数据不符合预定义的格式，关系数据库不会存储它</li></ul><p id="60cf" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">那么我们如何解决这个问题呢？如果不是SQL，那是什么？</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es kx"><img src="../Images/188d2157ff3a468d937a61b9ddcc56d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ca2hKrg_pDCrZpy9.png"/></div></div></figure><p id="260e" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">这是非结构化数据库的发展方向。在众多这样的数据库中，MongoDB被广泛使用，因为它具有丰富的查询语言和快速访问索引等概念。简而言之，MongoDB最适合管理大数据。让我们看看结构化和非结构化数据库之间的区别:</p><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lj"><img src="../Images/d273349273a3604caf6a011a7707d367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*jBCHtkWiX8sDdzJiaZOF5A.png"/></div></figure><p id="90cc" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">本文是使用<a class="ae lk" href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science?utm_source=blog&amp;utm_medium=mongodb-in-python-tutorial-for-beginners-using-pymongo" rel="noopener ugc nofollow" target="_blank"> Python </a>入门MongoDB的终极指南。我们将借助示例和PyMongo库演示MongoDB上的各种操作。</p><h1 id="da6d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">目录</h1><ol class=""><li id="d6be" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq ll js jt ju bi translated">什么是MongoDB？</li><li id="ac93" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq ll js jt ju bi translated">理解问题陈述</li><li id="316e" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq ll js jt ju bi translated">PyMongo是什么？</li><li id="0df4" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq ll js jt ju bi translated">MongoDB安装指南</li><li id="02aa" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq ll js jt ju bi translated">对MongoDB数据库的基本操作</li><li id="088e" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq ll js jt ju bi translated">将提取的数据转换为结构化形式</li><li id="df4b" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq ll js jt ju bi translated">其他有用的功能</li><li id="e16d" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq ll js jt ju bi translated">下一步是什么？</li></ol><h1 id="930e" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">1.什么是MongoDB？</h1><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lm"><img src="../Images/de33ef124b0619b453203ccb493cd181.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/0*WfI4xeR5L6vVkPIo.png"/></div></figure><p id="6d11" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">MongoDB是一个非结构化数据库。它以文档的形式存储数据。MongoDB能够非常高效地处理大量数据，并且是使用最广泛的NoSQL数据库，因为它提供了丰富的查询语言和灵活快速的数据访问。</p><p id="00a1" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">在进入本教程的核心之前，让我们花点时间来理解MongoDB数据库的架构。</p><h1 id="ed4d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">MongoDB数据库的体系结构</h1><ul class=""><li id="ca67" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">每个文档都是键值对的集合</li><li id="5282" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">每个键值对被称为一个<strong class="jf hj"> <em class="ln">字段</em> </strong></li><li id="c02a" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">每个文档都有一个<strong class="jf hj"> <em class="ln"> _id </em> </strong>字段，唯一标识文档</li><li id="67f7" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">文档也可以包含嵌套文档</li><li id="5e7b" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">文档可能有不同数量的字段(它们也可以是空白的)</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/dcddbfb488ab8370f0e8c80102c04e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*54ZJqD-Dw-LEvWUs.png"/></div></figure><p id="edea" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">与传统数据库不同，MongoDB中数据一般存储在单个集合中，因此没有联接的概念(除了<strong class="jf hj"> <em class="ln"> $lookup </em> </strong>运算符，它执行<strong class="jf hj"><em class="ln">left-outer-join</em></strong>like操作)。MongoDB拥有嵌套的文档。</p><h1 id="78b4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">2.理解问题陈述</h1><p id="0552" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">让我们来理解我们将在本教程中解决的问题。这将让您很好地了解可以选择哪些项目来进一步磨练您的MongoDB Python技能。</p><p id="62fc" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">假设您正在为一个向客户提供应用程序的银行系统工作。这个应用程序将数据发送到您的MongoDB数据库。这些数据存储在三个集合中:</p><ul class=""><li id="d4ed" class="jd je hi jf b jg kp ji kq jk kr jm ks jo kt jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">账户</em> </strong>集合包含所有账户的信息</li><li id="8347" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">客户</em> </strong>集合包含关于客户的信息</li><li id="03dd" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">最后，<strong class="jf hj"> <em class="ln">交易</em> </strong>集合包含客户交易数据</li></ul><p id="4575" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我从全球云数据库服务<a class="ae lk" href="https://docs.atlas.mongodb.com/sample-data/available-sample-datasets/" rel="noopener ugc nofollow" target="_blank"> MongoDB Atlas </a>中获取了本教程的样本数据库。我们将使用<strong class="jf hj"><em class="ln">【sample _ analytics】</em></strong>数据库来处理这个问题陈述。该数据库包含与金融服务相关的数据。</p><h1 id="20b7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">3.PyMongo是什么？</h1><blockquote class="lp lq lr"><p id="dcf4" class="ka kb ln jf b jg kp kc kd ji kq ke kf ls ku kh ki lt kv kk kl lu kw kn ko jq hb bi translated">PyMongo是一个Python库，它使我们能够与MongoDB连接。它允许我们在MongoDB数据库上执行基本操作。</p></blockquote><p id="776b" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">那么，<a class="ae lk" href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science" rel="noopener ugc nofollow" target="_blank">为什么是Python </a>？这是一个合理的问题。</p><p id="68cd" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们选择Python与MongoDB交互，因为它是最常用的语言之一，也是数据科学领域最强大的语言之一。PyMongo允许我们用类似字典的语法检索数据。</p><p id="51b2" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们还可以使用点符号来访问MongoDB数据。它简单的语法让我们的工作变得容易多了。此外，PyMongo丰富的文档总是助一臂之力。我们将使用这个库来访问MongoDB。</p><h1 id="21e5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">4.MongoDB安装指南</h1><p id="9d83" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">MongoDB可用于Linux、Windows和Mac OS X操作系统。</p><p id="6e58" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">如果您是Linux用户，请按照本视频中的说明进行操作:</p><p id="5e29" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">Mac用户可以看这个视频安装MongoDB:</p><p id="81f4" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">如果您想在Windows操作系统上安装MongoDB，请参考此视频:</p><p id="8b64" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">一旦你安装了数据库，你需要启动<strong class="jf hj"> <em class="ln"> mongod </em> </strong> <em class="ln"> </em>服务。如果你在安装过程中有任何问题，请在这篇文章下面的评论区联系我。</p><h1 id="0670" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.对MongoDB数据库的基本操作</h1><p id="2ef8" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">是时候启动您的Python笔记本并开始编码了！我们对MongoDB有一个很好的概念——让我们将这些知识付诸实践。</p><p id="18af" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们将使用PyMongo库在Python中的MongoDB数据库上执行一些关键的基本操作。</p><h1 id="dce2" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.1连接到数据库</h1><p id="508f" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">为了从MongoDB数据库中检索数据，我们将首先连接到它。在Jupyter单元中编写并执行以下代码，以便连接到MongoDB:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="1f12" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">让我们看看可用的数据库:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/5d6206fcd772f573ebbc2a1987bdcf4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*jQ6bkPPD5K_RxE8-.png"/></div></figure><p id="99e1" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们将使用<strong class="jf hj"> <em class="ln"> sample_analytics </em> </strong>数据库来实现我们的目的。让我们将光标设置到同一个数据库:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="814e" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated"><strong class="jf hj"><em class="ln">list _ collection _ names</em></strong>命令显示所有可用收藏的名称:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/b1ab9023c66a690c41ac45099b6776bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*f2rK_breL0Im8U0J.png"/></div></figure><p id="e13e" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">让我们看看我们有多少顾客。我们将连接到<strong class="jf hj"> <em class="ln">客户</em> </strong>集合，然后打印该集合中可用的文档数量:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="adc0" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated"><strong class="jf hj">输出:500 </strong></p><p id="e246" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">在这里，我们可以看到我们有500个客户的数据。接下来，我们将从这个表中获取一个MongoDB文档，并查看那里有什么信息。</p><h1 id="e376" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.2检索/获取数据</h1><p id="8511" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">我们可以使用类似字典的符号或PyMongo中的点运算符来查询MongoDB。在上一节中，我们使用了点操作符来访问MongoDB数据库。在这里，我们还将看到一个类似字典的语法演示。</p><p id="91df" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">首先，让我们从MongoDB集合中获取一个文档。为此我们将使用<strong class="jf hj"> <em class="ln"> find_one </em> </strong>函数:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/d3d1bf8e34bfd66dc03f90716dfc6613.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*48LG-wIvRjvGOPm4.png"/></div></figure><p id="6a88" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们可以看到函数返回了一个字典。让我们看看这本词典的检索表，然后我会解释每个检索表的用途。</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/5321b045c4a4a05bce6811539988766e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*rmVzJaV2QrHOn0WG.png"/></div></figure><p id="2858" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们可以看到一些键是不言自明的。让我解释一下每个键存储的内容:</p><ul class=""><li id="e987" class="jd je hi jf b jg kp ji kq jk kr jm ks jo kt jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">账户:</em> </strong>存储给定用户持有的所有账户列表。一个用户可以有多个帐户</li><li id="f628" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><strong class="jf hj"><em class="ln">teir _ and _ details:</em></strong><em class="ln"/>所属类别(白银、黄金等。)存储在此参数中。此字段还存储他们有权享受的福利</li></ul><p id="e403" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">现在，让我们看一个MongoDB的字典式访问的例子。让我们从MongoDB文档中获取客户的名称:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/8f1a7dcb357aa68c841b463742bee988.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*t1JdD9YWx4ZikyTp.png"/></div></figure><p id="dcf7" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们还可以使用<strong class="jf hj"> <em class="ln">查找</em> </strong>功能来获取文档。<strong class="jf hj"> <em class="ln"> find_one </em> </strong>一次只取一个文档。另一方面，<strong class="jf hj"> <em class="ln"> find </em> </strong>可以从MongoDB集合中获取多个文档:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><h1 id="25da" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.3插入功能</h1><p id="7333" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated"><strong class="jf hj"> <em class="ln"> insert_one </em> </strong>函数可以用来在MongoDB中一次插入一个文档。我们将首先创建一个字典，然后将其插入到MongoDB数据库中:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="49ed" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated"><strong class="jf hj">输出:</strong> qwertyui123456</p><blockquote class="lp lq lr"><p id="bfd4" class="ka kb ln jf b jg kp kc kd ji kq ke kf ls ku kh ki lt kv kk kl lu kw kn ko jq hb bi translated"><em class="hi"> MongoDB是一个非结构化的数据库，因此集合中的所有文档不必遵循相同的结构。</em></p></blockquote><p id="6a5f" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">例如，我们在上面的例子中插入的字典不包含我们在前面获取的MongoDB文档中看到的一些字段。</p><p id="9464" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated"><strong class="jf hj"> <em class="ln">。如果字典中没有提供，inserted_id </em> </strong>提供默认分配的<strong class="jf hj"> <em class="ln"> _id </em> </strong>字段。在我们的例子中，我们已经明确地提供了这个字段。最后，操作返回插入的MongoDB文档的<strong class="jf hj"> <em class="ln"> _id </em> </strong>。它存储在上述情况下的<strong class="jf hj"> <em class="ln"> post_id </em> </strong>变量中。</p><p id="085d" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">到目前为止，我们只能在MongoDB集合中插入一个文档。如果我们必须一次插入成千上万个文档，我们该怎么办？会循环运行<strong class="jf hj"> <em class="ln"> insert_one </em> </strong>吗？一点也不！</p><p id="37c5" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们有<strong class="jf hj"> <em class="ln"> insert_many </em> </strong>功能为此:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/7d4a6f231bba1edfe47ba85aba4762d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*lW_gZjHvF-N5pzZ1.png"/></div></figure><p id="c9f4" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们已经导入了<em class="ln"> datetime </em>库，因为Python中没有内置的日期和时间数据类型。这个库将帮助我们分配日期时间类型的值。在上面的例子中，我们在MongoDB数据库中插入了一个字典列表。每个元素都作为独立的文档插入到MongoDB集合中。</p><h1 id="36d7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.4过滤条件</h1><p id="8c14" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">之前我们已经向MongoDB集合中插入了一个文档，其<strong class="jf hj"> <em class="ln">名称</em> </strong>字段为Gyan。让我们看看如何使用过滤条件获取MongoDB文档:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/ac81055924b6713e86dbfc2ee680411e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*rS9B_mkQwR9i_1OW.png"/></div></figure><p id="21c5" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">如果我们对<strong class="jf hj"> <em class="ln"> _id </em> </strong>字段应用过滤条件，将不会返回任何内容，因为它们的数据类型是<strong class="jf hj"> <em class="ln"> ObjectId </em> </strong>。这不是内置的数据类型。我们需要将字符串值转换为<strong class="jf hj"><em class="ln">ObjectId</em></strong><em class="ln"/>类型，以在<strong class="jf hj"> <em class="ln"> _id </em> </strong>上应用过滤条件。首先，我们将定义一个函数来转换字符串值，然后我们将获取MongoDB文档:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/03091879c2b65d1746d68217790ce22e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*WUJU9wyMM0_0nRyG.png"/></div></figure><h1 id="e92f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.5删除</h1><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/9e0e4ca0df30cb8833d98877b556b761.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*EKFDpC3_Xlu8Pzz1.png"/></div></figure><p id="e80d" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们现在将删除这个MongoDB文档:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/f339972fbb019e70212c96ab186b476e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*2lH5KQO_NxjtS6lg.png"/></div></figure><p id="a13f" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">让我们试着在删除后取回这个文档。如果这个文档在我们的MongoDB集合中不可用，那么<strong class="jf hj"> <em class="ln"> find_one </em> </strong>函数将返回nothing。</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="4202" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated"><strong class="jf hj">输出:</strong> <em class="ln">不返回任何内容。</em></p><p id="96a9" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">由于我们没有得到任何回报，这意味着MongoDB文档不再存在。</p><p id="d473" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我们看到<strong class="jf hj"> <em class="ln"> insert_many </em> </strong>函数用于在MongoDB集合中插入多个文档，<strong class="jf hj"> <em class="ln"> delete_many </em> </strong>用于一次删除多个文档。让我们尝试通过<strong class="jf hj"> <em class="ln"> name </em> </strong>字段删除两个MongoDB文档:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="f78a" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">这里，deleted count存储了操作过程中删除的MongoDB文档的数量。<strong class="jf hj"> <em class="ln"> '$in' </em> </strong>是MongoDB中的一个操作符。</p><h1 id="d7d4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">5.6创建数据库和集合</h1><p id="f2c5" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">在MongoDB中，创建任何数据库和集合都是一个非常简单的过程。您可以使用检索的语法来做到这一点。如果你试图访问一个不存在的数据库，MongoDB会为你创建一个。</p><p id="83fe" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">让我们创建一个数据库和一个集合:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="a693" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">这里已经创建了MongoDB数据库，但是如果我们运行<strong class="jf hj"> <em class="ln"> list_database_names，</em> </strong>这个数据库将不会被列出。MongoDB不显示空数据库。因此，我们必须在那里插入一些东西。让我们在MongoDB集合中插入一个文档:</p><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/701d45a59e32c1f39d0cfd31e9decb4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*GWZy6OlhD_TidUnt.png"/></div></figure><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="a71b" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">现在我们可以看到我们的数据库在MongoDB数据库列表中可用。</p><h1 id="af46" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">6.将非结构化数据转换为结构化形式</h1><p id="a4ef" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">作为一名数据科学家，你不仅需要获取数据，还需要分析数据。以结构化形式存储数据简化了这项任务。在这一节中，我们将学习如何将从MongoDB获取的数据转换成结构化格式。</p><h1 id="1406" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">6.1存储到数据帧中</h1><p id="d5f4" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">find函数从MongoDB集合中返回一个字典。您可以直接将其插入数据帧。首先，让我们获取100个MongoDB文档，然后我们将这些文档存储到一个数据帧中:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lo"><img src="../Images/ebccb04ad3626dafc618ae3a3442c94d.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*WuZ643PsmxSr42YT.png"/></div></figure><p id="1613" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">这个数据帧的可读性远远好于函数返回的默认格式。</p><h1 id="397f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">6.2写入文件</h1><p id="e470" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated"><a class="ae lk" href="https://courses.analyticsvidhya.com/courses/pandas-for-data-analysis-in-python" rel="noopener ugc nofollow" target="_blank">熊猫数据帧</a>可以直接导出为CSV、Excel或SQL。让我们尝试将这些数据存储到一个CSV文件中:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="428e" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">同样，您可以使用<strong class="jf hj"> <em class="ln"> to_sql </em> </strong>函数将数据导出到sql数据库中。</p><h1 id="1377" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">7.一些其他有用的MongoDB函数</h1><p id="39c1" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">您已经积累了足够的知识，可以开始使用MongoDB了！到目前为止，我们已经用例子讨论了所有的基本操作。我们也了解了MongoDB的几个理论概念。</p><p id="4ee6" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">在我结束这篇文章之前，让我分享PyMongo的几个有用的功能:</p><ul class=""><li id="1be0" class="jd je hi jf b jg kp ji kq jk kr jm ks jo kt jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">排序:</em> </strong>我们已经看到了这个函数的例子。此功能的目的是对文档进行排序</li><li id="6016" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">限制:</em> </strong>该函数限制find函数获取的MongoDB文档的数量</li></ul><p id="12e2" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">您可以在这里查看更多MongoDB函数。</p><h1 id="513d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">8.下一步是什么？</h1><p id="2385" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">一旦您掌握了我们在本教程中介绍的概念，您应该学习与MongoDB相关的更高级的主题。让我来定义一些高级主题:</p><ul class=""><li id="8df5" class="jd je hi jf b jg kp ji kq jk kr jm ks jo kt jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">索引:</em> </strong>索引是在MongoDB中对集合的某个属性(字段)创建一个的过程。这使得检索过程更快。在没有索引的集合中，当您试图根据字段上的给定条件过滤出特定文档时，它将扫描整个数据库。如果有数以亿计的文档，这个过程需要时间。索引后，MongoDB使用大量内存来存储索引信息。该索引允许您根据过滤条件跳转到特定的文档，而无需扫描整个数据库</li><li id="3c99" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">分片:</em> </strong>跨多台机器存储数据的过程称为分片。分片有助于数据库的水平扩展</li><li id="6252" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated"><strong class="jf hj"> <em class="ln">运算符:</em> </strong>我们已经在MongoDB中看到了<strong class="jf hj"> <em class="ln"> $in </em> </strong>运算符。还有其他几个有用的运算符，它们执行一些特定的功能</li></ul><h1 id="29bd" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结束注释</h1><p id="82eb" class="pw-post-body-paragraph ka kb hi jf b jg jh kc kd ji jj ke kf jk kg kh ki jm kj kk kl jo km kn ko jq hb bi translated">在本文中，我们学习了MongoDB的所有基本概念。这足以让您在非结构化数据库方面有一个坚实的开端。</p><p id="aec5" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">我鼓励你自己尝试，并在评论区分享你的经验。此外，如果你对以上任何一个概念有任何问题，欢迎在下面的评论中问我。</p><p id="83c1" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">感谢阅读，继续学习！</p><p id="8944" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated">你也可以在分析Vidhya的Android应用上阅读这篇文章</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lx"><img src="../Images/a502510b4888112463522f78aa52b9a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/0*VN5d5WQGVlPHODIL.png"/></div></div></figure></div><div class="ab cl ly lz gp ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="hb hc hd he hf"><p id="1f0f" class="pw-post-body-paragraph ka kb hi jf b jg kp kc kd ji kq ke kf jk ku kh ki jm kv kk kl jo kw kn ko jq hb bi translated"><em class="ln">原载于2020年2月20日https://www.analyticsvidhya.com</em><a class="ae lk" href="https://www.analyticsvidhya.com/blog/2020/02/mongodb-in-python-tutorial-for-beginners-using-pymongo/" rel="noopener ugc nofollow" target="_blank"><em class="ln"/></a><em class="ln">。</em></p></div></div>    
</body>
</html>