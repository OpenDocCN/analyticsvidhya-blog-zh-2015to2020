<html>
<head>
<title>Artificial Neural Network Explained with an Regression Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用回归实例说明人工神经网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/artificial-neural-network-explained-with-an-regression-example-9e60c3efa624?source=collection_archive---------7-----------------------#2020-11-23">https://medium.com/analytics-vidhya/artificial-neural-network-explained-with-an-regression-example-9e60c3efa624?source=collection_archive---------7-----------------------#2020-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2ff4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将讨论实现一个简单的人工神经网络(ANN)的基础知识。</p><p id="5ee3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建议了解一下人工神经元是如何模仿人脑神经元的。请阅读<a class="ae jd" href="https://devskrol.com/index.php/2020/11/08/how-neurons-work-and-how-artificial-neuron-mimics-neurons-in-human-brain/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>以便于理解。如果你很想了解安的历史，请查看<a class="ae jd" href="https://devskrol.com/index.php/2020/11/07/artificial-intelligence-a-brief-introduction-and-history-of-deep-learning/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。</p><h1 id="41eb" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">人工神经网络的体系结构:</h1><p id="b34c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">人工神经网络的结构包含 4 个主要部分。</p><p id="d222" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输入层接收输入:</strong></p><p id="78ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入层是一组节点，每个节点将输入数据视为一个节点。对于一个回归问题，如果我们有 10 个列/特征，那么我们需要在输入层设置 10 个节点。</p><p id="e828" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">隐藏图层:</strong></p><p id="32f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个 ANN 可以有一个或多个隐藏层。每层可以有任意数量的神经元。每个神经元都是一个计算单元和一个激活单元的组合。</p><p id="2244" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输出层:</strong></p><p id="8382" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个人工神经网络有一个输出层，提供模型的输出。</p><p id="b5ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果模型是回归，那么输出层将只有一个节点。此节点的输出是输入图层中给定输入的 Y 预测值。</p><p id="10f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果目标变量是两个类的分类数据，那么输出层应该有 2 个节点，激活函数应该是“Sigmoid”。</p><p id="e4ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果是多类分类，那么输出层的节点应该与目标变量的类的数量完全相同。并且激活功能应该是“Softmax”。</p><p id="175b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果激活函数是 Sigmoid 或 Softmax，我们将从输出层的所有节点中获取概率值。最大概率值的索引是输出。</p><p id="8966" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要将 Y 值转换为分类数据，</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="f17b" class="kq jf hi km b fi kr ks l kt ku">y_data = to_categorical(y_data</span></pre><p id="b995" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想找到一个示例模型，那么访问<a class="ae jd" href="https://devskrol.com/2021/01/16/deep-learning-classification/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">深度学习—分类示例</strong> </a>。</p><p id="fc84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">权重&amp;偏差:</strong></p><p id="b852" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图中提到的每个连接都分配了权重和偏差。权重值最初是随机分配的，并将由优化器在每个时期进行更新。偏差值用于避免权重变为零</p><h1 id="065e" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">构建人工神经网络的 API:</h1><p id="fd5e" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">有许多 API 可用于构建人工神经网络。</p><p id="4a08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最流行的 API 是 Google 的 TensorFlow。它与 Python &amp; Numpy 接口。</p><p id="7606" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 Tensorflow 的基础上还开发了其他一些 API，使其更易于使用。一个这样的</p><p id="9866" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">API 是 Keras。在这篇文章中，我们将使用 Keras。</p><h1 id="cc5c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">Keras 中用于构造 ANN 的重要类:</h1><p id="13aa" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">Squential()类有助于对层的线性堆栈进行分组。这个类返回一个模型对象，可以用来添加更多的层。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="dba6" class="kq jf hi km b fi kr ks l kt ku">from keras.models import Sequential<br/>model = Sequential()</span></pre><p id="1b3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">Dense()类实现了一个层。</strong></p><p id="16d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它可用于输入、隐藏和输出层。</p><p id="6ec7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">隐藏层和输出层中的密集节点将从每个连接中获得一个权重，并计算(权重*输入)+偏差。来自所有连接的所有结果将被加在一起，并作为输出提供给下一层的神经元。</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kv"><img src="../Images/545f470e960fed6014769b1ba772cb19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HHHV17aloND3mu1WT8q-5g.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">来源:图片由 devskrol.com 作者提供</figcaption></figure><p id="0a2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，如果我们的数据有两个特征年龄和支出，其值为 30 &amp; 8，工资为 40，000，那么特征 30 &amp; 8 将作为输入层节点的输入。</p><p id="07cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据上图，权重和偏差值将被随机分配。</p><p id="e27e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经元中的计算:</p><p id="a2e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">A = (30 <em class="lh"> 2 + 0) + (8 </em> 3 + 0) = 84</p><p id="5d39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">B = (30 <em class="lh"> 1 + 0) + (8 </em> 1 + 0) = 38</p><p id="b06c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出= (84 <em class="lh"> 1 + 0) + (38 </em> 2 + 0) = 160</p><p id="8d94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">160 是第一前馈过程的输出。</p><p id="d115" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该值与薪金列值 40，000 不匹配。</p><p id="d5d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要获得 40，000 的输出，权重将在反向传播过程中更新。</p><p id="3d05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，指定的优化器(例如:梯度下降、Adam 等)将负责这个过程。</p><p id="58a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，权重 w5 和 w6 将被更新。那么将更新下一组权重 w1、w2、w3 和 w4。</p><p id="d1ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于下一个数据，这种情况和前馈将再次发生。</p><p id="452d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，对于剩余的数据和时期，权重和偏差将被更新。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="257c" class="kq jf hi km b fi kr ks l kt ku">from keras.layers import Dense</span><span id="0efa" class="kq jf hi km b fi li ks l kt ku">model = Sequential()</span><span id="05d5" class="kq jf hi km b fi li ks l kt ku">model.add(Dense(2, input_shape = (2,), activation= 'sigmoid'))<br/>model.add(Dense(10, activation= 'sigmoid'))<br/>model.add(Dense(10, activation= 'sigmoid'))<br/>model.add(Dense(1))</span></pre><p id="6010" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们的模型的架构已经构建好了。</p><p id="06b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要为反向传播选择正确的损失函数和优化器。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="12d6" class="kq jf hi km b fi kr ks l kt ku">from keras import optimizers</span><span id="f654" class="kq jf hi km b fi li ks l kt ku">sgd = optimizers.SGD()</span><span id="56ac" class="kq jf hi km b fi li ks l kt ku">model.compile(optimizer = sgd, loss = 'mean_squared_error', metrics= ['mse', 'mae'])<br/>model.summary()</span></pre><p id="e390" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="3177" class="kq jf hi km b fi kr ks l kt ku">Model: "sequential"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>dense (Dense)                (None, 20)                280       <br/>_________________________________________________________________<br/>dense_1 (Dense)              (None, 10)                210       <br/>_________________________________________________________________<br/>dense_2 (Dense)              (None, 10)                110       <br/>_________________________________________________________________<br/>dense_3 (Dense)              (None, 1)                 11        <br/>=================================================================<br/>Total params: 611<br/>Trainable params: 611<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><p id="8a3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的总结中，我们可以看到“可训练参数:611 ”,这意味着上述网络的权重和偏差总共是 611。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="cd7f" class="kq jf hi km b fi kr ks l kt ku">model.fit(X_train, Y_train, batch_size= 40, epochs=100, verbose= 0)<br/>train_pred = model.predict(X_train)<br/>test_pred = model.predict(X_test)</span><span id="36e5" class="kq jf hi km b fi li ks l kt ku">from sklearn.metrics import mean_squared_error, mean_absolute_error</span><span id="84a3" class="kq jf hi km b fi li ks l kt ku">print("Train Accuracy: ",mean_squared_error(Y_train, train_pred))<br/>print("Test Accuracy: ",mean_squared_error(Y_test, test_pred))</span></pre><p id="47c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="1742" class="kq jf hi km b fi kr ks l kt ku">Train Accuracy:  85.60549570539762<br/>Test Accuracy:  86.0492232511959</span></pre><h1 id="f814" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结论:</h1><p id="8a56" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在本文中，我们已经看到了人工神经网络的体系结构及其工作原理。在下一篇文章中，我们将看到一个完整的回归示例。</p><p id="ee9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您阅读我们的文章，希望您喜欢。😊</p><p id="5e71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">喜欢支持？只需点击喜欢按钮❤️.</p><p id="a369" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐学习！👩‍💻</p><h1 id="3613" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">您还希望:</h1><ol class=""><li id="8165" class="lj lk hi ih b ii kc im kd iq ll iu lm iy ln jc lo lp lq lr bi translated"><a class="ae jd" href="https://devskrol.com/2021/01/16/deep-learning-classification/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">深度学习—分类示例</strong> </a></li><li id="21b1" class="lj lk hi ih b ii ls im lt iq lu iu lv iy lw jc lo lp lq lr bi translated"><a class="ae jd" href="https://devskrol.com/2020/11/07/artificial-intelligence-a-brief-introduction-and-history-of-deep-learning/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">人工智能—深度学习简介及历史</strong> </a></li><li id="d9fa" class="lj lk hi ih b ii ls im lt iq lu iu lv iy lw jc lo lp lq lr bi translated"><a class="ae jd" href="https://devskrol.com/2020/09/12/what-are-the-loss-functions-for-a-deep-learning-model/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">深度学习模型的损失函数有哪些？</strong> </a></li><li id="10a4" class="lj lk hi ih b ii ls im lt iq lu iu lv iy lw jc lo lp lq lr bi translated"><a class="ae jd" href="https://devskrol.com/2020/09/05/optimizer-in-neural-network/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">神经网络中的优化器</strong> </a></li></ol></div></div>    
</body>
</html>