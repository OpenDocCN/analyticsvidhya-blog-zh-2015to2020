<html>
<head>
<title>Bank Customer Analysis Using ANN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于人工神经网络的银行客户分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bank-customer-analysis-using-ann-6125f31de24d?source=collection_archive---------12-----------------------#2020-12-10">https://medium.com/analytics-vidhya/bank-customer-analysis-using-ann-6125f31de24d?source=collection_archive---------12-----------------------#2020-12-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/8671f60382e4667a9d2bf3798a5d10d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijMQIcAJlXsNspOm0Sqibg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">图片来源:作者</figcaption></figure><div class=""/><div class=""><h2 id="fa44" class="pw-subtitle-paragraph iu hw hx bd b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl dx translated">预测将离开银行的客户</h2></div></div><div class="ab cl jm jn gp jo" role="separator"><span class="jp bw bk jq jr js"/><span class="jp bw bk jq jr js"/><span class="jp bw bk jq jr"/></div><div class="hb hc hd he hf"><p id="aaf0" class="pw-post-body-paragraph jt ju hx jv b jw jx iy jy jz ka jb kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi kp translated"><span class="l kq kr ks bm kt ku kv kw kx di"> T </span>本博客的目的是设计一个<strong class="jv hy">深度学习</strong>模型，即一个<strong class="jv hy">人工神经网络</strong>模型，来预测银行<strong class="jv hy"> <em class="ky">的客户是否会留在银行</em> </strong> <em class="ky"> </em>或者他们是否会<em class="ky"> </em> <strong class="jv hy"> <em class="ky">离开</em> </strong>银行及其服务。</p><h1 id="52a3" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">探索数据集</h1><blockquote class="lr ls lt"><p id="6621" class="jt ju ky jv b jw jx iy jy jz ka jb kb lu kd ke kf lv kh ki kj lw kl km kn ko hb bi translated">我们将使用的数据集是<strong class="jv hy"> ChurnData.csv </strong>来执行统计测试和预测建模，该数据集包含位于<em class="hx">法</em>、<em class="hx">西</em>和<em class="hx">德</em>等国家的银行客户的详细信息。由<strong class="jv hy">万行</strong>和<strong class="jv hy"> 14列</strong>组成。</p><p id="0712" class="jt ju ky jv b jw jx iy jy jz ka jb kb lu kd ke kf lv kh ki kj lw kl km kn ko hb bi translated">我们的目标变量是一个名为<strong class="jv hy"> Exit </strong>的列，它表示客户是否已经离开银行，即(0或1)。</p></blockquote><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="af6e" class="mg la hx mc b fi mh mi l mj mk">#Impporting Libraries<br/><strong class="mc hy">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import time</strong></span><span id="fe2d" class="mg la hx mc b fi ml mi l mj mk">#Reading The Data<br/><strong class="mc hy">ann_data = pd.read_csv("Churn_modelling.csv")<br/>ann_data.head()</strong></span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mm"><img src="../Images/5500e1915383c3a9a56dd4fdded2d537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KThkKgplhyPmGwXIJ0eZAA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">我</figcaption></figure><h1 id="3c05" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">探索性数据分析</h1><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es mn"><img src="../Images/ad056b14d5f940e4ba25b1fc500ef9d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*_IeuE7xZLLaIHnHpyoaY5A.png"/></div></figure><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="d41f" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">ann_data.describe() </strong>#Statistical summary of dataset</span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/a0b87688f3466b814ad9ca0cc6697ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FEi-7XSlyFvYUidLUTlXYA.png"/></div></div></figure><h1 id="3b11" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">使用Seaborn &amp; Matplotlib进行可视化</h1><h2 id="ee80" class="mg la hx bd lb mp mq mr lf ms mt mu lj kc mv mw ll kg mx my ln kk mz na lp nb bi translated">1.配对图</h2><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="b54d" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">sns.pairplot(data = ann, hue = "Exited") </strong>#pairplot</span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nc"><img src="../Images/96e278e20c2bd95c7bea461019972d6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wgq7_RZ5QZWJr710m75Kkg.png"/></div></div></figure><h2 id="75bf" class="mg la hx bd lb mp mq mr lf ms mt mu lj kc mv mw ll kg mx my ln kk mz na lp nb bi translated">2.目标变量与特征:</h2><p id="c8ee" class="pw-post-body-paragraph jt ju hx jv b jw nd iy jy jz ne jb kb kc nf ke kf kg ng ki kj kk nh km kn ko hb bi translated"><strong class="jv hy"> a) <em class="ky">目标变量Vs年龄:</em> </strong></p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="1241" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">sns.boxplot(x="Exited", y="Age", data=ann) </strong>#boxplot</span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es mn"><img src="../Images/9175ff9c46d07f70d9c5fea6d73c9774.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*L5f3nOXiBU-UYvCT-eDxHw.png"/></div></figure><p id="5b5b" class="pw-post-body-paragraph jt ju hx jv b jw jx iy jy jz ka jb kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated"><strong class="jv hy"> b) <em class="ky">目标变量Vs NumOfProducts: </em> </strong></p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="cebc" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">sns.violinplot(x="Exited",y="NumOfProducts",data=ann,palette="Set1")</strong></span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es ni"><img src="../Images/52f2a2981ce7cbcc1a7a3cc1bf53e9ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*5VufC0q3m9j4Xak_jRC8Qw.png"/></div></figure><p id="b84f" class="pw-post-body-paragraph jt ju hx jv b jw jx iy jy jz ka jb kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated">c <strong class="jv hy"> ) <em class="ky">目标变量Vs地理:</em> </strong></p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="0f58" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">sns.boxplot(x="Geography", y="Exited", data=ann) </strong>#Bargraph</span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es ni"><img src="../Images/451fe296cfa4ebb58847e56a47407c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*GV6vS0KlBf4cY2Yd09IjWA.png"/></div></figure><h2 id="e5b6" class="mg la hx bd lb mp mq mr lf ms mt mu lj kc mv mw ll kg mx my ln kk mz na lp nb bi translated">3.相关图:热图</h2><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="ac1b" class="mg la hx mc b fi mh mi l mj mk">#Correlation between all variables using Heatmap<strong class="mc hy"><br/>corr = ann.corr()<br/>ax = sns.heatmap(corr,annot=True,cmap='RdYlGn',linewidths=0.1,annot_kws={'size':12})<br/>bottom, top = ax.get_ylim()<br/>ax.set_ylim(bottom + 0.5, top - 0.5)<br/>fig=plt.gcf()<br/>fig.set_size_inches(12,10)<br/>plt.xticks(fontsize=12)<br/>plt.yticks(fontsize=12)<br/>plt.show()</strong></span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nj"><img src="../Images/9a6b4f03fab221241f8e5802cb8217d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0kNXGoWQQLPNgWV_Ala-pg.png"/></div></div></figure><h1 id="8e04" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">编码分类数据</h1><blockquote class="lr ls lt"><p id="9748" class="jt ju ky jv b jw jx iy jy jz ka jb kb lu kd ke kf lv kh ki kj lw kl km kn ko hb bi translated">使用<strong class="jv hy"> pandas </strong>库的<strong class="jv hy"><em class="hx">get _ dummies()</em></strong>函数将<strong class="jv hy">分类</strong>数据转换为<strong class="jv hy">数字</strong>格式，以便机器能够理解数据，并将其插入<strong class="jv hy"> ANN模型</strong>进行训练和预测。</p></blockquote><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="259b" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">ann1 = pd.get_dummies(ann)</strong> #encoding the data</span></pre><h1 id="a208" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">拆分数据</h1><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="c356" class="mg la hx mc b fi mh mi l mj mk">#Input and output variable<br/><strong class="mc hy">X = ann1.iloc[:, 3:13].values<br/>y = ann1.iloc[:, 13].values<br/>X, y</strong></span><span id="9284" class="mg la hx mc b fi ml mi l mj mk">#Spliting using scikitlearn<br/><strong class="mc hy">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)</strong></span></pre><h1 id="d579" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">预处理(缩放数据)</h1><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="f6eb" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">from sklearn.preprocessing import StandardScaler<br/>sc = StandardScaler()<br/>X_train = sc.fit_transform(X_train)<br/>X_test = sc.transform(X_test)</strong></span></pre><h1 id="2ebe" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">建立人工神经网络(ANN)</h1><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="10fe" class="mg la hx mc b fi mh mi l mj mk"><strong class="mc hy">import keras<br/>from tensorflow.keras.models import Sequential<br/>from tensorflow.keras.layers import Dense</strong></span><span id="99a7" class="mg la hx mc b fi ml mi l mj mk"># Initialising the ANN<br/><strong class="mc hy">classifier = Sequential()</strong></span><span id="f319" class="mg la hx mc b fi ml mi l mj mk"># Adding the input layer and the first hidden layer<br/><strong class="mc hy">classifier.add(Dense(units = 6, kernel_initializer = 'uniform', activation = 'relu', input_dim = 10))</strong></span><span id="b19b" class="mg la hx mc b fi ml mi l mj mk"># Adding the second hidden layer<br/><strong class="mc hy">classifier.add(Dense(units = 6, kernel_initializer = 'uniform', activation = 'relu'))</strong></span><span id="2a8f" class="mg la hx mc b fi ml mi l mj mk"># Adding the output layer<br/><strong class="mc hy">classifier.add(Dense(units = 1, kernel_initializer = 'uniform', activation = 'sigmoid'))</strong></span><span id="3c8c" class="mg la hx mc b fi ml mi l mj mk"># Compiling the ANN<br/><strong class="mc hy">classifier.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])</strong></span><span id="e259" class="mg la hx mc b fi ml mi l mj mk"># Fitting the ANN to the Training set<br/><strong class="mc hy">classifier.fit(X_train, y_train, batch_size = 10, epochs = 200)</strong></span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nk"><img src="../Images/110c93b13933b22460d31d1ec5ec1334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQRoPNdzK7ugU_IT8XWYLA.png"/></div></div></figure><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="96af" class="mg la hx mc b fi mh mi l mj mk"># Predicting the Test set results<br/><strong class="mc hy">y_pred = classifier.predict(X_test)<br/>y_pred = (y_pred &gt; 0.5)</strong></span></pre><h1 id="f9c2" class="kz la hx bd lb lc ld le lf lg lh li lj jd lk je ll jg lm jh ln jj lo jk lp lq bi translated">混淆矩阵(最终预测可视化)</h1><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="8f42" class="mg la hx mc b fi mh mi l mj mk"># Building the Confusion Matrix using Heatmap for visualizing predictions<br/><strong class="mc hy">from sklearn.metrics import confusion_matrix<br/>from sklearn.metrics import precision_recall_fscore_support as score</strong></span><span id="5658" class="mg la hx mc b fi ml mi l mj mk"><strong class="mc hy">cm = confusion_matrix(y_test, y_pred)</strong></span><span id="b3bc" class="mg la hx mc b fi ml mi l mj mk"><strong class="mc hy">ax = sns.heatmap(cm,annot=True,cmap='RdYlGn',linewidths=0.1,annot_kws={'size':12})<br/>bottom, top = ax.get_ylim()<br/>ax.set_ylim(bottom + 0, top - 0)<br/>fig=plt.gcf()<br/>fig.set_size_inches(12,10)<br/>plt.xticks(fontsize=12)<br/>plt.yticks(fontsize=12)<br/>plt.show()</strong></span></pre><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es nl"><img src="../Images/c5410faecc73d787dc8ede66d0f51d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*9TlfOZNKT5_wssEtOKxgtA.png"/></div></figure><blockquote class="lr ls lt"><p id="601e" class="jt ju ky jv b jw jx iy jy jz ka jb kb lu kd ke kf lv kh ki kj lw kl km kn ko hb bi translated"><strong class="jv hy">准确率:100% </strong></p></blockquote><blockquote class="nm"><p id="3b7a" class="nn no hx bd np nq nr ns nt nu nv ko dx translated"><strong class="ak">如你所见，混淆矩阵中没有错误分类的样本。因此，准确度得分= 0.1 </strong></p></blockquote><h1 id="3990" class="kz la hx bd lb lc ld le lf lg lh li lj jd nw je ll jg nx jh ln jj ny jk lp lq bi translated">密码</h1><p id="28f0" class="pw-post-body-paragraph jt ju hx jv b jw nd iy jy jz ne jb kb kc nf ke kf kg ng ki kj kk nh km kn ko hb bi translated"><a class="ae nz" href="https://github.com/Sk70249/Bank-Customer-Analysis-using-Artificial-Neural-Network" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hy">点击此处</strong> </a> <strong class="jv hy"> : </strong>进行代码交互，访问我的<a class="ae nz" href="https://github.com/Sk70249" rel="noopener ugc nofollow" target="_blank"><strong class="jv hy">Github Repositor</strong></a><strong class="jv hy"/>获取更多suck项目。</p></div><div class="ab cl jm jn gp jo" role="separator"><span class="jp bw bk jq jr js"/><span class="jp bw bk jq jr js"/><span class="jp bw bk jq jr"/></div><div class="hb hc hd he hf"><h1 id="c996" class="kz la hx bd lb lc oa le lf lg ob li lj jd oc je ll jg od jh ln jj oe jk lp lq bi translated">感谢您的阅读</h1><p id="ac99" class="pw-post-body-paragraph jt ju hx jv b jw nd iy jy jz ne jb kb kc nf ke kf kg ng ki kj kk nh km kn ko hb bi translated">更多深度学习和神经网络相关的此类内容和知识<a class="ae nz" rel="noopener" href="/@kalamanoj989"> <strong class="jv hy"> <em class="ky">点击这里</em> </strong> </a></p></div></div>    
</body>
</html>