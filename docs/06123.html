<html>
<head>
<title>Multiple Linear Regression Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元线性回归解释</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multiple-linear-regression-explained-215f2683cd5a?source=collection_archive---------7-----------------------#2020-05-12">https://medium.com/analytics-vidhya/multiple-linear-regression-explained-215f2683cd5a?source=collection_archive---------7-----------------------#2020-05-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/97364f39c18851cde1b91e432e1991f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nxNuCnzfUYyDEvjsz3s74A.png"/></div></div></figure><h2 id="ff5a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">什么是多元线性回归？</h2><p id="2248" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">在统计学中，线性回归是一种建模标量响应与一个或多个解释变量之间关系的线性方法。只有一个解释变量的情况称为简单线性回归。对于一个以上的解释变量，这个过程被称为多元线性回归。</p><p id="524a" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">从本质上说，多元回归是普通最小二乘(OLS)回归的延伸，涉及一个以上的解释变量。</p><p id="9e51" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">数学表达式是:</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/86b4ec30b270d91f345065908a40894a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*UG5Tb19HVj__78ifl37P3g.png"/></div></figure><p id="76af" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">在使用多元线性回归之前，做出以下假设:</p><ol class=""><li id="7b2d" class="kt ku hi jq b jr kj jv kk jb kv jf kw jj kx ki ky kz la lb bi translated">因变量和自变量之间存在线性关系。</li><li id="9f34" class="kt ku hi jq b jr lc jv ld jb le jf lf jj lg ki ky kz la lb bi translated">独立个体之间相关性不高。</li><li id="183b" class="kt ku hi jq b jr lc jv ld jb le jf lf jj lg ki ky kz la lb bi translated">因变量是从数据集中随机选取的</li><li id="f68d" class="kt ku hi jq b jr lc jv ld jb le jf lf jj lg ki ky kz la lb bi translated"><a class="ae lh" href="https://stattrek.com/statistics/dictionary.aspx?definition=residual" rel="noopener ugc nofollow" target="_blank">残差</a>呈正态分布。</li></ol><h1 id="1219" class="li ir hi bd is lj lk ll iw lm ln lo ja lp lq lr je ls lt lu ji lv lw lx jm ly bi translated">让我们举一个可以使用多元回归的例子:</h1><p id="bc1e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">假设您有一个包含身高、体重和身体质量指数的数据集。因此，现在您希望找到数据之间的相关性，并使用身高和体重找到身体质量指数。</p><p id="1b6d" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">身体质量指数的数学公式=体重/(身高米)**2</p><h2 id="3b17" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">参考上面的MLR等式，在我们的示例中:</h2><p id="6fc5" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">易<strong class="jq hj"> = </strong>因变量()</p><p id="c11c" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">Xi1 =独立变量(以米为单位的高度)</p><p id="75ca" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">Xi2 =独立变量(以千克为单位的重量)</p><p id="a227" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">B0 =时间零点的y轴截距</p><p id="10b0" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">B1 = <a class="ae lh" href="https://www.investopedia.com/terms/r/regression.asp" rel="noopener ugc nofollow" target="_blank">回归系数</a>，测量xi1变化时因变量的单位变化。</p><p id="441a" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">B2 =当Xi2变化时，测量因变量单位变化的系数值</p><p id="ff08" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">最小二乘估计B0，B1，B2…Bp通常由统计软件计算。回归模型中可以包含许多变量，其中每个独立变量都用数字-1，2，3，4…p来区分。多元回归模型允许分析师根据多个解释变量提供的信息来预测结果。</p><p id="c97c" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">尽管如此，该模型并不总是完全准确的，因为每个数据点都可能与模型预测的结果略有不同。剩余值E是实际结果和预测结果之间的差异，它被包括在模型中以考虑这种微小的变化。</p><h1 id="f325" class="li ir hi bd is lj lk ll iw lm ln lo ja lp lq lr je ls lt lu ji lv lw lx jm ly bi translated">让我们开始编码吧</h1><p id="3e94" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">我们今天使用的数据集在kaggle上，这是链接</p><div class="lz ma ez fb mb mc"><a href="https://www.kaggle.com/yersever/500-person-gender-height-weight-bodymassindex" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hj fi z dy mh ea eb mi ed ef hh bi translated">500人性别-身高-体重-体重指数</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">随机生成身高和体重，计算体重指数</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">www.kaggle.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq io mc"/></div></div></a></div><p id="c770" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">实际数据集包含4列，它们是性别、身高(厘米)、体重(千克)和指数。</p><p id="67c0" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">如果您仔细观察数据，就会发现索引列不包含身体质量指数值。它将他们分为</p><p id="2b36" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">索引:</p><p id="447e" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">0 —非常弱</p><p id="ba12" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">1 —弱</p><p id="6389" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">2-正常</p><p id="0786" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">3 —超重</p><p id="5b41" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">4 —肥胖</p><p id="c361" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">5 —极度肥胖</p><p id="eb74" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">所以现在我们有两件事要做</p><ol class=""><li id="7f2f" class="kt ku hi jq b jr kj jv kk jb kv jf kw jj kx ki ky kz la lb bi translated">创建新列或将高度更改为米</li><li id="8759" class="kt ku hi jq b jr lc jv ld jb le jf lf jj lg ki ky kz la lb bi translated">用身体质量指数值创建新列</li></ol><figure class="kp kq kr ks fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="12bd" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">在尝试运行上述代码之前，请确保将csv数据读入“data”数据帧。</p><p id="6fe0" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">现在让我们选择多元回归所需的列，并将它们存储在另一个数据框中</p><figure class="kp kq kr ks fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/b9c73c086257b816d558a3cb1b17d72f.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*KBu7QyPVzvjek49QEqJC-g.png"/></div></figure><p id="566c" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">现在我们有一个从属列(身体质量指数)和两个独立列(体重、身高_米)。</p><p id="5f18" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">因此，在创建回归模型和数据之前，您必须确保将数据分为训练集和测试集，以便模型不会因数据过多而导致错误的预测。</p><figure class="kp kq kr ks fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="862e" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">接下来，创建模型，并将训练数据拟合到模型中。</p><figure class="kp kq kr ks fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="17a7" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">训练模型后，我们可以预测X_test并将其与真实值进行比较。</p><p id="aca7" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">步骤1:将预测值存储到一个变量中</p><figure class="kp kq kr ks fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="9aab" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">步骤2:用y_test和predcited值创建一个数据帧</p><figure class="kp kq kr ks fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="9126" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">这就创建了一个这样的数据框</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/80c09a41d4dc2985c1152aa2ab96a120.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*43BTf-13lx7n9hAO0lnHzg.png"/></div></figure><p id="8cac" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">现在我们可以在实际值和预测值之间进行可视化</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/e9637267d21218c78ba5e2ad184ee6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L2eZ2JRRr14BXh-lAJV1BA.png"/></div></div><figcaption class="mw mx et er es my mz bd b be z dx translated">前5个值比较</figcaption></figure><p id="dc72" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">测试数据集上的模型得分为97 %,这意味着身体质量指数值随着自变量的变化而变化。</p><h2 id="9229" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h2><p id="c62c" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">在本文中，我们研究了最基本的机器学习算法，即线性回归。我们在Scikit-Learn机器学习库的帮助下实现了多元线性回归。</p><p id="1a33" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">我希望你们喜欢这本书。请在评论区告诉我你的疑问/建议。</p></div></div>    
</body>
</html>