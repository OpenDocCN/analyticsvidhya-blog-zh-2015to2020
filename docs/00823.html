<html>
<head>
<title>Wine Classification and Recommendation by Tasting Notes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">根据品酒笔记进行葡萄酒分类和推荐</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/text-analytics-wine-classification-and-recommendation-by-tasting-notes-6657733fd60d?source=collection_archive---------3-----------------------#2019-09-11">https://medium.com/analytics-vidhya/text-analytics-wine-classification-and-recommendation-by-tasting-notes-6657733fd60d?source=collection_archive---------3-----------------------#2019-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="276e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">基于R的文本挖掘和分类</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f8a9caa3175a7b879176e3cadd7da612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTX16IwXmmOMLKoQcf-s5w.jpeg"/></div></div></figure><p id="8a42" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">简介</strong></p><p id="3caa" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">葡萄酒的选择是复杂和个人化的。你爱的人不一定取决于收视率或价格。看你个人口味了。作为一个葡萄酒爱好者，我总是被葡萄酒商店或餐厅的大量选择所淹没。</p><p id="dbb1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果你可以有一个虚拟的个人侍酒师，他可以根据你的口味或你已经尝试过的葡萄酒推荐合适的葡萄酒，会怎么样？就像侍酒师如何为你推荐葡萄酒一样，这个项目旨在通过分析品尝记录来对葡萄酒品种进行分类并识别相似的葡萄酒。</p><p id="9e40" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我用的数据集是扎克特·https://www.kaggle.com/zynicide/wine-reviews的<a class="ae kf" href="https://www.kaggle.com/zynicide/wine-reviews" rel="noopener ugc nofollow" target="_blank"/>。它包含130，000条葡萄酒评论，有14个变量，如品种、地点、酒厂、价格和描述。</p><p id="d409" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">探索数据</strong></p><p id="e431" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">您可以看到该数据集拥有来自美国加利福尼亚州的最大数量。价格和积分在其他地区中处于平均水平。与加州相比，美国俄勒冈州和华盛顿州的葡萄酒似乎质量更高，但价格更低。法国勃艮第拥有平均价格和平均点数最高的高端葡萄酒。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kg"><img src="../Images/81f4e445ba3ba6868e50b48da1c5ab97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R6MGjoxs47wB72v-DJSZ8Q.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">葡萄酒产区概述</figcaption></figure><p id="4711" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">有更多的EDA可以用这个数据集来完成，但我在这里将重点放在使用tidytext包的文本分析上。首先，我用词袋法分析了词频。我用wordcloud包把出现频率最高的词可视化。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kl"><img src="../Images/734cd7990d3a69c2dddda979bf95af04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNRgJy5s4M7hHzcBwQru1g.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">词频上的词云</figcaption></figure><p id="de9a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">除了词袋法，我还使用了包括相邻词序列的N元语法分析。这里我使用了二元模型分析，包括两个相邻的单词。与单个单词相比，双字词似乎更具信息性和描述性，例如樱桃与黑樱桃，中等与中等酒体等等。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kl"><img src="../Images/83eddaf2dca5733d120f7cc12ce405e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YimddMcRy6yLCN69nwO07A.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">bigram频率上的Wordcloud</figcaption></figure><p id="e8a2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">接下来，我计算每个二元模型的TF-IDF。TF-IDF是术语频率(term frequency -- inverse document frequency)的缩写，是一种数值方法，旨在反映一个词对集合或语料库中的文档有多重要。TF-IDF值与一个单词在文档中出现的次数成比例，并被该单词在语料库中的频率所抵消，这有助于调整某些单词通常出现得更频繁的事实。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es km"><img src="../Images/4d12fb504199860fe566eedf680042cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGypvhTvKknAgQ_c1M_wdA.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">TF-IDF二元模型(按品种_地区)</figcaption></figure><p id="56ef" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以看到来自不同地区的每个品种都有其独特的描述符。与来自加州的赤霞珠相比，来自加州的黑皮诺有独特的术语，如月桂叶、玫瑰花瓣和森林地面等。来自俄勒冈州的黑皮诺有独特的术语，如黑巧克力、烘焙香料和橘子皮等。</p><p id="8b95" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">造型</strong></p><p id="de36" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">下一步是建立一个模型，根据品尝记录对品种区域进行分类。为了确保每个类别都有足够的数据并简化模型，我使用来自前10个品种区域的20k个样本的TF-IDF来建立模型。训练和测试数据集按70/30分割，并以完全相同的方式分别处理，以确保它们具有相同的结构和特征用于建模。这里的测试数据集处理非常棘手。quanteda包为此提供了一个有用的函数。处理文本有7个步骤:</p><ol class=""><li id="a88d" class="kn ko hi jl b jm jn jp jq js kp jw kq ka kr ke ks kt ku kv bi translated">标记化</li><li id="1def" class="kn ko hi jl b jm kw jp kx js ky jw kz ka la ke ks kt ku kv bi translated">下部外壳</li><li id="7b1d" class="kn ko hi jl b jm kw jp kx js ky jw kz ka la ke ks kt ku kv bi translated">停用词移除。我为葡萄酒数据集构建了定制的停用词</li><li id="6d67" class="kn ko hi jl b jm kw jp kx js ky jw kz ka la ke ks kt ku kv bi translated">堵塞物</li><li id="ad54" class="kn ko hi jl b jm kw jp kx js ky jw kz ka la ke ks kt ku kv bi translated">转换到DFM</li><li id="c2e5" class="kn ko hi jl b jm kw jp kx js ky jw kz ka la ke ks kt ku kv bi translated">移除稀疏术语</li><li id="3ee9" class="kn ko hi jl b jm kw jp kx js ky jw kz ka la ke ks kt ku kv bi translated">确保测试数据帧与列车数据帧具有相同的特征</li></ol><p id="ff9d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">创建数据集后，训练集有14004个样本，511个预测器和10个类；测试集有5996个样本，511个预测值。你可以看到这是一个非常高维的数据集。</p><p id="933d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">对于模型选择，我使用线性支持向量机，因为它推荐用于文本分类，因为它具有大量的特征。我正在使用插入式列车功能与10倍交叉验证。代码如下:</p><p id="7bdc" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">token_model_svm = train(Label~。，data = train.tokens.tfidf.df，method = 'svmLinear3 '，tr control = train control(method = ' cv '，number = 10))</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lb"><img src="../Images/f5b46c9313e1c635e088644f20924fd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*PQ6GD1qNTHLotXyBIiIlxw.png"/></div></figure><p id="95e7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最终模型选择成本= 1，损失= L2，准确率为0.845。现在我用测试数据来预测拟合模型的结果。总体准确率为0.841，非常接近拟合模型。波尔多红混合的准确率最高，为0.985，而西拉加州美国的准确率最低，为0.775。这可能是因为这些变化区域具有较少的训练样本。你可以得到一个完整的每个类的混淆矩阵。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lc"><img src="../Images/16931f3c0b778c8302f1d276c64da232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g357xQqYfTwqVpILStCRFw.png"/></div></div></figure><p id="4b80" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">推荐</strong></p><p id="7dd7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我还创建了一个简单的推荐函数，使用余弦相似度来计算每个文档之间的距离。我用tidytext包中的cast_sparse函数创建了一个稀疏矩阵，用text2vec包中的sim2函数计算相似度。</p><p id="b956" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">相似性= sim2(sparse.matrix，method = "cosine "，norm = "l2 ")</p><p id="7f76" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后我写了一个简单的函数来识别每个参考的最相似的酒。</p><p id="0d56" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">get _ similar _ wine = function(similarities，reference_wine，n _ re commendations = 3){<br/>sort(similarities[reference _ wine，]，decreasing = TRUE)[1:(2+n _ re commendations)]<br/>}</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ld"><img src="../Images/422dcf3eb40f1943747917c820c20635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-DPY8Az9TcULksN7PYtSQ.png"/></div></div></figure><p id="4d9d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在这个例子中，参考葡萄酒是2010年的饼干和奶油赤霞珠，最相似的葡萄酒是2010年的博利乌葡萄酒。结果的准确性需要通过品尝进一步调查。</p><p id="c101" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">总结</strong></p><p id="dfea" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">总的来说，我认为分类模型的准确率相当高。下一步可能是品尝一些葡萄酒，看看类似的葡萄酒推荐是否准确。</p><p id="f810" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以在<a class="ae kf" href="https://github.com/ellendeng/wine_recommendation" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到R代码，如果有任何问题，请随时在<a class="ae kf" href="https://www.linkedin.com/in/ellen-deng/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p></div></div>    
</body>
</html>