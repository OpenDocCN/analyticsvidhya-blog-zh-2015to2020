<html>
<head>
<title>Bag of Words — The easiest explanation of NLP using python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">单词袋——使用python对NLP最简单的解释</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bag-of-words-the-easiest-explanation-of-nlp-using-python-19244cf2347e?source=collection_archive---------12-----------------------#2019-12-04">https://medium.com/analytics-vidhya/bag-of-words-the-easiest-explanation-of-nlp-using-python-19244cf2347e?source=collection_archive---------12-----------------------#2019-12-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d7de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天我将向你解释单词袋技巧。</p><p id="7db5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你在这里，你可能知道我们为什么用它，但是如果你不知道，我会用一个例子告诉你。</p><h1 id="e421" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">用一个例子解释单词袋？</h1><p id="c00f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">进入你的gmail，打开优先收件箱，你会看到谷歌神奇地将你所有的邮件分类为重要邮件、社交邮件、垃圾邮件等等。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/d324fafe00063182b07fdb8fa7d021f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GxVC61a1f5j_WLo7.png"/></div></div></figure><p id="1be1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在还记得吗？</p><p id="3b3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌怎么知道有些邮件对你很重要，而其他的却不重要？</p><p id="ab4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然有很多因素在起作用，但一个主要因素是机器会阅读你的邮件，然后理解什么对你来说是重要的，然后显示给你看，瞧。</p><p id="0fd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题是，机器不知道什么是英语，它只理解数字，所以它做的是把你所有的文件分解成单词，就像-</p><p id="903e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">电子邮件</strong></p><blockquote class="ks kt ku"><p id="e11e" class="if ig kv ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><em class="hi">你好，马丹先生，</em></p><p id="b12f" class="if ig kv ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><em class="hi">祝贺你，我喜欢你的文章，因为它能够以简单的方式向我解释单词袋的作用。</em></p></blockquote><p id="b2b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">机器如何破坏它</strong></p><blockquote class="ks kt ku"><p id="27c6" class="if ig kv ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated">你好，马丹先生，祝贺你，我喜欢你的文章……以简单的方式。</p></blockquote><p id="b54f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这个词的分裂然后是</strong></p><ol class=""><li id="da99" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated"><strong class="ih hj">清理或预处理— </strong>如果有其他口音的单词，如波兰语、德语、西班牙语等，删除所有不必要的特殊字符。删除或替换它们，或者添加正确的unicode，使它们对机器可读。</li><li id="2fdd" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj">标准化所有数据</strong>——使用。lower()函数从数据中删除任何大写字母单词。</li><li id="ac4e" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj">悲叹和词干化— </strong>从数据中删除所有形容词/构建词，即Baked、baking、baker都是构建词over bake。从数据到词根对所有这样的词进行分类。此外，删除所有停用词，即所有对特征没有意义或维度的词，如a、the等。</li></ol><p id="3e4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，一旦我们有了所有的单词，我们就对其进行标记，即记录文档中所有单词的重复次数。Ex —这只猫是一只可爱的肥猫&gt;&gt;这只，猫，是，a，胖，猫，那，是，可爱&gt;&gt;&gt;这只— 1，猫— 2，是—2，a— 1，胖— 1，那—1，可爱—1</p><p id="720b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者</p><p id="e88e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这— 1</p><p id="4b96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二类</p><p id="af21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">is -2</p><p id="cb44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a-1</p><p id="e59d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">脂肪— 1</p><p id="d20e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那个-1</p><p id="87b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可爱— 1</p><h2 id="b9f0" class="ln je hi bd jf lo lp lq jj lr ls lt jn iq lu lv jr iu lw lx jv iy ly lz jz ma bi translated">这个过程叫做标记化。</h2><p id="dffc" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在我们明白接下来要做什么之前，我会告诉你我们为什么要做这一切。</p><blockquote class="ks kt ku"><p id="6bf6" class="if ig kv ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated"><em class="hi">我们的目标是在文档中找到这种情况下的特征或单词，这些特征或单词可以帮助我们提供文档的一些含义，或者在与相似或不相似的文档进行比较时提供一些帮助。</em></p></blockquote><p id="97f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分解文档1的标记化单词有助于我们将其与文档2的其他标记化单词进行比较，从而有助于找到相似的文档。</p><p id="4ba5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">现在回到单词袋。</strong></p><p id="46f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在标记化之后，我们转移到构建词汇表或者从文档中寻找特征。</p><p id="ab99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">vocab =清洁、去除停用词等后的所有最终特征。</p><p id="03d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，如果一个文档有3个文档，每个文档有7个单词，那么vocab是从文档中选择单词的最佳选择，在我们的例子中是21个单词中的10个单词。</p><p id="6e5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Vocab count =所有独特特征或单词的计数，对我们来说是10(比方说)。</p><p id="b19d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">找到vocab后，我们将最终确定的单词转换成向量，你怎么问？</p><p id="d5f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">说我们的词汇为<em class="kv">“这只猫是只可爱的肥猫”</em>是</p><p id="7219" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二类</p><p id="d7c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">is — 2</p><p id="ebf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">脂肪— 1</p><p id="0e2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可爱— 1</p><p id="e5c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">vocab计数= 4</p><p id="758c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以矢之文献<em class="kv">“这只猫是只肥猫，很可爱”</em>是</p><h2 id="d9b5" class="ln je hi bd jf lo lp lq jj lr ls lt jn iq lu lv jr iu lw lx jv iy ly lz jz ma bi">[022010001]</h2><p id="5aa9" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">当您比较最终的词汇和文档中的单词时，这个数字只是一个表示，即在比较时</p><p id="9f2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个— 1，猫— 2，是—2，a— 1，胖— 1，那个—1，可爱—1</p><p id="1fa1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有猫— 2，是— 2，胖— 1，可爱— 1</p><p id="b97f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得到<strong class="ih hj">【022010001】</strong></p><p id="fd65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个过程叫做<strong class="ih hj">矢量化。</strong></p><p id="6d5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Tada，这些都是单词袋的概念，所以现在像我承诺的那样，我与你分享我基于sklearn的代码，如果你想通过代码了解每个过程是如何工作的，<a class="ae mb" href="https://www.freecodecamp.org/news/an-introduction-to-bag-of-words-and-how-to-code-it-in-python-for-nlp-282e87a9da04/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">检查这个</strong> </a>。</p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="e526" class="ln je hi md b fi mh mi l mj mk"><strong class="md hj"><em class="kv">#Part 1 Declaring all </em></strong>document<strong class="md hj"><em class="kv">s and assigning to a document</em></strong><br/>document1=”This is my code on bag of words.”<br/>document2=”Bag of words is a NLP technique.”<br/>document3=”I will explain it to you in a simple way”</span></pre><p id="671b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="kv">#第2部分—导入库并初始化CountVectorizer </em> </strong></p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="fc07" class="ln je hi md b fi mh mi l mj mk">from sklearn.feature_extraction.text import CountVectorizer</span><span id="a650" class="ln je hi md b fi ml mi l mj mk">#Making a list or Document from all documents<br/>Doc=[document1,document2,document3]</span><span id="db31" class="ln je hi md b fi ml mi l mj mk">#Initializing CountVectorizer from sklearn<br/>vectorizer = CountVectorizer(stop_words=’english’)</span></pre><p id="3ba8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="kv">#第3部分—获取我们将用于标记该文档的最终单词的特征名称</em> </strong></p><pre class="kh ki kj kk fd mc md me mf aw mg bi"><span id="d4ca" class="ln je hi md b fi mh mi l mj mk">X = vectorizer.fit_transform(Doc)</span><span id="2a81" class="ln je hi md b fi ml mi l mj mk">analyze = vectorizer.build_analyzer()</span><span id="02a8" class="ln je hi md b fi ml mi l mj mk">analyze(document1)</span><span id="2ba0" class="ln je hi md b fi ml mi l mj mk">analyze(document2)</span><span id="f928" class="ln je hi md b fi ml mi l mj mk">analyze(document3)</span><span id="73d3" class="ln je hi md b fi ml mi l mj mk">vectorizer.transform(document1).toarray()</span><span id="88cd" class="ln je hi md b fi ml mi l mj mk">vectorizer.transform(document2).toarray()</span><span id="52d4" class="ln je hi md b fi ml mi l mj mk">vectorizer.transform(document3).toarray()</span><span id="2af0" class="ln je hi md b fi ml mi l mj mk">print(vectorizer.get_feature_names())</span><span id="8233" class="ln je hi md b fi ml mi l mj mk"><em class="kv">Output</em>&gt;&gt;&gt;<em class="kv">[‘bag’, ‘code’, ‘explain’, ‘nlp’, ‘simple’, ‘technique’, ‘way’, ‘words’]</em></span></pre><p id="f8b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="kv">#第4部分—矢量化或创建所有三个</em> </strong>文档<strong class="ih hj"><em class="kv"/></strong>的矩阵</p><p id="dcf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du mm mn mo md b">print(X.toarray())</code></p><p id="6c31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kv">输出</em>&gt;&gt;&gt;[[1 1 0 0 0 0 0 1 0 1 0 1 0 1 0 1 0 1 0]]</p><p id="b1c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者</p><p id="ebb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击这里查看我的Github &gt;<a class="ae mb" href="https://github.com/rmadan16/Bag_of_words" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">查看包字代码</strong> </a>。</p><p id="92be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这很简单，可以帮助你理解这个概念，如果你有可以帮助我改进内容或代码的反馈，给我写信——<em class="kv">rohitmadan16@gmail.com</em></p><p id="98b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和平。</p></div></div>    
</body>
</html>