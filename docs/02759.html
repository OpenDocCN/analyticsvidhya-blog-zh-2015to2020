<html>
<head>
<title>Serverless Programming — AWS Lambda with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无服务器编程—使用Python的AWS Lambda</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/serverless-programming-aws-lambda-with-python-c89d9aa2db5e?source=collection_archive---------21-----------------------#2019-12-31">https://medium.com/analytics-vidhya/serverless-programming-aws-lambda-with-python-c89d9aa2db5e?source=collection_archive---------21-----------------------#2019-12-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f128" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">使用Lambda，您可以运行几乎任何类型的应用程序或后端服务的代码——所有这些都无需管理。只需上传你的代码，Lambda就会为你的代码提供高可用性的运行和扩展。您可以将代码设置为从其他AWS服务自动触发，或者直接从任何web或移动应用程序调用它。— AWS Lambda网页</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/a14707f06801f8318bbfdf8b6598425a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5mwawHkKIRZ8F215"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae ju" href="https://unsplash.com/@martijnbaudoin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Martijn Baudoin </a>在<a class="ae ju" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="20e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我试图上传我的英雄联盟时间跟踪器的python项目到AWS Lambda上，这里是我在这个过程中学到的一些东西。它们没有特定的顺序。</p><p id="16a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">lambda的流程如下:创建一个你的代码及其所有依赖的zip文件，上传到Lambda并指定触发器。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jv"><img src="../Images/7dc1db963c72502eee04f6276247766e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kx_PjLy4tSUQ84lhR-Vdbg.png"/></div></div></figure><p id="effb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了压缩你需要的所有代码，你将首先在一个地方获得依赖项，在工作文件夹中创建一个<code class="du jw jx jy jz b">./package</code>目录，然后用<code class="du jw jx jy jz b">pip3 install --target ./package &lt;YOUR_PACKAGE_NAME&gt;</code>在那里安装所有的依赖项，如果你得到一个<code class="du jw jx jy jz b">distutil</code>错误，就在这个目录中创建一个<code class="du jw jx jy jz b">setup.cfg</code>文件，下面两行</p><pre class="jf jg jh ji fd ka jz kb kc aw kd bi"><span id="4857" class="ke kf hi jz b fi kg kh l ki kj">[install]<br/>prefix=</span></pre><p id="1a86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装完所有的安装依赖项后，将<code class="du jw jx jy jz b">cd</code>放入其中并创建一个包含所有依赖项的zip文件</p><p id="9d07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jw jx jy jz b">zip -r9 ${OLDPWD}/&lt;FILE_NAME&gt;.zip .</code></p><p id="9b79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">移出<code class="du jw jx jy jz b">./package</code>目录，用</p><p id="01ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jw jx jy jz b">zip -g &lt;FILE_NAME&gt;.zip &lt;CODE_FILE_NAME&gt;</code></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kk"><img src="../Images/0cf360c7252310bb760ad1df3d3d5bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1FsVxsZsHo8yblTtKBsZUw.png"/></div></div></figure><p id="ec97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">准备好zip文件后，您可以将它上传到lambda中创建的函数。将运行时更改为相应的包，将处理程序更改为<code class="du jw jx jy jz b">&lt;CODE_FILE_NAME&gt;.&lt;FUNCTION_NAME&gt;</code>。默认情况下，函数名称为<code class="du jw jx jy jz b">lambda_handler</code>，并带有两个变量<code class="du jw jx jy jz b">event</code>和<code class="du jw jx jy jz b">context</code>。</p><p id="47ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只需添加一个API网关作为lambda函数的触发器，然后就可以通过访问url来运行该函数。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="17db" class="ks kf hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">修改AWS Lambda的代码</h1><p id="09ad" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated">首先要改变的是将函数体移到<code class="du jw jx jy jz b">lambda_handler</code>中，这个函数的返回是一个JSON响应。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lu"><img src="../Images/f3b767c82fd371f7db7426696ac24aa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_ak3BjzPVz3EdidXwfCcw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">JSON返回值</figcaption></figure><p id="7767" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你访问url时，返回值的主体将显示在网页上。</p><p id="338a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">JSON的主体必须是一个字符串，否则它将显示为500内部服务器错误。</p><p id="97d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当使用全局变量时，不要忘记在调用它们之前声明<code class="du jw jx jy jz b">global var1, var2</code>。</p><p id="fce4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不得不修改我的错误捕获过程，这样错误就会显示在网页上，这样更容易调试。</p><p id="9f58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我的API网关，我希望能够将变量传递到脚本中。这是通过向<code class="du jw jx jy jz b">GET</code>请求提供参数来完成的。为了检索<code class="du jw jx jy jz b">lambda_handler</code>中的这些参数，通过<code class="du jw jx jy jz b">event['queryStringParameters']['param1']</code>访问<code class="du jw jx jy jz b">event</code>中的<code class="du jw jx jy jz b">queryStringParameters</code>属性</p><p id="70f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是AWS Lambda入门的全部内容。希望这有所帮助。</p></div></div>    
</body>
</html>