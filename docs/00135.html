<html>
<head>
<title>NLP Guide: Identifying Part of Speech Tags using Conditional Random Fields</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NLP指南:使用条件随机字段识别词性标签</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pos-tagging-using-conditional-random-fields-92077e5eaa31?source=collection_archive---------0-----------------------#2018-10-05">https://medium.com/analytics-vidhya/pos-tagging-using-conditional-random-fields-92077e5eaa31?source=collection_archive---------0-----------------------#2018-10-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d4d506ace000ba8da857ef4d6512b896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CbZE2ZTBlmswW84Knjbqkg.png"/></div></div></figure><p id="b65e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在自然语言处理(NLP)领域，最基本的模型是基于单词包的。但是这种模型无法捕捉单词之间的句法关系。</p><p id="5cd0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，假设我们建立了一个仅基于一袋单词的情感分析器。这样的模型将无法捕捉“我喜欢你”和“我喜欢你”之间的差异，前者“喜欢”是具有积极情绪的动词，后者“喜欢”是具有中性情绪的介词。</p><p id="1b6b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以这给我们留下了一个问题——我们如何改进这个单词袋技术？</p><p id="ec01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">词性(以下称为POS)标签对于构建解析树是有用的，解析树用于构建ner(大多数命名实体是名词)和提取单词之间的关系。词性标注对于构建词条分类器也是必不可少的，词条分类器用于将单词简化为其词根形式。</p><p id="aaa2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">词性标注是根据上下文和定义将语料库中的单词标记到语音标签的相应部分的过程。这项任务并不简单，因为一个特定的单词根据其使用的上下文可能有不同的词性。</p><p id="cbc9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">比如:</strong>在“给我你的答案”这句话里，<em class="jo">答案</em>是名词，但在“回答问题”这句话里，<em class="jo">答案</em>是动词。</p><p id="bd87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要理解任何一句话的意思，或者提取关系，构建知识图，词性标注是非常重要的一步。</p><h1 id="d0c8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">不同的词性标注技术</h1><p id="6145" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">词性标注有不同的技术:</p><ol class=""><li id="9861" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated"><strong class="is hj">基于词汇的方法—</strong>指定在训练语料库中最常出现的词类标签。</li><li id="6eb9" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated"><strong class="is hj">基于规则的方法— </strong>基于规则分配POS标签。例如，我们可以有一个规则说，以“ed”或“ing”结尾的单词必须分配给一个动词。基于规则的技术可以与基于词汇的方法一起使用，以允许对不存在于训练语料库中但存在于测试数据中的单词进行词性标注。</li><li id="3db3" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated"><strong class="is hj">概率方法— </strong>该方法根据特定标签序列出现的概率分配位置标签。条件随机场(CRF)和隐马尔可夫模型(hmm)是分配POS标签的概率方法。</li><li id="407c" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated"><strong class="is hj">深度学习方法</strong> —递归神经网络也可以用于词性标注。</li></ol><p id="cb6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将研究如何在Penn Treebank语料库(NLTK库中有)上使用条件随机字段。</p><h1 id="069d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">条件随机场</h1><p id="3300" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">一个CRF是一个<strong class="is hj">判别概率分类器</strong>。判别模型和生成模型的区别在于<strong class="is hj">判别模型试图模拟条件概率分布，即P(y|x)，而生成模型试图模拟联合概率分布，即P(x，y) </strong>。</p><p id="e5d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> Logistic回归、SVM、CRF是判别分类器。朴素贝叶斯，hmm是生成分类器。</em> CRF也可用于序列标记任务，如命名实体识别器和位置标记器。</p><p id="726c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在CRFs中，输入是使用特征函数、与特征(被学习的)和先前标签相关联的权重从输入序列中导出的一组特征(实数),并且任务是预测当前标签。将确定不同特征函数的权重，使得训练数据中标签的可能性最大化。</p><p id="e8c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在CRF中，定义了一组特征函数来提取句子中每个单词的特征。特征函数的一些例子是:单词的第一个字母是大写的吗，单词的后缀和前缀是什么，前面的单词是什么，它是句子的第一个还是最后一个单词，它是一个数字吗等等。这些特征集合被称为<strong class="is hj">状态特征。</strong>在CRF中，我们也通过前一个词的标签和当前词的标签来学习权重。CRF将尝试确定不同特征函数的权重，以最大化训练数据中标签的可能性。依赖于前一个单词的标签的特征函数是<strong class="is hj">过渡特征</strong></p><p id="3cc8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们跳到如何使用CRF来识别Python中的POS标签。代码可以在<a class="ae lg" href="https://github.com/AiswaryaSrinivas/DataScienceWithPython/blob/master/CRF%20POS%20Tagging.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="5a3c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">数据集</h1><p id="3065" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们将使用NLTK树库数据集和通用标签集。NLTK 的<a class="ae lg" href="https://www.nltk.org/_modules/nltk/tag/mapping.html" rel="noopener ugc nofollow" target="_blank">通用标签集由12个标签类组成:动词、名词、代词、形容词、副词、形容词、限定词、基数、助词、其他/外来词、标点符号。这个数据集有3914个标记句子和12408个单词的词汇量。</a></p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="c274" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将按照80:20的比例将数据分为训练和测试数据，训练集中有3，131个句子，测试集中有783个句子。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="dc79" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建特征功能</strong></p><p id="d1dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了识别POS标签，我们将创建一个函数，该函数为句子中的每个单词返回一个具有以下特征的字典:</p><ul class=""><li id="9553" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn ln ky kz la bi translated">单词的首字母大写吗(一般专有名词首字母大写)？</li><li id="3153" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn ln ky kz la bi translated">这是句子的第一个单词吗？</li><li id="0ca1" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn ln ky kz la bi translated">这是这个句子的最后一个词吗</li><li id="39a6" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn ln ky kz la bi translated">这个单词包含数字和字母吗？</li><li id="b552" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn ln ky kz la bi translated">它有连字符吗(一般来说，形容词都有连字符——例如，像快速增长，缓慢移动这样的词)</li><li id="02ec" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn ln ky kz la bi translated">完整的单词是大写的吗？</li><li id="407f" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn ln ky kz la bi translated">是数字吗？</li><li id="7557" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn ln ky kz la bi translated">前四个后缀和前缀是什么？(以“ed”结尾的词一般是动词，以“ous”结尾的词像disastrous是形容词)</li></ul><p id="a9ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">特征函数定义如下，并提取训练和测试数据的特征。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="52d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">拟合通用报告格式模型</strong></p><p id="0e03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是使用<em class="jo"> sklearn_crfsuite </em>来拟合CRF模型。该模型通过梯度下降进行优化，使用LBGS方法和L1和L2正则化。我们将设置CRF来生成所有可能的标签转换，甚至那些没有在训练数据中出现的标签转换。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="bea6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">评估CRF模型</strong></p><p id="415c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们使用F-score来评估CRF模型。F-score传达了精确度和召回率之间的平衡，并被定义为:</p><p id="a6ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2*(精度*召回)/(精度+召回)</strong></p><p id="5da2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">精度</strong>定义为真阳性的数量除以阳性预测的总数。它也被称为阳性预测值(PPV):</p><p id="17fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">精度=TP/(TP+FP) </strong></p><p id="a0fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">召回</strong>定义为真阳性总数除以数据中阳性类值总数。它也被称为敏感度或真阳性率:</p><p id="84d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">召回=TP/(TP+FN) </strong></p><p id="31b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">CRF模型在训练数据和测试数据上分别给出了0.996和0.97的F值。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="2c31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从CRF(下图)的类别评分中，我们观察到，对于预测形容词，精确度、召回率和F评分较低，这表明必须将更多与形容词相关的特征添加到CRF特征函数中。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/c4385f7c1b1b035a0ca2df6544d7ce4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OOXn19Z98sWCu_q9AvtVzw.png"/></div></div></figure><p id="0761" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是查看前20个最有可能的过渡特征。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/a23c7f93daa5b1fa11de0f0828c3ceb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*mCHxod72ktAlEVcvqks9og.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">最可能的过渡特征</figcaption></figure><p id="29f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们所看到的，形容词最有可能跟在名词后面。动词后面最有可能是助词(如to)，像“The”这样的决定因素后面也更有可能是名词。</p><p id="6cf7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样，我们可以看看最常见的状态特征。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/3c06e92659b7ba602765ba1de0043e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H6z45Rlpcuf_VYIeuvkyoQ.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">最可能的状态特征</figcaption></figure><p id="f1ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果前面的词是“will”或者“would”，那么最有可能是动词，或者一个词以“ed”结尾，那么肯定是动词。正如我们在定义特征时讨论的，如果单词有连字符，根据CRF模型，成为形容词的概率更高。同样，如果一个单词的第一个字母大写，它更可能是一个名词。自然语言是如此复杂而美丽的东西！</p><h1 id="0618" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">结束注释</strong></h1><p id="cbb4" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在这篇文章中，我们学习了如何使用CRF来构建一个POS Tagger。类似的方法可用于使用通用报告格式建立净注册率。为了提高我们的CRF模型的准确性，我们可以在模型中包括更多的特征——像句子中的最后两个词而不仅仅是前一个词，或者句子中的后两个词，等等。整个分析的代码可以在<a class="ae lg" href="https://github.com/AiswaryaSrinivas/DataScienceWithPython/blob/master/CRF%20POS%20Tagging.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="8051" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">希望这篇文章对你有用。一如既往，非常感谢您的任何反馈。请在下面分享你的评论。</em> </strong></p></div></div>    
</body>
</html>