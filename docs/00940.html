<html>
<head>
<title>Giving BERT an English exam</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">给伯特一次英语考试</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/giving-bert-an-english-exam-8b3a07a6ab7f?source=collection_archive---------11-----------------------#2019-09-20">https://medium.com/analytics-vidhya/giving-bert-an-english-exam-8b3a07a6ab7f?source=collection_archive---------11-----------------------#2019-09-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="dfce" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">开放式完形填空练习</h2></div><p id="de38" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">自然语言处理(NLP)在过去的几个月里进步如此之快，以至于现在只要运行一个简短的Jupyter笔记本你就可以在几秒钟内得到一个语法练习的答案。语言学习者的典型考试练习是开放式完形填空。在这里，学生必须找到缺失的单词来完成一个短语。这是语言模型的理想任务；毕竟你只需要正确预测下一个单词。剧透:你可以用人工智能完成80%以上的练习。</p><h2 id="106d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">剑桥英语资格证书</h2><p id="a0be" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">为了探索在开放式完形填空练习中使用自然语言处理，我使用了一些分级练习。欧洲通用语言参考框架(CEFR)是描述语言能力的国际标准。它将语言能力分为六个等级，从初学者的A1级到已经掌握一门语言的C2级。<a class="ae jt" href="https://www.cambridgeenglish.org/exams-and-tests/qualifications/" rel="noopener ugc nofollow" target="_blank">剑桥英语资格</a>提供学生准备考试的样卷和教师手册作为<a class="ae jt" href="https://www.cambridgeenglish.org/teaching-english/resources-for-teachers/" rel="noopener ugc nofollow" target="_blank">资源</a>。这些考试包括针对中上水平或更高水平学生的开放式完形填空练习(B2优先、C1高级和C2熟练)。这项任务对于英语水平较低的学生来说太难了；通常，学生不喜欢这个练习，因为他们会感到迷失，没有线索来帮助他们找到丢失的单词。当然，线索就在周围的文本中。</p><h2 id="9405" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">前视模型(来自fast.ai的ULMFit)</h2><p id="5ae4" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">假设语言模型预测可能的下一个单词。第一种方法是选择具有最高概率的预测的下一个单词。以第一次考试的样卷1的第一句话为例</p><p id="564d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我是一名摩托车特技骑手——也就是说，我在表演时在我的摩托车上表演特技。缺的字是<em class="ku">‘as’</em>。</p><p id="b362" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于<em class="ku">'我工作'</em>，语言模型预测最有可能的下一个单词是带有''的<em class="ku">(概率p=0.14)，而<em class="ku">'是带有'</em>的只有p=0.03，所以取预测概率最高的下一个单词，即使在这个简单的例子中也不能给出正确答案。</em></p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/f056697cc4c13edb4acb30842a7b6e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2WO0rx2kfTn5GhutSlWFBA.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">“我工作__ a”的决策树</figcaption></figure><p id="267d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们向前看，看看对空白<strong class="iz hj">加</strong>之前的文本进行预测，为空白预测的单词是否给出下一个单词<em class="ku">‘a’</em>作为预测，结果如何？对于'<em class="ku">我与之共事'，</em>确实如此，但只是概率p=0.04。<em class="ku">‘我作为’</em>有<em class="ku">‘a’</em>作为p=0.78的预测。应用在间隙之后取期望单词的最大概率出现的规则，提出<em class="ku">‘as’</em>作为答案。所以，在这个例子中，这种测试的方法，看看预测填补空白的单词是否可以跟在空白之后的单词后面，效果很好。</p><p id="8c7f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，这个决策树揭示了一个问题。虽然可能性较小，但<em class="ku">“我在……工作/我为……工作/我在……工作”</em>都是有效的回答。单纯看缺口前的文字和缺口后的第一个字是不够的。在样本试卷上测试这种方法只能得到大约45%的正确率。看前面几个字和后面第一个字的差距不够；需要更多的背景知识。</p><h2 id="ad42" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">左顾右盼</h2><p id="960f" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">这就是伯特的切入点。来自变压器的双向编码器表示(BERT)是一种语言模型，它同时查看单词的左侧和右侧来预训练表示。所有繁重的工作已经为我们完成了，所以我们可以在英语考试练习中使用这个预先训练好重量的模型。开箱即用的预训练BERT可用于预测样本试卷上缺失的单词。</p><p id="0be2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">想要更好地解释伯特是什么，请听数据怀疑论者播客“<a class="ae jt" href="http://dataskeptic.libsyn.com/bert-is-magic" rel="noopener ugc nofollow" target="_blank">伯特有魔力</a>”。</p><p id="b272" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于每份样纸，都给出了一个例子，然后在一篇文章中有八个空白要填写。例如，对于第一次考试的样本试卷1，每个方括号中的第一个单词是BERT预测的单词，冒号后的一个或多个单词是可接受的答案。第一个方括号是给学生的例子。</p><p id="7b48" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我是一名摩托车特技骑手——也就是说，我在表演时在我的摩托车上表演特技。法国勒芒赛道是我第一次看到一些人做摩托车特技的地方。我以前从未见过有人只用后轮骑摩托车，这给我留下了非常深刻的印象，我直接回家并自学了同样的方法。没过多久，我就开始靠表演自己的摩托车特技谋生。我有机械工程学位；这有助于我了解每个特技背后的物理原理。除了负责摩托车的设计变更之外，我还必须完成我做的每一个特技。人们经常认为我的工作非常危险，但是，除了在特技表演中偶尔发生一些小的机械故障之外，从来没有出过任何差错。我从不觉得有任何危险，因为我很有经验。</p><p id="0691" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">伯特完美地完成了这个练习。七份样卷的成绩分别是:B2第一，例句短语1/2，测试短语16/16/C1进阶，1/2，13/16 / C2熟练度，3/3，17/24。模型做的这么好(51/63=81%)真是太棒了。</p><p id="11da" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们不是要求一个预测，而是要求模型为缺失的单词提供两个选择，并且我们希望学生选择正确的单词，那么结果会提高到87% (55/63): B2第一，1/2关于示例短语，16/16关于测试短语/ C1高级，1/2，13/16 / C2熟练，3/3，21/24。</p><p id="c39a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是四个例子，伯特的第二个预测是正确的，都来自关于机器人的同一篇文章:</p><p id="2e9a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ku"> 1。虽然复杂的[ ['机器人'，'足够']:足够]组装汽车并在复杂的手术中提供协助，但现代机器人是<br/> 2。愚蠢的机器人，[ ['有能力'，'没有能力']:没有能力]与他们的人类操作员建立关系。<br/> 3。工程师们认为，随着机器人开始成为社会中更大的一部分，它们将需要一种与人类互动的方式。<br/> 4。一个大问题是:一个合成伴侣需要具备什么，才能让你想长期与之交往？</em></p><p id="168b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">即使没有明显的方法告诉学生有时选择伯特的第二个选择，有两个选择，并知道语言模型倾向于第一个选择，可能足以让学生确定正确的答案。</p><p id="291a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ku">‘虽然精密的机器人要组装’</em>没有意义，所以第二种选择更好。谈论<em class="ku">、【哑巴机器人】、</em>是一种负面情绪，所以<em class="ku">、</em>是更好的选择，尽管<a class="ae jt" href="https://books.google.com/ngrams" rel="noopener ugc nofollow" target="_blank">谷歌N-gram </a>浏览器显示<em class="ku">、</em>比<em class="ku">、【不能攻击】、</em>出现得更频繁。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ll"><img src="../Images/c9f9cac2b10d5ab99b27951fa0ef8997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpUzKquQ0jxyBYtMeJSCdg.png"/></div></div></figure><p id="c347" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以说，<em class="ku">“让自己成为社会更大的一部分”</em>在语法上是正确的，但<em class="ku">“让自己成为社会更大的一部分”</em>更好。如果语言模型在大量剑桥文本上进行微调，它可能会获得对短语动词的强烈偏好(短语动词的定义:由一个动词和另一个元素组成的惯用短语，通常是副词，如<em class="ku">分解</em>，或介词，如<em class="ku">参见</em>，或两者的组合，如<em class="ku">向下看。)</em></p><p id="ecce" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然谷歌N-grams显示<em class="ku">‘从事it’</em>比<em class="ku">‘从事it’</em>出现的频率更高，但这里正确的表达是将<em class="ku">与</em>‘T28’合成伴侣。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lm"><img src="../Images/ccb514237e475d3dc2398ec1b7826171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ahs0m-8EaIfQtS7iLqoNDw.png"/></div></div></figure><p id="f14a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就剩下六个测试例子，模型无法预测正确的单词。两个发生在一篇关于手机的课文中:</p><p id="dd4f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">和[ ['为什么'，'什么']:为什么]他们应该想吗？[ ['after '，' above']:毕竟，通过移动设备收发电子邮件的能力意味着他们可以与同事、朋友和家人保持联系，无论他们是在1点钟排队。超级市场，在[ ['商业'，'规划'] : between ] <br/> 2。飞行前的会议或杀戮[ ['someone '，' people'] : time ]。</p><p id="b969" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一个错误是提议<em class="ku">‘在商务会议中’</em>，而不是<em class="ku">‘在会议间隙’</em>，这是一个甚至连以英语为母语的人都会犯的错误。在第二个错误中，我们可以看到为什么AI会得到这么坏的名声，而不是提出<em class="ku">‘杀人时间’</em>AI建议的是’<em class="ku">杀人’</em>或者再推进一步的话’<em class="ku">杀人’</em>。这是人工智能给你的，给它一个英语考试，它鼓励谋杀！同样，这是训练数据的反映。如果该模型根据剑桥大学惯用的、短语动词丰富的、安全而温和的语言风格(这是国际考试所必需的)进行微调，它可能不会提出这一建议。</p><p id="4925" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ku">手机和电脑已经表现出了[ ['extent '，' degree'] : ['extent '，' degree'] ]，人可以在这个范围内与无生命的电子物体发展关系。<br/> 3。看得更远[ ['上'，'更远'] :['前方'，'向前'] ]，</em></p><p id="ea38" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我不知道为什么模型提出了“进一步看得更远”，这甚至没有出现在谷歌的N-grams中。<em class="ku">看得更远</em>，‘是最好的答案。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ln"><img src="../Images/a028b481d50eaf3603ed01da2cba8e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zig_ZHyUSx_yhCzvmEZPTg.png"/></div></div></figure><p id="5fb0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在C1高级样本纸上有三个错误:</p><ol class=""><li id="dbf2" class="lo lp hi iz b ja jb jd je jg lq jk lr jo ls js lt lu lv lw bi translated"><em class="ku">那种生活有时会让人感到非常恐惧。</em></li><li id="1bf9" class="lo lp hi iz b ja lx jd ly jg lz jk ma jo mb js lt lu lv lw bi translated"><em class="ku">显然，许多人面对[ ['社会'，'气候'] : ['with '，' by'] ] <br/>变化时会考虑两种可能的行动方案，</em></li><li id="9beb" class="lo lp hi iz b ja lx jd ly jg lz jk ma jo mb js lt lu lv lw bi translated"><em class="ku">简单的事情，[ ['or '，' and']:比如] <br/>走另一条路去上班</em></li></ol><p id="3efb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这最后四个例子表明仍有改进的余地。</p><h2 id="21ab" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">可能的使用案例</h2><p id="c577" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">这个练习的目的是什么？我的主要动机是在我有经验的领域使用NLP。看到BERT在这个任务上做得很好，表明这个代码可以帮助学生学习如何最好地准备这个练习。它还可以帮助人们为学生准备这种风格的练习，突出可能的答案中有歧义的地方。C2熟练水平的模糊性是一个理想的特征，因为在这个水平上，学生应该能够权衡可能的答案并选择最佳答案，安全地知道他们是在英语考试的世界中，而不是用于训练BERT的语言示例的宇宙中。幸运的是，这一守则不会帮助学生在剑桥考试中作弊，因为所有的电子设备都被禁止。你甚至会被要求去掉塑料水瓶上的标签。</p><p id="4505" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">令人惊讶的是，现在可以在标准PC上使用深度神经网络来完成个人NLP项目。由于许多聪明人和大型处理单元的工作和计算，大量资源的开源可用性意味着现在每个人都可以实现这一点。</p><h2 id="4cbc" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">技术方面的东西</h2><p id="41c4" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">最初，我尝试使用f <a class="ae jt" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank"> ast.ai </a>的<a class="ae jt" href="https://docs.fast.ai/text.html" rel="noopener ugc nofollow" target="_blank"> ULMFit </a> forwards模型，对<a class="ae jt" href="https://www.nyu.edu/projects/bowman/multinli/" rel="noopener ugc nofollow" target="_blank"> MultiNLI </a>句子进行微调。这个模型有很多优点，特别是在分类方面，但是不太适合预测文本。</p><p id="bac1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">雷切尔·托马斯的<a class="ae jt" href="https://www.fast.ai/2019/07/08/fastai-nlp/" rel="noopener ugc nofollow" target="_blank"> fast.ai NLP课程</a>是对NLP的极好介绍，它使该领域更容易理解，并为你自己探索NLP的用途提供了良好的基础。</p><p id="fa17" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在预训练的BERT模型中使用的代码可以在运行Python 3的单个简短的<a class="ae jt" href="https://gist.github.com/AlisonDavey/9c1060cc0c9d12ebd2a9042db054de6e" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本</a>中获得。</p><p id="cc5c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae jt" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank"> HuggingFace </a>慷慨地提供了预先训练好的BERT模型以及如何部署该模型的建议。</p><p id="feeb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae jt" href="https://arxiv.org/abs/1810.04805v2" rel="noopener ugc nofollow" target="_blank">伯特:用于语言理解的深度双向转换器的预训练</a></p></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="ed9e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ku">编辑:2019年9月25日随AllenNLP翻译</em> <a class="ae jt" href="https://twitter.com/ai2_allennlp/status/1176891426602278912" rel="noopener ugc nofollow" target="_blank"> <em class="ku">公布</em> </a> <em class="ku">今天你可以在</em><a class="ae jt" href="https://demo.allennlp.org/masked-lm" rel="noopener ugc nofollow" target="_blank"><em class="ku">https://demo.allennlp.org/masked-lm</em></a>让伯特为你在线做这些练习</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mj"><img src="../Images/51213879cca739d981f4880d5f24f405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0fys2KIwMovMa3UeTq_hUQ.png"/></div></div></figure></div></div>    
</body>
</html>