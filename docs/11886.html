<html>
<head>
<title>II. Forecasting crypto tendencies with Deep Learning in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">二。利用Python中的深度学习预测加密趋势</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ii-forecasting-crypto-tendencies-with-deep-learning-in-python-5948909617db?source=collection_archive---------17-----------------------#2020-12-22">https://medium.com/analytics-vidhya/ii-forecasting-crypto-tendencies-with-deep-learning-in-python-5948909617db?source=collection_archive---------17-----------------------#2020-12-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="aea9" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">不到65行。</p></blockquote><p id="b781" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi jk translated">本文是描述创建、回溯测试和部署交易机器人的分步过程的系列文章的一部分。第一篇文章关注的是<strong class="il hj">计算预测变量</strong>，而第二篇文章关注的是<strong class="il hj">构建深度学习模型</strong>，第三篇文章关注的是<strong class="il hj">用模型识别有利可图的交易策略</strong>，最后一篇文章关注的是程序中的实际实现(<strong class="il hj">部署</strong>)。本文末尾给出了链接。</p><p id="023b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">现在我们已经创建了我们的预测变量<em class="ik"> X </em>和我们的输出<em class="ik"> Y </em>(第一篇— [1])，是时候建立和训练几个深度学习模型来从<em class="ik"> X </em>预测<em class="ik"> Y </em>了。为此，我将展示如何用Python轻松地构建这样一个模型，训练它，并最终在一个验证集上评估它的准确性。该代码也可以很容易地适应任何其他输入格式。</p><p id="db24" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">本文对该过程进行了总结，以展示非常关键的信息。文章分解如下:</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="3288" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> 0 —导入库并定义常量</strong></p><p id="6876" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> I —训练深度神经网络</strong></p><p id="35d7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> II —比较模型在验证集上的性能</strong></p><p id="fe33" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">三—结论</strong></p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="29e4" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak"> 0 —导入库并定义常量</strong></h1><p id="21ea" class="pw-post-body-paragraph ii ij hi il b im ky io ip iq kz is it jh la iw ix ji lb ja jb jj lc je jf jg hb bi translated">第一步是导入库，(重新)定义我们的<em class="ik">止损</em> / <em class="ik">止盈</em>，并定义我们希望模型适合的主要组件集。例如，在下面提供的代码中，我们将使用10到40台不同数量的PC来构建和适应深度学习模型。目标是比较它们在验证集上的准确性，并最终选出最好的一个来创建交易策略。</p><p id="0904" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们记得在前面的步骤中(文章I [1])，我们保存了数据集，也保存了应用缩放和PCA后的关联数据集。这些后者被称为<em class="ik"> xxxx_ </em> <strong class="il hj"> <em class="ik">最终</em> </strong> <em class="ik"> _xxx.csv、</em>和<strong class="il hj">这些集合将用于预测</strong>。</p><p id="4670" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">加载数据和库的代码写在下面:</p><figure class="ld le lf lg fd lh"><div class="bz dy l di"><div class="li lj l"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图1:加载数据和库，初始化我们的代码</figcaption></figure><h1 id="17ca" class="ka kb hi bd kc kd lo kf kg kh lp kj kk kl lq kn ko kp lr kr ks kt ls kv kw kx bi translated"><strong class="ak"> I —训练深度神经网络</strong></h1><p id="9807" class="pw-post-body-paragraph ii ij hi il b im ky io ip iq kz is it jh la iw ix ji lb ja jb jj lc je jf jg hb bi translated">一旦我们加载了所有的数据，下一步就是建立和训练几个深度学习模型。我决定建造DL模型是因为它们令人印象深刻的性能，以及用<em class="ik"> Keras </em>建造它们相当容易的事实。</p><p id="3408" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我开发的架构相当简单，由<strong class="il hj"> 4个隐藏层</strong>组成。输入层的维度为<em class="ik"> nPCs </em>，其中<em class="ik"> nPCs </em>是我们用于特定回归的主成分的数量。输出层使用<strong class="il hj"> sigmoid函数</strong>【2】作为激活函数，使用<strong class="il hj"> Adam优化器</strong>【3】、<strong class="il hj">二进制交叉熵损失函数</strong>【4】和<strong class="il hj">准确度</strong>作为评估标准，在<em class="ik"> keras </em>中训练模型。</p><p id="3720" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们记得，PCs是按重要性排序的(<em class="ik">即</em>它们包含的方差)，这意味着第一个PCs应该是携带最相关信息的PCs。情况并非总是如此，但通常如此。</p><p id="b6b3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我的模型的架构显示在下面，在这个特定的例子中有<em class="ik"> nPCs = 10 </em>:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lt"><img src="../Images/779f7fdb4a2bfc22f36f7516a8807016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*W_lNlsKQRHQklUdydW99Cg.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图2:深度学习网络架构(用于说明的软件[5])</figcaption></figure><p id="ebe0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">构建和训练这几个DL模型的代码写在那里:</p><figure class="ld le lf lg fd lh"><div class="bz dy l di"><div class="li lj l"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图3:构建和训练DL模型</figcaption></figure><h1 id="3906" class="ka kb hi bd kc kd lo kf kg kh lp kj kk kl lq kn ko kp lr kr ks kt ls kv kw kx bi translated"><strong class="ak"> II —比较模型在验证集上的表现</strong></h1><p id="6524" class="pw-post-body-paragraph ii ij hi il b im ky io ip iq kz is it jh la iw ix ji lb ja jb jj lc je jf jg hb bi translated">一旦我们建立了我们的模型，现在是时候将它们与验证集进行比较了。这一步很重要，因为我们在这里对模型进行排序，这将最终决定我们将使用哪个模型进行潜在的现实交易。</p><p id="c7de" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">为此，我们只需加载我们之前训练的每个模型，计算验证集的预测，并将所有结果存储在一个<em class="ik">中。csv </em>文件。</p><p id="fdcf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik"> NB : </em> </strong> <em class="ik">正如我们寻求只赌</em> <strong class="il hj"> <em class="ik">看涨</em> </strong> <em class="ik">趋势一样，我们只评估</em> <strong class="il hj"> <em class="ik">看涨预测</em> </strong> <em class="ik">(即当模型预测1) </em> <strong class="il hj"> <em class="ik">。</em> </strong> <em class="ik">这意味着nPCs = 10的46.63 %的准确率应该解释为:模型预测' 1 '的时候，46.63 %的时间发生了。</em></p><p id="0948" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在我们的例子中，止损= 5%,止盈= 10%,所以<em class="ik">先验</em>我们期望的精确度在33%左右。实际上，在验证集上有以下比例的看涨结果(<em class="ik">结果’= 1</em>)，因为这一时期总体上相当看涨:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lw"><img src="../Images/12ec425b3876d70356a8681d3fc3bd3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*CNITo6U1n1gLotyQ9wPOBw.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图4:验证集平均看涨结果</figcaption></figure><p id="b815" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">获得<strong class="il hj"> 46.98%则可以认为是良好的性能(见图5) </strong>。但是，精确度只对模型的排序有用。此外，我们所有的模型都比验证集上的平均再分配做得好:这是一个很好的观点，我们比盲目交易做得更好。).</p><p id="f160" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">然后，我们可以看一看汇总表，并绘制它。我们可以观察到，使用<em class="ik"> nPCs = 20 </em>可以获得最佳性能:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lx"><img src="../Images/133aedd971b3b8be1edfb5fe3115c913.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*WRFJJLQHhXrFKW_D7NxqNg.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图5:验证集的精确度对比</figcaption></figure><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ly"><img src="../Images/8d9cb5289f58efb173a164d5a240b4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrLdedkWVRrmj8cfuW9Usg.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图6:前面表格的绘制</figcaption></figure><p id="6ffa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在<em class="ik">验证集</em>上评估模型的代码如下:</p><figure class="ld le lf lg fd lh"><div class="bz dy l di"><div class="li lj l"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图7:评估验证集上的模型，并将比较结果存储在一个. csv文件中</figcaption></figure><h1 id="5cfd" class="ka kb hi bd kc kd lo kf kg kh lp kj kk kl lq kn ko kp lr kr ks kt ls kv kw kx bi translated"><strong class="ak">三—结论</strong></h1><p id="cd16" class="pw-post-body-paragraph ii ij hi il b im ky io ip iq kz is it jh la iw ix ji lb ja jb jj lc je jf jg hb bi translated">在这一步之后，我们现在已经完成了在我们的数据集上构建、训练和评估各种深度学习模型。我们可以对我们的结果非常有信心，我们的模型的排名将允许我们在下一步中创建有利可图的战略(第三篇— <em class="ik">即将推出</em>)。</p><p id="8e46" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们还可以回忆一下，完整的代码可以在[6]中找到。我写的关于建造一个高级交易机器人的论文全文见[7]。</p><p id="5a61" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">不要犹豫，留下任何反馈/问题/ <em class="ik">掌声</em>或联系我获取更多信息。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="7951" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">联系人:</strong> sebcararo@hotmail.fr</p><p id="9228" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">本系列其他文章:</strong></p><ul class=""><li id="8df3" class="md me hi il b im in iq ir jh mf ji mg jj mh jg mi mj mk ml bi translated"><a class="ae mm" rel="noopener" href="/analytics-vidhya/i-a-turnkey-python-code-for-creating-a-stock-forecasting-dataset-ad25f673f3b7"> I .用于创建股票预测数据集的交钥匙Python代码|作者sébastien Cararo | Analytics vid hya | 2020年12月| Medium </a></li><li id="538e" class="md me hi il b im mn iq mo jh mp ji mq jj mr jg mi mj mk ml bi translated"><a class="ae mm" rel="noopener" href="/analytics-vidhya/iii-creating-profitable-trading-strategies-1858a2fc8b85">三。创造有利可图的交易策略|作者sébastien Cararo | Analytics vid hya | 2020年12月| Medium </a></li><li id="00e5" class="md me hi il b im mn iq mo jh mp ji mq jj mr jg mi mj mk ml bi translated"><a class="ae mm" rel="noopener" href="/analytics-vidhya/iv-deploy-a-poloniex-trading-bot-c3af87eba48c">四。部署Poloniex交易机器人|作者:sébastien Cararo | Analytics vid hya | 2020年12月| Medium </a></li></ul><p id="8373" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">另一篇文章</strong> <em class="ik">(用机器学习构建体育博彩算法)</em> <strong class="il hj"> </strong> <a class="ae mm" rel="noopener" href="/analytics-vidhya/how-covid-19-prevented-me-from-being-a-millionnaire-in-2020-5b2144e8bdef">新冠肺炎如何阻止我在2020年成为百万富翁|作者sébastien Cararo | Analytics vid hya | 2020年12月| Medium </a></p><p id="568b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">来源</strong></p><p id="3119" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[1]第一条</p><p id="e989" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">https://medium . com/analytics-vid hya/I-a-turn key-python-code-for-creating-a-stock-forecasting-dataset-ad25 f 673 F3 b 7</p><p id="531e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">sigmoid函数</p><p id="d0bd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">https://www.youtube.com/watch?v=WsFasV46KgQ</p><p id="6a45" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">Adam优化器</p><p id="a034" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">https://keras.io/api/optimizers/</p><p id="8e60" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[4]二元交叉熵损失函数</p><p id="5f2a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">https://gombru . github . io/2018/05/23/cross _ Entropy _ loss/#:~:text = Binary % 20 cross-Entropy % 20 loss % 20 also % 20 called % 20 sigmoid % 20 cross-Entropy % 20 loss。，组件% 20不受% 20其他% 20组件% 20值% 20影响。</p><p id="40ca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[5]用于说明的软件</p><div class="ms mt ez fb mu mv"><a href="http://alexlenail.me/NN-SVG/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hj fi z dy na ea eb nb ed ef hh bi translated">神经网络SVG</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">可供出版的神经网络架构示意图。下载SVG</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">alexlenail .我</p></div></div></div></a></div><p id="4ce5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[6] GitHub知识库</p><p id="bc19" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">https://github.com/Seb943/TBpolo</p><p id="2067" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[7]全文</p><p id="7eb9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">https://seb943.github.io/Data/Paper_CreatingATradingBot.pdf</p><p id="3b25" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">使用的软件:</strong>Pyzo IDE中的Python 3.8.5</p></div></div>    
</body>
</html>