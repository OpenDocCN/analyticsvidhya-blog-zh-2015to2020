<html>
<head>
<title>Reinforcement Learning with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python进行强化学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/reinforcement-learning-with-python-e458895d8abc?source=collection_archive---------9-----------------------#2020-03-11">https://medium.com/analytics-vidhya/reinforcement-learning-with-python-e458895d8abc?source=collection_archive---------9-----------------------#2020-03-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0e60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">更新:</em> </strong> <em class="jd">本文是一个系列的一部分，查看上一部分</em> <a class="ae je" rel="noopener" href="/@randadpratik456/a-beginners-guide-to-reinforcement-learning-88a330d8d94e"> <em class="jd">这里</em> </a> <em class="jd">，学习强化学习的基础知识。</em></p><p id="0b0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了应用强化学习，存在不同的算法，如:</p><ol class=""><li id="e6bb" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">置信上限</li><li id="8391" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">汤普森取样法</li></ol><p id="1c43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们将使用Python实现置信上限算法</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/9be4b87c213a15e894012bc14f9656c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*ZbFEUIeqmtBSgfdm.jpg"/></div></figure><h2 id="a463" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">置信上限直觉:</h2><p id="2bcf" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">想象一下，你在一个赌场里有一些钱，你想通过在吃角子老虎机上玩赢得更多。但是有5种不同的机器，每一种机器产生钱的机会都不一样，我们不知道。<strong class="ih hj">这怎么解决？<br/> </strong>使用置信上限(UCB)算法我们有很好的机会找出最好的机器。</p><blockquote class="lb lc ld"><p id="28a4" class="if ig jd ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">分析问题</p></blockquote><p id="0180" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每台机器都有不同的输出分配。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lh"><img src="../Images/7552b7175b67cee91ed6007e643fd3a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uuGhlZzn9L2cPR2DGT3tfw.png"/></div></div></figure><p id="5475" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些输出分布对我们来说是未知的。让我们在单个轴上绘制每台机器的假设平均输出，因为我们不知道我们假设所有机器具有相同的输出:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lm"><img src="../Images/59ef8095262fbe6d987a10212f3ffdd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wgQBQ4LM45otsAhSCNi3UQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">实际产出与假设产出</figcaption></figure><p id="e8f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里红色虚线表示假设的输出，其他线表示实际输出。<br/>UCB所做的是，对于每台机器，它将形成一个具有高度确定性的置信带，它将包括如图所示的实际预期回报。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lr"><img src="../Images/c4627249be25985ebb5ac0303e7b9155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAWeFM9AQUiK1EfwAFzk5Q.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">置信带</figcaption></figure><p id="ec91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第一轮中，我们将尝试每台机器，以便形成置信区间。<br/>现在我们随机选择一台机器，假设选择D3。该轮没有返回任何金额，因此其平均值增加了一个值，并降低了级别，因此置信区间变得更强，以涵盖实际产出，如下所示:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ls"><img src="../Images/159af3039bc215afb33424d2178078a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YleKBZ1hJpUTslf9wAbWWg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">选择D3</figcaption></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lm"><img src="../Images/c8492b86f6ef1cb308d25635957397b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0dKdNzrJkS2OxT74bUlfJg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">D3假定值下降</figcaption></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lt"><img src="../Images/ee82c1b632154345b5ea8f2542faf76d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*epEU2r-9dR7JxtX5tdjzIQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">置信区间减小</figcaption></figure><p id="6aa1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个置信区间最终会收敛到实际值。<br/>现在选择随机加工D4，重复相同的过程。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ls"><img src="../Images/2b66228baefd27984044e630a2efcc90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpmDnpHOMryDT1l0SiL_kw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">D4被选中</figcaption></figure><p id="b5ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以同样的方式，在最初的几轮中，选择所有的机器来获得一个初步的想法。<br/>现在，对于下一次迭代，选择具有<strong class="ih hj">最高上限水平</strong>的机器进行下一次迭代。因此得名置信上限。</p><p id="a02b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个过程持续进行，并且对于每次迭代，只有具有最高UCB水平的机器被选择并被利用。这创造了b/w勘探与开发的平衡。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lt"><img src="../Images/6cf14b8bbc7b4a29197d731f8bb641f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oNdyYl9wvQU5FfKRKJGqJA.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">决赛成绩</figcaption></figure><p id="42f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们发现和利用D5机器的长期结果，因为它是最好的机器。</p></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><h1 id="5a4d" class="mb kc hi bd kd mc md me kh mf mg mh kl mi mj mk ko ml mm mn kr mo mp mq ku mr bi translated">用Python实现</h1><p id="1692" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">在这里，我们将创建一个通用的解决方案，以便它可以用于任何数量的吃角子老虎机，广告等，并可以给出使用UCB的最佳机器的输出。</p><h2 id="1154" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">问题定义:</h2><p id="e6a6" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">我们有10个不同的广告显示给用户。对于每次添加，用户将点击它或放手。根据这种互动，我们需要找出可以用于营销的最佳广告，以促进销售。<br/>下面是所用数据集的一瞥:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ms"><img src="../Images/168ba182962b733a6e225f4eb8c522fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zX0vIpsLVPyDkAtPVkYUIw.png"/></div></div></figure><blockquote class="lb lc ld"><p id="a8fd" class="if ig jd ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">这个数据集显示了如果每个广告被显示给不同的用户时用户的反应。<br/>示例:对于10个广告中id=0的用户，用户将点击广告1、5、9。<br/>我们需要找到一种方法，为用户谁登录到网站的下一个最佳广告必须使用UCB显示。</p></blockquote><p id="c02f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mt"><img src="../Images/54178709988098e127f5eb175af6ac64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w43hLxo15AkFh4MPi8SoBQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">UCB</figcaption></figure><blockquote class="lb lc ld"><p id="c757" class="if ig jd ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">导入所需的库和数据集</p></blockquote><pre class="ju jv jw jx fd mu mv mw mx aw my bi"><span id="955c" class="kb kc hi mv b fi mz na l nb nc"># Importing the libraries<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span><span id="7b93" class="kb kc hi mv b fi nd na l nb nc"># Importing the dataset<br/>dataset = pd.read_csv(‘Ads_CTR_Optimisation.csv’)</span></pre><blockquote class="lb lc ld"><p id="750f" class="if ig jd ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">第一步</p></blockquote><pre class="ju jv jw jx fd mu mv mw mx aw my bi"><span id="b1c8" class="kb kc hi mv b fi mz na l nb nc">#d is the no. of ads<br/>d=10<br/># N is no. of times the ads is shown to different users<br/>N=10000<br/># Ni(n)and Ri(n)vectors<br/>number_of_selections=[0] * d<br/>sum_of_rewards=[0] * d<br/>#array of ads selected for each round<br/>ads_selected=[]<br/>#total reward generated <br/>total_reward=0</span></pre><blockquote class="lb lc ld"><p id="6620" class="if ig jd ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">第二步和第三步</p></blockquote><p id="5338" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在前10轮中，将选择每个广告，以便为创建信心带创造一些认知。然后，对于每个下一轮，具有最高上限的广告被选择，并且其奖励被添加到<em class="jd"> total_reward。<br/> </em>该算法将在循环出借时获得最优广告。这里只需改变N和d，它就可以用于任何数量的广告、吃角子老虎机等。</p><pre class="ju jv jw jx fd mu mv mw mx aw my bi"><span id="2046" class="kb kc hi mv b fi mz na l nb nc">import math<br/>for n in range(0,N):<br/> max_upper_bound=0<br/> ad=0<br/> for i in range(0,d):<br/> if(number_of_selections[i]&gt;0):<br/> average_reward=sum_of_rewards[i]/ number_of_selections[i]<br/> confidence_interval=math.sqrt((3/2 * math.log(n) / number_of_selections[i]))<br/> upper_bound=confidence_interval + average_reward<br/> else:<br/> upper_bound=10e400<br/> if(upper_bound&gt;max_upper_bound):<br/> max_upper_bound=upper_bound<br/> ad=i<br/> ads_selected.append(ad)<br/> number_of_selections[ad]+=1<br/> reward=dataset.values[n,ad]<br/> sum_of_rewards[ad]+=reward<br/> total_reward+=reward</span></pre><p id="1781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择的前10个广告与后10个广告</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es ne"><img src="../Images/e423b9c7ee17c70f0499dff3ed10b105.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*Wm6G-FMc3QOqZmm4z8jXWw.jpeg"/></div></figure><p id="87aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">UCB被选为最佳广告。<br/>所选广告直方图显示最优广告。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es nf"><img src="../Images/06700432118f80f44bee803bfb5ecbeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*nRrRVBjGL9pSZEI657aPgg.png"/></div></figure><h1 id="6072" class="mb kc hi bd kd mc ng me kh mf nh mh kl mi ni mk ko ml nj mn kr mo nk mq ku mr bi translated">最终注释</h1><p id="38d1" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">这是我的第一篇系列文章，我希望你能学到一些东西！如果你们对这篇文章有什么想补充的，请随时留言，不要犹豫！我们真诚感谢任何形式的反馈。不要害怕分享这个！谢谢！</p></div></div>    
</body>
</html>