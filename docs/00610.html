<html>
<head>
<title>Introduction To K-Nearest Neighbors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">K近邻介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hello-f4a9317ad?source=collection_archive---------3-----------------------#2019-08-15">https://medium.com/analytics-vidhya/hello-f4a9317ad?source=collection_archive---------3-----------------------#2019-08-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="348c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">k-最近邻是简单的算法。这种算法的优点在于它的简单性。尽管它有各种缺点，如高维数据的高计算时间，但它仍然广泛应用于生物信息学和计算机视觉任务领域。</p><p id="3f1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="http://www.cs.umd.edu/~samir/498/10Algorithms-08.pdf" rel="noopener ugc nofollow" target="_blank">链接本文使K-NN成为十大机器学习算法之一</a>。</p><p id="d722" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你阅读K-NN时，你会遇到一些术语，如<strong class="ih hj">监督学习、超参数调整、非参数、距离测量、分类、回归、懒惰学习者</strong>。</p><blockquote class="je jf jg"><p id="cfe7" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">监督学习</strong>——学习给定输出标签的任务。</p><p id="bb57" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">分类</strong> -这是一项监督学习任务，其中标签是离散值或标签，例如，如果您根据肿瘤检查患者是否患有癌症，您将获得恶性和良性肿瘤标签。这可以扩展到不止一个二进制类，但标签是离散值。</p></blockquote><p id="dd58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">回归</strong> - <em class="jh">这是一项受监督的学习任务，我们在给定实值数据的情况下预测结果。属于这一类的预测问题是用给定时间数据预测股票市场价格、房地产价格。</em></p><h2 id="adf2" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">这里最好的部分是我们可以使用K-NN来完成监督学习任务。</h2><ul class=""><li id="6239" class="kg kh hi ih b ii ki im kj iq kk iu kl iy km jc kn ko kp kq bi translated"><strong class="ih hj">懒惰的学习者</strong>——把这当成一个考试前一天学习的学生。你可能会看到他们在考试中表现很好，这些考试不需要太多的概念理解，或者通过这些考试所需的概念严谨性很低。来自印度工程学院的学生读了这篇文章可能会更好地理解这个概念。</li><li id="3ec5" class="kg kh hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><em class="jh">这是它在高维数据上失败的主要原因。这里的失败意味着两方面</em> :-</li></ul><ol class=""><li id="1f9d" class="kg kh hi ih b ii ij im in iq kw iu kx iy ky jc kz ko kp kq bi translated"><em class="jh">如果您有一家互联网公司，其业务需求要求低延迟，即您需要快速的查询输出。K-NN可能要花很长时间。</em></li><li id="0732" class="kg kh hi ih b ii kr im ks iq kt iu ku iy kv jc kz ko kp kq bi translated"><em class="jh">由于数据分布的原因，您可能无法在K-NN上获得最佳性能指标分数。K-NN通常倾向于高偏差模型，即基于距离度量做出决策</em>。</li></ol><ul class=""><li id="8da7" class="kg kh hi ih b ii ij im in iq kw iu kx iy ky jc kn ko kp kq bi translated"><strong class="ih hj">距离测量</strong></li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es la"><img src="../Images/96cf26ef19b7fc7c6bf3f2b235418311.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*10Ax3s9vQzPPYeTTVhlQKg.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">来源谷歌图片</figcaption></figure><p id="3c8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有很多测量距离的方法，这里有一些最突出的。</p><ul class=""><li id="8a03" class="kg kh hi ih b ii ij im in iq kw iu kx iy ky jc kn ko kp kq bi translated"><strong class="ih hj">超参数</strong> -这就像你对模型的调节，在这种情况下，K是决定你选择的邻居数量的超参数。</li></ul><p id="a7cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经讨论了一些典型的机器学习术语，现在让我们从直观的角度来看K-NN。</p><h1 id="c458" class="lm jm hi bd jn ln lo lp jr lq lr ls jv lt lu lv jy lw lx ly kb lz ma mb ke mc bi translated">KNN的直觉-明智地选择你的朋友！</h1><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es md"><img src="../Images/cefe72cb329541c1a83f7fb626fa3702.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*zDjIz2D8hkkFDZ1uEflGOA.png"/></div></figure><p id="0bab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想象一下，你想要一些建议，你有两组朋友，你想从他们那里得到建议。让我们把蓝色的点称为你的学校朋友，红色的点称为你的大学朋友。你是微笑的人，如果你应该去看动作片或爱情片，你想听听他们的建议。基于一些衡量标准，你会做出决定，最有可能的是，当你在你的大学朋友身边时，你会受到他们的影响，做出与他们相似的决定，如果你在你的学校朋友身边，你会做你的学校朋友会做的事情。</p><p id="6073" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的距离决定了你的决定，就像在图像中一样，如果你离蓝点越近，你可能会变成蓝点，否则会变成红色。</p><h1 id="bfe4" class="lm jm hi bd jn ln lo lp jr lq lr ls jv lt lu lv jy lw lx ly kb lz ma mb ke mc bi translated">KNN的失败案例</h1><p id="e234" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq me is it iu mf iw ix iy mg ja jb jc hb bi translated">这个简单的例子只是为了让你对K-NN如何工作有一个高层次的认识，但是即使在这个例子中，事情也可能不会像人们进化时那样工作，社交网络是非常动态的，并且不断变化，某些人(影响你的人也可能是一个离群点！)比一个团体更能影响你。</p><h1 id="f8f2" class="lm jm hi bd jn ln lo lp jr lq lr ls jv lt lu lv jy lw lx ly kb lz ma mb ke mc bi translated">带代码的真实单词示例</h1><p id="e376" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq me is it iu mf iw ix iy mg ja jb jc hb bi translated">我们将使用皮马印第安人糖尿病数据库中的KNN来预测患者是否患有糖尿病。我们将介绍列车测试分割、超参数调整的概念，并通过使用sklearn功能解释这些概念。</p><pre class="lb lc ld le fd mh mi mj mk aw ml bi"><span id="b315" class="jl jm hi mi b fi mm mn l mo mp">import numpy as np # linear algebra<br/>import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)<br/>from sklearn.model_selection import train_test_split #to split into train and test<br/>from sklearn.model_selection import GridSearchCV #for hyperparam tuning<br/>from sklearn.neighbors import KNeighborsClassifier #KNN Classifier</span></pre><p id="09d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入所需的库后，我们将加载数据集。我使用过Kaggle内核，它是一个类似jupyter笔记本的界面，你可以在那里导入kaggle数据集，而不需要下载到本地机器上。</p><pre class="lb lc ld le fd mh mi mj mk aw ml bi"><span id="0a97" class="jl jm hi mi b fi mm mn l mo mp">df=pd.read_csv("../input/diabetes.csv")<br/>df.head() #print's the top 5 rows in the dataframe</span></pre><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es mq"><img src="../Images/ea37726b1a43f5614abf15b145ccda03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4XItba4zyMbhtNEHEbBmQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">PIMA数据集</figcaption></figure><p id="0a59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，该数据集有768行和9列，结果是指示糖尿病存在与否的预测值标签。</p><pre class="lb lc ld le fd mh mi mj mk aw ml bi"><span id="6b71" class="jl jm hi mi b fi mm mn l mo mp">y=df['Outcome'] <br/>X=df.drop('Outcome',axis=1)</span></pre><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mv"><img src="../Images/635aa50d2f066ad6e59872b476f91cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*u5x3HglKFDr7-y_woFzMmQ.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">类别分布计数</figcaption></figure><blockquote class="je jf jg"><p id="f4a5" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">我们找到了这个比率，以便进行相应的列车测试。考虑训练测试分割的概念，即准备一个测试，你学习一些问题，在测试中你得到新的问题。提出新问题的整体想法是看学生对概念的掌握程度。所以把训练和测试分开总是一个好的做法。如果测试看到的是训练数据，那么它会导致数据泄漏，我们可能会得到一个非常好的模型分数，但它并不服务于模型建立的目的。测试的整个想法是检查一个模型在看不见的数据上做得有多好。</p></blockquote><p id="c04c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">交叉验证</strong></p><p id="5844" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在进入超参数调整的细节之前，让我们理解交叉验证的概念。</p><p id="b775" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练模型的性能取决于数据的拆分方式。它可能不代表模型的概括能力。</p><p id="9916" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决方法是交叉验证。</p><p id="a39a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">交叉验证是一种评估预测模型的技术，方法是将原始样本划分为训练模型的训练集和评估模型的测试集。</p><p id="6006" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在k重交叉验证中，原始样本被随机分成k个大小相等的子样本。在k个子样本中，保留一个子样本作为测试模型的验证数据，剩余的k-1个子样本用作训练数据。然后，交叉验证过程重复k次(折叠)，k个子样本中的每一个正好用作验证数据一次。来自折叠的k个结果然后可以被平均(或以其他方式组合)以产生单个估计。这种方法的优点是，所有的观察值都用于训练和验证，并且每个观察值只用于验证一次。</p><p id="e0b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以输入K值作为邻居的数量，并检查模型性能。相反，我们将进行超参数调整，即我们取一组K值，对其执行KNN，并选择一个在测试数据上给出最佳模型分数的值，因为存在过拟合和欠拟合的机会。当模型在训练中学习得很好而在训练中表现很差时，就会发生过拟合。当它在训练中学习很差，并且在测试数据上的表现也很低时，就会发生欠适应。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es mw"><img src="../Images/e7a9427335ad02ea156389775803dd9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ePMqfevdkn4GBgvsZKrCcw.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">来源:谷歌图片</figcaption></figure><pre class="lb lc ld le fd mh mi mj mk aw ml bi"><span id="6ac9" class="jl jm hi mi b fi mm mn l mo mp">model=KNeighborsClassifier() # KNN Classifier<br/>param_grid = {'n_neighbors':np.arange(1,50)} # taking K[1:50]</span><span id="19d5" class="jl jm hi mi b fi mx mn l mo mp">knn= GridSearchCV(model,param_grid,cv=5,scoring='roc_auc',n_jobs=-1,pre_dispatch='2*n_jobs') #Grid Search for Hyperam Tuning<br/>knn.fit(X_tr,y_tr) #fit the KNN model on the train data</span></pre><h1 id="2c80" class="lm jm hi bd jn ln lo lp jr lq lr ls jv lt lu lv jy lw lx ly kb lz ma mb ke mc bi translated">ROC-AUC度量</h1><p id="86c6" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq me is it iu mf iw ix iy mg ja jb jc hb bi translated">如您所见，数据集不平衡，比例为65:35。想象一下，如果我编写一个单行模型，表示print(1 ),我将在该模型上获得65%的准确性。因此，在大多数情况下，必须避免准确性，因为真实世界的数据永远不会平衡。</p><p id="ee01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5" rel="noopener" target="_blank">这篇</a>博客很好地解释了ROC-AUC指标。当数据不平衡时，ROC-AUC指标是一个很好的指标。AUC表明，给定正类点数和负类点数，点数被正确分类的概率为78%。</p><pre class="lb lc ld le fd mh mi mj mk aw ml bi"><span id="de4b" class="jl jm hi mi b fi mm mn l mo mp">knn.best_params_    #{'n_neighbors': 10}<br/>knn.best_score_     #0.783873305758252</span></pre></div></div>    
</body>
</html>