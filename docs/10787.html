<html>
<head>
<title>Automatic Model Selection and Parameter Optimization with Hyperopt-Sklearn for Breast Cancer Classification .</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于hyperpt-sk learn的乳腺癌分类自动模型选择和参数优化。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automatic-model-selection-and-parameter-optimization-for-breast-cancer-classification-with-7c912bd66eb3?source=collection_archive---------17-----------------------#2020-11-02">https://medium.com/analytics-vidhya/automatic-model-selection-and-parameter-optimization-for-breast-cancer-classification-with-7c912bd66eb3?source=collection_archive---------17-----------------------#2020-11-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ee99f6f7a70bacfb62bb153438383569.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKKOgb3iz6lzY-rPQVk36Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在<a class="ae iu" href="https://unsplash.com/s/photos/breast?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae iu" href="https://unsplash.com/@ang10ze?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">angula Harry</a>拍摄的照片</figcaption></figure><p id="89bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">乳腺癌是美国最常见的癌症，也是仅次于肺癌的第二大癌症死亡原因(<a class="ae iu" href="https://gis.cdc.gov/Cancer/USCS/DataViz.html" rel="noopener ugc nofollow" target="_blank"> 2017年数据</a>)。准确的诊断对于正确的乳腺癌管理，包括治疗选择是必不可少的。病理学家评估病变的整体结构和形态学特征，如细胞核与细胞质的比率以及各种细胞质和细胞核特征。细胞核的形态特征在癌症诊断中是必不可少的。</p><p id="77e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">多亏了来自威斯康星大学的研究人员，我们有了一个良性和恶性细胞的核特征的大数据集。乳腺癌数据集包含在<a class="ae iu" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_breast_cancer.html" rel="noopener ugc nofollow" target="_blank"> sklearn.datasets </a>库中。让我们快速浏览一下。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="fb83" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该数据集包含569个实例、30个数值预测属性和两个类。良性类别包含357个条目，恶性类别包含212个条目，存在轻微的类别不平衡。</p><p id="0ccc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，让我们看看这些预测属性是如何相互关联的，以及与目标是如何关联的。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jz jy l"/></div></figure><p id="1427" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于大量的属性，可能更容易阅读条形图。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jz jy l"/></div></figure><p id="6b4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如我们所看到的，“平滑误差”与癌症诊断正相关，但不如“最差凹点”、“最差周长”和“平均凹点”的负相关那么强从病理学家的角度来看，这完全说得通，因为细胞核越大、越不规则，就越有可能是恶性的。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jz jy l"/></div></figure><p id="ecdb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过对乳腺癌数据集的简短介绍，我们现在可以找到最佳模型和最佳参数，以基于上述30种细胞核属性将乳腺病变分类为良性还是癌症。</p><p id="fa1a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了完成这个目标，我们将使用hyperopt-sklearn。Hyperopt-sklearn是一个软件项目，它提供了Scikit-learn机器学习库的自动算法配置。对该库最好的描述来自Brent Komer <a class="ae iu" href="http://conference.scipy.org/proceedings/scipy2014/pdfs/komer.pdf" rel="noopener ugc nofollow" target="_blank">文章</a>:“遵循Scikit-learn的惯例，hyperopt-sklearn提供了一个具有<em class="ka"> fit </em>方法和<em class="ka"> predict </em>方法的<em class="ka">估计器</em>类。该类的<em class="ka"> fit </em>方法执行超参数优化，完成后，<em class="ka"> predict </em>方法将最佳模型应用于测试数据。优化过程中的每个评估都会对大部分训练集执行训练，估计验证集的测试集准确性，并将验证集分数返回给优化器。在搜索结束时，在整个数据集上重新训练最佳配置，以产生处理后续<em class="ka">预测</em>调用的分类器。”</p><p id="e274" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看它在实践中是如何工作的。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="722b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我对模型进行了几次训练，这些是我取得的最好结果。</p><p id="64f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">得分0.97的SGDClassifier。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/a295a95745a27d764f4693a8e0cff6a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTPicBXgsfIHySV6ZqlB8A.png"/></div></div></figure><p id="39da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">得分为0.94的GradientBoostingClassifier。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/06359a9cd728ee7b9f123a5b2c0cd414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IHBOG7iHcmWNwzIujxEDtQ.png"/></div></div></figure><p id="4a16" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">AdaBoostClassifier和ExtraTreesClassifer得到相同的分数0.93。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/d2fccd2cb5dfb6ce3c98561a72d3b80c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIFH40bBAiuMHNPHVwtfhw.png"/></div></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/33fb4e0f42e14ec1c816c66337b9276a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q48vrVYG1MIgJgwMwTkRDw.png"/></div></div></figure><p id="07ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">KNeighborClassifer得到了最差的0.87分。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/5c24fb4dc142e4c0c95f20e7ece3dae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tYF6i-aQvd7qSDkeGQXOrA.png"/></div></div></figure><p id="03a3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总之，Hyperopt-sklearn python包支持自动模型选择和参数搜索。它支持Scikit-Learn提供的标准机器学习算法。它易于使用，极大地加快了模型选择和初始参数设置的速度。进一步调整参数可能会改善结果。唯一的缺点是缺乏对K-fold交叉验证的支持，这限制了它在明显不平衡的数据集上的使用。</p><p id="3c9a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢你花时间阅读这篇文章。</p><p id="781a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这艰难的时刻致以最美好的祝愿。<br/>安德鲁<br/>T16】@坦帕帕斯</p></div></div>    
</body>
</html>