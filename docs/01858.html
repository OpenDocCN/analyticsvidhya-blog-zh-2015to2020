<html>
<head>
<title>Semantic Segmentation in PSPNet with implementation in Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PSPNet中的语义分割及其在Keras中的实现</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/semantic-segmentation-in-pspnet-with-implementation-in-keras-4843d05fc025?source=collection_archive---------6-----------------------#2019-11-18">https://medium.com/analytics-vidhya/semantic-segmentation-in-pspnet-with-implementation-in-keras-4843d05fc025?source=collection_archive---------6-----------------------#2019-11-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e000ad01161acf10a1c8dae17d513c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JcERmCEgvcm3QEwBNUKedQ.png"/></div></div></figure><p id="dcfd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于图像场景语义分割，PSPNet的性能优于其他语义分割网络，如FCN，U-Net，Deeplab。</p><p id="331e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将讨论PSPNet和在Keras中的实现。</p><h1 id="ad1b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">金字塔场景解析网络</h1><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/cf694c71d19fa6f40326a353d26ebe47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emYC4xYASMLb5bSHNLZHOg.png"/></div></div></figure><h2 id="ce60" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">a)输入图像</h2><p id="69ad" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">任何形状的输入图像通常维数大于(256，256)馈送到网络。</p><h2 id="7ecd" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">b)特征图</h2><p id="ca8b" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">获取输入图像并为图像构建特征映射。特征图是通过使用迁移学习或具有扩张卷积的刮擦网络馈送图像来提取的。由于大尺寸核比小尺寸核提取更多有用信息，但计算成本更高，膨胀卷积用小尺寸核收集大尺寸区域信息，以获得更高的<strong class="is hj">膨胀率</strong>到<strong class="is hj">保持尺寸与<strong class="is hj">输入图像</strong>相同</strong>。通常使用具有<strong class="is hj">膨胀</strong>的<strong class="is hj">剩余块</strong>来构建特征地图。特征图的数量<strong class="is hj"> N </strong>是一个超参数，需要调整以获得良好的结果。</p><h2 id="2cd4" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">c)金字塔池模块</h2><p id="c615" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">图像包含不同区域中从小区域到大区域大小不等的对象。全卷积网络(FCN)、U-Net和其他网络通过上采样和在不同级别上进行分割来构建特征图，用于分割所有区域中的所有对象。但是在PSPNet中，为了正确地分割所有大小的对象，特征地图被以不同的池大小平均汇集。</p><p id="fa24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分区域平均汇总以不同的规模进行，如<strong class="is hj">全球平均汇总、(2*2)、(3*3)、(4*4)、(6*6)、(8*8)..</strong> <br/>将<strong class="is hj"> N </strong>个不同大小的<strong class="is hj"> n </strong>特征图平均汇集后，通过执行<strong class="is hj"> 1*1 </strong>卷积，将每一级的特征图缩减为<strong class="is hj"> N/n </strong>个特征图。</p><p id="7d7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，如果N=512个特征地图，并且n=4个大小，如全局平均池，(2*2)、(4*4)、(8*8)，则在每个级别，512个特征地图减少到126个特征地图。</p><p id="9f4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每一级的N/n特征图<strong class="is hj">被上采样</strong>以使<strong class="is hj">具有输入图像的相同尺寸。</strong>对于上采样，使用双线性_插值或卷积_转置方法代替简单上采样。</p><p id="8cae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">金字塔池模块的输出是来自<strong class="is hj"> b </strong>的基本特征图和来自<strong class="is hj"> c </strong>的上采样平均池特征图的<strong class="is hj">连接</strong>。</p><h2 id="499c" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">d)最终预测</h2><p id="f9b1" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated"><strong class="is hj"> 2*N </strong>特征图被馈送到卷积层，并且根据输出层是如何构造的来生成类别的最终预测，例如不同对象的不同通道或单个通道。</p><h1 id="ee29" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">在Keras/Tensorflow中实现</h1><p id="e343" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">我们在PSPNet中应用语义分割的数据集是Kaggle的<a class="ae lk" href="https://www.kaggle.com/dansbecker/cityscapes-image-pairs" rel="noopener ugc nofollow" target="_blank"> Cityscapes图像对</a>数据集，大小为106 Mb。</p><h2 id="70ea" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">资料组</h2><p id="d35f" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">数据集包含两个文件夹训练图像(train)文件夹和验证图像(val)文件夹。在每个文件夹中，每个图像的形状都是<strong class="is hj"> (512，256，3 ) </strong>和<strong class="is hj">宽度=512，高度=256，通道=3 </strong>。其中每个图像包含未分割的原始图像和分割的图像。将正常图像分成<strong class="is hj"> train_imgs，valid_imgs </strong>，将分割图像分成数组<strong class="is hj"> train_masks，valid_masks </strong>。</p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><h2 id="9f32" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">网络体系结构</h2><p id="1222" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">一个简单PSPNet架构，具有以下参数:</p><p id="b363" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">模块b </strong>由3层带膨胀卷积的残差块构成，输出<strong class="is hj"> 256个特征图</strong>。</p><p id="0c9a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">模块C </strong>用<strong class="is hj">pool _ sizes globalaverageopooling，(2*2)，(4*4)，(8*8) </strong>定义，对于<strong class="is hj">上采样，使用双线性_插值</strong>。每个<strong class="is hj"> 256个汇集的特征地图</strong>缩减为<strong class="is hj"> 64个特征地图</strong>合并<strong class="is hj"> 512个特征地图共</strong>。</p><p id="5df5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">模块D </strong>只是512个特征图输出<strong class="is hj"> (256，256，3)维特征图</strong>的卷积层，这些特征图被<strong class="is hj">展平</strong>成单个大小为(256*256*3)的数组。</p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><div class="ln lo ez fb lp lq"><a href="https://www.kaggle.com/santhalnr/cityscapes-image-segmentation-pspnet" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">城市景观图像分割</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">Keras/Tensorflow中PSPNet的城市景观图像分割…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">www.kaggle.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me io lq"/></div></div></a></div><h2 id="e7d0" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">预言</h2><p id="e906" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">为了简单起见，用均方差(MSE)作为损失函数来预测图像的分割。</p><p id="a36f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用batch_size=10和优化器Adam、SGD、Nadam以学习率[ 0.001，0.001，0.01]训练的模型。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/cbfa7ca4b519e52aa1175680efce5fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Nt4yGww4l7NG4jyDqEURQ.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">1.正常图像，2。原始面具，3。预测掩码</figcaption></figure><p id="4e21" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我训练模型不到3小时。但是结果并不差。</p><h2 id="1e6b" class="kr jp hi bd jq ks kt ku ju kv kw kx jy jb ky kz kc jf la lb kg jj lc ld kk le bi translated">如何才能提高？</h2><p id="bf61" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">我从(0–255)的小网络和损失函数MSE中提取裸像素值，这对于分割任务来说不是最佳的。通过这样做，以下将改善图像分割。</p><ul class=""><li id="dd51" class="mk ml hi is b it iu ix iy jb mm jf mn jj mo jn mp mq mr ms bi translated">具有较高膨胀率的大型网络。</li><li id="2f00" class="mk ml hi is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms bi translated">通过应用二进制掩码或仅为<strong class="is hj">单个</strong>通道简单编号类别，为<strong class="is hj"> c </strong>类别构建尺寸为“c”的输出通道。</li><li id="ead1" class="mk ml hi is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms bi translated">对<strong class="is hj">单个</strong>通道的类别编号应用分类交叉熵，或任何其他损失函数，如骰子损失、加权交叉熵、用于<strong class="is hj"> c </strong>通道掩码的焦点损失。</li><li id="5c8c" class="mk ml hi is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms bi translated">调整参数<strong class="is hj"> N，N和池大小。</strong></li></ul><div class="ln lo ez fb lp lq"><a href="https://neptune.ai/blog/image-segmentation-in-2020" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">2020年的图像分割:架构、损失、数据集和框架</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">在这篇文章中，我们将使用深度学习深入研究图像分割的世界。我们将讨论:什么…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">海王星. ai</p></div></div><div class="lz l"><div class="my l mb mc md lz me io lq"/></div></div></a></div></div></div>    
</body>
</html>