<html>
<head>
<title>Application of various regression models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">各种回归模型的应用</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/application-of-various-regression-models-7388d6138527?source=collection_archive---------14-----------------------#2020-05-28">https://medium.com/analytics-vidhya/application-of-various-regression-models-7388d6138527?source=collection_archive---------14-----------------------#2020-05-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e27b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个数据科学项目通过代码！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/42dbe2980c2b71637fc202d8dcaaa87a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-UePFTZRnRO-Gij_"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jt" href="https://unsplash.com/@x_vinicius?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">vini cius Henrique</a>拍摄</figcaption></figure><h1 id="c696" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">简介</strong></h1><p id="1394" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在这个项目中，我们将涵盖各种回归模型。对于这个项目，我使用了来自UCI机器学习资源库的<a class="ae jt" href="https://archive.ics.uci.edu/ml/datasets/auto+mpg" rel="noopener ugc nofollow" target="_blank">自动MPG </a>数据集。共有9个属性:</p><p id="8ac6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.mpg:连续<br/> 2。气缸:多值离散<br/> 3。排量:连续<br/> 4。马力:连续<br/> 5。重量:连续<br/> 6。加速:连续<br/> 7。年款:多值离散<br/> 8。原点:多值离散<br/> 9。汽车名称:字符串(对于每个实例是唯一的)</p><h1 id="a0a0" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">目标</strong></h1><p id="ed40" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">该项目的目标如下:</p><ol class=""><li id="ec0b" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">尝试不同的回归方法，看看哪种方法的准确度最高。</li></ol><p id="167b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">说到这里，我们开始吧！</p><h1 id="52eb" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">导入库</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/1840f3933428aa82d26d4945c1b8e78c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*PLHO0a6DVasqqELAblumjA.png"/></div></figure><h1 id="fa78" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">读取数据</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/1568390ca674932952fc17fd5659100d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*MDm9I_22y_h64bFZv_s6Lg.png"/></div></figure><h1 id="dd95" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">了解数据</strong></h1><p id="877d" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">接下来，我想更好地了解我在做什么。</p><ul class=""><li id="7dff" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc li ld le lf bi translated">下面的代码块给出了关于数据的一般信息。</li><li id="a555" class="kx ky hi ih b ii lj im lk iq ll iu lm iy ln jc li ld le lf bi translated"><em class="lo">数据形状</em> — <strong class="ih hj">给出数据的形状。</strong></li><li id="e0a2" class="kx ky hi ih b ii lj im lk iq ll iu lm iy ln jc li ld le lf bi translated"><em class="lo"> data.isnull()。sum() </em> — <strong class="ih hj">给出每一列中缺失值的总数。</strong></li><li id="eb2d" class="kx ky hi ih b ii lj im lk iq ll iu lm iy ln jc li ld le lf bi translated"><em class="lo"> data.info() </em> — <strong class="ih hj">根据特征的数据类型给出信息。</strong></li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/29af8ccff01ee544827aee62be16ef90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*tCL8-HH9fnwupQ9zUMd7wA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/d5f7ea937c97e0417a2a1aeb571d722d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*H_xS0kRVfW7YnqyQ46ZNaA.png"/></div></figure><p id="9cb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总共有398行和9列。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/725699d853fdc434fb80115193cfc167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*kkP3dv7kQn8-_9a4t0wuBA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/34e66979d28e49d8a7e1182328b7cd51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*Zz1j1tAtFzmI7pq42rWyaQ.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ls"><img src="../Images/3b02253168990cd1da5d4db7228079a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*MeIAJ9YKIURhkGAn7RYd6A.png"/></div></figure><p id="0db1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为特性“马力”中有6个缺失值，给定为“？”，所以我们使用SimpleImputer类用最频繁的值替换缺失值。</p><p id="9eda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank">simple imputr</a>类提供了输入缺失值的基本策略。缺失值可以使用提供的常数值进行估算，或者使用缺失值所在的每列的统计数据(平均值、中值或最频繁值)进行估算。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/ca1449f14c5e317ab9a3cc8e900530ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*GSfOfugb0BCy6BIoacWw6Q.png"/></div></figure><p id="5987" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">马力是一个数字特征，但是在这个数据集中，这个特征是对象数据类型。所以我将feature马力的数据类型转换为浮点数据类型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lt"><img src="../Images/22cc55de3ed9146db58289948975e2bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*DMKkzux7OX7QzXC1IE9ALA.png"/></div></figure><p id="fe89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我想进一步探索我的数据。</p><h1 id="1cbb" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">探索性数据分析</strong></h1><p id="8ba0" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">EDA在任何机器学习项目中都扮演着非常重要的角色。它包括可视化数据，统计总结数据。为了从数据中获得更深入的见解，我使用了一些图表，如Pairplot和Countplot。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/19c12a630f25397289b5c1376fbf69e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*4JNeE_4T0vX0B2N2Uz_Gww.png"/></div></figure><p id="acdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“原点”变量中有3个唯一值，它们本质上是离散的。</p><p id="b706" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，</p><p id="44aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1代表美国，</p><p id="9ebf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2代表欧洲，</p><p id="a797" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3代表亚洲。</p><p id="3743" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我想看看数据集中所有变量的成对关系。</p><p id="38ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">pairplot绘制数据集中的成对关系。pairplot函数创建一个轴网格，这样数据中的每个变量将在y轴的一行中共享，在x轴的一列中共享。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lv"><img src="../Images/b79ba930e906aebddb85035aa245e7ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*JUEGXkzcWwxnNo7fnURszg.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/79dab0c375e434efa06cd6a1b176e78e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*QkPFsyP_sqqeIaEWL1UYjw.png"/></div></figure><p id="46a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从图中我们可以看出，重量、马力和排量与目标变量mpg呈负相关。</p><p id="8dfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计数图是一种条形图，给出变量中每个类别的计数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/9161aac84cd05a27ce1313200faa1182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*DH-xcFce67whyzBdAmviPg.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/f8061b55b64dd5c3292f034fde84b71b.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*gG9lEpjVul72q7CrohkEOA.png"/></div></figure><p id="308f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在该数据集中，有近200辆4缸汽车、100辆8缸汽车和75辆6缸汽车。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/7ad15533fb5e983af5acebfd10c47ef9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*ZUAm5IPju-uVg3P3S9S5Rg.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/04193fb79a7a17a4bdceed7bc271b857.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*Mc04FGYrqey5mPhCjtx9KQ.png"/></div></figure><p id="c0d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数汽车来自美国。</p><p id="3209" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何项目中最激动人心的部分！</p><p id="0ef7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为培训准备数据。我将数据分为特征变量矩阵(x)和目标变量向量(y)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/6e7d48cd39a9a6c26f4535603efee405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*kT-cKqXXG_fUv6JjQKfVfQ.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/f0ba9090dda5621cd36c156be279a44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*fGnqDWYo1Q50jV6769dYXw.png"/></div></figure><p id="532c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">拆分数据</strong></p><p id="df7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我将数据分成训练集和测试集，这样我就可以交叉验证我的模型，并确定它们的有效性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/281d370bef8ca9e6d46337b3ea41780d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*L4LKxpoSse_Sp-8gy2IkHw.png"/></div></figure><p id="ea5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于这些特征存在于不同的比例中，我们使用StandardScaler来标准化这些特征。标准化数据意味着它将转换数据，使其分布的平均值为0，标准差为1。为了均衡数据范围，标准化数据非常重要。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/ff9b60b77e79aa0bd63d88d69782e68d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*ENRUxpDLWzCZhqTPRF6Opg.png"/></div></figure><p id="b25b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经完成了数据预处理，我们准备应用各种回归模型。</p><p id="5de7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型1 —线性回归</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/a7115927ed0166f7830295442e9f835e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*sor1hYTyO04kXt8xJU_e7Q.png"/></div></figure><p id="3813" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了确定模型符合数据的程度，我使用了r平方分数作为评估标准。</p><p id="f6b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">r平方是数据与拟合回归线接近程度的统计度量。它也被称为决定系数，或多元回归的多重决定系数</p><p id="77c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">r平方始终介于0和100%之间:</p><ul class=""><li id="35a1" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc li ld le lf bi translated">0%表示该模型不能解释响应数据在其平均值附近的任何可变性。</li><li id="44db" class="kx ky hi ih b ii lj im lk iq ll iu lm iy ln jc li ld le lf bi translated">100%表示模型解释了响应数据围绕其平均值的所有可变性。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/ddc83acd9c8af85cfe027fe9be8ef7a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*Hj9GGZXkTQ4Si-hMHtyH9w.png"/></div></figure><p id="2c42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型2 —决策树回归</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/610ce01352cab3b8b1a64d7e0189efc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*9C1ucX_ZpJWFVAMSJu98AQ.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/773ad8459dfd7e8350abed1545fd1505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*i0g563096FLp25Pc9WtVTQ.png"/></div></figure><p id="1f86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型3 —支持向量回归</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/fc1cc32dd876153a65d70b5d597e6d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*0O_K_BCajRpBnlUp32rgUg.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/ff88ad7cba0bf70a86534f972a1da334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*CwdZ7Jzg1H3F13L-TWxVaQ.png"/></div></figure><p id="7c7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型4 —随机森林回归</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/978a522fd6a1832d68d149ea1ff941be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ZsjELwNcQA0IgZN7HqCYBQ.png"/></div></figure><h1 id="9684" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">结论</strong></h1><p id="7781" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">因此，在应用不同的回归模型并在测试集上比较其精度后，我们可以说随机森林回归在所有模型中具有最高的精度。</p><h1 id="2d4a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">感谢阅读！！</h1></div></div>    
</body>
</html>