<html>
<head>
<title>Neural Network to Predict Bike Sharing Rides</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络预测自行车共享骑行</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/neural-network-to-predict-bike-sharing-rides-397e0358ba45?source=collection_archive---------8-----------------------#2019-12-15">https://medium.com/analytics-vidhya/neural-network-to-predict-bike-sharing-rides-397e0358ba45?source=collection_archive---------8-----------------------#2019-12-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5b9922824eeb7d38b4e05993f2e3c1ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nbEEa2byurzsC8Pk6TVEIw.jpeg"/></div></div></figure><p id="ddde" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将讨论从头构建一个神经网络，使用真实数据集进行预测。这种方法将帮助我们更好地理解神经网络的概念。数据集可在以下位置找到:</p><p id="b22d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://archive.ics.uci.edu/ml/datasets/Bike+Sharing+Dataset" rel="noopener ugc nofollow" target="_blank">https://archive . ics . UCI . edu/ml/datasets/Bike+Sharing+Dataset</a></p><p id="26de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将创建两个文件:Jupyter Notebook和my_answers.py，它们将实际包含我们的神经网络和超参数。</p><p id="360c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.1我们开始用木星笔记本预测_自行车_共享_数据。我们执行所有必要的进口:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/6b7b863c0a2d43330af0885ddb379750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BWYfI8xRNFJQyLfUDzOOPw.png"/></div></div></figure><p id="b643" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第<code class="du ju jv jw jx b"><em class="jy">%matplotlib inline</em></code>行将matplotlib图形放在代码旁边。</p><p id="89de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jy">下两行:</em></p><pre class="jq jr js jt fd jz jx ka kb aw kc bi"><span id="aa04" class="kd ke hi jx b fi kf kg l kh ki">%load_ext autoreload<br/>%autoreload 2</span></pre><p id="6f7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每次执行新的一行之前，都会重新加载所有更改过的模块。</p><p id="707d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ju jv jw jx b">%config InlineBackend.figure_format = ‘retina’</code> <em class="jy"> </em>的目的是增加我们绘图的分辨率。</p><p id="6453" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ju jv jw jx b">import numpy as np</code> <em class="jy"> </em>是用Python包导入的基础科学计算。</p><p id="f527" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jy"> import pandas as pd </em>是Python库的导入，用于数据操作和分析。</p><p id="03b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ju jv jw jx b">import matplotlib.pyplot as plt</code> <em class="jy"> </em>导入模块“matplotlib.pyplot”，pyplot是matplotlib的绘图框架。</p><p id="79ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.2我们用<code class="du ju jv jw jx b">rides = pd.read_csv(data_path)</code><em class="jy"/><em class="jy"/>读取数据集用<em class="jy"> rides.head() </em>看数据帧的前5行</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/b1bdefab08bb3bba17c363bdebcfd7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xqfjlyShPFpLwaHoGuM4Bw.png"/></div></div></figure><p id="f63b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.3让我们来看一个图表，显示数据集中前10天左右骑自行车的人数。并不是每天24个条目。周末的客流量较低，而当人们骑自行车上下班时，客流量会出现高峰。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/82d9c8924bce5610cdd4fd9bbddf2029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-0JDd_8NR3LSwL6W6UUHw.png"/></div></div></figure><p id="f5fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.4我们用熊猫<code class="du ju jv jw jx b">get_dummies()</code>创建二进制虚拟变量</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kl"><img src="../Images/12f107640c4449c4b9e46163ac50ea41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oDo2_AyWlIDpJIl5E5_4CA.png"/></div></div></figure><p id="0869" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.5我们通过移动和缩放变量来标准化每个连续变量，使其平均值为零，标准差为1。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/45ef999882912d7dd4f60a957bf004c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4jA0Gb0zfWGqyuBXqvwaw.png"/></div></div></figure><p id="c45a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.6我们将数据分为训练集、测试集和验证集。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/4c8a98a2447dadc22686d7f05ec88c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J9FJ9vz6SU7hmn1UcaQFQQ.png"/></div></div></figure><p id="5fca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.1现在我们要在my_answers.py文件中构建我们的网络。在我们的类NeuralNetwork(object)中，我们定义了构造函数方法__init__。我们设置输入层、隐层和输出层的节点数，初始化权重，将self.activation_function设置为sigmoid函数。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/3b5d67cf2194fbeb26baae79d9869396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_0IS93btmsux8JIOxjsplA.png"/></div></div></figure><p id="9dd3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.2我们在forward_pass_train中实现前向传递，当我们在网络的各层中工作时，计算每个神经元的输出。我们使用初始化的权重将信号从神经网络的输入层向前传播到输出层。输出层只有一个节点，它用于回归，因此节点的输出和节点的输入是相同的。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/e2f755565ae79df80760ec03ce8a1567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jpuB4oDEN_0SgtMtlzBZow.png"/></div></div></figure><p id="c2d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.3我们在反向传播中实现反向传播。我们还使用权重将误差从输出反向传播回网络，以更新我们的权重。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/da48474bd7be6af21b1a800508acf669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mJqb3RQGXDiOMW-F4FNa6w.png"/></div></div></figure><p id="8a78" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.4我们在update_weights中更新梯度下降步骤上的权重。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/6d1172c10525baa0c9763d8cd7672e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Brins6ur9qh5L375Ka1uA.png"/></div></div></figure><p id="42ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.5我们在<code class="du ju jv jw jx b">run</code>方法中实现向前传递。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ks"><img src="../Images/9fa00f51d742289c91603fab0770bb15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fcc7ViLUBZDwcAsff9axnA.png"/></div></div></figure><p id="8435" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.6我们定义了用于训练神经网络训练。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/46af465e2b544b4f5ecd4653d4989673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8p8afijD0dMklzVr7OKliA.png"/></div></div></figure><p id="9428" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.1我们回到Jupiter笔记本Predicting_bike_sharing_data，在这里导入我们的神经网络。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/4e6215d100c845a5be0a64c88af565d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*f8EUsrYkaRDP4mEC3t8R3Q.png"/></div></figure><p id="8022" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.2我们运行这些单元测试来检查我们的网络实现的正确性。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/4f758b5dddb8b306c8a12d578761e059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4H8mfNYdCZn6dChtbhAhw.png"/></div></div></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/be21553782ef99a21841d6a8edd71c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHBcQGvBpY31g52sQP7pyQ.png"/></div></div></figure><p id="b9d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.1我们要训练我们的神经网络。我们在您的myanswers.py文件中设置超参数</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/263948be8e8fcbbe9d6fa42a19ec824f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*-fpKSk2tB4i1XEJqN6FFvw.png"/></div></figure><p id="743c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">设定超参数时需要考虑的事情</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/fc1bf6d821875e448376f9bf21593eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Dx-L3QbXkY8d7xmzmA1Ug.png"/></div></div></figure><p id="2f7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.2我们将它们导入我们的笔记本</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/d04825e3a896deef76793c2f98aa33c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWGV3Plch6hGSjQUfcBjvA.png"/></div></div></figure><p id="22eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.3我们训练我们的网络。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/483fec0e5deff714f94c59be9fe446e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tP-ON_OYmYCHAum-foFPw.png"/></div></div></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/06f786da0f62357f50c64d5b0fd65949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19AsNuWdlWLSOdjjSrjxvA.png"/></div></div></figure><p id="5c25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.4最后，我们检查我们的预测</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/8798dfd05943e170e98a994981641b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-md0hTG5gyk6BZpgS_AIVw.png"/></div></div></figure><p id="1e8c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在这里找到完整的代码:</p><div class="ld le ez fb lf lg"><a href="https://github.com/forfireonly/Bikesharing_neural_network" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">for fire only/bike sharing _ neural _ network</h2><div class="ln l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">github.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt io lg"/></div></div></a></div><p id="51c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">快乐编码我的朋友们！</p></div></div>    
</body>
</html>