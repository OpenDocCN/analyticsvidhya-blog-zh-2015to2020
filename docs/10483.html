<html>
<head>
<title>ShinyCoin - A Cryptocurrency Denomination Calculator in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个R语言的加密货币面额计算器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/shinycoin-a-cryptocurrency-denomination-calculator-in-r-981f83f488d1?source=collection_archive---------13-----------------------#2020-10-20">https://medium.com/analytics-vidhya/shinycoin-a-cryptocurrency-denomination-calculator-in-r-981f83f488d1?source=collection_archive---------13-----------------------#2020-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="199e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di">我们</span>都想<em class="jm">赚更多的钱</em>但是有这么多的货币可供选择，有些人可以用一种货币“赚钱”,而用另一种货币计价则会“赔钱”。全球经济令人困惑，在混乱中加入数百种新的“替代数字货币”于事无补。</p><p id="7e93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在交易中，很多时候我想看看，我的以太坊(ETH)在Monero (XMR)方面做得如何，或者我的比特币(BTC)可以获得多少XRM？有很多像<a class="ae jn" href="https://coinmarketcap.com/" rel="noopener ugc nofollow" target="_blank"> CoinMarketCap </a>这样的工具，可以让我们看到每枚以美元、BTC，有时还有瑞士法郎计价的硬币，但我从来没有找到一个好的工具，可以让我选择任何我想要的面值，并一次看到多枚硬币。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jo"><img src="../Images/9905534530a14d40d7086efd1cce81d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SeZsWmiT9QdTx_NtLCSLdw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">到目前为止，我们已经尽力了！</figcaption></figure><p id="ffa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di">所以</span>我正在构建<a class="ae jn" href="https://kyle-benzle.shinyapps.io/ShinyCoin/" rel="noopener ugc nofollow" target="_blank">闪亮的硬币</a>，一个用R编写的价格可视化工具，使用了闪亮的包。虽然仍处于早期阶段，但各部分已经就绪，我们的目标是拥有一款能够实现以下功能的工具:</p><ul class=""><li id="87e2" class="ke kf hi ih b ii ij im in iq kg iu kh iy ki jc kj kk kl km bi translated">加载并保存一个用户的“投资组合”和硬币来“命名”。</li><li id="0f3a" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">以美元和用户计价的硬币构建投资组合的交互式图表。</li><li id="6318" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">计算比率并识别高偏差区域。</li><li id="b3e3" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">预测未来价格/比率回归。</li></ul><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es ks"><img src="../Images/a351947051619bb788023c69328b2465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8Fe6fY42mUqeaBFzKof6Q.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">ShinyCoin 0.1</figcaption></figure><p id="9d48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个项目在GitHub 上是开源的<a class="ae jn" href="https://github.com/KyleBenzle/ShinyCoin" rel="noopener ugc nofollow" target="_blank">，ShinyCoin应用程序由Shiny here </a>托管。我正在努力改进界面和预测部分，我还没有公开，但会喜欢任何想法或反馈。接下来，我将遍历R代码来生成上面的代码。</p><h1 id="2e1d" class="kt ku hi bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">首先，很多图书馆</h1><p id="6685" class="pw-post-body-paragraph if ig hi ih b ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">Crypto()是最重要的软件包，可以让我们下载前100个硬币的每日价格数据。使数据加载步骤变得非常容易。Plotly()为我们提供了交互式图形，而lubridate()显然是用来润滑我们的日期的。</p><pre class="jp jq jr js fd lw lx ly lz aw ma bi"><span id="3c0a" class="mb ku hi lx b fi mc md l me mf">library(shiny)<br/>library(crypto)<br/>library(remotes)<br/>library(crypto)<br/>library(ggplot2)<br/>library(lubridate)<br/>library(plotly)</span></pre><h1 id="afb4" class="kt ku hi bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">加载和清理数据</h1><p id="4b89" class="pw-post-body-paragraph if ig hi ih b ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">我们从我们想要使用的硬币列表开始，必须全部大写。然后，为了获取数据，我们使用crypto()的crypto_history()函数，使用硬币列表。在我的例子中，我从csv加载旧数据，每次只下载最新的数据来帮助提高加载速度。然后用rbind()把两者粘在一起。实际上，你所需要的只是crypto_history()。</p><pre class="jp jq jr js fd lw lx ly lz aw ma bi"><span id="ec79" class="mb ku hi lx b fi mc md l me mf">fullCoinList &lt;- c("BTC", "ETH", "BCH", "XRP", "LTC", "BSV", "XMR", "BAT", "ZRX", "KNC")<br/>allCoinDataBeforeSep01 &lt;- read.csv('allDataToSep1.csv', stringsAsFactors = FALSE)<br/>allCoinDataAfterSep01 &lt;- crypto_history(fullCoinList, start_date = '20200901')<br/>allCoinDataBeforeSep01 &lt;- dplyr::select(allCoinDataBefSep01, -1)<br/>allCoinDataBeforeSep01$date &lt;- as.Date(allCoinDataBeforeSep01$date)<br/>allCoinDataAfterSep01$date &lt;- as.Date(allCoinDataAfterSep01$date)<br/>allCoinData &lt;- rbind(allCoinDataBeforeSep01, allCoinDataAfterSep01)<br/>allCoinData$date &lt;- as.Date(allCoinData$date)</span></pre><h1 id="5a6d" class="kt ku hi bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">获取用户输入</h1><p id="c175" class="pw-post-body-paragraph if ig hi ih b ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">在这个应用程序的“ui”功能部分，我们正在获取用户为“投资组合”输入的硬币，硬币命名的选择和日期范围。我不喜欢日期输入，格式化是一个巨大的痛苦，但它的工作，所以我离开它。这是你可以添加更多硬币选择的地方。</p><pre class="jp jq jr js fd lw lx ly lz aw ma bi"><span id="e4e1" class="mb ku hi lx b fi mc md l me mf">ui &lt;- fluidPage(<br/>  titlePanel("Cryptocurrency ratio calculator"),<br/>    sidebarLayout(<br/>      sidebarPanel(<br/>        selectizeInput(inputId = "coinDenom", <br/>                     label = "Choose Denomination", <br/>                     choices = unique(fullCoinList)),<br/>      <br/>        checkboxGroupInput("coinCheckChoice", "Choose coins:",<br/>                         choiceNames =<br/>                           list("BTC", "ETH", "BCH", "XRP", "LTC", "BSV", "XMR", "BAT", "ZRX", "KNC"),<br/>                         choiceValues =<br/>                           list("BTC", "ETH", "BCH", "XRP", "LTC", "BSV", "XMR", "BAT", "ZRX", "KNC"),<br/>                         selected='BCH'),<br/>      <br/>      textOutput('coinDenom'),<br/>      textOutput("workingCoinList"),<br/>      textOutput("coinCheckChoice"),<br/>      textOutput("dateRangeStart"),<br/>      textOutput("dateRangeEnd"),<br/>      dateRangeInput("dateRangeInput", "Date range:",<br/>                     start = "2018-01-01",<br/>                     end   = "2020-09-01"),),<br/>    <br/>    mainPanel(<br/>      plotlyOutput("distPlot"),<br/>      plotlyOutput("distPlotRatio"),<br/>)))</span></pre><h1 id="a3a4" class="kt ku hi bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">服务器功能第1部分</h1><p id="818f" class="pw-post-body-paragraph if ig hi ih b ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">这里我们只是向用户展示他们刚刚用这两条输出语句输入了什么。</p><pre class="jp jq jr js fd lw lx ly lz aw ma bi"><span id="e20f" class="mb ku hi lx b fi mc md l me mf">server &lt;- function(input, output) {<br/>  output$workingCoinList &lt;- renderText({<br/>    coinList &lt;- paste(input$coinCheckChoice, collapse = ", ")<br/>    paste("You portfolio: ", coinList)<br/>  })<br/>  <br/>  output$coinDenom &lt;- renderText({<br/>    coinDenom &lt;- paste(input$coinDenom)<br/>    paste("You denom: ", coinDenom)<br/>  })<br/>  <br/>  output$dateRangeInput &lt;- renderText({<br/>    dateRangeInput &lt;- paste(input$dateRangeInput)<br/>    paste("You date: ", dateRangeInput)<br/>  })</span></pre><h1 id="fdc0" class="kt ku hi bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">服务器功能第2部分</h1><p id="d157" class="pw-post-body-paragraph if ig hi ih b ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">输出gg图。Plotly的工作方式是包装ggplot对象，这非常好。我选择在这里过滤日期，但是在上面单独的语句中可能会做得更好。</p><pre class="jp jq jr js fd lw lx ly lz aw ma bi"><span id="a154" class="mb ku hi lx b fi mc md l me mf">output$distPlot &lt;- renderPlotly({<br/>  denomPrice &lt;- allCoinData %&gt;% dplyr::filter(., symbol == input$coinDenom) %&gt;% dplyr::select(., open)<br/>  activeCoinData &lt;- allCoinData %&gt;% dplyr::mutate(., newOpen=(open/denomPrice$open)) <br/>  userDateInput &lt;- as.Date(input$dateRangeInput) <br/>  activeCoinData &lt;- activeCoinData %&gt;% dplyr::filter(., date &gt;= as.Date(userDateInput[1]) &amp; date &lt;= as.Date(userDateInput[2]))<br/>  makeGraph(input$coinCheckChoice, userDateInput[1], userDateInput[2], activeCoinData)<br/>  })</span><span id="3827" class="mb ku hi lx b fi mg md l me mf">output$distPlotRatio &lt;- renderPlotly({<br/>    denomPrice &lt;- allCoinData %&gt;% dplyr::filter(., symbol == input$coinDenom) %&gt;% dplyr::select(., open)<br/>    activeCoinData &lt;- allCoinData %&gt;% dplyr::mutate(., newOpen=(open/denomPrice$open))<br/>    userDateInput &lt;- as.Date(input$dateRangeInput) <br/>    activeCoinData &lt;- activeCoinData %&gt;% dplyr::filter(., date &gt;= as.Date(userDateInput[1]) &amp; date &lt;= as.Date(userDateInput[2]))<br/>    makeGraphRatio(input$coinCheckChoice, userDateInput[1], userDateInput[2], activeCoinData, input$coinDenom)<br/>  })}</span><span id="1f65" class="mb ku hi lx b fi mg md l me mf">shinyApp(ui = ui, server = server)</span></pre><h1 id="0aa3" class="kt ku hi bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">最后，makeGraph()函数</h1><p id="0264" class="pw-post-body-paragraph if ig hi ih b ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">makeGraph只是输出ggplot对象，并为我们的两个图提供标题和标签。</p><pre class="jp jq jr js fd lw lx ly lz aw ma bi"><span id="0b77" class="mb ku hi lx b fi mc md l me mf">makeGraph &lt;- function(coinList, startDate, endDate, df){<br/>  df &lt;- df %&gt;% dplyr::filter(., symbol %in% coinList )<br/>  graph &lt;- ggplotly(ggplot(df, aes(x = date, y = open, col=slug))+<br/>    geom_line() +  labs(title = "Price in BTC", y= "Price in USD", x = "Date Range") +<br/>    ggtitle("Price in BTC"))<br/>  return(graph)<br/>}</span><span id="1904" class="mb ku hi lx b fi mg md l me mf">makeGraphRatio &lt;- function(coinList, startDate, endDate, df, coinDenom){<br/>  df &lt;- df %&gt;% dplyr::filter(., symbol %in% coinList )<br/>  graph &lt;- ggplotly(ggplot(df, aes(x = date, y = newOpen, col=slug))+<br/>    geom_line() + labs(colour = "Portfolio", title = paste("Price in ", coinDenom), y= paste("Price in: ", coinDenom) , x = "Date Range") +<br/>    ggtitle("by date"))<br/>  return(graph)<br/>}</span></pre><blockquote class="mh mi mj"><p id="f918" class="if ig jm ih b ii ij ik il im in io ip mk ir is it ml iv iw ix mm iz ja jb jc hb bi translated">仅此而已。我希望添加一个当比率超出其正常范围时的警报，因为这个工具的全部目的是帮助我在交易加密货币时赚钱；)感谢您的任何想法，也请在Twitter 上联系<a class="ae jn" href="https://twitter.com/KyleBenzle" rel="noopener ugc nofollow" target="_blank">。</a></p></blockquote><h2 id="57d4" class="mb ku hi bd kv mn mo mp kz mq mr ms ld iq mt mu lh iu mv mw ll iy mx my lp mz bi translated">下面是once块中的完整代码:</h2><pre class="jp jq jr js fd lw lx ly lz aw ma bi"><span id="a41a" class="mb ku hi lx b fi mc md l me mf">library(shiny)<br/>library(crypto)<br/>library(remotes)<br/>library(crypto)<br/>library(ggplot2)<br/>library(lubridate)<br/>library(plotly)</span><span id="d2b9" class="mb ku hi lx b fi mg md l me mf">makeGraph &lt;- function(coinList, startDate, endDate, df){<br/>  df &lt;- df %&gt;% dplyr::filter(., symbol %in% coinList )<br/>  graph &lt;- ggplotly(ggplot(df, aes(x = date, y = open, col=slug))+<br/>    geom_line() +  labs(title = "Price in BTC", y= "Price in USD", x = "Date Range") +<br/>    ggtitle("Price in BTC"))<br/>  return(graph)<br/>}</span><span id="3d67" class="mb ku hi lx b fi mg md l me mf">makeGraphRatio &lt;- function(coinList, startDate, endDate, df, coinDenom){<br/>  df &lt;- df %&gt;% dplyr::filter(., symbol %in% coinList )<br/>  graph &lt;- ggplotly(ggplot(df, aes(x = date, y = newOpen, col=slug))+<br/>    geom_line() + labs(colour = "Portfolio", title = paste("Price in ", coinDenom), y= paste("Price in: ", coinDenom) , x = "Date Range") +<br/>    ggtitle("by date"))<br/>  return(graph)<br/>}</span><span id="eeb8" class="mb ku hi lx b fi mg md l me mf">fullCoinList &lt;- c("BTC", "ETH", "BCH", "XRP", "LTC", "BSV", "XMR", "BAT", "ZRX", "KNC")<br/>allCoinDataBeforeSep01 &lt;- read.csv('allDataToSep1.csv', stringsAsFactors = FALSE)<br/>allCoinDataAfterSep01 &lt;- crypto_history(fullCoinList, start_date = '20200901')<br/>allCoinDataBeforeSep01 &lt;- dplyr::select(allCoinDataBeforeSep01, -1)<br/>allCoinDataBeforeSep01$date &lt;- as.Date(allCoinDataBeforeSep01$date)<br/>allCoinDataAfterSep01$date &lt;- as.Date(allCoinDataAfterSep01$date)<br/>allCoinData &lt;- rbind(allCoinDataBeforeSep01, allCoinDataAfterSep01)<br/>allCoinData$date &lt;- as.Date(allCoinData$date)</span><span id="87ea" class="mb ku hi lx b fi mg md l me mf">ui &lt;- fluidPage(<br/>  titlePanel("Cryptocurrency ratio calculator"),<br/>    sidebarLayout(<br/>      sidebarPanel(<br/>        selectizeInput(inputId = "coinDenom", <br/>                     label = "Choose Denomination", <br/>                     choices = unique(fullCoinList)),<br/>      <br/>        checkboxGroupInput("coinCheckChoice", "Choose coins:",<br/>                         choiceNames =<br/>                           list("BTC", "ETH", "BCH", "XRP", "LTC", "BSV", "XMR", "BAT", "ZRX", "KNC"),<br/>                         choiceValues =<br/>                           list("BTC", "ETH", "BCH", "XRP", "LTC", "BSV", "XMR", "BAT", "ZRX", "KNC"),<br/>                         selected='BCH'),<br/>      <br/>      textOutput('coinDenom'),<br/>      textOutput("workingCoinList"),<br/>      textOutput("coinCheckChoice"),<br/>      textOutput("dateRangeStart"),<br/>      textOutput("dateRangeEnd"),<br/>      dateRangeInput("dateRangeInput", "Date range:",<br/>                     start = "2018-01-01",<br/>                     end   = "2020-09-01"),),<br/>    <br/>    mainPanel(<br/>      plotlyOutput("distPlot"),<br/>      plotlyOutput("distPlotRatio"),<br/>)))</span><span id="9ea6" class="mb ku hi lx b fi mg md l me mf">server &lt;- function(input, output) {<br/>  output$workingCoinList &lt;- renderText({<br/>    coinList &lt;- paste(input$coinCheckChoice, collapse = ", ")<br/>    paste("You portfolio: ", coinList)<br/>  })<br/>  <br/>  output$coinDenom &lt;- renderText({<br/>    coinDenom &lt;- paste(input$coinDenom)<br/>    paste("You denom: ", coinDenom)<br/>  })<br/>  <br/>  output$dateRangeInput &lt;- renderText({<br/>    dateRangeInput &lt;- paste(input$dateRangeInput)<br/>    paste("You date: ", dateRangeInput)<br/>  })</span><span id="abfe" class="mb ku hi lx b fi mg md l me mf">output$distPlot &lt;- renderPlotly({<br/>  denomPrice &lt;- allCoinData %&gt;% dplyr::filter(., symbol == input$coinDenom) %&gt;% dplyr::select(., open)<br/>  activeCoinData &lt;- allCoinData %&gt;% dplyr::mutate(., newOpen=(open/denomPrice$open)) <br/>  userDateInput &lt;- as.Date(input$dateRangeInput) <br/>  activeCoinData &lt;- activeCoinData %&gt;% dplyr::filter(., date &gt;= as.Date(userDateInput[1]) &amp; date &lt;= as.Date(userDateInput[2]))<br/>  makeGraph(input$coinCheckChoice, userDateInput[1], userDateInput[2], activeCoinData)<br/>  })</span><span id="d51b" class="mb ku hi lx b fi mg md l me mf">output$distPlotRatio &lt;- renderPlotly({<br/>    denomPrice &lt;- allCoinData %&gt;% dplyr::filter(., symbol == input$coinDenom) %&gt;% dplyr::select(., open)<br/>    activeCoinData &lt;- allCoinData %&gt;% dplyr::mutate(., newOpen=(open/denomPrice$open))<br/>    userDateInput &lt;- as.Date(input$dateRangeInput) <br/>    activeCoinData &lt;- activeCoinData %&gt;% dplyr::filter(., date &gt;= as.Date(userDateInput[1]) &amp; date &lt;= as.Date(userDateInput[2]))<br/>    makeGraphRatio(input$coinCheckChoice, userDateInput[1], userDateInput[2], activeCoinData, input$coinDenom)<br/>  })}</span><span id="53f8" class="mb ku hi lx b fi mg md l me mf">shinyApp(ui = ui, server = server)</span></pre></div></div>    
</body>
</html>