<html>
<head>
<title>Simple Linear Regression with Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带划痕的简单线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-linear-regression-with-scratch-a3cb352437ce?source=collection_archive---------23-----------------------#2020-12-21">https://medium.com/analytics-vidhya/simple-linear-regression-with-scratch-a3cb352437ce?source=collection_archive---------23-----------------------#2020-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f216" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你好。欢迎使用Scratch学习简单线性回归，这是我们的Scratch机器学习系列的第一篇文章。如果我们需要检查我们将使用的数据</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/339d6401fc6ad0305b5eaf55a28507bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEBMeW2LnjnphgKolbECew.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">这些是我们的数据。</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/4bc28b3e9aa8df66bdeb79e68bc41659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*j8xIEpNY8Tr8vf3lERWVoQ.jpeg"/></div></figure><h1 id="37db" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">简单线性回归</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/4f51af7309e7fbe3bfc540ab7be65261.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*2LGxEBT6B92gujTCDQUFwA.jpeg"/></div></figure><p id="ab6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们代码中的公式就是上面的公式。解释一下公式，如果我们要估计的“y”的值是B0“偏差”，则是固定的系数值称为其值。B1是伴随我们输入的系数值。在编写算法时，我们的目标是找到我们能找到的最佳B0和B1值。</p><p id="7a7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“为那些不想看代码就想写的人准备的待办事项列表”</p><ol class=""><li id="1322" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">上传您的数据</li><li id="dad9" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">将您的数据分为训练和测试两部分</li><li id="caa6" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">我们丢弃B0和B1的随机值。(我发现值0适合这个代码。)</li><li id="0681" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">我们运行我们的训练功能。</li><li id="ec9b" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">我们用训练函数中的梯度下降算法找到B0和B1的最佳值。</li><li id="9b29" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">我们使用找到的B0和B1值来估计新值。</li></ol><h1 id="bdaa" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">我们的功能是什么？</h1><p id="7337" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">损失函数是一种测量单位，用于测量模型预测值与实际值的接近程度或距离。在这段代码中，我们使用了均方误差(MSE)函数来最小化它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/54be08965c1a1d7c6f0da4514e6f254e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*iRBMYXzYXmrp_L8E3QjQ_Q.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">均方误差</figcaption></figure><p id="c84f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里是我们估计的值，yi是我们在训练数据中估计的值。</p><h1 id="e6d3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">什么是梯度下降？</h1><p id="5efe" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">梯度下降是一种优化算法，它将最小化我们的损失函数。为了更好地理解梯度下降，我强烈建议您听一下我们的Uzak cetin博士讲解的梯度下降系列。</p><blockquote class="ln lo lp"><p id="68ed" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated"><a class="ae lu" href="https://www.youtube.com/watch?v=rDaAXsJwnQI" rel="noopener ugc nofollow" target="_blank"><em class="hi"/>https://www.youtube.com/watch?v=rDaAXsJwnQI</a></p><p id="564a" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">【https://www.youtube.com/watch?v=pNJKMO4qPZQ】T5<a class="ae lu" href="https://www.youtube.com/watch?v=pNJKMO4qPZQ" rel="noopener ugc nofollow" target="_blank">T6</a></p><p id="1eaf" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated"><a class="ae lu" href="https://www.youtube.com/watch?v=wLpA_9LSM6w" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://www.youtube.com/watch?v=wLpA_9LSM6w</em></a></p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/f48b165dfa7ab03941c888438a79b465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p6-z1AryNJdJj-mERULBxw.jpeg"/></div></div></figure><p id="4829" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">梯度下降算法要做的事情</p><ol class=""><li id="e6c4" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">确定起始重量</li><li id="a3ff" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">对每个参数的成本函数求导</li><li id="2268" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">更新重量和偏差值</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/b1fcdcded377165f08b76ff8a26444e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*tR_EMp3J2JBEcLZEc6lr1Q.jpeg"/></div></figure><p id="e43b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在更新规则时，我认为“a”值引起了您的注意。那么什么是“a”值呢？这个系数叫做学习率，是在更新规则的同时衡量作业敏感程度的系数。那么应该如何选择系数“a”呢？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/754a2bbd6a8fb8ff44e158ddab739416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VuHgt-RwqHzehbxOkxaTlQ.jpeg"/></div></div></figure><p id="ab24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你在上面看到的，学习率系数在我们的函数中有着重要的作用。如果我们选择过高，它就不能像在“过高”部分那样找到损失函数的最小值。如果我们选择得太低，我们的函数将不得不重复大量的次数。常用的值是[0.01，0.001，0.02，0.03，0.005]，但是使用不同的值可能适合您的函数。</p><p id="95ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们继续我们的代码。</p><ol class=""><li id="696c" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">让我们先导入我们的库</li></ol><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="cb7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.上传您的数据</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="5f0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解释我们的代码；我们的x变量将是我们将训练的数据的输入部分，而我们的y变量是训练时损失函数中使用的输出值。我们的X1值是预测数据的输入部分，而X2是我们用来计算模型的MSE分数的数据。定义数据后，我们可以将下面给出的“类”结构分配给“模型”变量，并从“模型”变量执行操作。</p><p id="3412" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.让我们编码我们的类结构</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="bb57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的“类”结构由3个不同的部分组成。第一个是我们的__init__函数，我们将预定义它。我们首先定义在__init__部分通常会用到的变量。在第二部分中，我们尽可能多次地旋转循环。在我们的下一个循环中，我们将决定梯度下降应用的转向量。在这个循环中，我们首先导出每个变量的损失函数。当我们将我们的学习率系数乘以我们的导数变量并从当前权重和偏差值中减去它时，我们更新了我们的权重和偏差值。下一步，我们将尝试使用第三步中通过梯度下降确定的最佳权重和偏差值来预测新的输入。</p><p id="d015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于代码:<a class="ae lu" href="https://github.com/capogluuu/ml_scratch" rel="noopener ugc nofollow" target="_blank">https://github.com/capogluuu/ml_scratch</a></p></div></div>    
</body>
</html>