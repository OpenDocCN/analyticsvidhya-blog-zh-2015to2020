<html>
<head>
<title>First Steps in Pandas for Excel Users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Excel用户使用Pandas的第一步</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/first-steps-in-pandas-for-excel-users-40eed0b390a4?source=collection_archive---------16-----------------------#2019-11-12">https://medium.com/analytics-vidhya/first-steps-in-pandas-for-excel-users-40eed0b390a4?source=collection_archive---------16-----------------------#2019-11-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ec2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你用的是自己的电脑，你必须<a class="ae jd" href="https://pandas.pydata.org/pandas-docs/stable/install.html" rel="noopener ugc nofollow" target="_blank">安装</a>做<code class="du je jf jg jh b">pip install pandas</code>(假设你用的是<code class="du je jf jg jh b">pip</code>)。</p><p id="8928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pandas的主要数据结构DataFrame是一个二维(*)对象，类似于我们的Excel表格。在这节课中，我们将分析两者之间的相似性。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ji"><img src="../Images/d1b94e2ce91506f57b394a605f3f6bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hZUJ8437WegTDYXZ6QbezA.jpeg"/></div></div></figure><p id="9456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将从阅读本课的Excel文件开始。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ju"><img src="../Images/9f21c3dcce9dfe7a8ec6f2437ed95e5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xP443D-LraFAnW0A_SHp_w.jpeg"/></div></div></figure><h1 id="cee7" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">将<code class="du je jf jg jh b">Orders</code>表读入数据帧</h1><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="7899" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df = excel_file.parse('Orders')</span></pre><p id="84aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变量<code class="du je jf jg jh b">df</code>包含一个熊猫<code class="du je jf jg jh b">DataFrame</code>，它包含了我们excel文件中<code class="du je jf jg jh b">Orders</code>表的所有信息。</p><p id="5b9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据框架类似于Excel表格:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="e7e8" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df.head(10)</span></pre><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lc"><img src="../Images/71f71505caacbbaf173853e594ec4b66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mhs66KRPJlhNqGwOlOAExA.jpeg"/></div></div></figure><p id="7b89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">主要的区别在于，当我们处理数据帧时，我们并不总是有数据的视觉参考。我们知道它在内存中，我们知道每一列包含什么，但是我们没有整个数据帧的视图。这样做的原因是Pandas被设计为处理数百万行数据。</p><h1 id="7fb7" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">大局</h1><p id="ba97" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">处理大量数据可能会有问题。因此，我们不总是直接查看数据表，而是喜欢关注大图:<em class="li">我的数据帧包含什么？</em>。正如您之前看到的，方法<code class="du je jf jg jh b">.head()</code>和<code class="du je jf jg jh b">.tail()</code>对于了解我们正在处理的数据非常有用:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lj"><img src="../Images/3dad75653a9a277a3b89ec3603ef4bc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u0P2kn9LxMfkn7FFhXQ1Rw.jpeg"/></div></div></figure><p id="a458" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是我们也可以使用一些其他的方法或属性来补充这个引用。例如，我们可以检查数据帧的<code class="du je jf jg jh b">shape</code>，以了解我们的数据是如何构造的:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lk"><img src="../Images/bba14a63137cf5fa41267b121228f4ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JV0YxjdXznKsyZPRgCxgKQ.jpeg"/></div></div></figure><p id="b962" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，<code class="du je jf jg jh b">shape</code>告诉您这个数据帧包含<code class="du je jf jg jh b">292</code>行/记录和<code class="du je jf jg jh b">11</code>列。我们还可以查看我们的列的详细信息</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ll"><img src="../Images/71504b1abbc9f0d558ece91d3f43a5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e7L7itSwZo-RaDnY2tJM0A.jpeg"/></div></div></figure><blockquote class="lm ln lo"><p id="6aa1" class="if ig li ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">重要:</em> </strong> <em class="hi">注意</em><code class="du je jf jg jh b"><em class="hi">shape</em></code><em class="hi"/><code class="du je jf jg jh b"><em class="hi">columns</em></code><em class="hi">被调用时没有括号:只是</em> <code class="du je jf jg jh b"><em class="hi">df.shape</em></code> <em class="hi">。那是因为它是一个</em>属性<em class="hi">而不是一个</em>方法<em class="hi">。</em></p></blockquote><p id="e504" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还使用一些方法来汇总所有数据，从而提供更全面的信息。其中之一是<code class="du je jf jg jh b">.describe()</code>，我们在讨论列类型时还会看到<code class="du je jf jg jh b">.info()</code>:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ls"><img src="../Images/e45dd36b532d445c4c426dbc664718b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bfs41jRIBjgmlN4ljHY9HQ.jpeg"/></div></div></figure><p id="4c3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，<code class="du je jf jg jh b">.describe()</code>提供了所有“数字”列的汇总，包括<code class="du je jf jg jh b">count</code>(有多少行)和一些其他的统计方法:<code class="du je jf jg jh b">mean</code>、<code class="du je jf jg jh b">std</code>等。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lt"><img src="../Images/8878ab4e307639357a22d0261664019e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Hgzg86_mMXegZ0_P.png"/></div></div></figure><h1 id="fb05" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">列选择</h1><p id="8012" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">要“放大”您的数据框架，并选择特定的列，我们使用的语法是:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lu"><img src="../Images/9e1be1820d5f5af558a1962a47190cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_1Culjm8HFC6gcx5wpmDQ.jpeg"/></div></div></figure><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lv"><img src="../Images/5e1e48dd6c2a9fb307d9d9b5942fe705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3auvusl-XGSkjU8-6wqgg.jpeg"/></div></div></figure><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lw"><img src="../Images/3db6eef37c808c910325ae7ead4357ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h0hZYxO1UOyhg5-CiLFDQA.jpeg"/></div></div></figure><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lt"><img src="../Images/b43de3fa5e01401c370ee726b50a6f1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IDYeMcndr2LAFtT2.png"/></div></div></figure><h1 id="3332" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">列类型</h1><p id="2ea2" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">熊猫数据帧中的每一列都有特定的类型。这是<strong class="ih hj">非常重要的</strong>。该列有一个<strong class="ih hj">固定的</strong>，预定义的类型，这意味着我们不能在同一个列中混合类型。这与Excel不同，在Excel中，我们为列设置一个“格式化”类型，但是我们可以存储任何我们想要的值。</p><p id="2ee9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用<code class="du je jf jg jh b">.info()</code>方法来查看每一列的数据类型:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lx"><img src="../Images/bdaf55cb5f8419101dbd9c3954b7d539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9UGw215nrx3VK4umqB88cw.jpeg"/></div></div></figure><h1 id="b6f1" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">熊猫中的列类型</h1><p id="74c1" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">Excel中只有三种数据类型:</p><ul class=""><li id="d9e8" class="ly lz hi ih b ii ij im in iq ma iu mb iy mc jc md me mf mg bi translated">数字(数字、货币、会计、日期)</li><li id="cce6" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated">文本</li><li id="2fc6" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated">公式</li></ul><p id="351e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pandas中的数据类型被称为<strong class="ih hj"> dtypes </strong>，主要有:</p><ul class=""><li id="a762" class="ly lz hi ih b ii ij im in iq ma iu mb iy mc jc md me mf mg bi translated"><strong class="ih hj"> int </strong>和<strong class="ih hj"> float </strong>:针对整数和浮点数</li><li id="8f3d" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><strong class="ih hj">日期时间</strong>和<strong class="ih hj">时间增量</strong>:特定于日期和偏移量</li><li id="e66d" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><strong class="ih hj">对象</strong>:就是<code class="du je jf jg jh b">strings</code>，它们是用来存储文本的，但是熊猫称它们为<code class="du je jf jg jh b">object</code> s。</li><li id="102a" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><strong class="ih hj">布尔值</strong>:特定于真/假值</li></ul><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es mm"><img src="../Images/4240458b05063dcd10e493b1d0730b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1Z3EjJLTwys2J5pbLnbGA.jpeg"/></div></div></figure><h1 id="97e1" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">编号:<code class="du je jf jg jh b">int</code>和<code class="du je jf jg jh b">float</code></h1><p id="2979" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">这些是数字列，支持所有常规算术运算。在我们当前的订单数据框架中，这些是数字列:</p><ul class=""><li id="74b1" class="ly lz hi ih b ii ij im in iq ma iu mb iy mc jc md me mf mg bi translated"><code class="du je jf jg jh b">order_quantity</code> : int</li><li id="2ddf" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><code class="du je jf jg jh b">cost_price</code>:浮动</li><li id="6884" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><code class="du je jf jg jh b">retail_price</code>:浮动</li><li id="ef9c" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><code class="du je jf jg jh b">shipping_price</code>:浮动</li></ul><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es mn"><img src="../Images/9a67fdb7dad5f5247e8c422f2d821c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8DundAHdkgsLG1VTJ_6lA.jpeg"/></div></div></figure><p id="10ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还记得我们使用<code class="du je jf jg jh b">.describe()</code>方法时，只包含了数字列。</p><h2 id="b8d4" class="kx jw hi bd jx mo mp mq kb mr ms mt kf iq mu mv kj iu mw mx kn iy my mz kr na bi translated">数值运算和方法</h2><p id="04d2" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">数字列支持多种操作(我们将在下一节中看到)以及一些非常有用的方法，例如:</p><p id="d90c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b"><strong class="ih hj">mean</strong></code> <strong class="ih hj">:该列的平均值</strong></p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="a6c6" class="kx jw hi jh b fi ky kz l la lb">&gt;df['cost_price'].mean()</span><span id="e53e" class="kx jw hi jh b fi nb kz l la lb">25.202705479452057</span></pre><p id="29ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b"><strong class="ih hj">std</strong></code> <strong class="ih hj">:列的标准偏差</strong></p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="0c4a" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df['cost_price'].std()</span><span id="7ad9" class="kx jw hi jh b fi nb kz l la lb">62.11414058290448</span></pre><p id="35b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和其他一些人。但是我们甚至可以在列本身中运行一个<code class="du je jf jg jh b">.describe</code>:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="5e34" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df['cost_price'].describe()</span><span id="25bd" class="kx jw hi jh b fi nb kz l la lb">count    292.000000<br/>mean      25.202705<br/>std       62.114141<br/>min        0.240000<br/>25%        1.870000<br/>50%        3.750000<br/>75%       13.640000<br/>max      377.990000<br/>Name: cost_price, dtype: float64</span></pre><h2 id="af07" class="kx jw hi bd jx mo mp mq kb mr ms mt kf iq mu mv kj iu mw mx kn iy my mz kr na bi translated">算术运算</h2><p id="3745" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">数字列允许我们用它们执行常规的算术运算。例如:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="d67d" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df['cost_price'].head()</span><span id="94c9" class="kx jw hi jh b fi nb kz l la lb">0    75.00<br/>1     1.31<br/>2     2.50<br/>3     1.82<br/>4     2.29<br/>Name: cost_price, dtype: float64</span></pre><p id="40b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以增加10%的价值:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="6fcb" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df['cost_price'].head() * 1.10</span><span id="1a34" class="kx jw hi jh b fi nb kz l la lb">0    82.500<br/>1     1.441<br/>2     2.750<br/>3     2.002<br/>4     2.519<br/>Name: cost_price, dtype: float64</span></pre><p id="c9f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，前面的操作没有更新底层数据帧，它只是显示了一个结果。我们再来看看<code class="du je jf jg jh b">cost_price</code>:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="cf5a" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df['cost_price'].head()</span><span id="feea" class="kx jw hi jh b fi nb kz l la lb">0    75.00<br/>1     1.31<br/>2     2.50<br/>3     1.82<br/>4     2.29<br/>Name: cost_price, dtype: float64</span></pre><p id="23b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想覆盖一列的内容，你必须设置它的<em class="li">等于</em>那个值:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="90c3" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df['cost_price'] = df['cost_price'] * 1.08</span></pre><p id="c7b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在变化是永久性的:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="7c71" class="kx jw hi jh b fi ky kz l la lb">&gt;&gt;df['cost_price'].head()</span></pre><p id="9cf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以写:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="b48e" class="kx jw hi jh b fi ky kz l la lb"># df['cost_price'] *= 1.08</span></pre><p id="aa6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以在数据框架中创建新的列。我们通过设置列<em class="li">的值等于</em>某个值来实现。例如，我将创建只包含值<code class="du je jf jg jh b">-1</code>的列<code class="du je jf jg jh b">Dummy Column</code>。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es nc"><img src="../Images/649d61d45701ec32834ddab1ecc50b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yv_sso6vg4u4BnRLx0cVEQ.jpeg"/></div></div></figure><p id="96e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我可以使用<code class="du je jf jg jh b">del</code>关键字删除该列:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es nd"><img src="../Images/c9d7edf172b94bd5f0435dad9af04d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDwyVdWw6K8WaO-gH-yetw.jpeg"/></div></div></figure><p id="69be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看一个新列的更有用的例子。假设我们想要计算一个新的列<code class="du je jf jg jh b">total_price</code>，它是使用下面的公式计算的:</p><p id="f7e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">total _ price = retail _ price∫order _ quantity+shipping _ price total _ price = retail _ price∫order _ quantity+shipping _ price</p><p id="8664" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">做这件事的方法很简单:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ne"><img src="../Images/3cc9a978a1911ab744657ab7b77f5467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VhY4sAprfr1J0RrvsM1SUw.jpeg"/></div></div></figure><h1 id="20f5" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">日期时间(和时间增量)</h1><p id="9e90" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">订单数据框架中的以下各列属于<code class="du je jf jg jh b">datetime</code>类型，也称为时间戳:</p><ul class=""><li id="b897" class="ly lz hi ih b ii ij im in iq ma iu mb iy mc jc md me mf mg bi translated"><code class="du je jf jg jh b">order_date</code></li><li id="0d0f" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><code class="du je jf jg jh b">ship_date</code></li></ul><p id="b637" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将通过检查<code class="du je jf jg jh b">order_date</code>和<code class="du je jf jg jh b">ship_date</code>之间的天数来计算<code class="du je jf jg jh b">shipping_delay</code>:</p><pre class="jj jk jl jm fd kt jh ku kv aw kw bi"><span id="42b9" class="kx jw hi jh b fi ky kz l la lb">df['ship_date'].head()</span><span id="4e12" class="kx jw hi jh b fi nb kz l la lb">0   2013-08-16<br/>1   2013-08-16<br/>2   2014-09-05<br/>3   2013-03-26<br/>4   2013-06-21<br/>Name: ship_date, dtype: datetime64[ns]</span></pre><p id="4b9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Datetime列也支持算术运算，结果是<em class="li"> timedeltas </em>(或<em class="li"> offsets </em>)。例如:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es nf"><img src="../Images/5d940184ea4dd215e55769a88e21c2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nmRPxwhRjgoilTlboJDlyw.jpeg"/></div></div></figure><p id="8778" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">7 days</code>是一个“相对时间”，或一个<em class="li">时间增量</em>(一个<code class="du je jf jg jh b">timedelta</code>)。我们还可以将时间增量与我们的列结合使用:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ng"><img src="../Images/d2aa74a8e9f7359167de639a1b4e0cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*thyTqhzBKacI6QFKZHU8lg.jpeg"/></div></div></figure><h1 id="fe53" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">字符串(类型<code class="du je jf jg jh b">object</code></h1><p id="fc3e" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">任何类型的文本(长、短、包含或不包含特殊字符)在数据帧中都是类型<code class="du je jf jg jh b">object</code>。尽管在Python中我们只知道它们是字符串。以下列为字符串:</p><ul class=""><li id="42b8" class="ly lz hi ih b ii ij im in iq ma iu mb iy mc jc md me mf mg bi translated"><code class="du je jf jg jh b">city</code></li><li id="1a11" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><code class="du je jf jg jh b">product_name</code></li><li id="2725" class="ly lz hi ih b ii mh im mi iq mj iu mk iy ml jc md me mf mg bi translated"><code class="du je jf jg jh b">product_category</code></li></ul><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es nh"><img src="../Images/adc9efaf30659cccfe6ac2ca2a5c03ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_66l-giaAFxADaLjVb-Bg.jpeg"/></div></div></figure><p id="f587" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">字符串支持某些操作，例如，简单的连接:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ni"><img src="../Images/3bebac38ede8c8e7862701b1366793d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JeQqnXX_MjvzYN_L-LKAug.jpeg"/></div></div></figure><p id="5a80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du je jf jg jh b">.str</code>属性，我们可以执行更高级的操作:</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es nj"><img src="../Images/6224ef69d8ce480020114855b29b8845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OH6HaVY9HatEGHq4a-9sUg.jpeg"/></div></div></figure><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es nk"><img src="../Images/f002b2bfca7713d1f15fb84f96018433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SiUbcyZ4haAGEZl-ULaxbw.jpeg"/></div></div></figure></div></div>    
</body>
</html>