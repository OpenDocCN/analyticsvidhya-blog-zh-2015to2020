<html>
<head>
<title>Predicting Insurance Fraud with Machine Learning (SMOTE)…!!!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习预测保险诈骗(SMOTE)…！！！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-insurance-fraud-with-machine-learning-smote-da94adf8fb62?source=collection_archive---------8-----------------------#2020-04-20">https://medium.com/analytics-vidhya/predicting-insurance-fraud-with-machine-learning-smote-da94adf8fb62?source=collection_archive---------8-----------------------#2020-04-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/963d3beb45d75a554bf7e854be5ed89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4w3Aw_7LDgtHkFCV"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">我可以通过事故赚钱..。</figcaption></figure><p id="846e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">保险欺诈是被保险人/索赔人或实体出于经济利益的目的而故意提出的虚假或歪曲的索赔。在保险生命周期的不同接触点，投保人、投保人、第三方索赔人或专业人士(如提供此类服务的保险机构/代理人)都可能实施保险欺诈。</p><p id="ca6a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据<em class="jt">反保险欺诈联盟所做的一项研究估计，</em>欺诈每年在所有保险业务中窃取800亿美元，其中财产意外险欺诈约占340亿美元。不用说，所有这些数字使保险欺诈成为一种特定的犯罪。</p><h1 id="f5a2" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">保险诈骗类型</strong></h1><p id="1492" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">软保险诈骗</em></strong><em class="jt">——</em>这类诈骗一般是即兴的，在实施诈骗的机会有机上升时发生。简而言之，这是关于歪曲信息或说“善意的谎言”来夸大索赔金额。软保险欺诈的一个典型例子是，声称你的意外伤害比实际严重，以获得比你本来可以获得的更高的索赔金额。</p><p id="7c05" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">硬保险诈骗</em></strong><em class="jt">——</em>与软保险诈骗不同，硬保险诈骗一般都是事先策划好的&amp;故意造成事故等方式来骗取保险金。</p><h1 id="9787" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak"> 5种最常见的保险欺诈</strong></h1><p id="4ec3" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> 1。车祸/碰撞— </em> </strong>车祸在道路和高速公路上相当常见。</p><p id="a055" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然大多数事故都不是故意的，但也有许多故意制造的事故使财产和意外伤害保险行业在支付意外索赔方面损失了数百万美元。在大多数情况下，司机和受害者是欺诈索赔的唯一对象，然而，在某些情况下，保险调查员和付费证人也可能是欺诈的一部分。损坏的价值被夸大了，保险公司被迫赔偿一辆全毁的汽车。碰撞有几种类型，如猛扑、急停、倒车、撞了就跑、撞纸等等。</p><p id="8581" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有时，索赔人报告轻微损坏，得到修理估价，领取保险金，但从不修理他们的车。</p><p id="d63a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">2<em class="jt">2。偷车</em> </strong> <em class="jt"> — </em>这是另一种常见的保险欺诈类型，犯罪者要么将自己的汽车部分出售，要么在没有适当文件的情况下将汽车卖给另一个买家&amp;，然后报失。</p><p id="71d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另一种常见的欺骗保险公司的方式是“幽灵车”。索赔人创造了一个虚假的所有权或注册，以确保对一个不存在的车辆保险。然后，他/她在提交欺诈性保险索赔之前报告车辆被盗。</p><p id="5d35" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> 3。医疗账单&amp;不必要的程序</em> </strong> —有时医疗专业人员也可能参与欺诈活动。医疗保健组织对标准程序或从未在患者身上执行的程序收取更多费用。</p><p id="669b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kw" href="https://www.nytimes.com/2019/04/09/us/billion-dollar-medicare-scam.html" rel="noopener ugc nofollow" target="_blank"><em class="jt">【12亿美元医保计划】</em> </a></p><p id="13a7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，下次你的医生开出一系列与你的医疗状况无关的验血单时，这可能是欺诈的表现。</p><p id="e04f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> 4。家庭火灾/破坏行为</em></strong>——这是最常见的房主保险欺诈形式，旨在索赔保险金。房子可能会被遗弃，或者索赔人会在实施欺诈之前搬走贵重物品。或者在某些情况下，雇佣的专业人员会破门而入，破坏房子来支持索赔的合法性。</p><p id="ba8d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> 5。风暴/自然灾害</em> </strong> <em class="jt"> — </em>另一种常见的欺诈形式是提高风暴或其他自然灾害造成的损失价值。</p><h1 id="877e" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">通过分析打击欺诈</strong></h1><p id="9eda" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">由于技术进步和创新，今天的保险业看起来与十年前有很大不同，但不用说，欺诈者也在发展。保险欺诈一直是这个行业面临的一个挑战，然而，一个基础框架和一个强大的人工智能策略可以帮助提前识别可疑的索赔。</p><p id="1390" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">曾经有一段时间，保险公司依赖于内部业务规则、理算师和代理人的建议以及特别调查组的见解。经过一段时间后，不仅索赔的复杂性增加了，而且数量也增加了，因此几乎不可能手动筛选和调查所有案例。因此，保险公司依靠预测分析来筛选索赔，并制定风险/怀疑评分。</p><p id="ca22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦欺诈案件的概率(风险分值)可用，企业就可以根据资源的可用性决定要调查的案件数量。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/134f01bd7201094566aa1860a24d42a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZJ4SxdHy4G0yDFHtNI08A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">申请汽车保险时收集的数据样本列表</figcaption></figure><p id="3120" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了说明实际的实现，我们可以从汽车保险行业获得一个虚拟数据，以了解机器学习如何帮助识别和预测欺诈性索赔。</p><p id="d106" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1。问题识别</strong></p><p id="543b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此用例的目标是建立一个预测模型来识别和标记欺诈性索赔。所以这是一个分类问题。</p><p id="6304" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2。我们有什么数据？</strong></p><p id="c960" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">的哑数据和python代码可以从我的</em><strong class="ix hj"><em class="jt"/></strong><a class="ae kw" href="https://github.com/raj1611/Insurance-Fraud-Prediction" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj"><em class="jt">GitHub账号</em> </strong> </a> <strong class="ix hj"> <em class="jt">下载。</em> </strong></p><p id="2ce6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">原始数据有39个变量，包括目标'<strong class="ix hj">欺诈报告</strong>'。这是一个只有1000个观察值(行)的小数据集。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/d4b76831661ebbb111607198d53b417d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4-4DEh7JYjC5WOty1lIKg.png"/></div></div></figure><h2 id="81a6" class="ld jv hi bd iu le lf lg jz lh li lj kd jg lk ll kh jk lm ln kl jo lo lp kp lq bi translated">3.探索性数据分析</h2><p id="20f0" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">导入python库并打印数据集的样本。</p><p id="ae65" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据集没有空值，但是，很少有要素有“？”作为应该被适当对待的价值观。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="b6e5" class="ld jv hi ls b fi lw lx l ly lz"># Replace the ‘?’ with mode of collision_type feature as it is categorical and we are unaware of the type.<br/>train[‘collision_type’].fillna(train[‘collision_type’].mode()[0], inplace = True)</span><span id="dcc6" class="ld jv hi ls b fi ma lx l ly lz"># Replace missing information as ‘No’ for property_damage. Feature can have only 2 possibles values. Either Yes or No. <br/># If information is nor available we will assume it was not reported.<br/>train[‘property_damage’].fillna(‘NO’, inplace = True)</span><span id="8e9e" class="ld jv hi ls b fi ma lx l ly lz"># USe the assumption above to replace missing information as ‘No’ for police_report_available<br/>train[‘police_report_available’].fillna(‘NO’, inplace = True)</span><span id="bfa4" class="ld jv hi ls b fi ma lx l ly lz">train.isnull().any().any()</span></pre><p id="e0af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们做一些基本的数据可视化来分析特征关系。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="e9d1" class="ld jv hi ls b fi lw lx l ly lz"># Let’s start with some basic plots to analyze relationship between different features<br/>fig = px.scatter(train, x = ‘months_as_customer’, y = ‘age’, color = ‘fraud_reported’, marginal_x = ‘rug’,<br/> marginal_y = ‘histogram’)<br/>fig.show()</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/a5cbdebd07c0f16d6291342971c9961c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K9Tb1-DhSCo9CHDK56DjBQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">年龄、客户月份和报告的欺诈之间的关系</figcaption></figure><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="a4aa" class="ld jv hi ls b fi lw lx l ly lz">fig = px.scatter(train, x = ‘months_as_customer’, y = ‘policy_annual_premium’, color = ‘fraud_reported’,<br/> marginal_x = ‘rug’, marginal_y = ‘histogram’)<br/>fig.show()</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/f0e3a81f9742b2d4d22db033184b62a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NS-bV5KpIn7zS4DtdiFTeA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">保单保费、月客户和欺诈报告之间的关系</figcaption></figure><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="25a4" class="ld jv hi ls b fi lw lx l ly lz">fig = px.scatter(train, x = ‘months_as_customer’, y = ‘total_claim_amount’, color = ‘fraud_reported’, marginal_x = ‘rug’, marginal_y = ‘histogram’)<br/>fig.show()</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/92db9b4756cc966c9d7b1911542143db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P-ZCXJj8_fazV45dOZCeUg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">索赔总额、客户月份和报告的欺诈之间的关系</figcaption></figure><p id="e545" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们来看看总索赔、伤害索赔、财产索赔、车辆索赔与欺诈_报告有什么关系。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="1f69" class="ld jv hi ls b fi lw lx l ly lz">fig = px.scatter_matrix(train, dimensions=[“total_claim_amount”, “injury_claim”, “property_claim”, “vehicle_claim”], color = “fraud_reported”)<br/>fig.show()</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/ce22010654de4003c91579fe294d2404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XBQ3GBTjpGYrbGCHU6KPMg.png"/></div></div></figure><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="37cd" class="ld jv hi ls b fi lw lx l ly lz">fig, axes = joypy.joyplot(train,<br/> column = [‘incident_hour_of_the_day’,’number_of_vehicles_involved’, ‘witnesses’],<br/> by = ‘incident_city’,<br/> ylim = ‘own’,<br/> figsize = (20, 10),<br/> alpha = 0.5, <br/> legend = True)</span><span id="1fde" class="ld jv hi ls b fi ma lx l ly lz">plt.title(‘Incident hour, No. of vehicles, witnesses vs Incident City’, fontsize = 20)<br/>plt.show()</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/1d3ec5ce7cedadf724ad086b7b5e6045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yHUUYKYP_3k_Yoe0Q2u5OQ.png"/></div></div></figure><p id="405a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们将欺诈报告编码成数字值，并创建一些额外的图表。我喜欢老学校的“分组”方法来快速查看分布。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es md"><img src="../Images/f9a6d633a24b6489947277cc7e214145.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*5Ljt1szYdJY0wg5MUgf0HA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">性别分布与目标变量</figcaption></figure><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="a41a" class="ld jv hi ls b fi lw lx l ly lz"># <strong class="ls hj">Count the fraudulent transactions by gender</strong><br/>ax = sns.countplot(x=”insured_sex”, hue=”fraud_reported”, data=train)</span><span id="960f" class="ld jv hi ls b fi ma lx l ly lz"># Analyze fraudulent transactions by gender<br/>train[[“insured_sex”, “fraud_reported”]].groupby([‘insured_sex’]).count().sort_values(by=’fraud_reported’, ascending=False)</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es me"><img src="../Images/b59a54c86b5d6a8660214e08d83ba0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*N3gFw713530CvRQ5pa3pOw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">按性别划分的平均欺诈概率</figcaption></figure><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="80be" class="ld jv hi ls b fi lw lx l ly lz"># <strong class="ls hj">Analyze the Probability of fraud by Gender</strong><br/>g = sns.barplot(x=”insured_sex”,y=”fraud_reported”,data=train)<br/>g = g.set_ylabel(“Fraud Probability”)<br/>train[[“insured_sex”, “fraud_reported”]].groupby([‘insured_sex’]).mean().sort_values(by=’fraud_reported’, ascending=False)</span></pre><p id="dee9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们探索另一种方法来分析年龄分布的反应变量(欺诈报告)</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="2fed" class="ld jv hi ls b fi lw lx l ly lz">fig = plt.figure(figsize=(10,8),)<br/>axis = sns.kdeplot(train.loc[(train[‘fraud_reported’] == 1),’age’] , color=’g’,shade=True, label=’Fraudulent Claims’)<br/>axis = sns.kdeplot(train.loc[(train[‘fraud_reported’] == 0),’age’] , color=’b’,shade=True,label=’Nonfraudulent Claims’)<br/>plt.title(‘Age Distribution — Fraud V.S. Non Fraud Claims’, fontsize = 20)<br/>plt.xlabel(“Age”, fontsize = 12)<br/>plt.ylabel(‘Frequency’, fontsize = 12);</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/abad287e99a997911a2734491b0f177e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*qvl0rPRmx9lI9FlwoNkW8w.png"/></div></figure><p id="d571" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们来按教育程度分析一下造假的概率</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="ac39" class="ld jv hi ls b fi lw lx l ly lz"># Analyze the Probability of fraud by education level<br/>fig, ax = plt.subplots(figsize=(12,6))<br/>g = sns.barplot(x=”insured_education_level”,y=”fraud_reported”,data=train)<br/>g = g.set_ylabel(“Fraud Probability”)<br/>train[[“insured_education_level”, “fraud_reported”]].groupby([‘insured_education_level’]).mean().sort_values(by=’fraud_reported’, ascending=False)</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/9fcb8b2ab8825c6d1ec9980008a7b68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QT8M1ynIWXO2TwM5F3r9Qg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">按教育水平划分的平均欺诈概率</figcaption></figure><p id="7fb8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过被保险人关系分析欺诈的可能性。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/964c8b0ccebbe5b1a6c12c48c0dc37cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MU19WHaQtL1fdokPbr072Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">按投保关系列出的平均欺诈概率</figcaption></figure><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es me"><img src="../Images/89e34b879a96541d953a3b73cb801643.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*zcOZeUxoZjCSD4VVXYm-9Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">按冲突类型列出的平均欺诈概率</figcaption></figure><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="274f" class="ld jv hi ls b fi lw lx l ly lz">g = sns.barplot(x=”collision_type”,y=”fraud_reported”,data=train)<br/>g = g.set_ylabel(“Fraud Probability”)<br/>train[[“collision_type”, “fraud_reported”]].groupby([‘collision_type’]).mean().sort_values(by=’fraud_reported’, ascending=False)</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es md"><img src="../Images/833a5975d1e525b52b1c6481f4b16d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*AEYlzIV13a7C_8VhMYNEsQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">按事件严重性划分的平均欺诈概率</figcaption></figure><p id="dd82" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们用泡泡图来看看一些趋势</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="4c57" class="ld jv hi ls b fi lw lx l ly lz">import warnings<br/>warnings.filterwarnings(‘ignore’)</span><span id="3df9" class="ld jv hi ls b fi ma lx l ly lz">figure = bubbleplot(dataset = train, x_column = ‘policy_annual_premium’, y_column = ‘total_claim_amount’,<br/> bubble_column = ‘fraud_reported’, time_column = ‘auto_year’, size_column = ‘months_as_customer’,<br/> color_column = ‘fraud_reported’, x_title = “Annual Policy Premium”, y_title = “Total Claim Amount”,<br/> title = ‘Total Claim Amount, Annual Premium and Months as Customer’,<br/> x_logscale = False, scale_bubble = 3, height = 650)</span><span id="6d90" class="ld jv hi ls b fi ma lx l ly lz">py.iplot(figure, config={‘scrollzoom’: True})</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/b4e026abf11d17e2ff389088b8b7c4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GuMXKt0R7eEUTj365ZEN9w.png"/></div></div></figure><h2 id="c2ed" class="ld jv hi bd iu le lf lg jz lh li lj kd jg lk ll kh jk lm ln kl jo lo lp kp lq bi translated"><strong class="ak"> 4。包括特征工程在内的数据准备</strong></h2><p id="4b48" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">让我们使用“一天中的某个时刻”功能来创建一些类别</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="0889" class="ld jv hi ls b fi lw lx l ly lz">bins = [-1, 3, 6, 9, 12, 17, 20, 24] <br/>catg = [“past_midnight”, “early_morning”, “morning”, ‘fore-noon’, ‘afternoon’, ‘evening’, ‘night’]<br/>train[‘incident_period’] = pd.cut(train.incident_hour_of_the_day, bins, labels=catg).astype(object)<br/>train[[‘incident_hour_of_the_day’, ‘incident_period’]].head(20)</span></pre><p id="9e4f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很少有数字特征可以用作离散的类别</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="86c7" class="ld jv hi ls b fi lw lx l ly lz">#Transforming some numerical variables that are really categorical<br/>train[‘number_of_vehicles_involved’] = train[‘number_of_vehicles_involved’].apply(str)<br/>train[‘witnesses’] = train[‘witnesses’].apply(str)<br/>train[‘bodily_injuries’] = train[‘bodily_injuries’].apply(str)</span></pre><p id="3bda" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为所有分类特征创建虚拟变量。将父变量和其他从建模角度来看无用的变量一起删除。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="ffcd" class="ld jv hi ls b fi lw lx l ly lz">dummies = pd.get_dummies(train[[‘policy_state’, ‘insured_sex’, ‘insured_education_level’, ‘insured_occupation’, <br/> ‘insured_hobbies’, ‘insured_relationship’, ‘incident_type’,<br/> ‘collision_type’, ‘incident_severity’, ‘authorities_contacted’, ‘incident_state’,<br/> ‘incident_city’, ‘number_of_vehicles_involved’, ‘property_damage’, ‘bodily_injuries’,<br/> ‘witnesses’, ‘police_report_available’, ‘auto_make’, ‘auto_model’, ‘incident_period’]])</span><span id="0939" class="ld jv hi ls b fi ma lx l ly lz">dummies.head(5)</span></pre><p id="78f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们将数据集分成训练和测试子集，以便进行训练和测试</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="0326" class="ld jv hi ls b fi lw lx l ly lz">x_train, x_test, y_train, y_test = train_test_split(x_unscaled, y, test_size = 0.2, random_state = 0)</span><span id="a5b9" class="ld jv hi ls b fi ma lx l ly lz">print(“Shape of x_train :”, x_train.shape)<br/>print(“Shape of x_test :”, x_test.shape)<br/>print(“Shape of y_train :”, y_train.shape)<br/>print(“Shape of y_test :”, y_test.shape)</span><span id="eaeb" class="ld jv hi ls b fi ma lx l ly lz">Shape of x_train : (800, 168)<br/>Shape of x_test : (200, 168)<br/>Shape of y_train : (800,)<br/>Shape of y_test : (200,)</span></pre><p id="0a7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">训练和测试数据集需要使用标准标量方法进行标准化，因为索赔额等少数特征具有高值，可能会扭曲预测。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="0fc5" class="ld jv hi ls b fi lw lx l ly lz">scaler = StandardScaler(with_mean=False)<br/>X_train = scaler.fit_transform(x_train)<br/>x_test = scaler.fit_transform(x_test)<br/>Y_train= y_train</span></pre><p id="04d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 5。开发模型</strong></p><p id="a9a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用Kfold分层交叉验证方法拟合一些快速模型，并评估不同模型的表现。<em class="jt">参考GitHub代码</em></p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/a96026597525fa90557c11985a4825be.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*6iP7S0Qlrl4Nm4vGIpgUsQ.png"/></div></figure><p id="d789" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">6。模型评估</p><p id="4276" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用网格搜索法测试算法的参数优化。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="0623" class="ld jv hi ls b fi lw lx l ly lz"># Adaboost<br/>DTC = DecisionTreeClassifier()<br/>adaDTC = AdaBoostClassifier(DTC, random_state=7)<br/>ada_param_grid = {“base_estimator__criterion” : [“gini”, “entropy”],<br/> base_estimator__splitter”: [“best”, “random”],<br/> “algorithm” : [“SAMME”,”SAMME.R”],<br/> “n_estimators” :[1,2],<br/> “learning_rate”: [0.0001, 0.001, 0.01, 0.1, 0.2, 0.3,1.5]}</span><span id="c2b3" class="ld jv hi ls b fi ma lx l ly lz">gsadaDTC = GridSearchCV(adaDTC,param_grid = ada_param_grid, cv=kfold, scoring=”accuracy”, n_jobs= 4, verbose = 1)<br/>gsadaDTC.fit(X_train,Y_train)</span><span id="020a" class="ld jv hi ls b fi ma lx l ly lz">ada_best = gsadaDTC.best_estimator_<br/>gsadaDTC.best_score_</span></pre><p id="0aad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Adaboost最好成绩— <strong class="ix hj"> 82.87% </strong></p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="b4e0" class="ld jv hi ls b fi lw lx l ly lz">#ExtraTrees <br/>ExtC = ExtraTreesClassifier()<br/>## Search grid for optimal parameters<br/>ex_param_grid = {“max_depth”: [None],<br/> “max_features”: [1, 3, 10],<br/> “min_samples_split”: [2, 3, 10],<br/> “min_samples_leaf”: [1, 3, 10],<br/> “bootstrap”: [False],<br/> “n_estimators” :[100,300],<br/> “criterion”: [“gini”]}</span><span id="7443" class="ld jv hi ls b fi ma lx l ly lz">gsExtC = GridSearchCV(ExtC,param_grid = ex_param_grid, cv=kfold, scoring=”accuracy”, n_jobs= 4, verbose = 1)<br/>gsExtC.fit(X_train,Y_train)<br/>ExtC_best = gsExtC.best_estimator_</span><span id="a96d" class="ld jv hi ls b fi ma lx l ly lz"># Best score<br/>gsExtC.best_score_</span></pre><p id="8491" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">树外最高分— <strong class="ix hj"> 78.99% </strong></p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="669d" class="ld jv hi ls b fi lw lx l ly lz"># RFC Parameters tunning <br/>RFC = RandomForestClassifier()<br/>## Search grid for optimal parameters<br/>rf_param_grid = {“max_depth”: [None],<br/> “max_features”: [1, 3, 10],<br/> “min_samples_split”: [2, 3, 10],<br/> “min_samples_leaf”: [1, 3, 10],<br/> “bootstrap”: [False],<br/> “n_estimators” :[100,300],<br/> “criterion”: [“gini”]}</span><span id="0fed" class="ld jv hi ls b fi ma lx l ly lz">gsRFC = GridSearchCV(RFC,param_grid = rf_param_grid, cv=kfold, scoring=”accuracy”, n_jobs= 4, verbose = 1)<br/>gsRFC.fit(X_train,Y_train)<br/>RFC_best = gsRFC.best_estimator_</span><span id="44c7" class="ld jv hi ls b fi ma lx l ly lz"># Best score<br/>gsRFC.best_score_</span></pre><p id="7eb8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随机森林分类器最佳得分— <strong class="ix hj"> 78.25% </strong></p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="b7dc" class="ld jv hi ls b fi lw lx l ly lz"># Gradient boosting <br/>GBC = GradientBoostingClassifier()<br/>gb_param_grid = {‘loss’ : [“deviance”],<br/> ‘n_estimators’ : [100,200,300],<br/> ‘learning_rate’: [0.1, 0.05, 0.01],<br/> ‘max_depth’: [4, 8],<br/> ‘min_samples_leaf’: [100,150],<br/> ‘max_features’: [0.3, 0.1]}</span><span id="bcaa" class="ld jv hi ls b fi ma lx l ly lz">gsGBC = GridSearchCV(GBC,param_grid = gb_param_grid, cv=kfold, scoring=”accuracy”, n_jobs= 4, verbose = 1)<br/>gsGBC.fit(X_train,Y_train)<br/>GBC_best = gsGBC.best_estimator_</span><span id="3a93" class="ld jv hi ls b fi ma lx l ly lz"># Best score<br/>gsGBC.best_score_</span></pre><p id="714f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">梯度推进最佳得分— <strong class="ix hj"> 79.25% </strong></p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="1259" class="ld jv hi ls b fi lw lx l ly lz">### SVC classifier<br/>SVMC = SVC(probability=True)<br/>svc_param_grid = {‘kernel’: [‘rbf’], <br/> ‘gamma’: [ 0.001, 0.01, 0.1, 1],<br/> ‘C’: [1, 10, 50, 100,200,300, 1000]}</span><span id="6c19" class="ld jv hi ls b fi ma lx l ly lz">gsSVMC = GridSearchCV(SVMC,param_grid = svc_param_grid, cv=kfold, scoring=”accuracy”, n_jobs= 4, verbose = 1)<br/>gsSVMC.fit(X_train,Y_train)<br/>SVMC_best = gsSVMC.best_estimator_</span><span id="fa0b" class="ld jv hi ls b fi ma lx l ly lz"># Best score<br/>gsSVMC.best_score_</span></pre><p id="5eb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用SVC预测打印一个混淆矩阵。该模型的训练精度为<strong class="ix hj"> 94.75% </strong>，测试精度为<strong class="ix hj"> 83% </strong>。我们可以使用<strong class="ix hj"> SMOTE </strong>进一步改进吗？</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="64e8" class="ld jv hi ls b fi lw lx l ly lz">Training Accuracy:  0.9475<br/>Testing Accuarcy:  0.83<br/>              precision    recall  f1-score   support<br/><br/>           0       0.84      0.94      0.89       143<br/>           1       0.79      0.54      0.65        57<br/><br/>    accuracy                           0.83       200<br/>   macro avg       0.82      0.74      0.77       200<br/>weighted avg       0.83      0.83      0.82       200</span></pre><h2 id="512d" class="ld jv hi bd iu le lf lg jz lh li lj kd jg lk ll kh jk lm ln kl jo lo lp kp lq bi translated">SMOTE——合成少数过采样技术</h2><p id="358c" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">与索赔相关的分析受到不平衡的阶级数据的影响，这意味着多数阶级和少数阶级之间可能存在显著差异。换句话说，少数类的例子太少，模型无法有效地学习决策边界。</p><p id="8fb2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">解决这种情况的一种方法是对少数类进行过采样(本例中欺诈= 1)。这种方法包括简单地复制少数民族类的例子。这是一种针对少数类的数据处理，称为<strong class="ix hj">合成少数过采样技术</strong>或简称SMOTE。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="ba59" class="ld jv hi ls b fi lw lx l ly lz">from imblearn.over_sampling import SMOTE<br/>x_resample, y_resample  = SMOTE().fit_sample(x_unscaled, y.values.ravel())<br/>print("Shape of x_resample :",x_resample.shape)<br/>print("Shape of y_resample :",y_resample.shape)</span><span id="665e" class="ld jv hi ls b fi ma lx l ly lz"><strong class="ls hj"><em class="jt">Shape of x_resample : (1506, 168)<br/>Shape of y_resample : (1506,)<br/></em></strong></span></pre><p id="a46b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建一个训练和测试分割。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="d5c3" class="ld jv hi ls b fi lw lx l ly lz">x_train2, x_test2, y_train2, y_test2 = train_test_split(x_resample, y_resample, test_size = 0.2, random_state = 0)<br/>print(“Shape of x_train2 :”, x_train2.shape)<br/>print(“Shape of y_train2 :”, y_train2.shape)<br/>print(“Shape of x_test2 :”, x_test2.shape)<br/>print(“Shape of y_test2 :”, y_test2.shape)</span><span id="2f51" class="ld jv hi ls b fi ma lx l ly lz"><strong class="ls hj"><em class="jt">Shape of x_train2 : (1204, 168)<br/>Shape of y_train2 : (1204,)<br/>Shape of x_test2 : (302, 168)<br/>Shape of y_test2 : (302,)</em></strong></span></pre><p id="d946" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标准化数据集</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="9483" class="ld jv hi ls b fi lw lx l ly lz"># standardization<br/>from sklearn.preprocessing import StandardScaler<br/>sc = StandardScaler()<br/>x_train2 = sc.fit_transform(x_train2)<br/>x_test2 = sc.transform(x_test2)</span></pre><p id="9f57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们在重新采样的数据集上训练和测试SVC模型，并打印一个混淆矩阵。</p><pre class="ky kz la lb fd lr ls lt lu aw lv bi"><span id="0728" class="ld jv hi ls b fi lw lx l ly lz">Training Accuracy:  1.0<br/>Testing Accuarcy:  0.8576158940397351<br/>              precision    recall  f1-score   support<br/><br/>           0       0.83      0.91      0.87       154<br/>           1       0.89      0.80      0.85       148<br/><br/>    accuracy                           0.86       302<br/>   macro avg       0.86      0.86      0.86       302<br/>weighted avg       0.86      0.86      0.86       302</span></pre><p id="7f1c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，使用SMOTE的过采样有助于使用相同的SVC算法将预测一直提高到<strong class="ix hj"> 85.7% </strong>。</p><h2 id="dfb2" class="ld jv hi bd iu le lf lg jz lh li lj kd jg lk ll kh jk lm ln kl jo lo lp kp lq bi translated"><strong class="ak"> 7。结论</strong></h2><p id="3033" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">为了保持文章简短，我没有加入太多的情节和分析。在分析索赔数据时，可以根据业务和数据的可用性做出一些决策。</p><p id="84f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">说到这里，我想给你留下一些思考的素材！！！</p><ol class=""><li id="6d11" class="mi mj hi ix b iy iz jc jd jg mk jk ml jo mm js mn mo mp mq bi translated"><strong class="ix hj">做客户的几个月</strong>——老客户是不是更忠诚、更真实？保单签发日期和事故日期之间的微小差异是否表明存在欺诈？</li><li id="160c" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated"><strong class="ix hj">年龄</strong> —年龄可能是表明欺诈性索赔的重要因素吗？与老一代人相比，年轻人更有可能实施欺诈吗？如果是，如何定义阈值？</li><li id="4999" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated">性别——男人更容易出轨吗？</li><li id="d56e" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated"><strong class="ix hj">投保职业</strong> —蓝领工人比白领工人更容易卷入诈骗吗？</li><li id="92ea" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated"><strong class="ix hj">爱好和关系</strong> —爱好和与被保险人的关系有影响吗？</li><li id="23e4" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated">年度保费——高额保费会诱使索赔人夸大事故后的维修费用吗？</li><li id="49fe" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated"><strong class="ix hj">投保的邮政编码和州名</strong> —您是否观察到邮政编码和州名的任何特定模式？与其他人相比，来自特定邮政编码或州的人更有可能提出索赔吗？</li><li id="6823" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated"><strong class="ix hj">事故、碰撞和严重程度类型</strong> —欺诈索赔与特定事故或碰撞类型相关联的可能性有多大？</li><li id="fef9" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated"><strong class="ix hj">证人</strong> —证人的在场与否与欺诈有何关联？目击者的出现是否意味着一场精心策划的事故？或者没有证人可能是欺诈的潜在迹象？</li><li id="0cd2" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated"><strong class="ix hj">总索赔与伤害和车辆索赔</strong> —伤害与车辆索赔的比率反映了什么吗？假设发生了一次严重的事故，造成了大范围的身体伤害，但只有一次轻微的伤害被主观诊断为需要很少或不需要医疗处理。这对索赔调查员或数据科学家意味着什么？</li></ol><p id="e8d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你喜欢这篇文章，请分享并鼓掌。请在<a class="ae kw" href="https://www.linkedin.com/in/rajeshpanthri/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae kw" href="https://www.kaggle.com/rp1611" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上关注我，如果有任何问题，请留言。我将非常乐意回答你的问题。</p><p id="9c75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">敬请关注更多内容。快乐阅读！！！</p></div></div>    
</body>
</html>