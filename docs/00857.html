<html>
<head>
<title>Calibration in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的校准</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/calibration-in-machine-learning-e7972ac93555?source=collection_archive---------0-----------------------#2019-09-14">https://medium.com/analytics-vidhya/calibration-in-machine-learning-e7972ac93555?source=collection_archive---------0-----------------------#2019-09-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7b71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个博客中，我们将学习什么是校准，为什么以及何时应该使用它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3b2e007d1a8de0160a126e2cd71f4b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6zw5at5l08_zNsjK9-FTPg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图像取自鞋盒测听</figcaption></figure><p id="f2cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当属于一个类别的数据点的概率估计非常重要时，我们校准我们的模型。</p><p id="2616" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">校准是将实际输出与系统给出的预期输出进行比较。现在让我从机器学习的角度来看这个问题。</p><p id="0815" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">在校准中，我们试图改进我们的模型，使预测的概率分布和行为与训练数据中观察到的概率分布和行为相似。</strong></p><p id="7095" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们有一个小样本的数据点。假设样本中有10个点，这10个点中有7个属于正类，3个属于负类。那么正点数的分数是0.7( <strong class="ih hj">观察概率</strong>)。这意味着该样本中的一个点有70%的概率得到一个类标签为正。现在我们将取模型预测的概率估计值的平均值(<strong class="ih hj">预测概率</strong>)。我们预计这个平均值在0.7左右。如果这个值远离0.7，那么我们的模型没有被校准。下图显示了模型完全校准时的理想情况。我们实际上没有得到这个图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/512eaececce416f648a49a51a59c0737.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*QNNeztJURpZPYisJVNOPJQ.jpeg"/></div></figure><p id="70b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">现在，按照以下步骤绘制校准图。</strong></p><ol class=""><li id="6931" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">创建一个数据集，它有两列，一列是实际标签，另一列是模型给出的预测概率。</li><li id="e79c" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">按照模型预测的概率的升序对此数据集进行排序。</li><li id="70ab" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">现在将数据集分成一些固定大小的箱。如果数据集很大，则保持bin大小较大，反之亦然。</li><li id="7e2b" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">现在计算每个箱中实际阳性的分数和模型预测的平均概率。</li><li id="a367" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">用y轴上的正数分数和x轴上的平均概率绘制一个图表。</li></ol><blockquote class="ki kj kk"><p id="b6e2" class="if ig kl ih b ii ij ik il im in io ip km ir is it kn iv iw ix ko iz ja jb jc hb bi translated">在理解如何防止你的模型过拟合和欠拟合时遇到困难，那么浏览这个<a class="ae kp" href="https://towardsdatascience.com/overfitting-and-underfitting-in-machine-learning-89738c58f610" rel="noopener" target="_blank"> <strong class="ih hj">博客</strong> </a>。</p></blockquote><div class="kq kr ez fb ks kt"><a href="https://towardsdatascience.com/overfitting-and-underfitting-in-machine-learning-89738c58f610" rel="noopener follow" target="_blank"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">机器学习中的过拟合和欠拟合</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">在这篇文章中，你将了解什么是过度拟合和欠拟合。您还将学习如何防止模型…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">towardsdatascience.com</p></div></div><div class="lc l"><div class="ld l le lf lg lc lh jn kt"/></div></div></a></div><h1 id="afad" class="li lj hi bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">有两种校准方法。</h1><ol class=""><li id="633e" class="ju jv hi ih b ii mg im mh iq mi iu mj iy mk jc jz ka kb kc bi translated"><strong class="ih hj"> Sigmoid/ Platt的:</strong>在这种技术中，我们使用Sigmoid函数的微小变化来拟合预测概率的分布，以适应在训练数据中观察到的概率分布。我们实际上根据实际标签对模型的输出执行逻辑回归。使用的数学函数如下所示:</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/60c7ea6e5a3909792caac97a5fbd7d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_jhy-cUKxil0iG4Wzvkjzg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">用于普拉特校准的修正Sigmoid函数</figcaption></figure><p id="1266" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，为了执行校准，我们必须学习两个参数A和B的值。我们使用梯度下降来学习，您可以使用自己选择的任何优化算法。数学公式如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/f49b64989bbf9f18051ecd6f0050c88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Xv91FgtScXeCS4vCQZglg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">更新超参数A和b的数学公式。</figcaption></figure><p id="6357" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用Python编码Sigmoid校准</strong>:</p><p id="79f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sigmoid校准的简单实现如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mn"><img src="../Images/736ec6afb076982a4220f6de4a3a9de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*9obdD4wI00t4vT7CdLGsDg.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">sigmoid校准的实现</figcaption></figure><p id="b492" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">等张:</strong>在技术上我们用分段常数非减函数代替sigmoid函数。在这种情况下，我们以分段的方式进行线性回归拟合。给定一个模型，fi作为预测值，yi作为实际目标值，然后我们做如下假设</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mo"><img src="../Images/b958fedf822f76dc25bdebecd6c18a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*-cfWyIsCy06Kn97_VtfeYA.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">等渗校准中的假设</figcaption></figure><p id="bfa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中m是等张函数。现在给定训练集{fi，yi}，我们试图找到最小化以下等式的保序函数m^by。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mp"><img src="../Images/73d74ae377d5e90a83a0977ad9ef64cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*74vWjqgqwB0noHa2gTLKAw.jpeg"/></div></figure><p id="d7f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用来解决这个问题的算法叫做<strong class="ih hj">成对相邻违规者算法。</strong>算法的<strong class="ih hj"> </strong>伪代码如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/dba951811c4cdc959254db005f661f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DcsgIQubc-OO8pxYMj55DA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">成对相邻违规者算法</figcaption></figure><h1 id="f4a6" class="li lj hi bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">将校准应用于真实数据集:</h1><p id="92b9" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mq is it iu mr iw ix iy ms ja jb jc hb bi translated">我们可以通过使用python中<strong class="ih hj"> sklearn库</strong>中的<strong class="ih hj"> CalibratedClassifierCv类</strong>来应用校准。对于sigmoid校准，只需在创建此类对象时传递“sigmoid ”,对于等渗校准，只需传递等渗。</p><p id="5406" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在应用校准之前，我们必须通过绘制实际概率的<strong class="ih hj">可靠性图</strong>和测试数据集上模型预测的概率来<strong class="ih hj">诊断校准</strong>。在sklearn中，我们使用<strong class="ih hj">校准_曲线</strong>方法。</p><p id="51b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我将使用亚马逊美食评论数据集对SVM模型进行校准。数据集的链接如下</p><p id="cce3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集:<a class="ae kp" href="https://www.kaggle.com/snap/amazon-fine-food-reviews" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/snap/amazon-fine-food-reviews</a></p><p id="f21d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先让我们诊断校准。所以让我们看看代码本身。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mt"><img src="../Images/dac25706e71409c6a0916eed88aab862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmHdweiYlQWwrzVKx2lqMw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">绘制可靠性图以诊断校准的代码</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mu"><img src="../Images/d46c122c7d4160ba808522279087a735.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*wP4oNfR8NrOkFZqkWOHrNw.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">无校准的可靠性图</figcaption></figure><p id="afb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们使用<strong class="ih hj">乙状结肠校准</strong>，看看结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/ed48528bf162fb34ddaa435dfb156362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o5GeAAWAxWgJCZTcRUicRQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">sigmoid校准代码</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mw"><img src="../Images/0133cc346158947d61439a74cc3b14d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*f5_OLeYcxflEouwIF-3yjg.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">sigmoid校准后的可靠性图。</figcaption></figure><p id="1957" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们用<strong class="ih hj">等渗校准</strong>看看结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mx"><img src="../Images/56522f2a2fce904e1fe053d3ab12b86a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*0w6FqEl8a6YuDv3kPuy0Tg.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">等渗校准代码</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es my"><img src="../Images/dfdf64bda817a9f7f420a35aa80304f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*WQsPHatxtQYmmsBdrmY-vw.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">等渗校准后的可靠性图。</figcaption></figure><p id="8f57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们可以看到，在应用校准后，模型预测的概率有了明显的提高。我们还可以看到，等渗校准在使概率值更接近对角线方面表现得更好。</p><h1 id="776c" class="li lj hi bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">现在我认为，</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mz"><img src="../Images/7541cf6ec81db2d740669e013a15a167.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*yuAvheaS1W641eq89OUq0Q.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图片来自giphy</figcaption></figure><p id="e211" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">暂时就这些了。如果你有任何问题，请写在评论里。</p><p id="407a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">浏览此<a class="ae kp" rel="noopener" href="/analytics-vidhya/long-short-term-memory-lstm-in-keras-2b5749e953ac"> <strong class="ih hj">博客</strong> </a>开始学习LSTMs。</p><div class="kq kr ez fb ks kt"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/long-short-term-memory-lstm-in-keras-2b5749e953ac"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">Keras的长短期记忆(LSTM)</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">在这篇文章中，你将学习如何在Keras建立一个LSTM网络。这里我将解释所有的小细节…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">medium.com</p></div></div><div class="lc l"><div class="na l le lf lg lc lh jn kt"/></div></div></a></div><p id="8bd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你是深度学习的新手，想知道LSTM网络中参数的数量是如何计算的，可以去看看这个<a class="ae kp" rel="noopener" href="/analytics-vidhya/guide-to-lstms-for-beginners-ac9d1fc86176"> <strong class="ih hj">博客</strong> </a>。</p><div class="kq kr ez fb ks kt"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/guide-to-lstms-for-beginners-ac9d1fc86176"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">LSTMs初学者指南。</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">在这个博客中，你将了解什么是LSTM，为什么我们需要它，以及LSTM的内部建筑概况。</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">medium.com</p></div></div><div class="lc l"><div class="nb l le lf lg lc lh jn kt"/></div></div></a></div></div></div>    
</body>
</html>