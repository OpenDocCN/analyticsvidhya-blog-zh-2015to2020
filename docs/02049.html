<html>
<head>
<title>Amazon.com and Machine Learning(Part-1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Amazon.com与机器学习(上)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/amazon-com-and-machine-learning-part-1-40b9d6421359?source=collection_archive---------12-----------------------#2019-11-27">https://medium.com/analytics-vidhya/amazon-com-and-machine-learning-part-1-40b9d6421359?source=collection_archive---------12-----------------------#2019-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/cf36bc1a6ebda544d19e58d1b7cc8202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*hXK98CB5neIiVh1ZtUu4CA.jpeg"/></div></figure><p id="d8d7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里，我们将解决一个基于亚马逊美食评论的分类问题。</p><h2 id="d6fd" class="jk jl hi bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated">目标:</h2><p id="3402" class="pw-post-body-paragraph im in hi io b ip kf ir is it kg iv iw ix kh iz ja jb ki jd je jf kj jh ji jj hb bi translated">对于给定的审核，确定该审核是正面的(评分为4或5)还是负面的(评分为1或2)。</p><p id="fce3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数据来源:<a class="ae kk" href="https://www.kaggle.com/snap/amazon-fine-food-reviews" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/snap/amazon-fine-food-reviews</a></p><p id="eb87" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">亚马逊美食点评数据集由来自亚马逊的美食点评组成。</strong></p><p id="818c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">评论数:568454<br/>用户数:256059<br/>产品数:74258<br/>时间跨度:1999年10月—2012年10月<br/>数据中的属性/列数:10</p><h2 id="5857" class="jk jl hi bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated">属性信息</h2><ol class=""><li id="7f17" class="kl km hi io b ip kf it kg ix kn jb ko jf kp jj kq kr ks kt bi translated">身份</li><li id="2c87" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">产品Id —产品的唯一标识符</li><li id="2609" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">UserId —用户的唯一标识符</li><li id="0aad" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">ProfileName</li><li id="0715" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">帮助度分子—认为评论有帮助的用户数量</li><li id="cdd5" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">帮助度分母——表示他们认为评论是否有帮助的用户数量</li><li id="6b35" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">分数—评分在1到5分之间</li><li id="57ca" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">时间—审核的时间戳</li><li id="fe60" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">摘要—审核的简要摘要</li><li id="bdd8" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">文本—审阅的文本</li></ol><p id="183d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="kz">评分为4或5可视为正面评价。1或2的评论可能被认为是负面的。3的评论是中性的，忽略不计。这是一种确定评论极性(积极/消极)的近似和代理方式。</em></p><h2 id="3539" class="jk jl hi bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated">加载数据集</h2><p id="c593" class="pw-post-body-paragraph im in hi io b ip kf ir is it kg iv iw ix kh iz ja jb ki jd je jf kj jh ji jj hb bi translated">数据集有两种形式</p><ol class=""><li id="0209" class="kl km hi io b ip iq it iu ix la jb lb jf lc jj kq kr ks kt bi translated">。csv文件</li><li id="befb" class="kl km hi io b ip ku it kv ix kw jb kx jf ky jj kq kr ks kt bi translated">SQLite数据库</li></ol><p id="6472" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将使用csv数据文件。</p><p id="807e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里，由于我们只想获得推荐的整体情绪(正面或负面)，我们将有意忽略所有等于3的分数。如果分数高于3，则推荐将被设置为“正面”。否则，它将被设置为“负”。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ld"><img src="../Images/1ef69e8c04d92c98395b77c0bde291c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P_OGj-fYfw8HW2GS4HGTxw.jpeg"/></div></div></figure><p id="5153" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> df.info </strong>将告诉我们关于数据帧的重要信息，如总列数、总行数等。</p><p id="00d4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> df.head() </strong>将返回数据帧的前五行。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lm"><img src="../Images/e6dfa5de9545e3cda8103966a7a2a2fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8eDLd5XdSEtPYEFmPsTAw.jpeg"/></div></div></figure><p id="1af9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> df.columns </strong>将返回数据集中所有列的名称。</p><p id="94a4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> df.describe </strong>将返回每个特征的总数、平均值、标准偏差、最小值等。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ln"><img src="../Images/d80da4468f98955abea109f51373a297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKQM2eSznKLuMFUHTKQpwA.jpeg"/></div></div></figure><p id="9530" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们创建一个函数，以正面、负面和中性的方式返回评论。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lo"><img src="../Images/de3a2df2b12af34c9dbcdcb5079ba218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGjDR_XhQN31aMwviAS7Mw.jpeg"/></div></div></figure><p id="322d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将使用map函数来调用函数different()。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lp"><img src="../Images/de55403a07a235f5ad4d8f6a3601877f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VaWMOt4hDthQH2FNB96fFA.jpeg"/></div></div></figure><p id="414a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们发现正面评价的数量远远高于负面评价的数量。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lq"><img src="../Images/fa2b7351c8b311c1510a208ceb3ee660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNF7e0pgTMGA76oALgu0cg.jpeg"/></div></div></figure><p id="76b6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们现在将从数据框架中删除<strong class="io hj">“分数”</strong>功能，因为我们希望使用自然语言编程和NLTK工具来分析客户的评论。</p><p id="795e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们需要一个模型来分析文本，然后根据分析预测评论是正面的还是负面的。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lr"><img src="../Images/d96832ae35900c034b68e369e6af733b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EvyY_mASOKxOCm5pn7kzlw.jpeg"/></div></div></figure><h2 id="4498" class="jk jl hi bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated"><strong class="ak"> EDA(探索性数据分析)</strong></h2><ol class=""><li id="4a82" class="kl km hi io b ip kf it kg ix kn jb ko jf kp jj kq kr ks kt bi translated"><strong class="io hj">数据清理:重复数据删除</strong></li></ol><p id="514e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">观察到(如下表所示)评论数据有许多重复条目。因此，有必要删除重复，以获得数据分析的公正结果。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ls"><img src="../Images/7cddd13b345ec5751d8cc9b0c94d5525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eqY8NyWSH4FUe-pOVOnwQg.jpeg"/></div></div></figure><p id="ad36" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2。观察:</strong>还可以看到，在下面给出的两行中，帮助性分子的值大于帮助性分母，这实际上是不可能的，因此这两行也被从计算中删除</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/d3e18b38542d42e86931450862a12f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*9PFTp0gV4-xu-HladP4OOg.jpeg"/></div></figure><p id="bc7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们将学习NLP工具和技术，如词干化、标记化、词性标记、词汇化、单词包、TF-IDF、W2V(单词到向量)、平均TF-IDF等。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lu"><img src="../Images/5a208cd9c50367451b5e90aab5f01c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EZDPEvmtQ7I3JlCZLkduYA.jpeg"/></div></div></figure><p id="121d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们将清理用户提供的评论，我们将删除所有对文本意义没有任何意义的标签、标点符号和停用词(the、and、if、but)。</p><p id="9502" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将对每个句子进行标记，这样我们就可以很容易地获得每个单词在文档中的出现频率。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/952fc5ac705f109c97488305ce7d6d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*LcObXtiuEO5hRlEUdICZ_g.jpeg"/></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lw"><img src="../Images/7374a8a6719ca96c51528f33a74aeeb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kl1MQakbFzK9K60La1dMcA.jpeg"/></div></div></figure><p id="c3cc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">清洗后所有的评论都存储在一个名为<strong class="io hj"> gdArr2的列表中(包括正面、负面和中立)。</strong></p><p id="dc60" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所有正面评价都存储在一个名为<strong class="io hj"> all_pos5的列表中。</strong></p><p id="379d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所有负面评论都存储在一个名为<strong class="io hj"> all_neg5的列表中。</strong></p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lx"><img src="../Images/48bd385dafad26bb04ed68ade03bf180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XVqYkr99_B92cEY5dHN-cw.jpeg"/></div></div></figure><p id="d181" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在下一步是找出all_pos5、all_neg5和gdArr的长度。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/697591ba784fca552132ea0cbd256a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*7N7i_Tk7Ie9YeIvgz0ImMA.jpeg"/></div></figure><p id="59c2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是第一部分的结尾，在下一部分，我们将看到单词包，tf_idf，w2v是如何在文本分类中工作的。<br/> <strong class="io hj">感谢阅读……</strong></p></div></div>    
</body>
</html>