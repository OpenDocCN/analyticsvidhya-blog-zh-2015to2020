<html>
<head>
<title>SQL Server database setup and connecting through Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL Server数据库设置和通过Python连接</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sql-server-database-setup-and-connecting-through-python-f0cac42fecc8?source=collection_archive---------19-----------------------#2020-04-12">https://medium.com/analytics-vidhya/sql-server-database-setup-and-connecting-through-python-f0cac42fecc8?source=collection_archive---------19-----------------------#2020-04-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="df82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SQL Server 2014的环境设置:</p><p id="7670" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，下载微软的<a class="ae jd" href="https://www.microsoft.com/en-us/download/details.aspx?id=21" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">。NET Framework 3.5 </strong> </a>并安装。安装后，您可能需要重新启动系统。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/7376e8d4980a0051616edd2b1eaa8d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-opEy12rzrEOSnyl.jpg"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/0361e18410c543e8ba1d4faa85acecdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aHMQ8hhwZ9YsKOPN.jpg"/></div></div></figure><ul class=""><li id="008d" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">然后下载<a class="ae jd" href="https://www.microsoft.com/en-us/download/details.aspx?id=42299" rel="noopener ugc nofollow" target="_blank">微软SQL Server 2014 Express </a></li><li id="8ad6" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">检查您的系统是否满足所有要求，或者安装缺少的要求/软件。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kf"><img src="../Images/a68d63103f8d0b4b98392c04b08828af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QIUjy6bseYXhhk2j.jpg"/></div></div></figure><ul class=""><li id="a48b" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">对于这个项目，我使用的是64位机器。因此，我选择了64位软件/文件进行安装。</li><li id="c3fc" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">下载文件后。解压文件(选择解压文件的目录)。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kg"><img src="../Images/03f4bbc7d3a3e793de2d20fcc63568e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xhNOaQJIAvo6i-TN.jpg"/></div></div></figure><ul class=""><li id="f03e" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">一旦被提取出来。安装过程直接开始。然后选择规划选项，然后选择系统配置检查器并运行它，以检查配置是否满足所有要求。如果系统满足所有要求，新窗口会自动打开和关闭。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kh"><img src="../Images/6af1f60d3e17c9a8e2d3914bf62c657b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JvV5qBtppBQrbBV4.jpg"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ki"><img src="../Images/ff94df1d0e52bff6dccb850276dc1cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RjbszXKHfhbSZE74.jpg"/></div></div></figure><ul class=""><li id="0fa8" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">然后继续安装</li><li id="2899" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">在“安装选项”下，选择“新建SQL Server独立安装”或“向现有安装添加功能”。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kj"><img src="../Images/0cbc720676ea5a64032366a0d3cd5a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tSS68RI-KXR0f7sH.jpg"/></div></div></figure><ul class=""><li id="3132" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">选择许可条款。然后点击下一步。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kk"><img src="../Images/381cb77c43730ade56159662c5adf8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lZZ64hxWzaNdLUdp.jpg"/></div></div></figure><ul class=""><li id="353e" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">可选服务选择选项使用Microsoft Update检查更新(推荐)</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kl"><img src="../Images/f31cdd129a64c701fb1e4be905bb4dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jn0Zunjf_XZVgRi2.jpg"/></div></div></figure><ul class=""><li id="aca7" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">选择您需要的所有功能。根据您的要求对目录进行更改。对于这一个，我使用默认的目录。点击下一步。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es km"><img src="../Images/f28c930ff978bde1e65de386aefc2f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qdBT_awICP9v2UnM.jpg"/></div></div></figure><ul class=""><li id="4185" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">选择“命名实例”选项(默认名称)。对于这个安装，我使用名称SQLExpress。你想取什么名字都可以。但是我们很注意间距。我不建议给实例留出空间。记下您给出的实例名称，因为您稍后将使用它通过SSMS连接到实例。点击下一步。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kn"><img src="../Images/ea08a54104f40d50b62bb2e1d991db8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UHL2Ylt64ur9z-Gw.jpg"/></div></div></figure><ul class=""><li id="0d3b" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">单击“下一步”进行服务器配置。里面没什么需要改的。</li><li id="73d5" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">在“服务器配置”选项卡下的“数据库引擎配置”下，选择身份验证模式。为此，选择默认的Windows身份验证模式。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ko"><img src="../Images/3831bc54ca4a53befbe28073e6e3544a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xpz8C0I3q6lCOayV.jpg"/></div></div></figure><ul class=""><li id="88b9" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">然后转到<strong class="ih hj"> FILESTREAM </strong>选项卡，选择所有选项，然后单击下一步。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ko"><img src="../Images/04028842039675a4612cfcabde80e6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g-uSL_rVr7A-wQjf.jpg"/></div></div></figure><ul class=""><li id="6d90" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">安装开始，安装完成后。检查所有功能是否安装正确。然后关上窗户。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kp"><img src="../Images/48f6bd5e6878288056850160ab1ebbd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sXKUJ8xdlD1QtqPO.jpg"/></div></div></figure><ul class=""><li id="d63d" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">然后从windows开始菜单启动SSMS，并以管理权限运行。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ko"><img src="../Images/f44e4185e89a57314b039abf7191cfd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GSt2r95t0SwP7YR2.jpg"/></div></div></figure><ul class=""><li id="56c8" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">选择服务器类型为数据库引擎，您在安装SQL server时提供的服务器名称(服务器名称(或计算机名称)\实例名称)，身份验证。然后点击连接。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kq"><img src="../Images/7d0594fad1fda4ab57e9cddafb6a32c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*whjATxNF_ojDaQ1S.jpg"/></div></div></figure><ul class=""><li id="76af" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">在连接到实例之后，展开数据库连接，您可以看到一些默认的系统数据库，如下所示。我们将为我们的项目使用主数据库。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kr"><img src="../Images/74b688f041a079c0d47d2358c4eb0f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cusfTu1wsqhp_JXx.jpg"/></div></div></figure><ul class=""><li id="019c" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">进一步展开并运行查询，您可以找到如下所示的表值。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kr"><img src="../Images/f825e81109d21eb5226520e658c91527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*55IA4qZr3E1WyWG2.jpg"/></div></div></figure><ul class=""><li id="5670" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">我们的项目是连接到SQL server数据库，从特定的表中检索数据/表，并将其存储在. csv格式的文件中，我们正在连接到本地SQL Server数据库。</li><li id="47de" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">我希望你们都已经安装了<a class="ae jd" href="https://www.anaconda.com/download/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">蟒蛇分布</strong> </a>。如果没有安装，我请求您下载并安装它。我将在Anaconda发行版中使用Jupyter笔记本。如果你愿意，你也可以只安装<a class="ae jd" href="http://jupyter.org/install" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Jupyter笔记本</strong> </a>。</li><li id="671e" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">启动Jupyter笔记本，打开一个新的python Jupyter笔记本，如下图所示。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ks"><img src="../Images/88ba2b275ca2e25112b00f9ed5674748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jfT8OITO_d-u6wFd.jpg"/></div></div></figure><ul class=""><li id="f971" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">下面是这些值的最终输出。</li></ul><p id="ad7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Python(通过Jupyter Notebook)中，我所做的是连接到我的本地SQL Server数据库实例SQLExpress，稍后运行SQL查询从系统数据库主服务器获取一个表，然后将该表存储到SQL_data.csv文件中。稍后使用python打开SQL_data.csv文件并显示表格。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/0c230909452bf45ace818e6262ca0e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vL-6zejs07eppZ2v.jpg"/></div></div></figure><p id="9139" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Python(在Jupyter笔记本中)代码</p><ul class=""><li id="3749" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">安装库<code class="du ku kv kw kx b">pyodbc</code>以连接到服务器的Python代码(从Jupyter笔记本安装)。</li><li id="d696" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">将<code class="du ku kv kw kx b">pyodbc</code>和其他库导入python。</li></ul><p id="e62a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">import pyodbc as connector</code></p><p id="762b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">import pandas as pd</code></p><p id="694a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">import csv</code></p><ul class=""><li id="eda1" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">下面是如何连接到SQL Server的python代码。</li></ul><p id="e99e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">driver = connector.connect("Driver={SQL Server Native Client 11.0};"</code></p><p id="f789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">Server=&lt;Server-name&gt;\&lt;Instance-name&gt;;"</code></p><p id="fb53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">"Database=&lt;Database-Name&gt;;"</code></p><p id="03d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">"Trusted_COnnection=yes;")</code></p><ul class=""><li id="8046" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">编写SQL查询将数据从数据库导入python</li></ul><p id="79fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">table = pd.read_sql_query('&lt;SQL Query&gt;',driver)</code></p><ul class=""><li id="bd3f" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">打印表格。</li></ul><p id="d9fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">print(table)</code></p><ul class=""><li id="ffdc" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">将表格存储到. csv格式的文件中。</li></ul><p id="dd8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">dfCSV = table.to_csv('&lt;Filename&gt;.csv',index=False)</code></p><ul class=""><li id="e7de" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">读取python中保存的<code class="du ku kv kw kx b">&lt;Filename&gt;.csv</code>文件。</li></ul><p id="aeb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ku kv kw kx b">pd.read_csv('&lt;Filename&gt;'.csv)</code></p><p id="a056" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如需示例代码文件，请点击此处的<a class="ae jd" href="https://github.com/VVRChilukoori/SQL-server-to-Python/tree/master/code-files" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ky"><img src="../Images/7e97cde71015ca9cb2e7634ca84db0d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*63nC_RHrFnaxSoMH.png"/></div></div></figure><p id="afdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://github.com/VVRChilukoori/SQL-server-to-Python/blob/master/code-files/Connecting%20to%20SQL%20Server%20database%20from%20python.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本</a>文件为脚本</p><div class="kz la ez fb lb lc"><a href="https://github.com/VVRChilukoori/SQL-server-to-Python/blob/master/code-files/Connecting%20to%20SQL%20Server%20database%20from%20python.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab dw"><div class="le ab lf cl cj lg"><h2 class="bd hj fi z dy lh ea eb li ed ef hh bi translated">VVRChilukoori/SQL-服务器到Python</h2><div class="lj l"><h3 class="bd b fi z dy lh ea eb li ed ef dx translated">permalink dissolve GitHub是4000多万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="lk l"><p class="bd b fp z dy lh ea eb li ed ef dx translated">github.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq jo lc"/></div></div></a></div></div></div>    
</body>
</html>