<html>
<head>
<title>A new Python module for Monte Carlo Simulations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于蒙特卡罗模拟的新Python模块</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-new-python-module-for-monte-carlo-simulations-7d0f1c0eaf96?source=collection_archive---------5-----------------------#2020-03-13">https://medium.com/analytics-vidhya/a-new-python-module-for-monte-carlo-simulations-7d0f1c0eaf96?source=collection_archive---------5-----------------------#2020-03-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="739a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一次我的一个朋友问我:“卡洛，我需要你的帮助，我需要对一些金融数据进行蒙特卡洛模拟，你能帮我用Python编码吗？”。</p><p id="5990" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想做的第一件事是谷歌一些关键世界，如“python-monte-carlo-module ”,并找到一个快速解决这个问题的方法。当我没有找到任何令人满意的东西时，我有点惊讶，所以我决定启动一个新模块，专门用于时间序列的蒙特卡罗模拟。</p><p id="783f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本模块包含三个类别:</p><ul class=""><li id="e5f0" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj"> AverageModel </strong>:这个类的设计目的是在九个不同的ARCH模型之间找到最合适的平均模型，基于Akaike信息标准(AIC)。</li><li id="f978" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj"> VolatilityModel </strong>:这个类帮助你在六个不同的GARCH模型中找到最合适的波动率模型，方法和前面的一样。</li><li id="c666" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">这是一个允许你模拟未来场景的类，让你决定模拟的次数和时间范围。它还根据给定的置信区间显示最佳和最差情景以及最差和最佳情景。</li></ul><p id="3086" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将特别讨论如何使用这个强大而快速的模块来运行您的数据，并在一眨眼的时间内获得出色的输出！</p><p id="5b35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想直接阅读更具综合性的文档，可以在这里找到:</p><p id="a0cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jr" href="https://www.slideshare.net/CarloParodi1/mcsimulation-documentation" rel="noopener ugc nofollow" target="_blank">https://www . slide share . net/Carlo parodi 1/MC simulation-documentation</a></p><p id="8d62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该首先在安装模块的提示中复制粘贴以下内容:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/5b2d4926e64185d8a0f161e376117a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*0QXMmzbUq3MNyh3iPLGwyw.png"/></div></figure><p id="e572" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装完这个库之后，您可以进入编辑器，导入我们简单讨论过的类，如下所示:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="b938" class="kf kg hi kb b fi kh ki l kj kk">from mc_simulation import AverageModel as am<br/>from mc_simulation import VolatilityModel as vm<br/>from mc_simulation import MonteCarloSimulation as mcs</span></pre><p id="7d87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们应该讨论一下你的数据了！它可以是xls或csv格式:这里所有的模块需要的是你有兴趣分析的列的名称！默认情况下，该列被命名为“Close ”,因为通常，在对金融时间序列建模时，我们指的是收盘价，而不是最低价、最高价或其他任何价格。但是您可以在输入中另外指定。因此，让我们这样定义一个名为“average_model”的变量:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="764c" class="kf kg hi kb b fi kh ki l kj kk">average_model = am(link = r'\THE\PATH\TO\YOUR\FILE\ACEA.csv', file_type = 'csv', column_name = 'Close', p_value = 0.98)</span></pre><p id="b1c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以粗体显示的是参数的名称，除了第一个，其他都是可选的。这意味着，如果没有指定，AverageModel将假定您所指示的文档是一个csv文件，并且列名是，如上所述，“Close”。</p><p id="1cd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，p_value为0.95，表示您稍后将要对每个模型的每个参数进行t检验的拒绝区域。</p><p id="ffbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是让我们按顺序进行吧！现在您有了AverageModel的一个实例，但什么也没发生，所以我们键入:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="1f45" class="kf kg hi kb b fi kh ki l kj kk">average_model.fit()</span></pre><p id="fcb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出没有在控制台中打印出来，但是现在我们已经初始化了一些有趣的字段:</p><ul class=""><li id="7fb1" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">平均_模型。<strong class="ih hj"> MeanModelsDict </strong>:该字段是一个字典，包含每个计算的ARMA模型的Akaike信息标准值、参数值、它们的t检验结果、协方差矩阵(按此顺序)。</li><li id="9b9e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">平均_模型。<strong class="ih hj"> bestModel </strong>:这是一个字符串，指定最佳拟合模型，基于赤池信息标准(AIC)。</li><li id="44d5" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">平均_模型。<strong class="ih hj"> MeanParamsDict </strong>:该字段包含最佳拟合模型的参数值。</li><li id="de95" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">平均_模型。<strong class="ih hj"> t_test_values </strong>:该字段包含最佳拟合模型参数的t检验结果。测试的p值是多少？默认为0.95，但你可以在输入中修改它，如前所示！</li></ul><p id="e605" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均_模型。<strong class="ih hj"> adf_result </strong>:这是增强Dikey-Fuller测试的值。如果您到达了这一点，这意味着测试已经被接受:在进行之前，事实上，您提供的时间序列需要结果协方差平稳，否则，模型评估的过程将被中断！</p><p id="9843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经有了平均模型，我们可以通过对其波动性建模来进一步分析数据！为此，我们使用类VolatilityModel:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="e980" class="kf kg hi kb b fi kh ki l kj kk">volatility_model = vm(average_model = average_model, errors_distribution = 'Normal', p_value = 0.98)</span></pre><p id="8571" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，我们强调了要提供的参数，但是只有第一个参数是必须提供的，以便创建一个VolatilityModel实例。换句话说，如果你想得到一个波动模型，你首先要得到一个平均模型！您可以指定误差分布，默认设置为“正态”，键入“t”表示t-Student，键入“ged”表示广义正态分布，键入“skewt”表示偏斜分布。p_value参数允许您决定GARCH模型每个参数的t-测试运行的拒绝区域。</p><p id="c19d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们找到最佳模型:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="8f39" class="kf kg hi kb b fi kh ki l kj kk">volatility_model.fit()</span></pre><p id="a636" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和以前一样，我们在编辑器上看不到任何结果，但是我们有一些有趣的字段需要注意:</p><ul class=""><li id="769c" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">波动率_模型。<strong class="ih hj"> VarianceModelsDict </strong>:该字段是一个字典，包含每个计算的GARCH模型的Akaike信息标准值、参数值及其t检验结果(按此顺序)。</li><li id="d8e1" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">波动率_模型。<strong class="ih hj"> bestVolatilityModel </strong>:这个字段是一个字符串，它指定了基于AIC标准的最佳模型。</li><li id="de04" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">波动率_模型。<strong class="ih hj"> VolatilityParamsDict </strong>:这里包含了最佳波动率模型的参数值。</li><li id="4ccb" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">波动率_模型。<strong class="ih hj"> t_test_values </strong>:这里你找到了最佳波动率模型的参数的t检验结果。</li></ul><h2 id="1a63" class="kf kg hi bd kl km kn ko kp kq kr ks kt iq ku kv kw iu kx ky kz iy la lb lc ld bi translated"><strong class="ak">最后，我们可以创建蒙特卡洛模拟！</strong></h2><p id="9a10" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">为了运行它们，我们需要一个波动性模型——我们刚刚创建了这个模型——为了得到它，我们需要一个平均模型，这是我们计算的第一件事。让我们开始吧:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="ca9e" class="kf kg hi kb b fi kh ki l kj kk">mc_sim = mcs(volatility_model = volatility_model, time_horizon = 750, number_simulations=150)</span></pre><p id="c7eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">唯一的强制参数是第一个参数(我们的波动率模型)，而time_horizon和number_simulations默认分别设置为100和50(只允许整数)。“时间范围”是指我们希望模拟的时间范围。例如，如果我们保留默认值“100”，并且数据是由日常观察组成的，就像在这种情况下，我们说我们希望看到在未来100天内可能会发生什么。</p><p id="a41b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们所说的“模拟次数”是指设置我们想要在这个时间序列上计算的模拟次数。请记住默认值，如果我们保持它们不变，我们将要运行的方法将计算50个不同的场景，每个场景由100个观察值组成。</p><p id="5ff0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看会发生什么:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="964b" class="kf kg hi kb b fi kh ki l kj kk">mc_sim.get_simulation()</span></pre><p id="862f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lj"><img src="../Images/3d7b8c1fb92f7fa265a95b89acd0ed24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vT1XBmTPELavTLtHgbShkA.png"/></div></div></figure><p id="fb4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太神奇了！假设我们希望看到所有这些场景的平均值。这个类提供了完美的方法:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="794b" class="kf kg hi kb b fi kh ki l kj kk">mc_sim.get_average_scenario()</span></pre><p id="d0d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lo"><img src="../Images/2253f15eee675384440ed5770857ce2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XMUAj2ZeBkWTTVBWzro8sw.png"/></div></div></figure><p id="b429" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您所注意到的，我们还有最后一个观察值。如果我们想看到极端的场景呢？为此，我们有另一个强大的方法:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="0ad3" class="kf kg hi kb b fi kh ki l kj kk">mc_sim.get_extreme_scenarios(criterion = 'returns_average')</span></pre><p id="5a4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参数“criterion”是可选的，默认情况下设置为“returns_average”。这意味着我们创建的150个场景按照它们的平均回报进行排序:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lo"><img src="../Images/d84f8c9794ebd76291c3d4e8f0addc25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vpX5jbV04h9o2ww9gJYSdQ.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">平均值总是显示出来，以便提供一个基准</figcaption></figure><p id="f184" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是您可以将标准设置为“last_obs”，在这种情况下，场景将按照其最后一次观察结果进行排序:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lt"><img src="../Images/67135aa177561f283efb519632f3a058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jjiIXpInTl8xpSP_Q_w2Q.png"/></div></div></figure><p id="8682" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想谈的最后一个方法，也许是最相关的，如下所示:</p><pre class="jt ju jv jw fd ka kb kc kd aw ke bi"><span id="1845" class="kf kg hi kb b fi kh ki l kj kk">mc_sim.get_confidence_scenarios(conf_interval = 0.95, criterion = 'returns_average')</span></pre><p id="8cba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个参数是强制的，它允许我们看到排在第95百分位的场景和排在第5百分位的相反场景。您可以将此参数设置为1到0.5(不包括)之间的任何浮点数。这对于计算未来某一天金融时间序列的风险值非常有用。第二个参数与前面讨论的完全相同，因此默认情况下设置为按平均回报对场景进行排序:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lu"><img src="../Images/e1d0c36ab3e7968e088fafdccfacb376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qV-7WxFUy8_crt7LkTj4mg.png"/></div></div></figure><p id="9bbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而这里是通过设置得到的结果:<strong class="ih hj">判据</strong> = 'last_obs '。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lu"><img src="../Images/993638b1db1455e81fe415ff00553aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MhjjqkY9Sicuk5uj_ve1eg.png"/></div></div></figure><p id="e78f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了！几行代码里有多少信息和图形！</p><p id="ae32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您有任何疑问，或者希望看到在下一版本中实现一些新功能，请不要犹豫，与我联系。干得好！</p></div></div>    
</body>
</html>