<html>
<head>
<title>Unit-Testing with Hive - File Based</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于配置单元文件的单元测试</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hive-unit-testing-md-6648c9f3b78?source=collection_archive---------17-----------------------#2019-12-27">https://medium.com/analytics-vidhya/hive-unit-testing-md-6648c9f3b78?source=collection_archive---------17-----------------------#2019-12-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/eaf0498bb5bfd9f2771a6c4f64cad198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jIuqR44MsfUxMh_rQnhntw.jpeg"/></div></div></figure><p id="fd78" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">测试对编码真的很重要。它让代码确实工作。这确实是一种节省时间的方法，而不是像人们认为的那样浪费时间。但是我绝对不会忽视单元测试是编码阶段中最困难的事情之一这一事实。如果是处理数据，那就更难了。许多人放弃了那个具有挑战性的阶段。如果你关心你所交付的工作的质量，并且确保你所交付的东西你认为是正常工作的，你就必须投入进去。犯错是这项工作的本质。这几乎与成为一名优秀的开发人员无关。一个好的开发者也会犯一些简单的错误。我们不是机器。但是，让我们成为糟糕的开发人员的不是使用机器来测试和确保我们的工作真正完成，我的意思是单元测试。让我们把它放在一边，因为这是一个应该在另一篇文章中讨论的话题。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="57fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我所说的，当你处理测试需求数据时，很难准备那些被称为已提供数据或初始数据的测试数据，有两种方法可以提供给你的单元测试。一种是我们称之为<strong class="is hj">的基于文件的</strong>，您可以在CSV文件中提供测试数据，另一种是更程序化的方式，您可以在Java中插入表格。在本文中，我们将研究基于文件的方法。</p><p id="8df0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使测试配置单元脚本成为可能的库叫做<a class="ae jv" href="https://github.com/klarna/HiveRunner" rel="noopener ugc nofollow" target="_blank">配置单元运行器</a>。这是一个由Klarna 构建并开源的库。它是一个零安装库，这意味着您只需导入一个java库并编写您的测试，不需要进一步集成任何东西。这意味着没有Hadoop，HDFS，蜂巢安装是必要的。</p><figure class="jw jx jy jz fd ij"><div class="bz dy l di"><div class="ka kb l"/></div></figure><p id="1e65" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们创建配置单元模式的脚本在<code class="du kc kd ke kf b">main/resources/hive/create</code>下</p><figure class="jw jx jy jz fd ij"><div class="bz dy l di"><div class="ka kb l"/></div></figure><figure class="jw jx jy jz fd ij"><div class="bz dy l di"><div class="ka kb l"/></div></figure><figure class="jw jx jy jz fd ij"><div class="bz dy l di"><div class="ka kb l"/></div></figure><p id="863f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如您可能猜到的那样，测试需要通过执行这些脚本来准备，以获得初步的表格。然后，我们将拥有生成<code class="du kc kd ke kf b">main/resources/hive/report</code>下的报告的转换脚本</p><figure class="jw jx jy jz fd ij"><div class="bz dy l di"><div class="ka kb l"/></div></figure><p id="4909" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并且测试数据文件在<code class="du kc kd ke kf b">test/resources/StudentCountReportTest/successCase1</code>下；</p><p id="4810" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> school.csv </strong></p><pre class="jw jx jy jz fd kg kf kh ki aw kj bi"><span id="e040" class="kk kl hi kf b fi km kn l ko kp">1,Cumhuriyet İlköğretim Okulu 2,Atatürk Lisesi 3,Samsun Anadolu Lisesi</span></pre><p id="0a7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> student.csv </strong></p><pre class="jw jx jy jz fd kg kf kh ki aw kj bi"><span id="a4e6" class="kk kl hi kf b fi km kn l ko kp">1,ali,yılmaz,21-09-1991,1 2,mehmet,yılmaz,22-07-1991,1 3,veli,kal,23-08-1990,1 4,şaban,yaşar,24-05-1990,1 5,ahmet,güngör,25-03-1990,1 6,seda,akyüz,26-07-1990,2 7,büşra,kilit,27-01-1990,2 8,ali,kıymık,28-06-1990,3 9,veysel,bolu,29-05-1990,3 10,ahmet,dal,21-09-1990,3</span></pre><p id="80c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在是时候编写我们的测试了；</p><figure class="jw jx jy jz fd ij"><div class="bz dy l di"><div class="ka kb l"/></div></figure><p id="2b3c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我来解释一下代码；<code class="du kc kd ke kf b">hiveShell</code>默认自动启动。如果你想在启动前设置一些变量，你需要在注释中设置<code class="du kc kd ke kf b">atuoStart</code>为假，在<code class="du kc kd ke kf b">setUp</code>中设置你的变量，然后手动启动hiveShell。我在这里不需要它。</p><ul class=""><li id="540e" class="kq kr hi is b it iu ix iy jb ks jf kt jj ku jn kv kw kx ky bi translated">首先，创建我们脚本中使用的数据库(<code class="du kc kd ke kf b">setUp</code>)。</li><li id="4969" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">执行创建脚本，并创建测试用例所需的所有表格(<code class="du kc kd ke kf b">setUp</code>)。</li><li id="f058" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">插入来自<code class="du kc kd ke kf b">school.csv</code>和<code class="du kc kd ke kf b">student.csv</code>文件(<code class="du kc kd ke kf b">testSuccessCase1</code>)的学校和学生测试数据</li><li id="f433" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">执行计算并填充<code class="du kc kd ke kf b">student_count_report</code>表的脚本(<code class="du kc kd ke kf b">testSuccessCase1</code>)。</li><li id="86a3" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">检索<code class="du kc kd ke kf b">student_count_report</code>结果集并断言它(<code class="du kc kd ke kf b">testSuccessCase1</code>)。</li></ul><p id="5cb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的测试数据文件里，有<strong class="is hj"> 10 </strong>个学生。<strong class="is hj"> 5名</strong>学生在<strong class="is hj">" cumhuriyet i̇lköğretim奥库卢"</strong>学校，<strong class="is hj"> 2名</strong>学生在<strong class="is hj"> "Atatürk Lisesi" </strong>学校，<strong class="is hj"> 3名</strong>学生在<strong class="is hj"> "Samsun Anadolu Lisesi" </strong>学校。你可以看到我的期望，你可以运行并看到这个测试将通过，希望:-)</p><p id="73b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在<a class="ae jv" href="https://github.com/javrasya/blog-examples/tree/master/hive/unittest" rel="noopener ugc nofollow" target="_blank">https://github . com/javrasya/blog-examples/tree/master/hive/unit test</a>查看并使用本文中的示例</p></div></div>    
</body>
</html>