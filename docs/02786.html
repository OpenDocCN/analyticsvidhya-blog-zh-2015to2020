<html>
<head>
<title>Vehicle (car) Detection in Real-Time and Recorded Videos in Python — Windows and macOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的实时车辆(汽车)检测和录制视频— Windows和macOS</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/vehicle-car-detection-in-real-time-and-recorded-videos-in-python-windows-and-macos-c5548b243b18?source=collection_archive---------5-----------------------#2020-01-02">https://medium.com/analytics-vidhya/vehicle-car-detection-in-real-time-and-recorded-videos-in-python-windows-and-macos-c5548b243b18?source=collection_archive---------5-----------------------#2020-01-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/154e7a7305498fd98726281f271c1517.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*jV4Tw_AG8fEqWC7rQzfOaA.gif"/></div><figcaption class="im in et er es io ip bd b be z dx translated">视频源—链接于此</figcaption></figure><p id="209c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">车辆检测是目前公司和组织广泛使用的功能之一。这项技术使用计算机视觉通过摄像机在视频或实时中检测不同类型的车辆。它在交通控制、汽车跟踪、创建停车传感器等许多方面都有应用。</p><p id="5195" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个项目中，我们将学习如何用python为录制的和直播的cam流视频构建一个汽车跟踪系统。</p><p id="0731" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在开始之前，我们需要安装OpenCV(开源计算机视觉)库，该库旨在帮助开发人员执行与计算机视觉相关的任务。我们需要为OpenCV库做一个pip安装。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e6e1" class="jx jy hi jt b fi jz ka l kb kc">install opencv-python</span></pre><h1 id="b377" class="kd jy hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">现在让我们用Python构建系统</strong></h1><p id="71d8" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">我们已经安装了所需的库。该技术的工作方式是，我们在要检测的对象(本例中为汽车)的各种图像参数上训练模型，用于识别我们目标中的对象。</p><p id="f795" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以把它想象成任何机器学习模型的训练和测试数据集。</p><p id="da4b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下:</p><p id="bde9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">训练数据集:</strong>。捕获目标对象图像细节的xml文件</p><p id="cd2e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">测试数据集:</strong>直播流视频/录制视频</p><p id="ba9e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完整代码的链接可以在本文末尾找到。我将分步分块地解释代码，以帮助您理解它是如何工作的:</p><p id="9d3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第一步:</strong>打开Spyder</p><p id="fce7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第二步:</strong>导入库</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="733b" class="jx jy hi jt b fi jz ka l kb kc">import cv2</span></pre><p id="f7c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤3: </strong>将输入引用到您的网络摄像头或保存在硬盘上的视频文件(mp4格式)</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="8efb" class="jx jy hi jt b fi jz ka l kb kc"><strong class="jt hj">Webcam: </strong>cap = cv2.VideoCapture(0)<br/><strong class="jt hj">Video: </strong>cap = cv2.VideoCapture(<strong class="jt hj">&lt;enter file path.mp4&gt;</strong>)</span></pre><p id="9455" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第4步:</strong>我们将使用一个预先训练好的。xml文件，其中包含使用单个图像构建的汽车数据。你可以在这里下载文件<a class="ae lf" href="https://github.com/chandravenky/Computer-Vision---Object-Detection-in-Python/tree/master/xml%20files" rel="noopener ugc nofollow" target="_blank"/></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d201" class="jx jy hi jt b fi jz ka l kb kc">car_cascade = cv2.CascadeClassifier(<strong class="jt hj">&lt;enter file path&gt;</strong>/cars.xml’)</span></pre><p id="284d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第五步:</strong>视频分帧，代码一次读取一帧。在每一帧中，我们使用上面导入的API来检测汽车在帧中的位置。对于检测到的每辆车，我们定位坐标并在它周围画一个矩形，然后向观众发布视频。</p><p id="c69f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完整的代码如下所示——代码下面有解释</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5cf3" class="jx jy hi jt b fi jz ka l kb kc">while True:<br/> # reads frames from a video<br/> ret, frames = cap.read()<br/> # convert to gray scale of each frames<br/> gray = cv2.cvtColor(frames, cv2.COLOR_BGR2GRAY)<br/> # Detects cars of different sizes in the input image<br/> cars = car_cascade.detectMultiScale( gray, 1.1, 1)<br/> # To draw a rectangle in each cars<br/> for (x,y,w,h) in cars:<br/> cv2.rectangle(frames,(x,y),(x+w,y+h),(0,0,255),2)<br/> font = cv2.FONT_HERSHEY_DUPLEX<br/> cv2.putText(frames, ‘Car’, (x + 6, y — 6), font, 0.5, (0, 0, 255), 1)<br/> # Display frames in a window<br/> cv2.imshow(‘Car Detection’, frames)<br/> # Wait for Enter key to stop<br/> if cv2.waitKey(33) == 13:<br/> break</span></pre><p id="bc31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">模块1: </strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="23f1" class="jx jy hi jt b fi jz ka l kb kc"># reads frames from a video<br/> ret, frames = cap.read()<br/> # convert to gray scale of each frames<br/> gray = cv2.cvtColor(frames, cv2.COLOR_BGR2GRAY)</span></pre><p id="71c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">视频是按单个帧读取的。接下来，帧被转换为灰度，这有助于快速检测汽车。图像转换为灰度的原因是，训练数据集是以灰度构建的，以减小文件的大小。</p><p id="977a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二区:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="dfd0" class="jx jy hi jt b fi jz ka l kb kc"># Detects cars of different sizes in the input image<br/> cars = car_cascade.detectMultiScale( gray, 1.1, 1)</span><span id="77ab" class="jx jy hi jt b fi lg ka l kb kc"> # To draw a rectangle in each cars<br/> for (x,y,w,h) in cars:<br/> cv2.rectangle(frames,(x,y),(x+w,y+h),(0,0,255),2)<br/> font = cv2.FONT_HERSHEY_DUPLEX<br/> cv2.putText(frames, ‘Car’, (x + 6, y — 6), font, 0.5, (0, 0, 255), <br/> 1)</span></pre><p id="29b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">代码的第一部分检测帧中的汽车，并存储它们的坐标(x、y轴以及汽车的宽度和高度)。第二部分围绕检测到汽车的区域绘制一个矩形，并在矩形上方显示文本“car”。您可以更改文本的字体，代码(0，0，255)是B-G-R序列中矩形和文本的颜色代码。</p><p id="9448" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第三块:</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1b78" class="jx jy hi jt b fi jz ka l kb kc"># Display frames in a window<br/> cv2.imshow(‘Car Detection’, frames)<br/># Wait for Enter key to stop<br/> if cv2.waitKey(33) == 13:<br/> break</span></pre><p id="5d29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果图像(帧)被释放给查看者，并且循环继续运行，直到用户按下键盘上的回车键。</p><p id="0d95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第六步:</strong>所有拍摄的视频必须发布。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="55b8" class="jx jy hi jt b fi jz ka l kb kc">cap.release()<br/>cv2.destroyAllWindows()</span></pre><h1 id="0bd2" class="kd jy hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">在命令行中运行程序</h1><p id="08c6" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">下一步是<a class="ae lf" rel="noopener" href="/@venkatesh.chandra_75550/saving-output-of-object-recognition-in-macos-opencv-python-5914bb5d9ca8">保存</a>文件。py格式并在命令行/Anaconda提示符下运行它。</p><p id="fe94" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在Anaconda提示符下运行它，首先使用命令cd导航到该文件夹。</p><p id="a326" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在Anaconda提示符下运行它，首先使用命令cd导航到该文件夹。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="baaa" class="jx jy hi jt b fi jz ka l kb kc">cd &lt;folder path&gt;</span></pre><p id="327a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行python文件</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="7360" class="jx jy hi jt b fi jz ka l kb kc">python filename.py</span></pre><p id="517e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您将看到一个弹出窗口，视频正在播放。视频可能会很慢，这是因为OpenCV中的帧数通常很大。但是，如果将视频保存在硬盘上，写入的视频速度并不慢，并且与输入视频的fps(每秒帧数)相匹配。</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="7383" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以在这里下载更多免费视频<a class="ae lf" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="3acc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">找到了！您已经成功地建立了一个实时和视频记录的汽车检测系统。</strong></p><p id="94e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">播放老爷车或概念车的视频，并在下面的评论区分享你的故事。</strong></p><p id="0c04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">面对问题？发布您的查询。</p><h1 id="f53e" class="kd jy hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">用例</strong></h1><ul class=""><li id="cb52" class="lj lk hi is b it la ix lb jb ll jf lm jj ln jn lo lp lq lr bi translated">停车场的传感器可以识别违规者</li><li id="5482" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">检测汽车的速度</li><li id="10c7" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">识别行人过马路时加速行驶的违规者</li></ul><h1 id="d0b5" class="kd jy hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">编码</h1><div class="lx ly ez fb lz ma"><a href="https://github.com/chandravenky/Computer-Vision---Object-Detection-in-Python/tree/master" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hj fi z dy mf ea eb mg ed ef hh bi translated">chandravenky/Python中的计算机视觉对象检测</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">github.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo ik ma"/></div></div></a></div><h1 id="320c" class="kd jy hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">相关链接</h1><p id="5e44" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated"><a class="ae lf" rel="noopener" href="/@venkatesh.chandra_75550/person-pedestrian-detection-in-real-time-and-recorded-videos-in-python-windows-and-macos-4c81142f5f59"> <strong class="is hj">使用OpenCV的Python中的行人检测— Windows和macOS </strong> </a></p><p id="c596" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae lf" rel="noopener" href="/@venkatesh.chandra_75550/real-time-webcam-face-detection-system-using-opencv-in-python-windows-and-macos-86c31fddd2bc"><strong class="is hj">Python中的实时人脸检测系统——Windows和macOS </strong> </a></p><p id="31b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae lf" rel="noopener" href="/@venkatesh.chandra_75550/face-detection-on-recorded-videos-using-opencv-in-python-windows-and-macos-407635c699"><strong class="is hj">Python中录制视频的人脸检测— Windows和macOS </strong> </a></p><p id="311a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae lf" rel="noopener" href="/@venkatesh.chandra_75550/saving-output-of-object-recognition-in-macos-opencv-python-5914bb5d9ca8"> <strong class="is hj">在macOS中保存物体识别输出</strong> </a></p><h1 id="da4c" class="kd jy hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">去哪里找我🤓</h1><ol class=""><li id="e833" class="lj lk hi is b it la ix lb jb ll jf lm jj ln jn mp lp lq lr bi translated">在<a class="ae lf" href="https://www.linkedin.com/in/venkateshchandra/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>/<a class="ae lf" href="https://github.com/chandravenky" rel="noopener ugc nofollow" target="_blank">GitHub</a>/<a class="ae lf" href="http://chatraja.com/" rel="noopener ugc nofollow" target="_blank">我的网站</a>上与我联系</li><li id="b89e" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn mp lp lq lr bi translated">感觉大方？在这里给我买杯<a class="ae lf" href="https://www.buymeacoffee.com/chandravenky" rel="noopener ugc nofollow" target="_blank">咖啡</a> ☕️</li></ol></div></div>    
</body>
</html>