<html>
<head>
<title>Feedback System using Facial Emotion Recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用面部情感识别的反馈系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/feedback-system-using-facial-emotion-recognition-e4554157a060?source=collection_archive---------16-----------------------#2020-12-19">https://medium.com/analytics-vidhya/feedback-system-using-facial-emotion-recognition-e4554157a060?source=collection_archive---------16-----------------------#2020-12-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/132fda54264cb0b609a50f03d5bbbce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0NNyDGuPZcnNexdIcNRyw.png"/></div></div></figure><h1 id="1665" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">简介:</strong></h1><blockquote class="jo jp jq"><p id="315c" class="jr js jt ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">反馈是现代教育的重要组成部分之一，它不仅有助于教师的成长，也有助于学生提出自己的观点，要求改进。通过对同一主题的用户调查，我们得到了一些截然不同的答案。由于各种原因，学生害怕给出诚实的反馈。因此，在做文献调查时，我们了解到反馈的范围是可以改变的，随着在线课程的进行，我们需要教师的实时反馈，因为在线课程提出了一个新的问题，即教师和学生之间的互动很少，所以所有这些研究都给我们带来了通过情绪检测进行反馈的想法。</p></blockquote><p id="acec" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">下面是如何实现一个基本的情绪检测系统的过程。</p><p id="70f4" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">项目可在 GitHub 获得，下面是<a class="ae kt" href="https://github.com/madhurchhajed/Facial-Emotion-Recognition" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hj">链接</strong> </a>。</p></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="86c7" class="iq ir hi bd is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn bi translated"><strong class="ak">目标:</strong></h1><ol class=""><li id="1cf2" class="lg lh hi ju b jv li jz lj kq lk kr ll ks lm kp ln lo lp lq bi translated">使用 Haar 级联正面 XML 文件检测人脸。</li><li id="7640" class="lg lh hi ju b jv lr jz ls kq lt kr lu ks lv kp ln lo lp lq bi translated">在 CK 数据集上训练卷积神经网络模型。</li></ol><p id="aa29" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">然后我们就可以用人脸检测部分来实现训练好的模型。</p><h1 id="d8ec" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">我们系统的流程:</h1><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/6fdccbae2f0ac651c81a3eda5e35d6c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*x5e6J-T1dOXxsF0Wrir7Sg.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">流程图</figcaption></figure><h1 id="9ab9" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">技术和工具实施于:</strong></h1><p id="a222" class="pw-post-body-paragraph jr js hi ju b jv li jx jy jz lj kb kc kq mf kf kg kr mg kj kk ks mh kn ko kp hb bi translated"><strong class="ju hj">操作系统:</strong></p><ol class=""><li id="b15d" class="lg lh hi ju b jv jw jz ka kq mi kr mj ks mk kp ln lo lp lq bi translated">Windows 10</li></ol><p id="da6f" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated"><strong class="ju hj">工具:</strong></p><ol class=""><li id="3b22" class="lg lh hi ju b jv jw jz ka kq mi kr mj ks mk kp ln lo lp lq bi translated">Jupyter 笔记本版本 6.1.5</li><li id="90c5" class="lg lh hi ju b jv lr jz ls kq lt kr lu ks lv kp ln lo lp lq bi translated">Python 3.7</li></ol><p id="3092" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated"><strong class="ju hj">库:</strong></p><ol class=""><li id="7d55" class="lg lh hi ju b jv jw jz ka kq mi kr mj ks mk kp ln lo lp lq bi translated">开放式 CV 版本 4.4.0.44</li><li id="6790" class="lg lh hi ju b jv lr jz ls kq lt kr lu ks lv kp ln lo lp lq bi translated">熊猫 0.23.0 版</li><li id="7477" class="lg lh hi ju b jv lr jz ls kq lt kr lu ks lv kp ln lo lp lq bi translated">Numpy 版本 1.18.2</li><li id="9775" class="lg lh hi ju b jv lr jz ls kq lt kr lu ks lv kp ln lo lp lq bi translated">Matplotlib 版本 3.2.1</li><li id="b46c" class="lg lh hi ju b jv lr jz ls kq lt kr lu ks lv kp ln lo lp lq bi translated">TensorFlow 版本 2.3.1</li><li id="80a6" class="lg lh hi ju b jv lr jz ls kq lt kr lu ks lv kp ln lo lp lq bi translated">简易图形用户界面版本 0.98.1</li></ol></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="b003" class="iq ir hi bd is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn bi translated"><strong class="ak">第 1 部分:从网络摄像头直播中检测人脸</strong></h1><p id="f13e" class="pw-post-body-paragraph jr js hi ju b jv li jx jy jz lj kb kc kq mf kf kg kr mg kj kk ks mh kn ko kp hb bi translated">首先你要在 opencv GitHub 下载<a class="ae kt" href="https://github.com/opencv/opencv/tree/master/data/haarcascades" rel="noopener ugc nofollow" target="_blank"><em class="jt">Haar cascode _ frontal face _ default . XML</em></a><em class="jt"/>。这里是完整的 Python 代码，关于如何使用网络摄像头实时检测人脸<em class="jt"> : </em></p><pre class="lx ly lz ma fd ml mm mn mo aw mp bi"><span id="f231" class="mq ir hi mm b fi mr ms l mt mu">import pandas as pd<br/>import numpy as np<br/>import cv2</span><span id="9dcc" class="mq ir hi mm b fi mv ms l mt mu">face_cascade = cv2.CascadeClassifier(cv2.data.haarcascades + 'haarcascade_frontalface_default.xml')</span><span id="de8f" class="mq ir hi mm b fi mv ms l mt mu">cap = cv2.VideoCapture(0, cv2.CAP_DSHOW)</span><span id="ead7" class="mq ir hi mm b fi mv ms l mt mu">while cap.isOpened():<br/>    ret, frame = cap.read()<br/>    if ret:</span><span id="6463" class="mq ir hi mm b fi mv ms l mt mu">frame = cv2.flip(frame, 1)<br/>        gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)<br/>        # print('frame shape', frame.shape)</span><span id="9371" class="mq ir hi mm b fi mv ms l mt mu">faces = face_cascade.detectMultiScale(gray, 1.1, 4)</span><span id="4ad8" class="mq ir hi mm b fi mv ms l mt mu">for (x, y, w, h) in faces:<br/>            cv2.rectangle(gray, (x, y), (x + w, y + h), (255, 0, 0), 2)</span><span id="6bcd" class="mq ir hi mm b fi mv ms l mt mu">cv2.imshow('frame', gray)</span><span id="dd2f" class="mq ir hi mm b fi mv ms l mt mu">if cv2.waitKey(1) == 27:  # press ESC to break<br/>            break</span><span id="fd47" class="mq ir hi mm b fi mv ms l mt mu">else:<br/>        break</span><span id="56aa" class="mq ir hi mm b fi mv ms l mt mu">cap.release()<br/>cv2.destroyAllWindows()<br/></span></pre></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="f021" class="iq ir hi bd is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn bi translated">第 2 部分:训练 CNN 模型</h1><p id="ac99" class="pw-post-body-paragraph jr js hi ju b jv li jx jy jz lj kb kc kq mf kf kg kr mg kj kk ks mh kn ko kp hb bi translated">人脸检测已经完成，现在我们可以训练我们的模型来检测情绪。</p><h1 id="237a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">关于数据集:CK 加</strong></h1><p id="335d" class="pw-post-body-paragraph jr js hi ju b jv li jx jy jz lj kb kc kq mf kf kg kr mg kj kk ks mh kn ko kp hb bi translated">CK plus 是具有 7 类情绪的数据集，即愤怒、蔑视、厌恶、恐惧、快乐、悲伤和惊讶。数据大小约为 3.8MB。可通过 Kaggle 上的<a class="ae kt" href="https://www.kaggle.com/shawon10/ckplus" rel="noopener ugc nofollow" target="_blank">链接</a>获得数据集的链接。</p><h1 id="1e82" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">训练 CNN 模型:</h1><p id="b942" class="pw-post-body-paragraph jr js hi ju b jv li jx jy jz lj kb kc kq mf kf kg kr mg kj kk ks mh kn ko kp hb bi translated">在这里，我们可以使用上面提到的数据集训练我们自己的 CNN 网络。我们可以在这里训练我们的模型，并保存模型以便以后集成它。</p><p id="c4d2" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">要访问用于训练模型的<strong class="ju hj"> jupyter 笔记本</strong>点击此<a class="ae kt" href="https://github.com/madhurchhajed/Facial-Emotion-Recognition/blob/main/model_training.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hj">链接</strong> </a>。</p><p id="e871" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">训练好的<strong class="ju hj">模型</strong>也可以通过这个<a class="ae kt" href="https://github.com/madhurchhajed/Facial-Emotion-Recognition" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hj">链接</strong> </a> (model.h5 文件)直接使用。</p></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="a74d" class="iq ir hi bd is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn bi translated">测试:</h1><p id="f96e" class="pw-post-body-paragraph jr js hi ju b jv li jx jy jz lj kb kc kq mf kf kg kr mg kj kk ks mh kn ko kp hb bi translated">运行最终的 python 文件。</p><ol class=""><li id="c296" class="lg lh hi ju b jv jw jz ka kq mi kr mj ks mk kp ln lo lp lq bi translated">从可用选项中选择:</li></ol><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/6f29b32e91554d2b58d30ed4b22d3226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2WN1asZXahAD7SH04Pi2DQ.jpeg"/></div></div></figure><p id="a2f9" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">2.选择<strong class="ju hj">实时反馈</strong>选项时，网络摄像头将用于记录您的面部表情。如果您选择<strong class="ju hj">图像或视频</strong>选项，将会打开一个窗口来选择文件。</p><p id="c830" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">3.如果是视频，它将逐帧读取，直到视频结束，如果是摄像头，我们必须终止记录。</p><p id="3ea3" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">4.程序终止后，可以看到记录的情绪的饼状图输出。</p><figure class="lx ly lz ma fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/554d890de4c1ea4f6fe04a45d633052d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MEEwmaZLth20H53AWP6K1A.jpeg"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">图像输出</figcaption></figure><figure class="lx ly lz ma fd ij er es paragraph-image"><div class="er es my"><img src="../Images/72cfbe6720f8d3754877cd2ad2688064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*EsVDh2q-m7i0vq0fyJNbEA.jpeg"/></div><figcaption class="mb mc et er es md me bd b be z dx translated">视频输出</figcaption></figure></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="59fc" class="iq ir hi bd is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn bi translated"><strong class="ak">结论:</strong></h1><p id="8c8c" class="pw-post-body-paragraph jr js hi ju b jv li jx jy jz lj kb kc kq mf kf kg kr mg kj kk ks mh kn ko kp hb bi translated">在这个尖端技术的时代，没有自动化是无法想象的。某人想象的第一件事:除了逻辑推理，任何计算机如何可视化他们附近的事物，这回答了那种想象。这个项目的各种应用可以是普通公众所拥有的安全威胁，在旅馆、餐馆和其他盈利企业接收来自顾客的反馈。它也可用于改进算法。</p><p id="86fd" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">该项目可在 GitHub 上的<a class="ae kt" href="https://github.com/madhurchhajed/Facial-Emotion-Recognition" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hj">链接</strong> </a>获得。</p><p id="490f" class="pw-post-body-paragraph jr js hi ju b jv jw jx jy jz ka kb kc kq ke kf kg kr ki kj kk ks km kn ko kp hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>