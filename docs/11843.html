<html>
<head>
<title>Intro to Machine Learning in Python: Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的机器学习简介:第二部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/intro-to-machine-learning-in-python-part-ii-d91adb74324f?source=collection_archive---------27-----------------------#2020-12-20">https://medium.com/analytics-vidhya/intro-to-machine-learning-in-python-part-ii-d91adb74324f?source=collection_archive---------27-----------------------#2020-12-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/645fca0648b3fef36a3de79bbca3f954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1-o3rqvGjfMcPCk9WHHtg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><div class=""/></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="2075" class="jb jc hx bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">目录</h1><ol class=""><li id="0b22" class="jz ka hx kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">机器学习摘要</li><li id="990e" class="jz ka hx kb b kc kr ke ks kg kt ki ku kk kv km kn ko kp kq bi translated">拆分数据</li><li id="5689" class="jz ka hx kb b kc kr ke ks kg kt ki ku kk kv km kn ko kp kq bi translated">培训和测试数据</li><li id="ee4b" class="jz ka hx kb b kc kr ke ks kg kt ki ku kk kv km kn ko kp kq bi translated">创建和训练模型</li><li id="744a" class="jz ka hx kb b kc kr ke ks kg kt ki ku kk kv km kn ko kp kq bi translated">专心致志的</li></ol><p id="e6a1" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">在《Python中的机器学习导论:第一部分》中，我们讨论了什么是线性回归，如何分析我们拥有的数据，然后如何绘制一些可视化图形，让我们更好地理解数据及其相关性。在这篇文章中，我们将讨论什么是机器学习，以及如何分割、训练、测试数据并拟合我们的模型。让我们开始吧！</p><h1 id="7caa" class="jb jc hx bd jd je ln jg jh ji lo jk jl jm lp jo jp jq lq js jt ju lr jw jx jy bi translated">机器学习摘要</h1><p id="8db8" class="pw-post-body-paragraph kw kx hx kb b kc kd kz la ke kf lc ld kg ls lf lg ki lt li lj kk lu ll lm km hb bi translated">简单地总结一下机器学习，你可以说我们给AI提供了大量的数据，它使用统计数据根据我们给它的数据做出预测。这是通过我们在第一篇文章中讨论的各种算法实现的。机器学习以各种不同的方式使用，其中一个例子是赌博网站使用机器学习模型来设置不同赌注的界限，使它们尽可能准确。</p><p id="6b0b" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">机器学习的步骤通常是首先收集数据，清理数据，将大部分数据放入训练数据中，然后将其余数据放入测试数据中，从那里我们进入模型测试，最后将模型部署到现实世界的应用程序中。看起来像这样:</p><figure class="lw lx ly lz fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lv"><img src="../Images/63f3046a6a5f4c611ab1c4d5fc782f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyAvIC1xJzonKtgTG3JuEQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><p id="1b52" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">既然我们对什么是机器学习有了一个概念，我们就可以进入如何做线性回归的第一步，即拆分数据。</p><h1 id="5000" class="jb jc hx bd jd je ln jg jh ji lo jk jl jm lp jo jp jq lq js jt ju lr jw jx jy bi translated">拆分数据</h1><p id="ee11" class="pw-post-body-paragraph kw kx hx kb b kc kd kz la ke kf lc ld kg ls lf lg ki lt li lj kk lu ll lm km hb bi translated">正如我在第一部分中提到的，我正在Python中使用scikit-learn包。因此，为了能够分割数据，我们需要首先将数据设置为x和y数组。y数组将包含我们试图预测的内容，而x数组将包含我们数据框中的所有其他非文本数据。线性回归不适用于文本数据，除非是自然语言处理，这是我希望在机器学习之后进入的领域。您可能想很好地查看所有的列名，所以为了方便起见，我调用了一个排序列表来查看所有的列名。要在代码中完成所有这些工作，代码应该是这样的:</p><pre class="lw lx ly lz fd ma mb mc md aw me bi"><span id="6d96" class="mf jc hx mb b fi mg mh l mi mj">sorted(df)<br/><br/>y=df['ColName']<br/>X=df['ColName','ColName','ColName','ColName']</span></pre><p id="7ecf" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">既然我们已经将数据分成了适当的数组，我们就可以开始训练和测试我们的数据了。</p><h1 id="7427" class="jb jc hx bd jd je ln jg jh ji lo jk jl jm lp jo jp jq lq js jt ju lr jw jx jy bi translated">培训和测试数据</h1><p id="da5e" class="pw-post-body-paragraph kw kx hx kb b kc kd kz la ke kf lc ld kg ls lf lg ki lt li lj kk lu ll lm km hb bi translated">训练和测试我们的数据非常简单，我们只需要从scikit学习包中导入train_test_split方法。完成此操作后，我们将测试和训练如下所示的数据:</p><pre class="lw lx ly lz fd ma mb mc md aw me bi"><span id="d0f0" class="mf jc hx mb b fi mg mh l mi mj">from sklearn.model_selection import train_test_split<br/><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)</span></pre><p id="4a03" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">这是为了确保我们同时训练和测试x和y数组中的数据。test_size参数是放入测试数据的数据量。通常，30%用于测试数据，70%用于训练数据，但这可能会因模型而异。为了更清楚起见，例如在上面的代码中，我们给出了1.0中的0.3，这意味着0.7将进入训练数据。random_state参数是我们的数据中随机分裂的数量。</p><p id="7497" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">我们现在已经成功拆分了数据，然后对其进行了训练和测试。下一步是开始训练我们的模型！</p><h1 id="fdf9" class="jb jc hx bd jd je ln jg jh ji lo jk jl jm lp jo jp jq lq js jt ju lr jw jx jy bi translated">创建和训练模型</h1><p id="43e4" class="pw-post-body-paragraph kw kx hx kb b kc kd kz la ke kf lc ld kg ls lf lg ki lt li lj kk lu ll lm km hb bi translated">为了创建和训练模型，我们将:</p><ul class=""><li id="b5ac" class="jz ka hx kb b kc ky ke lb kg mk ki ml kk mm km mn ko kp kq bi translated">从sklearn导入线性回归</li><li id="fe3a" class="jz ka hx kb b kc kr ke ks kg kt ki ku kk kv km mn ko kp kq bi translated">将线性回归转换为lm，以便于我们调用</li><li id="420a" class="jz ka hx kb b kc kr ke ks kg kt ki ku kk kv km mn ko kp kq bi translated">拟合模型，同时将我们的训练数据传递给它</li></ul><p id="4ce0" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">执行这些任务时，代码将如下所示:</p><pre class="lw lx ly lz fd ma mb mc md aw me bi"><span id="75ef" class="mf jc hx mb b fi mg mh l mi mj">from sklearn.linear_model import LinearRegression<br/><br/>lm = LinearRegression()<br/><br/>lm.fit(X_train,y_train)</span></pre><p id="86a7" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">拟合模型所做的是，我们给模型提供数据，以便它明确地知道它正在处理的内容和要使用的工具。拟合后，它显示了机器学习算法的估计器参数以及它们的设置。这些可以被改变来微调你正在制作的模型。如果您想真正微调您的模型或了解更多关于线性回归的深度，这个<a class="ae mo" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener ugc nofollow" target="_blank">链接</a>将带您到scikit-learn的线性回归文档。</p><h1 id="3e37" class="jb jc hx bd jd je ln jg jh ji lo jk jl jm lp jo jp jq lq js jt ju lr jw jx jy bi translated">专心致志的</h1><p id="3028" class="pw-post-body-paragraph kw kx hx kb b kc kd kz la ke kf lc ld kg ls lf lg ki lt li lj kk lu ll lm km hb bi translated">恭喜你。我们现在已经完成了创建线性回归模型的所有框架！复习我们所学的内容:什么是机器学习，如何分割训练和测试数据，以及如何创建和拟合线性回归模型！现在我们已经创建了我们的模型，我们需要分析和评估我们创建的模型，这将在本系列的第三部分中分享！</p><p id="6b77" class="pw-post-body-paragraph kw kx hx kb b kc ky kz la ke lb lc ld kg le lf lg ki lh li lj kk lk ll lm km hb bi translated">感谢你抽出时间来阅读这篇文章，如果你喜欢它，请给我一个赞或评论，告诉我你喜欢或不喜欢什么，或者有任何问题或话题，你可能想听听接下来的内容！</p></div></div>    
</body>
</html>