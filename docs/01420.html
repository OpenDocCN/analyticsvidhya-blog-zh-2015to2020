<html>
<head>
<title>Predict the Click-Through Rate for Keywords Using Machine Learning Methodologies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习方法预测关键词的点击率</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predict-the-click-through-rate-for-keywords-using-machine-learning-methodologies-37883ae41189?source=collection_archive---------8-----------------------#2019-10-21">https://medium.com/analytics-vidhya/predict-the-click-through-rate-for-keywords-using-machine-learning-methodologies-37883ae41189?source=collection_archive---------8-----------------------#2019-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/7e7ad6482e0e4e55e26d3187903fb5f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gmwlXIH0S16m4Pn2"/></div></figure><p id="2340" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇文章中，我想讨论一下我最近完成的一项数据科学任务。首先，我将解释问题描述、目标和数据集。此外，完成数据的可视化，并选择重要的特征来训练机器学习模型。</p><p id="1ea8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">问题描述:</strong></p><p id="7ad2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一家广告公司代表他们的客户销售在搜索引擎中购买关键词的服务。他们试图优化他们的关键字和资金分配。最佳解决方案的第一步是通过关键词和基金来预测业绩。</p><p id="c428" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">目标:</strong></p><p id="dab9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">预测任何关键字(不一定是数据集文件中的关键字)、CPC和市场(美国/英国)网站将收到的流量(即点击)。</p><p id="b794" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">数据集描述:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jk"><img src="../Images/4c64df16f4826e6406ef3319c8decdb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5yws2Zc9Ztt8p7PEuyF4A.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">数据集中属性的描述</figcaption></figure><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="398a" class="kc kd hi jy b fi ke kf l kg kh"># importing necessary libraries<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline</span><span id="7b98" class="kc kd hi jy b fi ki kf l kg kh">from sklearn.model_selection import train_test_split<br/>from nltk.tokenize import word_tokenize<br/>from nltk.corpus import stopwords<br/>import re<br/>import nltk<br/>nltk.download('stopwords')</span></pre><p id="ecec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">读取数据集，按“日期”属性排序。</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="4859" class="kc kd hi jy b fi ke kf l kg kh">df = pd.read_csv('Dataset.csv')<br/>df.sort_values(by='Date',inplace=True)<br/>df.head()</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kj"><img src="../Images/9cab5cbc7396f78de19446b9d4918c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*StaA9p2kXZr8RTNvZo-CVA.png"/></div></div></figure><p id="bcb1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最初，我使用<strong class="io hj">描述方法</strong>对非缺失值、平均值、标准偏差、范围、中值、0.25和0.75四分位数的数量有直观的了解。</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="869c" class="kc kd hi jy b fi ke kf l kg kh">data.describe()</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kk"><img src="../Images/48a6d55f5867eb4cb442ea646e391205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zzEx_u3s96svXchnaHN-OQ.png"/></div></div></figure><p id="9466" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在将日期属性转换为日期时间格式(YYYY-MM-DD ),以提取年、月、星期几、年中的某一天等特征。</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="bb3c" class="kc kd hi jy b fi ke kf l kg kh">data[‘Date’] = data[‘Date’].apply(lambda x: pd.to_datetime(str(x), format=’%Y%m%d’, errors=’ignore’))</span><span id="1d57" class="kc kd hi jy b fi ki kf l kg kh">date_data = data['Date']</span><span id="6fc2" class="kc kd hi jy b fi ki kf l kg kh">date = pd.DataFrame({'year':date_data.dt.year,<br/>                     'month':date_data.dt.month,<br/>                    'week':date_data.dt.week,<br/>                    'dayofweek':date_data.dt.dayofweek, <br/>                    'dayofyear':date_data.dt.dayofyear})</span></pre><p id="4a3f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">分类变量被转换成虚拟变量</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="3460" class="kc kd hi jy b fi ke kf l kg kh">Market = pd.get_dummies(data['Market'],drop_first=True)<br/>train_data = pd.concat([date,Market,data],axis=1)<br/>train_data.drop(['Date','Market'],axis=1,inplace=True)</span></pre><p id="98ef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我绘制了每个独立特征的<strong class="io hj">直方图</strong>来得到每个特征的分布。据观察，与其他数字相比，点击次数= '0 '更多。此外，2012年的点击量比2013年多。此外，按月份来看，大多数点击发生在8月至12月。如果我们看看一周中的某一天，最高点击率出现在星期二。大多数点击来自美国市场。</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="ef77" class="kc kd hi jy b fi ke kf l kg kh">train_data.hist(figsize=(15, 15), bins=50, xlabelsize=8, ylabelsize=8)</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kl"><img src="../Images/58a35c979c73431da629238734284c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJCrBeoxsm5LXoMdtU1ewQ.png"/></div></div></figure><p id="d186" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，为了确定数字特征的重要性，我绘制了目标变量='clicks '和所有其他特征之间的配对图。观察到诸如成本、印象、CTR、CPC、星期、一年中的某一天之类的特征与目标变量具有某种线性关系。</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="efa6" class="kc kd hi jy b fi ke kf l kg kh">for i in range(0, len(train_data.columns), 5):<br/>    sns.pairplot(data=train_data,<br/>                x_vars=train_data.columns[i:i+5],<br/>                y_vars=['Clicks'])</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es km"><img src="../Images/af2df33b75434b13d034de674f467a1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TG5Ere-pEfgXO8TGVrXcDA.png"/></div></div></figure><p id="af17" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了进一步验证重要特征，我用热图绘制了一个相关矩阵。据观察，只有两个特征印象和成本与目标变量高度相关。我们还可以在绘制的热图中看到强烈的负相关性。</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="f338" class="kc kd hi jy b fi ke kf l kg kh">corrmat = train_data.corr()<br/>top_corr_features = corrmat.index<br/>plt.figure(figsize=(8,8))<br/>#plot heat map<br/>g=sns.heatmap(train_data[top_corr_features].corr(),annot=True,cmap=”RdYlGn”)</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/caaac7db9c08b684ba49954680c41a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*HMtLmwi2W4TCW4LikU_b_A.png"/></div></figure></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="0299" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">对关键词进行了文本预处理/清理:</strong></p><p id="d012" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最初，所有的数字、标点符号、符号都使用正则表达式从关键字中删除。然后关键字被小写化和标记化。对关键字进行标记后，使用NLTK停用词删除停用词。</p><p id="5739" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">对清理后的关键词进行文字嵌入:</strong></p><p id="e573" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">清理数据后，为了训练机器学习模型，需要将关键字中的每个单词转换为单词向量，因为算法无法处理原始形式的纯文本或字符串。单词嵌入是捕获单词的语义和上下文信息的向量。在这里，我使用了一个基于Fasttext的单词嵌入，它为关键字中的每个单词提供了300维的向量。因此，为了生成完整关键字的单个向量，取关键字中每个词向量的平均值。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="af84" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在给定的问题中，当给定日期、市场、关键字和CPC的特征时，点击数是要由训练的模型预测的目标变量。由于点击次数具有正的连续值，我将该问题建模为回归问题。数据中存在许多“Nan”值，这些值被删除，而不是对数据进行一些插补并替换Nan值。因为我们所有的功能都是一些特定的关键字，所以我们不确定这些关键字有多少点击，印象或成本。同样，由于数据是巨大的，即使我们丢弃这些较少的数据也不会有影响。现在，因为搜索关键字的日期可能具有重要的特征，所以我从附加到数据的日期中提取了像年、月、周、星期和年这样的特征。分类值被转换成虚拟变量。</p><p id="bc96" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">根据问题陈述，提到了在2013年2月14日给定每个市场(美国/英国)的关键词和点击费用，模型必须预测点击次数。所以我用两组不同的特征来模拟这个问题:</p><p id="8817" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">a) X =关键词、市场和cpc</p><p id="6e14" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">b) X =年、月、周、周、年、关键词、市场和cpc</p><p id="87e2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">目标变量被设置为Y =点击次数。</p><p id="7051" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我使用了经典的机器学习和深度学习模型，如随机森林回归<strong class="io hj">，Xgboost回归，1D-CNN和GRU </strong>模型来训练和评估给定的数据。给定的数据通过按日期排序被分成训练和测试数据。2012年的所有数据作为训练数据，2013年的所有数据作为测试数据。</p><p id="70db" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这些代码可以在我的GitHub个人资料中找到:<a class="ae kv" href="https://github.com/Vyshnavmt94/Predict-the-Click-Through-Rate-for-Keywords-Using-Machine-Learning-Methodologies" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/vyshnavmt 94/Predict-the-Click-Through-Rate for-Keywords-Using-Machine-Learning-Methodologies</a></p><p id="a11f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">成绩:</strong></p><p id="5197" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">a) X =关键词、市场和cpc</p><p id="9d35" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">随机森林回归:</strong></p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="e1e2" class="kc kd hi jy b fi ke kf l kg kh">Coefficient of determination R² of the prediction: 0.914177804049537</span><span id="0a5d" class="kc kd hi jy b fi ki kf l kg kh">Mean squared error: 297606.09</span><span id="c363" class="kc kd hi jy b fi ki kf l kg kh">Test Variance score: 0.80</span><span id="feae" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 74.95</span></pre><p id="d51a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> XGboost回归:</strong></p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="088d" class="kc kd hi jy b fi ke kf l kg kh">Coefficient of determination R^2 of the prediction.  0.5800091699348091</span><span id="e7a7" class="kc kd hi jy b fi ki kf l kg kh">Mean squared error: 393330.94</span><span id="653b" class="kc kd hi jy b fi ki kf l kg kh">Test Variance score: 0.74</span><span id="621a" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 213.09</span></pre><p id="bb89" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 1-DCNN: (70个时期)</strong></p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="b06b" class="kc kd hi jy b fi ke kf l kg kh">Mean squared error: 183220.71</span><span id="802c" class="kc kd hi jy b fi ki kf l kg kh">Test Variance score: 0.88</span><span id="9cda" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 61.83</span></pre><p id="a4db" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> GRU: (20个纪元)</strong></p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="bad5" class="kc kd hi jy b fi ke kf l kg kh">Mean squared error: 125502.27</span><span id="6f34" class="kc kd hi jy b fi ki kf l kg kh">R2 score: 0.92</span><span id="ca85" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 70.50</span></pre><p id="2d8b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">b) X =年、月、周、周、年、关键词、市场和cpc</p><p id="a73f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">随机森林回归:</strong></p><p id="dafd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">预测的决定系数R。: 0.9976723650491951</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="94ee" class="kc kd hi jy b fi ke kf l kg kh">Mean squared error: 1008241.56</span><span id="cc64" class="kc kd hi jy b fi ki kf l kg kh">Test Variance score: 0.33</span><span id="90b1" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 175.60</span></pre><p id="5365" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> XGboost回归:</strong></p><p id="830e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">预测的决定系数R。: 0.6653407930753578</p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="07f5" class="kc kd hi jy b fi ke kf l kg kh">Mean squared error: 519430.67</span><span id="365f" class="kc kd hi jy b fi ki kf l kg kh">Test Variance score: 0.65</span><span id="f12e" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 224.09</span></pre><p id="5194" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 1-DCNN: (30个时期)</strong></p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="4e6c" class="kc kd hi jy b fi ke kf l kg kh">Mean squared error: 9360270.80</span><span id="ef93" class="kc kd hi jy b fi ki kf l kg kh">R2 score: -5.25</span><span id="c41e" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 2336.26</span></pre><p id="1599" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> GRU: (30个纪元)</strong></p><pre class="jl jm jn jo fd jx jy jz ka aw kb bi"><span id="e5c3" class="kc kd hi jy b fi ke kf l kg kh">Mean squared error: 1535167.11</span><span id="0579" class="kc kd hi jy b fi ki kf l kg kh">R2 score: -0.02</span><span id="1df8" class="kc kd hi jy b fi ki kf l kg kh">mean_absolute_error: 193.50</span></pre><p id="036d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我希望这篇文章有助于理解数据的可视化，以提取最佳特征并训练机器学习模型。</p></div></div>    
</body>
</html>