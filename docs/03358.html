<html>
<head>
<title>Computer Vision Series: Histogram Equalization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉系列:直方图均衡化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/computer-vision-series-histogram-equalization-87d1369ef183?source=collection_archive---------17-----------------------#2020-01-27">https://medium.com/analytics-vidhya/computer-vision-series-histogram-equalization-87d1369ef183?source=collection_archive---------17-----------------------#2020-01-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="70c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阅读这篇文章的一些人已经在Instagram上发布了几张图片，并使用内置工具来增加/减少亮度、对比度、伽玛等。让你无聊的镜头变得更漂亮，更细致，更吸引人。我做了几次，我问自己计算机是如何做到的。在这篇文章中，我将讨论图像对比，并展示百万分之一的方法。</p><p id="69e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看下面的图片</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a1d7c2809c5bb106b937bf958087912c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2gam-B6lyiw7giuUkN3w7Q.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">一对低对比度和高对比度图像</figcaption></figure><p id="a5ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在左图中，你可以看到一座红棕色的砖房、树木和雪。而且看起来又无聊又悲伤。在右图中，颜色看起来更亮？颜色看起来更亮，因为它们的对比度更高，所以图像看起来更有吸引力。文献说的够多了，我们来深入挖掘一下。</p><h1 id="0aac" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">直方图:是什么？</h1><p id="8263" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在计算机视觉中，每幅图像都由像素组成，每种颜色的像素范围从0到255 (0最暗，255最亮)。图像的颜色模式是RGB(例如，Reg-Green-Blue的3个颜色通道)。为了对图像进行统计研究，科学家绘制了一个图表来表示颜色频率，x轴是从0到255的颜色范围，y轴是一种颜色的像素数量。代表色频的图形称为<strong class="ih hj">直方图</strong>。让我们看看下面的样本图像及其直方图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/7f4e8e365e3042bba15f69683e0d06db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYIIT4Wxt1nhgziUv4Kcnw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">样本图像及其对应的直方图</figcaption></figure><p id="1a08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">样本图像是低对比度的，因为图像的细节在颜色方面彼此没有明显的不同。通过绘制图像的直方图，您可以清楚地看到代表样本像素的红色柱彼此靠近。这一观察表明，在灰度通道中只有100种颜色。换句话说，这个观察暗示了低对比度图像。</p><p id="97d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">增强图像对比度的一千种方法之一是拉伸直方图，使像素列之间的距离更远。拉伸图像直方图的一种方法是直方图均衡化。</strong></p><h1 id="b98c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">直方图均衡</h1><p id="0925" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">是一种数学技术，通过寻找累积的归一化直方图来拉伸图像直方图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/d50a621f0fc36763611b2420788e938d.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*NqoNWnO4TMjLpGgawjRngg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">计算每种颜色的累积归一化直方图的公式</figcaption></figure><p id="ca17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">执行直方图均衡的步骤:</strong></p><ul class=""><li id="6b6a" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">构建直方图，可以通过将像素颜色的频率映射到字典来完成，关键字是颜色，值是属于颜色的像素。</li><li id="0cdb" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">通过为下一个颜色频率添加上一个颜色频率来构建累积直方图(CH ),依此类推。<em class="lm"> f(i) </em>是累积直方图。</li><li id="b0a5" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">通过将CH乘以系数来计算归一化累积直方图(NCH):<br/>K/(2 * N)其中K是所有可能的颜色(通常从0到255)，N是图像大小</li><li id="ef20" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">计算最接近整数的NCH底</li></ul><p id="1aa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是你和我在均衡上面的样本图像直方图后期望看到的。显然，图像看起来更有吸引力，因为它的对比度增强了。另外，看看图像直方图，上面的红色列从0到255分布得更均匀。每两列之间的空白意味着更多的对比。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/fd03344189a195be3ad001f3c44038ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmgebkc1svpTIcQnHPp4vQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">均衡直方图后</figcaption></figure><p id="6473" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于理论和数学来说，这已经足够了。让我们弄脏你的手。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lo"><img src="../Images/bd1df24fe486fcfaff38be41dd20a125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wdVTlD4CkkqR2_pNJoypPg.png"/></div></figure><blockquote class="lp lq lr"><p id="0c48" class="if ig lm ih b ii ij ik il im in io ip ls ir is it lt iv iw ix lu iz ja jb jc hb bi translated">下面的教程是用Python3实现的。你可以去我的Github repo下载<a class="ae lv" href="https://github.com/quocdat32461997/MoCV" rel="noopener ugc nofollow" target="_blank"> MoCV </a>，这是我为实现计算机视觉算法而创建的Python包。</p></blockquote><p id="8c55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入依赖项</p><pre class="je jf jg jh fd lw lx ly lz aw ma bi"><span id="0066" class="mb ju hi lx b fi mc md l me mf">import numpy as np<br/>import cv2 </span></pre><p id="079c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建<em class="lm">直方图</em>函数</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="f094" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，均衡图像直方图</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="2060" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们重建对比增强图像</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="1174" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们结合一切</p><pre class="je jf jg jh fd lw lx ly lz aw ma bi"><span id="0dbd" class="mb ju hi lx b fi mc md l me mf">image = cv2.imread("your_image", 0) #gray-scale, any channel<br/>enhanced_image = upcontrastImage(image)<br/>cv2.imwrite("your_enhanced_image", enhanced_image)</span></pre><p id="116f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，转到存储增强图像的目录，并打开以查看它。使用cv2.imshow(enhanced_image)不会显示预期的图像。</p><p id="c660" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，这就是增强图像对比度的直方图均衡化及其在Python中的实现。所有源代码均可在此处获得:</p><div class="mi mj ez fb mk ml"><a href="https://github.com/quocdat32461997/MoCV" rel="noopener  ugc nofollow" target="_blank"><div class="mm ab dw"><div class="mn ab mo cl cj mp"><h2 class="bd hj fi z dy mq ea eb mr ed ef hh bi translated">quocdat32461997/MoCV</h2><div class="ms l"><h3 class="bd b fi z dy mq ea eb mr ed ef dx translated">计算机视觉算法列表:直方图-计算图像直方图直方图均衡-均衡图像…</h3></div><div class="mt l"><p class="bd b fp z dy mq ea eb mr ed ef dx translated">github.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz jn ml"/></div></div></a></div></div></div>    
</body>
</html>