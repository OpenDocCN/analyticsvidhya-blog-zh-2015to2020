<html>
<head>
<title>Custom Object detection using ImageAi with few steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ImageAi的自定义对象检测只需几个步骤</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/custom-object-detection-using-imageai-with-few-steps-e97b999bae79?source=collection_archive---------4-----------------------#2020-06-15">https://medium.com/analytics-vidhya/custom-object-detection-using-imageai-with-few-steps-e97b999bae79?source=collection_archive---------4-----------------------#2020-06-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ccd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">"<strong class="ih hj"> ImageAI </strong>是一个python库，旨在使开发人员、研究人员和学生能够使用简单的几行代码构建具有自包含深度学习和计算机视觉功能的应用程序和系统"官方文档(【https://imageai.readthedocs.io/en/latest/】T2</p><p id="bbe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ImageAi是一个非常强大的工具，可以为自定义数据集创建模型，实用且易于使用，按照这些步骤创建自己的分类器；</p><p id="e68a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1-准备数据集</p><p id="1fe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2-安装imageAi</p><p id="2d0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3-下载预训练重量(yolo、RetinaNet)</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/2b51d2cea21e9d44615def329f2410b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*49565kutSbP-c6dprirKoQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">样本对象检测</figcaption></figure><h1 id="d9e7" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">计算机视觉</h1><p id="5cf7" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">近年来，我们可以在生活中看到很多应用，包括自动驾驶汽车、面部检测应用、教育、军事、金融等。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kt"><img src="../Images/0e57e652e2255e92596a413847af4c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*prQDwnKsOfq_FE9r.gif"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">样本对象分割</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ku"><img src="../Images/f302ff17ece8ed7a45a5d6fae7011e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8y-mWhuL6oyIQYAA78yXaw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">样本对象检测</figcaption></figure><h2 id="1556" class="kz jr hi bd js la lb lc jw ld le lf ka iq lg lh ke iu li lj ki iy lk ll km lm bi translated">准备数据集</h2><p id="e9ab" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">有必要为训练过程收集大量的图像，建议该项目每个班至少200张图像，结构如下:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ln"><img src="../Images/57a13f1b9b32d1a70b3818b6464706eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhgHUhyEpSYk0sgK6TGK9w.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lo"><img src="../Images/21bd48e1c31117a166af994fcf923d5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*TRfnrAvu2ZJsbuKmj-eShw.png"/></div></figure><h2 id="7abd" class="kz jr hi bd js la lb lc jw ld le lf ka iq lg lh ke iu li lj ki iy lk ll km lm bi translated">注释图像</h2><p id="4199" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">ImageAi支持Pascal Voc标注格式，个人来标注图片我用的是LabelIMG，一个好用的工具，在项目结构上面看到的分离之后，在训练和验证之间(70%训练图片和30%验证图片)。打开LabelImg，我们开始为数据集中的每幅图像添加注释，如下所示。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lp"><img src="../Images/850eca96b74d42df12dbf558e074aac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7_yMg7NV4nOLLRqGmCCEg.png"/></div></div></figure><p id="071a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在注释每个图像之后，应用程序将为每个图像生成一个xml文件，该文件将被定向到“注释”文件夹，</p><h2 id="5df2" class="kz jr hi bd js la lb lc jw ld le lf ka iq lg lh ke iu li lj ki iy lk ll km lm bi translated">安装ImageAi和培训要求</h2><p id="afbc" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">正如已经描述过的，我们使用Google Colab来执行训练，使用GPU来加速这个过程；</p><h1 id="d568" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">要求</h1><p id="f7d9" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated"><strong class="ih hj">蟒蛇:</strong><a class="ae jd" href="https://python.org/" rel="noopener ugc nofollow" target="_blank">https://python.org</a></p><p id="5818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">张量流:</strong>！pip3安装tensor flow(verso亚a 2.0)</p><p id="d134" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> OpenCV : </strong>！pip3安装opencv-python</p><p id="685f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Keras : </strong>！pip3安装keras</p><p id="3e08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ImageAI : </strong>！pip3安装imageai —升级</p><h1 id="0c69" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">下载前型号yolov3</h1><p id="7f5b" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated"><em class="lq">！wget</em><a class="ae jd" href="https://github.com/OlafenwaMoses/ImageAI/releases/download/essential-v4/pretrained-yolov3.h5" rel="noopener ugc nofollow" target="_blank"><em class="lq">https://github . com/OlafenwaMoses/ImageAI/releases/download/essential-v4/pretrained-yolov 3 . H5</em></a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lr"><img src="../Images/6b826735d73068d6646a7f0e85de8b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3rWfICY4nlKTM_l61AJQKA.png"/></div></div></figure><p id="4738" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在执行前面的步骤并在google colab上启用笔记本的GPU后，我们可以训练我们的应用程序，为此我们必须运行下面的代码，完整的项目文档编写得非常好，易于理解。</p><p id="b46c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">链接:<a class="ae jd" href="https://imageai.readthedocs.io/en/latest/customdetection/index.html" rel="noopener ugc nofollow" target="_blank">https://imageai . readthedocs . io/en/latest/custom detection/index . html</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ls"><img src="../Images/fdeda467ed5282926b4f68d523740a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eYJuP6lokwWUs6gcopT1fg.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lt"><img src="../Images/a46e2d4a112ed4d722f8070321a15a58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*1l4NFckCry8lygn78c8jqA.png"/></div></figure><p id="fb1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在只需等待培训过程……(大约3小时)</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="f4a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练过程结束后，我们上传一个视频，使用下面的代码测试应用程序；</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lw"><img src="../Images/7c6547fe2c1a4edbbb01737ba75b7441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rpu5AdfkGjg1R_SqsviLiw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">用于测试视频对象检测的样本</figcaption></figure><p id="c6ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">遵循结果；</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lx lv l"/></div></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ly lv l"/></div></figure></div></div>    
</body>
</html>