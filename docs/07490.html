<html>
<head>
<title>Build your first Telegram Bot using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python构建您的第一个电报机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-and-deploy-your-first-telegram-bot-using-python-part-1-dcfd83bd6718?source=collection_archive---------9-----------------------#2020-06-27">https://medium.com/analytics-vidhya/build-and-deploy-your-first-telegram-bot-using-python-part-1-dcfd83bd6718?source=collection_archive---------9-----------------------#2020-06-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4326fdc4a8b14c252c0105cdf9088e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ahFKsUZWUeG6GTG_"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">电报标志</figcaption></figure><p id="a0a1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">如果你正在学习python，并且想尝试一下实时项目，来找个座位，让我带你进入python的奇妙世界。</em>T5】</strong></p><p id="406e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我先介绍一下你暂时需要的东西:</p><ol class=""><li id="6fe5" class="jt ju hi iw b ix iy jb jc jf jv jj jw jn jx jr jy jz ka kb bi translated">使用botfather创建bot令牌(当然假设您有一个电报帐户)</li><li id="c639" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">python中电报API的包装器(pyTelegramBotAPI)</li><li id="7fb6" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">你的热情(肯定是的)</li></ol><p id="5c06" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">是的，这就是你做第一个电报机器人需要的所有配方。</p><h2 id="4d30" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated"><strong class="ak">创建我们的机器人</strong></h2><p id="e167" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated">第一步:在telegram中搜索@BotFather，按开始。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/9c771654eb558370487d4ac47cff37fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*BeAHmc_wbKbZTdqV"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">电报中的父亲</figcaption></figure><p id="e321" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第二步:输入<em class="js"> /newbot，</em>然后输入你想要的机器人名称和用户名(确保创建一个唯一的用户名，并且必须以‘bot’结尾)。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="c173" class="kh ki hi ln b fi lr ls l lt lu"> e.g. motivate11Bot or motivate11_bot</span></pre><p id="f912" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第三步:恭喜你，现在你在Telegram中有了自己的机器人，可以自动操作你的东西。复制API令牌并开始编写bot代码。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/914e4cbc81c837fc3f84e071d9707cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*7oH2fUP94UamlTOmJJdykw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">bot的API密钥</figcaption></figure><blockquote class="lw lx ly"><p id="0c79" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr hb bi translated">不要共享或公开你的API令牌。就像给你的账号密码一样。</p></blockquote></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><h2 id="e938" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">安装软件包和依赖项</h2><p id="03f1" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated">始终确保创建一个虚拟环境，以便依赖关系不会搞乱您的整个环境。要创建虚拟环境，打开命令提示符，或者如果您使用anaconda提示符，这将容易得多。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="edcb" class="kh ki hi ln b fi lr ls l lt lu">For command prompt:<br/>$ python3 -m venv /path/to/new/virtual/environment</span><span id="92a4" class="kh ki hi ln b fi mj ls l lt lu">For anaconda prompt:<br/>$ conda create -n pybot python=3.7.2</span></pre><p id="2534" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">创建这个虚拟环境后，从基本环境切换到虚拟环境。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="bb11" class="kh ki hi ln b fi lr ls l lt lu">For command prompt:<br/>$ source ./venv/bin/activate</span><span id="b497" class="kh ki hi ln b fi mj ls l lt lu">For anaconda prompt:<br/>$ conda activate pybot</span></pre><p id="b142" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们安装具有魔力的软件包，</p><p id="eaf9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><code class="du mk ml mm ln b">$ pip install pyTelegramBotAPI</code></p><p id="9803" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这几乎涵盖了所有需要的东西，还有很多其他的Telegram API可用，但是我们选择pyTelegramBotAPI是因为它的简单和优雅。</p></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="a20e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">跟进这个目录结构</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="0d00" class="kh ki hi ln b fi lr ls l lt lu">.<br/>├── bot.py<br/>└── config.json</span></pre><p id="e1a4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在同一个目录中创建一个名为“config.json”的新文件，其中包含获得的API_KEY作为键值对。</p><p id="88c3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">示例:</p><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="mn mo l"/></div></figure><p id="2cf4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们通过启动IDE来开始编码。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="1b30" class="kh ki hi ln b fi lr ls l lt lu">#required packages<br/>import telebot<br/>import requests<br/>import os<br/>import json</span><span id="a8b6" class="kh ki hi ln b fi mj ls l lt lu">#Config vars<br/>with open(‘config.json’) as f:<br/> token = json.load(f)</span><span id="d7be" class="kh ki hi ln b fi mj ls l lt lu">#initialise bot<br/>bot = telebot.TeleBot(token[‘telegramToken’])<br/>x = bot.get_me()<br/>print(x)</span><span id="4dc7" class="kh ki hi ln b fi mj ls l lt lu">#pool~start the bot<br/>bot.polling()</span></pre><p id="7eea" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Telebot是处理与Telegram bot交互的<code class="du mk ml mm ln b">pyTelegramBotAPI</code>的一部分。运行代码片段，瞧！！！。</p><p id="03b5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您得到这样的输出:</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/ef0761f9609a9eacc27b94cbf422edc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1dJ6CCiOuZo470ie5ebOCQ.png"/></div></div></figure><p id="d5cf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，您现在已经成功地将您的电报机器人与Python连接起来了。</p></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="757e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们添加更多的命令，机器人可以使用这些命令与用户进行交互。在“汇集”步骤之前添加以下功能。(链接到本文末尾给出的示例存储库)</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="96f6" class="kh ki hi ln b fi lr ls l lt lu">#handling commands - /start<a class="ae mq" href="http://twitter.com/bot" rel="noopener ugc nofollow" target="_blank"><br/>@bot</a>.message_handler(commands=[‘start’, ‘help’])<br/>def send_welcome(message):<br/> bot.send_message(message.chat.id, “Welcome user”)</span></pre><p id="1998" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用` @bot.message_handler` decorator，您现在已经触发了一段代码，在调用上述命令时运行。当提供/start或/help命令时，这将欢迎用户或发送帮助消息。</p><blockquote class="lw lx ly"><p id="3726" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr hb bi translated">更多的处理程序和API方法，查看:<a class="ae mq" href="https://github.com/eternnoir/pyTelegramBotAPI" rel="noopener ugc nofollow" target="_blank">https://github.com/eternnoir/pyTelegramBotAPI</a>&amp;<a class="ae mq" href="https://core.telegram.org/bots/api" rel="noopener ugc nofollow" target="_blank">https://core.telegram.org/bots/api</a></p></blockquote><p id="57de" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们连接一个简单的API来演示如何使用机器人来自动化和简化您的日常任务。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="0d60" class="kh ki hi ln b fi lr ls l lt lu">#handling commands - /motivate<br/><a class="ae mq" href="http://twitter.com/bot" rel="noopener ugc nofollow" target="_blank">@bot</a>.message_handler(commands=[‘motivate’])<br/>def send_quotes(message):<br/> quote= requests.request(url=’<a class="ae mq" href="https://api.quotable.io/random',method='get'" rel="noopener ugc nofollow" target="_blank">https://api.quotable.io/random',method='get'</a>)<br/> bot.reply_to(message, quote.json()[‘content’])</span></pre><p id="4880" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">每当发送/motivate时，它都会用一个来自“quotable.io”的随机引用来回复用户。</p><blockquote class="lw lx ly"><p id="b3c1" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr hb bi translated">要清楚地了解代码和设置，请访问此报告:</p><p id="d7b2" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr hb bi translated"><a class="ae mq" href="https://github.com/krsh-37/TelegramBot" rel="noopener ugc nofollow" target="_blank">https://github.com/krsh-37/TelegramBot</a></p></blockquote><p id="ed37" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以，我演示了一种使用这个机器人自动完成简单任务的方法，你可以创建一个机器人，<em class="js">提供你公司的每日统计数据</em>或<em class="js">给客户的产品价格</em>或<em class="js">作为你机器学习模型的网关</em>！！</p><p id="c87a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">将您的想法释放到工作模型中。开始建造你自己的机器人。</p><p id="e373" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本博客的第2部分，学习如何将这个机器人部署到Heroku:</p><div class="mr ms ez fb mt mu"><a rel="noopener follow" target="_blank" href="/@krsh37/learn-how-to-deploy-into-heroku-3158a41b46fb"><div class="mv ab dw"><div class="mw ab mx cl cj my"><h2 class="bd hj fi z dy mz ea eb na ed ef hh bi translated">在Heroku中构建并部署一个简单的YouTube下载器bot</h2><div class="nb l"><h3 class="bd b fi z dy mz ea eb na ed ef dx translated">从GitHub集成自动Heroku部署</h3></div><div class="nc l"><p class="bd b fp z dy mz ea eb na ed ef dx translated">medium.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni io mu"/></div></div></a></div><p id="e0cc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="js">学习，分享&amp;投稿。快乐学习！！</em></p></div></div>    
</body>
</html>