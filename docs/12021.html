<html>
<head>
<title>Optimized Allocation of Streams to Heat Exchangers — Framing a Minimization Problem using Python’s PuLP module</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优化热交换器的物流分配—使用Python的纸浆模块构建最小化问题</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/optimized-allocation-of-streams-to-heat-exchangers-framing-a-minimization-problem-using-pythons-b7c936f9a6b5?source=collection_archive---------20-----------------------#2020-12-28">https://medium.com/analytics-vidhya/optimized-allocation-of-streams-to-heat-exchangers-framing-a-minimization-problem-using-pythons-b7c936f9a6b5?source=collection_archive---------20-----------------------#2020-12-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/49b4b095d3bf41e8c73e40e13933c899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hzYYi3PcwTUc7-khR2C7Ig.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><em class="it">来源:</em><a class="ae iu" href="https://www.fluor.com/projects/esso-refinery-epc" rel="noopener ugc nofollow" target="_blank"><em class="it">【https://www.fluor.com/projects/esso-refinery-epc】</em></a></figcaption></figure><h1 id="a337" class="iv iw hh bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">介绍</h1><p id="a2b4" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">如果你在炼油厂工作了相当长的时间，你可能会遇到这些像上面这样系统排列的巨大结构。在机械术语中，该系统是一种“壳管式”热交换器，主要用于将热量从一股高温流体传递或交换到另一股低温流体，反之亦然。</p><p id="0c68" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">热交换器的优化布置可以为工业流体在其他过程中的重新导向提供有效的通道，或者确保在邻近水体中的适当排放，而不会造成重大的环境影响。通过本文，我们将尝试使用Python的纸浆模块来系统地将来自多个来源的流体出口流分配给一组热交换器，以确保原材料的最小浪费并防止流体混合，从而实现最小化总体安装成本的目标，从而制定一个线性规划问题。</p><h1 id="54f6" class="iv iw hh bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">问题定义</h1><p id="0aec" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">导入所需的库</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="d470" class="lf iw hh lb b fi lg lh l li lj">import pandas as pd<br/>import numpy as np<br/>import itertools<br/>from pulp import *</span><span id="6a8b" class="lf iw hh lb b fi lk lh l li lj">import warnings<br/>warnings.filterwarnings("ignore")</span></pre><blockquote class="ll lm ln"><p id="198e" class="jt ju lo jv b jw kr jy jz ka ks kc kd lp kt kg kh lq ku kk kl lr kv ko kp kq ha bi translated">本文使用的所有数据和代码都可以通过我的GitHub repo获得:<a class="ae iu" href="https://github.com/mohiteprathamesh1996/Heat-Exchanger-Assignment-" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/mohiteprathamesh 1996/Heat-exchange-Assignment-</a></p></blockquote><p id="7f98" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">现在让我们来看看现有的数据:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="287d" class="lf iw hh lb b fi lg lh l li lj">df = pd.read_excel("Heat Exchanger Assignment Optimization.xlsx", sheet_name="Installation Costs")</span><span id="cd83" class="lf iw hh lb b fi lk lh l li lj">df.set_index("Streams", inplace=True)</span><span id="7ba2" class="lf iw hh lb b fi lk lh l li lj">df</span></pre><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/23aa7d2de98a925ea74f63ed38e0d73d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76mmPSI0X9a6Qvc4x6huZQ.png"/></div></div></figure><p id="5883" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">上表显示了与将10个流体流的输出分配给10个不同的热交换器相关的各种成本(以美元计)。将流I(其中i <strong class="jv hi"> ∈ ( </strong> 1、…、10)分配给热交换器j(其中j <strong class="jv hi"> ∈ </strong> (1、…、10))的实际成本可能会因多种因素而异，如所用管道的长度、与交换站的距离、所需的原材料和人力等。我们现在的目标是“以尽可能低的成本将这些流中的每一个分配给它们各自的交换器，使得每一个流恰好到达一个交换器，并且相反地，每一个交换器从恰好一个流接收其输入。”</p><h1 id="e5c5" class="iv iw hh bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">决策变量</h1><p id="60ac" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">在这个问题中，我们将二元决策变量X(i，j)定义为</p><blockquote class="ll lm ln"><p id="1ee0" class="jt ju lo jv b jw kr jy jz ka ks kc kd lp kt kg kh lq ku kk kl lr kv ko kp kq ha bi translated">如果流‘I’被分配给交换器‘j’，则X (i，j)= 1；否则，对于所有i∈ (1，..10)和j ∈ (1，…10)</p></blockquote><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="243e" class="lf iw hh lb b fi lg lh l li lj"># Create a list of stream indexes<br/>streams = df.index.to_list()<br/>print("Streams : {} \n".format(streams))</span><span id="7a14" class="lf iw hh lb b fi lk lh l li lj"># Create a list of indexes for exchangers<br/>exchanger_stations = df.columns.to_list()<br/>print("Heat Exchangers : {} \n".format(exchanger_stations))</span><span id="0bfe" class="lf iw hh lb b fi lk lh l li lj"># Create a dictionary of binary type decision variables<br/>var_dict = LpVariable.dicts(<br/>    name="assign",<br/>    indexs=[(i, j) for i in streams for j in exchanger_stations], <br/>    lowBound=0,<br/>    cat="Binary")</span><span id="7b53" class="lf iw hh lb b fi lk lh l li lj"># Display first 5 decision variables<br/>[var_dict[(i,j)] for i in streams for j in exchanger_stations][:5]</span></pre><figure class="kw kx ky kz fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/d6aaa455a390a219fe258ebfd72cb3da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*KqhK1QcUL0C5jnG9en7-ag.png"/></div></figure><h1 id="f164" class="iv iw hh bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">定义目标函数</h1><p id="b0d8" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">将上述LP框定为最小化问题，我们可以将目标函数定义为:</p><p id="1e1f" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated"><strong class="jv hi">最小化，Z = 949*X(1，1) + 1176*X(1，2)+…。+1055*X(10，9) + 1175*X(10，10) </strong></p><p id="2f74" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">数学上，</p><p id="7422" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">最小化，<strong class="jv hi">Z =σC(i，j)*X(i，j) </strong>其中C(I，j)是将流‘I’分配给交换器‘j’的成本，如上表所示，所有i <strong class="jv hi"> ∈ ( </strong> 1，…，10)和j <strong class="jv hi"> ∈ </strong> (1，…，10)。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="040c" class="lf iw hh lb b fi lg lh l li lj"># Define the LP Minimization problem<br/>model = LpProblem("Minimize Installation Costs", LpMinimize)<br/></span><span id="49c4" class="lf iw hh lb b fi lk lh l li lj"># Adding the objective function <br/>model += lpSum([df.loc[(i,j)]*var_dict[(i,j)] \<br/>                for i in streams \<br/>                        for j in exchanger_stations])</span></pre><h1 id="b07d" class="iv iw hh bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">限制</h1><p id="3d2c" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">如前所述，LP受到约束，使得每个流的出口恰好到达一个交换器，相反，每个交换器从恰好一个流接收其输入。</p><p id="3286" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">首先是对溪流的限制。这里，我们将流索引“I”视为常数，并在每个交换站上迭代。数学上，<strong class="jv hi">σX(j)= 1</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7178" class="lf iw hh lb b fi lg lh l li lj"># Each stream must be assigned to exactly 1 heat exchanger<br/>for i in streams:<br/>    model += lpSum([var_dict[(i, j)] \<br/>                          for j in exchanger_stations]) == 1</span></pre><p id="d300" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">接下来，对交换器的约束。这里，我们将交换器指数‘j’视为常数，并在流出口上迭代。数学上，<strong class="jv hi">σX(I)= 1</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="69d9" class="lf iw hh lb b fi lg lh l li lj"># Every heat exchanger must receive input from exactly 1 stream    <br/>for j in exchanger_stations:<br/>    model += lpSum([var_dict[(i, j)] \<br/>                          for i in streams]) == 1</span></pre><h1 id="cd09" class="iv iw hh bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">最优解</h1><p id="492c" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">在这最后一步中，我们求解上述LP并获得流分配的最优模式。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="8ba1" class="lf iw hh lb b fi lg lh l li lj"># Solve the mode<br/>model.solve()</span><span id="7050" class="lf iw hh lb b fi lk lh l li lj"># Saving the optimal solution results<br/>if LpStatus[model.status]=="Optimal":<br/>    optimal_soln = pd.DataFrame(<br/>[(v.name, v.varValue) for v in model.variables() if v.varValue==1],<br/>                                columns=["Assignment", "Status"])</span><span id="194a" class="lf iw hh lb b fi lk lh l li lj">print("Total installation cost : $ {}".format(value(model.objective)))</span><span id="ab7c" class="lf iw hh lb b fi lk lh l li lj">optimal_soln</span></pre><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/5972a1a90f48ae4cc298ca436a785756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLjnHeIBNloPAsUKITCxfg.png"/></div></div></figure><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="2875" class="lf iw hh lb b fi lg lh l li lj">pd.DataFrame(<br/>[(optimal_soln[optimal_soln[c]==1].index.values[0], c)\<br/>  for c in optimal_soln.columns],<br/>             columns = ["ConnectionFrom", "ConnectionTo"])</span></pre><figure class="kw kx ky kz fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/8bcde96c1b54bf6d00d5c1c8792cdcc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*IojjpNYrO_5eG7huNtQ3Og.png"/></div></figure><p id="428d" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">最终，我们实现了我们的目标，以尽可能低的安装成本将流分配到各自的热交换器。如果上述数据集的维度发生变化，可以重用上述代码序列。</p><h1 id="4dac" class="iv iw hh bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">参考</h1><ol class=""><li id="7b1c" class="lw lx hh jv b jw jx ka kb ke ly ki lz km ma kq mb mc md me bi translated">Edgar，T.F .，Himmelblau，D.M .和Lasdon，L.S .，2001年。<em class="lo">化工过程的优化</em>。麦格劳-希尔公司。</li><li id="6d65" class="lw lx hh jv b jw mf ka mg ke mh ki mi km mj kq mb mc md me bi translated">s .米切尔、m .奥苏利文和I .邓宁，2011年。PuLP:python的线性编程工具包。<em class="lo">新西兰奥克兰市奥克兰大学</em>。</li><li id="d115" class="lw lx hh jv b jw mf ka mg ke mh ki mi km mj kq mb mc md me bi translated"><a class="ae iu" href="https://www.explainthatstuff.com/how-heat-exchangers-work.html" rel="noopener ugc nofollow" target="_blank">https://www . explain that stuff . com/how-heat-exchangers-work . html</a></li></ol><p id="c249" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">PS:如果你想让我做一些编辑或任何一般性的建议，请随意评论。感谢您的宝贵时间！</p><p id="618c" class="pw-post-body-paragraph jt ju hh jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq ha bi translated">我们在LinkedIn上连线:<a class="ae iu" href="https://www.linkedin.com/in/prathameshmohite96/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/prathameshmohite96/</a></p></div></div>    
</body>
</html>