# ä½¿ç”¨è´å¶æ–¯ä¼˜åŒ–å¯¹ LightGBMã€CatBoost å’Œ XGBoost å›å½’å™¨è¿›è¡Œè¶…å‚æ•°ä¼˜åŒ–ã€‚

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/hyperparameters-optimization-for-lightgbm-catboost-and-xgboost-regressors-using-bayesian-6e7c495947a9?source=collection_archive---------0----------------------->

![](img/8cfe9f07f799c8b74988f9d66ddfd7f4.png)

**æ—¥æœ¬ä¸œäº¬ä¸€æ¡ç¹å¿™çš„è¡—é“ã€‚åœ¨è¿™é‡Œæ‰¾åˆ°è¯´è‹±è¯­çš„äººï¼Œå°±åƒæ‰¾åˆ°åŠ©æ¨ç®—æ³•çš„æœ€ä½³è¶…å‚æ•°ä¸€æ ·å›°éš¾ã€‚**ğŸ˜‰

## å¦‚ä½•ç”¨è´å¶æ–¯ä¼˜åŒ–æ¥ä¼˜åŒ– boosting æœºå™¨å­¦ä¹ ç®—æ³•çš„è¶…å‚æ•°ï¼Ÿ

B oosting æœºå™¨å­¦ä¹ ç®—æ³•è¢«é«˜åº¦ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ¯”ç®€å•çš„ç®—æ³•æä¾›äº†æ›´å¥½çš„å‡†ç¡®æ€§ã€‚è¿™äº›ç®—æ³•çš„æ€§èƒ½å–å†³äºè¶…å‚æ•°ã€‚ä¸€ç»„æœ€ä½³çš„å‚æ•°æœ‰åŠ©äºè·å¾—æ›´é«˜çš„ç²¾åº¦ã€‚æ‰‹åŠ¨å¯»æ‰¾è¶…å‚æ•°æ˜¯ä¹å‘³ä¸”è®¡ç®—æ˜‚è´µçš„ã€‚å› æ­¤ï¼Œè¶…å‚æ•°è°ƒæ•´çš„è‡ªåŠ¨åŒ–éå¸¸é‡è¦ã€‚RandomSearchã€GridSearchCV å’Œè´å¶æ–¯ä¼˜åŒ–é€šå¸¸ç”¨äºä¼˜åŒ–è¶…å‚æ•°ã€‚[è´å¶æ–¯ä¼˜åŒ–](http://papers.nips.cc/paper/4522-practical-bayesian-optimization-of-machine-learning-algorithms.pdf)ä¸å…¶ä»–æ–¹æ³•ç›¸æ¯”ï¼Œèƒ½ç»™å‡ºæ›´å¥½æ›´å¿«çš„ç»“æœã€‚

**è´å¶æ–¯ä¼˜åŒ–æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ**

1.  å»ºç«‹ç›®æ ‡å‡½æ•°çš„ä»£ç†æ¦‚ç‡æ¨¡å‹
2.  æ‰¾åˆ°åœ¨ä»£ç†ä¸Šè¡¨ç°æœ€å¥½çš„è¶…å‚æ•°
3.  å°†è¿™äº›è¶…å‚æ•°åº”ç”¨äºçœŸæ­£çš„ç›®æ ‡å‡½æ•°
4.  æ›´æ–°åŒ…å«æ–°ç»“æœçš„ä»£ç†æ¨¡å‹
5.  é‡å¤æ­¥éª¤ 2-4ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°æˆ–æ—¶é—´

è´å¶æ–¯ä¼˜åŒ–å™¨å»ºç«‹ç»™å®šç›®æ ‡å‡½æ•°çš„æ¦‚ç‡æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥é€‰æ‹©æœ€æœ‰å¸Œæœ›çš„è¶…å‚æ•°ï¼Œä»¥åœ¨çœŸå®ç›®æ ‡å‡½æ•°ä¸­è¿›è¡Œè¯„ä¼°ã€‚å¦‚æœä½ æƒ³æ·±å…¥ç ”ç©¶ï¼Œé‚£ä¹ˆå°±åœ¨è¿™é‡Œé˜…è¯»[](http://papers.nips.cc/paper/4522-practical-bayesian-optimization-of-machine-learning-algorithms.pdf)**å’Œ [**è¿™é‡Œé˜…è¯»**](https://towardsdatascience.com/a-conceptual-explanation-of-bayesian-model-based-hyperparameter-optimization-for-machine-learning-b8172278050f) ã€‚**

****å¦‚ä½•ç”¨è´å¶æ–¯ä¼˜åŒ–ä¼˜åŒ–è¶…å‚æ•°ï¼Ÿ****

**æˆ‘å°†ä½¿ç”¨[è´å¶æ–¯ä¼˜åŒ–](https://github.com/fmfn/BayesianOptimization) python åŒ…æ¥æ¼”ç¤ºåŸºäºè´å¶æ–¯æ¨¡å‹çš„ä¼˜åŒ–çš„åº”ç”¨ã€‚é€šè¿‡ pip å®‰è£…è´å¶æ–¯ä¼˜åŒ– python åŒ…ã€‚**

**`pip install bayesian-optimization`**

**è¶…å‚æ•°ä¼˜åŒ–è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ã€‚**

****ç¬¬ 1 éƒ¨åˆ†â€”å®šä¹‰ç›®æ ‡å‡½æ•°****

**å®šä¹‰ä¸€ä¸ªç›®æ ‡å‡½æ•°ï¼Œå°†è¶…å‚æ•°ä½œä¸ºè¾“å…¥ï¼Œç»™å‡ºä¸€ä¸ªæœ€å¤§åŒ–æˆ–æœ€å°åŒ–çš„åˆ†æ•°ä½œä¸ºè¾“å‡ºã€‚**

****ç¬¬ 2 éƒ¨åˆ†â€”å®šä¹‰è¶…å‚æ•°çš„æœç´¢ç©ºé—´****

**å®šä¹‰è¦ä¼˜åŒ–çš„è¶…å‚æ•°èŒƒå›´ã€‚ä¿æŒè¾ƒçª„çš„å‚æ•°èŒƒå›´ä»¥è·å¾—æ›´å¥½çš„ç»“æœã€‚**

****ç¬¬ 3 éƒ¨åˆ†â€”â€”å®šä¹‰ç›®æ ‡å‡½æ•°çš„ä»£ç†æ¨¡å‹å¹¶è°ƒç”¨å®ƒã€‚****

**åšä¸€ä¸ªè´å¶æ–¯ä¼˜åŒ–å‡½æ•°ï¼Œè°ƒç”¨å®ƒä½¿ç›®æ ‡äº§å‡ºæœ€å¤§åŒ–ã€‚è´å¶æ–¯ä¼˜åŒ–å‡½æ•°æœ‰ä¸‰ä¸ªè¾“å…¥:`Objective Function`ã€`Search Space`å’Œ`random_state`ã€‚**

**è®©æˆ‘ä»¬å®ç°è´å¶æ–¯ä¼˜åŒ–ï¼Œä»¥æé«˜æœºå™¨å­¦ä¹ ç®—æ³•çš„å›å½’ç›®çš„ã€‚**

****å¯¼å…¥åº“å¹¶åŠ è½½æ•°æ®ã€‚****

**æˆ‘å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨[æ³¢å£«é¡¿ä½æˆ¿](https://www.kaggle.com/c/boston-housing/data)æ•°æ®ã€‚**

**![](img/a1e4e2d13f39e45937bbc87a01182dfc.png)**

**æ³¢å£«é¡¿ä½æˆ¿æ•°æ®çš„å‰ 5 è¡Œã€‚**

**æˆ‘ä»¬çš„æ•°æ®æœ‰ 13 ä¸ªé¢„æµ‹å˜é‡(è‡ªå˜é‡)ï¼Œä»·æ ¼ä½œä¸ºå‡†åˆ™å˜é‡(å› å˜é‡)ã€‚**

## ****1ã€‚LightGBM å›å½’å™¨****

****a .ç›®æ ‡å‡½æ•°****

**ç›®æ ‡å‡½æ•°å°†è¿”å›è´Ÿçš„`l1`(ç»å¯¹æŸå¤±ï¼Œåˆ«å= `mean_absolute_error`ï¼Œ`mae`)ã€‚ç›®æ ‡æ˜¯ä¼˜åŒ–ç›®æ ‡å‡½æ•°çš„è¾“å‡ºã€‚ä¹Ÿå¯ä»¥ç”¨`l2`ã€`l2_root`ã€`poisson` ä»£æ›¿`l1`ã€‚**

****æ³¨:****

> **LightGBM å’Œ XGBoost æ²¡æœ‰ R å¹³æ–¹åº¦é‡ã€‚å¦‚æœä½ æƒ³ç”¨ R2 æŒ‡æ ‡ä»£æ›¿å…¶ä»–è¯„ä¼°æŒ‡æ ‡ï¼Œé‚£ä¹ˆå°±å†™ä½ è‡ªå·±çš„ R2 æŒ‡æ ‡ã€‚**

****å‚è§ R2 æŒ‡æ ‡çš„ç›®æ ‡å‡½æ•°ç¤ºä¾‹ã€‚****

****b .æœç´¢ç©ºé—´****

**å®šä¹‰ç›®æ ‡å‡½æ•°è¾“å…¥å‚æ•°çš„èŒƒå›´ã€‚æ‚¨å¯ä»¥æ ¹æ®æƒ³è¦ä¼˜åŒ–çš„è¶…å‚æ•°çš„æ•°é‡æ¥å®šä¹‰è¾“å…¥å‚æ•°çš„æ•°é‡ã€‚è¿™ä¸ªä¾‹å­æœ‰ 6 ä¸ªè¶…å‚æ•°ã€‚**

****c .ä»£ç†æ¨¡å‹å’Œä¼˜åŒ–****

**å®šä¹‰ä¸€ä¸ªè´å¶æ–¯ä¼˜åŒ–å‡½æ•°ï¼Œæœ€å¤§åŒ–ç›®æ ‡å‡½æ•°çš„è¾“å‡ºã€‚`init_points`å’Œ`n_iter`ä¹‹å’Œç­‰äºä¼˜åŒ–è½®æ¬¡æ€»æ•°ã€‚**

*****æŠŠæ‰€æœ‰çš„æ”¾åœ¨ä¸€ä¸ªå‡½æ•°é‡Œã€‚*****

**ä¸Šè¿°ä»£ç çš„è¾“å‡ºå°†æ˜¯è¡¨ï¼Œè¯¥è¡¨å°†ç›®æ ‡å‡½æ•°çš„è¾“å‡ºä½œä¸ºç›®æ ‡ï¼Œå¹¶å°†è¾“å…¥å‚æ•°çš„å€¼ä½œä¸ºç›®æ ‡å‡½æ•°ã€‚ä½¿ç”¨`obtimizer.max['params']`è·å¾—æœ€ä½³å‚æ•°ã€‚**

**![](img/0042a69719ff2c1f89d6118d93475a70.png)**

**LightGBM å›å½’å™¨çš„è¶…å‚æ•°ä¼˜åŒ–ç»“æœè¡¨**

## ****2ã€‚Catboost å›å½’å™¨****

****a .ç›®æ ‡å‡½æ•°****

**ç›®æ ‡å‡½æ•°æœ‰ä¸¤ä¸ªè¾“å…¥:`depth`å’Œ`bagging_temperature`ã€‚ç›®æ ‡å‡½æ•°å°†è¿”å›æµ‹è¯•çš„æœ€å¤§å¹³å‡ R å¹³æ–¹å€¼ã€‚**

****b .æœç´¢ç©ºé—´****

**ç›®æ ‡å‡½æ•°åªæœ‰ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œå› æ­¤æœç´¢ç©ºé—´ä¹Ÿåªæœ‰ä¸¤ä¸ªå‚æ•°ã€‚**

****c .**ä»£ç†æ¨¡å‹ä¸ä¼˜åŒ–**

**è´å¶æ–¯ä¼˜åŒ–å™¨å°†ä¼˜åŒ–`depth`å’Œ`bagging_temperature`ï¼Œä»¥ä¼˜åŒ–`R2`å€¼ã€‚**

**![](img/a17d7bbfcf328542f492664e8913ddc0.png)**

**CatBoost å›å½’å™¨çš„è¶…å‚æ•°ä¼˜åŒ–ç»“æœè¡¨**

## ****3ã€‚XGBoost å›å½’å™¨****

****a .ç›®æ ‡å‡½æ•°****

**ç›®æ ‡å‡½æ•°ç»™å‡ºè¾“å…¥å‚æ•°`r2`çš„æœ€å¤§å€¼ã€‚**

****æ³¨:****

1.  **å¦‚æœ`eval_metric`åŒ…å«åœ¨å‚æ•°ä¸­ï¼Œåˆ™ä½¿ç”¨`early_stopping_rounds`è¾ƒå°çš„æ•°å­—(10 æˆ–æ›´å°)ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå¦‚æœç»™å®šçš„æ—©æœŸåœæ­¢è½®æ¬¡çš„è¯„ä¼°æŒ‡æ ‡å€¼æ²¡æœ‰æé«˜ï¼Œé‚£ä¹ˆè®­ç»ƒå°†ä¼šåœæ­¢ã€‚**
2.  **å¦‚æœå‚æ•°ä¸­æ²¡æœ‰å®šä¹‰`eval_metric`ï¼Œåˆ™ä½¿ç”¨æ¯”`num_boost_rounds`å¤§çš„æ•°å­—`early_stopping_rounds`ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºè®­ç»ƒå°†åœ¨ç»™å®šçš„æå‰åœæ­¢å›åˆåœæ­¢ã€‚**

****b .æœç´¢ç©ºé—´****

****c .ä»£ç†æ¨¡å‹å’Œä¼˜åŒ–****

**![](img/f9b4dcfd13b076fc5a24401c27aa8c09.png)**

**XGBoost å›å½’å™¨çš„è¶…å‚æ•°ä¼˜åŒ–ç»“æœè¡¨**

**æˆ‘å¸Œæœ›ï¼Œä½ å·²ç»å­¦ä¹ äº†è´å¶æ–¯ä¼˜åŒ–çš„è¶…å‚æ•°ä¼˜åŒ–çš„æ•´ä½“æ¦‚å¿µã€‚è¶…å‚æ•°è°ƒæ•´ç°åœ¨çœ‹èµ·æ¥å¾ˆå®¹æ˜“ã€‚å¯¹å—ï¼Ÿ**

## ****ç»“è®º****

**ä½¿ç”¨`Bayesian Optimization`å¾ˆå®¹æ˜“ä¼˜åŒ–è¶…å‚æ•°ã€‚LightGBM å’Œ XGBoost æ²¡æœ‰`r2`åº¦é‡ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥å®šä¹‰è‡ªå·±çš„`r2 metric`ã€‚**light GBM å’Œ XGBoost çš„** `**r2**` **åº¦é‡å·®åˆ«ä¸å¤§ã€‚LightGBM R2 åº¦é‡åº”è¯¥è¿”å› 3 ä¸ªè¾“å‡ºï¼Œè€Œ XGBoost R2 åº¦é‡åº”è¯¥è¿”å› 2 ä¸ªè¾“å‡ºã€‚****

**æˆ‘ä»¬å¯ä»¥æ ¹æ®æ¨¡å‹éœ€æ±‚ä½¿ç”¨ä¸åŒçš„è¯„ä¼°æ ‡å‡†ã€‚ä¿æŒæœç´¢ç©ºé—´å‚æ•°èŒƒå›´è¾ƒçª„ï¼Œä»¥è·å¾—æ›´å¥½çš„ç»“æœã€‚`bayesian-optimization`æœ€å¤§åŒ–ç›®æ ‡å‡½æ•°çš„è¾“å‡ºï¼Œå› æ­¤`l1` & `l2`è¾“å‡ºå¿…é¡»ä¸ºè´Ÿï¼Œ`r2`è¾“å‡ºå¿…é¡»ä¸ºæ­£ã€‚**

**åœ¨ Github æˆ– [**Colab ç¬”è®°æœ¬**](https://colab.research.google.com/drive/1gWwUa3ASZLJTijy3JoJl_nEqHlwHVIeB) ä¸ŠæŸ¥çœ‹ [**ç¬”è®°æœ¬ï¼ŒæŸ¥çœ‹ç”¨ä¾‹ã€‚å¦‚æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·é€šè¿‡**](https://github.com/dc-aichara/DS-ML-Public/blob/master/Medium_Files/hyp_tune.ipynb) **[**LinkedIn**](https://www.linkedin.com/in/dcaichara/) è”ç³»æˆ‘ã€‚å‚æ•°è°ƒçš„å¼€å¿ƒï¼æ„Ÿè°¢æ‚¨çš„é˜…è¯»..ï¼â˜ºï¸****

## ****å‚è€ƒæ–‡çŒ®:****

1.  **[https://towards data science . com/a-åŸºäºè´å¶æ–¯æ¨¡å‹çš„æ¦‚å¿µè§£é‡Š-æœºå™¨å­¦ä¹ çš„è¶…å‚æ•°ä¼˜åŒ–-b8172278050f](https://towardsdatascience.com/a-conceptual-explanation-of-bayesian-model-based-hyperparameter-optimization-for-machine-learning-b8172278050f)**
2.  **[https://towards data science . com/an-introductive-example-of-Bayesian-optimization-in-python-with-hyperpt-aae 40 fff 4 ff](https://towardsdatascience.com/an-introductory-example-of-bayesian-optimization-in-python-with-hyperopt-aae40fff4ff0)o**
3.  **[https://medium . com/spike lab/hyperparameter-optimization-using-Bayesian-optimization-f1 f 393 CD 36d](/spikelab/hyperparameter-optimization-using-bayesian-optimization-f1f393dcd36d)**
4.  **[https://www.kaggle.com/omarito/xgboost-bayesianoptimization](https://www.kaggle.com/omarito/xgboost-bayesianoptimization)**
5.  **[https://github.com/fmfn/BayesianOptimization](https://github.com/fmfn/BayesianOptimization)**