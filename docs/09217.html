<html>
<head>
<title>A machine learning approach to identifying customers of Bank Of Portugal who would subscribe to a term deposit.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种识别葡萄牙银行定期存款客户的机器学习方法。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-machine-learning-approach-to-identifying-customers-of-bank-of-portugal-who-would-subscribe-to-a-8bd04387aac2?source=collection_archive---------11-----------------------#2020-08-29">https://medium.com/analytics-vidhya/a-machine-learning-approach-to-identifying-customers-of-bank-of-portugal-who-would-subscribe-to-a-8bd04387aac2?source=collection_archive---------11-----------------------#2020-08-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="869f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">几个世纪以来，石油一直是社会最有价值的资源之一。纵观历史，谁控制了石油，谁就控制了经济。然而，在今天的“数据经济”中，可以说数据，由于可以从中提取的洞察力和知识，是<strong class="ih hj">潜在的</strong>更有价值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5dfab8c315007f5552c97c7f80fc9291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Rh988A1515vWbAZu"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@spanic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">达米尔·斯班尼克</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="744f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">金融业是利用大数据价值的顶级行业之一。由于营销经理越来越有兴趣根据严格选择的联系人仔细调整他们的定向活动，葡萄牙银行希望找到一种模型来预测哪些未来客户会订阅他们的定期存款。拥有这样一个有效的预测模型有助于提高他们的活动效率，因为他们将能够确定哪些客户会订阅他们的定期存款，从而将他们的营销工作引向这些客户。这将帮助他们更好地管理他们的资源。</p><p id="d1ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个项目的目标是通过使用从葡萄牙银行的客户那里收集的数据来提出这样一个有效的预测模型。</p><h1 id="a672" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据集的描述</h1><p id="c12c" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">葡萄牙银行已经收集了大量的数据，包括那些已经订阅定期存款和那些没有订阅定期存款的客户资料。数据包括以下列。</p><p id="eac8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1 —年龄(数字)</p><p id="e8c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2-作业:作业类型(分类:“管理。”、'蓝领'、'企业家'、'女佣'、'管理'、'退休'、'自雇'、'服务'、'学生'、'技术员'、'失业'、'未知')</p><p id="a222" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3-婚姻:婚姻状况(分类:“离婚”、“已婚”、“单身”、“未知”)；注意:“离婚”是指离婚或丧偶)</p><p id="e9c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4 —教育(分类):'基础. 4y '，'基础. 6y '，'基础. 9y '，'高中'，'文盲'，'专业.课程'，'大学。程度'，'未知')</p><p id="b50d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5 —违约:有信用违约？(分类:“否”、“是”、“未知”)</p><p id="b890" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6 —住房:有住房贷款？(分类:“否”、“是”、“未知”)</p><p id="55d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7 —贷款:有个人贷款？(分类:“否”、“是”、“未知”)</p><p id="5668" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下内容与当前活动的最后一个联系人相关</p><p id="48bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8-联系人:联系人通信类型(分类:“手机”、“电话”)</p><p id="2d79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9-月:一年中的最后一个联系月(分类:'一月'，'二月'，'三月'，…，'十一月'，'十二月')</p><p id="6928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">10-星期几:一周的最后一个联系日(分类:“星期一”、“星期二”、“星期三”、“星期四”、“星期五”)</p><p id="169f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">11-持续时间:最后一次联系的持续时间，以秒为单位(数字)。重要注意事项:该属性对输出目标有很大影响(例如，如果 duration=0，则 y='no ')。然而，在执行呼叫之前，持续时间是未知的。同样，在呼叫结束后，y 是已知的。因此，该输入应仅用于基准测试目的，如果目的是获得现实的预测模型，则应丢弃。</p><p id="40d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#其他属性:</p><p id="ac1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">12-活动:在此活动期间为此客户执行的联系次数(数字，包括最后一次联系)</p><p id="cfb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">13 天:从上一个活动中最后一次联系客户后经过的天数(数字；999 意味着之前没有联系过该客户)</p><p id="9a40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">14-previous:在此活动之前为此客户执行的联系次数(数字)</p><p id="2dfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">15-结果:先前营销活动的结果(分类:“失败”、“不存在”、“成功”)</p><p id="e566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#以下是社会和经济背景属性</p><p id="e717" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">16 —就业变动率:就业变动率—季度指标(数字)17 — cons.price.idx:消费者价格指数—月度指标(数字)</p><p id="b468" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">18 — cons.conf.idx:消费者信心指数—月度指标(数字)</p><p id="69d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">19 — euribor3m: Euribor 3 个月利率—每日指标(数字)</p><p id="e352" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">20 —受雇人数:雇员人数—季度指标(数字)产出变量(预期目标):</p><p id="1faf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">21 — y —客户是否订阅了定期存款？(二进制:“是”、“否”)</p><h1 id="d51c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">所用分类器的描述</h1><p id="e3b4" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><strong class="ih hj"> XGBoost </strong> —是一种梯度增强决策树的实现，旨在提高速度和性能。</p><p id="56e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">逻辑回归</strong> —是一种统计模型，其基本形式使用逻辑函数来模拟二元因变量。</p><p id="78ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">随机森林</strong> —是一种用于分类、回归和其他任务的集成学习方法，通过在训练时构建大量决策树并输出作为类模式或个体树均值预测的类来运行。</p><p id="034b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">多层感知器</strong> —是一类前馈人工神经网络(ANN)。</p><h2 id="7c5d" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">GitHub 链接</h2><p id="9d63" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/nahomneg/Bank-Institution-Term-Deposit-Predictive-Model/" rel="noopener ugc nofollow" target="_blank">https://github . com/nahomneg/Bank-Institution-Term-Deposit-Predictive-Model/</a></p><h1 id="194f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据处理类</h1><p id="0fe1" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">该类涉及葡萄牙银行数据的所有预处理、数据探索(绘图)和特征提取。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ll lm l"/></div></figure><h1 id="1c9b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">建模课程</h1><p id="1a67" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">这个类与创建分类器、创建管道、k-fold 分裂和可用分类器的比较有关。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ll lm l"/></div></figure><h1 id="889b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">解释性数据分析</h1><h2 id="de42" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">导入必要的模块和库</h2><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="ca05" class="ls jv hi lo b be lt lu l lv lw"># import the neccesary libraries<br/>import pandas as pd<br/>import seaborn as sb<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>%matplotlib inline<br/>from sklearn import preprocessing<br/>from itertools import islice<br/>import seaborn as sns<br/>from scipy.stats import binom<br/>from scipy.stats import norm<br/>import statsmodels.stats.api as sms<br/>from sklearn.pipeline import Pipeline<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.neural_network import MLPClassifier<br/>from sklearn import preprocessing<br/># import preprocessor and modelling classes<br/>import data<br/>from model import Model</span></pre><p id="6502" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">加载数据集并创建预处理和建模类的实例。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="b7af" class="ls jv hi lo b be lt lu l lv lw">#load the data set<br/>data_frame = pd.read_csv("dataset/bank-additional-full.csv",sep=';'  , engine='python')<br/># initialize the modelling and preprocessing classes<br/>processor = data.PreProcessing(data_frame)<br/>model = Model()</span></pre><h1 id="f33a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">阶级不平衡</h1><p id="ecc9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">类别不平衡是机器学习分类中的一个主要问题，其中每个类别中的观察值比例不成比例。在这种情况下，许多分类算法对于具有较低比率的类别具有较低的准确度。</p><p id="3308" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了查明数据是否是类不平衡的受害者，我使用了预处理类中的 plot _ target _ imbalance()方法。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="64b3" class="ls jv hi lo b be lt lu l lv lw"># use the plot_target_imbalance method from the PreProcessing class <br/>processor.plot_target_imbalance()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/39aace4e0f408469460da852a667c2ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*LpF8Apkp9f7960JjLxjG9A.png"/></div></figure><p id="061c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图显示数据存在类别不平衡，其中“否”类别的频率是“是”类别的 8 倍。</p><h2 id="04b3" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">极端值</h2><p id="c1e8" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了识别有异常值的列，我使用了预处理类中的 detect_outliers_boxplot()，并将数字列传递给它。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="7b8c" class="ls jv hi lo b be lt lu l lv lw">processor.detect_outliers_boxplot(['duration','age','cons.conf.idx','euribor3m'])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/492c2043a0ac85559ded5cbb04780618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_rAtVoGkPsJCYqNXI-_e0g.png"/></div></div></figure><p id="0776" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两个类别的盒状图在年龄上有相当多的重叠。这个节目年龄不是这样一个分离的栏目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/784961a1ae6835d138f178713962ac5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NI8dHnOkkBoYEiJ-28H9_Q.png"/></div></div></figure><p id="d76a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">euribor3m 的 b/n 中位数为“是”和“否”,这表明它是一个独立的类别。</p><p id="3ad8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的图显示持续时间和年龄有大量的异常值。我使用预处理类中的 handle_outliers()方法将离群值替换为它们各自的中间值。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="981f" class="ls jv hi lo b be lt lu l lv lw">processor.handle_outliers(['duration','age','cons.conf.idx'])</span></pre><h2 id="000e" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">分类变量对目标的影响</h2><p id="2252" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">接下来，我可视化了每个分类变量对目标变量(‘y’)的影响。</p><p id="ba4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我从预处理类向 plot _ multiple _ categorial _ against _ target()传递了一些分类变量。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="ecd0" class="ls jv hi lo b be lt lu l lv lw"># use the plot_multiple_categorical_against_target method of the PreProcessing class<br/># to plot the count of each categorical variable with the target as a hue<br/>processor.plot_multiple_categorical_against_target(['poutcome','marital','loan','housing'])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/52093d9fcc501dcf73605de91ba9e355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wklsIh8seUje_mYI-5tjRw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/293e67b51bcb1ef3054064fd39980dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHUglVfQxTVHCQ2yIIRqnQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mb"><img src="../Images/0a5fd90d29ba2ff432719d9b57a05bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hVcvFcM_XEahR7YCRRSsTA.png"/></div></div></figure><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="55f2" class="ls jv hi lo b be lt lu l lv lw">processor.plot_single_categorical_against_target('education')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mc"><img src="../Images/b309eacee0ee0b0514bfed5b0d4111fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dOQLiUI-cL0eS74-qii7iQ.png"/></div></div></figure><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="845a" class="ls jv hi lo b be lt lu l lv lw">processor.plot_single_categorical_against_target('day_of_week')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es md"><img src="../Images/58f8dcd1950687262c279cdeb8bd17be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_MDkxeABlFZfnLTudLoAg.png"/></div></div></figure><p id="c699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的图显示，在预测目标变量时，星期几没有太大帮助。</p><h2 id="cff5" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">使用直方图的数值变量对目标的影响。</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es me"><img src="../Images/80c7cc164d6b5eb145de377397809e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O805sZwNxituqKyej04TrA.png"/></div></div></figure><p id="1c53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看一下年龄图，参加活动的人数在 25 岁到 40 岁之间上升，但没有那些没有参加的人多。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/fde9289df259fdb2d025df54ce933a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOsZVS6D2XesGJmgX3EZOA.png"/></div></div></figure><h2 id="8545" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">分布图</h2><p id="6a2b" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">接下来，我通过使用 plot_distribution()方法并向其传递一些数字变量来研究数字列的分布。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="07b5" class="ls jv hi lo b be lt lu l lv lw">processor.plot_distribution(['age','duration','campaign','emp.var.rate','euribor3m'])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/5c858d97a6751a102fa333bb5f4e295b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KuRPilrepQG2NM3omS1JA.png"/></div></div></figure><h2 id="5d67" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">相关 b/n 数值变量</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/68a5b020ef1d7a0872c972da9a760248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*TvtDdinaWDEFBnZ19QQYeg.png"/></div></figure><p id="94a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">emp.var.rate、cons.price.idx、euribor3m 和 nr.employed 特征具有非常高的相关性。euribor3m 和 nr.employed 之间的相关性最高，为 0.95！</p><h2 id="3c06" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">特征工程</h2><p id="b733" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我利用预处理类中的 assign_years()方法从 month 列中提取了一个新特性‘Year’。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="be6b" class="ls jv hi lo b be lt lu l lv lw"># create a new feature 'Year' using assign years method<br/>processor.assign_years()<br/>processor.data_frame.sample(10)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mi"><img src="../Images/bfc7a49a626d62076c25d1dddb54115b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_N4ta0ms6AqM0Merw6uBw.png"/></div></div></figure><h2 id="e8c0" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">一次热编码和标准化</h2><p id="a5c5" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">一种热编码是将分类变量转换成一种形式的过程，这种形式可以提供给 ML 算法，以便在预测中做得更好。</p><p id="fe7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据标准化是重新调整数字列的过程，以便它们的平均值为 0，标准差为 1。这也有助于 ML 算法做得更好。</p><p id="c6a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我选择标准化而不是归一化，因为当使用归一化时，数据集与平均值的偏差会有所妥协，归一化试图拟合数据 b/n 0 和 1。</p><h1 id="bd24" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">柱式变压器和管线</h1><p id="4e4d" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">Scikit-learn 最近增加了 Column Transformers 类，它允许为每一列指定不同的转换，使预处理变得不那么繁琐(并且更容易阅读！).在这种情况下要应用的转换是一个热编码和标准化。</p><p id="96cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">顾名思义，管道允许将多个进程、列转换器和机器学习模型堆叠到单个 scikit-learn 估计器中。与任何其他评估者一样，管道也有拟合、预测和评分方法。</p><p id="e47d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用预处理类的 get_column_transformer 方法来获取列转换器，该列转换器又被传递给管道。我放弃了持续时间，因为它决定了命运目标变量，这对于训练机器学习模型来说是不好的。星期几也被删除，因为它对模型没有显著影响。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="a86d" class="ls jv hi lo b be lt lu l lv lw">#a column transformer that handles both one hot encoding and standardization<br/>column_transformer = processor.get_column_transformer(categorical_columns,numerical_columns,['duration','day_of_week'])</span></pre><p id="6bb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在创建管道之前，我必须在列转换器旁边添加要传递给管道的分类器。为了添加分类器，我使用了 model 类的 add_model()函数。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="4535" class="ls jv hi lo b be lt lu l lv lw"># add 4 classifier models to be compared<br/>model.add_classifier(model.get_random_forest_classifier(),'Random Forest')<br/>model.add_classifier(model.get_logistic_classifier(),'Logistic Regressor')<br/>model.add_classifier(model.get_xgboost_classifier(),'XGBoost')<br/><br/>model.add_classifier(model.get_multi_perceptron(),'MLP')<br/><br/>#create a pipeline using the transformer and the above classifiers<br/>model.create_pipes(column_transformer)</span></pre><h1 id="856c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">拆分数据、K 倍和交叉验证</h1><p id="50d2" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">交叉验证是数据科学家工具箱中的一个重要工具。它允许更好地利用数据。训练集用于训练模型，验证集用于在它从未见过的数据上验证模型。我使用了 K-fold 的以下变体来提出训练和验证集。</p><p id="503e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> K-fold </strong>包括将数据集随机分成 K 个大小大致相等的组或折叠。保留第一个折叠用于测试，并在其他 k-1 个折叠上训练模型。该过程重复 K 次，每次使用不同的折叠或不同组的数据点进行验证。</p><p id="751c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当将数据拆分成多个折叠时，每个折叠都应该很好地代表整个数据。当考虑遭受类不平衡的数据时，这是重要的，就像这里正在考虑的。</p><p id="6c98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分层 K </strong> - <strong class="ih hj">褶皱</strong>通过保留每类目标的样本百分比来提供训练/验证。</p><p id="516a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将数据分别分成 64%、20%和 16%的训练集、测试集和交叉验证集。使用 K 倍从最初为 80%的训练数据中分离出验证集。我使用模型类来完成这个任务。</p><pre class="je jf jg jh fd ln lo mj mk aw ml bi"><span id="89ab" class="kx jv hi lo b fi mm mn l mo lw">#train_test split in 80:20 ratio<br/>X_train,X_test,y_train,y_test=  processor.train_test_split()</span><span id="9c83" class="kx jv hi lo b fi mp mn l mo lw">#use K-fold to split the training data in 80:20 ratio<br/>kfold = model.get_cross_validation_splitter(is_strattified = False)</span></pre><h1 id="055b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">模型比较</h1><p id="ef7b" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我使用了 model 类的 compare_models()方法来比较 4 个分类器，这 4 个分类器使用了 5 个折叠，并基于不同的评估指标取它们的平均分数。</p><p id="9785" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用 LabelBinarizer 告诉分类器目标变量的哪一类(是或否)是正的和负的。compare_models 方法需要知道哪个类是肯定的，哪个是否定的，以便根据召回率、精确度和 f1_score 来比较分类器。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="7c02" class="ls jv hi lo b be lt lu l lv lw"># Label Binarizer to identify which target class is positive<br/>lb = preprocessing.LabelBinarizer()<br/>y_train = np.array([number[0] for number in lb.fit_transform(y_train)])</span></pre><p id="f2a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我基于不同的评估标准对模型进行了评估。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="a6ad" class="ls jv hi lo b be lt lu l lv lw">#compare the models based on roc_auc<br/>models_k_fold = model.compare_models(kfold , X_train, y_train,scoring = 'roc_auc')<br/>#compare the models based on accuracy<br/>models_k_fold_accuracy = model.compare_models(kfold , X_train, y_train,scoring='accuracy')<br/>#compare the models based on recall<br/>models_k_fold_recall = model.compare_models(kfold , X_train, y_train,scoring='recall')<br/>#compare the models based on precision<br/>models_k_fold_precision = model.compare_models(kfold , X_train, y_train,scoring='precision')<br/>#compare the models based on f1_score<br/>models_k_fold_f1 = model.compare_models(kfold , X_train, y_train,scoring='f1')</span></pre><p id="3faf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型类的 compare_models()方法返回平均分数(5 倍)以及分类器的名称。我使用返回的数据创建了一个表，显示了基于不同度量的分类器的得分。</p><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="b578" class="ls jv hi lo b be lt lu l lv lw">#create a performance for each criteria based on the different metrics<br/>classifiers = models_k_fold['classifiers']<br/>scores_auc = models_k_fold['scores']<br/>scores_accuracy = models_k_fold_accuracy['scores']<br/>scores_recall = models_k_fold_recall['scores']<br/>scores_precision = models_k_fold_precision['scores']<br/>scores_f1 = models_k_fold_f1['scores']<br/>data = {'Classifier':classifiers , 'Auc':scores_auc, 'Accuracy': scores_accuracy,<br/>        'Recall':scores_recall, 'Precision':scores_precision }<br/>#change the dictionary to data frame<br/>performance_df = pd.DataFrame(data)<br/>performance_df = performance_df.set_index('Classifier')<br/>performance_df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mq"><img src="../Images/e0336ffef3b8c67259ea89b4ff6965da.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*-z6cTHKzDrpXkSMpNFccYg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用正常 K 倍的性能总结</figcaption></figure><pre class="je jf jg jh fd ln lo lp bn lq lr bi"><span id="198d" class="ls jv hi lo b be lt lu l lv lw">#create a stratified k-fold by passing True to is_strattified <br/>kfold = model.get_cross_validation_splitter(is_strattified = True)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mr"><img src="../Images/f31ede265ddff3b210a9bbebc1c80fc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*EIuLvrTDCwLybCj_dvmW0Q.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用分层 K-Fold 的性能摘要</figcaption></figure><p id="3a94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上表总结了基于每个 K 倍类型的不同度量的每个分类器的平均性能。从上表中可以看出，两种 K-Fold 类型的得分相当相同，但对于具有高度类别不平衡的数据集(如本文所考虑的数据集),依靠<strong class="ih hj">分层 K-Fold </strong>技术总是更好。</p><p id="9555" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以上每个指标都更适合不同的情况。</p><h2 id="4b62" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">评估指标选择</h2><ol class=""><li id="e71d" class="ms mt hi ih b ii ks im kt iq mu iu mv iy mw jc mx my mz na bi translated"><strong class="ih hj">准确性</strong> —正确预测的数量占所有预测的比例。</li><li id="af15" class="ms mt hi ih b ii nb im nc iq nd iu ne iy nf jc mx my mz na bi translated"><strong class="ih hj"> ROC </strong> —通过绘制不同阈值设置下的真阳性率(TPR)与假阳性率(FPR)来计算。曲线下的面积就是 ROC_Score。</li><li id="639d" class="ms mt hi ih b ii nb im nc iq nd iu ne iy nf jc mx my mz na bi translated"><strong class="ih hj">召回</strong> —量化发现的真阳性的数量</li><li id="8826" class="ms mt hi ih b ii nb im nc iq nd iu ne iy nf jc mx my mz na bi translated"><strong class="ih hj">精度</strong> —量化实际属于正类的正类预测的数量。</li></ol><p id="8400" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于数据集的不平衡性质，我选择了<strong class="ih hj"> ROC_AUC </strong>作为最可靠的指标。如果我使用准确性，即使是最差的分类器也会有很高的分数，但最终，它仍然只是一个差的分类器。</p><p id="70db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROC 分析对以少数类为代价在多数类上表现良好的模型没有任何偏见，这种属性在处理不平衡数据时非常有吸引力。</p><p id="670b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROC 能够通过研究真阳性率(TPR)和假阳性率(FPR)来实现这一点。如果 TPR 和 FPR 都在随机线以上，我们会得到一个高 ROC。</p><p id="86f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看这两个表，我观察到<strong class="ih hj"> XGBoost </strong>是 ROC_AUC 中表现最好的，得分约为 0.764。</p><h1 id="f05e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="16f9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">该项目的主要目标是能够预测哪些客户将为葡萄牙银行订阅定期存款。该项目使用了葡萄牙银行收集的数据，包括定期存款客户和未定期存款客户的资料。</p><p id="9bc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">深度解释性分析表明，数据集是高级别不平衡的受害者。它还表明星期几对预测没有太大帮助。</p><p id="e47b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 EDA 之后，数据集通过对分类变量使用一键编码器进行预处理，而对数字列使用 StandardScaler。</p><p id="c2e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我创建了由 4 个分类器组成的管道，通过使用 K-Fold 和交叉验证进行比较。</p><p id="70ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我选择 ROC_AUC 作为最可靠的评估指标，因为它对类不平衡有容忍度。基于 ROC_AUC 分数，XGBoost 分类器以大约 0.76 的分数名列前茅。</p></div><div class="ab cl ng nh gp ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="hb hc hd he hf"><h2 id="1b6f" class="kx jv hi bd jw ky kz la ka lb lc ld ke iq le lf ki iu lg lh km iy li lj kq lk bi translated">感谢</h2><p id="34df" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我把这些放在一起作为第三批<a class="ae jt" href="http://10academy.org/" rel="noopener ugc nofollow" target="_blank">10academy.org</a>培训的一部分，我想对我所有的学习伙伴和工作人员的支持表示感谢。</p><h1 id="0f31" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">参考</h1><p id="9e7b" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">[1]:<a class="ae jt" href="https://www.northridgegroup.com/blog/author/therese-fauerbach/" rel="noopener ugc nofollow" target="_blank">T3】泰蕾兹·富尔巴克 </a> <strong class="ih hj"> h </strong>。(2017 年 4 月 16 日)。<a class="ae jt" href="https://www.northridgegroup.com/blog/more-valuable-than-oil-data-reigns-in-todays-data-economy/#:~:text=Oil%20has%20reigned%20for%20centuries,it%2C%20is%20potentially%20more%20valuable." rel="noopener ugc nofollow" target="_blank">在当今的数据经济中，数据比石油更有价值</a></p><p id="6d40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://www.northridgegroup.com/blog/more-valuable-than-oil-data-reigns-in-todays-data-economy/#:~:text=Oil%20has%20reigned%20for%20centuries,it%2C%20is%20potentially%20more%20valuable" rel="noopener ugc nofollow" target="_blank">https://www . northridgegroup . com/blog/more-valued-than-Oil-data-regins-in-todays-data-economy/#:~:text = Oil % 20 已经统治了% 20 个世纪，它% 2C % 20is 是% 20 潜在% 20 更有价值的。</a></p></div></div>    
</body>
</html>