<html>
<head>
<title>Analyzing Fleet Foxes’s Top 5 Favorite Songs Using R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R分析狐狸乐队最喜欢的五首歌</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/analyzing-fleet-foxess-top-5-favorite-songs-using-r-7953daa4e403?source=collection_archive---------22-----------------------#2020-04-07">https://medium.com/analytics-vidhya/analyzing-fleet-foxess-top-5-favorite-songs-using-r-7953daa4e403?source=collection_archive---------22-----------------------#2020-04-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="e0fc" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">深入分析</h2><div class=""/><div class=""><h2 id="5052" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">基于R语言的狐狸乐队歌曲文本分析</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/c439d5d7012c320a2946ec882ef7b0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kp8mfyL-oJ8t3cGN.jpg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">狐狸乐队(2007年)</figcaption></figure><p id="9b25" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我是狐狸乐队的粉丝。我认识他们不久；我记得在<a class="ae kt" href="https://open.spotify.com/track/03CMUlyOZzrNXJnb8Vzm4l" rel="noopener ugc nofollow" target="_blank">的Spotify </a>上偶然发现了他们的热门歌曲<em class="ks">《蓝岭山脉》</em>，从那时起，这首歌、这张专辑和乐队就成了我的最爱。</p><p id="8a5b" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我喜欢狐狸乐队的一点是他们的歌词总是有着深刻的含义，有时能让我进入一个永恒的提神空间。他们的歌词充满了令人振奋的氛围和音调，但另一方面，他们的歌词也可能充满了悲伤和担忧。</p><p id="bd63" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在这篇文章中，我想探讨更多关于狐狸乐队的五首歌曲。我想知道他们是如何从每一段歌词中建立起音调和共鸣，并把它们编排成完美的旋律。我会用五首歌:<em class="ks">《蓝岭山脉》、《褴褛的树林》、《米克诺斯岛》、《白色的冬天圣歌》</em>和<em class="ks">无助蓝调</em>。</p><p id="5399" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我需要做的第一件事是准备工具，这是所有可以方便我做这个分析的包。</p><h2 id="0724" class="ku kv hi bd kw kx ky kz la lb lc ld le kf lf lg lh kj li lj lk kn ll lm ln ho bi translated">加载包。</h2><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="f814" class="ku kv hi lp b fi lt lu l lv lw">library(genius)<br/>library(tm)<br/>library(tidyverse)<br/>library(tidytext)<br/>library(magrittr)<br/>library(wordcloud)<br/>library(syuzhet)<br/>library(igraph)<br/>library(ggraph)<br/>library(readr)<br/>library(circlize)<br/>library(reshape2)</span></pre><p id="e9c3" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">如果你看到了，我正在用一个<em class="ks"> genius </em>包从genius网站导入这首歌的歌词。这是一个非常好的包，所以我不必再复制和粘贴歌词到一个文件中。</p><h2 id="8261" class="ku kv hi bd kw kx ky kz la lb lc ld le kf lf lg lh kj li lj lk kn ll lm ln ho bi translated">导入数据。</h2><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="b370" class="ku kv hi lp b fi lt lu l lv lw">song1 &lt;- genius_lyrics(artist = “Fleet Foxes”, song = “Blue Ridge Mountains”) %&gt;% mutate(artist= “Fleet Foxes”)<br/>song2 &lt;- genius_lyrics(artist = “Fleet Foxes”, song = “Mykonos”) %&gt;% mutate(artist= “Fleet Foxes”)<br/>song3 &lt;- genius_lyrics(artist = “Fleet Foxes”, song = “White Winter Hymnal”) %&gt;% mutate(artist= “Fleet Foxes”)<br/>song4 &lt;- genius_lyrics(artist = “Fleet Foxes”, song = “Helplessness Blues”) %&gt;% mutate(artist= “Fleet Foxes”)<br/>song5 &lt;- genius_lyrics(artist = “Fleet Foxes”, song = “Ragged Wood”) %&gt;% mutate(artist= “Fleet Foxes”)<br/>all_song &lt;- song1 %&gt;% bind_rows(song2) %&gt;% bind_rows(song3) %&gt;% bind_rows(song4) %&gt;% bind_rows(song5)</span></pre><p id="e179" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">一旦我完全收集了所有的五首歌，接下来我想做的事情就是统计每首歌的字数。</p><h2 id="1a5f" class="ku kv hi bd kw kx ky kz la lb lc ld le kf lf lg lh kj li lj lk kn ll lm ln ho bi translated">数数单词。</h2><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="6284" class="ku kv hi lp b fi lt lu l lv lw">all_song$length &lt;- str_count(all_song$lyric,”\\S+”)</span><span id="ca40" class="ku kv hi lp b fi lx lu l lv lw">all_song_count &lt;- all_song %&gt;% group_by(track_title, artist) %&gt;%<br/> summarise(length= sum(length))</span></pre><p id="8619" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">之后，我使用barchat可视化数据。</p><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="f2c0" class="ku kv hi lp b fi lt lu l lv lw">all_song_count %&gt;%<br/> arrange(desc(length)) %&gt;%<br/> slice(1:10) %&gt;%<br/> ggplot(., aes(x = reorder(track_title, -length), length, fill = artist)) +<br/> geom_bar(stat= ‘identity’) + # , fill= “#EF504D”<br/> ylab(“Word count”) + xlab(“Track title”) +<br/> ggtitle(“Amount of words from each songs”) +<br/> theme_minimal()</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ly"><img src="../Images/dbeb8f150d4807d2a69e817a21f685b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MBetElU2FxZUR0IS3NVUPQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">每首歌曲的字数</figcaption></figure><p id="f82d" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">如你所见，<em class="ks">无助蓝调</em>实际上比其他四首歌有更多的词。接下来我想知道的是每首歌中单词的多样性。</p><h2 id="8f34" class="ku kv hi bd kw kx ky kz la lb lc ld le kf lf lg lh kj li lj lk kn ll lm ln ho bi translated">扔掉重复的单词，使它对每首歌都是独一无二的。</h2><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="45f7" class="ku kv hi lp b fi lt lu l lv lw">tidy_lyrics &lt;- all_song %&gt;% <br/> unnest_tokens(word,lyric)</span><span id="4a1a" class="ku kv hi lp b fi lx lu l lv lw">word_diversity &lt;- tidy_lyrics %&gt;%<br/> group_by(artist,track_title) %&gt;%<br/> summarise(word_diversity = n_distinct(word)) %&gt;%<br/> arrange(desc(word_diversity))</span></pre><p id="1ef2" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">然后，想象它。</p><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="9f7c" class="ku kv hi lp b fi lt lu l lv lw">word_diversity %&gt;% <br/>  ggplot(aes(reorder(track_title, -word_diversity), word_diversity)) + geom_bar(stat = "identity", fill = my_colors) +<br/>  ggtitle("Score of diversity of the word from each songs") +<br/>  xlab("Track Title") + <br/>  ylab("") + geom_text(aes(label = word_diversity, vjust = 5)) +<br/>  scale_color_manual(values = my_colors) + theme_classic()</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lz"><img src="../Images/01e3574c0f4e23d4ebb0b9fd1c83f632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tVUflWQyvjuI38k5aTV-mQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">每首歌曲单词多样性得分</figcaption></figure><p id="4c5c" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">在我扔出重复的单词并使其完全独特(只有一个)后，如你所见，<em class="ks">蓝岭山</em>成为亚军，而<em class="ks">白色冬季圣歌</em>落到最后一名。</p><p id="0b94" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">接下来，我想知道五首歌里用的最多的词。为此，我必须转换数据(歌词)并使其尽可能干净，这样我就可以对出现频率最高的单词进行排序。</p><h2 id="ad59" class="ku kv hi bd kw kx ky kz la lb lc ld le kf lf lg lh kj li lj lk kn ll lm ln ho bi translated">使它整洁。</h2><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="8652" class="ku kv hi lp b fi lt lu l lv lw">docs &lt;- tidy_lyrics$word<br/>docs &lt;- Corpus(VectorSource(tidy_lyrics$word))<br/>toSpace &lt;- content_transformer(function (x , pattern ) gsub(pattern, “ “, x))<br/>docs &lt;- tm_map(docs, toSpace, “/”)<br/>docs &lt;- tm_map(docs, toSpace, “@”)<br/>docs &lt;- tm_map(docs, toSpace, “‘“)<br/>docs &lt;- tm_map(docs, toSpace, “‘“)<br/>docs &lt;- tm_map(docs, toSpace, “\\|”)<br/>docs &lt;- tm_map(docs, content_transformer(tolower))<br/>myStopwords &lt;- stopwords(“english”)<br/>docs &lt;- tm_map(docs, removeWords, myStopwords)<br/>dtm &lt;- TermDocumentMatrix(docs)<br/>m &lt;- as.matrix(dtm)<br/>v &lt;- sort(rowSums(m),decreasing=TRUE)<br/>d &lt;- data.frame(word = names(v),freq=v)<br/>lyrics_ff_wc &lt;- d[1:100,]</span></pre><p id="9849" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">正如你在上面看到的代码，我试着扔掉标点符号和停用词(常用词)，这样我就可以只留下歌词和文本，然后我用wordcloud可视化它。</p><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="9598" class="ku kv hi lp b fi lt lu l lv lw">wordcloud(words = lyrics_ff_wc$word, freq = lyrics_ff_wc$freq,<br/>          min.freq = 1, max.words=100, random.order=FALSE, rot.per=0.35, colors=brewer.pal(8, "Accent"))</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lz"><img src="../Images/c0f5f8499bc83dbccd94cf90ddb913cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sujTh4ghRjMpmCpqMMxujQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">狐狸乐队最常用的词</figcaption></figure><p id="6c93" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated"><strong class="jy hs"> <em class="ks">【今天】</em> </strong>是狐狸乐队在他们的歌曲中使用最多的词，但当我们再次检查时，<em class="ks"> Mykonos </em>是唯一一首出现了18次“<strong class="jy hs"> <em class="ks">【今天】</em> </strong>的歌曲，而“<strong class="jy hs"> <em class="ks">【回来】</em> </strong>一词则经常出现在热播的<em class="ks">无助蓝调</em>和<em class="ks">碎木</em>中。</p><p id="3303" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我想做的最后一件事是计算每首歌的情绪。我将使用由赛义夫·穆罕默德和彼得·特尼提出的<em class="ks"> nrc </em>词汇情感函数。</p><h2 id="9284" class="ku kv hi bd kw kx ky kz la lb lc ld le kf lf lg lh kj li lj lk kn ll lm ln ho bi translated">计算情绪。</h2><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="4f49" class="ku kv hi lp b fi lt lu l lv lw">song_wrd_count &lt;- tidy_lyrics %&gt;% count(track_title)</span><span id="5272" class="ku kv hi lp b fi lx lu l lv lw">lyric_counts &lt;- tidy_lyrics %&gt;%<br/>  left_join(song_wrd_count, by = "track_title") %&gt;% <br/>  rename(total_words=n)<br/><br/>lyric_sentiment &lt;- tidy_lyrics %&gt;% <br/>  inner_join(get_sentiments("nrc"),by="word")<br/><br/>lyric_sentiment %&gt;% <br/>  count(word,sentiment,sort=TRUE) %&gt;% <br/>  group_by(sentiment)%&gt;%top_n(n=10) %&gt;% <br/>  ungroup() %&gt;%<br/>  ggplot(aes(x=reorder(word,n),y=n,fill=sentiment)) +<br/>  geom_col(show.legend = FALSE) + <br/>  facet_wrap(~sentiment,scales="free") +<br/>  xlab("Sentiments") + ylab("Scores")+<br/>  ggtitle("Top words used to express emotions and sentiments") +<br/>  coord_flip()</span></pre><p id="224f" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">这是我得到的:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ma"><img src="../Images/24fe0fb5a5770669f7b1eb090d8f9931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJohHeJGM8TYQTR1_n4Nqg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">用来表达情感和观点的热门词汇</figcaption></figure><p id="0ae8" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我还使用了由刘兵和他的合作者使用的词典情感函数来简化判断单词是正面的(好的)还是负面的(坏的)。</p><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="5372" class="ku kv hi lp b fi lt lu l lv lw">lyric_sentiment &lt;- tidy_lyrics %&gt;% <br/> inner_join(get_sentiments(“bing”),by=”word”)<br/><br/>lyric_sentiment %&gt;% <br/> count(word,sentiment,sort=TRUE) %&gt;% <br/> group_by(sentiment)%&gt;%top_n(n=10) %&gt;% <br/> ungroup() %&gt;%<br/> ggplot(aes(x=reorder(word,n),y=n,fill=sentiment)) +<br/> geom_col(show.legend = FALSE) + <br/> facet_wrap(~sentiment,scales=”free”) +<br/> xlab(“Sentiments”) + ylab(“Scores”)+<br/> ggtitle(“Positive vs Negative words”) +<br/> coord_flip()</span></pre><p id="46f7" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">这是我得到的:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mb"><img src="../Images/023c68af224693c47f43cb0db340a864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8FUds8F9ToKfYoqq8vEaQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">积极和消极的词</figcaption></figure><p id="543d" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我最不想做的事情是让它变得更简单，所以我在消极和积极的词之间做了一个比较，然后我在wordcloud上可视化它。</p><pre class="jh ji jj jk fd lo lp lq lr aw ls bi"><span id="6db2" class="ku kv hi lp b fi lt lu l lv lw">sentiment_word_bing &lt;- tidy_lyrics  %&gt;%<br/>  inner_join(get_sentiments("bing")) %&gt;%<br/>  count(word, sentiment, sort = TRUE) %&gt;%<br/>  acast(word ~ sentiment, value.var = "n", fill = 0) %&gt;%<br/>  comparison.cloud(colors = c("#F8766D", "#00BFC4"), #c("#F8766D", "#00BFC4") max.words = 200)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mc"><img src="../Images/f2fced1605a2938cd39a0ae483b7572a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KUz6_LBlIPsutmy9rSiqwg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">消极与积极词汇对比</figcaption></figure><p id="b829" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">正如你所看到的，狐狸乐队用像<em class="ks">谎言、</em>疼痛和<em class="ks">跌倒这样的词描绘了他们歌曲的负面。另一方面，像<em class="ks">工作、光明</em>和<em class="ks">温柔</em>这样的词对他们的歌曲产生了积极的影响。</em></p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">狐狸乐队-无助蓝调(现场演出)</figcaption></figure></div></div>    
</body>
</html>