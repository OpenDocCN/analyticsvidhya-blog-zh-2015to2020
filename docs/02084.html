<html>
<head>
<title>Board Game Rating Prediction with Linear Regression &amp; Random Forest Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中基于线性回归和随机森林回归的棋牌游戏评分预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/board-game-rating-prediction-using-linear-regression-random-forest-regression-in-python-e9a63480090f?source=collection_archive---------4-----------------------#2019-11-29">https://medium.com/analytics-vidhya/board-game-rating-prediction-using-linear-regression-random-forest-regression-in-python-e9a63480090f?source=collection_archive---------4-----------------------#2019-11-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3a2ea44824849b0a5b57a85118160993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6T4pngE_AXhiE30u"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">克里斯托夫·保罗·高在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="51d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个机器学习项目是关于预测桌游的评分。数据集“games.csv”可以在这里下载<a class="ae iu" href="https://github.com/ThaWeatherman/scrapers/tree/master/boardgamegeek" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6293" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导入必要的包。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="7d92" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">import numpy as np<br/>import pandas as pd<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>import sklearn<br/>from sklearn.linear_model import LinearRegression<br/>from sklearn.metrics import mean_squared_error<br/>from sklearn import model_selection<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.ensemble import RandomForestRegressor</strong></span></pre><h2 id="8a55" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated"><strong class="ak">读取数据</strong></h2><p id="565c" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">数据被加载到“df”数据帧中。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6307" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df = pd.read_csv(‘games.csv’)</strong></span></pre><h2 id="31d1" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated"><strong class="ak">了解数据</strong></h2><p id="afd8" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">理解数据很重要，因为我们对数据有一个直观的感觉，检查丢失的值，检查不正确的数据，检查变量之间不正确的关系，这将帮助我们决定必要的预处理步骤。预处理步骤已经确定并用粗线给出。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="5673" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.shape</strong> # Displays the shape of 'df'</span></pre><p id="b85e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“df”数据帧的形状为(81312，20)，这意味着81312个事例和20列。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="bd55" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.head()</strong> # Displays first five rows of ‘df’.</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/437ccde6b7d552405cd994442d37638e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*peG8zyf521ZuQbrSwvnVnA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片中无法显示所有列。</figcaption></figure><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="5660" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.columns</strong> # Displays column names of ‘df’.</span></pre><p id="8376" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">列名为['id '，' type '，' name '，' yearpublished '，' minplayers '，' maxplayers '，' playingtime '，' minage '，' users_rated '，' average_rating '，' bayes_average_rating '，' total_owners '，T10，' total_traders '，' total_wanters '，' total_wishers '，' total_comments '，T11，' total_weights '，' average_weight']</p><p id="00cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">目标是预测棋盘游戏的“平均评级”。<strong class="ix hj">列['id '，' name' ]可以删除</strong>，因为它们不会影响“average_rating”。<strong class="ix hj">列“bayes_average_rating”也可以删除</strong>，因为它是使用“average_rating”计算的，不会影响“average_rating”。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="205c" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.nunique()</strong> # Displays total number of unique elements in each column.</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/a039e0d623fd2a84b40610ed3be75b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*ByZ55DLzS1omo-uUpdo0bw.png"/></div></figure><p id="5978" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以观察到,“类型”是唯一具有两个值的分类变量。分类变量是可以取固定数量的值之一的变量。该值可以是数字、字符串或任何其他数据类型。如果它是非数字数据类型，则它是“一个热编码”，因为在机器学习算法的输入/输出中只允许数字数据类型。一个热点编码将在后续文章中介绍。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="4ecb" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df[‘type’].unique()</strong> # Prints the unique values in ‘type’ column</span></pre><p id="b8a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“类型”列中的两个唯一值是['boardgame '，boardgameexpansion']。这些值似乎不会影响输出“average_rating ”,也没有多大用处。<strong class="ix hj">因此可以删除“类型”列。</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="79b5" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.describe()</strong> # Displays properties of each column</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/d02a6d44fb8788370bde90f1ea474792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0dr9IAd0yZVzkNQVrvYvDQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片中无法显示所有列。</figcaption></figure><p id="cbca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从“count”中可以观察到，并非所有列都有行数= 81312，这表明存在缺失值。但是与行数= 81312相比，丢失值的数量非常少。<strong class="ix hj">因此，可以删除至少有一个缺失值的所有行。</strong></p><blockquote class="lj lk ll"><p id="24f0" class="iv iw lm ix b iy iz ja jb jc jd je jf ln jh ji jj lo jl jm jn lp jp jq jr js hb bi translated">注意:-如果一列中缺少太多值，则可以删除整列。如果列中有少量缺失值，则只能删除缺失值的行。如果缺失值的数量适中(既不太高也不太低)，则必须对列进行预处理以填充空值，例如用列的平均值替换空值，或者根据列和给定的问题集进行任何其他预处理步骤。</p></blockquote><p id="c928" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还可以观察到,“users_rated”的最小值是0，这表明可能存在没有被任何用户评级的棋盘游戏。让我们来看看那些没有被任何用户评级的棋盘游戏。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="1b2b" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">plt.hist(df[‘users_rated’],range = (0,5))</strong> # Histogram of ‘users_rated’ column.</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/536fb37be6642ae23a4726185ef775d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*oqboMuojm1Nja04rxOjOLA.png"/></div></figure><p id="4206" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很大一部分桌游的“用户评分”= 0。让我们看看没有被任何用户评级的棋盘游戏的“平均评级”。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="e973" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj"><br/>df[df[‘users_rated’] == 0][‘average_rating’].describe()</strong> # Prints the properties of ‘average_rating’ column of board games which were not rated by any of the users.</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/611d5f387c15d5f3cead736f3dda17b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*y0RjdDofPviCEKBZT-PaMg.png"/></div></figure><p id="71ff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">24380个棋盘游戏没有被任何用户评级。这24380个棋盘游戏的“平均评级”的“平均值”和“标准偏差”为0，这表明<strong class="ix hj">所有未被任何用户评级的棋盘游戏的“平均评级”= 0。</strong></p><p id="a2fa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是不正确的，因为没有被评级的棋盘游戏不能被归类为差，并且不能被给予“平均评级”= 0。<strong class="ix hj">因此，将删除“users _ rated”= 0的行。</strong></p><p id="a40a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另一个观察结果是['maxplayers '，' maxplaytime']为0。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="18ef" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df[(df[‘maxplayers’] == 0) | (df[‘maxplaytime’] == 0)] </strong># Displays the rows when either of mentioned variables is 0.</span></pre><p id="df07" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有20675个这样的情况，其中至少有一个['maxplayers '，' maxplaytime]为0。这个信息应该是桌游厂商给的。一个预处理步骤是从其他来源抓取数据，并为这20675个案例中的每一个替换为['maxplayers '，' maxplaytime']的正确值。但是为了避免复杂性，我们坚持不做预处理。</p><p id="10ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我们在数据帧中有最小值和最大值，所以最好检查所有最大值是否都大于所有最小值。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9918" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df[df[‘minplayers’] &gt; df[‘maxplayers’]].count()</strong> # Displays count of rows where ‘minplayers’ &gt; ‘maxplayers’</span></pre><p id="b690" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有4020种情况下' minplayers' &gt; 'maxplayers '。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="208f" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df[df[‘minplaytime’] &gt; df[‘maxplaytime’]].count()</strong> # Displays count of rows where ‘minplaytime’ &gt; ‘maxplaytime’</span></pre><p id="b6a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有600种情况下' minplaytime' &gt; 'maxplaytime '。</p><p id="1e43" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于准备数据时出现错误，最小值大于最大值。对于上述情况，预处理步骤将是<strong class="ix hj">用‘max players’交换‘min players’，用‘max playtime’交换‘min playtime’</strong>。</p><blockquote class="lj lk ll"><p id="af0d" class="iv iw lm ix b iy iz ja jb jc jd je jf ln jh ji jj lo jl jm jn lp jp jq jr js hb bi translated">总结:-必要的预处理步骤已经确定。将删除列['id '，' name '，' bayes_average_rating '，' type']。缺少值的行将被删除。' users_rated' = 0的行将被删除。将对带有' minplayers' &gt; 'maxplayers '和' minplaytime' &gt; 'maxplaytime '的行进行交换。</p></blockquote><h2 id="9dac" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated"><strong class="ak">数据预处理</strong></h2><p id="c9c5" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">我们执行“理解数据”一节中确定的预处理步骤。</p><p id="e5eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lm"> 1。将删除列['id '，' type '，' name '，' bayes_average_rating']。</em></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="dae4" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.drop([‘id’,’type’,’name’,’bayes_average_rating’],axis = 1,inplace = True)</strong></span></pre><p id="275b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.<em class="lm">丢失值的行将被删除。</em></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="31ec" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.dropna(axis = 0,inplace = True)</strong></span></pre><p id="90a7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.<em class="lm">将删除' users_rated' = 0的行。</em></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="0c4c" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.drop(df[df[‘users_rated’] == 0].index,inplace = True)</strong></span></pre><p id="25a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.<em class="lm">将对带有‘min players’&gt;‘max players’和‘min playtime’&gt;‘max playtime’</em>的行进行交换</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="0d55" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">a = (df[‘minplayers’] &gt; df[‘maxplayers’])</strong> <br/><strong class="jy hj">df.loc[a,[‘minplayers’,’maxplayers’]] = df.loc[a, [‘maxplayers’,’minplayers’]].values</strong></span><span id="2666" class="kc kd hi jy b fi ls kf l kg kh"><strong class="jy hj">b = (df[‘minplaytime’] &gt; df[‘maxplaytime’])</strong><br/><strong class="jy hj">df.loc[b,[‘minplaytime’,’maxplaytime’]] = df.loc[b,[‘maxplaytime’,’minplaytime’]].values</strong></span></pre><h2 id="a91f" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated"><strong class="ak">可视化数据</strong></h2><p id="c30a" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">我们检查“df”中变量之间的相关性。相关性是两个随机变量之间的任何统计关系(因果或非因果)，尽管它通常指一对变量线性相关的程度。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="262f" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">plt.figure(figsize = (10,6))</strong> # Adjusting figure size.<br/><strong class="jy hj">sns.heatmap(df.corr())</strong> # Displays heatmap of correlations between variables in ‘df’.</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/9ac835f7894f56e79a4793c725004bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*fkvVofcIAZGtgr41K4jl-A.png"/></div></div></figure><p id="0c8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">浅色阴影区域高度相关。可以看出,“平均评级”与“minage”、“总次数”和“平均权重”具有较高的相关性。</p><p id="d912" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">total_owners '、' total_traders '、' total_wanters '、' total_wishers '、' total_comments '和' total_weights '在它们之间具有良好的相关性，这是可以预期的，因为这些变量中的每一个都与棋盘游戏的需求值成正比。</p><p id="d851" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“游戏时间”、“最小游戏时间”和“最大游戏时间”在它们之间具有良好的相关性，这是预期的，因为这些变量中的每一个都与棋盘游戏的游戏时间相关。</p><p id="06bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于“平均评分”与“最低”、“总人数”和“平均体重”具有相对较高的相关性，我们将重点关注这些变量。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="1706" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">sns.set(font_scale = 1.5)</strong><br/><strong class="jy hj">sns.pairplot(df[[‘minage’,’average_rating’,’total_wanters’,’average_weight’]],height = 3.5,aspect = 0.9)</strong></span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/2de5669833cfea414cfe503b79a76bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2nuP9eT7c9MMfi2UHlTSQ.png"/></div></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/a4a931d5ea6a43b67cf3e00d8a704c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r3ndv-KrrPLz61TbfTuHmg.png"/></div></div></figure><p id="1a8d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在“total_wanters”与“minage”的图表中，可以观察到对于“minage”在10到20之间的棋盘游戏，“total_wanters”较高。这意味着许多人更喜欢为青少年设计的桌游。</p><p id="1e17" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">定义了一个名为“new_users_rated”的新列。如果' users_rated' &gt; df['users_rated']，则new_users_rated' = 1。mean()否则为0。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="85f0" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df[‘new_users_rated’] = df[‘users_rated’].apply(lambda x: 1 if x&gt;df[‘users_rated’].mean() else 0)<br/>sns.scatterplot(‘average_rating’,’total_wanters’,data = df,hue = ‘new_users_rated’,legend = ‘full’)</strong></span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/30f65f601cecfaab9dbe3e5f57f4136f.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*OcUQtTAIrpMpJk2TQSHgEA.png"/></div></figure><p id="f222" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于“平均评分”在6到9之间的桌游，“用户评分”很高。对于具有大约8的“平均评级”的棋盘游戏来说,“总想要者”是高的，这是合理的，因为人们会希望拥有具有高评级的棋盘游戏。</p><blockquote class="lx"><p id="719a" class="ly lz hi bd ma mb mc md me mf mg js dx translated">单纯以收视率来比较桌游对吗？</p></blockquote><p id="532c" class="pw-post-body-paragraph iv iw hi ix b iy mh ja jb jc mi je jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">在做出决定之前，还必须考虑“用户评级”。可能是高“平均评级”的棋盘游戏的“用户评级”较少，这使得“平均评级”有偏差。</p><p id="871c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">定义了一个名为“new_users_rated”的新列。如果' users_rated' &gt; 5000，new_users_rated' = 1，否则为0。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="94a2" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df[‘new_users_rated’] = df[‘users_rated’].apply(lambda x: 1 if x&gt;5000 else 0)<br/>sns.scatterplot(‘average_rating’,’users_rated’,data = df,hue = ‘new_users_rated’)</strong></span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/566bb3a9ac02444cd5ab4a69164fef98.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*rnI-wURzTQl4HdEKXuTg7Q.png"/></div></figure><p id="94ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首选棋盘游戏将是橙色点数组中“平均评级”最高的游戏(“用户评级”&gt; 5000)。</p><h2 id="1d66" class="kc kd hi bd ki kj kk kl km kn ko kp kq jg kr ks kt jk ku kv kw jo kx ky kz la bi translated">训练模型</h2><p id="6ab1" class="pw-post-body-paragraph iv iw hi ix b iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo lf jq jr js hb bi translated">数据集已经过预处理，可以进行训练了。对两种模型进行了比较:-线性回归和随机森林回归。</p><p id="b898" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">线性回归和随机森林回归的比较</strong></p><p id="52a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基于交叉验证分数进行比较。给定的训练集被分成2个集:“训练集”和“测试集”。使用“训练集”的一部分来训练该模型。交叉验证分数是根据“Train_set”剩余部分中已训练模型的性能计算的。</p><p id="1967" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有各种各样的交叉验证技术，我们将在后面讨论。这里使用了K重交叉验证技术。</p><p id="b286" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">训练集被分成“训练集”和“测试集”。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="251d" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">X = df.drop(‘average_rating’,1)</strong> # X is input<br/><strong class="jy hj">y = df[‘average_rating’]</strong> # y is output<br/><strong class="jy hj">X_train,X_test,y_train,y_test = model_selection.train_test_split(X,y,test_size=0.2)</strong> # Spitting into ‘Train_set’ and ‘Test_set’.</span></pre><p id="7c09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">计算两个模型的交叉验证分数。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="5815" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">validation_type = model_selection.KFold(n_splits = 10)</strong> # K-Fold cross validation technique is used.<br/><strong class="jy hj">cross_validation_result1 = model_selection.cross_val_score(LinearRegression(),X_train,y_train,cv = validation_type,scoring = ‘neg_mean_squared_error’)</strong> # Cross validation score of SVC model.<br/><strong class="jy hj">cross_validation_result2 = model_selection.cross_val_score(RandomForestRegressor(),X_train,y_train,cv = validation_type,scoring = ‘neg_mean_squared_error’)</strong> # Cross validation score of KNN model.<br/><strong class="jy hj">print(cross_validation_result1.mean(),cross_validation_result2.mean())</strong></span></pre><p id="854b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">线性回归模型的交叉验证得分= -2.094</p><p id="0400" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随机森林回归模型的交叉验证分数= -1.632</p><p id="e247" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面计算了均方误差的负值。因此，线性回归模型和随机森林回归模型的均方误差分别为2.094和1.632。</p><p id="d106" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随机森林回归模型在给定数据集上的性能预期优于线性回归模型。让我们通过使用“Train_set”进行训练和使用“Test_set”进行测试来验证这一点。</p><p id="7852" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">线性回归模型的性能</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="fc2d" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">a = LinearRegression().fit(X_train,y_train)</strong> # Fitting the model.<br/><strong class="jy hj">predictions = a.predict(X_test)</strong> # Test set is predicted.<br/><strong class="jy hj">print(mean_squared_error(y_test,predictions))</strong> # Mean squared error is calculated.</span></pre><p id="5c47" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">均方差是2.083</p><p id="005e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">随机森林回归模型的性能</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9eea" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">b = RandomForestRegressor().fit(X_train,y_train) </strong># Fitting the model.<br/><strong class="jy hj">predictions = b.predict(X_test)</strong> # Test set is predicted.<br/><strong class="jy hj">print(mean_squared_error(y_test,predictions))</strong> # Mean squared error is calculated.</span></pre><p id="8007" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">均方差是1.609</p><p id="29cc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如所料，对于给定的数据集，随机森林回归模型的性能优于线性回归模型。<strong class="ix hj">这是因为桌游数据集非常大，线性回归模型很难用直线拟合数据。</strong></p><p id="d6f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">使用训练模型进行预测</strong></p><p id="fde0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">经过训练的随机森林回归模型用于预测从数据集中随机选择的2个棋盘游戏的“平均评级”。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="c3d8" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">prediction = b.predict(df.iloc[[42,97]].drop(‘average_rating’,1))<br/>print(prediction)</strong></span></pre><p id="fe66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据集中第42和第97个棋盘游戏的预测“平均评级”为[7.793971 7.683359]。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="1a23" class="kc kd hi jy b fi ke kf l kg kh"><strong class="jy hj">df.iloc[[42,97]][‘average_rating’] # Actual average ratings.</strong></span></pre><p id="13ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据集中第42和第97个棋盘游戏的实际“average_ratings”为[7.86088 7.67833]。</p><p id="3bed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">预测的“平均评级”非常接近实际的“平均评级”。随机森林回归模型训练得很好。</p><p id="e204" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">快乐阅读！</p></div></div>    
</body>
</html>