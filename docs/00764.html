<html>
<head>
<title>Validating SQL and NoSQL data models with python and Cerberus.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用python和Cerberus验证SQL和NoSQL数据模型。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/validating-sql-and-nosql-data-models-with-python-and-cerberus-for-a-tornado-pythononwheels-web-6fa9c7d9991d?source=collection_archive---------9-----------------------#2019-09-04">https://medium.com/analytics-vidhya/validating-sql-and-nosql-data-models-with-python-and-cerberus-for-a-tornado-pythononwheels-web-6fa9c7d9991d?source=collection_archive---------9-----------------------#2019-09-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/44fae66ec7fc047341f266c9f6266676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4o_-w0QUopQrtUMfQ11AA.png"/></div></div></figure><p id="08df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个简短的(动手)教程中，我将向您简单介绍如何使用伟大的C <a class="ae jo" href="https://docs.python-cerberus.org/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> erberus </a>库来定义和验证python中的数据模型。我将使用<a class="ae jo" href="https://www.pythononwheels.org/" rel="noopener ugc nofollow" target="_blank">python wheels</a>框架来轻松生成模型，但是Cerberus模式和验证也可以在没有python wheels的情况下工作。</p><h2 id="ad16" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">这个地狱犬是什么东西？</h2><blockquote class="kk kl km"><p id="061e" class="iq ir kn is b it iu iv iw ix iy iz ja ko jc jd je kp jg jh ji kq jk jl jm jn hb bi translated"><a class="ae jo" href="https://docs.python-cerberus.org/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Cerberus </a>是一个轻量级和可扩展的Python数据验证库</p></blockquote><p id="d583" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它非常方便和有用，使得定义模式(包括属性名、数据类型和验证规则)变得非常简单。因为这是在应用程序中处理数据的一种非常方便的方式:</p><h2 id="4395" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">这是什么东西？</h2><blockquote class="kk kl km"><p id="0c15" class="iq ir kn is b it iu iv iw ix iy iz ja ko jc jd je kp jg jh ji kq jk jl jm jn hb bi translated">PythonOnWheels是围绕一些现有的伟大的库/模块和工具的一层胶水，使您的python生活对于枯燥的任务来说更加容易。</p></blockquote><p id="3ec3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为它是pythonic语言，超级容易使用并且非常有用</p><blockquote class="kk kl km"><p id="8ac6" class="iq ir kn is b it iu iv iw ix iy iz ja ko jc jd je kp jg jh ji kq jk jl jm jn hb bi translated">PythonOnWheels对所有模型定义都使用Cerberus模式，不管是SQL还是NoSQL</p></blockquote><p id="ba17" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这不仅为您带来了对NoSQL和所有SQL数据库使用相同模型定义模式的好处，还意味着您可以对每个模型进行验证，并且您可以轻松地从SQL转换到NoSQL</p><h2 id="103c" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">要完成动手部分，您可以使用PythonOnWheels</h2><p id="29e7" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">如果您不知道如何:</p><ul class=""><li id="1f75" class="kw kx hi is b it iu ix iy jb ky jf kz jj la jn lb lc ld le bi translated">安装PythonOnWheels阅读超短<a class="ae jo" href="https://www.pythononwheels.org/gettingstarted" rel="noopener ugc nofollow" target="_blank">入门</a></li><li id="ca98" class="kw kx hi is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated">生成一个新的应用程序(在本教程中，我将我的应用程序称为testapp)</li></ul><h2 id="da95" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">没有PythonOnWheels也可以跟着教程走。</h2><p id="e823" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">在这种情况下，您需要安装Cerberus(并创建一个验证程序，见下文)</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="5129" class="jp jq hi lp b fi lt lu l lv lw">$ pip install cerberus</span></pre><p id="9620" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，您可以像这样验证模式(只需剪切并粘贴到您的python解释器中)</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="95f4" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; schema={ .... take some sample schema from below ... }<br/>&gt;&gt;&gt; d={}                  # create a dict (instead of a real model)<br/>&gt;&gt;&gt; d["title"] = "test"   # set some attribures<br/>&gt;&gt;&gt; from cerberus import Validator<br/>&gt;&gt;&gt; v=Validator()<br/>&gt;&gt;&gt; v.schema=schema<br/>&gt;&gt;&gt; v.validate(d)<br/>True<br/>&gt;&gt;&gt;</span></pre><h2 id="1188" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">让我们从行动开始:</h2><p id="fbfc" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">对于本教程，我生成了一个<a class="ae jo" href="https://tinydb.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"><em class="kn">tiny DB</em></a>(NoSQL DB)模型，如下所示:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="129d" class="jp jq hi lp b fi lt lu l lv lw">python generate_model.py -n todo -t tinydb</span></pre><p id="e4f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">TinyDB是一个超小的基于文件的文档数据库(NoSQL)。你可以把它想象成NoSQL的SQlite).</p><p id="049f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是生成的模型模式的样子:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="15a2" class="jp jq hi lp b fi lt lu l lv lw"># <br/># TinyDB Model:  Todo <br/># <br/>from testapp.models.tinydb.tinymodel import TinyModel <br/>class Todo(TinyModel): <br/>    # <br/>    # Use the cerberus schema style  <br/>    # <br/>    schema = { <br/>        'title' :   { 'type' : 'string', 'maxlength' : 35 }, <br/>        'text'  :   { 'type' : 'string' }, <br/>        'tags'  :   { 'type' : 'list', "default" : [] }, <br/>        "votes" :   { "type" : "integer", "default" : 0 }    <br/>        }</span></pre><blockquote class="kk kl km"><p id="e3bc" class="iq ir kn is b it iu iv iw ix iy iz ja ko jc jd je kp jg jh ji kq jk jl jm jn hb bi translated">备注:PythonOnWheels SQL模型将使用完全相同的定义语法。</p></blockquote><p id="3799" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，使用我们的cerberus模式，我们可以:</p><ul class=""><li id="fb6d" class="kw kx hi is b it iu ix iy jb ky jf kz jj la jn lb lc ld le bi translated">定义您的属性及其数据类型(例如“标题”、“类型”:“字符串”)</li><li id="6846" class="kw kx hi is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated">定义属性约束和验证规则(" maxlength"=35)</li><li id="e661" class="kw kx hi is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated">所有这些都是使用广泛使用的python库以简洁和成熟的方式完成的。</li><li id="2bd4" class="kw kx hi is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated">并对SQL和NoSQL模型使用相同的模型定义模式。</li></ul><h1 id="809b" class="lx jq hi bd jr ly lz ma jv mb mc md jz me mf mg kc mh mi mj kf mk ml mm ki mn bi translated">PythonOnWheels在幕后做什么</h1><p id="5ef0" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">基于Cerberus模式，PythonOnWheels为您生成不同数据库所需的实际模型表示。所以当你像上面那样定义一个模型的时候。PoW在后台生成正确的mongoDB、tinyDB、SQL (sqlalchemy)或弹性模式，这些模式实际上是用来与您选择的数据库一起工作的。</p><blockquote class="kk kl km"><p id="9648" class="iq ir kn is b it iu iv iw ix iy iz ja ko jc jd je kp jg jh ji kq jk jl jm jn hb bi translated">但是因为这都是关于验证的，所以我们不关心下面的内容。</p></blockquote><h1 id="8fbf" class="lx jq hi bd jr ly lz ma jv mb mc md jz me mf mg kc mh mi mj kf mk ml mm ki mn bi translated">所以让我们使用验证</h1><p id="dd94" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">让我们再次看看我们的模型的模式定义，因为验证使用我们的定义来检查一个实际的模型实例是否正确。</p><h1 id="0606" class="lx jq hi bd jr ly lz ma jv mb mc md jz me mf mg kc mh mi mj kf mk ml mm ki mn bi translated">修改模式，如下所示:</h1><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="796e" class="jp jq hi lp b fi lt lu l lv lw">schema = {         <br/>        'title' :   { 'type' : 'string', 'maxlength' : 35 }, <br/>        'text'  :   { 'type' : 'string' }, <br/>        "status":   { "type" : "string", "default" : "new",   <br/>                      "allowed" : ["new", "wip", "done", "hold"]}, <br/>        "votes":   { "type" : "integer", "default" : 0 }   <br/>    }</span></pre><p id="9a4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了简化这一点，只需复制并替换整个模式。</p><p id="ea5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但我们只是将<em class="kn">标签</em>重命名为<em class="kn">状态</em>，并添加了“允许”:[“新”、“在制品”、“完成”、“暂挂”]定义。</p><p id="75d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它看起来是这样的:(在浏览器中，您可以看到models/tinydb/todo.py的路径)</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/3686bcc33c8f36fe5a6a79fbc500738a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZqCrCXd7T_DMGGxEMhiOmQ.png"/></div></div></figure><h1 id="8996" class="lx jq hi bd jr ly lz ma jv mb mc md jz me mf mg kc mh mi mj kf mk ml mm ki mn bi translated">属性名称和类型</h1><p id="7b41" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">可以看到我们定义了四个属性<strong class="is hj"> <em class="kn">，分别命名为:标题</em> </strong>、<strong class="is hj"> <em class="kn">文本</em> </strong>、<strong class="is hj"> <em class="kn">状态</em> </strong>和<strong class="is hj"> <em class="kn">票数。</em> </strong>另外我们还定义了他们的类型。其中三个是<strong class="is hj"> <em class="kn">字符串</em> </strong>，只有<strong class="is hj"> <em class="kn">分</em> </strong>属性是<strong class="is hj"> <em class="kn">整型</em> </strong>。</p><h1 id="9a23" class="lx jq hi bd jr ly lz ma jv mb mc md jz me mf mg kc mh mi mj kf mk ml mm ki mn bi translated">属性约束</h1><p id="b9a1" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">对于一些属性，在本例中<strong class="is hj"> <em class="kn">标题</em> </strong>和<strong class="is hj"> <em class="kn">状态</em> </strong>我们还定义了<strong class="is hj">约束</strong>。约束基本上只是缩小了属性类型的允许值。</p><p id="9b6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于<strong class="is hj">标题属性</strong>,类型必须是一个字符串，约束条件是它不能超过35个字符。</p><p id="61ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">状态属性</strong>也必须是字符串类型，但它也只验证字符串是否是允许的类型之一:“新”、“wip”、“完成”或“保持”。</p><p id="18f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于我们使用Cerberus，您可以依赖更多可能的约束定义。只需<a class="ae jo" href="http://docs.python-cerberus.org/en/stable/validation-rules.html" rel="noopener ugc nofollow" target="_blank">阅读完整的验证规则文档</a>。</p><h1 id="cf6d" class="lx jq hi bd jr ly lz ma jv mb mc md jz me mf mg kc mh mi mj kf mk ml mm ki mn bi translated">让我们测试一个真实的模型实例</h1><p id="1663" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">启动python解释器并导入模型。如果你不知道如何生成PythonOnWheels应用程序<a class="ae jo" href="https://www.pythononwheels.org/article/7de74cc6-8af2-45ac-b619-eea61e4da44f" rel="noopener ugc nofollow" target="_blank">，请阅读2分钟简介</a>。参见上文如何生成模型。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="1453" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; from testapp.models.tinydb.todo import Todo</span></pre><h2 id="a1aa" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">创建实例</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="c603" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t=Todo()</span></pre><h2 id="7a49" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">让我们回顾一下状态属性的模式:</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="38d5" class="jp jq hi lp b fi lt lu l lv lw">"status":   { "type" : "string", "default" : "new", "allowed" : ["new", "wip", "done", "hold"]},</span></pre><p id="f24a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如你所知，这将<strong class="is hj"> <em class="kn">状态</em> </strong>定义为类型<em class="kn">字符串</em><strong class="is hj"/>只接受允许的值，在这种情况下:<em class="kn">新，wip </em>，<em class="kn">完成</em>和<em class="kn">保持</em>。任何其他值都将被验证为假。</p><h2 id="7f15" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">让我们展示一下t实例的样子:(默认情况下)</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="6fc8" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t <br/>{ '_uuid': '', <br/> 'created_at': datetime.datetime(2019, 9, 4, 21, 25, 10, 6827), <br/> 'id': '', <br/> 'last_updated': datetime.datetime(2019, 9, 4, 21, 25, 10, 6827), <br/> 'status': 'new', <br/> 'text': '', <br/> 'title': '', <br/> 'votes': 0}</span></pre><p id="006a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以看到PythonOnWheel添加了一些额外的参数(created_at、last_updated和_ uuid ), status的默认值是“new ”, votes的默认值是0。正如定义的那样。</p><h2 id="6ccb" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">所以让我们验证一下这个模型，看看它是否被接受</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="49be" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t.validate()<br/>True</span></pre><p id="cf40" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">模型的validate()方法返回True，表示验证成功，否则返回False。</p><h2 id="7bae" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">让我们改变一些属性</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="ed42" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; <!-- -->t.title="123456789012345678901234567890123456"<br/>&gt;&gt;&gt; t.status="yihaa"</span></pre><h2 id="d701" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">再次验证模型，看看它是否被接受</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="9b60" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t.validate()<br/>False</span></pre><p id="ff69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好吧，这次验证失败。那么，我们如何才能发现到底哪里出了问题呢？</p><h2 id="3347" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">检查验证结果</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="3fff" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t.validator.errors<br/>{'status': ['unallowed value yihaa'], 'title': ['max length is 35']}</span></pre><p id="aac0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">只需访问模型验证器的<strong class="is hj"> <em class="kn"> errors </em> </strong>属性，查看哪些验证规则失败了。这也是自动返回简单错误消息的一种非常好的方式，例如对于web表单或JSON响应。</p><h2 id="e6f5" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">现在让我们修复错误，看看我们是否可以验证为真</h2><ul class=""><li id="85fc" class="kw kx hi is b it kr ix ks jb mp jf mq jj mr jn lb lc ld le bi translated">将<strong class="is hj">状态</strong>更改为<em class="kn">允许的</em>，例如“完成”</li><li id="31dd" class="kw kx hi is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated">将<strong class="is hj">标题</strong>改为少于35个字符的内容。</li></ul><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="4534" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t.title="test"<br/>&gt;&gt;&gt; t.status="done"</span></pre><h2 id="49ef" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">让我们再检查一遍</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="cd54" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t.validate() <br/>True</span></pre><h2 id="58b8" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">太好了，现在我们的todo通过了验证。</h2><p id="ce77" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">这就是了。我们定义了模型、属性类型和验证规则(约束)，并对它们进行了验证。我们还学习了如何发现我们犯的具体错误。</p><p id="dac9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以用地狱犬做更多的事情。你可以用PythonOnWheels做更多的事情。但是对于我的用例，我主要需要基本的东西，这已经很有帮助了。</p><h2 id="3ca5" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">摘要</h2><p id="181e" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">我希望您同意，使用Cerberus模式使以优雅的方式定义数据库模型变得非常容易，而且也给我们带来了很多验证方面的好处。</p><p id="1599" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">模式语法非常简单，使用python中可用的数据类型，并且容易记住诸如“allowed”、“maxlength”、“anyof”等约束。<a class="ae jo" href="https://docs.python-cerberus.org/en/stable/validation-rules.html" rel="noopener ugc nofollow" target="_blank">参见此处的Cerberus验证规则文档</a>。</p><h2 id="fc16" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">因此，现在我们终于可以将模型安全地保存到数据库中了</h2><p id="3854" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">这在穿PythonOnWheels的时候相当容易。做个upsert()就行了。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="3a55" class="jp jq hi lp b fi lt lu l lv lw">&gt;&gt;&gt; t.upsert()<br/>insert, new eid: 1</span></pre><p id="9f6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">搞定了。；)</p><p id="a8a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想阅读更多关于数据、数据库和PythonOnWheels中的模型处理的内容，我推荐您阅读这些简短的实践教程。(大约5-10分钟)</p><ul class=""><li id="5002" class="kw kx hi is b it iu ix iy jb ky jf kz jj la jn lb lc ld le bi translated"><a class="ae jo" href="https://www.pythononwheels.org/article/c925b701-b965-461a-ab51-672dfc08aef6#generatingmodels" rel="noopener ugc nofollow" target="_blank">生成模型(SQL，NoSQL) </a></li><li id="99af" class="kw kx hi is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated">或者查看<a class="ae jo" href="https://www.pythononwheels.org/documentation" rel="noopener ugc nofollow" target="_blank">文档</a>中的型号部分</li></ul><p id="1b5d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望你喜欢教程和PythonOnWheels。如果你有任何问题或评论或错误，你可以在<a class="ae jo" href="https://github.com/pythononwheels/pow_devel" rel="noopener ugc nofollow" target="_blank"> github </a>上提出问题，或者发推特到<a class="ae jo" href="https://twitter.com/pythononwheels" rel="noopener ugc nofollow" target="_blank"> @pythononwheels </a>。</p></div></div>    
</body>
</html>