<html>
<head>
<title>101 of Text Analysis and Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">101对文本的分析和分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/101-of-text-analysis-and-classification-67dbc9a82f?source=collection_archive---------12-----------------------#2020-04-25">https://medium.com/analytics-vidhya/101-of-text-analysis-and-classification-67dbc9a82f?source=collection_archive---------12-----------------------#2020-04-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ae92" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">开始使用Python进行文本分析所需要知道的一切</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/61d1d0fd2f54ac0c706d0fb70c73762f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1l7dcWk9ZufYYAFzJqVzA.jpeg"/></div></div></figure><p id="a519" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们生活在一个有趣的时代。组织正在演变为在其运营中对数据进行灌洗。尽管不是全部，但大多数人都在逃避直觉决策，而接受基于数据的决策。各行业开始意识到，数据是推动其运营和市场战略以获得巨大利润所需的新燃料。全球咨询巨头麦肯锡指出，“数据驱动的组织获得客户的可能性是23倍，保留这些客户的可能性是6倍，因此盈利的可能性是19倍。”我参加过几次数据峰会，与几位企业高管有过互动。我敏捷地注意到他们偶尔会抛出一些引用，比如:“我们相信上帝，所有其他人都会带来数据”，“数据是新的石油”，“没有大数据，你会变得又盲又聋，还在高速公路上”，“数据战胜了情绪”，“最重要的是，展示数据”等等。关键是，我们不再处于数据科学是个谜的时代。如今市场上的巨大差异是对运营和客户数据的掌握。谁了解客户数据，谁就能更好地赢得客户。</p><p id="a139" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在这个行业快速发展的时代，要想成为一名数据科学家，流畅地处理结构化和非结构化数据是必须的，也是不可避免的。我喜欢把数据想象成一条高速公路，把数据科学想象成带我到达目的地的汽车——解决一个商业问题。你对道路越熟悉，你的旅程将会越顺畅和快速。请记住，数据科学的主要目标是构建从数据中提取以业务为中心的洞察力的方法。不用说，花哨的数据总是胜过花哨的算法。</p><h2 id="5352" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">结构化数据和非结构化数据有什么区别？</h2><p id="d253" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">结构化数据是最常见的数据类型。正如您可以从名称中推断的那样，结构化数据是一种格式良好且高度组织化的数据类型。此数据类型符合表格格式，具有清晰的带标签的列和行。在很多情况下，术语“结构化”是指通常所说的定量数据。处理结构化数据和运行一些分析算法非常简单。成千上万的免费在线学习资源。</p><p id="cba9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">另一方面，非结构化数据是没有整齐地组织或格式化的信息。维基百科将非结构化数据定义为没有预定义的数据模型或者没有以预定义的方式组织的信息。非结构化信息通常以文本为主，但也可能包含日期、数字和事实等数据。非结构化数据的常见示例包括pdf、Word文件、音频、视频文件或非SQL数据库。</p><p id="9c1b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这篇博客将向您介绍一些有价值的分析和机器学习技术，您需要掌握这些技术才能顺利地介绍文本分析。玩得开心，享受😊😊</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="5704" class="lm kg hi bd kh ln lo lp kl lq lr ls kp io lt ip ks ir lu is kv iu lv iv ky lw bi translated">什么是自然语言处理？</h1><p id="d4ca" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">我可以简单地定义自然语言处理，通常被称为NLP，作为数据科学的一个分支，帮助计算机处理、分析和操纵人类的自然语言。NLP试图在人类交流和计算机理解之间架起一座桥梁。NLP的发展可以追溯到20世纪50年代，尽管由于人类对机器通信的兴趣增加以及大数据和增强算法的可用性，它在现代已经快速发展。</p><p id="8fe1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">虽然这个领域非常有趣，但我不得不承认，训练一台机器理解我们如何交流并不是一件容易的事情。</p><h1 id="6f51" class="lm kg hi bd kh ln lx lp kl lq ly ls kp io lz ip ks ir ma is kv iu mb iv ky lw bi translated">自然语言处理的使用</h1><p id="2e88" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">NLP的应用广泛贯穿于所有产生和使用大数据的行业。基本上，NLP是所有虚拟助手、语音转文本、聊天机器人、基于计算机的翻译等等背后的技术。下面是NLP在现代商业世界中的一些常见用法。你可以在这里阅读更多关于同一<a class="ae mc" href="https://becominghuman.ai/8-thought-provoking-cases-of-nlp-and-text-mining-use-in-business-60bd8031c5b5" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><ul class=""><li id="75fa" class="md me hi jl b jm jn jp jq js mf jw mg ka mh ke mi mj mk ml bi translated">聊天机器人</li><li id="3330" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">情感分析</li><li id="8529" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">雇用和招聘</li><li id="0706" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">广告</li><li id="0173" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">市场情报</li></ul></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><p id="6e22" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在这篇博客中，我们将会处理一组被归类为垃圾邮件的信息。目标是研究数据，然后创建准确的分类模型来识别邮件是否是垃圾邮件。你可以在这里 下载数据集<a class="ae mc" href="https://www.kaggle.com/uciml/sms-spam-collection-dataset" rel="noopener ugc nofollow" target="_blank"> <em class="mr">！</em></a></p><h1 id="3aed" class="lm kg hi bd kh ln lx lp kl lq ly ls kp io lz ip ks ir ma is kv iu mb iv ky lw bi translated">1.加载所需的包</h1><ul class=""><li id="75cf" class="md me hi jl b jm la jp lb js ms jw mt ka mu ke mi mj mk ml bi translated"><a class="ae mc" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hj">自然语言工具包</strong></a><strong class="jl hj">(NLTK)</strong>——这是python中自然语言处理的领先模块。它提供了易于使用的接口和非常丰富的库和函数。</li><li id="3c83" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated"><strong class="jl hj">停用词- </strong>停用词是常用词，对一个句子或我们的模型没有多大意义，“the”、“a”、“is”、“on”。停用词模块包含所有的英语停用词，我们将训练我们的模型忽略这些停用词。</li><li id="ed99" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated"><a class="ae mc" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank"><strong class="jl hj">sk learn</strong></a><strong class="jl hj">-</strong>sk learn是python中最流行的机器学习和预测分析模块。它在准备要素、创建监督和非监督模型以及测量模型性能方面提供了广泛的功能。</li><li id="769f" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated"><a class="ae mc" href="https://python-graph-gallery.com/wordcloud/" rel="noopener ugc nofollow" target="_blank"><strong class="jl hj">word cloud</strong></a><strong class="jl hj">-</strong>这是我们将用来创建数据文本的一些可视化表示的包。</li><li id="3621" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated"><strong class="jl hj"> Pandas和Numpy- </strong>我们要求这两个包能够处理数据帧。</li><li id="8a8d" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated"><a class="ae mc" rel="noopener" href="/@muturidavid8/python-visualization-101-3aee09809100"> <strong class="jl hj"> Matplotlib和Seaborn </strong> </a> <strong class="jl hj"> - </strong>这是python中的绘图包。我已经在这个酷博客<a class="ae mc" rel="noopener" href="/@muturidavid8/python-visualization-101-3aee09809100"> <strong class="jl hj"> <em class="mr">里全面的讨论过了！</em> </strong> </a></li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mv"><img src="../Images/abae30cd1abefc3f5299fb28db366b62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0XO3hBZvVjlSx1sUR2vDg.png"/></div></div><figcaption class="mw mx et er es my mz bd b be z dx translated">文本分析的必备包</figcaption></figure><h1 id="70a4" class="lm kg hi bd kh ln lx lp kl lq ly ls kp io lz ip ks ir ma is kv iu mb iv ky lw bi translated">2.加载和准备数据</h1><p id="3a63" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">我们使用熊猫来加载和整理数据集。</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="47d3" class="kf kg hi nb b fi nf ng l nh ni">## Importing the dataset<br/>df=pd.read_csv("spam.csv",encoding="latin-1")<br/>df.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nj"><img src="../Images/743a21e024fd1643e81f5f112f3300b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*RcTkEk--d-OofSm3vK9G-w.png"/></div><figcaption class="mw mx et er es my mz bd b be z dx translated">数据集的前5行</figcaption></figure><p id="7132" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">嗯，我们需要做一些事情来组织我们的数据并为分析做好准备。</p><ul class=""><li id="0089" class="md me hi jl b jm jn jp jq js mf jw mg ka mh ke mi mj mk ml bi translated">去掉带有<code class="du nk nl nm nb b">NaN</code>值的未命名列</li><li id="9229" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">重命名列</li><li id="f97f" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">然后添加一列标签，其中<strong class="jl hj"> 0 </strong>代表火腿，<strong class="jl hj"> 1 </strong>代表垃圾邮件</li></ul><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="450d" class="kf kg hi nb b fi nf ng l nh ni">## Droping the unceccesary columns and renaming <br/>df.drop(["Unnamed: 2","Unnamed: 3","Unnamed:4"],axis=1,inplace=True)<br/>df.columns=["Class","Text"]<br/>df["Lable"]=df.Class.map({"ham":0,"spam":1})<br/>df.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nn"><img src="../Images/53db56a426a4a0944400b2646b95edd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*8wI6jGanDymhHjfXIJ0-Ew.png"/></div></figure><h1 id="a705" class="lm kg hi bd kh ln lx lp kl lq ly ls kp io lz ip ks ir ma is kv iu mb iv ky lw bi translated">3.探索数据</h1><p id="2aaa" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">现在我们的数据已经组织好了，我们可以执行一些探索性的分析。<br/>让我们通过使用<code class="du nk nl nm nb b">describe</code>功能来查看每个类别的频率汇总。</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="645d" class="kf kg hi nb b fi nf ng l nh ni">df.groupby('Class').describe(include='O')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es no"><img src="../Images/b28d44fc5845a8c74899542deac8eaff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*2_9jSEgzgyH9Rw_1Hvieow.png"/></div></figure><p id="5ec2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们有4825行被归类为ham消息，其中有4516行是不重复的。垃圾邮件有747条，其中653条是唯一的。我们可以使用<code class="du nk nl nm nb b">seaborn countplot </code>功能来可视化频率。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es np"><img src="../Images/7501de2101d6078a86d1b4582a0fb325.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*vm2j4HerSrBm0lBVgUVQIw.png"/></div></figure><h2 id="cf99" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">统计每篇文章中的常用词</h2><p id="d51a" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">我们想知道哪些词在垃圾短信中常见，哪些词在垃圾短信中常见。在我们创建单词frequent summary之前，我们需要清理数据。我说的清洁是指:</p><ul class=""><li id="00fd" class="md me hi jl b jm jn jp jq js mf jw mg ka mh ke mi mj mk ml bi translated">把所有的句子分解成单词</li><li id="212f" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">去掉标点符号</li><li id="911c" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">将所有单词转换成小写</li><li id="7c80" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">去掉停用词和所有少于两个字符的词。</li></ul><p id="d989" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们创建一个<code class="du nk nl nm nb b">words_cleaner</code>函数，其中一个参数<code class="du nk nl nm nb b">data</code>被清理，并返回一组干净的单词。</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="738e" class="kf kg hi nb b fi nf ng l nh ni">def words_cleaner(data):<br/>    words=[re.sub('[^a-zA-Z]', ' ',i) for i in df['Text']]<br/>    words=[i.lower() for j in data for i in j.split()<br/>    words=[i for i in words if not i in   set(stopwords.words('english'))]<br/>    words=[i for i in words if len(i)&gt;2]<br/>    return words</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nq"><img src="../Images/2367bb06189b0017f813e7ee97664355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g_CtixAcqQAyosHt1qpGJw.png"/></div></div><figcaption class="mw mx et er es my mz bd b be z dx translated">Words_cleaner函数</figcaption></figure><p id="dac2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在，我们可以提取ham消息中的所有单词，并创建它们频率的数据帧。</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="ef16" class="kf kg hi nb b fi nf ng l nh ni">Ham_texts=df.query("Class=='ham'")['Text']<br/>ham_words=words_cleaner(Ham_texts)<br/>ham_words_freq=nltk.FreqDist(ham_words)<br/>ham_words_freq=pd.DataFrame(ham_words_freq.most_common(10),<br/>                            columns=['Top_Words','Frequency'])</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nr"><img src="../Images/a27ac30d771448e65221cbcbff2aa163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H3bfVn3EzjsLRxXAAcJhUw.png"/></div></div></figure><p id="ce39" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">完美！现在我们有了一个在业余爱好者信息中最常用的10个单词的数据框架。我们现在可以创建一个柱状图来直观显示频率。</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="6941" class="kf kg hi nb b fi nf ng l nh ni">plt.figure(figsize=(8,6))<br/>sns.set_style('whitegrid')<br/>ax=sns.barplot(x='Top_Words',y='Frequency',data=ham_words_freq)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ns"><img src="../Images/c238d8c51a14f028ab5ee9c89b764db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*dRTgtqJjPs54_tmXMxi7zg.png"/></div><figcaption class="mw mx et er es my mz bd b be z dx translated">火腿信息中最常用的词。</figcaption></figure><p id="8b39" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">是的，我知道，太酷了！😎现在，您可以对垃圾邮件进行同样的操作。</p><h2 id="b174" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">创建思维导图</h2><p id="ef18" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">为了全面了解这两个类中的词频，我们可以利用词云。用python创建单词云非常容易，我们只需要创建一个带有两个参数的函数——数据和背景颜色——然后返回一个单词云。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nt"><img src="../Images/2fe317129d4a9de146de283c85da0e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*iNkqn6IeQDFPyOFGa0Y7NA.png"/></div><figcaption class="mw mx et er es my mz bd b be z dx translated">创建单词云的功能</figcaption></figure><h2 id="7622" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">火腿消息词云</h2><p id="17a4" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">现在我们有了一个创建单词云的函数，只需要一行代码就可以返回单词云。在词云中，越大的词出现的频率越高。</p><p id="5601" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><code class="du nk nl nm nb b">wc(words_cleaner(Spam_texts),’black’)</code></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nu"><img src="../Images/193c1bd31c5d34076449434867c213fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*76lAY9GdOmMipthdt7vghw.png"/></div><figcaption class="mw mx et er es my mz bd b be z dx translated">火腿消息词云</figcaption></figure><h2 id="94c9" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">垃圾短信</h2><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="2483" class="kf kg hi nb b fi nf ng l nh ni">wc(words_cleaner(Spam_texts),'black')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nv"><img src="../Images/fb469719ac3f4caa2be82683aa4157f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*cmv-ieULKHskLaRS1SRJNQ.png"/></div><figcaption class="mw mx et er es my mz bd b be z dx translated">垃圾短信的词云</figcaption></figure><p id="1300" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">垃圾短信大多包含免费、通话、短信、手机、认领、立即通话等词语。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="3b1b" class="lm kg hi bd kh ln lo lp kl lq lr ls kp io lt ip ks ir lu is kv iu lv iv ky lw bi translated">机器学习</h1><p id="199a" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated"><strong class="jl hj">创建模型，将邮件分类为垃圾邮件或垃圾邮件。</strong></p><p id="5d5b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在创建分类器之前，我们需要清理我们的特征/独立变量，即(文本列)。为了清洁我们的功能，我们将遵循以下简单的程序:</p><ul class=""><li id="9b18" class="md me hi jl b jm jn jp jq js mf jw mg ka mh ke mi mj mk ml bi translated">删除每条短信中的所有标点符号</li><li id="4a3b" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">将文本消息转换为小写</li><li id="ba7f" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">将每封邮件拆分成单个单词</li><li id="197c" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">删除所有停用词</li><li id="b928" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">使用<code class="du nk nl nm nb b">PorterStemmer </code>功能对单词进行词干处理。这包括将每个单词切割成其词根形式。例如，这些单词的词干:<em class="mr">【汽车，汽车，汽车的，汽车的】</em>是<strong class="jl hj"> <em class="mr">汽车。</em> </strong> <em class="mr">一词干为</em><em class="mr">loving，【爱，可爱的爱人】</em><em class="mr">为</em> <strong class="jl hj"> <em class="mr"> Lov </em> </strong></li><li id="9851" class="md me hi jl b jm mm jp mn js mo jw mp ka mq ke mi mj mk ml bi translated">我们把清理过的单词连接成句子。</li></ul><p id="8140" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为了实现这一点，我们将创建一个函数，通过一次清理一条消息来循环遍历我们的数据，然后返回一个清理后的单词数组。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nw"><img src="../Images/d06a7c2fb37b72051ef830dc12e07731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPo-_3fFRYNfnhBHE6UUCw.png"/></div></div><figcaption class="mw mx et er es my mz bd b be z dx translated">清理数据中所有要素的函数</figcaption></figure><p id="28d7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">查看数据集清理后的外观</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nx"><img src="../Images/eadaa46da379b51afde0e2e3d61bd9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*cCA2oRfUDFLhZLgzftrrMw.png"/></div><figcaption class="mw mx et er es my mz bd b be z dx translated">原始数据的前3条消息以及清理后的相同消息。</figcaption></figure><p id="255f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我觉得区别很明显！😊</p><h2 id="c239" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">训练模型。</h2><p id="01b0" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">我们将使用朴素贝叶斯分类器，它被证明在文本分类中提供统计上令人满意的结果，特别是<a class="ae mc" href="https://en.wikipedia.org/wiki/Naive_Bayes_spam_filtering" rel="noopener ugc nofollow" target="_blank">电子邮件过滤</a>。<br/>下面是一小段特征准备(<a class="ae mc" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html" rel="noopener ugc nofollow" target="_blank">矢量化</a> <code class="du nk nl nm nb b"><strong class="jl hj">CountVectorizer</strong></code>)和模型训练。</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="9117" class="kf kg hi nb b fi nf ng l nh ni">cv=CountVectorizer() <br/>X=cv.fit_transform(X)<br/>X_train,X_test,y_train,y_test=train_test_split(X,y,<br/>                                               test_size=0.25,<br/>                                               random_state=50)<br/>classifier=MultinomialNB() <br/>classifier.fit(X_train,y_train)<br/>y_pred=classifier.predict(X_test)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ny"><img src="../Images/38ab39cde63b21b89aa8eb45309f0020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1USWP37FbfhWPCI1Xi8DCw.png"/></div></div></figure><p id="ba29" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">测试模型的准确性</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="8b13" class="kf kg hi nb b fi nf ng l nh ni">accuracy_score(y_pred,y_test)</span></pre><p id="1e39" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们的模型有97.77%的准确率。那是一次值得称赞的表演。<br/>我们还可以生成一个<a class="ae mc" href="https://www.geeksforgeeks.org/confusion-matrix-machine-learning/" rel="noopener ugc nofollow" target="_blank">混淆矩阵</a>来放大模型的性能。领先的对角线值表示我们的模型正确预测的测试值。</p><pre class="iy iz ja jb fd na nb nc nd aw ne bi"><span id="c3ff" class="kf kg hi nb b fi nf ng l nh ni">confusion_matrix(y_test,y_pred)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nz"><img src="../Images/076f07f7acbd657c2e6c4e95f13e1f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/format:webp/1*GgXkK73CIiZvSbmxN4LV7g.png"/></div><figcaption class="mw mx et er es my mz bd b be z dx translated">混淆矩阵</figcaption></figure><p id="50cd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以在这里  <strong class="jl hj">访问整个脚本<a class="ae mc" href="https://github.com/pyPRO2019/Medium-Blogs/blob/master/NLP%20Intro.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hj">。</strong></a></strong></p><h1 id="56eb" class="lm kg hi bd kh ln lx lp kl lq ly ls kp io lz ip ks ir ma is kv iu mb iv ky lw bi translated">建议</h1><p id="0966" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">这个博客的灵感来自于我帮助设计的一个用户请求自动响应程序<a class="ae mc" href="http://www.esquekenya.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jl hj"><em class="mr"/></strong></a><strong class="jl hj"><em class="mr">。</em> </strong>他们是学校管理和后勤解决方案的领先提供商<strong class="jl hj"> <em class="mr">。</em> </strong>你可以在这里勾选<a class="ae mc" href="http://www.esquekenya.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jl hj"><em class="mr"/></strong></a><em class="mr">。</em></p><p id="e59c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果你喜欢这个博客，别忘了👏🏼👏🏼👏🏼并继续努力。</p><p id="f644" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">注意安全！</p></div></div>    
</body>
</html>