<html>
<head>
<title>Is your machine learning model making lucky guesses?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的机器学习模型是在进行幸运的猜测吗？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/is-your-machine-learning-model-making-lucky-guesses-d8968d3a3e62?source=collection_archive---------27-----------------------#2020-01-14">https://medium.com/analytics-vidhya/is-your-machine-learning-model-making-lucky-guesses-d8968d3a3e62?source=collection_archive---------27-----------------------#2020-01-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="05c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">衡量非绩效比绩效要困难得多</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/f49faf428c9e666c65c6d6a67ac052f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eyza_fQcMTl2LST0Xs9A4w.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><a class="ae ju" rel="noopener" href="/@skyl/evaluating-a-machine-learning-model-7cab1f597046">图片链接</a></figcaption></figure><p id="e804" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了理解这个重要的问题，我们需要理解如何评估一个机器学习模型。这是机器学习工作流中的核心任务之一，预测和规划模型在生产中的成功可能是一项艰巨的任务</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jv"><img src="../Images/5fb5829e179b323e729e39e332bda4ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-t-6XJEkMcgUTnqd3yaQRA.jpeg"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">保持好奇而非批判</figcaption></figure><p id="ea9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我们将讨论各种衡量标准来检查机器学习模型的性能。参数如下所述:</p><ol class=""><li id="61aa" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">准确(性)</li><li id="ec1b" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">精确</li><li id="e4f8" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">回忆</li></ol><blockquote class="kk kl km"><p id="7824" class="if ig jd ih b ii ij ik il im in io ip kn ir is it ko iv iw ix kp iz ja jb jc hb bi translated">在研究机器学习模型的实际性能指标之前，让我们看一下一个叫做<strong class="ih hj">混淆矩阵</strong>的重要参数</p></blockquote><h1 id="ea9d" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">混淆矩阵</h1><p id="46fb" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated"><strong class="ih hj">什么是混淆矩阵，为什么需要它？</strong></p><p id="e895" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混淆矩阵是一种总结分类算法性能的技术。</p><p id="c70c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果每个类别中的观测值数量不相等，或者如果数据集中有两个以上的类别，那么单独的分类精度可能会产生误导。</p><blockquote class="kk kl km"><p id="f88a" class="if ig jd ih b ii ij ik il im in io ip kn ir is it ko iv iw ix kp iz ja jb jc hb bi translated">混淆矩阵显示了你的分类模型在进行预测时被混淆的方式。</p></blockquote><p id="7f38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们中的许多人在创建混淆矩阵时感到困惑。让我们看看下面的记忆技巧，它有助于创建没有任何缺陷的混淆矩阵。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lt"><img src="../Images/43d3f23fedc07965e9876d8283cefe58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1rISvGB4r_EpTAwMprW67g.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd ks">使用上述记忆技巧创建混淆矩阵</strong></figcaption></figure><p id="5d19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">注:通常情况下，混淆矩阵主对角线元素中的参数应始终比混淆矩阵中的其他元素大</em></p><p id="b391" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们举一个小例子来理解与混淆矩阵相关的几个重要参数。</p><p id="60a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">例如:在一家每天有100笔交易的信用卡公司中，10笔交易实际上是欺诈性的，其余的是非欺诈性的。假设我们的模型以如下所示的混淆矩阵的形式显示交易信息</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lu"><img src="../Images/2a3f2e4b51e316583d48112097d623ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0fpP5plA6nBoPuUbiBGbag.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">演示信用卡交易场景的示例</figcaption></figure><h1 id="09ed" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">与混淆矩阵相关的术语</strong></h1><ul class=""><li id="80b1" class="jw jx hi ih b ii lo im lp iq lv iu lw iy lx jc ly kc kd ke bi translated"><strong class="ih hj">真阳性(TP) </strong>:分类器预测交易为‘欺诈性’且交易实际上是欺诈性的情况。</li><li id="6967" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc ly kc kd ke bi translated"><strong class="ih hj">真实否定(TN) </strong>:分类器预测“非欺诈性”且交易实际上非欺诈性的情况。</li><li id="8b21" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc ly kc kd ke bi translated"><strong class="ih hj">假阳性(FP) </strong>:分类器预测为“欺诈性”交易，但交易实际上不是欺诈性的情况</li><li id="8a0d" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc ly kc kd ke bi translated"><strong class="ih hj">假阴性(FN) </strong>:分类器预测“非欺诈性”但交易实际上是欺诈性的情况。</li></ul><h1 id="8903" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">准确(性)</h1><p id="4d2a" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">准确度是与全部数据点相比，分类器的正确预测的量度。简而言之，它是正确预测的单位与分类器做出的预测总数的比率</p><blockquote class="lz"><p id="ef84" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">精度=TP+TN/(TP+FP+FN+TN)</p></blockquote><blockquote class="kk kl km"><p id="0dd4" class="if ig jd ih b ii mj ik il im mk io ip kn ml is it ko mm iw ix kp mn ja jb jc hb bi translated">当数据中的目标变量类接近平衡时，精确度是一个很好的衡量标准</p></blockquote><p id="887c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">注意:</em>在以下情况下，精确度并不能给我们最好的图像</p><ol class=""><li id="8ef2" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">如果数据集<strong class="ih hj">不平衡</strong></li></ol><p id="30ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">例如</em> </strong> <em class="jd">。:如果一个数据集包含100笔交易，则只有5笔是欺诈性交易。假设我们的模型是哑模型，并且预测每一个案例都是非欺诈性的。自那以后，它将欺诈案件归类为非欺诈案件。尽管该模型在预测错误交易方面很糟糕，但该模型的准确率为95% </em></p><p id="bf7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.如果分类器模型以任何分数的形式提供输出，如<strong class="ih hj">概率分数</strong></p><h1 id="3397" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">精确</h1><p id="3ef1" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">当目标是<em class="jd">限制误报数量</em> (FP)时，通常使用精度。例如，如果我们处理信用卡错误交易的目标是最大限度地减少被归类为欺诈的真实交易的数量，这将是我们关注的指标。</p><p id="1908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是通过使用以下公式获得的:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mo"><img src="../Images/e1d372a57d127c3591c813b7e2771832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Dwxr3DNjAbcEWnIW.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">精确</figcaption></figure><p id="2e72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">例:在我们有100笔交易的信用卡交易示例中，只有7笔是错误交易。假设我们的模型非常糟糕，预测每个案例都是</em> <strong class="ih hj"> <em class="jd">欺诈</em> </strong> <em class="jd">。因为我们预测每个样本都是欺诈性的，所以我们的分母(真阳性和假阳性)是100，分子(欺诈性交易和预测样本为欺诈性的模型)是7。所以在这个例子中，我们可以说</em> <strong class="ih hj"> <em class="jd">这类模型的精度</em> </strong> <em class="jd">是7%。</em></p><h1 id="2b97" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">回忆还是敏感</h1><blockquote class="lz"><p id="231d" class="ma mb hi bd mc md me mf mg mh mi jc dx translated"><em class="mp">“当它实际上是阳性结果时，它正确预测的频率是多少？”</em></p></blockquote><p id="1235" class="pw-post-body-paragraph if ig hi ih b ii mj ik il im mk io ip iq ml is it iu mm iw ix iy mn ja jb jc hb bi translated">当目标是<em class="jd">限制假阴性</em> (FN)的数量时，通常使用召回。在我们的例子中，这将对应于最小化被分类为非欺诈交易的欺诈交易的数量。召回又称为“<strong class="ih hj">敏感度</strong>”和“<strong class="ih hj">真阳性率</strong>”(TPR)。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mq"><img src="../Images/736f97a6744704b771e5bdc958aa7147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gx423MV-9ICOGO2j.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">回忆</figcaption></figure><p id="639f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">例如:在我们有100笔交易的信用卡交易示例中，只有7笔是错误交易。假设模型预测每个案例都是欺诈性的。</em></p><p id="1c34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">因此，我们的分母(真阳性和假阴性)是7，分子(具有欺诈性交易且预测案例为欺诈性的模型)也是7(因为我们预测7个案例为欺诈性)。所以在这个例子中，我们可以说</em> <strong class="ih hj"> <em class="jd">召回</em> </strong> <em class="jd">这样的型号是100%。这样一个模型的精度(正如我们上面看到的)是7% </em></p><p id="4a79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么时候用精准，什么时候用召回？:</strong></p><p id="78bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很明显，召回为我们提供了关于分类器在假阴性方面性能的信息(我们漏掉了多少)，而精确<strong class="ih hj"> </strong>为我们提供了关于假阳性方面性能的信息(我们抓住了多少)。</p><p id="2693" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">精准</strong>就是要精准。因此，即使我们设法只捕获了一个有故障的交易，并且我们正确地捕获了它，那么我们是100%精确的。</p><p id="4bf7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">回想一下</strong>与其说是正确捕获案例，不如说是捕获所有具有“欺诈”交易的案例，答案为“<strong class="ih hj">欺诈</strong>”。因此，如果我们总是简单地说每个案例都是“欺诈性的”，我们就有100%的召回率。</p><p id="b858" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，基本上，如果我们想更多地关注最小化假阴性，我们会希望我们的召回率尽可能接近100%，而精确度不会太差，如果我们想关注最小化假阳性，那么我们的重点应该是使精确度尽可能接近100%</p><blockquote class="kk kl km"><p id="06ea" class="if ig jd ih b ii ij ik il im in io ip kn ir is it ko iv iw ix kp iz ja jb jc hb bi translated">没有硬性规定说在所有情况下什么应该最小化。这完全取决于业务需求和您试图解决的问题的背景。基于此，我们可能希望尽量减少假阳性或假阴性。</p></blockquote><h1 id="75f6" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">结论</strong></h1><p id="f36a" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">理解机器学习模型在看不见的数据上的表现是使用这些评估指标的最终目的。准确度、精确度和召回率等指标是评估平衡数据集分类模型的好方法，但如果数据不平衡且存在类别差异，则ROC/AUC等其他方法在评估模型性能方面表现更好，我们将在下一篇博客中讨论</p><p id="6477" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在那之前，请保持关注，祝机器学习愉快。</p></div></div>    
</body>
</html>