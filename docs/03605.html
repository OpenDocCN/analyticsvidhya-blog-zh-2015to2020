<html>
<head>
<title>Transfer Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/transfer-learning-63c8137bb081?source=collection_archive---------13-----------------------#2020-02-10">https://medium.com/analytics-vidhya/transfer-learning-63c8137bb081?source=collection_archive---------13-----------------------#2020-02-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="835c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文的目的是强调迁移学习如何帮助企业启动他们的ML实施。为了演示的目的，给出了一个使用Keras及其预训练模型的例子。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/cbecb20fe6b8d923c017b520f28bb6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*o613qWiWzqywWa93nrlGAA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">【http://landdgenerous.com】转移学习(图片归功于T2)</figcaption></figure><blockquote class="jv jw jx"><p id="c606" class="if ig jd ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">想象一下，如果我们不能把我们的学习从一种情况带到另一种情况。我们的世界会是什么样子？</p></blockquote><p id="7cf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为人类，我们学习新的东西，当我们学得更多的时候，我们应用我们已经学过的东西。我们的学校系统是建立在同样的原则上的——我们在前几个年级学到的东西为下一个年级奠定了基础。</p><p id="fbb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">问题是——机器能做同样的事情吗？</strong></p><h1 id="ad3e" class="kb kc hi bd ju kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">机器学习</strong></h1><p id="6699" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">机器学习很复杂。它包括收集数据、修剪数据、构建模型、优化模型、评估模型、超参数调整、使用模型以及持续的优化和调整。所有这一切看起来令人望而生畏，但组织除了接受它之外别无选择，原因如下:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ld"><img src="../Images/c885d506c917f3d41873d1a90a45bc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*llnsT2tklET86WZnoYKvUg.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd ju">留在这里(图片归功于http://art.com)</strong></figcaption></figure><blockquote class="le"><p id="c7a4" class="lf lg hi bd lh li lj lk ll lm ln jc dx translated">“机器学习会一直存在。”</p></blockquote><p id="5218" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated"><em class="jd">免责声明:以下两段是我的想法&amp;观察。</em></p><h1 id="8373" class="kb kc hi bd ju kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">留在这里</strong></h1><p id="7e8a" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">机器学习会一直存在。许多未来的商业差异可能来自于机器学习在实现未开发的商业机会或解决商业问题方面的应用。</p><p id="83fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习也可能改变技术应用的构建方式。不像当前的应用程序是通过编写业务逻辑构建的，ML应用程序将工作，被底层数据重塑，并且业务规则不需要预先假定和编写。</p><p id="3ebe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不用说，ML应用程序将变得非常擅长预测、推荐、检测、自动化和执行以前只能由人类完成的任务。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lt"><img src="../Images/c4bdc24a38d1328c55c6b71bc53b2735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOn5xC9_aH102XqbVTZZpA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd ju">打破坏神话(图片功劳归于</strong><a class="ae lu" href="https://twitter.com/rodemmerson/status/1001873704064724993" rel="noopener ugc nofollow" target="_blank"><strong class="bd ju"/></a><strong class="bd ju">)</strong></figcaption></figure><h1 id="ce60" class="kb kc hi bd ju kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">打破坏神话</strong></h1><p id="40d5" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">尽管存在机器学习的可能性，但许多大型组织都回避在组织内建立机器学习能力，而是寻求第三方SAAS公司的产品。</p><blockquote class="jv jw jx"><p id="7777" class="if ig jd ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">虽然这种策略可能在短期内奏效，但它将进一步推动组织使用ML建立业务差异的能力。事实上，从长远来看，这两种策略的结合对于刚接触机器学习的公司来说是卓有成效的。</p></blockquote><p id="20eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于构建ML模型的一个常见神话是复杂的，公司需要100多名专门的ML工程师来构建任何有意义的东西。这与事实相去甚远。虽然创建前沿模型可能很困难，但大多数公司不会创造新技术，而是使用或增强现有方法。就像在技术世界中，苹果和微软正在建立技术栈，而我们其他人正在使用它，ML世界也不会有什么不同。关键是，企业可以通过使用现有的模型或通过从现有的开源模型应用迁移学习来构建有意义的ML应用程序。</p><blockquote class="jv jw jx"><p id="ceea" class="if ig jd ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">就像人类一样，知识可以从一个模型转移到另一个模型，这种转移知识的能力将帮助模型将学习从一种情况应用到另一种情况。下面，我们来看看如何。</p></blockquote><h1 id="532c" class="kb kc hi bd ju kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">背景</strong></h1><p id="1fcd" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">在我们讨论迁移学习之前，让我们先了解一下深度学习是如何工作的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/47a70b5719183da21c39ce4163fce62f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pMgc4_YhAvliwRfclI5l2Q.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">【深度学习模型(图片归功于https://pnas.org)</figcaption></figure><blockquote class="le"><p id="5d5a" class="lf lg hi bd lh li lj lk ll lm ln jc dx translated">深度学习模型是对特征的函数逼近</p></blockquote><p id="9327" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">深度学习模型可以被认为是对特征的函数逼近。其中的每一层都是特定要素的函数近似值。每个后续层都是其前面特征的复合函数近似值。<a class="ae lu" href="https://arxiv.org/pdf/1702.07800.pdf" rel="noopener ugc nofollow" target="_blank">【1】</a></p><p id="fc65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">比方说，我们有一个预先构建的开源模型，可以从特写正面照片中识别美国总统。初始层是用于识别图片中的边缘的函数逼近，下一层是用于识别边缘组合的函数逼近，接下来是识别诸如眼睛、鼻子等面部特征。以此类推，直到最后一层的图片是乔治·华盛顿或任何其他总统。</p><p id="0575" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上述深度学习模型中，输入数据都是从相同的特征空间和分布中提取的。这个模型拍摄了人们的特写正面照片来辨认总统。假设您想要构建一个新模型，该模型获取一个站着的人的照片，并识别他是否是您的员工。新的输入数据分布将不同于以前的分布。[ <a class="ae lu" href="https://www.cse.ust.hk/~qyang/Docs/2009/tkde_transfer_learning.pdf" rel="noopener ugc nofollow" target="_blank"> 2 </a></p><blockquote class="jv jw jx"><p id="7b18" class="if ig jd ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">当分布发生变化时，大多数统计模型将不得不使用新的训练数据从头开始重建。</p></blockquote><p id="991b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当分布发生变化时，大多数统计模型将不得不使用新的训练数据从头开始重建。因此，新模型必须用站立的人的照片来训练。这在现实世界中可能会有问题，因为收集所需的数据并重建模型既昂贵，有时又不可能。[ <a class="ae lu" href="https://www.cse.ust.hk/~qyang/Docs/2009/tkde_transfer_learning.pdf" rel="noopener ugc nofollow" target="_blank"> 2 </a></p><blockquote class="jv jw jx"><p id="10c4" class="if ig jd ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">正是在这种情况下和少数其他情况下，知识转移或任务域之间的转移学习是可取的和有效的。</p></blockquote><h1 id="e943" class="kb kc hi bd ju kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">转移学习</strong></h1><p id="0bc0" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">迁移学习的动机是利用来自预训练模型的知识，并将其用于新模型，以通过避免昂贵的数据收集和标记工作来提高新模型的性能。[ <a class="ae lu" href="https://www.cse.ust.hk/~qyang/Docs/2009/tkde_transfer_learning.pdf" rel="noopener ugc nofollow" target="_blank"> 2 </a></p><p id="9844" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">《学习调查》—Sinno Jialin Pan&amp;Qiang Yang的出版物是必读的，它详细描述了迁移学习。[ <a class="ae lu" href="https://www.cse.ust.hk/~qyang/Docs/2009/tkde_transfer_learning.pdf" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]</p><blockquote class="jv jw jx"><p id="3b41" class="if ig jd ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">迁移学习的思想是——你可以采用在不同领域或不同任务或两者中训练的预训练模型，并使其适应你的目标领域和目标任务，而不是为你的任务从头开始训练模型。</p></blockquote><p id="ed54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面我列出了两种最常见的迁移学习策略</p><h2 id="7608" class="lw kc hi bd ju lx ly lz kg ma mb mc kk iq md me ko iu mf mg ks iy mh mi kw mj bi translated"><strong class="ak">特征提取器</strong></h2><p id="e91b" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">在这种方法中，您在不同的任务中使用预训练模型的一个或多个层的输出来检测数据的一般特征。然后，你将这些特征输入到你的新的浅层模型中&amp;训练它完成你的目标任务。<a class="ae lu" href="https://keras.io/applications/" rel="noopener ugc nofollow" target="_blank">【5】</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mk"><img src="../Images/0344469f223af0ee253cd8749bdf0ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJon1gmeA3LsUlZQ4aT6MA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd ju">特征提取(图像归功于https://oreilly.com)</strong></figcaption></figure><p id="0eb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们已经讨论过的，深度学习模型的较低层提取低级特征，较高层建立在先前的层上，并提取更复合的特征<a class="ae lu" href="https://arxiv.org/pdf/1702.07800.pdf" rel="noopener ugc nofollow" target="_blank">【1】</a>。ResNet等预先训练好的模型已经在数百万张图片上训练过<a class="ae lu" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank">【3】</a>。您可以在没有最终分类层的情况下使用此类模型，并获得图像数据的特征表示。这种丰富的特征表示可以输入到你的浅层分类器模型中，以输出你的任务。</p><h2 id="ea56" class="lw kc hi bd ju lx ly lz kg ma mb mc kk iq md me ko iu mf mg ks iy mh mi kw mj bi translated"><strong class="ak">微调一个预先训练好的模型</strong></h2><p id="28a9" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">这是一个稍微复杂一点的方法。在这种情况下，您不会替换预训练模型的最后一层，而是有选择地冻结几层&amp;训练/调整预训练模型的其他层。我们利用预训练模型的整体架构，并选择要训练的层。这有助于我们用更少的训练时间<a class="ae lu" href="https://keras.io/applications/" rel="noopener ugc nofollow" target="_blank">【5】</a>取得更好的成绩。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ml"><img src="../Images/d69eca32f64112a64ffa3ce50e24f432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cku-jxHGxt_x8oNxEoyzJQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd ju">微调预训模型(图片鸣谢</strong><a class="ae lu" href="https://www.ibm.com/blogs/research/2019/06/spottune-transfer-learning/" rel="noopener ugc nofollow" target="_blank"><strong class="bd ju">)https://www . IBM . com/blogs/research/2019/06/spottune-transfer-learning/</strong></a><strong class="bd ju">)</strong></figcaption></figure><blockquote class="le"><p id="b436" class="lf lg hi bd lh li lj lk ll lm ln jc dx translated">“这两种方法都非常实用，在现实任务中非常有用。”</p></blockquote><p id="42fb" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">底线:迁移学习可以被企业用来建立生产级模型，从而在市场中脱颖而出。</em>T13】</strong></p><h1 id="880d" class="kb kc hi bd ju kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">用例:人脸识别</strong></h1><p id="a95c" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">我们将使用预先训练好的<strong class="ih hj"> InceptionResNetV2 </strong>模型。该模型在<a class="ae lu" href="http://www.image-net.org/" rel="noopener ugc nofollow" target="_blank"> ImageNet上进行训练:ImageNet是一个拥有超过1400万张图像的图像数据库，对超过20，000个类别进行分类[4] </a>。我们将使用这个预训练的模型进行特征提取，并将其与我们的人脸识别模型相结合，该模型根据我们数据库中的照片来识别我们的员工。这个用例将使用特征提取技术进行演示。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mm"><img src="../Images/31fcccf8e62aca072d4d189e57d65129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qOCh71Y48LWof5-50UzbsQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mn"><img src="../Images/3fd5975395839eaa878f2c20469e99bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZgdOTu1dWiHj2q1G3WJc1A.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mo"><img src="../Images/a1b267d25f6ddf76bd4ae71fc77cf88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1tHwJzHxDAHeZu4Cxf70NA.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mp"><img src="../Images/6992852420e9be252e11e9a9fc74c62a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tY100UBp7iiFHNX7SLEx5A.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mq"><img src="../Images/85f001faba5c52928498ed0b0f7b49de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELaagZN8_1N7reHVbXy70Q.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mr"><img src="../Images/45d8c8fde7bfdbf7d09d39dbdae033be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WdgPS_ZoerraeCqIwSqsfg.png"/></div></div></figure><p id="961e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用边界框实现可以使面部识别变得更好更精确，在边界框实现中，从图片中提取面部，然后对提取的面部应用面部识别功能。可以使用OpenCV或DeepNet (YOLO)模型来实现边界框——这个话题改天再讨论。</p></div></div>    
</body>
</html>