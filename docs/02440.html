<html>
<head>
<title>Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-in-machine-learning-4718064102a4?source=collection_archive---------24-----------------------#2019-12-16">https://medium.com/analytics-vidhya/linear-regression-in-machine-learning-4718064102a4?source=collection_archive---------24-----------------------#2019-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/cafbd8e08e15f9825884e01eeb37a128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*OslasmtmTDZQbuWWhQMDqA@2x.jpeg"/></div></figure><p id="5e62" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你熟悉机器学习和监督学习这些术语吗？如果是的话，那很好，但是如果你不是，那么我建议你一定要在<a class="ae jk" href="https://link.medium.com/MboZTHpqm2" rel="noopener">机器学习</a>上看看这篇文章，这样你就不会像坐过山车一样。</p><p id="b1af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您不熟悉Python库Pandas和Matplotlib，也可以阅读它们。</p><blockquote class="jl jm jn"><p id="904e" class="im in jo io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated"><em class="hi">老学校数学</em></p></blockquote><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es js"><img src="../Images/d6b25c0dde24b6d678a58825a149cffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*XUBYMAjbmavrd_QT0FEshw@2x.jpeg"/></div></figure><p id="e1e2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们用老办法，试着回忆一下这个图表在当时意味着什么。没那么难，但是如果你不能回忆起简单的线方程，让我来帮你做这个任务。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es jx"><img src="../Images/70c0a58366fdcfcec61943838090dcf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*2hKTVYuRpS8XmMqoKc5W-g@2x.jpeg"/></div></figure><p id="9240" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">是的，就是这个，如果你把这个方程做对了，你就会知道线性回归到底是什么。</p><p id="d719" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这个方程中，X和Y变量对应于x-y平面的坐标。变量C表示截距值，即直线偏离y轴原点(0，0)的值。变量M代表直线的斜率。</p><p id="e164" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">X是一个独立变量，因为它不依赖于任何其他变量，但Y是一个因变量，其值取决于X的值。简单地说，Y是我们需要预测其值的变量，而X是我们可以用来预测Y值的变量。</p><p id="6d8e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">线性回归只在因变量只依赖于一个变量的情况下有效。</p><p id="515d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你一定想知道如果因变量依赖于多个变量会怎样。恭喜你！你已经开始理解机器学习的概念，但目前我需要你只关注这种情况。多元线性回归模型是你的问题的答案，其中有一个以上的自变量来预测因变量。一旦你掌握了线性回归的基本算法，多元回归模型只需要做一些改变。</p><blockquote class="jl jm jn"><p id="253d" class="im in jo io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated"><em class="hi">是时候深入了解机器学习的魔力了</em></p></blockquote><p id="305b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">年资和薪资数据集可以从<a class="ae jk" href="https://www.kaggle.com/rohankayan/years-of-experience-and-salary-dataset#Salary_Data.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载。我们将使用这个数据集来理解线性回归模型。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jy"><img src="../Images/8e5fdd2434c839af000c2aebea77be05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEdbm2ck_OCJv4fMH0DUBA@2x.jpeg"/></div></div></figure><p id="4e06" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上表由两列组成，一列是工作年限，另一列是员工的工资，也就是说，只有一个自变量X，我们可以用它来预测因变量y的值。</p><p id="ee52" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">基于我们对数据的理解，我们可以假设经验的年数可以帮助我们预测一个雇员的工资。</p><p id="b4f4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">经验年数只是一个数字或数量，告诉我们员工在组织中度过的时间，不依赖于任何其他可量化的值，因此，它是一个独立变量，我们可以将其视为X。另一方面，员工的工资取决于员工在组织中度过的时间，因此，它是一个因变量，可以视为Y。在技术术语中，我们也可以将X称为输入值，将Y称为目标值。如果在某些地方看到输入值和目标值，不要混淆。</p><p id="efd1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们试着把上面的(X，Y)值画在图上。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/e985a71a4d854324712ac735c432061a.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*6T714HtxlvADZ26uXeq44Q.png"/></div></figure><p id="37fa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是图表的样子。现在，让我们试着将所有这些点拟合在一条直线上，也就是说，让我们试着画一条通过最大值点的直线，对于那些不在直线上的点，这些点和直线之间的距离是最小的。这条线被称为“<em class="jo">最佳拟合线</em>”。</p><p id="4cd8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们假设，我们被分配了一项任务，在工作经验年限的帮助下确定员工的工资。如果我们被要求在没有任何先验知识的情况下这样做，这是不可能的，但是因为我们已经有了工资趋势的先验知识，我们可以使用上面的图表预测工资的值。</p><p id="a830" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">是的，你没看错。如果我们知道员工的工作年限，这个图表可以用来确定员工的工资。</p><p id="29a9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们知道经验的年数，即X的值。现在，在X值的帮助下，我们可以从X轴画一条垂直于图表的直线，使用该点，我们可以在y轴画一条平行于X轴的直线。这条线和y轴相交的点就是工资的预测值。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ke"><img src="../Images/ab74826700d01c0990bf1d952e87c3a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*FpsHMkZWZCmcQ-Z7Q9Xe5g.jpeg"/></div></figure><p id="380a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您很好地理解了上面的含义，那么是时候使用Python在您的机器上实现它了。只需遵循以下简单步骤:</p><p id="7160" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">1.导入库</p><p id="98f4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有一些Python库可以帮助你建立你的第一个机器学习模型。这些库是Pandas和Matplotlib。</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="97a7" class="kk kl hi kg b fi km kn l ko kp">#importing the libraries<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span></pre><p id="32f9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.导入数据集</p><p id="6030" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了开始处理数据集，重要的是我们首先使用pandas库导入数据集，然后我们需要给X和Y变量赋值。工作经验的年数将作为X变量，工资将作为Y变量。为了检查事情是如何工作的，我们将把数据分成80-20的比例，也称为训练测试分割。80%的数据将用于训练模型，而20%将用于测试目的。</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="41f1" class="kk kl hi kg b fi km kn l ko kp">#loading the dataset<br/>dataset = pd.rad_csv("F:\\datasets\\Salary.csv")</span><span id="190e" class="kk kl hi kg b fi kq kn l ko kp">#assigning input and target values<br/>X = dataset.iloc[:,0].values.reshape(-1,1)<br/>Y = dataset.iloc[:,1].values.reshape(-1,1)</span><span id="04bc" class="kk kl hi kg b fi kq kn l ko kp">#splitting the dataset into training and testing data<br/>from sklearn.model_selection import train_test_split<br/>X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.2, random_state = 0)</span></pre><p id="266e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.创建线性回归模型</p><p id="fc62" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了创建线性回归模型，我们需要scikit学习库中可用的线性回归器类。我们需要创建一个线性回归类的对象。然后，我们将使用拟合函数将数据集拟合到线性回归对象。</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="e504" class="kk kl hi kg b fi km kn l ko kp">#creating the linear regression model<br/>from sklearn.linear_model import LinearRegressor<br/>regressor = LinearRegression()<br/>regressor.fit(X_train, Y_train)</span></pre><p id="78e2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">4.用线性回归模型预测工资</p><p id="1b8c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一旦线性回归模型输入了数据集，它就为X分配了一定的权重/偏差，这在数学术语中称为斜率。现在我们要做的就是调用predict()函数，这样我们就可以知道雇员的预期工资。在predict()函数中，我们传递雇员的经验数。</p><p id="6b00" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该函数使用雇员的工作年限返回其预期工资。</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="f8ca" class="kk kl hi kg b fi km kn l ko kp">#predicting salary of the testing data<br/>Y_pred = regressor.predict(X_test)<br/>print(Y_pred)</span></pre><p id="5ab3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">获取斜率和截距的值</p><p id="e396" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您可以获得最佳拟合线的斜率和截距值。</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="d3a6" class="kk kl hi kg b fi km kn l ko kp">#fetching the intercept and slope of the best fit line<br/>print(regressor.intercept_)<br/>print(regressor.coef_)</span></pre><p id="6ca9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">绘制数据集以说明最佳拟合线</p><pre class="jt ju jv jw fd kf kg kh ki aw kj bi"><span id="1514" class="kk kl hi kg b fi km kn l ko kp">plt.scatter(X_train, Y_train)<br/>plt.plot(X_test, Y_pred, color='red', linewidth=2)<br/>plt.title("Number of years of experience vs Salary")<br/>plt.xlabel("Number of years of experience")<br/>plt.ylabel("Salary")<br/>plt.show()</span></pre><p id="df98" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">很明显，我们得到了一条直线，证明我们的算法运行良好。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/773a4b3b5ee8574d7456763036457150.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*Vu6CW4gENkbneNdYkPPY9Q.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">最佳拟合线的图示</figcaption></figure><p id="11a5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你终于建立了你的第一个机器学习模型，你必须在不同的数据集上做同样的尝试。</p><p id="d151" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢您的阅读！</p><p id="8b03" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您有任何疑问，请在<a class="ae jk" href="http://instagram.com/h_ahuja_" rel="noopener ugc nofollow" target="_blank"> Instagram </a>、<a class="ae jk" href="http://linkedin.com/in/hahuja7" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae jk" href="http://twitter.com/iamharshitahuja" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae jk" href="http://ahujaharshit007@gmail.com" rel="noopener ugc nofollow" target="_blank">电子邮件</a>上找到我！</p></div></div>    
</body>
</html>