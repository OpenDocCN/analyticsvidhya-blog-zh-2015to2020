<html>
<head>
<title>Simple Movie Recommender System with Correlation Coefficient with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 Python 的简单相关系数电影推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-movie-recommender-system-with-correlation-coefficient-with-python-e6cb31dae01e?source=collection_archive---------4-----------------------#2020-10-22">https://medium.com/analytics-vidhya/simple-movie-recommender-system-with-correlation-coefficient-with-python-e6cb31dae01e?source=collection_archive---------4-----------------------#2020-10-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bad43697ac698545fa8b2c2547de9451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vjmmcg_rDdtOK28xJcI_0A.jpeg"/></div></div></figure><h1 id="4f0f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="6ad4" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">推荐系统</strong>是<strong class="jq hj">系统</strong>，它被设计成基于许多不同的因素向用户推荐东西</p><p id="2960" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">皮尔逊相关系数是一种非常简单而有效的方法，可以发现一个变量如何相对于另一个变量线性变化。我们可以利用这一点，用这个概念建立一个推荐系统</p><h1 id="faac" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">相关系数的工作</h1><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/27ec3e812f4664c1cce870744195af62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xj6GAyIV94kyyTXUWgjpNQ.jpeg"/></div></div></figure><p id="5151" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果两个变量的相关系数接近 1，则这些变量彼此成正比。</p><p id="f290" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果更接近-1，这些变量就成反比。</p><p id="eecd" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果相关系数的大小低于或接近于 0，变量之间可能没有很强的相关性。</p><h1 id="1a39" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">Python 代码:</h1><ol class=""><li id="6d2a" class="kw kx hi jq b jr js jv jw jz ky kd kz kh la kl lb lc ld le bi translated"><strong class="jq hj">导入必要的库。</strong></li></ol><pre class="ks kt ku kv fd lf lg lh li aw lj bi"><span id="7555" class="lk ir hi lg b fi ll lm l ln lo">#importing the libraries<br/>import numpy as np<br/>import pandas as pd</span></pre><p id="86b7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 2。数据集(MovieLens 数据集)</strong> <br/>为了实现推荐系统，我使用了 movielens 数据集，它包含了 100k 部电影的评分</p><pre class="ks kt ku kv fd lf lg lh li aw lj bi"><span id="e43c" class="lk ir hi lg b fi ll lm l ln lo">#data import<br/>df1 = pd.read_csv('./ml-100k/u.data',sep='\t',names=['user_id','item_id','rating','timestamp'])</span><span id="cd90" class="lk ir hi lg b fi lp lm l ln lo">df2 = pd.read_csv("./ml-100k/u.item", sep="|", encoding="iso-8859-1",names=["item_id","item_name","date","unknown1"<br/>"website","rat1","rat2","rat3","rat4","rat5","rat6","rat7","rat8","rat9","rat10","rat11","rat12","rat13",<br/>"rat14","rat15","rat16","rat17","rat18","rat19","rat20"])</span><span id="c2fb" class="lk ir hi lg b fi lp lm l ln lo">print(df1.head())</span></pre><p id="9792" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/9f2c9c0992bbe70297bd2fb7e1cc79c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*EJ7Yb43CmQmdMZ1EdLaGMA.png"/></div></div></figure><p id="0a31" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">数据帧 1 包含用户 id、电影 id 和相应的分级</p><pre class="ks kt ku kv fd lf lg lh li aw lj bi"><span id="1e71" class="lk ir hi lg b fi ll lm l ln lo">df2 = df2.iloc[:,0:2]<br/>df2.head()</span></pre><p id="b022" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/496159dbde34d93ad5d308ffb2d46744.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*lNP4Sa6x_1-iadoWOppMSA.png"/></div></figure><p id="33f8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">dataframe2 包含电影名称及其对应的 item_id</p><p id="7002" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 3。合并数据帧</strong></p><pre class="ks kt ku kv fd lf lg lh li aw lj bi"><span id="a606" class="lk ir hi lg b fi ll lm l ln lo">data = df1.merge(df2,on="item_id")<br/>data.drop(['timestamp'],inplace=True,axis=1)<br/>data.head()</span></pre><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/439562d072d1a444aff057b7a5d682e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*sh7wQ67xzvYZLNlyxfuxEg.png"/></div></figure><p id="976f" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">将数据帧 1 合并到数据帧 2 以获得整个数据集</p><p id="9ec5" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 4。数据透视表</strong></p><pre class="ks kt ku kv fd lf lg lh li aw lj bi"><span id="8a43" class="lk ir hi lg b fi ll lm l ln lo">data_table = pd.pivot_table(data,values='rating',columns='item_name',index='user_id')<br/>data_table.head()</span></pre><p id="b8ee" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/6d1cc8d6dfe070cb2f00270acd56302c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jy-i-qMrJKRQ-1mxW9_OGA.png"/></div></div></figure><p id="c430" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们利用 pandas 的数据透视表创建一个表，每个电影代表一列，每个用户代表一行</p><p id="af36" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 5。开始推荐</strong></p><p id="7845" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">对于这个基本的推荐系统来说就是这样，为了进行预测，我们将从用户那里获得一个电影名称，并给出用户可能喜欢的电影列表。这就是相关系数发挥作用的地方</p><p id="0f7a" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">让我们假设用户喜欢电影《101 只斑点狗》(1996)。我们必须给出一个我们认为用户可能喜欢的电影列表。</strong></p><pre class="ks kt ku kv fd lf lg lh li aw lj bi"><span id="ac8b" class="lk ir hi lg b fi ll lm l ln lo">print("here are a list of 20 movies to recommend to a user who has liked '101 Dalmatians (1996)'")</span><span id="7b71" class="lk ir hi lg b fi lp lm l ln lo">print(data_table.corr()['101 Dalmatians (1996)'].sort_values(ascending=False).iloc[:20])</span></pre><p id="eb32" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/48fcc7d4ac763b3c30053fc394079fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ud7Z2L2jzMEFMiW3buY_VQ.png"/></div></div></figure><p id="c738" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这就是我们如何使用皮尔逊相关系数，根据用户喜欢的电影向他们推荐电影</p><h1 id="fc49" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="c685" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们这里用透视表和相关系数来推荐电影。如果用户喜欢一部特定的电影，我们获取该电影的列，并找到该列与所有其他电影列的相关性，从而获得与所选电影高度相关的电影。这是因为，行代表用户，某个特定的用户可能喜欢相似的电影。因此，我们可以使用相关系数向用户推荐电影。</p><p id="1ac1" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">该代码文件将在 github 上提供以供参考:<a class="ae lv" href="https://github.com/ashwinhprasad/RecommenderSystem-CorrelationCoefficient" rel="noopener ugc nofollow" target="_blank">https://github . com/ashwinhprasad/re commender system-correlation coefficient</a></p><h1 id="8e2e" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">谢谢你</h1></div></div>    
</body>
</html>