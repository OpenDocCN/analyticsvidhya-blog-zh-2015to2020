<html>
<head>
<title>Automating Notion using notion-py</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用idea-py自动化概念</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automating-notion-using-notion-py-fa0f2e8f089e?source=collection_archive---------15-----------------------#2020-05-11">https://medium.com/analytics-vidhya/automating-notion-using-notion-py-fa0f2e8f089e?source=collection_archive---------15-----------------------#2020-05-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="7bb0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我最近开始使用<a class="ae jk" href="https://en.wikipedia.org/wiki/Notion_(app)" rel="noopener ugc nofollow" target="_blank">概念</a>，感觉棒极了！我用它做任何事情，记笔记，作为一个开支经理，计划项目等等。在idea之前，我曾经用google keep来记录我的支出，它看起来像这样:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/510763d0ce1d4fa0b14c067c0d0a08b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSavKOGAoBUj7bSRwqZMfA.jpeg"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">我以前是怎么写费用的</figcaption></figure><p id="591f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以基本上只是一堆我的花费，包括金额，我花钱的地方和日期。</p><p id="64a7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">概念为管理你的开支提供了一个模板，如下所示:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kb"><img src="../Images/7f877372a66ce4f2d529175fa16331bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M9rXVFuiAJb7nPwfTxHi-g.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">概念中的默认费用经理模板</figcaption></figure><p id="383c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是一个组织得非常好的数据库，带有花哨的颜色编码类别，但问题是从我的旧的随意的文本文件中一个接一个地添加条目到这个漂亮的模板中是一项非常乏味的任务。所以在网上搜索了一下，我找到了这个叫做n <a class="ae jk" href="https://pypi.org/project/notion/" rel="noopener ugc nofollow" target="_blank"> otion-py </a>的神奇图书馆。</p><p id="6a6d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">opinion-py是一个免费的库，允许你操作你的概念块和数据库。根据他们的官方网站，这是一个“T4概念的非官方Python 3客户端，所以是API v3”。《观念-py》的作者在medium上也有一个博客<a class="ae jk" rel="noopener" href="/@jamiealexandre/introducing-notion-py-an-unofficial-python-api-wrapper-for-notion-so-603700f92369">你可以在这里找到</a>。<em class="kc">(我与他们的团队没有联系，我只是在搜索对概念的API支持时偶然发现了这个库)</em></p><p id="cf7a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以首先，我必须将数据转换成包含费用、成本和日期的三个数组。我用下面的代码做到了:</p><pre class="jm jn jo jp fd kd ke kf kg aw kh bi"><span id="977b" class="ki kj hi ke b fi kk kl l km kn">#Open file<br/>raw_data = []<br/>with open("Expenses.txt", "r") as f:<br/>    for line in f:<br/>        if (line):<br/>            raw_data.append(line)<br/>            <br/>#Get cost in one array(cost[]) &amp; date, expense in second array(data_to_be_formatted)    <br/>cost = []<br/>data_to_be_formatted = []        <br/>for line in raw_data:<br/>    a,b = line.split(' ', 1)<br/>    cost.append(a)<br/>    data_to_be_formatted.append(b)<br/>    <br/>#Convert str(cost) -&gt; int(cost)    <br/>cost_numeric = []<br/>for t in cost:<br/>    t=int(t)<br/>    cost_numeric.append(t)<br/><br/>#APPEND '_' for ' ' and then split at first '_' in next loop    <br/>count = 0<br/>for line in data_to_be_formatted:<br/>    line_length = len(line)<br/>    for i in range(0,line_length):<br/>        if(line[i]==' '):<br/>            temp = list(line)<br/>            temp[i] = '_'<br/>            line="".join(temp)<br/>    data_to_be_formatted[count] = line<br/>    count = count+1<br/><br/>#Split at first '_' to get date and expense<br/>expense = []<br/>date = []    <br/>for line in data_to_be_formatted:<br/>    a,b = line.rsplit('_',1)<br/>    expense.append(a)<br/>    date.append(b)</span></pre><p id="08f9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我确实意识到这可能不是最好的完成方式，但是我仍然在学习python，这很有效；).如果你有什么建议，请告诉我！:)</p><p id="3c53" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我得到三个数组cost[ ]，expense[ ]，date[ ]，之后，我继续进行在他们的文档中给定的<a class="ae jk" href="https://pypi.org/project/notion/" rel="noopener ugc nofollow" target="_blank">的idea-py API调用。</a></p><p id="08ad" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">代码如下所示:</p><pre class="jm jn jo jp fd kd ke kf kg aw kh bi"><span id="f1b5" class="ki kj hi ke b fi kk kl l km kn">from notion.client import NotionClient<br/># Obtain the `token_v2` value by inspecting your browser cookies on a logged-in session on Notion.so<br/>client = NotionClient(token_v2="YOUR_V2_TOKEN_HERE")<br/><br/>#GET YOUR COLLECTION/VIEW/DATABASE<br/>cv = client.get_collection_view("YOUR_DB_URL_HERE")<br/> <br/>i=0<br/>#Get the values for each row<br/>for Cost, Expense, Date in zip(cost_numeric, expense, date):<br/>    #Add New Row<br/>    row = cv.collection.add_row()<br/>    #Add Values<br/>    row.Expense = Expense<br/>    row.Amount = Cost<br/>    row.Comment = Date<br/>    #Print progress<br/>    print("Completed {} entries".format(i+1))<br/>    i=i+1</span></pre><p id="6cfb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意:我在注释中添加了日期，因为概念中的日期需要日期时间对象，而日期是字符串。我可以把它转换成日期时间，但是坦白地说，我忘记了。:/</p><p id="d50f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">v2令牌的获取方式如下:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ko"><img src="../Images/9cb8f6aa7efdffbac7aeb912050cdabb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YyH0j0gG61vm1G4xogHqjg.jpeg"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">如何获取token_v2参数</figcaption></figure><p id="ada4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">单击它并复制内容部分中的值。</p><p id="c2b1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">瞧，所有的开销都毫不费力地转移到了观念上。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kp"><img src="../Images/0b96a72b191e3024dec8841ef560b8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqdx7kA0Fo8OG7NokWjyaQ.png"/></div></div></figure><p id="ed0e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我还制作了一个Android应用程序来添加记录，就像我之前添加的一样，(作为一个简单的文本字符串)，然后将其添加到概念数据库中。你可以在这里读到它<a class="ae jk" rel="noopener" href="/@prathu10/android-app-for-notion-automation-using-chaquopy-863e72fa4ecd">。我希望这能对你有所帮助。</a></p><p id="d3ab" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下次见。干杯！</p></div></div>    
</body>
</html>