<html>
<head>
<title>Customer Analysis on Arvato Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Arvato数据集上的客户分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/customer-analysis-on-arvato-dataset-dfc48d96a96f?source=collection_archive---------8-----------------------#2019-09-11">https://medium.com/analytics-vidhya/customer-analysis-on-arvato-dataset-dfc48d96a96f?source=collection_archive---------8-----------------------#2019-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5b353e5200316f818890b1c9f67db9a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kzQBJWTWv8ryc5gF8uZE6g.jpeg"/></div></div></figure><p id="e28b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该项目的第一部分是分析德国一家邮购销售公司的客户的人口统计数据，并将其与普通人群的人口统计数据进行比较。主要目标是识别更有可能成为公司客户的人群。将清理普通人群和客户数据，应用PCA，并使用KMeans将数据划分到聚类中。将对聚类进行比较，以了解普通人群中的哪些部分是客户数据的一部分。</p><p id="829b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第二部分中，给定邮件发送活动的目标个人数据集，将建立一个机器学习模型来预测是否值得将此人包括在活动中(如果他们有可能成为公司的客户)。最初将使用Adaboost和GradientBoosting，然后调整参数以获得最佳结果。</p><p id="b26d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用的数据由Udacity在Bertelsmann Arvato Analytics的合作伙伴提供。代码可从<a class="ae jo" href="https://github.com/belagoesr/nanodegree_capstone" rel="noopener ugc nofollow" target="_blank"> github </a>获得。</p><h2 id="e619" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">资料组</h2><p id="1b84" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">有四个数据文件与此项目相关联:</p><ul class=""><li id="2b64" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated">德国一般人口的人口统计数据；891 211人(行)x 366个特征(列)。</li><li id="b76e" class="kp kq hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated">邮购公司客户的人口统计数据；191 652人(行)x 369个特征(列)。</li><li id="0447" class="kp kq hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated">作为营销活动目标的个人的人口统计数据；42 982人(行)x 367人(列)。</li></ul><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/05be81040b178cd9da00986e3d3da0e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u6PccDzO89p2ce6g4QDJDw.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">普通人群的人口统计数据</figcaption></figure><p id="2088" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些数据包括主要类别的特征:个性、金融类型、社会地位、地区和购买习惯。</p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h1 id="f256" class="lt jq hi bd jr lu lv lw jv lx ly lz jz ma mb mc kc md me mf kf mg mh mi ki mj bi translated">项目结构</h1><h2 id="9110" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">第1部分:客户细分</h2><p id="06f4" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">在这一部分中，使用无监督学习技术来描述公司现有客户的人口统计数据与德国一般人口之间的关系。</p><p id="1f13" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="mk">数据清理</em> </strong></p><ul class=""><li id="ebe8" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><em class="mk">评估缺失数据</em></li><li id="8c47" class="kp kq hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated"><em class="mk">特征编码</em></li></ul><p id="4496" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="mk">降维</em> </strong></p><ul class=""><li id="5ec7" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><em class="mk">主成分分析</em></li></ul><p id="a7a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="mk">聚类</em> </strong></p><ul class=""><li id="db44" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><em class="mk">聚类(</em><a class="ae jo" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans" rel="noopener ugc nofollow" target="_blank"><em class="mk">k表示</em> </a> <em class="mk"> ) </em></li></ul><h2 id="410a" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">第2部分:监督学习模型</h2><p id="2431" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">在这一部分中，建立了一个机器学习模型来预测客户是否有可能成为客户，从而预测针对他们开展营销活动是否有意义。</p><ul class=""><li id="39e5" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><em class="mk">数据集/缩减采样方法的类别不平衡</em></li><li id="7f8a" class="kp kq hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated"><em class="mk">培训模式</em></li><li id="31f5" class="kp kq hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated"><em class="mk">参数调谐</em></li><li id="f182" class="kp kq hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated"><em class="mk">结论</em></li></ul></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h1 id="35ad" class="lt jq hi bd jr lu lv lw jv lx ly lz jz ma mb mc kc md me mf kf mg mh mi ki mj bi translated">第1部分:客户细分</h1><h2 id="5c64" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">数据清理</h2><ul class=""><li id="c3df" class="kp kq hi is b it kk ix kl jb ml jf mm jj mn jn ku kv kw kx bi translated"><strong class="is hj">评估缺失数据:</strong></li></ul><p id="47ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在计算每一行和每一列中的缺失值之前，必须根据包含特征信息的excel电子表格替换缺失的数据编码值。创建了包含每个特征的编码值的数据帧:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/96aabdf3dfd84ed9e31ce3fa35c6d065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*blHIFVKESzV6h2tUSnAYPQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">包含编码缺失值的数据帧(azdias_attr_nan)</figcaption></figure><p id="53b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，在“altersketagorie _ GROB”功能中，值-1和0(未知)被替换为np.nan</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/de1dfcc4d2756bf7f3d221e7b03570b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XIsDbw5AM9x9JVWsZ-ccbQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">特征信息:名称、描述、值</figcaption></figure><ul class=""><li id="9b25" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><strong class="is hj">每列缺失数据</strong></li></ul><p id="4506" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每列中丢失值超过30%的20个特性被删除。这些特征与职称、年龄、建筑类型和交易现状有关。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/aaa0ead9e54b6ba6b8a805b8dbd6059b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sAjDXOYBBidGLNGv3F-cpg.png"/></div></div></figure><ul class=""><li id="6d84" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><strong class="is hj">每行缺失数据</strong></li></ul><p id="6379" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集分为两部分:subset_below(一行中少于20个缺失值)和subset_above(一行中多于20个缺失值)。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/9cdaacf7ffb66ceba1634d1ea8669898.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*_elo0yIt1-3NQBLuNx1BRw.png"/></div></figure><p id="3f9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了继续使用subset_below，绘制了两者上的特征分布，以检查分布是否保持不变。在具有许多缺失值的数据(subset_above)和具有很少或没有缺失值的数据(subset_below)之间，非缺失要素的分布看起来很相似，因此，从分析中删除这些点不会产生大问题。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/8c882d1da3ffb372463209c4bbce984f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Om2PT3AsishL0hwJDEStg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">比较特征LNR、AKT_DAT_KL、ALTER_HH和ANZ _豪沙尔特_阿克提夫在子集_下和子集_上的分布</figcaption></figure><ul class=""><li id="472c" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><strong class="is hj">特征编码</strong></li></ul><p id="31d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大多数特征已经有了数值。要素OST_WEST_KZ、CAMEO_INTL_2015、CAMEO _ INTL _ 2015 _财富、CAMEO _ INTL _ 2015 _人生阶段、CAMEO_DEU_2015被映射到数字要素，要素D19_LETZTER_KAUF_BRANCHE、CAMEO_DEUG_2015、EINGEFUEGT_AM被删除。</p><p id="279e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建了一个执行上述步骤的函数，用于一般人群和客户数据集:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/e0ecb73e0ebc4955f8c131b24f8d4f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*UepIyiEyaMUVfYFUb0Mb1w.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">函数来清理数据。azdias_attr_nan包含要编码为np.nan的未知值的信息</figcaption></figure><h1 id="c3c3" class="lt jq hi bd jr lu mu lw jv lx mv lz jz ma mw mc kc md mx mf kf mg my mi ki mj bi translated">使聚集</h1><p id="5c7e" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">在进行维度缩减之前，缺失值被估算，数据被缩放。(PCA无法处理缺失值)</p><h2 id="4523" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated"><strong class="ak">主成分分析</strong></h2><p id="1be8" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">对数据应用PCA以找到最大方差的向量。最初，将PCA与所有特征相匹配，这样就足以看到可变性的一般趋势。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/6123c9f572255fcafd8becf6b56336b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*zyoRnhpdld57bqfOZCHYkg.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">碎石图</figcaption></figure><p id="2c07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由前150个主成分解释的可变性的量是85%,因此PCA将再次用该值拟合，以用于项目的聚类部分。</p><p id="d576" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过查看每个主成分上特征的权重，可以解释主成分。权重离零越远，主分量在相应特征的方向上就越多。如果两个特征具有相同符号的大权重(负的或正的)，当一个增加时，另一个预计也会增加。因为具有不同符号的特征可以预期显示负相关:一个变量的增加应该导致另一个变量的减少。</p><p id="df3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">解释了前3个主要成分:</p><ul class=""><li id="be69" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><strong class="is hj">第一主成分:</strong></li></ul><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es na"><img src="../Images/1da0e6ee8b6553f839d0b6d02716f581.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*Lbed8lSR98q8R3bQaYMx4w.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第一主成分正权重</figcaption></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/50900b5e070c0d57d03d89608756ffc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*J1bCyZPPAcvTk3b_eBBS1Q.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第一主成分负权重</figcaption></figure><p id="828b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一个主成分与以下特征正相关:高社会地位和有车的小家庭。这表明第一个特征是关于更富裕和更小的家庭。</p><ul class=""><li id="f3b9" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><strong class="is hj">第二主成分</strong></li></ul><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/2a9c23b3cdf69811d73aa703ad78039d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PhTo6JD7EbPt9Zg-tkEJmw.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第二主成分正权重</figcaption></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nd"><img src="../Images/daabe1668e260ea4f3000f7d61689b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*g7s8KX746-vItbCzOdiRvA.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第二主成分负权重</figcaption></figure><p id="166b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这表明，这第二个特点是关于宝马和奔驰的跑车，大多由老年人拥有。</p><ul class=""><li id="9786" class="kp kq hi is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><strong class="is hj">第三主成分</strong></li></ul><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/6c238dacb7dc852b78257fc4b8a2d47f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*DFqa9KMPurjCchG7mSNDHg.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第三主成分正权重</figcaption></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nf"><img src="../Images/e225df637bcab1c6a3720effc65ceb7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*CoiA6KpdTSuGtslB01se1Q.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第三主成分负权重</figcaption></figure><p id="9027" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这表明，这第三个特征是关于具有更保守的财务习惯和不太可能花钱的人。</p><h2 id="4ded" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">面向普通人群和客户的聚类</h2><p id="534c" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">在本节中，<a class="ae jo" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans" rel="noopener ugc nofollow" target="_blank"> KMeans </a>用于将数据划分为聚类(人口/客户细分)。为了找到k(聚类数)的值，KMeans使用不同数量的k进行拟合，并根据从每个点到其分配的聚类质心的平均聚类内距离进行评估。此步骤会生成以下图:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ng"><img src="../Images/207b9a5237120584e262d15812187839.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*0cHTTHqe5yhLhhJ7hXvDUA.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">KMeans的膝盖图</figcaption></figure><p id="8872" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">平均距离随着聚类数量的增加而减小，因此k=19个聚类的值将用于拟合k均值，k均值将用于对人口执行聚类。将KMeans应用于客户和普通人群后，就可以比较每个集群中的人员比例。过度表示的聚类表示作为公司客户的人群的部分。代表性不足的聚类是不代表大部分客户的人群。例如，聚类16落在过度表示的聚类中。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nh"><img src="../Images/3ef620eb255626b84cb3e9675af9270d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sylnYQlBi2lvbDj1gx7ZLg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">普通人群和客户的聚类结果</figcaption></figure><p id="207b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以通过查看其特征权重来解释集群16和6:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ni"><img src="../Images/027bbfc4953da8c843ad62dcd4cb6635.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*-MRc93vXTtwckSGnbJkBvA.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第16组</figcaption></figure><p id="7d98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个集群代表高收入、有房一族、高社会地位、低流动性、低能耗和环境对他们很重要的家庭。倾向于节省金钱和高利息。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nj"><img src="../Images/4683d947442990aa8f3c21ef66c28559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*p1ki2Cz83wMmmxs0fGqD-w.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第6组</figcaption></figure><p id="3914" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个集群与高收入住宅区的上流社会的跑车(特别是宝马和奔驰)有关。</p><p id="7e24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可能会看到客户群中没有代表的人群(比较中代表不足的群)。例如，集群17:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nj"><img src="../Images/fa7cd51ef2cdd9516b21fa17a1d872ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*zlpdijHYLrVaNkYkGWmi1g.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">第17组</figcaption></figure><p id="a76f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该聚类代表在线存在感较低的人群，他们所在的地区的汽车拥有量低于平均水平。消费者类型:知情，低回报，平均/较低收入</p><h1 id="f6ab" class="lt jq hi bd jr lu mu lw jv lx mv lz jz ma mw mc kc md mx mf kf mg my mi ki mj bi translated">第2部分:监督学习模型</h1><p id="f288" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">在本节中，使用了一个数据集，每行代表一个邮寄活动的目标个人，以建立一个预测个人是否会成为公司客户的模型。</p><p id="365a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2.1型号</strong></p><p id="7f16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用第1部分中相同的清理函数清理数据。创建了一个新特征来表示可能是第1部分中解释的聚类16的一部分的人:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nk"><img src="../Images/c46ae04a3dbef267953c5a8f3cc24c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eaA-HLjkdTgkLUmcW4i_BQ.png"/></div></div></figure><p id="8fb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集存在类不平衡问题:只有1%的客户会成为客户(属于类1)，99%不会成为客户(属于类0)。为了解决这个问题，类0被缩减采样20倍。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nl"><img src="../Images/2d661416982dbfbda3738e75f290612b.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*vsfaiX8t2QhUgVk5zWYf6Q.png"/></div></figure><p id="ffc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">阶级不平衡仍然存在。甚至可以进行更多的下采样，但这意味着训练模型所需的数据更少。由于这种等级不平衡，准确性不是推荐的度量标准。因为99%的个体属于0类，所以仅仅预测他们都属于0类将给出99%的准确度。为了评估该模态，一个被称为<a class="ae jo" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html#sklearn.metrics.roc_auc_score" rel="noopener ugc nofollow" target="_blank">的度量标准是受试者操作特征曲线下面积(ROC AUC) </a>。</p><p id="c2d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下采样之后，数据被估算、缩放并分成训练集和测试集。用默认参数训练To模型:<a class="ae jo" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html" rel="noopener ugc nofollow" target="_blank"> AdaBoost </a>和<a class="ae jo" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html#sklearn.ensemble.GradientBoostingClassifier" rel="noopener ugc nofollow" target="_blank"> GradientBoosting </a>。结果是:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nd"><img src="../Images/df1123c18424b1f200d73471db85971a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*feqBq6neeiU5O_mKEP_OWw.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">梯度推进模型</figcaption></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nm"><img src="../Images/f9b81fc8b7d43f993c856cfb997fa3e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*au_LXxh52ZSqHun3q8QCKw.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">AdaBoost模型</figcaption></figure><p id="640a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后两个模型都被调整，看看哪一个有更好的最终表现。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nn"><img src="../Images/0827d17a6c57c6ea42ed8d42ae06fe27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPRO0XY83NSdCRtO88rfzw.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">AdaBoost参数调谐</figcaption></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es no"><img src="../Images/d217428981bc339b394f38ecc0250fc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2Cisjvd1oYUbBHwErYJKg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">梯度升压参数调谐</figcaption></figure><p id="8fe0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AdaBoost被选为最终模型，因为它运行速度更快，并且具有与GradientBoosting相似的结果。为了验证最终模型，使用了具有5个折叠的<a class="ae jo" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html" rel="noopener ugc nofollow" target="_blank">k折叠</a>交叉验证器，并获得了以下结果:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es np"><img src="../Images/66a7e8e6850bae66b283f2b9729d42fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*FuhBvkyTxOtOwibubdbz2w.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">使用具有5个折叠的KFold的AdaBoost模型验证</figcaption></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es nq"><img src="../Images/2878fbc9627eecc322f18c799bda48fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/format:webp/1*Dj9aTYTarLZX-E6gEdfEDA.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">KFold中每个折叠的曲线下面积值</figcaption></figure><h1 id="c6a0" class="lt jq hi bd jr lu mu lw jv lx mv lz jz ma mw mc kc md mx mf kf mg my mi ki mj bi translated">结论</h1><p id="808c" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">在第1部分中，可以将一般人群划分为不同的群体，如代表高收入、有房一族、高社会地位、低流动性、低能耗和环境对他们很重要的家庭的群体16。对一般人群和客户数据进行聚类后，就可以对它们进行比较，并找到公司客户的具体特征。</p><p id="c069" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第2部分中，可以建立一个模型，根据第1部分中分析的相同特征来预测一个人是否会成为公司的客户。调整参数后，AdaBoost的性能优于GradientBoosting。可以做的一个改进是使用<a class="ae jo" href="https://arxiv.org/pdf/1106.1813.pdf" rel="noopener ugc nofollow" target="_blank"> SMOTE </a>对少数民族进行上采样。</p><p id="ed50" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">面临的挑战之一是一般人群数据集很大:891221行和366列。加载数据集只需要大约5分钟。运行数据清理和PCA大约需要一个小时。<a class="ae jo" href="https://jakevdp.github.io/PythonDataScienceHandbook/05.11-k-means.html" rel="noopener ugc nofollow" target="_blank">因为KMeans的每次迭代都必须访问数据集中的每个点</a>，所以聚类部分也需要很长时间来运行。</p><p id="f747" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://github.com/belagoesr/nanodegree_capstone" rel="noopener ugc nofollow" target="_blank"> Github </a>上的代码。</p></div></div>    
</body>
</html>