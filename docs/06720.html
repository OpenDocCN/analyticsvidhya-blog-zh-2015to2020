<html>
<head>
<title>Python — Bisect Module — Search and Insert into a Sorted Array</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python二分模块-搜索并插入到排序数组中</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-bisect-module-search-and-insert-into-a-sorted-array-dee71500eb5c?source=collection_archive---------20-----------------------#2020-05-31">https://medium.com/analytics-vidhya/python-bisect-module-search-and-insert-into-a-sorted-array-dee71500eb5c?source=collection_archive---------20-----------------------#2020-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/8acf3e89a64ca208dd6d10d6b47ae089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*Xl5eNtZ67XFW_yyKKz9xSA.jpeg"/></div></figure><p id="1fb1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你有没有想过:<br/> 1。在排序后的数组中找到应该插入新元素的位置<br/> 2。向排序后的数组中插入一个元素并保持排序顺序</p><p id="0fb2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果是，那么这是给你的。</p><p id="0641" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">等分模块允许你在一个排序的数组中搜索一个插入点，并作为它的扩展来插入元素并保持排序的顺序。关键词是数组已经按照某种顺序排序。</p><p id="1d60" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正式文档是<a class="ae jk" href="https://docs.python.org/3/library/bisect.html" rel="noopener ugc nofollow" target="_blank">这里</a>T12】源代码是<a class="ae jk" href="https://github.com/python/cpython/blob/master/Lib/bisect.py" rel="noopener ugc nofollow" target="_blank">这里</a></p><p id="2408" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在中定义了以下方法:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="ee2c" class="ju jv hi jq b fi jw jx l jy jz">bisect.bisect_left<!-- -->(<em class="ka">a</em>, <em class="ka">x</em>, <em class="ka">lo=0</em>, <em class="ka">hi=len(a)</em>)<br/>bisect.bisect_right<!-- -->(<em class="ka">a</em>, <em class="ka">x</em>, <em class="ka">lo=0</em>, <em class="ka">hi=len(a))<br/></em>bisect.bisect<!-- -->(<em class="ka">a</em>, <em class="ka">x</em>, <em class="ka">lo=0</em>, <em class="ka">hi=len(a)</em>)<br/>bisect.insort_left<!-- -->(<em class="ka">a</em>, <em class="ka">x</em>, <em class="ka">lo=0</em>, <em class="ka">hi=len(a)</em>)<br/>bisect.insort_right<!-- -->(<em class="ka">a</em>, <em class="ka">x</em>, <em class="ka">lo=0</em>, <em class="ka">hi=len(a)</em>)<br/>bisect.insort<!-- -->(<em class="ka">a</em>, <em class="ka">x</em>, <em class="ka">lo=0</em>, <em class="ka">hi=len(a)</em>)</span></pre><p id="8070" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们看一些简单的例子来说明这些方法。让我们考虑一个元素已经存在的情况:</p><p id="76b3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du kb kc kd jq b">&gt;&gt;&gt; l = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]<br/>&gt;&gt;&gt; bisect.bisect_left(l, 5)<br/>5<br/>&gt;&gt;&gt; bisect.bisect_right(l, 5)<br/>6<br/>&gt;&gt;&gt; bisect.bisect(l, 5)<br/>6</code></p><p id="7d88" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正如你在上面看到的，<code class="du kb kc kd jq b">bisect</code>与<code class="du kb kc kd jq b">bisect_left</code>相似，但是<code class="du kb kc kd jq b">bisect</code>返回一个插入点，该插入点位于<em class="ka"> l </em>中任何现有条目5的后面(右边)。本质上<code class="du kb kc kd jq b">bisect and bisect_right are equivalent</code>。你可以在源代码<a class="ae jk" href="https://github.com/python/cpython/blob/master/Lib/bisect.py" rel="noopener ugc nofollow" target="_blank">的第79行看到。</a></p><p id="31a3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们看看如何使用这些方法在一个排序列表中插入:</p><p id="4aaa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du kb kc kd jq b">&gt;&gt;&gt; l<br/>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]<br/>&gt;&gt;&gt; bisect.insort_left(l, 5)<br/>&gt;&gt;&gt; l<br/>[0, 1, 2, 3, 4, <em class="ka">5</em>, 5, 6, 7, 8, 9]<br/>&gt;&gt;&gt; bisect.insort_right(l, 5)<br/>&gt;&gt;&gt; l<br/>[0, 1, 2, 3, 4, 5, 5, <em class="ka">5</em>, 6, 7, 8, 9]</code></p><p id="a1c2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="ka"> insort_left </em>相当于<code class="du kb kc kd jq b">a.insert(bisect.bisect_left(a, x, lo, hi), x)</code>假设<em class="ka"> a </em>是<strong class="io hj"> <em class="ka">已经排序</em> </strong>。请记住，O(log n)搜索由缓慢的<strong class="io hj"> <em class="ka"> O(n)插入步骤</em> </strong>控制。</p><p id="98d2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面强调了开发人员在使用它时需要记住的两件事，在进行复杂性分析时要记住它们。</p><p id="df69" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在为了让这个变得更有趣，我用lambda重写了文档中给出的例子:</p><p id="3524" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du kb kc kd jq b">&gt;&gt;&gt; get_grade = lambda score, breakpoints=[60, 70, 80, 90], grades=’FDCBA’ : grades[bisect.bisect(breakpoints, score)]</code></p><p id="adbf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du kb kc kd jq b">&gt;&gt;&gt; [f”Score {score} gets the Grade %s” % (get_grade(score)) for score in [33, 99, 77, 70, 89, 90, 100, -1, -1.0002] if score &gt;= 0]<br/>[‘Score 33 gets the Grade F’, ‘Score 99 gets the Grade A’, ‘Score 77 gets the Grade C’, ‘Score 70 gets the Grade C’, ‘Score 89 gets the Grade B’, ‘Score 90 gets the Grade A’, ‘Score 100 gets the Grade A’]</code></p><p id="1202" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">好吧，这两行只是让你接触了<em class="ka"> lambda，格式字符串和列表理解和数据验证【注意分数-1和-1.0002】</em>；-)是时候去探索了！</p><p id="f906" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，对于更高级的开发人员，请查看<a class="ae jk" href="https://code.activestate.com/recipes/577197-sortedcollection/" rel="noopener ugc nofollow" target="_blank">这个</a>。这是一个使用二等分构建全功能集合类的方法，该集合类具有直接的搜索方法和对键函数的支持。这些键是预先计算好的，以避免在搜索过程中对key函数进行不必要的调用。</p><p id="3189" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你需要一个例子来理解以上句子，请阅读以下内容:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="7110" class="ju jv hi jq b fi jw jx l jy jz">    &gt;&gt;&gt; from pprint import pprint<br/>    &gt;&gt;&gt; from operator import itemgetter<br/><br/>    &gt;&gt;&gt; s = SortedCollection(key=itemgetter(2))<br/>    &gt;&gt;&gt; for record in [<br/>    ...         ('roger', 'young', 30),<br/>    ...         ('angela', 'jones', 28),<br/>    ...         ('bill', 'smith', 22),<br/>    ...         ('david', 'thomas', 32)]:<br/>    ...     s.insert(record)<br/><br/>    &gt;&gt;&gt; pprint(list(s))         # show records sorted by age<br/>    [('bill', 'smith', 22),<br/>     ('angela', 'jones', 28),<br/>     ('roger', 'young', 30),<br/>     ('david', 'thomas', 32)]<br/><br/>    &gt;&gt;&gt; s.find_le(29)           # find oldest person aged 29 or younger<br/>    ('angela', 'jones', 28)<br/>    &gt;&gt;&gt; s.find_lt(28)           # find oldest person under 28<br/>    ('bill', 'smith', 22)<br/>    &gt;&gt;&gt; s.find_gt(28)           # find youngest person over 28<br/>    ('roger', 'young', 30)<br/><br/>    &gt;&gt;&gt; r = s.find_ge(32)       # find youngest person aged 32 or older<br/>    &gt;&gt;&gt; s.index(r)              # get the index of their record<br/>    3<br/>    &gt;&gt;&gt; s[3]                    # fetch the record at that index<br/>    ('david', 'thomas', 32)<br/><br/>    &gt;&gt;&gt; s.key = itemgetter(0)   # now sort by first name<br/>    &gt;&gt;&gt; pprint(list(s))<br/>    [('angela', 'jones', 28),<br/>     ('bill', 'smith', 22),<br/>     ('david', 'thomas', 32),<br/>     ('roger', 'young', 30)]</span><span id="956b" class="ju jv hi jq b fi ke jx l jy jz">Finding and indexing are O(log n) operations while iteration and insertion are O(n).  The initial sort is O(n log n). Time to impress in your next coding interview!</span></pre><p id="cf59" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有几个问题:</p><ol class=""><li id="00a3" class="kf kg hi io b ip iq it iu ix kh jb ki jf kj jj kk kl km kn bi translated">参数<em class="ka"> lo </em>不接受负指数，参见下面的<br/>T1】</li><li id="f564" class="kf kg hi io b ip ko it kp ix kq jb kr jf ks jj kk kl km kn bi translated">参数<em class="ka"> hi </em> <strong class="io hj">接受</strong>负指数，但<strong class="io hj"> <em class="ka">不使用</em> </strong>，因为行为不正确<br/> <code class="du kb kc kd jq b">&gt;&gt;&gt; l<br/>[0, 1, 2, 3, 4, 5, 5, 5, 6, 7, 8, 9]<br/>&gt;&gt;&gt; <br/>&gt;&gt;&gt; bisect.bisect_right(l, 5.1, 0, -2)<br/>0</code></li></ol><p id="133e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">参考资料:</p><p id="2f8a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://docs.python.org/3/library/bisect.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/bisect.html</a><br/>T22】https://code . active state . com/recipes/577197-sorted collection/</p></div></div>    
</body>
</html>