<html>
<head>
<title>Confusion Matrix — Is it really confusing?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">困惑矩阵——真的很困惑吗？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/confusion-matrix-is-it-really-confusing-8e2ad4332af0?source=collection_archive---------9-----------------------#2020-12-18">https://medium.com/analytics-vidhya/confusion-matrix-is-it-really-confusing-8e2ad4332af0?source=collection_archive---------9-----------------------#2020-12-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e93b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何机器学习模型建立的最关键和最基本的部分是“<strong class="ih hj">模型评估”阶段。</strong>平均而言，数据科学家要花60%的时间清理和组织数据，以确保模型更好的预测能力和性能。但是我们如何知道我们的模型是否有效呢？我们如何计算开发模型的性能？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2a83934c1f194e364ac3756a65a8b6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sgcRnrVqsFQ6_bPEmCX8hw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><code class="du jt ju jv jw b">Fig. 1: Machine Learning process flow</code></figcaption></figure><p id="d493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要一些评估指标来衡量绩效和有效性。一个这样的度量是<strong class="ih hj">混淆矩阵</strong>。有许多分类标准，但我们现在对混淆矩阵更感兴趣。</p><p id="e200" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的，我们现在知道混淆矩阵是一个度量，但是它到底是什么呢？先说一个基本定义。</p><p id="178e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混淆矩阵</strong>也称为误差矩阵，是一种特定的表格，通常用于描述分类模型对一组真实值已知的测试数据的性能。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jx"><img src="../Images/07a694aeaabdb602fcc80eb9f4feab55.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*IYfAEqJN6CDtBqS2WTN5Jg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><code class="du jt ju jv jw b">Fig. 2: Confusion Matrix (2-class)</code></figcaption></figure><p id="ca3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，下表显示了两类分类问题的混淆矩阵。这里的模型通过胸部X射线以100%的准确度检测Covid阳性患者。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jy"><img src="../Images/e920d4050a85d725cf72ceee3e3a4582.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*lriDCaHWjVNMn9xmePYuhQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><code class="du jt ju jv jw b">Fig. 3: <a class="ae jz" href="https://github.com/SaikrishnaDandamudi/BrainStation-Capstone-Project" rel="noopener ugc nofollow" target="_blank">Confusion Matrix of Covid positive and Normal patients</a></code></figcaption></figure><p id="1ed9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你会说，“太好了！我现在知道混乱矩阵是什么了，它看起来是什么样子。但是，我怎么读呢？”</p><p id="3b56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，让我们从混淆矩阵中的四个输出开始:</p><p id="f97b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。真正(TP) </strong>:简单来说就是你的预测是正的，是真的。</p><p id="0b19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回想一下上面的例子，模型预测82名受试者中有41名受试者是Covid阳性，这是真的。</p><p id="465b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。真阴性(TN): </strong>表示我们预测没有，他们没有患病。</p><p id="12b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型预测82名受试者中的其余41名受试者没有Covid，因此他们是正常的。</p><p id="a010" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。假阳性(FP): </strong>意思是我们预测的没错，但是他们没有这个病。这也被称为“<strong class="ih hj">I型错误</strong>”。</p><p id="8e87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，模型运行良好，所以我们没有I类错误。但是假设这个模型预测了一个病人的假阳性，这可能会导致严重的并发症。病人要接受更多的检查，有时这会给病人和医务人员带来不必要的经济和精神负担。</p><p id="dbc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">犯第一类错误的后果意味着做出不必要的改变或干预，从而浪费时间、资源等。</p><p id="c762" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。假阴性(FN): </strong>意思是我们预测没有，但是他们有这个病。这也被称为“<strong class="ih hj">II型错误</strong>”。</p><p id="190b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的病例中没有II型错误，但是如果我们的模型在Covid的病例中预测到假阴性，这将不仅对患者而且对其他人产生严重的影响，因为现在他可能会不知不觉地将它传给他可能接触的人。这些有更糟糕的影响，因为有时他们没有得到他们需要的医疗护理来阻止任何进一步的并发症。</p><p id="340b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">犯第二类错误的后果是在需要改变时保持现状(即干预保持不变)。</p><p id="83af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混淆矩阵不仅仅是我们上面讨论的四个重要概念。这些有时也被称为高级分类指标，并以数学方式表达。</p><blockquote class="ka kb kc"><p id="8ab0" class="if ig kd ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj">敏感度</strong>，也称为召回率或真阳性率，是对正确识别的真阳性的衡量。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kh"><img src="../Images/e54b4f89f77f31c0d723998db79c2afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*lvcQJRFC4kgkowsjB8G9vQ.png"/></div></figure><p id="9c46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回到我们的模型，它只不过是实际患有COVID并被模型预测为真实的患者的比例。当然，我们希望这个值尽可能的高。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ki"><img src="../Images/a7c3cff998b75b96f9f37ab3947721b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*Az4vMz_L9Ve-SVVdo_NvBw.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/9194aba391b8c395acf3d6193dacaf46.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*PRgnxB0Gs5K4Yl0ySRHWdw.png"/></div></figure><blockquote class="ka kb kc"><p id="bc52" class="if ig kd ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj">特异性</strong>，也称为真阴性率，是对正确识别的真阴性的度量。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kk"><img src="../Images/f6fde04caeebd9239f00856023afc757.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*dRejZ02qDX8Kh-FwTMfBVA.png"/></div></figure><p id="2bc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的病例中有41个真阴性，0个假阳性，特异性为100%。与敏感度类似，我们也希望这个数字更高。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/afda6178cdd3e435b6542604efaf6c23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*RM1SzAaRFuoYwUtYOXh7UA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es km"><img src="../Images/a956c8cff9bc4a7c8be32e99f032fe94.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*yxHtvJocPGXcqQJcEUi4lQ.png"/></div></figure><blockquote class="ka kb kc"><p id="4edd" class="if ig kd ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj">精度</strong>是真阳性数量与真阳性数量加上假阳性数量之比。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kn"><img src="../Images/059ea58f039ee245e247bd22e6ce1123.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*9Wh3VStCWhA3H85tG2WkMA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ko"><img src="../Images/3974ef2cc63603ec7a2a682784dad0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*4XrAQC6Bb77Wxb4UnYMQ_g.png"/></div></figure><p id="4955" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于我们的例子，精度是100%,因为我们的误报是0。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kp"><img src="../Images/76938ab6087042e2eb5dae99b3d60d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*3o2SuyIt6NM_GMmA1gXkGQ.png"/></div></figure><blockquote class="ka kb kc"><p id="8654" class="if ig kd ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj">准确度</strong>就是当前被识别的总样本的分数。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kq"><img src="../Images/e8c694239bfefa0b8fc2aa064c96d6f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*yl2lzyVV50v3-oYRJLl9Ww.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/5b8542d32ce3f0a1aee88d9e70820546.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*nx0QRAfSbz9GxTEYLixkng.png"/></div></figure><p id="63d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的模型有100%的准确性。但是让我们把数字放到数学表达式中，以便验证。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/57f21712202d8590b9b19a9d1c5fbe01.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*9Hx8badq_CtSXqScBuED9w.png"/></div></figure><blockquote class="ka kb kc"><p id="b28c" class="if ig kd ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj"> F1得分</strong>是精度和灵敏度的调和平均值。这是对测试准确性的一种衡量。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/2e7fe63f860f34b203e0ee0549a75674.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*mMK9B5FFdQzJ-ROcs9gkOA.png"/></div></figure><p id="b363" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你寻求精确度和召回率之间的平衡时，F1分数是一个很好的选择。</p></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="2682" class="lb lc hi bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">利用Python和scikit——为混淆矩阵获得库</h1><p id="a321" class="pw-post-body-paragraph if ig hi ih b ii lz ik il im ma io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">在研究Covid阳性患者的胸部X射线分类问题时，我有机会使用sci-kit学习库来生成混淆矩阵，以分析我的模型的性能。</p><p id="6235" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码和项目信息可在<a class="ae jz" href="https://github.com/SaikrishnaDandamudi/BrainStation-Capstone-Project/blob/master/Binary_Classification_Modeling.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es me"><img src="../Images/33056376d58d70f40b086e7fa56c1f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ge_Hed7AYWS6w68tvv0LQg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/a3020e104941c8fcfc7734c7b44cfcd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pwaig3860FDpZK4yOPRmBw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/d3937ea4dc7a21ec69d3feeb6dd4e8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nho2pPpVYOKAIq7z7e0AMA.png"/></div></div></figure><h1 id="a26f" class="lb lc hi bd ld le mh lg lh li mi lk ll lm mj lo lp lq mk ls lt lu ml lw lx ly bi translated">评估模型和分类报告</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/0b3a3127f94633b91df0701b0c19d570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZiUyhKFaPGhn4tsYHuTWQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es me"><img src="../Images/befbd2da01dce634997e17b9a6bf48e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPFZUt0RhnxLGRueuYmmrA.png"/></div></div></figure><p id="0b60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以我的经验来看，混淆矩阵是众多可用于评估我们的分类模型的优秀指标之一。作为一名数据科学家，理解一个混淆矩阵和解读一份分类报告是一项必备技能。</p><p id="8f00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望我为您提供了对这些概念的基本理解，并向您展示了如何利用这些概念来评估您自己的模型。如果你有任何问题，请联系我。如果你喜欢文章，想分享，请随意！</p></div></div>    
</body>
</html>