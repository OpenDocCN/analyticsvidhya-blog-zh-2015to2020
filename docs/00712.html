<html>
<head>
<title>Golang channels usage in pipeline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">管道中使用的Golang渠道</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/golang-channels-use-in-pipeline-36edd8e107ae?source=collection_archive---------8-----------------------#2019-08-30">https://medium.com/analytics-vidhya/golang-channels-use-in-pipeline-36edd8e107ae?source=collection_archive---------8-----------------------#2019-08-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0f690b9b25b03322088cb59ec44b8771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PgItMa73VMWT_iShWhlsxQ.jpeg"/></div></div></figure><p id="499b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通道可以以不同的方式使用，包括向go例程发送值或go例程之间的通信，这是核心功能。</p><p id="0d58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通道的一个重要用途是控制管道级的流动。管道被用作具有多个下行流和上行流的阶段，其中数据通过通道流动。</p><p id="1fc2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">golang内部有一个关于管道及其使用的漂亮博客。</p><div class="jo jp ez fb jq jr"><a href="https://blog.golang.org/pipelines" rel="noopener  ugc nofollow" target="_blank"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hj fi z dy jw ea eb jx ed ef hh bi translated">Go博客</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">same er aj mani 2014年3月13日简介Go的并发原语使构建流数据管道变得很容易…</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">blog.golang.org</p></div></div><div class="ka l"><div class="kb l kc kd ke ka kf io jr"/></div></div></a></div><p id="14bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在go例程中，通道是控制管道阶段中的流的一个很好的工具，其中每个阶段对通过通道发送的值进行一些处理，并在出站通道上返回值，这些值可以根据需要进一步处理。</p><p id="aa55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于在流水线阶段内定义的go例程中处理来自多个通道的数据，使用<em class="kg">选择</em>，它提供了一种退出或处理来自通道的数据的方法。</p><p id="09f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来看一个例子，当你和golang频道一起工作时，将会有什么样的方法，以及如何使用它们作为你最强有力的工具。</p><figure class="kh ki kj kk fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="d02d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们继续上面的例子，我们可以看到通道被用来控制通过go例程的数据流。在golang工作了4年后，我从通道中学到的一个概念是，通道不仅可以用于向其他go例程发送信号，还可以用于控制它们(何时退出处理)。</p><p id="03ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们谈论使用通道控制go例程时，我们需要将同一个通道传递给所有go例程，我们可以使用该通道来控制这些go例程。因此，如果我们关闭共享通道并使用<em class="kg">选择</em>检查通道状态，它将发送共享相同信号通道的所有go例程的关闭状态值。这种使用单一通道向所有围棋程序发送信号的概念可以相应地用在不同的场景中。</p><p id="f4a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的例子中，我们使用done channel发送信号作为空结构来通知所有的go例程。</p><p id="65e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">举例:</strong></p><p id="1175" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们想将一个用户数据插入数据库，如果插入，我们需要在api上获取值，或者使用多个go例程对相同的值执行其他相同的操作。</p><p id="1679" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，如果用户没有被插入，并且有一个错误，那么发送该值到所有的go例程，这些例程正在等待输入通道上的值，因为有一个错误而不等待。通道来了，你可以通知其他功能出问题了。使用<em class="kg">选择</em>，它将等待一个值或一个信号，该值或信号将告诉go程序在父go程序出错时退出。</p><figure class="kh ki kj kk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/9ac5b2be986d76ad88d661741b49af1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1VbGXPcLv9dpu0oG4RS5IA.png"/></div></div></figure><p id="11e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的例子中，我通过关闭频道发送了一个信号，并使用<em class="kg">选择</em>等待用户频道或完成频道。</p><p id="5a37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">结论:</strong></p><p id="1891" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些通道可用于控制多个go程序，条件是如果go程序在数据上相互链接，则相同的通道作为信号通道传递给所有go程序。</p></div></div>    
</body>
</html>