<html>
<head>
<title>AWS Lambda (Python) + MS SQL Server — The Easy Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Lambda (Python) + MS SQL Server —简单的方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/aws-lambda-python-ms-sql-server-the-easy-way-e7667d371cc5?source=collection_archive---------0-----------------------#2020-05-02">https://medium.com/analytics-vidhya/aws-lambda-python-ms-sql-server-the-easy-way-e7667d371cc5?source=collection_archive---------0-----------------------#2020-05-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="d9f9" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Lambda层从AWS Lambda连接到MS SQL的快速方法</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/3481d648b8c7e064c5d7251548f8ef4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p-pUpFrNdP_dGX1k"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/photos/D7Q6JpFleK8" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/D7Q6JpFleK8</a></figcaption></figure><h1 id="1b8b" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">pyodbc</h1><p id="b8a3" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">pyodbc是一个开源Python模块，它使得访问odbc数据库变得简单。它实现了<a class="ae jn" href="https://www.python.org/dev/peps/pep-0249" rel="noopener ugc nofollow" target="_blank"> DB API 2.0 </a>规范，但是打包了更方便的Pythonic。这是为了使用python桥接odbc连接而构建的。</p><h2 id="fbe2" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">第一步:</h2><p id="af85" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">根据您的python版本，仅下载所需的文件。打开<strong class="ki hj">的包装。所以</strong>文件在工作目录下。</p><h2 id="22e2" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">第二步:</h2><p id="5317" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">现在打开你最喜欢的编辑器，开始编码。</p><pre class="iy iz ja jb fd lq lr ls lt aw lu bi"><span id="3148" class="lc jp hi lr b fi lv lw l lx ly">import pyodbc </span><span id="b24c" class="lc jp hi lr b fi lz lw l lx ly">def lambda_handler(event,context):<br/>    conn = pyodbc.connect('Driver={SQL Server};'<br/>                          'Server=server_name;'<br/>                          'Database=db_name;'<br/>                          'Trusted_Connection=yes;')<br/><br/>    cursor = conn.cursor()<br/>    cursor.execute('SELECT * FROM db_name.Table')<br/><br/>    for row in cursor:<br/>        print(row)</span></pre><h2 id="e234" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">第三步:</h2><p id="1b15" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">将上面的文件另存为<strong class="ki hj">lambda _ function . py</strong><em class="ma"/>，这样你的lambda就可以在你的代码中调用这个处理程序了。</p><h2 id="0f4b" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">第四步:</h2><p id="3693" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">压缩文件夹中的所有文件。这是给你的参考结构。</p><pre class="iy iz ja jb fd lq lr ls lt aw lu bi"><span id="0789" class="lc jp hi lr b fi lv lw l lx ly">├─── &lt;parent_folder&gt;<br/>├─────── lambda_function.py<br/>├─────── libodbc.so.2<br/>├─────── pyodbc.so</span></pre><h2 id="fc74" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">第五步:</h2><p id="2a31" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在lambda函数中上传zip文件。</p><p id="bfb0" class="pw-post-body-paragraph kg kh hi ki b kj mb ij kl km mc im ko kp md kr ks kt me kv kw kx mf kz la lb hb bi translated">完成了吗？不会。这只会为你加载pyodbc库，但不能连接到MSSQL，因为这需要OBBC驱动程序。这意味着您必须遵循以下步骤:</p><ol class=""><li id="3aab" class="mg mh hi ki b kj mb km mc kp mi kt mj kx mk lb ml mm mn mo bi translated">下载Unix ODBC驱动程序</li><li id="f2b6" class="mg mh hi ki b kj mp km mq kp mr kt ms kx mt lb ml mm mn mo bi translated">从源代码编译Unix ODBC</li><li id="da76" class="mg mh hi ki b kj mp km mq kp mr kt ms kx mt lb ml mm mn mo bi translated">将二进制文件复制到应用程序目录</li><li id="c6d8" class="mg mh hi ki b kj mp km mq kp mr kt ms kx mt lb ml mm mn mo bi translated">下载Microsoft SQL Server ODBC驱动程序</li><li id="dc5f" class="mg mh hi ki b kj mp km mq kp mr kt ms kx mt lb ml mm mn mo bi translated">安装Microsoft SQL Server ODBC驱动程序</li><li id="aa0d" class="mg mh hi ki b kj mp km mq kp mr kt ms kx mt lb ml mm mn mo bi translated">为unixODBC复制MS SQL驱动程序二进制文件</li><li id="5ab8" class="mg mh hi ki b kj mp km mq kp mr kt ms kx mt lb ml mm mn mo bi translated">创造。驱动程序路径配置的ini文件</li><li id="1812" class="mg mh hi ki b kj mp km mq kp mr kt ms kx mt lb ml mm mn mo bi translated">将整个东西打包成一个. zip文件</li></ol><p id="42ef" class="pw-post-body-paragraph kg kh hi ki b kj mb ij kl km mc im ko kp md kr ks kt me kv kw kx mf kz la lb hb bi translated">太多了？我已经包装好了—</p><div class="mu mv ez fb mw mx"><a href="https://github.com/kuharan/Lambda-Layers" rel="noopener  ugc nofollow" target="_blank"><div class="my ab dw"><div class="mz ab na cl cj nb"><h2 class="bd hj fi z dy nc ea eb nd ed ef hh bi translated">库哈兰/λ层</h2><div class="ne l"><h3 class="bd b fi z dy nc ea eb nd ed ef dx translated">python的AWS lambda图层集合。通过在…上创建帐户，为kuharan/Lambda层开发做出贡献</h3></div><div class="nf l"><p class="bd b fp z dy nc ea eb nd ed ef dx translated">github.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl jh mx"/></div></div></a></div><p id="dc7d" class="pw-post-body-paragraph kg kh hi ki b kj mb ij kl km mc im ko kp md kr ks kt me kv kw kx mf kz la lb hb bi translated">如果需要，只需下载zip和示例代码。只需上传这个压缩文件作为lambda层，然后就大功告成了！</p><p id="5270" class="pw-post-body-paragraph kg kh hi ki b kj mb ij kl km mc im ko kp md kr ks kt me kv kw kx mf kz la lb hb bi translated">这是我在测试这一切时制作的一个快速视频。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nm nn l"/></div></figure><p id="31f7" class="pw-post-body-paragraph kg kh hi ki b kj mb ij kl km mc im ko kp md kr ks kt me kv kw kx mf kz la lb hb bi translated">您刚刚将AWS Lambda连接到Microsoft SQL Server。现在你是无服务器计算的老板！</p><p id="2d5f" class="pw-post-body-paragraph kg kh hi ki b kj mb ij kl km mc im ko kp md kr ks kt me kv kw kx mf kz la lb hb bi translated">测试人员注意:</p><blockquote class="no"><p id="2531" class="np nq hi bd nr ns nt nu nv nw nx lb dx translated">符合python 3.7和用于SQL Server的ODBC驱动程序17。</p></blockquote><p id="62ad" class="pw-post-body-paragraph kg kh hi ki b kj ny ij kl km nz im ko kp oa kr ks kt ob kv kw kx oc kz la lb hb bi translated">相关的<strong class="ki hj"> StackOverflow </strong>关于我最初做了什么以及现在处于什么位置的问题—</p><div class="mu mv ez fb mw mx"><a href="https://stackoverflow.com/questions/48016091/unable-to-use-pyodbc-with-aws-lambda-and-api-gateway/61555952#61555952" rel="noopener  ugc nofollow" target="_blank"><div class="my ab dw"><div class="mz ab na cl cj nb"><h2 class="bd hj fi z dy nc ea eb nd ed ef hh bi translated">无法将pyodbc与AWS lambda和API网关一起使用</h2><div class="ne l"><h3 class="bd b fi z dy nc ea eb nd ed ef dx translated">我试图建立一个AWS Lambda功能使用API网关，利用pyodbc python包。我已经跟踪了…</h3></div><div class="nf l"><p class="bd b fp z dy nc ea eb nd ed ef dx translated">stackoverflow.com</p></div></div><div class="ng l"><div class="od l ni nj nk ng nl jh mx"/></div></div></a></div></div></div>    
</body>
</html>