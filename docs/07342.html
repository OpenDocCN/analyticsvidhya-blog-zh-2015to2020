<html>
<head>
<title>Looking for the Best SQL-On-File Tool</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">寻找最好的文件SQL工具</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/looking-for-the-best-sql-on-file-tool-7744ff3d015b?source=collection_archive---------13-----------------------#2020-06-22">https://medium.com/analytics-vidhya/looking-for-the-best-sql-on-file-tool-7744ff3d015b?source=collection_archive---------13-----------------------#2020-06-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c1fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SQL是基于数据库的。这意味着在我们可以用流行的查询语言处理文件之前，需要先将文件加载到数据库中。数据加载并不总是方便的。所以可以直接在文件上执行SQL的工具被设计来避免麻烦。这些工具在工作环境、可用性、SQL执行能力和格式要求方面有很大不同。我尝试了很多，发现esProc对于数据分析师来说是最容易和最有效的。让我解释一下我的发现。</p><p id="3459" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过近50年的演变，SQL已经成为一种流行的、成熟的、使用方便的查询语言。它的用户包括程序员、数据分析师和科学研究人员。该语言受多种平台支持，如单机上的Access language、局域网上的MySQL和云上的Hadoop。</p><p id="27a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是要使用这种熟悉的语言来处理存储在CSV/TSV/XLS等格式的文件中的数据，我们需要首先将数据加载到数据库中。这既费时又费力，因为您需要创建表结构、命名字段、设置数据类型、分配权限，然后等待文件加载。当因为数据量变大，甚至巨大，需要加载几个甚至更多的文件，需要处理表空间不足或者定期更新导致的重复加载，这就很可怕了。</p><p id="08cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这还不是最糟糕的。某些文件无法加载到数据库中；有些是无法处理的，即使我们设法让他们进来。通常它们在开头或结尾包含无用数据和非法分隔符(如不可见字符和双字符)，或者具有非标准化的文本格式，如一行对应多条记录。在这种情况下，合理的方法是用Python或JAVA这样的编程语言来计算它们。这里有一个例子:</p><blockquote class="je jf jg"><p id="8abe" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">姓名、州名、行程</p><p id="8af3" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">科罗拉多州史密斯市，2020年1月2日</p><p id="ee5e" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">康涅狄格州杰夫，2020年1月9日</p><p id="6f35" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">印第安纳州史密斯，2020年1月21日</p></blockquote><p id="e863" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，大部分数据库都不支持导入XLSX文件。您需要安装Excel或第三方工具才能将它们放入。两者都是麻烦和头痛。使用Excel时，XLSX文件需要转换为CSV格式才能加载。借助第三方工具，您可以直接加载它们，但必须先完成复杂的配置。有时该工具只支持XLS文件，而其他时候它们只支持XLSX的较低版本。</p><p id="7f12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总而言之，将文件加载到数据库一点也不方便。</p><p id="efdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果有一个工具可以直接对文件执行SQL，那么数据加载就没有必要了。无装载麻烦，效率更高。此外，将不再需要数据库。性价比很高。</p><p id="d0de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种工具前景广阔，它们已经一个接一个地问世。</p><p id="d0b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是缺陷是存在的。有些是致命的。让我带你穿过它们，找到它们真正的力量。轻量级命令行工具是我的第一个目标。</p><p id="26bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> csvsql </strong></p><p id="facc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">csvsql本质上是紧凑和快速的。要将一个<em class="jd"> sales.csv </em>文件分组，该文件包含按客户分类的列标题和每组的总金额，您只需要一行代码:</p><blockquote class="je jf jg"><p id="0711" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">d:\ CSV kit \ CSV QL \ bin &gt; CSV SQL—查询“按客户从‘销售’组中选择客户，总和(金额)”salse.csv</p></blockquote><p id="d1f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不幸的是，csvsql有更多的缺点。最大的问题是复杂的安装和配置。由于它不是一个独立的应用程序，而只是一个Python脚本，因此用户需要配置一个Python环境并下载合适的函数库才能使用第三方应用程序。这对程序员来说很容易，但对数据分析师来说就不容易了。</p><p id="d9ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">csvsql没有自己的计算引擎。这是第二大问题。它有一个内置的SQLite数据库。在您完成SQL查询、创建一个表、将文件加载到SQLite、将SQL-on-file转换为SQL-on-database-table，然后执行数据库转换之后，它将在内存模式下启动它。</p><p id="5e16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">缺乏独立的计算引擎导致SQL功能有限。csvsql必须根据sqlite实现设计一组SQL语法，并将SQL-on-file查询转换为SQL-on-database-table查询。没有坚实的技术基础，工具别无选择，只能跟风。它不能照顾到翻译的每个方面，因此放弃了许多基本功能，如SQLites支持的模糊查询和日期功能。</p><p id="fa9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他后果是低性能和文件大小限制。csvsql并不真正对文件执行sql，而是将文件导入内存进行处理。加上类型转换，这既耗时又影响性能。文件从磁盘导入内存后会扩展很多。如果文件大小大于内存空间，数据加载将会非常慢，并且很可能会出现内存溢出。因此，您必须确保文件大小合适。</p><p id="3535" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样的劣势是由于csvsql的技术地位较弱。这解释了它的其他缺点。</p><p id="aa84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该工具仅支持文本文件。甚至常用的日常使用的Excel文件也不包括在内。这是第三个缺点。</p><p id="8929" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第四个是它对文本格式施加了太多的限制。它只能读取最基本的CSV格式。为了在第一行实现分隔符定义、行跳转和列标题识别等功能，您需要使用文本编辑器进行预处理。如果在开头或结尾有无用的数据、非法的分隔符(不可见的字符和双字符)或者如果文件有非标准化的格式，您需要使用Python和JAVA这样的编程语言进行预处理。</p><p id="27e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似的命令行工具还有很多，比如textql、queryscv.py和q，本质上都是一样的，都有相同的弱点。</p><p id="b039" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管命令行工具没有自己的计算引擎，但数据库系统有。HSQLDB就是这样一个流行的文件上SQL数据库。</p><p id="890a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> HSQLDB </strong></p><p id="a0c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个数据库系统反映了其制造商的技术实力。HSQLDB不仅有自己的计算引擎，还提供了强大的SQL语法，从连接查询和子查询到模糊查询和数据函数。这是命令行工具无法比拟的。</p><p id="c32e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是安装、管理和维护一个数据库系统并不容易。维护特别复杂。它涉及权限、磁盘空间、内存空间和缓冲空间的分配以及各种复杂参数的配置。对于数据分析师来说，它们相当困难。实际上，我们希望直接在文件上执行SQL的一个重要原因是为了避免数据库维护。</p><p id="bc69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了复杂的日常维护和管理，执行SQL的步骤也不简单。</p><p id="6634" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">启动HSQLDB服务器和客户机的命令的格式很复杂(当然，您可以选择第三方客户机工具，如SQuirreL SQL来完成这项工作)。</p><blockquote class="je jf jg"><p id="a776" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">d:\ JRE 1.8 \ bin &gt; Java–xms 128m–xmx 2403m-CP d:\ hsql \ hsqldb . jar org . hsqldb . server . server-database . 0 file \ hsql \ database \ demo-dbname . 0 demo</p><p id="dbd8" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">d:\ JRE 1.8 \ bin &gt; Java-xms 128m-xmx 2403m-CP d:\ hsql \ hsqldb . jar org . hsqldb . util . database manager</p></blockquote><p id="e847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于一个非Java专家来说，这是令人生畏的。</p><p id="4d26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从客户端连接到服务器的参数配置也不简单。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jk"><img src="../Images/b6a1db62d037ea57949742e2ffe1cc18.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*B9Xfvx9qtVS8j7w4e2EmIQ.png"/></div></figure><p id="a545" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在执行SQL查询之前，需要执行一些预处理语句来删除可能已经存在的表名，创建新的表结构并将文件映射到表上。映射需要大量的参数配置，如下所示:</p><blockquote class="je jf jg"><p id="ae4f" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">设置表格销售来源" sales.csvfs=，；编码= UTF-8；引用=假；ignore _ first = truecache _ scale = 100 "；</p></blockquote><p id="fae1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了复杂的过程之外，HSQLDB的设计对用户不友好，而且会影响性能。它不支持自动解析数据类型，所以用户必须创建自己的表结构。许多文件，尤其是CSV，在第一行记录字段名称。那用起来方便。但是HSQLDB要求用户专门指定字段名称。这使得现成的字段名完全无用。即使数据库的启动模式是服务器模式而不是内存模式，数据库也会预先将文件缓冲到内存中。这会影响整体性能，尤其是当文件相对较大时。</p><p id="824e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管打包在一个独立的计算引擎中，但HSQLDB是在数据库表上运行的，而不是真正的文件计算引擎。这解释了其不合理的设计，包括缺乏对Excel文件的支持以及常见和非常规的文本格式。</p><p id="78d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本质上类似的数据库产品还包括H2数据库和PostgreSQL。它们有相同的优点和缺点。</p><p id="4ada" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总之，数据库中没有真正的文件计算引擎。我们只发现复杂的安装、管理、分配和执行程序。有没有一个桌面工具，有真正的文件计算引擎，用户友好的界面，并且简单易用？是的，有。</p><p id="4260" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> OpenOffice Base </strong></p><p id="bfa2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">OpenOffice Base非常容易使用。它的一键式安装使其无需配置即可使用，并且它具有平滑和快速响应的用户友好界面。</p><p id="a7ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它还有一个真正的文件计算引擎，可以直接处理文件，而不需要额外的数据加载和数据库引擎。它有三个显著的改进—自动数据类型识别、大数据处理能力和高性能。</p><p id="0562" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它仍然有问题。</p><p id="2261" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，OpenOffice Base不支持常用的Excel文件，只支持文本文件。这限制了它的应用场景。</p><p id="57fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其次，它的SQL功能非常有限。许多基本功能都没有，比如连接查询:</p><blockquote class="je jf jg"><p id="728d" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">select employee.name，sales.orderdate，sales . amount from sales left join employee on sales . sellerid = employee . Eid</p></blockquote><p id="8715" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第三，它对文本格式的限制太多。</p><p id="30b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了默认格式，它不支持任何其他格式的数据类型，例如下面的特殊格式的日期:</p><blockquote class="je jf jg"><p id="d03e" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">订单id，客户，卖方id，金额，订单日期</p><p id="79f0" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">2012年1月1日至2012年1月1日</p><p id="8ae5" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">SJCH，2012年1月31日</p></blockquote><p id="8ee5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它不支持特殊分隔符，例如:</p><blockquote class="je jf jg"><p id="169e" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">订单id | |客户| |卖方id | |金额| |订单日期</p><p id="36b1" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">1 | | UJRNP | | 17 | | 392.0 | | 2012–01–01</p><p id="2c44" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">2||SJCH||6||4802.0||2012年1月31日</p></blockquote><p id="902f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它不能处理复杂格式的文件，例如:</p><blockquote class="je jf jg"><p id="cb44" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">制片人:艾伦</p><p id="a44c" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">日期:2013–11–01//前两行没用</p><p id="9181" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">26 //由多行组成的记录</p><p id="6918" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">TAS 1 2142.4</p><p id="9a85" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi">2009–08–05</p><p id="5668" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi">33</p><p id="4bf9" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">DSGC 1 613.2</p><p id="cac1" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi">2009–08–14</p></blockquote><p id="c08f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果对标准格式的文本文件进行基本查询，OpenOffice Base是首选。但现实世界的企业并不是标准化的教科书场景。经常会遇到Excel文件，有各种文本格式和SQL算法。有没有一种灵活的方法来处理动态的现实？编程语言的集成组件提供了一个相对完美的解决方案。</p><p id="acc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">微软text/xls驱动</strong></p><p id="240a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">微软text/xls驱动程序是一个由值得信赖的供应商开发的强大工具。它很好地支持SQL语法。从模糊查询、日期函数到子查询和连接查询，几乎涵盖了所有可能的算法。例如，要连接两个CSV文件:</p><blockquote class="je jf jg"><p id="62ae" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">select client.clientname，sales.orderdate，sales . amount from[sales . CSV]as sales left join[client . CSV]as client on sales . clientid = client . clientid</p></blockquote><p id="b051" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">集成组件支持各种文件类型，包括TXT/CVS/TVS和所有版本的XLS/XLSX。那确实是体贴的。</p><p id="cfee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它为常见的文本格式提供了出色的支持，例如分隔符定义、首行上的列名标识、固定宽度的列配置和自动数据类型标识。对于复杂的文本格式，它允许通过编码来处理它们。它旨在使程序员能够阅读任何格式的文本，并在业务中实现任何算法。</p><p id="6cad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">微软的text/xls驱动器拥有一个强大的文件计算引擎。这台发动机的功能几乎齐全。唯一的一点是，它是为程序员设计的，而不是数据分析师。</p><p id="00f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用的技术门槛高。你必须熟悉一种编程语言，C#或VB。而且你需要掌握三个编程接口中的一个——ODBC、OLEDB、ADO。</p><p id="228c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你需要写很多难以理解的代码来执行，比如上面的SQL查询。以下是简化版:</p><blockquote class="je jf jg"><p id="78ca" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">connstring = "Provider=Microsoft。ACE . OLEDB.12.0数据源= "+path+"；扩展属性= ' textHDR =是；FMT =分隔'；"；</p><p id="d349" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">数据集ds = null</p><p id="f907" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">OleDbConnection conn = null</p><p id="ab64" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">尝试</p><p id="1029" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi">{</p><p id="329f" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">conn = new oledb connection(connstring)；</p><p id="2b68" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">conn . Open()；</p><p id="0380" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">oledb dataadapter my command = null；</p><p id="38df" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">my command = new oledb dataadapter(strSql，connstring)；//开始执行SQL</p><p id="5907" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">ds =新数据集()；</p><p id="24a3" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">我的命令。Fill(ds，“表1”)；</p><p id="ce96" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi">}</p><p id="9ada" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">捕捉(例外e)</p></blockquote><p id="d298" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也很难规模化。上述代码仅适用于标准格式的文本文件。要定义字符串格式或数据类型，您需要配置文件中的schema.in。要解析复杂格式的文本，需要编写大量额外的代码。</p><p id="b0ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个问题是，尽管文本驱动程序和xls驱动程序的用途相似，但它们是相互独立的。换句话说，你不能直接连接一个文本文件和一个Excel文件，而是需要编写大量额外的代码。</p><p id="2b1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CSVJDBC/ExcelJDBC和SpatiaLite是具有不同语言环境的相似类型的集成组件。两者都要求很高。但都不如微软text/xls驱动。</p><p id="2b39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Microsoft text/xls驱动程序有一个完整但难以使用的文件计算引擎。OpenOffice Base易于使用，但没有强大的文件计算引擎。所以，一个理想的工具应该是兼具两者优点并且适合数据分析师的工具。我只找到一个合格的产品。</p><p id="0d35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> esProc </strong></p><p id="9222" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与OpenOffice Base相同，esProc是一个易于使用的桌面工具，无需进一步配置即可一键安装。它更容易使用，因为它允许用户直接在单元格中编写多个SQL语句，并在同一界面上显示计算结果。您可以通过单击保存SQL语句的单元格来查看结果。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es js"><img src="../Images/b342f02792bc522ba575070e16a058c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*rAI4aELXS1QD33sbAtu2QQ.png"/></div></figure><p id="ae2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">esProc有一个完整而强大的计算引擎，支持现实业务中的所有SQL语法(参见上面的图片)。这使它成为最好的微软文本/xls驱动程序。</p><p id="f8f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">esProc还支持TXT/CVS/TVS和不同版本的XLS/XLSX。它更强大，因为它可以直接加入一个文本文件和一个Excel文件(见上图)。</p><p id="cae6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了标准化的档案格式之外，esProc还可以透过其扩充功能来处理更复杂的使用者需求。例如，要解析包含分隔符“||”的文件，OpenOffice Base是无能为力的。微软text/xls驱动需要写大量代码。esProc仅使用SQL查询中的扩展函数来完成这项工作:</p><blockquote class="je jf jg"><p id="406e" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">$select * from {file("sep.txt ")。import @ t(；,"||")}</p></blockquote><p id="6394" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">esProc可以自动识别资料类型。要解析非默认格式的数据，例如上面提到的日期，OpenOffice是不可用的，Microsoft text/xls驱动程序需要schema.ini和额外的代码，而esProc通过使用一个简单的扩展函数使它看起来像是小菜一碟:</p><blockquote class="je jf jg"><p id="54ca" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">$select * from{file("style.csv ")。import@ct(orderid，client，sellerid，amount，orderdate:date:"dd-MM-yyyy")}</p></blockquote><p id="d726" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要处理复杂格式的文本文件，比如一行对应多条记录，OpenOffice无能为力，Microsoft text/xls驱动程序需要编写大量复杂代码的资深程序员，而esProc只使用一个扩展函数来管理它:</p><blockquote class="je jf jg"><p id="9e74" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">$select * from</p><p id="c276" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">{file("trip.csv ")。导入@tc()。新闻(trips . array(" ")；名称、状态、~:trip)}</p></blockquote><p id="97f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是我的发现，这是我的结论。大多数文件上的SQL工具看起来不错，但缺乏实质性的能力。只有两个因其值得信赖的功能而脱颖而出。它们是Microsoft text/xls驱动程序和esProc。前者是面向程序员的，后者是数据分析师的真正朋友。</p></div></div>    
</body>
</html>