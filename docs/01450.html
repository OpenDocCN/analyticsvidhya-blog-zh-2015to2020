<html>
<head>
<title>Architecting Big Data Storage — AWS S3, Hadoop HDFS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建大数据存储— AWS S3、Hadoop HDFS</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/architecting-hadoop-storage-service-4265373d2ffc?source=collection_archive---------9-----------------------#2019-10-23">https://medium.com/analytics-vidhya/architecting-hadoop-storage-service-4265373d2ffc?source=collection_archive---------9-----------------------#2019-10-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3ad0d973f2ac0c8147e22250dcdc7363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mgLjjyyc4LI-0ZgA"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">弗兰克·麦肯纳在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="e2b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着大数据的接收和存储呈指数级增长，迫切需要精心设计存储，以获得更快的查询体验并避免查询成本。在某个时候，您可能遇到过如何在您的数据科学管道中有效且高效地设计存储的问题。在这篇博客中，我们将首先讨论设计大数据存储时应该考虑的因素。然后，我们将进一步详细讨论这些因素。并且最终缩小到对于不同的情况应该优选哪些因素。</p><p id="d4dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然在数据组织、数据存储和压缩方面有很大的选择灵活性，但我们需要明白，这对Hadoop文件存储的搜索、性能和可用性有很大的影响。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/51fde2633786875c871e331b97defd9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhPRPqV962bWIGbf_2GiQg.png"/></div></div></figure><blockquote class="jy jz ka"><p id="98b0" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">本质上，这是影响大数据存储的三个因素:</p><p id="3833" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">1.文件格式</p><p id="145c" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">2.压缩技术</p><p id="1b84" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">3.基于访问模式的数据存储</p></blockquote><h1 id="4a83" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 1。文件格式</strong></h1><p id="6709" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">我们有很多选择，从标准文本文件到序列化格式和列格式，如Avro和Parquet，人们很容易被这些淹没。在了解这些文件可以在哪里使用之前，让我们了解这些格式的基础，以及是什么导致了其他格式的发展，以及为什么我们不能简单地使用文本文件。</p><p id="a816" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">标准和序列文件格式</strong></p><p id="b0af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标准文本文件可以从CSV、TSV和JSON数据、XML文件加载数据。在文本文件中，每条记录由分隔符分开。文本文件的主要缺点是它会消耗大量的磁盘空间，并且有大量的类型转换开销。</p><p id="451e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这也是Hadoop提出称为序列文件的特定文件格式的根本原因。这些是基于文件的数据结构，包含二进制键值对形式的数据。它们具有用户定义的序列化。此外，不支持语言中立性，这意味着如果你用Java写这个文件，你需要用Java读这个文件。序列文件也可以分割，因为它们有同步标记。为什么你需要文件是可分割的？为了利用并行处理的优势，数据应该易于分割和组合。</p><p id="240c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Avro文件格式</strong></p><p id="eca8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Avro是一个语言中立的数据序列化系统。这是一种基于行的序列化数据的存储格式。存储时，这些行保持彼此靠近。Avro文件也是自描述的，这意味着它们包含模式(JSON)和数据(二进制)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/f2ef47d27821beef0d0d9c386fd492e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wG0cRrPdTwJpGvF1Cgbrmw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Avro文件中与语言无关的数据序列化</figcaption></figure><p id="8399" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建Avro文件格式的主要目标是支持模式进化，这使得文件格式能够适应数据源上的变化，而没有麻烦。Avro文件在很大程度上支持模式演变，从适应添加和删除列的变化到更改列名。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/a444ec07dacd4200250d5b9b53a6605c.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*Unk2W-uLqCnwcYtA4E3mFg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Avro文件中的模式演变</figcaption></figure><p id="1172" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于Avro文件支持各种数据结构，如映射、数组和其他基本数据结构；因此，将纯文本吸收到复杂的XML吸收中，也可以很好地适应模式演化。它们用于在数据到达数据管道中的数据着陆区时写入数据。</p><p id="d192" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">拼花文件格式</strong></p><p id="4acf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们都很清楚Avro的优势，以及它们如何很好地处理写密集型工作，但它们在阅读时的表现是否相似？不尽然！当我们读取Avro文件时，它们花费的时间几乎与读取文本文件的时间相同，这真的很高。</p><p id="4a76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就产生了拼花锉刀。它们是列格式，即消除了不需要的列的I/O。它们更适合于分析环境和用例——一写多读。这使得拼花文件更适合读取密集型应用程序。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/1eb0cdd69a9b878aad9bf4e8877f8189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*daz0t1qelvh7CyaVcuCpwg.png"/></div></div></figure><p id="7a68" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Parquet文件格式在每个文件中都定义了一个基于现有列的模式。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/b86334fbd7693cae5965acb8a10e4fc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*ThZp3WTdDDQV21wlVYqWyA.png"/></div></figure><p id="71f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">拼花地板还支持:</p><p id="835d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">谓词下推</strong>:读取时过滤。</p><p id="5226" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">投影下推</strong></p><p id="6544" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">优化的行列文件格式</strong></p><p id="f3f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它们是RC文件的优化版本。对于RC文件，查找分割是非常昂贵的。ORC是带条纹的列主格式。它只读取和解压缩你需要的字节。像Avro和Parquet一样，ORC文件也是自描述的。兽人和拼花地板有什么不同？Parquet存储嵌套数据的能力更强。如果您的数据有很深的层次结构。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/d22ccd255bdca605da2189a4adcb1492.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*wZG9Z4LnIkr0KDHjoAfTwA.png"/></div></figure><p id="3926" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总之，在考虑文件格式时，您应该比较读取强度、写入强度、文件是否可分割、文件是否支持模式演进支持以及这些文件的压缩支持如何？</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/dc72f97c0085347e3aa610beda26811c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iqPEq_D71TiarHmge_uhsw.png"/></div></div></figure><h1 id="6919" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 2。选择压缩算法</strong></h1><p id="d03a" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">有很多文件格式，如Gzip，Bzip2，Snappy，LZO，但在某个阶段，你会想评估这些压缩算法。这实际上是压缩能够大幅减少磁盘占用空间。本质上导致读和写操作。但与此同时，你所放弃或交换的是CPU时间。</p><blockquote class="jy jz ka"><p id="154e" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">这些是应该影响你选择的参数。</p><p id="8507" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">1.压缩比</p><p id="c056" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">2.吞吐量</p><p id="4cac" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">3.压缩和解压缩速度</p><p id="b917" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">4.受大数据平台和文件格式支持</p><p id="be5b" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">4.分裂能力</p></blockquote><p id="7219" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于Hadoop作业受I/O限制，因此一个轻量级的快速压缩编解码器实际上会提高性能。在所有的压缩技术中，Snappy是为速度而设计的，它不会对你的CPU内核造成很大影响，但Snappy本身是不可分割的。我们心中的问题是，快速压缩真的是一种好的压缩技术吗？Snappy适用于包含容器文件格式(如序列文件或Avro文件)中的块的文件，以及像Parquet文件这样的块边界分隔符。</p><h1 id="916b" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 3。基于访问模式的数据</strong> <strong class="ak">存储</strong></h1><blockquote class="jy jz ka"><p id="a913" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">1.是否需要随机存取数据</p><p id="dbfa" class="iv iw kb ix b iy iz ja jb jc jd je jf kc jh ji jj kd jl jm jn ke jp jq jr js hb bi translated">2.如果需要频繁更新</p></blockquote><p id="3950" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你应该在考虑这些因素的同时回答这些问题。什么是数据生命周期。是热数据还是冷数据？由于Hadoop中的数据是不可变的，在Hadoop中保留需要频繁更新的数据真的值得吗？或者我们应该将这些数据分成像Hbase这样的存储，这是一个非SQL数据库。</p><p id="dd54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">推荐</strong></p><p id="9cd4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">列格式通常用在需要查询几列而不是行中所有字段的地方，因为它们面向列的存储模式非常适合这种情况。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/cc817f6977c225c8344b20e9b328e7d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDgFUe3oaehxo11Tm0t8zQ.png"/></div></div></figure><p id="3f7c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另一方面，行格式用于需要访问行中所有字段的地方。所以通常Avro被用来存储原始数据，因为在处理过程中通常所有的字段都是必需的。</p></div></div>    
</body>
</html>