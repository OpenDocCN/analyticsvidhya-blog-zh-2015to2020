<html>
<head>
<title>Tips and Secrets for developing a powerful API with Python + Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python + Flask开发强大API的技巧和秘密</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tips-and-secrets-for-developing-a-powerful-api-with-python-flask-8c3c3ea0103?source=collection_archive---------11-----------------------#2020-09-07">https://medium.com/analytics-vidhya/tips-and-secrets-for-developing-a-powerful-api-with-python-flask-8c3c3ea0103?source=collection_archive---------11-----------------------#2020-09-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="d31d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">我喜欢烧瓶和Python。这就是我对#MLOps之后构建高效API的需求的热爱。发现一些让我的API更强大的技巧和秘密。</h2></div></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/dcc3f2b932bdb9f73facfc376bd847e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*owKdqWEz753tY7na4LQKXw.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">知道如何开发更好的API</figcaption></figure><p id="4aa2" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">Python是一种很棒的编程语言，它对于人工智能和数据科学的世界来说非常强大。</p><p id="bbab" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">自从我在这个世界开始了我的职业生涯，我就试图用Python为我的服务、微服务和项目使用最好的工具。</p><p id="18a4" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">考虑到这一点，API是为我的客户交付数据科学项目的最佳方式。此外，这也是在企业内部构建微服务环境，并使用多个以集成方式工作的服务来创建新产品的最佳方式。</p><p id="e3f0" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">但是构建一个API可能很困难。下面是一些技巧和秘密，它们使我的API更加可用，并改善了客户体验。</p><p id="ef81" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">看看吧！</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kq kr l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">我们走吧！</figcaption></figure></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><h1 id="7e1a" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">您应该使用环境变量。但是用的更好！</h1><p id="20b9" class="pw-post-body-paragraph ju jv hi jw b jx lk ij jz ka ll im kc kd lm kf kg kh ln kj kk kl lo kn ko kp hb bi translated">环境变量并不是新的，它是根据您的工作环境配置项目的好方法。但是构建API的一个很好的技巧是创建一个方法或类来调用所有这些变量。</p><p id="a70c" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">因此:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lp kr l"/></div></figure><p id="5c8a" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这样，您可以简单地在代码中将env变量作为一个类来使用。它使你更容易改变任何东西，并保持你的工作在多个操作系统和计算机上。</p></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><h1 id="f6ae" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">发现烧瓶监控仪表板</h1><p id="c28c" class="pw-post-body-paragraph ju jv hi jw b jx lk ij jz ka ll im kc kd lm kf kg kh ln kj kk kl lo kn ko kp hb bi translated">构建API可能简单而快速，至少在您知道如何做的时候是这样——但是当您开始使用一些云和DevOps概念时，跟踪和监控您的应用程序可能会有些棘手。我真的很喜欢Docker和Kubernetes，但是使用所有的<em class="lq"> kubectl </em>命令来获得日志或Python输出是很复杂的。</p><p id="a28a" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这就是我在API中使用Flask Monitoring Dashboard的原因。</p><div class="lr ls ez fb lt lu"><a href="https://github.com/flask-dashboard/Flask-MonitoringDashboard" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hj fi z dy lz ea eb ma ed ef hh bi translated">烧瓶仪表板/烧瓶监控仪表板</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">一个自动监控Flask web服务的仪表板。主要功能*如何使用*现场演示*反馈*…</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">github.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi jo lu"/></div></div></a></div><p id="e4f3" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这个Python库直接与您的Flask项目一起工作，如下所示:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lp kr l"/></div></figure><p id="1e87" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这个库可以让你访问一系列关于你的应用的信息，比如profiler，使用和性能——它甚至可以通过你的Flask API的路径来分离。</p></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><h1 id="1dce" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">验证您的Json模式</h1><p id="0523" class="pw-post-body-paragraph ju jv hi jw b jx lk ij jz ka ll im kc kd lm kf kg kh ln kj kk kl lo kn ko kp hb bi translated"><strong class="jw hj">如今，安全是一项规则。句号。</strong></p><p id="2432" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我在这里强调一下:</p><blockquote class="mj mk ml"><p id="844a" class="ju jv lq jw b jx jy ij jz ka kb im kc mm ke kf kg mn ki kj kk mo km kn ko kp hb bi translated">我并不建议或推荐它是您的应用程序的唯一安全形式。这只是另一个好的补充，好吗？</p></blockquote><p id="02e1" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在我的项目中，我使用了许多不同形式的认证和最佳实践来保证我的API的安全。但是第一个简单的安全实现可能是您自己的Json模式。</p><p id="d140" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">您可以实现一个函数来验证关于以前模式的json，如下所示:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lp kr l"/></div></figure><p id="ddfa" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这样，您就可以实现一个良好的第一层，将那些不了解您的请求或与您的应用程序交流的模式的人拒之门外。</p></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><h1 id="6543" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">使用APM洞察。而且，更好地使用它！</h1><p id="eda5" class="pw-post-body-paragraph ju jv hi jw b jx lk ij jz ka ll im kc kd lm kf kg kh ln kj kk kl lo kn ko kp hb bi translated">我的一些应用程序是使用云服务部署的，比如Azure。我工作的地方使用Azure提供一些项目服务，包括AKS-Azure Kubernetes服务。另一个非常棒的工具是APM、应用性能管理或应用洞察。</p><div class="lr ls ez fb lt lu"><a href="https://docs.microsoft.com/pt-br/azure/azure-monitor/app/app-insights-overview" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hj fi z dy lz ea eb ma ed ef hh bi translated">o queéo Application Insights do Azure？- Azure监视器</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">O Application Insights，um recurso Application Insights，Azure Monitor的一个特性，éum servio de APM…</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">docs.microsoft.com</p></div></div><div class="md l"><div class="mp l mf mg mh md mi jo lu"/></div></div></a></div><p id="6ae9" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">有了它，我们可以跟踪任何日志或错误，我们的API的性能，以及任何类型的坏请求。</p><p id="87dc" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">APM并不新鲜，我做了哪些不同或者更好的地方？</p><p id="bb86" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我用Python日志创建了自己的库，并导入到我所有的Flask项目中。它对我跟踪我的应用程序帮助很大，即使是在实验室环境中。我的库为Application Insights SDK获得了大量导入，还配置了遥测、处理程序和密钥管理。</p><p id="1b83" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这可能是集成和统一所有环境中的开发和监控工作的更好方法。</p></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><h1 id="8814" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">如果你有微服务，就把它dockerize！</h1><p id="5e51" class="pw-post-body-paragraph ju jv hi jw b jx lk ij jz ka ll im kc kd lm kf kg kh ln kj kk kl lo kn ko kp hb bi translated">Docker，docker，docker…每个人都在谈论它，有一段时间，每个人都在评论这项技术的力量。它很棒，我经常用它。问题是:</p><blockquote class="mj mk ml"><p id="dfdc" class="ju jv lq jw b jx jy ij jz ka kb im kc mm ke kf kg mn ki kj kk mo km kn ko kp hb bi translated">如何使用Docker和Kubernetes创建更好的Python Flask API？</p></blockquote><p id="9a1c" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我最近的所有项目都是用Docker + Kubernetes交付的。一些提示是:</p><ul class=""><li id="519c" class="mq mr hi jw b jx jy ka kb kd ms kh mt kl mu kp mv mw mx my bi translated">为您的项目使用基础图像来跟踪您的库。对于使用Python和Flask的API，我有一些库一直被用作Flask、Flask Monitoring、Application Insights SDK、Json Schema…；</li><li id="fbd7" class="mq mr hi jw b jx mz ka na kd nb kh nc kl nd kp mv mw mx my bi translated">在docker文件中正确声明环境变量；</li><li id="73a4" class="mq mr hi jw b jx mz ka na kd nb kh nc kl nd kp mv mw mx my bi translated">不要忘记在CMD之前暴露你的端口；</li><li id="7982" class="mq mr hi jw b jx mz ka na kd nb kh nc kl nd kp mv mw mx my bi translated">了解kubectl的基本命令，如use-context、apply、get pod、scale……当你必须管理你的API时，这将会有所不同。</li></ul><p id="2d9e" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">下面是一个简单Dockerfile文件的很好的例子:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lp kr l"/></div></figure><h1 id="022f" class="ks kt hi bd ku kv ne kx ky kz nf lb lc io ng ip le ir nh is lg iu ni iv li lj bi translated">就这样，伙计们！</h1><p id="3cf2" class="pw-post-body-paragraph ju jv hi jw b jx lk ij jz ka ll im kc kd lm kf kg kh ln kj kk kl lo kn ko kp hb bi translated">使用Python和Flask构建API可能是向客户交付项目或服务的一种简单方式，但一些技巧和秘密对于实现更好的解决方案至关重要。</p><p id="3bb2" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这5个是我在开发中经常使用的，并且在最多样化的项目中帮助了我很多。</p><p id="6448" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我知道可能有其他甚至更好的选择来部署API，但这是对我有用的。</p><p id="2788" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">你知道更多的选择或其他方法来获得更好的结果吗？</p><p id="9784" class="pw-post-body-paragraph ju jv hi jw b jx jy ij jz ka kb im kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated"><strong class="jw hj">请随时评论并告诉我更多信息或保持联系</strong> <a class="ae nj" href="https://www.linkedin.com/in/gilvandroneto1991/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw hj"> LinkedIn </strong> </a> <strong class="jw hj">或</strong><a class="ae nj" href="https://github.com/gilvandroneto" rel="noopener ugc nofollow" target="_blank"><strong class="jw hj">Github</strong></a><strong class="jw hj">！</strong></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="nk kr l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">评论:)</figcaption></figure><h2 id="b0b2" class="nl kt hi bd ku nm nn no ky np nq nr lc kd ns nt le kh nu nv lg kl nw nx li ny bi translated">如果这些建议对你有任何帮助，请分享！</h2></div></div>    
</body>
</html>