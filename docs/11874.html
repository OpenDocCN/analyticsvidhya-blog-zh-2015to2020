<html>
<head>
<title>Logistic Regression to Predict Extra Marital Affair</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测婚外情逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-to-predict-extra-marital-affair-68ae98bc0e4f?source=collection_archive---------5-----------------------#2020-12-22">https://medium.com/analytics-vidhya/logistic-regression-to-predict-extra-marital-affair-68ae98bc0e4f?source=collection_archive---------5-----------------------#2020-12-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/dff0071605bd82a9d6c7e30544a86876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*eGSEIWU38wbZAVr1.jpg"/></div><figcaption class="im in et er es io ip bd b be z dx translated"><a class="ae iq" href="https://www.google.com/search?q=extra+marital+affair&amp;hl=en&amp;sxsrf=ALeKk01c9LFH35VAt7icPOrk6T8DXeDrJg:1608623419045&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=2ahUKEwj6luCbjeHtAhVRaCsKHY6uAzIQ_AUoAXoECBEQAw&amp;biw=1366&amp;bih=625#imgrc=AH0efLNFi7wn-M" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h2 id="f79c" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">概述:</h2><p id="36be" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj hb bi translated">我选择的数据集是统计模型附带的事务数据集。它来源于红皮书杂志 1974 年对女性的一项调查，调查中已婚女性被问及她们参与婚外情的情况。我决定通过创建一个新的二元变量外遇(这个女人至少有过一次外遇吗？)并试图预测每个女性的分类。存在于数据集中用于预测的变量是:- <strong class="jr hj">比率 _ 婚姻</strong>(妇女对其婚姻的评级)<strong class="jr hj">年龄</strong>(妇女年龄)<strong class="jr hj">年龄 _ 结婚</strong>(结婚年数)<strong class="jr hj">子女</strong>(她拥有的子女数量)<strong class="jr hj">宗教</strong>(在 1 -5 的范围内，她是否信仰宗教)<strong class="jr hj">教育</strong>(教育水平)<strong class="jr hj">职业</strong>、</p><h2 id="094a" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated"><strong class="ak">步骤 1:导入所有必要的库并获取数据集</strong></h2><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="eaea" class="ir is hi kp b fi kt ku l kv kw">import numpy as np<br/>import pandas as pd<br/>import statsmodels.api as sm<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>from patsy import dmatrices<br/>from sklearn.linear_model import LogisticRegression <br/>from sklearn.model_selection import train_test_split<br/>from sklearn import metrics</span></pre><p id="5430" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">事件数据集存在于统计模型中，因此我们将提取该库。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="0deb" class="ir is hi kp b fi kt ku l kv kw">df=sm.datasets.fair.load_pandas().data<br/>df.head()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/f2b20e389259db81b87949c2ab8259b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*puA93uMWaK_wN4eJeszGoA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">前五行的输出</figcaption></figure><h2 id="e166" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">步骤 2:数据预处理</h2><ul class=""><li id="114b" class="ld le hi jr b js jt jw jx jc lf jg lg jk lh kj li lj lk ll bi translated">我们想把它变成分类问题，因为我们需要把目标变量<strong class="jr hj">(事务)</strong>转换成二元类，其中如果值为<strong class="jr hj"> 0 </strong>，那么女性没有任何事务，而<strong class="jr hj"> 1 </strong>意味着女性有过几次婚外情。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="9058" class="ir is hi kp b fi kt ku l kv kw">(df.affairs&gt;0).astype(int)#converting into binary features<br/>df.affairs.unique()</span><span id="8f0f" class="ir is hi kp b fi lm ku l kv kw">[out]&gt;&gt; array([1, 0], dtype=int64)</span></pre><ul class=""><li id="74f7" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">这里我们将使用 pasty . d matrics，它的主要任务是分析自变量和因变量，并根据目标变量的需要添加一些数据。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="396c" class="ir is hi kp b fi kt ku l kv kw">y,X=dmatrices(affairs~rate_marriage + age + yrs_married + children +  religious + educ + C(occupation)+C(occupation_husb)',df<br/>                                  return_type="dataframe")<br/>x.head()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/5a5ac4262e0a359988ba9eb9ca1875f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6VWlMAkQpXMHN5g0QYGtA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">前五行的输出</figcaption></figure><ul class=""><li id="67bc" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">重命名<strong class="jr hj"> X </strong>中的特性，以便所有人都能理解。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="0b8f" class="ir is hi kp b fi kt ku l kv kw">X = X.rename(columns ={'C(occupation)[1.0]':'occ_1','C(occupation)[2.0]':'occ_2','C(occupation)[3.0]' : 'occ_3' ,'C(occupation[4.0]' : 'occ_4','C(occupation[5.0]':'occ_5','C(occupation)[6.0]':'occ_6',<br/>'C(occupation_husb)[T.2.0]':'occ_husb_2', 'C(occupation_husb[T.3.0]' :'occ_husb_3','C(occupation_husb)[T.4.0]':'occ_husb_4' , 'C(occupation_husb)[T.5.0]':'occ_husb_5', 'C(occupation_husb)[T.6.0]':'occ_husb_6'})<br/>X.head()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lv"><img src="../Images/9d041ba2ce04c069f6bd2bd9f69e6080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIBONIgq4OsocKbujkZNHA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">重命名的 X 的输出</figcaption></figure><ul class=""><li id="4b55" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">检查数据集中是否存在空值。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="dacd" class="ir is hi kp b fi kt ku l kv kw">df=pd.concat([X,y],axis=1)<br/>df.isnull().values.any()</span><span id="481c" class="ir is hi kp b fi lm ku l kv kw">[out]&gt;&gt; False  #no null value present in dataset</span></pre><ul class=""><li id="74f9" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">现在下一步是检查数据集是否平衡。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="06ae" class="ir is hi kp b fi kt ku l kv kw">print(df[df["affairs"]==0].shape)<br/>print(df[df["affairs"]==1].shape)</span><span id="5f59" class="ir is hi kp b fi lm ku l kv kw">[out]&gt;&gt; (4313, 18)<br/>        (2053, 18)<br/>--------------------------------------------------------------------<br/>plt.figure(figsize=(8,6))<br/>sns.set_style("darkgrid")<br/>sns.countplot(np.ravel(y))<br/>plt.yticks(range(0,5000,250))<br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/98287b43ae541693e5f3e7c42340545a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*esWPFX9gncq4a0MCFtUPWw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 1</figcaption></figure><ul class=""><li id="521b" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">正如我们所见，数据集是不平衡的，因为<strong class="jr hj">类 0 </strong>几乎是<strong class="jr hj">类 1 的两倍。</strong>我们将进行向上采样以平衡数据集。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="9c27" class="ir is hi kp b fi kt ku l kv kw">from imblearn.random_sampling  import RandomOverSampler<br/>rdm=RandomOverSampler()<br/>X,y=rdm.fit_sample(X,y)<br/>df=pd.concat([X,y],axis=1)  #updating the balanced form of dataset<br/>print(df[df["affairs"]==0].shape)<br/>print(df[df["affairs"]==1].shape)</span><span id="f10c" class="ir is hi kp b fi lm ku l kv kw">[out]&gt;&gt; (4313, 18)<br/>        (4313, 18)</span><span id="486a" class="ir is hi kp b fi lm ku l kv kw">--------------------------------------------------------------------<br/>plt.figure(figsize=(8,6))<br/>sns.set_style("darkgrid")<br/>sns.countplot(np.ravel(y))# converting y into array form to plot<br/>plt.yticks(range(0,5000,250)) <br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/bbccdf8756a999fabd5d97323fa1c2b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*n6923hddXLQBuAUnl4luEw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 2</figcaption></figure><ul class=""><li id="7d4d" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">数据的统计描述</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="2533" class="ir is hi kp b fi kt ku l kv kw">df.describe()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es ly"><img src="../Images/937094443b69822bdf8c3981cada7155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2c6etd1GmKx3VZ1u83BHmw.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">统计说明</figcaption></figure><h2 id="f500" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">步骤 3:数据可视化</h2><ul class=""><li id="598a" class="ld le hi jr b js jt jw jx jc lf jg lg jk lh kj li lj lk ll bi translated">孩子如何影响夫妻关系。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="c5eb" class="ir is hi kp b fi kt ku l kv kw">plt.figure(figsize=(8,6))<br/>sns.set_style("darkgrid")<br/>sns.countplot("children",data=df,hue="affairs")<br/>plt.title("How children affects marriage")<br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/73db69004bb30d3948743f6900125900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*ddQZj3RjMwRhtNxfLReLSA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 3</figcaption></figure><ul class=""><li id="2e37" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">婚姻年限如何影响额外的婚姻生活？</li></ul><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/363f2d4c4126418ebf3318f6f1a6772f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*5fbsCFHtXdOUjCV2XrpfSA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 5</figcaption></figure><p id="c2c2" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">随着已婚夫妇在一起的时间越来越长，他的妻子很有可能会有婚外关系。新婚夫妇信任的最好结果和可以忽略的婚外情。</p><ul class=""><li id="0cdb" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">女性如何在 1 到 5 的范围内评价她们的婚姻生活。</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="ce02" class="ir is hi kp b fi kt ku l kv kw">plt.figure(figsize=(8,6))<br/>plt.hist(df["rate_marriage"])<br/>plt.xlabel("Marriage rating",fontsize=20)<br/>plt.ylabel("count",fontsize=20)<br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/e2c19e81006a64527e34a31d73f7ea57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*fRqge1ugQQciu84a0wE67Q.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 6</figcaption></figure><p id="4134" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">从上图我们可以看出，不管她们的婚外情如何，大部分女性对她们的婚姻生活感到满意。</p><ul class=""><li id="1931" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">让我们看看教育是如何影响婚姻生活的</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="b07d" class="ir is hi kp b fi kt ku l kv kw">plt.figure(figsize=(8,6))<br/>sns.set_style("darkgrid")<br/>sns.countplot("educ",hue="affairs",data=df,order=df["educ"].value_counts().index)<br/>plt.xlabel("education",fontsize=20)<br/>plt.ylabel("count",fontsize=20)<br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/2f62956f3798e1d32224d6f7816e0cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*yuW_JIz9gZx9ZzuPtt-FUA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 7</figcaption></figure><p id="bd94" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">从事白领工作的女性出轨的机会较少，毕业和受教育程度较高的女性出轨的机会也较少，但对于那些上大学和文化程度较低的女性来说，她们对婚外情更感兴趣。</p><ul class=""><li id="1d83" class="ld le hi jr b js kx jw ky jc ln jg lo jk lp kj li lj lk ll bi translated">宗教对女性婚姻的影响</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="7861" class="ir is hi kp b fi kt ku l kv kw">plt.figure(figsize=(8,6))<br/>sns.set_style("darkgrid")<br/>sns.countplot("religious",hue="affairs",data=df)<br/>plt.xlabel("religious",fontsize=20)<br/>plt.ylabel("count",fontsize=20)<br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es md"><img src="../Images/a5daba3e3e5c089c2b91e6fe7af0d49a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*dl2iVjRJDLzr6R99UaCh8Q.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 7</figcaption></figure><p id="9738" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">越多的女性信教，女性婚外情的可能性就越小。</p><h2 id="6f10" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">第四步:建模</h2><p id="30ec" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj hb bi translated">将数据分为训练集和测试集</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="2ce5" class="ir is hi kp b fi kt ku l kv kw">x_train,x_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=1)<br/>print(x_train.shape)<br/>print(y_train.shape)<br/>print(x_test.shape)<br/>print(y_test.shape)</span><span id="8094" class="ir is hi kp b fi lm ku l kv kw">[out]&gt;&gt; (6900, 17)<br/>        (6900, 1)<br/>        (1726, 17)<br/>        (1726, 1)</span></pre><p id="dfd6" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">制作模型并进行预测</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="9b5e" class="ir is hi kp b fi kt ku l kv kw">clf=LogisticRegression()<br/>clf.fit(x_train,y_train)<br/>y_predicted=clf.predict(x_test)<br/>y_train_predicted=clf.predict(x_train)</span></pre><h2 id="af8f" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">第五步:评估</h2><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="e886" class="ir is hi kp b fi kt ku l kv kw">from sklearn.metrics import accuracy_score, confusion_matrix,roc_curve,classification_report<br/>print("train set accuracy score: ",accuracy_score(y_train,y_train_predicted))<br/>print("test set accuracy score :",  accuracy_score(y_test,y_predicted))</span><span id="2624" class="ir is hi kp b fi lm ku l kv kw">[out] &gt;&gt; train set accuracy score:  0.6918840579710145<br/>         test set accuracy score : 0.6853997682502897</span></pre><p id="f6dc" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">正如我们看到的，数据集之间没有大的偏差，因此模型处于正常状态。</p><p id="2daa" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">检查 TP、TN、FP、FN 值的精度矩阵。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="25b7" class="ir is hi kp b fi kt ku l kv kw">ax=splt.metrics.plot_confusion_matrix(y_test,y_predicted,text_fontsize="large",figsize=(8,6))<br/>plt.xlabel("Predicted label",fontsize=20)<br/>plt.ylabel("True label",fontsize=20)<br/>bottom, top = ax.get_ylim()<br/>ax.set_ylim(bottom + 0.5, top - 0.5)<br/>plt.show()</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es me"><img src="../Images/193a3026bd53630175a3d780a9a49aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*HnjPPny4XFc6IzGGV2dGpw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 8</figcaption></figure><p id="cecd" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">这里我们应该小心<strong class="jr hj"> FP </strong>因为我们的模型会预测女人有外遇，但实际上她不会因为她没有犯的错误而有任何可能导致离婚的外遇，所以当我们处理这种敏感的预测时，我们应该对<strong class="jr hj"> FP </strong>值表现出一些小心。</p><p id="a90b" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated"><strong class="jr hj">寻找精度，回忆 F1-分数</strong></p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="e7da" class="ir is hi kp b fi kt ku l kv kw">from sklearn.metrics import classification_report<br/>print(classification_report(y_test,y_predicted))</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/376a4a39fb97c92d7e35521f3a6b23b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*yxWASrMWEF8kM8JzvczaKg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 9</figcaption></figure><p id="111a" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated"><strong class="jr hj"> ROC 曲线</strong></p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="1bef" class="ir is hi kp b fi kt ku l kv kw">pred_probab=clf.predict_proba(x_test)<br/>splt.metrics.plot_roc_curve(y_test,pred_probab,text_fontsize="large",figsize=(8,6))</span></pre><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/e06a39acdadca39147065a624a1662fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*C-BxcIakD5f2U-BFr18RZg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图 10</figcaption></figure><h2 id="c2fc" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">模型的最终测试:</h2><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="0b84" class="ir is hi kp b fi kt ku l kv kw">print("Prediction chance of your model :")<br/>print(clf.predict_proba(np.array([[0,0,0,0,0,1,1,0,0,0,0,4,32,5,2,3,17]]))*100)</span></pre><p id="b494" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">给定测试集上限的预测机会为 27.7%，预测结果为；</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="5050" class="ir is hi kp b fi kt ku l kv kw">print("your prediction is  :",clf.predict(np.array([[0,0,0,0,0,1,1,0,0,0,0,4,32,5,2,3,17]])))</span><span id="5915" class="ir is hi kp b fi lm ku l kv kw">[out] &gt;&gt; your prediction is  : [0.]</span></pre><p id="dc7a" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">给定数据的预测结果是女人没有外遇。</p><p id="ce05" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated"><strong class="jr hj">结论:</strong></p><p id="7a1c" class="pw-post-body-paragraph jp jq hi jr b js kx ju jv jw ky jy jz jc kz kb kc jg la ke kf jk lb kh ki kj hb bi translated">希望这篇博客能让你对逻辑回归在分类问题上的工作有更好的了解。不断学习不断探索……</p></div></div>    
</body>
</html>