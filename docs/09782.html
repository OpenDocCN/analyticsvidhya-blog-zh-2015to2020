<html>
<head>
<title>Using YOLOv3 for detection of traffic signs.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用YOLOv3检测交通标志。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-yolov3-for-detection-of-traffic-signs-57f30b3c561c?source=collection_archive---------1-----------------------#2020-09-20">https://medium.com/analytics-vidhya/using-yolov3-for-detection-of-traffic-signs-57f30b3c561c?source=collection_archive---------1-----------------------#2020-09-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/54a250567c884298e6a403a65603cdc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mCM8QFJFiW3PeSpx.jpg"/></div></div></figure><p id="f8f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">交通标志为司机和其他道路使用者提供了有价值的信息。它们代表了保护我们安全的规则，并有助于向司机和行人传达信息，以维持秩序和减少事故。忽视它们可能是危险的。</p><p id="6e6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大多数标志利用图片，而不是文字，所以他们很容易理解，可以解释的人说各种语言。每年大约有135万人死于道路交通事故。世界上大多数政府都强制要求遵守交通规则和标志。</p><p id="6994" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本案例研究中，我们将了解YOLOv3如何用于检测交通标志。案例研究包括数据预处理、数据分析、YOLO模型创建和数据扩充。我们将使用来自INI基准网站的德国交通标志检测基准数据集。</p><blockquote class="jp jq jr"><p id="15ae" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated"><strong class="is hj"> <em class="hi">注</em> </strong> <em class="hi">:完整代码在我的</em> <a class="ae jo" href="https://github.com/vignesh-bhat1999/Traffic-sign-detection" rel="noopener ugc nofollow" target="_blank"> <em class="hi"> Git-hub库</em> </a> <em class="hi">上。</em></p></blockquote></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="3c67" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">问题陈述</h2><p id="4dc0" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">交通标志检测是一个具有高度工业相关性的具有挑战性的现实世界问题。就连特斯拉最近也给自己的汽车升级了检测红绿灯和停车标志，这也是交通标志之一。<strong class="is hj">本案例研究的主要目的是检测交通标志并将其分为四类(禁止、强制、危险或其他)。</strong></p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="01a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">数据概述:</strong></p><p id="a25d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从<a class="ae jo" href="http://benchmark.ini.rub.de/?section=gtsdb&amp;subsection=dataset" rel="noopener ugc nofollow" target="_blank">数据</a>中获取数据</p><p id="2e6e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集由900张ppm格式的图像组成。数据集还包含一个CSV格式的txt文件，包含图像中所有交通标志的地面实况。地面实况文件包含图像文件名、边界框坐标和交通标志的类别id，边界框坐标包含图像中出现的交通标志的左、上、右和下坐标。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="d06a" class="ld ke hi bd kf le lf lg kj lh li lj kn lk ll lm kq ln lo lp kt lq lr ls kw lt bi translated">索引:</h1><ul class=""><li id="8a7b" class="lu lv hi is b it ky ix kz jb lw jf lx jj ly jn lz ma mb mc bi translated"><strong class="is hj">第一步:</strong>探索性数据分析。</li><li id="0f73" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated"><strong class="is hj">第二步:</strong>数据预处理。</li><li id="461a" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated"><strong class="is hj">第三步:</strong> YOLO v3。</li><li id="3096" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated"><strong class="is hj">第四步:</strong>预测。</li><li id="193e" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated"><strong class="is hj">第五步:</strong>结论。</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="1f83" class="ld ke hi bd kf le lf lg kj lh li lj kn lk ll lm kq ln lo lp kt lq lr ls kw lt bi translated">步骤1:探索性数据分析</h1><p id="6fe0" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">总共有43个交通标志，然后分为4类，即禁止，强制，危险和其他。</p><h2 id="05e4" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">加载数据:</h2><p id="4e15" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">为了加载数据，我们只需要包含地面真实值的txt文件。我们将把它加载到一个熊猫数据框架中。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">将gt.txt加载到数据帧中</figcaption></figure><figure class="mi mj mk ml fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/0a33e75e4a8748db2d6b9b45fecf1201.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*GwKptd6PNFtw_d_pyng5oA.png"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">数据集的前5行</figcaption></figure><p id="20fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">训练数据中总共有600幅图像，数据集中总共有852行。图像的多行是指同一图像中的多个交通标志。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="cfe3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">分析数据:</strong></p><p id="e801" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们想象其中一幅图像并检查它的大小，</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">检查图像的大小</figcaption></figure><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">形象化图像</figcaption></figure><figure class="mi mj mk ml fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/a566cf3a1701b29f4b72427f125a4b1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*Rz2YedDbvn60M7SNsD02mQ.png"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">可视化输出</figcaption></figure><p id="35e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有图像的大小为800*1360，有3个通道。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="f360" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">类别id:</h2><p id="5a31" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">让我们现在检查类别id的分布，目前共有43类交通标志。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mi mj mk ml fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/13dab33888a3f7e18b494b872417ac17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ns79oCgIqKQef7VSOGuBpw.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">交通标志ID分配</figcaption></figure><p id="1525" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以清楚地观察到，</p><ul class=""><li id="4a51" class="lu lv hi is b it iu ix iy jb mv jf mw jj mx jn lz ma mb mc bi translated">与其他标识号相比，标识号1、2、4、10、12、13和38的数量较大。</li><li id="0e55" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated">标志id的0、19、31和38在数量上最少。</li></ul><p id="167c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们将43个类别id分为4个主要类别id，即禁止、强制、危险和其他。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mi mj mk ml fd ij er es paragraph-image"><div class="er es my"><img src="../Images/b3d2b1e3acfd928e0c8131d71511dac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*pdfm-nn75doK_p3-ORZEXg.png"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">数据集的前5条记录</figcaption></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><figure class="mi mj mk ml fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/e13378aaca5c6b5ec342317fdaaa806b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6uYACeCQWCdF0FowUgJL2A.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">类别id计数</figcaption></figure><ul class=""><li id="5030" class="lu lv hi is b it iu ix iy jb mv jf mw jj mx jn lz ma mb mc bi translated">我们可以观察到数据集中禁止类id的数量很高。</li></ul><h2 id="e06c" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">边界框的大小:</h2><p id="e6a7" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">现在让我们检查图像中交通标志的尺寸分布，</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mi mj mk ml fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/27bea89f2c9a06fc385cfea87a4be15f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xw_UB8Cl9ExnddBLkzxxTA.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">交通标志像素分布</figcaption></figure><ul class=""><li id="9b80" class="lu lv hi is b it iu ix iy jb mv jf mw jj mx jn lz ma mb mc bi translated">我们可以观察到边界框的大小范围从32到248像素。</li><li id="1873" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated">大多数方框位于40到100像素范围内，很少方框超过150像素。</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="d016" class="ld ke hi bd kf le lf lg kj lh li lj kn lk ll lm kq ln lo lp kt lq lr ls kw lt bi translated">第二步:数据预处理</h1><p id="2cde" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated"><strong class="is hj">从ppm图像创建png图像:</strong></p><p id="2d6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们从ppm图像创建png图像，</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">png图像创建</figcaption></figure><p id="b85c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码从ppm图像创建png图像，并将其存储在images文件夹中，这确保了没有单个交通标志的图像与包含交通标志的图像分开。这是通过使用数据集dataframe实现的。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="0d0f" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">创建注释文件:</h2><p id="3259" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">为每个图像创建注释文件。这些注释文件包含图像文件路径、地面真实值和图像中交通标志的类别id。这些文件以xml扩展名存储。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="be96" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">Tfrecord文件:</h2><p id="7ca6" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">TFRecord格式是一种用于存储二进制记录序列的简单格式。使用tfrecords可以高效地存储和读取数据。更多可以在这里了解tfrecord，<a class="ae jo" href="https://www.tensorflow.org/tutorials/load_data/tfrecord" rel="noopener ugc nofollow" target="_blank"> tfrecord </a></p><p id="b304" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将创建训练和验证数据tfrecords，它将包含原始图像数据和边界框坐标以及类id。由600个图像组成的训练数据被分成训练和验证数据，然后从该数据创建tfrecord文件。注释文件将用于创建tfrecord文件。</p><p id="cca7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面的代码片段将帮助我们实现创建tf记录文件。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="fa9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们想象一个有边界框的图像，</p><figure class="mi mj mk ml fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/d62fcae824e0d9a7f3d76819d36eaa9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*ceJ0_SXfMeHYlFXnbQ_agA.jpeg"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">带有基本事实边界框的图像</figcaption></figure><p id="9a5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">dataframe可以直接在tf数据管道中使用，而不是先转换为xml，然后再转换为tfrecords。</p><h1 id="f9fe" class="ld ke hi bd kf le nc lg kj lh nd lj kn lk ne lm kq ln nf lp kt lq ng ls kw lt bi translated">第三步:YOLO v3</h1><p id="5073" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">YOLO v3是对以前的YOLO检测网络的改进。这是一个单次检测器，运行速度非常快，可以在GPU设备上进行实时推断。</p><p id="c254" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看一下理解yolo所需的一些术语，</p><ul class=""><li id="c0db" class="lu lv hi is b it iu ix iy jb mv jf mw jj mx jn lz ma mb mc bi translated"><strong class="is hj">网格单元:</strong></li></ul><p id="08a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">YOLOv3将输入图像划分成一个<strong class="is hj"> S </strong> × <strong class="is hj"> S </strong>网格。每个网格单元只预测<strong class="is hj">一个</strong>对象。</p><figure class="mi mj mk ml fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6864f300071ac88666a84ab95c82def0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wB5Whu9_EYwubjsMikCrg.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">S为13的网格单元</figcaption></figure><ul class=""><li id="31d4" class="lu lv hi is b it iu ix iy jb mv jf mw jj mx jn lz ma mb mc bi translated"><strong class="is hj">锚箱:</strong></li></ul><p id="76b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">锚定框是先前的框，其可以具有不同的预定义纵横比。这些纵横比在训练之前通过在整个数据集上运行K-means来确定。锚定框被分配给网格单元，我们可以确定地面真相框与锚定框重叠的程度，并选择具有最佳IOU的一个。</p><p id="90ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在YOLO v3中，每个网格单元有三个锚盒。我们有三个等级的网格。因此，我们将为每个秤配备52x52x3、26x26x3和13x13x3锚盒。对于每个锚盒，我们需要预测3件事:</p><p id="5411" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.相对锚箱的位置偏移:<em class="js"> tx，ty，tw，th </em>。这有4个值。<br/> 2。指示此框是否包含对象的对象性分数。这有1个值。<br/> 3。类别概率告诉我们这个盒子属于哪个类别。这有num_classes个值。</p><p id="3a2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总之，我们为一个锚盒预测了<em class="js"> 4 + 1 + num_classes </em>个值。</p><ul class=""><li id="d74f" class="lu lv hi is b it iu ix iy jb mv jf mw jj mx jn lz ma mb mc bi translated"><strong class="is hj">非最大抑制:</strong></li></ul><p id="e7af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">YOLO可以对同一对象进行重复检测。为了解决这个问题，YOLO应用了非最大抑制来去除置信度较低的重复。具有高于阈值的最高分数的检测框被保留，而其他框被去除。</p><figure class="mi mj mk ml fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nh"><img src="../Images/81c739d03624363a9d23abd210598bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SLNoDPqmifk1WXMNKz1NoA.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">图片来自<a class="ae jo" rel="noopener" href="/analytics-vidhya/yolo-v3-theory-explained-33100f6d193">分析Vidhya </a>的<a class="ae jo" rel="noopener" href="/@pythonlessons0"> Python课程</a></figcaption></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="a244" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看YOLO v3架构，</p><p id="597c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">暗网-53 </strong></p><p id="02c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">YOLO v3使用Darknet-53作为它的特征提取器(主干)。这里使用了跳过连接的想法，以帮助激活通过更深的层传播，而没有通过ResNet获得的梯度递减。</p><figure class="mi mj mk ml fd ij er es paragraph-image"><div class="ab fe cl ni"><img src="../Images/62c9534996589b32c5d7aa67d2275635.png" data-original-src="https://miro.medium.com/v2/format:webp/1*JRHvCScrfeIm5rk2CgIJSg.png"/></div><figcaption class="mo mp et er es mq mr bd b be z dx translated">来自<code class="du nj nk nl nm b"><a class="ae jo" href="https://arxiv.org/abs/1804.02767" rel="noopener ugc nofollow" target="_blank">YOLOv3: An Incremental Improvement</a></code>的图表</figcaption></figure><p id="e273" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于YOLO V3被设计为多尺度检测机，我们也需要多尺度的特征。因此，来自最后三个残差块的特征都被用于后面的检测。</p><p id="de8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从darknet-53获得的特征向量被送入多尺度检测器。检测器的最终输出将为[(52，52，3，(4 + 1 +数量类))，(26，26，3，(4 + 1 +数量类))和(13，13，3，(4 + 1 +数量类))] <em class="js">。</em>(4+1+num _ classes)是因为锚盒预测。</p><p id="1815" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">darknet-53架构由darknetConv函数中的conv层和剩余块组成。conv层和残差块被组合以形成暗网块，残差层如在架构中提到的那样被重复。使用跳过连接，x_36层、x_61层和最后一层是暗网输出返回的特征向量。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="6bd6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">损失函数:</strong></p><p id="61fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">YOLO使用预测值和地面实况之间的误差平方和来计算损失。损失函数包括:</p><ul class=""><li id="ba42" class="lu lv hi is b it iu ix iy jb mv jf mw jj mx jn lz ma mb mc bi translated">L <strong class="is hj">定位/回归损失</strong>(预测边界框和地面实况之间的误差)。</li><li id="ccbd" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated">C <strong class="is hj">信心损失</strong>(箱子的实物)。</li><li id="1039" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn lz ma mb mc bi translated"><strong class="is hj">分类损失</strong>。</li></ul><figure class="mi mj mk ml fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nn"><img src="../Images/e6ccb2911bc3a057d97b8ee8b8f87627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hw2YQKQR8CEi-w1xDuDo5A.png"/></div></div></figure><p id="8666" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回归损失的第一部分是边界框质心的损失。<em class="js"> x </em>和<em class="js"> y </em>是相对于地面的质心位置。<em class="js">x’</em>和<em class="js">y’</em>是来自检测器的质心预测。这种损失越小，预测和地面实况的质心就越接近。如果在那些单元的基础事实中没有对象，则obj分数为0，如果对象存在，则obj分数为1。lambda_cord是更强调本地化而不是分类的权重。</p><p id="b1e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回归损失的第二部分是边界框宽度和高度的损失。这种损失与回归损失的第一部分相同。</p><p id="8b5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二个损失是信心损失。c表示当前单元格中有对象的可能性。这里我们将使用二进制交叉熵代替均方误差。信心损失的第二部分，<em class="js"> noobj_loss </em>是<em class="js"> </em>惩罚网络如果到处提出对象，所以用来惩罚这些假阳性的提议。因为在我们的基本事实中，noobj 比obj 多得多，所以我们也需要这个<em class="js"> Lambda_Noobj = 0.5 </em>来确保网络不会被没有对象的单元所控制。</p><p id="8910" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后一个损失是分类损失。如果总共有80个类，则<em class="js">类</em>和<em class="js">类'</em>将是具有80个值的独热编码向量。在YOLO v3中，它被更改为多标签分类，而不是多类分类。因此，每个输出像元可能有不止一个类为真。相应地，我们也对每一类逐一应用二元交叉熵并求和，因为它们并不互斥。就像我们对其他损失所做的一样，我们也乘以这个<em class="js"> obj_mask </em>，这样我们只计算那些具有基础真值对象的单元格。</p><p id="173d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> YOLO v3损耗实现:</strong></p><p id="42c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">预测输出</strong>是形状(批量大小，网格，网格，锚，(x，y，w，h，obj，…cls))。预测的输出被传递到yolo _ boxes函数，该函数返回包含x1，y1，x2，y2坐标的pred_box，包含预测的对象得分的pred_obj，包含预测的类的pred_class和由x，y(即预测的中心坐标)和w，h(即预测的宽度和高度)组成的pred_xywh。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="bfa2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">真实输出</strong>是形状(批量大小，网格，栅格，锚，(x1，y1，x2，y2，obj，cls))。真实输出被分成包含x1、y1、x2和y2的true_box、包含对象性分数的true_obj和包含类的true_class_idx。中心坐标以及高度和宽度从x1、y1、x2、y2坐标值获得。</p><p id="dd61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">box_scale_loss赋予小盒子更多的权重。它与lambda_coord相同。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="3763" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">计算obj_mask </strong>，obj_mask <em class="js"> </em>为1或0，表示是否有物体。best_iou分数通过使用pred_box、true_box和obj_mask来计算。使用best_iou得分的值，计算忽略屏蔽。</p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="d119" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过使用在先前步骤中计算的值来计算定位损失、置信度损失和分类损失。最后将所有这些损失相加得到<strong class="is hj"> YOLO损失。</strong></p><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="mm mn l"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="25d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">训练:</strong></p><p id="a204" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过使用训练tfrecord文件来完成训练，并且验证tfrecord文件用于验证..我们还需要传递必要的参数。训练代码可以在我的<a class="ae jo" href="https://github.com/vignesh-bhat1999/Traffic-sign-detection" rel="noopener ugc nofollow" target="_blank"> github库</a>中看到。</p><p id="8dce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还对训练图像进行了增强，增强包括水平翻转、色调、饱和度、剪切、缩放、平移和旋转。边界框值也必须随着每次扩充而改变。</p><h1 id="13d3" class="ld ke hi bd kf le nc lg kj lh nd lj kn lk ne lm kq ln nf lp kt lq ng ls kw lt bi translated"><strong class="ak">第四步:预测</strong></h1><div class="mi mj mk ml fd ab cb"><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/80da08924ed40b043271fb110de5a707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*yH73HMRJCRFqUkjlUxhyoA.jpeg"/></div></figure><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/e4cc78efbebe07447009f0c685087429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Sf_GOPl7dNvgBz2fA9YCNQ.jpeg"/></div><figcaption class="mo mp et er es mq mr bd b be z dx nu di nv nw translated">禁止检测</figcaption></figure></div><div class="ab cb"><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/1fdc9f41d4f439cc62b9547313e89f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*lldIrtySGC8tFWI3TYRYjQ.jpeg"/></div></figure><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/7b28735d528c813d9141f07ac73b8bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*saefraYIOrBbk4YBbTfVeg.jpeg"/></div><figcaption class="mo mp et er es mq mr bd b be z dx nu di nv nw translated">强制检测</figcaption></figure></div><div class="ab cb"><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/b91e5ebdbb7f4905ffb3422bf5601191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*IdSVP-j9yR4wtYH4N1EcLg.jpeg"/></div></figure><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ad5d196b887fb75da23e19c7626db834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*T6Wotk0MBlkWi8lx-92O-g.jpeg"/></div><figcaption class="mo mp et er es mq mr bd b be z dx nu di nv nw translated">危险检测</figcaption></figure></div><div class="ab cb"><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/e95f8e0cc220c13add683bcefee4cbbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fED9IDUJZ_C3ViFqaPcupw.jpeg"/></div></figure><figure class="no ij np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/5f0c4a2c443b36febf31356a681b35c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*mXsf9S0HJsitZJPH85iHPg.jpeg"/></div><figcaption class="mo mp et er es mq mr bd b be z dx nu di nv nw translated">其他检测</figcaption></figure></div><h2 id="9b93" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">进一步改进:</h2><p id="b0d6" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">我们也可以用损失函数而不是二元交叉熵来训练。我们可以使用其他损失函数，例如聚焦损失，这可能有助于对检测到的对象进行分类。</p><p id="fd92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">yolov3中使用的锚盒是imagenet的锚盒。我们可以在整个数据集上使用K-means为数据集创建自定义锚盒。</p><h1 id="55ac" class="ld ke hi bd kf le nc lg kj lh nd lj kn lk ne lm kq ln nf lp kt lq ng ls kw lt bi translated">第五步:结论</h1><p id="0ccd" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">这是我第一次体验计算机视觉，也是我第一次与深度学习相关的案例研究，我希望你喜欢阅读它。在这个案例研究中，我学到了很多技巧。我感谢AppliedAI和我的导师，他们在整个案例研究中帮助了我。</p><p id="20db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我的工作到此结束。感谢您的阅读！</p><h1 id="19cc" class="ld ke hi bd kf le nc lg kj lh nd lj kn lk ne lm kq ln nf lp kt lq ng ls kw lt bi translated"><strong class="ak">参考文献:</strong></h1><ol class=""><li id="aea5" class="lu lv hi is b it ky ix kz jb lw jf lx jj ly jn nx ma mb mc bi translated"><a class="ae jo" href="https://github.com/zzh8829/yolov3-tf2" rel="noopener ugc nofollow" target="_blank">https://github.com/zzh8829/yolov3-tf2</a></li><li id="abe4" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn nx ma mb mc bi translated"><a class="ae jo" href="https://towardsdatascience.com/dive-really-deep-into-yolo-v3-a-beginners-guide-9e3d2666280e" rel="noopener" target="_blank">https://towards data science . com/dive-really-deep-into-yolo-v3-a-初学者指南-9e3d2666280e </a></li><li id="906b" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn nx ma mb mc bi translated"><a class="ae jo" rel="noopener" href="/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088">https://medium . com/@ Jonathan _ hui/real-time-object-detection-with-yolo-yolov 2-28 B1 b 93 e 2088</a></li><li id="b522" class="lu lv hi is b it md ix me jb mf jf mg jj mh jn nx ma mb mc bi translated"><a class="ae jo" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li></ol><p id="96e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="js">你也可以在</em><strong class="is hj"><em class="js"/></strong><a class="ae jo" href="https://www.linkedin.com/in/vignesh-b-s-b7a805152/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="js">LinkedIn</em></strong></a><em class="js">和</em><a class="ae jo" href="https://github.com/vignesh-bhat1999" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="js">GitHub</em></strong></a><em class="js">上找到并联系我。</em></p></div></div>    
</body>
</html>