<html>
<head>
<title>Requests-HTML: The modern way of web scraping.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网页抓取的现代方式。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-modern-way-of-web-scraping-requests-html-2567ba2554f4?source=collection_archive---------1-----------------------#2020-04-16">https://medium.com/analytics-vidhya/the-modern-way-of-web-scraping-requests-html-2567ba2554f4?source=collection_archive---------1-----------------------#2020-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/e81910204e5dc573ea11e0c41a233b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M4ULo0oEx69Vcrq13UwcAg.jpeg"/></div></div></figure><div class=""/><p id="087c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Python是您工具箱中的优秀工具，它使许多任务变得更加简单，尤其是在数据挖掘和操作方面。作为一名自由职业者，人们经常出于同样的原因来找我:Python很难，代码就像一碗意大利面条一样容易理解，初学者通常无法理解。"为什么我需要3个不同的库来从网站上下载一些数据？"这是非常不幸的，因为网络抓取是科学家们几乎每天都会用到的东西，尤其是数据。</p><p id="7bcc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本教程中，我将向你展示带有<strong class="is hu"> <em class="jo">请求的网页抓取的基础知识——html</em></strong>，从网站上抓取数据的现代方式。</p><h1 id="49d1" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">设置</h1><p id="4f86" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在你安装了<a class="ae ks" href="http://python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>之后，你需要导入我将在这里与pip一起使用的库。打开您的终端(Windows上的Powershell，Mac上的terminal)并键入:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="16e4" class="lc jq ht ky b fi ld le l lf lg">pip install requests-html</span></pre><p id="a1aa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后创建一个名为<em class="jo"> app.py </em>的文本文件。这是你的申请文件。您可以使用任何普通的文本编辑器来编辑这个文件。我会推荐<a class="ae ks" href="https://atom.io/" rel="noopener ugc nofollow" target="_blank"> Atom </a>、<a class="ae ks" href="https://www.sublimetext.com/" rel="noopener ugc nofollow" target="_blank"> Sublime Text </a>或者<a class="ae ks" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Code </a>。写入您的文件:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="b7ee" class="lc jq ht ky b fi ld le l lf lg">import requests-html<br/>import csv</span></pre><p id="e6a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">requests-html 比urllib和beautiful-soup更有优势，因为它更容易使用，并且将两者的特性结合到一个库中。</p><h1 id="d437" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">提取数据</h1><p id="d8de" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在，我们都设置好了，我们可以继续下载数据:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="ded8" class="lc jq ht ky b fi ld le l lf lg">from requests_html import HTMLSession<br/>session = HTMLSession()</span></pre><p id="f8c5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">会话像普通的web浏览器一样请求网站，最重要的是，它看起来也像一个浏览器。让我们给我们的会议一个网站刮:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="687f" class="lc jq ht ky b fi ld le l lf lg">url = <a class="ae ks" href="https://github.com/davidkowalk?tab=repositories" rel="noopener ugc nofollow" target="_blank">https://github.com/davidkowalk?tab=repositories</a><br/>response = session.get(url)</span></pre><p id="4fd2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将下载你的页面的所谓来源，在这种情况下，我的GitHub配置文件。让我们下载我的库的所有名字！在您选择的浏览器中打开网站，右键单击其中一个列表项并选择<em class="jo"> Inspect-Element。</em></p><figure class="kt ku kv kw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lh"><img src="../Images/7a53a9f32b6afaaefc89c9c04ebf50a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DHVsR5moOqwlEo0Iu4hTcA.png"/></div></div></figure><p id="2897" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您应该可以看到编译后的页面源代码。</p><figure class="kt ku kv kw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es li"><img src="../Images/71332ab8a4273a1009b99b902ebd5e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3VaUsK9_eT3ofBiNaBhpfQ.png"/></div></div></figure><p id="6a2b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">列表在一个id为<em class="jo">“用户-存储库-列表”</em>的<em class="jo"> &lt; div &gt; </em>元素中，我们来搜索一下。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="28c0" class="lc jq ht ky b fi ld le l lf lg">container = response.html.find(“#<em class="jo">user-repositories-list”, first=True)<br/></em>list = container.find(“li”)</span></pre><p id="6b8a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将返回所有存储库的列表。#是id标签的html标记。现在，对于每一个列表，我们都希望找到存储库的名称及其要写入文件的语言。首先，我们将准备数据结构。该列表应该包含一个标题，然后我们想追加我们的数据点。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="cee0" class="lc jq ht ky b fi ld le l lf lg">sheet = [[“Name”, “Language”]]</span></pre><p id="54e9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们遍历列表中的所有元素，找到名称和语言。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="aa63" class="lc jq ht ky b fi ld le l lf lg">for item in list:<br/>    elements = item.text.split(“\n”)<br/>    name = elements[0]<br/>    lang = elements[2]</span><span id="97fd" class="lc jq ht ky b fi lj le l lf lg">    sheet.append([name, lang])</span></pre><p id="5f56" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> elements </em>是列表中每一项的所有信息的数组。例如，对于第一项，它看起来像这样:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f9d5" class="lc jq ht ky b fi ld le l lf lg">[‘FunctionSynthesizer’, ‘Description’, ‘Python’, ‘2’, ‘License’, ‘Apr 15, 2020’]</span></pre><p id="788a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一个元素(编号0)是名称。该语言位于第三位，所以它的id为2。</p><h1 id="6b32" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">保存您的数据</h1><p id="207a" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在我们有了一个我们想要的所有信息的二维列表。我们要做的就是把它写在一个文件里。CSV是一种开放的表格格式，可以用Excel或类似的程序打开。用Python实现的CSV-Package可以用来轻松地读写文件:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0ab2" class="lc jq ht ky b fi ld le l lf lg">with open(“Filename.csv”, “w”, newline=’’, encoding=’utf-8') as file:<br/>    writer = csv.writer(file)<br/>    writer.writerows(sheet)</span></pre><p id="df8f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您可以在终端中运行您的应用程序:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="ca44" class="lc jq ht ky b fi ld le l lf lg">python app.py</span></pre><p id="adfc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这会生成一个可以用Excel打开的CSV文件。</p><figure class="kt ku kv kw fd hk er es paragraph-image"><div class="er es lk"><img src="../Images/4599fb20e1270ab92c09782687fced57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*YIAk8E9ABxQpJSay6vZ9kA.png"/></div></figure><p id="40a2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可能会注意到这不是100%干净的。并非所有字段都选择正确，因为这种方法依赖于特定的格式，而这种格式并不总是能够实现。作为练习，尝试自己解决这个问题。</p><p id="3e5d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以参考的文档</p><ul class=""><li id="7a07" class="ll lm ht is b it iu ix iy jb ln jf lo jj lp jn lq lr ls lt bi translated"><a class="ae ks" href="https://pypi.org/project/requests-html/" rel="noopener ugc nofollow" target="_blank">请求-HTML </a>和</li><li id="1e10" class="ll lm ht is b it lu ix lv jb lw jf lx jj ly jn lq lr ls lt bi translated"><a class="ae ks" href="https://docs.python.org/3/library/csv.html" rel="noopener ugc nofollow" target="_blank"> Python CSV </a></li></ul><p id="ff87" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请求——HTML有更多的特性，比如异步数据收集、JavaScript支持和自动重定向。如果你想更深入地了解网络抓取，这无疑是一个很好的工具。</p><p id="7c6a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你有任何进一步的问题，请在下面随意评论，我会尽量回复你。</p></div></div>    
</body>
</html>