<html>
<head>
<title>Simple Multi-Class Classification using CNN for custom Dataset.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CNN对自定义数据集进行简单的多类分类。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multi-class-classification-using-cnn-for-custom-dataset-7759865bd19?source=collection_archive---------4-----------------------#2020-05-17">https://medium.com/analytics-vidhya/multi-class-classification-using-cnn-for-custom-dataset-7759865bd19?source=collection_archive---------4-----------------------#2020-05-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4cb8aa77e00f71a288db068577ca69de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7CGnGx171KHm4sg9fNTvVQ.png"/></div></div></figure><p id="c753" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用多类分类类似于二类分类，在代码上有一些变化。</p><p id="811d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">二元分类:-</p><p id="2045" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">二元类CNN模型包含<strong class="is hj"> 2类</strong>的分类，例如猫或狗。提供一组<strong class="is hj">图像(每个类别至少100个)</strong>，两个类别被分成<strong class="is hj">训练和验证文件夹，每个</strong>内有类别文件夹，用作CNN模型的输入。CNN 模型的最后一个<strong class="is hj">密集层使用<strong class="is hj">sigmoid</strong>激活来处理输出，最终输出层只有一个神经元，Sigmoid激活将图像分类为<strong class="is hj"> 0或1 </strong>猫或狗。</strong></p><blockquote class="jo jp jq"><p id="ee35" class="iq ir jr is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated"><strong class="is hj"> tf.keras.layers.Dense(1，activation='sigmoid') </strong></p></blockquote><p id="7617" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">二进制类使用<strong class="is hj">“二进制_交叉熵”损失函数</strong> <em class="jr"> </em>进行<strong class="is hj"> </strong>损失值的计算。</p><blockquote class="jo jp jq"><p id="275f" class="iq ir jr is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">model . compile(loss = ' binary _ cross entropy '，<br/> optimizer=RMSprop(lr=0.001)，<br/> metrics=['acc'])</p></blockquote><p id="33b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">多级分类:-</p><p id="d62f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">类似于二类分类，多类CNN模型具有<strong class="is hj">多个类</strong>让我们考虑下面的例子。提供一组<strong class="is hj">图像(每类至少100张)</strong>两类图像，分为<strong class="is hj">训练和验证文件夹</strong>，用作CNN模型的输入。CNN 模型的最后一个<strong class="is hj">密集层使用<strong class="is hj">【soft max】</strong>激活处理输出，最终输出层的<strong class="is hj">类别数=神经元数</strong>。</strong></p><blockquote class="jo jp jq"><p id="392d" class="iq ir jr is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated"><strong class="is hj"> tf.keras.layers.Dense(6，activation='softmax') </strong></p></blockquote><p id="bb00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">多类使用<strong class="is hj">“分类_交叉熵”损失函数</strong> <em class="jr"> </em>进行<strong class="is hj"> </strong>损失值的计算。</p><blockquote class="jo jp jq"><p id="26a2" class="iq ir jr is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">model . compile(loss = ' categorial _ cross entropy '，<br/> optimizer=RMSprop(lr=0.001)，<br/> metrics=['acc'])</p></blockquote><p id="ed58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">训练和验证图像的<strong class="is hj">分布由两种类型的图像数量决定，不同项目的图像数量不同。通常是80/20，即80%的图片在训练文件夹中，20%在有效文件夹中。</strong></p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es jv"><img src="../Images/6a3e9e251573e50a2a0dfbf57eb804a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*11qgl0dlIyyegt3XT48rAw.jpeg"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><strong class="bd ke">目录/文件夹的结构</strong></figcaption></figure><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/d134db769ab3999b1909b624d79aa509.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*bzsHaWiWGc5VsTrb9brS9w.png"/></div></figure><p id="6a19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">访问创建的目录，<strong class="is hj">仅访问列车和有效文件夹。</strong></p><p id="0c2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里有一个简单的<strong class="is hj">卷积神经网络(CNN) </strong>用于多类分类。我开发了这个<strong class="is hj">模型</strong>来实现自然图像的多类分类(风景、冰景、日落、瀑布、森林/树林和海滩)。这是一个<strong class="is hj">简单的CNN，有一些超参数</strong>调整为更好的结果。我总共拍摄了200多张所有6个类别的图片(风景、冰景、日落、瀑布、森林/树林和海滩)。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/63e8bca94faaecac48ec205a1358c91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WmC-EcJE8M9K07wDW0YJaw.jpeg"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">班级图像(海滩)</figcaption></figure><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/0136abf7ed253d64f844fdd167af9532.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*4RCgb9DZqCUZO-2KnUIwYA.jpeg"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">班级形象(日落)</figcaption></figure><p id="790a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本地机器和google colab上训练他们，使用Google colab获得更好的性能和更多的超参数调整。</p><p id="4d33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我使用的CNN模型的代码片段:-</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/8796b48d48b31bf835d158591dbf36d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQiurkjr3-0-L_LRx1erow.jpeg"/></div></div></figure><p id="cc53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个简单的CNN模型，你可以使用<strong class="is hj">转移学习</strong>和使用预训练模型，如<strong class="is hj">初始模型</strong>，它已经训练了超过10000个类，并且具有可以用来训练你的定制模型的权重。</p><p id="c262" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">模型编译的片段:-</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/4cdbc7aece5791cacdb38641b5d1978b.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*m1Pv0tEqFDBKlA44wg2H9Q.png"/></div></figure><p id="5590" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里损失函数<strong class="is hj">“分类交叉熵”</strong>是多类CNN分类的主要变化。</p><p id="ce2a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">优化器与超参数一起使用，针对自定义学习率进行了调整。</p><p id="1c7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了获得更好的性能，您可以使用数据扩充将代码中的图像转换成各种转换(<strong class="is hj">旋转、剪切、缩放、颜色变化、… </strong>)</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/ec852ce39f469e501c3ea118e627214e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0K_1WMJ95TjDcGJJnIuWIA.png"/></div></div></figure><p id="566b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在所有上述步骤之后，我们最终拟合模型并开始训练。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/b44344a5230db17f546cce478378d67b.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*cN-sQbihRdx12f7DSSpXeg.png"/></div></figure><p id="2af5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，为上面处理的所有数据训练模型。</p><p id="313a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你愿意，你可以将<strong class="is hj">模型权重</strong>保存到一个文件中，这样你就可以在以后使用它来预测你的类。</p><figure class="jw jx jy jz fd ij er es paragraph-image"><div class="er es km"><img src="../Images/38cd446622e47cd116145554c1271735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*Vb4P6CQn0aobca9FGK7z7w.png"/></div></figure><p id="c5f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">预测类是通过将模型加载到python文件中，然后<strong class="is hj">输入图像</strong> ( <strong class="is hj">它不应该在模型的训练或有效文件夹</strong>)来完成的，然后预测生成的图像和打印类，这里，在打印后，只有图像中存在的那些类将具有更接近1或1 的<strong class="is hj">值，这取决于模型的<strong class="is hj">精度和输入图像上的损失</strong>。</strong></p><p id="e334" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">示例:class predicted= [0，0，1，0，0，0]在这里，根据我的模型，它将预测输入图像是风景图像。</p><div class="kn ko ez fb kp kq"><a href="https://github.com/PushprajMaraje/DeepLearningTests.git" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hj fi z dy kv ea eb kw ed ef hh bi translated">PushprajMaraje/深度学习测试</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">在GitHub上创建一个帐户，为PushprajMaraje/deep learning tests的开发做出贡献。</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">github.com</p></div></div><div class="kz l"><div class="la l lb lc ld kz le io kq"/></div></div></a></div><p id="19a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是本指南使用的全部代码</p><p id="d63b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以上是简单的多类分类，希望这能帮助你度过难关。</p></div></div>    
</body>
</html>