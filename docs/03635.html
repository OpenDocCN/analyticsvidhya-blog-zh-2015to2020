<html>
<head>
<title>All About Index In SQL Server 2020</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL Server 2020中的索引</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/all-about-index-in-sql-server-2020-sagar-jaybhay-219a092f05ce?source=collection_archive---------20-----------------------#2020-02-11">https://medium.com/analytics-vidhya/all-about-index-in-sql-server-2020-sagar-jaybhay-219a092f05ce?source=collection_archive---------20-----------------------#2020-02-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/76aff59df6df3bca13b61db7b13fa691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eY-NX3JRLes3OftX4fmB1Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">SQL SERVER SAGAR JAYBHAY</figcaption></figure><p id="3b4b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，您将了解什么是SQL Server中的索引。此外，您将了解到唯一和非唯一索引之间的区别。</p><p id="81d5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">索引用于快速查找表中的数据。在视图和表上创建索引。它类似于图书索引。</p><p id="e9e1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您应用索引，它将大大提高查询性能。如果没有索引，那么查询引擎从头到尾检查每一行，这将需要很长时间，这称为表扫描。</p><p id="e12a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">您可以通过两种方式在</strong><a class="ae js" href="https://www.microsoft.com/en-in/sql-server/sql-server-2019" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">SQL server</strong></a><strong class="iw hj">中创建索引。1)通过查询2)图形界面。</strong></p><p id="292b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">索引是一种特殊的数据结构，它与表和视图相关联，借助于它可以提高查询的性能。</p><p id="303d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">常规语法:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="8d41" class="kc kd hi jy b fi ke kf l kg kh">Create index index_name on table_name (column_name asc)</span></pre><p id="f30a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">例子</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="adbc" class="kc kd hi jy b fi ke kf l kg kh">create index in_employee on Employee (empid asc)</span></pre><p id="34a6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上面的查询在empid列的employee表上创建了一个in_employee索引。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/6ac665bbfc3c3e8131c7fea4f5858866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-7YDYRrG8sPAOfp6ogSkxw.png"/></div></div></figure><p id="744c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用下面的命令找出在表上创建的所有索引</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="e1ab" class="kc kd hi jy b fi ke kf l kg kh">sp_helpindex Employee</span></pre><p id="7b8f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这个<strong class="iw hj">中，sp_heplindex </strong>是一个系统存储过程。</p><h2 id="161c" class="kc kd hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">怎么降指数？</h2><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="efcb" class="kc kd hi jy b fi ke kf l kg kh">Drop index tablename.index_name;<br/> -- Example<br/>Drop index employee.index_name</span></pre><h1 id="0d23" class="lc kd hi bd kj ld le lf kn lg lh li kr lj lk ll ku lm ln lo kx lp lq lr la ls bi translated">SQL Server中存在不同类型的索引。</h1><h1 id="720b" class="lc kd hi bd kj ld le lf kn lg lh li kr lj lk ll ku lm ln lo kx lp lq lr la ls bi translated">聚集索引</h1><p id="74eb" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">聚集索引决定了表中数据的物理顺序。因为它决定了物理顺序，所以表只能有一个聚集索引。</p><p id="4b86" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您的列包含主键约束，并且在该表上，如果您创建索引，则它会自动标记为聚集索引。</p><p id="81b4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">假设您创建了一个表，在一列上创建了一个主键，然后它会自动在该列上创建聚集索引，如下图所示。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/33156aaf2b2b0cc1893c3b84a8620027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*irP4vM-gml4EnWk2zJ07aw.png"/></div></div></figure><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="5816" class="kc kd hi jy b fi ke kf l kg kh">create table tblEmp<br/>(<br/>id int primary key,<br/>name varchar(100),<br/>salary int,<br/>gender varchar(10),<br/>city varchar(10)<br/>)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/a102b0d1bc567e87c26517c477822e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*qofN3smbNCkrnm6Wv3C9cw.png"/></div></figure><p id="37d1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当您的表包含聚集索引时，它被称为聚集表。如果表没有聚集索引，那么数据行存储在一个无序的结构中，这个结构称为堆。</p><p id="6a4c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">聚集索引以一种特殊的结构组织数据，因此它被称为B树。</p><p id="0b1f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如下图所示，我们以随机的方式插入数据，但是当我们选择这些数据时，你可以看到它们是有序的。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="7905" class="kc kd hi jy b fi ke kf l kg kh">insert into tblEmp values(10,'sagar',1000,'Male','Pune'),(11,'XYZ',1000,'Female','USA'),(12,'ABC',1000,'Male','JAPAN'),(1,'JAYBHAY',1000,'Male','INDIA');<br/><br/>select * from tblEmp</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/f3af00658f02e07515bba47c4a2dabf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UjfkBnQR9DeF6ojIz-jSWQ.png"/></div></div></figure><p id="7fef" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，这意味着聚集索引自动按排序顺序组织数据。</p><p id="6add" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">创建索引时，索引或聚集可以包含多列。所以这个索引我们称之为复合聚集索引。</p><p id="011f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您的列允许null，则您不能在该列上创建聚集索引。</p><p id="9868" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">《出埃及记》</p><p id="95a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">电话簿:按字母顺序排列。</strong></p><h1 id="aa4e" class="lc kd hi bd kj ld le lf kn lg lh li kr lj lk ll ku lm ln lo kx lp lq lr la ls bi translated">非聚集索引:</h1><p id="a3e0" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">它类似于书中的索引。非聚集索引存储在一个地方，而实际数据存储在另一个地方。这个非聚集索引有指向数据存储位置的指针。</p><p id="83dd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因为它分别存储索引和数据，所以您可以在表上添加多个索引。</p><p id="07f8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在索引本身中，数据以升序或降序存储，这不会影响该表中的数据存储功能。</p><p id="40c4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您可以在表上添加尽可能多的索引。</p><p id="ba35" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">《出埃及记》</p><p id="e7d4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">一本教科书</strong></p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="287f" class="kc kd hi jy b fi ke kf l kg kh">create nonclustered index indx_Employee on Employee(full_name,gender);</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/ed67300386381c33c918781ae2d50e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AbP5olCZIVkxseQCNAyT2A.png"/></div></div></figure><h1 id="b8f1" class="lc kd hi bd kj ld le lf kn lg lh li kr lj lk ll ku lm ln lo kx lp lq lr la ls bi translated">唯一索引和非唯一索引:</h1><p id="a673" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated"><strong class="iw hj">唯一索引</strong>:用于强制各列值的唯一性。</p><p id="fa48" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">默认情况下，primary key约束创建唯一键或唯一聚集索引。</p><p id="671a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您看到唯一性是聚集索引和非聚集索引的属性。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="2f00" class="kc kd hi jy b fi ke kf l kg kh">create unique nonclustered index indx_Employee on Employee(full_name,gender)</span></pre><h1 id="3c69" class="lc kd hi bd kj ld le lf kn lg lh li kr lj lk ll ku lm ln lo kx lp lq lr la ls bi translated">唯一索引和唯一约束之间有什么区别？</h1><p id="0593" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">在这一点上，这两者没有太大的区别。使用unique约束时，会自动创建unique索引。</p><p id="dfa3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我们的employee表中，我们在email列上添加了惟一的约束。要添加唯一的约束，我们需要修改表。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="94ec" class="kc kd hi jy b fi ke kf l kg kh">alter table Employee add constraint uq_employee unique(email);</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/e936a70f8dfd97b134f46220985f2cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-z1yX1YQen7MPaHh9hTghA.png"/></div></div></figure><p id="147f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">参见上图，在运行查询时，索引被创建。</p><h1 id="c3e4" class="lc kd hi bd kj ld le lf kn lg lh li kr lj lk ll ku lm ln lo kx lp lq lr la ls bi translated">何时使用唯一约束？</h1><p id="36dc" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">当我们需要数据完整性时，我们需要使用自动创建唯一索引的唯一约束。无论您创建唯一索引还是添加唯一约束，数据验证的方式都是一样的。</p><h1 id="1481" class="lc kd hi bd kj ld le lf kn lg lh li kr lj lk ll ku lm ln lo kx lp lq lr la ls bi translated">SQL中索引的优缺点是什么？</h1><p id="7e55" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated"><strong class="iw hj">优点</strong>:</p><ol class=""><li id="e501" class="mb mc hi iw b ix iy jb jc jf md jj me jn mf jr mg mh mi mj bi translated">索引用于快速查找数据。</li><li id="b548" class="mb mc hi iw b ix mk jb ml jf mm jj mn jn mo jr mg mh mi mj bi translated">带有where子句的select、update、delete语句可以从索引中受益。</li><li id="553d" class="mb mc hi iw b ix mk jb ml jf mm jj mn jn mo jr mg mh mi mj bi translated">此外，order by子句和group by子句也受益于这些索引。</li></ol><p id="b88f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">缺点</strong>:</p><ol class=""><li id="b1d4" class="mb mc hi iw b ix iy jb jc jf md jj me jn mf jr mg mh mi mj bi translated">需要额外的磁盘空间:聚集索引不需要额外的存储。每个非聚集索引都需要额外的空间，因为它是从单独的表中存储的。所需的空间量取决于表的大小以及选择多少列来创建索引。</li><li id="2d37" class="mb mc hi iw b ix mk jb ml jf mm jj mn jn mo jr mg mh mi mj bi translated">Insert、update、delete语句变得很慢:这意味着Delete、Update查找记录所需的时间要少得多，但是当一个表很大并且有多个索引时，则需要更新这些索引，在这种情况下，太多的索引更新实际上会损害性能。</li><li id="db8f" class="mb mc hi iw b ix mk jb ml jf mm jj mn jn mo jr mg mh mi mj bi translated">覆盖查询:-假设您在选择查询中选择了表中的所有列，并且所有这些列都存在于索引中，则不进行查找，但是如果这些列不存在于索引列中，则需要进行查找。</li></ol></div></div>    
</body>
</html>