<html>
<head>
<title>Imbalanced Datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不平衡数据集</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/imbalanced-datasets-a95fa33e375?source=collection_archive---------23-----------------------#2020-07-26">https://medium.com/analytics-vidhya/imbalanced-datasets-a95fa33e375?source=collection_archive---------23-----------------------#2020-07-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/8a06033801f4759580910e08ca0f4246.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*xyeK4SuHrjui1oG6b76tOA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">代表不平衡</figcaption></figure><p id="2634" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一般来说，数据集在处理时会引发各种各样的问题。最常见的有哪些？</p><p id="45a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据可能有多个缺失值</p><p id="0738" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它可能没有足够的预测能力来做出正确的预测</p><p id="94f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它可能是不平衡的</p><p id="4ccd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本指南中，我们将尝试不同的方法来处理这种不平衡的数据集。</p><p id="a857" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要了解更多关于缺失值分析的信息，您可以参考此处的<a class="ae jo" href="https://link.medium.com/VERSQs3M67" rel="noopener"/>。</p><p id="aaab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">什么是不平衡数据集？</p><p id="81a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不平衡类是机器学习分类中的一个常见问题，其中每个类中的观察值比例不成比例。类别不平衡可以在许多不同的领域中发现，包括医疗诊断、垃圾邮件过滤、欺诈检测和广告点击。</p><p id="3139" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">员工流失数据集示例。我们可以看到阶级不平衡。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jp"><img src="../Images/7e73f18e36b1bdc501596d385f6bdb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*LIbUgmNJIeznhp1yrPJiNw.png"/></div></figure><p id="a703" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在深入研究之前，可以考虑一些简单的解决方案来处理不平衡数据集问题。</p><ul class=""><li id="26c2" class="ju jv hi is b it iu ix iy jb jw jf jx jj jy jn jz ka kb kc bi translated">使用基于树的模型-基于树的模型更有可能在不平衡的数据集上表现得更好。本质上，它们基于分割/决策点构建层次结构，这可能更好地分离类。</li><li id="ebc1" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated">收集更多的数据——更多的数据可以平衡你的数据集，也可能使它更加不平衡。无论哪种方式，您都需要更完整的数据。因此，收集更多的数据始终可以被视为一种选择。</li></ul><p id="f92b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们讨论几种处理不平衡数据集的技术。</p><p id="75ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1)使用正确的评估指标</p><p id="74e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2)对少数类进行上采样</p><p id="2812" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3)对多数类进行下采样</p><p id="0707" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4)使用K倍交叉验证</p><p id="f441" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5)击打</p><p id="3354" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用正确的评估指标</strong></p><p id="d4a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每当我们处理不平衡的数据集时，选择正确的评估指标是非常重要的。多个指标可以提供更好的洞察力。下面列出了一些。</p><p id="6919" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"/>——召回率和真阳性率(TPR)完全相同。回忆总结了正面类别的预测程度，与敏感度的计算方法相同。</p><p id="0253" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">真正/(真正+假负)</p><p id="0102" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Precision </strong> - Precision总结了属于正类的分配给正类的实例的分数。</p><p id="8856" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">真阳性/(真阳性+假阳性)</p><p id="1e51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> F1 </strong></p><p id="e91c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">上采样或过采样</strong></p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/8f2dc1e0df047b0aacc4efd2cf1d175e.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*T5NNaMeLFwQsosXSPv1Y4Q.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">过采样</figcaption></figure><p id="73b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">过采样包括从少数类中复制一些点，以增加其基数。下面来自sklearn的包用于对数据进行重采样。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/d2078f643c768e075c96beeea1f90e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*MZrpiI72fOF_r_ne1xf8FA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">重采样用于数据的重采样</figcaption></figure><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/5e1dfed7219f80e63f2e7517ef8b371e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*G3cKagJWoKH6kvEIhKneww.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">向上采样少数民族类</figcaption></figure><p id="e909" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们可以看到新的数据框架比原来的有更多的观察值。此外，两个班级的比例现在是1:1。</p><p id="fdd6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">降采样或欠采样</strong></p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/443b7a3db5db1709ae73c1db2e0c4273.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*3VBTW7HDN2hIFtom2VzYUw.png"/></div></figure><p id="260b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在大数据集的情况下，下采样是优选的。下采样包括从多数类中随机移除观察值，以防止其观察值支配学习算法。这样做，直到多数和少数类实例达到平衡。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es km"><img src="../Images/54ebf77e99ec54b0192b91448895971e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*gFAu37sZrB4-wAYi_kzfbA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">对多数类进行下采样</figcaption></figure><p id="ce27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用K倍交叉验证</strong></p><p id="7a3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">重要的是，在使用过采样方法解决不平衡问题时，应正确应用交叉验证。交叉验证是一种重采样过程，用于在有限的数据样本上评估机器学习模型。该过程有一个称为k的参数，它指的是给定数据样本要被分成的组的数量。因此，这个过程通常被称为k倍交叉验证。当选择了k的特定值时，它可以在模型的引用中代替k使用，例如k=10成为10倍交叉验证。</p><p id="eca7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据科学家必须确保模型正在学习数据中的模式，而不是拟合噪声。</p><p id="6a87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">击杀</strong></p><p id="7783" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">综合少数过采样技术(SMOTE)是一种非常流行的过采样方法，旨在改善随机过采样对高维数据的影响。</p><p id="7142" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于属于欠表示类的每个观察，该算法获得其K个最近邻，并在当前观察和其最近邻之间的线中的随机位置处合成少数标记的新实例。</p><p id="f5b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的示例中(如下图所示)，蓝色圆圈点是当前观测值，蓝色非圆圈点是其最近的邻居，绿色点是合成点。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/a0951561ce0977f0830b63be37cf0e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*mCXiw55tpPPUqDyeTVqnCw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">重击</figcaption></figure><p id="9055" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">合成数据是智能生成的人造数据，类似于它想要增强的数据的形状或值。SMOTE创建的数据与现有数据相似，而不仅仅是通过复制数据来创建新的示例。</p><p id="58c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">结论</strong></p><p id="cf5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在处理不平衡数据集时，没有一个固定的解决方案。我们将不得不根据问题尝试多种方法。根据不平衡数据集的特征，最有效的技术会有所不同。</p><p id="cd4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">-在模型比较期间，应考虑相关的评估参数</p><p id="271c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">-在某些情况下，合成采样方法(如SMOTE)以及高级增强方法(如梯度增强和XG增强)可提供最佳结果</p><p id="b430" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">-可以使用重采样方法，但必须仔细考虑</p><p id="bff8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望你喜欢这个博客！请分享您的反馈和您想了解的话题。</p></div></div>    
</body>
</html>