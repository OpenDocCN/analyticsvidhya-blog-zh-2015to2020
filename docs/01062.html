<html>
<head>
<title>Understanding how Machine Learning can Classify Handwritten Digits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解机器学习如何对手写数字进行分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-how-machine-learning-can-classify-handwritten-digits-e2b7838b8357?source=collection_archive---------12-----------------------#2019-09-28">https://medium.com/analytics-vidhya/understanding-how-machine-learning-can-classify-handwritten-digits-e2b7838b8357?source=collection_archive---------12-----------------------#2019-09-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="80c0" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">举例说明计算机如何理解图像</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/c01b0baa8645609fbbeab94f572b7c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzjKoTfrjPqCa4tRbQqcaQ.png"/></div></div></figure><p id="e957" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们之前已经讨论过了。计算机理解数字。不是文字。不是视频。不是图像。</p><p id="86ed" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">那么，机器学习模型如何从手写字符的图像中提取文本呢？</p><p id="defa" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">让我们看一个手写数字9的图像，它来自sklearn的数据集模块。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="a7fe" class="kk kl hi kg b fi km kn l ko kp"># import datasets module<br/>from sklearn import datasets</span><span id="b8a9" class="kk kl hi kg b fi kq kn l ko kp"># grab the digits dataset from the module<br/>digits = datasets.load_digits()</span><span id="843d" class="kk kl hi kg b fi kq kn l ko kp"># import pyplot to display the image based on pixel values<br/>import matplotlib.pyplot as plt</span><span id="c29b" class="kk kl hi kg b fi kq kn l ko kp"># display an image from the dataset based on index<br/>def display_digit(index):<br/>    image = digits.images[index]<br/>    plt.imshow(image, cmap=plt.cm.gray_r, interpolation='nearest')<br/>    plt.show()    </span><span id="8267" class="kk kl hi kg b fi kq kn l ko kp"># run function<br/>display_digit(9)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kr"><img src="../Images/b3bfc830b46bc4a3cd192039e0e91651.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*o9M0o7N7LYt2rl8A1LJMHg.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">我知道看起来很糟。但我们可以看出这是一个9。</figcaption></figure><p id="c5b1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">图像实际上只是不同亮度的像素矩阵。这些像素的亮度值是我们输入到机器学习模型中的。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="51bd" class="kk kl hi kg b fi km kn l ko kp"># print the matrix of pixel values<br/>digits.images[9]</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kw"><img src="../Images/4d5ccdf8fe38d15c8c154f4796673faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvEd6ItjxuG-YjckAUG5KQ.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">数字越大，像素越暗。</figcaption></figure><p id="e7a7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在把它放入模型之前，我们需要把它弄平。让我们把它显示成一个图像，只是为了好玩。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="9a2c" class="kk kl hi kg b fi km kn l ko kp"># flatten images<br/>flat_images = digits.images.reshape((len(digits.images), -1))</span><span id="c997" class="kk kl hi kg b fi kq kn l ko kp"># display flattened images by index<br/>def display_flat_digit(index):<br/>    image = flat_images[index]<br/>    plt.imshow([image], cmap=plt.cm.gray_r, interpolation='nearest')</span><span id="573d" class="kk kl hi kg b fi kq kn l ko kp">display_flat_digit(9)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kx"><img src="../Images/eabedfe93d5902320bc4c1da7132fddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1YKOYuJPSyEJFel2T5iTg.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">没什么可看的。</figcaption></figure><p id="476e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">扁平化矩阵。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ky"><img src="../Images/bd9a04f3c4ddc046d0ce64ec26d8aefd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qVYJlOhPsjj6UYG0_lcQEQ.png"/></div></div></figure><p id="1543" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在让我们开始做一个分类。首先，我们像往常一样将数据分成测试集和训练集。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="2709" class="kk kl hi kg b fi km kn l ko kp"># examples<br/>X = flat_images</span><span id="7cd1" class="kk kl hi kg b fi kq kn l ko kp"># labels for examples specifying which digit each image represents<br/>y = digits.target</span><span id="a9ed" class="kk kl hi kg b fi kq kn l ko kp"># import an sklearn module to split data between test and train<br/>from sklearn.model_selection import train_test_split</span><span id="f1c5" class="kk kl hi kg b fi kq kn l ko kp"># split the data<br/>X_train, X_test, y_train, y_test = train_test_split(<br/>    X, <br/>    y, <br/>    test_size=0.33, <br/>    random_state=42<br/>)</span></pre><p id="637f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">实例化我们的模型。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="276d" class="kk kl hi kg b fi km kn l ko kp"># load a model from sklearn<br/>from sklearn.linear_model import SGDClassifier<br/>classifier = SGDClassifier()</span></pre><p id="b5cb" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">训练模型。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="8b24" class="kk kl hi kg b fi km kn l ko kp">classifier.fit(X_train, y_train)</span></pre><p id="dd74" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">预测标签。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="1a81" class="kk kl hi kg b fi km kn l ko kp">y_pred = classifier.predict(X_test)</span></pre><p id="cb2b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">评估结果。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="2f00" class="kk kl hi kg b fi km kn l ko kp"># classification_report prints a table with metrics for each class<br/>from sklearn.metrics import classification_report</span><span id="03f0" class="kk kl hi kg b fi kq kn l ko kp">print(classification_report(y_test, y_pred) )</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kz"><img src="../Images/9ef9ef5f1b996ddd7b03bf0315135d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcVV953WQIhsY8JLyRdcSw.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">我们表现如何？</figcaption></figure><p id="022f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们的模型在没有任何调整和考虑小数据集的情况下做得相当好。</p><p id="c88d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们可以用另一个模型或一些调整做得更好吗？绝对的。但在这里，我们只是想通过这个过程来更好地理解机器学习对图像的分类。</p></div></div>    
</body>
</html>