<html>
<head>
<title>Face-Mask-Detection using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习的人脸面具检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/face-mask-detection-using-deep-learning-83f927654f1e?source=collection_archive---------5-----------------------#2020-06-27">https://medium.com/analytics-vidhya/face-mask-detection-using-deep-learning-83f927654f1e?source=collection_archive---------5-----------------------#2020-06-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d405" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新的新冠肺炎病毒迫使我们所有人重新思考我们如何在保证自己和他人安全的同时过好我们的日常生活。口罩已经成为减少病毒威胁的一种简单而有效的策略，并且口罩检测系统的应用现在在交通工具、人口密集区、住宅区、大型制造商和其他企业中需求很高，以确保安全。因此，今天文章的目标是利用深度学习开发一个人脸面具检测器。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1216e65de67fad2a88cdbe78f7ad1b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t06xbjIRtQaZSlPlCA4vWA.jpeg"/></div></div></figure><h1 id="fc74" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">目录</h1><ol class=""><li id="7bd6" class="kn ko hi ih b ii kp im kq iq kr iu ks iy kt jc ku kv kw kx bi translated">关于数据集</li><li id="2d98" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">卷积神经网络(CNN)架构</li><li id="bc21" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">CNN模型的训练和评估</li><li id="c78f" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">实验和结果</li><li id="cf80" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">下一步是什么？</li></ol><h1 id="518b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">关于数据集</h1><p id="b265" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">数据集中使用的图像是戴面具的人的真实图像，即数据集不包含变形的面具图像。数据集由3835幅图像组成，分为两类:</p><ul class=""><li id="cd6c" class="kn ko hi ih b ii ij im in iq lg iu lh iy li jc lj kv kw kx bi translated">with_mask: 1916个图像</li><li id="cb44" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lj kv kw kx bi translated">不带_遮罩:1919幅图像</li></ul><p id="992c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些图像是从以下来源收集的:</p><ul class=""><li id="7415" class="kn ko hi ih b ii ij im in iq lg iu lh iy li jc lj kv kw kx bi translated">Bing搜索API ( <a class="ae lk" href="https://github.com/chandrikadeb7/Face-Mask-Detection/blob/master/search.py" rel="noopener ugc nofollow" target="_blank">参见Python脚本</a>)</li><li id="2814" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lj kv kw kx bi translated">Kaggle数据集</li><li id="f450" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc lj kv kw kx bi translated">RMFD数据集(<a class="ae lk" href="https://github.com/X-zhangyang/Real-World-Masked-Face-Dataset" rel="noopener ugc nofollow" target="_blank">见此</a>)</li></ul><h1 id="3542" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">CNN架构</h1><blockquote class="ll lm ln"><p id="4f43" class="if ig lo ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated">卷积神经网络(convnets)是深度学习领域的一个主要研究方向。CNN是一种神经网络，广泛用于图像识别和分类。，它们主要用于识别图像中的模式。我们不把特征输入其中，它们自己识别特征。CNN的主要操作是卷积、合并或子采样、非线性和分类。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/6c63667b15aa237760904746829a9ffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JVPSkwwnViadAo2BqowgPA.png"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">CNN架构</figcaption></figure><ol class=""><li id="a4a0" class="kn ko hi ih b ii ij im in iq lg iu lh iy li jc ku kv kw kx bi translated"><strong class="ih hj">卷积:</strong>卷积网的名字来源于卷积运算符。在卷积的情况下，卷积的主要目的是从输入图像中提取特征。卷积通过使用输入数据的小方块学习图像特征来保持像素之间的空间关系。</li><li id="3a3d" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated"><strong class="ih hj">汇集:</strong>汇集的主要目的是减少输入图像的大小，但保留重要信息。它可以以不同的类型完成，如最大值、总和、平均值等。在最大池的情况下，我们定义一个窗口并从中取最大的元素，我们也可以取平均值(平均池)，即该窗口内所有元素的总和(总和池)。</li><li id="e765" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated"><strong class="ih hj">非线性:</strong>激活函数是添加到神经网络中的函数，用于帮助网络学习数据中的复杂模式，即引入非线性。例如，激活函数ReLU(整流线性单元)用于在CNN中引入非线性。它通过执行逐元素操作将图像中的所有负值像素替换为零。</li><li id="9046" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated"><strong class="ih hj">全连接:</strong>全连接层是传统的多层感知器，在输出层使用softmax激活函数(也可以使用其他分类器，如SVM)。术语完全连接意味着前一层中的每个神经元都连接到下一层中的每个神经元。卷积层和池层的输出代表输入图像的高级特征。全连接图层的目的是使用这些特征根据训练数据集将输入影像分类到不同的类别中。</li></ol><h1 id="2fa8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">CNN模型的训练和评估</h1><p id="db1c" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">CNN模型的训练需要以下步骤:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lx ly l"/></div></figure><ol class=""><li id="ab78" class="kn ko hi ih b ii ij im in iq lg iu lh iy li jc ku kv kw kx bi translated"><strong class="ih hj">预处理:</strong>对所有的原始输入图像进行预处理，将其转换成干净的版本，然后输入到神经网络机器学习模型中。输入图像的大小调整为224 x 224 ( <strong class="ih hj">第8行)</strong>，并将输入图像传递给(<strong class="ih hj">第9行)</strong>中的<strong class="ih hj">预处理_输入</strong>函数，这意味着使您的图像符合模型要求的格式(您保证您加载的图像与预处理_输入兼容)。最后将数据和标签转换成NumPy数组，以便在(<strong class="ih hj">第14行)</strong>中进一步处理。对标签执行一次热编码，将分类数据转换为数字数据<strong class="ih hj">(第17–19行)。</strong></li><li id="9f00" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated"><strong class="ih hj">模型创建:</strong>CNN模型<strong class="ih hj">(第23–33行)</strong>包括两个卷积层，后面是激活函数ReLU(增加非线性)和Max Pooling(减少特征图)。添加辍学是为了防止神经网络过度拟合。然后，在末尾添加完全连接的层。最后，我们将我们的模型编译成损失函数、优化器和指标<strong class="ih hj">(第36行)。</strong><strong class="ih hj">损失函数</strong>用于查找学习过程中的错误或偏差。Keras在模型编译过程中需要损失函数。<strong class="ih hj">优化</strong>是通过比较预测和损失函数来优化输入权重的重要过程，而<strong class="ih hj">指标</strong>用于评估您的模型的性能。</li><li id="b50b" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated"><strong class="ih hj">模型训练:</strong>在开始模型训练之前，我们需要将数据分割成训练测试数据。在我们的例子中，有90%的训练数据和10%的测试数据<strong class="ih hj">(第21行)。</strong>模型由NumPy数组使用fit函数训练<strong class="ih hj">(第41行)</strong>。这个拟合函数的主要目的是用来评估你的模型的训练。</li><li id="1523" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated"><strong class="ih hj">模型预测:</strong>这是最后一步，我们将通过预测测试数据标签<strong class="ih hj">(第44行)</strong>来评估模型的性能。</li></ol><h1 id="973e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结果</h1><ol class=""><li id="bb8f" class="kn ko hi ih b ii kp im kq iq kr iu ks iy kt jc ku kv kw kx bi translated">CNN模型分析。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/fb8347a0c7878140268333de0ca6572f.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*Itzg4ICPYoGqD69mzFBnHg.png"/></div></figure><p id="ba2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.实现图像的面具检测器。</p><p id="9853" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，从磁盘中加载输入图像，然后使用基于<strong class="ih hj"> Caffe的人脸检测器进行人脸检测。</strong>Caffe模型有<strong class="ih hj"> prototxt </strong>文件，这些文件定义了<em class="lo">模型架构</em>(即层本身)</p><p id="6269" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Caffe模型</strong>文件，包含实际层的<em class="lo">权重</em>。最后，对输入图像进行预测，如图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/6574e91400adb6cd69b6a32c53603b3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*pjXucML1WqRyq-Pf0420gg.jpeg"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mb"><img src="../Images/3f22412a95072dd7103622cfd4976b9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2onD4EFt2gDxahyL_udvA.jpeg"/></div></div></figure><p id="c8f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.类似地，面罩检测器被应用于实时视频流。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mc ly l"/></div></figure><h1 id="347e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">下一步是什么？</h1><p id="2868" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">在本文中，我们开发了基于CNN的面罩检测器，可用于公共医疗保健、机场和办公室，以确保安全。<br/>我们还可以使用其他训练模型，如VGGNet和MobileNet作为基础模型，并使用YOLO和darknet来执行人脸检测。</p><h1 id="a01d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">参考</h1><p id="8cbf" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">提供参考总是好的</p><ol class=""><li id="6158" class="kn ko hi ih b ii ij im in iq lg iu lh iy li jc ku kv kw kx bi translated"><a class="ae lk" href="https://github.com/chandrikadeb7/Face-Mask-Detection" rel="noopener ugc nofollow" target="_blank">数据集</a></li><li id="0a97" class="kn ko hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated"><a class="ae lk" href="https://github.com/vzhou842/cnn-from-scratch" rel="noopener ugc nofollow" target="_blank">型号</a></li></ol><p id="2c5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该代码可在<a class="ae lk" href="https://github.com/Devashi-Choudhary/Face_Mask_Detection" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">github.com/Devashi-Choudhary/Face_Mask_Detection</strong></a>获得。如有任何问题或疑问，请直接联系我，电话:<a class="ae lk" href="https://github.com/Devashi-Choudhary" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">github.com/Devashi-Choudhary</strong>。</a></p></div></div>    
</body>
</html>