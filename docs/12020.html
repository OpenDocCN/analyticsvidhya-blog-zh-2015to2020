<html>
<head>
<title>Apply any metrics in PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">应用PyTorch中的任何指标</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/apply-any-metrics-in-pytorch-16e281e06699?source=collection_archive---------19-----------------------#2020-12-28">https://medium.com/analytics-vidhya/apply-any-metrics-in-pytorch-16e281e06699?source=collection_archive---------19-----------------------#2020-12-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0981" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将了解如何在pytorch代码中应用scikit learn库中的任何指标。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d3703d47b570a37676a9195f8e789559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IR72UY3mJrbHEiRWOSqCCw.jpeg"/></div></div></figure><p id="d4d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，在我们的训练循环中，当我们做<strong class="ig hi"> <em class="jo">模型(input _ data _ from _ data loader)</em></strong>时，它将为我们的回归模型 或<strong class="ig hi"> <em class="jo">给出我们n个分类类别</em> </strong>的<strong class="ig hi"> <em class="jo">回归输出。现在，如果我们在GPU或TPU中训练我们的模型，那么我们需要借助这段代码将我们的预测和实际值分离到CPU，并将它们的类型更改为numpy数组。</em></strong></p><pre class="jd je jf jg fd jp jq jr js aw jt bi"><span id="5ca7" class="ju jv hh jq b fi jw jx l jy jz"><strong class="jq hi">real_targets</strong> = <strong class="jq hi">real_targets</strong>.detach().cpu().numpy()<br/><strong class="jq hi">predicted_targets</strong> = <strong class="jq hi">predicted_targets</strong>.detach().cpu().numpy()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/6c35cd19554ed45023e220c03cb466b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XE8XmlrFrQHAnAkEi-ZiRw.jpeg"/></div></div></figure><p id="8446" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这之后，我们需要理解，我们的度量标准想要输入什么。如果它要求对其实际目标和预测目标的所有输出数据进行一次预测，那么我们编写以下代码:</p><pre class="jd je jf jg fd jp jq jr js aw jt bi"><span id="f4c5" class="ju jv hh jq b fi jw jx l jy jz">total_sum = 0</span><span id="45eb" class="ju jv hh jq b fi ka jx l jy jz">for i,j <strong class="jq hi">in</strong> zip(<strong class="jq hi">real_targets</strong>, <strong class="jq hi">predicted_targets</strong>):<br/>    total_sum  += <a class="ae kb" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics" rel="noopener ugc nofollow" target="_blank">sklearn.metrics</a>.<strong class="jq hi">OUR_REQUIRED_METRIC</strong>(i, j)</span><span id="2114" class="ju jv hh jq b fi ka jx l jy jz"><strong class="jq hi"><em class="jo"># Keep on taking the total sum value from each batches of dataloader</em></strong><br/>final_sum = final_sum + total_sum</span><span id="121d" class="ju jv hh jq b fi ka jx l jy jz"><strong class="jq hi"><em class="jo"># taking the average of all sum we obtained</em> REQUIRED_ACCURACY_PERCENTAGE</strong> = final_sum/<strong class="jq hi"><em class="jo">number_of_data_in_dataframe</em></strong></span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/b9e8103180188ff29738ee3344935fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHdY49ob_aW6trmlF8WFVA.jpeg"/></div></div></figure><p id="5b54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们的度量要求所有预测的数组以及所有目标的数组，那么我们需要像这样进行度量评估</p><pre class="jd je jf jg fd jp jq jr js aw jt bi"><span id="63ba" class="ju jv hh jq b fi jw jx l jy jz">all_targets = 0<br/>all_predictions = 0</span><span id="3921" class="ju jv hh jq b fi ka jx l jy jz"><strong class="jq hi"><em class="jo"># for each batch of training and validation do this</em></strong><br/>if batch_index_number &gt; 0:<br/>     all_targets = np.concatenate((all_targets, <strong class="jq hi">real_targets</strong>), axis=0)<br/>     all_predictions = np.concatenate((all_predictions, <strong class="jq hi">predicted_targets</strong>), axis=0)</span><span id="3cb1" class="ju jv hh jq b fi ka jx l jy jz">else:<br/>     all_targets = <strong class="jq hi">real_targets</strong><br/>     all_predictions = <strong class="jq hi">predicted_targets</strong></span><span id="3b3f" class="ju jv hh jq b fi ka jx l jy jz"><strong class="jq hi"># finally calculating the value of evaluation metric like this <em class="jo">REQUIRED_ACCURACY_PERCENTAGE</em> = </strong><a class="ae kb" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics" rel="noopener ugc nofollow" target="_blank">sklearn.metrics</a>.<strong class="jq hi">OUR_REQUIRED_METRIC</strong>(all_targets, all_predictions)</span></pre><p id="19ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">阅读这里写的每一行代码前的注释，以便更好地理解。如果你对这篇文章还有任何问题，那么不要忘记在下面的评论中提问，在此之前祝你学习愉快。</p></div></div>    
</body>
</html>