<html>
<head>
<title>A Step-by-Step guide to build simple Neural network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建简单神经网络的分步指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/learn-deep-learning-by-building-one-d178f933623d?source=collection_archive---------15-----------------------#2019-10-01">https://medium.com/analytics-vidhya/learn-deep-learning-by-building-one-d178f933623d?source=collection_archive---------15-----------------------#2019-10-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c92d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">弄清楚神经网络如何工作的最快方法是建立一个神经网络。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e1d620d759b58a5896b27b408801622c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mebMZOC25kh_y0Kj2h7xXg.jpeg"/></div></div></figure><p id="0b0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你在这里是因为，和我一样，你对深度学习的兴起感到兴奋。此外，你想知道深度学习是如何工作的——它们背后的本质进步。</p><p id="d262" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，学习深度学习并不简单——然而它需要一些投资来掌握这门学科。我走过密密麻麻的视频，寻找可穿透的教学活动，琢磨如何完成两三个模型。</p><p id="8d93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对我来说，学习是方便的信息。亲身参与主题可以改变你的洞察力。如果你也这样做，在这篇文章结束时，你将会有一个有效的深度学习模型，并能很好地理解它们是如何工作的。</p><h1 id="95c0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">背景</h1><p id="3eca" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">理解深度学习如何运作的根本举措是理解重要术语之间的复杂性。</p><p id="1f26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="ks">【AI】</em></strong>人工智能是机器，尤其是计算机系统对人类智能形式的再造。这些程序包括学习、思考和自我纠正。</p><p id="9ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ks">机器学习</em> </strong>是人工智能的一种应用，是在没有明确编程的情况下让计算机行动的研究。</p><p id="e26a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ks">深度学习</em> </strong>是一类机器学习算法，它使用许多层来不断地从原始输入中提取更重要的层次高光。</p><p id="6971" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ks">神经网络</em> </strong>是一系列算法，试图通过反映人类思维工作方式的程序来感知大量信息中的隐藏联系。</p><h1 id="9fcd" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">神经网络是如何工作的？</h1><p id="05ef" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">神经网络的工作方式类似于人脑。<em class="ks">神经网络中的神经元</em>是一段按照指定架构协同工作的数学信息。神经网络具有一系列层，这些层具有互连的节点。节点，也称为神经元或感知器，是一个计算单元，至少有一个加权输入信息，一个以某种方式组合输入的传递函数，以及一个输出连接。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/8877d9a0ec989904c6a990a19ca8e595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3fA77_mLNiJTSgZFhYnU0Q.png"/></div></div></figure><p id="e38a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经网络中包含的层类型如下:</p><ol class=""><li id="4582" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated"><strong class="ih hj">输入层:</strong>输入信息，也称为可见层。</li><li id="7666" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">隐藏层:</strong>输入层和输出层之间的节点层。深度学习中的<em class="ks">深</em>暗指有不止一个隐藏层。</li><li id="d9e8" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><strong class="ih hj">输出层:</strong>产生输出信息的层。</li></ol><h1 id="f411" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">开始之前…</h1><p id="3d41" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated"><em class="ks">先决条件，</em>你应该能熟练读写一个基本的python程序，稳定的互联网连接(编程是在基于云的平台上完成的，即<a class="ae li" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google colab </a>)和一些python库(即Keras，TensorFlow，matplotlib)。</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="3daf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们通过一句“你好，世界！”来学习基本的编程语言举例。同样，我们应该从深度学习的Hello World开始学习，使用手写数字的MNIST数据集。</p><p id="f467" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MNIST数据库包含60，000幅训练图像和10，000幅包含手写数字(0-9)的测试图像。此外，来自NIST的黑白图像被归一化以适合28x28像素的边界框，并进行抗锯齿处理，这引入了灰度级。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/372519b788affe3cf0e8f140512f48bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*bjNx-NkDIKYaRi3mXALJ9w.jpeg"/></div></figure><h1 id="69ec" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">构建神经网络</h1><p id="fb0e" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在你喜欢的浏览器上，我个人更喜欢Chrome。打开<em class="ks"/><a class="ae li" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"><em class="ks">Google Colab</em></a><em class="ks">，</em>新建一个Python 3+文件，名为<em class="ks">handled _ digit . py .</em>万一迷路了，可以参考<a class="ae li" href="https://colab.research.google.com/drive/12rCxNaCBHqO2wEnYZ2dSjm0KZAdInpnL" rel="noopener ugc nofollow" target="_blank">源代码</a>。</p><p id="38e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">导入库</strong></p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="9b37" class="lw jq hi ls b fi lx ly l lz ma">import tensorflow as tf<br/>import matplotlib.pyplot as plt</span></pre><p id="6b30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">下载数据集</strong></p><p id="1f7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实上，Keras允许我们直接从API下载数据集，具体做法如下:</p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="0f6f" class="lw jq hi ls b fi lx ly l lz ma">mnist = tf.keras.datasets.mnist<br/>(x_train, y_train), (x_test, y_test) = mnist.load_data()</span><span id="ab12" class="lw jq hi ls b fi mb ly l lz ma"><strong class="ls hj">Output</strong>:<br/>Using TensorFlow backend.<br/>Downloading data from <a class="ae li" href="https://s3.amazonaws.com/img-datasets/mnist.npz" rel="noopener ugc nofollow" target="_blank">https://s3.amazonaws.com/img-datasets/mnist.npz</a><br/>11493376/11490434 [==============================] — 4s 0us/step</span></pre><p id="e71e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您运行以下命令:</p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="a431" class="lw jq hi ls b fi lx ly l lz ma">x_train.shape<br/>x_test.shape</span><span id="03cb" class="lw jq hi ls b fi mb ly l lz ma"><strong class="ls hj">Output</strong>:<br/>(60000, 28, 28)<br/>(10000, 28, 28)</span></pre><p id="ed81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们之前讨论的，训练和测试分别有60000和10000幅图像。</p><p id="bee7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">绘制数据集</strong></p><p id="b793" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们想象一下数据库中的一幅图像:</p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="cd1e" class="lw jq hi ls b fi lx ly l lz ma">plt.subplot(221)<br/>plt.imshow(x_train[0], cmap=plt.get_cmap('gray'))<br/># show the plot<br/>plt.show()</span></pre><p id="77de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/a7202e8bbea92c78085ced7c9eefc7e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*DYOs7-e2WbQBqoiqinBsgw.png"/></div></figure><p id="17a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">图像的标准化</strong></p><p id="0f85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为所有的图像都是灰度的，所以每个像素值可以是0-255之间的任何值。如果你想在0-1之间减少，那么这将有助于神经网络运行得更快。这被称为正常化。</p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="b1de" class="lw jq hi ls b fi lx ly l lz ma"># normalize inputs from 0-255 to 0-1<br/>x_train, x_test = x_train / 255.0, x_test / 255.0</span></pre><p id="4ff5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">定义模型</strong></p><p id="4d71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先用下面的语法定义一个顺序模型。现在，只需使用。add()函数如下所示:</p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="70ed" class="lw jq hi ls b fi lx ly l lz ma">model = tf.keras.models.Sequential([<br/>tf.keras.layers.Flatten(input_shape=(28, 28)),<br/>tf.keras.layers.Dense(512, activation=tf.nn.relu),<br/>tf.keras.layers.Dense(256, activation=tf.nn.relu),<br/>tf.keras.layers.Dense(128, activation=tf.nn.relu),<br/>tf.keras.layers.Dense(10, activation=tf.nn.softmax)<br/>])<br/>model.summary()</span><span id="7bf3" class="lw jq hi ls b fi mb ly l lz ma"><strong class="ls hj">Output</strong>:</span><span id="3ba7" class="lw jq hi ls b fi mb ly l lz ma">Model: "sequential_1" _________________________________________________________________ Layer (type)                 Output Shape              Param #    ================================================================= flatten_1 (Flatten)          (None, 784)               0          _________________________________________________________________ dense_2 (Dense)              (None, 512)               401920     _________________________________________________________________ dense_3 (Dense)              (None, 256)               131328     _________________________________________________________________ dense_4 (Dense)              (None, 128)               32896      _________________________________________________________________ dense_5 (Dense)              (None, 10)                1290       ================================================================= Total params: 567,434 Trainable params: 567,434 Non-trainable params: 0</span></pre><p id="1071" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型训练</strong></p><p id="935e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以拟合和评估模型。该模型在10个时期内进行了更新。测试数据用作验证数据集，允许您在模型训练时查看模型的技能。本文不讨论优化器和损失函数。</p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="7987" class="lw jq hi ls b fi lx ly l lz ma">model.compile(optimizer='adam',<br/>              loss='sparse_categorical_crossentropy',<br/>              metrics=['accuracy'])</span><span id="2f18" class="lw jq hi ls b fi mb ly l lz ma">model.fit(x_train, y_train, epochs=10, validation_data=[x_test, y_test])</span><span id="4250" class="lw jq hi ls b fi mb ly l lz ma">scores = model.evaluate(x_test, y_test, verbose=0)<br/>print("Baseline Error: %.2f%%" % (100-scores[1]*100))</span><span id="947d" class="lw jq hi ls b fi mb ly l lz ma">Output:<br/>Train on 60000 samples, validate on 10000 samples<br/>Epoch 1/10<br/>60000/60000 [==============================] - 7s 114us/sample - loss: 0.0200 - acc: 0.9932 - val_loss: 0.0713 - val_acc: 0.9827<br/>Epoch 2/10<br/>60000/60000 [==============================] - 7s 111us/sample - loss: 0.0132 - acc: 0.9954 - val_loss: 0.0907 - val_acc: 0.9776<br/>Epoch 3/10<br/>60000/60000 [==============================] - 7s 110us/sample - loss: 0.0126 - acc: 0.9956 - val_loss: 0.0816 - val_acc: 0.9815<br/>Epoch 4/10<br/>60000/60000 [==============================] - 6s 107us/sample - loss: 0.0093 - acc: 0.9966 - val_loss: 0.0859 - val_acc: 0.9807<br/>Epoch 5/10<br/>60000/60000 [==============================] - 7s 114us/sample - loss: 0.0099 - acc: 0.9969 - val_loss: 0.1007 - val_acc: 0.9796<br/>Epoch 6/10<br/>60000/60000 [==============================] - 7s 115us/sample - loss: 0.0090 - acc: 0.9969 - val_loss: 0.0977 - val_acc: 0.9784<br/>Epoch 7/10<br/>60000/60000 [==============================] - 7s 113us/sample - loss: 0.0091 - acc: 0.9970 - val_loss: 0.0898 - val_acc: 0.9820<br/>Epoch 8/10<br/>60000/60000 [==============================] - 7s 113us/sample - loss: 0.0057 - acc: 0.9982 - val_loss: 0.0944 - val_acc: 0.9801<br/>Epoch 9/10<br/>60000/60000 [==============================] - 7s 112us/sample - loss: 0.0085 - acc: 0.9973 - val_loss: 0.0952 - val_acc: 0.9818<br/>Epoch 10/10<br/>60000/60000 [==============================] - 7s 110us/sample - loss: 0.0062 - acc: 0.9980 - val_loss: 0.0991 - val_acc: 0.9828<br/>Baseline Error: 1.73%</span><span id="68d9" class="lw jq hi ls b fi mb ly l lz ma">&lt;tensorflow.python.keras.callbacks.History at 0x7f05ee07aeb8&gt;</span></pre><p id="a1cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在CPU上运行该示例可能需要几分钟时间。</p><p id="c116" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">保存模型</strong></p><p id="c76a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以所需的名称将模型保存在所需的路径中，并可用于对真实示例的测试。</p><pre class="je jf jg jh fd lr ls lt lu aw lv bi"><span id="65f9" class="lw jq hi ls b fi lx ly l lz ma">model.save('handwritten_digit.h5')</span></pre><p id="7377" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更重要的是，那是一个总结…去找几个同伴一起帮助测试你的深度学习知识。</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="1424" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我相信这促使你去做一些新的东西。我对神经网络很着迷，因为我认为深度学习将很快改变我们考虑计算机视觉、语音识别、自然语言处理、音频识别、社交网络过滤等更多问题的方式。</p><p id="358c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章，如果对你来说都一样，给我几个掌声，让更多的人看到它。非常感谢！</p></div></div>    
</body>
</html>