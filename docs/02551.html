<html>
<head>
<title>MPST: Movie Plot Synopsis with Tags</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MPST:带标签的电影剧情简介</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mpst-movie-plot-synopses-with-tags-ff9abcf1b8ec?source=collection_archive---------14-----------------------#2019-12-22">https://medium.com/analytics-vidhya/mpst-movie-plot-synopses-with-tags-ff9abcf1b8ec?source=collection_archive---------14-----------------------#2019-12-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/11c98adcf4921b7b3941dc6d8a5505b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d6rfnOfh2Afubot5oshamA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">电影标签</figcaption></figure><p id="8e5d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">大家好，在这里我们可以看到如何处理一个多类分类问题。为此，我们将使用来自kaggle competitions的名为MPST的数据集，该数据集在进入细节之前，根据电影大纲预测电影标签。首先，看一下数据，我会给你有助于你练习的数据源链接，<a class="ae js" href="https://www.kaggle.com/cryptexcode/mpst-movie-plot-synopses-with-tags" rel="noopener ugc nofollow" target="_blank">点击这里</a>查看数据源。</p><p id="2c84" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">看到这些数据，我们会想到几个问题，比如……，“如何处理这个问题...?"，“必须使用哪种机器学习算法...?"，“必须使用哪个指标...?"如果你是机器学习的新手，你肯定会想到这些问题，这是我的建议当你试图用你的数据做些什么时，首先研究关于数据集的研究论文开始案例研究是一个非常好的习惯<a class="ae js" href="https://www.aclweb.org/anthology/L18-1274" rel="noopener ugc nofollow" target="_blank">点击这里</a>下载数据集MPST的研究论文。</p><p id="3074" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我希望您阅读上述研究论文，如果没有，请阅读该论文。相信我，这非常重要，因为我个人的经验，当我开始这个案例研究时，我忽略了阅读研究论文并应用了许多算法，花了很多天才找到哪个算法是合适的，在阅读研究论文后，我获得了许多信息。</p><p id="4518" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们深入我们的案例研究<strong class="iw hj"> MPST带标签的电影剧情简介</strong>这个案例研究基本上是借助电影剧情简介(电影的短篇故事或电影的概要)来预测电影标签。</p><p id="7557" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们来看看，<strong class="iw hj"> EDA(探索性数据分析)</strong>还有看了mpst__data.csv之后数据是什么样子的。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/7e9edcc3f54ec1e0ea7629775e3f3be4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8HfABsImp2Qg5r6l_UaCHg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">mpst__data.csv</figcaption></figure><p id="5536" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们将在清理数据(如检查NaN值和删除重复条目)后看到一些关于标记功能的数据分析，我将在本博客的结尾分享完整的代码文档，以便您可以从中进行检查:)</p><blockquote class="jy jz ka"><p id="0641" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated"><strong class="iw hj">标签特征分析:</strong></p></blockquote><p id="49c1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">检查下面每部电影的标签数量，我们可以看到每部电影的标签数量。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/b3337d80101ce6ed15b9eac50c18e92c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8VZT7D00fzrbphP8aoABA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">每部电影的标签数</figcaption></figure><p id="e04a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">检查每部电影的最大、最小和平均标签数。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kg"><img src="../Images/edd9ef9839a22a783c07bf9b3b39c0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*xG0Ca_LMIHB5BRgu3_-xTQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">标签分析</figcaption></figure><p id="271f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们在单词云权重可视化中看到一些独特的标签(这意味着我们可以通过查看单词在单词云中的大小来查看最常出现的标签，大小越大，权重越大，这意味着最常出现的标签)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/a486bf7e0a165429e36c2d6b81f426d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ov_g44HysuDzk6dHLzPLAw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">如果我们观察上面的词云，最常见的5个标签是谋杀，暴力，闪回，浪漫，邪教</figcaption></figure><p id="a362" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们看看频率格式。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/ed29fa6c63a0baf2f361e1e2ece114ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*1lmkqy2E0BEhQ43Hvlw8oA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">如果我们观察上面的词云，我们会得到同样的结果，前5个标签是谋杀，暴力，闪回，浪漫，邪教。</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/816bbe4823e65db829f2d5877ba1a7cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*yVOpAqi7RvPiwCa-qN4pvw.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">你如何知道这些步骤来实现这样的分析</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/11f64d15217a3d733cf7c77cb4c7dc40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XT1P8WOJ2qN038o1bVzsBg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">通过实践:从这个开始，尝试类似的数据集，并应用你从这个博客中学到的东西</figcaption></figure><p id="df0c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">是的，如果你是机器学习的新手，你可能会想到他是如何知道所有这些步骤的，我从以前的作业中学到了所有这些东西，这些都在我的课程中。从那次经历中，我学到了所有这些东西，并应用在这个案例研究中。</p><blockquote class="jy jz ka"><p id="054b" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated">数据预处理和矢量化；</p></blockquote><p id="4826" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在让我们看看数据预处理，在此之前，我们如何选择特征为X，我们已经知道<strong class="iw hj"> Y </strong>是<strong class="iw hj">标签</strong>，现在我们如何选择X…？通过查看数据，我们希望基于标题特征来预测电影标签，我们无法预测得那么准确，因为它没有更多信息，因此我们可以选择包含更多信息的plot_synopsis特征，这可以帮助我们更准确地预测标签，因此我们可以选择我们的<strong class="iw hj"> X </strong>作为<strong class="iw hj"> plot_synopsis。</strong></p><p id="1357" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们将在plot_synopsis功能上应用数据预处理和文本到数字的矢量化(BOW、TFIDF、AVGW2V、TFIDFW2V、CHAR-3、CHAR-4)，单击此<a class="ae js" href="https://github.com/satyakrishnapst/Movie_plot_synopsis_tags" rel="noopener ugc nofollow" target="_blank">链接</a>查看代码实现。</p><blockquote class="jy jz ka"><p id="d300" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated">将标签转换为多标签设置:</p></blockquote><p id="fa7a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们已经知道预处理的X特征，现在我们必须将我们的Y类标签准备成one-hot-encoded形式，如下所示:</p><pre class="ju jv jw jx fd kl km kn ko aw kp bi"><span id="658d" class="kq kr hi km b fi ks kt l ku kv"># binary='true' will give a binary vectorizer<br/>vectorizer = CountVectorizer(tokenizer = lambda x: x.split(), binary='true')<br/>multilabel_y = vectorizer.fit_transform(pure_df['pre_pro_tags'])<br/>multilabel_y.shape</span><span id="c443" class="kq kr hi km b fi kw kt l ku kv"># if we observe we have 71 unique tags its look like multi class <br/>(14752, 71)</span></pre><blockquote class="jy jz ka"><p id="65ea" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated">建模:</p></blockquote><p id="57cf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们已经准备好数据，是时候应用模型了。在应用模型之前，查看研究论文，了解它们实现了什么，我们还可以检查“哪种算法和指标适合多类分类”。在研究论文中，我们应用了带有逻辑回归、TFIDF矢量化的<a class="ae js" href="https://scikit-learn.org/stable/modules/generated/sklearn.multiclass.OneVsRestClassifier.html" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">OneVsRestClassifier</strong></a>，以及uni、bi、trigrams、c3、c4特征化等所有TFIDF矢量化工具的组合。</p><pre class="ju jv jw jx fd kl km kn ko aw kp bi"><span id="9df6" class="kq kr hi km b fi ks kt l ku kv">alpha = [0.001,0.01,0.1,0.5,0.9,1,1.5,10,100,1000]<br/>#penalty = ['l1','l2']</span><span id="d8d3" class="kq kr hi km b fi kw kt l ku kv">params  = {'estimator__C': alpha}<br/>clf_estimator_6 = OneVsRestClassifier(LogisticRegression(class_weight='balanced',penalty='l2',n_jobs=-1),n_jobs=-1)</span><span id="7226" class="kq kr hi km b fi kw kt l ku kv">#we using RandomizedSearchCV for hyper parameter tuning<br/>RS_clf_6 = RandomizedSearchCV(estimator=clf_estimator_6, param_distributions=params, n_iter=10, cv=5, scoring='f1_micro', n_jobs=-1,verbose=10)<br/>RS_clf_6.fit(x_train_uni_bi_tri, y_train_6)<br/>print('Best estimator: ',RS_clf_6.best_estimator_)<br/>print('Best Cross Validation Score: ',RS_clf_6.best_score_</span></pre><p id="f687" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">取而代之的是应用所有的矢量化&amp;算法。我们正在尝试研究论文的实现。根据研究论文，我们使用逻辑回归和OnevsRest。因为这是一个多类分类，我们坚持使用F1分数作为损失度量的TFIDF矢量化，这适用于多类分类。通过应用所有这些，我们将得到如下结果。</p><blockquote class="jy jz ka"><p id="095c" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated">结果:</p></blockquote><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/e4159fd75efb9d98bb9749d7cb56fbb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DyiQfqQkk9ZgYV60F9OYCg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">结果接近研究论文0.37，为最高F1分</figcaption></figure><p id="4bb9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们还可以应用其他因子分解，如<a class="ae js" href="https://www.machinelearningplus.com/nlp/topic-modeling-gensim-python/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> LDA主题建模</strong> </a>，但结果不会符合我们的预期。</p><blockquote class="jy jz ka"><p id="6a92" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated">对前3名和前5名标签应用模型:</p></blockquote><p id="913a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">与其预测每部电影的所有标签，不如我们预测前3或前5个标签…！我们已经在标签数据分析中看到，大部分电影都有3-5个标签</p><pre class="ju jv jw jx fd kl km kn ko aw kp bi"><span id="57d8" class="kq kr hi km b fi ks kt l ku kv">#top-3 tags <br/>#Refer above research paper we first analysis on top 3 tags <br/>vectorizer = CountVectorizer(tokenizer = lambda x: x.split(), binary='true',max_features=3)# simply we pass max_features = 3 or 5 <br/>multilabel_y3 = vectorizer.fit_transform(pure_df['pre_pro_tags'])<br/>multilabel_y3.shape</span><span id="1beb" class="kq kr hi km b fi kw kt l ku kv"># it will return top 3 or 5 features based on max_features value<br/>(14752, 3)</span></pre><blockquote class="jy jz ka"><p id="afd3" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated">让我们看看前3名和前5名的结果:</p></blockquote><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/aa2408a6c0314a8a73e72783c9f25666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*6tqjrW-ujNI2bsvXufYBrA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们得到0.58作为预测前3名标签的最高F1分</figcaption></figure><p id="7bf6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通过简单的矢量化，我们得到了接近研究论文的最佳结果。然而，我们也可以hstack the特征和TFIDF_U_B_T_C3_C4组合特征，我们可以得到0.48作为所有71标签的最高F-1分数。</p><p id="3e4b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">查看我的<a class="ae js" href="https://github.com/satyakrishnapst/Movie_plot_synopsis_tags" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> <em class="kb"> GitHub链接</em> </strong> </a>以获得完整的文档代码，我建议您尝试使用我在<a class="ae js" href="https://www.paperspace.com/" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj"><em class="kb">paper space</em></strong></a>GPU中的代码，它们的计算速度更快。</p><p id="0ced" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你有任何疑问，你可以在下面自由评论，我一定会回复你的问题:)</p><p id="abff" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我希望你们喜欢我的解释方式。</p><p id="bf35" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">继续爱ML:)</p><p id="496e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">谢谢你。</p><blockquote class="jy jz ka"><p id="4335" class="iu iv kb iw b ix iy iz ja jb jc jd je kc jg jh ji kd jk jl jm ke jo jp jq jr hb bi translated"><strong class="iw hj">参考文献:</strong></p></blockquote><ol class=""><li id="1a6f" class="kz la hi iw b ix iy jb jc jf lb jj lc jn ld jr le lf lg lh bi translated">https://www.appliedaicourse.com/</li><li id="af53" class="kz la hi iw b ix li jb lj jf lk jj ll jn lm jr le lf lg lh bi translated"><a class="ae js" href="https://www.aclweb.org/anthology/L18-1274/" rel="noopener ugc nofollow" target="_blank">https://www.aclweb.org/anthology/L18-1274/</a></li><li id="e44d" class="kz la hi iw b ix li jb lj jf lk jj ll jn lm jr le lf lg lh bi translated"><a class="ae js" href="https://www.machinelearningplus.com/nlp/topic-modeling-gensim-python/" rel="noopener ugc nofollow" target="_blank">https://www . machine learning plus . com/NLP/topic-modeling-gensim-python/</a></li><li id="b377" class="kz la hi iw b ix li jb lj jf lk jj ll jn lm jr le lf lg lh bi translated"><a class="ae js" href="https://stackoverflow.com/questions/49856775/understanding-character-level-feature-extraction-using-tfidfvectorizer" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/49856775/understanding-character-level-feature-extraction-using-tfidfvectorizer</a></li></ol></div></div>    
</body>
</html>