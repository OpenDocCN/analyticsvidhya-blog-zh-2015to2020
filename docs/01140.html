<html>
<head>
<title>Online Shoppers Purchasing Intention using Random Forest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用随机森林的网上购物者购买意愿</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ospi-mul-randomforests-156acdb73fd9?source=collection_archive---------9-----------------------#2019-10-03">https://medium.com/analytics-vidhya/ospi-mul-randomforests-156acdb73fd9?source=collection_archive---------9-----------------------#2019-10-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="474f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">具有功能分割的多个随机森林| sklearn</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/136427136bd987c68514b31342fe9835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DowEYkpaEIP5vwyee1Xxug.png"/></div></div></figure><p id="cce3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通过观察在线购物者在所考虑的在线平台上的行为(通常是在购物网站上的行为)来预测他们的购买兴趣是一个有趣的话题。另外，如果你对机器学习(ML)感兴趣，这是一个很好的话题来探索和实践你的ML知识。在本文中，我们将主要关注我们使用的模型和一些技巧来提高交叉验证的准确性。这是我们发表的系列文章的第二篇，在第一篇文章中，我们讨论了与我们使用的数据集相关的预处理和特征工程。请随意点击<a class="ae kf" rel="noopener" href="/@minikiraniamayadharmasiri/preprocessing-data-for-predicting-online-shoppers-purchasing-intention-ml-ba78186b7e85">链接</a>查看。</p><p id="08a9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">你需要什么？</strong></p><p id="c366" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">太简单了。您将需要一个jupyter笔记本，并导入以下库。</p><ol class=""><li id="f95b" class="kg kh hi jl b jm jn jp jq js ki jw kj ka kk ke kl km kn ko bi translated">Numpy</li><li id="2dab" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">熊猫</li><li id="78eb" class="kg kh hi jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">Sklearn</li></ol><p id="ad8f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">除此之外，通过点击<a class="ae kf" href="https://www.kaggle.com/roshansharma/online-shoppers-intention" rel="noopener ugc nofollow" target="_blank">链接</a>下载数据集，并通过上面的链接阅读我们的第一篇文章。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ku"><img src="../Images/d4bb81e8bd24ca55ac0398e9e9c3a572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*THvfqEIRx3WJENdFiE2FtQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">将必要的库导入jupyter-notebook</figcaption></figure></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><p id="feae" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通常，我们的做法是从逻辑回归开始，看看它如何在数据集上工作。在这种情况下，我们能够在测试集上获得0.781的准确度。然后，我们在sklearn-python的帮助下尝试了一个SVM，我们能够获得0.891的精度。然而，在初始阶段，即使使用随机森林或神经网络，我们也无法获得超过0.900的精度。</p><p id="31f8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">为什么精度不超过0.900？</strong></p><p id="d436" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">当我们观察训练数据集时，我们清楚地发现数据集偏向于“0”收入。这实际上会影响我们用来训练和预测的任何模型。最大的问题是，尽管所有的模型都有较高的预测“0”收入的准确性，但预测“1”收入的准确性却非常低。事实上，当我们计算类的精确度时，这是非常清楚的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lg"><img src="../Images/91b456613a108fb3d6620c1a79c4988e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nAUASVVgqtkcpJqufiROVg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">随机森林分类器的分类精度</figcaption></figure><p id="7f7e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为了迎合这种情况，最初的步骤是对训练数据集进行过采样，并在收入中创建平衡。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lh"><img src="../Images/80d9866fbf1c8d7b56d0fa148b5c3977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CW0hYEyTkOwTPrm8cNIR0g.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">使用sklearn - SMOTE进行过采样</figcaption></figure><div class="iy iz ja jb fd ab cb"><figure class="li jc lj lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/b29602259191d02a84d7fdba1fa4636d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*zrHVPajhqhCwzttL6D72bg.png"/></div></figure><figure class="li jc lo lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/95faeb9018330ccb2ef6353f9be31417.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*sfKn5zutVCptNwHOz23V4Q.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx lp di lq lr translated">过采样前后的收入</figcaption></figure></div><p id="33b7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">即使在过采样之后，精度也没有提高到预期水平。所以我们不得不尝试不同的方法来提高精确度。</p><p id="1cbf" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">具有特征分割的多个随机森林</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/2d2af7e23117fc2cdefd0fe403b213de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3amOR1Zc42_F9gzwzL8VA.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">使用sklearn的randomforest分类器示例</figcaption></figure><p id="037f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在我们尝试的所有模型中，random forest能够在测试数据上提供最高的交叉验证准确性。因此，动机是使用多个随机森林，并通过将特征分成组来训练它们，我们认为这将提高交叉验证的准确性。在这种情况下，我们使用了两个随机森林分类器，并用不同的特征集训练它们。接下来使用这两个随机森林的结果和所有初始特征，训练另一个随机森林以获得最终结果。总共有三个随机森林一起工作来预测收入。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lt"><img src="../Images/36d8c8c3cb7e78a09bb15bc996cd98b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3IQ_GkXIBeO8OJPbCfkEGQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">模型的框图</figcaption></figure><p id="ed4f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">但是，将两个随机森林的要素分成两组是至关重要的。总共有14个特征，如果两个随机森林被提供了所有的特征而没有分裂，那么这两个随机森林的结果将是相同的。那么使用两个随机森林的意图就不满足了。因此，将特征分成两组，并分别训练前两个随机森林。当我们观察前两个随机森林的结果时，我们能够如预期的那样识别两个分类器的结果中的细微差异。</p><div class="iy iz ja jb fd ab cb"><figure class="li jc lu lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/3ff28aa36c0a2a0b5155a0d84cfbb808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*1kvh3wxb4Rd4YQIYP1FQiw.png"/></div></figure><figure class="li jc lv lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/25f43715f49e67f13a227ec98ea736a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*aNsqVhJxjv6fkRvrSyOj_A.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx lw di lx lr translated">前两个随机森林的分类报告</figcaption></figure></div><p id="3b4c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">下一步是将这两个预测结果与初始输入特征结合起来，并训练第三个也是最后一个分类器以获得最终结果。在这一步中，我们希望第三个模型通过考虑所有特征，以更符合逻辑的方式合并前两个模型的预测，并给出最终预测。正如预期的那样，第三个分类器的准确性提高了，这证明了我们最初的假设是正确的！</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ly"><img src="../Images/eae961c0af647b9a539a881b40e0ec3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*v1vXX_VDxwCaVmn2t2O3sw.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">最终随机森林分类报告</figcaption></figure><p id="c630" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">为什么在某些情况下，具有特征分裂的多个随机森林更好？</strong></p><p id="5a8a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">尽管在大多数情况下，一个随机森林就足够了，但在某些情况下，多个随机森林可能有助于提高准确性。如果您的要素可以清楚地识别为两个或多个独立的集合，那么使用带有要素分割的多个随机森林可能会改善您的结果。通过考虑标注的相关性来分割要素也是一种很好的做法，但是要小心，这可能会导致过度拟合。然而，最好的方法是通过考虑它们在该领域的技术意义来分割特征。</p><p id="0329" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">访问我们的GitHub <a class="ae kf" href="https://github.com/Isuru-Dissanayake/OSPI-kaggle" rel="noopener ugc nofollow" target="_blank">库</a>获取代码和更多细节。</p></div></div>    
</body>
</html>