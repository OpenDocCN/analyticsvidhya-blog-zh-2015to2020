<html>
<head>
<title>Visualising Embeddings with t-SNE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用t-SNE可视化嵌入</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/visualising-embeddings-with-t-sne-b54bf6b635f?source=collection_archive---------6-----------------------#2020-11-02">https://medium.com/analytics-vidhya/visualising-embeddings-with-t-sne-b54bf6b635f?source=collection_archive---------6-----------------------#2020-11-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9195" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博文中，我们将可视化视频游戏的嵌入(基于Steam的数据)。)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/8e23813c4cd753d609bcdff7c920b679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*072t5pvRhyFioCvM"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@everywheresean?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sean Do </a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6fc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将从以下与Steam电脑游戏相关的数据帧开始。这里,<code class="du ju jv jw jx b">uid</code>代表唯一的用户id,<code class="du ju jv jw jx b">id</code>代表唯一的游戏id。我们有超过400万行，每行代表一个<code class="du ju jv jw jx b">uid/id</code>关系(即拥有游戏<code class="du ju jv jw jx b">id</code>的用户<code class="du ju jv jw jx b">uid</code>)。要查看导致这一阶段的预处理步骤，请查看我的GitHub上的完整项目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jy"><img src="../Images/087171c4938015c8a7dc95781dc8820a.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*AxME4796LH4fmHJ1b2L_GQ.png"/></div></figure><p id="f4fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们转换这个数据帧，将每个游戏id作为一列，将用户作为行，创建一个交互矩阵，然后我们可以将它输入到模型中。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jz"><img src="../Images/272b29f7dc372f23c407aadd48e53688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bGqD2rgmDFlmPSquyH7Qbw.png"/></div></div></figure><p id="83bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用LightFM库来生成推荐和检索嵌入。文档详细介绍了该模型的工作原理。我们可以选择模型应该学习的组件数量(即潜在空间的维度)。我们改变了这个超参数，发现它对整体模型性能几乎没有影响，因此将其保留在<code class="du ju jv jw jx b">30.</code></p><p id="5ecb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们提取嵌入，如下所示。</p><pre class="je jf jg jh fd ka jx kb kc aw kd bi"><span id="193e" class="ke kf hi jx b fi kg kh l ki kj"># Get embeddings<br/>embeddings = mf_model.item_embeddings</span></pre><p id="5abc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们研究一个样本嵌入。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/dbc025fcb6fb782bd33c5cb1573d35f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTT8U6C_DunZoFgPHxCsaQ.png"/></div></div></figure><p id="33e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了检索游戏的名称，我们首先使用交互矩阵查找游戏id，然后使用我们之前创建的字典获取名称，该字典将id映射到标题名称。</p><pre class="je jf jg jh fd ka jx kb kc aw kd bi"><span id="c798" class="ke kf hi jx b fi kg kh l ki kj">firstgameid = interactions.columns[0]<br/>games_dict[firstgameid]</span></pre><p id="45df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在将使用t-SNE算法来可视化嵌入，从30维空间(组件数量)到2维空间。t-SNE用于降维，因为它学习从高维向量空间到较低维空间的映射，其中如果向量<code class="du ju jv jw jx b">u</code>和<code class="du ju jv jw jx b">v</code>彼此接近，则它们在较低维空间中的相应映射也将彼此接近。</p><p id="168e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们导入t-SNE并实例化它。</p><pre class="je jf jg jh fd ka jx kb kc aw kd bi"><span id="f37a" class="ke kf hi jx b fi kg kh l ki kj">from sklearn.manifold import TSNE</span><span id="1f0b" class="ke kf hi jx b fi kl kh l ki kj"># Instantialte tsne, specify cosine metric<br/>tsne = TSNE(random_state = 0, n_iter = 1000, metric = 'cosine')</span></pre><p id="46a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们在嵌入矩阵上调用fit和transform。</p><pre class="je jf jg jh fd ka jx kb kc aw kd bi"><span id="9ca7" class="ke kf hi jx b fi kg kh l ki kj"># Fit and transform<br/>embeddings2d = tsne.fit_transform(embeddings)</span></pre><p id="358c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，为了使绘图更容易，我们用结果构建了一个熊猫数据框架。</p><pre class="je jf jg jh fd ka jx kb kc aw kd bi"><span id="a7d9" class="ke kf hi jx b fi kg kh l ki kj"># Create DF<br/>embeddingsdf = pd.DataFrame()</span><span id="1274" class="ke kf hi jx b fi kl kh l ki kj"># Add game names<br/>embeddingsdf['game'] = gameslist</span><span id="3d0d" class="ke kf hi jx b fi kl kh l ki kj"># Add x coordinate<br/>embeddingsdf['x'] = embeddings2d[:,0]</span><span id="788f" class="ke kf hi jx b fi kl kh l ki kj"># Add y coordinate<br/>embeddingsdf['y'] = embeddings2d[:,1]</span><span id="35ff" class="ke kf hi jx b fi kl kh l ki kj"># Check<br/>embeddingsdf.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es km"><img src="../Images/911a834ce24f2b5c3e6d3565455da2cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*dptRQrfkNUIWu4t8XM7dDA.png"/></div></figure><p id="1852" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们绘制二维游戏空间。</p><pre class="je jf jg jh fd ka jx kb kc aw kd bi"><span id="992f" class="ke kf hi jx b fi kg kh l ki kj"># Set figsize<br/>fig, ax = plt.subplots(figsize=(10,8))</span><span id="b46f" class="ke kf hi jx b fi kl kh l ki kj"># Scatter points, set alpha low to make points translucent<br/>ax.scatter(embeddingsdf.x, embeddingsdf.y, alpha=.1)</span><span id="eeb1" class="ke kf hi jx b fi kl kh l ki kj">plt.title('Scatter plot of games using t-SNE')</span><span id="09fb" class="ke kf hi jx b fi kl kh l ki kj">plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kn"><img src="../Images/8a0ab0184df83120376db24fe3e7d331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*MWUJqfn4mEC7abHWVLxI3w.png"/></div></figure><p id="1d35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过查看我们认为相似的游戏在哪里来检查情节是否“起作用”。我们来看看<code class="du ju jv jw jx b">RollerCoaster Tycoon</code>游戏在剧情上的位置。</p><pre class="je jf jg jh fd ka jx kb kc aw kd bi"><span id="7256" class="ke kf hi jx b fi kg kh l ki kj">match = embeddingsdf[embeddingsdf.game.str.contains('RollerCoaster')]</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/31c9272ea4f57c210a10617fc15b60ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YmqhVQb8sDg185VGQXdwmw.png"/></div></div></figure><p id="1030" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所见,《过山车大亨世界》与其他游戏“不同”,因为用户对它的反应不同。</p><p id="67a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是他们的计划:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kn"><img src="../Images/a869ed867b14a8710fd7a5c44babe10d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*gBdahNPGFUqCNBPsBePA7Q.png"/></div></figure><p id="8ba7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种见解对利益相关者很有用，因为如果没有数据和嵌入，人们会认为所有过山车大亨游戏都是相似的。</p><p id="0707" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从额外的研究来看，很明显《过山车大亨世界》失败了，普通用户和评论家的评价都很差，他们抱怨图像和bug。</p><p id="6c5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这些知识，当向一个过山车大亨游戏推荐类似的物品时，我们会建议避免过山车大亨世界。</p><p id="9643" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们注意到在顶部中间有一些游戏，这很有趣。这些游戏与众不同的地方在哪里？未完待续…</p></div></div>    
</body>
</html>