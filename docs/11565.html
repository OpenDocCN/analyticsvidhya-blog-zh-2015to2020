<html>
<head>
<title>Market Analysis and Data Cleaning with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 进行市场分析和数据清理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/market-analysis-and-data-cleaning-with-python-1e22930cc081?source=collection_archive---------6-----------------------#2020-12-09">https://medium.com/analytics-vidhya/market-analysis-and-data-cleaning-with-python-1e22930cc081?source=collection_archive---------6-----------------------#2020-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d193" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，您将了解如何从 Excel 或 CSV 文件导入和清理数据，以及如何使用 Python 可视化市场数据的一些基本步骤。</p><p id="9f8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我想指出在分析股票和提取信息时需要记住的两个要点。第一个你可能已经听说过，那就是数据的质量决定了你的好坏。如果您提取的数据很容易访问，您应该假设许多其他人正在使用相同的信息。第二，你 90%的时间将用于清理和理解行和列是如何格式化的。</p><p id="f7a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">导入&amp;将 CSV 读取为熊猫数据帧</strong>:</p><p id="3cbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">了解数据文件在计算机上的位置很重要，这样 python 才能正确无误地读取路径。我喜欢将文件路径复制并粘贴到我的 IDE 中，而不是键入它。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8297" class="jm jn hi ji b fi jo jp l jq jr">import pandas as pd<br/>from pathlib import Path<br/>%matplotlib inline</span><span id="f904" class="jm jn hi ji b fi js jp l jq jr"># Set the path<br/>file_path = Path('../Resources/sp500_companies.csv')</span><span id="63de" class="jm jn hi ji b fi js jp l jq jr"># Read in the CSV as a DataFrame<br/>sp500_companies_csv = pd.read_csv(file_path)<br/>sp500_companies_csv.head()</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es jt"><img src="../Images/1022923de45a3806b0167335abc8ccf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPeBVj5vUNJhsjc5eAsXrg.png"/></div></div></figure><p id="b171" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将统计 S&amp;P 中每个行业的公司数量，并用饼图表示结果。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2932" class="jm jn hi ji b fi jo jp l jq jr">sector_count = sp500_companies_csv['Sector'].value_counts()</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kb"><img src="../Images/c075b56eb809f042616772717b9b1a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*MUV3_X---7yznKEbQojMeg.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="9072" class="jm jn hi ji b fi jo jp l jq jr"># Plot a pie chart from the distribution of company sectors</span><span id="0a32" class="jm jn hi ji b fi js jp l jq jr">sector_count.plot(kind='pie', figsize=[10,10])</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kc"><img src="../Images/f48b2852d04e3b89c3eaa5a80e3e73fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mv712w0qIhcG4SHEEUsJaQ.png"/></div></div></figure><p id="087f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注:</strong></p><p id="be0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">抓取股票信息的方法有很多。快速简单的方法是去谷歌搜索工作表，在你想要的时间范围内获得每日“收盘”价格。然后保存并下载为 CSV 格式。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="7c50" class="jm jn hi ji b fi jo jp l jq jr"> =GOOGLEFINANCE(“MRNA”,”Close”,”01/02/2015", “12/8/2020”,”DAILY”)</span><span id="b541" class="jm jn hi ji b fi js jp l jq jr">or</span><span id="c8ed" class="jm jn hi ji b fi js jp l jq jr">=GOOGLEFINANCE("INDEXSP:.INX","Close","10/30/2015", "11/30/2020","DAILY")</span></pre><p id="81eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以使用像“yfinance”这样的 API，他们有一个 python 库，你可以在他们的网站上安装和查看文档…我将在未来的文章中更详细地介绍这一点。</p><p id="99c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的链接很好地列出了使用“yfinance”库的步骤。(【https://algotrading101.com/learn/yfinance-guide/】T4)</p><p id="3d8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他流行的 API:</p><ul class=""><li id="2607" class="ke kf hi ih b ii ij im in iq kg iu kh iy ki jc kj kk kl km bi translated">羊驼</li><li id="1f95" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">Quandl</li><li id="36fe" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">量子乌托邦</li><li id="7364" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">格子 SDK</li></ul><p id="17ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回到我们的例子，让我们从我们的 S&amp;P 数据集中过滤前 20 大市值公司的数据。您可以通过使用。loc</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2691" class="jm jn hi ji b fi jo jp l jq jr"># Grab the `Symbol` and `Market Cap` columns<br/>market_cap = sp500_companies_csv.loc[:, ['Symbol', 'Market Cap']]</span><span id="17dd" class="jm jn hi ji b fi js jp l jq jr"># Set the 'Symbol' as the index<br/>market_cap.set_index(market_cap['Symbol'], inplace=True)</span><span id="ce42" class="jm jn hi ji b fi js jp l jq jr"># Drop the extra 'Symbol' column<br/>market_cap.drop(columns=['Symbol'], inplace=True)</span><span id="4c98" class="jm jn hi ji b fi js jp l jq jr"># Filter down to 20 companies with the largest market caps<br/>top_20_market_cap2222 = market_cap.nlargest(20, 'Market Cap')</span><span id="b83d" class="jm jn hi ji b fi js jp l jq jr"># Display the DataFrame<br/>top_20_market_cap</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es ks"><img src="../Images/6ce802eacc0d63a3f676c2add31999a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*Uy-KLVDjzXiBmUz0zadV7Q.png"/></div></figure><p id="2d97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">绘制市值前 20 的公司:</strong></p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0647" class="jm jn hi ji b fi jo jp l jq jr">top_20_market_cap.plot(kind='bar', title='Top 20 Market Cap Companies (in billions)')</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kt"><img src="../Images/5c0645b77f115d0edc2aec7bab9cf828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZvPRF4ztNSKhOMJ-QT9p1A.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="da4c" class="jm jn hi ji b fi jo jp l jq jr"># Plot a scatter plot to display the relationship between price vs. earnings/share</span><span id="3424" class="jm jn hi ji b fi js jp l jq jr">sp500_companies_csv.plot(kind='scatter', x='Earnings/Share', y='Price')</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es ku"><img src="../Images/3cc7dcf232c6f333b515a24cdb9488ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WLIAzKD_BI9d0n06UeshIw.png"/></div></div></figure><p id="1863" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先…</p><p id="5c86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kv">如果你觉得这篇文章有用，欢迎在</em><a class="ae kd" href="https://github.com/scottandersen23/Medium_Blog/tree/main/Articles" rel="noopener ugc nofollow" target="_blank"><em class="kv">GitHub</em></a><em class="kv">上下载我的个人代码。你也可以直接在 scottandersen23@gmail.com 给我发邮件，在</em><a class="ae kd" href="https://www.linkedin.com/in/scott-andersen-3208897b/" rel="noopener ugc nofollow" target="_blank"><em class="kv">LinkedIn</em></a><em class="kv">上找到我。有兴趣了解更多关于数据分析、数据科学和机器学习应用的信息吗？跟我上</em> <a class="ae kd" rel="noopener" href="/@scottandersen23"> <em class="kv">中</em> </a> <em class="kv">。</em></p><p id="255e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>