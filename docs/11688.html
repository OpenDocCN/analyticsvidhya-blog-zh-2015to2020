<html>
<head>
<title>Designing a Machine Learning model and Deploying it using Flask on Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计一个机器学习模型并使用 Flask 在 Heroku 上部署它</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/designing-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-ac94455f38c7?source=collection_archive---------13-----------------------#2020-12-14">https://medium.com/analytics-vidhya/designing-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-ac94455f38c7?source=collection_archive---------13-----------------------#2020-12-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/241343ca23f60dcedc7fdf70266615a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*-kZ5_BjvLjhdGCu7-ja3eQ.jpeg"/></div></figure><p id="aa27" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">模型部署和模型构建一样重要。机器学习模型在生产和消费者积极使用时也是有效的。在本文中，我将训练机器学习模型，使用 Flask 在其上创建 web 应用程序，并使用 Heroku 部署它。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es jk"><img src="../Images/623a44ec7f1cadfd2a602b7296e93abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*hnnHyd3QOI-AHhJRiXnehg.jpeg"/></div></figure><p id="656c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">随机森林是由许多决策树组成的监督机器学习算法。随机森林结合了成百上千的决策树，在样本的不同子集上训练每一个，分裂是在考虑有限特征的情况下完成的。通过平均每棵树的预测来获得最终输出。这个概念是自举。</p><p id="30cb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">数据集=成人人口普查收入数据集。<br/>属性:共有 15 个属性，下面很少给出。<br/>收入:&gt; 50k，≤50k <br/>年龄:连续<br/>工作阶层:私营、自我雇佣非公司、自我雇佣公司、联邦政府、地方政府、州政府、无薪、从未工作过<br/> fnlwgt:连续</p><p id="cf95" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有关属性<a class="ae jp" href="https://archive.ics.uci.edu/ml/datasets/adult" rel="noopener ugc nofollow" target="_blank">的详细信息，请点击此处</a>。</p><p id="8e73" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">预测任务是确定一个人一年的收入是超过 50k 还是更少。</p><h2 id="3e05" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated"><strong class="ak">加载库</strong></h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="a5eb" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">加载数据</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="a8f2" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">检查空值</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="aba3" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">看着这些数据</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="ded8" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">一些特征工程</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="d3cd" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">编码数据</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="1a25" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">相关特征</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/3105888b12dcd7f82978f8b4532c2201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xggzuD34T2Yl6R3agTmujg.png"/></div></div></figure><h2 id="7f52" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">移除相关特征并将数据分为训练和测试</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="7d83" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">拟合模型</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="13c2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这样我们可以达到大约 85%的准确率。我们将保存模型，以便稍后使用 python 中的 pickle 库预测我们的值。</p><p id="eecd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下一步是使用 flask 创建简单的 web 应用程序。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es ks"><img src="../Images/4f8b918c9c9c9c688eeda3ffe77175e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABIxi60p2CC_kx0d_HNAoA.jpeg"/></div></div></figure><p id="e7d2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将创建表单页面来收集人们的数据。该表单将包含不同的选项供每个属性选择。<a class="ae jp" href="https://github.com/nidhi988/Deploying-ML-Algo-using-Flask-on-Heroku/tree/main/templates" rel="noopener ugc nofollow" target="_blank">此处代码</a></p><p id="6f47" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建虚拟环境来运行 flask 脚本。</p><blockquote class="kt ku kv"><p id="442c" class="im in kw io b ip iq ir is it iu iv iw kx iy iz ja ky jc jd je kz jg jh ji jj hb bi translated"><em class="hi"> mkdir 收入<br/> cd 收入<br/>python 3-m venv venv<br/>#激活环境<br/>source venv/bin/activate</em></p></blockquote><p id="40d6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">pip 安装烧瓶</p><p id="5e6e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建包含 html 文件(index.html，result.html)的文件夹“模板”。</p><h2 id="0dd8" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">烧瓶脚本</h2><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><h2 id="bda5" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">运行脚本</h2><blockquote class="kt ku kv"><p id="f27b" class="im in kw io b ip iq ir is it iu iv iw kx iy iz ja ky jc jd je kz jg jh ji jj hb bi translated"><em class="hi">导出 FLASK_APP = script.py <br/>运行 flask </em></p></blockquote><p id="e230" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当提交表单时，使用我们之前创建的 model.pkl 文件预测收入值。</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="2c78" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在创建 web app 之后，我们将使用 heroku 来部署它。</p><h2 id="c8d6" class="jq jr hi bd js jt ju jv jw jx jy jz ka ix kb kc kd jb ke kf kg jf kh ki kj kk bi translated">使用 Heroku 部署 flask 应用程序</h2><p id="99ff" class="pw-post-body-paragraph im in hi io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">Heroku 是一个平台即服务(PaaS ),使开发人员能够在云中构建、运行和操作应用程序。另外，我们需要在系统中安装 git 和 Heroku CLI。去 Heroku 创建你的账户。</p><p id="87eb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将 gunicorn 下载到虚拟环境 venv</p><blockquote class="kt ku kv"><p id="1096" class="im in kw io b ip iq ir is it iu iv iw kx iy iz ja ky jc jd je kz jg jh ji jj hb bi translated"><em class="hi"> pip 安装 gunicorn </em></p></blockquote><p id="0d37" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">初始化 git 存储库，如下面的命令所示。</p><blockquote class="kt ku kv"><p id="2375" class="im in kw io b ip iq ir is it iu iv iw kx iy iz ja ky jc jd je kz jg jh ji jj hb bi translated"><em class="hi"> $git init <br/> $git add。<br/>$ git commit-m‘初始提交’</em></p></blockquote><p id="2e3b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们需要告诉 heroku 项目需要像 flask，gunicorn，sklearn 等库。为此，我们创建需求文本文件。</p><blockquote class="kt ku kv"><p id="1133" class="im in kw io b ip iq ir is it iu iv iw kx iy iz ja ky jc jd je kz jg jh ji jj hb bi translated"><em class="hi"> pip 冻结&gt;需求. txt </em></p></blockquote><p id="1e39" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，在应用程序的根目录中创建 procfile 文本文件，以明确声明应该执行什么命令来启动应用程序。</p><p id="4db0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在项目已经准备好部署了。</p><p id="2335" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">打开终端并执行以下命令—</p><blockquote class="kt ku kv"><p id="754a" class="im in kw io b ip iq ir is it iu iv iw kx iy iz ja ky jc jd je kz jg jh ji jj hb bi translated"><em class="hi"> heroku 登录</em></p></blockquote><p id="b368" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将需要我们之前用来创建 Heroku 帐户的登录凭证。</p><blockquote class="kt ku kv"><p id="f0d2" class="im in kw io b ip iq ir is it iu iv iw kx iy iz ja ky jc jd je kz jg jh ji jj hb bi translated"><em class="hi">#创造英雄 ap <br/>英雄创造<br/>饭桶推英雄主人<br/>英雄开启</em></p></blockquote><p id="570b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将在 heroku 上推送整个应用程序，并在浏览器中打开 url。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><p id="57df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">任务完成！</strong></p><p id="f4bb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">希望我的文章对初学者有意义。</p><p id="ebeb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">谢谢你</p></div></div>    
</body>
</html>