# 什么是 ROC 曲线？

> 原文：<https://medium.com/analytics-vidhya/what-is-roc-curve-1f776103c998?source=collection_archive---------2----------------------->

**在机器学习中，ROC 曲线是一种通过可视化来衡量机器学习模型性能的评估指标，尤其是在数据有偏差的情况下。**让我们看看这到底是什么意思，

考虑由 13 个特征组成的**心脏数据**，如**年龄、性别、胆固醇(胆固醇测量)。**我们的目标是根据上述特征预测一个人是否患有心脏病，这是一个**二元分类问题**。也就是说，只有两个类。让我们假设我们有 100 个样本(一个样本对应于单个患者的信息)，其中 90 个样本是阳性的(患有心脏病)，因此如果你说所有患者(其中 100 人)都患有心脏病，那么你已经正确地对 90/100 个样本进行了分类。你连模型都没建就拿到了 90%的准确率。如果我们仔细观察，我们会发现数据集是偏斜的也就是说，阳性样本的数量远远多于阴性样本(没有心脏病的患者)。因此，仅仅基于准确性来决定最佳模型是不可取的，因为它不能完全代表数据。因此，您可能会获得很高的准确性，但您的模型在处理真实样本时可能不会表现得那么好。因此，我们需要一个更可靠的评估指标，于是 ROC 就出现了。

这里，我们将使用 [SVM(支持向量机)](/swlh/what-is-svm-f4e06eca79b3)作为具有不同伽马值(参数)的模型进行比较，并在 ROC 曲线的帮助下，找出哪个伽马值给出了最佳结果(最佳模型)。我们来详细看看这个。

我们不是预测样本是阳性还是阴性，而是预测每个样本患心脏病的概率，如果这个概率大于阈值，我们就说给定的患者患有心脏病。假设我们选择的阈值为 0.1，那么如果概率大于 0.1，我们就说特定患者患有心脏病。现在，当我们改变阈值时，很明显预测也会改变。例如，如果阈值为 0，我们将预测数据中的每个样本为正(因为概率大于等于 0)。同样，如果我们有一个很高的阈值比如说 0.9，**即使病人有心脏病预测也可能是‘没有心脏病’，这是很有风险的！**因此，我们必须选择一个阈值，不仅要有好的预测，还要权衡利弊。现在我们来总结一下。表 1 显示了将分类器应用于数据时的可能结果，该表也被称为**混淆矩阵**。现在，让我们定义表格中给出的构建 ROC 曲线所需的术语。

![](img/e267ef2f69abba6eb3fc8d1fd46cf444.png)

*来源:* [*理解混淆矩阵并将其应用于 KNN-虹膜数据集上的分类器*](/ai-in-plain-english/understanding-confusion-matrix-and-applying-it-on-knn-classifier-on-iris-dataset-b57f85d05cd8)*Vishwanath Beena 在 medium 上的文章。*

真阳性(TP):给定患者的信息(年龄、性别…值)，如果您的模型预测到心脏病，并且患者实际上患有心脏病，那么它被认为是真阳性。

真阴性(TN):给定患者的信息，如果您的模型预测没有心脏病，并且患者实际上没有心脏病，那么它被认为是真阴性。

简单来说，如果你的模型正确预测了正类，那就是真正，如果你的模型正确预测了负类，那就是真负。

假阳性(FP):给定患者的信息，如果你的模型预测到心脏病，而患者实际上没有心脏病，那么它被认为是假阳性。

假阴性(FN):给定患者的信息，如果你的模型预测没有心脏病，而患者实际上有心脏病，那么它被认为是假阴性。

简单地说，如果你的模型错误地(或错误地)预测了一个正类，那么它就是一个误报。如果您的模型错误地(或错误地)预测了一个负类，那么它就是一个假负类。现在，

TPR/灵敏度定义为:

TP / P

其中 P = TP+FN

TPR 是“被正确识别的心脏病患者的比例”。

FPR/假阳性率定义为:

FP / N

FPR 是“没有心脏病的患者被错误地确定为患有心脏病的比例”。

特异性定义为:

总氮/氮

其中 N = TN+FP

特异性是“被正确识别的无心脏病患者的比例”。

ROC 提供了一种简单的方法来总结与不同阈值以及由此产生的 TPR 和 FPR 值相关的信息。表 2 显示了不同阈值的 TPR 和 FPR 值。

![](img/aded06b530f6e178badd50712d94ec6d.png)

**表 2\.** FPR 和 TPR 值对应不同的阈值，对于 SVMγ等于 0.001

你可能想知道为什么有些阈值是负的？稍后我会解释这一点。现在，不需要为不同的阈值构建不同的表(如表 1)，您可以只查看 ROC 曲线来决定选择什么阈值。大多数情况下，ROC 曲线左上角的值应该给你一个很好的阈值，如图 1 所示，

![](img/9e59dba6fec3569675b486e47cb3984e.png)

**图 1** 。具有γ的 SVM 的 AUC(曲线下面积)等于 0.001。

相应的阈值在表 2 中突出显示。根据您愿意接受的误报数量，您可以决定最佳阈值。例如，如果你不想有太多的误报，你应该有一个很高的阈值。然而，这也会给你更多的假阴性。观察权衡并选择最佳阈值，**通过** **降低阈值，TPR、FPR 的值增加，而特异性降低。**类似地，当我们增加 TPR 阈值时，FPR 降低，但是特异性增加。

AUC 使得更容易将一条 ROC 曲线与另一条进行比较，**曲线下面积越大，模型越好。**

![](img/b770f502a59bc5b6d2f3e966228d90cc.png)

**图 2 .**SVM 不同 gamma 值的 ROC 曲线。指示“无信息分类器”的红线将每个样本分类为“患有心脏病”。

在图 2 中，伽马值为 0.001 的 SVM 的 AUC 为 0.88，伽马值为 0.0001 的 SVM 的 AUC 为 0.76，伽马值为 0.00001 的 SVM 的 AUC 为 0.75。我们说γ等于 0.001 的 SVM 是比其他模型更好的模型，因为 0.88 接近 AUC 的最大值，即 1，AUC 对应于γ等于 0.001 的 SVM。如图 1 所示，我们期望分类器的表现不优于具有 0.5 的 AUC 的机会，那么图 2 中没有信息分类器(红线)预测每个患者为“患有心脏病”，而与实际目标(类别)无关。

你也可以比较其他分类模型，如逻辑回归，KNN 分类器与 SVM。

AUC 是行业中广泛使用的二元分类任务的度量标准，也是每个人都应该知道的度量标准。

**注意**:一般来说，我们使用概率与阈值进行比较。在 SVM 的情况下，计算决策函数值并与阈值进行比较，决策函数值可以是正值或负值，如表 2 所示。但预测是以相同的方式进行的:如果函数值大于阈值，我们将样本分配到阳性类别(预测为“有疾病的患者”)，否则，我们将样本分配到阴性类别(预测为“无疾病的患者”)。

**参考文献**:

1.  《接近(几乎)任何机器学习问题》，Abhishek Thakur 著。
2.  《R 中的统计学习及其应用导论》,作者:Robert Tibshirani，Gareth James，Trevor Hastie，Daniela Witten。