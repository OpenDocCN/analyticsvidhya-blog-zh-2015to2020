<html>
<head>
<title>Python built-in functions: open()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 内置函数:open()</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-built-in-functions-open-24c5e2f433b2?source=collection_archive---------31-----------------------#2020-12-09">https://medium.com/analytics-vidhya/python-built-in-functions-open-24c5e2f433b2?source=collection_archive---------31-----------------------#2020-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="c401" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">Python 中文件处理的入门</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/8cb6e3b13cd43e132d76d08db862714f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/0*phow6m6ud6SS2tIO.jpg"/></div></figure><p id="e5f4" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jn hj"> open() </strong>将打开一个文件并返回一个 file 对象:</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="f256" class="ko ig hi kk b fi kp kq l kr ks">myhandle = open('demo')<br/>print(myhandle.read())</span></pre><p id="d8af" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这返回了一些披头士的歌词:</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="9ca2" class="ko ig hi kk b fi kp kq l kr ks">Yesterday<br/>All my troubles seemed so far away<br/>Now it looks as though they're here to stay</span></pre><p id="46f8" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果您想确定您正在读取文件，请使用“r”模式:</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="ea1a" class="ko ig hi kk b fi kp kq l kr ks">myhandle = open('demo', 'r')<br/>print(myhandle.read())</span></pre><p id="3679" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">事实上，<strong class="jn hj"> open(filename，mode) </strong>是一种公认的编码方式，可以避免别人在阅读你的代码时产生混淆，默认为“r”。</p><p id="6cce" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果你准备好照看你自己的代码块，直接进入文件当然会工作，但是通常使用带有语句的<strong class="jn hj">:</strong></p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="acac" class="ko ig hi kk b fi kp kq l kr ks">with open('demo','r') as my_handle:<br/>    print(my_handle.read())</span></pre><p id="6ef9" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这给出了相同的结果。<strong class="jn hj">与</strong>将在文件块结束时自动关闭文件。如果你想读写现有的文件呢？在模式中添加一个“+”:</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="27df" class="ko ig hi kk b fi kp kq l kr ks">with open('demo', 'r+') as my_handle:<br/>    my_handle.write('\nOh, I believe in yesterday')<br/>    print(my_handle.read())</span></pre><p id="8a82" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">什么？不显示文本？如果你检查“演示”,你会看到文本在那里。python 处理文件位置的方式是使用光标的概念，光标停留在文件最后一次被读写的地方。使用' tell()'找出您的光标在哪里:</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="3320" class="ko ig hi kk b fi kp kq l kr ks">with open('demo','r+') as my_handle:</span><span id="de64" class="ko ig hi kk b fi kt kq l kr ks">    print('cursor is now at:')<br/>    print(my_handle.tell()) <em class="ku"># cursor at the beginning</em><br/>    print(my_handle.read()) <em class="ku"># reads the text and leaves the cursor at the end</em><br/>    print('read text, cursor is now at:')<br/>    print(my_handle.tell()) <em class="ku"># cursor at the end of file</em></span><span id="d50e" class="ko ig hi kk b fi kt kq l kr ks">    my_handle.write('\nOh, I believe in yesterday')<br/>    print('added text, cursor is now at:')<br/>    print(my_handle.tell()) <em class="ku"># writes the above text and leaves the cursor at the end</em></span><span id="cc8a" class="ko ig hi kk b fi kt kq l kr ks">    my_handle.seek(0) <em class="ku"># rewind cursor to beginning</em><br/>    print('rewound cursor, now at:')<br/>    print(my_handle.tell()) <em class="ku"># check where we are</em><br/>    print(my_handle.read()) <em class="ku"># read all the text again</em><br/>    print('just read added text, cursor is now at:')<br/>    print(my_handle.tell()) <em class="ku"># cursor is at the end</em></span><span id="9ef7" class="ko ig hi kk b fi kt kq l kr ks">    my_handle.seek(20) <em class="ku"># demo - place the cursor 20 chars in</em><br/>    print('just moved 20 characters up, now at:')<br/>    print(my_handle.tell()) <em class="ku"># check where the cursor is</em><br/>    print(my_handle.read()) <em class="ku"># read from here</em></span></pre><p id="87af" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这将输出:</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="0f43" class="ko ig hi kk b fi kp kq l kr ks">cursor is now at:<br/>0<br/>Yesterday<br/>All my troubles seemed so far away<br/>Now it looks as though they're here to stay<br/>read text, cursor is now at:<br/>88<br/>added text, cursor is now at:<br/>115<br/>rewound cursor, now at:<br/>0<br/>Yesterday<br/>All my troubles seemed so far away<br/>Now it looks as though they're here to stay<br/>Oh, I believe in yesterday<br/>just read added text, cursor is now at:<br/>115<br/>just moved 20 characters up, now at:<br/>20<br/>ubles seemed so far away<br/>Now it looks as though they're here to stay<br/>Oh, I believe in yesterday</span></pre><p id="e038" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我还在代码中添加了一些注释，只是为了弄清楚到底发生了什么。</p><h1 id="0d3f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">r+和 w+有什么区别？</h1><p id="ee6b" class="pw-post-body-paragraph jl jm hi jn b jo kv jq jr js kw ju jv jw kx jy jz ka ky kc kd ke kz kg kh ki hb bi translated">那么如果<strong class="jn hj"> r+ </strong>让你读写，而<strong class="jn hj"> w+ </strong>让你读写，那有什么区别呢？那么，如果“演示”文件在开始时丢失了怎么办？<strong class="jn hj"> r+ </strong>将出错退出。要解决这个问题，将<strong class="jn hj"> r+ </strong>模式改为<strong class="jn hj"> w+ </strong>。这仍然会截断文件，但如果它不存在，也会创建它。</p><p id="6461" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">将 r+和 w+放在上下文中，有一组可用的模式:</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="97e9" class="ko ig hi kk b fi kp kq l kr ks">+--------------------------+---+----+---+----+---+----+---+----+<br/>|                          | r | r+ | w | w+ | x | x+ | a | a+ |<br/>+--------------------------+---+----+---+----+---+----+---+----+<br/>| read                     | + | +  |   | +  |   | +  |   | +  |<br/>| write                    |   | +  | + | +  | + | +  | + | +  |<br/>| write after seek         |   | +  | + | +  | + | +  |   |    |<br/>| create                   |   |    | + | +  | + | +  | + | +  |<br/>| truncate                 |   |    | + | +  |   |    |   |    |<br/>| cursor position at start | + | +  | + | +  | + | +  |   |    |<br/>| cursor position at end   |   |    |   |    |   |    | + | +  |<br/>| notes                    | 1 | 2  | 3 | 4  | 5 | 6  | 7 | 8  |<br/>+--------------------------+---+----+---+----+---+----+---+----+</span></pre><p id="a9a5" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">…但是这里需要一些解释:</p><ol class=""><li id="8531" class="la lb hi jn b jo jp js jt jw lc ka ld ke le ki lf lg lh li bi translated">“读取”将打开一个现有文件供<em class="ku">读取</em>，但如果该文件不存在，将给出一个<strong class="jn hj"> FileNotFoundError </strong>。</li><li id="7ab9" class="la lb hi jn b jo lj js lk jw ll ka lm ke ln ki lf lg lh li bi translated">“read+”将打开一个现有文件供<em class="ku">读</em>和<em class="ku">写</em>，但如果该文件不存在，将给出一个<strong class="jn hj"> FileNotFoundError </strong>。</li><li id="2ee0" class="la lb hi jn b jo lj js lk jw ll ka lm ke ln ki lf lg lh li bi translated">“write”将打开一个现有文件供<em class="ku">写入</em>并在这样做之前截断它，<em class="ku">或者它将创建一个不存在的文件。</em></li><li id="bbc4" class="la lb hi jn b jo lj js lk jw ll ka lm ke ln ki lf lg lh li bi translated">“write+”将打开一个现有文件供<em class="ku">读取</em>和<em class="ku">写入</em>，并在执行此操作之前将其截断，<em class="ku">或者如果该文件不存在，将创建一个文件。</em></li><li id="ac6d" class="la lb hi jn b jo lj js lk jw ll ka lm ke ln ki lf lg lh li bi translated">“x”将创建一个新的写入文件，但如果它已经存在，将给出一个<strong class="jn hj">filexistserror</strong>。文件不能被截断，因为它的开头是空的。</li><li id="0f6e" class="la lb hi jn b jo lj js lk jw ll ka lm ke ln ki lf lg lh li bi translated">x+'将创建一个新的读写文件，但如果它已经存在，将给出一个<strong class="jn hj">filexistserror</strong>。文件不能被截断，因为它的开头是空的。</li><li id="2808" class="la lb hi jn b jo lj js lk jw ll ka lm ke ln ki lf lg lh li bi translated">“append”将打开一个现有文件并追加到末尾，如果它不存在，则创建一个新文件。</li><li id="d7e0" class="la lb hi jn b jo lj js lk jw ll ka lm ke ln ki lf lg lh li bi translated">' append+'将打开一个现有的文件进行读取并追加到末尾，如果它不存在，则创建一个新文件。</li></ol><p id="e92e" class="pw-post-body-paragraph jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">(有什么用？掌声很好，或者评论/问题…)</p></div></div>    
</body>
</html>