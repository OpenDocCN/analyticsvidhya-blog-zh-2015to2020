<html>
<head>
<title>How to Join Multiple Dataframes in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中连接多个数据帧</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-join-multiple-dataframes-in-python-1cf205550556?source=collection_archive---------7-----------------------#2020-02-05">https://medium.com/analytics-vidhya/how-to-join-multiple-dataframes-in-python-1cf205550556?source=collection_archive---------7-----------------------#2020-02-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7aad" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在Python中合并多个数据帧的挑战</h2></div><p id="cb81" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里有一个场景，几乎会绊倒每一个有抱负的新数据科学家:</p><blockquote class="jt ju jv"><p id="f3a8" class="ix iy jw iz b ja jb ij jc jd je im jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">您正在从事一个项目，该项目从多个来源收集数据。在进入探索和建模部分之前，您需要首先连接这些多个数据集(以表格、数据框等形式)。).您如何做到这一点而不丢失任何信息？</p></blockquote><p id="4009" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这听起来似乎是一个简单的场景，但是对于许多新手来说，尤其是那些不熟悉Python编程的人来说，这可能是一个令人生畏的场景。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ka"><img src="../Images/347a166f09f8326a1d827cbb539d4031.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zyGnCTlJC_A5jVJC.jpg"/></div></div></figure><p id="7151" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">深入研究一下，我可以大致将其分为两种情况:</p><ol class=""><li id="2853" class="km kn hi iz b ja jb jd je jg ko jk kp jo kq js kr ks kt ku bi translated">首先，属性相似的数据可能被分布到<strong class="iz hj">多个文件</strong>中。例如，假设为您提供了多个文件，每个文件都存储了一年中某一周的销售信息。因此，全年您将有52个文件。每个文件都有相同数量和名称的列。</li><li id="3cee" class="km kn hi iz b ja kv jd kw jg kx jk ky jo kz js kr ks kt ku bi translated">第二，你可能需要结合来自<strong class="iz hj">多个来源</strong>的信息。例如，假设您想要获取购买过您产品的人的联系信息。这里有两个文件—第一个包含销售信息，第二个包含客户信息。</li></ol><p id="65a0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将向您展示如何处理这两种场景，并在<a class="ae la" href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science?utm_source=blog&amp;utm_medium=join-dataframes-in-python" rel="noopener ugc nofollow" target="_blank"> Python </a>中连接多个数据帧。</p><h1 id="b9e6" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">理解手头的问题</h1><p id="b974" class="pw-post-body-paragraph ix iy hi iz b ja lt ij jc jd lu im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">出于本文的目的，我将举一个通俗易懂的例子。</p><p id="165a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们考虑一个特定学校的考试的例子。有各种各样的科目，每个科目都有不同的老师。他们更新自己的学生成绩和总体表现档案。我们在这里讨论的是多个文件！</p><p id="0ccb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我们将使用我创建的两个这样的文件来演示Python中函数的工作。第一个文件包含12班学生的数据，另一个包含10班学生的数据。我们还将使用第三个文件来存储学生的姓名和学号。</p><p id="a970" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jw">注意:虽然这些数据集是从零开始创建的，但我鼓励您将学到的知识应用到自己选择的数据集上。</em></p><h1 id="5235" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">在Python中合并数据帧的分步过程</h1><p id="1312" class="pw-post-body-paragraph ix iy hi iz b ja lt ij jc jd lu im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">我们将这样处理这个问题:</p><ol class=""><li id="c596" class="km kn hi iz b ja jb jd je jg ko jk kp jo kq js kr ks kt ku bi translated">在Python中加载数据集</li><li id="247c" class="km kn hi iz b ja kv jd kw jg kx jk ky jo kz js kr ks kt ku bi translated">组合两个相似的数据帧(追加)</li><li id="4920" class="km kn hi iz b ja kv jd kw jg kx jk ky jo kz js kr ks kt ku bi translated">合并两个数据框架中的信息(合并)</li></ol><h1 id="2393" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">步骤1:在Python中加载数据集</h1><p id="35fc" class="pw-post-body-paragraph ix iy hi iz b ja lt ij jc jd lu im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">在本文中，我们将使用三个独立的数据集。首先，我们需要将这些文件加载到单独的数据帧中。</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="805a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">前两个数据帧包含学生的百分比以及他们的学号。在我们的第一个数据帧中，我们有10年级学生的分数，而第二个数据帧包含12年级学生的分数。第三个数据帧包含学生的姓名以及他们各自的学号。</p><p id="d8ad" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以使用“head”函数来检查每个数据帧的前几行:</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="ly lz l"/></div></figure><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es ma"><img src="../Images/00e142592d5d59c8a6969e26b335c585.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*b-EusGget4NQdpU9.png"/></div></figure><h1 id="5b61" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">步骤2:组合两个相似的数据帧(追加)</h1><p id="9cc8" class="pw-post-body-paragraph ix iy hi iz b ja lt ij jc jd lu im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">让我们结合10班和12班的档案，找出学生的平均分数。这里，我们将使用Pandas库中的‘append’函数:</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="5752" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">输出:((50，3)，(50，3)，(100，3)) </strong></p><blockquote class="jt ju jv"><p id="37fa" class="ix iy jw iz b ja jb ij jc jd je im jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><em class="hi">正如您在输出中看到的，append函数将两个数据帧垂直相加。</em></p></blockquote><p id="9817" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">得到的数据帧是<em class="jw">所有标记</em>。上面比较了所有三个数据帧的形状。</p><p id="f0fa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，让我们看看“allMarks”的内容并计算平均值:</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es ma"><img src="../Images/7ed2c73337d218f401086ba52a6147fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*GA1wjRJ0vSDiLE2O.png"/></div></figure><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="6f3d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">输出:49.74 </strong></p><h1 id="f53d" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">步骤3:合并两个数据框中的信息(合并)</h1><p id="28a5" class="pw-post-body-paragraph ix iy hi iz b ja lt ij jc jd lu im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">现在，假设我们想找出两个批次中第一个到达的学生的名字。这里，我们不需要垂直添加数据帧。<strong class="iz hj">我们将不得不水平缩放它，以便为学生姓名再添加一列。</strong></p><p id="9790" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，我们将找到最高得分:</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="9877" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">输出:100 </strong></p><p id="1e00" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">学生的最高分数是100分。现在，我们将使用“合并”功能来查找该学生的姓名:</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="ly lz l"/></div></figure><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es ma"><img src="../Images/4a7a6abea30bb1c0efc6b8b94b2c4120.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*-uBKpTInPXbk8L3f.png"/></div></figure><p id="1e77" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，得到的数据帧中有学生的名字和他们的分数。</p><blockquote class="jt ju jv"><p id="2b66" class="ix iy jw iz b ja jb ij jc jd je im jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><em class="hi">合并功能需要一个必要的属性，在该属性上两个数据帧将被合并。我们需要在“on”参数中传递该列的名称。</em></p></blockquote><p id="9b11" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">合并的另一个重要论点是“如何”。这指定了要在数据帧上执行的连接类型。以下是您可以执行的不同联接类型(SQL用户对此非常熟悉):</p><ul class=""><li id="7332" class="km kn hi iz b ja jb jd je jg ko jk kp jo kq js mb ks kt ku bi translated">内部联接(如果不提供任何参数，默认情况下执行)</li><li id="cc3e" class="km kn hi iz b ja kv jd kw jg kx jk ky jo kz js mb ks kt ku bi translated">外部连接</li><li id="6942" class="km kn hi iz b ja kv jd kw jg kx jk ky jo kz js mb ks kt ku bi translated">右连接</li><li id="d96a" class="km kn hi iz b ja kv jd kw jg kx jk ky jo kz js mb ks kt ku bi translated">左连接</li></ul><p id="f2d4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还可以使用“sort”参数对数据帧进行排序。这些是合并两个数据帧时最常用的参数。</p><p id="4b09" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们将看到数据帧中包含100个“考试点”的行:</p><figure class="kb kc kd ke fd kf"><div class="bz dy l di"><div class="ly lz l"/></div></figure><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es ma"><img src="../Images/8f6ffedc9e5b50f783bfe24fc0ffbf1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*_dOc9U_3LD5h9YsE.png"/></div></figure><p id="5ae0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">三个学生得了100分，其中两个是第十名。干得好！</p><h1 id="3770" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">结束注释</h1><p id="260f" class="pw-post-body-paragraph ix iy hi iz b ja lt ij jc jd lu im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">很简单，对吧？没必要再为这个而烦恼了！您可以将它应用于您选择的任何数据集。我的建议是选择包含3个不同文件的<a class="ae la" href="https://datahack.analyticsvidhya.com/contest/genpact-machine-learning-hackathon-1/" rel="noopener ugc nofollow" target="_blank">食品预测挑战</a>。</p><p id="921f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你是Python的数据科学新手，可以报名参加<a class="ae la" href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science" rel="noopener ugc nofollow" target="_blank">这个</a>免费课程。</p><p id="bf17" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你也可以在分析Vidhya的Android应用上阅读这篇文章</p><p id="fdcb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jw">原载于2020年2月5日</em><a class="ae la" href="https://www.analyticsvidhya.com/blog/2020/02/join-dataframes-in-python/" rel="noopener ugc nofollow" target="_blank"><em class="jw">【https://www.analyticsvidhya.com】</em></a><em class="jw">。</em></p></div></div>    
</body>
</html>