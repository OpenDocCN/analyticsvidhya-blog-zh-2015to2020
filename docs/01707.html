<html>
<head>
<title>TypeScript Development for CRM 365</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CRM 365的类型脚本开发</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/typescript-development-for-crm-365-48fbfb0b653d?source=collection_archive---------8-----------------------#2019-11-10">https://medium.com/analytics-vidhya/typescript-development-for-crm-365-48fbfb0b653d?source=collection_archive---------8-----------------------#2019-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3c9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TypeScript是一种强类型、面向对象的编译语言。它是由微软的安德斯·海尔斯伯格(C#的设计者)设计的。TypeScript既是一种语言，也是一套工具。TypeScript是编译成JavaScript的JavaScript的类型化超集。换句话说，TypeScript是JavaScript加上一些额外的特性。</p><h1 id="ecd6" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">为什么打字稿？</h1><ul class=""><li id="43bb" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated">TypeScript支持JS库和API文档</li><li id="aa0d" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">它是Javascript的超集。</li><li id="bd38" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">它是可选类型的脚本语言</li><li id="e692" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">类型脚本代码可以转换成普通的JavaScript代码</li><li id="2726" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">更好的代码结构和面向对象的编程技术</li><li id="01bf" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">允许更好的开发时间工具支持</li><li id="11e9" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">它可以将语言扩展到标准decorators、async/await之外</li><li id="316d" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">编译时错误和智能感知可用</li></ul><h1 id="2373" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">使用Javascript的痛点？</h1><ul class=""><li id="2100" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated">没有可用的静态类型。</li><li id="5e39" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">有对面向对象编程的支持，但是需要巨大的努力才能在代码中显示出来</li><li id="d150" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">所有的类型错误都是在运行时发现的。</li></ul><h1 id="d327" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">如何在CRM 365开发中利用Typescript</h1><p id="1899" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">有几种方法和途径可以在CRM中开始typescript开发，这是您可以实现的一种方法</p><ul class=""><li id="e552" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">用typescript文件创建本地文件夹</li><li id="b08a" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">创建一个空的VS解决方案，点击“添加现有网站”并选择文件夹</li><li id="bfc0" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">单击为ts和js创建新文件夹</li><li id="3c64" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">创建一个新文件tsconfig.json和如下所示的代码</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es kx"><img src="../Images/dfbaa719a281619c1bfbb951c4d7735e.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*a0fLkwM7toN_18mDoUvU0w.png"/></div><figcaption class="lf lg et er es lh li bd b be z dx translated">tsconfig.json</figcaption></figure><ul class=""><li id="6a55" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">从https://nodejs.org/en/下载并安装Node.js</li><li id="2c84" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">通过将客户端库添加到网站项目来安装npm包@types/xrm最新版本</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lk"><img src="../Images/cbee12094b03f039c620fbc6457ee0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*Oa084YTAG_V-N-JyeW1b_w.png"/></div><figcaption class="lf lg et er es lh li bd b be z dx translated">XRM包</figcaption></figure><ul class=""><li id="6b2b" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">创建一个新文件Account.ts，该文件将引用xrm包并保存它，它将根据tsconfig.json中给出的编译器保存选项自动创建名为Account.js.map的js和源映射文件</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es ll"><img src="../Images/6bdef115b13fcc10b7af056623437749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H7V8Dh0ViePQpMhrOSERWQ.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">Account.ts</figcaption></figure><ul class=""><li id="8c16" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">使用Nuget包管理器安装spkl包</li><li id="c3d3" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">在spkl.json中复制粘贴下面的代码，如屏幕截图所示</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lq"><img src="../Images/67d7becf74a56150ed1f6e53e79d96b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ESJqL1EH7CvW4T9Hx59imw.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">spkl.json</figcaption></figure><p id="00df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">右键单击bat deploy-webresources.bat并提供配置，它会自动将web资源上传到CRM</p><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lr"><img src="../Images/9c47c90317f2fe58e726e7b0a580eb26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*4GqbYkAeDtGeVgF3eG4Kmw.png"/></div></figure><h1 id="2b7c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">使用Fiddler调试CRM中的Typescript</h1><p id="44b8" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们不能在CRM中直接调试typescript，因为我们不会将ts文件作为web资源添加到CRM中，调试传输的js文件会很困难<strong class="ih hj">,但不要担心CRM和Fiddler已经提供了一个漂亮的选项，称为自动回复器，这将在这方面帮助我们。</strong></p><p id="fcad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">每个ts文件都有一个源映射文件，它将被映射到ts文件本地。当您保存ts文件时，VS会根据tsconfig.json </strong>中的编译器选项自动创建这个js.map文件</p><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es ls"><img src="../Images/be1fcdcf48024292b487741b7c47a5b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*ZID2IEWwbab1jOskTh5DXA.png"/></div><figcaption class="lf lg et er es lh li bd b be z dx translated">js和ts之间的映射文件</figcaption></figure><ul class=""><li id="f90d" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">下载提琴手工具<a class="ae lj" href="https://www.telerik.com/download/fiddler" rel="noopener ugc nofollow" target="_blank">https://www.telerik.com/download/fiddler</a></li><li id="8b2b" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">转到Fiddler并启用过滤器，转到过滤器选项卡，并在仅显示URL中给出/webresources/mse</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div class="er es lt"><img src="../Images/f1568615c764c2c1e606e8e1bfa89786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*dK1KxXQztZdrMS1dO9Fc0g.png"/></div><figcaption class="lf lg et er es lh li bd b be z dx translated">过滤</figcaption></figure><p id="5859" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Fiddler将充当CRM和浏览器之间的代理，它将只过滤这些请求。</p><ul class=""><li id="3eb2" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">转到“自动回复”选项卡，并添加以下规则</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lu"><img src="../Images/e73bcfe19a4ee77a80f34142ee8340cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WaM-98FyF_uQWAT_2lP8WQ.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">自动回复规则</figcaption></figure><ul class=""><li id="bc77" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">因此，每当它点击webresources/mse_/ in URL时，它将从本地文件夹中获取脚本，并为请求提供服务，就像这样，您可以在chrome tools中调试类型脚本，而无需将web资源上传到CRM，这将最大限度地提高您的生产率，并且您可以在CRM中上传已完成并经过测试的脚本。</li><li id="65a3" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">现在转到CRM并点击f12，您将看到js以及要调试的ts</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/5edaf620f78df61827d9796f86f85217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zdruz_eTjllAOTh4JRHuSQ.png"/></div></div></figure><h1 id="d917" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">调试ts的先决条件</h1><ul class=""><li id="0eb9" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated">在Chrome中，通过按F1启用设置中的以下选项，并启用高亮显示的选项。</li></ul><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lw"><img src="../Images/3cf5c8097a0930fdf0e8d3e6f81ec2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5K0N3VgPBC4KZfdkWsIW7Q.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">Chrome开发工具设置</figcaption></figure><ul class=""><li id="0c14" class="kb kc hi ih b ii ij im in iq ku iu kv iy kw jc ki kj kk kl bi translated">并在本地文件夹路径中避免名称中出现空格</li></ul><h1 id="70d4" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">参考</h1><ul class=""><li id="c01c" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated"><a class="ae lj" href="https://www.tutorialspoint.com/typescript/typescript_overview.htm" rel="noopener ugc nofollow" target="_blank">https://www . tutorialspoint . com/typescript/typescript _ overview . htm</a></li><li id="12a5" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated"><a class="ae lj" href="https://www.geeksforgeeks.org/difference-between-typescript-and-javascript/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/difference-between-typescript-and-JavaScript/</a></li><li id="ab8e" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated"><a class="ae lj" href="https://docs.microsoft.com/en-us/dynamics365/customerengagement/on-premises/developer/streamline-javascript-development-fiddler-autoresponder" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/dynamics 365/customer engagement/on-premises/developer/streamline-JavaScript-development-fiddler-autoresponder</a></li><li id="0037" class="kb kc hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated"><a class="ae lj" href="https://github.com/scottdurow/SparkleXrm/wiki/spkl" rel="noopener ugc nofollow" target="_blank">https://github.com/scottdurow/SparkleXrm/wiki/spkl</a></li></ul></div></div>    
</body>
</html>