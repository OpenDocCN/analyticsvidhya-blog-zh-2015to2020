<html>
<head>
<title>How to filter noise with a low pass filter — Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用低通滤波器过滤噪声— Python</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-filter-noise-with-a-low-pass-filter-python-885223e5e9b7?source=collection_archive---------0-----------------------#2019-12-27">https://medium.com/analytics-vidhya/how-to-filter-noise-with-a-low-pass-filter-python-885223e5e9b7?source=collection_archive---------0-----------------------#2019-12-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f5c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，我在处理12.5 Khz的甚高频信号，即每秒12500个样本或每80微秒一个样本。更有趣的是，我必须将各种数据点导出到这个数据集中。</p><p id="00df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我的数据在一个周期内的样子</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/380e5fb88ef2668eb6bb2047e1430bc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvAQCVR6RV4BvlbVqHb5sg.png"/></div></div></figure><p id="8fa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我放大数据时，你可以看到噪音</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/8754b7738293de81b1892d3826d543cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nCkGzV70IpdvF6EEIVRPaw.png"/></div></div></figure><p id="04ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在考虑一下，如果必须确定曲线上升的起点。</p><p id="7d99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有这么多的噪声，获得假阳性数据点的概率非常高。也想象一下数据波动这么大的情况下算法的性能。</p><p id="f4e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将从一些信号处理基础知识开始，在我们开始编写代码之前，理解这些基础知识至关重要。</p><h1 id="f29f" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">基础知识:带通滤波器</h1><p id="c4c9" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">四种常见的过滤器。</p><ol class=""><li id="d4e0" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">低通滤波器，通过频率低于特定截止频率的信号，衰减频率高于截止频率的信号。</li><li id="bd69" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">高通滤波器，通过频率高于特定截止频率的信号，衰减频率低于截止频率的信号。</li><li id="d459" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">可以通过级联高通滤波器和低通滤波器来形成带通滤波器。</li><li id="5463" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">带阻滤波器是低通滤波器和高通滤波器的并联组合。</li></ol><div class="je jf jg jh fd ab cb"><figure class="lh ji li lj lk ll lm paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/bdc3d67dac4fc107a85de6fd08e62b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*wr3WEn9ix-pCHpG09UmqLQ.png"/></div></figure><figure class="lh ji ln lj lk ll lm paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/54b1201cef47558c4e9d7da417e3e58b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*7leMx5vvmA6JJaGVSn5irg.png"/></div></figure></div><p id="e563" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看一个样本数据，这将是理想的工作</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/581ffb26f21bcf50e5aeca44d28ce500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WLMQw9hsY1G6w8oupNozGQ.png"/></div></div></figure><p id="7182" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您所看到的，大量噪声导致的失真使实际数据发生了变形，实际数据是正弦波数据。</p><ul class=""><li id="247f" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc lp kz la lb bi translated">采样周期— 5秒(t)</li><li id="54d2" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">采样频率— 30个样本/秒，即30赫兹(fs)</li><li id="3461" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">样本总数— (fs x t) = 150</li><li id="17ab" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">信号频率= 6个信号/ 5秒= 1.2赫兹</li></ul><p id="dba9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着我们需要一个最多允许1.2 Hz频率的信号通过的滤波器，然而在现实生活中，信号频率可能会波动，因此，如果我们选择一个比理想计算频率略高的数字，效果会更好。</p><p id="b8e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您也可以尝试使用FFT(快速傅立叶变换)来研究信号与噪声成分的频率和幅度，更多细节和代码可在<a class="ae lq" rel="noopener" href="/@nehajirafe/using-fft-to-analyse-and-cleanse-time-series-data-d0c793bb82e3">这里</a>找到</p><h1 id="a83b" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">巴特沃斯滤波器</h1><p id="e9b5" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">巴特沃兹滤波器的频率响应在通带内最平坦(即没有<a class="ae lq" href="https://en.wikipedia.org/wiki/Ripple_(filters)" rel="noopener ugc nofollow" target="_blank">波纹</a>)，在阻带内滚降为零，因此是最受欢迎的低通滤波器之一。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/5c839d5ed2fb5192d32ece87c947ecd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7NoNi6QmSMxb73YcnuV9YA.png"/></div></div></figure><h1 id="8ac9" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">奈奎斯特频率</h1><p id="6380" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">术语奈奎斯特经常用来描述<a class="ae lq" href="http://astronomy.swin.edu.au/cosmos/N/Nyquist+Rate" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="ls">奈奎斯特</em> </strong> </a> <em class="ls">采样率</em>或<em class="ls">奈奎斯特</em> <a class="ae lq" href="http://astronomy.swin.edu.au/cosmos/F/Frequency" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="ls">频率</em> </strong> </a>。</p><p id="d2c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lq" href="http://astronomy.swin.edu.au/cosmos/N/Nyquist+Rate" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">奈奎斯特速率</strong> </a>或频率是有限带宽信号需要被采样以保留所有信息的最小速率。如果以固定的时间间隔<em class="ls"> dt </em>对一个时间序列进行采样，那么奈奎斯特速率就是1/(2 <em class="ls"> dt </em>)。</p><h1 id="d648" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">让我们直接进入代码</h1><p id="b2fc" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">步骤1:定义过滤器要求</p><ul class=""><li id="e21a" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc lp kz la lb bi translated">采样周期— 5秒(t)</li><li id="b6e2" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">采样频率— 30个样本/秒，即30赫兹(fs)</li><li id="3ce2" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">样本总数— (fs x t) = 150</li><li id="8190" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">信号频率= 6个信号/ 5秒= 1.2赫兹</li><li id="c1e6" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">奈奎斯特频率= 0.5 * fs</li><li id="4b2a" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc lp kz la lb bi translated">阶数=信号的多项式阶</li></ul><pre class="je jf jg jh fd lt lu lv lw aw lx bi"><span id="11c9" class="ly jr hi lu b fi lz ma l mb mc">import numpy as np<br/>from scipy.signal import butter,filtfilt</span><span id="4676" class="ly jr hi lu b fi md ma l mb mc"># Filter requirements.<br/>T = 5.0         # Sample Period<br/>fs = 30.0       # sample rate, Hz<br/>cutoff = 2      # desired cutoff frequency of the filter, Hz ,      slightly higher than actual 1.2 Hz</span><span id="e997" class="ly jr hi lu b fi md ma l mb mc">nyq = 0.5 * fs  # Nyquist Frequency</span><span id="64bc" class="ly jr hi lu b fi md ma l mb mc">order = 2       # sin wave can be approx represented as quadratic<br/>n = int(T * fs) # total number of samples</span></pre><p id="aea6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤2:创建一些带有噪声的样本数据</p><pre class="je jf jg jh fd lt lu lv lw aw lx bi"><span id="2007" class="ly jr hi lu b fi lz ma l mb mc"># sin wave<br/>sig = np.sin(1.2*2*np.pi*t)</span><span id="109f" class="ly jr hi lu b fi md ma l mb mc"># Lets add some noise<br/>noise = 1.5*np.cos(9*2*np.pi*t) + 0.5*np.sin(12.0*2*np.pi*t)</span><span id="a64d" class="ly jr hi lu b fi md ma l mb mc">data = sig + noise</span></pre><p id="2c8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤3:使用scipy实现过滤器</p><pre class="je jf jg jh fd lt lu lv lw aw lx bi"><span id="29f5" class="ly jr hi lu b fi lz ma l mb mc">def butter_lowpass_filter(data, cutoff, fs, order):<br/>    normal_cutoff = cutoff / nyq<br/>    # Get the filter coefficients <br/>    b, a = butter(order, normal_cutoff, btype='low', analog=False)<br/>    y = filtfilt(b, a, data)<br/>    return y</span></pre><p id="81c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤4:过滤并绘制数据</p><pre class="je jf jg jh fd lt lu lv lw aw lx bi"><span id="a04a" class="ly jr hi lu b fi lz ma l mb mc"># Filter the data, and plot both the original and filtered signals.<br/>y = butter_lowpass_filter(data, cutoff, fs, order)</span><span id="d0da" class="ly jr hi lu b fi md ma l mb mc">fig = go.Figure()</span><span id="d0d0" class="ly jr hi lu b fi md ma l mb mc">fig.add_trace(go.Scatter(<br/>            y = data,<br/>            line =  dict(shape =  'spline' ),<br/>            name = 'signal with noise'<br/>            ))<br/>fig.add_trace(go.Scatter(<br/>            y = y,<br/>            line =  dict(shape =  'spline' ),<br/>            name = 'filtered signal'<br/>            ))</span><span id="22e2" class="ly jr hi lu b fi md ma l mb mc">fig.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es me"><img src="../Images/a82d80ad5b269855c4876c739ffb2a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GnLLpT6HKxqdPbUJJinOAQ.png"/></div></div></figure><p id="f4b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">令人惊讶的是，滤波后的信号与数据的对齐如此平滑，感觉就像“黄油”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/e33bb3f60b7cc22cce1e8b3983f4253c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l4W8J9xyEe6Uoywd.jpg"/></div></div></figure><p id="8eb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天就到这里吧！快乐过滤</p><p id="4c8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看我的其他文章</p><div class="mg mh ez fb mi mj"><a rel="noopener follow" target="_blank" href="/@nehajirafe/how-to-make-jupyter-notebooks-extensible-and-reusable-ae11bd3175c"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hj fi z dy mo ea eb mp ed ef hh bi translated">如何让Jupyter笔记本具有可扩展性和可重用性</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">所有使用Jupyter笔记本进行数据分析或机器学习工作的人都知道“复制”的痛苦——</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">medium.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx jn mj"/></div></div></a></div><div class="mg mh ez fb mi mj"><a rel="noopener follow" target="_blank" href="/@nehajirafe/data-modeling-designing-facebook-style-comments-with-sql-4cf9e81eb164"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hj fi z dy mo ea eb mp ed ef hh bi translated">数据建模—用SQL设计脸书风格的“注释”</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">让我们同意，我们都使用过一些或其他社交网站的“评论”部分。</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">medium.com</p></div></div><div class="ms l"><div class="my l mu mv mw ms mx jn mj"/></div></div></a></div><div class="mg mh ez fb mi mj"><a rel="noopener follow" target="_blank" href="/@nehajirafe/using-fft-to-analyse-and-cleanse-time-series-data-d0c793bb82e3"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hj fi z dy mo ea eb mp ed ef hh bi translated">用FFT分析和清理时间序列数据</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">通常在处理IOT数据时，最大的挑战是遇到意想不到的噪音，这种噪音可能非常…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">medium.com</p></div></div><div class="ms l"><div class="mz l mu mv mw ms mx jn mj"/></div></div></a></div></div></div>    
</body>
</html>