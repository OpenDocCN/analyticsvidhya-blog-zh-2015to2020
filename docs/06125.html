<html>
<head>
<title>Performance benchmark of DataStax Enterprise v6 (Cassandra)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DataStax Enterprise v6的性能基准(Cassandra)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/performance-benchmark-of-datastax-enterprise-v6-cassandra-f77439c7e922?source=collection_archive---------9-----------------------#2020-05-12">https://medium.com/analytics-vidhya/performance-benchmark-of-datastax-enterprise-v6-cassandra-f77439c7e922?source=collection_archive---------9-----------------------#2020-05-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cf1b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">该报告旨在从延迟和吞吐量两个方面衡量<a class="ae ix" href="https://www.datastax.com/" rel="noopener ugc nofollow" target="_blank">DataStax Enterprise V6(Cassandra)</a>在两种工作负载下的性能。</h2></div><h2 id="daf6" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">介绍</h2><p id="e75f" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke jj kf kg kh jn ki kj kk jr kl km kn ko hb bi translated">该报告的目标是测量<a class="ae ix" href="https://www.datastax.com/" rel="noopener ugc nofollow" target="_blank">DataStax Enterprise V6(Cassandra)</a>在延迟和吞吐量方面的性能。Cassandra由三种类型的集群配置部署。有4个、10个和20个节点。使用两种工作负载类型进行评估。</p><p id="abf6" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">第一个工作量是“<em class="ku">更新繁重的</em>工作量。该工作负载通过使用<a class="ae ix" href="https://en.wikipedia.org/wiki/Zipf%27s_law" rel="noopener ugc nofollow" target="_blank"> Zipfian </a>作为请求分布来评估50%的读取请求和50%的写入请求。</p><p id="032b" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">第二个工作负载是“<em class="ku">短程</em>”。这种工作负载的想法是调用95%的扫描和5%的更新。请求分布是相同的— <a class="ae ix" href="https://en.wikipedia.org/wiki/Zipf%27s_law" rel="noopener ugc nofollow" target="_blank"> Zipfian </a>。</p><p id="5c65" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">作为处理基准性能的工具，Yahoo！云服务基准测试(YCSB) 。YCSB是一个评估数据库在不同工作负载下的基准性能的框架。</p><p id="4967" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">数据大小是1 KB记录(10个字段，每个字段100字节，加上关键字)。记录的数量是根据聚类的大小选择的。4节点群集上5，000万条，10节点群集上1亿条，20节点群集上2.5亿条记录。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="c68d" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">环境</h2><p id="fd3e" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke jj kf kg kh jn ki kj kk jr kl km kn ko hb bi translated">AWS上以下类型的EC2实例被选择用于部署Cassandra集群:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lc"><img src="../Images/964f288f3af38b237d7866f108da59a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*qxblVLNN6_wwZIeeAilQkg.png"/></div></figure><p id="41eb" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">YCSB客户端由AWS部署在计算优化的实例上:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lk"><img src="../Images/f128e423dcadf156b5833c6c00c27bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*kCE8_g7Vp2hjOJ4oUnEYRQ.png"/></div></figure><h2 id="b501" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">集群配置</h2><p id="b4d4" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke jj kf kg kh jn ki kj kk jr kl km kn ko hb bi translated">DataStax Enterprise (Cassandra)是一个宽列商店NoSQL数据库管理系统，旨在处理许多商用服务器上的大量数据，提供无单点故障的高可用性。</p><p id="3ac5" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">下表显示了应用于Cassandra配置的更改:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lk"><img src="../Images/31b7ed0a8f1adb487c519a1c0af65b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*LrP9PfPVlKTXlXLwclpEog.png"/></div></figure></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="60dc" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">工作量“更新-繁重”</h2><p id="40ef" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke jj kf kg kh jn ki kj kk jr kl km kn ko hb bi translated">此工作负载包括50%的读取操作和50%的更新操作。作为一个请求分配使用Zipfian。此工作负载的查询如下所示:</p><blockquote class="ll lm ln"><p id="a6ba" class="jw jx ku jy b jz kp ij kb kc kq im ke lo kr kg kh lp ks kj kk lq kt km kn ko hb bi translated"><em class="hi">从id = $1 LIMIT 1 </em>的表格中选择*</p></blockquote><p id="7134" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">在基准评估之前，Cassandra集群的缓存已经预热。命中率接近65%。预热集群是性能基准测试的一个好方法，这样可以使集群更接近真实的生产行为。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lr"><img src="../Images/b423479ed4ad60909ee33d71b96a7e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*5vI_5CKyVD48xybmuhmc7Q.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">工作量“更新-繁重”</figcaption></figure><p id="c335" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">Cassandra为4节点群集处理了约77，500次操作/秒，10节点群集达到约130，000次操作/秒，20节点群集达到200，000次操作/秒。延迟看起来真的很好。对于4节点群集— 10毫秒，10节点群集— 6毫秒，20节点群集— 4毫秒</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="02da" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">工作负荷"<em class="lw">短程</em></h2><p id="48d7" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke jj kf kg kh jn ki kj kk jr kl km kn ko hb bi translated">此工作负载包括95%的读取操作和5%的更新操作。作为一个请求分配使用Zipfian。此工作负载的查询如下所示:</p><blockquote class="ll lm ln"><p id="4f3f" class="jw jx ku jy b jz kp ij kb kc kq im ke lo kr kg kh lp ks kj kk lq kt km kn ko hb bi translated"><em class="hi">从令牌(id) ≥令牌(1美元)限额的表格中选择id&amp;2</em></p></blockquote><p id="2334" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">YCSB中的这个工作负载是通过使用令牌操作来实现的。使用Murmur3Partitioner作为划分器的类型。然而，Murmur3Partitioner会计算一个密钥哈希，这可能会导致扫描操作的意外结果。不幸的是，Cassandra不支持这种类型的分区键排序。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lr"><img src="../Images/02bd6a8aa3fb8cf9cd7ecdb506baa90d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*yIKuvB6XlSgJV2T5IQ1gRw.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">“短程”工作负荷</figcaption></figure><p id="6f04" class="pw-post-body-paragraph jw jx hi jy b jz kp ij kb kc kq im ke jj kr kg kh jn ks kj kk jr kt km kn ko hb bi translated">Cassandra上的扫描操作工作负载显示了以下性能结果:4节点集群上500毫秒的1，400操作/秒，10节点集群上175毫秒的4，000操作/秒，20节点集群上100毫秒的7，200操作/秒。</p><h2 id="c45f" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">摘要</h2><p id="0ac4" class="pw-post-body-paragraph jw jx hi jy b jz ka ij kb kc kd im ke jj kf kg kh jn ki kj kk jr kl km kn ko hb bi translated">Cassandra对所选的工作负载表现出了良好的性能。所有集群的性能几乎都实现了线性增长。这表明该行为在当前工作负载下是稳定的和可预期的。应该注意的是，Cassandra没有达到700个客户端线程的最大吞吐量，但是吞吐量在不断增长，延迟保持相对较低。</p></div></div>    
</body>
</html>