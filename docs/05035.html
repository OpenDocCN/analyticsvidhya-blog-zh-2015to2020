<html>
<head>
<title>Embedding Matrices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">嵌入矩阵</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/embedding-matrices-ba8d0e6b85d7?source=collection_archive---------23-----------------------#2020-04-08">https://medium.com/analytics-vidhya/embedding-matrices-ba8d0e6b85d7?source=collection_archive---------23-----------------------#2020-04-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/f73b4811241bf0a74bbcaa22f7a52e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yXgNMxq2tIXeG8xQ"/></div></div></figure><div class=""/><div class=""><h2 id="8b24" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">神经网络学习的奇妙方式。</h2></div><p id="577e" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">直到上周，我看待模型“学习”的方式是通过准确性。如果精确度很高，那么模型就相当不错；这种看法当然有助于分类问题。但是看着其他的应用，直觉变得很模糊，损失变得越来越低，我只能在非常基础的水平上理解。</p><p id="0f2a" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">上周，当我在观看Fastai MOOC的<a class="ae km" href="https://course.fast.ai/videos/?lesson=5" rel="noopener ugc nofollow" target="_blank">第5课</a>时，杰瑞米·霍华德(fast.ai的联合创始人)展示了一个模型的解释，该模型来自一个团队，该团队在<a class="ae km" href="https://www.kaggle.com/c/rossmann-store-sales" rel="noopener ugc nofollow" target="_blank">罗斯曼商店销售卡格尔竞赛</a>中获得第二名。他们在一个表格问题中使用了神经网络，这在2016年是前所未有的。他们使用实体嵌入来学习分类变量之间的内在关系。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kn"><img src="../Images/417cdaa8e69321b44e223b20be38831e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hMR7UXVrbX04NpnNPjeqA.png"/></div></div></figure><p id="2a06" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">嵌入的神奇之处在于，如果我们看这个图表，它学会了地理。罗斯曼是一家德国零售药店，他们在德国有大量的商店。销售受地理位置的影响。这意味着像我们一样的机器可以学习决定产品或服务的许多因素之间的关系。</p><p id="c567" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">嵌入是<em class="ks">低维、</em> <em class="ks">学习到的</em>离散变量的连续向量表示。在神经网络的上下文中，这个抽象的定义并没有给我多少关于嵌入到底是什么的清晰的概念，我想要对它有一个感觉。</p><p id="058b" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我决定用这个<a class="ae km" href="https://nbviewer.jupyter.org/github/fastai/course-v3/blob/master/nbs/dl1/lesson4-collab.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>做一个协同过滤模型来推荐电影。我用最新的<a class="ae km" href="https://grouplens.org/datasets/movielens/" rel="noopener ugc nofollow" target="_blank">电影镜头</a> 100K数据集得出一些有趣的见解。</p><p id="91f9" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我取了评分最高的1000部电影的平均评分，并根据偏差进行了排序。在这种情况下，偏见是我们对电影的先入为主的观念，一个例子是提到马丁·斯科塞斯制作电影已经让我觉得它会很好(积极的偏见)。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kt"><img src="../Images/9284f6b20880fafa57e4de42ce6ad8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h8djLTVUQq4h6GpuhI_WdQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">倒数15部电影。</figcaption></figure><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ky"><img src="../Images/f90be60b93c58d022841e7ef09075c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxaGPfayaL0qsd6AZhmtOQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">前15部电影。</figcaption></figure><p id="7d09" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">偏向正面的电影收视率高，底层的电影收视率差。《肖申克的救赎》是IMDB上评价最高的电影之一。现在让我们转到嵌入矩阵，机器学习的特征。</p><p id="b478" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">模型有40个因素或属性，很难掌握一个40维的图。所以我用主成分分析把因子数减少到3。</p><h2 id="a92a" class="kz la ht bd lb lc ld le lf lg lh li lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">因素1 —质量</h2><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lu"><img src="../Images/209e583be70d1341c0e78228fb177f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NTkYD-ZeM1RGzavu4xm_3g.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">倒数15名</figcaption></figure><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lv"><img src="../Images/ae8da1c5d3bfef59b5cc60026200d398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xzpppBGI9NZp1nv5dGXZxg.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">前15名</figcaption></figure><p id="f54b" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">顶部的电影制作精良，《搏击俱乐部》堪称经典。随着我们在名单上的位置越来越靠后，电影的质量越来越差，《蟒蛇》肯定不是我想让自己再次经历的事情。</p><h2 id="a93d" class="kz la ht bd lb lc ld le lf lg lh li lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">因素2 —受众</h2><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/467b74779868fccfb06ae8593ca978d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HU6TPKuOf-OCEBAFPaR55w.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">倒数15名</figcaption></figure><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/7b8300b8b506c519f6e8e63fcf7a7394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*55az7FykenoxecH280Zdgw.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">前15名</figcaption></figure><p id="22d4" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">排在最前面的电影非常粗糙，主题阴暗，与排在最后面的相比，观众相对较少。谁不爱狮子王(动画那部)？</p><h2 id="84b6" class="kz la ht bd lb lc ld le lf lg lh li lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">因素3——行动/暴力</h2><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ly"><img src="../Images/9eb9e5cb52d5e3fbf598c28477a52468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BkA-G7N-d1G6vzGSklvMHQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">倒数15名</figcaption></figure><figure class="ko kp kq kr fd hk er es paragraph-image"><div class="er es lz"><img src="../Images/5629b4415e8024b88bb6f616b6ea175b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*wUTFknE5l8rlDAz-nY0Lnw.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">前15名</figcaption></figure><p id="f9dd" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">《音乐之声》几乎没有任何暴力，在光谱的另一端，300有血、剑和男人的胸部。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ma"><img src="../Images/c45d1af6be7501f62a9ceb975644bef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWQ5EjxXcZPwuK_fdfrTRQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">因子2和因子3的散点图</figcaption></figure><p id="09ae" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在这张绘制了前50部电影的图表中，我们看到大量的大片都有相当数量的暴力/动作。</p><h1 id="cbb8" class="mb la ht bd lb mc md me lf mf mg mh lj iz mi ja lm jc mj jd lp jf mk jg ls ml bi translated">结论</h1><p id="b363" class="pw-post-body-paragraph jq jr ht js b jt mm iu jv jw mn ix jy jz mo kb kc kd mp kf kg kh mq kj kk kl hb bi translated">我从摆弄模型和解释因素中获得了很多乐趣。真正让我惊讶的是，这个模型是如何在没有任何背景的情况下学习这些因素的，不像人类那样已经拥有广博的世界知识。有些因素我们人类甚至没有意识到，这是令人兴奋的。</p></div></div>    
</body>
</html>