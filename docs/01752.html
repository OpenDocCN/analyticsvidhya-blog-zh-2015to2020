<html>
<head>
<title>Simple Linear Regression with an example using NumPy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨NumPyçš„ç®€å•çº¿æ€§å›å½’ç¤ºä¾‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/simple-linear-regression-with-example-using-numpy-e7b984f0d15e?source=collection_archive---------1-----------------------#2019-11-12">https://medium.com/analytics-vidhya/simple-linear-regression-with-example-using-numpy-e7b984f0d15e?source=collection_archive---------1-----------------------#2019-11-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f97844fec49e8526c1bb257e1f5cf0d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yr6V96fEzRzdbQoE4wU2Ug.jpeg"/></div></div></figure><p id="4761" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ç”¨ä¸€ä¸ªå…³äºé…’ç²¾å’Œå¹¸ç¦ä¹‹é—´å…³ç³»çš„ä¾‹å­æ¥è§£é‡Šæœºå™¨å­¦ä¹ ä¸­çš„ä¸€ä¸ªåŸºæœ¬ç®—æ³•ã€‚</p><p id="7560" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="40d8" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">ä»€ä¹ˆæ˜¯çº¿æ€§å›å½’ï¼Ÿ</h2><p id="4cd7" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">çº¿æ€§å›å½’æ˜¯æ ¹æ®è¿‡å»çš„æ•°æ®æ¨æµ‹æœªæ¥è¾“å‡ºçš„æ•°å­¦æŠ€æœ¯ã€‚</p><p id="e180" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¾‹å¦‚ï¼Œå‡è®¾ä½ æ­£åœ¨è§‚çœ‹ä½ æœ€å–œæ¬¢çš„çƒå‘˜åœ¨ä»Šå¤©çš„æ¯”èµ›ä¸­è¸¢è¶³çƒï¼Œä»–åœ¨ä¸å¯¹æ‰‹çš„æ¯”èµ›ä¸­æœ‰ç€éå¸¸å¥½çš„è®°å½•ï¼Œå¹³å‡æ¯åœºæ¯”èµ›æœ‰2ä¸ªè¿›çƒï¼Œæ ¹æ®ä½ å¤´è„‘ä¸­çš„è¿™ä¸ªç®€å•è®¡ç®—ï¼Œä½ å¯èƒ½å¸Œæœ›ä»–è‡³å°‘å¾—åˆ†2åˆ†æˆ–æ›´å¤šï¼Œæ‰€ä»¥ä½ çš„å¤§è„‘æ‰€åšçš„æ˜¯è®¡ç®—ç®€å•çš„å¹³å‡å€¼ã€‚</p><p id="83f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="kv">å¹³å‡å€¼=ä¸å¯¹æ‰‹çƒé˜Ÿçš„æ€»å¾—åˆ†/ä¸å¯¹æ‰‹çš„æ¯”èµ›æ¬¡æ•°</em> </strong></p><p id="dc6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">çº¿æ€§å›å½’ä¹Ÿä¸æ­¤ç±»ä¼¼ï¼Œä½†æˆ‘ä»¬ä¸æ˜¯å–å¹³å‡å€¼ï¼Œè€Œæ˜¯ä½¿ç”¨è¾“å…¥å˜é‡(x)å’Œç›®æ ‡å˜é‡(y)ä¹‹é—´çš„çº¿æ€§å…³ç³»è¿›è¡Œæ›´å¥½çš„ç»Ÿè®¡çŒœæµ‹ã€‚</p><p id="3524" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ³¨:çº¿æ€§å›å½’ä»…é€‚ç”¨äºè¿ç»­å˜é‡ï¼Œå¦‚é™é›¨é‡ä¸æ¹¿åº¦ã€å¿ƒç‡ä¸è·‘æ­¥é€Ÿåº¦ç­‰ã€‚</p><p id="1e68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®©æˆ‘ä»¬é€šè¿‡åœ¨æµè¡Œçš„æ•°å€¼è®¡ç®—pythonåŒ…NumPyä¸­å®ç°å®ƒæ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="c154" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">ä½¿ç”¨NumPyçš„çº¿æ€§å›å½’</h2><p id="2906" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated"><strong class="is hj">ç¬¬ä¸€æ­¥</strong>:å¯¼å…¥æ‰€æœ‰è®¡ç®—éœ€è¦ç”¨åˆ°çš„åŒ…ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4921" class="jv jw hi lb b fi lf lg l lh li">import pandas as pd<br/>import numpy as np</span></pre><p id="c5f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">ç¬¬äºŒæ­¥</strong>:ä½¿ç”¨pandasåº“è¯»å–è¾“å…¥æ–‡ä»¶ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6351" class="jv jw hi lb b fi lf lg l lh li">data = pd.read_csv('/Users/arunramji/Downloads/Sourcefiles/Alchol_vs_Happiness.csv',',',<br/>                  usecols=['Country','Alcohol','Happiness Score'])</span></pre><p id="3a39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¯¼å…¥çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œ</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="8f4f" class="jv jw hi lb b fi lf lg l lh li">data.head()</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/e6299357075d78909c4f89da29c315fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*nNg-9bZbaLQwOqv0YwDGCw.png"/></div></figure><p id="64b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">æ­¥éª¤3 </strong>:åªè¿‡æ»¤éœ€è¦çš„å˜é‡</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e821" class="jv jw hi lb b fi lf lg l lh li">A = data[['Alcohol','Happiness Score']]<br/>A.tail()</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/6d85805782b47645836b335c60187bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*uTICGYckCYp6xJvwTlhBRA.png"/></div></figure><p id="6891" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">æ­¥éª¤4 </strong>:å°†ç†ŠçŒ«æ•°æ®å¸§è½¬æ¢æˆnumpyæ•°ç»„ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="65ce" class="jv jw hi lb b fi lf lg l lh li">matrix = np.array(A.values,'float')<br/>matrix[0:5,:]    #first 5 rows of data</span><span id="642b" class="jv jw hi lb b fi lk lg l lh li">array([[194.33333333,   7.526     ],<br/>       [188.33333333,   7.509     ],<br/>       [124.        ,   7.501     ],<br/>       [123.        ,   7.498     ],<br/>       [164.33333333,   7.413     ]])</span></pre><p id="a220" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">æ­¥éª¤5 </strong>:è®©æˆ‘ä»¬ä¸ºè¿›ä¸€æ­¥çš„è®¡ç®—åˆ†é…è¾“å…¥å’Œç›®æ ‡å˜é‡ï¼Œxå’Œyã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="1016" class="jv jw hi lb b fi lf lg l lh li">#Assign input and target variable</span><span id="b1ea" class="jv jw hi lb b fi lk lg l lh li">X = matrix[:,0]<br/>y = matrix[:,1]</span></pre><p id="7f9d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">æ­¥éª¤6 </strong> : <em class="kv">ç‰¹å¾</em> <em class="kv">å½’ä¸€åŒ–</em>-è¿™æ˜¯è®¸å¤šMLæ¨¡å‹çš„é‡è¦æ­¥éª¤ä¹‹ä¸€ï¼Œæˆ‘ä»¬å®é™…ä¸Šåšçš„æ˜¯å°†æ‰€æœ‰çš„è¾“å…¥å˜é‡å‹ç¼©åˆ°æ›´å°ä¸”ç›¸ä¼¼çš„é‡çº§ï¼Œä»¥ä¾¿åé¢çš„è®¡ç®—æ›´å¿«æ›´æœ‰æ•ˆã€‚ä¸‹é¢æˆ‘ä»¬æœ‰ä¸€ä¸ªç‰¹å¾æ ‡å‡†åŒ–æŠ€æœ¯ï¼Œä½¿è¾“å…¥å˜é‡xçš„å¤§å°ç›¸ä¼¼ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="44c8" class="jv jw hi lb b fi lf lg l lh li">#feature normalization</span><span id="f522" class="jv jw hi lb b fi lk lg l lh li"># input variable divided by maximum value among input values in X</span><span id="a70b" class="jv jw hi lb b fi lk lg l lh li">X = X/(np.max(X)) <br/></span></pre><p id="0e37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">ç¬¬ä¸ƒæ­¥</strong>:ç”±äºå®ƒæ˜¯ä¸€ä¸ªè¾“å…¥å˜é‡å’Œä¸€ä¸ªè¾“å‡ºå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶2då›¾ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•åˆ†å¸ƒçš„ã€‚è¿™å°†æœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½åœ°ç†è§£æ•°æ®å’Œé—®é¢˜ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="a121" class="jv jw hi lb b fi lf lg l lh li">import matplotlib.pyplot as plt</span><span id="1a9c" class="jv jw hi lb b fi lk lg l lh li">plt.plot(X,y,'bo')<br/>plt.ylabel('Happiness Score')<br/>plt.xlabel('Alcohol consumption')<br/>plt.legend(['Happiness Score'])<br/>plt.title('Alcohol_Vs_Happiness')<br/>plt.grid()<br/>plt.show()</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/2ad67c22e25e5d5136ebcf548c6959ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*Xs5mkYcYnuh_pr-M_XMx7Q.png"/></div></figure><p id="7023" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨å¾ˆæ˜æ˜¾ï¼Œé¥®é…’é‡å’Œå¹¸ç¦æŒ‡æ•°ä¹‹é—´å­˜åœ¨æŸç§å…³è”ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé¥®é…’é‡è¶Šå¤§çš„å›½å®¶è¶Šå¹¸ç¦ï¼ï¼</p><p id="bffb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹è®¡ç®—å‡è®¾ã€‚</p><blockquote class="ll lm ln"><p id="45f6" class="iq ir kv is b it iu iv iw ix iy iz ja lo jc jd je lp jg jh ji lq jk jl jm jn hb bi translated">å‡è®¾æ˜¯ç”¨äºå®šä¹‰ç»™å®šè®­ç»ƒæ ·æœ¬çš„è¿‘ä¼¼ç›®æ ‡å€¼(y)çš„æœ¯è¯­ï¼Œå®ƒå°†ç”±æˆ‘ä»¬çš„MLæ¨¡å‹è®¡ç®—ã€‚</p></blockquote></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="739b" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">å‡è®¾</h2><p id="65ae" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">æˆ‘ä»¬éœ€è¦é€šè¿‡è¯„ä¼°Xå’Œyä¹‹é—´çš„çº¿æ€§å…³ç³»æ¥è®¡ç®—å‡è®¾ï¼Œè¿™é‡Œæ˜¯é…’ç²¾æ¶ˆè€—é‡å¯¹å¹¸ç¦æŒ‡æ•°ã€‚</p><p id="eff4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">é‚£ä¹ˆï¼Œå¯¹äºç»™å®šçš„è¾“å…¥(x ),æˆ‘ä»¬å¦‚ä½•è®¡ç®—å‡è®¾æˆ–è¿‘ä¼¼è¾“å‡ºå€¼(y )?</p><blockquote class="lr"><p id="00ce" class="ls lt hi bd lu lv lw lx ly lz ma jn dx translated">ä¸€ä¸ªæƒ³æ³•æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ•°æ®ä¸Šç»˜åˆ¶ä¸€æ¡ç®€å•çš„çº¿ï¼Œå®ƒä¸å®é™…å€¼çš„åå·®æˆ–è¯¯å·®è¾ƒå°ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥ç”¨æ¥é¢„æµ‹æœªæ¥å€¼ï¼Œè¯¯å·®éå¸¸å°ã€‚</p></blockquote><p id="bb02" class="pw-post-body-paragraph iq ir hi is b it mb iv iw ix mc iz ja jb md jd je jf me jh ji jj mf jl jm jn hb bi translated">æ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°æœ€ä½³çº¿ï¼Œä¸‹é¢æ˜¯æˆ‘ä»¬éœ€è¦è®¡ç®—çš„çº¿æ–¹ç¨‹ã€‚</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/8bfd69710ac734aadec8728e24e73326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5mlab7EPIjL9nwJ077Pzcg.jpeg"/></div></div></figure><p id="b162" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬ä»æ ·æœ¬æ•°æ®ä¸­çŸ¥é“xï¼Œyçš„å€¼ï¼Œä½¿ç”¨è¯¥å€¼ï¼Œæˆ‘ä»¬å¿…é¡»è®¡ç®—æœ€ä½³Î¸0å’ŒÎ¸1ï¼Œè¿™å…·æœ‰æœ€å°çš„è¯¯å·®æˆæœ¬æ¥ç»˜åˆ¶çº¿æ€§æ‹Ÿåˆã€‚</p><blockquote class="ll lm ln"><p id="3b66" class="iq ir kv is b it iu iv iw ix iy iz ja lo jc jd je lp jg jh ji lq jk jl jm jn hb bi translated">æˆæœ¬æˆ–SSE(è¯¯å·®å¹³æ–¹å’Œ)æ˜¯æˆ‘ä»¬çš„å‡è®¾å’Œå®é™…æ•°æ®ç‚¹ä¹‹é—´çš„å·®å¼‚</p></blockquote><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/55cd498d50d29451e473bbdf96c50f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C7X_jFIxR0lV_ywWWhzkzw.jpeg"/></div></div></figure><p id="749a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">ç¬¬8æ­¥</strong>:è®©æˆ‘ä»¬å®šä¹‰è®¡ç®—æˆæœ¬æˆ–SSEçš„å‡½æ•°ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="5860" class="jv jw hi lb b fi lf lg l lh li">def computecost(x,y,theta):<br/>    <br/>    a = 1/(2*m)<br/>    b = np.sum(((x@theta)-y)**2)<br/>    j = (a)*(b)<br/>    return j</span></pre><p id="acd5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">ç¬¬9æ­¥</strong>:åœ¨æˆ‘ä»¬ç°æœ‰çš„çŸ©é˜µXä¸­é™„åŠ ä¸€ä¸ªx0é¡¹ï¼Œä¸ºäº†æ•°å­¦ä¸Šçš„æ–¹ä¾¿ï¼Œx0çš„å€¼åº”è¯¥æ˜¯â€˜1â€™ã€‚</p><p id="9ca6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¹¶å°†ä¸€äº›åˆå§‹Î¸æŒ‡å®šä¸º0ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="391b" class="jv jw hi lb b fi lf lg l lh li">#initialising parameter</span><span id="2463" class="jv jw hi lb b fi lk lg l lh li">m = np.size(y)<br/>X = X.reshape([122,1])<br/>x = np.hstack([np.ones_like(X),X])</span><span id="3c75" class="jv jw hi lb b fi lk lg l lh li">theta = np.zeros([2,1])</span><span id="0ac2" class="jv jw hi lb b fi lk lg l lh li">print(theta,'\n',m)</span><span id="e716" class="jv jw hi lb b fi lk lg l lh li">[[0.]<br/> [0.]] <br/> 122</span></pre><p id="0fae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®©æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹å¦‚æœÎ¸ä¸º0ï¼Œæˆæœ¬æ˜¯å¤šå°‘ï¼Œ</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="b36c" class="jv jw hi lb b fi lf lg l lh li">print(computecost(x,y,theta))</span><span id="df41" class="jv jw hi lb b fi lk lg l lh li">1941.7825705000002</span></pre><p id="30a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¿›ä¸€æ­¥é™ä½è¿™ä¸ªæˆæœ¬J(theta)å€¼ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å®ç°æ•°æ®çš„æœ€ä½³çº¿æ€§æ‹Ÿåˆã€‚</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="f8b4" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">æ¢¯åº¦ä¸‹é™</h2><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/cf07e3ef802db937f7865e9f5862ea3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*15DDrvDIlV0otIZ5J375cw.gif"/></div></figure><p id="eeb0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§è¿™æ ·çš„ç®—æ³•ï¼Œç”¨äºä½¿ç”¨ç»™å®šçš„å‚æ•°æ‰¾åˆ°æœ€ä½³å‚æ•°â€œÎ¸â€,</p><p id="a51b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">x â€”è¾“å…¥å€¼</p><p id="59c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">y-è¾“å‡ºå€¼</p><p id="b3ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Initial_theta â€”å¤§å¤šæ•°æƒ…å†µä¸‹ä¸ºç©ºtheta</p><p id="f69d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">alpha â€”æ¸å˜æŒ‡é’ˆä¸‹é™åˆ°æœ€ä½³å€¼çš„é€Ÿç‡</p><p id="e936" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿­ä»£â€”â€”è®¾ç½®åº”è¯¥è¿›è¡Œå¤šå°‘æ¬¡è¿­ä»£</p><p id="8f14" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç†è§£â€œGradinet Desecndâ€å¯èƒ½éœ€è¦ä¸€ç‚¹å¾®ç§¯åˆ†ï¼Œä½†æ²¡æœ‰å¿…è¦å®ç°å’Œä½¿ç”¨å®ƒæ¥è§£å†³MLé—®é¢˜ã€‚äº†è§£ä¸Šè¿°å‚æ•°çš„ä½œç”¨å¯¹äºå®æ–½æ¥è¯´é€šå¸¸å°±è¶³å¤Ÿäº†ã€‚</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/a119fe52a65f06c421313c6b631fa944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oP5t82nztvWP14p4nplWYQ.jpeg"/></div></div></figure><p id="7f46" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">ç¬¬åæ­¥</strong>:å®šä¹‰æ¢¯åº¦ä¸‹é™ç®—æ³•çš„å‡½æ•°ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="020f" class="jv jw hi lb b fi lf lg l lh li">def gradient(x,y,theta):<br/>    <br/>    alpha = 0.00001<br/>    iteration = 2000</span><span id="7d19" class="jv jw hi lb b fi lk lg l lh li">#gradient descend algorithm<br/>    J_history = np.zeros([iteration, 1]);</span><span id="2a5e" class="jv jw hi lb b fi lk lg l lh li">for iter in range(0,2000):<br/>        <br/>        error = (x @ theta) -y<br/>        temp0 = theta[0] - ((alpha/m) * np.sum(error*x[:,0]))<br/>        temp1 = theta[1] - ((alpha/m) * np.sum(error*x[:,1]))<br/>        theta = np.array([temp0,temp1]).reshape(2,1)<br/>        J_history[iter] = (1 / (2*m) ) * (np.sum(((x @ theta)-y)**2))   #compute J value for each iteration <br/>    return theta, J_history</span></pre><p id="0c67" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨è®©æˆ‘ä»¬å¯¹æ•°æ®ä½¿ç”¨æ¢¯åº¦å‡½æ•°ï¼Œ</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e973" class="jv jw hi lb b fi lf lg l lh li">theta , J = gradient(x,y,theta)<br/>print(theta)</span><span id="8070" class="jv jw hi lb b fi lk lg l lh li">[[4.22499706]<br/> [2.38031097]]</span></pre><p id="9615" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å¾—åˆ°äº†ç”¨æ¢¯åº¦ä¸‹é™æ³•è®¡ç®—çš„æœ€ä¼˜Î¸ï¼Œä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆèƒ½ç¡®å®šè¿™å°±æ˜¯æœ€ä¼˜Î¸å‘¢ï¼Œä½¿ç”¨computecostå‡½æ•°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="63cb" class="jv jw hi lb b fi lf lg l lh li">theta , J = gradient(x,y,theta)<br/>print(J)<br/></span><span id="0d6d" class="jv jw hi lb b fi lk lg l lh li">array([[1936.24274283],<br/>       [1930.71941566],<br/>       [1925.21254022],<br/>       ...,<br/>       [ 115.49668262],<br/>       [ 115.49460323],<br/>       <strong class="lb hj">[ 115.49255932]</strong>])</span></pre><p id="4d69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆæœ¬æˆ–SSEå€¼ä¸º115.42ï¼Œæ¯”Î¸= 0æ—¶è®¡ç®—çš„1941.78å¥½å¾—å¤š</p><p id="9e41" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç¬¬11æ­¥:ç°åœ¨è®©æˆ‘ä»¬åœ¨æ•°æ®ä¸Šç”»çº¿ï¼Œçœ‹çœ‹å®ƒä¸æ•°æ®çš„å»åˆç¨‹åº¦ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="9faf" class="jv jw hi lb b fi lf lg l lh li">#plot linear fit for our theta<br/>plt.plot(X,y,'bo')<br/>plt.plot(X,x@theta,'-')<br/>plt.axis([0,1,3,7])<br/>plt.ylabel('Happiness Score')<br/>plt.xlabel('Alcohol consumption')<br/>plt.legend(['HAPPY','LinearFit'])<br/>plt.title('Alcohol_Vs_Happiness')<br/>plt.grid()<br/>plt.show()</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/add828abaac3748d162072d6b90143b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*3C6aaC7oUfAQ9mKL7-ENGw.png"/></div></figure><p id="b265" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¯¹äºç»™å®šçš„æ•°æ®æ ·æœ¬ï¼Œè¿™ä¼¼ä¹æ˜¯åˆç†çš„ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªçº¿æ€§æ‹Ÿåˆæ¥è®¡ç®—æ–°çš„æœªçŸ¥è¾“å…¥å€¼xã€‚</p><p id="eef2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">æ­¥éª¤12 </strong>:è®©æˆ‘ä»¬é¢„æµ‹æ–°çš„è¾“å…¥å€¼ğŸ˜ƒ</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="5582" class="jv jw hi lb b fi lf lg l lh li">predict1 = [1,(164/np.max(matrix[:,0]))] @ theta #normalising the input value, 1 is for intercept term so not need to normalise</span><span id="c8a8" class="jv jw hi lb b fi lk lg l lh li">print(predict1)</span><span id="2dd6" class="jv jw hi lb b fi lk lg l lh li">[<strong class="lb hj">5.98606924</strong>]</span></pre></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="bfff" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated"><strong class="ak">å¥–åŠ±è¯´æ˜</strong>:</h2><p id="88e5" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">è¿˜æœ‰ä¸€äº›å…¶ä»–æ–¹æ³•å¯ä»¥ç¡®å®šæ¢¯åº¦ä¸‹é™æ˜¯å¦æœ‰æ•ˆï¼Œå…¶ä¸­ä¸€ç§æ˜¯ç»˜åˆ¶æ¯æ¬¡è¿­ä»£çš„J(theta ),å¹¶æŸ¥çœ‹å€¼å¦‚ä½•å˜åŒ–ï¼Œå¦‚æœJå€¼åœ¨æ¯æ¬¡è¿­ä»£ä¸­å‡å°‘ï¼Œè¿™å¾ˆå¥½ï¼Œä½†å¦‚æœå®ƒå¢åŠ ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç®—æ³•æˆ–æ•°æ®ä¸€å®šæœ‰é—®é¢˜ã€‚</p><p id="c664" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="2d15" class="jv jw hi lb b fi lf lg l lh li">#visualising J (theta0 , theta1)</span><span id="0939" class="jv jw hi lb b fi lk lg l lh li">theta0_vals = np.linspace(-5,10,100).reshape(1,100)<br/>theta1_vals = np.linspace(-5,10,100).reshape(1,100)</span><span id="f26e" class="jv jw hi lb b fi lk lg l lh li">#initialise J value to matrix of 0<br/>J_vals = np.zeros([np.size(theta0_vals),np.size(theta1_vals)])</span><span id="c05c" class="jv jw hi lb b fi lk lg l lh li">#fill J_vals<br/>for i in range(0,np.size(theta0_vals)):<br/>    for j in range(0,np.size(theta1_vals)):<br/>        t = np.array([theta0_vals[:,i],theta1_vals[:,j]])<br/>        J_vals[i,j] = computecost(x,y,t)</span><span id="cb28" class="jv jw hi lb b fi lk lg l lh li"># Because of the way meshgrids work in the surf command, we need to<br/># transpose J_vals before calling surf, or else the axes will be flipped<br/>J_vals = J_vals.T</span></pre><p id="23d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨æˆ‘ä»¬æ¥å‡ºå›¾ã€‚</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="0d98" class="jv jw hi lb b fi lf lg l lh li">#surface plot for covergence<br/>from mpl_toolkits.mplot3d import Axes3D <br/>fig = plt.figure(figsize=[12.0,8.0])<br/>ax = fig.add_subplot(111,projection ='3d')<br/>ax.plot_surface(theta0_vals,theta1_vals,J_vals)<br/>ax.set_xlabel('theta0')<br/>ax.set_ylabel('theta1')<br/>ax.set_zlabel('J_vals')</span><span id="54cb" class="jv jw hi lb b fi lk lg l lh li">plt.show()</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/2b1c87a2fe578d00b882dd6bbc2dfc40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QezLtM7JIi_Vd6mF9CTsrQ.png"/></div></div></figure><p id="caa2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ›²é¢åœ¨Î¸0â†’4å’ŒÎ¸1â†’2é™„è¿‘æ”¶æ•›ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¯´è®¡ç®—çš„å‚æ•°æ˜¯åˆç†çš„ã€‚</p><h2 id="20bd" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated">ç»“è®º</h2><p id="2bf8" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">æ‰€è§£é‡Šçš„çº¿æ€§å›å½’æŠ€æœ¯æ˜¯é¢„æµ‹è¿ç»­å˜é‡çš„å¸¸ç”¨å»ºæ¨¡æŠ€æœ¯ï¼Œé‚£ä¹ˆå®ƒå¯¹å„ç§æ•°æ®éƒ½æœ‰æ•ˆå—ï¼Ÿè¿™ä¸€ç‚¹æˆ‘ä»¬æ— æ³•ç¡®å®šï¼Œä½†åªè¦æˆ‘ä»¬äº†è§£æ•°æ®å’Œé—®é¢˜ï¼Œçº¿æ€§å›å½’è‚¯å®šä¼šä¸ºæœªçŸ¥å’Œæ–°çš„è¾“å…¥å€¼æä¾›è‰¯å¥½çš„ç»Ÿè®¡çŒœæµ‹ã€‚</p><blockquote class="lr"><p id="657a" class="ls lt hi bd lu lv lw lx ly lz ma jn dx translated">ä¸ºäº†æ›´å¥½çš„æœªæ¥ç»§ç»­åŠªåŠ›ï¼ï¼</p></blockquote></div></div>    
</body>
</html>