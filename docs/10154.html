<html>
<head>
<title>XGBoost Classifier Hand Written Digit recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">XGBoost 分类器手写数字识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/xgboost-classifier-hand-written-digit-recognition-219acedfef13?source=collection_archive---------7-----------------------#2020-10-07">https://medium.com/analytics-vidhya/xgboost-classifier-hand-written-digit-recognition-219acedfef13?source=collection_archive---------7-----------------------#2020-10-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8897" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要开始使用 XGBoost，首先我们必须安装 XGBoost 库包。我们可以用“pip”或“conda”来做。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="95b4" class="jm jn hi ji b fi jo jp l jq jr">pip install xgboost</span></pre><p id="aff9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将关注如何使用 XGBoost 创建您的第一个模型(分类器)。</p><p id="27d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们为这个例子选择的数据集是手写数字数据集，它在 sklearn 预加载的数据集中很容易获得。为了导入数据集，我们使用代码:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c73a" class="jm jn hi ji b fi jo jp l jq jr">from sklearn import datasets<br/>digits = datasets.load_digits()</span></pre><p id="3289" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">digits 对象中有“images”和“target”属性。</p><p id="8dd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些图像是 8×8 维的二维阵列，每个阵列代表一个手写数字图像。由于该图像只有 8×8 = 64 像素，因此它是一个分辨率相当低的图像。<br/>目标属性具有图像的标签，即如果图像[0]表示数字“4 ”,则相应的目标具有值“4”。</p><p id="51dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的问题陈述是从给定的 8×8 像素图像中正确识别手写数字。<br/>我们有 10 个目标类别(数字 0 到 9)</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b3eb" class="jm jn hi ji b fi jo jp l jq jr">images=digits.images</span><span id="afcd" class="jm jn hi ji b fi js jp l jq jr">print(images[0])</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es jt"><img src="../Images/c0ef4a35b0487b0ad7f15cea63ca5ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*m28QK9x6EgiPDbUibn1FaA.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">代表手写数字的 2D 数组</figcaption></figure><p id="2b5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更好的可视化，我们使用 matplot 库。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="d224" class="jm jn hi ji b fi jo jp l jq jr">import matplotlib.pyplot as plt<br/>plt.imshow(images[0],cmap='binary',interpolation='nearest')</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kb"><img src="../Images/1d929b1e71a51f11d555167c74cf036b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*JDy6Zt4FOUUymkLjkyTAew.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">图像[0]</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="ae0c" class="jm jn hi ji b fi jo jp l jq jr">targets=digits.target<br/>print(targets[0])</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kc"><img src="../Images/18ca77c2bfcc2c3b35a1515a11560ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*7OgQtTX-KTDgtW9sIDai-w.png"/></div></figure><p id="3b9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">load_digits 数据集有 1797 条记录。出于训练和验证的目的，我们必须将数据集分成训练集和测试集。<br/>我们拥有的图像对象是 3D 数组，这很难处理，<br/>所以为了方便起见，我们将其转换成 2D 数组数据集。<br/>也就是说，现在每个图像都用 2D 数组表示，我们将每一行添加到前一行的末尾，使其成为一行，从而将其更改为 1D 数组。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="6e06" class="jm jn hi ji b fi jo jp l jq jr">images=images.reshape(1797,8*8)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kd"><img src="../Images/3bd45a421888da36708786eeb6b1e922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*fBH4LcsD-3XMdZ3iF6kQAg.png"/></div></figure><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es ke"><img src="../Images/a3107c8e72fb408a2862abc0ef3728a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*ta8f-CSbfQRNOQeeybWwXg.png"/></div></figure><p id="9489" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们的数据集是二维的，形状为:</p><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kf"><img src="../Images/b7329bd093bb4a391841e6ce27b510f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*89DhrXE6ljRV6teidTvCbw.png"/></div></figure><p id="4882" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的数据集中有 1797 个展平的图像，我们使用 train_test_split 方法将它们分成训练集和测试集。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="867d" class="jm jn hi ji b fi jo jp l jq jr">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(images, targets, test_size=0.2)</span></pre><p id="50ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们创建一个 XGBoost 类的对象，并根据我们的训练数据拟合模型。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c8cd" class="jm jn hi ji b fi jo jp l jq jr">from xgboost import XGBClassifier<br/>model = XGBClassifier()<br/>model.fit(X_train, y_train)</span></pre><p id="b206" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了进行预测，我们称之为预测方法。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8d6d" class="jm jn hi ji b fi jo jp l jq jr">y_pred=model.predict(X_test)</span></pre><p id="c3c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型的准确性可以如下测试，</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="816a" class="jm jn hi ji b fi jo jp l jq jr">from sklearn.metrics import accuracy_score<br/>accuracy = accuracy_score(y_test, y_pred)<br/>print("Accuracy: %.2f%%" % (accuracy * 100.0))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kg"><img src="../Images/83487c47903149f3f9f81cab014de37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*AQPOJo3-nx_IZMDZWQn0qQ.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">此数据集上未调整的 XGBClassifier 的准确性</figcaption></figure><p id="a41f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为这个多类分类问题获得的混淆矩阵是，</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2b27" class="jm jn hi ji b fi jo jp l jq jr">from sklearn.metrics import confusion_matrix<br/>confusion = confusion_matrix(y_test, y_pred)<br/>print('Confusion Matrix\n')<br/>print(confusion)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kh"><img src="../Images/a458695ef682cf2aa259ad984e92c9b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*RsFaW2Slp-S6QQXMmnyt4A.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">行从左边(0 到 9)开始标记，列从上到下(0 到 9)开始标记</figcaption></figure><p id="933b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">沿着对角线的数字显示正确的预测，所有其他地方显示不正确的预测。<br/>考虑位置行:0 和列:5，它具有值 1，它表示对于一个实例，数字“0”被错误地预测为“5”。</p><p id="0a61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过参考 xgboost 文档更改 XGBClassifier 中的参数，可以对模型进行微调。</p><div class="ki kj ez fb kk kl"><a href="https://xgboost.readthedocs.io/en/latest/python/python_api.html?highlight=xgbclassifier#xgboost.XGBClassifier" rel="noopener  ugc nofollow" target="_blank"><div class="km ab dw"><div class="kn ab ko cl cj kp"><h2 class="bd hj fi z dy kq ea eb kr ed ef hh bi translated">Python API 参考-xgboost 1 . 3 . 0-快照文档</h2><div class="ks l"><h3 class="bd b fi z dy kq ea eb kr ed ef dx translated">本页给出了 xgboost 的 Python API 参考，更多内容请参考 Python 包介绍…</h3></div><div class="kt l"><p class="bd b fp z dy kq ea eb kr ed ef dx translated">xgboost.readthedocs.io</p></div></div></div></a></div><p id="9a41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述示例的完整代码:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="aaf6" class="jm jn hi ji b fi jo jp l jq jr">from sklearn import datasets<br/>import matplotlib.pyplot as plt<br/>from xgboost import XGBClassifier<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import accuracy_score</span><span id="ba35" class="jm jn hi ji b fi js jp l jq jr">digits = datasets.load_digits()</span><span id="4e88" class="jm jn hi ji b fi js jp l jq jr">images=digits.images<br/>targets=digits.target</span><span id="958f" class="jm jn hi ji b fi js jp l jq jr">X_train, X_test, y_train, y_test = train_test_split(images, targets, test_size=0.2)</span><span id="24b8" class="jm jn hi ji b fi js jp l jq jr">model = XGBClassifier()<br/>model.fit(X_train, y_train)</span><span id="72b9" class="jm jn hi ji b fi js jp l jq jr">y_pred=model.predict(X_test)</span><span id="21ff" class="jm jn hi ji b fi js jp l jq jr">accuracy = accuracy_score(y_test, y_pred)<br/>print("Accuracy: %.2f%%" % (accuracy * 100.0))</span><span id="be66" class="jm jn hi ji b fi js jp l jq jr">from sklearn.metrics import confusion_matrix<br/>confusion = confusion_matrix(y_test, y_pred)<br/>print('Confusion Matrix\n')<br/>print(confusion)</span></pre><h1 id="f923" class="ku jn hi bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">谢谢大家！</h1></div></div>    
</body>
</html>