<html>
<head>
<title>NHTSA Fatality Analysis (Bagging, Boosting, Voting) Classification Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NHTSA 死亡分析(装袋、助推、投票)分类模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/nhtsa-fatality-analysis-bagging-boosting-voting-classification-models-577775524045?source=collection_archive---------21-----------------------#2020-09-13">https://medium.com/analytics-vidhya/nhtsa-fatality-analysis-bagging-boosting-voting-classification-models-577775524045?source=collection_archive---------21-----------------------#2020-09-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/14c99074289a309843d097e75f78115c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q3fSljbICqqg1ZQRb4AXBw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://www.nhtsa.gov/equipment/takata-recall-spotlight" rel="noopener ugc nofollow" target="_blank">https://www.nhtsa.gov/equipment/takata-recall-spotlight</a></figcaption></figure><p id="ca97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di">在</span>统计中，分类是根据包含类别成员已知的观察值的训练数据集，识别一个新观察值属于哪一组类别的问题。<a class="ae iu" href="https://en.wikipedia.org/wiki/Statistical_classification" rel="noopener ugc nofollow" target="_blank">维基</a>。<br/>数据科学家的工作是确定用于训练模型的正确特征，选择最适合数据的正确模型，最后根据最重要的指标得出结论。</p><h1 id="3ea7" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">关于项目:</h1><p id="10e4" class="pw-post-body-paragraph iv iw hi ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hb bi translated">这是我通过美国国家公路交通安全管理局<a class="ae iu" href="https://www.nhtsa.gov/" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">【NHTSA】</strong></a><strong class="ix hj"/>提供的关于 2018 年发生的死亡事故<strong class="ix hj"> </strong>的数据做的一个研究，用来预测醉酒司机卷入车祸的可能性。<br/>这个项目最重要的目标之一是使用亚马逊 Web 服务<strong class="ix hj"> (AWS) </strong>构建模型，运行 Jupyter 笔记本，并将 PostgreSQL 数据库存储在一个<strong class="ix hj"> </strong>弹性计算云<strong class="ix hj"> (EC2) </strong>实例<em class="lf">(阅读我之前的</em> <a class="ae iu" rel="noopener" href="/analytics-vidhya/configure-amazon-ec2-to-run-postgresql-anaconda-and-jupyter-notebook-eefc0785a71f"> <strong class="ix hj"> <em class="lf">博客</em> </strong> </a> <em class="lf">)。</em> <br/>从简单的探索性数据分析开始<strong class="ix hj"> (EDA) </strong>去扔标签编码，数据清理，用过采样的方法用不平衡的目标列拨号，最后，寻找完美的模型。</p></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><h1 id="5a2c" class="kc kd hi bd ke kf ln kh ki kj lo kl km kn lp kp kq kr lq kt ku kv lr kx ky kz bi translated">循序渐进:</h1><h2 id="0e34" class="ls kd hi bd ke lt lu lv ki lw lx ly km jg lz ma kq jk mb mc ku jo md me ky mf bi translated">1-从寻找比 Kaggle 更好的数据源开始:</h2><p id="8ad5" class="pw-post-body-paragraph iv iw hi ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hb bi translated">如果我只依赖 Kaggle 的数据集，我会留下一些可以追溯到(2015 年)的旧数据。<br/>在做了一些研究后，我找到了 NHTSA 数据的真正来源，并获得了更近的数据(2018 年)，由于数据本身不够，我不得不在同一网站上寻找其文档<strong class="ix hj"> BAAM </strong>(已完成)。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/ab530b79a8cb06d79a55e9e6104ec12c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwi1tewe2uRELwew0HyhzQ.png"/></div></div></figure></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><h2 id="97d8" class="ls kd hi bd ke lt lu lv ki lw lx ly km jg lz ma kq jk mb mc ku jo md me ky mf bi translated">2-将数据加载到 PostgreSQL 并创建关联视图:</h2><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/bca751ead8f3c0650d65fac26ad3cc65.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*VwZAdCbKjWlxRrr0P_JpTg.png"/></div></figure><p id="dd01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在对数据进行总体概述后，根据右图，我决定从 27 个可用表中选择 3 个<strong class="ix hj">(事故、车辆、人员)</strong>由于有了数据文档，我能够确定哪些功能易于使用。<br/>由于表之间存在(一对多)的关系，我需要找到一种方法将特性聚集到一行中，以适应模型。<br/>我必须删除不可聚合的功能。人员表中没有可聚合的特征，但我计算了每辆车中男性和女性的数量。从车辆表中，我决定用合适的聚合方法获取图片中显示的特征。最后创建连接视图。</p></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><h2 id="4eb3" class="ls kd hi bd ke lt lu lv ki lw lx ly km jg lz ma kq jk mb mc ku jo md me ky mf bi translated">3-探索性数据分析(EDA):</h2><ul class=""><li id="7a69" class="mm mn hi ix b iy la jc lb jg mo jk mp jo mq js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">探索目标变量:</em> </strong> <br/>在查看目标变量后，我发现它包含值<strong class="ix hj"> (0，1，2，3，4) </strong>，该值表示涉及的醉酒人数，因此，如果我想将此列用作目标变量，我必须映射大于一对一的值<strong class="ix hj">(不平衡哈)。</strong></li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/9ea3e316032ffe700d49d23e00f79216.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*PdxL7VgiXKfmP-_SppMnRQ.png"/></div></figure><ul class=""><li id="289f" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">以月份为单位探究事故:<br/> </em> </strong>因饮酒事件而发生的事故数量正在向夏季上升，这可以合理得多<strong class="ix hj">(通宵派对)。</strong></li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/673023e7b1fdf87c5d6a59237f98775b.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*YkmVqI2LPBLomCvBszrBJw.png"/></div></figure><ul class=""><li id="7a09" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">使用地理地图探索事故:<br/> </em> </strong>查看左边的图表，您可以看到新年当天<strong class="ix hj">美国</strong>各州的事故地点分布，而右边的照片描述了 2018 年各州的事故数量<strong class="ix hj">(得克萨斯州和佛罗里达州的事故数量最多)</strong>。</li></ul><div class="mh mi mj mk fd ab cb"><figure class="na ij nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/b38a12016ca838430d97fcc224e3bcbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*zDlWmaHByZA0AyF8MXg0Gw.png"/></div></figure><figure class="na ij ng nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/bdb5b7af8a77395ce75f38d90ab171b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*lTAq22B1_WwK60jr04M1pQ.png"/></div></figure></div></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><h2 id="c799" class="ls kd hi bd ke lt lu lv ki lw lx ly km jg lz ma kq jk mb mc ku jo md me ky mf bi translated">4-不平衡标签取样方法:</h2><ul class=""><li id="137d" class="mm mn hi ix b iy la jc lb jg mo jk mp jo mq js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">训练不变:<br/> </em> </strong>首先我试图寻找一个最好的模型，它可以在不使用任何类别不平衡方法的情况下给我最好的结果(<strong class="ix hj">随机森林分类器是赢家)。<br/> </strong>经过交叉验证，我得到的准确率是:0.78</li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nh"><img src="../Images/06e844288f0f475c99590d4a4bb096ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*lnIn_m6YlE5pg6F-ckBmvg.png"/></div></figure><div class="mh mi mj mk fd ab cb"><figure class="na ij ni nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ba570035145d6102e213e203db53e3c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*xcsxbNLsRIb-FXxCzKjtlw.png"/></div></figure><figure class="na ij nj nc nd ne nf paragraph-image"><img src="../Images/219c9b15d490b50dcfae271f40182156.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*rOg1lP_AEfpglmaeK7u5mQ.png"/></figure></div><ul class=""><li id="9c5e" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">训练用随机结束采样器:</em> </strong></li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nk"><img src="../Images/d7bb8d8385ffffccff92ca0e8e310bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*LPr3VhGyljM9X0EiGkX-0w.png"/></div></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nl"><img src="../Images/76bb591efdc19b193c2201e1713d208b.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*RKpA0MWjLEP3oXCBw6OKdA.png"/></div></figure><ul class=""><li id="06a1" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">用 SMOTE 训练:</em> </strong></li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nm"><img src="../Images/8ea872f22eab2d48b7ec3c36ddb94417.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*gjbXogcnQ1ugTkLjF7maEQ.png"/></div></div></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nn"><img src="../Images/ea743feb4699c5972f5c6bb3c801c970.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*94SYRTrefzYzOGYlz0lE1g.png"/></div></figure><ul class=""><li id="5cd9" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">用 ADASYN 训练:</em> </strong></li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es no"><img src="../Images/f16e3367362e67c83413b948ccf56639.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*2IllFstMaFT5PmG-dklwkQ.png"/></div></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es np"><img src="../Images/3d248c5def9b21ab45a59808536f4c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*Q3gwu3Ko8ebjXpKXXOjUFQ.png"/></div></figure><ul class=""><li id="0e06" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">用 SMOTETOMEK 训练:</em> </strong></li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nq"><img src="../Images/b9aba41d99d7e624cef8ff0c8f2f95ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*-y3J5jt_ZeR7nt6tmk2ofg.png"/></div></div></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nr"><img src="../Images/c81f23aa9ad881ce997e314783914ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*lwxv3OzcG5gZXjI8Wpto_w.png"/></div></figure><ul class=""><li id="c1e7" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js mr ms mt mu bi translated"><strong class="ix hj"> <em class="lf">用 SMOTEENN: </em> </strong>训练</li></ul><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nk"><img src="../Images/2e75672473fae26f68e80957dcd9356a.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*jzaFIP9tiJrOfNzOnYaEyQ.png"/></div></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nr"><img src="../Images/93e0cc16f0ff04c4f3a04600716ff325.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*ukZ40xxLM-jPsY38xv5ppQ.png"/></div></figure></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><h2 id="61da" class="ls kd hi bd ke lt lu lv ki lw lx ly km jg lz ma kq jk mb mc ku jo md me ky mf bi translated">5-使用投票的培训:</h2><p id="4f98" class="pw-post-body-paragraph iv iw hi ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hb bi translated">我使用了之前最成功的 5 个模型:</p><ol class=""><li id="913a" class="mm mn hi ix b iy iz jc jd jg mw jk mx jo my js ns ms mt mu bi translated">随机森林分类器。</li><li id="74b0" class="mm mn hi ix b iy nt jc nu jg nv jk nw jo nx js ns ms mt mu bi translated">GradientBoostingClassifier。</li><li id="bb11" class="mm mn hi ix b iy nt jc nu jg nv jk nw jo nx js ns ms mt mu bi translated">AdaBoostClassifier。</li><li id="8a6d" class="mm mn hi ix b iy nt jc nu jg nv jk nw jo nx js ns ms mt mu bi translated">XGBClassifier。</li><li id="fdef" class="mm mn hi ix b iy nt jc nu jg nv jk nw jo nx js ns ms mt mu bi translated">树外分类器。</li></ol><p id="9807" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">权重=[5，4，3，2，1]</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es ny"><img src="../Images/07199854a006d7a9e59953a27c4e351d.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*9LTHpc8P8S06DPokEIap4Q.png"/></div></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es ny"><img src="../Images/201ecf9b3c28a31800772828307806c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*s2u3VAM2YlwIPJMpt9h3EA.png"/></div></figure><h1 id="4a90" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">最终结果:</h1><p id="c399" class="pw-post-body-paragraph iv iw hi ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hb bi translated">在比较了使用不同过采样方法的随机森林分类器的交叉验证结果后，我注意到<strong class="ix hj"> SMOTEENN </strong>方法是最适合我的方法！！！</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nz"><img src="../Images/7333860a09afc6fba2f3d860fee98ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*j8ja305bgYbAadFnvYoL1w.png"/></div></figure></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><h1 id="2e0d" class="kc kd hi bd ke kf ln kh ki kj lo kl km kn lp kp kq kr lq kt ku kv lr kx ky kz bi translated">在以下位置找到我:</h1><p id="3dc1" class="pw-post-body-paragraph iv iw hi ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hb bi translated">https://www.linkedin.com/in/yamenshaban/<br/><strong class="ix hj">GitHub:</strong><a class="ae iu" href="https://github.com/yamenkaba" rel="noopener ugc nofollow" target="_blank">https://github.com/yamenkaba</a></p></div></div>    
</body>
</html>