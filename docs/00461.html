<html>
<head>
<title>Deploy Azure Automated Machine learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署Azure自动化机器学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploy-azure-automated-machine-learning-61501b43b080?source=collection_archive---------0-----------------------#2019-06-30">https://medium.com/analytics-vidhya/deploy-azure-automated-machine-learning-61501b43b080?source=collection_archive---------0-----------------------#2019-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a973" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我之前的故事是关于如何轻松地创建模型。自动机器学习通过运行多种算法并找到最佳算法，使数据科学变得非常容易。我们还看到所有的模型都展示出来了，每个模型都可以下载成pickle文件。下面是部署该模型的概述步骤</p><ol class=""><li id="c672" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">部署最佳模型</li><li id="8ef7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">注册模型，下载分数文件，下载Conda环境文件</li><li id="9efd" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">创建图像并上传到容器注册表</li><li id="33b5" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">创建部署以部署到Azure Kubernetes群集。</li><li id="f774" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">测试score REST API</li></ol><p id="f7b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，现在让我们进入细节。</p><p id="ba7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:创建一个至少有12个内核的Azure Kubernetes集群。</p><p id="20c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.部署最佳模型:一旦自动机器学习运行完成，看看这些模型，看看它们的性能。应该有一个图标下载最好的模型，也部署最好的模型。</p><p id="9ac8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.模型注册:一旦点击部署模型，一个新的窗口打开。屏幕将显示4个选项。首先是注册模型。接下来下载计分python文件。接下来下载用于创建docker映像的conda环境文件。一旦我们有了必要的文件，让我们开始创建模型。创建一个模型是使用上传pickle文件，然后评分和conda环境文件。现在，您应该看到在模型部分创建了一个模型。</p><p id="cf40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.创建图像:现在是时候去模型，选择模型，并创建一个图像。上传评分和conda环境文件，然后提交以创建图像。当图像被创建时，将被存储在由机器学习工作空间创建的Azure容器注册表中。</p><p id="0bfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在我们创建部署之前，转到“Compute ”,创建一个新的计算，给出一个名称，并在下拉列表中选择AKS作为计算目标。然后选择您之前创建的至少具有12个内核的AKS集群。将AKS群集连接到计算目标需要几分钟时间。等到状态显示成功。</p><p id="db20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.创建部署:一旦计算目标准备就绪，映像和模型也准备就绪(您可以转到映像并查看状态，应该显示成功)。转到部署部分或转到映像并选择映像，然后单击创建部署。输入一个名称，然后选择运行计分休息API的计算目标。如果需要，可以看看高级配置。然后单击“create ”,这需要几分钟时间来完成部署。部署完成后，屏幕会显示关于部署的详细信息，如REST API的URL和密码以及计算资源的分配。</p><p id="e248" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.测试score REST API:一旦部署成功，现在就该测试REST API了。我们可以使用chrome中的postman或者高级REST客户端来测试REST API。确保我们将POST称为动词。从部署中复制URL，并将其粘贴到工具中。创建2个标头，一个用于授权和内容类型。授权是对服务进行身份验证的关键，这个关键可以在部署部分的REST API的部署细节页面中找到。这是授权样本的样本</p><p id="dd0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">授权持有人<key>用部署细节中的主密钥或二级密钥替换<key>。</key></key></p><p id="4c5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">内容型应用程序/json这是非常常见的一种。</p><p id="cc13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是时候用适当的JSON消息来构造主体，以发送要评分的数据了。下面是一个样本格式，我们需要发送JSON消息来获得分数。</p><p id="1f75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">{“数据”:</p><p id="12fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">[​</p><p id="93ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">{“年”:“2019”，</p><p id="5e22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“月”:“6”，</p><p id="2d83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">"销售":" ^ 1 " }</p><p id="2c2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">]​</p><p id="ddaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">}</p><p id="c4ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的格式就是REST API接受数据作为输入的方式。像year、month和sales这样的数组值将根据您的模型输入特性而改变。对于我的示例，我使用了上面的方法，但是请修改它以反映您的模型输入特性。一旦REST API开始工作，一切都准备好了。REST API现在可以被其他下游应用程序使用了。</p><p id="c6e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Azure机器学习服务使数据科学家更容易构建和部署模型。还提供DevOps集成。基本模型开发的可视化拖放，然后使用自动化机器学习来尝试不同的模型。使用不同计算选项的选项，如机器学习计算、Azure数据砖、HDInsight、Azure数据湖分析等。</p><p id="352e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请尝试让我知道你的意见。</p><p id="47bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">享受数据科学的乐趣。</p></div></div>    
</body>
</html>