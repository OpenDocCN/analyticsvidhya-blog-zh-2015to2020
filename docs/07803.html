<html>
<head>
<title>Deep dive into Time series modeling.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入研究时间序列建模。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deep-dive-into-time-series-modeling-4cf3159cbdfd?source=collection_archive---------11-----------------------#2020-07-08">https://medium.com/analytics-vidhya/deep-dive-into-time-series-modeling-4cf3159cbdfd?source=collection_archive---------11-----------------------#2020-07-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8fcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么模型最适合给定的数据集？—从天真到ARIMA。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/22cc70298092dd5d76f1febd64250d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*GV1LVTJgejm0tFqfAbI0fA.jpeg"/></div></figure><blockquote class="jl jm jn"><p id="bd29" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">时间序列建模:从头开始！！</p></blockquote><p id="e818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这么说吧，你已经有了一个时间序列数据，并且已经对它做了所有基本的探索性数据分析。您还分解了时间序列，以了解数据中的各种固有成分。您对需要预测什么有一个相当好的想法，以解决手头的业务问题。</p><p id="aff5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，您正在考虑要实现哪个模型！！</p><p id="4730" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">放心吧！！你来对地方了！！</p><p id="e353" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文将指导您完成实现目标的详细过程——“准确预测”，同时为建模步骤提供全面的解释。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es js"><img src="../Images/aecbd431b51b8b1771337cd57bfd4941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*GXC-ofq6vXrDAGt1sHHeyA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jx"><img src="../Images/b4b708366e94d9f378104d25d2678c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*B0HwAE01oG-TguEvEySmQw.png"/></div></figure><p id="7f11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">定量分析任何时间序列数据有3种基本方法。</p><ol class=""><li id="8c19" class="jy jz hi ih b ii ij im in iq ka iu kb iy kc jc kd ke kf kg bi translated">天真的方法</li><li id="2c0a" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">平均方法</li><li id="6fd5" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">平滑方法</li></ol><p id="82bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们首先试着理解每个模型在预测方面的作用。</p><p id="9848" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。</strong> <strong class="ih hj">天真的方法:</strong></p><p id="4f9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些建模技术将前期的值用作本期的预测。</p><p id="ada5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些方法可以进一步分为简单的和季节性的简单方法。</p><p id="5335" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">简单的朴素方法</strong> —预测值等于前一时期的值。</p><p id="f150" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们以内置的R数据集“gas”(属于库—“forecast”)作为我们在这里将要讨论的所有示例。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="33e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们进行建模之前，让我们将气体数据分成训练和测试数据</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ko"><img src="../Images/2246ca20838243516864d4033cf078b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*MQN7wkQysphCm-6T6hKu0Q.png"/></div></figure><p id="6bd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图显示，对未来12年的预测与上一个时间间隔的实际值相同——“32142”，因为一个天真的模型没有考虑像“趋势”、“季节性”和“周期性”这样的时间序列的内在组成部分。相反，它只是将先前的值复制到因变量的当前值。</p><p id="4658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种结果是非常不可取的。以月销售额为例。比方说，一家公司去年销售了价值1000万美元的产品。这并不意味着该公司今年也将销售价值1000万美元的商品。销售额可能会更高或更低。无论哪种方式，预测整个未来的恒定值对企业来说都不是很有洞察力。</p><p id="234f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是为什么天真的模型仅被用作二级预测模型，从而能够在更复杂的模型之间进行可靠的比较。</p><p id="1896" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下情节证实了上述情况。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kp"><img src="../Images/cd9d8fd53ca9aef8d56c88ba54e28939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*tiKqKZRA6IkRTht4ORqJ3A.png"/></div></figure><p id="c1b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">季节性朴素方法— </strong>当时间序列具有很强的季节性时，最好使用季节性朴素方法。</p><p id="b8bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种方法中，预测值等于前一个季节期间的数据。例如，如果必须预测7月份的雨伞销售，则它将等于上一年(上一季度)7月份的销售值。因此，它考虑了季节性。</p><p id="a63a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在R中实现季节性的nave方法得到如下输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kq"><img src="../Images/9e68a5662891f9667c9a0e4b9a6a62b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*q4ZL33Bao9KXkcFbMKCZNw.png"/></div></figure><p id="363d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，您可以看到，每个月的预测值并不相同。它取前一个季节的值。下面的情节也是如此。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/ae2ea2c2e0fbe5270113d09301676d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*F8Dh4fWM1c2ca1AXERA1vQ.png"/></div></figure><p id="21b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果时间序列数据包含趋势和周期性成分，它仍然使预测不相关。这就是为什么即使是季节性的天真也常常不被认为是主要的预测模型。</p><p id="d15d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。平均方法:</strong></p><p id="e273" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">简单平均法:</strong>将当期值等于过去所有期间的平均值的方法。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="f3e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看这个模型是如何处理“气体”数据的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/4edfebd695b5f793b45be092a0334827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*H90DrVVgZhGaEH1d91eNew.png"/></div></figure><p id="50d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的输出图显示了未来12个月的持续预测，对应于“gas”数据集中所有过去数据的平均值。</p><p id="4ab4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这似乎不太对劲。是吗？</p><p id="1f07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感觉不对是因为，数据有一个模式——趋势和季节性。预测一个常量值(就像天真的方法一样)似乎是不可接受的。</p><p id="bb94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是为什么我们有这个模型的变体——“移动平均线”模型——它在预测中被大量使用。</p><p id="a46c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">均线法:</strong>在你跳到均线之前，让我们偏离一点，来设定一下背景。</p><p id="d34a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一个术语——“<em class="jo">自动回归</em>”——这很像任何简单意义上的多元线性回归。两者的区别在于</p><p id="bc99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">o多元回归— 1个DV和1个或多个iv</p><p id="1f0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">o自动回归— 1DV回归其过去的值。</p><p id="406f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们有一个如下所示的数据集。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/f74399ba73cbaa174d9c3dff59ef1e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*zJU20Z0HNepfbYwASyrI9w.png"/></div></figure><p id="f6c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以画一个多元线性回归方程和一个自回归方程。</p><p id="cfe5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">多元线性回归—回归方程:</strong></p><p id="2062" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DV(估计值)= B0+B1(IV1)+B2(IV2)+B3(IV3)+<strong class="ih hj"><em class="jo">误差</em> </strong></p><p id="176d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自动回归—回归方程:</strong></p><p id="a458" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DV(15-估计)= B0 + B1 (DV(14)) +B2 (DV(13)) +…。+B15 DV(1)) + <strong class="ih hj"> <em class="jo">错误</em> </strong></p><p id="caf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这两个回归中，我们最终得到一个误差项，这就是我们所关心的移动平均预测法。</p><p id="2572" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在回到我们的移动平均线方法。在这些方法中，取过去周期的自回归误差的平均值(对于指定的窗口),并将其分配给新的预测值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/dfda38dd51364e322eaf9909d4f0f33f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*wigBVoEIxDq-MPx4_a8PHw.png"/></div></figure><p id="9b52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二个项目的移动平均值将是(对于窗口2)——(0.971664+0.168287)/2。然后用实际值调整该值，得到预测图，如下图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/cb18c2b18c7cc2417e43f9c431c65762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*RBS0r0DmU4LDiTutGh-Y8Q.png"/></div></figure><p id="d1ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种方法接近准确的预测。然而，我们也需要考虑数据的趋势和随机部分。</p><p id="5c15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。平滑方法:</strong>平滑从字面意义上来说，是指软化粗糙的边缘。</p><p id="e379" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">指数平滑法</strong>是一种将过去的预测值进行加权平均的方法。在这种方法中，我们根据值有多新来定义权重。当前值的最近数据点将具有最大的权重。随着时间的推移，权重呈指数下降。这就是为什么这种方法被称为“指数”平滑。</p><p id="a4ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当数据中没有特定的趋势时，只给最近的数据点最大的权重才有意义。我们可以通过指定参数“α”来控制权重。</p><p id="8ef2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当这个α值接近1时，它与预测的天真方法没有什么不同。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="bb86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当在R中绘制来自“gas”数据集的数据时，我们得到以下输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es kw"><img src="../Images/0f45f4c4865c2295a21381c6716b8516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*ifpnXjHDD6JEVmSlAzJQvA.png"/></div></div></figure><p id="6f17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的图在整个预测期间预测了一个常量值。这是因为，我们还没有考虑趋势和季节性部分。</p><p id="772b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">霍尔特趋势法:</strong>这种方法和指数平滑法中的一样。但是，在这种方法中，我们将过去值的加权平均值与趋势分量的加权平均值一起考虑。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/2d78357ffbfcefc89c36b28d689c9ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*1Ytp1RGBAfu0feZCj4E2Bg.png"/></div></figure><p id="0fdf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就像过去值有一个权重分量(“α”)一样，趋势分量也有另一个权重分量——“β”。与“α”一样，“β”也取0范围内的值&lt; β &lt;1. The closer the value of β, the higher the weightage would be for the trend in the previous period.</p><blockquote class="jl jm jn"><p id="dd4e" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">These weightages — “α”, “β”<strong class="ih hj"> </strong>也称为平滑分量。</p></blockquote><p id="26c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们为霍尔特的趋势模型绘制“气体”数据时，下图是我们得到的输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ky"><img src="../Images/11bbc1441e858aa5dad76e043f01dc4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*BrZ0_zmKnzaCoVieK_7SuQ.png"/></div></figure><p id="b490" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的图中我们可以看出，由于我们只考虑了趋势部分，所以预测自始至终都是一个积极的趋势。</p><p id="2931" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这感觉仍然不像是正确的预测。</p><p id="d82b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么？因为我们在数据集中看到了季节性因素。我们还没有考虑到这一点。</p><p id="ba37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">霍尔特-温特斯模型:</strong>因为我们在这里也要考虑季节性因素，就像在SES(简单指数平滑)和霍尔特方法中一样，我们在这种方法中为季节性因素考虑了一个单独的权重“γ”。“γ”也取0 &lt; γ &lt; 1的值</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kz"><img src="../Images/7ea4f32f5edc8c18ffaa49343af4a368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*TWknCaf9dql0KQIWO56lBQ.png"/></div></figure><p id="6e57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们要应对季节性，我们有两种方法</p><ol class=""><li id="7799" class="jy jz hi ih b ii ij im in iq ka iu kb iy kc jc kd ke kf kg bi translated"><em class="jo">附加季节性</em>-如果数据集的季节性始终不变。</li><li id="e850" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated"><em class="jo">倍增季节性</em> —如果季节性在周期内增加或减少。</li></ol><p id="e447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们用我们的“气体”数据绘制holt-winters模型时，我们得到以下输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es la"><img src="../Images/960429a06c25a69b3e39767fff1daea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*dZCnnd_GcFCG3MxWA4CVZw.png"/></div></figure><blockquote class="jl jm jn"><p id="cb20" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">请注意，这里的季节性类型是“附加的”，因为潜在的季节性几乎是恒定的。</p></blockquote><p id="6c8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们知道了所有基本的时间序列建模技术。让我们探索一种复杂的时间序列建模技术——ARIMA(自回归综合移动平均)。</p><p id="0cdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ARIMA: </strong>自回归综合移动平均模型处理任何非季节性的时间序列预测问题。</p><p id="6684" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在深入ARIMA建模的本质之前，我们需要很好地理解两个基本术语</p><p id="8ba5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.时间序列的平稳性</p><p id="80af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.时间序列的差分。</p><p id="b6e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当因变量的值不随时间变化时，称时间序列为<strong class="ih hj">平稳</strong>。因此，趋势和季节性的存在告诉我们，时间序列是非平稳的。</p><p id="f712" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用r中的“自相关函数”图来判断时间序列是否平稳。</p><p id="c969" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jo"> y轴——自相关</em>——一个从-1到1的值，是指因变量的值与其过去值的相关性。</p><p id="97c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jo"> x轴—“滞后”</em> —滞后k自相关是相隔k个周期的值之间的相关性<em class="jo">。例如，滞后2自相关是对应于时间序列中过去2项的相关性的值。</em></p><p id="e06b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，当我们绘制各种滞后的所有自相关值时，我们会得到如下图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es la"><img src="../Images/5e135344a486b59ec6e3fff1d6628ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*TgHlSdFSr5d6bXOs_sPSUw.png"/></div></figure><p id="8ac6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与线性回归一样，在对时间序列实施ARIMA之前，数据点需要尽可能地不相关。自相关值接近0，表示对时间序列值的依赖性较小。</p><p id="c874" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图显示，即使对于较高的滞后值，自相关值也非常高，因此这些值不是随时间固定的。</p><p id="02a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们不能为这样的数据集实现ARIMA。</p><p id="319d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要在具有明确长期趋势或明确季节性的时间序列上建立ARIMA模型，需要使时间序列保持平稳。</p><p id="04ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何做到这一点？</p><p id="4c3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们做了一件叫做“T10”差异的事情。当您减去一个时间序列中的两个连续值时，这是一个差分时间序列。当你做一次差分时，叫做一阶差分，当你做两次差分时，叫做二阶差分。</p><p id="b22b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们对“气体”数据集进行差分，看看ACF值是否接近0。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/cd6d2a5632f31a2887e3d034487663da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*U4FwwtOVWt7AdzW_asmG3g.png"/></div></figure><p id="97b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，您可以看到，在一阶差分后，时间序列在滞后(3)时变为接近0的ACF值。这表明该系列已趋于平稳。</p><p id="e1e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过进行“kpss . test”(<a class="ae lc" href="https://cran.r-project.org/web/packages/tseries/tseries.pdf" rel="noopener ugc nofollow" target="_blank">R KPSS检验文档</a>)来从统计上确认平稳性，在这里您将寻找证据来证明您的替代假设，即“数据不是平稳的”</p><p id="0fc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们试图在我们的数据集中执行这个测试时，我们得到了下面的输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ld"><img src="../Images/46261d60565e911c9c35657bb8c660cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*pmk8tBvEjPsMfZilXA0Neg.png"/></div></figure><p id="89fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">p值没有提供任何证据来证明替代假设。所以，可以肯定地说这个数列是平稳的。</p><p id="765f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然序列是稳定的，我们就可以继续在差异数据集上实现ARIMA。</p><p id="9ac6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">现在，什么是ARIMA？</strong></p><p id="d045" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ARIMA模型有三个组成部分</p><p id="bca1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.用“p”表示的自回归(AR)部分</p><p id="ea5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.用“d”表示的集成部分(I)</p><p id="84bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.用“q”表示的移动平均部分(MA)</p><p id="2c1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在构建ARIMA模型时，您需要指定这三个参数。你可以用下面两种方法中的任何一种来做。</p><p id="5967" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.通过ACF和PACF图手动找出p、d和q值。</p><p id="05d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.在R中使用auto.arima()函数，它可以得出pdq的最佳组合，从而提供最佳精度。</p><p id="e367" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">手动查找:选择“AR”—“p”:</strong></p><p id="6775" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自动回归(p)的阶可以通过用差分数据绘制偏自相关函数图(PACF图)来找到。该图包含时间序列与其过去值之间的相关性。</p><p id="76ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，让我们用“气体”数据做一个PACF图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es le"><img src="../Images/4e7d6186e2563692c979bea5ccc5a1b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*7ZO_q0aLhT73yCtKrNrhwQ.png"/></div></figure><p id="18a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图中的垂直线显示了不同滞后的相关性强度。蓝线表示置信度。在第一滞后(y(t)和y(t-1)之间的相关性)，相关性大于0.2。在第二个滞后时，相关性小于0.2，但仍大于置信水平。</p><p id="76bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只有在第4个滞后(相关性y(t)，y(t-1)，y(t-2)，y(t-3)，y(t-4))中，相关值才降到置信水平以下。</p><blockquote class="jl jm jn"><p id="82a2" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">假设所有中间滞后的影响，y(t)和它的第四个滞后y(t-3)之间的部分自相关被认为是仅y(t)和y(t-3)之间的相关性。某种程度上不完整。因此得名“部分”。</p></blockquote><p id="32c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这标志着我们为ARIMA模型选择的自相关“AR”—“p”阶，即p=3。</p><p id="3077" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选择‘I’—‘d’:</strong>ARIMA的‘I’代表集成自回归和移动平均建模。</p><p id="0dec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要指定对时间序列进行差分的顺序，因为ARIMA必须通过反向差分来整合自回归和移动平均部分，从而为序列中的所有期间提供预测。</p><p id="c705" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也就是y，积分部分携带代表“差异程度”的值“d”</p><p id="3f89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，我们将选择d =1，因为我们已经执行了一阶差分。</p><p id="39cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选择“马”的部分——“问”:</strong></p><p id="7ed3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像PACF一样，我们有一个单独的图ACF，它描绘了不同滞后的误差项的自相关。ACF不是寻找过去值之间的相关性，而是以回归的方式获取过去的误差值。</p><blockquote class="jl jm jn"><p id="dd42" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">请参考上面的移动平均线解释。</p></blockquote><p id="e09b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，从ACF图中，我们可以找到最少的滞后点，此时误差项的自相关低于置信水平。</p><p id="8961" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们为“气体”数据绘制一个ACF图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lf"><img src="../Images/bd5f100224b23dcee107343c31c82051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*QsyJy0UOGJ-bPKEgt4l6ZQ.png"/></div></figure><p id="f45e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该图表明在滞后3(忽略对应于0的滞后，因为它是第0个滞后)时，自相关下降到置信水平以下。所以这里的q等于2。</p><p id="00ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始建造ARIMA吧。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="d072" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们提供的p、d和q值，我们得到下面的预测图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/cf6f16fb3f270510f9ef1e428c85c1fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*37f1PwwADhrKGv4fnKHvvw.png"/></div></figure><p id="b7a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最后但同样重要的是——模型评估:</strong></p><p id="b152" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们已经在“gas”数据集上处理了所有基本的时间序列预测模型，那么让我们比较测试数据中每个模型的准确性，以评估最适合我们数据的模型。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="228d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下表总结了此处考虑的模型的所有性能指标。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/11c314be4cac5de8533a2bef686ded06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*mSqa2RVH79z8q5OeP7ENpg.png"/></div></figure><p id="3bb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于任何时间序列模型评估，要考虑的最佳指标是RMSE(均方根误差)或MAPE(平均绝对百分比误差)。</p><p id="a15b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据以上两个性能指标，我们可以有把握地说<strong class="ih hj">热冬的</strong>趋势和季节性模型明显优于所有其他模型。</p><p id="a17f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于比较模型准确性的另一个关键指标是“泰尔U统计量”。这些统计数据使用基准精度(原始模型精度)计算相对精度。数学上，U统计量由下式给出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/c4fdb2a8d2fb28d29068837b09b5a161.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*aKzFlcOcApidgs7JgdADPg.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">img . source—<a class="ae lc" href="https://docs.oracle.com/cd/E40248_01/epm.1112/cb_statistical/frameset.htm?ch07s02s03s04.html" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/CD/e 40248 _ 01/EPM . 1112/CB _ statistical/frameset . htm？ch07s02s03s04.html</a></figcaption></figure><p id="7cb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">If U &lt;1 — The chosen model performs better than the benchmark model</p><p id="c4bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">If u = 1 — both the models perform equally well</p><p id="86d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">If U &gt; 1 —所选模型的性能比基准测试差。</p><p id="0e8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">U的值越接近0，模型的表现就越好。</p><p id="a9b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管如此，我们数据集的所有这些U统计值，对于考虑趋势和季节因素的Holt-Winter的模型来说是最少的。</p><p id="ad77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，Holt-winter模型是我们“天然气”消费数据集中预测值建模的赢家。</p><p id="a50d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">下一步… </strong></p><p id="d996" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经了解了模型选择及其背后的科学，我想将研究提升一个层次，并通过先进的时间序列建模技术(如“神经网络”)来指导大家。</p><p id="a619" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你还需要复习时间序列的基本知识，请查看我以前的文章</p><div class="ln lo ez fb lp lq"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/fundamentals-of-time-series-forecasting-315b7b729bcb"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">时间序列预测基础</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">如果你能知道你下周要花多少钱呢？或者如果你能说出你的睡眠时间…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jj lq"/></div></div></a></div></div></div>    
</body>
</html>