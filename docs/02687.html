<html>
<head>
<title>Machine Learning Dataset Tour (3): Loan Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习数据集之旅(3):贷款预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-dataset-tour-3-loan-prediction-b97335f9231f?source=collection_archive---------21-----------------------#2019-12-28">https://medium.com/analytics-vidhya/machine-learning-dataset-tour-3-loan-prediction-b97335f9231f?source=collection_archive---------21-----------------------#2019-12-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ff1dbf7339f4882248e82106ac67602f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YhXWhvDt9QdAe3z1"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@cytonn_photography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Cytonn摄影</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="0c6c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我将简要介绍贷款预测数据集，并分享我的解决方案和一些解释。</p><blockquote class="jt ju jv"><p id="b227" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">点击<a class="ae iu" rel="noopener" href="/analytics-vidhya/machine-learning-dataset-tour-3-loan-prediction-b97335f9231f?source=friends_link&amp;sk=e0f6a76a2da8812def440c6e397763f3">此链接</a>通过付费墙。</p><p id="30e1" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><em class="hi">TL；DR:你可以在我的</em> <a class="ae iu" href="https://github.com/Cuda-Chen/machine-learning-note/blob/master/loan-prediction/loan_predict.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="hi"> GitHub </em> </a>上查看我的作品</p></blockquote><h1 id="3eb4" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">贷款预测数据集简介</h1><p id="9a9c" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">由Analytics Vidhya提供，贷款预测任务是根据他们的状态决定我们是否应该批准贷款请求。每条记录包含以下变量及其说明:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/5cb5968101496e04ebe4cd61e63fa093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KnZfEnM_Hht3tyd5EzcGJg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">每个功能的描述</figcaption></figure><p id="567d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更多详情可以访问官方<a class="ae iu" href="https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/" rel="noopener ugc nofollow" target="_blank">帖</a>。</p><h1 id="210b" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">目标和评估指标</h1><h2 id="6c97" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">目标</h2><ul class=""><li id="69fa" class="lw lx hi ix b iy ky jc kz jg ly jk lz jo ma js mb mc md me bi translated">目标是根据给定的条件批准/拒绝一个人的贷款。</li></ul><h2 id="ae06" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">评估指标</h2><ul class=""><li id="8afa" class="lw lx hi ix b iy ky jc kz jg ly jk lz jo ma js mb mc md me bi translated">准确性，即您正确预测的贷款批准百分比。</li></ul><h1 id="2a37" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">我的解决方案</h1><ul class=""><li id="d92e" class="lw lx hi ix b iy ky jc kz jg ly jk lz jo ma js mb mc md me bi translated">由于数据以表格形式提供，我将选择基于决策树的模型。</li><li id="7110" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mb mc md me bi translated">因为某些要素具有空值，所以我将使用删除具有空值的记录或填充一个值来代替。我最终选择<strong class="ix hj">来填充缺失的特征值</strong>，它在每个特征中出现的次数最多，因为训练数据很少。</li><li id="1be1" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mb mc md me bi translated">由于测试数据不提供基本事实，因此将通过交叉验证训练数据来训练模型。</li></ul><h1 id="7ebc" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">逐步解释</h1><h2 id="64a7" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">1.准备数据，做一些探索</h2><p id="649f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">使用熊猫的<code class="du mk ml mm mn b">info()</code>方法，我发现一些特征的类型是<code class="du mk ml mm mn b">object</code>:</p><ol class=""><li id="be00" class="lw lx hi ix b iy iz jc jd jg mo jk mp jo mq js mr mc md me bi translated">贷款</li><li id="9b6b" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">性别</li><li id="6326" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">已婚的</li><li id="5ae4" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">受赡养者</li><li id="f72d" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">教育</li><li id="0f68" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">自营职业者</li><li id="e772" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">房产_面积</li><li id="c6ce" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">贷款_状态</li></ol><p id="d623" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用熊猫的<code class="du mk ml mm mn b">isnull()</code>方法，我发现一些特征包含空值:</p><ol class=""><li id="17b9" class="lw lx hi ix b iy iz jc jd jg mo jk mp jo mq js mr mc md me bi translated">性别</li><li id="0731" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">已婚的</li><li id="7e93" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">受赡养者</li><li id="845f" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">自营职业者</li><li id="8878" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">贷款金额</li><li id="3b4f" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">贷款_金额_期限</li><li id="7058" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">信用记录</li></ol><p id="edd3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我使用<code class="du mk ml mm mn b">seaborn</code>来检查每个变量在Loan_Status = 'Y' v.s. 'N '之间的分布:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/499c2cf52c1ec40a247cf3848d329bef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/0*cBxP_xCbHxNnP_HU.png"/></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/ddbbed1ae55eadbab41804016dce24dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/0*O3geciVNFR3qGDDV.png"/></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/cf238b91792168f010ffb4c532438e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/0*5VjWlBUVA49JQKm-.png"/></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/84c5f6ba49ac7069f8ee9aa034811980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/0*afT3KcF64ApzEFbl.png"/></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/054e3cbedfa7210ea95afc96b1351943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/0*xSuM6Do3fv_vqpDM.png"/></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/74cfb62e553196788c2d1161118df2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/0*K0JvNWkQmCnzvO_2.png"/></div></figure><p id="4c4c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">综上所述，我做一些概述:</p><ol class=""><li id="8eb7" class="lw lx hi ix b iy iz jc jd jg mo jk mp jo mq js mr mc md me bi translated">Loan_ID是不相关的(它不应该被视为一个特性，因为它只是每个记录的ID)。</li><li id="dbaf" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">Loan_Status不应被视为特性，因为它是目标。</li><li id="a69f" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">Y/N比率越高，贷款获得批准的可能性越大。</li></ol><h2 id="3721" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">2.特征工程</h2><p id="fb0a" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我在这次任务中使用的特征工程方法包括:</p><ol class=""><li id="81aa" class="lw lx hi ix b iy iz jc jd jg mo jk mp jo mq js mr mc md me bi translated">用<code class="du mk ml mm mn b">mode()</code> <br/>填充缺失值由于训练数据较少，我在pandas中用<code class="du mk ml mm mn b">mode()</code>方法填充缺失值。<code class="du mk ml mm mn b">mode()</code>方法将返回最常出现的值[1]。</li><li id="debf" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">分类特征的一键编码<br/>在上一部分中提到，一些特征是分类类型的，所以我使用一键编码来表示该特征属于哪个类。</li><li id="4259" class="lw lx hi ix b iy mf jc mg jg mh jk mi jo mj js mr mc md me bi translated">对目标值进行标签编码<br/>我认为应用一热编码不适合表示目标值。因此，我采用标签编码来表示目标值的类别。</li></ol><h2 id="3728" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">3.准备基线模型</h2><p id="b2a2" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在特征工程之后，我准备了默认的随机森林分类器来预测一个人是否会根据他的情况获得贷款批准。<br/>同样，我应用交叉验证来评估分数，这个基线模型的准确率是<strong class="ix hj"> 75% </strong>。嗯，很简单。让我们试着通过调整它的超参数来改善它。</p><h2 id="d820" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">4.随机搜索的超参数搜索</h2><p id="d167" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">为了找到模型的最佳超参数，我们可以使用以下两种方法:</p><blockquote class="my"><p id="fa40" class="mz na hi bd nb nc nd ne nf ng nh js dx translated">随机搜索与网格搜索</p></blockquote><p id="406c" class="pw-post-body-paragraph iv iw hi ix b iy ni ja jb jc nj je jf jg nk ji jj jk nl jm jn jo nm jq jr js hb bi translated">随机搜索随机尝试超参数组合，网格搜索逐个尝试超参数组合。一般来说，网格搜索会产生更好的结果，但需要更多的时间来尝试组合。因此，我会使用随机搜索，在短时间内找到最佳组合。当然，我采用了<code class="du mk ml mm mn b">RandomizedSearchCV</code>，因为我使用了<code class="du mk ml mm mn b">sklearn</code>的随机森林分类器。</p><p id="97f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">运行随机搜索后，我们可以使用<code class="du mk ml mm mn b">best_params_</code>对象获得最佳超参数:</p><pre class="le lf lg lh fd nn mn no np aw nq bi"><span id="8b9b" class="li kb hi mn b fi nr ns l nt nu">{'n_estimators': 546,<br/> 'min_samples_split': 2,<br/> 'min_samples_leaf': 4,<br/> 'max_features': 'sqrt',<br/> 'max_depth': 10,<br/> 'bootstrap': True}</span></pre><p id="111d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我使用这些参数创建一个随机森林分类器，这将在下一部分中提到。</p><h2 id="f0ab" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">5.训练和评估模型</h2><p id="5a9b" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在我们得到参数之后，我们可以创建一个性能比基线模型更好的模型。我还使用交叉验证来评估模型。<br/>该模型的准确率为<strong class="ix hj"> 81% </strong>，比基线模型提高了6%的准确率。听起来不错。</p><h1 id="9cfa" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="98e3" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在这篇文章中，我简要介绍了贷款预测数据集，并展示了一步一步的操作来展示我的解决方案。此外，我还证明了通过使用随机参数搜索来获得最佳超参数，我们可以将模型的性能进一步提高6%。<br/>下次巡演再见，拜拜！</p><blockquote class="jt ju jv"><p id="985b" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><em class="hi">您可以在我的</em> <a class="ae iu" href="https://github.com/Cuda-Chen/machine-learning-note/blob/master/loan-prediction/loan_predict.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="hi"> GitHub </em> </a> <em class="hi">上查看我的作品。</em></p></blockquote><h1 id="a23b" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">参考</h1><p id="71e7" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">[1]<a class="ae iu" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mode.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。DataFrame.mode.html</a></p></div><div class="ab cl nv nw gp nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="hb hc hd he hf"><p id="b4c5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jw">原载于2019年12月28日</em><a class="ae iu" href="https://cuda-chen.github.io/machine%20learning/2019/12/28/machine-learning-dataset-tour-3-loan-prediction.html" rel="noopener ugc nofollow" target="_blank"><em class="jw">https://cuda-Chen . github . io</em></a><em class="jw">。</em></p></div><div class="ab cl nv nw gp nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="hb hc hd he hf"><blockquote class="jt ju jv"><p id="5a36" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">如果你有任何想法和问题要分享，请联系我<a class="ae iu" href="http://clh960524@gmail.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">clh 960524【at】Gmail . com</strong></a>。另外，你可以查看我的<a class="ae iu" href="https://github.com/Cuda-Chen" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中的其他作品。如果你像我一样对机器学习、图像处理和并行计算充满热情，请随时在LinkedIn上添加我。</p></blockquote></div></div>    
</body>
</html>