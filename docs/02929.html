<html>
<head>
<title>Using GAN for fashion</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用甘做时尚</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-gan-for-fashion-6dc11012ac6a?source=collection_archive---------6-----------------------#2020-01-08">https://medium.com/analytics-vidhya/using-gan-for-fashion-6dc11012ac6a?source=collection_archive---------6-----------------------#2020-01-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6392" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何用甘提升时尚产业？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/9277173a475473808b5b8747135de2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*kSFr9Gh-3yMmsaEfYXNoOw.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">甘是如何学习设计的</figcaption></figure><h2 id="021a" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">介绍</h2><p id="5333" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">大家好！如果你打开这篇文章，很可能，你对这样的话题感兴趣:时尚，机器学习，深度学习，人工智能和定制。</p><p id="6917" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如今，每个互联网或现实生活中的用户都想得到一个专门为他或她的需求而设计的产品。如何改善时装业，使其走向“完全定制”状态？其中一个想法是利用GAN的描述来生成服装。</p><p id="a5f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，让我们开始吧！</p><h2 id="07e2" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">内容</h2><ol class=""><li id="c11e" class="kp kq hi ih b ii kk im kl iq kr iu ks iy kt jc ku kv kw kx bi translated">介绍</li><li id="5fce" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">甘理解</li><li id="f2ec" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">时尚的甘</li><li id="443a" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">结论</li></ol><h2 id="569f" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">甘理解</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ld"><img src="../Images/05c79a92bde6b3da886010efc86578f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B7oifvqqCNU4d5yA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">DCGAN结构</figcaption></figure><p id="b516" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图是DCGAN或深度卷积生成对抗网络这类GAN的结构。</p><p id="d14b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它是如何工作的？</p><p id="b077" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要定义一个任务。我们的任务是通过<strong class="ih hj">文本描述</strong>来<strong class="ih hj">生成</strong>图像。这意味着我们将有一些编码的输入文本，我们将期待一个图像。你可能会想，为什么我们不使用转置卷积或某种带有修改输入形状的自动编码器呢？我们当然可以，想象力没有限制。但是我们的任务会复杂得多，因为我们需要计算输出图像和真实图像的损失(例如MSE)。比理解GAN原理还难做。</p><p id="0ba3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单点说吧。如何理解GAN架构和培养思路？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/b77934a51998974ea19129e555ef27b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/0*Es2rdHsSZM4krQPw"/></div></figure><p id="cfcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图显示了一个与现实生活相似的例子。设想这样一种情况:有一个罪犯想制造质量非常好的假币，而有一个警察的目的是区分真钱和假币。在我们90年代的世界里，这是一种流行的想法。</p><p id="5e32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，它们是如何相互作用的呢？我会让这个故事更接近ML的观点。我们一步一步来写吧。</p><p id="1a05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">初步互动行动计划:</strong></p><ol class=""><li id="2fca" class="kp kq hi ih b ii ij im in iq lj iu lk iy ll jc ku kv kw kx bi translated">伪造者已经读取了一些材料(发生器输入噪声/编码指令)</li><li id="a53b" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">伪造者制造了一张假钞票(发电机输出)</li><li id="52b7" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">警官收到了这张钞票和一张真钞票的样品(鉴别器2输入)</li><li id="54db" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">警察判定它是假的(鉴别器输出= 0)</li></ol><p id="d83d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这只是一次向前传球。如何让生成器和鉴别器更聪明？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lm"><img src="../Images/5f2ab48b80474d5f9f032e8282776484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2l03GVT70SCbVtLq.gif"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">例如伪造者制造了这个:)</figcaption></figure><p id="ac5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先我们需要<strong class="ih hj">评估鉴别器</strong>(警官)。官需要做两件事:知道真钱是什么样子的(真亏)，精通辨别假钱(假亏)。在我们的例子中，警官马克(或者可能是一些用于识别犯罪的每日奖金)将被计算为:(损失(真钱|警官决定)+损失(假钱|警官决定))* 1/2。</p><p id="49ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在一些数学工作人员和我们将继续我们的故事。</p><p id="23b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用<strong class="ih hj"> BCE损失</strong>(二元交叉熵)和下面一张图上的通用公式。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ln"><img src="../Images/6a787241037d472f02573f01637217c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/0*C-uq2noSl6VZc_2o.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">广义交叉熵</figcaption></figure><p id="a8df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们想象一下，警察可能会告诉我们它是真的还是假的概率(0-100%或从0到1)。而且官告诉我们:真钱:0.9真0.1假(有地真1真0假)假钱0.2真0.8假(有地真0真1假)。现在我们来计算一下损失。</p><p id="5445" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">警官损失= 1/2 *(log 0.9 * 1-log 0.1 * 0)+(-log 0.2 * 0-log 0.8 * 1))= 1/2 *(0.04+0.09)= 0.065。</p><p id="1652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一种很好的损失！太好了，警官！</p><p id="3d6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是如何处理造假者呢？他/她还需要擅长制造假币(在现实生活中当然不是，但我们是数学家，为了更好的理解，可能会做任何类比)。在我们的案例中，我们甚至想让伪造者在制造假币方面做得更好！让我们帮助他/她！</p><p id="601e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将<strong class="ih hj">告诉造假者警官的专业鉴定结果</strong>(损失)并将<strong class="ih hj">将警官的眼睛</strong>闭上一段时间(鉴别器重量冻结)。</p><p id="c59d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将学习伪造者(生成器)。我们<strong class="ih hj">翻转标签</strong>并使发生器<strong class="ih hj">假数据为真数据</strong>，我们将使用冻结的鉴别器为发生器工作！有点小把戏。</p><p id="3081" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在我们训练伪造者赚更多的钱。例如，伪造者的结果在下面的图片上。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lo"><img src="../Images/c81908dc49e6405c5f40d987ad2b9156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tzy45F3Al-B_B2zKRsSY1w.png"/></div></div></figure><p id="6f41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">发电机损耗= -log 0.1 * 1-log 0.9 * 0 = 1(这是一种巨大的损耗，我们将其告知发电机并更新其权重)。并且下一个动作重复前面描述的向前传递。</p><p id="f1cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">训练的行动计划(隐喻):</strong></p><ol class=""><li id="2a8a" class="kp kq hi ih b ii ij im in iq lj iu lk iy ll jc ku kv kw kx bi translated">评估警官了解真实金钱的能力(用真实数据评估真实损失)</li><li id="4043" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">评估警官辨别假币的能力(用假数据伪造损失)</li><li id="efef" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">计算官员评估中的中等误差(总损失为真实和虚假损失的一半)</li><li id="3aa0" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">利用新的总体评估结果(整个模型的反向传播)提高官员和伪造者的知识</li><li id="2022" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">关闭官员的眼睛(冻结鉴别器模式)</li><li id="a639" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">让伪造者认为他/她通过使用“盲”官员的专业知识(翻转标签并计算发电机损耗BCE和更新发电机)来制造真钱</li><li id="7ae1" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">睁开眼睛，警官！伪造者现在可以做更好的假钞了！(解冻鉴别器并再次向前传递)</li></ol><p id="c090" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回到机器学习。我们有兴趣让发电机变得更棒，对吗？我们不需要一个很酷的鉴别器作为我们的工作成果(在大多数情况下)。我们需要制造假数据！</p><p id="872c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看时尚的例子。</p><h2 id="d9fb" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">时尚的甘</h2><p id="23c3" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">结果看起来怎么样？</p><div class="je jf jg jh fd ab cb"><figure class="lp ji lq lr ls lt lu paragraph-image"><img src="../Images/104b02c674ace29b284adc9e8bcd7ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*7fdSM-b9zfHzpPmT1debTg.png"/></figure><figure class="lp ji lv lr ls lt lu paragraph-image"><img src="../Images/d343e96674df6a4b6d8b15666d878ab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*upqYrjH3WHgGBP0L0YpWgA.png"/></figure></div><div class="ab cb"><figure class="lp ji lw lr ls lt lu paragraph-image"><img src="../Images/b9eb1df70b688cd8b1cb4ce4f02e5aa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*FL-1usT4MAOYs5hGX_z-mQ.png"/></figure><figure class="lp ji lx lr ls lt lu paragraph-image"><img src="../Images/a2d8d65ea4f647060f45c37d51c955d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*KU6D5pq24C3IjocJT53H8g.png"/></figure></div><p id="4c79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的图像上显示了当训练的GAN具有作为文本的输入并且结果是图像时的例子。它是一种低质量的128x128x3图像的原型。</p><p id="84c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使这个项目成为现实，我们拍摄了15 GB的图片，每张图片都有相应的文字描述(性别、风格、颜色、描述等)。)</p><p id="cf79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图像数据被修整成128×128×3(RGB)图像，文本数据用TFIDF技术转换成256值向量。</p><p id="b4cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在某些情况下，模特会猜测主要的想法，比如颜色或男/女/中性类型。一些新数据(文字描述)呢？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/204c18105a730d30f3af940e85da1aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*nkMk29SRehBspxk-WVWTEQ.png"/></div></figure><p id="d2f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">某种恐怖电影。我们看到黑色和红色，某种人类的立场(可能是人)，这就是一切。</p><p id="cc0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GANs对数据极度饥渴，慢慢在训练。精确生成器是一个缓慢的学习者，为了制作这个模型，它花了72小时与GeForce GTX 1070 Ti进行了300000个时期和12000张图像以及相应的文本捕获。</p><p id="a46f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步做什么？DCGAN有自己的极限。没有比128x128x3图片更好的效果了。模型需要更加复杂。</p><p id="f714" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，最好使用ProGAN或渐进式增长的生成性对抗网络。在下一篇文章中。</p><h2 id="415a" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">结论</h2><p id="fa3a" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">GAN是一项很好的技术，可以让神经网络像人类一样“想象”，就像有人在想象中听到“蓝色牛仔裤”时出现某种图像，这不像数据库搜索，它总是一个创造和幻想的过程。</p><p id="22ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是建筑必须非常复杂，才能制作出高分辨率的图像。例如，在ProGAN中，网络从没有意义的图像4x4x3逐步训练到具有高质量图像和深度意义的图像1024x1024x3 (RGB)。</p><p id="af2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！我希望您在这篇文章中发现了一些有趣的东西，并且可能提高了您在GANs方面的知识，找到了新的开发思路。</p><p id="2ffa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">致以最良好的祝愿，</p><p id="f539" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习工程师邦达伦科·k。</p></div></div>    
</body>
</html>