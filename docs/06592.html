<html>
<head>
<title>Object Detection using YOLOv3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用YOLOv3的对象检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/object-detection-using-yolov3-d48100de2ebb?source=collection_archive---------7-----------------------#2020-05-27">https://medium.com/analytics-vidhya/object-detection-using-yolov3-d48100de2ebb?source=collection_archive---------7-----------------------#2020-05-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a8aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用YOLOv3使用COCO数据集检测对象。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/a2491f21cb4000ccd960579458655b60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*uiw0Jg28CwRJAcsMvH8EjQ.gif"/></div></figure><h2 id="b0d8" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">什么是YOLO？</h2><p id="08f1" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">YOLO——你只看一次——是一种非常快速的多对象检测算法，它使用卷积神经网络(CNN)来检测和识别对象。</p><p id="ef4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经网络具有这样的网络结构。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kl"><img src="../Images/d922fa020ee25a1c12c99238ca2141e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TibA2w2Eyq5uwVPvYT-0Jw.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">来源:<a class="ae ku" href="https://arxiv.org/pdf/1506.02640.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1506.02640.pdf</a></figcaption></figure><h2 id="96f2" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">什么是COCO数据集？</h2><p id="a18d" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">上下文中的常见对象(<strong class="ih hj"> COCO </strong>)上下文中的常见对象(<strong class="ih hj"> COCO </strong>)是一个数据库，旨在实现对象检测、实例分割、图像字幕和人物关键点定位的未来研究。COCO是一个大规模的对象检测、分割和字幕数据集。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kv"><img src="../Images/9d4cb7350021ca64bcbd57be26049aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVjKR8pgPi_MbGi8TS10vQ.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">来自COCO数据集的样本。</figcaption></figure><h2 id="bc6f" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">#工作流程:-</h2><p id="3c69" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">1)读取输入视频</p><p id="7d2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2)加载YOLO v3网络</p><p id="7e30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3)读取循环中的帧</p><p id="194d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4)从帧中获取斑点</p><p id="efe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5)实施向前传球</p><p id="be07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6)获取边界框</p><p id="0e08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7)非最大抑制</p><p id="384f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8)绘制带有标签的边界框</p><p id="e5c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9)写入处理过的帧</p><p id="a31a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"># Result: <br/>带有检测到的对象、边界框和标签的新视频文件</p><h2 id="7c98" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤1:导入库并设置路径</h2><p id="566e" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">Will将使用cv2中的VideoCapture功能导入要在其中识别对象和标签的视频。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="1ce0" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤2:加载YOLOv3型号:-</h2><p id="5450" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">我们需要从<a class="ae ku" href="https://pjreddie.com/darknet/yolo/" rel="noopener ugc nofollow" target="_blank">这里的</a>加载YOLOv3模型的权重和配置文件。您可以从<a class="ae ku" href="https://github.com/pjreddie/darknet/blob/master/data/coco.names" rel="noopener ugc nofollow" target="_blank">这里</a>下载coco数据集名称文件，并正确设置路径。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="e803" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤3:读取框架</h2><p id="0a15" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">我们从视频文件中一个一个地读取帧。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="4675" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">第四步:获得斑点</h2><p id="e4e1" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">一个斑点是一个4D numpy数组对象(图像，通道，宽度，高度)。它具有以下参数:</p><ul class=""><li id="be50" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">要变换的<strong class="ih hj">图像</strong></li><li id="361e" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><strong class="ih hj">缩放</strong>因子(1/255)将像素值缩放至[0..1])</li><li id="96f3" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><strong class="ih hj">尺寸</strong>，这里是一个416x416的正方形图像</li><li id="87ba" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><strong class="ih hj">表示</strong>值(默认值=0)</li><li id="7035" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">选项<strong class="ih hj"> swapBR=True </strong>(因为OpenCV使用BGR)</li></ul><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="5248" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤5:实现向前传递</h2><p id="5d63" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">通过网络传递每个Blob。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="ef56" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤6:获取边界框:-</h2><p id="eab0" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">这里我们得到了边界框。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="fa46" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤7:-非最大抑制。</h2><p id="3a01" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">邻域窗口在某种程度上具有相似的分数，并且被认为是候选区域。这导致了数百个提议。由于建议生成方法应该具有高召回率，所以我们在这一阶段保持宽松的约束。然而，通过分类网络处理这么多建议是很麻烦的。这就产生了一种技术，这种技术基于一些被称为非最大抑制的标准来过滤提议。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lm"><img src="../Images/e9a5202ce031bd79af81bd41064ac79d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fAHmnqSDqerqNA6Onjw6Pw.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="b1f0" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤8:绘制边界框:-</h2><p id="ee13" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">我们为帧中检测到的每个对象绘制边界框。我们使用CV2.rectangle函数来绘制。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="a9cf" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">步骤9:在文件中写入处理过的帧:-</h2><p id="4578" class="pw-post-body-paragraph if ig hi ih b ii kg ik il im kh io ip iq ki is it iu kj iw ix iy kk ja jb jc hb bi translated">在最后一步中，我们在视频帧中写入提议的边界框和标签，并保存它。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="799f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整代码位于:-</p><div class="ln lo ez fb lp lq"><a href="https://github.com/pratikpatil699/objectdetection_yolov3" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">pratikpatil 699/object detection _ yolov 3</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">在GitHub上创建一个帐户，为pratikpatil 699/object detection _ yolov 3开发做贡献。</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">github.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jj lq"/></div></div></a></div><h2 id="cef4" class="jl jm hi bd jn jo jp jq jr js jt ju jv iq jw jx jy iu jz ka kb iy kc kd ke kf bi translated">输出带标签的视频:-</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/cdd54b31b409351c17455be41ff1cd90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*YRwJff_Gpu9Nka8yESOKzg.gif"/></div></figure></div></div>    
</body>
</html>