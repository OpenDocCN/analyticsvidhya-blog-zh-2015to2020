<html>
<head>
<title>Reusable ML code snippets for everyday use — Part-II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">日常使用的可重用ML代码片段——第二部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/reusable-ml-code-snippets-for-everyday-use-part-ii-f5656a68f5dd?source=collection_archive---------23-----------------------#2020-01-21">https://medium.com/analytics-vidhya/reusable-ml-code-snippets-for-everyday-use-part-ii-f5656a68f5dd?source=collection_archive---------23-----------------------#2020-01-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6928135d863a7b38e75f154a5e2ab9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*34j_xaEHnrAyo2FOzvJ1IQ.jpeg"/></div></figure><p id="4064" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">朋友们，你们好，我这里是这个系列的第二部分。如果你还没有检查第一部分，检查一下我们这里的<a class="ae jk" rel="noopener" href="/analytics-vidhya/reusable-ml-code-snippets-for-everyday-use-part-i-f313903c2b37"><strong class="io hj"/></a><strong class="io hj">。虽然我对第三部和未来的部分没有立即的计划，但我仍然不会称之为结尾部分，因为我可能会想到特定地区的片段，例如CNN、RNN、Ensemble等。在接下来的3-4篇<a class="ae jk" rel="noopener" href="/@10XAI"> 10XAI </a>的文章中，我将深入到令人困惑的主题，例如PCA/SVD和元主题，例如ML路线图等。让我们跳到下一节的片段。</strong></p><ol class=""><li id="9b51" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jq jr js jt bi translated"><strong class="io hj">宁滨你的数据范围</strong>，当你想把你的连续数据转换成一个类别数据时就需要这个武器。把分数转换成等级就是一个典型的例子。在这个片段中，我从100分中随机抽取了100分，根据不同的步骤分别进行评分。</li></ol><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ju"><img src="../Images/593478407fec54a066e6c8c088707da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovBLO2pda_YXgywmr-VJOA.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码和输出—宁滨</figcaption></figure><p id="5df8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.<strong class="io hj">缩放数据</strong>是最关键的步骤之一，没有它，许多算法将不会收敛到可用的输出。几乎每个ML活动都需要将它们的所有特性提升到相同的水平。在这个片段中，我已经用两种方法对两种变体进行了缩放，即标准化和规范化，例如Sklearn和Pandas的函数，因为我们还必须知道如何从头开始编写任何代码。创建两个数据集并将其合并以创建我们的示例数据集的原因是为了获得一个包含不同比例要素的数据集。<em class="kh">要注意Sklearn的输出数据类型和Pandas的函数之间的细微差别。</em> <strong class="io hj"> Sklearn输出是一个Numpy数组。</strong></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ki"><img src="../Images/90bca071cdad44a80ad991167cd06c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnQzoK4p9Zv38E5jbcMH1g.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码-缩放['标准']</figcaption></figure><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kj"><img src="../Images/d8f96676debf08fc93c94d3cc47f7629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8IEor4CdzKYRcFurvMftA.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码-缩放['Nrm']</figcaption></figure><p id="b1ed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.<strong class="io hj">减小数据帧大小并释放RAM </strong> —当我们加载CSV或任何其他文件时，Pandas会创建一个数据帧，该数据帧并未按照某个特性的最大值进行优化。它的意思是，一个特性的最大值可以容纳在int16大小的内存中，但它可能被分配给int64大小的RAM。使用这个代码片段，您可以节省高达70%的内存。如果你正在进行Kaggle比赛，这是必须的。正如您在输出中看到的，<strong class="io hj">616 MB的数据帧通过这个简单的调整减少到了173 MB。代码简单明了。<em class="kh">我们对每一列进行循环，得到它的最大值，然后把它的数据类型改成max limit大于该列最大值的类型。</em></strong></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/3411dd79490af3625cfaae9073a135d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2xZ28mIwy-bHMx5nb17_GA.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码和输出—内存优化</figcaption></figure><p id="606c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 4。标签编码</strong> — ML学习库不接受String/Char作为输入。所以所有的分类特征都必须转换成一个数值。这项任务是通过使用标签编码或一键完成的。在我们的代码片段中，我们使用四种不同的方法对数据进行了编码。在没有现成函数的代码方法中，我们通过枚举特性的唯一值来创建映射字典，然后将该字典映射到数据序列本身。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kj"><img src="../Images/e6d1876e5e70c94e56a73a5d26c354c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iihksmSrNV0ARQtO9-AIlA.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码—标签编码</figcaption></figure><p id="0c8b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 5。One-hot Encoding </strong> —当我们不想向模型传递任何关于特性数值的消息时，使用一个hot Encoding。OHE的缺点是它增加了模型的维数。我们已经使用Sklearn实现了这个任务。当你得到一个稀疏矩阵或非稀疏矩阵的时候要小心。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kl"><img src="../Images/336a434cd543b0515b951373ad987589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uAx62wP71u8B6Am6VPS66g.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码—一键编码</figcaption></figure><p id="72b9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 6。Gridsearch交叉验证</strong> —当您想要尝试多个参数组合以获得最佳工作模型时，Gridsearch是一种方便的方法。您可以为想要尝试的参数值创建一个字典。字典的关键字必须与模型的参数同名。在这种情况下，这些是Sklearn RandomForestClassifer的parm。然后将模式和字典传递给GridSearch构造函数。最后，Gridsearch fit方法的输入和标签数据。然后你就可以看到最好的parm组合，最好的分数。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es km"><img src="../Images/7feeb37dead34a008e06d6c7b8c7792d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fO1mEa1GuxUCkt_WJxQgXw.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码和输出—网格搜索</figcaption></figure><p id="1d47" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 7。将一个模型保存到磁盘和Kaggle提交文件</strong>——这是这篇文章的最后一部分。这里我们有两个简单的代码，第一个是将你的模型保存到磁盘，稍后再重新加载。这个片段可以用于任何Python对象。第二，使用Kaggle API提交你对任何Kaggle比赛的预测。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kn"><img src="../Images/086159f79165bd939d9cc40094d90ab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZR9gtT7csoHMCzI_et_Yw.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">代码—保存到磁盘，提交给Kaggle</figcaption></figure><p id="891c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">8.<strong class="io hj">两个帖子的总结</strong>，在两个帖子中，我们通过这些代码片段算出。随身携带这两个Colab笔记本的副本，用你的学习增强它，提高你的生产力。下面是这篇文章代码的Colab笔记本链接。请在这个帖子和笔记本上发表你的评论。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ko"><img src="../Images/7fdac36ef17fe2c3a291c649eb7ed1fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VOz_4j7joHdaNSGhjQHb7w.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">摘要</figcaption></figure><p id="9b9f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://drive.google.com/open?id=1ERJ3sUWZPvQBksNi79OofD_MKHCLr465" rel="noopener ugc nofollow" target="_blank">链接到代码</a>的Colab笔记本</p><div class="kp kq ez fb kr ks"><a href="https://colab.research.google.com/drive/1ERJ3sUWZPvQBksNi79OofD_MKHCLr465#scrollTo=sObTJPSTAfvq" rel="noopener  ugc nofollow" target="_blank"><div class="kt ab dw"><div class="ku ab kv cl cj kw"><h2 class="bd hj fi z dy kx ea eb ky ed ef hh bi translated">谷歌联合实验室</h2><div class="kz l"><p class="bd b fp z dy kx ea eb ky ed ef dx translated">10XAI —笔记本电脑</p></div></div><div class="la l"><div class="lb l lc ld le la lf ik ks"/></div></div></a></div></div></div>    
</body>
</html>