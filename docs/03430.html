<html>
<head>
<title>Predict Book Price Without using NLP Textual Processing Approach.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不使用NLP文本处理方法预测图书价格。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predict-book-price-without-using-nlp-textual-processing-approach-2de77d64b73b?source=collection_archive---------7-----------------------#2020-01-31">https://medium.com/analytics-vidhya/predict-book-price-without-using-nlp-textual-processing-approach-2de77d64b73b?source=collection_archive---------7-----------------------#2020-01-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/1b6b5ac6780ceb0875991befa642c324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*8X5zbhcMupZZ4ohUvxDI1g.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">让我们试着从封面来判断一本书。</figcaption></figure><p id="addf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我们将看到并尝试在不使用NLP文本处理而仅使用基本方法的情况下预测书的价格，并尝试找出我们如何做到这一点以及我们得到的结果。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/97a9bbd8b78bfe9abd3297a3e4f7cd26.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*Zu-BoijY3YoD7YYCNuPRDg.png"/></div></figure><p id="6d23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，我们有相当多的特征可以用来预测这本书的价格。</p><p id="ccb4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从导入我们需要的基本包和我们得到的数据开始。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jt"><img src="../Images/eda5f7857f96dad578229316e21bc619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OsjKq6MsxEonK8iDy5OqDA.png"/></div></div></figure><p id="21ff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们已经得到了用于训练和测试的下降数据。</p><p id="d164" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们首先从训练数据集中删除价格列，并加入训练和测试数据集，以便我们可以执行不同的数据清理和争论技术。</p><p id="652f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们将价格列数据存储在价目表中，这样我们就可以在开始训练机器学习模型时使用它。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/9d7f3c7e9307d04bf5e7cf96fc02b4d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*3IEAzTji7xULFvwDSmjqJg.png"/></div></figure><p id="f48f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，在我们加入数据框后，让我们从提取数字开始，并使用列中的全部数据。</p><p id="acec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Edition列包含各种版本，这些版本具有相似的发布类型，但发布日期不同，所以首先我们只从列中提取发布类型，并将其存储在一个列表中，然后用列表替换列的值。</p><p id="07c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">评论栏有一篇对这本书的评论，满分为5颗星，所以让我们只取评论号，从栏中去掉5颗星</p><p id="dc8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">评级栏有客户的评级，所以让我们只把数字拿出来，存储在一个列表中，并用一个栏来替换它，就像我们在上面2个步骤中所做的那样</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es if"><img src="../Images/06c1c4f1c43cf113a20300492bc45a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*XHWYlA-fA9iHYDrDOrYZJA.png"/></div></figure><p id="bfa6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经清理了3个重要的柱子。</p><p id="207e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们来处理分类数据。</p><p id="ab8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在对我们的作者、图书类别、流派和版本列进行标签编码。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/e8948c692178d07d19461a2e751e4493.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*NmNeA2c37Rn_HZhbN_Na1g.png"/></div></figure><p id="6b1a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们仍然保留着提要和标题列，我们不能处理这个标题列，因为它对于每本书都是不同的，对于提要列，没有NLP我们没有有效的方法来处理它。所以，我们放弃他们。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/45e1dae30b4bde0336a3d5f8d740fbb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*n7HZ0Lu7woVN_WdT-gzy2w.png"/></div></figure><p id="4b4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们看看我们的数据框是什么样子。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/4023e85bfe1b8f32a6e973aa416c8a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*eheFcP9qEE-C1xx44KWLIw.png"/></div></figure><p id="b9a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们有了一个可以传递给机器学习模型进行训练的数据框架，但首先，我们不要忘记我们已经加入了用于数据争论的训练和测试数据，所以让我们再次划分它们，并将价格列添加到我们存储在上面列表中的训练数据框架中。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/5aa79c7a2080c24533eaa4958f4ca50d.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*a2vqM6H7sPBQhsYIY7FJPQ.png"/></div></figure><p id="0b80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经准备好预测这本书的价格，但首先让我们有一些可视化，这将使我们对所有的功能有一个想法。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/3ba0d113bbcc7d0536ce027e0693ef75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*RdxgmEWp2RTknKJh8bovKg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">我们看到图书类别对整体价格有影响，漫画、政治类书籍的价格高于传记、日记</figcaption></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ke"><img src="../Images/2f16e68fd2427f98b42465cdb43e4fe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*kqcy7dRiRpNOKVZ8FKvbPQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">奇怪的是，我们看到1.0星的书和5.0星的书价格一样高。</figcaption></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/0ef2afc81fd7224fad94b1df56c1dff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*SjB7_uOC2YDe_jjlsqDyqg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">我们现在看到了所有可用功能的关联热图，我们可以看到数据是不稳定的，只有评论与价格具有近乎令人满意的关联。</figcaption></figure><p id="6915" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以从底部的链接中获得每个图形的代码。</p><p id="8f5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们最后从建模部分开始。</p><p id="f962" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从Sklearn导入必要的库，并将数据分为X_train、X_test、y_train和y_test，这将帮助我们划分数据，并将70%的数据用于训练，另外30%用于测试模型。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kg"><img src="../Images/1a01695b1737dfb22c88a34c5056a192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*Q0jvW57a2jIl0Iju-5eE0Q.png"/></div></figure><p id="0665" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我已经使用了许多方法进行预测，但对于本文，让我们只保留2个基于(均方根对数误差)RMSLE得分的最佳模型，RMSLE得分是我们用来判断我们的模型的指标。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/f06871cf56e87afe67722b65634c9010.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*2VkNbJTXuxrCMDr1ScyHow.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">这看起来有点复杂，但不要担心，这只是我们用python编写的一行代码就能实现的均方对数误差的平方根。</figcaption></figure><p id="1d70" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们使用支持向量回归机建立我们的第一个好模型</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/9fb9f0fa8f3069b0ea5cae807ccbe575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*Blptjh9fB3nSOtPOck_ddQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">我们看到我们有SVR回归，我们有一个很好的RMSLE分数0.77</figcaption></figure><p id="2186" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们看看最好的预测模型是LightGBM回归器</p><p id="5d55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为什么轻GBM回归器？</p><p id="016e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">LightGBM 是一个梯度提升框架，它使用基于树的学习算法，被设计成分布式和高效的，具有更快的训练速度和更高的效率，并且它使用<strong class="is hj"> XGBoost </strong>作为基线，在训练<strong class="is hj">速度</strong>和它可以处理的数据集大小方面都优于它。此外，在某些情况下，LightGBM 在不到一分钟的时间内达到最高精度，而只读取整个数据集的一小部分。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/94b5710aa8914246e88f38985bbad06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*tkTnCXZgvSzHlXXw5qn3RQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">我们看到，轻型GBM为我们提供了0.9的RMSLE分数，这是我在使用RFE组合的SVR、Random Forest和XGBoost中获得的最高分数。</figcaption></figure><p id="5a03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它还提供了内置的plot_importance方法，帮助我们了解特性的重要性。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/cac72909db9f21aa79d0e8226114c0e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*HEFugwrCxbsV8IZ-Bz-yFg.png"/></div></figure><p id="6c04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，这篇文章到此为止&amp;谢谢你，如果你还在阅读，你可以得到完整的代码。</p><p id="8082" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并查看文章中未提及的所有不同方法，我使用这些方法预测价格，以及使用的数据集:</p><p id="aad7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kk" href="https://github.com/Chintan99/Predict-Book-Price-without-NLP/blob/master/Book_Price_Prediction-Chintan_Chitroda.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Chintan 99/Predict-Book-Price-without-NLP/blob/master/Book _ Price _ Prediction-Chintan _ chit roda . ipynb</a></p></div></div>    
</body>
</html>