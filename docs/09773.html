<html>
<head>
<title>How to scrape thousands of adoptable pet photos from Petfinder using Petpy API: Part 1 — Gathering pet data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Petpy API从Petfinder中抓取成千上万张可收养的宠物照片:第1部分——收集宠物数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-scrape-thousands-of-adoptable-pet-photos-from-petfinder-using-petpy-api-part-1-b55e3a890845?source=collection_archive---------24-----------------------#2020-09-19">https://medium.com/analytics-vidhya/how-to-scrape-thousands-of-adoptable-pet-photos-from-petfinder-using-petpy-api-part-1-b55e3a890845?source=collection_archive---------24-----------------------#2020-09-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/47a05641853b7eaefb0ae7dd59ae3119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*vbiDfK5wLzNgI1k3j4fjjA.jpeg"/></div></figure><p id="c160" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在制作我的顶点石时，我使用了Petpy API，并按照<a class="ae jk" href="https://github.com/aschleg/petpy/tree/master/notebooks" rel="noopener ugc nofollow" target="_blank">亚伦·施莱格尔关于如何用petpy </a>下载45，000张可收养的猫图像的说明进行操作，在尝试使用一些属性时，我遇到了一些麻烦。我意识到他们已经改变了，我发现很难找到更新的信息。我能够理解它，我甚至找到了更快、更短的做事方法，我想与你分享。</p><p id="c817" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你要做的第一件事是安装petpy。<br/>在终端<code class="du jl jm jn jo b">pip install petpy</code>或在Jupyter <code class="du jl jm jn jo b">! pip install petpy</code>中</p><p id="4fba" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，你需要做的是去<a class="ae jk" href="https://www.petfinder.com/developers/" rel="noopener ugc nofollow" target="_blank"> Petfinder开发者页面</a>获取一个API。</p><p id="4811" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们开始吧。您将希望导入petpy并定义您的API和秘密</p><p id="75c4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">import petpy<br/>pf = petpy.Petfinder('your key', 'your secret')</code></p><p id="8090" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们可以开始使用<code class="du jl jm jn jo b">pf.animals,</code>搜索宠物，但首先，让我们看看所有的参数:</p><p id="f4c6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">animal_id, animal_type, breed, size, gender, age, color, coat, status, name, organization_id, location, distance, sort, pages, good_with_cats, good_with_children, good_with_dogs, before_date, after_date, results_per_page, return_df</code></p><p id="4618" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这个例子中，我们将只关注几个参数，但是完整的文档可以在<a class="ae jk" href="https://petpy.readthedocs.io/_/downloads/en/latest/pdf/" rel="noopener ugc nofollow" target="_blank">这里</a>找到:</p><p id="6367" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">animal_type</code> -这将是一个字符串，是要搜索的动物类型。</p><p id="6ff1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">size</code> -尺寸选项有“小”、“中”、“大”和“xlarge”。</p><p id="ec5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这可以有三种格式:经度、邮政编码或城市、州。</p><p id="b7fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">distance</code> -默认为100英里，但您最多可以输入500英里。</p><p id="9fa8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">pages</code> -您想要返回的页数。</p><p id="28be" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">results_per_page</code> -您希望每页返回的结果数量。</p><p id="33f3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">return_df</code>您是否希望返回一个熊猫数据框。</p><h2 id="a78a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ix ka kb kc jb kd ke kf jf kg kh ki kj bi translated">让我们寻找一些兔子吧！</h2><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es kk"><img src="../Images/fcdf9a15a27a59a0bcbef7d281a40f48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqbskzByop8tCEGCj9zlKA.jpeg"/></div></div></figure><p id="9b0a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">rabbit = pf.animals(animal_type='rabbit', size='small', location=76825, distance=500, pages=1, results_per_page=5, return_df=True)</code></p><p id="717f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我选择了德克萨斯州的中心作为地点，用最大距离寻找5只小兔子。结果返回了一个数据框，其中有5行是我的5只兔子，48列是不同的属性、照片和信息。以下是完整列表:<code class="du jl jm jn jo b">['id', 'organization_id', 'url', 'type', 'species', 'age', 'gender', 'size', 'coat', 'tags', 'name', 'description', 'organization_animal_id', 'photos', 'videos', 'status', 'status_changed_at', 'published_at', 'distance', 'breeds.primary', 'breeds.secondary', 'breeds.mixed', 'breeds.unknown', 'colors.primary', 'colors.secondary', 'colors.tertiary', 'attributes.spayed_neutered', 'attributes.house_trained', 'attributes.declawed', 'attributes.special_needs', 'attributes.shots_current', 'environment.children', 'environment.dogs', 'environment.cats', 'primary_photo_cropped.small', 'primary_photo_cropped.medium', 'primary_photo_cropped.large', 'primary_photo_cropped.full', 'contact.email', 'contact.phone', 'contact.address.address1', 'contact.address.address2', 'contact.address.city', 'contact.address.state', 'contact.address.postcode', 'contact.address.country', 'animal_id', 'animal_type', 'organization_id']</code></p><p id="f2f0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当抓取图像时，我们不需要这些列中的大部分，所以我将删除一些以使我们的数据帧更干净，但首先我们应该将我们的数据保存到csv，以防我们搞砸了，需要重新开始。我们真的不想重新收集数据，尤其是如果有成千上万的结果。</p><p id="2947" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">rabbit.to_csv('./rabbits.csv')</code></p><p id="6628" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我将从兔子数据框创建一个新的数据框，该数据框只包含包含单词id、品种或照片的列，并将其命名为rabbitCLEANED</p><p id="15da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">rabbitCLEANED = rabbit[rabbit.columns[rabbit.columns.str.contains('id|breed|photo')]]</code></p><p id="bb08" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">还有几列我们不需要，所以我们可以删除它们。</p><p id="7155" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">rabbitCLEANED.drop(columns=['organization_id', 'organization_id','organization_animal_id', 'videos'], inplace=True)</code></p><p id="0ddb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我将把清理后的数据帧导出到csv文件中进行备份。</p><p id="8e8e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du jl jm jn jo b">rabbitCLEANED.to_csv('./rabbitCLEANED.csv')</code></p><p id="e7e4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们看看我们的数据框架</p><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es kt"><img src="../Images/555ba3b8099d8f3aa82d79ac1ba38296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xKDORtaq3p3d4V62MRG2ZA.jpeg"/></div></div></figure><p id="eeed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们剩下的唯一的列是包含照片、品种和动物id的列。这给了我们一个很好的切入点。<a class="ae jk" rel="noopener" href="/@shinermaz/how-to-scrape-thousands-of-adoptable-pet-photos-from-petfinder-using-petpy-api-part-2-57abb0ef7146">这是我们下载图片的第二部分！</a></p><p id="9b8d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">来自<a class="ae jk" href="https://www.petfinder.com" rel="noopener ugc nofollow" target="_blank"> Petfinder </a>的照片</p></div></div>    
</body>
</html>