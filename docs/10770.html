<html>
<head>
<title>DATA PREPROCESSING: Decreasing Categories in Categorical Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据预处理:减少分类数据中的类别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-preprocessing-decreasing-categories-in-categorical-data-132e8b4a4fd?source=collection_archive---------0-----------------------#2020-11-02">https://medium.com/analytics-vidhya/data-preprocessing-decreasing-categories-in-categorical-data-132e8b4a4fd?source=collection_archive---------0-----------------------#2020-11-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d7c39c274d7fde3444d909b95cdcc079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBn-ROC_CF_pheuqczMWiQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">马库斯·斯皮斯克拍摄的照片</figcaption></figure><p id="cc83" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下一篇文章将研究各种数据类型，重点关注分类数据，回答为什么以及如何减少类别，并以Python中的实际例子结束。本文还将探讨一种不同的方法，可用于缺失值插补和减少类别。</p><h2 id="a404" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">数据预处理和各种数据</h2><p id="2c10" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">数据预处理提高了数据的质量，以促进有意义的见解的提取。在机器学习中，它指的是原始数据的转换，使其适用于机器学习模型。数据可以是连续的，也可以是离散的。离散数据只能取特定的值。这些值可能有无数个，但每个都是不同的，在它们之间没有灰色地带。离散数据可以是数字(如苹果的数量)，也可以是分类数据，如红色或蓝色，或好或坏。连续数据不限于定义的不同值，而是可以取连续范围内的任何值。在任何两个连续的数据值之间，可能有无限多个其他值。连续数据本质上总是数值型的。</p><h2 id="3b13" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">分类数据</h2><p id="f78f" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">分类数据可以分为名义数据和顺序数据。名义上指的是具有一个以上类别的数据，但是在有序数据中存在的类别之间没有内在的顺序。例如，性别是一个有两个类别(男性和女性)的分类变量，类别没有内在的顺序。相比之下，幸福指数的值(0-10)自然序列为10，表示比0更幸福。</p><h1 id="ed63" class="kt ju hi bd jv ku kv kw jz kx ky kz kd la lb lc kg ld le lf kj lg lh li km lj bi translated">为什么减少分类变量中的类别？</h1><p id="2689" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">在数据集上训练ML/DL模型并在测试和验证集上获得满意的结果可能是个人项目的最终目标。尽管如此，在组织中，这些结果也应该与管理层的想法相吻合。假设ML/DL模型具有不错的准确性，表明某个特定的分类变量非常重要，包含15-20个类别。现在，这可能是压倒性的，因为很难理解变量的不同值如何影响结果，但如果有4-5个类别，这可以很快计算出来。</p><h2 id="bdab" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><span class="l lk ll lm bm ln lo lp lq lr di"> T </span>他依据哪些范畴可以进行归纳？</h2><p id="0889" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">首先考虑两种情况，其中变量是一个常量，即变量的所有值都相同；第二种情况是变量的所有值都不同，比如每行的“ID”。</p><p id="57e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这两种情况下，建议在定型模型之前删除变量，因为第一种情况没有变化，第二种情况变化很大。ML/DL模型可以理解数据中的模式，但在可变性非常低或非常高的情况下会失败。通俗地说，如果所有的值都不相同，怎么能预测呢？如果所有的值都相同，又有什么必要预测呢？</p><h2 id="49f9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">类似地，出现率小于1%的所有类别都可以忽略/减少。</h2><h2 id="d620" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">如何减少类别？</h2><p id="44ef" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">当决定要删除的类别时，非常简单，用空值替换那些值，并在缺失值处理中处理它们。</p><p id="a76c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">缺失值处理的各种方法包括:</p><p id="0e90" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.集中趋势—平均值/中间值/众数</p><p id="b0fe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.最频繁或恒定值插补。</p><p id="8d35" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.链式方程多元插补(小鼠)。</p><p id="fc4e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.使用KNN的插补</p><p id="5e4e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">5.使用机器学习/深度学习的插补。</p><p id="160e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">参考威尔·巴德尔的一篇文章。</p><h2 id="b059" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">T2的例子</h2><p id="443f" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">下面的文章展示了一个数据预处理代码演练和一些关于如何使用Python减少分类列中的类别的例子。</p><ol class=""><li id="ebfe" class="ls lt hi ix b iy iz jc jd jg lu jk lv jo lw js lx ly lz ma bi translated">导入数据</li></ol><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/694bab722d216beb0c1e65d6761122e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhuNbZPQ7rrCgOuVbwfAdA.png"/></div></div></figure><p id="246c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.检查空值并查找分类列。</p><div class="mc md me mf fd ab cb"><figure class="mg ij mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/959d210e9519e154b1eb9871dacfaec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*zA0vSC4YE085-3oPBHIAMg.png"/></div></figure><figure class="mg ij mm mi mj mk ml paragraph-image"><img src="../Images/f0a724f689bbacb5721f1322b8f3b2c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Dy4KrPnG1rOS1CmgCYdcaw.png"/></figure></div><p id="9f5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.让我们从“申请人_婚姻状况”开始逐一检查这些列。</p><div class="mc md me mf fd ab cb"><figure class="mg ij mn mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ede9e22927cdace11e5348fd4b926f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*DfMKrUm-uB7QoI1OJJo7iQ.png"/></div></figure><figure class="mg ij mo mi mj mk ml paragraph-image"><img src="../Images/b4a12a3219a9f5dcb95c1badb0879193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*eU3ZpZI3eo340apVR4gYxw.png"/><figcaption class="iq ir et er es is it bd b be z dx mp di mq mr translated">Raghuvansh Tahlan的申请人婚姻状况</figcaption></figure></div><p id="70bc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总共有5045个记录，其中30个缺失，有两个类别“W”和“D ”,分别对应于丧偶和离婚，这两种情况发生的次数非常少，可以减少。</p><p id="53e5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这可以通过用空值替换“W”和“D”来实现。</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/e57b384dc574a53596a0ad07b4dd3f78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4iXBgaCS7oqk4LOJlI-jQ.png"/></div></div></figure><p id="e39a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">空值的计数也表明我们的代码执行正确。</p><p id="2a01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.现在，这些值可以通过任何缺失值估算技术进行估算。</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/be00fc5be45996a07d14f89ae2c76e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFGd8REf-qohkkRUbiRAuQ.png"/></div></div></figure><h2 id="e8b1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">集中趋势插补总是一个好的选择吗？</h2><p id="dd32" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">让我们看看另一个专栏“申请人_职业”的例子。</p><figure class="mc md me mf fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/291bfe64c1a341927367c69b64f5f80c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*yFiFTJHNR_JyCkRelmmQ7Q.png"/></div></figure><p id="203c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以清楚地看到，Student只有19条记录，相当于总值的0.38%，因此删除这个类别似乎是可行的。</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/732373138a2532321ac285765beb23c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qudlxZp4vUbvbTQuIY1spg.png"/></div></div></figure><p id="7cfd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一切正常，但是有1023条记录缺少值，这是一个问题，因为这相当于总记录的20%。</p><p id="86d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们考虑一下，如果我们用集中趋势——众数来估算这些值。</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/28c05c8139ebd0a98a7660b22289e519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*56qb1MDTehQ9o_NB0XJu1g.png"/></div></div></figure><p id="d242" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在工薪阶层的比例已经从51%上升到71%，这是没有说服力的。比较最高和最低发生类别，它们的比率从8增加到11。</p><p id="f6a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们使用其他插补技术，如KNN、DL、MICE等，就可以避免这个问题。</p><h2 id="1da9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">我解决这个问题的方法</h2><p id="00cc" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">这种方法认为，即使在插补后，每个类别在人口中的百分比也将保持不变。因此，要估算的缺失值根据其在人口中的百分比在人口类别中进行划分。为了证明这一点，我们举了上面的例子:</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/b444447810cd63c0bfc4db9d27240961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kx3idu35QkgAeIP9pSk2pA.png"/></div></div></figure><p id="45ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最初，对于受薪类别2560是4022个非空值总数的63%,然后在插补后，该值应保持不变，因此保持63%不变，如果值的总数为5045，则应有3211个值。这给我们留下了651个要估算的值。类似地，计算所有类别的值。</p><p id="f900" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就给我们留下了自动化这个过程并从列中输入有限数量的空值的任务。</p><h1 id="e485" class="kt ju hi bd jv ku kv kw jz kx ky kz kd la lb lc kg ld le lf kj lg lh li km lj bi translated">自动化</h1><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/85f89c172ffea3b42a86c0b7da7923df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oy3dLfljm_oADo3NYeqwug.png"/></div></div></figure><p id="2340" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">函数‘find _ index’给出了从列的开始直到出现指定数量的空值的索引。</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/8aa64fe3ad17b7d8464b842fa314ac6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f5BUVFUSydBQwEWIfQx8Sg.png"/></div></div></figure><p id="8b25" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">函数“replace_cat_list”使用“find_index”函数根据提供的类别填充来自动执行填充空值的过程。使用相同的示例:</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/0827cec6c0900a72d9a4fc9b0b281bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gMEp6lQTcEupb6etXRZYlw.png"/></div></div></figure><p id="afd3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“replace_cat_list”考虑了数据帧、要估算的列名和要考虑的类别列表。</p><p id="e415" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">欢迎提出建议和意见。在<a class="ae iu" href="https://www.linkedin.com/in/raghuvansh-tahlan/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上与我联系。本文的所有源代码都可以在<a class="ae iu" href="https://github.com/rvt123/Medium_Articles/tree/main/Data_Preprocessing_Reduce_Categories" rel="noopener ugc nofollow" target="_blank"> Github </a>获得。</p></div></div>    
</body>
</html>