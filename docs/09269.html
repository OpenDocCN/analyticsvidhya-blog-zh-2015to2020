<html>
<head>
<title>Semantic Search using NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自然语言处理的语义搜索</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/semantic-search-engine-using-nlp-cec19e8cfa7e?source=collection_archive---------1-----------------------#2020-08-31">https://medium.com/analytics-vidhya/semantic-search-engine-using-nlp-cec19e8cfa7e?source=collection_archive---------1-----------------------#2020-08-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="66ff" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用搜索查询的语义理解构建智能搜索引擎的入门指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/d1da66bc6044c0eb0b00a1a391a14860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*GLZ4j3lsWLT396543CR7bQ.jpeg"/></div></figure><h1 id="2c6e" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">介绍</h1><p id="50d3" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">搜索引擎已经伴随我们几十年了，成为我们数字生活不可或缺的一部分。我们随意搜索数十亿个网页，从各种资源中检索和分享信息。虽然人类非常擅长对话上下文和背景知识，这有助于他们处理单词的内在歧义，但在搜索引擎的情况下可能不是这样，特别是当涉及到<em class="kt">超出词汇表</em>的搜索时</p><p id="0e6f" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">这个问题的答案是<strong class="jz hj"> <em class="kt">语义</em> </strong>搜索。使用来自NLP研究的最新见解，可以在大型文档语料库上训练语言模型。然后，该模型能够基于文档的"<em class="kt">语义"</em>内容来表示文档。特别是，这包括搜索具有语义相似内容的文档的可能性。</p><blockquote class="kz la lb"><p id="e364" class="jx jy kt jz b ka ku ij kc kd kv im kf lc kw ki kj ld kx km kn le ky kq kr ks hb bi translated">根据数据科学<a class="ae lf" href="https://towardsdatascience.com/semantic-search-73fa1177548f" rel="noopener" target="_blank">的说法，语义搜索意味着理解查询背后的意图，并“以一种适合有意义检索的方式来表示知识”。</a></p></blockquote><p id="0dc7" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">在这项工作中，我们将使用基于自然语言处理(NLP)概念的语义搜索来检索相关的电影标题</p><p id="89eb" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">对于那些想直接跳到代码的人，这里有我的Kaggle笔记本的链接。</p><div class="lg lh ez fb li lj"><a href="https://www.kaggle.com/ajitrajput/semantic-search-engine-using-nlp" rel="noopener  ugc nofollow" target="_blank"><div class="lk ab dw"><div class="ll ab lm cl cj ln"><h2 class="bd hj fi z dy lo ea eb lp ed ef hh bi translated">使用自然语言处理的语义搜索引擎</h2><div class="lq l"><h3 class="bd b fi z dy lo ea eb lp ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自电影相似性的数据</h3></div><div class="lr l"><p class="bd b fp z dy lo ea eb lp ed ef dx translated">www.kaggle.com</p></div></div><div class="ls l"><div class="lt l lu lv lw ls lx jd lj"/></div></div></a></div><h2 id="d44e" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">关键词搜索与语义搜索</h2><p id="1636" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">起初，搜索引擎是词汇性的:搜索引擎寻找查询词的文字匹配，不理解查询的含义，只返回包含精确查询的链接。通过使用常规关键字搜索，文档要么包含给定的单词，要么不包含，没有中间地带</p><p id="0aac" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">另一方面，“语义搜索”可以简化查询构建，因为它由自动自然语言处理程序支持，即使用潜在语义索引，这是搜索引擎用来发现关键字和内容如何共同表示同一事物的概念。</p><blockquote class="kz la lb"><p id="0a21" class="jx jy kt jz b ka ku ij kc kd kv im kf lc kw ki kj ld kx km kn le ky kq kr ks hb bi translated">根据维基百科，</p><p id="8bad" class="jx jy kt jz b ka ku ij kc kd kv im kf lc kw ki kj ld kx km kn le ky kq kr ks hb bi translated">LSA(潜在语义分析)也称为LSI(潜在语义索引)LSA是自然语言处理中的一种技术，通过产生一组与文档和术语相关的概念来分析一组文档和它们包含的术语之间的关系。LSI是基于这样一个原则，即在相同的上下文中使用的单词往往有相似的意思。LSI的一个关键特性是它能够通过在相似上下文中出现的术语之间建立关联来提取文本主体的概念内容。</p></blockquote><p id="14fa" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">LSI为文档索引过程增加了重要的一步。LSI检查一组文档，看哪些文档包含一些相同的单词。LSI认为有许多共同单词的文档在语义上是接近的，而那些有较少共同单词的文档则不太接近。</p><p id="d6db" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">简而言之，LSI不需要精确匹配来返回有用的结果。如果没有精确匹配，简单的关键字搜索就会失败，LSI通常会返回根本不包含关键字的相关文档。</p><h2 id="e517" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">加载数据</h2><p id="ac21" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们现在将电影数据csv加载到dataframe中，并快速查看所提供的列和数据</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="er es mo"><img src="../Images/e50c6d70541d783bb134a0633ad7e045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v4wJtq2onoJF_KIWD8-Bsw.png"/></div></div></figure><h2 id="8da7" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">数据清理和预处理</h2><p id="18f9" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">数据预处理是文本分析中最重要的步骤之一。这样做的目的是删除任何不需要的单词或字符，这些单词或字符是为了便于阅读而编写的，但无论如何不会对主题建模有所贡献。</p><p id="4c61" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">以下函数应用正则表达式来匹配不需要的文本模式，并删除/替换它们。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="0a6d" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">现在让我们将数据清理和预处理功能应用到我们的movies“wiki _ plot”列，并将清理后的、标记化的数据存储到新列中</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="er es mt"><img src="../Images/d75142ba56a7116a6c74469360f49bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWYJi3uCRa8pTLngkppXmw.png"/></div></div></figure><h2 id="7318" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">构建单词词典</h2><p id="ef15" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在下一步中，我们将构建语料库的词汇，其中所有唯一的单词都被赋予id，并且它们的频数也被存储。您可能会注意到，我们使用gensim库来构建字典。在gensim中，单词被称为“令牌”,字典中每个单词的索引被称为ID</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="542a" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">您可以看到，在创建字典之后还执行了2个额外的步骤。</p><ol class=""><li id="6c83" class="mu mv hi jz b ka ku kd kv kg mw kk mx ko my ks mz na nb nc bi translated">字典中出现在少于4篇文章中或者出现在多于20%的文章中的所有单词都从字典中移除，因为这些单词不会对各种主题或话题有所贡献。</li><li id="a9e7" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks mz na nb nc bi translated">从词典中删除内容中性词和附加停用词。</li></ol><h2 id="f00c" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">特征提取(单词袋)</h2><p id="fcab" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">一袋单词模型，简称BoW，是一种从文本中提取特征用于建模的方法，例如使用机器学习算法。它是描述单词在文档中出现次数的tet的表示。它涉及两件事</p><ol class=""><li id="2624" class="mu mv hi jz b ka ku kd kv kg mw kk mx ko my ks mz na nb nc bi translated">已知单词的词汇表</li><li id="fbc6" class="mu mv hi jz b ka nd kd ne kg nf kk ng ko nh ks mz na nb nc bi translated">已知单词存在的一种度量</li></ol><p id="6126" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">dictionary的doc2bow方法遍历文本中的所有单词，如果该单词已经存在于语料库中，则它递增频率计数，否则它将该单词插入到语料库中，并将其频率计数设置为1</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mm mn l"/></div></figure><h2 id="6ea0" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">建立Tf-Idf和LSI模型</h2><p id="863f" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">Tf-Idf的意思是，词频-逆文档频率。它是一个常用的NLP模型，可以帮助您确定语料库中每个文档中最重要的单词。一旦构建了Tf-Idf，就将其传递给LSI模型，并指定要构建的特性数量</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mm mn l"/></div></figure><h2 id="0e1b" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">语义搜索时间到了</h2><p id="f3f5" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在有趣的部分来了。随着电影索引的初始化和加载，我们可以使用它来查找相似的电影</p><p id="d481" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">我们将输入一个搜索查询，模型将返回相关的电影标题与“相关性%”，这是相似性得分。相似性得分越高，查询与给定索引处的文档越相似</p><p id="d34c" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">下面是搜索索引、排序和返回结果的帮助函数</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mm mn l"/></div></figure><pre class="iy iz ja jb fd ni nj nk nl aw nm bi"><span id="61ba" class="ly jg hi nj b fi nn no l np nq"><em class="kt"># search for movie tiles that are related to below search parameters</em><br/>search_similar_movies('crime and drugs ')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="er es nr"><img src="../Images/f5d7931b5eb5274c01d5486d99282776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vLQgGBgA3IQjNnJkGQwDkg.png"/></div></div></figure><p id="07bd" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">该模型返回具有“相关性%”的电影标题。毫无疑问，最受欢迎的电影与犯罪和毒品有关。</p><pre class="iy iz ja jb fd ni nj nk nl aw nm bi"><span id="2002" class="ly jg hi nj b fi nn no l np nq"><em class="kt"># search for movie tiles that are related to below search parameters</em><br/>search_similar_movies('violence protest march')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="er es ns"><img src="../Images/a35f68b95a613fec101f4a9ee9917bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5jimU9XqjveqzLm-1VbeA.png"/></div></div></figure><p id="5cc5" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">这里最热门的电影名“甘地”肯定与非暴力抗议有关</p><h2 id="dddf" class="ly jg hi bd jh lz ma mb jl mc md me jp kg mf mg jr kk mh mi jt ko mj mk jv ml bi translated">结束语</h2><p id="9f55" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">一般来说，计算文本数据之间的语义关系能够推荐与给定查询相关的文章或产品，跟踪趋势，更详细地探索特定主题。</p><p id="24cd" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">在本文中，我们看到了如何实现语义搜索的基本版本。有许多方法可以使用更新的深度学习模型来进一步增强它。</p><p id="4ea6" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">这只是试图展示我在NLP和机器学习领域的学习历程。欢迎您的宝贵反馈、意见和建议！</p><p id="057c" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">希望大家都喜欢，投上一票。</p></div></div>    
</body>
</html>