<html>
<head>
<title>Implementing different CNN Architectures on Plant Seedlings Classification dataset — Part 1 (LeNet)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在植物幼苗分类数据集上实现不同的CNN架构—第1部分(LeNet)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implementing-different-cnn-architectures-on-plant-seedlings-dataset-to-get-a-good-score-part-1-a90c2d3f306f?source=collection_archive---------13-----------------------#2020-11-30">https://medium.com/analytics-vidhya/implementing-different-cnn-architectures-on-plant-seedlings-dataset-to-get-a-good-score-part-1-a90c2d3f306f?source=collection_archive---------13-----------------------#2020-11-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="5f96" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">本文将是一个系列，其中我在植物幼苗数据集上实现了不同的CNN架构，包括我自己的定制模型，并检查了分数，以更好地理解不同的卷积神经网络。</p><p id="25db" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这篇文章将有“LeNet”实现，下一组文章将有其他CNN架构，最后一组文章将有我们自己的定制模型，这将为我们提供一个好的分数，并且可以在任何Kaggle数据集上遵循通用方法。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="9b18" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">作为一名数据科学的初学者，我对计算机视觉非常感兴趣，这是因为，在计算机视觉中完成的工作很容易看到(通过脸书和谷歌的应用程序，例如。而我们，作为人类，总是倾向于追求闪光的东西。即使在传统的机器学习甚至NLP领域已经做了很多工作，我们还是觉得计算机视觉，更有意思。在经历了神经网络的最初概念后，我开始探索CNN，我立即知道，从理论上理解所有这些非常重要，但实际实施也同样重要。我们做过的一些最常见的数据集有，<strong class="io hj"> MNIST，CIFAR-10，猫狗品种分类等。</strong></p><p id="3652" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">但是这些数据集是为了理论目的而精心策划的。我知道我必须拿出一个数据集，利用它，我可以从头开始做任何事情，这意味着，获取数据，重塑数据，拆分数据，从头开始实施不同的CNN架构，然后最终构建我自己的定制模型并测试其效率。现在，为了得到一个多类图像数据集，我去了Kaggle，在那里，我得到了<a class="ae jk" href="https://www.kaggle.com/c/plant-seedlings-classification/overview" rel="noopener ugc nofollow" target="_blank">植物幼苗</a>数据集。</p><p id="da3a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个数据集是一个操场预测比赛，我可以创建一个模型，用它来获得一些预测，然后通过将结果上传到Kaggle平台来测试它们。我认为这是测试所有不同CNN架构的好方法，包括我自己的定制模型。</p><p id="bada" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是从头开始研究架构和实现它的一种很好的迭代方式。</p><p id="6e33" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我曾经遵循的练习是阅读CNN架构研究论文，然后在植物幼苗数据集上从头开始实现它们。我有一台16 GB内存的MSI GF-65笔记本电脑，我的GPU是6 GB Nvidia 1660ti(还是不够…:-)。</p><p id="894d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我实现的各种架构如下:</p><ol class=""><li id="14b5" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jq jr js jt bi translated">LeNet</li><li id="b5f8" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jq jr js jt bi translated">Alexnet</li><li id="1a8e" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jq jr js jt bi translated">VGG</li><li id="7a77" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jq jr js jt bi translated">开始</li><li id="4a12" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jq jr js jt bi translated">定制模型</li></ol><p id="3e13" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们从实现不同的架构开始:</p><ul class=""><li id="093c" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">我首先下载数据，这是一个zip文件，然后提取内容。我看到有三个文件夹:'<em class="ka">培训</em>'、<em class="ka">测试</em>、<em class="ka">样本提交. csv </em>'。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/22983769251917b4bc30bed313a39bb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nNeFYhDU3FApYuoI4d8K6w.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">植物幼苗数据</figcaption></figure><ul class=""><li id="fe82" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">然后，我检查了“火车”数据文件夹，看到有12个不同的类。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kr"><img src="../Images/58f1e91c4b12c12b68e8ec5bde407622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*u8JXTZ3VhYdvewtMIP1jpw.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">植物幼苗数据内的不同类别</figcaption></figure><ul class=""><li id="3ae5" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">我手动检查了每个文件夹中的不同项目，发现一些类与其他类相比有更多的图像。</li><li id="f2b3" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">这是令人担忧的，因为我知道模型会偏向数量更多的图像。</li><li id="451c" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">为了解决这个问题，我创建了一个新的train文件夹，从每个类中复制了200张图片。</li><li id="9ccc" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">然后我创建了一个验证集，里面有来自每个类的20张图片。这样，我就防止了不必要的偏见在模型中蔓延。</li><li id="0e28" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">既然训练和验证数据已经准备好了，我就开始实现不同的模型。</li></ul><ol class=""><li id="6536" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jq jr js jt bi translated">LeNet:我从LeNet架构开始，阅读了研究论文，并用Keras实现了代码。</li></ol><ul class=""><li id="7966" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">我首先导入所有的包。我用的是Tensorflow-gpu 1.15和Keras 2.3.1</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ks"><img src="../Images/0c116e10bb66759c967b6d0b11aec0e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*r0-Kb9Uo7cQOk_e4eGOwAg.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">导入所有包</figcaption></figure><ul class=""><li id="2169" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">然后，我使用图像数据生成器来创建我的训练和验证集。这将处理所有需要训练数据和标签的预处理步骤。这包括标准化，增加一些剪切和缩放范围，以创建一定程度的数据扩充。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kt"><img src="../Images/9250cac5eb69d5ac9324062542ddfeda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xo1-nquFOedwfStInXA_qQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">使用图像数据生成器创建训练和验证集。</figcaption></figure><ul class=""><li id="d3f3" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated"><strong class="io hj"> Keras ImageDataGenerator </strong>接受一批输入图像，对每幅图像应用一系列随机变换，然后用最近变换的图像替换原始图像。</li><li id="61ee" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">数据设置完成后，我创建了LeNet模型:</li><li id="389d" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">它由两个卷积层组成，中间是max pooling层，后面是两个完全连接的层。</li><li id="3f52" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">然后，我使用“Adam”作为我的优化器，因为有12个类，所以我使用“Categorical _ Crossentropy”作为我的损失。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ku"><img src="../Images/9adb7633d18f0c4e63af6dbaf2c41e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5UDdIQ_kWrF-9zPOuQ2iJw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">LeNet模型</figcaption></figure><ul class=""><li id="ca66" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">然后，我对模型进行10个时期的训练，训练步骤为500，验证步骤为300。我将训练集和验证集传递给模型。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kv"><img src="../Images/33df0ed7fd04baa400525cb83b4d4dcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9WUyg98nq3GYjb2Fh4q4aQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">损失和准确性的模型训练</figcaption></figure><ul class=""><li id="01cb" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">根据上面的图像，我们可以确认我们的准确率从未超过73%。</li><li id="5537" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">保存模型后，我在测试集上使用它，并生成一个sample_submission.csv文件，其中包含ID和适当的类。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kw"><img src="../Images/c58c0a35eac0e5e34a0deeddcfe57555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNfgDkNMOPuT1mfxE--g-w.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">将模型保存到磁盘并加载模型进行预测</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kx"><img src="../Images/38a3638511fdf64d9f40c7b0df0bf5e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P-KovJWQrhtmhlQKqq_zXg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">加载模型并将其用于预测</figcaption></figure><ul class=""><li id="3d14" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">基于上面的图像，我使用模型开始对测试集进行预测。</li><li id="b1ac" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">我使用glob库获得所有文件的列表，然后遍历它们，将图像的名称附加到一个名为“IDs”的空列表中。</li><li id="7496" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">然后我加载图像，将其转换为数组，然后使用' expand_dims '来展平数组。</li><li id="af6f" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">然后我用我的模型做预测，它以数组的形式出现。对于ex: [[0，0，0，1，0，0，0，0，0，0，0，0]]</li><li id="1a26" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">我使用“If-Else”条件来获取各种类，并将它们附加到一个名为“Preds”的空列表中。</li><li id="a93c" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">我现在使用“Ids”和“Preds”来创建我的“sample_submission.csv”文件。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ky"><img src="../Images/bd98c92d4dee54e9208207204c094d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zzxCNP1gNIIoELi4_g-sQA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">将预测保存到CSV文件中</figcaption></figure><ul class=""><li id="0827" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">您应该总是打开'<strong class="io hj"> sample_submission.csv </strong>'文件，该文件是通过Kaggle数据获得列名的。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kz"><img src="../Images/c1cf6d5f4b323a74a50656081d39a718.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*6y1r4y_AgHeCJ4eFz-e7YA.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">样本提交文件的列</figcaption></figure><ul class=""><li id="8860" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">因为我现在知道这些专栏了，所以我使用相同的名称准备CSV，然后上传到Kaggle。</li><li id="7827" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">为此，请转到<a class="ae jk" href="https://www.kaggle.com/c/plant-seedlings-classification/overview" rel="noopener ugc nofollow" target="_blank">植物幼苗分类</a>，点击<strong class="io hj">迟交</strong>。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es la"><img src="../Images/1f5fc3defef5d0d451da078036bb55a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wb5z54Qr09_LNBhIW5icLg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">延迟提交选项卡</figcaption></figure><ul class=""><li id="8f51" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">当你点击“延迟提交”时，你会看到一个上传文件的选项。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lb"><img src="../Images/4dba00161a876602f0dbc86fede0ebf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8YRZla3YyDYcE4K1wwK7hQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">上传文件以获得分数</figcaption></figure><ul class=""><li id="a049" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">文件上传后，点击“提交”，获得分数。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lc"><img src="../Images/2a2e62d80b5c912de798c611e6276e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*kOHdZsBfizbA3bCjop0ICA.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">上传文件并提交</figcaption></figure><ul class=""><li id="af6d" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">所以，我得到了大约29%的分数，这意味着，我只能正确预测100张图片中的29张。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ld"><img src="../Images/7788189f9180201daf36a1a3ceeb64d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H3CW48WZ-mKx6s6fUHYBXg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">预测的分类分数</figcaption></figure><ul class=""><li id="89d3" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jz jr js jt bi translated">很明显，我错过了很多东西。也许，一个额外的卷积层可以做到这一点，或者我可以增加纪元的数量。我可以使用一个不同的优化器，它的学习速度会随着时间而衰减。</li><li id="ddc4" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">我是一个初学者，所以有很多东西是缺失的。我不得不手动检查每个类的图像数量，并且不得不手动创建我自己的训练和验证集。</li><li id="f662" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">在下一个系列中，我将提出一个不同的策略来增加分数，这是我目前的目标，之后，我还将自动创建训练集和验证集。</li><li id="a7c8" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jz jr js jt bi translated">我知道这是一篇很长的文章，但我希望它对CNN的初学者有所帮助，尝试在不同的数据集上工作。</li></ul></div></div>    
</body>
</html>