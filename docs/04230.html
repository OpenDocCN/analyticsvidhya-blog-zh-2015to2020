<html>
<head>
<title>Pandas for Data Analysis — Practical guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据分析用熊猫——实用指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-data-frame-practical-guide-to-get-started-on-data-science-projects-60c6453db90c?source=collection_archive---------18-----------------------#2020-03-10">https://medium.com/analytics-vidhya/pandas-data-frame-practical-guide-to-get-started-on-data-science-projects-60c6453db90c?source=collection_archive---------18-----------------------#2020-03-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/572ed7e9837bc1d6b27eaf07f9533302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lx0YIV2h5UqRIybj.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><p id="a1ab" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Pandas Data Frame可能是最通用的，广泛用于处理结构化数据。如果您正在从Excel/SQL迁移到Python熊猫数据框是你将要使用的第一个东西。大多数数据科学项目都涉及结构化数据，只有少数项目除外，如图像处理等。</p><p id="9f19" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我试图列出一些在构建工作代码时所面临的实际场景的方法。<strong class="iw hj"> <em class="js">本文使用3个样本数据集&amp;有演示概念的工作代码，便于参考&amp;可移植性</em> </strong></p><p id="f57c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">注</strong>:以下场景有多种实现方式。我试图列出一些我认为有用且易于理解的基本方法。请随意探索您自己的方法，并分享相同的方法。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/947c185af3ad4dc8f1d5aa254c7654d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SHoYqpPiUY1zJGwx.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="f5ef" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">用于演示的数据</h1><ol class=""><li id="d3d5" class="kv kw hi iw b ix kx jb ky jf kz jj la jn lb jr lc ld le lf bi translated"><strong class="iw hj"><em class="js">Movie _ user _ rating</em></strong>—这包含了电影&amp;的用户评分</li></ol><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="6620" class="ll jy hi lh b fi lm ln l lo lp">+----------+---------+---------------+----------------+<br/>| Movie_ID | User_ID | Review_rating | Review_comment |<br/>+----------+---------+---------------+----------------+<br/>| M1       | U1      |             4 | Very Good      |<br/>| M2       | U2      |             2 | Bad            |<br/>| M3       | U3      |             1 | Interesting    |<br/>| M4       | U4      |             5 | Very Good      |<br/>| M1       | U5      |             3 | Good           |<br/>| M2       | U6      |             1 | Poor           |<br/>+----------+---------+---------------+----------------+</span></pre><p id="02fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.<strong class="iw hj"><em class="js">Movie _ details</em></strong>—包含电影的详细信息</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="a9e2" class="ll jy hi lh b fi lm ln l lo lp">+----------+--------------+--------------------+---------------+<br/>| Movie_ID |  Movie_Name  | Movie_Release_year | Move_Director |<br/>+----------+--------------+--------------------+---------------+<br/>| M1       | Drive Angry  |               2017 | Kunal         |<br/>| M2       | Transformers |               2015 | Sidd          |<br/>| M3       | Fallen Angel |               2002 | Shyam         |<br/>| M4       | White House  |               2019 | Bhargava      |<br/>+----------+--------------+--------------------+---------------+</span></pre><p id="0de3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.<strong class="iw hj"><em class="js">User _ details</em></strong>—包含给电影评分的用户的详细信息</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="995c" class="ll jy hi lh b fi lm ln l lo lp">+---------+-----------+---------------+<br/>| User_ID | User_Name | User_Location |<br/>+---------+-----------+---------------+<br/>| U1      | Sam       | USA           |<br/>| U2      | Nick      | India         |<br/>| U3      | Fiona     | China         |<br/>| U4      | Angela    | Germany       |<br/>| U5      | Sonic     | Argentina     |<br/>| U6      | Fiang     | Taiwan        |<br/>+---------+-----------+---------------+</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c9cdf149d52dd9402800469345430cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*70EWMTsWbb7fn10g.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="3531" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">1.将数据帧读入程序</h1><p id="6b88" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">Pandas数据框是数据框类型的变量，具有X行和Y列，格式为(X，Y)。行和列的索引从零开始。</p><p id="6e2d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">基本的第一步是使用Pandas数据框将excel文件读入程序。</p><p id="c955" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"><em class="js">PD . read _ excel</em></strong>用于读取excel文件。如果有一个<strong class="iw hj"> <em class="js"> csv(逗号分隔文件)</em> </strong>文件那么我们可以使用<strong class="iw hj"> <em class="js"> pd.read_csv。</em>T29】</strong></p><p id="9806" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">注意——我们用‘r’表示以只读模式打开文件。</em> </strong></p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">用Python读取excel文件的代码</figcaption></figure><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="5757" class="ll jy hi lh b fi lm ln l lo lp"><br/>Output-----&gt;<br/>print (df_movie_user_review);<br/>print (df_movie_details);<br/>print (df_user_details);</span><span id="c157" class="ll jy hi lh b fi lv ln l lo lp">  Movie_ID User_ID  Review_rating Review_comment<br/>0       M1      U1              4      Very Good<br/>1       M2      U2              2            Bad<br/>2       M3      U3              1    Interesting<br/>3       M4      U4              5      Very Good<br/>4       M1      U5              3           Good<br/>5       M2      U6              1           Poor</span><span id="dbe7" class="ll jy hi lh b fi lv ln l lo lp">  Movie_ID    Movie_Name  Movie_Release_year Move_Director<br/>0       M1   Drive Angry                2017         Kunal<br/>1       M2  Transformers                2015          Sidd<br/>2       M3  Fallen Angel                2002         Shyam<br/>3       M4   White House                2019      Bhargava</span><span id="2445" class="ll jy hi lh b fi lv ln l lo lp">User_ID User_Name User_Location<br/>0      U1       Sam           USA<br/>1      U2      Nick         India<br/>2      U3     Fiona         China<br/>3      U4    Angela       Germany<br/>4      U5     Sonic     Argentina<br/>5      U6     Fiang        Taiwan</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/938bded2f921321831ecff4012c40bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cHWRm4iPttXos6XT.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="726b" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> 2。处理Pandas数据帧的每一行，并对匹配文本或子字符串或任何其他计算进行条件检查</strong></h1><p id="bcfa" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">在data _ frame<strong class="iw hj"><em class="js">df _ movie _ user _ Review</em></strong>中，我们有一个列<strong class="iw hj"><em class="js">Review _ Comment</em></strong>，它包含文本形式的评论。</p><p id="a763" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们需要检查评论中是否有“<strong class="iw hj">差评</strong>”或“<strong class="iw hj">差评</strong>”字样，表示差评，并打印出来。我们刊登每一篇“负面”评论。或者，可以根据需要将其存储在单独的数据框或表中。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div><figcaption class="iq ir et er es is it bd b be z dx">‘</figcaption></figure><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="eec3" class="ll jy hi lh b fi lm ln l lo lp">Output----&gt;</span><span id="bb09" class="ll jy hi lh b fi lv ln l lo lp">negative review →<br/>Movie_ID           M2<br/>User_ID            U2<br/>Review_rating       2<br/>Review_comment    Bad<br/>Name: 1, dtype: object</span><span id="a871" class="ll jy hi lh b fi lv ln l lo lp">negative review →<br/>Movie_ID            M2<br/>User_ID             U6<br/>Review_rating        1<br/>Review_comment    Poor<br/>Name: 5, dtype: object</span></pre><p id="5174" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我们有3个方面</p><ol class=""><li id="0cdf" class="kv kw hi iw b ix iy jb jc jf lw jj lx jn ly jr lc ld le lf bi translated"><strong class="iw hj"> <em class="js">为循环</em> </strong>，在数据帧名称前有2个参数— <strong class="iw hj"> <em class="js"> i_index </em> </strong>为<strong class="iw hj"> <em class="js">行</em> </strong>，<strong class="iw hj"> <em class="js"> each_row </em> </strong>表示行值本身。</li><li id="d224" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated">我们有<strong class="iw hj"> <em class="js"> iterrows()，</em> </strong>，它本质上有助于检查数据帧的每一行。因此，使用该列值，我们需要使用代码<strong class="iw hj"><em class="js">each _ row[' Review _ Comment ']进行检查。</em> </strong></li><li id="6c38" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated">然后我们使用 函数中的<strong class="iw hj"> <em class="js">比较关键字，返回一个<strong class="iw hj"> <em class="js">布尔值——是或否，1或0 </em> </strong>。这是评估IF条件的关键。</em></strong></li></ol><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9309788bb7faaf890ac4be57bedb7940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7S7vLU7dyCc382Z3.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="8cdb" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> 3。基于条件检查从一个数据帧读取数据并将数据插入另一个数据帧</strong></h1><p id="cc51" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">继续上面的工作，我们现在需要分离负面评论，并将正面评论放入另一个数据框架中进行进一步处理。因此，当条件满足时，我们可以有效地读取一个数据帧并写入另一个数据帧。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="1297" class="ll jy hi lh b fi lm ln l lo lp">(<strong class="lh hj"><em class="js">else</em></strong> part of the code for visibility) </span><span id="d96e" class="ll jy hi lh b fi lv ln l lo lp">df_movie_positive_review = df_movie_positive_review.append(df_movie_user_review.loc[i_index], ignore_index=True</span><span id="e586" class="ll jy hi lh b fi lv ln l lo lp"><strong class="lh hj">Output---&gt;</strong></span><span id="49f6" class="ll jy hi lh b fi lv ln l lo lp"><strong class="lh hj"><em class="js">print  (df_movie_positive_review)<br/></em></strong>  Movie_ID Review_comment  Review_rating User_ID<br/>0       M1      Very Good            4.0      U1<br/>1       M3    Interesting            1.0      U3<br/>2       M4      Very Good            5.0      U4<br/>3       M1           Good            3.0      U5</span></pre><p id="e0ed" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上面的代码中，我们添加了一个<strong class="iw hj"> <em class="js"> else </em> </strong>部分，并将写正面评价的代码放入另一个数据帧中。else部分使用<strong class="iw hj"> <em class="js"> append </em> </strong>函数将<em class="js"> df_movie_user_review </em>中的行值<strong class="iw hj">插入到</strong>正面评论的新数据帧—<strong class="iw hj"><em class="js">df _ movie _ positive _ review中。</em> </strong>循环<strong class="iw hj"> <em class="js">中的<strong class="iw hj"> <em class="js"> i_index </em> </strong>表示我们需要插入的行值。</em></strong></p><p id="5c1f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果运行上面的代码，新的数据帧<strong class="iw hj"><em class="js">df _ movie _ positive _ review</em></strong>被填充。</p><p id="cbdc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有时，如果我们需要重复运行代码或对多个数据集运行代码，我们将需要清除该数据框，否则这里有一个示例代码来清除数据框或删除行。我们使用for循环来适应在删除行之前需要完成的任何条件检查。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="2f17" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是一个简单的for循环，它遍历所有行并删除，然后使用<strong class="iw hj"> <em class="js"> DROP </em> </strong>函数。索引表示数据的每一行，<strong class="iw hj"> <em class="js">轴</em> </strong>引导<strong class="iw hj"> <em class="js">下降</em> </strong>功能作用于<strong class="iw hj"> <em class="js">行</em> </strong>或<strong class="iw hj"> <em class="js">列</em> </strong>。</p><p id="3288" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">轴= 0 →表示行</p><p id="b482" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">轴= 1 →表示列</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f3a1836fe81e84d18bee2bb608cc6c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FY7Fz40I4CHLkH5v.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="25ee" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> 4。通过合并相同或另一个数据框的两列，在数据框中创建一个新列，然后删除一列</strong></h1><p id="a1f2" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">这是一个非常直接的方法，我们将新列等同于我们想要合并的两列的组合。</p><p id="feb0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们在这里探索两种情况，我们连接两个字符串类型的列，然后一个字符串类型&amp;另一个INT类型。在后一种情况下，我们在连接之前将INT类型转换为STRING。我们创建两个新列'<strong class="iw hj"> <em class="js">【评级_评论_组合_1 </em> </strong>'和'<strong class="iw hj"> <em class="js">评级_评论_组合_2 </em> </strong>'。我们还删除了列'<strong class="iw hj"><em class="js">rating _ comment _ combi _ 1</em></strong>'，以展示完整列特性的删除。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="f97b" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">Output ---&gt; Joining 2 columns( 2 new clumns created -  combi_1 &amp; combi_2)</strong></span><span id="e90e" class="ll jy hi lh b fi lv ln l lo lp">Movie_ID User_ID  ...  rating_comment_combi_1 rating_comment_combi_2<br/>0       M1      U1  ...            M1 Very Good            4 Very Good<br/>1       M2      U2  ...                  M2 Bad                  2 Bad<br/>2       M3      U3  ...          M3 Interesting          1 Interesting<br/>3       M4      U4  ...            M4 Very Good            5 Very Good<br/>4       M1      U5  ...                 M1 Good                 3 Good<br/>5       M2      U6  ...                 M2 Poor                 1 Poor</span><span id="b038" class="ll jy hi lh b fi lv ln l lo lp"><strong class="lh hj">Output --&gt; Dropping the column combi_1</strong></span><span id="3f4d" class="ll jy hi lh b fi lv ln l lo lp">[6 rows x 6 columns]<br/>  Movie_ID User_ID  Review_rating Review_comment rating_comment_combi_2<br/>0       M1      U1              4      Very Good            4 Very Good<br/>1       M2      U2              2            Bad                  2 Bad<br/>2       M3      U3              1    Interesting          1 Interesting<br/>3       M4      U4              5      Very Good            5 Very Good<br/>4       M1      U5              3           Good                 3 Good<br/>5       M2      U6              1           Poor                 1 Poor</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e0fbb03b42c03a56aed87204cdd8f840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0e8VzuL_ft3kQAfs.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="7a4d" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> 5。获取列的最小/最大/平均统计数据</strong></h1><p id="3352" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">对于任何数值数据，理解数据的分布是很重要的。我们需要像最小值/最大值/平均值等数字列的描述性统计。我们可以在DataFrame中使用<strong class="iw hj"> <em class="js"> describe() </em> </strong>做同样的事情。这给出了手头数据的高级描述性统计数据——计数、平均值、标准差、最小值、百分位数和最大值。</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="561f" class="ll jy hi lh b fi lm ln l lo lp">+---------------------------------+------------------+-----------+<br/>| df_movie_user_review.describe() |                  |           |<br/>+---------------------------------+------------------+-----------+<br/>| Out[70]:                        |                  |           |<br/>|                                 |    Review_rating |           |<br/>| count                           |    6.000000      |           |<br/>| mean                            |                  |  2.666667 |<br/>| std                             |                  |  1.632993 |<br/>| min                             |                  |  1.000000 |<br/>| 25%                             |                  |  1.250000 |<br/>| 50%                             |                  |  2.500000 |<br/>| 75%                             |                  |  3.750000 |<br/>| max                             |                  |  5.000000 |<br/>+---------------------------------+------------------+-----------+</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/26e2fea5045721d05323e9f7f0b92240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7Xs1v_dX5V5ezPaM.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="c2d7" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">6。查找/查找/检索<strong class="ak">基于匹配属性值的行的索引</strong></h1><p id="22c9" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">我们在这里的任务是获取/查找特定行的索引，该行在某一列中包含某个值。当您想要查找对应于行索引的值或查找匹配值的索引时，这尤其有用。</p><p id="04f8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我们定义一个函数<strong class="iw hj"><em class="js">get _ index _ by _ row _ attribute</em></strong>并传递look值<strong class="iw hj"> <em class="js"> movie_name值。</em> </strong>我们想要<strong class="iw hj"> <em class="js">电影名</em> </strong>出现的行的<strong class="iw hj"> <em class="js">索引</em> </strong>。</p><p id="5f53" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我们传递不同的电影名称，函数返回行索引值。我们还有一个错误捕获块'<strong class="iw hj"> <em class="js"> IndexError </em> </strong>'，以防电影名称不存在。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="fbad" class="ll jy hi lh b fi lm ln l lo lp">Output---&gt;<br/>print (get_index_by_row_attribute('Drive Angry'))<br/>print (get_index_by_row_attribute('Transformers'))<br/>print (get_index_by_row_attribute('XYZ'))<br/>0<br/>1<br/>Index out of range, Movie name not in the list<br/>None</span></pre><p id="4e7f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">代码有3个部分。让我们探索它们:</p><ol class=""><li id="be48" class="kv kw hi iw b ix iy jb jc jf lw jj lx jn ly jr lc ld le lf bi translated"><strong class="iw hj"><em class="js">【df _电影_详情。movie _ Name = = movie _ Name]</em></strong><em class="js">→</em>验证属性是否与传递的值匹配。</li></ol><p id="89ae" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js"> 2。df _ movie _ details . loc[……]..】</em> </strong> → <em class="js">用</em> <strong class="iw hj"> <em class="js">添加数据帧名称。loc" </em> </strong> <em class="js">帮助导航到我们想要匹配行值的数据框和属性列。</em></p><p id="64ff" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js"> 3。index.values[0] </em> </strong> →这有助于返回特定行的适当索引。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e354643bcf06b5548e9c5165c541fc7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QqNRHXYZArTchciy.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="cdd1" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> 7。查找/查找/检索给定行索引的行值</strong></h1><p id="3373" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">继续上面的查找，我们的任务是在给定索引值的情况下获取特定行的行属性值。</p><p id="9d4c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当您想要查找对应于行索引的值或查找匹配值的索引时，这尤其有用。</p><p id="6625" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我们定义一个函数<strong class="iw hj"><em class="js">get _ row _ by _ index _ value</em></strong>并传递<strong class="iw hj"> <em class="js"> index_value。</em> </strong>我们希望电影名称出现在与索引对应的行中。</p><p id="f9d8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我们传递各种<strong class="iw hj"> <em class="js"> index_value </em> </strong>，函数<strong class="iw hj"> <em class="js">从对应于该索引行的数据帧中返回Movie_Name </em> </strong>值。我们还有一个错误捕获块'<strong class="iw hj"> <em class="js"> IndexError </em> </strong>'，以防索引值不存在。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="7600" class="ll jy hi lh b fi lm ln l lo lp">Output---&gt;</span><span id="a2f0" class="ll jy hi lh b fi lv ln l lo lp">print (get_row_by_index_value(0))<br/>print (get_row_by_index_value(2))<br/>print (get_row_by_index_value(3))<br/>print (get_row_by_index_value(100))<br/>Drive Angry<br/>Fallen Angel<br/>White House<br/>Index out of range, Movie Index not in the list<br/>None</span></pre><p id="4d7c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">比较分为三个部分。让我们探索它们:</p><ol class=""><li id="e657" class="kv kw hi iw b ix iy jb jc jf lw jj lx jn ly jr lc ld le lf bi translated"><strong class="iw hj"><em class="js">【df _ movie _ details . index = = index _ value】</em></strong>→我们比较需要返回行值的索引值</li></ol><p id="7c45" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">2<em class="js">2。df_movie_details.loc[…。】</em> </strong> → <em class="js">添加带“，”的数据帧名称。loc”帮助导航到我们想要匹配索引值的数据框和索引列。</em></p><p id="5019" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js"> 3。Movie_Name.values[0 </em></strong></p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/aae02d7a6685470fbeb3df7c7d810bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fl6qndb9pNpV6q7a.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="fd91" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><em class="me"> 8。基于匹配列合并/连接2个数据帧</em></h1><p id="c7a6" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">经常会出现这样一种情况，我们需要基于一个公共列值连接两个或更多数据帧，类似于我们在SQL中所做的。</p><p id="fb8f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我们将两个数据帧<strong class="iw hj"><em class="js">df _ Movie _ User _ review</em></strong>&amp;<strong class="iw hj"><em class="js">df _ Movie _ details</em></strong>连接在公共属性“<strong class="iw hj"> <em class="js"> Movie_ID </em> </strong>”上，然后将得到的数据帧<strong class="iw hj"><em class="js">df _ Movie _ details _ join _ 1</em></strong>与<strong class="iw hj"><em class="js">df _ User _ details</em></strong>连接在公共属性上</p><p id="ba76" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">该连接有3个部分</p><ol class=""><li id="c04d" class="kv kw hi iw b ix iy jb jc jf lw jj lx jn ly jr lc ld le lf bi translated"><strong class="iw hj"> <em class="js"> pd.merge </em> </strong> —这是合并或加入功能。</li><li id="972b" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated">接下来，我们提到需要连接的两个数据帧</li><li id="6608" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated"><strong class="iw hj"> <em class="js">如何</em> </strong> —本物种加入的类型。这里我们使用内部连接。</li><li id="9475" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated"><strong class="iw hj"><em class="js"/></strong>—指定我们加入的列。在我们的例子中，两个数据框中的列名是相同的。但是如果连接的列名不同，我们可以使用<strong class="iw hj"><em class="js">left _ on</em></strong>&amp;<strong class="iw hj"><em class="js">right _ on</em></strong>来指定将要执行连接的左表&amp;右表列名。</li></ol><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="0eaa" class="ll jy hi lh b fi lm ln l lo lp">#join 2 data frames to get the movie name in the movie_user_details<br/><strong class="lh hj"><em class="js">df_movie_details_join_1= pd.merge(df_movie_user_review, df_movie_details, how = 'inner', on= 'Movie_ID')</em></strong><br/>print (df_movie_details_join_1)</span><span id="7381" class="ll jy hi lh b fi lv ln l lo lp">##join 2 data frames to get the user details in the movie_user_details<br/><strong class="lh hj"><em class="js">df_movie_details_join_2= pd.merge(df_movie_details_join_1, df_user_details, how = 'inner', on= 'User_ID')</em></strong><br/>print (df_movie_details_join_2)</span></pre><p id="98b0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出→</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/f84f50d7edc503b3d0da8348c47e1dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Qzlwo8VYQ6Y_PEeZMRPWQ.png"/></div></div></figure><p id="8d82" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">连接两个数据框的示例，其中连接列名称可以不同。</p><p id="02ab" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">注意——这里我们用<strong class="iw hj"> <em class="js">右_上</em> </strong> &amp; <strong class="iw hj"> <em class="js">左_上</em> </strong>代替 上的<strong class="iw hj"> <em class="js">。</em></strong></p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="a83f" class="ll jy hi lh b fi lm ln l lo lp">df_movie_details_join_3= pd.merge(df_movie_details_join_1, df_user_details, how = 'inner', <strong class="lh hj"><em class="js">left_on= 'User_ID', right_on = 'User_ID'</em></strong> )<br/>print (df_movie_details_join_3)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/901ab90996a7e3757fb7807c930298f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wdS_dguwsjZa-ccy.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片来源——pix abay</figcaption></figure><h1 id="c753" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">9.从数据框创建数据透视表以进行汇总报告</h1><p id="8e25" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">Excel中最受欢迎的工具之一是数据透视表。您必须同意它是通用的，并且允许以新的聚合视角查看汇总信息，或者基于一个或多个维度属性进行汇总。</p><p id="5735" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我们探讨多种类型的透视表，可以使用<strong class="iw hj"> <em class="js"> pivot_table </em> </strong>函数创建。</p><p id="3452" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">数据透视表具有以下属性:</p><ol class=""><li id="02c4" class="kv kw hi iw b ix iy jb jc jf lw jj lx jn ly jr lc ld le lf bi translated">正在创建数据透视表的数据框名称</li><li id="e033" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated"><strong class="iw hj"> <em class="js">索引</em> </strong> —为数据透视表提供汇总维度，基本上表示数据透视表的行</li><li id="789a" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated"><strong class="iw hj"> <em class="js">值</em> </strong> —聚集参数</li><li id="d5ec" class="kv kw hi iw b ix lz jb ma jf mb jj mc jn md jr lc ld le lf bi translated"><strong class="iw hj"><em class="js"/></strong>—这概括了需要完成的聚合类型。</li></ol><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="d2d5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">案例1——让我们对电影进行汇总，以获得其评级的描述性统计数据。</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="b3a4" class="ll jy hi lh b fi lm ln l lo lp">#creating pivot table to display the average rating of movies<br/><strong class="lh hj"><em class="js">pd.pivot_table(df_movie_details_join_2,index=['Movie_ID'], values=['Review_rating'], aggfunc = {'mean', 'median','min','max'})</em></strong><br/>Out[75]: <br/>                       Review_rating                 <br/>                   max mean median  min<br/>Movie_ID                               <br/>M1                 4.0  3.5    3.5  3.0<br/>M2                 2.0  1.5    1.5  1.0<br/>M3                 1.0  1.0    1.0  1.0<br/>M4                 5.0  5.0    5.0  5.0</span></pre><p id="aee1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">案例2—让我们对电影进行汇总，以获得每个用户对电影的评级</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="3c9b" class="ll jy hi lh b fi lm ln l lo lp">#creating pivot table to display the rating of each movie by each user<br/><strong class="lh hj"><em class="js">pd.pivot_table(df_movie_details_join_2,index=['Movie_ID'] ,values=['Review_rating'], columns=['User_ID'])</em></strong></span><span id="2ed6" class="ll jy hi lh b fi lv ln l lo lp">                          Review_rating                         <br/>User_ID             U1   U2   U3   U4   U5   U6<br/>Movie_ID                                       <br/>M1                 4.0  NaN  NaN  NaN  3.0  NaN<br/>M2                 NaN  2.0  NaN  NaN  NaN  1.0<br/>M3                 NaN  NaN  1.0  NaN  NaN  NaN<br/>M4                 NaN  NaN  NaN  5.0  NaN  NaN</span></pre><p id="7613" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">案例3——让我们先对电影进行汇总，然后按用户进行汇总，以获得评级</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="f599" class="ll jy hi lh b fi lm ln l lo lp">#creating pivot table to display the rating of each movie by each user</span><span id="cee2" class="ll jy hi lh b fi lv ln l lo lp"><strong class="lh hj"><em class="js">pd.pivot_table(df_movie_details_join_2,index=['Movie_ID', 'User_ID'] ,values=['Review_rating'])</em></strong></span><span id="0677" class="ll jy hi lh b fi lv ln l lo lp">                      Review_rating<br/>Movie_ID User_ID               <br/>M1       U1                   4<br/>         U5                   3<br/>M2       U2                   2<br/>         U6                   1<br/>M3       U3                   1<br/>M4       U4                   5</span></pre><p id="08a9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">案例4—让我们对电影进行汇总，以获得对电影进行评级的用户的平均评级和数量</p><p id="052e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">注意—</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="4ac0" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj"><em class="js">import numpy as np<br/></em></strong>#creating pivot table to display the rating of each movie with average rating &amp; rating count<br/><strong class="lh hj"><em class="js">pd.pivot_table(df_movie_details_join_2,index=['Movie_ID'],values=['User_ID', 'Review_rating'], aggfunc={'User_ID':np.count_nonzero,"Review_rating":np.average})</em></strong></span><span id="7930" class="ll jy hi lh b fi lv ln l lo lp">              Review_rating User_ID<br/>Movie_ID                        <br/>M1                  3.5        2<br/>M2                  1.5        2<br/>M3                  1.0        1<br/>M4                  5.0        1</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f68580b4e19479f0bca434112f42568c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OZBnqIr69ERDJMVa.jpg"/></div></div></figure><h1 id="e819" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">10.“iloc ”,用于随意切片和切割数据帧</h1><p id="cb32" class="pw-post-body-paragraph iu iv hi iw b ix kx iz ja jb ky jd je jf lq jh ji jj lr jl jm jn ls jp jq jr hb bi translated">使用“iloc ”,您几乎可以根据需要水平或垂直分割数据帧。让我们以数据帧<strong class="iw hj"><em class="js">df _ movie _ user _ review</em></strong>为例来解决这个问题，该数据帧包含电影&amp;的用户详细信息。</p><p id="caef" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">注意—两行&amp;列</em> </strong>的数据帧索引从0开始</p><p id="7d71" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">注意—iloc的格式是iloc[[行]，[列] ] </em> </strong></p><p id="7160" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">用于iloc演示的数据帧→</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="b237" class="ll jy hi lh b fi lm ln l lo lp">+---+----------+---------+---------------+----------------+<br/>|   | Movie_ID | User_ID | Review_rating | Review_comment |<br/>+---+----------+---------+---------------+----------------+<br/>| 0 | M1       | U1      |             4 | Very Good      |<br/>| 1 | M2       | U2      |             2 | Bad            |<br/>| 2 | M3       | U3      |             1 | Interesting    |<br/>| 3 | M4       | U4      |             5 | Very Good      |<br/>| 4 | M1       | U5      |             3 | Good           |<br/>| 5 | M2       | U6      |             1 | Poor           |<br/>+---+----------+---------+---------------+----------------+</span></pre><p id="f437" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例1 </em> </strong> —我们来玩排—取前2排</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="4b9e" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[:2])</strong></span><span id="e773" class="ll jy hi lh b fi lv ln l lo lp">  Movie_ID User_ID  Review_rating Review_comment<br/>0       M1      U1              4      Very Good<br/>1       M2      U2              2            Bad</span></pre><p id="596d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"/></p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="d1c4" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[2:])</strong></span><span id="a1b0" class="ll jy hi lh b fi lv ln l lo lp">Movie_ID User_ID  Review_rating Review_comment<br/>2       M3      U3              1    Interesting<br/>3       M4      U4              5      Very Good<br/>4       M1      U5              3           Good<br/>5       M2      U6              1           Poor</span></pre><p id="a478" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例3 </em> </strong> —让我们来玩列—取前2列</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="9433" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[:,:2])</strong></span><span id="91e8" class="ll jy hi lh b fi lv ln l lo lp">  Movie_ID User_ID<br/>0       M1      U1<br/>1       M2      U2<br/>2       M3      U3<br/>3       M4      U4<br/>4       M1      U5<br/>5       M2      U6</span></pre><p id="b89e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例4 </em> </strong> —让我们来玩列—打印从列索引2开始的所有列</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="a200" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[:,2:])<br/></strong>   Review_rating Review_comment<br/>0              4      Very Good<br/>1              2            Bad<br/>2              1    Interesting<br/>3              5      Very Good<br/>4              3           Good<br/>5              1           Poor</span></pre><p id="67e3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例5 </em> </strong> —让我们玩列—选择列1 &amp; 2</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="f649" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[:,[1,2]])</strong></span><span id="48d4" class="ll jy hi lh b fi lv ln l lo lp">  User_ID  Review_rating<br/>0      U1              4<br/>1      U2              2<br/>2      U3              1<br/>3      U4              5<br/>4      U5              3<br/>5      U6              1</span></pre><p id="46a7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例6 </em> </strong> —我们来玩行&amp;列—打印行索引2的所有行，打印索引1 &amp; 2的列。</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="ee35" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[2:,[1,2]])</strong></span><span id="1eb0" class="ll jy hi lh b fi lv ln l lo lp">  User_ID  Review_rating<br/>2      U3              1<br/>3      U4              5<br/>4      U5              3<br/>5      U6              1</span></pre><p id="1e20" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例7 </em> </strong> —让我们玩行&amp;列—打印前2行&amp;打印索引为1 &amp; 2的列。</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="65f6" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[:2,[1,2]])<br/></strong>  User_ID  Review_rating<br/>0      U1              4<br/>1      U2              2</span></pre><p id="64da" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例8 </em> </strong> —我们来玩行&amp;列—打印索引为4 &amp; 5的行，索引为1 &amp; 2的列。</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="cb3b" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[[4,5],[1,2]])</strong></span><span id="186e" class="ll jy hi lh b fi lv ln l lo lp">  User_ID  Review_rating<br/>4      U5              3<br/>5      U6              1</span></pre><p id="3516" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例9 </em> </strong> —让我们通过以编程方式读取行&amp;列的值，使之成为<strong class="iw hj"><em class="js"/></strong>。我们使用<strong class="iw hj"> <em class="js">形状</em> </strong>函数得到数据帧的行&amp;列。</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="0897" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">row,columns = df_movie_user_review.shape</strong></span><span id="7136" class="ll jy hi lh b fi lv ln l lo lp">print('rows --&gt;' + str(row), 'columns --&gt;'+ str(columns))</span><span id="5af2" class="ll jy hi lh b fi lv ln l lo lp">rows --&gt;6 columns --&gt;4</span></pre><p id="41b6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例10 </em> </strong> —让我们玩玩<strong class="iw hj"> <em class="js">动态</em> </strong>行&amp;列—读取除最后2行以外的所有行，读取除最后1行以外的所有列</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="520d" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">print(df_movie_user_review.iloc[:row-2,:columns-1])</strong></span><span id="6a44" class="ll jy hi lh b fi lv ln l lo lp">  Movie_ID User_ID  Review_rating<br/>0       M1      U1              4<br/>1       M2      U2              2<br/>2       M3      U3              1<br/>3       M4      U4              5</span></pre><p id="bece" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例11 </em> </strong> —让我们玩玩<strong class="iw hj"> <em class="js">动态</em> </strong>行&amp;列—将包含注释的最后一列存储在单独的数据框中</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="3822" class="ll jy hi lh b fi lm ln l lo lp"><strong class="lh hj">new_data_frame = pd.DataFrame(df_movie_user_review.iloc[:,columns-1:].values)</strong></span><span id="ed2c" class="ll jy hi lh b fi lv ln l lo lp"><strong class="lh hj">print(new_data_frame)</strong></span><span id="29f5" class="ll jy hi lh b fi lv ln l lo lp">0<br/>0    Very Good<br/>1          Bad<br/>2  Interesting<br/>3    Very Good<br/>4         Good<br/>5         Poor</span></pre><p id="6c2a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="js">案例12</em></strong>—让我们把它写回一个excel文件</p><pre class="jt ju jv jw fd lg lh li lj aw lk bi"><span id="c201" class="ll jy hi lh b fi lm ln l lo lp">new_data_frame.to_excel('review_rating_only.xlsx')</span></pre><p id="71f5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">感谢阅读。随时欢迎反馈和提问！这篇博客是根据我对庞大的Python世界及其提供的各种功能的有限理解而写的。快乐学习！！</p><p id="8047" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">更多信息请参考—<a class="ae mg" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。DataFrame.html</a></p><p id="1ea2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">感谢<a class="ae mg" rel="noopener" href="/@mesirii/5-tips-for-embedding-tables-in-your-medium-posts-8722f3fc5bf5">https://medium . com/@ mesi rii/5-tips-for-embedding-tables-in-your-medium-posts-8722 F3 fc 5 BF 5</a>关于格式化数据&amp;嵌入代码的帮助</p></div></div>    
</body>
</html>