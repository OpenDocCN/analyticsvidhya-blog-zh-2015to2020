<html>
<head>
<title>You need more than CRISP-DM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你需要的不仅仅是CRISP-DM</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/you-need-more-than-crisp-dm-5f2721b3afbf?source=collection_archive---------34-----------------------#2020-05-25">https://medium.com/analytics-vidhya/you-need-more-than-crisp-dm-5f2721b3afbf?source=collection_archive---------34-----------------------#2020-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/afd3066c0b77118098111775935d2029.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/0*LY5TVFJGHTgCYY4D"/></div></figure><p id="9434" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你已经在ML世界里，你一定经常看到这个图表。几乎每个教程都会参考。但这只是宪法，我们需要一本更详细的法律书，告诉我们具体什么时候做什么。</p><p id="87c9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">以下是我具体的行动方案:</p><p id="bfd6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一部分是ML模型和数据分析工作。</p><p id="9f14" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意:当我说“如果需要/必要”时，我指的是如果你的数据需要一些动作，以及如果你的算法需要它。例如，如果要素处于不同的比例，则可能需要进行缩放，但如果您使用的算法不需要缩放，则不必缩放数据。</p><p id="3532" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意:我假设您对ML模型有点熟悉，并且已经构建了一些基本模型。</p><ol class=""><li id="b055" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><strong class="io hj">导入必要的库和函数</strong></li></ol><p id="25d4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你不需要一开始就导入所有的东西。只需导入您经常使用的函数，并在需要时导入其他函数。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="c749" class="kc kd hi jy b fi ke kf l kg kh">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import os<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import mean_squared_error, mean_absolute_error <br/>from sklearn.metrics import confusion_matrix, recall_score, precision_score, f1_score <br/>from sklearn.metrics import accuracy_score,roc_auc_score,roc_curve<br/>from sklearnextension import * #You should have some reuseable functions of your own</span></pre><p id="0870" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2。获取数据</strong></p><p id="694d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">起初，我们使用csv/excel文件，通常从类似kaggle的网站下载。有时我们从sklearn数据集模块中加载它。但是后来，最终，我们不得不处理真实的数据，这些数据是使用SQL从我们的数据库中检索的。说到这一点，我强烈建议像在数据库上一样预处理数据，这样会更快。</p><p id="b80f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 3。用EDA </strong>理解数据</p><p id="7fb9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有很多关于EDA的文章/博客/白皮书，我不想重复。简单说一下吧。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="633e" class="kc kd hi jy b fi ke kf l kg kh">#Getting to know data briefly<br/>df.describe()<br/>df.info()<br/>df.nunique()<br/>df["somecolumn"].value_counts()</span></pre><ul class=""><li id="aa99" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj ki jq jr js bi translated">检查缺失值以及类似缺失的值。即“拿”、“打-”、“-999”等。如果这是一个ML模型，在这一步不要做任何事情，我们很快就会看到这一点。</li><li id="8b59" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">检查偏斜度，必要时进行处理。你可能会想到“对数变换”这样的方法。</li><li id="9f7e" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">检查异常值并在必要时进行处理，即移除该特征或使用上限值替换它们。</li><li id="d31d" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">检查是否需要缩放</li><li id="af97" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">可视化数据:查看与seaborn的热图和pandas的散点图的相关性。使用直方图查看分布。</li></ul><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/a8ece40784d4a26dfadb8236cdcb50d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*FETiQac-j26iYwKjyONxlQ.png"/></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/6333fce6e01a240d1bd78307df8316f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*K1aXTvdInMcsAC88OQcDYA.png"/></div></figure><p id="3745" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里的一些步骤被称为预处理和特征工程。</p><p id="5d00" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 4。检查是否存在足够的数据实例</strong></p><p id="ac1f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你没有足够的数据，你的模型可能<strong class="io hj">欠拟合</strong>(非常低的精度或高损失函数值)。所以你应该收集更多的数据或者使用像<strong class="io hj"> SMOTE </strong>这样的重采样方法。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/328faa2beb6a4ec23471ac5829450b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P56f2RBddFZspeNiB039jw.png"/></div></div></figure><p id="0fca" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 5。</strong> <strong class="io hj">检查特征数量</strong></p><p id="3133" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果特征的数量太多，您可能会考虑减少它，或者利用<strong class="io hj"> PCA </strong>等算法，或者手动选择最有用的特征(也有这方面的算法和方法)</p><p id="6cb5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果特征的数量很少，您可以考虑通过特征提取和创建技术来增加它，如果可能的话，还可以从数据库中获取更多的列。</p><p id="088f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里的东西也被称为<strong class="io hj">特征工程</strong>。</p><p id="0c03" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 6。如果分类有问题，检查标签是否平衡。</strong></p><p id="1374" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您有不平衡的数据，您的模型可能会导致不适当的方式。你必须用上述方法使它达到平衡状态。你也可以查看我的相关笔记本<a class="ae kv" rel="noopener" href="/analytics-vidhya/three-steps-in-case-of-imbalanced-data-and-close-look-at-the-splitter-classes-8b73628a25e6">。</a></p><p id="62f5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">编辑</strong>:在训练/测试分割后进行该步骤。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="4f31" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">以下项目符号专门针对ML型号。</p><p id="624a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 7。获取X轴和y轴</strong></p><p id="2548" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您通常将要素放入X变量，将标注放入y变量。大多数情况下，您需要将y标注调整为2D数组，因为大多数算法需要2D数组来</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9352" class="kc kd hi jy b fi ke kf l kg kh">X=df.iloc[:,1:10]<br/>y=df.iloc[:,11].reshape(-1,1) #make it 2D</span></pre><p id="9185" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 8。重要提示:现在就将您的数据拆分为训练集和测试集。</strong></p><p id="ed59" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">并且<strong class="io hj">在您准备好最终评估之前，不要触摸</strong>测试装置。</p><p id="b859" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在一些教程中，可能为了简单起见，这部分是在一些一些变换操作之后执行的。(更糟糕的是，转换步骤是通过使用熊猫的方法完成的)。但是我建议在你的婴儿阶段习惯这一步。</p><p id="b61b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这两个集合中，都有一些我们试图预测的自变量(特征)和一个(有时更多)因变量。这里的主要思想是用训练集来训练我们的数据，并且不要让它看到测试集，这样就不会有信息泄漏到训练集中。然后我们微调我们的模型。最后，我们用测试集来测试我们的模型。</p><p id="cb88" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 9。一些更多的特征工程(需要转换的操作)</strong></p><ul class=""><li id="d7c1" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj ki jq jr js bi translated">插补(填充空值)。不要在ML模型中使用pandas的fillna方法。我很快会解释原因。</li><li id="9f1a" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">将分类值转换为数值(<strong class="io hj">标签编码(用于类)、序数编码(用于特征)</strong>和<strong class="io hj">一键编码(创建虚拟列</strong>)。不要在ML模型中使用pandas的get_dummies方法。一个原因是关于删除一列的默认值之间的差异，另一个原因是OneHotEncoder在管道中更有用，我马上会提到这一点。最后但同样重要的是，使用OneHotEncoder，实现虚拟列(其中训练集和测试集在一列中有不同的项目)会更加容易和有效。一旦你了解了这个想法，请查看我的相关笔记本 中的<a class="ae kv" rel="noopener" href="/@mvolkanyurtseven/onehotencoding-with-dissimilar-items-in-train-and-test-set-ffe365f84a4c"> <em class="kw">。</em></a></li><li id="34fe" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">如果需要，扩展您的数据。</li></ul><p id="3370" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用<strong class="io hj">管道</strong>进行一系列转换。管道是可重用的，可以很容易地实现测试数据和新来的数据。多搜索一下这个。快速搜索后，你还可以查看我的相关笔记本<strong class="io hj"> <em class="kw">(即将推出)</em> </strong>。</p><p id="1980" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">10。用你的火车组建立你的模型。</p><p id="2adc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这就是我们拟合和转换数据的地方(有时只有拟合方法，有时还有转换方法)</p><p id="f4b1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 11。如果你有足够的(也就是相当多，我的意思是很多)数据，用你的训练集做预测</strong></p><p id="eb8b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们应该首先预测我们的训练集，以便查看我们的模型是否首先不准确地预测训练集(低精度或高损失函数值，如RMSE)。如果没有，我们甚至不进行下一步。低精度/高RMSE意味着我们的模型<strong class="io hj">不符合</strong>。我们应该做一些必要的事情来解决这个问题，比如:</p><ul class=""><li id="13b3" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj ki jq jr js bi translated">选择更强大的模型</li><li id="fdcd" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">增加特征的数量(从数据库获取或使用特征提取技术)</li><li id="6a8f" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">如果是回归模型，则减少正则化参数</li></ul><p id="0101" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您的模型也可能<strong class="io hj">过拟合</strong>，其中您的训练集预测是好的，但是您的测试集分数不是。如果是这样，请执行以下操作:</p><ul class=""><li id="f6d4" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj ki jq jr js bi translated">降低模型复杂性(选择更简单的模型)</li><li id="e713" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">如果可能，收集更多数据</li><li id="6f3c" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">通过处理异常值来减少噪音</li><li id="cb14" class="jk jl hi io b ip kj it kk ix kl jb km jf kn jj ki jq jr js bi translated">在回归模型中添加正则化(搜索此内容)或减少决策树的深度</li></ul><p id="fee9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 12。如果你没有太多的数据(你会经常遇到这种情况)，做一个交叉验证。(不知道就上网查)</strong></p><p id="2ac5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果结果令人满意，我的意思是结果符合或超过你的期望，这意味着它不是不符合，进入下一步。当然，不要忘了确保你的模型也不会过度拟合。</p><p id="8521" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 13。使用测试集评估您的模型。</strong></p><p id="4b6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在用测试集预测你的模型之后，如果一切看起来都没问题，就对它进行评估。回归和分类模型都有评估指标。</p><p id="8f7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 14。建立更多的模型并进行比较</strong></p><p id="b20f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用<strong class="io hj"> GridSearchCV </strong>和<strong class="io hj">randomsearccv</strong>对模型的结果进行比较，选择最好的，并做更多的微调操作。(如果你不知道，就去查一查)</p><p id="2f5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，根据本文(<a class="ae kv" href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="noopener ugc nofollow" target="_blank">https://machinelementmastery . com/train-final-machine-learning-model/</a>)使用整套(训练+测试+交叉验证)训练你的模型</p><p id="6c94" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢阅读…</p></div></div>    
</body>
</html>