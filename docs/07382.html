<html>
<head>
<title>When you are dealing with rows and columns in Python Pandas while doing data analysis.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当你在Python Pandas中处理行和列时，同时进行数据分析。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/when-you-are-dealing-with-rows-and-columns-in-python-pandas-for-data-analysis-16d172b4bc8c?source=collection_archive---------25-----------------------#2020-06-23">https://medium.com/analytics-vidhya/when-you-are-dealing-with-rows-and-columns-in-python-pandas-for-data-analysis-16d172b4bc8c?source=collection_archive---------25-----------------------#2020-06-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fff3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我做数据分析的时候，我已经创建了一套我经常参考的命令。我希望这些命令能帮助你开始，特别是如果你是一个初学者。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="396f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据帧创建</strong></p><p id="7d10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Jupyter笔记本，我正在导入pandas模块，并通过使用python字典和列表添加数据来创建一个名为“books”的非常小的数据框架。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="1473" class="jt ju hi jp b fi jv jw l jx jy"><strong class="jp hj">import</strong> pandas <strong class="jp hj">as</strong> pd </span><span id="9caa" class="jt ju hi jp b fi jz jw l jx jy">books = { <br/>'Name': ['Harry Potter','Matilda','Gangsta Granny','The Horse and His Boy'],<br/>'Author':['J K Rowling','Ronald Dahl','David Williams','C S Lewis'],<br/>'Cost':[10.99, 8.99, 12.50, 11.99]<br/>}<br/>df = pd.DataFrame(books)</span><span id="8180" class="jt ju hi jp b fi jz jw l jx jy">df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es ka"><img src="../Images/8fce0bd8679385ab3edc1c73d52875a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*ZlsKyiEPKa34e4s1-O-hgg.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">这是我们要处理的原始数据框架。</figcaption></figure><h1 id="c89a" class="ki ju hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="ak">列</strong></h1><ol class=""><li id="5cca" class="lf lg hi ih b ii lh im li iq lj iu lk iy ll jc lm ln lo lp bi translated"><strong class="ih hj">如何查看栏目名称？</strong></li></ol><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="6417" class="jt ju hi jp b fi jv jw l jx jy">df.columns</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/6ed37a89ebe5e216f967f3b163cc83d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BdqyL0ZIZb1Ugwls5HWXbg.png"/></div></div></figure><p id="b5a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。如何重命名列:3种不同的方法</strong></p><ol class=""><li id="68af" class="lf lg hi ih b ii ij im in iq lv iu lw iy lx jc lm ln lo lp bi translated"><strong class="ih hj">通过</strong> <strong class="ih hj">将列名作为Python字典传递</strong></li></ol><p id="3f9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从我创建的原始数据框中，我将列“名称”重命名为“书名”，将“成本”重命名为“价格”。添加“inplace=True”将改变原始数据框。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="bb40" class="jt ju hi jp b fi jv jw l jx jy">df.rename(columns = {'Name': 'Book Title', 'Cost': 'Price'}, inplace = True)</span><span id="d717" class="jt ju hi jp b fi jz jw l jx jy">df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es ly"><img src="../Images/956bc4fa3463edc6dbdde496869fa8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*FW6FjIMwKa1oH01z7SlFUQ.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated"><strong class="bd kj">更改的数据帧</strong></figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es ka"><img src="../Images/8fce0bd8679385ab3edc1c73d52875a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*ZlsKyiEPKa34e4s1-O-hgg.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated"><strong class="bd kj">旧数据帧</strong></figcaption></figure><p id="54fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注</strong>:请检查变化的数据帧和旧数据帧，看有什么不同。</p><p id="dc3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。通过在Python列表中传递列名</strong></p><p id="ddf7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">执行此操作时，新列名必须以与原始列名相同的顺序出现。我把<strong class="ih hj">‘</strong>书名’改名为‘图书_书名’，把‘价格’改名为‘图书_价格’。为此，我创建了一个变量“names ”,并向它传递了一个列名列表。然后，我将这个新变量添加到原始数据框中。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="9c40" class="jt ju hi jp b fi jv jw l jx jy">names = ['Book_title', 'Author', 'Book_price']<br/>df.columns = names</span><span id="af19" class="jt ju hi jp b fi jz jw l jx jy">df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es lz"><img src="../Images/66f6580c9a0b45a1373c67b435bb0ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*b-chFhxchhDnScVR7-mIOw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">改变数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es ka"><img src="../Images/8fce0bd8679385ab3edc1c73d52875a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*ZlsKyiEPKa34e4s1-O-hgg.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated"><strong class="bd kj">旧数据帧</strong></figcaption></figure><p id="1ced" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。使用str.replace()方法</strong></p><p id="70eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您必须更正太多包含空格、下划线或数字的列名时，请使用此方法。在我下面的代码中，列中的所有下划线都被替换为空格。我是这样做的。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="d9b3" class="jt ju hi jp b fi jv jw l jx jy">df.columns = df.columns.str.replace('_',' ') <br/>df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es ma"><img src="../Images/4930f87ba3a1fe93677717f5ea37b107.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*KJQCM1ElDwbjFgeKVTpz4w.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">改变数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es lz"><img src="../Images/66f6580c9a0b45a1373c67b435bb0ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*b-chFhxchhDnScVR7-mIOw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">旧数据框</figcaption></figure><p id="aa49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。如何移除/删除列？</strong></p><p id="03c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我有“作者”专栏。请注意，axis = 1用于删除列。要删除一行，我们使用axis=0</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="4aec" class="jt ju hi jp b fi jv jw l jx jy">df.drop('Author', axis=1, inplace= True)</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mb"><img src="../Images/f1d6045c1c8e815fdc0e7625fb1fab3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*VLO0U3W0MV9TuX_RdHAuNw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">改变数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es ma"><img src="../Images/4930f87ba3a1fe93677717f5ea37b107.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*KJQCM1ElDwbjFgeKVTpz4w.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">旧数据框</figcaption></figure><p id="7610" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。如何添加新列？</strong></p><p id="f72a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了添加一个新列，我创建了一个变量“Genre ”,并向它传递了一个列表。然后，我将该变量赋给数据框。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="52ec" class="jt ju hi jp b fi jv jw l jx jy">genre = ['Novel','Fantasy','Fiction','Fantasy Fiction'] <br/>df['Genre'] = genre</span><span id="7895" class="jt ju hi jp b fi jz jw l jx jy">df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mc"><img src="../Images/2088f0b4c0acc540228a9bb68c5d014f.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*GvrSZXivePTsp_rGEONbAw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">改变数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mb"><img src="../Images/f1d6045c1c8e815fdc0e7625fb1fab3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*VLO0U3W0MV9TuX_RdHAuNw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">旧数据框</figcaption></figure><h1 id="50dd" class="ki ju hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">索引</h1><ol class=""><li id="f5d9" class="lf lg hi ih b ii lh im li iq lj iu lk iy ll jc lm ln lo lp bi translated"><strong class="ih hj">如何设置_index() </strong></li></ol><p id="6ecf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">索引没有像列名那样的名称标题。索引将有一个标签(名称)或索引号(总是从0开始)。一旦设置了索引，它就与行保持一致，永远不会改变，除非重置索引。在我下面的代码中，我将现有的“流派”列设置为索引。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="7242" class="jt ju hi jp b fi jv jw l jx jy">df.set_index('Genre',inplace=True) </span><span id="5639" class="jt ju hi jp b fi jz jw l jx jy">df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es md"><img src="../Images/163349aced85faa42988f710e3597930.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*iXwiwV28mlUuVY6nYbhLxQ.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">改变数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mc"><img src="../Images/2088f0b4c0acc540228a9bb68c5d014f.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*GvrSZXivePTsp_rGEONbAw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">旧数据框</figcaption></figure><p id="043b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。reset_index() </strong></p><p id="1b05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重置回原始索引。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="fa07" class="jt ju hi jp b fi jv jw l jx jy">df.reset_index(inplace=True)<br/>df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es md"><img src="../Images/0085718c0cebe3a2def3ed53dab6bb21.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*4g8bk_eO8WQm0pvpsulKAQ.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">改变数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es md"><img src="../Images/163349aced85faa42988f710e3597930.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*iXwiwV28mlUuVY6nYbhLxQ.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">旧数据框</figcaption></figure><h1 id="5aa4" class="ki ju hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="ak">行</strong></h1><p id="a7f6" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq me is it iu mf iw ix iy mg ja jb jc hb bi translated"><strong class="ih hj"> 1。如何删除行？</strong></p><p id="6cf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经删除了整整一行。请注意，axis = 1用于删除列。要删除一行，我们使用axis=0。使用inplace=True进行这些更改。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="6308" class="jt ju hi jp b fi jv jw l jx jy">df.drop([2], axis = 0, inplace= True)</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es mh"><img src="../Images/132c49a3c66ada254162eea091c80670.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*_73DzpmmDUVYsTCOiUwQFg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">改变数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mc"><img src="../Images/2088f0b4c0acc540228a9bb68c5d014f.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*GvrSZXivePTsp_rGEONbAw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">旧数据框</figcaption></figure><h1 id="e7c7" class="ki ju hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="ak">数据过滤:行和列</strong></h1><p id="4ef2" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq me is it iu mf iw ix iy mg ja jb jc hb bi translated"><strong class="ih hj"> 1。如何从行和列中提取值？</strong></p><p id="c0a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">原始数据帧:</p><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mc"><img src="../Images/2088f0b4c0acc540228a9bb68c5d014f.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*GvrSZXivePTsp_rGEONbAw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">原始数据帧</figcaption></figure><p id="bf13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。如何查看列中的值？</strong></p><p id="1078" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要查看“书名”列中的值</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="ca2f" class="jt ju hi jp b fi jv jw l jx jy">df['Book title']</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/20ee563ff15bf30aede6fd9b30fc6ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMn68VXFlcOCMm_jyAlCSA.png"/></div></div></figure><p id="4db7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。如何根据条件按行取值？</strong></p><p id="f1b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新数据帧‘new _ df’存储新的过滤数据，即‘虚构’类型的行。但是请注意，输出是布尔值true或false。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="59b6" class="jt ju hi jp b fi jv jw l jx jy">new_df = df['Genre'] == 'Fiction'<br/>new_df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es mi"><img src="../Images/127dd2ee304060d4624adc55a5fd2dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CYpC20xALaXgNVmbaz9JBA.png"/></div></div></figure><p id="fd8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要获取行值而不是布尔值，请执行以下操作:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="a5f7" class="jt ju hi jp b fi jv jw l jx jy">new_df = df[(df['Genre'] == 'Fiction')]<br/>new_df</span></pre><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mj"><img src="../Images/098d78a7e4a516274447f7882513e543.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*vETCNbvjF2O8Ru2SJVD8OA.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">新数据帧</figcaption></figure><figure class="jk jl jm jn fd kb er es paragraph-image"><div class="er es mc"><img src="../Images/2088f0b4c0acc540228a9bb68c5d014f.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*GvrSZXivePTsp_rGEONbAw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">原始数据帧</figcaption></figure><p id="fbf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您发现本文对您处理数据框有所帮助，那么在下面的评论部分收到您的来信将会非常好。享受编码！</p></div></div>    
</body>
</html>