<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/capsulegan-for-face-generation-ce0f852b09d5?source=collection_archive---------30-----------------------#2020-07-20">https://medium.com/analytics-vidhya/capsulegan-for-face-generation-ce0f852b09d5?source=collection_archive---------30-----------------------#2020-07-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/977e247eabb7a6865a65f399a5528bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zRv3ePPLGaxTn5OXiggrmA.png"/></div></div></figure><p id="8054" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">用于面部生成的胶囊</strong></p><p id="8438" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">胶囊网络的概念是由杰弗里·辛顿首先提出的。该网络使用图像的空间方向来完成分类任务。它提供了比传统CNN更好的结果。</p><p id="c90c" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">一个对抗性的模型让鉴别者和生产者相互竞争。通过将鉴别器实现为胶囊网络，性能更好，从而提供更好的发生器输出。为此项目选择的数据集是FHHQ数据集。我用的是128x128的缩略图。这个数据集由70，000张脸组成。这些图像被分成56，000幅训练图像和14，000幅测试图像。为了评估模型，使用了FID分数。</p><p id="f473" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">我使用DCGAN模型作为基线模型。这个模型被训练了160个纪元。在训练期间，在每2个时期之后，在100个测试图像上计算FID分数(1个时期=在训练数据集上通过1次)。DCGAN最好的FID分数是152.85。通过50，000张测试图像计算的FID分数为72.34。</p><p id="4873" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq"> DCGAN结果:</strong>观察到大部分人脸仍然没有正确形成。一些脸看起来很真实，但是背景仍然没有被学习。</p><figure class="is it iu iv fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ir"><img src="../Images/9cda163996e7352875656d7be0f7bde4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Cz3_mPYq1rNQpaax.png"/></div></div></figure><p id="d95f" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">在CapsuleGAN中，发生器类似于DCGAN，即深度CNN。胶囊鉴别器是用胶囊层代替卷积层实现的。在训练期间，记录的最佳FID是126.22。超过50，000张测试图像的FID分数是31.25。这表明CapsuleGAN是优于DCGAN的模型。</p><p id="01fe" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">下图显示了鉴别器中实现的胶囊网络的架构。它展示了如何将MNIST图像转换成胶囊。我的模型的输入是128x128的图像。我已经使用了交错卷积层将其缩减到12x12x256。之后，使用keras中的整形层，创建主胶囊层，这是一个大小为12x12x32的8D矢量。这些8D矢量或胶囊现在表示输入中的不同特征。然后通过160个节点的密集层，其中每个节点是来自主胶囊层的不同胶囊的组合。然后，这被传递到单节点密集层，该层确定所提供的图像是真是假。</p><figure class="is it iu iv fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es iw"><img src="../Images/33b77efdec12fb36e6c7f8c11314a98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-enaO2mkptsHDNzv.png"/></div></div></figure><p id="a886" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">胶囊检查结果:</strong>胶囊检查的一些结果如下所示。观察到，在生成的图像中，面部的结构比DCGAN形成得好得多。在一些图像中，背景仍然没有正确形成。此外，人们注意到这些面孔非常多样化。在这64幅生成的图像中，有男人、女人，也有孩子。像眼镜、太阳镜、鸭舌帽之类的东西也正在产生。</p><figure class="is it iu iv fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ix"><img src="../Images/02a454a3af0783536dc05b6196974097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6sd6PL9fYCEdUX0I.png"/></div></div></figure><figure class="is it iu iv fd hk er es paragraph-image"><div class="er es iy"><img src="../Images/28a6d6e8bb882ba1e5b10acfb8fe78d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/0*1_0rD9HtmtOTc_DM.png"/></div></figure><p id="b115" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">上图显示了两种模型在训练过程中的鉴频器损耗。x轴显示迭代次数。橙色图形表示DCGAN，而蓝色图形表示CapsuleGAN。CapsuleGAN的学习速度比DCGAN快得多，从图中可以观察到，在100，000次迭代之前，CapsuleGAN的损失迅速减少。CapsuleGAN的图表显示，当损失激增时，迭代次数约为200，000次。这主要是因为生成器学习了一些欺骗鉴别器的技巧。然后，鉴频器开始学习发电机的这个技巧，损耗开始减少。</p><figure class="is it iu iv fd hk er es paragraph-image"><div class="er es iz"><img src="../Images/b5080f61b8c3d333fb30224d7ccbe20c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*33f7so6R-yN-m1Wg.png"/></div></figure><p id="a9dc" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated">在比较训练期间在100个测试图像上评估的FID分数时，观察到CapsuleGAN早在第15个时期就提供了低FID分数。这种低FID分数可以归功于CapsuleGAN从胶囊网络学习面部结构的能力。从图中可以看出，与DCGAN相比，CapsuleGAN提供了更好的FID分数。</p><p id="fa7e" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">链接到我的知识库:-</strong>【https://github.com/NavedSid/CapsGAN T2】</p><p id="e29d" class="pw-post-body-paragraph hr hs ht hu b hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip hb bi translated"><strong class="hu iq">参考文献:- </strong></p><ol class=""><li id="9359" class="jb jc ht hu b hv hw hz ia id jd ih je il jf ip jg jh ji jj bi translated"><a class="ae ja" href="https://arxiv.org/pdf/1710.09829.pdf" rel="noopener ugc nofollow" target="_blank">轿厢间的动态路由</a></li><li id="b78a" class="jb jc ht hu b hv jk hz jl id jm ih jn il jo ip jg jh ji jj bi translated"><a class="ae ja" href="https://arxiv.org/pdf/1806.03968.pdf" rel="noopener ugc nofollow" target="_blank">胶囊纸</a></li><li id="8dae" class="jb jc ht hu b hv jk hz jl id jm ih jn il jo ip jg jh ji jj bi translated"><a class="ae ja" href="https://github.com/NVlabs/ffhq-dataset" rel="noopener ugc nofollow" target="_blank"> FFHQ数据集</a></li><li id="cf7a" class="jb jc ht hu b hv jk hz jl id jm ih jn il jo ip jg jh ji jj bi translated"><a class="ae ja" href="https://github.com/gusgad/capsule-GAN" rel="noopener ugc nofollow" target="_blank">https://github.com/gusgad/capsule-GAN</a></li></ol></div></div>    
</body>
</html>