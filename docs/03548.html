<html>
<head>
<title>Tweet Analysis using Naive Bayes Algorithm in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R语言中使用朴素贝叶斯算法的推文分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tweet-analysis-using-naive-bayes-algorithm-in-r-3f746d09bb0f?source=collection_archive---------2-----------------------#2020-02-07">https://medium.com/analytics-vidhya/tweet-analysis-using-naive-bayes-algorithm-in-r-3f746d09bb0f?source=collection_archive---------2-----------------------#2020-02-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5a4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我们正在分析发生在2016年8月俄亥俄州总统辩论中的推文的情绪。我们进行了数据分类和内容分析，以回答推文是否相关，哪个候选人在推文中提到得最多，以及推文的情绪。</p><p id="1753" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将数据读入R，数据也可以在SQL数据库中获得，但是这里我们将CSV文件加载到R中。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="a94e" class="jm jn hi ji b fi jo jp l jq jr">data=read.csv("Sentiment.csv") head(data)</span></pre><p id="6857" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结构化数据是这个过程中最重要的部分。数据集“情感”具有各种其他不相关的信息，因此在此特别选择“文本”和“情感”列并删除其余的。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="1fde" class="jm jn hi ji b fi jo jp l jq jr">library(tidyverse) datas=data%&gt;%select(text,sentiment) head(datas) round(prop.table(table(datas$sentiment)),2)</span></pre><p id="f340" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结构化数据后的输出:</strong></p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es js"><img src="../Images/5364f3364727cfdb1da10a59a6f32146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v1Am_dpeoBb8amQI"/></div></div></figure><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es ka"><img src="../Images/7c6745acef789995f24126ac440d8e51.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*imTsc3hS2XW9RLr83jixJQ.png"/></div></figure><p id="990c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据清理:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c87d" class="jm jn hi ji b fi jo jp l jq jr"><br/>library(tm) library(SnowballC) corpus = VCorpus(VectorSource(datas$text)) corpus = tm_map(corpus, content_transformer(tolower)) corpus = tm_map(corpus, removeNumbers) corpus = tm_map(corpus, removePunctuation) corpus = tm_map(corpus, removeWords, stopwords("english")) corpus = tm_map(corpus, stemDocument) corpus = tm_map(corpus, stripWhitespace) as.character(corpus[[1]])</span></pre><p id="9a29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">清理文本后输出:</strong></p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es js"><img src="../Images/49202ef7275cfcad83cb5b5c0b53e7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RF74YEUp2jk9ld_1"/></div></div></figure><p id="be70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了统计每个单词在整个文档中的出现频率，我们使用了另一个术语，称为文档术语矩阵，这使得我们的语料库函数更具有数字表示性。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="dc88" class="jm jn hi ji b fi jo jp l jq jr">dtm = DocumentTermMatrix(corpus) dtm dim(dtm) dtm = removeSparseTerms(dtm, 0.999) dim(dtm)</span></pre><p id="f5d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面显示了我们的文本中出现频率至少超过100次的单词列表。</p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es js"><img src="../Images/051b6160fc837531efdffc5ea395540f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z_kQXLAnJ_DXIlSP"/></div></div></figure><p id="3bc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过使用词云来可视化文本数据，从而更好地洞察每个情感中最常用的词。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8627" class="jm jn hi ji b fi jo jp l jq jr">library(wordcloud) <br/>library(ggplot2) <br/>install.packages("RColorBrewer") <br/>#wordcloud requires RColorBrewer positive= subset(datas,sentiment=="Positive") wordcloud(positive$text, max.words = 100, colors = "blue") negative = subset(datas,sentiment=="Negative") wordcloud(negative$text, max.words = 100, colors = "purple") neutral = subset(datas,sentiment=="Neutral") wordcloud(neutral$text, max.words = 100, colors = "turquoise")</span></pre><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kb"><img src="../Images/0aa76da4fcd17836f0e86703926759b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/0*HYQUeA0YzGPAxAtD"/></div></figure><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kc"><img src="../Images/92833774c6c47a3176a80358f76cbc5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/0*vbFtn2Ue4hX8xMUl"/></div></figure><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kd"><img src="../Images/7abd41af3d4fb2fcad6fa92f15ddc0a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/0*Gg0FLBebArS7xLUL"/></div></figure><p id="1456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我们已经使用机器学习算法“朴素贝叶斯”进行下面讨论的预测。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="d389" class="jm jn hi ji b fi jo jp l jq jr">#As naive bayes algorithm excepts binary <br/>convert &lt;- function(x) {<br/>y &lt;- ifelse(x &gt; 0, 1,0)<br/>y &lt;- factor(y, levels=c(0,1), labels=c("No", "Yes"))<br/>y<br/>    }  <br/>    <br/>    datanaive = apply(dtm, 2, convert)<br/>    <br/>    dataset = as.data.frame(as.matrix(datanaive))    <br/>    dataset$Class = datas$sentiment<br/>    str(dataset$Class)</span></pre><p id="d886" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据分割</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="3570" class="jm jn hi ji b fi jo jp l jq jr"><br/>    set.seed(31)<br/>    split = sample(2,nrow(dataset),prob = c(0.75,0.25),replace = TRUE)<br/>    train_set = dataset[split == 1,]<br/>    test_set = dataset[split == 2,] <br/>    <br/>    prop.table(table(train_set$Class))<br/>    prop.table(table(test_set$Class))</span></pre><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es ke"><img src="../Images/1fe17f1e7c1357cd3cab03f5b8bbf7c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*2MmHzqDqmxEAhKfYtbgeVA.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">训练数据集的比例</figcaption></figure><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kj"><img src="../Images/f44ffab27a8a0e0d8cb9663807414551.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*uSUwBqFIbU_hO3oPOT9VVA.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">测试数据集的比例</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b480" class="jm jn hi ji b fi jo jp l jq jr"># naive bayes<br/>    install.packages("e1071")<br/>    library(e1071)<br/>    library(caret)<br/>    control= trainControl(method="repeatedcv", number=10, repeats=2)<br/>    system.time( classifier_nb &lt;- naiveBayes(train_set, train_set$Class, laplace = 1,trControl = control,tuneLength = 7) )</span></pre><p id="09c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型的输出:</p><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kk"><img src="../Images/da52e54fd740c994f5b84f4366f70718.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*Lt73QuTI4ar3CowWt3q7Ug.png"/></div></figure><p id="19a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">评估朴素贝叶斯模型，预测的准确率为98.67%，如下所示:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2b42" class="jm jn hi ji b fi jo jp l jq jr"># model evaluation<br/>    <br/>    nb_pred = predict(classifier_nb, type = 'class', newdata =  test_set)<br/>    confusionMatrix(nb_pred,test_set$Class)</span></pre><p id="e9c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朴素贝叶斯模型的统计；</p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es kl"><img src="../Images/4df753683bd2d20a89a13ff2ed6e4f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TgwaMwYejXfS1zee4fDF7Q.png"/></div></div></figure><p id="89db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您阅读我的文章。希望你对机器学习算法如何与内容分析一起工作有所了解。</p></div></div>    
</body>
</html>