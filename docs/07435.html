<html>
<head>
<title>Linear Regression &amp; Multiple Linear Regression using python with very basic examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归&amp;使用python的多元线性回归，带有非常基本的例子</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-multiple-linear-regression-using-python-with-very-basic-examples-4d8b1500301d?source=collection_archive---------20-----------------------#2020-06-25">https://medium.com/analytics-vidhya/linear-regression-multiple-linear-regression-using-python-with-very-basic-examples-4d8b1500301d?source=collection_archive---------20-----------------------#2020-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d29a9a882d22c515321f803c29b4f1e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IzOu31MDGviacCY8"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">爱德华·豪厄尔在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="5b83" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">线性回归是一种统计方法，用于根据数值变量之间的关系进行量化和预测。</p><p id="bf9c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们讨论两种常见的回归类型。</p><h2 id="87d3" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">1.简单线性回归</h2><p id="a67c" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">简单线性回归是指有1个预测因子(自变量)和1个预测因子(因变量)的情况</p><p id="df85" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例子-考虑一个你的“学习时间”和“成绩”之间的图表。在这里，学习时间将是独立变量或预测值，分数将是从属变量或预测值，因为它随学习时间而变化。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/d1c211149d34b69d0e5321163a86617e.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/1*uaHlFV64J_KcLzlYdkWlUg.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">线性回归的例子。</figcaption></figure><p id="5ff8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">具有一个因变量和一个自变量的回归方程的最简单形式由公式y =mx +b定义，其中y =估计的因变量得分，m=估计的系数，b =截距，x =自变量得分。</p><h2 id="d2f5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">2.多元线性回归</h2><p id="afc8" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">多元线性回归是指有一个以上的预测因子和一个预测值的情况。这里需要注意的是，所用的预测值必须是相互独立的。</p><p id="0fa0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">举例来说，房子的售价可能取决于位置的可取性、卧室的数量、浴室的数量、房子建造的年份、地段的平方英尺以及许多其他因素。这里价格是预测值，其他因素是预测值</p><p id="13c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="ky">现在让我们进入python编码部分，进行简单的线性回归。我将使用jupyter笔记本进行编码演示。</em> </strong></p><p id="088d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我使用的所有代码都在Github链接中，你可以在本文末尾找到。</p><p id="184e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们走吧！！！！！</p><h1 id="f33c" class="kz ju hi bd jv la lb lc jz ld le lf kd lg lh li kg lj lk ll kj lm ln lo km lp bi translated">简单线性回归</h1><p id="7171" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">首先，我们将导入库。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/d5e1012b5efee196f25c475491261a77.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*BUi0_pX5LwbY6eO05Rj4-g.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">导入线性回归所需的所有库</figcaption></figure><h2 id="dbcc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">让我们创建一些合成数据，以便进行线性回归。让我们创建一个名为“房间”的变量，我们将房间设置为一组随机数的两倍+ 3。</h2><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/eb008ca7e80925be7207ee41d275df11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvo0BxvumSyXUWFvdKI7Xw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">这里我得到房间的随机值。在你们的系统中会有所不同，因为我们没有设定种子。</figcaption></figure><h2 id="cd0b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">我将为变量“价格”设置一个等式，作为价格= 265 + 6*房间数+abs(np.random.randn(100，1)) abs代表绝对值。</h2><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/474ba90050953ee383cbb3780a00a290.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*COgHQDlB2PlBsrEV8W1AEw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们得到价格的随机值，我们打印10个值</figcaption></figure><p id="f536" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们创建一个散点图，看看房间和价格之间的关系</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/82a40b883f7c41c9900a4b83fc20a779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-PCMAT324Q3zdwu3ytVtyg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">房间散点图作为预测值(独立变量),价格以10万卢比为预测值(因变量)</figcaption></figure><h2 id="4572" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">通过分析该图，房价随着房间数量的增加而增加。</h2><h2 id="ebb4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">让我们使用线性回归，房间作为预测，X =房间。我们要预测价格，所以Y =价格</h2><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/c33aab1f1848f100c6208873f46a6c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*2I8rPNnXkQWgDr6pz5OIYw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">这里我们得到截距为265.79842088，系数为5.9925157</figcaption></figure><p id="ece9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="ky">简单代数</em> </strong></p><p id="01bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="ky"> y= mx +b，其中b为y截距，m为系数或斜率，这里b = 265.79842088，m =5.99925157。这就像我们知道房间的数量(x ),就可以得到一个等式来计算价格。</em> </strong></p><h2 id="8a8f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">让我们看看我们的模型表现如何。我们调用print fun并生成线性回归模型的分数。score函数将返回Rsquare值。</h2><p id="a92a" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">print(LinReg.score(X，y))</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/a44654702fe3879a8f532013bbc62997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v6xOLvlWDzpN1ffSZfOnog.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们得到的分数或决定系数为. 9974687</figcaption></figure><h2 id="f48f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Rsquare值越接近1，线性回归越多。我们的线性模型表现很好，因为Rsquare值接近1。</h2><h1 id="cd88" class="kz ju hi bd jv la lb lc jz ld le lf kd lg lh li kg lj lk ll kj lm ln lo km lp bi translated">多元线性回归</h1><p id="ac24" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">让我们看看多元线性回归的编码演示。让我们导入库。除了线性回归之外，我想在这里添加的唯一一件事是seaborn，我们将seaborn作为sb导入，我们还需要为seaborn设置样式，所以我们将说sb.set_style，我们只说我们想要白色网格。最后，我们需要从集合中导入计数器，所以我们说从集合导入计数器</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/49dfabf13370998d3919a42e62fee125.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*Ie6PX1V4vxA68M9R3X0yfw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">多元线性回归所需的库</figcaption></figure><p id="a703" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不。我将使用pd.read_csv函数读取一个数据帧，并将列命名为year、roll、unem、hgrad和inc。然后，我将使用enroll.head()查看数据的前五个详细信息</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/f0b68169773fda9f3ac7cb30fce4f2df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9SJPVZc8_28tbnflfNDHBA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">这个数据取自新墨西哥州，从1961年开始。所以第一年实际上是1961年。名册表示入学人数，失业表示当年当地的失业人数，然后hgrad是毕业率，然后收入是当年该地区的当地收入。</figcaption></figure><p id="5f42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的变量需要是连续的数字变量。我们还需要确保预测值和被预测值之间存在线性关系。所以让我们检查一下相关性。为此，我们将使用seaborn，我们会说seaborn.pairplot，并传入我们的注册数据，然后运行它，让我们看看这里的一些变量之间的关系。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/6701eafae9548d766e1c8767055d9b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*v4BeIVzlfLZPgc5kwFq8-w.png"/></div></figure><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/0012ad6d77f8525a6e72930cafab368a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NET4vpHPUFjD-_YzmetX6Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们先来看看失业和入学之间的关系。你可以说，这里可能存在某种线性关系，但它可能更强。但是我们称之为足够好，然后看看失业率作为一个预测指标是如何表现的。现在让我们来看看hgrad和enrollment线性对。这是hgrad，这是注册人数，实际上，看起来相当不错。肯定有线性关系。</figcaption></figure><p id="bf80" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们使用print(enroll.corr())检查这个注册数据的相关性</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/039f95520ea50b313008874f3c38d30d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*SRM6xdye0XksauJDgbWIaA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们只是想确定我们的预测者不是完全相互依赖的。这对线性回归来说肯定不好。让我们看看hgrad和失业率的相关性，它是0.177376，比1小得多。所以hgrad变量和失业率绝对不是线性相关的。</figcaption></figure><p id="f270" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以让我们把分数和失业率作为预测值，把滚动作为预测值。首先，我们必须创建<strong class="ix hj">注册数据</strong>的子集，并从注册数据集中选择“unem”和“hgrade”。所以<strong class="ix hj"> enroll_data将是预测值(X) </strong>。然后为predictand创建另一个数据集<strong class="ix hj"> enroll_target </strong>，并从注册数据集中选择“滚动”。所以<strong class="ix hj"> enroll_target将是predictand(y)。</strong></p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/7449c6ce5d3a97cd1ff6acfc95e545d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*4p_dqJVsGFxlVzvjHaq0VQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们的预测器是X数据，然后我们的目标是y数据。我们希望在我们的enroll_data和enroll_target上调用scale函数。</figcaption></figure><h2 id="1a96" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">现在我们必须检查是否有任何丢失的值。让我们在这里创建一个名为missing_values的变量，我们将它设置为等于X，这里X等于不是一个数字，所以我们说它等于等于np.NAN，这不是NumPy库中的一个数字，然后我们就把它们过滤掉。</h2><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/b5fe047054a0035830255bb6a56d9d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*Nqiu_CKEU2j53l-Y8-ambg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">打印出missing_values，其中missing_values等于True。我们将运行这个，我们得到一个空数组，这意味着我们没有丢失值。</figcaption></figure><h2 id="927a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">我们需要做的下一件事是实例化一个线性回归对象。所以我们称它为LinReg，我们说LinReg等于线性回归，然后我们说normalize等于True。这告诉LinearRegression模型在回归之前归一化我们的变量，然后让我们将这个模型拟合到我们的数据，为此，我们将调用它的fit方法。我们会说LinReg.fit，我们会传入我们的数据，所以X和y，然后让我们打印出我们的模型表现的分数。</h2><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/362d9a611219f29fb6053c5688ab6784.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*_vnREel0Qx-wRMZu_2Nr8g.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们的回报率是84%，实际上，将会是85%。</figcaption></figure><h2 id="9602" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">这里打印出来的分数是预测的R平方。这是一种衡量模型预测的回归线实际上与大学入学人数的真实值匹配程度的方法。基本上，它告诉我们这个模型在预测大学入学人数方面表现得有多好。好的最高分是0.99，最低分是0.01</h2><h1 id="3664" class="kz ju hi bd jv la lb lc jz ld le lf kd lg lh li kg lj lk ll kj lm ln lo km lp bi translated">这就是线性和多元线性回归的总结！！！这里是我使用的所有代码和数据的Github链接。</h1><div class="md me ez fb mf mg"><a href="https://github.com/iamrahulramesh/Linear-Regression-Multiple-Linear-Regression-using-python-with-very-basic-example.git" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">iamrahullamesh/Linear-Regression-Multiple-Linear-Regression-using-python-with-very-basic-example</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">github.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu io mg"/></div></div></a></div><h2 id="ea94" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">快乐学习！！！:)</h2></div></div>    
</body>
</html>