<html>
<head>
<title>Exploring Other Face Detection Approaches(Part 3) — PCN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索其他人脸检测方法(第三部分)——PCN</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploring-other-face-detection-approaches-part-3-pcn-395d3b07d62a?source=collection_archive---------24-----------------------#2020-08-03">https://medium.com/analytics-vidhya/exploring-other-face-detection-approaches-part-3-pcn-395d3b07d62a?source=collection_archive---------24-----------------------#2020-08-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="27a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一系列的文章中，我们将探索不同于普通方法的各种其他人脸检测方法。在上一篇文章(第一部分和第二部分)中，我们讨论了关于<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-1-retinaface-9b00f453fd15"> RetinaFace </a>和<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-2-ssh-7c85179cd98d"> SSH </a>的问题。<br/>在这一部分，我们将讨论<em class="je"> PCN: Progressi </em> ve 校准网络。</p><p id="72ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将讨论四种不同类型的人脸检测架构。<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-1-retinaface-9b00f453fd15">视网膜面</a> <br/> 2。<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-2-ssh-7c85179cd98d"> SSH:单级无头人脸检测器</a> <br/> 3。<strong class="ih hj"> PCN:渐进校准网络</strong> <br/> 4。<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-4-tiny-face-684c8cba5b01">微型人脸检测器</a></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/06957c6d0ce5842dbed8f3d36f101ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OHK8GNkgqceTi4ODtm7-HQ.png"/></div></div></figure><h1 id="08bc" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">PCN:渐进式校准网络</h1><p id="6d11" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">旋转不变的人脸检测，即检测旋转的人脸，在非约束应用中有着广泛的需求，但由于人脸外观的巨大变化，它仍然是一项具有挑战性的任务。<br/>为了解决这个问题，渐进校准网络(PCN)以由粗到细的方式执行旋转不变人脸检测。PCN 由三个阶段组成，检测人脸并逐步校准每个候选人脸的 RIP(平面旋转)方向。<br/> PCN 首先校准面朝下朝上的候选人脸，将裂口角度范围从[-180，180]减半到[-90，90]。然后，旋转面进一步校准到垂直范围[-45，45]，再次减半 RIP。然后 PCN 为每个候选人脸做出最终决定，并预测精确的撕裂角度。这将在下面详细讨论。</p><h2 id="f181" class="ku js hi bd jt kv kw kx jx ky kz la kb iq lb lc kf iu ld le kj iy lf lg kn lh bi translated">体系结构</h2><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es li"><img src="../Images/d394e51facd338860d338dac5bc456a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fjha2OjB1HIj362adOmVZQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">拟议框架</figcaption></figure><p id="3640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在一幅图像上，根据滑动窗口和图像金字塔原理获得所有候选人脸，并且每个候选窗口逐级通过检测器[这里是 3 级]。在 PCN 的每个阶段，检测器拒绝具有低置信度分数的人脸，回归剩余候选人脸的包围盒并校准 RIP。在每个阶段之后，NMS 用于合并高度重叠的候选项。</p><p id="180b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> PCN-1 第一阶段</strong></p><p id="ec6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于每个输入窗口 x，PCN-1 有三个目标，即人脸/无脸分类、包围盒回归和校准。<br/>第<em class="je">个目标</em>旨在对人脸和非人脸进行分类，通过 Softmax loss 实现:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ln"><img src="../Images/683d1a133bcdbc8cff94bb5e720c88ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*DXrVLbmVF8CAzYCP4M-8JA.png"/></div></figure><p id="522f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中，如果 x 是正面，y 等于 1，否则为 0，f 是分类分数。</p><p id="362c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二个目标试图回归边界框，如下所示:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lo"><img src="../Images/77ea657036b85d9c16d3025ac26a99a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*k893-p1emt28yC8TNZ9fdQ.png"/></div></figure><p id="48fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中 t 和 t*代表预测的和真实的回归结果，S 是平滑的 L1 损失。边界框值包括:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lp"><img src="../Images/26baba5db822715bbde7945ebad56cb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*HJwTVgnsi_vq14KfSuP-PA.png"/></div></figure><p id="0b04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中 a、b 和 w 表示边界框左上角的坐标和宽度。不带(*)变量是预测值，带(*)的是实际值。</p><p id="dacc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="je">第三个目标</em>以二元分类的方式预测人脸候选的粗略方向为:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lq"><img src="../Images/7be1bf75d3b8f1ebda732a41eeb5b594.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*8aiy-T-5nuPPcb1NFLUwKQ.png"/></div></figure><p id="66ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中 x 朝上时 y 为 1，x 朝下时 y 为 0[在 PCN-1 中]。g 是分类分数。</p><p id="bd33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，总损失函数变为:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lr"><img src="../Images/4f77a5e9bfaff0112ce7ba7d13c28b7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*0IqomgJxdymorc88lCW4tA.png"/></div></figure><p id="8e79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在从 PCN-1 获得新的边界框之后，根据预测的粗略裂口角度旋转更新的候选人脸。如果第三个物镜中的<em class="je"> g </em>大于或等于 0.5【意味着候选人面朝上】则不旋转，否则旋转 180 度。因此将范围从[-180，180]减小到[-90，90]。</p><p id="164c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>作为大多数人脸检测数据集，主要包含直立人脸，这将不适合训练 PCN 人脸检测器【因为它是旋转不变的】。因此，训练图像以不同的撕裂角度旋转，形成包含具有 360 度撕裂角度的人脸的新训练集。<br/>采用三种训练数据:<em class="je">正样本</em>为 IoU(w.r.t face)大于 0.7 的窗口，<em class="je">负样本</em>为 IoU 小于 0.3，<em class="je">疑似样本</em>为 IoU 在 0.4-0.7 之间。<br/>正样本和负样本有助于人脸和非人脸分类的训练。阳性样本和可疑样本有助于包围盒的训练和校准。对于阳性和可疑样本，如果其撕裂角在[65，65]范围内，则定义为面朝上，如果在[180，115]∩[115，180 ]范围内，则定义为面朝下。裂口角度不在上述范围内的样本对校准训练没有帮助。</p><p id="3d77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> PCN-2 第二阶段</strong></p><p id="86ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与 PCN-1 类似，它进一步区分人脸和非人脸，回归边界框，并为 RIP 精确校准人脸候选。唯一的区别是粗略的方向预测，它是裂角范围的三元分类，即[-90°，-45]，[-45，45]或[45，90]。根据预测的裂口角度进行旋转，如下所示:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ls"><img src="../Images/554a4fe839f0ac535c5c4000a0f70379.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*eJT39hS1J7_dHljZhEX5Vg.png"/></div></figure><p id="2071" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中 gi 是预测的三元取向分类分数，θ是候选人脸将被旋转的角度。在第二阶段之后，RIP 范围从[-90，90]减小到[-45，45]。</p><p id="254c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了训练 PCN-2，训练图像在范围[-90，90]内均匀旋转，并通过训练的 PCN-1 过滤掉负样本。裂口角度范围[-90°，-60]，[-30，30]和[60，90]内的阳性和可疑样本对应于校准标签 0，1，2。裂口角度不在上述范围内的样本对校准训练没有帮助。</p><p id="ddde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> PCN-3 第三阶段</strong></p><p id="068b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第二阶段之后，所有候选人脸都被校准到垂直四分之一裂口角度范围，即[-45，45]。因此，PCN-3 可以容易地作出精确确定它是否是一张脸和回归包围盒的最终决定。由于范围较小，PCN-3 直接回归候选人脸的精确撕裂角度，而不是粗略方向。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lt"><img src="../Images/c69845ecd457b39cd3a44e14d1fad561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zMMRBx2XLxY_MYrQaH2dIQ.png"/></div></div></figure><p id="751e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">裂土角可通过累积所有阶段的预测值获得，如下所示:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lu"><img src="../Images/aa9771364a3664d39f5e23e9f3582299.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*usGkL4vU2eTTNcLrmrYRng.png"/></div></figure><p id="5582" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于训练 PCN-3，训练图像在范围[-45，45]内旋转，并且使用训练的 PCN-2 过滤掉阴性样本。这里的校准是利用平滑 L1 损失的回归任务训练。</p><h2 id="6edb" class="ku js hi bd jt kv kw kx jx ky kz la kb iq lb lc kf iu ld le kj iy lf lg kn lh bi translated">结论</h2><p id="738c" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们了解了一种新的人脸检测器，它快速、准确，并且对各种不同类型的人脸方向都具有鲁棒性。</p><h2 id="ee9e" class="ku js hi bd jt kv kw kx jx ky kz la kb iq lb lc kf iu ld le kj iy lf lg kn lh bi translated">参考</h2><p id="4dc4" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">代号:【https://github.com/MagicCharles/FaceKit T2】</p><p id="547e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">论文:【https://arxiv.org/pdf/1804.06039.pdf】T4</p></div></div>    
</body>
</html>