<html>
<head>
<title>M1 Mac Mini Scores Higher Than My RTX 2080Ti in TensorFlow Speed Test.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">M1 Mac Mini在TensorFlow速度测试中的得分高于我的RTX 2080Ti。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/m1-mac-mini-scores-higher-than-my-nvidia-rtx-2080ti-in-tensorflow-speed-test-9f3db2b02d74?source=collection_archive---------1-----------------------#2020-12-08">https://medium.com/analytics-vidhya/m1-mac-mini-scores-higher-than-my-nvidia-rtx-2080ti-in-tensorflow-speed-test-9f3db2b02d74?source=collection_archive---------1-----------------------#2020-12-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2624" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更新(12/12/20):对于更大的数据集和模型，RTX 2080Ti仍然更快！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/084b1a85075cd6f3ad0b2b5954f58187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZYXxRPfFaBnH_z_eqaEoA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">乔伊·班克斯在<a class="ae jt" href="https://unsplash.com/s/photos/mac-mini?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b49e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两个最受欢迎的深度学习框架是TensorFlow和PyTorch。它们都通过CUDA工具包支持NVIDIA GPU加速。由于苹果不支持NVIDIA GPUs，直到现在，苹果用户只能在CPU上进行机器学习(ML)，这明显限制了训练ML模型的速度。</p><p id="f1b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着MAC电脑采用新的M1芯片，以及macOS Big Sur中可用的ML计算框架，神经网络现在可以在MAC电脑上进行训练，性能大幅提高。</p><p id="244d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据<a class="ae jt" href="https://machinelearning.apple.com/updates/ml-compute-training-on-mac" rel="noopener ugc nofollow" target="_blank">最近的苹果博客</a>:</p><p id="fbfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“TensorFlow 2.4的新tensorflow_macos分支利用ML Compute使机器学习库不仅可以充分利用CPU，还可以充分利用M1和英特尔支持的MAC中的GPU，从而大幅提高训练性能。这从应用更高级别的优化开始，如融合层、选择适当的设备类型以及将图形编译和执行为图元，这些图元由CPU上的bnn和GPU上的金属性能着色器加速。”</p><p id="2065" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自从我上周拿到了新的M1 Mac Mini，我决定使用新的苹果框架来尝试我的TensorFlow脚本之一。我根据<a class="ae jt" href="https://github.com/apple/tensorflow_macos" rel="noopener ugc nofollow" target="_blank">苹果GitHub </a>网站说明在Mac Mini上安装了tensorflow_macos，并使用以下代码对来自<a class="ae jt" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">时尚-MNIST数据集</a>的商品进行分类。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="811d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我在配有英特尔酷睿i7–9700k处理器、32GB内存、1TB快速SSD存储和英伟达RTX 2080Ti显卡的Linux机器上运行脚本。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/8f516a5e0a510ba78c4019121f329c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZgI-2f8jDx2GAGgln34rg.png"/></div></div></figure><p id="abd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练和测试花费了7.78秒。</p><p id="eaf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我在我的新Mac Mini上运行了这个脚本，它配有M1芯片、8GB的统一内存和512GB的快速SSD存储。新的苹果M1芯片包含8个CPU核心，8个GPU核心和16个神经引擎核心。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/498db03c215c090480fa2b2af866afa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fr6Zo02XncFYo0LTjC3VAA.png"/></div></div></figure><p id="5066" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练和测试用时6.70秒，比我的RTX 2080Ti GPU快14%！我很惊讶。</p><p id="cb9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">苹果M1芯片与苹果ML计算框架和TensorFlow 2.4的tensorflow_macos分支(TensorFlow r2.4rc0)一起使用，性能非常显著。目前，以下软件包不适用于M1 MAC电脑:SciPy和相关软件包，以及服务器/客户端TensorBoard软件包。希望不久会有更多的软件包推出。添加PyTorch支持将是我的首要任务。</p><p id="05c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，Mac正在成为机器学习从业者的可行替代方案。虽然未来是充满希望的，但我还没有摆脱我的Linux机器。</p><p id="d9dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更新(12/12/20):对于更大的数据集和模型，RTX2080Ti仍然更快！</p><p id="e053" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">非常感谢所有阅读我的文章并提供宝贵反馈的人。特别感谢Damien Dalla-Rosa建议使用CIFAR10数据集和ResNet50模型，并感谢Joshua Koh建议使用perf_counter进行更精确的时间流逝测量。以下是我在M1和RTX 2080Ti上运行的新代码，它包含更大的数据集和更大的模型:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="b735" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我在我的Linux RTX 2080Ti机器上运行新代码。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jy"><img src="../Images/9e21a2cdeee53c78d4655385eb17a72c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QM7TssDO_-ofhRf2bVP7cw.png"/></div></div></figure><p id="6f8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练和测试用时418.73秒。我只训练了10个纪元，所以准确性不是很大。GPU利用率从65%到75%不等。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jz"><img src="../Images/5fcce62ab7b65e30dd8702ccbe067bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MBwYggNZDxD0MuaUlSzK6Q.png"/></div></div></figure><p id="9c17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我在M1 Mac Mini上运行了新代码。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ka"><img src="../Images/8b1795ee8b9a39ee2fca68e8f5964d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D0Y4Z6Ga7BjlMatr4tZduA.png"/></div></div></figure><p id="0edc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在具有更大数据集的更大型号上，M1 Mac Mini花费了2286.16秒。比采用英伟达RTX 2080Ti GPU的Linux机器长5倍以上！根据Mac的活动监视器，有最低限度的CPU使用率，没有任何GPU使用率。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/da47cdea0c9017a78c1cf13d81ca9beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxgwelN8014gGISgGbXlNA.png"/></div></div></figure><p id="13ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于M1 TensorFlow只在alpha版本中，我希望未来的版本能够利用芯片的GPU和神经引擎核心来加快ML训练。只有时间能证明一切。</p><p id="7da6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我期待着其他人使用苹果的M1 MAC进行ML编码和培训的体验。</p><p id="744d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢你花时间阅读这篇文章。</p><p id="c413" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安德鲁</p><p id="e980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">@tampapath</p></div></div>    
</body>
</html>