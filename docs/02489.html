<html>
<head>
<title>A simple ML project in R in just 5 mins!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个简单的R语言ML项目只需5分钟！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-simple-ml-project-in-r-using-the-boston-dataset-e1143146ffb0?source=collection_archive---------5-----------------------#2019-12-19">https://medium.com/analytics-vidhya/a-simple-ml-project-in-r-using-the-boston-dataset-e1143146ffb0?source=collection_archive---------5-----------------------#2019-12-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/96b1d33498b515f60f73e8f3960ea5e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cB_fTzTpKF_D6ZRW"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Anthony DELANOIX 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2e29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是使用波士顿数据集和r中的线性回归创建一个简单的机器学习模型的简单步骤。所以让我们开始吧！</p><h2 id="698a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">1.加载库</h2><p id="80c7" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们将使用以下库:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2563" class="jt ju hi ky b fi lc ld l le lf">library(mlbench)  # Contains the Boston Housing Dataset<br/>library(dplyr)    # Basic manipulation functions<br/>library(ggplot2)  # Graphs and plots<br/>library(reshape2) # To reshape data<br/>library(caret)    # Creating train test sets</span></pre><h2 id="653a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">2.正在加载数据集</h2><p id="973a" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">data()函数用于加载已加载库中可用的数据集。如果不带参数调用data()，您将获得所有可用数据集的列表。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="7ea5" class="jt ju hi ky b fi lc ld l le lf">data() # View all available datasets</span><span id="f6fd" class="jt ju hi ky b fi lg ld l le lf"># Load the Boston Housing dataset in the object named <br/># 'BostonHousing'<br/>data(“BostonHousing”)</span><span id="2137" class="jt ju hi ky b fi lg ld l le lf"># For simplicity, lets call it 'housing'<br/>housing = BostonHousing</span></pre><h2 id="bd14" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">3.了解结构</h2><p id="8c45" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">str()函数给出了变量(属性)类型的细节。你有必要理解这些属性的含义。你可以在这里获得关于属性<a class="ae iu" href="https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html" rel="noopener ugc nofollow" target="_blank">含义的更多细节。</a></p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="91e2" class="jt ju hi ky b fi lc ld l le lf">&gt; str(housing)<br/>'data.frame': 506 obs. of  14 variables:<br/> $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...<br/> $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...<br/> $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...<br/>.<br/>.</span></pre><h2 id="f948" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">4.测绘</h2><p id="6034" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated"><strong class="ix hj">房价中值密度图</strong></p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="40f7" class="jt ju hi ky b fi lc ld l le lf">ggplot(housing, aes(x = medv)) +<br/> stat_density() +<br/> labs(x = “Median Value x $1000”, y = “Density”, title = “Density Plot of Median Value House Price”) +<br/> theme_minimal()</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/317242393801c471ad43f54d44162836.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*TU84m5mk5irfyN2d0zfW9A.png"/></div></figure><p id="8003" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">密度图给出了数值属性的分布。我们可以看到大多数房子的价格在20000美元到25000美元之间。</p><p id="aeb4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">属性与房价中位数</strong></p><p id="3a10" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在将绘制一些与房价相关的属性。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="8daf" class="jt ju hi ky b fi lc ld l le lf">selected.attributes = select(housing, c(crim, rm, age, rad, tax, lstat, medv))<br/>melted = melt(selected.attributes,id="medv")<br/>ggplot(melted, aes(x = value, y = medv, colour = variable)) +<br/>  geom_point(alpha = 0.7) +<br/>  geom_smooth(color='black') +<br/>  facet_wrap(~variable, scales = "free", ncol = 2) +  # Divide the plots based on variable in 2 columns with a free scale that adjusts<br/>  labs(x = "Variable Value", y = "Median House Price x $1000") +<br/>  theme_minimal()</span></pre><p id="9643" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我们正在创建数据的融合版本。我们将从“住房”中选择()几个属性，并将它们融化()。melt()函数有两个参数，一个是数据，另一个是“id”。它获取“id”属性，并为所选属性重复该属性，然后创建关联的变量、值列。</p><blockquote class="li lj lk"><p id="2f86" class="iv iw ll ix b iy iz ja jb jc jd je jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">我建议您查看“melted”数据框，了解melt()的功能</p></blockquote><p id="588d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ggplot()用指定的x和y属性创建一个图。geom_point()用于将数据绘制为点。“alpha”指定点的透明度。geom_smooth()绘制了您在下图中看到的黑色曲线。facet_wrap()用于根据变量将图分成2列的多个图。labs()用于标记图。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/33a23abeb15a267a967bc0153822cb6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*cAlVV6pfVXLoJQyJpKWvbA.png"/></div></figure><h2 id="504b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">5.创建训练测试集</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="28a7" class="jt ju hi ky b fi lc ld l le lf">set.seed(387)<br/>train.idx = createDataPartition(y = housing$medv, p = 0.75, list = FALSE)<br/>test.idx =createDataPartition(y=housing$medv, p=0.25,list=FALSE)<br/>train = housing[train.idx, ]<br/>test = housing[test.idx, ]</span></pre><p id="5494" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">createDataPartition()返回随机索引号，以便为训练集和测试集进行选择。对应于这些索引的行用于获得“训练”和“测试”集合。</p><h2 id="8d9b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">6.构建模型</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="3d67" class="jt ju hi ky b fi lc ld l le lf">model = lm( medv ~ crim + rm + tax + lstat, data = train)</span></pre><p id="116a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">lm()函数创建一个线性模型。在第一个参数中，' ~ '左边的变量是目标变量，右边的变量是独立变量。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="1e85" class="jt ju hi ky b fi lc ld l le lf">summary(model) # Obtain coefficients, Residuals and statistics<br/>rsquare = summary(model)$r.squared # R-squared value</span></pre><p id="a33e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我得到的r平方值是0.699。</p><h2 id="eec8" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">7.根据模型和绘图结果进行预测</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="20c3" class="jt ju hi ky b fi lc ld l le lf">predictions = predict(model, newdata = test)<br/>predicted.vs.original = data.frame(predicted = predictions, original = test$medv)   # Create a new data frame<br/>ggplot(predicted.vs.original, aes(x = predicted, y = original)) +<br/> geom_point() +<br/> geom_smooth(color='blue') +<br/> labs(x = “Predicted Values”, y = “Original Values”, title = “Predicted vs. Original Values”) +<br/> theme_minimal()</span></pre><p id="8273" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我们创建了一个包含原始值和预测值的数据框，并绘制了一个图表。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/456d6dcca83dd8702b4c9366c13d9bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*WyMYna7QOZkEqVxazK4dvA.png"/></div></figure><h2 id="ccf2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">8.结论</h2><p id="3e50" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们刚刚建立了一个基本的线性回归模型。您可以通过缩放、转换和标准化数据来提高模型的准确性。</p><p id="52dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>