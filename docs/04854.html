<html>
<head>
<title>Mixing Java and Scala code in the software</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在软件中混合Java和Scala代码</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mixing-java-and-scala-code-in-the-software-a079fd5c991c?source=collection_archive---------2-----------------------#2020-04-03">https://medium.com/analytics-vidhya/mixing-java-and-scala-code-in-the-software-a079fd5c991c?source=collection_archive---------2-----------------------#2020-04-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7a10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将展示一些如何在同一软件中混合Scala和Java代码的例子，但是首先，我们将定义每种语言的用途</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/8255defca2a2f536932d8ba763d82428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*aqhUYITIbJ0QOWxhA3gRXw.png"/></div></figure><blockquote class="jl"><p id="1ae3" class="jm jn hi bd jo jp jq jr js jt ju jc dx translated">Java是一种以面向对象(OO)为主要特征的编程语言。这是指一种语言可以拥有的编程和设计方法。</p><p id="8df8" class="jm jn hi bd jo jp jv jw jx jy jz jc dx translated">尽管对什么是面向对象有许多解释，但第一个想法是设计软件，使它们使用的不同类型的数据与它们的操作相联系。因此，数据和代码(函数或方法)被组合成称为对象的实体。</p><p id="16e5" class="jm jn hi bd jo jp jv jw jx jy jz jc dx translated">至于Scala，这是一种函数式编程语言(FP)，所以函数也是可变的，你可以把它们传递给其他函数。你可以用OO，FP或者混合风格来编写你的代码。Scala的源代码编译成”。运行在JVM上的“class”文件。</p></blockquote><p id="2b22" class="pw-post-body-paragraph if ig hi ih b ii ka ik il im kb io ip iq kc is it iu kd iw ix iy ke ja jb jc hb bi translated">对于一些开发人员来说，Scala最初可能是一种复杂的语言，但我相信它值得学习，因为可伸缩性提供了能够以不同方式解决同一类型问题的巨大优势。</p><h1 id="ea31" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">有没有可能混合Scala和Java代码？</h1><p id="321a" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">是的，有能力混合两种类型的代码。可以创建一个SBT项目，将Scala代码放在src/main/scala中，将java代码放在src/main/java中，然后让它工作。</p><p id="8ecc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我不得不与两种语言交互时，最大的问题是它们的集合和库之间的差异，通常这可以通过JavaConversions对象来解决。我们总能找到在Scala中可以实现而在Java中不能实现的特性，所以Java在Scala方面有一定的局限性。</p><h2 id="a2be" class="li kg hi bd kh lj lk ll kl lm ln lo kp iq lp lq kt iu lr ls kx iy lt lu lb lv bi translated">Scala应用程序的Java类中使用的集合</h2><blockquote class="lw lx ly"><p id="0ab9" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">您在Scala应用程序中使用Java类，这些类要么返回Java集合，要么在其方法调用中需要Java集合。</p><p id="2654" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">使用Scala的JavaConversions对象的方法来实现转换。例如，java.util.ArrayList类通常在java应用程序中使用，您可以模拟从REPL中的方法接收ArrayList，如下所示</p></blockquote><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="67a4" class="li kg hi me b fi mi mj l mk ml">def nums = {<br/>var list = new java.util.ArrayList[Int]()</span><span id="0ba3" class="li kg hi me b fi mm mj l mk ml">list.add(1)<br/>list.add(2)<br/>list</span><span id="e2f4" class="li kg hi me b fi mm mj l mk ml">} </span></pre><p id="d4b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管这个方法在被调用时是用Scala编写的，但它的行为就好像是从Java方法返回一个ArrayList一样:</p><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="4f43" class="li kg hi me b fi mi mj l mk ml">val list = nums<br/>java.util.ArrayList[Int] = [1, 2]</span></pre><p id="2124" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，因为是Java集合，所以我不能调用foreach方法:<br/><strong class="ih hj">list . foreach(println)</strong></p><p id="d614" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">错误:值foreach不是Java . util . ArrayList[Int]list . foreach(println)</strong>的成员</p><p id="04c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过导入JavaConversions对象可以修复此错误。这样，上面的ArrayList获得了它需要执行的foreach方法，生成了以下输出:</p><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="de49" class="li kg hi me b fi mi mj l mk ml">scala&gt; import scala.colletion.JavaConversions._</span><span id="c585" class="li kg hi me b fi mm mj l mk ml">import scala.colletion.JavaConversions._</span><span id="4004" class="li kg hi me b fi mm mj l mk ml">scala&gt; list.foreach(println)<br/>1<br/>2</span></pre><h1 id="a03f" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">JavaConversions方法的示例:</h1><p id="79f3" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">下面是一个getNumbers()方法的例子，我们可以想象它是在一个Java类中创建的</p><p id="9aa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，假设我们想通过以下方式从Scala代码中调用getNumbers()方法:</p><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="ba27" class="li kg hi me b fi mi mj l mk ml">val numbers = JavaExamples.getNumbers()<br/>numbers.foreach(println) // this won’t work</span><span id="bea0" class="li kg hi me b fi mm mj l mk ml">//What will happen is that the compiler will generate the following <strong class="me hj">error:</strong><br/>value ‘foreach’ is not a member of java.util.List[Integer]</span></pre><p id="b85c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是因为我们必须在再次运行它之前导入JavaConversions.asScalaBuffer。当我们这样做时，我们显式地调用asScalaBuffer方法</p><h1 id="469d" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak">显式调用</strong></h1><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="8034" class="li kg hi me b fi mi mj l mk ml">import scala.collection.JavaConversions.asScalaBuffer</span><span id="a2c6" class="li kg hi me b fi mm mj l mk ml">val numbers = asScalaBuffer(JavaExamples.getNumbers)<br/>numbers.foreach(println)</span><span id="51aa" class="li kg hi me b fi mm mj l mk ml">// prints ‘scala.collection.convert.Wrappers$JListWrapper’<br/>println(numbers.getClass)</span></pre><h1 id="2df6" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak">隐含称呼</strong></h1><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="507b" class="li kg hi me b fi mi mj l mk ml">import scala.collection.JavaConversions.asScalaBuffer<br/>val numbers = JavaExamples.getNumbers</span><span id="b68f" class="li kg hi me b fi mm mj l mk ml">numbers.foreach(println)</span><span id="5395" class="li kg hi me b fi mm mj l mk ml">// prints ‘java.util.ArrayList’<br/>println(numbers.getClass)</span></pre><p id="cb35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">println调用<strong class="ih hj">(numbers . getclass</strong><em class="lz">)</em>表明显式和隐式使用的结果略有不同。</p><p id="0360" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用对显式方法<strong class="ih hj"> asScalaBuffer </strong>的调用将number对象转换成一个<strong class="ih hj">collection . convert . wrappers</strong><strong class="ih hj">$ jlist wrapper</strong>的实例，而隐式使用则显示numbers是ArrayList。</p><p id="568e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上，您可以使用这两种方法中的任何一种，这取决于您对使用隐式转换的偏好；两者都允许你调用foreach、map和其他Scala顺序方法。</p><h1 id="488c" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">您可以使用Java map和HashMap重复同样的例子。首先，在JavaExamples类中创建此方法:</h1><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="8b1e" class="li kg hi me b fi mi mj l mk ml">// java public static Map getPeeps() {<br/>Map peeps = new HashMap();</span><span id="1e3c" class="li kg hi me b fi mm mj l mk ml">peeps.put(“captain”, “Kirk”);<br/>peeps.put(“doctor”, “McCoy”);</span><span id="0376" class="li kg hi me b fi mm mj l mk ml">return peeps; }</span></pre><p id="6b8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，在从Scala代码中调用这个方法之前，导入相应的JavaConversions方法:</p><p id="a65d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">导入Scala . collection . javaconversions . mapasscalamap</strong></p><p id="385d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，您可以显式调用<strong class="ih hj"> mapAsScalaMap </strong>方法，或者允许隐式调用它:</p><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="27c2" class="li kg hi me b fi mi mj l mk ml">// explicit call val peeps1 = mapAsScalaMap(JavaExamples.getPeeps)<br/>// implicit conversion val peeps2 = JavaExamples.getPeeps</span></pre><p id="d409" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，地图上的对象类型也有所不同。在这种情况下，使用显式方法调用的<strong class="ih hj"> peeps1 </strong>具有集合类型<strong class="ih hj">. convert . wrappers＄jmap wrapper</strong>，而<strong class="ih hj"> peeps2 </strong>具有java类型<strong class="ih hj"> .util.HashMap. </strong></p><blockquote class="lw lx ly"><p id="b6e9" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">请注意，JavaConversions类已经经历了几次更改，尽管您将在IDE中看到大量转换方法，但其中许多方法已被弃用。有关更新的信息，请参见JavaConversions对象的最新Scaladoc</p><p id="a92b" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">Scala JavaConverters对象允许您执行与示例相似的转换，尽管它们不提供隐式转换。相反，它们要求您显式调用asJava或asScala方法来执行转换。请小心，因为该对象还包含许多过时的方法。</p></blockquote><h1 id="a1b0" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">下面是Scala和Java集合之间的互操作性列表:</h1><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="0f01" class="li kg hi me b fi mi mj l mk ml">scala.collection.Iterable &lt;<strong class="me hj">=&gt;</strong> java.lang.Iterable</span><span id="b8c2" class="li kg hi me b fi mm mj l mk ml">scala.collection.Iterable &lt;<strong class="me hj">=&gt;</strong> java.util.Collection</span><span id="46bc" class="li kg hi me b fi mm mj l mk ml">scala.collection.Iterator &lt;<strong class="me hj">=&gt;</strong> java.util.{ Iterator, Enumeration }</span><span id="508b" class="li kg hi me b fi mm mj l mk ml">scala.collection.mutable.Buffer &lt;<strong class="me hj">=&gt;</strong> java.util.List</span><span id="88c5" class="li kg hi me b fi mm mj l mk ml">scala.collection.mutable.Set &lt;<strong class="me hj">=&gt;</strong> java.util.Set</span><span id="807c" class="li kg hi me b fi mm mj l mk ml">scala.collection.mutable.Map &lt;<strong class="me hj">=&gt;</strong> java.util.{ Map, Dictionary }</span><span id="9fb2" class="li kg hi me b fi mm mj l mk ml">scala.collection.mutable.ConcurrentMap &lt;<strong class="me hj">=&gt; </strong>java.util.concurrent.ConcurrentMap</span></pre><h1 id="1bfe" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">在所有情况下，从源类型到目标类型的转换将返回原始的源对象，例如。</h1><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="fd4c" class="li kg hi me b fi mi mj l mk ml"><strong class="me hj">import</strong> scala.collection.JavaConversions._</span><span id="a893" class="li kg hi me b fi mm mj l mk ml"><strong class="me hj">val</strong> sl = <strong class="me hj">new</strong> scala.collection.mutable.ListBuffer[Int]<br/><strong class="me hj">val</strong> jl : java.util.List[Int] = sl<br/><strong class="me hj">val</strong> sl2 : scala.collection.mutable.Buffer[Int] = jl</span><span id="b166" class="li kg hi me b fi mm mj l mk ml">assert(sl eq sl2)</span></pre><p id="f32e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，还提供以下单向转换:</p><pre class="je jf jg jh fd md me mf mg aw mh bi"><span id="759f" class="li kg hi me b fi mi mj l mk ml">scala.collection.Seq <strong class="me hj">=&gt;</strong> java.util.List</span><span id="e634" class="li kg hi me b fi mm mj l mk ml">scala.collection.mutable.Seq <strong class="me hj">=&gt;</strong> java.util.List</span><span id="66a1" class="li kg hi me b fi mm mj l mk ml">scala.collection.Set <strong class="me hj">=&gt;</strong> java.util.Set</span><span id="1078" class="li kg hi me b fi mm mj l mk ml">scala.collection.Map <strong class="me hj">=&gt;</strong> java.util.Map</span><span id="2b36" class="li kg hi me b fi mm mj l mk ml">java.util.Properties <strong class="me hj">=&gt;</strong> scala.collection.mutable.Map[String, String]</span></pre></div><div class="ab cl mn mo gp mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="hb hc hd he hf"><p id="67c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这篇文章是有帮助的。</p><p id="5a2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们建议访问Scala api的以下部分，了解更多关于对象转换的细节。</p><h1 id="8bad" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak">参考文献</strong></h1><p id="c086" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">(Java conversions)<a class="ae mu" href="https://www.scala-lang.org/api/2.9.3/scala/collection/JavaConversions$.html" rel="noopener ugc nofollow" target="_blank">https://www . Scala-lang . org/API/2 . 9 . 3/Scala/collection/Java conversions $。html </a></p><p id="1841" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">((Java conversions)<a class="ae mu" href="https://www.scala-lang.org/api/current/index.html#scala.collection.JavaConversions$" rel="noopener ugc nofollow" target="_blank">https://www . Scala-lang . org/API/current/index . html # Scala . collection . Java conversions $</a></p><p id="29a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(Java converters)<a class="ae mu" href="https://www.scala-lang.org/api/current/index.html#scala.collection.JavaConverters$" rel="noopener ugc nofollow" target="_blank">https://www . Scala-lang . org/API/current/index . html # Scala . collection . Java converters $</a></p></div></div>    
</body>
</html>