<html>
<head>
<title>Image Classification using Tensorflow2.0 on CIFAR-10 dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于CIFAR-10数据集的Tensorflow2.0影像分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-classification-using-tensorflow2-0-with-cifar-10-dataset-cc595ceb0082?source=collection_archive---------6-----------------------#2020-04-19">https://medium.com/analytics-vidhya/image-classification-using-tensorflow2-0-with-cifar-10-dataset-cc595ceb0082?source=collection_archive---------6-----------------------#2020-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2718" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我关于TensorFlow 2.0的第二篇博客，我将在<a class="ae jd" href="https://www.cs.toronto.edu/~kriz/cifar.html" rel="noopener ugc nofollow" target="_blank"> CIFAR-10数据集</a>上解释图像分类。CIFAR代表加拿大高级研究所，10指10个班级。它由10类60000幅32×32彩色图像组成，每类6000幅图像。有50000个训练图像和10000个测试图像。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/3c6a16f6f8202f94a1f27c971f2760f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*b1VJotYHfyt5XuM5hyAc4w.png"/></div></figure><p id="bff9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从导入库和数据集开始</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="jm jn l"/></div></figure><ul class=""><li id="f1d2" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">第2–5行，导入的<em class="jx"> Tensorflow，Keras，Numpy和Matplotlib </em></li><li id="443e" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第8行，在CIFAR变量中加载数据CIFAR10</li><li id="a295" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第9行，当数据集通过调用<em class="jx"> cifar.load_data() </em>分两组加载时，将数据分两组存储</li><li id="262d" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第10行，检查了数据的形状，它有50000个32*32像素的图像，3是颜色的表示。</li><li id="0ef3" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第17行，为标签中的每个类定义了一个类名</li></ul><p id="1682" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将绘制图像并重新缩放。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="jm jn l"/></div></figure><ul class=""><li id="0ce9" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">第2–4行，用颜色条绘制图像，显示0–255颜色条</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kd"><img src="../Images/e64f89a33d154a6d2e6971a02aabd42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*iKSsqOUnquO-tMwvGGbw4A.png"/></div></figure><ul class=""><li id="6c97" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">第7行和第8行，重新缩放图像，因为张量流只接受0-1之间的输入</li><li id="3036" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第12–14行再次用颜色条绘制图像，现在它显示在0–1之间</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ke"><img src="../Images/1e4023c3d2b859e7f1da7744a2e36c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*ZYb38vUEHXWrX4yEZVwBbA.png"/></div></figure><p id="0324" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将导入库来构建模型</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="jm jn l"/></div></figure><ul class=""><li id="457f" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">第2–5行，导入库<em class="jx">顺序、扁平化、密集、批处理规范化、最大池化、激活和Conv2D </em></li><li id="e128" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第8行，定义一个模型为<strong class="ih hj"> <em class="jx">序列。这是一个线性的层堆栈，我们可以通过向构造函数传递一个层实例列表或者仅仅通过添加层来创建我们的模型。</em></strong></li><li id="393f" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第9 &amp; 12行，定义一个<strong class="ih hj"><em class="jx">【Conv2D】</em></strong><em class="jx"/>图层。卷积层用于从图像或部分图像中提取特征。它创建一个卷积核，该卷积核与层输入相关，以产生输出张量。我们已经传递了三个参数。</li></ul><ol class=""><li id="04e7" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc kf ju jv jw bi translated"><strong class="ih hj">滤波器大小</strong> (64和32)-它是一个决定输出滤波器数量的整数值</li><li id="f3f8" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated">内核大小 (3，3)-这是运行在图像上的过滤器的大小。它是由两个数字组成的元组，表示高度和宽度</li><li id="768f" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated"><strong class="ih hj">激活</strong> (relu)-正则化函数控制应用于conv2d的正则化方法的类型和数量</li></ol><ul class=""><li id="b0ef" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">第10行，定义了<strong class="ih hj"> <em class="jx"> MaxPooling2D </em> </strong>层。这一层减少了数据的大小、参数的数量和所需的计算量。简而言之，我们可以说它类似于缩小图像的尺寸。</li><li id="d990" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第11行和第14行定义了一个<strong class="ih hj"> <em class="jx">批次规格化</em> </strong>层。该层将每个小批量的输入标准化到一个层。</li><li id="929c" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第14行，定义了一个<strong class="ih hj"> <em class="jx">展平</em> </strong>图层。该层将n维数组转换为1维数组。</li><li id="c56c" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated">第15 &amp; 16行，定义了一个<strong class="ih hj"> <em class="jx">密集的</em> </strong>层。它只是神经网络中密集连接的规则神经元层。每个神经元接收来自所有神经元的输入。</li></ul><blockquote class="kg kh ki"><p id="ccd6" class="if ig jx ih b ii ij ik il im in io ip kj ir is it kk iv iw ix kl iz ja jb jc hb bi translated"><em class="hi">我们需要在训练前编译我们的模型，因为训练使用损失函数优化器。</em></p></blockquote><ul class=""><li id="0320" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">line20，<strong class="ih hj"><em class="jx">model . compile</em></strong><em class="jx"/>用于编译一个模型。它定义了损失函数、优化器和指标。</li></ul><ol class=""><li id="bfa2" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc kf ju jv jw bi translated"><strong class="ih hj"> <em class="jx">损失函数- </em> </strong>它是一种评估特定模型对给定数据有多好的方法。这里我们使用了<strong class="ih hj"> ' <em class="jx">稀疏分类交叉熵。</em> </strong>分类交叉熵是分类数据的损失函数，稀疏意味着它使用所有可能的类，但不使用其中的一些。</li><li id="2d77" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated"><strong class="ih hj"> <em class="jx">优化器- </em> </strong>它用于改变神经网络的属性，如权重和学习率。这里我们使用了<strong class="ih hj"> <em class="jx">【亚当】</em> </strong>优化器。代表<strong class="ih hj"> <em class="jx">自适应矩估计。</em> </strong>有助于更快得到结果。</li><li id="dd4a" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated"><strong class="ih hj"> <em class="jx">度量- </em> </strong>它用于评估机器学习算法。这里我们用了'<strong class="ih hj"> <em class="jx">'的准确度。</em> </strong>它是<em class="jx">正确预测数与输入样本总数的比值。</em></li></ol><ul class=""><li id="2bd1" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">第24行，<strong class="ih hj"/><em class="jx"/>是<em class="jx"> </em>用来训练我们的模特。需要训练和测试数据来拟合我们的模型。</li></ul><ol class=""><li id="de3d" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc kf ju jv jw bi translated"><strong class="ih hj"> <em class="jx">冗长</em></strong><em class="jx">——它有3个参数来传递0、1、2。</em> <strong class="ih hj"> verbose = 1 </strong>，包括进度条和每个时期一行，<strong class="ih hj"> verbose = 0 </strong>表示静默，<strong class="ih hj"> verbose = 2 </strong>，每个时期一行，即时期号/时期总数</li><li id="74c7" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated"><strong class="ih hj"> <em class="jx">历元</em> </strong> -一个历元是指整个数据集仅通过神经网络前后传递一次。</li></ol><p id="8de8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将绘制损失、验证损失和准确性</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="jm jn l"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es km"><img src="../Images/acb4583cb1bc500b48d131e60ad6c2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*3WimMhxRFRlHqp9j8qj5ng.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">图表</figcaption></figure><p id="e21f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上图中，蓝线代表训练损失、橙色验证损失和绿色准确性。</p><p id="f02e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看到<strong class="ih hj">验证损失和</strong>培训损失的关系图，有四点需要注意</p><ol class=""><li id="da7d" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc kf ju jv jw bi translated">验证损失应与培训损失相似，但略高。</li><li id="47c7" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated">如果训练损失远大于验证损失，那么就是<em class="jx">过度拟合</em></li><li id="1647" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated">如果培训损失远小于验证损失，那么这就是<em class="jx">欠拟合</em>。</li></ol><p id="9042" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在查看<strong class="ih hj">验证损失和验证准确度</strong>之间的图表时，有3点需要注意</p><ol class=""><li id="4aec" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc kf ju jv jw bi translated">如果val_loss增加而val_acc减少，则我们的模型没有学习。</li><li id="dd46" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated">如果val_loss和val_acc都在增加，则模型过拟合。</li><li id="f0b8" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc kf ju jv jw bi translated">如果val_loss在减少，而val_acc在增加，则模型是好的</li></ol><p id="7d46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以这里我们可以说我们的模型是不适合的。现在，在我的下一篇博客中，我们将会看到如何解决过度适应的问题。</p><p id="0b4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一次全部编码。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="jm jn l"/></div></figure><p id="fb6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jx">笔记本可以在这里找到</em><a class="ae jd" href="https://github.com/namratesh/Machine-Learning/blob/master/3.Cifar-10%20tensorflow2.0.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="jx"/></a><em class="jx">。</em></p><p id="ea7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考文献:</strong></p><ul class=""><li id="c2ef" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated"><a class="ae jd" href="https://peltarion.com/knowledge-center/documentation/modeling-view/build-an-ai-model/blocks/2d-max-pooling-block" rel="noopener ugc nofollow" target="_blank">2D Max pooling block | pelta rion平台</a></li><li id="1738" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated"><a class="ae jd" href="https://keras.io/layers/convolutional/" rel="noopener ugc nofollow" target="_blank">卷积层— Keras文档</a></li><li id="4dc2" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated"><a class="ae jd" href="https://missinglink.ai/guides/tensorflow/tensorflow-conv2d-layers-practical-guide/" rel="noopener ugc nofollow" target="_blank"> TensorFlow Conv2D图层:实用指南— MissingLink.ai </a></li><li id="13a4" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated"><a class="ae jd" href="https://stats.stackexchange.com/questions/326065/cross-entropy-vs-sparse-cross-entropy-when-to-use-one-over-the-other" rel="noopener ugc nofollow" target="_blank">机器学习——交叉熵与稀疏交叉熵:何时使用一个而不是另一个——交叉验证</a></li><li id="0e8a" class="jo jp hi ih b ii jy im jz iq ka iu kb iy kc jc jt ju jv jw bi translated"><a class="ae jd" href="https://forums.fast.ai/t/determining-when-you-are-overfitting-underfitting-or-just-right/7732/4" rel="noopener ugc nofollow" target="_blank">https://forums . fast . ai/t/determining-when-you-over-fitting-under-fitting-or-just-right/7732/4</a></li></ul></div></div>    
</body>
</html>