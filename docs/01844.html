<html>
<head>
<title>The PySerial way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PySerial方式</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-pyserial-way-840c79cbe093?source=collection_archive---------6-----------------------#2019-11-17">https://medium.com/analytics-vidhya/the-pyserial-way-840c79cbe093?source=collection_archive---------6-----------------------#2019-11-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1238091d97e1e84d71b788de104cd3e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*anzx2ZDM64-6lgvh"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">马库斯·沃利斯在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="34f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">使用Arduino控制LED灯，语音到文本转换api，当然还有很多python！！</em></p><blockquote class="ju jv jw"><p id="4e80" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">先决条件:</strong></p><p id="9d7e" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">Arduino Uno</p><p id="6b54" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">一些发光二极管和电线(试验板，如果有的话)</p><p id="a06d" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">Arduino IDE (可以从这里下载)</p><p id="4617" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">和python ❤️</p></blockquote><h1 id="8584" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">步骤1安装PySerial</h1><p id="e16f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">只需使用pip就可以安装pyserial模块。遵循以下命令:</p><blockquote class="ju jv jw"><p id="3c4d" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj"> $ pip安装pyserial </strong></p></blockquote><p id="7fd5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在bash shell中打开python，尝试导入Pyserial</p><blockquote class="ju jv jw"><p id="ef6d" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj"> &gt; &gt; &gt;导入序列</strong></p></blockquote><p id="df4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果没有抛出错误，就可以使用pyserial了🎉</p><h1 id="a5a4" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">步骤2安装语音到文本转换Api</h1><p id="3ff7" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">使用以下命令安装语音到文本api</p><blockquote class="ju jv jw"><p id="cbba" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj"> $ sudo pip安装语音识别</strong></p><p id="8847" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj"> $ pip安装pyaudio </strong></p></blockquote><p id="716d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> PS </strong>如果你在下载pyaudio时遇到错误，请点击<a class="ae iu" href="https://ourcodeworld.com/articles/read/974/how-to-solve-installation-error-of-pyaudio-in-ubuntu-18-04-fatal-error-portaudio-h-file-not-found" rel="noopener ugc nofollow" target="_blank">这里查看</a>。</p><p id="6817" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">检查两个模块的配置是否正确。在bash shell中打开python，并键入以下命令</p><p id="31c6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> &gt; &gt; &gt;导入语音_识别为sr </strong></p><p id="0dd4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">恳求🎊！我们已经完成了第2步..</p><h1 id="9a70" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">第三步实际编码💻</h1><blockquote class="ju jv jw"><p id="413b" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">关于pyserial的一点… </strong></p><p id="d96b" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">Pyserial用于使用Arduino电缆在python脚本之间传输和接收数据。顾名思义，数据是以串行方式传输的。Ser.read和ser.write是两个python函数，可用于从Arduino脚本读取数据或将数据写入Arduino脚本。</p></blockquote><p id="2675" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将Arduino板连接到PC的一个端口。查看端口名称。你可以在这里找到它</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/1f0eacdbe7f58d5de50fd6392fc0e9ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5yjHUzzW_djvJziCMJNm_Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">从arduino IDE获取端口名</figcaption></figure><h2 id="1a1e" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">配置python脚本</h2><p id="31eb" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">创建一个新的python文件，导入pyserial和SpeechRecognition。将此端口添加到python脚本中</p><blockquote class="ju jv jw"><p id="4f7d" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">#in connect.py</p><p id="55d6" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">ser =串行。串行('/dev/ttyACM0 '，9600)</p></blockquote><p id="785d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> PS </strong>:我用的是9600的波特率。你可以增加到15200(但我建议去9600)</p><p id="d04f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">连接您的api以将文本转换为语音</p><blockquote class="ju jv jw"><p id="dbfe" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">r = sr.Recognizer() <br/>使用sr.Microphone()作为源:<br/>print(" Speak:")<br/>audio = r . listen(source)</p><p id="4bb2" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">m=r.recognize_google(音频)</p></blockquote><p id="d2b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在检查语音到文本的转换，并执行相应的功能。我在这里控制发光二极管的开关。函数ser.write()将把数据写入arduino的串行监视器，我们将在后面的脚本中使用它。</p><p id="0b09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你使用python3，你需要对你的字符串进行编码，否则它会显示错误。在这里，如果用户说“开”，字符串“1”被传递到串行监视器，而对于“关”，字符串“0”被传递。</p><blockquote class="ju jv jw"><p id="0ea0" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">if(m = = ' on '):<br/>val = ' 1 '<br/>ser . write(val . encode(" utf-8 "))<br/>break</p><p id="109b" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">elif(m = = ' off '):<br/>val = ' 0 '<br/>print(val . encode(" utf-8 "))<br/>ser . write(val . encode(" utf-8 "))</p></blockquote><p id="86a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">太好了！您的python脚本已经可以使用了👍</p><h2 id="2d75" class="li kb hi bd kc lj lk ll kg lm ln lo kk jg lp lq ko jk lr ls ks jo lt lu kw lv bi translated">配置Arduino脚本:</h2><p id="60f2" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">将指示灯连接到arduino的第13针和第12针。现在检查以下代码:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/c8896487b9757ae94d6a26f6bc5893b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XHCkt8n06QK7-e1dtenGBw.png"/></div></div></figure><p id="07ac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，如果串行数据可用，脚本将读取数据(如果可用)。因为我们要发送一个字符串，所以我们需要使用to int()函数将字符串转换成int</p><p id="6c1a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在把代码上传到板上，运行你的python脚本。试着说开/关，你会看到发光二极管变亮/变暗</p><p id="7314" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">注意:如果你在上传代码时遇到权限错误，运行下面的命令</strong></p><blockquote class="ju jv jw"><p id="9ae7" class="iv iw jt ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">$<strong class="ix hj">sudo chmod a+rw/dev/tty ACM 0</strong></p></blockquote><p id="7fbb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请连接到强大的网络，因为没有网络api将无法工作</p><p id="b9ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你完成了所有的步骤，给自己一个大拇指👍</p><p id="5fb5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完整的代码可以在我的<a class="ae iu" href="https://github.com/ektaarora3501/pyserial" rel="noopener ugc nofollow" target="_blank"> github库</a>获得。</p><p id="d721" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望我涵盖了所有的步骤。如果你被困在任何地方，请随时联系我。我喜欢❤️的建议</p></div></div>    
</body>
</html>