<html>
<head>
<title>Understanding the role of vectors in natural language processing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解向量在自然语言处理中的作用</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-the-role-of-vectors-in-natural-language-processing-55f1632e17ff?source=collection_archive---------12-----------------------#2020-10-09">https://medium.com/analytics-vidhya/understanding-the-role-of-vectors-in-natural-language-processing-55f1632e17ff?source=collection_archive---------12-----------------------#2020-10-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ba8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自然语言处理:</strong></p><p id="eb66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由机器来处理、理解和分析人类语言是人工智能的子领域。在自然语言处理中有大量的应用，如机器翻译、语音到文本、文本到语音识别、垃圾信息分类等…</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/6d3f893bcc46e20e2ee14ba7ef703d74.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*jF0godKvSrD7yZ7D7_SdKw.png"/></div></figure><p id="5c2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个博客中，我们将看到向量在自然语言处理中的作用。</p><p id="63a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在深入 NLP 之前，让我们看看线性代数中的向量是什么</p><h1 id="e73c" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">矢量:</strong></h1><p id="d0aa" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">Vector 是一个对象的属性列表。简单来说，就是一串数字。这是识别空间(可能是二维或多维空间)中一个点的方法</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es ko"><img src="../Images/bc2e1a77a0bc9063677df0740169be5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*Iuvd4TkVew-OTzpQtJapJw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">二维坐标中的向量(a1，a2)</figcaption></figure><h1 id="3120" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">矩阵:</strong></h1><p id="61cc" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">矩阵是包含一组向量的对象。</p><p id="2a8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我有两个向量，形式为<br/> 2x + 3y <br/> &amp; <br/> 4x + 5y <br/>，那么矩阵将会是这样的</p><p id="5a03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将看到为什么我们在自然语言处理中使用向量空间的概念。</p><h1 id="a19e" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">为什么在自然语言处理中使用向量？</strong></h1><p id="b97b" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">我们无法将单词输入到机器学习或深度学习建模的算法中。反过来，我们必须将文本数据转换成数字数据的形式。所以矢量的概念开始发挥作用。为此，文本数据被转换成矢量形式的数值。自然语言处理中有许多预处理技术，以便将文本数据输入到算法中。</p><h1 id="f70b" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">特征表示:</strong></h1><p id="8c7b" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">在机器学习算法中，在我们将数据输入算法之前，我们以多种方式对数据进行预处理，如插补、归一化、标准化和特征工程。我们稍后将详细讨论它们。同样，在 NLP 中，我们必须对数据进行预处理，提取重要的单词，并从句子中删除不太重要的单词(如 and、of、are、is 等)。)</p><p id="a695" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在所有这些过程之后，我们有一些提取出来的词叫做语料库。从语料库中，我们将构建一个嵌入矩阵，如下图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/6dec54bb22c93dc675185b88b40cbed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*JLPahf8x-wdjUveBlZ5Bxw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">嵌入矩阵</figcaption></figure><p id="887e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上图中，值是矩阵的形式，每一列是一个向量。每个列值代表语料库中的单词(单词向量)，行代表特征。每个列值下面的数字(Man-5391)表示该单词在词汇表中的索引位置。</p><p id="1f5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们在那个矩阵里观察清楚，在第一排性别里，男人和女人，国王和王后，有相反的符号，表示他们的关系和性别，但是苹果和橘子之间没有发生这样的值相似性。如果我们拿下一排皇室成员来说，国王和王后比男人和女人有更高的价值。如果我们看到最后一行的 food，apple 和 orange 的值比其他单词的值高。因此，通过这样做，嵌入矩阵有助于将文本数据转换成数字形式，而不改变单词之间的实际意义和关系。</p><h1 id="6083" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">二维表示</h1><p id="3754" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">如果我们以二维空间的形式画出这些向量，我们将更好地了解这些向量在嵌入矩阵中的位置。</p><p id="9979" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就像是，</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es ky"><img src="../Images/9c0219b76ad788d241c841f9bc3897d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SROaoF6_ZEQUnjDyZLlDSQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">嵌入矩阵的 2D 表示</figcaption></figure><p id="9146" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在图中，我们可以看到国王和王后在附近，在一定距离后，有男人和女人。苹果、橘子和葡萄是分组的，同样地，数字和动物也在图中被很好地分类。</p><p id="3915" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样，我们将通过使用向量对文档或段落中的文本数据进行预处理，以便屈服于各种算法，用于垃圾邮件分类、推文情感分析等目的。</p><h1 id="7693" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">应用:</strong></h1><p id="3c32" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">为了理解 python 中的实现，让我们看一个 NLP 的实际应用。</p><p id="c7d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将研究使用文本数据集进行假新闻分类的例子。</p><p id="4347" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们将 CSV 数据加载到 panda 的数据框中，我们将继续进行文本预处理。它会像</p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="0102" class="le jm hi la b fi lf lg l lh li"><strong class="la hj">from</strong> <strong class="la hj">nltk.corpus</strong> <strong class="la hj">import</strong> stopwords<br/><strong class="la hj">import</strong> <strong class="la hj">re</strong><br/>ps=PorterStemmer()<br/>corpus=[]<br/><br/><strong class="la hj">for</strong> i <strong class="la hj">in</strong> range(0,len(message)):<br/>    review=re.sub('[^a-zA-Z]',' ',message['title'][i])<br/>    review=review.lower()<br/>    review=review.split()<br/>    review=[word <strong class="la hj">for</strong> word <strong class="la hj">in</strong> review <strong class="la hj">if</strong> <strong class="la hj">not</strong> word <strong class="la hj">in</strong>     stopwords.words('english')]<br/>    review=' '.join(review)<br/>    corpus.append(review)</span></pre><p id="e401" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Nltk 是用于 NLP 预处理文本数据的 python 库，re 是正则表达式库。</p><p id="c13c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的代码中，首先我们在 for 循环中使用正则表达式只提取文本数据。</p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="5073" class="le jm hi la b fi lf lg l lh li">review=re.sub('[^a-zA-Z]',' ',message['title'][i])</span></pre><p id="e6aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它只接受包含 a-z 和 A-Z 的单词，其中 message 是包含数据的数据帧。</p><p id="fdcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们使用 lower 函数来小写所有的文本。</p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="b819" class="le jm hi la b fi lf lg l lh li">review=review.lower()<br/>review=review.split()</span></pre><p id="a615" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以便算法不会以不同的方式对待小写和大写单词(GOOD = good)。然后我们把每个单词从句子中分离出来。</p><p id="d862" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们必须删除不太重要的单词，这些单词用下面的代码称为停用词。</p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="5ffe" class="le jm hi la b fi lf lg l lh li">review=[word <strong class="la hj">for</strong> word <strong class="la hj">in</strong> review <strong class="la hj">if</strong> <strong class="la hj">not</strong> word <strong class="la hj">in</strong>     stopwords.words('english')]</span></pre><p id="8a51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些停用词是，像，of，is，and，are，was，were，这些词被认为对句子没有任何意义。然后，我们将所有这些单词添加到一个列表中，形成语料库。</p><p id="a2e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将使用下面的代码构建嵌入矩阵</p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="d03b" class="le jm hi la b fi lf lg l lh li">cv=CountVectorizer(max_features=5000,ngram_range=(1,3))<br/>x=cv.fit_transform(corpus).toarray()</span></pre><p id="af1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中 x 是嵌入矩阵</p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="9858" class="le jm hi la b fi lf lg l lh li">x.shape<br/>// (18285, 5000)</span></pre><p id="93b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中 18285 代表语料库的数量，5000 是我们在上面的代码中提到的特征的数量。</p><p id="9088" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以看到那些特征是什么。我们不需要指定这些特性，它们内置在 CountVectorizer 中。</p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="9735" class="le jm hi la b fi lf lg l lh li">cv.get_feature_names()[50:75]<br/>//OUTPUT:<br/>['administration',<br/> 'admiral',<br/> 'admit',<br/> 'admits',<br/> 'admitted',<br/> 'ads',<br/> 'adults',<br/> 'advance',<br/> 'advice',<br/> 'adviser',<br/> 'advisor',<br/> 'advocates',<br/> 'affair',<br/> 'affairs',<br/> 'affordable',<br/> 'afghan',<br/> 'afghanistan',<br/> 'africa',<br/> 'african',<br/> 'african american',<br/> 'ag',<br/> 'age',<br/> 'agencies',<br/> 'agency',<br/> 'agenda']</span></pre><p id="80cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们将这些 x 数据和 y 标签输入到朴素贝叶斯算法中进行分类。</p><p id="b4d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里查看假新闻分类器<a class="ae lj" href="https://github.com/bagavathypriyanavaneethan/Natural-Language-Processing/blob/master/fake-news-classifier-nlp.ipynb" rel="noopener ugc nofollow" target="_blank">的完整 python 代码</a></p><p id="ba6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读，欢迎反馈</p><h1 id="976f" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">问候，<br/>巴格拉维亚 N</h1><h1 id="c817" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">参考:</strong></h1><p id="e1ac" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated"><a class="ae lj" href="https://www.coursera.org/learn/classification-vector-spaces-in-nlp" rel="noopener ugc nofollow" target="_blank">https://www . coursera . org/learn/class ification-vector-spaces-in-NLP</a></p></div></div>    
</body>
</html>