<html>
<head>
<title>Pandas DataFrame to PostgreSQL using Python!! Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 将数据帧转换成 PostgreSQL！！第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-dataframe-to-postgresql-using-python-part-1-93f928f6fac7?source=collection_archive---------4-----------------------#2020-11-25">https://medium.com/analytics-vidhya/pandas-dataframe-to-postgresql-using-python-part-1-93f928f6fac7?source=collection_archive---------4-----------------------#2020-11-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f378" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">介绍、连接&amp;数据库创建</strong></h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/1e0d5ecb6aa0f449176f9e959f7225c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKdLGkqoYegtL0ZHaPff3g.png"/></div></div></figure><h1 id="25c3" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">先决条件</h1><p id="fc34" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kd hj">Python 3 . 8 . 3:</strong><a class="ae kx" href="https://www.anaconda.com/products/individual" rel="noopener ugc nofollow" target="_blank">Anaconda 下载链接</a></p><p id="27f7" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">PostgreSQL 13:</strong>T8<strong class="kd hj">T10】下载链接</strong></p><p id="96a3" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj"> Psycopg2 : </strong>安装<strong class="kd hj"> Psycopg2 </strong>使用命令:<strong class="kd hj"> pip 安装 psycopg2 </strong></p><h2 id="98c3" class="ld jk hi bd jl le lf lg jp lh li lj jt kk lk ll jv ko lm ln jx ks lo lp jz lq bi translated">1.介绍</h2><blockquote class="lr ls lt"><p id="dd83" class="kb kc lu kd b ke ky ij kg kh kz im kj lv la km kn lw lb kq kr lx lc ku kv kw hb bi translated"><a class="ae kx" href="https://www.postgresql.org/about/#:~:text=PostgreSQL%20is%20a%20powerful%2C%20open%20source%20object-relational%20database,store%20and%20scale%20the%20most%20complicated%20data%20workloads." rel="noopener ugc nofollow" target="_blank"> <strong class="kd hj"> PostgreSQL </strong> </a>是一个强大的开源对象关系数据库系统，它使用并扩展了 SQL 语言，结合了许多功能，可以安全地存储和扩展最复杂的数据工作负载。PostgreSQL 的起源可以追溯到 1986 年，是加州大学伯克利分校的 POSTGRES 项目的一部分，在核心平台上已经有 30 多年的积极发展。</p></blockquote><h2 id="4fc7" class="ld jk hi bd jl le lf lg jp lh li lj jt kk lk ll jv ko lm ln jx ks lo lp jz lq bi translated">2.连接到 PostgreSQL 并创建数据库</h2><p id="4388" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kd hj">第一步:导入库</strong></p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="680d" class="ld jk hi lz b fi md me l mf mg"><strong class="lz hj"># import sys to get more detailed Python exception info</strong><br/>import sys</span><span id="57b4" class="ld jk hi lz b fi mh me l mf mg"><strong class="lz hj"># import the connect library for psycopg2</strong><br/>import psycopg2</span><span id="7464" class="ld jk hi lz b fi mh me l mf mg"><strong class="lz hj"># import the error handling libraries for psycopg2</strong><br/>from psycopg2 import OperationalError, errorcodes, errors</span></pre><p id="a7b1" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">第二步:指定连接参数</strong></p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="9021" class="ld jk hi lz b fi md me l mf mg"><strong class="lz hj"># Note: please change your host, username &amp; password as per your own values</strong></span><span id="aac6" class="ld jk hi lz b fi mh me l mf mg">conn_params_dic = {<br/>    "host"      : "localhost",<br/>    "user"      : "postgres",<br/>    "password"  : "Passw0rd"<br/>}</span></pre><p id="53fe" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">步骤 3:定义一个处理和解析 psycopg2 异常的函数</strong></p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="cf20" class="ld jk hi lz b fi md me l mf mg"><strong class="lz hj">def show_psycopg2_exception(err):</strong><br/>    <strong class="lz hj"># get details about the exception</strong><br/>    err_type, err_obj, traceback = sys.exc_info()</span><span id="80e1" class="ld jk hi lz b fi mh me l mf mg">   <strong class="lz hj"> # get the line number when exception occured</strong><br/>    line_n = traceback.tb_lineno</span><span id="8d63" class="ld jk hi lz b fi mh me l mf mg">    <strong class="lz hj"># print the connect() error</strong><br/>    print ("\npsycopg2 ERROR:", err, "on line number:", line_n)<br/>    print ("psycopg2 traceback:", traceback, "-- type:", err_type)</span><span id="b079" class="ld jk hi lz b fi mh me l mf mg">    <strong class="lz hj"># psycopg2 extensions.Diagnostics object attribute</strong><br/>    print ("\nextensions.Diagnostics:", err.diag)</span><span id="5b50" class="ld jk hi lz b fi mh me l mf mg">   <strong class="lz hj"> # print the pgcode and pgerror exceptions</strong><br/>    print ("pgerror:", err.pgerror)<br/>    print ("pgcode:", err.pgcode, "\n")</span></pre><p id="bf4c" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">步骤 4:定义一个连接函数来连接 PostgreSQL 数据库服务器</strong></p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="cbb6" class="ld jk hi lz b fi md me l mf mg"><strong class="lz hj">def connect(conn_params_dic):</strong><br/>    conn = None<br/>    try:<br/>        print('Connecting to the PostgreSQL...........')<br/>        conn = psycopg2.connect(**conn_params_dic)<br/>        print("Connection successful..................")<br/>        <br/>    except OperationalError as err:<br/>        <strong class="lz hj"># passing exception to function</strong><br/>        show_psycopg2_exception(err)</span><span id="4329" class="ld jk hi lz b fi mh me l mf mg">       <strong class="lz hj"> # set the connection to 'None' in case of error</strong><br/>        conn = None<br/>    <br/>    return conn</span></pre><p id="e3eb" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">第五步:在 PostgreSQL 数据库中创建一个名为 irisdb 的数据库</strong></p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="f0d1" class="ld jk hi lz b fi md me l mf mg">conn = connect(conn_params_dic)<br/>conn.autocommit = True</span><span id="73de" class="ld jk hi lz b fi mh me l mf mg">if conn!=None:<br/>    <br/>    try:<br/>        cursor = conn.cursor();<br/>        <strong class="lz hj"># Dropping database irisdb if exists</strong><br/>        cursor.execute("DROP DATABASE IF EXISTS irisdb;")<br/>    <br/>       <strong class="lz hj"> # Creating a database</strong><br/>        cursor.execute("CREATE DATABASE irisdb;");<br/>        print("irisdb database is created successfully............")<br/>    <br/>        <strong class="lz hj"># Closing the cursor &amp; connection</strong><br/>        cursor.close()<br/>        conn.close()<br/>        <br/>    except OperationalError as err:<br/>        <strong class="lz hj"># pass exception to function</strong><br/>        show_psycopg2_exception(err)<br/>        <strong class="lz hj"># set the connection to 'None' in case of error</strong><br/>        conn = None</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/e4e618052e6af4fc9d8ae9a1216d2a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vaFGJgxPKpKAoa1CvRzuCQ.png"/></div></div></figure><p id="9a0b" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">结论:</strong>这就结束了我们的<strong class="kd hj">第一部分</strong>关于<strong class="kd hj">的介绍，连接&amp;数据库创建</strong>。在本教程中，我们学习了如何使用 python 在 PostgreSQL 中连接和创建数据库。</p><p id="fb97" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">本文的所有代码都可以在 GitHub  上的<a class="ae kx" href="https://github.com/Muhd-Shahid/Learn-Python-Data-Access/tree/main/PostgreSQL" rel="noopener ugc nofollow" target="_blank"> <strong class="kd hj"> Jupyter 笔记本中获得。</strong></a></p><blockquote class="lr ls lt"><p id="eec1" class="kb kc lu kd b ke ky ij kg kh kz im kj lv la km kn lw lb kq kr lx lc ku kv kw hb bi translated"><strong class="kd hj">接下来</strong> <a class="ae kx" href="https://shahid-dhn.medium.com/pandas-dataframe-to-postgresql-using-python-part-2-3ddb41f473bd" rel="noopener"> <strong class="kd hj">第二部分</strong> </a> <strong class="kd hj">:使用 Python 在 PostgreSQL 数据库中创建表</strong></p></blockquote><p id="a25a" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">保持积极的态度！！注意安全！！继续学习:))</p><p id="6b6a" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">感谢您的阅读！！</strong></p></div></div>    
</body>
</html>