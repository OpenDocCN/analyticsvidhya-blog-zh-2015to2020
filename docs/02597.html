<html>
<head>
<title>Transfer Learning (Keras)— Life Just Got Easier!!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移学习(Keras)——生活变得更加简单！！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/transfer-learning-life-just-got-easier-11805a375039?source=collection_archive---------19-----------------------#2019-12-24">https://medium.com/analytics-vidhya/transfer-learning-life-just-got-easier-11805a375039?source=collection_archive---------19-----------------------#2019-12-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="135c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">挑选你的模型，部署它，然后玩一玩(Resnet50 + VGG16 + Xception) - &gt;集合它们..</strong></h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/102a51672c935cf86fd0439d13a4197b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNOh6VHcHt9eqWW1KDCXEw.jpeg"/></div></div></figure><p id="4a30" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">使用各种深度学习模型进行图像分类的web App。</strong></p><p id="c682" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最近，深度学习因为其在各种机器学习算法中的表现而获得了很大的流行。深度学习试图通过利用多个处理层来对信息的高级抽象进行建模。多类图像分类是当前人工智能领域一个具有广泛应用前景的主要研究方向。本课程项目描述了这种学习方法的使用，如VGG16、ResNet50、Xception等。；在ImageNet年度挑战任务的大规模多类图像分类数据集上执行多类图像分类并实现这些深度学习算法。我们将使用一个大型训练过的深度卷积神经网络来将120万张高分辨率图像分类到1000个不同的类别中。该实现将各种图像分类到其最可能的类别中，并显示预测概率的说明性示例。使用python的flask API开发了一个web应用程序，使用上述模型将这些图像分为不同的类别。我们的目标是找到一种计算效率高的算法，以更高的精度正确地对图像进行分类。</p><p id="5648" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">转移学习:</strong></p><p id="e79d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果不是为了<strong class="jl hj">迁移学习</strong>，机器学习对于一个绝对的初学者来说是一件相当困难的事情。在最底层，机器学习包括计算一个函数，该函数将一些输入映射到它们相应的输出。虽然函数本身只是一堆加法和乘法运算，但当通过一个非线性激活函数并将这些层堆叠在一起时，<strong class="jl hj">函数可以用来学习任何东西</strong>，只要有足够的数据可以学习，以及巨大的计算能力。</p><p id="2cca" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这就是迁移学习发挥作用的地方。在迁移学习中，我们采用已经训练好的模型的预训练权重(该模型已经在几天内在几个高功率GPU上对属于1000个类别的数百万幅图像进行了训练),并使用这些已经学习的特征来预测新的类别。<em class="kf">迁移学习的优势在于，不需要非常大的训练数据集，并且不需要太多的计算能力，因为我们使用预先训练的权重，并且只需要学习最后几层的权重。</em></p><p id="5cc4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">它工作得如此好的原因是，我们使用了一个在imagenet数据集上预先训练的网络，这个网络已经学会了在其初始层中识别不同对象的微小形状和小部分。通过使用预训练网络进行迁移学习，我们只需在预训练网络的末端添加几个密集层，并了解这些已学习特征的组合有助于识别新数据集中的对象。</p><p id="ed69" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因此，我们只训练几个密集层。此外，我们正在使用这些已经学习的琐碎特征的组合来识别新的对象。所有这些有助于使训练过程非常快，并且与从头开始训练conv网络相比，需要非常少的训练数据。</p><h2 id="da62" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">硬件要求:</strong></h2><p id="097f" class="pw-post-body-paragraph jj jk hi jl b jm lb ij jo jp lc im jr js ld ju jv jw le jy jz ka lf kc kd ke hb bi translated">四核英特尔酷睿i7 Skylake或更高处理器</p><p id="c78d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">8GB或更高的内存(8GB是可以的，但对于您可能想要和/或期望的性能来说不是)</p><p id="e8c6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">GPU</strong>:RTX 2070/RTX 2080 Ti/GTX 1070/GTX 1080/GTX 1070 Ti</p><p id="f1ba" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj"> CPU </strong>:每个GPU 1-2个内核，取决于您预处理数据的方式</p><p id="9c52" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">数据硬盘(&gt; = 1TB)</p><p id="f14e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">额外的监视器</p><p id="dc3b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">PSU有足够的PCIe连接器(6+8针)</p><p id="e1f4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">用于处理多个GPU的鼓风机式风扇</p><p id="ab82" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">带有多个PCIe插槽的主板</strong></p><h2 id="a216" class="kg kh hi bd ki kj kk kl km kn ko kp kq js kr ks kt jw ku kv kw ka kx ky kz la bi translated"><strong class="ak">软件要求:</strong></h2><p id="cf13" class="pw-post-body-paragraph jj jk hi jl b jm lb ij jo jp lc im jr js ld ju jv jw le jy jz ka lf kc kd ke hb bi translated">Windows操作系统</p><p id="2854" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Python 3.6以上版本</p><p id="997d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Anaconda导航器(工具)</p><p id="6825" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Spyder IDE</p><p id="524f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Flask API (Python)</p><p id="1bd2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">数字包</p><p id="6acf" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">操作系统包</p><p id="37f6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Keras包</p><p id="5985" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">WSGIServer包</p><p id="1b3d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">熊猫套餐</p><p id="1e6c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Pycharm IDE(用于flask项目)</p><p id="5278" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">详细设计:</strong></p><p id="e310" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">该项目用于开发一个web应用程序，使用Imagenet数据集上预先训练的模型将图像分类为不同的类别。ImageNet是机器学习中用于训练图像识别系统的常见学术数据集。基本思想是允许用户从他/她的系统上传图像，并对其运行不同的深度学习图像分类模型，以通过置信度(概率)得分分类到不同的类别中。</p><p id="e56e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">系统架构:</strong></p><p id="4d65" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">该系统的整体架构分为3个阶段:</p><p id="b1d8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">第一阶段:(迁移学习阶段)</strong></p><p id="e81b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这是项目的初始阶段。获取带有类别标签的大量数据(Imagenet ),并使用各种深度学习模型对其进行训练。这些模型通过从特征中提取模式来学习，并接受训练。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lg"><img src="../Images/c56835f371ad1bcf7dde654da3a34562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*a2NZRegz1dLxcYdYz5EhSg.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ki">图1:迁移学习阶段(第一阶段)</strong></figcaption></figure><p id="b9c4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">使用神经网络的下一步是训练。在训练期间，网络被输入数据(在这种情况下是图像)，网络的输出或猜测与预期结果(图像的标签)进行比较。随着每次数据的运行，网络的权重被修改以降低猜测的错误率；也就是说，它们被调整以使猜测更好地匹配图像的正确标签。(在数百万幅图像上训练大型网络会占用大量计算资源，因此像这样分发预先训练好的网络是有意义的。)</p><p id="7381" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">一旦经过训练，网络就可以用于推理，或者对它看到的数据进行预测。推理恰好是一个计算量少得多的过程。</p><p id="f33e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">第二阶段:(建立混合分类模型)</strong></p><p id="0409" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在这一阶段，我们加载我们从第一阶段生成的预训练模型权重，然后我们使用这些权重来训练我们的深度学习模型ResNet50、VGG16和Xception。然后，我们从每个分类器中推断出前3个准确度结果。然后，我们集成每个模型的前1类输出并显示最终结果。这样，预测图像的正确类别的准确性显著提高。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lg"><img src="../Images/28492a0863bc626e0b585afcc8de3a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*Mc1Jo_JhPlJWzJ2mYj6ZaQ.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ki">图2:建立混合分类模型(第二阶段)</strong></figcaption></figure><p id="015f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">第三阶段:(将模型部署为web应用程序)</strong></p><p id="5538" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在这个阶段，我们将使用python的Flask API开发一个web应用程序来部署我们新构建的深度学习图像分类模型。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lg"><img src="../Images/41eaad12d19d4ce3f7cde0a0828e7c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*7hTvltHgM51ybNdNYYD9pg.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ki">图3:将模型部署为Web App(第三阶段)</strong></figcaption></figure><p id="1eb3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们将待测试的图像从机器上传到web应用程序中。web应用程序进行API调用，计算模型，并将输出返回给用户屏幕。</p><p id="93c5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">实现:</strong></p><p id="a4e7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">带有Flask web App代码片段的Resnet50模型:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ll"><img src="../Images/9e34549099f228fc4ebb53d528b13aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*AsdBYeL89NqdJEA_Fbcppw.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">ResNet50模型代码片段</figcaption></figure><p id="8218" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj"> Flask Web应用UI: </strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lm"><img src="../Images/66b66e4c47a8f054b1edbc8fb192f3dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*KxpdEsgWUsv_7GuVltHQMw.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ki">用于单一模型的Flask web App(resnet 50)</strong></figcaption></figure><p id="ef17" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">适用于我们3款车型的Flask web应用:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ln"><img src="../Images/23d443a5d1ff943e9b81ae41b77626aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HnxUaN9ip2vIL90CpJ9DRA.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ki">我们3款车型的图像预测器网页</strong></figcaption></figure><p id="035a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在，我们有了3个顶级深度学习模型来预测同一张图像的结果(每个都给出了前3个预测)，我们可以选择最佳预测作为概率最高的预测。</p><p id="7a10" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在上述情况下，我们可以将结果视为ResNet50模型预测的“吉娃娃”，准确率为99.97%。</p><p id="b585" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这个项目的代码可以在GitHub找到:</p><p id="6837" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><a class="ae lo" href="https://github.com/MaajidKhan/Deploying3DeepLearningModels-Flask-" rel="noopener ugc nofollow" target="_blank">https://github . com/MaajidKhan/deploying 3 deeplearningmodels-Flask-</a></p><p id="2be5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">参考文献:</strong></p><p id="6390" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[1]<a class="ae lo" href="https://in.mathworks.com/matlabcentral/fileexchange/59133-neural-network-toolbox-tm--model-for-alexnet-network" rel="noopener ugc nofollow" target="_blank">https://in . mathworks . com/MATLAB central/file exchange/59133-neural-network-toolbox-TM-model-for-Alex net-network</a></p><p id="a398" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[2]李，h .格罗斯，r .兰加纳思，r .和Ng，A.Y .，2009年6月。卷积深度信念</p><p id="0571" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">分层表示的可扩展无监督学习网络。在<em class="kf">第26届机器学习国际年会会议录</em>(第609–616页)。ACM。</p><p id="a5e6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[3]利用MATLAB进行深度学习— matlab expo2018</p><p id="bb3f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[4]用MATLAB介绍深度学习——由</p><p id="7014" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">mathworks</p><p id="bc7e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[5]n .辛格和s .辛格，2017年3月。使用深度学习分析医学成像数据的对象分类。在<em class="kf"> 2017信息、嵌入式与通信系统创新国际会议(ICIIECS) </em>(第1–4页)。IEEE。</p><p id="95b9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[6] Azizah，L.M.R .，Umayah，S.F .，Riyadi，s .，Damarjati，c .和Utama，N.A .，2017年11月。在山竹表面缺陷检测中使用卷积神经网络的深度学习实现。在<em class="kf"> 2017年第七届IEEE控制系统、计算与工程国际会议(ic欧安会)</em>(第242–246页)。IEEE。</p><p id="6327" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[7] Shiddieqy，H.A .，Hariadi，F.I .和Adiono，t .，2017年10月。基于深度学习的图像分类在单板机上的实现。在<em class="kf"> 2017电子与智能设备国际研讨会(ISESD) </em>(第133–137页)。IEEE。</p><p id="af2d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[8]图夫龙，h .，韦达尔迪，a .，杜泽，m .和杰古，h .，2019年。修复列车测试分辨率差异。<em class="kf"> arXiv预印本arXiv:1906.06423 </em>。</p><p id="d416" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[9]f .乔莱，2017年。例外:具有深度可分卷积的深度学习。在<em class="kf">IEEE计算机视觉和模式识别会议论文集</em>(第1251-1258页)。</p><p id="b4e8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">[10]krijevsky，a .，Sutskever，I .和Hinton，G.E .，2012年。基于深度卷积神经网络的图像网分类。在<em class="kf">神经信息处理系统的进展</em>(第1097-1105页)。</p></div></div>    
</body>
</html>