<html>
<head>
<title>Deploy Django App in AWS EC2 Instance Using Docker Image</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Docker映像在AWS EC2实例中部署Django应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploy-django-app-in-aws-ec2-instance-using-docker-image-614529e6f6d1?source=collection_archive---------5-----------------------#2020-07-27">https://medium.com/analytics-vidhya/deploy-django-app-in-aws-ec2-instance-using-docker-image-614529e6f6d1?source=collection_archive---------5-----------------------#2020-07-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ca7e0ab6f419027bbdef0857840c5907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ydcFdcyXQ4hC6mZzWCvSPw.jpeg"/></div></div></figure><p id="1710" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个教程中，我将展示如何在AWS ec2实例中部署Django网站。</p><p id="c8c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Django </strong>是一个基于Python的高级免费开源Web框架，它鼓励快速开发和干净、实用的设计。</p><p id="e4a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Docker </strong>是一个工具，旨在通过使用容器来简化应用程序的创建、部署和运行。容器允许开发人员将应用程序与它需要的所有部分打包在一起，比如库和其他依赖项，并作为一个包进行部署。</p><p id="77c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">亚马逊弹性计算云</strong> (Amazon <strong class="is hj"> EC2 </strong>)是一种网络服务，在云中提供安全的、可调整大小的计算能力。它旨在使开发人员更容易进行网络规模的云计算。</p><h1 id="0971" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">Django应用程序</h1><p id="dead" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">这里我正在部署一个用Django制作的博客网站。当我们在本地托管该网站时，它看起来如下。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/f3c56f25f57b3a6388deff11bec68d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vdHjMRks_nUwFqLVqoBwiA.png"/></div></div></figure><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/917538702875cedf96471a4beffab616.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*_Jfsyk3ncjS5t1GmeyhzGQ.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx translated">文件夹结构</figcaption></figure><p id="d154" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我通过修改setting.py文件中的ALLOWED_HOSTS来允许所有来源的流量</p><pre class="ks kt ku kv fd lb lc ld le aw lf bi"><span id="4bc9" class="lg jp hi lc b fi lh li l lj lk">ALLOWED_HOSTS = ['*']</span></pre><p id="33bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">*在生产中使用您站点的域，而不是“*”。</p><p id="ebf9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们应该为这个项目创建一个虚拟环境，一旦我们的项目完成，我们将使用下面的命令保存requirements.txt中的依赖关系列表。</p><pre class="ks kt ku kv fd lb lc ld le aw lf bi"><span id="5e09" class="lg jp hi lc b fi lh li l lj lk">pip freeze &gt; requirements.txt</span></pre><p id="e176" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经完成了项目并存储了所有的依赖项，我们可以开始构建docker映像了。</p><h1 id="f404" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">建立码头形象</h1><p id="c150" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">我们将从docker文件构建docker映像。我们的文档将包含-</p><pre class="ks kt ku kv fd lb lc ld le aw lf bi"><span id="d2e7" class="lg jp hi lc b fi lh li l lj lk">FROM python:3.7-buster<br/>RUN mkdir /home/myblog<br/>WORKDIR /home/myblog <br/>COPY ./ /home/myblog/<br/>RUN pip install -r /home/myblog/requirements.txt<br/>EXPOSE 8000<br/>ENTRYPOINT ["python","manage.py","runserver","0.0.0.0:8000"]</span></pre><p id="29ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我已经在manage.py文件所在的主目录中创建了Dockerfile。在<a class="ae ll" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Dockerhub </a>中创建一个账户。</p><p id="b835" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们将通过运行以下命令来构建docker映像</p><pre class="ks kt ku kv fd lb lc ld le aw lf bi"><span id="d51f" class="lg jp hi lc b fi lh li l lj lk">sudo docker build -t &lt;username&gt;/&lt;imagename:version&gt; .</span></pre><p id="389c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">构建映像后，我们将运行<code class="du lm ln lo lc b">sudo docker images</code>命令来验证docker映像是否存在。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/3f7d3f47693cc6877261b4478a9fd8e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9MRot-N6qBCCXp3MyR0Ltw.png"/></div></div></figure><h1 id="9158" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">将Docker图像推送到Dockerhub</h1><p id="3fe7" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">现在我们将docker映像推送到我们的docker存储库，这样我们就可以在ec2实例中提取它。</p><pre class="ks kt ku kv fd lb lc ld le aw lf bi"><span id="4348" class="lg jp hi lc b fi lh li l lj lk">sudo docker push &lt;username&gt;/&lt;imagename:version&gt;</span></pre><h1 id="f01d" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">AWS EC2实例</h1><p id="5427" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">一旦我们完成了docker映像的构建，我们将转移到AWS ec2实例来托管我们的站点。</p><p id="9c67" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我采用的是预装Docker的亚马逊Linux实例。</p><p id="b927" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动实例时，我将<em class="lq">安全组</em>下的<em class="lq">入站规则</em>和<em class="lq">出站规则</em>保留为<em class="lq">所有流量。</em>拯救<em class="lq">。pem </em>文件。</p><h1 id="0032" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">访问EC2实例</h1><p id="0bb9" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">由于我们的实例正在运行，我们将部署代码。为此我们需要。<em class="lq"> pem </em>文件，<em class="lq"> IPv4公共IP </em>，<em class="lq">亚马逊Linux AMI用户名为</em> <code class="du lm ln lo lc b"><em class="lq">ec2-user.</em></code></p><p id="848b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开一个终端。pem文件存在，并通过命令- <code class="du lm ln lo lc b">chmod 400 &lt;.pem file name&gt;</code>更改密钥权限以避免警告。</p><pre class="ks kt ku kv fd lb lc ld le aw lf bi"><span id="4ab4" class="lg jp hi lc b fi lh li l lj lk">ssh -i <!-- -->&lt; .pem file name&gt; <!-- -->ec2-user@&lt; <em class="lq">IPv4 Public IP</em>&gt;</span></pre><p id="beed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的命令之后，我们将登录到实例。</p><p id="07d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们将从Dockerhub中提取应用程序映像，并使用以下命令运行它:</p><pre class="ks kt ku kv fd lb lc ld le aw lf bi"><span id="64de" class="lg jp hi lc b fi lh li l lj lk">docker run -it -p 8080:8000 &lt;username&gt;/&lt;imagename:version&gt;</span></pre><p id="9730" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以通过<strong class="is hj"> <em class="lq"> http:// &lt; IPv4公共IP &gt; :8080/ </em> </strong>访问我们的网站</p><p id="f5a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果这篇文章对你有所帮助，请考虑给👏🏼来激励我。</p></div></div>    
</body>
</html>