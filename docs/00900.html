<html>
<head>
<title>Transfer Learning with Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Keras进行迁移学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/transfer-learning-with-keras-9a1b3253211c?source=collection_archive---------5-----------------------#2019-09-17">https://medium.com/analytics-vidhya/transfer-learning-with-keras-9a1b3253211c?source=collection_archive---------5-----------------------#2019-09-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="59f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个博客中，我们将学习什么是迁移学习，以及何时和如何使用它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/b903ce9875025426e72da29819e820b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bi-_rpBbfhVAz6gi1uIRnw.png"/></div></div></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="165b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">迁移学习</strong>是深度学习中的一个研究问题，专注于存储在解决一个问题时获得的知识，并将其应用于另一个不同但相关的问题。</p><p id="6db9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">想法:</strong>我们可以重用现有的模型(VGG16)，而不是从头开始编码一个神经网络来解决我们的问题。</p><h2 id="1330" class="jw jx hi bd jy jz ka kb kc kd ke kf kg iq kh ki kj iu kk kl km iy kn ko kp kq bi translated"><strong class="ak">为什么要转学？</strong></h2><p id="f661" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">深度学习模型通常需要非常大的数据集来训练。当我们没有大的数据集时，这导致了过拟合的问题。</p><p id="99b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们用更多的层来训练我们的模型，那么过度拟合的可能性非常高。</p><p id="6fe5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了防止这种情况，我们需要大型数据集。一个<strong class="ih hj">预训练模型</strong>是一个保存的网络，它以前在一个大数据集上训练过，通常是在一个大规模图像分类任务上。您可以直接使用预先训练好的模型，也可以使用<strong class="ih hj">迁移学习</strong>来定制该模型以完成给定的任务。</p><p id="a3e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">图像网络数据集:</strong></p><p id="8e86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ILSVRC是一年一度的计算机视觉竞赛，它是基于一个名为ImageNet的公开计算机视觉数据集的子集开发的。因此，任务甚至挑战本身通常被称为ImageNet竞赛。</p><p id="5464" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">它拥有超过1400万个数据点和超过2万个类别。</strong></p><p id="d8a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ImageNet数据集是一个非常大的人类注释照片集合，由学者设计用于开发计算机视觉算法。</p><p id="46e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">何时以及如何应用迁移学习？</strong></p><p id="c689" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以应用迁移学习的例子有很多。我们将逐一进行分析。</p><p id="572a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">情况1:当我们的数据集非常小，但与image-Net数据集相似时。</strong></p><p id="0c55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">冻结所有图层，添加一些服装密集层，训练模型。</p><p id="22ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">情况2:当我们的数据集很大并且类似于Image-Net数据集时。</strong></p><p id="947c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以较小的学习率对整个网络进行微调。</p><p id="e684" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">情况3:当数据集是中等大小并且类似于Image-Net数据集时。</strong></p><p id="a712" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">微调最后几层。冻结顶层。</p><p id="62ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">情况4:当数据集较大且与Image-Net数据集不相似时。</strong></p><p id="d9b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用预训练的模型初始化网络的权重，并重新训练整个模型。</p><p id="43e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用于迁移学习的预训练模型的类型:</strong></p><p id="3b83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自2012年以来，出现了许多解决图像网络分类的模型。以下是一些模型:</p><ol class=""><li id="7058" class="kw kx hi ih b ii ij im in iq ky iu kz iy la jc lb lc ld le bi translated"><strong class="ih hj"> Alex-Net </strong> : Alex-net是Alex Krizhevsky设计的一种卷积神经网络的名称。AlexNet包含八层；前五层是卷积层，其中一些是最大轮询层，后三层是全连接层。它使用了非饱和ReLU激活函数，该函数显示出比tanh和sigmoid更好的训练性能。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/f5e2cd05ce5e4cea9973392e8f1899b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3pJYn1AVlIq-aTNFMewhA.png"/></div></div></figure><p id="967f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。VGG网</strong> : 2版本(VGG16和VGG19):是AlexNet的简化版，内核为3*3，步幅=1，填充=相同。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/3f3d02dc8921c88c852002db5968a26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-cDQSuyodPlCAPGceeizXw.jpeg"/></div></div></figure><p id="583a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。RESNET(34，50，101，152) </strong>:残差网络设计为跳过死连接，减少层数对性能的影响。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/b41fd3a751dac19d270f2a045812f767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S2C9c7-0H6glR73Z5kQrbA.png"/></div></div></figure><h1 id="b4bb" class="li jx hi bd jy lj lk ll kc lm ln lo kg lp lq lr kj ls lt lu km lv lw lx kp ly bi translated"><strong class="ak">应用迁移学习(VGG16): </strong></h1><p id="4f6f" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我们将在RVL-CDIP数据集上应用迁移学习。</p><p id="5308" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据来源:<a class="ae lz" href="https://www.cs.cmu.edu/~aharley/rvl-cdip/" rel="noopener ugc nofollow" target="_blank">https://www.cs.cmu.edu/~aharley/rvl-cdip/</a></p><p id="6832" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集中总共有400，000个文档图像。未压缩时，数据集大小约为100GB，包含16类文档类型，每类25，000个样本。示例类包括电子邮件、简历和发票。</p><p id="83a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目标:</strong></p><p id="55ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于给定的图像，将其分类到16个类别之一。</p><p id="97dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:导入库</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="379f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤2:使用图像数据生成器预处理并加载图像</strong></p><p id="cc9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我只从RVL-CDIP数据集加载一些样本。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="bf53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:使用迁移学习建立模型(VGG16) </strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="f033" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第四步:冻结顶层，添加一些自定义的致密层。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="f4ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第四步:由于我的问题是16个类的多类分类，添加16个单元密集层，编译模型</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="0633" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五步:查看最终模型:</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="368c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，在2200万个参数中，我们只训练了1000万个参数。</p><p id="b388" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第六步:训练最终模型:</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="4409" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论:</strong></p><ol class=""><li id="a0f6" class="kw kx hi ih b ii ij im in iq ky iu kz iy la jc lb lc ld le bi translated">冻结预训练VGG16模型的顶层，因为数据集是中等大小的。</li><li id="e131" class="kw kx hi ih b ii mc im md iq me iu mf iy mg jc lb lc ld le bi translated">为了防止过度适应，尝试迁移学习。</li><li id="3916" class="kw kx hi ih b ii mc im md iq me iu mf iy mg jc lb lc ld le bi translated">使用迁移学习，我训练了很少的参数，节省了很多时间。</li></ol><p id="06f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.当我们有类似ImageNet的数据集时，迁移学习效果最好。</p><p id="a67b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考文献:</strong></p><p id="8f5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lz" href="https://en.wikipedia.org/wiki/Transfer_learning" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Transfer_learning</a></p><div class="mh mi ez fb mj mk"><a href="https://www.cs.cmu.edu/~aharley/rvl-cdip/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">RVL-CDIP数据集</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">亚当·w·哈利、亚历克斯·乌弗克斯和康斯坦丁诺·g·德帕尼斯RVL-CDIP(瑞尔森视觉实验室综合文档信息…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">www.cs.cmu.edu</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my jn mk"/></div></div></a></div><p id="4d8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你是机器学习的新手，想知道多标签分类是如何工作的，那么就去看看这个<a class="ae lz" rel="noopener" href="/@akshaygoswaami/imdb-movie-genre-tag-prediction-4ee71a0aa9bd"> <strong class="ih hj">博客</strong> </a> <strong class="ih hj">。</strong></p><div class="mh mi ez fb mj mk"><a rel="noopener follow" target="_blank" href="/@akshaygoswaami/imdb-movie-genre-tag-prediction-4ee71a0aa9bd"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">IMDB电影类型标签预测</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">在这篇博客中，我们将知道如何使用经典和深度学习技术进行多标签分类。</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">medium.com</p></div></div><div class="mt l"><div class="mz l mv mw mx mt my jn mk"/></div></div></a></div></div></div>    
</body>
</html>