<html>
<head>
<title>Stock Portfolio Automatization with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python实现股票投资组合自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/stock-portfolio-automatization-with-python-b0aa5a3731ab?source=collection_archive---------3-----------------------#2020-12-11">https://medium.com/analytics-vidhya/stock-portfolio-automatization-with-python-b0aa5a3731ab?source=collection_archive---------3-----------------------#2020-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1939c6e24ebc4763023549c2c650a417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*399-5jBlWXhRM-Nf"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">约书亚·阿拉贡在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="30c7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di"> T </span>使用股票投资组合是分散风险的最佳方式之一，这是通过使用不同类型的股票来最大限度地降低投资单一行业或国家的潜在风险来实现的。同样，这需要不断审查投资组合中股票的回报和波动性，以获得比股票市场指数更好的回报。</p><p id="8cd8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是在自动化投资策略和回溯测试的环境中使用Python或R等编程语言非常有用的地方。为了验证前面的观点，我将使用Python测试一个简单的投资策略，并自动化一个高效的投资组合，其中包含的所有股票都是在股票市场指数中获得最佳回报的股票。</p><blockquote class="kc kd ke"><p id="ee4c" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">获得DJI指数上市公司</strong></p></blockquote><p id="8bfa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们将对维基百科页面进行网络抓取，在那里可以找到道琼斯工业平均指数(DJI指数)中所列公司的所有报价机，有了这些报价机列表，我们就可以下载股票价格的历史信息。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/eca60aa3f2cbdc8f1c9be033bf523b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5OVsUWuj230adro2UznrQ.png"/></div></div></figure><p id="aecd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有了DJI指数中列出的30只股票，我们可以下载它们价格的历史信息。</p><blockquote class="kc kd ke"><p id="2493" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">创建功能以测试策略</strong></p></blockquote><p id="6f51" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在继续应用一般策略之前，我们需要创建一些函数来分析该策略有多好。在这种情况下，我们将使用4种方法来帮助我们验证投资组合的表现。</p><p id="21db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1。-波动函数</strong></p><p id="616b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我们不会考虑投资组合中股票的权重，我们会把波动率当作单只股票来考虑，但会考虑投资组合的表现。该函数将由下式给出:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/19a812997ab5378b9f7b2fda8d735507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kF7KbSacULHWvj2gH3z34g.png"/></div></div></figure><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="69aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2。-年复合增长率(CAGR) </strong></p><p id="d140" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">复合年增长率允许我们看到一项资产或投资组合的年度表现，以从其初始价值获得其当前市场价值。CAGR假设投资组合获得的收益在每年年底进行再投资，并允许不同策略之间的简单比较。该函数由下式给出:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/9dabe20d008c6ffa921f00a5d2466f57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MYSbgdH0mvqeWFlqyOkfEg.png"/></div></div></figure><p id="c379" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中N是自购买股票以来已经过去的年数。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="ba1c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 3。-夏普比率</strong></p><p id="763e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">夏普比率允许我们分析投资组合中每个风险单位的回报。另一方面，无风险利率用于隔离与投资相关的回报。我们可以使用上面提到的两种方法来计算投资组合的表现和波动性。函数公式由下式给出:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ks"><img src="../Images/ca845b418902bc2040f1d35cb996238e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WOIfrzYTCzUDEr2j9RCrMg.png"/></div></div></figure><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><blockquote class="kc kd ke"><p id="4e04" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">获取历史价格数据</strong></p></blockquote><p id="0721" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">既然我们已经从DJI指数中获得了必要的报价器，我们就可以开始下载指数中每家公司的历史信息，并计算它们的回报。该数据库将是从2015年1月1日到2020年1月1日的每周价格。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/7b72bec01658696c409e781a54d7acff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tlAKYw0TRji1FEzzhZUR3A.png"/></div></div></figure><blockquote class="kc kd ke"><p id="0f3c" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">投资组合策略</strong></p></blockquote><p id="e5b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们需要考虑有多少X股票将构成投资组合，以及每周我们想从投资组合中移除多少Y股票。第二，我们将每周审查收益最高的X只最佳股票，我们将看到投资组合中Y只最差的股票，然后我们将从投资组合中剔除Y只股票，并用DJI指数中的X只最佳股票取而代之，这一过程将每周重复一次。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/17f278a9c2acc37780c3841a02bfa389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rItDLRD1vPUyI_SoTXUpTg.png"/></div></div></figure><blockquote class="kc kd ke"><p id="6f41" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">策略vs DJI指数</strong></p></blockquote><p id="46ed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有了投资组合的策略，我们将使用上面提到的函数来分析它的性能。值得一提的是，在无风险利率的情况下，我认为3个月期国库券利率约为2%。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/045a146cd0305314c537f2bb45cb1484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*X1zy0iiHRzF32clrvU-0kg.png"/></div></figure><p id="ede7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了便于比较，我们将使用DJI指数的收益来观察它在同一时期的波动性和表现。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/3ede8f0b72d68d5e351341026c0f845e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*WhWAc_dz9zz3cmtXdx3Zvw.png"/></div></figure><p id="6301" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对投资组合策略和DJI指数进行测试的结果表明，尽管投资组合的波动性较高，但所用策略中的CAGR和夏普比率较高。最后，我们将绘制DJI指数的表现与投资组合表现的图表，以便更好地了解两者。</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/3eebd4cf9576e7260229e59834c38eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4EYdOHl8eFfhMutzx8jmA.png"/></div></div></figure><p id="c0ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该图显示，虽然在第一个100周，两者的回报看起来很接近，但从长期来看，该投资策略设法获得比指数更好的回报。</p><blockquote class="kc kd ke"><p id="dcc2" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated"><strong class="ix hj">结论</strong></p></blockquote><ul class=""><li id="eec7" class="ky kz hi ix b iy iz jc jd jg la jk lb jo lc js ld le lf lg bi translated">投资策略，尽管不使用技术指标，但能让我们获得比基准指数更好的回报。</li><li id="a7a0" class="ky kz hi ix b iy lh jc li jg lj jk lk jo ll js ld le lf lg bi translated">回溯测试可以证实策略的好处，并将其扩展为未来的投资策略。</li><li id="99b6" class="ky kz hi ix b iy lh jc li jg lj jk lk jo ll js ld le lf lg bi translated">我们可以使用每日回报和有效边界理论来扩展之前描述的策略，以找到投资组合中最大化夏普比率的每只股票的权重。</li></ul></div></div>    
</body>
</html>