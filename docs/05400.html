<html>
<head>
<title>Mercari Price Suggestion: Case Study</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Mercari价格建议:案例研究</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mercari-price-suggestion-case-study-710ac75c30d5?source=collection_archive---------36-----------------------#2020-04-19">https://medium.com/analytics-vidhya/mercari-price-suggestion-case-study-710ac75c30d5?source=collection_archive---------36-----------------------#2020-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/501d51276ac07a924e3c08feb1893b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*Pxtn3LFnrgO9HICR3ASjUA.png"/></div></figure><p id="c731" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是我第一个与机器学习相关的博客。让我们来看看机器学习这个有趣的问题。</p><p id="1904" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">机器学习是解决商业问题的新方法。我们已经使用了许多电子商务网站，在那里我们根据价格和产品的不同质量来选择产品。我们可以使用机器学习方法自动为产品提供价格建议吗？你能自动向网上卖家建议产品价格吗？是啊！！我们可以通过机器学习的艺术来解决这个问题，它将为不同的产品提供价格建议。在这里，我参加了kaggle的一个竞赛，即“Mercari价格建议挑战”。</p><h1 id="0e6a" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">简介:问题陈述</strong></h1><p id="bbf0" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">服装的价格是非常关键的，因为它取决于许多因素，如品牌名称，质量，类别。价格也随着季节的不同而不同。即使很小的变化也会导致衣服价格的巨大差异。一家日本公司遇到了这个问题。如果他们向卖家提供价格建议任务，那么卖家将根据他们给衣服定价。这不是正确的方法，因为卖家会根据他们的价格来定价。因此，日本公司希望在算法的帮助下，自动向客户建议衣服的价格。</p><p id="cec4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这个问题中，有产品名称、类别、项目描述等输入字段。给定这些信息，任务就是预测产品的价格。因此，使用这些算法，我们可以在不使用人机界面的情况下完成价格建议任务，并提高任务的效率。</p><h1 id="8243" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">机器学习问题:</strong></h1><p id="c63f" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">在给定的任务中，我们预测了连续随机变量的价格。所以这是回归问题。此任务的给定输入变量是名称、品牌名称、类别名称、发货、项目条件标识和项目描述。价格是我们必须预测的目标变量。</p><h1 id="3dc6" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">步骤1:数据收集</strong></h1><p id="ea6b" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">这方面的数据可从以下网址下载:https://www . ka ggle . com/c/mercari-price-suggestion-challenge/data</p><p id="43c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">训练数据文件是tsv文件(制表符分隔文件),测试数据也是tsv文件。测试数据没有“价格”列。因此，我们必须构建一个模型，它将在测试数据文件上提供良好的性能。</p><p id="615a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这些文件由产品列表组成。这些文件用制表符分隔。</p><ul class=""><li id="8633" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated"><code class="du kx ky kz la b">train_id</code>或<code class="du kx ky kz la b">test_id</code> -列表的id</li><li id="cfb1" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated"><code class="du kx ky kz la b">name</code>——清单的标题。请注意，我们已经清理了数据，删除了看起来像价格(例如$20)的文本，以避免泄漏。这些删除的价格表示为<code class="du kx ky kz la b">[rm]</code></li><li id="e37d" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated"><code class="du kx ky kz la b">item_condition_id</code> -卖方提供的物品的状况</li><li id="16df" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated"><code class="du kx ky kz la b">category_name</code> -清单的类别</li><li id="2f0d" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated"><code class="du kx ky kz la b">brand_name</code></li><li id="cc7d" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated"><code class="du kx ky kz la b">price</code> -物品的销售价格。这是你要预测的目标变量。单位是美元。这个专栏在<code class="du kx ky kz la b">test.tsv</code>并不存在，因为那是你将要预测的。</li><li id="066d" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated"><code class="du kx ky kz la b">shipping</code> - 1表示运费由卖方支付，0表示由买方支付</li><li id="85c3" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated"><code class="du kx ky kz la b">item_description</code> -物品的完整描述。请注意，我们已经清理了数据，删除了看起来像价格(例如$20)的文本，以避免泄漏。</li></ul><p id="279f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们做一些探索性的数据分析:</p><h1 id="1fd7" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">第二步:探索性数据分析</strong></h1><p id="cb52" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">在训练数据中有大约140万个数据点，在测试数据中有大约340万个数据点。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">训练和测试数据的形状</figcaption></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">关于列车数据的信息</figcaption></figure><p id="ebfb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到brand_name、item_description和category_name缺少值。</p><p id="c69e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2.1缺失值处理:</strong></p><p id="4e5b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">“品牌名称”、“项目描述”和“类别名称”等列中缺少值。此处，缺少的值在“品牌名称”和“类别名称”列中用“缺少”填充。“item_description”列中缺少的值用“no description”填充。</p><p id="720e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2.2单因素分析:运输</strong></p><p id="4d19" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看“运输”功能对我们的问题是否有用。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/23a30864471f2f8e84604cbda1a98acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*IN4V2wagCOlbVuwhZlgeGA.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图1:发货计数图</figcaption></figure><p id="ba16" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到“shipping”列中有两个唯一的值。当shipping=0表示运费由客户支付，shipping=1表示运费由卖方支付。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">平均价格唯一运输价值</figcaption></figure><ul class=""><li id="3e2b" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">观察:</li><li id="2761" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">这里我们可以看到，如果shipping=0 ie。运费由客户支付，因此价格较高，这与实际情况相反。在大多数情况下，如果产品价格较低，运费由客户支付，而当价格较高时，运费由卖方支付。当shipping = 1ie时，这里的场景是不同的。运费由卖家支付，所以价格很低。</li></ul><p id="647b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2.3单变量分析:item_condition_id </strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lr"><img src="../Images/f6f6891869e0d1432ae81caadabfb6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-DHdCEgS17H4YMjXpB5cg.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图2:项目条件标识的计数图</figcaption></figure><p id="7080" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">item_condition_id=1的产品较多，item_condition_id=5的产品较少。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lw"><img src="../Images/d64a2eb6749ab1259fc215b7ce084b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5dFuMPXGk7LcrE9y72VYZA.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图3:与项目条件标识相关的价格分布</figcaption></figure><p id="de82" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从上图中可以看出，item_condition_id= 5的产品价格略高于item_condition_id不为5的产品。</p><p id="5fd8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2.4单因素分析:价格</strong></p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">价格百分点</figcaption></figure><p id="aaa2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到，50%的产品价格低于17美元。有70%的产品价格低于26美元。</p><p id="94a3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有90%的产品价格低于51美元。大多数产品的价格都很低。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/910bbe252d85c195c717cb42326d4c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*VC1XIijZ7Fuc1DMecrh6XQ.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图4:价格直方图</figcaption></figure><p id="82b1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2.5单变量分析:类别名称</strong></p><p id="8bb1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到,“category_name”列有三个子类别，由“/”分隔。这里，我们通过从“category_name”中拆分类别来创建新的三列。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">拆分category_name列的子类别</figcaption></figure><ul class=""><li id="2d7f" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">类别1:</li></ul><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">每个类别的数据点_1</figcaption></figure><p id="120a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">*在category_1列中有11个独特的类别。我们可以看到“女性”是column_1中出现频率最高的类别。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ly"><img src="../Images/f005248d5c1cf10cbf3d672cb151274c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lhebwEKVFsIpWMiqcPMKg.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图5:每个类别的价格分布_1</figcaption></figure><p id="04d5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到每个类别1的价格都有变化。不同的类别1在价格上有差异。因此，类别1可能是预测的重要特征。</p><ul class=""><li id="7c32" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">类别2:</li></ul><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">category_2中的唯一类别</figcaption></figure><p id="4870" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在category_2列中有114个唯一的类别。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lz"><img src="../Images/5df7496bf1d4582a4321fe773cd10afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_i4ZPDdCwVARX6gjeeEkqg.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图6:每个类别的价格分布_2</figcaption></figure><p id="0b09" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到每个类别的价格有很大的差异。不同的类别2在价格上有差异。因此，类别2可以作为预测的重要特征。</p><ul class=""><li id="b208" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">类别3:</li></ul><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ma"><img src="../Images/7a3e82c656c741bc24396e3d109b1b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOzjVQT0P8ng7btVBMM_Vg.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图7:每个类别的价格分布_3</figcaption></figure><p id="36e8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里只考虑来自category_3列的价格更高的顶级类别。我们可以看到每个类别的价格有很大的差异。不同的类别3在价格上有差异。因此，类别3可以作为预测的重要特征。</p><p id="e317" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2.6单因素分析:brand_name </strong></p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mb"><img src="../Images/b9597d6c943d79022905b39116488665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTYCxLyeAqb4rsXro9UzoA.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图8:每个品牌名称的价格分布</figcaption></figure><p id="09e5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到每个品牌的价格有很大的差异。不同的品牌价格不同。因此，品牌名称可能是预测的重要特征。</p><h1 id="89f6" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">第三步:数据预处理</strong></h1><ul class=""><li id="cd0a" class="ko kp hi io b ip kj it kk ix mc jb md jf me jj kt ku kv kw bi translated">文本特征:“item_description”和“name”列是使用regex预处理的文本特征。所有数据清理任务都像删除停用词一样完成(“我”、“我”、“哪里”等)</li><li id="701c" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">分类特征:分类特征如“品牌名称”、“类别1”、“类别2”和“类别3”被预处理为从它们中移除特殊符号。</li></ul><h1 id="be3a" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">步骤4:特征工程</h1><ul class=""><li id="635a" class="ko kp hi io b ip kj it kk ix mc jb md jf me jj kt ku kv kw bi translated">文本特征的特征工程:这里有两个文本栏。“name”和“item_description”连接在一起形成新列“cleaned_text”。</li></ul><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">特征工程</figcaption></figure><ul class=""><li id="77a2" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">分类数据的特征工程:从探索性数据分析中，我们知道“类别1”、“类别2”、“类别3”和“品牌名称”是有用的特征，因为它们随价格而变化。因此准备了以下新功能:</li><li id="ba78" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">brand_median_price:训练数据中每个唯一品牌名称的中间价格</li><li id="f9aa" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">cat1_median_price:列车数据中每个唯一“category_1”的中间价格</li><li id="16f8" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">cat2_median_price:列车数据中每个唯一“category_2”的中间价格</li><li id="f929" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">cat3_median_price:列车数据中每个唯一“category_3”的中间价格</li><li id="8feb" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">brand_mean_price:训练数据中每个唯一品牌名称的平均价格</li><li id="7898" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">cat1_mean_price:列车数据中每个唯一“类别1”的平均价格</li><li id="0dde" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">cat2_mean_price:列车数据中每个唯一“类别2”的平均价格</li><li id="bdad" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">cat3_mean_price:列车数据中每个唯一“类别3”的平均价格</li></ul><h1 id="f8e9" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">步骤5:训练和交叉验证数据分割</strong></h1><p id="3b6c" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">这里，训练数据被分成训练和交叉验证数据。为了获得最佳的超参数，我们使用交叉验证数据。因此，使用最佳的超参数，我们可以在测试数据上获得良好的结果。</p><h1 id="680c" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">步骤6:特征化</strong></h1><p id="4bc6" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">所有的机器学习和深度学习模型都是对数字数据进行处理的。因此，为了将所有文本和分类特征转换成数字数据，我们正在进行如下特征化。</p><ul class=""><li id="5b45" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">分类特征的一种热编码:分类特征，如“category_11”、“category_2”、“category_3”和“brand_name”，一种热编码用于将这些特征转换成数字格式。</li><li id="4e9e" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">文本特征上的TFIDF矢量器:TFIDF矢量器应用于“cleaned_text”哪个文本特征。</li><li id="342d" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">数字特征的标准化:标准化应用于数字特征，如“品牌_中值_价格”、“类别1 _中值_价格”等。</li></ul><h2 id="b53b" class="mf jm hi bd jn mg mh mi jr mj mk ml jv ix mm mn jz jb mo mp kd jf mq mr kh ms bi translated"><strong class="ak">数据矩阵:</strong></h2><p id="565f" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">现在我们要把所有的特征叠加起来，形成数据矩阵。</p><h1 id="b62a" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">第7步:绩效指标</strong></h1><p id="4051" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">Kaggle给出了均方根对数误差(RMSLE)作为这个问题的性能度量。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/07af4f26091187c538275a6c06f613c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*eXBD8YYFYROtPAw_a4Al8w.png"/></div></figure><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/f5b9e262542d6dd28cd6d447f5c425c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*s5GMbOGLTY8Jv4slhdMJsA.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">将价格转换成日志形式</figcaption></figure><p id="11fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">性能指标是均方根对数误差，因此价格值被转换为对数形式，以便用于模型训练。</p><h1 id="ef2e" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">步骤8:机器学习建模</strong></h1><p id="ea25" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated"><strong class="io hj"> 8.1第一次切割方法:</strong></p><p id="c81f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里简单的岭回归应用于具有不同alpha值的训练数据。这是一个简单的模型，用来观察它的表现以及训练需要多少时间。以便进一步应用复杂的模型。对于超参数调整，使用GridsearchCV。对于岭回归，训练时间不高。</p><p id="0e06" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">岭回归:</strong></p><ul class=""><li id="136b" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">执行L2正则化，即在优化目标中添加相当于系数大小的<strong class="io hj">平方的惩罚。</strong></li></ul><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">里脊回归</figcaption></figure><p id="ecb3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用岭回归的均方根对数误差为0.4880。</p><p id="d795" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们尝试一些复杂的模型:</p><p id="57a1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 8.2 LGBM回归量:</strong></p><p id="732b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Light GBM是一个基于决策树算法的快速、分布式、高性能梯度<a class="ae mv" href="https://courses.analyticsvidhya.com/courses/ensemble-learning-and-ensemble-learning-techniques?utm_source=blog&amp;utm_medium=which-algorithm-takes-the-crown-light-gbm-vs-xgboost" rel="noopener ugc nofollow" target="_blank"><strong class="io hj"/></a><strong class="io hj"/>框架，用于许多机器学习任务。</p><p id="acd8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">选择LGMB回归器而不是xgboost的原因:</p><ol class=""><li id="06b6" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj mw ku kv kw bi translated"><strong class="io hj">更快的训练速度和更高的效率</strong> : Light GBM使用基于直方图的算法，即将连续的特征值放入离散的箱中，加快了训练过程。</li><li id="91eb" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated"><strong class="io hj">更低的内存使用率:</strong>将连续值替换为离散值，从而降低内存使用率。</li><li id="8498" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated"><strong class="io hj">与大数据集的兼容性:</strong>与XGBOOST相比，它能够在训练时间显著减少的情况下与大数据集表现一样好。</li></ol><p id="f418" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">应用LGBM回归器，并使用RandomizedsearchCv进行超参数调整，以获得最佳“最大深度”和最佳“n估计值”。</p><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">使用LGBM回归器的超参数调整</figcaption></figure><p id="82ae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当LGMB应用于具有最佳超参数的数据时，它给出RMSLE =0.4810，比岭回归略好。</p><h2 id="beea" class="mf jm hi bd jn mg mh mi jr mj mk ml jv ix mm mn jz jb mo mp kd jf mq mr kh ms bi translated">观察:</h2><p id="6e75" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">1)岭回归器是用于回归任务的简单线性模型，其给出了类似于基于树的LGBM模型的良好结果。岭回归器耗时更少。</p><p id="b658" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2) LGBM回归器是基于树的模型，其给出的结果略好于岭回归，但是岭回归器和LGBM回归器的结果没有太大差异。LGBM回归比岭回归耗时更多。</p><h1 id="8c22" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">第九步:深度学习模型</strong></h1><p id="a8ec" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">在尝试了机器学习模型之后，我们将应用深度学习模型来提高分数。</p><p id="cd5d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">深度学习模型的特征工程:</strong></p><ol class=""><li id="125f" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj mw ku kv kw bi translated">“item_description”和“name”列连接在一起，形成“cleaned_text”功能。</li><li id="2cc6" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated">“名称”、“品牌名称”和“类别名称”连接在一起，并获得“清洁名称”特征。对于深度学习模型,“category_name”列中的类别不会像机器学习模型一样拆分。</li></ol><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">特征工程:深度学习</figcaption></figure><p id="33af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">深度学习模型的特征:</strong></p><ol class=""><li id="4fda" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj mw ku kv kw bi translated">文本特征:TFIDF矢量器应用于“cleaned_text”和“cleaned_name”列。</li><li id="e2e6" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated">一个热编码:对于“发运”和“item_condition_id ”,应用一个热编码。</li></ol><h1 id="18f0" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak"> 9.1深度学习模型:</strong></h1><p id="9ddd" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">在应用了机器学习模型之后，我们来看看深度学习模型的表现如何。</p><p id="032f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">多层感知器:</strong></p><p id="8902" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> MLP </strong>代表多层感知器，是神经网络的经典类型。它们可以有一层或多层神经元。数据被提供给输入层，可能存在一个或多个提供抽象级别的隐藏层，并且在输出层(也称为可见层)上进行预测。<strong class="io hj"> MLP </strong>是一类前馈人工神经网络。</p><p id="a3b9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里使用MLP来解决回归问题，并获得比机器学习模型更好的分数。</p><p id="99f2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">不同数量的层和每层不同数量的节点，应用激活函数。通过对具有以下规格的不同数量的时期运行模型，用MLP获得最佳结果:</p><p id="d9f4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">本案例研究中使用MLP网络包括:</p><ul class=""><li id="507d" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj kt ku kv kw bi translated">五个隐藏层</li><li id="7bd3" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">激活功能:relu</li><li id="6554" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">优化器:Adam</li><li id="351c" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj kt ku kv kw bi translated">学习率:3e-4</li></ul><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="lg lh li lj fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">使用MLP评分</figcaption></figure><p id="9e5d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用简单的MLP架构，均方根对数误差(RMSLE)得以降低。所以简单的深度学习模型比机器学习模型给出了更好的结果。</p><h2 id="060c" class="mf jm hi bd jn mg mh mi jr mj mk ml jv ix mm mn jz jb mo mp kd jf mq mr kh ms bi translated"><strong class="ak">第10步:在kaggle中最终提交:</strong></h2><p id="5851" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">Kaggle得分在本次比赛的所有得分中排名前8%:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mx"><img src="../Images/52fcb177267560ddb7d0b876c02a3692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZfSTi6TlJ04H80zs7f-GA.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图9: Kaggle得分</figcaption></figure><h1 id="1324" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">第11步:未来工作</strong></h1><p id="e8a0" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">1.使用不同于TFIDF矢量器的特征化技术，可以提高模型性能。</p><p id="36de" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.对文本数据使用嵌入层，并使用像LSTM那样的序列模型，可以改进模型。</p><p id="4086" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.随着更复杂的深度学习模型的出现，性能可能会变得更好。</p><h2 id="8a92" class="mf jm hi bd jn mg mh mi jr mj mk ml jv ix mm mn jz jb mo mp kd jf mq mr kh ms bi translated"><strong class="ak">模型结果对比:</strong></h2><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es my"><img src="../Images/f22b5cd1c6dd3369421aacea27d9a9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*4iwaPG0houribcy-jpwn6w.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图10:所有模型的结果表</figcaption></figure><p id="a52f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">参考文献:</strong></p><ol class=""><li id="c63c" class="ko kp hi io b ip iq it iu ix kq jb kr jf ks jj mw ku kv kw bi translated"><a class="ae mv" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="6533" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated"><a class="ae mv" href="https://www.kaggle.com/c/mercari-price-suggestion-challenge" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/mercari-price-suggestion-challenge</a></li><li id="720b" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated"><a class="ae mv" href="https://towardsdatascience.com/a-data-science-case-study-with-python-mercari-price-prediction-4e852d95654" rel="noopener" target="_blank">https://towards data science . com/a-data-science-case-study-with-python-mercari-price-prediction-4e 852d 95654</a></li><li id="38a1" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated"><a class="ae mv" href="https://www.kaggle.com/apapiu/ridge-script" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/apapiu/ridge-script</a></li><li id="4f8e" class="ko kp hi io b ip lb it lc ix ld jb le jf lf jj mw ku kv kw bi translated"><a class="ae mv" href="https://www.kaggle.com/huguera/mercari-data-analysis" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/huguera/mercari-data-analysis</a></li></ol><p id="909a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> LinkedIn个人资料:</strong></p><p id="cfbf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">领英简介:<a class="ae mv" href="https://www.linkedin.com/in/renuka-jagdale-7ba79314a" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/renuka-jagdale-7ba79314a</a></p><p id="27bb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> GitHub简介:</strong></p><p id="53c6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">github:<a class="ae mv" href="https://github.com/RenukaJagdale" rel="noopener ugc nofollow" target="_blank">https://github.com/RenukaJagdale</a></p><p id="ea12" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢阅读。继续读，继续学。</p></div></div>    
</body>
</html>