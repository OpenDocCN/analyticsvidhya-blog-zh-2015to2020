<html>
<head>
<title>Handling Class Imbalance Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理阶层失衡问题</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/handling-class-imbalance-problem-2eb366e21979?source=collection_archive---------19-----------------------#2020-06-18">https://medium.com/analytics-vidhya/handling-class-imbalance-problem-2eb366e21979?source=collection_archive---------19-----------------------#2020-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="59bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">什么是阶层失衡问题？</em></p><p id="ca9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi je translated"><span class="l jf jg jh bm ji jj jk jl jm di"> D </span> ata据说在阶层分布高度<strong class="ih hj"><em class="jd"/></strong>不平衡时，会遭遇<strong class="ih hj">T5</strong>阶层不平衡问题。在这种情况下，属于一个类别的观察值的数量显著低于属于其他类别的观察值的数量。当面对不平衡的数据集时，机器学习算法往往会产生不可接受的预测。</p><p id="edfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">在本文中，我们将看到一些关于如何使用R. </em>处理 <strong class="ih hj"> <em class="jd">类不平衡问题</em> </strong> <em class="jd">的技巧</em></p><p id="39c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们根据GRE分数、GPA分数和学校排名等独立变量来获取因变量为大学录取的数据。</p><p id="207b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是数据的结构。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es jn"><img src="../Images/33eaeef1e5ca7a8e59b55aef200c689b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*YBuGlcmNw5AAkiazDyKW0A.png"/></div></figure><p id="cc68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们把目标变量的类型转换成一个因子。数据汇总显示了目标变量的不平衡。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es jv"><img src="../Images/1a94a3233009eae02693bf83b980115d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*D-15iBaCRGPHUYY1Ybx0iQ.png"/></div></figure><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jw"><img src="../Images/663af62170f602befa78d541ba8d71ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d4fB3I7ipKcxyhaKmCOjxQ.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated"><strong class="bd kf">在我们的数据中，大约三分之二的数据属于‘0’类。</strong></figcaption></figure><p id="c641" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">由此，我们可以说存在着阶级不平衡。</em>T25】</strong></p><p id="19b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，当我们在这种数据上开发预测模型时，该模型将由类“0”的贡献主导。当预测未被录取的班级时，模型的准确性将优于被录取的班级。但是，在这种情况下，我们可能会对更准确地预测录取类别感兴趣。所以这叫做<strong class="ih hj"> <em class="jd">阶级不平衡问题</em>。</strong></p><h2 id="b06c" class="kg kh hi bd kf ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">数据分区</h2><p id="580f" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">现在，让我们按照70:30的比例将数据划分为训练数据和测试数据。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lf"><img src="../Images/4c1abaecaeefe74955577a07927004a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*lX43WaMHp76pfiB1FshMWA.png"/></div></figure><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lf"><img src="../Images/516e19a020bea642fb14df30108b24dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*9SMtpq6pTEfaUPYKojWkGg.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated"><strong class="bd kf">测试数据有115个观察值，列车数据有285个观察值</strong></figcaption></figure><p id="10a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是目标变量在训练数据中的分布。大约66%的数据属于未被承认的类别。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lg"><img src="../Images/66528a519bd3276b11e78eee9ffd6896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*A18_UaUDabWZcH8Vrbe-MA.png"/></div></figure><h2 id="f35c" class="kg kh hi bd kf ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">预测模型</h2><p id="5856" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">让我们在测试数据上使用随机森林算法和相应的混淆矩阵开发一个预测模型。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lh"><img src="../Images/44b4bb32174bbb4d42d9976f58c40c5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*SQwbS-Hb7dhyuTgHEhcMVg.png"/></div></figure><p id="bd61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们可以看到模型的准确率为67.83%。该模型正确地将70名学生分类为未被录取，将8名学生分类为被录取。95%的置信区间表明准确度在58.47%和76.23%之间。</p><p id="4a83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">【无信息率】</em> </strong>表示被观察类的最大比例。在这个数据集中，最大的比例((70+15)/115=73.91%)属于“0”类。这意味着，如果我们不建立任何模型，并明确分类每一个未被接受的申请人，它将是正确的73.9%的时间。此外，模型的整体准确性低于无信息率。因此这个模型不好。<br/>还有，如果我们对预测1感兴趣，那么这个模型就不够用了。</p><p id="dd94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd"/></strong>敏感度是我们能够正确预测1类的频率。这里的灵敏度计算为26.66%。同样，<strong class="ih hj"> <em class="jd">特异性</em> </strong>是我们能够正确预测0类的频率。这里计算的特异性为83.52%。特异性比敏感性高得多的原因之一是类别0具有比类别1高得多的观察值。<strong class="ih hj"> <em class="jd">因此这个模型是由0级支配的。</em> </strong>所以整体精度是<strong class="ih hj"> <em class="jd">误导</em> </strong>。</p><h2 id="68fd" class="kg kh hi bd kf ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">过采样</h2><p id="c08d" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">让我们使用<strong class="ih hj"> <em class="jd">过采样</em> </strong>来处理不平衡数据集问题。为此，我们将使用<strong class="ih hj">包ROSE，函数<em class="jd"> ovun.sample </em> </strong>，方法为<strong class="ih hj"> <em class="jd"> Over </em> </strong>如下图。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es li"><img src="../Images/3575fa82abd611ad7ff40ccdd6c492fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*E9F2ZoYMLBKPmR39T6sTqA.png"/></div></figure><p id="aa1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经提供了N为376(188 * 2–188个0类观察值)。因此，发生的情况就像类1的一些数据点被随机重复，以克服类不平衡问题。</p><p id="71fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们在过采样数据集上运行随机森林算法。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lj"><img src="../Images/b05af83860265b47f88f88235e5d638c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*vsdQq5_06YLjcmsiE06_3w.png"/></div></figure><p id="adad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，当数据集平衡时，准确率下降到了57.39%。灵敏度现在提高了(50%)。所以如果我们的兴趣是正确预测类1，那么这个模型要优于上一个。但是，该模型在准确性方面表现不佳。</p><h2 id="f9db" class="kg kh hi bd kf ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated"><strong class="ak">欠采样</strong></h2><p id="931b" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">让我们看看如何使用<strong class="ih hj"> <em class="jd">欠采样</em> </strong>来处理类不平衡问题。欠采样。除了 下的<strong class="ih hj"> <em class="jd">方法外，我们的功能与之前相同。</em></strong></p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lk"><img src="../Images/be196c52cea3476dc811ac9dfad38735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*h2d6CFu1n_FnpraHB3glnA.png"/></div></figure><p id="867c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们提供N为194(97*2)。这里，97个数据点是从类0中随机欠采样的。但是一些重要的信息可能因此而丢失。</p><p id="ff85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看使用欠采样数据集的模型的性能。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es ll"><img src="../Images/c698ad00dc22e4c9027ee5151926c82f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*eQur6QvHiiNXJa6uh307tA.png"/></div></figure><p id="aad4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们的重点是正确预测类别1，因此我们关注的是敏感度。我们可以看到进一步提高到了56.67%。但如果看整体模型，表现很差。</p><h2 id="5ebd" class="kg kh hi bd kf ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">两者(欠采样和过采样)</h2><p id="ddd4" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">我们将使用与之前相同的函数进行采样，除了我们将使用的方法为<strong class="ih hj"><em class="jd"/></strong>。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lm"><img src="../Images/1926cf4fd2bcc7a3c614753b035ab70d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*JU587YMZ4qTYzJkhaBauVg.png"/></div></figure><p id="8d63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们提供N为285(列车数据中的观察总数)。数据汇总如上。</p><p id="f0dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看模型的性能。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es ln"><img src="../Images/9ab907b0ba0f9d857eba24647638f25f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*zdxvegpVOnR_vn_JNsSL_w.png"/></div></figure><p id="117e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型的灵敏度再次下降到50%。</p><h2 id="6533" class="kg kh hi bd kf ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">摘要</h2><p id="79eb" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">因此，我们已经看到了类不平衡问题如何影响模型的性能，以及我们可以如何处理它的一些方法。我希望这篇文章对你有用。</p></div></div>    
</body>
</html>