<html>
<head>
<title>The world through the eyes of CNN.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CNN眼中的世界。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-world-through-the-eyes-of-cnn-5a52c034dbeb?source=collection_archive---------8-----------------------#2020-06-26">https://medium.com/analytics-vidhya/the-world-through-the-eyes-of-cnn-5a52c034dbeb?source=collection_archive---------8-----------------------#2020-06-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="56f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络是一类广泛应用于计算机视觉及其应用领域的深度学习模型。卷积神经网络在识别物体、识别人群中的面孔方面非常精通&amp;它们甚至构成了自动驾驶汽车的基本组成部分。给定一堆训练图像，CNN可以通过分析图像的特征来学习识别图像中的物体。随着图像从一层向前传播到下一层，CNN学会了拾取更复杂的特征和模式。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es et"><img src="../Images/0515431500725819976b2ac368f73f85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4Z5FWDhJpLL0HXY38EeJA.jpeg"/></div></div></figure><p id="0372" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们训练一个卷积神经网络时，它是否像我们人类一样准确地理解图像？</p><p id="f45b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们将深度学习模型视为一个<strong class="ih hj">黑盒</strong>，我们向模型输入数据/图像&amp;，模型输出其预测，那么回答这个问题就变得困难了。即使预测可能是准确的，如果模型不能像我们人类一样感知图像，它就不是真正的<strong class="ih hj">智能</strong>。毕竟，我们正在尝试在计算机或人工智能上再造人类智能。</p><p id="d015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们理解网络内部的流程，而不是将其解释为黑盒，那么我们人类调试深度学习网络将变得更容易。</p><h1 id="1f0b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">图像怎么看每一层？</h1><p id="f844" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">通过在卷积操作后可视化特定层的滤波器的特征/激活图，我们可以洞察<strong class="ih hj">“网络在卷积神经网络的每个阶段看到了什么”</strong>。让我们考虑一个名为VGG16的CNN模型，它在ImageNet分类上取得了基准结果。使用这个网络将为我们提供关于网络如何可视化图像中的对象的深刻见解。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kr"><img src="../Images/be3c340b2814f1926e05b74af2ce2005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HzxRI1qHXjiVXla-_NiMBA.png"/></div></div></figure><p id="35c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初几层的滤镜<strong class="ih hj">提取方向&amp;颜色</strong>，这些原始(边缘&amp;颜色)特征贴图被组合成<strong class="ih hj">基本网格，纹理&amp;图案</strong>。反过来，这些被组合起来，以提取越来越复杂的特征，这些特征类似于物体的一部分。随着我们沿着网络向下移动，提取的特征变得更加复杂，难以解释。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ks"><img src="../Images/36644c98923e23f0a946cd3e1ae94360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bIY_8FE7dJaGk1kjU7iVSg.png"/></div></div></figure><p id="66d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图显示了网络上不同阶段的功能图。初始(较低)层的特征地图编码<strong class="ih hj">边缘&amp;方向，即水平线或垂直线</strong>，在网络中间获得的特征地图可视化<strong class="ih hj">纹理&amp;图案</strong>，顶层的特征地图描绘图像中&amp;物体的<strong class="ih hj">部分。我们来形象化一下这张特斯拉汽车在VGG16不同阶段的图像。</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kt"><img src="../Images/89c74dc74266779faa79ba748efeb55d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2MUKuzxJYPfcqGzt_C2gcA.jpeg"/></div></div></figure><h2 id="c3b1" class="ku jp hi bd jq kv kw kx ju ky kz la jy iq lb lc kc iu ld le kg iy lf lg kk lh bi translated">低级/原始特征</h2><p id="f79f" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated"><strong class="ih hj">低层特征图</strong>提取图像的边缘&amp;线。这些是原始特征提取器(过滤器)，它们提取图像的微小细节，如直线、曲线&amp;点。</p><p id="f603" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出特征图来自在ImageNet数据集上训练的VGG16网络的初始层。原始特征水平、垂直和45⁰线有助于描绘车身的形状。</p><div class="jd je jf jg fd ab cb"><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/f4788051fbdb50271a9b177ae64f8b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*MUd7L9DBt9YwWLkCv6P8xQ.png"/></figure><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/f43e04d2da39318f48dff91c00df902e.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*egQC7thQHtNZ9P1ZQF-gHQ.png"/></figure><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/c253de3c23273f121e9643d39fc3c5bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*kXEVHjevW3vHRyvOQS3zJQ.png"/></figure></div><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/f797b1c92b1f8e04f7dac9fab73b745b.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*fsLGGHSszu45CYb3AEJPyA.png"/></div></figure><h2 id="3964" class="ku jp hi bd jq kv kw kx ju ky kz la jy iq lb lc kc iu ld le kg iy lf lg kk lh bi translated">中级功能</h2><p id="47ce" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">原始特征图组合产生简单的形状，例如圆形、正方形、椭圆形等。<strong class="ih hj">中间层功能</strong>提供了比第一个更多的信息，例如，过滤器学习检测角落，<strong class="ih hj">复制基本模式，纹理&amp;形状。</strong></p><p id="184c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">中级特征类似于轮胎、车门、保险杠等的圆形。我们可以概括地说，中级特征描绘图像中的纹理、图案。</p><div class="jd je jf jg fd ab cb"><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/3b7f21738282822994495f56fe143fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*sX_dwRP6fiZo2uZ1nldiow.png"/></figure><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/3a2a276b5cf891daf8f79f64c4b78f30.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*MSZ-3xifLAbgPJG29Bl8Sw.png"/></figure><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/d4636afc415fc55642bf0095c70226a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*2lsBl9XedvpkAWbWR39e7g.png"/></figure></div><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/dfdcff18c02e799c61bbccb010a2486b.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*eLMS3rxymoFWQJktLzHtOA.png"/></div></figure><h2 id="b64c" class="ku jp hi bd jq kv kw kx ju ky kz la jy iq lb lc kc iu ld le kg iy lf lg kk lh bi translated">高级功能</h2><p id="0630" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">高级特征描绘了类似于图像中对象部分的复杂模式，这往往是该类别(对象)的独特特征，这也有助于该类别的分类分数。下面的特征地图描绘了狗的脸，眼睛等。</p><div class="jd je jf jg fd ab cb"><figure class="li jh lp lk ll lm ln paragraph-image"><img src="../Images/c5e4ac2e456dbfac6797907180aea8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*CS3hJ-LABI5yFoWfUUUEHQ.png"/></figure><figure class="li jh lq lk ll lm ln paragraph-image"><img src="../Images/f44a92c9a5df49cfb903880aa196dc6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*TZ9FFwUe3HLxMM5W3YqieA.png"/></figure></div><p id="091d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着我们深入，CNN产生了复杂的图案，如眼睛、鼻子等。上面的特征地图描绘了狗的不同部位，鼻子、眼睛、毛发、耷拉的耳朵、尾巴等等。</p><p id="926e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">特斯拉在VGG16更高级别的特征图如下图。这些图像可能很难理解，但通过仔细观察右边的图像，我们会注意到一些细节，如窗户、轮胎等。</p><div class="jd je jf jg fd ab cb"><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/09f995f05abffd15d584502252d77999.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*kdOsiqCOwaglxwTWGRp0tw.png"/></figure><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/e27ead5bad7943c1d9677c5bde82a726.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*gqoO5z4U5dIHt8M4v8RiBg.png"/><figcaption class="ls lt et er es lu lv bd b be z dx lw di lx ly translated">特斯拉汽车在VGG16更高层的特征图。</figcaption></figure></div><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lz"><img src="../Images/77dd2e2a71c123d2ed5919c6d311f914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*AZABFNb1woo-ufXEUgUNIg.jpeg"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">更高级的功能</figcaption></figure><p id="b00d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看看火烈鸟特征图，它从不同的角度表现了火烈鸟，与广告牌表类似。这些是特定类别图像所特有的特征或模式。</p><blockquote class="ma mb mc"><p id="12f6" class="if ig md ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated">因此，在网络的较高层次上的特征地图通过呈现对特定物体保持唯一的特征来帮助区分两个物体。CNN然后可以容易地将输入图像分类到其相应的类别。</p></blockquote><p id="43a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些经过训练的CNN模型的可视化不仅让我们深入了解其操作，这在以前被认为是一个黑盒，而且还有助于诊断网络&amp;调整网络架构以提高其性能。</p><p id="efc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然，看着CNN的visualize不精确地指出是什么使CNN将一幅图像分类到一个特定的类别的幻觉模式。更高层的视觉形成人类无法理解的复杂图案<strong class="ih hj">。如果我们可以可视化特征/激活图在输入图像上看到的确切区域/部分，这可以通过将特征图投影回输入图像来实现，这将突出显示CNN通过该层&amp;及其相应的过滤器(又名热图)看到的图像上的区域。</strong></p><h1 id="0427" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">诊断</strong> g卷积神经网络。</h1><h2 id="4037" class="ku jp hi bd jq kv kw kx ju ky kz la jy iq lb lc kc iu ld le kg iy lf lg kk lh bi translated">为什么CNN的特征图可视化很重要？</h2><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mh"><img src="../Images/fd3618cbe397e07fcf37e3f3c3f56fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2nlxu4sjJ1CajcGth_hBjw.png"/></div></div></figure><p id="a463" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这张来自<a class="ae mi" href="https://www.hackevolve.com/where-cnn-is-looking-grad-cam/" rel="noopener ugc nofollow" target="_blank"> hackevolve </a>的图像中，图像的足球区域被突出显示，这很好地表明网络正在寻找精确的特征来将对象分类为足球。右边的图像是特定滤波器下网络的<strong class="ih hj"> Gradcam </strong>输出。你可以把它想象成一个热点图，重点是感兴趣的区域。突出显示了网络已经学习了在足球上发现的五边形-六边形模式&amp;使用这一特定特征进行分类。</p><p id="3e05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过可视化，我们很容易理解网络在看哪里&amp;有助于推断网络是否在作弊。</p><p id="d593" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">卷积神经网络怎么可能作弊？</strong></p><p id="0616" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想象一下，如果网络正在查看绿草地，以将对象分类为足球，而不是球本身。突出显示的区域是草地，而不是球。</p><p id="8141" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，网络会将足球场上的篮球误归类为足球。意味着网络看起来不够近，或者看不到相关特征。</p><p id="d662" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里还有几个网络作弊的例子。</p><ul class=""><li id="6836" class="mj mk hi ih b ii ij im in iq ml iu mm iy mn jc mo mp mq mr bi translated">如果天空中的飞机图像被显示给网络，将鸟与蓝天相关联的卷积神经网络可以将飞机分类为鸟。反之亦然。</li><li id="a6cb" class="mj mk hi ih b ii ms im mt iq mu iu mv iy mw jc mo mp mq mr bi translated">网络查看植物/树木，同时将图像分类为大象。该网络无法捕捉到大象的鼻子、耳朵、长牙或任何特定特征。</li></ul><h2 id="c1d1" class="ku jp hi bd jq kv kw kx ju ky kz la jy iq lb lc kc iu ld le kg iy lf lg kk lh bi translated">使CNN更加透明的技术。</h2><p id="886d" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">通过可视化输入图像上的感兴趣区域(可视化热图)来清楚地了解CNN在看哪里，通过使其更加透明，为我们提供了对网络工作的更深入理解。<strong class="ih hj">通过分析这些热图，用户可以对网络进行更改、添加或删除少量图层、超参数调整、向数据集添加更多图像或应用不同的数据扩充策略。</strong></p><h2 id="f4c9" class="ku jp hi bd jq kv kw kx ju ky kz la jy iq lb lc kc iu ld le kg iy lf lg kk lh bi translated">类激活图，又名CAM</h2><p id="cc40" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">一种技术，用于可视化CNN在分类时正在查看的图像部分。可视化是一个热图，突出显示了“图像上特定类别的区域”。</p><p id="de78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CAM提出的想法要求CNN有一个可以利用的特定架构。CAM在倒数第二层(倒数第二层)需要一个全局平均池层，即完全连接层之前的间隙层。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mx"><img src="../Images/4123cf9faf4a851ffa6ce71342796537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXfXF2FZosBM-in8ijiGsg.png"/></div></div></figure><p id="b39a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入图像通过CNN层，在每层提取特征。GAP之前的图层将有<strong class="ih hj"> n </strong>个特征地图，这是所有前面图层捕获的所有特征的结果。<strong class="ih hj"> n </strong>可以是网络指定的任何值，这些<strong class="ih hj"> n </strong>特征图中的每一个都是宽度<strong class="ih hj">u</strong>T37】高度<strong class="ih hj"> v. </strong>在上图中，红色、蓝色、绿色特征图表示GAP之前的最终特征图。</p><p id="f9dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是全球平均池？</strong></p><p id="423e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">全局平均池通过对像素值取平均值，将特征图转化为单个数字。如果有<strong class="ih hj"> n </strong>个特征图，GAP产生<strong class="ih hj"> n </strong>个单值张量。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es my"><img src="../Images/66cd488b2de94b54281c7e588b3d1b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*woHRaK6tSHBe4jyENO_JRQ.png"/></div></div></figure><p id="1923" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">全局平均池使网络不受图像的空间平移或扰动的影响。</p><p id="f5ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">全连接层&amp;分类得分。</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mz"><img src="../Images/521fca36766c4046f443c3a2d2168722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*_nZ9ZNYrZCtMc0bksv2X7w.png"/></div></figure><p id="0d36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在GAP之后，网络输出<strong class="ih hj"> n个</strong>单值数字，这些数字被转换成分类分数。“澳大利亚梗”的分类分数为，<br/>y^australian-terrier = w1×n1+w2×N2+…。+ wn x n .(这里n是间隙输出)。</p><p id="9317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如何获取职业激活图？</strong></p><p id="9650" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不是将与澳大利亚梗相关的权重乘以GAP输出，而是将权重乘以GAP之前的特征图。</p><p id="b0b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设，在全局平均汇集之前，我们有宽度<strong class="ih hj">u</strong>T39】高度<strong class="ih hj"> v </strong>的<strong class="ih hj"> n </strong>个特征图f1，f2，f3 … fn。与澳大利亚梗神经元相关的权重是w1、w2、w3 … wn。</p><p id="1220" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">cam^aus = f1 x w1+F2 x w2+F3 x w3+…+fn x wn。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es na"><img src="../Images/c43dc3d3da6d05dd3d8c5ba8d1e881c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nhjffqxHXuw4bP6jRVlx1Q.png"/></div></div></figure><p id="03b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成的特征图宽度为<strong class="ih hj">u</strong>T40】高度为<strong class="ih hj"> v </strong>(与f1，f2，…，fn相同)<strong class="ih hj">。</strong>类别激活图尺寸与特征图尺寸相同(A1，A2，A3 … An。)</p><p id="ab6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类激活图被上采样以匹配输入图像尺寸&amp;覆盖在顶部以查看结果。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nb"><img src="../Images/3a98c06ac3ebdf87723e881fed094a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*l0gaYvWjSSbxzEJxiCZAMw.png"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nc"><img src="../Images/f477c70310dde0ad29877f9bd79bccf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*jDOg0QB0f4ewLQljicNzJA.png"/></div></figure><p id="045b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出类激活图是所有特征图的总和。在上面，我们有n张特征图，每一张看着狗的不同部分或图案，一张特征图集中在它的腿上，而另一张集中在它的皮毛上，而另一张集中在它的脸上。热图区域包含了所有单独的功能图。</p><p id="7b62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是另一个网络收集宫殿不同特征的例子，比如它标志性的圆顶，文艺复兴风格的建筑等等。网络预测城堡类的概率很高，不忽略教堂、祭坛或修道院，因为它们看起来都一样。</p><p id="24af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">类激活图的限制。</strong></p><ul class=""><li id="5378" class="mj mk hi ih b ii ij im in iq ml iu mm iy mn jc mo mp mq mr bi translated">卷积神经网络需要修改，它没有全局平均池层。</li><li id="e3f1" class="mj mk hi ih b ii ms im mt iq mu iu mv iy mw jc mo mp mq mr bi translated">添加间隙层需要重新训练网络。</li><li id="7dc0" class="mj mk hi ih b ii ms im mt iq mu iu mv iy mw jc mo mp mq mr bi translated">可以获得关于最后一个CNN层的可视化或热图。</li></ul><h2 id="dde7" class="ku jp hi bd jq kv kw kx ju ky kz la jy iq lb lc kc iu ld le kg iy lf lg kk lh bi translated">GradCAM:基于梯度的类激活图</h2><p id="432b" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">为了解决类激活图面临的局限性，引入了基于梯度的类激活图。GradCAM并不直接将预测图层的权重与特征图相关联，而是根据卷积图层的特征图计算输出得分的梯度。</p><blockquote class="ma mb mc"><p id="00d7" class="if ig md ih b ii ij ik il im in io ip me ir is it mf iv iw ix mg iz ja jb jc hb bi translated">通过计算分类分数相对于各个特征图的梯度(导数),我们获得了一个值，该值指示特征图对分类分数有多大贡献。即分类分数随特征图的变化而变化的速率。</p></blockquote><p id="5939" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，我们用狗的一个特征图来计算狗的分类分数，该特征图可视化了狗的松软耳朵。如果松软的耳朵在特征图中比以前更突出，分类分数将增加，如果它们不太突出，分类分数可能降低。通过计算梯度，我们获得了特征图对分类的贡献度量。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nd"><img src="../Images/5735f571248230447a0bfe1c71a94b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*msc4pPUnYQwrjVDFg7CqDg.png"/></div></figure><p id="e59a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，y^c是c类的输出分类分数(在softmax之前)，A^k是卷积层I的第k个特征图，是来自层I的滤波器j的输出。输出可以被称为梯度特征图。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ne"><img src="../Images/d80504177c45f2c6b176634ee56460a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*BGG5ye0g8AZlcPWFBVcq_Q.png"/></div></figure><p id="1f82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在计算k个梯度特征图之后，我们在k个梯度特征图的每一个上执行全局平均汇集。</p><p id="7802" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为结果输出的全局平均汇集梯度特征图(α-k)，我们执行卷积层的αk和特征图的加权线性组合。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nf"><img src="../Images/48d85834dc6f2b68bd068cabb2abfa86.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*mrTijPhXZuPpeWJvOGqEIA.png"/></div></figure><p id="ded1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">每个特征图乘以它自己的全局平均混合梯度特征图</strong>(α-k与特征图A^k).这种加权线性组合产生与特征图A^k.大小相同的粗略热图。我们将ReLU应用于粗略热图，因为我们只对对其预测有积极影响的图像特征感兴趣。</p><div class="jd je jf jg fd ab cb"><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/fb9860864b101d9926546a826e1359e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*bhjzw7pEogHYmjogr7jmbQ.png"/></figure><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/fa062fa1b6f34e2699d51f631c817d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*SQahwqn0v2K5cM0aLnTwsg.png"/></figure></div><p id="dc13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">grad CAM如何克服CAM的局限性？</strong></p><ol class=""><li id="8f5a" class="mj mk hi ih b ii ij im in iq ml iu mm iy mn jc ng mp mq mr bi translated">可以计算关于任何卷积层的特征映射的输出分类分数的梯度，这与CAM不同，在CAM中只能使用最后一层的特征映射。</li><li id="3c2f" class="mj mk hi ih b ii ms im mt iq mu iu mv iy mw jc ng mp mq mr bi translated">该网络不需要任何修改，无需网络中的全局平均层即可计算GradCAM。(注意，我们对不属于网络一部分的梯度执行间隙操作)。</li></ol><p id="8c0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是在ImageNet数据集上训练的VGG16网络不同部分的GradCAM输出。</p><div class="jd je jf jg fd ab cb"><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/10a9043ea44176b61070f7c108dcb42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*R5oGPbKr-EbxYIcQD0bF0g.png"/></figure><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/84b58b435c864c198f558c8a244ce031.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*hlllOdFOJ7ikw7MwXS_YHA.png"/></figure><figure class="li jh lj lk ll lm ln paragraph-image"><img src="../Images/8589fcb0fa92880d6d72613c680b667b.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*uBrvjkgNRlSzHwOVwtMV0g.png"/><figcaption class="ls lt et er es lu lv bd b be z dx nh di ni ly translated">block5_conv3、block5_conv2、block4_conv3</figcaption></figure></div><div class="ab cb"><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/228241242d38ab597afa7a01d5c6583d.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*Ff067JNbXmg7xap_MsZKXw.png"/></figure><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/d1e97bd0b3a5143fa95ea418cc7e4671.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*ZP7RhOHazsajg7-cm9rdNg.png"/></figure></div><div class="ab cb"><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/14525be774ea03305bb1576b70ec0697.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*QAsFZptsC78oepQ6qUZmSA.png"/></figure><figure class="li jh lr lk ll lm ln paragraph-image"><img src="../Images/2904d4efe750819ecf5c0c0250c9c302.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*czxz4hiqZ_m5rrcB80rJ0w.png"/></figure></div><h1 id="8110" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结论</h1><p id="b4fa" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">概念的实现可以在这个<a class="ae mi" href="https://github.com/shivvignesh/VGG-Feature-maps-GradCAM/blob/master/CNN_Visualization.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本中找到。</a></p></div></div>    
</body>
</html>