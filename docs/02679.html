<html>
<head>
<title>Matrix Factorization for Word Vectors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">词向量的矩阵分解</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/matrix-factorization-for-word-vectors-61824ee9a751?source=collection_archive---------13-----------------------#2019-12-28">https://medium.com/analytics-vidhya/matrix-factorization-for-word-vectors-61824ee9a751?source=collection_archive---------13-----------------------#2019-12-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4d867c534bf9036a8c39f042ab225d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3qx8a1td5hxTg5o9GNAyvg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源— <a class="ae iu" href="http://whytewolf.ca/wp-content/uploads/2016/05/vlcsnap-2011-01-17-16h21m27s224-1024x422.png" rel="noopener ugc nofollow" target="_blank"> 42 </a>，<a class="ae iu" href="https://techcrunch.com/2019/03/18/how-to-build-the-matrix/" rel="noopener ugc nofollow" target="_blank">矩阵</a></figcaption></figure><p id="d738" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文旨在简要介绍如何使用矩阵分解技术为给定文档创建单词向量。这是使用截断奇异值分解(SVD)技术实现的。</p><p id="6386" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SVD的基本公式如图1所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/66f4190856cb5b6ea89c9a4bddb957a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*pgvW8E-DAigxdwI_6sDHcQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1</figcaption></figure><p id="54cb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如图1所示，SVD有三个主要组件，它们是:</p><ol class=""><li id="a059" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated">共生矩阵</li><li id="fef9" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">左右奇异矩阵</li><li id="232b" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">退化阵</li></ol><h2 id="d9c2" class="km kn hi bd ko kp kq kr ks kt ku kv kw jg kx ky kz jk la lb lc jo ld le lf lg bi translated">共生矩阵</h2><p id="1dce" class="pw-post-body-paragraph iv iw hi ix b iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo ll jq jr js hb bi translated">对于给定的文档，必须创建共生矩阵。下面的<a class="ae iu" rel="noopener" href="/@suhaskvaithal/co-occurrence-matrix-9cacc5dd396e?source=friends_link&amp;sk=f65304f5f5f265c1e00ea1cb666eabe8">链接</a>提供了关于如何创建共现矩阵的更多信息。这个矩阵的创建将使我们能够在文档上使用SVD技术。</p><h2 id="1074" class="km kn hi bd ko kp kq kr ks kt ku kv kw jg kx ky kz jk la lb lc jo ld le lf lg bi translated">左右奇异矩阵</h2><p id="8613" class="pw-post-body-paragraph iv iw hi ix b iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo ll jq jr js hb bi translated">左奇异矩阵(U)的每一行表示焦点单词，右奇异矩阵(V)的每一行表示维度n的同现矩阵的上下文单词。这如图2所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/75934a73d401a83ad4a1f912a78b0959.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*lXinxODatV2q1VwyD9GBuw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图2</figcaption></figure><h2 id="5853" class="km kn hi bd ko kp kq kr ks kt ku kv kw jg kx ky kz jk la lb lc jo ld le lf lg bi translated">退化阵</h2><p id="ccb7" class="pw-post-body-paragraph iv iw hi ix b iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo ll jq jr js hb bi translated">奇异矩阵(≘)是一个对角矩阵，包含奇异值，如图3所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/fa349115a52c4fd7fd66f496f54fb5fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*NLXtJ-azfhDXcgOJ4koo9w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3</figcaption></figure><p id="47bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如图4所示，共生矩阵x的每个奇异值(Sᵢ)与同一共生矩阵x的特征值有关系。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/347bc8317a9e38518c0f133023ff4664.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*3r9StRZ6p8HED0KULZDo9A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4</figcaption></figure><p id="f364" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">矩阵∑的奇异值之间的关系以及具有∑奇异值的左右奇异向量之间的关系如图5所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/a1572d9d5ffa795e465bf1473c2bba61.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*qifaOopFcqmScbGjQ2ewbw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/cca3802298f85dc959b6eeb73e4090e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*u6BhMCm4W3us_3Qy-_ZUjQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图6</figcaption></figure><p id="aeea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，丢失具有较少解释方差的值不会显著影响共生矩阵的表示。因此，我们可以承受丢失一些奇异值及其相应的奇异向量。</p><p id="8922" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了决定在不损害共生矩阵的情况下丢失多少奇异值和向量，我们需要进行超参数调整。这是通过定义K值来实现的，K值告诉我们要保留的奇异值和奇异向量的数量，如图7所示。</p><div class="ju jv jw jx fd ab cb"><figure class="lr ij ls lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/0958013ebcf6810f4e593a8e00c332b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*XXepV4nzEaXVU2WzAUgs4g.png"/></div></figure><figure class="lr ij lx lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/9ad99724f846c864178a8722767130bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*JK66gYjjTc_OH4OBc6QzXQ.png"/></div></figure><figure class="lr ij ly lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/297d93bc03ead4b547874acf1825b27f.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*utlZwJs06pYzpqFM1LBiAQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx lz di ma mb translated">图7</figcaption></figure></div><p id="2be1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的代码展示了python中超参数调优。</p><pre class="ju jv jw jx fd mc md me mf aw mg bi"><span id="e7cc" class="km kn hi md b fi mh mi l mj mk">K = [2, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]</span><span id="8de4" class="km kn hi md b fi ml mi l mj mk">var_explnd = []</span><span id="44ec" class="km kn hi md b fi ml mi l mj mk"># Get the explained_variance for each dimension in'K'<br/>for comps in K:<br/>    model_svd = TruncatedSVD(n_components=comps)<br/>    model_svd.fit_transform(co_mat) # co_mat -&gt; co-occurrence matrix<br/>    var_explnd.append(model_svd.explained_variance_ratio_)</span></pre><p id="9671" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，对于K的每个值，解释的方差被计算并存储在一个数组中。在计算每个K值的解释方差时，绘制K对解释方差的图。图中的“拐点”或“肘点”决定了k的最佳值</p><p id="0c70" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种从SVD分量中去除不太重要的特征的过程称为截断SVD。左和右奇异矩阵的维数以及去除不太重要的特征后的奇异矩阵将如图8和图9所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/4e7eb598cabd3506188c90f144e50765.png" data-original-src="https://miro.medium.com/v2/resize:fit:212/format:webp/1*zOtQPyW8cp0S9Ejf-3ZldA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图8</figcaption></figure><div class="ju jv jw jx fd ab cb"><figure class="lr ij mn lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/0425c3e16f0413e8b7332928c70974a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*S0mrHU1zukP1qJ-fgHvv4Q.png"/></div></figure><figure class="lr ij mo lt lu lv lw paragraph-image"><img src="../Images/1d1f52ff5c223d677f8b6d83765e65d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*Eeo6lMHzSRYNpNXSR56j7A.png"/><figcaption class="iq ir et er es is it bd b be z dx mp di mq mb translated">图9</figcaption></figure></div><p id="78e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在所得的左奇异矩阵(u’)中，每一行代表在同现矩阵中的焦点词(wᵢ)的k维向量表示。在所得的右奇异矩阵(v’)中，每行代表同现矩阵中相应焦点词(wᵢ)的上下文词的k维向量表示。这样，可以使用矩阵分解获得单词的矢量表示。</p><h1 id="712c" class="mr kn hi bd ko ms mt mu ks mv mw mx kw my mz na kz nb nc nd lc ne nf ng lf nh bi translated">参考</h1><ol class=""><li id="3ec1" class="jy jz hi ix b iy lh jc li jg ni jk nj jo nk js kd ke kf kg bi translated"><a class="ae iu" href="https://github.com/suhaskv/Amazon_Food_Reviews/blob/master/Truncated_SVD/Amazon%20Fine%20Food%20Reviews%20Analysis%20Truncated%20SVD.ipynb" rel="noopener ugc nofollow" target="_blank">在亚马逊美食评论数据集上实现截断奇异值分解</a></li><li id="431e" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><a class="ae iu" href="https://www.analyticsvidhya.com/blog/2017/06/word-embeddings-count-word2veec/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2017/06/word-embeddings-count-word 2 veec/</a></li></ol></div></div>    
</body>
</html>