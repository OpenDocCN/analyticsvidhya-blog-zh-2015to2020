<html>
<head>
<title>Conditionally formatted plots using base R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用基数R的条件格式图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/conditionally-formatted-plots-using-base-r-5ca3632e374a?source=collection_archive---------18-----------------------#2020-02-24">https://medium.com/analytics-vidhya/conditionally-formatted-plots-using-base-r-5ca3632e374a?source=collection_archive---------18-----------------------#2020-02-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9fe5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">R中有许多优秀的软件包可以用来制作漂亮的视觉效果。仅使用base R，我就可以在研究天气数据时快速制作一些图表。我觉得这些技巧可能会引起其他读者的兴趣，因为生成这些图形的代码很短，容易理解，因此也容易记忆。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/4ea408247f6bf04b9fd332094de21e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-JTFK8zEof1voVYkVrnFQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">德克萨斯州达拉斯每年达到的最高温度(1914年至2018年)。颜色表示总体排名。</figcaption></figure><p id="fdd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我正在探索德克萨斯州达拉斯的极端天气。<a class="ae jt" href="https://www.currentresults.com/Yearly-Weather/USA/TX/Dallas/extreme-annual-dallas-high-temperature.php" rel="noopener ugc nofollow" target="_blank">在这个页面</a>，你会发现从1914年到2018年，每年记录的最高温度。在制作了数据的初始图表后，我想看看哪一年的记录最高。它没有跳出一个标准的情节，所以我添加了有条件的颜色渐变。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/60a3417acbd5a843d5b289162d0a3091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*BFWmLSxT51Tc8cW7FEG_GQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">感谢Artursfoto:【https://pixabay.com/images/id-1744949/ T2】</figcaption></figure><p id="e523" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不相信这样做仅仅是“漂亮”。几十万年来，人类一直在关注颜色和纹理的细微差异。制作有冲击力的视觉效果就是要挖掘这些本能，减少观众的认知负荷，并确保传达的信息准确地代表潜在的统计数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jv"><img src="../Images/25fb9c8138b0f33bf88494c6677c2dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SpYILt09RkymH4zeudJ-4w.png"/></div></div></figure><p id="21af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">制作上面两张彩色图表非常容易。</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="9f0b" class="kb kc hi jx b fi kd ke l kf kg">barplot(diff(YourData), <br/>col = ifelse(diff(YourData) &gt; 0 ,"Green","Red"))</span></pre><p id="fad2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您希望生成类似于股票分析师所看到的东西，只需将diff(YourData)表达式包装在abs()中，以便负值被绘制为正值</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="156b" class="kb kc hi jx b fi kd ke l kf kg">barplot(abs(diff(YourData)), <br/>col = ifelse(diff(YourData) &gt; 0 ,"Green","Red"))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/e1a405acc6c1f0b09f6001d65eeea4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aFnYuZEQKtRZstgOs6lCcA.png"/></div></div></figure><p id="19a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了获得颜色渐变，我决定利用可用的rgb函数。这允许对r中的颜色进行精细控制。rgb的参数基于范围从0到1的红色、绿色和蓝色值，以及控制透明度的alpha值。这些数据是天气温度的数据，范围从98度到112度。为了使这些值在0到1的范围内，首先使用rank，然后因为有102条记录，所以通过除以最大等级来缩小它们。</p><p id="56c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最高温度记录在一列名为weather$HotF的数据中(我还查看了寒冷、下雨和下雪。温度以华氏温度测量)。</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="adbc" class="kb kc hi jx b fi kd ke l kf kg">weather$HotFScaledRank&lt;-rank(weather$HotF)/max(rank(weather$HotF))</span><span id="fbda" class="kb kc hi jx b fi ki ke l kf kg">barplot(weather$HotF, <br/>ylim = c(95,115), <br/>xpd=FALSE, <br/>names.arg = weather$HotYear,<br/>col=rgb(<br/>red = weather$HotFScaledRank, <br/>green = 0, <br/>blue = (1-(weather$HotFScaledRank)<br/>)))</span></pre><p id="d225" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着红色值下降，蓝色值上升。如果你忽略了这个表达，不要担心。下面是一个简化的例子，其中blue = 1。你仍然得到同样的效果！</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="ddaf" class="kb kc hi jx b fi kd ke l kf kg">barplot(weather$HotF, ylim = c(95,115), xpd=FALSE, names.arg = weather$HotYear,<br/>        col=rgb(red = weather$HotFScaledRank, green = 0, blue = 1))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kj"><img src="../Images/86aaac4f85ac03111f9259eaaeb1b67d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iIbWmZL6M3uw_P2U8rawXw.png"/></div></div></figure><p id="806a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者你可以只修改α。以下是透明度由缩放等级值修改的红色条的示例:</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="2183" class="kb kc hi jx b fi kd ke l kf kg">barplot(weather$HotF, ylim = c(95,115), xpd=FALSE, names.arg = weather$HotYear,<br/>col=rgb(red = 1, green = 0, blue = 0,<br/>alpha = weather$HotFScaledRank))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kj"><img src="../Images/d27552281e6e092aff50c2a245ae2f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7HS5ve2ILjtM_r455Lw_Q.png"/></div></div></figure><p id="0fa8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">…或者对点状图使用相同的配色方案:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/d41ef0c5cf951942e72d13c07a1d9d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1VXyEq7iCjR-ItVc3aLu4A.png"/></div></div></figure><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="1fa8" class="kb kc hi jx b fi kd ke l kf kg">plot(x=weather$HotYear, y=weather$HotF, pch=16,<br/>col=rgb(red = 1, green = 0, blue = 0, <br/>alpha = weather$HotFScaledRank))</span></pre><p id="868b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有很多其他的选择可以探索。如果您有任何问题或想分享一个数据即想法，请随时与我联系。</p></div></div>    
</body>
</html>