<html>
<head>
<title>Is Pipeline important in Machine learning? (Pipeline with pdpipe)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">流水线在机器学习中重要吗？(带pdpipe的管道)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/is-pipeline-important-in-machine-learning-pipeline-with-pdpipe-b6fc9acf20c4?source=collection_archive---------8-----------------------#2019-12-01">https://medium.com/analytics-vidhya/is-pipeline-important-in-machine-learning-pipeline-with-pdpipe-b6fc9acf20c4?source=collection_archive---------8-----------------------#2019-12-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7d79bab6cabc789c5c9c52c2253856b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b88bmhoGkAWLi4n4kvdMlA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">流水线向量</figcaption></figure><p id="3eeb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">流水线概念在许多领域中被推广。这个概念对于数据科学非常重要。机器学习模型有许多动态部分。将ML过程的这些动态部分结合在一起的过程被称为管道。然后我们才能成功地执行并产生结果。在机器学习中，创建管道是为了允许数据从其原始格式流向一些有用的信息。此外，它还提供了一种机制来建立一个并行管道，以比较几种机器学习方法的结果。</p><p id="a808" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在数据科学中，数据在进入学习模型之前必须经过清理、验证和调整。为此，我们使用了许多预处理阶段。作为初学者，我们在预处理阶段使用单步函数。但是更有效的方法是使用管道。然后，我们可以通过自动化这些预处理阶段来减少时间和错误。</p><p id="62fa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这篇文章中，我们讨论关于P<strong class="iw hj">I与熊猫</strong><a class="ae js" href="https://pypi.org/project/pdpipe/" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">P管道</strong> </a>的关系。对于Pandas Df的管道问题，pdpipe是一个更好的解决方案。</p><h2 id="8ffb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">安装pdpipe</h2><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="1e4e" class="jt ju hi kt b fi kx ky l kz la">pip install pdpipe</span></pre><h2 id="d410" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">导入pdpipe</h2><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="2b5c" class="jt ju hi kt b fi kx ky l kz la">import pdpipe as pdp</span></pre><p id="0f08" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们使用著名的<a class="ae js" href="https://www.kaggle.com/hesh97/titanicdataset-traincsv" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">泰坦尼克号数据集</strong> </a>作为例子。在此，我们预测哪些乘客在泰坦尼克号沉船中幸存。它看起来像跟随</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/e4adaa1ade6a5cd2296d3d1942ed5508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FNiKhKdu3GrwHaRdjKKmpw.png"/></div></div></figure><h2 id="c32f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">一条操作流水线</h2><p id="d3f0" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated">让我们想想领域专家说的，</p><blockquote class="lh"><p id="5672" class="li lj hi bd lk ll lm ln lo lp lq jr dx translated">我们可以忽略模型的名称特性。</p></blockquote><p id="5f0f" class="pw-post-body-paragraph iu iv hi iw b ix lr iz ja jb ls jd je jf lt jh ji jj lu jl jm jn lv jp jq jr hb bi translated">然后，我们只需从数据集中删除Name列。</p><p id="cf38" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为此，我们只需创建一个名为pipeline的管道对象，并将DF传递给这个管道</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="6bef" class="jt ju hi kt b fi kx ky l kz la">pipeline = pdp.ColDrop('Name')<br/>df= pipeline(df)</span></pre><p id="7c2f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">生成的DF如下所示:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/3e93c019743f5e8bd928ad55b24d6eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*ESEPY9q5S1xN1PFYbdj0Sg.png"/></div></figure><h2 id="a0a1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">管道的链级</h2><p id="eaff" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated">实际上，我们将管道用于多阶段流程。在pdpipe中有很多方法可以做到这一点。最简单的方法是使用+运算符。</p><blockquote class="lx ly lz"><p id="d639" class="iu iv ma iw b ix iy iz ja jb jc jd je mb jg jh ji mc jk jl jm md jo jp jq jr hb bi translated">让我们考虑一下，我们想要删除Name列，并对这个分类模型的Pclass(乘客类)特性进行一次性编码。</p></blockquote><p id="9220" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，我们用ColDrop方法创建一个管道对象来删除这个名称。然后我们只需用+=操作符将one-hot-encode方法添加到这个对象中。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="7669" class="jt ju hi kt b fi kx ky l kz la">pipeline =  pdp.ColDrop('Name')<br/>pipeline += pdp.OneHotEncode('Pclass’')</span><span id="8966" class="jt ju hi kt b fi me ky l kz la">df=pipeline(df)</span></pre><p id="75ad" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">生成的DF如下所示:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/a7fd420a0d3e34f6a3737c0f7572a548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZ0j2JRMdRdk0Vz2664A5w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Pclass_2和PClass_3由一次热编码创建</figcaption></figure><p id="e84a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">也可以通过提供管道阶段列表来创建管道:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9a08" class="jt ju hi kt b fi kx ky l kz la">pipeline=pdp.PdPipeline([pdp.ColDrop('Name'),    pdp.OneHotEncode('Pclass')])</span></pre><p id="94d3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">此外，make_pdpipeline方法可用于给出阶段作为位置参数</strong>。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="a225" class="jt ju hi kt b fi kx ky l kz la">pipeline = pdp.make_pdpipeline(pdp.ColDrop('Name'),    pdp.OneHotEncode('Pclass'))</span></pre><p id="8800" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">管道阶段也可以链接到其他阶段以创建管道:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="d9b2" class="jt ju hi kt b fi kx ky l kz la">pipeline = pdp.ColDrop('Name').OneHotEncode('Pclass')</span></pre><h2 id="0818" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">管道阶段的类型</h2><ul class=""><li id="7eb6" class="mg mh hi iw b ix lc jb ld jf mi jj mj jn mk jr ml mm mn mo bi translated">基本阶段</li><li id="8724" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">列生成</li><li id="a3bc" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">sci kit-学习依赖阶段</li><li id="2194" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">ntlk相关级</li></ul><h1 id="c179" class="mu ju hi bd jv mv mw mx jz my mz na kd nb nc nd kg ne nf ng kj nh ni nj km nk bi translated">构建完整的预处理管道</h1><blockquote class="lh"><p id="37aa" class="li lj hi bd lk ll lm ln lo lp lq jr dx translated">让我们想想，我们想为我们的泰坦尼克号数据集建立一个完整的预处理管道。</p></blockquote><p id="b347" class="pw-post-body-paragraph iu iv hi iw b ix lr iz ja jb ls jd je jf lt jh ji jj lu jl jm jn lv jp jq jr hb bi translated">它看起来就像这样，</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nl"><img src="../Images/177a14b1336fc996a43d46f381ff93d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*myPCsuWUFWjFHye9EeCimg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">5级管道</figcaption></figure><p id="36d4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在此管道中，我们将创建以下5个阶段:</p><ul class=""><li id="0f01" class="mg mh hi iw b ix iy jb jc jf nm jj nn jn no jr ml mm mn mo bi translated">删除NAs</li><li id="d5b6" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">对年龄特征进行分类</li><li id="36f3" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">一次热编码PClass特征</li><li id="8c20" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">放下孩子</li><li id="728f" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">绘制着手价值观</li></ul><p id="809f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们将NAs放在这个数据集中。为此，我们创建一个管道对象并调用DropNa函数</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="a839" class="jt ju hi kt b fi kx ky l kz la">pipeline = pdp.DropNa()</span></pre><p id="5750" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后我们用ApplyByCols对年龄特征进行分类。为此，我们定义了年龄类别函数。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="dfc9" class="jt ju hi kt b fi kx ky l kz la">def age_category(age):<br/> if age&lt; 15:<br/> return “child”<br/> elif age&lt; 25:<br/> return “teen”<br/> elif age&lt; 35:<br/> return “young-age-adult”<br/> elif age&lt; 50:<br/> return “middle-age-adult”<br/> else:<br/> return “older-age-adult”</span></pre><p id="0071" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后我们通过ApplyByCols将这个函数应用到Age列，并创建一个新的Age_Category特性。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="3c17" class="jt ju hi kt b fi kx ky l kz la">pipeline += pdp.ApplyByCols('Age',<br/>age_category,'Age_Category',drop=False)</span></pre><p id="8e7f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">之后，我们对PClass特征进行一次热编码</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="d58e" class="jt ju hi kt b fi kx ky l kz la">pipeline += pdp.OneHotEncode('Pclass')</span></pre><blockquote class="lx ly lz"><p id="63e9" class="iu iv ma iw b ix iy iz ja jb jc jd je mb jg jh ji mc jk jl jm md jo jp jq jr hb bi translated">让我们想想，领域专家说子类别对于我们的分类模型并不重要。</p></blockquote><p id="0f0e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为此，我们从Age_Category列中删除子值</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="6c26" class="jt ju hi kt b fi kx ky l kz la">pipeline += pdp.ValDrop(['child'],'Age_Category')</span></pre><p id="49e0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后我们将船载价值映射如下:</p><ul class=""><li id="cf80" class="mg mh hi iw b ix iy jb jc jf nm jj nn jn no jr ml mm mn mo bi translated">S-&gt;真</li><li id="558b" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">C-&gt;假</li><li id="d4b6" class="mg mh hi iw b ix mp jb mq jf mr jj ms jn mt jr ml mm mn mo bi translated">问-&gt;真</li></ul><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="2398" class="jt ju hi kt b fi kx ky l kz la">pipeline += pdp.MapColVals(‘Embarked’,{‘S’:True,’C’:False,’Q’:True})</span></pre><p id="5b2c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，我们创建管道的五个阶段。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="61f7" class="jt ju hi kt b fi kx ky l kz la">pipeline = pdp.DropNa()<br/>pipeline += pdp.ApplyByCols('Age',age_category,'Age_Category',drop=False)<br/>pipeline += pdp.OneHotEncode('Pclass')<br/>pipeline += pdp.ValDrop(['child'],'Age_Category')<br/>pipeline += pdp.MapColVals('Embarked',{'S':True,'C':False,'Q':True})</span></pre><h2 id="2329" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">打印管道</h2><p id="dda0" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated">我们可以通过打印管道来查看我们的管道。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="f9d9" class="jt ju hi kt b fi kx ky l kz la">print(pipeline)</span><span id="4d68" class="jt ju hi kt b fi me ky l kz la">A pdpipe pipeline:<br/>[ 0]  Drops null values.<br/>[ 1]  Applying a function  to column Age.<br/>[ 2]  One-hot encode Pclass<br/>[ 3]  Drop values child in column Age_Category<br/>[ 4]  Map values of column Embarked with {'S': True, 'C': False, 'Q': True}.</span></pre><blockquote class="lx ly lz"><p id="3a53" class="iu iv ma iw b ix iy iz ja jb jc jd je mb jg jh ji mc jk jl jm md jo jp jq jr hb bi translated">可以使用Python的切片符号对管道进行切片，就像列表一样:</p></blockquote><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="93ac" class="jt ju hi kt b fi kx ky l kz la">pipeline[3]</span><span id="30c8" class="jt ju hi kt b fi me ky l kz la">PdPipelineStage: Drop values child in column Age_Category</span></pre><p id="7566" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，我们将管道应用到我们的泰坦尼克号数据集。生成的DF如下所示:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es np"><img src="../Images/8a6c165a4e6f9b5c6067902ac70a3881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yr_qxGGs0P52WIcCinhZZg.png"/></div></div></figure><p id="b8a1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用pdpipe，您可以为您的ML项目构建强大的管道。更多资源可以参考作者的<a class="ae js" href="https://github.com/shaypal5/pdpipe" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">回购</strong> </a>(创建附加阶段很酷)。</p><p id="d904" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在<a class="ae js" href="https://www.linkedin.com/in/shashimal97/" rel="noopener ugc nofollow" target="_blank">上加我<strong class="iw hj">LinkedIn</strong>T7】</a></p></div></div>    
</body>
</html>