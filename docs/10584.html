<html>
<head>
<title>Python Tip #6 — Pandas Merge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python技巧6——熊猫合并</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-tip-6-pandas-merge-dev-skrol-bf0be41f29b7?source=collection_archive---------10-----------------------#2020-10-25">https://medium.com/analytics-vidhya/python-tip-6-pandas-merge-dev-skrol-bf0be41f29b7?source=collection_archive---------10-----------------------#2020-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e348" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pandas concat &amp; append的工作方式类似于按列或行的数组连接。</p><p id="c0d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是Merge &amp; Join的工作方式类似于数据库表连接。让我们在本文中看到合并，并在下一篇文章中了解加入！</p><p id="46b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，当我们需要连接两个具有不同列的数据框，并且两个数据框中都有一个关键列时，可以使用Merge。</p><p id="3447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，如果我们有两个数据框，一个包含商店详细信息，另一个包含所有商店的产品详细信息，我们可以使用商店Id合并数据框。</p><p id="f318" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">签名:</strong> <br/> pd.merge(left，<br/> right，<br/> how: str = 'inner '，<br/> on=None，<br/> left_on=None，<br/> right_on=None，<br/> left_index: bool = False，<br/> right_index: bool = False，<br/> sort: bool = False，<br/> suffixes=('_x '，' _y ')，<br/> copy: bool = True，<br/></p><ul class=""><li id="bb98" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">左右参数是数据。</li><li id="dda7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">how -&gt;提到合并应该如何发生。它接受值'左'，'右'，'内'，'外'。默认值为“内部”。</li><li id="8e98" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">left '--&gt;收集左侧数据帧的所有数据以及左右两侧的公共数据。</li><li id="6522" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">“右侧”-&gt;收集右侧数据帧的所有数据以及左侧和右侧的公共数据。</li><li id="695b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">' inner '--&gt;仅从左侧和右侧数据帧收集公共数据。这更像一个十字路口。</li><li id="dbcb" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">' outer' -&gt;从左右两边收集所有的，包括common。</li><li id="356b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">on -&gt;提到哪个列应该作为同时存在于左右数据帧中的键列。</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/4b7dffb6ba47e2a7eed33e3261ef35eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZGDgg-0SznYlwiij.png"/></div></div></figure><pre class="js jt ju jv fd kd ke kf kg aw kh bi"><span id="421e" class="ki kj hi ke b fi kk kl l km kn">import pandas as pd shop = { 'Shop_id' : ['SP01', 'SP02', 'SP03', 'SP04'], 'City' : ['Chennai', 'Madurai', 'Trichy', 'Coimbatore'], 'ZipCode' : [600001, 625001, 620001, 641001] } shop = pd.DataFrame(shop) shop</span><span id="3da3" class="ki kj hi ke b fi ko kl l km kn">product = { 'Shop_id' : ['SP01', 'SP02', 'SP02', 'SP03', 'SP03', 'SP03', 'SP05'], 'product_id' : ['p01', 'p02', 'p03', 'p01', 'p02', 'p03', 'p02'], 'price' : [220, 500, 145, 225, 510, 150, 505] } product = pd.DataFrame(product) product</span></pre><h2 id="ad17" class="ki kj hi bd kp kq kr ks kt ku kv kw kx iq ky kz la iu lb lc ld iy le lf lg lh bi translated">left '--&gt;收集左侧数据帧的所有数据以及左右两侧的公共数据。</h2><pre class="js jt ju jv fd kd ke kf kg aw kh bi"><span id="d5f5" class="ki kj hi ke b fi kk kl l km kn">pd.merge(shop, product, how = 'left', on = 'Shop_id')</span></pre><h2 id="b4c7" class="ki kj hi bd kp kq kr ks kt ku kv kw kx iq ky kz la iu lb lc ld iy le lf lg lh bi translated">“右侧”-&gt;收集右侧数据帧的所有数据以及左侧和右侧的公共数据。</h2><pre class="js jt ju jv fd kd ke kf kg aw kh bi"><span id="1bf0" class="ki kj hi ke b fi kk kl l km kn">pd.merge(shop, product, how = 'right', on = 'Shop_id')</span></pre><h2 id="703a" class="ki kj hi bd kp kq kr ks kt ku kv kw kx iq ky kz la iu lb lc ld iy le lf lg lh bi translated">' inner '--&gt;仅从左侧和右侧数据帧收集公共数据。这更像一个十字路口。</h2><pre class="js jt ju jv fd kd ke kf kg aw kh bi"><span id="afd3" class="ki kj hi ke b fi kk kl l km kn">pd.merge(shop, product, how = 'inner', on = 'Shop_id')</span></pre><h2 id="9dbe" class="ki kj hi bd kp kq kr ks kt ku kv kw kx iq ky kz la iu lb lc ld iy le lf lg lh bi translated">' outer' -&gt;从左右两边收集所有的，包括common。</h2><pre class="js jt ju jv fd kd ke kf kg aw kh bi"><span id="59c1" class="ki kj hi ke b fi kk kl l km kn">pd.merge(shop, product, how = 'outer', on = 'Shop_id')</span></pre><p id="e359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想试试这个吗？尽情享受吧！</p><p id="b0a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将看到Python中的一个新技巧。谢谢大家！👍</p><p id="1d1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">喜欢支持？只需点击心形图标❤️.</p><p id="aa8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编程快乐！🎈。</p></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><p id="0dd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lp">原载于2020年10月25日</em><a class="ae lq" href="https://devskrol.com/index.php/2020/10/25/a-tip-a-day-python-tip-6-pandas-merge/" rel="noopener ugc nofollow" target="_blank"><em class="lp">https://devskrol.com</em></a>T22。</p></div></div>    
</body>
</html>