<html>
<head>
<title>Sentiment Analysis for Movie Reviews</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电影评论的情感分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentiment-analysis-for-movie-reviews-791be2a58297?source=collection_archive---------4-----------------------#2020-10-24">https://medium.com/analytics-vidhya/sentiment-analysis-for-movie-reviews-791be2a58297?source=collection_archive---------4-----------------------#2020-10-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/29ba97dea0e9547b332a46955befda52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfVLAikBZ5y2ZfECxL5kxA.jpeg"/></div></div></figure><p id="c835" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:所有的代码文件都可以在:<a class="ae jo" href="https://github.com/ashwinhprasad/SentimentAnalysis" rel="noopener ugc nofollow" target="_blank">https://github.com/ashwinhprasad/SentimentAnalysis</a>获得</p><h1 id="58ee" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">什么是情感分析？</h1><p id="9c71" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">简而言之，情感分析基本上是从用户的活动(如评论、推文等)中分析用户对某个项目或任何其他事物的感受。</p><h1 id="ba96" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">跳到代码</h1><ol class=""><li id="a815" class="ks kt hi is b it kn ix ko jb ku jf kv jj kw jn kx ky kz la bi translated"><strong class="is hj">导入库</strong></li></ol><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="cc95" class="lk jq hi lg b fi ll lm l ln lo"><strong class="lg hj">import</strong> <strong class="lg hj">numpy</strong> <strong class="lg hj">as</strong> <strong class="lg hj">np</strong><br/><strong class="lg hj">import</strong> <strong class="lg hj">pandas</strong> <strong class="lg hj">as</strong> <strong class="lg hj">pd</strong><br/><strong class="lg hj">import</strong> <strong class="lg hj">matplotlib.pyplot</strong> <strong class="lg hj">as</strong> <strong class="lg hj">plt<br/>import nltk</strong></span></pre><p id="2023" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2。下载NLTK </strong></p><p id="6e74" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用nltk shell下载英语停用词。</p><p id="7d69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3。导入数据集</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="a60d" class="lk jq hi lg b fi ll lm l ln lo">df = pd.read_csv('IMDB Dataset.csv')<br/>df.head()</span></pre><p id="9825" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">输出:</strong></p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/cc966032b9afb3f7581466d3e97ee0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*uxxydDMJvcTdvPWcndRuxQ.png"/></div></figure><p id="f218" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lq">如你所见，评论中有一些html标签</em></p><p id="546b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 4。美丽的汤</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="7b77" class="lk jq hi lg b fi ll lm l ln lo"><em class="lq">#remove html tags</em><br/><strong class="lg hj">from</strong> <strong class="lg hj">bs4</strong> <strong class="lg hj">import</strong> BeautifulSoup<br/><strong class="lg hj">for</strong> i <strong class="lg hj">in</strong> range(df.shape[0]):<br/>    df['review'][i] = BeautifulSoup(df['review'][i], "lxml").text</span></pre><p id="b42f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Beautiful soup是一个web废弃库，可以用来从数据集中删除html标签</p><p id="46c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 5。删除标点符号</strong></p><p id="5467" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用函数去掉标点符号。包含所有的标点符号。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="c324" class="lk jq hi lg b fi ll lm l ln lo"><em class="lq">#remove punctuations</em><br/><strong class="lg hj">import</strong> <strong class="lg hj">string</strong><br/><strong class="lg hj">def</strong> punctuation(sentence):<br/>    review = [letters.lower() <strong class="lg hj">for</strong> letters <strong class="lg hj">in</strong> sentence <strong class="lg hj">if</strong> letters <strong class="lg hj">not</strong> <strong class="lg hj">in</strong> string.punctuation ]<br/>    review = ''.join(review)<br/>    <strong class="lg hj">return</strong> review<br/><br/>df['review'] = df['review'].apply(punctuation)</span></pre><p id="d963" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 6。编码文本变量并删除停用词</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="bff6" class="lk jq hi lg b fi ll lm l ln lo">df['sentiment'].replace(['positive','negative'],[1,0],inplace=<strong class="lg hj">True</strong>)</span></pre><p id="2b3a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用1，0代替正，负。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="1c9f" class="lk jq hi lg b fi ll lm l ln lo"><em class="lq">#removing stopwords</em><br/><strong class="lg hj">def</strong> stopwords(sentence):<br/>    review = [words <strong class="lg hj">for</strong> words <strong class="lg hj">in</strong> sentence.split() <strong class="lg hj">if</strong> words <strong class="lg hj">not</strong> <strong class="lg hj">in</strong> nltk.corpus.stopwords.words('english')]<br/>    review = ' '.join(review)<br/>    <strong class="lg hj">return</strong> review<br/><br/>df['review'] = df['review'].apply(stopwords)</span></pre><p id="8b54" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">停用词是可以从数据集中删除的常用词。一般来说，这些词没有太大的意义</p><p id="130f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 7。词干</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="11cf" class="lk jq hi lg b fi ll lm l ln lo"><em class="lq">#stemming<br/></em><strong class="lg hj">from</strong> <strong class="lg hj">nltk</strong> <strong class="lg hj">import</strong> PorterStemmer <br/>ps = PorterStemmer() <br/>df['review'] = df['review'].apply(ps.stem)<br/>df.head()</span></pre><p id="eb19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">输出:</strong></p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/039eb036421138a05ae24bc411b326d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*UP9E_fG2jOyRKjRQaUahIQ.png"/></div></figure><p id="1d80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转换为tf-idf是一项计算量很大的任务。我们希望在不丢失数据信息的情况下，尽可能减少不同单词的数量。<br/>我们的数据集包含像<strong class="is hj">跑、跑者、跑、跑</strong>这样的词。我们的模型不会丢失任何信息，即使所有这些词被概括为<strong class="is hj">运行</strong>。这就是词干的作用。</p><p id="cc2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8。Tf-Idf矢量器</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="683b" class="lk jq hi lg b fi ll lm l ln lo"><em class="lq">#tf-Idf vectorizer<br/></em><strong class="lg hj">from</strong> <strong class="lg hj">sklearn.feature_extraction.text</strong> <strong class="lg hj">import</strong> TfidfVectorizer vectorizer = TfidfVectorizer() <br/>x = vectorizer.fit_transform(df['review']) <br/>y =  df['sentiment']</span></pre><p id="67cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">TF-IDF是一种统计度量，用于评估单词与文档集合中的文档的相关程度。这是通过将两个度量相乘来实现的:一个单词在一个文档中出现的次数，以及该单词在一组文档中的逆文档频率。<br/>现在，我们已经使用tf-idf矢量器将文本转换为数字数据。</p><p id="addb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 9。列车测试分割</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="1d0e" class="lk jq hi lg b fi ll lm l ln lo"><em class="lq">#train test split</em> <br/><strong class="lg hj">from</strong> <strong class="lg hj">sklearn.model_selection</strong> <strong class="lg hj">import</strong> train_test_split x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2)</span></pre><p id="5fd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要将数据集分成训练集和测试集</p><p id="2bd0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 10。随机森林分类器</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="a5ad" class="lk jq hi lg b fi ll lm l ln lo"><strong class="lg hj">from</strong> <strong class="lg hj">sklearn.ensemble</strong> <strong class="lg hj">import</strong> RandomForestClassifier<br/>classifier = RandomForestClassifier(n_estimators=100,)<br/>classifier.fit(x_train,y_train)</span></pre><p id="431f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们已经将模型拟合到我们的数据集。这个模型现在可以测试了。</p><p id="5796" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 11。模型分析</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="e286" class="lk jq hi lg b fi ll lm l ln lo"><em class="lq">#making predictions</em><br/>y_pred = classifier.predict(x_test)</span><span id="155a" class="lk jq hi lg b fi ls lm l ln lo"><em class="lq">#model accuracy</em><br/>print("Model Accuracy : <strong class="lg hj">{}</strong>%".format((y_pred == y_test).mean()))</span><span id="2ccc" class="lk jq hi lg b fi ls lm l ln lo"><em class="lq">#confusion matrix</em> <strong class="lg hj">from</strong> <strong class="lg hj">sklearn.metrics</strong> <strong class="lg hj">import</strong> confusion_matrix print(confusion_matrix(y_test,y_pred))</span><span id="f39e" class="lk jq hi lg b fi ls lm l ln lo"><strong class="lg hj">output:</strong></span><span id="814f" class="lk jq hi lg b fi ls lm l ln lo">Model Accuracy : 0.8434%</span><span id="28e2" class="lk jq hi lg b fi ls lm l ln lo">confusion matrix: <br/>[[4256  770]<br/> [ 796 4178]]</span></pre><p id="d94b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该模型的准确率为:84.34% <br/>关于混淆矩阵的更多细节，请查看:C <a class="ae jo" rel="noopener" href="/analytics-vidhya/pytorch-for-deep-learning-confusion-matrix-e73163277c95">混淆矩阵</a></p><h1 id="089b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="ed52" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">这就是Python中随机森林算法对电影评论的情感分析。各种公司使用情感分析来获得客户反馈。</p><h2 id="71d1" class="lk jq hi bd jr lt lu lv jv lw lx ly jz jb lz ma kd jf mb mc kh jj md me kl mf bi translated">谢谢你</h2></div></div>    
</body>
</html>