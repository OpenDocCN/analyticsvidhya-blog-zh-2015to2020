<html>
<head>
<title>Plotting NPS Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绘制NPS数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/plottingnps-2958b642a51f?source=collection_archive---------14-----------------------#2020-01-29">https://medium.com/analytics-vidhya/plottingnps-2958b642a51f?source=collection_archive---------14-----------------------#2020-01-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="eee9" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用GGPlot绘制NPS数据的分步演练</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/9cf0ff45abef057a4634ef327db69425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJNUM-sJ_Xijy1SOzSFb0g.png"/></div></div></figure><h1 id="f98a" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">1.介绍</h1><p id="b0ae" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">净推动者得分(NPS)是一个值得信赖的指标，无数企业使用它来决定客户是企业的诋毁者还是推动者。网上有大量的资源来证明这一指标的使用，包括像<a class="ae kx" href="https://www.qualtrics.com/experience-management/customer/net-promoter-score/" rel="noopener ugc nofollow" target="_blank">qualtrics.com</a>、<a class="ae kx" href="https://en.wikipedia.org/wiki/Net_Promoter" rel="noopener ugc nofollow" target="_blank">wikipedia.org</a>和<a class="ae kx" href="https://www.netpromoter.com/know/" rel="noopener ugc nofollow" target="_blank">netpromoter.com</a>这样的网站。</p><p id="752e" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">NPS值的计算非常简单:<em class="ld">NPS = %推广者—%反对者</em>。</p><p id="e035" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">有两个选项可用于显示NPS值:</p><ol class=""><li id="f84b" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw lj lk ll lm bi translated">首先是指标的真正本质，这是一个条形图，NPS分数显示在图上。</li><li id="8e1c" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">其次是显示数据的密度图。</li></ol><p id="e5c7" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">本插图提供了一个有用的指南，使用<code class="du ls lt lu lv b"><a class="ae kx" href="https://www.r-project.org/" rel="noopener ugc nofollow" target="_blank">R</a></code>编程语言中的<code class="du ls lt lu lv b"><a class="ae kx" href="https://ggplot2.tidyverse.org/" rel="noopener ugc nofollow" target="_blank">ggplot2</a></code>来可视化这两种方法的NPS数据。</p><h1 id="2597" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">2.建立</h1><h2 id="efaf" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">2.1.装载包裹</h2><p id="8ee0" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">首先，必须建立环境。第一步是加载将要使用的包。</p><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="c682" class="lw jk hi lv b fi mo mp l mq mr">library(ggplot2)<br/>library(dplyr)<br/>library(magrittr)<br/>library(tidyr)</span></pre><h2 id="69e4" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">2.2.生成数据</h2><p id="f30e" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">下一步是生成NPS数据。为此，<code class="du ls lt lu lv b">sample()</code>功能用于在<em class="ld"> 6 </em>和<em class="ld"> 10 </em>之间产生<em class="ld">1000个</em>值。为方便起见，第一个<em class="ld"> 20 </em>值打印如下。</p><p id="d089" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">注意，该伪数据是通过使用函数生成的。但是，这些数据可以从任何调查软件中收集，并在此时输入到数据管道中。唯一的先决条件是数据是一个单一的数字向量，这些数字都是介于<em class="ld"> 0 </em>和<em class="ld"> 10 </em>之间的整数，包括这两个数字。</p><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="e95f" class="lw jk hi lv b fi mo mp l mq mr">set.seed(123)<br/>NpsData &lt;- sample(x=6:10, size=1000, replace=TRUE, prob=c(0.06, 0.05, 0.05, 0.42, 0.42))<br/>NpsData %&gt;% head(20) %&gt;% print()</span><span id="ea8d" class="lw jk hi lv b fi ms mp l mq mr">&gt; [1] 9 10 9 6 8 9 10 6 10 10 7 10 10 10 9 6 9 9 9 7</span></pre><h2 id="cda9" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">2.3.检查数据</h2><p id="6e7c" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">接下来，为了确认数据看起来正确，为生成的数据计算描述性统计数据。为此，<code class="du ls lt lu lv b">summarise_all()</code>函数用于计算一些关键的统计数据。</p><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="147d" class="lw jk hi lv b fi mo mp l mq mr">NpsData %&gt;%<br/>    data.frame() %&gt;% <br/>    summarise_all(list(Min=min, Max=max, Mean=mean, `Standard Deviation`=sd, Count=NROW)) %&gt;%<br/>    gather("Statistic", "Value") %&gt;% <br/>    mutate_at("Value", round, 2)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mt"><img src="../Images/9c65d5b1fead10b0e596363db910d8f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:366/format:webp/1*QUb2VAEZE-scZdRn6W3Vvg.png"/></div></figure><h1 id="1503" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">3.选项一:使用柱状图可视化</h1><h2 id="d1f5" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">3.1.总结NPS数据</h2><p id="f93f" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">为了计算NPS分数，对数据执行以下步骤:</p><ol class=""><li id="4df5" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw lj lk ll lm bi translated">要挟数据到一个<code class="du ls lt lu lv b">data.frame</code>；</li><li id="4656" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">添加一个<code class="du ls lt lu lv b">Category</code>变量来确定分数的类别；</li><li id="d748" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">统计每个类别的得分数；</li><li id="b264" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">计算不同类别的百分比；</li><li id="2841" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">计算NPS分数；和</li><li id="32d7" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">将它再次强制输入到一个<code class="du ls lt lu lv b">data.frame</code>中，以添加一个名为<code class="du ls lt lu lv b">NPS</code>的新变量。</li></ol><p id="30c8" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">一旦生成，数据就可以可视化了。</p><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="7bb8" class="lw jk hi lv b fi mo mp l mq mr">NpsScore &lt;- NpsData %&gt;% <br/>    data.frame(Score=.) %&gt;% <br/>    mutate(Category="Promoters"<br/>          ,Category=ifelse(Score&lt;=8, "Passives", Category)<br/>          ,Category=ifelse(Score&lt;=6, "Detractors", Category)<br/>          ,Category=factor(Category, levels=c("Promoters", "Passives", "Detractors"))<br/>          ) %&gt;% <br/>    count(Category, name="Count") %&gt;% <br/>    mutate(Percentage=Count/sum(Count)) %&gt;% <br/>    (function(x){<br/>        Pro &lt;- x %&gt;% filter(Category=="Promoters") %&gt;% select(Percentage) %&gt;% pull()<br/>        Det &lt;- x %&gt;% filter(Category=="Detractors") %&gt;% select(Percentage) %&gt;% pull()<br/>        return((Pro-Det)*10)<br/>    }) %&gt;% <br/>    data.frame(Score=.) %&gt;% <br/>    mutate(Name="NPS")</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mu"><img src="../Images/6fb950bd422db5be9e41166060d5f19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:198/format:webp/1*SAmhCEYDFj8V3LCNJokpFg.png"/></div></figure><h2 id="8c73" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">3.2生成柱状图数据框</h2><p id="bb18" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">为了正确显示NPS分数，生成一个空数据框，每一行代表一个可能的分数。这样做的原因是为了充分显示条形图。生成该数据的方法是使用<code class="du ls lt lu lv b">seq()</code>函数创建一个有序的数字序列，从<em class="ld"> 0 </em>到<em class="ld"> 10 </em>，每次递增<em class="ld"> 1 </em>。</p><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="3035" class="lw jk hi lv b fi mo mp l mq mr">NpsFrame &lt;- seq(from=0, to=10, by=1) %&gt;% <br/>    data.frame(NPS=.) %&gt;% <br/>    mutate(Name="NPS"<br/>          ,Category="Promoters"<br/>          ,Category=ifelse(NPS&lt;9,"Passives",Category)<br/>          ,Category=ifelse(NPS&lt;7,"Detractors",Category)<br/>          ,Category=factor(Category, levels=c("Promoters", "Passives", "Detractors"))<br/>          ,NPS=factor(NPS, levels=0:10)<br/>          )</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mv"><img src="../Images/2af91651d44d1b84e1bc4e52d9125be9.png" data-original-src="https://miro.medium.com/v2/resize:fit:328/format:webp/1*3Ksrd9ZYYIfHAydTnkSZtg.png"/></div></figure><h2 id="e3d2" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">3.3将它们全部连接在一起</h2><p id="8881" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">接下来，将NPS分数和NPS帧连接在一起，以便在每一行上复制NPS分数。这是通过使用<code class="du ls lt lu lv b">left_join() </code>功能，并使用<code class="du ls lt lu lv b">Name</code>作为两帧之间的连接变量来完成的。</p><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="0cec" class="lw jk hi lv b fi mo mp l mq mr">FinalData &lt;- left_join(x=NpsFrame<br/>                      ,y=NpsScore<br/>                      ,by="Name"<br/>                      )</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mw"><img src="../Images/3e1a933477034efc1cc30d1113035fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*Q4BPf6y0xB1i1kIFSfeX-g.png"/></div></figure><h2 id="6244" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">3.4绘制最终输出</h2><p id="66c6" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">最后，使用<code class="du ls lt lu lv b">ggplot()</code>函数和以下图层绘制结果:<code class="du ls lt lu lv b">geom_bar()</code>、<code class="du ls lt lu lv b">geom_point()</code>和<code class="du ls lt lu lv b">geom_label()</code>。</p><p id="f593" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">遵循以下步骤:</p><p id="4efe" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">1.使用<code class="du ls lt lu lv b">Name</code>变量作为唯一的美学变量，通过管道将<code class="du ls lt lu lv b">FinalData</code>数据框输入到<code class="du ls lt lu lv b">ggplot()</code>函数中。</p><p id="d533" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">2.添加一个<code class="du ls lt lu lv b">geom_bar()</code>层，使用<code class="du ls lt lu lv b">Category</code>变量来确定使用哪种颜色来填充列，然后使用颜色“深灰色”在类别周围添加一个边框，并给它一个<em class="ld"> 0.5 </em>单位的宽度。</p><p id="acb4" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">3.使用以下参数添加一个<code class="du ls lt lu lv b">geom_point()</code>层:</p><ul class=""><li id="9410" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw mx lk ll lm bi translated">3.1.“T15”是使用匿名函数创建的。这样就可以操作<code class="du ls lt lu lv b">ggplot()</code>功能使用的数据，而无需使用另一个外部变量。该操作被有效地用于创建可以在该层中使用的单个NPS分数。</li><li id="12a6" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">3.2.<code class="du ls lt lu lv b">aes</code>是用于<code class="du ls lt lu lv b">y</code>轴的美学；在这种情况下是NPS分数。这用于确定该点在图上的位置。</li><li id="0dd8" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">3.3.<code class="du ls lt lu lv b">shape</code>是一个<code class="du ls lt lu lv b">plus</code>符号，用来确定点的准确位置，方便人眼看到。</li><li id="0fa3" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">3.4.<code class="du ls lt lu lv b">size</code>是符号的大小，在本例中是<em class="ld"> 25 </em>个单位。</li></ul><p id="6d36" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">4.使用以下参数添加一个<code class="du ls lt lu lv b">geom_label()</code>层:</p><ul class=""><li id="afc0" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw mx lk ll lm bi translated">4.1.再次操作<code class="du ls lt lu lv b">data</code>，以确定与<code class="du ls lt lu lv b">geom_point()</code>中使用的值相同的值。</li><li id="edc5" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">4.2.<code class="du ls lt lu lv b">stat</code>是用来计算标签位置的统计量；在这个例子中是值<code class="du ls lt lu lv b">identity</code>，它有效地告诉<code class="du ls lt lu lv b">ggplot</code>使用数据自己的身份，并且不为数据计算任何其他统计。</li><li id="419f" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">4.3.<code class="du ls lt lu lv b">aes</code>用于确定<code class="du ls lt lu lv b">label</code>应该是来自<code class="du ls lt lu lv b">Score</code>变量的值，并且应该放置在<code class="du ls lt lu lv b">y</code>轴上的<code class="du ls lt lu lv b">Score</code>位置。实际上，这种美学被用来决定标签的值应该是什么，以及它应该放在图中的什么位置。</li><li id="f6cb" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">4.4.<code class="du ls lt lu lv b">size</code>'用来确定标签的大小；在这种情况下是<em class="ld"> 5 </em>个单元。</li></ul><p id="88b1" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">5.使用<code class="du ls lt lu lv b">scale_y_continuous()</code>层确定应使用多少个断点，以及<code class="du ls lt lu lv b">y</code>轴的极限。</p><p id="c612" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">6.使用<code class="du ls lt lu lv b">scale_fill_manual()</code>层确定三个不同类别中应使用的颜色。</p><p id="7091" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">7.使用<code class="du ls lt lu lv b">theme()</code>层的<code class="du ls lt lu lv b">axis.text.y.left</code>参数隐藏<code class="du ls lt lu lv b">y</code>轴的轴文本。</p><p id="00a7" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">8.使用<code class="du ls lt lu lv b">coord_flip()</code>图层，翻转绘图的坐标，使其从左到右显示为一个条形。</p><p id="2209" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">9.使用<code class="du ls lt lu lv b">labs()</code>层标记轴，以确保正确的信息显示在正确的位置。</p><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="8c4e" class="lw jk hi lv b fi mo mp l mq mr">FinalData %&gt;% <br/>    ggplot(aes(Name)) +<br/>    geom_bar(aes(fill=Category), colour="darkgrey", width=0.5, alpha=0.5) +<br/>    geom_point(data=function(x) {x &lt;- x %&gt;% select(Name, Score) %&gt;% mutate(Score=round(Score,2)) %&gt;% distinct()}<br/>              ,stat="identity"<br/>              ,aes(y=Score)<br/>              ,shape="plus"<br/>              ,size=25<br/>              ) +<br/>    geom_label(data=function(x) {x %&gt;% select(Name, Score) %&gt;% mutate(Score=round(Score,2)) %&gt;% distinct}<br/>              ,stat="identity"<br/>              ,aes(y=Score, label=Score)<br/>              ,size=5<br/>              ) +<br/>    scale_y_continuous(breaks=seq(0,10,1), limits=c(0,10), oob=squish) +<br/>    scale_fill_manual(values=c("#66bd63", "#fdae61", "#d73027")) +<br/>    theme(axis.text.y.left=element_blank()) +<br/>    coord_flip() +<br/>    labs(title="NPS Score"<br/>        ,fill="Category"<br/>        ,y="NPS Score"<br/>        ,x="NPS"<br/>        )</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/0840d2eca4c14b3dc8329d646539fa15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ICMVMiq1kKnFKolWMSyZWg.png"/></div></div></figure><h1 id="7ce2" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">4.选项二:使用密度图可视化</h1><h2 id="6d5c" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">4.1.生成密度图数据框</h2><p id="fd56" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">为了可视化密度图，不需要对数据进行总结，但最好保持其原始形式。然而，它需要进行以下操作:</p><ol class=""><li id="7391" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw lj lk ll lm bi translated">要挟进去一个<code class="du ls lt lu lv b">data.frame</code>；和</li><li id="e039" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">添加<code class="du ls lt lu lv b">Category</code>变量。</li></ol><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="825a" class="lw jk hi lv b fi mo mp l mq mr">FinalFrame &lt;- NpsData %&gt;% <br/>    data.frame(Score=.) %&gt;% <br/>    mutate(Category="Promoters"<br/>          ,Category=ifelse(Score&lt;=8, "Passives", Category)<br/>          ,Category=ifelse(Score&lt;=6, "Detractors", Category)<br/>          ,Category=factor(Category, levels=c("Promoters", "Passives", "Detractors"))<br/>          )</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mz"><img src="../Images/8d1f84e17920f29fa9401455735f586a.png" data-original-src="https://miro.medium.com/v2/resize:fit:246/format:webp/1*2Ci6AP5qVk38DTxFBTaF6g.png"/></div></figure><h2 id="d4b6" class="lw jk hi bd jl lx ly lz jp ma mb mc jt kk md me jv ko mf mg jx ks mh mi jz mj bi translated">4.2可视化密度图数据</h2><p id="42d8" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">密度数据帧一旦生成，就可以通过<code class="du ls lt lu lv b">ggplot()</code>可视化，使用以下美学:<code class="du ls lt lu lv b">geom_bar()</code>和<code class="du ls lt lu lv b">geom_density()</code>。</p><p id="b15a" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">使用了以下步骤:</p><ol class=""><li id="3579" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw lj lk ll lm bi translated">通过管道将<code class="du ls lt lu lv b">FinalData</code>数据框输入到<code class="du ls lt lu lv b">ggplot()</code>函数中，使用<code class="du ls lt lu lv b">Score</code>变量作为唯一的美学。</li><li id="fcf6" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">添加一个<code class="du ls lt lu lv b">geom_bar()</code>层，使用类别变量来确定用来填充列的颜色，然后使用颜色“深灰色”在类别周围添加一个边框，并给它一个透明度值<em class="ld"> 0.3 </em>。</li><li id="2499" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">添加一个<code class="du ls lt lu lv b">geom_density()</code>层，使用一个美观的<code class="du ls lt lu lv b">y</code>值来确定这个值应该是数据的“计数”，而不是数据的“密度”，然后给它一个“蓝色”，并将大小增加到<em class="ld"> 1 </em>单位。</li><li id="9269" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">使用<code class="du ls lt lu lv b">scale_fill_manual()</code>图层，确定三个不同类别应使用的颜色。</li><li id="f224" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">使用<code class="du ls lt lu lv b">scale_x_continuous()</code>层确定<code class="du ls lt lu lv b">x</code>轴的断点和极限。</li><li id="cd0e" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">使用<code class="du ls lt lu lv b">theme()</code>层从图中删除图例。</li><li id="a594" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">使用<code class="du ls lt lu lv b">labs()</code>图层为绘图添加标签。</li></ol><pre class="iy iz ja jb fd mk lv ml mm aw mn bi"><span id="3740" class="lw jk hi lv b fi mo mp l mq mr">FinalFrame %&gt;% <br/>    ggplot(aes(Score)) +<br/>    geom_bar(aes(fill=Category), colour="darkgrey", alpha=0.3) +<br/>    geom_density(aes(y=..count..), colour="blue", adjust=3, size=1) +<br/>    scale_fill_manual(values=c("#66bd63", "#fdae61", "#d73027")) +<br/>    scale_x_continuous(breaks=seq(0,10,1), limits=c(-0.5,10.5)) +<br/>    theme(legend.position="none") +<br/>    labs(title="Density Plot of NPS"<br/>        ,x="Score"<br/>        ,y="Count"<br/>        )</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/93beeca01298caff878166a71c27982e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qzM4rPzwtnDQNMgBN6UFYg.png"/></div></div></figure><h1 id="7a52" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">5.结论</h1><p id="2058" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">正如所看到的，净推动者得分是一个有用的指标，可以看出客户是企业的推动者，被动者或诋毁者的百分比。该指标可以在一个简单的柱状图中显示，图表上显示一个静态值，也可以显示为一个密度图，显示不同类别客户的比例。这两种方法都在本简介中提供，从数据操作到绘图有一步一步的指导。</p><h1 id="1bdf" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">6.附言</h1><p id="2693" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kd hj">出版物</strong>:本报告也在以下网站发布:</p><ul class=""><li id="c41e" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw mx lk ll lm bi translated">RPubs:<a class="ae kx" href="http://rpubs.com/chrimaho/PlottingNPS" rel="noopener ugc nofollow" target="_blank">RPubs/chrimaho/plotting NPS</a></li><li id="cc8f" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">GitHub:<a class="ae kx" href="https://github.com/chrimaho/PlottingNPS" rel="noopener ugc nofollow" target="_blank">GitHub/chrimaho/plotting NPS</a></li><li id="b6c1" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw mx lk ll lm bi translated">中:<a class="ae kx" rel="noopener" href="/@chrimaho/2958b642a51f?source=friends_link&amp;sk=382557ae6dd6227d004eb42a374fbb8f">中/chrimaho/PlottingNPS </a></li></ul><p id="f172" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">更改日志:</strong>本出版物于以下日期修改:</p><ul class=""><li id="a481" class="le lf hi kd b ke ky kh kz kk lg ko lh ks li kw mx lk ll lm bi translated">2020年1月29日:原始出版日期</li></ul></div></div>    
</body>
</html>