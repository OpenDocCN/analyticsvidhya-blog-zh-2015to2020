<html>
<head>
<title>How to handle Imbalanced data in machine Learning?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中如何处理不平衡数据？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-handle-imbalance-data-in-machine-learning-96274e211d1b?source=collection_archive---------20-----------------------#2019-12-30">https://medium.com/analytics-vidhya/how-to-handle-imbalance-data-in-machine-learning-96274e211d1b?source=collection_archive---------20-----------------------#2019-12-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/f1adf07a5e4daf09c15860dc971c48e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*sDOi_fiRTSw4pHweRMthHQ.jpeg"/></div></figure></div><div class="ab cl im in gp io" role="separator"><span class="ip bw bk iq ir is"/><span class="ip bw bk iq ir is"/><span class="ip bw bk iq ir"/></div><div class="hb hc hd he hf"><p id="c5b0" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">什么是不平衡和平衡的数据集？</p><p id="9b38" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">这是涉及两个或更多类的监督机器学习问题的主要背景。</p><p id="eef6" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">例如:</p><p id="fe84" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">你有一个两级分类问题。因为总共有n个数据点或实例，其中n1个数据点(实例)是零类实例，n2个数据点是一类实例。</p><p id="e4b8" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">如果<em class="jr"> n1 ≈ n2 </em> (n1约等于n2)则称之为<strong class="iv hj">平衡数据集</strong>。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es js"><img src="../Images/1905e4681f06f5ec5330bfd95f3e159b.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*JAxV6R30ChKdPQqIi5n2yg.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">平衡数据集类。</figcaption></figure><p id="f23c" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">例如:在n =1000个实例或行的数据集中，n1 =一个类的580个实例，n2 =另一个类的420个实例(n1是58 %，n2是42 %)。</p><p id="2e7b" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">如果<em class="jr">n1</em><em class="jr">&lt;&lt;</em><em class="jr">n2</em>(<em class="jr">n1</em>远小于N2)或者n1 &gt; &gt; n2 (n1远大于n1)那么这个数据集叫做<strong class="iv hj">不平衡数据集</strong>。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/117eb7868467b16bb1b468ed41a3471f.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*IDEM-udrGDWYqq13wbTApA.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">图- <strong class="bd kc">不平衡数据集</strong>其中Class-0 &gt; &gt; Class-1</figcaption></figure><p id="aa83" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">例如:在n = 1000个实例或行的数据集中，n1 =一个类的900个实例和另一个类的100个实例(n1 = 90 %，n2 = 10%)。</p><p id="b30a" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj">不平衡数据集的例子:</strong></p><p id="a3b4" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在许多医疗应用中，我们有10000个病人的数据，其中只有100个病人患病。</p><p id="67b2" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在网上购物中，数百万人登录网站，但只有少数人购买商品。</p><p id="f69a" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">检测电子邮件是否为垃圾邮件的电子邮件分类问题在此数据中，很少有电子邮件是垃圾邮件。</p><p id="b147" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在地震数据中。、欺诈检测、医疗诊断。</p><h1 id="0632" class="kd ke hi bd kc kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">不平衡数据集的问题是什么？</h1><p id="7de6" class="pw-post-body-paragraph it iu hi iv b iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm le jo jp jq hb bi translated">当每个样本的数量相等时，大多数机器学习算法工作良好。如果一个类有很多点，这就是多数类。多数阶级可以得到一些好处。模型结果可能偏向多数阶级。你可能会得到错误的结果。在现实生活问题中，如果模型给出错误的结果，那么在医学诊断、欺诈检测中，误分类的代价是非常高的。</p><p id="e03d" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在这种情况下，我们的任务是修改分类算法或使用一些技巧来处理不平衡的数据。</p><p id="b371" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj"> <em class="jr">准确性问题:</em> </strong></p><p id="3fbd" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><em class="jr">准确度=(正确分类的总点数/总点数)* 100 </em></p><p id="92f7" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">如果我们使用准确性作为我们的绩效衡量标准，那么它会给你错误的结果。</p><p id="5707" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">例如，您有一个2类(二元)分类问题，有1000个点(实例或行)。总共有900行被标记为0类，100行被标记为1类。<br/>如果我的模型是“<em class="jr">哑的</em>”，并且它预测所有点都是0类。那么，在这种情况下，我的准确率是<em class="jr"> (900 /1000) * 100 = 90 % </em></p><p id="935a" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">但是准确性仅仅反映了底层的类别分布。</p><h1 id="6b93" class="kd ke hi bd kc kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">解决方案<strong class="ak"> : </strong></h1><ol class=""><li id="14cd" class="lf lg hi iv b iw la ja lb je lh ji li jm lj jq lk ll lm ln bi translated"><strong class="iv hj">随机欠采样:</strong>欠采样少数类点保持原样，从多数类中随机抽取样本点。<strong class="iv hj">你可以从多数类中删除行或实例。</strong></li></ol><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lo"><img src="../Images/8caa57dd150a9e249e9ed2643c18d54d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jNhdKuSh-574JZLqnnMrxQ.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">欠采样保持少数点不变，从多数类中随机采样100个点。</figcaption></figure><p id="62f7" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj">例如</strong>，你有一个2类(二元)分类问题，有1000个实例。</p><p id="0fe8" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">其中100个实例或行来自类0行(实例)</p><p id="0873" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">和来自类1的900个实例。</p><p id="9416" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">你可以使用抽样技巧来创建一个新的数据集。</p><p id="ad8e" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">挑选所有100个实例(行),因为它来自0类，即少数类。</p><p id="0584" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">从类1(即多数类)中随机选取100行样本实例(行),然后我们可以在新数据集上训练我们的模型。</p><p id="b956" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj">缺点:</strong>模型在较小的数据量上训练。丢弃点不是训练我们模型的好方法。这可能是有用的信息。</p><p id="a167" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">注意:当您有大量数据(数万或数十万行或更多)时，请考虑欠采样。</p><p id="aa5d" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">欠采样Python代码</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="30f9" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj"> 2。过采样:</strong>从数据集中的少数类中放置更多的点。</p><p id="8450" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">您可以添加来自少数类点的行(点)的副本，这称为过采样。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lv"><img src="../Images/64ccb8cab337335eaf17bb5873b0da18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KK6210udIJG5peuQ77sMag.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">从少数民族阶层获得更多的分数。</figcaption></figure><p id="532b" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">例如:您有一个2类(二进制)分类问题，有1000个实例或行。</p><p id="afe6" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">其中100行为0级行(点)</p><p id="b561" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">900个一级实例。通过过采样或重复0类点，可以从0类创建900个点。</p><p id="fa7f" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj"> <em class="jr">如何创建过采样？</em>T13】</strong></p><ol class=""><li id="9cfc" class="lf lg hi iv b iw ix ja jb je lw ji lx jm ly jq lk ll lm ln bi translated">生成合成/人造点</li><li id="e0be" class="lf lg hi iv b iw lz ja ma je mb ji mc jm md jq lk ll lm ln bi translated">有系统的算法可以用来生成合成样本。这种算法中最流行的叫做SMOTE，即合成少数过采样技术。SMOTE使用最近邻算法来生成新的合成数据。</li></ol><h2 id="4505" class="me ke hi bd kc mf mg mh ki mi mj mk km je ml mm kq ji mn mo ku jm mp mq ky mr bi translated">Python代码:</h2><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">Python中的过采样代码</figcaption></figure><h1 id="8009" class="kd ke hi bd kc kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> SMOTE算法:</strong></h1><p id="be13" class="pw-post-body-paragraph it iu hi iv b iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm le jo jp jq hb bi translated">第一步:在第一步中，像这样在现有的少数点(实例)之间画一条线。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es ms"><img src="../Images/428f9b163b05294a9c2199d23ba891ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zKA6ffIAvtJkfVyBjBYFng.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">在少数类点上画线</figcaption></figure><p id="3f4c" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">步骤2:在这些行的某处添加合成少数实例。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es ms"><img src="../Images/f8b17ae75baf03b344a58b398f2cf9dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1pmL4jkEzdv4dw_cZPxjw.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">增加少数民族类的分数</figcaption></figure><p id="334a" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">SMOTE代码:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="3a1e" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj"> 3。</strong> <strong class="iv hj">类-权重平衡:</strong>在这个方法中，你可以给少数类分配更多的权重，给多数类分配更少的权重。</p><p id="fcfe" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj">例如</strong>，你有一个2类(二元)分类问题，有1000个点(实例或行)。</p><p id="678c" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">其中100行标记为0级，900行标记为1级。然后将权重9分配给0类实例。</p><p id="c8cc" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">将权重1分配给Class-2实例。</p><p id="699f" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在“<em class="jr"> sklearn”中，为逻辑回归提供“class_weight”选项。</em></p><p id="9110" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj"> 4。更改绩效指标:</strong></p><p id="1534" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj">准确性</strong>是<strong class="iv hj">不好</strong>在处理不平衡数据时测量。</p><p id="0da5" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在数据不平衡的情况下，您可以使用以下指标。</p><ol class=""><li id="3c4f" class="lf lg hi iv b iw ix ja jb je lw ji lx jm ly jq lk ll lm ln bi translated">混淆矩阵:将预测分解成一个表格，显示正确的预测(对角线)和错误预测的类型(错误预测被分配到哪个类别)。</li><li id="a52e" class="lf lg hi iv b iw lz ja ma je mb ji mc jm md jq lk ll lm ln bi translated">精度:在所有模型预测为1级的点中，实际为1级的点的百分比是多少。</li><li id="0baf" class="lf lg hi iv b iw lz ja ma je mb ji mc jm md jq lk ll lm ln bi translated">回想一下:在所有属于第1类的点中，被预测为第1类点的点的百分比是多少。</li><li id="1d0b" class="lf lg hi iv b iw lz ja ma je mb ji mc jm md jq lk ll lm ln bi translated">F 1-score:精确度和召回率的加权平均值。</li><li id="aeba" class="lf lg hi iv b iw lz ja ma je mb ji mc jm md jq lk ll lm ln bi translated">AUC-ROC:它基本上告诉我们有多少模型能够分成不同的类别标签。</li></ol><p id="d37a" class="pw-post-body-paragraph it iu hi iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv hj">参考文献:</strong></p><div class="mt mu ez fb mv mw"><a href="http://rikunert.com/SMOTE_explained" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab dw"><div class="my ab mz cl cj na"><h2 class="bd hj fi z dy nb ea eb nc ed ef hh bi translated">SMOTE逐行解释noobs -合成少数过采样技术</h2><div class="nd l"><h3 class="bd b fi z dy nb ea eb nc ed ef dx translated">当训练集中的一个类支配着整个系统时，使用开箱即用的机器学习算法是有问题的</h3></div><div class="ne l"><p class="bd b fp z dy nb ea eb nc ed ef dx translated">rikunert.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk ik mw"/></div></div></a></div></div></div>    
</body>
</html>