<html>
<head>
<title>Predicting Life Expectancies, Part 1: Using Statistics to gain insight</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测预期寿命，第1部分:使用统计数据获得洞察力</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-life-expectancies-part-1-using-statistics-to-gain-insight-654cb13a9866?source=collection_archive---------21-----------------------#2020-11-22">https://medium.com/analytics-vidhya/predicting-life-expectancies-part-1-using-statistics-to-gain-insight-654cb13a9866?source=collection_archive---------21-----------------------#2020-11-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/3fe162927a018e0dea4d44ed9710c7a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*puiPFSfl-l5CqyOphPluFQ.png"/></div></figure><p id="bab4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个博客是我的项目“预测预期寿命”的预演。如果你想进行回购或更详细地遵循这些步骤，请查看<a class="ae jk" href="https://github.com/roydipta/life_expectancy" rel="noopener ugc nofollow" target="_blank">https://github.com/roydipta/life_expectancy</a></p><p id="e71b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">试图预测预期寿命的重要性是什么？</strong></p><p id="ae1c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个项目的目的不仅仅是预测一个人能活多久，更重要的是观察他们生活的哪些方面会导致更高或更低的预期寿命。如果我们能够找出影响预期寿命的因素；这有助于指导政策制定者制定更好的法律，有助于指导人们做出更好的生活决定，等等…</p><p id="0069" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，我们需要数据！有三组数据被提取。来自世界卫生组织(世卫组织)的预期寿命(2000-2015年)，来自世卫组织的各国成人肥胖率(1975-2016年)，以及来自联合国开发计划署、世界银行和世卫组织的自杀率概览(1985-2016年)。</p><p id="e5dc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们已经有了数据，让我们开始吧！我们需要导入我们将使用的所有包，并将数据放入三个数据框中(我们稍后将解析所有内容):</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="a276" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq hj">import</strong> <strong class="jq hj">pandas</strong> <strong class="jq hj">as</strong> <strong class="jq hj">pd</strong><br/>pd.set_option('display.max_columns', 300)<br/>pd.set_option('display.max_rows', 100)<br/><br/><strong class="jq hj">import</strong> <strong class="jq hj">numpy</strong> <strong class="jq hj">as</strong> <strong class="jq hj">np</strong><br/><strong class="jq hj">import</strong> <strong class="jq hj">matplotlib.pyplot</strong> <strong class="jq hj">as</strong> <strong class="jq hj">plt</strong><br/>%matplotlib inline<br/><strong class="jq hj">import</strong> <strong class="jq hj">seaborn</strong> <strong class="jq hj">as</strong> <strong class="jq hj">sns</strong><br/><br/><strong class="jq hj">import</strong> <strong class="jq hj">statsmodels.api</strong> <strong class="jq hj">as</strong> <strong class="jq hj">sm</strong><br/><strong class="jq hj">from</strong> <strong class="jq hj">statsmodels.formula.api</strong> <strong class="jq hj">import</strong> ols<br/><strong class="jq hj">from</strong> <strong class="jq hj">sklearn</strong> <strong class="jq hj">import</strong> linear_model<br/><strong class="jq hj">from</strong> <strong class="jq hj">sklearn.linear_model</strong> <strong class="jq hj">import</strong> LinearRegression<br/><strong class="jq hj">from</strong> <strong class="jq hj">sklearn.model_selection</strong> <strong class="jq hj">import</strong> train_test_split<br/><strong class="jq hj">from</strong> <strong class="jq hj">sklearn</strong> <strong class="jq hj">import</strong> metrics<br/><strong class="jq hj">from</strong> <strong class="jq hj">sklearn.preprocessing</strong> <strong class="jq hj">import</strong> PolynomialFeatures<br/><strong class="jq hj">from</strong> <strong class="jq hj">sklearn.preprocessing</strong> <strong class="jq hj">import</strong> StandardScaler</span><span id="94f4" class="ju jv hi jq b fi ka jx l jy jz">life = pd.read_csv('data\life_expectancy_data.csv')<br/>suicide = pd.read_csv('data\suicide_rates.csv')<br/>obesity = pd.read_csv('data\obesity_data.csv', index_col=0)</span></pre><p id="f404" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了让数据变得“漂亮”和可用，必须完成一大堆数据清理步骤和特征工程步骤。请查看github中的/data _ cleaning _ engineering . ipynb文件，了解完整的分步数据准备。</p><p id="8146" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一旦数据被清除，数据帧就被合并。这三个表合并了“国家”和“年份”列。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="2fe3" class="ju jv hi jq b fi jw jx l jy jz">df1 = pd.merge(life, obesity, how='left', on=['country', 'year'])</span><span id="0fc7" class="ju jv hi jq b fi ka jx l jy jz">df = suicide.groupby(['country', 'year', 'gdp_per_capita ($)']).suicides_no.sum()<br/>df = df.to_frame()<br/>df = df.reset_index(level=['country',"year", 'gdp_per_capita ($)'])</span><span id="aede" class="ju jv hi jq b fi ka jx l jy jz">df2 = pd.merge(df1, df, how='left', on=['country', 'year'])</span></pre><p id="afa0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们需要一个起点，所以让我们看看每个国家预期寿命的实际分布。在这一点上，我们将利用plotly的帮助:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="c5d4" class="ju jv hi jq b fi jw jx l jy jz"><strong class="jq hj">import</strong> <strong class="jq hj">plotly</strong> <br/>plotly.offline.init_notebook_mode()<br/><strong class="jq hj">import</strong> <strong class="jq hj">plotly.graph_objs</strong> <strong class="jq hj">as</strong> <strong class="jq hj">go</strong><br/><br/>x = df_2015.groupby("country")["life_expectancy"].mean().sort_values()<br/>data = dict(type = 'choropleth',<br/>            locations = x.index,<br/>            locationmode = 'country names',<br/>            colorscale= 'Portland',<br/>            text= x.index,<br/>            z=x,<br/>            colorbar = {'title':'Life Expectancy (Age)', 'len':200,'lenmode':'pixels' })<br/>layout = dict(geo = {'scope':'world'},title="Life Expectancy around the world in 2015")<br/>col_map = go.Figure(data = [data],layout = layout)<br/>col_map.show()</span></pre><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="er es kb"><img src="../Images/bc86629d6914a1fb015917337a7eaa45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*QO9VYIja_OZmXbZ1htRXJw.png"/></div></div></figure><p id="6c44" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到某种模式。乍一看，似乎越发达的国家预期寿命越长。如果你关注红色区域的国家(意味着最高的生活费用),你会注意到这些国家(加拿大、欧洲、澳大利亚)都有免费医疗。</p><p id="c7c7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是一个好的开始！所以我们提到，看起来越发达的国家预期寿命越长。让我们来检验这个假设。我们可以进行两样本T检验来检验它。在这种情况下，我们的零假设是发达国家的预期寿命等于发展中国家的预期寿命。我们的另一个假设是，发达国家的预期寿命不等于发展中国家的预期寿命</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es kg"><img src="../Images/42929cda9583a8dcabef36aac7ab20e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*qOOrwpq-pejTw1e0mh9FbQ.png"/></div></figure><p id="0129" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="2369" class="ju jv hi jq b fi jw jx l jy jz">developed = df[df['status']== 'Developed']<br/>developing = df[df['status']== 'Developing']<br/>developing.life_expectancy.dropna(inplace=<strong class="jq hj">True</strong>)</span><span id="2a4a" class="ju jv hi jq b fi ka jx l jy jz">stats.ttest_ind(developed['life_expectancy'], developing['life_expectancy'])</span></pre><p id="3b12" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">出局:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="8e35" class="ju jv hi jq b fi jw jx l jy jz">Ttest_indResult(statistic=29.76836505889292, pvalue=2.4650861700062064e-170)</span></pre><p id="208c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">那么这意味着什么呢？我们的p值远低于0.05，这是我们的置信区间，这意味着我们可以拒绝我们的零假设。如果我们看一下柱状图，我们会发现发达国家的平均预期寿命比发展中国家至少多15年。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/c2c7b5aba6a6719d0c08f3a56a881df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GsJTjFLzOZUiDbUzgrmv9w.png"/></div></figure><p id="19ff" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">嗯，现在我在想为什么会这样。在更发达的国家，应该有更好的医疗保健服务。此外，在更发达的国家，必须更好地获得食物和基本必需品。我们确实有一张肥胖表，也许我们可以看看越发达的国家是否有越多的肥胖人口。好了，让我们开始统计测试。我们的无效假设是，发达国家的肥胖与发展中国家的肥胖是一样的。我们的另一个假设是发达国家的肥胖和发展中国家的肥胖不一样。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/fb714e5e4493ed7da398c125ae23068d.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*gpXmUILtP9VnDyQ3n2xCGA.png"/></div></figure><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="4a3a" class="ju jv hi jq b fi jw jx l jy jz">developing.obesity.dropna(inplace=<strong class="jq hj">True</strong>)<br/>developed.obesity.dropna(inplace=<strong class="jq hj">True</strong>)</span><span id="d42b" class="ju jv hi jq b fi ka jx l jy jz">stats.ttest_ind(developed['obesity'], developing['obesity'])</span></pre><p id="63b0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">出局:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="8c59" class="ju jv hi jq b fi jw jx l jy jz">Ttest_indResult(statistic=8.718160546902753, pvalue=4.985541604428258e-18)</span></pre><p id="f9c8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">同样，我们的P值是wayyy小于0.05，所以我们可以拒绝我们的零假设！这是有道理的，我们能得到的食物越多，肥胖率就越高。我想我们得到了一些很好的数据。现在，我们可以实际运行一个回归，看看在预测预期寿命方面还有哪些重要的特征。寻找第二部分！:)</p></div></div>    
</body>
</html>