<html>
<head>
<title>Find a Better Linear Regression Model by Using R- Amusement Park Survey (2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用R-游乐园调查寻找更好的线性回归模型(2)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/find-a-better-linear-regression-model-by-using-r-amusement-park-survey-case-2-864cf6ae81df?source=collection_archive---------19-----------------------#2020-04-02">https://medium.com/analytics-vidhya/find-a-better-linear-regression-model-by-using-r-amusement-park-survey-case-2-864cf6ae81df?source=collection_archive---------19-----------------------#2020-04-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ba8aa374b7cbadc7c9ce98f5fc76ff2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E58jBt0BZMCSsUhv"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">克里斯蒂娜·温特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="73ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上一篇文章《<a class="ae iu" rel="noopener" href="/@sct.k/create-a-linear-regression-model-by-using-r-amusement-park-survey-case-1-e6f6d974db79">利用R-游乐园调查案例(1) </a>建立线性回归模型》开始，我们通过改变一个自变量建立了第一个模型(m1)，得到了与数据拟合度为68%的回归方程。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="75a3" class="kc kd hi jy b fi ke kf l kg kh">m1 &lt;- lm(overall ~ rides + games + wait + clean + num.child + logdist, data=surveyData)</span><span id="b5e1" class="kc kd hi jy b fi ki kf l kg kh">#create the report<br/>summary(m1)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/99b8bca351ecbc0c6b79a94db54f9824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Aq7NitOuu39HWlij.png"/></div></div></figure><p id="50ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，这个模型仍然有一些改进，因为我们总是想找到一个性能更好的模型。在本文中，我将介绍我所使用的数据预处理思想以及模型选择的标准。</p><h1 id="fcd9" class="kk kd hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">数据预处理</h1><h2 id="458b" class="kc kd hi bd kl lh li lj kp lk ll lm kt jg ln lo kx jk lp lq lb jo lr ls lf lt bi translated">删除列</h2><p id="42e5" class="pw-post-body-paragraph iv iw hi ix b iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo ly jq jr js hb bi translated">我们上次创建了一个名为logdist的新列，以避免信息失真，因此可以删除原来的距离列(如果有其他无用或不相关的列，我们也可以删除它们)。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="7faa" class="kc kd hi jy b fi ke kf l kg kh">head(surveyData) #show the original data<br/>surveyData &lt;- surveyData[,-3]<br/>head(surveyData) #show the data after dropping the third column</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/5a554b2faf5a4ed38498933225f79a77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2Jpc5IUyIPtULNWP.png"/></div></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/0cad3373270107acdc7544ad50b0da87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*joVDMMJWXJl_CtOpAszmqw.png"/></div></div></figure><h2 id="fc85" class="kc kd hi bd kl lh li lj kp lk ll lm kt jg ln lo kx jk lp lq lb jo lr ls lf lt bi translated">标准化/规范化数据</h2><p id="888f" class="pw-post-body-paragraph iv iw hi ix b iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo ly jq jr js hb bi translated">要看DV和IVs的关系，最好是同一个尺度。考虑到logdist显示了与其他不同的标度，我们必须进行归一化:(x-mean(x))/STD(x)。r已经为我们提供了这个功能。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="d9ef" class="kc kd hi jy b fi ke kf l kg kh">surveyData[,3:8] &lt;- scale(surveyData[,3:8])<br/>head(surveyData)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/b9f7ec426b1eb2ad715c50b62ad1aabc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZ_qEW8TWwvtUKIlqYW9qg.png"/></div></div></figure><p id="911c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">归一化后，我们建立一个新的模型(m2)，看看有没有变化。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="d909" class="kc kd hi jy b fi ke kf l kg kh">m2 &lt;- lm(overall ~ rides + games + wait + clean + weekend + logdist + num.child, data=surveyData)</span><span id="b1e7" class="kc kd hi jy b fi ki kf l kg kh">#create the report<br/>summary(m2)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/7f8a7d5ada060b9a34c59e809745604e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fm_3Bp39Psdu2_vjVRIZ1Q.png"/></div></div></figure><p id="401d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过稍微改变模型，我们得到了0.6786的R平方得分和0.647的调整后R平方得分，几乎与模型1中的值相同。仍然有一些改进的空间。</p><h2 id="ebfc" class="kc kd hi bd kl lh li lj kp lk ll lm kt jg ln lo kx jk lp lq lb jo lr ls lf lt bi translated">更改数据类型</h2><p id="06c3" class="pw-post-body-paragraph iv iw hi ix b iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo ly jq jr js hb bi translated">不同类型的数据也会影响模型。在这里，我们关注子列。它可以被视为连续(数字)和离散(因子，二进制)数据。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="f374" class="kc kd hi jy b fi ke kf l kg kh">is.numeric(surveyData$num.child)</span></pre><p id="4f1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于前面的数据，我们认为孩子的数量是数字。执行上述代码将返回“TRUE”，这意味着surveyData中的列“num.child”是数字。现在，我们试着把它变成因子，看看它是如何影响我们的结果的。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="4d45" class="kc kd hi jy b fi ke kf l kg kh">surveyData$num.child.factor &lt;- actor(surveyData$num.child)<br/>surveyData$num.child.factor</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/62d11e9219c164a3f882d82fec777041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_r0Ym35l5nODJs8cIC3waA.png"/></div></div></figure><p id="7122" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们打印出这个新栏目时，它似乎与旧栏目没有什么不同。但是看看输出的最后一行，它显示“级别:0 1 2 3 4 5”，这意味着它的数据类型是一个因子，在5个级别中。此后，我们再次运行回归模型(m3)。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="2982" class="kc kd hi jy b fi ke kf l kg kh">m3 &lt;- lm(overall ~ rides + games + wait + clean + weekend + logdist + num.child.factor, data=surveyData)</span><span id="8aa3" class="kc kd hi jy b fi ki kf l kg kh">#create the report<br/>summary(m3)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/93d8f4c5d1ab6d2edba71f3adf427ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpLp7P8vkruAILA8_PiDQw.png"/></div></div></figure><p id="d03e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在报告中，我们可以看到模型的大幅度增强。它给了我们0.7751的R平方得分和0.77的调整后R平方得分，比以前的尝试高出约10%。</p><p id="da6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们通过将列“num.child”更改为二进制变量来创建一个新列“has.child ”,并测试其工作原理。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6a3c" class="kc kd hi jy b fi ke kf l kg kh">surveyData$has.child &lt;- factor(surveyData$num.child &gt; 0)<br/>head(surveyData$has.child)</span></pre><p id="31f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出给我们“真”或“假”取决于条件。然后，我们使用新变量运行模型(m4)。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="7137" class="kc kd hi jy b fi ke kf l kg kh">m4 &lt;- lm(overall ~ rides + games + wait + clean + weekend + logdist + has.child, data=surveyData)</span><span id="8103" class="kc kd hi jy b fi ki kf l kg kh">#create the report<br/>summary(m4)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/fb4942095eef9f951feb19586a80d363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pL_d2hYFlNHg2vpQjHqZQ.png"/></div></div></figure><p id="b438" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果是显著的。R平方等于0.7742，调整后的R平方等于0.771，都与模型3相似。</p><h1 id="dcc9" class="kk kd hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">型号选择信息标准</h1><p id="022c" class="pw-post-body-paragraph iv iw hi ix b iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo ly jq jr js hb bi translated">R平方或调整后的R平方只是一个参考，除此之外，我们还必须检查其他一些模型信息标准，如AIC、BIC，以更近距离地了解模型的真实拟合程度。</p><p id="d797" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> AIC </strong>(阿凯克的信息准则)和<strong class="ix hj"> BIC </strong>(贝叶斯信息准则)是估计统计模型拟合优度的度量，也可用于模型选择。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="e115" class="kc kd hi jy b fi ke kf l kg kh">AIC(m1); AIC(m2); AIC(m3); AIC(m4) <br/>BIC(m1); BIC(m2); BIC(m3); BIC(m4)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/13f375a6f2433e365b95f652424431c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_8nHbTjfS44ZZftof67mw.png"/></div></div></figure><h1 id="b6ba" class="kk kd hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">结论</h1><p id="c3e8" class="pw-post-body-paragraph iv iw hi ix b iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo ly jq jr js hb bi translated">对于模型比较，具有最低AIC和BIC分数的模型是优选的。因此，我们得出结论，在这种情况下，模型4是最佳模型。这种二进制数据类型可能会成功处理过度拟合问题。而且我们也可以从报告中解读出，乘车满意度、等待、清洁、有/没有孩子是影响整体满意度得分的四个关键组成部分，并且都与它有正相关关系。</p></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><h1 id="2079" class="kk kd hi bd kl km mn ko kp kq mo ks kt ku mp kw kx ky mq la lb lc mr le lf lg bi translated">关于我</h1><p id="5367" class="pw-post-body-paragraph iv iw hi ix b iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo ly jq jr js hb bi translated">嗨，我是Kelly，一名具有新闻和传播背景的商业分析研究生，喜欢分享探索数据和有趣发现的生活。如果您有任何问题，请随时联系我，电话:【kelly.szutu@gmail.com】T5T7】</p></div></div>    
</body>
</html>