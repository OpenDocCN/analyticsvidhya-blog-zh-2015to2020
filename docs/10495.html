<html>
<head>
<title>How to Create an Interactive Choropleth Map using Geopandas and Folium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Geopandas 和 leav 创建交互式 Choropleth 地图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-create-interactive-choropleth-map-using-geopandas-and-folium-69e05ae1f931?source=collection_archive---------4-----------------------#2020-10-21">https://medium.com/analytics-vidhya/how-to-create-interactive-choropleth-map-using-geopandas-and-folium-69e05ae1f931?source=collection_archive---------4-----------------------#2020-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8fed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博文中，我们将讨论如何使用 geopandas 和 leav 创建交互式 choropleth 地图。地图是可视化地理区域统计数据的非常有用的工具。这种地图格式便于确定某些关键区域的位置。当数据科学家需要以简洁的格式向非技术人员展示大量数据时，这种方法尤其有用。</p><p id="bdb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要创建 choropleth，我们需要以下内容:</p><p id="ea96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">必需的库—leav 和 geopandas</p><p id="d226" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要绘制的数据-要在地图上显示的值</p><p id="2bc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在. geoJSON 文件中描述地理特征的几何图形</p><p id="4c5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">所需的 Python 库</strong></p><p id="9043" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是导入所需的库。</p><p id="0c9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在用 Python 处理过数据之后，leav(<a class="ae jd" href="http://python-visualization.github.io/folium/" rel="noopener ugc nofollow" target="_blank">http://python-visualization.github.io/folium/</a>)库使得在交互式传单地图上可视化数据变得很容易。此外，绘制 choropleth 地图并创建自己的标记也是可行的。</p><p id="cdde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">geo pandas(【http://geopandas.org/】T4)是一个开源项目，它使得用 Python 处理地理空间数据变得更加容易。GeoPandas 扩展了 Pandas 使用的数据类型，允许对几何类型进行空间操作。几何运算由 Shapely 执行。GeoPandas 进一步依赖 Fiona 进行文件访问，笛卡尔和 Matplotlib 进行绘图。</p><p id="a2eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两个库都可以使用 pip 或 conda 安装。</p><h1 id="bd75" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">数据和几何</h1><p id="6330" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated"><strong class="ih hj">要绘制的数据</strong></p><p id="d735" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这篇博文，我将使用国王郡房屋销售数据集。原始数据集(CSV 文件)和数据描述(DOC 文件)可以在<a class="ae jd" href="https://info.kingcounty.gov/assessor/DataDownload/default.aspx" rel="noopener ugc nofollow" target="_blank">这里</a>下载。使用的特殊表格有:不动产销售、住宅建筑和宗地。但是，我使用的是存储在<a class="ae jd" href="https://github.com/angelicacodes/phase_2_project_chicago-sf-seattle-ds-082420/blob/master/data/clean/KingCountyHousingData.csv" rel="noopener ugc nofollow" target="_blank">这里</a>的预处理干净数据。</p><p id="7812" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">几何图形</strong></p><p id="f6f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们导入了库并准备好了要绘制的数据，我们就需要几何图形作为感兴趣区域的 shapefile。我正在根据邮政编码处理华盛顿州金县的数据。我能够在西雅图开放数据门户中找到每个邮政编码的 shapefile 几何图形，并且我将在这个项目中使用它。King County geometry 的 shapefile 可通过以下链接找到:<a class="ae jd" href="https://data-seattlecitygis.opendata.arcgis.com/datasets/83fc2e72903343aabff6de8cb445b81c_2" rel="noopener ugc nofollow" target="_blank">西雅图地理数据</a>。</p><p id="ae66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您需要将 zip 文件下载到本地文件夹中，并使用 GeoPandas 将 zip 文件作为地理数据框架读取。我将只使用属于国王县的邮政编码几何。</p><h1 id="e049" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">创建地图</strong></h1><p id="dd8b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我们想根据邮政编码绘制每个地区的平均房屋销售价格。因此，我们需要将销售价格数据与几何合并为地理数据框。</p><p id="1dec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用叶我们将创建一个地图对象。需要金县坐标来定位地图上的位置:北纬 47.5480，西经 121.9836。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/ba685cd24411d05d2182dd99db218990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q9Yaelz9H0oDD-3EpbMlIQ.png"/></div></div></figure><p id="94bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是创建带有文本的自定义工具提示。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/8efc32dac8dd762d40309d624fcaa2e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XinAyWiLeUqoo7c2paTusQ.png"/></div></div></figure><p id="5cd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一小段代码格式化了我们的数据，使其对观众更具可读性。Saleprice 前面会有一个美元符号($)，四舍五入到小数点后两位。当你将鼠标悬停在地图上时，它会显示邮政编码和平均房屋销售价格。通过自定义的工具提示，你可以创建任何你想要的文本。</p><p id="650f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选定感兴趣的区域并准备好自定义工具提示后，我们可以从地理数据框创建一个. geojson 文件。</p><p id="f7e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是最终的求解步骤:</p><p id="f4e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步也是最后一步，是将 choropleth 贴图覆盖在 map 对象上。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ku"><img src="../Images/fd31648bd55b921a9f8f5aaf6e497207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_3X1T0qcTtTh-4I-DM5CA.png"/></div></div></figure><p id="59dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是最终结果，一个交互式 choropleth 地图，显示了华盛顿州金县每个邮政编码区的平均房屋销售价格。</p><figure class="ki kj kk kl fd km"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="8dce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这篇博客会对你有用，并为你未来的项目节省一些时间。</p></div></div>    
</body>
</html>