<html>
<head>
<title>Publish a Python Package like a Pro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像专业人士一样发布Python包</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/publish-a-python-package-like-a-pro-bbda96e68bfb?source=collection_archive---------14-----------------------#2020-12-22">https://medium.com/analytics-vidhya/publish-a-python-package-like-a-pro-bbda96e68bfb?source=collection_archive---------14-----------------------#2020-12-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/95999c7495979f84c52eafaa99214fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/0*Mk7RzHQa-d12UI4H.jpg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">来源:-<a class="ae iq" href="https://memegenerator.net/instance/74177282/disaster-girl-they-said-they-wanted-python-i-showed-them-pip-install" rel="noopener ugc nofollow" target="_blank">https://meme generator . net/instance/74177282/disaster-girl-they-said-they-wanted-python-I-show-them-pip-install</a></figcaption></figure><p id="e600" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果你在Pythoneer/Pythonista或者至少熟悉python，你会遇到单词<strong class="it hj"> PIP </strong>，因为这是一个重要的工具，我们将使用它来安装一个包以导入程序中的任何包。你有没有想过创建你的包或想知道这个过程是如何工作的，然后你来了一个完美的地方？这篇文章演示了您的一步一步的过程，因此您可以在阅读完这篇文章后立即发布您的包。</p><h1 id="8dbc" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">在PIP中发布python包的步骤:- </strong></h1><ol class=""><li id="3f72" class="kn ko hi it b iu kp iy kq jc kr jg ks jk kt jo ku kv kw kx bi translated">首先，您需要创建一个想要作为包发布的python脚本。例如，在我的例子中，我正在创建一个简单的脚本，它将返回一条欢迎消息。这是我想发表的以下脚本。</li></ol><figure class="ky kz la lb fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="2504" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">2.这个文件应该保存为<packagename> .py。在我的例子中，我的包名是welcomesample，所以上面的脚本应该保存为<strong class="it hj"><em class="le">welcome sample . py .</em></strong></packagename></p><p id="c80d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">3.现在创建一个新文件夹，并保持它的名称与包名相同。</p><p id="72dd" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">4.现在，在项目文件夹中创建一个名为“src”的子文件夹，并移动上述脚本所需的所有程序和文件。</p><p id="f50d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">5.现在用下面的脚本创建一个setup.py文件。</p><figure class="ky kz la lb fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="8b75" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在上面的脚本中，setup()文件具有以下属性。</p><ul class=""><li id="864d" class="kn ko hi it b iu iv iy iz jc lf jg lg jk lh jo li kv kw kx bi translated"><strong class="it hj">名称</strong>是您的软件包的<em class="le">发行名称</em>。这可以是任何名称，只要仅包含字母、数字、<code class="du lj lk ll lm b">_</code>和<code class="du lj lk ll lm b">-</code>。它也不能已经采取了pypi.org。<strong class="it hj">请务必使用您的用户名进行更新，</strong>这样可以确保您在上传软件包时不会试图上传与已有软件包同名的软件包。在我的例子中，name属性值是</li><li id="9d9d" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj">版本</strong>是包的版本号。如果是第一个版本，您可以指定0.0.1。它应该为包中的每个更新而更新。</li><li id="6a1f" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj">作者</strong>是指发布这个包的作者的名字。</li><li id="d8a6" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj"> author_email </strong>指作者的邮件。这个字段是可选的，但是很重要。</li><li id="7c0c" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj">描述</strong>指对包装的简短描述，通常为10到25个字。</li><li id="c873" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj"> long_description </strong>指的是软件包的文档，通常以降价文件的形式给出，这将在下一步中深入讨论。</li><li id="683c" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj"> url </strong>指的是包的源代码。它可以是可选的，但很重要。通常，我们可以把包的Github库URL。</li><li id="0aff" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj">包</strong>是指<a class="ae iq" href="https://packaging.python.org/glossary/#term-Distribution-Package" rel="noopener ugc nofollow" target="_blank">分发包</a>中应该包含的所有Python <a class="ae iq" href="https://packaging.python.org/glossary/#term-Import-Package" rel="noopener ugc nofollow" target="_blank">导入包</a>的列表。我们可以使用<code class="du lj lk ll lm b">find_packages()</code>来自动发现所有的包和子包，而不是手动列出每个包。</li><li id="d03c" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj">分类器</strong>用于在PyPI过滤器领域对我们的项目进行分类。如果你想了解更多关于分类器的信息，你可以点击<a class="ae iq" href="https://pypi.org/classifiers/" rel="noopener ugc nofollow" target="_blank">链接</a>。</li><li id="1524" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj"> python_requires </strong>用于指定你的包使用哪个python版本。为此，您需要手动检查并填写该字段。</li><li id="649b" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj"> py_module </strong>指的是包名。这是强制性的。</li><li id="b3ca" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo li kv kw kx bi translated"><strong class="it hj"> package_dir </strong>是指src文件路径。这是强制性的。</li></ul><p id="3284" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">6.创建setup.py文件后，您需要创建一个README.md markdown文件来编写软件包的文档。它应该包含关于包的简短描述，如何使用这个包等细节。例如，您的README.md可能如下所示</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="9df0" class="lw jq hi lm b fi lx ly l lz ma"># WelcomeSample</span><span id="d15a" class="lw jq hi lm b fi mb ly l lz ma">This is a welcome package which prints a welcome message</span></pre><p id="0af1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">README.md文件的输出如下所示。</p><figure class="ky kz la lb fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="b54e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">7.创建一个名为Licence的许可证文件。上传到Python包索引的每个包都必须包含一个许可证，这一点很重要。寻找许可证模板的最好方法是从GitHub中选择一个许可证模板，或者从https://choosealicense.com/选择一个。例如，如果您选择MIT许可证格式，那么您的许可证将如下所示</p><figure class="ky kz la lb fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="8186" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">8.完成上述步骤后，目录结构看起来与下图相似。请检查您的包目录看起来是否相似。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="5fa1" class="lw jq hi lm b fi lx ly l lz ma">tutorial<br/>├── LICENSE<br/>├── README.md<br/>├── WelcomeSample<br/>│   └── src<br/>       └── welcomesample.py<br/>├── setup.py<br/></span></pre><p id="75ca" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">9.现在您需要为您需要创建的包生成分发归档文件。这些档案帮助我们在任何操作系统中安装我们的软件包。为此，您需要在CMD中运行以下命令来安装wheel和setuptools。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="ee47" class="lw jq hi lm b fi lx ly l lz ma">python -m pip install --user --upgrade setuptools wheel</span></pre><p id="b007" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">10.成功安装以上软件包后，现在您需要运行以下命令来生成归档文件(。gz)和车轮文件(。对于您要创建的包。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="b0b2" class="lw jq hi lm b fi lx ly l lz ma">python setup.py sdist bdist_wheel</span></pre><p id="5c1e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">上述命令的输出将在您的工作包目录中生成两个目录，即dist和build。如果你检查文件夹，你可以看到2个文件，即车轮。whl)和源归档文件(。gz)文件。这些对于发布您的包非常重要。目录结构如下所示</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="7d20" class="lw jq hi lm b fi lx ly l lz ma">tutorial<br/>├── build<br/>├── dist<br/>      ├── welcomesample-0.0.1.tar.gz <br/>      ├── welcomesample-0.0.1-py3-none-any.whl<br/>├── LICENSE<br/>├── README.md<br/>├── WelcomeSample<br/>│   └── src<br/>       └── welcomesample.py<br/>├── setup.py</span></pre><p id="8cd8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们需要wheel和源档案文件的原因是，较新的pip版本支持wheel构建的发行版，但如果需要的话，将会退回到源档案。如果我们包含这两个文件，那么我们的包可以安装在任何平台上。</p><p id="009d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">11.现在我们可以使用下面的命令在系统中本地安装这个包。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="8832" class="lw jq hi lm b fi lx ly l lz ma">pip install -e .</span></pre><p id="45e0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">12.我们可以通过编写以下代码并运行它，在您的IDE中本地测试该包。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="7e9c" class="lw jq hi lm b fi lx ly l lz ma">import welcomesample<br/>print(welcomesample.welcome())</span></pre><p id="3258" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">上面代码的输出如下所示。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mc"><img src="../Images/4aefa856843e0dfc3f4b21c35cd60d17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z8XQyu0n1vxweb1LOwe68w.png"/></div></div></figure><p id="c6a1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">万岁！它工作正常😎。</p><p id="ab72" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">13.现在是时候将代码交付给<strong class="it hj"> PyPI </strong>了。在此之前，你需要先发布你的代码来测试<strong class="it hj"> </strong> PyPI。Test PyPI 是一个类似于PyPI的平台，用于实验和测试目的。您需要在以下网站注册才能继续。</p><div class="mh mi ez fb mj mk"><a href="https://test.pypi.org/account/register/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">创建一个帐户</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">跳到您正在使用的主要内容TestPyPI——Python包索引的一个独立实例，它允许您尝试…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">test.pypi.org</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my ik mk"/></div></div></a></div><div class="mh mi ez fb mj mk"><a href="https://pypi.org/account/register/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">创建一个帐户</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">Python包索引(PyPI)是Python编程语言的软件仓库。</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">pypi.org</p></div></div><div class="mt l"><div class="mz l mv mw mx mt my ik mk"/></div></div></a></div><p id="103f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">14.在2个平台上创建帐户后，我们需要安装一个包裹绳来帮助运输包裹。为此，您需要在CMD中运行以下命令。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="5bfb" class="lw jq hi lm b fi lx ly l lz ma">python -m pip install --user --upgrade twine</span></pre><p id="619b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">一旦安装了twine包，您就需要运行下面的命令来发布测试PyPI的代码。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="62cc" class="lw jq hi lm b fi lx ly l lz ma">python -m twine upload --repository testpypi dist/*</span></pre><p id="f935" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">当我们运行上述命令时，它会要求您输入用户名和密码。输入我们在Test PyPI中注册帐户的凭据。一旦我们输入这些凭证，您的包就成功地安装在测试PyPI中。上述命令的输出如下所示。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es na"><img src="../Images/13ad07d5f2112c2d7c0e1d5cc573e64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PIrE9naGsoaOdEKl6vepmw.png"/></div></div></figure><p id="ace6" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">15.现在我们可以访问给定的链接来检查包。现在我们的包正式发布在Test PyPI中。我们可以通过从给定的网页链接中获取命令，在任何系统中测试这个发布的包。在这种情况下，网页看起来像</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nb"><img src="../Images/71ec19c715b6c51511267997cb44e457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-AQqqJAqBHF2GtIT0pffQ.png"/></div></div></figure><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="2ebf" class="lw jq hi lm b fi lx ly l lz ma">pip install -i https://test.pypi.org/simple/ welcomesample==0.0.1</span></pre><p id="6ae6" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">通过使用网页上的上述命令，我们可以很容易地将其安装在任何系统中。<strong class="it hj">但请记住这只是为了测试目的。</strong></p><p id="4cc0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">16.一旦我们成功地安装了来自测试版PyPI的包，下一步就是在PyPI中为最终用户发布这个包。在发布之前，我们需要检查我们的包是否工作正常，然后继续下一步。</p><p id="56f1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">17.现在我们需要在CMD中运行下面的命令来将它发布到PyPI。</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="6189" class="lw jq hi lm b fi lx ly l lz ma">python -m twine upload dist/*</span></pre><p id="e4e5" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">当我们运行上述命令时，它会要求输入用户名和密码。我们需要输入在PyPI中注册帐户的凭证。一旦我们输入这些凭证，我们的包就成功地安装在PyPI中了。完成了，我们实现了🤩。上面代码的输出如下所示。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nc"><img src="../Images/db7a94c422049c33537b342f4639e4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gYALZ1Fd7Rsikppstie9xw.png"/></div></div></figure><p id="e0b2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，您可以访问CMD中的给定链接，在PyPI中查看您的包页面。在我的例子中，它看起来像这样</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nb"><img src="../Images/793ec1cd456a94311bd5961964f54ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ipqlX_P6WZgdblwEgdK9w.png"/></div></div></figure><h2 id="5fd9" class="lw jq hi bd jr nd ne nf jv ng nh ni jz jc nj nk kd jg nl nm kh jk nn no kl np bi translated"><strong class="ak">现在你可以像专业人士一样发布任何python包。</strong></h2><p id="0df4" class="pw-post-body-paragraph ir is hi it b iu kp iw ix iy kq ja jb jc nq je jf jg nr ji jj jk ns jm jn jo hb bi translated">您可以使用pip命令在任何系统中安装这个软件包。对我来说是的</p><pre class="ky kz la lb fd ls lm lt lu aw lv bi"><span id="8aff" class="lw jq hi lm b fi lx ly l lz ma">pip install welcomesample==0.0.1</span></pre><h1 id="b08f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">一些重要提示:-</h1><ol class=""><li id="d888" class="kn ko hi it b iu kp iy kq jc kr jg ks jk kt jo ku kv kw kx bi translated">当您想要更新您的python包时，请确保您增加了版本号，否则它可能会在过程中引发错误。</li><li id="50d8" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo ku kv kw kx bi translated">当你想发布任何包时，确保你在https://pypi.org/的<a class="ae iq" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank">中检查是否存在任何带有你的包的包名。如果是这样，请确保将其更改为另一个并开始发布。</a></li><li id="bcf8" class="kn ko hi it b iu ln iy lo jc lp jg lq jk lr jo ku kv kw kx bi translated">当您想要更新python包时，请确保删除dist文件夹中的分发存档文件，并重复相同的过程进行发布。</li></ol><p id="a1b5" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这样，我们可以像专业人士一样轻松地将任何python脚本发布为一个包。</p><h1 id="277b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">参考资料:-</h1><div class="mh mi ez fb mj mk"><a href="https://packaging.python.org/tutorials/packaging-projects/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">打包Python项目——Python打包用户指南</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">本教程将带您了解如何打包一个简单的Python项目。它将向您展示如何添加必要的文件…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">packaging.python.org</p></div></div></div></a></div></div></div>    
</body>
</html>