<html>
<head>
<title>Text Analytics in Cloud — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">云中的文本分析—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/text-analytics-in-cloud-part-1-e0467d5034d?source=collection_archive---------21-----------------------#2020-04-16">https://medium.com/analytics-vidhya/text-analytics-in-cloud-part-1-e0467d5034d?source=collection_archive---------21-----------------------#2020-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5760" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Google云功能将数据提取到云存储中</p><p id="5449" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为我最近一个项目的一部分，我正在处理文本。精确的宗教文本。</p><p id="c0c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们对几个问题很好奇</p><ul class=""><li id="65d7" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">亚伯拉罕前宗教和亚伯拉罕宗教的区别</li><li id="7314" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">按宗教划分的地理/人口统计</li><li id="5fc8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">不同的宗教书籍同意/不同意什么？</li><li id="ce32" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">文本主题随时间的演变/语气/语言/概念的变化</li><li id="c56b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">利用文本分析/词向量在不同的书中搜索相似的观点，比较和对比它们。</li></ul><p id="eb8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们决定从<a class="ae jr" href="https://www.gutenberg.org/" rel="noopener ugc nofollow" target="_blank">项目Gutenberg </a>中提取书籍，将其加载到Google云存储中，使用Apache beam和云数据流对文本进行预处理和注释，然后使用Python进行分析。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/b4a26bfe9b1e567682059c78ac55a592.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*127irEqurK4eReTI6uLM2A.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">体系结构</figcaption></figure><p id="27f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以在这里关注代码<a class="ae jr" href="https://github.com/abhijeetdtu/dsba6155project" rel="noopener ugc nofollow" target="_blank"> @ github </a></p><p id="4908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文主要关注上图最左边的部分——获取数据，在其他文章中，我们将继续这个过程。</p><p id="2973" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">获取数据</strong></p><p id="0237" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个过程的第一步是获取数据。为此，我们创建了一个python脚本，它使用<a class="ae jr" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>请求从古腾堡项目下载书籍，并将其保存到云存储中。</p><p id="562e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里重要的一点是如何与谷歌云互动。</p><p id="d833" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，google cloud希望您的云功能如下所示</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ki"><img src="../Images/df833be1c427b8b39fe9044c5f5a6a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*lXP9y845Cs5q07IizTF_kQ.png"/></div></figure><ol class=""><li id="75d9" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc kj jj jk jl bi translated">应该有一个main.py文件—包含实际代码</li><li id="fa91" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kj jj jk jl bi translated">应该有一个requirements.txt，其中包含所有指定的依赖项。</li></ol><p id="7ec1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后你可以压缩这个文件夹并提供给云函数。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kk"><img src="../Images/1d846973f6d20c30de5c9da5536bc4b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RaXF-m3lymCyg5zcH6eg2Q.png"/></div></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kl"><img src="../Images/6448dfb5697c4e6532525d7803acb9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j1fKOwJ7zbTomA47FlqBWQ.png"/></div></div></figure><p id="64e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们的用例，我们利用了<a class="ae jr" href="https://github.com/hashicorp/terraform" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> terraform </strong> </a>，而不是手动完成。</p><p id="cadf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了创建zip文件，我们使用了<strong class="ih hj"> null_resource </strong>，它在后台利用powershell命令来压缩文件夹。</p><p id="55d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在您可以看到的第二个图像中，第一个资源上传了。第二个资源使用上传的zip文件创建云函数。</p><p id="e811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意，在第二个资源中，我们指定了入口点</strong></p><p id="0218" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个入口点是main.py中由云函数调用的函数。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es km"><img src="../Images/30a1e3a96c855920a75f92abb174a65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0pCHvLLncbWwYejmAZMf1Q.png"/></div></div></figure><p id="43e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际的函数在main.py中</p><p id="5120" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kn"> getbooks函数</em>将请求作为输入，解析参数，然后调用自定义代码获取文件并上传到google云存储。</p><p id="2b90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦创建了函数，我们就可以使用url如下调用它</p><p id="ec04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jr" href="https://us-east1-dsba6155p.cloudfunctions.net/data_pull_cloud_func?query=hinduism&amp;bucket=dsba6155pdatabucket&amp;folder=download" rel="noopener ugc nofollow" target="_blank">https://URL _ TO _ YOUR _ CLOUD _ function . CLOUD functions . net/data _ pull _ CLOUD _ func？<strong class="ih hj">query =印度教&amp;bucket = dsba 6155 pdatabucket&amp;folder =下载</strong>T3】</a></p><p id="19f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查询、桶和文件夹是我们上面定义的函数所期望的参数。</p><p id="7256" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意事项</strong></p><p id="6876" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">需要注意的几个问题</p><ol class=""><li id="c3e7" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc kj jj jk jl bi translated">云函数有只读文件系统，所以你不能随便写文件。它必须在<strong class="ih hj"> /tmp/文件夹</strong>中</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ko"><img src="../Images/7bffbe23dda164a73738f47d3dba3b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyUQDrBghQPiR4x27dIFZg.png"/></div></div></figure><p id="bded" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.对于使用google cloud的身份验证，您应该设置环境变量GOOGLE_APPLICATION_CREDENTIALS，指向服务主体密钥文件。<a class="ae jr" href="https://cloud.google.com/iam/docs/creating-managing-service-accounts" rel="noopener ugc nofollow" target="_blank">创建服务帐户</a></p></div></div>    
</body>
</html>