<html>
<head>
<title>Deep intuition and things behind the ROC Curve and Area Under ROC Curve(AUC)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ROCæ›²çº¿å’ŒROCæ›²çº¿ä¸‹é¢ç§¯(AUC)èƒŒåçš„æ·±å±‚ç›´è§‰å’Œäº‹ç‰©</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/deep-intuition-and-things-behind-the-roc-curve-and-area-under-roc-curve-auc-894337d96ed?source=collection_archive---------6-----------------------#2020-12-11">https://medium.com/analytics-vidhya/deep-intuition-and-things-behind-the-roc-curve-and-area-under-roc-curve-auc-894337d96ed?source=collection_archive---------6-----------------------#2020-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/7ef7c069a72936b0526ece09f37a6021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*DxDTOQyPkSXy1_xQuPbG7Q.png"/></div></figure><p id="2a52" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿™ç¯‡åšå®¢æ˜¯<a class="ae jk" rel="noopener" href="/analytics-vidhya/evaluating-metrics-for-classification-machine-learning-models-learners-at-medium-level-c956a8b8d889">è¿™ç¯‡æ–‡ç« </a>çš„å»¶ç»­ã€‚</p><p id="c864" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨ï¼Œæˆ‘å‡è®¾ä½ çŸ¥é“æ··æ·†çŸ©é˜µã€å‡†ç¡®åº¦ã€ç²¾ç¡®åº¦ã€å›å¿†å’ŒF1åˆ†æ•°ã€‚</p><p id="dbd5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘å†æ¬¡é‡ç”³ï¼Œåœ¨å­¦ä¹ è¿™äº›æŒ‡æ ‡ä¹‹å‰ï¼Œæ‚¨éœ€è¦äº†è§£å¦‚ä½•æ„å»ºåˆ†ç±»æ¨¡å‹ã€‚</p><p id="9ff5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨ï¼Œæˆ‘å°†ä¸ºæ‚¨æ„å»ºä¸€ä¸ªæ¨¡å‹...</p><p id="4beb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è®©æˆ‘ä»¬ç”¨åŒæ ·çš„æ—§ä»£ç ç‰‡æ®µï¼Œ</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="8812" class="ju jv hi jq b fi jw jx l jy jz">import pandas as pd<br/>from sklearn.datasets import make_classification<br/>from sklearn.model_selection import train_test_splitfrom sklearn.tree import DecisionTreeClassifier</span><span id="d92a" class="ju jv hi jq b fi ka jx l jy jz">X,y = make_classification(n_samples=200,n_features=10,random_state=20)</span><span id="402d" class="ju jv hi jq b fi ka jx l jy jz">X_train,X_test,y_train,y_test = <br/>sklearn.model_selection.train_test_split(X,y,random_state = 43)</span><span id="39f3" class="ju jv hi jq b fi ka jx l jy jz">model = DecisionTreeClassifier()<br/>model.fit(X_train,y_train)</span></pre><p id="4273" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨ï¼Œä½ æœ‰ä¸€ä¸ªæ¨¡å‹ã€‚</p><p id="dcc4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ æ‰€ç†è§£çš„æ˜¯ï¼Œ<strong class="io hj">â€œå¦‚æœä½ çœ‹åˆ°ä¸€ä¸ªä¸å¹³è¡¡çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆä½ å¿…é¡»ä½¿ç”¨F1-Score(ç»“åˆäº†ç²¾ç¡®åº¦å’Œå¬å›ç‡)çš„æŒ‡æ ‡â€</strong>ã€‚</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="fb8c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">æ³¨æ„:- </strong>è¯·æµè§ˆæˆ‘ä»¥å‰å…³äºåˆ†ç±»æ ‡å‡†çš„åšå®¢ï¼Œä»¥äº†è§£ä¸‹é¢çš„äº‹æƒ…â€¦</p><p id="f751" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">åœ¨æ·±å…¥ç ”ç©¶ROC_AUCä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›ä¸œè¥¿ï¼Œå¦‚çœŸ+veç‡(TPR)ã€å‡+veç‡(FPR)ã€å‡é˜´æ€§ç‡(FNR)ã€çœŸ-veç‡(TNR)ã€çµæ•åº¦å’Œç‰¹å¼‚æ€§ã€‚</p><ol class=""><li id="5cc3" class="ki kj hi io b ip iq it iu ix kk jb kl jf km jj kn ko kp kq bi translated"><strong class="io hj">çœŸé˜³æ€§ç‡(TPR) </strong> :-çœŸ+veç‡ä¸Recallç›¸åŒï¼Œâ€œå®ƒæ˜¯é¢„æµ‹çš„+veå€¼è¢«æ­£ç¡®é¢„æµ‹ä¸º+veæ ·æœ¬çš„æ¯”ç‡â€</li></ol><p id="23dc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> TPR = TP / (TP + FN) </strong></p><p id="1099" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">çœŸé˜³æ€§ç‡ä¹Ÿå«<strong class="io hj">çµæ•åº¦ã€‚</strong></p><p id="2ea2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¦‚æœæ¨¡å‹çš„çµæ•åº¦é«˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥æœ‰æ•ˆåœ°é¢„æµ‹+veæ ·æœ¬ã€‚</p><p id="8e08" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.<strong class="io hj">çœŸé˜´æ€§ç‡:- </strong>çœŸé˜´æ€§ç‡æ˜¯é¢„æµ‹veå€¼ä½œä¸ºveæ ·æœ¬å¾—åˆ°æ­£ç¡®é¢„æµ‹çš„æ¯”ç‡ã€‚</p><p id="3134" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> TNR = TN / (TN + FP) </strong></p><p id="02dc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">çœŸé˜´æ€§ç‡ä¹Ÿå«<strong class="io hj">ç‰¹å¼‚æ€§ã€‚</strong></p><p id="5287" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¦‚æœæˆ‘ä»¬çš„æ¨¡å‹çš„ç‰¹å¼‚æ€§é«˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥æœ‰æ•ˆåœ°é¢„æµ‹æ ·æœ¬ã€‚</p><p id="6c4a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æ³¨æ„:-æ¯å½“æˆ‘ä»¬å»ºç«‹æˆ‘ä»¬çš„æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸€ç§çµæ•åº¦å’Œç‰¹å¼‚æ€§éå¸¸é«˜çš„æ–¹å¼æ¥è®¾è®¡æˆ‘ä»¬çš„æ¨¡å‹ã€‚</p><p id="ebe5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.<strong class="io hj">å‡é˜´æ€§ç‡(FNR):- </strong>å‡é˜´æ€§ç‡æ˜¯é˜³æ€§å€¼è¢«é”™è¯¯åœ°é¢„æµ‹ä¸ºé˜´æ€§æ ·æœ¬çš„æ¯”ç‡ã€‚</p><p id="d470" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> FNR = FN / (FN + TP) </strong></p><p id="80c9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿˜æœ‰ï¼Œ<strong class="io hj">(å‡-veç‡)+(çœŸ+veç‡)= 1 </strong></p><p id="7238" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å³<strong class="io hj"> FPR = (1-çµæ•åº¦)ã€‚</strong></p><p id="e33b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">4.<strong class="io hj">å‡é˜³æ€§ç‡(FPR):- </strong>å‡é˜³æ€§ç‡æ˜¯é˜´æ€§å€¼è¢«é”™è¯¯åœ°é¢„æµ‹ä¸ºé˜³æ€§æ ·æœ¬çš„æ¯”ç‡ã€‚</p><p id="1fca" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> FPR = FP / (FP + TN) </strong></p><p id="a486" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿˜æœ‰ï¼Œ<strong class="io hj">(å‡é˜³æ€§ç‡+çœŸé˜´æ€§ç‡)= 1 </strong></p><p id="2eed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å³<strong class="io hj">FPR =(1-ç‰¹å¼‚æ€§)ã€‚</strong></p><p id="7dfb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨ï¼Œä½ çŸ¥é“ä»€ä¹ˆæ˜¯TPRï¼ŒTNRï¼ŒFPRå’ŒFNRã€‚</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="0551" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¦‚æœä½ æ˜¯æœºå™¨å­¦ä¹ çš„åˆå­¦è€…ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡åšè¿™ä¸ªæ¥é¢„æµ‹è¯¾ç¨‹</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="febe" class="ju jv hi jq b fi jw jx l jy jz">y_pred = model.predict(X_test)</span></pre><p id="374f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å½“æˆ‘ä»¬ç¼–è¯‘ä¸Šé¢ä¸€è¡Œä»£ç æ—¶ï¼Œå°†ä¼šå‘ç”Ÿçš„æ˜¯ï¼Œ</p><p id="8fd5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">é¦–å…ˆï¼Œæ¨¡å‹å°†é¢„æµ‹æµ‹è¯•æ•°æ®ä¸ºæ­£çš„æ¦‚ç‡ã€‚ç„¶åï¼Œé€šè¿‡ä¸é˜ˆå€¼0.5è¿›è¡Œæ¯”è¾ƒï¼Œå³å¦‚æœprediction_probability &gt; 0.5ï¼Œåˆ™é¢„æµ‹çš„æµ‹è¯•æ ·æœ¬å°†è¢«ç§°ä¸º+veæ ·æœ¬ï¼Œå¦åˆ™ä¸ºè´Ÿã€‚å…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥åšå®é™…æ‰§è¡Œã€‚</p><p id="a2d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¯·å‚è§ä¸Šé¢çš„å®ç°ç¤ºä¾‹:</p><p id="9484" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘ä»¬æ¥æƒ³ä¸€ä¸ªæµ‹è¯•æ ·æœ¬ï¼ŒPredicted_probability = 0.68ã€‚ç„¶åï¼Œå°†è¿™ä¸ªæ¦‚ç‡ä¸é˜ˆå€¼= 0.5è¿›è¡Œæ¯”è¾ƒï¼Œå³ï¼Œåœ¨ä»£ç è¯­è¨€ä¸­ï¼Œ</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="0a6a" class="ju jv hi jq b fi jw jx l jy jz">if( Predicted_Probability &gt; 0.5) #0.5 is threshold <br/>{ <br/>    return 1;<br/>} <br/>else <br/>{ <br/>    return 0;<br/>}</span></pre><p id="6821" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">1 -&gt;æ­£</p><p id="d1af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">0-&gt;è´Ÿ</p><p id="c748" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿™é‡Œï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å°†é˜ˆå€¼è§†ä¸º(0.5)ã€‚å› æ­¤ï¼Œå½“é¢„æµ‹æ¦‚ç‡&gt; 0.5æ—¶ï¼Œå¦‚æœé¢„æµ‹æ¦‚ç‡&lt; 0.5, then the predicted test label will be 0. All these things will be automatically calculated by the model, and in y_pred, test labels will be appended.</p><p id="946a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">y_pred will be look like this[1, 0, 0, 1, 1, 1, 1, 0].</p><p id="26e4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">All the metrics that were discussed in the previous blog will be calculated through the above procedure only. The below complete code represents the above explanation.</p><p id="d9df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Read again, if you didnâ€™t understandâ€¦</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="8051" class="ju jv hi jq b fi jw jx l jy jz">import pandas as pd<br/>from sklearn.datasets import make_classification<br/>from sklearn.model_selection import train_test_splitfrom sklearn.tree import DecisionTreeClassifier</span><span id="36bf" class="ju jv hi jq b fi ka jx l jy jz">X,y = make_classification(n_samples=200,n_features=10,random_state=20)</span><span id="395f" class="ju jv hi jq b fi ka jx l jy jz">X_train,X_test,y_train,y_test = <br/>sklearn.model_selection.train_test_split(X,y,random_state = 43)</span><span id="9012" class="ju jv hi jq b fi ka jx l jy jz">model = DecisionTreeClassifier()<br/>model.fit(X_train,y_train)</span><span id="ab2f" class="ju jv hi jq b fi ka jx l jy jz">#this will be predicted with the threshold of 0.5 as explained above<br/>y_pred = model.predict(y_test)</span><span id="59b3" class="ju jv hi jq b fi ka jx l jy jz">#y_pred will be look like[1, 0, 0, 1, 1, 1, 1, 0]<br/>accuracy_score = sklearn.metrics.accuracy_score(y_true,y_pred)</span></pre><p id="9ee3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Now, weâ€™ll see another type of prediction in order to understand the ROC_AUCâ€¦</p><p id="eae6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Till now, what youâ€™ve studied is a type of prediction method which you won't use much in implementing real-time applications. Now, weâ€™ll discuss a method of predicting, which will be used in real-world problem-solving.</p><p id="68fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">The method is simple. As we consider the default threshold as 0.5, manually weâ€™ll predict the probabilities of test samples and then, weâ€™ll consider a threshold in such a way that our metric will give high accuracy.</p><p id="ca38" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Note:- From now, you should not use model.predict() function, see the below function and you should use it now.</p><p id="a45e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">the function is,</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="4a7c" class="ju jv hi jq b fi jw jx l jy jz">model.predict_proba(X_test)</span></pre><p id="1637" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">the above function will predict the probabilities of test samples to be positive. The higher the value, the higher the chance that the test sample to be +Ve.</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="f139" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> ROC_AUCå¾—åˆ†:- </strong> ROC_AUCå¾—åˆ†ä»…ä»…æ˜¯ROCæ›²çº¿çš„é¢ç§¯ï¼Œåˆ™é¢„æµ‹æµ‹è¯•æ ‡ç­¾å°†ä¸º1ï¼Œè€ŒROCæ›²çº¿å°†æ ¹æ®ä¸åŒçš„é˜ˆå€¼é€šè¿‡ä½¿ç”¨ä¸åŒçš„TPRå’ŒFPRæ¥æ„å»ºã€‚</p><p id="1d0d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ·±å…¥ROC_AUCåˆ†æ•°:-</p><ol class=""><li id="4376" class="ki kj hi io b ip iq it iu ix kk jb kl jf km jj kn ko kp kq bi translated">è€ƒè™‘ä¸€ç»„é˜ˆå€¼ï¼Œæ¯”å¦‚è¯´ï¼Œ[0.1ï¼Œ0.2ï¼Œ0.3ï¼Œ0.4ï¼Œ0.5ï¼Œ0.6ï¼Œ0.7ï¼Œ0.8ï¼Œ0.9ï¼Œ1.0]ã€‚</li></ol><p id="f6a2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†æµ‹è¯•æ ·æœ¬é¢„æµ‹æ¦‚ç‡ä¸æ¯ä¸ªé˜ˆå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶é¢„æµ‹ç¦»æ•£å€¼ï¼Œå³0æˆ–1ã€‚</p><p id="3c89" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æ ¹æ®é¢„æµ‹çš„ç¦»æ•£å€¼ï¼Œå¯ä»¥è®¡ç®—å‡ºçœŸ+Veç‡ã€å‡+Veç‡ã€‚</p><p id="367b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¯·å‚è§ä¸‹é¢çš„ä¸Šè¿°è¦ç‚¹å®ç°â€¦</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="2d1f" class="ju jv hi jq b fi jw jx l jy jz">model = sklearn.linear_model.LogisticRegression()   model.fit(X_train.values,y_train.values)</span><span id="ea63" class="ju jv hi jq b fi ka jx l jy jz">y_prob = model.predict_proba(X_test.values)             print(y_prob)</span><span id="d5a9" class="ju jv hi jq b fi ka jx l jy jz">tpr = []<br/>fpr = []</span><span id="01ed" class="ju jv hi jq b fi ka jx l jy jz">for i in threshold_list:<br/>   k = y_prob[:,1] &gt; i<br/>   j = []<br/>   for i in k:<br/>      j.append(int(i)<br/>   tp = true_positive(y_test,j)<br/>   fp = false_positive(y_test,j)<br/>   tn = true_negative(y_test,j)<br/>   fn = false_negative(y_test,j)<br/>   tpr.append(tp/(tp+fn))<br/>   fpr.append(fp/(fp+tn))</span><span id="3104" class="ju jv hi jq b fi ka jx l jy jz">data = list(zip(tpr,fpr))<br/>dataset = pandas.DataFrame(data,columns = ["tpr","fpr"])<br/>print(dataset.values)</span></pre><p id="dd2c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ä¸Šé¢çš„ä»£ç å°†ç»™å‡ºå¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡º</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kr"><img src="../Images/77f41f2fc42c16787002f8c5b7060c00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4zuUzHAT9Zap2IEqS7dQQ.png"/></div></div></figure><p id="569e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">åœ¨è¾“å‡ºä¸­ï¼Œå·¦è¾¹çš„å€¼ä»£è¡¨TPRï¼Œå³è¾¹çš„å€¼ä»£è¡¨FPR</p><p id="5837" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘ä¸Šé¢è€ƒè™‘çš„æ•°æ®é›†åªæ˜¯ç”¨æ¥æ˜¾ç¤ºFPR &amp; TPRå°†å¦‚ä½•è®¡ç®—ï¼Œä¸è¦ä¸ºæ•°æ®é›†è€Œçƒ¦æ¼ã€‚åªéœ€å…³æ³¨FPRå’ŒTPRæ˜¯å¦‚ä½•è®¡ç®—çš„(ä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æ•°æ®é›†<a class="ae jk" href="https://github.com/vishnu2136/Datasets_for_Problem_Statements/blob/master/p3%20-%20loan%20prediction/modified.csv" rel="noopener ugc nofollow" target="_blank"/>)ã€‚</p><p id="53a0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.ç°åœ¨ï¼Œåœ¨TPRså’ŒFPRsçš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å°†ç»˜åˆ¶ä¸€ä¸ªç§°ä¸ºROCæ›²çº¿çš„å›¾è¡¨ï¼Œè¿™æ˜¯æˆ‘ä»¬é’ˆå¯¹ä¸åŒé˜ˆå€¼è®¡ç®—çš„ã€‚</p><p id="d42d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å‚è§ä¸‹é¢çš„ä»£ç å’Œè¾“å‡ºï¼Œ</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="0cd4" class="ju jv hi jq b fi jw jx l jy jz">plt.figure(figsize = (7,7))<br/>plt.fill_between(dataset.fpr.values,dataset.tpr.values, alpha=0.4)<br/>plt.plot(dataset.fpr.values,dataset.tpr.values,lw = 2)<br/>plt.title("ROC_AUC CURVE")<br/>plt.xlim(0,1.0)<br/>plt.ylim(0,1.0)<br/>plt.xlabel("fpr",fontsize = 16)<br/>plt.ylabel("tpr",fontsize = 16)<br/>plt.show()</span></pre><p id="53b2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ä»£ç çš„è¾“å‡ºæ˜¯ä¸€ä¸ªROCæ›²çº¿ï¼Œè§ä¸‹å›¾</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kw"><img src="../Images/ee171de6c60da93b6af1d99331472140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xfkTLfOSPgDGfdJXPVMnA.png"/></div></div></figure><p id="cc26" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ä¸è¦ä¸ºæ›²çº¿è€Œçƒ¦æ¼ï¼Œåªè¦ä¸“æ³¨äºå¦‚ä½•ç»˜åˆ¶ROCæ›²çº¿ã€‚åœ¨å»ºæ¨¡ä¹‹å‰ï¼Œæˆ‘æ²¡æœ‰å¯¹æ•°æ®åšå¤ªå¤šé¢„å¤„ç†ã€‚æ‰€ä»¥ï¼Œæ›²çº¿ä¸å¤Ÿå¥½ã€‚</p><p id="ace6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºå›¾ä¸­è“è‰²åŒºåŸŸçš„é¢ç§¯ï¼Œè¿™ä¸ªé¢ç§¯å«åšROC  <strong class="io hj">æ›²çº¿</strong>çš„<strong class="io hj">é¢ç§¯ï¼Œä¹Ÿå«<strong class="io hj">æ›²çº¿ä¸‹é¢ç§¯(AUC)ã€‚</strong></strong></p><p id="1bbd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ä¸ºäº†è®¡ç®—æ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥çº¿æ€§ä»£æ•°ã€ç§¯åˆ†å’Œè®¸å¤šæ•°å­¦æ¡†æ¶ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦æ·±å…¥ç ”ç©¶å®ƒä»¬ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨sklearnè®¡ç®—é¢ç§¯ï¼Œè¿™æ ·ä¼šç»™å‡ºAUC(æ›²çº¿ä¸‹é¢ç§¯)ã€‚</p><p id="f885" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿™ä¸ªAUCæ˜¯æœºå™¨å­¦ä¹ ä¸­å¯¹äºå€¾æ–œç›®æ ‡æœ€æµè¡Œçš„åº¦é‡ä¹‹ä¸€ã€‚</p><p id="1905" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹è®¡ç®—è¿™ä¸ªé¢ç§¯çš„ä»£ç (åªæœ‰ä¸€è¡ŒğŸ˜‰):-</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="8d81" class="ju jv hi jq b fi jw jx l jy jz">print(sklearn.metrics.roc_auc_score(y_test,y_prob[:,1]))</span></pre><p id="09db" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è¿™å°†ç»™å‡ºæ›²çº¿ä¸‹é¢ç§¯çš„è¾“å‡ºï¼Œå¦‚ä¸‹æ‰€ç¤º:-</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kx"><img src="../Images/880b79356e4dfafecf9b93450051c4bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wi5m_C4IlGxlFPXwohodyQ.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">AUCåˆ†æ•°</figcaption></figure><p id="81fd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">AUCåˆ†æ•°å°†åœ¨0å’Œ1ä¹‹é—´ã€‚å¦‚æœAUCåˆ†æ•°æ¥è¿‘1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼€å‘çš„æ¨¡å‹æ˜¯å¯ä»¥ä¸ºæ‰€è€ƒè™‘çš„æ•°æ®é›†å¼€å‘çš„æœ€ä½³æ¨¡å‹ä¹‹ä¸€(ä¹Ÿæœ‰å¯èƒ½è¿‡åº¦æ‹Ÿåˆï¼Œå¯¹æ­¤è¦å°å¿ƒ)ã€‚å¦‚æœAUCè¯„åˆ†æ¥è¿‘0ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ¨¡å‹æ¯”éšæœºçŒœæµ‹è¿˜è¦å·®ã€‚</p><p id="7bcc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¦‚æœæˆ‘ä»¬çš„æ¨¡å‹ç»™å‡ºçš„åˆ†æ•°= 0.5ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ¨¡å‹å°±æ˜¯å¹¼ç¨šæ¨¡å‹ã€‚</p><p id="5d91" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">å¤§æ³¨:- </strong></p><p id="2f11" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ROCæ›²çº¿ç”¨äºå¦ä¸€ä¸ªç›®çš„ã€‚ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸åŒçš„é˜ˆå€¼ï¼Œäº§ç”Ÿä¸åŒçš„ç¦»æ•£é¢„æµ‹ï¼Œäº§ç”Ÿä¸åŒçš„TPRå’ŒFPRã€‚ä½†æ˜¯ï¼Œåœ¨å¼€å‘å·¥ä¸šåº”ç”¨æ—¶ï¼Œç‰¹å®šçš„é˜ˆå€¼å€¼å°†ç”±é¡¹ç›®é¢†åŸŸä¸“ä¸šäººå‘˜é€‰æ‹©ï¼Œä»¥è¿™ç§æ–¹å¼ï¼Œæ— è®ºä»–ä»¬æƒ³è¦é«˜TPRè¿˜æ˜¯ä½TPRï¼Œé«˜FPRè¿˜æ˜¯ä½FPRï¼Œæ ¹æ®è¿™ä¸€ç‚¹ï¼Œé˜ˆå€¼å°†è¢«é€‰æ‹©ã€‚ä»…åœ¨è¯¥é˜ˆå€¼çš„å¸®åŠ©ä¸‹ï¼Œå°†æ ¹æ®é¢„æµ‹çš„æ¦‚ç‡è¿›è¡Œç¦»æ•£å€¼é¢„æµ‹ã€‚è¿™äº›é¢„æµ‹å’ŒæŒ‡æ ‡å°†ä¼šå¾—åˆ°åº”ç”¨ã€‚</p><p id="7fc9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">ç”±äºæˆ‘ä»¬æ˜¯æœºå™¨å­¦ä¹ çš„åˆå­¦è€…ï¼Œæˆ‘ä»¬å°†ä»¥TPRå’ŒFPRéƒ½è¾¾åˆ°å¹³è¡¡çš„æ–¹å¼æ¥é€‰æ‹©é˜ˆå€¼ã€‚ä»»ä½•ROCæ›²çº¿å·¦ä¸Šè§’çš„å€¼å°†ç»™å‡ºä¸€ä¸ªå¹³è¡¡çš„é˜ˆå€¼ã€‚</p><p id="70ed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">æˆ‘è§‰å¾—è¿™éƒ½æ˜¯å…³äºROC_AUCè¯„åˆ†çš„â€¦</p><p id="cdbb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¦‚æœæœ‰ä»€ä¹ˆéœ€è¦è¡¥å……çš„ï¼Œè®©æˆ‘çŸ¥é“â€¦</p><p id="8685" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">è”ç³»æˆ‘è¿™é‡Œ:-<a class="ae jk" href="https://www.linkedin.com/in/vishnu-vardhan-varapalli-b6b454150/" rel="noopener ugc nofollow" target="_blank">https://www . LinkedIn . com/in/Vishnu-vard Han-vara palli-b6b 454150/</a></p><p id="b4fd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">å¿«ä¹çš„LearningâœŒï¼ï¼</p></div></div>    
</body>
</html>