<html>
<head>
<title>A Take on H.O.G Feature Descriptor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">采用H.O.G特征描述符</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-take-on-h-o-g-feature-descriptor-e839ebba1e52?source=collection_archive---------0-----------------------#2019-03-05">https://medium.com/analytics-vidhya/a-take-on-h-o-g-feature-descriptor-e839ebba1e52?source=collection_archive---------0-----------------------#2019-03-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="2b53" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">方向梯度直方图特征描述符的一种解释</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/5af64e7945c41ba80063c617f20eedc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QeqA67WnAUCJ2FQc"/></div></div></figure><p id="906e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">人脸识别是机器学习领域最受欢迎的技术之一。在这样的系统中有两个阶段:人脸检测和人脸识别。</p><p id="9b5c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最初，使用图像上的Haar级联分类器结合面部的基本部分的裁剪来检测面部。利用使用Haar级联分类器执行的眼睛检测来形成几何人脸模型，而鼻子检测已经与眼睛一起被用作确认机制。</p><p id="a069" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">之后，从大量人脸图像中提取HOG特征，作为识别机制的一部分。然后，将这些HOG特征一起标记给人脸/用户，并训练支持向量机(SVM)模型来预测输入系统的人脸。</p><p id="3228" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">H.O.G(梯度方向直方图)是计算机视觉中使用的特征描述符，用于目标检测的图像处理。在Navneet Dalal和Bill Triggs于2005年发表了一篇名为<a class="ae kf" href="https://lear.inrialpes.fr/people/triggs/pubs/Dalal-cvpr05.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="kg">用于人体检测的梯度方向直方图</em> </a> <em class="kg">的论文后，这一技术得到了发展。</em>在深度学习时代之前，这是进行对象检测的强大而先进的方式。猪因其在行人检测中的应用而广为人知。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="01e6" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated"><strong class="ak">直觉</strong></h1><p id="1e3c" class="pw-post-body-paragraph jj jk hi jl b jm lg ij jo jp lh im jr js li ju jv jw lj jy jz ka lk kc kd ke hb bi translated">在了解H.O.G的工作原理之前，让我们先了解一下在这种情况下什么是梯度。以下面的图像为例:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ll"><img src="../Images/1e58909a53e7378b880fc5eb41a83960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EF-lhrdIWBDGAF0EtnCoVQ.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">图像中的渐变</figcaption></figure><p id="96dd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">当你从左到右逐个像素地步进时，你会发现在一些步骤之后，像素值会有一个突然的变化，即从黑色较低的像素数到白色较高的像素数。这种颜色的突然变化被称为渐变，从较暗的色调到较亮的色调被称为正渐变，反之亦然。从左到右给出了水平梯度，正如所料，从上到下给出了垂直梯度。</p><h1 id="c2a2" class="ko kp hi bd kq kr lq kt ku kv lr kx ky io ls ip la ir lt is lc iu lu iv le lf bi translated"><strong class="ak">H . o . g .如何工作</strong></h1><p id="d029" class="pw-post-body-paragraph jj jk hi jl b jm lg ij jo jp lh im jr js li ju jv jw lj jy jz ka lk kc kd ke hb bi translated">HOG使用的是一种叫做积木的东西，类似于滑动窗。一个块被认为是一个像素网格，其中梯度由块内像素的强度变化的幅度和方向构成。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lv"><img src="../Images/1ac840e2e9f83aa76921fb4c36867d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/0*HpySen1_BkMRkNOj.gif"/></div></figure><blockquote class="lw lx ly"><p id="ce0f" class="jj jk kg jl b jm jn ij jo jp jq im jr lz jt ju jv ma jx jy jz mb kb kc kd ke hb bi translated">注意事项:HOG适用于灰度图像。</p></blockquote><p id="7a6d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">1 —因此第一步是将RGB图像转换为灰度图像。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mc"><img src="../Images/f022e55eb6c34e2349b1e3dacbad9fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I_ojvsr5WuPOuPGo8Mu9aA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es md"><img src="../Images/0eeb9102e1c436bc258bb881e74796bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*huxOQER7_5vIb6vt169-RA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es me"><img src="../Images/07ec6e2d595e8bd5e93c7d6cbdbfcd9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uo8oENMjNjoFCEpJvITl9A.png"/></div></div></figure><p id="b456" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">2 —为了更仔细地观察，让我们关注一个8*8大小的网格。看下图。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/f070ca40cd3452fca2576c35cac8b415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jgtfrysFueUMWjjL_5_kbg.png"/></div></div></figure><p id="5cef" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在64个像素的块中，对于每个像素，计算水平和垂直梯度。如上图所示，水平和垂直梯度计算如下:</p><p id="89ce" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">水平坡度:120–70 = 50<br/>垂直坡度:100–50 = 50</p><p id="d4f3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">3-一旦我们得到梯度，我们试图为64个像素中的每一个计算所谓的<strong class="jl hj">梯度大小</strong>和<strong class="jl hj">梯度角度</strong>。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mg"><img src="../Images/d438f32e199ac04b7bddf06981e8f08d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0zdfFDwerKeozpinBkhZw.png"/></div></div></figure><p id="c578" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在有了这64个梯度向量，我们试图将它们压缩到9个向量，试图保留最大的结构。为了做到这一点，我们试图绘制一个直方图的幅度和角度。这里x轴是角度，它们被分成9个箱，每个箱的大小为20度。</p><blockquote class="lw lx ly"><p id="dcf5" class="jj jk kg jl b jm jn ij jo jp jq im jr lz jt ju jv ma jx jy jz mb kb kc kd ke hb bi translated">注意:创建9个垃圾箱是由HOG论文的作者决定的。所以它在任何地方都是不变的。</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/e69037df264b330305459430279d385c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hU5iB_mQN5G0AQCP.jpg"/></div></div></figure><p id="d3ae" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">以上结果是针对一个8*8网格的，我们将表示压缩为9个向量。</p><p id="04a6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">4-当我们沿着整个图像滑动8*8网格并尝试解释直方图结果时，我们会得到如下结果。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/d81f032007ff17e8c4ab5f947a05ca5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VV_qMwhEclyDqKuu2H_Kvw.png"/></div></div></figure><p id="9231" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通过绘制猪的特征，我们会发现物体或面部的结构保持得很好，失去了所有不重要的特征。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/061db23b3d71483b36080402ade55915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gWeh90aKfv7A-bpc0vC0oQ.png"/></div></div></figure><p id="7b87" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">并且任何机器学习算法都可以利用这种输入来进行分类或回归。</p><p id="5545" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这是一种至今仍在使用的非常强大的技术，无需使用DL的重型架构就可以实现对象检测。</p><p id="47dc" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">获得HOG检测功能的最好地方是图书馆<a class="ae kf" href="http://dlib.net/" rel="noopener ugc nofollow" target="_blank"> Dlib。</a></p><p id="c20b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在，您已经知道了一种以压缩格式表示图像并且仍然保持图像结构的便捷工具，您可以将它应用到许多计算机视觉用例中。</p><h1 id="1ad8" class="ko kp hi bd kq kr lq kt ku kv lr kx ky io ls ip la ir lt is lc iu lu iv le lf bi translated"><strong class="ak">参考文献:</strong></h1><p id="f248" class="pw-post-body-paragraph jj jk hi jl b jm lg ij jo jp lh im jr js li ju jv jw lj jy jz ka lk kc kd ke hb bi translated"><a class="ae kf" href="https://www.learnopencv.com/histogram-of-oriented-gradients/" rel="noopener ugc nofollow" target="_blank">梯度方向直方图</a> - opencv</p><p id="a31e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><a class="ae kf" href="https://en.wikipedia.org/wiki/Histogram_of_oriented_gradients" rel="noopener ugc nofollow" target="_blank">梯度方向直方图</a> -维基</p><p id="09d2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><a class="ae kf" href="https://www.youtube.com/watch?v=0Zib1YEE4LU" rel="noopener ugc nofollow" target="_blank">方向梯度直方图</a> — UCF</p></div></div>    
</body>
</html>