<html>
<head>
<title>Learning the central limit theorem and bootstrapping: a hands on approach.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习中心极限定理和自举:实践方法。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/learning-the-central-limit-theorem-and-bootstrapping-a-hands-on-approach-78da7cad0438?source=collection_archive---------0-----------------------#2019-07-20">https://medium.com/analytics-vidhya/learning-the-central-limit-theorem-and-bootstrapping-a-hands-on-approach-78da7cad0438?source=collection_archive---------0-----------------------#2019-07-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/ac815e4579c5e35d2ac243b42c07d3da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17lIg-IJPEcVKmlSQHa0BQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="http://hdhut.blogspot.com/2012/07/top-37-most-beautiful-mountains.html" rel="noopener ugc nofollow" target="_blank">hdhut.blogspot.com</a></figcaption></figure><div class=""/></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="d20d" class="jc jd hy bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">理解中心极限定理，自举，以及为什么你应该关心…</h1><blockquote class="ka"><p id="bec2" class="kb kc hy bd kd ke kf kg kh ki kj kk dx translated">“<strong class="ak">中心极限定理</strong> ( <strong class="ak"> CLT </strong>)确立了，在某些情况下，当<a class="ae hv" href="https://en.wikipedia.org/wiki/Statistical_independence" rel="noopener ugc nofollow" target="_blank">个独立随机变量</a>相加时，它们的正常归一化和趋向于<a class="ae hv" href="https://en.wikipedia.org/wiki/Normal_distribution" rel="noopener ugc nofollow" target="_blank">个正态分布</a>(非正式的一个“<em class="kl">钟形曲线</em>”)，即使原始变量本身不是正态分布。该定理是概率论中的一个关键概念，因为它意味着适用于正态分布的概率和统计方法可以适用于许多涉及其他类型分布的问题。”</p><p id="49b3" class="kb kc hy bd kd ke kf kg kh ki kj kk dx translated">—维基百科</p></blockquote><p id="f6fb" class="pw-post-body-paragraph km kn hy ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li kk hb bi translated">对于医疗提供者、数据科学家和统计学家来说，中心极限定理类似于万有引力定律；这是一个基本的真理，直到一些重要的假设被违反(见这里的一些讨论<a class="ae hv" href="https://math.stackexchange.com/questions/164456/some-case-when-the-central-limit-theorem-fails" rel="noopener ugc nofollow" target="_blank"/>)。我个人对这个定理的定义比上一个稍微实用一些:</p><blockquote class="ka"><p id="4cff" class="kb kc hy bd kd ke kf kg kh ki kj kk dx translated">中心极限定理指出，从单个总体中抽取的有限方差样本的聚合度量(平均值、中值、标准偏差等)的分布遵循正态分布。</p></blockquote><figure class="lk ll lm ln lo hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lj"><img src="../Images/3fcb9b9d75547c10f762e8304f1f7c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*Ae3b9-Vda9VEZedbS_Juew.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">资料来源:https://en.wikipedia.org/wiki/Normal_distribution</figcaption></figure><p id="cccc" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">这个定理对医学有多重要？嗯，我们为病人考虑的每一个生物物理变量(生命体征、实验室、心电图等。)基于这个定理定义为正常或异常。考虑一下我们在每次患者就诊时使用的最基本的测量方法之一，核心温度。一般来说，如果一个人的核心温度在人群平均核心温度的2个标准偏差之内，那么他就被认为是无热的。我们知道整个人类的真实平均温度吗？当然不是。那么我们如何知道总体均值和标准差呢？我们必须假设总体样本的均值和方差遵循基于中心极限定理的正态分布，然后我们可以使用基本统计学来定义正态分布。顺便说一句，什么是正常的核心温度？37 C对吧？不完全是，在这里阅读更多<a class="ae hv" href="http://infection-prevention-news.3m.com/what-is-the-normal-core-temperature-of-the-human-body/" rel="noopener ugc nofollow" target="_blank">……</a></p><p id="8c63" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">如果您对统计学不太熟悉，或者您是一名新的数据科学家，那么本文的剩余部分可能有助于您理解什么是中心极限定理，以及通过编写一些基本代码来理解它的作用。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="a8b6" class="md jd hy lz b fi me mf l mg mh"># Standard imports and using random seed 42</span><span id="658e" class="md jd hy lz b fi mi mf l mg mh">import numpy as np<br/>import random as ran<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>from scipy import stats<br/>plt.style.use('ggplot')<br/>ran.seed(42)<br/>np.random.seed(42)<br/>%matplotlib inline<br/>plt.style.use('ggplot')</span></pre><p id="c036" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">让我们用一些正态分布的假数据来回答一个临床问题。假设我们有一个人口，我们想知道人口的平均收缩压(SBP)。让我们把人口总数定为10万人。我们还假设每个人的SBP在70:180之间，平均值为120，标准差为13。这是我们的数据。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="8810" class="md jd hy lz b fi me mf l mg mh"># Generating synthetic population data with normalized distribution</span><span id="c185" class="md jd hy lz b fi mi mf l mg mh">population_sbp = np.random.normal(loc=120.0, scale=13, size=100000)</span><span id="77d2" class="md jd hy lz b fi mi mf l mg mh">print('Mean SBP for synthetic population:{}'.format(round(np.mean(population_sbp),2)))</span><span id="4bb1" class="md jd hy lz b fi mi mf l mg mh">sns.histplot(population_sbp, kde=True, bins=15).set(title="Popluation SBP Frequency", xlabel="Systolic BP")</span><span id="9c72" class="md jd hy lz b fi mi mf l mg mh">Mean SBP for synthetic population: 120.01</span></pre><figure class="lu lv lw lx fd hk er es paragraph-image"><div class="er es mj"><img src="../Images/dcfdd4152c0004ea4220a49ea1436478.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*ImN3or9xlAJ9jO4E9hQLAw.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">正态分布N=100，000的合成SBP</figcaption></figure><p id="268c" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">现在，假设我们有一个人口暴露(人口统计，药物，疾病等。)的兴趣。我们想知道他们的SBP在统计学上是否不同于其他人群。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="ed7d" class="md jd hy lz b fi me mf l mg mh"># Pulling out a cohort of interest (N=20)<br/># Maybe everyone on a stimulant medication</span><span id="27f4" class="md jd hy lz b fi mi mf l mg mh">cohort_bp = [ran.randint(70,200) for i in range(20)]</span><span id="1cf4" class="md jd hy lz b fi mi mf l mg mh">print('Mean SBP for synthetic cohorot: {}'.format(round(np.mean(cohort_bp),2)))</span><span id="e89f" class="md jd hy lz b fi mi mf l mg mh">sns.histplot(cohort_bp, kde=True, bins=15).set(xlabel='Systolic BP', title="Cohort SBP Frequency")</span><span id="54a0" class="md jd hy lz b fi mi mf l mg mh">Mean SBP for synthetic cohort: 121.4</span></pre><figure class="lu lv lw lx fd hk er es paragraph-image"><div class="er es mk"><img src="../Images/fc4ecbbe721054bff6706b5d915a986b.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*2RomLEV4uwDpaNloeIOtBA.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来自我们队列的数据显示SBP的频率</figcaption></figure><p id="b8d9" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">不错！121.4接近120.01，所以我们可以有把握地说，没有区别，曝光不会增加你的SBP。但是等等，我们确定吗？</p><h2 id="af9c" class="md jd hy bd je ml mm mn ji mo mp mq jm kx mr ms jq lb mt mu ju lf mv mw jy mx bi translated">输入引导程序:</h2><p id="e8e6" class="pw-post-body-paragraph km kn hy ko b kp my kr ks kt mz kv kw kx na kz la lb nb ld le lf nc lh li kk hb bi translated">Bootstrapping是一种重新采样的形式，在这种形式中，我们从一个样本中随机获取数据，并进行替换，没有偏见。换句话说，我们使用我们的原始亚群体重复进行我们的实验，以获得我们的数据集内的方差的更准确的想法。让我们通过它来更好地理解为什么它如此有用。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="7348" class="md jd hy lz b fi me mf l mg mh"># Bootstrapping to generate an idea of variance in our cohort<br/># n=5, m=40 (repeating 40 times)</span><span id="0951" class="md jd hy lz b fi mi mf l mg mh">pop_mbp40 = [np.mean(ran.choices(cohort_bp, k=10)) for k in range(40)]</span><span id="01db" class="md jd hy lz b fi mi mf l mg mh">print('Mean SBP of multiple "Experiments" using bootstrapping of cohort: {}'.format(round(np.mean(pop_mbp40),2)))</span><span id="b3da" class="md jd hy lz b fi mi mf l mg mh">sns.histplot(pop_mbp40, bins=15, kde=True).set(xlabel='Systolic BP', title="Boostrapped Cohort Mean SBP's n=40")</span><span id="479a" class="md jd hy lz b fi mi mf l mg mh">plt.show()</span><span id="a736" class="md jd hy lz b fi mi mf l mg mh">Mean SBP of multiple "Experiments" using bootstrapping of cohort: 124.37</span></pre><figure class="lu lv lw lx fd hk er es paragraph-image"><div class="er es nd"><img src="../Images/dbf171e47fc4a9613a6e0daa39ffe4dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*T5800T0erxqHsSkUVZR46A.png"/></div></figure><p id="0fa8" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">这看起来更像之前的正态分布，但是看看我们现在的平均SBP；124.37和120.01不一样。也许他们在统计学上是不同的群体。</p><p id="c903" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">当统计学家谈论大型数据集的价值时，这正是他们所指的。通过自举，我们选择了一个很小的群体，并从本质上扩大了它。如果我们增加到1000次实验呢？</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="0830" class="md jd hy lz b fi me mf l mg mh"># Bootstrapping to generate an idea of variance in our cohort<br/># n=5, m=1000 </span><span id="37a3" class="md jd hy lz b fi mi mf l mg mh">pop_mbp1000 = [np.mean(ran.choices(cohort_bp, k=10)) for k in range(1000)]</span><span id="9863" class="md jd hy lz b fi mi mf l mg mh">print('Mean SBP of multiple "Experiments" using bootstrapping of cohort: {}'.format(round(np.mean(pop_mbp1000),2)))</span><span id="7ba8" class="md jd hy lz b fi mi mf l mg mh">sns.histplot(pop_mbp1000, bins=15, kde=True).set(xlabel='Systolic BP', title="Boostrapped Cohort Mean SBP's m=1000")</span><span id="6f73" class="md jd hy lz b fi mi mf l mg mh">plt.show()</span><span id="9651" class="md jd hy lz b fi mi mf l mg mh">Mean SBP of multiple "Experiments" using bootstrapping of cohort: 121.44</span></pre><figure class="lu lv lw lx fd hk er es paragraph-image"><div class="er es ne"><img src="../Images/148dc0babe18eb0257bd37e494ae63fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*Q8mGLiuuwSg2KqPgeiRG0g.png"/></div></figure><p id="7f42" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">或者，如果您喜欢查看累积分布函数(CDF):</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="25ff" class="md jd hy lz b fi me mf l mg mh"># Seaborn makes this really easy:</span><span id="5f2a" class="md jd hy lz b fi mi mf l mg mh">sns.histplot(pop_mbp1000, cumulative=True, kde=True, stat='density').set(xlabel='Systolic BP', title="CDF Plot")</span></pre><figure class="lu lv lw lx fd hk er es paragraph-image"><div class="er es nf"><img src="../Images/d9ce2e3d1eb001439b693a645805ca22.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*s_MVFjyq76GhAX5hjt_8_A.png"/></div></figure><p id="b733" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">这就是我们所知道的…SBP的群组平均值为121.4，而人口平均值为120.01。通过使用更大的样本进行自举，我们对得到的实际均值更有信心。样本为40人时，我们的平均值与样本为1000人时相差甚远。那么他们是统计上不同的群体吗？快速t检验可以告诉我们。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="36ff" class="md jd hy lz b fi me mf l mg mh">print(stats.ttest_1samp(pop_mbp1000, np.mean(population_sbp)))</span><span id="a8fb" class="md jd hy lz b fi mi mf l mg mh">Ttest_1sampResult:<br/>statistic=3.873384345624399, pvalue=0.0001143212951836694</span><span id="3c4f" class="md jd hy lz b fi mi mf l mg mh">print(stats.ttest_1samp(pop_mbp1000, np.mean(population_sbp))[1] &lt; 0.05)</span><span id="e9dc" class="md jd hy lz b fi mi mf l mg mh">True</span></pre><p id="6fe9" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">因此，我们有95%的把握认为，这两组之间的平均SBP存在差异。现在我们可以定义我们在亚群体中有多少确定性意味着什么。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="8c8d" class="md jd hy lz b fi me mf l mg mh"># Lets get the confidence interval for our sub-population mean:</span><span id="be1e" class="md jd hy lz b fi mi mf l mg mh">print(np.percentile(pop_mbp10000, [2.5, 97.5]))</span><span id="518d" class="md jd hy lz b fi mi mf l mg mh">[ 99.3 145.5]</span></pre><p id="3898" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">这就是…在这种情况下，我们拒绝零假设，即121.4的子群体平均值与120.01的总体平均值没有不同，95%置信区间[CI] = 99.3，145.5，p &lt; 0.05. Note that the CI in our case is huge.</p><p id="9d1a" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">In reality, when we have a biophysical measures that follow a normal Gaussian distribution, assuming a large enough sample size to identify differences, things become as simple as performing a 1 sample T-Test like this:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="b5a5" class="md jd hy lz b fi me mf l mg mh">cohort_bp_larger = [ran.randint(70,200) for i in range(100)]</span><span id="c713" class="md jd hy lz b fi mi mf l mg mh">print(np.mean(cohort_bp))<br/>print(stats.ttest_1samp(cohort_bp, np.mean(population_sbp)))</span><span id="0a06" class="md jd hy lz b fi mi mf l mg mh">130.57<br/>Ttest_1sampResult:<br/>(statistic=2.686738162089129, pvalue=0.008463715048549163)</span></pre><p id="7b7b" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">Hopefully this has been a beneficial, clarifying, and entertaining look at the Central Limit Theorem and the idea of bootstrapping. At worst, hopefully it has peaked some interest in understanding the topics addressed in a little more depth.</p><p id="61fd" class="pw-post-body-paragraph km kn hy ko b kp lp kr ks kt lq kv kw kx lr kz la lb ls ld le lf lt lh li kk hb bi translated">Link to GitHub repository with full code: <a class="ae hv" href="https://github.com/p-easter/Medium_CLT/blob/d1304df24af06ffab8c44b25926b1ecd5d452f16/README.md" rel="noopener ugc nofollow" target="_blank"> Central_Limit </a></p></div></div>    
</body>
</html>