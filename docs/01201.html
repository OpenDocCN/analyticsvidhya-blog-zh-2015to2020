<html>
<head>
<title>Sign Language Digits Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">手语数字分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sign-language-classification-64fe8ad0fc2c?source=collection_archive---------6-----------------------#2019-10-08">https://medium.com/analytics-vidhya/sign-language-classification-64fe8ad0fc2c?source=collection_archive---------6-----------------------#2019-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5d4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章讨论了基于数字的手语数据集训练不同的分类模型及其比较。它提供了关于每个模型的准确性度量如何不同的见解。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="0e8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集可在以下位置找到:</p><div class="jk jl ez fb jm jn"><a href="https://www.kaggle.com/ardamavi/sign-language-digits-dataset" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">手语数字数据集</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">下载数千个项目的开放数据集+在一个平台上共享项目。探索热门话题，如政府…</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">www.kaggle.com</p></div></div><div class="jw l"><div class="jx l jy jz ka jw kb kc jn"/></div></div></a></div><h1 id="126c" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">数据集预览</strong></h1><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es lb"><img src="../Images/24f122dde81751e8e525ea74d7a2a5f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*FWaj5PnzCRUek-lKcnPk_g.png"/></div></figure><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es li"><img src="../Images/72a66b27c34bbb4a8df51e189344a8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*_N8CqDBxTHblQKGNcuOqEQ.png"/></div></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="1a6d" class="kd ke hi bd kf kg lj ki kj kk lk km kn ko ll kq kr ks lm ku kv kw ln ky kz la bi translated">加载数据</h1><p id="d9eb" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">克隆回购:</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="53a2" class="ly ke hi lu b fi lz ma l mb mc">!git clone ‘<a class="ae md" href="https://github.com/ardamavi/Sign-Language-Digits-Dataset.git'" rel="noopener ugc nofollow" target="_blank">https://github.com/ardamavi/Sign-Language-Digits-Dataset.git'</a></span></pre><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es me"><img src="../Images/895d4298b50d48ee6e14f32f3da32786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tqVNKhJ3s2iTYl04QZ7XrA.png"/></div></div></figure><p id="fe1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装它(仅第一次)</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mj"><img src="../Images/65ad285970dca82a4ac68799f15518aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0C5I_L_VyA4DAINn1NAzJA.png"/></div></div></figure><p id="8a81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">访问图像文件:</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="66f3" class="ly ke hi lu b fi lz ma l mb mc">import os<br/>dir=”/content/Sign-Language-Digits-Dataset/Dataset”<br/></span></pre><p id="f79a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将号码组织到不同的文件夹中</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="59ca" class="ly ke hi lu b fi lz ma l mb mc"><br/>zero= dir+”/0"<br/>one= dir+”/1"<br/>two= dir+”/2"<br/>three= dir+”/3"<br/>four= dir+”/4"<br/>five= dir+”/5"<br/>six= dir+”/6"<br/>seven= dir+”/7"<br/>eight= dir+”/8"<br/>nine= dir+”/9"</span></pre><p id="4fca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">浏览不同文件夹下的几个文件:</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mk"><img src="../Images/6f28e2e4d72df183ec21bae7f67c77d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JcZ8D1fpEImU2PHZuCS-ew.png"/></div></div></figure><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es ml"><img src="../Images/8aafff9bd234a9504327725f35f95254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tCWwbavihyBWWntpgUsaQ.png"/></div></div></figure><p id="b9e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将图像和标签存储在两个不同的numpy数组中。</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="797c" class="ly ke hi lu b fi lz ma l mb mc">images = []<br/>val=[]</span><span id="518c" class="ly ke hi lu b fi mm ma l mb mc">#Appending the images of different folders into one array</span><span id="f30d" class="ly ke hi lu b fi mm ma l mb mc">import cv2<br/>def load_images_from_folder(folder):<br/> <br/> for filename in os.listdir(folder):<br/> img = cv2.imread(os.path.join(folder,filename))<br/> if img is not None:<br/> images.append(img)<br/> val.append(zero[-1])<br/> return images,val<br/> <br/>imgs,label=load_images_from_folder(zero)</span></pre><p id="92d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数字0的图像和标签已经被附加到各自的数组中。</p><p id="9270" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对其他数字(1–9)重复同样的操作，将文件夹名称(粗体字的那个)更改为其他文件夹名称(一、二、三、四、五、六、七、八、九)，如下所示:</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="825a" class="ly ke hi lu b fi lz ma l mb mc"><br/>def load_images_from_folder(folder):<br/> <br/> for filename in os.listdir(folder):<br/> img = cv2.imread(os.path.join(folder,filename))<br/> if img is not None:<br/> images.append(img)<br/> val.append(<strong class="lu hj">one</strong>[-1])       #label value<br/> return images,val<br/> <br/>imgs,label=load_images_from_folder(<strong class="lu hj">one</strong>)</span></pre><p id="b540" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦所有的图像和标签被附加到各自的数组中，检查每个数组中的条目数。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mn"><img src="../Images/80eb9cf1b89a398901218f4017e5b59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kuQe-oz4LhyPmRoCPo0jmA.png"/></div></div></figure><h1 id="040d" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">数据预处理</strong></h1><p id="845d" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">接下来的步骤包括调整大小，将每个图像转换成灰度和展平。</p><p id="7b14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">调整大小:</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="505b" class="ly ke hi lu b fi lz ma l mb mc">width = 50<br/>height = 50<br/>dim = (width, height)<br/>new=[]</span><span id="2091" class="ly ke hi lu b fi mm ma l mb mc">for img in imgs:<br/> resized = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)<br/> <br/> new.append(resized)</span></pre><p id="8535" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">灰度:</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="5f49" class="ly ke hi lu b fi lz ma l mb mc">grayscale=[]<br/>for img in new:<br/> gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)<br/> grayscale.append(gray)</span><span id="3055" class="ly ke hi lu b fi mm ma l mb mc">grayscalenew=np.asarray(grayscale)</span></pre><p id="364a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">扁平化:</p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="de0b" class="ly ke hi lu b fi lz ma l mb mc">flatten=[]<br/>import numpy as np<br/>for im in grayscale:<br/> data = np.array(im)<br/> flattened = data.flatten()<br/> flatten.append(flattened)</span></pre><p id="4e88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转换成numpy数组:</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mo"><img src="../Images/81de3aab7505406e413db715d47564d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FG0omuqXWRlM0S9b5Wiebg.png"/></div></div></figure><p id="9434" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将标签转换为numpy数组</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mp"><img src="../Images/1f0f66c770d228bfd64549225ecd32f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uAjZ2nvK342VdppPrEjM0Q.png"/></div></div></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="18a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分成训练集和测试集</strong></p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="e0ea" class="ly ke hi lu b fi lz ma l mb mc">from sklearn.model_selection import train_test_split<br/>x_train, x_test, y_train, y_test = train_test_split(flatten,label, test_size=0.25, random_state=58)</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="46a8" class="kd ke hi bd kf kg lj ki kj kk lk km kn ko ll kq kr ks lm ku kv kw ln ky kz la bi translated"><strong class="ak">比较各种算法的精度</strong></h1><p id="66c3" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated"><strong class="ih hj"> <em class="mq">决策树</em> </strong></p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="2b4d" class="ly ke hi lu b fi lz ma l mb mc">from sklearn import tree<br/>clf = tree.DecisionTreeClassifier()<br/>clf = clf.fit(x_train, y_train)<br/>y_pred_dt=clf.predict(x_test)<br/>y_train_score_dt=clf.predict(x_train)</span><span id="0c00" class="ly ke hi lu b fi mm ma l mb mc">from sklearn.metrics import accuracy_score</span><span id="b6ff" class="ly ke hi lu b fi mm ma l mb mc">print("accuracy of the model is:\nTest ", accuracy_score(y_test, y_pred_dt, normalize=True, sample_weight=None))<br/>print('Train',accuracy_score(y_train, y_train_score_dt, normalize=True, sample_weight=None))</span></pre><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mr"><img src="../Images/d57b4878dd9ae9f9ef1187e9bd00a016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UKgwPFFhGJeqxnV_c-A--A.png"/></div></div></figure><p id="6ef0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="mq">逻辑回归</em> </strong></p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="b9dd" class="ly ke hi lu b fi lz ma l mb mc">from sklearn.linear_model import LogisticRegression<br/># all parameters not specified are set to their defaults<br/>logisticRegr = LogisticRegression()</span><span id="4b1c" class="ly ke hi lu b fi mm ma l mb mc">logisticRegr.fit(x_train, y_train)</span></pre><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es ms"><img src="../Images/91372a9cff39908ebc0042d0dfb59efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*en2T9tr926g_h6Rt-c3SgQ.png"/></div></div></figure><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="e317" class="ly ke hi lu b fi lz ma l mb mc">x_test[0].reshape(1,-1)</span><span id="3a89" class="ly ke hi lu b fi mm ma l mb mc">logisticRegr.predict(x_test[0].reshape(1,-1))</span><span id="7e0f" class="ly ke hi lu b fi mm ma l mb mc">predictions = logisticRegr.predict(x_test)</span><span id="3840" class="ly ke hi lu b fi mm ma l mb mc">score = logisticRegr.score(x_test, y_test)<br/>scoretr= logisticRegr.score(x_train, y_train)<br/>print(“Test”)<br/>print(score)<br/>print(“Train”)<br/>print(scoretr)</span></pre><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mt"><img src="../Images/582aa93b73bf096cfe7035a322069f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BosuY5EQGlnVlLkuQ5WgUQ.png"/></div></div></figure><p id="e726" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="mq">随机森林</em> </strong></p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="6e10" class="ly ke hi lu b fi lz ma l mb mc">from sklearn.ensemble import RandomForestClassifier<br/>clf_rft = RandomForestClassifier(n_estimators=100, max_depth=15,random_state=0)<br/>clf_rft = clf_rft.fit(x_train, y_train)</span><span id="9bb3" class="ly ke hi lu b fi mm ma l mb mc">y_pred_rft=clf_rft.predict(x_test)<br/>y_train_score_rft=clf_rft.predict(x_train)</span><span id="2099" class="ly ke hi lu b fi mm ma l mb mc">from sklearn.metrics import accuracy_score</span><span id="1433" class="ly ke hi lu b fi mm ma l mb mc">print(“accuracy of the model is:\nTest “, accuracy_score(y_test, y_pred_rft, normalize=True, sample_weight=None))<br/>print(‘Train’,accuracy_score(y_train, y_train_score_rft, normalize=True, sample_weight=None))</span></pre><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mu"><img src="../Images/1f311c098a6b86afd25e14ff07f86d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQsPNjJh7zsNP71S5OeWpA.png"/></div></div></figure><p id="86ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="mq">朴素贝叶斯</em> </strong></p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="e01a" class="ly ke hi lu b fi lz ma l mb mc">from sklearn.metrics import accuracy_score</span><span id="fa16" class="ly ke hi lu b fi mm ma l mb mc">from sklearn.naive_bayes import GaussianNB <br/>gnb = GaussianNB() <br/>gnb.fit(x_train, y_train)<br/>y_pred_gnb=gnb.predict(x_test)<br/>y_train_score_gnb=gnb.predict(x_train)<br/>print(“accuracy of the model is:\nTest “, accuracy_score(y_test, y_pred_gnb, normalize=True, sample_weight=None))<br/>print(‘Train’,accuracy_score(y_train, y_train_score_gnb, normalize=True, sample_weight=None))</span></pre><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mv"><img src="../Images/2f7a3226d05ebde9a9194351985e26c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bMsVb57mltpFi3jpQNRMaw.png"/></div></div></figure><p id="74ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="mq">梯度下降分类器</em> </strong></p><pre class="lc ld le lf fd lt lu lv lw aw lx bi"><span id="0e0a" class="ly ke hi lu b fi lz ma l mb mc">from sklearn.metrics import accuracy_score<br/>from sklearn.ensemble import AdaBoostRegressor<br/>from sklearn.ensemble import GradientBoostingClassifier<br/>gdc_model= GradientBoostingClassifier(learning_rate=0.01,random_state=41)<br/>gdc_model.fit(x_train, y_train)<br/>y_pred_gdc=gdc_model.predict(x_test)<br/>y_train_score_gdc=gdc_model.predict(x_train)<br/>print(“accuracy of the model is:\nTest “, accuracy_score(y_test, y_pred_gdc, normalize=True, sample_weight=None))<br/>print(‘Train’,accuracy_score(y_train, y_train_score_gdc, normalize=True, sample_weight=None))</span></pre><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mw"><img src="../Images/ca0ddc7ea70cf25040e483dcd621fa1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLBWliWibfVIJl-M7Os6rw.png"/></div></div></figure><p id="08b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他指标:</p><p id="0e40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(关于梯度下降分类器)</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mx"><img src="../Images/780ab80d30721b8187ad41810a55aeb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2VheNm01FHcJDtUKHSXmFA.png"/></div></div></figure><h1 id="96d3" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">结论:</strong></h1><p id="bdc7" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">基于上述实验，我们可以清楚地看到，朴素贝叶斯算法比其他任何算法都更好地对测试数据进行分类。</p><p id="676e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">缺点是我们可能需要更多的数据来更新我们模型的参数，使其朝着更好的方向发展。在这种情况下，可以实现更高的精度。</p></div></div>    
</body>
</html>