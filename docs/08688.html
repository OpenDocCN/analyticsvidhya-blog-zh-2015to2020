<html>
<head>
<title>Best way to Impute categorical data using Groupby â€” Mean &amp; Mode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ group by-Mean &amp; Mode ä¼°ç®—åˆ†ç±»æ•°æ®çš„æœ€ä½³æ–¹æ³•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/best-way-to-impute-categorical-data-using-groupby-mean-mode-2dc5f5d4e12d?source=collection_archive---------0-----------------------#2020-08-09">https://medium.com/analytics-vidhya/best-way-to-impute-categorical-data-using-groupby-mean-mode-2dc5f5d4e12d?source=collection_archive---------0-----------------------#2020-08-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/05008acc3883ae6b33ff8c12560bd1c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d0uxEglpbzX6Lgtena5eXg.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">æ¥æº:ç…§ç‰‡ç”± Nate Bell åœ¨ Unsplash ä¸Šæ‹æ‘„</figcaption></figure><div class=""/><p id="f9d1" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬çŸ¥é“å¯ä»¥ä½¿ç”¨ fillna()å°† nan å€¼æ›¿æ¢ä¸ºå‡å€¼æˆ–ä¸­å€¼ã€‚å¦‚æœ NAN æ•°æ®ä¸å¦ä¸€ä¸ªåˆ†ç±»åˆ—ç›¸å…³ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</p><p id="1f14" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚æœæœŸæœ›çš„ NAN å€¼æ˜¯ä¸€ä¸ªåˆ†ç±»å€¼å‘¢ï¼Ÿ</p><p id="e61a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä¸‹é¢æ˜¯ä¸€äº›å¤„ç† NAN å€¼çš„æœ‰ç”¨æç¤ºã€‚</p><p id="62ab" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä½ è‚¯å®šæ˜¯å’Œç†ŠçŒ«å’Œç†ŠçŒ«ä¸€èµ·åšçš„ã€‚</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="df8d" class="kb kc hx jx b fi kd ke l kf kg"><strong class="jx hy">import</strong> <strong class="jx hy">pandas</strong> <strong class="jx hy">as</strong> <strong class="jx hy">pd</strong><br/><strong class="jx hy">import</strong> <strong class="jx hy">numpy</strong> <strong class="jx hy">as</strong> <strong class="jx hy">np</strong></span></pre><h1 id="1cbb" class="kh kc hx bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">n ç»„</h1><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="4c0c" class="kb kc hx jx b fi kd ke l kf kg">cl = pd.DataFrame({<br/>'team':['A','A','A','A','A','B','B','B','B','B'],                   'class'['I','I','I','I','I','I','I','II','II','II'],<br/>'value': [1, np.nan, 2, 2, 3, 1, 3, np.nan, 3,1]})</span></pre><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es le"><img src="../Images/500fee9abc65ac8c3a11efb009c821aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*z_wyPUb5I7NvX0J6vCHigQ.png"/></div></figure><p id="0e4d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å‡è®¾æ‚¨å¿…é¡»å¡«å†™é…’ç±»æ¶ˆè´¹ç‡æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–ç›¸å…³æ•°æ®ï¼Œæ‚¨å¯ä»¥å¡«å†™ã€‚</p><p id="3bbf" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä½†æ˜¯å¦‚æœç»™å®šäº†è¿™ä¸ªäººçš„å¹´é¾„ï¼Œé‚£ä¹ˆä½ å¯ä»¥çœ‹åˆ°å¹´é¾„å’Œæ¶ˆè´¹ç‡å˜é‡çš„æ¨¡å¼ã€‚å› ä¸ºæ‰€æœ‰äººçš„é¥®é…’é‡ä¸ä¼šå¤„äºåŒä¸€æ°´å¹³ã€‚</p><p id="88d0" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œå·¥èµ„çš„ä»·å€¼å¯èƒ½ä¸å¹´é¾„ã€èŒç§°å’Œ/æˆ–æ•™è‚²ç¨‹åº¦æœ‰å…³ã€‚</p><p id="561d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå‡è®¾åˆ— test å’Œ class ä¸ value ç›¸å…³ã€‚</p><p id="e70f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä½¿ç”¨ ngroupï¼Œæ‚¨å¯ä»¥ç”¨ç´¢å¼•æ¥å‘½åç»„ã€‚</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="7654" class="kb kc hx jx b fi kd ke l kf kg">cl['idx'] = cl.groupby(['team','class']).ngroup()</span></pre><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es lf"><img src="../Images/57340d9cac7273f5f4c7c6ecc8916bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*czxkkcPvxy7xOllFWj8W9w.png"/></div></figure><p id="bbac" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨ä½ å¯ä»¥æ¸…æ¥šåœ°äº†è§£è¿™äº›ç»„äº†ï¼Œæˆ‘ä»¬ç”¨ç´¢å¼•ç»™è¿™äº›ç»„å‘½åã€‚å¦‚æœæ‚¨æƒ³åœ¨å¦‚æ­¤å¤æ‚çš„ç»„ä¸­å¤„ç†æ•°æ®ï¼Œè¿™å°†å¾ˆæœ‰å¸®åŠ©ã€‚ä¾‹å¦‚å…·æœ‰ 10 åˆ—å¤æ‚ç»„çš„ fillnaã€‚</p><h1 id="29e9" class="kh kc hx bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">æŒ‰ä¸¤åˆ—åˆ†ç»„ï¼Œç”¨å¹³å‡å€¼å¡«å……</h1><p id="18bb" class="pw-post-body-paragraph iu iv hx iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr hb bi translated">è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„æ•°æ®:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="74b8" class="kb kc hx jx b fi kd ke l kf kg">cl = pd.DataFrame({<br/>'team': 'A','A','A','A','A','B','B','B','B','B'],<br/>'class':['I','I','I','II','II','I','I','II','II','II'],<br/>'value': [1, np.nan, 2, 2, 3, 1, 3, np.nan, 3,1]})</span></pre><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es le"><img src="../Images/500fee9abc65ac8c3a11efb009c821aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*z_wyPUb5I7NvX0J6vCHigQ.png"/></div></figure><p id="707f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚å‰æ‰€è¿°ï¼Œç°åœ¨æˆ‘ä»¬è¦ç”¨å›¢é˜Ÿå’Œç­çº§çš„å¹³å‡å€¼å¡«å…… nanã€‚</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="a2a9" class="kb kc hx jx b fi kd ke l kf kg">cl['value'] = cl.groupby(['team','class'], sort=False)['value'].apply(lambda x: x.fillna(x.mean()))</span></pre><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es ll"><img src="../Images/3d69d1bd0c71f2ee4f94c45221651b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*E_iDmI1Qf3BNcAqZDkzUVw.png"/></div></figure><p id="3765" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">A é˜Ÿå’Œ I çº§ï¼Œ1.0 å’Œ 2.0 çš„å¹³å‡å€¼æ˜¯ 1.5ã€‚ç±»ä¼¼åœ°ï¼Œå…¶ä½™çš„ç»„ã€‚æ‚¨å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªç©ºå€¼æ˜¯ç”¨ä¸åŒçš„æ–¹æ³•ä¼°ç®—çš„(é»„è‰²é˜´å½±å€¼)ã€‚å³æ¯ç»„çš„å¹³å‡å€¼ã€‚</p><h1 id="bcc0" class="kh kc hx bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">æŒ‰ä¸¤åˆ—åˆ†ç»„ï¼Œå¹¶ç”¨ mode å¡«å……</h1><p id="cc0d" class="pw-post-body-paragraph iu iv hx iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr hb bi translated">ä¸å‡å€¼å’Œä¸­å€¼ä¸€æ ·ï¼Œæ¨¡å¼ä¸ fillna ä¸å…¼å®¹ã€‚</p><p id="daf6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Mean &amp; meadian è¿”å›å’Œå·¥ä½œæ–¹å¼ç›¸åŒï¼Œéƒ½è¿”å›ä¸€ä¸ªç³»åˆ—ã€‚ä½†æ˜¯ mode è¿”å›ä¸€ä¸ªæ•°æ®å¸§ã€‚</p><p id="3973" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¦ä½¿ç”¨ fillna æ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€ç‚¹å°å°çš„æ”¹å˜ã€‚</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="df6f" class="kb kc hx jx b fi kd ke l kf kg">df = pd.DataFrame({'A': [1, 2, 1, 2, 1, 2, 3]})<br/><br/>a = df.mode()<br/>print(a.iloc[0])<br/>print(type(a))</span></pre><p id="1be7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">A 1 <br/> Name: 0ï¼Œdtype:int 64<br/>&lt;class ' pandas . core . frame . data frame '&gt;</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="f13f" class="kb kc hx jx b fi kd ke l kf kg">df = pd.DataFrame({'A': [1, 2, 1, 2, 1, 2, 3]})<br/><br/>a = df.mean()<br/>print(a)<br/>print(type(a))</span></pre><p id="e549" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">a 1.714286<br/>dtype:float 64<br/>&lt;class ' pandas . core . series . series '&gt;</p><p id="f36d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨è®©æˆ‘ä»¬ç”¨æ¨¡å¼ä¼°ç®—ä¸‹è¿°æ•°æ®çš„ NAN å€¼ã€‚</p><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es le"><img src="../Images/500fee9abc65ac8c3a11efb009c821aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*z_wyPUb5I7NvX0J6vCHigQ.png"/></div></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="28e2" class="kb kc hx jx b fi kd ke l kf kg">cl['value'] = cl.groupby(['team','class'], sort=False)['value'].apply(lambda x: x.fillna(<strong class="jx hy">x.mode().iloc[0]</strong>))</span></pre><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es lm"><img src="../Images/1f79b47a76c976019292be314d4f6813.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*rai7eqt29CbcBhrYhV2qig.png"/></div></figure><p id="895a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">1ï¼Œ2ï¼Œ2ï¼Œ3 çš„æ¨¡å¼æ˜¯ 2ã€‚</p><h1 id="ea95" class="kh kc hx bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">æŒ‰ 1 åˆ—å’Œ fillna åˆ†ç»„</h1><p id="39a7" class="pw-post-body-paragraph iu iv hx iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr hb bi translated">æ•°æ®:</p><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es ln"><img src="../Images/29c62b58aba824ce22d633ddde732df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/1*nQcNt_U9nemAcHsvuh7wYQ.png"/></div></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="71dd" class="kb kc hx jx b fi kd ke l kf kg">cl1['value'] = cl1.groupby('sec').transform(lambda x: x.fillna(x.mean()))</span></pre><p id="1dcf" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä»¥ä¸‹è¯­å¥ä¹Ÿé€‚ç”¨ã€‚</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="caa7" class="kb kc hx jx b fi kd ke l kf kg">cl1['value'] = cl1.groupby('sec')['value'].transform(lambda x: x.fillna(x.mean()))</span></pre><p id="9963" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»“æœ:</p><figure class="js jt ju jv fd hk er es paragraph-image"><div class="er es lo"><img src="../Images/b7af847da319e748a9dc4cf62f206eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:278/format:webp/1*DkbSCQqJPO-5feJ8NU4xIQ.png"/></div></figure><h1 id="4e6c" class="kh kc hx bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">ç»“è®º:</h1><p id="e1f6" class="pw-post-body-paragraph iu iv hx iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr hb bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ›´å¥½çš„æ•°æ®åˆ†ç»„å’Œå¡«å……æ–¹æ³•ã€‚</p><p id="5c5b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¸Œæœ›ä½ å¯¹å®è·µæˆ‘ä»¬ç°åœ¨æ‰€å­¦çš„ä¸œè¥¿æ„Ÿåˆ°å…´å¥‹ã€‚</p><p id="8950" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬å°†çœ‹åˆ° Python ä¸­çš„ä¸€ä¸ªæ–°æŠ€å·§ã€‚è°¢è°¢å¤§å®¶ï¼ğŸ‘</p><p id="403b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å–œæ¬¢æ”¯æŒï¼Ÿåªéœ€ç‚¹å‡»æ‹æ‰‹å›¾æ ‡ğŸ‘æƒ³åƒå¤šå°‘å°±åƒå¤šå°‘ã€‚</p><p id="1a87" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç¼–ç¨‹å¿«ä¹ï¼ğŸˆ</p></div></div>    
</body>
</html>