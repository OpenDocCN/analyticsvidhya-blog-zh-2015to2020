<html>
<head>
<title>Using Django for Machine Learning like a Legend!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像传说一样用Django进行机器学习！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-django-for-machine-learning-like-a-legend-23d0633a0732?source=collection_archive---------9-----------------------#2020-05-16">https://medium.com/analytics-vidhya/using-django-for-machine-learning-like-a-legend-23d0633a0732?source=collection_archive---------9-----------------------#2020-05-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="54e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我经常发现自己处于这样一种情况，人们在思考一个话题。而且话题挺大的。</p><p id="d984" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">“我们制作了这个ML模型，我们如何将其与我们的移动应用程序集成？”。</em></p><p id="d0b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用一种相当压倒性的声音回答，<em class="jd">“你用REST API的你这个笨蛋。”</em></p><p id="fa07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是有那么简单吗？没有。我从来没有找到任何好的教程来集成ML和任何web服务器。弄清楚这一点对我来说是一个巨大的考验。我考虑了很多可能性。使用嵌入在设备中的最小化的<strong class="ih hj">【训练模型】</strong>来使用。但这是有代价的。支持这么多平台。在iOS设备上做同样的事情非常困难。</p><h1 id="c07a" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">解决方法是什么？</h1><p id="6308" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">最简单的方法是用模型参数手动硬编码视图。这样做将使您能够在用户与网站交互时运行您的模型脚本。但这有点像1995年。超级慢又无聊。</p><p id="e651" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在这里寻找的是传奇的感觉。感觉像是刚从谷歌出来的开发者。咄！</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/50c32cba5ecb2252a9cb619b6a01f00c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ctRMfb38pEMBx-Q7XZAQkQ.jpeg"/></div></div></figure><h1 id="6352" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">设置ML代码</h1><p id="168a" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">让我们快速建立一个样本机器学习代码，它在给定的数据集上进行训练，并存储模型以备后用。</p><p id="40fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用evergreen <strong class="ih hj">工资数据集</strong>，以便于我们的<strong class="ih hj">“年轻”</strong>受众理解。</p><p id="3320" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以从<a class="ae kt" href="https://github.com/rshrc/django-ml/blob/master/ml/data.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">这里</strong> </a>下载数据集。</p><p id="acb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们快速浏览一下ML代码，因为这不是我们今天讨论的主题。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ku"><img src="../Images/7d34eec9461424ae62793d3d2a1c9082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W6vTzNfn0fSSvfCsMChJFA.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">明白了吗？</figcaption></figure><p id="11c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的代码是一个基本示例，它将数据集data.csv拆分为训练集和测试集，训练一个简单的<strong class="ih hj">线性回归</strong>模型，然后使用pickle将训练好的模型存储在一个名为model.sav的文件中，以实现模型持久性。我们使用模型持久性，这样我们就不必一次又一次地训练模型。<strong class="ih hj">训练一次，随时使用</strong>。</p><h1 id="bbd5" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">有趣的部分</h1><p id="d9e4" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">现在是姜戈的部分。我们将建立一个基本的Django项目，里面有两个应用程序。<strong class="ih hj">【预测】</strong><strong class="ih hj">【服务器】</strong>。predict应用程序包含训练代码和一个<strong class="ih hj">加载器类</strong>，它使我们能够做机器学习的事情。服务器应用程序有一个<strong class="ih hj"> API视图</strong>，它接收一个POST请求并返回输出。</p><pre class="ki kj kk kl fd kz la lb lc aw ld bi"><span id="61dd" class="le jf hi la b fi lf lg l lh li">django-admin startproject dj_ml_legend &amp;&amp; cd dj_ml_legend<br/>python manage.py startapp predict<br/>python manage.py startapp server</span></pre><p id="3abf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">酷，你现在应该在你的目录中看到两个处女应用程序。</p><h1 id="2868" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">预测应用程序</h1><p id="9b68" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">先用预测app吧。将您的<strong class="ih hj"> <em class="jd"> train.py </em> </strong>文件和<strong class="ih hj"> <em class="jd"> data.csv </em> </strong>文件复制粘贴到您的<strong class="ih hj"> <em class="jd"> predict/ </em> </strong>目录下。然后在您的<strong class="ih hj"><em class="jd">predict/views . py</em></strong>文件中编写以下加载器类。该文件将使您能够<strong class="ih hj">加载和使用</strong>您保存的模型。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lj"><img src="../Images/c6b86c23f65c896c00d9342daf7ba667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HboEI-RTsu3AZVXuZhs60Q.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">啊，装载机</figcaption></figure><h1 id="ed80" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">服务器应用程序</h1><p id="1ae7" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">现在，让我们转向服务器应用程序。我们将使用令人惊叹的django rest框架编写一个简单的API视图。API视图调用我们刚刚编写的Loader类，并使用它的输出作为对POST请求的响应。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lk"><img src="../Images/a9cdd7bd7ca079233ad4c5dd1b26443f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V16hnoTPaunIdKSMmeX3LQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">我们使用BASE_DIR来跟踪<strong class="bd jg"> model.sav </strong>文件</figcaption></figure><p id="3637" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了，现在我们有了一个API视图，所有20个手指交叉应该可以完美地工作。等等，我们还有网址要管理。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ll"><img src="../Images/daa0662174d63d0bf8f8832f1c27cac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VuE3WrqqzVmYCbt2hRC4bg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">API“端点”</figcaption></figure><p id="46c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个端点将给出特定年龄的工资。</p><h1 id="bad7" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">没有更多的代码？</h1><p id="0cb2" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">不，没有更多的代码。这就是姜戈的魅力。为期限为xD的机器学习工程师制作。英雄联盟</p><p id="128f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，让我们通过用python编写一个简单的<strong class="ih hj"> POST </strong>请求来测试我们的代码。启动你的<strong class="ih hj"> python控制台</strong>。在那之前<code class="du lm ln lo la b">python manage.py runserver</code>在你的根目录上。</p><pre class="ki kj kk kl fd kz la lb lc aw ld bi"><span id="12c2" class="le jf hi la b fi lf lg l lh li">&gt;&gt;&gt; import requests as r<br/>&gt;&gt;&gt; v = r.post('<a class="ae kt" href="http://localhost:8000/server/api/salary/'" rel="noopener ugc nofollow" target="_blank"><strong class="la hj">http://localhost:8000/server/api/salary/</strong>'</a>, data=<strong class="la hj">{'exp': 5.6}</strong>)</span></pre><p id="46b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成，现在post请求应该可以工作了。让我们看看输出</p><pre class="ki kj kk kl fd kz la lb lc aw ld bi"><span id="16f2" class="le jf hi la b fi lf lg l lh li">&gt;&gt;&gt; v.text<br/>'79153.46992551646'</span></pre><p id="2abe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快速、充满活力和传奇色彩。</p><p id="fe5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在这个API可以在任何地方使用。在你的网站上，你的应用程序上，所有的一切。</p><p id="23ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要从不同的设备访问API，您可以考虑使用<a class="ae kt" href="https://ngrok.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">n rock</strong></a>，但是在投入生产时，我强烈推荐<strong class="ih hj"> pythonanywhere </strong>或<strong class="ih hj"> Heroku </strong>。</p><p id="264d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我想就是这样，现在你可以像一个传奇一样使用Django进行机器学习了。你可以在这个<a class="ae kt" href="https://github.com/rshrc/django-ml" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">资源库</strong> </a>里找到源代码。</p><p id="38eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">敬请期待更多<em class="jd">“像传奇一样使用X”</em></p><p id="1ffb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">拜拜！</em></p></div></div>    
</body>
</html>