<html>
<head>
<title>Python Exploratory Data Analysis (EDA) on NYC Airbnb</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">纽约 Airbnb 上的 Python 探索性数据分析(EDA)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-exploratory-data-analysis-eda-on-nyc-airbnb-cbeabd622e30?source=collection_archive---------2-----------------------#2020-10-05">https://medium.com/analytics-vidhya/python-exploratory-data-analysis-eda-on-nyc-airbnb-cbeabd622e30?source=collection_archive---------2-----------------------#2020-10-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/79b7a18b0005c8682ee30eea1ab45aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*juUlm8-b_uZ1DeUL"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">凯尔西·多迪在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="bd4e" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi ka translated"><span class="l kb kc kd bm ke kf kg kh ki di">答</span> irbnb 是一个在线市场，它将想出租房屋的人和在当地寻找住处的人联系起来。纽约是美国人口最多的城市，也是全球最受欢迎的旅游和商业城市之一。</p><p id="bd61" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">自 2008 年以来，客人和主人一直使用 Airbnb 来拓展旅行的可能性，并提供一种更独特、更个性化的体验世界的方式。如今，Airbnb 已经成为全世界都在使用的一种服务。对于这家通过 Airbnb 提供数百万房源的公司来说，数据分析师成为了一个至关重要的因素。这些列表会生成大量数据，这些数据可被分析并用于安全性、业务决策、了解客户和提供商在平台上的行为、实施创新的附加服务、指导营销计划等等。</p><h1 id="a7cc" class="kj kk hy bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">导入库</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="c0f1" class="lq kk hy lm b fi lr ls l lt lu">import pandas as pd</span><span id="6213" class="lq kk hy lm b fi lv ls l lt lu">import numpy as np</span><span id="1e37" class="lq kk hy lm b fi lv ls l lt lu">import matplotlib</span><span id="f80b" class="lq kk hy lm b fi lv ls l lt lu">import matplotlib.pyplot as plt</span><span id="b386" class="lq kk hy lm b fi lv ls l lt lu">import seaborn as sns</span></pre><h1 id="5119" class="kj kk hy bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">加载数据</h1><p id="20cb" class="pw-post-body-paragraph jc jd hy je b jf lw jh ji jj lx jl jm jn ly jp jq jr lz jt ju jv ma jx jy jz hb bi translated">我们使用的数据集是来自 Kaggle 的“<a class="ae hv" href="https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data" rel="noopener ugc nofollow" target="_blank">纽约 Airbnb 开放数据</a>”。使用 Pandas 库，我们将加载 CSV 文件。用 nyc_df 为数据集命名。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="85b2" class="lq kk hy lm b fi lr ls l lt lu">nyc_df = pd.read_csv(“AB_NYC_2019.csv”)</span></pre><h1 id="81e4" class="kj kk hy bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">数据分析和清理</h1><p id="6342" class="pw-post-body-paragraph jc jd hy je b jf lw jh ji jj lx jl jm jn ly jp jq jr lz jt ju jv ma jx jy jz hb bi translated">让我们总结一下现有的数据集。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="4c00" class="lq kk hy lm b fi lr ls l lt lu">Rows     : 48895<br/>Columns  : 16</span><span id="370e" class="lq kk hy lm b fi lv ls l lt lu">Features :<br/> ['id', 'name', 'host_id', 'host_name', 'neighbourhood_group', 'neighbourhood', 'latitude', 'longitude', 'room_type', 'price', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'calculated_host_listings_count', 'availability_365']</span><span id="00e6" class="lq kk hy lm b fi lv ls l lt lu">Missing Value    : 20141</span><span id="5410" class="lq kk hy lm b fi lv ls l lt lu">Columns with missing value:<br/>id                                False<br/>name                               True<br/>host_id                           False<br/>host_name                          True<br/>neighbourhood_group               False<br/>neighbourhood                     False<br/>latitude                          False<br/>longitude                         False<br/>room_type                         False<br/>price                             False<br/>minimum_nights                    False<br/>number_of_reviews                 False<br/>last_review                        True<br/>reviews_per_month                  True<br/>calculated_host_listings_count    False<br/>availability_365                  False<br/>dtype: bool</span></pre><p id="4057" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们有 4 列包含缺失值。现在，我们删除了不必要的列，如 id、name、host_name、last_review。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="c2e2" class="lq kk hy lm b fi lr ls l lt lu">nyc_df.drop([‘id’,’name’,’host_name’,’last_review’], axis=1, inplace=True)</span><span id="121b" class="lq kk hy lm b fi lv ls l lt lu">print(nyc_df.head())</span></pre><p id="ea09" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将“每月审核”中的所有 NaN 值替换为 0</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="540f" class="lq kk hy lm b fi lr ls l lt lu">nyc_df.reviews_per_month.fillna(0, inplace=True)</span><span id="34f8" class="lq kk hy lm b fi lv ls l lt lu">print(nyc_df.isnull().any())</span><span id="651d" class="lq kk hy lm b fi lv ls l lt lu">host_id                           False<br/>neighbourhood_group               False<br/>neighbourhood                     False<br/>latitude                          False<br/>longitude                         False<br/>room_type                         False<br/>price                             False<br/>minimum_nights                    False<br/>number_of_reviews                 False<br/>reviews_per_month                 False<br/>calculated_host_listings_count    False<br/>availability_365                  False<br/>dtype: bool</span></pre><p id="b666" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们再也没有错过价值。</p><h1 id="324f" class="kj kk hy bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">勘探数据和可视化</h1><p id="5c00" class="pw-post-body-paragraph jc jd hy je b jf lw jh ji jj lx jl jm jn ly jp jq jr lz jt ju jv ma jx jy jz hb bi translated">现在是时候探索我们的数据并将其可视化，以识别数据集之间的关系。</p><h2 id="cc56" class="lq kk hy bd kl mb mc md kp me mf mg kt jn mh mi kx jr mj mk lb jv ml mm lf mn bi translated">邻里小组</h2><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="f706" class="lq kk hy lm b fi lr ls l lt lu">plt.style.use('fivethirtyeight')</span><span id="385a" class="lq kk hy lm b fi lv ls l lt lu">plt.figure(figsize=(13,7))</span><span id="d192" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Neighbourhood Group")</span><span id="da1c" class="lq kk hy lm b fi lv ls l lt lu">g = plt.pie(nyc_df.neighbourhood_group.value_counts(), labels=nyc_df.neighbourhood_group.value_counts().index,autopct='%1.1f%%', startangle=180)</span><span id="c69d" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/48f14c878d35e0bb6458058c69b6acd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_ol8oD55WH4QsrWU699tg.png"/></div></div></figure><p id="e37c" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">上面的饼状图显示，纽约的 Airbnb 房源都在曼哈顿附近，布鲁克林的酒店份额最高。我们还从这幅邻里关系图中得知。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="9f35" class="lq kk hy lm b fi lr ls l lt lu">plt.style.use('fivethirtyeight')</span><span id="dc58" class="lq kk hy lm b fi lv ls l lt lu">plt.figure(figsize=(13,7))</span><span id="4fc4" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Neighbourhood Group")</span><span id="2630" class="lq kk hy lm b fi lv ls l lt lu">g = plt.pie(nyc_df.neighbourhood_group.value_counts(), labels=nyc_df.neighbourhood_group.value_counts().index,autopct='%1.1f%%', startangle=180)</span><span id="4732" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/facf0faa699e7ae58b0c9e7d8fc88e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zaSGlFy0qj2KfkxuUy2r-g.png"/></div></div></figure><h2 id="b2e5" class="lq kk hy bd kl mb mc md kp me mf mg kt jn mh mi kx jr mj mk lb jv ml mm lf mn bi translated">—房间详情</h2><p id="1248" class="pw-post-body-paragraph jc jd hy je b jf lw jh ji jj lx jl jm jn ly jp jq jr lz jt ju jv ma jx jy jz hb bi translated">让我们看看房间的类型。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="b6ab" class="lq kk hy lm b fi lr ls l lt lu">plt.figure(figsize=(13,7))</span><span id="a136" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Type of Room")</span><span id="a8f2" class="lq kk hy lm b fi lv ls l lt lu">sns.countplot(nyc_df.room_type, palette="muted")</span><span id="c789" class="lq kk hy lm b fi lv ls l lt lu">fig = plt.gcf()</span><span id="8813" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/55db6bd22df6d07b5e96c9f7444d43aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29vqko1HA9kgW6pafkKblQ.png"/></div></div></figure><p id="05ac" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们可以看到，整个住宅/公寓的份额最高，其次是私人房间，最不喜欢的是合租房间。</p><p id="d76d" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">让我们来看看某个邻居组所住的房间类型。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="a525" class="lq kk hy lm b fi lr ls l lt lu">plt.figure(figsize=(13,7))</span><span id="5bb7" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Room Type on Neighbourhood Group")</span><span id="ab06" class="lq kk hy lm b fi lv ls l lt lu">sns.countplot(nyc_df.neighbourhood_group,hue=nyc_df.room_type, palette="muted")</span><span id="2c70" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/e1893b79256d2524afd5b57481374e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A70SMPVmu--NW1G6CT5qKQ.png"/></div></div></figure><p id="7486" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">图表显示，整个住宅/公寓最靠近曼哈顿，而靠近布鲁克林的私人房间和公寓几乎相等。</p><h2 id="b238" class="lq kk hy bd kl mb mc md kp me mf mg kt jn mh mi kx jr mj mk lb jv ml mm lf mn bi translated">—邻里小组与空房间</h2><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="37c9" class="lq kk hy lm b fi lr ls l lt lu">plt.style.use('classic')</span><span id="10a5" class="lq kk hy lm b fi lv ls l lt lu">plt.figure(figsize=(13,7))</span><span id="7cf9" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Neighbourhood Group vs. Availability Room")</span><span id="365a" class="lq kk hy lm b fi lv ls l lt lu">sns.boxplot(data=nyc_df, x='neighbourhood_group',y='availability_365',palette="dark")</span><span id="bbf8" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/2cd1f2d021d2e49e2d640a87289b3fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TK8MKuFdxKsuKPp2A9rVXw.png"/></div></div></figure><p id="6d16" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">上图显示了可用房间和邻居组之间的关系。</p><h2 id="84a2" class="lq kk hy bd kl mb mc md kp me mf mg kt jn mh mi kx jr mj mk lb jv ml mm lf mn bi translated">—邻里群体价格分布</h2><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="35d3" class="lq kk hy lm b fi lr ls l lt lu">plt.figure(figsize=(13,7))</span><span id="a8da" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Map of Price Distribution")</span><span id="858a" class="lq kk hy lm b fi lv ls l lt lu">ax=nyc_df[nyc_df.price&lt;500].plot(kind='scatter', x='longitude',y='latitude',label='availability_365',c='price',cmap=plt.get_cmap('jet'),colorbar=True,alpha=0.4)</span><span id="4c8c" class="lq kk hy lm b fi lv ls l lt lu">ax.legend()</span><span id="7d75" class="lq kk hy lm b fi lv ls l lt lu">plt.ioff()</span><span id="022b" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/0c7b85713a45f14a2f8eae05f91f2aa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mCKq0-dpoBx-KnJ61H4AEw.png"/></div></div></figure><p id="9090" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们从上面的图表中得到的信息是红色点是价格较高的房间。还有，我们可以看到曼哈顿地区的房价更贵。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="fc37" class="lq kk hy lm b fi lr ls l lt lu">plt.style.use('classic')</span><span id="8606" class="lq kk hy lm b fi lv ls l lt lu">plt.figure(figsize=(13,7))</span><span id="83c9" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Neighbourhood Group Price Distribution &lt; 500")</span><span id="4672" class="lq kk hy lm b fi lv ls l lt lu">sns.boxplot(y="price",x ='neighbourhood_group' ,data = nyc_df[nyc_df.price&lt;500])</span><span id="4a88" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/1052733606ec8a7e21c0fcd24fb8770d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NJZ-o83nCefnPrIvTg7XNw.png"/></div></div></figure><p id="d7a5" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">从上面的箱线图中，我们肯定可以观察到纽约 Airbnb 价格分布的一些情况。</p><ol class=""><li id="93b0" class="mq mr hy je b jf jg jj jk jn ms jr mt jv mu jz mv mw mx my bi translated">我们可以声明曼哈顿具有列表的最高范围价格，平均价格大约为 140 美元，其次是布鲁克林，每晚 90 美元，</li><li id="2f30" class="mq mr hy je b jf mz jj na jn nb jr nc jv nd jz mv mw mx my bi translated">皇后区和斯塔滕岛的分布似乎非常相似，</li><li id="9733" class="mq mr hy je b jf mz jj na jn nb jr nc jv nd jz mv mw mx my bi translated">布朗克斯是最便宜的。</li></ol><h1 id="0ccf" class="kj kk hy bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">价格预测</h1><p id="cb6e" class="pw-post-body-paragraph jc jd hy je b jf lw jh ji jj lx jl jm jn ly jp jq jr lz jt ju jv ma jx jy jz hb bi translated">让我们看看各列之间的相关性。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5f53" class="lq kk hy lm b fi lr ls l lt lu">corr = nyc_df.corr(method='kendall')</span><span id="f6cc" class="lq kk hy lm b fi lv ls l lt lu">plt.figure(figsize=(13,10))</span><span id="b482" class="lq kk hy lm b fi lv ls l lt lu">plt.title("Correlation Between Different Variables\n")</span><span id="1539" class="lq kk hy lm b fi lv ls l lt lu">sns.heatmap(corr, annot=True)</span><span id="6eaa" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/3936100c6ba121d7040e2087aae41e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VgcgGDScKX-JRcqaeNIb8Q.png"/></div></div></figure><p id="1f5c" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">从上面的图表中，我们知道除了每月审查次数和审查次数之外，没有很强的相关性。</p><p id="85e7" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hz"> —线性回归</strong></p><p id="46a6" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在，让我们尝试使用来自<a class="ae hv" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit learn </a>的基本机器学习模型进行价格预测。Scikit learn 是 Python 编程语言的免费软件机器学习库。</p><p id="0f2a" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">用于机器学习的导入库</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="41ba" class="lq kk hy lm b fi lr ls l lt lu">from sklearn.model_selection import train_test_split</span><span id="aea4" class="lq kk hy lm b fi lv ls l lt lu">from sklearn.linear_model import LinearRegression</span><span id="fac6" class="lq kk hy lm b fi lv ls l lt lu">from sklearn import metrics</span><span id="13b0" class="lq kk hy lm b fi lv ls l lt lu">from sklearn.metrics import mean_squared_error,r2_score, mean_absolute_error</span><span id="7fc0" class="lq kk hy lm b fi lv ls l lt lu">from sklearn import preprocessing<br/>import warnings</span><span id="c5b1" class="lq kk hy lm b fi lv ls l lt lu">warnings.filterwarnings('ignore')</span></pre><p id="2ca9" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">然后，用 0 和 n_classes-1 之间的值对标签进行编码</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="bf98" class="lq kk hy lm b fi lr ls l lt lu">encode = preprocessing.LabelEncoder()</span></pre><p id="88c1" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">安装标签编码器</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="e38b" class="lq kk hy lm b fi lr ls l lt lu">encode.fit(nyc_df.neighbourhood_group)</span><span id="e798" class="lq kk hy lm b fi lv ls l lt lu">nyc_df.neighbourhood_group=encode.transform(nyc_df.neighbourhood_group)</span></pre><p id="e30e" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将标签转换为规范化编码</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="19b4" class="lq kk hy lm b fi lr ls l lt lu">encode = preprocessing.LabelEncoder()</span><span id="3cff" class="lq kk hy lm b fi lv ls l lt lu">encode.fit(nyc_df.neighbourhood)</span><span id="f4fc" class="lq kk hy lm b fi lv ls l lt lu">nyc_df.neighbourhood=encode.transform(nyc_df.neighbourhood)</span><span id="54a5" class="lq kk hy lm b fi lv ls l lt lu">encode = preprocessing.LabelEncoder()</span><span id="8c9a" class="lq kk hy lm b fi lv ls l lt lu">encode.fit(nyc_df.room_type)</span><span id="4486" class="lq kk hy lm b fi lv ls l lt lu">nyc_df.room_type=encode.transform(nyc_df.room_type)</span><span id="217b" class="lq kk hy lm b fi lv ls l lt lu">nyc_df.sort_values(by='price',ascending=True,inplace=True)</span></pre><p id="0639" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在，训练线性回归模型</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="710c" class="lq kk hy lm b fi lr ls l lt lu">l_reg = LinearRegression()</span><span id="bece" class="lq kk hy lm b fi lv ls l lt lu">X = nyc_df[['host_id','neighbourhood_group','neighbourhood','latitude','longitude','room_type','minimum_nights','number_of_reviews','reviews_per_month','calculated_host_listings_count','availability_365']]</span><span id="8041" class="lq kk hy lm b fi lv ls l lt lu">y = nyc_df['price']</span><span id="fe44" class="lq kk hy lm b fi lv ls l lt lu">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=101)</span><span id="6b47" class="lq kk hy lm b fi lv ls l lt lu">l_reg.fit(X_train,y_train)</span></pre><p id="cadc" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">价格预测</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="7095" class="lq kk hy lm b fi lr ls l lt lu">predicts = l_reg.predict(X_test)</span><span id="6111" class="lq kk hy lm b fi lv ls l lt lu">print("Mean Squared Error: ", np.sqrt(metrics.mean_squared_error(y_test, predicts)))</span><span id="079e" class="lq kk hy lm b fi lv ls l lt lu">print("R2 Score: ", r2_score(y_test,predicts) * 100)</span><span id="4ecd" class="lq kk hy lm b fi lv ls l lt lu">print("Mean Absolute Error: ", mean_absolute_error(y_test,predicts))</span><span id="f49e" class="lq kk hy lm b fi lv ls l lt lu">print("Mean Squareroot Error: ", mean_squared_error(y_test,predicts))</span></pre><p id="20b2" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们从线性回归模型中得到的输出</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5601" class="lq kk hy lm b fi lr ls l lt lu">Mean Squared Error:  180.73409656936212<br/>R2 Score:  11.639576782324035<br/>Mean Absolute Error:  72.86091366825374<br/>Mean Squareroot Error:  32664.813662743516</span></pre><p id="1a2e" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">接下来，我们想知道实际价格和预测价格之间的差异。让我们从制作一个名为 lr_pred_df 新数据帧开始</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="4ce6" class="lq kk hy lm b fi lr ls l lt lu">lr_pred_df = pd.DataFrame({</span><span id="b0b7" class="lq kk hy lm b fi lv ls l lt lu">‘actual_values’: np.array(y_test).flatten(),</span><span id="d316" class="lq kk hy lm b fi lv ls l lt lu">‘predicted_values’: predicts.flatten()}).head(20)</span></pre><p id="fcf1" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">然后想象它</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="33a3" class="lq kk hy lm b fi lr ls l lt lu">x = lr_pred_df.index</span><span id="7000" class="lq kk hy lm b fi lv ls l lt lu">width = 0.35</span><span id="d438" class="lq kk hy lm b fi lv ls l lt lu">fig, ax = plt.subplots()</span><span id="1325" class="lq kk hy lm b fi lv ls l lt lu">rects1 = ax.bar(x - width/2, lr_pred_df.actual_values, width, label='Actual Values')</span><span id="162c" class="lq kk hy lm b fi lv ls l lt lu">rects2 = ax.bar(x + width/2, lr_pred_df.predicted_values, width, label='Predicted Values')</span><span id="3ee7" class="lq kk hy lm b fi lv ls l lt lu">ax.set_ylabel('Price')</span><span id="27bb" class="lq kk hy lm b fi lv ls l lt lu">ax.set_title('Actual Vs Predicted for Linear Regression')</span><span id="a891" class="lq kk hy lm b fi lv ls l lt lu">ax.set_xticks(x)</span><span id="e91b" class="lq kk hy lm b fi lv ls l lt lu">ax.legend()</span><span id="d097" class="lq kk hy lm b fi lv ls l lt lu">fig.tight_layout()</span><span id="8bc0" class="lq kk hy lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/7fc9d0f89832a83230aa9b15d0bb998f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*THjQV_IcnyjhwGA-eeHZiw.png"/></div></div></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="c7cb" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">您可以通过我的 GitHub 下载数据和 python 代码文档:</p><div class="hh hi ez fb hj ne"><a href="https://github.com/dwiknrd/medium-code/tree/master/ny-airbnb" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab dw"><div class="ng ab nh cl cj ni"><h2 class="bd hz fi z dy nj ea eb nk ed ef hx bi translated">dwiknrd/中等代码</h2><div class="nl l"><h3 class="bd b fi z dy nj ea eb nk ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nm l"><p class="bd b fp z dy nj ea eb nk ed ef dx translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns hp ne"/></div></div></a></div></div></div>    
</body>
</html>