<html>
<head>
<title>Dynamically Combine Multiple Sheets p# 1: Power Query</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动态组合多张图纸p# 1:电源查询</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dynamically-combine-multiple-sheets-p-1-power-query-fa182a2888ad?source=collection_archive---------10-----------------------#2020-08-02">https://medium.com/analytics-vidhya/dynamically-combine-multiple-sheets-p-1-power-query-fa182a2888ad?source=collection_archive---------10-----------------------#2020-08-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/ddced4fae32537a3337bba22f7d3c32f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ORq39RNnx22JhioygddXtw.png"/></div></figure><p id="7e99" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在开始分析数据之前，分析师的关键任务之一是合并和转换数据。在这种情况下，Power Query非常方便。</p><h1 id="d1f8" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">案例:当源数据与输出表位于不同的工作簿中时</h1><p id="ca31" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">基本的假设是所有的工作表都有相同的数据表结构。</p><p id="b35c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于与输出表相同的源表，请参考文章:</p><div class="kn ko ez fb kp kq"><a href="https://www.vivran.in/post/dynamically-append-multiple-sheets-p-2-power-query" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hj fi z dy kv ea eb kw ed ef hh bi translated">动态追加多张图纸p# 2:超级查询</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">对于不同于输出表的源表，请参考文章:动态组合多个表p#1数据是…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.vivran.in</p></div></div><div class="kz l"><div class="la l lb lc ld kz le ik kq"/></div></div></a></div><h1 id="8b46" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">示例数据表</h1><p id="8d41" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">数据在四张不同的表上。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/102499e8f576572bcfeba1cb8b21802d.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*85HGEX1vNbYJbId8.gif"/></div></figure><p id="d021" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lk" href="https://vivranin-my.sharepoint.com/:x:/g/personal/vivek_ranjan_vivran_in/EU8-J9vE0uZLnWJ2e2EUOWoBDWC5etkivobt9pEWBSsvqw?e=n2VRUJ" rel="noopener ugc nofollow" target="_blank">下载样本数据</a></p><h1 id="2e35" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">第一步:获取数据</h1><p id="c2a9" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">数据&gt;获取数据&gt;从文件&gt;从工作簿</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/7091148bf9c848bf193764113413ac4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*-lyAU20gDoFnWO6tIWLaRQ.png"/></div></figure><p id="7492" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">选择一个工作表&gt;转换数据</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/c06182c0299b4d8e138074e4b1a3d7cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7HoXtw-LLVUrxVJtv_bYg.png"/></div></div></figure><h1 id="84c1" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">步骤2:删除除源代码之外的所有步骤</h1><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/78ac6b287521ac3e2400ee2ff5b81cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*tT7Q-isKgZOzPwM5zcS4-g.png"/></div></figure><h1 id="7238" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">步骤3:右键单击数据列&gt;删除其他列</h1><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ls"><img src="../Images/3595d3ade95f424d796e65d8dfcc78c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdWAKsEjqigC1VT7edi7Mg.png"/></div></div></figure><h1 id="ea49" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">步骤4:展开数据列。</h1><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/f110746eb8ed62ac9bd94fca29f09c73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*7zBylmtJokm04RGx7BEzgQ.png"/></div></figure><h1 id="3195" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">第五步:调整标题</h1><p id="a9f0" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">主页&gt;使用第一行作为标题</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lu"><img src="../Images/8f31353103e9066d3ee3efac92e03458.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*89m19GOIM_utRaZ9ya4GkA.png"/></div></div></figure><p id="773c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">过滤掉剩余的标题行。</p><p id="9f75" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">右键单击&gt;过滤器&gt;不等于</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/492b34fb918bf2a82afbced39dd0ef17.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*hYquYmUQSvsqSdrxhhbL0g.png"/></div></figure><h1 id="c5ec" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">结果</h1><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/2ca6019233a20aa67dc408398f1e9ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*QNgVWt-_5CbAqWgRVu7Neg.png"/></div></figure><h1 id="0162" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">包括工作表名称</h1><p id="a301" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">如果我们需要在最终输出中包含工作表名称，请在步骤3中进行以下调整。</p><p id="1e01" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">选择名称+数据列&gt;右键单击&gt;删除其他列</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/5d33ec9fe4070fe62925098abdbaf201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*oOrsHWyc4-35kJCSIfhtYw.png"/></div></figure><h1 id="17c1" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">动态输出</h1><p id="37d2" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">将查询输出加载到数据透视表中。</p><p id="b184" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">主页&gt;关闭并加载到&gt;数据透视表</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/df36074acca1ea636031a0084de4fe60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*2rV2S8Rf8ouvYei8.gif"/></div></figure><p id="6a5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">工作簿中的任何更改，Power Query都会相应地更新输出。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/d0bda3354c1efa6108936f5e1b16c5c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*rRkUs3f89uQZ2s_m.gif"/></div></figure><div class="kn ko ez fb kp kq"><a href="https://www.vivran.in/post/dynamically-append-multiple-sheets-p-2-power-query" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hj fi z dy kv ea eb kw ed ef hh bi translated">动态追加多张图纸p# 2:超级查询</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">对于不同于输出表的源表，请参考文章:动态组合多个表p#1数据是…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.vivran.in</p></div></div><div class="kz l"><div class="la l lb lc ld kz le ik kq"/></div></div></a></div><div class="kn ko ez fb kp kq"><a href="https://www.vivran.in/post/combining-multiple-files-in-a-folder-power-query" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hj fi z dy kv ea eb kw ed ef hh bi translated">将多个文件合并到一个文件夹中:超级查询</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">想象一下:有一个2019年的文件夹。一年中的每个月有12个文件。所有的文件都有…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.vivran.in</p></div></div><div class="kz l"><div class="lz l lb lc ld kz le ik kq"/></div></div></a></div></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><p id="0265" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="mh">我写关于</em><a class="ae lk" href="https://www.vivran.in/my-blog/categories/excel" rel="noopener ugc nofollow" target="_blank"><em class="mh">MS Excel</em></a><em class="mh"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/powerquery" rel="noopener ugc nofollow" target="_blank"><em class="mh">权力查询</em></a><em class="mh"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/powerbi" rel="noopener ugc nofollow" target="_blank"><em class="mh">权力毕</em></a><em class="mh"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/power-pivot" rel="noopener ugc nofollow" target="_blank"><em class="mh">权力中枢</em></a><em class="mh"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/dax" rel="noopener ugc nofollow" target="_blank"><em class="mh">DAX</em></a><em class="mh"/><a class="ae lk" href="https://www.vivran.in/my-blog/categories/data-analytics" rel="noopener ugc nofollow" target="_blank"><em class="mh">数据分析【数据</em></a></p><p id="e881" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae lk" href="https://twitter.com/imvivran" rel="noopener ugc nofollow" target="_blank"> @imVivRan </a></p></div></div>    
</body>
</html>