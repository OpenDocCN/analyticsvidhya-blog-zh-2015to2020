<html>
<head>
<title>Gold Price Forecast using Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于神经网络的黄金价格预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/gold-price-forecast-using-neural-networks-37ac4e6600c1?source=collection_archive---------10-----------------------#2020-10-05">https://medium.com/analytics-vidhya/gold-price-forecast-using-neural-networks-37ac4e6600c1?source=collection_archive---------10-----------------------#2020-10-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="c029" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">步骤1:-关于数据集和基本操作的信息</p><p id="89cb" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">步骤2:-数据集的可视化。</p><p id="9394" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">步骤3:-制作用于预测的窗口数据集</p><p id="fde2" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">步骤4:-建立神经网络并在窗口数据集上训练和验证</p></blockquote></div><div class="ab cl jh ji gp jj" role="separator"><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm"/></div><div class="hb hc hd he hf"><p id="036c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">ipynb笔记本文件和数据集的链接如下</p><div class="jr js ez fb jt ju"><a href="https://github.com/akshayardeshana/Gold-forecasting" rel="noopener  ugc nofollow" target="_blank"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hj fi z dy jz ea eb ka ed ef hh bi translated">akshayardeshana/黄金预测</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">通过在GitHub上创建帐户，为akshayardeshana/黄金预测发展做出贡献。</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">github.com</p></div></div><div class="kd l"><div class="ke l kf kg kh kd ki kj ju"/></div></div></a></div><blockquote class="kk"><p id="4e1f" class="kl km hi bd kn ko kp kq kr ks kt jg dx translated">步骤1:-关于数据集和基本操作的信息</p></blockquote><p id="fc92" class="pw-post-body-paragraph ii ij hi il b im ku io ip iq kv is it jo kw iw ix jp kx ja jb jq ky je jf jg hb bi translated">该数据集包含有关黄金和白银价格的信息。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="67f3" class="li lj hi le b fi lk ll l lm ln">import pandas as pd</span><span id="87cc" class="li lj hi le b fi lo ll l lm ln">gold_data=pd.read_csv('/content/drive/MyDrive/dataset/Goldsorted_final.csv')</span><span id="5046" class="li lj hi le b fi lo ll l lm ln">gold_data</span></pre><figure class="kz la lb lc fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lp"><img src="../Images/61476ae5d405d614a0200973c1aac839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rXtzCLBnYllJp-RUWR1Olg.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">黄金数据集</figcaption></figure><p id="83ac" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">在这个数据集中，价格是从2019年8月22日到2020年9月28日。</p><blockquote class="kk"><p id="f96c" class="kl km hi bd kn ko ma mb mc md me jg dx translated">步骤2:-数据集的可视化</p></blockquote><p id="2dae" class="pw-post-body-paragraph ii ij hi il b im ku io ip iq kv is it jo kw iw ix jp kx ja jb jq ky je jf jg hb bi translated"><strong class="il hj">我们使用的是TensorFlow 2.3.0版本。</strong></p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="46a9" class="li lj hi le b fi lk ll l lm ln">import tensorflow as tf</span><span id="8fa9" class="li lj hi le b fi lo ll l lm ln">import numpy as np</span><span id="9d2f" class="li lj hi le b fi lo ll l lm ln">import matplotlib.pyplot as plt</span><span id="feea" class="li lj hi le b fi lo ll l lm ln">print(tf.__version__)</span></pre><p id="3c8d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">为这个情节写一个函数。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="c460" class="li lj hi le b fi lk ll l lm ln">def plot_series(time, series, format="-", start=0, end=None):</span><span id="f1ec" class="li lj hi le b fi lo ll l lm ln">  plt.plot(time[start:end], series[start:end], format)</span><span id="42a4" class="li lj hi le b fi lo ll l lm ln">  plt.xlabel("index")</span><span id="3f3f" class="li lj hi le b fi lo ll l lm ln">  plt.ylabel("Gold 999(AM Price)")</span><span id="f726" class="li lj hi le b fi lo ll l lm ln">  plt.grid(True)</span></pre><p id="775f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">为可视化绘制图表。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="03d7" class="li lj hi le b fi lk ll l lm ln">import csv</span><span id="d288" class="li lj hi le b fi lo ll l lm ln">time_step = []</span><span id="ff6f" class="li lj hi le b fi lo ll l lm ln">goldinfo = []</span><span id="09a8" class="li lj hi le b fi lo ll l lm ln">with open('/content/drive/My Drive/dataset/Goldsorted_final.csv') as csvfile:</span><span id="de46" class="li lj hi le b fi lo ll l lm ln">reader = csv.reader(csvfile, delimiter=',')</span><span id="6f2a" class="li lj hi le b fi lo ll l lm ln">  next(reader)</span><span id="d1ac" class="li lj hi le b fi lo ll l lm ln">  for row in reader:</span><span id="a2ef" class="li lj hi le b fi lo ll l lm ln">    goldinfo.append(float(row[2]))</span><span id="b350" class="li lj hi le b fi lo ll l lm ln">    time_step.append(int(row[0]))</span><span id="6f73" class="li lj hi le b fi lo ll l lm ln">series = np.array(goldinfo)</span><span id="1974" class="li lj hi le b fi lo ll l lm ln">time = np.array(time_step)</span><span id="ffa4" class="li lj hi le b fi lo ll l lm ln">plt.figure(figsize=(10, 6))</span><span id="e1a9" class="li lj hi le b fi lo ll l lm ln">plot_series(time, series)</span></pre><figure class="kz la lb lc fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es mf"><img src="../Images/4797d5e1564eeab32d45b73f0074e258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QezefMha39_Iyz8tByd2jQ.png"/></div></div></figure><p id="a609" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">上面我们用一个指数作为时间，用黄金999(AM价格)列作为值。</p><blockquote class="kk"><p id="07c9" class="kl km hi bd kn ko ma mb mc md me jg dx translated">步骤3:-制作用于预测的窗口数据集</p></blockquote><p id="3e99" class="pw-post-body-paragraph ii ij hi il b im ku io ip iq kv is it jo kw iw ix jp kx ja jb jq ky je jf jg hb bi translated">我们使用窗口数据集的概念来制作这个数据集。</p><p id="de85" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">有关窗口数据集的更多信息，您可以参考下面的链接…</p><div class="jr js ez fb jt ju"><a href="https://www.tensorflow.org/api_docs/python/tf/data/Dataset#window" rel="noopener  ugc nofollow" target="_blank"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hj fi z dy jz ea eb ka ed ef hh bi translated">TF . data . dataset | tensor flow Core v 2 . 3 . 0</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">表示一个潜在的大型元素集。</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">www.tensorflow.org</p></div></div></div></a></div><p id="447e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">在这种情况下，我们使用窗口大小为10，这意味着1到10的索引用作输入值X，11的值用作标签y。使用TensorFlow，我们可以很容易地做到这一点。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="af78" class="li lj hi le b fi lk ll l lm ln">split_time = 200</span><span id="95f5" class="li lj hi le b fi lo ll l lm ln">time_train = time[:split_time]</span><span id="6cdd" class="li lj hi le b fi lo ll l lm ln">x_train = series[:split_time]</span><span id="a4ac" class="li lj hi le b fi lo ll l lm ln">time_valid = time[split_time:]</span><span id="6c02" class="li lj hi le b fi lo ll l lm ln">x_valid = series[split_time:]</span><span id="4633" class="li lj hi le b fi lo ll l lm ln">window_size = 10</span><span id="f758" class="li lj hi le b fi lo ll l lm ln">batch_size = 4</span><span id="eff7" class="li lj hi le b fi lo ll l lm ln">shuffle_buffer_size = 77</span><span id="0ad8" class="li lj hi le b fi lo ll l lm ln">def windowed_dataset(series, window_size, batch_size, shuffle_buffer):</span><span id="0f57" class="li lj hi le b fi lo ll l lm ln">  dataset = tf.data.Dataset.from_tensor_slices(series)</span><span id="cfa6" class="li lj hi le b fi lo ll l lm ln">  dataset = dataset.window(window_size + 1, shift=1,      drop_remainder=True)</span><span id="e965" class="li lj hi le b fi lo ll l lm ln">  dataset = dataset.flat_map(lambda window: window.batch(window_size + 1))</span><span id="ad0e" class="li lj hi le b fi lo ll l lm ln">  dataset = dataset.shuffle(shuffle_buffer).map(lambda window: (window[:-1], window[-1]))</span><span id="aa92" class="li lj hi le b fi lo ll l lm ln">  dataset = dataset.batch(batch_size).prefetch(1)</span><span id="3b56" class="li lj hi le b fi lo ll l lm ln">  return dataset</span></pre><p id="cd8c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">上面代码片段中的windowed_dataset函数用于创建一个窗口数据集。</p><p id="f5a1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">让我们调用windowed_dataset函数…</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="a2bf" class="li lj hi le b fi lk ll l lm ln">dataset = windowed_dataset(x_train, window_size, batch_size, shuffle_buffer_size)</span></pre><blockquote class="kk"><p id="cdbf" class="kl km hi bd kn ko kp kq kr ks kt jg dx translated">步骤4:-建立神经网络并在窗口数据集上训练和验证</p></blockquote><p id="e01d" class="pw-post-body-paragraph ii ij hi il b im ku io ip iq kv is it jo kw iw ix jp kx ja jb jq ky je jf jg hb bi translated">我们正在使用<strong class="il hj"> <em class="ik">密集层</em> </strong>和<strong class="il hj"> <em class="ik">整流线性单元</em> </strong>激活功能。</p><p id="03a0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">这个项目中使用的优化器是<strong class="il hj"> <em class="ik"> Adam </em> </strong>。Adam是一种优化算法，可用于根据训练数据迭代更新网络权重。</p><p id="fe68" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">本项目使用的损失函数为<a class="ae mg" href="https://peltarion.com/knowledge-center/documentation/modeling-view/build-an-ai-model/loss-functions/mean-squared-error" rel="noopener ugc nofollow" target="_blank"><strong class="il hj"><em class="ik">MSE</em></strong></a>。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="a74e" class="li lj hi le b fi lk ll l lm ln">model = tf.keras.models.Sequential([</span><span id="dde6" class="li lj hi le b fi lo ll l lm ln">tf.keras.layers.Dense(64, input_shape=[window_size], activation="relu"),</span><span id="7af7" class="li lj hi le b fi lo ll l lm ln">tf.keras.layers.Dense(32, input_shape=[window_size], activation="relu"),</span><span id="7f18" class="li lj hi le b fi lo ll l lm ln">tf.keras.layers.Dense(16, input_shape=[window_size], activation="relu"),</span><span id="b4a5" class="li lj hi le b fi lo ll l lm ln">tf.keras.layers.Dense(8, activation="relu"),</span><span id="6ffe" class="li lj hi le b fi lo ll l lm ln">tf.keras.layers.Dense(1)</span><span id="07b1" class="li lj hi le b fi lo ll l lm ln">])</span><span id="be8e" class="li lj hi le b fi lo ll l lm ln">model.compile(loss="mse", optimizer=tf.keras.optimizers.Adam())</span><span id="d6ee" class="li lj hi le b fi lo ll l lm ln">model1=model.fit(dataset,epochs=1000)</span></pre></div><div class="ab cl jh ji gp jj" role="separator"><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm"/></div><div class="hb hc hd he hf"><pre class="ld le lf lg aw lh bi"><span id="4b22" class="li lj hi le b fi mh mi mj mk ml ll l lm ln">forecast=[]</span><span id="dad0" class="li lj hi le b fi lo ll l lm ln">for time in range(len(series) - window_size):</span><span id="276f" class="li lj hi le b fi lo ll l lm ln">  forecast.append(model.predict(series[time:time + window_size][np.newaxis]))</span><span id="c8ac" class="li lj hi le b fi lo ll l lm ln">forecast = forecast[split_time-window_size:]</span><span id="5041" class="li lj hi le b fi lo ll l lm ln">results = np.array(forecast)[:, 0, 0]</span><span id="9716" class="li lj hi le b fi lo ll l lm ln">plt.figure(figsize=(10, 6))</span><span id="88ea" class="li lj hi le b fi lo ll l lm ln">plot_series(time_valid, x_valid)</span><span id="7f3b" class="li lj hi le b fi lo ll l lm ln">plot_series(time_valid, results)</span></pre><figure class="kz la lb lc fd lq er es paragraph-image"><div class="er es mm"><img src="../Images/d0781b2d7ba755148af4561676ab6d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*HqMJmP95IdcGBzbvxpoMQg.png"/></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="e8e1" class="li lj hi le b fi lk ll l lm ln">tf.keras.metrics.mean_absolute_error(x_valid, results).numpy()</span></pre><figure class="kz la lb lc fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lp"><img src="../Images/ebca026cb2f04d33c4f695e6442f9eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXuGbJVFRd2wINif5MVYbA.png"/></div></div></figure><p id="c22e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jo iv iw ix jp iz ja jb jq jd je jf jg hb bi translated">太棒了。😜</p></div></div>    
</body>
</html>