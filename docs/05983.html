<html>
<head>
<title>Machine Learning — Simple Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习—简单线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-simple-linear-regression-ead2b5306c62?source=collection_archive---------30-----------------------#2020-05-07">https://medium.com/analytics-vidhya/machine-learning-simple-linear-regression-ead2b5306c62?source=collection_archive---------30-----------------------#2020-05-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ea058aeaf5a3b6bf0b569a48262dfeeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oGCWEnkXlg383wFVq8Qbiw.png"/></div></div></figure><h1 id="d0e5" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">先决条件</h1><ul class=""><li id="136f" class="jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><a class="ae kg" rel="noopener" href="/analytics-vidhya/machine-learning-data-prepossessing-661d18f063c3">机器学习—数据预处理</a></li></ul><h1 id="908b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">概观</h1><p id="02c7" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">以下是我们将在博客中涉及的话题。</p><ul class=""><li id="9143" class="jo jp hi jq b jr kw jt kx jv ky jx kz jz la kb kc kd ke kf bi translated">揭秘简单线性回归</li><li id="adf1" class="jo jp hi jq b jr lb jt lc jv ld jx le jz lf kb kc kd ke kf bi translated">简单线性回归的常见例子</li><li id="bcff" class="jo jp hi jq b jr lb jt lc jv ld jx le jz lf kb kc kd ke kf bi translated">趋势线和简单线性回归</li><li id="6434" class="jo jp hi jq b jr lb jt lc jv ld jx le jz lf kb kc kd ke kf bi translated">简单线性回归的实现<br/> <strong class="jq hj"> - </strong>步骤1:数据预处理<br/> <strong class="jq hj"> - </strong>步骤2:训练模型<br/>-<strong class="jq hj">-</strong>步骤3:预测<br/>-<strong class="jq hj">-</strong>步骤4:可视化对训练和测试数据的预测</li></ul><h1 id="05a1" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">揭秘简单线性回归</h1><p id="fb7a" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">线性回归模型允许我们在两个连续(定量)变量之间建立关系。它是最简单的“回归”形式，通过对观察到的数据拟合一条线来描述变量之间的关系。下面的等式代表一个简单的线性回归模型:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/558d96d374b846b85394d041d1763c87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2Xlr97xw7HrOS1rt75CkQ.png"/></div></div></figure><p id="31eb" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">简单的线性模型用图形表示为:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/caac25ed5d6f183e21da7389a6a08e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kCD_o9A0UqSstePgs1gZsA.png"/></div></figure><p id="36cc" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">这里，</p><ul class=""><li id="d211" class="jo jp hi jq b jr kw jt kx jv ky jx kz jz la kb kc kd ke kf bi translated"><strong class="jq hj"> y </strong>为因变量。被预测的变量或方程求解的变量。</li><li id="b8e6" class="jo jp hi jq b jr lb jt lc jv ld jx le jz lf kb kc kd ke kf bi translated"><strong class="jq hj"> x </strong>是自变量，用于预测因变量的值。</li><li id="ba40" class="jo jp hi jq b jr lb jt lc jv ld jx le jz lf kb kc kd ke kf bi translated"><strong class="jq hj"> b1 </strong>是自变量的系数。它代表自变量(x)发生单位变化时因变量(y)的变化。</li><li id="0a71" class="jo jp hi jq b jr lb jt lc jv ld jx le jz lf kb kc kd ke kf bi translated"><strong class="jq hj"> b0 </strong>是常数，表示直线感兴趣的垂直轴上的点。</li></ul><h1 id="9571" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">简单线性回归的常见例子</h1><ol class=""><li id="936c" class="jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb lp kd ke kf bi translated">对学生的学习时间和平均成绩进行分析。找出学生学习的小时数和他们获得的GPA之间的关系。这里，小时数是因变量，GPA是因变量。在这种情况下，等式将为:<br/> <strong class="jq hj"> GPA = b0 + b1*小时数</strong></li><li id="811d" class="jo jp hi jq b jr lb jt lc jv ld jx le jz lf kb lp kd ke kf bi translated">分析一个人的工资是如何随着他所拥有的经验年限而变化的。在这里，工作年限是因变量，工资是因变量。这种情况下，等式会是:<br/> <strong class="jq hj">工资= b0 + b1 *经验</strong></li></ol><h1 id="a620" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">趋势线和简单线性回归</h1><p id="90bd" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">如前所述，回归模型通过对观察数据进行直线拟合来描述变量之间关系。这条线被称为“趋势线”。它是最符合数据的线。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/82cff1a2d7a5f11f251bdfa22d2b0a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*bHLZy0rlZ2qbjSFweefc5A.png"/></div></figure><p id="1289" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">现在的问题是，简单的线性回归如何找到最符合数据的直线。实际上，它使用了一种称为<strong class="jq hj">“普通最小二乘法”</strong>的技术来寻找趋势线。该算法将绘制尽可能多的线，然后为每条线计算数据点到y-y '线的距离。之后，计算所有数据点到直线距离的平方和，即SUM(y-y ')<em class="lr">。</em>现在，将对每条绘制的线进行计算。最后，该算法将选择具有最小距离平方和的线，并将该线用作趋势线。</p><h1 id="83bf" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">简单线性回归的实现</h1><p id="d672" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">我将使用来自Kaggle的身高和体重数据集，可以在这里找到<a class="ae kg" href="https://www.kaggle.com/tmcketterick/heights-and-weights" rel="noopener ugc nofollow" target="_blank"/>。对于这个数据集，我们必须根据身高预测这个人的体重。那么，我们开始吧。</p><h1 id="3f3b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">步骤1:预处理数据</h1><p id="d225" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">数据预处理是建立机器学习模型的必要步骤。要阅读更多关于数据预处理的内容，请阅读我的博客<a class="ae kg" rel="noopener" href="/analytics-vidhya/machine-learning-data-prepossessing-661d18f063c3">机器学习—数据预处理</a>。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/c78412705546dc45634b0f5f55ec2839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVjCT5zsf-A-f66thk0U0w.png"/></div></div></figure><p id="2e7e" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">如果您打开数据文件，您会看到没有丢失值或分类数据，所以不需要处理它们。此外，正如我在<a class="ae kg" rel="noopener" href="/analytics-vidhya/machine-learning-data-prepossessing-661d18f063c3">机器学习—数据预处理</a>博客中提到的，我们必须扩展特征，以便准确预测。在这里，我没有这样做，因为对于许多机器学习算法，scikit-learn库为我们处理它，这是简单线性回归的情况。</p><h1 id="3b92" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">第二步:培训模式</h1><p id="da6e" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">在数据预处理之后，我们必须训练简单的线性回归模型，然后用于进行预测。</p><p id="b414" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">以下代码将用于在训练数据集上训练模型。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/17cf73fe215475f0894e5cb64816f446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8f-GwdTLaKE1NrmGTZs3Eg.png"/></div></div></figure><h1 id="fe4d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">第三步:做预测</h1><p id="c395" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">在训练了机器学习模型之后，我们将在测试集上进行预测，因为我们必须测试模型。这就是我们将数据集分为训练和测试部分的原因。这里的目标是检查机器学习模型的准确性。</p><p id="8b3e" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">下面是根据身高预测一个人体重的代码。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/f959928389d4e0f9845e5d8bfe5083ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZCgliwl0XUIWm6wchJI7A.png"/></div></div></figure><h1 id="4c4d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">步骤4:可视化对训练和测试数据的预测</h1><p id="6be4" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">对于可视化的工作，我们已经完成了，我们将从matplotlib库得到帮助。</p><p id="891b" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">下面是可视化模型结果的代码。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/74eda3073b3b9b76ec9745667de83964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6XFf5U1awqcOY_VTZczygA.png"/></div></div></figure><p id="d8bf" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">代码的结果将是:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/44788a832357fe880f6f127ad7358882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KBynosYtO57hsBzaxoKuCw.png"/></div></div></figure><p id="da72" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">这里我们可以看到，在训练数据集上，预测非常准确，但另一方面，对于测试数据，我们有一些异常。</p><p id="665e" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">人们一定会想，为什么它对训练数据集非常有效，而对测试数据却无效呢？</p><p id="fc5f" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">让我用一个简单的例子来解释这种行为，如果一个学生已经知道了试卷，并且在我们的例子中，知道了正在发生的事情，他就会在考试中名列前茅。我们的模型是在训练数据集上训练的，这就是为什么它预测准确，而另一方面在测试数据上表现不佳的原因。</p><p id="0376" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">模型在测试数据集上表现不佳的另一个原因是缺少数据。随着训练数据大小的增加，模型的准确性也增加。如果学生对考试中包含的题目了解很多，就会得到好成绩。</p><p id="c27f" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi lv translated">我们终于做出了第一个简单的线性回归模型。</p><p id="2f02" class="pw-post-body-paragraph kh ki hi jq b jr kw kj kk jt kx kl km jv ll ko kp jx lm kr ks jz ln ku kv kb hb bi translated">如果有任何问题或需要澄清，请让我知道。</p><h1 id="17d1" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">资源:</h1><p id="7b11" class="pw-post-body-paragraph kh ki hi jq b jr js kj kk jt ju kl km jv kn ko kp jx kq kr ks jz kt ku kv kb hb bi translated">你可以在我的<a class="ae kg" href="https://github.com/iftikhar1995/Machine-Learning" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>的博客中找到我写的代码。</p></div></div>    
</body>
</html>