<html>
<head>
<title>Understanding FastAI v2 Training with a Computer Vision Example- Part 1: The Resnet Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用计算机视觉例子理解 FastAI v2 训练-第 1 部分:Resnet 模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-fastai-v2-training-with-a-computer-vision-example-part-1-the-resnet-model-dd9270450bb8?source=collection_archive---------7-----------------------#2020-10-20">https://medium.com/analytics-vidhya/understanding-fastai-v2-training-with-a-computer-vision-example-part-1-the-resnet-model-dd9270450bb8?source=collection_archive---------7-----------------------#2020-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9e7236c714fe26b816e4a8ed8f234937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w9D-F0RekA45wFYBX3ZVYw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae iu" href="https://wallpapercave.com/matrix-hd-wallpaper" rel="noopener ugc nofollow" target="_blank">https://wallpapercave.com/matrix-hd-wallpaper</a></figcaption></figure><p id="5b18" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个系列中，我们将使用一个计算机视觉示例来研究 FastAI 训练循环。本系列的目标读者是那些已经熟悉 FastAI，并希望更深入地了解幕后发生的事情的人。我将假设对深度学习和 CNN 有基本的理解，并且不会对所有使用的术语提供解释。如果你需要任何主题的更多解释，我推荐 FastAI <a class="ae iu" href="https://course.fast.ai/" rel="noopener ugc nofollow" target="_blank"> <em class="jt">的免费在线课程《程序员实用深度学习》</em> </a> <em class="jt">和相关的</em> <a class="ae iu" href="https://www.amazon.in/Deep-Learning-Coders-fastai-PyTorch-ebook/dp/B08C2KM7NR/ref=tmm_kin_swatch_0?_encoding=UTF8&amp;qid=1602254377&amp;sr=8-1" rel="noopener ugc nofollow" target="_blank"> <em class="jt">书</em> </a>。</p><p id="1278" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该系列的总体结构如下:</p><ol class=""><li id="592d" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated"><a class="ae iu" rel="noopener" href="/@rakesh.melezhath/understanding-fastai-v2-training-with-a-computer-vision-example-part-1-the-resnet-model-dd9270450bb8">研究 resnet34 模型架构，并使用普通 Python &amp; PyTorch 构建它。</a></li><li id="6948" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" rel="noopener" href="/@rakesh.melezhath/understanding-fastai-v2-training-with-a-computer-vision-example-part-2-fastai-optimizers-df65cb018604">深入研究 FastAI 优化器&amp;实现一个 NAdam 优化器。</a></li><li id="5fc5" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" rel="noopener" href="/@rakesh.melezhath/understanding-fastai-v2-training-with-a-computer-vision-example-part-3-fastai-learner-and-a3ea85c6fe78">学习 FastAI 学习器和回调&amp;用回调实现一个学习率查找器(lr_find 方法)。</a></li></ol><p id="80e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是该系列的第一篇文章，在这篇文章中，我们将研究 fastai 的 resnet34 模型架构，并在 PyTorch 中自行构建它。我们将使用 Imagenette 数据(由 FastAI 提供)，它是著名的 Imagenet 数据集的子集，仅包含 10 个相对容易区分的类。你可以点击阅读更多关于数据集<a class="ae iu" href="https://github.com/fastai/imagenette" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="05f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们将使用 fastai 便利函数来快速创建和拟合一个优化的 Resnet34 模型，并使用它来研究模型架构。有了这样的理解，我们将使用普通的 Python &amp; Pytorch 从头开始构建模型架构。我们将使用 Google Colab 来运行我们的代码。你可以在这里找到这个系列<a class="ae iu" href="https://github.com/Rakeshsuku/Medium-Blog/tree/master/Understanding%20FastAI%20v2%20Training" rel="noopener ugc nofollow" target="_blank">的代码文件。</a></p><p id="8d08" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们开始吧..！</p><p id="c623" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">运行以下代码，在 Google Colab 中安装 fastai v2。当您运行下面的第一个单元格时，您需要向您的 Google Drive 帐户提供授权。如果您需要更多信息，请在 Google Colab <a class="ae iu" href="https://course.fast.ai/start_colab" rel="noopener ugc nofollow" target="_blank">这里</a>查看运行 fastai v2 软件的说明。记住，在运行任何代码之前，为您的 Google Colab 会话启用 GPU。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/7233c70b96f42e20342d3eae204e817d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x3kFrgiVizxQIDUMoXfq0Q.png"/></div></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/556966bd688cbe7bfca200d530420070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8GbIyV5Io8lMqKdtYYWnQ.png"/></div></div></figure><p id="9bb0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">untar_data()是一个下载数据的快捷函数。在这个系列中我们将会用到很多 fastai 函数，你可以使用 doc()函数来获得这些函数的帮助，如下所示。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/9161bd29d43b586532e438345b47a29b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BvO_I62Ueozqwc3-Bkf3Yw.png"/></div></div></figure><h2 id="6750" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jg la lb lc jk ld le lf jo lg lh li lj bi translated">使用数据块 API 设置数据加载器</h2><p id="aea5" class="pw-post-body-paragraph iv iw hi ix b iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo lo jq jr js hb bi translated">我们将使用 fastai 数据块 API 为我们的模型创建数据加载器。我们不会在这里深入研究数据块 API，因为 FastAI 已经有一些关于它们的精彩教程。你可以在这里找到教程<a class="ae iu" href="https://docs.fast.ai/data.block" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="0896" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们创建一个标签字典，为我们的数据集提供英文标签，并在我们的数据加载器中使用它。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/edc3f1303775224280b1cafe260d8fbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_-7X8zYYWJx8-v4s5b2Q6w.png"/></div></div></figure><p id="1696" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用 Imagenet stats 来规范化我们的数据集。aug _ tranforms()函数用于在我们的数据加载器中应用数据扩充。让我们快速看一下这些是什么:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/36f97f4a0b9d2ff5342be625ce51c326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l0k03ffpMjwD8uY-8HLbgg.png"/></div></div></figure><p id="5740" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以使用 summary()方法跟踪创建数据加载器的所有步骤。如果在创建数据加载器时遇到错误，这种方法非常有用。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/e0d214cb6e138940a4553eb92567e903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47-kgvWVeG2QxASm0lIb9g.png"/></div></div></figure><p id="4dac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">FastAI 转换管道使我们能够在应用增强转换后轻松地可视化我们的数据集。让我们从数据集中抽取一个样本，并在应用增强后生成它的多个副本。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/bb4774c21c339984e71442b3109b39cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VnXh4fGVHVo-IypWTDp52Q.png"/></div></div></figure><p id="16ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您还可以使用 show_batch()方法从训练集中获取不同的图像，并在增强后可视化它们。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/a4c298812c97f9db89b7fabd11747ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MqwyQJkZmz1dT4Bggv5CCw.png"/></div></div></figure><p id="e61c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从训练集中获取一批数据&amp;检查形状。FastAI 使用默认的 batch size 64。数据加载器将输入图像转换为大小为[3，224，224]像素的张量，供我们的神经网络模型使用。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/36eec78c6d080693152d518e9504336f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YLj0HmvI4pIgILTyY5VOHg.png"/></div></div></figure><p id="0db9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用 fastai 改进的 resnet34 架构来构建我们的图像分类模型。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/754485c7e972da724a10bd99bec9c4a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWKS2vFQ2IM3RmHeNbfpww.png"/></div></div></figure><p id="f5a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，创建一个学习者对象来训练我们的模型。Learner 是 FastAI 中处理训练循环的基本类。学习者对象将数据加载器、神经网络模型、优化器和损失函数绑定在一起。FastAI 默认添加了一个 Adam 优化器&amp;可以根据我们的目标变量的类型选择一个合适的损失函数。对于分类问题，它添加 CrossEntropyLoss()作为默认损失函数。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/a7d21ce40b296c01a487b5c1fecb9b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7vlLJf1r5G94VoSbiyPZfA.png"/></div></div></figure><p id="7b9c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用 Learner 方法 learn.lr_find()找到一个合适的学习速率，并使用 learn.fit_one_cycle()使用 10 个时期的单周期学习来拟合模型。因为我们没有使用迁移学习，所以我们在这里为相对较多的时期训练模型。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/cde8152b05e179dba8a513d58a0760c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fwjXWESY9xy1QqakFpuoA.png"/></div></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/90bfaefb600583bd2aac2cd0bf014cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bm5gLM2DBjV3kJ6r2-tskw.png"/></div></div></figure><p id="7e53" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">哇！！！我们在 10 个时期内获得了 81.2%的准确率。</p><p id="98b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以使用学习者对象的 learn.summary()方法来更好地理解我们的模型。summary()方法还显示了模型每一层的激活形状。注意，我们只是显示了下面总结方法输出的顶部和底部。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/60807e2067aecffff1af286ab4c2a0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-DCpDK_4cn15Rh-cwJdgQ.png"/></div></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/a3564f8ab7679e33eaca2a631bfa7a42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F6-oeLo7BhFb-PC0_PBa-g.png"/></div></div></figure><h2 id="0425" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jg la lb lc jk ld le lf jo lg lh li lj bi translated">xResnet34 模型架构</h2><p id="ba81" class="pw-post-body-paragraph iv iw hi ix b iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo lo jq jr js hb bi translated">让我们了解所使用的模型架构。xResnet34 架构由 5 级卷积层组成:一个输入词干+ 4 级 Resnet 块(见下图)。每个 Resnet 块由 2 个 conv 层组成，具有从第一 conv 层的输入到第二 conv 层的输出的短路连接(相同路径)。在论文“<a class="ae iu" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank"> <em class="jt">用于图像识别的深度残差学习</em> </a>中描述的原始 resnet34 架构在其输入干中具有一个 7×7 卷积层，因此在其主路径中具有 34 个神经网络层(输入干中的 1 个 conv 层+ (2 个 conv 层/resnet 块)*16 个 resnet 块+ 1 个线性层)。FastAI 的 xresnet34 模型在其输入干中有 3 个 conv 层。通过在每个 resnet 块中添加更多的 conv 层来构建更深层次的 resnet 架构。我强烈推荐阅读“<a class="ae iu" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank"> <em class="jt">深度残差学习用于图像识别</em> </a>”和“<a class="ae iu" href="https://arxiv.org/abs/1812.01187" rel="noopener ugc nofollow" target="_blank"> <em class="jt">用卷积神经网络进行图像分类的锦囊妙计</em> </a>”，以便更好地理解 resnet 架构&amp;及其变体。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/f387096064deda2a3e7835181fd2b368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwz1ZoEEUi8DW6ppG-Vypg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Resnet 架构</figcaption></figure><p id="56ef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">xresnet34 模型的完整架构如下:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/06489e171843194ff68ff71e5b2accb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GAO8nOcSetyt5TTwASblVA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">xResnet34 架构。*BN: BatchNorm 层</figcaption></figure><p id="34d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“nn。上面 id 路径中的“Sequential([])”表示该路径中不存在神经网络层。xresnet34 架构在<strong class="ix hj"> 116 个参数张量</strong> (nn)中有<strong class="ix hj">2130 万个</strong>可训练参数。代表权重和偏差的参数张量)如下所示。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/32cc58666b5a9de57fc63a3b0c9708d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_HW75QbkTmwHer3L6FvLpw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">xresnet34 架构中参数张量的数量</figcaption></figure><p id="82c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">包含有计算参数个数公式的架构的 excel 文件可以在这里<a class="ae iu" href="https://github.com/Rakeshsuku/Medium-Blog/tree/master/Understanding%20FastAI%20v2%20Training" rel="noopener ugc nofollow" target="_blank"><em class="jt"/></a>(文件名:了解 xResNet.xlsx)。</p><p id="58dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们创建自己的 xresnet34 模型。首先，让我们创建输入词干。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/f643a7b88aca5c6183b8a548d1a91686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQTXrcKUegCx0TW93r9IRg.png"/></div></div></figure><p id="d97d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将创建一个 resnet 块，并使用它来创建 resnet 阶段。resnet 块的结构如下。如果 resnet 块的输入和输出形状不同，则将跨距为 2 的 AveragePooling 层、内核大小为 1x1 的 Conv2d 层和 BatchNorm 层添加到标识路径中。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/c52122a3f2862b998512ffe17c661043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C--AKh1w9aIzpNCU9MiTqg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">xResnet34 中的 resnet 块</figcaption></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/8109b4e88165b6b679f40588c8924b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t6nQNliSWoTcsPFrHdda2g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">xResnet34 中的 resnet 块</figcaption></figure><p id="a65c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来让我们构建 resnet 阶段和完整的 xresnet34 模型。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/de0103ae9c5cad6a1269d992fdb0913f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJwuJcujQAomexEM6NCKMQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">resnet 阶段</figcaption></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/ed515d5c2db2950ea85a643c6c46ac5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RO09Gk8AkNnUThTTzhF0yg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">xresnet34 型号</figcaption></figure><p id="46e0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们将模型移到 GPU，并使用明凯初始化来初始化权重和偏差。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/fd758efda106708586b662c1b77277d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oDCRZidABaNlB_dQ5i276g.png"/></div></div></figure><p id="db25" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在将使用我们自己的神经网络架构创建一个学习器，并像以前一样使用它来拟合分类模型。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/5bbe0a4947e164087ea793bc86fbcbb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSK0b1OdGNEXaqbjIkcCDA.png"/></div></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/3ecef16972b8a66e67abd19c23815f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3Tqjbw-w_lFfp5ozObYSA.png"/></div></div></figure><p id="4d32" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">找到了。！！我们在 10 个时期内达到了 80.38%的准确率。在下一篇文章中，我们将研究 FastAI 优化器并构建我们自己的 NAdam 优化器。</p><p id="c710" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在这里找到这个系列<a class="ae iu" href="https://github.com/Rakeshsuku/Medium-Blog/tree/master/Understanding%20FastAI%20v2%20Training" rel="noopener ugc nofollow" target="_blank">的代码文件。</a></p><p id="3d13" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">本系列其他文章的链接:</strong></p><ul class=""><li id="3ce2" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js mh ka kb kc bi translated"><a class="ae iu" rel="noopener" href="/@rakesh.melezhath/understanding-fastai-v2-training-with-a-computer-vision-example-part-2-fastai-optimizers-df65cb018604"> <em class="jt">深入 FastAI 优化器&amp;实现一个 NAdam 优化器。</em> </a></li><li id="564a" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js mh ka kb kc bi translated"><a class="ae iu" rel="noopener" href="/@rakesh.melezhath/understanding-fastai-v2-training-with-a-computer-vision-example-part-3-fastai-learner-and-a3ea85c6fe78"> <em class="jt">学习 FastAI 学习器和回调&amp;用回调实现学习率查找器(lr_find 方法)。</em>T11】</a></li></ul><p id="41f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">参考文献:</strong></p><ol class=""><li id="3b4f" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated"><a class="ae iu" href="https://course.fast.ai/" rel="noopener ugc nofollow" target="_blank"> <em class="jt">程序员实用深度学习</em> </a></li><li id="b3f1" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank"> <em class="jt"> FastAI GitHub 回购</em> </a></li><li id="3985" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" href="https://github.com/fastai/fastbook" rel="noopener ugc nofollow" target="_blank"> <em class="jt">法泰书</em> </a></li><li id="bbb9" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" href="https://docs.fast.ai/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="jt"> FastAI 文档</em> </a></li><li id="a8e8" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank"> <em class="jt">用于图像识别的深度残差学习</em> </a></li><li id="c93b" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" href="https://arxiv.org/abs/1812.01187" rel="noopener ugc nofollow" target="_blank"> <em class="jt">用卷积神经网络进行图像分类的锦囊妙计</em> </a></li><li id="0f21" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" href="https://arxiv.org/abs/1502.01852" rel="noopener ugc nofollow" target="_blank"> <em class="jt">深挖整流器:在 ImageNet 分类上超越人类水平的性能</em> </a></li><li id="17dc" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><a class="ae iu" href="https://pytorch.org/docs/stable/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="jt"> Pytorch 文档</em> </a></li></ol><div class="mi mj ez fb mk ml"><a href="https://towardsdatascience.com/understanding-and-visualizing-resnets-442284831be8" rel="noopener follow" target="_blank"><div class="mm ab dw"><div class="mn ab mo cl cj mp"><h2 class="bd hj fi z dy mq ea eb mr ed ef hh bi translated">理解和可视化资源</h2><div class="ms l"><h3 class="bd b fi z dy mq ea eb mr ed ef dx translated">这个帖子可以在这里找到 PDF 格式。</h3></div><div class="mt l"><p class="bd b fp z dy mq ea eb mr ed ef dx translated">towardsdatascience.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz io ml"/></div></div></a></div></div></div>    
</body>
</html>