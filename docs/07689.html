<html>
<head>
<title>Scraping Tweets using Twitter API’s</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Twitter API抓取推文</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/scraping-tweets-using-twitter-apis-d497fd97d5f6?source=collection_archive---------3-----------------------#2020-07-04">https://medium.com/analytics-vidhya/scraping-tweets-using-twitter-apis-d497fd97d5f6?source=collection_archive---------3-----------------------#2020-07-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9d799c433a30040cb413759fadd41f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9GBBxsNvQhgGPyyW.jpg"/></div></div></figure><p id="4952" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Web抓取是任何数据科学家从各种资源中收集数据的一项基本技能。Twitter是一个收集大量高质量数据的好工具。我发现twitter数据非常有帮助的一点是在情感分析方面。Twitter使用其API使得收集公开可用的数据变得非常容易。</p><p id="2acd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文将展示如何使用twitter API从twitter中抓取与COVID 19相关的推文。Twitter拥有用户友好的API，可以轻松访问公开可用的数据。如果你喜欢通过视频学习，请点击此链接:<a class="ae jo" href="https://www.youtube.com/watch?v=L7p1O-3a-Wc&amp;t=82s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=L7p1O-3a-Wc&amp;t = 82s</a></p><p id="2ae7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要创建API，请遵循以下步骤:</p><ol class=""><li id="40fe" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">如果您没有帐户，请访问<a class="ae jo" href="https://twitter.com/" rel="noopener ugc nofollow" target="_blank">链接</a>注册您的Twitter。</li><li id="ddf5" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">创建新应用程序<br/>转到:<a class="ae jo" href="https://dev.twitter.com/apps/new" rel="noopener ugc nofollow" target="_blank">https://dev.twitter.com/apps/new</a><br/>输入您的应用程序名称、描述和您的网站地址。您可以将回调URL留空。<br/>将用户密钥(API密钥)和用户密码从屏幕复制到您的应用程序中。</li><li id="45d1" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">创建应用程序</li></ol><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/3ccec6d71fd250f8660a622be16e2123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e5Hk6kh4QASakk4T.png"/></div></div></figure><p id="b80e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.创建应用程序后，您可以复制您的密钥，如下所示:</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/992a835651d3cb60ca9eda2260b665bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AbHUnLREzGC2mFoh.png"/></div></div></figure><p id="2983" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.要获取访问令牌，请单击“创建我的访问令牌”并复制它们:</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/6fd36a508c3cdcd350333f2e8924b5d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hkoeVV712H-F8RJU.png"/></div></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/ce9c0a6f0f19a0019a980d1f9b6d57db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nQwGw5doimC8cHDJ.png"/></div></div></figure><p id="eccf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在您已经有了APIKey、SecretAPIkey、访问令牌和秘密访问令牌，请将它们保存在一个文本文件中，以便安全地访问它们。要访问密钥，请使用ConfigParser:</p><p id="8464" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kl km kn ko b">import configparser config = configparser.RawConfigParser() config.read(filenames = '/path/twitter.txt')</code></p><p id="bf7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将创建一个对象(配置)并安全地读取密钥。这一点很重要，因为我们不想向他人公开我们的密钥。</p><p id="3a5a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将使用Tweepy库从twitter中提取数据。点击<a class="ae jo" href="https://www.tweepy.org/" rel="noopener ugc nofollow" target="_blank">链接</a>阅读更多关于Tweepy的信息。</p><p id="1562" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安装并导入tweepy:<br/>T1】</p><p id="dfea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们需要从配置对象中访问我们的API键。我们可以通过使用<code class="du kl km kn ko b">.get</code>方法来实现:</p><p id="46ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kl km kn ko b">accesstoken = config.get('twitter','accesstoken') accesstokensecret = config.get('twitter','accesstokensecret') apikey = config.get('twitter','apikey') apisecretkey = config.get('twitter','apisecretkey')</code></p><p id="24ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是使用OAuthHandler进行身份验证:</p><p id="7463" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kl km kn ko b">auth = tw.OAuthHandler(apikey,apisecretkey) auth.set_access_token(accesstoken,accesstokensecret) api = tw.API(auth,wait_on_rate_limit=True)</code></p><p id="bcf0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们已经使用API成功地认证并连接了twitter。</p><p id="ea95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是定义搜索词(twitter标签)和我们想要抓取推文的日期:</p><p id="ac5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kl km kn ko b">search_word = '#coronavirus' date_since = '2020-05-28'</code></p><p id="0799" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了抓取推文，创建一个tweepy <code class="du kl km kn ko b">cursor</code> ItemIterator对象并添加参数，即API对象、搜索词、日期、语言等。</p><p id="3e67" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kl km kn ko b">tweets = tw.Cursor(api.search,q = search_word, lang ='en',since = date_since).items(1000)</code></p><p id="e20f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经在tweets对象中获得了与冠状病毒相关的tweets。为了获得这些推文的细节，我们将编写一个for循环，并获取地理位置、推文文本、用户名、用户位置等细节。点击此<a class="ae jo" href="http://docs.tweepy.org/en/latest/cursor_tutorial.html" rel="noopener ugc nofollow" target="_blank">链接</a>阅读更多内容</p><p id="f5e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kl km kn ko b">tweet_details = [[tweet.geo,tweet.text,tweet.user.screen_name,tweet.user.location]for tweet in tweets]</code></p><p id="c3e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输出:</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/544e87561fb0f33e7ecab0dc3267d32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wkMYNhY1O_AaMKwy.png"/></div></div></figure><p id="d11d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是如何从twitter上抓取推文的全部内容。</p></div></div>    
</body>
</html>