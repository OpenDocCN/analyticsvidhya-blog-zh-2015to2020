<html>
<head>
<title>Recommend similar product using product descriptions and images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用产品描述和图片推荐类似产品</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/recommend-similar-product-using-product-descriptions-and-images-b55ea8122b66?source=collection_archive---------2-----------------------#2020-02-08">https://medium.com/analytics-vidhya/recommend-similar-product-using-product-descriptions-and-images-b55ea8122b66?source=collection_archive---------2-----------------------#2020-02-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cd2e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak"> <em class="ix">目标</em> </strong></h2></div><p id="37d3" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">从电子商务网站亚马逊，我们将收集女性服装的数据，并向用户推荐相似类型的服装(但不完全相同)，他/她可以购买。</p><h2 id="3d54" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko bi translated"><strong class="ak"> <em class="ix">下面我们将一一看到</em> </strong></h2><ol class=""><li id="c7df" class="kp kq hi ja b jb kr je ks jh kt jl ku jp kv jt kw kx ky kz bi translated">数据采集。</li><li id="1a6f" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">数据清理。</li><li id="a2a5" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">文本预处理。</li><li id="8081" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">基于文本的产品推荐。</li><li id="755b" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">基于图像的推荐。</li><li id="b834" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">A/B测试。</li></ol><h2 id="cc79" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko bi translated"><strong class="ak"> <em class="ix">数据采集</em> </strong></h2><p id="969e" class="pw-post-body-paragraph iy iz hi ja b jb kr ij jd je ks im jg jh lf jj jk jl lg jn jo jp lh jr js jt hb bi translated">我们从亚马逊的产品广告api中获取数据，因为根据他们的政策，从Amazon.com删除网页是不允许的。</p><blockquote class="li lj lk"><p id="a4db" class="iy iz ll ja b jb jc ij jd je jf im jg lm ji jj jk ln jm jn jo lo jq jr js jt hb bi translated">您可以访问此链接获取您的数据<a class="ae lp" href="https://docs.aws.amazon.com/AWSECommerceService/latest/DG/Welcome.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/AWSECommerceService/latest/DG/welcome . html</a></p></blockquote><p id="57e1" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">使用REST API从站点获取数据并存储在“fashion.json文件”中</p><p id="8c6a" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在这种情况下，我们将处理大约183，000名女性的top数据。</p><p id="e53d" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">使用下面提到的注释获取数据</p><blockquote class="li lj lk"><p id="9edc" class="iy iz ll ja b jb jc ij jd je jf im jg lm ji jj jk ln jm jn jo lo jq jr js jt hb bi translated"><strong class="ja hj">进口熊猫作为pd </strong></p><p id="391f" class="iy iz ll ja b jb jc ij jd je jf im jg lm ji jj jk ln jm jn jo lo jq jr js jt hb bi translated"><strong class="ja hj">data = PD . read _ JSON(fashion . JSON)</strong></p></blockquote><p id="3d27" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在数据集被存储到<strong class="ja hj">数据</strong>中。现在我们将看到数据集的数据形状(数据点数和特征数)</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es lq"><img src="../Images/878f32833c5a135decc4096f0daf1f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o5xOY7ujKm5KTgmvp6fP_g.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">取自我的笔记本</figcaption></figure><p id="0a35" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这些是我的数据集中存在的所有要素。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mg"><img src="../Images/861212cd6fd9c01140207629970b0258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qk-lgTTHRqdrbR7nfBYltQ.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">取自我的笔记本</figcaption></figure><p id="e9f9" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">但是我们将只使用这19个特征中的7个特征，我们发现这19个特征中有7个特征最相关。</p><p id="bd88" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">1.asin(亚马逊标准识别号)<br/> 2。品牌(产品所属的品牌)<br/> 3。颜色(服装的颜色信息，它可以包含许多颜色作为一个值，例如:红色和黑色条纹)<br/> 4。产品类型名称(服装的类型，例如:衬衫/T恤)。medium_image_url(图像的URL)<br/>6。标题(产品的标题。)<br/> 7。formatted_price(产品价格)</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mh"><img src="../Images/165362a917e5e2fa7258aeafdf2e8c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1u2DNQhYqyXpG0Urq4qxDA.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">前5个数据点及其特征视图</figcaption></figure><h1 id="de73" class="mi jv hi bd jw mj mk ml ka mm mn mo ke io mp ip kh ir mq is kk iu mr iv kn ms bi translated">数据清理</h1><p id="c89b" class="pw-post-body-paragraph iy iz hi ja b jb kr ij jd je ks im jg jh lf jj jk jl lg jn jo jp lh jr js jt hb bi translated"><strong class="ja hj">缺失值移除</strong></p><p id="5932" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在这一步中，我们将删除丢失的值数据点。在这里，我们逐一检查每个特性(这里我们删除了缺失值的数据点，因为我们的数据集足够大)。</p><p id="8332" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll">产品类型名称</em> </strong>分析</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es mt"><img src="../Images/77c6f63a401a92908559c1cb6b2857dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*nw_cYHGQ8d35gff_00xVXw.png"/></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mu"><img src="../Images/1afb145fd5647f7ea114a1c52059f935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ag4m3h26mAai6ZYeveuyKA.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">不同的产品类型</figcaption></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es mv"><img src="../Images/3dac28fb6d81428af148bfaa48df17f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*NmHci1NdybNJvH5fjwGXUQ.png"/></div><figcaption class="mc md et er es me mf bd b be z dx translated">数据集中最常见的10种产品类型</figcaption></figure><p id="3273" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">以这种方式分析每个特征后，我们必须逐个消除每个特征的缺失值。</p><p id="b727" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj">删除重复项目</strong></p><p id="b878" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们不想向顾客推荐尺寸或颜色完全相同的商品，因为这是非常糟糕的推荐，因为他或她已经根据自己选择的尺寸或颜色进行了搜索，不会对其他尺寸或颜色感兴趣。比如说-</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es mw"><img src="../Images/ffc7f1d12bbb09bea2c8c35c3d5ccb1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*8FNQI_bkjCa6isltd6A5kQ.png"/></div><figcaption class="mc md et er es me mf bd b be z dx translated">除了尺码(S、M、L、XL)不同，这些衬衫完全一样</figcaption></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es mx"><img src="../Images/2d5df8aa962c828f9abeffe7732066ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*P0q7AEmn8AGRYjPCI8OefQ.png"/></div><figcaption class="mc md et er es me mf bd b be z dx translated"><strong class="bd jw">这些衬衫除了颜色完全一样</strong></figcaption></figure><p id="2284" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll">去重部分1 </em> </strong></p><p id="afe8" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在这种情况下，我们将删除那些与其他标题仅相差最后2/3个单词的服装。我们将只保留这些项目中的一个。借助这一过程，我们可以消除上述两种类型的重复。这里，我们将按字母顺序对所有数据进行排序，然后删除仅在最后2或3个单词不同的产品。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es my"><img src="../Images/742a15fa728474d540e7af1c0d3bc151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*738vBb-JSmyhED0rWJV5oA.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">标题1:只是颜色不同，标题2:只是大小不同。</figcaption></figure><p id="5944" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll">去重第二部分</em> </strong></p><p id="2ad1" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在前面的过程中，我们按照标题的字母顺序对整个数据进行了排序。然后，我们删除标题相邻且非常相似的标题。但是有一些产品的标题并不相邻但是非常相似。这些产品名称示例如下。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es mz"><img src="../Images/98f417da180d3232674c4ad9c495fcd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bG6F1LSgSkUHbaKfYJeZiQ.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">标题-1:妇女和女士是相同的，标题-2:酷，独特，新在这种情况下是非常相似的</figcaption></figure><p id="d0c2" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">所以在这个过程中，我们必须一个接一个地检查所有的标题，并检查它们是否与其他标题只有一个单词或两个单词的不同。</p><h1 id="cfbc" class="mi jv hi bd jw mj mk ml ka mm mn mo ke io mp ip kh ir mq is kk iu mr iv kn ms bi translated">文本预处理</h1><p id="ca53" class="pw-post-body-paragraph iy iz hi ja b jb kr ij jd je ks im jg jh lf jj jk jl lg jn jo jp lh jr js jt hb bi translated"><strong class="ja hj"> <em class="ll">停止字清除</em> </strong></p><p id="81cd" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">首先，我们必须将标题中的所有单词转换成小写，然后我们将删除所有停用的单词。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es na"><img src="../Images/00e9186b20a34b590a4f7f4c22c5ad01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1DdRUdMJac6SecPskRnrAw.png"/></div></div></figure><p id="170a" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们将删除这些词语，因为从这些词语中我们无法获得任何关于产品的信息。</p><p id="962f" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll">词干</em> </strong></p><p id="f016" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们做词干分析是为了根据一些规则，通过去除词尾或前缀，从一个单词中得到一个词根。这里的词根不必是字典中的词。示例-“studies”在词干提取后转换为“studi”。在我们的案例中，我们尝试了词干法，但效果不佳。所以，我们不会应用这个。</p><p id="09dd" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll">释义</em> </strong></p><p id="71d0" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">它简化为一个词根同义词。它将永远是一个字典单词。示例-“病历报告”将被转换为“病历报告”。但是我们也不会去参加这个，因为它也会带来不好的结果。</p><h1 id="93de" class="mi jv hi bd jw mj mk ml ka mm mn mo ke io mp ip kh ir mq is kk iu mr iv kn ms bi translated">基于文本的产品相似性</h1><ol class=""><li id="24a8" class="kp kq hi ja b jb kr je ks jh kt jl ku jp kv jt kw kx ky kz bi translated"><strong class="ja hj">产品名称上的文字袋</strong></li></ol><p id="e061" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在这种情况下，我们使用标题中出现的每个单词的频率将每个单词转换为一个向量。这些向量的维数取决于在整个标题语料库中存在的唯一单词的数量。这些向量将会是稀疏向量。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es nb"><img src="../Images/56d7b5d7463bbdf6010037d722baccb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*rPm0fJxNXOtJEwQ-gJ1CWQ.png"/></div><figcaption class="mc md et er es me mf bd b be z dx translated">摘自<a class="ae lp" href="http://uc-r.github.io/creating-text-features" rel="noopener ugc nofollow" target="_blank">http://uc-r.github.io/creating-text-features</a></figcaption></figure><p id="35ca" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在，在将文本转换成向量后，我们正在使用欧几里得距离计算两个服装或产品之间的相似性。与查询产品的距离越小，意味着与查询产品越相似。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nc"><img src="../Images/e2beb84b9d0f8d165c5cc7ea083cff5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZHV0fjn9JfwNxl29GrWVg.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">第一幅图像是查询图像，因此距离为“0”。</figcaption></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nd"><img src="../Images/b23df4d465d6a1b8576a53231b982b9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3KZplAs324o0icnj0-K_VQ.png"/></div></div></figure><p id="96ee" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">从上面我们可以看出，并不是所有推荐的服装都与查询图片相似。所以我们将使用下一个相似度方法，因为我们对此不满意。</p><p id="4211" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll"> 2。基于TF-IDF的产品相似度</em> </strong></p><p id="0eeb" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">TF——测量一个单词在文档中出现的次数(在这种情况下是在单个标题中)除以文档中出现的单词总数。</p><p id="888a" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">IDF——测量文本语料库中存在的所有文档的对数除以包含特定单词的文档数。</p><p id="b8d4" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">TF-IDF=TF*IDF。</p><p id="09b7" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在，在用上述方法计算了每个标题之后，我们将再次使用欧几里德距离来检查相似性。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es ne"><img src="../Images/106109c586741f507f4f98c8d2cb700e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HdiOE3Rw22Qw6JmHBH-Hxw.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">第一幅图像是查询图像</figcaption></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nf"><img src="../Images/27c2152b61930ba7813e5efc259d465c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v9yXmYE2r7y0dG-AuLYeIA.png"/></div></div></figure><p id="e183" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">从上面我们可以看出，我们正在得到相当满意的结果。但是我们还是会尝试一些不同的方法。</p><p id="d879" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll"> 3。基于IDF的产品相似度</em> </strong></p><p id="65b9" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们将尝试这种方法，因为在分析数据集之后，我们可以看到标题通常不包含一个以上的相同单词，因此使用TF部分是无用的。但是与TF-IDF方法相比，这种方法给出的结果较差。</p><p id="8401" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll"> 4。基于产品相似度的VEC平均词</em> </strong></p><p id="d094" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">到目前为止，当我们把一个文本转换成一个向量时，并没有考虑到语义。但是在这个单词到vec的方法中，我们关注的是语义，这意味着我们现在要考虑单词的上下文。</p><p id="4c13" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们可以在我们的数据集中训练单词到vec模型，但是由于我们的数据集不是很大，所以这里我们导入了已经训练好的300维单词到vec模型。</p><p id="db82" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这个已经训练好的模型将为标题的每个单词分配一个300维的向量。我们将对一个标题的所有单词向量求和，然后除以标题中出现的单词数。(这叫平均字对vec)。之后，我们将再次计算查询产品和数据集中其他产品之间的欧几里德距离。</p><p id="d07a" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">通过这种方法，我们得到了以下类似的产品-</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es ng"><img src="../Images/55611d0d3337b573f739781608b527e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1rKAbSoTH7Zuw9KMIj7FQ.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nh"><img src="../Images/f1e96b9893818eae68b4cecc646538da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i2Dk6jKtyKMyO0LsS4Nj3w.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es ni"><img src="../Images/326e2745cf4ed42f8fc21574faa72937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQaeBKHMbbu7vA2dz9nx7Q.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nj"><img src="../Images/394af108dae5d451cdc10e922b7afd9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RE9Z1hJPgCbyl0tdiKe6TA.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nk"><img src="../Images/8d652abd3433d0f5dde8fef81f62ead9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRNbx40l72rI3cdn0TSaHA.png"/></div></div></figure><p id="c295" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll"> 5。IDF加权字</em> </strong></p><p id="b73e" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这里，在计算每个单词的向量之后，我们计算每个单词的IDF，并将每个单词的IDF和IDF相乘，最后对标题中出现的每个单词的所有向量求和。然后，我们将它除以标题中所有单词的总和。(正如我们之前提到的，在我们的数据中，每个标题通常不会重复任何单词，因此我们将IDF加权单词作为vec，而不是tf-idf加权单词作为vec)。</p><p id="d087" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">它同时考虑了单词的重要性和语义的相似性。这种方法给予在整个文本语料库中出现频率较低的单词更多的重要性，并且还保留了该单词的语义。</p><p id="2c99" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj">步骤</strong></p><ol class=""><li id="a041" class="kp kq hi ja b jb jc je jf jh nl jl nm jp nn jt kw kx ky kz bi translated">使用word to vec将所有单词转换为300维向量。</li><li id="183b" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">现在计算每个单词的IDF呈现标题Ti。</li><li id="9293" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">现在将标题中的每个单词乘以vector和IDF。</li><li id="887a" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">现在对单个标题的第3步的所有值求和。</li><li id="f641" class="kp kq hi ja b jb la je lb jh lc jl ld jp le jt kw kx ky kz bi translated">现在，将step4值除以一个标题的所有IDF的总和。</li></ol><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es no"><img src="../Images/26e30624dad21bc3832f779efa506686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vRog11hyAKOe-Lm6UAWbcQ.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated">查询产品</figcaption></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div class="er es np"><img src="../Images/4d63a1c8944622f83f19b937f38db06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*arw22TVQAPmDFiXXd1_zYA.png"/></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nq"><img src="../Images/f0cbb383c0bf52668ebe177c9cebc3aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YHYt78xJLt8K58D982jRqw.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nr"><img src="../Images/354fc952bf04987de9631d3a2ddbadf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1QxFMqlxyJJOWt0eO5Qnfw.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es ns"><img src="../Images/3f7411654832221b3752013b525aa99d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srj6PWSNhJrsKduodIBCXA.png"/></div></div></figure><p id="5654" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj"> <em class="ll"> 6。使用品牌和颜色</em>加权相似度</strong></p><p id="e333" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在，在这种方法中，我们将品牌和颜色特征添加到标题中。对于颜色，我们正在创建一个向量，其维数等于整个语料库中唯一颜色的数目。使用一个热编码，我们使向量中只有一个颜色值等于“1”，其他保持为“0”。</p><p id="3e6d" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">同样，对于品牌，我们也在做一个热编码。</p><p id="2a2a" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">之后，我们会根据自己的意愿为每个向量(标题、品牌、颜色)分配权重。该权重将优先考虑某些特征而不是其他特征。</p><p id="68b9" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这里，每个分配的权重将与向量的每个元素相乘(标题向量、品牌向量、颜色向量)。之后，连接这三个向量，并计算欧几里得距离，以找到相似性。</p><p id="5820" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在我们的笔记本中，我们给标题向量一个权重(w1 ),给品牌和颜色向量一个权重(w2)。(在笔记本中，我们以稍微不同的方式应用这种方法。[{((w1)*距离(标题向量))+(w2)*(距离(品牌向量，颜色向量))}/(w1+w2)]</p><p id="9ce3" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们通过给两个向量相同的权重来得到下面提到的结果。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nt"><img src="../Images/2540f39438c1f6bcddcbb4884db26fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8MvdF4epODzI_i9EdG_Dpw.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nu"><img src="../Images/8f97e2564269853d2f331c66099805cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LllgQVte1ayz5cweQHl4Qw.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nv"><img src="../Images/c240b4fbb6196b149e4364ad872236ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8bJCFIdjqPfKf5BAoyfWA.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nw"><img src="../Images/07f306000948e301b345614d9b5d4fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VGY3E5kGGWMBoNAOZLSiEw.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nx"><img src="../Images/0b8c1093054f8d7c1ac588b137a5f2e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8j8Ih8Wpc1FabV-VmlVuNQ.png"/></div></div></figure><p id="fe0e" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在，如果我们给颜色和品牌向量比标题向量更多的权重，那么我们将看到下面提到的相同查询产品的推荐服装。</p><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nu"><img src="../Images/8f97e2564269853d2f331c66099805cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LllgQVte1ayz5cweQHl4Qw.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nv"><img src="../Images/c240b4fbb6196b149e4364ad872236ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8bJCFIdjqPfKf5BAoyfWA.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es nx"><img src="../Images/e711b505cd2554ca55712827a11d381d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qk5XRzonUNBHgcSsoFkjSQ.png"/></div></div></figure><figure class="lr ls lt lu fd lv er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es ny"><img src="../Images/df2b64f5f72f65a98ebd207c2247c476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBJSkCOLImsoc-vQb-9NGQ.png"/></div></div></figure><p id="83d3" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj">第七期<em class="ll">。基于视觉相似度的产品相似度</em> </strong></p><p id="4799" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这里，我们使用CNN将产品的每个图像转换为密集向量，然后计算每个向量与查询向量的距离，以测量相似性。这里，我们使用VGG16网络将(224，224)像素图像转换为25088维密集矢量。</p><h1 id="a861" class="mi jv hi bd jw mj mk ml ka mm mn mo ke io mp ip kh ir mq is kk iu mr iv kn ms bi translated">A/B测试</h1><p id="3db6" class="pw-post-body-paragraph iy iz hi ja b jb kr ij jd je ks im jg jh lf jj jk jl lg jn jo jp lh jr js jt hb bi translated">在上面提到的这些方法中，选择哪一种推荐呢？</p><p id="9db1" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">因为在上面我们只是看穿了‘1’的积，哪个算法更有效率。但是这个过程是不正确的，因为在现实生活中会有数十亿的产品。现在不可能对每种产品都采用上述方法，然后再比较效率。</p><p id="5b49" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">那怎么办呢？</p><p id="caf8" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们必须做一个统计测试，这就是所谓的A/B测试。</p><p id="f686" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在A/B测试中，我们将我们的用户集合划分为不重叠的不同集合，现在我们通过上述不同类型的方法推荐每组用户。这些不重叠的集合或组是随机选择的。之后，我们必须看看哪种推荐方法能带来更多的销售。据此我们必须选择一种方法。</p></div></div>    
</body>
</html>