<html>
<head>
<title>Analyzing Amazon Forest Fire Spots with Python Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python分析亚马逊森林火点第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/analyzing-amazon-forest-fire-spots-with-python-part-1-ce9d8ba23cf0?source=collection_archive---------11-----------------------#2019-12-01">https://medium.com/analytics-vidhya/analyzing-amazon-forest-fire-spots-with-python-part-1-ce9d8ba23cf0?source=collection_archive---------11-----------------------#2019-12-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/48517adc40826f5cec9d9b6ef61849c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pb3sQGHujo3a_pi3YlwUKQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片由格雷戈·尼斯<a class="ae iu" href="https://flic.kr/p/6dhVkZ" rel="noopener ugc nofollow" target="_blank">https://flic.kr/p/6dhVkZ</a>拍摄</figcaption></figure><p id="cf97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">亲爱的读者，在本帖中，我将探讨我是如何使用Python来探索亚马逊森林中火点的数据集的。</p><p id="bbc9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在第1部分中，您将学习:</p><ul class=""><li id="c79e" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">如何导入多个CSV文件到一个单一的熊猫数据框架。</li><li id="2d9f" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">创建一个带有自定义函数的Python文件，并在Jupiter笔记本中使用它们。</li><li id="333f" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">如何探索一个有一百万行的数据集？</li><li id="ba47" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">更改列数据类型。</li><li id="acbd" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">创建辅助列。</li></ul><p id="3a55" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你是Python的新手，看看我关于<a class="ae iu" rel="noopener" href="/@bkexcel2014/write-your-first-python-code-using-four-mouse-clicks-no-installation-required-d60ad17f3486">写你的第一个Python代码</a>的帖子，如果你是熊猫数据框<a class="ae iu" rel="noopener" href="/@bkexcel2014/python-basic-data-cleaning-using-pandas-4fd427735e1e">的新手，看看这篇帖子。</a>要在windows中安装Python和Jupyter notebook，您可以<a class="ae iu" href="https://www.youtube.com/watch?v=dgjEUcccRwM&amp;t=383s" rel="noopener ugc nofollow" target="_blank">观看这个youtube教程。</a></p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="92c9" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">数据源:</h1><p id="25fc" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">数据包括2007年1月至2019年8月巴西境内亚马逊森林火点的纬度和经度。数据收集自巴西<a class="ae iu" href="http://queimadas.dgi.inpe.br/queimadas/bdqueimadas" rel="noopener ugc nofollow" target="_blank">国家空间研究所(INPE) </a>，访问日期为2019年9月20日。你也可以直接从我的Github 下载文件<a class="ae iu" href="https://github.com/berkurka/amazonfire/tree/master/Data" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/1080abc4497e7c4aa1f46dced89a8358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BkkAlJMQePzK1v1KoFPwKQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">INPE基地-德达多斯-德凯马达斯</figcaption></figure><h1 id="de91" class="ko kp hi bd kq kr lw kt ku kv lx kx ky kz ly lb lc ld lz lf lg lh ma lj lk ll bi translated">导入库:</h1><pre class="ls lt lu lv fd mb mc md me aw mf bi"><span id="d862" class="mg kp hi mc b fi mh mi l mj mk">import pandas as pd<br/>import my_functions</span></pre><p id="48fa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“my_functions”是我用自定义函数创建的python文件，保存在与Jupyter笔记本相同的文件夹中。这是一种保持笔记本整洁的形式，并存储可在其他项目中使用的可重用代码。唯一需要注意的是，您需要重启笔记本内核来导入my_functions文件中的任何更新。为了创建python文件，您可以使用记事本等文本编辑器插入Python函数并保存文件。py到文件名的末尾。我一直使用崇高的文本编辑器<a class="ae iu" href="https://www.sublimetext.com/" rel="noopener ugc nofollow" target="_blank">https://www.sublimetext.com/</a>和记事本++<a class="ae iu" href="https://notepad-plus-plus.org/" rel="noopener ugc nofollow" target="_blank">https://notepad-plus-plus.org/</a>。</p><h1 id="766e" class="ko kp hi bd kq kr lw kt ku kv lx kx ky kz ly lb lc ld lz lf lg lh ma lj lk ll bi translated">导入数据:</h1><p id="0245" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">下面的代码导入一个CSV文件。</p><pre class="ls lt lu lv fd mb mc md me aw mf bi"><span id="789f" class="mg kp hi mc b fi mh mi l mj mk">path = './Local Data/'<br/>file = 'filename.csv'<br/>df = pd.read_csv(path + file, sep=';')</span></pre><p id="8eba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个项目中，数据存储在13个CSV文件中。我创建了一个自定义函数，将它们全部导入到数据框中。原来的列名是葡萄牙语的，所以该函数也重命名列并更改列类型。</p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ml mm l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">在这里获取完整功能:<a class="ae iu" href="https://github.com/berkurka/amazonfire/blob/master/my_functions.py" rel="noopener ugc nofollow" target="_blank">https://github . com/berkurka/Amazon fire/blob/master/my _ functions . py</a></figcaption></figure><p id="ea76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用上面的函数，我将所有的CSV文件导入到一个数据框中。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/fc45f7bc1cb20426dc08358b7ae77ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hXQQiIIgTSnSAo8uPqn2Ng.png"/></div></div></figure><h1 id="3996" class="ko kp hi bd kq kr lw kt ku kv lx kx ky kz ly lb lc ld lz lf lg lh ma lj lk ll bi translated">探索数据:</h1><p id="6a0d" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">这些是我用来探索新数据集的一些方法。</p><ol class=""><li id="e2b1" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js mo jz ka kb bi translated">df.shape</li><li id="5cb6" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js mo jz ka kb bi translated">df.head()或df.sample()</li><li id="8622" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js mo jz ka kb bi translated">df.dtypes &amp; memory_usage</li><li id="d845" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js mo jz ka kb bi translated">df.isnull()。总和()</li><li id="14d2" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js mo jz ka kb bi translated">df.describe()</li></ol><p id="6de0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1。df.shape: </strong>返回数据框中的行数和列数。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/7b3233b61c12db418622e3f21c56abdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*IexCgEl-UDFLY7lub5QcuQ.png"/></div></figure><p id="ba25" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2。df.head()或df.sample(5): </strong>返回前5行或5行随机样本。从下面的结果中，我们可以了解每一列的内容。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/b4ebb7c2a516b567119cd3218da5f51e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHspfI3T7qRJf8IZJub90A.png"/></div></div></figure><p id="3380" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 3。df . dtypes&amp;df . memory _ usage()</strong>:检查表中的数据类型是否是您所期望的，这一点总是很重要。在这种情况下，Date列是一个对象，需要转换为DateTime。使用下面的代码，您可以检查每一列的类型和内存使用情况，注意字符串列消耗大量内存，我不会在这篇文章中处理优化内存使用的问题，但一个选项是将字符串列转换为分类。</p><pre class="ls lt lu lv fd mb mc md me aw mf bi"><span id="8954" class="mg kp hi mc b fi mh mi l mj mk">pd.DataFrame({'Column Type':df.dtypes, 'Memory Usage': df.memory_usage(deep=True)}) </span></pre><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/5b46a04bf97f3d5111552ce3959fd92b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWY5VrPQme4uNW8A-vdI9w.png"/></div></div></figure><p id="e63c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">日期列是一个字符串，为了将它从对象转换为日期时间，我使用了下面的代码。</p><pre class="ls lt lu lv fd mb mc md me aw mf bi"><span id="5715" class="mg kp hi mc b fi mh mi l mj mk">df['Date'] = pd.to_datetime(df['Date'], format='%Y/%m/%d %H:%M:%S')</span></pre><p id="5168" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果日期格式与<code class="du ms mt mu mc b">YYYY/mm/dd hh:mm:ss</code>不同，您需要更改pd.to_datetime函数中的format参数，所有格式选项都可以在本网站<a class="ae iu" href="http://strftime.org/." rel="noopener ugc nofollow" target="_blank">http://strftime.org/.</a>中找到</p><p id="4b6c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导入CSV文件时，也可以转换日期列。</p><pre class="ls lt lu lv fd mb mc md me aw mf bi"><span id="3ecd" class="mg kp hi mc b fi mh mi l mj mk">date_column_names = ['Date'] #List of columns names with date format<br/>pd.read_csv('./file.csv', <!-- -->parse_dates = <!-- -->date_column_names)</span></pre><p id="faa0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将日期列转换为日期时间后:</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/b5eb5016d7943be672aac639e0659a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*MkKNaHf_o5lXUg0T1nYDLg.png"/></div></figure><p id="e072" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 4。df.isnull()。sum(): </strong>计算每列中有多少个空值。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/b4c00913e94d081aa7f3a6bb911e4cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*MKAwKP3lgVCT9DoQnn-G0Q.png"/></div></figure><p id="e620" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 5。df.describe(): </strong>创建描述性统计来汇总数据帧。根据使用的数据类型，输出会有所不同。在第一个图像中，参数<code class="du ms mt mu mc b">include=['float']</code>将只在浮动列上运行describe函数。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/38e147df8702c13941f3a036d951aa48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mc93a-xLsgBpzUxEMrb-ow.png"/></div></div></figure><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es my"><img src="../Images/4a7892ef4f00ab4207d8116ea4ed8c58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*X4CATTazXlsvP6ZR1cItTw.png"/></div></figure><p id="ec7c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">so Felix do Xingu是观测数量最多的县。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/207b1bbd9982e8b5716f6483baca5408.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*9tV54YvNhyjl7fGG-lj_8w.png"/></div></figure><p id="51a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据来自不同的州，28个不同的卫星，547个县，562，618个不同的日期时间。</p><h1 id="b574" class="ko kp hi bd kq kr lw kt ku kv lx kx ky kz ly lb lc ld lz lf lg lh ma lj lk ll bi translated">创建辅助列:</h1><p id="154f" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">为了方便数据探索，我创建了一些时间辅助列。</p><pre class="ls lt lu lv fd mb mc md me aw mf bi"><span id="0e3c" class="mg kp hi mc b fi mh mi l mj mk">df['Day'] = pd.to_datetime(df['Date']).dt.normalize()<br/>result['Month'] = result['Date'].dt.strftime('%m').astype(int)<br/>result['Year'] = result['Date'].dt.strftime('%Y').astype(int)</span></pre><p id="bd9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">新列是这样的:</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es na"><img src="../Images/1c8fe667a686a1e88796bf93f2486231.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*8ludMKnSNu9A1U9NzBuE4Q.png"/></div></figure><p id="ec51" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有了蛾和年列，我可以很容易地使用<code class="du ms mt mu mc b">.value_counts()</code>:</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/89731b2ef9608502f52d238175d6b2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*KjCfNd8l74b8FBXBxcqRlA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">从9月到11月，有更多的火点，这是有道理的，因为巴西的雨季高峰是在12月和1月。</figcaption></figure><figure class="ls lt lu lv fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/b3e3b7bac826761685ee8c338d2e8d55.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*DOnblhE6d4SW1YdMuEq0Qw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">sad2017年和2015年是去除重复之前火点数量最多的年份。</figcaption></figure><p id="5709" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的代码在不创建辅助列的情况下按年份进行计数。</p><pre class="ls lt lu lv fd mb mc md me aw mf bi"><span id="452f" class="mg kp hi mc b fi mh mi l mj mk">df["Date"].dt.year.value_counts() <br/>df.set_index(df["Date"])['State'].resample('Y').count()</span></pre><p id="2f02" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我的下一篇文章中，我将尝试删除重复，因为同一个火点可能会被计数两次或更多次，我将生成一些很酷的可视化效果。</p><p id="664f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>