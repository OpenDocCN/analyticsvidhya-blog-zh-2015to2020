<html>
<head>
<title>Data Augmentation to solve imbalanced training data for Image Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决图像分类中不平衡训练数据的数据增强</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-augmentation-to-solve-imbalanced-training-data-for-image-classification-f6d888cbd596?source=collection_archive---------12-----------------------#2020-06-11">https://medium.com/analytics-vidhya/data-augmentation-to-solve-imbalanced-training-data-for-image-classification-f6d888cbd596?source=collection_archive---------12-----------------------#2020-06-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/69b6beb24aa6feaa9db5aeddcff28340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*mq5DsXDYOtAmUZuxpVaozA.jpeg"/></div></figure><p id="ed11" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">本文将带您了解如何使用<strong class="io hj">数据扩充</strong>来解决图像分类数据不平衡的问题。拥有不平衡的训练数据会导致分类器出现偏差，在无法为代表性不足的类别获取更多训练数据的情况下，可以使用数据扩充来增加训练数据的大小。</p><p id="81bf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我将介绍一些可以用来增加不平衡类的训练数据的技术。</p><p id="5bef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，让我们阅读实际图像。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="f819" class="jt ju hi jp b fi jv jw l jx jy">from PIL import Image<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import random</span><span id="b31f" class="jt ju hi jp b fi jz jw l jx jy">image = Image.open("odin.jpg")<br/>img = np.array(image)<br/>plt.imshow(img)<br/>plt.show()</span></pre><figure class="jk jl jm jn fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/a543e4eac870ff9d79234d13990c2eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*dqptANjPDMPQ3RebwN8P_w.png"/></div></figure><p id="524a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以对原始图像执行几种变换来扩充我们的训练数据，例如，</p><ol class=""><li id="38c2" class="kb kc hi io b ip iq it iu ix kd jb ke jf kf jj kg kh ki kj bi translated"><strong class="io hj">水平翻转图像</strong></li></ol><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="b13d" class="jt ju hi jp b fi jv jw l jx jy">flipped_img = np.fliplr(img)<br/>Image.fromarray(flipped_img)</span></pre><figure class="jk jl jm jn fd ij er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kk"><img src="../Images/b5e521aa85646fde76a20da434ad83d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4zw6v-oB_Cbe4q_XNEnNg.png"/></div></div></figure><p id="0672" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2。随机旋转图像一个角度</strong></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="f42f" class="jt ju hi jp b fi jv jw l jx jy">random_degree = random.uniform(-50, 50)<br/>image.rotate(random_degree)</span></pre><figure class="jk jl jm jn fd ij er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kp"><img src="../Images/ee691ebce7363d96bdc0b874c4302376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UjrxNaqmUH2GbizjKmI7fA.png"/></div></div></figure><p id="2452" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 3。给图像添加随机噪声</strong></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="e1ab" class="jt ju hi jp b fi jv jw l jx jy">vals = len(np.unique(image))<br/>vals = 0.9 ** np.ceil(np.log2(vals))<br/>noisy = np.random.poisson(image * vals) / float(vals)<br/>plt.imshow(noisy.astype('uint8'))<br/>plt.show()</span></pre><figure class="jk jl jm jn fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/4b9e2adf8a7b4a1e82a8505b1080da2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*eLWGS9u0oA1hjtRzjhF2vQ.png"/></div></figure><p id="f4f3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 4。裁剪图像</strong></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="1284" class="jt ju hi jp b fi jv jw l jx jy">width, height = image.size <br/>left = 0<br/>top = height/4<br/>right = width*0.9<br/>bottom = 2*height/2</span><span id="d79a" class="jt ju hi jp b fi jz jw l jx jy">image = image.crop((left, top, right, bottom))</span><span id="4bea" class="jt ju hi jp b fi jz jw l jx jy">plt.imshow(image)<br/>plt.show()</span></pre><figure class="jk jl jm jn fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/7a617b7990fece7c6f3388f1ae37716a.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*tfuZKeSWYBqvFSbDctk9BQ.png"/></div></figure><p id="ca05" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Keras还提供了一个简单有效的方法，可以通过<code class="du kt ku kv jp b">keras.preprocessing.image.ImageDataGenerator</code>类用于数据扩充(<a class="ae ks" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank"> Link </a>)。本课程允许您:</p><ul class=""><li id="e679" class="kb kc hi io b ip iq it iu ix kd jb ke jf kf jj kw kh ki kj bi translated">在训练期间，配置要在图像数据上完成的随机变换和标准化操作</li><li id="7cd4" class="kb kc hi io b ip kx it ky ix kz jb la jf lb jj kw kh ki kj bi translated">通过<code class="du kt ku kv jp b">.flow(data, labels)</code>或<code class="du kt ku kv jp b">.flow_from_directory(directory)</code>实例化增强图像批次(及其标签)的生成器。然后，这些生成器可以与接受数据生成器作为输入的Keras模型方法一起使用，<code class="du kt ku kv jp b">fit_generator</code>、<code class="du kt ku kv jp b">evaluate_generator</code>和<code class="du kt ku kv jp b">predict_generator</code>。</li></ul><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="dc14" class="jt ju hi jp b fi jv jw l jx jy">from keras.preprocessing.image import ImageDataGenerator<br/><br/>datagen = ImageDataGenerator(<br/>        rotation_range=40,<br/>        width_shift_range=0.2,<br/>        height_shift_range=0.2,<br/>        rescale=1./255,<br/>        shear_range=0.2,<br/>        zoom_range=0.2,<br/>        horizontal_flip=True,<br/>        fill_mode='nearest')</span></pre><p id="ea94" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用数据扩充，我们可以快速增加不平衡类的数据量，这将确保我们的模型不会看到同一个图像两次，有助于避免过度拟合，并帮助模型更好地概括。</p></div></div>    
</body>
</html>