<html>
<head>
<title>How to do Image Classification on custom Dataset using TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用TensorFlow对自定义数据集进行影像分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-do-image-classification-on-custom-dataset-using-tensorflow-52309666498e?source=collection_archive---------0-----------------------#2020-04-01">https://medium.com/analytics-vidhya/how-to-do-image-classification-on-custom-dataset-using-tensorflow-52309666498e?source=collection_archive---------0-----------------------#2020-04-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/845615a503e5f22b6c433748086607a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*gBWLTUuqhNy3U9J-ZWQwjA.jpeg"/></div></figure><p id="249d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">图像分类基本上是给系统一些属于一组固定类别的图像，然后期望系统将这些图像放入它们各自的类别。</p><p id="24c1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我以前的文章中，我已经向您展示了如何从图像分类开始。所以如果你还没有读过，你应该看看:<a class="ae jk" rel="noopener" href="/@rkt10952/new-abcd-of-machine-learning-c5bf9eba75bf">https://medium . com/@ rkt 10952/new-ABCD-of-machine-learning-C5 BF 9 EBA 75 BF</a></p><p id="938a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我将使用我们自己的数据集进行图像分类。我将为您提供本文中使用的完整代码和其他所需文件，以便您可以亲自动手操作。<br/> GitHub链接:<a class="ae jk" href="https://github.com/aryan109/medium/tree/master/Custom_Image_Classification" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/aryan 109/medium/tree/master/Custom _ Image _ class ification</a></p><p id="f5a0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我请求您在执行代码时阅读这篇文章，这样您就可以理解代码的每一行。</p><h1 id="6417" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">正在准备数据集</h1><p id="5282" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">我们从准备数据集开始，因为这是解决任何机器学习问题的第一步，你应该正确地做它。<br/>我们将使用Keras中<strong class="io hj"> ImageDataGenerator </strong>类中的<em class="ko"> flow_from_directory </em>方法。为了使用它，我们需要把我们的数据放在预定义的目录结构中，如下所示</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kp"><img src="../Images/80ff6c330612781dca2d8991698583a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wl6rLXC0wNL27fnd.png"/></div></div></figure><p id="22d8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们只需要把图片放到各自的文件夹中，就可以开始了。</p><h1 id="69ee" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">正在加载数据集</h1><p id="af8a" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">当我们准备数据集时，我们需要加载它。因为我们在这里使用协同实验室，所以我们需要将数据加载到协同实验室工作区。我们首先需要将数据文件夹上传到Google Drive。然后，我们需要在我们的工作区中安装驱动器，为此我们将使用以下代码:</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="3c4e" class="ld jm hi kz b fi le lf l lg lh">from google.colab import drive</span><span id="df29" class="ld jm hi kz b fi li lf l lg lh">drive.mount(‘/content/drive’)</span></pre><p id="ed5d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当我们执行这段代码时，将会生成一个链接，并会出现一个要求验证码的框！！！。现在，该做什么…？</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lj"><img src="../Images/897c7f44a6b91b1cf2e3b9c5589271df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XdGS4u66wU7RZRoC"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">布鲁斯·马尔斯在<a class="ae jk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="3d5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">不要担心，只要点击认证框上方的链接，就会出现一个页面，登录到您的谷歌帐户。当您输入凭据并登录时。允许Google Drive文件流访问您的帐户，然后将生成验证码，只需复制该代码并粘贴到框中。</p><p id="cb0f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">恭喜🎉你已经完成了最难的部分，接下来就很简单了。</p><p id="1bea" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，就像这样进入上传的数据集文件夹:-</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/c8193ca2acabc34e92cc5acaecc81c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*SenFsxSVx0fWKnWTFQTc9g.png"/></div></figure><p id="ab33" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后右键单击文件夹，并单击复制路径。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/5aa0ce3a99e0aceb84e7759ec3add5ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*sxBL9ZiyRGidthhrxSr2gQ.png"/></div></figure><p id="3208" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在将数据根设置为复制的路径。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="c7d7" class="ld jm hi kz b fi le lf l lg lh">data_root = (“&lt;Copied path&gt;”)</span></pre><p id="173a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它看起来会像</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/36f8c20158ced3dfac208dd3907a5840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*EB6319VtqS3p4Yl95bYRfA.png"/></div></figure><p id="ad25" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">执行此单元格。</p><h1 id="4d10" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">创建培训和验证数据</h1><p id="a856" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">正如我之前告诉你的，我们将使用<strong class="io hj"> ImageDataGenerator </strong>将数据加载到模型中，让我们看看如何做。</p><p id="4fcf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一组图像形状</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="cab1" class="ld jm hi kz b fi le lf l lg lh">IMAGE_SHAPE = (224, 224) # (height, width) in no. of pixels</span></pre><p id="d89a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">设置培训数据目录</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="fc76" class="ld jm hi kz b fi le lf l lg lh">TRAINING_DATA_DIR = str(data_root)</span></pre><p id="7498" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">重新缩放图像并将数据分成训练和验证。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="6e3e" class="ld jm hi kz b fi le lf l lg lh">datagen_kwargs = dict(rescale=1./255, validation_split=.20)</span></pre><p id="f17c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建列车_发电机和有效_发电机</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="7312" class="ld jm hi kz b fi le lf l lg lh">valid_datagen = tf.keras.preprocessing.image.ImageDataGenerator(**datagen_kwargs)</span><span id="8083" class="ld jm hi kz b fi li lf l lg lh">valid_generator = valid_datagen.flow_from_directory(</span><span id="a088" class="ld jm hi kz b fi li lf l lg lh">TRAINING_DATA_DIR,</span><span id="0c31" class="ld jm hi kz b fi li lf l lg lh">subset=”validation”,</span><span id="b453" class="ld jm hi kz b fi li lf l lg lh">shuffle=True,</span><span id="e62b" class="ld jm hi kz b fi li lf l lg lh">target_size=IMAGE_SHAPE</span><span id="7d08" class="ld jm hi kz b fi li lf l lg lh">)</span><span id="b567" class="ld jm hi kz b fi li lf l lg lh">train_datagen = tf.keras.preprocessing.image.ImageDataGenerator(**datagen_kwargs)</span><span id="58c9" class="ld jm hi kz b fi li lf l lg lh">train_generator = train_datagen.flow_from_directory(</span><span id="0d5c" class="ld jm hi kz b fi li lf l lg lh">TRAINING_DATA_DIR,</span><span id="2e0f" class="ld jm hi kz b fi li lf l lg lh">subset=”training”,</span><span id="845f" class="ld jm hi kz b fi li lf l lg lh">shuffle=True,</span><span id="139f" class="ld jm hi kz b fi li lf l lg lh">target_size=IMAGE_SHAPE)</span></pre><p id="b915" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当您执行单元格时，它将显示如下输出</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/44457002029aa5e3ef8e1cd90ebabb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*_nSmu4g8YP0vX-bi1qGE-A.png"/></div></figure><p id="81e7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一行是验证数据，第二行是训练数据。</p><h1 id="1bdf" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">可视化数据</h1><p id="1a33" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">让我们浏览一下train_generator中的图像和标签</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/666c02604423e35ace1239b726c61042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*Gk0TwJz8yHzf88RP40sLgQ.png"/></div></figure><p id="9fb0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">默认的批量大小是32，这在大多数情况下是合适的。</p><p id="76fd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">(32，244，244，3)表示在一批图像中包括32个图像，244，244是图像的高度和宽度，3是RGB三个颜色通道。</p><p id="12df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">label_batch shape is (32，4)表示有32个标签和4个，因为标签是一种热编码格式。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/09cfce7aa352f7a032e52ea33f6f77dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*EwdqaiOjDPdP9fTo6ejgfA.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">label_batch中的前5个元素</figcaption></figure><p id="df51" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看哪些指数代表哪些标签</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="82c9" class="ld jm hi kz b fi le lf l lg lh">print (train_generator.class_indices)</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lu"><img src="../Images/65112e07752937e4207e548b1556785f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FUMQ-N2M-FnsnIaxri6w4A.png"/></div></div></figure><p id="7f91" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们将所有标签写入一个文本文件。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="0101" class="ld jm hi kz b fi le lf l lg lh">labels = ‘\n’.join(sorted(train_generator.class_indices.keys()))<br/>with open(‘labels.txt’, ‘w’) as f:<br/> f.write(labels)<br/>!cat labels.txt</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lv"><img src="../Images/c227023e3cb87c3d6abd1ddbbfb3a904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m9CvV2_grJcXF0sxgzeMnw.png"/></div></div></figure><h1 id="4af5" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">创建分类模型</h1><p id="2625" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">在这里，我将向您展示迁移学习的一瞥，不要担心，我将为迁移学习创建一个单独的教程。</p><p id="58fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将使用<strong class="io hj"> TensorFlow hub </strong>来加载预训练的模型。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="5559" class="ld jm hi kz b fi le lf l lg lh">model = tf.keras.Sequential([<br/> hub.KerasLayer(“<a class="ae jk" href="https://tfhub.dev/google/tf2-preview/mobilenet_v2/feature_vector/4" rel="noopener ugc nofollow" target="_blank">https://tfhub.dev/google/tf2-preview/mobilenet_v2/feature_vector/4</a>", <br/> output_shape=[1280],<br/> trainable=False),<br/> tf.keras.layers.Dropout(0.4),<br/> tf.keras.layers.Dense(train_generator.num_classes, activation=’softmax’)<br/>])<br/>model.build([None, 224, 224, 3])</span><span id="a907" class="ld jm hi kz b fi li lf l lg lh">model.summary()</span></pre><p id="01a2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个模型有它自己的一些独特的特性，<br/> 1)即使你的数据集有不同数量的类，这个代码也能工作。<br/> 2)由于我们使用迁移学习，即使你的数据集很小，它也会产生很好的结果。<br/> 3)这种模式易于在移动设备或类似Raspberry pi的设备上部署。(请不要担心，我将在另一篇文章中单独介绍这一点，敬请关注😉).</p><p id="5a7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这段代码的输出如下所示:</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lw"><img src="../Images/9e4ed8fc176d5ad48aeb3af221d29682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qErCnQNk10j2mqXXPBwVGQ.png"/></div></div></figure><h1 id="e7bd" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">火车模型</h1><p id="7d38" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">在训练之前，我们需要编译模型，操作系统，让我们编译</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="9662" class="ld jm hi kz b fi le lf l lg lh">optimizer = tf.keras.optimizers.Adam(lr=1e-3)<br/>model.compile(<br/> optimizer=optimizer,<br/> loss=’categorical_crossentropy’,<br/> metrics=[‘acc’])</span></pre><p id="13c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们可以训练了</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lx"><img src="../Images/a64b457181406c068dfc1ee662279a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nfK9wSKcxcJCu-rT"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">布莱恩·苏曼在Unsplash的照片</figcaption></figure><p id="91b2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">开玩笑的😂让我们进行真正的训练</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="c862" class="ld jm hi kz b fi le lf l lg lh">steps_per_epoch = np.ceil(train_generator.samples/train_generator.batch_size)<br/>val_steps_per_epoch = np.ceil(valid_generator.samples/valid_generator.batch_size)</span><span id="bdf7" class="ld jm hi kz b fi li lf l lg lh">hist = model.fit(<br/> train_generator, <br/> epochs=100,<br/> verbose=1,<br/> steps_per_epoch=steps_per_epoch,<br/> validation_data=valid_generator,<br/> validation_steps=val_steps_per_epoch).history</span></pre><blockquote class="ly lz ma"><p id="0490" class="im in ko io b ip iq ir is it iu iv iw mb iy iz ja mc jc jd je md jg jh ji jj hb bi translated">这段代码将为模型训练100个时期。<br/> <strong class="io hj">警告</strong>:训练需要时间，所以要有耐心..</p></blockquote><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es me"><img src="../Images/f38a3039c14fa50995a05fb675ff83c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eZ7sEsim6iyY851b"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated"><a class="ae jk" href="https://unsplash.com/@fachymarin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">法希·马林</a>在<a class="ae jk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="a6b9" class="ld jm hi bd jn mf mg mh jr mi mj mk jv ix ml mm jz jb mn mo kd jf mp mq kh mr bi translated">恭喜🙌您已经成功训练了您的模型</h2><p id="3c41" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">现在让我们看看我们的模型有多好。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="6711" class="ld jm hi kz b fi le lf l lg lh">final_loss, final_accuracy = model.evaluate(valid_generator, steps = val_steps_per_epoch)<br/>print(“Final loss: {:.2f}”.format(final_loss))<br/>print(“Final accuracy: {:.2f}%”.format(final_accuracy * 100))</span></pre><p id="457f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">好看吗？如果不能尝试训练更多的纪元，那就看看神奇的🧝‍♀️.吧</p><h1 id="4cd4" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">绘制一些图表</h1><p id="4933" class="pw-post-body-paragraph im in hi io b ip kj ir is it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj hb bi translated">这些图表将帮助你了解训练做得有多好。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="25c7" class="ld jm hi kz b fi le lf l lg lh">plt.figure()<br/>plt.ylabel(“Loss (training and validation)”)<br/>plt.xlabel(“Training Steps”)<br/>plt.ylim([0,50])<br/>plt.plot(hist[“loss”])<br/>plt.plot(hist[“val_loss”])</span><span id="f8c1" class="ld jm hi kz b fi li lf l lg lh">plt.figure()<br/>plt.ylabel(“Accuracy (training and validation)”)<br/>plt.xlabel(“Training Steps”)<br/>plt.ylim([0,1])<br/>plt.plot(hist[“acc”])<br/>plt.plot(hist[“val_acc”])</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/6fe9c36d5e917cc6a311a38f4057a91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*VYXd-zO3Ow8DP4-JgBbwDQ.png"/></div></figure><p id="086b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该图看起来会像这样，橙色线表示验证准确性，蓝色线表示训练准确性。</p><h1 id="fce6" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">检查模型的性能</h1><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="8fcf" class="ld jm hi kz b fi le lf l lg lh">tf_model_predictions = model.predict(val_image_batch)<br/>print(“Prediction results shape:”, tf_model_predictions.shape)</span><span id="1cbb" class="ld jm hi kz b fi li lf l lg lh">plt.figure(figsize=(10,9))<br/>plt.subplots_adjust(hspace=0.5)<br/>for n in range((len(predicted_labels)-2)):<br/> plt.subplot(6,5,n+1)<br/> plt.imshow(val_image_batch[n])<br/> color = “green” if predicted_ids[n] == true_label_ids[n] else “red”<br/> plt.title(predicted_labels[n].title(), color=color)<br/> plt.axis(‘off’)<br/>_ = plt.suptitle(“Model predictions (green: correct, red: incorrect)”)</span></pre><p id="4a6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将通过预测向您展示模型的训练效果。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mt"><img src="../Images/a071a792f43a9cf9c5ce7e2000b51f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ix5ApDHadbJx-myP5NS0wg.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">由模型完成的预测</figcaption></figure><blockquote class="ly lz ma"><p id="93b9" class="im in ko io b ip iq ir is it iu iv iw mb iy iz ja mc jc jd je md jg jh ji jj hb bi translated">谢谢你的耐心和阅读这篇文章。请分享您的反馈和建议。我保证很快会有更多的文章，希望你会喜欢。</p></blockquote><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mu"><img src="../Images/26363de1e25a4aa3fd38b99fff24db4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AEuSyYtX1RsAzP5R"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">由<a class="ae jk" href="https://unsplash.com/@howier?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">霍华德·里明顿</a>在<a class="ae jk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div></div>    
</body>
</html>