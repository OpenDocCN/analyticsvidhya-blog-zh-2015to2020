<html>
<head>
<title>How I built Face Unlock for Ubuntu Linux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何为Ubuntu Linux构建面部解锁的</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-i-built-face-unlock-for-ubuntu-linux-a2b769d1fbc1?source=collection_archive---------8-----------------------#2019-11-23">https://medium.com/analytics-vidhya/how-i-built-face-unlock-for-ubuntu-linux-a2b769d1fbc1?source=collection_archive---------8-----------------------#2019-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="3df8" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="0ad3" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这篇文章是关于我如何为我的Ubuntu机器建立face unlock或者苹果可能会说的“face ID”。我们开始吧！</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/95948772a4e2d08789592547124c1ac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kJKh4vOKewC4TiqFofr7qg.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">来源:<a class="ae kr" href="https://en.wikipedia.org/wiki/Face_ID#/media/File:%D7%94%D7%9C%D7%95%D7%92%D7%95_%D7%A9%D7%9C_%D7%9E%D7%A2%D7%A8%D7%9B%D7%AA_%D7%94%D6%BEFace_ID.jpg" rel="noopener ugc nofollow" target="_blank">维基百科</a></figcaption></figure><h1 id="a493" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">目标</h1><p id="2835" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">它旨在建立一个面部认证系统，可以在登录时工作，同时在Ubuntu中运行“sudo”或“su”命令。</p><h1 id="e9c3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">让我们先把问题分解一下:</h1><ol class=""><li id="ee94" class="ks kt hi jf b jg jh jk jl jo ku js kv jw kw ka kx ky kz la bi translated">如何构建人脸识别器</li><li id="c222" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">如何给Ubuntu添加这个功能</li></ol><h1 id="d2d9" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">履行</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lg"><img src="../Images/0dabd3b2650a5c6fe3f4eb831b0df788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8SEipCfy9fbXU58nse5Kg.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">来源:<a class="ae kr" href="https://ak3.picdn.net/shutterstock/videos/1019928523/thumb/11.jpg" rel="noopener ugc nofollow" target="_blank">https://ak3 . picdn . net/shutterstock/videos/1019928523/thumb/11 . jpg</a></figcaption></figure><h2 id="64d0" class="lh ig hi bd ih li lj lk il ll lm ln ip jo lo lp it js lq lr ix jw ls lt jb lu bi translated">1.如何构建人脸识别器</h2><p id="53e6" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我使用OpenCV和<a class="ae kr" href="http://fast.ai" rel="noopener ugc nofollow" target="_blank"> fastai </a>库来构建我的人脸识别器。因此，首先只是为了建立模型，我使用了我的脸部照片和我朋友的脸部照片，然后我用Vgg16预训练模型转移学习模型。实际上，它没有给我令人满意的精确度。然后我意识到图像中有很多噪声，图片非常宽，而不仅仅是面部图像。因此，我使用OpenCV的“<a class="ae kr" href="https://pythonprogramming.net/haar-cascade-face-eye-detection-python-opencv-tutorial/" rel="noopener ugc nofollow" target="_blank">Haar cascode _ frontal face _ default . XML</a>”从图片中提取人脸，然后再次训练模型，并尝试一些参数组合，它突然在验证数据集上获得了非常好的准确性(&gt; 93%)。</p><p id="7cad" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">我已经建立了我的模型，并决定了最终模型的参数调整，但实时人脸识别尚未实现。然后，我编写代码来单击一张图片，提取人脸部分，然后将其返回给调用者函数和另一个函数来调用上述函数，并将返回的图片提供给模型。</p><p id="acc3" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">我发现，这一次它主要是给我错误的输出或正确的输出，可信度较低。我意识到我的笔记本电脑的相机点击的图片比我曾经用于培训的图片差得多，所以我决定用我用于将图片返回到模型的相同代码点击我pc上的所有图片，但使用一些不同的参数集。比如，如果是为了测试，函数调用将是<em class="ma"> getFaces() </em>，但是为了训练，它将是<em class="ma"> getFaces(training = True)。</em>然后我的模型又开始给出好的精确度:)</p><p id="b25c" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">第一阶段，深度学习部分几乎完成了，但更难的部分仍然存在，即将它添加到Ubuntu中。</p><h2 id="d0d4" class="lh ig hi bd ih li lj lk il ll lm ln ip jo lo lp it js lq lr ix jw ls lt jb lu bi translated">2.如何给Ubuntu添加这个功能</h2><h2 id="c70f" class="lh ig hi bd ih li lj lk il ll lm ln ip jo lo lp it js lq lr ix jw ls lt jb lu bi translated">子任务:</h2><ol class=""><li id="e4cc" class="ks kt hi jf b jg jh jk jl jo ku js kv jw kw ka kx ky kz la bi translated">研究阶段</li><li id="f53b" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">部署阶段</li><li id="0a57" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">一些最后的润色</li></ol><h2 id="97bf" class="lh ig hi bd ih li lj lk il ll lm ln ip jo lo lp it js lq lr ix jw ls lt jb lu bi translated">研究阶段</h2><p id="1aa8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我知道在任何操作系统中做出改变似乎都很困难，但是Linux开发人员已经将Linux变得如此动态，以至于在任何Linux发行版中做出改变或添加东西都不是那么困难。你需要的只是做一些研究的能力和耐心。</p><p id="05fa" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">当我想到在我的Ubuntu机器上添加一个面部解锁系统时，我在想这将会非常困难，我将不得不修改Linux内核的代码。但是经过几天对Linux认证系统的研究，我从<a class="ae kr" href="http://tldp.org/HOWTO/User-Authentication-HOWTO/x115.html" rel="noopener ugc nofollow" target="_blank">这个页面</a>了解到<strong class="jf hj"> PAM(可插拔认证模块)</strong>。然后我意识到Linux是多么的动态！</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mb"><img src="../Images/c2fc35563459d8e8be764f95a22c27bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z4GibVE7gL4OzUaWNiGSSg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">我的机器的/etc/pam.d/目录的屏幕截图</figcaption></figure><p id="e1fb" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">PAM是一个C++接口，实现这个接口的人成为一个认证方法。因此，实现PAM接口的文件只需在文件“/etc/pam.d/common-auth”中添加一行就可以成为一种认证方法，这是Ubuntu Linux中的认证规则集。</p><p id="7fbb" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">但更棘手的部分来了。PAM接口是用C++编写的，我已经决定用python实现人脸识别，所以我找不到处理这种情况的方法。我不知道我是怎么知道的，但是当我在寻找一些东西的时候，我知道了<a class="ae kr" href="http://pam-python.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> pam_python </a>。而pam_python是pam接口C++和python语言之间的桥梁。</p><h2 id="12b0" class="lh ig hi bd ih li lj lk il ll lm ln ip jo lo lp it js lq lr ix jw ls lt jb lu bi translated">部署阶段</h2><p id="5768" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">所以在做了这些研究之后，我安装了pam_python，并将pam_python.so文件放入“<em class="ma">/lib/x86 _ 64-Linux-GNU/security/</em>”目录中。请参见下图。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mb"><img src="../Images/3a65afdae019c632a10435e8a74fea1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0LHFHyoxDCLnNlMonrvXw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">我的机器的<em class="mc">/lib/x86 _ 64-Linux-GNU/security/</em>目录截图</figcaption></figure><p id="2e04" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">然后我在pam_python的帮助下实现了PAM接口，并实现了4个必须实现的功能，</p><blockquote class="md me mf"><p id="b817" class="jd je ma jf b jg lv ji jj jk lw jm jn mg lx jq jr mh ly ju jv mi lz jy jz ka hb bi translated"><strong class="jf hj"><em class="hi">(1)PAM _ sm _ authenticate(pamh，flags，args) </em> </strong> <em class="hi">(对于“sudo”命令)</em></p><p id="22f7" class="jd je ma jf b jg lv ji jj jk lw jm jn mg lx jq jr mh ly ju jv mi lz jy jz ka hb bi translated"><strong class="jf hj"><em class="hi">(2)PAM _ sm _ open _ session(pamh，flags，args) </em> </strong> <em class="hi">(用于打开类似登录和“su”命令的会话)</em></p><p id="fe5f" class="jd je ma jf b jg lv ji jj jk lw jm jn mg lx jq jr mh ly ju jv mi lz jy jz ka hb bi translated"><strong class="jf hj"><em class="hi">(3)PAM _ sm _ close _ session(pamh，flags，args) </em> </strong> <em class="hi">(用于关闭会话)</em></p><p id="8b99" class="jd je ma jf b jg lv ji jj jk lw jm jn mg lx jq jr mh ly ju jv mi lz jy jz ka hb bi translated"><strong class="jf hj"><em class="hi">(4)PAM _ sm _ setcred(pamh，flags，args) </em> </strong> <em class="hi">(设置当前用户与认证句柄关联的凭证)。</em></p></blockquote><p id="b704" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">然后，为了将它添加到身份验证方法列表中，我必须在/etc/pam.d/目录中创建一个类似once的规则文件，并将其放入/usr/share/pam-configs/目录中。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mb"><img src="../Images/bd52d83c84a7219ce92ce5f140a7b568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8y4bYhjmxFoDflv83p9Y7A.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">我的机器的/usr/share/PAM-configs/<em class="mc"/>目录截图</figcaption></figure><p id="eb5d" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">然后嘣！！它开始工作了。尽管在制作过程中遇到了很多困难。<strong class="jf hj"> <em class="ma">我两次差点把我整个系统都败坏了！但是恢复模式救了我:</em> </strong>)</p><h2 id="f650" class="lh ig hi bd ih li lj lk il ll lm ln ip jo lo lp it js lq lr ix jw ls lt jb lu bi translated">一些最后的润色</h2><p id="65fb" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我想让其他人安装起来更简单，所以我写了shell脚本，这样任何人都可以用5-6个命令安装它，这些命令在<a class="ae kr" href="https://github.com/rushabh-v/linux_face_unlock" rel="noopener ugc nofollow" target="_blank">的自述文件</a>中有提到。我编写了shell脚本，向系统添加名为“facerec”的命令，该命令可用于启用面部解锁，并向系统添加新的额外面部模型，如“facerec enable”和“facerec new”。</p><p id="e49a" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">在登录和运行“sudo”或“su”命令时，面部解锁运行得非常好。虽然这个过程有点慢。下面是这个项目我的GitHub回购的链接。</p><div class="mj mk ez fb ml mm"><a href="https://github.com/rushabh-v/linux_face_unlock" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">rushabh-v/linux_face_unlock</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">安装:步骤1…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">github.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na kl mm"/></div></div></a></div><p id="bab9" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">任何人都可以通过在他们的系统中运行5-6个命令来安装它。这些都写在自述文件中，您可以随时访问并安装它。<strong class="jf hj"> <em class="ma">投稿和问题或任何新想法都是最受欢迎的</em>。因为我对它有进一步的计划，</strong></p><p id="9cc8" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">1.<em class="ma">增加并行处理以提高速度。</em></p><p id="a24b" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">2.<em class="ma">改变算法，使用自动编码器和解码器技术并使用</em> <a class="ae kr" href="https://www.kaggle.com/c/recognizing-faces-in-the-wild/data" rel="noopener ugc nofollow" target="_blank"> <em class="ma">该数据集</em> </a> <em class="ma">制作无监督算法。我认为这在分类方面可以成为一个更有效的算法。</em></p><p id="769d" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated">3.由于它只针对Ubuntu发行版，现在增加对其他发行版的支持也在列表中。</p><h1 id="ee28" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><p id="7e43" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这样你也可以在你选择的Linux发行版中添加你喜欢的特性。你所需要的只是研究和耐心。</p><p id="e6ef" class="pw-post-body-paragraph jd je hi jf b jg lv ji jj jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ma"> PS:想找ML/DL的实习。结帐我的(</em></strong><a class="ae kr" href="https://github.com/rushabh-v" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj"><em class="ma">GitHub</em></strong><strong class="jf hj"><em class="ma">)、(</em></strong></a><a class="ae kr" href="https://www.kaggle.com/rushabhvasani24" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj"><em class="ma">Kaggle</em></strong></a><strong class="jf hj"><em class="ma">)和(</em></strong><a class="ae kr" href="https://www.linkedin.com/in/rushabh-v/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj"><em class="ma">LinkedIn</em></strong></a><strong class="jf hj"><em class="ma">)个人资料。</em>T57】</strong></p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es nb"><img src="../Images/d9b7828d63c9cd5ccaa77cb2eac84b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/1*xn0xsLnJ0H3C6kCqmHqwUQ.gif"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">来源:https://media.giphy.com/media/VbnUQpnihPSIgIXuZv/giphy.gif</figcaption></figure><blockquote class="nc"><p id="a821" class="nd ne hi bd nf ng nh ni nj nk nl ka dx translated">继续读，继续黑——谢谢:)</p></blockquote></div></div>    
</body>
</html>