<html>
<head>
<title>Conversion of WhatsApp .text file to.CSV | Pandas|Simple way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WhatsApp的转换。文本文件到。CSV |熊猫|简单方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/conversion-of-whatsapp-text-file-to-csv-pandas-simple-way-c721cddd97bd?source=collection_archive---------4-----------------------#2019-12-11">https://medium.com/analytics-vidhya/conversion-of-whatsapp-text-file-to-csv-pandas-simple-way-c721cddd97bd?source=collection_archive---------4-----------------------#2019-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ec21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如今的交流方式已经变成了WhatsApp。通过WhatsApp传递了很多信息。</p><p id="5097" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了分析人与人之间的这种信息，我们需要数据。WhatsApp提供了将一个人的聊天内容导出为文本文件的选项。</p><p id="c478" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于分析目的的文本文件的可用性有点复杂。因此需要将文本文件转换成可用文件。csv文件格式。最初，当我开始做这样的转换时，我在网上查阅了许多代码，这些代码是以一种非常复杂的方式编写的。</p><p id="6f46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了进行简单的转换，我使用了熊猫。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3116705c4c147abd4bcfbc664a41c4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xwm2TjlkUZ50ucQ9WxKKWQ.png"/></div></div></figure><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="8b69" class="ju jv hi jq b fi jw jx l jy jz">import pandas as pd</span><span id="a6b4" class="ju jv hi jq b fi ka jx l jy jz">filename="whatsappchat.txt"</span><span id="bc48" class="ju jv hi jq b fi ka jx l jy jz">df=pd.read_csv(filename,header=None,error_bad_lines=False,encoding=’utf8')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/a5ca42b389cf40a7e4322c7a1df0ffcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5a29VagE60GrrZ3RsTPJKA.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">当read_csv从pandas读取原始WhatsApp文本文件时</figcaption></figure><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="6075" class="ju jv hi jq b fi jw jx l jy jz">df= df.drop(0)<br/>df.columns=['Date', 'Chat']</span></pre><p id="9c16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集的第一行有“邮件加密详细信息”，它不希望我删除数据集的第一行。接下来，我将这些列命名为“日期”和“聊天”</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="62e9" class="ju jv hi jq b fi jw jx l jy jz">Message= df[“Chat”].str.split(“-”, n = 1, expand = True)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kg"><img src="../Images/ac978c78c3e6761f64d0e5024cb0bfa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*oGC-wuMGvf83OhchSUfIIQ.png"/></div></figure><p id="4a3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从数据集“聊天”列创建为一个独立的数据框，将时间和人名、消息合二为一。</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="f905" class="ju jv hi jq b fi jw jx l jy jz">df[‘Time’]=Message[0]<br/>df[‘Text’]=Message[1]</span></pre><p id="3377" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述代码在取自“消息”<strong class="ih hj">数据帧的数据中创建“时间”<strong class="ih hj">列</strong>。</strong>代码的第二行创建“文本”。</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="2528" class="ju jv hi jq b fi jw jx l jy jz">Message1= df[“Text”].str.split(“:”, n = 1, expand = True)</span></pre><p id="5c04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集的“文本”列创建另一个数据集“消息1”，因为“文本”列由聊天人姓名和聊天消息组成。从“Message1”数据集中，使用“:”拆分人和聊天消息。</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="efc9" class="ju jv hi jq b fi jw jx l jy jz">df[‘Text’]=Message1[1]<br/>df[‘Name’]=Message1[0]</span></pre><p id="1b8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以创建仅包含文本消息的“文本”列和包含各个消息的聊天人姓名的“姓名”列。</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="79d5" class="ju jv hi jq b fi jw jx l jy jz">df=df.drop(columns=[‘Chat’])<br/>df[‘Text’]=df[‘Text’].str.lower()</span></pre><p id="5dde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经从数据集中删除了“聊天”列。为简单起见，所有文本都转换为小写(可选)</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="d046" class="ju jv hi jq b fi jw jx l jy jz">df[‘Text’] = df[‘Text’].str.replace(‘&lt;media omitted&gt;’,’MediaShared’)<br/>df[‘Text’] = df[‘Text’].str.replace(‘this message was deleted’,’DeletedMsg’)</span></pre><p id="d05f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在“文本”列中，媒体省略的单元格和删除的消息被替换为字符串“媒体共享”和“删除的消息”</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/9f5784103fa498f765ef40d88783f4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8om_SY6CB6Sr8if7eJDYg.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">转换后的文本文件作为数据框的最终结果</figcaption></figure><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="11be" class="ju jv hi jq b fi jw jx l jy jz">df.to_csv("converted_csv.csv",index=False)</span></pre><p id="4e3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据框被转换为. csv文件并保存以备将来使用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/a9b7adf4db61e5e5114a1326dbc3f5cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFwXeTyF3mgwQRKUbqs04g.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">转换的. csv文件</figcaption></figure><p id="126a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您的文件已准备好进行简单的分析。</p><p id="adb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面你可以复制完整的代码</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="aadb" class="ju jv hi jq b fi jw jx l jy jz">import pandas as pd<br/>filename="mom.txt"</span><span id="c94e" class="ju jv hi jq b fi ka jx l jy jz">df=pd.read_csv(filename,header=None,error_bad_lines=False,encoding='utf8')<br/>df= df.drop(0)<br/>df.columns=['Date', 'Chat']<br/>Message= df["Chat"].str.split("-", n = 1, expand = True) <br/>df['Date']=df['Date'].str.replace(",","") <br/>df['Time']=Message[0]<br/>df['Text']=Message[1]<br/>Message1= df["Text"].str.split(":", n = 1, expand = True) <br/>df['Text']=Message1[1]<br/>df['Name']=Message1[0]<br/>df=df.drop(columns=['Chat'])<br/>df['Text']=df['Text'].str.lower()<br/>df['Text'] = df['Text'].str.replace('&lt;media omitted&gt;','MediaShared')<br/>df['Text'] = df['Text'].str.replace('this message was deleted','DeletedMsg')    <br/>f.to_csv("converted_csv.csv",index=False)<br/>        </span></pre><p id="3137" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢你。快乐分析！！</p><p id="b709" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢，请鼓掌。意味着很多。</p></div></div>    
</body>
</html>