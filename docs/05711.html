<html>
<head>
<title>Developing a Face detector Android app using Unity3D and OpenCV-CPP plugin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Unity3D和OpenCV-CPP插件开发人脸检测器Android应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/developing-a-face-detector-android-app-using-unity3d-and-opencv-cpp-plugin-7427413f1656?source=collection_archive---------6-----------------------#2020-04-30">https://medium.com/analytics-vidhya/developing-a-face-detector-android-app-using-unity3d-and-opencv-cpp-plugin-7427413f1656?source=collection_archive---------6-----------------------#2020-04-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/89b3a6ddaef91814207d2fa463bb1bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PeIRX5V97omAW9i5.png"/></div></div></figure><p id="60a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">曾经想为边缘设备开发任何应用程序吗？曾经想要利用高效的库来构建实时应用程序。这篇博客将帮助你理解和利用cpp的效率，使用unity3d构建一个高效的android应用程序。这里提到的方法是一个通用的方法，可以用来创建类似的方法。</p><p id="6a06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很长一段时间，我试图开发一个基于android的应用程序，用于一般的人脸检测。我有一些用OpenCV写的旧c++代码。我在探索创造它的不同方式。一个明显的步骤是将完整的c++代码移植到java，并使用android studio来构建原生android应用程序。由于在AR/VR或游戏行业工作的大多数开发人员都使用<a class="ae jo" href="https://unity.com/" rel="noopener ugc nofollow" target="_blank"> Unity3d </a>对他们来说，构建高级UI应用程序将非常方便。但真正的挑战是处理矩阵运算和其他繁重的计算工作，这是你在构建计算机视觉或任何基于DL/ML的应用程序时会遇到的。使用cpp编写繁重的计算操作将变得简单而高效。因此，在本文中，我主要关注使用Unity3D和原生CPP开发一个android应用程序。</p><h1 id="60f9" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">为Android编译OpenCV</strong></h1><p id="0e81" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">实现这一目标的第一步是从src为android编译OpenCV。</p><ol class=""><li id="2756" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated">从<a class="ae jo" href="https://github.com/opencv/opencv" rel="noopener ugc nofollow" target="_blank"> Github </a>下载OpenCV。</li><li id="4110" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">选择<strong class="is hj">“MinGW Makefiles</strong>”作为生成器</li><li id="3b4b" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">选择“<strong class="is hj">指定交叉编译的工具链文件</strong></li><li id="ea7a" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">然后像这样提供工具链路径</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/2a67f1cf8f35e75e27cac92f7c8a6c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*l7SJ5gjBDyzfAbASLCcrpg.png"/></div></figure><p id="eafe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.禁用BUILD_ANDROID_EXAMPLES，BUILD_ANDROID_PROJECTS，BUILD_TESTS，BUILD_PREF_TESTS，BUILD_FAT_JAVA_LIB，启用BUILD_SHARED_LIBS</p><p id="71ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.然后使用"<strong class="is hj"> mingw32-make" </strong>命令来构建共享库</p><p id="b904" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.使用<strong class="is hj"> make install </strong>在特定位置安装库</p><p id="479f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:这里我使用的是visual studios ndk库工具链，而不是OpenCV附带的工具链，以避免clang和gcc兼容性的问题</p><h1 id="0052" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">正在为Unity3d创建人脸检测库</h1><p id="3c20" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在我们已经为android构建了OpenCV共享库，是时候为unity3d创建一个共享库了。</p><ol class=""><li id="866f" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated">用android开发环境设置Visual Studio(我用的是visual studio 2019)</li><li id="4708" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">创建“<strong class="is hj">动态共享库Android </strong></li><li id="3734" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">使用构建的OpenCV库路径和包含路径进行配置</li><li id="6403" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">将配置类型设置为<strong class="is hj">“动态库(。所以)</strong></li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/822a4985900c7325f6eb8dcfe5ba0657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sETahW6xEla2mqDRuVz7A.png"/></div></div></figure><p id="dee5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.在“<strong class="is hj"> VC++目录&gt; &gt;包含目录”</strong>中添加包含路径</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/93ed861b3cf0da62b9eb27d731ab9407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6dDLT3NHctLlRnQElvl2JA.png"/></div></div></figure><p id="3c07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.在<strong class="is hj">链接器&gt;中&gt;添加库目录</strong>添加库路径</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/e32e2f44a31b316d1daeaba544be716d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KeClMo2Z3b5DoqcYj5HCXg.png"/></div></div></figure><p id="f360" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.添加库到<strong class="is hj">链接器&gt;输入&gt;库&gt;依赖项</strong></p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/d4d0e592283493861ff83f2654e2837b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BBqM750BJ2O3S7z1m8tv-w.png"/></div></div></figure><p id="5458" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦配置完成，我们就可以编译现有代码来构建共享库了。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lp lq l"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">sharedocv.h文件</figcaption></figure><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lp lq l"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">sharedocv.cpp</figcaption></figure><p id="edb8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“<strong class="is hj"> sharedocv.h </strong>”文件实现函数定义，“<strong class="is hj"> sharedocv.cpp </strong>”文件实现共享库的函数和导出函数。</p><h1 id="f193" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">使用unity3d创建Android应用程序</h1><ol class=""><li id="6cee" class="ks kt hi is b it kn ix ko jb lv jf lw jj lx jn kx ky kz la bi translated">为Android配置Unity3d。你可以<a class="ae jo" href="https://docs.unity3d.com/Manual/android-BuildProcess.html" rel="noopener ugc nofollow" target="_blank">勾选这个</a>。网上有很多<a class="ae jo" href="https://www.instructables.com/id/How-to-Make-an-Android-App-Using-Unity/" rel="noopener ugc nofollow" target="_blank">文章</a>为Android配置unity3d以防你遇到困难。</li><li id="4a27" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">创建一个画布，并添加RawImage和按钮，文字如下</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/566fe4138eb5f22313cf1c80a9bf40d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RQ4_0MgDD34Btrf4SdcApA.png"/></div></div></figure><p id="f3a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.创建脚本来捕捉视频和检测面部</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="1ea7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.将脚本附加到“<strong class="is hj">event system”</strong>并链接对象，如下所示</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/d337477dc8b3358f14ec593779285dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*3DwXhanl5JlpoVd2-yFegg.png"/></div></figure><p id="9e80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.现在用“<strong class="is hj">il 2cpp”</strong>而不是<strong class="is hj">“Mono”构建应用程序。</strong>要更改，请转到“<strong class="is hj">播放器设置&gt; &gt;配置&gt; &gt;脚本后端</strong>”。</p><p id="5c63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">检查我的<a class="ae jo" href="https://github.com/saikiran321/FacedetectorAndroidUnity" rel="noopener ugc nofollow" target="_blank"> Github </a>的完整项目。</p><p id="9f92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想了解更多关于为边缘设备开发高效、实时应用的信息，请通过LinkedIn 与我联系。</p><p id="e1c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">参考资料:</p><ol class=""><li id="caee" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated"><a class="ae jo" href="https://amin-ahmadi.com/2019/02/03/how-to-build-opencv-4-x-for-native-android-development/" rel="noopener ugc nofollow" target="_blank">https://Amin-Ahmadi . com/2019/02/03/how-to-build-opencv-4-x-for-native-Android-development/</a></li><li id="9e89" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated"><a class="ae jo" href="https://github.com/spmallick/learnopencv/blob/master/FaceDetectionComparison/" rel="noopener ugc nofollow" target="_blank">https://github . com/spmallick/learnopencv/blob/master/face detection comparison/</a></li></ol></div></div>    
</body>
</html>