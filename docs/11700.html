<html>
<head>
<title>Pinterest x Free Excel x PowerQuery Template</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pinterest x免费Excel x PowerQuery模板</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pinterest-x-free-excel-x-powerquery-template-5a408bc38b83?source=collection_archive---------25-----------------------#2020-12-14">https://medium.com/analytics-vidhya/pinterest-x-free-excel-x-powerquery-template-5a408bc38b83?source=collection_archive---------25-----------------------#2020-12-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4709" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就个人而言，在这次疫情期间，Pinterest与其他社交媒体平台相比，相当有趣，引人注目，令人耳目一新。无论是人气还是股价。Pinterest第三季度月度活跃用户的国际增长率为46%，股价今年迄今已飙升256%。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/01aa8b87e51a2fd8a4fa6572b47da483.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IM-qNoTDHTrsp98OrA-fxg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae jt" href="https://unsplash.com/photos/hOGKh5qHNAE?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditShareLink" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/hOGKh5qHNAE?utm_source=unsplash&amp;UTM _ medium = referral&amp;UTM _ content = creditShareLink</a></figcaption></figure><blockquote class="ju jv jw"><p id="2b4c" class="if ig jx ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">https://www . fool . com/investing/2020/11/22/up-over-250-in-2020-is-Pinterest-stock-still-a-buy/</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/9698983d6b70eee5c0ee254c4239ed24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9m0y3H5MNmQ9LUuRX2t_WA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Pinterest受众洞察仪表板</figcaption></figure><p id="1f40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这些信息，我决定冒险买一些Pinterest的股票，并决定为我未来的在线商店尝试这个平台。【Pinterest业务中有一些非常有趣的分析&gt;分析&gt;受众洞察，作为一个好奇的数据人，我下载了可用的原始数据，以了解什么是<strong class="ih hj"> <em class="jx">【引擎盖下】</em> </strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0a280be81c657bc28a0c5394f096cdf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bDqwSUir5JtC3j4Qu4gpxw.gif"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">下载用于分析的原始数据</figcaption></figure><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="3f42" class="kh ki hi kd b fi kj kk l kl km"><em class="jx">Interests<br/>Category,Bulk Sheet Category,Percent of audience,Affinity,Interest,Bulk Sheet Interests,Percent of audience,Affinity<br/>Home Decor,”{‘name’: ‘Home Decor’, ‘id’: ‘935249274030’}”,0.67,1.0,Room Decor,”{‘name’: ‘Room Decor’, ‘id’: ‘916836567854’}”,0.58,1.0</em></span></pre><blockquote class="kn"><p id="4c65" class="ko kp hi bd kq kr ks kt ku kv kw jc dx translated">对于Excel用户来说，OG格式并不友好。让自动化成为Excel友好的</p></blockquote></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="2bb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">天啊，所有的数据都以csv格式排列在一起，在excel中手动分离并不容易，更不用说每月更新了。<br/>理想情况下，在Excel中，我们可以使用“Delimited”并通过“comma”进行拆分，但是{' …'}之间的文本和在顶部附加较新的月份数据带来了一些挑战。让我们也不要忘记人类的错误，因为这是容易发生的，无论何时任何人都在做这样的每月世俗任务。(有罪必罚)<br/>我决定用PowerQuery创建一个解决方案，并构建一个自定义函数来<strong class="ih hj"> <em class="jx">清理和追加数据</em> </strong>，供那些对每月网站分析感到好奇的Pinterest用户使用。</p><blockquote class="kn"><p id="02b0" class="ko kp hi bd kq kr lf lg lh li lj jc dx translated">W <strong class="ak"> hy写自定义函数？</strong></p></blockquote><ol class=""><li id="f73b" class="lk ll hi ih b ii lm im ln iq lo iu lp iy lq jc lr ls lt lu bi translated">清洁。csv自动减少人为错误</li><li id="f436" class="lk ll hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">以所需的格式附加数据，以便于分析</li><li id="14a7" class="lk ll hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">腾出你的时间去处理更重要的任务</li></ol></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/9f78baef35ff28e5c537f82e04d60133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ey2bNNJzMjS998WTWH_fQg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">重命名文件夹中的文件名</figcaption></figure><h1 id="7b57" class="mb ki hi bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">步骤1:创建文件夹</h1><p id="e26f" class="pw-post-body-paragraph if ig hi ih b ii my ik il im mz io ip iq na is it iu nb iw ix iy nc ja jb jc hb bi translated">创建一个新文件夹，命名为“Pinterest_Data”或任何让你开心的名字:)<br/>这是你把所有。csv文件到此文件夹中，在csv文件的末尾添加“_[月][年]”，例如Pinterest_10_2020.csv。(对于此示例，我没有添加[年])</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nd"><img src="../Images/02a2ecbb474d80e81cd3da6fa15d7a9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YbgyobEumTP5cUWTTpTlYA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从文件夹中读取的步骤</figcaption></figure><h1 id="40ea" class="mb ki hi bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">步骤2:使用PowerQuery通过文件夹读取文件</h1><p id="c6ee" class="pw-post-body-paragraph if ig hi ih b ii my ik il im mz io ip iq na is it iu nb iw ix iy nc ja jb jc hb bi translated">转到数据&gt;获取数据&gt;从文件&gt;从文件夹，您的文件路径将出现在源文件下。由于我们正在将每月数据文件转储到该文件夹中，PowerQuery将自动拾取新添加的文件。<br/>我们将在创建自定义功能后继续以下步骤，因此我们不需要永远重复这些步骤:)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ne"><img src="../Images/5b90bbd31c008ae3a1424d611c59688d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9-jDoiRcK2rHjxWwtS4JQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">清理一个。csv文件</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/0915d1d5d2bacc9c0c14b70b033826fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TbOOzo61vhZ83QmnzxcH6w.jpeg"/></div></div></figure><h1 id="05ce" class="mb ki hi bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">步骤3:创建自定义函数</h1><p id="1649" class="pw-post-body-paragraph if ig hi ih b ii my ik il im mz io ip iq na is it iu nb iw ix iy nc ja jb jc hb bi translated">从步骤2复制一个查询，并将其重命名为FNpinterest_cleaning。在这个查询中，我将修剪、删除字符，并按分隔符进行分割，以便可以使用</p><p id="db72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我对数据格式感到满意，让我们在查询“let”开始之前单击“Advanced Editor”Add()= &gt;，并将此函数命名为(cleanpinterest)，作为一种最佳实践，最好给出一个描述性的名称，以便更容易与查询进行识别。<em class="jx">用(cleanpinterest) </em>替换原始路径名</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ng"><img src="../Images/d3cec601014512b893746297ae9d9b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yHxLl_axS178InaWUr5Wng.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">日期提取</figcaption></figure><h1 id="5201" class="mb ki hi bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">步骤4:从文件中提取下载日期</h1><p id="b63c" class="pw-post-body-paragraph if ig hi ih b ii my ik il im mz io ip iq na is it iu nb iw ix iy nc ja jb jc hb bi translated">这就是有趣的地方:)还记得在第1步中，我们用“_[month][year]”将文件重命名为。csv文件，由于文件中没有任何日期，我们需要创建一些东西来标识日期。<br/>接下来，我要创建一个新列，并按文本分割文件路径。以“_”分隔，这是我们的月份。Woola，现在我们能够在调用函数时识别文件的日期。</p><blockquote class="ju jv jw"><p id="e827" class="if ig jx ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">在这里阅读官方文档<a class="ae jt" href="https://docs.microsoft.com/en-us/powerquery-m/understanding-power-query-m-functions" rel="noopener ugc nofollow" target="_blank"><em class="hi"/></a></p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nh"><img src="../Images/6ed3fa33a87cfb723bd293343fa020f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*148CmWzqyyDrvH4trLi_kg.gif"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">调用自定义函数来清理其他。战斗支援车</figcaption></figure><h1 id="7e57" class="mb ki hi bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">步骤5:调用函数清理所有文件</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ni"><img src="../Images/3a16419f96757780664017b4d083516c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*34mam018LFqJN1eh5ZlkZQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">表或数据透视表中的最终输出</figcaption></figure><h1 id="6dfd" class="mb ki hi bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">第六步:完成</h1><p id="4e3f" class="pw-post-body-paragraph if ig hi ih b ii my ik il im mz io ip iq na is it iu nb iw ix iy nc ja jb jc hb bi translated">完成:)您可以随意跳舞，或者用我们通过这种自动化节省下来的额外时间为自己泡一杯咖啡。<br/>下一步可能是深入了解您的数据。给我一个DM，如果你想要我写的函数的副本。</p><p id="3a78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您使用我的模板，您只需要重新创建步骤1。<br/> <strong class="ih hj">如果你们中有人知道Pinterest中的以下术语“受众百分比、亲和力、兴趣”是什么意思，请发表评论:)感谢</strong></p></div></div>    
</body>
</html>