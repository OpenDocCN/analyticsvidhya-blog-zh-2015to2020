<html>
<head>
<title>How to use Google Colab, Kaggle and Plotly to choose your next AirBnB flat</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Google Colab、Kaggle和Plotly选择你的下一套AirBnB公寓</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-use-google-colab-kaggle-and-plotly-to-choose-your-next-airbnb-flat-e0ca03b08eaa?source=collection_archive---------12-----------------------#2019-12-09">https://medium.com/analytics-vidhya/how-to-use-google-colab-kaggle-and-plotly-to-choose-your-next-airbnb-flat-e0ca03b08eaa?source=collection_archive---------12-----------------------#2019-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="89eb" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">分析AirBnB西雅图开放数据集</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/7438524980fa3a4664c56446eab9d0d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kVlPZAnYMz4Fm-s5"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">萨法尔·萨法罗夫在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="6a25" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="ffea" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">我们大多数人在生活中的某个时候都会预订一套AirBnB公寓来度假。我最近去了德国的科隆，那里以圣诞市场闻名，最后去了一个真正的圣诞市场。然而，当我回来时，我意识到我支付的价格比我的朋友们几周前参观同一地方时支付的价格要高。这让我产生了以下问题:什么因素影响AirBnB公寓的价格？一个城市中不同社区的价格如何波动，季节性如何影响价格。为了回答我的问题，我将使用AirBnB西雅图开放数据集、Google Colab、Kaggle API和Plotly。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="fbba" class="jo jp hi bd jq jr lj jt ju jv lk jx jy io ll ip ka ir lm is kc iu ln iv ke kf bi translated">用数据科学来回答我的问题</h1><p id="1bab" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这是一些可以用数据科学来回答的经典问题。X如何影响Y是数据科学世界的面包和黄油。因此，我们将使用众所周知的CRISP-DM流程来用数据回答我们的问题。CRISP-DM代表数据挖掘的跨行业标准流程，它是许多数据科学家为解决类似问题而遵循的常见流程。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="412b" class="jo jp hi bd jq jr lj jt ju jv lk jx jy io ll ip ka ir lm is kc iu ln iv ke kf bi translated">步骤1 —业务理解</h1><p id="c52f" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">CRISP-DM流程的第一步是了解我们经营的业务或环境。显然，这里没有我们需要了解的业务，但我们了解AirBnB价格是如何形成的，这将是关键。</p><p id="dc92" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">AirBnB预订价格基于以下成本(根据<a class="ae jn" href="https://www.airbnb.com/help/article/125/how-is-the-price-determined-for-my-reservation?locale=en" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj"> AirBnB官网信息</strong> </a>):</p><ul class=""><li id="c671" class="lt lu hi ki b kj lo km lp kp lv kt lw kx lx lb ly lz ma mb bi translated">费用由主办方决定:</li><li id="65b9" class="lt lu hi ki b kj mc km md kp me kt mf kx mg lb ly lz ma mb bi translated">每晚价格:每晚价格由主人决定；</li><li id="09e2" class="lt lu hi ki b kj mc km md kp me kt mf kx mg lb ly lz ma mb bi translated">清洁费:一些主机收取的一次性费用，用于支付清洁其空间的成本；</li><li id="d602" class="lt lu hi ki b kj mc km md kp me kt mf kx mg lb ly lz ma mb bi translated">额外来宾费:一些主机收取的一次性费用，用于支付与使用他们的空间相关的其他费用；</li><li id="d1c3" class="lt lu hi ki b kj mc km md kp me kt mf kx mg lb ly lz ma mb bi translated">Airbnb确定的费用:Airbnb服务费；</li><li id="13f1" class="lt lu hi ki b kj mc km md kp me kt mf kx mg lb ly lz ma mb bi translated">可能包括的其他费用:货币兑换费、增值税、其他地方税等。</li></ul><h1 id="8aaa" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">步骤2—数据理解</h1><p id="1a97" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">从这个阶段开始，乐趣逐渐增加。</p><p id="f26f" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">第一步是加载我们的数据。我们将使用Google Colab作为我们的笔记本。Colab是一个免费的Jupyter笔记本环境，不需要设置，完全在云中运行。(<a class="ae jn" href="https://colab.research.google.com" rel="noopener ugc nofollow" target="_blank">https://colab.research.google.com</a>)</p><p id="293d" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">为了获得我们的数据，我们需要将它与Kaggle API连接起来。</p><p id="8056" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">首先我们需要和<a class="ae jn" href="http://www.kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>签约。去<a class="ae jn" href="http://www.Kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>注册——这是免费的——然后去我的账户，在那里选择创建新的API令牌。将下载一个json文件，您可以使用下面的代码将它上传到您的Colab笔记本。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="f1fa" class="mm jp hi mi b fi mn mo l mp mq">#install kaggle<br/>!kaggle</span><span id="8e41" class="mm jp hi mi b fi mr mo l mp mq">#upload our kaggle key<br/>from google.colab import files<br/>files.upload()</span><span id="f45a" class="mm jp hi mi b fi mr mo l mp mq">#set up the directory<br/>!mkdir  -p ~/.kaggle!cp kaggle.json ~/.kaggle/<br/>!chmod 600 ~/.kaggle/kaggle.json</span></pre><p id="1547" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">然后，我们将需要从Kaggle的数据集链接，我们只是把它粘贴在这里，然后解压缩我们的文件。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="72a6" class="mm jp hi mi b fi mn mo l mp mq">#API link that we get from Kaggle<br/>!kaggle datasets download -d airbnb/seattle</span><span id="223e" class="mm jp hi mi b fi mr mo l mp mq">#unzip the files</span><span id="2f01" class="mm jp hi mi b fi mr mo l mp mq">import zipfile<br/>with zipfile.ZipFile('seattle.zip', 'r') as zip_ref:<br/>zip_ref.extractall()</span><span id="f1df" class="mm jp hi mi b fi mr mo l mp mq">#simply read our data files</span><span id="1d92" class="mm jp hi mi b fi mr mo l mp mq">listings = pd.read_csv('listings.csv')<br/>calendardf = pd.read_csv('calendar.csv')<br/>reviews = pd.read_csv('reviews.csv'</span></pre><p id="9a06" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">为了得到我们数据的第一张图表，我将通过键入以下命令来检查我们数值的分布</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="6ea7" class="mm jp hi mi b fi mn mo l mp mq">fig = plt.figure(figsize = (20,16))<br/>ax = fig.gca()<br/>listings.hist(ax=ax)<br/>plt.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ms"><img src="../Images/ce0922e497a9d52afb5fff0bf87e0cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vYAP_IVgnFz5WFTRp_2T2g.png"/></div></div></figure><h1 id="d8dd" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">步骤3—数据准备</h1><p id="4a1a" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在回答我们的问题之前，还有一个步骤是处理我们的数据集，为分析做好准备——你可以在github资源库<a class="ae jn" href="https://github.com/harrystamatoukos/datascience/blob/master/Airbnb_Seattle.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>跟随这个过程。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="8c68" class="jo jp hi bd jq jr lj jt ju jv lk jx jy io ll ip ka ir lm is kc iu ln iv ke kf bi translated">步骤4—数据建模</h1><p id="6bca" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在这里，我们将回答3个主要问题</p><p id="6ed0" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">有关数据建模的代码，请访问我的报告中的笔记本</p><div class="mt mu ez fb mv mw"><a href="https://github.com/harrystamatoukos/datascience/blob/master/Airbnb_Seattle.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab dw"><div class="my ab mz cl cj na"><h2 class="bd hj fi z dy nb ea eb nc ed ef hh bi translated">harrystamatoukos/数据科学</h2><div class="nd l"><h3 class="bd b fi z dy nb ea eb nc ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ne l"><p class="bd b fp z dy nb ea eb nc ed ef dx translated">github.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk jh mw"/></div></div></a></div></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="6879" class="jo jp hi bd jq jr lj jt ju jv lk jx jy io ll ip ka ir lm is kc iu ln iv ke kf bi translated">步骤5—结果交流</h1><h2 id="4056" class="mm jp hi bd jq nl nm nn ju no np nq jy kp nr ns ka kt nt nu kc kx nv nw ke nx bi translated">问题1:西雅图不同社区的房价有什么不同？</h2><p id="7ed5" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这里我们绘制了西雅图每个街区的平均价格。让我们看看他们是怎么做的:</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="ecda" class="mm jp hi mi b fi mn mo l mp mq">fig = go.Figure(<br/>data=[go.Bar(<br/>y=Price_by_Neighbourhoud_df['price'], x=Price_by_Neighbourhoud_df['neighbourhood_group_cleansed'])],<br/>layout_title_text="Price by Neigbhbourhood in Seattle")<br/>fig.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ny"><img src="../Images/c38ac0e66a70e34b102d337dcaa254f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1fuWpZShFGQuzsmVKft7g.png"/></div></div></figure><p id="866a" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">木兰花和市中心似乎是预订下一套公寓最贵的街区。真正有趣的是，它们的平均价格是Northgate和Delridge等公司的两倍。如果你预算有限，你知道该去哪里。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h2 id="a0e7" class="mm jp hi bd jq nl nm nn ju no np nq jy kp nr ns ka kt nt nu kc kx nv nw ke nx bi translated">问题2:价格如何受季节性影响？</h2><p id="6236" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">为了回答这个问题，我们创建了一个名为“Month”的新列，从数据集中的每个日期“提取”月份。然后类似于我们上面所做的，我们创建了下面的图表。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="ed99" class="mm jp hi mi b fi mn mo l mp mq">#find average price by month</span><span id="0c31" class="mm jp hi mi b fi mr mo l mp mq">average_price_by_month = pd.DataFrame(df.groupby(['month'])['price'].mean().reset_index())</span><span id="4d11" class="mm jp hi mi b fi mr mo l mp mq">#create figure in plotly<br/>fig = go.Figure(data=[go.Scatter(<br/>y=average_price_by_month['price'], x=average_price_by_month['month'])],<br/>layout_title_text="Average Price by Month in Seattle")</span><span id="c98f" class="mm jp hi mi b fi mr mo l mp mq">fig.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ny"><img src="../Images/11a7e72dba4edc78462e7045915429e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2OmyfZHUmeZmlncVAvqXQ.png"/></div></div></figure><p id="3ea7" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">从上面的图可以明显看出，如果你在预算之内，你需要做什么。夏天不要旅游！从价格角度来看，旅行的最佳月份是冬季的头几个月、一月、二月和三月。不过，最好先检查一下温度。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h2 id="a009" class="mm jp hi bd jq nl nm nn ju no np nq jy kp nr ns ka kt nt nu kc kx nv nw ke nx bi translated">问题3:</h2><h2 id="c86b" class="mm jp hi bd jq nl nm nn ju no np nq jy kp nr ns ka kt nt nu kc kx nv nw ke nx bi translated">影响价格的因素有哪些？？</h2><p id="43b7" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">最后，我们想了解哪些因素与价格高度相关。我们将需要使用Plotly的图形工厂来注释热图。瞧啊。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="f110" class="mm jp hi mi b fi mn mo l mp mq">import plotly.figure_factory as ff</span><span id="6f8d" class="mm jp hi mi b fi mr mo l mp mq">z_text = np.around(corrs, decimals=2)<br/>fig = ff.create_annotated_heatmap(z=corrs,<br/>annotation_text=z_text,<br/>x=cols,<br/>y=cols,<br/>hoverongaps = True,<br/>colorscale = 'Magma',)</span><span id="5d0f" class="mm jp hi mi b fi mr mo l mp mq">fig.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ny"><img src="../Images/b03e0bf74b8627d40097454b9889a6de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6uWh7Dl1yxxttblHDdtmQ.png"/></div></div></figure><p id="a90b" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">从上面的图中，我们可以得出一些结论，证明我们直觉上已经知道的东西是正确的。房间越大，价格越高。没有获得真正的智慧，但是把数字放在我们的直觉后面是很有趣的。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="206d" class="jo jp hi bd jq jr lj jt ju jv lk jx jy io ll ip ka ir lm is kc iu ln iv ke kf bi translated">结论</h1><p id="77a8" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">总而言之，我们最初看到了如何开始在Google Colab中工作，以及如何使用Kaggle API加载我们的数据。然后我们用Plotly创建了一些漂亮的图表，这些图表也回答了我们关于AirBnB公寓价格的3个问题，最终归结为:如果你预算有限，那么就在冬天旅行，避开好的社区。如果你是一个经验丰富的旅行者，你已经知道这一点，但现在它得到了科学的支持。</p><p id="641d" class="pw-post-body-paragraph kg kh hi ki b kj lo ij kl km lp im ko kp lq kr ks kt lr kv kw kx ls kz la lb hb bi translated">请随意查看数据集，并告诉我您还发现了什么。我将继续挖掘和改进我在github repo中的发现。</p></div></div>    
</body>
</html>