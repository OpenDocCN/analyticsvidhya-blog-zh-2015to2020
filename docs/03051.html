<html>
<head>
<title>How to scrape news headlines from Reuters?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从路透社刮出新闻标题？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-scrape-news-headlines-from-reuters-27c0274dc13c?source=collection_archive---------10-----------------------#2020-01-14">https://medium.com/analytics-vidhya/how-to-scrape-news-headlines-from-reuters-27c0274dc13c?source=collection_archive---------10-----------------------#2020-01-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b261d1c1aa7b6c2b44ebe7b43b27b3c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NEVsx3dcPfRCLo8P"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae iu" href="https://unsplash.com/@freegraphictoday?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">absolute vision</a>拍摄</figcaption></figure><p id="3414" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">网络抓取可能是一项复杂的任务，因为如果你只是使用python中的beautifulsoup等库并遍历html，一些网站会阻止你抓取。你需要任务自动化库，比如selenium，这样你就可以在这个软件点击加载更多按钮时抓取大量的标题。看到python中的简单代码如何在瞬间打开浏览器、向下滚动、点击和抓取数据，真的很有趣。</p><p id="3d3c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以让我们开始吧！</p><p id="620b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们得到了路透社的网址，你正计划刮例如，网址是https://www.reuters.com/news/archive/technologynews?的<a class="ae iu" href="https://www.reuters.com/news/archive/technologynews?view=page&amp;page=6&amp;pageSize=10" rel="noopener ugc nofollow" target="_blank">view = page&amp;page = 6&amp;pageSize = 10</a></p><p id="d5a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在你需要看看你如何加载更多的文章，每一页都有不同的方式来加载更多的项目，它们是:向下滚动，点击页码，点击下一页或点击加载更多。</p><p id="ac98" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，该网页重定向到其他网页时，你点击较早</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/de5db7caa3e5d09244eaa1cdff311c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f4feyUOqhzHtTxst1ZLGeQ.png"/></div></div></figure><p id="bccc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，类名是control-nav-next，每篇新闻文章的类名是story-title。现在我们已经完成了关于页面如何工作的研究，我们可以开始用python编码了</p><p id="177c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们开始编码之前，我想告诉你我们将使用selenium来达到这个目的。Selenium是一个流行的基于web的开源自动化工具，也用于测试，我们将使用selenium的力量来抓取标题。</p><p id="e4e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们跳到代码</p><p id="0b7a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先使用以下命令安装selenium:pip install selenium</p><p id="0193" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在创建一个单独的项目，并确保你下载了chromedriver。如果没有，在谷歌上搜索并下载最新版本。如果你下载旧版本，问题将开始出现，你将无法调试它，因为它发生在我身上。因此，请确保下载最新的chrome驱动程序</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><pre class="ju jv jw jx fd kf kg kh ki aw kj bi"><span id="40a0" class="kk kl hi kg b fi km kn l ko kp">from selenium import webdriver</span><span id="7b01" class="kk kl hi kg b fi kq kn l ko kp">from selenium.common.exceptions import NoSuchElementException</span><span id="8acc" class="kk kl hi kg b fi kq kn l ko kp">from selenium.webdriver.common.by import By</span><span id="a69d" class="kk kl hi kg b fi kq kn l ko kp">from selenium.webdriver.support.ui import WebDriverWait</span><span id="39f6" class="kk kl hi kg b fi kq kn l ko kp">from selenium.webdriver.support import expected_conditions as EC</span><span id="7064" class="kk kl hi kg b fi kq kn l ko kp">import dateutil.parser</span><span id="7bcc" class="kk kl hi kg b fi kq kn l ko kp">import time</span><span id="15ac" class="kk kl hi kg b fi kq kn l ko kp">import csv</span><span id="d92c" class="kk kl hi kg b fi kq kn l ko kp">from datetime import datetime</span><span id="c6a5" class="kk kl hi kg b fi kq kn l ko kp">import io</span><span id="c2ed" class="kk kl hi kg b fi kq kn l ko kp">driver = webdriver.Chrome('chromedriver.exe')</span><span id="cbcd" class="kk kl hi kg b fi kq kn l ko kp">driver.get('https://www.reuters.com/news/archive/businessnews?view=page&amp;page=5&amp;pageSize=10')</span></pre><p id="8f51" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加导入启动并初始化chromedriver，确保目录中有chromedriver文件。</p><pre class="ju jv jw jx fd kf kg kh ki aw kj bi"><span id="3947" class="kk kl hi kg b fi km kn l ko kp">count = 0</span><span id="58ad" class="kk kl hi kg b fi kq kn l ko kp">headlines =[]</span><span id="5fa2" class="kk kl hi kg b fi kq kn l ko kp">dates = []</span><span id="66dd" class="kk kl hi kg b fi kq kn l ko kp">for x in range(500):</span><span id="c95f" class="kk kl hi kg b fi kq kn l ko kp">try:</span><span id="f44e" class="kk kl hi kg b fi kq kn l ko kp"># loadMoreButton.click()</span><span id="e660" class="kk kl hi kg b fi kq kn l ko kp"># time.sleep(3)</span><span id="9871" class="kk kl hi kg b fi kq kn l ko kp">loadMoreButton = driver.find_element_by_class_name("control-nav-next")</span><span id="0fa7" class="kk kl hi kg b fi kq kn l ko kp"># driver.execute_script("window.scrollTo(0, document.body.scrollHeight)")</span><span id="a0e5" class="kk kl hi kg b fi kq kn l ko kp">time.sleep(3)</span><span id="faaa" class="kk kl hi kg b fi kq kn l ko kp">loadMoreButton.click()</span><span id="cefa" class="kk kl hi kg b fi kq kn l ko kp">time.sleep(2)</span><span id="227e" class="kk kl hi kg b fi kq kn l ko kp">news_headlines = driver.find_elements_by_class_name("story-title")</span><span id="8999" class="kk kl hi kg b fi kq kn l ko kp">news_dates = driver.find_elements_by_class_name("timestamp")</span><span id="5eab" class="kk kl hi kg b fi kq kn l ko kp">for headline in news_headlines:</span><span id="dcd1" class="kk kl hi kg b fi kq kn l ko kp">headlines.append(headline.text)</span><span id="3296" class="kk kl hi kg b fi kq kn l ko kp">print(headline.text)</span><span id="ccec" class="kk kl hi kg b fi kq kn l ko kp">for date in news_dates:</span><span id="8e21" class="kk kl hi kg b fi kq kn l ko kp">dates.append(date.text)</span><span id="089d" class="kk kl hi kg b fi kq kn l ko kp">print(date.text)</span><span id="39f2" class="kk kl hi kg b fi kq kn l ko kp">count=count+1</span><span id="41f9" class="kk kl hi kg b fi kq kn l ko kp">print("CLICKED!!:")</span><span id="b814" class="kk kl hi kg b fi kq kn l ko kp">except <em class="kr">Exception</em> as e:</span><span id="f6a0" class="kk kl hi kg b fi kq kn l ko kp">print(e)</span><span id="b126" class="kk kl hi kg b fi kq kn l ko kp">break</span></pre><p id="5721" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我知道有很多代码，所以让我们一步一步来</p><p id="8046" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们设置了500次点击的限制，所以如果每页有10条新闻，我们将能够提取5000篇文章。如果您对数据很感兴趣，可以使用while true，让它运行几个小时或几天，这取决于路透社在该部分的文章数量</p><pre class="ju jv jw jx fd kf kg kh ki aw kj bi"><span id="e0e3" class="kk kl hi kg b fi km kn l ko kp">loadMoreButton = driver.find_element_by_class_name("control-nav-next")</span></pre><p id="1fa4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们搜索按钮来加载更多的文章</p><pre class="ju jv jw jx fd kf kg kh ki aw kj bi"><span id="c2bd" class="kk kl hi kg b fi km kn l ko kp">time.sleep(3)</span><span id="b91b" class="kk kl hi kg b fi kq kn l ko kp">loadMoreButton.click()</span><span id="5245" class="kk kl hi kg b fi kq kn l ko kp">time.sleep(2)</span></pre><p id="fe21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">睡眠，因为页面需要一些时间来加载和点击它</p><pre class="ju jv jw jx fd kf kg kh ki aw kj bi"><span id="ba26" class="kk kl hi kg b fi km kn l ko kp">news_headlines = driver.find_elements_by_class_name("story-title")</span><span id="2f9c" class="kk kl hi kg b fi kq kn l ko kp">news_dates = driver.find_elements_by_class_name("timestamp")</span></pre><p id="f860" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">点击后，使用类名查找文章</p><pre class="ju jv jw jx fd kf kg kh ki aw kj bi"><span id="6c54" class="kk kl hi kg b fi km kn l ko kp">for headline in news_headlines:</span><span id="5954" class="kk kl hi kg b fi kq kn l ko kp">headlines.append(headline.text)</span><span id="574c" class="kk kl hi kg b fi kq kn l ko kp">print(headline.text)</span><span id="7388" class="kk kl hi kg b fi kq kn l ko kp">for date in news_dates:</span><span id="78d1" class="kk kl hi kg b fi kq kn l ko kp">dates.append(date.text)</span><span id="8bc5" class="kk kl hi kg b fi kq kn l ko kp">print(date.text)</span></pre><p id="2d94" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在迭代标题和日期，并将其添加到列表中</p><p id="f59f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！如果你喜欢这篇文章，我会感谢一些掌声。这是我第一篇关于medium的编程文章，所以我希望得到一些反馈</p></div></div>    
</body>
</html>