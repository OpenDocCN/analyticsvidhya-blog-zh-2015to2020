<html>
<head>
<title>Using Pandas and Excel Interactively</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">交互使用Pandas和Excel</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-pandas-and-excel-interactively-1d7144e7170b?source=collection_archive---------6-----------------------#2020-01-04">https://medium.com/analytics-vidhya/using-pandas-and-excel-interactively-1d7144e7170b?source=collection_archive---------6-----------------------#2020-01-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/d18c7b141bedcfb85b6061b3075828c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TormrLeNadZ6XeJdDHbGCQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">事情并不总是这么复杂</figcaption></figure><div class=""/><h1 id="b0f8" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">总结</strong></h1><p id="0a5b" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这是一个简短的教程，介绍如何使用xlwings库在Python/Pandas和Excel之间切换，只需一行代码，而无需每次都将文件从一个库导出到另一个库。(对于那些想看更详细的例子的人，可以滚动到底部，查看使用代码的完整例子的要点)。</p><p id="196f" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">下面的例子<em class="kv">用Python写了一行代码</em>，用Excel写了几分钟的数据透视表和数据透视图。</p><figure class="kx ky kz la fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kw"><img src="../Images/63acb6c27f26e9d521fc568a72dd8c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*926yXkg9IdIyhyUVP9MlVA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">左:熊猫输出；右图:使用xlwings的Excel数据透视表。</figcaption></figure></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="c99c" class="iu iv hx bd iw ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm jn lm jp jq jr bi translated"><strong class="ak">安装</strong></h1><p id="97ba" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">通过PIP或Anaconda安装xlwings非常简单(<a class="ae ln" href="https://docs.xlwings.org/en/stable/installation.html" rel="noopener ugc nofollow" target="_blank">https://docs.xlwings.org/en/stable/installation.html</a>)。就是这样！</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="8b55" class="iu iv hx bd iw ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm jn lm jp jq jr bi translated"><strong class="ak">背景</strong></h1><p id="ff44" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我一直在学习(并记录)我在学习熊猫方面的进步。当涉及到可用库、处理大数据等时，从Excel Pandas迁移提供了更多的灵活性。然而，当涉及到UI时，使用Juypter查看所有数据会令人沮丧……尤其是当你在争论数据的时候。</p><p id="ee38" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">正如我在我的异步教程(<a class="ae ln" rel="noopener" href="/@tkpca/summary-74789e47d420">https://medium.com/@tkpca/summary-74789e47d420</a>)中提到的，我一直在做一个宠物项目来提取和分析NBA数据。虽然我可以从Kaggle数据集中提取一些更清晰的数据，但现实生活中的数据是混乱的，而且，学习端到端工作流对我来说很重要，但会产生两个问题:</p><p id="8a6a" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">1)我在争论这些数据时会犯错误，特别是因为NBA API上没有正式的文档；和</p><p id="16b7" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">2)不幸的是，NBA API并不完美(主要针对旧数据)。例如，我发现在1985年之前的一些得分中，进攻和防守篮板都没有被正确记录。在这里看一下https://stats.nba.com/game/0028400895/拉里·史密斯的数据。</p><h1 id="7c9e" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">言归正传</strong></h1><p id="c79c" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">现在你可以拿起你的数据框架，把它作为一个Excel文件，打开/分析/重复，然而，在许多情况下，这是矫枉过正，在我看来，太多的点击。</p><figure class="kx ky kz la fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lo"><img src="../Images/3e9e7eaae72953ca57ef58f492807be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JzH0fILOB0L0Vy3ANu6-sQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">熊猫+ Excel过滤器，排序和其他一切！</figcaption></figure></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="049b" class="iu iv hx bd iw ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm jn lm jp jq jr bi translated"><strong class="ak">以下是基本步骤</strong></h1><p id="dccc" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">1)确保您已经导入了xlwings库；</p><blockquote class="lp lq lr"><p id="5fe6" class="js jt kv ju b jv kq jx jy jz kr kb kc ls ks kf kg lt kt kj kk lu ku kn ko kp hb bi translated">设置Excel的实例。一般来说，我使用行“<strong class="ju hy"><em class="hx">”app = xw。App() </em> </strong>来加载Excel的一个实例(注意“xw”是导入xlwings时的as)。</p></blockquote><p id="84a7" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">2)确保内存中有要推入的数据帧。</p><p id="e779" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">3)将数据框压入空白Excel工作簿中的单元格。</p><blockquote class="lp lq lr"><p id="2192" class="js jt kv ju b jv kq jx jy jz kr kb kc ls ks kf kg lt kt kj kk lu ku kn ko kp hb bi translated"><strong class="ju hy"> <em class="hx"> xw。范围(' A1 ')。值=df。</em> </strong>。</p></blockquote><h1 id="6c53" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak"> <em class="lv">就是这样，大功告成！</em> </strong></h1><p id="ee23" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">请记住，如果您有一个非常大的数据框架，这将是缓慢的(可能不是最好的想法)，但当您想要迭代一个更大的数据框架的片段或快速创建Excel图表时，这是非常好的。该库可以做更多的事情，包括用Python替换VBA，但这是另一篇文章了。</p><figure class="kx ky kz la fd hk"><div class="bz dy l di"><div class="lw lx l"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae ln" href="https://github.com/tkpca/Python-Scripts/tree/master/xlwings" rel="noopener ugc nofollow" target="_blank">https://github.com/tkpca/Python-Scripts/tree/master/xlwings</a></figcaption></figure></div></div>    
</body>
</html>