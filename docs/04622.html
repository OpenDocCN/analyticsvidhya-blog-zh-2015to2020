<html>
<head>
<title>Predicting mortgage approvals: Data analysis and prediction with Azure ML Studio(Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测抵押贷款批准:使用Azure ML Studio进行数据分析和预测(第2部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-mortgage-approvals-data-analysis-and-prediction-with-azure-ml-studio-part-2-2c190e83c9f4?source=collection_archive---------13-----------------------#2020-03-26">https://medium.com/analytics-vidhya/predicting-mortgage-approvals-data-analysis-and-prediction-with-azure-ml-studio-part-2-2c190e83c9f4?source=collection_archive---------13-----------------------#2020-03-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c4ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">这是“预测抵押贷款批准”的第2部分。在这里可以链接到</em> <a class="ae je" rel="noopener" href="/@edumunozsala/predicting-mortgage-approvals-data-analysis-and-prediction-with-azure-ml-studio-part-1-8629d2f938a8"> <em class="jd"> part 1 </em> </a> <em class="jd">。</em></p><h1 id="b0ab" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">Azure Machine Learning Studio中机器学习模型的描述</h1><p id="f68b" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">下一点是开发一个预测模型，使我们能够以可接受的信心程度决定何时接受或不接受贷款请求或申请。这是一个两类分类问题，接受还是不接受。我们将尝试从一个简单的方法开始定义一个模型。然后，该模型将被改进，但尽可能避免增加复杂性。</p><p id="c15a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分析完成后，我们可以做出一些决定:</p><ul class=""><li id="958d" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated">众所周知，Row_id变量应该被丢弃，因为它不提供任何值或信息</li><li id="641b" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">应该删除贷款类型和准确性这两个分类变量</li><li id="0007" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">变量loan_property和approval似乎没有提供太多的价值，尽管它们不是完全可支配的</li><li id="9ffc" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">可变贷方有许多值或类别过高，因此将被其接受比率级别所取代。</li><li id="8a4c" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">关于与申请人的种族、民族和性别相关的变量，其中一些不具有预测性，应被丢弃，如民族或性别。</li><li id="748e" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">前几节提到的一些数字变量似乎是不错的选择:贷款金额、申请人收入、少数民族人口百分比、申请人收入或ffiec中值家庭收入</li><li id="331b" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">关于与申请人所在地相关的3个变量，我们将只包括州，但将分析其他组合。</li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es kw"><img src="../Images/88826c84dea2522762432d2965f7940a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*538JDWmTQbeN6x-Unrgo6Q.jpeg"/></div><figcaption class="le lf et er es lg lh bd b be z dx translated">照片由<a class="ae je" href="https://pixabay.com/es/users/skitterphoto-324082/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=384596" rel="noopener ugc nofollow" target="_blank">鲁迪和</a>彼得·斯皮特林在<a class="ae je" href="https://pixabay.com/es/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=384596" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄</figcaption></figure><h2 id="ba08" class="li jg hi bd jh lj lk ll jl lm ln lo jp iq lp lq jt iu lr ls jx iy lt lu kb lv bi translated">可变贷方的处理</h2><p id="51ab" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">正如人们所期望的，变量lender在模型中有一个重要的值，但它呈现了大量的值，这些值变成了非常高的类别，这可能是过度拟合的来源。为了解决这个问题，我们建议将这个变量转换成一个新的变量，定义贷款人接受率的范围。因此，对于每个贷方，我们将计算其接受率，即接受的申请数除以该贷方处理的申请总数</p><p id="d313" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦计算出这些值，我们将把贷款人分组，范围为接受率的0-20%，21-40%，...通过这种方式，我们将变量的类别数量减少到只有5或6个值，并且还提供了一些关于贷方批准贷款的便利性的有用信息。</p><h2 id="51db" class="li jg hi bd jh lj lk ll jl lm ln lo jp iq lp lq jt iu lr ls jx iy lt lu kb lv bi translated">处理位置变量</h2><p id="069e" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">我们指的是变量state、county和msa md(大都市统计区或大都市分区)，它们都定义了申请人的位置。对于所有这些特征，值的数量非常大。我们还有很多记录，其中一个或多个变量取值为-1，表示其实际值未知或尚未注册，也就是说，它们是缺失值。</p><p id="f7ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以说:</p><ul class=""><li id="7da2" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated">对于state字段，我们有从0到52的值，但是缺少值51。这可能导致我们认为该变量中的值-1实际上是值51。</li><li id="9556" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">对于msa_md字段，同样的事情发生了，我们有从0到408的值，但是没有值为338的记录，同样，它可能是取值为-1的记录的真实值。</li><li id="477a" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">在county的情况下，我们有几个从未出现过的值85，...所以你不能像前面提到的那样简化</li></ul><p id="b4cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，最初的方法是仅考虑变量状态作为预测模型的一部分，根据我们模型的结果，我们将考虑包括msa md字段。</p><h2 id="5a57" class="li jg hi bd jh lj lk ll jl lm ln lo jp iq lp lq jt iu lr ls jx iy lt lu kb lv bi translated">处理异常值、数据错误和缺失值</h2><p id="0eac" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">同样，我们在数据中的多个数值变量中有空值，这可能会降低我们将要开发的模型的性能。大约有70，000-80，000条记录有缺失值，而且它们同时出现在几个变量中。为了解决这个问题，我们将尝试填充这些变量的空值，根据同一个注册表的其他变量寻找与之对应的值:</p><ul class=""><li id="0e71" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated">申请人收入:我们将把属于同一个州、县、msa_md、种族、民族和性别的记录的中值作为空值的记录。如果不存在，我们将根据州、县、msa md、种族和民族等搜索该中值。最后，如果不存在中间值，我们将采用该变量的平均值作为记录的状态。</li><li id="a630" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">少数民族人口百分比:在这种情况下，当发现具有空值的记录时，我们将搜索相同州、县或msa_md的记录的中值。如果它不存在，将搜索相同州和县的中值，或最终搜索相同州的记录。</li><li id="716e" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">对于其余变量，将使用变量少数民族人口百分比中使用的方法</li></ul><p id="c6ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于异常值或可能的数据错误，我们有一些受到严重影响的变量，如贷款额、申请人收入、ffiec家庭收入中位数等。对于最终包含在预测模型中的变量，我们将采用两种方法:</p><ul class=""><li id="10d7" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated">那些值高于感知器98的记录将从训练过程中去除</li><li id="fd2b" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">那些值高于IQR * 1.5的记录将被IQR * 1.5定义的限制值所取代</li></ul></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es md"><img src="../Images/6fbfc86cdf67f12ceb56862a83bd92fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*897ot4osCKrdYPls8e2xiQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated"><a class="ae je" href="https://docs.microsoft.com/en-us/archive/blogs/azureedu/how-can-i-get-started-with-azure-machine-learning" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/archive/blogs/azure edu/how-can-I-get-started-with-azure-machine-learning</a></figcaption></figure><h1 id="6bb8" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">建立我们的预测模型</h1><p id="3c0f" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">为了构建我们的模型，我们将使用Azure Machine Learning Studio云工具和一些Python脚本来应用数据转换和操作。而且我们会分一组阶段来做:训练数据准备、训练的预测模型设计、测试数据准备以及在测试数据上给模型打分。</p><h2 id="b6fc" class="li jg hi bd jh lj lk ll jl lm ln lo jp iq lp lq jt iu lr ls jx iy lt lu kb lv bi translated">数据准备</h2><p id="6e6a" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">在这一阶段，我们设计了Azure ML实验，其中每个数据列都根据之前定义的转换进行转换:</p><ul class=""><li id="0e86" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated">在接受比率级别转换贷方变量</li><li id="11db" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">填充数值变量的缺失值</li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mi"><img src="../Images/9e4b625bfa8d211deb8790b12a40f9d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*toq39wtsvoywq-NaB6fzZA.jpeg"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">用于数据准备的多个python脚本(图片由作者提供)</figcaption></figure><p id="a667" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，这个实验产生了一个数据集，它将用于训练我们的模型和其他一些数据集，以便对测试数据应用相同的转换。</p><h2 id="f5f5" class="li jg hi bd jh lj lk ll jl lm ln lo jp iq lp lq jt iu lr ls jx iy lt lu kb lv bi translated">构建我们的模型</h2><p id="924b" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">我们的下一个实验将接收转换后的数据集进行训练，并应用两类分类算法来获得对测试数据进行评分的模型。最后，我们尝试了主要的分类算法:逻辑回归、决策树(和变体)和神经网络。我们用相同的数据和多个参数评估了每个算法，我们的最佳选择是增强决策树算法。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mj"><img src="../Images/170f961b0c9a7c6226d133f2fca78423.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmqBswUbDlgF49PX1M2M-Q.jpeg"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">我们模型的Azure ML Studio组件(作者提供照片)</figcaption></figure><p id="12e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们执行了以下步骤:</p><ul class=""><li id="20f2" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated">剪切高于某个阈值或百分点的值，以处理异常值</li><li id="df96" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">删除一些缺少值的记录</li><li id="a0ed" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">某些变量(贷款金额、申请人收入、ffiecmedian家庭收入和人口)的Zscore标准化</li><li id="7166" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">少数民族_人口_百分比和地域_至_ msa _ md _收入_百分比的最小最大标准化</li><li id="79df" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">为贷款目的、水平、申请人种族等制定分类变量…</li><li id="6a66" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">选择要在培训过程中使用的列</li><li id="8192" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">在训练集和测试集中拆分数据集:75%-25%</li><li id="6958" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">训练增强的决策树</li><li id="1562" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">对结果进行评分和评估</li></ul><p id="7ae1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过多次实验，选择的列为:贷款_金额、贷款_用途、申请人_收入、申请人_种族、州、少数民族人口pct、tracto _ to _ msa _ md _收入_pct、ffiecmedian _家庭_收入、种族和贷款人接受比率水平。</p><p id="a1cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">培训结果是:</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mk"><img src="../Images/af12d4b3529dde70d3e8dc3d8c26905c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L3IxNldVefy3DFNqon3j-w.jpeg"/></div></div></figure><h2 id="f043" class="li jg hi bd jh lj lk ll jl lm ln lo jp iq lp lq jt iu lr ls jx iy lt lu kb lv bi translated">准备测试数据</h2><p id="8107" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">现在，我们需要对我们的测试数据集应用与我们之前看到的应用于训练数据的相同(或相似)的转换:转换贷方变量，填充一些数字变量(applicant_income，minority_population_pct，ffiecmedian，trac_to_msa_md)的缺失值。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es ml"><img src="../Images/e94bb017f48322a335f2cd27d773037b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phhKMKamAzz4gD8twRAfwg.jpeg"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">作者照片</figcaption></figure><p id="b6b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一过程的结果是一个准备用于我们预测模型的新数据集。</p><h2 id="6687" class="li jg hi bd jh lj lk ll jl lm ln lo jp iq lp lq jt iu lr ls jx iy lt lu kb lv bi translated">在测试数据集上对模型进行评分</h2><p id="8720" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">最后，我们可以将我们的模型应用于测试数据，并对每条记录进行评分，以确定是否接受。这个实验是:</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="er es mm"><img src="../Images/6bffe1abec8a44abbab588cf8f9634c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v6W0iGBRznanehODKLmG4g.jpeg"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">作者照片</figcaption></figure><h1 id="4fc3" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">结论</h1><p id="aae5" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">经过长时间的分析和建立模型，我们可以得出结论，数据准备是获得可接受的性能的最有力的工具。关于数据分析，我们还提到了许多想法:申请人的种族或民族是相关的，高收入的申请人以及居住在少数民族人口比例低的地区的申请人更有可能被贷款接受，大多数申请都与同一类型的财产和贷款有关</p></div></div>    
</body>
</html>