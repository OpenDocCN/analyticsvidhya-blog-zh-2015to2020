<html>
<head>
<title>Beginner to Advance — Web Scraping Guide in Python : Introductory guide to Scrap AZLyrics.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初级到高级Python中的Web抓取指南:Scrap AZLyrics入门指南。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/beginner-to-advance-web-scraping-guide-in-python-799ffd367067?source=collection_archive---------10-----------------------#2020-06-11">https://medium.com/analytics-vidhya/beginner-to-advance-web-scraping-guide-in-python-799ffd367067?source=collection_archive---------10-----------------------#2020-06-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/6d0117a7731f52341c5e8b937edb9df3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jh6uoU-FqnEZlVdm"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">照片由<a class="ae hv" href="https://unsplash.com/@vidarnm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">维达尔·诺德里-马西森</a>在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><div class=""/><h1 id="4ca8" class="iv iw hy bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">介绍</h1><p id="0ad4" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">网上有成千上万吨的信息。它的增长已经超出了最大胆的预测。而要想与时俱进，就需要比别人更快的处理信息。</p><p id="6e99" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在过去的几年里，开发了几个大型项目，涉及到刮擦和数据处理。它们是为完全不同的行业开发的，我们的方法也是为所有这些行业找到最佳解决方案。</p><h1 id="f24c" class="iv iw hy bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">我们将学习的主要工具:</strong></h1><ul class=""><li id="6f96" class="kw kx hy jv b jw jx ka kb ke ky ki kz km la kq lb lc ld le bi translated">Python (3.5)</li><li id="41e3" class="kw kx hy jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated"><a class="ae hv" href="https://pypi.org/project/beautifulsoup4/" rel="noopener ugc nofollow" target="_blank"><em class="lk">beautiful soup</em></a><em class="lk"/>库，用于处理从网页源代码(HTML和CSS)中提取的文本</li><li id="8d51" class="kw kx hy jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated"><a class="ae hv" href="https://pypi.org/project/requests/" rel="noopener ugc nofollow" target="_blank"> <em class="lk">请求</em> </a> <em class="lk"> </em>库用于处理与网页的交互(使用HTTP请求)</li><li id="6eec" class="kw kx hy jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">API调用——丰富我们的数据</li><li id="d72a" class="kw kx hy jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">代理和用户代理轮换—生成随机标头以绕过安全性</li></ul><h1 id="35c6" class="iv iw hy bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">教程1 —初学者教程</h1><p id="9de9" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">请随意选择你喜欢的网站。但是对于这个项目，我们选择了这个网站。<strong class="jv hz"> <em class="lk">注意——本教程仅用于教育目的，我不建议将本网站用于任何非法活动</em> </strong> <em class="lk"> </em>。首先看看我们在刮什么。</p><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ll"><img src="../Images/d3b55fd8090a62da9630b43c89d558e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jmb-_qnWlbJE-UISyWWZUg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://www.azlyrics.com/" rel="noopener ugc nofollow" target="_blank">https://www.azlyrics.com/</a></figcaption></figure><p id="584a" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">AZLyrics提供了简单的歌词功能，可以搜索歌曲并获得歌手演唱的所有歌曲的列表。这是一个简单的网站，不需要任何帐户或验证来获得歌词。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h2 id="1bc8" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">设置环境</h2><p id="f1bb" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">假设你已经安装了<a class="ae hv" href="https://docs.python.org/3/tutorial/venv.html" rel="noopener ugc nofollow" target="_blank"> venv </a>，但是如果你还没有，你可以通过<a class="ae hv" href="https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/#installing-virtualenv" rel="noopener ugc nofollow" target="_blank">链接</a>找到如何在你的系统中安装venv。如果你不熟悉这个概念，你可以查看这个<a class="ae hv" href="https://www.geeksforgeeks.org/python-virtual-environment/" rel="noopener ugc nofollow" target="_blank">链接</a>。现在创建一个新的文件夹，比如说<code class="du ml mm mn mo b">python-azlyrics_scrapper</code>，并在里面创建venv。这将使env目录位于主目录中</p><pre class="lm ln lo lp fd mp mo mq mr aw ms bi"><span id="7865" class="lx iw hy mo b fi mt mu l mv mw">python3 -m venv env</span></pre><p id="9032" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">要激活Python环境，使用代码<code class="du ml mm mn mo b">source env/bin/activate.</code> <br/>你还需要在你的开发环境中使用Pip安装各种依赖项，包括requests、BeautifulSoup、Pandas、Regex。</p><pre class="lm ln lo lp fd mp mo mq mr aw ms bi"><span id="3a5c" class="lx iw hy mo b fi mt mu l mv mw">pip3 install requests regex pandas beautifulsoup4</span></pre></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h2 id="3292" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">构建简单的URL提取函数来提取歌词</h2><p id="73ad" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">创建新文件并另存为print_lyrics.py。要编写代码，您可以使用任何开发IDE。<br/>我更喜欢使用Sublime Text或Atom，但您也可以使用自己选择的IDE。现在我们可以从在我们创建的文件中导入库开始</p><pre class="lm ln lo lp fd mp mo mq mr aw ms bi"><span id="c032" class="lx iw hy mo b fi mt mu l mv mw">import requests <br/>from bs4 import BeautifulSoup</span></pre><p id="3419" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">现在要删除一个网页，你必须了解一些HTML的基础知识。如果您通过按F12打开开发者工具或检查元素，您可以检查您想要从中提取数据的<div>的类。</div></p><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mx"><img src="../Images/32b95257e7f26382f91a9f91a45543f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mi0R-BkmCXio9jKpmLQuxw.jpeg"/></div></div></figure><p id="92af" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在这里你可以看到类“lyricsh”中有歌手的名字，类“div-share”中有歌曲的名字。</p><pre class="lm ln lo lp fd mp mo mq mr aw ms bi"><span id="869a" class="lx iw hy mo b fi mt mu l mv mw">&lt;div class="div-share"&gt;&lt;h1&gt;"I Cry" lyrics&lt;/h1&gt;&lt;/div&gt;<br/><br/>&lt;div class="lyricsh"&gt;<br/>&lt;h2&gt;&lt;b&gt;Shayne Ward Lyrics&lt;/b&gt;&lt;/h2&gt;<br/>&lt;/div&gt;</span></pre><p id="4b95" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">因此，要从服务器获取页面，我们必须使用请求库，使用网页的URL从互联网获取网页。如果您有一些问题，您可以访问此<a class="ae hv" href="https://www.pythonforbeginners.com/requests/using-requests-in-python/" rel="noopener ugc nofollow" target="_blank">链接</a>以更好地理解<a class="ae hv" href="https://2.python-requests.org/en/master/" rel="noopener ugc nofollow" target="_blank">请求库</a>。</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="my mz l"/></div></figure><p id="ad2e" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在上面的代码中，我们通过请求库请求URL，然后保存结果作为响应。要运行该文件，您可以使用以下命令</p><pre class="lm ln lo lp fd mp mo mq mr aw ms bi"><span id="4c1c" class="lx iw hy mo b fi mt mu l mv mw">python3 print_lyrics.py</span></pre><p id="fc3a" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">现在，为了从响应中提取细节，我们必须使用BeautifulSoup库来解析html页面，这可以使用命令<br/> <code class="du ml mm mn mo b">BeautifulSoup(response.text , 'html.parser')</code>从响应中获取HTML解析文本来完成。从网页中解析不同的部分可能会有点混乱，但是通过<a class="ae hv" href="https://www.dataquest.io/blog/web-scraping-tutorial-python/" rel="noopener ugc nofollow" target="_blank">小练习</a>你可以很容易地从网页中获得想要的细节。</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="my mz l"/></div></figure><ul class=""><li id="3afa" class="kw kx hy jv b jw kr ka ks ke na ki nb km nc kq lb lc ld le bi translated">歌手名字在<div>里面，带有‘lyric sh’</div></li><li id="dc3c" class="kw kx hy jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">歌曲和歌词没有唯一的类别，你可以使用find_all函数来查找所有的<div>并获取特定的索引以获得详细信息。<br/>我使用了Hit和Trial来获得上述结果，但也可以随意使用上述函数或获得独特的更简单的方法。</div></li><li id="251c" class="kw kx hy jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">你可以改变其他人的网址，但网页和歌词的一般结构保持不变。</li></ul><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mx"><img src="../Images/d3ddb5ef758a31b3d8a2ff43c9e04d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wcg53yxjw8FFZws_ID_aYQ.png"/></div></div></figure><p id="3bc9" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">该文件的输出将是终端中的歌手姓名、歌曲名称和歌词。</p><h2 id="593e" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">保存响应</h2><p id="2489" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">为了将这个输出保存到磁盘，我将使用JSON来转储数据，但是您也可以使用CSV或text。使用SQL将数据保存到磁盘可能是过度的，除非你打算废弃和管理数百万的歌词数据集。<br/>对于几千首歌词来说，JSON或CSV会很好用。完整的代码现在看起来会像</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="my mz l"/></div></figure><p id="4cde" class="pw-post-body-paragraph jt ju hy jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这将创建文件'数据. json '在同一目录下的歌手和歌词的歌曲。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><blockquote class="nd ne nf"><p id="8e16" class="jt ju lk jv b jw kr jy jz ka ks kc kd ng kt kg kh nh ku kk kl ni kv ko kp kq hb bi translated"><strong class="jv hz">您已经成功创建了您的第一个网络剪贴簿。<br/>干得好…！！！</strong></p></blockquote><h1 id="a8d1" class="iv iw hy bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">从这里继续前进。</h1><h2 id="2980" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">教程1 —简介</h2><p id="7376" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在<a class="ae hv" rel="noopener" href="/@kaus.pathak_30409/beginner-to-advance-web-scraping-guide-in-python-799ffd367067">之前的教程</a>中，我们了解了网页抓取的基本概念，并创建了一个简单的函数，使用requests和BeautifulSoup从页面中提取歌词。</p><h2 id="8c44" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">教程2 —使用Python中的头池和代理循环请求。</h2><p id="5c33" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">为了创建一个更大的项目，可以从互联网上删除成千上万的页面，你需要一个更清晰的工作环境，使用面向对象和继承的概念。你还需要有更详细的关于头文件池和代理池的知识来保持对服务器的匿名，我们已经在本教程的第二部分中讨论过了。</p><h2 id="8c1b" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">教程3 —工作环境和异步I/O编程</h2><p id="b3b7" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们将进行异步I/O编程来提高你的报废速度，这将在本教程的第三部分中介绍。</p><h2 id="553d" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">教程4 —自动化站点抓取</h2><p id="391a" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">有了之前教程中学习的所有概念，我们将在本教程的第四部分中创建实际的自动抓取器来下载和保存网页上的歌词。</p><h2 id="2583" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">教程5 — API访问</h2><p id="2942" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">为了方便地从互联网上访问歌词，我们将创建Flask API和前端来访问我们在本教程第五部分中废弃的歌词。</p><h2 id="5510" class="lx iw hy bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">教程6 —在Heroku上托管我们的Flask服务器</h2><p id="3cf9" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">为了提供容易的歌词访问，在本教程的第六部分，我们将在Heroku上托管我们的Flask服务器。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nj"><img src="../Images/133bbd8efd6d6b49ddfe99be064c5a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IDGmnmHe_Wj78xcP"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">由<a class="ae hv" href="https://unsplash.com/@peet818?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">皮特·佩德罗萨</a>在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="b1c0" class="iv iw hy bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">最后的话</h1><p id="2b8d" class="pw-post-body-paragraph jt ju hy jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">感谢你阅读这篇文章，我们希望听到你的反馈。请随意评论任何问题。如果你喜欢，请为我们鼓掌:)。关注我们，获取我们的最新文章。</p></div></div>    
</body>
</html>