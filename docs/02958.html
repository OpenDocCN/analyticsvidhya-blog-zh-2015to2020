<html>
<head>
<title>Learn to Code in TensorFlow2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在TensorFlow2中学习编码</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/learn-to-code-in-tensorflow2-fe735ad46826?source=collection_archive---------18-----------------------#2020-01-09">https://medium.com/analytics-vidhya/learn-to-code-in-tensorflow2-fe735ad46826?source=collection_archive---------18-----------------------#2020-01-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3465effb861361af83307e8adecb9f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dl6GLvDip8VaUZiTcIl0QA.jpeg"/></div></div></figure><p id="58e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这篇文章对于在TensorFlow2中遇到困难的初学者很有用。假设你知道编写和训练一个基本的深度模型。<a class="ae jo" href="https://colab.research.google.com/notebooks/welcome.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="jp">Google Colab</em></strong></a>推荐这些学习实验。</p><p id="0efb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们已经在keras和TensorFlow2中为CIFAR10数据集训练了ResNet18模型，以在尽可能少的时期内实现90%的准确性。</p><p id="cd7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://github.com/divyanshuraj6815/eva/tree/master/Experiment%2013" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">源代码</strong> </a></p><p id="d983" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们有一个keras代码(参见源代码链接),我们将尝试把它转换成TensorFlow2代码，一步一步来。请注意，这个练习只是为了更好地使用TensorFlow2，而不是为了获得更高的精度。</p><h1 id="8ccd" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">内容:</strong></h1><p id="03ee" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated"><strong class="is hj">这是3部分系列的第1部分。</strong></p><blockquote class="kt ku kv"><p id="b99d" class="iq ir jp is b it iu iv iw ix iy iz ja kw jc jd je kx jg jh ji ky jk jl jm jn hb bi translated"><strong class="is hj">第一部分</strong>:</p></blockquote><ol class=""><li id="3982" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">安装tensorflow2</li><li id="7b9f" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">什么是急切执行？</li><li id="e02d" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">数据加载(CIFAR10)</li><li id="1e35" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">定制数据扩充技术和可视化</li></ol><blockquote class="kt ku kv"><p id="3a75" class="iq ir jp is b it iu iv iw ix iy iz ja kw jc jd je kx jg jh ji ky jk jl jm jn hb bi translated"><a class="ae jo" rel="noopener" href="/p/b1c448abbf1e/"> <strong class="is hj">第二部</strong></a>:<a class="ae jo" rel="noopener" href="/@divyanshuraj.6815/learn-to-code-in-tensorflow2-part2-b1c448abbf1e">https://medium.com/p/b1c448abbf1e</a></p></blockquote><ol class=""><li id="38a5" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">定义自定义模型(ResNet18)</li><li id="cd3c" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">使用张量板查看已定义模型的图形</li></ol><blockquote class="kt ku kv"><p id="7525" class="iq ir jp is b it iu iv iw ix iy iz ja kw jc jd je kx jg jh ji ky jk jl jm jn hb bi translated"><a class="ae jo" rel="noopener" href="/p/7664926b9e69"> <strong class="is hj">第三部</strong></a>:<a class="ae jo" rel="noopener" href="/@divyanshuraj.6815/learn-to-code-in-tensorflow2-part3-7664926b9e69">https://medium.com/p/7664926b9e69</a></p></blockquote><ol class=""><li id="fbf6" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">对梯度胶带的简单了解</li><li id="ab60" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">使用自定义循环训练</li></ol><h1 id="3780" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">安装张量流2 </strong></h1><p id="d480" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">我们将卸载现有的TensorFlow，安装TensorFlow 2.0 (GPU版)。CPU版本也有。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="fa48" class="lw jr hi ls b fi lx ly l lz ma">!pip uninstall tensorflow<br/>!pip install tensorflow-gpu==2.0.0-alpha0</span></pre><p id="f3b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">检查版本。应该是<strong class="is hj"> <em class="jp"> 2.0.0-alpha0 </em> </strong></p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="dc58" class="lw jr hi ls b fi lx ly l lz ma">import tensorflow as tf<br/>print (tf.__version__)</span></pre><h1 id="2704" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">什么是急切执行？</h1><p id="fa89" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated"><strong class="is hj">急切执行</strong>:简而言之，由于急切执行，我们在这里看到的简单代码是可能的。传统的TensorFlow创建了一个图表，我们需要运行会话来做一些事情。在keras中，我们也编译模型，然后开始训练。但是如果有渴望，我们就不需要做这样的事情。</p><p id="b448" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它为不灵活的图形系统提供了一种替代方案，我们可以简单地用tf.enable_eager_execution()开始我们的文件，然后在创建张量时实际打印出它们的值，而不必创建会话。</p><p id="d3cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">一些博客详细解释了</strong>:</p><ul class=""><li id="1a45" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn mb lf lg lh bi translated"><a class="ae jo" rel="noopener" href="/coinmonks/8-things-to-do-differently-in-tensorflows-eager-execution-mode-47cf429aa3ad">https://medium . com/coin monks/8-things-to-do-differently-in-tensor flow-eager-execution-mode-47cf 429 aa3 ad</a></li><li id="817c" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn mb lf lg lh bi translated"><a class="ae jo" rel="noopener" href="/@lsgrep/tensorflow-1-0-vs-2-0-part-2-eager-execution-and-autograph-47473ed8b817">https://medium . com/@ lsgrep/tensor flow-1-0-vs-2-0-part-2-eager-execution-and-signature-47473 ed8b 817</a></li></ul><p id="f7a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">默认为tensorflow2启用。</strong></p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="995f" class="lw jr hi ls b fi lx ly l lz ma">tf.executing_eagerly()<br/>&gt;&gt;&gt; True</span></pre><h1 id="7ad1" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">数据加载(CIFAR10)</h1><p id="a28a" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">数据加载非常简单。这和我们在keras中装载的方式是一样的。您可以提及数据集名称并加载它:</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="3276" class="lw jr hi ls b fi lx ly l lz ma">(x_train, y_train), (x_test, y_test) = tf.keras.datasets.cifar10.load_data ()<br/>len_train, len_test = len (x_train), len (x_test)<br/>y_train = y_train.astype ('int64').reshape (len_train)<br/>y_test = y_test.astype ('int64').reshape (len_test)</span></pre><h1 id="b98e" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">定制数据扩充技术和可视化</h1><p id="e720" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">由于数据集有限，我们使用数据扩充技术给出同一图像的不同变体，以便模型可以更好地概括。使用的技术:</p><ol class=""><li id="a9b9" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">使图像正常化。</li><li id="17ff" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">以50%的概率随机水平翻转图像。</li><li id="143f" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">将图像每边填充4个像素，使其为40x40，然后随机裁剪32x32，使物体的位置不确定。</li><li id="cbcf" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">从图像中随机截取一部分(即在图像上用图像的平均值放一个正方形小块)。</li></ol><p id="466d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，这种增强的组合确保了有足够的图像变化，并且模型可以更好地概括。下面的例子说明了同样的情况:</p><div class="ln lo lp lq fd ab cb"><figure class="mc ij md me mf mg mh paragraph-image"><img src="../Images/cf387d0b9d610d6990f3ce3ce3d64c16.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/1*be4IOpwvO20PMBc-RhbjcA.gif"/></figure><figure class="mc ij md me mf mg mh paragraph-image"><img src="../Images/b34c8483768063823ebd21a29e959d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*9TIHuxFNHE2427wYX3q2Mg.png"/></figure></div><p id="1801" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用于执行相同操作的代码:</p><figure class="ln lo lp lq fd ij"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="d4a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种增强技术中，原始图像被创建的概率也是存在的(即，即使在应用增强之后，原始的归一化图像也会出现)。怎么会？也许你可以考虑一下！这里还有几个例子。</p><div class="ln lo lp lq fd ab cb"><figure class="mc ij mk me mf mg mh paragraph-image"><img src="../Images/08478e20784eb820f47246179a543420.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*uzpgV796s_w0m_8MCprrow.png"/></figure><figure class="mc ij mk me mf mg mh paragraph-image"><img src="../Images/5fb3a63e52938d03a9b49e68b7143d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*OqR_9wfoXM3DRTjTT-jFVQ.png"/></figure><figure class="mc ij mk me mf mg mh paragraph-image"><img src="../Images/4f33ee191da9e000cd58dec5bb4822a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*7z7iY3xQxejrHIoVftJUiA.png"/></figure></div><div class="ab cb"><figure class="mc ij mk me mf mg mh paragraph-image"><img src="../Images/26096de46644bd19241461ba5e80d9ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/1*WGkf7318G1VzowCX-OO9fA.gif"/></figure><figure class="mc ij mk me mf mg mh paragraph-image"><img src="../Images/5988714058d8213731eff0bc35cc282f.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/1*_o7jua7qt5dLOZfJqR0TfQ.gif"/></figure><figure class="mc ij mk me mf mg mh paragraph-image"><img src="../Images/4afaa6c99a561e9bd136a13e726cf9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/1*_ZT1H9d3kAuUaIy7cmEVtQ.gif"/></figure></div><p id="596f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">我们已经准备好了数据，我们将在下一个</strong> <a class="ae jo" rel="noopener" href="/p/b1c448abbf1e/"> <strong class="is hj">部分</strong> </a> <strong class="is hj">中继续构建ResNet18模型。</strong></p></div></div>    
</body>
</html>