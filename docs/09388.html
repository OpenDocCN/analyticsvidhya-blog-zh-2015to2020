<html>
<head>
<title>BBC micro:bit as a Wireless Sensor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BBC微:比特作为无线传感器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bbc-micro-bit-as-a-wireless-sensor-2624078137a0?source=collection_archive---------9-----------------------#2020-09-04">https://medium.com/analytics-vidhya/bbc-micro-bit-as-a-wireless-sensor-2624078137a0?source=collection_archive---------9-----------------------#2020-09-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="7b3d" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">物联网| BBC微:比特</h2><div class=""/><div class=""><h2 id="86d3" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">使用micro:bit作为无线模数转换器</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es jg"><img src="../Images/dcfedde0a8a0bab008abf15c12c6eea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/0*yw1yEePd_mxLLc94"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">微观:比特特征。<a class="ae js" href="https://microbit.org/get-started/user-guide/overview/" rel="noopener ugc nofollow" target="_blank">https://microbit.org/get-started/user-guide/overview/</a></figcaption></figure><p id="434c" class="pw-post-body-paragraph jt ju hi jv b jw jx is jy jz ka iv kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated">BBC micro:bit是一款廉价的微控制器，有几个输入/输出、按钮，更重要的是还有一个蓝牙收音机。在我的一个Raspberry Pi (RPi)项目中，我需要一个模数转换器(ADC)来读取一些传感器值。有些人可能知道RPi没有任何模拟输入，所以需要一个外部转换器，如MCP3008芯片。</p><p id="c632" class="pw-post-body-paragraph jt ju hi jv b jw jx is jy jz ka iv kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated">我不想为我的RPI使用试验板，所以我看了看我的电子元件箱，找到了BBC micro:bit。好的一面是micro:bit有3个ADC输入，很容易访问，并且由电池或USB供电。我开始考虑如何将micro:bit连接到我的RPi。出于这个原因，我想避免尝试在两者之间建立USB连接或某种有线连接。所以我开始尝试找出一个蓝牙连接。</p><h1 id="c715" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">蓝牙</h1><p id="1325" class="pw-post-body-paragraph jt ju hi jv b jw lh is jy jz li iv kb kc lj ke kf kg lk ki kj kk ll km kn ko hb bi translated">蓝牙非常适合短距离和低带宽连接。因为我只打算在两个组件之间传递几个字节的数据，所以这似乎是正确的选择。现在，我知道蓝牙连接通常会消耗电池，当我试图使用2节AAA电池来运行micro:bit时，我完全预料到了这一点。因此，作为一个警告，我将要描述的工作，但可能不是最有效的电池方法。</p><p id="48c8" class="pw-post-body-paragraph jt ju hi jv b jw jx is jy jz ka iv kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated">有两种主要的蓝牙连接类型，第一种是通用配对模式类型连接，其中蓝牙控制器可以连接到多个设备，但单个设备只能启用一个连接。第二种是无连接方法，有时称为蓝牙LE(低能耗)。在这种模式下，设备会公布一些数据(通常是一个URL ),其他蓝牙设备无需建立连接即可读取这些数据。micro:bit支持广告Eddystone URL。Eddystone是一个Google标准，用于通过Bluetooth LE广告URL。这些信标被企业用作营销和广告媒介。然而，我的目标是使用这种方法通过蓝牙广告传感器数据。</p><h1 id="a441" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">微:位</h1><p id="c4a2" class="pw-post-body-paragraph jt ju hi jv b jw lh is jy jz li iv kb kc lj ke kf kg lk ki kj kk ll km kn ko hb bi translated">微:位有3个方便的引脚P0，P1和P2，支持模拟输入。想象一下，有三个传感器连接到这些输入中的每一个，并需要传输它们的值。每个模拟输入连接到一个10位ADC，这意味着数值范围为0–1023整数(0–3V)。这是我需要的足够的精度，将完美地工作。我也只需要偶尔读取传感器(例如，每5秒)。下面的Javascript代码应该可以实现这一点。您可以将其复制到“MakeCode for micro:bit”编辑器中。确保您启用了蓝牙功能，而不是无线电。</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="f10c" class="pw-post-body-paragraph jt ju hi jv b jw jx is jy jz ka iv kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated">URL格式很简单<code class="du lo lp lq lr b">adc/P0/P1/P2</code>，比如<code class="du lo lp lq lr b">adc/100/250/900</code>。这使得任何程序都可以轻松地读取和解析URL。</p><h1 id="41fe" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">计算机编程语言</h1><p id="e027" class="pw-post-body-paragraph jt ju hi jv b jw lh is jy jz li iv kb kc lj ke kf kg lk ki kj kk ll km kn ko hb bi translated">我将使用Python来读取蓝牙信标和Eddystone URL。读取蓝牙Eddystone URLs需要任何蓝牙库。我选择使用<code class="du lo lp lq lr b">aioblescan</code>，因为它有一个简单的API。</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="cb81" class="pw-post-body-paragraph jt ju hi jv b jw jx is jy jz ka iv kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated"><code class="du lo lp lq lr b">my_process</code>函数是读取和解析Eddystone URL的关键。<code class="du lo lp lq lr b">asyncio</code>只是用来循环运行这个，定期扫描蓝牙。虽然这段代码会连续打印这些值，但是请记住，我们的micro:bit只是每5秒更新一次。输出如下所示:</p><pre class="jh ji jj jk fd ls lr lt lu aw lv bi"><span id="1a6c" class="lw kq hi lr b fi lx ly l lz ma">2020-09-04T12:28:16.348710 - ['876', '254', '247']</span><span id="7d12" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.385642 - ['879', '253', '250']</span><span id="61ce" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.425616 - ['876', '254', '248']</span><span id="8e78" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.462815 - ['876', '253', '250']</span><span id="96e1" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.491648 - ['876', '254', '247']</span><span id="f51e" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.530890 - ['877', '253', '250']</span><span id="8073" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.569894 - ['877', '254', '247']</span><span id="b091" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.605666 - ['876', '253', '250']</span><span id="89d5" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.644787 - ['876', '254', '248']</span><span id="3ff4" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.671624 - ['876', '253', '250']</span><span id="8628" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.714569 - ['876', '254', '247']</span><span id="252b" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.744807 - ['876', '253', '250']</span><span id="e20f" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.779926 - ['876', '254', '248']</span><span id="20c5" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.886823 - ['878', '253', '250']</span><span id="2af8" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.957036 - ['877', '254', '250']</span><span id="3ea5" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:16.989715 - ['876', '254', '247']</span><span id="f353" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:17.029785 - ['876', '253', '250']</span><span id="5efa" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:17.060848 - ['877', '254', '247']</span><span id="d68c" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:17.099637 - ['876', '253', '250']</span><span id="ef9f" class="lw kq hi lr b fi mb ly l lz ma">2020-09-04T12:28:17.135585 - ['876', '254', '248']</span></pre></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="bf1c" class="pw-post-body-paragraph jt ju hi jv b jw jx is jy jz ka iv kb kc kd ke kf kg kh ki kj kk kl km kn ko hb bi translated">这样，我就可以将micro:bit作为多个传感器的无线发射器。这当然让我很满意，因为我以一种创新的方式将micro:bit用作无线传感器。希望这对你有用。</p></div></div>    
</body>
</html>