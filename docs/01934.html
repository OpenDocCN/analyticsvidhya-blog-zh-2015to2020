<html>
<head>
<title>5 Steps : To get an understanding on Co-variance and Correlation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个步骤:了解协变和相关性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/5-steps-to-get-an-understanding-on-co-variance-and-correlation-60c94f19a556?source=collection_archive---------4-----------------------#2019-11-22">https://medium.com/analytics-vidhya/5-steps-to-get-an-understanding-on-co-variance-and-correlation-60c94f19a556?source=collection_archive---------4-----------------------#2019-11-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/32352c0b44fc4e580b0b04fa04028b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R4t_5Xp4NDmE8sYw4ODCyQ.jpeg"/></div></div></figure><p id="1a43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">随着树木数量的减少，全球变暖加剧。</em> </strong>在这个说法中，有2个变量，一个是树木的数量，另一个是全球变暖。它们相互关联，使得它们在统计上相互依赖。为了测量这些统计变量之间的关联，我们需要数学工具。</p><p id="223e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了这个介绍，我在这里写一个小故事，以获得对协变和相关性的理解。</p><h1 id="ca2b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">1.我们开始吧</h1><p id="595c" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">让我从一个简单的问题开始，两个数字5和6有什么相似之处。为了回答这个问题，即使这两个数在数轴上是连续的，我们也必须研究它们的性质。数字5是奇数和质数，而数字6是偶数，因数是2和3。这得出结论，这两个数字彼此不相似。</p><p id="e943" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我在上面的情况上再加2个数字。那么[5，3]和[6，2]有什么相似之处呢。现在它们不仅仅是数字，而是列表。我在讨论中必须考虑的性质是均值、方差和标准差。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="1e76" class="lb jq hi kx b fi lc ld l le lf">import numpy as np</span><span id="c1a9" class="lb jq hi kx b fi lg ld l le lf">x = np.array([5,3])<br/>y = np.array([6,2])</span><span id="b6f8" class="lb jq hi kx b fi lg ld l le lf">print("Mean(x)=",x.mean(), "Mean(y)=",y.mean())<br/>print("Variance(x)=",x.var(), "Variance(y)=",y.var())<br/>print("SD(x)=",x.std(), "SD(y)=",y.std())</span></pre><p id="6cf3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是代码的输出:</p><p id="02a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">均值(x)= 4.0均值(y)= 4.0 <br/>方差(x)= 1.0方差(y)= 4.0 <br/> SD(x)= 1.0 SD(y)= 2.0</p><p id="4fee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些列表中的每一个都具有相同的平均值，即4.0。然而，他们有不同的偏离标准。随着标准差越大，数据越分散。在这种情况下，第二个列表数据比第一个更分散。</p><h1 id="e2f3" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">2.理解线性关系</h1><p id="6a3c" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">等式<strong class="is hj"> y=2x+c </strong>是线性的，x和y变量之间的关系也是线性的。线性关系是指一个变量增加或减少n倍会导致另一个变量相应增加或减少n倍。简单地说，如果你将一个变量加倍，另一个也会加倍。</p><p id="0e4a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">协方差决定了两个变量之间线性关系的方向。所以方向可以是正的，负的和零。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/78ae9492b1406f5efeba7c641efc8b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*fHuiQQ8lieA6e75g-wMd9w.jpeg"/></div></figure><p id="d9df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下面的例子中，有6个数据点，并以表格形式计算协方差。结果是130.2，表明正线性关系。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es li"><img src="../Images/127ef2ddaa2d47b9b606b7a36278b28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*rMkT2t7tLdnY8xJABPXdcg.jpeg"/></div></figure><p id="5684" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下图是上述数据点的散点图。它表明了线性关系及其正方向。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/9c75b4bfc2a65f32da1471b4111837fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*QG_bujqBPnz8dVzBZMLhLg.jpeg"/></div></figure><h1 id="5874" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">3.比较协方差</h1><p id="8634" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">以上面的例子为例，再增加一个特性。让我们计算(x，y)和(x，z)的协方差。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/8b601c9e2dd5e899c69ed60991228bca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VihERINnUebwRpvI557YzA.jpeg"/></div></div></figure><p id="46e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">协方差(x，z) = 5910.8，这是一个比协方差(x，y) = 130.2大得多的值。</p><p id="2124" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是否意味着，两个属性x和z比x和y有更好的线性关系？</p><p id="657d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了回答这个问题，让我列出几点—</p><ul class=""><li id="fbf5" class="ll lm hi is b it iu ix iy jb ln jf lo jj lp jn lq lr ls lt bi translated">协方差是2个单位的乘积，因此，它的单位变成了单位的乘积。(x，y)和(x，z)的协方差有不同的单位。所以两者对比没有意义。这就像比较两个以英里和公里为单位的距离。当然，在比较之前，他们需要一个转换。</li><li id="46e5" class="ll lm hi is b it lu ix lv jb lw jf lx jj ly jn lq lr ls lt bi translated">我们怎样才能把两个单位的产品提高到同样的规模？。我们可以通过将它们除以2个单位的相同乘积，很容易地使它们的单位变小。这可以通过将协方差除以标准差来实现。例如，协方差(x，y)除以sd(x)和sd(y)，如下所示。sd(x)和(xi-x_bar)有相同的单位。sd(y)和(yi-y_bar)具有相同的单位。</li></ul><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/42bb2810b205bda6f0f58571ed8ba18e.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*dy__BWRh1kyHZXphKyjtlQ.jpeg"/></div></figure><p id="7d23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们回到我们的例子，计算x，y和z的标准偏差。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/24d61b346a27622b891dce4df46b316f.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*x9qcN5zZynA0VvYEPmYevA.jpeg"/></div></figure><p id="8cb0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在将(x，y)和(x，z)的协方差除以标准偏差，如下所示。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/2a161d0458959130b7b88acabe48f932.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*8fWN3lkovSB_4zBA_5NE8A.jpeg"/></div></figure><p id="02c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在结果回答了我们之前的问题。属性对(x，y)比属性对(x，z)具有更好的正线性关系。与其说更好，不如说更强。</p><p id="6958" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">将数据集标准化，然后只比较协方差，以了解线性关系的强度和方向，这样如何？。</em></p><p id="dd14" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请评论你的想法。</p><h1 id="b7d4" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">4.相互关系</h1><p id="7807" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在数据科学的大部分时间里，相关系数默认取为皮尔逊积矩相关系数。通常，在统计学中，有四种相关类型:皮尔逊相关、肯德尔秩相关、斯皮尔曼相关和点双列相关。在这个故事中，我们只讨论皮尔逊相关性。</p><p id="7450" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">相关性是协变的标准化形式，用每个变量的标准差除以协变。在上一步中，我们将协方差(x，y)除以sd(x)和sd(y)得到<strong class="is hj">相关系数</strong>。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/8caefd3eabcdedc5e637b29b6a535dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*keEgWVzLC72PukqZk6c7jA.jpeg"/></div></figure><p id="81e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如上所述，相关系数是无单位的，其范围在1至+1之间。它用于发现属性之间的关系有多强。这些公式返回一个介于-1和1之间的值，其中:</p><ul class=""><li id="6900" class="ll lm hi is b it iu ix iy jb ln jf lo jj lp jn lq lr ls lt bi translated">+1表示强正相关。</li><li id="9006" class="ll lm hi is b it lu ix lv jb lw jf lx jj ly jn lq lr ls lt bi translated">-1表示强烈的负面关系。</li><li id="1f68" class="ll lm hi is b it lu ix lv jb lw jf lx jj ly jn lq lr ls lt bi translated">0表示完全没有关系。</li></ul><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/e95fbfe6d8663affb53b470d3db088f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9NkunWkt_jk8oguKcuKcfA.jpeg"/></div></div></figure><p id="8f77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">值为1表示两个变量之间的完美关联程度。随着相关系数值趋向于0，两个变量之间的关系将变弱。</p><h1 id="6828" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">5.Python中相关性的实现</h1><p id="6a4f" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">让我们举几个例子来加深理解。在下面的代码中，我生成两个随机数组并计算相关系数。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="13fc" class="lb jq hi kx b fi lc ld l le lf">import numpy as np<br/>import matplotlib<br/>import matplotlib.pyplot as plt<br/>matplotlib.style.use('ggplot')</span><span id="cf51" class="lb jq hi kx b fi lg ld l le lf">np.random.seed(1)</span><span id="3e6f" class="lb jq hi kx b fi lg ld l le lf">x = np.random.randint(0,50,1000)<br/>y = x + np.random.normal(0,10,1000)</span><span id="46c4" class="lb jq hi kx b fi lg ld l le lf">print(np.corrcoef(x,y))</span><span id="1ea3" class="lb jq hi kx b fi lg ld l le lf">plt.scatter(x, y)<br/>plt.show()</span></pre><p id="8114" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输出显示x和y之间的线性关系更强，并且是正向的。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es me"><img src="../Images/68aee18fbe911b981e86296e0889c027.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*b3GPh40jVYx8tQDke7BGOw.jpeg"/></div></figure><p id="6af4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下面的代码中，我生成了随机数组，一个增加，另一个减少。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="94e8" class="lb jq hi kx b fi lc ld l le lf">import numpy as np<br/>import matplotlib<br/>import matplotlib.pyplot as plt<br/>matplotlib.style.use('ggplot')</span><span id="58a0" class="lb jq hi kx b fi lg ld l le lf">np.random.seed(1)</span><span id="9039" class="lb jq hi kx b fi lg ld l le lf">x = np.random.randint(0, 50, 1000)<br/>y = 100 - x + np.random.normal(0, 5, 1000)</span><span id="7219" class="lb jq hi kx b fi lg ld l le lf">print(np.corrcoef(x,y))</span><span id="e95b" class="lb jq hi kx b fi lg ld l le lf">plt.scatter(x, y)<br/>plt.show()</span></pre><p id="5e9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输出显示x和y之间的线性关系更强，并且是负向的。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/a14236e06a050249156ca06bb53aa785.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*kiRmvGRSMjY_CUGZyVIrug.jpeg"/></div></figure><p id="4f55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下面的代码中，我生成了随机数组，因为两者之间没有线性关系。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="e548" class="lb jq hi kx b fi lc ld l le lf">import numpy as np<br/>import matplotlib<br/>import matplotlib.pyplot as plt<br/>matplotlib.style.use('ggplot')</span><span id="4baf" class="lb jq hi kx b fi lg ld l le lf">np.random.seed(1)</span><span id="811c" class="lb jq hi kx b fi lg ld l le lf">x = np.random.randint(0, 50, 1000)<br/>y = np.random.randint(0, 50, 1000)</span><span id="f8a8" class="lb jq hi kx b fi lg ld l le lf">np.corrcoef(x, y)</span><span id="569b" class="lb jq hi kx b fi lg ld l le lf">print(np.corrcoef(x,y))</span><span id="a047" class="lb jq hi kx b fi lg ld l le lf">plt.scatter(x, y)<br/>plt.show()</span></pre><p id="e879" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输出显示x和y之间没有线性关系。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/e85fbcdb57a24559d3811354da0179ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*lSN07p2J9z2Ii4zvX63RSw.jpeg"/></div></figure><h2 id="b257" class="lb jq hi bd jr mh mi mj jv mk ml mm jz jb mn mo kd jf mp mq kh jj mr ms kl mt bi translated">相关矩阵</h2><p id="ff27" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">相关矩阵是显示变量之间相关系数的表格。相关矩阵用于汇总数据，作为更高级分析的输入，以及作为高级分析的诊断。</p><p id="1da5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们计算上述数据集的相关矩阵，该数据集具有3个属性，即x、y和z。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="83a9" class="lb jq hi kx b fi lc ld l le lf">import pandas as pd<br/>dataframe = pd.DataFrame({'X' : [192, 218, 197, 192, 198, 191],<br/>                          'Y' : [218, 251, 221, 219, 223, 218],<br/>                          'Z' : [6200, 5777, 4888, 4983, 5888, 2000]})<br/>print(dataframe.corr())</span></pre><p id="31c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">相关矩阵打印如下:</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/57cd8f701d7745ba183065cc99a242e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*tKRdWQe-b1fe6FzldIQ-dg.jpeg"/></div></figure><p id="9b70" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还可以绘制相关矩阵如下:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="76f2" class="lb jq hi kx b fi lc ld l le lf">import pandas as pd<br/>dataframe = pd.DataFrame({'X' : [192, 218, 197, 192, 198, 191],<br/>                          'Y' : [218, 251, 221, 219, 223, 218],<br/>                          'Z' : [6200, 5777, 4888, 4983, 5888, 2000]})<br/>plt.matshow(dataframe.corr())<br/>plt.xticks(range(len(dataframe.columns)), dataframe.columns)<br/>plt.yticks(range(len(dataframe.columns)), dataframe.columns)<br/>plt.colorbar()<br/>plt.show()</span></pre><p id="fa5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是输出—</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/088b8788a3905f2b559e94817d2db558.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*wb9BkK4SSj2GIWUyYsTVjw.png"/></div></figure><h1 id="f39a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="103e" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在数据分析中，尤其是在回归分析中，相关性是最有用和最广泛使用的统计概念。相关性只解释了线性关系的强度和方向，并没有解释变量之间的因果关系。它没有解释哪个变量是原因，哪个是结果。<br/>关联提供数据汇总统计，从这里开始了解数据中关系的完整故事。</p><blockquote class="mw"><p id="ef5c" class="mx my hi bd mz na nb nc nd ne nf jn dx translated">如果你喜欢这篇文章，请跟我来鼓励我，不要忘记鼓掌。如果你有任何问题，请在此之前写下评论，祝你学习愉快。</p></blockquote></div></div>    
</body>
</html>