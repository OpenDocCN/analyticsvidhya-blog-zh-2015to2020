<html>
<head>
<title>3 Ways To Copy By Value Any Composite Data Type In JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript 中通过值复制任何复合数据类型的 3 种方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/3-ways-to-copy-by-value-any-composite-data-type-in-javascript-ca3c730e4d2f?source=collection_archive---------7-----------------------#2020-11-04">https://medium.com/analytics-vidhya/3-ways-to-copy-by-value-any-composite-data-type-in-javascript-ca3c730e4d2f?source=collection_archive---------7-----------------------#2020-11-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/1ee50cdce9be7fb29e73d6adca952e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5YuVDKAIBv1RRY8B"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://unsplash.com/@fatosi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Fatos Bytyqi </a>在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><ol class=""><li id="a748" class="iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">使用 spread ( <code class="du jn jo jp jq b">...</code>)语法</li><li id="0205" class="iv iw hy ix b iy jr ja js jc jt je ju jg jv ji jj jk jl jm bi translated">使用<code class="du jn jo jp jq b">Object.assign()</code>方法</li><li id="9b78" class="iv iw hy ix b iy jr ja js jc jt je ju jg jv ji jj jk jl jm bi translated">使用<code class="du jn jo jp jq b">JSON.stringify()</code>和<code class="du jn jo jp jq b">JSON.parse()</code>方法</li></ol><p id="d31b" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">以下说明了如何使用上述三种方法复制对象:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="f9a2" class="kt ku hy jq b fi kv kw l kx ky">const person = {<br/>    firstName: 'John',<br/>    lastName: 'Doe'<br/>};<br/></span><span id="30a7" class="kt ku hy jq b fi kz kw l kx ky"><em class="la">// using spread ...</em><br/>let p1 = {<br/>    ...person<br/>};</span><span id="20f5" class="kt ku hy jq b fi kz kw l kx ky"><em class="la">// using  Object.assign() method</em><br/>let p2 = Object.assign({}, person);</span><span id="1f9b" class="kt ku hy jq b fi kz kw l kx ky"><em class="la">// using JSON</em><br/>let p3 = JSON.parse(JSON.stringify(person));</span></pre><p id="45f2" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">spread ( <code class="du jn jo jp jq b">...</code>)和<code class="du jn jo jp jq b">Object.assign()</code>都执行浅层复制，而 JSON 方法执行深层复制。</p><h1 id="3a20" class="lb ku hy bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">浅层拷贝与深层拷贝</h1><p id="764b" class="pw-post-body-paragraph jw jx hy ix b iy ly jy jz ja lz ka kb jc ma kd ke je mb kg kh jg mc kj kk ji hb bi translated">在 JavaScript 中，使用<a class="ae hv" href="https://www.javascripttutorial.net/javascript-variables/" rel="noopener ugc nofollow" target="_blank">变量</a>来存储可以是<a class="ae hv" href="https://www.javascripttutorial.net/javascript-primitive-vs-reference-values/" rel="noopener ugc nofollow" target="_blank">原语或引用</a>的值。当您复制存储在变量中的值时，您会创建一个具有相同值的新变量。对于原始值，只需使用一个简单的赋值:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="d41e" class="kt ku hy jq b fi kv kw l kx ky">let counter = 1;<br/>let copiedCounter = counter;</span></pre><p id="c3d1" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">当你改变复制变量的值时，原始变量的值保持不变。</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="e818" class="kt ku hy jq b fi kv kw l kx ky">copiedCounter = 2;<br/>console.log(counter);</span></pre><p id="c465" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">输出:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="9098" class="kt ku hy jq b fi kv kw l kx ky">1</span></pre><p id="6679" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">但是，如果对引用值使用赋值运算符，它将不会复制该值。相反，两个变量将引用内存中的同一个对象:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="4fab" class="kt ku hy jq b fi kv kw l kx ky">let person = {<br/>    firstName: 'John',<br/>    lastName: 'Doe'<br/>};<br/>let copiedPerson = person;</span></pre><p id="02f1" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">而当通过新变量(copiedPerson)访问对象并改变它的属性值(name)时，你就改变了对象的属性值。</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="2f0b" class="kt ku hy jq b fi kv kw l kx ky">copiedPerson.firstName = 'Jane';<br/>console.log(person);</span></pre><p id="8d96" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">输出:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="bce8" class="kt ku hy jq b fi kv kw l kx ky">{<br/>    firstName: 'Jane',<br/>    lastName: 'Doe'<br/>}</span></pre><p id="2942" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">深度复制意味着新变量的值与原始变量断开，而浅复制意味着一些值仍然与原始变量相连。</p><h1 id="603d" class="lb ku hy bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">浅层拷贝示例</h1><p id="756c" class="pw-post-body-paragraph jw jx hy ix b iy ly jy jz ja lz ka kb jc ma kd ke je mb kg kh jg mc kj kk ji hb bi translated">考虑下面的例子:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="14d2" class="kt ku hy jq b fi kv kw l kx ky">let person = {<br/>    firstName: 'John',<br/>    lastName: 'Doe',<br/>    address: {<br/>        street: 'North 1st street',<br/>        city: 'San Jose',<br/>        state: 'CA',<br/>        country: 'USA'<br/>    }<br/>};<br/></span><span id="c864" class="kt ku hy jq b fi kz kw l kx ky">let copiedPerson = Object.assign({}, person);</span><span id="4288" class="kt ku hy jq b fi kz kw l kx ky">copiedPerson.firstName = 'Jane'; <em class="la">// disconnected</em></span><span id="aa52" class="kt ku hy jq b fi kz kw l kx ky">copiedPerson.address.street = 'Amphitheatre Parkway'; <em class="la">// connected</em><br/>copiedPerson.address.city = 'Mountain View'; <em class="la">// connected</em></span><span id="9126" class="kt ku hy jq b fi kz kw l kx ky">console.log(copiedPerson);</span></pre><p id="01fc" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">在本例中:</p><ul class=""><li id="62e6" class="iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji md jk jl jm bi translated">首先，创建一个名为<code class="du jn jo jp jq b">person</code>的新对象。</li><li id="e18e" class="iv iw hy ix b iy jr ja js jc jt je ju jg jv ji md jk jl jm bi translated">其次，使用<code class="du jn jo jp jq b">Object.assign()</code>方法克隆<code class="du jn jo jp jq b">person</code>对象。</li><li id="d692" class="iv iw hy ix b iy jr ja js jc jt je ju jg jv ji md jk jl jm bi translated">第三，更改<code class="du jn jo jp jq b">copiedPerson</code>对象的名字和地址信息。</li></ul><p id="1f23" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">以下是输出:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="4786" class="kt ku hy jq b fi kv kw l kx ky">{<br/>    firstName: 'Jane',<br/>    lastName: 'Doe',<br/>    address: {<br/>        street: 'Amphitheatre Parkway',<br/>        city: 'Mountain View',<br/>        state: 'CA',<br/>        country: 'USA'<br/>    }<br/>}</span></pre><p id="c712" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">但是，当您显示 person 对象的值时，您会发现地址信息发生了变化，但名字却发生了变化:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="de36" class="kt ku hy jq b fi kv kw l kx ky">console.log(person);</span></pre><p id="bb1d" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">输出:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="b0eb" class="kt ku hy jq b fi kv kw l kx ky">{<br/>    firstName: 'John',<br/>    lastName: 'Doe',<br/>    address: {<br/>        street: 'Amphitheatre Parkway',<br/>        city: 'Mountain View',<br/>        state: 'CA',<br/>        country: 'USA'<br/>    }<br/>}</span></pre><p id="350b" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">原因是地址是参考值，而名字是原始值。<code class="du jn jo jp jq b">person</code>和<code class="du jn jo jp jq b">copiedPerson</code>引用不同的对象，但这些对象引用相同的<code class="du jn jo jp jq b">address</code>对象。</p><h1 id="16ce" class="lb ku hy bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">深层拷贝示例</h1><p id="af1d" class="pw-post-body-paragraph jw jx hy ix b iy ly jy jz ja lz ka kb jc ma kd ke je mb kg kh jg mc kj kk ji hb bi translated">下面的代码片段用 JSON 方法替换了<code class="du jn jo jp jq b">Object.assign()</code>方法，以携带<code class="du jn jo jp jq b">person</code>对象的深层副本:</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="b98d" class="kt ku hy jq b fi kv kw l kx ky">let person = {<br/>    firstName: 'John',<br/>    lastName: 'Doe',<br/>    address: {<br/>        street: 'North 1st street',<br/>        city: 'San Jose',<br/>        state: 'CA',<br/>        country: 'USA'<br/>    }<br/>};<br/></span><span id="9887" class="kt ku hy jq b fi kz kw l kx ky">let copiedPerson = JSON.parse(JSON.stringify(person));</span><span id="21f0" class="kt ku hy jq b fi kz kw l kx ky">copiedPerson.firstName = 'Jane'; <em class="la">// disconnected</em></span><span id="5eee" class="kt ku hy jq b fi kz kw l kx ky">copiedPerson.address.street = 'Amphitheatre Parkway';<br/>copiedPerson.address.city = 'Mountain View';</span><span id="ec88" class="kt ku hy jq b fi kz kw l kx ky">console.log(person);</span></pre><p id="06fc" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">输出</p><pre class="kl km kn ko fd kp jq kq kr aw ks bi"><span id="05a7" class="kt ku hy jq b fi kv kw l kx ky">{<br/>    firstName: 'John',<br/>    lastName: 'Doe',<br/>    address: {<br/>        street: 'North 1st street',<br/>        city: 'San Jose',<br/>        state: 'CA',<br/>        country: 'USA'<br/>    }<br/>}</span></pre><p id="92ce" class="pw-post-body-paragraph jw jx hy ix b iy iz jy jz ja jb ka kb jc kc kd ke je kf kg kh jg ki kj kk ji hb bi translated">在这个例子中，<code class="du jn jo jp jq b">copiedPerson</code>对象中的所有值都与原始的<code class="du jn jo jp jq b">person</code>对象断开。</p></div></div>    
</body>
</html>