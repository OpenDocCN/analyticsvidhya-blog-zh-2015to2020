<html>
<head>
<title>Deploy Machine Learning Models for Free</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">免费部署机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-deploy-simple-machine-learning-models-for-free-56cdccc62b8d?source=collection_archive---------0-----------------------#2018-12-15">https://medium.com/analytics-vidhya/how-to-deploy-simple-machine-learning-models-for-free-56cdccc62b8d?source=collection_archive---------0-----------------------#2018-12-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/16b1a46a0c7ff8c46d830acfc53d8340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-gEH5pjevIAWIO4m_x3PA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">机器学习模型部署</figcaption></figure><h1 id="d8fb" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">介绍</h1><p id="cddc" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">机器学习模型躺在IPy笔记本或零散的python脚本中是没有好处的。为了改变人们的生活并对世界产生影响，模型需要以一种大众可用的方式部署，而不仅仅是领域专家。为此，模型需要封装在某种API之后，其他应用程序可以使用它与模型进行通信。它涉及到相当多的网络开发，人们经常被它吓倒。然而，这并没有那么难。通读这篇文章，自己去发现吧！</p><p id="c0be" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这篇文章的目的是在web上部署一个机器学习模型作为通用API，它可以在各种平台上使用，例如:</p><ol class=""><li id="8deb" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">网站</li><li id="8dba" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">telegram、slack、discord等应用程序的机器人</li><li id="b7a9" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">Android/iOS应用</li><li id="29fd" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">Alexa skills</li><li id="df73" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">允许您通过HTTP/HTTPS发送基本的GET/POST请求的任何其他平台</li></ol><blockquote class="lj"><p id="b14b" class="lk ll hi bd lm ln lo lp lq lr ls kp dx translated">免费托管API！</p></blockquote><blockquote class="lt lu lv"><p id="82de" class="js jt lw ju b jv lx jx jy jz ly kb kc lz ma kf kg mb mc kj kk md me kn ko kp hb bi translated"><em class="hi">*除非您的型号使用需要nvidia GPUs的CUDA，否则这种方法是免费的。如果你想使用CUDA或任何其他GPU密集型库，你需要购买一个带有nvidia GPU的服务器。如果你有一台服务器，我会在这篇文章的末尾介绍一些入门指南。</em></p></blockquote><h1 id="d7a1" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">先决条件</h1><p id="84d2" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">读者需要能够创建机器学习模型，训练它们，然后用它们来预测python中的结果。这篇文章旨在提供关于将机器学习模型部署到小规模生产中的见解。</p><p id="2b59" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">下面是将要使用的几个库和资源:</p><ul class=""><li id="370b" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp mf lb lc ld bi translated"><a class="ae mg" href="https://docs.python.org/2/library/pickle.html" rel="noopener ugc nofollow" target="_blank"> pickle </a>:本地python库，将python对象作为文件保存(序列化)和加载(反序列化)到磁盘上</li><li id="6994" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp mf lb lc ld bi translated">flask:一个基于python的易于使用的web框架。这里是由<a class="ae mg" href="https://www.youtube.com/channel/UCfzlCWGWYyIQ0aLC5w48gBQ" rel="noopener ugc nofollow" target="_blank">sendex</a>制作的<a class="ae mg" href="http://flask.pocoo.org/docs/1.0/" rel="noopener ugc nofollow" target="_blank">文档</a>和一系列好的<a class="ae mg" href="https://www.youtube.com/watch?v=Lv1fv-HmkQo&amp;list=PLQVvvaa0QuDc_owjTbIY4rbgXOFkUYOUB" rel="noopener ugc nofollow" target="_blank">视频教程</a></li><li id="efd0" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp mf lb lc ld bi translated"><a class="ae mg" href="https://www.pythonanywhere.com/" rel="noopener ugc nofollow" target="_blank"> pythonanywhere </a>:一个免费使用的教育网站，允许托管python flask，并提供完整的python开发环境。</li></ul><h1 id="a3fb" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">环境设置</strong></h1><p id="5a2c" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">确保使用python 3+</p><p id="2f24" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">pip安装以下软件包:</p><ol class=""><li id="af03" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">flask(我们的python-web框架)</li><li id="31b2" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">flask_cors:用于cors标题</li><li id="d069" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">jsonify:使用flask返回JSON文件</li><li id="6b36" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">根据需要的其他学习图书馆，如numpy、pandas、sklearn等</li></ol><p id="b0bf" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><code class="du mh mi mj mk b">pip install flask flask_cors jsonify numpy pandas</code></p><h1 id="e863" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">数据流</h1><p id="a2a1" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">下面是用户和服务器空间之间数据流的图示。</p><figure class="mm mn mo mp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/b91405104aebceda15312190a648afbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RPPYiWq4QtP6atV4gypZnA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">API数据流</figcaption></figure><p id="4a87" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">下面是需要做的事情的总结:</p><ol class=""><li id="759a" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">使用Jupyter笔记本训练模型</li><li id="19ea" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">将训练好的模型对象保存为pickle文件(序列化)</li><li id="f858" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">创建一个flask环境，该环境将具有一个API端点，该端点将封装我们训练好的模型，并使它能够通过HTTP/HTTPS上的GET请求接收输入(特性),然后在反序列化先前序列化的模型后返回输出</li><li id="01eb" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">将flask脚本和训练好的模型一起上传到<a class="ae mg" href="https://www.pythonanywhere.com/" rel="noopener ugc nofollow" target="_blank"> pythonanywhere </a></li><li id="8825" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">通过网站、bot、android应用程序或任何其他能够发送HTTP/HTTPS请求的应用程序向托管的flask脚本发出请求</li></ol><h1 id="b5d0" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">机器学习模型</h1><p id="f1fc" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这篇文章的目的是部署一个模型，而不是创建它。让我们假设我们有一个模型，它接受日期作为输入，并预测比特币的价格。该模型已经根据历史价格数据进行了训练。</p><figure class="mm mn mo mp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/fdc211003f88824febcb1e616f543c9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3f7G06z_j08oJDCg7VmwYA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型数据流</figcaption></figure><blockquote class="lt lu lv"><p id="8723" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">如果你有兴趣了解这个模型，你可以参考我的<a class="ae mg" href="https://github.com/TimeTraveller-San/crypto_predictor" rel="noopener ugc nofollow" target="_blank"> github库</a>。虽然，小心！使用机器学习永远无法预测比特币的价格，这只是巩固这一点的一次失败的尝试(也是一次非常愚蠢的尝试)。这个模型的功效不是这篇博文所关心的，所以现在让我们只讨论这个模型。<strong class="ju hj">序列化和反序列化模型</strong></p></blockquote><h1 id="32c4" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">泡菜</h1><p id="c48b" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">一个名为pickle的模块帮助在python中执行序列化和反序列化。</p><p id="9b6f" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">序列化</strong></p><p id="8bde" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">简而言之，序列化是一种在磁盘上编写python对象的方法，该对象可以传输到任何地方，稍后可以由python脚本反序列化(读取)回来。</p><figure class="mm mn mo mp fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/7eb57e27d1bfca855fe7ee305a101879.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*M3BIrJCbatE0QURBHDpSYQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">序列化、反序列化</figcaption></figure><p id="e4ce" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这是如何做到的:</p><figure class="mm mn mo mp fd ij"><div class="bz dy l di"><div class="ms mt l"/></div></figure><p id="639b" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">运行上述代码后，会创建一个名为“<strong class="ju hj"> mlp_nn.pkl </strong>的文件，该文件是经过训练的模型，可以传输到任何地方，并在反序列化后使用，如下所示:</p><p id="1dbc" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">反序列化</strong></p><figure class="mm mn mo mp fd ij"><div class="bz dy l di"><div class="ms mt l"/></div></figure><h1 id="67a0" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">烧瓶设置</h1><p id="cf3b" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">让我们首先在本地主机上设置flask服务器，然后在pythonanywhere上免费部署它。</p><p id="d66a" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">在本地主机上设置flask-app:</strong></p><p id="6491" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">确保烧瓶已安装。<code class="du mh mi mj mk b">pip install flask</code></p><p id="b111" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">以下脚本在本地主机和默认端口(5000)上启动flask服务器，使<a class="ae mg" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">成为URL:http://127 . 0 . 0 . 1</a>:5000/</p><blockquote class="lt lu lv"><p id="6d92" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">只需在浏览器上粘贴<a class="ae mg" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1</a>:5000/，按回车键即可看到服务器工作。</p></blockquote><figure class="mm mn mo mp fd ij"><div class="bz dy l di"><div class="ms mt l"/></div><figcaption class="iq ir et er es is it bd b be z dx">15</figcaption></figure><ul class=""><li id="89ba" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp mf lb lc ld bi translated"><strong class="ju hj"> App路线</strong></li></ul><p id="9fca" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj"> app.route </strong> decorator用于指定flask app在web上的路径。</p><p id="5425" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">“/”</strong>简单来说就是“<a class="ae mg" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>的家</p><p id="571e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj"> "/price/" </strong>表示<a class="ae mg" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:5000/price/</a></p><ul class=""><li id="e427" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp mf lb lc ld bi translated"><strong class="ju hj">自变量</strong></li></ul><p id="ef68" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">参数可以通过这些路径传递，如下所示:</p><p id="df1e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><a class="ae mg" href="http://127.0.0.1:5000/price/?date=12&amp;month=3&amp;year=2019" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:5000/price/？日期=12 &amp;月=3 &amp;年=2019 </a></p><p id="39f4" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">一般模板如下所示:</p><p id="f26c" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><a class="ae mg" href="https://[HOME]/[ROUTE]/?[var" rel="noopener ugc nofollow" target="_blank">https://[首页]/[路线]/？[var</a>1 _ name]=[var 1 _ value]&amp;<a class="ae mg" href="https://[HOME]/[ROUTE]/?[var" rel="noopener ugc nofollow" target="_blank">[var</a>2 _ name]=[var 2 _ value]</p><p id="ead8" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这些参数在flask脚本中解析如下:</p><ol class=""><li id="9d4c" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated"><strong class="ju hj">request . args . get(' date ')</strong>将返回12</li><li id="3b05" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated"><strong class="ju hj"> request.args.get('月')</strong>将返回3</li><li id="fdd2" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated"><strong class="ju hj">request . args . get(' year ')</strong>将返回2019</li></ol><blockquote class="lj"><p id="b759" class="lk ll hi bd lm ln lo lp lq lr ls kp dx translated">当你在浏览器中输入url时，它会通过HTTP/HTTPS向指定的URL发送一个GET请求。</p></blockquote><blockquote class="lt lu lv"><p id="5b4c" class="js jt lw ju b jv lx jx jy jz ly kb kc lz ma kf kg mb mc kj kk md me kn ko kp hb bi translated">在我们的例子中，我们向flask服务器发送了一个带有日期、月份和年份参数的GET请求，以获取我们模型的预测。</p></blockquote><ul class=""><li id="a1d1" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp mf lb lc ld bi translated"><strong class="ju hj"> jsonify </strong></li></ul><p id="d76c" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">flask . jsonify()</strong><em class="lw"/>函数将返回一个python字典作为JSON。JSON格式可以被认为是一个python字典，可以嵌套任意次并通过web传递。这是组织应用程序间共享数据的好方法。在处理web APIs时，总是建议使用JSON格式。</p><ul class=""><li id="923b" class="kv kw hi ju b jv kq jz kr kd kx kh ky kl kz kp mf lb lc ld bi translated"><strong class="ju hj"> CORS </strong></li></ul><p id="2469" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj"> flask_cors </strong>包用于修复AJAX调用<strong class="ju hj"> </strong>使用的cors头，使跨源AJAX成为可能。</p><blockquote class="lt lu lv"><p id="5079" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">旅游你可以在这里阅读更多关于CORS的信息，或者直接使用它。你不能忽略它，因为如果没有正确的CORS头文件，我们的API将不能被其他任何外部应用程序使用。我个人与CORS错误做了很多斗争，并且不得不阅读flask和一些web开发文档来提出这个简单的解决方案。如果你有一个更好的方法来处理CORS头文件，请在回复中告诉我。</p></blockquote><h1 id="b86b" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">预测功能</h1><p id="d368" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">上面的代码在my_bitcoin_predictor类中有一个predict函数，需要稍微解释一下</p><p id="104d" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">预测函数可以接受输入特征并输出模型的预测。这是使用python flask在web上实际部署的函数。现在，不再通过python脚本或IPy笔记本从相同的环境中接收输入要素，而是通过web上的flask等web服务器接收要素，并返回预测结果。</p><blockquote class="lt lu lv"><p id="8a8b" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">为了简单起见，我跳过了<strong class="ju hj"> my_bitcoin_predictor </strong>类的很多部分，只写重要的部分。</p></blockquote><figure class="mm mn mo mp fd ij"><div class="bz dy l di"><div class="ms mt l"/></div></figure><h1 id="eec8" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">文件结构</h1><p id="bff5" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">一个简单的文件结构如下所示:</p><pre class="mm mn mo mp fd mu mk mv mw aw mx bi"><span id="e9f7" class="my iv hi mk b fi mz na l nb nc">Bitcoin predictor<br/> |<br/> +-- flask_app.py<br/> |    <br/> +-- predictor.py<br/> |<br/> +-- mlp_nn.pkl<br/> | <br/> +-- data<br/> |  |  <br/> |  +-- bitcoin_price_historical_data.csv</span></pre><blockquote class="lt lu lv"><p id="0d6b" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">我还没有谈到模型由历史数据训练的部分</p></blockquote><p id="5c44" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">名为<code class="du mh mi mj mk b">Bitcoin predictor</code>的文件夹是需要上传到pythonanywhere上的文件夹</p><h1 id="ceac" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">托管flask应用</h1><p id="8bba" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">本地主机上托管的flask应用程序不能与其他人共享，因为它是“本地”的。按照几个简单的步骤将脚本托管到一个名为pythonanywhere的免费python托管网站:</p><p id="a028" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">第一步。注册一个新账户</strong>。</p><p id="8c00" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">现在，让我们坚持免费帐户。你可以购买更好的主机方案来满足更多样化和更复杂的需求。(在这个网站上有一个为新用户准备的不错的游览，会对你有所帮助)</p><p id="f80d" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">第二步。添加新的网络应用</strong></p><p id="bc2f" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">选择flask和您想要的任何python版本。为了这个教程，我将使用最新的Python 3.7。创建web应用程序后，您将获得一个指向flask端点的URL。默认情况下，它会显示一条消息“您好，来自Flask！”。您的端点看起来像这样:<code class="du mh mi mj mk b">[username].pythonanywhere.com</code></p><figure class="mm mn mo mp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/9b528ec0fb92aca6d72f4cef1024946d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ibolu5U2noGatKQoEa5tZA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">添加新的web应用</figcaption></figure><p id="d21a" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">第三步。安装依赖关系</strong></p><p id="f92e" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">您的ML模型必须使用各种外部库，如sklearn、numpy、pandas等。将它们全部安装在您的pythonanywhere环境中。为此，打开一个新的bash控制台并使用pip安装库。确保使用<em class="lw"> </em> <code class="du mh mi mj mk b">user </code>选项安装带pip的库，因为我们没有超级用户权限。烧瓶已经安装，不需要再次安装。</p><p id="bdc5" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><code class="du mh mi mj mk b">pip install --user flask_cors numpy pandas</code></p><figure class="mm mn mo mp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/550c2a4120b0dd156db7c690135a4b58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UM6wT78d53lctDV34uJQ-Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">安装依赖项</figcaption></figure><p id="c8ff" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">第四步。</strong> <strong class="ju hj">上传文件</strong></p><p id="95f0" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">在默认文件夹— /mysite/中，您需要上传完整的文件夹。您可以使用网站上的files页面或者通过使用wget命令下载文件来使用bash控制台。</p><figure class="mm mn mo mp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/099649d46d896cdad0871e562dd48e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zUAw9nlSadeKCZv_oqnQzg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">上传文件</figcaption></figure><p id="d734" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated"><strong class="ju hj">第五步。</strong> <strong class="ju hj">重新加载web app </strong></p><p id="c357" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">您的端点现在将充当API来促进其他应用程序。</p><figure class="mm mn mo mp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ng"><img src="../Images/5c2404e0a1e50307c47927bc148b1042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eLKvvZQwtmoy7nZ92wILEA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">重新加载web应用程序</figcaption></figure><h1 id="9b34" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">前端应用示例</h1><blockquote class="lt lu lv"><p id="fa0e" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">你需要了解基本的HTML、CSS和JavaScript。</p></blockquote><figure class="mm mn mo mp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nh"><img src="../Images/d539611281f3a5678f69cf70130d4988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SWStHfzdVlX89i2hMAu-JQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">一个示例网站</figcaption></figure><p id="752f" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">据观察，许多机器学习爱好者不喜欢web开发，这就是为什么我创建了一个简单的模板，可以用来通过HTML表单接收输入功能，并向API发出请求以获取结果。即使你不精通HTML-CSS-JavaScript，你也可以很容易地编辑这个模板。</p><p id="f223" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">这里是同样的<a class="ae mg" href="https://github.com/TimeTraveller-San/ML-frontend-template" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>。</p><p id="755a" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">对于讨论中的示例，编辑后的JavaScript模板如下所示:</p><figure class="mm mn mo mp fd ij"><div class="bz dy l di"><div class="ms mt l"/></div></figure><p id="a3c1" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">在线托管这个网站，我们就大功告成了！任何地方的任何人都可以使用该网站提交特征，并从位于后端的各种数据层下的ML模型中获得预测结果。</p><blockquote class="lt lu lv"><p id="af54" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated"><em class="hi">*我更喜欢在GitHub上上传我的网站，然后用</em> <a class="ae mg" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank"> <em class="hi"> netlify </em> </a> <em class="hi">让它直播。全部免费！</em></p></blockquote><h1 id="f2da" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">在个人服务器上托管</strong></h1><p id="fd31" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">pythonanywhere仅用于教育目的，缺少GPU。对于严重依赖CUDA和基于GPU的计算的复杂深度学习模型，需要更强的服务器。Flask在一个新的服务器上从头开始运行，使用一个像nginx这样的web服务器后面的<a class="ae mg" href="https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface" rel="noopener ugc nofollow" target="_blank"> WSGI </a>服务器，比如<a class="ae mg" href="https://gunicorn.org/" rel="noopener ugc nofollow" target="_blank"> gunicorn </a>。也可以使用类似<a class="ae mg" href="http://supervisord.org/" rel="noopener ugc nofollow" target="_blank">主管</a>的过程控制系统。</p><blockquote class="lt lu lv"><p id="5038" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">所有这些都需要一些web开发知识，写这些会让这篇文章太冗长。这个<a class="ae mg" href="http://alexandersimoes.com/hints/2015/10/28/deploying-flask-with-nginx-gunicorn-supervisor-virtualenv-on-ubuntu.html" rel="noopener ugc nofollow" target="_blank">网页</a>帮助我第一次在我的服务器上设置flask。真的很简单，写的非常好。</p><p id="9e01" class="js jt lw ju b jv kq jx jy jz kr kb kc lz ks kf kg mb kt kj kk md ku kn ko kp hb bi translated">你也可以参考我的<a class="ae mg" href="https://github.com/TimeTraveller-San/deep_learning_otae_detector" rel="noopener ugc nofollow" target="_blank">图像分类模型</a>，它使用CUDA，托管在本地主机上。它展示了如何使用flask处理图像文件并将其传递给模型。我将很快写一个完整的帖子专门讨论这个问题。</p></blockquote><h1 id="9edc" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结论</h1><p id="1835" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">托管和共享机器学习模型真的很容易。依靠机器学习模型后端创建android应用程序、聊天机器人和更多应用程序现在可以非常容易地创建。</p><p id="e212" class="pw-post-body-paragraph js jt hi ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">感谢阅读。如果我犯了什么错误，或者有些事情可以做得更好，请在回复中告诉我。</p></div></div>    
</body>
</html>