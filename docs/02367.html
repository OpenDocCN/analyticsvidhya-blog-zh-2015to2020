<html>
<head>
<title>Machine Learning Development Life Cycle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习开发生命周期</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-development-life-cycle-dfe88c44222e?source=collection_archive---------4-----------------------#2019-12-13">https://medium.com/analytics-vidhya/machine-learning-development-life-cycle-dfe88c44222e?source=collection_archive---------4-----------------------#2019-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8c72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将尝试涵盖机器学习项目的生命周期。机器学习模型开发工作流程将在各个阶段进行介绍。在本文中，我们将对著名的泰坦尼克号数据集进行分类任务，以预测泰坦尼克号乘客的存活率。该数据集包含一些在“皇家邮轮泰坦尼克号沉没”的致命事故中的乘客的信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/76925314f9109c9ee572dd4f9615c686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IUsVRlIUokfXY3EE4TZJ6w.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">点火，TCS</figcaption></figure><p id="269a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图几乎涵盖了以连续方式系统和正确开发ML模型所需的所有阶段。让我们详细讨论所有阶段(除了部署阶段)。</p><h1 id="9d83" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">问题定义</h1><p id="229e" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">如前所述，问题的定义是预测泰坦尼克号乘客的存活率。这将基本上是一个对两类人的分类任务:<em class="kw">幸存</em>或<em class="kw">未幸存。</em></p><h1 id="944d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据选择</h1><p id="6f7f" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">数据集是著名的泰坦尼克号数据集，报名参赛后可以从<a class="ae kx" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载。</p><h1 id="dca4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">探索性数据分析</h1><p id="8ac6" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">该过程是提供初始数据分析和数据调查的关键过程之一，并使用汇总统计和图形表示提供重要的见解和数据特征。</p><p id="efdf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据集包含891行和12列，其中1列是因变量，其他11列是自变量。数据集中的一个示例如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/2f3b951e799e9c9bb200f96a9c6ac3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XFuyC71jj-lAWkZicfXhfA.png"/></div></div></figure><p id="4d6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每列的简短描述如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/112b4e256dbec73a0fdb60b8aaac0c23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZmB3FXQPnpeT2lUgi8Q3Q.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae kx" href="https://www.kaggle.com/c/titanic/data" rel="noopener ugc nofollow" target="_blank">卡格尔</a></figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es la"><img src="../Images/f9c126d40687a1246c6c22c7c5429533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--LttNJf_gasP5wuvr1wlg.png"/></div></div></figure><ul class=""><li id="d0ef" class="lb lc hi ih b ii ij im in iq ld iu le iy lf jc lg lh li lj bi translated">数据有整数、浮点和对象值</li><li id="dabc" class="lb lc hi ih b ii lk im ll iq lm iu ln iy lo jc lg lh li lj bi translated">由于计数不等于行数，数据在年龄、客舱和登机列中具有空值</li><li id="55eb" class="lb lc hi ih b ii lk im ll iq lm iu ln iy lo jc lg lh li lj bi translated">对于对象类型列，数值运算以NaN形式返回</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/b5475541ff42ad2c2b6b63a4887e6c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*HgawuI51ClH5apzt7VpKfw.png"/></div></figure><ul class=""><li id="0eff" class="lb lc hi ih b ii ij im in iq ld iu le iy lf jc lg lh li lj bi translated">它显示目标变量中的唯一值计数，即幸存值</li><li id="fb08" class="lb lc hi ih b ii lk im ll iq lm iu ln iy lo jc lg lh li lj bi translated">它显示在给定数据集中的891个数据中，342个幸存，549个没有</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/a2ee2711aa9c35d6f18fe58b60273a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*WV-rR-3SVeOXrX7x6Iq-GQ.png"/></div></figure><p id="e8ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是数据的数字列的相关矩阵。</p><ul class=""><li id="db63" class="lb lc hi ih b ii ij im in iq ld iu le iy lf jc lg lh li lj bi translated">可以推断，Parch与SibSp具有良好的相关性</li><li id="162d" class="lb lc hi ih b ii lk im ll iq lm iu ln iy lo jc lg lh li lj bi translated">幸存与票价有很好的相关性</li></ul><h1 id="658e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据预处理</h1><p id="9570" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">可以看出，数据转换经常与数据预处理结合在一起。但是，这里我们将分别执行这两个过程。</p><p id="3690" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们要做的第一件事是找出哪些列缺少值</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/9b23f9defad2b90a378d7d1dc7f48a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*CdlfoF4l0DSka0uvktzZqw.png"/></div></figure><p id="a2c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，年龄、客舱和已登船的值为空，其中客舱中几乎80%的数据为空(让我们看看我们可以从中找到一些见解或删除它)</p><p id="f483" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们用称为插补的适当值来填补缺失值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/33dc507779eab65d3227ccb2f28f018a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7p2g19CL9SKIrnGRKRpD6Q.png"/></div></div></figure><p id="ca2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里涉及第二个过程是处理连续和嘈杂数据，即年龄和票价。这里我们将使用宁滨方法将连续变量转换为分类变量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/d3017705227c7b49fd5046cbdf153147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JV4CsOUREN4ZnlDjUz5aOQ.png"/></div></div></figure><p id="e0a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在分析了年龄和费用之后，bin被分别创建为Age_bin和Fare_bin。创建5个bin，每个bin至少包含总数据的5%(有关详细信息，请访问<a class="ae kx" href="https://github.com/vishal1905/ML_Development_Life_Cycle/" rel="noopener ugc nofollow" target="_blank"> github </a> repo)。</p><h1 id="f265" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据转换</h1><p id="6cee" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在这个过程中，我们将发现是否可以从现有的列中提取一些有用的见解，并将这些列转换为对模型有用的特定方式</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/8bed0fdf070b3976e69413cb6c62d662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wb-HM5XfA-9p-aecCY75_A.png"/></div></div></figure><p id="1626" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据中姓名一栏都是唯一的，但是可以看到所有姓名前面都有英文敬语(先生、夫人、主人等。)也称为称呼语，可以作为一个范畴变量。同样从船舱中，我们可以提取出船上可用的甲板值。然后我们取主要出现的称呼值，如先生、夫人、主人、小姐，其余的(女士、医生、船长)为其他。类似地，在deck中，缺失的deck值被赋予任意值作为z。</p><h1 id="6171" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">特征选择</h1><p id="3e7a" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在特征选择中，这里我们将使用属性相关性分析(ARA)。</p><blockquote class="lv"><p id="cdab" class="lw lx hi bd ly lz ma mb mc md me jc dx translated">属性相关性分析阶段的任务是识别对客户流失影响最大的属性(特征)。通过属性相关性分析，显示出与流失(流失=“是”或“否”)相关的最大分离能力的属性将被选为建立预测流失模型的最佳候选。</p></blockquote><p id="7ca6" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mi is it iu mj iw ix iy mk ja jb jc hb bi translated">属性相关性分析用于流失模型开发，但也可用于分类任务，以找出哪些特征最适合分类模型。在ARA中，我们将使用<strong class="ih hj"> <em class="kw">【证据权重】【WOE】</em></strong><strong class="ih hj"><em class="kw">【信息值】(IV) </em> </strong>。</p><p id="0967" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">证据权重</strong></p><p id="89e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据<a class="ae kx" href="http://www.listendata.com" rel="noopener ugc nofollow" target="_blank">www.listendata.com</a>，WOE定义为:</p><blockquote class="ml mm mn"><p id="5115" class="if ig kw ih b ii ij ik il im in io ip mo ir is it mp iv iw ix mq iz ja jb jc hb bi translated">证据的权重表明了自变量相对于因变量的预测能力。由于它是从信用评分世界演变而来的，它通常被描述为区分好客户和坏客户的一种方法。<strong class="ih hj">“不良客户”</strong>指拖欠贷款的客户。<strong class="ih hj">“好客户”</strong>指还贷的客户。</p></blockquote><p id="3eb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且IV被定义为:</p><blockquote class="ml mm mn"><p id="8324" class="if ig kw ih b ii ij ik il im in io ip mo ir is it mp iv iw ix mq iz ja jb jc hb bi translated">信息值是在预测模型中选择重要变量的最有用的技术之一。这有助于根据变量的重要性对其进行排序。</p></blockquote><p id="09c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算WOE和IV的公式为:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/1562ef196d016e2f0176aa6b50964173.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qqs8mjo0Z-oD5MXqDZTow.jpeg"/></div></div></figure><p id="dcf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算WOE和IV有一些先决条件。它们是:</p><ul class=""><li id="0398" class="lb lc hi ih b ii ij im in iq ld iu le iy lf jc lg lh li lj bi translated">数据中不应有任何缺失值</li><li id="5ca3" class="lb lc hi ih b ii lk im ll iq lm iu ln iy lo jc lg lh li lj bi translated">不应该有任何连续的列。如果存在连续特征，则应使用宁滨将其转换为分类变量</li><li id="4627" class="lb lc hi ih b ii lk im ll iq lm iu ln iy lo jc lg lh li lj bi translated">每个创建的bin至少应包含总数据的5%</li></ul><p id="35ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了计算WOE和IV，让我们自己来做，而不是使用一些软件包。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/89dc263fee027468f2750c42c767c422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zLp7vgnpflQ9xlhqkYiW3g.jpeg"/></div></div></figure><p id="8533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们计算转化过程后所有特征的WOE和IV。IV值为:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mt"><img src="../Images/64d417463f3c306eea3d2420d91a5c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*dnuLX6MVL_tjqy_qUEXBSw.png"/></div></figure><p id="36eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能想知道，IV被选中做模特的资格标准是什么。与IV相关的规则是:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mu"><img src="../Images/08db090edd95076228b1dc02c9cc59fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*MAsbBqoHI8njR2EtuQIY7Q.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">第四规则</figcaption></figure><p id="9d2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据给定的IV规则，我们选择了IV大于0.1的列。</p><p id="b87c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在选择特征之后，我们可以将特征转换成分类变量，这将有利于模型训练。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/079bb9b2db617d3062127c0c2008a3b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TNnumCMt3QR5t_ceoPoKqQ.png"/></div></div></figure><h1 id="1d96" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">模型选择、模型训练和模型评估</h1><p id="3c16" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">这里，对于模型选择，我们采用了各种集成分类器，如决策树、随机森林、bagging、xgboost等。我们对每个模型进行了训练，并对每个模型的评估指标进行了比较。对于评估指标，我们采用了准确度、精确度和召回率。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mw"><img src="../Images/c38f8cfee28c230fc00d95f60fa89d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*uvi2R8eMhBVVCPqbb1eLcQ.png"/></div></figure><p id="52a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的比较中，我们发现XGBoostRandomForest分类器在titanic数据集上的效果最好，准确率为82.7%，精确度为84.0%，召回率为80.0%。</p><p id="49d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码请访问github repo。</p><div class="mx my ez fb mz na"><a href="https://github.com/vishal1905/ML_Development_Life_Cycle/" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hj fi z dy nf ea eb ng ed ef hh bi translated">vishal 1905/ML _开发_生命周期</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">github.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no jn na"/></div></div></a></div><p id="104f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请浏览<a class="ae kx" href="https://neptune.ai/blog/life-cycle-of-a-machine-learning-project" rel="noopener ugc nofollow" target="_blank">https://Neptune . ai/blog/life-cycle-of-a-machine-learning-project</a>了解更多关于ML生命周期的见解。</p><p id="d2b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">其他文章</strong></p><ul class=""><li id="4b65" class="lb lc hi ih b ii ij im in iq ld iu le iy lf jc lg lh li lj bi translated"><a class="ae kx" rel="noopener" href="/analytics-vidhya/super-resolution-gan-srgan-5e10438aec0c">超分辨率氮化镓(SRGAN) </a></li><li id="a6b6" class="lb lc hi ih b ii lk im ll iq lm iu ln iy lo jc lg lh li lj bi translated"><a class="ae kx" rel="noopener" href="/analytics-vidhya/dcgan-447a629170ec">深度卷积GAN(DCGAN) </a></li></ul></div></div>    
</body>
</html>