<html>
<head>
<title>Reading the Brain with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习解读大脑</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/reading-the-brain-with-machine-learning-aad4627cbc4b?source=collection_archive---------16-----------------------#2020-03-28">https://medium.com/analytics-vidhya/reading-the-brain-with-machine-learning-aad4627cbc4b?source=collection_archive---------16-----------------------#2020-03-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/12d12b3aa432c9139a4a8aba31e623aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXaeO_piMES2XqO_OiZpVg.jpeg"/></div></div></figure><p id="45db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的<a class="ae jo" rel="noopener" href="/analytics-vidhya/brain-research-on-the-cheap-ec9710a6c21b">上一篇文章</a>中，我谈到了使用便携式脑电图设备来检测大脑中的事件相关电位(ERP)。具体来说，在一个谜题被正确解答后，我能够检测到一个奖励积极性(RewP)信号。我通过在事件发生后立即绘制信号图，并将其与来自<a class="ae jo" href="https://www.frontiersin.org/articles/10.3389/fnins.2017.00109/full" rel="noopener ugc nofollow" target="_blank">本文</a>的平均RewP信号进行比较来做到这一点。利用我的人类大脑的视觉模式识别，我确认我得到了相同的模式。训练一个机器学习模型来识别相同的模式，这样我们就可以自动监控这些事件，这难道不是很有趣吗？这样，这些ERP可以触发基于事件的API，我们可以编写由各种大脑状态驱动的代码。为此，我训练了一只RNN来探测RewP。</p><p id="7663" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个问题让我想起了触发词检测，例如，你训练一个人工智能听音频输入，当它听到“嘿Siri”或“OK Google”时就会醒来。在deeplearning.ai类<a class="ae jo" href="https://www.coursera.org/learn/nlp-sequence-models/home/welcome" rel="noopener ugc nofollow" target="_blank">序列模型</a>中有一个项目就是这样做的，所以我决定使用他们的方法作为起点，并从那里进行调整。唯一的区别是，我们看的不是音频数据，而是脑电图数据，我们看的不是特定的词，而是活动的模式，但除此之外，问题是相似的，因为它们都处理一维时间序列数据。</p><h1 id="42b0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">数据</h1><p id="a3a8" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我开始的数据非常有限，所以我不期望有突出的结果，但我认为最好开始并进行模型的第一次迭代，我可以在以后添加更多/更好的数据。我收集了8个人(包括我自己)的12份脑电图记录，同时做了一些测试，比如在未标记的欧洲地图上寻找国家或者国际象棋谜题，如果他们的答案是对还是错，他们会得到即时反馈。我还记录了鼠标点击的时间戳，以准确知道反馈是何时给出的，我还记录了屏幕，以便稍后我可以判断每个答案是否正确。</p><h1 id="c991" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">预处理</h1><p id="1b08" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">一旦我汇总了数据，在鼠标被释放后，我立即为他们正确给出的每个答案截取了1秒钟的EEG数据(电极TP9和TP10的平均值)。这是我期望找到RewP ERP的地方。在某些情况下，RewP信号存在，而在其他情况下则不存在。我的<a class="ae jo" href="https://www.frontiersin.org/articles/10.3389/fnhum.2019.00041/full" rel="noopener ugc nofollow" target="_blank">研究</a>告诉我，只有当受试者真的关心结果(不管他们是否答对)时，信号才会出现，所以有可能我的一些受试者只是对一些问题不够关心，所以RewP没有出现。为了增加我成功的机会，我手动过滤了我认为RewP存在的案例，并把它们放在一边。在某些情况下，Muse会暂时失去信号，可能是因为电极连接不良，在这些情况下，它会记录NaN。我没有使用任何超过南总百分之几的录音。为了处理剩余的缺失数据，我用记录的平均值替换了NaN。接下来，我让信号通过一个双通巴特沃兹滤波器，通带为0.1 Hz至30 Hz，就像他们在<a class="ae jo" href="https://www.frontiersin.org/articles/10.3389/fnins.2017.00109/full" rel="noopener ugc nofollow" target="_blank">这篇论文</a>中所做的那样，我最初复制它是为了消除噪声。</p><h1 id="8f0a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">合成数据生成</h1><p id="fe72" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">按照触发词检测的例子，他们创建了合成的训练数据，其中目标词在没有背景噪声的情况下被记录，然后噪声从不同的位置(如嘈杂的咖啡馆、交通等)被单独记录。然后，在一小段噪声中的随机位置插入触发字，这样就可以知道信号的确切时间戳。我做了同样的事情。对于“背景噪音”,我使用了冥想阶段的脑电图记录。我的推理是，RewP不太可能在冥想期间出现，因为受试者没有做任何可以提供反馈的任务。这种大脑活动可能不能代表“正常”的大脑活动，但这是我所拥有的，我必须从某个地方开始。我在10秒钟的冥想脑电图记录剪辑中随机插入0到4次RewP。我采取的一个步骤是将信号转换成不同频率的摄谱仪(本质上是傅立叶变换)。与音频数据不同，我认为原始格式的EEG模式更容易识别。基本事实激活(Y)是一个向量，每个时间步长为0或1。向量以全0开始，然后在RewP信号结束后，立即在短时间内设置为1。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/20956fd661eed89a97bf7846cfb98165.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*9ToTo3Dz2V_CWUTT3gVCKg.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx translated">上图:EEG信号，下图:用于训练的地面实况(Y)</figcaption></figure><h1 id="fe1a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">模型</h1><p id="f06e" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">作为起点，我使用了与触发器单词检测项目相同的模型架构，我正在跟踪该项目的示例。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/2db145a1450b763267598d1d2be8caf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*84CLcnmoUERddrNEHTe50Q.png"/></div></div></figure><p id="35f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它使用一个1D卷积层，然后是2层GRU卷积层，最后是一个密集(全连接神经网络)。在Keras中用Tensorflow实现。由于卷积的步距是4，它输出的值比它接收的值少1/4。换句话说，它每4个输入时间步进行一次预测。我在笔记本电脑上训练了一夜。</p><h1 id="6923" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结果</h1><p id="47f1" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我做了新的脑电图记录，而受试者做了相同类型的任务，以用作验证集。鉴于有限的训练数据，有改进的空间并不奇怪，但这里有一个例子。在下图中，地面实况在顶部，预测在底部。如果该值达到0.5以上，我们就认为它被激活了，所以正如您看到的，第一个ERP是正确的，下一个有点早，最后一个有点晚。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/b5e74c47ce1a55e0fbb3ba8096830a84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6pK_712rFyzMfTnIT495Tw.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx translated">顶部:地面真相，底部:预测</figcaption></figure><p id="c321" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要提高它的可用性还有很多工作要做，但到目前为止，结果是令人鼓舞的。如果你对此感兴趣，或者你正在做类似的事情，我很乐意和你聊天，并可能合作。请评论或直接联系我:tony@tonythinks.com</p></div></div>    
</body>
</html>