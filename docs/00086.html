<html>
<head>
<title>Linear Regression in Python from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的线性回归从零开始</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-in-python-from-scratch-24db98184276?source=collection_archive---------0-----------------------#2018-09-06">https://medium.com/analytics-vidhya/linear-regression-in-python-from-scratch-24db98184276?source=collection_archive---------0-----------------------#2018-09-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6c05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性回归是机器学习中最基本和最流行的算法之一。当任何有抱负的数据科学家开始涉足这一领域时，线性回归必然是他们遇到的第一个算法。它很直观，有很好的使用范围，并且很容易理解。</p><p id="c980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将从头开始用Python构建一个简单的单变量线性回归模型来预测房价。</p><p id="ba8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我会告诉你线性回归背后的基本思想。假设您有给定任何特征的房屋价格(目标变量)的数据集(训练集)，如房屋的大小或房屋中的房间数量(预测值或特征)。现在，您的工作是预测任何其他房屋的价格，给定训练数据集中给定的相同特征(如房间数量)。</p><p id="d35b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性回归技术所做的是，它找到适合该训练集的最佳可能直线，然后预测任何看不见的房子(即不在训练集中的房子)的价格。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/591798758553fc89dc15be0a71f50e1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*NVBmoDP3CaAmVR3L7mu6pQ.png"/></div></figure><p id="2763" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性回归找出最符合数据的那条线的参数，即在这种情况下的斜率(θ1)和截距(θ0)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jl"><img src="../Images/2e10abc60c0fdbc7a5a4ff887841c650.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*Ob-FRnif-CvXEcqMN3JeVA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">使用参数(即斜率和截距)预测价格的假设</figcaption></figure><p id="4742" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可能看起来非常简单，但它是该算法的最基本实现，其中b/w特征和目标变量之间存在线性关系，并且仅适用于单个变量。尽管它可以被容易地转换以用于多种特征。但在我们面临的大多数问题中，情况可能并非如此。在现实世界中，您经常会发现目标可能会随着特征而非线性变化，并且会使用多个特征来预测目标变量。在这种情况下，将使用具有高阶特征项的曲线，并且用图形显示具有两个以上特征的模型也不方便。</p><p id="f6a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在许多问题中，线性回归可能是有用的。但我们将从最基本的开始，即单变量，其中一个特征与目标具有非常线性的关系，我们将在上面讨论的房价问题上实现它。</p><p id="61e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们导入一些库:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><p id="b592" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NumPy是一个python库，它使得数值计算变得容易，特别是在数组上。<a class="ae js" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>帮助构建和清理数据，以便以系列和数据框架的形式进行分析。<a class="ae js" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>和<a class="ae js" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>用于可视化。</p><p id="6c82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“%matplotlib inline”确保图表显示在Jupyter笔记本内部。</p><p id="0a41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将使用pandas read_csv函数读取数据。我们的<a class="ae js" href="https://github.com/Nimishkhurana/Linear-Regression/blob/master/Univariate_LinearRegression_HousingPrice.ipynb" rel="noopener ugc nofollow" target="_blank">房价数据集</a>看起来像这样:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jt"><img src="../Images/833c41a2f8bd87c4395f87100b91a01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3OmvwhXhfxkSYdK0XTFgw.png"/></div></div></figure><p id="92ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将为列命名</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jy"><img src="../Images/c52eeaccf842ddb64504932890ed6e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rse7fz7VaXZ3Ir28YnivIg.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jz"><img src="../Images/781141878d40be1c3dfb4f130208a9ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B2UWfqKXsMHC00zefljMiA.png"/></div></div></figure><p id="c4cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，数据集看起来很好，信息量也很大。</p><p id="892d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用matplotlib以散点图形式绘制黑白特征和目标变量关系的实用函数:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><p id="6363" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这给出了下面的图表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es ka"><img src="../Images/2e6889cdc0c19e0607c04a8c0f691401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*asJYnw0v2rPjckTb2JafPw.png"/></div></div></figure><p id="1896" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些图表清楚直观地显示了目标变量与特征之间的关系。我们可以看到RM(Avg。每所住宅的房间数)与MEDV有非常线性的关系。</p><p id="7391" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看这种关系的另一种方法是使用seaborn的热图绘制特征和目标变量之间的相关性。这也更具描述性。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es kb"><img src="../Images/f6032e2fa0fc248117b83940145e243d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gjmxj47lZU8l13t8DP_q-Q.png"/></div></div></figure><p id="92c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MEDV与RM的相关系数为0.7，这意味着它们与其他特征相比呈线性变化。因此，我们将只考虑这一特性，因为我们不打算使用任何高阶项。</p><blockquote class="kc"><p id="555a" class="kd ke hi bd kf kg kh ki kj kk kl jc dx translated"><strong class="ak">如何找到最佳参数？？</strong></p></blockquote><p id="6621" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq ko is it iu kp iw ix iy kq ja jb jc hb bi translated">现在我们知道，我们必须找到最适合训练数据的参数。但直到知道我们不知道如何这样做。让我们把那部分也展开。</p><p id="9250" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先要做的是将参数初始化为一个随机值(比如0)。然后我们将对它们实施梯度下降。</p><h1 id="4c38" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">梯度下降</h1><blockquote class="lp lq lr"><p id="dc93" class="if ig ls ih b ii ij ik il im in io ip lt ir is it lu iv iw ix lv iz ja jb jc hb bi translated"><strong class="ih hj">为我们的线(或曲线)寻找最佳参数的技术</strong></p></blockquote><p id="348c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">初始化参数后，我们将找到这些参数下的成本函数值。<strong class="ih hj"> <em class="ls">成本函数</em> </strong>是计算由我们的假设<em class="ls"> h </em>预测的房屋(目标)价值与训练集中房屋的实际价格之间的误差的函数。所以梯度下降的目标是最小化成本。有许多方法来计算成本函数最常见的是通过计算差异，平方它，并采取其平均。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/88a0d50e0147114e269e971e5322b93f.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*2HA4UByDhPtkC4xWZJfaVg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">价值函数</figcaption></figure><p id="2fd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里<em class="ls"> h </em>是给定其特征的任何房屋的预测值<em class="ls"> x </em>(在这种情况下为RM)并且<em class="ls"> m </em>是训练集中的记录数量。</p><p id="3618" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除以2只是为了简化数学计算。</p><p id="577f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此<em class="ls"> h </em>可以替换为:-</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jl"><img src="../Images/2e10abc60c0fdbc7a5a4ff887841c650.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*Ob-FRnif-CvXEcqMN3JeVA.png"/></div></figure><p id="3d84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了最小化成本函数，我们将使用微积分来说明如何最小化任何函数。任何函数在一点都有局部极小值，如果它在该点的斜率为0。如果你不懂微积分，实际上我们会找到特定值下成本函数w . r . t .θ1和θ0的斜率，并继续分别从θ1和θ0中减去该斜率。因此，这将使θ0和θ1在每次迭代后将成本函数更多地移向最小值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/d2e9070a45755e07cddfac4f4ce484c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*iQumcv0Puw6v6MXClU3fTw.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">来源:Coursera上的机器学习课程</figcaption></figure><p id="757d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">alpha是学习率，即我们希望参数更新的速度。它不应该非常小，因为这将使梯度下降缓慢，也不应该非常大，因为这可能使梯度下降超过最小值，它将发散而不是收敛。一般来说，b/w保持在0.01和0.5，但是每个问题都有不同的alpha。它可以通过反复试验来发现，从小值开始，然后增加，直到每次迭代的成本降低。如果在任何迭代中成本增加，这是大alpha的标志，您应该减少alpha。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/2ccd1343aed789c46c4d8ff4c09a9f17.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*u-pxhkiqAPHL7zlkfBYWWQ.png"/></div></figure><p id="8ef8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们用代码实现这一切。我们对每个任务都有单独的函数，如predictPrice、calculateCost和gradientDescentLinearRegression。我们已经实现了以θ为向量的所有代码。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><p id="2952" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lz ma mb mc b"><em class="ls">abline</em></code>是一个效用函数，在每1000次迭代后绘制图形，以显示拟合线。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><p id="560a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们用默认参数调用<em class="ls">GradientDescentLinearRegression</em>函数时</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jq jr l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es md"><img src="../Images/c3f7af4cb86edff985597bf5b2c9af35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZXxVrjD1F9fGWhYTos9mg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es me"><img src="../Images/cdd264ba6f18cbcac0c9bc16edc60002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G3V-rXpQyIAG5gsDbiid7w.png"/></div></div></figure><p id="bd8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们找到了最能描述黑白特征和目标之间关系的线条。这条线现在可以用来预测其他房子的价格。</p><p id="d0c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在此处找到笔记本和数据集:</p><p id="adb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae js" href="https://github.com/Nimishkhurana/Linear-Regression" rel="noopener ugc nofollow" target="_blank">https://github.com/Nimishkhurana/Linear-Regression</a></p><p id="7938" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">👏如果你喜欢并跟随阅读更多这样的文章。</p><p id="679d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与我联系:-</p><p id="776f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">领英简介:<a class="ae js" href="https://www.linkedin.com/in/nimish-khurana-306255148/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/nimish-khurana-306255148/</a></p><p id="25f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">github:<a class="ae js" href="https://github.com/Nimishkhurana/" rel="noopener ugc nofollow" target="_blank">https://github.com/Nimishkhurana/</a></p><p id="3d28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个学习ML的互动网站:<a class="ae js" href="https://pytholabs.com/?utm_source=LKDN&amp;utm_medium=MYNK&amp;utm_campaign=personal" rel="noopener ugc nofollow" target="_blank">https://pytholabs.com/?utm_source=LKDN&amp;UTM _ medium = MYNK&amp;UTM _ campaign = personal</a></p></div></div>    
</body>
</html>