<html>
<head>
<title>Cross validation the right and wrong way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">交叉验证正确和错误的方式</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cross-validation-the-right-and-wrong-way-589b8c9cc2c6?source=collection_archive---------1-----------------------#2018-03-01">https://medium.com/analytics-vidhya/cross-validation-the-right-and-wrong-way-589b8c9cc2c6?source=collection_archive---------1-----------------------#2018-03-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/951b945bc4d5b1dedf89f5223d5e9b83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lkzM_3aydS4z5i9c"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">米卡·鲍梅斯特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="8030" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">交叉验证是一种核心的机器学习技术，通常在在线数据科学入门课程中立即教授。这是有充分理由的，因为我们必须在真实数据上测试我们的模型，交叉验证比单个验证集单独测试更精确。然而，一个人可能会犯一个简单的错误，这个错误有时会被从业者忘记，我希望在这里快速地结束这个错误，这样你可以在将来避免它。</p><h1 id="5895" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">错误的方式</h1><p id="3e6a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">当应用一个模型时，通常有各种调谐选项可用，当然希望选择最小化一些误差特性的参数。一种方法是应用交叉验证并测试一组不同的调优参数，看哪一组给出最低的错误率。</p><p id="faca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你已经猜到了。这是错误的方式，但也仅仅是轻微的错误。这种方法的问题是，你要训练许多不同的模型，其中一些模型肯定会比其他模型做得更好，因此，通过选择性能最好的模型，并报告相应的错误率，你实际上是在选择最符合测试数据的模型。这种方法没有任何问题，因为这通常是人们为了选择最佳表现而拟合模型的方式。唯一缺少的部分是实际的测试部分，它应该用一个支持验证集或嵌套交叉验证来完成，以实际测试这个选择的模型执行得有多好。</p><p id="40e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于包含大量要素和低n的数据，该问题变得尤为明显。基于与标注的相关性选择要素并不能保证真正的相关性，因为在许多不同要素之间进行选择时，选择过程必然会发现其中一些要素与标注相关。</p><p id="f1f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们有5000000个特征和50个样本。如果我们足够努力地寻找，这些特征中有一些与标签有很高的相关性，因此看起来像是很好的预测器。</p><p id="f2f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，如果我们应用一些筛选程序，并基于标签选择有希望的特征，然后继续使用交叉验证来估计错误率，我们将能够获得非常低的错误率。问题是，筛选过程可以被认为是训练，因为我们是基于标签选择特征，并且应该执行单独的验证。</p><p id="d52b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个问题的另一个变体是使用交叉验证的模型调整。如果我们做了很多调整来改进一些评估指标，那么我们实际上是在评估过程中再次使用标签。</p><h1 id="02cc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">正确的方式</h1><p id="7d81" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">使用交叉验证选择功能，但使用保留验证集。首先使用交叉验证调整模型和功能选择，并对验证集执行最终评估。这样，实际的测试是在看不见的数据上进行的，而对误差的特征选择偏差只发生在数据集的交叉验证部分。</p><p id="6108" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要点:保留一些数据用于最终验证，对剩下的数据做任何你想做的事情。</p><h1 id="4672" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">来自注释:建议的程序</h1><p id="43e4" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">对于第一个问题，通常建议使用80/20左右的值，因此80%用于培训。</p><p id="5087" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">至于2。问题，当你以这种方式训练你的模型时，你将丢失20%数据中的任何信息。这就是能够实际测试你的模型的“代价”。但是，当所有的模型训练和选择完成后，您可以使用在整个数据集上找到的任何参数来保留模型。这样做时，您使用了所有的数据，在最终的模型中不会丢失任何信息。这些额外的数据有望改善你的模型，因为它不是基于更多的数据。</p><p id="409f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">具体来说，工作流程如下所示:</p><ol class=""><li id="f0d2" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">去掉20%进行验证。</li><li id="589e" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">对剩余的80%进行交叉验证，以选择最佳参数或类似参数。</li><li id="b5be" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">用所有80%的数据和最佳参数训练模型。</li><li id="d121" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">在20%验证集上测试模型，您可能会看到性能下降。</li><li id="5eb8" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">如果对结果满意，则在100%的数据上重新训练模型，并部署模型以供使用。</li></ol></div></div>    
</body>
</html>