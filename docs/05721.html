<html>
<head>
<title>Complete Linear Regression for Machine learning:</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的完全线性回归；</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/complete-linear-regression-for-machine-learning-e2d0583ca12e?source=collection_archive---------16-----------------------#2020-04-30">https://medium.com/analytics-vidhya/complete-linear-regression-for-machine-learning-e2d0583ca12e?source=collection_archive---------16-----------------------#2020-04-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="5ffc" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">线性回归简介:</p></blockquote><ul class=""><li id="fc65" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jp jq jr js bi translated">线性回归是基于监督学习的机器学习算法。</li><li id="c19d" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">在回归中有两种类型的变量，即因变量和自变量。</li><li id="a735" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">因变量也被称为我们试图预测的目标变量，自变量也被称为解释变量。</li><li id="f6a4" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">自变量通常用x表示；因变量用y表示。</li><li id="c553" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">回归模型将y或因变量与x的函数(即自变量)联系起来。该模型发现自变量和因变量之间的线性关系。</li><li id="6d37" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">回归的关键点是我们的依赖值应该是连续的，而不能是离散值。</li><li id="2693" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">然而，自变量或变量可以在分类或连续测量尺度上测量</li><li id="5d1b" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">所以，我们想做的是利用历史数据，利用它们的一个或多个特征，从这些数据中，建立一个模型。</li><li id="0030" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">我们使用回归来建立这样的回归或估计模型。</li></ul><blockquote class="if ig ih"><p id="30ec" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">线性回归的类型:</p></blockquote><p id="1b36" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">有两种类型的线性回归模型:</p><ul class=""><li id="313b" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jp jq jr js bi translated">简单线性回归</li><li id="4cbf" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">多元线性回归。</li></ul><blockquote class="if ig ih"><p id="8f3b" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">应用:</p></blockquote><ul class=""><li id="dcee" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jp jq jr js bi translated">回归分析的应用之一可能是在销售预测领域。您可以尝试根据独立变量(如年龄、教育程度和经验年限)来预测销售人员的年总销售额。</li><li id="664b" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">它还可以用于心理学领域，例如，根据人口统计和心理因素来确定个人满意度。</li><li id="4507" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">我们可以使用回归分析来预测一个地区的房价，基于它的大小、卧室的数量等等。</li><li id="2164" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">我们甚至可以用它来预测独立变量的就业收入，如工作时间、教育程度、职业、性别、年龄、经验年限等等。</li><li id="d409" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">事实上，您可以在这些和许多其他领域或领域中找到回归分析有用性的许多例子，如金融、医疗保健、零售等。</li><li id="d30f" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">我们有很多回归算法。它们中的每一种都有自己的重要性和最适合其应用的特定条件。</li></ul><blockquote class="if ig ih"><p id="2f25" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">简单线性回归:</p></blockquote><ol class=""><li id="9127" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jy jq jr js bi translated">简单回归是用一个自变量来估计一个因变量。</li><li id="b2df" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jy jq jr js bi translated">例如，使用任何给定汽车的发动机尺寸和气缸数量来预测二氧化碳排放量。</li></ol><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/45bff63f23c5b91bf0cacd2985c1ef6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*i3UuTdBnoxR-GJHE9yezqQ.jpeg"/></div></figure><p id="84b2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">在简单线性回归中，我们使用如下数学函数对数据建模:</p><p id="2e4a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">y = B0 + B1 * x</p><p id="e2c4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">在哪里，</p><p id="fc5c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">y→因变量</p><p id="ca40" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">x→独立变量</p><p id="639e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">B0→截距，在机器学习中也叫偏差</p><p id="db15" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">B1→斜率，Y值相对于x值的变化如何变化</p><p id="e6ad" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">B0和B1也叫线性方程系数。</p><p id="810f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">4.在简单线性回归中，我们画一条最适合数据的直线，用这条直线我们预测因变量。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kh"><img src="../Images/11b6ad6206e3f2afd5dc941708e8049d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a4TZt84u3X8oOD1OAHX_mg.jpeg"/></div></div></figure><h2 id="8f2f" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">现在的问题是:“你如何通过这些点画一条线？”以及，“你如何确定哪条线‘最适合’？”</h2><p id="3c08" class="pw-post-body-paragraph ii ij hi il b im lh io ip iq li is it jj lj iw ix jl lk ja jb jn ll je jf jg hb bi translated">线性回归估计直线的系数。这意味着我们必须计算B0和B1，以找到“拟合”数据的最佳直线。</p><p id="f14c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">要回答第二个问题，我们需要找到误差(也叫残差)。误差是从数据点到拟合回归线的距离。</p><p id="048e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">所有残差的平均值显示了线与整个数据集的拟合程度。</p><p id="50de" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">我们的目标是找到一条使所有这些误差的平均值最小的直线。</p><p id="0209" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">线性回归的目标是最小化这个MSE(均方误差)方程，为了最小化它，我们应该找到最佳参数B0和B1。</p><h2 id="73c6" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">现在的问题是，如何找到B0和B1，使得这个误差最小？</h2><p id="7c9e" class="pw-post-body-paragraph ii ij hi il b im lh io ip iq li is it jj lj iw ix jl lk ja jb jn ll je jf jg hb bi translated">→我们有两种选择:</p><p id="4381" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">1 -我们可以使用数学方法。或者，</p><p id="c928" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">2 -我们可以使用优化方法。</p><blockquote class="lm"><p id="7a54" class="ln lo hi bd lp lq lr ls lt lu lv jg dx translated">顺便说一下，你真的不需要记住计算这些参数的公式，因为Python、R和Scala中用于机器学习的大多数库都可以很容易地为你找到这些参数。但是了解它是如何工作的总是好的。</p></blockquote><p id="0f91" class="pw-post-body-paragraph ii ij hi il b im lw io ip iq lx is it jj ly iw ix jl lz ja jb jn ma je jf jg hb bi translated">多元线性回归:</p><ol class=""><li id="d7c1" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jy jq jr js bi translated">多元回归是指用一个或多个自变量来估计因变量。这里自变量可以是连续的，也可以是分类的。</li><li id="60d0" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jy jq jr js bi translated">例如，使用任何给定汽车的发动机尺寸和气缸数量来预测二氧化碳排放量。</li></ol><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/fb48ab446b170bd4813dd4dab1f919d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*b1woKJ3I3YmxRZeURkhxlA.jpeg"/></div></figure><p id="1453" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">3.在多元线性回归中，我们使用如下数学函数对数据进行建模:</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es mb"><img src="../Images/0e607aa01f6be17167dbb08d67d2c9e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4Sn9Gi11gotJA5HCM5ABw.jpeg"/></div></div></figure><p id="d518" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">4.多元线性回归中的直线称为平面或超平面</p><h2 id="44ab" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">什么时候应该用多元线性回归？</h2><p id="8c28" class="pw-post-body-paragraph ii ij hi il b im lh io ip iq li is it jj lj iw ix jl lk ja jb jn ll je jf jg hb bi translated">当我们想要确定自变量对因变量的影响强度时，可以使用它。</p><p id="a2b7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">其次，它可以用来预测变化的影响。也就是理解当我们改变自变量时，因变量是如何变化的。</p><h2 id="d58e" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">现在的问题是，如何以最小化误差的方式找到系数？</h2><ul class=""><li id="df34" class="jh ji hi il b im lh iq li jj mc jl md jn me jg jp jq jr js bi translated">有许多方法可以估计这些系数的值。</li><li id="f8d4" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">最常见的方法是普通最小二乘法和最优化方法。</li><li id="0fb5" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">普通最小二乘法试图通过最小化“均方误差”来估计系数的值但是，对于大型数据集，这需要很长时间。</li><li id="02a1" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">为了克服普通最小二乘法的缺点，可以采用优化算法。如果数据集很大，梯度下降是一种优化算法和最佳方法。</li></ul><h2 id="b166" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">在预测中我们应该使用多少个独立变量？</h2><p id="6900" class="pw-post-body-paragraph ii ij hi il b im lh io ip iq li is it jj lj iw ix jl lk ja jb jn ll je jf jg hb bi translated">使用太多独立变量进行预测可能会导致模型过度拟合。过拟合模型在训练数据集中给出了高精度，但是在测试期间精度非常低。为了避免过度拟合，有各种技术可用。例如，交叉验证、集合、正则化等。</p><blockquote class="if ig ih"><p id="d20e" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">模型评估</p></blockquote><p id="40a3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">以下是我们可以用来评估模型的方法:</p><ol class=""><li id="00e2" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jy jq jr js bi translated">训练和测试相同的数据集。</li><li id="6e25" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jy jq jr js bi translated">训练/测试分割</li><li id="e005" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jy jq jr js bi translated">k倍交叉验证</li></ol><h2 id="216b" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">训练和测试相同的数据集:</h2><ul class=""><li id="dce3" class="jh ji hi il b im lh iq li jj mc jl md jn me jg jp jq jr js bi translated">在这种方法中，我们训练整个数据集，并且在训练之后，我们提取数据集的一部分用于测试。</li><li id="ceb1" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">这种评估方法很可能具有高的“训练精度”和低的“样本外精度”，因为模型知道来自训练的所有测试数据点。</li><li id="cc57" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">“训练准确性”是模型在使用测试数据集时做出的正确预测的百分比。这可能导致过度拟合。</li><li id="479e" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">“样本外准确性”是模型使用不属于训练数据集的数据进行正确预测的百分比。</li></ul><h2 id="29b4" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">训练/测试分割:</h2><ul class=""><li id="0b2f" class="jh ji hi il b im lh iq li jj mc jl md jn me jg jp jq jr js bi translated">具有高的样本外准确度非常重要。为了实现这一点，我们可以使用另一种称为训练/测试分割的方法。</li><li id="114b" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">在这种方法中，我们将数据集分成两个具有一定比例的数据集，例如80:20表示数据集的80%将用于训练，20%将用于测试。</li><li id="c8ab" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">训练/测试分割的问题是，它高度依赖于训练和测试数据的数据集。这种变化导致训练/测试分割比在同一数据集上训练和测试具有更好的样本外预测，但由于这种依赖性，它仍然存在一些问题。</li></ul><h2 id="acd1" class="km kn hi bd ko kp kq kr ks kt ku kv kw jj kx ky kz jl la lb lc jn ld le lf lg bi translated">k倍交叉验证</h2><ul class=""><li id="47a2" class="jh ji hi il b im lh iq li jj mc jl md jn me jg jp jq jr js bi translated">这种方法解决了上述两种方法中发现的问题。</li><li id="f90d" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">让我们理解这种方法的工作原理，如果我们设置k=4，那么我们在相同的数据集上进行4次迭代的训练和测试操作。</li><li id="eb8d" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">在第一次迭代中，我们使用数据集的前25%进行测试，其余全部用于训练。在第二次迭代中，我们使用接下来25%的数据进行测试，以此类推。并且在所有迭代之后，我们计算所有迭代的准确度的平均值。</li></ul><figure class="ka kb kc kd fd ke er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es mf"><img src="../Images/ad39287bd13aaafc5bdef9b1d150295a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3RJA9yDr1ZHNaXySXAKilg.jpeg"/></div></div></figure><blockquote class="if ig ih"><p id="1eaa" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">评估指标或准确性指标</p></blockquote><ul class=""><li id="bfda" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jp jq jr js bi translated">它用于检查我们模型的性能。</li><li id="c0b2" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">通常，我们通过比较实际值和预测值来计算回归模型的准确性。</li><li id="49ff" class="jh ji hi il b im jt iq ju jj jv jl jw jn jx jg jp jq jr js bi translated">以下是我们可以使用的评估指标:</li></ul><ol class=""><li id="2535" class="jh ji hi il b im in iq ir jj jk jl jm jn jo jg jy jq jr js bi translated">平均绝对误差(MAE):</li></ol><p id="db22" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">平均绝对误差是误差绝对值的平均值。</p><p id="6512" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">2.均方差(MSE):</p><p id="0f4f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">均方误差(MSE)是平方误差的平均值。</p><p id="ac51" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">3.均方根误差(RMSE):</p><p id="cec2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">均方根误差(RMSE)是均方误差的平方根。这是最受欢迎的评估指标之一。</p><p id="235c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">4.相对绝对误差(RAE):</p><p id="8d2d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">它也称为残差平方和，取总绝对误差并通过除以样本预测值的总绝对误差进行归一化。</p><p id="e25f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">5.相对平方误差(RSE):</p><p id="6f09" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">它与“相对绝对误差”非常相似，但被数据科学界广泛采用，因为它用于计算R平方。</p><p id="ef69" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">r平方不是一个误差，而是一个衡量模型准确性的常用指标。它表示数据值与直线的拟合程度。</p><p id="17aa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jj iv iw ix jl iz ja jb jn jd je jf jg hb bi translated">R平方值越高，模型就越符合您的数据。</p></div></div>    
</body>
</html>