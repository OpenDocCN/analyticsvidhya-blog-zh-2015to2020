<html>
<head>
<title>How to easily deploy your machine learning model into the cloud.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何轻松地将您的机器学习模型部署到云中。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-deploy-your-machine-learning-model-in-the-cloud-87d3451a466d?source=collection_archive---------6-----------------------#2020-04-11">https://medium.com/analytics-vidhya/how-to-deploy-your-machine-learning-model-in-the-cloud-87d3451a466d?source=collection_archive---------6-----------------------#2020-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d90666c1a0ebf11d3609030974df4812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k8aJ-6-2-SAyTqE3yNBV5g.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae iu" href="https://wallpaperaccess.com/" rel="noopener ugc nofollow" target="_blank">https://wallpaperaccess.com</a></figcaption></figure><p id="b010" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在中间件公司和创业公司中，人们希望数据科学家做从数据预处理到模型生产的所有事情。因此，如果你是一个初级的ML工程师，想开发一个产品，或者对部署他们的模型感兴趣，那么你来对地方了。</p><p id="d7fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在继续之前，我将使用亚马逊AWS免费EC2服务来启动一个实例，你需要有一个有效的借记卡或信用卡来创建一个AWS帐户。</p><p id="acfe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">让我们开始吧！！。</em></p><h1 id="4ee7" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">总体而言，我们将采取以下措施:</h1><p id="72d6" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">1.为我们的模型编写推理代码。<br/> 2。使用Flask创建简单的web API。<br/> 3。用Docker容器化应用程序。<br/> 4。在EC2实例上运行Docker容器。</p><p id="4ab3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你以前从未听过这些术语，没关系。我试着详细解释它们，这至少是一个好的开始。</p><p id="45c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我使用推特上的数据将这条推特归类为与灾难相关的推特。请找到数据集<a class="ae iu" href="https://www.kaggle.com/c/nlp-getting-started/data" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><h2 id="56d7" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">最终结果:</h2><p id="f7bb" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">使用样本输入进行检查。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/7dd7c54e5e5db22cf46974209ab7b780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GJUpA3s6Y6y6cGjwGNHd0w.png"/></div></div></figure><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/b9cad9063ac9f6b947512867d4f9c644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m4KeZ5Hj86gQAqAu3VpwlA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:结果</figcaption></figure><p id="3cac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">看到结果是一个好主意，我们将从用户那里获得3个输入，并预测推文是否与灾难有关。请注意IP地址是全球运行的，可以从任何地方访问。</p></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><h1 id="0d07" class="ju jv hi bd jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn mc kp kq kr bi translated">1.构建机器学习模型:</h1><p id="85e0" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">让我们首先建立一个简单的机器学习模型，我选择这个数据集是为了理解编写推理代码的重要性。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">显示训练我们的模型所需的所有库</figcaption></figure><p id="486c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我导入了我们的模型所需的一些库。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">要素的矢量化</figcaption></figure><p id="94b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了简单起见，我用空值填充缺失的值。现在在数据中，我们有两个分类特征和一个文本特征。因此，我在分类特征上安装了一个简单的计数矢量器，在文本数据上安装了TFIDF矢量器。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">为XGBoost算法定型</figcaption></figure><p id="899f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我正在堆叠所有的特性，并在我们的模型上安装一个简单的XGBoost算法。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="552e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果不进行预处理和超参数调整，我们只能获得72%的准确率。<strong class="ix hj"> <em class="jt">目前，我们的目标不是打造超模，而是部署训练有素的模特。</em> </strong> <em class="jt"> </em>因此我现在不打算改进这个模型。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">推断所需的Pickle文件</figcaption></figure><p id="b544" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们保存这些文件，因为推断需要这些文件</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">推理代码</figcaption></figure><p id="ca09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，给定pickle文件，我们可以加载pickle文件，并通过调用predict函数预测模型的输出，如上所示，</p></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><h1 id="05db" class="ju jv hi bd jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn mc kp kq kr bi translated">2.建筑烧瓶API:</h1><h2 id="43b6" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">创建简单的API:</h2><p id="9a7c" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">在开始构建您的API之前，让我向您展示一个Flask如何工作的例子。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">简单烧瓶代码</figcaption></figure><p id="f89c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们在端口3000上创建我们的服务器，它监听我们的HTML请求。如果我们收到任何对我们家乡路线的请求，我们将返回消息“Hello World！”。</p><p id="bc29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在转到您选择的任何命令行，将目录切换到当前项目并键入</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="b2c7" class="kx jv hi mg b fi mk ml l mm mn">python app.py.</span></pre><p id="0046" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您应该看到一个服务器正在启动。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/e5bee2d8ef15b021a8b4dec54ada9c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wovSCU5bKVjeMjTAD28G-g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">控制台输出</figcaption></figure><p id="b717" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在转到您的浏览器，键入以下IP地址:localhost:3000，您将得到“Hello World！”的输出</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/77dfec02fdfd82d587038d293d0ebca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*1szcVbPuzyQqhHzc4xmiuQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">本地主机上的浏览器:3000</figcaption></figure><h2 id="ab5c" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">创建一个简单的HTML表单来发送post请求表单数据:</h2><p id="c64f" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">制作一个简单的HTML表单，可以包含三个输入字段:位置、关键字、消息和提交按钮。当提交表单时，它会向'/predict' route发出post请求。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/6f248a127210430542fd0117c5d0805a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YuGHi7iC0i2U4LkKBAX25w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5:带有三个字段位置、关键字和消息的HTML文件，带有一个表单提交按钮</figcaption></figure><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5:制作样本表单的HTML代码</figcaption></figure><h2 id="9d67" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">创建应用程序路线</h2><ol class=""><li id="cc3a" class="mr ms hi ix b iy ks jc kt jg mt jk mu jo mv js mw mx my mz bi translated">当用户转到localhost:8080/index时，他应该被重定向到表单页面</li><li id="afae" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js mw mx my mz bi translated">当表单提交后，我们应该能够得到表单页面的数据。</li></ol><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="98f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建两个文件夹工件和模板，将index.html文件放在模板中，将所有pickle文件放在工件文件夹中，并在同一个app.py文件中创建两条路径索引和预测。</p><p id="2a2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们转到localhost:8080/index时，我们将加载我们已经创建的index.html文件。</p><blockquote class="nf ng nh"><p id="462c" class="iv iw jt ix b iy iz ja jb jc jd je jf ni jh ji jj nj jl jm jn nk jp jq jr js hb bi translated">render_template在templates文件夹中查找HTML文件，因此创建templates文件夹很重要。</p></blockquote><h2 id="a019" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">创建一个可以从表单页面获取输入并做出预测的函数</h2><p id="4351" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">注意:在我们的HTML中，表单发布到'/predict' route。默认情况下，Flask中的每个路由都有一个“get”方法。因此，我们必须在函数装饰器中声明，我们正在侦听'/predict' route上的post请求。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">完整的烧瓶API代码</figcaption></figure><p id="fd33" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我们最后的Flask Web API代码，我们正在加载我们的模型被训练的pickle文件。对每个要素应用变换方法，然后将所有要素叠加在一起。现在，给定查询点的数据，我们将根据之前训练的模型对该点进行预测。将0.5作为阈值，我们将根据预测值返回一条简单的消息。</p><p id="9d83" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们运行我们的服务器去命令行并运行你的python代码</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="969f" class="kx jv hi mg b fi mk ml l mm mn">python app.py</span></pre><p id="1ad3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在转到您的浏览器，键入URL localhost:8080/index，键入您想要的任何内容，然后单击submit，您将获得结果。</p><p id="46e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">图5:检查模型行为的示例输入，将示例数据插入到相应的字段中，然后单击submit</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nl"><img src="../Images/ed9c410e30fdb36c72f86527d34d250c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdQo9KPfxn2TBQEjcyEdtg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:最终结果</figcaption></figure><p id="73e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在的问题是它只能从我们的本地系统访问。如果有人想运行预测，他/她应该到你家，运行服务器，输入输入，得到结果，然后返回…这是难以想象的，所以我们将通过将这些代码部署到云中来解决这个问题，这样任何地方的任何人都可以访问这个页面。</p></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><h1 id="b798" class="ju jv hi bd jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn mc kp kq kr bi translated">3.创建Dockerfile文件</h1><h2 id="2d2a" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">docker是什么？</h2><p id="c96f" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">我们在本地系统上运行我们的模型，本地系统有一些操作系统、内存、硬盘和一堆正在运行的可执行文件。我们用自己的系统看电影，回复邮件，创建自己的服务器。</p><blockquote class="nf ng nh"><p id="9165" class="iv iw jt ix b iy iz ja jb jc jd je jf ni jh ji jj nj jl jm jn nk jp jq jr js hb bi translated">但是，如果我们只是想推出一个服务器，我们需要我们的整个本地系统。要运行我们的模型，我们几乎不需要200MB或更少的内存。最近你会得到专门用于运行我们服务器的200兆内存系统吗？。</p><p id="5484" class="iv iw jt ix b iy iz ja jb jc jd je jf ni jh ji jj nj jl jm jn nk jp jq jr js hb bi translated">如果你正在尝试构建一个python2.7支持的机器学习模型，而你的python版本是3.0以上，你将如何处理这种情况？<strong class="ix hj"> Docker帮助我们非常容易地做到这一点。</strong></p></blockquote><p id="937b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们的示例中，我们只需要安装python、pip库(Flask、XGBoost、Sklearn库等)。想象一下，有一个盒子，里面正好有这些软件库，足以让我们运行我们的模型。Docker帮助我们创建这些盒子，这些盒子被称为容器。我们可以创建任意多的盒子，并且可以在任何系统中同时运行。</p><p id="508b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">足够的理论让我们创建我们的第一个docker文件。在当前项目目录中创建一个同名文件‘docker file’和测试文件requirements.txt。</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Docker文件来封装我们需要的应用程序和代码。</figcaption></figure><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们顺利运行模型所需的库。</figcaption></figure><p id="98be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我们的Docker文件的样子，我们总共有9个步骤</p><ul class=""><li id="a859" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">从Docker存储库中获取Python 3.5包。</li><li id="079d" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">设置维护者名称。</li><li id="72e0" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">设置用户名— root</li><li id="45ed" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">在文件夹应用程序中创建工作目录。</li><li id="8a2c" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">将当前目录中的所有文件添加到docker容器中。(圆点表示每个文件)。</li><li id="27e3" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">构建我们的python3顺利工作所需的环境。</li><li id="be2e" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">运行pip安装<library name="" inside="" requirements.txt=""/></li><li id="c0b1" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">入口点:所以当我们运行docker容器时(我们将在一段时间内完成),它将运行下面的命令“python app.py ”,所以当这个命令运行时，它将启动Flask API代码，并将为我们启动一个服务。</li></ul><h1 id="ceee" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">3.创建并登录到EC2实例。</h1><ul class=""><li id="88d8" class="mr ms hi ix b iy ks jc kt jg mt jk mu jo mv js np mx my mz bi translated">登录AWS控制台，搜索EC2服务:</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nq"><img src="../Images/99e3d8b86d36cd331567b93c2d1d0282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WwGZoNDAt_mKk5igB6-1hQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:AWS控制台。突出EC2服务</figcaption></figure><ul class=""><li id="d850" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">创建启动实例，您应该会看到下面的屏幕:</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nr"><img src="../Images/d452e7a16803b3771285faa6d6e8f22a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDa9f04OQVqQYWiFDX3xuw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:亚马逊Linux 2实例</figcaption></figure><ul class=""><li id="ba61" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">选择符合免费层条件的实例(Amazon Linux 2 ),这样就不会产生不必要的费用。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ns"><img src="../Images/de1d8302bcacba4b24298577c571dc69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dlER5UL_pxpO6SmLgrGoqQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:实例类型:t2.micro</figcaption></figure><ul class=""><li id="379b" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">单击通用t2.micro，然后单击查看和启动，然后启动。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nt"><img src="../Images/27aa0b25007c7cc68290c03e73f10404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gh5n2JplMWVD1WVMQpRtJw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:密钥对窗口。</figcaption></figure><ul class=""><li id="acd0" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">选择创建新的密钥对，并给出一个密钥对名称。单击下载密钥对。密钥对文件(MyInstance.pem)将在内部加密一个私有密码。这个文件是我们以后登录EC2实例所必需的。单击启动实例，您应该会看到下面的屏幕。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nu"><img src="../Images/8e51656dab42ab14826a06dc85c01180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z7pQrvKP6v9QQHtR26x_MQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:实例启动确认</figcaption></figure><ul class=""><li id="cb5d" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">单击实例ID(在我的例子中是<a class="ae iu" href="https://us-east-2.console.aws.amazon.com/ec2/v2/home?region=us-east-2#Instances:search=i-0fb941687a619ef41;sort=instanceId" rel="noopener ugc nofollow" target="_blank"> i-0fb941687a619ef41 </a>)。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ns"><img src="../Images/87e80c9465466747b3509039d63616aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2ax9fxiMbS82J4SHQgPaw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3:当实例准备好使用时，实例状态将变为运行中。</figcaption></figure><ul class=""><li id="ad20" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">我们必须为实例配置安全组。安全组告诉哪些用户可以访问哪个系统，目前我们希望世界上的每个人都能看到我们的模型。所以我们会通过增加一些规则让它对世界开放。</li><li id="b523" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">单击左侧菜单栏上的安全组。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/0f6833f459c883e1dec73df34ff7d6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*E2YnCmWPvAV9D9T0d4vFcw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:显示左侧菜单中的安全组。</figcaption></figure><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nw"><img src="../Images/4bd3ceacc4023223f4808df6327f1324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5SKP7dDvOcVPYcq6CJXgBg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:安全组的入站规则</figcaption></figure><ul class=""><li id="2c7b" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">给出任何描述和名称。点击入站-&gt;添加规则</li><li id="a41a" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">类型:自定义TCP，端口范围:0–65535，源任意位置，然后单击创建。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/a6c239866349069103d3680916b5bb63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*KU6Y8ipF7Z6Jp8fAZya1xg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:更改当前实例的安全组。</figcaption></figure><ul class=""><li id="d82e" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">选择实例右键-&gt;单击网络-&gt;更改安全组，然后选择您创建的安全组。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/9a4517ec123a7988b0dc7422843543d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*CBzKfcgEE2Brv5DpYLiXrA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:选择适当的安全组。</figcaption></figure><ul class=""><li id="46c7" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">现在实例已经配置好了，我们需要登录实例并创建docker映像。</li><li id="b753" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js np mx my mz bi translated">单击Connect to the instance，您将看到一个ssh命令，复制ssh命令。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nx"><img src="../Images/f45929db91a630ce35535299864f3ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1B7456uzSIeqjgLMnvdCA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5:SSH命令，我们将使用它来登录我们的AWS。</figcaption></figure><ul class=""><li id="5433" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">打开任何终端并运行下面的代码，确保您位于。pem文件存在，您已经下载了该文件。</li></ul><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ny"><img src="../Images/2f37b994a778f3081c4e03ae9a78939c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2DgvFgHSfKmm6YFyy2odw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:MyInstance.pem文件位于D-drive的文件夹中</figcaption></figure><ul class=""><li id="2f96" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">将终端的目录更改为目录，并运行您复制的命令。</li></ul><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="ceb8" class="kx jv hi mg b fi mk ml l mm mn">cd '&lt;Your directory&gt;'<br/>ssh -i "&lt;Name&gt;.pem" ec2-user@&lt;Host IP address&gt;</span></pre><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/4733d229bb689013522b06ec6a5119c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*aqGp2ibN4f-hz_eDp3WSJA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:成功登录。</figcaption></figure><ul class=""><li id="e08c" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">如果您可以看到上面的屏幕，那么您已经成功登录。</li></ul></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><h1 id="0e27" class="ju jv hi bd jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn mc kp kq kr bi translated">4.创建Docker容器并运行它:</h1><p id="50b5" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">为了简单起见，我复制了GitHub中的代码，并将它克隆到当前的amazon实例框中。</p><p id="803c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在此之前，您需要在该实例中安装git:</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="05d3" class="kx jv hi mg b fi mk ml l mm mn">sudo yum install git</span></pre><p id="2a57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Sudo提供安装git的管理员权限。YUM是一个用于Linux操作系统的包管理工具。</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="b8ed" class="kx jv hi mg b fi mk ml l mm mn">git clone <a class="ae iu" href="https://github.com/GowthamChowta/Disaster_tweet.git" rel="noopener ugc nofollow" target="_blank">https://github.com/GowthamChowta/Disaster_tweet.git</a></span></pre><p id="eb41" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它会要求您提供git凭证，请输入您的电子邮件和密码。如果您不想这样做，您可以使用SCP(安全复制)将您的文件从本地实例复制到Linux系统，方法是使用以下命令。</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="5db6" class="kx jv hi mg b fi mk ml l mm mn">scp -r -i "myinstance.pem" ./Disaster\ tweet ec2-user@ec2-3-15-207-43.us-east-2.compute.amazonaws.com​ :~/</span></pre><p id="5eff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完成上述步骤后，您应该会在Linux实例中看到您的文件夹。键入ls，您应该会看到一个文件夹Disaster_tweet。(LS-列出目录)</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="fd6f" class="kx jv hi mg b fi mk ml l mm mn">$ ls<br/>#output: Disaster_tweet</span></pre><p id="87a3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们安装docker(-y标志表示在安装过程中对所有的是/否问题都回答是)。</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="4cc9" class="kx jv hi mg b fi mk ml l mm mn">sudo yum install -y docker</span></pre><ul class=""><li id="b42e" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">启动docker服务</li></ul><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="3882" class="kx jv hi mg b fi mk ml l mm mn">sudo service docker start</span></pre><ul class=""><li id="e984" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">码头信息</li></ul><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="2b08" class="kx jv hi mg b fi mk ml l mm mn">docker info</span></pre><ul class=""><li id="cea2" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">当您运行上面的命令时，您会得到一个错误，提示您需要管理员权限来运行代码。每次在docker命令中添加SUDO都很烦人，让我们给docker SUDO特权吧。</li></ul><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="e426" class="kx jv hi mg b fi mk ml l mm mn">sudo usermod -a -G docker $USER</span></pre><p id="1921" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt"> usermod </em>将帮助我们给予当前用户组的docker<em class="jt">sudo</em>权限，这意味着你不必每次在docker行上运行docker命令时都键入sudo。</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="a455" class="kx jv hi mg b fi mk ml l mm mn">docker info</span></pre><p id="27a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，如果你已经成功安装了docker，你会看到很多关于Docker当前版本和你拥有的容器数量的信息。注意:如果以上仍然不起作用，请从实例中注销并登录。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/26fe843bb0c24fccaf13def44a5eb3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*E_PH0ope737CHzID2E-foQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:Docker信息输出。我们目前有0个容器。</figcaption></figure><ul class=""><li id="0253" class="mr ms hi ix b iy iz jc jd jg nm jk nn jo no js np mx my mz bi translated">将目录切换到Disaster_tweet文件夹，并键入ls以查看所有文件</li></ul><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="96c2" class="kx jv hi mg b fi mk ml l mm mn">cd Disaster_tweet/<br/>ls</span></pre><p id="d1b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您的输出应该类似于:</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nz"><img src="../Images/f73003d2b20d180923b3ffdb0fe865ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OtoJpVvdMy8ljWVcOcHf0w.png"/></div></div></figure><p id="ebea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用下面的代码构建我们的第一个容器:</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="7d79" class="kx jv hi mg b fi mk ml l mm mn">docker build -t disasterapp .</span></pre><p id="429a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们正在构建一个docker容器，-t标志将帮助我们将这个容器的名称设置为diasterapp。让我们希望我们的应用程序不会是灾难:)。</p><blockquote class="nf ng nh"><p id="b3e1" class="iv iw jt ix b iy iz ja jb jc jd je jf ni jh ji jj nj jl jm jn nk jp jq jr js hb bi translated">注意有圆点(。)在命令行代码的末尾。</p></blockquote><p id="af9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将用我们当前目录中的所有文件构建一个docker容器，首先，它查找Dockerfile并运行Dockerfile中的代码。它有9个步骤，我们在上面讨论过，它将依次执行它们。如果成功，你会在最后得到一条消息说成功构建。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es oa"><img src="../Images/c0f4aa23c1dd31841e97169e9b87ded3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OheeyKrpXt1s99VDMz639w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图:Docker应用程序成功构建</figcaption></figure><p id="2caf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是时候运行我们的docker容器了:</p><pre class="lm ln lo lp fd mf mg mh mi aw mj bi"><span id="09f2" class="kx jv hi mg b fi mk ml l mm mn">docker run -p 80:3000 disasterapp</span></pre><p id="ab22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里p代表端口，这里我们将虚拟机的端口80与docker的端口3000链接起来。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ob"><img src="../Images/20e482c92f05f66b8485acdb01618145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YEitTGaScyRu4rZqsyVMg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在docker的3000端口上运行的Flask服务器。</figcaption></figure><p id="22d8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您将会看到一条类似的消息，与我们之前在本地系统中看到的一样。</p></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><h2 id="2f8d" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">结果:</h2><p id="211d" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">我们完成了！！祝贺您，让我们检查一下输出:</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ns"><img src="../Images/ec966313866c78ab05c26f646eb0f8c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktbHuF31NgQnerGjJg709A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">EC2实例公共IPV4地址。</figcaption></figure><p id="7618" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">转到您的实例，复制IPV4公共地址并在浏览器中键入。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es oc"><img src="../Images/9c7304cf6601e36bc8a98843eb1edc3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bLCtW6OntaE-n2b7NIxMQw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">回家路线(/)</figcaption></figure><p id="c351" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用样本输入进行检查。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/7dd7c54e5e5db22cf46974209ab7b780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GJUpA3s6Y6y6cGjwGNHd0w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">索引路线(/index)</figcaption></figure><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/b9cad9063ac9f6b947512867d4f9c644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m4KeZ5Hj86gQAqAu3VpwlA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们的预测函数在云实例上的输出。</figcaption></figure><p id="5f5e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在这个GitHub <a class="ae iu" href="https://github.com/GowthamChowta/Disaster_tweet" rel="noopener ugc nofollow" target="_blank">链接</a>中找到完整的代码。你也可以在<a class="ae iu" href="https://www.linkedin.com/in/gauthamchowta/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上和我联系。</p><h2 id="1390" class="kx jv hi bd jw ky kz la ka lb lc ld ke jg le lf ki jk lg lh km jo li lj kq lk bi translated">参考资料:</h2><ol class=""><li id="fae9" class="mr ms hi ix b iy ks jc kt jg mt jk mu jo mv js mw mx my mz bi translated"><a class="ae iu" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">应用人工智能课程</a></li><li id="ff7a" class="mr ms hi ix b iy na jc nb jg nc jk nd jo ne js mw mx my mz bi translated">Linux学院AWS。</li></ol><p id="09e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">乐意帮忙！！。</p></div></div>    
</body>
</html>