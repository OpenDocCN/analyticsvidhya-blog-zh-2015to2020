<html>
<head>
<title>Book Management System with Python &amp; SQLite3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 Python 和 SQLite3 的图书管理系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sql-based-book-management-system-in-python-1f7e20c2bced?source=collection_archive---------1-----------------------#2020-10-08">https://medium.com/analytics-vidhya/sql-based-book-management-system-in-python-1f7e20c2bced?source=collection_archive---------1-----------------------#2020-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6592b344ff974fa7c449fc94990538be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cBf48Dn3p66y6agtj9yBRw.jpeg"/></div></div></figure><p id="dd8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将介绍如何用 Python 构建一个基于 SQL(结构化查询语言)的图书管理系统，并提供一个集成的图形用户界面。</p><p id="57d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您需要为此程序导入一些 python 库:</p><ul class=""><li id="81f9" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">numpy</li><li id="ac0d" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">sqlite3</li><li id="59d7" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">json</li><li id="71eb" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">easygui</li><li id="331d" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">平台</li><li id="ad8e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">模糊的</li><li id="3bed" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">一团</li></ul><p id="f9cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在我继续之前，让我给你一个简短的介绍。你可能想知道…为什么是 easygui？为什么不选择 Tkinter 或 PyQt 来制作 GUI 呢？良好的..大约一年前，我无法用 python IDE 打印“hello world ”,也不知道 IDE 是什么。大约在 2019 年底，在没有任何领域知识的情况下，我参加了一个数据科学训练营，并开始熟悉 python 编程语言，所以我仍然非常缺乏经验。</p><p id="ce60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当您构建一个为最终用户设计的程序时，通常他们不喜欢通过 cli(命令行)环境来操作它。用户想按下按钮，看起来很好，程序必须最好是直观和易于导航。</p><p id="cb6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于我的经验有限，我偶然发现了 easygui 库，我发现它非常容易使用。这可能是我关于使用 easygui 的最后一篇文章，因为我不想停滞在这个库上，但是我想向那些没有什么经验的人展示用 easygui 围绕一个程序构建一个 gui 是多么容易。事不宜迟，让我们开始吧:</p><p id="c56a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将在这个程序中使用的数据是我自己编译的一个. json 文件。虽然很少，但也够用了。如果你愿意的话，可以随意编译和使用你自己的，只要确保格式不变。你可以随便给它起什么名字。小心保存。py 和。json 文件放在同一个位置。下面是 books.json 文件的快速视图:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/662a852ab2e21f539824ec7562f2f83d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mjZaRLI99Kj9Wjp9U1M3iw.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">书籍. json</figcaption></figure><p id="8b16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">JSON 键是不言自明的，但是让我们快速浏览一下:</p><p id="29c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">id:图书 id(例如，这也可以更改为 ISBN)</p><p id="1b16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">标题:书名</p><p id="ef19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作者:图书作者</p><p id="6b3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数量:账面数量</p><p id="e031" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，现在让我们启动 IDE，开始导入上面提到的 python 库:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/e21d51ac15b6fab71c8c430b43c67ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bN6GSUK-857FT68maFB_aw.png"/></div></div></figure><p id="d361" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该程序由 27 个函数组成。当你运行程序时，只有一个名为‘which _ way()’的函数被调用。从那里开始，根据用户输入，从其他函数中调用替代函数。我不会在这里一一介绍，因为有一些相似之处，但是我会把它们都包含在源代码中。</p><p id="52a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看第一个:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/f7cb0ea221dcf98b1629178b43e2bdbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQyR7_W_Tik8JkQhjJjV-A.png"/></div></div></figure><p id="53c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个函数产生图书管理器的主菜单。因为这个程序只包含函数，所以我们将一些变量声明为全局变量，以便它们在被其他函数引用时可用。</p><p id="2783" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了简单起见，在测试 GUI 时，我将登录名设置为“admin ”,密码设置为“1234 ”,如上面第 26/27 行所示。你可以随意改变。在保存登录，密码和初始化'布尔'变量为'真'之后，我们定义 easygui choicebox 参数，它设置显示文本和选项。</p><p id="6a05" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用户输入(文本(字符串)或用户点击的选项)保存在“字段值”变量中。如果用户选择从一个. json 文件上传创建一个新的数据库，布尔变量被设置为‘False ’, log in _ window(布尔)函数被调用。</p><p id="3461" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者，如果用户选择从上一个会话停止的地方继续，他们可以通过选择“在现有数据库上继续”选项来加载 existing _db 文件，这将调用 login_window(boolean)函数，并将布尔变量设置为 True。然而，如果用户按下取消，程序终止。</p><p id="462d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下是运行程序时 GUI 主菜单的快照:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/c0b17255e24cd752c86bfec29a43553b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-fm0pSCU_Nw6fFeJ-dR7TA.png"/></div></div></figure><p id="d374" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对，所以无论用户在主菜单中点击哪个选项(除了取消)… login_window(boolean)都会被调用，下面的窗口会出现，提示用户输入登录名和密码:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/e602c017bd4429f509cd5a15209e73fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_4c5EsOdlM6ol6j1zJvow.png"/></div></div></figure><p id="2607" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来看看“登录窗口(布尔)”函数:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/d44ebe50a8c9287ae6c11a27a8b9732c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_Hc4TAMsdOWXMY1vB0t8g.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">login_window(布尔值)</figcaption></figure><p id="dca4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，在这种情况下，GUI(easygui multpasswordbox)需要定义其显示参数。这就是第 54-56 行的内容。然后我们调用一个名为‘field _ check _ MPB(msg，title，field names)’的函数。这个坏男孩所做的是它产生了一个登录许可窗口，用户需要在这里输入登录名和密码，它还会检查缺失的字段条目。让我们快速浏览一下:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/d1836388973aa8a9876c0794fb3796fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vq1xXHhY0BmgpyMEcfIypw.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">field_check-mpb()</figcaption></figure><p id="ef09" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个特定函数的内容(第 385–394 行)来自 easygui 文档。首先，easygui 'multpasswordbox()'被调用，它产生登录/密码输入框，其参数在前面的 login_window(boolean)函数中定义。如果用户将登录或密码字段留空，基本上他们将陷入一个循环，并被要求输入缺少的字段，如下图所示:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/f7e79ad2d61c055f5e9072131e3b1774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GQIhvByasXxCEYrAs_txg.png"/></div></div></figure><p id="4ae3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果两个字段都被输入，并且用户按下 OK，用户输入将被保存为 fieldValues 变量中的列表，并且将被返回到先前的 login_window(boolean)函数，以便在第 63 行进一步处理。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/d44ebe50a8c9287ae6c11a27a8b9732c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_Hc4TAMsdOWXMY1vB0t8g.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">login_window(布尔值)</figcaption></figure><p id="9d64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果按下 easygui multpasswordbox 中的 cancel 按钮，将返回‘None ’,因此条件语句位于第 63 行。如果用户没有按 cancel，并且布尔变量被设置为“True ”,那么作为列表返回的用户输入(字段值)将被切片并保存在变量中，然后在被调用时传递给 login_permission(登录，密码)函数。</p><p id="ef93" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">相同的逻辑应用于第 68–71 行，不同之处在于，如果布尔值被设置为‘False’…这意味着用户希望从. json 文件加载一个新数据库，而不是继续在现有的 _db 文件上加载，那么将调用 db_permission(login，password)而不是 login_permission(login，password)。else…用户按了 cancel，然后将返回到原来的窗口。</p><p id="e33f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来看看 login_permission(登录，密码)函数:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/82acc94fc32009dba377bd79b7e5410f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lWbaA9RyXADMFDhI8BtiAA.png"/></div></div></figure><p id="b3f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">像灰姑娘的脚一样又短又甜，这个函数检查三件事:如果' file_search()'函数返回' yes '；如果输入的登录名和密码正确无误。如果全部检查完毕，将调用 restore_db()函数和 main_menu()函数。否则…“book store _ db”文件不存在和/或登录/密码不正确，用户将收到警告并返回到原始窗口。</p><p id="73aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“file_search()”函数的快速概要。第 93 行到第 94 行我们调用平台库来检索操作系统名称，并将其保存在变量“system”中。然后，我们使用 fuzzywuzzy 库来确定它是否是 Windows 操作系统。我们将“系统”变量(可能是 Linux、Microsoft Windows 或其他什么)与“Windows”字符串进行匹配，以获得一个分数。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/bc9cd5c567281b56705d2e850e53be81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HON9DPhjUYv89LjIm1y04Q.png"/></div></div></figure><p id="5ddb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据分数，我们使用适当的路径细节(对于 Windows 使用\，对于其余的使用/来确定 bookstore_db 文件是否已经存在。如果是，该函数将变量“yes_no”设置为“yes”并返回它。</p><p id="975f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好的，让我们看看 restore_db():</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/03f2ab80292b567ebec4ee4be446efd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KXkXEHbwOCLJ425EgfHeQw.png"/></div></div></figure><p id="7a73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我们连接到数据库并打开 existing _db 文件的地方。我们需要将“db”和“cursor”变量设置为全局变量，以便在使用相同变量的其他函数中与数据库进行交互。</p><p id="0abe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在我们查看“user_options()”和“main_menu()”函数之前，让我们快速返回来查看通过 db_permission(登录，密码)函数调用的 load_db()函数。它具有与 login_permission(login，password)相同的逻辑，唯一的区别是当用户想要从. json 文件上传创建新的数据库文件时，调用' load_db()'而不是' restore_db()'。好吧…下面是调用 load_db()时的样子:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/3baf63b6a8e8104a9daa33f30b6a3638.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qdIR0cbRup5h_BrVLU3MDQ.png"/></div></div></figure><p id="f41b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里您可以选择。要导入数据库(_db)文件的 json 文件。</p><p id="2909" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我会尽量保持对 load_db()的解释简短，因为它是一个冗长的函数，所以我删除了对快照的注释。所有的注释都在源代码中。让我们看看下面的 load_db()。</p><p id="29ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在前几行中，我们定义了 easygui fileopenbox 参数，然后第 242 行生成了 gui。这个 easygui fileopenbox 返回一个包含 1 个元素的列表，该元素是。用户在所述 fileopenbox 中选择的 json 文件。第 244 到 246 行我们从这个文件路径中分离出每个字符，并把它放到一个新的列表中。然后我们在第 248 行反转这个列表。接下来的两行我们检索运行这个程序的机器的系统 OS，并把它保存在变量' system '中。在第 251 行，我们将变量 dash 初始化为“/”。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/1926aceb29a925952ff02b091c4a5314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lTDPuv4F_t0LPhP9w3evNg.png"/></div></div></figure><p id="3d94" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们调用 fuzzywuzzy，通过字符串匹配来确定它是否是 Windows 操作系统，如果是，我们希望将破折号变量从'/'更改为' \ '，因为 Windows 使用反斜杠作为文件路径。然后在第 256 行，我们需要从文件路径中找到最后一个‘破折号’的索引。一旦我们有了它，我们就在 numpy 的帮助下把它变成底片。</p><p id="803b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这一切的原因是我们不知道。json 文件名，我们需要从文件路径中截取文件名。第 259 行…如果用户没有在文件打开框中按下取消，将文件名切片并保存为变量‘文件名’。我们现在可以获取这个文件名，并转到 populate_db2(filename)，或者，如果用户按下 cancel，他们将返回到原来的窗口。让我们快速地看一下 populate_db2(filename ),然后我们再回到前面--&gt;“restore _ db()/user _ options()/main _ menu”第 263 行。</p><p id="204f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好的，下面我们有函数‘populate _ DB2(filename)’。我们首先打开。json 文件，文件名是我们从前面的函数中获取的，我们将文件内容保存为变量‘data’。这里将 db 和 cursor 设置为全局的原因也是因为我们不知道用户将选择哪条路线。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/4bab953d535135e4a7e13d78117f52b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KxS85mNPHJ8RDSU8rTUi8A.png"/></div></div></figure><p id="4279" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们连接到数据库，在第 212 到 219 行中，我们为我们在。json 文件。第 222 到 224 行我们解析了。json 文件并将数据通过 JSON 键插入到匹配的表列中。最后，我们可以访问 user_options()和 main_menu()函数；)</p><p id="64d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当调用 user_options()时，用户会看到以下选项列表:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/8458f0800c3b326ecc41b9badd048bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BU2RQnujA29DQwxzBUZDkw.png"/></div></div></figure><p id="ac2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你猜对了！是时候看看“user_options()”函数了:</p><p id="db83" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第 338 到 341 行产生了选项菜单。第 344–352 行我们从 books 表中检索元数据(列名),稍后我们将使用它进行显示。我们将 user_choice 设置为全局的，并将其初始化为 fieldValues 值。所以无论用户在选项菜单中点击什么，都会保存为 user_choice。然后我们调用 main_menu()函数，该函数需要在每次调用 user_options 时运行。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/c5681e746f7395544ba40fa69054c30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krD6d9390rvX4bxE5WXCrA.png"/></div></div></figure><p id="63b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们看看“main_menu()”函数:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/db9d86236826dba16bece6d95c850bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WeXW2ZsULp0uf1KhQ5qbzA.png"/></div></div></figure><p id="82dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这可以被认为是主选项菜单的主干，并且它是不言自明的。只要用户没有按 Exit 或 cancel(返回‘None’)，循环就不会中断，选项菜单应该继续做它最擅长的事情。显示选项。此外，每个选项(当然除了退出)都有一个子选项菜单，点击时会调用这个菜单。当 sub option 函数完成时，user_options()再次被调用，用户返回到 options 菜单。</p><p id="c36f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，让我们转到“搜索图书”选项，看看数据库中目前有什么，因为如果用户进入选项菜单…那么要么是加载了现有的数据库文件，要么是用户刚刚从. json 文件加载了一个新的文件。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/2442fb57039eb8ba5565c94ded3b1a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7QT5vu7oJQQowhcGb0LIwA.png"/></div></div></figure><p id="bd29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">哦，我的…更多的选择。现在，让我们选择“查看全部”,看看我们会得到什么:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/00e61444867e4a60d52d59c02fd86ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*giCcIoG19ne3JTTdZICA-A.png"/></div></div></figure><p id="b663" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好的，这就是。json 文件内容没有改变，因为我刚刚通过第一个菜单中的“加载新数据库**”选项进行了一次全新的上传。这个选项执行它所声明的，它将从数据库中检索所有唯一的记录并显示出来。既然我们点击了“搜索书籍”和“查看所有”选项，我想我们应该快速了解一下它们的功能:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/b7886ba9cb1b9c0a4de51a21b82ac819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POfq9ZZbwkjM6fgCwPiytQ.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">搜索选项()</figcaption></figure><p id="1264" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该函数以 easygui choicebox 的形式生成搜索书子菜单。用户输入保存为 fieldValues 变量，然后在第 661 到 670 行的条件语句中使用。在上面的例子中，我们点击“查看全部”，search_5()被调用。其余部分的逻辑是一样的。</p><p id="9d7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">search_5():</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/9acdd5a84c795a80d11e7274771bd8e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYK-N9C78YdYzIyOWyDc1g.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">search_5()</figcaption></figure><p id="6042" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第 833 到 834 行我们查询数据库，从名为 books 的表中返回所有唯一的条目。</p><p id="e9d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们遍历所有行，并将数据保存在一个名为“all_stock”的变量中。Easygui 不喜欢从查询中获取数据，所以我们将它改为一个 numpy 数组，对它进行整形，使它有 4 列和所需的行数。我们用 air 替换括号，然后放到 easygui 代码盒中进行显示。现在我们剩下 4 个“搜索书”选项。</p><ul class=""><li id="804e" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">按身份证号搜索；-按标题搜索；-按作者搜索&amp;-低库存检查。</li></ul><p id="5460" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除了“低库存检查器略有不同”之外，前 3 个在语法上都非常相似。让我们看看“低库存检查器”在被选中时会产生什么结果:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/622c5be7a69d428505edb9956c4412ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TQq11WiBFJGh-uiL2oguyg.png"/></div></div></figure><p id="a123" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可能已经猜到了，它显示的是库存不足的书，所以图书管理员不会在没有意识到的情况下对缺货的书措手不及。俗话说:“一天盘点一次，让愤怒的顾客远离”。该函数将图书过滤为“低库存”的低分可在“search_4()”函数中进行调整，我们将快速了解一下:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/d9cc22f99995f50bf0a1807e71f9b8b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oe370XDGYzWuEoz9CD6VXg.png"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx translated">search_4()</figcaption></figure><p id="3567" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第 805 行我们定义“低分”并将其保存为变量“低分”,然后在第 807 到 808 行将其添加到数据库查询中。所有搜索功能都遵循相同的逻辑和语法:</p><p id="f8a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">查询→转换为数组→整形和显示</p><p id="c4f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将快速浏览其他搜索功能，并快速显示每个功能。首先..“按 id 号搜索”，向上滚动一点，回到我们查看所有记录的地方，查找:爱丽丝梦游仙境-图书 id = 5。</p><p id="32de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们试试“按身份证号码搜索”，看看它是否有效:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/7a859c68cc7fd98c73cb1062775db35e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Weuk6zar9mVaKy0ika-UXA.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/e8464b540cf15f2b0b5ab31f1d1fa442.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnjFAHv9h3TJ1gxlWlyuSQ.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/6912be46c414a7f60d6b51f64355d18a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R7c5O7nMldXdFiH5dx-mTA.png"/></div></div></figure><p id="4df7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太好了，它看起来像预期的那样工作。快速浏览其背后的功能:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/180670fa3f331f4b8d21fd9cb7a76286.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_t3MTSo51VyB5a5Kyt-npw.png"/></div></div></figure><p id="4893" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">快速浏览…第 682 到 684 行，我们定义了 easygui 显示参数，在第 688 行，我们调用了字段检查函数，该函数生成 gui，检查并控制丢失的用户输入，并将用户输入作为“字段值”变量返回。然后我们返回到上面第 691 行的函数，如果用户没有按 cancel，我们从 fieldValues 变量中截取用户输入(图书 id)。之后，我们查询数据库，将保存的查询响应转换成一个 numpy 数组，对其进行整形，并通过 easygui codebox 显示出来。</p><p id="097a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转到“按标题搜索”选项。我在书单上看到了一本《哈利·波特》,所以让我们继续寻找罗琳的作品:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/914d5117da73c174f5bc14e18382d3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2LZQdIrGcnmwwprDXdB80g.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/c5a3941bd873e5afda55eacf0d1585ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*53H4qAZsVJm4j4uq3lz3tQ.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/00461f049878954ee15ae07f8215c94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v74hob_sdNtlvmjL2H5QrQ.png"/></div></div></figure><p id="55c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太棒了。这背后的函数称为“search_2”，它遵循与“search_1()”相同的逻辑，所以我不会深入讨论它，请随意查看源代码。这里值得一提的是，我在用户需要输入内容的任何地方都使用了字段检查功能，否则如果用户输入一个空字段，GUI 就会出错或中断，这是我们现在不想看到的，不是吗？</p><p id="a738" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们进入“进入图书”选项之前，让我们快速地看一下“按作者搜索”选项是如何工作的。会是什么…..那么搜索“J.R.R .托尔金”的书怎么样:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/32d8f84372388604c22ad5bf551e5313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmw7SwOupWa_kbkeTCQvqg.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/93f16501d6ffebc3afe334b2476f71f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LEnLKfVdhj8qWyqp_IQ29Q.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/47466c38b17a3f8e33bd3b41d5b1352b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYq5M4dw1ZSz-je8oH9N7g.png"/></div></div></figure><p id="d54b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很棒的东西。现在让我们转到“输入图书”选项:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/68f2709d94b4e5506345460785e67df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T6AIBe0SOLQB-bnoZFe55Q.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/056315adcc2239e17b8763fde4de2689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qiQagB0mqjTK2HzYZyJMZg.png"/></div></div></figure><p id="df6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">哎哟..我真傻，完全忘记输入书号和数量了。幸运的是，现场检查员正在做它的工作。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/ff0d9092167ad6c7a3f2913294268020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3TUXr8NIZP_WQoH1PALGiQ.png"/></div></div></figure><p id="a305" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们再试一次:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/6e9587905d6fee9ce19d7910c6749dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVv34OG8WXDU5UQv9khTYg.png"/></div></div></figure><p id="2afb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，理论上在输入所有字段并按下 OK 后，新条目应该在数据库中。要验证，请转到“查看全部”选项:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/b42635a6218297d4637cec0cc24592d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_QXRDqNZkttXZrH4GlbhcQ.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/f46c913a437a8f74cf6ab1169219e581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*je0TBMSNB6uCeiVHVeVA6Q.png"/></div></div></figure><p id="70aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">酷，在那里。快速浏览其背后的功能:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/17d5dfd95e9b1bf34d06239f2f5f7cb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VWikswUPpdK9t4YaRY5og.png"/></div></div></figure><p id="d027" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第 432 到 434 行我们定义了 easygui multenterbox 显示参数，在第 438 行我们调用了 field check 函数，该函数返回一个包含用户输入的列表。如果用户没有按 cancel，我们从列表中分割每个字段条目:id、标题、作者、数量，并将其插入到表中。如果您还记得 main_menu()函数及其 while 循环的样子，您可能还记得，现在我们将通过调用 user_options()函数返回到用户选项菜单。</p><p id="17e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们回到主菜单，让我们看看“更新书籍”选项是怎么回事:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/33a90db3893c604b550c07b39d1e2a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VXTT4E9jjqh8ZhU0Ml5j3w.png"/></div></div></figure><p id="08fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，这里我们有两个选项，更新整个字段或更新数量。让我们先试试更新数量。如果你向上滚动，你会看到 id: 1 是查尔斯狄更斯的“双城记”，还有 30 本书。出版商刚刚推出了一船新的股票，所以我们需要相应地更新它:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/0b6763b5a433d197956ef24ea28b0057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OkvCpFyYbbZaijhbUrqZQQ.png"/></div></div></figure><p id="8be0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看更新是否有效:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/56480198febd7836c89bbb46f8619102.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAg_96G2ex04ItM72HvhQQ.png"/></div></div></figure><p id="5925" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">确实如此。现在让我们试试另一个“更新整个字段”选项，把我们之前做的愚蠢的条目(“图书 id 15”)改成更明智的:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/b03c97b581b079e4c1343e0a26c6d0fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fn3U4ZQWvRjstgd8OB1XMA.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/79cf8bff919bac6183e4591e76962875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3EO-cyYo245WfxanQe4n-A.png"/></div></div></figure><p id="1c9b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们正在更改第一个条目的所有字段，让我们看看它是否有效:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/d1de04da191c555a38fdb0f6ac4837d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzCGGoaaY2l32G1sRk79Yg.png"/></div></div></figure><p id="6c36" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它做到了！；)语法和逻辑与“enter_book()”函数几乎相同，所以我不会详细介绍它，如果您愿意，请查看源代码。让我们转到最后一个选项，即“删除图书”选项:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/c9f2e4a18b4096d1dfcd99e397656eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JV9krV8zV4gr7cLH9HqTdw.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/fbb1a3ba22630f5ffbfe90569d64a3f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xuL5tiMw_7bwLAOY4d7emw.png"/></div></div></figure><p id="8a48" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们尝试第一个选项:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/ca3d410a8ff006be7cf276317856313c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKa1OeVwiQkQ83TlvIycEA.png"/></div></div></figure><p id="252d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们去-游戏由巴里 Lyga 图书 id 11:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/721f99ebc210bbd90369df79251addc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*myZMzjVEUVWreHa95HAWWA.png"/></div></div></figure><p id="5768" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在通过“查看全部”选项快速检查一下它是否被删除:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/9f69734e2227a1532c9f9143f2ced0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ThVhIzEe5hGfzYsuT3dx0A.png"/></div></div></figure><p id="e2e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它确实不见了..现在是-按 id 号删除选项:</p><p id="83d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们去掉查尔斯·狄更斯的《双城记》(图书编号 1):</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/1b3e8b1b046887fa4ac305ef88ed1743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rp_AKo3xpFwmr8MgtPiH3g.png"/></div></div></figure><p id="57d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">没了吗？</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/e967ad14ef97235761d5b4994a3f53b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TdX1TsdCb-ZzAlgcQtQhFg.png"/></div></div></figure><p id="7898" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">绝对的。</p><p id="c45c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">后两个选项背后的逻辑和语法非常相似，所以让我们快速看一下其中一个:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/a371661ac575eaebbe0ad03dfe16d2b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtmX7_5q-3VxovG_OogSkw.png"/></div></div></figure><p id="9822" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的函数' delete_1 '()负责按 id 号删除图书条目。第 582 到 584 行我们定义了 easygui 参数，然后我们使用返回用户输入的字段检查函数。然后我们在第 591 行继续这个函数。如果用户没有按下 cancel，我们将输入切片，然后从数据库中删除指定的条目。</p><p id="e7cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">删除选项菜单上的最后一个选项是:格式化数据库***</p><p id="0ef1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个不太可能的场景，但我还是把它包括在内了。不过，如果你点击这个选项，你将被要求输入你的登录名和密码，因为图书管理员不应该能够删除数据库表的内容:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/80bcaf48fc08fd3336b548274f300e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TdmNREV33dBVMdvV0LYalw.png"/></div></div></figure><p id="bb8a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果登录名和密码正确，则数据库表内容被成功销毁。让我们通过“查看全部”选项进行验证:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/27e82efaef6d0f68d2af43dfc4c62bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qr782kCrAhxiiG-ZsSPKow.png"/></div></div></figure><p id="0145" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么，图书管理员现在要做一些解释了。</p><p id="1324" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就这些了，我想这已经涵盖了大部分内容。如果你坚持到这里没有睡着，我祝贺你。请随意摆弄这个程序，如果我犯了什么错误，请告诉我。</p><p id="310c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我没有测试。json 文件上传功能在 windows 系统上，但我在 Linux 上操作，所以如果它产生一个错误，请让我知道！我相信它应该可以工作。下面是。json 文件内容，后跟源代码。谢谢你的时间，干杯！</p><p id="5322" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">书籍. json</p><pre class="kd ke kf kg fd kl km kn ko aw kp bi"><span id="e0a5" class="kq kr hi km b fi ks kt l ku kv">[<br/>    {<br/> "id": "1",<br/> "Title": "A Tale of Two Cities",<br/> "Author": "Charles Dickens",<br/> "Qty": "30"<br/>    },<br/>    {<br/> "id": "2",<br/> "Title": "Harry Potter and the Philosopher's Stone",<br/> "Author": "J.K. Rowling",<br/> "Qty": "9"<br/>    },<br/>    {<br/> "id": "3",<br/> "Title": "The Lion, the Witch and the Wardrobe",<br/> "Author": "C.S. Lewis",<br/> "Qty": "41"<br/>    },<br/>    {<br/> "id": "4",<br/> "Title": "The Lord of the Rings",<br/> "Author": "J.R.R Tolkien",<br/> "Qty": "16"<br/>    },<br/>    {<br/> "id": "5",<br/> "Title": "Alice in Wonderland",<br/> "Author": "Lewis Carroll",<br/> "Qty": "21"<br/>    },<br/>    {<br/> "id": "6",<br/> "Title": "The Eyes of the Dragon",<br/> "Author": "Stephen King",<br/> "Qty": "25"<br/>    },<br/>    {<br/> "id": "7",<br/> "Title": "The Empathy Problem",<br/> "Author": "Gavin Extence",<br/> "Qty": "8"<br/>    },<br/>    {<br/> "id": "8",<br/> "Title": "Bone Jack",<br/> "Author": "Sarah Crowe",<br/> "Qty": "11"<br/>    },<br/>    {<br/> "id": "9",<br/> "Title": "The Hired Man",<br/> "Author": "Aminatta Forna",<br/> "Qty": "18"<br/>    },<br/>    {<br/> "id": "10",<br/> "Title": "The White Tiger",<br/> "Author": "Aravind Adiga",<br/> "Qty": "34"<br/>    },<br/>    {<br/> "id": "11",<br/> "Title": "Game",<br/> "Author": "Barry Lyga",<br/> "Qty": "5"<br/>    },<br/>    {<br/> "id": "12",<br/> "Title": "The Tattooist of Auschwitz",<br/> "Author": "Heather Morris",<br/> "Qty": "9"<br/>    }<br/>]</span></pre><p id="242c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">书店. py</p><pre class="kd ke kf kg fd kl km kn ko aw kp bi"><span id="6d9d" class="kq kr hi km b fi ks kt l ku kv"># Importing necessary libraries<br/>from easygui import *<br/>from fuzzywuzzy import fuzz <br/>from fuzzywuzzy import process <br/>import easygui as gui<br/>import sqlite3<br/>import numpy as np<br/>import json<br/>import platform<br/>import glob</span><span id="d785" class="kq kr hi km b fi kw kt l ku kv">def which_way():<br/>    '''<br/>    First function of program which gets executed when running the program. <br/>    This functions as a cross roads, either you start with a new .json database <br/>    file which you can import as user, or you can continue on an existing .db file.<br/>    Login and Password gets defined in this function too and set as global variables<br/>    <br/>    '''<br/>    <br/>    global master_login<br/>    global master_pass<br/>    master_login = 'admin'<br/>    master_pass = '1234'<br/>    boolean = True<br/>    <br/>    msg = "Choose an option:"<br/>    title = "Main Menu"<br/>    choices = ["Continue on existing database","Load new database**"]<br/>    fieldValues = choicebox(msg,title, choices)</span><span id="966d" class="kq kr hi km b fi kw kt l ku kv"># fieldValues variable is the user input which gets returned from the gui<br/>    # conditional statement to guide user to the next interface based on input<br/>    if fieldValues == "Load new database**":<br/>        boolean = False<br/>        login_window(boolean)<br/>    <br/>    elif fieldValues == "Continue on existing database":<br/>        login_window(boolean)</span><span id="11a7" class="kq kr hi km b fi kw kt l ku kv">def login_window(boolean):<br/>    '''<br/>    This function prompts the user to enter login and password, calls on<br/>    the field_check_mpb() function to check for missing input fields and<br/>    sets the stage to call on either login_permission(), db_permission() <br/>    or which_way() depending on user input.</span><span id="f481" class="kq kr hi km b fi kw kt l ku kv">Parameters: <br/>    <br/>    boolean(bool)<br/>    '''<br/>    <br/>    msg = "Enter login information"<br/>    title = "Permission Required"<br/>    fieldNames = ["User id","Password"]<br/>    <br/>    # calling on field_check_mpb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_mpb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list elements and save in variables<br/>    if (fieldValues != None)and(boolean == True):<br/>        login = fieldValues[0]<br/>        password = fieldValues[1]<br/>        login_permission(login, password)<br/>    <br/>    elif (fieldValues != None)and(boolean == False):<br/>        login = fieldValues[0]<br/>        password = fieldValues[1]<br/>        db_permission(login, password)<br/>        <br/>    else:<br/>        which_way()</span><span id="b982" class="kq kr hi km b fi kw kt l ku kv">def file_search():<br/>    '''<br/>    This function checks if a bookstore_db file already exists on the<br/>    system, if so, then user can continue to user options menu. If no<br/>    such file exists, user should be bounced back to the first window <br/>    and be forced to either choose to import a file or to exit. Because <br/>    if user gets to continue with no bookstore_db file, the program will<br/>    yield an error once the file which does not exist get queried. <br/>    '''</span><span id="e82d" class="kq kr hi km b fi kw kt l ku kv">yes_no = ""<br/>    # calling on platform library to determine system OS saving result in "system"<br/>    uname = platform.uname()<br/>    system = uname.system<br/>    # matching 'system for similarity against "Windows" saving result in "score"<br/>    score = fuzz.WRatio('Windows', system)<br/>    <br/>    if score &gt; 70: # If OS = Windows look for '\bookstore_db' and if found set yes_no to 'yes'<br/>        db_file = glob.glob('**\bookstore_db', recursive=True)<br/>        if db_file == ['bookstore_db']:<br/>            yes_no = 'yes'<br/>    <br/>    else: # If OS is not Windows look for 'bookstore_db' and if found set yes_no to 'yes'<br/>        db_file = glob.glob('**/bookstore_db', recursive=True)<br/>        if db_file == ['bookstore_db']:<br/>            yes_no = 'yes'<br/>    <br/>    return yes_no</span><span id="9e3a" class="kq kr hi km b fi kw kt l ku kv">def login_permission(login, password):<br/>    '''<br/>    This function checks validity of login and password, as a means<br/>    to add a layer of security so only permitted users can load a new database.<br/>    <br/>    Parameters: <br/>    <br/>    login, password<br/>    <br/>    '''<br/>        <br/>    # Conditionals to determine if file exists, login and password entered is correct,<br/>    # if so, restore_db() will be called, existing database file will be <br/>    # opened and main menu will appear, else warning &amp; back to previous menu.<br/>    if (file_search() == 'yes')and(login == master_login)and(password == master_pass):<br/>        restore_db()<br/>        <br/>    else:<br/>        msgbox('Incorrect login/password and/or file does not exist')<br/>        which_way()</span><span id="fabf" class="kq kr hi km b fi kw kt l ku kv">def db_permission(login, password):<br/>    '''<br/>    This function checks validity of login and password, as a means<br/>    to add a layer of security so only permitted users can load a new database.<br/>    <br/>    Parameters: <br/>    <br/>    login, password<br/>    <br/>    '''</span><span id="dd86" class="kq kr hi km b fi kw kt l ku kv"># Conditionals to determine if login and password entered is correct,<br/>    # if so, load_db() will be called, new database will be opened and <br/>    # main menu will appear, else back to previous menu.<br/>    if (login == master_login)and(password == master_pass):<br/>        load_db()<br/>        <br/>    else:<br/>        msgbox('Incorrect login/password')<br/>        which_way()</span><span id="bf45" class="kq kr hi km b fi kw kt l ku kv">def delete_permission():<br/>    '''<br/>    This function prompts the user to enter login and password, as a means<br/>    to add a layer of security so only permitted users can format the database.<br/>    <br/>    '''<br/>    <br/>    msg = "Enter login information"<br/>    title = "Permission Required"<br/>    fieldNames = ["User id","Password"]<br/>    <br/>    # calling on field_check_mpb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_mpb(msg, title, fieldNames)<br/>        <br/>    # If user input is not empty, slice list elements and save in variables<br/>    if fieldValues != None:<br/>        login = fieldValues[0]<br/>        password = fieldValues[1]<br/>    <br/>    # Conditionals to determine if login and password entered is correct,<br/>    # if so, new database will be formatted and main menu will appear, else back<br/>    # to previous menu.<br/>    if (login == master_login)and(password == master_pass):<br/>        delete_3()<br/>        <br/>    else:<br/>        msgbox('Incorrect login/password')</span><span id="698f" class="kq kr hi km b fi kw kt l ku kv">def populate_db2(filename):<br/>    '''<br/>    If the user chooses to import new data from a .json file, this<br/>    function dumps the contents into a new .db file and creates a table <br/>    named books ready for usage, granted the contents of the.json file <br/>    is correct.<br/>    <br/>    Parameters: <br/>    <br/>    .json filename which user chose in the interface <br/>    <br/>    '''<br/>    <br/>    # opening, saving and closing .json file and saving contents as data<br/>    with open(filename, 'r+') as f:<br/>        data = json.load(f)<br/>    # setting db and cursor as global variables to be used troughout<br/>    # the script without redefining every time.<br/>    global db<br/>    global cursor<br/>    # Creating db file<br/>    db = sqlite3.connect('bookstore_db')<br/>    cursor = db.cursor()<br/>    # Creating table named books with columns as seen below<br/>    cursor.execute('''<br/>        CREATE TABLE IF NOT EXISTS books (<br/>        "id" INTEGER,<br/>        "Title" TEXT,<br/>        "Author" TEXT,<br/>        "Qty" INTEGER)''')<br/>    <br/>    db.commit()<br/>    <br/>    # Parsing through .json file and dumping data into matching columns<br/>    for child in data:<br/>        cursor.execute('''INSERT OR REPLACE INTO books VALUES (?,?,?,?)''',<br/>        (child['id'], child['Title'], child['Author'], child['Qty'],))</span><span id="7c72" class="kq kr hi km b fi kw kt l ku kv">db.commit()<br/>    # Once the .db file is set, time to offer the user some options<br/>    # which is produced in the functions below<br/>    user_options()</span><span id="861f" class="kq kr hi km b fi kw kt l ku kv">def restore_db():<br/>    '''<br/>    If the user chooses to continue work on an existing .db file, this<br/>    function does just that. It uses the restored .db file from the<br/>    previous session which includes all updates made since the original <br/>    .json import.'<br/>    <br/>    '''<br/> <br/>    # setting db and cursor as global variables to be used troughout<br/>    # the script without redefining every time.<br/>    global db<br/>    global cursor<br/>    # Connecting to the db file<br/>    db = sqlite3.connect('bookstore_db')<br/>    cursor = db.cursor()<br/>    # Once the .db file is set, time to offer the user some options<br/>    # which is produced in the functions below<br/>    user_options()</span><span id="926b" class="kq kr hi km b fi kw kt l ku kv">def load_db():<br/>    '''<br/>    This funtion spawns a file-open window where the user should select <br/>    an appropriate .json file which will be imported into a new .db file<br/>    The filename gets sliced from the file path in this function and it <br/>    then gets passed on to populate_db_2()<br/>    '''<br/>    <br/>    # This variables below defines the parameters of the fileopenbox GUI<br/>    # and the _file variable is where user input is stored<br/>    msg = "Choose (.json) database file:"<br/>    title = ".db_spawn"<br/>    default = ''<br/>    filetypes = ["*.json"]<br/>    file_ = fileopenbox(msg,title, default, filetypes)<br/>    <br/>    # converting directory as string to list<br/>    file_1 = []<br/>    for i in file_:<br/>        file_1.append(i)<br/>    <br/>    # reversing directory<br/>    file_2 = file_1[::-1]<br/>     <br/>    # getting OS name and saving it in 'system' variable<br/>    uname = platform.uname()<br/>    system = uname.system<br/>    <br/>    # Initialize dash to /  ,if system OS is window, change dash to \ <br/>    dash = '/'<br/>    score = fuzz.WRatio('Windows', system)<br/>    if score &gt; 70:<br/>        dash = '\\' <br/>    <br/>    # finding the index of the last '/' in the file directory to isolate<br/>    # the.json file no matter its filename length<br/>    index_ = file_2.index(dash)<br/>    # transforming the index to negative<br/>    index_1 = np.negative(index_)<br/>    # Conditional statement to import the correct .json file<br/>    <br/>    # This conditional makes sure the right file gets imported by slicing<br/>    # the directory after the last '/'  <br/>    if file_ != None:<br/>        <br/>        global filename<br/>        filename = file_[index_1:]<br/>        <br/>        #calling function to import .json data into new .db file<br/>        populate_db2(filename)<br/>    # else if user chooses to cancel importing process, then revert<br/>    # back to previous menu     <br/>    else:<br/>        which_way()</span><span id="d6b2" class="kq kr hi km b fi kw kt l ku kv">def user_options():<br/>    '''<br/>    Once the user has the .db file set, this function then acts as the<br/>    main menu, each with its own sub menus/enter fields except for the<br/>    exit function, which terminates the process and closes the database<br/>    This function also retrieves the meta data(column names) from the<br/>    table and saves it as a global variable to be used in the search <br/>    functions.<br/>    <br/>    '''<br/>    <br/>    msg = "Choose an option:"<br/>    title = "Menu - Book Manager"<br/>    choices = ["Enter book", "Update book", "Delete book","Search book", "Exit"]<br/>    fieldValues = choicebox(msg,title, choices)</span><span id="3d7c" class="kq kr hi km b fi kw kt l ku kv"># sorting by primary key and returning all books from database<br/>    cursor.execute('''SELECT DISTINCT * FROM books''')<br/>    db.commit()<br/>    # setting col_names variable as global to be used throughout the other<br/>    # search functions. <br/>    global col_names <br/>    # Retrieving meta data from table(column names)<br/>    col_names = [tuple[0] for tuple in cursor.description]<br/>    # changing col_names from list to string and seperating with dashes for readability.<br/>    col_names = '---------------'.join(col_names)</span><span id="b1d7" class="kq kr hi km b fi kw kt l ku kv"># Setting user choice as global variable to be used in other <br/>    # functions as defined via user input in the main menu<br/>    global user_choice<br/>    user_choice = fieldValues<br/>    main_menu()</span><span id="9676" class="kq kr hi km b fi kw kt l ku kv">def main_menu():<br/>    '''<br/>    This function consists of a loop and within it conditional statements<br/>    which directs the user to sub menus[functions] of the main menu based on <br/>    user input. If the user presses cancel or exit instead of choosing one of <br/>    the other options the loop breaks, database will close and the window will <br/>    terminate. <br/>   <br/>    '''<br/>    <br/>    while user_choice != 'Exit':<br/>        if user_choice == 'Enter book':<br/>            enter_book()<br/>            user_options()<br/>    <br/>        elif user_choice == 'Update book':<br/>            update_options()<br/>            user_options()</span><span id="768a" class="kq kr hi km b fi kw kt l ku kv">elif user_choice == 'Delete book':<br/>            delete_options()<br/>            user_options()</span><span id="e14a" class="kq kr hi km b fi kw kt l ku kv">elif user_choice == 'Search book':<br/>            search_options()<br/>            user_options()</span><span id="6300" class="kq kr hi km b fi kw kt l ku kv">elif user_choice == ('Exit')or('None'):<br/>            db.close()</span><span id="4059" class="kq kr hi km b fi kw kt l ku kv">else:<br/>            user_options()</span><span id="a88b" class="kq kr hi km b fi kw kt l ku kv">def field_check_meb(msg, title, fieldNames):<br/>    '''<br/>    This function checks for missing user input values in the multienterbox<br/>    and returns the user input as fieldValues variable<br/>    <br/>    Parameters:<br/>    <br/>    msg, title and fieldnames of the multi-enterbox GUI<br/>    <br/>    '''<br/>    <br/>    fieldValues = multenterbox(msg, title, fieldNames)</span><span id="5043" class="kq kr hi km b fi kw kt l ku kv"># Loop with conditionals to make sure that none of the user input <br/>    # fields are left blank<br/>    while 1:<br/>        if fieldValues is None: break<br/>        errmsg = ""<br/>        for i in range(len(fieldNames)):<br/>            if fieldValues[i].strip() == "":<br/>                errmsg += ('"%s" is a required field.\n\n' % fieldNames[i])<br/>        if errmsg == "":<br/>            break # if no empty fields found, proceed with next codeblock<br/>        # Saving user input as list in fieldValues variable<br/>        fieldValues = multenterbox(errmsg, title, fieldNames, fieldValues)<br/>    <br/>    return fieldValues</span><span id="5f0d" class="kq kr hi km b fi kw kt l ku kv">def field_check_mpb(msg, title, fieldNames):<br/>    '''<br/>    This function checks for missing user input values in the <br/>    multpassword-box and returns the user input as fieldValues variable<br/>    <br/>    Parameters:<br/>    <br/>    msg, title and fieldnames of the multpassword-box GUI<br/>    <br/>    '''<br/>    <br/>    fieldValues = multpasswordbox(msg, title, fieldNames)</span><span id="a6a3" class="kq kr hi km b fi kw kt l ku kv"># Loop with conditionals to make sure that none of the user input <br/>    # fields are left blank<br/>    while 1:<br/>        if fieldValues is None: break<br/>        errmsg = ""<br/>        for i in range(len(fieldNames)):<br/>            if fieldValues[i].strip() == "":<br/>                errmsg += ('"%s" is a required field.\n\n' % fieldNames[i])<br/>        if errmsg == "":<br/>            break # if no empty fields found, proceed with next codeblock<br/>        # Saving user input as list in fieldValues variable<br/>        fieldValues = multpasswordbox(errmsg, title, fieldNames, fieldValues)<br/>    <br/>    return fieldValues</span><span id="6bea" class="kq kr hi km b fi kw kt l ku kv">def enter_book():<br/>    '''<br/>    This function spawns a multi-enterbox interface where new book details<br/>    can be entered which then gets added to the database.<br/>    <br/>    '''<br/>    <br/>    msg = "Enter book information:"<br/>    title = "Enter new book"<br/>    fieldNames = ["Book id:","Book title:","Book Author:","Book Quantity:"]<br/>    <br/>    # calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>       <br/>    # If user input is not empty, slice list elements and save in variables<br/>    if fieldValues != None:<br/>        id_new = fieldValues[0]<br/>        title_new = fieldValues[1]<br/>        author_new = fieldValues[2]<br/>        qty_new = fieldValues[3]<br/>            <br/>        # Add user input(new book data) to database<br/>        cursor.execute('''INSERT OR REPLACE INTO books(id,Title,Author,Qty) <br/>        VALUES(?,?,?,?)''', (id_new, title_new, author_new, qty_new))<br/>        db.commit()</span><span id="7f00" class="kq kr hi km b fi kw kt l ku kv">def update_options():<br/>    '''<br/>    Sub function of the main menu update option.<br/>    Here we prompt the user for further input, which will determine if<br/>    the entire book entry gets updated or if the quantity only gets updated<br/>    <br/>    '''<br/>    <br/>    msg = "Choose an option:"<br/>    title = "Update Menu"<br/>    choices = ["Update quantity","Update entire field"]<br/>    fieldValues = choicebox(msg,title, choices)</span><span id="daad" class="kq kr hi km b fi kw kt l ku kv"># If user hits the cancel button, pass, else direct to next function<br/>    # where user will be prompted to enter book update values.<br/>    if fieldValues == None:<br/>        pass<br/>    elif fieldValues == "Update quantity":<br/>        update_1()<br/>    else:<br/>        update_2()</span><span id="2cc4" class="kq kr hi km b fi kw kt l ku kv">def update_1():<br/>    '''<br/>    This function prompts the user to enter the book id which is to be updated <br/>    as well as the new book quantity, it then updates the .db file <br/>    accordingly. <br/>    <br/>    '''<br/>    <br/>    msg = "Fill in the fields"<br/>    title = "Quantity editor"<br/>    fieldNames = ["Book id","Book Quantity"]<br/>    <br/>    # calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list element and save in variable<br/>    if fieldValues != None:<br/>        book_id = fieldValues[0]<br/>        qty_update = fieldValues[1]<br/>        <br/>        # Add user input(updated book data[quantity]) to database<br/>        cursor.execute('''UPDATE books SET Qty =? WHERE id =?''', <br/>        (qty_update, book_id))<br/>        db.commit()</span><span id="17ed" class="kq kr hi km b fi kw kt l ku kv">def update_2():<br/>    '''<br/>    This function prompts the user to enter the book id which is to be updated <br/>    as well as the new book id, title, author and quantity, it then updates <br/>    the .db file accordingly. <br/>    <br/>    '''<br/>    <br/>    msg = "Fill in the fields"<br/>    title = "Quantity editor"<br/>    fieldNames = ["Book id","New book id","Book Title","Book Author","Book Quantity"]<br/>    <br/>    # calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list elements and save in variables<br/>    if fieldValues != None:<br/>        book_id = fieldValues[0]<br/>        new_id = fieldValues[1]<br/>        new_title = fieldValues[2]<br/>        new_author = fieldValues[3]<br/>        new_qty = fieldValues[4]<br/>        <br/>        # Add user input(updated book data) to database<br/>        cursor.execute('''UPDATE books SET id =?,Title =?,Author =?,Qty =? <br/>        WHERE id =?''',(new_id, new_title, new_author, new_qty, book_id))<br/>        #cursor.execute('''SELECT * FROM books ORDER BY id''')<br/>        db.commit()</span><span id="0727" class="kq kr hi km b fi kw kt l ku kv">def delete_options():<br/>    '''<br/>    This functions serves as a sub menu of the main menu -&gt; Delete book <br/>    option. It prompt the user via an interface with 3 options, delete<br/>    book by id number,by author, or alterternatively the user has the option<br/>    to format the database granted he has permission.<br/>    <br/>    '''<br/>    <br/>    msg = "Choose an option:"<br/>    title = "Delete Menu"<br/>    choices = ["Delete by id number","Delete all books of Author from database",<br/>               "Format database***"]<br/>    fieldValues = choicebox(msg,title, choices)</span><span id="d718" class="kq kr hi km b fi kw kt l ku kv"># Conditional statement which will call the appropriate function based<br/>    # on user input/choice.<br/>    if fieldValues == "Delete by id number":<br/>        delete_1()<br/>    elif fieldValues == "Delete all books of Author from database":<br/>        delete_2()<br/>    elif fieldValues == "Format database***":<br/>        delete_permission()</span><span id="1285" class="kq kr hi km b fi kw kt l ku kv">def delete_1():<br/>    '''<br/>    This function is a sub function of the delete menu, this is where<br/>    the removal of the database entry occurs based on user input[book id]<br/>    <br/>    '''<br/>    <br/>    msg = "What is the book id?"<br/>    title = "Book Remover"<br/>    fieldNames = ["Book id"]<br/>    <br/>    # calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list element and save in variable<br/>    if fieldValues != None:<br/>        delete_id = fieldValues[0]<br/>        <br/>        # removing requested entry, defined by book id from database<br/>        cursor.execute('''DELETE FROM books WHERE id =?''', (delete_id,))<br/>        db.commit()</span><span id="cd06" class="kq kr hi km b fi kw kt l ku kv">def delete_2():<br/>    <br/>    '''<br/>    This function is a sub function of the delete menu, this is where<br/>    the removal of the database entry occurs based on user input[book author]<br/>    <br/>    '''<br/>    <br/>    msg = "Who is the author of the book?"<br/>    title = "Book Remover"<br/>    fieldNames = ["Book Author"]<br/>    <br/>    # calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list element and save in variable<br/>    if fieldValues != None:<br/>        delete_author = fieldValues[0]<br/>        <br/>        # removing requested entry, defined by book author from database<br/>        cursor.execute('''DELETE FROM books WHERE Author =?''', (delete_author,))<br/>        db.commit()</span><span id="eedb" class="kq kr hi km b fi kw kt l ku kv">def delete_3():<br/>    '''<br/>    This functions formats the database if the user chooses to do so</span><span id="e234" class="kq kr hi km b fi kw kt l ku kv">'''<br/>    <br/>    cursor.execute('''DELETE FROM books''')<br/>    db.commit()</span><span id="175f" class="kq kr hi km b fi kw kt l ku kv">def search_options():<br/>    '''<br/>    This is u sub function of the search book option from the main menu<br/>    It prompts the user to chooce whether they would like to search a book<br/>    by its id, title or author. Alternatively the user can choose to view<br/>    all the books in the database or only the books which are low on stock<br/>    <br/>    '''<br/>    <br/>    msg = "Choose an option:"<br/>    title = "Search Menu"<br/>    choices = ["View all","Search by id number","Search by Title",<br/>               "Search by Author","Low stock checker: { &lt; 10 }"]<br/>    fieldValues = choicebox(msg,title, choices)<br/>    <br/>    # Conditional statement which will call the appropriate function based<br/>    # on user input/choice.<br/>    if fieldValues == "View all":<br/>        search_5()<br/>    elif fieldValues == "Search by id number":<br/>        search_1()<br/>    elif fieldValues == "Search by Title":<br/>        search_2()<br/>    elif fieldValues == "Search by Author":<br/>        search_3()<br/>    elif fieldValues == "Low stock checker: { &lt; 10 }":<br/>        search_4()</span><span id="8ca8" class="kq kr hi km b fi kw kt l ku kv">def search_1():<br/>    '''<br/>    This function is a sub function of the search book menu, this is where<br/>    the retrieval of the database entry occurs based on user input[book id]<br/>    <br/>    '''<br/>    <br/>    msg = "What is the book id?"<br/>    title = "Book Search"<br/>    fieldNames = ["Book id"]<br/>    <br/>    # calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list element and save in variable<br/>    if fieldValues != None:<br/>        search_id = fieldValues[0]<br/>        <br/>        # Return database entry to user based on input[book id]<br/>        cursor.execute('''SELECT DISTINCT id,Title,Author,Qty FROM books WHERE id =?''', <br/>        (search_id, ))<br/>        # In order to display the row in an easily readable manner, we change the<br/>        # list to a numpy array, reshape it and remove the brackets.<br/>        books = cursor.fetchone()<br/>        a = np.array(books, dtype = str)<br/>        new = a.reshape(-1,4)<br/>        new = str(new).replace('[','').replace(']','')<br/>        new = str(new)<br/>        # Displaying row retrieved from database in easygui textbox interface<br/>        gui.codebox(msg='All Stock in database:',text=(col_names,'\n',new),<br/>        title='Database')</span><span id="027f" class="kq kr hi km b fi kw kt l ku kv">def search_2():<br/>    '''<br/>    This function is a sub function of the search book menu, this is where<br/>    the retrieval of the database entry occurs based on user input[book Title]<br/>    <br/>    '''<br/>    <br/>    msg = "What is the book Title?"<br/>    title = "Book Search"<br/>    fieldNames = ["Book Title"]<br/>    <br/>    # calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list element and save in variable<br/>    if fieldValues != None:<br/>        search_id2 = fieldValues[0]<br/>    <br/>        # Return database entry to user based on input[book Title]<br/>        cursor.execute('''SELECT DISTINCT id,Title,Author,Qty FROM books WHERE Title =?''', <br/>        (search_id2, ))<br/>        <br/>        # Looping through database rows and saving all title matches in<br/>        # books variable and change the list to a numpy array, reshape <br/>        # it and remove the brackets for readability.<br/>        books = []<br/>        for row in cursor:<br/>            books += row<br/>        a = np.array(books, dtype = str)<br/>        new = a.reshape(-1,4)<br/>        new = str(new).replace('[','').replace(']','')<br/>        new = str(new)<br/>        # Displaying row/s retrieved from database in easygui textbox interface<br/>        gui.codebox(msg='Database Title match:',text=(col_names,'\n',new),<br/>        title='Database')</span><span id="4a45" class="kq kr hi km b fi kw kt l ku kv">def search_3():<br/>    '''<br/>    This function is a sub function of the search book menu, this is where<br/>    the retrieval of the database entry occurs based on user input[book Author]<br/>    <br/>    '''<br/>    <br/>    msg = "Who is the Author of the book?"<br/>    title = "Book Search"<br/>    fieldNames = ["Book Author"]</span><span id="4c7d" class="kq kr hi km b fi kw kt l ku kv"># calling on field_check_meb() to check for missing user input and to<br/>    # save user input as fieldValues variable<br/>    fieldValues = field_check_meb(msg, title, fieldNames)<br/>    <br/>    # If user input is not empty, slice list element and save in variable<br/>    if fieldValues != None:<br/>        search_id3 = fieldValues[0]<br/>    <br/>        # Return database entry to user based on input[book Title]<br/>        cursor.execute('''SELECT DISTINCT id,Title,Author,Qty FROM books WHERE Author =?''', <br/>        (search_id3, ))<br/>        <br/>        # Looping through database rows and saving all author matches in<br/>        # books variable and change the list to a numpy array, reshape <br/>        # it and remove the brackets for readability.<br/>        books = []<br/>        for row in cursor:<br/>            books += row<br/>        a = np.array(books, dtype = str)<br/>        new = a.reshape(-1,4)<br/>        new = str(new).replace('[','').replace(']','')<br/>        new = str(new)<br/>        # Displaying row/s retrieved from database in easygui textbox interface<br/>        gui.codebox(msg='Database Author Match:',text=(col_names,'\n',new),<br/>        title='Database')</span><span id="5642" class="kq kr hi km b fi kw kt l ku kv">def search_4():<br/>    '''<br/>    This functions checks the database for any books that has a stock/quantity<br/>    level of less than 10 and displays it to the user.<br/>    <br/>    ''' <br/>    <br/>    # low_mark variable is the Quantity to be checked for against database quantities    <br/>    low_mark = 10<br/>    # Return database entry/s to user based on low_mark<br/>    cursor.execute('''SELECT DISTINCT id,Title,Author,Qty FROM books WHERE Qty &lt;?''', <br/>    (low_mark, ))<br/>    # loop through database entries and and return all rows where quantity is &lt;10<br/>    low_stock = []                            <br/>    for row in cursor:<br/>        low_stock += row<br/>    <br/>    # change the list to a numpy array, reshape it and remove the brackets for readability.<br/>    a = np.array(low_stock, dtype = str)<br/>    new = a.reshape(-1,4)<br/>    new = str(new).replace('[','').replace(']','')<br/>    new = str(new)<br/>    # Displaying row/s retrieved from database in easygui textbox interface<br/>    gui.codebox(msg='Low Stock in database:',text=(col_names,'\n',new),<br/>    title='Database')</span><span id="350c" class="kq kr hi km b fi kw kt l ku kv">def search_5():<br/>    '''<br/>    This function returns all the books on the database and displays it<br/>    to the user<br/>    '''<br/>    <br/>    # sorting by primary key and returning all books from database<br/>    cursor.execute('''SELECT DISTINCT * FROM books ORDER BY id''')<br/>    db.commit()<br/>   <br/>    # loop through database entries and return all rows with unique entries<br/>    all_stock = []<br/>    for row in cursor:<br/>        all_stock += row<br/>    <br/>    # change the list to a numpy array, reshape it and remove the brackets for readability.    <br/>    a = np.array(all_stock, dtype = str)<br/>    new = a.reshape(-1,4)<br/>    new = str(new).replace('[','').replace(']','')<br/>    # Displaying row/s retrieved from database in easygui textbox interface<br/>    gui.codebox(msg='All Stock in database:',text=(col_names,'\n',new),<br/>    title='Database')</span><span id="59af" class="kq kr hi km b fi kw kt l ku kv">if __name__ == '__main__':<br/>    which_way()<br/>    </span></pre></div></div>    
</body>
</html>