<html>
<head>
<title>How to store and real time analysis of clickstream data?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何存储和实时分析点击流数据？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-store-and-real-time-analysis-of-clickstream-data-e8460467aa88?source=collection_archive---------12-----------------------#2019-12-23">https://medium.com/analytics-vidhya/how-to-store-and-real-time-analysis-of-clickstream-data-e8460467aa88?source=collection_archive---------12-----------------------#2019-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/aa873392d28b71ee6b7e6db8a6898a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W7wiW-1Ii_qwepmc3kVQDQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">实时点击流数据分析</figcaption></figure><p id="b3c1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上图不言自明。</p><p id="9b47" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">为什么要存储点击流？</strong></p><ol class=""><li id="5873" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">了解访客的行为并获得有价值的客户洞察。</li><li id="814c" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">为实时推荐系统获取实时用户行为和活动</li><li id="11c9" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">开发横幅优化系统。</li></ol><p id="85d1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi kg translated"><span class="l kh ki kj bm kk kl km kn ko di"> T </span> <strong class="iw hj">科技</strong>:</p><ol class=""><li id="a34d" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">电压<strong class="iw hj"> : </strong></li><li id="259d" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">阿帕奇卡夫卡</li><li id="b950" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">阿帕奇火花</li><li id="da27" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">弹性搜索</li><li id="0d8c" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">基巴纳</li></ol><h1 id="3511" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated"><strong class="ak"> Divolte: </strong></h1><p id="fc4e" class="pw-post-body-paragraph iu iv hi iw b ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn lr jp jq jr hb bi translated">Divolte Collector是一个可扩展的高性能服务器，用于收集HDFS和Kafka主题的点击流数据。它在客户端使用JavaScript标签<em class="ls">来收集用户交互数据，类似于许多其他网络跟踪解决方案。Divolte Collector可以用作构建任何东西的基础，从基本的web分析仪表板到实时推荐引擎或横幅优化系统。</em></p><p id="8a4d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Divolte使用Apache Avro序列化系统来存储数据。Divolte提供ip2location支持和用户代理解析。您可以在配置文件中定义自定义事件。</p><p id="dc7b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> Divolte安装:</strong></p><p id="75c5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Divolte Collector目前仅在类Unix系统上受支持。下一步是下载、解压缩并运行Divolte Collector。你可以在我们的<a class="ae lt" href="https://github.com/divolte/divolte-collector" rel="noopener ugc nofollow" target="_blank">项目主页</a>上找到最新版本。运行以下命令:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="1f1f" class="md kq hi lz b fi me mf l mg mh">% tar -xzf divolte-collector-*.tar.gz<br/>% cd divolte-collector-*<br/>% touch conf/divolte-collector.conf<br/>% ./bin/divolte-collector</span></pre><p id="4612" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">它以默认配置运行，而您可以设置您的配置。</p><p id="a916" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">几个文件:</p><ol class=""><li id="c40f" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated"><strong class="iw hj">divolte-collector . conf-</strong>这是服务器配置文件。您可以为事件定义<strong class="iw hj">源</strong>并定义java脚本文件名。你可以定义<strong class="iw hj">映射</strong>，在那里你可以映射你的源(点击流)到汇(卡夫卡)。您还可以定义<strong class="iw hj">水槽</strong>配置。</li><li id="a74f" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">你可以在Avro中定义你的事件或数据的格式。</li><li id="c923" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><strong class="iw hj"> mapping.groovy: </strong>映射你的点击流数据到你的avro文件。</li></ol><p id="e8a7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请在您想要记录事件的网站上包含以下文件。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="5d52" class="md kq hi lz b fi me mf l mg mh">&lt;script src="divolte.js" defer async&gt;&lt;/script&gt;</span></pre><p id="4347" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">默认情况下，当您运行divolte with below命令时，它会将<strong class="iw hj"> tmp </strong>目录中的事件写入文件。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="495b" class="md kq hi lz b fi me mf l mg mh">./bin/divolte-collector</span></pre><p id="c74a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，用你的网络浏览器访问<a class="ae lt" href="http://127.0.0.1:8290/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8290/ </a>，检查你是否看到了一个页面。该网页中插入了Divolte Collector JavaScript标记，因此加载该页面将向服务器注册一个pageview事件。此外，您可以单击横幅一次或多次，以生成其他事件或重新加载页面几次。你也可以用下面的命令查看数据。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="fb87" class="md kq hi lz b fi me mf l mg mh">% find /tmp/ -name '*divolte-tracking-*.avro' | sort | tail -n1 | xargs ./bin/avro-tools tojson --pretty</span></pre><h1 id="2abb" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">写给卡夫卡</h1><p id="bb5c" class="pw-post-body-paragraph iu iv hi iw b ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn lr jp jq jr hb bi translated">在我们的例子中，水槽是卡夫卡。将以下内容添加到您的Divolte配置中，重新启动您的Divolte收集器，并更改您的kafka引导服务器的IP和主题名称。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="27f3" class="md kq hi lz b fi me mf l mg mh">divolte {<br/>  global {<br/>    kafka {<br/>      // Enable Kafka flushing<br/>      enabled = true<br/><br/>      // The properties under the producer key in this<br/>      // configuration are used to create a Properties object<br/>      // which is passed to Kafka as is. At the very least,<br/>      // configure the broker list here. For more options<br/>      // that can be passed to a Kafka producer, see this link:<br/>      // https://kafka.apache.org/documentation.html#producerconfigs<br/>      producer = {<br/>        bootstrap.servers = "10.200.8.55:9092,10.200.8.53:9092,10.200.8.54:9092"<br/>      }<br/>    }<br/>  }<br/><br/>  sinks {<br/>    // The name of the sink. (It's referred to by the mapping.)<br/>    kafka {<br/>      type = kafka<br/><br/>      // This is the name of the topic that data will be produced on<br/>      topic = divolte-data<br/>    }<br/>  }<br/>}</span></pre><p id="4e9b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在数据将存储在Apache Kafka中。</p><h1 id="73c1" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated"><strong class="ak">阿帕奇</strong> Spark:</h1><p id="dad4" class="pw-post-body-paragraph iu iv hi iw b ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn lr jp jq jr hb bi translated">Apache spark基本上用于分布式数据的并行处理。我们可以做任何加工。我们可以实时将阿帕奇火花和卡夫卡联系起来。两者都提供实时流。</p><h1 id="5dd0" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">弹性搜索:</h1><p id="6a04" class="pw-post-body-paragraph iu iv hi iw b ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn lr jp jq jr hb bi translated">在分析数据并根据我们的需要将其转换为有意义的数据后，我们可以将其存储在Elasticsearch中。Elasticsearch非常适合搜索，但我们在这里使用它是因为ELK stack在Kibana的帮助下提供了非常好的可视化功能。</p><h1 id="3ed8" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">基巴纳:</h1><p id="9876" class="pw-post-body-paragraph iu iv hi iw b ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn lr jp jq jr hb bi translated">Kibana分别用于查询和可视化点击流数据。它为开发仪表板提供了一个非常好的工具。</p><p id="f9a8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请给我发邮件，如果你需要在mlanujsharma@gmail.com的上述项目的任何进一步的信息。</p></div></div>    
</body>
</html>