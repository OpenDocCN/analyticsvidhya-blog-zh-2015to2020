<html>
<head>
<title>Visualizing the MNIST data-Set</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化MNIST数据集</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/visualizing-the-mnist-data-set-4ba985c4af12?source=collection_archive---------8-----------------------#2020-01-10">https://medium.com/analytics-vidhya/visualizing-the-mnist-data-set-4ba985c4af12?source=collection_archive---------8-----------------------#2020-01-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7b886402d5215521c4ec9b5110a14147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RIU6bLVcjTFEl0ypXbOPew.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">MNIST数据集</figcaption></figure><blockquote class="iu"><p id="f4db" class="iv iw hi bd ix iy iz ja jb jc jd je dx translated">“观想是有目的的白日梦。”</p></blockquote><p id="a1ee" class="pw-post-body-paragraph jg jh hi ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc je hb bi translated">这是一个令人悲伤的事实，大多数人无法想象三维之外的世界。物理学家说第四维是时间，但很少有人能想象它是第四维。</p><p id="faaa" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">在数据可视化和探索的情况下，我们可以使用相应维度的散点图轻松地可视化二维和三维数据。除此之外，我们通常使用配对图。结对图有其局限性。配对图的数量由<em class="ki"> nC2 </em>给出，等于<em class="ki"> (n！)/(2!* n！).</em>这意味着如果我们有一个100维的数据集，那么我们将不得不查看4950个不同的图。实际上，超过10个维度，配对图的数量太多了，无法单独显示每一个。</p><p id="425d" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">在这篇博客中，我们正在处理有784个维度的mnist数据集的相同问题。我们将把它的尺寸减少到2维，以便使用2d散点图来可视化它。但首先让我们看看什么是mnist数据。</p><h1 id="831e" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">MNIST数据集</h1><p id="fdd4" class="pw-post-body-paragraph jg jh hi ji b jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc je hb bi translated">mnist数据集包含从0-9的手写数字字符的<strong class="ji hj"> 60，000个</strong> <strong class="ji hj">不同的</strong> <em class="ki"> 28 * 28 </em>图像。该数据集广泛用于学习计算机视觉和图像处理的基础。使用pandas读取csv格式的数据后，它将如下所示</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/e67c1d9e0aab4f4f906e6b2dfe11e7ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*7Iy8M3IRNvJhU1GGlJ3JUQ.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">这是前5个数据点</figcaption></figure><p id="b8c1" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">第一列标签告诉我们数据点对应的数字。其余的列包含784个像素(28 * 28)中每个像素的像素值。它们的值范围从0到255。像素值越大，网格的颜色就越强烈。这是一个数据点的样子</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/da2546ec6dca3b3d44ac46adbb4e3cc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*zJB56JW2Q2bZXoIGcFsbxg.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">该图像对应于训练集的索引10360处的数据点</figcaption></figure><p id="9cf3" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">为了在2d或3d散点图中显示这一点，我们首先需要将其维度降低到2。为了做到这一点，我们将使用两种不同的技术，一种叫做PCA，这是一种非常古老的技术，另一种是t-SNE，我将在下一篇博客中讨论。</p><h1 id="584d" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">主成分分析</h1><p id="e573" class="pw-post-body-paragraph jg jh hi ji b jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc je hb bi translated">主成分分析(简称pca)是最基本、最简单的降维技术之一。在无监督学习的情况下，它也被用作聚类技术。它将D维数据转换为D `-维数据<em class="ki">，其中D`≤D. </em> <strong class="ji hj"> <em class="ki"> </em>，以便使用pair plot <em class="ki">，D`=2进行可视化。我们将看到它在2d中是如何工作的。</em></strong></p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/da0d2132537cffd26fe58ceb520a63ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*kkTeGwe05_Ok9qKVTdKPSQ.jpeg"/></div></figure><p id="2927" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">假设我们有一个数据集，xi为数据点，如左图所示，我们希望将其投影到一维上。可以清楚地看到，y轴上的分布或方差比x轴上的方差大得多。方差是(粗略地)对信息的一种度量。因此，如果我们将所有数据点投影到y轴上，与将数据点投影到x轴上相比，我们将保留更多的差异。这意味着我们将能够保存更多的信息，将它的维度从2d降低到1d。</p><blockquote class="lt lu lv"><p id="022b" class="jg jh ki ji b jj kd jl jm jn ke jp jq lw kf jt ju lx kg jx jy ly kh kb kc je hb bi translated">或者，保存更多的信息可以被认为是区分1 d中的点的容易程度。这只有在点位于更宽的分布中并且在1d中清晰可见时才能实现，这又意味着点在投影轴上应该具有更高的方差。因此我们总是<strong class="ji hj">试图保持最大可能的方差</strong>。因此，在这种情况下，为了在1-d中可视化这些点，我们只需要将它们投影到y轴上，然后放下x轴。</p></blockquote><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/88b12d0b5ad7a218b686d3e97c12fa18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*o4RAKZhZuz--vicwClzGdw.jpeg"/></div></figure><p id="9e6b" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">现在，对于上述数据点中描述的情况，我们有了特征标准化的数据集。特征向量的标准化意味着去除其均值(使其为零)并使其方差等于1。所以特性是独立标准化的。</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/0c14153cbdd644d29bd7d6fa670e69a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*y9QpMbqE8nud20xFDXTlZg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">标准化就是这么做的(这里mu是均值，sigma是标准差)。</figcaption></figure><p id="ad1e" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">在这种情况下，两个轴上投影点的方差将相同，因为两个轴在2d中具有相等的方差。在这种情况下，我们通常会看到这种类型的数据，我们将做一些被称为轴的旋转。我们将轴旋转为</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/86638cf299712fc6ef07fe87cd4e0c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*hyJ7hN-TSZotx36UG6kepA.jpeg"/></div></figure><p id="4507" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">现在可以很容易地看出，f1’上投影点的方差将明显比F2’上的大得多。现在我们可以很容易地把我们的点投射到f1上，然后放下f2。现在，我们将数据集缩减到1维，并保留了最大的信息。</p><blockquote class="lt lu lv"><p id="ec66" class="jg jh ki ji b jj kd jl jm jn ke jp jq lw kf jt ju lx kg jx jy ly kh kb kc je hb bi translated">我们想找到一个方向f1 ’,使得投射到f1’上的xi s的方差最大。</p></blockquote><p id="59fa" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">现在我们把我们的结果推广到n维。为了找到方向，我们只需要找到沿着那个方向的单位向量。设u1是所需的单位向量，xi′是Xi在f1′上的投影，则</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/e394104ac7be01e317886feff94e0d44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sI814XNTEubVylyexR8gnw.jpeg"/></div></div></figure><p id="b9dd" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">其中u1T是单位向量u1转置。现在新点xi '的方差将为</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es md"><img src="../Images/46360aad0aee3bad4f8766ef8232ae6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*qjR8neksRv4NA5OS1lPyGg.jpeg"/></div></figure><p id="6729" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">其中x条是xi的平均向量，n是数据点的数量。由于我们的数据点是特征标准化的，因此平均向量将为零，我们的问题归结为</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/82af0efc091557e04a6c364765b6e71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rqmJREoYcmajLsnvJYo6A.jpeg"/></div></div></figure><p id="fdb3" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">鉴于<em class="ki"> u1 </em>是一个单位向量，这是一个优化问题。原来，我们的优化问题的解是由数据点或数据矩阵的协方差矩阵的特征向量给出的。</p><p id="2a07" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">协方差矩阵是这样一种矩阵，使得在给定我们的数据矩阵(必须被特征标准化)的特征第<em class="ki">I</em>和特征第<em class="ki">j</em>之间的协方差的情况下，其在第<em class="ki">I</em>行和第<em class="ki">j</em>列的值是对应于变换矩阵的向量，使得在变换之后，它们被称为其特征值的值缩放。观看<a class="ae mf" href="https://www.youtube.com/watch?time_continue=156&amp;v=PFDu9oVAE-g&amp;feature=emb_title" rel="noopener ugc nofollow" target="_blank">这</a>可以清楚地了解特征向量和特征值。</p><p id="108f" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">我们现在需要做的就是取对应于两个最大特征值的特征向量(在将维度减少到2的情况下为<strong class="ji hj">)并将我们的数据矩阵投影到这两个向量上。那么我们的xi将会变成这样</strong></p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/02fc60d1a10bb1bb9dd51646213995cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*Uvv_ZzQ5fyLvQm3UPfpBXA.jpeg"/></div></figure><p id="e057" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">其中v1和v2是对应于两个最大特征值的特征向量。我们新的数据矩阵将是一个二维矩阵。</p><p id="4d89" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">简而言之，这就是我们要做的。特征标准化数据矩阵。求协方差矩阵，求对应两个最大特征值的特征向量。并且在最后一步中，将向量矩阵与数据矩阵的转置相乘。你可以在这里找到PCA <a class="ae mf" href="https://github.com/vedanshsharma/Visualizing-MNIST-data-set-" rel="noopener ugc nofollow" target="_blank">的实现。</a></p><p id="878e" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">我们从主成分分析中得到的视觉效果会是这样的..</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/4a7477f946dc5608eef64acbb18a49c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*0BBD4mjDhycYa-IeaVQT0Q.jpeg"/></div></figure><p id="4d6a" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">这可能不是最好的可视化效果，但你可以清楚地看到，它在一边聚集了所有的0，在另一边聚集了1和9。对于其他数字，有很大的重叠。</p><p id="52eb" class="pw-post-body-paragraph jg jh hi ji b jj kd jl jm jn ke jp jq jr kf jt ju jv kg jx jy jz kh kb kc je hb bi translated">为了提高可视化，我们将使用t-SNE，这是目前最好的降维技术之一。在下一篇博客中，我将讨论t-SNE以及PCA的局限性。</p><h2 id="fbff" class="mi kk hi bd kl mj mk ml kp mm mn mo kt jr mp mq kx jv mr ms lb jz mt mu lf mv bi translated">履行</h2><p id="44ae" class="pw-post-body-paragraph jg jh hi ji b jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz ll kb kc je hb bi translated">要实现pca，请点击<a class="ae mf" href="https://github.com/vedanshsharma/Visualizing-MNIST-data-set-" rel="noopener ugc nofollow" target="_blank">链接</a>我已经从头开始实现了PCA，并且使用了scikit-Learn。</p></div></div>    
</body>
</html>