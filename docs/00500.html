<html>
<head>
<title>Interactive Data Visualization of Chennai Water Crisis using Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Plotly实现钦奈水危机的交互式数据可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/interactive-data-visualization-of-chennai-water-crisis-using-plotly-15e5000ad7df?source=collection_archive---------4-----------------------#2019-07-10">https://medium.com/analytics-vidhya/interactive-data-visualization-of-chennai-water-crisis-using-plotly-15e5000ad7df?source=collection_archive---------4-----------------------#2019-07-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/e450e605e9dff1c8c43a3cfe82e80e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*Tnqk9XdfPu0MY2FcuHZarQ.png"/></div></figure><blockquote class="im in io"><p id="c558" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一口完全干涸的井，一座没有水的城市。印度南部城市钦奈在四个主要水库完全干涸后陷入危机。~莱昂纳多·迪卡普里奥</p></blockquote><p id="7332" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">为了练习数据可视化，我在Kaggle上浏览了一些数据集，无意中发现了一个包含钦奈水库和降雨量数据的数据集。在查找了一些内核并从中学习之后，我决定自己对这些数据进行研究。在这篇博客中，我将向您展示我是如何在python中使用Plotly得出这个令人担忧的结论的。</p><h2 id="d14a" class="jr js hi bd jt ju jv jw jx jy jz ka kb jo kc kd ke jp kf kg kh jq ki kj kk kl bi translated">为什么是Plotly？</h2><p id="e6e2" class="pw-post-body-paragraph ip iq hi is b it km iv iw ix kn iz ja jo ko jd je jp kp jh ji jq kq jl jm jn hb bi translated">Plotly是基于可视化库D3.js、HTML和CSS的最好的数据可视化工具之一。它是使用Python和Django框架创建的。我们可以选择在线创建交互式数据可视化，或者使用plotly提供的库以您选择的语言创建这些可视化。我喜欢plotly，因为它有无数的选项、简约的设计和非常好的文档。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="e79f" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们现在就开始吧！在导入所有需要的库和数据集之后，我们将创建一个函数来从我们的油藏数据返回trace。跟踪只是我们给数据集合起的名字，以及我们想要绘制的数据的规格。轨迹本身也是一个对象，这些将根据我们希望数据在绘图表面上如何显示来命名。这里我使用散点图，因此trace将相应地返回。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="ab61" class="jr js hi ld b fi lh li l lj lk">def scatter_plot(reservoir,color,res):<br/>    trace = go.Scatter(<br/>        x=reservoir.index[::-1],<br/>        y=reservoir.values[::-1],<br/>        name=res,<br/>        marker=dict(<br/>            color=color,<br/>        ),<br/>    )</span><span id="7069" class="jr js hi ld b fi ll li l lj lk">return trace</span></pre><p id="b71d" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">在这里，水库表示一个数据框，由水库中的日期(索引)和水可用性(值)组成，颜色表示我们希望我们的跟踪对象是什么颜色，res表示水库的名称。</p><p id="2712" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">下面是一个使用上述函数进行追踪的示例:</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="caf1" class="jr js hi ld b fi lh li l lj lk">reservoir = df["POONDI"]<br/>reservoir.index = df["Date"]<br/>trace1 = scatter_plot(reservoir, 'red','POONDI')</span></pre><p id="4d8a" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">同样，我们将创建剩余3个水库的痕迹。之后，我们将为所有的水库制作支线剧情并追加。这里我使用了一个单独的图来添加4个水库，但是你也可以选择为4个不同的水库制作4个不同的图。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="7bc0" class="jr js hi ld b fi lh li l lj lk">fig = plotly.tools.make_subplots(rows=1, cols=1)<br/>fig.append_trace(trace1, 1, 1)<br/>fig.append_trace(trace2, 1, 1)<br/>fig.append_trace(trace3, 1, 1)<br/>fig.append_trace(trace4, 1, 1)<br/>fig['layout'].update(height=600, width=1200, title='Water availability in all 4 reservoirs - in mcft')<br/>py.iplot(fig, filename='reservoir_plots')</span></pre><p id="133b" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">这是我们绘制后得到的结果:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/2100a6c96b0bda5744e9f27ef5a7cc66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xfsv36ibcArCFM9NSc4-Q.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">4个不同储层的散点图</figcaption></figure><p id="80ef" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在，让我们将所有储层结合起来，并使用相同的散点图函数为所有4个储层绘制一条单一轨迹。使用该跟踪，我们得到:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/563f806b8ead332542d99c437dd7a641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQuSMCd2g9rPhgLnMryl9Q.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">4个不同储层的散点图</figcaption></figure><p id="cde3" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们可以看到，自2018年以来，水库水位下降幅度更大。我们来分析一下2018年后的数据。为此，我们将简单地对数据集进行切片，得到从2018年1月到现在的值。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="36d0" class="jr js hi ld b fi lh li l lj lk">mask = (df['Date'] &gt; '2018-1-1')<br/>df=df.loc[mask]</span></pre><p id="cd7f" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在，重复上述步骤后，我们将得到如下散点图:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/87992a448cc372834f05dd93a309ab07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoRJ3AnYeFep35UrntNKKw.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">4个不同储层的散点图</figcaption></figure><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/44aab80147a20428dd9d251267cae7f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBnl2rdJesIZrcAVf5mILA.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">4个不同储层的散点图</figcaption></figure><p id="bec6" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">是的，钦奈的水库已经枯竭，“只有雨水能把钦奈从这种情况中拯救出来。”利奥又说道。</p><p id="7391" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">所以我们来分析一下钦奈的降雨量数据。为此，我将使用基于相同散点图的面积图。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="d009" class="jr js hi ld b fi lh li l lj lk">def area_plot(reservoir):<br/>    trace = go.Scatter(<br/>        x=reservoir.index[::-1],<br/>        y=reservoir.values[::-1],<br/>        fill='tonexty'  <br/>    )<br/>    data=[trace]<br/>    return trace</span></pre><p id="233b" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在，绘制图形:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/20785abfe1dc70e7d55cca904ba9fcf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a7vnyln1NHmV1kANSzMMmQ.png"/></div></div></figure><p id="316c" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们可以看到主要的降雨季节是从7月到11月。此外，我们可以看到，与往年相比，2018年以来的降雨量较低。当有关当局采取必要的措施时，让我们祈祷下雨吧。是的，节约用水！</p><p id="93fc" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">你可以在我的回购中找到代码:<a class="ae lv" href="https://github.com/retroflake/Chennai_Water_Crisis" rel="noopener ugc nofollow" target="_blank">https://github.com/retroflake/Chennai_Water_Crisis</a></p></div></div>    
</body>
</html>