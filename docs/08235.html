<html>
<head>
<title>How I am convinced the difficulty of churn problems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何确信客户流失问题的难度</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-i-am-convinced-the-difficulty-of-churn-problems-465ac7b0038c?source=collection_archive---------31-----------------------#2020-07-21">https://medium.com/analytics-vidhya/how-i-am-convinced-the-difficulty-of-churn-problems-465ac7b0038c?source=collection_archive---------31-----------------------#2020-07-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b35529a48891e476915a542bddea75fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MrXRhkc0jPuUyvNNwA-BTg.png"/></div></div></figure><h1 id="6879" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="b929" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在牛津在线词典中，单词“churn”的定义是让某人感到不安或情绪混乱。尽管我们知道客户流失是商业中的客户流失，但字典中的意思在商业中也是如此合乎逻辑。如果有人对不同的消费机会感到不安或困惑，她可以离开。这里的问题是:数据能帮助我们理解消费者是否变得愤怒或开始困惑吗？</p><p id="383c" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">流失的用户可能只占所有用户的一小部分，这使得问题变得很突出。然而，尽管我们永远无法确切知道一个人真实的经历，这些数据仍然对我们有很大的帮助。</p><p id="2e28" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">在sparkify问题中，提供了用户的日志，我们试图猜测他们的流失行为。大约300个用户有64天的数据和大约28万个日志。52%的用户有流失日志。在这个项目中，pyspark被用于清洁、建模等。；只有在绘图时，才使用mathplotlib和pandas库。</p><p id="b61e" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">在项目期间，主要目标是预测客户流失。然而，这是如此开放式的表达，因此需要明确的目标定义。</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="4817" class="iq ir hi bd is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn bi translated"><strong class="ak">数据探索和数据清理</strong></h1><p id="18d6" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在设置spark会话和提取等常见步骤之后，数据分析开始了。只有一个数据框架可用于该项目，它包含以下各列:</p><ul class=""><li id="4b75" class="le lf hi jq b jr kn jv ko jz lg kd lh kh li kl lj lk ll lm bi translated">艺术家:字符串(可空=真)</li><li id="e961" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">auth: string (nullable = true)</li><li id="bbbf" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">名字:字符串(可空=真)</li><li id="5f04" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">性别:字符串(可空=真)</li><li id="9a03" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">item insession:long(nullable = true)</li><li id="616b" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">lastName: string (nullable = true)</li><li id="c322" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">长度:double(可空=真)</li><li id="68ba" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">级别:字符串(可空=真)</li><li id="44b6" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">位置:字符串(可空=真)</li><li id="d12e" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">方法:字符串(可空=真)</li><li id="37dc" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">页面:字符串(可空=真)</li><li id="44db" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">注册:long(可空=真)</li><li id="1042" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">sessionId: long (nullable = true)</li><li id="222e" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">song: string(可空=真)</li><li id="da48" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">状态:long(可空=真)</li><li id="ae99" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">ts: long(可空=真)</li><li id="0067" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">userAgent: string (nullable = true)</li><li id="0608" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">userId: string (nullable = true)</li></ul><p id="e65a" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">Sparkify是一个音乐平台，通过查看列名和前几行，我们可以看到这是一个日志表。如上所述，我们的目标是猜测表现出不安态度的用户。为此，我们应该区分搅动和非搅动用户，并调查他们的不同态度。我只是试图澄清，主要的焦点应该放在用户身上。</p><p id="feb8" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">因此，在观察空用户的日志后，删除了具有空用户id的行。他们只访问了7个页面，而这些页面实际上并不代表任何活动，比如听音乐。根据它们的名称，这些页面可能不需要任何身份验证，因此可以断定这些用户还没有登录，或者刚刚退出。</p><ul class=""><li id="d4c4" class="le lf hi jq b jr kn jv ko jz lg kd lh kh li kl lj lk ll lm bi translated">主页</li><li id="4888" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">关于</li><li id="0e0e" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">提交注册</li><li id="1412" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">注册</li><li id="6be5" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">注册</li><li id="afab" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">帮助</li><li id="1845" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">错误</li></ul><p id="8afc" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">页面特征显示了用户的活动，因此它将构成我们模型的主要部分。所有的动作都保存为页面。下面列出了这些。当我们观察用户访问的页面时，我们可以看到取消确认意味着流失，因为在它之后没有日志。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/608f52e5c825c17037a4f4470170c171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*j1fjtHgpUG9fsUohUBIeKg.png"/></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">表1:页数</figcaption></figure><p id="2363" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">定义:</strong></p><p id="56fb" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">流失用户</strong>:拥有注销确认页面日志的用户。</p><p id="5fb0" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">部分特征数据(清洗后)</strong>:</p><p id="41a4" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">行数:~278k</p><p id="68c1" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">天数:64天(从2018年10月1日至2018年12月3日)</p><p id="8cb5" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">用户数量:225</p><p id="b870" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">流失行动次数:52次</p><p id="cc22" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">数据集只包括64天，所以很难比较和评估用户对取消的不同态度。然而，我们有173个未被调用的用户和52个用户，这似乎足以比较用户的不同态度。</p><p id="fd4c" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">当我们调查用户每小时的活动时，两组之间没有观察到不同的趋势。晚上的高峰时间通常是申请的高峰期。情节如下。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/a658d6875844eb2a11b124911777d203.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*Y9Lp_VLLV9ECTAfTEUrT4w.png"/></div></figure><p id="2d65" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">还分析了其他一些特征。其中一些看起来在搅动用户方面有所作为。然而，这里面临另一个问题。由于流失用户在所有用户中只占很小一部分，所以未流失用户的行为会发生显著变化。例如，下图显示了过去30天用户的在线天数。正如所看到的，毫无疑问，大量用户的平均值更高，但仍有许多未流失的用户几乎整天都在线。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/b80a62baf752480cd86f5f9cc678b3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*ygUpXNBCpXEkzMe7GBwbrw.png"/></div></figure><p id="b72e" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">这种情况在几乎所有的统计中都引起了问题。因此，收集了用户日志数量。从下面可以看出，很多用户几乎没有日志，只有少数用户生成了数量极高的日志。在我看来，这两种情况都应该被消除，因为低的数字不会产生有用的统计数据，而大量的数字可以观察到与一般情况不同的趋势，并打破模型的结构。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es md"><img src="../Images/6fd2cf04f5d34e675cc953127a78033b.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*DiCx9iPHYfuvLq8Lb9FjZA.png"/></div></figure><p id="0956" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">这里，在一些可视化之后，需要一个方法论。例如，首先我想知道一个没有搅动的用户上周的趋势是如何变化的。因此，我提取了所有数据中的上周数据，但随后我意识到这些数据对于被搅动的用户来说毫无意义，因为他们可能在上周之前已经搅动过了。这种情况可以让我们很容易地确定搅动的用户，但这是非常不现实的，因为模型回顾而不是进一步。</p><p id="0632" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">然后，我改进了我的策略，提取了他们上周的用户数据。然而，这也具有误导性。首先，这种情况导致所有的数据都无法盈利。使该模型变弱的主要问题是，虽然未被搅动的用户的数据在很长一段时间内是可用的，但是被搅动的用户的信息可能相对较少。</p><p id="c0b2" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">后来，我决定，对于任何类型的用户，这段时间都应该是均等的。此外，确定原点并将其评估为当前时间可以使模型更加真实。查看一段时间的数据，并试图猜测她是否会在下一次离开，这将提供更深入的见解。</p><p id="f597" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">为了分析用户，页面列是非常有用的。在这一栏中，我们可以计算用户听的歌曲数量，面临的错误数量，喜欢/不喜欢等。另一个特征是家访的数量，这有助于计算会话中活动的平均数量(例如歌曲的数量)。</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="8814" class="iq ir hi bd is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn bi translated"><strong class="ak">特性和特性工程</strong></h1><p id="45a9" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">在线天数</strong>:用户使用应用的天数。假设倾向于流失的用户可以有更少的活跃天数。然而，下图显示它在十天内不起作用。这一分析给出了这样一个想法，即被搅动的用户正在给应用程序最后一次机会，因此他们的活跃天数可能会增加。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es me"><img src="../Images/e45dca025d49f509a6a778cf1ec74d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*jrzf7IaXz450FVq8LqXuAw.png"/></div></figure><p id="bb4a" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">喜欢/不喜欢</strong>:竖起/放下大拇指的次数。这种情况与在线天数分析中的情况相同。同样，被搅动的用户显示出更多喜欢或不喜欢歌曲的倾向。这些特性对我们的模型很有帮助。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/1b47b68a1d7e023132fdfde0c4234558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*WBMrmNrc6WUcT-qLVUOnQQ.png"/></div></div></figure><p id="4962" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj"> listenedSongs </strong>:用户听过的歌曲数量</p><p id="5ecc" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">首页访问</strong>:用户返回首页的次数。同样，享受更多的应用程序可以导致更多的访问主页。可能，不活跃和未被调用的用户正在对统计数据进行加权。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/14064c41c7b4179b3ba1206d1c122c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*eSCcwiQGrRBEy0AKaANw5g.png"/></div></figure><p id="89f1" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">错误:</strong>用户可以得到错误，所以这个数据也是持有的。如果用户得到更多的错误，他们可以放弃使用该应用程序。下图在某种程度上证实了这一假设，但其他功能仍然面临同样的问题。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/2d6bd374a55721af3ce6be784de1d159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*_c-kxSCw04BfDgZBub_UEA.png"/></div></figure><p id="0918" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj"> differentArtists: </strong>这显示了用户在此期间收听了多少位不同的艺术家。该特征包括在特征工程中，但不包括在模型中，因为它没有显著的区别，并且与收听的歌曲数量高度相关。</p><p id="a05c" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj"> totalLogs: </strong>从名称可以看出，是用户创建的日志数量。</p><p id="7883" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">like ratio/dislike ratio:</strong>这些是喜欢和不喜欢占歌曲总数的比例。</p><p id="de5d" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">歌曲比例:</strong>所有日志中歌曲的比例。由于这是一个音乐应用程序，这个比率对于应用程序如何实现其目标至关重要。</p><p id="cecf" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hj">错误率:</strong>所有日志的错误率。这个比例也可以创造一个差异，而不仅仅是数字。例如，20个日志对于如此活跃的用户来说可能是微不足道的，但是对于不太活跃的用户来说可能是破坏性的。</p><p id="fed8" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">在评估不同的特征并比较分数之后，选择一些特征以获得更好的模型并避免过拟合。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/895ba35d820c8dd8c798cb00dc2b5e13.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*UlHAwS8x6aqwzCq5SmcnSQ.png"/></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">表2:功能</figcaption></figure><p id="6b47" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">关键的一步是澄清问题并提供所需的健壮性。该模型应包括功能和输出，他们的周期可以设置。如上所述，我创建了一个分别为20天和10天的培训和验证时间，但是它们仍然可以更改。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/19772f1525ec17f833ade5b1500c7a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xCaNaNd3cmCyh0XaoFQGag.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">图1:依赖于时间的特征工程方法</figcaption></figure><p id="40d2" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">数据被提取为要素列，输出为ifChurn列。主要的一点是，如果我们试图猜测今天，我们正在分析过去20天的数据，并试图猜测用户是否会在5天内流失。</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="3dd6" class="iq ir hi bd is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn bi translated"><strong class="ak">建模</strong></h1><p id="8581" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">为了能够应用机器学习算法，首先应该对数据进行拆分以进行验证。分割数据有两种方法。第一个是较早的数据可以用来训练数据，最后的时间间隔成为测试数据。这种方法更符合实际，因为它节省时间。这种方法也有随机性等缺点。此外，由于搅动的用户仅占数据的一小部分，我们试图用这种方法猜测相同的几个用户。因此，如果我们侥幸猜对或猜错，就可能导致数据拟合失误。</p><p id="4664" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">第二种方法是收集所有数据，对这些数据进行随机分割，得到训练和测试部分。这种方法对随机性更好，但缺乏真实性，因为我们试图用未来的数据来猜测过去的搅动。这两种方法都尝试在这个项目中，不幸的是，这些都没有区别。</p><p id="8ab9" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">Pyspark支持构建流水线和不同的机器学习算法。</p><p id="264c" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">管道通过三个步骤构建:</p><ul class=""><li id="8122" class="le lf hi jq b jr kn jv ko jz lg kd lh kh li kl lj lk ll lm bi translated">VectorAssembler:这一步是从数据集中提取特征并将它们矢量化。向量汇编程序将提供训练数据。</li><li id="b06e" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">索引器:这是为保存标签列而生成的。模型将试图找到这个创建的标签。</li><li id="fc3a" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">机器学习算法:最后一步是机器学习模型能够训练和转换数据。该项目中使用了三种算法:</li></ul><ol class=""><li id="32a3" class="le lf hi jq b jr kn jv ko jz lg kd lh kh li kl mj lk ll lm bi translated">逻辑回归</li></ol><p id="5a15" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">2.决策树分类器</p><p id="8efc" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">3.随机森林分类器</p><p id="a3a5" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">该模型可以通过不同的时间段来构建，如20天的训练期和5天的验证期。建立这些模型后，评估就开始了。</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="667c" class="iq ir hi bd is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn bi translated"><strong class="ak">评估与结论</strong></h1><p id="43ba" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">所有模型都通过F1分数进行评估和比较。由于我们试图猜测搅动的用户，F1评分对我们来说是最好的评估者之一。流失的用户是由很少的数据组成的，所以试图猜测未流失的用户是有误导性的。例如，如果5%的用户流失，并且我们猜测没有任何用户会在没有任何模型的情况下流失，我们可以轻松达到95%的成功。然而，在F1评分中，只评估流失的用户或预测会流失的用户。比率1:流失用户占所有流失用户的比率比率2:流失用户占所有预计流失用户的比率。</p><p id="677e" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">f1 = 2 *(1/ratio1)+(1/ratio2))^-1</p><p id="3bcf" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">所有分数给0分。我们可以得出结论，功能应该改进。我们已经提取了比我们使用的更多的特征，但其他特征也不令人满意。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/5724a8efde6ee87af60e476a748fc019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFuFudLRt-eOVBG1_26HFQ.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">表3:不同时间段模型的F1值</figcaption></figure><p id="25c1" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">当我们把预测看做流失时，下面的行返回真实的流失。可以看出，用户数量很少，所以很难猜测他们。当我们分析概率时。</p><ul class=""><li id="4f98" class="le lf hi jq b jr kn jv ko jz lg kd lh kh li kl lj lk ll lm bi translated">为了更好地训练数据，数据应该被放大。</li><li id="2f9c" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">一些用户既不经常使用应用程序，也不离开它。这些用户主宰着数据。为了处理它，可以对每个周期分别进行边缘情况的消除。</li><li id="e666" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">在这个小的数据集中，大部分被搅动的用户在一开始就取消了他们的会员资格。这导致这些用户没有足够的数据量。</li><li id="dff2" class="le lf hi jq b jr ln jv lo jz lp kd lq kh lr kl lj lk ll lm bi translated">特色薄弱。即使建立一个健康的模型有障碍，零分是非常令人心碎的许多确定的特征。</li></ul><p id="7c6c" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">尽管没有一个模型给出令人满意的结果，但我们已经建立了一个现实世界的问题，有时很难预测如此小的子群体。而且，功能也需要改进。即使时间段在逻辑上是分开的，功能也不包括时间权重。在模型中，用户的最后活动可以被更加权。</p><p id="4d92" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">因为我们不能得到除零以外的任何分数，所以没有应用交叉验证。但是，如果能找到更好的特征，交叉验证也会有助于提高准确性。</p><p id="0cd3" class="pw-post-body-paragraph jo jp hi jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><a class="ae km" href="#_ftnref1" rel="noopener ugc nofollow">【1】</a>(2020年牛津高级学习词典中关于churn动词的定义)</p></div></div>    
</body>
</html>