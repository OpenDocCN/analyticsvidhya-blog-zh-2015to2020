<html>
<head>
<title>Living in Austin, Texas; Part 2 — Constructing a Pricing Model using Hedonic Regression for the Austin Rental Market</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">住在德克萨斯州奥斯汀；第2部分——使用Hedonic回归构建奥斯汀租赁市场的定价模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/living-in-austin-texas-part-2-constructing-a-rent-pricing-model-using-hedonic-regression-73bd3fd9266c?source=collection_archive---------7-----------------------#2019-09-11">https://medium.com/analytics-vidhya/living-in-austin-texas-part-2-constructing-a-rent-pricing-model-using-hedonic-regression-73bd3fd9266c?source=collection_archive---------7-----------------------#2019-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/aa95adf58dab2de47bf66f16894e9e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*8IKnTspmHOj7LEj6M0t6fQ.jpeg"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">从齐尔克公园看到的奥斯汀市中心——奥斯汀监视器</figcaption></figure><div class=""/><p id="3660" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">上一篇文章<a class="ae hr" rel="noopener" href="/@vmusgrove86/living-in-austin-texas-part-1-housing-trends-with-time-series-analysis-e131250f5c37">住在奥斯丁；第1部分</a>，我们使用<em class="jq">时间序列数据研究了奥斯汀住宅房地产市场的过去和当前趋势。</em>在第二部分的继续中，我们将深入了解奥斯汀租赁市场的各种趋势和特征，包括初步了解租金价格时间序列数据，以及影响给定奥斯汀公寓租金价格的因素。</p><p id="e523" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">该信息对于公寓搜索非常有用，因为它可以识别奥斯汀地区的那些公寓是“好”交易、“坏”交易，或者仅仅是“好”交易。公寓开发商可以利用这种分析来规划奥斯汀周围的地点或位置，在这些地点或位置建造新的公寓综合体将有很好的机会获得高利润。公寓管理公司也可能发现了解如何准确地给他们的公寓定价是有竞争力的。</p><p id="36d4" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">奥斯汀租赁价格的时间序列:</strong></p><p id="e9b6" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我们可以使用上一篇文章中的相同方法来查看Zillow从2010年9月到2019年7月针对每个美国邮政编码的一居室公寓的租金中值(Zip _ MedianRentalPrice _ 1 bedroom . CSV):</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="36c7" class="ka kb hu jw b fi kc kd l ke kf">df=pd.read_csv("Zip_MedianRentalPrice_1Bedroom.csv",encoding='latin-1')</span></pre><p id="6847" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">Zillow的数据只是从2010年9月到2019年7月，但这对我们的分析应该足够了！</p><p id="ca9b" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">执行与本文第一部分相同的代码，我们得到以下按邮政编码划分的月租金中位数的时间序列图:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kg"><img src="../Images/56faf6a06df129c8f247f00827037767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDC5_CCb3iSrK6txdxQxlQ.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">年月(x轴)与月租金中位数(y轴)的关系图</figcaption></figure><p id="c6c7" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">尽管许多邮政编码区的租金价格随着时间的推移而上涨(特别是在过去的2-4年里，某些邮政编码区)，但这种价格上涨似乎没有第一部分中讨论的奥斯汀房地产价格上涨那么剧烈，至少乍一看是这样。</p><p id="3de5" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">作为一名长期居住在奥斯汀的居民，有些事情让我印象深刻:</p><ul class=""><li id="7571" class="kl km hu iu b iv iw iz ja jd kn jh ko jl kp jp kq kr ks kt bi translated"><strong class="iu hv">那些日子一去不复返了——现在如果你能以每月不到1000美元的价格买到房子，那你就是幸运的了。</strong></li><li id="87e2" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated"><strong class="iu hv"> <em class="jq">大多数邮政编码的租金中位数在1000美元到1400美元之间:</em> </strong>从图表中可以看出，80%到90%的邮政编码都在这个范围内，只有几个邮政编码的月租金中位数超过了2000美元，分别是78701美元(蓝色，上图)和78703美元(橙色，上图)。</li></ul><p id="80e4" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">上述数据可以让我们了解奥斯汀地区租赁价格的历史。但同样重要的是，如果不能提供更多信息的话，我们可以更仔细地看看关于当前租赁市场的<em class="jq">的<em class="jq">细节</em>。为此，我们将不得不使用另一个数据源—<a class="ae hr" href="https://www.apartments.com/" rel="noopener ugc nofollow" target="_blank">Apartments.com</a>！</em></p><p id="9606" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">从Apartments.com获取数据</strong></p><p id="c408" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我在Github上使用了以下代码的修改版本:<a class="ae hr" href="https://github.com/adinutzyc21/apartments-scraper" rel="noopener ugc nofollow" target="_blank">https://github.com/adinutzyc21/apartments-scraper</a>。注意，这个脚本需要<em class="jq"> beautifulsoup </em> Python库。确保小心/尊重你访问Apartments.com网站的次数！！</p><p id="016b" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">收集完数据后，我们可以打开一个电子表格程序(我使用的是LibreOffice Calc)来查看我们正在处理的内容:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kz"><img src="../Images/d36f0fa7ab27a618d44da34185253e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d2qWUMxlkkpXHmXxJGT6ew.png"/></div></div></figure><p id="aab3" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">因此，我们的表中有几列数据(“[公寓]名称”、“联系人”、“地址”、“大小”、“租金”等)。).现在我们有了数据，我们必须提醒自己这个数据分析项目的目标是什么。在本帖中，我们关注的是使用基于经验数据的各种参数(如位置和/或公寓设施)对公寓租金进行<em class="jq">特征回归</em>或<em class="jq">特征建模</em>。相应地，在我们进一步深入之前，让我们对什么是享乐回归有一个正确的理解。</p><p id="ca0c" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">什么是<em class="jq">享乐回归</em>？</strong></p><p id="6fc0" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">维基百科将<a class="ae hr" href="https://en.wikipedia.org/wiki/Hedonic_regression" rel="noopener ugc nofollow" target="_blank">享乐回归</a>定义为一种<a class="ae hr" href="https://en.wikipedia.org/wiki/Revealed_preference" rel="noopener ugc nofollow" target="_blank">揭示偏好</a>的方法，用于估算一种商品的<a class="ae hr" href="https://en.wikipedia.org/wiki/Demand" rel="noopener ugc nofollow" target="_blank">需求</a>，或者等价地，它对消费者的<a class="ae hr" href="https://en.wikipedia.org/wiki/Value_(economics)" rel="noopener ugc nofollow" target="_blank">价值</a>。它将被研究的项目分解成其组成特征，并获得每个特征的贡献值的估计值维基百科进一步给出了对享乐定价法的简明解释(特别适用于房屋，但也适用于出租公寓):</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es la"><img src="../Images/49b96e3e0dd6991a61097b82f3451f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4aFTVw-_MneEv7GyWhrTg.png"/></div></div></figure><p id="2a28" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">这里，我们将使用一个简单的线性模型用于我们的回归分析——公寓的月租金(<em class="jq">Y；</em><em class="jq">因变量</em>将被建模为公寓位置(由有限可能的邮政编码表示)的<em class="jq">线性组合</em>，以及给定公寓的属性、特征和性质(例如公寓的大小或公寓是否包括游泳池)，这将是我们模型中的<em class="jq"> X </em>或<em class="jq">自变量</em>。</p><p id="08c1" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">提取、清理和格式化数据</strong></p><p id="a9c5" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">首先，让我们使用Pandas导入原始数据:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="b696" class="ka kb hu jw b fi kc kd l ke kf">import numpy as np<br/>import pandas as pd</span><span id="aa7f" class="ka kb hu jw b fi lb kd l ke kf">df=pd.read_csv("output.csv",encoding='latin-1')<br/>df.head()</span></pre><p id="ac99" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">既然我们的Python实例中有了原始数据，我们就可以开始提取、清理数据，并将其格式化为有用的信息。</p><p id="d3a3" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">首先，让我们确保我们的“租金”变量可以表示为美元金额(理想情况下为浮点数):</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="321a" class="ka kb hu jw b fi kc kd l ke kf">temp_df = df["Rent"].str.split(" - ", n = 1, expand = True)<br/>df["Rent_low"] = temp_df[0]<br/>df["Rent_high"] = temp_df[1]</span><span id="ca66" class="ka kb hu jw b fi lb kd l ke kf">df.Rent_low = df.Rent_low.str.replace("$", "")<br/>df.Rent_low = df.Rent_low.str.replace(",", "")<br/>df.Rent_high = df.Rent_high.str.replace(",", "")</span><span id="ceab" class="ka kb hu jw b fi lb kd l ke kf">df = df[df.Rent_low != "Call for Rent"]</span><span id="6565" class="ka kb hu jw b fi lb kd l ke kf">df.Rent_low = df.Rent_low.astype("float")<br/>df.Rent_high = df.Rent_high.astype("float")</span></pre><p id="b293" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">上面的代码提取了给定公寓楼的低租金和高租金，并将它们作为单独的行添加到DataFrame对象中，这些行被正确格式化为“float”数据类型。</p><p id="9bfa" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">下面的代码将从DataFrame的“Address”列中提取邮政编码，将其添加为另一列，并将其转换为“int”数据类型:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="3030" class="ka kb hu jw b fi kc kd l ke kf">df["Zip"] = df.Address.str.extract(pat = '(TX 7....)')<br/>df.Zip = df.Zip.str.replace("TX ", "")<br/>df.Zip = df.Zip.astype("int")</span></pre><p id="dc1f" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">现在我们可以做一些探索性的分析，看看我们的邮政编码样本量有多好。让我们计算数据中的行数，按邮政编码分组:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="f664" class="ka kb hu jw b fi kc kd l ke kf">zip_count = df.groupby("Zip").count()<br/>zip_count["Option Name"].sort_values()</span></pre><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es lc"><img src="../Images/729fd3615b6488bc335d57e681978dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*khhhk1xu4OXP31MRvYXsfQ.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">每个邮政编码的行数</figcaption></figure><p id="8b46" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">好的，看起来我们的数据中至少有几个邮政编码只有2行或更少(即样本/数据点)。让我们将极低样本数的邮政编码(少于3个样本)合并到较大的邮政编码中，以便从较大样本数的邮政编码中获得更好的统计方法。</p><p id="31f4" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我不得不手动计算出哪个低样本计数的邮政编码接近哪个其他的邮政编码(注意，我们的分析的完整实现可以使这成为一个自动化的过程)。</p><p id="b1d4" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">生成的代码如下所示:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="2596" class="ka kb hu jw b fi kc kd l ke kf">df.loc[df["Zip"] == 78721, "Zip"] = 78723<br/>df.loc[df["Zip"] == 78737, "Zip"] = 78749<br/>df.loc[df["Zip"] == 78621, "Zip"] = 78653<br/>df.loc[df["Zip"] == 78630, "Zip"] = 78613<br/>df.loc[df["Zip"] == 78641, "Zip"] = 78613<br/>df.loc[df["Zip"] == 78645, "Zip"] = 78613<br/>df.loc[df["Zip"] == 78653, "Zip"] = 78749<br/>df.loc[df["Zip"] == 78734, "Zip"] = 78732<br/>df.loc[df["Zip"] == 78737, "Zip"] = 78739<br/>df.loc[df["Zip"] == 78620, "Zip"] = 78732</span></pre><p id="6dca" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">从原始数据中提取享乐变量(更多的提取、清理和格式化)</strong></p><p id="c249" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">现在是有趣的部分！让我们开始<em class="jq">享乐回归</em>分析，从我们的数据中挑选出一些变量，这些变量包括会直观地影响租赁物业价格的属性或特征。这里有很大的实验空间，所以我挑选了以下我认为<em class="jq">可能</em>对预测公寓租金有用的属性/特征:</p><ul class=""><li id="8b4e" class="kl km hu iu b iv iw iz ja jd kn jh ko jl kp jp kq kr ks kt bi translated">花岗岩柜台面</li><li id="9736" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">不锈钢器具</li><li id="2494" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">硬木地板</li><li id="6d1b" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">岛式厨房</li><li id="a0c7" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">健身中心</li><li id="4e5c" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">泳池</li><li id="1cc3" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">水疗/桑拿</li><li id="f8c6" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">市区景观</li><li id="2489" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">挨家挨户收垃圾</li><li id="8dfc" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">体育俱乐部会所；音频社交软件（网友戏称“聊斋”）</li><li id="7fe2" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">小屋</li></ul><p id="35dd" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">还需要更多的手工工作来确定哪些列包含上述变量。下面是从原始数据中提取这些信息的Python代码:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="464e" class="ka kb hu jw b fi kc kd l ke kf">df["Granite"] = df["Kitchen"].str.contains("Granite", na = False)<br/>df["Stainless_Steel"] = df["Kitchen"].str.contains("Stainless Steel", na = False)<br/>df["Hardwood_Floors"] = df["Living Space"].str.contains("Hardwood Floors", na = False)<br/>df["Island_Kitchen"] = df["Kitchen"].str.contains("Island Kitchen", na = False)<br/>df["Fitness_Center"] = df["Gym"].str.contains("Fitness Center", na = False)<br/>df["Pool"] = df["Gym"].str.contains("Pool", na = False)<br/>df["Spa_Sauna"] = df["Gym"].str.contains("Spa|Sauna", na = False)<br/>df["Downtown_View"] = df["Amenities"].str.contains("Downtown View", na = False)<br/>df["Trash_Pickup"] = df["Services"].str.contains("Trash Pickup - Door to Door", na = False)<br/>df["Clubhouse"] = df["Indoor Info"].str.contains("Clubhouse", na = False)<br/>df["Cabana"] = df["Outdoor Info"].str.contains("Cabana", na = False)</span></pre><p id="3d72" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">现在让我们从数据中提取每套公寓的建造年份(在我们的回归中用作另一个快乐依赖变量):</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="292b" class="ka kb hu jw b fi kc kd l ke kf">df["Built_year"] = df["Property Info"].str.extract(pat = '(Built in ....)')<br/>#df["Reno_year"] = df["Property Info"].str.extract(pat = '(Renovated in ........)')<br/>df.Built_year = df.Built_year.str.replace("Built in ", "")<br/>df.Built_year = df.Built_year.astype("int")<br/>#df.Reno_year = df.Reno_year.str.replace("Renovated in ", "")<br/>#df.sort_values(by = "Built_year", ascending = False).head()<br/>df["Built_year"]=df["Built_year"]-1900</span></pre><p id="b181" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">平方英尺也可能有助于解释公寓的价格:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="5134" class="ka kb hu jw b fi kc kd l ke kf">df["Sq_ft"] = df["Size"].str[4:8]<br/>df.Sq_ft = df.Sq_ft.str.replace(",", "")<br/>df.Sq_ft = df.Sq_ft.str.strip().astype("float")</span></pre><p id="3a08" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">让我们估算那些缺少平方英尺数据的公寓的平方英尺大小。我们通过计算那些有平方英尺数据的公寓的平均每英尺金额来做到这一点:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="10df" class="ka kb hu jw b fi kc kd l ke kf">df["Dollar_per_ft"] = df.Rent_low / df.Sq_ft<br/>m = df.Dollar_per_ft.mean()<br/>print(m)</span><span id="5ba3" class="ka kb hu jw b fi lb kd l ke kf">1.6710012889876373</span></pre><p id="a5c8" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">使用上述平均值(约1.67美元/英尺)以及单个公寓的租金价格，我们可以估算出那些缺少平方英尺数据的公寓的平方英尺:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="ce55" class="ka kb hu jw b fi kc kd l ke kf">df.loc[df['Sq_ft'].isna(), "Sq_ft"] = df.loc[df['Sq_ft'].isna(), "Rent_low"] / m</span></pre><p id="227a" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">既然我们已经完成了每英尺美元的专栏，让我们放下它:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="4209" class="ka kb hu jw b fi kc kd l ke kf">df.drop(columns=["Dollar_per_ft"], inplace = True)</span></pre><p id="4b19" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">好的，现在让我们在进行回归之前提取一些最后的数据。以下Python语句将为每个邮政编码创建虚拟变量，以更好地表示我们回归的数据(记住在回归之前使用<em class="jq"> drop_first = True </em>删除一个虚拟变量):</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="ded2" class="ka kb hu jw b fi kc kd l ke kf">df_dummies = pd.get_dummies(df, columns = ["Zip"], drop_first = True)</span></pre><p id="1ad2" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">要存储一个只有我们的回归变量/自变量(<em class="jq"> X </em>)的数据框，让我们剥离不再需要的列，并查看我们最终确定的信息<em class="jq"> X </em>数据框:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="5f7c" class="ka kb hu jw b fi kc kd l ke kf">regressors = list(range(25, len(df_dummies.columns)))</span><span id="82ac" class="ka kb hu jw b fi lb kd l ke kf">x = df_dummies.iloc[:,regressors]<br/>x.info()</span></pre><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es ld"><img src="../Images/3b3c5bef22b8103617ea06f8e8692d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*-XmyR7pjsMpohXTFva6K-Q.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">最终独立变量(X)数据框架</figcaption></figure><p id="ae04" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我们还为我们的预测变量提取了一个数据框架(在本例中为“Rent_low”，表示给定公寓的最低月租金报价):</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="94d0" class="ka kb hu jw b fi kc kd l ke kf">y = df["Rent_low"]</span></pre><p id="16ce" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">太好了！现在我们终于可以开始生成我们的快乐回归模型了。</p><p id="d93d" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">生成Hedonic回归模型</strong></p><p id="8d9a" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">使用以下代码:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="41d2" class="ka kb hu jw b fi kc kd l ke kf">import statsmodels.api as sm</span><span id="c70a" class="ka kb hu jw b fi lb kd l ke kf">model = sm.OLS(y, x.astype(float))<br/>results = model.fit()</span></pre><p id="1aab" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">输出模型参数</strong></p><p id="5547" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">使用以下代码:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="3a8e" class="ka kb hu jw b fi kc kd l ke kf">print(results.summary())</span></pre><p id="4f4f" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我们从<em class="jq"> OLS </em>模型的输出中得到以下摘要:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es le"><img src="../Images/0571eb7613ca9bf0aac90f0e4459e772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*0tCCNaz7ikUC77b5X1513g.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">OLS模型的摘要输出，包括线性系数(coef)、标准误差(std err)、t得分(t)、P值(P&gt;|t|)、置信区间([0.025±0.075])和R (R平方)值。</figcaption></figure><p id="e43c" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">分析输出</strong></p><p id="94e1" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">虽然一些独立变量似乎非常重要，并且对租金价格有很大的影响(例如，Downtown_View，Zip_78701)，但有些出乎意料的是，其他独立变量在该模型中似乎不太重要(例如，花岗岩、不锈钢、硬木地板)。鉴于这只是我们最初的模型(我们仅仅是用直觉想出来的)，那么问题就变成了——我们如何改进这个模型？</p><p id="13df" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">检查多重共线性</strong></p><p id="9eba" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">首先，我们可能应该找出哪些变量具有高水平的共线性，并最小化共线性的不利影响:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="6cd0" class="ka kb hu jw b fi kc kd l ke kf">dfn = df_dummies.iloc[:,25:32]<br/>print(dfn.corr())</span></pre><p id="59f8" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">输出:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es lf"><img src="../Images/93a252cc831b16b6e40dc77625e8c29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*xb2RM_AP_DHfXL9rDAl5PA.png"/></div></figure><p id="8ccf" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">更加丰富多彩的可视化输出:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="57b0" class="ka kb hu jw b fi kc kd l ke kf">plt.matshow(dfn.corr())<br/>plt.show()</span></pre><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es lg"><img src="../Images/91827b7c64dda49ede494d87a6039964.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*ndB-d3d7ZoKT9nLCxGTaBw.png"/></div></figure><p id="e6ce" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我们可以看到，花岗岩柜台、不锈钢器具和硬木地板具有中度到高度的相关性，因此一种解决方案是通过加法将这三个变量合并为一个变量(一个名为“GG_SS_HF”的新列)，并删除这三列:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="06ae" class="ka kb hu jw b fi kc kd l ke kf">df["GG_SS_HF"] = df["Granite"].astype("float") + df["Stainless_Steel"].astype("float") + df["Hardwood_Floors"].astype("float")</span><span id="9e0a" class="ka kb hu jw b fi lb kd l ke kf">...<br/>...<br/>#NOTE: rewrite df_dummies using GG_SS_HF in df<br/>...<br/>...</span><span id="4eff" class="ka kb hu jw b fi lb kd l ke kf">df_dummies.drop(columns=["Granite", "Stainless_Steel", "Hardwood_Floors"], inplace = True)</span></pre><p id="cf21" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">去除统计上不重要的独立变量</strong></p><p id="2d7d" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">其次，我们应该从模型中移除那些在统计上非常不重要的变量<em class="jq"/>。移除这些变量可以最小化它们可能对我们的模型产生的任何混淆效应。</p><p id="f053" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">使用以下代码删除这些列:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="7700" class="ka kb hu jw b fi kc kd l ke kf">df_dummies.drop(columns=["Fitness_Center", "Spa_Sauna", "Trash_Pickup", "Cabana"], inplace = True)</span><span id="2f80" class="ka kb hu jw b fi lb kd l ke kf">regressors = list(range(25, len(df_dummies.columns)))</span><span id="53fb" class="ka kb hu jw b fi lb kd l ke kf">x = df_dummies.iloc[:,regressors]</span><span id="28ac" class="ka kb hu jw b fi lb kd l ke kf">model = sm.OLS(y, x.astype(float))<br/>results = model.fit()</span></pre><p id="b010" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我决定保留“Pool”和“Clubhouse”列，只是为了看看它们是否会变得更加重要，因为我们已经调整了模型参数。</p><p id="4b90" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">好，让我们检查一下在第二次迭代中我们的模型参数是什么:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="9504" class="ka kb hu jw b fi kc kd l ke kf">print(results.summary())</span></pre><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es lh"><img src="../Images/3ca92ea1d12fdf31dab1615eed35bfb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*WHMSRBJXlI6NRAgiDtablw.png"/></div></figure><p id="fd73" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">现在，我们的几个变量在统计意义上增加了(相对于我们享乐模型的第一次迭代)。比如GG_SS_HF现在是95%水平显著，Pool几乎是75%水平显著，Clubhouse几乎是90%水平显著。</p><p id="482f" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">那么，这些数字到底意味着什么呢？</p><ul class=""><li id="d554" class="kl km hu iu b iv iw iz ja jd kn jh ko jl kp jp kq kr ks kt bi translated"><strong class="iu hv"> <em class="jq"> GG_SS_HF: </em> </strong>给定该变量的系数16.3894，我们的模型预测花岗岩柜台、不锈钢器具和硬木地板的<em class="jq">每件</em>将多花费15美元/月。</li><li id="a1f9" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated"><strong class="iu hv"> <em class="jq">泳池:</em> </strong>在公寓楼里有一个泳池可能会增加23美元左右的租金，但这似乎不是一个非常显著的因素(偏差约为+/-20美元)。</li><li id="8636" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated"><strong class="iu hv"> <em class="jq">市中心_查看:</em> </strong>这是一个对公寓定价非常显著、非常有影响力的变量。上面的模型预测，一个租房者每个月要多付大约200美元，仅仅是为了市区的风景。请注意，我们的分析没有<em class="jq">而不是</em>查看市中心的景色是好还是不好！</li><li id="68c2" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated"><strong class="iu hv"> <em class="jq">建成_年份:</em> </strong>也高度显著，我们的模型估计，对于每年<em class="jq"/>一处房产的房龄，租金减少5.63美元。这很有道理，但最好能有一个确切数字来说明租金价值下降与公寓年龄的关系。</li><li id="d89e" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated"><strong class="iu hv"> <em class="jq"> Sq_ft: </em> </strong>再次，高度显著。我们的模型估计，人们将为每平方英尺的居住空间支付平均0.69美元(假设其他变量不变)。</li></ul><p id="f3f5" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我们将模型的第二次迭代应用于我们当前的数据，看看我们的模型在哪里表现良好，在哪里表现不佳，如何？为了获得每个数据点的预测租金值(以及预测租金和实际租金之间的差异)，我们执行以下代码:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="f208" class="ka kb hu jw b fi kc kd l ke kf">df["Predicted_rent_low"] = results.fittedvalues<br/>df["Delta"] = df.Predicted_rent_low - df.Rent_low</span></pre><p id="adf0" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">并写入. csv文件以在电子表格中查看结果:</p><pre class="jr js jt ju fd jv jw jx jy aw jz bi"><span id="fca2" class="ka kb hu jw b fi kc kd l ke kf">df.to_csv("result.csv")</span></pre><p id="b7ce" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">模型表现好的地方:</strong></p><ul class=""><li id="6677" class="kl km hu iu b iv iw iz ja jd kn jh ko jl kp jp kq kr ks kt bi translated">公寓名称:<a class="ae hr" href="https://www.apartments.com/broadstone-crossing-austin-tx/5zg30sm/" rel="noopener ugc nofollow" target="_blank">宽石渡</a>；预计租金= 1150美元；实际租金= 1170美元；delta =-20美元。</li><li id="27fb" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">公寓名称:<a class="ae hr" href="https://www.apartments.com/marquis-soco-austin-tx/pdh91xs/" rel="noopener ugc nofollow" target="_blank">侯爵索科</a>；预计租金= 1264美元；实际租金= 1250美元；delta =+14美元。</li><li id="4ac8" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">公寓名称:<a class="ae hr" href="https://www.apartments.com/bexley-at-whitestone-austin-tx/07hxs60/" rel="noopener ugc nofollow" target="_blank">白石镇的贝克斯利</a>(我目前居住的地方)；预计租金= 1163美元；实际租金= 1069美元；Delta = +$94。</li></ul><p id="b07d" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">模特表现差的地方:</strong></p><ul class=""><li id="23dd" class="kl km hu iu b iv iw iz ja jd kn jh ko jl kp jp kq kr ks kt bi translated">户型名称:<a class="ae hr" href="https://www.apartments.com/penthouse-austin-tx/6wyg4ts/" rel="noopener ugc nofollow" target="_blank">复式</a>；预计租金= 1510美元；实际租金= 1055美元；delta =+455美元。</li><li id="c343" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">公寓名称:<a class="ae hr" href="https://www.apartments.com/link-austin-tx/ppv1dpt/" rel="noopener ugc nofollow" target="_blank">链接</a>；预计租金= 975美元；实际租金= 1575美元；delta =-600美元。</li><li id="abd0" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated">公寓名称:<a class="ae hr" href="https://www.apartments.com/mosaic-at-mueller-austin-tx/mdgjmyk/" rel="noopener ugc nofollow" target="_blank">缪勒马赛克</a>；预计租金= 1147美元；实际租金= 1512美元；delta =-365美元。</li></ul><p id="c1fe" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated"><strong class="iu hv">总结思路和潜在未来分析</strong></p><p id="566b" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">这一分析实际上只是对奥斯汀租赁市场高度深入分析的皮毛。享乐回归模型能够获得许多输入变量的统计显著值，并可以进一步扩展到包括其他变量或更多数据。</p><p id="b424" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">例如，在本分析中，仅使用了粗略的租金衡量标准(一个单一的“租金低”数字代表<em class="jq">整个公寓楼</em>)。进一步的分析可以着眼于每个公寓小区内的单个公寓的租金，以增加模型中使用的样本数量。事实上，这就是为什么这里设计的模型无法准确预测至少一些样本的租金的一个重要原因(例如，因为数据点是错误的/不准确的)。</p><p id="6461" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">给定数据中的模式，还可以进一步微调和调整模型参数。例如，可以测试GG_SS_HF变量是否随地理位置而变化(这意味着市区公寓中花岗岩/不锈钢/硬木的成本可能远远高于郊区公寓中花岗岩/不锈钢/硬木的成本)。查看上面的相关性数据，我们可以看到Pool和Fitness_Center也高度相关，因此一种选择是将它们合并到一个变量中(或者执行<a class="ae hr" href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="noopener ugc nofollow" target="_blank">主成分分析</a>)。</p><p id="ea6f" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">尽管可以对其进行显著的改进，但当前的模型对于那些围绕租赁物业做出明智决策的人和玩家来说仍然非常有用:</p><ul class=""><li id="6c6c" class="kl km hu iu b iv iw iz ja jd kn jh ko jl kp jp kq kr ks kt bi translated"><em class="jq">在公寓搜索</em>中，我们的模型可以识别奥斯汀地区的那些公寓，它们是“好”的交易，“坏”的交易，或者只是“好”的交易。例如，我可以说，我目前租的公寓(位于白石酒店的<a class="ae hr" href="https://www.apartments.com/bexley-at-whitestone-austin-tx/07hxs60/" rel="noopener ugc nofollow" target="_blank">贝克斯利)的当前租赁交易是一笔“体面/不错”的交易，因为模型估计我的租金为1163美元，而我每月支付的租金约为960美元(对于一间卧室——完全公开！).</a></li><li id="eee2" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated"><em class="jq">对于一家公寓开发商</em>，可以分析奥斯汀周围的场地或位置的预期租金收入(根据我们的模型估计)，这可用于寻找具有正ROI的位置。例如，公寓开发商可能希望取消邮政编码<a class="ae hr" href="https://www.google.com/maps/place/78726/" rel="noopener ugc nofollow" target="_blank"> 78726 </a>和<a class="ae hr" href="https://www.google.com/maps/place/78724/" rel="noopener ugc nofollow" target="_blank"> 78724 </a>，因为根据我们的hedonic回归模型预测，这些邮政编码在我们的数据集中具有最低的估计租金。</li><li id="d0d6" class="kl km hu iu b iv ku iz kv jd kw jh kx jl ky jp kq kr ks kt bi translated"><em class="jq">公寓管理公司</em>也可以了解如何准确地给他们的公寓定价，以便在竞争中具有竞争力。例如，我们的模型表明<a class="ae hr" href="https://www.apartments.com/ashton-austin-austin-tx/dfkp6mk/" rel="noopener ugc nofollow" target="_blank">阿什顿奥斯汀</a>的价格过高(预计租金= 2004美元；实际租金= 2793美元)。在我写这篇文章的时候，阿什顿酒店的租金已经下降到了2767美元。所以也许阿什顿管理层意识到他们定价过高？也许术语“定价过高”的用法可能取决于你独特的享乐偏好<a class="ae hr" href="https://en.wikipedia.org/wiki/Utility" rel="noopener ugc nofollow" target="_blank">/效用函数</a>！</li></ul><p id="36b4" class="pw-post-body-paragraph is it hu iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">Github上的Python代码链接:<a class="ae hr" href="https://github.com/vincent86-git/Austin_Housing" rel="noopener ugc nofollow" target="_blank">https://github.com/vincent86-git/Austin_Housing</a></p></div></div>    
</body>
</html>