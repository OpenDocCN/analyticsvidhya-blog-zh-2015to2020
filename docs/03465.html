<html>
<head>
<title>Tackling Depression with Machine Learning via Chatbot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过聊天机器人用机器学习解决抑郁症</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tackling-depression-with-machine-learning-via-chatbot-1e5f5546f36a?source=collection_archive---------0-----------------------#2020-02-03">https://medium.com/analytics-vidhya/tackling-depression-with-machine-learning-via-chatbot-1e5f5546f36a?source=collection_archive---------0-----------------------#2020-02-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5370228791d31976335039543085bf00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Gn2Q-MHkphkk2LbChXegA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://commons.wikimedia.org/wiki/User:Jayberries" rel="noopener ugc nofollow" target="_blank"> Jayberries </a>拍摄，在<a class="ae iu" href="https://en.wikipedia.org/wiki/en:Creative_Commons" rel="noopener ugc nofollow" target="_blank">知识共享</a>T4】署名下获得许可</figcaption></figure><p id="e140" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">抑郁症是一个沉默的杀手。人们抑郁的原因有很多，比如失去亲人、失业、看到令人不安的事情、骚扰等等。如果不能以健康的方式解决抑郁症，它会严重影响我们的活动表现和对生活的兴趣。</p><p id="9755" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我提出了一种机器学习可以用来治疗抑郁症的方法。想象一下，与聊天机器人或语音服务交谈，它检测你语气中的情绪，如愤怒、恐惧或悲伤，并基于此，语音服务试图让你开心。这正是我想出利用机器学习开发抑郁症助手聊天机器人的想法的原因。</p><h1 id="f0b8" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据:</h1><p id="4897" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">为了开发聊天机器人，我使用了可在<a class="ae iu" href="http://saifmohammad.com/WebPages/EmotionIntensity-SharedTask.html" rel="noopener ugc nofollow" target="_blank">http://saifmohammad . com/网页/emotion intensity-shared task . html</a>获得的Tweet情感分类数据集。在这个链接中有4种不同情绪的数据，即愤怒、恐惧、快乐和悲伤。在每一行数据中都有推文，然后是推文表达的情绪，然后是情绪的强度。数据集的外观示例如下所示:</p><blockquote class="kw"><p id="6b6c" class="kx ky hi bd kz la lb lc ld le lf js dx translated">我的血液沸腾愤怒0.875</p></blockquote><p id="a3b4" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">但并非愤怒数据集中的每条推特都表达了愤怒，比如:</p><blockquote class="kw"><p id="6df5" class="kx ky hi bd kz la lb lc ld le lf js dx translated">@someoone夸张地大笑起来。愤怒0.067</p></blockquote><p id="2ce0" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">尽管上面的推文出现在愤怒数据集中，但它并没有表达愤怒。这条推文末尾所附的愤怒程度也很明显。只是0.067，意思是，推文没有表达愤怒。其他情感的数据集也是如此</p><div class="ll lm ez fb ln lo"><a href="https://www.datadriveninvestor.com/2019/03/03/editors-pick-5-machine-learning-books/" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab dw"><div class="lq ab lr cl cj ls"><h2 class="bd hj fi z dy lt ea eb lu ed ef hh bi translated">DDI编辑推荐:5本让你从新手变成专家的机器学习书籍|数据驱动…</h2><div class="lv l"><h3 class="bd b fi z dy lt ea eb lu ed ef dx translated">机器学习行业的蓬勃发展重新引起了人们对人工智能的兴趣</h3></div><div class="lw l"><p class="bd b fp z dy lt ea eb lu ed ef dx translated">www.datadriveninvestor.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc io lo"/></div></div></a></div><p id="b3f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了开发一个完整的数据集，我下载了4种情绪的推文，并使用0.5的阈值解析它们，以便只有那些“强烈”表达分类情绪的推文保留在我的数据集中。</p><h1 id="5dcd" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">预处理:</h1><p id="3560" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在训练数据中，我们总共有3751条推文，938条测试数据，以及总共7578个包含表情符号的独特单词。在自然语言处理(NLP)任务中使用的标准预处理技术被实现如下:</p><ol class=""><li id="0cf0" class="md me hi ix b iy iz jc jd jg mf jk mg jo mh js mi mj mk ml bi translated">删除推文中出现的标点符号和特殊字符，包括@和#。</li><li id="67a9" class="md me hi ix b iy mm jc mn jg mo jk mp jo mq js mi mj mk ml bi translated">使推文小写。</li><li id="f0eb" class="md me hi ix b iy mm jc mn jg mo jk mp jo mq js mi mj mk ml bi translated">标记每条推文。</li><li id="7115" class="md me hi ix b iy mm jc mn jg mo jk mp jo mq js mi mj mk ml bi translated">对每个单词进行词干分析，以获得每个单词的最短可能形式。例如“检索”、“被检索”、“检索”简化为词干“检索”。</li><li id="78a2" class="md me hi ix b iy mm jc mn jg mo jk mp jo mq js mi mj mk ml bi translated">构建一个单词包模型和一个热编码。我们得到一个由7578个独特单词组成的单词包。我们对我们的数据使用一个热编码方法，即我们有长度为7578的向量，我们将1放在tweet中与单词包中的单词匹配的地方，将0放在其他地方。</li><li id="99fa" class="md me hi ix b iy mm jc mn jg mo jk mp jo mq js mi mj mk ml bi translated">最后，我们重组数据集，将数据分成80:20的训练集和测试集。</li></ol><h1 id="ddf0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">机器学习模型:</h1><p id="96ab" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">对于这个任务，我选择了使用神经网络，这是一个机器学习模型，并在不使用库的情况下从头设计了一个。我使用了一个单隐层神经网络，隐层有100个神经元，输出层有4个神经元，因为有4个基于4种情绪(愤怒、恐惧、快乐或悲伤)的类。下图给出了我们的神经网络模型的样子，为了便于理解，显示了所有数据矩阵的大小。</p><figure class="ms mt mu mv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/634567e61c31f48f02668096d88a8886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JfZb7xk_6MB4AdHm6y1p-A.png"/></div></div></figure><p id="f3fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在隐含层，我们将在每个神经元内部进行如下计算:<br/> <strong class="ix hj"> <em class="mw"> Z1=W1*X + b1 </em> </strong></p><p id="e9f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中“W1”是100(隐藏层中的神经元)x 7578(单词)，而“X”是我们的输入，其大小为7578(唯一单词)x 3751 (tweets)。“b1”是偏差为100(神经元)x 1。实际上，在训练集中X是3751 (tweets) x 7578(唯一单词),但在上面的图片中，我故意显示了输入X的转置维度，以使矩阵乘法有意义，因为W1不会给出与X的点积，否则，因为矩阵乘法发生时，矩阵1的行应该等于矩阵2的列，反之亦然。</p><p id="ba4e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，“Z1”将具有100×3751的大小，其将被ReLU激活函数视为，</p><figure class="ms mt mu mv fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/86c5434f5ba966027b38802e05729df9.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*QWm5urWNt2oa4RfSpY089w.jpeg"/></div></figure><p id="a0f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中“A1”是用ReLU激活函数公式处理的“Z1”。“A1”将与“Z1”具有相同的大小，即100x3751。</p><p id="2eed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在输出层，我们将在每个神经元中进行以下计算。我们将“A1”乘以权重向量“W2 ”,</p><p id="dd2b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="mw"> Z2 = W2*A1+b2 </em> </strong></p><p id="d7a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中“Z2”是“W2”和“A1”加上大小为4(输出层中的神经元)×1的偏置向量“b2”的点积。最后，“Z2”的大小为4x3751，因为“W2”的大小为4(输出层中的神经元)x 100(隐藏层中的神经元)，而“A1”的大小为100x3751。因此，他们的点积加上偏差“b2”将得到尺寸为4x3751的“Z2”。</p><p id="8c5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们应用softmax激活函数来确定tweet的类别，</p><figure class="ms mt mu mv fd ij er es paragraph-image"><div class="er es my"><img src="../Images/bea6cd1bbfa80508b160feeef7ed0b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*PCOMEbQvlGO7NxSh52lMWQ.jpeg"/></div></figure><p id="5892" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">简言之，softmax函数告诉我们输入属于特定类的可能性。我们预测概率比其他类高的类，作为预测输出类。</p><p id="1a54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">(很抱歉如此强调维度，但要让神经网络工作，理解这一点很重要)</p><h1 id="8aeb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">培训流程:</h1><p id="734d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">该模型经过50个历元的训练，学习率保持在0.1。在训练和验证之后，观察到集合丢失。可以看出，我们的模型收敛得很好。</p><figure class="ms mt mu mv fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/0a31e94729e97b412aecd64ac6f726a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*ryFfCHmiZBrveyyJGND5Hw.png"/></div></figure><p id="dd4f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的曲线显示了我们的模型的精度，它对所有的类都非常好。</p><figure class="ms mt mu mv fd ij er es paragraph-image"><div class="er es na"><img src="../Images/197b09ff164f52c7fccf90f8a3fe1c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*idq53jhV5d45yhd7IQ3M8A.png"/></div></figure><h1 id="9d22" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">工作中的聊天机器人</h1><p id="d907" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">训练完模型后，现在我们可以使用聊天机器人了。为此，我简单地在jupyter notebook中使用Python的输入命令，然后用户输入他/她的情感。该模型通过已训练的模型运行它，并告诉存在什么情绪以及该情绪在其他情绪中占主导地位的程度。</p><p id="fc32" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果用户情绪表达了愤怒/恐惧/悲伤，则聊天机器人向用户提供一个笑话。下图显示了这一过程。</p><figure class="ms mt mu mv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/25d817023975b1e3d15388dc982d7d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B9P3jUuyOLXZ3w64f8l1rA.png"/></div></div></figure><p id="a11e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果用户继续要求另一个笑话，它会继续下去。大约有70个笑话(实际上很搞笑)从一个文本文件加载并显示给用户。当用户写“否”时，聊天机器人退出。</p><h1 id="bda6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论:</h1><p id="5941" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这个简单的推文情绪分类扩展到抑郁症助手聊天机器人，可以证明是一个生命的救星，或者是一个为有困难的人打气的人。我希望我没有失去《黑客帝国》的读者</p><p id="87a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">未来的工作将包括一个比热编码方法更好的技术来建立一个健壮的模型。</p><p id="bd32" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我第一篇关于Medium.com的文章。希望这个项目对机器学习、NLP、神经网络的学习者有所帮助。代码和所有数据都在我的GitHub个人资料中，网址是https://GitHub . com/shayanalibhatti/Depression-Assistant-Chatbot。</p><p id="693b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你喜欢这个实现，不要忘了给一些掌声:)</p></div></div>    
</body>
</html>