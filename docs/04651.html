<html>
<head>
<title>Create a Linear Regression Model by Using R- Amusement Park Survey Case (1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用R-游乐园调查案例(1)建立线性回归模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-a-linear-regression-model-by-using-r-amusement-park-survey-case-1-e6f6d974db79?source=collection_archive---------13-----------------------#2020-03-27">https://medium.com/analytics-vidhya/create-a-linear-regression-model-by-using-r-amusement-park-survey-case-1-e6f6d974db79?source=collection_archive---------13-----------------------#2020-03-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/026123eb0fc4327f0d2ed7e7e716378b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6VEOo8AdC8soIuDG"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">奥尼莎·李在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="d95a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是我在R中学习回归时使用的与游乐园调查相关的案例(由<em class="jt">“R for Marketing Research and Analytics”作者Christopher N. Chapman，Elea McDonnell Feit，Springer提供)</em></p><h1 id="3756" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据信息</h1><p id="d990" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">在这项调查中，受访者报告了他们对各方面体验的满意度，如乘坐、游戏、等待和清洁。目标是看某个因素和整体满意度的关系。</p><h1 id="c411" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">理解数据</h1><p id="9429" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">像往常一样，我们读取数据以查看其维度和前几行。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="c86b" class="lg jv hi lc b fi lh li l lj lk">surveyData &lt;- read.csv(“http://goo.gl/HKnl74")<br/>dim(surveyData)<br/>head(surveyData)</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/7bd3e62f25cdc72a150a6d26dc02065b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iWYZb7zbSn19aFm1VjihqA.png"/></div></div></figure><p id="6b4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们通过绘制直方图来检查是否有扭曲的信息。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="7d81" class="lg jv hi lc b fi lh li l lj lk">#check the distribution of distance<br/>hist(surveyData$distance)</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/d936506b87bf74b3c8c7ebf8ce872ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYrXqgEtubDAOMLkPbOGNA.jpeg"/></div></div></figure><p id="9882" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个图表向我们展示了一个右偏的直方图。这不是我们所期望的，因为我们总是希望我们的数据接近正态分布。因此，我们通过对距离进行对数转换来创建一个新列。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="19ce" class="lg jv hi lc b fi lh li l lj lk">#add new column<br/>surveyData$logdist &lt;- log(surveyData$distance)<br/>head(surveyData)</span><span id="e26b" class="lg jv hi lc b fi ln li l lj lk">#check the distribution of log distance<br/>hist(surveyData$logdist)</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/5ac46fe471f547390e3869021b4c95bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P7OycWAlOG0ic2F-WdkPyA.png"/></div></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/a419d3b2c51bdc17951983577907b435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0VTq6XQ6gjiQ_Gfs8sKcw.jpeg"/></div></div></figure><h1 id="b731" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">建立线性模型</h1><p id="94aa" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">为了建立多元回归模型，我们将总体设为因变量(y)，将乘车、游戏、等待、清洁、num.child设为连续自变量(x1，x2，x3…)。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="d617" class="lg jv hi lc b fi lh li l lj lk">m1 &lt;- lm(overall ~ rides + games + wait + clean + num.child + logdist, data=surveyData)</span><span id="0331" class="lg jv hi lc b fi ln li l lj lk">#create the report<br/>summary(m1)</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/3afb038093a5a097e32dc28c8e767780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*weF23-L4OKnK49BncHXVgA.png"/></div></div></figure><h1 id="bdf7" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">解释报告</h1><p id="ae04" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">摘要中有几个关键部分需要解释:</p><h2 id="56d9" class="lg jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">p值:&lt; 2.2e16</h2><p id="42e2" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">p值的显著性取决于我们设定的置信区间(这里我设定为α = 0.05)。在这个模型中，p值&lt; 0.05，这意味着我们可以拒绝DV和IVs之间没有关系的无效假设。</p><h2 id="7439" class="lg jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">r平方值:0.6781</h2><p id="596c" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">然后我们检查R平方，看看模型有多好。这里的r平方是0.6781，意味着68%的数据可以用这个回归模型来解释。但是它有过度拟合的问题，当增加独立变量时，它不断增加，所以我们不能观察到我们的模型到底有多好。</p><h2 id="11d2" class="lg jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">调整后的R平方:0.6742</h2><p id="220c" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">由于R平方的限制，检查调整后的R平方会更准确。此处调整后的R平方为0.6742，请注意，它将始终小于R平方。</p><h1 id="a559" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">图形分析</h1><h2 id="8987" class="lg jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">散点图</h2><p id="eea0" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">我们也可以用散点图来看两件事的相关性。我选择一个我感兴趣的因素，看看它如何影响总体满意度。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="13d3" class="lg jv hi lc b fi lh li l lj lk">plot(overall~wait, data=surveyData,<br/>     xlab=”Satisfaction with Rides”, ylab=”Overall Satisfaction”)</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/35447f47ca6b7dc9b9dc89d57c830a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qz9zNGDNZwLgpHLt8xpqnw.jpeg"/></div></div></figure><p id="1e26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的图表可以明显看出，等待满意度和总体满意度之间存在正相关关系。</p><h2 id="009e" class="lg jv hi bd jw lr ls lt ka lu lv lw ke jg lx ly ki jk lz ma km jo mb mc kq md bi translated">残差图</h2><p id="1239" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">除了p值、R平方和调整后的R平方，我们还需要检查残差的分布。我们期望的完美残差图是随机散点图(如下图所示)，这意味着误差不是独立的，因为我们不想看到任何内部模式。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="ae50" class="lg jv hi lc b fi lh li l lj lk">plot(m1$fitted.values, m2$residuals)</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/04bb8fa8b4ee2e72c8b0dffa18c1b2ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lcxt822MenPulr_7uAbDGQ.jpeg"/></div></div></figure><h1 id="e08b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">预言；预测；预告</h1><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="cd07" class="lg jv hi lc b fi lh li l lj lk">#find coefficients<br/>betas = m1$coefficients</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/fb394fb248045ca7e70d7f495580a8cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZE1DXUemECHCq_zhhMtPqw.png"/></div></div></figure><p id="a493" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以得到了我们的回归方程:<strong class="ix hj">整体= -142.76 + 0.62 *乘车次数+ 0.14 *游戏次数+ 0.56 *等待次数+ 0.92 *清洁次数+ 3.61 * num.child + 1.08 * logdist。</strong>然后，我们可以将值放入变量中进行预测。</p><h1 id="7e2d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="4a2f" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">在这个线性回归模型中，R平方在67%左右，还不错，但是越高越好。所以接下来，我将在下一篇文章中解释如何使用R找到更好的模型。查看更多:“<a class="ae iu" rel="noopener" href="/analytics-vidhya/find-a-better-linear-regression-model-by-using-r-amusement-park-survey-case-2-864cf6ae81df">利用R-游乐园调查找到更好的线性回归模型(二)</a></p></div><div class="ab cl mh mi gp mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hb hc hd he hf"><h1 id="2079" class="ju jv hi bd jw jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr bi translated">关于我</h1><p id="5367" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">嗨，我是Kelly，一名具有新闻和传播背景的商业分析研究生，喜欢分享探索数据和有趣发现的生活。如果您有任何问题，请随时联系我，k【elly.szutu@gmail.com】T5T7】</p></div></div>    
</body>
</html>