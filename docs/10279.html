<html>
<head>
<title>Python Debugging</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 调试</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-debugging-4712152428ea?source=collection_archive---------23-----------------------#2020-10-11">https://medium.com/analytics-vidhya/python-debugging-4712152428ea?source=collection_archive---------23-----------------------#2020-10-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/5c5b7b81752830ce41d3232a19a9adc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ItInonRY1hkI3JoPtuSdg.jpeg"/></div></div></figure><div class=""/><p id="2472" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">调试告诉我们程序中的错误在哪里，以及为什么程序不能按预期运行。在 python 中，我们可以使用 pdb 模块进行调试。在 pdb 中，p 代表 python，db 代表调试器。pdb 为 python 实现了一个交互式调试环境。它的特点是让你暂停你的程序，查看变量的值，一步一步地观察程序的执行，这样你就能理解你的程序做了什么，并发现程序逻辑中的错误。这是一个带有命令行界面的简单实用程序，由<strong class="is hu">完成</strong>的主要工作。它<strong class="is hu">拥有</strong>你<strong class="is hu">需要</strong>的所有<strong class="is hu">调试器</strong>特性，但是如果你想稍微改进一下，你<strong class="is hu">可以</strong>使用 ipdb 扩展它，这将为<strong class="is hu">调试器</strong>提供来自 IPython 的特性。</p><h1 id="a293" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">启动调试器</h1><p id="8c2f" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">为了启动 python 中的调试器，我们必须首先导入 pdb 模块，它非常简单方便，不像其他语言，如 c++，java。在进入调试器之前，让我们以一个示例代码为例，试着理解代码流。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f290" class="la jp ht kw b fi lb lc l ld le"><strong class="kw hu">def</strong> <strong class="kw hu">count</strong>(n): #then <strong class="kw hu">it</strong> <strong class="kw hu">will</strong> <strong class="kw hu">come</strong> <strong class="kw hu">here</strong> (2)<br/>    <strong class="kw hu">for</strong> <strong class="kw hu">i</strong> <strong class="kw hu">in</strong> <strong class="kw hu">range</strong>(n): #(3)<br/>        <strong class="kw hu">print</strong>(i)    #(4)<br/>    <strong class="kw hu">return<br/>count</strong>(5) # <strong class="kw hu">execution</strong> <strong class="kw hu">will</strong> <strong class="kw hu">starts</strong> <strong class="kw hu">from</strong> <strong class="kw hu">here</strong> <strong class="kw hu">here</strong> <strong class="kw hu">marking</strong> <strong class="kw hu">it</strong> (1)</span><span id="adae" class="la jp ht kw b fi lf lc l ld le"><strong class="kw hu">out</strong>[]:<br/>0<br/>1<br/>2<br/>3<br/>4<br/></span></pre><p id="bb8c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们理解代码流，我已经提到了代码将如何逐行工作，正如我在代码中标记的 1 2 3 4 等等。假设我想将(4)作为断点，或者你可以说我想在那里停止执行，并想在打印语句之前检查每次循环更新的新值，那么我可以用下面的方法来做，我也可以用下面的方法来知道 I 和 n 的值:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3459" class="la jp ht kw b fi lb lc l ld le"><strong class="kw hu">import</strong> <strong class="kw hu">pdb</strong><br/><strong class="kw hu">def</strong> <strong class="kw hu">count</strong>(n):<br/>    <strong class="kw hu">for</strong> <strong class="kw hu">i</strong> <strong class="kw hu">in</strong> <strong class="kw hu">range</strong>(n):<br/>        <strong class="kw hu">pdb</strong>.set_trace()   #breakpoint<br/>        <strong class="kw hu">print</strong>(i)<br/>        <br/>    <strong class="kw hu">return</strong><br/><strong class="kw hu">count</strong>(5)</span><span id="7969" class="la jp ht kw b fi lf lc l ld le"><strong class="kw hu">out</strong>[]:</span><span id="41e4" class="la jp ht kw b fi lf lc l ld le">&gt; &lt;<strong class="kw hu">ipython-input-1-2a444758fe7c</strong>&gt;(5)<strong class="kw hu">count</strong>()<br/><strong class="kw hu">-</strong>&gt; <strong class="kw hu">print</strong>(i)<br/>(Pdb) <strong class="kw hu">list</strong><br/>  <strong class="kw hu">1</strong>  	<strong class="kw hu">import</strong> <strong class="kw hu">pdb</strong><br/>  <strong class="kw hu">2</strong>  	<strong class="kw hu">def</strong> <strong class="kw hu">count</strong>(n):<br/>  <strong class="kw hu">3</strong>  	    <strong class="kw hu">for</strong> <strong class="kw hu">i</strong> <strong class="kw hu">in</strong> <strong class="kw hu">range</strong>(n):<br/>  <strong class="kw hu">4</strong>  	        <strong class="kw hu">pdb</strong>.set_trace()   #breakpoint<br/>  <strong class="kw hu">5</strong>  <strong class="kw hu">-</strong>&gt;	        <strong class="kw hu">print</strong>(i)<br/>  <strong class="kw hu">6</strong>  	<br/>  <strong class="kw hu">7</strong>  	    <strong class="kw hu">return</strong><br/>  <strong class="kw hu">8</strong>  	<strong class="kw hu">count</strong>(5)<br/>[EOF]<br/>(Pdb) <strong class="kw hu">p</strong> <strong class="kw hu">i</strong><br/><strong class="kw hu">0</strong><br/>(Pdb) <strong class="kw hu">p</strong> <strong class="kw hu">n</strong><br/><strong class="kw hu">5</strong><br/>(Pdb) <strong class="kw hu">p</strong> <strong class="kw hu">locals</strong>()<br/>{'<strong class="kw hu">n</strong>': <strong class="kw hu">5</strong>, '<strong class="kw hu">i</strong>': <strong class="kw hu">0</strong>}<br/>(Pdb) <strong class="kw hu">p</strong>.globals()<br/>*** <strong class="kw hu">SyntaxError</strong>: <strong class="kw hu">invalid</strong> <strong class="kw hu">syntax</strong><br/>(Pdb) <strong class="kw hu">c</strong><br/><strong class="kw hu">0</strong><br/>&gt; &lt;<strong class="kw hu">ipython-input-1-2a444758fe7c</strong>&gt;(4)<strong class="kw hu">count</strong>()<br/><strong class="kw hu">-</strong>&gt; <strong class="kw hu">pdb</strong>.set_trace()   #breakpoint<br/>(Pdb) <strong class="kw hu">p</strong> <strong class="kw hu">i</strong><br/><strong class="kw hu">1</strong><br/>(Pdb) <strong class="kw hu">c</strong><br/><strong class="kw hu">1</strong><br/>&gt; &lt;<strong class="kw hu">ipython-input-1-2a444758fe7c</strong>&gt;(5)<strong class="kw hu">count</strong>()<br/><strong class="kw hu">-</strong>&gt; <strong class="kw hu">print</strong>(i)<br/>(Pdb) <strong class="kw hu">p</strong> <strong class="kw hu">i</strong><br/><strong class="kw hu">2</strong><br/>(Pdb) <strong class="kw hu">p</strong> <strong class="kw hu">locals</strong>()<br/>{'<strong class="kw hu">n</strong>': <strong class="kw hu">5</strong>, '<strong class="kw hu">i</strong>': <strong class="kw hu">2</strong>}<br/>(Pdb) <strong class="kw hu">h</strong></span><span id="0ca2" class="la jp ht kw b fi lf lc l ld le"><strong class="kw hu">Documented</strong> <strong class="kw hu">commands</strong> (type help &lt;topic&gt;):<br/>========================================<br/><strong class="kw hu">EOF</strong>    <strong class="kw hu">c</strong>          <strong class="kw hu">d</strong>        <strong class="kw hu">h</strong>         <strong class="kw hu">list</strong>      <strong class="kw hu">q</strong>        <strong class="kw hu">rv</strong>       <strong class="kw hu">undisplay</strong><br/><strong class="kw hu">a</strong>      <strong class="kw hu">cl</strong>         <strong class="kw hu">debug</strong>    <strong class="kw hu">help</strong>      <strong class="kw hu">ll</strong>        <strong class="kw hu">quit</strong>     <strong class="kw hu">s</strong>        <strong class="kw hu">unt</strong>      <br/><strong class="kw hu">alias</strong>  <strong class="kw hu">clear</strong>      <strong class="kw hu">disable</strong>  <strong class="kw hu">ignore</strong>    <strong class="kw hu">longlist</strong>  <strong class="kw hu">r</strong>        <strong class="kw hu">source</strong>   <strong class="kw hu">until</strong>    <br/><strong class="kw hu">args</strong>   <strong class="kw hu">commands</strong>   <strong class="kw hu">display</strong>  <strong class="kw hu">interact</strong>  <strong class="kw hu">n</strong>         <strong class="kw hu">restart</strong>  <strong class="kw hu">step</strong>     <strong class="kw hu">up</strong>       <br/><strong class="kw hu">b</strong>      <strong class="kw hu">condition</strong>  <strong class="kw hu">down</strong>     <strong class="kw hu">j</strong>         <strong class="kw hu">next</strong>      <strong class="kw hu">return</strong>   <strong class="kw hu">tbreak</strong>   <strong class="kw hu">w</strong>        <br/><strong class="kw hu">break</strong>  <strong class="kw hu">cont</strong>       <strong class="kw hu">enable</strong>   <strong class="kw hu">jump</strong>      <strong class="kw hu">p</strong>         <strong class="kw hu">retval</strong>   <strong class="kw hu">u</strong>        <strong class="kw hu">whatis</strong>   <br/><strong class="kw hu">bt</strong>     <strong class="kw hu">continue</strong>   <strong class="kw hu">exit</strong>     <strong class="kw hu">l</strong>         <strong class="kw hu">pp</strong>        <strong class="kw hu">run</strong>      <strong class="kw hu">unalias</strong>  <strong class="kw hu">where</strong>    </span><span id="716e" class="la jp ht kw b fi lf lc l ld le"><strong class="kw hu">Miscellaneous</strong> <strong class="kw hu">help</strong> <strong class="kw hu">topics</strong>:<br/>==========================<br/><strong class="kw hu">exec</strong>  <strong class="kw hu">pdb<br/></strong>(Pdb)_____________________________________________________</span></pre><p id="8518" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用上面提到的方法，我们可以在每一步检查 n 和 I 的值。如您所见，在最后一行(pdb)中，将命令作为输入来执行所需的信息，因此我们只需在该框中写入命令。</p><h1 id="31fe" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">PDB 司令部</h1><p id="21b5" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在使用 Python 调试器时，要记住一些<code class="du lg lh li kw b">pdb</code>命令及其简短形式。</p><ul class=""><li id="b510" class="lj lk ht is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated"><code class="du lg lh li kw b">args (a) : </code>打印当前函数的参数列表</li><li id="ca05" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">break (b) : </code>在程序执行中创建一个断点(需要参数)</li><li id="f9bc" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">continue (c</code>或<code class="du lg lh li kw b">cont) : </code>继续程序执行</li><li id="7c63" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">help (h) : </code>提供命令列表或指定命令的帮助</li><li id="2c64" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">jump (j) : </code>设置要执行的下一行</li><li id="b305" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">list (l) : </code>打印当前行周围的源代码</li><li id="2c7c" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">next (n) : </code>继续执行，直到到达或返回当前函数中的下一行</li><li id="b558" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">step (s) : </code>执行当前行，在第一个可能的时机停止</li><li id="1cfe" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">pp (pp) : </code>输出表达式的值</li><li id="0bfc" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">quit</code>或<code class="du lg lh li kw b">exit (q) : </code>中止程序</li><li id="8304" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">return (r) : </code>继续执行，直到当前函数返回</li></ul><p id="a713" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以从<a class="ae lx" href="https://docs.python.org/3/library/pdb.html" rel="noopener ugc nofollow" target="_blank"> Python 调试器文档</a>中阅读更多关于命令和使用调试器的信息。</p><h1 id="ffa6" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">如何使用交互式控制台调试 Python</h1><p id="7061" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">代码模块是 python 标准库的一部分，也是一个重要的工具，因为它可以用来模拟交互式解释器。该模块还为您提供了试验用 Python 编写的代码的机会。您可以使用 Python 程序中的代码模块来完成您的工作，而不是使用调试器来单步执行代码。它将停止执行并进入交互模式来检查代码。有了代码模块，你就可以利用解释器而不牺牲编程文件所能提供的复杂性和持久性，还可以避免一次又一次地使用 print()。您可以使用该模块的<code class="du lg lh li kw b">interact()</code>功能，它会在程序被调用时停止程序的执行，并为您提供一个交互式控制台，以便您可以检查程序的当前状态。</p><p id="1729" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该函数及其可能的参数如下:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="731a" class="la jp ht kw b fi lb lc l ld le">code.interact(banner=None, readfunc=None, local=None, exitmsg=None)</span></pre><p id="fdfa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将运行一个 read-eval-print 循环，并创建一个交互式控制台类的对象实例，它模拟交互式 Python 解释器的行为。</p><p id="43f3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可选参数如下:</p><ul class=""><li id="530e" class="lj lk ht is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated"><code class="du lg lh li kw b">banner</code>可以设置成一个字符串，这样你就可以标记解释器在哪里启动</li><li id="b62e" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">readfunc</code>可用作 InteractiveConsole.raw_input()方法</li><li id="fa6d" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">local</code>将为解释器循环设置默认名称空间</li><li id="4352" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">exitmsg</code>可以设置为一个字符串来记录解释器的结束位置</li></ul><p id="34a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过<code class="du lg lh li kw b">local</code>参数，您可以使用，例如:</p><ul class=""><li id="91be" class="lj lk ht is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated"><code class="du lg lh li kw b">local=locals()</code>用于本地命名空间</li><li id="a80d" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">local=globals()</code>用于全局命名空间</li><li id="cc91" class="lj lk ht is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du lg lh li kw b">local=dict(globals(), **locals())</code>同时使用全局名称空间和当前本地名称空间</li></ul><p id="6aec" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以将<code class="du lg lh li kw b">interact()</code>函数放在程序中您想要的任何地方，以启动代码中的交互式解释器。</p><p id="d08b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动交互式控制台的<code class="du lg lh li kw b">code</code>模块可以让您在粒度级别上查看代码正在做什么，以了解其行为并根据需要进行更改。</p><p id="196e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi">*************************************************************************************************</p><blockquote class="ly lz ma"><p id="25ac" class="iq ir mb is b it iu iv iw ix iy iz ja mc jc jd je md jg jh ji me jk jl jm jn hb bi translated">谢谢你阅读这篇文章！！！！！</p></blockquote></div></div>    
</body>
</html>