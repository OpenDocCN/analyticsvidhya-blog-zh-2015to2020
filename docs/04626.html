<html>
<head>
<title>Build A Python App That Tracks Online Prices And Sends Email Notifications.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个Python应用程序来跟踪在线价格并发送电子邮件通知。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-a-python-app-that-tracks-online-prices-and-sends-email-notifications-d7dd5a840f0b?source=collection_archive---------17-----------------------#2020-03-26">https://medium.com/analytics-vidhya/build-a-python-app-that-tracks-online-prices-and-sends-email-notifications-d7dd5a840f0b?source=collection_archive---------17-----------------------#2020-03-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b3cc4e95094f754229ecd655fae19b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmJoZfBXqKYxvCY5KqgscQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">礼貌:<a class="ae iu" href="http://rawpixel.com" rel="noopener ugc nofollow" target="_blank"> RawPixel </a></figcaption></figure><p id="fb7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗯，那是在2018年年中左右，我快要疯了，想买一部新的智能手机，它太贵了(不提品牌了！).所以我想出了一个主意，建立一个小的python应用程序来跟踪价格，如果价格下跌，它会给我发送电子邮件通知。</p><p id="af46" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇博客中，我将带你一步一步地学习<strong class="ix hj"> <em class="jt">构建一个跟踪在线价格并发送电子邮件通知的Python应用</em> </strong>。我们一起编码吧。会很有趣的！</p><p id="3eb1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是如果你已经知道了整件事，只是想看看代码。给你。</p><p id="7d11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们将安装两个必要的库，即requests和bs4。简而言之，请求库将帮助我们访问网络，bs4将帮助我们从网站上提取数据。所以启动你的终端，输入下面的命令。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="f5da" class="kd ke hi jz b fi kf kg l kh ki">pip install requests bs4</span></pre><p id="9de6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们导入我们安装的库和另一个必要的库，我们将使用它在邮件服务器之间发送电子邮件和路由电子邮件。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="4b8d" class="kd ke hi jz b fi kf kg l kh ki">import requests<br/>from bs4 import BeautifulSoup<br/>import smtplib</span></pre><p id="64af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每当您的web浏览器向网站发出请求时，它都会发送一个名为“<strong class="ix hj">用户代理</strong>”的HTTP头。用户代理字符串包含关于您的web浏览器名称、操作系统、设备类型和许多其他有用信息的信息。为了了解你的用户代理，只需谷歌“我的用户代理”。你会得到这样的东西。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/f79642d1faa4ad7021dafc635a522d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qNBvIwQEwfpEauTWHycgVA.png"/></div></div></figure><p id="88b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们定义产品的URL(我们将跟踪价格)和用户代理。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="61f5" class="kd ke hi jz b fi kf kg l kh ki">URL = 'producturl.com/xyz'<br/>headers = {"User-Agent": 'YOUR USER AGENT'}</span></pre><p id="e833" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是时候编写函数来实现我们Python应用程序的第一个目的了。我们将定义一个函数check_price()，它将包括访问URL、提取网页信息(包括产品名称和价格)并使用BeautifulSoup类解析它们。我们还定义了一个if条件，用于比较价格，如果比较结果为真，那么宾果！我们将收到电子邮件。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="a502" class="kd ke hi jz b fi kf kg l kh ki">def check_price():    <br/>     page= requests.get(URL, headers=headers)     <br/>     soup = BeautifulSoup(page.content, 'html.parser')     <br/>     title = soup.find(id = "ebooksProductTitle").get_text()     <br/>     for price in soup.findAll(attrs={'class' : 'a-size-medium a-color-price'}):<br/>        price = price.text.strip()     <br/>     converted_price =  float(price[0:5])     <br/>     if(converted_price &lt; 179):        <br/>        send_email()     <br/>    </span></pre><p id="dd95" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的函数中，我们使用id作为提取标题的定位器，使用类来提取产品的价格。想了解更多关于BeautifulSoup的信息，你可以去他们的网站。</p><p id="1972" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们已经准备好定义函数来实现Python应用程序的第二个目的。我们将定义一个函数send_email()。但在此之前，我们需要为发件人的邮件生成密码，因为一些设备不支持双因素认证。要生成密码，只需导航至谷歌账户的应用程序密码。您将会看到一个如下图所示的屏幕。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/c6edfd158689c3be00b60093549b76d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KRwGmUOuwuT1HNNW6YrkWg.png"/></div></div></figure><p id="fe03" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择应用程序为“邮件”，并根据您的要求选择设备。点击生成！现在你可以清楚地看到你的密码了。现在让我们编写send_email()函数。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="266b" class="kd ke hi jz b fi kf kg l kh ki">def send_email():     <br/>     server = smtplib.SMTP('smtp.gmail.com', 587)    <br/>     server.ehlo()    <br/>     server.starttls()    <br/>     server.ehlo()    <br/>     server.login('sender's email', '#password')     <br/>     subject = 'Write your subject here'     <br/>     body = 'Write your mail content here'     <br/>     msg = f"Subject: {subject} \n\n {body}"<br/>     server.sendmail('sender's email', 'receiver's email', msg)     <br/>     print('Email sent !')     <br/>     server.quit()</span></pre><p id="1c1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以在上面的函数中，我们使用Python的smtplib通过SMTP(简单邮件传输协议)服务器发送邮件。将用于与服务器连接的SMTP对象。在我们发出邮件之前，EHLO命令将用于识别发送到SMTP的主机的域名。最后，让我们调用check_price()函数。答对了。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="8f1b" class="kd ke hi jz b fi kf kg l kh ki">check_price()</span></pre><p id="b091" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更多此类项目，请访问<a class="ae iu" href="https://www.techism101.com" rel="noopener ugc nofollow" target="_blank"> Techism101 </a></p></div></div>    
</body>
</html>