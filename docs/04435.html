<html>
<head>
<title>How To Do an Excel CONTAINS On A Pandas Dataframe Column?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何做一个熊猫数据框列的Excel包含？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/excel-contains-on-pandas-dataframe-column-303f3522d925?source=collection_archive---------11-----------------------#2020-03-19">https://medium.com/analytics-vidhya/excel-contains-on-pandas-dataframe-column-303f3522d925?source=collection_archive---------11-----------------------#2020-03-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="517d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">这篇文章将帮助你使用Str来检查Pandas Dataframe列中的值列表。包含熊猫的概念。</h2></div><p id="3d4c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Contains是一个excel函数，当使用某个值调用该函数时，会返回该值出现的情况。使用python的pandas库也可以达到同样的效果，但是一次只能有一个值。在这篇博客中，我将展示如何为多个值实现这一点。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/2824c7d4eb6fbe16c599d3f566611c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CDEzEExnYR2x_c2Y"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">锡德·巴拉钱德朗在<a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="ee99" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">熊猫是自然界、python开发者和数据科学家遇到的下一个最好的东西。因此，在一个晴朗的夏日午后，我接到一个任务，检查Dataframe列中是否存在multiple，然后将所有结果连接到一个Dataframe中，然后生成结果excel book。</p><p id="054d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我开始了对代码的探索。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/f9c18e5d5ea1c94a8023a167e4393fec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WeDIchkDDH4UY-kQ"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">照片由<a class="ae kj" href="https://unsplash.com/@jakobowens1?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">雅各布·欧文斯</a>在<a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="212d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在100片铬之后。我决定自己编码。因此，与每个人分享，以帮助他们节省大量的时间和内存。就像办公室的安迪说的<strong class="iz hj">“金枪鱼我是表演者表演我应该”</strong> <br/>所以<strong class="iz hj">“金枪鱼我是开发者代码我应该”</strong></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kl"><img src="../Images/3ad628110466fb38f664b594d3c28787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PRSpWP2DU5Baka1Jdh2OIQ.jpeg"/></div></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="71a4" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated"><strong class="ak">导入库和Excel表。</strong></h1><p id="9e0a" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">您可以从<a class="ae kj" href="https://www.briandunning.com/sample-data/" rel="noopener ugc nofollow" target="_blank">这里</a>下载样本数据集。</p><p id="9aed" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请在CSV中创建一个名为“invoice_id”的列。加载之前，使用一些样本创建它。我的发票列格式是“inv_001到inv_500”，中间有一些值，比如以格式“dev_Number”、“sau_Number”、“shu_Number”开头。</p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="518c" class="lv ku hi lr b fi lw lx l ly lz">import pandas as pd<br/>masterdata_df=pd.read_csv(r"PATH OF YOUR EXCEL\us-500\us-500.csv")<br/>masterdata_df.shape<br/><br/>Out:(500, 13)</span></pre><h2 id="ee55" class="lv ku hi bd kv ma mb mc kz md me mf ld jg mg mh lf jk mi mj lh jo mk ml lj mm bi translated">让我给你展示一下。isin和contains。</h2><p id="6946" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated"><strong class="iz hj">包含在熊猫身上</strong></p><p id="0c00" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无论“inv”出现在invoice_id列的什么地方，它都告诉我们相同的行数。在我们的例子中，它发生在360行。</p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="85f7" class="lv ku hi lr b fi lw lx l ly lz">masterdata_df[masterdata_df['invoice_id'].str.contains('inv')].shape<br/>Out:(360, 13)</span></pre><p id="aa55" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">是大熊猫的故乡。</strong></p><p id="c375" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它与invoice_id列中的“inv_001”完全匹配。</p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="d8e1" class="lv ku hi lr b fi lw lx l ly lz">masterdata_df[masterdata_df[‘invoice_id’].isin([‘inv_001’])].shape<br/>Out:(1, 13)</span></pre><p id="93d5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你也可能会想我可以传递多个值吗答案是<strong class="iz hj">可以</strong></p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="f115" class="lv ku hi lr b fi lw lx l ly lz">masterdata_df[masterdata_df['invoice_id'].isin(['inv_001','dev_073','dev_074'])].shape<br/>OUT:(3, 13)</span></pre><h2 id="4016" class="lv ku hi bd kv ma mb mc kz md me mf ld jg mg mh lf jk mi mj lh jo mk ml lj mm bi translated">但是你的脑海中可能会再次出现一个问题…我能在包含……的情况下做同样的事情吗？答案是否定的。</h2><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="8206" class="lv ku hi lr b fi lw lx l ly lz">masterdata_df[masterdata_df['invoice_id'].str.contains('inv','dev_073','dev_074')].shape</span></pre><p id="3e6a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尝试一下，您将得到一个错误，如<strong class="iz hj">类型错误:&amp;不支持的操作数类型:</strong>的‘str’和‘int’</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="81a6" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated"><strong class="ak">所以现在我们来解决这个问题</strong></h1><p id="1ae7" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated"><strong class="iz hj">创建过滤器列表</strong></p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="f427" class="lv ku hi lr b fi lw lx l ly lz">contains_filter=['inv_001','inv_028','inv_029','inv_030','dev_073','dev_074','dev_075','sau_014','sau_015','shu_011','shu_012','shu_013']</span><span id="36e0" class="lv ku hi lr b fi mn lx l ly lz">I have added some extra rows starting with dev,sau and shu.</span></pre><p id="dcea" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">让我们检查列表的长度，并编写一个小的for循环。</strong></p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="df81" class="lv ku hi lr b fi lw lx l ly lz">len(contains_filter)<br/>Out:12</span><span id="4e1b" class="lv ku hi lr b fi mn lx l ly lz">for i in range(len(contains_filter)):<br/>    print(contains_filter[i])<br/>Out:inv_001<br/>inv_028<br/>inv_029<br/>inv_030<br/>dev_073<br/>dev_074<br/>dev_075<br/>sau_014<br/>sau_015<br/>shu_011<br/>shu_012<br/>shu_013</span></pre><p id="acae" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">让我们创建一个空的数据帧</strong></p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="717d" class="lv ku hi lr b fi lw lx l ly lz">final_df = pd.DataFrame()<br/>df1 = pd.DataFrame()</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mo"><img src="../Images/90d3745c6b7de322987fc89756c00430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hRYsECn9vdlzt5RQ"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">照片由<a class="ae kj" href="https://unsplash.com/@lucabravo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢卡·布拉沃</a>在<a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6560" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">现在让我们编写最后的循环，并将结果追加到最终的数据帧中。</strong></p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="815f" class="lv ku hi lr b fi lw lx l ly lz">for i in range(len(contains_filter)):<br/>                     df1 =masterdata_df[masterdata_df['invoice_id'].<br/>                       str.contains(contains_filter[i])]<br/>                     final_df=final_df.append(df1,ignore_index=True)</span></pre><p id="5d67" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我很抱歉缩进(仍在学习TDS ),但这两行都将成为循环。</p><p id="ad0c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们检查最终数据帧的形状或最终结果集中的行数。</p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="aedc" class="lv ku hi lr b fi lw lx l ly lz">final_df.shape<br/>Out:final_df.shape</span></pre><p id="1812" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">样本结果</strong></p><pre class="ju jv jw jx fd lq lr ls lt aw lu bi"><span id="927e" class="lv ku hi lr b fi lw lx l ly lz">final_df.head()</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mp"><img src="../Images/0f1af164af4dcd9505432beb805d88b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A3Dqy1mfVegz-i2vQI_osA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">结果的示例截图。</figcaption></figure><h1 id="cefa" class="kt ku hi bd kv kw mq ky kz la mr lc ld io ms ip lf ir mt is lh iu mu iv lj lk bi translated"><strong class="ak">结论</strong></h1><p id="b3bf" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">我们能够在熊猫专栏上做一个多重包含。希望这段代码能帮助你，节省大量的时间。</p><p id="3c9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">快乐编码。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mv"><img src="../Images/6de4f3b65c6895ea70c379e8b2bf3bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s0HT38CAnj_Nxpfn"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated"><a class="ae kj" href="https://unsplash.com/@phammi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米PHAM </a>在<a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure></div></div>    
</body>
</html>