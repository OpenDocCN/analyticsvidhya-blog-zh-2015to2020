<html>
<head>
<title>TensorFlow: Train a Classifier 🌺</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">张量流:训练分类器🌺</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tensorflow-train-a-classifier-4b4608988671?source=collection_archive---------28-----------------------#2019-12-11">https://medium.com/analytics-vidhya/tensorflow-train-a-classifier-4b4608988671?source=collection_archive---------28-----------------------#2019-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0f97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你一直关注我的博客，你会知道我的上一篇博客涵盖了机器学习的基础和类型。这篇博客将深入探讨机器学习，并通过一个具体的例子来说明如何在TensorFlow中制作自己的分类器。</p><h2 id="e2cb" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">概述:</h2><p id="96f1" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">监督学习依赖于分类器的构建和使用，分类器是一种将数据作为输入，并将标签作为输出的功能。</p><ul class=""><li id="cd06" class="kd ke hi ih b ii ij im in iq kf iu kg iy kh jc ki kj kk kl bi translated">第一步:收集训练数据，用于构建分类器的一组已知输入和输出。同时，应该留出一些数据作为例子，以便稍后测试分类器的准确性。</li><li id="8812" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">第二步:训练分类器并测量其准确度。</li><li id="9354" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">第三步:用分类器预测其他数据。</li></ul><p id="6bfb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将遵循TensorFlow For Poets，以便开发一个可以对花进行分类的分类器。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/a939fc74f0834629f3992e612616c670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXrK3UBOymj5YFkUSXZz4A.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">最终目标</figcaption></figure><h2 id="3872" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">第一步:</h2><p id="b124" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">当我最初开始编码时，我在加载训练数据时遇到了一个错误</p><p id="27e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AttributeError:模块“tensorflow”没有属性“app”。</p><p id="b782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了避免这个错误，我把tensorflow的版本从1.7改成了1.13，这样就成功了。</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="edea" class="jd je hi li b fi lm ln l lo lp">pip install --upgrade "tensorflow==1.13.*"</span></pre><h2 id="c6e3" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">第二步:</h2><p id="7cb6" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">可以使用下面的命令通过github访问实验室的代码。</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="c802" class="jd je hi li b fi lm ln l lo lp">git clone https://github.com/googlecodelabs/tensorflow-for-poets-2</span></pre><h2 id="b101" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">第三步:</h2><p id="4cd7" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">cd复制到文件中，然后使用以下命令下载与实验相关的培训数据。</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="90d2" class="jd je hi li b fi lm ln l lo lp">curl http://download.tensorflow.org/example_images/flower_photos.tgz \<br/>    | tar xz -C tf_files</span></pre><p id="ac02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个追随者(雏菊，蒲公英，玫瑰，向日葵，郁金香)的集合，将用于训练和测试分类器。</p><h2 id="7ed7" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">第四步:</h2><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="cc54" class="jd je hi li b fi lm ln l lo lp">IMAGE_SIZE=224<br/>ARCHITECTURE="mobilenet_0.50_${IMAGE_SIZE}"</span></pre><p id="67a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行这两行代码，以便分别设置图像分辨率和大小。分辨率越高，分类器就越准确。</p><h2 id="09ee" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">第五步:</h2><p id="cc6f" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">您可以使用命令来监控训练进度</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="5111" class="jd je hi li b fi lm ln l lo lp">tensorboard --logdir tf_files/training_summaries &amp;</span></pre><p id="3464" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要查看，请转到localhost:6008。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lq"><img src="../Images/0ecc0d7b387f96451d7dcec62dc47992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHGPxbjbCPNSc9dHMexTxA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">训练前</figcaption></figure><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lr"><img src="../Images/90e08b6906c23624710a5e4141302a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dfoxxQisKoypK094YuznaQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">训练后</figcaption></figure><p id="6356" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过跑步开始训练</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="9996" class="jd je hi li b fi lm ln l lo lp">python -m scripts.retrain \<br/>  --bottleneck_dir=tf_files/bottlenecks \<br/>  --model_dir=tf_files/models/"${ARCHITECTURE}" \<br/>  --summaries_dir=tf_files/training_summaries/"${ARCHITECTURE}" \<br/>  --output_graph=tf_files/retrained_graph.pb \<br/>  --output_labels=tf_files/retrained_labels.txt \<br/>  --architecture="${ARCHITECTURE}" \<br/>  --image_dir=tf_files/flower_photos</span></pre><p id="18ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将贯穿所有4000次迭代。如果您希望运行得更少，这会影响准确性，您可以通过添加</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="0082" class="jd je hi li b fi lm ln l lo lp">--how_many_training_steps=numberOfSteps \</span></pre><p id="2367" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">立即转到上面代码中的行—瓶颈目录=tf文件/瓶颈。</p><h2 id="ae1f" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">第六步:</h2><figure class="ks kt ku kv fd kw"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="0810" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">等等…</p><h2 id="a8b3" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">第七步:</h2><p id="1210" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">测试你的分类器！！</p><p id="9e5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">供参考的我的分类器信息:</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="1159" class="jd je hi li b fi lm ln l lo lp">INFO:tensorflow:Final test accuracy = 90.3% (N=362)</span></pre><p id="2c76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">测试最终目标图像的结果:</p><pre class="ks kt ku kv fd lh li lj lk aw ll bi"><span id="8c6f" class="jd je hi li b fi lm ln l lo lp">Evaluation time (1-image): 0.318s</span><span id="849a" class="jd je hi li b fi lu ln l lo lp">daisy (score=0.99227)</span><span id="9920" class="jd je hi li b fi lu ln l lo lp">dandelion (score=0.00635)</span><span id="3e23" class="jd je hi li b fi lu ln l lo lp">sunflowers (score=0.00135)</span><span id="f049" class="jd je hi li b fi lu ln l lo lp">roses (score=0.00003)</span><span id="0f5d" class="jd je hi li b fi lu ln l lo lp">tulips (score=0.00000)</span></pre><figure class="ks kt ku kv fd kw"><div class="bz dy l di"><div class="lv lt l"/></div></figure><h1 id="eb46" class="lw je hi bd jf lx ly lz jj ma mb mc jn md me mf jq mg mh mi jt mj mk ml jw mm bi translated">资源</h1><figure class="ks kt ku kv fd kw"><div class="bz dy l di"><div class="mn lt l"/></div></figure></div></div>    
</body>
</html>