<html>
<head>
<title>Simple Web Scraping Tutorial With Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Node.js 的简单网页抓取教程</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-web-scraping-tutorial-with-node-js-9ea8ac3b2476?source=collection_archive---------8-----------------------#2020-10-04">https://medium.com/analytics-vidhya/simple-web-scraping-tutorial-with-node-js-9ea8ac3b2476?source=collection_archive---------8-----------------------#2020-10-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0085" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">了解如何使用 Node.js、Express、Axios 和 Cheerio 轻松地从任何网页获取数据(不需要 API)。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/7fe941dc3efae742e797c29ccfb65964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*49AMbeQQjiGXT_OBf94CKQ.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://diversityq.com/coding-course-looks-to-improve-diversity-and-inclusion-in-tech-1509189/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd jo"> DiversityQ </strong> </a></figcaption></figure><p id="bd53" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">我们有无数的理由想要使用来自网络上不同种类的网页的特定数据，但是我们实际上不知道如何将该特定数据用于我们的个人目的，尤其是在缺乏适当的 API 的情况下。<br/>对我们来说幸运的是，有一个伟大而简单的解决方案，不使用任何 API，叫做网络抓取。</p><p id="5ea3" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">在本教程中，我将介绍通过使用 Node.js、Express、Axios 和 Cheerio 抓取网页，将相关信息和数据从网上获取到您手中所需的所有基本步骤。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="546f" class="ks kt hi bd jo ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">等等，网络抓取到底是什么？</h1><p id="c3df" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">网络抓取是一种奇妙的技术，它允许我们直接从网页的 HTML 中提取数据，而不需要使用正式的 API。</p><p id="78f7" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">有很多不同的方式来抓取 web，通过 JavaScript 或 Python 等编程语言以及 Cheerio、Soup 和 Puppeteer 等库来抓取 web 是可能的。</p><h1 id="c182" class="ks kt hi bd jo ku lo kw kx ky lp la lb io lq ip ld ir lr is lf iu ls iv lh li bi translated">整个过程分 3 步</h1><p id="9733" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">网页抓取的整个过程可以通过三个简单的步骤来解释:</p><ol class=""><li id="3a26" class="lt lu hi jr b js jt jv jw jy lv kc lw kg lx kk ly lz ma mb bi translated">第一步是理解并找到你想从特定网页中抓取的数据的相应 HTML 标签。<br/>为此，你需要检查同一个网页的 HTML 代码(例如使用 Chrome DevTool)并找到这些 HTML 标签。</li><li id="21a8" class="lt lu hi jr b js mc jv md jy me kc mf kg mg kk ly lz ma mb bi translated">第二步是选择您想用来编码的编程语言，以及您的 web 抓取应用程序的相应库，在我们的例子中是 Node.js、Express 和 Cheerio，并通过设置与我们之前提到的第一步相同的 HTML 标记来抓取数据。</li><li id="6877" class="lt lu hi jr b js mc jv md jy me kc mf kg mg kk ly lz ma mb bi translated">最后一步是从网页接收所需的数据(即通过 Axios 请求)，正如我们在第二步中所做的那样，通过 Cheerio 库加载它，并根据需要使用它。</li></ol></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="234b" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">今天，在我们简短的例子中，我们将从维基百科的一篇文章中收集所有 NBA 球队的列表。</p><p id="a226" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">通过学习我将在本教程中学习的例子，你将会学到所有的技巧和窍门，成为一名专业的收集数据的专家。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/a94d57f23a3c274ddd9b5317fdfd88a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjGX1GZfNxPoFZulFgCqBA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://makeameme.org/meme/let-the-fun-441qbn" rel="noopener ugc nofollow" target="_blank"><strong class="bd jo">makeameme.org</strong></a>拍摄</figcaption></figure><h1 id="59d2" class="ks kt hi bd jo ku lo kw kx ky lp la lb io lq ip ld ir lr is lf iu ls iv lh li bi translated">让我们从基础开始</h1><p id="66b9" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">网页抓取主要基于对 HTML 标签、jQuery、JavaScript 的理解。<br/>因此，我们必须了解我们将需要哪些 HTML 标签来提取我们想要的所有数据。<br/>为此，我们将使用<strong class="jr hj"> Chrome DevTools </strong>。</p><p id="24e3" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">让我们打开下面的<a class="ae jn" href="https://en.wikipedia.org/wiki/National_Basketball_Association" rel="noopener ugc nofollow" target="_blank">维基百科链接</a>，然后通过右键单击我们想要提取的元素(数据)<br/>(在我们的例子中，是文章的标题)来打开 Chrome dev tools<br/>，然后单击‘inspect’(见下文)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/e1758d682bf82d37500587db8752da00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cG7QgwL3_PFrEgqXTEdQsQ.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://en.wikipedia.org/wiki/National_Basketball_Association" rel="noopener ugc nofollow" target="_blank"> <strong class="bd jo">维基百科</strong> </a>提供</figcaption></figure><p id="9d97" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在，我们在 Chrome DevTools 中，可以看到网页的 HTML 代码。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/4cb86f5a9f4f3dc31bb580541a28c7c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sw_ldaJmCrI4WETU776U3g.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://en.wikipedia.org/wiki/National_Basketball_Association" rel="noopener ugc nofollow" target="_blank"> <strong class="bd jo">维基百科</strong> </a>提供</figcaption></figure><p id="adb2" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">如果仔细观察，可以清楚地看到,<code class="du mk ml mm mn b">&lt;h1&gt;</code>标记是浅蓝色的，这意味着这是我们专门检查过的元素标记(文章的标题)。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/54c7d21612031a782a72110845faa9c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2doBF3eEw_mHMbeJBpuQg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/photos/MSN8TFhJ0is" rel="noopener ugc nofollow" target="_blank"> <strong class="bd jo"> Unsplash </strong> </a>拍摄</figcaption></figure><h1 id="33a3" class="ks kt hi bd jo ku lo kw kx ky lp la lb io lq ip ld ir lr is lf iu ls iv lh li bi translated">真正的交易</h1><p id="c9a0" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">现在，在我们理解了网页抓取的基本步骤，并且找到了我们需要的所有标签之后，我们终于可以创建我们的网页抓取应用程序了。</p><ul class=""><li id="4938" class="lt lu hi jr b js jt jv jw jy lv kc lw kg lx kk mp lz ma mb bi translated">重要提示——如果你以前从未安装过<code class="du mk ml mm mn b">npm</code>,你应该先安装。</li></ul><h1 id="ac0d" class="ks kt hi bd jo ku lo kw kx ky lp la lb io lq ip ld ir lr is lf iu ls iv lh li bi translated">a.启动一个新项目</h1><p id="3648" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">为我们的 web scraping 应用程序项目创建一个新文件夹，并根据您的意愿命名。在项目的文件夹中，创建一个名为<code class="du mk ml mm mn b">app.js</code>的新文件。<br/>您可以通过单击鼠标右键来完成，也可以使用命令行创建一个新文件，键入以下内容:</p><pre class="iy iz ja jb fd mq mn mr ms aw mt bi"><span id="1a7e" class="mu kt hi mn b fi mv mw l mx my">touch app.js</span></pre><p id="3149" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在，我们应该安装并要求我们今天将要使用的依赖项——Express、Axios 和 Cheerio。<br/>为此，请打开命令行并键入以下行:</p><pre class="iy iz ja jb fd mq mn mr ms aw mt bi"><span id="886d" class="mu kt hi mn b fi mv mw l mx my">npm install --save express axios cheerio</span></pre><p id="f2db" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">然后，在<code class="du mk ml mm mn b">app.js</code>文件中请求我们刚刚安装的依赖项，并发起一个<code class="du mk ml mm mn b">get</code>请求，如下所示:</p><pre class="iy iz ja jb fd mq mn mr ms aw mt bi"><span id="a679" class="mu kt hi mn b fi mv mw l mx my">const express = require("express")<br/>const axios = require("axios")<br/>const cheerio = require("cheerio")</span><span id="b643" class="mu kt hi mn b fi mz mw l mx my">app.const app = express();</span><span id="b037" class="mu kt hi mn b fi mz mw l mx my">app.set("view engine");</span><span id="411e" class="mu kt hi mn b fi mz mw l mx my">app.use(express.static(__dirname + "/public"));</span><span id="0703" class="mu kt hi mn b fi mz mw l mx my">app.get("/", function(req, res) {</span><span id="d819" class="mu kt hi mn b fi mz mw l mx my">})</span></pre><h1 id="0ff9" class="ks kt hi bd jo ku lo kw kx ky lp la lb io lq ip ld ir lr is lf iu ls iv lh li bi translated">b.使用 Axios 创建请求</h1><p id="595b" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">现在，在我们创建了一个新项目、安装了依赖项并需要它们之后，是时候使用 Axios 创建我们的第一个请求了。</p><ul class=""><li id="6838" class="lt lu hi jr b js jt jv jw jy lv kc lw kg lx kk mp lz ma mb bi translated">出于澄清的目的，Axios 接收一个 URL 作为输入，并返回一个承诺(解决或拒绝)。</li><li id="cdde" class="lt lu hi jr b js mc jv md jy me kc mf kg mg kk mp lz ma mb bi translated">如果你不知道 Promise 是如何工作的，你可以很容易地在谷歌或 youtube 上找到许多关于它的解释和教程。</li></ul><p id="48a4" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">好，让我们回到我们的例子。<br/>在<code class="du mk ml mm mn b">get</code>请求中，使用 Axios 创建一个请求，将我们的 Wikipedia URL 作为输入，然后，使用 Cheerio，我们将加载响应的 HTML(网页的 HTML)。</p><ul class=""><li id="e59a" class="lt lu hi jr b js jt jv jw jy lv kc lw kg lx kk mp lz ma mb bi translated">注意，Cheerio 实现了核心 jQuery 的子集。Cheerio 从 jQuery 库中移除了所有的 DOM 不一致和浏览器缺陷，展示了它真正华丽的 API。</li></ul><pre class="iy iz ja jb fd mq mn mr ms aw mt bi"><span id="5383" class="mu kt hi mn b fi mv mw l mx my">axios.get("<a class="ae jn" href="https://en.wikipedia.org/wiki/National_Basketball_Association" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/National_Basketball_Association</a>")<br/>.then((response) =&gt; {<br/>    const html = response.data;<br/>    const $ = cheerio.load(html);</span></pre><ul class=""><li id="33e4" class="lt lu hi jr b js jt jv jw jy lv kc lw kg lx kk mp lz ma mb bi translated">如你所见，我使用了一个箭头函数。<br/>如果您不明白箭头函数是如何工作的，只需用以下代码行替换它:</li></ul><pre class="iy iz ja jb fd mq mn mr ms aw mt bi"><span id="fe79" class="mu kt hi mn b fi mv mw l mx my">.then(function(response) {</span></pre><p id="c3f4" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">恭喜你。我们已经使用 Axios 成功接收了文章的 HTML 代码，剩下我们要做的唯一事情就是提取我们想要使用的相关数据，通过使用<code class="du mk ml mm mn b">$</code>符号指定准确的 HTML 标签。</p><pre class="iy iz ja jb fd mq mn mr ms aw mt bi"><span id="e73d" class="mu kt hi mn b fi mv mw l mx my">let title = $("#firstHeading").text();<br/>let teams = [];<br/>for (let i = 0; i &lt; 30; i++) {<br/>   teams.push($('td &gt; b &gt; a', html)[i].attribs.title);<br/>}</span></pre><p id="9ade" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">通过使用<code class="du mk ml mm mn b">$</code>符号(查询选择器)，我们成功地获取了文章的标题元素，即<strong class="jr hj"> </strong>具有一个 id 为<code class="du mk ml mm mn b">#firstHeading</code>的<strong class="jr hj"> </strong>。<br/>此外，我们使用了<code class="du mk ml mm mn b">.text()</code>方法来提取同一元素中的文本。</p><p id="997b" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在，为了获取所有 NBA 球队的列表，我们创建了一个<code class="du mk ml mm mn b">for</code>循环，该循环遍历 30 个<code class="du mk ml mm mn b">&lt;td&gt;</code>元素，并获取它们的每个具有<code class="du mk ml mm mn b">title</code>属性的<code class="du mk ml mm mn b">&lt;a&gt;</code>子元素，并将它们存储在我们创建的名为<code class="du mk ml mm mn b">teams</code>的<code class="du mk ml mm mn b">array</code>变量中。</p><h1 id="47a8" class="ks kt hi bd jo ku lo kw kx ky lp la lb io lq ip ld ir lr is lf iu ls iv lh li bi translated">c.把所有的放在一起</h1><p id="f6d2" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">完美！现在让我们将整个代码打包在一起，并显示我们的结果:</p><pre class="iy iz ja jb fd mq mn mr ms aw mt bi"><span id="c9bf" class="mu kt hi mn b fi mv mw l mx my">const express = require("express")<br/>const axios = require("axios")<br/>const cheerio = require("cheerio")</span><span id="ddf7" class="mu kt hi mn b fi mz mw l mx my">app.const app = express();</span><span id="4de5" class="mu kt hi mn b fi mz mw l mx my">app.set("view engine");</span><span id="75c1" class="mu kt hi mn b fi mz mw l mx my">app.use(express.static(__dirname + "/public"));</span><span id="4726" class="mu kt hi mn b fi mz mw l mx my">app.get("/", function(req, res) {<br/> axios.get("<a class="ae jn" href="https://en.wikipedia.org/wiki/National_Basketball_Association" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/National_Basketball_Associ       ation</a>")<br/>.then((response) =&gt; {<br/>    const html = response.data;<br/>    const $ = cheerio.load(html);<br/>    const title = $("#firstHeading").text();<br/>    const teams = [];<br/>    for (let i = 0; i &lt; 30; i++) {<br/>       teams.push($('td &gt; b &gt; a', html)[i].attribs.title);<br/>    }<br/>    console.log(title);<br/>    console.log(teams);</span><span id="7ad7" class="mu kt hi mn b fi mz mw l mx my">res.send(teams);<br/>})</span></pre><p id="bcd0" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">输出:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es na"><img src="../Images/e7176b54e9983ec80edec927408da7ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-jidiDN4nQ8jiAi1brIiQQ.jpeg"/></div></div></figure><h1 id="2242" class="ks kt hi bd jo ku lo kw kx ky lp la lb io lq ip ld ir lr is lf iu ls iv lh li bi translated">摘要</h1><p id="9d57" class="pw-post-body-paragraph jp jq hi jr b js lj ij ju jv lk im jx jy ll ka kb kc lm ke kf kg ln ki kj kk hb bi translated">基本上，我们刚刚使用 Node.js、Axios 和 Cheerio 创建了一个简单的 web 抓取<strong class="jr hj"> </strong>应用程序。我们应该永远记住，我们可以随心所欲地使用我们获取的数据！</p><p id="7f18" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">我相信你现在可能明白了，网络抓取是多么简单。正如我之前说过的，你可以使用网络抓取从互联网上的几乎任何网页中提取几乎任何数据。你唯一需要做的就是遵循我们今天学到的三个简单步骤。</p><p id="a933" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">感谢您的阅读，</p><p id="4fd0" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">诺姆·卡尼奇</p></div></div>    
</body>
</html>